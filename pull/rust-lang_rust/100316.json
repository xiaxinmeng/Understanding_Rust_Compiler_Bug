{"url": "https://api.github.com/repos/rust-lang/rust/pulls/100316", "id": 1021314703, "node_id": "PR_kwDOAAsO6M484AaP", "html_url": "https://github.com/rust-lang/rust/pull/100316", "diff_url": "https://github.com/rust-lang/rust/pull/100316.diff", "patch_url": "https://github.com/rust-lang/rust/pull/100316.patch", "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/100316", "number": 100316, "state": "closed", "locked": false, "title": "Add Rust std support for x86_64-unknown-uefi", "user": {"login": "Ayush1325", "id": 22546812, "node_id": "MDQ6VXNlcjIyNTQ2ODEy", "avatar_url": "https://avatars.githubusercontent.com/u/22546812?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ayush1325", "html_url": "https://github.com/Ayush1325", "followers_url": "https://api.github.com/users/Ayush1325/followers", "following_url": "https://api.github.com/users/Ayush1325/following{/other_user}", "gists_url": "https://api.github.com/users/Ayush1325/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ayush1325/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ayush1325/subscriptions", "organizations_url": "https://api.github.com/users/Ayush1325/orgs", "repos_url": "https://api.github.com/users/Ayush1325/repos", "events_url": "https://api.github.com/users/Ayush1325/events{/privacy}", "received_events_url": "https://api.github.com/users/Ayush1325/received_events", "type": "User", "site_admin": false}, "body": "# Notice\r\nI have created a smaller PR (https://github.com/rust-lang/rust/pull/105861) to get just a stripped-down version of std for UEFI merged. This would help simplify the review process and speed up the merge.\r\n\r\n# Introduction\r\nHello everyone, I have been working on porting Rust std to UEFI as a part of my Google Summer of Code 2022 project. While there are still problems left to fix, I would like to get more people experienced with Rust to check it out and provide feedback since this is my first time working with the Rust library internals.\r\n \r\nInformation about the current state of this implementation can be found at `src/doc/rustc/src/platform-support/unknown-uefi.md`. Some of the biggest limitations of the current implementation are the following:\r\n\r\n1. ~~The custom entry point function for UEFI is present at `library/std/src/sys/uefi/mod.rs`, This breaks using std with the `no_main` feature. Maybe this can be generated by the compiler like the C entry pointer, but not sure.~~: Now generated by compiler like C-main.\r\n2. `sys/uefi/net` module was implemented only for running tests using `remote-test-server` and thus is not implemented for any actual production use. If someone really wants to implement it, it would be best to do it on top of `SIMPLE_NETWORK_PROTOCOL`, but that won't be possible in the GSoC timeframe.\r\n\r\n3. No `panic=unwind` or backtrace support.\r\n4. ~~Pipes are basically a hack and should not be used unless someone knows what they are doing.~~: Using a dedicated Pipe Protocol now. However, this protocol hasen't been tested outside of `src/tests/ui` yet.\r\n5. ~~Feature `panic_abort_tests` is broken. While the UEFI stdio prints the correct output, capturing test output is not working with this feature.~~: Fixed\r\n6. ~~`should_panic` is broken for tests when `panic_abort_tests` is disabled.~~: Fixed\r\n7. Command is kinda broken. The current spawn is blocking. More about this can be found [here](https://rust-lang.zulipchat.com/#narrow/stream/182449-t-compiler.2Fhelp/topic/Implementation.20of.20Command.20for.20UEFI)\r\n\r\nFeel free to try it out and provide feedback. It is possible to run tests using `remote-test-client` and `remote-test-server`. For more details, you might want to look at my [blog](https://www.programmershideaway.xyz/).\r\n\r\nFor those who are wondering how a target like UEFI can benefit from std support, here are a few examples:\r\n1. Writing UEFI shell applications. This includes stuff like benchmarks, self-test utilities, etc. Many drivers should also be able to use std.\r\n2. Finding UEFI target bugs. During this work, I have found 3 numeric tests that cause CPU exceptions for UEFI (they are fixed now. Also, I have found 2 additional bugs (which seem like bugs in llvm soft-float) which went unnoticed because there was no easy way to do any broad testing.\r\n3. Provide a stable interface for library developers. The current std contains some functions under `std::os::uefi::env` to provide access to the underlying SystemTable and SystemHandle, which are essential for writing anything for UEFI.\r\n\r\n# Related Links\r\n1. [Tracking Issue](https://github.com/rust-lang/rust/issues/100499)\r\n2. [API Change Proposal](https://github.com/rust-lang/libs-team/issues/87)", "created_at": "2022-08-09T10:10:50Z", "updated_at": "2023-05-16T13:33:45Z", "closed_at": "2023-05-16T13:32:26Z", "merged_at": null, "merge_commit_sha": "4732ea47eee72dad244608f244571ff0d62e7242", "assignee": {"login": "thomcc", "id": 860665, "node_id": "MDQ6VXNlcjg2MDY2NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/860665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thomcc", "html_url": "https://github.com/thomcc", "followers_url": "https://api.github.com/users/thomcc/followers", "following_url": "https://api.github.com/users/thomcc/following{/other_user}", "gists_url": "https://api.github.com/users/thomcc/gists{/gist_id}", "starred_url": "https://api.github.com/users/thomcc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thomcc/subscriptions", "organizations_url": "https://api.github.com/users/thomcc/orgs", "repos_url": "https://api.github.com/users/thomcc/repos", "events_url": "https://api.github.com/users/thomcc/events{/privacy}", "received_events_url": "https://api.github.com/users/thomcc/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "thomcc", "id": 860665, "node_id": "MDQ6VXNlcjg2MDY2NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/860665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thomcc", "html_url": "https://github.com/thomcc", "followers_url": "https://api.github.com/users/thomcc/followers", "following_url": "https://api.github.com/users/thomcc/following{/other_user}", "gists_url": "https://api.github.com/users/thomcc/gists{/gist_id}", "starred_url": "https://api.github.com/users/thomcc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thomcc/subscriptions", "organizations_url": "https://api.github.com/users/thomcc/orgs", "repos_url": "https://api.github.com/users/thomcc/repos", "events_url": "https://api.github.com/users/thomcc/events{/privacy}", "received_events_url": "https://api.github.com/users/thomcc/received_events", "type": "User", "site_admin": false}], "requested_reviewers": [{"login": "thomcc", "id": 860665, "node_id": "MDQ6VXNlcjg2MDY2NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/860665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thomcc", "html_url": "https://github.com/thomcc", "followers_url": "https://api.github.com/users/thomcc/followers", "following_url": "https://api.github.com/users/thomcc/following{/other_user}", "gists_url": "https://api.github.com/users/thomcc/gists{/gist_id}", "starred_url": "https://api.github.com/users/thomcc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thomcc/subscriptions", "organizations_url": "https://api.github.com/users/thomcc/orgs", "repos_url": "https://api.github.com/users/thomcc/repos", "events_url": "https://api.github.com/users/thomcc/events{/privacy}", "received_events_url": "https://api.github.com/users/thomcc/received_events", "type": "User", "site_admin": false}], "requested_teams": [], "labels": [{"id": 120005, "node_id": "MDU6TGFiZWwxMjAwMDU=", "url": "https://api.github.com/repos/rust-lang/rust/labels/A-testsuite", "name": "A-testsuite", "color": "f7e101", "default": false, "description": "Area: The testsuite used to check the correctness of rustc"}, {"id": 211668100, "node_id": "MDU6TGFiZWwyMTE2NjgxMDA=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-compiler", "name": "T-compiler", "color": "bfd4f2", "default": false, "description": "Relevant to the compiler team, which will review and decide on the PR/issue."}, {"id": 325438536, "node_id": "MDU6TGFiZWwzMjU0Mzg1MzY=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-bootstrap", "name": "T-bootstrap", "color": "bfd4f2", "default": false, "description": "Relevant to the bootstrap subteam: Rust's build system (x.py and src/bootstrap)"}, {"id": 593503757, "node_id": "MDU6TGFiZWw1OTM1MDM3NTc=", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-infra", "name": "T-infra", "color": "bfd4f2", "default": false, "description": "Relevant to the infrastructure team, which will review and decide on the PR/issue."}, {"id": 2011781731, "node_id": "MDU6TGFiZWwyMDExNzgxNzMx", "url": "https://api.github.com/repos/rust-lang/rust/labels/T-libs", "name": "T-libs", "color": "bfd4f2", "default": false, "description": "Relevant to the library team, which will review and decide on the PR/issue."}, {"id": 2342352297, "node_id": "MDU6TGFiZWwyMzQyMzUyMjk3", "url": "https://api.github.com/repos/rust-lang/rust/labels/O-UEFI", "name": "O-UEFI", "color": "6e6ec0", "default": false, "description": "UEFI"}], "milestone": null, "draft": false, "commits_url": "https://api.github.com/repos/rust-lang/rust/pulls/100316/commits", "review_comments_url": "https://api.github.com/repos/rust-lang/rust/pulls/100316/comments", "review_comment_url": "https://api.github.com/repos/rust-lang/rust/pulls/comments{/number}", "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/100316/comments", "statuses_url": "https://api.github.com/repos/rust-lang/rust/statuses/824f06719e8640fb3de36eba50767cccb0f0630a", "head": {"label": "tianocore:uefi-master", "ref": "uefi-master", "sha": "824f06719e8640fb3de36eba50767cccb0f0630a", "user": {"login": "tianocore", "id": 352162, "node_id": "MDEyOk9yZ2FuaXphdGlvbjM1MjE2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/352162?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tianocore", "html_url": "https://github.com/tianocore", "followers_url": "https://api.github.com/users/tianocore/followers", "following_url": "https://api.github.com/users/tianocore/following{/other_user}", "gists_url": "https://api.github.com/users/tianocore/gists{/gist_id}", "starred_url": "https://api.github.com/users/tianocore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tianocore/subscriptions", "organizations_url": "https://api.github.com/users/tianocore/orgs", "repos_url": "https://api.github.com/users/tianocore/repos", "events_url": "https://api.github.com/users/tianocore/events{/privacy}", "received_events_url": "https://api.github.com/users/tianocore/received_events", "type": "Organization", "site_admin": false}, "repo": {"id": 520214086, "node_id": "R_kgDOHwHWRg", "name": "rust", "full_name": "tianocore/rust", "private": false, "owner": {"login": "tianocore", "id": 352162, "node_id": "MDEyOk9yZ2FuaXphdGlvbjM1MjE2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/352162?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tianocore", "html_url": "https://github.com/tianocore", "followers_url": "https://api.github.com/users/tianocore/followers", "following_url": "https://api.github.com/users/tianocore/following{/other_user}", "gists_url": "https://api.github.com/users/tianocore/gists{/gist_id}", "starred_url": "https://api.github.com/users/tianocore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tianocore/subscriptions", "organizations_url": "https://api.github.com/users/tianocore/orgs", "repos_url": "https://api.github.com/users/tianocore/repos", "events_url": "https://api.github.com/users/tianocore/events{/privacy}", "received_events_url": "https://api.github.com/users/tianocore/received_events", "type": "Organization", "site_admin": false}, "html_url": "https://github.com/tianocore/rust", "description": "Empowering everyone to build reliable and efficient software.", "fork": true, "url": "https://api.github.com/repos/tianocore/rust", "forks_url": "https://api.github.com/repos/tianocore/rust/forks", "keys_url": "https://api.github.com/repos/tianocore/rust/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/tianocore/rust/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/tianocore/rust/teams", "hooks_url": "https://api.github.com/repos/tianocore/rust/hooks", "issue_events_url": "https://api.github.com/repos/tianocore/rust/issues/events{/number}", "events_url": "https://api.github.com/repos/tianocore/rust/events", "assignees_url": "https://api.github.com/repos/tianocore/rust/assignees{/user}", "branches_url": "https://api.github.com/repos/tianocore/rust/branches{/branch}", "tags_url": "https://api.github.com/repos/tianocore/rust/tags", "blobs_url": "https://api.github.com/repos/tianocore/rust/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/tianocore/rust/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/tianocore/rust/git/refs{/sha}", "trees_url": "https://api.github.com/repos/tianocore/rust/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/tianocore/rust/statuses/{sha}", "languages_url": "https://api.github.com/repos/tianocore/rust/languages", "stargazers_url": "https://api.github.com/repos/tianocore/rust/stargazers", "contributors_url": "https://api.github.com/repos/tianocore/rust/contributors", "subscribers_url": "https://api.github.com/repos/tianocore/rust/subscribers", "subscription_url": "https://api.github.com/repos/tianocore/rust/subscription", "commits_url": "https://api.github.com/repos/tianocore/rust/commits{/sha}", "git_commits_url": "https://api.github.com/repos/tianocore/rust/git/commits{/sha}", "comments_url": "https://api.github.com/repos/tianocore/rust/comments{/number}", "issue_comment_url": "https://api.github.com/repos/tianocore/rust/issues/comments{/number}", "contents_url": "https://api.github.com/repos/tianocore/rust/contents/{+path}", "compare_url": "https://api.github.com/repos/tianocore/rust/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/tianocore/rust/merges", "archive_url": "https://api.github.com/repos/tianocore/rust/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/tianocore/rust/downloads", "issues_url": "https://api.github.com/repos/tianocore/rust/issues{/number}", "pulls_url": "https://api.github.com/repos/tianocore/rust/pulls{/number}", "milestones_url": "https://api.github.com/repos/tianocore/rust/milestones{/number}", "notifications_url": "https://api.github.com/repos/tianocore/rust/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/tianocore/rust/labels{/name}", "releases_url": "https://api.github.com/repos/tianocore/rust/releases{/id}", "deployments_url": "https://api.github.com/repos/tianocore/rust/deployments", "created_at": "2022-08-01T18:05:08Z", "updated_at": "2023-02-17T18:23:02Z", "pushed_at": "2022-12-19T04:56:15Z", "git_url": "git://github.com/tianocore/rust.git", "ssh_url": "git@github.com:tianocore/rust.git", "clone_url": "https://github.com/tianocore/rust.git", "svn_url": "https://github.com/tianocore/rust", "homepage": "https://www.rust-lang.org", "size": 1016735, "stargazers_count": 5, "watchers_count": 5, "language": "Rust", "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "has_discussions": false, "forks_count": 0, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 0, "license": {"key": "other", "name": "Other", "spdx_id": "NOASSERTION", "url": null, "node_id": "MDc6TGljZW5zZTA="}, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 0, "open_issues": 0, "watchers": 5, "default_branch": "master"}}, "base": {"label": "rust-lang:master", "ref": "master", "sha": "999ac5f7770bff68bd65f490990d32c3ec1faaa6", "user": {"login": "rust-lang", "id": 5430905, "node_id": "MDEyOk9yZ2FuaXphdGlvbjU0MzA5MDU=", "avatar_url": "https://avatars.githubusercontent.com/u/5430905?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rust-lang", "html_url": "https://github.com/rust-lang", "followers_url": "https://api.github.com/users/rust-lang/followers", "following_url": "https://api.github.com/users/rust-lang/following{/other_user}", "gists_url": "https://api.github.com/users/rust-lang/gists{/gist_id}", "starred_url": "https://api.github.com/users/rust-lang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rust-lang/subscriptions", "organizations_url": "https://api.github.com/users/rust-lang/orgs", "repos_url": "https://api.github.com/users/rust-lang/repos", "events_url": "https://api.github.com/users/rust-lang/events{/privacy}", "received_events_url": "https://api.github.com/users/rust-lang/received_events", "type": "Organization", "site_admin": false}, "repo": {"id": 724712, "node_id": "MDEwOlJlcG9zaXRvcnk3MjQ3MTI=", "name": "rust", "full_name": "rust-lang/rust", "private": false, "owner": {"login": "rust-lang", "id": 5430905, "node_id": "MDEyOk9yZ2FuaXphdGlvbjU0MzA5MDU=", "avatar_url": "https://avatars.githubusercontent.com/u/5430905?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rust-lang", "html_url": "https://github.com/rust-lang", "followers_url": "https://api.github.com/users/rust-lang/followers", "following_url": "https://api.github.com/users/rust-lang/following{/other_user}", "gists_url": "https://api.github.com/users/rust-lang/gists{/gist_id}", "starred_url": "https://api.github.com/users/rust-lang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rust-lang/subscriptions", "organizations_url": "https://api.github.com/users/rust-lang/orgs", "repos_url": "https://api.github.com/users/rust-lang/repos", "events_url": "https://api.github.com/users/rust-lang/events{/privacy}", "received_events_url": "https://api.github.com/users/rust-lang/received_events", "type": "Organization", "site_admin": false}, "html_url": "https://github.com/rust-lang/rust", "description": "Empowering everyone to build reliable and efficient software.", "fork": false, "url": "https://api.github.com/repos/rust-lang/rust", "forks_url": "https://api.github.com/repos/rust-lang/rust/forks", "keys_url": "https://api.github.com/repos/rust-lang/rust/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/rust-lang/rust/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/rust-lang/rust/teams", "hooks_url": "https://api.github.com/repos/rust-lang/rust/hooks", "issue_events_url": "https://api.github.com/repos/rust-lang/rust/issues/events{/number}", "events_url": "https://api.github.com/repos/rust-lang/rust/events", "assignees_url": "https://api.github.com/repos/rust-lang/rust/assignees{/user}", "branches_url": "https://api.github.com/repos/rust-lang/rust/branches{/branch}", "tags_url": "https://api.github.com/repos/rust-lang/rust/tags", "blobs_url": "https://api.github.com/repos/rust-lang/rust/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/rust-lang/rust/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/rust-lang/rust/git/refs{/sha}", "trees_url": "https://api.github.com/repos/rust-lang/rust/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/rust-lang/rust/statuses/{sha}", "languages_url": "https://api.github.com/repos/rust-lang/rust/languages", "stargazers_url": "https://api.github.com/repos/rust-lang/rust/stargazers", "contributors_url": "https://api.github.com/repos/rust-lang/rust/contributors", "subscribers_url": "https://api.github.com/repos/rust-lang/rust/subscribers", "subscription_url": "https://api.github.com/repos/rust-lang/rust/subscription", "commits_url": "https://api.github.com/repos/rust-lang/rust/commits{/sha}", "git_commits_url": "https://api.github.com/repos/rust-lang/rust/git/commits{/sha}", "comments_url": "https://api.github.com/repos/rust-lang/rust/comments{/number}", "issue_comment_url": "https://api.github.com/repos/rust-lang/rust/issues/comments{/number}", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/{+path}", "compare_url": "https://api.github.com/repos/rust-lang/rust/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/rust-lang/rust/merges", "archive_url": "https://api.github.com/repos/rust-lang/rust/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/rust-lang/rust/downloads", "issues_url": "https://api.github.com/repos/rust-lang/rust/issues{/number}", "pulls_url": "https://api.github.com/repos/rust-lang/rust/pulls{/number}", "milestones_url": "https://api.github.com/repos/rust-lang/rust/milestones{/number}", "notifications_url": "https://api.github.com/repos/rust-lang/rust/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/rust-lang/rust/labels{/name}", "releases_url": "https://api.github.com/repos/rust-lang/rust/releases{/id}", "deployments_url": "https://api.github.com/repos/rust-lang/rust/deployments", "created_at": "2010-06-16T20:39:03Z", "updated_at": "2023-06-20T05:25:49Z", "pushed_at": "2023-06-20T05:32:43Z", "git_url": "git://github.com/rust-lang/rust.git", "ssh_url": "git@github.com:rust-lang/rust.git", "clone_url": "https://github.com/rust-lang/rust.git", "svn_url": "https://github.com/rust-lang/rust", "homepage": "https://www.rust-lang.org", "size": 930404, "stargazers_count": 82763, "watchers_count": 82763, "language": "Rust", "has_issues": true, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "has_discussions": false, "forks_count": 10964, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 9633, "license": {"key": "other", "name": "Other", "spdx_id": "NOASSERTION", "url": null, "node_id": "MDc6TGljZW5zZTA="}, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": ["compiler", "hacktoberfest", "language", "rust"], "visibility": "public", "forks": 10964, "open_issues": 9633, "watchers": 82763, "default_branch": "master"}}, "_links": {"self": {"href": "https://api.github.com/repos/rust-lang/rust/pulls/100316"}, "html": {"href": "https://github.com/rust-lang/rust/pull/100316"}, "issue": {"href": "https://api.github.com/repos/rust-lang/rust/issues/100316"}, "comments": {"href": "https://api.github.com/repos/rust-lang/rust/issues/100316/comments"}, "review_comments": {"href": "https://api.github.com/repos/rust-lang/rust/pulls/100316/comments"}, "review_comment": {"href": "https://api.github.com/repos/rust-lang/rust/pulls/comments{/number}"}, "commits": {"href": "https://api.github.com/repos/rust-lang/rust/pulls/100316/commits"}, "statuses": {"href": "https://api.github.com/repos/rust-lang/rust/statuses/824f06719e8640fb3de36eba50767cccb0f0630a"}}, "author_association": "CONTRIBUTOR", "auto_merge": null, "active_lock_reason": null, "merged": false, "mergeable": null, "rebaseable": null, "mergeable_state": "unknown", "merged_by": null, "comments": 78, "review_comments": 218, "maintainer_can_modify": false, "commits": 60, "additions": 5547, "deletions": 37, "changed_files": 57}