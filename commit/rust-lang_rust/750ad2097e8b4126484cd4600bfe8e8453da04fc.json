{"sha": "750ad2097e8b4126484cd4600bfe8e8453da04fc", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc1MGFkMjA5N2U4YjQxMjY0ODRjZDQ2MDBiZmU4ZTg0NTNkYTA0ZmM=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-07-20T15:43:48Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-07-20T15:43:48Z"}, "message": "ci: upload non-macOS from GHA instead of Azure Pipelines", "tree": {"sha": "75965bf71e9f80cfe8382cc29467b0accfde658c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/75965bf71e9f80cfe8382cc29467b0accfde658c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/750ad2097e8b4126484cd4600bfe8e8453da04fc", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE1JbYPtLJAsc22U9xPgar6Auq8ZwFAl8Vu8AACgkQPgar6Auq\n8Zz2Vg/+NTCFKngGm5YSBRglfP8KsfndZpUWEpI+6SHviaUQAn2X8c07zF9I5yrX\na3iQgNPtX+IIu+uX4LWaVuyJzxNfLoTVEa/4Ufsqg8O3oGtDkiVBhEYfrCGTdpcf\nJCMiQKQ9cq20tSR5S9GuAlZYvbvTTXFHtHnyyJY6VicrK21nuyaXl4rMf8I0A/s4\nkLVK8eVsHP5zaKEu5Uwg7lWrDt9z7Gz3i/KFcfhKwyj32QPGcxcQP0R/cINRz4Cr\nVjLbWbKNzKxzVK/6LOojcKlAxXibLl+l2yw3QLujU2TcBZWX/zwerAtICV3lQWMT\nMJM6MA6dAD1MJTJuVc/awkyd3R1dHVvWoUa5FsFPG1sI4xJyBLriZAZ9qbYvXzW+\nhynqc8L/yIWALApDgN1rTRNKHdLrSvdBUbljCakl89fFdb0EdIbKEFhSiBonPDFl\nJyPsmShjoNOBss/YJ8eR62KVLdkkts8SoXxXy1rmdDNLVcR/kbNlEsvCL1V3RhRg\noZ2J2ZfizKvP39s7YoKzcrZSoDjtJgDf7sRXQW7nJ8dAnVuL/dmOo2Hs6+U0NTkB\nuWGfw5xaJh9p1ED80dlLOyl7eVC2yjA41QxuAtiWVjoYvm8/zv3xeYlLb56i73PL\neDEIAoZYpRNPd9IWFeXazFVW6P2cXZHDg37GNl9NhahBK+mLobo=\n=iyjV\n-----END PGP SIGNATURE-----", "payload": "tree 75965bf71e9f80cfe8382cc29467b0accfde658c\nparent 5e11ae4fc52e749f43d334e96ba06c979fa67ef7\nauthor Pietro Albini <pietro@pietroalbini.org> 1595259828 +0200\ncommitter Pietro Albini <pietro@pietroalbini.org> 1595259828 +0200\n\nci: upload non-macOS from GHA instead of Azure Pipelines\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/750ad2097e8b4126484cd4600bfe8e8453da04fc", "html_url": "https://github.com/rust-lang/rust/commit/750ad2097e8b4126484cd4600bfe8e8453da04fc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/750ad2097e8b4126484cd4600bfe8e8453da04fc/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5e11ae4fc52e749f43d334e96ba06c979fa67ef7", "url": "https://api.github.com/repos/rust-lang/rust/commits/5e11ae4fc52e749f43d334e96ba06c979fa67ef7", "html_url": "https://github.com/rust-lang/rust/commit/5e11ae4fc52e749f43d334e96ba06c979fa67ef7"}], "stats": {"total": 80, "additions": 49, "deletions": 31}, "files": [{"sha": "6e0808c0d58969089975d8f2f2f2868881a96712", "filename": ".github/workflows/ci.yml", "status": "modified", "additions": 24, "deletions": 24, "changes": 48, "blob_url": "https://github.com/rust-lang/rust/blob/750ad2097e8b4126484cd4600bfe8e8453da04fc/.github%2Fworkflows%2Fci.yml", "raw_url": "https://github.com/rust-lang/rust/raw/750ad2097e8b4126484cd4600bfe8e8453da04fc/.github%2Fworkflows%2Fci.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fci.yml?ref=750ad2097e8b4126484cd4600bfe8e8453da04fc", "patch": "@@ -32,9 +32,9 @@ jobs:\n     name: PR\n     env:\n       CI_JOB_NAME: \"${{ matrix.name }}\"\n-      SCCACHE_BUCKET: rust-lang-gha-caches\n-      TOOLSTATE_REPO: \"https://github.com/pietroalbini/rust-toolstate\"\n-      CACHE_DOMAIN: ci-caches-gha.rust-lang.org\n+      SCCACHE_BUCKET: rust-lang-ci-sccache2\n+      TOOLSTATE_REPO: \"https://github.com/rust-lang-nursery/rust-toolstate\"\n+      CACHE_DOMAIN: ci-caches.rust-lang.org\n     if: \"github.event_name == 'pull_request'\"\n     strategy:\n       matrix:\n@@ -138,14 +138,14 @@ jobs:\n     name: try\n     env:\n       CI_JOB_NAME: \"${{ matrix.name }}\"\n-      SCCACHE_BUCKET: rust-lang-gha-caches\n-      DEPLOY_BUCKET: rust-lang-gha\n-      TOOLSTATE_REPO: \"https://github.com/pietroalbini/rust-toolstate\"\n-      TOOLSTATE_ISSUES_API_URL: \"https://api.github.com/repos/pietroalbini/rust-toolstate/issues\"\n+      SCCACHE_BUCKET: rust-lang-ci-sccache2\n+      DEPLOY_BUCKET: rust-lang-ci2\n+      TOOLSTATE_REPO: \"https://github.com/rust-lang-nursery/rust-toolstate\"\n+      TOOLSTATE_ISSUES_API_URL: \"https://api.github.com/repos/rust-lang/rust/issues\"\n       TOOLSTATE_PUBLISH: 1\n-      CACHES_AWS_ACCESS_KEY_ID: AKIA46X5W6CZOMUQATD5\n-      ARTIFACTS_AWS_ACCESS_KEY_ID: AKIA46X5W6CZH5AYXDVF\n-      CACHE_DOMAIN: ci-caches-gha.rust-lang.org\n+      CACHES_AWS_ACCESS_KEY_ID: AKIA46X5W6CZI5DHEBFL\n+      ARTIFACTS_AWS_ACCESS_KEY_ID: AKIA46X5W6CZN24CBO55\n+      CACHE_DOMAIN: ci-caches.rust-lang.org\n     if: \"github.event_name == 'push' && github.ref == 'refs/heads/try' && github.repository == 'rust-lang-ci/rust'\"\n     strategy:\n       matrix:\n@@ -242,14 +242,14 @@ jobs:\n     name: auto\n     env:\n       CI_JOB_NAME: \"${{ matrix.name }}\"\n-      SCCACHE_BUCKET: rust-lang-gha-caches\n-      DEPLOY_BUCKET: rust-lang-gha\n-      TOOLSTATE_REPO: \"https://github.com/pietroalbini/rust-toolstate\"\n-      TOOLSTATE_ISSUES_API_URL: \"https://api.github.com/repos/pietroalbini/rust-toolstate/issues\"\n+      SCCACHE_BUCKET: rust-lang-ci-sccache2\n+      DEPLOY_BUCKET: rust-lang-ci2\n+      TOOLSTATE_REPO: \"https://github.com/rust-lang-nursery/rust-toolstate\"\n+      TOOLSTATE_ISSUES_API_URL: \"https://api.github.com/repos/rust-lang/rust/issues\"\n       TOOLSTATE_PUBLISH: 1\n-      CACHES_AWS_ACCESS_KEY_ID: AKIA46X5W6CZOMUQATD5\n-      ARTIFACTS_AWS_ACCESS_KEY_ID: AKIA46X5W6CZH5AYXDVF\n-      CACHE_DOMAIN: ci-caches-gha.rust-lang.org\n+      CACHES_AWS_ACCESS_KEY_ID: AKIA46X5W6CZI5DHEBFL\n+      ARTIFACTS_AWS_ACCESS_KEY_ID: AKIA46X5W6CZN24CBO55\n+      CACHE_DOMAIN: ci-caches.rust-lang.org\n     if: \"github.event_name == 'push' && github.ref == 'refs/heads/auto' && github.repository == 'rust-lang-ci/rust'\"\n     strategy:\n       matrix:\n@@ -694,14 +694,14 @@ jobs:\n     name: master\n     runs-on: ubuntu-latest\n     env:\n-      SCCACHE_BUCKET: rust-lang-gha-caches\n-      DEPLOY_BUCKET: rust-lang-gha\n-      TOOLSTATE_REPO: \"https://github.com/pietroalbini/rust-toolstate\"\n-      TOOLSTATE_ISSUES_API_URL: \"https://api.github.com/repos/pietroalbini/rust-toolstate/issues\"\n+      SCCACHE_BUCKET: rust-lang-ci-sccache2\n+      DEPLOY_BUCKET: rust-lang-ci2\n+      TOOLSTATE_REPO: \"https://github.com/rust-lang-nursery/rust-toolstate\"\n+      TOOLSTATE_ISSUES_API_URL: \"https://api.github.com/repos/rust-lang/rust/issues\"\n       TOOLSTATE_PUBLISH: 1\n-      CACHES_AWS_ACCESS_KEY_ID: AKIA46X5W6CZOMUQATD5\n-      ARTIFACTS_AWS_ACCESS_KEY_ID: AKIA46X5W6CZH5AYXDVF\n-      CACHE_DOMAIN: ci-caches-gha.rust-lang.org\n+      CACHES_AWS_ACCESS_KEY_ID: AKIA46X5W6CZI5DHEBFL\n+      ARTIFACTS_AWS_ACCESS_KEY_ID: AKIA46X5W6CZN24CBO55\n+      CACHE_DOMAIN: ci-caches.rust-lang.org\n     if: \"github.event_name == 'push' && github.ref == 'refs/heads/master' && github.repository == 'rust-lang-ci/rust'\"\n     steps:\n       - name: checkout the source code"}, {"sha": "63c3d44020f0cd3032bae382aefef2b8a0f04bf1", "filename": "src/ci/azure-pipelines/auto.yml", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/750ad2097e8b4126484cd4600bfe8e8453da04fc/src%2Fci%2Fazure-pipelines%2Fauto.yml", "raw_url": "https://github.com/rust-lang/rust/raw/750ad2097e8b4126484cd4600bfe8e8453da04fc/src%2Fci%2Fazure-pipelines%2Fauto.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fazure-pipelines%2Fauto.yml?ref=750ad2097e8b4126484cd4600bfe8e8453da04fc", "patch": "@@ -18,7 +18,7 @@ trigger:\n   - auto\n \n variables:\n-- group: prod-credentials\n+- group: dummy-credentials\n \n jobs:\n - job: Linux\n@@ -79,6 +79,9 @@ jobs:\n     vmImage: macos-10.15\n   steps:\n   - template: steps/run.yml\n+  variables:\n+    # We're still uploading macOS builds from Azure Pipelines.\n+    - group: prod-credentials\n   strategy:\n     matrix:\n       # OSX builders running tests, these run the full test suite."}, {"sha": "13c55610e1a46afb6fecf64c2a6c4ff93df36c64", "filename": "src/ci/azure-pipelines/master.yml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/750ad2097e8b4126484cd4600bfe8e8453da04fc/src%2Fci%2Fazure-pipelines%2Fmaster.yml", "raw_url": "https://github.com/rust-lang/rust/raw/750ad2097e8b4126484cd4600bfe8e8453da04fc/src%2Fci%2Fazure-pipelines%2Fmaster.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fazure-pipelines%2Fmaster.yml?ref=750ad2097e8b4126484cd4600bfe8e8453da04fc", "patch": "@@ -18,7 +18,7 @@ trigger:\n   - master\n \n variables:\n-- group: prod-credentials\n+- group: dummy-credentials\n \n pool:\n   vmImage: ubuntu-16.04"}, {"sha": "eebc5ccdaf69cfbf4476286513c14af2843c0bc1", "filename": "src/ci/azure-pipelines/try.yml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/750ad2097e8b4126484cd4600bfe8e8453da04fc/src%2Fci%2Fazure-pipelines%2Ftry.yml", "raw_url": "https://github.com/rust-lang/rust/raw/750ad2097e8b4126484cd4600bfe8e8453da04fc/src%2Fci%2Fazure-pipelines%2Ftry.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fazure-pipelines%2Ftry.yml?ref=750ad2097e8b4126484cd4600bfe8e8453da04fc", "patch": "@@ -14,7 +14,7 @@ trigger:\n - try\n \n variables:\n-- group: prod-credentials\n+- group: dummy-credentials\n \n jobs:\n - job: Linux"}, {"sha": "425e34f1af624b91f89d594c0dbd34205b6d41a3", "filename": "src/ci/github-actions/ci.yml", "status": "modified", "additions": 19, "deletions": 4, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/750ad2097e8b4126484cd4600bfe8e8453da04fc/src%2Fci%2Fgithub-actions%2Fci.yml", "raw_url": "https://github.com/rust-lang/rust/raw/750ad2097e8b4126484cd4600bfe8e8453da04fc/src%2Fci%2Fgithub-actions%2Fci.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fgithub-actions%2Fci.yml?ref=750ad2097e8b4126484cd4600bfe8e8453da04fc", "patch": "@@ -35,11 +35,26 @@ x--expand-yaml-anchors--remove:\n     CI_JOB_NAME: ${{ matrix.name }}\n \n   - &public-variables\n-    SCCACHE_BUCKET: rust-lang-gha-caches\n-    TOOLSTATE_REPO: https://github.com/pietroalbini/rust-toolstate\n-    CACHE_DOMAIN: ci-caches-gha.rust-lang.org\n+    SCCACHE_BUCKET: rust-lang-ci-sccache2\n+    TOOLSTATE_REPO: https://github.com/rust-lang-nursery/rust-toolstate\n+    CACHE_DOMAIN: ci-caches.rust-lang.org\n \n   - &prod-variables\n+    SCCACHE_BUCKET: rust-lang-ci-sccache2\n+    DEPLOY_BUCKET: rust-lang-ci2\n+    TOOLSTATE_REPO: https://github.com/rust-lang-nursery/rust-toolstate\n+    TOOLSTATE_ISSUES_API_URL: https://api.github.com/repos/rust-lang/rust/issues\n+    TOOLSTATE_PUBLISH: 1\n+    # AWS_SECRET_ACCESS_KEYs are stored in GitHub's secrets storage, named\n+    # AWS_SECRET_ACCESS_KEY_<keyid>. Including the key id in the name allows to\n+    # rotate them in a single branch while keeping the old key in another\n+    # branch, which wouldn't be possible if the key was named with the kind\n+    # (caches, artifacts...).\n+    CACHES_AWS_ACCESS_KEY_ID: AKIA46X5W6CZI5DHEBFL\n+    ARTIFACTS_AWS_ACCESS_KEY_ID: AKIA46X5W6CZN24CBO55\n+    CACHE_DOMAIN: ci-caches.rust-lang.org\n+\n+  - &dummy-variables\n     SCCACHE_BUCKET: rust-lang-gha-caches\n     DEPLOY_BUCKET: rust-lang-gha\n     TOOLSTATE_REPO: https://github.com/pietroalbini/rust-toolstate\n@@ -565,7 +580,7 @@ jobs:\n     <<: *base-ci-job\n     name: auto-fallible\n     env:\n-      <<: [*shared-ci-variables, *prod-variables]\n+      <<: [*shared-ci-variables, *dummy-variables]\n     if: github.event_name == 'push' && github.ref == 'refs/heads/auto' && github.repository == 'rust-lang-ci/rust'\n     strategy:\n       matrix:"}]}