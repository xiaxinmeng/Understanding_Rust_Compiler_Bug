{"sha": "67cf3ba528ac99dbec7753f81ed93eccd1a5a730", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY3Y2YzYmE1MjhhYzk5ZGJlYzc3NTNmODFlZDkzZWNjZDFhNWE3MzA=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-07-22T14:10:09Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-07-22T14:10:09Z"}, "message": "Rollup merge of #51807 - newpavlov:deprecate_str_slice, r=alexcrichton\n\nDeprecation of str::slice_unchecked(_mut)\n\nCloses #51715\n\nI am not sure if 1.28.0 or 1.29.0 should be used for deprecation version, for now it's 1.28.0.\n\nAdditionally I've replaced `slice_unchecked` uses with `get_unchecked`. The only places where this method is still used are `src/liballoc/tests/str.rs` and `src/liballoc/tests/str.rs`.", "tree": {"sha": "779545a0a1f604f3aa04c381ce16d0807df57e2f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/779545a0a1f604f3aa04c381ce16d0807df57e2f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/67cf3ba528ac99dbec7753f81ed93eccd1a5a730", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbVJBBCRBK7hj4Ov3rIwAAdHIIAHiCzkaExnSziT69V1SNIaSK\nK6fNsYwWSjR0lXx0xYEatvznMZ00eKQqaDkU7RqOLZSUEUD5tQ0YsI0dgZmtf5gH\n5XJuXO3HGy+Id8gMmC7d1f/cszAxdyuVuImWs66E2tAak4p6vpJTxtbk4abKQyAQ\nhJ37jlWqOnlRKloy/mPqtSo22cqlEc9xJvYg98nGIJEVBQUez7QNhBjo0+8TGFt3\nj4beQ037nLygK0mT9AQP5vqfhdUkxsq3dmOFCQCKzRTZL8fTIrr3TDJZ9a4KCL8P\n43eL1KC1kpPXBuNn9zCKwDyI9iBHGP3MRsWlRadOLgB8hBvpOclNiTdz/8ZzE4g=\n=AmI7\n-----END PGP SIGNATURE-----\n", "payload": "tree 779545a0a1f604f3aa04c381ce16d0807df57e2f\nparent d3b3bc57670ab91a53b2100cf3dfe78947bfe077\nparent 808bcfbe53cec7aa6d728148fc2fcb3a4c951009\nauthor kennytm <kennytm@gmail.com> 1532268609 +0800\ncommitter GitHub <noreply@github.com> 1532268609 +0800\n\nRollup merge of #51807 - newpavlov:deprecate_str_slice, r=alexcrichton\n\nDeprecation of str::slice_unchecked(_mut)\n\nCloses #51715\n\nI am not sure if 1.28.0 or 1.29.0 should be used for deprecation version, for now it's 1.28.0.\n\nAdditionally I've replaced `slice_unchecked` uses with `get_unchecked`. The only places where this method is still used are `src/liballoc/tests/str.rs` and `src/liballoc/tests/str.rs`.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/67cf3ba528ac99dbec7753f81ed93eccd1a5a730", "html_url": "https://github.com/rust-lang/rust/commit/67cf3ba528ac99dbec7753f81ed93eccd1a5a730", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/67cf3ba528ac99dbec7753f81ed93eccd1a5a730/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d3b3bc57670ab91a53b2100cf3dfe78947bfe077", "url": "https://api.github.com/repos/rust-lang/rust/commits/d3b3bc57670ab91a53b2100cf3dfe78947bfe077", "html_url": "https://github.com/rust-lang/rust/commit/d3b3bc57670ab91a53b2100cf3dfe78947bfe077"}, {"sha": "808bcfbe53cec7aa6d728148fc2fcb3a4c951009", "url": "https://api.github.com/repos/rust-lang/rust/commits/808bcfbe53cec7aa6d728148fc2fcb3a4c951009", "html_url": "https://github.com/rust-lang/rust/commit/808bcfbe53cec7aa6d728148fc2fcb3a4c951009"}], "stats": {"total": 48, "additions": 25, "deletions": 23}, "files": [{"sha": "870bf971cd3f626d82c086dfd5021a94378b2df8", "filename": "src/liballoc/str.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/67cf3ba528ac99dbec7753f81ed93eccd1a5a730/src%2Fliballoc%2Fstr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/67cf3ba528ac99dbec7753f81ed93eccd1a5a730/src%2Fliballoc%2Fstr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Fstr.rs?ref=67cf3ba528ac99dbec7753f81ed93eccd1a5a730", "patch": "@@ -268,11 +268,11 @@ impl str {\n         let mut result = String::new();\n         let mut last_end = 0;\n         for (start, part) in self.match_indices(from) {\n-            result.push_str(unsafe { self.slice_unchecked(last_end, start) });\n+            result.push_str(unsafe { self.get_unchecked(last_end..start) });\n             result.push_str(to);\n             last_end = start + part.len();\n         }\n-        result.push_str(unsafe { self.slice_unchecked(last_end, self.len()) });\n+        result.push_str(unsafe { self.get_unchecked(last_end..self.len()) });\n         result\n     }\n \n@@ -309,11 +309,11 @@ impl str {\n         let mut result = String::with_capacity(32);\n         let mut last_end = 0;\n         for (start, part) in self.match_indices(pat).take(count) {\n-            result.push_str(unsafe { self.slice_unchecked(last_end, start) });\n+            result.push_str(unsafe { self.get_unchecked(last_end..start) });\n             result.push_str(to);\n             last_end = start + part.len();\n         }\n-        result.push_str(unsafe { self.slice_unchecked(last_end, self.len()) });\n+        result.push_str(unsafe { self.get_unchecked(last_end..self.len()) });\n         result\n     }\n "}, {"sha": "631779a17a1655e6e261e9864f277d3ae32bc881", "filename": "src/liballoc/string.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/67cf3ba528ac99dbec7753f81ed93eccd1a5a730/src%2Fliballoc%2Fstring.rs", "raw_url": "https://github.com/rust-lang/rust/raw/67cf3ba528ac99dbec7753f81ed93eccd1a5a730/src%2Fliballoc%2Fstring.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Fstring.rs?ref=67cf3ba528ac99dbec7753f81ed93eccd1a5a730", "patch": "@@ -1222,7 +1222,7 @@ impl String {\n \n         while idx < len {\n             let ch = unsafe {\n-                self.slice_unchecked(idx, len).chars().next().unwrap()\n+                self.get_unchecked(idx..len).chars().next().unwrap()\n             };\n             let ch_len = ch.len_utf8();\n "}, {"sha": "6275c7bb112063dc2205fc75698a7d6f7b8d3ba1", "filename": "src/liballoc/tests/str.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/67cf3ba528ac99dbec7753f81ed93eccd1a5a730/src%2Fliballoc%2Ftests%2Fstr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/67cf3ba528ac99dbec7753f81ed93eccd1a5a730/src%2Fliballoc%2Ftests%2Fstr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Ftests%2Fstr.rs?ref=67cf3ba528ac99dbec7753f81ed93eccd1a5a730", "patch": "@@ -177,9 +177,9 @@ fn test_join_for_different_lengths_with_long_separator() {\n \n #[test]\n fn test_unsafe_slice() {\n-    assert_eq!(\"ab\", unsafe {\"abc\".slice_unchecked(0, 2)});\n-    assert_eq!(\"bc\", unsafe {\"abc\".slice_unchecked(1, 3)});\n-    assert_eq!(\"\", unsafe {\"abc\".slice_unchecked(1, 1)});\n+    assert_eq!(\"ab\", unsafe {\"abc\".get_unchecked(0..2)});\n+    assert_eq!(\"bc\", unsafe {\"abc\".get_unchecked(1..3)});\n+    assert_eq!(\"\", unsafe {\"abc\".get_unchecked(1..1)});\n     fn a_million_letter_a() -> String {\n         let mut i = 0;\n         let mut rs = String::new();\n@@ -200,7 +200,7 @@ fn test_unsafe_slice() {\n     }\n     let letters = a_million_letter_a();\n     assert_eq!(half_a_million_letter_a(),\n-        unsafe { letters.slice_unchecked(0, 500000)});\n+        unsafe { letters.get_unchecked(0..500000)});\n }\n \n #[test]"}, {"sha": "3e215de58dd219be108ee841a3324449b7928a34", "filename": "src/libcore/str/mod.rs", "status": "modified", "additions": 15, "deletions": 13, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/67cf3ba528ac99dbec7753f81ed93eccd1a5a730/src%2Flibcore%2Fstr%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/67cf3ba528ac99dbec7753f81ed93eccd1a5a730/src%2Flibcore%2Fstr%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fstr%2Fmod.rs?ref=67cf3ba528ac99dbec7753f81ed93eccd1a5a730", "patch": "@@ -1055,7 +1055,7 @@ impl<'a, P: Pattern<'a>> SplitInternal<'a, P> {\n         if !self.finished && (self.allow_trailing_empty || self.end - self.start > 0) {\n             self.finished = true;\n             unsafe {\n-                let string = self.matcher.haystack().slice_unchecked(self.start, self.end);\n+                let string = self.matcher.haystack().get_unchecked(self.start..self.end);\n                 Some(string)\n             }\n         } else {\n@@ -1070,7 +1070,7 @@ impl<'a, P: Pattern<'a>> SplitInternal<'a, P> {\n         let haystack = self.matcher.haystack();\n         match self.matcher.next_match() {\n             Some((a, b)) => unsafe {\n-                let elt = haystack.slice_unchecked(self.start, a);\n+                let elt = haystack.get_unchecked(self.start..a);\n                 self.start = b;\n                 Some(elt)\n             },\n@@ -1095,13 +1095,13 @@ impl<'a, P: Pattern<'a>> SplitInternal<'a, P> {\n         let haystack = self.matcher.haystack();\n         match self.matcher.next_match_back() {\n             Some((a, b)) => unsafe {\n-                let elt = haystack.slice_unchecked(b, self.end);\n+                let elt = haystack.get_unchecked(b..self.end);\n                 self.end = a;\n                 Some(elt)\n             },\n             None => unsafe {\n                 self.finished = true;\n-                Some(haystack.slice_unchecked(self.start, self.end))\n+                Some(haystack.get_unchecked(self.start..self.end))\n             },\n         }\n     }\n@@ -1222,7 +1222,7 @@ impl<'a, P: Pattern<'a>> MatchIndicesInternal<'a, P> {\n     #[inline]\n     fn next(&mut self) -> Option<(usize, &'a str)> {\n         self.0.next_match().map(|(start, end)| unsafe {\n-            (start, self.0.haystack().slice_unchecked(start, end))\n+            (start, self.0.haystack().get_unchecked(start..end))\n         })\n     }\n \n@@ -1231,7 +1231,7 @@ impl<'a, P: Pattern<'a>> MatchIndicesInternal<'a, P> {\n         where P::Searcher: ReverseSearcher<'a>\n     {\n         self.0.next_match_back().map(|(start, end)| unsafe {\n-            (start, self.0.haystack().slice_unchecked(start, end))\n+            (start, self.0.haystack().get_unchecked(start..end))\n         })\n     }\n }\n@@ -1274,7 +1274,7 @@ impl<'a, P: Pattern<'a>> MatchesInternal<'a, P> {\n     fn next(&mut self) -> Option<&'a str> {\n         self.0.next_match().map(|(a, b)| unsafe {\n             // Indices are known to be on utf8 boundaries\n-            self.0.haystack().slice_unchecked(a, b)\n+            self.0.haystack().get_unchecked(a..b)\n         })\n     }\n \n@@ -1284,7 +1284,7 @@ impl<'a, P: Pattern<'a>> MatchesInternal<'a, P> {\n     {\n         self.0.next_match_back().map(|(a, b)| unsafe {\n             // Indices are known to be on utf8 boundaries\n-            self.0.haystack().slice_unchecked(a, b)\n+            self.0.haystack().get_unchecked(a..b)\n         })\n     }\n }\n@@ -2453,6 +2453,7 @@ impl str {\n     /// }\n     /// ```\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n+    #[rustc_deprecated(since = \"1.29.0\", reason = \"use `get_unchecked(begin..end)` instead\")]\n     #[inline]\n     pub unsafe fn slice_unchecked(&self, begin: usize, end: usize) -> &str {\n         (begin..end).get_unchecked(self)\n@@ -2483,6 +2484,7 @@ impl str {\n     /// * `begin` and `end` must be byte positions within the string slice.\n     /// * `begin` and `end` must lie on UTF-8 sequence boundaries.\n     #[stable(feature = \"str_slice_mut\", since = \"1.5.0\")]\n+    #[rustc_deprecated(since = \"1.29.0\", reason = \"use `get_unchecked_mut(begin..end)` instead\")]\n     #[inline]\n     pub unsafe fn slice_mut_unchecked(&mut self, begin: usize, end: usize) -> &mut str {\n         (begin..end).get_unchecked_mut(self)\n@@ -2524,8 +2526,8 @@ impl str {\n         // is_char_boundary checks that the index is in [0, .len()]\n         if self.is_char_boundary(mid) {\n             unsafe {\n-                (self.slice_unchecked(0, mid),\n-                 self.slice_unchecked(mid, self.len()))\n+                (self.get_unchecked(0..mid),\n+                 self.get_unchecked(mid..self.len()))\n             }\n         } else {\n             slice_error_fail(self, 0, mid)\n@@ -3702,7 +3704,7 @@ impl str {\n         }\n         unsafe {\n             // Searcher is known to return valid indices\n-            self.slice_unchecked(i, j)\n+            self.get_unchecked(i..j)\n         }\n     }\n \n@@ -3741,7 +3743,7 @@ impl str {\n         }\n         unsafe {\n             // Searcher is known to return valid indices\n-            self.slice_unchecked(i, self.len())\n+            self.get_unchecked(i..self.len())\n         }\n     }\n \n@@ -3788,7 +3790,7 @@ impl str {\n         }\n         unsafe {\n             // Searcher is known to return valid indices\n-            self.slice_unchecked(0, j)\n+            self.get_unchecked(0..j)\n         }\n     }\n "}, {"sha": "5e63fa9ff354c60d1adcb892041a8077a323b956", "filename": "src/libcore/str/pattern.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/67cf3ba528ac99dbec7753f81ed93eccd1a5a730/src%2Flibcore%2Fstr%2Fpattern.rs", "raw_url": "https://github.com/rust-lang/rust/raw/67cf3ba528ac99dbec7753f81ed93eccd1a5a730/src%2Flibcore%2Fstr%2Fpattern.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fstr%2Fpattern.rs?ref=67cf3ba528ac99dbec7753f81ed93eccd1a5a730", "patch": "@@ -354,7 +354,7 @@ unsafe impl<'a> ReverseSearcher<'a> for CharSearcher<'a> {\n     #[inline]\n     fn next_back(&mut self) -> SearchStep {\n         let old_finger = self.finger_back;\n-        let slice = unsafe { self.haystack.slice_unchecked(self.finger, old_finger) };\n+        let slice = unsafe { self.haystack.get_unchecked(self.finger..old_finger) };\n         let mut iter = slice.chars();\n         let old_len = iter.iter.len();\n         if let Some(ch) = iter.next_back() {"}]}