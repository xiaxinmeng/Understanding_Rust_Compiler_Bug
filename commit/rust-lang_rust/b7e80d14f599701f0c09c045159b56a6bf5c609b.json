{"sha": "b7e80d14f599701f0c09c045159b56a6bf5c609b", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI3ZTgwZDE0ZjU5OTcwMWYwYzA5YzA0NTE1OWI1NmE2YmY1YzYwOWI=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-07-21T18:52:49Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-07-21T18:52:49Z"}, "message": "Merge #9668\n\n9668: minor: Simplify r=Veykril a=Veykril\n\nbors r+\n\nCo-authored-by: Lukas Wirth <lukastw97@gmail.com>", "tree": {"sha": "3ff857f2e714dc82887cdcc27c12febd0ced94cc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3ff857f2e714dc82887cdcc27c12febd0ced94cc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b7e80d14f599701f0c09c045159b56a6bf5c609b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJg+G0BCRBK7hj4Ov3rIwAAE6YIAHrCPou6V2xVSi8ZruZPXEXM\nnapQo7XZrAIyTHfI6iuN4uW8nJybC6JsR5R8eM9VRz/6QFNFi6vbPcR5nSxmsN0j\n/SDg7bjE1BvXGlvVZ+jFmcURJbSSz111FRvaNxi8IGMIYgmXUhR/ehv2+6vVk7CR\n+Syn77MbLwQkabWJOMEZxRDh87eYC1EHRL1qD6eRrq5Vuyi5lupBaxNdJ5lIzXWz\nqlqRy16FW53U75oE+v1mUAWyuELAj7q/wdPNJaosX3DzmBkga6rlTqfsWCye+biV\n5bklUZcMYM+WPMhECJMuX/smS5kzV3jUvP4PO8uvNJsMy09l4MUUMIRwiLBwbtk=\n=nld1\n-----END PGP SIGNATURE-----\n", "payload": "tree 3ff857f2e714dc82887cdcc27c12febd0ced94cc\nparent 695f315d64a6cae48022ebea01edb0544bd7b615\nparent dfdf6fd9f8fd30b7fca495a43459e5cb7299cafa\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1626893569 +0000\ncommitter GitHub <noreply@github.com> 1626893569 +0000\n\nMerge #9668\n\n9668: minor: Simplify r=Veykril a=Veykril\n\nbors r+\n\nCo-authored-by: Lukas Wirth <lukastw97@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b7e80d14f599701f0c09c045159b56a6bf5c609b", "html_url": "https://github.com/rust-lang/rust/commit/b7e80d14f599701f0c09c045159b56a6bf5c609b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b7e80d14f599701f0c09c045159b56a6bf5c609b/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "695f315d64a6cae48022ebea01edb0544bd7b615", "url": "https://api.github.com/repos/rust-lang/rust/commits/695f315d64a6cae48022ebea01edb0544bd7b615", "html_url": "https://github.com/rust-lang/rust/commit/695f315d64a6cae48022ebea01edb0544bd7b615"}, {"sha": "dfdf6fd9f8fd30b7fca495a43459e5cb7299cafa", "url": "https://api.github.com/repos/rust-lang/rust/commits/dfdf6fd9f8fd30b7fca495a43459e5cb7299cafa", "html_url": "https://github.com/rust-lang/rust/commit/dfdf6fd9f8fd30b7fca495a43459e5cb7299cafa"}], "stats": {"total": 51, "additions": 22, "deletions": 29}, "files": [{"sha": "be5f063f0fca852233e39c6201dc69b6d5d78806", "filename": "crates/ide_db/src/assists.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fide_db%2Fsrc%2Fassists.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fide_db%2Fsrc%2Fassists.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_db%2Fsrc%2Fassists.rs?ref=b7e80d14f599701f0c09c045159b56a6bf5c609b", "patch": "@@ -52,12 +52,12 @@ impl AssistKind {\n \n         match self {\n             AssistKind::None | AssistKind::Generate => true,\n-            AssistKind::Refactor => match other {\n+            AssistKind::Refactor => matches!(\n+                other,\n                 AssistKind::RefactorExtract\n-                | AssistKind::RefactorInline\n-                | AssistKind::RefactorRewrite => true,\n-                _ => false,\n-            },\n+                    | AssistKind::RefactorInline\n+                    | AssistKind::RefactorRewrite\n+            ),\n             _ => false,\n         }\n     }"}, {"sha": "da3b9bf1e9c75f70b93e165224b51d029842622e", "filename": "crates/ide_db/src/call_info.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fide_db%2Fsrc%2Fcall_info.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fide_db%2Fsrc%2Fcall_info.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_db%2Fsrc%2Fcall_info.rs?ref=b7e80d14f599701f0c09c045159b56a6bf5c609b", "patch": "@@ -166,7 +166,7 @@ impl ActiveParameter {\n \n         let idx = active_parameter?;\n         let mut params = signature.params(sema.db);\n-        if !(idx < params.len()) {\n+        if params.len() <= idx {\n             cov_mark::hit!(too_many_arguments);\n             return None;\n         }"}, {"sha": "e9fb71fd8cd000a38f56b1bad667898aa720fdaa", "filename": "crates/ide_db/src/defs.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fide_db%2Fsrc%2Fdefs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fide_db%2Fsrc%2Fdefs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_db%2Fsrc%2Fdefs.rs?ref=b7e80d14f599701f0c09c045159b56a6bf5c609b", "patch": "@@ -153,7 +153,7 @@ impl NameClass {\n                                         path_segment.name_ref()\n                                     },\n                                     PathSegmentKind::Name(name_ref) => Some(name_ref),\n-                                    _ => return None,\n+                                    _ => None,\n                                 }\n                             })\n                             .and_then(|name_ref| NameRefClass::classify(sema, &name_ref))?;\n@@ -341,7 +341,7 @@ impl NameRefClass {\n                             hir::AssocItem::TypeAlias(it) => Some(*it),\n                             _ => None,\n                         })\n-                        .find(|alias| &alias.name(sema.db).to_string() == &name_ref.text())\n+                        .find(|alias| alias.name(sema.db).to_string() == name_ref.text())\n                     {\n                         return Some(NameRefClass::Definition(Definition::ModuleDef(\n                             ModuleDef::TypeAlias(ty),"}, {"sha": "80cc2ca815eed440c4086f822b3c9cfe7d5cb366", "filename": "crates/ide_db/src/helpers/insert_use.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fide_db%2Fsrc%2Fhelpers%2Finsert_use.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fide_db%2Fsrc%2Fhelpers%2Finsert_use.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_db%2Fsrc%2Fhelpers%2Finsert_use.rs?ref=b7e80d14f599701f0c09c045159b56a6bf5c609b", "patch": "@@ -181,7 +181,7 @@ enum ImportGranularityGuess {\n }\n \n /// Insert an import path into the given file/node. A `merge` value of none indicates that no import merging is allowed to occur.\n-pub fn insert_use<'a>(scope: &ImportScope, path: ast::Path, cfg: &InsertUseConfig) {\n+pub fn insert_use(scope: &ImportScope, path: ast::Path, cfg: &InsertUseConfig) {\n     let _p = profile::span(\"insert_use\");\n     let mut mb = match cfg.granularity {\n         ImportGranularity::Crate => Some(MergeBehavior::Crate),"}, {"sha": "69fc84874c4c6c807b65b3e73413e8410527c5e6", "filename": "crates/ide_db/src/helpers/merge_imports.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fide_db%2Fsrc%2Fhelpers%2Fmerge_imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fide_db%2Fsrc%2Fhelpers%2Fmerge_imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_db%2Fsrc%2Fhelpers%2Fmerge_imports.rs?ref=b7e80d14f599701f0c09c045159b56a6bf5c609b", "patch": "@@ -162,7 +162,7 @@ fn recursive_merge(\n             }\n             Err(_)\n                 if merge == MergeBehavior::Module\n-                    && use_trees.len() > 0\n+                    && !use_trees.is_empty()\n                     && rhs_t.use_tree_list().is_some() =>\n             {\n                 return None"}, {"sha": "4c2133e65b157668a7541d933531f646a014abf9", "filename": "crates/ide_db/src/source_change.rs", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fide_db%2Fsrc%2Fsource_change.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fide_db%2Fsrc%2Fsource_change.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_db%2Fsrc%2Fsource_change.rs?ref=b7e80d14f599701f0c09c045159b56a6bf5c609b", "patch": "@@ -3,10 +3,7 @@\n //!\n //! It can be viewed as a dual for `Change`.\n \n-use std::{\n-    collections::hash_map::Entry,\n-    iter::{self, FromIterator},\n-};\n+use std::{collections::hash_map::Entry, iter};\n \n use base_db::{AnchoredPathBuf, FileId};\n use rustc_hash::FxHashMap;\n@@ -32,7 +29,7 @@ impl SourceChange {\n \n     pub fn from_text_edit(file_id: FileId, edit: TextEdit) -> Self {\n         SourceChange {\n-            source_file_edits: FxHashMap::from_iter(iter::once((file_id, edit))),\n+            source_file_edits: iter::once((file_id, edit)).collect(),\n             ..Default::default()\n         }\n     }"}, {"sha": "370d0df0076db359286fe40012553f3d944204b8", "filename": "crates/ide_db/src/ty_filter.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fide_db%2Fsrc%2Fty_filter.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fide_db%2Fsrc%2Fty_filter.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_db%2Fsrc%2Fty_filter.rs?ref=b7e80d14f599701f0c09c045159b56a6bf5c609b", "patch": "@@ -26,7 +26,7 @@ impl TryEnum {\n             _ => return None,\n         };\n         TryEnum::ALL.iter().find_map(|&var| {\n-            if &enum_.name(sema.db).to_string() == var.type_name() {\n+            if enum_.name(sema.db).to_string() == var.type_name() {\n                 return Some(var);\n             }\n             None"}, {"sha": "8b03ade81f70dc0d8182438104ae394375e17ab1", "filename": "crates/parser/src/grammar/params.rs", "status": "modified", "additions": 8, "deletions": 12, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fparser%2Fsrc%2Fgrammar%2Fparams.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fparser%2Fsrc%2Fgrammar%2Fparams.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Fsrc%2Fgrammar%2Fparams.rs?ref=b7e80d14f599701f0c09c045159b56a6bf5c609b", "patch": "@@ -105,14 +105,12 @@ fn param(p: &mut Parser, m: Marker, flavor: Flavor) -> Variadic {\n             patterns::pattern(p);\n             if variadic_param(p) {\n                 res = Variadic(true)\n+            } else if p.at(T![:]) {\n+                types::ascription(p)\n             } else {\n-                if p.at(T![:]) {\n-                    types::ascription(p)\n-                } else {\n-                    // test_err missing_fn_param_type\n-                    // fn f(x y: i32, z, t: i32) {}\n-                    p.error(\"missing type for function parameter\")\n-                }\n+                // test_err missing_fn_param_type\n+                // fn f(x y: i32, z, t: i32) {}\n+                p.error(\"missing type for function parameter\")\n             }\n         }\n         // test value_parameters_no_patterns\n@@ -131,12 +129,10 @@ fn param(p: &mut Parser, m: Marker, flavor: Flavor) -> Variadic {\n                 patterns::pattern_single(p);\n                 if variadic_param(p) {\n                     res = Variadic(true)\n+                } else if p.at(T![:]) {\n+                    types::ascription(p)\n                 } else {\n-                    if p.at(T![:]) {\n-                        types::ascription(p)\n-                    } else {\n-                        p.error(\"missing type for function parameter\")\n-                    }\n+                    p.error(\"missing type for function parameter\")\n                 }\n             } else {\n                 types::type_(p);"}, {"sha": "73d662818022fd6c12a58af59a480d39b4108edc", "filename": "crates/syntax/src/ast/node_ext.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fsyntax%2Fsrc%2Fast%2Fnode_ext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b7e80d14f599701f0c09c045159b56a6bf5c609b/crates%2Fsyntax%2Fsrc%2Fast%2Fnode_ext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fsyntax%2Fsrc%2Fast%2Fnode_ext.rs?ref=b7e80d14f599701f0c09c045159b56a6bf5c609b", "patch": "@@ -91,7 +91,7 @@ impl ast::Expr {\n                                         | ast::Effect::Const(_)\n                                 )\n                             }\n-                            ast::Expr::ClosureExpr(__) => true,\n+                            ast::Expr::ClosureExpr(_) => true,\n                             _ => false,\n                         };\n                         cb(expr);"}]}