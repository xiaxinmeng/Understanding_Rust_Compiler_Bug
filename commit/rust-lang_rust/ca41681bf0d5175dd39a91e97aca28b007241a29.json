{"sha": "ca41681bf0d5175dd39a91e97aca28b007241a29", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNhNDE2ODFiZjBkNTE3NWRkMzlhOTFlOTdhY2EyOGIwMDcyNDFhMjk=", "commit": {"author": {"name": "Santiago Pastorino", "email": "spastorino@gmail.com", "date": "2020-10-20T16:30:47Z"}, "committer": {"name": "Santiago Pastorino", "email": "spastorino@gmail.com", "date": "2020-10-27T17:45:38Z"}, "message": "Do not use unsized_fn_params in patterns", "tree": {"sha": "e29710e2a03892d07237e16b669e9c897afb855c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e29710e2a03892d07237e16b669e9c897afb855c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ca41681bf0d5175dd39a91e97aca28b007241a29", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEF0ntrgrd9qf9uuThgTGiTgx5768FAl+YXMIACgkQgTGiTgx5\n76/zLw/+L8mzVpftdGWNWmbAIxLnpUV5VsgTRtN43GLMTwzY/2YlTWOfenQdiDQs\n9AwIFLbsR7Hsfxhf4r/i0EFuoib0JS0LP1LhfXK6X7KUAXnYZ79q3Bs97j8YPoW8\nDCDYqqV5IH6HE9mD8Y+yMz3kZZ6RDKkaQmJ4REem+gMLSflPdpRolrA/QAqDh/Di\nwvkcLxSEBDC8ZoE137y4yQpTFmeX9A6jhU+DqJrftk6aq4NGgoPSCehuzGF1c6cr\n2Y01/h6lhPV80qedW79DbMvNYdU6EKT764p2kf3PkhrQ8Vm9HdTmtJb8yPS7qVEC\niCEzR/hUUIJpSfeMeWl0E2brWdtQX+YJtIL/1lEgfWrJjXqcaIDFDNu/WCSlcWAy\nmmBu5kKi8BrQsggeQQZ7bogrnlDKEpQ+dgIbiYS88l9B5Byn0YCzrTiQQea/oFGB\naHHB1F+6UPdFlQOff75Yao0XLYNDuTwf/pCnlUIhKXKluq8k38Ecqnb8JLqSYmJg\nXVGkmnMwAfswunKIHo95dLDc3XLOIqTCcjgUkNeIydaSQOB3WMWk7+CRuFrtGJ2P\ntLEtWtkvqQmYfy64bFQOSFVlLH2tEgSpNusz4vmWyJvg050196Tk9TZEK1fBZfRo\nALBtnMUq+kGD+13Q3NuHGE90Tq4f/uY1ADCQCq6/Ts1QHYdEM7M=\n=8kVG\n-----END PGP SIGNATURE-----", "payload": "tree e29710e2a03892d07237e16b669e9c897afb855c\nparent 58018d438b3e14624bf33a9c0d2031e906797b8d\nauthor Santiago Pastorino <spastorino@gmail.com> 1603211447 -0300\ncommitter Santiago Pastorino <spastorino@gmail.com> 1603820738 -0300\n\nDo not use unsized_fn_params in patterns\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ca41681bf0d5175dd39a91e97aca28b007241a29", "html_url": "https://github.com/rust-lang/rust/commit/ca41681bf0d5175dd39a91e97aca28b007241a29", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ca41681bf0d5175dd39a91e97aca28b007241a29/comments", "author": {"login": "spastorino", "id": 52642, "node_id": "MDQ6VXNlcjUyNjQy", "avatar_url": "https://avatars.githubusercontent.com/u/52642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spastorino", "html_url": "https://github.com/spastorino", "followers_url": "https://api.github.com/users/spastorino/followers", "following_url": "https://api.github.com/users/spastorino/following{/other_user}", "gists_url": "https://api.github.com/users/spastorino/gists{/gist_id}", "starred_url": "https://api.github.com/users/spastorino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spastorino/subscriptions", "organizations_url": "https://api.github.com/users/spastorino/orgs", "repos_url": "https://api.github.com/users/spastorino/repos", "events_url": "https://api.github.com/users/spastorino/events{/privacy}", "received_events_url": "https://api.github.com/users/spastorino/received_events", "type": "User", "site_admin": false}, "committer": {"login": "spastorino", "id": 52642, "node_id": "MDQ6VXNlcjUyNjQy", "avatar_url": "https://avatars.githubusercontent.com/u/52642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spastorino", "html_url": "https://github.com/spastorino", "followers_url": "https://api.github.com/users/spastorino/followers", "following_url": "https://api.github.com/users/spastorino/following{/other_user}", "gists_url": "https://api.github.com/users/spastorino/gists{/gist_id}", "starred_url": "https://api.github.com/users/spastorino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spastorino/subscriptions", "organizations_url": "https://api.github.com/users/spastorino/orgs", "repos_url": "https://api.github.com/users/spastorino/repos", "events_url": "https://api.github.com/users/spastorino/events{/privacy}", "received_events_url": "https://api.github.com/users/spastorino/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "58018d438b3e14624bf33a9c0d2031e906797b8d", "url": "https://api.github.com/repos/rust-lang/rust/commits/58018d438b3e14624bf33a9c0d2031e906797b8d", "html_url": "https://github.com/rust-lang/rust/commit/58018d438b3e14624bf33a9c0d2031e906797b8d"}], "stats": {"total": 38, "additions": 37, "deletions": 1}, "files": [{"sha": "b2e5e3fe60445fc3b2cf74987fe60b5499dc6387", "filename": "compiler/rustc_typeck/src/check/gather_locals.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ca41681bf0d5175dd39a91e97aca28b007241a29/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fgather_locals.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca41681bf0d5175dd39a91e97aca28b007241a29/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fgather_locals.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fgather_locals.rs?ref=ca41681bf0d5175dd39a91e97aca28b007241a29", "patch": "@@ -129,7 +129,9 @@ impl<'a, 'tcx> Visitor<'tcx> for GatherLocalsVisitor<'a, 'tcx> {\n                 var_ty\n             );\n         }\n+        let old_within_fn_param = mem::replace(&mut self.within_fn_param, false);\n         intravisit::walk_pat(self, p);\n+        self.within_fn_param = old_within_fn_param;\n     }\n \n     // Don't descend into the bodies of nested closures."}, {"sha": "0b9b4ea5959b87a62f856423dc31f349e2a8cdc4", "filename": "src/test/ui/unsized-locals/unsized-local-pat.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/ca41681bf0d5175dd39a91e97aca28b007241a29/src%2Ftest%2Fui%2Funsized-locals%2Funsized-local-pat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca41681bf0d5175dd39a91e97aca28b007241a29/src%2Ftest%2Fui%2Funsized-locals%2Funsized-local-pat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Funsized-locals%2Funsized-local-pat.rs?ref=ca41681bf0d5175dd39a91e97aca28b007241a29", "patch": "@@ -0,0 +1,11 @@\n+#![feature(box_patterns)]\n+#![feature(unsized_fn_params)]\n+\n+#[allow(dead_code)]\n+fn f1(box box _b: Box<Box<[u8]>>) {}\n+//~^ ERROR: the size for values of type `[u8]` cannot be known at compilation time [E0277]\n+\n+fn f2((_x, _y): (i32, [i32])) {}\n+//~^ ERROR: the size for values of type `[i32]` cannot be known at compilation time [E0277]\n+\n+fn main() {}"}, {"sha": "ecb108d453d38f2724b7077cdd16e9fff164adac", "filename": "src/test/ui/unsized-locals/unsized-local-pat.stderr", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/ca41681bf0d5175dd39a91e97aca28b007241a29/src%2Ftest%2Fui%2Funsized-locals%2Funsized-local-pat.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ca41681bf0d5175dd39a91e97aca28b007241a29/src%2Ftest%2Fui%2Funsized-locals%2Funsized-local-pat.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Funsized-locals%2Funsized-local-pat.stderr?ref=ca41681bf0d5175dd39a91e97aca28b007241a29", "patch": "@@ -0,0 +1,23 @@\n+error[E0277]: the size for values of type `[u8]` cannot be known at compilation time\n+  --> $DIR/unsized-local-pat.rs:5:15\n+   |\n+LL | fn f1(box box _b: Box<Box<[u8]>>) {}\n+   |               ^^ doesn't have a size known at compile-time\n+   |\n+   = help: the trait `Sized` is not implemented for `[u8]`\n+   = note: all local variables must have a statically known size\n+   = help: unsized locals are gated as an unstable feature\n+\n+error[E0277]: the size for values of type `[i32]` cannot be known at compilation time\n+  --> $DIR/unsized-local-pat.rs:8:12\n+   |\n+LL | fn f2((_x, _y): (i32, [i32])) {}\n+   |            ^^ doesn't have a size known at compile-time\n+   |\n+   = help: the trait `Sized` is not implemented for `[i32]`\n+   = note: all local variables must have a statically known size\n+   = help: unsized locals are gated as an unstable feature\n+\n+error: aborting due to 2 previous errors\n+\n+For more information about this error, try `rustc --explain E0277`."}, {"sha": "a1b772a7eb689c75c3b802c56a97e1f24af6e4b1", "filename": "src/test/ui/unsized-locals/unsized-parameters.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ca41681bf0d5175dd39a91e97aca28b007241a29/src%2Ftest%2Fui%2Funsized-locals%2Funsized-parameters.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca41681bf0d5175dd39a91e97aca28b007241a29/src%2Ftest%2Fui%2Funsized-locals%2Funsized-parameters.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Funsized-locals%2Funsized-parameters.rs?ref=ca41681bf0d5175dd39a91e97aca28b007241a29", "patch": "@@ -5,7 +5,7 @@\n \n pub fn f0(_f: dyn FnOnce()) {}\n pub fn f1(_s: str) {}\n-pub fn f2((_x, _y): (i32, [i32])) {}\n+pub fn f2(_x: i32, _y: [i32]) {}\n \n fn main() {\n     let foo = \"foo\".to_string().into_boxed_str();"}]}