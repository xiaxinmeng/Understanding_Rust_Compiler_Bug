{"sha": "7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65", "node_id": "C_kwDOAAsO6NoAKDdkMWJmNzAyM2Q3YzExYzIwYmZjMzVjOWI5ZjRiZmEwMjc4NThkNjU", "commit": {"author": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2023-06-01T06:40:50Z"}, "committer": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2023-06-01T06:40:50Z"}, "message": "Recover from leading comma in tuple pat and expr", "tree": {"sha": "9e37a929cc91ec47884ebaef28bad7114d7cc94a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9e37a929cc91ec47884ebaef28bad7114d7cc94a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65", "html_url": "https://github.com/rust-lang/rust/commit/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65/comments", "author": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "42450d2511f8f174dc7448d0e9839d4b76d64482", "url": "https://api.github.com/repos/rust-lang/rust/commits/42450d2511f8f174dc7448d0e9839d4b76d64482", "html_url": "https://github.com/rust-lang/rust/commit/42450d2511f8f174dc7448d0e9839d4b76d64482"}], "stats": {"total": 93, "additions": 89, "deletions": 4}, "files": [{"sha": "9bd9a948e7f72c69247d1daa0bc41b7b7c9592a8", "filename": "crates/ide/src/signature_help.rs", "status": "modified", "additions": 13, "deletions": 4, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65/crates%2Fide%2Fsrc%2Fsignature_help.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65/crates%2Fide%2Fsrc%2Fsignature_help.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fsignature_help.rs?ref=7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65", "patch": "@@ -2003,23 +2003,32 @@ fn main() {\n     let _: (&str, u32, u32)= ($0, 1, 3);\n }\n \"#,\n-            expect![\"\"],\n+            expect![[r#\"\n+                (&str, u32)\n+                 ^^^^  ---\n+            \"#]],\n         );\n         check(\n             r#\"\n fn main() {\n     let _: (&str, u32, u32, u32)= ($0, 1, 3);\n }\n \"#,\n-            expect![\"\"],\n+            expect![[r#\"\n+                (&str, u32)\n+                 ^^^^  ---\n+            \"#]],\n         );\n         check(\n             r#\"\n fn main() {\n     let _: (&str, u32, u32)= ($0, 1, 3, 5);\n }\n \"#,\n-            expect![\"\"],\n+            expect![[r#\"\n+                (&str, u32, u32)\n+                 ^^^^  ---  ---\n+            \"#]],\n         );\n     }\n \n@@ -2111,7 +2120,7 @@ fn main() {\n         check(\n             r#\"\n fn main() {\n-    let ($0 1, 3): (i32, i32, i32);\n+    let ($0, 1, 3): (i32, i32, i32);\n }\n \"#,\n             // FIXME: tuple pat should be of size 3 ideally"}, {"sha": "d8553d3f953772ea277ec9f605bcc76d821ca0c5", "filename": "crates/parser/src/grammar/expressions/atom.rs", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65/crates%2Fparser%2Fsrc%2Fgrammar%2Fexpressions%2Fatom.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65/crates%2Fparser%2Fsrc%2Fgrammar%2Fexpressions%2Fatom.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Fsrc%2Fgrammar%2Fexpressions%2Fatom.rs?ref=7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65", "patch": "@@ -184,6 +184,16 @@ fn tuple_expr(p: &mut Parser<'_>) -> CompletedMarker {\n \n     let mut saw_comma = false;\n     let mut saw_expr = false;\n+\n+    // test_err tuple_expr_leading_comma\n+    // fn foo() {\n+    //     (,);\n+    // }\n+    if p.eat(T![,]) {\n+        p.error(\"expected expression\");\n+        saw_comma = true;\n+    }\n+\n     while !p.at(EOF) && !p.at(T![')']) {\n         saw_expr = true;\n "}, {"sha": "39ded41bb24133e82fcfec038f8f41211d47d081", "filename": "crates/parser/src/grammar/patterns.rs", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65/crates%2Fparser%2Fsrc%2Fgrammar%2Fpatterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65/crates%2Fparser%2Fsrc%2Fgrammar%2Fpatterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Fsrc%2Fgrammar%2Fpatterns.rs?ref=7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65", "patch": "@@ -413,6 +413,16 @@ fn tuple_pat(p: &mut Parser<'_>) -> CompletedMarker {\n     let mut has_comma = false;\n     let mut has_pat = false;\n     let mut has_rest = false;\n+\n+    // test_err tuple_pat_leading_comma\n+    // fn foo() {\n+    //     let (,);\n+    // }\n+    if p.eat(T![,]) {\n+        p.error(\"expected pattern\");\n+        has_comma = true;\n+    }\n+\n     while !p.at(EOF) && !p.at(T![')']) {\n         has_pat = true;\n         if !p.at_ts(PAT_TOP_FIRST) {"}, {"sha": "3fbc0da4002e4c7b1eee150794bf032c6487acbc", "filename": "crates/parser/test_data/parser/inline/err/0019_tuple_expr_leading_comma.rast", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0019_tuple_expr_leading_comma.rast", "raw_url": "https://github.com/rust-lang/rust/raw/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0019_tuple_expr_leading_comma.rast", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0019_tuple_expr_leading_comma.rast?ref=7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65", "patch": "@@ -0,0 +1,24 @@\n+SOURCE_FILE\n+  FN\n+    FN_KW \"fn\"\n+    WHITESPACE \" \"\n+    NAME\n+      IDENT \"foo\"\n+    PARAM_LIST\n+      L_PAREN \"(\"\n+      R_PAREN \")\"\n+    WHITESPACE \" \"\n+    BLOCK_EXPR\n+      STMT_LIST\n+        L_CURLY \"{\"\n+        WHITESPACE \"\\n    \"\n+        EXPR_STMT\n+          TUPLE_EXPR\n+            L_PAREN \"(\"\n+            COMMA \",\"\n+            R_PAREN \")\"\n+          SEMICOLON \";\"\n+        WHITESPACE \"\\n\"\n+        R_CURLY \"}\"\n+  WHITESPACE \"\\n\"\n+error 17: expected expression"}, {"sha": "12fab59a77656e8ae3d6d3b49a2793d941cd8210", "filename": "crates/parser/test_data/parser/inline/err/0019_tuple_expr_leading_comma.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0019_tuple_expr_leading_comma.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0019_tuple_expr_leading_comma.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0019_tuple_expr_leading_comma.rs?ref=7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65", "patch": "@@ -0,0 +1,3 @@\n+fn foo() {\n+    (,);\n+}"}, {"sha": "9c8837292d2890cf038a904bffbcce8d7e1398ef", "filename": "crates/parser/test_data/parser/inline/err/0020_tuple_pat_leading_comma.rast", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0020_tuple_pat_leading_comma.rast", "raw_url": "https://github.com/rust-lang/rust/raw/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0020_tuple_pat_leading_comma.rast", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0020_tuple_pat_leading_comma.rast?ref=7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65", "patch": "@@ -0,0 +1,26 @@\n+SOURCE_FILE\n+  FN\n+    FN_KW \"fn\"\n+    WHITESPACE \" \"\n+    NAME\n+      IDENT \"foo\"\n+    PARAM_LIST\n+      L_PAREN \"(\"\n+      R_PAREN \")\"\n+    WHITESPACE \" \"\n+    BLOCK_EXPR\n+      STMT_LIST\n+        L_CURLY \"{\"\n+        WHITESPACE \"\\n    \"\n+        LET_STMT\n+          LET_KW \"let\"\n+          WHITESPACE \" \"\n+          TUPLE_PAT\n+            L_PAREN \"(\"\n+            COMMA \",\"\n+            R_PAREN \")\"\n+          SEMICOLON \";\"\n+        WHITESPACE \"\\n\"\n+        R_CURLY \"}\"\n+  WHITESPACE \"\\n\"\n+error 21: expected pattern"}, {"sha": "de168521e1d3f74a95c34ce92e984ecb015d458e", "filename": "crates/parser/test_data/parser/inline/err/0020_tuple_pat_leading_comma.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0020_tuple_pat_leading_comma.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0020_tuple_pat_leading_comma.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0020_tuple_pat_leading_comma.rs?ref=7d1bf7023d7c11c20bfc35c9b9f4bfa027858d65", "patch": "@@ -0,0 +1,3 @@\n+fn foo() {\n+    let (,);\n+}"}]}