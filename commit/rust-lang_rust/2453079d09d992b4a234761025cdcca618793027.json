{"sha": "2453079d09d992b4a234761025cdcca618793027", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI0NTMwNzlkMDlkOTkyYjRhMjM0NzYxMDI1Y2RjY2E2MTg3OTMwMjc=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-01-03T19:16:52Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-01-03T19:16:52Z"}, "message": "Change rmake and doc-test to support TESTNAME\n\nCloses #11288\nCloses #11222", "tree": {"sha": "d12da5eabf789bad033e4378f0d383e29b623797", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d12da5eabf789bad033e4378f0d383e29b623797"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2453079d09d992b4a234761025cdcca618793027", "comment_count": 9, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2453079d09d992b4a234761025cdcca618793027", "html_url": "https://github.com/rust-lang/rust/commit/2453079d09d992b4a234761025cdcca618793027", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2453079d09d992b4a234761025cdcca618793027/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a1cb8dc30c6adc88703763a8703b6a3027598b2d", "url": "https://api.github.com/repos/rust-lang/rust/commits/a1cb8dc30c6adc88703763a8703b6a3027598b2d", "html_url": "https://github.com/rust-lang/rust/commit/a1cb8dc30c6adc88703763a8703b6a3027598b2d"}], "stats": {"total": 11, "additions": 8, "deletions": 3}, "files": [{"sha": "4573ca3a14f4f35176c7784fd012c198998772e0", "filename": "mk/tests.mk", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/2453079d09d992b4a234761025cdcca618793027/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/2453079d09d992b4a234761025cdcca618793027/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=2453079d09d992b4a234761025cdcca618793027", "patch": "@@ -768,7 +768,7 @@ $$(call TEST_OK_FILE,$(1),$(2),$(3),doc-$(4)):\t\t\\\n \t\t$$(HBIN$(1)_H_$(3))/rustdoc$$(X_$(3))\n \t@$$(call E, run doc-$(4) [$(2)])\n \t$$(Q)$$(HBIN$(1)_H_$(3))/rustdoc$$(X_$(3)) --test \\\n-\t    $$(CRATE_DOC_LIB-$(4)) && touch $$@\n+\t    $$(CRATE_DOC_LIB-$(4)) --test-args \"$$(TESTARGS)\" && touch $$@\n else\n $$(call TEST_OK_FILE,$(1),$(2),$(3),doc-$(4)):\n \ttouch $$@\n@@ -970,12 +970,12 @@ $(3)/test/run-make/%-$(1)-T-$(2)-H-$(3).ok: \\\n \t\t$$(CSREQ$(1)_T_$(2)_H_$(3))\n \t@rm -rf $(3)/test/run-make/$$*\n \t@mkdir -p $(3)/test/run-make/$$*\n-\t@echo maketest: $$*\n \t$$(Q)$$(CFG_PYTHON) $(S)src/etc/maketest.py $$(dir $$<) \\\n \t    $$(HBIN$(1)_H_$(3))/rustc$$(X_$(3)) \\\n \t    $(3)/test/run-make/$$* \\\n \t    \"$$(CC_$(3)) $$(CFG_GCCISH_CFLAGS_$(3))\" \\\n-\t    $$(HBIN$(1)_H_$(3))/rustdoc$$(X_$(3))\n+\t    $$(HBIN$(1)_H_$(3))/rustdoc$$(X_$(3)) \\\n+\t    \"$$(TESTNAME)\"\n \t@touch $$@\n else\n # FIXME #11094 - The above rule doesn't work right for multiple targets"}, {"sha": "91de7fba7580a7f83c240fec7ec2f75335f04dde", "filename": "src/etc/maketest.py", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/2453079d09d992b4a234761025cdcca618793027/src%2Fetc%2Fmaketest.py", "raw_url": "https://github.com/rust-lang/rust/raw/2453079d09d992b4a234761025cdcca618793027/src%2Fetc%2Fmaketest.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fmaketest.py?ref=2453079d09d992b4a234761025cdcca618793027", "patch": "@@ -8,6 +8,11 @@\n os.putenv('TMPDIR', os.path.abspath(sys.argv[3]))\n os.putenv('CC', sys.argv[4])\n os.putenv('RUSTDOC', os.path.abspath(sys.argv[5]))\n+filt = sys.argv[6]\n+\n+if not filt in sys.argv[1]:\n+    sys.exit(0)\n+print('maketest: ' + os.path.basename(os.path.dirname(sys.argv[1])))\n \n proc = subprocess.Popen(['make', '-C', sys.argv[1]],\n                         stdout = subprocess.PIPE,"}]}