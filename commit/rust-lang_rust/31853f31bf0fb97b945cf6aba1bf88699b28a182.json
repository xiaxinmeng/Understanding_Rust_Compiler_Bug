{"sha": "31853f31bf0fb97b945cf6aba1bf88699b28a182", "node_id": "MDY6Q29tbWl0NzI0NzEyOjMxODUzZjMxYmYwZmI5N2I5NDVjZjZhYmExYmY4ODY5OWIyOGExODI=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-04-24T20:30:00Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-04-24T20:30:03Z"}, "message": "build: Don't require full target libs to run compiletest tests\n\nOnly build through librustsyntax, which some tests do rely on.", "tree": {"sha": "a1dc683ac6046aa886e81a91cfc04736e1625e3d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a1dc683ac6046aa886e81a91cfc04736e1625e3d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/31853f31bf0fb97b945cf6aba1bf88699b28a182", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/31853f31bf0fb97b945cf6aba1bf88699b28a182", "html_url": "https://github.com/rust-lang/rust/commit/31853f31bf0fb97b945cf6aba1bf88699b28a182", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/31853f31bf0fb97b945cf6aba1bf88699b28a182/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2d793ef49845172ed3db10070820d75070e7ef17", "url": "https://api.github.com/repos/rust-lang/rust/commits/2d793ef49845172ed3db10070820d75070e7ef17", "html_url": "https://github.com/rust-lang/rust/commit/2d793ef49845172ed3db10070820d75070e7ef17"}], "stats": {"total": 93, "additions": 43, "deletions": 50}, "files": [{"sha": "634837f7c4dfbccc9783ce1ee134ddbf8a1cf89d", "filename": "mk/tests.mk", "status": "modified", "additions": 18, "deletions": 22, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/31853f31bf0fb97b945cf6aba1bf88699b28a182/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/31853f31bf0fb97b945cf6aba1bf88699b28a182/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=31853f31bf0fb97b945cf6aba1bf88699b28a182", "patch": "@@ -166,6 +166,13 @@ define TEST_STAGEN\n # $(2) is the target triple to test\n # $(3) is the host triple to test\n \n+# Prerequisites for compiletest tests\n+TEST_SREQ$(1)_T_$(2)_H_$(3) = \\\n+\t$$(HBIN$(1)_H_$(3))/compiletest$$(X) \\\n+\t$$(HSREQ$(1)_$(2)_$(3)) \\\n+\t$$(TLIB$(1)_T_$(2)_H_$(3))/$$(CFG_LIBRUSTSYNTAX)\n+\n+\n check-stage$(1)-T-$(2)-H-$(3): tidy\t\t\t\t\\\n \tcheck-stage$(1)-T-$(2)-H-$(3)-rustc\t\t\t\\\n \tcheck-stage$(1)-T-$(2)-H-$(3)-core          \\\n@@ -373,98 +380,87 @@ DOC_REF_ARGS$(1)-T-$(2)-H-$(3) :=\t\t\t\\\n         --mode run-pass\n \n check-stage$(1)-T-$(2)-H-$(3)-cfail-dummy:\t\t\\\n-\t\t$$(HBIN$(1)_H_$(3))/compiletest$$(X)\t\\\n-\t\t$$(SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n+\t\t$$(TEST_SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n \t        $$(CFAIL_TESTS)\n \t@$$(call E, run cfail: $$<)\n \t$$(Q)$$(call CFG_RUN_CTEST,$(1),$$<,$(3)) \\\n \t\t$$(CFAIL_ARGS$(1)-T-$(2)-H-$(3)) \\\n \t\t--logfile tmp/check-stage$(1)-T-$(2)-H-$(3)-cfail.log\n \n check-stage$(1)-T-$(2)-H-$(3)-rfail-dummy:\t\t\\\n-\t\t$$(HBIN$(1)_H_$(3))/compiletest$$(X)\t\\\n-\t\t$$(SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n+\t\t$$(TEST_SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n \t\t$$(RFAIL_TESTS)\n \t@$$(call E, run rfail: $$<)\n \t$$(Q)$$(call CFG_RUN_CTEST,$(1),$$<,$(3)) \\\n \t\t$$(RFAIL_ARGS$(1)-T-$(2)-H-$(3)) \\\n \t\t--logfile tmp/check-stage$(1)-T-$(2)-H-$(3)-rfail.log\n \n check-stage$(1)-T-$(2)-H-$(3)-rpass-dummy:\t\t\\\n-\t\t$$(HBIN$(1)_H_$(3))/compiletest$$(X)\t\\\n-\t\t$$(SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n+\t\t$$(TEST_SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n \t        $$(RPASS_TESTS)\n \t@$$(call E, run rpass: $$<)\n \t$$(Q)$$(call CFG_RUN_CTEST,$(1),$$<,$(3)) \\\n \t\t$$(RPASS_ARGS$(1)-T-$(2)-H-$(3)) \\\n \t\t--logfile tmp/check-stage$(1)-T-$(2)-H-$(3)-rpass.log\n \n check-stage$(1)-T-$(2)-H-$(3)-bench-dummy:\t\t\\\n-\t\t$$(HBIN$(1)_H_$(3))/compiletest$$(X)\t\\\n-\t\t$$(SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n+\t\t$$(TEST_SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n \t\t$$(BENCH_TESTS)\n \t@$$(call E, run bench: $$<)\n \t$$(Q)$$(call CFG_RUN_CTEST,$(1),$$<,$(3)) \\\n \t\t$$(BENCH_ARGS$(1)-T-$(2)-H-$(3)) \\\n \t\t--logfile tmp/check-stage$(1)-T-$(2)-H-$(3)-bench.log\n \n check-stage$(1)-T-$(2)-H-$(3)-perf-dummy:\t\t\\\n-\t\t$$(HBIN$(1)_H_$(3))/compiletest$$(X)\t\\\n-\t        $$(SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n+\t        $$(TEST_SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n \t        $$(BENCH_TESTS)\n \t@$$(call E, perf: $$<)\n \t$$(Q)$$(call CFG_RUN_CTEST,$(1),$$<,$(3)) \\\n \t\t$$(PERF_ARGS$(1)-T-$(2)-H-$(3)) \\\n \t\t--logfile tmp/check-stage$(1)-T-$(2)-H-$(3)-perf.log\n \n check-stage$(1)-T-$(2)-H-$(3)-pretty-rpass-dummy:\t\\\n-\t\t$$(HBIN$(1)_H_$(3))/compiletest$$(X)\t\\\n-\t        $$(SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n+\t        $$(TEST_SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n \t        $$(RPASS_TESTS)\n \t@$$(call E, run pretty-rpass: $$<)\n \t$$(Q)$$(call CFG_RUN_CTEST,$(1),$$<,$(3)) \\\n \t\t$$(PRETTY_RPASS_ARGS$(1)-T-$(2)-H-$(3)) \\\n \t\t--logfile tmp/check-stage$(1)-T-$(2)-H-$(3)-pretty-rpass.log\n \n check-stage$(1)-T-$(2)-H-$(3)-pretty-rfail-dummy:\t\\\n-\t\t$$(HBIN$(1)_H_$(3))/compiletest$$(X)\t\\\n-\t        $$(SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n+\t        $$(TEST_SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n \t        $$(RFAIL_TESTS)\n \t@$$(call E, run pretty-rfail: $$<)\n \t$$(Q)$$(call CFG_RUN_CTEST,$(1),$$<,$(3)) \\\n \t\t$$(PRETTY_RFAIL_ARGS$(1)-T-$(2)-H-$(3)) \\\n \t\t--logfile tmp/check-stage$(1)-T-$(2)-H-$(3)-pretty-rfail.log\n \n check-stage$(1)-T-$(2)-H-$(3)-pretty-bench-dummy:\t\\\n-\t\t$$(HBIN$(1)_H_$(3))/compiletest$$(X)\t\\\n-\t\t$$(SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n+\t\t$$(TEST_SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n \t        $$(BENCH_TESTS)\n \t@$$(call E, run pretty-bench: $$<)\n \t$$(Q)$$(call CFG_RUN_CTEST,$(1),$$<,$(3)) \\\n \t\t$$(PRETTY_BENCH_ARGS$(1)-T-$(2)-H-$(3)) \\\n \t\t--logfile tmp/check-stage$(1)-T-$(2)-H-$(3)-pretty-bench.log\n \n check-stage$(1)-T-$(2)-H-$(3)-pretty-pretty-dummy:\t\\\n-\t\t$$(HBIN$(1)_H_$(3))/compiletest$$(X)\t\\\n-\t        $$(SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n+\t        $$(TEST_SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n \t        $$(PRETTY_TESTS)\n \t@$$(call E, run pretty-pretty: $$<)\n \t$$(Q)$$(call CFG_RUN_CTEST,$(1),$$<,$(3)) \\\n \t\t$$(PRETTY_PRETTY_ARGS$(1)-T-$(2)-H-$(3)) \\\n \t\t--logfile tmp/check-stage$(1)-T-$(2)-H-$(3)-pretty-pretty.log\n \n check-stage$(1)-T-$(2)-H-$(3)-doc-tutorial-dummy:       \\\n-\t\t$$(HBIN$(1)_H_$(3))/compiletest$$(X)\t\\\n-\t        $$(SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n+\t        $$(TEST_SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n                 doc-tutorial-extract$(3)\n \t@$$(call E, run doc-tutorial: $$<)\n \t$$(Q)$$(call CFG_RUN_CTEST,$(1),$$<,$(3)) \\\n                 $$(DOC_TUTORIAL_ARGS$(1)-T-$(2)-H-$(3)) \\\n \t\t--logfile tmp/check-stage$(1)-T-$(2)-H-$(3)-doc-tutorial.log\n \n check-stage$(1)-T-$(2)-H-$(3)-doc-ref-dummy:            \\\n-\t\t$$(HBIN$(1)_H_$(3))/compiletest$$(X)\t\\\n-\t        $$(SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n+\t        $$(TEST_SREQ$(1)_T_$(2)_H_$(3))\t\t\\\n                 doc-ref-extract$(3)\n \t@$$(call E, run doc-ref: $$<)\n \t$$(Q)$$(call CFG_RUN_CTEST,$(1),$$<,$(3)) \\"}, {"sha": "49c0407d3fbc7656150cc0fee2fe8db627eadc23", "filename": "src/test/compile-fail/qquote-1.rs", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/31853f31bf0fb97b945cf6aba1bf88699b28a182/src%2Ftest%2Fcompile-fail%2Fqquote-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/31853f31bf0fb97b945cf6aba1bf88699b28a182/src%2Ftest%2Fcompile-fail%2Fqquote-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fqquote-1.rs?ref=31853f31bf0fb97b945cf6aba1bf88699b28a182", "patch": "@@ -1,16 +1,15 @@\n // xfail-pretty\n \n use std;\n-use rustc;\n+use syntax(name = \"rustsyntax\");\n \n-import rustc::*;\n import io::*;\n \n-import rustc::driver::diagnostic;\n-import rustc::syntax::ast;\n-import rustc::syntax::codemap;\n-import rustc::syntax::parse;\n-import rustc::syntax::print::*;\n+import syntax::diagnostic;\n+import syntax::ast;\n+import syntax::codemap;\n+import syntax::parse;\n+import syntax::print::*;\n \n fn new_parse_sess() -> parse::parse_sess {\n   fail;"}, {"sha": "87a604d6b542662d32bf3389a2860bc033e94256", "filename": "src/test/compile-fail/qquote-2.rs", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/31853f31bf0fb97b945cf6aba1bf88699b28a182/src%2Ftest%2Fcompile-fail%2Fqquote-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/31853f31bf0fb97b945cf6aba1bf88699b28a182/src%2Ftest%2Fcompile-fail%2Fqquote-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fqquote-2.rs?ref=31853f31bf0fb97b945cf6aba1bf88699b28a182", "patch": "@@ -1,16 +1,15 @@\n // xfail-pretty\n \n use std;\n-use rustc;\n+use syntax(name = \"rustsyntax\");\n \n-import rustc::*;\n import std::io::*;\n \n-import rustc::driver::diagnostic;\n-import rustc::syntax::ast;\n-import rustc::syntax::codemap;\n-import rustc::syntax::parse::parser;\n-import rustc::syntax::print::*;\n+import syntax::diagnostic;\n+import syntax::ast;\n+import syntax::codemap;\n+import syntax::parse::parser;\n+import syntax::print::*;\n \n fn new_parse_sess() -> parser::parse_sess {\n   fail;"}, {"sha": "95171f2c7297d3b227d247aab74c1b32d9a25753", "filename": "src/test/run-pass/issue-1926.rs", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/31853f31bf0fb97b945cf6aba1bf88699b28a182/src%2Ftest%2Frun-pass%2Fissue-1926.rs", "raw_url": "https://github.com/rust-lang/rust/raw/31853f31bf0fb97b945cf6aba1bf88699b28a182/src%2Ftest%2Frun-pass%2Fissue-1926.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fissue-1926.rs?ref=31853f31bf0fb97b945cf6aba1bf88699b28a182", "patch": "@@ -1,12 +1,12 @@\n // xfail-test\n // fails pretty printing for some reason\n-use rustc;\n-import rustc::driver::diagnostic;\n-import rustc::syntax;\n-import rustc::syntax::ast;\n-import rustc::syntax::codemap;\n-import rustc::syntax::print::pprust;\n-import rustc::syntax::parse::parser;\n+use syntax(name = \"rustsyntax\");\n+import syntax::diagnostic;\n+import syntax;\n+import syntax::ast;\n+import syntax::codemap;\n+import syntax::print::pprust;\n+import syntax::parse::parser;\n \n fn new_parse_sess() -> parser::parse_sess {\n     let cm = codemap::new_codemap();"}, {"sha": "750102b73a2aad34597d3ce221df7c344984768f", "filename": "src/test/run-pass/qquote.rs", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/31853f31bf0fb97b945cf6aba1bf88699b28a182/src%2Ftest%2Frun-pass%2Fqquote.rs", "raw_url": "https://github.com/rust-lang/rust/raw/31853f31bf0fb97b945cf6aba1bf88699b28a182/src%2Ftest%2Frun-pass%2Fqquote.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fqquote.rs?ref=31853f31bf0fb97b945cf6aba1bf88699b28a182", "patch": "@@ -1,16 +1,15 @@\n // xfail-pretty\n \n use std;\n-use rustc;\n+use syntax(name = \"rustsyntax\");\n \n-import rustc::*;\n import io::*;\n \n-import rustc::driver::diagnostic;\n-import rustc::syntax::ast;\n-import rustc::syntax::codemap;\n-import rustc::syntax::parse;\n-import rustc::syntax::print::*;\n+import syntax::diagnostic;\n+import syntax::ast;\n+import syntax::codemap;\n+import syntax::parse;\n+import syntax::print::*;\n \n fn new_parse_sess() -> parse::parse_sess {\n     let cm = codemap::new_codemap();"}]}