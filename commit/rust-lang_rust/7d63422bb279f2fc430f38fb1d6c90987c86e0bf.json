{"sha": "7d63422bb279f2fc430f38fb1d6c90987c86e0bf", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdkNjM0MjJiYjI3OWYyZmM0MzBmMzhmYjFkNmM5MDk4N2M4NmUwYmY=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2016-04-05T11:13:22Z"}, "committer": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2016-04-05T11:13:22Z"}, "message": "Rollup merge of #32710 - jonas-schievink:consider-last-semi, r=nagisa\n\nFix \"consider removing this semicolon\" help\n\nCheck last statement in a block, not the first.\n\nExample of current weirdness: http://is.gd/w80J9h\n\nThe help was only rarely emitted, and if so, often incorrectly (see above playpen). It was basically only useful with single-statement functions.", "tree": {"sha": "1a6068bf7ddaefd62b007434ba2bb4d411527688", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1a6068bf7ddaefd62b007434ba2bb4d411527688"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7d63422bb279f2fc430f38fb1d6c90987c86e0bf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7d63422bb279f2fc430f38fb1d6c90987c86e0bf", "html_url": "https://github.com/rust-lang/rust/commit/7d63422bb279f2fc430f38fb1d6c90987c86e0bf", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7d63422bb279f2fc430f38fb1d6c90987c86e0bf/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b6c1f1cf3f392af6bad6018a9e8fd25cf608c475", "url": "https://api.github.com/repos/rust-lang/rust/commits/b6c1f1cf3f392af6bad6018a9e8fd25cf608c475", "html_url": "https://github.com/rust-lang/rust/commit/b6c1f1cf3f392af6bad6018a9e8fd25cf608c475"}, {"sha": "99b6247166f8a0119b446e8877f5fca9b04187b0", "url": "https://api.github.com/repos/rust-lang/rust/commits/99b6247166f8a0119b446e8877f5fca9b04187b0", "html_url": "https://github.com/rust-lang/rust/commit/99b6247166f8a0119b446e8877f5fca9b04187b0"}], "stats": {"total": 27, "additions": 25, "deletions": 2}, "files": [{"sha": "4451e7ac472e544c463c49c35c6c74359d4b41f1", "filename": "src/librustc/middle/liveness.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/7d63422bb279f2fc430f38fb1d6c90987c86e0bf/src%2Flibrustc%2Fmiddle%2Fliveness.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7d63422bb279f2fc430f38fb1d6c90987c86e0bf/src%2Flibrustc%2Fmiddle%2Fliveness.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fliveness.rs?ref=7d63422bb279f2fc430f38fb1d6c90987c86e0bf", "patch": "@@ -1502,7 +1502,7 @@ impl<'a, 'tcx> Liveness<'a, 'tcx> {\n                 } else {\n                     let ends_with_stmt = match body.expr {\n                         None if !body.stmts.is_empty() =>\n-                            match body.stmts.first().unwrap().node {\n+                            match body.stmts.last().unwrap().node {\n                                 hir::StmtSemi(ref e, _) => {\n                                     self.ir.tcx.expr_ty(&e) == t_ret\n                                 },\n@@ -1515,7 +1515,7 @@ impl<'a, 'tcx> Liveness<'a, 'tcx> {\n                                                    E0269,\n                                                    \"not all control paths return a value\");\n                     if ends_with_stmt {\n-                        let last_stmt = body.stmts.first().unwrap();\n+                        let last_stmt = body.stmts.last().unwrap();\n                         let original_span = original_sp(self.ir.tcx.sess.codemap(),\n                                                         last_stmt.span, sp);\n                         let span_semicolon = Span {"}, {"sha": "02148a138c9d905c9f02d23c2ae5476d2b694db3", "filename": "src/test/compile-fail/consider-removing-last-semi.rs", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/7d63422bb279f2fc430f38fb1d6c90987c86e0bf/src%2Ftest%2Fcompile-fail%2Fconsider-removing-last-semi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7d63422bb279f2fc430f38fb1d6c90987c86e0bf/src%2Ftest%2Fcompile-fail%2Fconsider-removing-last-semi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fconsider-removing-last-semi.rs?ref=7d63422bb279f2fc430f38fb1d6c90987c86e0bf", "patch": "@@ -0,0 +1,23 @@\n+// Copyright 2016 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+fn f() -> String {  //~ ERROR E0269\n+                    //~^ HELP detailed explanation\n+    0u8;\n+    \"bla\".to_string();  //~ HELP consider removing this semicolon\n+}\n+\n+fn g() -> String {  //~ ERROR E0269\n+                    //~^ HELP detailed explanation\n+    \"this won't work\".to_string();\n+    \"removeme\".to_string(); //~ HELP consider removing this semicolon\n+}\n+\n+fn main() {}"}]}