{"sha": "a0b5dfef2a36a15f76476a9d6bb7184a701d0d3c", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEwYjVkZmVmMmEzNmExNWY3NjQ3NmE5ZDZiYjcxODRhNzAxZDBkM2M=", "commit": {"author": {"name": "Jeremy Soller", "email": "jackpot51@gmail.com", "date": "2016-11-14T19:15:11Z"}, "committer": {"name": "Jeremy Soller", "email": "jackpot51@gmail.com", "date": "2016-11-14T19:15:11Z"}, "message": "Add fcntl", "tree": {"sha": "fb267b4d1c3ee73d0488590185f6042871174bd9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fb267b4d1c3ee73d0488590185f6042871174bd9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a0b5dfef2a36a15f76476a9d6bb7184a701d0d3c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a0b5dfef2a36a15f76476a9d6bb7184a701d0d3c", "html_url": "https://github.com/rust-lang/rust/commit/a0b5dfef2a36a15f76476a9d6bb7184a701d0d3c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a0b5dfef2a36a15f76476a9d6bb7184a701d0d3c/comments", "author": {"login": "jackpot51", "id": 7741236, "node_id": "MDQ6VXNlcjc3NDEyMzY=", "avatar_url": "https://avatars.githubusercontent.com/u/7741236?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackpot51", "html_url": "https://github.com/jackpot51", "followers_url": "https://api.github.com/users/jackpot51/followers", "following_url": "https://api.github.com/users/jackpot51/following{/other_user}", "gists_url": "https://api.github.com/users/jackpot51/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackpot51/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackpot51/subscriptions", "organizations_url": "https://api.github.com/users/jackpot51/orgs", "repos_url": "https://api.github.com/users/jackpot51/repos", "events_url": "https://api.github.com/users/jackpot51/events{/privacy}", "received_events_url": "https://api.github.com/users/jackpot51/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jackpot51", "id": 7741236, "node_id": "MDQ6VXNlcjc3NDEyMzY=", "avatar_url": "https://avatars.githubusercontent.com/u/7741236?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackpot51", "html_url": "https://github.com/jackpot51", "followers_url": "https://api.github.com/users/jackpot51/followers", "following_url": "https://api.github.com/users/jackpot51/following{/other_user}", "gists_url": "https://api.github.com/users/jackpot51/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackpot51/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackpot51/subscriptions", "organizations_url": "https://api.github.com/users/jackpot51/orgs", "repos_url": "https://api.github.com/users/jackpot51/repos", "events_url": "https://api.github.com/users/jackpot51/events{/privacy}", "received_events_url": "https://api.github.com/users/jackpot51/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0bb9a959074bb7f027cf05a240a0044116fa0ab0", "url": "https://api.github.com/repos/rust-lang/rust/commits/0bb9a959074bb7f027cf05a240a0044116fa0ab0", "html_url": "https://github.com/rust-lang/rust/commit/0bb9a959074bb7f027cf05a240a0044116fa0ab0"}], "stats": {"total": 16, "additions": 11, "deletions": 5}, "files": [{"sha": "47d2280fe05f2745226d35082cf6c860758414cf", "filename": "src/libstd/sys/redox/fd.rs", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/a0b5dfef2a36a15f76476a9d6bb7184a701d0d3c/src%2Flibstd%2Fsys%2Fredox%2Ffd.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a0b5dfef2a36a15f76476a9d6bb7184a701d0d3c/src%2Flibstd%2Fsys%2Fredox%2Ffd.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fredox%2Ffd.rs?ref=a0b5dfef2a36a15f76476a9d6bb7184a701d0d3c", "patch": "@@ -49,13 +49,19 @@ impl FileDesc {\n     }\n \n     pub fn set_cloexec(&self) -> io::Result<()> {\n-        ::sys_common::util::dumb_print(format_args!(\"{}: set cloexec\\n\", self.fd));\n-        unimplemented!();\n+        let mut flags = cvt(libc::fcntl(self.fd, libc::F_GETFL, 0))?;\n+        flags |= libc::O_CLOEXEC;\n+        cvt(libc::fcntl(self.fd, libc::F_SETFL, flags)).and(Ok(()))\n     }\n \n-    pub fn set_nonblocking(&self, _nonblocking: bool) -> io::Result<()> {\n-        ::sys_common::util::dumb_print(format_args!(\"{}: set nonblocking\\n\", self.fd));\n-        unimplemented!();\n+    pub fn set_nonblocking(&self, nonblocking: bool) -> io::Result<()> {\n+        let mut flags = cvt(libc::fcntl(self.fd, libc::F_GETFL, 0))?;\n+        if nonblocking {\n+            flags |= libc::O_NONBLOCK;\n+        } else {\n+            flags &= !libc::O_NONBLOCK;\n+        }\n+        cvt(libc::fcntl(self.fd, libc::F_SETFL, flags)).and(Ok(()))\n     }\n \n     pub fn duplicate(&self) -> io::Result<FileDesc> {"}]}