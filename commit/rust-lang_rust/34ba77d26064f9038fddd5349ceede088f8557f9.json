{"sha": "34ba77d26064f9038fddd5349ceede088f8557f9", "node_id": "C_kwDOAAsO6NoAKDM0YmE3N2QyNjA2NGY5MDM4ZmRkZDUzNDljZWVkZTA4OGY4NTU3Zjk", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2023-02-18T09:47:04Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2023-02-18T09:58:17Z"}, "message": "rustdoc: Do not use Footnotes and HeadingLinks when extracting doc links\n\nthey do not add any `Link` events", "tree": {"sha": "0ef0711024153324696bd8dc62f5b46099e59fa5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0ef0711024153324696bd8dc62f5b46099e59fa5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/34ba77d26064f9038fddd5349ceede088f8557f9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/34ba77d26064f9038fddd5349ceede088f8557f9", "html_url": "https://github.com/rust-lang/rust/commit/34ba77d26064f9038fddd5349ceede088f8557f9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/34ba77d26064f9038fddd5349ceede088f8557f9/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6d819a4b8f45b170e7c2c415df20cfa2e0cbbf7f", "url": "https://api.github.com/repos/rust-lang/rust/commits/6d819a4b8f45b170e7c2c415df20cfa2e0cbbf7f", "html_url": "https://github.com/rust-lang/rust/commit/6d819a4b8f45b170e7c2c415df20cfa2e0cbbf7f"}], "stats": {"total": 11, "additions": 3, "deletions": 8}, "files": [{"sha": "394bea3caee7e30069c5f0f3bea8c4275ea031e3", "filename": "src/librustdoc/html/markdown.rs", "status": "modified", "additions": 3, "deletions": 8, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/34ba77d26064f9038fddd5349ceede088f8557f9/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs", "raw_url": "https://github.com/rust-lang/rust/raw/34ba77d26064f9038fddd5349ceede088f8557f9/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs?ref=34ba77d26064f9038fddd5349ceede088f8557f9", "patch": "@@ -1275,15 +1275,10 @@ pub(crate) fn markdown_links<R>(\n         .map(|link| links.borrow_mut().push(link));\n         None\n     };\n-    let p = Parser::new_with_broken_link_callback(md, main_body_opts(), Some(&mut push))\n-        .into_offset_iter();\n \n-    // There's no need to thread an IdMap through to here because\n-    // the IDs generated aren't going to be emitted anywhere.\n-    let mut ids = IdMap::new();\n-    let iter = Footnotes::new(HeadingLinks::new(p, None, &mut ids, HeadingOffset::H1));\n-\n-    for ev in iter {\n+    for ev in Parser::new_with_broken_link_callback(md, main_body_opts(), Some(&mut push))\n+        .into_offset_iter()\n+    {\n         if let Event::Start(Tag::Link(\n             // `<>` links cannot be intra-doc links so we skip them.\n             kind @ (LinkType::Inline"}]}