{"sha": "758f6e6e6898ec2b908a1d26759793c5c0fd2a3f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc1OGY2ZTZlNjg5OGVjMmI5MDhhMWQyNjc1OTc5M2M1YzBmZDJhM2Y=", "commit": {"author": {"name": "Steven Fackler", "email": "sfackler@gmail.com", "date": "2013-12-17T05:30:02Z"}, "committer": {"name": "Steven Fackler", "email": "sfackler@gmail.com", "date": "2013-12-17T05:30:02Z"}, "message": "Fix rustdoc output of enums with private variants\n\nPreviously, if every variant was private, it would display as a\nvariantless enum instead of having the \"some variants stripped\" comment.", "tree": {"sha": "d85eab24f57f09b9b9ee996dff34aeda3d08a376", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d85eab24f57f09b9b9ee996dff34aeda3d08a376"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/758f6e6e6898ec2b908a1d26759793c5c0fd2a3f", "comment_count": 9, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/758f6e6e6898ec2b908a1d26759793c5c0fd2a3f", "html_url": "https://github.com/rust-lang/rust/commit/758f6e6e6898ec2b908a1d26759793c5c0fd2a3f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/758f6e6e6898ec2b908a1d26759793c5c0fd2a3f/comments", "author": {"login": "sfackler", "id": 1455697, "node_id": "MDQ6VXNlcjE0NTU2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sfackler", "html_url": "https://github.com/sfackler", "followers_url": "https://api.github.com/users/sfackler/followers", "following_url": "https://api.github.com/users/sfackler/following{/other_user}", "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}", "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions", "organizations_url": "https://api.github.com/users/sfackler/orgs", "repos_url": "https://api.github.com/users/sfackler/repos", "events_url": "https://api.github.com/users/sfackler/events{/privacy}", "received_events_url": "https://api.github.com/users/sfackler/received_events", "type": "User", "site_admin": false}, "committer": {"login": "sfackler", "id": 1455697, "node_id": "MDQ6VXNlcjE0NTU2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sfackler", "html_url": "https://github.com/sfackler", "followers_url": "https://api.github.com/users/sfackler/followers", "following_url": "https://api.github.com/users/sfackler/following{/other_user}", "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}", "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions", "organizations_url": "https://api.github.com/users/sfackler/orgs", "repos_url": "https://api.github.com/users/sfackler/repos", "events_url": "https://api.github.com/users/sfackler/events{/privacy}", "received_events_url": "https://api.github.com/users/sfackler/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c2c2c4d6f3dae07134858266b7f037ea110a6f82", "url": "https://api.github.com/repos/rust-lang/rust/commits/c2c2c4d6f3dae07134858266b7f037ea110a6f82", "html_url": "https://github.com/rust-lang/rust/commit/c2c2c4d6f3dae07134858266b7f037ea110a6f82"}], "stats": {"total": 17, "additions": 6, "deletions": 11}, "files": [{"sha": "696ea6ec9b8eca0b25629727a1f0f9d718ce94d8", "filename": "src/librustdoc/fold.rs", "status": "modified", "additions": 5, "deletions": 10, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/758f6e6e6898ec2b908a1d26759793c5c0fd2a3f/src%2Flibrustdoc%2Ffold.rs", "raw_url": "https://github.com/rust-lang/rust/raw/758f6e6e6898ec2b908a1d26759793c5c0fd2a3f/src%2Flibrustdoc%2Ffold.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Ffold.rs?ref=758f6e6e6898ec2b908a1d26759793c5c0fd2a3f", "patch": "@@ -24,8 +24,7 @@ pub trait DocFolder {\n         let inner = inner;\n         let c = |x| self.fold_item(x);\n         let inner = match inner {\n-            StructItem(i) => {\n-                let mut i = i;\n+            StructItem(mut i) => {\n                 let mut foo = ~[]; swap(&mut foo, &mut i.fields);\n                 let num_fields = foo.len();\n                 i.fields.extend(&mut foo.move_iter().filter_map(|x| self.fold_item(x)));\n@@ -35,15 +34,14 @@ pub trait DocFolder {\n             ModuleItem(i) => {\n                 ModuleItem(self.fold_mod(i))\n             },\n-            EnumItem(i) => {\n-                let mut i = i;\n+            EnumItem(mut i) => {\n                 let mut foo = ~[]; swap(&mut foo, &mut i.variants);\n                 let num_variants = foo.len();\n                 i.variants.extend(&mut foo.move_iter().filter_map(|x| self.fold_item(x)));\n                 i.variants_stripped |= num_variants != i.variants.len();\n                 EnumItem(i)\n             },\n-            TraitItem(i) => {\n+            TraitItem(mut i) => {\n                 fn vtrm<T: DocFolder>(this: &mut T, trm: TraitMethod) -> Option<TraitMethod> {\n                     match trm {\n                         Required(it) => {\n@@ -60,22 +58,19 @@ pub trait DocFolder {\n                         },\n                     }\n                 }\n-                let mut i = i;\n                 let mut foo = ~[]; swap(&mut foo, &mut i.methods);\n                 i.methods.extend(&mut foo.move_iter().filter_map(|x| vtrm(self, x)));\n                 TraitItem(i)\n             },\n-            ImplItem(i) => {\n-                let mut i = i;\n+            ImplItem(mut i) => {\n                 let mut foo = ~[]; swap(&mut foo, &mut i.methods);\n                 i.methods.extend(&mut foo.move_iter().filter_map(|x| self.fold_item(x)));\n                 ImplItem(i)\n             },\n             VariantItem(i) => {\n                 let i2 = i.clone(); // this clone is small\n                 match i.kind {\n-                    StructVariant(j) => {\n-                        let mut j = j;\n+                    StructVariant(mut j) => {\n                         let mut foo = ~[]; swap(&mut foo, &mut j.fields);\n                         let num_fields = foo.len();\n                         j.fields.extend(&mut foo.move_iter().filter_map(c));"}, {"sha": "53e86ee8e7350f2257e9b808c48225d82403e459", "filename": "src/librustdoc/html/render.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/758f6e6e6898ec2b908a1d26759793c5c0fd2a3f/src%2Flibrustdoc%2Fhtml%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/758f6e6e6898ec2b908a1d26759793c5c0fd2a3f/src%2Flibrustdoc%2Fhtml%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender.rs?ref=758f6e6e6898ec2b908a1d26759793c5c0fd2a3f", "patch": "@@ -1295,7 +1295,7 @@ fn item_enum(w: &mut Writer, it: &clean::Item, e: &clean::Enum) {\n            VisSpace(it.visibility),\n            it.name.get_ref().as_slice(),\n            e.generics);\n-    if e.variants.len() == 0 {\n+    if e.variants.len() == 0 && !e.variants_stripped {\n         write!(w, \" \\\\{\\\\}\");\n     } else {\n         write!(w, \" \\\\{\\n\");"}]}