{"sha": "16fefc5ead7d3338acf80f225f0f256a286345c5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE2ZmVmYzVlYWQ3ZDMzMzhhY2Y4MGYyMjVmMGYyNTZhMjg2MzQ1YzU=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2016-03-08T07:21:05Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2016-03-08T21:44:14Z"}, "message": "rustbuild: Fix stage1 rustdoc\n\nJust always build stage1 rustdoc, it's really not that much more to build as\nit's essentially just one library.", "tree": {"sha": "370c2e19041d1ce6377b17f4f538c71a6c5db858", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/370c2e19041d1ce6377b17f4f538c71a6c5db858"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/16fefc5ead7d3338acf80f225f0f256a286345c5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/16fefc5ead7d3338acf80f225f0f256a286345c5", "html_url": "https://github.com/rust-lang/rust/commit/16fefc5ead7d3338acf80f225f0f256a286345c5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/16fefc5ead7d3338acf80f225f0f256a286345c5/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "defd1b3392df2434ae67e0885cba16cdb9a2d5b4", "url": "https://api.github.com/repos/rust-lang/rust/commits/defd1b3392df2434ae67e0885cba16cdb9a2d5b4", "html_url": "https://github.com/rust-lang/rust/commit/defd1b3392df2434ae67e0885cba16cdb9a2d5b4"}], "stats": {"total": 18, "additions": 5, "deletions": 13}, "files": [{"sha": "0a293579cf67d814e0b16bf83c087ad9b2c7f83d", "filename": "src/bootstrap/build/compile.rs", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/16fefc5ead7d3338acf80f225f0f256a286345c5/src%2Fbootstrap%2Fbuild%2Fcompile.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16fefc5ead7d3338acf80f225f0f256a286345c5/src%2Fbootstrap%2Fbuild%2Fcompile.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbuild%2Fcompile.rs?ref=16fefc5ead7d3338acf80f225f0f256a286345c5", "patch": "@@ -141,15 +141,10 @@ pub fn rustc<'a>(build: &'a Build, stage: u32, target: &str,\n \n     let mut cargo = build.cargo(stage, compiler, Mode::Librustc, Some(target),\n                                 \"build\");\n-    cargo.arg(\"--features\").arg(build.rustc_features(stage))\n+    cargo.arg(\"--features\").arg(build.rustc_features())\n          .arg(\"--manifest-path\")\n          .arg(build.src.join(\"src/rustc/Cargo.toml\"));\n \n-    // In stage0 we may not need to build as many executables\n-    if stage == 0 {\n-        cargo.arg(\"--bin\").arg(\"rustc\");\n-    }\n-\n     // Set some configuration variables picked up by build scripts and\n     // the compiler alike\n     cargo.env(\"CFG_RELEASE\", &build.release)"}, {"sha": "ce79a605259159bb2fac095ab5b2f515f205a59e", "filename": "src/bootstrap/build/doc.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/16fefc5ead7d3338acf80f225f0f256a286345c5/src%2Fbootstrap%2Fbuild%2Fdoc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16fefc5ead7d3338acf80f225f0f256a286345c5/src%2Fbootstrap%2Fbuild%2Fdoc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbuild%2Fdoc.rs?ref=16fefc5ead7d3338acf80f225f0f256a286345c5", "patch": "@@ -135,7 +135,7 @@ pub fn rustc(build: &Build, stage: u32, host: &str, out: &Path) {\n                                 \"doc\");\n     cargo.arg(\"--manifest-path\")\n          .arg(build.src.join(\"src/rustc/Cargo.toml\"))\n-         .arg(\"--features\").arg(build.rustc_features(stage));\n+         .arg(\"--features\").arg(build.rustc_features());\n     build.run(&mut cargo);\n     cp_r(&out_dir, out)\n }"}, {"sha": "b4fb67beaf91bfe24fbf558136681fedfc60392a", "filename": "src/bootstrap/build/mod.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/16fefc5ead7d3338acf80f225f0f256a286345c5/src%2Fbootstrap%2Fbuild%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16fefc5ead7d3338acf80f225f0f256a286345c5/src%2Fbootstrap%2Fbuild%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbuild%2Fmod.rs?ref=16fefc5ead7d3338acf80f225f0f256a286345c5", "patch": "@@ -379,14 +379,11 @@ impl Build {\n     }\n \n     /// Get the space-separated set of activated features for the compiler.\n-    fn rustc_features(&self, stage: u32) -> String {\n+    fn rustc_features(&self) -> String {\n         let mut features = String::new();\n         if self.config.use_jemalloc {\n             features.push_str(\" jemalloc\");\n         }\n-        if stage > 0 {\n-            features.push_str(\" rustdoc\");\n-        }\n         return features\n     }\n "}, {"sha": "eb2d78689451eec6cb1749baa133bee866e0dd70", "filename": "src/librustdoc/html/render.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/16fefc5ead7d3338acf80f225f0f256a286345c5/src%2Flibrustdoc%2Fhtml%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16fefc5ead7d3338acf80f225f0f256a286345c5/src%2Flibrustdoc%2Fhtml%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender.rs?ref=16fefc5ead7d3338acf80f225f0f256a286345c5", "patch": "@@ -1454,7 +1454,7 @@ impl<'a> Item<'a> {\n         // has anchors for the line numbers that we're linking to.\n         } else if self.item.def_id.is_local() {\n             self.cx.local_sources.get(&PathBuf::from(&self.item.source.filename)).map(|path| {\n-                format!(\"{root}src/{krate}/{path}.html#{href}\",\n+                format!(\"{root}src/{krate}/{path}#{href}\",\n                         root = self.cx.root_path,\n                         krate = self.cx.layout.krate,\n                         path = path,"}, {"sha": "7431c35efba01752e01dc51b9e9f6d22f9caf62c", "filename": "src/rustc/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/16fefc5ead7d3338acf80f225f0f256a286345c5/src%2Frustc%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/16fefc5ead7d3338acf80f225f0f256a286345c5/src%2Frustc%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2FCargo.toml?ref=16fefc5ead7d3338acf80f225f0f256a286345c5", "patch": "@@ -25,7 +25,7 @@ debug-assertions = false\n [dependencies]\n rustc_back = { path = \"../librustc_back\" }\n rustc_driver = { path = \"../librustc_driver\" }\n-rustdoc = { path = \"../librustdoc\", optional = true }\n+rustdoc = { path = \"../librustdoc\" }\n \n [features]\n jemalloc = [\"rustc_back/jemalloc\"]"}]}