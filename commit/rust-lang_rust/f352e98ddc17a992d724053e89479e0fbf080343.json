{"sha": "f352e98ddc17a992d724053e89479e0fbf080343", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYzNTJlOThkZGMxN2E5OTJkNzI0MDUzZTg5NDc5ZTBmYmYwODAzNDM=", "commit": {"author": {"name": "Oliver Schneider", "email": "github35764891676564198441@oli-obk.de", "date": "2018-07-05T17:30:06Z"}, "committer": {"name": "Oliver Schneider", "email": "github35764891676564198441@oli-obk.de", "date": "2018-07-05T17:30:06Z"}, "message": "Address review comments", "tree": {"sha": "c3c7d0647fbbfaa896b2a3b3b846d036bd8d5043", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c3c7d0647fbbfaa896b2a3b3b846d036bd8d5043"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f352e98ddc17a992d724053e89479e0fbf080343", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f352e98ddc17a992d724053e89479e0fbf080343", "html_url": "https://github.com/rust-lang/rust/commit/f352e98ddc17a992d724053e89479e0fbf080343", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f352e98ddc17a992d724053e89479e0fbf080343/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f1e3a5a24be0429b046726f6f945595f5513f093", "url": "https://api.github.com/repos/rust-lang/rust/commits/f1e3a5a24be0429b046726f6f945595f5513f093", "html_url": "https://github.com/rust-lang/rust/commit/f1e3a5a24be0429b046726f6f945595f5513f093"}], "stats": {"total": 18, "additions": 6, "deletions": 12}, "files": [{"sha": "29ba635a9b71844eac1650d13fed5a52ce252e63", "filename": "src/bootstrap/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f352e98ddc17a992d724053e89479e0fbf080343/src%2Fbootstrap%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f352e98ddc17a992d724053e89479e0fbf080343/src%2Fbootstrap%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Flib.rs?ref=f352e98ddc17a992d724053e89479e0fbf080343", "patch": "@@ -115,6 +115,7 @@\n \n #![deny(warnings)]\n #![feature(core_intrinsics)]\n+#![feature(drain_filter)]\n \n #[macro_use]\n extern crate build_helper;"}, {"sha": "12b3d59e93df319a64464b9f4b4c17038db96d49", "filename": "src/bootstrap/tool.rs", "status": "modified", "additions": 5, "deletions": 12, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/f352e98ddc17a992d724053e89479e0fbf080343/src%2Fbootstrap%2Ftool.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f352e98ddc17a992d724053e89479e0fbf080343/src%2Fbootstrap%2Ftool.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftool.rs?ref=f352e98ddc17a992d724053e89479e0fbf080343", "patch": "@@ -186,27 +186,20 @@ impl Step for ToolBuild {\n                       than in a previous build:\\n\");\n             println!(\"the following dependencies are duplicated although they \\\n                       have the same features enabled:\");\n-            for (id, cur, prev) in &duplicates {\n+            for (id, cur, prev) in duplicates.drain_filter(|(_, cur, prev)| cur.2 == prev.2) {\n                 println!(\"  {}\", id);\n-                if cur.2 == prev.2 {\n-                    // same features\n-                    println!(\"    `{}` ({:?})\\n    `{}` ({:?})\", cur.0, cur.1, prev.0, prev.1);\n-                }\n+                // same features\n+                println!(\"    `{}` ({:?})\\n    `{}` ({:?})\", cur.0, cur.1, prev.0, prev.1);\n             }\n             println!(\"the following dependencies have different features:\");\n             for (id, cur, prev) in duplicates {\n                 println!(\"  {}\", id);\n-                if cur.2 == prev.2 {\n-                    continue;\n-                }\n                 let cur_features: HashSet<_> = cur.2.into_iter().collect();\n                 let prev_features: HashSet<_> = prev.2.into_iter().collect();\n-                let cur_extra: Vec<_> = cur_features.difference(&prev_features).collect();\n-                let prev_extra: Vec<_> = prev_features.difference(&cur_features).collect();\n                 println!(\"    `{}` additionally enabled features {:?} at {:?}\",\n-                         cur.0, cur_extra, cur.1);\n+                         cur.0, &cur_features - &prev_features, cur.1);\n                 println!(\"    `{}` additionally enabled features {:?} at {:?}\",\n-                         prev.0, prev_extra, prev.1);\n+                         prev.0, &prev_features - &cur_features, prev.1);\n             }\n             println!(\"\");\n             panic!(\"tools should not compile multiple copies of the same crate\");"}]}