{"sha": "fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZkMmRmNzQ5MDJmYTk4YmNiNzFmODVmZDU0OGMzZWIzOTllNmE5NmE=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-01-13T13:56:15Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-01-13T13:56:15Z"}, "message": "Auto merge of #76219 - Mark-Simulacrum:extern-require-abi, r=estebank\n\nAdd allow-by-default lint on implicit ABI in extern function pointers and items\n\nThis adds a new lint, missing_abi, which lints on omitted ABIs on extern blocks, function declarations, and function pointers.\n\nIt is currently not emitting the best possible diagnostics -- we need to track the span of \"extern\" at least or do some heuristic searching based on the available spans -- but seems good enough for an initial pass than can be expanded in future PRs.\n\nThis is a pretty large PR, but mostly due to updating a large number of tests to include ABIs; I can split that into a separate PR if it would be helpful, but test updates are already in dedicated commits.", "tree": {"sha": "d88a7bde6091f82bd2ae5d492c66088ef705600d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d88a7bde6091f82bd2ae5d492c66088ef705600d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "html_url": "https://github.com/rust-lang/rust/commit/fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "116d1a7056830ccf649f74f823de4333ed329392", "url": "https://api.github.com/repos/rust-lang/rust/commits/116d1a7056830ccf649f74f823de4333ed329392", "html_url": "https://github.com/rust-lang/rust/commit/116d1a7056830ccf649f74f823de4333ed329392"}, {"sha": "4614671cae99ff35e61708ab64e9ba7850711750", "url": "https://api.github.com/repos/rust-lang/rust/commits/4614671cae99ff35e61708ab64e9ba7850711750", "html_url": "https://github.com/rust-lang/rust/commit/4614671cae99ff35e61708ab64e9ba7850711750"}], "stats": {"total": 2347, "additions": 1233, "deletions": 1114}, "files": [{"sha": "a24ab967e5cd89fe604457496097b1fc85ee807d", "filename": "Cargo.lock", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3896,6 +3896,7 @@ dependencies = [\n  \"rustc_macros\",\n  \"rustc_serialize\",\n  \"rustc_span\",\n+ \"rustc_target\",\n  \"tracing\",\n ]\n "}, {"sha": "69257ce1c19e961962503d6580be94df839c198f", "filename": "compiler/rustc_ast_lowering/src/item.rs", "status": "modified", "additions": 24, "deletions": 14, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_ast_lowering%2Fsrc%2Fitem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_ast_lowering%2Fsrc%2Fitem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Fitem.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -310,19 +310,24 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                     );\n                     let sig = hir::FnSig {\n                         decl,\n-                        header: this.lower_fn_header(header),\n+                        header: this.lower_fn_header(header, fn_sig_span, id),\n                         span: fn_sig_span,\n                     };\n                     hir::ItemKind::Fn(sig, generics, body_id)\n                 })\n             }\n             ItemKind::Mod(ref m) => hir::ItemKind::Mod(self.lower_mod(m)),\n-            ItemKind::ForeignMod(ref fm) => hir::ItemKind::ForeignMod {\n-                abi: fm.abi.map_or(abi::Abi::C, |abi| self.lower_abi(abi)),\n-                items: self\n-                    .arena\n-                    .alloc_from_iter(fm.items.iter().map(|x| self.lower_foreign_item_ref(x))),\n-            },\n+            ItemKind::ForeignMod(ref fm) => {\n+                if fm.abi.is_none() {\n+                    self.maybe_lint_missing_abi(span, id, abi::Abi::C);\n+                }\n+                hir::ItemKind::ForeignMod {\n+                    abi: fm.abi.map_or(abi::Abi::C, |abi| self.lower_abi(abi)),\n+                    items: self\n+                        .arena\n+                        .alloc_from_iter(fm.items.iter().map(|x| self.lower_foreign_item_ref(x))),\n+                }\n+            }\n             ItemKind::GlobalAsm(ref ga) => hir::ItemKind::GlobalAsm(self.lower_global_asm(ga)),\n             ItemKind::TyAlias(_, ref gen, _, Some(ref ty)) => {\n                 // We lower\n@@ -801,13 +806,13 @@ impl<'hir> LoweringContext<'_, 'hir> {\n             AssocItemKind::Fn(_, ref sig, ref generics, None) => {\n                 let names = self.lower_fn_params_to_names(&sig.decl);\n                 let (generics, sig) =\n-                    self.lower_method_sig(generics, sig, trait_item_def_id, false, None);\n+                    self.lower_method_sig(generics, sig, trait_item_def_id, false, None, i.id);\n                 (generics, hir::TraitItemKind::Fn(sig, hir::TraitFn::Required(names)))\n             }\n             AssocItemKind::Fn(_, ref sig, ref generics, Some(ref body)) => {\n                 let body_id = self.lower_fn_body_block(i.span, &sig.decl, Some(body));\n                 let (generics, sig) =\n-                    self.lower_method_sig(generics, sig, trait_item_def_id, false, None);\n+                    self.lower_method_sig(generics, sig, trait_item_def_id, false, None, i.id);\n                 (generics, hir::TraitItemKind::Fn(sig, hir::TraitFn::Provided(body_id)))\n             }\n             AssocItemKind::TyAlias(_, ref generics, ref bounds, ref default) => {\n@@ -877,6 +882,7 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                     impl_item_def_id,\n                     impl_trait_return_allow,\n                     asyncness.opt_return_id(),\n+                    i.id,\n                 );\n \n                 (generics, hir::ImplItemKind::Fn(sig, body_id))\n@@ -1270,8 +1276,9 @@ impl<'hir> LoweringContext<'_, 'hir> {\n         fn_def_id: LocalDefId,\n         impl_trait_return_allow: bool,\n         is_async: Option<NodeId>,\n+        id: NodeId,\n     ) -> (hir::Generics<'hir>, hir::FnSig<'hir>) {\n-        let header = self.lower_fn_header(sig.header);\n+        let header = self.lower_fn_header(sig.header, sig.span, id);\n         let (generics, decl) = self.add_in_band_defs(\n             generics,\n             fn_def_id,\n@@ -1288,12 +1295,12 @@ impl<'hir> LoweringContext<'_, 'hir> {\n         (generics, hir::FnSig { header, decl, span: sig.span })\n     }\n \n-    fn lower_fn_header(&mut self, h: FnHeader) -> hir::FnHeader {\n+    fn lower_fn_header(&mut self, h: FnHeader, span: Span, id: NodeId) -> hir::FnHeader {\n         hir::FnHeader {\n             unsafety: self.lower_unsafety(h.unsafety),\n             asyncness: self.lower_asyncness(h.asyncness),\n             constness: self.lower_constness(h.constness),\n-            abi: self.lower_extern(h.ext),\n+            abi: self.lower_extern(h.ext, span, id),\n         }\n     }\n \n@@ -1304,10 +1311,13 @@ impl<'hir> LoweringContext<'_, 'hir> {\n         })\n     }\n \n-    pub(super) fn lower_extern(&mut self, ext: Extern) -> abi::Abi {\n+    pub(super) fn lower_extern(&mut self, ext: Extern, span: Span, id: NodeId) -> abi::Abi {\n         match ext {\n             Extern::None => abi::Abi::Rust,\n-            Extern::Implicit => abi::Abi::C,\n+            Extern::Implicit => {\n+                self.maybe_lint_missing_abi(span, id, abi::Abi::C);\n+                abi::Abi::C\n+            }\n             Extern::Explicit(abi) => self.lower_abi(abi),\n         }\n     }"}, {"sha": "6d95da02151a85c1c00b9d753ae009b756f9cf89", "filename": "compiler/rustc_ast_lowering/src/lib.rs", "status": "modified", "additions": 25, "deletions": 2, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -53,13 +53,15 @@ use rustc_hir::definitions::{DefKey, DefPathData, Definitions};\n use rustc_hir::intravisit;\n use rustc_hir::{ConstArg, GenericArg, ParamName};\n use rustc_index::vec::{Idx, IndexVec};\n-use rustc_session::lint::{builtin::BARE_TRAIT_OBJECTS, BuiltinLintDiagnostics, LintBuffer};\n+use rustc_session::lint::builtin::{BARE_TRAIT_OBJECTS, MISSING_ABI};\n+use rustc_session::lint::{BuiltinLintDiagnostics, LintBuffer};\n use rustc_session::parse::ParseSess;\n use rustc_session::Session;\n use rustc_span::hygiene::ExpnId;\n use rustc_span::source_map::{respan, DesugaringKind};\n use rustc_span::symbol::{kw, sym, Ident, Symbol};\n use rustc_span::Span;\n+use rustc_target::spec::abi::Abi;\n \n use smallvec::{smallvec, SmallVec};\n use std::collections::BTreeMap;\n@@ -1288,14 +1290,15 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n             }\n             TyKind::BareFn(ref f) => self.with_in_scope_lifetime_defs(&f.generic_params, |this| {\n                 this.with_anonymous_lifetime_mode(AnonymousLifetimeMode::PassThrough, |this| {\n+                    let span = this.sess.source_map().next_point(t.span.shrink_to_lo());\n                     hir::TyKind::BareFn(this.arena.alloc(hir::BareFnTy {\n                         generic_params: this.lower_generic_params(\n                             &f.generic_params,\n                             &NodeMap::default(),\n                             ImplTraitContext::disallowed(),\n                         ),\n                         unsafety: this.lower_unsafety(f.unsafety),\n-                        abi: this.lower_extern(f.ext),\n+                        abi: this.lower_extern(f.ext, span, t.id),\n                         decl: this.lower_fn_decl(&f.decl, None, false, None),\n                         param_names: this.lower_fn_params_to_names(&f.decl),\n                     }))\n@@ -2777,6 +2780,26 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n             )\n         }\n     }\n+\n+    fn maybe_lint_missing_abi(&mut self, span: Span, id: NodeId, default: Abi) {\n+        // FIXME(davidtwco): This is a hack to detect macros which produce spans of the\n+        // call site which do not have a macro backtrace. See #61963.\n+        let is_macro_callsite = self\n+            .sess\n+            .source_map()\n+            .span_to_snippet(span)\n+            .map(|snippet| snippet.starts_with(\"#[\"))\n+            .unwrap_or(true);\n+        if !is_macro_callsite {\n+            self.resolver.lint_buffer().buffer_lint_with_diagnostic(\n+                MISSING_ABI,\n+                id,\n+                span,\n+                \"extern declarations without an explicit ABI are deprecated\",\n+                BuiltinLintDiagnostics::MissingAbi(span, default),\n+            )\n+        }\n+    }\n }\n \n fn body_ids(bodies: &BTreeMap<hir::BodyId, hir::Body<'_>>) -> Vec<hir::BodyId> {"}, {"sha": "ed7daf8ddd9c7adc41986b033e9919cb0ed0ba1c", "filename": "compiler/rustc_error_codes/src/error_codes/E0044.md", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0044.md", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0044.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0044.md?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,13 +3,13 @@ You cannot use type or const parameters on foreign items.\n Example of erroneous code:\n \n ```compile_fail,E0044\n-extern { fn some_func<T>(x: T); }\n+extern \"C\" { fn some_func<T>(x: T); }\n ```\n \n To fix this, replace the generic parameter with the specializations that you\n need:\n \n ```\n-extern { fn some_func_i32(x: i32); }\n-extern { fn some_func_i64(x: i64); }\n+extern \"C\" { fn some_func_i32(x: i32); }\n+extern \"C\" { fn some_func_i64(x: i64); }\n ```"}, {"sha": "2cd27b5ec0523b7752fd4437695ccb7de34a76a5", "filename": "compiler/rustc_error_codes/src/error_codes/E0130.md", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0130.md", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0130.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0130.md?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,7 +3,7 @@ A pattern was declared as an argument in a foreign function declaration.\n Erroneous code example:\n \n ```compile_fail,E0130\n-extern {\n+extern \"C\" {\n     fn foo((a, b): (u32, u32)); // error: patterns aren't allowed in foreign\n                                 //        function declarations\n }\n@@ -17,15 +17,15 @@ struct SomeStruct {\n     b: u32,\n }\n \n-extern {\n+extern \"C\" {\n     fn foo(s: SomeStruct); // ok!\n }\n ```\n \n Or:\n \n ```\n-extern {\n+extern \"C\" {\n     fn foo(a: (u32, u32)); // ok!\n }\n ```"}, {"sha": "95a22b92e36eeffc106a78053b9986942347bff7", "filename": "compiler/rustc_error_codes/src/error_codes/E0454.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0454.md", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0454.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0454.md?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,13 +3,13 @@ A link name was given with an empty name.\n Erroneous code example:\n \n ```compile_fail,E0454\n-#[link(name = \"\")] extern {}\n+#[link(name = \"\")] extern \"C\" {}\n // error: `#[link(name = \"\")]` given with empty name\n ```\n \n The rust compiler cannot link to an external library if you don't give it its\n name. Example:\n \n ```no_run\n-#[link(name = \"some_lib\")] extern {} // ok!\n+#[link(name = \"some_lib\")] extern \"C\" {} // ok!\n ```"}, {"sha": "84689b3ece6104787ae318862eef80dab3c4e751", "filename": "compiler/rustc_error_codes/src/error_codes/E0455.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0455.md", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0455.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0455.md?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -4,15 +4,15 @@ as frameworks are specific to that operating system.\n Erroneous code example:\n \n ```ignore (should-compile_fail-but-cannot-doctest-conditionally-without-macos)\n-#[link(name = \"FooCoreServices\", kind = \"framework\")] extern {}\n+#[link(name = \"FooCoreServices\", kind = \"framework\")] extern \"C\" {}\n // OS used to compile is Linux for example\n ```\n \n To solve this error you can use conditional compilation:\n \n ```\n #[cfg_attr(target=\"macos\", link(name = \"FooCoreServices\", kind = \"framework\"))]\n-extern {}\n+extern \"C\" {}\n ```\n \n Learn more in the [Conditional Compilation][conditional-compilation] section"}, {"sha": "359aeb6fd9a0ab85a2b4dca71ac1b58431900951", "filename": "compiler/rustc_error_codes/src/error_codes/E0458.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0458.md", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0458.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0458.md?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,7 +3,7 @@ An unknown \"kind\" was specified for a link attribute.\n Erroneous code example:\n \n ```compile_fail,E0458\n-#[link(kind = \"wonderful_unicorn\")] extern {}\n+#[link(kind = \"wonderful_unicorn\")] extern \"C\" {}\n // error: unknown kind: `wonderful_unicorn`\n ```\n "}, {"sha": "4a49a7654452059ec5a6c64a32828f97337bd725", "filename": "compiler/rustc_error_codes/src/error_codes/E0459.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0459.md", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0459.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0459.md?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,13 +3,13 @@ A link was used without a name parameter.\n Erroneous code example:\n \n ```compile_fail,E0459\n-#[link(kind = \"dylib\")] extern {}\n+#[link(kind = \"dylib\")] extern \"C\" {}\n // error: `#[link(...)]` specified without `name = \"foo\"`\n ```\n \n Please add the name parameter to allow the rust compiler to find the library\n you want. Example:\n \n ```no_run\n-#[link(kind = \"dylib\", name = \"some_lib\")] extern {} // ok!\n+#[link(kind = \"dylib\", name = \"some_lib\")] extern \"C\" {} // ok!\n ```"}, {"sha": "1c5d1f87b912b33a627105704f1f2c0cd16bab10", "filename": "compiler/rustc_error_codes/src/error_codes/E0617.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0617.md", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0617.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0617.md?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,7 +3,7 @@ Attempted to pass an invalid type of variable into a variadic function.\n Erroneous code example:\n \n ```compile_fail,E0617\n-extern {\n+extern \"C\" {\n     fn printf(c: *const i8, ...);\n }\n \n@@ -21,7 +21,7 @@ to import from `std::os::raw`).\n In this case, `c_double` has the same size as `f64` so we can use it directly:\n \n ```no_run\n-# extern {\n+# extern \"C\" {\n #     fn printf(c: *const i8, ...);\n # }\n unsafe {"}, {"sha": "4d1f0c47829c9b9662143f7036374465d995fdf4", "filename": "compiler/rustc_error_codes/src/error_codes/E0633.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0633.md", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0633.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0633.md?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -6,7 +6,7 @@ Erroneous code example:\n #![feature(unwind_attributes)]\n \n #[unwind()] // error: expected one argument\n-pub extern fn something() {}\n+pub extern \"C\" fn something() {}\n \n fn main() {}\n ```"}, {"sha": "70578acbe0d5f7afa1bf5114c8897a536e2aa165", "filename": "compiler/rustc_error_codes/src/error_codes/E0724.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0724.md", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0724.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0724.md?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -18,7 +18,7 @@ the function inside of an\u00a0`extern`\u00a0block.\n ```\n #![feature(ffi_returns_twice)]\n \n-extern {\n+extern \"C\" {\n    #[ffi_returns_twice] // ok!\n    pub fn foo();\n }"}, {"sha": "0f40324acb11cc09a4c52eb376d0669dbdde00ce", "filename": "compiler/rustc_lint/src/context.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_lint%2Fsrc%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_lint%2Fsrc%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Fcontext.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -600,6 +600,10 @@ pub trait LintContext: Sized {\n                 BuiltinLintDiagnostics::PatternsInFnsWithoutBody(span, ident) => {\n                     db.span_suggestion(span, \"remove `mut` from the parameter\", ident.to_string(), Applicability::MachineApplicable);\n                 }\n+                BuiltinLintDiagnostics::MissingAbi(span, default_abi) => {\n+                    db.span_label(span, \"ABI should be specified here\");\n+                    db.help(&format!(\"the default ABI is {}\", default_abi.name()));\n+                }\n             }\n             // Rewrap `db`, and pass control to the user.\n             decorate(LintDiagnosticBuilder::new(db));"}, {"sha": "f909f159784cbae36ad53f04e30628c08d175559", "filename": "compiler/rustc_lint_defs/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_lint_defs%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_lint_defs%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint_defs%2FCargo.toml?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -11,3 +11,4 @@ rustc_data_structures = { path = \"../rustc_data_structures\" }\n rustc_span = { path = \"../rustc_span\" }\n rustc_serialize = { path = \"../rustc_serialize\" }\n rustc_macros = { path = \"../rustc_macros\" }\n+rustc_target = { path = \"../rustc_target\" }"}, {"sha": "e9632796704118081235ba66810973cedcb5179c", "filename": "compiler/rustc_lint_defs/src/builtin.rs", "status": "modified", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_lint_defs%2Fsrc%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_lint_defs%2Fsrc%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint_defs%2Fsrc%2Fbuiltin.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2917,6 +2917,7 @@ declare_lint_pass! {\n         FUNCTION_ITEM_REFERENCES,\n         USELESS_DEPRECATED,\n         UNSUPPORTED_NAKED_FUNCTIONS,\n+        MISSING_ABI,\n     ]\n }\n \n@@ -2944,3 +2945,28 @@ declare_lint! {\n }\n \n declare_lint_pass!(UnusedDocComment => [UNUSED_DOC_COMMENTS]);\n+\n+declare_lint! {\n+    /// The `missing_abi` lint detects cases where the ABI is omitted from\n+    /// extern declarations.\n+    ///\n+    /// ### Example\n+    ///\n+    /// ```rust,compile_fail\n+    /// #![deny(missing_abi)]\n+    ///\n+    /// extern fn foo() {}\n+    /// ```\n+    ///\n+    /// {{produces}}\n+    ///\n+    /// ### Explanation\n+    ///\n+    /// Historically, Rust implicitly selected C as the ABI for extern\n+    /// declarations. We expect to add new ABIs, like `C-unwind`, in the future,\n+    /// though this has not yet happened, and especially with their addition\n+    /// seeing the ABI easily will make code review easier.\n+    pub MISSING_ABI,\n+    Allow,\n+    \"No declared ABI for extern declaration\"\n+}"}, {"sha": "9d60a51a0afb3c9840299e34cd19ba09768099c1", "filename": "compiler/rustc_lint_defs/src/lib.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_lint_defs%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_lint_defs%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint_defs%2Fsrc%2Flib.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -6,6 +6,7 @@ use rustc_ast::node_id::{NodeId, NodeMap};\n use rustc_data_structures::stable_hasher::{HashStable, StableHasher, ToStableHashKey};\n use rustc_span::edition::Edition;\n use rustc_span::{sym, symbol::Ident, MultiSpan, Span, Symbol};\n+use rustc_target::spec::abi::Abi;\n \n pub mod builtin;\n \n@@ -252,6 +253,7 @@ pub enum BuiltinLintDiagnostics {\n     UnusedImports(String, Vec<(Span, String)>),\n     RedundantImport(Vec<(Span, bool)>, Ident),\n     DeprecatedMacro(Option<Symbol>, Span),\n+    MissingAbi(Span, Abi),\n     UnusedDocComment(Span),\n     PatternsInFnsWithoutBody(Span, Ident),\n }"}, {"sha": "592010d78cf87e3ccb12ea7c915f4e6544f3beb6", "filename": "compiler/rustc_llvm/src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_llvm%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/compiler%2Frustc_llvm%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_llvm%2Fsrc%2Flib.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -38,7 +38,7 @@ pub fn initialize_available_targets() {\n         ($cfg:meta, $($method:ident),*) => { {\n             #[cfg($cfg)]\n             fn init() {\n-                extern {\n+                extern \"C\" {\n                     $(fn $method();)*\n                 }\n                 unsafe {"}, {"sha": "a167f0ffa09ecf7be66c8a3bf3353037e2fc49f5", "filename": "library/core/src/sync/atomic.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/library%2Fcore%2Fsrc%2Fsync%2Fatomic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/library%2Fcore%2Fsrc%2Fsync%2Fatomic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fsync%2Fatomic.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -809,7 +809,7 @@ impl AtomicBool {\n     /// ```ignore (extern-declaration)\n     /// # fn main() {\n     /// use std::sync::atomic::AtomicBool;\n-    /// extern {\n+    /// extern \"C\" {\n     ///     fn my_atomic_op(arg: *mut bool);\n     /// }\n     ///\n@@ -2068,7 +2068,7 @@ macro_rules! atomic_int {\n             /// # fn main() {\n             #[doc = concat!($extra_feature, \"use std::sync::atomic::\", stringify!($atomic_type), \";\")]\n             ///\n-            /// extern {\n+            /// extern \"C\" {\n             #[doc = concat!(\"    fn my_atomic_op(arg: *mut \", stringify!($int_type), \");\")]\n             /// }\n             ///"}, {"sha": "230ef0b23db6dc9a3cb476cf97c15956827c493e", "filename": "library/std/src/ffi/c_str.rs", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/library%2Fstd%2Fsrc%2Fffi%2Fc_str.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/library%2Fstd%2Fsrc%2Fffi%2Fc_str.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fffi%2Fc_str.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -86,7 +86,7 @@ use crate::sys;\n /// use std::ffi::CString;\n /// use std::os::raw::c_char;\n ///\n-/// extern {\n+/// extern \"C\" {\n ///     fn my_printer(s: *const c_char);\n /// }\n ///\n@@ -144,7 +144,7 @@ pub struct CString {\n /// use std::ffi::CStr;\n /// use std::os::raw::c_char;\n ///\n-/// extern { fn my_string() -> *const c_char; }\n+/// extern \"C\" { fn my_string() -> *const c_char; }\n ///\n /// unsafe {\n ///     let slice = CStr::from_ptr(my_string());\n@@ -159,7 +159,7 @@ pub struct CString {\n /// use std::os::raw::c_char;\n ///\n /// fn work(data: &CStr) {\n-///     extern { fn work_with(data: *const c_char); }\n+///     extern \"C\" { fn work_with(data: *const c_char); }\n ///\n ///     unsafe { work_with(data.as_ptr()) }\n /// }\n@@ -174,7 +174,7 @@ pub struct CString {\n /// use std::ffi::CStr;\n /// use std::os::raw::c_char;\n ///\n-/// extern { fn my_string() -> *const c_char; }\n+/// extern \"C\" { fn my_string() -> *const c_char; }\n ///\n /// fn my_string_safe() -> String {\n ///     unsafe {\n@@ -359,7 +359,7 @@ impl CString {\n     /// use std::ffi::CString;\n     /// use std::os::raw::c_char;\n     ///\n-    /// extern { fn puts(s: *const c_char); }\n+    /// extern \"C\" { fn puts(s: *const c_char); }\n     ///\n     /// let to_print = CString::new(\"Hello!\").expect(\"CString::new failed\");\n     /// unsafe {\n@@ -465,7 +465,7 @@ impl CString {\n     /// use std::ffi::CString;\n     /// use std::os::raw::c_char;\n     ///\n-    /// extern {\n+    /// extern \"C\" {\n     ///     fn some_extern_function(s: *mut c_char);\n     /// }\n     ///\n@@ -1147,7 +1147,7 @@ impl CStr {\n     /// use std::ffi::CStr;\n     /// use std::os::raw::c_char;\n     ///\n-    /// extern {\n+    /// extern \"C\" {\n     ///     fn my_string() -> *const c_char;\n     /// }\n     ///"}, {"sha": "6b06539a0940f73aee6bfcaff679c7a9f4b167e9", "filename": "library/std/src/keyword_docs.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/library%2Fstd%2Fsrc%2Fkeyword_docs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/library%2Fstd%2Fsrc%2Fkeyword_docs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fkeyword_docs.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -401,7 +401,7 @@ mod enum_keyword {}\n ///\n /// ```rust\n /// #[no_mangle]\n-/// pub extern fn callable_from_c(x: i32) -> bool {\n+/// pub extern \"C\" fn callable_from_c(x: i32) -> bool {\n ///     x % 3 == 0\n /// }\n /// ```"}, {"sha": "432fe4c33bcc461b40ce2a54a3a2f927fbc5479b", "filename": "library/std/src/sys/unix/weak.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fweak.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fweak.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fweak.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -28,7 +28,7 @@ use crate::sync::atomic::{self, AtomicUsize, Ordering};\n \n macro_rules! weak {\n     (fn $name:ident($($t:ty),*) -> $ret:ty) => (\n-        static $name: crate::sys::weak::Weak<unsafe extern fn($($t),*) -> $ret> =\n+        static $name: crate::sys::weak::Weak<unsafe extern \"C\" fn($($t),*) -> $ret> =\n             crate::sys::weak::Weak::new(concat!(stringify!($name), '\\0'));\n     )\n }"}, {"sha": "da36e1580012b7c37703b2ee882c620857f79f69", "filename": "src/doc/unstable-book/src/language-features/link-args.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Flink-args.md", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Flink-args.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Flink-args.md?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -15,7 +15,7 @@ usage would be:\n #![feature(link_args)]\n \n #[link_args = \"-foo -bar -baz\"]\n-extern {}\n+extern \"C\" {}\n # fn main() {}\n ```\n "}, {"sha": "998099c23909855e163986cbd410adc5828307c7", "filename": "src/test/codegen/call-llvm-intrinsics.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fcall-llvm-intrinsics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fcall-llvm-intrinsics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fcall-llvm-intrinsics.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -13,7 +13,7 @@ impl Drop for A {\n     }\n }\n \n-extern {\n+extern \"C\" {\n     #[link_name = \"llvm.sqrt.f32\"]\n     fn sqrt(x: f32) -> f32;\n }"}, {"sha": "f047c7a180ce20ef72c67b7f0d4a0cc3dd42639a", "filename": "src/test/codegen/dealloc-no-unwind.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fdealloc-no-unwind.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fdealloc-no-unwind.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fdealloc-no-unwind.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -8,7 +8,7 @@ struct A;\n \n impl Drop for A {\n     fn drop(&mut self) {\n-        extern { fn foo(); }\n+        extern \"C\" { fn foo(); }\n         unsafe { foo(); }\n     }\n }"}, {"sha": "5d3afef5289bf7930353f7e3dc32568834f8aaa3", "filename": "src/test/codegen/debug-column.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fdebug-column.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fdebug-column.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fdebug-column.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -18,7 +18,7 @@ fn main() {\n     }\n }\n \n-extern {\n+extern \"C\" {\n     fn giraffe();\n     fn turtle();\n }"}, {"sha": "9011a7da51db8e72e8f755c953b45f6ae4199818", "filename": "src/test/codegen/debug-linkage-name.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fdebug-linkage-name.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fdebug-linkage-name.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fdebug-linkage-name.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -26,17 +26,17 @@ pub mod xyz {\n     // CHECK: !DISubprogram(name: \"e\",\n     // CHECK:               linkageName:\n     // CHECK-SAME:          line: 29,\n-    pub extern fn e() {}\n+    pub extern \"C\" fn e() {}\n \n     // CHECK: !DISubprogram(name: \"f\",\n     // CHECK-NOT:           linkageName:\n     // CHECK-SAME:          line: 35,\n     #[no_mangle]\n-    pub extern fn f() {}\n+    pub extern \"C\" fn f() {}\n \n     // CHECK: !DISubprogram(name: \"g\",\n     // CHECK-NOT:           linkageName:\n     // CHECK-SAME:          line: 41,\n     #[export_name = \"g\"]\n-    pub extern fn g() {}\n+    pub extern \"C\" fn g() {}\n }"}, {"sha": "a89d48ee1533ff655617e0e333a1e03bef64680b", "filename": "src/test/codegen/export-no-mangle.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fexport-no-mangle.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fexport-no-mangle.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fexport-no-mangle.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -13,19 +13,19 @@ mod private {\n \n     // CHECK: void @a()\n     #[no_mangle]\n-    pub extern fn a() {}\n+    pub extern \"C\" fn a() {}\n \n     // CHECK: void @b()\n     #[export_name = \"b\"]\n-    extern fn b() {}\n+    extern \"C\" fn b() {}\n \n     // CHECK: void @c()\n     #[export_name = \"c\"]\n     #[inline]\n-    extern fn c() {}\n+    extern \"C\" fn c() {}\n \n     // CHECK: void @d()\n     #[export_name = \"d\"]\n     #[inline(always)]\n-    extern fn d() {}\n+    extern \"C\" fn d() {}\n }"}, {"sha": "67baf6fdd3e03d7c39f29afd7e35846c4e741b5d", "filename": "src/test/codegen/ffi-const.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fffi-const.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fffi-const.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fffi-const.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -4,7 +4,7 @@\n \n pub fn bar() { unsafe { foo() } }\n \n-extern {\n+extern \"C\" {\n     // CHECK-LABEL: declare void @foo()\n     // CHECK-SAME: [[ATTRS:#[0-9]+]]\n     // CHECK-DAG: attributes [[ATTRS]] = { {{.*}}readnone{{.*}} }"}, {"sha": "dc16306eb96bef2701cc77220a4a3588726897d2", "filename": "src/test/codegen/ffi-out-of-bounds-loads.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fffi-out-of-bounds-loads.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fffi-out-of-bounds-loads.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fffi-out-of-bounds-loads.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -11,7 +11,7 @@ struct S {\n     f3: i32,\n }\n \n-extern {\n+extern \"C\" {\n     fn foo(s: S);\n }\n "}, {"sha": "3afb0856c9d72fb39a717ec36e9f1a26c29a5dfd", "filename": "src/test/codegen/ffi-pure.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fffi-pure.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fffi-pure.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fffi-pure.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -4,7 +4,7 @@\n \n pub fn bar() { unsafe { foo() } }\n \n-extern {\n+extern \"C\" {\n     // CHECK-LABEL: declare void @foo()\n     // CHECK-SAME: [[ATTRS:#[0-9]+]]\n     // CHECK-DAG: attributes [[ATTRS]] = { {{.*}}readonly{{.*}} }"}, {"sha": "75301dfd346ebd91d47403cf5beb2fa73e32c138", "filename": "src/test/codegen/ffi-returns-twice.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fffi-returns-twice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fffi-returns-twice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fffi-returns-twice.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -4,7 +4,7 @@\n \n pub fn bar() { unsafe { foo() } }\n \n-extern {\n+extern \"C\" {\n     // CHECK-LABEL: declare void @foo()\n     // CHECK-SAME: [[ATTRS:#[0-9]+]]\n     // CHECK-DAG: attributes [[ATTRS]] = { {{.*}}returns_twice{{.*}} }"}, {"sha": "9076274f45e94e19393c2ea424b88c5afa8d9bc2", "filename": "src/test/codegen/issue-47278.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fissue-47278.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Fissue-47278.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fissue-47278.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -6,4 +6,4 @@ pub struct Foo(u64);\n \n // CHECK: define {{.*}} @foo(\n #[no_mangle]\n-pub extern fn foo(_: Foo) -> Foo { loop {} }\n+pub extern \"C\" fn foo(_: Foo) -> Foo { loop {} }"}, {"sha": "2b8d3c8bc1d22bdcdcbc2d998ceb849ad1abc12d", "filename": "src/test/codegen/repr-transparent-aggregates-1.rs", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Frepr-transparent-aggregates-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Frepr-transparent-aggregates-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Frepr-transparent-aggregates-1.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -36,19 +36,19 @@ pub enum TeBigS {\n \n // CHECK: define void @test_BigS(%BigS* [[BIGS_RET_ATTRS:.*]], %BigS* [[BIGS_ARG_ATTRS1:.*]] byval(%BigS) [[BIGS_ARG_ATTRS2:.*]])\n #[no_mangle]\n-pub extern fn test_BigS(_: BigS) -> BigS { loop {} }\n+pub extern \"C\" fn test_BigS(_: BigS) -> BigS { loop {} }\n \n // CHECK: define void @test_TsBigS(%TsBigS* [[BIGS_RET_ATTRS]], %TsBigS* [[BIGS_ARG_ATTRS1]] byval(%TsBigS) [[BIGS_ARG_ATTRS2:.*]])\n #[no_mangle]\n-pub extern fn test_TsBigS(_: TsBigS) -> TsBigS { loop {} }\n+pub extern \"C\" fn test_TsBigS(_: TsBigS) -> TsBigS { loop {} }\n \n // CHECK: define void @test_TuBigS(%TuBigS* [[BIGS_RET_ATTRS]], %TuBigS* [[BIGS_ARG_ATTRS1]] byval(%TuBigS) [[BIGS_ARG_ATTRS2:.*]])\n #[no_mangle]\n-pub extern fn test_TuBigS(_: TuBigS) -> TuBigS { loop {} }\n+pub extern \"C\" fn test_TuBigS(_: TuBigS) -> TuBigS { loop {} }\n \n // CHECK: define void @test_TeBigS(%\"TeBigS::Variant\"* [[BIGS_RET_ATTRS]], %\"TeBigS::Variant\"* [[BIGS_ARG_ATTRS1]] byval(%\"TeBigS::Variant\") [[BIGS_ARG_ATTRS2]])\n #[no_mangle]\n-pub extern fn test_TeBigS(_: TeBigS) -> TeBigS { loop {} }\n+pub extern \"C\" fn test_TeBigS(_: TeBigS) -> TeBigS { loop {} }\n \n \n #[derive(Clone, Copy)]\n@@ -72,16 +72,16 @@ pub enum TeBigU {\n \n // CHECK: define void @test_BigU(%BigU* [[BIGU_RET_ATTRS:.*]], %BigU* [[BIGU_ARG_ATTRS1:.*]] byval(%BigU) [[BIGU_ARG_ATTRS2:.*]])\n #[no_mangle]\n-pub extern fn test_BigU(_: BigU) -> BigU { loop {} }\n+pub extern \"C\" fn test_BigU(_: BigU) -> BigU { loop {} }\n \n // CHECK: define void @test_TsBigU(%TsBigU* [[BIGU_RET_ATTRS:.*]], %TsBigU* [[BIGU_ARG_ATTRS1]] byval(%TsBigU) [[BIGU_ARG_ATTRS2]])\n #[no_mangle]\n-pub extern fn test_TsBigU(_: TsBigU) -> TsBigU { loop {} }\n+pub extern \"C\" fn test_TsBigU(_: TsBigU) -> TsBigU { loop {} }\n \n // CHECK: define void @test_TuBigU(%TuBigU* [[BIGU_RET_ATTRS]], %TuBigU* [[BIGU_ARG_ATTRS1]] byval(%TuBigU) [[BIGU_ARG_ATTRS2]])\n #[no_mangle]\n-pub extern fn test_TuBigU(_: TuBigU) -> TuBigU { loop {} }\n+pub extern \"C\" fn test_TuBigU(_: TuBigU) -> TuBigU { loop {} }\n \n // CHECK: define void @test_TeBigU(%\"TeBigU::Variant\"* [[BIGU_RET_ATTRS]], %\"TeBigU::Variant\"* [[BIGU_ARG_ATTRS1]] byval(%\"TeBigU::Variant\") [[BIGU_ARG_ATTRS2]])\n #[no_mangle]\n-pub extern fn test_TeBigU(_: TeBigU) -> TeBigU { loop {} }\n+pub extern \"C\" fn test_TeBigU(_: TeBigU) -> TeBigU { loop {} }"}, {"sha": "29997313511b21bed74c3401704b556900725e9f", "filename": "src/test/codegen/repr-transparent.rs", "status": "modified", "additions": 17, "deletions": 17, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Frepr-transparent.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Frepr-transparent.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Frepr-transparent.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -19,36 +19,36 @@ pub struct F32(f32);\n \n // CHECK: define float @test_F32(float %_1)\n #[no_mangle]\n-pub extern fn test_F32(_: F32) -> F32 { loop {} }\n+pub extern \"C\" fn test_F32(_: F32) -> F32 { loop {} }\n \n #[repr(transparent)]\n pub struct Ptr(*mut u8);\n \n // CHECK: define i8* @test_Ptr(i8* %_1)\n #[no_mangle]\n-pub extern fn test_Ptr(_: Ptr) -> Ptr { loop {} }\n+pub extern \"C\" fn test_Ptr(_: Ptr) -> Ptr { loop {} }\n \n #[repr(transparent)]\n pub struct WithZst(u64, Zst1);\n \n // CHECK: define i64 @test_WithZst(i64 %_1)\n #[no_mangle]\n-pub extern fn test_WithZst(_: WithZst) -> WithZst { loop {} }\n+pub extern \"C\" fn test_WithZst(_: WithZst) -> WithZst { loop {} }\n \n #[repr(transparent)]\n pub struct WithZeroSizedArray(*const f32, [i8; 0]);\n \n // Apparently we use i32* when newtype-unwrapping f32 pointers. Whatever.\n // CHECK: define i32* @test_WithZeroSizedArray(i32* %_1)\n #[no_mangle]\n-pub extern fn test_WithZeroSizedArray(_: WithZeroSizedArray) -> WithZeroSizedArray { loop {} }\n+pub extern \"C\" fn test_WithZeroSizedArray(_: WithZeroSizedArray) -> WithZeroSizedArray { loop {} }\n \n #[repr(transparent)]\n pub struct Generic<T>(T);\n \n // CHECK: define double @test_Generic(double %_1)\n #[no_mangle]\n-pub extern fn test_Generic(_: Generic<f64>) -> Generic<f64> { loop {} }\n+pub extern \"C\" fn test_Generic(_: Generic<f64>) -> Generic<f64> { loop {} }\n \n #[repr(transparent)]\n pub struct GenericPlusZst<T>(T, Zst2);\n@@ -58,14 +58,14 @@ pub enum Bool { True, False, FileNotFound }\n \n // CHECK: define{{( zeroext)?}} i8 @test_Gpz(i8{{( zeroext)?}} %_1)\n #[no_mangle]\n-pub extern fn test_Gpz(_: GenericPlusZst<Bool>) -> GenericPlusZst<Bool> { loop {} }\n+pub extern \"C\" fn test_Gpz(_: GenericPlusZst<Bool>) -> GenericPlusZst<Bool> { loop {} }\n \n #[repr(transparent)]\n pub struct LifetimePhantom<'a, T: 'a>(*const T, PhantomData<&'a T>);\n \n // CHECK: define i16* @test_LifetimePhantom(i16* %_1)\n #[no_mangle]\n-pub extern fn test_LifetimePhantom(_: LifetimePhantom<i16>) -> LifetimePhantom<i16> { loop {} }\n+pub extern \"C\" fn test_LifetimePhantom(_: LifetimePhantom<i16>) -> LifetimePhantom<i16> { loop {} }\n \n // This works despite current alignment resrictions because PhantomData is always align(1)\n #[repr(transparent)]\n@@ -75,28 +75,28 @@ pub struct Px;\n \n // CHECK: define float @test_UnitPhantom(float %_1)\n #[no_mangle]\n-pub extern fn test_UnitPhantom(_: UnitPhantom<f32, Px>) -> UnitPhantom<f32, Px> { loop {} }\n+pub extern \"C\" fn test_UnitPhantom(_: UnitPhantom<f32, Px>) -> UnitPhantom<f32, Px> { loop {} }\n \n #[repr(transparent)]\n pub struct TwoZsts(Zst1, i8, Zst2);\n \n // CHECK: define{{( signext)?}} i8 @test_TwoZsts(i8{{( signext)?}} %_1)\n #[no_mangle]\n-pub extern fn test_TwoZsts(_: TwoZsts) -> TwoZsts { loop {} }\n+pub extern \"C\" fn test_TwoZsts(_: TwoZsts) -> TwoZsts { loop {} }\n \n #[repr(transparent)]\n pub struct Nested1(Zst2, Generic<f64>);\n \n // CHECK: define double @test_Nested1(double %_1)\n #[no_mangle]\n-pub extern fn test_Nested1(_: Nested1) -> Nested1 { loop {} }\n+pub extern \"C\" fn test_Nested1(_: Nested1) -> Nested1 { loop {} }\n \n #[repr(transparent)]\n pub struct Nested2(Nested1, Zst1);\n \n // CHECK: define double @test_Nested2(double %_1)\n #[no_mangle]\n-pub extern fn test_Nested2(_: Nested2) -> Nested2 { loop {} }\n+pub extern \"C\" fn test_Nested2(_: Nested2) -> Nested2 { loop {} }\n \n #[repr(simd)]\n struct f32x4(f32, f32, f32, f32);\n@@ -106,7 +106,7 @@ pub struct Vector(f32x4);\n \n // CHECK: define <4 x float> @test_Vector(<4 x float> %_1)\n #[no_mangle]\n-pub extern fn test_Vector(_: Vector) -> Vector { loop {} }\n+pub extern \"C\" fn test_Vector(_: Vector) -> Vector { loop {} }\n \n trait Mirror { type It: ?Sized; }\n impl<T: ?Sized> Mirror for T { type It = Self; }\n@@ -116,7 +116,7 @@ pub struct StructWithProjection(<f32 as Mirror>::It);\n \n // CHECK: define float @test_Projection(float %_1)\n #[no_mangle]\n-pub extern fn test_Projection(_: StructWithProjection) -> StructWithProjection { loop {} }\n+pub extern \"C\" fn test_Projection(_: StructWithProjection) -> StructWithProjection { loop {} }\n \n #[repr(transparent)]\n pub enum EnumF32 {\n@@ -125,7 +125,7 @@ pub enum EnumF32 {\n \n // CHECK: define float @test_EnumF32(float %_1)\n #[no_mangle]\n-pub extern fn test_EnumF32(_: EnumF32) -> EnumF32 { loop {} }\n+pub extern \"C\" fn test_EnumF32(_: EnumF32) -> EnumF32 { loop {} }\n \n #[repr(transparent)]\n pub enum EnumF32WithZsts {\n@@ -134,7 +134,7 @@ pub enum EnumF32WithZsts {\n \n // CHECK: define float @test_EnumF32WithZsts(float %_1)\n #[no_mangle]\n-pub extern fn test_EnumF32WithZsts(_: EnumF32WithZsts) -> EnumF32WithZsts { loop {} }\n+pub extern \"C\" fn test_EnumF32WithZsts(_: EnumF32WithZsts) -> EnumF32WithZsts { loop {} }\n \n #[repr(transparent)]\n pub union UnionF32 {\n@@ -143,7 +143,7 @@ pub union UnionF32 {\n \n // CHECK: define float @test_UnionF32(float %_1)\n #[no_mangle]\n-pub extern fn test_UnionF32(_: UnionF32) -> UnionF32 { loop {} }\n+pub extern \"C\" fn test_UnionF32(_: UnionF32) -> UnionF32 { loop {} }\n \n #[repr(transparent)]\n pub union UnionF32WithZsts {\n@@ -154,7 +154,7 @@ pub union UnionF32WithZsts {\n \n // CHECK: define float @test_UnionF32WithZsts(float %_1)\n #[no_mangle]\n-pub extern fn test_UnionF32WithZsts(_: UnionF32WithZsts) -> UnionF32WithZsts { loop {} }\n+pub extern \"C\" fn test_UnionF32WithZsts(_: UnionF32WithZsts) -> UnionF32WithZsts { loop {} }\n \n \n // All that remains to be tested are aggregates. They are tested in separate files called repr-"}, {"sha": "31a88f2c0a98166d1ae1ca729b5a01f3fda9d70f", "filename": "src/test/codegen/riscv-abi/call-llvm-intrinsics.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Friscv-abi%2Fcall-llvm-intrinsics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Friscv-abi%2Fcall-llvm-intrinsics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Friscv-abi%2Fcall-llvm-intrinsics.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -13,7 +13,7 @@ impl Drop for A {\n     }\n }\n \n-extern {\n+extern \"C\" {\n     #[link_name = \"llvm.sqrt.f32\"]\n     fn sqrt(x: f32) -> f32;\n }"}, {"sha": "7544ac01309525bdf94bc6bb9c876cb91fb59341", "filename": "src/test/codegen/target-cpu-on-functions.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Ftarget-cpu-on-functions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Ftarget-cpu-on-functions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Ftarget-cpu-on-functions.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -9,7 +9,7 @@\n \n // CHECK-LABEL: define {{.*}} @exported() {{.*}} #0\n #[no_mangle]\n-pub extern fn exported() {\n+pub extern \"C\" fn exported() {\n     not_exported();\n }\n "}, {"sha": "487de20671a2c0bffda69955eab1be4ac79926b6", "filename": "src/test/codegen/unwind-extern-exports.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Funwind-extern-exports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Funwind-extern-exports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Funwind-extern-exports.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -11,7 +11,7 @@\n // \"C\" ABI\n // pub extern fn foo() {} // FIXME right now we don't abort-on-panic but add `nounwind` nevertheless\n #[unwind(allowed)]\n-pub extern fn foo_allowed() {}\n+pub extern \"C\" fn foo_allowed() {}\n \n // \"Rust\"\n // (`extern \"Rust\"` could be removed as all `fn` get it implicitly; we leave it in for clarity.)"}, {"sha": "a2ba24aca259b8f052159e8849efb1decd7f5295", "filename": "src/test/codegen/unwind-extern-imports.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Funwind-extern-imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fcodegen%2Funwind-extern-imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Funwind-extern-imports.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -4,7 +4,7 @@\n #![crate_type = \"lib\"]\n #![feature(unwind_attributes)]\n \n-extern {\n+extern \"C\" {\n // CHECK: Function Attrs:{{.*}}nounwind\n // CHECK-NEXT: declare void @extern_fn\n     fn extern_fn();"}, {"sha": "43e68fedbfafbfb89d4036fb60cf7ed9b31038d8", "filename": "src/test/debuginfo/type-names.rs", "status": "modified", "additions": 32, "deletions": 26, "changes": 58, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fdebuginfo%2Ftype-names.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fdebuginfo%2Ftype-names.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fdebuginfo%2Ftype-names.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -23,7 +23,6 @@\n // gdbg-check:type = struct Struct2\n // gdbr-check:type = type_names::mod1::Struct2\n \n-\n // ENUMS\n // gdb-command:whatis simple_enum_1\n // gdbg-check:type = union Enum1\n@@ -45,7 +44,6 @@\n // gdbg-check:type = union Enum3<type_names::Struct1>\n // gdbr-check:type = type_names::mod1::mod2::Enum3<type_names::Struct1>\n \n-\n // TUPLES\n // gdb-command:whatis tuple1\n // gdbg-check:type = struct (u32, type_names::Struct1, type_names::mod1::mod2::Enum3<type_names::mod1::Struct2>)\n@@ -55,7 +53,6 @@\n // gdbg-check:type = struct ((type_names::Struct1, type_names::mod1::mod2::Struct3), type_names::mod1::Enum2, char)\n // gdbr-check:type = ((type_names::Struct1, type_names::mod1::mod2::Struct3), type_names::mod1::Enum2, char)\n \n-\n // BOX\n // gdb-command:whatis box1\n // gdbg-check:type = struct (alloc::boxed::Box<f32>, i32)\n@@ -65,7 +62,6 @@\n // gdbg-check:type = struct (alloc::boxed::Box<type_names::mod1::mod2::Enum3<f32>>, i32)\n // gdbr-check:type = (alloc::boxed::Box<type_names::mod1::mod2::Enum3<f32>>, i32)\n \n-\n // REFERENCES\n // gdb-command:whatis ref1\n // gdbg-check:type = struct (&type_names::Struct1, i32)\n@@ -83,7 +79,6 @@\n // gdbg-check:type = struct (&mut type_names::GenericStruct<type_names::mod1::Enum2, f64>, i32)\n // gdbr-check:type = (&mut type_names::GenericStruct<type_names::mod1::Enum2, f64>, i32)\n \n-\n // RAW POINTERS\n // gdb-command:whatis mut_ptr1\n // gdbg-check:type = struct (*mut type_names::Struct1, isize)\n@@ -109,7 +104,6 @@\n // gdbg-check:type = struct (*const type_names::mod1::mod2::Enum3<type_names::Struct1>, isize)\n // gdbr-check:type = (*const type_names::mod1::mod2::Enum3<type_names::Struct1>, isize)\n \n-\n // VECTORS\n // gdb-command:whatis fixed_size_vec1\n // gdbg-check:type = struct ([type_names::Struct1; 3], i16)\n@@ -127,7 +121,6 @@\n // gdbg-check:type = struct &[type_names::mod1::Enum2]\n // gdbr-check:type = &[type_names::mod1::Enum2]\n \n-\n // TRAITS\n // gdb-command:whatis box_trait\n // gdbg-check:type = struct Box<Trait1>\n@@ -153,7 +146,6 @@\n // gdbg-check:type = struct &mut Trait2<type_names::mod1::mod2::Struct3, type_names::GenericStruct<usize, isize>>\n // gdbr-check:type = type_names::&mut Trait2<type_names::mod1::mod2::Struct3, type_names::GenericStruct<usize, isize>>\n \n-\n // BARE FUNCTIONS\n // gdb-command:whatis rust_fn\n // gdbg-check:type = struct (fn(core::option::Option<isize>, core::option::Option<&type_names::mod1::Struct2>), usize)\n@@ -199,7 +191,6 @@\n // gdbg-check:type = struct (unsafe extern \"C\" fn(*const u8, ...) -> isize, usize)\n // gdbr-check:type = (unsafe extern \"C\" fn(*const u8, ...) -> isize, usize)\n \n-\n // CLOSURES\n // gdb-command:whatis closure1\n // gdbg-check:type = struct (closure, usize)\n@@ -219,7 +210,7 @@ use std::marker::PhantomData;\n use std::ptr;\n \n pub struct Struct1;\n-struct GenericStruct<T1, T2>(PhantomData<(T1,T2)>);\n+struct GenericStruct<T1, T2>(PhantomData<(T1, T2)>);\n \n enum Enum1 {\n     Variant1,\n@@ -246,8 +237,12 @@ mod mod1 {\n     }\n }\n \n-trait Trait1 { fn dummy(&self) { } }\n-trait Trait2<T1, T2> { fn dummy(&self, _: T1, _:T2) { } }\n+trait Trait1 {\n+    fn dummy(&self) {}\n+}\n+trait Trait2<T1, T2> {\n+    fn dummy(&self, _: T1, _: T2) {}\n+}\n \n impl Trait1 for isize {}\n impl<T1, T2> Trait2<T1, T2> for isize {}\n@@ -257,16 +252,26 @@ extern \"C\" fn extern_c_fn(_: isize) {}\n unsafe fn unsafe_fn(_: Result<char, f64>) {}\n extern \"stdcall\" fn extern_stdcall_fn() {}\n \n-fn rust_fn_with_return_value(_: f64) -> usize { 4 }\n-extern \"C\" fn extern_c_fn_with_return_value() -> Struct1 { Struct1 }\n-unsafe fn unsafe_fn_with_return_value(_: GenericStruct<u16, u8>) -> mod1::Struct2 { mod1::Struct2 }\n-extern \"stdcall\" fn extern_stdcall_fn_with_return_value(_: Box<isize>) -> usize { 0 }\n+fn rust_fn_with_return_value(_: f64) -> usize {\n+    4\n+}\n+extern \"C\" fn extern_c_fn_with_return_value() -> Struct1 {\n+    Struct1\n+}\n+unsafe fn unsafe_fn_with_return_value(_: GenericStruct<u16, u8>) -> mod1::Struct2 {\n+    mod1::Struct2\n+}\n+extern \"stdcall\" fn extern_stdcall_fn_with_return_value(_: Box<isize>) -> usize {\n+    0\n+}\n \n-fn generic_function<T>(x: T) -> T { x }\n+fn generic_function<T>(x: T) -> T {\n+    x\n+}\n \n #[allow(improper_ctypes)]\n-extern {\n-    fn printf(_:*const u8, ...) -> isize;\n+extern \"C\" {\n+    fn printf(_: *const u8, ...) -> isize;\n }\n \n // In many of the cases below, the type that is actually under test is wrapped\n@@ -277,7 +282,6 @@ extern {\n // printed correctly, so the tests below just construct a tuple type that will\n // then *contain* the type name that we want to see.\n fn main() {\n-\n     // Structs\n     let simple_struct = Struct1;\n     let generic_struct1: GenericStruct<mod1::Struct2, mod1::mod2::Struct3> =\n@@ -336,11 +340,11 @@ fn main() {\n     let mut_ref_trait = (&mut mut_int1) as &mut Trait1;\n \n     let generic_box_trait = (box 0_isize) as Box<Trait2<i32, mod1::Struct2>>;\n-    let generic_ref_trait  = (&0_isize) as &Trait2<Struct1, Struct1>;\n+    let generic_ref_trait = (&0_isize) as &Trait2<Struct1, Struct1>;\n \n     let mut generic_mut_ref_trait_impl = 0_isize;\n-    let generic_mut_ref_trait = (&mut generic_mut_ref_trait_impl) as\n-        &mut Trait2<mod1::mod2::Struct3, GenericStruct<usize, isize>>;\n+    let generic_mut_ref_trait = (&mut generic_mut_ref_trait_impl)\n+        as &mut Trait2<mod1::mod2::Struct3, GenericStruct<usize, isize>>;\n \n     // Bare Functions\n     let rust_fn = (rust_fn, 0_usize);\n@@ -364,11 +368,13 @@ fn main() {\n     // how that maps to rustc's internal representation of these forms.\n     // Once closures have reached their 1.0 form, the tests below should\n     // probably be expanded.\n-    let closure1 = (|x:isize| {}, 0_usize);\n-    let closure2 = (|x:i8, y: f32| { (x as f32) + y }, 0_usize);\n+    let closure1 = (|x: isize| {}, 0_usize);\n+    let closure2 = (|x: i8, y: f32| (x as f32) + y, 0_usize);\n \n     zzz(); // #break\n }\n \n #[inline(never)]\n-fn zzz() { () }\n+fn zzz() {\n+    ()\n+}"}, {"sha": "f46f92eb500207d761b2a2f1f8a84775bd25bda1", "filename": "src/test/incremental/foreign.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fincremental%2Fforeign.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fincremental%2Fforeign.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fincremental%2Fforeign.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -13,7 +13,7 @@ use std::ffi::CString;\n mod mlibc {\n     use libc::{c_char, c_long, c_longlong};\n \n-    extern {\n+    extern \"C\" {\n         pub fn atol(x: *const c_char) -> c_long;\n         pub fn atoll(x: *const c_char) -> c_longlong;\n     }\n@@ -31,6 +31,8 @@ fn atoll(s: String) -> i64 {\n \n pub fn main() {\n     assert_eq!(atol(\"1024\".to_string()) * 10, atol(\"10240\".to_string()));\n-    assert_eq!((atoll(\"11111111111111111\".to_string()) * 10),\n-             atoll(\"111111111111111110\".to_string()));\n+    assert_eq!(\n+        (atoll(\"11111111111111111\".to_string()) * 10),\n+        atoll(\"111111111111111110\".to_string())\n+    );\n }"}, {"sha": "2e98abae58b3d356d5b634350dfda566919bd698", "filename": "src/test/incremental/hashes/inherent_impls.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fincremental%2Fhashes%2Finherent_impls.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fincremental%2Fhashes%2Finherent_impls.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fincremental%2Fhashes%2Finherent_impls.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -271,7 +271,7 @@ impl Foo {\n impl Foo {\n     #[rustc_clean(cfg=\"cfail2\", except=\"hir_owner,hir_owner_nodes,fn_sig,typeck\")]\n     #[rustc_clean(cfg=\"cfail3\")]\n-    pub extern fn make_method_extern(&self) { }\n+    pub extern \"C\" fn make_method_extern(&self) { }\n }\n \n "}, {"sha": "4dab032e47f353fba3eaeee1a659a0f2d91856af", "filename": "src/test/incremental/hashes/trait_defs.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fincremental%2Fhashes%2Ftrait_defs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fincremental%2Fhashes%2Ftrait_defs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fincremental%2Fhashes%2Ftrait_defs.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -312,7 +312,7 @@ trait TraitAddExternModifier {\n trait TraitAddExternModifier {\n     #[rustc_dirty(label=\"hir_owner\", cfg=\"cfail2\")]\n     #[rustc_clean(label=\"hir_owner\", cfg=\"cfail3\")]\n-    extern fn method();\n+    extern \"C\" fn method();\n }\n \n "}, {"sha": "0bf13c406ab53c7b7c9217a4c623bd1c3a1538a8", "filename": "src/test/run-make-fulldeps/archive-duplicate-names/foo.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Farchive-duplicate-names%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Farchive-duplicate-names%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Farchive-duplicate-names%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n #![crate_type = \"rlib\"]\n \n #[link(name = \"foo\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn foo();\n     fn bar();\n }"}, {"sha": "9f7a9e2213c0927a78b47a2a7edd7f44ffb2e917", "filename": "src/test/run-make-fulldeps/c-dynamic-dylib/foo.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fc-dynamic-dylib%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fc-dynamic-dylib%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fc-dynamic-dylib%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n #![crate_type = \"dylib\"]\n \n #[link(name = \"cfoo\")]\n-extern {\n+extern \"C\" {\n     fn foo();\n }\n "}, {"sha": "3dd376f1ff57beae396507485a4aa72527b08cf5", "filename": "src/test/run-make-fulldeps/c-dynamic-rlib/foo.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fc-dynamic-rlib%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fc-dynamic-rlib%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fc-dynamic-rlib%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n #![crate_type = \"rlib\"]\n \n #[link(name = \"cfoo\")]\n-extern {\n+extern \"C\" {\n     fn foo();\n }\n "}, {"sha": "1e8af4d44040b293cdef26346344bc960703329c", "filename": "src/test/run-make-fulldeps/c-static-dylib/foo.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fc-static-dylib%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fc-static-dylib%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fc-static-dylib%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n #![crate_type = \"dylib\"]\n \n #[link(name = \"cfoo\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn foo();\n }\n "}, {"sha": "9c6d2080ef4d37c990b060efd425bfed41eb13c9", "filename": "src/test/run-make-fulldeps/c-static-rlib/foo.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fc-static-rlib%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fc-static-rlib%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fc-static-rlib%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n #![crate_type = \"rlib\"]\n \n #[link(name = \"cfoo\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn foo();\n }\n "}, {"sha": "c4069495aaff1670d9084e004844024f095c56b4", "filename": "src/test/run-make-fulldeps/cdylib-dylib-linkage/foo.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fcdylib-dylib-linkage%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fcdylib-dylib-linkage%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fcdylib-dylib-linkage%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,11 +3,11 @@\n extern crate bar;\n \n #[no_mangle]\n-pub extern fn foo() {\n+pub extern \"C\" fn foo() {\n     bar::bar();\n }\n \n #[no_mangle]\n-pub extern fn bar(a: u32, b: u32) -> u32 {\n+pub extern \"C\" fn bar(a: u32, b: u32) -> u32 {\n     a + b\n }"}, {"sha": "af37bc8e9534d3cc5241224b6e07c80af86a4354", "filename": "src/test/run-make-fulldeps/cdylib-fewer-symbols/foo.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fcdylib-fewer-symbols%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fcdylib-fewer-symbols%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fcdylib-fewer-symbols%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n #![crate_type = \"cdylib\"]\n \n #[no_mangle]\n-pub extern fn foo() -> u32 {\n+pub extern \"C\" fn foo() -> u32 {\n     3\n }"}, {"sha": "c4069495aaff1670d9084e004844024f095c56b4", "filename": "src/test/run-make-fulldeps/cdylib/foo.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fcdylib%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fcdylib%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fcdylib%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,11 +3,11 @@\n extern crate bar;\n \n #[no_mangle]\n-pub extern fn foo() {\n+pub extern \"C\" fn foo() {\n     bar::bar();\n }\n \n #[no_mangle]\n-pub extern fn bar(a: u32, b: u32) -> u32 {\n+pub extern \"C\" fn bar(a: u32, b: u32) -> u32 {\n     a + b\n }"}, {"sha": "6cd9916b6f69d5c1a4d2d4b585f70aaf4a41a140", "filename": "src/test/run-make-fulldeps/compiler-lookup-paths/d.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fcompiler-lookup-paths%2Fd.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fcompiler-lookup-paths%2Fd.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fcompiler-lookup-paths%2Fd.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n #![crate_type = \"rlib\"]\n \n #[link(name = \"native\", kind = \"static\")]\n-extern {}\n+extern \"C\" {}"}, {"sha": "7fdb815887118bce354981132c94de3d3283d71a", "filename": "src/test/run-make-fulldeps/compiler-rt-works-on-mingw/foo.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fcompiler-rt-works-on-mingw%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fcompiler-rt-works-on-mingw%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fcompiler-rt-works-on-mingw%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,10 @@\n-extern { fn foo(); }\n+extern \"C\" {\n+    fn foo();\n+}\n \n pub fn main() {\n-    unsafe { foo(); }\n+    unsafe {\n+        foo();\n+    }\n     assert_eq!(7f32.powi(3), 343f32);\n }"}, {"sha": "34951dda3b6ec0236d96b401aba1d20850331ff9", "filename": "src/test/run-make-fulldeps/cross-lang-lto-upstream-rlibs/staticlib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fcross-lang-lto-upstream-rlibs%2Fstaticlib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fcross-lang-lto-upstream-rlibs%2Fstaticlib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fcross-lang-lto-upstream-rlibs%2Fstaticlib.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,6 +3,6 @@\n extern crate upstream;\n \n #[no_mangle]\n-pub extern fn bar() {\n+pub extern \"C\" fn bar() {\n     upstream::foo();\n }"}, {"sha": "c9baa489881b1b3a6d6e90571a162fa89233315b", "filename": "src/test/run-make-fulldeps/extern-fn-generic/test.rs", "status": "modified", "additions": 6, "deletions": 8, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-generic%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-generic%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-generic%2Ftest.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,22 +1,20 @@\n extern crate testcrate;\n \n-extern \"C\" fn bar<T>(ts: testcrate::TestStruct<T>) -> T { ts.y }\n+extern \"C\" fn bar<T>(ts: testcrate::TestStruct<T>) -> T {\n+    ts.y\n+}\n \n #[link(name = \"test\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn call(c: extern \"C\" fn(testcrate::TestStruct<i32>) -> i32) -> i32;\n }\n \n fn main() {\n     // Let's test calling it cross crate\n-    let back = unsafe {\n-        testcrate::call(testcrate::foo::<i32>)\n-    };\n+    let back = unsafe { testcrate::call(testcrate::foo::<i32>) };\n     assert_eq!(3, back);\n \n     // And just within this crate\n-    let back = unsafe {\n-        call(bar::<i32>)\n-    };\n+    let back = unsafe { call(bar::<i32>) };\n     assert_eq!(3, back);\n }"}, {"sha": "39f76e59ca0c0edcd42b6178f4759319437c7d4a", "filename": "src/test/run-make-fulldeps/extern-fn-generic/testcrate.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-generic%2Ftestcrate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-generic%2Ftestcrate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-generic%2Ftestcrate.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,12 +3,14 @@\n #[repr(C)]\n pub struct TestStruct<T> {\n     pub x: u8,\n-    pub y: T\n+    pub y: T,\n }\n \n-pub extern \"C\" fn foo<T>(ts: TestStruct<T>) -> T { ts.y }\n+pub extern \"C\" fn foo<T>(ts: TestStruct<T>) -> T {\n+    ts.y\n+}\n \n #[link(name = \"test\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn call(c: extern \"C\" fn(TestStruct<i32>) -> i32) -> i32;\n }"}, {"sha": "40b08f1ed709e348ebe73eb2c7602a68f79220e0", "filename": "src/test/run-make-fulldeps/extern-fn-mangle/test.rs", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-mangle%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-mangle%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-mangle%2Ftest.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,11 +1,15 @@\n #[no_mangle]\n-pub extern \"C\" fn foo() -> i32 { 3 }\n+pub extern \"C\" fn foo() -> i32 {\n+    3\n+}\n \n #[no_mangle]\n-pub extern \"C\" fn bar() -> i32 { 5 }\n+pub extern \"C\" fn bar() -> i32 {\n+    5\n+}\n \n #[link(name = \"test\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn add() -> i32;\n }\n "}, {"sha": "afe0f52ef0b288f432a0efda8fa4d31733c1c22e", "filename": "src/test/run-make-fulldeps/extern-fn-struct-passing-abi/test.rs", "status": "modified", "additions": 18, "deletions": 14, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-struct-passing-abi%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-struct-passing-abi%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-struct-passing-abi%2Ftest.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -7,23 +7,23 @@ struct Rect {\n     a: i32,\n     b: i32,\n     c: i32,\n-    d: i32\n+    d: i32,\n }\n \n #[derive(Clone, Copy, Debug, PartialEq)]\n #[repr(C)]\n struct BiggerRect {\n     s: Rect,\n     a: i32,\n-    b: i32\n+    b: i32,\n }\n \n #[derive(Clone, Copy, Debug, PartialEq)]\n #[repr(C)]\n struct FloatRect {\n     a: i32,\n     b: i32,\n-    c: f64\n+    c: f64,\n }\n \n #[derive(Clone, Copy, Debug, PartialEq)]\n@@ -33,14 +33,14 @@ struct Huge {\n     b: i32,\n     c: i32,\n     d: i32,\n-    e: i32\n+    e: i32,\n }\n \n #[derive(Clone, Copy, Debug, PartialEq)]\n #[repr(C)]\n struct FloatPoint {\n     x: f64,\n-    y: f64\n+    y: f64,\n }\n \n #[derive(Clone, Copy, Debug, PartialEq)]\n@@ -58,13 +58,22 @@ struct IntOdd {\n }\n \n #[link(name = \"test\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn byval_rect(a: i32, b: i32, c: i32, d: i32, e: i32, s: Rect);\n \n     fn byval_many_rect(a: i32, b: i32, c: i32, d: i32, e: i32, f: i32, s: Rect);\n \n-    fn byval_rect_floats(a: f32, b: f32, c: f64, d: f32, e: f32,\n-                         f: f32, g: f64, s: Rect, t: FloatRect);\n+    fn byval_rect_floats(\n+        a: f32,\n+        b: f32,\n+        c: f64,\n+        d: f32,\n+        e: f32,\n+        f: f32,\n+        g: f64,\n+        s: Rect,\n+        t: FloatRect,\n+    );\n \n     fn byval_rect_with_float(a: i32, b: i32, c: f32, d: i32, e: i32, f: i32, s: Rect);\n \n@@ -107,12 +116,7 @@ fn main() {\n         byval_many_rect(1, 2, 3, 4, 5, 6, s);\n         byval_rect_floats(1., 2., 3., 4., 5., 6., 7., s, u);\n         byval_rect_with_float(1, 2, 3.0, 4, 5, 6, s);\n-        byval_rect_with_many_huge(v, v, v, v, v, v, Rect {\n-            a: 123,\n-            b: 456,\n-            c: 789,\n-            d: 420\n-        });\n+        byval_rect_with_many_huge(v, v, v, v, v, v, Rect { a: 123, b: 456, c: 789, d: 420 });\n         split_rect(1, 2, s);\n         split_rect_floats(1., 2., u);\n         split_rect_with_floats(1, 2, 3.0, 4, 5.0, 6, s);"}, {"sha": "90a6ebaf1aa6caec96ffaaf15383561778ebcf9b", "filename": "src/test/run-make-fulldeps/extern-fn-with-extern-types/test.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-with-extern-types%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-with-extern-types%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-with-extern-types%2Ftest.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n #![feature(extern_types)]\n \n #[link(name = \"ctest\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     type data;\n \n     fn data_create(magic: u32) -> *mut data;"}, {"sha": "2f261efb5105d94248ff296ab42cf41b07d15f20", "filename": "src/test/run-make-fulldeps/extern-fn-with-packed-struct/test.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-with-packed-struct%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-with-packed-struct%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-with-packed-struct%2Ftest.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,11 +3,11 @@\n struct Foo {\n     a: i8,\n     b: i16,\n-    c: i8\n+    c: i8,\n }\n \n #[link(name = \"test\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn foo(f: Foo) -> Foo;\n }\n "}, {"sha": "438fbddf31fb287c7d96989c1afdcd7cf6f16a52", "filename": "src/test/run-make-fulldeps/extern-fn-with-union/test.rs", "status": "modified", "additions": 3, "deletions": 7, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-with-union%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-with-union%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-with-union%2Ftest.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,22 +2,18 @@ extern crate testcrate;\n \n use std::mem;\n \n-extern {\n+extern \"C\" {\n     fn give_back(tu: testcrate::TestUnion) -> u64;\n }\n \n fn main() {\n     let magic: u64 = 0xDEADBEEF;\n \n     // Let's test calling it cross crate\n-    let back = unsafe {\n-        testcrate::give_back(mem::transmute(magic))\n-    };\n+    let back = unsafe { testcrate::give_back(mem::transmute(magic)) };\n     assert_eq!(magic, back);\n \n     // And just within this crate\n-    let back = unsafe {\n-        give_back(mem::transmute(magic))\n-    };\n+    let back = unsafe { give_back(mem::transmute(magic)) };\n     assert_eq!(magic, back);\n }"}, {"sha": "28d91ff37c360fc4975b087749748ee363786b80", "filename": "src/test/run-make-fulldeps/extern-fn-with-union/testcrate.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-with-union%2Ftestcrate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-with-union%2Ftestcrate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fextern-fn-with-union%2Ftestcrate.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,10 +2,10 @@\n \n #[repr(C)]\n pub struct TestUnion {\n-    _val: u64\n+    _val: u64,\n }\n \n #[link(name = \"ctest\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn give_back(tu: TestUnion) -> u64;\n }"}, {"sha": "5ab627a2ac1a282531a92a42cdacce95b489f6bd", "filename": "src/test/run-make-fulldeps/glibc-staticlib-args/library.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fglibc-staticlib-args%2Flibrary.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fglibc-staticlib-args%2Flibrary.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fglibc-staticlib-args%2Flibrary.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n #[no_mangle]\n-pub extern fn args_check() {\n+pub extern \"C\" fn args_check() {\n     assert_ne!(std::env::args_os().count(), 0);\n }"}, {"sha": "3c2c3f218149480293e1f27a9028c052b2157c80", "filename": "src/test/run-make-fulldeps/interdependent-c-libraries/bar.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Finterdependent-c-libraries%2Fbar.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Finterdependent-c-libraries%2Fbar.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Finterdependent-c-libraries%2Fbar.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,10 +3,12 @@\n extern crate foo;\n \n #[link(name = \"bar\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn bar();\n }\n \n pub fn doit() {\n-    unsafe { bar(); }\n+    unsafe {\n+        bar();\n+    }\n }"}, {"sha": "a69809726c693b689216d6a3b8ed703a336a21f2", "filename": "src/test/run-make-fulldeps/interdependent-c-libraries/foo.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Finterdependent-c-libraries%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Finterdependent-c-libraries%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Finterdependent-c-libraries%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,10 +1,12 @@\n #![crate_type = \"rlib\"]\n \n #[link(name = \"foo\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn foo();\n }\n \n pub fn doit() {\n-    unsafe { foo(); }\n+    unsafe {\n+        foo();\n+    }\n }"}, {"sha": "7c19c1f2c678a632c43cd1db85bca5b8e2b38cca", "filename": "src/test/run-make-fulldeps/issue-14500/foo.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fissue-14500%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fissue-14500%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fissue-14500%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n #[no_mangle]\n-pub extern fn foo() {}\n+pub extern \"C\" fn foo() {}\n \n #[no_mangle]\n pub static FOO_STATIC: u8 = 0;"}, {"sha": "b4eaa0b31c5be9bc67602cfeb1e60c2e09f4e71d", "filename": "src/test/run-make-fulldeps/issue-15460/foo.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fissue-15460%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fissue-15460%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fissue-15460%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n #![crate_type = \"dylib\"]\n \n #[link(name = \"foo\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn foo();\n }"}, {"sha": "ba6749c9722241dd4a89b19de8db4b010006df7f", "filename": "src/test/run-make-fulldeps/issue-25581/test.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fissue-25581%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fissue-25581%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fissue-25581%2Ftest.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,11 +1,11 @@\n #[link(name = \"test\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn slice_len(s: &[u8]) -> usize;\n     fn slice_elem(s: &[u8], idx: usize) -> u8;\n }\n \n fn main() {\n-    let data = [1,2,3,4,5];\n+    let data = [1, 2, 3, 4, 5];\n \n     unsafe {\n         assert_eq!(data.len(), slice_len(&data) as usize);"}, {"sha": "07863cf64d6e9de0766f1816b22ddf9028b9b6a5", "filename": "src/test/run-make-fulldeps/issue-28595/a.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fissue-28595%2Fa.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fissue-28595%2Fa.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fissue-28595%2Fa.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n #![crate_type = \"rlib\"]\n \n #[link(name = \"a\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn a();\n }"}, {"sha": "1f389859fad73414695390b5b61fd999a0b43c11", "filename": "src/test/run-make-fulldeps/issue-28595/b.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fissue-28595%2Fb.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fissue-28595%2Fb.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fissue-28595%2Fb.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,11 +1,12 @@\n extern crate a;\n \n #[link(name = \"b\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn b();\n }\n \n-\n fn main() {\n-    unsafe { b(); }\n+    unsafe {\n+        b();\n+    }\n }"}, {"sha": "5ad66475d003ff3aab72a63392daf5d8e84fb81a", "filename": "src/test/run-make-fulldeps/link-cfg/dep-with-staticlib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flink-cfg%2Fdep-with-staticlib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flink-cfg%2Fdep-with-staticlib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Flink-cfg%2Fdep-with-staticlib.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,6 +3,6 @@\n \n #[link(name = \"return1\", cfg(foo))]\n #[link(name = \"return3\", kind = \"static\", cfg(bar))]\n-extern {\n+extern \"C\" {\n     pub fn my_function() -> i32;\n }"}, {"sha": "40de77f05b3f67ba8f6ba43e210a4b0e3ac463fa", "filename": "src/test/run-make-fulldeps/link-cfg/dep.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flink-cfg%2Fdep.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flink-cfg%2Fdep.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Flink-cfg%2Fdep.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,6 +3,6 @@\n \n #[link(name = \"return1\", cfg(foo))]\n #[link(name = \"return2\", cfg(bar))]\n-extern {\n+extern \"C\" {\n     pub fn my_function() -> i32;\n }"}, {"sha": "ba5a8711a2610aa10fbb0681f813fa653d5a2f30", "filename": "src/test/run-make-fulldeps/link-cfg/no-deps.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flink-cfg%2Fno-deps.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flink-cfg%2Fno-deps.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Flink-cfg%2Fno-deps.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,7 +2,7 @@\n \n #[link(name = \"return1\", cfg(foo))]\n #[link(name = \"return2\", cfg(bar))]\n-extern {\n+extern \"C\" {\n     fn my_function() -> i32;\n }\n "}, {"sha": "8024e343d19a74fdad927c1d898958a92505bf46", "filename": "src/test/run-make-fulldeps/link-path-order/main.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flink-path-order%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flink-path-order%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Flink-path-order%2Fmain.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,15 +2,13 @@\n \n extern crate libc;\n \n-#[link(name=\"foo\", kind = \"static\")]\n-extern {\n+#[link(name = \"foo\", kind = \"static\")]\n+extern \"C\" {\n     fn should_return_one() -> libc::c_int;\n }\n \n fn main() {\n-    let result = unsafe {\n-        should_return_one()\n-    };\n+    let result = unsafe { should_return_one() };\n \n     if result != 1 {\n         std::process::exit(255);"}, {"sha": "68607cbb6572108b0e5013533ada08ebc0c4cd92", "filename": "src/test/run-make-fulldeps/linkage-attr-on-static/bar.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flinkage-attr-on-static%2Fbar.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flinkage-attr-on-static%2Fbar.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Flinkage-attr-on-static%2Fbar.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,7 +5,7 @@\n static BAZ: i32 = 21;\n \n #[link(name = \"foo\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn what() -> i32;\n }\n "}, {"sha": "db238c0cf1a92627b8a574a6e87e66144ec1a976", "filename": "src/test/run-make-fulldeps/long-linker-command-lines/foo.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flong-linker-command-lines%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flong-linker-command-lines%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Flong-linker-command-lines%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -25,7 +25,7 @@ fn write_test_case(file: &Path, n: usize) -> HashSet<String> {\n         writeln!(f, \"#[link(name = \\\"S{}{}S\\\")]\", prefix, i).unwrap();\n         libs.insert(format!(\"{}{}\", prefix, i));\n     }\n-    writeln!(f, \"extern {{}}\\nfn main() {{}}\").unwrap();\n+    writeln!(f, \"extern \\\"C\\\" {{}}\\nfn main() {{}}\").unwrap();\n     f.into_inner().unwrap();\n \n     libs"}, {"sha": "cc1d5b126dd35c229fa0268e6df5a9da8b1fc238", "filename": "src/test/run-make-fulldeps/longjmp-across-rust/main.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flongjmp-across-rust%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flongjmp-across-rust%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Flongjmp-across-rust%2Fmain.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n #[link(name = \"foo\", kind = \"static\")]\n-extern {\n-    fn test_start(f: extern fn());\n+extern \"C\" {\n+    fn test_start(f: extern \"C\" fn());\n     fn test_end();\n }\n \n@@ -13,11 +13,10 @@ fn main() {\n struct A;\n \n impl Drop for A {\n-    fn drop(&mut self) {\n-    }\n+    fn drop(&mut self) {}\n }\n \n-extern fn test_middle() {\n+extern \"C\" fn test_middle() {\n     let _a = A;\n     foo();\n }"}, {"sha": "f70bb338223e0b96b4d1c086b4f89e75e5468172", "filename": "src/test/run-make-fulldeps/lto-no-link-whole-rlib/lib1.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flto-no-link-whole-rlib%2Flib1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flto-no-link-whole-rlib%2Flib1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Flto-no-link-whole-rlib%2Flib1.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n #![crate_type = \"rlib\"]\n \n #[link(name = \"foo\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn foo() -> i32;\n }\n "}, {"sha": "2dec2a2718e83a197c6656c1aed89f752ee1dfe3", "filename": "src/test/run-make-fulldeps/lto-no-link-whole-rlib/lib2.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flto-no-link-whole-rlib%2Flib2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Flto-no-link-whole-rlib%2Flib2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Flto-no-link-whole-rlib%2Flib2.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,7 +3,7 @@\n extern crate lib1;\n \n #[link(name = \"bar\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn foo() -> i32;\n }\n "}, {"sha": "c1f28236ffd2ba8ad7fefd61c31f154a6ebcdd2f", "filename": "src/test/run-make-fulldeps/manual-link/foo.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fmanual-link%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fmanual-link%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fmanual-link%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,9 +1,11 @@\n #![crate_type = \"rlib\"]\n \n-extern {\n+extern \"C\" {\n     fn bar();\n }\n \n pub fn foo() {\n-    unsafe { bar(); }\n+    unsafe {\n+        bar();\n+    }\n }"}, {"sha": "b25ef35ada68ebe68e65dc191751f5c0f62fb274", "filename": "src/test/run-make-fulldeps/no-duplicate-libs/main.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fno-duplicate-libs%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fno-duplicate-libs%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fno-duplicate-libs%2Fmain.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n #[link(name = \"foo\")] // linker should drop this library, no symbols used\n #[link(name = \"bar\")] // symbol comes from this library\n #[link(name = \"foo\")] // now linker picks up `foo` b/c `bar` library needs it\n-extern {\n+extern \"C\" {\n     fn bar();\n }\n "}, {"sha": "f2a52cb5ca1c50faff3b60499fe6a46f2c3ddeb6", "filename": "src/test/run-make-fulldeps/sanitizer-cdylib-link/library.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-cdylib-link%2Flibrary.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-cdylib-link%2Flibrary.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-cdylib-link%2Flibrary.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n #[no_mangle]\n-pub extern fn overflow() {\n+pub extern \"C\" fn overflow() {\n     let xs = [0, 1, 2, 3];\n     let _y = unsafe { *xs.as_ptr().offset(4) };\n }"}, {"sha": "ef053aa2e7a3ad21312463430b37c4532cd95475", "filename": "src/test/run-make-fulldeps/sanitizer-cdylib-link/program.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-cdylib-link%2Fprogram.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-cdylib-link%2Fprogram.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-cdylib-link%2Fprogram.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-extern {\n+extern \"C\" {\n     fn overflow();\n }\n "}, {"sha": "f2a52cb5ca1c50faff3b60499fe6a46f2c3ddeb6", "filename": "src/test/run-make-fulldeps/sanitizer-dylib-link/library.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-dylib-link%2Flibrary.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-dylib-link%2Flibrary.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-dylib-link%2Flibrary.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n #[no_mangle]\n-pub extern fn overflow() {\n+pub extern \"C\" fn overflow() {\n     let xs = [0, 1, 2, 3];\n     let _y = unsafe { *xs.as_ptr().offset(4) };\n }"}, {"sha": "ef053aa2e7a3ad21312463430b37c4532cd95475", "filename": "src/test/run-make-fulldeps/sanitizer-dylib-link/program.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-dylib-link%2Fprogram.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-dylib-link%2Fprogram.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-dylib-link%2Fprogram.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-extern {\n+extern \"C\" {\n     fn overflow();\n }\n "}, {"sha": "f2a52cb5ca1c50faff3b60499fe6a46f2c3ddeb6", "filename": "src/test/run-make-fulldeps/sanitizer-staticlib-link/library.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-staticlib-link%2Flibrary.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-staticlib-link%2Flibrary.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-staticlib-link%2Flibrary.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n #[no_mangle]\n-pub extern fn overflow() {\n+pub extern \"C\" fn overflow() {\n     let xs = [0, 1, 2, 3];\n     let _y = unsafe { *xs.as_ptr().offset(4) };\n }"}, {"sha": "ec59bdb11c889eb86412857b1d10be205cde6adc", "filename": "src/test/run-make-fulldeps/sanitizer-staticlib-link/program.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-staticlib-link%2Fprogram.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-staticlib-link%2Fprogram.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-staticlib-link%2Fprogram.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n #[link(name = \"library\")]\n-extern {\n+extern \"C\" {\n     fn overflow();\n }\n "}, {"sha": "94879c2a6ed663ea3753b35209e93fd9462726cd", "filename": "src/test/run-make-fulldeps/save-analysis-fail/foo.rs", "status": "modified", "additions": 59, "deletions": 53, "changes": 112, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fsave-analysis-fail%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fsave-analysis-fail%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fsave-analysis-fail%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-#![ crate_name = \"test\" ]\n+#![crate_name = \"test\"]\n #![feature(box_syntax)]\n #![feature(rustc_private)]\n \n@@ -9,11 +9,10 @@ extern crate krate2;\n extern crate krate2 as krate3;\n \n use rustc_graphviz::RenderOption;\n-use std::collections::{HashMap,HashSet};\n use std::cell::RefCell;\n+use std::collections::{HashMap, HashSet};\n use std::io::Write;\n \n-\n use sub::sub2 as msalias;\n use sub::sub2;\n use sub::sub2::nested_struct as sub_struct;\n@@ -30,7 +29,7 @@ static bob: Option<graphviz::RenderOption> = None;\n // buglink test - see issue #1337.\n \n fn test_alias<I: Iterator>(i: Option<<I as Iterator>::Item>) {\n-    let s = sub_struct{ field2: 45u32, };\n+    let s = sub_struct { field2: 45u32 };\n \n     // import tests\n     fn foo(x: &Write) {}\n@@ -80,7 +79,7 @@ mod sub {\n \n         pub enum nested_enum {\n             Nest2 = 2,\n-            Nest3 = 3\n+            Nest3 = 3,\n         }\n     }\n }\n@@ -101,7 +100,9 @@ struct some_fields {\n type SF = some_fields;\n \n trait SuperTrait {\n-    fn qux(&self) { panic!(); }\n+    fn qux(&self) {\n+        panic!();\n+    }\n }\n \n trait SomeTrait: SuperTrait {\n@@ -136,8 +137,7 @@ impl SomeTrait for some_fields {\n     }\n }\n \n-impl SuperTrait for some_fields {\n-}\n+impl SuperTrait for some_fields {}\n \n impl SubTrait for some_fields {}\n \n@@ -150,17 +150,14 @@ impl some_fields {\n         42\n     }\n \n-    fn align_to<T>(&mut self) {\n-\n-    }\n+    fn align_to<T>(&mut self) {}\n \n     fn test(&mut self) {\n         self.align_to::<bool>();\n     }\n }\n \n-impl SuperTrait for nofields {\n-}\n+impl SuperTrait for nofields {}\n impl SomeTrait for nofields {\n     fn Method(&self, x: u32) -> u32 {\n         self.Method(x);\n@@ -186,59 +183,70 @@ enum SomeEnum<'a> {\n     Ints(isize, isize),\n     Floats(f64, f64),\n     Strings(&'a str, &'a str, &'a str),\n-    MyTypes(MyType, MyType)\n+    MyTypes(MyType, MyType),\n }\n \n #[derive(Copy, Clone)]\n enum SomeOtherEnum {\n     SomeConst1,\n     SomeConst2,\n-    SomeConst3\n+    SomeConst3,\n }\n \n enum SomeStructEnum {\n-    EnumStruct{a:isize, b:isize},\n-    EnumStruct2{f1:MyType, f2:MyType},\n-    EnumStruct3{f1:MyType, f2:MyType, f3:SomeEnum<'static>}\n+    EnumStruct { a: isize, b: isize },\n+    EnumStruct2 { f1: MyType, f2: MyType },\n+    EnumStruct3 { f1: MyType, f2: MyType, f3: SomeEnum<'static> },\n }\n \n fn matchSomeEnum(val: SomeEnum) {\n     match val {\n-        SomeEnum::Ints(int1, int2) => { println(&(int1+int2).to_string()); }\n-        SomeEnum::Floats(float1, float2) => { println(&(float2*float1).to_string()); }\n-        SomeEnum::Strings(.., s3) => { println(s3); }\n-        SomeEnum::MyTypes(mt1, mt2) => { println(&(mt1.field1 - mt2.field1).to_string()); }\n+        SomeEnum::Ints(int1, int2) => {\n+            println(&(int1 + int2).to_string());\n+        }\n+        SomeEnum::Floats(float1, float2) => {\n+            println(&(float2 * float1).to_string());\n+        }\n+        SomeEnum::Strings(.., s3) => {\n+            println(s3);\n+        }\n+        SomeEnum::MyTypes(mt1, mt2) => {\n+            println(&(mt1.field1 - mt2.field1).to_string());\n+        }\n     }\n }\n \n fn matchSomeStructEnum(se: SomeStructEnum) {\n     match se {\n-        SomeStructEnum::EnumStruct{a:a, ..} => println(&a.to_string()),\n-        SomeStructEnum::EnumStruct2{f1:f1, f2:f_2} => println(&f_2.field1.to_string()),\n-        SomeStructEnum::EnumStruct3{f1, ..} => println(&f1.field1.to_string()),\n+        SomeStructEnum::EnumStruct { a: a, .. } => println(&a.to_string()),\n+        SomeStructEnum::EnumStruct2 { f1: f1, f2: f_2 } => println(&f_2.field1.to_string()),\n+        SomeStructEnum::EnumStruct3 { f1, .. } => println(&f1.field1.to_string()),\n     }\n }\n \n-\n fn matchSomeStructEnum2(se: SomeStructEnum) {\n     use SomeStructEnum::*;\n     match se {\n-        EnumStruct{a: ref aaa, ..} => println(&aaa.to_string()),\n-        EnumStruct2{f1, f2: f2} => println(&f1.field1.to_string()),\n-        EnumStruct3{f1, f3: SomeEnum::Ints(..), f2} => println(&f1.field1.to_string()),\n-        _ => {},\n+        EnumStruct { a: ref aaa, .. } => println(&aaa.to_string()),\n+        EnumStruct2 { f1, f2: f2 } => println(&f1.field1.to_string()),\n+        EnumStruct3 { f1, f3: SomeEnum::Ints(..), f2 } => println(&f1.field1.to_string()),\n+        _ => {}\n     }\n }\n \n fn matchSomeOtherEnum(val: SomeOtherEnum) {\n     use SomeOtherEnum::{SomeConst2, SomeConst3};\n     match val {\n-        SomeOtherEnum::SomeConst1 => { println(\"I'm const1.\"); }\n-        SomeConst2 | SomeConst3 => { println(\"I'm const2 or const3.\"); }\n+        SomeOtherEnum::SomeConst1 => {\n+            println(\"I'm const1.\");\n+        }\n+        SomeConst2 | SomeConst3 => {\n+            println(\"I'm const2 or const3.\");\n+        }\n     }\n }\n \n-fn hello<X: SomeTrait>((z, a) : (u32, String), ex: X) {\n+fn hello<X: SomeTrait>((z, a): (u32, String), ex: X) {\n     SameDir2::hello(43);\n \n     println(&yy.to_string());\n@@ -253,8 +261,8 @@ fn hello<X: SomeTrait>((z, a) : (u32, String), ex: X) {\n     let x = 32.0f32;\n     let _ = (x + ((x * x) + 1.0).sqrt()).ln();\n \n-    let s: Box<SomeTrait> = box some_fields {field1: 43};\n-    let s2: Box<some_fields> =  box some_fields {field1: 43};\n+    let s: Box<SomeTrait> = box some_fields { field1: 43 };\n+    let s2: Box<some_fields> = box some_fields { field1: 43 };\n     let s3 = box nofields;\n \n     s.Method(43);\n@@ -307,8 +315,9 @@ mod macro_use_test {\n     }\n }\n \n-fn main() { // foo\n-    let s = box some_fields {field1: 43};\n+fn main() {\n+    // foo\n+    let s = box some_fields { field1: 43 };\n     hello((43, \"a\".to_string()), *s);\n     sub::sub2::hello();\n     sub2::sub3::hello();\n@@ -329,26 +338,24 @@ fn main() { // foo\n     let vs = variable_str!(32);\n \n     let mut candidates: RefCell<HashMap<&'static str, &'static str>> = RefCell::new(HashMap::new());\n-    let _ = blah {\n-        used_link_args: RefCell::new([]),\n-    };\n+    let _ = blah { used_link_args: RefCell::new([]) };\n     let s1 = nofields;\n-    let s2 = SF { field1: 55};\n-    let s3: some_fields = some_fields{ field1: 55};\n-    let s4: msalias::nested_struct = sub::sub2::nested_struct{ field2: 55};\n-    let s4: msalias::nested_struct = sub2::nested_struct{ field2: 55};\n+    let s2 = SF { field1: 55 };\n+    let s3: some_fields = some_fields { field1: 55 };\n+    let s4: msalias::nested_struct = sub::sub2::nested_struct { field2: 55 };\n+    let s4: msalias::nested_struct = sub2::nested_struct { field2: 55 };\n     println(&s2.field1.to_string());\n-    let s5: MyType = box some_fields{ field1: 55};\n-    let s = SameDir::SameStruct{name: \"Bob\".to_string()};\n-    let s = SubDir::SubStruct{name:\"Bob\".to_string()};\n+    let s5: MyType = box some_fields { field1: 55 };\n+    let s = SameDir::SameStruct { name: \"Bob\".to_string() };\n+    let s = SubDir::SubStruct { name: \"Bob\".to_string() };\n     let s6: SomeEnum = SomeEnum::MyTypes(box s2.clone(), s5);\n     let s7: SomeEnum = SomeEnum::Strings(\"one\", \"two\", \"three\");\n     matchSomeEnum(s6);\n     matchSomeEnum(s7);\n     let s8: SomeOtherEnum = SomeOtherEnum::SomeConst2;\n     matchSomeOtherEnum(s8);\n-    let s9: SomeStructEnum = SomeStructEnum::EnumStruct2{ f1: box some_fields{ field1:10 },\n-                                                          f2: box s2 };\n+    let s9: SomeStructEnum =\n+        SomeStructEnum::EnumStruct2 { f1: box some_fields { field1: 10 }, f2: box s2 };\n     matchSomeStructEnum(s9);\n \n     for x in &vec![1, 2, 3] {\n@@ -409,8 +416,7 @@ impl<'a> Pattern<'a> for CharEqPattern {\n \n struct CharSearcher<'a>(<CharEqPattern as Pattern<'a>>::Searcher);\n \n-pub trait Error {\n-}\n+pub trait Error {}\n \n impl Error + 'static {\n     pub fn is<T: Error + 'static>(&self) -> bool {\n@@ -437,13 +443,13 @@ fn test_format_args() {\n     print!(\"x is {}, y is {1}, name is {n}\", x, y, n = name);\n }\n \n-extern {\n+extern \"C\" {\n     static EXTERN_FOO: u8;\n     fn extern_foo(a: u8, b: i32) -> String;\n }\n \n struct Rls699 {\n-  f: u32,\n+    f: u32,\n }\n \n fn new(f: u32) -> Rls699 {"}, {"sha": "14421165e2da1367b46f3909a606c80239be27c2", "filename": "src/test/run-make-fulldeps/static-dylib-by-default/bar.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fstatic-dylib-by-default%2Fbar.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fstatic-dylib-by-default%2Fbar.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fstatic-dylib-by-default%2Fbar.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,6 +3,6 @@\n extern crate foo;\n \n #[no_mangle]\n-pub extern fn bar() {\n+pub extern \"C\" fn bar() {\n     foo::foo();\n }"}, {"sha": "69d1668d4f643b901d11fcec0e7aa09c7806fe18", "filename": "src/test/run-make-fulldeps/static-nobundle/bbb.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fstatic-nobundle%2Fbbb.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fstatic-nobundle%2Fbbb.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fstatic-nobundle%2Fbbb.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,7 +2,7 @@\n #![feature(static_nobundle)]\n \n #[link(name = \"aaa\", kind = \"static-nobundle\")]\n-extern {\n+extern \"C\" {\n     pub fn native_func();\n }\n "}, {"sha": "bf48d069da9565dfd86d8505eb5a6fe6a3e67679", "filename": "src/test/run-make-fulldeps/staticlib-blank-lib/foo.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fstaticlib-blank-lib%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fstaticlib-blank-lib%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fstaticlib-blank-lib%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n #![crate_type = \"staticlib\"]\n \n #[link(name = \"foo\", kind = \"static\")]\n-extern {}\n+extern \"C\" {}\n \n fn main() {}"}, {"sha": "6aa6e1ac3c50599a528579ff4a9e04e59674ea71", "filename": "src/test/run-make-fulldeps/std-core-cycle/foo.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fstd-core-cycle%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Fstd-core-cycle%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fstd-core-cycle%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -6,6 +6,6 @@ extern crate bar;\n static A: bar::A = bar::A;\n \n #[no_mangle]\n-pub extern fn a(a: u32, b: u32) -> u32 {\n+pub extern \"C\" fn a(a: u32, b: u32) -> u32 {\n     a / b\n }"}, {"sha": "9ff33e24d04d79a56480f2824d4d93e66bb58148", "filename": "src/test/run-make-fulldeps/target-specs/foo.rs", "status": "modified", "additions": 9, "deletions": 7, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Ftarget-specs%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make-fulldeps%2Ftarget-specs%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Ftarget-specs%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,19 +1,21 @@\n #![feature(lang_items, no_core, auto_traits)]\n #![no_core]\n \n-#[lang=\"copy\"]\n-trait Copy { }\n+#[lang = \"copy\"]\n+trait Copy {}\n \n-#[lang=\"sized\"]\n-trait Sized { }\n+#[lang = \"sized\"]\n+trait Sized {}\n \n #[lang = \"freeze\"]\n auto trait Freeze {}\n \n-#[lang=\"start\"]\n-fn start(_main: *const u8, _argc: isize, _argv: *const *const u8) -> isize { 0 }\n+#[lang = \"start\"]\n+fn start(_main: *const u8, _argc: isize, _argv: *const *const u8) -> isize {\n+    0\n+}\n \n-extern {\n+extern \"C\" {\n     fn _foo() -> [u8; 16];\n }\n "}, {"sha": "845844f427bdf1177edb4ceebaf7746126b2cc6d", "filename": "src/test/run-make/issue-36710/foo.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make%2Fissue-36710%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make%2Fissue-36710%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fissue-36710%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,7 +3,9 @@\n // For linking libstdc++ on MinGW\n #![cfg_attr(all(windows, target_env = \"gnu\"), feature(static_nobundle))]\n \n-extern { fn get() -> u32; }\n+extern \"C\" {\n+    fn get() -> u32;\n+}\n \n fn main() {\n     let i = unsafe { get() };"}, {"sha": "1b988c78321d94af4c9a4c51fa96978279a91041", "filename": "src/test/run-make/wasm-import-module/bar.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make%2Fwasm-import-module%2Fbar.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make%2Fwasm-import-module%2Fbar.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fwasm-import-module%2Fbar.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -4,13 +4,13 @@\n extern crate foo;\n \n #[link(wasm_import_module = \"./me\")]\n-extern {\n+extern \"C\" {\n     #[link_name = \"me_in_dep\"]\n     fn dep();\n }\n \n #[no_mangle]\n-pub extern fn foo() {\n+pub extern \"C\" fn foo() {\n     unsafe {\n         foo::dep();\n         dep();"}, {"sha": "bbeaf99bc778ffcf1baa8fe57b4080e96ee6d901", "filename": "src/test/run-make/wasm-import-module/foo.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make%2Fwasm-import-module%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-make%2Fwasm-import-module%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fwasm-import-module%2Ffoo.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,6 +2,6 @@\n #![deny(warnings)]\n \n #[link(wasm_import_module = \"./dep\")]\n-extern {\n+extern \"C\" {\n     pub fn dep();\n }"}, {"sha": "571621c1de776d3a83576b185e023636076c3d5c", "filename": "src/test/run-pass-valgrind/osx-frameworks.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-pass-valgrind%2Fosx-frameworks.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frun-pass-valgrind%2Fosx-frameworks.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-valgrind%2Fosx-frameworks.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -6,13 +6,15 @@ extern crate libc;\n \n #[cfg(target_os = \"macos\")]\n #[link(name = \"CoreFoundation\", kind = \"framework\")]\n-extern {\n+extern \"C\" {\n     fn CFRunLoopGetTypeID() -> libc::c_ulong;\n }\n \n #[cfg(target_os = \"macos\")]\n pub fn main() {\n-    unsafe { CFRunLoopGetTypeID(); }\n+    unsafe {\n+        CFRunLoopGetTypeID();\n+    }\n }\n \n #[cfg(not(target_os = \"macos\"))]"}, {"sha": "6de1960e2e2b6376d02b46e5e065edc342f4c259", "filename": "src/test/rustdoc-ui/check-doc-alias-attr-location.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc-ui%2Fcheck-doc-alias-attr-location.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc-ui%2Fcheck-doc-alias-attr-location.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcheck-doc-alias-attr-location.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,7 +5,7 @@ pub trait Foo {\n }\n \n #[doc(alias = \"foo\")] //~ ERROR\n-extern {}\n+extern \"C\" {}\n \n #[doc(alias = \"bar\")] //~ ERROR\n impl Bar {\n@@ -17,5 +17,7 @@ impl Bar {\n impl Foo for Bar {\n     #[doc(alias = \"assoc\")] //~ ERROR\n     type X = i32;\n-    fn foo() -> Self::X { 0 }\n+    fn foo() -> Self::X {\n+        0\n+    }\n }"}, {"sha": "6c26b751c5e05725967442c5f3e728ee2a921b54", "filename": "src/test/rustdoc-ui/coverage/basic.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fbasic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fbasic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fbasic.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -45,6 +45,6 @@ macro_rules! some_macro {\n     () => {};\n }\n \n-extern {\n+extern \"C\" {\n     pub type ExternType;\n }"}, {"sha": "c46660579a836cb01638f3ee2d0d0046725a83a9", "filename": "src/test/rustdoc/auxiliary/issue-34274.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Fauxiliary%2Fissue-34274.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Fauxiliary%2Fissue-34274.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fauxiliary%2Fissue-34274.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,3 +1,3 @@\n-extern {\n+extern \"C\" {\n     pub fn extern_c_fn();\n }"}, {"sha": "1dec0ef3e0f71aaecc5a3ea5a208add13ebf2735", "filename": "src/test/rustdoc/foreigntype-reexport.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Fforeigntype-reexport.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Fforeigntype-reexport.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fforeigntype-reexport.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n #![feature(extern_types)]\n \n mod sub {\n-    extern {\n+    extern \"C\" {\n         /// Another extern type.\n         pub type C2;\n         pub fn f2();\n@@ -10,7 +10,7 @@ mod sub {\n }\n \n pub mod sub2 {\n-    extern {\n+    extern \"C\" {\n         // @has foreigntype_reexport/sub2/foreigntype.C.html\n         pub type C;\n         // @has foreigntype_reexport/sub2/fn.f.html\n@@ -21,7 +21,7 @@ pub mod sub2 {\n }\n \n mod sub3 {\n-    extern {\n+    extern \"C\" {\n         pub type C4;\n         pub fn f4();\n         pub static K4: usize;\n@@ -35,15 +35,15 @@ mod sub3 {\n // @has foreigntype_reexport/index.html '//a[@class=\"foreigntype\"]' 'C2'\n // @has foreigntype_reexport/index.html '//a[@class=\"fn\"]' 'f2'\n // @has foreigntype_reexport/index.html '//a[@class=\"static\"]' 'K2'\n-pub use self::sub::{C2, f2, K as K2};\n+pub use self::sub::{f2, C2, K as K2};\n \n // @has foreigntype_reexport/index.html '//a[@class=\"foreigntype\"]' 'C'\n // @has foreigntype_reexport/index.html '//a[@class=\"fn\"]' 'f'\n // @has foreigntype_reexport/index.html '//a[@class=\"static\"]' 'K3'\n // @has foreigntype_reexport/index.html '//code' 'pub use self::sub2::C as C3;'\n // @has foreigntype_reexport/index.html '//code' 'pub use self::sub2::f as f3;'\n // @has foreigntype_reexport/index.html '//code' 'pub use self::sub2::K3;'\n-pub use self::sub2::{C as C3, f as f3, K3};\n+pub use self::sub2::{f as f3, C as C3, K3};\n \n // @has foreigntype_reexport/foreigntype.C4.html\n // @has foreigntype_reexport/fn.f4.html"}, {"sha": "891cdd5fed76c9bf49835a284a78f65154de4981", "filename": "src/test/rustdoc/foreigntype.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Fforeigntype.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Fforeigntype.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fforeigntype.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n #![feature(extern_types)]\n \n-extern {\n+extern \"C\" {\n     // @has foreigntype/foreigntype.ExtType.html\n     pub type ExtType;\n }"}, {"sha": "55c75dfe27b7e613e62947be61b8e6fbef48e080", "filename": "src/test/rustdoc/inline_local/glob-extern-no-defaults.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Finline_local%2Fglob-extern-no-defaults.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Finline_local%2Fglob-extern-no-defaults.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Finline_local%2Fglob-extern-no-defaults.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,7 +3,7 @@\n #![crate_name = \"foo\"]\n \n mod mod1 {\n-    extern {\n+    extern \"C\" {\n         pub fn public_fn();\n         fn private_fn();\n     }"}, {"sha": "686e55de39264e87ded18749ec45291eec0f27b2", "filename": "src/test/rustdoc/inline_local/glob-extern.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Finline_local%2Fglob-extern.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Finline_local%2Fglob-extern.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Finline_local%2Fglob-extern.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n #![crate_name = \"foo\"]\n \n mod mod1 {\n-    extern {\n+    extern \"C\" {\n         pub fn public_fn();\n         fn private_fn();\n     }"}, {"sha": "ff5813dac8099613997ec87ded88393e0f2473d8", "filename": "src/test/rustdoc/issue-22038.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Fissue-22038.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Fissue-22038.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fissue-22038.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-extern {\n+extern \"C\" {\n     // @has issue_22038/fn.foo1.html \\\n     //      '//*[@class=\"rust fn\"]' 'pub unsafe extern \"C\" fn foo1()'\n     pub fn foo1();\n@@ -12,7 +12,7 @@ extern \"system\" {\n \n // @has issue_22038/fn.bar.html \\\n //      '//*[@class=\"rust fn\"]' 'pub extern \"C\" fn bar()'\n-pub extern fn bar() {}\n+pub extern \"C\" fn bar() {}\n \n // @has issue_22038/fn.baz.html \\\n //      '//*[@class=\"rust fn\"]' 'pub extern \"system\" fn baz()'"}, {"sha": "1abba468febf59f19760f3d8ac0067718cea3fbd", "filename": "src/test/rustdoc/sanitizer-option.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Fsanitizer-option.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Fsanitizer-option.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fsanitizer-option.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -7,7 +7,7 @@\n // correctly, then linking will fail.\n \n /// ```\n-/// extern {\n+/// extern \"C\" {\n ///     fn __sanitizer_print_stack_trace();\n /// }\n ///"}, {"sha": "2084e8517992a4759d657d0f0bb7de42812ff6a5", "filename": "src/test/rustdoc/titles.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Ftitles.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Frustdoc%2Ftitles.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Ftitles.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -7,7 +7,7 @@ pub mod foo_mod {\n     pub struct __Thing {}\n }\n \n-extern {\n+extern \"C\" {\n     // @matches 'foo/fn.foo_ffn.html' '//h1' 'Function foo::foo_ffn'\n     pub fn foo_ffn();\n }\n@@ -30,7 +30,7 @@ pub type FooType = FooStruct;\n // @matches 'foo/macro.foo_macro.html' '//h1' 'Macro foo::foo_macro'\n #[macro_export]\n macro_rules! foo_macro {\n-    () => ();\n+    () => {};\n }\n \n // @matches 'foo/primitive.bool.html' '//h1' 'Primitive Type bool'\n@@ -40,7 +40,7 @@ mod bool {}\n // @matches 'foo/static.FOO_STATIC.html' '//h1' 'Static foo::FOO_STATIC'\n pub static FOO_STATIC: FooStruct = FooStruct;\n \n-extern {\n+extern \"C\" {\n     // @matches 'foo/static.FOO_FSTATIC.html' '//h1' 'Static foo::FOO_FSTATIC'\n     pub static FOO_FSTATIC: FooStruct;\n }"}, {"sha": "e9501a809308bd9bed50724c3d830558149331b3", "filename": "src/test/ui-fulldeps/switch-stdout.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui-fulldeps%2Fswitch-stdout.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui-fulldeps%2Fswitch-stdout.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui-fulldeps%2Fswitch-stdout.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -9,7 +9,7 @@ use std::path::PathBuf;\n fn switch_stdout_to(file: File) {\n     use std::os::unix::prelude::*;\n \n-    extern {\n+    extern \"C\" {\n         fn dup2(old: i32, new: i32) -> i32;\n     }\n \n@@ -29,8 +29,7 @@ fn switch_stdout_to(file: File) {\n     const STD_OUTPUT_HANDLE: u32 = (-11i32) as u32;\n \n     unsafe {\n-        let rc = SetStdHandle(STD_OUTPUT_HANDLE,\n-                              file.into_raw_handle() as *mut _);\n+        let rc = SetStdHandle(STD_OUTPUT_HANDLE, file.into_raw_handle() as *mut _);\n         assert!(rc != 0);\n     }\n }"}, {"sha": "6c7d60d4cb0b493db8cd1855cc871b4eb10b5935", "filename": "src/test/ui/abi/anon-extern-mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fanon-extern-mod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fanon-extern-mod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fanon-extern-mod.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -7,7 +7,7 @@\n extern crate libc;\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn rust_get_test_int() -> libc::intptr_t;\n }\n "}, {"sha": "5cbf8093c5c3cbe05191a07731f54c9b78423efc", "filename": "src/test/ui/abi/auxiliary/anon-extern-mod-cross-crate-1.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fauxiliary%2Fanon-extern-mod-cross-crate-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fauxiliary%2Fanon-extern-mod-cross-crate-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fauxiliary%2Fanon-extern-mod-cross-crate-1.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,9 +1,9 @@\n-#![crate_name=\"anonexternmod\"]\n+#![crate_name = \"anonexternmod\"]\n #![feature(rustc_private)]\n \n extern crate libc;\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_get_test_int() -> libc::intptr_t;\n }"}, {"sha": "3c649b778bd1a47813b1a1f0f3737022dc74c2a9", "filename": "src/test/ui/abi/auxiliary/foreign_lib.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fauxiliary%2Fforeign_lib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fauxiliary%2Fforeign_lib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fauxiliary%2Fforeign_lib.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,20 +1,19 @@\n-#![crate_name=\"foreign_lib\"]\n-\n+#![crate_name = \"foreign_lib\"]\n #![feature(rustc_private)]\n \n pub mod rustrt {\n     extern crate libc;\n \n     #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-    extern {\n+    extern \"C\" {\n         pub fn rust_get_test_int() -> libc::intptr_t;\n     }\n }\n \n pub mod rustrt2 {\n     extern crate libc;\n \n-    extern {\n+    extern \"C\" {\n         pub fn rust_get_test_int() -> libc::intptr_t;\n     }\n }\n@@ -24,7 +23,7 @@ pub mod rustrt3 {\n     // Ensures that we don't ICE or trigger LLVM asserts when\n     // importing the same symbol under different types.\n     // See https://github.com/rust-lang/rust/issues/32740.\n-    extern {\n+    extern \"C\" {\n         pub fn rust_get_test_int() -> *const u8;\n     }\n }"}, {"sha": "5bece0ba2d15baacac31c5a32ed5a44613883848", "filename": "src/test/ui/abi/c-stack-as-value.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fc-stack-as-value.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fc-stack-as-value.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fc-stack-as-value.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -8,7 +8,7 @@ mod rustrt {\n     extern crate libc;\n \n     #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-    extern {\n+    extern \"C\" {\n         pub fn rust_get_test_int() -> libc::intptr_t;\n     }\n }"}, {"sha": "1dbab275225cdb2579ee22f5d995e62c60510fa0", "filename": "src/test/ui/abi/cabi-int-widening.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fcabi-int-widening.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fcabi-int-widening.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fcabi-int-widening.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,7 +2,7 @@\n // ignore-wasm32-bare no libc to test ffi with\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn rust_int8_to_int32(_: i8) -> i32;\n }\n "}, {"sha": "5cbf8093c5c3cbe05191a07731f54c9b78423efc", "filename": "src/test/ui/abi/consts/auxiliary/anon-extern-mod-cross-crate-1.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fconsts%2Fauxiliary%2Fanon-extern-mod-cross-crate-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fconsts%2Fauxiliary%2Fanon-extern-mod-cross-crate-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fconsts%2Fauxiliary%2Fanon-extern-mod-cross-crate-1.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,9 +1,9 @@\n-#![crate_name=\"anonexternmod\"]\n+#![crate_name = \"anonexternmod\"]\n #![feature(rustc_private)]\n \n extern crate libc;\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_get_test_int() -> libc::intptr_t;\n }"}, {"sha": "5cbf8093c5c3cbe05191a07731f54c9b78423efc", "filename": "src/test/ui/abi/cross-crate/auxiliary/anon-extern-mod-cross-crate-1.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fcross-crate%2Fauxiliary%2Fanon-extern-mod-cross-crate-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fcross-crate%2Fauxiliary%2Fanon-extern-mod-cross-crate-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fcross-crate%2Fauxiliary%2Fanon-extern-mod-cross-crate-1.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,9 +1,9 @@\n-#![crate_name=\"anonexternmod\"]\n+#![crate_name = \"anonexternmod\"]\n #![feature(rustc_private)]\n \n extern crate libc;\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_get_test_int() -> libc::intptr_t;\n }"}, {"sha": "9c61518b94142ebd4dd2c18258ae750b48d7f912", "filename": "src/test/ui/abi/extern/auxiliary/extern-crosscrate-source.rs", "status": "modified", "additions": 8, "deletions": 11, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fauxiliary%2Fextern-crosscrate-source.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fauxiliary%2Fextern-crosscrate-source.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fauxiliary%2Fextern-crosscrate-source.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-#![crate_name=\"externcallback\"]\n+#![crate_name = \"externcallback\"]\n #![crate_type = \"lib\"]\n #![feature(rustc_private)]\n \n@@ -8,10 +8,11 @@ pub mod rustrt {\n     extern crate libc;\n \n     #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-    extern {\n-        pub fn rust_dbg_call(cb: extern \"C\" fn(libc::uintptr_t) -> libc::uintptr_t,\n-                             data: libc::uintptr_t)\n-                             -> libc::uintptr_t;\n+    extern \"C\" {\n+        pub fn rust_dbg_call(\n+            cb: extern \"C\" fn(libc::uintptr_t) -> libc::uintptr_t,\n+            data: libc::uintptr_t,\n+        ) -> libc::uintptr_t;\n     }\n }\n \n@@ -22,10 +23,6 @@ pub fn fact(n: libc::uintptr_t) -> libc::uintptr_t {\n     }\n }\n \n-pub extern fn cb(data: libc::uintptr_t) -> libc::uintptr_t {\n-    if data == 1 {\n-        data\n-    } else {\n-        fact(data - 1) * data\n-    }\n+pub extern \"C\" fn cb(data: libc::uintptr_t) -> libc::uintptr_t {\n+    if data == 1 { data } else { fact(data - 1) * data }\n }"}, {"sha": "db5f2ca652fa51bf74d3dcb237f21af75a1e66a6", "filename": "src/test/ui/abi/extern/extern-call-deep.rs", "status": "modified", "additions": 7, "deletions": 10, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-call-deep.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-call-deep.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-call-deep.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -10,19 +10,16 @@ mod rustrt {\n     extern crate libc;\n \n     #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-    extern {\n-        pub fn rust_dbg_call(cb: extern \"C\" fn(libc::uintptr_t) -> libc::uintptr_t,\n-                             data: libc::uintptr_t)\n-                             -> libc::uintptr_t;\n+    extern \"C\" {\n+        pub fn rust_dbg_call(\n+            cb: extern \"C\" fn(libc::uintptr_t) -> libc::uintptr_t,\n+            data: libc::uintptr_t,\n+        ) -> libc::uintptr_t;\n     }\n }\n \n-extern fn cb(data: libc::uintptr_t) -> libc::uintptr_t {\n-    if data == 1 {\n-        data\n-    } else {\n-        count(data - 1) + 1\n-    }\n+extern \"C\" fn cb(data: libc::uintptr_t) -> libc::uintptr_t {\n+    if data == 1 { data } else { count(data - 1) + 1 }\n }\n \n fn count(n: libc::uintptr_t) -> libc::uintptr_t {"}, {"sha": "60e8db1592e940fa38e3137e6631e67ef61b657f", "filename": "src/test/ui/abi/extern/extern-call-deep2.rs", "status": "modified", "additions": 10, "deletions": 13, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-call-deep2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-call-deep2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-call-deep2.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,6 @@\n // run-pass\n #![allow(unused_must_use)]\n // ignore-emscripten no threads support\n-\n #![feature(rustc_private)]\n \n extern crate libc;\n@@ -11,19 +10,16 @@ mod rustrt {\n     extern crate libc;\n \n     #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-    extern {\n-        pub fn rust_dbg_call(cb: extern \"C\" fn(libc::uintptr_t) -> libc::uintptr_t,\n-                             data: libc::uintptr_t)\n-                             -> libc::uintptr_t;\n+    extern \"C\" {\n+        pub fn rust_dbg_call(\n+            cb: extern \"C\" fn(libc::uintptr_t) -> libc::uintptr_t,\n+            data: libc::uintptr_t,\n+        ) -> libc::uintptr_t;\n     }\n }\n \n-extern fn cb(data: libc::uintptr_t) -> libc::uintptr_t {\n-    if data == 1 {\n-        data\n-    } else {\n-        count(data - 1) + 1\n-    }\n+extern \"C\" fn cb(data: libc::uintptr_t) -> libc::uintptr_t {\n+    if data == 1 { data } else { count(data - 1) + 1 }\n }\n \n fn count(n: libc::uintptr_t) -> libc::uintptr_t {\n@@ -36,9 +32,10 @@ fn count(n: libc::uintptr_t) -> libc::uintptr_t {\n pub fn main() {\n     // Make sure we're on a thread with small Rust stacks (main currently\n     // has a large stack)\n-    thread::spawn(move|| {\n+    thread::spawn(move || {\n         let result = count(1000);\n         println!(\"result = {}\", result);\n         assert_eq!(result, 1000);\n-    }).join();\n+    })\n+    .join();\n }"}, {"sha": "19b901d49a4280dccb0927c9bc95c9cd28c7fd04", "filename": "src/test/ui/abi/extern/extern-call-direct.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-call-direct.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-call-direct.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-call-direct.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,7 +2,7 @@\n // Test direct calls to extern fns.\n \n \n-extern fn f(x: usize) -> usize { x * 2 }\n+extern \"C\" fn f(x: usize) -> usize { x * 2 }\n \n pub fn main() {\n     let x = f(22);"}, {"sha": "886e8f6be1099baf7a89b0371d0e69a674455fc7", "filename": "src/test/ui/abi/extern/extern-call-indirect.rs", "status": "modified", "additions": 7, "deletions": 10, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-call-indirect.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-call-indirect.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-call-indirect.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -9,19 +9,16 @@ mod rustrt {\n     extern crate libc;\n \n     #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-    extern {\n-        pub fn rust_dbg_call(cb: extern \"C\" fn(libc::uintptr_t) -> libc::uintptr_t,\n-                             data: libc::uintptr_t)\n-                             -> libc::uintptr_t;\n+    extern \"C\" {\n+        pub fn rust_dbg_call(\n+            cb: extern \"C\" fn(libc::uintptr_t) -> libc::uintptr_t,\n+            data: libc::uintptr_t,\n+        ) -> libc::uintptr_t;\n     }\n }\n \n-extern fn cb(data: libc::uintptr_t) -> libc::uintptr_t {\n-    if data == 1 {\n-        data\n-    } else {\n-        fact(data - 1) * data\n-    }\n+extern \"C\" fn cb(data: libc::uintptr_t) -> libc::uintptr_t {\n+    if data == 1 { data } else { fact(data - 1) * data }\n }\n \n fn fact(n: libc::uintptr_t) -> libc::uintptr_t {"}, {"sha": "ff33cf31af85e6717a85322cf109d0ff4c40c272", "filename": "src/test/ui/abi/extern/extern-call-scrub.rs", "status": "modified", "additions": 10, "deletions": 13, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-call-scrub.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-call-scrub.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-call-scrub.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,7 +5,6 @@\n // directions\n \n // ignore-emscripten no threads support\n-\n #![feature(rustc_private)]\n \n extern crate libc;\n@@ -15,19 +14,16 @@ mod rustrt {\n     extern crate libc;\n \n     #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-    extern {\n-        pub fn rust_dbg_call(cb: extern \"C\" fn(libc::uintptr_t) -> libc::uintptr_t,\n-                             data: libc::uintptr_t)\n-                             -> libc::uintptr_t;\n+    extern \"C\" {\n+        pub fn rust_dbg_call(\n+            cb: extern \"C\" fn(libc::uintptr_t) -> libc::uintptr_t,\n+            data: libc::uintptr_t,\n+        ) -> libc::uintptr_t;\n     }\n }\n \n-extern fn cb(data: libc::uintptr_t) -> libc::uintptr_t {\n-    if data == 1 {\n-        data\n-    } else {\n-        count(data - 1) + count(data - 1)\n-    }\n+extern \"C\" fn cb(data: libc::uintptr_t) -> libc::uintptr_t {\n+    if data == 1 { data } else { count(data - 1) + count(data - 1) }\n }\n \n fn count(n: libc::uintptr_t) -> libc::uintptr_t {\n@@ -40,9 +36,10 @@ fn count(n: libc::uintptr_t) -> libc::uintptr_t {\n pub fn main() {\n     // Make sure we're on a thread with small Rust stacks (main currently\n     // has a large stack)\n-    thread::spawn(move|| {\n+    thread::spawn(move || {\n         let result = count(12);\n         println!(\"result = {}\", result);\n         assert_eq!(result, 2048);\n-    }).join();\n+    })\n+    .join();\n }"}, {"sha": "cff25511cc95d5aa47303d2f2df18dc15abf13c3", "filename": "src/test/ui/abi/extern/extern-pass-TwoU16s.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-TwoU16s.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-TwoU16s.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-TwoU16s.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -8,17 +8,18 @@\n \n #[derive(Copy, Clone, PartialEq, Debug)]\n pub struct TwoU16s {\n-    one: u16, two: u16\n+    one: u16,\n+    two: u16,\n }\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_dbg_extern_identity_TwoU16s(v: TwoU16s) -> TwoU16s;\n }\n \n pub fn main() {\n     unsafe {\n-        let x = TwoU16s {one: 22, two: 23};\n+        let x = TwoU16s { one: 22, two: 23 };\n         let y = rust_dbg_extern_identity_TwoU16s(x);\n         assert_eq!(x, y);\n     }"}, {"sha": "03a8ecf241da802d19916c6aff3ea56c70675516", "filename": "src/test/ui/abi/extern/extern-pass-TwoU32s.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-TwoU32s.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-TwoU32s.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-TwoU32s.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -8,17 +8,18 @@\n \n #[derive(Copy, Clone, PartialEq, Debug)]\n pub struct TwoU32s {\n-    one: u32, two: u32\n+    one: u32,\n+    two: u32,\n }\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_dbg_extern_identity_TwoU32s(v: TwoU32s) -> TwoU32s;\n }\n \n pub fn main() {\n     unsafe {\n-        let x = TwoU32s {one: 22, two: 23};\n+        let x = TwoU32s { one: 22, two: 23 };\n         let y = rust_dbg_extern_identity_TwoU32s(x);\n         assert_eq!(x, y);\n     }"}, {"sha": "8bbc987c821b406329bb281d32a18a17a2e2b32a", "filename": "src/test/ui/abi/extern/extern-pass-TwoU64s.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-TwoU64s.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-TwoU64s.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-TwoU64s.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -8,17 +8,18 @@\n \n #[derive(Copy, Clone, PartialEq, Debug)]\n pub struct TwoU64s {\n-    one: u64, two: u64\n+    one: u64,\n+    two: u64,\n }\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_dbg_extern_identity_TwoU64s(v: TwoU64s) -> TwoU64s;\n }\n \n pub fn main() {\n     unsafe {\n-        let x = TwoU64s {one: 22, two: 23};\n+        let x = TwoU64s { one: 22, two: 23 };\n         let y = rust_dbg_extern_identity_TwoU64s(x);\n         assert_eq!(x, y);\n     }"}, {"sha": "55a53c250bf389459cce732f742319a39de0bb3a", "filename": "src/test/ui/abi/extern/extern-pass-TwoU8s.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-TwoU8s.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-TwoU8s.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-TwoU8s.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -8,17 +8,18 @@\n \n #[derive(Copy, Clone, PartialEq, Debug)]\n pub struct TwoU8s {\n-    one: u8, two: u8\n+    one: u8,\n+    two: u8,\n }\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_dbg_extern_identity_TwoU8s(v: TwoU8s) -> TwoU8s;\n }\n \n pub fn main() {\n     unsafe {\n-        let x = TwoU8s {one: 22, two: 23};\n+        let x = TwoU8s { one: 22, two: 23 };\n         let y = rust_dbg_extern_identity_TwoU8s(x);\n         assert_eq!(x, y);\n     }"}, {"sha": "2b10d26d1ddf2f29b8da6f06596b88fc137063bb", "filename": "src/test/ui/abi/extern/extern-pass-char.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-char.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-char.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-char.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,9 +3,8 @@\n \n // Test a function that takes/returns a u8.\n \n-\n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_dbg_extern_identity_u8(v: u8) -> u8;\n }\n "}, {"sha": "0b556c99e8d0bbfcb1fffb93a89b12e6ea4fb3c5", "filename": "src/test/ui/abi/extern/extern-pass-double.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-double.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-double.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-double.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,7 +2,7 @@\n // ignore-wasm32-bare no libc for ffi testing\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_dbg_extern_identity_double(v: f64) -> f64;\n }\n "}, {"sha": "ee974f6dbdeed59e8403fc2d730a85c1a024b3cf", "filename": "src/test/ui/abi/extern/extern-pass-empty.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-empty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-empty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-empty.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -27,7 +27,7 @@ struct ManyInts {\n struct Empty;\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn rust_dbg_extern_empty_struct(v1: ManyInts, e: Empty, v2: ManyInts);\n }\n \n@@ -39,15 +39,15 @@ pub fn main() {\n             arg3: 4,\n             arg4: 5,\n             arg5: 6,\n-            arg6: TwoU8s { one: 7, two: 8, }\n+            arg6: TwoU8s { one: 7, two: 8 },\n         };\n         let y = ManyInts {\n             arg1: 1,\n             arg2: 2,\n             arg3: 3,\n             arg4: 4,\n             arg5: 5,\n-            arg6: TwoU8s { one: 6, two: 7, }\n+            arg6: TwoU8s { one: 6, two: 7 },\n         };\n         let empty = Empty;\n         rust_dbg_extern_empty_struct(x, empty, y);"}, {"sha": "c9b8d52cf5be9d7548cbbce38881ebbffc28a155", "filename": "src/test/ui/abi/extern/extern-pass-u32.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-u32.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-u32.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-u32.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,9 +3,8 @@\n \n // Test a function that takes/returns a u32.\n \n-\n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_dbg_extern_identity_u32(v: u32) -> u32;\n }\n "}, {"sha": "5103129abaa4d24b3ea15d021175830d96d8fe0e", "filename": "src/test/ui/abi/extern/extern-pass-u64.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-u64.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-u64.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-pass-u64.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,9 +3,8 @@\n \n // Test a call to a function that takes/returns a u64.\n \n-\n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_dbg_extern_identity_u64(v: u64) -> u64;\n }\n "}, {"sha": "2551c93a76541b9d6cff72b810427d03df5466ba", "filename": "src/test/ui/abi/extern/extern-return-TwoU16s.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-return-TwoU16s.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-return-TwoU16s.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-return-TwoU16s.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -4,11 +4,12 @@\n // ignore-wasm32-bare no libc to test ffi with\n \n pub struct TwoU16s {\n-    one: u16, two: u16\n+    one: u16,\n+    two: u16,\n }\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_dbg_extern_return_TwoU16s() -> TwoU16s;\n }\n "}, {"sha": "70a42895d91dfbd4bfbbb008e9bb42889e5675ef", "filename": "src/test/ui/abi/extern/extern-return-TwoU32s.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-return-TwoU32s.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-return-TwoU32s.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-return-TwoU32s.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -4,11 +4,12 @@\n // ignore-wasm32-bare no libc to test ffi with\n \n pub struct TwoU32s {\n-    one: u32, two: u32\n+    one: u32,\n+    two: u32,\n }\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_dbg_extern_return_TwoU32s() -> TwoU32s;\n }\n "}, {"sha": "dd264fb9c196b6e3751e9be1c575c37bd78c1315", "filename": "src/test/ui/abi/extern/extern-return-TwoU64s.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-return-TwoU64s.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-return-TwoU64s.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-return-TwoU64s.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -4,11 +4,12 @@\n // ignore-wasm32-bare no libc to test ffi with\n \n pub struct TwoU64s {\n-    one: u64, two: u64\n+    one: u64,\n+    two: u64,\n }\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_dbg_extern_return_TwoU64s() -> TwoU64s;\n }\n "}, {"sha": "b60387aed99def2bedff5156b20dbbad8b7cbe94", "filename": "src/test/ui/abi/extern/extern-return-TwoU8s.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-return-TwoU8s.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-return-TwoU8s.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fextern%2Fextern-return-TwoU8s.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -4,11 +4,12 @@\n // ignore-wasm32-bare no libc to test ffi with\n \n pub struct TwoU8s {\n-    one: u8, two: u8\n+    one: u8,\n+    two: u8,\n }\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_dbg_extern_return_TwoU8s() -> TwoU8s;\n }\n "}, {"sha": "3c649b778bd1a47813b1a1f0f3737022dc74c2a9", "filename": "src/test/ui/abi/foreign/auxiliary/foreign_lib.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fforeign%2Fauxiliary%2Fforeign_lib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fforeign%2Fauxiliary%2Fforeign_lib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fforeign%2Fauxiliary%2Fforeign_lib.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,20 +1,19 @@\n-#![crate_name=\"foreign_lib\"]\n-\n+#![crate_name = \"foreign_lib\"]\n #![feature(rustc_private)]\n \n pub mod rustrt {\n     extern crate libc;\n \n     #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-    extern {\n+    extern \"C\" {\n         pub fn rust_get_test_int() -> libc::intptr_t;\n     }\n }\n \n pub mod rustrt2 {\n     extern crate libc;\n \n-    extern {\n+    extern \"C\" {\n         pub fn rust_get_test_int() -> libc::intptr_t;\n     }\n }\n@@ -24,7 +23,7 @@ pub mod rustrt3 {\n     // Ensures that we don't ICE or trigger LLVM asserts when\n     // importing the same symbol under different types.\n     // See https://github.com/rust-lang/rust/issues/32740.\n-    extern {\n+    extern \"C\" {\n         pub fn rust_get_test_int() -> *const u8;\n     }\n }"}, {"sha": "d5b90a3592b3e088c31d9ce037c002bd7823f3f5", "filename": "src/test/ui/abi/foreign/foreign-call-no-runtime.rs", "status": "modified", "additions": 17, "deletions": 12, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fforeign%2Fforeign-call-no-runtime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fforeign%2Fforeign-call-no-runtime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fforeign%2Fforeign-call-no-runtime.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -9,45 +9,50 @@ use std::mem;\n use std::thread;\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n-    fn rust_dbg_call(cb: extern \"C\" fn(libc::uintptr_t),\n-                     data: libc::uintptr_t) -> libc::uintptr_t;\n+extern \"C\" {\n+    fn rust_dbg_call(cb: extern \"C\" fn(libc::uintptr_t), data: libc::uintptr_t) -> libc::uintptr_t;\n }\n \n pub fn main() {\n     unsafe {\n-        thread::spawn(move|| {\n+        thread::spawn(move || {\n             let i: isize = 100;\n             rust_dbg_call(callback_isize, mem::transmute(&i));\n-        }).join().unwrap();\n+        })\n+        .join()\n+        .unwrap();\n \n-        thread::spawn(move|| {\n+        thread::spawn(move || {\n             let i: i32 = 100;\n             rust_dbg_call(callback_i32, mem::transmute(&i));\n-        }).join().unwrap();\n+        })\n+        .join()\n+        .unwrap();\n \n-        thread::spawn(move|| {\n+        thread::spawn(move || {\n             let i: i64 = 100;\n             rust_dbg_call(callback_i64, mem::transmute(&i));\n-        }).join().unwrap();\n+        })\n+        .join()\n+        .unwrap();\n     }\n }\n \n-extern fn callback_isize(data: libc::uintptr_t) {\n+extern \"C\" fn callback_isize(data: libc::uintptr_t) {\n     unsafe {\n         let data: *const isize = mem::transmute(data);\n         assert_eq!(*data, 100);\n     }\n }\n \n-extern fn callback_i64(data: libc::uintptr_t) {\n+extern \"C\" fn callback_i64(data: libc::uintptr_t) {\n     unsafe {\n         let data: *const i64 = mem::transmute(data);\n         assert_eq!(*data, 100);\n     }\n }\n \n-extern fn callback_i32(data: libc::uintptr_t) {\n+extern \"C\" fn callback_i32(data: libc::uintptr_t) {\n     unsafe {\n         let data: *const i32 = mem::transmute(data);\n         assert_eq!(*data, 100);"}, {"sha": "f366b6ee1bdd5a4013833dfa614631722c0a3e30", "filename": "src/test/ui/abi/foreign/foreign-fn-with-byval.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fforeign%2Fforeign-fn-with-byval.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fforeign%2Fforeign-fn-with-byval.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fforeign%2Fforeign-fn-with-byval.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -11,17 +11,15 @@ pub struct S {\n }\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn get_x(x: S) -> u64;\n     pub fn get_y(x: S) -> u64;\n     pub fn get_z(x: S) -> u64;\n }\n \n #[inline(never)]\n-fn indirect_call(func: unsafe extern fn(s: S) -> u64, s: S) -> u64 {\n-    unsafe {\n-        func(s)\n-    }\n+fn indirect_call(func: unsafe extern \"C\" fn(s: S) -> u64, s: S) -> u64 {\n+    unsafe { func(s) }\n }\n \n fn main() {"}, {"sha": "3f4f70c99e6a8d5415a9c05a1e4adc442058cea6", "filename": "src/test/ui/abi/foreign/foreign-no-abi.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fforeign%2Fforeign-no-abi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fforeign%2Fforeign-no-abi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fforeign%2Fforeign-no-abi.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -10,7 +10,7 @@ mod rustrt {\n     extern crate libc;\n \n     #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-    extern {\n+    extern \"C\" {\n         pub fn rust_get_test_int() -> libc::intptr_t;\n     }\n }"}, {"sha": "29b2405189cc3d72fe7e5e452729da3e9334c1d1", "filename": "src/test/ui/abi/issues/issue-62350-sysv-neg-reg-counts.rs", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fissues%2Fissue-62350-sysv-neg-reg-counts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fissues%2Fissue-62350-sysv-neg-reg-counts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fissues%2Fissue-62350-sysv-neg-reg-counts.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,13 +5,18 @@\n // ignore-wasm32-bare no libc to test ffi with\n \n #[derive(Copy, Clone)]\n-pub struct QuadFloats { a: f32, b: f32, c: f32, d: f32 }\n+pub struct QuadFloats {\n+    a: f32,\n+    b: f32,\n+    c: f32,\n+    d: f32,\n+}\n \n mod rustrt {\n     use super::QuadFloats;\n \n     #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-    extern {\n+    extern \"C\" {\n         pub fn get_c_exhaust_sysv64_ints(\n             _: *const (),\n             _: *const (),\n@@ -28,12 +33,7 @@ mod rustrt {\n fn test() {\n     unsafe {\n         let null = std::ptr::null();\n-        let q = QuadFloats {\n-            a: 10.2,\n-            b: 20.3,\n-            c: 30.4,\n-            d: 40.5\n-        };\n+        let q = QuadFloats { a: 10.2, b: 20.3, c: 30.4, d: 40.5 };\n         assert_eq!(\n             rustrt::get_c_exhaust_sysv64_ints(null, null, null, null, null, null, null, q),\n             q.c,"}, {"sha": "b3392b9c60715642b9f1c631f860b8861fcf09c9", "filename": "src/test/ui/abi/mir/mir_codegen_calls_variadic.rs", "status": "modified", "additions": 5, "deletions": 8, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fmir%2Fmir_codegen_calls_variadic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fmir%2Fmir_codegen_calls_variadic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fmir%2Fmir_codegen_calls_variadic.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,21 +2,18 @@\n // ignore-wasm32-bare no libc to test ffi with\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn rust_interesting_average(_: i64, ...) -> f64;\n }\n \n fn test<T, U>(a: i64, b: i64, c: i64, d: i64, e: i64, f: T, g: U) -> i64 {\n     unsafe {\n-        rust_interesting_average(6, a, a as f64,\n-                                    b, b as f64,\n-                                    c, c as f64,\n-                                    d, d as f64,\n-                                    e, e as f64,\n-                                    f, g) as i64\n+        rust_interesting_average(\n+            6, a, a as f64, b, b as f64, c, c as f64, d, d as f64, e, e as f64, f, g,\n+        ) as i64\n     }\n }\n \n-fn main(){\n+fn main() {\n     assert_eq!(test(10, 20, 30, 40, 50, 60_i64, 60.0_f64), 70);\n }"}, {"sha": "ad4faf95a0f95e99b77ffff9392e59f284546001", "filename": "src/test/ui/abi/segfault-no-out-of-stack.rs", "status": "modified", "additions": 8, "deletions": 10, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fsegfault-no-out-of-stack.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fsegfault-no-out-of-stack.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fsegfault-no-out-of-stack.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,39 +3,37 @@\n #![allow(unused_imports)]\n // ignore-emscripten can't run commands\n // ignore-sgx no processes\n-\n #![feature(rustc_private)]\n \n extern crate libc;\n \n-use std::process::{Command, ExitStatus};\n use std::env;\n+use std::process::{Command, ExitStatus};\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn rust_get_null_ptr() -> *mut ::libc::c_char;\n }\n \n #[cfg(unix)]\n-fn check_status(status: std::process::ExitStatus)\n-{\n+fn check_status(status: std::process::ExitStatus) {\n     use libc;\n     use std::os::unix::process::ExitStatusExt;\n \n-    assert!(status.signal() == Some(libc::SIGSEGV)\n-            || status.signal() == Some(libc::SIGBUS));\n+    assert!(status.signal() == Some(libc::SIGSEGV) || status.signal() == Some(libc::SIGBUS));\n }\n \n #[cfg(not(unix))]\n-fn check_status(status: std::process::ExitStatus)\n-{\n+fn check_status(status: std::process::ExitStatus) {\n     assert!(!status.success());\n }\n \n fn main() {\n     let args: Vec<String> = env::args().collect();\n     if args.len() > 1 && args[1] == \"segfault\" {\n-        unsafe { *rust_get_null_ptr() = 1; }; // trigger a segfault\n+        unsafe {\n+            *rust_get_null_ptr() = 1;\n+        }; // trigger a segfault\n     } else {\n         let segfault = Command::new(&args[0]).arg(\"segfault\").output().unwrap();\n         let stderr = String::from_utf8_lossy(&segfault.stderr);"}, {"sha": "e998dd0f83ebca01c0b5455e0580f1d3a11cbdba", "filename": "src/test/ui/abi/stack-probes.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fstack-probes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fstack-probes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fstack-probes.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -11,13 +11,13 @@\n // ignore-emscripten no processes\n // ignore-sgx no processes\n \n+use std::env;\n use std::mem::MaybeUninit;\n use std::process::Command;\n use std::thread;\n-use std::env;\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     #[link_name = \"rust_dbg_extern_identity_u64\"]\n     fn black_box(u: u64);\n }\n@@ -30,7 +30,7 @@ fn main() {\n             \"child-thread\" => thread::spawn(|| recurse(&MaybeUninit::uninit())).join().unwrap(),\n             _ => panic!(),\n         }\n-        return\n+        return;\n     }\n \n     let me = env::current_exe().unwrap();"}, {"sha": "ecd8ee94a01e3b5f814a9ab472aa755cabf25850", "filename": "src/test/ui/abi/statics/static-mut-foreign.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fstatics%2Fstatic-mut-foreign.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fstatics%2Fstatic-mut-foreign.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fstatics%2Fstatic-mut-foreign.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -10,7 +10,7 @@\n extern crate libc;\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     static mut rust_dbg_static_mut: libc::c_int;\n     pub fn rust_dbg_static_mut_check_four();\n }"}, {"sha": "1a7984ea5cd17b8b3a52d03c01ec30a856db83bd", "filename": "src/test/ui/abi/struct-enums/struct-return.rs", "status": "modified", "additions": 33, "deletions": 25, "changes": 58, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fstruct-enums%2Fstruct-return.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fstruct-enums%2Fstruct-return.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fstruct-enums%2Fstruct-return.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -4,25 +4,42 @@\n \n #[repr(C)]\n #[derive(Copy, Clone)]\n-pub struct Quad { a: u64, b: u64, c: u64, d: u64 }\n+pub struct Quad {\n+    a: u64,\n+    b: u64,\n+    c: u64,\n+    d: u64,\n+}\n \n #[repr(C)]\n #[derive(Copy, Clone)]\n-pub struct Floats { a: f64, b: u8, c: f64 }\n+pub struct Floats {\n+    a: f64,\n+    b: u8,\n+    c: f64,\n+}\n \n #[repr(C)]\n #[derive(Copy, Clone)]\n-pub struct CharCharDouble { a: u8, b: u8, c: f64 }\n+pub struct CharCharDouble {\n+    a: u8,\n+    b: u8,\n+    c: f64,\n+}\n \n #[repr(C)]\n #[derive(Copy, Clone)]\n-pub struct CharCharFloat { a: u8, b: u8, c: f32 }\n+pub struct CharCharFloat {\n+    a: u8,\n+    b: u8,\n+    c: f32,\n+}\n \n mod rustrt {\n-    use super::{Floats, Quad, CharCharDouble, CharCharFloat};\n+    use super::{CharCharDouble, CharCharFloat, Floats, Quad};\n \n     #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-    extern {\n+    extern \"C\" {\n         pub fn rust_dbg_abi_1(q: Quad) -> Quad;\n         pub fn rust_dbg_abi_2(f: Floats) -> Floats;\n         pub fn rust_dbg_abi_3(a: CharCharDouble) -> CharCharDouble;\n@@ -32,10 +49,12 @@ mod rustrt {\n \n fn test1() {\n     unsafe {\n-        let q = Quad { a: 0xaaaa_aaaa_aaaa_aaaa,\n-                 b: 0xbbbb_bbbb_bbbb_bbbb,\n-                 c: 0xcccc_cccc_cccc_cccc,\n-                 d: 0xdddd_dddd_dddd_dddd };\n+        let q = Quad {\n+            a: 0xaaaa_aaaa_aaaa_aaaa,\n+            b: 0xbbbb_bbbb_bbbb_bbbb,\n+            c: 0xcccc_cccc_cccc_cccc,\n+            d: 0xdddd_dddd_dddd_dddd,\n+        };\n         let qq = rustrt::rust_dbg_abi_1(q);\n         println!(\"a: {:x}\", qq.a as usize);\n         println!(\"b: {:x}\", qq.b as usize);\n@@ -51,9 +70,7 @@ fn test1() {\n #[cfg(target_pointer_width = \"64\")]\n fn test2() {\n     unsafe {\n-        let f = Floats { a: 1.234567890e-15_f64,\n-                 b: 0b_1010_1010,\n-                 c: 1.0987654321e-15_f64 };\n+        let f = Floats { a: 1.234567890e-15_f64, b: 0b_1010_1010, c: 1.0987654321e-15_f64 };\n         let ff = rustrt::rust_dbg_abi_2(f);\n         println!(\"a: {}\", ff.a as f64);\n         println!(\"b: {}\", ff.b as usize);\n@@ -65,17 +82,12 @@ fn test2() {\n }\n \n #[cfg(target_pointer_width = \"32\")]\n-fn test2() {\n-}\n+fn test2() {}\n \n #[cfg(target_pointer_width = \"64\")]\n fn test3() {\n     unsafe {\n-        let a = CharCharDouble {\n-            a: 1,\n-            b: 2,\n-            c: 3.,\n-        };\n+        let a = CharCharDouble { a: 1, b: 2, c: 3. };\n         let b = rustrt::rust_dbg_abi_3(a);\n         println!(\"a: {}\", b.a);\n         println!(\"b: {}\", b.b);\n@@ -91,11 +103,7 @@ fn test3() {}\n \n fn test4() {\n     unsafe {\n-        let a = CharCharFloat {\n-            a: 1,\n-            b: 2,\n-            c: 3.,\n-        };\n+        let a = CharCharFloat { a: 1, b: 2, c: 3. };\n         let b = rustrt::rust_dbg_abi_4(a);\n         println!(\"a: {}\", b.a);\n         println!(\"b: {}\", b.b);"}, {"sha": "a952ea07793298167f5345065c64a2b2f18b5cca", "filename": "src/test/ui/abi/variadic-ffi.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fvariadic-ffi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fabi%2Fvariadic-ffi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fabi%2Fvariadic-ffi.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,7 +5,7 @@\n use std::ffi::VaList;\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     fn rust_interesting_average(_: u64, ...) -> f64;\n \n     // FIXME: we need to disable this lint for `VaList`,\n@@ -61,7 +61,7 @@ pub fn main() {\n     }\n \n     // A function that takes a function pointer\n-    unsafe fn call(fp: unsafe extern fn(u64, ...) -> f64) {\n+    unsafe fn call(fp: unsafe extern \"C\" fn(u64, ...) -> f64) {\n         let (x1, x2, x3, x4) = (10i64, 10.0f64, 20i64, 20.0f64);\n         assert_eq!(fp(2, x1, x2, x3, x4) as i64, 30);\n     }\n@@ -70,7 +70,7 @@ pub fn main() {\n         call(rust_interesting_average);\n \n         // Make a function pointer, pass indirectly\n-        let x: unsafe extern fn(u64, ...) -> f64 = rust_interesting_average;\n+        let x: unsafe extern \"C\" fn(u64, ...) -> f64 = rust_interesting_average;\n         call(x);\n     }\n "}, {"sha": "c6bf6c656027753a7ccf88907ed7623904aef6bb", "filename": "src/test/ui/attributes/item-attributes.rs", "status": "modified", "additions": 18, "deletions": 23, "changes": 41, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fattributes%2Fitem-attributes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fattributes%2Fitem-attributes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fattributes%2Fitem-attributes.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,7 +5,6 @@\n // check-pass\n \n #![feature(rustc_attrs)]\n-\n #![rustc_dummy = \"val\"]\n #![rustc_dummy = \"val\"]\n #![rustc_dummy]\n@@ -21,14 +20,14 @@ mod test_single_attr_outer {\n     pub static X: isize = 10;\n \n     #[rustc_dummy = \"val\"]\n-    pub fn f() { }\n+    pub fn f() {}\n \n     #[rustc_dummy = \"val\"]\n     pub mod mod1 {}\n \n     pub mod rustrt {\n         #[rustc_dummy = \"val\"]\n-        extern {}\n+        extern \"C\" {}\n     }\n }\n \n@@ -39,7 +38,7 @@ mod test_multi_attr_outer {\n \n     #[rustc_dummy = \"val\"]\n     #[rustc_dummy = \"val\"]\n-    pub fn f() { }\n+    pub fn f() {}\n \n     #[rustc_dummy = \"val\"]\n     #[rustc_dummy = \"val\"]\n@@ -48,12 +47,14 @@ mod test_multi_attr_outer {\n     pub mod rustrt {\n         #[rustc_dummy = \"val\"]\n         #[rustc_dummy = \"val\"]\n-        extern {}\n+        extern \"C\" {}\n     }\n \n     #[rustc_dummy = \"val\"]\n     #[rustc_dummy = \"val\"]\n-    struct T {x: isize}\n+    struct T {\n+        x: isize,\n+    }\n }\n \n mod test_stmt_single_attr_outer {\n@@ -62,41 +63,36 @@ mod test_stmt_single_attr_outer {\n         static X: isize = 10;\n \n         #[rustc_dummy = \"val\"]\n-        fn f() { }\n+        fn f() {}\n \n         #[rustc_dummy = \"val\"]\n-        mod mod1 {\n-        }\n+        mod mod1 {}\n \n         mod rustrt {\n             #[rustc_dummy = \"val\"]\n-            extern {\n-            }\n+            extern \"C\" {}\n         }\n     }\n }\n \n mod test_stmt_multi_attr_outer {\n     pub fn f() {\n-\n         #[rustc_dummy = \"val\"]\n         #[rustc_dummy = \"val\"]\n         static X: isize = 10;\n \n         #[rustc_dummy = \"val\"]\n         #[rustc_dummy = \"val\"]\n-        fn f() { }\n+        fn f() {}\n \n         #[rustc_dummy = \"val\"]\n         #[rustc_dummy = \"val\"]\n-        mod mod1 {\n-        }\n+        mod mod1 {}\n \n         mod rustrt {\n             #[rustc_dummy = \"val\"]\n             #[rustc_dummy = \"val\"]\n-            extern {\n-            }\n+            extern \"C\" {}\n         }\n     }\n }\n@@ -114,7 +110,7 @@ mod test_attr_inner_then_outer {\n         #![rustc_dummy = \"val\"]\n         // This is an attribute of fn f\n         #[rustc_dummy = \"val\"]\n-        fn f() { }\n+        fn f() {}\n     }\n }\n \n@@ -126,15 +122,15 @@ mod test_attr_inner_then_outer_multi {\n         // This is an attribute of fn f\n         #[rustc_dummy = \"val\"]\n         #[rustc_dummy = \"val\"]\n-        fn f() { }\n+        fn f() {}\n     }\n }\n \n mod test_distinguish_syntax_ext {\n     pub fn f() {\n         format!(\"test{}\", \"s\");\n         #[rustc_dummy = \"val\"]\n-        fn g() { }\n+        fn g() {}\n     }\n }\n \n@@ -143,12 +139,12 @@ mod test_other_forms {\n     #[rustc_dummy(word)]\n     #[rustc_dummy(attr(word))]\n     #[rustc_dummy(key1 = \"val\", key2 = \"val\", attr)]\n-    pub fn f() { }\n+    pub fn f() {}\n }\n \n mod test_foreign_items {\n     pub mod rustrt {\n-        extern {\n+        extern \"C\" {\n             #![rustc_dummy]\n \n             #[rustc_dummy]\n@@ -157,7 +153,6 @@ mod test_foreign_items {\n     }\n }\n \n-\n // FIXME(#623): - these aren't supported yet\n /*mod test_literals {\n     #![str = \"s\"]"}, {"sha": "7019abcaffbae02cd67cd5b2d9bf6153b16ead39", "filename": "src/test/ui/attributes/obsolete-attr.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fattributes%2Fobsolete-attr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fattributes%2Fobsolete-attr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fattributes%2Fobsolete-attr.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n // Obsolete attributes fall back to unstable custom attributes.\n \n-#[ab_isize=\"stdcall\"] extern {}\n+#[ab_isize = \"stdcall\"] extern \"C\" {}\n //~^ ERROR cannot find attribute `ab_isize` in this scope\n \n #[fixed_stack_segment] fn f() {}"}, {"sha": "37c1cd0c94df22e855a5ff5b7b8338a83aadebe5", "filename": "src/test/ui/attributes/obsolete-attr.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fattributes%2Fobsolete-attr.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fattributes%2Fobsolete-attr.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fattributes%2Fobsolete-attr.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -7,7 +7,7 @@ LL | #[fixed_stack_segment] fn f() {}\n error: cannot find attribute `ab_isize` in this scope\n   --> $DIR/obsolete-attr.rs:3:3\n    |\n-LL | #[ab_isize=\"stdcall\"] extern {}\n+LL | #[ab_isize = \"stdcall\"] extern \"C\" {}\n    |   ^^^^^^^^\n \n error: aborting due to 2 previous errors"}, {"sha": "c090bc79fce83b2c6d145b8458d5debc07617bb6", "filename": "src/test/ui/auxiliary/extern-statics.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fauxiliary%2Fextern-statics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fauxiliary%2Fextern-statics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fauxiliary%2Fextern-statics.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-extern {\n+extern \"C\" {\n     pub static XA: u8;\n     pub static mut XB: u8;\n }"}, {"sha": "0d927117d81d363efd81733e169875fd1b6deca4", "filename": "src/test/ui/auxiliary/link-cfg-works-transitive-dylib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fauxiliary%2Flink-cfg-works-transitive-dylib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fauxiliary%2Flink-cfg-works-transitive-dylib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fauxiliary%2Flink-cfg-works-transitive-dylib.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n #![feature(link_cfg)]\n \n #[link(name = \"foo\", cfg(foo))]\n-extern {}\n+extern \"C\" {}"}, {"sha": "0a296f0b2ef4c7490cdf61e6e10ccb2ce03cbfd5", "filename": "src/test/ui/auxiliary/link-cfg-works-transitive-rlib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fauxiliary%2Flink-cfg-works-transitive-rlib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fauxiliary%2Flink-cfg-works-transitive-rlib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fauxiliary%2Flink-cfg-works-transitive-rlib.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -4,4 +4,4 @@\n #![crate_type = \"rlib\"]\n \n #[link(name = \"foo\", cfg(foo))]\n-extern {}\n+extern \"C\" {}"}, {"sha": "ec6d05603578458ba6df96433330b2e844c70d97", "filename": "src/test/ui/auxiliary/lto-duplicate-symbols1.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fauxiliary%2Flto-duplicate-symbols1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fauxiliary%2Flto-duplicate-symbols1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fauxiliary%2Flto-duplicate-symbols1.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,4 +3,4 @@\n #![crate_type = \"rlib\"]\n \n #[no_mangle]\n-pub extern fn foo() {}\n+pub extern \"C\" fn foo() {}"}, {"sha": "ec6d05603578458ba6df96433330b2e844c70d97", "filename": "src/test/ui/auxiliary/lto-duplicate-symbols2.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fauxiliary%2Flto-duplicate-symbols2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fauxiliary%2Flto-duplicate-symbols2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fauxiliary%2Flto-duplicate-symbols2.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,4 +3,4 @@\n #![crate_type = \"rlib\"]\n \n #[no_mangle]\n-pub extern fn foo() {}\n+pub extern \"C\" fn foo() {}"}, {"sha": "43fe8c11d7c48bd5e500b7dfafaa158fcf952523", "filename": "src/test/ui/bad/bad-extern-link-attrs.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fbad%2Fbad-extern-link-attrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fbad%2Fbad-extern-link-attrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fbad%2Fbad-extern-link-attrs.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,6 +2,6 @@\n #[link(name = \"\")] //~ ERROR: with empty name\n #[link(name = \"foo\")]\n #[link(name = \"foo\", kind = \"bar\")] //~ ERROR: unknown kind\n-extern {}\n+extern \"C\" {}\n \n fn main() {}"}, {"sha": "fb3cb2083e4b9f8b1c8ab865e03f724c9484e8b5", "filename": "src/test/ui/c-stack-returning-int64.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fc-stack-returning-int64.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fc-stack-returning-int64.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fc-stack-returning-int64.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -11,7 +11,7 @@ use std::ffi::CString;\n mod mlibc {\n     use libc::{c_char, c_long, c_longlong};\n \n-    extern {\n+    extern \"C\" {\n         pub fn atol(x: *const c_char) -> c_long;\n         pub fn atoll(x: *const c_char) -> c_longlong;\n     }\n@@ -29,6 +29,8 @@ fn atoll(s: String) -> i64 {\n \n pub fn main() {\n     assert_eq!(atol(\"1024\".to_string()) * 10, atol(\"10240\".to_string()));\n-    assert_eq!((atoll(\"11111111111111111\".to_string()) * 10),\n-             atoll(\"111111111111111110\".to_string()));\n+    assert_eq!(\n+        (atoll(\"11111111111111111\".to_string()) * 10),\n+        atoll(\"111111111111111110\".to_string())\n+    );\n }"}, {"sha": "2c02a0d3081e274849f601b0522576e7f14cc5a6", "filename": "src/test/ui/c-variadic/variadic-ffi-1.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fc-variadic%2Fvariadic-ffi-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fc-variadic%2Fvariadic-ffi-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fc-variadic%2Fvariadic-ffi-1.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -6,24 +6,24 @@ extern \"stdcall\" {\n     fn printf(_: *const u8, ...); //~ ERROR: variadic function must have C or cdecl calling\n }\n \n-extern {\n+extern \"C\" {\n     fn foo(f: isize, x: u8, ...);\n }\n \n extern \"C\" fn bar(f: isize, x: u8) {}\n \n fn main() {\n     unsafe {\n-        foo();  //~ ERROR this function takes at least 2 arguments but 0 arguments were supplied\n+        foo(); //~ ERROR this function takes at least 2 arguments but 0 arguments were supplied\n         foo(1); //~ ERROR this function takes at least 2 arguments but 1 argument was supplied\n \n         let x: unsafe extern \"C\" fn(f: isize, x: u8) = foo; //~ ERROR mismatched types\n         let y: extern \"C\" fn(f: isize, x: u8, ...) = bar; //~ ERROR mismatched types\n \n         foo(1, 2, 3f32); //~ ERROR can't pass\n         foo(1, 2, true); //~ ERROR can't pass\n-        foo(1, 2, 1i8);  //~ ERROR can't pass\n-        foo(1, 2, 1u8);  //~ ERROR can't pass\n+        foo(1, 2, 1i8); //~ ERROR can't pass\n+        foo(1, 2, 1u8); //~ ERROR can't pass\n         foo(1, 2, 1i16); //~ ERROR can't pass\n         foo(1, 2, 1u16); //~ ERROR can't pass\n     }"}, {"sha": "588c15a1829773dd3b48290f7ab277cae276b2f1", "filename": "src/test/ui/c-variadic/variadic-ffi-no-fixed-args.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fc-variadic%2Fvariadic-ffi-no-fixed-args.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fc-variadic%2Fvariadic-ffi-no-fixed-args.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fc-variadic%2Fvariadic-ffi-no-fixed-args.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n-extern {\n+extern \"C\" {\n     fn foo(...);\n-    //~^ ERROR C-variadic function must be declared with at least one named argument\n+//~^ ERROR C-variadic function must be declared with at least one named argument\n }\n \n fn main() {}"}, {"sha": "69f4de43186d58f4935cbf75a601bc6959754997", "filename": "src/test/ui/cfg/conditional-compile.rs", "status": "modified", "additions": 32, "deletions": 26, "changes": 58, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fcfg%2Fconditional-compile.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fcfg%2Fconditional-compile.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcfg%2Fconditional-compile.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -16,13 +16,13 @@ static b: bool = true;\n \n mod rustrt {\n     #[cfg(bogus)]\n-    extern {\n+    extern \"C\" {\n         // This symbol doesn't exist and would be a link error if this\n         // module was codegened\n         pub fn bogus();\n     }\n \n-    extern {}\n+    extern \"C\" {}\n }\n \n #[cfg(bogus)]\n@@ -31,52 +31,56 @@ type t = isize;\n type t = bool;\n \n #[cfg(bogus)]\n-enum tg { foo, }\n+enum tg {\n+    foo,\n+}\n \n-enum tg { bar, }\n+enum tg {\n+    bar,\n+}\n \n #[cfg(bogus)]\n struct r {\n-  i: isize,\n+    i: isize,\n }\n \n #[cfg(bogus)]\n-fn r(i:isize) -> r {\n-    r {\n-        i: i\n-    }\n+fn r(i: isize) -> r {\n+    r { i: i }\n }\n \n struct r {\n-  i: isize,\n+    i: isize,\n }\n \n-fn r(i:isize) -> r {\n-    r {\n-        i: i\n-    }\n+fn r(i: isize) -> r {\n+    r { i: i }\n }\n \n #[cfg(bogus)]\n mod m {\n     // This needs to parse but would fail in typeck. Since it's not in\n     // the current config it should not be typechecked.\n-    pub fn bogus() { return 0; }\n+    pub fn bogus() {\n+        return 0;\n+    }\n }\n \n mod m {\n     // Submodules have slightly different code paths than the top-level\n     // module, so let's make sure this jazz works here as well\n     #[cfg(bogus)]\n-    pub fn f() { }\n+    pub fn f() {}\n \n-    pub fn f() { }\n+    pub fn f() {}\n }\n \n // Since the bogus configuration isn't defined main will just be\n // parsed, but nothing further will be done with it\n #[cfg(bogus)]\n-pub fn main() { panic!() }\n+pub fn main() {\n+    panic!()\n+}\n \n pub fn main() {\n     // Exercise some of the configured items in ways that wouldn't be possible\n@@ -90,8 +94,10 @@ pub fn main() {\n \n fn test_in_fn_ctxt() {\n     #[cfg(bogus)]\n-    fn f() { panic!() }\n-    fn f() { }\n+    fn f() {\n+        panic!()\n+    }\n+    fn f() {}\n     f();\n \n     #[cfg(bogus)]\n@@ -102,7 +108,7 @@ fn test_in_fn_ctxt() {\n \n mod test_foreign_items {\n     pub mod rustrt {\n-        extern {\n+        extern \"C\" {\n             #[cfg(bogus)]\n             pub fn write() -> String;\n             pub fn write() -> String;\n@@ -117,19 +123,19 @@ mod test_use_statements {\n \n mod test_methods {\n     struct Foo {\n-        bar: usize\n+        bar: usize,\n     }\n \n     impl Fooable for Foo {\n         #[cfg(bogus)]\n-        fn what(&self) { }\n+        fn what(&self) {}\n \n-        fn what(&self) { }\n+        fn what(&self) {}\n \n         #[cfg(bogus)]\n-        fn the(&self) { }\n+        fn the(&self) {}\n \n-        fn the(&self) { }\n+        fn the(&self) {}\n     }\n \n     trait Fooable {"}, {"sha": "007d2ae6506d7864a5b276224753059c73d43b32", "filename": "src/test/ui/check-doc-alias-attr-location.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fcheck-doc-alias-attr-location.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fcheck-doc-alias-attr-location.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcheck-doc-alias-attr-location.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -7,7 +7,7 @@ pub trait Foo {\n }\n \n #[doc(alias = \"foo\")] //~ ERROR\n-extern {}\n+extern \"C\" {}\n \n #[doc(alias = \"bar\")] //~ ERROR\n impl Bar {\n@@ -19,5 +19,7 @@ impl Bar {\n impl Foo for Bar {\n     #[doc(alias = \"assoc\")] //~ ERROR\n     type X = i32;\n-    fn foo() -> Self::X { 0 }\n+    fn foo() -> Self::X {\n+        0\n+    }\n }"}, {"sha": "c83b3f4a5bbf0908fbd72c6188ef18a2d356d64d", "filename": "src/test/ui/consts/auxiliary/cci_const.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fauxiliary%2Fcci_const.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fauxiliary%2Fcci_const.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fauxiliary%2Fcci_const.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-pub extern fn bar() {\n+pub extern \"C\" fn bar() {\n }\n \n pub const foopy: &'static str = \"hi there\";"}, {"sha": "2dc9539ba527b2875d13060d0588dfeec7cf9ab5", "filename": "src/test/ui/consts/auxiliary/issue-63226.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fauxiliary%2Fissue-63226.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fauxiliary%2Fissue-63226.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fauxiliary%2Fissue-63226.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n pub struct VTable{\n-    state:extern fn(),\n+    state:extern \"C\" fn(),\n }\n \n impl VTable{\n@@ -11,4 +11,4 @@ impl VTable{\n         &VTable{state};\n }\n \n-extern fn state() {}\n+extern \"C\" fn state() {}"}, {"sha": "abeb24121eb16ade37675c1ad03b382caafd3729", "filename": "src/test/ui/consts/const-cast.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-cast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-cast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-cast.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -7,7 +7,7 @@ struct TestStruct {\n \n unsafe impl Sync for TestStruct {}\n \n-extern fn foo() {}\n+extern \"C\" fn foo() {}\n const x: extern \"C\" fn() = foo;\n static y: TestStruct = TestStruct { x: x as *const u8 };\n "}, {"sha": "d91d07827dc05f66e221168415e7a41e41911493", "filename": "src/test/ui/consts/const-eval/extern_fat_pointer.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fextern_fat_pointer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fextern_fat_pointer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fextern_fat_pointer.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,7 +2,7 @@\n \n #![feature(extern_types)]\n \n-extern {\n+extern \"C\" {\n     type Opaque;\n }\n "}, {"sha": "ee07dfae47c38e0a318cc18806b7a0eef9ef48ec", "filename": "src/test/ui/consts/const-extern-fn/const-extern-fn-call-extern-fn.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-call-extern-fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-call-extern-fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-call-extern-fn.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -4,16 +4,16 @@ extern \"C\" {\n     fn regular_in_block();\n }\n \n-const extern fn bar() {\n+const extern \"C\" fn bar() {\n     unsafe {\n         regular_in_block();\n         //~^ ERROR: calls in constant functions\n     }\n }\n \n-extern fn regular() {}\n+extern \"C\" fn regular() {}\n \n-const extern fn foo() {\n+const extern \"C\" fn foo() {\n     unsafe {\n         regular();\n         //~^ ERROR: calls in constant functions"}, {"sha": "76380ebcb6599b13a671da959749f61249a6da13", "filename": "src/test/ui/consts/const-extern-fn/const-extern-fn-min-const-fn.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-min-const-fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-min-const-fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-min-const-fn.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,10 +1,10 @@\n #![feature(const_extern_fn)]\n \n-const extern fn unsize(x: &[u8; 3]) -> &[u8] { x }\n+const extern \"C\" fn unsize(x: &[u8; 3]) -> &[u8] { x }\n const unsafe extern \"C\" fn closure() -> fn() { || {} }\n //~^ ERROR function pointer\n //~| ERROR function pointer cast\n-const unsafe extern fn use_float() { 1.0 + 1.0; }\n+const unsafe extern \"C\" fn use_float() { 1.0 + 1.0; }\n //~^ ERROR floating point arithmetic\n const extern \"C\" fn ptr_cast(val: *const u8) { val as usize; }\n //~^ ERROR casting pointers to integers"}, {"sha": "80d234b0e881eefe992f83eeb265b39f5ddec67c", "filename": "src/test/ui/consts/const-extern-fn/const-extern-fn-min-const-fn.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-min-const-fn.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-min-const-fn.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-min-const-fn.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -17,10 +17,10 @@ LL | const unsafe extern \"C\" fn closure() -> fn() { || {} }\n    = help: add `#![feature(const_fn_fn_ptr_basics)]` to the crate attributes to enable\n \n error[E0658]: floating point arithmetic is not allowed in constant functions\n-  --> $DIR/const-extern-fn-min-const-fn.rs:7:38\n+  --> $DIR/const-extern-fn-min-const-fn.rs:7:42\n    |\n-LL | const unsafe extern fn use_float() { 1.0 + 1.0; }\n-   |                                      ^^^^^^^^^\n+LL | const unsafe extern \"C\" fn use_float() { 1.0 + 1.0; }\n+   |                                          ^^^^^^^^^\n    |\n    = note: see issue #57241 <https://github.com/rust-lang/rust/issues/57241> for more information\n    = help: add `#![feature(const_fn_floating_point_arithmetic)]` to the crate attributes to enable"}, {"sha": "71e6c2cb85859bb6966420b4bdd04440bad4dfa7", "filename": "src/test/ui/consts/const-extern-fn/const-extern-fn-requires-unsafe.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-requires-unsafe.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-requires-unsafe.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-requires-unsafe.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n #![feature(const_extern_fn)]\n \n-const unsafe extern fn foo() -> usize { 5 }\n+const unsafe extern \"C\" fn foo() -> usize { 5 }\n \n fn main() {\n     let a: [u8; foo()];"}, {"sha": "2ce2eafd54507ef2b74581ff191fb5595223a761", "filename": "src/test/ui/consts/const-extern-fn/const-extern-fn.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,15 +1,15 @@\n // run-pass\n #![feature(const_extern_fn)]\n \n-const extern fn foo1(val: u8) -> u8 {\n+const extern \"C\" fn foo1(val: u8) -> u8 {\n     val + 1\n }\n \n const extern \"C\" fn foo2(val: u8) -> u8 {\n     val + 1\n }\n \n-const unsafe extern fn bar1(val: bool) -> bool {\n+const unsafe extern \"C\" fn bar1(val: bool) -> bool {\n     !val\n }\n \n@@ -28,8 +28,8 @@ fn main() {\n     assert!(bar1_res);\n     assert_eq!(bar1_res, bar2_res);\n \n-    let _foo1_cast: extern fn(u8) -> u8 = foo1;\n-    let _foo2_cast: extern fn(u8) -> u8 = foo2;\n-    let _bar1_cast: unsafe extern fn(bool) -> bool = bar1;\n-    let _bar2_cast: unsafe extern fn(bool) -> bool = bar2;\n+    let _foo1_cast: extern \"C\" fn(u8) -> u8 = foo1;\n+    let _foo2_cast: extern \"C\" fn(u8) -> u8 = foo2;\n+    let _bar1_cast: unsafe extern \"C\" fn(bool) -> bool = bar1;\n+    let _bar2_cast: unsafe extern \"C\" fn(bool) -> bool = bar2;\n }"}, {"sha": "01f487a7d7558fa703d4756f0c051107a461e139", "filename": "src/test/ui/consts/const-extern-function.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-function.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-function.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-function.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n // run-pass\n #![allow(non_upper_case_globals)]\n \n-extern fn foopy() {}\n+extern \"C\" fn foopy() {}\n \n static f: extern \"C\" fn() = foopy;\n static s: S = S { f: foopy };"}, {"sha": "09c7d5580deca4b2b8890c7e311fae48da8ef660", "filename": "src/test/ui/consts/const-size_of_val-align_of_val-extern-type.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-size_of_val-align_of_val-extern-type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fconsts%2Fconst-size_of_val-align_of_val-extern-type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-size_of_val-align_of_val-extern-type.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,9 +2,9 @@\n #![feature(core_intrinsics)]\n #![feature(const_size_of_val, const_align_of_val)]\n \n-use std::intrinsics::{size_of_val, min_align_of_val};\n+use std::intrinsics::{min_align_of_val, size_of_val};\n \n-extern {\n+extern \"C\" {\n     type Opaque;\n }\n "}, {"sha": "c83b3f4a5bbf0908fbd72c6188ef18a2d356d64d", "filename": "src/test/ui/cross-crate/auxiliary/cci_const.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fcross-crate%2Fauxiliary%2Fcci_const.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fcross-crate%2Fauxiliary%2Fcci_const.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcross-crate%2Fauxiliary%2Fcci_const.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-pub extern fn bar() {\n+pub extern \"C\" fn bar() {\n }\n \n pub const foopy: &'static str = \"hi there\";"}, {"sha": "e303a790bafcaf4aa4efde906cf74649e04f213b", "filename": "src/test/ui/duplicate/dupe-symbols-2.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fduplicate%2Fdupe-symbols-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fduplicate%2Fdupe-symbols-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fduplicate%2Fdupe-symbols-2.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -6,13 +6,13 @@\n \n pub mod a {\n     #[no_mangle]\n-    pub extern fn fail() {\n+    pub extern \"C\" fn fail() {\n     }\n }\n \n pub mod b {\n     #[no_mangle]\n-    pub extern fn fail() {\n+    pub extern \"C\" fn fail() {\n     //~^ symbol `fail` is already defined\n     }\n }"}, {"sha": "b132eae4b88d73e93eb145b2117cc14f908b070d", "filename": "src/test/ui/duplicate/dupe-symbols-2.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fduplicate%2Fdupe-symbols-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fduplicate%2Fdupe-symbols-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fduplicate%2Fdupe-symbols-2.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,8 +1,8 @@\n error: symbol `fail` is already defined\n   --> $DIR/dupe-symbols-2.rs:15:5\n    |\n-LL |     pub extern fn fail() {\n-   |     ^^^^^^^^^^^^^^^^^^^^\n+LL |     pub extern \"C\" fn fail() {\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: aborting due to previous error\n "}, {"sha": "b64123389c2c16f7ea9401afd2e8e41397ef0037", "filename": "src/test/ui/empty/empty-linkname.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fempty%2Fempty-linkname.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fempty%2Fempty-linkname.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fempty%2Fempty-linkname.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,4 @@\n #[link(name = \"\")] //~ ERROR: given with empty name\n-extern {\n-}\n+extern \"C\" {}\n \n fn main() {}"}, {"sha": "d9cdaf83c698cf6be7b6ac9f995a261d102071ba", "filename": "src/test/ui/error-codes/E0044.rs", "status": "modified", "additions": 5, "deletions": 6, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0044.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0044.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0044.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,9 +1,8 @@\n-extern {\n+extern \"C\" {\n     fn sqrt<T>(f: T) -> T;\n-    //~^ ERROR foreign items may not have type parameters [E0044]\n-    //~| HELP replace the type parameters with concrete types\n-    //~| NOTE can't have type parameters\n+//~^ ERROR foreign items may not have type parameters [E0044]\n+//~| HELP replace the type parameters with concrete types\n+//~| NOTE can't have type parameters\n }\n \n-fn main() {\n-}\n+fn main() {}"}, {"sha": "d523507899fbcfd71f0fdf360d98fbdb94c57143", "filename": "src/test/ui/error-codes/E0130.rs", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0130.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0130.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0130.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,6 @@\n-extern {\n+extern \"C\" {\n     fn foo((a, b): (u32, u32));\n-    //~^ ERROR E0130\n+//~^ ERROR E0130\n }\n \n-fn main() {\n-}\n+fn main() {}"}, {"sha": "ff5478382cc902321ebed7eee8f0b9abdd52f568", "filename": "src/test/ui/error-codes/E0454.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0454.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0454.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0454.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-#[link(name = \"\")] extern {}\n+#[link(name = \"\")] extern \"C\" {}\n //~^ ERROR E0454\n \n fn main() {"}, {"sha": "6b62bef112fe74aa43801b68973fc02c09c0cb5f", "filename": "src/test/ui/error-codes/E0454.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0454.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0454.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0454.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n error[E0454]: `#[link(name = \"\")]` given with empty name\n   --> $DIR/E0454.rs:1:1\n    |\n-LL | #[link(name = \"\")] extern {}\n+LL | #[link(name = \"\")] extern \"C\" {}\n    | ^^^^^^^^^^^^^^^^^^ empty name given\n \n error: aborting due to previous error"}, {"sha": "35e7e84d4796d4a56aa4e74328e82e7eee2716c0", "filename": "src/test/ui/error-codes/E0458.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0458.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0458.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0458.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n-#[link(kind = \"wonderful_unicorn\")] extern {} //~ ERROR E0458\n-                                              //~| ERROR E0459\n+#[link(kind = \"wonderful_unicorn\")] extern \"C\" {} //~ ERROR E0458\n+                                                  //~| ERROR E0459\n \n fn main() {\n }"}, {"sha": "0f2fec029e78ddb22fdb2fbef6bcf35f99e8419f", "filename": "src/test/ui/error-codes/E0458.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0458.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0458.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0458.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,15 +1,15 @@\n error[E0458]: unknown kind: `wonderful_unicorn`\n   --> $DIR/E0458.rs:1:8\n    |\n-LL | #[link(kind = \"wonderful_unicorn\")] extern {}\n+LL | #[link(kind = \"wonderful_unicorn\")] extern \"C\" {}\n    | -------^^^^^^^^^^^^^^^^^^^^^^^^^^--\n    |        |\n    |        unknown kind\n \n error[E0459]: `#[link(...)]` specified without `name = \"foo\"`\n   --> $DIR/E0458.rs:1:1\n    |\n-LL | #[link(kind = \"wonderful_unicorn\")] extern {}\n+LL | #[link(kind = \"wonderful_unicorn\")] extern \"C\" {}\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ missing `name` argument\n \n error: aborting due to 2 previous errors"}, {"sha": "c56d8f0a8a84800227f2a59acd2a36457a3a93cd", "filename": "src/test/ui/error-codes/E0459.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0459.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0459.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0459.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-#[link(kind = \"dylib\")] extern {} //~ ERROR E0459\n+#[link(kind = \"dylib\")] extern \"C\" {} //~ ERROR E0459\n \n fn main() {\n }"}, {"sha": "4e0d51e87538ad04e1208d18b9662a29af053d9f", "filename": "src/test/ui/error-codes/E0459.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0459.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0459.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0459.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n error[E0459]: `#[link(...)]` specified without `name = \"foo\"`\n   --> $DIR/E0459.rs:1:1\n    |\n-LL | #[link(kind = \"dylib\")] extern {}\n+LL | #[link(kind = \"dylib\")] extern \"C\" {}\n    | ^^^^^^^^^^^^^^^^^^^^^^^ missing `name` argument\n \n error: aborting due to previous error"}, {"sha": "b71ba0ed88b9ff6a80e7c32df59a5dda14ebb001", "filename": "src/test/ui/error-codes/E0617.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0617.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ferror-codes%2FE0617.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0617.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-extern {\n+extern \"C\" {\n     fn printf(c: *const i8, ...);\n }\n "}, {"sha": "56256aa1927eebe0f3c07495a720bdedabfa6020", "filename": "src/test/ui/extern/auxiliary/extern-take-value.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fauxiliary%2Fextern-take-value.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fauxiliary%2Fextern-take-value.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fauxiliary%2Fextern-take-value.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n-pub extern fn f() -> i32 { 1 }\n-pub extern fn g() -> i32 { 2 }\n+pub extern \"C\" fn f() -> i32 { 1 }\n+pub extern \"C\" fn g() -> i32 { 2 }\n \n-pub fn get_f() -> extern fn() -> i32 { f }\n-pub fn get_g() -> extern fn() -> i32 { g }\n+pub fn get_f() -> extern \"C\" fn() -> i32 { f }\n+pub fn get_g() -> extern \"C\" fn() -> i32 { g }"}, {"sha": "e24cf9fdaa0c54b95ce213228e09da7a4ec39ad0", "filename": "src/test/ui/extern/auxiliary/extern_calling_convention.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fauxiliary%2Fextern_calling_convention.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fauxiliary%2Fextern_calling_convention.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fauxiliary%2Fextern_calling_convention.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -15,7 +15,7 @@ pub extern \"win64\" fn foo(a: isize, b: isize, c: isize, d: isize) {\n \n #[inline(never)]\n #[cfg(not(target_arch = \"x86_64\"))]\n-pub extern fn foo(a: isize, b: isize, c: isize, d: isize) {\n+pub extern \"C\" fn foo(a: isize, b: isize, c: isize, d: isize) {\n     assert_eq!(a, 1);\n     assert_eq!(b, 2);\n     assert_eq!(c, 3);"}, {"sha": "66e560501720c6bf8107a72e6f97c3dea96228c1", "filename": "src/test/ui/extern/extern-1.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-1.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,7 +2,7 @@\n #![allow(dead_code)]\n // pretty-expanded FIXME #23616\n \n-extern fn f() {\n+extern \"C\" fn f() {\n }\n \n pub fn main() {"}, {"sha": "1ddfc77a4c43a2fc9a8ee4bf73a1adc81cbd302f", "filename": "src/test/ui/extern/extern-compare-with-return-type.rs", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-compare-with-return-type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-compare-with-return-type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-compare-with-return-type.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,23 +3,23 @@\n #![allow(non_camel_case_types)]\n \n // `dbg!()` differentiates these functions to ensure they won't be merged.\n-extern fn voidret1() { dbg!() }\n-extern fn voidret2() { dbg!() }\n+extern \"C\" fn voidret1() { dbg!() }\n+extern \"C\" fn voidret2() { dbg!() }\n \n-extern fn uintret() -> usize { 22 }\n+extern \"C\" fn uintret() -> usize { 22 }\n \n-extern fn uintvoidret(_x: usize) {}\n+extern \"C\" fn uintvoidret(_x: usize) {}\n \n-extern fn uintuintuintuintret(x: usize, y: usize, z: usize) -> usize { x+y+z }\n-type uintuintuintuintret = extern fn(usize,usize,usize) -> usize;\n+extern \"C\" fn uintuintuintuintret(x: usize, y: usize, z: usize) -> usize { x+y+z }\n+type uintuintuintuintret = extern \"C\" fn(usize,usize,usize) -> usize;\n \n pub fn main() {\n-    assert!(voidret1 as extern fn() == voidret1 as extern fn());\n-    assert!(voidret1 as extern fn() != voidret2 as extern fn());\n+    assert!(voidret1 as extern \"C\" fn() == voidret1 as extern \"C\" fn());\n+    assert!(voidret1 as extern \"C\" fn() != voidret2 as extern \"C\" fn());\n \n-    assert!(uintret as extern fn() -> usize == uintret as extern fn() -> usize);\n+    assert!(uintret as extern \"C\" fn() -> usize == uintret as extern \"C\" fn() -> usize);\n \n-    assert!(uintvoidret as extern fn(usize) == uintvoidret as extern fn(usize));\n+    assert!(uintvoidret as extern \"C\" fn(usize) == uintvoidret as extern \"C\" fn(usize));\n \n     assert!(uintuintuintuintret as uintuintuintuintret ==\n             uintuintuintuintret as uintuintuintuintret);"}, {"sha": "bb1468a70fb1e7cc1470eb54044e078cab76fe83", "filename": "src/test/ui/extern/extern-main-fn.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-main-fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-main-fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-main-fn.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1 +1 @@\n-extern fn main() {} //~ ERROR: `main` function has wrong type [E0580]\n+extern \"C\" fn main() {} //~ ERROR: `main` function has wrong type [E0580]"}, {"sha": "136c957538248d5f9b0228630da50480b6820cfe", "filename": "src/test/ui/extern/extern-main-fn.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-main-fn.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-main-fn.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-main-fn.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,8 +1,8 @@\n error[E0580]: `main` function has wrong type\n   --> $DIR/extern-main-fn.rs:1:1\n    |\n-LL | extern fn main() {}\n-   | ^^^^^^^^^^^^^^^^ expected \"Rust\" fn, found \"C\" fn\n+LL | extern \"C\" fn main() {}\n+   | ^^^^^^^^^^^^^^^^^^^^ expected \"Rust\" fn, found \"C\" fn\n    |\n    = note: expected fn pointer `fn()`\n               found fn pointer `extern \"C\" fn()`"}, {"sha": "97559a68442199d4fd1e73a7689304356d50c406", "filename": "src/test/ui/extern/extern-methods.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-methods.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-methods.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-methods.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,7 +5,7 @@\n \n trait A {\n     extern \"fastcall\" fn test1(i: i32);\n-    extern fn test2(i: i32);\n+    extern \"C\" fn test2(i: i32);\n }\n \n struct S;\n@@ -19,7 +19,7 @@ impl A for S {\n     extern \"fastcall\" fn test1(i: i32) {\n         assert_eq!(i, 1);\n     }\n-    extern fn test2(i: i32) {\n+    extern \"C\" fn test2(i: i32) {\n         assert_eq!(i, 2);\n     }\n }"}, {"sha": "0b95045a03eb77be62781a62fb65f6ae2d119998", "filename": "src/test/ui/extern/extern-pub.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-pub.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-pub.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-pub.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,9 +1,8 @@\n // run-pass\n // pretty-expanded FIXME #23616\n \n-extern {\n+extern \"C\" {\n     pub fn free(p: *const u8);\n }\n \n-pub fn main() {\n-}\n+pub fn main() {}"}, {"sha": "7cea8be59215fc44ce99ac6bf75b711a435006a6", "filename": "src/test/ui/extern/extern-rust.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-rust.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-rust.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-rust.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,7 +5,7 @@\n pub struct Foo(u32);\n \n // ICE trigger, bad handling of differing types between rust and external ABIs\n-pub extern fn bar() -> Foo {\n+pub extern \"C\" fn bar() -> Foo {\n     Foo(0)\n }\n "}, {"sha": "4da049b7882128a5b0bee8807b85de87e3787c40", "filename": "src/test/ui/extern/extern-types-distinct-types.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-distinct-types.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-distinct-types.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-types-distinct-types.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n #![feature(extern_types)]\n \n-extern {\n+extern \"C\" {\n     type A;\n     type B;\n }\n@@ -9,4 +9,4 @@ fn foo(r: &A) -> &B {\n     r //~ ERROR mismatched types\n }\n \n-fn main() { }\n+fn main() {}"}, {"sha": "87eb3f6224004ecc653545e4ba3ff03f567e68df", "filename": "src/test/ui/extern/extern-types-manual-sync-send.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-manual-sync-send.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-manual-sync-send.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-types-manual-sync-send.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,15 +3,15 @@\n \n #![feature(extern_types)]\n \n-extern {\n+extern \"C\" {\n     type A;\n }\n \n-unsafe impl Sync for A { }\n-unsafe impl Send for A { }\n+unsafe impl Sync for A {}\n+unsafe impl Send for A {}\n \n-fn assert_sync<T: ?Sized + Sync>() { }\n-fn assert_send<T: ?Sized + Send>() { }\n+fn assert_sync<T: ?Sized + Sync>() {}\n+fn assert_send<T: ?Sized + Send>() {}\n \n fn main() {\n     assert_sync::<A>();"}, {"sha": "ba82caced7a4edbe28739e7989158dd22b6c4b4d", "filename": "src/test/ui/extern/extern-types-not-sync-send.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-not-sync-send.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-not-sync-send.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-types-not-sync-send.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,12 +2,12 @@\n \n #![feature(extern_types)]\n \n-extern {\n+extern \"C\" {\n     type A;\n }\n \n-fn assert_sync<T: ?Sized + Sync>() { }\n-fn assert_send<T: ?Sized + Send>() { }\n+fn assert_sync<T: ?Sized + Sync>() {}\n+fn assert_send<T: ?Sized + Send>() {}\n \n fn main() {\n     assert_sync::<A>();"}, {"sha": "547116fbbabedad76e5a19d00a74a8003538d2bd", "filename": "src/test/ui/extern/extern-types-not-sync-send.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-not-sync-send.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-not-sync-send.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-types-not-sync-send.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n error[E0277]: `A` cannot be shared between threads safely\n   --> $DIR/extern-types-not-sync-send.rs:13:19\n    |\n-LL | fn assert_sync<T: ?Sized + Sync>() { }\n+LL | fn assert_sync<T: ?Sized + Sync>() {}\n    |                            ---- required by this bound in `assert_sync`\n ...\n LL |     assert_sync::<A>();\n@@ -12,7 +12,7 @@ LL |     assert_sync::<A>();\n error[E0277]: `A` cannot be sent between threads safely\n   --> $DIR/extern-types-not-sync-send.rs:16:19\n    |\n-LL | fn assert_send<T: ?Sized + Send>() { }\n+LL | fn assert_send<T: ?Sized + Send>() {}\n    |                            ---- required by this bound in `assert_send`\n ...\n LL |     assert_send::<A>();"}, {"sha": "de6955bfaaa13645277a122a6ac6671146a3f794", "filename": "src/test/ui/extern/extern-types-pointer-cast.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-pointer-cast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-pointer-cast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-types-pointer-cast.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,10 +2,9 @@\n #![allow(dead_code)]\n // Test that pointers to extern types can be cast from/to usize,\n // despite being !Sized.\n-\n #![feature(extern_types)]\n \n-extern {\n+extern \"C\" {\n     type A;\n }\n "}, {"sha": "3b02ea28eaa28d44beac59efcc0935546214d33b", "filename": "src/test/ui/extern/extern-types-size_of_val.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-size_of_val.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-size_of_val.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-types-size_of_val.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,16 +1,14 @@\n // run-pass\n #![feature(extern_types)]\n \n-use std::mem::{size_of_val, align_of_val};\n+use std::mem::{align_of_val, size_of_val};\n \n-extern {\n+extern \"C\" {\n     type A;\n }\n \n fn main() {\n-    let x: &A = unsafe {\n-        &*(1usize as *const A)\n-    };\n+    let x: &A = unsafe { &*(1usize as *const A) };\n \n     assert_eq!(size_of_val(x), 0);\n     assert_eq!(align_of_val(x), 1);"}, {"sha": "b85fc4886abe00da1243e8a7dd052389bf1b2361", "filename": "src/test/ui/extern/extern-types-thin-pointer.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-thin-pointer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-thin-pointer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-types-thin-pointer.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,12 +2,11 @@\n #![allow(dead_code)]\n // Test that pointers and references to extern types are thin, ie they have the same size and\n // alignment as a pointer to ().\n-\n #![feature(extern_types)]\n \n use std::mem::{align_of, size_of};\n \n-extern {\n+extern \"C\" {\n     type A;\n }\n "}, {"sha": "656101ed535b32e963688a4568a3ebc43f49ff97", "filename": "src/test/ui/extern/extern-types-trait-impl.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-trait-impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-trait-impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-types-trait-impl.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,22 +1,21 @@\n // run-pass\n #![allow(dead_code)]\n // Test that traits can be implemented for extern types.\n-\n #![feature(extern_types)]\n \n-extern {\n+extern \"C\" {\n     type A;\n }\n \n trait Foo {\n-    fn foo(&self) { }\n+    fn foo(&self) {}\n }\n \n impl Foo for A {\n-    fn foo(&self) { }\n+    fn foo(&self) {}\n }\n \n-fn assert_foo<T: ?Sized + Foo>() { }\n+fn assert_foo<T: ?Sized + Foo>() {}\n \n fn use_foo<T: ?Sized + Foo>(x: &dyn Foo) {\n     x.foo();"}, {"sha": "94a222a7e7e011767de973d5c685a97d07c370a8", "filename": "src/test/ui/extern/extern-types-unsized.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-unsized.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-unsized.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-types-unsized.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,7 +2,7 @@\n \n #![feature(extern_types)]\n \n-extern {\n+extern \"C\" {\n     type A;\n }\n \n@@ -16,7 +16,7 @@ struct Bar<T: ?Sized> {\n     tail: T,\n }\n \n-fn assert_sized<T>() { }\n+fn assert_sized<T>() {}\n \n fn main() {\n     assert_sized::<A>();"}, {"sha": "278db4565572020b709f3c87dd75bbac7c9b80ef", "filename": "src/test/ui/extern/extern-types-unsized.stderr", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-unsized.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-types-unsized.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-types-unsized.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n error[E0277]: the size for values of type `A` cannot be known at compilation time\n   --> $DIR/extern-types-unsized.rs:22:20\n    |\n-LL | fn assert_sized<T>() { }\n+LL | fn assert_sized<T>() {}\n    |                 - required by this bound in `assert_sized`\n ...\n LL |     assert_sized::<A>();\n@@ -10,13 +10,13 @@ LL |     assert_sized::<A>();\n    = help: the trait `Sized` is not implemented for `A`\n help: consider relaxing the implicit `Sized` restriction\n    |\n-LL | fn assert_sized<T: ?Sized>() { }\n+LL | fn assert_sized<T: ?Sized>() {}\n    |                  ^^^^^^^^\n \n error[E0277]: the size for values of type `A` cannot be known at compilation time\n   --> $DIR/extern-types-unsized.rs:25:5\n    |\n-LL | fn assert_sized<T>() { }\n+LL | fn assert_sized<T>() {}\n    |                 - required by this bound in `assert_sized`\n ...\n LL |     assert_sized::<Foo>();\n@@ -26,13 +26,13 @@ LL |     assert_sized::<Foo>();\n    = note: required because it appears within the type `Foo`\n help: consider relaxing the implicit `Sized` restriction\n    |\n-LL | fn assert_sized<T: ?Sized>() { }\n+LL | fn assert_sized<T: ?Sized>() {}\n    |                  ^^^^^^^^\n \n error[E0277]: the size for values of type `A` cannot be known at compilation time\n   --> $DIR/extern-types-unsized.rs:28:5\n    |\n-LL | fn assert_sized<T>() { }\n+LL | fn assert_sized<T>() {}\n    |                 - required by this bound in `assert_sized`\n ...\n LL |     assert_sized::<Bar<A>>();\n@@ -42,13 +42,13 @@ LL |     assert_sized::<Bar<A>>();\n    = note: required because it appears within the type `Bar<A>`\n help: consider relaxing the implicit `Sized` restriction\n    |\n-LL | fn assert_sized<T: ?Sized>() { }\n+LL | fn assert_sized<T: ?Sized>() {}\n    |                  ^^^^^^^^\n \n error[E0277]: the size for values of type `A` cannot be known at compilation time\n   --> $DIR/extern-types-unsized.rs:31:5\n    |\n-LL | fn assert_sized<T>() { }\n+LL | fn assert_sized<T>() {}\n    |                 - required by this bound in `assert_sized`\n ...\n LL |     assert_sized::<Bar<Bar<A>>>();\n@@ -59,7 +59,7 @@ LL |     assert_sized::<Bar<Bar<A>>>();\n    = note: required because it appears within the type `Bar<Bar<A>>`\n help: consider relaxing the implicit `Sized` restriction\n    |\n-LL | fn assert_sized<T: ?Sized>() { }\n+LL | fn assert_sized<T: ?Sized>() {}\n    |                  ^^^^^^^^\n \n error: aborting due to 4 previous errors"}, {"sha": "337865ec18d51522a682f97d623ac2a977611c8b", "filename": "src/test/ui/extern/extern-wrong-value-type.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-wrong-value-type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fextern-wrong-value-type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-wrong-value-type.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-extern fn f() {\n+extern \"C\" fn f() {\n }\n \n fn is_fn<F>(_: F) where F: Fn() {}"}, {"sha": "4439b4685251f5556e813f8aa297a267fb5a22d2", "filename": "src/test/ui/extern/issue-10025.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fissue-10025.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fissue-10025.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fissue-10025.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n // run-pass\n-#![allow(dead_code)]\n // pretty-expanded FIXME #23616\n+#![allow(dead_code)]\n \n unsafe extern fn foo() {}\n unsafe extern \"C\" fn bar() {}"}, {"sha": "5f886ff57379a9566328ab20d099e27c4110c683", "filename": "src/test/ui/extern/issue-36122-accessing-externed-dst.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fissue-36122-accessing-externed-dst.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fextern%2Fissue-36122-accessing-externed-dst.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fissue-36122-accessing-externed-dst.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n fn main() {\n-    extern {\n+    extern \"C\" {\n         static symbol: [usize]; //~ ERROR: the size for values of type\n     }\n     println!(\"{}\", symbol[0]);"}, {"sha": "b600ad23eee6405182842b61de3956975d8b2034", "filename": "src/test/ui/feature-gates/feature-gate-cfg-target-thread-local.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-cfg-target-thread-local.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-cfg-target-thread-local.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-cfg-target-thread-local.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,10 +5,9 @@\n \n extern crate cfg_target_thread_local;\n \n-extern {\n+extern \"C\" {\n     #[cfg_attr(target_thread_local, thread_local)]\n     //~^ `cfg(target_thread_local)` is experimental and subject to change\n-\n     static FOO: u32;\n }\n "}, {"sha": "103f8eed6f3c0d0bffda7e754c376f534af7c06a", "filename": "src/test/ui/feature-gates/feature-gate-extern_types.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-extern_types.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-extern_types.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-extern_types.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-extern {\n+extern \"C\" {\n     type T; //~ ERROR extern types are experimental\n }\n "}, {"sha": "9f3d783ccd69cbbdc2c56b2ae738f806e5f21cf2", "filename": "src/test/ui/feature-gates/feature-gate-ffi_const.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-ffi_const.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-ffi_const.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-ffi_const.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n #![crate_type = \"lib\"]\n \n-extern {\n+extern \"C\" {\n     #[ffi_const] //~ ERROR the `#[ffi_const]` attribute is an experimental feature\n     pub fn foo();\n }"}, {"sha": "b0dfa01ff4c20e438dbee6c57920819725e44d61", "filename": "src/test/ui/feature-gates/feature-gate-ffi_pure.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-ffi_pure.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-ffi_pure.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-ffi_pure.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n #![crate_type = \"lib\"]\n \n-extern {\n+extern \"C\" {\n     #[ffi_pure] //~ ERROR the `#[ffi_pure]` attribute is an experimental feature\n     pub fn foo();\n }"}, {"sha": "f354534356c212dd804d38ac3969a6b52ac62346", "filename": "src/test/ui/feature-gates/feature-gate-ffi_returns_twice.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-ffi_returns_twice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-ffi_returns_twice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-ffi_returns_twice.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n #![crate_type = \"lib\"]\n \n-extern {\n+extern \"C\" {\n     #[ffi_returns_twice] //~ ERROR the `#[ffi_returns_twice]` attribute is an experimental feature\n     pub fn foo();\n }"}, {"sha": "e1c651f46fb4989d9ade586f2aa54193d764733b", "filename": "src/test/ui/feature-gates/feature-gate-link_args.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-link_args.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-link_args.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-link_args.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,13 +5,12 @@\n // sidestep warning (which is correct, but misleading for\n // purposes of this test)\n #![allow(unused_attributes)]\n-\n #![link_args = \"-l unexpected_use_as_inner_attr_on_mod\"]\n //~^ ERROR the `link_args` attribute is experimental\n \n #[link_args = \"-l expected_use_case\"]\n //~^ ERROR the `link_args` attribute is experimental\n-extern {}\n+extern \"C\" {}\n \n #[link_args = \"-l unexected_use_on_non_extern_item\"]\n //~^ ERROR: the `link_args` attribute is experimental"}, {"sha": "ae4918f5c9f54e62ba8b8c4583a1078243fb247b", "filename": "src/test/ui/feature-gates/feature-gate-link_args.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-link_args.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-link_args.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-link_args.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n error[E0658]: the `link_args` attribute is experimental and not portable across platforms, it is recommended to use `#[link(name = \"foo\")] instead\n-  --> $DIR/feature-gate-link_args.rs:12:1\n+  --> $DIR/feature-gate-link_args.rs:11:1\n    |\n LL | #[link_args = \"-l expected_use_case\"]\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n@@ -8,7 +8,7 @@ LL | #[link_args = \"-l expected_use_case\"]\n    = help: add `#![feature(link_args)]` to the crate attributes to enable\n \n error[E0658]: the `link_args` attribute is experimental and not portable across platforms, it is recommended to use `#[link(name = \"foo\")] instead\n-  --> $DIR/feature-gate-link_args.rs:16:1\n+  --> $DIR/feature-gate-link_args.rs:15:1\n    |\n LL | #[link_args = \"-l unexected_use_on_non_extern_item\"]\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n@@ -17,7 +17,7 @@ LL | #[link_args = \"-l unexected_use_on_non_extern_item\"]\n    = help: add `#![feature(link_args)]` to the crate attributes to enable\n \n error[E0658]: the `link_args` attribute is experimental and not portable across platforms, it is recommended to use `#[link(name = \"foo\")] instead\n-  --> $DIR/feature-gate-link_args.rs:9:1\n+  --> $DIR/feature-gate-link_args.rs:8:1\n    |\n LL | #![link_args = \"-l unexpected_use_as_inner_attr_on_mod\"]\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"}, {"sha": "d30ee3bcfdb1473db34241ae9317441402df7cb3", "filename": "src/test/ui/feature-gates/feature-gate-link_cfg.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-link_cfg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-link_cfg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-link_cfg.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n #[link(name = \"foo\", cfg(foo))]\n //~^ ERROR: is unstable\n-extern {}\n+extern \"C\" {}\n \n fn main() {}"}, {"sha": "7391ea94ebc04934278245fe49242878af28d672", "filename": "src/test/ui/feature-gates/feature-gate-link_llvm_intrinsics.rs", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-link_llvm_intrinsics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-link_llvm_intrinsics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-link_llvm_intrinsics.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,8 +1,7 @@\n-extern {\n+extern \"C\" {\n     #[link_name = \"llvm.sqrt.f32\"]\n     fn sqrt(x: f32) -> f32;\n-    //~^ ERROR linking to LLVM intrinsics is experimental\n+//~^ ERROR linking to LLVM intrinsics is experimental\n }\n \n-fn main(){\n-}\n+fn main() {}"}, {"sha": "15b8d442aeb9a79a7017a0e4a63ad5633a7463ce", "filename": "src/test/ui/feature-gates/feature-gate-linkage.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-linkage.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-linkage.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-linkage.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-extern {\n+extern \"C\" {\n     #[linkage = \"extern_weak\"] static foo: isize;\n     //~^ ERROR: the `linkage` attribute is experimental and not portable\n }"}, {"sha": "5cc04ad5cdfdc4a3e146e80c68916ba6e3eace37", "filename": "src/test/ui/feature-gates/feature-gate-non_ascii_idents.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-non_ascii_idents.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-non_ascii_idents.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-non_ascii_idents.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -26,7 +26,7 @@ enum B\u00e4r { //~ ERROR non-ascii idents\n     }\n }\n \n-extern {\n+extern \"C\" {\n     fn q\u00fcx();  //~ ERROR non-ascii idents\n }\n "}, {"sha": "abffa4a10010d5bc9b1278c754c3fe322b2e3177", "filename": "src/test/ui/feature-gates/feature-gate-simd-ffi.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-simd-ffi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-simd-ffi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-simd-ffi.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,7 +5,7 @@\n #[derive(Copy, Clone)]\n struct LocalSimd(u8, u8);\n \n-extern {\n+extern \"C\" {\n     fn baz() -> LocalSimd; //~ ERROR use of SIMD type\n     fn qux(x: LocalSimd); //~ ERROR use of SIMD type\n }"}, {"sha": "05c52f9dbead2e86370dd7457e06247be4c4dcd3", "filename": "src/test/ui/feature-gates/feature-gate-static-nobundle.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-static-nobundle.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-static-nobundle.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-static-nobundle.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n-#[link(name=\"foo\", kind=\"static-nobundle\")]\n+#[link(name = \"foo\", kind = \"static-nobundle\")]\n //~^ ERROR: kind=\"static-nobundle\" is unstable\n-extern {}\n+extern \"C\" {}\n \n fn main() {}"}, {"sha": "3a3c86c34295dde938a665da62ae3bc834e0edb1", "filename": "src/test/ui/feature-gates/feature-gate-static-nobundle.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-static-nobundle.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-static-nobundle.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-static-nobundle.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,8 +1,8 @@\n error[E0658]: kind=\"static-nobundle\" is unstable\n   --> $DIR/feature-gate-static-nobundle.rs:1:1\n    |\n-LL | #[link(name=\"foo\", kind=\"static-nobundle\")]\n-   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL | #[link(name = \"foo\", kind = \"static-nobundle\")]\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n    = note: see issue #37403 <https://github.com/rust-lang/rust/issues/37403> for more information\n    = help: add `#![feature(static_nobundle)]` to the crate attributes to enable"}, {"sha": "cd348ded4d7ce29ee3df89bfa69818bf46f988e1", "filename": "src/test/ui/feature-gates/feature-gate-unwind-attributes.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-unwind-attributes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-unwind-attributes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-unwind-attributes.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,12 +3,12 @@\n \n #![crate_type = \"lib\"]\n \n-extern {\n-// CHECK: Function Attrs: nounwind\n-// CHECK-NEXT: declare void @extern_fn\n+extern \"C\" {\n+    // CHECK: Function Attrs: nounwind\n+    // CHECK-NEXT: declare void @extern_fn\n     fn extern_fn();\n-// CHECK-NOT: Function Attrs: nounwind\n-// CHECK: declare void @unwinding_extern_fn\n+    // CHECK-NOT: Function Attrs: nounwind\n+    // CHECK: declare void @unwinding_extern_fn\n     #[unwind(allowed)] //~ ERROR the `#[unwind]` attribute is an experimental feature\n     fn unwinding_extern_fn();\n }"}, {"sha": "21f40524f63dfd04dccc5799721b6a65f06ed14f", "filename": "src/test/ui/feature-gates/issue-43106-gating-of-builtin-attrs.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Fissue-43106-gating-of-builtin-attrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Fissue-43106-gating-of-builtin-attrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Fissue-43106-gating-of-builtin-attrs.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -536,7 +536,7 @@ mod link_name {\n     //~^ WARN attribute should be applied to a foreign function or static [unused_attributes]\n     //~| WARN this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n     //~| HELP try `#[link(name = \"1900\")]` instead\n-    extern { }\n+    extern \"C\" { }\n     //~^ NOTE not a foreign function or static\n \n     mod inner { #![link_name=\"1900\"] }"}, {"sha": "c908d2589cf49b2d4dfe0f38c05e3a7621b000b0", "filename": "src/test/ui/feature-gates/issue-43106-gating-of-builtin-attrs.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Fissue-43106-gating-of-builtin-attrs.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffeature-gates%2Fissue-43106-gating-of-builtin-attrs.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Fissue-43106-gating-of-builtin-attrs.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -403,8 +403,8 @@ warning: attribute should be applied to a foreign function or static\n LL |     #[link_name = \"1900\"]\n    |     ^^^^^^^^^^^^^^^^^^^^^\n ...\n-LL |     extern { }\n-   |     ---------- not a foreign function or static\n+LL |     extern \"C\" { }\n+   |     -------------- not a foreign function or static\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n help: try `#[link(name = \"1900\")]` instead"}, {"sha": "82fe8a9c91dd1f79ed8b5adea216497164c7de58", "filename": "src/test/ui/ffi_const2.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fffi_const2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fffi_const2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fffi_const2.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n #![feature(ffi_const, ffi_pure)]\n \n-extern {\n+extern \"C\" {\n     #[ffi_pure] //~ ERROR `#[ffi_const]` function cannot be `#[ffi_pure]`\n     #[ffi_const]\n     pub fn baz();"}, {"sha": "abbe462021ed74c14b8a6b0912123e1afcb4473e", "filename": "src/test/ui/foreign-unsafe-fn-called.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fforeign-unsafe-fn-called.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fforeign-unsafe-fn-called.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fforeign-unsafe-fn-called.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n mod test {\n-    extern {\n+    extern \"C\" {\n         pub fn free();\n     }\n }"}, {"sha": "f6d820594f966a811af5a2e04c4f3026c9de5cfa", "filename": "src/test/ui/foreign/foreign-fn-linkname.rs", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fforeign%2Fforeign-fn-linkname.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fforeign%2Fforeign-fn-linkname.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fforeign%2Fforeign-fn-linkname.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -10,7 +10,7 @@ use std::ffi::CString;\n mod mlibc {\n     use libc::{c_char, size_t};\n \n-    extern {\n+    extern \"C\" {\n         #[link_name = \"strlen\"]\n         pub fn my_strlen(str: *const c_char) -> size_t;\n     }\n@@ -19,9 +19,7 @@ mod mlibc {\n fn strlen(str: String) -> usize {\n     // C string is terminated with a zero\n     let s = CString::new(str).unwrap();\n-    unsafe {\n-        mlibc::my_strlen(s.as_ptr()) as usize\n-    }\n+    unsafe { mlibc::my_strlen(s.as_ptr()) as usize }\n }\n \n pub fn main() {"}, {"sha": "2d01d32042563a13910753f956435544bf61337b", "filename": "src/test/ui/foreign/foreign-int-types.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fforeign%2Fforeign-int-types.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fforeign%2Fforeign-int-types.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fforeign%2Fforeign-int-types.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,11 +3,10 @@\n #![allow(dead_code)]\n \n mod xx {\n-    extern {\n+    extern \"C\" {\n         pub fn strlen(str: *const u8) -> usize;\n         pub fn foo(x: isize, y: usize);\n     }\n }\n \n-fn main() {\n-}\n+fn main() {}"}, {"sha": "7d79c30f469063422fb4fda7a4c70013307190df", "filename": "src/test/ui/foreign/foreign-mod-unused-const.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fforeign%2Fforeign-mod-unused-const.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fforeign%2Fforeign-mod-unused-const.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fforeign%2Fforeign-mod-unused-const.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,10 +3,9 @@\n // pretty-expanded FIXME #23616\n \n mod foo {\n-    extern {\n+    extern \"C\" {\n         pub static errno: u32;\n     }\n }\n \n-pub fn main() {\n-}\n+pub fn main() {}"}, {"sha": "df431f2999c8ec804bc26217a3ddad3ba5ca62c8", "filename": "src/test/ui/foreign/foreign2.rs", "status": "modified", "additions": 5, "deletions": 6, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fforeign%2Fforeign2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fforeign%2Fforeign2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fforeign%2Fforeign2.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,29 +2,28 @@\n #![allow(dead_code)]\n // ignore-wasm32-bare no libc to test ffi with\n // pretty-expanded FIXME #23616\n-\n #![feature(rustc_private)]\n \n extern crate libc;\n \n mod bar {\n-    extern {}\n+    extern \"C\" {}\n }\n \n mod zed {\n-    extern {}\n+    extern \"C\" {}\n }\n \n mod mlibc {\n     use libc::{c_int, c_void, size_t, ssize_t};\n \n-    extern {\n+    extern \"C\" {\n         pub fn write(fd: c_int, buf: *const c_void, count: size_t) -> ssize_t;\n     }\n }\n \n mod baz {\n-    extern {}\n+    extern \"C\" {}\n }\n \n-pub fn main() { }\n+pub fn main() {}"}, {"sha": "ace9fbdfd0c59e8376fcd74eecac0027de16109e", "filename": "src/test/ui/functions-closures/auxiliary/fn-abi.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffunctions-closures%2Fauxiliary%2Ffn-abi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffunctions-closures%2Fauxiliary%2Ffn-abi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffunctions-closures%2Fauxiliary%2Ffn-abi.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,2 +1,2 @@\n #[no_mangle]\n-pub extern fn foo() {}\n+pub extern \"C\" fn foo() {}"}, {"sha": "ac3a4be3346e31110e6f61356c6d6714a76db88c", "filename": "src/test/ui/functions-closures/fn-abi.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffunctions-closures%2Ffn-abi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Ffunctions-closures%2Ffn-abi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffunctions-closures%2Ffn-abi.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -7,12 +7,12 @@\n \n extern crate fn_abi;\n \n-extern {\n+extern \"C\" {\n     fn foo();\n }\n \n pub fn main() {\n     // Will only type check if the type of _p and the decl of foo use the\n     // same ABI\n-    let _p: unsafe extern fn() = foo;\n+    let _p: unsafe extern \"C\" fn() = foo;\n }"}, {"sha": "c42744808c3946c48acfc3f079d6a5a89e81ab5e", "filename": "src/test/ui/generics/generic-extern-lifetime.rs", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-extern-lifetime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-extern-lifetime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-extern-lifetime.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,15 +1,15 @@\n // Test to make sure the names of the lifetimes are correctly resolved\n // in extern blocks.\n \n-extern {\n-   pub fn life<'a>(x:&'a i32);\n-   pub fn life2<'b>(x:&'a i32, y:&'b i32); //~ ERROR use of undeclared lifetime name `'a`\n-   pub fn life3<'a>(x:&'a i32, y:&i32) -> &'a i32;\n-   pub fn life4<'b>(x: for<'c> fn(&'a i32)); //~ ERROR use of undeclared lifetime name `'a`\n-   pub fn life5<'b>(x: for<'c> fn(&'b i32));\n-   pub fn life6<'b>(x: for<'c> fn(&'c i32));\n-   pub fn life7<'b>() -> for<'c> fn(&'a i32); //~ ERROR use of undeclared lifetime name `'a`\n-   pub fn life8<'b>() -> for<'c> fn(&'b i32);\n-   pub fn life9<'b>() -> for<'c> fn(&'c i32);\n+extern \"C\" {\n+    pub fn life<'a>(x: &'a i32);\n+    pub fn life2<'b>(x: &'a i32, y: &'b i32); //~ ERROR use of undeclared lifetime name `'a`\n+    pub fn life3<'a>(x: &'a i32, y: &i32) -> &'a i32;\n+    pub fn life4<'b>(x: for<'c> fn(&'a i32)); //~ ERROR use of undeclared lifetime name `'a`\n+    pub fn life5<'b>(x: for<'c> fn(&'b i32));\n+    pub fn life6<'b>(x: for<'c> fn(&'c i32));\n+    pub fn life7<'b>() -> for<'c> fn(&'a i32); //~ ERROR use of undeclared lifetime name `'a`\n+    pub fn life8<'b>() -> for<'c> fn(&'b i32);\n+    pub fn life9<'b>() -> for<'c> fn(&'c i32);\n }\n fn main() {}"}, {"sha": "3c9ed7a9dec081894eb70e2abdcec7e14629aa40", "filename": "src/test/ui/generics/generic-extern-lifetime.stderr", "status": "modified", "additions": 13, "deletions": 13, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-extern-lifetime.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-extern-lifetime.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-extern-lifetime.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,32 +1,32 @@\n error[E0261]: use of undeclared lifetime name `'a`\n-  --> $DIR/generic-extern-lifetime.rs:6:24\n+  --> $DIR/generic-extern-lifetime.rs:6:26\n    |\n-LL |    pub fn life2<'b>(x:&'a i32, y:&'b i32);\n-   |                        ^^ undeclared lifetime\n+LL |     pub fn life2<'b>(x: &'a i32, y: &'b i32);\n+   |                          ^^ undeclared lifetime\n \n error[E0261]: use of undeclared lifetime name `'a`\n-  --> $DIR/generic-extern-lifetime.rs:8:36\n+  --> $DIR/generic-extern-lifetime.rs:8:37\n    |\n-LL |    pub fn life4<'b>(x: for<'c> fn(&'a i32));\n-   |                                    ^^ undeclared lifetime\n+LL |     pub fn life4<'b>(x: for<'c> fn(&'a i32));\n+   |                                     ^^ undeclared lifetime\n    |\n    = note: for more information on higher-ranked polymorphism, visit https://doc.rust-lang.org/nomicon/hrtb.html\n help: consider making the type lifetime-generic with a new `'a` lifetime\n    |\n-LL |    pub fn life4<'b>(x: for<'c, 'a> fn(&'a i32));\n-   |                              ^^^^\n+LL |     pub fn life4<'b>(x: for<'c, 'a> fn(&'a i32));\n+   |                               ^^^^\n \n error[E0261]: use of undeclared lifetime name `'a`\n-  --> $DIR/generic-extern-lifetime.rs:11:38\n+  --> $DIR/generic-extern-lifetime.rs:11:39\n    |\n-LL |    pub fn life7<'b>() -> for<'c> fn(&'a i32);\n-   |                                      ^^ undeclared lifetime\n+LL |     pub fn life7<'b>() -> for<'c> fn(&'a i32);\n+   |                                       ^^ undeclared lifetime\n    |\n    = note: for more information on higher-ranked polymorphism, visit https://doc.rust-lang.org/nomicon/hrtb.html\n help: consider making the type lifetime-generic with a new `'a` lifetime\n    |\n-LL |    pub fn life7<'b>() -> for<'c, 'a> fn(&'a i32);\n-   |                                ^^^^\n+LL |     pub fn life7<'b>() -> for<'c, 'a> fn(&'a i32);\n+   |                                 ^^^^\n \n error: aborting due to 3 previous errors\n "}, {"sha": "3690d6fd07d2916b2a31de96441ca810a7a5ae24", "filename": "src/test/ui/generics/generic-extern.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-extern.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-extern.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-extern.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-extern {\n+extern \"C\" {\n     fn foo<T>(); //~ ERROR foreign items may not have type parameters\n }\n "}, {"sha": "207d8a91b00289ac8e47baf34b48d115a29fd403", "filename": "src/test/ui/generics/generic-no-mangle.fixed", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-no-mangle.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-no-mangle.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-no-mangle.fixed?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -6,7 +6,7 @@\n pub fn foo<T>() {} //~ ERROR functions generic over types or consts must be mangled\n \n \n-pub extern fn bar<T>() {} //~ ERROR functions generic over types or consts must be mangled\n+pub extern \"C\" fn bar<T>() {} //~ ERROR functions generic over types or consts must be mangled\n \n #[no_mangle]\n pub fn baz(x: &i32) -> &i32 { x }"}, {"sha": "146896cdc3d024f66fb42f17352800de86a4a897", "filename": "src/test/ui/generics/generic-no-mangle.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-no-mangle.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-no-mangle.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-no-mangle.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -6,7 +6,7 @@\n pub fn foo<T>() {} //~ ERROR functions generic over types or consts must be mangled\n \n #[no_mangle]\n-pub extern fn bar<T>() {} //~ ERROR functions generic over types or consts must be mangled\n+pub extern \"C\" fn bar<T>() {} //~ ERROR functions generic over types or consts must be mangled\n \n #[no_mangle]\n pub fn baz(x: &i32) -> &i32 { x }"}, {"sha": "b437417c0b180c5f76dde70062d30d8df1675b7d", "filename": "src/test/ui/generics/generic-no-mangle.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-no-mangle.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-no-mangle.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fgenerics%2Fgeneric-no-mangle.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -17,8 +17,8 @@ error: functions generic over types or consts must be mangled\n    |\n LL | #[no_mangle]\n    | ------------ help: remove this attribute\n-LL | pub extern fn bar<T>() {}\n-   | ^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL | pub extern \"C\" fn bar<T>() {}\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: aborting due to 2 previous errors\n "}, {"sha": "2031196ab215eb4b240780d8d283e93052467621", "filename": "src/test/ui/hashmap/hashmap-memory.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fhashmap%2Fhashmap-memory.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fhashmap%2Fhashmap-memory.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fhashmap%2Fhashmap-memory.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -23,7 +23,7 @@ mod map_reduce {\n \n     pub type putter<'a> = Box<dyn FnMut(String, String) + 'a>;\n \n-    pub type mapper = extern fn(String, putter);\n+    pub type mapper = extern \"C\" fn(String, putter);\n \n     enum ctrl_proto { find_reducer(Vec<u8>, Sender<isize>), mapper_done, }\n "}, {"sha": "904b77117dafcff73d4195d39c5c384904e18c53", "filename": "src/test/ui/imports/glob-resolve1.rs", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fimports%2Fglob-resolve1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fimports%2Fglob-resolve1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimports%2Fglob-resolve1.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,11 +5,15 @@ use bar::*;\n mod bar {\n     use self::fpriv as import;\n     fn fpriv() {}\n-    extern {\n+    extern \"C\" {\n         fn epriv();\n     }\n-    enum A { A1 }\n-    pub enum B { B1 }\n+    enum A {\n+        A1,\n+    }\n+    pub enum B {\n+        B1,\n+    }\n \n     struct C;\n "}, {"sha": "7629cede7a45fc14e1c651ae1e06f061cdaec8ec", "filename": "src/test/ui/imports/glob-resolve1.stderr", "status": "modified", "additions": 16, "deletions": 14, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fimports%2Fglob-resolve1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fimports%2Fglob-resolve1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimports%2Fglob-resolve1.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n error[E0425]: cannot find function `fpriv` in this scope\n-  --> $DIR/glob-resolve1.rs:22:5\n+  --> $DIR/glob-resolve1.rs:26:5\n    |\n LL |     fpriv();\n    |     ^^^^^ not found in this scope\n@@ -10,7 +10,7 @@ LL | use bar::fpriv;\n    |\n \n error[E0425]: cannot find function `epriv` in this scope\n-  --> $DIR/glob-resolve1.rs:23:5\n+  --> $DIR/glob-resolve1.rs:27:5\n    |\n LL |     epriv();\n    |     ^^^^^ not found in this scope\n@@ -21,23 +21,25 @@ LL | use bar::epriv;\n    |\n \n error[E0423]: expected value, found enum `B`\n-  --> $DIR/glob-resolve1.rs:24:5\n+  --> $DIR/glob-resolve1.rs:28:5\n    |\n LL |     B;\n    |     ^\n    |\n note: the enum is defined here\n-  --> $DIR/glob-resolve1.rs:12:5\n+  --> $DIR/glob-resolve1.rs:14:5\n    |\n-LL |     pub enum B { B1 }\n-   |     ^^^^^^^^^^^^^^^^^\n+LL | /     pub enum B {\n+LL | |         B1,\n+LL | |     }\n+   | |_____^\n help: you might have meant to use the following enum variant\n    |\n LL |     B::B1;\n    |     ^^^^^\n \n error[E0425]: cannot find value `C` in this scope\n-  --> $DIR/glob-resolve1.rs:25:5\n+  --> $DIR/glob-resolve1.rs:29:5\n    |\n LL |     C;\n    |     ^ not found in this scope\n@@ -48,7 +50,7 @@ LL | use bar::C;\n    |\n \n error[E0425]: cannot find function `import` in this scope\n-  --> $DIR/glob-resolve1.rs:26:5\n+  --> $DIR/glob-resolve1.rs:30:5\n    |\n LL |     import();\n    |     ^^^^^^ not found in this scope\n@@ -59,9 +61,9 @@ LL | use other::import;\n    |\n \n error[E0412]: cannot find type `A` in this scope\n-  --> $DIR/glob-resolve1.rs:28:11\n+  --> $DIR/glob-resolve1.rs:32:11\n    |\n-LL |     pub enum B { B1 }\n+LL |     pub enum B {\n    |     ---------- similarly named enum `B` defined here\n ...\n LL |     foo::<A>();\n@@ -77,9 +79,9 @@ LL | use bar::A;\n    |\n \n error[E0412]: cannot find type `C` in this scope\n-  --> $DIR/glob-resolve1.rs:29:11\n+  --> $DIR/glob-resolve1.rs:33:11\n    |\n-LL |     pub enum B { B1 }\n+LL |     pub enum B {\n    |     ---------- similarly named enum `B` defined here\n ...\n LL |     foo::<C>();\n@@ -95,9 +97,9 @@ LL | use bar::C;\n    |\n \n error[E0412]: cannot find type `D` in this scope\n-  --> $DIR/glob-resolve1.rs:30:11\n+  --> $DIR/glob-resolve1.rs:34:11\n    |\n-LL |     pub enum B { B1 }\n+LL |     pub enum B {\n    |     ---------- similarly named enum `B` defined here\n ...\n LL |     foo::<D>();"}, {"sha": "a77aa5a71553ae6cc83e51d4cdf1e15dc27a0f53", "filename": "src/test/ui/issues/auxiliary/issue-13620-1.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fauxiliary%2Fissue-13620-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fauxiliary%2Fissue-13620-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fauxiliary%2Fissue-13620-1.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,8 +1,8 @@\n pub struct Foo {\n-    pub foo: extern fn()\n+    pub foo: extern \"C\" fn()\n }\n \n-extern fn the_foo() {}\n+extern \"C\" fn the_foo() {}\n \n pub const FOO: Foo = Foo {\n     foo: the_foo"}, {"sha": "6ff26b47ea64f64fbccce582187c948fba71ca0a", "filename": "src/test/ui/issues/auxiliary/issue-15562.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fauxiliary%2Fissue-15562.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fauxiliary%2Fissue-15562.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fauxiliary%2Fissue-15562.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n #![crate_type = \"lib\"]\n \n-extern {\n+extern \"C\" {\n     pub fn transmute();\n }"}, {"sha": "9f9abd575bbfca7653a076a87ee1186cacd6a2f2", "filename": "src/test/ui/issues/auxiliary/issue-16725.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fauxiliary%2Fissue-16725.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fauxiliary%2Fissue-16725.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fauxiliary%2Fissue-16725.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,3 +1,3 @@\n-extern {\n+extern \"C\" {\n     fn bar();\n }"}, {"sha": "e957be9c1c1b6fd3b9e715d3600dc070aac44cc9", "filename": "src/test/ui/issues/auxiliary/issue-25185-1.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fauxiliary%2Fissue-25185-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fauxiliary%2Fissue-25185-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fauxiliary%2Fissue-25185-1.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,6 +3,6 @@\n #![crate_type = \"rlib\"]\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     pub fn rust_dbg_extern_identity_u32(u: u32) -> u32;\n }"}, {"sha": "bb915f58d9d252cb5b3f6726076d18f21f34594c", "filename": "src/test/ui/issues/issue-10764.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-10764.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-10764.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-10764.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n fn f(_: extern \"Rust\" fn()) {}\n-extern fn bar() {}\n+extern \"C\" fn bar() {}\n \n fn main() { f(bar) }\n //~^ ERROR mismatched types"}, {"sha": "15a383175b975a4f7e0f626da849d3d5b3519d89", "filename": "src/test/ui/issues/issue-10877.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-10877.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-10877.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-10877.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,12 +1,14 @@\n-struct Foo { x: isize }\n-extern {\n+struct Foo {\n+    x: isize,\n+}\n+extern \"C\" {\n     fn foo(1: ());\n     //~^ ERROR: patterns aren't allowed in foreign function declarations\n     fn bar((): isize);\n     //~^ ERROR: patterns aren't allowed in foreign function declarations\n     fn baz(Foo { x }: isize);\n     //~^ ERROR: patterns aren't allowed in foreign function declarations\n-    fn qux((x,y): ());\n+    fn qux((x, y): ());\n     //~^ ERROR: patterns aren't allowed in foreign function declarations\n     fn this_is_actually_ok(a: usize);\n     fn and_so_is_this(_: usize);"}, {"sha": "bd3797cba558588afad621369a798d4502a82416", "filename": "src/test/ui/issues/issue-10877.stderr", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-10877.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-10877.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-10877.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,26 +1,26 @@\n error[E0130]: patterns aren't allowed in foreign function declarations\n-  --> $DIR/issue-10877.rs:3:12\n+  --> $DIR/issue-10877.rs:5:12\n    |\n LL |     fn foo(1: ());\n    |            ^ pattern not allowed in foreign function\n \n error[E0130]: patterns aren't allowed in foreign function declarations\n-  --> $DIR/issue-10877.rs:5:12\n+  --> $DIR/issue-10877.rs:7:12\n    |\n LL |     fn bar((): isize);\n    |            ^^ pattern not allowed in foreign function\n \n error[E0130]: patterns aren't allowed in foreign function declarations\n-  --> $DIR/issue-10877.rs:7:12\n+  --> $DIR/issue-10877.rs:9:12\n    |\n LL |     fn baz(Foo { x }: isize);\n    |            ^^^^^^^^^ pattern not allowed in foreign function\n \n error[E0130]: patterns aren't allowed in foreign function declarations\n-  --> $DIR/issue-10877.rs:9:12\n+  --> $DIR/issue-10877.rs:11:12\n    |\n-LL |     fn qux((x,y): ());\n-   |            ^^^^^ pattern not allowed in foreign function\n+LL |     fn qux((x, y): ());\n+   |            ^^^^^^ pattern not allowed in foreign function\n \n error: aborting due to 4 previous errors\n "}, {"sha": "c2c047c79615ec99b2749f165ed9b8d143768e3a", "filename": "src/test/ui/issues/issue-1251.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-1251.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-1251.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-1251.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,15 +3,14 @@\n #![allow(dead_code)]\n // pretty-expanded FIXME #23616\n // ignore-wasm32-bare no libc to test ffi with\n-\n #![feature(rustc_private)]\n \n mod rustrt {\n     extern crate libc;\n \n-    extern {\n+    extern \"C\" {\n         pub fn rust_get_test_int() -> libc::intptr_t;\n     }\n }\n \n-pub fn main() { }\n+pub fn main() {}"}, {"sha": "a1fde14600a109a4c66c2ce8cf78ae0eb74d988c", "filename": "src/test/ui/issues/issue-14227.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-14227.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-14227.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-14227.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-extern {\n+extern \"C\" {\n     pub static symbol: u32;\n }\n static CRASH: u32 = symbol;"}, {"sha": "34ac53be5beccac7387ead91dd2d8145c37c475f", "filename": "src/test/ui/issues/issue-15487.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-15487.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-15487.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-15487.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,12 +3,11 @@\n // ignore-windows\n // ignore-wasm32-bare no libs to link\n // ignore-sgx no libs to link\n-\n #![feature(link_args)]\n \n-#[link_args=\"-lc  -lm\"]\n-#[link_args=\" -lc\"]\n-#[link_args=\"-lc \"]\n-extern {}\n+#[link_args = \"-lc  -lm\"]\n+#[link_args = \" -lc\"]\n+#[link_args = \"-lc \"]\n+extern \"C\" {}\n \n fn main() {}"}, {"sha": "dc0ecd365226cefb790ed65b0de95d63e748428b", "filename": "src/test/ui/issues/issue-15562.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-15562.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-15562.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-15562.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -16,4 +16,4 @@ pub fn main() {\n // The above extern is NOT `extern \"rust-intrinsic\"` and thus\n // means it'll try to find a corresponding symbol to link to.\n #[no_mangle]\n-pub extern fn transmute() {}\n+pub extern \"C\" fn transmute() {}"}, {"sha": "51b60725c5a0c80f4ca5e8ab08a12a34b0d18db6", "filename": "src/test/ui/issues/issue-16149.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-16149.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-16149.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-16149.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,11 +1,11 @@\n-extern {\n+extern \"C\" {\n     static externalValue: isize;\n }\n \n fn main() {\n     let boolValue = match 42 {\n         externalValue => true,\n         //~^ ERROR match bindings cannot shadow statics\n-        _ => false\n+        _ => false,\n     };\n }"}, {"sha": "436e2a6cee35509a17847eddfd480d50488bbeac", "filename": "src/test/ui/issues/issue-16250.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-16250.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-16250.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-16250.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -2,9 +2,8 @@\n \n pub struct Foo;\n \n-extern {\n+extern \"C\" {\n     pub fn foo(x: (Foo)); //~ ERROR `extern` block uses type `Foo`\n }\n \n-fn main() {\n-}\n+fn main() {}"}, {"sha": "7d6eefa5b1e80471c8cd385ad9e09b15ad1dfdc6", "filename": "src/test/ui/issues/issue-16538.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-16538.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-16538.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-16538.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n mod Y {\n     pub type X = usize;\n-    extern {\n+    extern \"C\" {\n         pub static x: *const usize;\n     }\n     pub fn foo(value: *const X) -> *const X {"}, {"sha": "caac0c504141ea7e0dbd2245a839a208fda18617", "filename": "src/test/ui/issues/issue-1866.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-1866.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-1866.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-1866.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -9,7 +9,7 @@ mod a {\n     pub type rust_task = usize;\n     pub mod rustrt {\n         use super::rust_task;\n-        extern {\n+        extern \"C\" {\n             pub fn rust_task_is_unwinding(rt: *const rust_task) -> bool;\n         }\n     }\n@@ -19,11 +19,11 @@ mod b {\n     pub type rust_task = bool;\n     pub mod rustrt {\n         use super::rust_task;\n-        extern {\n+        extern \"C\" {\n             pub fn rust_task_is_unwinding(rt: *const rust_task) -> bool;\n-            //~^ WARN `rust_task_is_unwinding` redeclared with a different signature\n+        //~^ WARN `rust_task_is_unwinding` redeclared with a different signature\n         }\n     }\n }\n \n-pub fn main() { }\n+pub fn main() {}"}, {"sha": "e29d48285d829641fd4e4eab727acd86b9713299", "filename": "src/test/ui/issues/issue-18804/auxiliary/lib.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-18804%2Fauxiliary%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-18804%2Fauxiliary%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-18804%2Fauxiliary%2Flib.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,10 +1,10 @@\n #![crate_type = \"rlib\"]\n #![feature(linkage)]\n \n-pub fn foo<T>() -> *const() {\n-    extern {\n+pub fn foo<T>() -> *const () {\n+    extern \"C\" {\n         #[linkage = \"extern_weak\"]\n-        static FOO: *const();\n+        static FOO: *const ();\n     }\n     unsafe { FOO }\n }"}, {"sha": "591f3659e98f3bc010433faff600f3327ab6ea11", "filename": "src/test/ui/issues/issue-20313-rpass.rs", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-20313-rpass.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-20313-rpass.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-20313-rpass.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,13 +1,11 @@\n // run-pass\n #![allow(dead_code)]\n // pretty-expanded FIXME #23616\n-\n #![feature(link_llvm_intrinsics)]\n \n-extern {\n+extern \"C\" {\n     #[link_name = \"llvm.sqrt.f32\"]\n     fn sqrt(x: f32) -> f32;\n }\n \n-fn main(){\n-}\n+fn main() {}"}, {"sha": "a72af650c7071e62f1191be4ed1a35c2637129ed", "filename": "src/test/ui/issues/issue-20313.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-20313.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-20313.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-20313.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,6 @@\n-extern {\n+extern \"C\" {\n     #[link_name = \"llvm.sqrt.f32\"]\n     fn sqrt(x: f32) -> f32; //~ ERROR linking to LLVM intrinsics is experimental\n }\n \n-fn main(){\n-}\n+fn main() {}"}, {"sha": "1994c3515ab3b06919f76b3a78bec1969d0f58d3", "filename": "src/test/ui/issues/issue-2214.rs", "status": "modified", "additions": 8, "deletions": 10, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-2214.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-2214.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-2214.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,13 +5,11 @@\n \n extern crate libc;\n \n-use std::mem;\n use libc::{c_double, c_int};\n+use std::mem;\n \n fn to_c_int(v: &mut isize) -> &mut c_int {\n-    unsafe {\n-        mem::transmute_copy(&v)\n-    }\n+    unsafe { mem::transmute_copy(&v) }\n }\n \n fn lgamma(n: c_double, value: &mut isize) -> c_double {\n@@ -23,21 +21,21 @@ fn lgamma(n: c_double, value: &mut isize) -> c_double {\n mod m {\n     use libc::{c_double, c_int};\n \n-    extern {\n+    extern \"C\" {\n         #[cfg(all(unix, not(target_os = \"vxworks\")))]\n         #[link_name=\"lgamma_r\"]\n         pub fn lgamma(n: c_double, sign: &mut c_int) -> c_double;\n         #[cfg(windows)]\n-        #[link_name=\"lgamma\"]\n+        #[link_name = \"lgamma\"]\n         pub fn lgamma(n: c_double, sign: &mut c_int) -> c_double;\n         #[cfg(target_os = \"vxworks\")]\n-        #[link_name=\"lgamma\"]\n+        #[link_name = \"lgamma\"]\n         pub fn lgamma(n: c_double, sign: &mut c_int) -> c_double;\n     }\n }\n \n pub fn main() {\n-  let mut y: isize = 5;\n-  let x: &mut isize = &mut y;\n-  assert_eq!(lgamma(1.0 as c_double, x), 0.0 as c_double);\n+    let mut y: isize = 5;\n+    let x: &mut isize = &mut y;\n+    assert_eq!(lgamma(1.0 as c_double, x), 0.0 as c_double);\n }"}, {"sha": "3653e62732d419903da02616a1cebdc792632728", "filename": "src/test/ui/issues/issue-26997.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-26997.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-26997.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-26997.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -7,7 +7,7 @@ pub struct Foo {\n \n impl Foo {\n     #[allow(improper_ctypes_definitions)]\n-    pub extern fn foo_new() -> Foo {\n+    pub extern \"C\" fn foo_new() -> Foo {\n         Foo { x: 21, y: 33 }\n     }\n }"}, {"sha": "f74726e8166dcca1de487faac259e9a55938b32d", "filename": "src/test/ui/issues/issue-28324.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-28324.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-28324.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-28324.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-extern {\n+extern \"C\" {\n     static error_message_count: u32;\n }\n "}, {"sha": "6db1f9a5bddf98c2ef15ea79d55d097fb2bf3791", "filename": "src/test/ui/issues/issue-28472.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-28472.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-28472.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-28472.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,6 +1,6 @@\n // Check that the visibility modifier is included in the span of foreign items.\n \n-extern {\n+extern \"C\" {\n   fn foo();\n \n   pub //~ ERROR the name `foo` is defined multiple times"}, {"sha": "52db0d5fd84a9520bc0b5e5798a39c7c0d6284cb", "filename": "src/test/ui/issues/issue-28600.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-28600.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-28600.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-28600.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -7,7 +7,7 @@ impl Test {\n     #[allow(dead_code)]\n     #[allow(unused_variables)]\n     #[allow(improper_ctypes_definitions)]\n-    pub extern fn test(val: &str) {\n+    pub extern \"C\" fn test(val: &str) {\n \n     }\n }"}, {"sha": "347a840296dddaca6e25b9b1c77dc8109b0c6a4a", "filename": "src/test/ui/issues/issue-28676.rs", "status": "modified", "additions": 15, "deletions": 10, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-28676.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-28676.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-28676.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,27 +5,32 @@\n // ignore-wasm32-bare no libc to test ffi with\n \n #[derive(Copy, Clone)]\n-pub struct Quad { a: u64, b: u64, c: u64, d: u64 }\n+pub struct Quad {\n+    a: u64,\n+    b: u64,\n+    c: u64,\n+    d: u64,\n+}\n \n mod rustrt {\n     use super::Quad;\n \n     #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-    extern {\n-        pub fn get_c_many_params(_: *const (), _: *const (),\n-                                 _: *const (), _: *const (), f: Quad) -> u64;\n+    extern \"C\" {\n+        pub fn get_c_many_params(\n+            _: *const (),\n+            _: *const (),\n+            _: *const (),\n+            _: *const (),\n+            f: Quad,\n+        ) -> u64;\n     }\n }\n \n fn test() {\n     unsafe {\n         let null = std::ptr::null();\n-        let q = Quad {\n-            a: 1,\n-            b: 2,\n-            c: 3,\n-            d: 4\n-        };\n+        let q = Quad { a: 1, b: 2, c: 3, d: 4 };\n         assert_eq!(rustrt::get_c_many_params(null, null, null, null, q), q.c);\n     }\n }"}, {"sha": "f27bb1c2eb5b664ba402b8edaad42a52abb0f4a9", "filename": "src/test/ui/issues/issue-32201.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-32201.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-32201.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-32201.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-extern {\n+extern \"C\" {\n     fn foo(a: i32, ...);\n }\n "}, {"sha": "4a9f94306d5b821c13243fa597d46c1b0da0c36f", "filename": "src/test/ui/issues/issue-3656.rs", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-3656.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-3656.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-3656.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,14 +1,12 @@\n // run-pass\n #![allow(dead_code)]\n #![allow(improper_ctypes)]\n-\n // Issue #3656\n // Incorrect struct size computation in the FFI, because of not taking\n // the alignment of elements into account.\n \n // pretty-expanded FIXME #23616\n // ignore-wasm32-bare no libc to test with\n-\n #![feature(rustc_private)]\n \n extern crate libc;\n@@ -21,10 +19,9 @@ pub struct KEYGEN {\n     salt_size: u32,\n }\n \n-extern {\n+extern \"C\" {\n     // Bogus signature, just need to test if it compiles.\n     pub fn malloc(data: KEYGEN);\n }\n \n-pub fn main() {\n-}\n+pub fn main() {}"}, {"sha": "73d17928251178c84162c7cd48ef1b511c9cd65c", "filename": "src/test/ui/issues/issue-43925.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-43925.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-43925.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-43925.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-#[link(name=\"foo\", cfg(\"rlib\"))] //~ ERROR invalid argument for `cfg(..)`\n-extern {}\n+#[link(name = \"foo\", cfg(\"rlib\"))] //~ ERROR invalid argument for `cfg(..)`\n+extern \"C\" {}\n \n fn main() {}"}, {"sha": "7bf64dc693c5e27d9494957330a4499b1836ef69", "filename": "src/test/ui/issues/issue-43925.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-43925.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-43925.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-43925.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,8 +1,8 @@\n error: invalid argument for `cfg(..)`\n-  --> $DIR/issue-43925.rs:1:24\n+  --> $DIR/issue-43925.rs:1:26\n    |\n-LL | #[link(name=\"foo\", cfg(\"rlib\"))]\n-   |                        ^^^^^^\n+LL | #[link(name = \"foo\", cfg(\"rlib\"))]\n+   |                          ^^^^^^\n \n error: aborting due to previous error\n "}, {"sha": "0171c12b1cc4e982c5737258b985cc6315f75e10", "filename": "src/test/ui/issues/issue-43926.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-43926.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-43926.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-43926.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-#[link(name=\"foo\", cfg())] //~ ERROR `cfg()` must have an argument\n-extern {}\n+#[link(name = \"foo\", cfg())] //~ ERROR `cfg()` must have an argument\n+extern \"C\" {}\n \n fn main() {}"}, {"sha": "d83e9bd7ed4646c8f395f6e7ea1c4a59a9ed2b9f", "filename": "src/test/ui/issues/issue-43926.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-43926.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-43926.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-43926.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,8 +1,8 @@\n error: `cfg()` must have an argument\n-  --> $DIR/issue-43926.rs:1:20\n+  --> $DIR/issue-43926.rs:1:22\n    |\n-LL | #[link(name=\"foo\", cfg())]\n-   |                    ^^^^^\n+LL | #[link(name = \"foo\", cfg())]\n+   |                      ^^^^^\n \n error: aborting due to previous error\n "}, {"sha": "9378f4357134b001e29611bac30e31f8f5354840", "filename": "src/test/ui/issues/issue-51907.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-51907.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-51907.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-51907.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,15 +1,15 @@\n // run-pass\n trait Foo {\n-    extern fn borrow(&self);\n-    extern fn take(self: Box<Self>);\n+    extern \"C\" fn borrow(&self);\n+    extern \"C\" fn take(self: Box<Self>);\n }\n \n struct Bar;\n impl Foo for Bar {\n     #[allow(improper_ctypes_definitions)]\n-    extern fn borrow(&self) {}\n+    extern \"C\" fn borrow(&self) {}\n     #[allow(improper_ctypes_definitions)]\n-    extern fn take(self: Box<Self>) {}\n+    extern \"C\" fn take(self: Box<Self>) {}\n }\n \n fn main() {"}, {"sha": "3544160f094e56be68554ebdb09e7c6e66017dbb", "filename": "src/test/ui/issues/issue-5791.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-5791.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-5791.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-5791.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,12 +3,12 @@\n #![warn(clashing_extern_declarations)]\n // pretty-expanded FIXME #23616\n \n-extern {\n+extern \"C\" {\n     #[link_name = \"malloc\"]\n     fn malloc1(len: i32) -> *const u8;\n     #[link_name = \"malloc\"]\n     //~^ WARN `malloc2` redeclares `malloc` with a different signature\n     fn malloc2(len: i32, foo: i32) -> *const u8;\n }\n \n-pub fn main () {}\n+pub fn main() {}"}, {"sha": "8c6192a59dba28d79dfe644f07ce9c8ae27ab7a6", "filename": "src/test/ui/issues/issue-6470.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-6470.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fissues%2Fissue-6470.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-6470.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,6 @@\n // build-pass\n #![allow(dead_code)]\n #![allow(improper_ctypes)]\n-\n // pretty-expanded FIXME #23616\n #![allow(non_snake_case)]\n \n@@ -10,9 +9,9 @@ pub mod Bar {\n         v: isize,\n     }\n \n-    extern {\n+    extern \"C\" {\n         pub fn foo(v: *const Foo) -> Foo;\n     }\n }\n \n-pub fn main() { }\n+pub fn main() {}"}, {"sha": "254091ff2508cbe2c58baa4fd72686d32fdcaed5", "filename": "src/test/ui/link-cfg-works.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flink-cfg-works.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flink-cfg-works.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flink-cfg-works.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -4,10 +4,10 @@\n \n #![feature(link_cfg)]\n \n-extern crate link_cfg_works_transitive_rlib;\n extern crate link_cfg_works_transitive_dylib;\n+extern crate link_cfg_works_transitive_rlib;\n \n #[link(name = \"foo\", cfg(foo))]\n-extern {}\n+extern \"C\" {}\n \n fn main() {}"}, {"sha": "60b55b3e27bc8322fb4163bb59f40188c4d8105b", "filename": "src/test/ui/linkage-attr/auxiliary/def_colliding_external.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage-attr%2Fauxiliary%2Fdef_colliding_external.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage-attr%2Fauxiliary%2Fdef_colliding_external.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flinkage-attr%2Fauxiliary%2Fdef_colliding_external.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,7 +1,7 @@\n #![feature(linkage)]\n #![crate_type = \"lib\"]\n \n-extern {\n-    #[linkage=\"external\"]\n+extern \"C\" {\n+    #[linkage = \"external\"]\n     pub static collision: *const i32;\n }"}, {"sha": "7418691d01409997789f6a3ca43692aeffd2870b", "filename": "src/test/ui/linkage-attr/invalid-link-args.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage-attr%2Finvalid-link-args.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage-attr%2Finvalid-link-args.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flinkage-attr%2Finvalid-link-args.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -9,6 +9,6 @@\n #![feature(link_args)]\n \n #[link_args = \"aFdEfSeVEEE\"]\n-extern {}\n+extern \"C\" {}\n \n-fn main() { }\n+fn main() {}"}, {"sha": "b712f3225ed16186dd24af8e99d36f85232940c3", "filename": "src/test/ui/linkage-attr/linkage-detect-local-generated-name-collision.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage-attr%2Flinkage-detect-local-generated-name-collision.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage-attr%2Flinkage-detect-local-generated-name-collision.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flinkage-attr%2Flinkage-detect-local-generated-name-collision.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -3,8 +3,8 @@\n #![feature(linkage)]\n \n mod dep1 {\n-    extern {\n-        #[linkage=\"external\"]\n+    extern \"C\" {\n+        #[linkage = \"external\"]\n         #[no_mangle]\n         pub static collision: *const i32; //~ ERROR symbol `collision` is already defined\n     }\n@@ -20,6 +20,6 @@ mod dep2 {\n \n fn main() {\n     unsafe {\n-       println!(\"{:p}\", &dep1::collision);\n+        println!(\"{:p}\", &dep1::collision);\n     }\n }"}, {"sha": "a7be1985286a1373dcefaf3994e0d991b62403cf", "filename": "src/test/ui/linkage-attr/linkage2.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage-attr%2Flinkage2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage-attr%2Flinkage2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flinkage-attr%2Flinkage2.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -7,9 +7,10 @@\n \n #![feature(linkage)]\n \n-extern {\n-    #[linkage = \"extern_weak\"] static foo: i32;\n-    //~^ ERROR: must have type `*const T` or `*mut T` due to `#[linkage]` attribute\n+extern \"C\" {\n+    #[linkage = \"extern_weak\"]\n+    static foo: i32;\n+//~^ ERROR: must have type `*const T` or `*mut T` due to `#[linkage]` attribute\n }\n \n fn main() {"}, {"sha": "6ffe07170ede7bca14815e0aaa80846b31a0bd5f", "filename": "src/test/ui/linkage-attr/linkage2.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage-attr%2Flinkage2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage-attr%2Flinkage2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flinkage-attr%2Flinkage2.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,8 +1,8 @@\n error: must have type `*const T` or `*mut T` due to `#[linkage]` attribute\n-  --> $DIR/linkage2.rs:11:32\n+  --> $DIR/linkage2.rs:12:5\n    |\n-LL |     #[linkage = \"extern_weak\"] static foo: i32;\n-   |                                ^^^^^^^^^^^^^^^^\n+LL |     static foo: i32;\n+   |     ^^^^^^^^^^^^^^^^\n \n error: aborting due to previous error\n "}, {"sha": "112eb1d3bd9d28a1c372aaae5245d7d1fca8b397", "filename": "src/test/ui/linkage-attr/linkage3.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage-attr%2Flinkage3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage-attr%2Flinkage3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flinkage-attr%2Flinkage3.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -6,9 +6,10 @@\n \n #![feature(linkage)]\n \n-extern {\n-    #[linkage = \"foo\"] static foo: *const i32;\n-    //~^ ERROR: invalid linkage specified\n+extern \"C\" {\n+    #[linkage = \"foo\"]\n+    static foo: *const i32;\n+//~^ ERROR: invalid linkage specified\n }\n \n fn main() {"}, {"sha": "0cbac28349d5aea6dd532bbee61cc29ae2851ab2", "filename": "src/test/ui/linkage-attr/linkage3.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage-attr%2Flinkage3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage-attr%2Flinkage3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flinkage-attr%2Flinkage3.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,8 +1,8 @@\n error: invalid linkage specified\n-  --> $DIR/linkage3.rs:10:24\n+  --> $DIR/linkage3.rs:11:5\n    |\n-LL |     #[linkage = \"foo\"] static foo: *const i32;\n-   |                        ^^^^^^^^^^^^^^^^^^^^^^^\n+LL |     static foo: *const i32;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^\n \n error: aborting due to previous error\n "}, {"sha": "deab7a251cbd4f78ff313816e6037512840dd778", "filename": "src/test/ui/linkage1.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flinkage1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flinkage1.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -9,7 +9,7 @@\n \n extern crate linkage1 as other;\n \n-extern {\n+extern \"C\" {\n     #[linkage = \"extern_weak\"]\n     static foo: *const isize;\n     #[linkage = \"extern_weak\"]"}, {"sha": "d3582961b3e39b15e9380a5f34e13009f7de681b", "filename": "src/test/ui/lint/dead-code/leading-underscore.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Fdead-code%2Fleading-underscore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Fdead-code%2Fleading-underscore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fdead-code%2Fleading-underscore.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -8,7 +8,7 @@ static _X: usize = 0;\n fn _foo() {}\n \n struct _Y {\n-    _z: usize\n+    _z: usize,\n }\n \n enum _Z {}\n@@ -23,7 +23,7 @@ mod _bar {\n     fn _qux() {}\n }\n \n-extern {\n+extern \"C\" {\n     #[link_name = \"abort\"]\n     fn _abort() -> !;\n }"}, {"sha": "7f39f7965f2868eab5fc208515df114d9b9f9b10", "filename": "src/test/ui/lint/dead-code/lint-dead-code-3.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Fdead-code%2Flint-dead-code-3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Fdead-code%2Flint-dead-code-3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fdead-code%2Flint-dead-code-3.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -7,7 +7,7 @@\n \n \n pub use extern_foo as x;\n-extern {\n+extern \"C\" {\n     pub fn extern_foo();\n }\n \n@@ -47,7 +47,7 @@ mod blah {\n     // `malloc` below, which are also used.\n     enum c_void {}\n \n-    extern {\n+    extern \"C\" {\n         fn free(p: *const c_void);\n         fn malloc(size: usize) -> *const c_void;\n     }\n@@ -58,7 +58,7 @@ mod blah {\n }\n \n enum c_void {} //~ ERROR: enum is never used\n-extern {\n+extern \"C\" {\n     fn free(p: *const c_void); //~ ERROR: function is never used\n }\n "}, {"sha": "6321b3c76e4d18a8bbedcf9e087aa0e17f24807e", "filename": "src/test/ui/lint/inline-trait-and-foreign-items.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Finline-trait-and-foreign-items.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Finline-trait-and-foreign-items.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Finline-trait-and-foreign-items.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -26,7 +26,7 @@ impl Trait for () {\n     type U = impl Trait; //~ ERROR could not find defining uses\n }\n \n-extern {\n+extern \"C\" {\n     #[inline] //~ ERROR attribute should be applied to function or closure\n     static X: u32;\n "}, {"sha": "d7f947aa0f3bc2d433d7d3a78cf8b223379f7e54", "filename": "src/test/ui/lint/lint-ctypes-enum.rs", "status": "modified", "additions": 31, "deletions": 10, "changes": 41, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Flint-ctypes-enum.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Flint-ctypes-enum.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-ctypes-enum.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,36 +5,57 @@\n \n use std::num;\n \n-enum Z { }\n-enum U { A }\n-enum B { C, D }\n-enum T { E, F, G }\n+enum Z {}\n+enum U {\n+    A,\n+}\n+enum B {\n+    C,\n+    D,\n+}\n+enum T {\n+    E,\n+    F,\n+    G,\n+}\n \n #[repr(C)]\n-enum ReprC { A, B, C }\n+enum ReprC {\n+    A,\n+    B,\n+    C,\n+}\n \n #[repr(u8)]\n-enum U8 { A, B, C }\n+enum U8 {\n+    A,\n+    B,\n+    C,\n+}\n \n #[repr(isize)]\n-enum Isize { A, B, C }\n+enum Isize {\n+    A,\n+    B,\n+    C,\n+}\n \n #[repr(transparent)]\n struct TransparentStruct<T>(T, std::marker::PhantomData<Z>);\n \n #[repr(transparent)]\n enum TransparentEnum<T> {\n-   Variant(T, std::marker::PhantomData<Z>),\n+    Variant(T, std::marker::PhantomData<Z>),\n }\n \n #[repr(transparent)]\n union TransparentUnion<T: Copy> {\n-   field: T,\n+    field: T,\n }\n \n struct Rust<T>(T);\n \n-extern {\n+extern \"C\" {\n    fn zf(x: Z);\n    fn uf(x: U); //~ ERROR `extern` block uses type `U`\n    fn bf(x: B); //~ ERROR `extern` block uses type `B`"}, {"sha": "8917d309e60870c80d0a72203ae508db7d2f31fc", "filename": "src/test/ui/lint/lint-ctypes-enum.stderr", "status": "modified", "additions": 27, "deletions": 18, "changes": 45, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Flint-ctypes-enum.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Flint-ctypes-enum.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-ctypes-enum.stderr?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,5 +1,5 @@\n error: `extern` block uses type `U`, which is not FFI-safe\n-  --> $DIR/lint-ctypes-enum.rs:39:13\n+  --> $DIR/lint-ctypes-enum.rs:60:13\n    |\n LL |    fn uf(x: U);\n    |             ^ not FFI-safe\n@@ -14,39 +14,48 @@ LL | #![deny(improper_ctypes)]\n note: the type is defined here\n   --> $DIR/lint-ctypes-enum.rs:9:1\n    |\n-LL | enum U { A }\n-   | ^^^^^^^^^^^^\n+LL | / enum U {\n+LL | |     A,\n+LL | | }\n+   | |_^\n \n error: `extern` block uses type `B`, which is not FFI-safe\n-  --> $DIR/lint-ctypes-enum.rs:40:13\n+  --> $DIR/lint-ctypes-enum.rs:61:13\n    |\n LL |    fn bf(x: B);\n    |             ^ not FFI-safe\n    |\n    = help: consider adding a `#[repr(C)]`, `#[repr(transparent)]`, or integer `#[repr(...)]` attribute to this enum\n    = note: enum has no representation hint\n note: the type is defined here\n-  --> $DIR/lint-ctypes-enum.rs:10:1\n+  --> $DIR/lint-ctypes-enum.rs:12:1\n    |\n-LL | enum B { C, D }\n-   | ^^^^^^^^^^^^^^^\n+LL | / enum B {\n+LL | |     C,\n+LL | |     D,\n+LL | | }\n+   | |_^\n \n error: `extern` block uses type `T`, which is not FFI-safe\n-  --> $DIR/lint-ctypes-enum.rs:41:13\n+  --> $DIR/lint-ctypes-enum.rs:62:13\n    |\n LL |    fn tf(x: T);\n    |             ^ not FFI-safe\n    |\n    = help: consider adding a `#[repr(C)]`, `#[repr(transparent)]`, or integer `#[repr(...)]` attribute to this enum\n    = note: enum has no representation hint\n note: the type is defined here\n-  --> $DIR/lint-ctypes-enum.rs:11:1\n-   |\n-LL | enum T { E, F, G }\n-   | ^^^^^^^^^^^^^^^^^^\n+  --> $DIR/lint-ctypes-enum.rs:16:1\n+   |\n+LL | / enum T {\n+LL | |     E,\n+LL | |     F,\n+LL | |     G,\n+LL | | }\n+   | |_^\n \n error: `extern` block uses type `Option<Unique<u8>>`, which is not FFI-safe\n-  --> $DIR/lint-ctypes-enum.rs:48:17\n+  --> $DIR/lint-ctypes-enum.rs:69:17\n    |\n LL |    fn unique(x: Option<std::ptr::Unique<u8>>);\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe\n@@ -55,23 +64,23 @@ LL |    fn unique(x: Option<std::ptr::Unique<u8>>);\n    = note: enum has no representation hint\n \n error: `extern` block uses type `u128`, which is not FFI-safe\n-  --> $DIR/lint-ctypes-enum.rs:54:23\n+  --> $DIR/lint-ctypes-enum.rs:75:23\n    |\n LL |    fn nonzero_u128(x: Option<num::NonZeroU128>);\n    |                       ^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe\n    |\n    = note: 128-bit integers don't currently have a known stable ABI\n \n error: `extern` block uses type `i128`, which is not FFI-safe\n-  --> $DIR/lint-ctypes-enum.rs:61:23\n+  --> $DIR/lint-ctypes-enum.rs:82:23\n    |\n LL |    fn nonzero_i128(x: Option<num::NonZeroI128>);\n    |                       ^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe\n    |\n    = note: 128-bit integers don't currently have a known stable ABI\n \n error: `extern` block uses type `Option<TransparentUnion<NonZeroU8>>`, which is not FFI-safe\n-  --> $DIR/lint-ctypes-enum.rs:66:28\n+  --> $DIR/lint-ctypes-enum.rs:87:28\n    |\n LL |    fn transparent_union(x: Option<TransparentUnion<num::NonZeroU8>>);\n    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe\n@@ -80,7 +89,7 @@ LL |    fn transparent_union(x: Option<TransparentUnion<num::NonZeroU8>>);\n    = note: enum has no representation hint\n \n error: `extern` block uses type `Option<Rust<NonZeroU8>>`, which is not FFI-safe\n-  --> $DIR/lint-ctypes-enum.rs:68:20\n+  --> $DIR/lint-ctypes-enum.rs:89:20\n    |\n LL |    fn repr_rust(x: Option<Rust<num::NonZeroU8>>);\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe\n@@ -89,7 +98,7 @@ LL |    fn repr_rust(x: Option<Rust<num::NonZeroU8>>);\n    = note: enum has no representation hint\n \n error: `extern` block uses type `std::result::Result<(), NonZeroI32>`, which is not FFI-safe\n-  --> $DIR/lint-ctypes-enum.rs:69:20\n+  --> $DIR/lint-ctypes-enum.rs:90:20\n    |\n LL |    fn no_result(x: Result<(), num::NonZeroI32>);\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe"}, {"sha": "e69d0dab49642267dc7e8a87f600cf4221081ed3", "filename": "src/test/ui/lint/lint-ctypes-fn.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Flint-ctypes-fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Flint-ctypes-fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-ctypes-fn.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -27,7 +27,7 @@ pub struct ZeroSize;\n \n pub type RustFn = fn();\n \n-pub type RustBadRet = extern fn() -> Box<u32>;\n+pub type RustBadRet = extern \"C\" fn() -> Box<u32>;\n \n pub type CVoidRet = ();\n \n@@ -116,17 +116,17 @@ pub extern \"C\" fn transparent_str(p: TransparentStr) { }\n \n pub extern \"C\" fn transparent_fn(p: TransparentBadFn) { }\n \n-pub extern \"C\" fn good3(fptr: Option<extern fn()>) { }\n+pub extern \"C\" fn good3(fptr: Option<extern \"C\" fn()>) { }\n \n pub extern \"C\" fn good4(aptr: &[u8; 4 as usize]) { }\n \n pub extern \"C\" fn good5(s: StructWithProjection) { }\n \n pub extern \"C\" fn good6(s: StructWithProjectionAndLifetime) { }\n \n-pub extern \"C\" fn good7(fptr: extern fn() -> ()) { }\n+pub extern \"C\" fn good7(fptr: extern \"C\" fn() -> ()) { }\n \n-pub extern \"C\" fn good8(fptr: extern fn() -> !) { }\n+pub extern \"C\" fn good8(fptr: extern \"C\" fn() -> !) { }\n \n pub extern \"C\" fn good9() -> () { }\n "}, {"sha": "fabbdcf689182e07d236061c3fb471a7c711fdb8", "filename": "src/test/ui/lint/lint-ctypes.rs", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Flint-ctypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Flint-ctypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-ctypes.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -20,7 +20,7 @@ pub type I32Pair = (i32, i32);\n #[repr(C)]\n pub struct ZeroSize;\n pub type RustFn = fn();\n-pub type RustBadRet = extern fn() -> Box<u32>;\n+pub type RustBadRet = extern \"C\" fn() -> Box<u32>;\n pub type CVoidRet = ();\n pub struct Foo;\n #[repr(transparent)]\n@@ -43,7 +43,7 @@ pub struct TransparentCustomZst(i32, ZeroSize);\n #[repr(C)]\n pub struct ZeroSizeWithPhantomData(::std::marker::PhantomData<i32>);\n \n-extern {\n+extern \"C\" {\n     pub fn ptr_type1(size: *const Foo); //~ ERROR: uses type `Foo`\n     pub fn ptr_type2(size: *const Foo); //~ ERROR: uses type `Foo`\n     pub fn slice_type(p: &[u32]); //~ ERROR: uses type `[u32]`\n@@ -73,12 +73,12 @@ extern {\n     pub static static_u128_type: u128; //~ ERROR: uses type `u128`\n     pub static static_u128_array_type: [u128; 16]; //~ ERROR: uses type `u128`\n \n-    pub fn good3(fptr: Option<extern fn()>);\n+    pub fn good3(fptr: Option<extern \"C\" fn()>);\n     pub fn good4(aptr: &[u8; 4 as usize]);\n     pub fn good5(s: StructWithProjection);\n     pub fn good6(s: StructWithProjectionAndLifetime);\n-    pub fn good7(fptr: extern fn() -> ());\n-    pub fn good8(fptr: extern fn() -> !);\n+    pub fn good7(fptr: extern \"C\" fn() -> ());\n+    pub fn good8(fptr: extern \"C\" fn() -> !);\n     pub fn good9() -> ();\n     pub fn good10() -> CVoidRet;\n     pub fn good11(size: isize);\n@@ -96,12 +96,12 @@ extern {\n }\n \n #[allow(improper_ctypes)]\n-extern {\n+extern \"C\" {\n     pub fn good19(_: &String);\n }\n \n #[cfg(not(target_arch = \"wasm32\"))]\n-extern {\n+extern \"C\" {\n     pub fn good1(size: *const libc::c_int);\n     pub fn good2(size: *const libc::c_uint);\n }"}, {"sha": "27c31c22311ab7736f1f5aea7a1debc7156dc271", "filename": "src/test/ui/lint/unreachable_pub-pub_crate.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Funreachable_pub-pub_crate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Funreachable_pub-pub_crate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Funreachable_pub-pub_crate.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -41,7 +41,7 @@ mod private_mod {\n     }\n     define_empty_struct_with_visibility!(pub, Fluorine);\n \n-    extern {\n+    extern \"C\" {\n         pub fn catalyze() -> bool; //~ WARNING unreachable_pub\n     }\n "}, {"sha": "6bfec0ec5e8b04ef73456a6352f67a3c1180f98c", "filename": "src/test/ui/lint/unreachable_pub.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Funreachable_pub.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Funreachable_pub.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Funreachable_pub.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -37,7 +37,7 @@ mod private_mod {\n     }\n     define_empty_struct_with_visibility!(pub, Fluorine);\n \n-    extern {\n+    extern \"C\" {\n         pub fn catalyze() -> bool; //~ WARNING unreachable_pub\n     }\n "}, {"sha": "4684fe145774d8be4a14f2b2cfa77dfcf82e9b9f", "filename": "src/test/ui/lint/warn-unused-inline-on-fn-prototypes.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Fwarn-unused-inline-on-fn-prototypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Flint%2Fwarn-unused-inline-on-fn-prototypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fwarn-unused-inline-on-fn-prototypes.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -5,7 +5,7 @@ trait Trait {\n     fn foo();\n }\n \n-extern {\n+extern \"C\" {\n     #[inline] //~ ERROR `#[inline]` is ignored on function prototypes\n     fn foo();\n }"}, {"sha": "568ae3a8539a9354d379647e1af44f00f4e7d7d4", "filename": "src/test/ui/macros/macros-in-extern.rs", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fmacros%2Fmacros-in-extern.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fmacros%2Fmacros-in-extern.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Fmacros-in-extern.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -10,7 +10,7 @@ macro_rules! returns_isize(\n );\n \n macro takes_u32_returns_u32($ident:ident) {\n-    fn $ident (arg: u32) -> u32;\n+    fn $ident(arg: u32) -> u32;\n }\n \n macro_rules! emits_nothing(\n@@ -25,8 +25,14 @@ macro_rules! emits_multiple(\n );\n \n mod defs {\n-    #[no_mangle] extern fn f1() -> u32 { 1 }\n-    #[no_mangle] extern fn f2() -> u32 { 2 }\n+    #[no_mangle]\n+    extern \"C\" fn f1() -> u32 {\n+        1\n+    }\n+    #[no_mangle]\n+    extern \"C\" fn f2() -> u32 {\n+        2\n+    }\n }\n \n fn main() {\n@@ -37,7 +43,7 @@ fn main() {\n }\n \n #[link(name = \"rust_test_helpers\", kind = \"static\")]\n-extern {\n+extern \"C\" {\n     returns_isize!(rust_get_test_int);\n     takes_u32_returns_u32!(rust_dbg_extern_identity_u32);\n     emits_nothing!();"}, {"sha": "6a5a4dace6492008f3b4f8f9401ab15b0b7d8bcc", "filename": "src/test/ui/mir/mir_codegen_calls.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fmir%2Fmir_codegen_calls.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fmir%2Fmir_codegen_calls.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmir%2Fmir_codegen_calls.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -75,7 +75,7 @@ fn test8() -> isize {\n }\n \n #[allow(improper_ctypes_definitions)]\n-extern fn simple_extern(x: u32, y: (u32, u32)) -> u32 {\n+extern \"C\" fn simple_extern(x: u32, y: (u32, u32)) -> u32 {\n     x + y.0 * y.1\n }\n "}, {"sha": "8bd26cebc693466c42a411184495175a0bea6aa6", "filename": "src/test/ui/mismatched_types/issue-26480.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fmismatched_types%2Fissue-26480.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fmismatched_types%2Fissue-26480.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmismatched_types%2Fissue-26480.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,4 +1,4 @@\n-extern {\n+extern \"C\" {\n     fn write(fildes: i32, buf: *const i8, nbyte: u64) -> i64;\n }\n "}, {"sha": "f3be948781be326089cc7efed7d2d18ba6d6d7b9", "filename": "src/test/ui/nil-decl-in-foreign.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fnil-decl-in-foreign.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fnil-decl-in-foreign.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnil-decl-in-foreign.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -6,9 +6,9 @@\n // pretty-expanded FIXME #23616\n \n mod libc {\n-    extern {\n+    extern \"C\" {\n         pub fn printf(x: ());\n     }\n }\n \n-pub fn main() { }\n+pub fn main() {}"}, {"sha": "54836b0a3f5384718137f439fb8a69dbb7fb54da", "filename": "src/test/ui/no-patterns-in-args.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fno-patterns-in-args.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fno-patterns-in-args.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fno-patterns-in-args.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,10 +1,10 @@\n-extern {\n+extern \"C\" {\n     fn f1(mut arg: u8); //~ ERROR patterns aren't allowed in foreign function declarations\n     fn f2(&arg: u8); //~ ERROR patterns aren't allowed in foreign function declarations\n     fn f3(arg @ _: u8); //~ ERROR patterns aren't allowed in foreign function declarations\n     fn g1(arg: u8); // OK\n     fn g2(_: u8); // OK\n-    // fn g3(u8); // Not yet\n+// fn g3(u8); // Not yet\n }\n \n type A1 = fn(mut arg: u8); //~ ERROR patterns aren't allowed in function pointer types"}, {"sha": "c22b44ffca2a4e354fab2cd7ecfaedda8791510d", "filename": "src/test/ui/no_owned_box_lang_item.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fno_owned_box_lang_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fno_owned_box_lang_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fno_owned_box_lang_item.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -11,6 +11,6 @@ fn main() {\n     let x = box 1i32;\n }\n \n-#[lang = \"eh_personality\"] extern fn eh_personality() {}\n+#[lang = \"eh_personality\"] extern \"C\" fn eh_personality() {}\n #[lang = \"eh_catch_typeinfo\"] static EH_CATCH_TYPEINFO: u8 = 0;\n #[lang = \"panic_impl\"] fn panic_impl(panic: &PanicInfo) -> ! { loop {} }"}, {"sha": "0384553b6993f7c46ebfe4bd01d4a0d0a9e77dd4", "filename": "src/test/ui/nullable-pointer-size.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fnullable-pointer-size.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fnullable-pointer-size.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnullable-pointer-size.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -31,5 +31,5 @@ macro_rules! check_type {\n pub fn main() {\n     check_type!(&'static isize);\n     check_type!(Box<isize>);\n-    check_type!(extern fn());\n+    check_type!(extern \"C\" fn());\n }"}, {"sha": "31b853e24fe5bae1c57975f5ee76698a685954a9", "filename": "src/test/ui/osx-frameworks.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fosx-frameworks.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fosx-frameworks.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fosx-frameworks.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -1,8 +1,7 @@\n // ignore-macos this is supposed to succeed on osx\n \n #[link(name = \"foo\", kind = \"framework\")]\n-extern {}\n+extern \"C\" {}\n //~^^ ERROR: native frameworks are only available on macOS\n \n-fn main() {\n-}\n+fn main() {}"}, {"sha": "c92015eeebcc2775136004a87c8e37eaf2f0f9de", "filename": "src/test/ui/panic-runtime/auxiliary/panic-runtime-abort.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fpanic-runtime%2Fauxiliary%2Fpanic-runtime-abort.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fpanic-runtime%2Fauxiliary%2Fpanic-runtime-abort.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpanic-runtime%2Fauxiliary%2Fpanic-runtime-abort.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -8,10 +8,10 @@\n #![panic_runtime]\n \n #[no_mangle]\n-pub extern fn __rust_maybe_catch_panic() {}\n+pub extern \"C\" fn __rust_maybe_catch_panic() {}\n \n #[no_mangle]\n-pub extern fn __rust_start_panic() {}\n+pub extern \"C\" fn __rust_start_panic() {}\n \n #[no_mangle]\n-pub extern fn rust_eh_personality() {}\n+pub extern \"C\" fn rust_eh_personality() {}"}, {"sha": "2f7aed9248a0696bc6494fdbbc1d4980a32cdb42", "filename": "src/test/ui/panic-runtime/auxiliary/panic-runtime-unwind.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fpanic-runtime%2Fauxiliary%2Fpanic-runtime-unwind.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fd2df74902fa98bcb71f85fd548c3eb399e6a96a/src%2Ftest%2Fui%2Fpanic-runtime%2Fauxiliary%2Fpanic-runtime-unwind.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpanic-runtime%2Fauxiliary%2Fpanic-runtime-unwind.rs?ref=fd2df74902fa98bcb71f85fd548c3eb399e6a96a", "patch": "@@ -8,10 +8,10 @@\n #![panic_runtime]\n \n #[no_mangle]\n-pub extern fn __rust_maybe_catch_panic() {}\n+pub extern \"C\" fn __rust_maybe_catch_panic() {}\n \n #[no_mangle]\n-pub extern fn __rust_start_panic() {}\n+pub extern \"C\" fn __rust_start_panic() {}\n \n #[no_mangle]\n-pub extern fn rust_eh_personality() {}\n+pub extern \"C\" fn rust_eh_personality() {}"}]}