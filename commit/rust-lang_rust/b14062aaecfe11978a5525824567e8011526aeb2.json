{"sha": "b14062aaecfe11978a5525824567e8011526aeb2", "node_id": "C_kwDOAAsO6NoAKGIxNDA2MmFhZWNmZTExOTc4YTU1MjU4MjQ1NjdlODAxMTUyNmFlYjI", "commit": {"author": {"name": "Ryo Yoshida", "email": "low.ryoshida@gmail.com", "date": "2022-08-08T15:00:22Z"}, "committer": {"name": "Ryo Yoshida", "email": "low.ryoshida@gmail.com", "date": "2022-08-08T15:00:22Z"}, "message": "Parse range patterns in let statement with type annotation", "tree": {"sha": "bf51c9732f5056cf2fe9549d30e9327bf523c5bc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bf51c9732f5056cf2fe9549d30e9327bf523c5bc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b14062aaecfe11978a5525824567e8011526aeb2", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEkSbsQIURluxz4rzf4laYqTBYYXEFAmLxJR0ACgkQ4laYqTBY\nYXF9jg/+KApP0Qns23e+GH0KBJl0etSBSyMcVpsOwQrEi2ACOoq5h40cqKVQ3d5X\nEkH6yfgO6jDTfWgTyZKekS1e1Yk8c/4MGZz5YH3jkK5KrGkXH3r8p/jqJDk5vKkM\n8IxRhWnVHZOypw/s1uBBWqbQuVqpU/CuLm8NbI6NzQrvFqpmhiL/nde+h4ZlObVP\nOQXa5T5bLI4AknvVOhmhOpSEFo3MM0lYSJ0t0OkUbVOegceF4Xv0avrFX6EsHeOg\n193TSWDW1q2xPqdMgb8oiFPIny0ZiSSA1QQsOCqhFAGflvoupF/dPZzVm2+QnSMh\nEmBIk3j59ZkhWhAp8zCPNoHy31vEJ5QJnn61Tl4/sp7D52ZqHa7AaymZuGUoQ9P0\nY1HY2MNO7MvHq8IUjH16BrIVN8RUh0FjRjr3Dx7jRIidm9lszO2RkCQjlRNdqi2B\n+U37yb7RB/COj9D6Zva9LCMfPSIDwY81zM+MPBigGuTVDlFoBUGMn6uxFaS1+DtH\nF0OOCNuC5Qd2YjnMABwrmz+68lwL85exrwH81JxEEWa/UenB/S5fQM9YtKHplaoO\n1BeQHpCHaqM1TNR5XWCo4wtjl40rEXMmASEtfjAG7aRzaHbw3B6L/KD9GtxBBjCm\nCcQ7fRQmtL01z5m2nrLGi5kafE/6iRYwFNKKWL4HV8sLGoBrJbQ=\n=d1rv\n-----END PGP SIGNATURE-----", "payload": "tree bf51c9732f5056cf2fe9549d30e9327bf523c5bc\nparent a81c7a2974841f335fd87bfd8c3c3b8a7c3d3612\nauthor Ryo Yoshida <low.ryoshida@gmail.com> 1659970822 +0900\ncommitter Ryo Yoshida <low.ryoshida@gmail.com> 1659970822 +0900\n\nParse range patterns in let statement with type annotation\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b14062aaecfe11978a5525824567e8011526aeb2", "html_url": "https://github.com/rust-lang/rust/commit/b14062aaecfe11978a5525824567e8011526aeb2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b14062aaecfe11978a5525824567e8011526aeb2/comments", "author": {"login": "lowr", "id": 24381114, "node_id": "MDQ6VXNlcjI0MzgxMTE0", "avatar_url": "https://avatars.githubusercontent.com/u/24381114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lowr", "html_url": "https://github.com/lowr", "followers_url": "https://api.github.com/users/lowr/followers", "following_url": "https://api.github.com/users/lowr/following{/other_user}", "gists_url": "https://api.github.com/users/lowr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lowr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lowr/subscriptions", "organizations_url": "https://api.github.com/users/lowr/orgs", "repos_url": "https://api.github.com/users/lowr/repos", "events_url": "https://api.github.com/users/lowr/events{/privacy}", "received_events_url": "https://api.github.com/users/lowr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lowr", "id": 24381114, "node_id": "MDQ6VXNlcjI0MzgxMTE0", "avatar_url": "https://avatars.githubusercontent.com/u/24381114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lowr", "html_url": "https://github.com/lowr", "followers_url": "https://api.github.com/users/lowr/followers", "following_url": "https://api.github.com/users/lowr/following{/other_user}", "gists_url": "https://api.github.com/users/lowr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lowr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lowr/subscriptions", "organizations_url": "https://api.github.com/users/lowr/orgs", "repos_url": "https://api.github.com/users/lowr/repos", "events_url": "https://api.github.com/users/lowr/events{/privacy}", "received_events_url": "https://api.github.com/users/lowr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a81c7a2974841f335fd87bfd8c3c3b8a7c3d3612", "url": "https://api.github.com/repos/rust-lang/rust/commits/a81c7a2974841f335fd87bfd8c3c3b8a7c3d3612", "html_url": "https://github.com/rust-lang/rust/commit/a81c7a2974841f335fd87bfd8c3c3b8a7c3d3612"}], "stats": {"total": 37, "additions": 32, "deletions": 5}, "files": [{"sha": "7e21a808da0a481af06c98aa2829ccdc7f27a17d", "filename": "crates/parser/src/grammar/patterns.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/b14062aaecfe11978a5525824567e8011526aeb2/crates%2Fparser%2Fsrc%2Fgrammar%2Fpatterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b14062aaecfe11978a5525824567e8011526aeb2/crates%2Fparser%2Fsrc%2Fgrammar%2Fpatterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Fsrc%2Fgrammar%2Fpatterns.rs?ref=b14062aaecfe11978a5525824567e8011526aeb2", "patch": "@@ -103,6 +103,8 @@ fn pattern_single_r(p: &mut Parser<'_>, recovery_set: TokenSet) {\n                 //       ^\n                 // `let 0 .. =`\n                 //           ^\n+                // `let 0..: _ =`\n+                //         ^\n                 // (1.., _)\n                 //     ^\n                 // `Some(0 .. )`\n@@ -111,9 +113,12 @@ fn pattern_single_r(p: &mut Parser<'_>, recovery_set: TokenSet) {\n                 //             ^\n                 // `[0..]`\n                 //      ^\n-                if p.at(T![=]) | p.at(T![')']) | p.at(T![,]) | p.at(T!['}']) | p.at(T![']']) {\n+                if matches!(p.current(), T![=] | T![,] | T![:] | T![')'] | T!['}'] | T![']']) {\n                     // test half_open_range_pat\n-                    // fn f() { let 0 .. = 1u32; }\n+                    // fn f() {\n+                    //     let 0 .. = 1u32;\n+                    //     let 0..: _ = 1u32;\n+                    // }\n                 } else {\n                     atom_pat(p, recovery_set);\n                 }"}, {"sha": "4b401b60df0cec3058cfc02ce3df34412122ade7", "filename": "crates/parser/test_data/parser/inline/ok/0166_half_open_range_pat.rast", "status": "modified", "additions": 21, "deletions": 2, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/b14062aaecfe11978a5525824567e8011526aeb2/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Fok%2F0166_half_open_range_pat.rast", "raw_url": "https://github.com/rust-lang/rust/raw/b14062aaecfe11978a5525824567e8011526aeb2/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Fok%2F0166_half_open_range_pat.rast", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Fok%2F0166_half_open_range_pat.rast?ref=b14062aaecfe11978a5525824567e8011526aeb2", "patch": "@@ -11,7 +11,7 @@ SOURCE_FILE\n     BLOCK_EXPR\n       STMT_LIST\n         L_CURLY \"{\"\n-        WHITESPACE \" \"\n+        WHITESPACE \"\\n    \"\n         LET_STMT\n           LET_KW \"let\"\n           WHITESPACE \" \"\n@@ -27,6 +27,25 @@ SOURCE_FILE\n           LITERAL\n             INT_NUMBER \"1u32\"\n           SEMICOLON \";\"\n-        WHITESPACE \" \"\n+        WHITESPACE \"\\n    \"\n+        LET_STMT\n+          LET_KW \"let\"\n+          WHITESPACE \" \"\n+          RANGE_PAT\n+            LITERAL_PAT\n+              LITERAL\n+                INT_NUMBER \"0\"\n+            DOT2 \"..\"\n+          COLON \":\"\n+          WHITESPACE \" \"\n+          INFER_TYPE\n+            UNDERSCORE \"_\"\n+          WHITESPACE \" \"\n+          EQ \"=\"\n+          WHITESPACE \" \"\n+          LITERAL\n+            INT_NUMBER \"1u32\"\n+          SEMICOLON \";\"\n+        WHITESPACE \"\\n\"\n         R_CURLY \"}\"\n   WHITESPACE \"\\n\""}, {"sha": "c9386a221a9556d18f00ff241c48b4a7e9b08575", "filename": "crates/parser/test_data/parser/inline/ok/0166_half_open_range_pat.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/b14062aaecfe11978a5525824567e8011526aeb2/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Fok%2F0166_half_open_range_pat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b14062aaecfe11978a5525824567e8011526aeb2/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Fok%2F0166_half_open_range_pat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Fok%2F0166_half_open_range_pat.rs?ref=b14062aaecfe11978a5525824567e8011526aeb2", "patch": "@@ -1 +1,4 @@\n-fn f() { let 0 .. = 1u32; }\n+fn f() {\n+    let 0 .. = 1u32;\n+    let 0..: _ = 1u32;\n+}"}]}