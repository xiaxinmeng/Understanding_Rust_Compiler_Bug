{"sha": "90cf0cc6c2332cc40e22856a40af1b436baae84b", "node_id": "C_kwDOAAsO6NoAKDkwY2YwY2M2YzIzMzJjYzQwZTIyODU2YTQwYWYxYjQzNmJhYWU4NGI", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2023-02-17T18:25:47Z"}, "committer": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2023-02-17T18:26:22Z"}, "message": "Don't delay ReError bug during lexical region resolve", "tree": {"sha": "f1b61c919cc82819b61a61d9d9f3f6b464d462fb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f1b61c919cc82819b61a61d9d9f3f6b464d462fb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/90cf0cc6c2332cc40e22856a40af1b436baae84b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/90cf0cc6c2332cc40e22856a40af1b436baae84b", "html_url": "https://github.com/rust-lang/rust/commit/90cf0cc6c2332cc40e22856a40af1b436baae84b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/90cf0cc6c2332cc40e22856a40af1b436baae84b/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f722b24eb9ea35a7cc187a1cb5c50d4d324f5855", "url": "https://api.github.com/repos/rust-lang/rust/commits/f722b24eb9ea35a7cc187a1cb5c50d4d324f5855", "html_url": "https://github.com/rust-lang/rust/commit/f722b24eb9ea35a7cc187a1cb5c50d4d324f5855"}], "stats": {"total": 39, "additions": 38, "deletions": 1}, "files": [{"sha": "e6b7602f334cb3db85c17b200cf7292e405c1901", "filename": "compiler/rustc_infer/src/infer/lexical_region_resolve/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/90cf0cc6c2332cc40e22856a40af1b436baae84b/compiler%2Frustc_infer%2Fsrc%2Finfer%2Flexical_region_resolve%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/90cf0cc6c2332cc40e22856a40af1b436baae84b/compiler%2Frustc_infer%2Fsrc%2Finfer%2Flexical_region_resolve%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_infer%2Fsrc%2Finfer%2Flexical_region_resolve%2Fmod.rs?ref=90cf0cc6c2332cc40e22856a40af1b436baae84b", "patch": "@@ -1046,7 +1046,7 @@ impl<'tcx> LexicalRegionResolutions<'tcx> {\n             ty::ReVar(rid) => match self.values[rid] {\n                 VarValue::Empty(_) => r,\n                 VarValue::Value(r) => r,\n-                VarValue::ErrorValue => tcx.mk_re_error_misc(),\n+                VarValue::ErrorValue => tcx.lifetimes.re_static,\n             },\n             _ => r,\n         };"}, {"sha": "f37b27a82b3637685649dcf00419e05aae654049", "filename": "tests/ui/regions/resolve-re-error-ice.rs", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/90cf0cc6c2332cc40e22856a40af1b436baae84b/tests%2Fui%2Fregions%2Fresolve-re-error-ice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/90cf0cc6c2332cc40e22856a40af1b436baae84b/tests%2Fui%2Fregions%2Fresolve-re-error-ice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fregions%2Fresolve-re-error-ice.rs?ref=90cf0cc6c2332cc40e22856a40af1b436baae84b", "patch": "@@ -0,0 +1,22 @@\n+// check-pass\n+\n+// Allow this for now, can remove this UI test when this becomes a hard error.\n+#![allow(implied_bounds_entailment)]\n+\n+use std::collections::hash_map::{Keys, HashMap};\n+use std::marker::PhantomData;\n+\n+trait MapAssertion<'a, K, V, R> {\n+    fn key_set(&self) -> Subject<Keys<K, V>, (), R>;\n+}\n+\n+struct Subject<'a, T, V, R>(PhantomData<(&'a T, V, R)>);\n+\n+impl<'a, K, V, R> MapAssertion<'a, K, V, R> for Subject<'a, HashMap<K, V>, (), R>\n+{\n+    fn key_set(&self) -> Subject<'a, Keys<K, V>, (), R> {\n+        todo!()\n+    }\n+}\n+\n+fn main() {}"}, {"sha": "e7003e1c32f6477b0314db23f7ca8105bd43560d", "filename": "tests/ui/regions/resolve-re-error-ice.stderr", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/90cf0cc6c2332cc40e22856a40af1b436baae84b/tests%2Fui%2Fregions%2Fresolve-re-error-ice.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/90cf0cc6c2332cc40e22856a40af1b436baae84b/tests%2Fui%2Fregions%2Fresolve-re-error-ice.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fregions%2Fresolve-re-error-ice.stderr?ref=90cf0cc6c2332cc40e22856a40af1b436baae84b", "patch": "@@ -0,0 +1,15 @@\n+Future incompatibility report: Future breakage diagnostic:\n+warning: impl method assumes more implied bounds than the corresponding trait method\n+  --> $DIR/resolve-re-error-ice.rs:17:16\n+   |\n+LL |     fn key_set(&self) -> Subject<'a, Keys<K, V>, (), R> {\n+   |                ^^^^^     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: replace this type to make the impl signature compatible: `Subject<'_, std::collections::hash_map::Keys<'_, K, V>, (), R>`\n+   |\n+   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n+   = note: for more information, see issue #105572 <https://github.com/rust-lang/rust/issues/105572>\n+note: the lint level is defined here\n+  --> $DIR/resolve-re-error-ice.rs:4:10\n+   |\n+LL | #![allow(implied_bounds_entailment)]\n+   |          ^^^^^^^^^^^^^^^^^^^^^^^^^\n+"}]}