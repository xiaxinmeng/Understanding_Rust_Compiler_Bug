{"sha": "10b9c1d3ca6182595dfa944577afaec62f024bda", "node_id": "C_kwDOAAsO6NoAKDEwYjljMWQzY2E2MTgyNTk1ZGZhOTQ0NTc3YWZhZWM2MmYwMjRiZGE", "commit": {"author": {"name": "Caleb Cartwright", "email": "caleb.cartwright@outlook.com", "date": "2023-01-26T01:43:06Z"}, "committer": {"name": "Caleb Cartwright", "email": "caleb.cartwright@outlook.com", "date": "2023-02-02T03:16:54Z"}, "message": "docs(style-guide): add rules for let-else statements", "tree": {"sha": "d8fce9d345b215472bf1b6266dd02524660562f5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d8fce9d345b215472bf1b6266dd02524660562f5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/10b9c1d3ca6182595dfa944577afaec62f024bda", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/10b9c1d3ca6182595dfa944577afaec62f024bda", "html_url": "https://github.com/rust-lang/rust/commit/10b9c1d3ca6182595dfa944577afaec62f024bda", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/10b9c1d3ca6182595dfa944577afaec62f024bda/comments", "author": {"login": "calebcartwright", "id": 13042488, "node_id": "MDQ6VXNlcjEzMDQyNDg4", "avatar_url": "https://avatars.githubusercontent.com/u/13042488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/calebcartwright", "html_url": "https://github.com/calebcartwright", "followers_url": "https://api.github.com/users/calebcartwright/followers", "following_url": "https://api.github.com/users/calebcartwright/following{/other_user}", "gists_url": "https://api.github.com/users/calebcartwright/gists{/gist_id}", "starred_url": "https://api.github.com/users/calebcartwright/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/calebcartwright/subscriptions", "organizations_url": "https://api.github.com/users/calebcartwright/orgs", "repos_url": "https://api.github.com/users/calebcartwright/repos", "events_url": "https://api.github.com/users/calebcartwright/events{/privacy}", "received_events_url": "https://api.github.com/users/calebcartwright/received_events", "type": "User", "site_admin": false}, "committer": {"login": "calebcartwright", "id": 13042488, "node_id": "MDQ6VXNlcjEzMDQyNDg4", "avatar_url": "https://avatars.githubusercontent.com/u/13042488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/calebcartwright", "html_url": "https://github.com/calebcartwright", "followers_url": "https://api.github.com/users/calebcartwright/followers", "following_url": "https://api.github.com/users/calebcartwright/following{/other_user}", "gists_url": "https://api.github.com/users/calebcartwright/gists{/gist_id}", "starred_url": "https://api.github.com/users/calebcartwright/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/calebcartwright/subscriptions", "organizations_url": "https://api.github.com/users/calebcartwright/orgs", "repos_url": "https://api.github.com/users/calebcartwright/repos", "events_url": "https://api.github.com/users/calebcartwright/events{/privacy}", "received_events_url": "https://api.github.com/users/calebcartwright/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c18a5e8a5b1afb0d7a582fe9ebad4c1996c90da3", "url": "https://api.github.com/repos/rust-lang/rust/commits/c18a5e8a5b1afb0d7a582fe9ebad4c1996c90da3", "html_url": "https://github.com/rust-lang/rust/commit/c18a5e8a5b1afb0d7a582fe9ebad4c1996c90da3"}], "stats": {"total": 78, "additions": 78, "deletions": 0}, "files": [{"sha": "4ab1c36f976525dfcfb3a44e568d11305b8e6efd", "filename": "src/doc/style-guide/src/statements.md", "status": "modified", "additions": 78, "deletions": 0, "changes": 78, "blob_url": "https://github.com/rust-lang/rust/blob/10b9c1d3ca6182595dfa944577afaec62f024bda/src%2Fdoc%2Fstyle-guide%2Fsrc%2Fstatements.md", "raw_url": "https://github.com/rust-lang/rust/raw/10b9c1d3ca6182595dfa944577afaec62f024bda/src%2Fdoc%2Fstyle-guide%2Fsrc%2Fstatements.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Fstyle-guide%2Fsrc%2Fstatements.md?ref=10b9c1d3ca6182595dfa944577afaec62f024bda", "patch": "@@ -99,6 +99,84 @@ let Foo {\n );\n ```\n \n+#### else blocks (let-else statements)\n+\n+If a let statement contains an `else` component, also known as a let-else statement,\n+then the `else` component should be formatted according to the same rules as the `else` block\n+in [control flow expressions (i.e. if-else, and if-let-else expressions)](./expressions.md#control-flow-expressions).\n+Apply the same formatting rules to the components preceding\n+the `else` block (i.e. the `let pattern: Type = initializer_expr ...` portion)\n+as described [above](#let-statements)\n+\n+Similarly to if-else expressions, if the initializer\n+expression is multi-lined, then the `else` keyword and opening brace of the block (i.e. `else {`)\n+should be put on the same line as the end of the initializer\n+expression with a preceding space if all the following are true:\n+\n+* The initializer expression ends with one or more closing\n+  parentheses, square brackets, and/or braces\n+* There is nothing else on that line\n+* That line is not indented beyond the indent of the first line containing the `let` keyword\n+\n+For example:\n+\n+```rust\n+let Some(x) = y.foo(\n+    \"abc\",\n+    fairly_long_identifier,\n+    \"def\",\n+    \"123456\",\n+    \"string\",\n+    \"cheese\",\n+) else {\n+    bar()\n+}\n+```\n+\n+Otherwise, the `else` keyword and opening brace should be placed on the next line after the end of the initializer expression, and should not be indented (the `else` keyword should be aligned with the `let` keyword).\n+\n+For example:\n+\n+```rust\n+let Some(x) = abcdef()\n+    .foo(\n+        \"abc\",\n+        some_really_really_really_long_ident,\n+        \"ident\",\n+        \"123456\",\n+    )\n+    .bar()\n+    .baz()\n+    .qux(\"fffffffffffffffff\")\n+else {\n+    foo_bar()\n+}\n+```\n+\n+##### Single line let-else statements\n+\n+The entire let-else statement may be formatted on a single line if all the following are true:\n+\n+* the entire statement is *short*\n+* the `else` block contains a single-line expression and no statements\n+* the `else` block contains no comments\n+* the let statement components preceding the `else` block can be formatted on a single line\n+\n+```rust\n+let Some(1) = opt else { return };\n+\n+let Some(1) = opt else {\n+    return;\n+};\n+\n+let Some(1) = opt else {\n+    // nope\n+    return\n+};\n+```\n+\n+Formatters may allow users to configure the value of the threshold\n+used to determine whether a let-else statement is *short*.\n \n ### Macros in statement position\n "}]}