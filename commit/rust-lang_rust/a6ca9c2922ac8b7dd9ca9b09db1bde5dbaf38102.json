{"sha": "a6ca9c2922ac8b7dd9ca9b09db1bde5dbaf38102", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE2Y2E5YzI5MjJhYzhiN2RkOWNhOWIwOWRiMWJkZTVkYmFmMzgxMDI=", "commit": {"author": {"name": "Rafael \u00c1vila de Esp\u00edndola", "email": "respindola@mozilla.com", "date": "2011-06-01T19:59:28Z"}, "committer": {"name": "Rafael \u00c1vila de Esp\u00edndola", "email": "respindola@mozilla.com", "date": "2011-06-01T19:59:28Z"}, "message": "Don't create an empty section.", "tree": {"sha": "7626d99f61819fb939bce0423affe165b5243978", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7626d99f61819fb939bce0423affe165b5243978"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a6ca9c2922ac8b7dd9ca9b09db1bde5dbaf38102", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a6ca9c2922ac8b7dd9ca9b09db1bde5dbaf38102", "html_url": "https://github.com/rust-lang/rust/commit/a6ca9c2922ac8b7dd9ca9b09db1bde5dbaf38102", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a6ca9c2922ac8b7dd9ca9b09db1bde5dbaf38102/comments", "author": null, "committer": null, "parents": [{"sha": "30efdeeca1bd0d60412fdb9e88eba6336ffcacea", "url": "https://api.github.com/repos/rust-lang/rust/commits/30efdeeca1bd0d60412fdb9e88eba6336ffcacea", "html_url": "https://github.com/rust-lang/rust/commit/30efdeeca1bd0d60412fdb9e88eba6336ffcacea"}], "stats": {"total": 6, "additions": 3, "deletions": 3}, "files": [{"sha": "bee1cd17ade1d3fab0ac8872caa204abac48ada8", "filename": "src/comp/middle/metadata.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a6ca9c2922ac8b7dd9ca9b09db1bde5dbaf38102/src%2Fcomp%2Fmiddle%2Fmetadata.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a6ca9c2922ac8b7dd9ca9b09db1bde5dbaf38102/src%2Fcomp%2Fmiddle%2Fmetadata.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Fmetadata.rs?ref=a6ca9c2922ac8b7dd9ca9b09db1bde5dbaf38102", "patch": "@@ -716,11 +716,11 @@ fn encode_metadata(&@trans::crate_ctxt cx, &@ast::crate crate)\n }\n \n fn write_metadata(&@trans::crate_ctxt cx, &@ast::crate crate) {\n-    auto llmeta = C_postr(\"\");\n-    if (cx.sess.get_opts().shared) {\n-        llmeta = encode_metadata(cx, crate);\n+    if (!cx.sess.get_opts().shared) {\n+        ret;\n     }\n \n+    auto llmeta = encode_metadata(cx, crate);\n     auto llconst = trans::C_struct([llmeta]);\n     auto llglobal = llvm::LLVMAddGlobal(cx.llmod, trans::val_ty(llconst),\n                                        str::buf(\"rust_metadata\"));"}]}