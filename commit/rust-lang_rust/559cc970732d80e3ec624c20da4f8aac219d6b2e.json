{"sha": "559cc970732d80e3ec624c20da4f8aac219d6b2e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU1OWNjOTcwNzMyZDgwZTNlYzYyNGMyMGRhNGY4YWFjMjE5ZDZiMmU=", "commit": {"author": {"name": "Igor Aleksanov", "email": "popzxc@yandex.ru", "date": "2020-10-08T05:33:35Z"}, "committer": {"name": "Igor Aleksanov", "email": "popzxc@yandex.ru", "date": "2020-10-12T08:05:00Z"}, "message": "Add to_upper_snake_case function to stdx", "tree": {"sha": "cc0efeae2653890f8c178c4b970851d7fc9552af", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cc0efeae2653890f8c178c4b970851d7fc9552af"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/559cc970732d80e3ec624c20da4f8aac219d6b2e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/559cc970732d80e3ec624c20da4f8aac219d6b2e", "html_url": "https://github.com/rust-lang/rust/commit/559cc970732d80e3ec624c20da4f8aac219d6b2e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/559cc970732d80e3ec624c20da4f8aac219d6b2e/comments", "author": {"login": "popzxc", "id": 12111581, "node_id": "MDQ6VXNlcjEyMTExNTgx", "avatar_url": "https://avatars.githubusercontent.com/u/12111581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/popzxc", "html_url": "https://github.com/popzxc", "followers_url": "https://api.github.com/users/popzxc/followers", "following_url": "https://api.github.com/users/popzxc/following{/other_user}", "gists_url": "https://api.github.com/users/popzxc/gists{/gist_id}", "starred_url": "https://api.github.com/users/popzxc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/popzxc/subscriptions", "organizations_url": "https://api.github.com/users/popzxc/orgs", "repos_url": "https://api.github.com/users/popzxc/repos", "events_url": "https://api.github.com/users/popzxc/events{/privacy}", "received_events_url": "https://api.github.com/users/popzxc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "popzxc", "id": 12111581, "node_id": "MDQ6VXNlcjEyMTExNTgx", "avatar_url": "https://avatars.githubusercontent.com/u/12111581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/popzxc", "html_url": "https://github.com/popzxc", "followers_url": "https://api.github.com/users/popzxc/followers", "following_url": "https://api.github.com/users/popzxc/following{/other_user}", "gists_url": "https://api.github.com/users/popzxc/gists{/gist_id}", "starred_url": "https://api.github.com/users/popzxc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/popzxc/subscriptions", "organizations_url": "https://api.github.com/users/popzxc/orgs", "repos_url": "https://api.github.com/users/popzxc/repos", "events_url": "https://api.github.com/users/popzxc/events{/privacy}", "received_events_url": "https://api.github.com/users/popzxc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ebd30033b3743fafe0a0182b5ae34ffb27fe43ff", "url": "https://api.github.com/repos/rust-lang/rust/commits/ebd30033b3743fafe0a0182b5ae34ffb27fe43ff", "html_url": "https://github.com/rust-lang/rust/commit/ebd30033b3743fafe0a0182b5ae34ffb27fe43ff"}], "stats": {"total": 19, "additions": 13, "deletions": 6}, "files": [{"sha": "901ccc94f65b97136fa37af00942fb44a2e930b7", "filename": "crates/hir_ty/src/diagnostics/decl_check.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/559cc970732d80e3ec624c20da4f8aac219d6b2e/crates%2Fhir_ty%2Fsrc%2Fdiagnostics%2Fdecl_check.rs", "raw_url": "https://github.com/rust-lang/rust/raw/559cc970732d80e3ec624c20da4f8aac219d6b2e/crates%2Fhir_ty%2Fsrc%2Fdiagnostics%2Fdecl_check.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Fdiagnostics%2Fdecl_check.rs?ref=559cc970732d80e3ec624c20da4f8aac219d6b2e", "patch": "@@ -10,7 +10,7 @@\n //! - static items (e.g. `static FOO: u8 = 10;`)\n //! - match arm bindings (e.g. `foo @ Some(_)`)\n \n-mod str_helpers;\n+mod case_conv;\n \n use hir_def::{\n     adt::VariantData,\n@@ -29,7 +29,7 @@ use syntax::{\n \n use crate::{\n     db::HirDatabase,\n-    diagnostics::{decl_check::str_helpers::*, CaseType, IncorrectCase},\n+    diagnostics::{decl_check::case_conv::*, CaseType, IncorrectCase},\n };\n \n pub(super) struct DeclValidator<'a, 'b: 'a> {"}, {"sha": "3800f2a6b355a40f18bb71c7f5d429c59695136f", "filename": "crates/hir_ty/src/diagnostics/decl_check/case_conv.rs", "status": "renamed", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/559cc970732d80e3ec624c20da4f8aac219d6b2e/crates%2Fhir_ty%2Fsrc%2Fdiagnostics%2Fdecl_check%2Fcase_conv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/559cc970732d80e3ec624c20da4f8aac219d6b2e/crates%2Fhir_ty%2Fsrc%2Fdiagnostics%2Fdecl_check%2Fcase_conv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Fdiagnostics%2Fdecl_check%2Fcase_conv.rs?ref=559cc970732d80e3ec624c20da4f8aac219d6b2e", "patch": "@@ -136,8 +136,7 @@ pub fn to_upper_snake_case(ident: &str) -> Option<String> {\n     }\n \n     // Normalize the string from whatever form it's in currently, and then just make it uppercase.\n-    let upper_snake_case =\n-        stdx::to_lower_snake_case(ident).chars().map(|c| c.to_ascii_uppercase()).collect();\n+    let upper_snake_case = stdx::to_upper_snake_case(ident);\n \n     if upper_snake_case == ident {\n         // While we didn't detect the correct case at the beginning, there", "previous_filename": "crates/hir_ty/src/diagnostics/decl_check/str_helpers.rs"}, {"sha": "59d89f47d1c2d9946f2bdd90030883be5e7934ab", "filename": "crates/stdx/src/lib.rs", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/559cc970732d80e3ec624c20da4f8aac219d6b2e/crates%2Fstdx%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/559cc970732d80e3ec624c20da4f8aac219d6b2e/crates%2Fstdx%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fstdx%2Fsrc%2Flib.rs?ref=559cc970732d80e3ec624c20da4f8aac219d6b2e", "patch": "@@ -28,7 +28,7 @@ pub fn timeit(label: &'static str) -> impl Drop {\n     Guard { label, start: Instant::now() }\n }\n \n-pub fn to_lower_snake_case(s: &str) -> String {\n+fn to_snake_case<F: Fn(&char) -> char>(s: &str, change_case: F) -> String {\n     let mut buf = String::with_capacity(s.len());\n     let mut prev = false;\n     for c in s.chars() {\n@@ -41,11 +41,19 @@ pub fn to_lower_snake_case(s: &str) -> String {\n         }\n         prev = true;\n \n-        buf.push(c.to_ascii_lowercase());\n+        buf.push(change_case(&c));\n     }\n     buf\n }\n \n+pub fn to_lower_snake_case(s: &str) -> String {\n+    to_snake_case(s, char::to_ascii_lowercase)\n+}\n+\n+pub fn to_upper_snake_case(s: &str) -> String {\n+    to_snake_case(s, char::to_ascii_uppercase)\n+}\n+\n pub fn replace(buf: &mut String, from: char, to: &str) {\n     if !buf.contains(from) {\n         return;"}]}