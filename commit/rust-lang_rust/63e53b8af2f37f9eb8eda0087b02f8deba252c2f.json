{"sha": "63e53b8af2f37f9eb8eda0087b02f8deba252c2f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYzZTUzYjhhZjJmMzdmOWViOGVkYTAwODdiMDJmOGRlYmEyNTJjMmY=", "commit": {"author": {"name": "klutzy", "email": "klutzytheklutzy@gmail.com", "date": "2013-08-12T13:36:57Z"}, "committer": {"name": "klutzy", "email": "klutzytheklutzy@gmail.com", "date": "2013-08-26T13:15:45Z"}, "message": "rt: Support SEH/SJLJ personality routine", "tree": {"sha": "8c50a39f1d4bbf112dd05bb796027707d904e3a3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8c50a39f1d4bbf112dd05bb796027707d904e3a3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/63e53b8af2f37f9eb8eda0087b02f8deba252c2f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/63e53b8af2f37f9eb8eda0087b02f8deba252c2f", "html_url": "https://github.com/rust-lang/rust/commit/63e53b8af2f37f9eb8eda0087b02f8deba252c2f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/63e53b8af2f37f9eb8eda0087b02f8deba252c2f/comments", "author": {"login": "klutzy", "id": 1589355, "node_id": "MDQ6VXNlcjE1ODkzNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1589355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klutzy", "html_url": "https://github.com/klutzy", "followers_url": "https://api.github.com/users/klutzy/followers", "following_url": "https://api.github.com/users/klutzy/following{/other_user}", "gists_url": "https://api.github.com/users/klutzy/gists{/gist_id}", "starred_url": "https://api.github.com/users/klutzy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klutzy/subscriptions", "organizations_url": "https://api.github.com/users/klutzy/orgs", "repos_url": "https://api.github.com/users/klutzy/repos", "events_url": "https://api.github.com/users/klutzy/events{/privacy}", "received_events_url": "https://api.github.com/users/klutzy/received_events", "type": "User", "site_admin": false}, "committer": {"login": "klutzy", "id": 1589355, "node_id": "MDQ6VXNlcjE1ODkzNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1589355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klutzy", "html_url": "https://github.com/klutzy", "followers_url": "https://api.github.com/users/klutzy/followers", "following_url": "https://api.github.com/users/klutzy/following{/other_user}", "gists_url": "https://api.github.com/users/klutzy/gists{/gist_id}", "starred_url": "https://api.github.com/users/klutzy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klutzy/subscriptions", "organizations_url": "https://api.github.com/users/klutzy/orgs", "repos_url": "https://api.github.com/users/klutzy/repos", "events_url": "https://api.github.com/users/klutzy/events{/privacy}", "received_events_url": "https://api.github.com/users/klutzy/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ef20bd44bdf3a500700604c3b3c8f8969233fd9a", "url": "https://api.github.com/repos/rust-lang/rust/commits/ef20bd44bdf3a500700604c3b3c8f8969233fd9a", "html_url": "https://github.com/rust-lang/rust/commit/ef20bd44bdf3a500700604c3b3c8f8969233fd9a"}], "stats": {"total": 22, "additions": 16, "deletions": 6}, "files": [{"sha": "7ccb06a3296f4ced2905c390e120e949e6b8f317", "filename": "src/rt/rust_upcall.cpp", "status": "modified", "additions": 16, "deletions": 6, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/63e53b8af2f37f9eb8eda0087b02f8deba252c2f/src%2Frt%2Frust_upcall.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/63e53b8af2f37f9eb8eda0087b02f8deba252c2f/src%2Frt%2Frust_upcall.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_upcall.cpp?ref=63e53b8af2f37f9eb8eda0087b02f8deba252c2f", "patch": "@@ -54,8 +54,18 @@ upcall_call_shim_on_rust_stack(void *args, void *fn_ptr) {\n \n /**********************************************************************/\n \n+#ifdef __SEH__\n+#  define PERSONALITY_FUNC __gxx_personality_seh0\n+#else\n+#  ifdef __USING_SJLJ_EXCEPTIONS__\n+#    define PERSONALITY_FUNC __gxx_personality_sjlj\n+#  else\n+#    define PERSONALITY_FUNC __gxx_personality_v0\n+#  endif\n+#endif\n+\n extern \"C\" _Unwind_Reason_Code\n-__gxx_personality_v0(int version,\n+PERSONALITY_FUNC(int version,\n                      _Unwind_Action actions,\n                      uint64_t exception_class,\n                      _Unwind_Exception *ue_header,\n@@ -72,11 +82,11 @@ struct s_rust_personality_args {\n \n extern \"C\" void\n upcall_s_rust_personality(s_rust_personality_args *args) {\n-    args->retval = __gxx_personality_v0(args->version,\n-                                        args->actions,\n-                                        args->exception_class,\n-                                        args->ue_header,\n-                                        args->context);\n+    args->retval = PERSONALITY_FUNC(args->version,\n+                                    args->actions,\n+                                    args->exception_class,\n+                                    args->ue_header,\n+                                    args->context);\n }\n \n /**"}]}