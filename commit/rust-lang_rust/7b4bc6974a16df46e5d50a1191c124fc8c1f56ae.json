{"sha": "7b4bc6974a16df46e5d50a1191c124fc8c1f56ae", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdiNGJjNjk3NGExNmRmNDZlNWQ1MGExMTkxYzEyNGZjOGMxZjU2YWU=", "commit": {"author": {"name": "LooMaclin", "email": "loo.maclin@protonmail.com", "date": "2019-04-02T03:16:11Z"}, "committer": {"name": "LooMaclin", "email": "loo.maclin@protonmail.com", "date": "2019-04-02T03:16:11Z"}, "message": "Improve miri's error reporting in check_in_alloc", "tree": {"sha": "62986e8e4df85ab5dc363a5753a4026e39bc9bf0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/62986e8e4df85ab5dc363a5753a4026e39bc9bf0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7b4bc6974a16df46e5d50a1191c124fc8c1f56ae", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7b4bc6974a16df46e5d50a1191c124fc8c1f56ae", "html_url": "https://github.com/rust-lang/rust/commit/7b4bc6974a16df46e5d50a1191c124fc8c1f56ae", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7b4bc6974a16df46e5d50a1191c124fc8c1f56ae/comments", "author": {"login": "LooMaclin", "id": 10957765, "node_id": "MDQ6VXNlcjEwOTU3NzY1", "avatar_url": "https://avatars.githubusercontent.com/u/10957765?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LooMaclin", "html_url": "https://github.com/LooMaclin", "followers_url": "https://api.github.com/users/LooMaclin/followers", "following_url": "https://api.github.com/users/LooMaclin/following{/other_user}", "gists_url": "https://api.github.com/users/LooMaclin/gists{/gist_id}", "starred_url": "https://api.github.com/users/LooMaclin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LooMaclin/subscriptions", "organizations_url": "https://api.github.com/users/LooMaclin/orgs", "repos_url": "https://api.github.com/users/LooMaclin/repos", "events_url": "https://api.github.com/users/LooMaclin/events{/privacy}", "received_events_url": "https://api.github.com/users/LooMaclin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "LooMaclin", "id": 10957765, "node_id": "MDQ6VXNlcjEwOTU3NzY1", "avatar_url": "https://avatars.githubusercontent.com/u/10957765?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LooMaclin", "html_url": "https://github.com/LooMaclin", "followers_url": "https://api.github.com/users/LooMaclin/followers", "following_url": "https://api.github.com/users/LooMaclin/following{/other_user}", "gists_url": "https://api.github.com/users/LooMaclin/gists{/gist_id}", "starred_url": "https://api.github.com/users/LooMaclin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LooMaclin/subscriptions", "organizations_url": "https://api.github.com/users/LooMaclin/orgs", "repos_url": "https://api.github.com/users/LooMaclin/repos", "events_url": "https://api.github.com/users/LooMaclin/events{/privacy}", "received_events_url": "https://api.github.com/users/LooMaclin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "725199ce6512cc946d5b16c4ef3a845a2926cb09", "url": "https://api.github.com/repos/rust-lang/rust/commits/725199ce6512cc946d5b16c4ef3a845a2926cb09", "html_url": "https://github.com/rust-lang/rust/commit/725199ce6512cc946d5b16c4ef3a845a2926cb09"}], "stats": {"total": 9, "additions": 4, "deletions": 5}, "files": [{"sha": "a04316b719e83cc336164e47a68ed43c6e70ef0b", "filename": "src/librustc/mir/interpret/allocation.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7b4bc6974a16df46e5d50a1191c124fc8c1f56ae/src%2Flibrustc%2Fmir%2Finterpret%2Fallocation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7b4bc6974a16df46e5d50a1191c124fc8c1f56ae/src%2Flibrustc%2Fmir%2Finterpret%2Fallocation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmir%2Finterpret%2Fallocation.rs?ref=7b4bc6974a16df46e5d50a1191c124fc8c1f56ae", "patch": "@@ -22,8 +22,7 @@ pub enum InboundsCheck {\n     MaybeDead,\n }\n \n-/// Used by `check_in_alloc` to indicate whether the pointer needs to be just inbounds\n-/// or also inbounds of a *live* allocation.\n+/// Used by `check_in_alloc` to indicate context of check\n #[derive(Debug, Copy, Clone, RustcEncodable, RustcDecodable, HashStable)]\n pub enum CheckInAllocMsg {\n     ReadCStr,"}, {"sha": "80efafa655036c291f1dda4a77ac670c7a27683b", "filename": "src/librustc_mir/interpret/memory.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/7b4bc6974a16df46e5d50a1191c124fc8c1f56ae/src%2Flibrustc_mir%2Finterpret%2Fmemory.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7b4bc6974a16df46e5d50a1191c124fc8c1f56ae/src%2Flibrustc_mir%2Finterpret%2Fmemory.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Fmemory.rs?ref=7b4bc6974a16df46e5d50a1191c124fc8c1f56ae", "patch": "@@ -20,7 +20,7 @@ use syntax::ast::Mutability;\n use super::{\n     Pointer, AllocId, Allocation, GlobalId, AllocationExtra,\n     EvalResult, Scalar, EvalErrorKind, AllocKind, PointerArithmetic,\n-    Machine, AllocMap, MayLeak, ErrorHandled, InboundsCheck, CheckInAllocMsg,\n+    Machine, AllocMap, MayLeak, ErrorHandled, CheckInAllocMsg,\n };\n \n #[derive(Debug, PartialEq, Eq, Copy, Clone, Hash)]\n@@ -440,13 +440,13 @@ impl<'a, 'mir, 'tcx, M: Machine<'a, 'mir, 'tcx>> Memory<'a, 'mir, 'tcx, M> {\n                 Ok((layout.size, layout.align.abi))\n             }\n             _ => match msg {\n-                InboundsCheck::MaybeDead => {\n+                CheckInAllocMsg::CheckAlign | CheckInAllocMsg::ReadDiscriminant => {\n                     // Must be a deallocated pointer\n                     Ok(*self.dead_alloc_map.get(&id).expect(\n                         \"allocation missing in dead_alloc_map\"\n                     ))\n                 },\n-                InboundsCheck::Live => err!(DanglingPointerDeref),\n+                _ => err!(DanglingPointerDeref),\n             },\n         }\n     }"}]}