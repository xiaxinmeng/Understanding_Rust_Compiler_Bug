{"sha": "1ac470f70c9de77cbd5fd6e5c5a624e55af81fad", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFhYzQ3MGY3MGM5ZGU3N2NiZDVmZDZlNWM1YTYyNGU1NWFmODFmYWQ=", "commit": {"author": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2019-11-13T00:00:00Z"}, "committer": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2019-11-13T17:29:55Z"}, "message": "compiletest: Avoid double negation in ignore condition", "tree": {"sha": "e04394e8643e8662f563fce6c101e68111e99eb0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e04394e8643e8662f563fce6c101e68111e99eb0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1ac470f70c9de77cbd5fd6e5c5a624e55af81fad", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1ac470f70c9de77cbd5fd6e5c5a624e55af81fad", "html_url": "https://github.com/rust-lang/rust/commit/1ac470f70c9de77cbd5fd6e5c5a624e55af81fad", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1ac470f70c9de77cbd5fd6e5c5a624e55af81fad/comments", "author": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8c6e29781692c28746b914e3fbb713600d05f588", "url": "https://api.github.com/repos/rust-lang/rust/commits/8c6e29781692c28746b914e3fbb713600d05f588", "html_url": "https://github.com/rust-lang/rust/commit/8c6e29781692c28746b914e3fbb713600d05f588"}], "stats": {"total": 11, "additions": 6, "deletions": 5}, "files": [{"sha": "1cbf44287e1505cc2282dc5b65d8db83f9313c8c", "filename": "src/tools/compiletest/src/main.rs", "status": "modified", "additions": 6, "deletions": 5, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/1ac470f70c9de77cbd5fd6e5c5a624e55af81fad/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1ac470f70c9de77cbd5fd6e5c5a624e55af81fad/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs?ref=1ac470f70c9de77cbd5fd6e5c5a624e55af81fad", "patch": "@@ -731,7 +731,8 @@ fn make_test(config: &Config, testpaths: &TestPaths, inputs: &Stamp) -> Vec<test\n                     && config.target.contains(\"emscripten\"))\n                 || (config.mode == DebugInfoGdb && !early_props.ignore.can_run_gdb())\n                 || (config.mode == DebugInfoLldb && !early_props.ignore.can_run_lldb())\n-                || !is_outdated(\n+                // Ignore tests that already run and are up to date with respect to inputs.\n+                || is_up_to_date(\n                     config,\n                     testpaths,\n                     &early_props,\n@@ -756,7 +757,7 @@ fn stamp(config: &Config, testpaths: &TestPaths, revision: Option<&str>) -> Path\n     output_base_dir(config, testpaths, revision).join(\"stamp\")\n }\n \n-fn is_outdated(\n+fn is_up_to_date(\n     config: &Config,\n     testpaths: &TestPaths,\n     props: &EarlyProps,\n@@ -768,11 +769,11 @@ fn is_outdated(\n     let contents = match fs::read_to_string(&stamp_name) {\n         Ok(f) => f,\n         Err(ref e) if e.kind() == ErrorKind::InvalidData => panic!(\"Can't read stamp contents\"),\n-        Err(_) => return true,\n+        Err(_) => return false,\n     };\n     let expected_hash = runtest::compute_stamp_hash(config);\n     if contents != expected_hash {\n-        return true;\n+        return false;\n     }\n \n     // Check timestamps.\n@@ -793,7 +794,7 @@ fn is_outdated(\n         inputs.add_path(path);\n     }\n \n-    inputs > Stamp::from_path(&stamp_name)\n+    inputs < Stamp::from_path(&stamp_name)\n }\n \n #[derive(Clone, Debug, PartialEq, Eq, PartialOrd, Ord)]"}]}