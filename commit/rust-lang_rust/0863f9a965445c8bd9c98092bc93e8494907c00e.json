{"sha": "0863f9a965445c8bd9c98092bc93e8494907c00e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA4NjNmOWE5NjU0NDVjOGJkOWM5ODA5MmJjOTNlODQ5NDkwN2MwMGU=", "commit": {"author": {"name": "ecstatic-morse", "email": "ecstaticmorse@gmail.com", "date": "2020-09-22T03:41:01Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-09-22T03:41:01Z"}, "message": "Rollup merge of #77032 - lcnr:visit-all-the-item-likes, r=davidtwco\n\nlint missing docs for extern items\n\nfixes #76991", "tree": {"sha": "da0955a36edabba33d09d4125996970b629efab7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/da0955a36edabba33d09d4125996970b629efab7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0863f9a965445c8bd9c98092bc93e8494907c00e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfaXJNCRBK7hj4Ov3rIwAAdHIIABdooDP1PTYAwS227SMwZ6Z7\nC+iVTHgFY1FeE+mJYrKosyM1+OCGyokvLayyWa6S1D7SqBL4GAWFz8VxfKJkJ9kj\nl8UKsz6HVvAUqSbk0ey9CoF9ltZ4xtjuLUHR2oBI7EYhxz4Zcdp5H1nHnKRU/EUR\nnRvsq8GpCxkfm5bQ6ftz4l0Ov9N07M/I8Yj+9kf4JN9nExh9JXg/HsYkXk3nwedD\nM3NTIsvDu9vQm0YJDb3lAFdnRyUEmV0+DCVDEwiLTbYzDUAAv1VPsVOHfrfmnsPi\nh4eEopzdYFS2RXLcXYdLLRr0Ji1vUxLsuTobsbfusQS4z/ODQxUzCf7jQlxllJ8=\n=2uA+\n-----END PGP SIGNATURE-----\n", "payload": "tree da0955a36edabba33d09d4125996970b629efab7\nparent 359615b852b503378cac85068b0c06c43d04cdfb\nparent d452744100203c9f75202079ce7c8ad8aa1bdf02\nauthor ecstatic-morse <ecstaticmorse@gmail.com> 1600746061 -0700\ncommitter GitHub <noreply@github.com> 1600746061 -0700\n\nRollup merge of #77032 - lcnr:visit-all-the-item-likes, r=davidtwco\n\nlint missing docs for extern items\n\nfixes #76991\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0863f9a965445c8bd9c98092bc93e8494907c00e", "html_url": "https://github.com/rust-lang/rust/commit/0863f9a965445c8bd9c98092bc93e8494907c00e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0863f9a965445c8bd9c98092bc93e8494907c00e/comments", "author": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "359615b852b503378cac85068b0c06c43d04cdfb", "url": "https://api.github.com/repos/rust-lang/rust/commits/359615b852b503378cac85068b0c06c43d04cdfb", "html_url": "https://github.com/rust-lang/rust/commit/359615b852b503378cac85068b0c06c43d04cdfb"}, {"sha": "d452744100203c9f75202079ce7c8ad8aa1bdf02", "url": "https://api.github.com/repos/rust-lang/rust/commits/d452744100203c9f75202079ce7c8ad8aa1bdf02", "html_url": "https://github.com/rust-lang/rust/commit/d452744100203c9f75202079ce7c8ad8aa1bdf02"}], "stats": {"total": 52, "additions": 50, "deletions": 2}, "files": [{"sha": "abd899e8db4d33b6d9447bc7078dd15d296281b1", "filename": "compiler/rustc_lint/src/builtin.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/0863f9a965445c8bd9c98092bc93e8494907c00e/compiler%2Frustc_lint%2Fsrc%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0863f9a965445c8bd9c98092bc93e8494907c00e/compiler%2Frustc_lint%2Fsrc%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Fbuiltin.rs?ref=0863f9a965445c8bd9c98092bc93e8494907c00e", "patch": "@@ -613,6 +613,19 @@ impl<'tcx> LateLintPass<'tcx> for MissingDoc {\n         );\n     }\n \n+    fn check_foreign_item(&mut self, cx: &LateContext<'_>, foreign_item: &hir::ForeignItem<'_>) {\n+        let def_id = cx.tcx.hir().local_def_id(foreign_item.hir_id);\n+        let (article, desc) = cx.tcx.article_and_description(def_id.to_def_id());\n+        self.check_missing_docs_attrs(\n+            cx,\n+            Some(foreign_item.hir_id),\n+            &foreign_item.attrs,\n+            foreign_item.span,\n+            article,\n+            desc,\n+        );\n+    }\n+\n     fn check_struct_field(&mut self, cx: &LateContext<'_>, sf: &hir::StructField<'_>) {\n         if !sf.is_positional() {\n             self.check_missing_docs_attrs("}, {"sha": "2297257919ee14cbb52fe5e1d42a2a14240bda41", "filename": "src/test/ui/lint/lint-missing-doc.rs", "status": "modified", "additions": 18, "deletions": 1, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/0863f9a965445c8bd9c98092bc93e8494907c00e/src%2Ftest%2Fui%2Flint%2Flint-missing-doc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0863f9a965445c8bd9c98092bc93e8494907c00e/src%2Ftest%2Fui%2Flint%2Flint-missing-doc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-missing-doc.rs?ref=0863f9a965445c8bd9c98092bc93e8494907c00e", "patch": "@@ -2,7 +2,7 @@\n // injected intrinsics by the compiler.\n #![deny(missing_docs)]\n #![allow(dead_code)]\n-#![feature(associated_type_defaults)]\n+#![feature(associated_type_defaults, extern_types)]\n \n //! Some garbage docs for the crate here\n #![doc=\"More garbage\"]\n@@ -183,4 +183,21 @@ pub mod public_interface {\n     pub use internal_impl::globbed::*;\n }\n \n+extern \"C\" {\n+    /// dox\n+    pub fn extern_fn_documented(f: f32) -> f32;\n+    pub fn extern_fn_undocumented(f: f32) -> f32;\n+    //~^ ERROR: missing documentation for a function\n+\n+    /// dox\n+    pub static EXTERN_STATIC_DOCUMENTED: u8;\n+    pub static EXTERN_STATIC_UNDOCUMENTED: u8;\n+    //~^ ERROR: missing documentation for a static\n+\n+    /// dox\n+    pub type ExternTyDocumented;\n+    pub type ExternTyUndocumented;\n+    //~^ ERROR: missing documentation for a foreign type\n+}\n+\n fn main() {}"}, {"sha": "56f8fc10e862320f3e55d899aa4cb7b912c98427", "filename": "src/test/ui/lint/lint-missing-doc.stderr", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/0863f9a965445c8bd9c98092bc93e8494907c00e/src%2Ftest%2Fui%2Flint%2Flint-missing-doc.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0863f9a965445c8bd9c98092bc93e8494907c00e/src%2Ftest%2Fui%2Flint%2Flint-missing-doc.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-missing-doc.stderr?ref=0863f9a965445c8bd9c98092bc93e8494907c00e", "patch": "@@ -118,5 +118,23 @@ error: missing documentation for a function\n LL |         pub fn also_undocumented1() {}\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: aborting due to 19 previous errors\n+error: missing documentation for a function\n+  --> $DIR/lint-missing-doc.rs:189:5\n+   |\n+LL |     pub fn extern_fn_undocumented(f: f32) -> f32;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+error: missing documentation for a static\n+  --> $DIR/lint-missing-doc.rs:194:5\n+   |\n+LL |     pub static EXTERN_STATIC_UNDOCUMENTED: u8;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+error: missing documentation for a foreign type\n+  --> $DIR/lint-missing-doc.rs:199:5\n+   |\n+LL |     pub type ExternTyUndocumented;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+error: aborting due to 22 previous errors\n "}]}