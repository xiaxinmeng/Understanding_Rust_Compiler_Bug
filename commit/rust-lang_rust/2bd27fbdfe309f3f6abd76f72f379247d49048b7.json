{"sha": "2bd27fbdfe309f3f6abd76f72f379247d49048b7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJiZDI3ZmJkZmUzMDlmM2Y2YWJkNzZmNzJmMzc5MjQ3ZDQ5MDQ4Yjc=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-08-26T20:14:31Z"}, "committer": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-08-26T20:14:31Z"}, "message": "parser: fix span for leading vert.", "tree": {"sha": "448aebcbf11a933e47906549f0f56952ee12d018", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/448aebcbf11a933e47906549f0f56952ee12d018"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2bd27fbdfe309f3f6abd76f72f379247d49048b7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2bd27fbdfe309f3f6abd76f72f379247d49048b7", "html_url": "https://github.com/rust-lang/rust/commit/2bd27fbdfe309f3f6abd76f72f379247d49048b7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2bd27fbdfe309f3f6abd76f72f379247d49048b7/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "acb11305e8d7298750797d45324c0ecb3cc6c256", "url": "https://api.github.com/repos/rust-lang/rust/commits/acb11305e8d7298750797d45324c0ecb3cc6c256", "html_url": "https://github.com/rust-lang/rust/commit/acb11305e8d7298750797d45324c0ecb3cc6c256"}], "stats": {"total": 11, "additions": 6, "deletions": 5}, "files": [{"sha": "78c9a289b37023dd7649e143e58145752a1d287f", "filename": "src/libsyntax/parse/parser/pat.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/2bd27fbdfe309f3f6abd76f72f379247d49048b7/src%2Flibsyntax%2Fparse%2Fparser%2Fpat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2bd27fbdfe309f3f6abd76f72f379247d49048b7/src%2Flibsyntax%2Fparse%2Fparser%2Fpat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Fparser%2Fpat.rs?ref=2bd27fbdfe309f3f6abd76f72f379247d49048b7", "patch": "@@ -50,6 +50,7 @@ impl<'a> Parser<'a> {\n     pub(super) fn parse_top_pat(&mut self, gate_or: GateOr) -> PResult<'a, P<Pat>> {\n         // Allow a '|' before the pats (RFCs 1925, 2530, and 2535).\n         let gated_leading_vert = self.eat_or_separator() && gate_or == GateOr::Yes;\n+        let leading_vert_span = self.prev_span;\n \n         // Parse the possibly-or-pattern.\n         let pat = self.parse_pat_with_or(None, gate_or, RecoverComma::Yes)?;\n@@ -61,7 +62,7 @@ impl<'a> Parser<'a> {\n         if gated_leading_vert {\n             let mut or_pattern_spans = self.sess.gated_spans.or_patterns.borrow_mut();\n             if or_pattern_spans.is_empty() {\n-                or_pattern_spans.push(self.prev_span);\n+                or_pattern_spans.push(leading_vert_span);\n             }\n         }\n "}, {"sha": "f520409e8bad62abefd08ec058fdc7b134f7d303", "filename": "src/test/ui/or-patterns/feature-gate-or_patterns-leading-for.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2bd27fbdfe309f3f6abd76f72f379247d49048b7/src%2Ftest%2Fui%2For-patterns%2Ffeature-gate-or_patterns-leading-for.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2bd27fbdfe309f3f6abd76f72f379247d49048b7/src%2Ftest%2Fui%2For-patterns%2Ffeature-gate-or_patterns-leading-for.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2For-patterns%2Ffeature-gate-or_patterns-leading-for.stderr?ref=2bd27fbdfe309f3f6abd76f72f379247d49048b7", "patch": "@@ -1,8 +1,8 @@\n error[E0658]: or-patterns syntax is experimental\n-  --> $DIR/feature-gate-or_patterns-leading-for.rs:7:11\n+  --> $DIR/feature-gate-or_patterns-leading-for.rs:7:9\n    |\n LL |     for | A in 0 {}\n-   |           ^\n+   |         ^\n    |\n    = note: for more information, see https://github.com/rust-lang/rust/issues/54883\n    = help: add `#![feature(or_patterns)]` to the crate attributes to enable"}, {"sha": "30fd6a1a95effbb910931b4d25d9be0d110e4e50", "filename": "src/test/ui/or-patterns/feature-gate-or_patterns-leading-let.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2bd27fbdfe309f3f6abd76f72f379247d49048b7/src%2Ftest%2Fui%2For-patterns%2Ffeature-gate-or_patterns-leading-let.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2bd27fbdfe309f3f6abd76f72f379247d49048b7/src%2Ftest%2Fui%2For-patterns%2Ffeature-gate-or_patterns-leading-let.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2For-patterns%2Ffeature-gate-or_patterns-leading-let.stderr?ref=2bd27fbdfe309f3f6abd76f72f379247d49048b7", "patch": "@@ -1,8 +1,8 @@\n error[E0658]: or-patterns syntax is experimental\n-  --> $DIR/feature-gate-or_patterns-leading-let.rs:7:11\n+  --> $DIR/feature-gate-or_patterns-leading-let.rs:7:9\n    |\n LL |     let | A;\n-   |           ^\n+   |         ^\n    |\n    = note: for more information, see https://github.com/rust-lang/rust/issues/54883\n    = help: add `#![feature(or_patterns)]` to the crate attributes to enable"}]}