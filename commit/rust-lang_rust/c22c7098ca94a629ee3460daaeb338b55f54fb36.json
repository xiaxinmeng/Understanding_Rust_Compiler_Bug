{"sha": "c22c7098ca94a629ee3460daaeb338b55f54fb36", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMyMmM3MDk4Y2E5NGE2MjllZTM0NjBkYWFlYjMzOGI1NWY1NGZiMzY=", "commit": {"author": {"name": "Collins Abitekaniza", "email": "abtcolns@gmail.com", "date": "2018-07-06T19:56:13Z"}, "committer": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2018-09-12T19:31:49Z"}, "message": "use stage 1 compiler only for stamps", "tree": {"sha": "8301e35e68467d2d1b6b442925fc1af6c1202b3a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8301e35e68467d2d1b6b442925fc1af6c1202b3a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c22c7098ca94a629ee3460daaeb338b55f54fb36", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c22c7098ca94a629ee3460daaeb338b55f54fb36", "html_url": "https://github.com/rust-lang/rust/commit/c22c7098ca94a629ee3460daaeb338b55f54fb36", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c22c7098ca94a629ee3460daaeb338b55f54fb36/comments", "author": {"login": "collin5", "id": 11579108, "node_id": "MDQ6VXNlcjExNTc5MTA4", "avatar_url": "https://avatars.githubusercontent.com/u/11579108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/collin5", "html_url": "https://github.com/collin5", "followers_url": "https://api.github.com/users/collin5/followers", "following_url": "https://api.github.com/users/collin5/following{/other_user}", "gists_url": "https://api.github.com/users/collin5/gists{/gist_id}", "starred_url": "https://api.github.com/users/collin5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/collin5/subscriptions", "organizations_url": "https://api.github.com/users/collin5/orgs", "repos_url": "https://api.github.com/users/collin5/repos", "events_url": "https://api.github.com/users/collin5/events{/privacy}", "received_events_url": "https://api.github.com/users/collin5/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c0af0b0213529437ed60a9df6faa91383eaf7faa", "url": "https://api.github.com/repos/rust-lang/rust/commits/c0af0b0213529437ed60a9df6faa91383eaf7faa", "html_url": "https://github.com/rust-lang/rust/commit/c0af0b0213529437ed60a9df6faa91383eaf7faa"}], "stats": {"total": 16, "additions": 8, "deletions": 8}, "files": [{"sha": "ab0d9a0664149f9ed71ebc803f0c26530fb69888", "filename": "src/bootstrap/builder.rs", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/c22c7098ca94a629ee3460daaeb338b55f54fb36/src%2Fbootstrap%2Fbuilder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c22c7098ca94a629ee3460daaeb338b55f54fb36/src%2Fbootstrap%2Fbuilder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbuilder.rs?ref=c22c7098ca94a629ee3460daaeb338b55f54fb36", "patch": "@@ -721,29 +721,29 @@ impl<'a> Builder<'a> {\n         // This is for the original compiler, but if we're forced to use stage 1, then\n         // std/test/rustc stamps won't exist in stage 2, so we need to get those from stage 1, since\n         // we copy the libs forward.\n-        let compiler = if self.force_use_stage1(compiler, target) {\n+        let cmp = if self.force_use_stage1(compiler, target) {\n             self.compiler(1, compiler.host)\n         } else {\n             compiler\n         };\n \n         let libstd_stamp = match cmd {\n-            \"check\" => check::libstd_stamp(self, compiler, target),\n-            _ => compile::libstd_stamp(self, compiler, target),\n+            \"check\" => check::libstd_stamp(self, cmp, target),\n+            _ => compile::libstd_stamp(self, cmp, target),\n         };\n \n         let libtest_stamp = match cmd {\n-            \"check\" => check::libtest_stamp(self, compiler, target),\n-            _ => compile::libstd_stamp(self, compiler, target),\n+            \"check\" => check::libtest_stamp(self, cmp, target),\n+            _ => compile::libstd_stamp(self, cmp, target),\n         };\n \n         let librustc_stamp = match cmd {\n-            \"check\" => check::librustc_stamp(self, compiler, target),\n-            _ => compile::librustc_stamp(self, compiler, target),\n+            \"check\" => check::librustc_stamp(self, cmp, target),\n+            _ => compile::librustc_stamp(self, cmp, target),\n         };\n \n         if cmd == \"doc\" {\n-            if mode == Mode::Rustc || mode == Mode::ToolRustc {\n+            if mode == Mode::Rustc || mode == Mode::ToolRustc || mode == Mode::Codegen {\n                 // This is the intended out directory for compiler documentation.\n                 my_out = self.compiler_doc_out(target);\n             }"}]}