{"sha": "071dbfc4781f43e6fdbb0a019d1cd46f6d249aee", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA3MWRiZmM0NzgxZjQzZTZmZGJiMGEwMTlkMWNkNDZmNmQyNDlhZWU=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2012-03-26T23:04:37Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2012-03-27T01:03:53Z"}, "message": "Reconfigure less often, and tidy up MKFILE_DEPS.", "tree": {"sha": "11acd69f14811269e9d38df08c64cffd138fee59", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/11acd69f14811269e9d38df08c64cffd138fee59"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/071dbfc4781f43e6fdbb0a019d1cd46f6d249aee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/071dbfc4781f43e6fdbb0a019d1cd46f6d249aee", "html_url": "https://github.com/rust-lang/rust/commit/071dbfc4781f43e6fdbb0a019d1cd46f6d249aee", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/071dbfc4781f43e6fdbb0a019d1cd46f6d249aee/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bd0399863fd2e012c46d0fed50e016f5dd147d82", "url": "https://api.github.com/repos/rust-lang/rust/commits/bd0399863fd2e012c46d0fed50e016f5dd147d82", "html_url": "https://github.com/rust-lang/rust/commit/bd0399863fd2e012c46d0fed50e016f5dd147d82"}], "stats": {"total": 26, "additions": 11, "deletions": 15}, "files": [{"sha": "858cb8727b529f96af9c8ba10f739b5097839f0d", "filename": "Makefile.in", "status": "modified", "additions": 11, "deletions": 15, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/071dbfc4781f43e6fdbb0a019d1cd46f6d249aee/Makefile.in", "raw_url": "https://github.com/rust-lang/rust/raw/071dbfc4781f43e6fdbb0a019d1cd46f6d249aee/Makefile.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Makefile.in?ref=071dbfc4781f43e6fdbb0a019d1cd46f6d249aee", "patch": "@@ -48,21 +48,14 @@ STAGES = 0 1 2 3\n # Residual auto-configuration\n ######################################################################\n \n-include config.mk\n+# Recursive wildcard function\n+# http://blog.jgc.org/2011/07/gnu-make-recursive-wildcard-function.html\n+rwildcard=$(foreach d,$(wildcard $1*),$(call rwildcard,$d/,$2) \\\n+  $(filter $(subst *,%,$2),$d))\n \n-ifdef IGNORE_MKFILES\n-  MKFILE_DEPS :=\n-else\n-  OUR_MKFILES := Makefile config.mk $(wildcard $(CFG_SRC_DIR)/mk/*.mk)\n-  3RDPARTY_MKFILES := $(CFG_SRC_DIR)/src/libuv/Makefile \\\n-                      $(wildcard $(CFG_SRC_DIR)/src/libuv/*.mk)\n-  GEN_MKFILES := $(wildcard $(CFG_SRC_DIR)/mk/libuv/*/*/*) \\\n-                 $(wildcard $(CFG_SRC_DIR)/mk/libuv/mac/src/libuv/*) \\\n-                 $(wildcard $(CFG_SRC_DIR)/mk/libuv/mac/src/libuv/*) \\\n-                 $(wildcard $(CFG_SRC_DIR)/mk/libuv/mac/src/libuv/*)\n-  MKFILE_DEPS := $(OUR_MKFILES) $(3RDPARTY_MKFILES) $(GEN_MKFILES)\n-endif\n+include config.mk\n \n+MKFILE_DEPS := config.stamp $(call rwildcard,$(CFG_SRC_DIR)mk/,*)\n NON_HOST_TRIPLES = $(filter-out $(CFG_HOST_TRIPLE),$(CFG_TARGET_TRIPLES))\n \n ifneq ($(MAKE_RESTARTS),)\n@@ -435,12 +428,15 @@ endif\n ifeq ($(NEED_GIT_RECONFIG),0)\n else\n # If the submodules have changed then always execute config.mk\n-.PHONY: config.mk\n+.PHONY: config.stamp\n endif\n \n-config.mk: $(S)configure $(S)Makefile.in $(S)src/snapshots.txt\n+Makefile config.mk: config.stamp\n+\n+config.stamp: $(S)configure $(S)Makefile.in $(S)src/snapshots.txt\n \t@$(call E, cfg: reconfiguring)\n \t$(Q)$(S)configure $(CFG_CONFIGURE_ARGS)\n+\t$(Q)touch $@\n \n \n ######################################################################"}]}