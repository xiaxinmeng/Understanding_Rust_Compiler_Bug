{"sha": "cd2310b93cb8feb84435157455743aec39b86d80", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNkMjMxMGI5M2NiOGZlYjg0NDM1MTU3NDU1NzQzYWVjMzliODZkODA=", "commit": {"author": {"name": "Corey Farwell", "email": "coreyf@rwell.org", "date": "2017-04-07T13:20:11Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-04-07T13:20:11Z"}, "message": "Rollup merge of #41131 - euclio:collapse-animation, r=GuillaumeGomez\n\nrustdoc: collapse docblock before showing label\n\nThe animation for collapsing descriptions is currently pretty jarring, as the label starts fading in as the description is collapsing. This causes the description to jump down a line (and sometimes change indentation) while animating.\n\nThis PR modifies this behavior to collapse the block entirely before starting to fade in the collapse button label.\n\nWhile this PR works well for descriptions of structs, traits, etc., it still does not look ideal for attributes. I'd appreciate any suggestions for improving that animation. Perhaps we want to optimize for the single-attribute case, and try not to collapse the attribute list entirely before fading in the label?", "tree": {"sha": "f9bc1247eb86883a435e858ba39fef565f182827", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f9bc1247eb86883a435e858ba39fef565f182827"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cd2310b93cb8feb84435157455743aec39b86d80", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cd2310b93cb8feb84435157455743aec39b86d80", "html_url": "https://github.com/rust-lang/rust/commit/cd2310b93cb8feb84435157455743aec39b86d80", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cd2310b93cb8feb84435157455743aec39b86d80/comments", "author": {"login": "frewsxcv", "id": 416575, "node_id": "MDQ6VXNlcjQxNjU3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/416575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frewsxcv", "html_url": "https://github.com/frewsxcv", "followers_url": "https://api.github.com/users/frewsxcv/followers", "following_url": "https://api.github.com/users/frewsxcv/following{/other_user}", "gists_url": "https://api.github.com/users/frewsxcv/gists{/gist_id}", "starred_url": "https://api.github.com/users/frewsxcv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frewsxcv/subscriptions", "organizations_url": "https://api.github.com/users/frewsxcv/orgs", "repos_url": "https://api.github.com/users/frewsxcv/repos", "events_url": "https://api.github.com/users/frewsxcv/events{/privacy}", "received_events_url": "https://api.github.com/users/frewsxcv/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "72308b1c23c3c0a00ab68d50f544e3761fbca024", "url": "https://api.github.com/repos/rust-lang/rust/commits/72308b1c23c3c0a00ab68d50f544e3761fbca024", "html_url": "https://github.com/rust-lang/rust/commit/72308b1c23c3c0a00ab68d50f544e3761fbca024"}, {"sha": "8a1d2a3a5a4ec0288c72a1b68864c8ac8a3074e4", "url": "https://api.github.com/repos/rust-lang/rust/commits/8a1d2a3a5a4ec0288c72a1b68864c8ac8a3074e4", "html_url": "https://github.com/rust-lang/rust/commit/8a1d2a3a5a4ec0288c72a1b68864c8ac8a3074e4"}], "stats": {"total": 15, "additions": 11, "deletions": 4}, "files": [{"sha": "cf9408abf5e8953f7d2d634b1b7f95f409b2ef81", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/cd2310b93cb8feb84435157455743aec39b86d80/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/cd2310b93cb8feb84435157455743aec39b86d80/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=cd2310b93cb8feb84435157455743aec39b86d80", "patch": "@@ -951,14 +951,21 @@\n         if (relatedDoc.is(\".docblock\")) {\n             if (relatedDoc.is(\":visible\")) {\n                 if (animate === true) {\n-                    relatedDoc.slideUp({duration: 'fast', easing: 'linear'});\n-                    toggle.children(\".toggle-label\").fadeIn();\n+                    relatedDoc.slideUp({\n+                        duration: 'fast',\n+                        easing: 'linear',\n+                        complete: function() {\n+                            toggle.children(\".toggle-label\").fadeIn();\n+                            toggle.parent(\".toggle-wrapper\").addClass(\"collapsed\");\n+                            toggle.children(\".inner\").text(labelForToggleButton(true));\n+                        },\n+                    });\n                 } else {\n                     relatedDoc.hide();\n                     toggle.children(\".toggle-label\").show();\n+                    toggle.parent(\".toggle-wrapper\").addClass(\"collapsed\");\n+                    toggle.children(\".inner\").text(labelForToggleButton(true));\n                 }\n-                toggle.parent(\".toggle-wrapper\").addClass(\"collapsed\");\n-                toggle.children(\".inner\").text(labelForToggleButton(true));\n             } else {\n                 relatedDoc.slideDown({duration: 'fast', easing: 'linear'});\n                 toggle.parent(\".toggle-wrapper\").removeClass(\"collapsed\");"}]}