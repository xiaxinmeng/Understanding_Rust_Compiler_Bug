{"sha": "598a79f3097ca9188362930467e59f839fab6569", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU5OGE3OWYzMDk3Y2E5MTg4MzYyOTMwNDY3ZTU5ZjgzOWZhYjY1Njk=", "commit": {"author": {"name": "Philipp Krones", "email": "hello@philkrones.com", "date": "2020-06-23T12:39:47Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-06-23T12:39:47Z"}, "message": "Rollup merge of #5713 - flip1995:more_lints, r=Manishearth\n\nUse lints in Clippy that are enabled in rustc bootstrap\n\ncc https://github.com/rust-lang/rust/pull/73297#discussion_r439747061\n\nchangelog: none", "tree": {"sha": "7764083c4d35cbb7bf53cc7c292eb9d9b9172151", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7764083c4d35cbb7bf53cc7c292eb9d9b9172151"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/598a79f3097ca9188362930467e59f839fab6569", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJe8fgTCRBK7hj4Ov3rIwAAdHIIAByCB9LZLl9/qxfudJCAu0L4\nWCzL5QO/8wOvOsy2inJFQ6qtMaDstf+6P6GzXbzagEKS3NE9LOOeCFO5ViVkYxaG\nXFV8Mys+QRzBunzzJ4SqB+PwP2MQ+1kXLEUppyWs/W0bn+JvyPMvcr4iPOOEjbtc\nnUQ741vDCw6qfBgfxQK0CmRIXf7ZuIxwFUO/wmTx0eos8QtT3qBM5qxiD5mC5RPN\n/8kQ+RjyUpSybmFrAd4DUj01C5/p4UpiJnjqDbwo+AOClRKNW8+DFv/LT20zUCDm\nhdP/EIpmfIXIPQCtqLGWlfvE1l7W/j/ilwyCTLT/mfpC/5N4Hx5VqYphz32ag1w=\n=m7lh\n-----END PGP SIGNATURE-----\n", "payload": "tree 7764083c4d35cbb7bf53cc7c292eb9d9b9172151\nparent 0799be7156888da9dfae0e3a7587acd87b08b9d0\nparent b886c06c1a52a57890b318cc7304f7384e696ec8\nauthor Philipp Krones <hello@philkrones.com> 1592915987 +0200\ncommitter GitHub <noreply@github.com> 1592915987 +0200\n\nRollup merge of #5713 - flip1995:more_lints, r=Manishearth\n\nUse lints in Clippy that are enabled in rustc bootstrap\n\ncc https://github.com/rust-lang/rust/pull/73297#discussion_r439747061\n\nchangelog: none\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/598a79f3097ca9188362930467e59f839fab6569", "html_url": "https://github.com/rust-lang/rust/commit/598a79f3097ca9188362930467e59f839fab6569", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/598a79f3097ca9188362930467e59f839fab6569/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0799be7156888da9dfae0e3a7587acd87b08b9d0", "url": "https://api.github.com/repos/rust-lang/rust/commits/0799be7156888da9dfae0e3a7587acd87b08b9d0", "html_url": "https://github.com/rust-lang/rust/commit/0799be7156888da9dfae0e3a7587acd87b08b9d0"}, {"sha": "b886c06c1a52a57890b318cc7304f7384e696ec8", "url": "https://api.github.com/repos/rust-lang/rust/commits/b886c06c1a52a57890b318cc7304f7384e696ec8", "html_url": "https://github.com/rust-lang/rust/commit/b886c06c1a52a57890b318cc7304f7384e696ec8"}], "stats": {"total": 45, "additions": 28, "deletions": 17}, "files": [{"sha": "19ad7d92c2b37037ec5e94c93503c77b4d9dea18", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 10, "deletions": 7, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/598a79f3097ca9188362930467e59f839fab6569/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/598a79f3097ca9188362930467e59f839fab6569/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=598a79f3097ca9188362930467e59f839fab6569", "patch": "@@ -1,19 +1,22 @@\n // error-pattern:cargo-clippy\n \n #![feature(bindings_after_at)]\n-#![feature(box_syntax)]\n #![feature(box_patterns)]\n+#![feature(box_syntax)]\n+#![feature(concat_idents)]\n+#![feature(crate_visibility_modifier)]\n+#![feature(drain_filter)]\n #![feature(or_patterns)]\n #![feature(rustc_private)]\n #![feature(stmt_expr_attributes)]\n-#![allow(clippy::missing_docs_in_private_items, clippy::must_use_candidate)]\n #![recursion_limit = \"512\"]\n-#![warn(rust_2018_idioms, trivial_casts, trivial_numeric_casts)]\n-#![deny(rustc::internal)]\n #![cfg_attr(feature = \"deny-warnings\", deny(warnings))]\n-#![feature(crate_visibility_modifier)]\n-#![feature(concat_idents)]\n-#![feature(drain_filter)]\n+#![allow(clippy::missing_docs_in_private_items, clippy::must_use_candidate)]\n+#![warn(trivial_casts, trivial_numeric_casts)]\n+// warn on lints, that are included in `rust-lang/rust`s bootstrap\n+#![warn(rust_2018_idioms, unused_lifetimes)]\n+// warn on rustc internal lints\n+#![deny(rustc::internal)]\n \n // FIXME: switch to something more ergonomic here, once available.\n // (Currently there is no way to opt into sysroot crates without `extern crate`.)"}, {"sha": "9020b47a146fab6e851be0f800b3a63d456832dd", "filename": "clippy_lints/src/loops.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/598a79f3097ca9188362930467e59f839fab6569/clippy_lints%2Fsrc%2Floops.rs", "raw_url": "https://github.com/rust-lang/rust/raw/598a79f3097ca9188362930467e59f839fab6569/clippy_lints%2Fsrc%2Floops.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Floops.rs?ref=598a79f3097ca9188362930467e59f839fab6569", "patch": "@@ -1497,7 +1497,7 @@ struct MutatePairDelegate<'a, 'tcx> {\n     span_high: Option<Span>,\n }\n \n-impl<'a, 'tcx> Delegate<'tcx> for MutatePairDelegate<'a, 'tcx> {\n+impl<'tcx> Delegate<'tcx> for MutatePairDelegate<'_, 'tcx> {\n     fn consume(&mut self, _: &PlaceWithHirId<'tcx>, _: ConsumeMode) {}\n \n     fn borrow(&mut self, cmt: &PlaceWithHirId<'tcx>, bk: ty::BorrowKind) {\n@@ -1525,7 +1525,7 @@ impl<'a, 'tcx> Delegate<'tcx> for MutatePairDelegate<'a, 'tcx> {\n     }\n }\n \n-impl<'a, 'tcx> MutatePairDelegate<'a, 'tcx> {\n+impl MutatePairDelegate<'_, '_> {\n     fn mutation_span(&self) -> (Option<Span>, Option<Span>) {\n         (self.span_low, self.span_high)\n     }\n@@ -2292,7 +2292,7 @@ struct HasBreakOrReturnVisitor {\n     has_break_or_return: bool,\n }\n \n-impl<'a, 'tcx> Visitor<'tcx> for HasBreakOrReturnVisitor {\n+impl<'tcx> Visitor<'tcx> for HasBreakOrReturnVisitor {\n     type Map = Map<'tcx>;\n \n     fn visit_expr(&mut self, expr: &'tcx Expr<'_>) {"}, {"sha": "cf71c3144a2ebebac537498f2748d45ca23d1211", "filename": "clippy_lints/src/suspicious_trait_impl.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/598a79f3097ca9188362930467e59f839fab6569/clippy_lints%2Fsrc%2Fsuspicious_trait_impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/598a79f3097ca9188362930467e59f839fab6569/clippy_lints%2Fsrc%2Fsuspicious_trait_impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fsuspicious_trait_impl.rs?ref=598a79f3097ca9188362930467e59f839fab6569", "patch": "@@ -184,7 +184,7 @@ struct BinaryExprVisitor {\n     in_binary_expr: bool,\n }\n \n-impl<'a, 'tcx> Visitor<'tcx> for BinaryExprVisitor {\n+impl<'tcx> Visitor<'tcx> for BinaryExprVisitor {\n     type Map = Map<'tcx>;\n \n     fn visit_expr(&mut self, expr: &'tcx hir::Expr<'_>) {"}, {"sha": "146ac4b09d5a4ff503bbf43ea09b52f3e4e5366a", "filename": "clippy_lints/src/trivially_copy_pass_by_ref.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/598a79f3097ca9188362930467e59f839fab6569/clippy_lints%2Fsrc%2Ftrivially_copy_pass_by_ref.rs", "raw_url": "https://github.com/rust-lang/rust/raw/598a79f3097ca9188362930467e59f839fab6569/clippy_lints%2Fsrc%2Ftrivially_copy_pass_by_ref.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Ftrivially_copy_pass_by_ref.rs?ref=598a79f3097ca9188362930467e59f839fab6569", "patch": "@@ -58,7 +58,7 @@ pub struct TriviallyCopyPassByRef {\n     limit: u64,\n }\n \n-impl<'a, 'tcx> TriviallyCopyPassByRef {\n+impl<'tcx> TriviallyCopyPassByRef {\n     pub fn new(limit: Option<u64>, target: &SessionConfig) -> Self {\n         let limit = limit.unwrap_or_else(|| {\n             let bit_width = u64::from(target.ptr_width);"}, {"sha": "e919b1522d89a04f12c0140b2e45dfc9a8901a6c", "filename": "clippy_lints/src/utils/sugg.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/598a79f3097ca9188362930467e59f839fab6569/clippy_lints%2Fsrc%2Futils%2Fsugg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/598a79f3097ca9188362930467e59f839fab6569/clippy_lints%2Fsrc%2Futils%2Fsugg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Fsugg.rs?ref=598a79f3097ca9188362930467e59f839fab6569", "patch": "@@ -509,7 +509,7 @@ fn indentation<T: LintContext>(cx: &T, span: Span) -> Option<String> {\n }\n \n /// Convenience extension trait for `DiagnosticBuilder`.\n-pub trait DiagnosticBuilderExt<'a, T: LintContext> {\n+pub trait DiagnosticBuilderExt<T: LintContext> {\n     /// Suggests to add an attribute to an item.\n     ///\n     /// Correctly handles indentation of the attribute and item.\n@@ -556,7 +556,7 @@ pub trait DiagnosticBuilderExt<'a, T: LintContext> {\n     fn suggest_remove_item(&mut self, cx: &T, item: Span, msg: &str, applicability: Applicability);\n }\n \n-impl<'a, 'b, 'c, T: LintContext> DiagnosticBuilderExt<'c, T> for rustc_errors::DiagnosticBuilder<'b> {\n+impl<T: LintContext> DiagnosticBuilderExt<T> for rustc_errors::DiagnosticBuilder<'_> {\n     fn suggest_item_with_attr<D: Display + ?Sized>(\n         &mut self,\n         cx: &T,"}, {"sha": "3fca66a5792ccf6a471c4011eac4cf355c053292", "filename": "src/driver.rs", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/598a79f3097ca9188362930467e59f839fab6569/src%2Fdriver.rs", "raw_url": "https://github.com/rust-lang/rust/raw/598a79f3097ca9188362930467e59f839fab6569/src%2Fdriver.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdriver.rs?ref=598a79f3097ca9188362930467e59f839fab6569", "patch": "@@ -1,9 +1,15 @@\n-#![cfg_attr(feature = \"deny-warnings\", deny(warnings))]\n #![feature(rustc_private)]\n+#![cfg_attr(feature = \"deny-warnings\", deny(warnings))]\n+// warn on lints, that are included in `rust-lang/rust`s bootstrap\n+#![warn(rust_2018_idioms, unused_lifetimes)]\n+// warn on rustc internal lints\n+#![deny(rustc::internal)]\n \n // FIXME: switch to something more ergonomic here, once available.\n // (Currently there is no way to opt into sysroot crates without `extern crate`.)\n #[allow(unused_extern_crates)]\n+extern crate rustc_data_structures;\n+#[allow(unused_extern_crates)]\n extern crate rustc_driver;\n #[allow(unused_extern_crates)]\n extern crate rustc_errors;\n@@ -93,7 +99,7 @@ impl rustc_driver::Callbacks for ClippyCallbacks {\n #[allow(clippy::find_map, clippy::filter_map)]\n fn describe_lints() {\n     use lintlist::{Level, Lint, ALL_LINTS, LINT_LEVELS};\n-    use std::collections::HashSet;\n+    use rustc_data_structures::fx::FxHashSet;\n \n     println!(\n         \"\n@@ -137,7 +143,7 @@ Available lint options:\n \n     let scoped = |x: &str| format!(\"clippy::{}\", x);\n \n-    let lint_groups: HashSet<_> = lints.iter().map(|lint| lint.group).collect();\n+    let lint_groups: FxHashSet<_> = lints.iter().map(|lint| lint.group).collect();\n \n     println!(\"Lint checks provided by clippy:\\n\");\n     println!(\"    {}  {:7.7}  meaning\", padded(\"name\"), \"default\");"}, {"sha": "6739a4cf2245e5e16a7aed73e135edf3d9ab9424", "filename": "src/main.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/598a79f3097ca9188362930467e59f839fab6569/src%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/598a79f3097ca9188362930467e59f839fab6569/src%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmain.rs?ref=598a79f3097ca9188362930467e59f839fab6569", "patch": "@@ -1,4 +1,6 @@\n #![cfg_attr(feature = \"deny-warnings\", deny(warnings))]\n+// warn on lints, that are included in `rust-lang/rust`s bootstrap\n+#![warn(rust_2018_idioms, unused_lifetimes)]\n \n use rustc_tools_util::VersionInfo;\n use std::env;"}]}