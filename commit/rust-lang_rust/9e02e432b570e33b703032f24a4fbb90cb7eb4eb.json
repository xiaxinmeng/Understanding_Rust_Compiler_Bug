{"sha": "9e02e432b570e33b703032f24a4fbb90cb7eb4eb", "node_id": "MDY6Q29tbWl0NzI0NzEyOjllMDJlNDMyYjU3MGUzM2I3MDMwMzJmMjRhNGZiYjkwY2I3ZWI0ZWI=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-07-31T09:59:52Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-07-31T09:59:52Z"}, "message": "expr stmt", "tree": {"sha": "630a240b674ead8f89f296007a5c424d44bfb974", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/630a240b674ead8f89f296007a5c424d44bfb974"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9e02e432b570e33b703032f24a4fbb90cb7eb4eb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9e02e432b570e33b703032f24a4fbb90cb7eb4eb", "html_url": "https://github.com/rust-lang/rust/commit/9e02e432b570e33b703032f24a4fbb90cb7eb4eb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9e02e432b570e33b703032f24a4fbb90cb7eb4eb/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "66182ed5d5e43962a46492ea41f19f9adeccc9e5", "url": "https://api.github.com/repos/rust-lang/rust/commits/66182ed5d5e43962a46492ea41f19f9adeccc9e5", "html_url": "https://github.com/rust-lang/rust/commit/66182ed5d5e43962a46492ea41f19f9adeccc9e5"}], "stats": {"total": 112, "additions": 111, "deletions": 1}, "files": [{"sha": "a8c9220403acd2dcb8aa08de95abd0ba7a90688f", "filename": "src/grammar.ron", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9e02e432b570e33b703032f24a4fbb90cb7eb4eb/src%2Fgrammar.ron", "raw_url": "https://github.com/rust-lang/rust/raw/9e02e432b570e33b703032f24a4fbb90cb7eb4eb/src%2Fgrammar.ron", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fgrammar.ron?ref=9e02e432b570e33b703032f24a4fbb90cb7eb4eb", "patch": "@@ -146,7 +146,9 @@ Grammar(\n         \"NAME_REF\",\n         \"VALUE_PARAMETER\",\n         \"BLOCK\",\n+\n         \"LET_STMT\",\n+        \"EXPR_STMT\",\n \n         \"TYPE_PARAM\",\n         \"LIFETIME_PARAM\","}, {"sha": "c88e395962a2a9594797e94553f224f1539495d7", "filename": "src/parser/grammar/items/mod.rs", "status": "modified", "additions": 17, "deletions": 1, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/9e02e432b570e33b703032f24a4fbb90cb7eb4eb/src%2Fparser%2Fgrammar%2Fitems%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9e02e432b570e33b703032f24a4fbb90cb7eb4eb/src%2Fparser%2Fgrammar%2Fitems%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fparser%2Fgrammar%2Fitems%2Fmod.rs?ref=9e02e432b570e33b703032f24a4fbb90cb7eb4eb", "patch": "@@ -223,6 +223,11 @@ fn fn_item(p: &mut Parser) {\n     fn_ret_type(p);\n     block(p);\n \n+    // test block\n+    // fn a() {}\n+    // fn b() { let _ = 1; }\n+    // fn c() { 1; 2; }\n+    // fn d() { 1; 2 }\n     fn block(p: &mut Parser) {\n         if !p.at(L_CURLY) {\n             p.error(\"expected block\");\n@@ -232,7 +237,18 @@ fn fn_item(p: &mut Parser) {\n         while !p.at(EOF) && !p.at(R_CURLY) {\n             match p.current() {\n                 LET_KW => let_stmt(p),\n-                _ => p.err_and_bump(\"expected statement\"),\n+                _ => {\n+                    let expr_stmt = p.start();\n+                    expressions::expr(p);\n+                    if p.eat(SEMI) {\n+                        expr_stmt.complete(p, EXPR_STMT);\n+                        if p.at(R_CURLY) {\n+                            break;\n+                        }\n+                    } else {\n+                        expr_stmt.abandon(p);\n+                    }\n+                }\n             }\n         }\n         p.expect(R_CURLY);"}, {"sha": "c49ad9a59ecb09522e9e170fbba4a864c28921ef", "filename": "src/syntax_kinds/generated.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9e02e432b570e33b703032f24a4fbb90cb7eb4eb/src%2Fsyntax_kinds%2Fgenerated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9e02e432b570e33b703032f24a4fbb90cb7eb4eb/src%2Fsyntax_kinds%2Fgenerated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fsyntax_kinds%2Fgenerated.rs?ref=9e02e432b570e33b703032f24a4fbb90cb7eb4eb", "patch": "@@ -137,6 +137,7 @@ pub enum SyntaxKind {\n     VALUE_PARAMETER,\n     BLOCK,\n     LET_STMT,\n+    EXPR_STMT,\n     TYPE_PARAM,\n     LIFETIME_PARAM,\n     TYPE_PARAM_LIST,\n@@ -287,6 +288,7 @@ impl SyntaxKind {\n             VALUE_PARAMETER => &SyntaxInfo { name: \"VALUE_PARAMETER\" },\n             BLOCK => &SyntaxInfo { name: \"BLOCK\" },\n             LET_STMT => &SyntaxInfo { name: \"LET_STMT\" },\n+            EXPR_STMT => &SyntaxInfo { name: \"EXPR_STMT\" },\n             TYPE_PARAM => &SyntaxInfo { name: \"TYPE_PARAM\" },\n             LIFETIME_PARAM => &SyntaxInfo { name: \"LIFETIME_PARAM\" },\n             TYPE_PARAM_LIST => &SyntaxInfo { name: \"TYPE_PARAM_LIST\" },"}, {"sha": "81f44c53307db33fc856d09ebeddc9525603af22", "filename": "tests/data/parser/inline/0045_block.rs", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9e02e432b570e33b703032f24a4fbb90cb7eb4eb/tests%2Fdata%2Fparser%2Finline%2F0045_block.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9e02e432b570e33b703032f24a4fbb90cb7eb4eb/tests%2Fdata%2Fparser%2Finline%2F0045_block.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Finline%2F0045_block.rs?ref=9e02e432b570e33b703032f24a4fbb90cb7eb4eb", "patch": "@@ -0,0 +1,4 @@\n+fn a() {}\n+fn b() { let _ = 1; }\n+fn c() { 1; 2; }\n+fn d() { 1; 2 }"}, {"sha": "5a83999c9341cd605072914bb667288fe8e7fb1d", "filename": "tests/data/parser/inline/0045_block.txt", "status": "added", "additions": 86, "deletions": 0, "changes": 86, "blob_url": "https://github.com/rust-lang/rust/blob/9e02e432b570e33b703032f24a4fbb90cb7eb4eb/tests%2Fdata%2Fparser%2Finline%2F0045_block.txt", "raw_url": "https://github.com/rust-lang/rust/raw/9e02e432b570e33b703032f24a4fbb90cb7eb4eb/tests%2Fdata%2Fparser%2Finline%2F0045_block.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Finline%2F0045_block.txt?ref=9e02e432b570e33b703032f24a4fbb90cb7eb4eb", "patch": "@@ -0,0 +1,86 @@\n+FILE@[0; 65)\n+  FN_ITEM@[0; 10)\n+    FN_KW@[0; 2)\n+    NAME@[2; 4)\n+      WHITESPACE@[2; 3)\n+      IDENT@[3; 4) \"a\"\n+    PARAM_LIST@[4; 7)\n+      L_PAREN@[4; 5)\n+      R_PAREN@[5; 6)\n+      WHITESPACE@[6; 7)\n+    BLOCK@[7; 10)\n+      L_CURLY@[7; 8)\n+      R_CURLY@[8; 9)\n+      WHITESPACE@[9; 10)\n+  FN_ITEM@[10; 32)\n+    FN_KW@[10; 12)\n+    NAME@[12; 14)\n+      WHITESPACE@[12; 13)\n+      IDENT@[13; 14) \"b\"\n+    PARAM_LIST@[14; 17)\n+      L_PAREN@[14; 15)\n+      R_PAREN@[15; 16)\n+      WHITESPACE@[16; 17)\n+    BLOCK@[17; 32)\n+      L_CURLY@[17; 18)\n+      LET_STMT@[18; 30)\n+        WHITESPACE@[18; 19)\n+        LET_KW@[19; 22)\n+        PLACEHOLDER_PAT@[22; 25)\n+          WHITESPACE@[22; 23)\n+          UNDERSCORE@[23; 24)\n+          WHITESPACE@[24; 25)\n+        EQ@[25; 26)\n+        LITERAL@[26; 28)\n+          WHITESPACE@[26; 27)\n+          INT_NUMBER@[27; 28)\n+        SEMI@[28; 29)\n+        WHITESPACE@[29; 30)\n+      R_CURLY@[30; 31)\n+      WHITESPACE@[31; 32)\n+  FN_ITEM@[32; 49)\n+    FN_KW@[32; 34)\n+    NAME@[34; 36)\n+      WHITESPACE@[34; 35)\n+      IDENT@[35; 36) \"c\"\n+    PARAM_LIST@[36; 39)\n+      L_PAREN@[36; 37)\n+      R_PAREN@[37; 38)\n+      WHITESPACE@[38; 39)\n+    BLOCK@[39; 49)\n+      L_CURLY@[39; 40)\n+      EXPR_STMT@[40; 44)\n+        LITERAL@[40; 42)\n+          WHITESPACE@[40; 41)\n+          INT_NUMBER@[41; 42)\n+        SEMI@[42; 43)\n+        WHITESPACE@[43; 44)\n+      EXPR_STMT@[44; 47)\n+        LITERAL@[44; 45)\n+          INT_NUMBER@[44; 45)\n+        SEMI@[45; 46)\n+        WHITESPACE@[46; 47)\n+      R_CURLY@[47; 48)\n+      WHITESPACE@[48; 49)\n+  FN_ITEM@[49; 65)\n+    FN_KW@[49; 51)\n+    NAME@[51; 53)\n+      WHITESPACE@[51; 52)\n+      IDENT@[52; 53) \"d\"\n+    PARAM_LIST@[53; 56)\n+      L_PAREN@[53; 54)\n+      R_PAREN@[54; 55)\n+      WHITESPACE@[55; 56)\n+    BLOCK@[56; 65)\n+      L_CURLY@[56; 57)\n+      EXPR_STMT@[57; 61)\n+        LITERAL@[57; 59)\n+          WHITESPACE@[57; 58)\n+          INT_NUMBER@[58; 59)\n+        SEMI@[59; 60)\n+        WHITESPACE@[60; 61)\n+      LITERAL@[61; 63)\n+        INT_NUMBER@[61; 62)\n+        WHITESPACE@[62; 63)\n+      R_CURLY@[63; 64)\n+      WHITESPACE@[64; 65)"}]}