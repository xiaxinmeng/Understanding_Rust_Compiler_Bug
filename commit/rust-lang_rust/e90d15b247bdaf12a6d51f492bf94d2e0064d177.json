{"sha": "e90d15b247bdaf12a6d51f492bf94d2e0064d177", "node_id": "C_kwDOAAsO6NoAKGU5MGQxNWIyNDdiZGFmMTJhNmQ1MWY0OTJiZjk0ZDJlMDA2NGQxNzc", "commit": {"author": {"name": "Lukas", "email": "lukas-code@outlook.com", "date": "2022-11-16T14:08:35Z"}, "committer": {"name": "Lukas Markeffsky", "email": "@", "date": "2022-11-19T15:58:02Z"}, "message": "Update comment on pointer-to-usize transmute\n\nCo-authored-by: Ralf Jung <post@ralfj.de>", "tree": {"sha": "2ae776394d808b32a96d74c690ede138d969c188", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2ae776394d808b32a96d74c690ede138d969c188"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e90d15b247bdaf12a6d51f492bf94d2e0064d177", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e90d15b247bdaf12a6d51f492bf94d2e0064d177", "html_url": "https://github.com/rust-lang/rust/commit/e90d15b247bdaf12a6d51f492bf94d2e0064d177", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e90d15b247bdaf12a6d51f492bf94d2e0064d177/comments", "author": {"login": "lukas-code", "id": 26522220, "node_id": "MDQ6VXNlcjI2NTIyMjIw", "avatar_url": "https://avatars.githubusercontent.com/u/26522220?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lukas-code", "html_url": "https://github.com/lukas-code", "followers_url": "https://api.github.com/users/lukas-code/followers", "following_url": "https://api.github.com/users/lukas-code/following{/other_user}", "gists_url": "https://api.github.com/users/lukas-code/gists{/gist_id}", "starred_url": "https://api.github.com/users/lukas-code/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lukas-code/subscriptions", "organizations_url": "https://api.github.com/users/lukas-code/orgs", "repos_url": "https://api.github.com/users/lukas-code/repos", "events_url": "https://api.github.com/users/lukas-code/events{/privacy}", "received_events_url": "https://api.github.com/users/lukas-code/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3d7e9c4b7fdce062b2b337f708980ecb3e9f4c9a", "url": "https://api.github.com/repos/rust-lang/rust/commits/3d7e9c4b7fdce062b2b337f708980ecb3e9f4c9a", "html_url": "https://github.com/rust-lang/rust/commit/3d7e9c4b7fdce062b2b337f708980ecb3e9f4c9a"}], "stats": {"total": 7, "additions": 4, "deletions": 3}, "files": [{"sha": "73923753a3020062ad6811df4849eb013a5dd970", "filename": "library/core/src/ptr/mod.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/e90d15b247bdaf12a6d51f492bf94d2e0064d177/library%2Fcore%2Fsrc%2Fptr%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e90d15b247bdaf12a6d51f492bf94d2e0064d177/library%2Fcore%2Fsrc%2Fptr%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fptr%2Fmod.rs?ref=e90d15b247bdaf12a6d51f492bf94d2e0064d177", "patch": "@@ -1652,9 +1652,10 @@ pub(crate) const unsafe fn align_offset<T: Sized>(p: *const T, a: usize) -> usiz\n \n     let stride = mem::size_of::<T>();\n \n-    // SAFETY: At runtime, transmuting a pointer to `usize` is always safe, because they have the\n-    // same layout. During const eval, we hook this function to ensure that the pointer always has\n-    // an address (only the standard library can do this).\n+    // SAFETY: This is just an inlined `p.addr()` (which is not\n+    // a `const fn` so we cannot call it).\n+    // During const eval, we hook this function to ensure that the pointer never\n+    // has provenance, making this sound.\n     let addr: usize = unsafe { mem::transmute(p) };\n \n     // SAFETY: `a` is a power-of-two, therefore non-zero."}]}