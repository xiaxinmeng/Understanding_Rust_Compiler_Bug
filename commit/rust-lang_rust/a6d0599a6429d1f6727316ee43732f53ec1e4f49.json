{"sha": "a6d0599a6429d1f6727316ee43732f53ec1e4f49", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE2ZDA1OTlhNjQyOWQxZjY3MjczMTZlZTQzNzMyZjUzZWMxZTRmNDk=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-09-29T05:21:12Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-09-29T05:21:12Z"}, "message": "Rollup merge of #54567 - tromey:paths-in-stamp-hashes, r=Mark-Simulacrum\n\nInclude path in stamp hash for debuginfo tests\n\nThe debuginfo tests are exposed to the environment in a couple of\nways: the path to the gdb executable matters, as does the Python path\nused when loading lldb.\n\nThis patch incorporates these paths into the hash that is written to\nthe stamp file, so that changing the path will cause the tests to be\nre-run.", "tree": {"sha": "aeeabe5d96195f528b17d7ef5f1c9a84bac36700", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/aeeabe5d96195f528b17d7ef5f1c9a84bac36700"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a6d0599a6429d1f6727316ee43732f53ec1e4f49", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbrwvICRBK7hj4Ov3rIwAAdHIIAGYH3vHO81MJTji5qUvBYQMW\nsjsJN4OoGPJMoJlaHlfxjAzVA+QQKZt2C/fWboDFe3dIh4ILO7c5Lzfii4DV7HKh\n1kQbp3Yi3oTlSNAYKJgJ8NCVOTCCDYd2fDXGLLlaJ2HpLpRBhgpIULS1h/dYweXg\nzM3YLmvI9I0Gh5X1mOBGfYzhLEiKHiDy1886nv/+c8tlRUOZ1iUYMmJPCpMzg3co\n0q492ccWZNNhVBbaRVYoSYxAiltKgxPKWE8X4uXVCEY8czrZx2hCTid6BBefPbLe\nnnkq6UktXaEA+jtX6ywVH0kwfMDrb+gVTXORSeggWy9b03AohOb9nI9Thdf/bDo=\n=rwXa\n-----END PGP SIGNATURE-----\n", "payload": "tree aeeabe5d96195f528b17d7ef5f1c9a84bac36700\nparent 3b62e77cbd972a95e2716baa741bc8c81b9fef6e\nparent e6ea19d7bd17cf7252d6af90781665d5e87ea156\nauthor kennytm <kennytm@gmail.com> 1538198472 +0800\ncommitter GitHub <noreply@github.com> 1538198472 +0800\n\nRollup merge of #54567 - tromey:paths-in-stamp-hashes, r=Mark-Simulacrum\n\nInclude path in stamp hash for debuginfo tests\n\nThe debuginfo tests are exposed to the environment in a couple of\nways: the path to the gdb executable matters, as does the Python path\nused when loading lldb.\n\nThis patch incorporates these paths into the hash that is written to\nthe stamp file, so that changing the path will cause the tests to be\nre-run.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a6d0599a6429d1f6727316ee43732f53ec1e4f49", "html_url": "https://github.com/rust-lang/rust/commit/a6d0599a6429d1f6727316ee43732f53ec1e4f49", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a6d0599a6429d1f6727316ee43732f53ec1e4f49/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3b62e77cbd972a95e2716baa741bc8c81b9fef6e", "url": "https://api.github.com/repos/rust-lang/rust/commits/3b62e77cbd972a95e2716baa741bc8c81b9fef6e", "html_url": "https://github.com/rust-lang/rust/commit/3b62e77cbd972a95e2716baa741bc8c81b9fef6e"}, {"sha": "e6ea19d7bd17cf7252d6af90781665d5e87ea156", "url": "https://api.github.com/repos/rust-lang/rust/commits/e6ea19d7bd17cf7252d6af90781665d5e87ea156", "html_url": "https://github.com/rust-lang/rust/commit/e6ea19d7bd17cf7252d6af90781665d5e87ea156"}], "stats": {"total": 13, "additions": 13, "deletions": 0}, "files": [{"sha": "16647f1bb2ef9082a8d8120b5c338d20b6907165", "filename": "src/tools/compiletest/src/runtest.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/a6d0599a6429d1f6727316ee43732f53ec1e4f49/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a6d0599a6429d1f6727316ee43732f53ec1e4f49/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs?ref=a6d0599a6429d1f6727316ee43732f53ec1e4f49", "patch": "@@ -224,6 +224,19 @@ pub fn run(config: Config, testpaths: &TestPaths, revision: Option<&str>) {\n pub fn compute_stamp_hash(config: &Config) -> String {\n     let mut hash = DefaultHasher::new();\n     config.stage_id.hash(&mut hash);\n+    match config.mode {\n+        DebugInfoGdb => match config.gdb {\n+            None => env::var_os(\"PATH\").hash(&mut hash),\n+            Some(ref s) if s.is_empty() => env::var_os(\"PATH\").hash(&mut hash),\n+            Some(ref s) => s.hash(&mut hash),\n+        },\n+        DebugInfoLldb => {\n+            env::var_os(\"PATH\").hash(&mut hash);\n+            env::var_os(\"PYTHONPATH\").hash(&mut hash);\n+        },\n+\n+        _ => {},\n+    };\n     format!(\"{:x}\", hash.finish())\n }\n "}]}