{"sha": "046936aeaf5a092858953eadf5a779635797e85d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA0NjkzNmFlYWY1YTA5Mjg1ODk1M2VhZGY1YTc3OTYzNTc5N2U4NWQ=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-08-06T06:17:39Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-08-06T06:17:39Z"}, "message": "Rollup merge of #63260 - RalfJung:ptr-test, r=matklad\n\nfix UB in a test\n\nWe used to compare two mutable references that were supposed to point to the same thing. That's no good.\n\nCompare them as raw pointers instead.", "tree": {"sha": "be5d97d311519dcc9436f93d9810dc7dafbf7c48", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/be5d97d311519dcc9436f93d9810dc7dafbf7c48"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/046936aeaf5a092858953eadf5a779635797e85d", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdSRuDCRBK7hj4Ov3rIwAAdHIIAI64TZdsRDb7OpXbIudWD2Jd\n7oqbVjFc5Uxd6e68yrlGTm4qCkohs+bw01/3e4GsAy1IJbZ+0hGTAVaSeDC5qJC5\n6l/d1Y7b8IrkMw7IEjt1U22x8SllXRhY3qGPkKx2FlyHDLkgWzndi+NU856mYrF+\nxTCbTC+8H1nR2FZCh4NJ6WDiWLkJh4Qku0u2WA2rImPIN3J5nZxtcYxotVgTOo8v\nf3uEugMPefOMAOFr992psE3eneJTTJKMj62OSPIhJa/Ty20KqBZ+bojgihbCHpS4\neWGn9bO8WgSmTyMY7t8MLZebUmHpRu3gKUqjUlQXkvEKGWWVnfr0IEYDwY+pGx0=\n=zRbs\n-----END PGP SIGNATURE-----\n", "payload": "tree be5d97d311519dcc9436f93d9810dc7dafbf7c48\nparent ab7155dd977e88bc275832d6733d1c5653338d7c\nparent 90b95cf53f68888812cd5683cf44161e070e7dbd\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1565072259 +0200\ncommitter GitHub <noreply@github.com> 1565072259 +0200\n\nRollup merge of #63260 - RalfJung:ptr-test, r=matklad\n\nfix UB in a test\n\nWe used to compare two mutable references that were supposed to point to the same thing. That's no good.\n\nCompare them as raw pointers instead.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/046936aeaf5a092858953eadf5a779635797e85d", "html_url": "https://github.com/rust-lang/rust/commit/046936aeaf5a092858953eadf5a779635797e85d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/046936aeaf5a092858953eadf5a779635797e85d/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ab7155dd977e88bc275832d6733d1c5653338d7c", "url": "https://api.github.com/repos/rust-lang/rust/commits/ab7155dd977e88bc275832d6733d1c5653338d7c", "html_url": "https://github.com/rust-lang/rust/commit/ab7155dd977e88bc275832d6733d1c5653338d7c"}, {"sha": "90b95cf53f68888812cd5683cf44161e070e7dbd", "url": "https://api.github.com/repos/rust-lang/rust/commits/90b95cf53f68888812cd5683cf44161e070e7dbd", "html_url": "https://github.com/rust-lang/rust/commit/90b95cf53f68888812cd5683cf44161e070e7dbd"}], "stats": {"total": 3, "additions": 1, "deletions": 2}, "files": [{"sha": "1a6be3a9bbd034558618281c4a325e762d1f6ac6", "filename": "src/libcore/tests/ptr.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/046936aeaf5a092858953eadf5a779635797e85d/src%2Flibcore%2Ftests%2Fptr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/046936aeaf5a092858953eadf5a779635797e85d/src%2Flibcore%2Ftests%2Fptr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Ftests%2Fptr.rs?ref=046936aeaf5a092858953eadf5a779635797e85d", "patch": "@@ -145,7 +145,6 @@ fn test_as_ref() {\n }\n \n #[test]\n-#[cfg(not(miri))] // This test is UB according to Stacked Borrows\n fn test_as_mut() {\n     unsafe {\n         let p: *mut isize = null_mut();\n@@ -164,7 +163,7 @@ fn test_as_mut() {\n         // Pointers to unsized types -- slices\n         let s: &mut [u8] = &mut [1, 2, 3];\n         let ms: *mut [u8] = s;\n-        assert_eq!(ms.as_mut(), Some(s));\n+        assert_eq!(ms.as_mut(), Some(&mut [1, 2, 3][..]));\n \n         let mz: *mut [u8] = &mut [];\n         assert_eq!(mz.as_mut(), Some(&mut [][..]));"}]}