{"sha": "3e01b0a8fd9325928a1df10ee1c5210dacc5a859", "node_id": "C_kwDOAAsO6NoAKDNlMDFiMGE4ZmQ5MzI1OTI4YTFkZjEwZWUxYzUyMTBkYWNjNWE4NTk", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-02-01T11:29:22Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-02-01T11:29:22Z"}, "message": "Fix lifetime elision in type aliases", "tree": {"sha": "1bf7a36632c2080c7580fb905de8d942b3f206e8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1bf7a36632c2080c7580fb905de8d942b3f206e8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3e01b0a8fd9325928a1df10ee1c5210dacc5a859", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3e01b0a8fd9325928a1df10ee1c5210dacc5a859", "html_url": "https://github.com/rust-lang/rust/commit/3e01b0a8fd9325928a1df10ee1c5210dacc5a859", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3e01b0a8fd9325928a1df10ee1c5210dacc5a859/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a00e130dae74a213338e2b095ec855156d8f3d8a", "url": "https://api.github.com/repos/rust-lang/rust/commits/a00e130dae74a213338e2b095ec855156d8f3d8a", "html_url": "https://github.com/rust-lang/rust/commit/a00e130dae74a213338e2b095ec855156d8f3d8a"}], "stats": {"total": 16, "additions": 13, "deletions": 3}, "files": [{"sha": "6a654eebaa2c00e1d6b6ccc7d1eed42d838d66aa", "filename": "src/librustdoc/clean/mod.rs", "status": "modified", "additions": 13, "deletions": 3, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/3e01b0a8fd9325928a1df10ee1c5210dacc5a859/src%2Flibrustdoc%2Fclean%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3e01b0a8fd9325928a1df10ee1c5210dacc5a859/src%2Flibrustdoc%2Fclean%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Fmod.rs?ref=3e01b0a8fd9325928a1df10ee1c5210dacc5a859", "patch": "@@ -1426,15 +1426,25 @@ fn normalize<'tcx>(cx: &mut DocContext<'tcx>, ty: Ty<'_>) -> Option<Ty<'tcx>> {\n         return None;\n     }\n \n+    use crate::rustc_trait_selection::infer::TyCtxtInferExt;\n+    use crate::rustc_trait_selection::traits::query::normalize::AtExt;\n+    use rustc_middle::traits::ObligationCause;\n+\n     // Try to normalize `<X as Y>::T` to a type\n     let lifted = ty.lift_to_tcx(cx.tcx).unwrap();\n-    match cx.tcx.try_normalize_erasing_regions(cx.param_env, lifted) {\n+    let normalized = cx.tcx.infer_ctxt().enter(|infcx| {\n+        infcx\n+            .at(&ObligationCause::dummy(), cx.param_env)\n+            .normalize(lifted)\n+            .map(|resolved| infcx.resolve_vars_if_possible(resolved.value))\n+    });\n+    match normalized {\n         Ok(normalized_value) => {\n-            trace!(\"normalized {:?} to {:?}\", ty, normalized_value);\n+            debug!(\"normalized {:?} to {:?}\", ty, normalized_value);\n             Some(normalized_value)\n         }\n         Err(err) => {\n-            info!(\"failed to normalize {:?}: {:?}\", ty, err);\n+            debug!(\"failed to normalize {:?}: {:?}\", ty, err);\n             None\n         }\n     }"}]}