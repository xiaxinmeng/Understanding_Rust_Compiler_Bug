{"sha": "d1a67574c6c683969e303d4d07428ca1d4c308bc", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQxYTY3NTc0YzZjNjgzOTY5ZTMwM2Q0ZDA3NDI4Y2ExZDRjMzA4YmM=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2010-08-04T01:59:26Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2010-08-04T01:59:26Z"}, "message": "Factor append_quad out of IL.emit_full, for use elsewhere.", "tree": {"sha": "a9f07b308882851d79a879505f23f7a2d58b5a4c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a9f07b308882851d79a879505f23f7a2d58b5a4c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d1a67574c6c683969e303d4d07428ca1d4c308bc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d1a67574c6c683969e303d4d07428ca1d4c308bc", "html_url": "https://github.com/rust-lang/rust/commit/d1a67574c6c683969e303d4d07428ca1d4c308bc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d1a67574c6c683969e303d4d07428ca1d4c308bc/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c014748c0191b711e2adf5a5db224474ea4e75d3", "url": "https://api.github.com/repos/rust-lang/rust/commits/c014748c0191b711e2adf5a5db224474ea4e75d3", "html_url": "https://github.com/rust-lang/rust/commit/c014748c0191b711e2adf5a5db224474ea4e75d3"}], "stats": {"total": 16, "additions": 12, "deletions": 4}, "files": [{"sha": "9661719d268515148b1a07f0a17464219ef38f45", "filename": "src/boot/be/il.ml", "status": "modified", "additions": 12, "deletions": 4, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/d1a67574c6c683969e303d4d07428ca1d4c308bc/src%2Fboot%2Fbe%2Fil.ml", "raw_url": "https://github.com/rust-lang/rust/raw/d1a67574c6c683969e303d4d07428ca1d4c308bc/src%2Fboot%2Fbe%2Fil.ml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fboot%2Fbe%2Fil.ml?ref=d1a67574c6c683969e303d4d07428ca1d4c308bc", "patch": "@@ -828,18 +828,26 @@ let mk_quad (q':quad') : quad =\n     quad_fixup = None }\n ;;\n \n+let append_quad\n+    (e:emitter)\n+    (q:quad)\n+    : unit =\n+  grow_if_necessary e;\n+  e.emit_quads.(e.emit_pc) <- q;\n+  e.emit_pc <- e.emit_pc + 1\n+;;\n+\n+\n let emit_full\n     (e:emitter)\n     (fix:fixup option)\n     (q':quad')\n     : unit =\n   let fixup = ref fix in\n   let emit_quad_bottom q' =\n-    grow_if_necessary e;\n-    e.emit_quads.(e.emit_pc) <- { quad_body = q';\n-                                  quad_fixup = (!fixup) };\n+    append_quad e { quad_body = q';\n+                    quad_fixup = (!fixup) };\n     fixup := None;\n-    e.emit_pc <- e.emit_pc + 1\n   in\n \n   let emit_quad (q':quad') : unit ="}]}