{"sha": "3e9a2233d01c1ece9c31833a70b23f3c77de067f", "node_id": "C_kwDOAAsO6NoAKDNlOWEyMjMzZDAxYzFlY2U5YzMxODMzYTcwYjIzZjNjNzdkZTA2N2Y", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-11-29T21:43:17Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-11-29T21:43:17Z"}, "message": "Rollup merge of #104523 - flba-eb:fix_nto_target_name, r=wesleywiser\n\nDon't use periods in target names\n\nUsing a period in the target name can cause issues in e.g. cargo, see also https://rust-lang.zulipchat.com/#narrow/stream/182449-t-compiler.2Fhelp/topic/Running.20tests.20on.20remote.20target", "tree": {"sha": "78f78e8c9be376288273345f4508da8a89e37c45", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/78f78e8c9be376288273345f4508da8a89e37c45"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3e9a2233d01c1ece9c31833a70b23f3c77de067f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjhnz1CRBK7hj4Ov3rIwAA5I8IAIHd9TIP9nNbMG9zyEtNGfP0\nA68ES0g8Pdlf6lnU9hOQiDncELQ6Kmc4rNd3ZMWMz7XJM8dRmM2XOFwBXrxnFZxJ\nINjsdA+JS1YUb6MTetfgC3z5ThNTbHr0fqR6rx590Zb9ka27DQnYiMEHIIr45hgz\nbI+r7iQFvHNhaUHQTmBUqHJOBtiHkHqOaQYoT/rbU4AU//7Psg/oywwTbI9pOPV0\nInEfkgjBv99evwkfApA8o/ILWpb15eryI0TKLYVwSKNHxCAYahsni0CU1CNLECke\nrTSnSVNuyUIyDPm6B3+DYG13sXfeQaHa5lqX15d30RRvC3iL2exrQDHE/FT4pTM=\n=5VXN\n-----END PGP SIGNATURE-----\n", "payload": "tree 78f78e8c9be376288273345f4508da8a89e37c45\nparent e4d1fe7b15117a1624f3d9b051c477cb117176b3\nparent 9c3555d5c2dc3d1e5025c35db3873c2776054185\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1669758197 +0100\ncommitter GitHub <noreply@github.com> 1669758197 +0100\n\nRollup merge of #104523 - flba-eb:fix_nto_target_name, r=wesleywiser\n\nDon't use periods in target names\n\nUsing a period in the target name can cause issues in e.g. cargo, see also https://rust-lang.zulipchat.com/#narrow/stream/182449-t-compiler.2Fhelp/topic/Running.20tests.20on.20remote.20target\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3e9a2233d01c1ece9c31833a70b23f3c77de067f", "html_url": "https://github.com/rust-lang/rust/commit/3e9a2233d01c1ece9c31833a70b23f3c77de067f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3e9a2233d01c1ece9c31833a70b23f3c77de067f/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e4d1fe7b15117a1624f3d9b051c477cb117176b3", "url": "https://api.github.com/repos/rust-lang/rust/commits/e4d1fe7b15117a1624f3d9b051c477cb117176b3", "html_url": "https://github.com/rust-lang/rust/commit/e4d1fe7b15117a1624f3d9b051c477cb117176b3"}, {"sha": "9c3555d5c2dc3d1e5025c35db3873c2776054185", "url": "https://api.github.com/repos/rust-lang/rust/commits/9c3555d5c2dc3d1e5025c35db3873c2776054185", "html_url": "https://github.com/rust-lang/rust/commit/9c3555d5c2dc3d1e5025c35db3873c2776054185"}], "stats": {"total": 46, "additions": 32, "deletions": 14}, "files": [{"sha": "0f8cfd7f5385cb9eee9f824a4546336e890995f8", "filename": "compiler/rustc_target/src/spec/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3e9a2233d01c1ece9c31833a70b23f3c77de067f/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3e9a2233d01c1ece9c31833a70b23f3c77de067f/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs?ref=3e9a2233d01c1ece9c31833a70b23f3c77de067f", "patch": "@@ -1250,8 +1250,8 @@ supported_targets! {\n \n     (\"mips64-openwrt-linux-musl\", mips64_openwrt_linux_musl),\n \n-    (\"aarch64-unknown-nto-qnx7.1.0\", aarch64_unknown_nto_qnx_710),\n-    (\"x86_64-pc-nto-qnx7.1.0\", x86_64_pc_nto_qnx710),\n+    (\"aarch64-unknown-nto-qnx710\", aarch64_unknown_nto_qnx_710),\n+    (\"x86_64-pc-nto-qnx710\", x86_64_pc_nto_qnx710),\n }\n \n /// Cow-Vec-Str: Cow<'static, [Cow<'static, str>]>"}, {"sha": "d0c3ddf2606245fb5acdc000e1e7de126dc881f8", "filename": "src/doc/rustc/src/platform-support.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3e9a2233d01c1ece9c31833a70b23f3c77de067f/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md", "raw_url": "https://github.com/rust-lang/rust/raw/3e9a2233d01c1ece9c31833a70b23f3c77de067f/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md?ref=3e9a2233d01c1ece9c31833a70b23f3c77de067f", "patch": "@@ -214,7 +214,7 @@ target | std | host | notes\n [`aarch64-kmc-solid_asp3`](platform-support/kmc-solid.md) | \u2713 |  | ARM64 SOLID with TOPPERS/ASP3\n [`aarch64-nintendo-switch-freestanding`](platform-support/aarch64-nintendo-switch-freestanding.md) | * |  | ARM64 Nintendo Switch, Horizon\n [`aarch64-pc-windows-gnullvm`](platform-support/pc-windows-gnullvm.md) | \u2713 | \u2713 |\n-[`aarch64-unknown-nto-qnx7.1.0`](platform-support/nto-qnx.md) | ? |  | ARM64 QNX Neutrino 7.1 RTOS |\n+[`aarch64-unknown-nto-qnx710`](platform-support/nto-qnx.md) | ? |  | ARM64 QNX Neutrino 7.1 RTOS |\n `aarch64-unknown-freebsd` | \u2713 | \u2713 | ARM64 FreeBSD\n `aarch64-unknown-hermit` | \u2713 |  | ARM64 HermitCore\n `aarch64-unknown-linux-gnu_ilp32` | \u2713 | \u2713 | ARM64 Linux (ILP32 ABI)\n@@ -305,7 +305,7 @@ target | std | host | notes\n `x86_64-apple-ios-macabi` | \u2713 |  | Apple Catalyst on x86_64\n `x86_64-apple-tvos` | * | | x86 64-bit tvOS\n [`x86_64-apple-watchos-sim`](platform-support/apple-watchos.md) | \u2713 | | x86 64-bit Apple WatchOS simulator\n-[`x86_64-pc-nto-qnx7.1.0`](platform-support/nto-qnx.md) | ? |  | x86 64-bit QNX Neutrino 7.1 RTOS |\n+[`x86_64-pc-nto-qnx710`](platform-support/nto-qnx.md) | ? |  | x86 64-bit QNX Neutrino 7.1 RTOS |\n [`x86_64-pc-windows-gnullvm`](platform-support/pc-windows-gnullvm.md) | \u2713 | \u2713 |\n `x86_64-pc-windows-msvc` | * |  | 64-bit Windows XP support\n `x86_64-sun-solaris` | ? |  | Deprecated target for 64-bit Solaris 10/11, illumos"}, {"sha": "37d0c31976c774a940ece3a5c119be2f31d74de3", "filename": "src/doc/rustc/src/platform-support/nto-qnx.md", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/3e9a2233d01c1ece9c31833a70b23f3c77de067f/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support%2Fnto-qnx.md", "raw_url": "https://github.com/rust-lang/rust/raw/3e9a2233d01c1ece9c31833a70b23f3c77de067f/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support%2Fnto-qnx.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support%2Fnto-qnx.md?ref=3e9a2233d01c1ece9c31833a70b23f3c77de067f", "patch": "@@ -93,15 +93,15 @@ Run the following:\n \n ```bash\n env \\\n-    CC_aarch64-unknown-nto-qnx7.1.0=\"qcc\" \\\n-    CFLAGS_aarch64-unknown-nto-qnx7.1.0=\"-Vgcc_ntoaarch64le_cxx\" \\\n-    CXX_aarch64-unknown-nto-qnx7.1.0=\"qcc\" \\\n-    AR_aarch64_unknown_nto_qnx7.1.0=\"ntoaarch64-ar\" \\\n-    CC_x86_64-pc-nto-qnx7.1.0=\"qcc\" \\\n-    CFLAGS_x86_64-pc-nto-qnx7.1.0=\"-Vgcc_ntox86_64_cxx\" \\\n-    CXX_x86_64-pc-nto-qnx7.1.0=\"qcc\" \\\n-    AR_x86_64_pc_nto_qnx7.1.0=\"ntox86_64-ar\" \\\n-        ./x.py build --target aarch64-unknown-nto-qnx7.1.0 --target x86_64-pc-nto-qnx7.1.0 --target x86_64-unknown-linux-gnu rustc library/core library/alloc/\n+    CC_aarch64-unknown-nto-qnx710=\"qcc\" \\\n+    CFLAGS_aarch64-unknown-nto-qnx710=\"-Vgcc_ntoaarch64le_cxx\" \\\n+    CXX_aarch64-unknown-nto-qnx710=\"qcc\" \\\n+    AR_aarch64_unknown_nto_qnx710=\"ntoaarch64-ar\" \\\n+    CC_x86_64-pc-nto-qnx710=\"qcc\" \\\n+    CFLAGS_x86_64-pc-nto-qnx710=\"-Vgcc_ntox86_64_cxx\" \\\n+    CXX_x86_64-pc-nto-qnx710=\"qcc\" \\\n+    AR_x86_64_pc_nto_qnx710=\"ntox86_64-ar\" \\\n+        ./x.py build --target aarch64-unknown-nto-qnx710 --target x86_64-pc-nto-qnx710 --target x86_64-unknown-linux-gnu rustc library/core library/alloc/\n ```\n \n ## Building Rust programs"}, {"sha": "95932db14e1f659ca86fd8dcbe5f02ad04940d24", "filename": "src/doc/rustc/src/target-tier-policy.md", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3e9a2233d01c1ece9c31833a70b23f3c77de067f/src%2Fdoc%2Frustc%2Fsrc%2Ftarget-tier-policy.md", "raw_url": "https://github.com/rust-lang/rust/raw/3e9a2233d01c1ece9c31833a70b23f3c77de067f/src%2Fdoc%2Frustc%2Fsrc%2Ftarget-tier-policy.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Ftarget-tier-policy.md?ref=3e9a2233d01c1ece9c31833a70b23f3c77de067f", "patch": "@@ -158,6 +158,8 @@ approved by the appropriate team for that shared code before acceptance.\n     the name of the target makes people extremely likely to form incorrect\n     beliefs about what it targets, the name should be changed or augmented to\n     disambiguate it.\n+  - If possible, use only letters, numbers, dashes and underscores for the name.\n+    Periods (`.`) are known to cause issues in Cargo.\n - Tier 3 targets may have unusual requirements to build or use, but must not\n   create legal issues or impose onerous legal terms for the Rust project or for\n   Rust developers or users."}, {"sha": "c74d37c61e887bc3f30113490995c50c6bcb3700", "filename": "src/tools/tier-check/src/main.rs", "status": "modified", "additions": 17, "deletions": 1, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/3e9a2233d01c1ece9c31833a70b23f3c77de067f/src%2Ftools%2Ftier-check%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3e9a2233d01c1ece9c31833a70b23f3c77de067f/src%2Ftools%2Ftier-check%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Ftier-check%2Fsrc%2Fmain.rs?ref=3e9a2233d01c1ece9c31833a70b23f3c77de067f", "patch": "@@ -44,7 +44,23 @@ fn main() {\n             target, filename, src\n         );\n     }\n-    if !missing.is_empty() || !extra.is_empty() {\n+    // Check target names for unwanted characters like `.` that can cause problems e.g. in Cargo.\n+    // See also Tier 3 target policy.\n+    // If desired, target names can ignore this check.\n+    let ignore_target_names =\n+        vec![\"thumbv8m.base-none-eabi\", \"thumbv8m.main-none-eabi\", \"thumbv8m.main-none-eabihf\"];\n+    let mut invalid_target_name_found = false;\n+    for target in &target_list {\n+        if !ignore_target_names.contains(target)\n+            && !target.chars().all(|c| c.is_ascii_alphanumeric() || c == '-' || c == '_')\n+        {\n+            invalid_target_name_found = true;\n+            eprintln!(\n+                \"error: Target name `{target}` contains other characters than ASCII alphanumeric (a-z, A-Z, 0-9), dash (-) or underscore (_).\"\n+            );\n+        }\n+    }\n+    if !missing.is_empty() || !extra.is_empty() || invalid_target_name_found {\n         std::process::exit(1);\n     }\n }"}]}