{"sha": "116fb72d3db430c431ffbc9f9e8981529eea804b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjExNmZiNzJkM2RiNDMwYzQzMWZmYmM5ZjllODk4MTUyOWVlYTgwNGI=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-01-23T09:03:32Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-01-23T09:03:32Z"}, "message": "Rollup merge of #47423 - est31:rustbook_checking, r=alexcrichton\n\nCheck for deadlinks from the summary during book generation\n\nPreviously, any deadlinks from a book's SUMMARY.md wouldn't\ncause any errors or warnings or similar but mdbook would simply\ncreate a page with blank content.\n\nThis has kept bug #47394 hidden. It should have been detected\nback in the PR when those wrongly named files got added to the\nbook.\n\nPR #47414 was one component of the solution. This change\nis a second line of defense for the unstable book and a first\nline of defense for any other book.\n\nWe also update mdbook to the most recent version.", "tree": {"sha": "60524797b540f4fa5be33d3ed012c3755b430294", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/60524797b540f4fa5be33d3ed012c3755b430294"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/116fb72d3db430c431ffbc9f9e8981529eea804b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/116fb72d3db430c431ffbc9f9e8981529eea804b", "html_url": "https://github.com/rust-lang/rust/commit/116fb72d3db430c431ffbc9f9e8981529eea804b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/116fb72d3db430c431ffbc9f9e8981529eea804b/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "47a8eb7c4e24b61a8a9ab4eaff60ef65291aaa56", "url": "https://api.github.com/repos/rust-lang/rust/commits/47a8eb7c4e24b61a8a9ab4eaff60ef65291aaa56", "html_url": "https://github.com/rust-lang/rust/commit/47a8eb7c4e24b61a8a9ab4eaff60ef65291aaa56"}, {"sha": "38ddb446b9da85532fc4a1540eff45509b0b9289", "url": "https://api.github.com/repos/rust-lang/rust/commits/38ddb446b9da85532fc4a1540eff45509b0b9289", "html_url": "https://github.com/rust-lang/rust/commit/38ddb446b9da85532fc4a1540eff45509b0b9289"}], "stats": {"total": 20, "additions": 11, "deletions": 9}, "files": [{"sha": "ae9e755b7a0e4de08b2c56a80ed15fa05d28dbb9", "filename": "src/Cargo.lock", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/116fb72d3db430c431ffbc9f9e8981529eea804b/src%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/116fb72d3db430c431ffbc9f9e8981529eea804b/src%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2FCargo.lock?ref=116fb72d3db430c431ffbc9f9e8981529eea804b", "patch": "@@ -1108,7 +1108,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"mdbook\"\n-version = \"0.0.26\"\n+version = \"0.0.28\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"clap 2.29.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -1674,7 +1674,7 @@ name = \"rustbook\"\n version = \"0.1.0\"\n dependencies = [\n  \"clap 2.29.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"mdbook 0.0.26 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"mdbook 0.0.28 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -2980,7 +2980,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum mac 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"c41e0c4fef86961ac6d6f8a82609f55f31b05e4fce149ac5710e439df7619ba4\"\n \"checksum markup5ever 0.5.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"047150a0e03b57e638fc45af33a0b63a0362305d5b9f92ecef81df472a4cceb0\"\n \"checksum matches 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"100aabe6b8ff4e4a7e32c1c13523379802df0772b82466207ac25b013f193376\"\n-\"checksum mdbook 0.0.26 (registry+https://github.com/rust-lang/crates.io-index)\" = \"8a1ac668292d1e5c7b1c6fd64f70d3a85105b8069a89558a0d67bdb2ff298ca1\"\n+\"checksum mdbook 0.0.28 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1ee8ba20c002000546681dc78d7f7e91fd35832058b1e2fdd492ca842bb6e9be\"\n \"checksum memchr 0.1.11 (registry+https://github.com/rust-lang/crates.io-index)\" = \"d8b629fb514376c675b98c1421e80b151d3817ac42d7c667717d282761418d20\"\n \"checksum memchr 2.0.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"796fba70e76612589ed2ce7f45282f5af869e0fdd7cc6199fa1aa1f1d591ba9d\"\n \"checksum miniz-sys 0.1.10 (registry+https://github.com/rust-lang/crates.io-index)\" = \"609ce024854aeb19a0ef7567d348aaa5a746b32fb72e336df7fcc16869d7e2b4\""}, {"sha": "bc35cbe9fbba64a3fbb2841f980be0511a515f0c", "filename": "src/tools/rustbook/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/116fb72d3db430c431ffbc9f9e8981529eea804b/src%2Ftools%2Frustbook%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/116fb72d3db430c431ffbc9f9e8981529eea804b/src%2Ftools%2Frustbook%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustbook%2FCargo.toml?ref=116fb72d3db430c431ffbc9f9e8981529eea804b", "patch": "@@ -8,5 +8,5 @@ license = \"MIT/Apache-2.0\"\n clap = \"2.25.0\"\n \n [dependencies.mdbook]\n-version = \"0.0.26\"\n+version = \"0.0.28\"\n default-features = false"}, {"sha": "50f4364e448f73a8101aaf925c41e586c915716e", "filename": "src/tools/rustbook/src/main.rs", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/116fb72d3db430c431ffbc9f9e8981529eea804b/src%2Ftools%2Frustbook%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/116fb72d3db430c431ffbc9f9e8981529eea804b/src%2Ftools%2Frustbook%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustbook%2Fsrc%2Fmain.rs?ref=116fb72d3db430c431ffbc9f9e8981529eea804b", "patch": "@@ -52,12 +52,14 @@ fn main() {\n // Build command implementation\n pub fn build(args: &ArgMatches) -> Result<()> {\n     let book_dir = get_book_dir(args);\n-    let book = MDBook::new(&book_dir).read_config()?;\n+    let mut book = MDBook::new(&book_dir).read_config()?;\n \n-    let mut book = match args.value_of(\"dest-dir\") {\n-        Some(dest_dir) => book.with_destination(dest_dir),\n-        None => book,\n-    };\n+    // Set this to allow us to catch bugs in advance.\n+    book.config.build.create_missing = false;\n+\n+    if let Some(dest_dir) = args.value_of(\"dest-dir\") {\n+        book.config.build.build_dir = PathBuf::from(dest_dir);\n+    }\n \n     book.build()?;\n "}]}