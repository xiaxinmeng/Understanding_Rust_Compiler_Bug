{"sha": "8a9c6203404404f0f7699d6a5da64c613b2b5a8b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhhOWM2MjAzNDA0NDA0ZjBmNzY5OWQ2YTVkYTY0YzYxM2IyYjVhOGI=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-03-26T06:47:38Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-03-26T06:55:00Z"}, "message": "Improve some compiletest documentation\n\nThis adds some missing documentation for rustfix related things and adds\na test for the `is_test` function.", "tree": {"sha": "bb26e6c9c4e788a36fcf0ceaa8ddb74759664405", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bb26e6c9c4e788a36fcf0ceaa8ddb74759664405"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8a9c6203404404f0f7699d6a5da64c613b2b5a8b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEvUKv4zqIn2RHUgCKtvoGpuDiZlsFAlyZzNMACgkQtvoGpuDi\nZluMBg//ZNdLn1USMstnEn35OwvP/ZaNidh9AsimsXw5nQAeJeSXZe65DZn473tn\nqVzDq1C1c0dVnwp/goM/6vfovJNYmM9uuZapemWnzOyGkKJhrOJ5FdQu/Y8NJEqj\nCrfUKqpNVQtR41bE9v0s1UKXCtH15lhbxMNecHb7oSKrAIIQ/2kXvC/wnny7EQEW\nPNE4lkStAvSZJicdn0Dw2Z+sCBK9BweWDLdlRsFWi9j+N6JiSURRtfV31A2o/itM\nUJ80uT5eYjqQVjE5l3DVIW+eV5J9jsgNT++GoNY7FFkWomlky4fxfeMbXcGIuLOD\nIwy2BIxQ8idaak+SqGWrOtOZKtpE7yuriPENPFfSe0ekyukw1K8rItlO+GHPfWt/\n5ie6tr4ODOLETgHvXOGnkxcLrzi152NQJnINn6k0yIpdO4ld0cniKJ3HEj9eOkvh\nbw8peV5wu/pNeB6VYY0D91mJ2xqPUplMbrSFBfRbZVaDFcfymFTlBuN3/Srz5lmi\nYshi/KIqaBtgkbMc6SJmZa5Vu0OFLnr5lt7oJTpHFNtJEXQgQmsb0pj62nM/jAzl\nMPD6Wzxf5ZrOSMXVP0zAcgo5JMsHAFBnf1ZzP7dltHuZeHn6NTaBAwsdbg2PrhWf\nKuNlZg7lAs0GAyw3TfTVun6OkQ1+k2AaK+biQQhH9ORHfMALk40=\n=4D5f\n-----END PGP SIGNATURE-----", "payload": "tree bb26e6c9c4e788a36fcf0ceaa8ddb74759664405\nparent fb5ed488ff1a251db895c545592488a67be67112\nauthor Philipp Hansch <dev@phansch.net> 1553582858 +0100\ncommitter Philipp Hansch <dev@phansch.net> 1553583300 +0100\n\nImprove some compiletest documentation\n\nThis adds some missing documentation for rustfix related things and adds\na test for the `is_test` function.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8a9c6203404404f0f7699d6a5da64c613b2b5a8b", "html_url": "https://github.com/rust-lang/rust/commit/8a9c6203404404f0f7699d6a5da64c613b2b5a8b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8a9c6203404404f0f7699d6a5da64c613b2b5a8b/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fb5ed488ff1a251db895c545592488a67be67112", "url": "https://api.github.com/repos/rust-lang/rust/commits/fb5ed488ff1a251db895c545592488a67be67112", "html_url": "https://github.com/rust-lang/rust/commit/fb5ed488ff1a251db895c545592488a67be67112"}], "stats": {"total": 23, "additions": 20, "deletions": 3}, "files": [{"sha": "c1920dde5b1fe059b3ac14cc6c5886fecfbee4c9", "filename": "src/tools/compiletest/src/common.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/8a9c6203404404f0f7699d6a5da64c613b2b5a8b/src%2Ftools%2Fcompiletest%2Fsrc%2Fcommon.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8a9c6203404404f0f7699d6a5da64c613b2b5a8b/src%2Ftools%2Fcompiletest%2Fsrc%2Fcommon.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fcommon.rs?ref=8a9c6203404404f0f7699d6a5da64c613b2b5a8b", "patch": "@@ -117,6 +117,7 @@ impl CompareMode {\n     }\n }\n \n+/// Configuration for compiletest\n #[derive(Clone)]\n pub struct Config {\n     /// `true` to to overwrite stderr/stdout files instead of complaining about changes in output.\n@@ -254,6 +255,8 @@ pub struct Config {\n     pub linker: Option<String>,\n     pub llvm_components: String,\n     pub llvm_cxxflags: String,\n+\n+    /// Path to a NodeJS executable. Used for JS doctests, emscripten and WASM tests\n     pub nodejs: Option<String>,\n }\n "}, {"sha": "d735d3351e6669bd862e2af872f65b0ccf26ce76", "filename": "src/tools/compiletest/src/header.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/8a9c6203404404f0f7699d6a5da64c613b2b5a8b/src%2Ftools%2Fcompiletest%2Fsrc%2Fheader.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8a9c6203404404f0f7699d6a5da64c613b2b5a8b/src%2Ftools%2Fcompiletest%2Fsrc%2Fheader.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fheader.rs?ref=8a9c6203404404f0f7699d6a5da64c613b2b5a8b", "patch": "@@ -333,7 +333,10 @@ pub struct TestProps {\n     pub normalize_stdout: Vec<(String, String)>,\n     pub normalize_stderr: Vec<(String, String)>,\n     pub failure_status: i32,\n+    // Whether or not `rustfix` should apply the `CodeSuggestion`s of this test and compile the\n+    // resulting Rust code.\n     pub run_rustfix: bool,\n+    // If true, `rustfix` will only apply `MachineApplicable` suggestions.\n     pub rustfix_only_machine_applicable: bool,\n     pub assembly_output: Option<String>,\n }"}, {"sha": "15d449260efa0b445ac123ae28632db5ff5d3560", "filename": "src/tools/compiletest/src/json.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/8a9c6203404404f0f7699d6a5da64c613b2b5a8b/src%2Ftools%2Fcompiletest%2Fsrc%2Fjson.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8a9c6203404404f0f7699d6a5da64c613b2b5a8b/src%2Ftools%2Fcompiletest%2Fsrc%2Fjson.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fjson.rs?ref=8a9c6203404404f0f7699d6a5da64c613b2b5a8b", "patch": "@@ -1,12 +1,12 @@\n+//! These structs are a subset of the ones found in `syntax::json`.\n+//! They are only used for deserialization of JSON output provided by libtest.\n+\n use crate::errors::{Error, ErrorKind};\n use crate::runtest::ProcRes;\n use serde_json;\n use std::path::Path;\n use std::str::FromStr;\n \n-// These structs are a subset of the ones found in\n-// `syntax::json`.\n-\n #[derive(Deserialize)]\n struct Diagnostic {\n     message: String,"}, {"sha": "d91710dda52397f9bd94153eb67fda0331c0071c", "filename": "src/tools/compiletest/src/main.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/8a9c6203404404f0f7699d6a5da64c613b2b5a8b/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8a9c6203404404f0f7699d6a5da64c613b2b5a8b/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs?ref=8a9c6203404404f0f7699d6a5da64c613b2b5a8b", "patch": "@@ -598,6 +598,8 @@ fn collect_tests_from_dir(\n     Ok(())\n }\n \n+\n+/// Returns true if `file_name` looks like a proper test file name.\n pub fn is_test(file_name: &OsString) -> bool {\n     let file_name = file_name.to_str().unwrap();\n \n@@ -1048,3 +1050,12 @@ fn test_extract_gdb_version() {\n         7012050: \"GNU gdb (GDB) 7.12.50.20161027-git\",\n     }\n }\n+\n+#[test]\n+fn is_test_test() {\n+    assert_eq!(true, is_test(&OsString::from(\"a_test.rs\")));\n+    assert_eq!(false, is_test(&OsString::from(\".a_test.rs\")));\n+    assert_eq!(false, is_test(&OsString::from(\"a_cat.gif\")));\n+    assert_eq!(false, is_test(&OsString::from(\"#a_dog_gif\")));\n+    assert_eq!(false, is_test(&OsString::from(\"~a_temp_file\")));\n+}"}]}