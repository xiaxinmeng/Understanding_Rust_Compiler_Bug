{"sha": "42190bb42e06f87e24f9b4280a996175e97b73ab", "node_id": "C_kwDOAAsO6NoAKDQyMTkwYmI0MmUwNmY4N2UyNGY5YjQyODBhOTk2MTc1ZTk3YjczYWI", "commit": {"author": {"name": "Andy Wang", "email": "cbeuw.andy@gmail.com", "date": "2021-12-06T23:59:59Z"}, "committer": {"name": "Andy Wang", "email": "cbeuw.andy@gmail.com", "date": "2021-12-07T00:08:02Z"}, "message": "Remove redundant path join", "tree": {"sha": "23171984b2513d5792c901a39eb0aa3ced3218ca", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/23171984b2513d5792c901a39eb0aa3ced3218ca"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/42190bb42e06f87e24f9b4280a996175e97b73ab", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCAAdFiEE7dcbcBMl24/h63ldGBtJ+fOPM3QFAmGupeIACgkQGBtJ+fOP\nM3Tw4Av/ezaAHPzU1C2UbhAFz5DIi6sXEGU2CoNt7IAV6xVLNY82F5gRX1CDXifF\nrRSz2+oru/YkoCsUWjaEOCQHrsR2OHZZwtuRmGt0OHZQfmf975CRtETQWdM+y1kV\nDm55CV6E2ISwFTllgnYAU20M0Xtvq36FCSUj/gSR7SRLqaUxO+uLROPLZZX+tXeG\ncNdsIpoHL7gG0MG3bY2fSnxmbPdi+AzmKe+02+mH2G08dhI8pym1hcTCaoUVSZzt\nW75roWW7403oSte/zgK9bh4DGw5QF9fVR7c3prakGocJQPrtlg+ikprzEVhAB0l/\naDvMmLGzwduaQYLKnvFDS4JGwYi+uOSrQeWrydSPu7KKuB9NtXkNVRxWOWAaq0+l\ncz3tUe2ow4Y3TBSPUOXQpzw3EMc4wu1uJCQ7kFgXAtswIEMfUT92EOlCGix7CCwP\nE+ByKGNrc321JCPE1e9yR41tu4srBw8HmtlW1Xy+c7MSnXviPcsK9Z4Y8YTNj/YC\nTRRVLPhg\n=ATXK\n-----END PGP SIGNATURE-----", "payload": "tree 23171984b2513d5792c901a39eb0aa3ced3218ca\nparent 95fd357d8ae371dbf85b82bfa7f926dc1f966c72\nauthor Andy Wang <cbeuw.andy@gmail.com> 1638835199 +0000\ncommitter Andy Wang <cbeuw.andy@gmail.com> 1638835682 +0000\n\nRemove redundant path join\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/42190bb42e06f87e24f9b4280a996175e97b73ab", "html_url": "https://github.com/rust-lang/rust/commit/42190bb42e06f87e24f9b4280a996175e97b73ab", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/42190bb42e06f87e24f9b4280a996175e97b73ab/comments", "author": {"login": "cbeuw", "id": 7034308, "node_id": "MDQ6VXNlcjcwMzQzMDg=", "avatar_url": "https://avatars.githubusercontent.com/u/7034308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cbeuw", "html_url": "https://github.com/cbeuw", "followers_url": "https://api.github.com/users/cbeuw/followers", "following_url": "https://api.github.com/users/cbeuw/following{/other_user}", "gists_url": "https://api.github.com/users/cbeuw/gists{/gist_id}", "starred_url": "https://api.github.com/users/cbeuw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cbeuw/subscriptions", "organizations_url": "https://api.github.com/users/cbeuw/orgs", "repos_url": "https://api.github.com/users/cbeuw/repos", "events_url": "https://api.github.com/users/cbeuw/events{/privacy}", "received_events_url": "https://api.github.com/users/cbeuw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cbeuw", "id": 7034308, "node_id": "MDQ6VXNlcjcwMzQzMDg=", "avatar_url": "https://avatars.githubusercontent.com/u/7034308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cbeuw", "html_url": "https://github.com/cbeuw", "followers_url": "https://api.github.com/users/cbeuw/followers", "following_url": "https://api.github.com/users/cbeuw/following{/other_user}", "gists_url": "https://api.github.com/users/cbeuw/gists{/gist_id}", "starred_url": "https://api.github.com/users/cbeuw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cbeuw/subscriptions", "organizations_url": "https://api.github.com/users/cbeuw/orgs", "repos_url": "https://api.github.com/users/cbeuw/repos", "events_url": "https://api.github.com/users/cbeuw/events{/privacy}", "received_events_url": "https://api.github.com/users/cbeuw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "95fd357d8ae371dbf85b82bfa7f926dc1f966c72", "url": "https://api.github.com/repos/rust-lang/rust/commits/95fd357d8ae371dbf85b82bfa7f926dc1f966c72", "html_url": "https://github.com/rust-lang/rust/commit/95fd357d8ae371dbf85b82bfa7f926dc1f966c72"}], "stats": {"total": 11, "additions": 4, "deletions": 7}, "files": [{"sha": "0549bf853b9552f42fab756df0e6af012fc78ef6", "filename": "compiler/rustc_codegen_llvm/src/debuginfo/metadata.rs", "status": "modified", "additions": 4, "deletions": 7, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/42190bb42e06f87e24f9b4280a996175e97b73ab/compiler%2Frustc_codegen_llvm%2Fsrc%2Fdebuginfo%2Fmetadata.rs", "raw_url": "https://github.com/rust-lang/rust/raw/42190bb42e06f87e24f9b4280a996175e97b73ab/compiler%2Frustc_codegen_llvm%2Fsrc%2Fdebuginfo%2Fmetadata.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_llvm%2Fsrc%2Fdebuginfo%2Fmetadata.rs?ref=42190bb42e06f87e24f9b4280a996175e97b73ab", "patch": "@@ -1055,14 +1055,11 @@ pub fn compile_unit_metadata(\n     let work_dir = tcx.sess.opts.working_dir.to_string_lossy(FileNameDisplayPreference::Remapped);\n     let flags = \"\\0\";\n     let output_filenames = tcx.output_filenames(());\n-    let out_dir = &output_filenames.out_directory;\n     let split_name = if tcx.sess.target_can_use_split_dwarf() {\n-        output_filenames.split_dwarf_path(tcx.sess.split_debuginfo(), Some(codegen_unit_name)).map(\n-            |f| {\n-                let joined = out_dir.join(f);\n-                tcx.sess.source_map().path_mapping().map_prefix(joined).0\n-            },\n-        )\n+        output_filenames\n+            .split_dwarf_path(tcx.sess.split_debuginfo(), Some(codegen_unit_name))\n+            // We get a path relative to the working directory from split_dwarf_path\n+            .map(|f| tcx.sess.source_map().path_mapping().map_prefix(f).0)\n     } else {\n         None\n     }"}]}