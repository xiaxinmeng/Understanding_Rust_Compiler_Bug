{"sha": "e1e0989a0d53d7521b9efdc774236c25bff844bd", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUxZTA5ODlhMGQ1M2Q3NTIxYjllZmRjNzc0MjM2YzI1YmZmODQ0YmQ=", "commit": {"author": {"name": "Charles Lew", "email": "crlf0710@gmail.com", "date": "2021-08-18T11:02:28Z"}, "committer": {"name": "Charles Lew", "email": "crlf0710@gmail.com", "date": "2021-08-18T11:02:28Z"}, "message": "Add a new test case to verify behavior.", "tree": {"sha": "6f10829dfb75b9292d924d42df1041b0265118a6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6f10829dfb75b9292d924d42df1041b0265118a6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e1e0989a0d53d7521b9efdc774236c25bff844bd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e1e0989a0d53d7521b9efdc774236c25bff844bd", "html_url": "https://github.com/rust-lang/rust/commit/e1e0989a0d53d7521b9efdc774236c25bff844bd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e1e0989a0d53d7521b9efdc774236c25bff844bd/comments", "author": {"login": "crlf0710", "id": 451806, "node_id": "MDQ6VXNlcjQ1MTgwNg==", "avatar_url": "https://avatars.githubusercontent.com/u/451806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crlf0710", "html_url": "https://github.com/crlf0710", "followers_url": "https://api.github.com/users/crlf0710/followers", "following_url": "https://api.github.com/users/crlf0710/following{/other_user}", "gists_url": "https://api.github.com/users/crlf0710/gists{/gist_id}", "starred_url": "https://api.github.com/users/crlf0710/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crlf0710/subscriptions", "organizations_url": "https://api.github.com/users/crlf0710/orgs", "repos_url": "https://api.github.com/users/crlf0710/repos", "events_url": "https://api.github.com/users/crlf0710/events{/privacy}", "received_events_url": "https://api.github.com/users/crlf0710/received_events", "type": "User", "site_admin": false}, "committer": {"login": "crlf0710", "id": 451806, "node_id": "MDQ6VXNlcjQ1MTgwNg==", "avatar_url": "https://avatars.githubusercontent.com/u/451806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crlf0710", "html_url": "https://github.com/crlf0710", "followers_url": "https://api.github.com/users/crlf0710/followers", "following_url": "https://api.github.com/users/crlf0710/following{/other_user}", "gists_url": "https://api.github.com/users/crlf0710/gists{/gist_id}", "starred_url": "https://api.github.com/users/crlf0710/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crlf0710/subscriptions", "organizations_url": "https://api.github.com/users/crlf0710/orgs", "repos_url": "https://api.github.com/users/crlf0710/repos", "events_url": "https://api.github.com/users/crlf0710/events{/privacy}", "received_events_url": "https://api.github.com/users/crlf0710/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6b1c52ff254c40b3b5f7a3e16db9cf3f8e9b35e0", "url": "https://api.github.com/repos/rust-lang/rust/commits/6b1c52ff254c40b3b5f7a3e16db9cf3f8e9b35e0", "html_url": "https://github.com/rust-lang/rust/commit/6b1c52ff254c40b3b5f7a3e16db9cf3f8e9b35e0"}], "stats": {"total": 39, "additions": 39, "deletions": 0}, "files": [{"sha": "8d0a9ef0ace693dff0c3bc808fc86d9d09a749a5", "filename": "src/test/ui/traits/trait-upcasting/correct-supertrait-substitution.rs", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/e1e0989a0d53d7521b9efdc774236c25bff844bd/src%2Ftest%2Fui%2Ftraits%2Ftrait-upcasting%2Fcorrect-supertrait-substitution.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e1e0989a0d53d7521b9efdc774236c25bff844bd/src%2Ftest%2Fui%2Ftraits%2Ftrait-upcasting%2Fcorrect-supertrait-substitution.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Ftrait-upcasting%2Fcorrect-supertrait-substitution.rs?ref=e1e0989a0d53d7521b9efdc774236c25bff844bd", "patch": "@@ -0,0 +1,39 @@\n+// run-pass\n+#![feature(trait_upcasting)]\n+#![allow(incomplete_features)]\n+\n+trait Foo<T: Default + ToString>: Bar<i32> + Bar<T> {}\n+trait Bar<T: Default + ToString> {\n+    fn bar(&self) -> String {\n+        T::default().to_string()\n+    }\n+}\n+\n+struct S1;\n+\n+impl Bar<i32> for S1 {}\n+impl Foo<i32> for S1 {}\n+\n+struct S2;\n+impl Bar<i32> for S2 {}\n+impl Bar<bool> for S2 {}\n+impl Foo<bool> for S2 {}\n+\n+fn test1(x: &dyn Foo<i32>) {\n+    let s = x as &dyn Bar<i32>;\n+    assert_eq!(\"0\", &s.bar().to_string());\n+}\n+\n+fn test2(x: &dyn Foo<bool>) {\n+    let p = x as &dyn Bar<i32>;\n+    assert_eq!(\"0\", &p.bar().to_string());\n+    let q = x as &dyn Bar<bool>;\n+    assert_eq!(\"false\", &q.bar().to_string());\n+}\n+\n+fn main() {\n+    let s1 = S1;\n+    test1(&s1);\n+    let s2 = S2;\n+    test2(&s2);\n+}"}]}