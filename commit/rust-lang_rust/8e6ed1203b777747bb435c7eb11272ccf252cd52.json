{"sha": "8e6ed1203b777747bb435c7eb11272ccf252cd52", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhlNmVkMTIwM2I3Nzc3NDdiYjQzNWM3ZWIxMTI3MmNjZjI1MmNkNTI=", "commit": {"author": {"name": "Zack M. Davis", "email": "code@zackmdavis.net", "date": "2017-10-12T07:42:52Z"}, "committer": {"name": "Zack M. Davis", "email": "code@zackmdavis.net", "date": "2017-10-16T19:14:15Z"}, "message": "bolster UI test converage for lint suggestions", "tree": {"sha": "809c24ca9304832b20e3334b5e969bcb6840e725", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/809c24ca9304832b20e3334b5e969bcb6840e725"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8e6ed1203b777747bb435c7eb11272ccf252cd52", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8e6ed1203b777747bb435c7eb11272ccf252cd52", "html_url": "https://github.com/rust-lang/rust/commit/8e6ed1203b777747bb435c7eb11272ccf252cd52", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8e6ed1203b777747bb435c7eb11272ccf252cd52/comments", "author": {"login": "zackmdavis", "id": 1076988, "node_id": "MDQ6VXNlcjEwNzY5ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1076988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zackmdavis", "html_url": "https://github.com/zackmdavis", "followers_url": "https://api.github.com/users/zackmdavis/followers", "following_url": "https://api.github.com/users/zackmdavis/following{/other_user}", "gists_url": "https://api.github.com/users/zackmdavis/gists{/gist_id}", "starred_url": "https://api.github.com/users/zackmdavis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zackmdavis/subscriptions", "organizations_url": "https://api.github.com/users/zackmdavis/orgs", "repos_url": "https://api.github.com/users/zackmdavis/repos", "events_url": "https://api.github.com/users/zackmdavis/events{/privacy}", "received_events_url": "https://api.github.com/users/zackmdavis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "zackmdavis", "id": 1076988, "node_id": "MDQ6VXNlcjEwNzY5ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1076988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zackmdavis", "html_url": "https://github.com/zackmdavis", "followers_url": "https://api.github.com/users/zackmdavis/followers", "following_url": "https://api.github.com/users/zackmdavis/following{/other_user}", "gists_url": "https://api.github.com/users/zackmdavis/gists{/gist_id}", "starred_url": "https://api.github.com/users/zackmdavis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zackmdavis/subscriptions", "organizations_url": "https://api.github.com/users/zackmdavis/orgs", "repos_url": "https://api.github.com/users/zackmdavis/repos", "events_url": "https://api.github.com/users/zackmdavis/events{/privacy}", "received_events_url": "https://api.github.com/users/zackmdavis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "38e5a964f2c90d46dfa8dff17a2ce251e7465da1", "url": "https://api.github.com/repos/rust-lang/rust/commits/38e5a964f2c90d46dfa8dff17a2ce251e7465da1", "html_url": "https://github.com/rust-lang/rust/commit/38e5a964f2c90d46dfa8dff17a2ce251e7465da1"}], "stats": {"total": 94, "additions": 83, "deletions": 11}, "files": [{"sha": "e078056ab5e0abf15b3e4d259a5d9b6509bf6e63", "filename": "src/test/ui/lint/suggestions.rs", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/8e6ed1203b777747bb435c7eb11272ccf252cd52/src%2Ftest%2Fui%2Flint%2Fsuggestions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8e6ed1203b777747bb435c7eb11272ccf252cd52/src%2Ftest%2Fui%2Flint%2Fsuggestions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fsuggestions.rs?ref=8e6ed1203b777747bb435c7eb11272ccf252cd52", "patch": "@@ -11,10 +11,27 @@\n #![warn(unused_mut)] // UI tests pass `-A unused`\u2014see Issue #43896\n #![feature(no_debug)]\n \n+#[no_mangle] static SHENZHOU: usize = 1; // should suggest `pub`\n+#[no_mangle] const DISCOVERY: usize = 1; // should suggest `pub static` rather than `const`\n+\n+#[no_mangle] // should suggest removal (generics can't be no-mangle)\n+pub fn defiant<T>(_t: T) {}\n+\n+#[no_mangle]\n+fn rio_grande() {} // should suggest `pub`\n+\n+struct Equinox {\n+    warp_factor: f32,\n+}\n+\n #[no_debug] // should suggest removal of deprecated attribute\n fn main() {\n     while true { // should suggest `loop`\n         let mut a = (1); // should suggest no `mut`, no parens\n+        let d = Equinox { warp_factor: 9.975 };\n+        match d {\n+            Equinox { warp_factor: warp_factor } => {} // should suggest shorthand\n+        }\n         println!(\"{}\", a);\n     }\n }"}, {"sha": "7a498b56413a9a65929120ad5e1bf72bdc5547c2", "filename": "src/test/ui/lint/suggestions.stderr", "status": "modified", "additions": 66, "deletions": 11, "changes": 77, "blob_url": "https://github.com/rust-lang/rust/blob/8e6ed1203b777747bb435c7eb11272ccf252cd52/src%2Ftest%2Fui%2Flint%2Fsuggestions.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/8e6ed1203b777747bb435c7eb11272ccf252cd52/src%2Ftest%2Fui%2Flint%2Fsuggestions.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fsuggestions.stderr?ref=8e6ed1203b777747bb435c7eb11272ccf252cd52", "patch": "@@ -1,23 +1,23 @@\n warning: unnecessary parentheses around assigned value\n-  --> $DIR/suggestions.rs:17:21\n+  --> $DIR/suggestions.rs:30:21\n    |\n-17 |         let mut a = (1); // should suggest no `mut`, no parens\n+30 |         let mut a = (1); // should suggest no `mut`, no parens\n    |                     ^^^ help: remove these parentheses\n    |\n    = note: #[warn(unused_parens)] on by default\n \n warning: use of deprecated attribute `no_debug`: the `#[no_debug]` attribute was an experimental feature that has been deprecated due to lack of demand. See https://github.com/rust-lang/rust/issues/29721\n-  --> $DIR/suggestions.rs:14:1\n+  --> $DIR/suggestions.rs:27:1\n    |\n-14 | #[no_debug] // should suggest removal of deprecated attribute\n+27 | #[no_debug] // should suggest removal of deprecated attribute\n    | ^^^^^^^^^^^ help: remove this attribute\n    |\n    = note: #[warn(deprecated)] on by default\n \n warning: variable does not need to be mutable\n-  --> $DIR/suggestions.rs:17:13\n+  --> $DIR/suggestions.rs:30:13\n    |\n-17 |         let mut a = (1); // should suggest no `mut`, no parens\n+30 |         let mut a = (1); // should suggest no `mut`, no parens\n    |             ---^^\n    |             |\n    |             help: remove this `mut`\n@@ -28,18 +28,73 @@ note: lint level defined here\n 11 | #![warn(unused_mut)] // UI tests pass `-A unused`\u2014see Issue #43896\n    |         ^^^^^^^^^^\n \n+warning: static is marked #[no_mangle], but not exported\n+  --> $DIR/suggestions.rs:14:14\n+   |\n+14 | #[no_mangle] static SHENZHOU: usize = 1; // should suggest `pub`\n+   |              -^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |              |\n+   |              help: try making it public: `pub `\n+   |\n+   = note: #[warn(private_no_mangle_statics)] on by default\n+\n+error: const items should never be #[no_mangle]\n+  --> $DIR/suggestions.rs:15:14\n+   |\n+15 | #[no_mangle] const DISCOVERY: usize = 1; // should suggest `pub static` rather than `const`\n+   |              -----^^^^^^^^^^^^^^^^^^^^^^\n+   |              |\n+   |              help: try a static value: `pub static`\n+   |\n+   = note: #[deny(no_mangle_const_items)] on by default\n+\n+warning: functions generic over types must be mangled\n+  --> $DIR/suggestions.rs:18:1\n+   |\n+17 | #[no_mangle] // should suggest removal (generics can't be no-mangle)\n+   | ------------ help: remove this attribute\n+18 | pub fn defiant<T>(_t: T) {}\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+   = note: #[warn(no_mangle_generic_items)] on by default\n+\n+warning: function is marked #[no_mangle], but not exported\n+  --> $DIR/suggestions.rs:21:1\n+   |\n+21 | fn rio_grande() {} // should suggest `pub`\n+   | -^^^^^^^^^^^^^^^^^\n+   | |\n+   | help: try making it public: `pub `\n+   |\n+   = note: #[warn(private_no_mangle_fns)] on by default\n+\n warning: denote infinite loops with `loop { ... }`\n-  --> $DIR/suggestions.rs:16:5\n+  --> $DIR/suggestions.rs:29:5\n    |\n-16 |       while true { // should suggest `loop`\n+29 |       while true { // should suggest `loop`\n    |       ^---------\n    |       |\n    |  _____help: use `loop`\n    | |\n-17 | |         let mut a = (1); // should suggest no `mut`, no parens\n-18 | |         println!(\"{}\", a);\n-19 | |     }\n+30 | |         let mut a = (1); // should suggest no `mut`, no parens\n+31 | |         let d = Equinox { warp_factor: 9.975 };\n+32 | |         match d {\n+...  |\n+35 | |         println!(\"{}\", a);\n+36 | |     }\n    | |_____^\n    |\n    = note: #[warn(while_true)] on by default\n \n+warning: the `warp_factor:` in this pattern is redundant\n+  --> $DIR/suggestions.rs:33:23\n+   |\n+33 |             Equinox { warp_factor: warp_factor } => {} // should suggest shorthand\n+   |                       ------------^^^^^^^^^^^^\n+   |                       |\n+   |                       help: remove this\n+   |\n+   = note: #[warn(non_shorthand_field_patterns)] on by default\n+\n+error: aborting due to previous error\n+"}]}