{"sha": "2b5ef2574488f0c9fbb160f4f8be04fb59208a8d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJiNWVmMjU3NDQ4OGYwYzlmYmIxNjBmNGY4YmUwNGZiNTkyMDhhOGQ=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-05-15T11:29:56Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-05-15T11:29:56Z"}, "message": "Rollup merge of #85289 - GuillaumeGomez:fix-toggle-position-mobile, r=jsha\n\nFix toggle position on mobile\n\nBefore:\n\n![Screenshot from 2021-05-14 14-21-27](https://user-images.githubusercontent.com/3050060/118276475-fe210300-b4c7-11eb-94f8-4e2a4e10d91e.png)\n![Screenshot from 2021-05-14 14-21-30](https://user-images.githubusercontent.com/3050060/118276479-feb99980-b4c7-11eb-85db-40e9df6e9abd.png)\n\nAfter:\n\n![Screenshot from 2021-05-14 15-16-54](https://user-images.githubusercontent.com/3050060/118276494-0416e400-b4c8-11eb-9479-d447928cfa62.png)\n![Screenshot from 2021-05-14 15-16-59](https://user-images.githubusercontent.com/3050060/118276498-0416e400-b4c8-11eb-99f6-894276c62dfc.png)\n\nr? ```@jsha```", "tree": {"sha": "5cdb7a305564b7c85eb6da5645548737efc853ae", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5cdb7a305564b7c85eb6da5645548737efc853ae"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2b5ef2574488f0c9fbb160f4f8be04fb59208a8d", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgn7C0CRBK7hj4Ov3rIwAAOQIIACHBFB7J2L5qg0e/fi1AbeVz\n6uwCmJ3Grn+yZ/Q4ZAKFhCG5Clef6LDG9TsSVis3E37pm9K6h5A19pLomzZuEoXD\nR7aUWk6c3QHYaSirOgSoB/ArPFNpQ+QN84rYMsTZtGepkZnHaGFB3oEX1K28Lkot\n3PeKtBYXDNH3ELmbLVQbZt2X6iwLfVtR5lU+6jGBG0iX1HSkRJkgafPeGoNzfY44\ndpG5y3Cq0Y2N/IlWuB0gr9eyo+IKe9QIfN/moKb5q9d2TZJdSpMKt0tatM4keNeL\n3Azl54RHtjZAxKOXQtuobpnWfitbtxRVn3+mwz3DOdNfSqfDiNOdHb/uWvhNkoQ=\n=TPm+\n-----END PGP SIGNATURE-----\n", "payload": "tree 5cdb7a305564b7c85eb6da5645548737efc853ae\nparent cd3d166021ac9ac90763ec6e6948065523ff9033\nparent dfc8b6094e8dc96b8dcbde8d2d11e3a1cbab294a\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1621078196 +0200\ncommitter GitHub <noreply@github.com> 1621078196 +0200\n\nRollup merge of #85289 - GuillaumeGomez:fix-toggle-position-mobile, r=jsha\n\nFix toggle position on mobile\n\nBefore:\n\n![Screenshot from 2021-05-14 14-21-27](https://user-images.githubusercontent.com/3050060/118276475-fe210300-b4c7-11eb-94f8-4e2a4e10d91e.png)\n![Screenshot from 2021-05-14 14-21-30](https://user-images.githubusercontent.com/3050060/118276479-feb99980-b4c7-11eb-85db-40e9df6e9abd.png)\n\nAfter:\n\n![Screenshot from 2021-05-14 15-16-54](https://user-images.githubusercontent.com/3050060/118276494-0416e400-b4c8-11eb-9479-d447928cfa62.png)\n![Screenshot from 2021-05-14 15-16-59](https://user-images.githubusercontent.com/3050060/118276498-0416e400-b4c8-11eb-99f6-894276c62dfc.png)\n\nr? ```@jsha```\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2b5ef2574488f0c9fbb160f4f8be04fb59208a8d", "html_url": "https://github.com/rust-lang/rust/commit/2b5ef2574488f0c9fbb160f4f8be04fb59208a8d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2b5ef2574488f0c9fbb160f4f8be04fb59208a8d/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cd3d166021ac9ac90763ec6e6948065523ff9033", "url": "https://api.github.com/repos/rust-lang/rust/commits/cd3d166021ac9ac90763ec6e6948065523ff9033", "html_url": "https://github.com/rust-lang/rust/commit/cd3d166021ac9ac90763ec6e6948065523ff9033"}, {"sha": "dfc8b6094e8dc96b8dcbde8d2d11e3a1cbab294a", "url": "https://api.github.com/repos/rust-lang/rust/commits/dfc8b6094e8dc96b8dcbde8d2d11e3a1cbab294a", "html_url": "https://github.com/rust-lang/rust/commit/dfc8b6094e8dc96b8dcbde8d2d11e3a1cbab294a"}], "stats": {"total": 411, "additions": 219, "deletions": 192}, "files": [{"sha": "e2e1aefa4a84207cf2530217cfae8b1f264bf494", "filename": "src/librustdoc/html/static/rustdoc.css", "status": "modified", "additions": 198, "deletions": 192, "changes": 390, "blob_url": "https://github.com/rust-lang/rust/blob/2b5ef2574488f0c9fbb160f4f8be04fb59208a8d/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/2b5ef2574488f0c9fbb160f4f8be04fb59208a8d/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css?ref=2b5ef2574488f0c9fbb160f4f8be04fb59208a8d", "patch": "@@ -1293,6 +1293,201 @@ h4 > .notable-traits {\n \tborder-top: 1px solid;\n }\n \n+\n+\n+h3.notable {\n+\tmargin: 0;\n+\tmargin-bottom: 13px;\n+\tfont-size: 19px;\n+}\n+\n+kbd {\n+\tdisplay: inline-block;\n+\tpadding: 3px 5px;\n+\tfont: 15px monospace;\n+\tline-height: 10px;\n+\tvertical-align: middle;\n+\tborder: solid 1px;\n+\tborder-radius: 3px;\n+\tbox-shadow: inset 0 -1px 0;\n+\tcursor: default;\n+}\n+\n+.hidden-by-impl-hider,\n+.hidden-by-usual-hider {\n+\t/* important because of conflicting rule for small screens */\n+\tdisplay: none !important;\n+}\n+\n+#implementations-list > h3 > span.in-band {\n+\twidth: 100%;\n+}\n+\n+.table-display {\n+\twidth: 100%;\n+\tborder: 0;\n+\tborder-collapse: collapse;\n+\tborder-spacing: 0;\n+\tfont-size: 16px;\n+}\n+\n+.table-display tr td:first-child {\n+\tpadding-right: 0;\n+}\n+\n+.table-display tr td:last-child {\n+\tfloat: right;\n+}\n+.table-display .out-of-band {\n+\tposition: relative;\n+\tfont-size: 19px;\n+\tdisplay: block;\n+}\n+#implementors-list > .impl-items .table-display .out-of-band {\n+\tfont-size: 17px;\n+}\n+\n+.table-display td:hover .anchor {\n+\tdisplay: block;\n+\ttop: 2px;\n+\tleft: -5px;\n+}\n+\n+#main > ul {\n+\tpadding-left: 10px;\n+}\n+#main > ul > li {\n+\tlist-style: none;\n+}\n+\n+.non-exhaustive {\n+\tmargin-bottom: 1em;\n+}\n+\n+div.children {\n+\tpadding-left: 27px;\n+\tdisplay: none;\n+}\n+div.name {\n+\tcursor: pointer;\n+\tposition: relative;\n+\tmargin-left: 16px;\n+}\n+div.files > a {\n+\tdisplay: block;\n+\tpadding: 0 3px;\n+}\n+div.files > a:hover, div.name:hover {\n+\tbackground-color: #a14b4b;\n+}\n+div.name.expand + .children {\n+\tdisplay: block;\n+}\n+div.name::before {\n+\tcontent: \"\\25B6\";\n+\tpadding-left: 4px;\n+\tfont-size: 0.7em;\n+\tposition: absolute;\n+\tleft: -16px;\n+\ttop: 4px;\n+}\n+div.name.expand::before {\n+\ttransform: rotate(90deg);\n+\tleft: -15px;\n+\ttop: 2px;\n+}\n+\n+/* The hideme class is used on summary tags that contain a span with\n+\tplaceholder text shown only when the toggle is closed. For instance,\n+\t\"Expand description\" or \"Show methods\". */\n+details.rustdoc-toggle > summary.hideme {\n+\tcursor: pointer;\n+}\n+\n+details.rustdoc-toggle > summary, details.undocumented > summary {\n+\tlist-style: none;\n+}\n+details.rustdoc-toggle > summary::-webkit-details-marker,\n+details.rustdoc-toggle > summary::marker,\n+details.undocumented > summary::-webkit-details-marker,\n+details.undocumented > summary::marker {\n+\tdisplay: none;\n+}\n+\n+details.rustdoc-toggle > summary.hideme > span {\n+\tmargin-left: 9px;\n+}\n+\n+details.rustdoc-toggle > summary::before {\n+\tcontent: \"[+]\";\n+\tfont-weight: 300;\n+\tfont-size: 0.8em;\n+\tletter-spacing: 1px;\n+\tcursor: pointer;\n+}\n+\n+details.rustdoc-toggle.top-doc > summary,\n+details.rustdoc-toggle.top-doc > summary::before,\n+details.rustdoc-toggle.non-exhaustive > summary,\n+details.rustdoc-toggle.non-exhaustive > summary::before {\n+\tfont-family: 'Fira Sans';\n+\tfont-size: 16px;\n+}\n+\n+details.non-exhaustive {\n+\tmargin-bottom: 8px;\n+}\n+\n+details.rustdoc-toggle > summary.hideme::before {\n+\tposition: relative;\n+}\n+\n+details.rustdoc-toggle > summary:not(.hideme)::before {\n+\tposition: absolute;\n+\tleft: -23px;\n+\ttop: initial;\n+}\n+\n+.impl-items > details.rustdoc-toggle > summary:not(.hideme)::before,\n+.undocumented > details.rustdoc-toggle > summary:not(.hideme)::before {\n+\tposition: absolute;\n+\ttop: 3px;\n+\tleft: -2px;\n+}\n+\n+/* When a \"hideme\" summary is open and the \"Expand description\" or \"Show\n+\tmethods\" text is hidden, we want the [-] toggle that remains to not\n+\taffect the layout of the items to its right. To do that, we use\n+\tabsolute positioning. Note that we also set position: relative\n+\ton the parent <details> to make this work properly. */\n+details.rustdoc-toggle[open] > summary.hideme {\n+\tposition: absolute;\n+}\n+\n+details.rustdoc-toggle, details.undocumented {\n+\tposition: relative;\n+}\n+\n+details.rustdoc-toggle[open] > summary.hideme > span {\n+\tdisplay: none;\n+}\n+\n+details.rustdoc-toggle[open] > summary::before {\n+\tcontent: \"[\u2212]\";\n+\tdisplay: inline;\n+}\n+\n+details.undocumented > summary::before {\n+\tcontent: \"[+] Show hidden undocumented items\";\n+\tcursor: pointer;\n+\tfont-size: 16px;\n+\tfont-weight: 300;\n+}\n+\n+details.undocumented[open] > summary::before {\n+\tcontent: \"[\u2212] Hide undocumented items\";\n+}\n+\n /* Media Queries */\n \n @media (min-width: 701px) {\n@@ -1492,8 +1687,9 @@ h4 > .notable-traits {\n \t\tborder-bottom: 1px solid;\n \t}\n \n-\t.item-list > details.rustdoc-toggle > summary:not(.hideme)::before {\n-\t\tleft: -10px;\n+\t#main > details.rustdoc-toggle > summary::before,\n+\t#main > div > details.rustdoc-toggle > summary::before {\n+\t\tleft: -11px;\n \t}\n \n \t#all-types {\n@@ -1587,193 +1783,3 @@ h4 > .notable-traits {\n \t\tmargin-left: 12px;\n \t}\n }\n-\n-h3.notable {\n-\tmargin: 0;\n-\tmargin-bottom: 13px;\n-\tfont-size: 19px;\n-}\n-\n-kbd {\n-\tdisplay: inline-block;\n-\tpadding: 3px 5px;\n-\tfont: 15px monospace;\n-\tline-height: 10px;\n-\tvertical-align: middle;\n-\tborder: solid 1px;\n-\tborder-radius: 3px;\n-\tbox-shadow: inset 0 -1px 0;\n-\tcursor: default;\n-}\n-\n-.hidden-by-impl-hider,\n-.hidden-by-usual-hider {\n-\t/* important because of conflicting rule for small screens */\n-\tdisplay: none !important;\n-}\n-\n-#implementations-list > h3 > span.in-band {\n-\twidth: 100%;\n-}\n-\n-.table-display {\n-\twidth: 100%;\n-\tborder: 0;\n-\tborder-collapse: collapse;\n-\tborder-spacing: 0;\n-\tfont-size: 16px;\n-}\n-\n-.table-display tr td:first-child {\n-\tpadding-right: 0;\n-}\n-\n-.table-display tr td:last-child {\n-\tfloat: right;\n-}\n-.table-display .out-of-band {\n-\tposition: relative;\n-\tfont-size: 19px;\n-\tdisplay: block;\n-}\n-#implementors-list > .impl-items .table-display .out-of-band {\n-\tfont-size: 17px;\n-}\n-\n-.table-display td:hover .anchor {\n-\tdisplay: block;\n-\ttop: 2px;\n-\tleft: -5px;\n-}\n-\n-#main > ul {\n-\tpadding-left: 10px;\n-}\n-#main > ul > li {\n-\tlist-style: none;\n-}\n-\n-.non-exhaustive {\n-\tmargin-bottom: 1em;\n-}\n-\n-div.children {\n-\tpadding-left: 27px;\n-\tdisplay: none;\n-}\n-div.name {\n-\tcursor: pointer;\n-\tposition: relative;\n-\tmargin-left: 16px;\n-}\n-div.files > a {\n-\tdisplay: block;\n-\tpadding: 0 3px;\n-}\n-div.files > a:hover, div.name:hover {\n-\tbackground-color: #a14b4b;\n-}\n-div.name.expand + .children {\n-\tdisplay: block;\n-}\n-div.name::before {\n-\tcontent: \"\\25B6\";\n-\tpadding-left: 4px;\n-\tfont-size: 0.7em;\n-\tposition: absolute;\n-\tleft: -16px;\n-\ttop: 4px;\n-}\n-div.name.expand::before {\n-\ttransform: rotate(90deg);\n-\tleft: -15px;\n-\ttop: 2px;\n-}\n-\n-/* The hideme class is used on summary tags that contain a span with\n-\tplaceholder text shown only when the toggle is closed. For instance,\n-\t\"Expand description\" or \"Show methods\". */\n-details.rustdoc-toggle > summary.hideme {\n-\tcursor: pointer;\n-}\n-\n-details.rustdoc-toggle > summary::-webkit-details-marker,\n-details.rustdoc-toggle > summary::marker,\n-details.undocumented > summary::-webkit-details-marker,\n-details.undocumented > summary::marker {\n-\tdisplay: none;\n-}\n-\n-details.rustdoc-toggle > summary.hideme > span {\n-\tmargin-left: 9px;\n-}\n-\n-details.rustdoc-toggle > summary::before {\n-\tcontent: \"[+]\";\n-\tfont-weight: 300;\n-\tfont-size: 0.8em;\n-\tletter-spacing: 1px;\n-\tcursor: pointer;\n-}\n-\n-details.rustdoc-toggle.top-doc > summary,\n-details.rustdoc-toggle.top-doc > summary::before,\n-details.rustdoc-toggle.non-exhaustive > summary,\n-details.rustdoc-toggle.non-exhaustive > summary::before {\n-\tfont-family: 'Fira Sans';\n-\tfont-size: 16px;\n-}\n-\n-details.non-exhaustive {\n-\tmargin-bottom: 8px;\n-}\n-\n-details.rustdoc-toggle > summary.hideme::before {\n-\tposition: relative;\n-}\n-\n-details.rustdoc-toggle > summary:not(.hideme)::before {\n-\tposition: absolute;\n-\tleft: -23px;\n-\ttop: initial;\n-}\n-\n-.impl-items > details.rustdoc-toggle > summary:not(.hideme)::before,\n-.undocumented > details.rustdoc-toggle > summary:not(.hideme)::before {\n-\tposition: absolute;\n-\ttop: 3px;\n-\tleft: -2px;\n-}\n-\n-/* When a \"hideme\" summary is open and the \"Expand description\" or \"Show\n-\tmethods\" text is hidden, we want the [-] toggle that remains to not\n-\taffect the layout of the items to its right. To do that, we use\n-\tabsolute positioning. Note that we also set position: relative\n-\ton the parent <details> to make this work properly. */\n-details.rustdoc-toggle[open] > summary.hideme {\n-\tposition: absolute;\n-}\n-\n-details.rustdoc-toggle, details.undocumented {\n-\tposition: relative;\n-}\n-\n-details.rustdoc-toggle[open] > summary.hideme > span {\n-\tdisplay: none;\n-}\n-\n-details.rustdoc-toggle[open] > summary::before {\n-\tcontent: \"[\u2212]\";\n-\tdisplay: inline;\n-}\n-\n-details.undocumented > summary::before {\n-\tcontent: \"[+] Show hidden undocumented items\";\n-\tcursor: pointer;\n-\tfont-size: 16px;\n-\tfont-weight: 300;\n-}\n-\n-details.undocumented[open] > summary::before {\n-\tcontent: \"[-] Hide undocumented items\";\n-}"}, {"sha": "fcdfc0344db809db9fb41e38a45642e6b639a763", "filename": "src/test/rustdoc-gui/toggle-docs-mobile.goml", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/2b5ef2574488f0c9fbb160f4f8be04fb59208a8d/src%2Ftest%2Frustdoc-gui%2Ftoggle-docs-mobile.goml", "raw_url": "https://github.com/rust-lang/rust/raw/2b5ef2574488f0c9fbb160f4f8be04fb59208a8d/src%2Ftest%2Frustdoc-gui%2Ftoggle-docs-mobile.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Ftoggle-docs-mobile.goml?ref=2b5ef2574488f0c9fbb160f4f8be04fb59208a8d", "patch": "@@ -0,0 +1,21 @@\n+goto: file://|DOC_PATH|/test_docs/struct.Foo.html\n+size: (433, 600)\n+assert: (\".top-doc\", \"open\", \"\")\n+click: (4, 280) // This is the position of the top doc comment toggle\n+assert-false: (\".top-doc\", \"open\", \"\")\n+click: (4, 280)\n+assert: (\".top-doc\", \"open\", \"\")\n+// To ensure that the toggle isn't over the text, we check that the toggle isn't clicked.\n+click: (3, 280)\n+assert: (\".top-doc\", \"open\", \"\")\n+\n+// Now we do the same but with a little bigger width\n+size: (600, 600)\n+assert: (\".top-doc\", \"open\", \"\")\n+click: (4, 240) // New Y position since all search elements are back on one line.\n+assert-false: (\".top-doc\", \"open\", \"\")\n+click: (4, 240)\n+assert: (\".top-doc\", \"open\", \"\")\n+// To ensure that the toggle isn't over the text, we check that the toggle isn't clicked.\n+click: (3, 240)\n+assert: (\".top-doc\", \"open\", \"\")"}]}