{"sha": "9a53d59b97951635e2b157a29f2dc3b61e8f393a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjlhNTNkNTliOTc5NTE2MzVlMmIxNTdhMjlmMmRjM2I2MWU4ZjM5M2E=", "commit": {"author": {"name": "12101111", "email": "w12101111@gmail.com", "date": "2021-08-28T06:40:17Z"}, "committer": {"name": "12101111", "email": "w12101111@gmail.com", "date": "2021-08-28T06:40:17Z"}, "message": "fix evaluation of target_feature = \"crt-static\"", "tree": {"sha": "7161112971ad6ad9476308db8eaa3a7f8c08c6c6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7161112971ad6ad9476308db8eaa3a7f8c08c6c6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9a53d59b97951635e2b157a29f2dc3b61e8f393a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEERq7VLWSlisBf3CZ8l3hfrfOKl9wFAmEp2lEACgkQl3hfrfOK\nl9wnAw//XzK+jo7gCxbLsOXMOZLFefAjOFaWAU+W6W/h3SzOlM2d+270XzUGjE4A\ncHDkxNk+7uCjHDiDoNmTDRS+89w2EQx4KeCNEG7jUn5plnC0o26IwpuyDcosIQxM\n4qUSog9j0e8NCvA4KXFpjAPugeGQin/IBvdPWolbMDjppyb946ss8nynNBgftUya\nfKItSspM4m+i0F8JEyo/WvI9+8PBD+cEYI80AaJ8uWw1DOCQkDi+yQb0QiWLdMUh\nMNmKLLEucWJMGqhZoxDqSl8shvMT7JRA7oIHpJTkUvVmmeuQxR/8jTxmEWHJbklC\nO/iRvr7ROmNP3f6z8NEd14hsrp0bg3DfMbMx5jUkyREUIv5VS/Us2VfipXKpYjUB\nj48hro4C9ZjxLc0D4uyPd8aBlaoLhULJd2WeLZqoDlopfuh0jZfTt7q9kRWjE+IL\nIIprsA/9x6xsDIIOghDuOV4VJiAFq1wu7QOn+brnBf3WqvNNfi/KzcHdOsQ/ay19\nEBp/fsLFQhXJJVEe758vROSgsJPDvqfWx/8ERRm6SP4GXMI6Ex4Brp7KyIUVD1Vm\n4vd/XTfyFCCBqfHzDUa5WTiPbJd/UDg2mhxAE6Cgo4Yah3H/Mz6uk9jD/u5DDdo2\nrvbKVvugemuyRFB3jgFKLhEji8FRi2IxHkrX1K8bJY56y211Pz4=\n=Vxu4\n-----END PGP SIGNATURE-----", "payload": "tree 7161112971ad6ad9476308db8eaa3a7f8c08c6c6\nparent 4c9896f279357896d31d811fddc2025d72259498\nauthor 12101111 <w12101111@gmail.com> 1630132817 +0800\ncommitter 12101111 <w12101111@gmail.com> 1630132817 +0800\n\nfix evaluation of target_feature = \"crt-static\"\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9a53d59b97951635e2b157a29f2dc3b61e8f393a", "html_url": "https://github.com/rust-lang/rust/commit/9a53d59b97951635e2b157a29f2dc3b61e8f393a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9a53d59b97951635e2b157a29f2dc3b61e8f393a/comments", "author": {"login": "12101111", "id": 8438475, "node_id": "MDQ6VXNlcjg0Mzg0NzU=", "avatar_url": "https://avatars.githubusercontent.com/u/8438475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/12101111", "html_url": "https://github.com/12101111", "followers_url": "https://api.github.com/users/12101111/followers", "following_url": "https://api.github.com/users/12101111/following{/other_user}", "gists_url": "https://api.github.com/users/12101111/gists{/gist_id}", "starred_url": "https://api.github.com/users/12101111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/12101111/subscriptions", "organizations_url": "https://api.github.com/users/12101111/orgs", "repos_url": "https://api.github.com/users/12101111/repos", "events_url": "https://api.github.com/users/12101111/events{/privacy}", "received_events_url": "https://api.github.com/users/12101111/received_events", "type": "User", "site_admin": false}, "committer": {"login": "12101111", "id": 8438475, "node_id": "MDQ6VXNlcjg0Mzg0NzU=", "avatar_url": "https://avatars.githubusercontent.com/u/8438475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/12101111", "html_url": "https://github.com/12101111", "followers_url": "https://api.github.com/users/12101111/followers", "following_url": "https://api.github.com/users/12101111/following{/other_user}", "gists_url": "https://api.github.com/users/12101111/gists{/gist_id}", "starred_url": "https://api.github.com/users/12101111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/12101111/subscriptions", "organizations_url": "https://api.github.com/users/12101111/orgs", "repos_url": "https://api.github.com/users/12101111/repos", "events_url": "https://api.github.com/users/12101111/events{/privacy}", "received_events_url": "https://api.github.com/users/12101111/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4c9896f279357896d31d811fddc2025d72259498", "url": "https://api.github.com/repos/rust-lang/rust/commits/4c9896f279357896d31d811fddc2025d72259498", "html_url": "https://github.com/rust-lang/rust/commit/4c9896f279357896d31d811fddc2025d72259498"}], "stats": {"total": 9, "additions": 8, "deletions": 1}, "files": [{"sha": "8c1a9dc80265e17e87eb0b3be1f707ce43592649", "filename": "src/test/ui/proc-macro/crt-static.rs", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/9a53d59b97951635e2b157a29f2dc3b61e8f393a/src%2Ftest%2Fui%2Fproc-macro%2Fcrt-static.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9a53d59b97951635e2b157a29f2dc3b61e8f393a/src%2Ftest%2Fui%2Fproc-macro%2Fcrt-static.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fcrt-static.rs?ref=9a53d59b97951635e2b157a29f2dc3b61e8f393a", "patch": "@@ -1,12 +1,19 @@\n // Test proc-macro crate can be built without additional RUSTFLAGS\n // on musl target\n // override -Ctarget-feature=-crt-static from compiletest\n-// compile-flags: -Ctarget-feature=\n+// compile-flags: --crate-type proc-macro -Ctarget-feature=\n // ignore-wasm32\n // ignore-sgx no support for proc-macro crate type\n // build-pass\n #![crate_type = \"proc-macro\"]\n \n+// FIXME: This don't work when crate-type is specified by attribute\n+// `#![crate_type = \"proc-macro\"]`, not by `--crate-type=proc-macro`\n+// command line flag. This is beacuse the list of `cfg` symbols is generated\n+// before attributes are parsed. See rustc_interface::util::add_configuration\n+#[cfg(target_feature = \"crt-static\")]\n+compile_error!(\"crt-static is enabled\");\n+\n extern crate proc_macro;\n \n use proc_macro::TokenStream;"}]}