{"sha": "38f5c97c3383fb8424fbde6ccdc1aaad4c28ae0f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM4ZjVjOTdjMzM4M2ZiODQyNGZiZGU2Y2NkYzFhYWFkNGMyOGFlMGY=", "commit": {"author": {"name": "Jethro Beekman", "email": "jethro@fortanix.com", "date": "2018-12-19T06:46:04Z"}, "committer": {"name": "Jethro Beekman", "email": "jethro@fortanix.com", "date": "2018-12-19T06:46:04Z"}, "message": "Revert \"Remove some dead code from `sgx`\"\n\nThis reverts commit 134661917bf4b086b027a2c58219d50ba57a1453.", "tree": {"sha": "f81c071d5d61d22baf89400ac4f785a4daa3428b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f81c071d5d61d22baf89400ac4f785a4daa3428b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/38f5c97c3383fb8424fbde6ccdc1aaad4c28ae0f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/38f5c97c3383fb8424fbde6ccdc1aaad4c28ae0f", "html_url": "https://github.com/rust-lang/rust/commit/38f5c97c3383fb8424fbde6ccdc1aaad4c28ae0f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/38f5c97c3383fb8424fbde6ccdc1aaad4c28ae0f/comments", "author": null, "committer": null, "parents": [{"sha": "4358be46c7f04a6cc12ae913c46a635bb1559779", "url": "https://api.github.com/repos/rust-lang/rust/commits/4358be46c7f04a6cc12ae913c46a635bb1559779", "html_url": "https://github.com/rust-lang/rust/commit/4358be46c7f04a6cc12ae913c46a635bb1559779"}], "stats": {"total": 15, "additions": 15, "deletions": 0}, "files": [{"sha": "508f2ff4d4fa5e4b9cb95308555111550cee95b1", "filename": "src/libstd/sys/sgx/abi/mem.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/38f5c97c3383fb8424fbde6ccdc1aaad4c28ae0f/src%2Flibstd%2Fsys%2Fsgx%2Fabi%2Fmem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/38f5c97c3383fb8424fbde6ccdc1aaad4c28ae0f/src%2Flibstd%2Fsys%2Fsgx%2Fabi%2Fmem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fsgx%2Fabi%2Fmem.rs?ref=38f5c97c3383fb8424fbde6ccdc1aaad4c28ae0f", "patch": "@@ -34,6 +34,13 @@ fn image_base() -> u64 {\n     base\n }\n \n+pub fn is_enclave_range(p: *const u8, len: usize) -> bool {\n+    let start=p as u64;\n+    let end=start + (len as u64);\n+    start >= image_base() &&\n+        end <= image_base() + (unsafe { ENCLAVE_SIZE } as u64) // unsafe ok: link-time constant\n+}\n+\n pub fn is_user_range(p: *const u8, len: usize) -> bool {\n     let start=p as u64;\n     let end=start + (len as u64);"}, {"sha": "2bc32c9fefbb73a933bbaf180be5be0f4d377883", "filename": "src/libstd/sys/sgx/abi/usercalls/mod.rs", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/38f5c97c3383fb8424fbde6ccdc1aaad4c28ae0f/src%2Flibstd%2Fsys%2Fsgx%2Fabi%2Fusercalls%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/38f5c97c3383fb8424fbde6ccdc1aaad4c28ae0f/src%2Flibstd%2Fsys%2Fsgx%2Fabi%2Fusercalls%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fsgx%2Fabi%2Fusercalls%2Fmod.rs?ref=38f5c97c3383fb8424fbde6ccdc1aaad4c28ae0f", "patch": "@@ -33,6 +33,14 @@ pub fn read(fd: Fd, buf: &mut [u8]) -> IoResult<usize> {\n     }\n }\n \n+pub fn read_alloc(fd: Fd) -> IoResult<Vec<u8>> {\n+    unsafe {\n+        let mut userbuf = alloc::User::<ByteBuffer>::uninitialized();\n+        raw::read_alloc(fd, userbuf.as_raw_mut_ptr()).from_sgx_result()?;\n+        Ok(copy_user_buffer(&userbuf))\n+    }\n+}\n+\n pub fn write(fd: Fd, buf: &[u8]) -> IoResult<usize> {\n     unsafe {\n         let userbuf = alloc::User::new_from_enclave(buf);"}]}