{"sha": "8e43414bce77cfe2030b875e365c77691897b95f", "node_id": "C_kwDOAAsO6NoAKDhlNDM0MTRiY2U3N2NmZTIwMzBiODc1ZTM2NWM3NzY5MTg5N2I5NWY", "commit": {"author": {"name": "mejrs", "email": "59372212+mejrs@users.noreply.github.com", "date": "2023-01-19T15:31:50Z"}, "committer": {"name": "mejrs", "email": "59372212+mejrs@users.noreply.github.com", "date": "2023-01-19T15:31:50Z"}, "message": "Fix proc macro tests", "tree": {"sha": "484f815a0d930e6dcbb3f845ae79ad546c1a248a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/484f815a0d930e6dcbb3f845ae79ad546c1a248a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8e43414bce77cfe2030b875e365c77691897b95f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8e43414bce77cfe2030b875e365c77691897b95f", "html_url": "https://github.com/rust-lang/rust/commit/8e43414bce77cfe2030b875e365c77691897b95f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8e43414bce77cfe2030b875e365c77691897b95f/comments", "author": {"login": "mejrs", "id": 59372212, "node_id": "MDQ6VXNlcjU5MzcyMjEy", "avatar_url": "https://avatars.githubusercontent.com/u/59372212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mejrs", "html_url": "https://github.com/mejrs", "followers_url": "https://api.github.com/users/mejrs/followers", "following_url": "https://api.github.com/users/mejrs/following{/other_user}", "gists_url": "https://api.github.com/users/mejrs/gists{/gist_id}", "starred_url": "https://api.github.com/users/mejrs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mejrs/subscriptions", "organizations_url": "https://api.github.com/users/mejrs/orgs", "repos_url": "https://api.github.com/users/mejrs/repos", "events_url": "https://api.github.com/users/mejrs/events{/privacy}", "received_events_url": "https://api.github.com/users/mejrs/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mejrs", "id": 59372212, "node_id": "MDQ6VXNlcjU5MzcyMjEy", "avatar_url": "https://avatars.githubusercontent.com/u/59372212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mejrs", "html_url": "https://github.com/mejrs", "followers_url": "https://api.github.com/users/mejrs/followers", "following_url": "https://api.github.com/users/mejrs/following{/other_user}", "gists_url": "https://api.github.com/users/mejrs/gists{/gist_id}", "starred_url": "https://api.github.com/users/mejrs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mejrs/subscriptions", "organizations_url": "https://api.github.com/users/mejrs/orgs", "repos_url": "https://api.github.com/users/mejrs/repos", "events_url": "https://api.github.com/users/mejrs/events{/privacy}", "received_events_url": "https://api.github.com/users/mejrs/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a8e3abd04cf85080d921c2d1875e0094b2db5155", "url": "https://api.github.com/repos/rust-lang/rust/commits/a8e3abd04cf85080d921c2d1875e0094b2db5155", "html_url": "https://github.com/rust-lang/rust/commit/a8e3abd04cf85080d921c2d1875e0094b2db5155"}], "stats": {"total": 52, "additions": 33, "deletions": 19}, "files": [{"sha": "8685087611248be845055ef7b14b00f6cd4fdea6", "filename": "tests/ui/proc-macro/allowed-signatures.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fallowed-signatures.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fallowed-signatures.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fproc-macro%2Fallowed-signatures.rs?ref=8e43414bce77cfe2030b875e365c77691897b95f", "patch": "@@ -1,4 +1,6 @@\n // check-pass\n+// force-host\n+// no-prefer-dynamic\n \n #![crate_type = \"proc-macro\"]\n #![allow(private_in_public)]"}, {"sha": "873660a5b3ab989c5f3bd42b838df81a52f9193a", "filename": "tests/ui/proc-macro/proc-macro-abi.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fproc-macro-abi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fproc-macro-abi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fproc-macro%2Fproc-macro-abi.rs?ref=8e43414bce77cfe2030b875e365c77691897b95f", "patch": "@@ -1,3 +1,6 @@\n+// force-host\n+// no-prefer-dynamic\n+\n #![crate_type = \"proc-macro\"]\n #![allow(warnings)]\n "}, {"sha": "9a781be0996dde492ddaf7da02decfeb9f78b33f", "filename": "tests/ui/proc-macro/proc-macro-abi.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fproc-macro-abi.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fproc-macro-abi.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fproc-macro%2Fproc-macro-abi.stderr?ref=8e43414bce77cfe2030b875e365c77691897b95f", "patch": "@@ -1,17 +1,17 @@\n error: proc macro functions may not be `extern \"C\"`\n-  --> $DIR/proc-macro-abi.rs:8:1\n+  --> $DIR/proc-macro-abi.rs:11:1\n    |\n LL | pub extern \"C\" fn abi(a: TokenStream) -> TokenStream {\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: proc macro functions may not be `extern \"system\"`\n-  --> $DIR/proc-macro-abi.rs:14:1\n+  --> $DIR/proc-macro-abi.rs:17:1\n    |\n LL | pub extern \"system\" fn abi2(a: TokenStream) -> TokenStream {\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: proc macro functions may not be `extern \"C\"`\n-  --> $DIR/proc-macro-abi.rs:20:1\n+  --> $DIR/proc-macro-abi.rs:23:1\n    |\n LL | pub extern fn abi3(a: TokenStream) -> TokenStream {\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"}, {"sha": "51abc8e7d3edb0f1378f70cb19f9b746aa14ad83", "filename": "tests/ui/proc-macro/signature-proc-macro-attribute.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro-attribute.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro-attribute.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro-attribute.rs?ref=8e43414bce77cfe2030b875e365c77691897b95f", "patch": "@@ -1,3 +1,6 @@\n+// force-host\n+// no-prefer-dynamic\n+\n #![crate_type = \"proc-macro\"]\n \n extern crate proc_macro;"}, {"sha": "abf7a6f3ce9229d9bfeabc419852d035c6ee64da", "filename": "tests/ui/proc-macro/signature-proc-macro-attribute.stderr", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro-attribute.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro-attribute.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro-attribute.stderr?ref=8e43414bce77cfe2030b875e365c77691897b95f", "patch": "@@ -1,39 +1,39 @@\n error: mismatched attribute proc macro signature\n-  --> $DIR/signature-proc-macro-attribute.rs:7:1\n+  --> $DIR/signature-proc-macro-attribute.rs:10:1\n    |\n LL | pub fn bad_input(input: String) -> TokenStream {\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ attribute proc macro must have two arguments of type `proc_macro::TokenStream`\n \n error: mismatched attribute proc macro signature\n-  --> $DIR/signature-proc-macro-attribute.rs:13:42\n+  --> $DIR/signature-proc-macro-attribute.rs:16:42\n    |\n LL | pub fn bad_output(input: TokenStream) -> String {\n    |                                          ^^^^^^ found std::string::String, expected type `proc_macro::TokenStream`\n    |\n    = note: attribute proc macros must have a signature of `fn(TokenStream, TokenStream) -> TokenStream`\n \n error: mismatched attribute proc macro signature\n-  --> $DIR/signature-proc-macro-attribute.rs:13:1\n+  --> $DIR/signature-proc-macro-attribute.rs:16:1\n    |\n LL | pub fn bad_output(input: TokenStream) -> String {\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ attribute proc macro must have two arguments of type `proc_macro::TokenStream`\n \n error: mismatched attribute proc macro signature\n-  --> $DIR/signature-proc-macro-attribute.rs:20:41\n+  --> $DIR/signature-proc-macro-attribute.rs:23:41\n    |\n LL | pub fn bad_everything(input: String) -> String {\n    |                                         ^^^^^^ found std::string::String, expected type `proc_macro::TokenStream`\n    |\n    = note: attribute proc macros must have a signature of `fn(TokenStream, TokenStream) -> TokenStream`\n \n error: mismatched attribute proc macro signature\n-  --> $DIR/signature-proc-macro-attribute.rs:20:1\n+  --> $DIR/signature-proc-macro-attribute.rs:23:1\n    |\n LL | pub fn bad_everything(input: String) -> String {\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ attribute proc macro must have two arguments of type `proc_macro::TokenStream`\n \n error: mismatched attribute proc macro signature\n-  --> $DIR/signature-proc-macro-attribute.rs:27:49\n+  --> $DIR/signature-proc-macro-attribute.rs:30:49\n    |\n LL | pub fn too_many(a: TokenStream, b: TokenStream, c: String) -> TokenStream {\n    |                                                 ^^^^^^^^^ found unexpected argument"}, {"sha": "f2fd824b675b68741653c8a0bb4c7c67a340f2a3", "filename": "tests/ui/proc-macro/signature-proc-macro-derive.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro-derive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro-derive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro-derive.rs?ref=8e43414bce77cfe2030b875e365c77691897b95f", "patch": "@@ -1,3 +1,6 @@\n+// force-host\n+// no-prefer-dynamic\n+\n #![crate_type = \"proc-macro\"]\n \n extern crate proc_macro;"}, {"sha": "a358ae277037f106bbdd95c979444b477df9f834", "filename": "tests/ui/proc-macro/signature-proc-macro-derive.stderr", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro-derive.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro-derive.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro-derive.stderr?ref=8e43414bce77cfe2030b875e365c77691897b95f", "patch": "@@ -1,37 +1,37 @@\n error: mismatched derive proc macro signature\n-  --> $DIR/signature-proc-macro-derive.rs:7:25\n+  --> $DIR/signature-proc-macro-derive.rs:10:25\n    |\n LL | pub fn bad_input(input: String) -> TokenStream {\n    |                         ^^^^^^ found std::string::String, expected type `proc_macro::TokenStream`\n    |\n    = note: derive proc macros must have a signature of `fn(TokenStream) -> TokenStream`\n \n error: mismatched derive proc macro signature\n-  --> $DIR/signature-proc-macro-derive.rs:13:42\n+  --> $DIR/signature-proc-macro-derive.rs:16:42\n    |\n LL | pub fn bad_output(input: TokenStream) -> String {\n    |                                          ^^^^^^ found std::string::String, expected type `proc_macro::TokenStream`\n    |\n    = note: derive proc macros must have a signature of `fn(TokenStream) -> TokenStream`\n \n error: mismatched derive proc macro signature\n-  --> $DIR/signature-proc-macro-derive.rs:19:41\n+  --> $DIR/signature-proc-macro-derive.rs:22:41\n    |\n LL | pub fn bad_everything(input: String) -> String {\n    |                                         ^^^^^^ found std::string::String, expected type `proc_macro::TokenStream`\n    |\n    = note: derive proc macros must have a signature of `fn(TokenStream) -> TokenStream`\n \n error: mismatched derive proc macro signature\n-  --> $DIR/signature-proc-macro-derive.rs:19:30\n+  --> $DIR/signature-proc-macro-derive.rs:22:30\n    |\n LL | pub fn bad_everything(input: String) -> String {\n    |                              ^^^^^^ found std::string::String, expected type `proc_macro::TokenStream`\n    |\n    = note: derive proc macros must have a signature of `fn(TokenStream) -> TokenStream`\n \n error: mismatched derive proc macro signature\n-  --> $DIR/signature-proc-macro-derive.rs:26:33\n+  --> $DIR/signature-proc-macro-derive.rs:29:33\n    |\n LL | pub fn too_many(a: TokenStream, b: TokenStream, c: String) -> TokenStream {\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^ found unexpected arguments"}, {"sha": "54770aacd1a980728cf77e096b85742872017cb7", "filename": "tests/ui/proc-macro/signature-proc-macro.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro.rs?ref=8e43414bce77cfe2030b875e365c77691897b95f", "patch": "@@ -1,3 +1,6 @@\n+// force-host\n+// no-prefer-dynamic\n+\n #![crate_type = \"proc-macro\"]\n \n extern crate proc_macro;"}, {"sha": "4b14a54e6750318fc13b57274188f574e1af5a08", "filename": "tests/ui/proc-macro/signature-proc-macro.stderr", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/8e43414bce77cfe2030b875e365c77691897b95f/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fproc-macro%2Fsignature-proc-macro.stderr?ref=8e43414bce77cfe2030b875e365c77691897b95f", "patch": "@@ -1,37 +1,37 @@\n error: mismatched function-like proc macro signature\n-  --> $DIR/signature-proc-macro.rs:7:25\n+  --> $DIR/signature-proc-macro.rs:10:25\n    |\n LL | pub fn bad_input(input: String) -> TokenStream {\n    |                         ^^^^^^ found std::string::String, expected type `proc_macro::TokenStream`\n    |\n    = note: function-like proc macros must have a signature of `fn(TokenStream) -> TokenStream`\n \n error: mismatched function-like proc macro signature\n-  --> $DIR/signature-proc-macro.rs:13:42\n+  --> $DIR/signature-proc-macro.rs:16:42\n    |\n LL | pub fn bad_output(input: TokenStream) -> String {\n    |                                          ^^^^^^ found std::string::String, expected type `proc_macro::TokenStream`\n    |\n    = note: function-like proc macros must have a signature of `fn(TokenStream) -> TokenStream`\n \n error: mismatched function-like proc macro signature\n-  --> $DIR/signature-proc-macro.rs:19:41\n+  --> $DIR/signature-proc-macro.rs:22:41\n    |\n LL | pub fn bad_everything(input: String) -> String {\n    |                                         ^^^^^^ found std::string::String, expected type `proc_macro::TokenStream`\n    |\n    = note: function-like proc macros must have a signature of `fn(TokenStream) -> TokenStream`\n \n error: mismatched function-like proc macro signature\n-  --> $DIR/signature-proc-macro.rs:19:30\n+  --> $DIR/signature-proc-macro.rs:22:30\n    |\n LL | pub fn bad_everything(input: String) -> String {\n    |                              ^^^^^^ found std::string::String, expected type `proc_macro::TokenStream`\n    |\n    = note: function-like proc macros must have a signature of `fn(TokenStream) -> TokenStream`\n \n error: mismatched function-like proc macro signature\n-  --> $DIR/signature-proc-macro.rs:26:33\n+  --> $DIR/signature-proc-macro.rs:29:33\n    |\n LL | pub fn too_many(a: TokenStream, b: TokenStream, c: String) -> TokenStream {\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^ found unexpected arguments"}]}