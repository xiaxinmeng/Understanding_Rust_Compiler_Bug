{"sha": "f7f253ea47f8782f7f09e76bdde5a03c60fab318", "node_id": "C_kwDOAAsO6NoAKGY3ZjI1M2VhNDdmODc4MmY3ZjA5ZTc2YmRkZTVhMDNjNjBmYWIzMTg", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-09-30T17:06:05Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-09-30T17:06:05Z"}, "message": "Rollup merge of #102421 - lyming2007:issue-101866, r=lcnr\n\nremove the unused :: between trait and type to give user correct diag\u2026\n\n\u2026nostic information\n\n\tmodified:   compiler/rustc_trait_selection/src/traits/error_reporting/mod.rs\n\tnew file:   src/test/ui/type/issue-101866.rs\n\tnew file:   src/test/ui/type/issue-101866.stderr", "tree": {"sha": "a3e053693e5e6470291d0e55f81ca8d1b0a358d7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a3e053693e5e6470291d0e55f81ca8d1b0a358d7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f7f253ea47f8782f7f09e76bdde5a03c60fab318", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjNyH9CRBK7hj4Ov3rIwAALOUIADA7ywJnrgAkAiA5CHTeeBcw\n2FcwL5sNNJ4MJewbP3FLUxvjZvp9YpBrj7RHA03FTvfRM64gp3/IvwhXBjti0AoP\neIpyj65A33GQewmyPdlz7HD2BgfsIYEIr4WptyknSnQHhl+UTF6MJ8DBoVvoptaI\nSjNZHnYzRuxT4LgMDkMUXW76i3ARKl9/6+peajJnm//qTJq/Fuf8oHRwDGPPPZ+h\ncoPAHfhvKjA2T3SJ6kzYkJZWz4ru6Wb6Ob+xhp2MPoqekJ5FzK0MhHiHAtx3kT+J\nl0o1yXWS6E1/MuT73tHoI+SGnReC132f9Yd1NNeoKObo5qjv999YtMxkW9D0GBA=\n=4xHW\n-----END PGP SIGNATURE-----\n", "payload": "tree a3e053693e5e6470291d0e55f81ca8d1b0a358d7\nparent e2bc6b8172dd122b31019fc0b0de179ae5215f31\nparent 523a76a2ebd5c1763665e2d51fa65f8304fc46af\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1664557565 +0200\ncommitter GitHub <noreply@github.com> 1664557565 +0200\n\nRollup merge of #102421 - lyming2007:issue-101866, r=lcnr\n\nremove the unused :: between trait and type to give user correct diag\u2026\n\n\u2026nostic information\n\n\tmodified:   compiler/rustc_trait_selection/src/traits/error_reporting/mod.rs\n\tnew file:   src/test/ui/type/issue-101866.rs\n\tnew file:   src/test/ui/type/issue-101866.stderr\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f7f253ea47f8782f7f09e76bdde5a03c60fab318", "html_url": "https://github.com/rust-lang/rust/commit/f7f253ea47f8782f7f09e76bdde5a03c60fab318", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f7f253ea47f8782f7f09e76bdde5a03c60fab318/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e2bc6b8172dd122b31019fc0b0de179ae5215f31", "url": "https://api.github.com/repos/rust-lang/rust/commits/e2bc6b8172dd122b31019fc0b0de179ae5215f31", "html_url": "https://github.com/rust-lang/rust/commit/e2bc6b8172dd122b31019fc0b0de179ae5215f31"}, {"sha": "523a76a2ebd5c1763665e2d51fa65f8304fc46af", "url": "https://api.github.com/repos/rust-lang/rust/commits/523a76a2ebd5c1763665e2d51fa65f8304fc46af", "html_url": "https://github.com/rust-lang/rust/commit/523a76a2ebd5c1763665e2d51fa65f8304fc46af"}], "stats": {"total": 52, "additions": 47, "deletions": 5}, "files": [{"sha": "5fdadd0b4b41bce2fa84ab56e6f5eacddfdaa850", "filename": "compiler/rustc_trait_selection/src/traits/error_reporting/mod.rs", "status": "modified", "additions": 14, "deletions": 5, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/f7f253ea47f8782f7f09e76bdde5a03c60fab318/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ferror_reporting%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7f253ea47f8782f7f09e76bdde5a03c60fab318/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ferror_reporting%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ferror_reporting%2Fmod.rs?ref=f7f253ea47f8782f7f09e76bdde5a03c60fab318", "patch": "@@ -2263,13 +2263,22 @@ impl<'a, 'tcx> InferCtxtPrivExt<'a, 'tcx> for InferCtxt<'a, 'tcx> {\n                                     trait_impls.non_blanket_impls().len()\n                                 )\n                             };\n-\n+                            let mut suggestions = vec![(\n+                                trait_path_segment.ident.span.shrink_to_lo(),\n+                                format!(\"<{} as \", self.tcx.def_path(impl_def_id).to_string_no_crate_verbose())\n+                            )];\n+                            if let Some(generic_arg) = trait_path_segment.args {\n+                                let between_span = trait_path_segment.ident.span.between(generic_arg.span_ext);\n+                                // get rid of :: between Trait and <type>\n+                                // must be '::' between them, otherwise the parser won't accept the code\n+                                suggestions.push((between_span, \"\".to_string(),));\n+                                suggestions.push((generic_arg.span_ext.shrink_to_hi(), format!(\">\")));\n+                            } else {\n+                                suggestions.push((trait_path_segment.ident.span.shrink_to_hi(), format!(\">\")));\n+                            }\n                             err.multipart_suggestion(\n                                 message,\n-                                vec![\n-                                    (trait_path_segment.ident.span.shrink_to_lo(), format!(\"<{} as \", self.tcx.def_path(impl_def_id).to_string_no_crate_verbose())),\n-                                    (trait_path_segment.ident.span.shrink_to_hi(), format!(\">\"))\n-                                ],\n+                                suggestions,\n                                 Applicability::MaybeIncorrect\n                             );\n                         }"}, {"sha": "d332c4adb00609d6c3b63de1ba0328ef1f8fd434", "filename": "src/test/ui/type/issue-101866.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/f7f253ea47f8782f7f09e76bdde5a03c60fab318/src%2Ftest%2Fui%2Ftype%2Fissue-101866.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7f253ea47f8782f7f09e76bdde5a03c60fab318/src%2Ftest%2Fui%2Ftype%2Fissue-101866.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype%2Fissue-101866.rs?ref=f7f253ea47f8782f7f09e76bdde5a03c60fab318", "patch": "@@ -0,0 +1,15 @@\n+trait TraitA<T> {\n+    fn func();\n+}\n+\n+struct StructA {}\n+\n+impl TraitA<i32> for StructA {\n+    fn func() {}\n+}\n+\n+fn main() {\n+    TraitA::<i32>::func();\n+    //~^ ERROR: cannot call associated function on trait without specifying the corresponding `impl` type [E0790]\n+    //~| help: use the fully-qualified path to the only available implementation\n+}"}, {"sha": "788e54b93819082f1829ee5019dc3ee5ef2b3f30", "filename": "src/test/ui/type/issue-101866.stderr", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/f7f253ea47f8782f7f09e76bdde5a03c60fab318/src%2Ftest%2Fui%2Ftype%2Fissue-101866.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/f7f253ea47f8782f7f09e76bdde5a03c60fab318/src%2Ftest%2Fui%2Ftype%2Fissue-101866.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype%2Fissue-101866.stderr?ref=f7f253ea47f8782f7f09e76bdde5a03c60fab318", "patch": "@@ -0,0 +1,18 @@\n+error[E0790]: cannot call associated function on trait without specifying the corresponding `impl` type\n+  --> $DIR/issue-101866.rs:12:5\n+   |\n+LL |     fn func();\n+   |     ---------- `TraitA::func` defined here\n+...\n+LL |     TraitA::<i32>::func();\n+   |     ^^^^^^^^^^^^^^^^^^^ cannot call associated function of trait\n+   |\n+help: use the fully-qualified path to the only available implementation\n+   |\n+LL -     TraitA::<i32>::func();\n+LL +     <::StructA as TraitA<i32>>::func();\n+   |\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0790`."}]}