{"sha": "c65663a78141d0baa5d5b0905f15acee1193a215", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM2NTY2M2E3ODE0MWQwYmFhNWQ1YjA5MDVmMTVhY2VlMTE5M2EyMTU=", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2021-05-11T00:28:04Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-05-11T00:28:04Z"}, "message": "Rollup merge of #84998 - Aaron1011:pretty-unstable-fingerprint, r=Mark-Simulacrum\n\nShow nicer error when an 'unstable fingerprints' error occurs\n\nAn example of the error produced by this PR:\n\n```\nerror: internal compiler error: encountered incremental compilation error with evaluate_obligation(9f2ad55260c30262-c36667639674ad83)\n  |\n  = help: This is a known issue with the compiler. Run `cargo clean -p syn` or `cargo clean` to allow your project to compile\n  = note: Please follow the instructions below to create a bug report with the provided information\n\nthread 'rustc' panicked at 'Found unstable fingerprints for evaluate_obligation(9f2ad55260c30262-c36667639674ad83): Ok(EvaluatedToOk)', /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:595:9\nstack backtrace:\n   0: rust_begin_unwind\n             at /home/aaron/repos/rust/library/std/src/panicking.rs:493:5\n   1: std::panicking::begin_panic_fmt\n             at /home/aaron/repos/rust/library/std/src/panicking.rs:435:5\n   2: rustc_query_system::query::plumbing::incremental_verify_ich\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:595:9\n   3: rustc_query_system::query::plumbing::load_from_disk_and_cache_in_memory\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:557:9\n   4: rustc_query_system::query::plumbing::try_execute_query::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:473:21\n   5: core::option::Option<T>::map\n             at /home/aaron/repos/rust/library/core/src/option.rs:487:29\n   6: rustc_query_system::query::plumbing::try_execute_query::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:471:13\n   7: stacker::maybe_grow\n             at /home/aaron/.cargo/registry/src/github.com-1ecc6299db9ec823/stacker-0.1.12/src/lib.rs:55:9\n   8: rustc_data_structures::stack::ensure_sufficient_stack\n             at /home/aaron/repos/rust/compiler/rustc_data_structures/src/stack.rs:16:5\n   9: <rustc_query_impl::plumbing::QueryCtxt as rustc_query_system::query::QueryContext>::start_query::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_impl/src/plumbing.rs:169:17\n  10: rustc_middle::ty::context::tls::enter_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:50\n  11: rustc_middle::ty::context::tls::set_tlv\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1720:9\n  12: rustc_middle::ty::context::tls::enter_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:9\n  13: <rustc_query_impl::plumbing::QueryCtxt as rustc_query_system::query::QueryContext>::start_query::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_impl/src/plumbing.rs:168:13\n  14: rustc_middle::ty::context::tls::with_related_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1780:13\n  15: rustc_middle::ty::context::tls::with_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:40\n  16: rustc_middle::ty::context::tls::with_context_opt\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1753:22\n  17: rustc_middle::ty::context::tls::with_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:9\n  18: rustc_middle::ty::context::tls::with_related_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1777:9\n  19: <rustc_query_impl::plumbing::QueryCtxt as rustc_query_system::query::QueryContext>::start_query\n             at /home/aaron/repos/rust/compiler/rustc_query_impl/src/plumbing.rs:157:9\n  20: rustc_query_system::query::plumbing::try_execute_query\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:469:22\n  21: rustc_query_system::query::plumbing::get_query_impl\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:674:5\n  22: rustc_query_system::query::plumbing::get_query\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:785:9\n  23: <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::evaluate_obligation\n             at /home/aaron/repos/rust/compiler/rustc_query_impl/src/plumbing.rs:603:17\n  24: rustc_middle::ty::query::TyCtxtAt::evaluate_obligation\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/query/mod.rs:204:17\n  25: rustc_middle::ty::query::<impl rustc_middle::ty::context::TyCtxt>::evaluate_obligation\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/query/mod.rs:185:17\n  26: <rustc_infer::infer::InferCtxt as rustc_trait_selection::traits::query::evaluate_obligation::InferCtxtExt>::evaluate_obligation\n             at /home/aaron/repos/rust/compiler/rustc_trait_selection/src/traits/query/evaluate_obligation.rs:72:9\n  27: <rustc_infer::infer::InferCtxt as rustc_trait_selection::traits::query::evaluate_obligation::InferCtxtExt>::evaluate_obligation_no_overflow\n             at /home/aaron/repos/rust/compiler/rustc_trait_selection/src/traits/query/evaluate_obligation.rs:82:15\n  28: <rustc_infer::infer::InferCtxt as rustc_trait_selection::traits::query::evaluate_obligation::InferCtxtExt>::predicate_must_hold_modulo_regions\n             at /home/aaron/repos/rust/compiler/rustc_trait_selection/src/traits/query/evaluate_obligation.rs:58:9\n  29: rustc_trait_selection::traits::type_known_to_meet_bound_modulo_regions\n             at /home/aaron/repos/rust/compiler/rustc_trait_selection/src/traits/mod.rs:146:18\n  30: rustc_ty_utils::common_traits::is_item_raw::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_ty_utils/src/common_traits.rs:33:9\n  31: rustc_infer::infer::InferCtxtBuilder::enter\n             at /home/aaron/repos/rust/compiler/rustc_infer/src/infer/mod.rs:582:9\n  32: rustc_ty_utils::common_traits::is_item_raw\n             at /home/aaron/repos/rust/compiler/rustc_ty_utils/src/common_traits.rs:32:5\n  33: rustc_query_system::query::config::QueryVtable<CTX,K,V>::compute\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/config.rs:44:9\n  34: rustc_query_system::query::plumbing::load_from_disk_and_cache_in_memory::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:544:67\n  35: rustc_middle::dep_graph::<impl rustc_query_system::dep_graph::DepKind for rustc_middle::dep_graph::dep_node::DepKind>::with_deps::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/dep_graph/mod.rs:77:46\n  36: rustc_middle::ty::context::tls::enter_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:50\n  37: rustc_middle::ty::context::tls::set_tlv\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1720:9\n  38: rustc_middle::ty::context::tls::enter_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:9\n  39: rustc_middle::dep_graph::<impl rustc_query_system::dep_graph::DepKind for rustc_middle::dep_graph::dep_node::DepKind>::with_deps::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/dep_graph/mod.rs:77:13\n  40: rustc_middle::ty::context::tls::with_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:40\n  41: rustc_middle::ty::context::tls::with_context_opt\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1753:22\n  42: rustc_middle::ty::context::tls::with_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:9\n  43: rustc_middle::dep_graph::<impl rustc_query_system::dep_graph::DepKind for rustc_middle::dep_graph::dep_node::DepKind>::with_deps\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/dep_graph/mod.rs:74:9\n  44: rustc_query_system::dep_graph::graph::DepGraph<K>::with_ignore\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/dep_graph/graph.rs:167:9\n  45: rustc_query_system::query::plumbing::load_from_disk_and_cache_in_memory\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:544:22\n  46: rustc_query_system::query::plumbing::try_execute_query::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:473:21\n  47: core::option::Option<T>::map\n             at /home/aaron/repos/rust/library/core/src/option.rs:487:29\n  48: rustc_query_system::query::plumbing::try_execute_query::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:471:13\n  49: stacker::maybe_grow\n             at /home/aaron/.cargo/registry/src/github.com-1ecc6299db9ec823/stacker-0.1.12/src/lib.rs:55:9\n  50: rustc_data_structures::stack::ensure_sufficient_stack\n             at /home/aaron/repos/rust/compiler/rustc_data_structures/src/stack.rs:16:5\n  51: <rustc_query_impl::plumbing::QueryCtxt as rustc_query_system::query::QueryContext>::start_query::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_impl/src/plumbing.rs:169:17\n  52: rustc_middle::ty::context::tls::enter_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:50\n  53: rustc_middle::ty::context::tls::set_tlv\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1720:9\n  54: rustc_middle::ty::context::tls::enter_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:9\n  55: <rustc_query_impl::plumbing::QueryCtxt as rustc_query_system::query::QueryContext>::start_query::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_impl/src/plumbing.rs:168:13\n  56: rustc_middle::ty::context::tls::with_related_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1780:13\n  57: rustc_middle::ty::context::tls::with_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:40\n  58: rustc_middle::ty::context::tls::with_context_opt\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1753:22\n  59: rustc_middle::ty::context::tls::with_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:9\n  60: rustc_middle::ty::context::tls::with_related_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1777:9\n  61: <rustc_query_impl::plumbing::QueryCtxt as rustc_query_system::query::QueryContext>::start_query\n             at /home/aaron/repos/rust/compiler/rustc_query_impl/src/plumbing.rs:157:9\n  62: rustc_query_system::query::plumbing::try_execute_query\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:469:22\n  63: rustc_query_system::query::plumbing::get_query_impl\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:674:5\n  64: rustc_query_system::query::plumbing::get_query\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:785:9\n  65: rustc_middle::ty::query::TyCtxtAt::is_unpin_raw\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/query/mod.rs:204:17\n  66: rustc_middle::ty::util::<impl rustc_middle::ty::TyS>::is_unpin\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/util.rs:727:38\n  67: rustc_middle::ty::layout::<impl rustc_target::abi::TyAndLayoutMethods<C> for &rustc_middle::ty::TyS>::pointee_info_at\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/layout.rs:2341:32\n  68: rustc_target::abi::TyAndLayout<Ty>::pointee_info_at\n             at /home/aaron/repos/rust/compiler/rustc_target/src/abi/mod.rs:1164:9\n  69: <rustc_target::abi::call::FnAbi<&rustc_middle::ty::TyS> as rustc_middle::ty::layout::FnAbiExt<C>>::new_internal::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/layout.rs:2781:36\n  70: <rustc_target::abi::call::FnAbi<&rustc_middle::ty::TyS> as rustc_middle::ty::layout::FnAbiExt<C>>::new_internal::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/layout.rs:2840:17\n  71: rustc_target::abi::call::ArgAbi<Ty>::new\n             at /home/aaron/repos/rust/compiler/rustc_target/src/abi/call/mod.rs:457:53\n  72: <rustc_target::abi::call::FnAbi<&rustc_middle::ty::TyS> as rustc_middle::ty::layout::FnAbiExt<C>>::new_internal::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/layout.rs:2838:27\n  73: <rustc_target::abi::call::FnAbi<&rustc_middle::ty::TyS> as rustc_middle::ty::layout::FnAbiExt<C>>::new_internal::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/layout.rs:2870:32\n  74: core::iter::adapters::map::map_fold::{{closure}}\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/map.rs:82:28\n  75: <core::iter::adapters::enumerate::Enumerate<I> as core::iter::traits::iterator::Iterator>::fold::enumerate::{{closure}}\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/enumerate.rs:104:27\n  76: core::ops::function::impls::<impl core::ops::function::FnMut<A> for &mut F>::call_mut\n             at /home/aaron/repos/rust/library/core/src/ops/function.rs:269:13\n  77: core::ops::function::impls::<impl core::ops::function::FnMut<A> for &mut F>::call_mut\n             at /home/aaron/repos/rust/library/core/src/ops/function.rs:269:13\n  78: core::iter::adapters::map::map_fold::{{closure}}\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/map.rs:82:21\n  79: core::iter::traits::iterator::Iterator::fold\n             at /home/aaron/repos/rust/library/core/src/iter/traits/iterator.rs:2146:21\n  80: <core::iter::adapters::map::Map<I,F> as core::iter::traits::iterator::Iterator>::fold\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/map.rs:122:9\n  81: <core::iter::adapters::cloned::Cloned<I> as core::iter::traits::iterator::Iterator>::fold\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/cloned.rs:58:9\n  82: <core::iter::adapters::chain::Chain<A,B> as core::iter::traits::iterator::Iterator>::fold\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/chain.rs:119:19\n  83: <core::iter::adapters::chain::Chain<A,B> as core::iter::traits::iterator::Iterator>::fold\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/chain.rs:119:19\n  84: <core::iter::adapters::enumerate::Enumerate<I> as core::iter::traits::iterator::Iterator>::fold\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/enumerate.rs:110:9\n  85: <core::iter::adapters::map::Map<I,F> as core::iter::traits::iterator::Iterator>::fold\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/map.rs:122:9\n  86: core::iter::traits::iterator::Iterator::for_each\n             at /home/aaron/repos/rust/library/core/src/iter/traits/iterator.rs:776:9\n  87: <alloc::vec::Vec<T,A> as alloc::vec::spec_extend::SpecExtend<T,I>>::spec_extend\n             at /home/aaron/repos/rust/library/alloc/src/vec/spec_extend.rs:40:17\n  88: <alloc::vec::Vec<T> as alloc::vec::spec_from_iter_nested::SpecFromIterNested<T,I>>::from_iter\n             at /home/aaron/repos/rust/library/alloc/src/vec/spec_from_iter_nested.rs:56:9\n  89: <alloc::vec::Vec<T> as alloc::vec::spec_from_iter::SpecFromIter<T,I>>::from_iter\n             at /home/aaron/repos/rust/library/alloc/src/vec/spec_from_iter.rs:36:9\n  90: <alloc::vec::Vec<T> as core::iter::traits::collect::FromIterator<T>>::from_iter\n             at /home/aaron/repos/rust/library/alloc/src/vec/mod.rs:2448:9\n  91: core::iter::traits::iterator::Iterator::collect\n             at /home/aaron/repos/rust/library/core/src/iter/traits/iterator.rs:1788:9\n  92: <rustc_target::abi::call::FnAbi<&rustc_middle::ty::TyS> as rustc_middle::ty::layout::FnAbiExt<C>>::new_internal\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/layout.rs:2864:19\n  93: <rustc_target::abi::call::FnAbi<&rustc_middle::ty::TyS> as rustc_middle::ty::layout::FnAbiExt<C>>::of_instance\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/layout.rs:2670:9\n  94: rustc_codegen_llvm::mono_item::<impl rustc_codegen_ssa::traits::declare::PreDefineMethods for rustc_codegen_llvm::context::CodegenCx>::predefine_fn\n             at /home/aaron/repos/rust/compiler/rustc_codegen_llvm/src/mono_item.rs:57:22\n  95: <rustc_middle::mir::mono::MonoItem as rustc_codegen_ssa::mono_item::MonoItemExt>::predefine\n             at /home/aaron/repos/rust/compiler/rustc_codegen_ssa/src/mono_item.rs:76:17\n  96: rustc_codegen_llvm::base::compile_codegen_unit::module_codegen\n             at /home/aaron/repos/rust/compiler/rustc_codegen_llvm/src/base.rs:122:17\n  97: rustc_query_system::dep_graph::graph::DepGraph<K>::with_task_impl::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/dep_graph/graph.rs:235:62\n  98: rustc_middle::dep_graph::<impl rustc_query_system::dep_graph::DepKind for rustc_middle::dep_graph::dep_node::DepKind>::with_deps::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/dep_graph/mod.rs:77:46\n  99: rustc_middle::ty::context::tls::enter_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:50\n 100: rustc_middle::ty::context::tls::set_tlv\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1720:9\n 101: rustc_middle::ty::context::tls::enter_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:9\n 102: rustc_middle::dep_graph::<impl rustc_query_system::dep_graph::DepKind for rustc_middle::dep_graph::dep_node::DepKind>::with_deps::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/dep_graph/mod.rs:77:13\n 103: rustc_middle::ty::context::tls::with_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:40\n 104: rustc_middle::ty::context::tls::with_context_opt\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1753:22\n 105: rustc_middle::ty::context::tls::with_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:9\n 106: rustc_middle::dep_graph::<impl rustc_query_system::dep_graph::DepKind for rustc_middle::dep_graph::dep_node::DepKind>::with_deps\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/dep_graph/mod.rs:74:9\n 107: rustc_query_system::dep_graph::graph::DepGraph<K>::with_task_impl\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/dep_graph/graph.rs:235:26\n 108: rustc_query_system::dep_graph::graph::DepGraph<K>::with_task\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/dep_graph/graph.rs:205:9\n 109: rustc_codegen_llvm::base::compile_codegen_unit\n             at /home/aaron/repos/rust/compiler/rustc_codegen_llvm/src/base.rs:103:9\n 110: <rustc_codegen_llvm::LlvmCodegenBackend as rustc_codegen_ssa::traits::backend::ExtraBackendMethods>::compile_codegen_unit\n             at /home/aaron/repos/rust/compiler/rustc_codegen_llvm/src/lib.rs:109:9\n 111: rustc_codegen_ssa::base::codegen_crate\n             at /home/aaron/repos/rust/compiler/rustc_codegen_ssa/src/base.rs:655:38\n 112: <rustc_codegen_llvm::LlvmCodegenBackend as rustc_codegen_ssa::traits::backend::CodegenBackend>::codegen_crate\n             at /home/aaron/repos/rust/compiler/rustc_codegen_llvm/src/lib.rs:270:18\n 113: rustc_interface::passes::start_codegen::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/passes.rs:1021:9\n 114: rustc_data_structures::profiling::VerboseTimingGuard::run\n             at /home/aaron/repos/rust/compiler/rustc_data_structures/src/profiling.rs:573:9\n 115: rustc_session::utils::<impl rustc_session::session::Session>::time\n             at /home/aaron/repos/rust/compiler/rustc_session/src/utils.rs:16:9\n 116: rustc_interface::passes::start_codegen\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/passes.rs:1020:19\n 117: rustc_interface::queries::Queries::ongoing_codegen::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/queries.rs:296:20\n 118: rustc_interface::passes::QueryContext::enter::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/passes.rs:755:42\n 119: rustc_middle::ty::context::tls::enter_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:50\n 120: rustc_middle::ty::context::tls::set_tlv\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1720:9\n 121: rustc_middle::ty::context::tls::enter_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:9\n 122: rustc_interface::passes::QueryContext::enter\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/passes.rs:755:9\n 123: rustc_interface::queries::Queries::ongoing_codegen::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/queries.rs:287:13\n 124: rustc_interface::queries::Query<T>::compute\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/queries.rs:40:28\n 125: rustc_interface::queries::Queries::ongoing_codegen\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/queries.rs:285:9\n 126: rustc_driver::run_compiler::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_driver/src/lib.rs:442:13\n 127: rustc_interface::queries::<impl rustc_interface::interface::Compiler>::enter\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/queries.rs:428:19\n 128: rustc_driver::run_compiler::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_driver/src/lib.rs:337:22\n 129: rustc_interface::interface::create_compiler_and_run::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/interface.rs:208:13\n 130: rustc_span::with_source_map\n             at /home/aaron/repos/rust/compiler/rustc_span/src/lib.rs:788:5\n 131: rustc_interface::interface::create_compiler_and_run\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/interface.rs:202:5\n 132: rustc_interface::interface::run_compiler::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/interface.rs:224:12\n 133: rustc_interface::util::setup_callbacks_and_run_in_thread_pool_with_globals::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/util.rs:155:13\n 134: scoped_tls::ScopedKey<T>::set\n             at /home/aaron/.cargo/registry/src/github.com-1ecc6299db9ec823/scoped-tls-1.0.0/src/lib.rs:137:9\n 135: rustc_span::with_session_globals\n             at /home/aaron/repos/rust/compiler/rustc_span/src/lib.rs:105:5\n 136: rustc_interface::util::setup_callbacks_and_run_in_thread_pool_with_globals::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/util.rs:153:9\n 137: rustc_interface::util::scoped_thread::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/util.rs:128:24\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\n\nerror: internal compiler error: unexpected panic\n\nnote: the compiler unexpectedly panicked. this is a bug.\n\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\n\nnote: rustc 1.54.0-dev running on x86_64-unknown-linux-gnu\n\nnote: compiler flags: -C opt-level=3 -C embed-bitcode=no -C incremental --crate-type lib\n\nnote: some of the compiler flags provided by cargo are hidden\n\nquery stack during panic:\n#0 [evaluate_obligation] evaluating trait selection obligation `quote::Tokens: std::marker::Unpin`\n#1 [is_unpin_raw] computing whether `quote::Tokens` is `Unpin`\nend of query stack\nerror: aborting due to previous error\n\nerror: could not compile `syn`\n\nTo learn more, run the command again with --verbose.\n```\n\nI've left in the panic and ICE following the pretty error, so that we still have all of the debug information available in a bug report.\n\nThis message can be reproduced by cloning the repository `https://github.com/Aaron1011/syn-crash`, and running the following shell script (with a `rustup override` set in the directory):\n\n```\nset -xe\ncargo clean -p syn\ncargo clean --release -p syn\n\ngit checkout minimize\ncargo build --release -j 1\n\ngit checkout minimize-change\ncargo build --release -j 1\n```\n\nr? ``@Mark-Simulacrum``", "tree": {"sha": "361b08d5fc4e31a3fb42bcfcd28878420a1f14ba", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/361b08d5fc4e31a3fb42bcfcd28878420a1f14ba"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c65663a78141d0baa5d5b0905f15acee1193a215", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgmc+VCRBK7hj4Ov3rIwAA26AIAHcG7/UL1sAzbeGD16mnwn2w\nJ43A37TKXhEYQu0GGBH8lq8Hu7xpevmKuxwEbhr4mgla/TnL+moXfOD52na5SjCr\n7UPznkJeU3bWrYnlxbAll3Zm5kgchaPqAuHhxVpTkC+MO6m+Avvedoe/LHC0Bbyp\n2Z2BYv727KgzGOzhgxJWIHHCByHgYitKVHsqWK/GuxYgMYnbNzwLIcfKuZHLMYnx\nynr1IDPcbTxp5G4s+awvyOl73Faf10X3TT+y2yCv2ZzPkl+tsz8pcppzBN1VCQY/\nYdCzeloOaSyKz+5JBGzUBuoKGDjxErs6fr6BJrSxNSAGpoYcSKfH3dI5opZhjxo=\n=vSnt\n-----END PGP SIGNATURE-----\n", "payload": "tree 361b08d5fc4e31a3fb42bcfcd28878420a1f14ba\nparent 7e827e936bbf0bcbe071fc6e506f23014dbe71bd\nparent a4c0793551326cbe6f205005d1aa0f35410e89da\nauthor Yuki Okushi <jtitor@2k36.org> 1620692884 +0900\ncommitter GitHub <noreply@github.com> 1620692884 +0900\n\nRollup merge of #84998 - Aaron1011:pretty-unstable-fingerprint, r=Mark-Simulacrum\n\nShow nicer error when an 'unstable fingerprints' error occurs\n\nAn example of the error produced by this PR:\n\n```\nerror: internal compiler error: encountered incremental compilation error with evaluate_obligation(9f2ad55260c30262-c36667639674ad83)\n  |\n  = help: This is a known issue with the compiler. Run `cargo clean -p syn` or `cargo clean` to allow your project to compile\n  = note: Please follow the instructions below to create a bug report with the provided information\n\nthread 'rustc' panicked at 'Found unstable fingerprints for evaluate_obligation(9f2ad55260c30262-c36667639674ad83): Ok(EvaluatedToOk)', /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:595:9\nstack backtrace:\n   0: rust_begin_unwind\n             at /home/aaron/repos/rust/library/std/src/panicking.rs:493:5\n   1: std::panicking::begin_panic_fmt\n             at /home/aaron/repos/rust/library/std/src/panicking.rs:435:5\n   2: rustc_query_system::query::plumbing::incremental_verify_ich\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:595:9\n   3: rustc_query_system::query::plumbing::load_from_disk_and_cache_in_memory\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:557:9\n   4: rustc_query_system::query::plumbing::try_execute_query::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:473:21\n   5: core::option::Option<T>::map\n             at /home/aaron/repos/rust/library/core/src/option.rs:487:29\n   6: rustc_query_system::query::plumbing::try_execute_query::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:471:13\n   7: stacker::maybe_grow\n             at /home/aaron/.cargo/registry/src/github.com-1ecc6299db9ec823/stacker-0.1.12/src/lib.rs:55:9\n   8: rustc_data_structures::stack::ensure_sufficient_stack\n             at /home/aaron/repos/rust/compiler/rustc_data_structures/src/stack.rs:16:5\n   9: <rustc_query_impl::plumbing::QueryCtxt as rustc_query_system::query::QueryContext>::start_query::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_impl/src/plumbing.rs:169:17\n  10: rustc_middle::ty::context::tls::enter_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:50\n  11: rustc_middle::ty::context::tls::set_tlv\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1720:9\n  12: rustc_middle::ty::context::tls::enter_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:9\n  13: <rustc_query_impl::plumbing::QueryCtxt as rustc_query_system::query::QueryContext>::start_query::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_impl/src/plumbing.rs:168:13\n  14: rustc_middle::ty::context::tls::with_related_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1780:13\n  15: rustc_middle::ty::context::tls::with_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:40\n  16: rustc_middle::ty::context::tls::with_context_opt\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1753:22\n  17: rustc_middle::ty::context::tls::with_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:9\n  18: rustc_middle::ty::context::tls::with_related_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1777:9\n  19: <rustc_query_impl::plumbing::QueryCtxt as rustc_query_system::query::QueryContext>::start_query\n             at /home/aaron/repos/rust/compiler/rustc_query_impl/src/plumbing.rs:157:9\n  20: rustc_query_system::query::plumbing::try_execute_query\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:469:22\n  21: rustc_query_system::query::plumbing::get_query_impl\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:674:5\n  22: rustc_query_system::query::plumbing::get_query\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:785:9\n  23: <rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine>::evaluate_obligation\n             at /home/aaron/repos/rust/compiler/rustc_query_impl/src/plumbing.rs:603:17\n  24: rustc_middle::ty::query::TyCtxtAt::evaluate_obligation\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/query/mod.rs:204:17\n  25: rustc_middle::ty::query::<impl rustc_middle::ty::context::TyCtxt>::evaluate_obligation\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/query/mod.rs:185:17\n  26: <rustc_infer::infer::InferCtxt as rustc_trait_selection::traits::query::evaluate_obligation::InferCtxtExt>::evaluate_obligation\n             at /home/aaron/repos/rust/compiler/rustc_trait_selection/src/traits/query/evaluate_obligation.rs:72:9\n  27: <rustc_infer::infer::InferCtxt as rustc_trait_selection::traits::query::evaluate_obligation::InferCtxtExt>::evaluate_obligation_no_overflow\n             at /home/aaron/repos/rust/compiler/rustc_trait_selection/src/traits/query/evaluate_obligation.rs:82:15\n  28: <rustc_infer::infer::InferCtxt as rustc_trait_selection::traits::query::evaluate_obligation::InferCtxtExt>::predicate_must_hold_modulo_regions\n             at /home/aaron/repos/rust/compiler/rustc_trait_selection/src/traits/query/evaluate_obligation.rs:58:9\n  29: rustc_trait_selection::traits::type_known_to_meet_bound_modulo_regions\n             at /home/aaron/repos/rust/compiler/rustc_trait_selection/src/traits/mod.rs:146:18\n  30: rustc_ty_utils::common_traits::is_item_raw::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_ty_utils/src/common_traits.rs:33:9\n  31: rustc_infer::infer::InferCtxtBuilder::enter\n             at /home/aaron/repos/rust/compiler/rustc_infer/src/infer/mod.rs:582:9\n  32: rustc_ty_utils::common_traits::is_item_raw\n             at /home/aaron/repos/rust/compiler/rustc_ty_utils/src/common_traits.rs:32:5\n  33: rustc_query_system::query::config::QueryVtable<CTX,K,V>::compute\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/config.rs:44:9\n  34: rustc_query_system::query::plumbing::load_from_disk_and_cache_in_memory::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:544:67\n  35: rustc_middle::dep_graph::<impl rustc_query_system::dep_graph::DepKind for rustc_middle::dep_graph::dep_node::DepKind>::with_deps::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/dep_graph/mod.rs:77:46\n  36: rustc_middle::ty::context::tls::enter_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:50\n  37: rustc_middle::ty::context::tls::set_tlv\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1720:9\n  38: rustc_middle::ty::context::tls::enter_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:9\n  39: rustc_middle::dep_graph::<impl rustc_query_system::dep_graph::DepKind for rustc_middle::dep_graph::dep_node::DepKind>::with_deps::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/dep_graph/mod.rs:77:13\n  40: rustc_middle::ty::context::tls::with_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:40\n  41: rustc_middle::ty::context::tls::with_context_opt\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1753:22\n  42: rustc_middle::ty::context::tls::with_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:9\n  43: rustc_middle::dep_graph::<impl rustc_query_system::dep_graph::DepKind for rustc_middle::dep_graph::dep_node::DepKind>::with_deps\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/dep_graph/mod.rs:74:9\n  44: rustc_query_system::dep_graph::graph::DepGraph<K>::with_ignore\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/dep_graph/graph.rs:167:9\n  45: rustc_query_system::query::plumbing::load_from_disk_and_cache_in_memory\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:544:22\n  46: rustc_query_system::query::plumbing::try_execute_query::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:473:21\n  47: core::option::Option<T>::map\n             at /home/aaron/repos/rust/library/core/src/option.rs:487:29\n  48: rustc_query_system::query::plumbing::try_execute_query::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:471:13\n  49: stacker::maybe_grow\n             at /home/aaron/.cargo/registry/src/github.com-1ecc6299db9ec823/stacker-0.1.12/src/lib.rs:55:9\n  50: rustc_data_structures::stack::ensure_sufficient_stack\n             at /home/aaron/repos/rust/compiler/rustc_data_structures/src/stack.rs:16:5\n  51: <rustc_query_impl::plumbing::QueryCtxt as rustc_query_system::query::QueryContext>::start_query::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_impl/src/plumbing.rs:169:17\n  52: rustc_middle::ty::context::tls::enter_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:50\n  53: rustc_middle::ty::context::tls::set_tlv\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1720:9\n  54: rustc_middle::ty::context::tls::enter_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:9\n  55: <rustc_query_impl::plumbing::QueryCtxt as rustc_query_system::query::QueryContext>::start_query::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_impl/src/plumbing.rs:168:13\n  56: rustc_middle::ty::context::tls::with_related_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1780:13\n  57: rustc_middle::ty::context::tls::with_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:40\n  58: rustc_middle::ty::context::tls::with_context_opt\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1753:22\n  59: rustc_middle::ty::context::tls::with_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:9\n  60: rustc_middle::ty::context::tls::with_related_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1777:9\n  61: <rustc_query_impl::plumbing::QueryCtxt as rustc_query_system::query::QueryContext>::start_query\n             at /home/aaron/repos/rust/compiler/rustc_query_impl/src/plumbing.rs:157:9\n  62: rustc_query_system::query::plumbing::try_execute_query\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:469:22\n  63: rustc_query_system::query::plumbing::get_query_impl\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:674:5\n  64: rustc_query_system::query::plumbing::get_query\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/query/plumbing.rs:785:9\n  65: rustc_middle::ty::query::TyCtxtAt::is_unpin_raw\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/query/mod.rs:204:17\n  66: rustc_middle::ty::util::<impl rustc_middle::ty::TyS>::is_unpin\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/util.rs:727:38\n  67: rustc_middle::ty::layout::<impl rustc_target::abi::TyAndLayoutMethods<C> for &rustc_middle::ty::TyS>::pointee_info_at\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/layout.rs:2341:32\n  68: rustc_target::abi::TyAndLayout<Ty>::pointee_info_at\n             at /home/aaron/repos/rust/compiler/rustc_target/src/abi/mod.rs:1164:9\n  69: <rustc_target::abi::call::FnAbi<&rustc_middle::ty::TyS> as rustc_middle::ty::layout::FnAbiExt<C>>::new_internal::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/layout.rs:2781:36\n  70: <rustc_target::abi::call::FnAbi<&rustc_middle::ty::TyS> as rustc_middle::ty::layout::FnAbiExt<C>>::new_internal::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/layout.rs:2840:17\n  71: rustc_target::abi::call::ArgAbi<Ty>::new\n             at /home/aaron/repos/rust/compiler/rustc_target/src/abi/call/mod.rs:457:53\n  72: <rustc_target::abi::call::FnAbi<&rustc_middle::ty::TyS> as rustc_middle::ty::layout::FnAbiExt<C>>::new_internal::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/layout.rs:2838:27\n  73: <rustc_target::abi::call::FnAbi<&rustc_middle::ty::TyS> as rustc_middle::ty::layout::FnAbiExt<C>>::new_internal::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/layout.rs:2870:32\n  74: core::iter::adapters::map::map_fold::{{closure}}\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/map.rs:82:28\n  75: <core::iter::adapters::enumerate::Enumerate<I> as core::iter::traits::iterator::Iterator>::fold::enumerate::{{closure}}\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/enumerate.rs:104:27\n  76: core::ops::function::impls::<impl core::ops::function::FnMut<A> for &mut F>::call_mut\n             at /home/aaron/repos/rust/library/core/src/ops/function.rs:269:13\n  77: core::ops::function::impls::<impl core::ops::function::FnMut<A> for &mut F>::call_mut\n             at /home/aaron/repos/rust/library/core/src/ops/function.rs:269:13\n  78: core::iter::adapters::map::map_fold::{{closure}}\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/map.rs:82:21\n  79: core::iter::traits::iterator::Iterator::fold\n             at /home/aaron/repos/rust/library/core/src/iter/traits/iterator.rs:2146:21\n  80: <core::iter::adapters::map::Map<I,F> as core::iter::traits::iterator::Iterator>::fold\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/map.rs:122:9\n  81: <core::iter::adapters::cloned::Cloned<I> as core::iter::traits::iterator::Iterator>::fold\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/cloned.rs:58:9\n  82: <core::iter::adapters::chain::Chain<A,B> as core::iter::traits::iterator::Iterator>::fold\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/chain.rs:119:19\n  83: <core::iter::adapters::chain::Chain<A,B> as core::iter::traits::iterator::Iterator>::fold\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/chain.rs:119:19\n  84: <core::iter::adapters::enumerate::Enumerate<I> as core::iter::traits::iterator::Iterator>::fold\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/enumerate.rs:110:9\n  85: <core::iter::adapters::map::Map<I,F> as core::iter::traits::iterator::Iterator>::fold\n             at /home/aaron/repos/rust/library/core/src/iter/adapters/map.rs:122:9\n  86: core::iter::traits::iterator::Iterator::for_each\n             at /home/aaron/repos/rust/library/core/src/iter/traits/iterator.rs:776:9\n  87: <alloc::vec::Vec<T,A> as alloc::vec::spec_extend::SpecExtend<T,I>>::spec_extend\n             at /home/aaron/repos/rust/library/alloc/src/vec/spec_extend.rs:40:17\n  88: <alloc::vec::Vec<T> as alloc::vec::spec_from_iter_nested::SpecFromIterNested<T,I>>::from_iter\n             at /home/aaron/repos/rust/library/alloc/src/vec/spec_from_iter_nested.rs:56:9\n  89: <alloc::vec::Vec<T> as alloc::vec::spec_from_iter::SpecFromIter<T,I>>::from_iter\n             at /home/aaron/repos/rust/library/alloc/src/vec/spec_from_iter.rs:36:9\n  90: <alloc::vec::Vec<T> as core::iter::traits::collect::FromIterator<T>>::from_iter\n             at /home/aaron/repos/rust/library/alloc/src/vec/mod.rs:2448:9\n  91: core::iter::traits::iterator::Iterator::collect\n             at /home/aaron/repos/rust/library/core/src/iter/traits/iterator.rs:1788:9\n  92: <rustc_target::abi::call::FnAbi<&rustc_middle::ty::TyS> as rustc_middle::ty::layout::FnAbiExt<C>>::new_internal\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/layout.rs:2864:19\n  93: <rustc_target::abi::call::FnAbi<&rustc_middle::ty::TyS> as rustc_middle::ty::layout::FnAbiExt<C>>::of_instance\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/layout.rs:2670:9\n  94: rustc_codegen_llvm::mono_item::<impl rustc_codegen_ssa::traits::declare::PreDefineMethods for rustc_codegen_llvm::context::CodegenCx>::predefine_fn\n             at /home/aaron/repos/rust/compiler/rustc_codegen_llvm/src/mono_item.rs:57:22\n  95: <rustc_middle::mir::mono::MonoItem as rustc_codegen_ssa::mono_item::MonoItemExt>::predefine\n             at /home/aaron/repos/rust/compiler/rustc_codegen_ssa/src/mono_item.rs:76:17\n  96: rustc_codegen_llvm::base::compile_codegen_unit::module_codegen\n             at /home/aaron/repos/rust/compiler/rustc_codegen_llvm/src/base.rs:122:17\n  97: rustc_query_system::dep_graph::graph::DepGraph<K>::with_task_impl::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/dep_graph/graph.rs:235:62\n  98: rustc_middle::dep_graph::<impl rustc_query_system::dep_graph::DepKind for rustc_middle::dep_graph::dep_node::DepKind>::with_deps::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/dep_graph/mod.rs:77:46\n  99: rustc_middle::ty::context::tls::enter_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:50\n 100: rustc_middle::ty::context::tls::set_tlv\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1720:9\n 101: rustc_middle::ty::context::tls::enter_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:9\n 102: rustc_middle::dep_graph::<impl rustc_query_system::dep_graph::DepKind for rustc_middle::dep_graph::dep_node::DepKind>::with_deps::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/dep_graph/mod.rs:77:13\n 103: rustc_middle::ty::context::tls::with_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:40\n 104: rustc_middle::ty::context::tls::with_context_opt\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1753:22\n 105: rustc_middle::ty::context::tls::with_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1764:9\n 106: rustc_middle::dep_graph::<impl rustc_query_system::dep_graph::DepKind for rustc_middle::dep_graph::dep_node::DepKind>::with_deps\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/dep_graph/mod.rs:74:9\n 107: rustc_query_system::dep_graph::graph::DepGraph<K>::with_task_impl\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/dep_graph/graph.rs:235:26\n 108: rustc_query_system::dep_graph::graph::DepGraph<K>::with_task\n             at /home/aaron/repos/rust/compiler/rustc_query_system/src/dep_graph/graph.rs:205:9\n 109: rustc_codegen_llvm::base::compile_codegen_unit\n             at /home/aaron/repos/rust/compiler/rustc_codegen_llvm/src/base.rs:103:9\n 110: <rustc_codegen_llvm::LlvmCodegenBackend as rustc_codegen_ssa::traits::backend::ExtraBackendMethods>::compile_codegen_unit\n             at /home/aaron/repos/rust/compiler/rustc_codegen_llvm/src/lib.rs:109:9\n 111: rustc_codegen_ssa::base::codegen_crate\n             at /home/aaron/repos/rust/compiler/rustc_codegen_ssa/src/base.rs:655:38\n 112: <rustc_codegen_llvm::LlvmCodegenBackend as rustc_codegen_ssa::traits::backend::CodegenBackend>::codegen_crate\n             at /home/aaron/repos/rust/compiler/rustc_codegen_llvm/src/lib.rs:270:18\n 113: rustc_interface::passes::start_codegen::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/passes.rs:1021:9\n 114: rustc_data_structures::profiling::VerboseTimingGuard::run\n             at /home/aaron/repos/rust/compiler/rustc_data_structures/src/profiling.rs:573:9\n 115: rustc_session::utils::<impl rustc_session::session::Session>::time\n             at /home/aaron/repos/rust/compiler/rustc_session/src/utils.rs:16:9\n 116: rustc_interface::passes::start_codegen\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/passes.rs:1020:19\n 117: rustc_interface::queries::Queries::ongoing_codegen::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/queries.rs:296:20\n 118: rustc_interface::passes::QueryContext::enter::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/passes.rs:755:42\n 119: rustc_middle::ty::context::tls::enter_context::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:50\n 120: rustc_middle::ty::context::tls::set_tlv\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1720:9\n 121: rustc_middle::ty::context::tls::enter_context\n             at /home/aaron/repos/rust/compiler/rustc_middle/src/ty/context.rs:1736:9\n 122: rustc_interface::passes::QueryContext::enter\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/passes.rs:755:9\n 123: rustc_interface::queries::Queries::ongoing_codegen::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/queries.rs:287:13\n 124: rustc_interface::queries::Query<T>::compute\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/queries.rs:40:28\n 125: rustc_interface::queries::Queries::ongoing_codegen\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/queries.rs:285:9\n 126: rustc_driver::run_compiler::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_driver/src/lib.rs:442:13\n 127: rustc_interface::queries::<impl rustc_interface::interface::Compiler>::enter\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/queries.rs:428:19\n 128: rustc_driver::run_compiler::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_driver/src/lib.rs:337:22\n 129: rustc_interface::interface::create_compiler_and_run::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/interface.rs:208:13\n 130: rustc_span::with_source_map\n             at /home/aaron/repos/rust/compiler/rustc_span/src/lib.rs:788:5\n 131: rustc_interface::interface::create_compiler_and_run\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/interface.rs:202:5\n 132: rustc_interface::interface::run_compiler::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/interface.rs:224:12\n 133: rustc_interface::util::setup_callbacks_and_run_in_thread_pool_with_globals::{{closure}}::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/util.rs:155:13\n 134: scoped_tls::ScopedKey<T>::set\n             at /home/aaron/.cargo/registry/src/github.com-1ecc6299db9ec823/scoped-tls-1.0.0/src/lib.rs:137:9\n 135: rustc_span::with_session_globals\n             at /home/aaron/repos/rust/compiler/rustc_span/src/lib.rs:105:5\n 136: rustc_interface::util::setup_callbacks_and_run_in_thread_pool_with_globals::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/util.rs:153:9\n 137: rustc_interface::util::scoped_thread::{{closure}}\n             at /home/aaron/repos/rust/compiler/rustc_interface/src/util.rs:128:24\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\n\nerror: internal compiler error: unexpected panic\n\nnote: the compiler unexpectedly panicked. this is a bug.\n\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md\n\nnote: rustc 1.54.0-dev running on x86_64-unknown-linux-gnu\n\nnote: compiler flags: -C opt-level=3 -C embed-bitcode=no -C incremental --crate-type lib\n\nnote: some of the compiler flags provided by cargo are hidden\n\nquery stack during panic:\n#0 [evaluate_obligation] evaluating trait selection obligation `quote::Tokens: std::marker::Unpin`\n#1 [is_unpin_raw] computing whether `quote::Tokens` is `Unpin`\nend of query stack\nerror: aborting due to previous error\n\nerror: could not compile `syn`\n\nTo learn more, run the command again with --verbose.\n```\n\nI've left in the panic and ICE following the pretty error, so that we still have all of the debug information available in a bug report.\n\nThis message can be reproduced by cloning the repository `https://github.com/Aaron1011/syn-crash`, and running the following shell script (with a `rustup override` set in the directory):\n\n```\nset -xe\ncargo clean -p syn\ncargo clean --release -p syn\n\ngit checkout minimize\ncargo build --release -j 1\n\ngit checkout minimize-change\ncargo build --release -j 1\n```\n\nr? ``@Mark-Simulacrum``\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c65663a78141d0baa5d5b0905f15acee1193a215", "html_url": "https://github.com/rust-lang/rust/commit/c65663a78141d0baa5d5b0905f15acee1193a215", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c65663a78141d0baa5d5b0905f15acee1193a215/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7e827e936bbf0bcbe071fc6e506f23014dbe71bd", "url": "https://api.github.com/repos/rust-lang/rust/commits/7e827e936bbf0bcbe071fc6e506f23014dbe71bd", "html_url": "https://github.com/rust-lang/rust/commit/7e827e936bbf0bcbe071fc6e506f23014dbe71bd"}, {"sha": "a4c0793551326cbe6f205005d1aa0f35410e89da", "url": "https://api.github.com/repos/rust-lang/rust/commits/a4c0793551326cbe6f205005d1aa0f35410e89da", "html_url": "https://github.com/rust-lang/rust/commit/a4c0793551326cbe6f205005d1aa0f35410e89da"}], "stats": {"total": 20, "additions": 13, "deletions": 7}, "files": [{"sha": "39dfdd78cc4f5613a85153303e9dcc3aae9bf01f", "filename": "compiler/rustc_query_system/src/query/plumbing.rs", "status": "modified", "additions": 13, "deletions": 7, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/c65663a78141d0baa5d5b0905f15acee1193a215/compiler%2Frustc_query_system%2Fsrc%2Fquery%2Fplumbing.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c65663a78141d0baa5d5b0905f15acee1193a215/compiler%2Frustc_query_system%2Fsrc%2Fquery%2Fplumbing.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_query_system%2Fsrc%2Fquery%2Fplumbing.rs?ref=c65663a78141d0baa5d5b0905f15acee1193a215", "patch": "@@ -605,13 +605,19 @@ fn incremental_verify_ich<CTX, K, V: Debug>(\n \n     let old_hash = tcx.dep_graph().prev_fingerprint_of(dep_node);\n \n-    assert_eq!(\n-        Some(new_hash),\n-        old_hash,\n-        \"found unstable fingerprints for {:?}: {:?}\",\n-        dep_node,\n-        result\n-    );\n+    if Some(new_hash) != old_hash {\n+        let run_cmd = if let Some(crate_name) = &tcx.sess().opts.crate_name {\n+            format!(\"`cargo clean -p {}` or `cargo clean`\", crate_name)\n+        } else {\n+            \"`cargo clean`\".to_string()\n+        };\n+        tcx.sess().struct_err(&format!(\"internal compiler error: encountered incremental compilation error with {:?}\", dep_node))\n+            .help(&format!(\"This is a known issue with the compiler. Run {} to allow your project to compile\", run_cmd))\n+            .note(&format!(\"Please follow the instructions below to create a bug report with the provided information\"))\n+            .note(&format!(\"See <https://github.com/rust-lang/rust/issues/84970> for more information\"))\n+            .emit();\n+        panic!(\"Found unstable fingerprints for {:?}: {:?}\", dep_node, result);\n+    }\n }\n \n fn force_query_with_job<C, CTX>("}]}