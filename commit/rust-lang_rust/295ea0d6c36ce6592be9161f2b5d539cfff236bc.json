{"sha": "295ea0d6c36ce6592be9161f2b5d539cfff236bc", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI5NWVhMGQ2YzM2Y2U2NTkyYmU5MTYxZjJiNWQ1MzljZmZmMjM2YmM=", "commit": {"author": {"name": "Mark Simulacrum", "email": "mark.simulacrum@gmail.com", "date": "2016-12-20T01:47:30Z"}, "committer": {"name": "Mark Simulacrum", "email": "mark.simulacrum@gmail.com", "date": "2016-12-21T03:04:44Z"}, "message": "Reduce coerce_unsized_into to one call\n\nWe cannot inline due to it being recursive.", "tree": {"sha": "6d6ffe2ece5c7c434f5bd96879c99260066a9869", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6d6ffe2ece5c7c434f5bd96879c99260066a9869"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/295ea0d6c36ce6592be9161f2b5d539cfff236bc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/295ea0d6c36ce6592be9161f2b5d539cfff236bc", "html_url": "https://github.com/rust-lang/rust/commit/295ea0d6c36ce6592be9161f2b5d539cfff236bc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/295ea0d6c36ce6592be9161f2b5d539cfff236bc/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "98a13ffe443442054b41bee0dace0265c31c29a7", "url": "https://api.github.com/repos/rust-lang/rust/commits/98a13ffe443442054b41bee0dace0265c31c29a7", "html_url": "https://github.com/rust-lang/rust/commit/98a13ffe443442054b41bee0dace0265c31c29a7"}], "stats": {"total": 15, "additions": 5, "deletions": 10}, "files": [{"sha": "a22b0a13f78369500fad1dae1cd082e129df4252", "filename": "src/librustc_trans/mir/rvalue.rs", "status": "modified", "additions": 5, "deletions": 10, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/295ea0d6c36ce6592be9161f2b5d539cfff236bc/src%2Flibrustc_trans%2Fmir%2Frvalue.rs", "raw_url": "https://github.com/rust-lang/rust/raw/295ea0d6c36ce6592be9161f2b5d539cfff236bc/src%2Flibrustc_trans%2Fmir%2Frvalue.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fmir%2Frvalue.rs?ref=295ea0d6c36ce6592be9161f2b5d539cfff236bc", "patch": "@@ -69,7 +69,7 @@ impl<'a, 'tcx> MirContext<'a, 'tcx> {\n                 // so the (generic) MIR may not be able to expand it.\n                 let operand = self.trans_operand(&bcx, source);\n                 let operand = operand.pack_if_pair(&bcx);\n-                match operand.val {\n+                let llref = match operand.val {\n                     OperandValue::Pair(..) => bug!(),\n                     OperandValue::Immediate(llval) => {\n                         // unsize from an immediate structure. We don't\n@@ -81,16 +81,11 @@ impl<'a, 'tcx> MirContext<'a, 'tcx> {\n                         debug!(\"trans_rvalue: creating ugly alloca\");\n                         let lltemp = base::alloc_ty(&bcx, operand.ty, \"__unsize_temp\");\n                         base::store_ty(&bcx, llval, lltemp, operand.ty);\n-                        base::coerce_unsized_into(&bcx,\n-                            lltemp, operand.ty,\n-                            dest.llval, cast_ty);\n+                        lltemp\n                     }\n-                    OperandValue::Ref(llref) => {\n-                        base::coerce_unsized_into(&bcx,\n-                            llref, operand.ty,\n-                            dest.llval, cast_ty);\n-                    }\n-                }\n+                    OperandValue::Ref(llref) => llref\n+                };\n+                base::coerce_unsized_into(&bcx, llref, operand.ty, dest.llval, cast_ty);\n                 bcx\n             }\n "}]}