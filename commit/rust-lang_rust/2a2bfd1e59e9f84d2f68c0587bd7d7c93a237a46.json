{"sha": "2a2bfd1e59e9f84d2f68c0587bd7d7c93a237a46", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJhMmJmZDFlNTllOWY4NGQyZjY4YzA1ODdiZDdkN2M5M2EyMzdhNDY=", "commit": {"author": {"name": "Fabian Wolff", "email": "fabian.wolff@alumni.ethz.ch", "date": "2021-09-14T22:11:18Z"}, "committer": {"name": "Fabian Wolff", "email": "fabian.wolff@alumni.ethz.ch", "date": "2021-09-14T23:25:51Z"}, "message": "Fix handling of `hir::GenericArg::Infer` in `wrong_number_of_generic_args.rs`", "tree": {"sha": "522f361f7638ef17fa42ed2189f0d46e17003791", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/522f361f7638ef17fa42ed2189f0d46e17003791"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2a2bfd1e59e9f84d2f68c0587bd7d7c93a237a46", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2a2bfd1e59e9f84d2f68c0587bd7d7c93a237a46", "html_url": "https://github.com/rust-lang/rust/commit/2a2bfd1e59e9f84d2f68c0587bd7d7c93a237a46", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2a2bfd1e59e9f84d2f68c0587bd7d7c93a237a46/comments", "author": {"login": "FabianWolff", "id": 16052130, "node_id": "MDQ6VXNlcjE2MDUyMTMw", "avatar_url": "https://avatars.githubusercontent.com/u/16052130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FabianWolff", "html_url": "https://github.com/FabianWolff", "followers_url": "https://api.github.com/users/FabianWolff/followers", "following_url": "https://api.github.com/users/FabianWolff/following{/other_user}", "gists_url": "https://api.github.com/users/FabianWolff/gists{/gist_id}", "starred_url": "https://api.github.com/users/FabianWolff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FabianWolff/subscriptions", "organizations_url": "https://api.github.com/users/FabianWolff/orgs", "repos_url": "https://api.github.com/users/FabianWolff/repos", "events_url": "https://api.github.com/users/FabianWolff/events{/privacy}", "received_events_url": "https://api.github.com/users/FabianWolff/received_events", "type": "User", "site_admin": false}, "committer": {"login": "FabianWolff", "id": 16052130, "node_id": "MDQ6VXNlcjE2MDUyMTMw", "avatar_url": "https://avatars.githubusercontent.com/u/16052130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FabianWolff", "html_url": "https://github.com/FabianWolff", "followers_url": "https://api.github.com/users/FabianWolff/followers", "following_url": "https://api.github.com/users/FabianWolff/following{/other_user}", "gists_url": "https://api.github.com/users/FabianWolff/gists{/gist_id}", "starred_url": "https://api.github.com/users/FabianWolff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FabianWolff/subscriptions", "organizations_url": "https://api.github.com/users/FabianWolff/orgs", "repos_url": "https://api.github.com/users/FabianWolff/repos", "events_url": "https://api.github.com/users/FabianWolff/events{/privacy}", "received_events_url": "https://api.github.com/users/FabianWolff/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c3c0f80d6081092faff801542dd82f0e2420152b", "url": "https://api.github.com/repos/rust-lang/rust/commits/c3c0f80d6081092faff801542dd82f0e2420152b", "html_url": "https://github.com/rust-lang/rust/commit/c3c0f80d6081092faff801542dd82f0e2420152b"}], "stats": {"total": 14, "additions": 5, "deletions": 9}, "files": [{"sha": "7e69ad21d034326a9c1fac72b80946e96a0c6fe8", "filename": "compiler/rustc_typeck/src/structured_errors/wrong_number_of_generic_args.rs", "status": "modified", "additions": 5, "deletions": 9, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/2a2bfd1e59e9f84d2f68c0587bd7d7c93a237a46/compiler%2Frustc_typeck%2Fsrc%2Fstructured_errors%2Fwrong_number_of_generic_args.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2a2bfd1e59e9f84d2f68c0587bd7d7c93a237a46/compiler%2Frustc_typeck%2Fsrc%2Fstructured_errors%2Fwrong_number_of_generic_args.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fstructured_errors%2Fwrong_number_of_generic_args.rs?ref=2a2bfd1e59e9f84d2f68c0587bd7d7c93a237a46", "patch": "@@ -136,10 +136,7 @@ impl<'a, 'tcx> WrongNumberOfGenericArgs<'a, 'tcx> {\n             AngleBrackets::Missing => 0,\n             // Only lifetime arguments can be implied\n             AngleBrackets::Implied => self.gen_args.args.len(),\n-            AngleBrackets::Available => self.gen_args.args.iter().fold(0, |acc, arg| match arg {\n-                hir::GenericArg::Lifetime(_) => acc + 1,\n-                _ => acc,\n-            }),\n+            AngleBrackets::Available => self.gen_args.num_lifetime_params(),\n         }\n     }\n \n@@ -148,10 +145,7 @@ impl<'a, 'tcx> WrongNumberOfGenericArgs<'a, 'tcx> {\n             AngleBrackets::Missing => 0,\n             // Only lifetime arguments can be implied\n             AngleBrackets::Implied => 0,\n-            AngleBrackets::Available => self.gen_args.args.iter().fold(0, |acc, arg| match arg {\n-                hir::GenericArg::Type(_) | hir::GenericArg::Const(_) => acc + 1,\n-                _ => acc,\n-            }),\n+            AngleBrackets::Available => self.gen_args.num_generic_params(),\n         }\n     }\n \n@@ -651,7 +645,9 @@ impl<'a, 'tcx> WrongNumberOfGenericArgs<'a, 'tcx> {\n             let mut found_redundant = false;\n             for arg in self.gen_args.args {\n                 match arg {\n-                    hir::GenericArg::Type(_) | hir::GenericArg::Const(_) => {\n+                    hir::GenericArg::Type(_)\n+                    | hir::GenericArg::Const(_)\n+                    | hir::GenericArg::Infer(_) => {\n                         gen_arg_spans.push(arg.span());\n                         if gen_arg_spans.len() > self.num_expected_type_or_const_args() {\n                             found_redundant = true;"}]}