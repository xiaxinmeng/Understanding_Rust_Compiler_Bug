{"sha": "bc62bd55bd4d91ea283d4db0167742d967fa5817", "node_id": "C_kwDOAAsO6NoAKGJjNjJiZDU1YmQ0ZDkxZWEyODNkNGRiMDE2Nzc0MmQ5NjdmYTU4MTc", "commit": {"author": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2022-04-05T09:31:42Z"}, "committer": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2022-04-05T09:31:42Z"}, "message": "Sync from rust 949b98cab8a186b98bf87e64374b8d0848c55271", "tree": {"sha": "6e79e36cf5036732675211b77f5a7eb333d68093", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6e79e36cf5036732675211b77f5a7eb333d68093"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bc62bd55bd4d91ea283d4db0167742d967fa5817", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bc62bd55bd4d91ea283d4db0167742d967fa5817", "html_url": "https://github.com/rust-lang/rust/commit/bc62bd55bd4d91ea283d4db0167742d967fa5817", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bc62bd55bd4d91ea283d4db0167742d967fa5817/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "11007c02f70130cdc70b98f0909e5c150a2751a6", "url": "https://api.github.com/repos/rust-lang/rust/commits/11007c02f70130cdc70b98f0909e5c150a2751a6", "html_url": "https://github.com/rust-lang/rust/commit/11007c02f70130cdc70b98f0909e5c150a2751a6"}, {"sha": "69046fa8fdb2505367a4375be78eae5b47e15fe7", "url": "https://api.github.com/repos/rust-lang/rust/commits/69046fa8fdb2505367a4375be78eae5b47e15fe7", "html_url": "https://github.com/rust-lang/rust/commit/69046fa8fdb2505367a4375be78eae5b47e15fe7"}], "stats": {"total": 12, "additions": 8, "deletions": 4}, "files": [{"sha": "d270fec6b71152b88a93b1876b3ad4aff27999d0", "filename": "example/arbitrary_self_types_pointers_and_wrappers.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bc62bd55bd4d91ea283d4db0167742d967fa5817/example%2Farbitrary_self_types_pointers_and_wrappers.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bc62bd55bd4d91ea283d4db0167742d967fa5817/example%2Farbitrary_self_types_pointers_and_wrappers.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/example%2Farbitrary_self_types_pointers_and_wrappers.rs?ref=bc62bd55bd4d91ea283d4db0167742d967fa5817", "patch": "@@ -36,7 +36,7 @@ impl<T: DispatchFromDyn<U>, U> DispatchFromDyn<Wrapper<U>> for Wrapper<T> {}\n \n trait Trait {\n     // This method isn't object-safe yet. Unsized by-value `self` is object-safe (but not callable\n-    // without unsized_locals), but wrappers arond `Self` currently are not.\n+    // without unsized_locals), but wrappers around `Self` currently are not.\n     // FIXME (mikeyhew) uncomment this when unsized rvalues object-safety is implemented\n     // fn wrapper(self: Wrapper<Self>) -> i32;\n     fn ptr_wrapper(self: Ptr<Wrapper<Self>>) -> i32;"}, {"sha": "bc4c06ed7d2988e6d28810d11ead10c7c8d05022", "filename": "scripts/rustup.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bc62bd55bd4d91ea283d4db0167742d967fa5817/scripts%2Frustup.sh", "raw_url": "https://github.com/rust-lang/rust/raw/bc62bd55bd4d91ea283d4db0167742d967fa5817/scripts%2Frustup.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/scripts%2Frustup.sh?ref=bc62bd55bd4d91ea283d4db0167742d967fa5817", "patch": "@@ -11,7 +11,7 @@ case $1 in\n         sed -i \"s/\\\"nightly-.*\\\"/\\\"nightly-${TOOLCHAIN}\\\"/\" rust-toolchain\n         rustup component add rustfmt || true\n \n-        echo \"=> Uninstalling all old nighlies\"\n+        echo \"=> Uninstalling all old nightlies\"\n         for nightly in $(rustup toolchain list | grep nightly | grep -v \"$TOOLCHAIN\" | grep -v nightly-x86_64); do\n             rustup toolchain uninstall \"$nightly\"\n         done"}, {"sha": "5e1e1c81d26ea368e61f234f4ea7dc03be3010af", "filename": "src/driver/aot.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/bc62bd55bd4d91ea283d4db0167742d967fa5817/src%2Fdriver%2Faot.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bc62bd55bd4d91ea283d4db0167742d967fa5817/src%2Fdriver%2Faot.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdriver%2Faot.rs?ref=bc62bd55bd4d91ea283d4db0167742d967fa5817", "patch": "@@ -304,8 +304,12 @@ pub(crate) fn run_aot(\n     };\n \n     // FIXME handle `-Ctarget-cpu=native`\n-    let target_cpu =\n-        tcx.sess.opts.cg.target_cpu.as_ref().unwrap_or(&tcx.sess.target.cpu).to_owned();\n+    let target_cpu = match tcx.sess.opts.cg.target_cpu {\n+        Some(ref name) => name,\n+        None => tcx.sess.target.cpu.as_ref(),\n+    }\n+    .to_owned();\n+\n     Box::new((\n         CodegenResults {\n             modules,"}]}