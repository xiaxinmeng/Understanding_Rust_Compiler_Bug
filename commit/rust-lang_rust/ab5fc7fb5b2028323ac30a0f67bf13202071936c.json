{"sha": "ab5fc7fb5b2028323ac30a0f67bf13202071936c", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFiNWZjN2ZiNWIyMDI4MzIzYWMzMGEwZjY3YmYxMzIwMjA3MTkzNmM=", "commit": {"author": {"name": "Oliver Scherer", "email": "github35764891676564198441@oli-obk.de", "date": "2018-12-19T15:37:16Z"}, "committer": {"name": "Oliver Scherer", "email": "github35764891676564198441@oli-obk.de", "date": "2018-12-19T15:37:16Z"}, "message": "Only emit issues for build failures to supress spurious failures", "tree": {"sha": "8864cea3c4c22598a66811e75bf5b469c73238c9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8864cea3c4c22598a66811e75bf5b469c73238c9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ab5fc7fb5b2028323ac30a0f67bf13202071936c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ab5fc7fb5b2028323ac30a0f67bf13202071936c", "html_url": "https://github.com/rust-lang/rust/commit/ab5fc7fb5b2028323ac30a0f67bf13202071936c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ab5fc7fb5b2028323ac30a0f67bf13202071936c/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c485acb27c248d36c847ef4602770dcaa76b286d", "url": "https://api.github.com/repos/rust-lang/rust/commits/c485acb27c248d36c847ef4602770dcaa76b286d", "html_url": "https://github.com/rust-lang/rust/commit/c485acb27c248d36c847ef4602770dcaa76b286d"}], "stats": {"total": 9, "additions": 7, "deletions": 2}, "files": [{"sha": "095ef0df496e68a6c68b7abf6268da8b1babcaa2", "filename": "src/tools/publish_toolstate.py", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/ab5fc7fb5b2028323ac30a0f67bf13202071936c/src%2Ftools%2Fpublish_toolstate.py", "raw_url": "https://github.com/rust-lang/rust/raw/ab5fc7fb5b2028323ac30a0f67bf13202071936c/src%2Ftools%2Fpublish_toolstate.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fpublish_toolstate.py?ref=ab5fc7fb5b2028323ac30a0f67bf13202071936c", "patch": "@@ -115,17 +115,21 @@ def update_latest(\n                 new = s.get(tool, old)\n                 status[os] = new\n                 if new > old:\n+                    # things got fixed or at least the status quo improved\n                     changed = True\n                     message += '\ud83c\udf89 {} on {}: {} \u2192 {} (cc {}, @rust-lang/infra).\\n' \\\n                         .format(tool, os, old, new, MAINTAINERS.get(tool))\n                 elif new < old:\n+                    # tests or builds are failing and were not failing before\n                     changed = True\n                     title = '\ud83d\udc94 {} on {}: {} \u2192 {}' \\\n                         .format(tool, os, old, new)\n                     message += '{} (cc {}, @rust-lang/infra).\\n' \\\n                         .format(title, MAINTAINERS.get(tool))\n-                    failures += title\n-                    failures += '\\n'\n+                    # only create issues for build failures. Other failures can be spurious\n+                    if new == 'build-fail':\n+                        failures += title\n+                        failures += '\\n'\n \n             if failures != '':\n                 issue(tool, MAINTAINERS.get(tool), relevant_pr_number, relevant_pr_user, failures)\n@@ -151,6 +155,7 @@ def update_latest(\n     save_message_to_path = sys.argv[3]\n     github_token = sys.argv[4]\n \n+    # assume that PR authors are also owners of the repo where the branch lives\n     relevant_pr_match = re.search('Auto merge of #([0-9]+) - ([^:]+)', cur_commit_msg)\n     if relevant_pr_match:\n         number = relevant_pr_match.group(1)"}]}