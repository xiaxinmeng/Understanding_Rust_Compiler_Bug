{"sha": "c0ff894a22511eead2f521b5321f040cca8b1d5b", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMwZmY4OTRhMjI1MTFlZWFkMmY1MjFiNTMyMWYwNDBjY2E4YjFkNWI=", "commit": {"author": {"name": "Shotaro Yamada", "email": "sinkuu@sinkuu.xyz", "date": "2019-03-29T11:12:45Z"}, "committer": {"name": "Shotaro Yamada", "email": "sinkuu@sinkuu.xyz", "date": "2019-03-29T11:12:45Z"}, "message": "Fix indexing panic on unicode whitespaces", "tree": {"sha": "b76e31ebece29b807cd0eba2dd2f2cb60940e0a1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b76e31ebece29b807cd0eba2dd2f2cb60940e0a1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c0ff894a22511eead2f521b5321f040cca8b1d5b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c0ff894a22511eead2f521b5321f040cca8b1d5b", "html_url": "https://github.com/rust-lang/rust/commit/c0ff894a22511eead2f521b5321f040cca8b1d5b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c0ff894a22511eead2f521b5321f040cca8b1d5b/comments", "author": {"login": "sinkuu", "id": 7091080, "node_id": "MDQ6VXNlcjcwOTEwODA=", "avatar_url": "https://avatars.githubusercontent.com/u/7091080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sinkuu", "html_url": "https://github.com/sinkuu", "followers_url": "https://api.github.com/users/sinkuu/followers", "following_url": "https://api.github.com/users/sinkuu/following{/other_user}", "gists_url": "https://api.github.com/users/sinkuu/gists{/gist_id}", "starred_url": "https://api.github.com/users/sinkuu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sinkuu/subscriptions", "organizations_url": "https://api.github.com/users/sinkuu/orgs", "repos_url": "https://api.github.com/users/sinkuu/repos", "events_url": "https://api.github.com/users/sinkuu/events{/privacy}", "received_events_url": "https://api.github.com/users/sinkuu/received_events", "type": "User", "site_admin": false}, "committer": {"login": "sinkuu", "id": 7091080, "node_id": "MDQ6VXNlcjcwOTEwODA=", "avatar_url": "https://avatars.githubusercontent.com/u/7091080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sinkuu", "html_url": "https://github.com/sinkuu", "followers_url": "https://api.github.com/users/sinkuu/followers", "following_url": "https://api.github.com/users/sinkuu/following{/other_user}", "gists_url": "https://api.github.com/users/sinkuu/gists{/gist_id}", "starred_url": "https://api.github.com/users/sinkuu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sinkuu/subscriptions", "organizations_url": "https://api.github.com/users/sinkuu/orgs", "repos_url": "https://api.github.com/users/sinkuu/repos", "events_url": "https://api.github.com/users/sinkuu/events{/privacy}", "received_events_url": "https://api.github.com/users/sinkuu/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "09940a70d0a9fabfb4985426aa7d66ca1875c65e", "url": "https://api.github.com/repos/rust-lang/rust/commits/09940a70d0a9fabfb4985426aa7d66ca1875c65e", "html_url": "https://github.com/rust-lang/rust/commit/09940a70d0a9fabfb4985426aa7d66ca1875c65e"}], "stats": {"total": 23, "additions": 21, "deletions": 2}, "files": [{"sha": "c75206b5ce685b02102607ad04971d7b4ff23851", "filename": "src/lists.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/c0ff894a22511eead2f521b5321f040cca8b1d5b/src%2Flists.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c0ff894a22511eead2f521b5321f040cca8b1d5b/src%2Flists.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flists.rs?ref=c0ff894a22511eead2f521b5321f040cca8b1d5b", "patch": "@@ -651,7 +651,7 @@ pub fn get_comment_end(\n     if let Some(i) = block_open_index {\n         match post_snippet.find('/') {\n             Some(j) if j < i => block_open_index = None,\n-            _ if i > 0 && &post_snippet[i - 1..i] == \"/\" => block_open_index = None,\n+            _ if post_snippet[..i].chars().last() == Some('/') => block_open_index = None,\n             _ => (),\n         }\n     }\n@@ -692,8 +692,13 @@ pub fn has_extra_newline(post_snippet: &str, comment_end: usize) -> bool {\n         return false;\n     }\n \n+    let len_last = post_snippet[..comment_end]\n+        .chars()\n+        .last()\n+        .unwrap()\n+        .len_utf8();\n     // Everything from the separator to the next item.\n-    let test_snippet = &post_snippet[comment_end - 1..];\n+    let test_snippet = &post_snippet[comment_end - len_last..];\n     let first_newline = test_snippet\n         .find('\\n')\n         .unwrap_or_else(|| test_snippet.len());"}, {"sha": "accf7c3a1ad5d6846cc0d576f11cf4eb80e020a0", "filename": "tests/source/issue-2995.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/c0ff894a22511eead2f521b5321f040cca8b1d5b/tests%2Fsource%2Fissue-2995.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c0ff894a22511eead2f521b5321f040cca8b1d5b/tests%2Fsource%2Fissue-2995.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fissue-2995.rs?ref=c0ff894a22511eead2f521b5321f040cca8b1d5b", "patch": "@@ -0,0 +1,7 @@\n+fn issue_2995() {\n+    // '\\u{2028}' is inserted in the code below.\n+\n+    [0, \u20281];\n+    [0, \u2028/* */ 1];\n+    \u2028[\u20280\u2028,\u20281\u2028]\u2028;\n+}"}, {"sha": "890da8def92f3806af025ab76fd597c650db42f4", "filename": "tests/target/issue-2995.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/c0ff894a22511eead2f521b5321f040cca8b1d5b/tests%2Ftarget%2Fissue-2995.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c0ff894a22511eead2f521b5321f040cca8b1d5b/tests%2Ftarget%2Fissue-2995.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-2995.rs?ref=c0ff894a22511eead2f521b5321f040cca8b1d5b", "patch": "@@ -0,0 +1,7 @@\n+fn issue_2995() {\n+    // '\\u{2028}' is inserted in the code below.\n+\n+    [0, 1];\n+    [0, /* */ 1];\n+    [0, 1];\n+}"}]}