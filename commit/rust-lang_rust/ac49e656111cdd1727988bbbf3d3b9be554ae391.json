{"sha": "ac49e656111cdd1727988bbbf3d3b9be554ae391", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFjNDllNjU2MTExY2RkMTcyNzk4OGJiYmYzZDNiOWJlNTU0YWUzOTE=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-08-14T11:41:20Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-08-14T11:41:20Z"}, "message": "auto merge of #8440 : sfackler/rust/env-fix, r=pcwalton\n\nThe type of the result of option_env! was not fully specified in the\r\nNone case, leading to type check failures in the case where the variable\r\nwas not defined (e.g. option_env!(\"FOO\").is_none()).\r\n\r\nAlso cleaned up some compilation warnings.", "tree": {"sha": "34f5a3f840468e51f05827f0d228d041f0015487", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/34f5a3f840468e51f05827f0d228d041f0015487"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ac49e656111cdd1727988bbbf3d3b9be554ae391", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ac49e656111cdd1727988bbbf3d3b9be554ae391", "html_url": "https://github.com/rust-lang/rust/commit/ac49e656111cdd1727988bbbf3d3b9be554ae391", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ac49e656111cdd1727988bbbf3d3b9be554ae391/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cd656c74f67a289bb14c7758847a0fdd2e61d9a1", "url": "https://api.github.com/repos/rust-lang/rust/commits/cd656c74f67a289bb14c7758847a0fdd2e61d9a1", "html_url": "https://github.com/rust-lang/rust/commit/cd656c74f67a289bb14c7758847a0fdd2e61d9a1"}, {"sha": "f3a79cf66722a917a59376b0ad60a0a370c48b8b", "url": "https://api.github.com/repos/rust-lang/rust/commits/f3a79cf66722a917a59376b0ad60a0a370c48b8b", "html_url": "https://github.com/rust-lang/rust/commit/f3a79cf66722a917a59376b0ad60a0a370c48b8b"}], "stats": {"total": 5, "additions": 2, "deletions": 3}, "files": [{"sha": "cb2d4f8ba2432b5ae0ec588087ebd84fcbd1af2f", "filename": "src/libsyntax/ext/env.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ac49e656111cdd1727988bbbf3d3b9be554ae391/src%2Flibsyntax%2Fext%2Fenv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ac49e656111cdd1727988bbbf3d3b9be554ae391/src%2Flibsyntax%2Fext%2Fenv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Fenv.rs?ref=ac49e656111cdd1727988bbbf3d3b9be554ae391", "patch": "@@ -27,7 +27,7 @@ pub fn expand_option_env(ext_cx: @ExtCtxt, sp: span, tts: &[ast::token_tree])\n     let var = get_single_str_from_tts(ext_cx, sp, tts, \"option_env!\");\n \n     let e = match os::getenv(var) {\n-      None => quote_expr!(::std::option::None),\n+      None => quote_expr!(::std::option::None::<&'static str>),\n       Some(s) => quote_expr!(::std::option::Some($s))\n     };\n     MRExpr(e)"}, {"sha": "cbf4c36c5df3c9bddf0e082d9445bec8dd1d8064", "filename": "src/test/run-pass/extoption_env-not-defined.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ac49e656111cdd1727988bbbf3d3b9be554ae391/src%2Ftest%2Frun-pass%2Fextoption_env-not-defined.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ac49e656111cdd1727988bbbf3d3b9be554ae391/src%2Ftest%2Frun-pass%2Fextoption_env-not-defined.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fextoption_env-not-defined.rs?ref=ac49e656111cdd1727988bbbf3d3b9be554ae391", "patch": "@@ -9,6 +9,5 @@\n // except according to those terms.\n \n fn main() {\n-    let opt: Option<&'static str> = option_env!(\"__HOPEFULLY_DOESNT_EXIST__\");\n-    assert!(opt.is_none());\n+    assert!(option_env!(\"__HOPEFULLY_DOESNT_EXIST__\").is_none());\n }"}]}