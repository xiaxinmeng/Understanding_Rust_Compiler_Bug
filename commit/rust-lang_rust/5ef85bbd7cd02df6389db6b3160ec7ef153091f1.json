{"sha": "5ef85bbd7cd02df6389db6b3160ec7ef153091f1", "node_id": "C_kwDOAAsO6NoAKDVlZjg1YmJkN2NkMDJkZjYzODlkYjZiMzE2MGVjN2VmMTUzMDkxZjE", "commit": {"author": {"name": "Le\u00f3n Orell Valerian Liehr", "email": "liehr.exchange@gmx.net", "date": "2022-11-08T12:43:03Z"}, "committer": {"name": "Le\u00f3n Orell Valerian Liehr", "email": "liehr.exchange@gmx.net", "date": "2022-11-08T12:44:07Z"}, "message": "Visit attributes of trait impl items during AST validation", "tree": {"sha": "f62dbd64d4c79933102693ae22d5f3d09aa2ad81", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f62dbd64d4c79933102693ae22d5f3d09aa2ad81"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5ef85bbd7cd02df6389db6b3160ec7ef153091f1", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE/neO4LLiv/pSFQJbzXXjHOLP19kFAmNqTxgACgkQzXXjHOLP\n19mWLQ//fixb2QLQ2wyOdEC857+Dl4dwEIsFL8xpgAiHu6srop4Mek5p3HxHZsiY\nC9oIdbBarV971gvTBLr/whu89zEx+TiMzPA/8kZuDeU9foyIJ71tHsKCRHRjacnH\ntHWeDvWgykOj/PIr+7ypfrddrODgE1M82Wq9rG7poPxNU2XnxNYJtSSHVXMhtTMT\nILHxWMps3vRvqiVT1es1jjFtUlrrMEChFdYaj/vZ0pTZPqWk3qB4PkZ0aOhZT9Ex\n73Gqn+8SHGQIpBWnbo1WF+tmIv8zmJUPgRPRQRuJq9nhj4O2sSCxslLdC8/1oNsD\nHjqZhuFy3wRWkuwADRz+kCwoVJqjb7zAQYSVp0popKJpIJQGyyfMdDGY1cBf4oKK\nMW5UhlagW6nSaZRxZkkdKsjgyjk4vTDF+8pWyTfEob5HB7fZ94FUodKEJcuvnobc\nX8C45i5kkiWd3X/Q604u7ZHV3KZS7DBkSQIecYVBUMiB6T/6z1aMRl7WplHNWG59\nlkeWgolv+T3mpFz9TkNb0rNNSHyws97UZyi9IrvhqOe0oHA8zciK4awEY2V/Od0a\n0nms2KMk3Le+6OuyJTvEMZ/MQqYFv2SjzcZ5OpUh9Zg0wkPk3IoupMvMvTRnYyu2\n+r+0xFfy2YN3ww/C1zJXgNsdTb+hgbWUOs34PtoniYP9fWZhd74=\n=kQDM\n-----END PGP SIGNATURE-----", "payload": "tree f62dbd64d4c79933102693ae22d5f3d09aa2ad81\nparent 6b23a7e87fc60f6cc43c8cfb69169f2eecefaf14\nauthor Le\u00f3n Orell Valerian Liehr <liehr.exchange@gmx.net> 1667911383 +0100\ncommitter Le\u00f3n Orell Valerian Liehr <liehr.exchange@gmx.net> 1667911447 +0100\n\nVisit attributes of trait impl items during AST validation\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5ef85bbd7cd02df6389db6b3160ec7ef153091f1", "html_url": "https://github.com/rust-lang/rust/commit/5ef85bbd7cd02df6389db6b3160ec7ef153091f1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5ef85bbd7cd02df6389db6b3160ec7ef153091f1/comments", "author": {"login": "fmease", "id": 14913065, "node_id": "MDQ6VXNlcjE0OTEzMDY1", "avatar_url": "https://avatars.githubusercontent.com/u/14913065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmease", "html_url": "https://github.com/fmease", "followers_url": "https://api.github.com/users/fmease/followers", "following_url": "https://api.github.com/users/fmease/following{/other_user}", "gists_url": "https://api.github.com/users/fmease/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmease/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmease/subscriptions", "organizations_url": "https://api.github.com/users/fmease/orgs", "repos_url": "https://api.github.com/users/fmease/repos", "events_url": "https://api.github.com/users/fmease/events{/privacy}", "received_events_url": "https://api.github.com/users/fmease/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fmease", "id": 14913065, "node_id": "MDQ6VXNlcjE0OTEzMDY1", "avatar_url": "https://avatars.githubusercontent.com/u/14913065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmease", "html_url": "https://github.com/fmease", "followers_url": "https://api.github.com/users/fmease/followers", "following_url": "https://api.github.com/users/fmease/following{/other_user}", "gists_url": "https://api.github.com/users/fmease/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmease/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmease/subscriptions", "organizations_url": "https://api.github.com/users/fmease/orgs", "repos_url": "https://api.github.com/users/fmease/repos", "events_url": "https://api.github.com/users/fmease/events{/privacy}", "received_events_url": "https://api.github.com/users/fmease/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6b23a7e87fc60f6cc43c8cfb69169f2eecefaf14", "url": "https://api.github.com/repos/rust-lang/rust/commits/6b23a7e87fc60f6cc43c8cfb69169f2eecefaf14", "html_url": "https://github.com/rust-lang/rust/commit/6b23a7e87fc60f6cc43c8cfb69169f2eecefaf14"}], "stats": {"total": 26, "additions": 25, "deletions": 1}, "files": [{"sha": "712fb5ac71f976c80ce84d9e06a996762fab9921", "filename": "compiler/rustc_ast_passes/src/ast_validation.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/5ef85bbd7cd02df6389db6b3160ec7ef153091f1/compiler%2Frustc_ast_passes%2Fsrc%2Fast_validation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ef85bbd7cd02df6389db6b3160ec7ef153091f1/compiler%2Frustc_ast_passes%2Fsrc%2Fast_validation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_passes%2Fsrc%2Fast_validation.rs?ref=5ef85bbd7cd02df6389db6b3160ec7ef153091f1", "patch": "@@ -1051,6 +1051,7 @@ impl<'a> Visitor<'a> for AstValidator<'a> {\n \n                     walk_list!(this, visit_assoc_item, items, AssocCtxt::Impl);\n                 });\n+                walk_list!(self, visit_attribute, &item.attrs);\n                 return; // Avoid visiting again.\n             }\n             ItemKind::Impl(box Impl {\n@@ -1168,7 +1169,7 @@ impl<'a> Visitor<'a> for AstValidator<'a> {\n                 });\n                 walk_list!(self, visit_assoc_item, items, AssocCtxt::Trait);\n                 walk_list!(self, visit_attribute, &item.attrs);\n-                return;\n+                return; // Avoid visiting again\n             }\n             ItemKind::Mod(unsafety, ref mod_kind) => {\n                 if let Unsafe::Yes(span) = unsafety {"}, {"sha": "ade3f727004abe27048784e79c36b2f242bea04b", "filename": "src/test/ui/on-unimplemented/issue-104140.rs", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/5ef85bbd7cd02df6389db6b3160ec7ef153091f1/src%2Ftest%2Fui%2Fon-unimplemented%2Fissue-104140.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ef85bbd7cd02df6389db6b3160ec7ef153091f1/src%2Ftest%2Fui%2Fon-unimplemented%2Fissue-104140.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fon-unimplemented%2Fissue-104140.rs?ref=5ef85bbd7cd02df6389db6b3160ec7ef153091f1", "patch": "@@ -0,0 +1,8 @@\n+#![feature(rustc_attrs)]\n+\n+trait Foo {}\n+\n+#[rustc_on_unimplemented] //~ ERROR malformed `rustc_on_unimplemented` attribute input\n+impl Foo for u32 {}\n+\n+fn main() {}"}, {"sha": "ddb1f50f0bb45c850e49cad57efdf799f3aa0266", "filename": "src/test/ui/on-unimplemented/issue-104140.stderr", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/5ef85bbd7cd02df6389db6b3160ec7ef153091f1/src%2Ftest%2Fui%2Fon-unimplemented%2Fissue-104140.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5ef85bbd7cd02df6389db6b3160ec7ef153091f1/src%2Ftest%2Fui%2Fon-unimplemented%2Fissue-104140.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fon-unimplemented%2Fissue-104140.stderr?ref=5ef85bbd7cd02df6389db6b3160ec7ef153091f1", "patch": "@@ -0,0 +1,15 @@\n+error: malformed `rustc_on_unimplemented` attribute input\n+  --> $DIR/issue-104140.rs:5:1\n+   |\n+LL | #[rustc_on_unimplemented]\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+help: the following are the possible correct uses\n+   |\n+LL | #[rustc_on_unimplemented = \"message\"]\n+   | ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+LL | #[rustc_on_unimplemented(/*opt*/ message = \"...\", /*opt*/ label = \"...\", /*opt*/ note = \"...\")]\n+   | ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+error: aborting due to previous error\n+"}]}