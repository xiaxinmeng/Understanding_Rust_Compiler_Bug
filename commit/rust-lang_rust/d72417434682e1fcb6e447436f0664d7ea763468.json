{"sha": "d72417434682e1fcb6e447436f0664d7ea763468", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ3MjQxNzQzNDY4MmUxZmNiNmU0NDc0MzZmMDY2NGQ3ZWE3NjM0Njg=", "commit": {"author": {"name": "Matthew Jasper", "email": "mjjasper1@gmail.com", "date": "2019-10-20T21:08:44Z"}, "committer": {"name": "Matthew Jasper", "email": "mjjasper1@gmail.com", "date": "2019-10-24T20:15:08Z"}, "message": "Fix more `ReEmpty` ICEs", "tree": {"sha": "1025f71ba35a49e55e303643b48e8c265ca3e8c9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1025f71ba35a49e55e303643b48e8c265ca3e8c9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d72417434682e1fcb6e447436f0664d7ea763468", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d72417434682e1fcb6e447436f0664d7ea763468", "html_url": "https://github.com/rust-lang/rust/commit/d72417434682e1fcb6e447436f0664d7ea763468", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d72417434682e1fcb6e447436f0664d7ea763468/comments", "author": {"login": "matthewjasper", "id": 20113453, "node_id": "MDQ6VXNlcjIwMTEzNDUz", "avatar_url": "https://avatars.githubusercontent.com/u/20113453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthewjasper", "html_url": "https://github.com/matthewjasper", "followers_url": "https://api.github.com/users/matthewjasper/followers", "following_url": "https://api.github.com/users/matthewjasper/following{/other_user}", "gists_url": "https://api.github.com/users/matthewjasper/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthewjasper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthewjasper/subscriptions", "organizations_url": "https://api.github.com/users/matthewjasper/orgs", "repos_url": "https://api.github.com/users/matthewjasper/repos", "events_url": "https://api.github.com/users/matthewjasper/events{/privacy}", "received_events_url": "https://api.github.com/users/matthewjasper/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matthewjasper", "id": 20113453, "node_id": "MDQ6VXNlcjIwMTEzNDUz", "avatar_url": "https://avatars.githubusercontent.com/u/20113453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthewjasper", "html_url": "https://github.com/matthewjasper", "followers_url": "https://api.github.com/users/matthewjasper/followers", "following_url": "https://api.github.com/users/matthewjasper/following{/other_user}", "gists_url": "https://api.github.com/users/matthewjasper/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthewjasper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthewjasper/subscriptions", "organizations_url": "https://api.github.com/users/matthewjasper/orgs", "repos_url": "https://api.github.com/users/matthewjasper/repos", "events_url": "https://api.github.com/users/matthewjasper/events{/privacy}", "received_events_url": "https://api.github.com/users/matthewjasper/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "89e645ace853d86e8c0002247482eac9073c90fd", "url": "https://api.github.com/repos/rust-lang/rust/commits/89e645ace853d86e8c0002247482eac9073c90fd", "html_url": "https://github.com/rust-lang/rust/commit/89e645ace853d86e8c0002247482eac9073c90fd"}], "stats": {"total": 28, "additions": 26, "deletions": 2}, "files": [{"sha": "34ac96beb5ca35531a1017b1b7fe7005f5578172", "filename": "src/librustc_mir/borrow_check/nll/type_check/constraint_conversion.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d72417434682e1fcb6e447436f0664d7ea763468/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Ftype_check%2Fconstraint_conversion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d72417434682e1fcb6e447436f0664d7ea763468/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Ftype_check%2Fconstraint_conversion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Ftype_check%2Fconstraint_conversion.rs?ref=d72417434682e1fcb6e447436f0664d7ea763468", "patch": "@@ -178,6 +178,9 @@ impl<'a, 'b, 'tcx> TypeOutlivesDelegate<'tcx> for &'a mut ConstraintConversion<'\n         a: ty::Region<'tcx>,\n         b: ty::Region<'tcx>,\n     ) {\n+        if let ty::ReEmpty = a {\n+            return;\n+        }\n         let b = self.to_region_vid(b);\n         let a = self.to_region_vid(a);\n         self.add_outlives(b, a);\n@@ -190,6 +193,9 @@ impl<'a, 'b, 'tcx> TypeOutlivesDelegate<'tcx> for &'a mut ConstraintConversion<'\n         a: ty::Region<'tcx>,\n         bound: VerifyBound<'tcx>,\n     ) {\n+        if let ty::ReEmpty = a {\n+            return;\n+        }\n         let type_test = self.verify_to_type_test(kind, a, bound);\n         self.add_type_test(type_test);\n     }"}, {"sha": "20d6e47f75300cab5fa2405fa1b7866982a116db", "filename": "src/test/ui/nll/empty-type-predicate-2.rs", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/d72417434682e1fcb6e447436f0664d7ea763468/src%2Ftest%2Fui%2Fnll%2Fempty-type-predicate-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d72417434682e1fcb6e447436f0664d7ea763468/src%2Ftest%2Fui%2Fnll%2Fempty-type-predicate-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnll%2Fempty-type-predicate-2.rs?ref=d72417434682e1fcb6e447436f0664d7ea763468", "patch": "@@ -0,0 +1,18 @@\n+// Regression test for #65553\n+//\n+// `D::Error:` is lowered to `D::Error: ReEmpty` - check that we don't ICE in\n+// NLL for the unexpected region.\n+\n+// check-pass\n+\n+trait Deserializer {\n+    type Error;\n+}\n+\n+fn d1<D: Deserializer>() where D::Error: {}\n+\n+fn d2<D: Deserializer>() {\n+    d1::<D>();\n+}\n+\n+fn main() {}"}, {"sha": "d126a455daeb204e77f11ff63139de60378bdd99", "filename": "src/test/ui/nll/empty-type-predicate.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d72417434682e1fcb6e447436f0664d7ea763468/src%2Ftest%2Fui%2Fnll%2Fempty-type-predicate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d72417434682e1fcb6e447436f0664d7ea763468/src%2Ftest%2Fui%2Fnll%2Fempty-type-predicate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnll%2Fempty-type-predicate.rs?ref=d72417434682e1fcb6e447436f0664d7ea763468", "patch": "@@ -3,9 +3,9 @@\n // `dyn T:` is lowered to `dyn T: ReEmpty` - check that we don't ICE in NLL for\n // the unexpected region.\n \n-// build-pass (FIXME(62277): could be check-pass?)\n+// check-pass\n \n trait T {}\n fn f() where dyn T: {}\n \n-fn main() {}\n+fn main() { f(); }"}]}