{"sha": "54119d443600d01b70c22d5c472aff60f1fee530", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU0MTE5ZDQ0MzYwMGQwMWI3MGMyMmQ1YzQ3MmFmZjYwZjFmZWU1MzA=", "commit": {"author": {"name": "Yuki Okushi", "email": "huyuumi.dev@gmail.com", "date": "2020-12-13T02:05:40Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-12-13T02:05:40Z"}, "message": "Rollup merge of #79954 - jyn514:normalize-oops, r=Mark-Simulacrum\n\nFix building compiler docs with stage 0\n\nThis regressed in https://github.com/rust-lang/rust/pull/79525 (see https://rust-lang.zulipchat.com/#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20single.20crate).\n\nr? `@Mark-Simulacrum`", "tree": {"sha": "8114f54d30e8080fe8af059a06922b612d3ca08e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8114f54d30e8080fe8af059a06922b612d3ca08e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/54119d443600d01b70c22d5c472aff60f1fee530", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJf1Xb0CRBK7hj4Ov3rIwAAdHIIADXHmq+vIXRvJo1ThvqPL8iD\ntab5JVOvtSkZEMkefEZqeyrtaifr/Lc+WYJGqtURFdVDukO/P8V44DHgR7EuxAYL\npmdQN7TBijMEwZxcWjM3GbINu3UuC7uOHH6SJ4Ygpp6o/FMDCb2Z5A5f+OM85ruI\ntBnU1ZGArcxsCmmdH8Deq0jZ+waT4VljZb8gr966pOIaiJrd7fiZ38P+3Rk2it92\noV0aAv69jyIQ3Sml1bqJg6WmfzIh6jFneGO4UEsM0OUf+tGMRJTJyWiZ1KltDdHw\nsX/VQSGpO9zQOKfzAsFwjRTZDSntHpBq+odjvFGKEbBm9D1NfeaG1EDOWUjxAlk=\n=jxwn\n-----END PGP SIGNATURE-----\n", "payload": "tree 8114f54d30e8080fe8af059a06922b612d3ca08e\nparent 2b43980ef44fe7394c1e800a0d93e82d05c47555\nparent 9df0348299df0a0ceeefd587700cabea6adc2d53\nauthor Yuki Okushi <huyuumi.dev@gmail.com> 1607825140 +0900\ncommitter GitHub <noreply@github.com> 1607825140 +0900\n\nRollup merge of #79954 - jyn514:normalize-oops, r=Mark-Simulacrum\n\nFix building compiler docs with stage 0\n\nThis regressed in https://github.com/rust-lang/rust/pull/79525 (see https://rust-lang.zulipchat.com/#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20single.20crate).\n\nr? `@Mark-Simulacrum`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/54119d443600d01b70c22d5c472aff60f1fee530", "html_url": "https://github.com/rust-lang/rust/commit/54119d443600d01b70c22d5c472aff60f1fee530", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/54119d443600d01b70c22d5c472aff60f1fee530/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2b43980ef44fe7394c1e800a0d93e82d05c47555", "url": "https://api.github.com/repos/rust-lang/rust/commits/2b43980ef44fe7394c1e800a0d93e82d05c47555", "html_url": "https://github.com/rust-lang/rust/commit/2b43980ef44fe7394c1e800a0d93e82d05c47555"}, {"sha": "9df0348299df0a0ceeefd587700cabea6adc2d53", "url": "https://api.github.com/repos/rust-lang/rust/commits/9df0348299df0a0ceeefd587700cabea6adc2d53", "html_url": "https://github.com/rust-lang/rust/commit/9df0348299df0a0ceeefd587700cabea6adc2d53"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "9af79e20630dffc081c868b0b6731242d4ffbae0", "filename": "src/bootstrap/builder.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/54119d443600d01b70c22d5c472aff60f1fee530/src%2Fbootstrap%2Fbuilder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54119d443600d01b70c22d5c472aff60f1fee530/src%2Fbootstrap%2Fbuilder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbuilder.rs?ref=54119d443600d01b70c22d5c472aff60f1fee530", "patch": "@@ -732,11 +732,14 @@ impl<'a> Builder<'a> {\n             .env(\"CFG_RELEASE_CHANNEL\", &self.config.channel)\n             .env(\"RUSTDOC_REAL\", self.rustdoc(compiler))\n             .env(\"RUSTC_BOOTSTRAP\", \"1\")\n-            .arg(\"-Znormalize_docs\")\n             .arg(\"-Winvalid_codeblock_attributes\");\n         if self.config.deny_warnings {\n             cmd.arg(\"-Dwarnings\");\n         }\n+        // cfg(not(bootstrap)), can be removed on the next beta bump\n+        if compiler.stage != 0 {\n+            cmd.arg(\"-Znormalize-docs\");\n+        }\n \n         // Remove make-related flags that can cause jobserver problems.\n         cmd.env_remove(\"MAKEFLAGS\");"}, {"sha": "8cacc2512eff130ad030423180ba7f7acc46a062", "filename": "src/bootstrap/doc.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/54119d443600d01b70c22d5c472aff60f1fee530/src%2Fbootstrap%2Fdoc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54119d443600d01b70c22d5c472aff60f1fee530/src%2Fbootstrap%2Fdoc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdoc.rs?ref=54119d443600d01b70c22d5c472aff60f1fee530", "patch": "@@ -527,7 +527,10 @@ impl Step for Rustc {\n         cargo.rustdocflag(\"--document-private-items\");\n         cargo.rustdocflag(\"--enable-index-page\");\n         cargo.rustdocflag(\"-Zunstable-options\");\n-        cargo.rustdocflag(\"-Znormalize-docs\");\n+        // cfg(not(bootstrap)), can be removed on the next beta bump\n+        if stage != 0 {\n+            cargo.rustdocflag(\"-Znormalize-docs\");\n+        }\n         compile::rustc_cargo(builder, &mut cargo, target);\n \n         // Only include compiler crates, no dependencies of those, such as `libc`."}]}