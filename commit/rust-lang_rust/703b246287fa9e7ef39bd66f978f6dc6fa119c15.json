{"sha": "703b246287fa9e7ef39bd66f978f6dc6fa119c15", "node_id": "MDY6Q29tbWl0NzI0NzEyOjcwM2IyNDYyODdmYTllN2VmMzliZDY2Zjk3OGY2ZGM2ZmExMTljMTU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-03-18T00:40:10Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-03-18T00:40:10Z"}, "message": "Auto merge of #40482 - wagenet:fix-old-macos, r=alexcrichton\n\nTarget builds for older macOS\n\nFix #40481", "tree": {"sha": "55e444585a92024caf0f87d5b44e6061fc3590f3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/55e444585a92024caf0f87d5b44e6061fc3590f3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/703b246287fa9e7ef39bd66f978f6dc6fa119c15", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/703b246287fa9e7ef39bd66f978f6dc6fa119c15", "html_url": "https://github.com/rust-lang/rust/commit/703b246287fa9e7ef39bd66f978f6dc6fa119c15", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/703b246287fa9e7ef39bd66f978f6dc6fa119c15/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a559452b05c20041a27f518d262573c56b876b64", "url": "https://api.github.com/repos/rust-lang/rust/commits/a559452b05c20041a27f518d262573c56b876b64", "html_url": "https://github.com/rust-lang/rust/commit/a559452b05c20041a27f518d262573c56b876b64"}, {"sha": "61d93877b70cfb9cab974ef2fb3c60d9cb50f72f", "url": "https://api.github.com/repos/rust-lang/rust/commits/61d93877b70cfb9cab974ef2fb3c60d9cb50f72f", "html_url": "https://github.com/rust-lang/rust/commit/61d93877b70cfb9cab974ef2fb3c60d9cb50f72f"}], "stats": {"total": 19, "additions": 19, "deletions": 0}, "files": [{"sha": "fb9e2136f1b09fc4faaf7505ca6b6762408b48a1", "filename": ".travis.yml", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/703b246287fa9e7ef39bd66f978f6dc6fa119c15/.travis.yml", "raw_url": "https://github.com/rust-lang/rust/raw/703b246287fa9e7ef39bd66f978f6dc6fa119c15/.travis.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.travis.yml?ref=703b246287fa9e7ef39bd66f978f6dc6fa119c15", "patch": "@@ -48,6 +48,8 @@ matrix:\n         RUSTC_RETRY_LINKER_ON_SEGFAULT=1\n         SCCACHE_ERROR_LOG=/tmp/sccache.log\n         RUST_LOG=sccache=debug\n+        MACOSX_DEPLOYMENT_TARGET=10.8\n+        MACOSX_STD_DEPLOYMENT_TARGET=10.7\n       os: osx\n       osx_image: xcode8.2\n       install: &osx_install_sccache >\n@@ -60,6 +62,8 @@ matrix:\n         RUSTC_RETRY_LINKER_ON_SEGFAULT=1\n         SCCACHE_ERROR_LOG=/tmp/sccache.log\n         RUST_LOG=sccache=debug\n+        MACOSX_DEPLOYMENT_TARGET=10.8\n+        MACOSX_STD_DEPLOYMENT_TARGET=10.7\n       os: osx\n       osx_image: xcode8.2\n       install: *osx_install_sccache\n@@ -72,6 +76,8 @@ matrix:\n         RUSTC_RETRY_LINKER_ON_SEGFAULT=1\n         SCCACHE_ERROR_LOG=/tmp/sccache.log\n         RUST_LOG=sccache=debug\n+        MACOSX_DEPLOYMENT_TARGET=10.8\n+        MACOSX_STD_DEPLOYMENT_TARGET=10.7\n       os: osx\n       osx_image: xcode8.2\n       install: >\n@@ -85,6 +91,8 @@ matrix:\n         RUSTC_RETRY_LINKER_ON_SEGFAULT=1\n         SCCACHE_ERROR_LOG=/tmp/sccache.log\n         RUST_LOG=sccache=debug\n+        MACOSX_DEPLOYMENT_TARGET=10.8\n+        MACOSX_STD_DEPLOYMENT_TARGET=10.7\n       os: osx\n       osx_image: xcode8.2\n       install: *osx_install_sccache\n@@ -102,6 +110,8 @@ matrix:\n         RUSTC_RETRY_LINKER_ON_SEGFAULT=1\n         SCCACHE_ERROR_LOG=/tmp/sccache.log\n         RUST_LOG=sccache=debug\n+        MACOSX_DEPLOYMENT_TARGET=10.8\n+        MACOSX_STD_DEPLOYMENT_TARGET=10.7\n       os: osx\n       osx_image: xcode8.2\n       install: *osx_install_sccache"}, {"sha": "eeec7eb029e5c054590f04415afc7a741e8a2ed6", "filename": "src/bootstrap/compile.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/703b246287fa9e7ef39bd66f978f6dc6fa119c15/src%2Fbootstrap%2Fcompile.rs", "raw_url": "https://github.com/rust-lang/rust/raw/703b246287fa9e7ef39bd66f978f6dc6fa119c15/src%2Fbootstrap%2Fcompile.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fcompile.rs?ref=703b246287fa9e7ef39bd66f978f6dc6fa119c15", "patch": "@@ -20,6 +20,7 @@ use std::collections::HashMap;\n use std::fs::{self, File};\n use std::path::{Path, PathBuf};\n use std::process::Command;\n+use std::env;\n \n use build_helper::{output, mtime, up_to_date};\n use filetime::FileTime;\n@@ -44,6 +45,11 @@ pub fn std(build: &Build, target: &str, compiler: &Compiler) {\n     build.clear_if_dirty(&out_dir, &build.compiler_path(compiler));\n     let mut cargo = build.cargo(compiler, Mode::Libstd, target, \"build\");\n     let mut features = build.std_features();\n+\n+    if let Ok(target) = env::var(\"MACOSX_STD_DEPLOYMENT_TARGET\") {\n+        cargo.env(\"MACOSX_DEPLOYMENT_TARGET\", target);\n+    }\n+\n     // When doing a local rebuild we tell cargo that we're stage1 rather than\n     // stage0. This works fine if the local rust and being-built rust have the\n     // same view of what the default allocator is, but fails otherwise. Since\n@@ -170,6 +176,9 @@ pub fn test(build: &Build, target: &str, compiler: &Compiler) {\n     let out_dir = build.cargo_out(compiler, Mode::Libtest, target);\n     build.clear_if_dirty(&out_dir, &libstd_stamp(build, compiler, target));\n     let mut cargo = build.cargo(compiler, Mode::Libtest, target, \"build\");\n+    if let Ok(target) = env::var(\"MACOSX_STD_DEPLOYMENT_TARGET\") {\n+        cargo.env(\"MACOSX_DEPLOYMENT_TARGET\", target);\n+    }\n     cargo.arg(\"--manifest-path\")\n          .arg(build.src.join(\"src/libtest/Cargo.toml\"));\n     build.run(&mut cargo);"}]}