{"sha": "f16fed18b3587637f4e50ac03aecdbc6f0e8d1fa", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYxNmZlZDE4YjM1ODc2MzdmNGU1MGFjMDNhZWNkYmM2ZjBlOGQxZmE=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2017-12-31T17:37:34Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2017-12-31T17:37:34Z"}, "message": "Wow, it is possible to implement Index for Vec!", "tree": {"sha": "d3aa6b9286055f26b1c331dee6451837c3b823d5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d3aa6b9286055f26b1c331dee6451837c3b823d5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f16fed18b3587637f4e50ac03aecdbc6f0e8d1fa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f16fed18b3587637f4e50ac03aecdbc6f0e8d1fa", "html_url": "https://github.com/rust-lang/rust/commit/f16fed18b3587637f4e50ac03aecdbc6f0e8d1fa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f16fed18b3587637f4e50ac03aecdbc6f0e8d1fa/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9e4c28820146ccaf29ecbce9802aeba80183851a", "url": "https://api.github.com/repos/rust-lang/rust/commits/9e4c28820146ccaf29ecbce9802aeba80183851a", "html_url": "https://github.com/rust-lang/rust/commit/9e4c28820146ccaf29ecbce9802aeba80183851a"}], "stats": {"total": 26, "additions": 20, "deletions": 6}, "files": [{"sha": "430303ce932bf6abe58d83aabf45d2b60369e556", "filename": "src/tree/file_builder.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/f16fed18b3587637f4e50ac03aecdbc6f0e8d1fa/src%2Ftree%2Ffile_builder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f16fed18b3587637f4e50ac03aecdbc6f0e8d1fa/src%2Ftree%2Ffile_builder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftree%2Ffile_builder.rs?ref=f16fed18b3587637f4e50ac03aecdbc6f0e8d1fa", "patch": "@@ -81,7 +81,7 @@ impl FileBuilder {\n     }\n \n     fn add_len(&mut self, child: NodeIdx) {\n-        let range = self.nodes[child.0 as usize].range;\n+        let range = self.nodes[child].range;\n         grow(&mut self.current_parent().range, range);\n     }\n \n@@ -90,13 +90,13 @@ impl FileBuilder {\n     }\n \n     fn current_parent(&mut self) -> &mut NodeData {\n-        let NodeIdx(idx) = self.current_id();\n-        &mut self.nodes[idx as usize]\n+        let idx = self.current_id();\n+        &mut self.nodes[idx]\n     }\n \n     fn current_sibling(&mut self) -> Option<&mut NodeData> {\n-        let NodeIdx(idx) = self.in_progress.last().unwrap().1?;\n-        Some(&mut self.nodes[idx as usize])\n+        let idx = self.in_progress.last().unwrap().1?;\n+        Some(&mut self.nodes[idx])\n     }\n }\n "}, {"sha": "7c4162a682efef42137aeccab568dc8cb517c32b", "filename": "src/tree/mod.rs", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/f16fed18b3587637f4e50ac03aecdbc6f0e8d1fa/src%2Ftree%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f16fed18b3587637f4e50ac03aecdbc6f0e8d1fa/src%2Ftree%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftree%2Fmod.rs?ref=f16fed18b3587637f4e50ac03aecdbc6f0e8d1fa", "patch": "@@ -70,7 +70,7 @@ impl<'f> Node<'f> {\n \t}\n \n \tfn data(&self) -> &'f NodeData {\n-\t\t&self.file.nodes[self.idx.0 as usize]\n+\t\t&self.file.nodes[self.idx]\n \t}\n \n \tfn as_node(&self, idx: Option<NodeIdx>) -> Option<Node<'f>> {\n@@ -102,3 +102,17 @@ struct NodeData {\n \tfirst_child: Option<NodeIdx>,\n \tnext_sibling: Option<NodeIdx>,\n }\n+\n+impl ::std::ops::Index<NodeIdx> for Vec<NodeData> {\n+\ttype Output = NodeData;\n+\n+\tfn index(&self, NodeIdx(idx): NodeIdx) -> &NodeData {\n+\t\t&self[idx as usize]\n+\t}\n+}\n+\n+impl ::std::ops::IndexMut<NodeIdx> for Vec<NodeData> {\n+\tfn index_mut(&mut self, NodeIdx(idx): NodeIdx) -> &mut NodeData {\n+\t\t&mut self[idx as usize]\n+\t}\n+}\n\\ No newline at end of file"}]}