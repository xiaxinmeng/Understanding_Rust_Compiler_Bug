{"sha": "b12b65c1b7f77bfd6b4155cc290b1654c09ef709", "node_id": "C_kwDOAAsO6NoAKGIxMmI2NWMxYjdmNzdiZmQ2YjQxNTVjYzI5MGIxNjU0YzA5ZWY3MDk", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-09-13T13:23:54Z"}, "committer": {"name": "R\u00e9my Rakic", "email": "remy.rakic+github@gmail.com", "date": "2022-10-20T22:44:10Z"}, "message": "Add missing @local_only on attributes", "tree": {"sha": "4799b9aabc7f35da53e3a12893434ef4972dd135", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4799b9aabc7f35da53e3a12893434ef4972dd135"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b12b65c1b7f77bfd6b4155cc290b1654c09ef709", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b12b65c1b7f77bfd6b4155cc290b1654c09ef709", "html_url": "https://github.com/rust-lang/rust/commit/b12b65c1b7f77bfd6b4155cc290b1654c09ef709", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b12b65c1b7f77bfd6b4155cc290b1654c09ef709/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lqd", "id": 247183, "node_id": "MDQ6VXNlcjI0NzE4Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/247183?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lqd", "html_url": "https://github.com/lqd", "followers_url": "https://api.github.com/users/lqd/followers", "following_url": "https://api.github.com/users/lqd/following{/other_user}", "gists_url": "https://api.github.com/users/lqd/gists{/gist_id}", "starred_url": "https://api.github.com/users/lqd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lqd/subscriptions", "organizations_url": "https://api.github.com/users/lqd/orgs", "repos_url": "https://api.github.com/users/lqd/repos", "events_url": "https://api.github.com/users/lqd/events{/privacy}", "received_events_url": "https://api.github.com/users/lqd/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5ffa67d7309047ff47b9c624ba4061fb8c004c31", "url": "https://api.github.com/repos/rust-lang/rust/commits/5ffa67d7309047ff47b9c624ba4061fb8c004c31", "html_url": "https://github.com/rust-lang/rust/commit/5ffa67d7309047ff47b9c624ba4061fb8c004c31"}], "stats": {"total": 34, "additions": 24, "deletions": 10}, "files": [{"sha": "94546aba0291d6a69bcc86e0dca91744d0e0a3e9", "filename": "compiler/rustc_feature/src/builtin_attrs.rs", "status": "modified", "additions": 24, "deletions": 10, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/b12b65c1b7f77bfd6b4155cc290b1654c09ef709/compiler%2Frustc_feature%2Fsrc%2Fbuiltin_attrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b12b65c1b7f77bfd6b4155cc290b1654c09ef709/compiler%2Frustc_feature%2Fsrc%2Fbuiltin_attrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Fbuiltin_attrs.rs?ref=b12b65c1b7f77bfd6b4155cc290b1654c09ef709", "patch": "@@ -296,20 +296,24 @@ pub const BUILTIN_ATTRIBUTES: &[BuiltinAttribute] = &[\n \n     // Lints:\n     ungated!(\n-        warn, Normal, template!(List: r#\"lint1, lint2, ..., /*opt*/ reason = \"...\"\"#), DuplicatesOk\n+        warn, Normal, template!(List: r#\"lint1, lint2, ..., /*opt*/ reason = \"...\"\"#),\n+        DuplicatesOk, @only_local: true,\n     ),\n     ungated!(\n-        allow, Normal, template!(List: r#\"lint1, lint2, ..., /*opt*/ reason = \"...\"\"#), DuplicatesOk\n+        allow, Normal, template!(List: r#\"lint1, lint2, ..., /*opt*/ reason = \"...\"\"#),\n+        DuplicatesOk, @only_local: true,\n     ),\n     gated!(\n         expect, Normal, template!(List: r#\"lint1, lint2, ..., /*opt*/ reason = \"...\"\"#), DuplicatesOk,\n         lint_reasons, experimental!(expect)\n     ),\n     ungated!(\n-        forbid, Normal, template!(List: r#\"lint1, lint2, ..., /*opt*/ reason = \"...\"\"#), DuplicatesOk\n+        forbid, Normal, template!(List: r#\"lint1, lint2, ..., /*opt*/ reason = \"...\"\"#),\n+        DuplicatesOk, @only_local: true,\n     ),\n     ungated!(\n-        deny, Normal, template!(List: r#\"lint1, lint2, ..., /*opt*/ reason = \"...\"\"#), DuplicatesOk\n+        deny, Normal, template!(List: r#\"lint1, lint2, ..., /*opt*/ reason = \"...\"\"#),\n+        DuplicatesOk, @only_local: true,\n     ),\n     ungated!(must_use, Normal, template!(Word, NameValueStr: \"reason\"), FutureWarnFollowing),\n     gated!(\n@@ -340,7 +344,7 @@ pub const BUILTIN_ATTRIBUTES: &[BuiltinAttribute] = &[\n     ),\n     ungated!(link_name, Normal, template!(NameValueStr: \"name\"), FutureWarnPreceding),\n     ungated!(no_link, Normal, template!(Word), WarnFollowing),\n-    ungated!(repr, Normal, template!(List: \"C\"), DuplicatesOk),\n+    ungated!(repr, Normal, template!(List: \"C\"), DuplicatesOk, @only_local: true),\n     ungated!(export_name, Normal, template!(NameValueStr: \"name\"), FutureWarnPreceding),\n     ungated!(link_section, Normal, template!(NameValueStr: \"name\"), FutureWarnPreceding),\n     ungated!(no_mangle, Normal, template!(Word), WarnFollowing, @only_local: true),\n@@ -382,7 +386,10 @@ pub const BUILTIN_ATTRIBUTES: &[BuiltinAttribute] = &[\n     ungated!(inline, Normal, template!(Word, List: \"always|never\"), FutureWarnFollowing, @only_local: true),\n     ungated!(cold, Normal, template!(Word), WarnFollowing, @only_local: true),\n     ungated!(no_builtins, CrateLevel, template!(Word), WarnFollowing),\n-    ungated!(target_feature, Normal, template!(List: r#\"enable = \"name\"\"#), DuplicatesOk),\n+    ungated!(\n+        target_feature, Normal, template!(List: r#\"enable = \"name\"\"#),\n+        DuplicatesOk, @only_local: true,\n+    ),\n     ungated!(track_caller, Normal, template!(Word), WarnFollowing),\n     gated!(\n         no_sanitize, Normal,\n@@ -488,18 +495,24 @@ pub const BUILTIN_ATTRIBUTES: &[BuiltinAttribute] = &[\n     // Internal attributes: Stability, deprecation, and unsafe:\n     // ==========================================================================\n \n-    ungated!(feature, CrateLevel, template!(List: \"name1, name2, ...\"), DuplicatesOk),\n+    ungated!(\n+        feature, CrateLevel,\n+        template!(List: \"name1, name2, ...\"), DuplicatesOk, @only_local: true,\n+    ),\n     // DuplicatesOk since it has its own validation\n     ungated!(\n-        stable, Normal, template!(List: r#\"feature = \"name\", since = \"version\"\"#), DuplicatesOk,\n+        stable, Normal,\n+        template!(List: r#\"feature = \"name\", since = \"version\"\"#), DuplicatesOk, @only_local: true,\n     ),\n     ungated!(\n         unstable, Normal,\n         template!(List: r#\"feature = \"name\", reason = \"...\", issue = \"N\"\"#), DuplicatesOk,\n     ),\n     ungated!(rustc_const_unstable, Normal, template!(List: r#\"feature = \"name\"\"#), DuplicatesOk),\n-    ungated!(rustc_const_stable, Normal, template!(List: r#\"feature = \"name\"\"#), DuplicatesOk),\n-    ungated!(rustc_safe_intrinsic, Normal, template!(Word), DuplicatesOk),\n+    ungated!(\n+        rustc_const_stable, Normal,\n+        template!(List: r#\"feature = \"name\"\"#), DuplicatesOk, @only_local: true,\n+    ),\n     ungated!(\n         rustc_default_body_unstable, Normal,\n         template!(List: r#\"feature = \"name\", reason = \"...\", issue = \"N\"\"#), DuplicatesOk\n@@ -517,6 +530,7 @@ pub const BUILTIN_ATTRIBUTES: &[BuiltinAttribute] = &[\n         allow_internal_unsafe, Normal, template!(Word), WarnFollowing,\n         \"allow_internal_unsafe side-steps the unsafe_code lint\",\n     ),\n+    ungated!(rustc_safe_intrinsic, Normal, template!(Word), DuplicatesOk),\n     rustc_attr!(rustc_allowed_through_unstable_modules, Normal, template!(Word), WarnFollowing,\n     \"rustc_allowed_through_unstable_modules special cases accidental stabilizations of stable items \\\n     through unstable paths\"),"}]}