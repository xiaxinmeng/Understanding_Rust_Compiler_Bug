{"sha": "2a3c0e34cb5616c336d8c3c4e14701b4df364e60", "node_id": "C_kwDOAAsO6NoAKDJhM2MwZTM0Y2I1NjE2YzMzNmQ4YzNjNGUxNDcwMWI0ZGYzNjRlNjA", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-03-17T23:05:53Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-03-17T23:05:53Z"}, "message": "Rollup merge of #109235 - chaitanyav:master, r=ChrisDenton\n\nfallback to lstat when stat fails on Windows\n\nFixes #109106\n````@ChrisDenton```` please let me know if this is the expected behavior for stat on windows", "tree": {"sha": "6c10ea7db9f894ce9aa9f5a725ba9082e6867e15", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6c10ea7db9f894ce9aa9f5a725ba9082e6867e15"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2a3c0e34cb5616c336d8c3c4e14701b4df364e60", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkFPJRCRBK7hj4Ov3rIwAAZCEIAH1jY+51geqODxW2EMV7RVIz\nTECLFVISFaWz+1BNWc0C7qjrnKWyXEN1etlgkifEU1gwsf0powsQcp8L33sDP6vc\nHY5Zr4xgjLKVGdF9+2GChnJrw5+Wi1ELtR30prhc8EX2ihG88EgIBRg/zXkD2+fd\n8V35DIogE+NrGiKdYxK+aS1YDabnKvMBLieRiZNSy/bkRt5gT2B0VPDr0CyTCsOh\nXKFZ0L5+/ijZjnDqUZ1MdjBwDdff40GK36fielevY732eJhUypBb6BEGWttzxrGU\n9QPk8qIY61ZrlbSy6Vbi64lRCDrGNgb4Ax++7+20iPoLTwpHcoGtXJCszyjij3w=\n=xOVF\n-----END PGP SIGNATURE-----\n", "payload": "tree 6c10ea7db9f894ce9aa9f5a725ba9082e6867e15\nparent dfd2b6493a4a9e44194faa11e4ae30f62d8a403b\nparent 32c589b2363eb96649e5692b4b335777dbeb2f9d\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1679094353 +0100\ncommitter GitHub <noreply@github.com> 1679094353 +0100\n\nRollup merge of #109235 - chaitanyav:master, r=ChrisDenton\n\nfallback to lstat when stat fails on Windows\n\nFixes #109106\n````@ChrisDenton```` please let me know if this is the expected behavior for stat on windows\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2a3c0e34cb5616c336d8c3c4e14701b4df364e60", "html_url": "https://github.com/rust-lang/rust/commit/2a3c0e34cb5616c336d8c3c4e14701b4df364e60", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2a3c0e34cb5616c336d8c3c4e14701b4df364e60/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dfd2b6493a4a9e44194faa11e4ae30f62d8a403b", "url": "https://api.github.com/repos/rust-lang/rust/commits/dfd2b6493a4a9e44194faa11e4ae30f62d8a403b", "html_url": "https://github.com/rust-lang/rust/commit/dfd2b6493a4a9e44194faa11e4ae30f62d8a403b"}, {"sha": "32c589b2363eb96649e5692b4b335777dbeb2f9d", "url": "https://api.github.com/repos/rust-lang/rust/commits/32c589b2363eb96649e5692b4b335777dbeb2f9d", "html_url": "https://github.com/rust-lang/rust/commit/32c589b2363eb96649e5692b4b335777dbeb2f9d"}], "stats": {"total": 12, "additions": 11, "deletions": 1}, "files": [{"sha": "373157bd9e836534bf06f1d49c08701bb33b9b31", "filename": "library/std/src/sys/windows/fs.rs", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/2a3c0e34cb5616c336d8c3c4e14701b4df364e60/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2a3c0e34cb5616c336d8c3c4e14701b4df364e60/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Ffs.rs?ref=2a3c0e34cb5616c336d8c3c4e14701b4df364e60", "patch": "@@ -1236,7 +1236,17 @@ pub fn link(_original: &Path, _link: &Path) -> io::Result<()> {\n }\n \n pub fn stat(path: &Path) -> io::Result<FileAttr> {\n-    metadata(path, ReparsePoint::Follow)\n+    match metadata(path, ReparsePoint::Follow) {\n+        Err(err) if err.raw_os_error() == Some(c::ERROR_CANT_ACCESS_FILE as i32) => {\n+            if let Ok(attrs) = lstat(path) {\n+                if !attrs.file_type().is_symlink() {\n+                    return Ok(attrs);\n+                }\n+            }\n+            Err(err)\n+        }\n+        result => result,\n+    }\n }\n \n pub fn lstat(path: &Path) -> io::Result<FileAttr> {"}]}