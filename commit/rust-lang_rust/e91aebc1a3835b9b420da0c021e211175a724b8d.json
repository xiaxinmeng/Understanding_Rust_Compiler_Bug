{"sha": "e91aebc1a3835b9b420da0c021e211175a724b8d", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU5MWFlYmMxYTM4MzViOWI0MjBkYTBjMDIxZTIxMTE3NWE3MjRiOGQ=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-04-29T10:48:11Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-04-29T10:48:11Z"}, "message": "Auto merge of #71664 - Dylan-DPC:rollup-eng60x9, r=Dylan-DPC\n\nRollup of 5 pull requests\n\nSuccessful merges:\n\n - #71217 (Suggest `;` or assignment to drop borrows in tail exprs)\n - #71286 (Add regression test for #69654)\n - #71296 (Change wording on read_vectored docs)\n - #71654 (Update link to unstable book for llvm_asm macro)\n - #71657 (Add #24949 assoc constant static recursion test)\n\nFailed merges:\n\nr? @ghost", "tree": {"sha": "92f29b71794612e46796b405356fb963bf945e60", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/92f29b71794612e46796b405356fb963bf945e60"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e91aebc1a3835b9b420da0c021e211175a724b8d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e91aebc1a3835b9b420da0c021e211175a724b8d", "html_url": "https://github.com/rust-lang/rust/commit/e91aebc1a3835b9b420da0c021e211175a724b8d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e91aebc1a3835b9b420da0c021e211175a724b8d/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d9312a8db30b9eb345baf7ebaba6d92061d49096", "url": "https://api.github.com/repos/rust-lang/rust/commits/d9312a8db30b9eb345baf7ebaba6d92061d49096", "html_url": "https://github.com/rust-lang/rust/commit/d9312a8db30b9eb345baf7ebaba6d92061d49096"}, {"sha": "878e92872d6398a0b15aaf855567a6ae4c6231a8", "url": "https://api.github.com/repos/rust-lang/rust/commits/878e92872d6398a0b15aaf855567a6ae4c6231a8", "html_url": "https://github.com/rust-lang/rust/commit/878e92872d6398a0b15aaf855567a6ae4c6231a8"}], "stats": {"total": 371, "additions": 332, "deletions": 39}, "files": [{"sha": "18d5eaa9648495cd3e253e186ecf622cfa893c5c", "filename": "src/libcore/macros/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Flibcore%2Fmacros%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Flibcore%2Fmacros%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fmacros%2Fmod.rs?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -1316,7 +1316,7 @@ pub(crate) mod builtin {\n     ///\n     /// Read the [unstable book] for the usage.\n     ///\n-    /// [unstable book]: ../unstable-book/library-features/asm.html\n+    /// [unstable book]: ../unstable-book/library-features/llvm-asm.html\n     #[unstable(\n         feature = \"llvm_asm\",\n         issue = \"70173\","}, {"sha": "4d7104531753c386ddd43a356f1d3ff808680074", "filename": "src/librustc_middle/mir/mod.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Flibrustc_middle%2Fmir%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Flibrustc_middle%2Fmir%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_middle%2Fmir%2Fmod.rs?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -672,6 +672,9 @@ pub struct BlockTailInfo {\n     /// Examples include `{ ...; tail };` and `let _ = { ...; tail };`\n     /// but not e.g., `let _x = { ...; tail };`\n     pub tail_result_is_ignored: bool,\n+\n+    /// `Span` of the tail expression.\n+    pub span: Span,\n }\n \n /// A MIR local."}, {"sha": "5253acbba7f1c0feb30370f68b9e804bedd53ed4", "filename": "src/librustc_mir/borrow_check/diagnostics/explain_borrow.rs", "status": "modified", "additions": 24, "deletions": 15, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Flibrustc_mir%2Fborrow_check%2Fdiagnostics%2Fexplain_borrow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Flibrustc_mir%2Fborrow_check%2Fdiagnostics%2Fexplain_borrow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Fdiagnostics%2Fexplain_borrow.rs?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -156,23 +156,32 @@ impl BorrowExplanation {\n                         err.span_label(body.source_info(drop_loc).span, message);\n \n                         if let Some(info) = &local_decl.is_block_tail {\n-                            // FIXME: use span_suggestion instead, highlighting the\n-                            // whole block tail expression.\n-                            let msg = if info.tail_result_is_ignored {\n-                                \"The temporary is part of an expression at the end of a block. \\\n-                                 Consider adding semicolon after the expression so its temporaries \\\n-                                 are dropped sooner, before the local variables declared by the \\\n-                                 block are dropped.\"\n+                            if info.tail_result_is_ignored {\n+                                err.span_suggestion_verbose(\n+                                    info.span.shrink_to_hi(),\n+                                    \"consider adding semicolon after the expression so its \\\n+                                     temporaries are dropped sooner, before the local variables \\\n+                                     declared by the block are dropped\",\n+                                    \";\".to_string(),\n+                                    Applicability::MaybeIncorrect,\n+                                );\n                             } else {\n-                                \"The temporary is part of an expression at the end of a block. \\\n-                                 Consider forcing this temporary to be dropped sooner, before \\\n-                                 the block's local variables are dropped. \\\n-                                 For example, you could save the expression's value in a new \\\n-                                 local variable `x` and then make `x` be the expression \\\n-                                 at the end of the block.\"\n+                                err.note(\n+                                    \"the temporary is part of an expression at the end of a \\\n+                                     block;\\nconsider forcing this temporary to be dropped sooner, \\\n+                                     before the block's local variables are dropped\",\n+                                );\n+                                err.multipart_suggestion(\n+                                    \"for example, you could save the expression's value in a new \\\n+                                     local variable `x` and then make `x` be the expression at the \\\n+                                     end of the block\",\n+                                    vec![\n+                                        (info.span.shrink_to_lo(), \"let x = \".to_string()),\n+                                        (info.span.shrink_to_hi(), \"; x\".to_string()),\n+                                    ],\n+                                    Applicability::MaybeIncorrect,\n+                                );\n                             };\n-\n-                            err.note(msg);\n                         }\n                     }\n                 }"}, {"sha": "c2fe41169c117bbc999517b4e5d11e0130f0aa02", "filename": "src/librustc_mir_build/build/block.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Flibrustc_mir_build%2Fbuild%2Fblock.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Flibrustc_mir_build%2Fbuild%2Fblock.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir_build%2Fbuild%2Fblock.rs?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -173,7 +173,11 @@ impl<'a, 'tcx> Builder<'a, 'tcx> {\n         if let Some(expr) = expr {\n             let tail_result_is_ignored =\n                 destination_ty.is_unit() || this.block_context.currently_ignores_tail_results();\n-            this.block_context.push(BlockFrame::TailExpr { tail_result_is_ignored });\n+            let span = match expr {\n+                ExprRef::Hair(expr) => expr.span,\n+                ExprRef::Mirror(ref expr) => expr.span,\n+            };\n+            this.block_context.push(BlockFrame::TailExpr { tail_result_is_ignored, span });\n \n             unpack!(block = this.into(destination, block, expr));\n             let popped = this.block_context.pop();"}, {"sha": "49d6ce39ddfa4df17b2edd99a8e754a4e1b15c72", "filename": "src/librustc_mir_build/build/expr/stmt.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Flibrustc_mir_build%2Fbuild%2Fexpr%2Fstmt.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Flibrustc_mir_build%2Fbuild%2Fexpr%2Fstmt.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir_build%2Fbuild%2Fexpr%2Fstmt.rs?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -151,7 +151,7 @@ impl<'a, 'tcx> Builder<'a, 'tcx> {\n                                 }\n                             }\n                             this.block_context\n-                                .push(BlockFrame::TailExpr { tail_result_is_ignored: true });\n+                                .push(BlockFrame::TailExpr { tail_result_is_ignored: true, span: expr.span });\n                             return Some(expr.span);\n                         }\n                     }"}, {"sha": "4c5c7f79b6cba61a1c2c18193fb47532315dd1b7", "filename": "src/librustc_mir_build/build/mod.rs", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Flibrustc_mir_build%2Fbuild%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Flibrustc_mir_build%2Fbuild%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir_build%2Fbuild%2Fmod.rs?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -242,6 +242,9 @@ enum BlockFrame {\n         ///\n         /// Example: `let _ = { STMT_1; EXPR };`\n         tail_result_is_ignored: bool,\n+\n+        /// `Span` of the tail expression.\n+        span: Span,\n     },\n \n     /// Generic mark meaning that the block occurred as a subexpression\n@@ -369,8 +372,8 @@ impl BlockContext {\n             match bf {\n                 BlockFrame::SubExpr => continue,\n                 BlockFrame::Statement { .. } => break,\n-                &BlockFrame::TailExpr { tail_result_is_ignored } => {\n-                    return Some(BlockTailInfo { tail_result_is_ignored });\n+                &BlockFrame::TailExpr { tail_result_is_ignored, span } => {\n+                    return Some(BlockTailInfo { tail_result_is_ignored, span });\n                 }\n             }\n         }\n@@ -394,7 +397,7 @@ impl BlockContext {\n \n             // otherwise: use accumulated is_ignored state.\n             Some(\n-                BlockFrame::TailExpr { tail_result_is_ignored: ignored }\n+                BlockFrame::TailExpr { tail_result_is_ignored: ignored, .. }\n                 | BlockFrame::Statement { ignores_expr_result: ignored },\n             ) => *ignored,\n         }"}, {"sha": "36c6aa620d5790b5de5391fb15afdb60ea2a91fd", "filename": "src/libstd/io/mod.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Flibstd%2Fio%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Flibstd%2Fio%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fio%2Fmod.rs?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -571,8 +571,9 @@ pub trait Read {\n     /// Like `read`, except that it reads into a slice of buffers.\n     ///\n     /// Data is copied to fill each buffer in order, with the final buffer\n-    /// written to possibly being only partially filled. This method must behave\n-    /// as a single call to `read` with the buffers concatenated would.\n+    /// written to possibly being only partially filled. This method must\n+    /// behave equivalently to a single call to `read` with concatenated\n+    /// buffers.\n     ///\n     /// The default implementation calls `read` with either the first nonempty\n     /// buffer provided, or an empty one if none exists."}, {"sha": "be8162c86b947e975567d93efe33b3690d76b905", "filename": "src/test/ui/associated-consts/issue-24949-assoc-const-static-recursion-impl.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-impl.rs?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -0,0 +1,15 @@\n+// Check for recursion involving references to impl-associated const.\n+\n+trait Foo {\n+    const BAR: u32;\n+}\n+\n+const IMPL_REF_BAR: u32 = GlobalImplRef::BAR; //~ ERROR E0391\n+\n+struct GlobalImplRef;\n+\n+impl GlobalImplRef {\n+    const BAR: u32 = IMPL_REF_BAR;\n+}\n+\n+fn main() {}"}, {"sha": "01a34d310064c36535cbaca0c9895d92bb8bcd56", "filename": "src/test/ui/associated-consts/issue-24949-assoc-const-static-recursion-impl.stderr", "status": "added", "additions": 44, "deletions": 0, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-impl.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-impl.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-impl.stderr?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -0,0 +1,44 @@\n+error[E0391]: cycle detected when const-evaluating + checking `IMPL_REF_BAR`\n+  --> $DIR/issue-24949-assoc-const-static-recursion-impl.rs:7:1\n+   |\n+LL | const IMPL_REF_BAR: u32 = GlobalImplRef::BAR;\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+note: ...which requires const-evaluating + checking `IMPL_REF_BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-impl.rs:7:1\n+   |\n+LL | const IMPL_REF_BAR: u32 = GlobalImplRef::BAR;\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating `IMPL_REF_BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-impl.rs:7:1\n+   |\n+LL | const IMPL_REF_BAR: u32 = GlobalImplRef::BAR;\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   = note: ...which requires normalizing `<impl at $DIR/issue-24949-assoc-const-static-recursion-impl.rs:11:1: 13:2>::BAR`...\n+note: ...which requires const-evaluating + checking `<impl at $DIR/issue-24949-assoc-const-static-recursion-impl.rs:11:1: 13:2>::BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-impl.rs:12:5\n+   |\n+LL |     const BAR: u32 = IMPL_REF_BAR;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating + checking `<impl at $DIR/issue-24949-assoc-const-static-recursion-impl.rs:11:1: 13:2>::BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-impl.rs:12:5\n+   |\n+LL |     const BAR: u32 = IMPL_REF_BAR;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating `<impl at $DIR/issue-24949-assoc-const-static-recursion-impl.rs:11:1: 13:2>::BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-impl.rs:12:5\n+   |\n+LL |     const BAR: u32 = IMPL_REF_BAR;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires processing `<impl at $DIR/issue-24949-assoc-const-static-recursion-impl.rs:11:1: 13:2>::BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-impl.rs:12:5\n+   |\n+LL |     const BAR: u32 = IMPL_REF_BAR;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   = note: ...which requires normalizing `IMPL_REF_BAR`...\n+   = note: ...which again requires const-evaluating + checking `IMPL_REF_BAR`, completing the cycle\n+   = note: cycle used when running analysis passes on this crate\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0391`."}, {"sha": "cec75ae19f457f4004653235f036d007b1e8544e", "filename": "src/test/ui/associated-consts/issue-24949-assoc-const-static-recursion-trait-default.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-trait-default.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-trait-default.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-trait-default.rs?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -0,0 +1,17 @@\n+// Check for recursion involving references to trait-associated const default.\n+\n+trait Foo {\n+    const BAR: u32;\n+}\n+\n+trait FooDefault {\n+    const BAR: u32 = DEFAULT_REF_BAR;\n+}\n+\n+const DEFAULT_REF_BAR: u32 = <GlobalDefaultRef>::BAR; //~ ERROR E0391\n+\n+struct GlobalDefaultRef;\n+\n+impl FooDefault for GlobalDefaultRef {}\n+\n+fn main() {}"}, {"sha": "cad60cba1df6229e1f6d1eb63bbe26619da354e9", "filename": "src/test/ui/associated-consts/issue-24949-assoc-const-static-recursion-trait-default.stderr", "status": "added", "additions": 44, "deletions": 0, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-trait-default.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-trait-default.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-trait-default.stderr?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -0,0 +1,44 @@\n+error[E0391]: cycle detected when const-evaluating + checking `DEFAULT_REF_BAR`\n+  --> $DIR/issue-24949-assoc-const-static-recursion-trait-default.rs:11:1\n+   |\n+LL | const DEFAULT_REF_BAR: u32 = <GlobalDefaultRef>::BAR;\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+note: ...which requires const-evaluating + checking `DEFAULT_REF_BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-trait-default.rs:11:1\n+   |\n+LL | const DEFAULT_REF_BAR: u32 = <GlobalDefaultRef>::BAR;\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating `DEFAULT_REF_BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-trait-default.rs:11:1\n+   |\n+LL | const DEFAULT_REF_BAR: u32 = <GlobalDefaultRef>::BAR;\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   = note: ...which requires normalizing `<GlobalDefaultRef as FooDefault>::BAR`...\n+note: ...which requires const-evaluating + checking `FooDefault::BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-trait-default.rs:8:5\n+   |\n+LL |     const BAR: u32 = DEFAULT_REF_BAR;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating + checking `FooDefault::BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-trait-default.rs:8:5\n+   |\n+LL |     const BAR: u32 = DEFAULT_REF_BAR;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating `FooDefault::BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-trait-default.rs:8:5\n+   |\n+LL |     const BAR: u32 = DEFAULT_REF_BAR;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires processing `FooDefault::BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-trait-default.rs:8:5\n+   |\n+LL |     const BAR: u32 = DEFAULT_REF_BAR;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   = note: ...which requires normalizing `DEFAULT_REF_BAR`...\n+   = note: ...which again requires const-evaluating + checking `DEFAULT_REF_BAR`, completing the cycle\n+   = note: cycle used when running analysis passes on this crate\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0391`."}, {"sha": "62af85343406f016b12e35ce94eea88307838a31", "filename": "src/test/ui/associated-consts/issue-24949-assoc-const-static-recursion-trait.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-trait.rs?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -0,0 +1,15 @@\n+// Check for recursion involving references to trait-associated const.\n+\n+trait Foo {\n+    const BAR: u32;\n+}\n+\n+const TRAIT_REF_BAR: u32 = <GlobalTraitRef>::BAR; //~ ERROR E0391\n+\n+struct GlobalTraitRef;\n+\n+impl Foo for GlobalTraitRef {\n+    const BAR: u32 = TRAIT_REF_BAR;\n+}\n+\n+fn main() {}"}, {"sha": "f415980dc1ea8dc928897bade9881b9731be275d", "filename": "src/test/ui/associated-consts/issue-24949-assoc-const-static-recursion-trait.stderr", "status": "added", "additions": 44, "deletions": 0, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-trait.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-trait.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fassociated-consts%2Fissue-24949-assoc-const-static-recursion-trait.stderr?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -0,0 +1,44 @@\n+error[E0391]: cycle detected when const-evaluating + checking `TRAIT_REF_BAR`\n+  --> $DIR/issue-24949-assoc-const-static-recursion-trait.rs:7:1\n+   |\n+LL | const TRAIT_REF_BAR: u32 = <GlobalTraitRef>::BAR;\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+note: ...which requires const-evaluating + checking `TRAIT_REF_BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-trait.rs:7:1\n+   |\n+LL | const TRAIT_REF_BAR: u32 = <GlobalTraitRef>::BAR;\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating `TRAIT_REF_BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-trait.rs:7:1\n+   |\n+LL | const TRAIT_REF_BAR: u32 = <GlobalTraitRef>::BAR;\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   = note: ...which requires normalizing `<GlobalTraitRef as Foo>::BAR`...\n+note: ...which requires const-evaluating + checking `<impl at $DIR/issue-24949-assoc-const-static-recursion-trait.rs:11:1: 13:2>::BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-trait.rs:12:5\n+   |\n+LL |     const BAR: u32 = TRAIT_REF_BAR;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating + checking `<impl at $DIR/issue-24949-assoc-const-static-recursion-trait.rs:11:1: 13:2>::BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-trait.rs:12:5\n+   |\n+LL |     const BAR: u32 = TRAIT_REF_BAR;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating `<impl at $DIR/issue-24949-assoc-const-static-recursion-trait.rs:11:1: 13:2>::BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-trait.rs:12:5\n+   |\n+LL |     const BAR: u32 = TRAIT_REF_BAR;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires processing `<impl at $DIR/issue-24949-assoc-const-static-recursion-trait.rs:11:1: 13:2>::BAR`...\n+  --> $DIR/issue-24949-assoc-const-static-recursion-trait.rs:12:5\n+   |\n+LL |     const BAR: u32 = TRAIT_REF_BAR;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   = note: ...which requires normalizing `TRAIT_REF_BAR`...\n+   = note: ...which again requires const-evaluating + checking `TRAIT_REF_BAR`, completing the cycle\n+   = note: cycle used when running analysis passes on this crate\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0391`."}, {"sha": "2befbe56d85c7c5d42a6ba2249e3211b7598a575", "filename": "src/test/ui/const-generics/issues/issue-69654.rs", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-69654.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-69654.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-69654.rs?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -0,0 +1,18 @@\n+#![feature(const_generics)]\n+#![allow(incomplete_features)]\n+\n+trait Bar<O> {}\n+impl<O> Bar<O> for [u8; O] {}\n+//~^ ERROR expected value, found type parameter `O`\n+\n+struct Foo<const O: usize> {}\n+impl<const O: usize> Foo<O>\n+where\n+    [u8; O]: Bar<[(); O]>,\n+{\n+    fn foo() {}\n+}\n+\n+fn main() {\n+    Foo::foo();\n+}"}, {"sha": "9d52603f462bedaec02beed21129c40348ade380", "filename": "src/test/ui/const-generics/issues/issue-69654.stderr", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-69654.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-69654.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-69654.stderr?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -0,0 +1,14 @@\n+error[E0423]: expected value, found type parameter `O`\n+  --> $DIR/issue-69654.rs:5:25\n+   |\n+LL | impl<O> Bar<O> for [u8; O] {}\n+   |                         ^ help: a tuple variant with a similar name exists: `Ok`\n+   | \n+  ::: $SRC_DIR/libcore/result.rs:LL:COL\n+   |\n+LL |     Ok(#[stable(feature = \"rust1\", since = \"1.0.0\")] T),\n+   |     --------------------------------------------------- similarly named tuple variant `Ok` defined here\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0423`."}, {"sha": "2dca92e2be1f346897b72ebe35107a6ef999a63b", "filename": "src/test/ui/nll/issue-54382-use-span-of-tail-of-block.stderr", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fnll%2Fissue-54382-use-span-of-tail-of-block.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fnll%2Fissue-54382-use-span-of-tail-of-block.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnll%2Fissue-54382-use-span-of-tail-of-block.stderr?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -13,7 +13,10 @@ LL |\n LL |     ;\n    |     - ... and the borrow might be used here, when that temporary is dropped and runs the `Drop` code for type `D`\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped.\n+help: consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped\n+   |\n+LL |             D(\"other\").next(&_thing1);\n+   |                                      ^\n \n error: aborting due to previous error\n "}, {"sha": "b4791fd22b4ad6c6d7bafead9d497aa537f5db67", "filename": "src/test/ui/nll/issue-54556-niconii.stderr", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fnll%2Fissue-54556-niconii.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fnll%2Fissue-54556-niconii.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnll%2Fissue-54556-niconii.stderr?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -13,7 +13,10 @@ LL | }\n    | `counter` dropped here while still borrowed\n    | ... and the borrow might be used here, when that temporary is dropped and runs the destructor for type `std::result::Result<MutexGuard<'_>, ()>`\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped.\n+help: consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped\n+   |\n+LL |     if let Ok(_) = counter.lock() { };\n+   |                                      ^\n \n error: aborting due to previous error\n "}, {"sha": "77065f0b8d21302c2432cd3b135d4945d9853aed", "filename": "src/test/ui/nll/issue-54556-stephaneyfx.stderr", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fnll%2Fissue-54556-stephaneyfx.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fnll%2Fissue-54556-stephaneyfx.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnll%2Fissue-54556-stephaneyfx.stderr?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -12,7 +12,12 @@ LL | }\n    | `stmt` dropped here while still borrowed\n    | ... and the borrow might be used here, when that temporary is dropped and runs the destructor for type `std::iter::Map<Rows<'_>, [closure@$DIR/issue-54556-stephaneyfx.rs:28:14: 28:23]>`\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider forcing this temporary to be dropped sooner, before the block's local variables are dropped. For example, you could save the expression's value in a new local variable `x` and then make `x` be the expression at the end of the block.\n+   = note: the temporary is part of an expression at the end of a block;\n+           consider forcing this temporary to be dropped sooner, before the block's local variables are dropped\n+help: for example, you could save the expression's value in a new local variable `x` and then make `x` be the expression at the end of the block\n+   |\n+LL |     let x = rows.map(|row| row).next(); x\n+   |     ^^^^^^^                           ^^^\n \n error: aborting due to previous error\n "}, {"sha": "047fdbc9148aced01d6601d9d4698a9f050d2444", "filename": "src/test/ui/nll/issue-54556-temps-in-tail-diagnostic.stderr", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fnll%2Fissue-54556-temps-in-tail-diagnostic.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fnll%2Fissue-54556-temps-in-tail-diagnostic.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnll%2Fissue-54556-temps-in-tail-diagnostic.stderr?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -12,7 +12,10 @@ LL |\n LL |     ;\n    |     - ... and the borrow might be used here, when that temporary is dropped and runs the `Drop` code for type `D`\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped.\n+help: consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped\n+   |\n+LL |         D(&_thing1).end();\n+   |                          ^\n \n error: aborting due to previous error\n "}, {"sha": "85920a8e7394c41953e6bfbf07146c8c5168bae9", "filename": "src/test/ui/nll/issue-54556-used-vs-unused-tails.stderr", "status": "modified", "additions": 42, "deletions": 9, "changes": 51, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fnll%2Fissue-54556-used-vs-unused-tails.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fnll%2Fissue-54556-used-vs-unused-tails.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnll%2Fissue-54556-used-vs-unused-tails.stderr?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -8,7 +8,10 @@ LL |     {              let mut _t1 = D(Box::new(\"t1\")); D(&_t1).end()    } ; //\n    |                                                     | borrowed value does not live long enough\n    |                                                     a temporary with access to the borrow is created here ...\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped.\n+help: consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped\n+   |\n+LL |     {              let mut _t1 = D(Box::new(\"t1\")); D(&_t1).end();    } ; // suggest `;`\n+   |                                                                  ^\n \n error[E0597]: `_t1` does not live long enough\n   --> $DIR/issue-54556-used-vs-unused-tails.rs:13:55\n@@ -20,7 +23,10 @@ LL |     {            { let mut _t1 = D(Box::new(\"t1\")); D(&_t1).end() }  } ; //\n    |                                                     | borrowed value does not live long enough\n    |                                                     a temporary with access to the borrow is created here ...\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped.\n+help: consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped\n+   |\n+LL |     {            { let mut _t1 = D(Box::new(\"t1\")); D(&_t1).end(); }  } ; // suggest `;`\n+   |                                                                  ^\n \n error[E0597]: `_t1` does not live long enough\n   --> $DIR/issue-54556-used-vs-unused-tails.rs:16:55\n@@ -32,7 +38,10 @@ LL |     {            { let mut _t1 = D(Box::new(\"t1\")); D(&_t1).end() }; }   //\n    |                                                     | borrowed value does not live long enough\n    |                                                     a temporary with access to the borrow is created here ...\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped.\n+help: consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped\n+   |\n+LL |     {            { let mut _t1 = D(Box::new(\"t1\")); D(&_t1).end(); }; }   // suggest `;`\n+   |                                                                  ^\n \n error[E0597]: `_t1` does not live long enough\n   --> $DIR/issue-54556-used-vs-unused-tails.rs:19:55\n@@ -44,7 +53,10 @@ LL |     let _ =      { let mut _t1 = D(Box::new(\"t1\")); D(&_t1).end()    } ; //\n    |                                                     | borrowed value does not live long enough\n    |                                                     a temporary with access to the borrow is created here ...\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped.\n+help: consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped\n+   |\n+LL |     let _ =      { let mut _t1 = D(Box::new(\"t1\")); D(&_t1).end();    } ; // suggest `;`\n+   |                                                                  ^\n \n error[E0597]: `_t1` does not live long enough\n   --> $DIR/issue-54556-used-vs-unused-tails.rs:22:55\n@@ -56,7 +68,10 @@ LL |     let _u =     { let mut _t1 = D(Box::new(\"t1\")); D(&_t1).unit()   } ; //\n    |                                                     | borrowed value does not live long enough\n    |                                                     a temporary with access to the borrow is created here ...\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped.\n+help: consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped\n+   |\n+LL |     let _u =     { let mut _t1 = D(Box::new(\"t1\")); D(&_t1).unit();   } ; // suggest `;`\n+   |                                                                   ^\n \n error[E0597]: `_t1` does not live long enough\n   --> $DIR/issue-54556-used-vs-unused-tails.rs:25:55\n@@ -68,7 +83,12 @@ LL |     let _x =     { let mut _t1 = D(Box::new(\"t1\")); D(&_t1).end()    } ; //\n    |                                                     | borrowed value does not live long enough\n    |                                                     a temporary with access to the borrow is created here ...\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider forcing this temporary to be dropped sooner, before the block's local variables are dropped. For example, you could save the expression's value in a new local variable `x` and then make `x` be the expression at the end of the block.\n+   = note: the temporary is part of an expression at the end of a block;\n+           consider forcing this temporary to be dropped sooner, before the block's local variables are dropped\n+help: for example, you could save the expression's value in a new local variable `x` and then make `x` be the expression at the end of the block\n+   |\n+LL |     let _x =     { let mut _t1 = D(Box::new(\"t1\")); let x = D(&_t1).end(); x    } ; // `let x = ...; x`\n+   |                                                     ^^^^^^^              ^^^\n \n error[E0597]: `_t1` does not live long enough\n   --> $DIR/issue-54556-used-vs-unused-tails.rs:30:55\n@@ -80,7 +100,12 @@ LL |     _y =         { let mut _t1 = D(Box::new(\"t1\")); D(&_t1).end() } ; // `l\n    |                                                     | borrowed value does not live long enough\n    |                                                     a temporary with access to the borrow is created here ...\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider forcing this temporary to be dropped sooner, before the block's local variables are dropped. For example, you could save the expression's value in a new local variable `x` and then make `x` be the expression at the end of the block.\n+   = note: the temporary is part of an expression at the end of a block;\n+           consider forcing this temporary to be dropped sooner, before the block's local variables are dropped\n+help: for example, you could save the expression's value in a new local variable `x` and then make `x` be the expression at the end of the block\n+   |\n+LL |     _y =         { let mut _t1 = D(Box::new(\"t1\")); let x = D(&_t1).end(); x } ; // `let x = ...; x`\n+   |                                                     ^^^^^^^              ^^^\n \n error[E0597]: `_t1` does not live long enough\n   --> $DIR/issue-54556-used-vs-unused-tails.rs:37:55\n@@ -93,7 +118,10 @@ LL | fn f_local_ref() { let mut _t1 = D(Box::new(\"t1\")); D(&_t1).unit()   }  //\n    |                                                     | borrowed value does not live long enough\n    |                                                     a temporary with access to the borrow is created here ...\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped.\n+help: consider adding semicolon after the expression so its temporaries are dropped sooner, before the local variables declared by the block are dropped\n+   |\n+LL | fn f_local_ref() { let mut _t1 = D(Box::new(\"t1\")); D(&_t1).unit();   }  // suggest `;`\n+   |                                                                   ^\n \n error[E0597]: `_t1` does not live long enough\n   --> $DIR/issue-54556-used-vs-unused-tails.rs:40:55\n@@ -106,7 +134,12 @@ LL | fn f() -> String { let mut _t1 = D(Box::new(\"t1\")); D(&_t1).end()   }   //\n    |                                                     | borrowed value does not live long enough\n    |                                                     a temporary with access to the borrow is created here ...\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider forcing this temporary to be dropped sooner, before the block's local variables are dropped. For example, you could save the expression's value in a new local variable `x` and then make `x` be the expression at the end of the block.\n+   = note: the temporary is part of an expression at the end of a block;\n+           consider forcing this temporary to be dropped sooner, before the block's local variables are dropped\n+help: for example, you could save the expression's value in a new local variable `x` and then make `x` be the expression at the end of the block\n+   |\n+LL | fn f() -> String { let mut _t1 = D(Box::new(\"t1\")); let x = D(&_t1).end(); x   }   // `let x = ...; x`\n+   |                                                     ^^^^^^^              ^^^\n \n error: aborting due to 9 previous errors\n "}, {"sha": "b5cd29f99c6b49323bad4389772d4634816f8e1e", "filename": "src/test/ui/span/destructor-restrictions.stderr", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fspan%2Fdestructor-restrictions.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fspan%2Fdestructor-restrictions.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2Fdestructor-restrictions.stderr?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -11,7 +11,12 @@ LL |     };\n    |     |\n    |     `*a` dropped here while still borrowed\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider forcing this temporary to be dropped sooner, before the block's local variables are dropped. For example, you could save the expression's value in a new local variable `x` and then make `x` be the expression at the end of the block.\n+   = note: the temporary is part of an expression at the end of a block;\n+           consider forcing this temporary to be dropped sooner, before the block's local variables are dropped\n+help: for example, you could save the expression's value in a new local variable `x` and then make `x` be the expression at the end of the block\n+   |\n+LL |         let x = *a.borrow() + 1; x\n+   |         ^^^^^^^                ^^^\n \n error: aborting due to previous error\n "}, {"sha": "46702d364a8f398b4bf204e779f9bc75325a03cb", "filename": "src/test/ui/span/issue-23338-locals-die-before-temps-of-body.stderr", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fspan%2Fissue-23338-locals-die-before-temps-of-body.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e91aebc1a3835b9b420da0c021e211175a724b8d/src%2Ftest%2Fui%2Fspan%2Fissue-23338-locals-die-before-temps-of-body.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2Fissue-23338-locals-die-before-temps-of-body.stderr?ref=e91aebc1a3835b9b420da0c021e211175a724b8d", "patch": "@@ -12,7 +12,12 @@ LL | }\n    | `y` dropped here while still borrowed\n    | ... and the borrow might be used here, when that temporary is dropped and runs the destructor for type `std::cell::Ref<'_, std::string::String>`\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider forcing this temporary to be dropped sooner, before the block's local variables are dropped. For example, you could save the expression's value in a new local variable `x` and then make `x` be the expression at the end of the block.\n+   = note: the temporary is part of an expression at the end of a block;\n+           consider forcing this temporary to be dropped sooner, before the block's local variables are dropped\n+help: for example, you could save the expression's value in a new local variable `x` and then make `x` be the expression at the end of the block\n+   |\n+LL |     let x = y.borrow().clone(); x\n+   |     ^^^^^^^                   ^^^\n \n error[E0597]: `y` does not live long enough\n   --> $DIR/issue-23338-locals-die-before-temps-of-body.rs:17:9\n@@ -27,7 +32,12 @@ LL |     };\n    |     |\n    |     `y` dropped here while still borrowed\n    |\n-   = note: The temporary is part of an expression at the end of a block. Consider forcing this temporary to be dropped sooner, before the block's local variables are dropped. For example, you could save the expression's value in a new local variable `x` and then make `x` be the expression at the end of the block.\n+   = note: the temporary is part of an expression at the end of a block;\n+           consider forcing this temporary to be dropped sooner, before the block's local variables are dropped\n+help: for example, you could save the expression's value in a new local variable `x` and then make `x` be the expression at the end of the block\n+   |\n+LL |         let x = y.borrow().clone(); x\n+   |         ^^^^^^^                   ^^^\n \n error: aborting due to 2 previous errors\n "}]}