{"sha": "f75a236fe0751a0d9bfb740c32eec14da787f112", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY3NWEyMzZmZTA3NTFhMGQ5YmZiNzQwYzMyZWVjMTRkYTc4N2YxMTI=", "commit": {"author": {"name": "Rich Kadel", "email": "richkadel@google.com", "date": "2020-10-23T21:58:08Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-10-23T21:58:08Z"}, "message": "Update compiler/rustc_codegen_llvm/src/coverageinfo/mapgen.rs\n\nCo-authored-by: Wesley Wiser <wwiser@gmail.com>", "tree": {"sha": "4ff4779ab1bcb108aab355e53504b52ca89c698c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4ff4779ab1bcb108aab355e53504b52ca89c698c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f75a236fe0751a0d9bfb740c32eec14da787f112", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfk1HwCRBK7hj4Ov3rIwAAdHIIADHnhBpeIotpyjbspQraA7ig\nlombfHSCJQBY7vlk36OlNyZ7nAEM12EoY/cgLN8OZXheIs/7UGkSUzHnTPnfwQW/\ncnyAO48nJWEG+nUWQAUc+C5SdFv+oT1V4tFqsOs1f7YK2LfubqxqqfDTeS4FA/Nf\nwkw7zYD3xFUv07ZWxn4/Z7I1+L2CDvbCfo+fBx2uCc1sn1Fgbjj/Y9DYC1N+F9Ls\nauurK/167VyDUp/d4CfKHKBcUlED1cJidpW9ziwoVSAGNojm/2piLYBvgIy02eI/\nndBihM5348rN1xkIa2+8YVhRp9WC+wKL+6G9dq/16V/BMx194t4WI1ROlJr32CY=\n=4iUb\n-----END PGP SIGNATURE-----\n", "payload": "tree 4ff4779ab1bcb108aab355e53504b52ca89c698c\nparent a7bc1a2edf6066c16b01f40a2a0120c9d6ff4a49\nauthor Rich Kadel <richkadel@google.com> 1603490288 -0700\ncommitter GitHub <noreply@github.com> 1603490288 -0700\n\nUpdate compiler/rustc_codegen_llvm/src/coverageinfo/mapgen.rs\n\nCo-authored-by: Wesley Wiser <wwiser@gmail.com>"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f75a236fe0751a0d9bfb740c32eec14da787f112", "html_url": "https://github.com/rust-lang/rust/commit/f75a236fe0751a0d9bfb740c32eec14da787f112", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f75a236fe0751a0d9bfb740c32eec14da787f112/comments", "author": {"login": "richkadel", "id": 3827298, "node_id": "MDQ6VXNlcjM4MjcyOTg=", "avatar_url": "https://avatars.githubusercontent.com/u/3827298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/richkadel", "html_url": "https://github.com/richkadel", "followers_url": "https://api.github.com/users/richkadel/followers", "following_url": "https://api.github.com/users/richkadel/following{/other_user}", "gists_url": "https://api.github.com/users/richkadel/gists{/gist_id}", "starred_url": "https://api.github.com/users/richkadel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/richkadel/subscriptions", "organizations_url": "https://api.github.com/users/richkadel/orgs", "repos_url": "https://api.github.com/users/richkadel/repos", "events_url": "https://api.github.com/users/richkadel/events{/privacy}", "received_events_url": "https://api.github.com/users/richkadel/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a7bc1a2edf6066c16b01f40a2a0120c9d6ff4a49", "url": "https://api.github.com/repos/rust-lang/rust/commits/a7bc1a2edf6066c16b01f40a2a0120c9d6ff4a49", "html_url": "https://github.com/rust-lang/rust/commit/a7bc1a2edf6066c16b01f40a2a0120c9d6ff4a49"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "c1163a871cf1f311047ad6ad61daf274592cf0c9", "filename": "compiler/rustc_codegen_llvm/src/coverageinfo/mapgen.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/f75a236fe0751a0d9bfb740c32eec14da787f112/compiler%2Frustc_codegen_llvm%2Fsrc%2Fcoverageinfo%2Fmapgen.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f75a236fe0751a0d9bfb740c32eec14da787f112/compiler%2Frustc_codegen_llvm%2Fsrc%2Fcoverageinfo%2Fmapgen.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_llvm%2Fsrc%2Fcoverageinfo%2Fmapgen.rs?ref=f75a236fe0751a0d9bfb740c32eec14da787f112", "patch": "@@ -26,10 +26,10 @@ use tracing::debug;\n /// undocumented details in Clang's implementation (that may or may not be important) were also\n /// replicated for Rust's Coverage Map.\n pub fn finalize<'ll, 'tcx>(cx: &CodegenCx<'ll, 'tcx>) {\n-    if cx.coverage_context().is_none() {\n-        return;\n-    }\n-    let function_coverage_map = cx.coverage_context().unwrap().take_function_coverage_map();\n+    let function_coverage_map = match cx.coverage_context() {\n+        Some(ctx) => ctx.take_function_coverage_map(),\n+        None => return,\n+    };\n     if function_coverage_map.is_empty() {\n         // This module has no functions with coverage instrumentation\n         return;"}]}