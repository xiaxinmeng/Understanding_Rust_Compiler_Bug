{"sha": "3800bff4de9f081ef2f02b95d9ba4bae529c82af", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM4MDBiZmY0ZGU5ZjA4MWVmMmYwMmI5NWQ5YmE0YmFlNTI5YzgyYWY=", "commit": {"author": {"name": "Machtan", "email": "jako3047@gmail.com", "date": "2016-11-08T12:54:08Z"}, "committer": {"name": "Machtan", "email": "jako3047@gmail.com", "date": "2016-11-08T12:54:08Z"}, "message": "Add '--version' flag and allow version and help flags when called as 'cargo-clippy'", "tree": {"sha": "fd6368ea8242e1d893c66d890852fa0e31380db7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fd6368ea8242e1d893c66d890852fa0e31380db7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3800bff4de9f081ef2f02b95d9ba4bae529c82af", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3800bff4de9f081ef2f02b95d9ba4bae529c82af", "html_url": "https://github.com/rust-lang/rust/commit/3800bff4de9f081ef2f02b95d9ba4bae529c82af", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3800bff4de9f081ef2f02b95d9ba4bae529c82af/comments", "author": null, "committer": null, "parents": [{"sha": "c687fe73bc2ed6751f1f451f7c8942662f325cf9", "url": "https://api.github.com/repos/rust-lang/rust/commits/c687fe73bc2ed6751f1f451f7c8942662f325cf9", "html_url": "https://github.com/rust-lang/rust/commit/c687fe73bc2ed6751f1f451f7c8942662f325cf9"}], "stats": {"total": 16, "additions": 11, "deletions": 5}, "files": [{"sha": "d1e9bd74c1e23db97a76994975317d99e6fea77b", "filename": "src/main.rs", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/3800bff4de9f081ef2f02b95d9ba4bae529c82af/src%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3800bff4de9f081ef2f02b95d9ba4bae529c82af/src%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmain.rs?ref=3800bff4de9f081ef2f02b95d9ba4bae529c82af", "patch": "@@ -118,6 +118,7 @@ Usage:\n Common options:\n     -h, --help               Print this message\n     --features               Features to compile for the package\n+    -V, --version            Print version info and exit\n \n Other options are the same as `cargo rustc`.\n \n@@ -146,17 +147,22 @@ pub fn main() {\n     if env::var(\"CLIPPY_DOGFOOD\").map(|_| true).unwrap_or(false) {\n         panic!(\"yummy\");\n     }\n+    \n+    // Check for version and help flags even when invoked as 'cargo-clippy'\n+    if std::env::args().any(|a| a == \"--help\" || a == \"-h\") {\n+        show_help();\n+        return;\n+    }\n+    if std::env::args().any(|a| a == \"--version\" || a == \"-V\") {\n+        println!(\"{}\", env!(\"CARGO_PKG_VERSION\"));\n+        return;\n+    }\n \n     let dep_path = env::current_dir().expect(\"current dir is not readable\").join(\"target\").join(\"debug\").join(\"deps\");\n \n     if let Some(\"clippy\") = std::env::args().nth(1).as_ref().map(AsRef::as_ref) {\n         // this arm is executed on the initial call to `cargo clippy`\n \n-        if std::env::args().any(|a| a == \"--help\" || a == \"-h\") {\n-            show_help();\n-            return;\n-        }\n-\n         let manifest_path_arg = std::env::args().skip(2).find(|val| val.starts_with(\"--manifest-path=\"));\n \n         let mut metadata = cargo::metadata(manifest_path_arg.as_ref().map(AsRef::as_ref)).expect(\"could not obtain cargo metadata\");"}]}