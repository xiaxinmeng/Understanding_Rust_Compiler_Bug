{"sha": "c027be0dd09a440927071dea69378d01322373cd", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMwMjdiZTBkZDA5YTQ0MDkyNzA3MWRlYTY5Mzc4ZDAxMzIyMzczY2Q=", "commit": {"author": {"name": "wangxiangqing", "email": "wangxiangqing@bytedance.com", "date": "2019-10-21T16:08:14Z"}, "committer": {"name": "wangxiangqing", "email": "wangxiangqing@bytedance.com", "date": "2019-10-22T00:47:52Z"}, "message": "Deprecated proc_macro doesn't trigger warning on build library\n\nChange-Id: Ib3a396e7334d209fe6c6ef425bbfc7b2ae471378", "tree": {"sha": "ca6a5aa9ac5c305874d96d5cacee42e80d7baeee", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ca6a5aa9ac5c305874d96d5cacee42e80d7baeee"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c027be0dd09a440927071dea69378d01322373cd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c027be0dd09a440927071dea69378d01322373cd", "html_url": "https://github.com/rust-lang/rust/commit/c027be0dd09a440927071dea69378d01322373cd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c027be0dd09a440927071dea69378d01322373cd/comments", "author": {"login": "XiangQingW", "id": 7948384, "node_id": "MDQ6VXNlcjc5NDgzODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7948384?v=4", "gravatar_id": "", "url": "https://api.github.com/users/XiangQingW", "html_url": "https://github.com/XiangQingW", "followers_url": "https://api.github.com/users/XiangQingW/followers", "following_url": "https://api.github.com/users/XiangQingW/following{/other_user}", "gists_url": "https://api.github.com/users/XiangQingW/gists{/gist_id}", "starred_url": "https://api.github.com/users/XiangQingW/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/XiangQingW/subscriptions", "organizations_url": "https://api.github.com/users/XiangQingW/orgs", "repos_url": "https://api.github.com/users/XiangQingW/repos", "events_url": "https://api.github.com/users/XiangQingW/events{/privacy}", "received_events_url": "https://api.github.com/users/XiangQingW/received_events", "type": "User", "site_admin": false}, "committer": {"login": "XiangQingW", "id": 7948384, "node_id": "MDQ6VXNlcjc5NDgzODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7948384?v=4", "gravatar_id": "", "url": "https://api.github.com/users/XiangQingW", "html_url": "https://github.com/XiangQingW", "followers_url": "https://api.github.com/users/XiangQingW/followers", "following_url": "https://api.github.com/users/XiangQingW/following{/other_user}", "gists_url": "https://api.github.com/users/XiangQingW/gists{/gist_id}", "starred_url": "https://api.github.com/users/XiangQingW/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/XiangQingW/subscriptions", "organizations_url": "https://api.github.com/users/XiangQingW/orgs", "repos_url": "https://api.github.com/users/XiangQingW/repos", "events_url": "https://api.github.com/users/XiangQingW/events{/privacy}", "received_events_url": "https://api.github.com/users/XiangQingW/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "33910f9d86cf8c283c51800085c3e863261ec5ae", "url": "https://api.github.com/repos/rust-lang/rust/commits/33910f9d86cf8c283c51800085c3e863261ec5ae", "html_url": "https://github.com/rust-lang/rust/commit/33910f9d86cf8c283c51800085c3e863261ec5ae"}], "stats": {"total": 10, "additions": 5, "deletions": 5}, "files": [{"sha": "c874f1ffb1175d55d3d5824f777b7a357c8295d2", "filename": "src/libsyntax_ext/proc_macro_harness.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c027be0dd09a440927071dea69378d01322373cd/src%2Flibsyntax_ext%2Fproc_macro_harness.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c027be0dd09a440927071dea69378d01322373cd/src%2Flibsyntax_ext%2Fproc_macro_harness.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax_ext%2Fproc_macro_harness.rs?ref=c027be0dd09a440927071dea69378d01322373cd", "patch": "@@ -337,6 +337,7 @@ impl<'a> Visitor<'a> for CollectProcMacros<'a> {\n //          use proc_macro::bridge::client::ProcMacro;\n //\n //          #[rustc_proc_macro_decls]\n+//          #[allow(deprecated)]\n //          static DECLS: &[ProcMacro] = &[\n //              ProcMacro::custom_derive($name_trait1, &[], ::$name1);\n //              ProcMacro::custom_derive($name_trait2, &[\"attribute_name\"], ::$name2);"}, {"sha": "25ce53b70a5bd22912a9f8de50eabcd5f684d7d9", "filename": "src/test/ui/proc-macro/proc-macro-deprecated-attr.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/c027be0dd09a440927071dea69378d01322373cd/src%2Ftest%2Fui%2Fproc-macro%2Fproc-macro-deprecated-attr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c027be0dd09a440927071dea69378d01322373cd/src%2Ftest%2Fui%2Fproc-macro%2Fproc-macro-deprecated-attr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fproc-macro-deprecated-attr.rs?ref=c027be0dd09a440927071dea69378d01322373cd", "patch": "@@ -1,4 +1,6 @@\n-// build-pass\n+// check-pass\n+\n+#![deny(deprecated)]\n \n #![crate_type = \"proc-macro\"]\n \n@@ -8,8 +10,5 @@ use proc_macro::*;\n #[proc_macro]\n #[deprecated(since = \"1.0.0\", note = \"test\")]\n pub fn test_compile_without_warning_with_deprecated(_: TokenStream) -> TokenStream {\n-    \"\n-    extern crate proc_macro;\n-    fn foo() { }\n-    \".parse().unwrap()\n+    TokenStream::new()\n }"}]}