{"sha": "d92d1935cb01cfa469a725f041e4c1d8a2ee9564", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ5MmQxOTM1Y2IwMWNmYTQ2OWE3MjVmMDQxZTRjMWQ4YTJlZTk1NjQ=", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2018-04-26T21:19:21Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2018-04-26T21:19:21Z"}, "message": "Don't ICE on tuple struct ctor with incorrect arg count", "tree": {"sha": "0fd6517097609aa2d7e8445ffd7c9b4019ae6397", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0fd6517097609aa2d7e8445ffd7c9b4019ae6397"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d92d1935cb01cfa469a725f041e4c1d8a2ee9564", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d92d1935cb01cfa469a725f041e4c1d8a2ee9564", "html_url": "https://github.com/rust-lang/rust/commit/d92d1935cb01cfa469a725f041e4c1d8a2ee9564", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d92d1935cb01cfa469a725f041e4c1d8a2ee9564/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "949010d23e9f7037a8e6f323588873b3d2438fb1", "url": "https://api.github.com/repos/rust-lang/rust/commits/949010d23e9f7037a8e6f323588873b3d2438fb1", "html_url": "https://github.com/rust-lang/rust/commit/949010d23e9f7037a8e6f323588873b3d2438fb1"}], "stats": {"total": 29, "additions": 28, "deletions": 1}, "files": [{"sha": "3eb45439001cd16298fd037056b8b5819fb5d536", "filename": "src/librustc/traits/error_reporting.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d92d1935cb01cfa469a725f041e4c1d8a2ee9564/src%2Flibrustc%2Ftraits%2Ferror_reporting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d92d1935cb01cfa469a725f041e4c1d8a2ee9564/src%2Flibrustc%2Ftraits%2Ferror_reporting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Ferror_reporting.rs?ref=d92d1935cb01cfa469a725f041e4c1d8a2ee9564", "patch": "@@ -976,6 +976,12 @@ impl<'a, 'gcx, 'tcx> InferCtxt<'a, 'gcx, 'tcx> {\n                      ArgKind::Arg(format!(\"{}\", field.name), \"_\".to_string())\n                  }).collect::<Vec<_>>())\n             }\n+            hir::map::NodeStructCtor(ref variant_data) => {\n+                (self.tcx.sess.codemap().def_span(self.tcx.hir.span(variant_data.id())),\n+                 variant_data.fields()\n+                    .iter().map(|_| ArgKind::Arg(\"_\".to_owned(), \"_\".to_owned()))\n+                    .collect())\n+            }\n             _ => panic!(\"non-FnLike node found: {:?}\", node),\n         }\n     }"}, {"sha": "9eb11148a8bcef45200484c0163c2371927fe782", "filename": "src/test/ui/mismatched_types/closure-arg-count.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d92d1935cb01cfa469a725f041e4c1d8a2ee9564/src%2Ftest%2Fui%2Fmismatched_types%2Fclosure-arg-count.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d92d1935cb01cfa469a725f041e4c1d8a2ee9564/src%2Ftest%2Fui%2Fmismatched_types%2Fclosure-arg-count.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmismatched_types%2Fclosure-arg-count.rs?ref=d92d1935cb01cfa469a725f041e4c1d8a2ee9564", "patch": "@@ -39,7 +39,13 @@ fn main() {\n \n     let _it = vec![1, 2, 3].into_iter().map(usize::checked_add);\n     //~^ ERROR function is expected to take\n+\n+    call(Foo);\n+    //~^ ERROR function is expected to take\n }\n \n fn foo() {}\n fn qux(x: usize, y: usize) {}\n+\n+fn call<F, R>(_: F) where F: FnOnce() -> R {}\n+struct Foo(u8);"}, {"sha": "6270e794498766f17fcba58f4b3e8e130e07b981", "filename": "src/test/ui/mismatched_types/closure-arg-count.stderr", "status": "modified", "additions": 16, "deletions": 1, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/d92d1935cb01cfa469a725f041e4c1d8a2ee9564/src%2Ftest%2Fui%2Fmismatched_types%2Fclosure-arg-count.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d92d1935cb01cfa469a725f041e4c1d8a2ee9564/src%2Ftest%2Fui%2Fmismatched_types%2Fclosure-arg-count.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmismatched_types%2Fclosure-arg-count.stderr?ref=d92d1935cb01cfa469a725f041e4c1d8a2ee9564", "patch": "@@ -116,6 +116,21 @@ error[E0593]: function is expected to take 1 argument, but it takes 2 arguments\n LL |     let _it = vec![1, 2, 3].into_iter().map(usize::checked_add);\n    |                                         ^^^ expected function that takes 1 argument\n \n-error: aborting due to 12 previous errors\n+error[E0593]: function is expected to take 0 arguments, but it takes 1 argument\n+  --> $DIR/closure-arg-count.rs:43:5\n+   |\n+LL |     call(Foo);\n+   |     ^^^^ expected function that takes 0 arguments\n+...\n+LL | struct Foo(u8);\n+   | --------------- takes 1 argument\n+   |\n+note: required by `call`\n+  --> $DIR/closure-arg-count.rs:50:1\n+   |\n+LL | fn call<F, R>(_: F) where F: FnOnce() -> R {}\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+error: aborting due to 13 previous errors\n \n For more information about this error, try `rustc --explain E0593`."}]}