{"sha": "611191f54c563587a9130b8cb4afba1856aebebc", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYxMTE5MWY1NGM1NjM1ODdhOTEzMGI4Y2I0YWZiYTE4NTZhZWJlYmM=", "commit": {"author": {"name": "Aaron Hill", "email": "aa1ronham@gmail.com", "date": "2021-08-27T22:34:48Z"}, "committer": {"name": "Aaron Hill", "email": "aa1ronham@gmail.com", "date": "2021-09-02T16:49:32Z"}, "message": "Report cycle error using 'deepest' obligation in the cycle", "tree": {"sha": "a73f50f15f95da1e840cac2bf931ce7ac254b4a0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a73f50f15f95da1e840cac2bf931ce7ac254b4a0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/611191f54c563587a9130b8cb4afba1856aebebc", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE7J9Gc3TfBwj2K399tAh+UQ6YsWQFAmExAJ0ACgkQtAh+UQ6Y\nsWQGMQ//ak1gt/dtJEL83zn5FgRCl06R6wL7nQAn6UYrbPUToDZpXURWk5eSbY87\n6B/t7Oqkgy/WB1Ls6tb7aRYYUyc2FRz2feMMkOyKjZq1Cehvk9NcpOVwK+qmGJmN\nqS/u6QQM9SisZW3Ol26dRRF0L56l+XFH8G+HdcfdZCkh4Dsuh9IrCZ13OxPSCOVh\ngVYLM8WmspnyA9p7adWBeSGbYVxlVXGaqRI+QxyQYFTeBrPZhSloBv5A3jHtDB/1\nAZlWms9G1X+7mBUpmshczqmIQAU9AAOQONTCDTwuPsO5dj8QCx6eKaaEOVlN3wCc\nYezu8a41biis+nJHtXDiiWhXQhp1jh+JFEmjYHA1uh8oxnFj5PXxdape7QAWI2iR\nYLm1UkDxotxnLKJ3j89eR9olQHnZzPIW3Ix1nnUqEVFsF/4Smm6WqMnFfZKWQ19F\nHRtaTUSix2tyYwMrQLFhOr6M8Y1KApG3au7Y9/C4I2LfW2gq+AHj45iMlu3j+Rix\nw3Xx+SXpz1wO6/oqgoS7ciJVxxC+053Fs/jdCG8oFfH+hu4moTZ8+hdKiIZXnVdG\nT8AkcYj5LPRueNiExJdsW6CsqsxiBGhQfE8LIb7dhh5ZYvJsozEXfe280hUk42qM\nw2ZGjrjOHFzSpRDJ+Uwmf1kBYXmWFpBFLP1vo3mPxUw8/zZOphE=\n=hgY4\n-----END PGP SIGNATURE-----", "payload": "tree a73f50f15f95da1e840cac2bf931ce7ac254b4a0\nparent f2d9ee9c342104880dd978e85260243d2dcedc9a\nauthor Aaron Hill <aa1ronham@gmail.com> 1630103688 -0500\ncommitter Aaron Hill <aa1ronham@gmail.com> 1630601372 -0500\n\nReport cycle error using 'deepest' obligation in the cycle\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/611191f54c563587a9130b8cb4afba1856aebebc", "html_url": "https://github.com/rust-lang/rust/commit/611191f54c563587a9130b8cb4afba1856aebebc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/611191f54c563587a9130b8cb4afba1856aebebc/comments", "author": {"login": "Aaron1011", "id": 1408859, "node_id": "MDQ6VXNlcjE0MDg4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aaron1011", "html_url": "https://github.com/Aaron1011", "followers_url": "https://api.github.com/users/Aaron1011/followers", "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}", "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions", "organizations_url": "https://api.github.com/users/Aaron1011/orgs", "repos_url": "https://api.github.com/users/Aaron1011/repos", "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Aaron1011/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Aaron1011", "id": 1408859, "node_id": "MDQ6VXNlcjE0MDg4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aaron1011", "html_url": "https://github.com/Aaron1011", "followers_url": "https://api.github.com/users/Aaron1011/followers", "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}", "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions", "organizations_url": "https://api.github.com/users/Aaron1011/orgs", "repos_url": "https://api.github.com/users/Aaron1011/repos", "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Aaron1011/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f2d9ee9c342104880dd978e85260243d2dcedc9a", "url": "https://api.github.com/repos/rust-lang/rust/commits/f2d9ee9c342104880dd978e85260243d2dcedc9a", "html_url": "https://github.com/rust-lang/rust/commit/f2d9ee9c342104880dd978e85260243d2dcedc9a"}], "stats": {"total": 61, "additions": 41, "deletions": 20}, "files": [{"sha": "254ada7cf1ffb01478c0f3dbffa8f0bba96f576f", "filename": "compiler/rustc_trait_selection/src/traits/error_reporting/mod.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/611191f54c563587a9130b8cb4afba1856aebebc/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ferror_reporting%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/611191f54c563587a9130b8cb4afba1856aebebc/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ferror_reporting%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ferror_reporting%2Fmod.rs?ref=611191f54c563587a9130b8cb4afba1856aebebc", "patch": "@@ -224,7 +224,9 @@ impl<'a, 'tcx> InferCtxtExt<'tcx> for InferCtxt<'a, 'tcx> {\n \n         debug!(\"report_overflow_error_cycle: cycle={:?}\", cycle);\n \n-        self.report_overflow_error(&cycle[0], false);\n+        // The 'deepest' obligation is most likely to have a useful\n+        // cause 'backtrace'\n+        self.report_overflow_error(cycle.iter().max_by_key(|p| p.recursion_depth).unwrap(), false);\n     }\n \n     fn report_selection_error("}, {"sha": "5ff7b19d8945e635434250ddce7012c63f42e947", "filename": "src/test/incremental/const-generics/hash-tyvid-regression-1.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fincremental%2Fconst-generics%2Fhash-tyvid-regression-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fincremental%2Fconst-generics%2Fhash-tyvid-regression-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fincremental%2Fconst-generics%2Fhash-tyvid-regression-1.rs?ref=611191f54c563587a9130b8cb4afba1856aebebc", "patch": "@@ -9,7 +9,8 @@ where\n     use std::convert::TryFrom;\n     <[T; N.get()]>::try_from(())\n     //~^ error: the trait bound\n-    //~^^ error: mismatched types\n+    //~| error: the trait bound\n+    //~| error: mismatched types\n }\n \n fn main() {}"}, {"sha": "94e718317e7c8c79c79ad2df655d3b9f3c4c475f", "filename": "src/test/ui/traits/cycle-cache-err-60010.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fui%2Ftraits%2Fcycle-cache-err-60010.rs", "raw_url": "https://github.com/rust-lang/rust/raw/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fui%2Ftraits%2Fcycle-cache-err-60010.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Fcycle-cache-err-60010.rs?ref=611191f54c563587a9130b8cb4afba1856aebebc", "patch": "@@ -25,7 +25,7 @@ struct Runtime<DB: Database> {\n }\n struct SalsaStorage {\n     _parse: <ParseQuery as Query<RootDatabase>>::Data,\n-    //~^ ERROR overflow evaluating the requirement `RootDatabase: SourceDatabase`\n+    //~^ ERROR overflow\n }\n \n impl Database for RootDatabase {"}, {"sha": "9452e11e302e318eca4fc884087be42ec4837f0d", "filename": "src/test/ui/traits/cycle-cache-err-60010.stderr", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fui%2Ftraits%2Fcycle-cache-err-60010.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fui%2Ftraits%2Fcycle-cache-err-60010.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Fcycle-cache-err-60010.stderr?ref=611191f54c563587a9130b8cb4afba1856aebebc", "patch": "@@ -1,9 +1,27 @@\n-error[E0275]: overflow evaluating the requirement `RootDatabase: SourceDatabase`\n+error[E0275]: overflow evaluating the requirement `SalsaStorage: RefUnwindSafe`\n   --> $DIR/cycle-cache-err-60010.rs:27:13\n    |\n LL |     _parse: <ParseQuery as Query<RootDatabase>>::Data,\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n+   = note: required because it appears within the type `*const SalsaStorage`\n+   = note: required because it appears within the type `Unique<SalsaStorage>`\n+   = note: required because it appears within the type `Box<SalsaStorage>`\n+note: required because it appears within the type `Runtime<RootDatabase>`\n+  --> $DIR/cycle-cache-err-60010.rs:23:8\n+   |\n+LL | struct Runtime<DB: Database> {\n+   |        ^^^^^^^\n+note: required because it appears within the type `RootDatabase`\n+  --> $DIR/cycle-cache-err-60010.rs:20:8\n+   |\n+LL | struct RootDatabase {\n+   |        ^^^^^^^^^^^^\n+note: required because of the requirements on the impl of `SourceDatabase` for `RootDatabase`\n+  --> $DIR/cycle-cache-err-60010.rs:44:9\n+   |\n+LL | impl<T> SourceDatabase for T\n+   |         ^^^^^^^^^^^^^^     ^\n note: required because of the requirements on the impl of `Query<RootDatabase>` for `ParseQuery`\n   --> $DIR/cycle-cache-err-60010.rs:37:10\n    |"}, {"sha": "8be42fc4ad07fb277537d32476d40bf29618789e", "filename": "src/test/ui/traits/inductive-overflow/lifetime.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fui%2Ftraits%2Finductive-overflow%2Flifetime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fui%2Ftraits%2Finductive-overflow%2Flifetime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Finductive-overflow%2Flifetime.rs?ref=611191f54c563587a9130b8cb4afba1856aebebc", "patch": "@@ -15,8 +15,8 @@ impl<'a> Y for C<'a> {\n struct C<'a>(&'a ());\n struct X<T: Y>(T::P);\n \n-impl<T: NotAuto> NotAuto for Box<T> {}\n-impl<T: Y> NotAuto for X<T> where T::P: NotAuto {} //~ NOTE: required\n+impl<T: NotAuto> NotAuto for Box<T> {} //~ NOTE: required\n+impl<T: Y> NotAuto for X<T> where T::P: NotAuto {}\n impl<'a> NotAuto for C<'a> {}\n \n fn is_send<S: NotAuto>() {}\n@@ -26,6 +26,6 @@ fn main() {\n     // Should only be a few notes.\n     is_send::<X<C<'static>>>();\n     //~^ ERROR overflow evaluating\n-    //~| 2 redundant requirements hidden\n+    //~| 3 redundant requirements hidden\n     //~| required because of\n }"}, {"sha": "2ffcdb0e1c6dec5826e5313a229b2f3f8daabb69", "filename": "src/test/ui/traits/inductive-overflow/lifetime.stderr", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fui%2Ftraits%2Finductive-overflow%2Flifetime.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fui%2Ftraits%2Finductive-overflow%2Flifetime.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Finductive-overflow%2Flifetime.stderr?ref=611191f54c563587a9130b8cb4afba1856aebebc", "patch": "@@ -1,15 +1,15 @@\n-error[E0275]: overflow evaluating the requirement `Box<X<C<'_>>>: NotAuto`\n+error[E0275]: overflow evaluating the requirement `X<C<'_>>: NotAuto`\n   --> $DIR/lifetime.rs:27:5\n    |\n LL |     is_send::<X<C<'static>>>();\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n-note: required because of the requirements on the impl of `NotAuto` for `X<C<'_>>`\n-  --> $DIR/lifetime.rs:19:12\n+note: required because of the requirements on the impl of `NotAuto` for `Box<X<C<'_>>>`\n+  --> $DIR/lifetime.rs:18:18\n    |\n-LL | impl<T: Y> NotAuto for X<T> where T::P: NotAuto {}\n-   |            ^^^^^^^     ^^^^\n-   = note: 2 redundant requirements hidden\n+LL | impl<T: NotAuto> NotAuto for Box<T> {}\n+   |                  ^^^^^^^     ^^^^^^\n+   = note: 3 redundant requirements hidden\n    = note: required because of the requirements on the impl of `NotAuto` for `X<C<'static>>`\n note: required by a bound in `is_send`\n   --> $DIR/lifetime.rs:22:15"}, {"sha": "230c2638c50037458910032827ef8fbf18b64971", "filename": "src/test/ui/traits/inductive-overflow/simultaneous.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fui%2Ftraits%2Finductive-overflow%2Fsimultaneous.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fui%2Ftraits%2Finductive-overflow%2Fsimultaneous.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Finductive-overflow%2Fsimultaneous.stderr?ref=611191f54c563587a9130b8cb4afba1856aebebc", "patch": "@@ -1,4 +1,4 @@\n-error[E0275]: overflow evaluating the requirement `{integer}: Tweedledee`\n+error[E0275]: overflow evaluating the requirement `{integer}: Tweedledum`\n   --> $DIR/simultaneous.rs:18:5\n    |\n LL |     is_ee(4);"}, {"sha": "86b3f87d34d03c73eea9fd33e583e13da477c40d", "filename": "src/test/ui/type-alias-impl-trait/auto-trait-leakage3.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fauto-trait-leakage3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fauto-trait-leakage3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fauto-trait-leakage3.stderr?ref=611191f54c563587a9130b8cb4afba1856aebebc", "patch": "@@ -5,10 +5,10 @@ LL |     type Foo = impl std::fmt::Debug;\n    |                ^^^^^^^^^^^^^^^^^^^^\n    |\n note: ...which requires type-checking `m::bar`...\n-  --> $DIR/auto-trait-leakage3.rs:14:5\n+  --> $DIR/auto-trait-leakage3.rs:15:9\n    |\n-LL |     pub fn bar() {\n-   |     ^^^^^^^^^^^^\n+LL |         is_send(foo());\n+   |         ^^^^^^^\n    = note: ...which requires evaluating trait selection obligation `impl std::fmt::Debug: std::marker::Send`...\n    = note: ...which again requires computing type of `m::Foo::{opaque#0}`, completing the cycle\n note: cycle used when checking item types in module `m`"}, {"sha": "4c5921c7f660ba6d51d9943008ababc928b1da19", "filename": "src/test/ui/type-alias-impl-trait/inference-cycle.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Finference-cycle.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/611191f54c563587a9130b8cb4afba1856aebebc/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Finference-cycle.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Finference-cycle.stderr?ref=611191f54c563587a9130b8cb4afba1856aebebc", "patch": "@@ -5,10 +5,10 @@ LL |     type Foo = impl std::fmt::Debug;\n    |                ^^^^^^^^^^^^^^^^^^^^\n    |\n note: ...which requires type-checking `m::bar`...\n-  --> $DIR/inference-cycle.rs:14:5\n+  --> $DIR/inference-cycle.rs:15:9\n    |\n-LL |     pub fn bar() {\n-   |     ^^^^^^^^^^^^\n+LL |         is_send(foo()); // Today: error\n+   |         ^^^^^^^\n    = note: ...which requires evaluating trait selection obligation `impl std::fmt::Debug: std::marker::Send`...\n    = note: ...which again requires computing type of `m::Foo::{opaque#0}`, completing the cycle\n note: cycle used when checking item types in module `m`"}]}