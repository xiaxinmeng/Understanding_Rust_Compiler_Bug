{"sha": "e8bb7bf35a0d5066a081cfa9a581849e34a91e02", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU4YmI3YmYzNWEwZDUwNjZhMDgxY2ZhOWE1ODE4NDllMzRhOTFlMDI=", "commit": {"author": {"name": "Igor Matuszewski", "email": "Xanewok@gmail.com", "date": "2018-08-06T12:07:08Z"}, "committer": {"name": "Igor Matuszewski", "email": "Xanewok@gmail.com", "date": "2018-08-06T12:07:08Z"}, "message": "Account for --remap-path-prefix in save-analysis", "tree": {"sha": "6dd867c3846ffb8248dd1a661bf33afc30f9c18e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6dd867c3846ffb8248dd1a661bf33afc30f9c18e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e8bb7bf35a0d5066a081cfa9a581849e34a91e02", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e8bb7bf35a0d5066a081cfa9a581849e34a91e02", "html_url": "https://github.com/rust-lang/rust/commit/e8bb7bf35a0d5066a081cfa9a581849e34a91e02", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e8bb7bf35a0d5066a081cfa9a581849e34a91e02/comments", "author": {"login": "Xanewok", "id": 3093213, "node_id": "MDQ6VXNlcjMwOTMyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3093213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Xanewok", "html_url": "https://github.com/Xanewok", "followers_url": "https://api.github.com/users/Xanewok/followers", "following_url": "https://api.github.com/users/Xanewok/following{/other_user}", "gists_url": "https://api.github.com/users/Xanewok/gists{/gist_id}", "starred_url": "https://api.github.com/users/Xanewok/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Xanewok/subscriptions", "organizations_url": "https://api.github.com/users/Xanewok/orgs", "repos_url": "https://api.github.com/users/Xanewok/repos", "events_url": "https://api.github.com/users/Xanewok/events{/privacy}", "received_events_url": "https://api.github.com/users/Xanewok/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Xanewok", "id": 3093213, "node_id": "MDQ6VXNlcjMwOTMyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3093213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Xanewok", "html_url": "https://github.com/Xanewok", "followers_url": "https://api.github.com/users/Xanewok/followers", "following_url": "https://api.github.com/users/Xanewok/following{/other_user}", "gists_url": "https://api.github.com/users/Xanewok/gists{/gist_id}", "starred_url": "https://api.github.com/users/Xanewok/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Xanewok/subscriptions", "organizations_url": "https://api.github.com/users/Xanewok/orgs", "repos_url": "https://api.github.com/users/Xanewok/repos", "events_url": "https://api.github.com/users/Xanewok/events{/privacy}", "received_events_url": "https://api.github.com/users/Xanewok/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7c98d2e63f732682b057c8c453b08f9e12b262e6", "url": "https://api.github.com/repos/rust-lang/rust/commits/7c98d2e63f732682b057c8c453b08f9e12b262e6", "html_url": "https://github.com/rust-lang/rust/commit/7c98d2e63f732682b057c8c453b08f9e12b262e6"}], "stats": {"total": 8, "additions": 3, "deletions": 5}, "files": [{"sha": "431147e0829af65531c7bddacfbcf41c037a17f0", "filename": "src/librustc_save_analysis/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e8bb7bf35a0d5066a081cfa9a581849e34a91e02/src%2Flibrustc_save_analysis%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e8bb7bf35a0d5066a081cfa9a581849e34a91e02/src%2Flibrustc_save_analysis%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_save_analysis%2Flib.rs?ref=e8bb7bf35a0d5066a081cfa9a581849e34a91e02", "patch": "@@ -125,7 +125,7 @@ impl<'l, 'tcx: 'l> SaveContext<'l, 'tcx> {\n             result.push(ExternalCrateData {\n                 // FIXME: change file_name field to PathBuf in rls-data\n                 // https://github.com/nrc/rls-data/issues/7\n-                file_name: SpanUtils::make_path_string(&lo_loc.file.name),\n+                file_name: self.span_utils.make_path_string(&lo_loc.file.name),\n                 num: n.as_u32(),\n                 id: GlobalCrateId {\n                     name: self.tcx.crate_name(n).to_string(),"}, {"sha": "85dd2a3a20683e79dfe13a1ce40566c046bbc739", "filename": "src/librustc_save_analysis/span_utils.rs", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/e8bb7bf35a0d5066a081cfa9a581849e34a91e02/src%2Flibrustc_save_analysis%2Fspan_utils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e8bb7bf35a0d5066a081cfa9a581849e34a91e02/src%2Flibrustc_save_analysis%2Fspan_utils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_save_analysis%2Fspan_utils.rs?ref=e8bb7bf35a0d5066a081cfa9a581849e34a91e02", "patch": "@@ -13,7 +13,6 @@ use rustc::session::Session;\n use generated_code;\n \n use std::cell::Cell;\n-use std::env;\n \n use syntax::parse::lexer::{self, StringReader};\n use syntax::parse::token::{self, Token};\n@@ -36,11 +35,10 @@ impl<'a> SpanUtils<'a> {\n         }\n     }\n \n-    pub fn make_path_string(path: &FileName) -> String {\n+    pub fn make_path_string(&self, path: &FileName) -> String {\n         match *path {\n             FileName::Real(ref path) if !path.is_absolute() =>\n-                env::current_dir()\n-                    .unwrap()\n+                self.sess.working_dir.0\n                     .join(&path)\n                     .display()\n                     .to_string(),"}]}