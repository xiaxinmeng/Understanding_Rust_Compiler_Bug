{"sha": "3fa36471e81011b7b1c44ec66c5aa70a67dfe475", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNmYTM2NDcxZTgxMDExYjdiMWM0NGVjNjZjNWFhNzBhNjdkZmU0NzU=", "commit": {"author": {"name": "Aaron Hill", "email": "aa1ronham@gmail.com", "date": "2019-01-21T03:04:22Z"}, "committer": {"name": "Aaron Hill", "email": "aa1ronham@gmail.com", "date": "2019-02-01T14:43:56Z"}, "message": "Rename external_private_dependency to exported_private_dependencies", "tree": {"sha": "d8b9adad999cfe4ca083605b1c62d8d7c8e4f3f1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d8b9adad999cfe4ca083605b1c62d8d7c8e4f3f1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3fa36471e81011b7b1c44ec66c5aa70a67dfe475", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE7J9Gc3TfBwj2K399tAh+UQ6YsWQFAlxUWywACgkQtAh+UQ6Y\nsWQq9hAAjLodicMdW8jrR09E+1WQxZmAvScKJrXUBQt18/zV8BrAw44S9h9YPUiU\nB9vcGEmgWru08sq7HyektTaU1t27CEbCYLuXbcSOo7pTkWOPTlg72eEg9U/JB0C5\neC0abfjouOeOpbAPe7wXpuJJ22B6xYwfLg0NkgkEeucM89pXudvyTF+yS6m9wHYr\nbhSZt766NViXnm1nS88jsRPgroGv6mJRqXuPV+37lzGRToW67W0jPalQF2fEcS4e\nT3vM/GFp5mUY5KQKZtXOml8ueZTHVCNtWE1nqIYi0r11IG+zMP8BGnoq430RxKge\nq8ePYyrSF4qOuds0tI56Loj1COXaFtnlLya9EwvfSl/wZIMPouiDhJR6uJw6NSBv\nc8lmBGqF1WFDrYH525xJNIPx/yd27CYL3KJj6ESCtsiifx0tQP9w6c7nBDUvqXuH\nimtqYHbQG+6ZLOws7U1VagCt801Jy7kTWWKXNChITDuIXuw5e2TNbLuKsk1hm/aH\npDaqr808zEbjAnxTugR2QAehsVMIN3NIiZJDPLbJLT9B6tMxGYuhya0+0MApIwTJ\nRzn0prIyy8bJdps37njzYD2JCFFnx218h4KKetDcVEPiK+BVKjmSFlPhj7nzNoUW\nS6tfVWXMwrx0YL+UI0G8pMgayF5hMipVGHbdup+YO/DrxpbkHw4=\n=wYUI\n-----END PGP SIGNATURE-----", "payload": "tree d8b9adad999cfe4ca083605b1c62d8d7c8e4f3f1\nparent dfd26696674ecadc39aabcc94314cda8d571f71b\nauthor Aaron Hill <aa1ronham@gmail.com> 1548039862 -0500\ncommitter Aaron Hill <aa1ronham@gmail.com> 1549032236 -0500\n\nRename external_private_dependency to exported_private_dependencies\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3fa36471e81011b7b1c44ec66c5aa70a67dfe475", "html_url": "https://github.com/rust-lang/rust/commit/3fa36471e81011b7b1c44ec66c5aa70a67dfe475", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3fa36471e81011b7b1c44ec66c5aa70a67dfe475/comments", "author": {"login": "Aaron1011", "id": 1408859, "node_id": "MDQ6VXNlcjE0MDg4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aaron1011", "html_url": "https://github.com/Aaron1011", "followers_url": "https://api.github.com/users/Aaron1011/followers", "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}", "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions", "organizations_url": "https://api.github.com/users/Aaron1011/orgs", "repos_url": "https://api.github.com/users/Aaron1011/repos", "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Aaron1011/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Aaron1011", "id": 1408859, "node_id": "MDQ6VXNlcjE0MDg4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aaron1011", "html_url": "https://github.com/Aaron1011", "followers_url": "https://api.github.com/users/Aaron1011/followers", "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}", "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions", "organizations_url": "https://api.github.com/users/Aaron1011/orgs", "repos_url": "https://api.github.com/users/Aaron1011/repos", "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Aaron1011/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dfd26696674ecadc39aabcc94314cda8d571f71b", "url": "https://api.github.com/repos/rust-lang/rust/commits/dfd26696674ecadc39aabcc94314cda8d571f71b", "html_url": "https://github.com/rust-lang/rust/commit/dfd26696674ecadc39aabcc94314cda8d571f71b"}], "stats": {"total": 26, "additions": 14, "deletions": 12}, "files": [{"sha": "3fe544d690640d62c0ffbaf9e12c07b58a9ee535", "filename": "src/librustc/lint/builtin.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3fa36471e81011b7b1c44ec66c5aa70a67dfe475/src%2Flibrustc%2Flint%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3fa36471e81011b7b1c44ec66c5aa70a67dfe475/src%2Flibrustc%2Flint%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Flint%2Fbuiltin.rs?ref=3fa36471e81011b7b1c44ec66c5aa70a67dfe475", "patch": "@@ -126,7 +126,7 @@ declare_lint! {\n }\n \n declare_lint! {\n-    pub EXTERNAL_PRIVATE_DEPENDENCY,\n+    pub EXPORTED_PRIVATE_DEPENDENCIES,\n     Warn,\n     \"public interface leaks type from a private dependency\"\n }\n@@ -411,7 +411,7 @@ impl LintPass for HardwiredLints {\n             TRIVIAL_CASTS,\n             TRIVIAL_NUMERIC_CASTS,\n             PRIVATE_IN_PUBLIC,\n-            EXTERNAL_PRIVATE_DEPENDENCY,\n+            EXPORTED_PRIVATE_DEPENDENCIES,\n             PUB_USE_OF_PRIVATE_EXTERN_CRATE,\n             INVALID_TYPE_PARAM_DEFAULT,\n             CONST_ERR,"}, {"sha": "128bc70087f9484d0609702526598d78d37cc4e5", "filename": "src/librustc_lint/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3fa36471e81011b7b1c44ec66c5aa70a67dfe475/src%2Flibrustc_lint%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3fa36471e81011b7b1c44ec66c5aa70a67dfe475/src%2Flibrustc_lint%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Flib.rs?ref=3fa36471e81011b7b1c44ec66c5aa70a67dfe475", "patch": "@@ -230,7 +230,7 @@ pub fn register_builtins(store: &mut lint::LintStore, sess: Option<&Session>) {\n             edition: None,\n         },\n         FutureIncompatibleInfo {\n-            id: LintId::of(EXTERNAL_PRIVATE_DEPENDENCY),\n+            id: LintId::of(EXPORTED_PRIVATE_DEPENDENCIES),\n             reference: \"issue #44663 <https://github.com/rust-lang/rust/issues/44663>\",\n             edition: None,\n         },"}, {"sha": "01694df1df106b3b4a8ac5189ff044c7d316a029", "filename": "src/librustc_privacy/lib.rs", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/3fa36471e81011b7b1c44ec66c5aa70a67dfe475/src%2Flibrustc_privacy%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3fa36471e81011b7b1c44ec66c5aa70a67dfe475/src%2Flibrustc_privacy%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_privacy%2Flib.rs?ref=3fa36471e81011b7b1c44ec66c5aa70a67dfe475", "patch": "@@ -1496,7 +1496,7 @@ impl<'a, 'tcx: 'a> SearchInterfaceForPrivateItemsVisitor<'a, 'tcx> {\n \n     fn check_def_id(&mut self, def_id: DefId, kind: &str, descr: &dyn fmt::Display) -> bool {\n         if self.leaks_private_dep(def_id) {\n-            self.tcx.lint_node(lint::builtin::EXTERNAL_PRIVATE_DEPENDENCY,\n+            self.tcx.lint_node(lint::builtin::EXPORTED_PRIVATE_DEPENDENCIES,\n                                self.item_id,\n                                self.span,\n                                &format!(\"{} `{}` from private dependency '{}' in public \\\n@@ -1726,9 +1726,6 @@ pub fn check_crate<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>) -> Lrc<AccessLevels> {\n fn check_mod_privacy<'tcx>(tcx: TyCtxt<'_, 'tcx, 'tcx>, module_def_id: DefId) {\n     let empty_tables = ty::TypeckTables::empty(None);\n \n-    let public_crates: FxHashSet<CrateNum> = tcx.sess.opts.extern_public.iter().flat_map(|c| {\n-        tcx.crates().iter().find(|&&krate| &tcx.crate_name(krate) == c).cloned()\n-    }).collect();\n \n     // Check privacy of names not checked in previous compilation stages.\n     let mut visitor = NamePrivacyVisitor {\n@@ -1765,6 +1762,11 @@ fn privacy_access_levels<'tcx>(\n         queries::check_mod_privacy::ensure(tcx, tcx.hir().local_def_id(module));\n     }\n \n+    let public_crates: FxHashSet<CrateNum> = tcx.sess.opts.extern_public.iter().flat_map(|c| {\n+        tcx.crates().iter().find(|&&krate| &tcx.crate_name(krate) == c).cloned()\n+    }).collect();\n+\n+\n     // Build up a set of all exported items in the AST. This is a set of all\n     // items which are reachable from external crates based on visibility.\n     let mut visitor = EmbargoVisitor {"}, {"sha": "b8fb4b8dc19da8022dfad013f6b5654e137fa8ee", "filename": "src/test/ui/feature-gates/feature-gate-public_private_dependencies.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3fa36471e81011b7b1c44ec66c5aa70a67dfe475/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-public_private_dependencies.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3fa36471e81011b7b1c44ec66c5aa70a67dfe475/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-public_private_dependencies.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-public_private_dependencies.rs?ref=3fa36471e81011b7b1c44ec66c5aa70a67dfe475", "patch": "@@ -9,7 +9,7 @@\n \n // Without ![feature(public_private_dependencies)],\n // this should do nothing/\n-#![deny(external_private_dependency)]\n+#![deny(exported_private_dependencies)]\n \n extern crate pub_dep;\n "}, {"sha": "7d71dbe6392d424947b745ad9d0d24cc6627fc77", "filename": "src/test/ui/privacy/pub-priv-dep/pub-priv1.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3fa36471e81011b7b1c44ec66c5aa70a67dfe475/src%2Ftest%2Fui%2Fprivacy%2Fpub-priv-dep%2Fpub-priv1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3fa36471e81011b7b1c44ec66c5aa70a67dfe475/src%2Ftest%2Fui%2Fprivacy%2Fpub-priv-dep%2Fpub-priv1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fprivacy%2Fpub-priv-dep%2Fpub-priv1.rs?ref=3fa36471e81011b7b1c44ec66c5aa70a67dfe475", "patch": "@@ -2,7 +2,7 @@\n  // aux-build:pub_dep.rs\n  // compile-flags: --extern-public=pub_dep\n #![feature(public_private_dependencies)]\n-#![deny(external_private_dependency)]\n+#![deny(exported_private_dependencies)]\n \n // This crate is a private dependency\n extern crate priv_dep;"}, {"sha": "11f4be8cbbc129eabf43cc94b5db443660257219", "filename": "src/test/ui/privacy/pub-priv-dep/pub-priv1.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3fa36471e81011b7b1c44ec66c5aa70a67dfe475/src%2Ftest%2Fui%2Fprivacy%2Fpub-priv-dep%2Fpub-priv1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3fa36471e81011b7b1c44ec66c5aa70a67dfe475/src%2Ftest%2Fui%2Fprivacy%2Fpub-priv-dep%2Fpub-priv1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fprivacy%2Fpub-priv-dep%2Fpub-priv1.stderr?ref=3fa36471e81011b7b1c44ec66c5aa70a67dfe475", "patch": "@@ -7,8 +7,8 @@ LL |     pub field: OtherType,\n note: lint level defined here\n   --> $DIR/pub-priv1.rs:5:9\n    |\n-LL | #![deny(external_private_dependency)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL | #![deny(exported_private_dependencies)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n    = note: for more information, see issue #44663 <https://github.com/rust-lang/rust/issues/44663>\n "}, {"sha": "3c1520c69027dd5a3ed45122f9c0b4bf8708ce58", "filename": "src/test/ui/privacy/pub-priv-dep/std-pub.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3fa36471e81011b7b1c44ec66c5aa70a67dfe475/src%2Ftest%2Fui%2Fprivacy%2Fpub-priv-dep%2Fstd-pub.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3fa36471e81011b7b1c44ec66c5aa70a67dfe475/src%2Ftest%2Fui%2Fprivacy%2Fpub-priv-dep%2Fstd-pub.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fprivacy%2Fpub-priv-dep%2Fstd-pub.rs?ref=3fa36471e81011b7b1c44ec66c5aa70a67dfe475", "patch": "@@ -4,7 +4,7 @@\n // run-pass\n \n #![feature(public_private_dependencies)]\n-#![deny(external_private_dependency)]\n+#![deny(exported_private_dependencies)]\n \n pub struct PublicType {\n     pub field: Option<u8>"}]}