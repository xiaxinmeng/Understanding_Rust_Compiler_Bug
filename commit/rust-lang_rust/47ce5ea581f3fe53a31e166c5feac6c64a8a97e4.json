{"sha": "47ce5ea581f3fe53a31e166c5feac6c64a8a97e4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ3Y2U1ZWE1ODFmM2ZlNTNhMzFlMTY2YzVmZWFjNmM2NGE4YTk3ZTQ=", "commit": {"author": {"name": "George Fraser", "email": "george@fivetran.com", "date": "2020-05-13T04:58:51Z"}, "committer": {"name": "George Fraser", "email": "george@fivetran.com", "date": "2020-05-19T05:55:46Z"}, "message": "Color attribute functions", "tree": {"sha": "37bc450feec198b84ec58f64b72a946ae08758d3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/37bc450feec198b84ec58f64b72a946ae08758d3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4", "html_url": "https://github.com/rust-lang/rust/commit/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4/comments", "author": {"login": "georgewfraser", "id": 1369240, "node_id": "MDQ6VXNlcjEzNjkyNDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1369240?v=4", "gravatar_id": "", "url": "https://api.github.com/users/georgewfraser", "html_url": "https://github.com/georgewfraser", "followers_url": "https://api.github.com/users/georgewfraser/followers", "following_url": "https://api.github.com/users/georgewfraser/following{/other_user}", "gists_url": "https://api.github.com/users/georgewfraser/gists{/gist_id}", "starred_url": "https://api.github.com/users/georgewfraser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/georgewfraser/subscriptions", "organizations_url": "https://api.github.com/users/georgewfraser/orgs", "repos_url": "https://api.github.com/users/georgewfraser/repos", "events_url": "https://api.github.com/users/georgewfraser/events{/privacy}", "received_events_url": "https://api.github.com/users/georgewfraser/received_events", "type": "User", "site_admin": false}, "committer": {"login": "georgewfraser", "id": 1369240, "node_id": "MDQ6VXNlcjEzNjkyNDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1369240?v=4", "gravatar_id": "", "url": "https://api.github.com/users/georgewfraser", "html_url": "https://github.com/georgewfraser", "followers_url": "https://api.github.com/users/georgewfraser/followers", "following_url": "https://api.github.com/users/georgewfraser/following{/other_user}", "gists_url": "https://api.github.com/users/georgewfraser/gists{/gist_id}", "starred_url": "https://api.github.com/users/georgewfraser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/georgewfraser/subscriptions", "organizations_url": "https://api.github.com/users/georgewfraser/orgs", "repos_url": "https://api.github.com/users/georgewfraser/repos", "events_url": "https://api.github.com/users/georgewfraser/events{/privacy}", "received_events_url": "https://api.github.com/users/georgewfraser/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "38e8f35855efac144373c1b5aab3af050e47e594", "url": "https://api.github.com/repos/rust-lang/rust/commits/38e8f35855efac144373c1b5aab3af050e47e594", "html_url": "https://github.com/rust-lang/rust/commit/38e8f35855efac144373c1b5aab3af050e47e594"}], "stats": {"total": 28, "additions": 24, "deletions": 4}, "files": [{"sha": "2ceadf2fcbf75b2625927c079b97e04f8278be14", "filename": "crates/ra_ide/src/snapshots/highlighting.html", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4/crates%2Fra_ide%2Fsrc%2Fsnapshots%2Fhighlighting.html", "raw_url": "https://github.com/rust-lang/rust/raw/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4/crates%2Fra_ide%2Fsrc%2Fsnapshots%2Fhighlighting.html", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide%2Fsrc%2Fsnapshots%2Fhighlighting.html?ref=47ce5ea581f3fe53a31e166c5feac6c64a8a97e4", "patch": "@@ -27,7 +27,7 @@\n .keyword.unsafe     { color: #BC8383; font-weight: bold; }\n .control            { font-style: italic; }\n </style>\n-<pre><code><span class=\"attribute\">#[derive(Clone, Debug)]</span>\n+<pre><code><span class=\"attribute\">#[</span><span class=\"function attribute\">derive</span><span class=\"attribute\">(Clone, Debug)]</span>\n <span class=\"keyword\">struct</span> <span class=\"struct declaration\">Foo</span> {\n     <span class=\"keyword\">pub</span> <span class=\"field declaration\">x</span>: <span class=\"builtin_type\">i32</span>,\n     <span class=\"keyword\">pub</span> <span class=\"field declaration\">y</span>: <span class=\"builtin_type\">i32</span>,"}, {"sha": "b55cf748dc08ea7333f4f68f5b11c10a2b2cd1d1", "filename": "crates/ra_ide/src/syntax_highlighting.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4/crates%2Fra_ide%2Fsrc%2Fsyntax_highlighting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4/crates%2Fra_ide%2Fsrc%2Fsyntax_highlighting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide%2Fsrc%2Fsyntax_highlighting.rs?ref=47ce5ea581f3fe53a31e166c5feac6c64a8a97e4", "patch": "@@ -361,7 +361,9 @@ fn highlight_element(\n         }\n \n         // Highlight references like the definitions they resolve to\n-        NAME_REF if element.ancestors().any(|it| it.kind() == ATTR) => return None,\n+        NAME_REF if element.ancestors().any(|it| it.kind() == ATTR) => {\n+            Highlight::from(HighlightTag::Function) | HighlightModifier::Attribute\n+        }\n         NAME_REF => {\n             let name_ref = element.into_node().and_then(ast::NameRef::cast).unwrap();\n             match classify_name_ref(sema, &name_ref) {"}, {"sha": "33e6619ec789d19a2c6b050ce649efbace44bd09", "filename": "crates/ra_ide/src/syntax_highlighting/tags.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4/crates%2Fra_ide%2Fsrc%2Fsyntax_highlighting%2Ftags.rs", "raw_url": "https://github.com/rust-lang/rust/raw/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4/crates%2Fra_ide%2Fsrc%2Fsyntax_highlighting%2Ftags.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide%2Fsrc%2Fsyntax_highlighting%2Ftags.rs?ref=47ce5ea581f3fe53a31e166c5feac6c64a8a97e4", "patch": "@@ -45,8 +45,10 @@ pub enum HighlightTag {\n #[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord)]\n #[repr(u8)]\n pub enum HighlightModifier {\n+    /// Used to differentiate individual elements within attributes.\n+    Attribute = 0,\n     /// Used with keywords like `if` and `break`.\n-    ControlFlow = 0,\n+    ControlFlow,\n     /// `foo` in `fn foo(x: i32)` is a definition, `foo` in `foo(90 + 2)` is\n     /// not.\n     Definition,\n@@ -95,6 +97,7 @@ impl fmt::Display for HighlightTag {\n \n impl HighlightModifier {\n     const ALL: &'static [HighlightModifier] = &[\n+        HighlightModifier::Attribute,\n         HighlightModifier::ControlFlow,\n         HighlightModifier::Definition,\n         HighlightModifier::Mutable,\n@@ -103,6 +106,7 @@ impl HighlightModifier {\n \n     fn as_str(self) -> &'static str {\n         match self {\n+            HighlightModifier::Attribute => \"attribute\",\n             HighlightModifier::ControlFlow => \"control\",\n             HighlightModifier::Definition => \"declaration\",\n             HighlightModifier::Mutable => \"mutable\","}, {"sha": "90a6257ee8e12470cec687dc804706d0228ac7bd", "filename": "crates/rust-analyzer/src/semantic_tokens.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4/crates%2Frust-analyzer%2Fsrc%2Fsemantic_tokens.rs", "raw_url": "https://github.com/rust-lang/rust/raw/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4/crates%2Frust-analyzer%2Fsrc%2Fsemantic_tokens.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fsemantic_tokens.rs?ref=47ce5ea581f3fe53a31e166c5feac6c64a8a97e4", "patch": "@@ -67,6 +67,7 @@ define_semantic_token_modifiers![\n     (CONTROL_FLOW, \"controlFlow\"),\n     (MUTABLE, \"mutable\"),\n     (UNSAFE, \"unsafe\"),\n+    (ATTRIBUTE_MODIFIER, \"attribute\"),\n ];\n \n #[derive(Default)]"}, {"sha": "09343f92517f75a5cb74525224bcc8fd628d3cb8", "filename": "crates/rust-analyzer/src/to_proto.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4/crates%2Frust-analyzer%2Fsrc%2Fto_proto.rs", "raw_url": "https://github.com/rust-lang/rust/raw/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4/crates%2Frust-analyzer%2Fsrc%2Fto_proto.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fto_proto.rs?ref=47ce5ea581f3fe53a31e166c5feac6c64a8a97e4", "patch": "@@ -296,6 +296,7 @@ fn semantic_token_type_and_modifiers(\n \n     for modifier in highlight.modifiers.iter() {\n         let modifier = match modifier {\n+            HighlightModifier::Attribute => semantic_tokens::ATTRIBUTE_MODIFIER,\n             HighlightModifier::Definition => lsp_types::SemanticTokenModifier::DECLARATION,\n             HighlightModifier::ControlFlow => semantic_tokens::CONTROL_FLOW,\n             HighlightModifier::Mutable => semantic_tokens::MUTABLE,"}, {"sha": "d078f74722012ef6ec7f7d98acc5603e140e2d50", "filename": "editors/code/package.json", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4/editors%2Fcode%2Fpackage.json", "raw_url": "https://github.com/rust-lang/rust/raw/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4/editors%2Fcode%2Fpackage.json", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fpackage.json?ref=47ce5ea581f3fe53a31e166c5feac6c64a8a97e4", "patch": "@@ -603,6 +603,10 @@\n             }\n         ],\n         \"semanticTokenModifiers\": [\n+            {\n+                \"id\": \"attribute\",\n+                \"description\": \"Style for elements within attributes\"\n+            },\n             {\n                 \"id\": \"constant\",\n                 \"description\": \"Style for compile-time constants\"\n@@ -630,6 +634,9 @@\n                     \"attribute\": [\n                         \"meta.attribute.rust\"\n                     ],\n+                    \"function.attribute\": [\n+                        \"entity.name.function.attribute.rust\"\n+                    ],\n                     \"builtinType\": [\n                         \"support.type.primitive.rust\"\n                     ],"}, {"sha": "cdcd557dc173426bf6fc635f6430d951766e71b8", "filename": "editors/code/rust.tmGrammar.json", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4/editors%2Fcode%2Frust.tmGrammar.json", "raw_url": "https://github.com/rust-lang/rust/raw/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4/editors%2Fcode%2Frust.tmGrammar.json", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Frust.tmGrammar.json?ref=47ce5ea581f3fe53a31e166c5feac6c64a8a97e4", "patch": "@@ -75,8 +75,13 @@\n \t\t{\n \t\t\t\"comment\": \"Attribute\",\n \t\t\t\"name\": \"meta.attribute.rust\",\n-\t\t\t\"begin\": \"#\\\\!?\\\\[\",\n+\t\t\t\"begin\": \"#\\\\!?\\\\[(\\\\w*)\",\n \t\t\t\"end\": \"\\\\]\",\n+\t\t\t\"captures\": {\n+\t\t\t\t\"1\": {\n+\t\t\t\t\t\"name\": \"entity.name.function.attribute.rust\"\n+\t\t\t\t}\n+\t\t\t},\n \t\t\t\"patterns\": [\n \t\t\t\t{\n \t\t\t\t\t\"include\": \"#string_literal\""}]}