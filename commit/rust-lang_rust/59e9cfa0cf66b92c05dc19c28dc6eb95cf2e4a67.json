{"sha": "59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU5ZTljZmEwY2Y2NmI5MmMwNWRjMTljMjhkYzZlYjk1Y2YyZTRhNjc=", "commit": {"author": {"name": "Jorge Aparicio", "email": "japaricious@gmail.com", "date": "2015-01-14T23:22:16Z"}, "committer": {"name": "Jorge Aparicio", "email": "japaricious@gmail.com", "date": "2015-01-14T23:41:27Z"}, "message": "use UFCS in `#[deriving(Hash)]`\n\nexpansion now uses `::std::hash::Hash::hash(&*__self_0_0, __arg_0)` instead of\n`(*__self_0_0).hash(__arg_0)`\n\ncloses #21160", "tree": {"sha": "60aaf74eb5c0ef5525113eb91bcc7fca0d8d4c83", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/60aaf74eb5c0ef5525113eb91bcc7fca0d8d4c83"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67", "html_url": "https://github.com/rust-lang/rust/commit/59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67/comments", "author": null, "committer": null, "parents": [{"sha": "896cb36ecab3eaeb7f101087e030e43771eca5ca", "url": "https://api.github.com/repos/rust-lang/rust/commits/896cb36ecab3eaeb7f101087e030e43771eca5ca", "html_url": "https://github.com/rust-lang/rust/commit/896cb36ecab3eaeb7f101087e030e43771eca5ca"}], "stats": {"total": 39, "additions": 37, "deletions": 2}, "files": [{"sha": "6e048e0e83cb58946cd4e133e1183a3b177ac5d4", "filename": "src/libcollections/btree/set.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67/src%2Flibcollections%2Fbtree%2Fset.rs", "raw_url": "https://github.com/rust-lang/rust/raw/59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67/src%2Flibcollections%2Fbtree%2Fset.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcollections%2Fbtree%2Fset.rs?ref=59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67", "patch": "@@ -18,6 +18,8 @@ use core::cmp::Ordering::{self, Less, Greater, Equal};\n use core::default::Default;\n use core::fmt::Show;\n use core::fmt;\n+// NOTE(stage0) remove import after a snapshot\n+#[cfg(stage0)]\n use core::hash::Hash;\n use core::iter::{Peekable, Map, FromIterator};\n use core::ops::{BitOr, BitAnd, BitXor, Sub};"}, {"sha": "43ca7b131455b4b2fb14f04bbaae74f704ead1b2", "filename": "src/libstd/io/process.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67/src%2Flibstd%2Fio%2Fprocess.rs", "raw_url": "https://github.com/rust-lang/rust/raw/59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67/src%2Flibstd%2Fio%2Fprocess.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fio%2Fprocess.rs?ref=59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67", "patch": "@@ -21,6 +21,8 @@ use prelude::v1::*;\n use collections::HashMap;\n use ffi::CString;\n use fmt;\n+// NOTE(stage0) remove import after a snapshot\n+#[cfg(stage0)]\n use hash::Hash;\n use io::pipe::{PipeStream, PipePair};\n use io::{IoResult, IoError};"}, {"sha": "98b7fae0341bf2f00fa1dd9cab830e642ef82598", "filename": "src/libsyntax/ext/deriving/hash.rs", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67/src%2Flibsyntax%2Fext%2Fderiving%2Fhash.rs", "raw_url": "https://github.com/rust-lang/rust/raw/59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67/src%2Flibsyntax%2Fext%2Fderiving%2Fhash.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Fderiving%2Fhash.rs?ref=59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67", "patch": "@@ -65,9 +65,19 @@ fn hash_substructure(cx: &mut ExtCtxt, trait_span: Span, substr: &Substructure)\n         [ref state_expr] => state_expr,\n         _ => cx.span_bug(trait_span, \"incorrect number of arguments in `deriving(Hash)`\")\n     };\n-    let hash_ident = substr.method_ident;\n+    let hash_path = {\n+        let strs = vec![\n+            cx.ident_of(\"std\"),\n+            cx.ident_of(\"hash\"),\n+            cx.ident_of(\"Hash\"),\n+            cx.ident_of(\"hash\"),\n+        ];\n+\n+        cx.expr_path(cx.path_global(trait_span, strs))\n+    };\n     let call_hash = |&: span, thing_expr| {\n-        let expr = cx.expr_method_call(span, thing_expr, hash_ident, vec!(state_expr.clone()));\n+        let ref_thing = cx.expr_addr_of(span, thing_expr);\n+        let expr = cx.expr_call(span, hash_path.clone(), vec!(ref_thing, state_expr.clone()));\n         cx.stmt_expr(expr)\n     };\n     let mut stmts = Vec::new();"}, {"sha": "30ed4f439403fb7583c8288becb133c997c2ffec", "filename": "src/test/compile-fail/issue-21160.rs", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67/src%2Ftest%2Fcompile-fail%2Fissue-21160.rs", "raw_url": "https://github.com/rust-lang/rust/raw/59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67/src%2Ftest%2Fcompile-fail%2Fissue-21160.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-21160.rs?ref=59e9cfa0cf66b92c05dc19c28dc6eb95cf2e4a67", "patch": "@@ -0,0 +1,21 @@\n+// Copyright 2015 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+struct Bar;\n+\n+impl Bar {\n+    fn hash<T>(&self, _: T) {}\n+}\n+\n+#[derive(Hash)]\n+//~^ error: the trait `core::hash::Hash<__S>` is not implemented for the type `Bar`\n+struct Foo(Bar);\n+\n+fn main() {}"}]}