{"sha": "271c163ba319ce8518913057cef32978f38b2f6a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI3MWMxNjNiYTMxOWNlODUxODkxMzA1N2NlZjMyOTc4ZjM4YjJmNmE=", "commit": {"author": {"name": "daxpedda", "email": "daxpedda@gmail.com", "date": "2021-04-10T18:54:40Z"}, "committer": {"name": "daxpedda", "email": "daxpedda@gmail.com", "date": "2021-04-10T18:54:40Z"}, "message": "Fix false-positive `debug_assert`", "tree": {"sha": "dacd684c99431f4c1fd03961a4ffdb98c5df0a62", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/dacd684c99431f4c1fd03961a4ffdb98c5df0a62"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/271c163ba319ce8518913057cef32978f38b2f6a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE3qx/rJh59vdc2+v9Q9YqPqOI5G8FAmBx9HAACgkQQ9YqPqOI\n5G8PLRAAn2W0Smo1EeaSR+pRXTKZrK7ofFSQp9VYT6kujqSW7q043a8RhuqkPKOq\nL+mvndhEsM2OiByNd6Cwd7IP0u+zD6a84K/Ga66LzUBYtLGKbmcAzQTiNibILp0D\njPyv0rduvrmvV3kZdaUAmy/1F5mYlw97cePapc01TRptx6ymWWZ1L92uoG261mO+\nq4FzG/ldKbQE+Nth6SSBz7eHeOFbxoDN6Q+UaNmctKkaS0dv/SK5+P/TCy+5VWSA\nWm6BF+SeR8jPdnvBpQKzf0gIjbjGHDEtoSynCJ0zyyYZ5ruQueFKbG2yfUXqx0zJ\nVbpxvIjMdQMn5x9daNQmwjbb/diztBE17wiKizjTJYlSffCUMAEnjEuOx7GmrDDo\nukLzb2kveVSFYK8xRuRqRr8M0GcFfUnD914HmnlL7q43JxEIhtpEST+OJO/QcN/r\n7NwOQD/gs0PyCmHyPNz95G1FPspa02FGJ7K+IZ0HIDregH+d45A6QidUP/inTaGW\nxe0fvMx9ZwnbQgsj8bNdwdatlzCGCyt+I4hLNfyM2RGCkuWtqQSfhBX9UkCH1fe9\neOEIsYzCfKMv7U2JT4d14Qyjph2o7SQHL7y3U2mTHV3rUVXIvDQhRV1dFLw/H4ws\nft5ZaCT4EXGH+f/GhsvsGAH9b1Zn8RlPzStsy2xWuBv5E3nfVNc=\n=nCH/\n-----END PGP SIGNATURE-----", "payload": "tree dacd684c99431f4c1fd03961a4ffdb98c5df0a62\nparent 8f4417faf24e18359a344945ff1072b54f354f77\nauthor daxpedda <daxpedda@gmail.com> 1618080880 +0200\ncommitter daxpedda <daxpedda@gmail.com> 1618080880 +0200\n\nFix false-positive `debug_assert`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/271c163ba319ce8518913057cef32978f38b2f6a", "html_url": "https://github.com/rust-lang/rust/commit/271c163ba319ce8518913057cef32978f38b2f6a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/271c163ba319ce8518913057cef32978f38b2f6a/comments", "author": {"login": "daxpedda", "id": 1645124, "node_id": "MDQ6VXNlcjE2NDUxMjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1645124?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daxpedda", "html_url": "https://github.com/daxpedda", "followers_url": "https://api.github.com/users/daxpedda/followers", "following_url": "https://api.github.com/users/daxpedda/following{/other_user}", "gists_url": "https://api.github.com/users/daxpedda/gists{/gist_id}", "starred_url": "https://api.github.com/users/daxpedda/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daxpedda/subscriptions", "organizations_url": "https://api.github.com/users/daxpedda/orgs", "repos_url": "https://api.github.com/users/daxpedda/repos", "events_url": "https://api.github.com/users/daxpedda/events{/privacy}", "received_events_url": "https://api.github.com/users/daxpedda/received_events", "type": "User", "site_admin": false}, "committer": {"login": "daxpedda", "id": 1645124, "node_id": "MDQ6VXNlcjE2NDUxMjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1645124?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daxpedda", "html_url": "https://github.com/daxpedda", "followers_url": "https://api.github.com/users/daxpedda/followers", "following_url": "https://api.github.com/users/daxpedda/following{/other_user}", "gists_url": "https://api.github.com/users/daxpedda/gists{/gist_id}", "starred_url": "https://api.github.com/users/daxpedda/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daxpedda/subscriptions", "organizations_url": "https://api.github.com/users/daxpedda/orgs", "repos_url": "https://api.github.com/users/daxpedda/repos", "events_url": "https://api.github.com/users/daxpedda/events{/privacy}", "received_events_url": "https://api.github.com/users/daxpedda/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8f4417faf24e18359a344945ff1072b54f354f77", "url": "https://api.github.com/repos/rust-lang/rust/commits/8f4417faf24e18359a344945ff1072b54f354f77", "html_url": "https://github.com/rust-lang/rust/commit/8f4417faf24e18359a344945ff1072b54f354f77"}], "stats": {"total": 5, "additions": 3, "deletions": 2}, "files": [{"sha": "cef74d87e7c016a8348dc5081fd6fddde0d01521", "filename": "clippy_lints/src/panic_in_result_fn.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/271c163ba319ce8518913057cef32978f38b2f6a/clippy_lints%2Fsrc%2Fpanic_in_result_fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/271c163ba319ce8518913057cef32978f38b2f6a/clippy_lints%2Fsrc%2Fpanic_in_result_fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fpanic_in_result_fn.rs?ref=271c163ba319ce8518913057cef32978f38b2f6a", "patch": "@@ -1,6 +1,6 @@\n use clippy_utils::diagnostics::span_lint_and_then;\n use clippy_utils::ty::is_type_diagnostic_item;\n-use clippy_utils::{find_macro_calls, return_ty};\n+use clippy_utils::{find_macro_calls, is_expn_of, return_ty};\n use rustc_hir as hir;\n use rustc_hir::intravisit::FnKind;\n use rustc_lint::{LateContext, LateLintPass};\n@@ -52,7 +52,7 @@ impl<'tcx> LateLintPass<'tcx> for PanicInResultFn {\n }\n \n fn lint_impl_body<'tcx>(cx: &LateContext<'tcx>, impl_span: Span, body: &'tcx hir::Body<'tcx>) {\n-    let panics = find_macro_calls(\n+    let mut panics = find_macro_calls(\n         &[\n             \"unimplemented\",\n             \"unreachable\",\n@@ -64,6 +64,7 @@ fn lint_impl_body<'tcx>(cx: &LateContext<'tcx>, impl_span: Span, body: &'tcx hir\n         ],\n         body,\n     );\n+    panics.retain(|span| is_expn_of(*span, \"debug_assert\").is_none());\n     if !panics.is_empty() {\n         span_lint_and_then(\n             cx,"}]}