{"sha": "65e1e6bb942701a061f6772507141ea9f8e920e2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY1ZTFlNmJiOTQyNzAxYTA2MWY2NzcyNTA3MTQxZWE5ZjhlOTIwZTI=", "commit": {"author": {"name": "Keegan McAllister", "email": "kmcallister@mozilla.com", "date": "2015-02-20T20:12:25Z"}, "committer": {"name": "Keegan McAllister", "email": "kmcallister@mozilla.com", "date": "2015-02-25T00:28:54Z"}, "message": "Add a section on recursive macros", "tree": {"sha": "fe11d360a14916372f49721f78a58e20f85707fe", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fe11d360a14916372f49721f78a58e20f85707fe"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/65e1e6bb942701a061f6772507141ea9f8e920e2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/65e1e6bb942701a061f6772507141ea9f8e920e2", "html_url": "https://github.com/rust-lang/rust/commit/65e1e6bb942701a061f6772507141ea9f8e920e2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/65e1e6bb942701a061f6772507141ea9f8e920e2/comments", "author": {"login": "kmcallister", "id": 444997, "node_id": "MDQ6VXNlcjQ0NDk5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/444997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kmcallister", "html_url": "https://github.com/kmcallister", "followers_url": "https://api.github.com/users/kmcallister/followers", "following_url": "https://api.github.com/users/kmcallister/following{/other_user}", "gists_url": "https://api.github.com/users/kmcallister/gists{/gist_id}", "starred_url": "https://api.github.com/users/kmcallister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kmcallister/subscriptions", "organizations_url": "https://api.github.com/users/kmcallister/orgs", "repos_url": "https://api.github.com/users/kmcallister/repos", "events_url": "https://api.github.com/users/kmcallister/events{/privacy}", "received_events_url": "https://api.github.com/users/kmcallister/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kmcallister", "id": 444997, "node_id": "MDQ6VXNlcjQ0NDk5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/444997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kmcallister", "html_url": "https://github.com/kmcallister", "followers_url": "https://api.github.com/users/kmcallister/followers", "following_url": "https://api.github.com/users/kmcallister/following{/other_user}", "gists_url": "https://api.github.com/users/kmcallister/gists{/gist_id}", "starred_url": "https://api.github.com/users/kmcallister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kmcallister/subscriptions", "organizations_url": "https://api.github.com/users/kmcallister/orgs", "repos_url": "https://api.github.com/users/kmcallister/repos", "events_url": "https://api.github.com/users/kmcallister/events{/privacy}", "received_events_url": "https://api.github.com/users/kmcallister/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0bd15657d93c932611f3aee351b6521cdfa77731", "url": "https://api.github.com/repos/rust-lang/rust/commits/0bd15657d93c932611f3aee351b6521cdfa77731", "html_url": "https://github.com/rust-lang/rust/commit/0bd15657d93c932611f3aee351b6521cdfa77731"}], "stats": {"total": 39, "additions": 39, "deletions": 0}, "files": [{"sha": "d0fa735b1dfbd528bedf1cd2a07390583847e0ac", "filename": "src/doc/trpl/macros.md", "status": "modified", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/65e1e6bb942701a061f6772507141ea9f8e920e2/src%2Fdoc%2Ftrpl%2Fmacros.md", "raw_url": "https://github.com/rust-lang/rust/raw/65e1e6bb942701a061f6772507141ea9f8e920e2/src%2Fdoc%2Ftrpl%2Fmacros.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Ftrpl%2Fmacros.md?ref=65e1e6bb942701a061f6772507141ea9f8e920e2", "patch": "@@ -357,6 +357,45 @@ fn main() {\n \n [items]: ../reference.html#items\n \n+# Recursive macros\n+\n+A macro's expansion can include more macro invocations, including invocations\n+of the very same macro being expanded.  These recursive macros are useful for\n+processing tree-structured input, as illustrated by this (simplistic) HTML\n+shorthand:\n+\n+```rust\n+# #![allow(unused_must_use)]\n+macro_rules! write_html {\n+    ($w:expr, ) => (());\n+\n+    ($w:expr, $e:tt) => (write!($w, \"{}\", $e));\n+\n+    ($w:expr, $tag:ident [ $($inner:tt)* ] $($rest:tt)*) => {{\n+        write!($w, \"<{}>\", stringify!($tag));\n+        write_html!($w, $($inner)*);\n+        write!($w, \"</{}>\", stringify!($tag));\n+        write_html!($w, $($rest)*);\n+    }};\n+}\n+\n+fn main() {\n+#   // FIXME(#21826)\n+    use std::fmt::Write;\n+    let mut out = String::new();\n+\n+    write_html!(&mut out,\n+        html[\n+            head[title[\"Macros guide\"]]\n+            body[h1[\"Macros are the best!\"]]\n+        ]);\n+\n+    assert_eq!(out,\n+        \"<html><head><title>Macros guide</title></head>\\\n+         <body><h1>Macros are the best!</h1></body></html>\");\n+}\n+```\n+\n # Further reading\n \n The [advanced macros chapter][] goes into more detail about macro syntax. It"}]}