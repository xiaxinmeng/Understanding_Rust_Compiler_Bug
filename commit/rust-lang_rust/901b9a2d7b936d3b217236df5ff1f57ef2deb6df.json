{"sha": "901b9a2d7b936d3b217236df5ff1f57ef2deb6df", "node_id": "MDY6Q29tbWl0NzI0NzEyOjkwMWI5YTJkN2I5MzZkM2IyMTcyMzZkZjVmZjFmNTdlZjJkZWI2ZGY=", "commit": {"author": {"name": "Yuki Okushi", "email": "huyuumi.dev@gmail.com", "date": "2021-01-08T02:11:41Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-01-08T02:11:41Z"}, "message": "Rollup merge of #80372 - jyn514:fix-panics, r=Manishearth\n\nDon't panic when an external crate can't be resolved\n\nThis isn't actually a bug, it can occur when rustdoc tries to resolve a\ncrate that isn't used in the main code.\n\nFixes #72381.\n\nr? `@kinnison` if you have time, otherwise `@Manishearth`", "tree": {"sha": "b0a71d749eefd1f881a2321be97b23a0d5cdf624", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b0a71d749eefd1f881a2321be97b23a0d5cdf624"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/901b9a2d7b936d3b217236df5ff1f57ef2deb6df", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJf979dCRBK7hj4Ov3rIwAAdHIIAJcWo/XtiyvqAvDfRb7jPPdo\nS91gwc320Hr7pzl+7AWsTdqPFfD1OGE9SfOT0T2OhyThYCQXEqVj4t4Lax3S5O/c\nuzA0U28M+SK3QQi3EObhXqbs9cyl4eaye+L1z+74Cj4T8F4pZ2zZRoeBQ+DMPp9p\n9Mq5iyAnAibb6ukZBPKtgTWBjaDVF+lPQsOipVS+3cEIa1i+yOu4Ajdc070k37xW\nVhTk+Pe/Kx6+VYgheG4UyztpGnVl48W7n+ZDMARKKm41966nNyLQEnxx5NZqrQ7Z\nj+R7gqWBAP2j7rz3ujNtBB5DBtAebmIG9tfpQIshkjA5kYfafEc4eGtlCyW5bR0=\n=GYeV\n-----END PGP SIGNATURE-----\n", "payload": "tree b0a71d749eefd1f881a2321be97b23a0d5cdf624\nparent 0afd72e313ed6837f3a150619475a0a480b91802\nparent 7edd1810b41e239ea59b22a73a87f8c377d2293f\nauthor Yuki Okushi <huyuumi.dev@gmail.com> 1610071901 +0900\ncommitter GitHub <noreply@github.com> 1610071901 +0900\n\nRollup merge of #80372 - jyn514:fix-panics, r=Manishearth\n\nDon't panic when an external crate can't be resolved\n\nThis isn't actually a bug, it can occur when rustdoc tries to resolve a\ncrate that isn't used in the main code.\n\nFixes #72381.\n\nr? `@kinnison` if you have time, otherwise `@Manishearth`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/901b9a2d7b936d3b217236df5ff1f57ef2deb6df", "html_url": "https://github.com/rust-lang/rust/commit/901b9a2d7b936d3b217236df5ff1f57ef2deb6df", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/901b9a2d7b936d3b217236df5ff1f57ef2deb6df/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0afd72e313ed6837f3a150619475a0a480b91802", "url": "https://api.github.com/repos/rust-lang/rust/commits/0afd72e313ed6837f3a150619475a0a480b91802", "html_url": "https://github.com/rust-lang/rust/commit/0afd72e313ed6837f3a150619475a0a480b91802"}, {"sha": "7edd1810b41e239ea59b22a73a87f8c377d2293f", "url": "https://api.github.com/repos/rust-lang/rust/commits/7edd1810b41e239ea59b22a73a87f8c377d2293f", "html_url": "https://github.com/rust-lang/rust/commit/7edd1810b41e239ea59b22a73a87f8c377d2293f"}], "stats": {"total": 29, "additions": 24, "deletions": 5}, "files": [{"sha": "4db5a0bccc85df563e5cec87d087cff50153116f", "filename": "src/librustdoc/core.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/901b9a2d7b936d3b217236df5ff1f57ef2deb6df/src%2Flibrustdoc%2Fcore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/901b9a2d7b936d3b217236df5ff1f57ef2deb6df/src%2Flibrustdoc%2Fcore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fcore.rs?ref=901b9a2d7b936d3b217236df5ff1f57ef2deb6df", "patch": "@@ -434,16 +434,15 @@ crate fn create_resolver<'a>(\n         sess.time(\"load_extern_crates\", || {\n             for extern_name in &extern_names {\n                 debug!(\"loading extern crate {}\", extern_name);\n-                resolver\n+                if let Err(()) = resolver\n                     .resolve_str_path_error(\n                         DUMMY_SP,\n                         extern_name,\n                         TypeNS,\n                         LocalDefId { local_def_index: CRATE_DEF_INDEX }.to_def_id(),\n-                    )\n-                    .unwrap_or_else(|()| {\n-                        panic!(\"Unable to resolve external crate {}\", extern_name)\n-                    });\n+                  ) {\n+                    warn!(\"unable to resolve external crate {} (do you have an unused `--extern` crate?)\", extern_name)\n+                  }\n             }\n         });\n     });"}, {"sha": "186503cf69d3f6f4fcaba76f759d24af7b8a1060", "filename": "src/test/rustdoc-ui/intra-doc/unused-extern-crate.rs", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/901b9a2d7b936d3b217236df5ff1f57ef2deb6df/src%2Ftest%2Frustdoc-ui%2Fintra-doc%2Funused-extern-crate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/901b9a2d7b936d3b217236df5ff1f57ef2deb6df/src%2Ftest%2Frustdoc-ui%2Fintra-doc%2Funused-extern-crate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fintra-doc%2Funused-extern-crate.rs?ref=901b9a2d7b936d3b217236df5ff1f57ef2deb6df", "patch": "@@ -0,0 +1,5 @@\n+// compile-flags: --extern zip=whatever.rlib\n+#![deny(broken_intra_doc_links)]\n+/// See [zip] crate.\n+//~^ ERROR unresolved\n+pub struct ArrayZip;"}, {"sha": "b3b57fd1318383a4e4fac79ccea3218689006659", "filename": "src/test/rustdoc-ui/intra-doc/unused-extern-crate.stderr", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/901b9a2d7b936d3b217236df5ff1f57ef2deb6df/src%2Ftest%2Frustdoc-ui%2Fintra-doc%2Funused-extern-crate.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/901b9a2d7b936d3b217236df5ff1f57ef2deb6df/src%2Ftest%2Frustdoc-ui%2Fintra-doc%2Funused-extern-crate.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fintra-doc%2Funused-extern-crate.stderr?ref=901b9a2d7b936d3b217236df5ff1f57ef2deb6df", "patch": "@@ -0,0 +1,15 @@\n+error: unresolved link to `zip`\n+  --> $DIR/unused-extern-crate.rs:3:10\n+   |\n+LL | /// See [zip] crate.\n+   |          ^^^ no item named `zip` in scope\n+   |\n+note: the lint level is defined here\n+  --> $DIR/unused-extern-crate.rs:2:9\n+   |\n+LL | #![deny(broken_intra_doc_links)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^\n+   = help: to escape `[` and `]` characters, add '\\' before them like `\\[` or `\\]`\n+\n+error: aborting due to previous error\n+"}]}