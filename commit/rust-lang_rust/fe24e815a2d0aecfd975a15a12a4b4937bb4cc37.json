{"sha": "fe24e815a2d0aecfd975a15a12a4b4937bb4cc37", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZlMjRlODE1YTJkMGFlY2ZkOTc1YTE1YTEyYTRiNDkzN2JiNGNjMzc=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2017-09-26T22:43:37Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2017-10-07T15:23:06Z"}, "message": "Fix invalid rustdoc rendering for FnTy args", "tree": {"sha": "b14e534477fb66a951439ad35c434aa11025fc3f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b14e534477fb66a951439ad35c434aa11025fc3f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37", "html_url": "https://github.com/rust-lang/rust/commit/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3493c62ff2628ef81f6f3a968c951252e9b57824", "url": "https://api.github.com/repos/rust-lang/rust/commits/3493c62ff2628ef81f6f3a968c951252e9b57824", "html_url": "https://github.com/rust-lang/rust/commit/3493c62ff2628ef81f6f3a968c951252e9b57824"}], "stats": {"total": 42, "additions": 27, "deletions": 15}, "files": [{"sha": "1755b3bca0572198806b82422b46a0a73fdf508b", "filename": "src/librustc/hir/intravisit.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37/src%2Flibrustc%2Fhir%2Fintravisit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37/src%2Flibrustc%2Fhir%2Fintravisit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Fintravisit.rs?ref=fe24e815a2d0aecfd975a15a12a4b4937bb4cc37", "patch": "@@ -574,7 +574,7 @@ pub fn walk_ty<'v, V: Visitor<'v>>(visitor: &mut V, typ: &'v Ty) {\n         TyTup(ref tuple_element_types) => {\n             walk_list!(visitor, visit_ty, tuple_element_types);\n         }\n-        TyBareFn(ref function_declaration, _) => {\n+        TyBareFn(ref function_declaration) => {\n             visitor.visit_fn_decl(&function_declaration.decl);\n             walk_list!(visitor, visit_lifetime_def, &function_declaration.lifetimes);\n         }"}, {"sha": "64a2ba1fa6f246fc951fb429b4d8188c8834d777", "filename": "src/librustc/hir/lowering.rs", "status": "modified", "additions": 2, "deletions": 9, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37/src%2Flibrustc%2Fhir%2Flowering.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37/src%2Flibrustc%2Fhir%2Flowering.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Flowering.rs?ref=fe24e815a2d0aecfd975a15a12a4b4937bb4cc37", "patch": "@@ -673,15 +673,8 @@ impl<'a> LoweringContext<'a> {\n                     unsafety: self.lower_unsafety(f.unsafety),\n                     abi: f.abi,\n                     decl: self.lower_fn_decl(&f.decl),\n-                },\n-                decl.inputs.iter().map(|arg| {\n-                    match arg.pat.node {\n-                        PatKind::Ident(_, ident, None) => {\n-                            respan(ident.span, ident.node.name)\n-                        }\n-                        _ => respan(arg.pat.span, keywords::Invalid.name()),\n-                    }\n-                }).collect()))\n+                    arg_names: self.lower_fn_args_to_names(&f.decl),\n+                }))\n             }\n             TyKind::Never => hir::TyNever,\n             TyKind::Tup(ref tys) => {"}, {"sha": "5ad0ff04c1b9ce030a8bbdf18a17a02ba9a18f6e", "filename": "src/librustc/hir/mod.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37/src%2Flibrustc%2Fhir%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37/src%2Flibrustc%2Fhir%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Fmod.rs?ref=fe24e815a2d0aecfd975a15a12a4b4937bb4cc37", "patch": "@@ -1418,6 +1418,7 @@ pub struct BareFnTy {\n     pub abi: Abi,\n     pub lifetimes: HirVec<LifetimeDef>,\n     pub decl: P<FnDecl>,\n+    pub arg_names: HirVec<Spanned<Name>>,\n }\n \n #[derive(Clone, PartialEq, Eq, RustcEncodable, RustcDecodable, Hash, Debug)]"}, {"sha": "7287e599b290de4065492af7169a6cf6a363ec49", "filename": "src/librustc/hir/print.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37/src%2Flibrustc%2Fhir%2Fprint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37/src%2Flibrustc%2Fhir%2Fprint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Fprint.rs?ref=fe24e815a2d0aecfd975a15a12a4b4937bb4cc37", "patch": "@@ -399,7 +399,8 @@ impl<'a> State<'a> {\n                     },\n                     span: syntax_pos::DUMMY_SP,\n                 };\n-                self.print_ty_fn(f.abi, f.unsafety, &f.decl, None, &generics)?;\n+                self.print_ty_fn(f.abi, f.unsafety, &f.decl, None, &generics,\n+                                 &f.arg_names[..])?;\n             }\n             hir::TyPath(ref qpath) => {\n                 self.print_qpath(qpath, false)?\n@@ -2140,7 +2141,8 @@ impl<'a> State<'a> {\n                        unsafety: hir::Unsafety,\n                        decl: &hir::FnDecl,\n                        name: Option<ast::Name>,\n-                       generics: &hir::Generics)\n+                       generics: &hir::Generics,\n+                       arg_names: &[Spanned<ast::Name>])\n                        -> io::Result<()> {\n         self.ibox(indent_unit)?;\n         if !generics.lifetimes.is_empty() || !generics.ty_params.is_empty() {\n@@ -2163,7 +2165,7 @@ impl<'a> State<'a> {\n                       name,\n                       &generics,\n                       &hir::Inherited,\n-                      &[],\n+                      arg_names,\n                       None)?;\n         self.end()\n     }"}, {"sha": "c0fae8bf8bd20e82f0855d7b05597f5c629b8696", "filename": "src/librustc/ich/impls_hir.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37/src%2Flibrustc%2Fich%2Fimpls_hir.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37/src%2Flibrustc%2Fich%2Fimpls_hir.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fich%2Fimpls_hir.rs?ref=fe24e815a2d0aecfd975a15a12a4b4937bb4cc37", "patch": "@@ -274,7 +274,8 @@ impl_stable_hash_for!(struct hir::BareFnTy {\n     unsafety,\n     abi,\n     lifetimes,\n-    decl\n+    decl,\n+    arg_names\n });\n \n impl_stable_hash_for!(enum hir::Ty_ {"}, {"sha": "424f48a17e940d1a3284a0d6addd0078d9805a86", "filename": "src/librustdoc/clean/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37/src%2Flibrustdoc%2Fclean%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37/src%2Flibrustdoc%2Fclean%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Fmod.rs?ref=fe24e815a2d0aecfd975a15a12a4b4937bb4cc37", "patch": "@@ -2491,7 +2491,7 @@ impl Clean<BareFunctionDecl> for hir::BareFnTy {\n                 type_params: Vec::new(),\n                 where_predicates: Vec::new()\n             },\n-            decl: (&*self.decl, &[][..]).clean(cx),\n+            decl: (&*self.decl, &self.arg_names[..]).clean(cx),\n             abi: self.abi,\n         }\n     }"}, {"sha": "af87f1b4669743f07e85c5decfa12d4b26be0743", "filename": "src/test/rustdoc/fn-pointer-arg-name.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37/src%2Ftest%2Frustdoc%2Ffn-pointer-arg-name.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fe24e815a2d0aecfd975a15a12a4b4937bb4cc37/src%2Ftest%2Frustdoc%2Ffn-pointer-arg-name.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Ffn-pointer-arg-name.rs?ref=fe24e815a2d0aecfd975a15a12a4b4937bb4cc37", "patch": "@@ -0,0 +1,15 @@\n+// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+#![crate_name = \"foo\"]\n+\n+// @has foo/fn.f.html\n+// @has - '//*[@class=\"rust fn\"]' 'pub fn f(callback: fn(len: usize, foo: u32))'\n+pub fn f(callback: fn(len: usize, foo: u32)) {}"}]}