{"sha": "9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "node_id": "MDY6Q29tbWl0NzI0NzEyOjlmM2RmZDI5YTIxZjFiZGMyNjcyMDcwM2Y3OWQzZmFiZGM3NDcxZGU=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2020-02-21T22:00:27Z"}, "committer": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2020-02-21T23:19:27Z"}, "message": "parse: allow `type Foo: Ord` syntactically.", "tree": {"sha": "00f814b6740249b0ba64c06fcf180363e196538d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/00f814b6740249b0ba64c06fcf180363e196538d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "html_url": "https://github.com/rust-lang/rust/commit/9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "14442e0ebbbd040f608316aee2f10c937ae5ac4f", "url": "https://api.github.com/repos/rust-lang/rust/commits/14442e0ebbbd040f608316aee2f10c937ae5ac4f", "html_url": "https://github.com/rust-lang/rust/commit/14442e0ebbbd040f608316aee2f10c937ae5ac4f"}], "stats": {"total": 221, "additions": 160, "deletions": 61}, "files": [{"sha": "1a19fab0265e677f7f6e15722294981f209f0728", "filename": "src/librustc_ast_lowering/item.rs", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_ast_lowering%2Fitem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_ast_lowering%2Fitem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_ast_lowering%2Fitem.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -297,28 +297,28 @@ impl<'hir> LoweringContext<'_, 'hir> {\n             ItemKind::Mod(ref m) => hir::ItemKind::Mod(self.lower_mod(m)),\n             ItemKind::ForeignMod(ref nm) => hir::ItemKind::ForeignMod(self.lower_foreign_mod(nm)),\n             ItemKind::GlobalAsm(ref ga) => hir::ItemKind::GlobalAsm(self.lower_global_asm(ga)),\n-            ItemKind::TyAlias(ref ty, ref generics) => match ty.kind.opaque_top_hack() {\n+            ItemKind::TyAlias(ref generics, _, Some(ref ty)) => match ty.kind.opaque_top_hack() {\n                 None => {\n                     let ty = self.lower_ty(ty, ImplTraitContext::disallowed());\n                     let generics = self.lower_generics(generics, ImplTraitContext::disallowed());\n                     hir::ItemKind::TyAlias(ty, generics)\n                 }\n                 Some(bounds) => {\n+                    let ctx = || ImplTraitContext::OpaqueTy(None, hir::OpaqueTyOrigin::Misc);\n                     let ty = hir::OpaqueTy {\n-                        generics: self.lower_generics(\n-                            generics,\n-                            ImplTraitContext::OpaqueTy(None, hir::OpaqueTyOrigin::Misc),\n-                        ),\n-                        bounds: self.lower_param_bounds(\n-                            bounds,\n-                            ImplTraitContext::OpaqueTy(None, hir::OpaqueTyOrigin::Misc),\n-                        ),\n+                        generics: self.lower_generics(generics, ctx()),\n+                        bounds: self.lower_param_bounds(bounds, ctx()),\n                         impl_trait_fn: None,\n                         origin: hir::OpaqueTyOrigin::TypeAlias,\n                     };\n                     hir::ItemKind::OpaqueTy(ty)\n                 }\n             },\n+            ItemKind::TyAlias(ref generics, _, None) => {\n+                let ty = self.arena.alloc(self.ty(span, hir::TyKind::Err));\n+                let generics = self.lower_generics(generics, ImplTraitContext::disallowed());\n+                hir::ItemKind::TyAlias(ty, generics)\n+            }\n             ItemKind::Enum(ref enum_definition, ref generics) => hir::ItemKind::Enum(\n                 hir::EnumDef {\n                     variants: self.arena.alloc_from_iter("}, {"sha": "9bb46009fe64b25ed4b64a38ad3545b9a1f12c01", "filename": "src/librustc_ast_lowering/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_ast_lowering%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_ast_lowering%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_ast_lowering%2Flib.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -462,7 +462,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                     ItemKind::Struct(_, ref generics)\n                     | ItemKind::Union(_, ref generics)\n                     | ItemKind::Enum(_, ref generics)\n-                    | ItemKind::TyAlias(_, ref generics)\n+                    | ItemKind::TyAlias(ref generics, ..)\n                     | ItemKind::Trait(_, _, ref generics, ..) => {\n                         let def_id = self.lctx.resolver.definitions().local_def_id(item.id);\n                         let count = generics"}, {"sha": "a9844a7059e552f1fa9c2d7f629013cfc744d85f", "filename": "src/librustc_ast_passes/ast_validation.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_ast_passes%2Fast_validation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_ast_passes%2Fast_validation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_ast_passes%2Fast_validation.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -969,6 +969,13 @@ impl<'a> Visitor<'a> for AstValidator<'a> {\n                 let msg = \"free static item without body\";\n                 self.error_item_without_body(item.span, \"static\", msg, \" = <expr>;\");\n             }\n+            ItemKind::TyAlias(_, ref bounds, ref body) => {\n+                if body.is_none() {\n+                    let msg = \"free type alias without body\";\n+                    self.error_item_without_body(item.span, \"type\", msg, \" = <type>;\");\n+                }\n+                self.check_type_no_bounds(bounds, \"this context\");\n+            }\n             _ => {}\n         }\n "}, {"sha": "5bddae0d49e7d83840e581059dbc37c638814f09", "filename": "src/librustc_ast_passes/feature_gate.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_ast_passes%2Ffeature_gate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_ast_passes%2Ffeature_gate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_ast_passes%2Ffeature_gate.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -372,7 +372,7 @@ impl<'a> Visitor<'a> for PostExpansionVisitor<'a> {\n                 gate_feature_post!(&self, decl_macro, i.span, msg);\n             }\n \n-            ast::ItemKind::TyAlias(ref ty, ..) => self.check_impl_trait(&ty),\n+            ast::ItemKind::TyAlias(_, _, Some(ref ty)) => self.check_impl_trait(&ty),\n \n             _ => {}\n         }"}, {"sha": "9b7bb57494685f03ec3c5ad5db0868bab2da447f", "filename": "src/librustc_ast_pretty/pprust.rs", "status": "modified", "additions": 4, "deletions": 12, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_ast_pretty%2Fpprust.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_ast_pretty%2Fpprust.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_ast_pretty%2Fpprust.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -1185,18 +1185,10 @@ impl<'a> State<'a> {\n                 self.s.word(ga.asm.to_string());\n                 self.end();\n             }\n-            ast::ItemKind::TyAlias(ref ty, ref generics) => {\n-                self.head(visibility_qualified(&item.vis, \"type\"));\n-                self.print_ident(item.ident);\n-                self.print_generic_params(&generics.params);\n-                self.end(); // end the inner ibox\n-\n-                self.print_where_clause(&generics.where_clause);\n-                self.s.space();\n-                self.word_space(\"=\");\n-                self.print_type(ty);\n-                self.s.word(\";\");\n-                self.end(); // end the outer ibox\n+            ast::ItemKind::TyAlias(ref generics, ref bounds, ref ty) => {\n+                let def = ast::Defaultness::Final;\n+                let ty = ty.as_deref();\n+                self.print_associated_type(item.ident, generics, bounds, ty, &item.vis, def);\n             }\n             ast::ItemKind::Enum(ref enum_definition, ref params) => {\n                 self.print_enum_def(enum_definition, params, item.ident, item.span, &item.vis);"}, {"sha": "328cf11c53247fc47669ed45b3d3e6516f1eee34", "filename": "src/librustc_parse/parser/item.rs", "status": "modified", "additions": 12, "deletions": 20, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_parse%2Fparser%2Fitem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_parse%2Fparser%2Fitem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_parse%2Fparser%2Fitem.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -156,8 +156,7 @@ impl<'a> Parser<'a> {\n             self.parse_item_mod(attrs)?\n         } else if self.eat_keyword(kw::Type) {\n             // TYPE ITEM\n-            let (ident, ty, generics) = self.parse_type_alias()?;\n-            (ident, ItemKind::TyAlias(ty, generics))\n+            self.parse_type_alias()?\n         } else if self.eat_keyword(kw::Enum) {\n             // ENUM ITEM\n             self.parse_item_enum()?\n@@ -676,7 +675,10 @@ impl<'a> Parser<'a> {\n         vis: &Visibility,\n     ) -> PResult<'a, (Ident, AssocItemKind)> {\n         if self.eat_keyword(kw::Type) {\n-            self.parse_assoc_ty()\n+            match self.parse_type_alias()? {\n+                (ident, ItemKind::TyAlias(a, b, c)) => Ok((ident, AssocItemKind::TyAlias(a, b, c))),\n+                _ => unreachable!(),\n+            }\n         } else if self.check_fn_front_matter() {\n             let (ident, sig, generics, body) = self.parse_fn(at_end, attrs, req_name)?;\n             Ok((ident, AssocItemKind::Fn(sig, generics, body)))\n@@ -700,10 +702,12 @@ impl<'a> Parser<'a> {\n         }\n     }\n \n-    /// Parses the following grammar:\n-    ///\n-    ///     AssocTy = Ident [\"<\"...\">\"] [\":\" [GenericBounds]] [\"where\" ...] [\"=\" Ty]\n-    fn parse_assoc_ty(&mut self) -> PResult<'a, (Ident, AssocItemKind)> {\n+    /// Parses a `type` alias with the following grammar:\n+    /// ```\n+    /// TypeAlias = \"type\" Ident Generics {\":\" GenericBounds}? {\"=\" Ty}? \";\" ;\n+    /// ```\n+    /// The `\"type\"` has already been eaten.\n+    fn parse_type_alias(&mut self) -> PResult<'a, (Ident, ItemKind)> {\n         let ident = self.parse_ident()?;\n         let mut generics = self.parse_generics()?;\n \n@@ -715,7 +719,7 @@ impl<'a> Parser<'a> {\n         let default = if self.eat(&token::Eq) { Some(self.parse_ty()?) } else { None };\n         self.expect_semi()?;\n \n-        Ok((ident, AssocItemKind::TyAlias(generics, bounds, default)))\n+        Ok((ident, ItemKind::TyAlias(generics, bounds, default)))\n     }\n \n     /// Parses a `UseTree`.\n@@ -989,18 +993,6 @@ impl<'a> Parser<'a> {\n         P(Ty { kind: TyKind::Infer, span: id.span, id: ast::DUMMY_NODE_ID })\n     }\n \n-    /// Parses the grammar:\n-    ///     Ident [\"<\"...\">\"] [\"where\" ...] (\"=\" | \":\") Ty \";\"\n-    fn parse_type_alias(&mut self) -> PResult<'a, (Ident, P<Ty>, Generics)> {\n-        let ident = self.parse_ident()?;\n-        let mut tps = self.parse_generics()?;\n-        tps.where_clause = self.parse_where_clause()?;\n-        self.expect(&token::Eq)?;\n-        let ty = self.parse_ty()?;\n-        self.expect_semi()?;\n-        Ok((ident, ty, tps))\n-    }\n-\n     /// Parses an enum declaration.\n     fn parse_item_enum(&mut self) -> PResult<'a, ItemInfo> {\n         let id = self.parse_ident()?;"}, {"sha": "383bfe18fd00b6f74105697f6111e4ae307bd4bd", "filename": "src/librustc_resolve/build_reduced_graph.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_resolve%2Fbuild_reduced_graph.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_resolve%2Fbuild_reduced_graph.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Fbuild_reduced_graph.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -718,8 +718,8 @@ impl<'a, 'b> BuildReducedGraphVisitor<'a, 'b> {\n             }\n \n             // These items live in the type namespace.\n-            ItemKind::TyAlias(ref ty, _) => {\n-                let def_kind = match ty.kind.opaque_top_hack() {\n+            ItemKind::TyAlias(_, _, ref ty) => {\n+                let def_kind = match ty.as_deref().and_then(|ty| ty.kind.opaque_top_hack()) {\n                     None => DefKind::TyAlias,\n                     Some(_) => DefKind::OpaqueTy,\n                 };"}, {"sha": "74628e6e5a03ee1603993c4305b9ce4dd18d5fbe", "filename": "src/librustc_resolve/late.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_resolve%2Flate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_resolve%2Flate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Flate.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -797,7 +797,7 @@ impl<'a, 'b, 'ast> LateResolutionVisitor<'a, 'b, 'ast> {\n         debug!(\"(resolving item) resolving {} ({:?})\", name, item.kind);\n \n         match item.kind {\n-            ItemKind::TyAlias(_, ref generics) | ItemKind::Fn(_, ref generics, _) => {\n+            ItemKind::TyAlias(ref generics, _, _) | ItemKind::Fn(_, ref generics, _) => {\n                 self.with_generic_param_rib(generics, ItemRibKind(HasGenericParams::Yes), |this| {\n                     visit::walk_item(this, item)\n                 });"}, {"sha": "53dd6d28f891bb6fd9f19079eca9dc4db77c949c", "filename": "src/librustc_save_analysis/dump_visitor.rs", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_save_analysis%2Fdump_visitor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_save_analysis%2Fdump_visitor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_save_analysis%2Fdump_visitor.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -1311,12 +1311,15 @@ impl<'l, 'tcx> Visitor<'l> for DumpVisitor<'l, 'tcx> {\n                 self.process_mod(item);\n                 visit::walk_mod(self, m);\n             }\n-            TyAlias(ref ty, ref ty_params) => {\n+            TyAlias(ref ty_params, _, ref ty) => {\n                 let qualname = format!(\n                     \"::{}\",\n                     self.tcx.def_path_str(self.tcx.hir().local_def_id_from_node_id(item.id))\n                 );\n-                let value = ty_to_string(&ty);\n+                let value = match ty {\n+                    Some(ty) => ty_to_string(&ty),\n+                    None => \"_\".to_string(),\n+                };\n                 if !self.span.filter_generated(item.ident.span) {\n                     let span = self.span_from_span(item.ident.span);\n                     let id = id_from_node_id(item.id, &self.save_ctxt);\n@@ -1341,7 +1344,7 @@ impl<'l, 'tcx> Visitor<'l> for DumpVisitor<'l, 'tcx> {\n                     );\n                 }\n \n-                self.visit_ty(&ty);\n+                walk_list!(self, visit_ty, ty);\n                 self.process_generic_params(ty_params, &qualname, item.id);\n             }\n             Mac(_) => (),"}, {"sha": "2c07ed0571bded679dfe65a0fe4a79ac7aac2946", "filename": "src/librustc_save_analysis/sig.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_save_analysis%2Fsig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibrustc_save_analysis%2Fsig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_save_analysis%2Fsig.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -423,12 +423,15 @@ impl Sig for ast::Item {\n \n                 Ok(Signature { text, defs, refs: vec![] })\n             }\n-            ast::ItemKind::TyAlias(ref ty, ref generics) => {\n+            ast::ItemKind::TyAlias(ref generics, _, ref ty) => {\n                 let text = \"type \".to_owned();\n                 let mut sig = name_and_generics(text, offset, generics, self.id, self.ident, scx)?;\n \n                 sig.text.push_str(\" = \");\n-                let ty = ty.make(offset + sig.text.len(), id, scx)?;\n+                let ty = match ty {\n+                    Some(ty) => ty.make(offset + sig.text.len(), id, scx)?,\n+                    None => Err(\"Ty\")?,\n+                };\n                 sig.text.push_str(&ty.text);\n                 sig.text.push(';');\n "}, {"sha": "849950e939a02c8c94e6ebf9a93acaf2920a83bb", "filename": "src/libsyntax/ast.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibsyntax%2Fast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibsyntax%2Fast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fast.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -2524,7 +2524,7 @@ pub enum ItemKind {\n     /// A type alias (`type`).\n     ///\n     /// E.g., `type Foo = Bar<u8>;`.\n-    TyAlias(P<Ty>, Generics),\n+    TyAlias(Generics, GenericBounds, Option<P<Ty>>),\n     /// An enum definition (`enum`).\n     ///\n     /// E.g., `enum Foo<A, B> { C<A>, D<B> }`.\n@@ -2594,7 +2594,7 @@ impl ItemKind {\n     pub fn generics(&self) -> Option<&Generics> {\n         match self {\n             Self::Fn(_, generics, _)\n-            | Self::TyAlias(_, generics)\n+            | Self::TyAlias(generics, ..)\n             | Self::Enum(_, generics)\n             | Self::Struct(_, generics)\n             | Self::Union(_, generics)"}, {"sha": "02f790dfbb4e97a41f614052bd9ac59e39a3958c", "filename": "src/libsyntax/mut_visit.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibsyntax%2Fmut_visit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibsyntax%2Fmut_visit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fmut_visit.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -902,9 +902,10 @@ pub fn noop_visit_item_kind<T: MutVisitor>(kind: &mut ItemKind, vis: &mut T) {\n         ItemKind::Mod(m) => vis.visit_mod(m),\n         ItemKind::ForeignMod(nm) => vis.visit_foreign_mod(nm),\n         ItemKind::GlobalAsm(_ga) => {}\n-        ItemKind::TyAlias(ty, generics) => {\n-            vis.visit_ty(ty);\n+        ItemKind::TyAlias(generics, bounds, ty) => {\n             vis.visit_generics(generics);\n+            visit_bounds(bounds, vis);\n+            visit_opt(ty, |ty| vis.visit_ty(ty));\n         }\n         ItemKind::Enum(EnumDef { variants }, generics) => {\n             variants.flat_map_in_place(|variant| vis.flat_map_variant(variant));"}, {"sha": "bd35918dba72888345f59f10bd6110e1051b4be3", "filename": "src/libsyntax/visit.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibsyntax%2Fvisit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Flibsyntax%2Fvisit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fvisit.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -312,9 +312,10 @@ pub fn walk_item<'a, V: Visitor<'a>>(visitor: &mut V, item: &'a Item) {\n             walk_list!(visitor, visit_foreign_item, &foreign_module.items);\n         }\n         ItemKind::GlobalAsm(ref ga) => visitor.visit_global_asm(ga),\n-        ItemKind::TyAlias(ref typ, ref generics) => {\n-            visitor.visit_ty(typ);\n-            visitor.visit_generics(generics)\n+        ItemKind::TyAlias(ref generics, ref bounds, ref ty) => {\n+            visitor.visit_generics(generics);\n+            walk_list!(visitor, visit_param_bound, bounds);\n+            walk_list!(visitor, visit_ty, ty);\n         }\n         ItemKind::Enum(ref enum_definition, ref generics) => {\n             visitor.visit_generics(generics);"}, {"sha": "e60cc153e670fbe0103316d217aacc470b2f4937", "filename": "src/test/ui/parser/bounds-lifetime-where.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Ftest%2Fui%2Fparser%2Fbounds-lifetime-where.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Ftest%2Fui%2Fparser%2Fbounds-lifetime-where.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fbounds-lifetime-where.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -5,6 +5,6 @@ type A where 'a:, = u8; // OK\n type A where 'a: 'b + 'c = u8; // OK\n type A where = u8; // OK\n type A where 'a: 'b + = u8; // OK\n-type A where , = u8; //~ ERROR expected one of `=`, lifetime, or type, found `,`\n+type A where , = u8; //~ ERROR expected one of `;`, `=`, lifetime, or type, found `,`\n \n fn main() {}"}, {"sha": "950fa46c66b7e3bd38722b31bfb0771fb57ecb77", "filename": "src/test/ui/parser/bounds-lifetime-where.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Ftest%2Fui%2Fparser%2Fbounds-lifetime-where.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Ftest%2Fui%2Fparser%2Fbounds-lifetime-where.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fbounds-lifetime-where.stderr?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -1,8 +1,8 @@\n-error: expected one of `=`, lifetime, or type, found `,`\n+error: expected one of `;`, `=`, lifetime, or type, found `,`\n   --> $DIR/bounds-lifetime-where.rs:8:14\n    |\n LL | type A where , = u8;\n-   |              ^ expected one of `=`, lifetime, or type\n+   |              ^ expected one of `;`, `=`, lifetime, or type\n \n error: aborting due to previous error\n "}, {"sha": "9db4111fbabd9167f28cdd21544f2a4192b70787", "filename": "src/test/ui/parser/item-free-type-bounds-semantic-fail.rs", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Ftest%2Fui%2Fparser%2Fitem-free-type-bounds-semantic-fail.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Ftest%2Fui%2Fparser%2Fitem-free-type-bounds-semantic-fail.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fitem-free-type-bounds-semantic-fail.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -0,0 +1,20 @@\n+fn main() {}\n+\n+fn semantics() {\n+    type A: Ord;\n+    //~^ ERROR bounds on `type`s in this context have no effect\n+    //~| ERROR free type alias without body\n+    type B: Ord = u8;\n+    //~^ ERROR bounds on `type`s in this context have no effect\n+    type C: Ord where 'static: 'static = u8;\n+    //~^ ERROR bounds on `type`s in this context have no effect\n+    type D<_T>: Ord;\n+    //~^ ERROR bounds on `type`s in this context have no effect\n+    //~| ERROR free type alias without body\n+    type E<_T>: Ord = u8;\n+    //~^ ERROR bounds on `type`s in this context have no effect\n+    //~| ERROR type parameter `_T` is unused\n+    type F<_T>: Ord where 'static: 'static = u8;\n+    //~^ ERROR bounds on `type`s in this context have no effect\n+    //~| ERROR type parameter `_T` is unused\n+}"}, {"sha": "1b086512891f21a9b3b40af542ce1ec0bcb8bc6c", "filename": "src/test/ui/parser/item-free-type-bounds-semantic-fail.stderr", "status": "added", "additions": 67, "deletions": 0, "changes": 67, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Ftest%2Fui%2Fparser%2Fitem-free-type-bounds-semantic-fail.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Ftest%2Fui%2Fparser%2Fitem-free-type-bounds-semantic-fail.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fitem-free-type-bounds-semantic-fail.stderr?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -0,0 +1,67 @@\n+error: free type alias without body\n+  --> $DIR/item-free-type-bounds-semantic-fail.rs:4:5\n+   |\n+LL |     type A: Ord;\n+   |     ^^^^^^^^^^^-\n+   |                |\n+   |                help: provide a definition for the type: `= <type>;`\n+\n+error: bounds on `type`s in this context have no effect\n+  --> $DIR/item-free-type-bounds-semantic-fail.rs:4:13\n+   |\n+LL |     type A: Ord;\n+   |             ^^^\n+\n+error: bounds on `type`s in this context have no effect\n+  --> $DIR/item-free-type-bounds-semantic-fail.rs:7:13\n+   |\n+LL |     type B: Ord = u8;\n+   |             ^^^\n+\n+error: bounds on `type`s in this context have no effect\n+  --> $DIR/item-free-type-bounds-semantic-fail.rs:9:13\n+   |\n+LL |     type C: Ord where 'static: 'static = u8;\n+   |             ^^^\n+\n+error: free type alias without body\n+  --> $DIR/item-free-type-bounds-semantic-fail.rs:11:5\n+   |\n+LL |     type D<_T>: Ord;\n+   |     ^^^^^^^^^^^^^^^-\n+   |                    |\n+   |                    help: provide a definition for the type: `= <type>;`\n+\n+error: bounds on `type`s in this context have no effect\n+  --> $DIR/item-free-type-bounds-semantic-fail.rs:11:17\n+   |\n+LL |     type D<_T>: Ord;\n+   |                 ^^^\n+\n+error: bounds on `type`s in this context have no effect\n+  --> $DIR/item-free-type-bounds-semantic-fail.rs:14:17\n+   |\n+LL |     type E<_T>: Ord = u8;\n+   |                 ^^^\n+\n+error: bounds on `type`s in this context have no effect\n+  --> $DIR/item-free-type-bounds-semantic-fail.rs:17:17\n+   |\n+LL |     type F<_T>: Ord where 'static: 'static = u8;\n+   |                 ^^^\n+\n+error[E0091]: type parameter `_T` is unused\n+  --> $DIR/item-free-type-bounds-semantic-fail.rs:14:12\n+   |\n+LL |     type E<_T>: Ord = u8;\n+   |            ^^ unused type parameter\n+\n+error[E0091]: type parameter `_T` is unused\n+  --> $DIR/item-free-type-bounds-semantic-fail.rs:17:12\n+   |\n+LL |     type F<_T>: Ord where 'static: 'static = u8;\n+   |            ^^ unused type parameter\n+\n+error: aborting due to 10 previous errors\n+\n+For more information about this error, try `rustc --explain E0091`."}, {"sha": "58fc926d08f3e55975be5a4ae66efa60ba04bd79", "filename": "src/test/ui/parser/item-free-type-bounds-syntactic-pass.rs", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Ftest%2Fui%2Fparser%2Fitem-free-type-bounds-syntactic-pass.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f3dfd29a21f1bdc26720703f79d3fabdc7471de/src%2Ftest%2Fui%2Fparser%2Fitem-free-type-bounds-syntactic-pass.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fitem-free-type-bounds-syntactic-pass.rs?ref=9f3dfd29a21f1bdc26720703f79d3fabdc7471de", "patch": "@@ -0,0 +1,13 @@\n+// check-pass\n+\n+fn main() {}\n+\n+#[cfg(FALSE)]\n+fn syntax() {\n+    type A: Ord;\n+    type B: Ord = u8;\n+    type C: Ord where 'static: 'static = u8;\n+    type D<_T>: Ord;\n+    type E<_T>: Ord = u8;\n+    type F<_T>: Ord where 'static: 'static = u8;\n+}"}]}