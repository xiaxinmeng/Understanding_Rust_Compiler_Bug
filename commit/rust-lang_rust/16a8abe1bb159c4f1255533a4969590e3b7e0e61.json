{"sha": "16a8abe1bb159c4f1255533a4969590e3b7e0e61", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE2YThhYmUxYmIxNTljNGYxMjU1NTMzYTQ5Njk1OTBlM2I3ZTBlNjE=", "commit": {"author": {"name": "Andy Russell", "email": "arussell123@gmail.com", "date": "2019-03-20T18:54:43Z"}, "committer": {"name": "Andy Russell", "email": "arussell123@gmail.com", "date": "2019-03-21T15:04:15Z"}, "message": "use suggestions for \"enum instead of variant\" error", "tree": {"sha": "5f8209c3c4769f0ef3113e97afb557737e4545b4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5f8209c3c4769f0ef3113e97afb557737e4545b4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/16a8abe1bb159c4f1255533a4969590e3b7e0e61", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQFKBAABCAA0FiEELriChyEaiMu0yCg7viIhAz7bw3QFAlyTp/4WHGFydXNzZWxs\nMTIzQGdtYWlsLmNvbQAKCRC+IiEDPtvDdPzJCACU5H8mVC+U/otcyS4PRfllB8v7\nK5KF5N5XuWEBbMBSYT84ffte2w0I4+1D23Owdc0NwpD6TJG15bhhNy0LhWmALZUF\nVb+IO5IWX4uOIYxA7dkGh/NENMLTNATwagCgXcQFfjvuvyMRoh05SrfUso94lDBC\nYk/YsaLMMD70SZEUOlnYs5vYVzt/9qu72CGVzycToSTyaCAmzhLXSTOqTm8TQlof\nxgLVom9KwKiX0E2zypH74jmgfnPYz3RzYuG5GRD95DiVbPdJXQmfamYflz4OgN/w\nbXSnzlLPoJsocthZMW5VAng+A7ixVdVMJdWX+8J1kDK+hyUBrzSi/zKpXQI5\n=4Zl9\n-----END PGP SIGNATURE-----", "payload": "tree 5f8209c3c4769f0ef3113e97afb557737e4545b4\nparent 16e7e05e95a6a5a1e0dba54ae722274bd7d725f7\nauthor Andy Russell <arussell123@gmail.com> 1553108083 -0400\ncommitter Andy Russell <arussell123@gmail.com> 1553180655 -0400\n\nuse suggestions for \"enum instead of variant\" error\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/16a8abe1bb159c4f1255533a4969590e3b7e0e61", "html_url": "https://github.com/rust-lang/rust/commit/16a8abe1bb159c4f1255533a4969590e3b7e0e61", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/16a8abe1bb159c4f1255533a4969590e3b7e0e61/comments", "author": {"login": "euclio", "id": 1372438, "node_id": "MDQ6VXNlcjEzNzI0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1372438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/euclio", "html_url": "https://github.com/euclio", "followers_url": "https://api.github.com/users/euclio/followers", "following_url": "https://api.github.com/users/euclio/following{/other_user}", "gists_url": "https://api.github.com/users/euclio/gists{/gist_id}", "starred_url": "https://api.github.com/users/euclio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/euclio/subscriptions", "organizations_url": "https://api.github.com/users/euclio/orgs", "repos_url": "https://api.github.com/users/euclio/repos", "events_url": "https://api.github.com/users/euclio/events{/privacy}", "received_events_url": "https://api.github.com/users/euclio/received_events", "type": "User", "site_admin": false}, "committer": {"login": "euclio", "id": 1372438, "node_id": "MDQ6VXNlcjEzNzI0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1372438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/euclio", "html_url": "https://github.com/euclio", "followers_url": "https://api.github.com/users/euclio/followers", "following_url": "https://api.github.com/users/euclio/following{/other_user}", "gists_url": "https://api.github.com/users/euclio/gists{/gist_id}", "starred_url": "https://api.github.com/users/euclio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/euclio/subscriptions", "organizations_url": "https://api.github.com/users/euclio/orgs", "repos_url": "https://api.github.com/users/euclio/repos", "events_url": "https://api.github.com/users/euclio/events{/privacy}", "received_events_url": "https://api.github.com/users/euclio/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "16e7e05e95a6a5a1e0dba54ae722274bd7d725f7", "url": "https://api.github.com/repos/rust-lang/rust/commits/16e7e05e95a6a5a1e0dba54ae722274bd7d725f7", "html_url": "https://github.com/rust-lang/rust/commit/16e7e05e95a6a5a1e0dba54ae722274bd7d725f7"}], "stats": {"total": 165, "additions": 118, "deletions": 47}, "files": [{"sha": "828ffc6d320e75a4c1488f5fca664bbf67ba2fa8", "filename": "src/librustc_resolve/error_reporting.rs", "status": "modified", "additions": 14, "deletions": 7, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/16a8abe1bb159c4f1255533a4969590e3b7e0e61/src%2Flibrustc_resolve%2Ferror_reporting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16a8abe1bb159c4f1255533a4969590e3b7e0e61/src%2Flibrustc_resolve%2Ferror_reporting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Ferror_reporting.rs?ref=16a8abe1bb159c4f1255533a4969590e3b7e0e61", "patch": "@@ -293,13 +293,20 @@ impl<'a> Resolver<'a> {\n             (Def::Enum(..), PathSource::TupleStruct)\n                 | (Def::Enum(..), PathSource::Expr(..))  => {\n                 if let Some(variants) = self.collect_enum_variants(def) {\n-                    err.note(&format!(\"did you mean to use one \\\n-                                       of the following variants?\\n{}\",\n-                        variants.iter()\n-                            .map(|suggestion| path_names_to_string(suggestion))\n-                            .map(|suggestion| format!(\"- `{}`\", suggestion))\n-                            .collect::<Vec<_>>()\n-                            .join(\"\\n\")));\n+                    if !variants.is_empty() {\n+                        let msg = if variants.len() == 1 {\n+                            \"try using the enum's variant\"\n+                        } else {\n+                            \"try using one of the enum's variants\"\n+                        };\n+\n+                        err.span_suggestions(\n+                            span,\n+                            msg,\n+                            variants.iter().map(path_names_to_string),\n+                            Applicability::MaybeIncorrect,\n+                        );\n+                    }\n                 } else {\n                     err.note(\"did you mean to use one of the enum's variants?\");\n                 }"}, {"sha": "7d3aba364897feeafac5ab8aa9cbe8f2a7b6a90c", "filename": "src/test/ui/did_you_mean/issue-43871-enum-instead-of-variant.rs", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/16a8abe1bb159c4f1255533a4969590e3b7e0e61/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-43871-enum-instead-of-variant.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16a8abe1bb159c4f1255533a4969590e3b7e0e61/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-43871-enum-instead-of-variant.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-43871-enum-instead-of-variant.rs?ref=16a8abe1bb159c4f1255533a4969590e3b7e0e61", "patch": "@@ -1,5 +1,20 @@\n enum Example { Ex(String), NotEx }\n \n+enum Void {}\n+\n+enum ManyVariants {\n+    One,\n+    Two,\n+    Three,\n+    Four,\n+    Five,\n+    Six,\n+    Seven,\n+    Eight,\n+    Nine,\n+    Ten,\n+}\n+\n fn result_test() {\n     let x = Option(1); //~ ERROR expected function, found enum\n \n@@ -12,6 +27,10 @@ fn result_test() {\n     if let Example(_) = y { //~ ERROR expected tuple struct/variant, found enum\n         println!(\"It is OK.\");\n     }\n+\n+    let y = Void(); //~ ERROR expected function, found enum\n+\n+    let z = ManyVariants(); //~ ERROR expected function, found enum\n }\n \n fn main() {}"}, {"sha": "4210b4e057ac132f08d8cf002a67fc2714051471", "filename": "src/test/ui/did_you_mean/issue-43871-enum-instead-of-variant.stderr", "status": "modified", "additions": 42, "deletions": 13, "changes": 55, "blob_url": "https://github.com/rust-lang/rust/blob/16a8abe1bb159c4f1255533a4969590e3b7e0e61/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-43871-enum-instead-of-variant.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/16a8abe1bb159c4f1255533a4969590e3b7e0e61/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-43871-enum-instead-of-variant.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-43871-enum-instead-of-variant.stderr?ref=16a8abe1bb159c4f1255533a4969590e3b7e0e61", "patch": "@@ -1,34 +1,63 @@\n error[E0423]: expected function, found enum `Option`\n-  --> $DIR/issue-43871-enum-instead-of-variant.rs:4:13\n+  --> $DIR/issue-43871-enum-instead-of-variant.rs:19:13\n    |\n LL |     let x = Option(1);\n    |             ^^^^^^\n+help: try using one of the enum's variants\n    |\n-   = note: did you mean to use one of the following variants?\n-           - `std::prelude::v1::Option::None`\n-           - `std::prelude::v1::Option::Some`\n+LL |     let x = std::prelude::v1::Option::None(1);\n+   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |     let x = std::prelude::v1::Option::Some(1);\n+   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error[E0532]: expected tuple struct/variant, found enum `Option`\n-  --> $DIR/issue-43871-enum-instead-of-variant.rs:6:12\n+  --> $DIR/issue-43871-enum-instead-of-variant.rs:21:12\n    |\n LL |     if let Option(_) = x {\n    |            ^^^^^^\n+help: try using one of the enum's variants\n    |\n-   = note: did you mean to use one of the following variants?\n-           - `std::prelude::v1::Option::None`\n-           - `std::prelude::v1::Option::Some`\n+LL |     if let std::prelude::v1::Option::None(_) = x {\n+   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |     if let std::prelude::v1::Option::Some(_) = x {\n+   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error[E0532]: expected tuple struct/variant, found enum `Example`\n-  --> $DIR/issue-43871-enum-instead-of-variant.rs:12:12\n+  --> $DIR/issue-43871-enum-instead-of-variant.rs:27:12\n    |\n LL |     if let Example(_) = y {\n    |            ^^^^^^^\n+help: try using one of the enum's variants\n    |\n-   = note: did you mean to use one of the following variants?\n-           - `Example::Ex`\n-           - `Example::NotEx`\n+LL |     if let Example::Ex(_) = y {\n+   |            ^^^^^^^^^^^\n+LL |     if let Example::NotEx(_) = y {\n+   |            ^^^^^^^^^^^^^^\n \n-error: aborting due to 3 previous errors\n+error[E0423]: expected function, found enum `Void`\n+  --> $DIR/issue-43871-enum-instead-of-variant.rs:31:13\n+   |\n+LL |     let y = Void();\n+   |             ^^^^\n+\n+error[E0423]: expected function, found enum `ManyVariants`\n+  --> $DIR/issue-43871-enum-instead-of-variant.rs:33:13\n+   |\n+LL |     let z = ManyVariants();\n+   |             ^^^^^^^^^^^^\n+help: try using one of the enum's variants\n+   |\n+LL |     let z = ManyVariants::Eight();\n+   |             ^^^^^^^^^^^^^^^^^^^\n+LL |     let z = ManyVariants::Five();\n+   |             ^^^^^^^^^^^^^^^^^^\n+LL |     let z = ManyVariants::Four();\n+   |             ^^^^^^^^^^^^^^^^^^\n+LL |     let z = ManyVariants::Nine();\n+   |             ^^^^^^^^^^^^^^^^^^\n+and 6 other candidates\n+\n+error: aborting due to 5 previous errors\n \n Some errors occurred: E0423, E0532.\n For more information about an error, try `rustc --explain E0423`."}, {"sha": "c252a6e220c64567a5fd5078e0afb2011a91ad5e", "filename": "src/test/ui/glob-resolve1.stderr", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/16a8abe1bb159c4f1255533a4969590e3b7e0e61/src%2Ftest%2Fui%2Fglob-resolve1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/16a8abe1bb159c4f1255533a4969590e3b7e0e61/src%2Ftest%2Fui%2Fglob-resolve1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fglob-resolve1.stderr?ref=16a8abe1bb159c4f1255533a4969590e3b7e0e61", "patch": "@@ -22,10 +22,7 @@ error[E0423]: expected value, found enum `B`\n   --> $DIR/glob-resolve1.rs:24:5\n    |\n LL |     B;\n-   |     ^\n-   |\n-   = note: did you mean to use one of the following variants?\n-           - `B::B1`\n+   |     ^ help: try using the enum's variant: `B::B1`\n \n error[E0425]: cannot find value `C` in this scope\n   --> $DIR/glob-resolve1.rs:25:5"}, {"sha": "75d9c97513d3116de54376909e244a4b648ef06e", "filename": "src/test/ui/resolve/privacy-enum-ctor.stderr", "status": "modified", "additions": 42, "deletions": 23, "changes": 65, "blob_url": "https://github.com/rust-lang/rust/blob/16a8abe1bb159c4f1255533a4969590e3b7e0e61/src%2Ftest%2Fui%2Fresolve%2Fprivacy-enum-ctor.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/16a8abe1bb159c4f1255533a4969590e3b7e0e61/src%2Ftest%2Fui%2Fresolve%2Fprivacy-enum-ctor.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Fprivacy-enum-ctor.stderr?ref=16a8abe1bb159c4f1255533a4969590e3b7e0e61", "patch": "@@ -3,22 +3,32 @@ error[E0423]: expected value, found enum `n::Z`\n    |\n LL |         n::Z;\n    |         ^^^^\n-   |\n-   = note: did you mean to use one of the following variants?\n-           - `m::Z::Fn`\n-           - `m::Z::Struct`\n-           - `m::Z::Unit`\n+help: try using one of the enum's variants\n+   |\n+LL |         m::Z::Fn;\n+   |         ^^^^^^^^\n+LL |         m::Z::Struct;\n+   |         ^^^^^^^^^^^^\n+LL |         m::Z::Unit;\n+   |         ^^^^^^^^^^\n \n error[E0423]: expected value, found enum `Z`\n   --> $DIR/privacy-enum-ctor.rs:25:9\n    |\n LL |         Z;\n-   |         ^ help: a function with a similar name exists: `f`\n+   |         ^\n+help: a function with a similar name exists\n    |\n-   = note: did you mean to use one of the following variants?\n-           - `m::Z::Fn`\n-           - `m::Z::Struct`\n-           - `m::Z::Unit`\n+LL |         f;\n+   |         ^\n+help: try using one of the enum's variants\n+   |\n+LL |         m::Z::Fn;\n+   |         ^^^^^^^^\n+LL |         m::Z::Struct;\n+   |         ^^^^^^^^^^^^\n+LL |         m::Z::Unit;\n+   |         ^^^^^^^^^^\n \n error[E0423]: expected value, found struct variant `Z::Struct`\n   --> $DIR/privacy-enum-ctor.rs:29:20\n@@ -31,15 +41,18 @@ error[E0423]: expected value, found enum `m::E`\n    |\n LL |     let _: E = m::E;\n    |                ^^^^\n-   |\n-   = note: did you mean to use one of the following variants?\n-           - `E::Fn`\n-           - `E::Struct`\n-           - `E::Unit`\n help: a function with a similar name exists\n    |\n LL |     let _: E = m::f;\n    |                   ^\n+help: try using one of the enum's variants\n+   |\n+LL |     let _: E = E::Fn;\n+   |                ^^^^^\n+LL |     let _: E = E::Struct;\n+   |                ^^^^^^^^^\n+LL |     let _: E = E::Unit;\n+   |                ^^^^^^^\n help: possible better candidates are found in other modules, you can import them into scope\n    |\n LL | use std::f32::consts::E;\n@@ -58,11 +71,14 @@ error[E0423]: expected value, found enum `E`\n    |\n LL |     let _: E = E;\n    |                ^\n+help: try using one of the enum's variants\n    |\n-   = note: did you mean to use one of the following variants?\n-           - `E::Fn`\n-           - `E::Struct`\n-           - `E::Unit`\n+LL |     let _: E = E::Fn;\n+   |                ^^^^^\n+LL |     let _: E = E::Struct;\n+   |                ^^^^^^^^^\n+LL |     let _: E = E::Unit;\n+   |                ^^^^^^^\n help: possible better candidates are found in other modules, you can import them into scope\n    |\n LL | use std::f32::consts::E;\n@@ -95,11 +111,14 @@ error[E0423]: expected value, found enum `m::n::Z`\n    |\n LL |     let _: Z = m::n::Z;\n    |                ^^^^^^^\n+help: try using one of the enum's variants\n    |\n-   = note: did you mean to use one of the following variants?\n-           - `m::Z::Fn`\n-           - `m::Z::Struct`\n-           - `m::Z::Unit`\n+LL |     let _: Z = m::Z::Fn;\n+   |                ^^^^^^^^\n+LL |     let _: Z = m::Z::Struct;\n+   |                ^^^^^^^^^^^^\n+LL |     let _: Z = m::Z::Unit;\n+   |                ^^^^^^^^^^\n \n error[E0412]: cannot find type `Z` in this scope\n   --> $DIR/privacy-enum-ctor.rs:61:12"}]}