{"sha": "867ac98d386fdf0d79173a60f7c11b29e0dbdb38", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg2N2FjOThkMzg2ZmRmMGQ3OTE3M2E2MGY3YzExYjI5ZTBkYmRiMzg=", "commit": {"author": {"name": "Michael Wright", "email": "mikerite@lavabit.com", "date": "2018-09-22T15:20:34Z"}, "committer": {"name": "Michael Wright", "email": "mikerite@lavabit.com", "date": "2018-09-22T15:20:34Z"}, "message": "Fix double_parens false positive\n\nCloses #3206", "tree": {"sha": "a8f08a1384612db9fe08b4dc88032581f60d84a9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a8f08a1384612db9fe08b4dc88032581f60d84a9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/867ac98d386fdf0d79173a60f7c11b29e0dbdb38", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/867ac98d386fdf0d79173a60f7c11b29e0dbdb38", "html_url": "https://github.com/rust-lang/rust/commit/867ac98d386fdf0d79173a60f7c11b29e0dbdb38", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/867ac98d386fdf0d79173a60f7c11b29e0dbdb38/comments", "author": null, "committer": null, "parents": [{"sha": "c0c770c60bb52f50c27f9d32c13842737906509e", "url": "https://api.github.com/repos/rust-lang/rust/commits/c0c770c60bb52f50c27f9d32c13842737906509e", "html_url": "https://github.com/rust-lang/rust/commit/c0c770c60bb52f50c27f9d32c13842737906509e"}], "stats": {"total": 21, "additions": 19, "deletions": 2}, "files": [{"sha": "3b2ef4e8bb2a0afb6fc3954b54da6dd8d176079c", "filename": "clippy_lints/src/double_parens.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/867ac98d386fdf0d79173a60f7c11b29e0dbdb38/clippy_lints%2Fsrc%2Fdouble_parens.rs", "raw_url": "https://github.com/rust-lang/rust/raw/867ac98d386fdf0d79173a60f7c11b29e0dbdb38/clippy_lints%2Fsrc%2Fdouble_parens.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fdouble_parens.rs?ref=867ac98d386fdf0d79173a60f7c11b29e0dbdb38", "patch": "@@ -1,7 +1,8 @@\n use crate::syntax::ast::*;\n use crate::rustc::lint::{EarlyContext, EarlyLintPass, LintArray, LintPass};\n use crate::rustc::{declare_tool_lint, lint_array};\n-use crate::utils::span_lint;\n+use crate::utils::{in_macro, span_lint};\n+\n \n /// **What it does:** Checks for unnecessary double parentheses.\n ///\n@@ -33,6 +34,10 @@ impl LintPass for DoubleParens {\n \n impl EarlyLintPass for DoubleParens {\n     fn check_expr(&mut self, cx: &EarlyContext<'_>, expr: &Expr) {\n+        if in_macro(expr.span) {\n+            return;\n+        }\n+\n         match expr.node {\n             ExprKind::Paren(ref in_paren) => match in_paren.node {\n                 ExprKind::Paren(_) | ExprKind::Tup(_) => {"}, {"sha": "c217972fa6af7b8033d42648a4bcd240accf9023", "filename": "tests/ui/double_parens.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/867ac98d386fdf0d79173a60f7c11b29e0dbdb38/tests%2Fui%2Fdouble_parens.rs", "raw_url": "https://github.com/rust-lang/rust/raw/867ac98d386fdf0d79173a60f7c11b29e0dbdb38/tests%2Fui%2Fdouble_parens.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fdouble_parens.rs?ref=867ac98d386fdf0d79173a60f7c11b29e0dbdb38", "patch": "@@ -48,4 +48,10 @@ fn method_unit_ok(x: DummyStruct) {\n     x.dummy_method(());\n }\n \n+// Issue #3206\n+fn inside_macro() {\n+    assert_eq!((1, 2), (1, 2), \"Error\");\n+    assert_eq!(((1, 2)), (1, 2), \"Error\");\n+}\n+\n fn main() {}"}, {"sha": "3e38db730e04b1f346af81b7e7c55bbc3e5a8bf1", "filename": "tests/ui/double_parens.stderr", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/867ac98d386fdf0d79173a60f7c11b29e0dbdb38/tests%2Fui%2Fdouble_parens.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/867ac98d386fdf0d79173a60f7c11b29e0dbdb38/tests%2Fui%2Fdouble_parens.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fdouble_parens.stderr?ref=867ac98d386fdf0d79173a60f7c11b29e0dbdb38", "patch": "@@ -30,5 +30,11 @@ error: Consider removing unnecessary double parentheses\n 32 |     (())\n    |     ^^^^\n \n-error: aborting due to 5 previous errors\n+error: Consider removing unnecessary double parentheses\n+  --> $DIR/double_parens.rs:54:16\n+   |\n+54 |     assert_eq!(((1, 2)), (1, 2), \"Error\");\n+   |                ^^^^^^^^\n+\n+error: aborting due to 6 previous errors\n "}]}