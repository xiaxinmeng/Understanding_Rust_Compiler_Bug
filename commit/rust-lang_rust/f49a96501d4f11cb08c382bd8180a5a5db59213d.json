{"sha": "f49a96501d4f11cb08c382bd8180a5a5db59213d", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY0OWE5NjUwMWQ0ZjExY2IwOGMzODJiZDgxODBhNWE1ZGI1OTIxM2Q=", "commit": {"author": {"name": "Ilija Tovilo", "email": "ilija.tovilo@me.com", "date": "2019-07-24T12:09:26Z"}, "committer": {"name": "Ilija Tovilo", "email": "ilija.tovilo@me.com", "date": "2019-07-24T12:09:26Z"}, "message": "Add test for #51559\n\nCloses #51559", "tree": {"sha": "c25411d85c34017b9d95c3fd1845ca65e8c23fe0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c25411d85c34017b9d95c3fd1845ca65e8c23fe0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f49a96501d4f11cb08c382bd8180a5a5db59213d", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEzbqtco3jAIy93eipPxI9Ct1EgZgFAl04So4ACgkQPxI9Ct1E\ngZh+ERAAnhA7lLLCrnPjVTBKZK7V2M0DJ8Cuer8XqROUN14W0aFhOBRBFjsoq8Qd\nKqfVGhiLkoTzGwJna8fvDPXggOZ+DKDmA4Prv8/76p1qmjQKMptOVvPsgKsiC0FS\nSYVOZxfj/zl7h9SoQbH0MAfyXcdFwjLh8lQIhXzJU7Rss3i2Q3Ebc35awAongZMJ\nx94YOshwPnOnLrZAxXXQws/Iq8ptlSA3saWHd44ZbtvC6ULsoSGgOjgXLC3QD81d\nvFi4suYqYcvF6H9x3ketAkXrFx6DaywH4GaL9DKFe1kiIh9EB/3Ezeu9/j2iTS5E\nKeGdNF3gTXbDcD2hF7aFaIcDvyeRM3J/6YpLZllDwq6RrIYbUDVTsPcly0DkXZY8\nBwjqEDiFmLij4iB1uUP7lcehCbcfRhjBcJm/MWJEo1UnWSb6XkA2RNm4Y4SPJek4\nj+h8/P80+fZj1EB2Rg+wn+QJVX222UPnNrYhucQp7LI4d4iWfH+QZHtWF/LMwlSz\nX0h9TFNAjTkBGQwR/bMZiUs9Pu9yUufXxP44Bp2jBHDW1RwmIeK4nIyJ+hI9KBE3\np3uGD1bj82YHHvcozqrZr77gWmwYSucPs9C8tnvQfCDfCTfV4MlegKRiADuqLX37\nsEVtlXpTAet5rBtOFL1Ku8Hb6jw2Fx8d/WtAxI9s5T33IkaivjI=\n=F2mb\n-----END PGP SIGNATURE-----", "payload": "tree c25411d85c34017b9d95c3fd1845ca65e8c23fe0\nparent a7f28678bbf4e16893bb6a718e427504167a9494\nauthor Ilija Tovilo <ilija.tovilo@me.com> 1563970166 +0200\ncommitter Ilija Tovilo <ilija.tovilo@me.com> 1563970166 +0200\n\nAdd test for #51559\n\nCloses #51559\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f49a96501d4f11cb08c382bd8180a5a5db59213d", "html_url": "https://github.com/rust-lang/rust/commit/f49a96501d4f11cb08c382bd8180a5a5db59213d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f49a96501d4f11cb08c382bd8180a5a5db59213d/comments", "author": {"login": "iluuu1994", "id": 1752683, "node_id": "MDQ6VXNlcjE3NTI2ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1752683?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iluuu1994", "html_url": "https://github.com/iluuu1994", "followers_url": "https://api.github.com/users/iluuu1994/followers", "following_url": "https://api.github.com/users/iluuu1994/following{/other_user}", "gists_url": "https://api.github.com/users/iluuu1994/gists{/gist_id}", "starred_url": "https://api.github.com/users/iluuu1994/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iluuu1994/subscriptions", "organizations_url": "https://api.github.com/users/iluuu1994/orgs", "repos_url": "https://api.github.com/users/iluuu1994/repos", "events_url": "https://api.github.com/users/iluuu1994/events{/privacy}", "received_events_url": "https://api.github.com/users/iluuu1994/received_events", "type": "User", "site_admin": false}, "committer": {"login": "iluuu1994", "id": 1752683, "node_id": "MDQ6VXNlcjE3NTI2ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1752683?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iluuu1994", "html_url": "https://github.com/iluuu1994", "followers_url": "https://api.github.com/users/iluuu1994/followers", "following_url": "https://api.github.com/users/iluuu1994/following{/other_user}", "gists_url": "https://api.github.com/users/iluuu1994/gists{/gist_id}", "starred_url": "https://api.github.com/users/iluuu1994/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iluuu1994/subscriptions", "organizations_url": "https://api.github.com/users/iluuu1994/orgs", "repos_url": "https://api.github.com/users/iluuu1994/repos", "events_url": "https://api.github.com/users/iluuu1994/events{/privacy}", "received_events_url": "https://api.github.com/users/iluuu1994/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a7f28678bbf4e16893bb6a718e427504167a9494", "url": "https://api.github.com/repos/rust-lang/rust/commits/a7f28678bbf4e16893bb6a718e427504167a9494", "html_url": "https://github.com/rust-lang/rust/commit/a7f28678bbf4e16893bb6a718e427504167a9494"}], "stats": {"total": 18, "additions": 18, "deletions": 0}, "files": [{"sha": "429947269385be53b7f1c71d7b6ff99ed701a51c", "filename": "src/test/ui/consts/issue-51559.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/f49a96501d4f11cb08c382bd8180a5a5db59213d/src%2Ftest%2Fui%2Fconsts%2Fissue-51559.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f49a96501d4f11cb08c382bd8180a5a5db59213d/src%2Ftest%2Fui%2Fconsts%2Fissue-51559.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fissue-51559.rs?ref=f49a96501d4f11cb08c382bd8180a5a5db59213d", "patch": "@@ -0,0 +1,7 @@\n+#![feature(const_raw_ptr_to_usize_cast)]\n+\n+const BAR: *mut () = ((|| 3) as fn() -> i32) as *mut ();\n+pub const FOO: usize = unsafe { BAR as usize };\n+//~^ ERROR it is undefined behavior to use this value\n+\n+fn main() {}"}, {"sha": "917c54ddaef1efeeab049cd327c2a013b591cf3e", "filename": "src/test/ui/consts/issue-51559.stderr", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/f49a96501d4f11cb08c382bd8180a5a5db59213d/src%2Ftest%2Fui%2Fconsts%2Fissue-51559.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/f49a96501d4f11cb08c382bd8180a5a5db59213d/src%2Ftest%2Fui%2Fconsts%2Fissue-51559.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fissue-51559.stderr?ref=f49a96501d4f11cb08c382bd8180a5a5db59213d", "patch": "@@ -0,0 +1,11 @@\n+error[E0080]: it is undefined behavior to use this value\n+  --> $DIR/issue-51559.rs:4:1\n+   |\n+LL | pub const FOO: usize = unsafe { BAR as usize };\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ type validation failed: encountered a pointer, but expected initialized plain (non-pointer) bytes\n+   |\n+   = note: The rules on what exactly is undefined behavior aren't clear, so this check might be overzealous. Please open an issue on the rust compiler repository if you believe it should not be considered undefined behavior\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0080`."}]}