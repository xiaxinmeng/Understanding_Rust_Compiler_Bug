{"sha": "3f2532b904f2ed38e69073d12a07c6aa32672197", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNmMjUzMmI5MDRmMmVkMzhlNjkwNzNkMTJhMDdjNmFhMzI2NzIxOTc=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2020-01-31T06:30:44Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2020-01-31T06:30:44Z"}, "message": "Replace one more copy-pasted clippy_project_root fn", "tree": {"sha": "62bd51a3097b1c35414dbbd9b43a6f4cbb3bf245", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/62bd51a3097b1c35414dbbd9b43a6f4cbb3bf245"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3f2532b904f2ed38e69073d12a07c6aa32672197", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJEBAABCgAuFiEEj4U0bmbiMSg/mWqvgqphyqETl+YFAl4zyasQHGRldkBwaGFu\nc2NoLm5ldAAKCRCCqmHKoROX5pkSEACtqBWER/xn5WyQkTUpYzGPBNFVgjqTy6PG\nXR9PQ3a+V3htor5jUHASCLB4M+ftmE42XezAtJf2DOxQqOablNsOo42qRaSXTj6A\n8ZorSLZ8xqHk0wAL3oF1vhB4y+ppIJnqsCZtqj0mYbPiquz8vnaTYSRBQ2vFpTZd\nQOUp98CKGE1dz+ohPQzwFIi2m5SMeQrY/PDccVB3q9BnIiu7IOcQDWqp7O1NCOMK\n3PdFffltmg9L+SK3gzboWiDSo6t2KHk+c3FQ6S2yKYKK0ae6+xYZP5EyZh+ywsmZ\nsv4I3i5Ef+OY7ggAX20A7NYYEva8/pq0Ok+i8YF8pKsjeoRaRzjJe02kHmIohc2K\ncc5JBhk8NwVEITwubFT3c5x/UecDo7qGIkb+Y0axpTpiDdBESEc6KJ0+Ss9e0uDA\n03Y5yxx8gf0vr3YeYisVNR1g0BlAYzrWVq5AfR49pUp3adJpalP5eJxP8bWDs5sy\nGetgT/7KEhm1c8GaIwZr1+d4BXXPt8tt2p+YlR9Pww8R4TlF48nUPv0+heqgCHOP\nkNoEipy0T9zqp5595yKz5sHZlJekT90R5Y48iAAPue1bStRWoaBtfESbmEqCzx99\n9vpeNtnFH4bXvu0CRVaO42X+LwrrfILQnEn856f9QR7BqCA42quwu+96fhDgS47V\ngTW304Ytzg==\n=uTgJ\n-----END PGP SIGNATURE-----", "payload": "tree 62bd51a3097b1c35414dbbd9b43a6f4cbb3bf245\nparent 3036a2c30e870f589a6176f25682b41b9b8fb4f8\nauthor Philipp Hansch <dev@phansch.net> 1580452244 +0100\ncommitter Philipp Hansch <dev@phansch.net> 1580452244 +0100\n\nReplace one more copy-pasted clippy_project_root fn\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3f2532b904f2ed38e69073d12a07c6aa32672197", "html_url": "https://github.com/rust-lang/rust/commit/3f2532b904f2ed38e69073d12a07c6aa32672197", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3f2532b904f2ed38e69073d12a07c6aa32672197/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3036a2c30e870f589a6176f25682b41b9b8fb4f8", "url": "https://api.github.com/repos/rust-lang/rust/commits/3036a2c30e870f589a6176f25682b41b9b8fb4f8", "html_url": "https://github.com/rust-lang/rust/commit/3036a2c30e870f589a6176f25682b41b9b8fb4f8"}], "stats": {"total": 23, "additions": 3, "deletions": 20}, "files": [{"sha": "9d1f19f954b060f41afe020f3c65e5910328083f", "filename": "clippy_dev/src/new_lint.rs", "status": "modified", "additions": 3, "deletions": 20, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/3f2532b904f2ed38e69073d12a07c6aa32672197/clippy_dev%2Fsrc%2Fnew_lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3f2532b904f2ed38e69073d12a07c6aa32672197/clippy_dev%2Fsrc%2Fnew_lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Fnew_lint.rs?ref=3f2532b904f2ed38e69073d12a07c6aa32672197", "patch": "@@ -1,8 +1,9 @@\n+use clippy_dev::clippy_project_root;\n use std::fs::{File, OpenOptions};\n use std::io;\n use std::io::prelude::*;\n use std::io::ErrorKind;\n-use std::path::{Path, PathBuf};\n+use std::path::Path;\n \n pub fn create(pass: Option<&str>, lint_name: Option<&str>, category: Option<&str>) -> Result<(), io::Error> {\n     let pass = pass.expect(\"`pass` argument is validated by clap\");\n@@ -55,7 +56,7 @@ pub fn create(pass: Option<&str>, lint_name: Option<&str>, category: Option<&str\n }\n \n fn open_files(lint_name: &str) -> Result<(File, File), io::Error> {\n-    let project_root = project_root()?;\n+    let project_root = clippy_project_root();\n \n     let test_file_path = project_root.join(\"tests\").join(\"ui\").join(format!(\"{}.rs\", lint_name));\n     let lint_file_path = project_root\n@@ -82,24 +83,6 @@ fn open_files(lint_name: &str) -> Result<(File, File), io::Error> {\n     Ok((test_file, lint_file))\n }\n \n-fn project_root() -> Result<PathBuf, io::Error> {\n-    let current_dir = std::env::current_dir()?;\n-    for path in current_dir.ancestors() {\n-        let result = std::fs::read_to_string(path.join(\"Cargo.toml\"));\n-        if let Err(err) = &result {\n-            if err.kind() == io::ErrorKind::NotFound {\n-                continue;\n-            }\n-        }\n-\n-        let content = result?;\n-        if content.contains(\"[package]\\nname = \\\"clippy\\\"\") {\n-            return Ok(path.to_path_buf());\n-        }\n-    }\n-    Err(io::Error::new(ErrorKind::Other, \"Unable to find project root\"))\n-}\n-\n fn to_camel_case(name: &str) -> String {\n     name.split('_')\n         .map(|s| {"}]}