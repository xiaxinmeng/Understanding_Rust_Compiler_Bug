{"sha": "8ee77a268f1f90b6e99e31cd3c4d03f893b73a76", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhlZTc3YTI2OGYxZjkwYjZlOTllMzFjZDNjNGQwM2Y4OTNiNzNhNzY=", "commit": {"author": {"name": "Santiago Pastorino", "email": "spastorino@gmail.com", "date": "2019-09-14T22:51:40Z"}, "committer": {"name": "Santiago Pastorino", "email": "spastorino@gmail.com", "date": "2019-09-14T22:51:40Z"}, "message": "Use try_fold instead of manually carrying an accumulator", "tree": {"sha": "1d2f77c88231e47bde458c4a881ceb1b5667e004", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1d2f77c88231e47bde458c4a881ceb1b5667e004"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8ee77a268f1f90b6e99e31cd3c4d03f893b73a76", "comment_count": 0, "verification": {"verified": false, "reason": "unknown_key", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEmNHc6jmXzkUyxd4xiMlBzaHUZDIFAl19bvwACgkQiMlBzaHU\nZDJBiQ//fHaR3Oxk7MtqNYZrwBH/i6z0UPUjtWgjtvPnVY0UhN5Z5qDtUOKklAo1\nehNKxAhFOqo95TDZyGsZYEev06laNXLhnhHVEXDVO5hDGlQwwwQEatFKSTod8oss\nmrzXH/tlj9CJoFehdj4D+f+ZEhpSg/eun7eSbiVMXTW8aV3skMlGuSy3f0hmOFpl\nbpJqRnufkP2fWpbKfcjBn+XDmn9OQ6LXXdWrJKs7YP1s7sCYUJ1H3pw60e4xXYyQ\n8k3sPm6KHm6Jy2xZLR84ISk/DYNFZHjxwvRyI9BIAKff77O/jE0JopTqj+pUxaHd\nPnv1PqQuN9VsbtyY1MBUkx1CDOa0pmC8j6lDeS6O0scOfvswmKE3idUBaIULISax\nXG4BPUKeNFqOuz2aXAjdtR91SNq2A+FZIzFon+2uBVw6nNFIza+o9RBVPG3BCzC8\nN/Jb0vkMIXfzcue0llkYa+o9DDzzCx1R8TNzf6o76ettAiR5k8c3dxqHlsYgghX3\nLWzCStEoruZ1lpYfXFgfuqMX8ndL4cHibJTnblQGkXqiqCjx9ar0fOJieOpv/jP2\nTSURn10hOMlj/YpS4C9RWIDGcoAfESkIMYKiKcd4Km30BSlCld3vd0WLcdNRqcgK\nUKSHSsBBBZ/24Pmzo5AONdpqWKSWvk6si6fVxxxJwWrMuDN/olM=\n=Nouz\n-----END PGP SIGNATURE-----", "payload": "tree 1d2f77c88231e47bde458c4a881ceb1b5667e004\nparent a6946a817a1345ce739acd8b12255c0a595e9b39\nauthor Santiago Pastorino <spastorino@gmail.com> 1568501500 -0300\ncommitter Santiago Pastorino <spastorino@gmail.com> 1568501500 -0300\n\nUse try_fold instead of manually carrying an accumulator\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8ee77a268f1f90b6e99e31cd3c4d03f893b73a76", "html_url": "https://github.com/rust-lang/rust/commit/8ee77a268f1f90b6e99e31cd3c4d03f893b73a76", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8ee77a268f1f90b6e99e31cd3c4d03f893b73a76/comments", "author": {"login": "spastorino", "id": 52642, "node_id": "MDQ6VXNlcjUyNjQy", "avatar_url": "https://avatars.githubusercontent.com/u/52642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spastorino", "html_url": "https://github.com/spastorino", "followers_url": "https://api.github.com/users/spastorino/followers", "following_url": "https://api.github.com/users/spastorino/following{/other_user}", "gists_url": "https://api.github.com/users/spastorino/gists{/gist_id}", "starred_url": "https://api.github.com/users/spastorino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spastorino/subscriptions", "organizations_url": "https://api.github.com/users/spastorino/orgs", "repos_url": "https://api.github.com/users/spastorino/repos", "events_url": "https://api.github.com/users/spastorino/events{/privacy}", "received_events_url": "https://api.github.com/users/spastorino/received_events", "type": "User", "site_admin": false}, "committer": {"login": "spastorino", "id": 52642, "node_id": "MDQ6VXNlcjUyNjQy", "avatar_url": "https://avatars.githubusercontent.com/u/52642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spastorino", "html_url": "https://github.com/spastorino", "followers_url": "https://api.github.com/users/spastorino/followers", "following_url": "https://api.github.com/users/spastorino/following{/other_user}", "gists_url": "https://api.github.com/users/spastorino/gists{/gist_id}", "starred_url": "https://api.github.com/users/spastorino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spastorino/subscriptions", "organizations_url": "https://api.github.com/users/spastorino/orgs", "repos_url": "https://api.github.com/users/spastorino/repos", "events_url": "https://api.github.com/users/spastorino/events{/privacy}", "received_events_url": "https://api.github.com/users/spastorino/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a6946a817a1345ce739acd8b12255c0a595e9b39", "url": "https://api.github.com/repos/rust-lang/rust/commits/a6946a817a1345ce739acd8b12255c0a595e9b39", "html_url": "https://github.com/rust-lang/rust/commit/a6946a817a1345ce739acd8b12255c0a595e9b39"}], "stats": {"total": 9, "additions": 5, "deletions": 4}, "files": [{"sha": "9ad1542905b687a9770431f5f7c1edbd7a68e093", "filename": "src/librustc_mir/interpret/operand.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/8ee77a268f1f90b6e99e31cd3c4d03f893b73a76/src%2Flibrustc_mir%2Finterpret%2Foperand.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8ee77a268f1f90b6e99e31cd3c4d03f893b73a76/src%2Flibrustc_mir%2Finterpret%2Foperand.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Foperand.rs?ref=8ee77a268f1f90b6e99e31cd3c4d03f893b73a76", "patch": "@@ -477,7 +477,7 @@ impl<'mir, 'tcx, M: Machine<'mir, 'tcx>> InterpCx<'mir, 'tcx, M> {\n     ) -> InterpResult<'tcx, OpTy<'tcx, M::PointerTag>> {\n         use rustc::mir::PlaceBase;\n \n-        let mut op = match &place.base {\n+        let base_op = match &place.base {\n             PlaceBase::Local(mir::RETURN_PLACE) =>\n                 throw_unsup!(ReadFromReturnPointer),\n             PlaceBase::Local(local) => {\n@@ -497,9 +497,10 @@ impl<'mir, 'tcx, M: Machine<'mir, 'tcx>> InterpCx<'mir, 'tcx, M> {\n             }\n         };\n \n-        for elem in place.projection.iter() {\n-            op = self.operand_projection(op, elem)?\n-        }\n+        let op = place.projection.iter().try_fold(\n+            base_op,\n+            |op, elem| self.operand_projection(op, elem)\n+        )?;\n \n         trace!(\"eval_place_to_op: got {:?}\", *op);\n         Ok(op)"}]}