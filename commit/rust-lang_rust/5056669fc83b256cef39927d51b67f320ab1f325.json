{"sha": "5056669fc83b256cef39927d51b67f320ab1f325", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUwNTY2NjlmYzgzYjI1NmNlZjM5OTI3ZDUxYjY3ZjMyMGFiMWYzMjU=", "commit": {"author": {"name": "John Heitmann", "email": "jheitmann@gmail.com", "date": "2018-12-18T07:47:56Z"}, "committer": {"name": "John Heitmann", "email": "jheitmann@gmail.com", "date": "2018-12-18T08:12:40Z"}, "message": "Fix rustdoc-js tests\n\nFixes rustdoc-js tests by teaching tester.js how to handle single-line js comments.\n\nAlso, added speculative support for template strings, and warnings for future debuggers.", "tree": {"sha": "12b3d4b6fe6c8de8b257ef51222fffdee35ea1c6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/12b3d4b6fe6c8de8b257ef51222fffdee35ea1c6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5056669fc83b256cef39927d51b67f320ab1f325", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5056669fc83b256cef39927d51b67f320ab1f325", "html_url": "https://github.com/rust-lang/rust/commit/5056669fc83b256cef39927d51b67f320ab1f325", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5056669fc83b256cef39927d51b67f320ab1f325/comments", "author": {"login": "JohnHeitmann", "id": 4282480, "node_id": "MDQ6VXNlcjQyODI0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/4282480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnHeitmann", "html_url": "https://github.com/JohnHeitmann", "followers_url": "https://api.github.com/users/JohnHeitmann/followers", "following_url": "https://api.github.com/users/JohnHeitmann/following{/other_user}", "gists_url": "https://api.github.com/users/JohnHeitmann/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnHeitmann/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnHeitmann/subscriptions", "organizations_url": "https://api.github.com/users/JohnHeitmann/orgs", "repos_url": "https://api.github.com/users/JohnHeitmann/repos", "events_url": "https://api.github.com/users/JohnHeitmann/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnHeitmann/received_events", "type": "User", "site_admin": false}, "committer": {"login": "JohnHeitmann", "id": 4282480, "node_id": "MDQ6VXNlcjQyODI0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/4282480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnHeitmann", "html_url": "https://github.com/JohnHeitmann", "followers_url": "https://api.github.com/users/JohnHeitmann/followers", "following_url": "https://api.github.com/users/JohnHeitmann/following{/other_user}", "gists_url": "https://api.github.com/users/JohnHeitmann/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnHeitmann/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnHeitmann/subscriptions", "organizations_url": "https://api.github.com/users/JohnHeitmann/orgs", "repos_url": "https://api.github.com/users/JohnHeitmann/repos", "events_url": "https://api.github.com/users/JohnHeitmann/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnHeitmann/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c9bb68f5ae5cc297246a084a2cd589787d1ee315", "url": "https://api.github.com/repos/rust-lang/rust/commits/c9bb68f5ae5cc297246a084a2cd589787d1ee315", "html_url": "https://github.com/rust-lang/rust/commit/c9bb68f5ae5cc297246a084a2cd589787d1ee315"}], "stats": {"total": 16, "additions": 14, "deletions": 2}, "files": [{"sha": "65ed86742e74b2f841b016de58043b6b33a4f588", "filename": "src/tools/rustdoc-js/tester.js", "status": "modified", "additions": 14, "deletions": 2, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/5056669fc83b256cef39927d51b67f320ab1f325/src%2Ftools%2Frustdoc-js%2Ftester.js", "raw_url": "https://github.com/rust-lang/rust/raw/5056669fc83b256cef39927d51b67f320ab1f325/src%2Ftools%2Frustdoc-js%2Ftester.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustdoc-js%2Ftester.js?ref=5056669fc83b256cef39927d51b67f320ab1f325", "patch": "@@ -26,7 +26,10 @@ function getNextStep(content, pos, stop) {\n     return pos;\n }\n \n-// Stupid function extractor based on indent.\n+// Stupid function extractor based on indent. Doesn't support block\n+// comments. If someone puts a ' or an \" in a block comment this\n+// will blow up. Template strings are not tested and might also be\n+// broken.\n function extractFunction(content, functionName) {\n     var indent = 0;\n     var splitter = \"function \" + functionName + \"(\";\n@@ -51,7 +54,14 @@ function extractFunction(content, functionName) {\n             continue;\n         }\n         while (pos < content.length) {\n-            if (content[pos] === '\"' || content[pos] === \"'\") {\n+            // Eat single-line comments\n+            if (content[pos] === '/' && pos > 0 && content[pos-1] === '/') {\n+                do {\n+                    pos += 1;\n+                } while (pos < content.length && content[pos] !== '\\n');\n+\n+            // Eat quoted strings\n+            } else if (content[pos] === '\"' || content[pos] === \"'\" || content[pos] === \"`\") {\n                 var stop = content[pos];\n                 var is_escaped = false;\n                 do {\n@@ -62,6 +72,8 @@ function extractFunction(content, functionName) {\n                     }\n                 } while (pos < content.length &&\n                          (content[pos] !== stop || content[pos - 1] === '\\\\'));\n+\n+            // Otherwise, check for indent\n             } else if (content[pos] === '{') {\n                 indent += 1;\n             } else if (content[pos] === '}') {"}]}