{"sha": "c5ad97da258bb47cba2f888cee73b0f4b5289d58", "node_id": "C_kwDOAAsO6NoAKGM1YWQ5N2RhMjU4YmI0N2NiYTJmODg4Y2VlNzNiMGY0YjUyODlkNTg", "commit": {"author": {"name": "Josh Triplett", "email": "josh@joshtriplett.org", "date": "2022-10-16T13:53:21Z"}, "committer": {"name": "Josh Triplett", "email": "josh@joshtriplett.org", "date": "2022-10-16T14:10:40Z"}, "message": "Use IsTerminal in rustc_errors", "tree": {"sha": "fca6a5ba5e945e328df456949147d2d256db5b9d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fca6a5ba5e945e328df456949147d2d256db5b9d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c5ad97da258bb47cba2f888cee73b0f4b5289d58", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c5ad97da258bb47cba2f888cee73b0f4b5289d58", "html_url": "https://github.com/rust-lang/rust/commit/c5ad97da258bb47cba2f888cee73b0f4b5289d58", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c5ad97da258bb47cba2f888cee73b0f4b5289d58/comments", "author": {"login": "joshtriplett", "id": 162737, "node_id": "MDQ6VXNlcjE2MjczNw==", "avatar_url": "https://avatars.githubusercontent.com/u/162737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joshtriplett", "html_url": "https://github.com/joshtriplett", "followers_url": "https://api.github.com/users/joshtriplett/followers", "following_url": "https://api.github.com/users/joshtriplett/following{/other_user}", "gists_url": "https://api.github.com/users/joshtriplett/gists{/gist_id}", "starred_url": "https://api.github.com/users/joshtriplett/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joshtriplett/subscriptions", "organizations_url": "https://api.github.com/users/joshtriplett/orgs", "repos_url": "https://api.github.com/users/joshtriplett/repos", "events_url": "https://api.github.com/users/joshtriplett/events{/privacy}", "received_events_url": "https://api.github.com/users/joshtriplett/received_events", "type": "User", "site_admin": false}, "committer": {"login": "joshtriplett", "id": 162737, "node_id": "MDQ6VXNlcjE2MjczNw==", "avatar_url": "https://avatars.githubusercontent.com/u/162737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joshtriplett", "html_url": "https://github.com/joshtriplett", "followers_url": "https://api.github.com/users/joshtriplett/followers", "following_url": "https://api.github.com/users/joshtriplett/following{/other_user}", "gists_url": "https://api.github.com/users/joshtriplett/gists{/gist_id}", "starred_url": "https://api.github.com/users/joshtriplett/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joshtriplett/subscriptions", "organizations_url": "https://api.github.com/users/joshtriplett/orgs", "repos_url": "https://api.github.com/users/joshtriplett/repos", "events_url": "https://api.github.com/users/joshtriplett/events{/privacy}", "received_events_url": "https://api.github.com/users/joshtriplett/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8be3ce9056d17f822704b8994f60668adf180fe8", "url": "https://api.github.com/repos/rust-lang/rust/commits/8be3ce9056d17f822704b8994f60668adf180fe8", "html_url": "https://github.com/rust-lang/rust/commit/8be3ce9056d17f822704b8994f60668adf180fe8"}], "stats": {"total": 9, "additions": 4, "deletions": 5}, "files": [{"sha": "6c0bb32dec71e28234f6b58ed6c88ea4ac6804d0", "filename": "Cargo.lock", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c5ad97da258bb47cba2f888cee73b0f4b5289d58/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/c5ad97da258bb47cba2f888cee73b0f4b5289d58/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=c5ad97da258bb47cba2f888cee73b0f4b5289d58", "patch": "@@ -3452,7 +3452,6 @@ name = \"rustc_errors\"\n version = \"0.0.0\"\n dependencies = [\n  \"annotate-snippets\",\n- \"atty\",\n  \"rustc_ast\",\n  \"rustc_ast_pretty\",\n  \"rustc_data_structures\","}, {"sha": "eb560a68b5697ef92ed957651fb9b10550860bb1", "filename": "compiler/rustc_errors/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c5ad97da258bb47cba2f888cee73b0f4b5289d58/compiler%2Frustc_errors%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/c5ad97da258bb47cba2f888cee73b0f4b5289d58/compiler%2Frustc_errors%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_errors%2FCargo.toml?ref=c5ad97da258bb47cba2f888cee73b0f4b5289d58", "patch": "@@ -18,7 +18,6 @@ rustc_target = { path = \"../rustc_target\" }\n rustc_hir = { path = \"../rustc_hir\" }\n rustc_lint_defs = { path = \"../rustc_lint_defs\" }\n unicode-width = \"0.1.4\"\n-atty = \"0.2\"\n termcolor = \"1.0\"\n annotate-snippets = \"0.9\"\n termize = \"0.1.1\""}, {"sha": "12a93fbedf9006a7f9a8cb29083db4b3a60f43cf", "filename": "compiler/rustc_errors/src/emitter.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/c5ad97da258bb47cba2f888cee73b0f4b5289d58/compiler%2Frustc_errors%2Fsrc%2Femitter.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c5ad97da258bb47cba2f888cee73b0f4b5289d58/compiler%2Frustc_errors%2Fsrc%2Femitter.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_errors%2Fsrc%2Femitter.rs?ref=c5ad97da258bb47cba2f888cee73b0f4b5289d58", "patch": "@@ -28,8 +28,8 @@ use rustc_error_messages::FluentArgs;\n use rustc_span::hygiene::{ExpnKind, MacroKind};\n use std::borrow::Cow;\n use std::cmp::{max, min, Reverse};\n-use std::io;\n use std::io::prelude::*;\n+use std::io::{self, IsTerminal};\n use std::iter;\n use std::path::Path;\n use termcolor::{Ansi, BufferWriter, ColorChoice, ColorSpec, StandardStream};\n@@ -619,14 +619,14 @@ impl ColorConfig {\n     fn to_color_choice(self) -> ColorChoice {\n         match self {\n             ColorConfig::Always => {\n-                if atty::is(atty::Stream::Stderr) {\n+                if io::stderr().is_terminal() {\n                     ColorChoice::Always\n                 } else {\n                     ColorChoice::AlwaysAnsi\n                 }\n             }\n             ColorConfig::Never => ColorChoice::Never,\n-            ColorConfig::Auto if atty::is(atty::Stream::Stderr) => ColorChoice::Auto,\n+            ColorConfig::Auto if io::stderr().is_terminal() => ColorChoice::Auto,\n             ColorConfig::Auto => ColorChoice::Never,\n         }\n     }"}, {"sha": "814dba10484eb82494c749ea449c06d3600c7f19", "filename": "compiler/rustc_errors/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c5ad97da258bb47cba2f888cee73b0f4b5289d58/compiler%2Frustc_errors%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c5ad97da258bb47cba2f888cee73b0f4b5289d58/compiler%2Frustc_errors%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_errors%2Fsrc%2Flib.rs?ref=c5ad97da258bb47cba2f888cee73b0f4b5289d58", "patch": "@@ -5,6 +5,7 @@\n #![doc(html_root_url = \"https://doc.rust-lang.org/nightly/nightly-rustc/\")]\n #![feature(drain_filter)]\n #![feature(if_let_guard)]\n+#![feature(is_terminal)]\n #![feature(adt_const_params)]\n #![feature(let_chains)]\n #![feature(never_type)]"}]}