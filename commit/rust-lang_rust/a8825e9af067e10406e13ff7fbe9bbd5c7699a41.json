{"sha": "a8825e9af067e10406e13ff7fbe9bbd5c7699a41", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE4ODI1ZTlhZjA2N2UxMDQwNmUxM2ZmN2ZiZTliYmQ1Yzc2OTlhNDE=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2021-01-05T15:31:08Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2021-01-05T15:31:08Z"}, "message": "Use existing 'is_automatically_derived' helper", "tree": {"sha": "f309692327bed4afc46e68f5d381defb91e6da7d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f309692327bed4afc46e68f5d381defb91e6da7d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a8825e9af067e10406e13ff7fbe9bbd5c7699a41", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE6VFioMHrom999LRAK0OZxL9Ny94FAl/0hlwACgkQK0OZxL9N\ny95TaA/+OvMlf7T1fOZVRDFcCrFuDA6HCj8jh7KecLroFdEo8j07AXBXHX2d4pEH\nVInH97/SKarSvqvnEQwVbNRBwKnMTPAH45U9EsJb9UF2zwtKsMzx172YFgIUL2fI\nrFvIHIWcS4ujWA6yq7zKlcc/aCo4yc2WcJwdYRNuSjC2kZT0ZobeAkFLHJGTQExy\nTFV2y8i9XBmasWSh+K2f0uEs2/7qLaqqV3uxkYn1qyqs0QSuNdwU2dzSoqgZ29KK\naFYUKyFwrEA3L+pkEgALuP5NUjp9z2a75ZCSf3U+CBWraMnqgPFQdalCr7fweyRJ\n38Q7McBUCuHlXRo4V9KgTZCSukUgxSQLnJsLsNAsZW/6avcEBv65ngo9eQzkpnCX\nRCBr1XQYXmZQS+OboIXwUGMxYKj3B8fx/lLXRhWyAJO2Q7sgl6CSJm1s0aOXjtaG\nRkY2N/k6fVidnWeqAvNO0QKeo3sgLfvR9TA2uw09PZmpUjGmpInhXTY9QYb04N5F\n2vaRz+1Xm09nZzkMdEDNNEd7QNhkoj8MyFQA0trM/aXCBfU5CTPY0ecoOwY2KG/c\nh9tZ8m0TWirijbHa4p6nnqs+KlmVbJSH4I1gtVq2YUCkCtuD0boOp9mDc344ukV3\nM43j+9QW5d/VJ7BLP96F+icgy7qKV508qoo/VFr8fDE0Q+9EwMg=\n=0a9f\n-----END PGP SIGNATURE-----", "payload": "tree f309692327bed4afc46e68f5d381defb91e6da7d\nparent a6b72d378f71ed8d2c6849d97571a4c1d8e27afa\nauthor Philipp Hansch <dev@phansch.net> 1609860668 +0100\ncommitter Philipp Hansch <dev@phansch.net> 1609860668 +0100\n\nUse existing 'is_automatically_derived' helper\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a8825e9af067e10406e13ff7fbe9bbd5c7699a41", "html_url": "https://github.com/rust-lang/rust/commit/a8825e9af067e10406e13ff7fbe9bbd5c7699a41", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a8825e9af067e10406e13ff7fbe9bbd5c7699a41/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a6b72d378f71ed8d2c6849d97571a4c1d8e27afa", "url": "https://api.github.com/repos/rust-lang/rust/commits/a6b72d378f71ed8d2c6849d97571a4c1d8e27afa", "html_url": "https://github.com/rust-lang/rust/commit/a6b72d378f71ed8d2c6849d97571a4c1d8e27afa"}], "stats": {"total": 5, "additions": 2, "deletions": 3}, "files": [{"sha": "f1c06692e30d9efcff0840b66e40283a13dbc9ae", "filename": "clippy_lints/src/needless_borrow.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/a8825e9af067e10406e13ff7fbe9bbd5c7699a41/clippy_lints%2Fsrc%2Fneedless_borrow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8825e9af067e10406e13ff7fbe9bbd5c7699a41/clippy_lints%2Fsrc%2Fneedless_borrow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fneedless_borrow.rs?ref=a8825e9af067e10406e13ff7fbe9bbd5c7699a41", "patch": "@@ -2,15 +2,14 @@\n //!\n //! This lint is **warn** by default\n \n-use crate::utils::{snippet_opt, span_lint_and_then};\n+use crate::utils::{is_automatically_derived, snippet_opt, span_lint_and_then};\n use if_chain::if_chain;\n use rustc_errors::Applicability;\n use rustc_hir::{BindingAnnotation, BorrowKind, Expr, ExprKind, HirId, Item, Mutability, Pat, PatKind};\n use rustc_lint::{LateContext, LateLintPass};\n use rustc_middle::ty;\n use rustc_middle::ty::adjustment::{Adjust, Adjustment};\n use rustc_session::{declare_tool_lint, impl_lint_pass};\n-use rustc_span::sym;\n \n declare_clippy_lint! {\n     /// **What it does:** Checks for address of operations (`&`) that are going to\n@@ -116,7 +115,7 @@ impl<'tcx> LateLintPass<'tcx> for NeedlessBorrow {\n     }\n \n     fn check_item(&mut self, _: &LateContext<'tcx>, item: &'tcx Item<'_>) {\n-        if item.attrs.iter().any(|a| a.has_name(sym::automatically_derived)) {\n+        if is_automatically_derived(item.attrs) {\n             debug_assert!(self.derived_item.is_none());\n             self.derived_item = Some(item.hir_id);\n         }"}]}