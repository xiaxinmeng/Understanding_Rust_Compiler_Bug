{"sha": "b18d2882f4f05078abfcf0595d08c226860de6c3", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIxOGQyODgyZjRmMDUwNzhhYmZjZjA1OTVkMDhjMjI2ODYwZGU2YzM=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-08-11T06:55:32Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-08-11T06:55:32Z"}, "message": "Generate accessors", "tree": {"sha": "247e87f3f8e03cec063d29dd6223e7727dadadb4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/247e87f3f8e03cec063d29dd6223e7727dadadb4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b18d2882f4f05078abfcf0595d08c226860de6c3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b18d2882f4f05078abfcf0595d08c226860de6c3", "html_url": "https://github.com/rust-lang/rust/commit/b18d2882f4f05078abfcf0595d08c226860de6c3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b18d2882f4f05078abfcf0595d08c226860de6c3/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7581984601b35c113c4bcdf0f8b402b2635be0dc", "url": "https://api.github.com/repos/rust-lang/rust/commits/7581984601b35c113c4bcdf0f8b402b2635be0dc", "html_url": "https://github.com/rust-lang/rust/commit/7581984601b35c113c4bcdf0f8b402b2635be0dc"}], "stats": {"total": 62, "additions": 42, "deletions": 20}, "files": [{"sha": "0767df334eb502b355056a9de82010b1fa382c24", "filename": "crates/libsyntax2/src/ast/generated.rs", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/b18d2882f4f05078abfcf0595d08c226860de6c3/crates%2Flibsyntax2%2Fsrc%2Fast%2Fgenerated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b18d2882f4f05078abfcf0595d08c226860de6c3/crates%2Flibsyntax2%2Fsrc%2Fast%2Fgenerated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Flibsyntax2%2Fsrc%2Fast%2Fgenerated.rs?ref=b18d2882f4f05078abfcf0595d08c226860de6c3", "patch": "@@ -20,6 +20,14 @@ impl<R: TreeRoot> AstNode<R> for File<R> {\n     fn syntax(&self) -> &SyntaxNode<R> { &self.syntax }\n }\n \n+impl<R: TreeRoot> File<R> {\n+    pub fn functions<'a>(&'a self) -> impl Iterator<Item = Function<R>> + 'a {\n+        self.syntax()\n+            .children()\n+            .filter_map(Function::cast)\n+    }\n+}\n+\n \n #[derive(Debug, Clone, Copy)]\n pub struct Function<R: TreeRoot = Arc<SyntaxRoot>> {\n@@ -36,6 +44,15 @@ impl<R: TreeRoot> AstNode<R> for Function<R> {\n     fn syntax(&self) -> &SyntaxNode<R> { &self.syntax }\n }\n \n+impl<R: TreeRoot> Function<R> {\n+    pub fn name(&self) -> Option<Name<R>> {\n+        self.syntax()\n+            .children()\n+            .filter_map(Name::cast)\n+            .next()\n+    }\n+}\n+\n \n #[derive(Debug, Clone, Copy)]\n pub struct Name<R: TreeRoot = Arc<SyntaxRoot>> {\n@@ -52,3 +69,5 @@ impl<R: TreeRoot> AstNode<R> for Name<R> {\n     fn syntax(&self) -> &SyntaxNode<R> { &self.syntax }\n }\n \n+impl<R: TreeRoot> Name<R> {}\n+"}, {"sha": "86de7bce8716e7fde0d57af513bfaa4ba39e75f6", "filename": "crates/libsyntax2/src/ast/generated.rs.tera", "status": "modified", "additions": 21, "deletions": 5, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/b18d2882f4f05078abfcf0595d08c226860de6c3/crates%2Flibsyntax2%2Fsrc%2Fast%2Fgenerated.rs.tera", "raw_url": "https://github.com/rust-lang/rust/raw/b18d2882f4f05078abfcf0595d08c226860de6c3/crates%2Flibsyntax2%2Fsrc%2Fast%2Fgenerated.rs.tera", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Flibsyntax2%2Fsrc%2Fast%2Fgenerated.rs.tera?ref=b18d2882f4f05078abfcf0595d08c226860de6c3", "patch": "@@ -21,13 +21,29 @@ impl<R: TreeRoot> AstNode<R> for {{ Name }}<R> {\n }\n \n impl<R: TreeRoot> {{ Name }}<R> {\n-{% for (method_name, kind) in node.opts %}\n-{% set ChildName = kind | camel  %}\n-    pub fn {{ method_name }}<'a>(&'a self) -> impl Iterator<Item = {{ ChildKind }}<R>> + 'a {\n+{%- if node.collections -%}\n+{%- for m in node.collections -%}\n+{%- set method_name = m.0 -%}\n+{%- set ChildName = m.1 | camel %}\n+    pub fn {{ method_name }}<'a>(&'a self) -> impl Iterator<Item = {{ ChildName }}<R>> + 'a {\n         self.syntax()\n             .children()\n-            .filter_map({{ ChildKind }}::cast)\n+            .filter_map({{ ChildName }}::cast)\n     }\n-{% endfor %}\n+{% endfor -%}\n+{%- endif -%}\n+\n+{%- if node.options -%}\n+{%- for m in node.options -%}\n+{%- set method_name = m.0 -%}\n+{%- set ChildName = m.1 | camel %}\n+    pub fn {{ method_name }}(&self) -> Option<{{ ChildName }}<R>> {\n+        self.syntax()\n+            .children()\n+            .filter_map({{ ChildName }}::cast)\n+            .next()\n+    }\n+{% endfor -%}\n+{%- endif -%}\n }\n {% endfor %}"}, {"sha": "7d3cdb93db587f61c27b40eff7530f467a5d3fb9", "filename": "crates/libsyntax2/src/ast/mod.rs", "status": "modified", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/b18d2882f4f05078abfcf0595d08c226860de6c3/crates%2Flibsyntax2%2Fsrc%2Fast%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b18d2882f4f05078abfcf0595d08c226860de6c3/crates%2Flibsyntax2%2Fsrc%2Fast%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Flibsyntax2%2Fsrc%2Fast%2Fmod.rs?ref=b18d2882f4f05078abfcf0595d08c226860de6c3", "patch": "@@ -22,22 +22,9 @@ impl<R: TreeRoot> File<R> {\n     pub fn errors(&self) -> Vec<SyntaxError> {\n         self.syntax().root.errors.clone()\n     }\n-\n-    pub fn functions<'a>(&'a self) -> impl Iterator<Item = Function<R>> + 'a {\n-        self.syntax()\n-            .children()\n-            .filter_map(Function::cast)\n-    }\n }\n \n impl<R: TreeRoot> Function<R> {\n-    pub fn name(&self) -> Option<Name<R>> {\n-        self.syntax()\n-            .children()\n-            .filter_map(Name::cast)\n-            .next()\n-    }\n-\n     pub fn has_atom_attr(&self, atom: &str) -> bool {\n         self.syntax()\n             .children()"}, {"sha": "22c61e9491037a4b2b420168ba4ba58617d3d672", "filename": "crates/libsyntax2/src/grammar.ron", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b18d2882f4f05078abfcf0595d08c226860de6c3/crates%2Flibsyntax2%2Fsrc%2Fgrammar.ron", "raw_url": "https://github.com/rust-lang/rust/raw/b18d2882f4f05078abfcf0595d08c226860de6c3/crates%2Flibsyntax2%2Fsrc%2Fgrammar.ron", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Flibsyntax2%2Fsrc%2Fgrammar.ron?ref=b18d2882f4f05078abfcf0595d08c226860de6c3", "patch": "@@ -217,13 +217,13 @@ Grammar(\n         (\n             kind: \"FILE\",\n             collections: [\n-                (\"functions\", \"FUNCTION\")\n+                [\"functions\", \"FUNCTION\"]\n             ]\n         ),\n         (\n             kind: \"FUNCTION\",\n             options: [\n-                (\"name\", \"NAME\")\n+                [\"name\", \"NAME\"]\n             ]\n         ),\n         ("}]}