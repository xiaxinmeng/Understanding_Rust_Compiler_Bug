{"sha": "a5043a81be1b6288e96b8320cf69f397e4be7159", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE1MDQzYTgxYmUxYjYyODhlOTZiODMyMGNmNjlmMzk3ZTRiZTcxNTk=", "commit": {"author": {"name": "St\u00e9phane Campinas", "email": "stephane.campinas@gmail.com", "date": "2018-11-07T15:48:39Z"}, "committer": {"name": "St\u00e9phane Campinas", "email": "stephane.campinas@gmail.com", "date": "2018-11-07T15:48:39Z"}, "message": "do not wrap comments in doctest to avoid failing doctest runs", "tree": {"sha": "733dd508775bbe80f00b2ef80e1bd9d667e9207f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/733dd508775bbe80f00b2ef80e1bd9d667e9207f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a5043a81be1b6288e96b8320cf69f397e4be7159", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCgAdFiEEipi5pnt+pUplKNfibVYg2QghATMFAlvjCVcACgkQbVYg2Qgh\nATMOSAgAh2uNVveuVa1lp1ctDAD5owBFlUWFROeNcjBcrAX5MDQIDjYXtMHEjKw6\npDQBwqTNOFmybi8WeVtkWLJy51TMjQ7tRPm/Tu9ruNmiq4u4mtp9gQ864x3jPL74\nubTlC9oDvk8LE2a4LkzbKiFCbozNyzbZJdW12wD4iVv+W3P+fsJpuS+0fJ2zJwol\nq/wSQ8piopifkYNzcra5ULJ5R5yRLIvMW2YGvIHq75dkMirnFvWux6W5rYxd+PoI\nEh8Bf0zEAdtkp8rG6sdLik+ZsIK6iip5OyY2Rz06cUH2yfAR15Ik8suwrKmaxIZE\nuXdnuQHBUsLszglTYGX5Bss41U/yOg==\n=XZJd\n-----END PGP SIGNATURE-----", "payload": "tree 733dd508775bbe80f00b2ef80e1bd9d667e9207f\nparent cd8bb50aea35f73fa4be62857dfed88f772cd07e\nauthor St\u00e9phane Campinas <stephane.campinas@gmail.com> 1541605719 +0100\ncommitter St\u00e9phane Campinas <stephane.campinas@gmail.com> 1541605719 +0100\n\ndo not wrap comments in doctest to avoid failing doctest runs\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a5043a81be1b6288e96b8320cf69f397e4be7159", "html_url": "https://github.com/rust-lang/rust/commit/a5043a81be1b6288e96b8320cf69f397e4be7159", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a5043a81be1b6288e96b8320cf69f397e4be7159/comments", "author": {"login": "scampi", "id": 795879, "node_id": "MDQ6VXNlcjc5NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/795879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scampi", "html_url": "https://github.com/scampi", "followers_url": "https://api.github.com/users/scampi/followers", "following_url": "https://api.github.com/users/scampi/following{/other_user}", "gists_url": "https://api.github.com/users/scampi/gists{/gist_id}", "starred_url": "https://api.github.com/users/scampi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scampi/subscriptions", "organizations_url": "https://api.github.com/users/scampi/orgs", "repos_url": "https://api.github.com/users/scampi/repos", "events_url": "https://api.github.com/users/scampi/events{/privacy}", "received_events_url": "https://api.github.com/users/scampi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "scampi", "id": 795879, "node_id": "MDQ6VXNlcjc5NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/795879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scampi", "html_url": "https://github.com/scampi", "followers_url": "https://api.github.com/users/scampi/followers", "following_url": "https://api.github.com/users/scampi/following{/other_user}", "gists_url": "https://api.github.com/users/scampi/gists{/gist_id}", "starred_url": "https://api.github.com/users/scampi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scampi/subscriptions", "organizations_url": "https://api.github.com/users/scampi/orgs", "repos_url": "https://api.github.com/users/scampi/repos", "events_url": "https://api.github.com/users/scampi/events{/privacy}", "received_events_url": "https://api.github.com/users/scampi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cd8bb50aea35f73fa4be62857dfed88f772cd07e", "url": "https://api.github.com/repos/rust-lang/rust/commits/cd8bb50aea35f73fa4be62857dfed88f772cd07e", "html_url": "https://github.com/rust-lang/rust/commit/cd8bb50aea35f73fa4be62857dfed88f772cd07e"}], "stats": {"total": 26, "additions": 3, "deletions": 23}, "files": [{"sha": "8b2a4eefa9ac0e111e1e087581f34f0cdad3a04b", "filename": "src/comment.rs", "status": "modified", "additions": 3, "deletions": 10, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/a5043a81be1b6288e96b8320cf69f397e4be7159/src%2Fcomment.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a5043a81be1b6288e96b8320cf69f397e4be7159/src%2Fcomment.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomment.rs?ref=a5043a81be1b6288e96b8320cf69f397e4be7159", "patch": "@@ -618,7 +618,7 @@ impl<'a> CommentRewrite<'a> {\n                     _ if self.code_block_buffer.is_empty() => String::new(),\n                     _ => {\n                         let mut config = self.fmt.config.clone();\n-                        config.set().format_doc_comments(false);\n+                        config.set().wrap_comments(false);\n                         match ::format_code_block(&self.code_block_buffer, &config) {\n                             Some(ref s) => trim_custom_comment_prefix(&s.snippet),\n                             None => trim_custom_comment_prefix(&self.code_block_buffer),\n@@ -790,16 +790,9 @@ fn trim_custom_comment_prefix(s: &str) -> String {\n         .map(|line| {\n             let left_trimmed = line.trim_left();\n             if left_trimmed.starts_with(RUSTFMT_CUSTOM_COMMENT_PREFIX) {\n-                let orig = left_trimmed.trim_left_matches(RUSTFMT_CUSTOM_COMMENT_PREFIX);\n-                // due to comment wrapping, a line that was originally behind `#` is split over\n-                // multiple lines, which needs then to be prefixed with a `#`\n-                if !orig.trim_left().starts_with(\"# \") {\n-                    Cow::from(format!(\"# {}\", orig))\n-                } else {\n-                    Cow::from(orig)\n-                }\n+                left_trimmed.trim_left_matches(RUSTFMT_CUSTOM_COMMENT_PREFIX)\n             } else {\n-                Cow::from(line)\n+                line\n             }\n         })\n         .collect::<Vec<_>>()"}, {"sha": "d8de8443812e4d81f977e8716f4d5589a0ea4e82", "filename": "tests/target/issue-3182.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/a5043a81be1b6288e96b8320cf69f397e4be7159/tests%2Ftarget%2Fissue-3182.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a5043a81be1b6288e96b8320cf69f397e4be7159/tests%2Ftarget%2Fissue-3182.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-3182.rs?ref=a5043a81be1b6288e96b8320cf69f397e4be7159", "previous_filename": "tests/source/wrapped_hidden_code_block.rs"}, {"sha": "572f448c4e7ce3cd96a03557048a71db259a3bfd", "filename": "tests/target/wrapped_hidden_code_block.rs", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/cd8bb50aea35f73fa4be62857dfed88f772cd07e/tests%2Ftarget%2Fwrapped_hidden_code_block.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cd8bb50aea35f73fa4be62857dfed88f772cd07e/tests%2Ftarget%2Fwrapped_hidden_code_block.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fwrapped_hidden_code_block.rs?ref=cd8bb50aea35f73fa4be62857dfed88f772cd07e", "patch": "@@ -1,13 +0,0 @@\n-// rustfmt-max_width: 79\n-// rustfmt-wrap_comments: true\n-\n-/// ```rust\n-/// # #![cfg_attr(not(dox), feature(cfg_target_feature, target_feature,\n-/// # stdsimd)not(dox), feature(cfg_target_feature, target_feature,\n-/// # stdsimd))]\n-///\n-/// // Est lectus hendrerit lorem, eget dignissim orci nisl sit amet massa.\n-/// // Etiam volutpat lobortis eros.\n-/// let x = 42;\n-/// ```\n-fn func() {}"}]}