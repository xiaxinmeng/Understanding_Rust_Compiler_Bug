{"sha": "5557907098d0c9269d6d6643ead23d9877ee63ab", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU1NTc5MDcwOThkMGM5MjY5ZDZkNjY0M2VhZDIzZDk4NzdlZTYzYWI=", "commit": {"author": {"name": "miguel raz", "email": "miguelraz@gmail.com", "date": "2021-06-01T20:25:56Z"}, "committer": {"name": "miguel raz", "email": "miguelraz@gmail.com", "date": "2021-06-01T20:25:56Z"}, "message": "rewrite unaligned slice, fix output const array", "tree": {"sha": "54a69676ded6a7ea3a0678be025c4936755b346c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/54a69676ded6a7ea3a0678be025c4936755b346c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5557907098d0c9269d6d6643ead23d9877ee63ab", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5557907098d0c9269d6d6643ead23d9877ee63ab", "html_url": "https://github.com/rust-lang/rust/commit/5557907098d0c9269d6d6643ead23d9877ee63ab", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5557907098d0c9269d6d6643ead23d9877ee63ab/comments", "author": {"login": "miguelraz", "id": 13056181, "node_id": "MDQ6VXNlcjEzMDU2MTgx", "avatar_url": "https://avatars.githubusercontent.com/u/13056181?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miguelraz", "html_url": "https://github.com/miguelraz", "followers_url": "https://api.github.com/users/miguelraz/followers", "following_url": "https://api.github.com/users/miguelraz/following{/other_user}", "gists_url": "https://api.github.com/users/miguelraz/gists{/gist_id}", "starred_url": "https://api.github.com/users/miguelraz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miguelraz/subscriptions", "organizations_url": "https://api.github.com/users/miguelraz/orgs", "repos_url": "https://api.github.com/users/miguelraz/repos", "events_url": "https://api.github.com/users/miguelraz/events{/privacy}", "received_events_url": "https://api.github.com/users/miguelraz/received_events", "type": "User", "site_admin": false}, "committer": {"login": "miguelraz", "id": 13056181, "node_id": "MDQ6VXNlcjEzMDU2MTgx", "avatar_url": "https://avatars.githubusercontent.com/u/13056181?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miguelraz", "html_url": "https://github.com/miguelraz", "followers_url": "https://api.github.com/users/miguelraz/followers", "following_url": "https://api.github.com/users/miguelraz/following{/other_user}", "gists_url": "https://api.github.com/users/miguelraz/gists{/gist_id}", "starred_url": "https://api.github.com/users/miguelraz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miguelraz/subscriptions", "organizations_url": "https://api.github.com/users/miguelraz/orgs", "repos_url": "https://api.github.com/users/miguelraz/repos", "events_url": "https://api.github.com/users/miguelraz/events{/privacy}", "received_events_url": "https://api.github.com/users/miguelraz/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f24110aa5b59ecbaf457f73b3a3b1560b416322d", "url": "https://api.github.com/repos/rust-lang/rust/commits/f24110aa5b59ecbaf457f73b3a3b1560b416322d", "html_url": "https://github.com/rust-lang/rust/commit/f24110aa5b59ecbaf457f73b3a3b1560b416322d"}], "stats": {"total": 14, "additions": 12, "deletions": 2}, "files": [{"sha": "4fdc02263976c56711d40e62ae042e855a3e84e5", "filename": "crates/core_simd/examples/nbody.rs", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/5557907098d0c9269d6d6643ead23d9877ee63ab/crates%2Fcore_simd%2Fexamples%2Fnbody.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5557907098d0c9269d6d6643ead23d9877ee63ab/crates%2Fcore_simd%2Fexamples%2Fnbody.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcore_simd%2Fexamples%2Fnbody.rs?ref=5557907098d0c9269d6d6643ead23d9877ee63ab", "patch": "@@ -128,7 +128,9 @@ pub fn advance(bodies: &mut [Body; N_BODIES], dt: f64) {\n     while i < N {\n         let d2s = f64x2::from_array([(r[i] * r[i]).horizontal_sum(), (r[i + 1] * r[i + 1]).horizontal_sum()]);\n         let dmags = f64x2::splat(dt) / (d2s * d2s.sqrt());\n-        dmags.write_to_slice_unaligned(&mut mag[i..]);\n+        // dmags.write_to_slice_unaligned(&mut mag[i..]);\n+        mag[i] = dmags[0];\n+        mag[i+1] = dmags[1];\n         i += 2;\n     }\n \n@@ -146,6 +148,12 @@ pub fn advance(bodies: &mut [Body; N_BODIES], dt: f64) {\n     }\n }\n \n+// #[inline]\n+// pub unsafe fn write_to_slice_unaligned(slice: &mut SimdF64::<LANES>) {\n+//     let target_ptr = slice.get_unchecked_mut(0) as *mut f64x2;\n+//     *(target_ptr as *mut f64x2) = SimdF64;\n+// }\n+\n pub fn run(n: usize) -> (f64, f64) {\n     let mut bodies = BODIES;\n     offset_momentum(&mut bodies);\n@@ -158,7 +166,7 @@ pub fn run(n: usize) -> (f64, f64) {\n     (energy_before, energy_after)\n }\n \n-const OUTPUT: Vec<f64> = vec![-0.169075164, -0.169087605];\n+const OUTPUT: [f64; 2] = [-0.169075164, -0.169087605];\n #[cfg(test)]\n mod tests {\n     #[test]\n@@ -172,6 +180,8 @@ mod tests {\n         }\n     }\n }\n+\n+\n fn main() {\n     //let n: usize = std::env::args()\n     //.nth(1)"}]}