{"sha": "a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE5MTk5ZGUzNGQwYWQ3OGZlMWZmMGQwNzJmNmJkNWMwMTkwNmJkYjM=", "commit": {"author": {"name": "Stanislav Tkach", "email": "stanislav.tkach@gmail.com", "date": "2020-05-22T21:16:17Z"}, "committer": {"name": "Stanislav Tkach", "email": "stanislav.tkach@gmail.com", "date": "2020-05-22T21:16:17Z"}, "message": "Merge spans for the suggestion", "tree": {"sha": "23eeacfacb32962f88f2ebf212e7caa8a655d0bc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/23eeacfacb32962f88f2ebf212e7caa8a655d0bc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3", "html_url": "https://github.com/rust-lang/rust/commit/a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3/comments", "author": {"login": "stanislav-tkach", "id": 2997902, "node_id": "MDQ6VXNlcjI5OTc5MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/2997902?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stanislav-tkach", "html_url": "https://github.com/stanislav-tkach", "followers_url": "https://api.github.com/users/stanislav-tkach/followers", "following_url": "https://api.github.com/users/stanislav-tkach/following{/other_user}", "gists_url": "https://api.github.com/users/stanislav-tkach/gists{/gist_id}", "starred_url": "https://api.github.com/users/stanislav-tkach/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stanislav-tkach/subscriptions", "organizations_url": "https://api.github.com/users/stanislav-tkach/orgs", "repos_url": "https://api.github.com/users/stanislav-tkach/repos", "events_url": "https://api.github.com/users/stanislav-tkach/events{/privacy}", "received_events_url": "https://api.github.com/users/stanislav-tkach/received_events", "type": "User", "site_admin": false}, "committer": {"login": "stanislav-tkach", "id": 2997902, "node_id": "MDQ6VXNlcjI5OTc5MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/2997902?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stanislav-tkach", "html_url": "https://github.com/stanislav-tkach", "followers_url": "https://api.github.com/users/stanislav-tkach/followers", "following_url": "https://api.github.com/users/stanislav-tkach/following{/other_user}", "gists_url": "https://api.github.com/users/stanislav-tkach/gists{/gist_id}", "starred_url": "https://api.github.com/users/stanislav-tkach/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stanislav-tkach/subscriptions", "organizations_url": "https://api.github.com/users/stanislav-tkach/orgs", "repos_url": "https://api.github.com/users/stanislav-tkach/repos", "events_url": "https://api.github.com/users/stanislav-tkach/events{/privacy}", "received_events_url": "https://api.github.com/users/stanislav-tkach/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "34b51187ce8fa261ebe3bef4a9a26135b919ac02", "url": "https://api.github.com/repos/rust-lang/rust/commits/34b51187ce8fa261ebe3bef4a9a26135b919ac02", "html_url": "https://github.com/rust-lang/rust/commit/34b51187ce8fa261ebe3bef4a9a26135b919ac02"}], "stats": {"total": 43, "additions": 24, "deletions": 19}, "files": [{"sha": "a32174a83337df933c44ece6883b87c9b4eb033b", "filename": "src/librustc_typeck/check/callee.rs", "status": "modified", "additions": 11, "deletions": 6, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3/src%2Flibrustc_typeck%2Fcheck%2Fcallee.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3/src%2Flibrustc_typeck%2Fcheck%2Fcallee.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fcallee.rs?ref=a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3", "patch": "@@ -35,13 +35,18 @@ pub fn check_legal_trait_for_method_call(\n             .and_then(|s| tcx.sess.source_map().span_to_snippet(s).ok())\n             .unwrap_or_default();\n \n-        let (suggestion, applicability) = if snippet.is_empty() {\n-            (snippet, Applicability::Unspecified)\n-        } else {\n-            (format!(\"drop({})\", snippet), Applicability::MachineApplicable)\n-        };\n+        let suggestion =\n+            if snippet.is_empty() { \"drop\".to_string() } else { format!(\"drop({})\", snippet) };\n+\n+        let suggestion_span =\n+            receiver.and_then(|s| tcx.sess.source_map().merge_spans(s, span)).unwrap_or(span);\n \n-        err.span_suggestion(span, \"consider using `drop` function\", suggestion, applicability);\n+        err.span_suggestion(\n+            suggestion_span,\n+            \"consider using `drop` function\",\n+            suggestion,\n+            Applicability::MaybeIncorrect,\n+        );\n \n         err.emit();\n     }"}, {"sha": "3b864d4ea4b2c4574f956939c1857e152eb33806", "filename": "src/test/ui/error-codes/E0040.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3/src%2Ftest%2Fui%2Ferror-codes%2FE0040.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3/src%2Ftest%2Fui%2Ferror-codes%2FE0040.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0040.stderr?ref=a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3", "patch": "@@ -2,10 +2,10 @@ error[E0040]: explicit use of destructor method\n   --> $DIR/E0040.rs:13:7\n    |\n LL |     x.drop();\n-   |       ^^^^\n-   |       |\n-   |       explicit destructor calls not allowed\n-   |       help: consider using `drop` function: `drop(x)`\n+   |     --^^^^\n+   |     | |\n+   |     | explicit destructor calls not allowed\n+   |     help: consider using `drop` function: `drop(x)`\n \n error: aborting due to previous error\n "}, {"sha": "33ce235b30fdae3ea9c90d65675046dfb8f45350", "filename": "src/test/ui/explicit/explicit-call-to-dtor.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3/src%2Ftest%2Fui%2Fexplicit%2Fexplicit-call-to-dtor.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3/src%2Ftest%2Fui%2Fexplicit%2Fexplicit-call-to-dtor.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fexplicit%2Fexplicit-call-to-dtor.stderr?ref=a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3", "patch": "@@ -2,10 +2,10 @@ error[E0040]: explicit use of destructor method\n   --> $DIR/explicit-call-to-dtor.rs:13:7\n    |\n LL |     x.drop();\n-   |       ^^^^\n-   |       |\n-   |       explicit destructor calls not allowed\n-   |       help: consider using `drop` function: `drop(x)`\n+   |     --^^^^\n+   |     | |\n+   |     | explicit destructor calls not allowed\n+   |     help: consider using `drop` function: `drop(x)`\n \n error: aborting due to previous error\n "}, {"sha": "2e7bfac71cd3274b5347affd598504ab70954526", "filename": "src/test/ui/explicit/explicit-call-to-supertrait-dtor.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3/src%2Ftest%2Fui%2Fexplicit%2Fexplicit-call-to-supertrait-dtor.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3/src%2Ftest%2Fui%2Fexplicit%2Fexplicit-call-to-supertrait-dtor.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fexplicit%2Fexplicit-call-to-supertrait-dtor.stderr?ref=a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3", "patch": "@@ -2,10 +2,10 @@ error[E0040]: explicit use of destructor method\n   --> $DIR/explicit-call-to-supertrait-dtor.rs:17:14\n    |\n LL |         self.drop();\n-   |              ^^^^\n-   |              |\n-   |              explicit destructor calls not allowed\n-   |              help: consider using `drop` function: `drop(self)`\n+   |         -----^^^^\n+   |         |    |\n+   |         |    explicit destructor calls not allowed\n+   |         help: consider using `drop` function: `drop(self)`\n \n error: aborting due to previous error\n "}, {"sha": "57c99739afd247f7e0c84ef7907a5043d8e1901e", "filename": "src/test/ui/illegal-ufcs-drop.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3/src%2Ftest%2Fui%2Fillegal-ufcs-drop.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3/src%2Ftest%2Fui%2Fillegal-ufcs-drop.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fillegal-ufcs-drop.stderr?ref=a9199de34d0ad78fe1ff0d072f6bd5c01906bdb3", "patch": "@@ -5,7 +5,7 @@ LL |     Drop::drop(&mut Foo)\n    |     ^^^^^^^^^^\n    |     |\n    |     explicit destructor calls not allowed\n-   |     help: consider using `drop` function\n+   |     help: consider using `drop` function: `drop`\n \n error: aborting due to previous error\n "}]}