{"sha": "39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM5YzkyYjM4NzI2YTRjYTBlMGU0ODE5OGNiZDViZGQ4MmJiZjJmYjU=", "commit": {"author": {"name": "Hannes De Valkeneer", "email": "hannes@de-valkeneer.be", "date": "2020-03-12T21:31:47Z"}, "committer": {"name": "Hannes De Valkeneer", "email": "hannes@de-valkeneer.be", "date": "2020-03-12T21:31:47Z"}, "message": "fixup! feat: add debug code lens\n\nautodetect vscode-lldb", "tree": {"sha": "7ed280f1150354957317b1c499f94289c4765cb0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7ed280f1150354957317b1c499f94289c4765cb0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5", "html_url": "https://github.com/rust-lang/rust/commit/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5/comments", "author": {"login": "hdevalke", "id": 2261239, "node_id": "MDQ6VXNlcjIyNjEyMzk=", "avatar_url": "https://avatars.githubusercontent.com/u/2261239?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hdevalke", "html_url": "https://github.com/hdevalke", "followers_url": "https://api.github.com/users/hdevalke/followers", "following_url": "https://api.github.com/users/hdevalke/following{/other_user}", "gists_url": "https://api.github.com/users/hdevalke/gists{/gist_id}", "starred_url": "https://api.github.com/users/hdevalke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hdevalke/subscriptions", "organizations_url": "https://api.github.com/users/hdevalke/orgs", "repos_url": "https://api.github.com/users/hdevalke/repos", "events_url": "https://api.github.com/users/hdevalke/events{/privacy}", "received_events_url": "https://api.github.com/users/hdevalke/received_events", "type": "User", "site_admin": false}, "committer": {"login": "hdevalke", "id": 2261239, "node_id": "MDQ6VXNlcjIyNjEyMzk=", "avatar_url": "https://avatars.githubusercontent.com/u/2261239?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hdevalke", "html_url": "https://github.com/hdevalke", "followers_url": "https://api.github.com/users/hdevalke/followers", "following_url": "https://api.github.com/users/hdevalke/following{/other_user}", "gists_url": "https://api.github.com/users/hdevalke/gists{/gist_id}", "starred_url": "https://api.github.com/users/hdevalke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hdevalke/subscriptions", "organizations_url": "https://api.github.com/users/hdevalke/orgs", "repos_url": "https://api.github.com/users/hdevalke/repos", "events_url": "https://api.github.com/users/hdevalke/events{/privacy}", "received_events_url": "https://api.github.com/users/hdevalke/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e9d025b618aaa1a5a06e60c17392a18f12471217", "url": "https://api.github.com/repos/rust-lang/rust/commits/e9d025b618aaa1a5a06e60c17392a18f12471217", "html_url": "https://github.com/rust-lang/rust/commit/e9d025b618aaa1a5a06e60c17392a18f12471217"}], "stats": {"total": 45, "additions": 26, "deletions": 19}, "files": [{"sha": "cfca06f569cd60e3d23a15d0564515608302c1b1", "filename": "crates/rust-analyzer/src/config.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs?ref=39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5", "patch": "@@ -51,6 +51,9 @@ pub struct ServerConfig {\n \n     /// Cargo feature configurations.\n     pub cargo_features: CargoFeatures,\n+\n+    /// Enabled if the vscode_lldb extension is available.\n+    pub vscode_lldb: bool,\n }\n \n impl Default for ServerConfig {\n@@ -70,6 +73,7 @@ impl Default for ServerConfig {\n             additional_out_dirs: FxHashMap::default(),\n             cargo_features: Default::default(),\n             rustfmt_args: Vec::new(),\n+            vscode_lldb: false,\n         }\n     }\n }"}, {"sha": "b4add046f0a4f2f87e74335dafdb1bc130203011", "filename": "crates/rust-analyzer/src/main_loop.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5/crates%2Frust-analyzer%2Fsrc%2Fmain_loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5/crates%2Frust-analyzer%2Fsrc%2Fmain_loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fmain_loop.rs?ref=39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5", "patch": "@@ -185,6 +185,7 @@ pub fn main_loop(\n                     all_targets: config.cargo_watch_all_targets,\n                 },\n                 rustfmt_args: config.rustfmt_args,\n+                vscode_lldb: config.vscode_lldb,\n             }\n         };\n "}, {"sha": "571a896f30d06f4fc66f9d3519d152431a30d83f", "filename": "crates/rust-analyzer/src/main_loop/handlers.rs", "status": "modified", "additions": 18, "deletions": 16, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5/crates%2Frust-analyzer%2Fsrc%2Fmain_loop%2Fhandlers.rs", "raw_url": "https://github.com/rust-lang/rust/raw/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5/crates%2Frust-analyzer%2Fsrc%2Fmain_loop%2Fhandlers.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fmain_loop%2Fhandlers.rs?ref=39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5", "patch": "@@ -805,23 +805,25 @@ pub fn handle_code_lens(\n             }),\n             data: None,\n         };\n-        if r.args[0] == \"run\" {\n-            r.args[0] = \"build\".into();\n-        } else {\n-            r.args.push(\"--no-run\".into());\n-        }\n-        let debug_lens = CodeLens {\n-            range: r.range,\n-            command: Some(Command {\n-                title: \"Debug\".into(),\n-                command: \"rust-analyzer.debugSingle\".into(),\n-                arguments: Some(vec![to_value(r).unwrap()]),\n-            }),\n-            data: None,\n-        };\n-\n         lenses.push(lens);\n-        lenses.push(debug_lens);\n+\n+        if world.options.vscode_lldb {\n+            if r.args[0] == \"run\" {\n+                r.args[0] = \"build\".into();\n+            } else {\n+                r.args.push(\"--no-run\".into());\n+            }\n+            let debug_lens = CodeLens {\n+                range: r.range,\n+                command: Some(Command {\n+                    title: \"Debug\".into(),\n+                    command: \"rust-analyzer.debugSingle\".into(),\n+                    arguments: Some(vec![to_value(r).unwrap()]),\n+                }),\n+                data: None,\n+            };\n+            lenses.push(debug_lens);\n+        }\n     }\n \n     // Handle impls"}, {"sha": "a4fda9f80673347364c9e0a2f3fd4a2c14ace49f", "filename": "crates/rust-analyzer/src/world.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5/crates%2Frust-analyzer%2Fsrc%2Fworld.rs", "raw_url": "https://github.com/rust-lang/rust/raw/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5/crates%2Frust-analyzer%2Fsrc%2Fworld.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fworld.rs?ref=39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5", "patch": "@@ -37,6 +37,7 @@ pub struct Options {\n     pub max_inlay_hint_length: Option<usize>,\n     pub rustfmt_args: Vec<String>,\n     pub cargo_watch: CheckOptions,\n+    pub vscode_lldb: bool,\n }\n \n /// `WorldState` is the primary mutable state of the language server"}, {"sha": "1fe8e9f8ae3173b0712eac3e1c7b4c300b8767e3", "filename": "editors/code/package.json", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5/editors%2Fcode%2Fpackage.json", "raw_url": "https://github.com/rust-lang/rust/raw/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5/editors%2Fcode%2Fpackage.json", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fpackage.json?ref=39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5", "patch": "@@ -51,9 +51,6 @@\n         \"typescript-formatter\": \"^7.2.2\",\n         \"vsce\": \"^1.74.0\"\n     },\n-    \"extensionDependencies\": [\n-        \"vadimcn.vscode-lldb\"\n-    ],\n     \"activationEvents\": [\n         \"onLanguage:rust\",\n         \"onCommand:rust-analyzer.analyzerStatus\","}, {"sha": "99c9c5ae702de10e25d9c23472347174ead80fbe", "filename": "editors/code/src/client.ts", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5/editors%2Fcode%2Fsrc%2Fclient.ts", "raw_url": "https://github.com/rust-lang/rust/raw/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5/editors%2Fcode%2Fsrc%2Fclient.ts", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fsrc%2Fclient.ts?ref=39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5", "patch": "@@ -41,6 +41,7 @@ export async function createClient(config: Config, serverPath: string): Promise<\n             withSysroot: config.withSysroot,\n             cargoFeatures: config.cargoFeatures,\n             rustfmtArgs: config.rustfmtArgs,\n+            vscodeLldb: vscode.extensions.getExtension(\"vadimcn.vscode-lldb\") != null,\n         },\n         traceOutputChannel,\n         middleware: {"}, {"sha": "40f4c7a0d6d37cd24db2dc774dd42435e49dcfd4", "filename": "editors/code/src/config.ts", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5/editors%2Fcode%2Fsrc%2Fconfig.ts", "raw_url": "https://github.com/rust-lang/rust/raw/39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5/editors%2Fcode%2Fsrc%2Fconfig.ts", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fsrc%2Fconfig.ts?ref=39c92b38726a4ca0e0e48198cbd5bdd82bbf2fb5", "patch": "@@ -156,6 +156,7 @@ export class Config {\n     get featureFlags() { return this.cfg.get(\"featureFlags\") as Record<string, boolean>; }\n     get additionalOutDirs() { return this.cfg.get(\"additionalOutDirs\") as Record<string, string>; }\n     get rustfmtArgs() { return this.cfg.get(\"rustfmtArgs\") as string[]; }\n+    get vscodeLldb() { return this.cfg.get(\"vscodeLldb\") as boolean; }\n \n     get cargoWatchOptions(): CargoWatchOptions {\n         return {"}]}