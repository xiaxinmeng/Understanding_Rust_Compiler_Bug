{"sha": "5dc779ba52132b1fc68a9496744722b19eedb02b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVkYzc3OWJhNTIxMzJiMWZjNjhhOTQ5Njc0NDcyMmIxOWVlZGIwMmI=", "commit": {"author": {"name": "Jonathan Turner", "email": "jonathandturner@users.noreply.github.com", "date": "2016-08-31T20:53:34Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2016-08-31T20:53:34Z"}, "message": "Rollup merge of #36114 - zjhmale:fix-E0393, r=jonathandturner\n\nUpdate E0393 to new error format\n\nFixes #35632.\nPart of #35233.\n\nr? @jonathandturner\n\nand a wired thing is that if i add another label\n\n```rust\n.span_label(span, &format!(\"missing reference to `{}`\", def.name))\n.span_label(span, &format!(\"because of the default `Self` reference, type parameters must be specified on object types\"))\n```\n\nand add a new note in the test case like\n\n```rust\ntrait A<T=Self> {}\n\nfn together_we_will_rule_the_galaxy(son: &A) {}\n//~^ ERROR E0393\n//~| NOTE missing reference to `T`\n//~| NOTE because of the default `Self` reference, type parameters must be specified on object types\n```\n\nit will complain that\n\n```\nrunning 1 test\ntest [compile-fail] compile-fail/E0393.rs ... FAILED\n\nfailures:\n\n---- [compile-fail] compile-fail/E0393.rs stdout ----\n\nerror: /Users/zjh/Documents/rustspace/rust/src/test/compile-fail/E0393.rs:13: unexpected \"error\": '13:43: 13:44: the type parameter `T` must be explicitly specified [E0393]'\n\nunexpected errors (from JSON output): [\n    Error {\n        line_num: 13,\n        kind: Some(\n            Error\n        ),\n        msg: \"13:43: 13:44: the type parameter `T` must be explicitly specified [E0393]\"\n    }\n]\n```\n\nit is a little bit confusing and through the blog post we can use `//~^` and `//~|` to support multiple notes, @jonathandturner am i missing something here?", "tree": {"sha": "2a80f578881758e8b93661efd48ce59a9980ac6c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2a80f578881758e8b93661efd48ce59a9980ac6c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5dc779ba52132b1fc68a9496744722b19eedb02b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5dc779ba52132b1fc68a9496744722b19eedb02b", "html_url": "https://github.com/rust-lang/rust/commit/5dc779ba52132b1fc68a9496744722b19eedb02b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5dc779ba52132b1fc68a9496744722b19eedb02b/comments", "author": {"login": "jonathandturner", "id": 111457284, "node_id": "O_kgDOBqS0BA", "avatar_url": "https://avatars.githubusercontent.com/u/111457284?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonathandturner", "html_url": "https://github.com/jonathandturner", "followers_url": "https://api.github.com/users/jonathandturner/followers", "following_url": "https://api.github.com/users/jonathandturner/following{/other_user}", "gists_url": "https://api.github.com/users/jonathandturner/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonathandturner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonathandturner/subscriptions", "organizations_url": "https://api.github.com/users/jonathandturner/orgs", "repos_url": "https://api.github.com/users/jonathandturner/repos", "events_url": "https://api.github.com/users/jonathandturner/events{/privacy}", "received_events_url": "https://api.github.com/users/jonathandturner/received_events", "type": "Organization", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bbb2d1d0aca98e68ad3ab6ab41767395191b8d4c", "url": "https://api.github.com/repos/rust-lang/rust/commits/bbb2d1d0aca98e68ad3ab6ab41767395191b8d4c", "html_url": "https://github.com/rust-lang/rust/commit/bbb2d1d0aca98e68ad3ab6ab41767395191b8d4c"}, {"sha": "189dee6da11c36bf074fc2e568d356a1bae46b91", "url": "https://api.github.com/repos/rust-lang/rust/commits/189dee6da11c36bf074fc2e568d356a1bae46b91", "html_url": "https://github.com/rust-lang/rust/commit/189dee6da11c36bf074fc2e568d356a1bae46b91"}], "stats": {"total": 39, "additions": 26, "deletions": 13}, "files": [{"sha": "e04bd581f4648d404fd1be3f06334e628515721d", "filename": "src/librustc_typeck/astconv.rs", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/5dc779ba52132b1fc68a9496744722b19eedb02b/src%2Flibrustc_typeck%2Fastconv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5dc779ba52132b1fc68a9496744722b19eedb02b/src%2Flibrustc_typeck%2Fastconv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fastconv.rs?ref=5dc779ba52132b1fc68a9496744722b19eedb02b", "patch": "@@ -515,12 +515,13 @@ impl<'o, 'gcx: 'tcx, 'tcx> AstConv<'gcx, 'tcx>+'o {\n                 // defaults. This will lead to an ICE if we are not\n                 // careful!\n                 if default_needs_object_self(def) {\n-                    span_err!(tcx.sess, span, E0393,\n-                              \"the type parameter `{}` must be explicitly specified \\\n-                               in an object type because its default value `{}` references \\\n-                               the type `Self`\",\n-                              def.name,\n-                              default);\n+                    struct_span_err!(tcx.sess, span, E0393,\n+                                     \"the type parameter `{}` must be explicitly specified\",\n+                                     def.name)\n+                        .span_label(span, &format!(\"missing reference to `{}`\", def.name))\n+                        .note(&format!(\"because of the default `Self` reference, \\\n+                                        type parameters must be specified on object types\"))\n+                        .emit();\n                     tcx.types.err\n                 } else {\n                     // This is a default type parameter."}, {"sha": "f045e873519cd44f6d8286737040676974a5fdee", "filename": "src/test/compile-fail/E0393.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5dc779ba52132b1fc68a9496744722b19eedb02b/src%2Ftest%2Fcompile-fail%2FE0393.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5dc779ba52132b1fc68a9496744722b19eedb02b/src%2Ftest%2Fcompile-fail%2FE0393.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2FE0393.rs?ref=5dc779ba52132b1fc68a9496744722b19eedb02b", "patch": "@@ -10,7 +10,10 @@\n \n trait A<T=Self> {}\n \n-fn together_we_will_rule_the_galaxy(son: &A) {} //~ ERROR E0393\n+fn together_we_will_rule_the_galaxy(son: &A) {}\n+//~^ ERROR E0393\n+//~| NOTE missing reference to `T`\n+//~| NOTE because of the default `Self` reference, type parameters must be specified on object types\n \n fn main() {\n }"}, {"sha": "935f3480db24abfd6cd3d845e1e757fcbc06f679", "filename": "src/test/compile-fail/issue-21950.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/5dc779ba52132b1fc68a9496744722b19eedb02b/src%2Ftest%2Fcompile-fail%2Fissue-21950.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5dc779ba52132b1fc68a9496744722b19eedb02b/src%2Ftest%2Fcompile-fail%2Fissue-21950.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-21950.rs?ref=5dc779ba52132b1fc68a9496744722b19eedb02b", "patch": "@@ -15,6 +15,9 @@ use std::ops::Add;\n fn main() {\n     let x = &10 as\n             &Add;\n-            //~^ ERROR the type parameter `RHS` must be explicitly specified in an object type because its default value `Self` references the type `Self`\n-            //~| ERROR the value of the associated type `Output` (from the trait `std::ops::Add`) must be specified\n+            //~^ ERROR E0393\n+            //~| NOTE missing reference to `RHS`\n+            //~| NOTE because of the default `Self` reference, type parameters must be specified on object types\n+            //~| ERROR E0191\n+            //~| NOTE missing associated type `Output` value\n }"}, {"sha": "51f342e3f0a435dc79a650a955ed204babe18cfa", "filename": "src/test/compile-fail/issue-22370.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/5dc779ba52132b1fc68a9496744722b19eedb02b/src%2Ftest%2Fcompile-fail%2Fissue-22370.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5dc779ba52132b1fc68a9496744722b19eedb02b/src%2Ftest%2Fcompile-fail%2Fissue-22370.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-22370.rs?ref=5dc779ba52132b1fc68a9496744722b19eedb02b", "patch": "@@ -13,6 +13,8 @@\n trait A<T=Self> {}\n \n fn f(a: &A) {}\n-//~^ ERROR the type parameter `T` must be explicitly specified in an object type because its default value `Self` references the type `Self`\n+//~^ ERROR E0393\n+//~| NOTE missing reference to `T`\n+//~| NOTE because of the default `Self` reference, type parameters must be specified on object types\n \n fn main() {}"}, {"sha": "45b110bf5631ddcb251bae2f69f6bfd517be8997", "filename": "src/test/compile-fail/issue-22560.rs", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/5dc779ba52132b1fc68a9496744722b19eedb02b/src%2Ftest%2Fcompile-fail%2Fissue-22560.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5dc779ba52132b1fc68a9496744722b19eedb02b/src%2Ftest%2Fcompile-fail%2Fissue-22560.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-22560.rs?ref=5dc779ba52132b1fc68a9496744722b19eedb02b", "patch": "@@ -13,9 +13,13 @@\n use std::ops::{Add, Sub};\n \n type Test = Add +\n-            //~^ ERROR the type parameter `RHS` must be explicitly specified in an object type because its default value `Self` references the type `Self`\n-            //~^^ ERROR the value of the associated type `Output` (from the trait `std::ops::Add`) must be specified [E0191]\n+            //~^ ERROR E0393\n+            //~| NOTE missing reference to `RHS`\n+            //~| NOTE because of the default `Self` reference, type parameters must be specified on object types\n+            //~| ERROR E0191\n+            //~| NOTE missing associated type `Output` value\n             Sub;\n-            //~^ ERROR only the builtin traits can be used as closure or object bounds\n+            //~^ ERROR E0225\n+            //~| NOTE non-builtin trait used as bounds\n \n fn main() { }"}]}