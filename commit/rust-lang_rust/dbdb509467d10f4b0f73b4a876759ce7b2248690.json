{"sha": "dbdb509467d10f4b0f73b4a876759ce7b2248690", "node_id": "C_kwDOAAsO6NoAKGRiZGI1MDk0NjdkMTBmNGIwZjczYjRhODc2NzU5Y2U3YjIyNDg2OTA", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2023-05-25T20:58:00Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-05-25T20:58:00Z"}, "message": "Rollup merge of #111831 - clubby789:capture-slice-pat, r=cjgillot\n\nAlways capture slice when pattern requires checking the length\n\nFixes #111751\n\ncc ``@zirconium-n,`` I see you were assigned to this but I've fixed some similar issues in the past and had an idea on how to investigate this.", "tree": {"sha": "3b901f5ae3dba3e69c90f3bcd7ed493ef65b1cf0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3b901f5ae3dba3e69c90f3bcd7ed493ef65b1cf0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/dbdb509467d10f4b0f73b4a876759ce7b2248690", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkb8vYCRBK7hj4Ov3rIwAAvOoIAIEVAMTbHOe2XH3w0IIFuB8C\nOknkOwJYuX1GcxrS5+16xJdzaMeF6DSw4VXotjL7So8PVoj6owJC8z4ZAGFDl9AV\nRLQxsRulk8IUse44HH86GbpSxRfZCC4B6+Nmpnr2ZpNKY3LlS7/AG1xIhWWDyNn6\nU0YmpGQX8I7UXitlRUc2DXwzaseQARyf4LRVD+9NXpq0UI/aRghg39GWYBW+RGJy\nRymMcb7DBENkITge7sHpoYltbWMPGYHZYBmMhAnhk7lnGdt7WyLm37xM7yzj4xlE\nTtESiJItsJpleQIPepWYLyX0kyRLYvWDRQQYV0pg+OW+TcWJ29ZOLdt/R5Y0Fiw=\n=OLl0\n-----END PGP SIGNATURE-----\n", "payload": "tree 3b901f5ae3dba3e69c90f3bcd7ed493ef65b1cf0\nparent 9d4527bc8099e0e22df2b32d055aaefa6a6e759f\nparent ace794c6d78ca2d1a8740b07f5e7f81fc09b4a02\nauthor Michael Goulet <michael@errs.io> 1685048280 -0700\ncommitter GitHub <noreply@github.com> 1685048280 -0700\n\nRollup merge of #111831 - clubby789:capture-slice-pat, r=cjgillot\n\nAlways capture slice when pattern requires checking the length\n\nFixes #111751\n\ncc ``@zirconium-n,`` I see you were assigned to this but I've fixed some similar issues in the past and had an idea on how to investigate this.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/dbdb509467d10f4b0f73b4a876759ce7b2248690", "html_url": "https://github.com/rust-lang/rust/commit/dbdb509467d10f4b0f73b4a876759ce7b2248690", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/dbdb509467d10f4b0f73b4a876759ce7b2248690/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9d4527bc8099e0e22df2b32d055aaefa6a6e759f", "url": "https://api.github.com/repos/rust-lang/rust/commits/9d4527bc8099e0e22df2b32d055aaefa6a6e759f", "html_url": "https://github.com/rust-lang/rust/commit/9d4527bc8099e0e22df2b32d055aaefa6a6e759f"}, {"sha": "ace794c6d78ca2d1a8740b07f5e7f81fc09b4a02", "url": "https://api.github.com/repos/rust-lang/rust/commits/ace794c6d78ca2d1a8740b07f5e7f81fc09b4a02", "html_url": "https://github.com/rust-lang/rust/commit/ace794c6d78ca2d1a8740b07f5e7f81fc09b4a02"}], "stats": {"total": 300, "additions": 209, "deletions": 91}, "files": [{"sha": "e14e8ac2ce0007fe4ff53c2f83cdedebcfc2f1cb", "filename": "compiler/rustc_hir_typeck/src/expr_use_visitor.rs", "status": "modified", "additions": 13, "deletions": 6, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/dbdb509467d10f4b0f73b4a876759ce7b2248690/compiler%2Frustc_hir_typeck%2Fsrc%2Fexpr_use_visitor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dbdb509467d10f4b0f73b4a876759ce7b2248690/compiler%2Frustc_hir_typeck%2Fsrc%2Fexpr_use_visitor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_typeck%2Fsrc%2Fexpr_use_visitor.rs?ref=dbdb509467d10f4b0f73b4a876759ce7b2248690", "patch": "@@ -438,12 +438,19 @@ impl<'a, 'tcx> ExprUseVisitor<'a, 'tcx> {\n                         // to borrow discr.\n                         needs_to_be_read = true;\n                     }\n-                    PatKind::Or(_)\n-                    | PatKind::Box(_)\n-                    | PatKind::Slice(..)\n-                    | PatKind::Ref(..)\n-                    | PatKind::Wild => {\n-                        // If the PatKind is Or, Box, Slice or Ref, the decision is made later\n+                    PatKind::Slice(lhs, wild, rhs) => {\n+                        // We don't need to test the length if the pattern is `[..]`\n+                        if matches!((lhs, wild, rhs), (&[], Some(_), &[]))\n+                            // Arrays have a statically known size, so\n+                            // there is no need to read their length\n+                            || discr_place.place.base_ty.is_array()\n+                        {\n+                        } else {\n+                            needs_to_be_read = true;\n+                        }\n+                    }\n+                    PatKind::Or(_) | PatKind::Box(_) | PatKind::Ref(..) | PatKind::Wild => {\n+                        // If the PatKind is Or, Box, or Ref, the decision is made later\n                         // as these patterns contains subpatterns\n                         // If the PatKind is Wild, the decision is made based on the other patterns being\n                         // examined"}, {"sha": "41b09ba03702b69909cba21681ce4106ab33a74b", "filename": "tests/ui/closures/2229_closure_analysis/match/patterns-capture-analysis.rs", "status": "modified", "additions": 59, "deletions": 13, "changes": 72, "blob_url": "https://github.com/rust-lang/rust/blob/dbdb509467d10f4b0f73b4a876759ce7b2248690/tests%2Fui%2Fclosures%2F2229_closure_analysis%2Fmatch%2Fpatterns-capture-analysis.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dbdb509467d10f4b0f73b4a876759ce7b2248690/tests%2Fui%2Fclosures%2F2229_closure_analysis%2Fmatch%2Fpatterns-capture-analysis.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fclosures%2F2229_closure_analysis%2Fmatch%2Fpatterns-capture-analysis.rs?ref=dbdb509467d10f4b0f73b4a876759ce7b2248690", "patch": "@@ -1,16 +1,14 @@\n // edition:2021\n \n #![feature(rustc_attrs)]\n+#![feature(stmt_expr_attributes)]\n \n // Should capture the discriminant since a variant of a multivariant enum is\n // mentioned in the match arm; the discriminant is captured by the closure regardless\n // of if it creates a binding\n fn test_1_should_capture() {\n     let variant = Some(2229);\n     let c =  #[rustc_capture_analysis]\n-    //~^ ERROR: attributes on expressions are experimental\n-    //~| NOTE: see issue #15701 <https://github.com/rust-lang/rust/issues/15701>\n-\n     || {\n     //~^ First Pass analysis includes:\n     //~| Min Capture analysis includes:\n@@ -29,8 +27,6 @@ fn test_1_should_capture() {\n fn test_2_should_not_capture() {\n     let variant = Some(2229);\n     let c =  #[rustc_capture_analysis]\n-    //~^ ERROR: attributes on expressions are experimental\n-    //~| NOTE: see issue #15701 <https://github.com/rust-lang/rust/issues/15701>\n     || {\n     //~^ First Pass analysis includes:\n         match variant {\n@@ -50,8 +46,6 @@ enum SingleVariant {\n fn test_3_should_not_capture_single_variant() {\n     let variant = SingleVariant::Points(1);\n     let c =  #[rustc_capture_analysis]\n-    //~^ ERROR: attributes on expressions are experimental\n-    //~| NOTE: see issue #15701 <https://github.com/rust-lang/rust/issues/15701>\n     || {\n     //~^ First Pass analysis includes:\n         match variant {\n@@ -66,8 +60,6 @@ fn test_3_should_not_capture_single_variant() {\n fn test_6_should_capture_single_variant() {\n     let variant = SingleVariant::Points(1);\n     let c =  #[rustc_capture_analysis]\n-    //~^ ERROR: attributes on expressions are experimental\n-    //~| NOTE: see issue #15701 <https://github.com/rust-lang/rust/issues/15701>\n     || {\n     //~^ First Pass analysis includes:\n     //~| Min Capture analysis includes:\n@@ -88,8 +80,6 @@ fn test_6_should_capture_single_variant() {\n fn test_4_should_not_capture_array() {\n     let array: [i32; 3] = [0; 3];\n     let c =  #[rustc_capture_analysis]\n-    //~^ ERROR: attributes on expressions are experimental\n-    //~| NOTE: see issue #15701 <https://github.com/rust-lang/rust/issues/15701>\n     || {\n     //~^ First Pass analysis includes:\n         match array {\n@@ -112,8 +102,6 @@ enum MVariant {\n fn test_5_should_capture_multi_variant() {\n     let variant = MVariant::A;\n     let c =  #[rustc_capture_analysis]\n-    //~^ ERROR: attributes on expressions are experimental\n-    //~| NOTE: see issue #15701 <https://github.com/rust-lang/rust/issues/15701>\n     || {\n     //~^ First Pass analysis includes:\n     //~| Min Capture analysis includes:\n@@ -127,11 +115,69 @@ fn test_5_should_capture_multi_variant() {\n     c();\n }\n \n+// Even though all patterns are wild, we need to read the discriminant\n+// in order to test the slice length\n+fn test_7_should_capture_slice_len() {\n+    let slice: &[i32] = &[1, 2, 3];\n+    let c =  #[rustc_capture_analysis]\n+    || {\n+    //~^ First Pass analysis includes:\n+    //~| Min Capture analysis includes:\n+        match slice {\n+            //~^ NOTE: Capturing slice[] -> ImmBorrow\n+            //~| NOTE: Min Capture slice[] -> ImmBorrow\n+            [_,_,_] => {},\n+            _ => {}\n+        }\n+    };\n+    c();\n+    let c =  #[rustc_capture_analysis]\n+    || {\n+    //~^ First Pass analysis includes:\n+    //~| Min Capture analysis includes:\n+        match slice {\n+            //~^ NOTE: Capturing slice[] -> ImmBorrow\n+            //~| NOTE: Min Capture slice[] -> ImmBorrow\n+            [] => {},\n+            _ => {}\n+        }\n+    };\n+    c();\n+    let c =  #[rustc_capture_analysis]\n+    || {\n+    //~^ First Pass analysis includes:\n+    //~| Min Capture analysis includes:\n+        match slice {\n+            //~^ NOTE: Capturing slice[] -> ImmBorrow\n+            //~| NOTE: Min Capture slice[] -> ImmBorrow\n+            [_, .. ,_] => {},\n+            _ => {}\n+        }\n+    };\n+    c();\n+}\n+\n+// Wild pattern that doesn't bind, so no capture\n+fn test_8_capture_slice_wild() {\n+    let slice: &[i32] = &[1, 2, 3];\n+    let c =  #[rustc_capture_analysis]\n+    || {\n+    //~^ First Pass analysis includes:\n+        match slice {\n+            [..] => {},\n+            _ => {}\n+        }\n+    };\n+    c();\n+}\n+\n fn main() {\n     test_1_should_capture();\n     test_2_should_not_capture();\n     test_3_should_not_capture_single_variant();\n     test_6_should_capture_single_variant();\n     test_4_should_not_capture_array();\n     test_5_should_capture_multi_variant();\n+    test_7_should_capture_slice_len();\n+    test_8_capture_slice_wild();\n }"}, {"sha": "e137af1a0bd4080175b2f95ecdf66a46b7bf8de2", "filename": "tests/ui/closures/2229_closure_analysis/match/patterns-capture-analysis.stderr", "status": "modified", "additions": 137, "deletions": 72, "changes": 209, "blob_url": "https://github.com/rust-lang/rust/blob/dbdb509467d10f4b0f73b4a876759ce7b2248690/tests%2Fui%2Fclosures%2F2229_closure_analysis%2Fmatch%2Fpatterns-capture-analysis.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/dbdb509467d10f4b0f73b4a876759ce7b2248690/tests%2Fui%2Fclosures%2F2229_closure_analysis%2Fmatch%2Fpatterns-capture-analysis.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fclosures%2F2229_closure_analysis%2Fmatch%2Fpatterns-capture-analysis.stderr?ref=dbdb509467d10f4b0f73b4a876759ce7b2248690", "patch": "@@ -1,59 +1,5 @@\n-error[E0658]: attributes on expressions are experimental\n-  --> $DIR/patterns-capture-analysis.rs:10:14\n-   |\n-LL |     let c =  #[rustc_capture_analysis]\n-   |              ^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #15701 <https://github.com/rust-lang/rust/issues/15701> for more information\n-   = help: add `#![feature(stmt_expr_attributes)]` to the crate attributes to enable\n-\n-error[E0658]: attributes on expressions are experimental\n-  --> $DIR/patterns-capture-analysis.rs:31:14\n-   |\n-LL |     let c =  #[rustc_capture_analysis]\n-   |              ^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #15701 <https://github.com/rust-lang/rust/issues/15701> for more information\n-   = help: add `#![feature(stmt_expr_attributes)]` to the crate attributes to enable\n-\n-error[E0658]: attributes on expressions are experimental\n-  --> $DIR/patterns-capture-analysis.rs:52:14\n-   |\n-LL |     let c =  #[rustc_capture_analysis]\n-   |              ^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #15701 <https://github.com/rust-lang/rust/issues/15701> for more information\n-   = help: add `#![feature(stmt_expr_attributes)]` to the crate attributes to enable\n-\n-error[E0658]: attributes on expressions are experimental\n-  --> $DIR/patterns-capture-analysis.rs:68:14\n-   |\n-LL |     let c =  #[rustc_capture_analysis]\n-   |              ^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #15701 <https://github.com/rust-lang/rust/issues/15701> for more information\n-   = help: add `#![feature(stmt_expr_attributes)]` to the crate attributes to enable\n-\n-error[E0658]: attributes on expressions are experimental\n-  --> $DIR/patterns-capture-analysis.rs:90:14\n-   |\n-LL |     let c =  #[rustc_capture_analysis]\n-   |              ^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #15701 <https://github.com/rust-lang/rust/issues/15701> for more information\n-   = help: add `#![feature(stmt_expr_attributes)]` to the crate attributes to enable\n-\n-error[E0658]: attributes on expressions are experimental\n-  --> $DIR/patterns-capture-analysis.rs:114:14\n-   |\n-LL |     let c =  #[rustc_capture_analysis]\n-   |              ^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #15701 <https://github.com/rust-lang/rust/issues/15701> for more information\n-   = help: add `#![feature(stmt_expr_attributes)]` to the crate attributes to enable\n-\n error: First Pass analysis includes:\n-  --> $DIR/patterns-capture-analysis.rs:14:5\n+  --> $DIR/patterns-capture-analysis.rs:12:5\n    |\n LL | /     || {\n LL | |\n@@ -65,13 +11,13 @@ LL | |     };\n    | |_____^\n    |\n note: Capturing variant[] -> ImmBorrow\n-  --> $DIR/patterns-capture-analysis.rs:17:15\n+  --> $DIR/patterns-capture-analysis.rs:15:15\n    |\n LL |         match variant {\n    |               ^^^^^^^\n \n error: Min Capture analysis includes:\n-  --> $DIR/patterns-capture-analysis.rs:14:5\n+  --> $DIR/patterns-capture-analysis.rs:12:5\n    |\n LL | /     || {\n LL | |\n@@ -83,13 +29,13 @@ LL | |     };\n    | |_____^\n    |\n note: Min Capture variant[] -> ImmBorrow\n-  --> $DIR/patterns-capture-analysis.rs:17:15\n+  --> $DIR/patterns-capture-analysis.rs:15:15\n    |\n LL |         match variant {\n    |               ^^^^^^^\n \n error: First Pass analysis includes:\n-  --> $DIR/patterns-capture-analysis.rs:34:5\n+  --> $DIR/patterns-capture-analysis.rs:30:5\n    |\n LL | /     || {\n LL | |\n@@ -100,7 +46,7 @@ LL | |     };\n    | |_____^\n \n error: First Pass analysis includes:\n-  --> $DIR/patterns-capture-analysis.rs:55:5\n+  --> $DIR/patterns-capture-analysis.rs:49:5\n    |\n LL | /     || {\n LL | |\n@@ -111,7 +57,7 @@ LL | |     };\n    | |_____^\n \n error: First Pass analysis includes:\n-  --> $DIR/patterns-capture-analysis.rs:71:5\n+  --> $DIR/patterns-capture-analysis.rs:63:5\n    |\n LL | /     || {\n LL | |\n@@ -123,18 +69,18 @@ LL | |     };\n    | |_____^\n    |\n note: Capturing variant[] -> ImmBorrow\n-  --> $DIR/patterns-capture-analysis.rs:74:15\n+  --> $DIR/patterns-capture-analysis.rs:66:15\n    |\n LL |         match variant {\n    |               ^^^^^^^\n note: Capturing variant[(0, 0)] -> ImmBorrow\n-  --> $DIR/patterns-capture-analysis.rs:74:15\n+  --> $DIR/patterns-capture-analysis.rs:66:15\n    |\n LL |         match variant {\n    |               ^^^^^^^\n \n error: Min Capture analysis includes:\n-  --> $DIR/patterns-capture-analysis.rs:71:5\n+  --> $DIR/patterns-capture-analysis.rs:63:5\n    |\n LL | /     || {\n LL | |\n@@ -146,13 +92,13 @@ LL | |     };\n    | |_____^\n    |\n note: Min Capture variant[] -> ImmBorrow\n-  --> $DIR/patterns-capture-analysis.rs:74:15\n+  --> $DIR/patterns-capture-analysis.rs:66:15\n    |\n LL |         match variant {\n    |               ^^^^^^^\n \n error: First Pass analysis includes:\n-  --> $DIR/patterns-capture-analysis.rs:93:5\n+  --> $DIR/patterns-capture-analysis.rs:83:5\n    |\n LL | /     || {\n LL | |\n@@ -163,7 +109,7 @@ LL | |     };\n    | |_____^\n \n error: First Pass analysis includes:\n-  --> $DIR/patterns-capture-analysis.rs:117:5\n+  --> $DIR/patterns-capture-analysis.rs:105:5\n    |\n LL | /     || {\n LL | |\n@@ -175,13 +121,13 @@ LL | |     };\n    | |_____^\n    |\n note: Capturing variant[] -> ImmBorrow\n-  --> $DIR/patterns-capture-analysis.rs:120:15\n+  --> $DIR/patterns-capture-analysis.rs:108:15\n    |\n LL |         match variant {\n    |               ^^^^^^^\n \n error: Min Capture analysis includes:\n-  --> $DIR/patterns-capture-analysis.rs:117:5\n+  --> $DIR/patterns-capture-analysis.rs:105:5\n    |\n LL | /     || {\n LL | |\n@@ -193,11 +139,130 @@ LL | |     };\n    | |_____^\n    |\n note: Min Capture variant[] -> ImmBorrow\n-  --> $DIR/patterns-capture-analysis.rs:120:15\n+  --> $DIR/patterns-capture-analysis.rs:108:15\n    |\n LL |         match variant {\n    |               ^^^^^^^\n \n-error: aborting due to 15 previous errors\n+error: First Pass analysis includes:\n+  --> $DIR/patterns-capture-analysis.rs:123:5\n+   |\n+LL | /     || {\n+LL | |\n+LL | |\n+LL | |         match slice {\n+...  |\n+LL | |         }\n+LL | |     };\n+   | |_____^\n+   |\n+note: Capturing slice[] -> ImmBorrow\n+  --> $DIR/patterns-capture-analysis.rs:126:15\n+   |\n+LL |         match slice {\n+   |               ^^^^^\n+\n+error: Min Capture analysis includes:\n+  --> $DIR/patterns-capture-analysis.rs:123:5\n+   |\n+LL | /     || {\n+LL | |\n+LL | |\n+LL | |         match slice {\n+...  |\n+LL | |         }\n+LL | |     };\n+   | |_____^\n+   |\n+note: Min Capture slice[] -> ImmBorrow\n+  --> $DIR/patterns-capture-analysis.rs:126:15\n+   |\n+LL |         match slice {\n+   |               ^^^^^\n+\n+error: First Pass analysis includes:\n+  --> $DIR/patterns-capture-analysis.rs:135:5\n+   |\n+LL | /     || {\n+LL | |\n+LL | |\n+LL | |         match slice {\n+...  |\n+LL | |         }\n+LL | |     };\n+   | |_____^\n+   |\n+note: Capturing slice[] -> ImmBorrow\n+  --> $DIR/patterns-capture-analysis.rs:138:15\n+   |\n+LL |         match slice {\n+   |               ^^^^^\n+\n+error: Min Capture analysis includes:\n+  --> $DIR/patterns-capture-analysis.rs:135:5\n+   |\n+LL | /     || {\n+LL | |\n+LL | |\n+LL | |         match slice {\n+...  |\n+LL | |         }\n+LL | |     };\n+   | |_____^\n+   |\n+note: Min Capture slice[] -> ImmBorrow\n+  --> $DIR/patterns-capture-analysis.rs:138:15\n+   |\n+LL |         match slice {\n+   |               ^^^^^\n+\n+error: First Pass analysis includes:\n+  --> $DIR/patterns-capture-analysis.rs:147:5\n+   |\n+LL | /     || {\n+LL | |\n+LL | |\n+LL | |         match slice {\n+...  |\n+LL | |         }\n+LL | |     };\n+   | |_____^\n+   |\n+note: Capturing slice[] -> ImmBorrow\n+  --> $DIR/patterns-capture-analysis.rs:150:15\n+   |\n+LL |         match slice {\n+   |               ^^^^^\n+\n+error: Min Capture analysis includes:\n+  --> $DIR/patterns-capture-analysis.rs:147:5\n+   |\n+LL | /     || {\n+LL | |\n+LL | |\n+LL | |         match slice {\n+...  |\n+LL | |         }\n+LL | |     };\n+   | |_____^\n+   |\n+note: Min Capture slice[] -> ImmBorrow\n+  --> $DIR/patterns-capture-analysis.rs:150:15\n+   |\n+LL |         match slice {\n+   |               ^^^^^\n+\n+error: First Pass analysis includes:\n+  --> $DIR/patterns-capture-analysis.rs:164:5\n+   |\n+LL | /     || {\n+LL | |\n+LL | |         match slice {\n+LL | |             [..] => {},\n+LL | |             _ => {}\n+LL | |         }\n+LL | |     };\n+   | |_____^\n+\n+error: aborting due to 16 previous errors\n \n-For more information about this error, try `rustc --explain E0658`."}]}