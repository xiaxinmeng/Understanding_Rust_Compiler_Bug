{"sha": "78e728e2c20a61dad6d73d9fcb1927668c75c416", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc4ZTcyOGUyYzIwYTYxZGFkNmQ3M2Q5ZmNiMTkyNzY2OGM3NWM0MTY=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-08-29T15:13:59Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-08-29T15:13:59Z"}, "message": "Rollup merge of #63953 - crlf0710:bootstrap_mirroring, r=Mark-Simulacrum\n\nbootstrap: allow specifying mirror for bootstrap compiler download.", "tree": {"sha": "b8b250496a319074bad1e5c5e8bca8de120b4ea3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b8b250496a319074bad1e5c5e8bca8de120b4ea3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/78e728e2c20a61dad6d73d9fcb1927668c75c416", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdZ+u3CRBK7hj4Ov3rIwAAdHIIAGbY7cCVi5O+Gb6eYAg3btLI\nziUILbyxMssOnyXnUzVIUCy11geW6tczDYgorzXD4UORVDvM3iZEpqmg4+isGjwN\nK9/UC30rpg+OCsUk5m7zZ34Al6MxqTzNz6oEF6VNAT6zQfvHnIAiG8C144+5SKK3\no2gGQ1V9Q0upwokV9NZmeQKQUCXqc7/a8zaK93QMQsGydwFKBPfvbXelUxMnjXzO\nArmT1kCS07x/0Pxo5kAyS1TebI/XZw5uY8w1WHOKOnCnIAVoO0SBML0BU71SrNk+\n4GdmEUahBxAZNy2kb8xLV9ZMYZ9wYhF/su+hTtDObRAY2+DkvnluZmeywzLSjYY=\n=BmGp\n-----END PGP SIGNATURE-----\n", "payload": "tree b8b250496a319074bad1e5c5e8bca8de120b4ea3\nparent 1ea8fc587cc7166f901e05d991d5dae75ec1d101\nparent c9bf5c0bffef595136b484b0282ade18894cf5af\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1567091639 +0200\ncommitter GitHub <noreply@github.com> 1567091639 +0200\n\nRollup merge of #63953 - crlf0710:bootstrap_mirroring, r=Mark-Simulacrum\n\nbootstrap: allow specifying mirror for bootstrap compiler download.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/78e728e2c20a61dad6d73d9fcb1927668c75c416", "html_url": "https://github.com/rust-lang/rust/commit/78e728e2c20a61dad6d73d9fcb1927668c75c416", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/78e728e2c20a61dad6d73d9fcb1927668c75c416/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1ea8fc587cc7166f901e05d991d5dae75ec1d101", "url": "https://api.github.com/repos/rust-lang/rust/commits/1ea8fc587cc7166f901e05d991d5dae75ec1d101", "html_url": "https://github.com/rust-lang/rust/commit/1ea8fc587cc7166f901e05d991d5dae75ec1d101"}, {"sha": "c9bf5c0bffef595136b484b0282ade18894cf5af", "url": "https://api.github.com/repos/rust-lang/rust/commits/c9bf5c0bffef595136b484b0282ade18894cf5af", "html_url": "https://github.com/rust-lang/rust/commit/c9bf5c0bffef595136b484b0282ade18894cf5af"}], "stats": {"total": 16, "additions": 14, "deletions": 2}, "files": [{"sha": "4162fe1df5086841b6c0953e041b4c8fd3deccef", "filename": "src/bootstrap/bootstrap.py", "status": "modified", "additions": 14, "deletions": 2, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/78e728e2c20a61dad6d73d9fcb1927668c75c416/src%2Fbootstrap%2Fbootstrap.py", "raw_url": "https://github.com/rust-lang/rust/raw/78e728e2c20a61dad6d73d9fcb1927668c75c416/src%2Fbootstrap%2Fbootstrap.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbootstrap.py?ref=78e728e2c20a61dad6d73d9fcb1927668c75c416", "patch": "@@ -320,7 +320,7 @@ class RustBuild(object):\n     def __init__(self):\n         self.cargo_channel = ''\n         self.date = ''\n-        self._download_url = 'https://static.rust-lang.org'\n+        self._download_url = ''\n         self.rustc_channel = ''\n         self.build = ''\n         self.build_dir = os.path.join(os.getcwd(), \"build\")\n@@ -733,9 +733,19 @@ def update_submodules(self):\n             self.update_submodule(module[0], module[1], recorded_submodules)\n         print(\"Submodules updated in %.2f seconds\" % (time() - start_time))\n \n+    def set_normal_environment(self):\n+        \"\"\"Set download URL for normal environment\"\"\"\n+        if 'RUSTUP_DIST_SERVER' in os.environ:\n+            self._download_url = os.environ['RUSTUP_DIST_SERVER']\n+        else:\n+            self._download_url = 'https://static.rust-lang.org'\n+\n     def set_dev_environment(self):\n         \"\"\"Set download URL for development environment\"\"\"\n-        self._download_url = 'https://dev-static.rust-lang.org'\n+        if 'RUSTUP_DEV_DIST_SERVER' in os.environ:\n+            self._download_url = os.environ['RUSTUP_DEV_DIST_SERVER']\n+        else:\n+            self._download_url = 'https://dev-static.rust-lang.org'\n \n     def check_vendored_status(self):\n         \"\"\"Check that vendoring is configured properly\"\"\"\n@@ -828,6 +838,8 @@ def bootstrap(help_triggered):\n \n     if 'dev' in data:\n         build.set_dev_environment()\n+    else:\n+        build.set_normal_environment()\n \n     build.update_submodules()\n "}]}