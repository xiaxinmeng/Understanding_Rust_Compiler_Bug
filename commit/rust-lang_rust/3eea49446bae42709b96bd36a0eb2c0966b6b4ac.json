{"sha": "3eea49446bae42709b96bd36a0eb2c0966b6b4ac", "node_id": "C_kwDOAAsO6NoAKDNlZWE0OTQ0NmJhZTQyNzA5Yjk2YmQzNmEwZWIyYzA5NjZiNmI0YWM", "commit": {"author": {"name": "blyxyas", "email": "blyxyas@gmail.com", "date": "2023-03-14T19:59:39Z"}, "committer": {"name": "blyxyas", "email": "blyxyas@gmail.com", "date": "2023-03-14T19:59:39Z"}, "message": "Ignore external macros", "tree": {"sha": "83826183c190f3edb29e1e1419da2f997fec4219", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/83826183c190f3edb29e1e1419da2f997fec4219"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3eea49446bae42709b96bd36a0eb2c0966b6b4ac", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEM3aofraJSaf7CtgpTTgXC1ovwzQFAmQQ0iwACgkQTTgXC1ov\nwzQivA/8C9YB/ythu0LO/PvVbguGzBfk/hZgbhED4XD+hOwgMZM/MTxvTiuPcfI8\nfBMp5OZyv4LR6fkDXEj6JZvk93UuAA/S2k8+YrGRF9qmlPI7ebEtht7hOjwZN0Wm\nSA0u0HbTXs3HkOsZoLJNEGQNgeMhphqGXd2VrhEV8RsRN/wwlv7bSK10XWEqU/dY\ngtNaK2exzE5wuDhRPE85WyXQJj/bWY3HtnZck6tM7qdlRRpDYynWsHztnSsIY9A4\nZIoq9KSeU6Kngbpi00edCPiAhjANTitgU0+BGmti7M9BkymYNAJlgL0j47T6Rg5e\nIinS9fa2bRj/PQBclYMmNKSbl++xkhaJXwakF6UdOyrFkBNRBDfTKkZj9EzPxdqz\nHx/OEyiABBrnHxtNultIVH0LjtVtMuyP/yhGgech+siQAasCXOtebxH6qSO4nrdC\no6DbxGeNnBhWxDQ3rMu9G5p6gYEKaA/7gqLjx8UAwyixqJQWnO680Dy/Kyq8myWs\ntsDdgKcWQDq4MszfUAN9CVUz+s8KKB7DOj1nZF+lu2ZTThyCyFsRNs8l7YiXwwOW\nIlkuwVKMeSkvpAam4vgTiVKvCLfFLqzlJS08xScHvAkH3SoK4Eqo20/6cmY/sevz\nRMj2m6Xbe7PsrG3h//N2VIHCzAMjI8MnrI0fZTP5zDXB3mVx/xk=\n=ROmx\n-----END PGP SIGNATURE-----", "payload": "tree 83826183c190f3edb29e1e1419da2f997fec4219\nparent c465bf7f67ff12b9d7246a26ea83f66f0de228da\nauthor blyxyas <blyxyas@gmail.com> 1678823979 +0100\ncommitter blyxyas <blyxyas@gmail.com> 1678823979 +0100\n\nIgnore external macros\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3eea49446bae42709b96bd36a0eb2c0966b6b4ac", "html_url": "https://github.com/rust-lang/rust/commit/3eea49446bae42709b96bd36a0eb2c0966b6b4ac", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3eea49446bae42709b96bd36a0eb2c0966b6b4ac/comments", "author": {"login": "blyxyas", "id": 73757586, "node_id": "MDQ6VXNlcjczNzU3NTg2", "avatar_url": "https://avatars.githubusercontent.com/u/73757586?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blyxyas", "html_url": "https://github.com/blyxyas", "followers_url": "https://api.github.com/users/blyxyas/followers", "following_url": "https://api.github.com/users/blyxyas/following{/other_user}", "gists_url": "https://api.github.com/users/blyxyas/gists{/gist_id}", "starred_url": "https://api.github.com/users/blyxyas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blyxyas/subscriptions", "organizations_url": "https://api.github.com/users/blyxyas/orgs", "repos_url": "https://api.github.com/users/blyxyas/repos", "events_url": "https://api.github.com/users/blyxyas/events{/privacy}", "received_events_url": "https://api.github.com/users/blyxyas/received_events", "type": "User", "site_admin": false}, "committer": {"login": "blyxyas", "id": 73757586, "node_id": "MDQ6VXNlcjczNzU3NTg2", "avatar_url": "https://avatars.githubusercontent.com/u/73757586?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blyxyas", "html_url": "https://github.com/blyxyas", "followers_url": "https://api.github.com/users/blyxyas/followers", "following_url": "https://api.github.com/users/blyxyas/following{/other_user}", "gists_url": "https://api.github.com/users/blyxyas/gists{/gist_id}", "starred_url": "https://api.github.com/users/blyxyas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blyxyas/subscriptions", "organizations_url": "https://api.github.com/users/blyxyas/orgs", "repos_url": "https://api.github.com/users/blyxyas/repos", "events_url": "https://api.github.com/users/blyxyas/events{/privacy}", "received_events_url": "https://api.github.com/users/blyxyas/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c465bf7f67ff12b9d7246a26ea83f66f0de228da", "url": "https://api.github.com/repos/rust-lang/rust/commits/c465bf7f67ff12b9d7246a26ea83f66f0de228da", "html_url": "https://github.com/rust-lang/rust/commit/c465bf7f67ff12b9d7246a26ea83f66f0de228da"}], "stats": {"total": 7, "additions": 5, "deletions": 2}, "files": [{"sha": "938ca3a6cee5e77c0f0f0f0e6d64eff392dd189b", "filename": "clippy_lints/src/swap.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/3eea49446bae42709b96bd36a0eb2c0966b6b4ac/clippy_lints%2Fsrc%2Fswap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3eea49446bae42709b96bd36a0eb2c0966b6b4ac/clippy_lints%2Fsrc%2Fswap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fswap.rs?ref=3eea49446bae42709b96bd36a0eb2c0966b6b4ac", "patch": "@@ -6,7 +6,8 @@ use clippy_utils::{can_mut_borrow_both, eq_expr_value, in_constant, std_or_core}\n use if_chain::if_chain;\n use rustc_errors::Applicability;\n use rustc_hir::{BinOpKind, Block, Expr, ExprKind, PatKind, QPath, Stmt, StmtKind};\n-use rustc_lint::{LateContext, LateLintPass};\n+use rustc_lint::{LateContext, LateLintPass, LintContext};\n+use rustc_middle::lint::in_external_macro;\n use rustc_middle::ty;\n use rustc_session::{declare_lint_pass, declare_tool_lint};\n use rustc_span::source_map::Spanned;\n@@ -75,7 +76,9 @@ declare_lint_pass!(Swap => [MANUAL_SWAP, ALMOST_SWAPPED]);\n impl<'tcx> LateLintPass<'tcx> for Swap {\n     fn check_block(&mut self, cx: &LateContext<'tcx>, block: &'tcx Block<'_>) {\n         check_manual_swap(cx, block);\n-        check_suspicious_swap(cx, block);\n+        if !in_external_macro(cx.sess(), block.span) {\n+            check_suspicious_swap(cx, block);\n+        }\n         check_xor_swap(cx, block);\n     }\n }"}]}