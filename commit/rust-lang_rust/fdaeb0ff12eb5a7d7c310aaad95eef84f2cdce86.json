{"sha": "fdaeb0ff12eb5a7d7c310aaad95eef84f2cdce86", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZkYWViMGZmMTJlYjVhN2Q3YzMxMGFhYWQ5NWVlZjg0ZjJjZGNlODY=", "commit": {"author": {"name": "Dylan DPC", "email": "dylan.dpc@gmail.com", "date": "2020-06-08T20:15:19Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-06-08T20:15:19Z"}, "message": "Rollup merge of #73138 - eggyal:macos-linker-strip, r=petrochenkov\n\nUse shorthand linker strip arguments in order to support MacOS\n\nPer discussion from https://github.com/rust-lang/rust/issues/72110#issuecomment-636609419 onward, the current `-Z strip` options aren't supported by the MacOS linker, but I think only because it doesn't support the longhand arguments `--strip-debug` and `--strip-all`.\n\nThis PR switches to using the shorthand arguments `-s` and `-S` instead, which (I believe) are supported by all GCC linkers.", "tree": {"sha": "e0c03f185afb94a3093b9c9bd2d22d4818f8bf54", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e0c03f185afb94a3093b9c9bd2d22d4818f8bf54"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fdaeb0ff12eb5a7d7c310aaad95eef84f2cdce86", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJe3pxXCRBK7hj4Ov3rIwAAdHIIAE5y71cJQxl/hqBqwv1aspnS\nAiawI+MDViZPbvfOSbswIEIT+OHp384/uC0XLX3knGcqaFHzhFh9SPCOhInJWPEK\nmt+qkBJhCKF/9pz/rRmxvQCnzYUKxvRxRA1XiJuzv7Y01ZV48XtgbYdUHtGVkTc4\n+L+l/kcHD4r7P6rCa2d6X8Wms4sLSYGZTolMmzhhuIub3d+Ys2Vfsa0goMraleqF\napCS8kLEY74U2E7pZz+0jpR+3IK1BqZFbuhIBctq506F9zIrjM/uLi+MbKXG002x\nTxvCJUXRzBgdKLToD+pohkicPQbkJbXY0LX9nHTxxXHFSlNMHCWX+ne5/fu8suI=\n=28Z0\n-----END PGP SIGNATURE-----\n", "payload": "tree e0c03f185afb94a3093b9c9bd2d22d4818f8bf54\nparent 31a1858a73f26be75a8c7b4189b03f47a68bf9a1\nparent 8cf85bc0dcabcf99775f2b9a7fa2191caea7f164\nauthor Dylan DPC <dylan.dpc@gmail.com> 1591647319 +0200\ncommitter GitHub <noreply@github.com> 1591647319 +0200\n\nRollup merge of #73138 - eggyal:macos-linker-strip, r=petrochenkov\n\nUse shorthand linker strip arguments in order to support MacOS\n\nPer discussion from https://github.com/rust-lang/rust/issues/72110#issuecomment-636609419 onward, the current `-Z strip` options aren't supported by the MacOS linker, but I think only because it doesn't support the longhand arguments `--strip-debug` and `--strip-all`.\n\nThis PR switches to using the shorthand arguments `-s` and `-S` instead, which (I believe) are supported by all GCC linkers.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fdaeb0ff12eb5a7d7c310aaad95eef84f2cdce86", "html_url": "https://github.com/rust-lang/rust/commit/fdaeb0ff12eb5a7d7c310aaad95eef84f2cdce86", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fdaeb0ff12eb5a7d7c310aaad95eef84f2cdce86/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "31a1858a73f26be75a8c7b4189b03f47a68bf9a1", "url": "https://api.github.com/repos/rust-lang/rust/commits/31a1858a73f26be75a8c7b4189b03f47a68bf9a1", "html_url": "https://github.com/rust-lang/rust/commit/31a1858a73f26be75a8c7b4189b03f47a68bf9a1"}, {"sha": "8cf85bc0dcabcf99775f2b9a7fa2191caea7f164", "url": "https://api.github.com/repos/rust-lang/rust/commits/8cf85bc0dcabcf99775f2b9a7fa2191caea7f164", "html_url": "https://github.com/rust-lang/rust/commit/8cf85bc0dcabcf99775f2b9a7fa2191caea7f164"}], "stats": {"total": 6, "additions": 4, "deletions": 2}, "files": [{"sha": "b17c36782074881f4dc47afffdb783cf80b5dbdf", "filename": "src/librustc_codegen_ssa/back/linker.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fdaeb0ff12eb5a7d7c310aaad95eef84f2cdce86/src%2Flibrustc_codegen_ssa%2Fback%2Flinker.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fdaeb0ff12eb5a7d7c310aaad95eef84f2cdce86/src%2Flibrustc_codegen_ssa%2Fback%2Flinker.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Fback%2Flinker.rs?ref=fdaeb0ff12eb5a7d7c310aaad95eef84f2cdce86", "patch": "@@ -481,10 +481,12 @@ impl<'a> Linker for GccLinker<'a> {\n         match strip {\n             Strip::None => {}\n             Strip::Debuginfo => {\n-                self.linker_arg(\"--strip-debug\");\n+                // MacOS linker does not support longhand argument --strip-debug\n+                self.linker_arg(\"-S\");\n             }\n             Strip::Symbols => {\n-                self.linker_arg(\"--strip-all\");\n+                // MacOS linker does not support longhand argument --strip-all\n+                self.linker_arg(\"-s\");\n             }\n         }\n     }"}]}