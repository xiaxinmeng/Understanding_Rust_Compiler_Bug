{"sha": "a3396b207093c01065b63b0c58f1e6654629166d", "node_id": "C_kwDOAAsO6NoAKGEzMzk2YjIwNzA5M2MwMTA2NWI2M2IwYzU4ZjFlNjY1NDYyOTE2NmQ", "commit": {"author": {"name": "Jhonny Bill Mena", "email": "jhonnybillm@gmail.com", "date": "2022-09-18T15:46:56Z"}, "committer": {"name": "Jhonny Bill Mena", "email": "jhonnybillm@gmail.com", "date": "2022-09-21T15:39:53Z"}, "message": "UPDATE - rename DiagnosticHandler macro to Diagnostic", "tree": {"sha": "7d2b5bd979e9a1da8a2e10404676004876edc147", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7d2b5bd979e9a1da8a2e10404676004876edc147"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a3396b207093c01065b63b0c58f1e6654629166d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a3396b207093c01065b63b0c58f1e6654629166d", "html_url": "https://github.com/rust-lang/rust/commit/a3396b207093c01065b63b0c58f1e6654629166d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a3396b207093c01065b63b0c58f1e6654629166d/comments", "author": {"login": "JhonnyBillM", "id": 18747072, "node_id": "MDQ6VXNlcjE4NzQ3MDcy", "avatar_url": "https://avatars.githubusercontent.com/u/18747072?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JhonnyBillM", "html_url": "https://github.com/JhonnyBillM", "followers_url": "https://api.github.com/users/JhonnyBillM/followers", "following_url": "https://api.github.com/users/JhonnyBillM/following{/other_user}", "gists_url": "https://api.github.com/users/JhonnyBillM/gists{/gist_id}", "starred_url": "https://api.github.com/users/JhonnyBillM/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JhonnyBillM/subscriptions", "organizations_url": "https://api.github.com/users/JhonnyBillM/orgs", "repos_url": "https://api.github.com/users/JhonnyBillM/repos", "events_url": "https://api.github.com/users/JhonnyBillM/events{/privacy}", "received_events_url": "https://api.github.com/users/JhonnyBillM/received_events", "type": "User", "site_admin": false}, "committer": {"login": "JhonnyBillM", "id": 18747072, "node_id": "MDQ6VXNlcjE4NzQ3MDcy", "avatar_url": "https://avatars.githubusercontent.com/u/18747072?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JhonnyBillM", "html_url": "https://github.com/JhonnyBillM", "followers_url": "https://api.github.com/users/JhonnyBillM/followers", "following_url": "https://api.github.com/users/JhonnyBillM/following{/other_user}", "gists_url": "https://api.github.com/users/JhonnyBillM/gists{/gist_id}", "starred_url": "https://api.github.com/users/JhonnyBillM/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JhonnyBillM/subscriptions", "organizations_url": "https://api.github.com/users/JhonnyBillM/orgs", "repos_url": "https://api.github.com/users/JhonnyBillM/repos", "events_url": "https://api.github.com/users/JhonnyBillM/events{/privacy}", "received_events_url": "https://api.github.com/users/JhonnyBillM/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "191fac68266b73158ff048c83556ea91cbf977fd", "url": "https://api.github.com/repos/rust-lang/rust/commits/191fac68266b73158ff048c83556ea91cbf977fd", "html_url": "https://github.com/rust-lang/rust/commit/191fac68266b73158ff048c83556ea91cbf977fd"}], "stats": {"total": 968, "additions": 484, "deletions": 484}, "files": [{"sha": "6dbb2582a37c2cf3b507b87d331b5c473db48f28", "filename": "compiler/rustc_ast_lowering/src/errors.rs", "status": "modified", "additions": 33, "deletions": 33, "changes": 66, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_ast_lowering%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_ast_lowering%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,8 +1,8 @@\n use rustc_errors::{fluent, AddToDiagnostic, Applicability, Diagnostic, DiagnosticArgFromDisplay};\n-use rustc_macros::{DiagnosticHandler, SessionSubdiagnostic};\n+use rustc_macros::{Diagnostic, SessionSubdiagnostic};\n use rustc_span::{symbol::Ident, Span, Symbol};\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::generic_type_with_parentheses, code = \"E0214\")]\n pub struct GenericTypeWithParentheses {\n     #[primary_span]\n@@ -28,7 +28,7 @@ impl AddToDiagnostic for UseAngleBrackets {\n     }\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[help]\n #[diag(ast_lowering::invalid_abi, code = \"E0703\")]\n pub struct InvalidAbi {\n@@ -39,7 +39,7 @@ pub struct InvalidAbi {\n     pub valid_abis: String,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::assoc_ty_parentheses)]\n pub struct AssocTyParentheses {\n     #[primary_span]\n@@ -71,38 +71,38 @@ impl AddToDiagnostic for AssocTyParenthesesSub {\n     }\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(ast_lowering::misplaced_impl_trait, code = \"E0562\")]\n pub struct MisplacedImplTrait<'a> {\n     #[primary_span]\n     pub span: Span,\n     pub position: DiagnosticArgFromDisplay<'a>,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::rustc_box_attribute_error)]\n pub struct RustcBoxAttributeError {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::underscore_expr_lhs_assign)]\n pub struct UnderscoreExprLhsAssign {\n     #[primary_span]\n     #[label]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::base_expression_double_dot)]\n pub struct BaseExpressionDoubleDot {\n     #[primary_span]\n     #[label]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::await_only_in_async_fn_and_blocks, code = \"E0728\")]\n pub struct AwaitOnlyInAsyncFnAndBlocks {\n     #[primary_span]\n@@ -112,58 +112,58 @@ pub struct AwaitOnlyInAsyncFnAndBlocks {\n     pub item_span: Option<Span>,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::generator_too_many_parameters, code = \"E0628\")]\n pub struct GeneratorTooManyParameters {\n     #[primary_span]\n     pub fn_decl_span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::closure_cannot_be_static, code = \"E0697\")]\n pub struct ClosureCannotBeStatic {\n     #[primary_span]\n     pub fn_decl_span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[help]\n #[diag(ast_lowering::async_non_move_closure_not_supported, code = \"E0708\")]\n pub struct AsyncNonMoveClosureNotSupported {\n     #[primary_span]\n     pub fn_decl_span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::functional_record_update_destructuring_assignment)]\n pub struct FunctionalRecordUpdateDestructuringAssignemnt {\n     #[primary_span]\n     #[suggestion(code = \"\", applicability = \"machine-applicable\")]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::async_generators_not_supported, code = \"E0727\")]\n pub struct AsyncGeneratorsNotSupported {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::inline_asm_unsupported_target, code = \"E0472\")]\n pub struct InlineAsmUnsupportedTarget {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::att_syntax_only_x86)]\n pub struct AttSyntaxOnlyX86 {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::abi_specified_multiple_times)]\n pub struct AbiSpecifiedMultipleTimes {\n     #[primary_span]\n@@ -175,14 +175,14 @@ pub struct AbiSpecifiedMultipleTimes {\n     pub equivalent: Option<()>,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::clobber_abi_not_supported)]\n pub struct ClobberAbiNotSupported {\n     #[primary_span]\n     pub abi_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[note]\n #[diag(ast_lowering::invalid_abi_clobber_abi)]\n pub struct InvalidAbiClobberAbi {\n@@ -191,7 +191,7 @@ pub struct InvalidAbiClobberAbi {\n     pub supported_abis: String,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::invalid_register)]\n pub struct InvalidRegister<'a> {\n     #[primary_span]\n@@ -200,7 +200,7 @@ pub struct InvalidRegister<'a> {\n     pub error: &'a str,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::invalid_register_class)]\n pub struct InvalidRegisterClass<'a> {\n     #[primary_span]\n@@ -209,7 +209,7 @@ pub struct InvalidRegisterClass<'a> {\n     pub error: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(ast_lowering::invalid_asm_template_modifier_reg_class)]\n pub struct InvalidAsmTemplateModifierRegClass {\n     #[primary_span]\n@@ -229,7 +229,7 @@ pub enum InvalidAsmTemplateModifierRegClassSub {\n     DoesNotSupportModifier { class_name: Symbol },\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::invalid_asm_template_modifier_const)]\n pub struct InvalidAsmTemplateModifierConst {\n     #[primary_span]\n@@ -239,7 +239,7 @@ pub struct InvalidAsmTemplateModifierConst {\n     pub op_span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::invalid_asm_template_modifier_sym)]\n pub struct InvalidAsmTemplateModifierSym {\n     #[primary_span]\n@@ -249,15 +249,15 @@ pub struct InvalidAsmTemplateModifierSym {\n     pub op_span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::register_class_only_clobber)]\n pub struct RegisterClassOnlyClobber {\n     #[primary_span]\n     pub op_span: Span,\n     pub reg_class_name: Symbol,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::register_conflict)]\n pub struct RegisterConflict<'a> {\n     #[primary_span]\n@@ -271,7 +271,7 @@ pub struct RegisterConflict<'a> {\n     pub in_out: Option<Span>,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[help]\n #[diag(ast_lowering::sub_tuple_binding)]\n pub struct SubTupleBinding<'a> {\n@@ -288,7 +288,7 @@ pub struct SubTupleBinding<'a> {\n     pub ctx: &'a str,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::extra_double_dot)]\n pub struct ExtraDoubleDot<'a> {\n     #[primary_span]\n@@ -299,36 +299,36 @@ pub struct ExtraDoubleDot<'a> {\n     pub ctx: &'a str,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[note]\n #[diag(ast_lowering::misplaced_double_dot)]\n pub struct MisplacedDoubleDot {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::misplaced_relax_trait_bound)]\n pub struct MisplacedRelaxTraitBound {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::not_supported_for_lifetime_binder_async_closure)]\n pub struct NotSupportedForLifetimeBinderAsyncClosure {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::arbitrary_expression_in_pattern)]\n pub struct ArbitraryExpressionInPattern {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler, Clone, Copy)]\n+#[derive(Diagnostic, Clone, Copy)]\n #[diag(ast_lowering::inclusive_range_with_no_end)]\n pub struct InclusiveRangeWithNoEnd {\n     #[primary_span]"}, {"sha": "5e8f9b7985054315c215edd5c313d6b272e63274", "filename": "compiler/rustc_attr/src/session_diagnostics.rs", "status": "modified", "additions": 30, "deletions": 30, "changes": 60, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_attr%2Fsrc%2Fsession_diagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_attr%2Fsrc%2Fsession_diagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_attr%2Fsrc%2Fsession_diagnostics.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -5,19 +5,19 @@ use rustc_errors::{\n     error_code, fluent, Applicability, DiagnosticBuilder, IntoDiagnostic, ErrorGuaranteed,\n     Handler,\n };\n-use rustc_macros::DiagnosticHandler;\n+use rustc_macros::Diagnostic;\n use rustc_span::{Span, Symbol};\n \n use crate::UnsupportedLiteralReason;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::expected_one_cfg_pattern, code = \"E0536\")]\n pub(crate) struct ExpectedOneCfgPattern {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::invalid_predicate, code = \"E0537\")]\n pub(crate) struct InvalidPredicate {\n     #[primary_span]\n@@ -26,7 +26,7 @@ pub(crate) struct InvalidPredicate {\n     pub predicate: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::multiple_item, code = \"E0538\")]\n pub(crate) struct MultipleItem {\n     #[primary_span]\n@@ -35,7 +35,7 @@ pub(crate) struct MultipleItem {\n     pub item: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::incorrect_meta_item, code = \"E0539\")]\n pub(crate) struct IncorrectMetaItem {\n     #[primary_span]\n@@ -65,28 +65,28 @@ impl<'a> IntoDiagnostic<'a> for UnknownMetaItem<'_> {\n     }\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::missing_since, code = \"E0542\")]\n pub(crate) struct MissingSince {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::missing_note, code = \"E0543\")]\n pub(crate) struct MissingNote {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::multiple_stability_levels, code = \"E0544\")]\n pub(crate) struct MultipleStabilityLevels {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::invalid_issue_string, code = \"E0545\")]\n pub(crate) struct InvalidIssueString {\n     #[primary_span]\n@@ -144,21 +144,21 @@ impl InvalidIssueStringCause {\n     }\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::missing_feature, code = \"E0546\")]\n pub(crate) struct MissingFeature {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::non_ident_feature, code = \"E0546\")]\n pub(crate) struct NonIdentFeature {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::missing_issue, code = \"E0547\")]\n pub(crate) struct MissingIssue {\n     #[primary_span]\n@@ -167,7 +167,7 @@ pub(crate) struct MissingIssue {\n \n // FIXME: This diagnostic is identical to `IncorrectMetaItem`, barring the error code. Consider\n // changing this to `IncorrectMetaItem`. See #51489.\n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::incorrect_meta_item, code = \"E0551\")]\n pub(crate) struct IncorrectMetaItem2 {\n     #[primary_span]\n@@ -176,14 +176,14 @@ pub(crate) struct IncorrectMetaItem2 {\n \n // FIXME: Why is this the same error code as `InvalidReprHintNoParen` and `InvalidReprHintNoValue`?\n // It is more similar to `IncorrectReprFormatGeneric`.\n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::incorrect_repr_format_packed_one_or_zero_arg, code = \"E0552\")]\n pub(crate) struct IncorrectReprFormatPackedOneOrZeroArg {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::invalid_repr_hint_no_paren, code = \"E0552\")]\n pub(crate) struct InvalidReprHintNoParen {\n     #[primary_span]\n@@ -192,7 +192,7 @@ pub(crate) struct InvalidReprHintNoParen {\n     pub name: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::invalid_repr_hint_no_value, code = \"E0552\")]\n pub(crate) struct InvalidReprHintNoValue {\n     #[primary_span]\n@@ -237,15 +237,15 @@ impl<'a> IntoDiagnostic<'a> for UnsupportedLiteral {\n     }\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::invalid_repr_align_need_arg, code = \"E0589\")]\n pub(crate) struct InvalidReprAlignNeedArg {\n     #[primary_span]\n     #[suggestion(code = \"align(...)\", applicability = \"has-placeholders\")]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::invalid_repr_generic, code = \"E0589\")]\n pub(crate) struct InvalidReprGeneric<'a> {\n     #[primary_span]\n@@ -255,14 +255,14 @@ pub(crate) struct InvalidReprGeneric<'a> {\n     pub error_part: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::incorrect_repr_format_align_one_arg, code = \"E0693\")]\n pub(crate) struct IncorrectReprFormatAlignOneArg {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::incorrect_repr_format_generic, code = \"E0693\")]\n pub(crate) struct IncorrectReprFormatGeneric<'a> {\n     #[primary_span]\n@@ -317,28 +317,28 @@ impl<'a> IncorrectReprFormatGenericCause<'a> {\n     }\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::rustc_promotable_pairing, code = \"E0717\")]\n pub(crate) struct RustcPromotablePairing {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::rustc_allowed_unstable_pairing, code = \"E0789\")]\n pub(crate) struct RustcAllowedUnstablePairing {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::cfg_predicate_identifier)]\n pub(crate) struct CfgPredicateIdentifier {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::deprecated_item_suggestion)]\n pub(crate) struct DeprecatedItemSuggestion {\n     #[primary_span]\n@@ -351,21 +351,21 @@ pub(crate) struct DeprecatedItemSuggestion {\n     pub details: (),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::expected_single_version_literal)]\n pub(crate) struct ExpectedSingleVersionLiteral {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::expected_version_literal)]\n pub(crate) struct ExpectedVersionLiteral {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::expects_feature_list)]\n pub(crate) struct ExpectsFeatureList {\n     #[primary_span]\n@@ -374,7 +374,7 @@ pub(crate) struct ExpectsFeatureList {\n     pub name: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::expects_features)]\n pub(crate) struct ExpectsFeatures {\n     #[primary_span]\n@@ -383,14 +383,14 @@ pub(crate) struct ExpectsFeatures {\n     pub name: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::soft_no_args)]\n pub(crate) struct SoftNoArgs {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(attr::unknown_version_literal)]\n pub(crate) struct UnknownVersionLiteral {\n     #[primary_span]"}, {"sha": "aa8f26eece5024d61170fab548c73f941e835073", "filename": "compiler/rustc_borrowck/src/session_diagnostics.rs", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_borrowck%2Fsrc%2Fsession_diagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_borrowck%2Fsrc%2Fsession_diagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Fsession_diagnostics.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,11 +1,11 @@\n use rustc_errors::{IntoDiagnosticArg, MultiSpan};\n-use rustc_macros::{DiagnosticHandler, LintDiagnostic, SessionSubdiagnostic};\n+use rustc_macros::{Diagnostic, LintDiagnostic, SessionSubdiagnostic};\n use rustc_middle::ty::Ty;\n use rustc_span::Span;\n \n use crate::diagnostics::RegionName;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(borrowck::move_unsized, code = \"E0161\")]\n pub(crate) struct MoveUnsized<'tcx> {\n     pub ty: Ty<'tcx>,\n@@ -14,7 +14,7 @@ pub(crate) struct MoveUnsized<'tcx> {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(borrowck::higher_ranked_lifetime_error)]\n pub(crate) struct HigherRankedLifetimeError {\n     #[subdiagnostic]\n@@ -31,14 +31,14 @@ pub(crate) enum HigherRankedErrorCause {\n     CouldNotNormalize { value: String },\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(borrowck::higher_ranked_subtype_error)]\n pub(crate) struct HigherRankedSubtypeError {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(borrowck::generic_does_not_live_long_enough)]\n pub(crate) struct GenericDoesNotLiveLongEnough {\n     pub kind: String,\n@@ -53,15 +53,15 @@ pub(crate) struct VarNeedNotMut {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(borrowck::const_not_used_in_type_alias)]\n pub(crate) struct ConstNotUsedTraitAlias {\n     pub ct: String,\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(borrowck::var_cannot_escape_closure)]\n #[note]\n #[note(borrowck::cannot_escape)]\n@@ -110,7 +110,7 @@ pub(crate) enum FnMutReturnTypeErr {\n     },\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(borrowck::lifetime_constraints_error)]\n pub(crate) struct LifetimeOutliveErr {\n     #[primary_span]"}, {"sha": "46b54eae384990e8a3792c82ca5cca5f85867289", "filename": "compiler/rustc_builtin_macros/src/cfg.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_builtin_macros%2Fsrc%2Fcfg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_builtin_macros%2Fsrc%2Fcfg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_builtin_macros%2Fsrc%2Fcfg.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -8,7 +8,7 @@ use rustc_ast::tokenstream::TokenStream;\n use rustc_attr as attr;\n use rustc_errors::PResult;\n use rustc_expand::base::{self, *};\n-use rustc_macros::DiagnosticHandler;\n+use rustc_macros::Diagnostic;\n use rustc_span::Span;\n \n pub fn expand_cfg(\n@@ -35,15 +35,15 @@ pub fn expand_cfg(\n     }\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(builtin_macros::requires_cfg_pattern)]\n struct RequiresCfgPattern {\n     #[primary_span]\n     #[label]\n     span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(builtin_macros::expected_one_cfg_pattern)]\n struct OneCfgPattern {\n     #[primary_span]"}, {"sha": "c6cb7a8b961ffbe9d7ea0742173ac0d465d85430", "filename": "compiler/rustc_const_eval/src/errors.rs", "status": "modified", "additions": 22, "deletions": 22, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_const_eval%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_const_eval%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_const_eval%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,8 +1,8 @@\n use rustc_hir::ConstContext;\n-use rustc_macros::DiagnosticHandler;\n+use rustc_macros::Diagnostic;\n use rustc_span::Span;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::unstable_in_stable)]\n pub(crate) struct UnstableInStable {\n     pub gate: String,\n@@ -21,14 +21,14 @@ pub(crate) struct UnstableInStable {\n     pub attr_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::thread_local_access, code = \"E0625\")]\n pub(crate) struct NonConstOpErr {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::static_access, code = \"E0013\")]\n #[help]\n pub(crate) struct StaticAccessErr {\n@@ -40,7 +40,7 @@ pub(crate) struct StaticAccessErr {\n     pub teach: Option<()>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::raw_ptr_to_int)]\n #[note]\n #[note(const_eval::note2)]\n@@ -49,70 +49,70 @@ pub(crate) struct RawPtrToIntErr {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::raw_ptr_comparison)]\n #[note]\n pub(crate) struct RawPtrComparisonErr {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::panic_non_str)]\n pub(crate) struct PanicNonStrErr {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::mut_deref, code = \"E0658\")]\n pub(crate) struct MutDerefErr {\n     #[primary_span]\n     pub span: Span,\n     pub kind: ConstContext,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::transient_mut_borrow, code = \"E0658\")]\n pub(crate) struct TransientMutBorrowErr {\n     #[primary_span]\n     pub span: Span,\n     pub kind: ConstContext,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::transient_mut_borrow_raw, code = \"E0658\")]\n pub(crate) struct TransientMutBorrowErrRaw {\n     #[primary_span]\n     pub span: Span,\n     pub kind: ConstContext,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::max_num_nodes_in_const)]\n pub(crate) struct MaxNumNodesInConstErr {\n     #[primary_span]\n     pub span: Span,\n     pub global_const_id: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::unallowed_fn_pointer_call)]\n pub(crate) struct UnallowedFnPointerCall {\n     #[primary_span]\n     pub span: Span,\n     pub kind: ConstContext,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::unstable_const_fn)]\n pub(crate) struct UnstableConstFn {\n     #[primary_span]\n     pub span: Span,\n     pub def_path: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::unallowed_mutable_refs, code = \"E0764\")]\n pub(crate) struct UnallowedMutableRefs {\n     #[primary_span]\n@@ -122,7 +122,7 @@ pub(crate) struct UnallowedMutableRefs {\n     pub teach: Option<()>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::unallowed_mutable_refs_raw, code = \"E0764\")]\n pub(crate) struct UnallowedMutableRefsRaw {\n     #[primary_span]\n@@ -131,15 +131,15 @@ pub(crate) struct UnallowedMutableRefsRaw {\n     #[note(const_eval::teach_note)]\n     pub teach: Option<()>,\n }\n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::non_const_fmt_macro_call, code = \"E0015\")]\n pub(crate) struct NonConstFmtMacroCall {\n     #[primary_span]\n     pub span: Span,\n     pub kind: ConstContext,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::non_const_fn_call, code = \"E0015\")]\n pub(crate) struct NonConstFnCall {\n     #[primary_span]\n@@ -148,15 +148,15 @@ pub(crate) struct NonConstFnCall {\n     pub kind: ConstContext,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::unallowed_op_in_const_context)]\n pub(crate) struct UnallowedOpInConstContext {\n     #[primary_span]\n     pub span: Span,\n     pub msg: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::unallowed_heap_allocations, code = \"E0010\")]\n pub(crate) struct UnallowedHeapAllocations {\n     #[primary_span]\n@@ -167,15 +167,15 @@ pub(crate) struct UnallowedHeapAllocations {\n     pub teach: Option<()>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::unallowed_inline_asm, code = \"E0015\")]\n pub(crate) struct UnallowedInlineAsm {\n     #[primary_span]\n     pub span: Span,\n     pub kind: ConstContext,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::interior_mutable_data_refer, code = \"E0492\")]\n pub(crate) struct InteriorMutableDataRefer {\n     #[primary_span]\n@@ -188,7 +188,7 @@ pub(crate) struct InteriorMutableDataRefer {\n     pub teach: Option<()>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(const_eval::interior_mutability_borrow)]\n pub(crate) struct InteriorMutabilityBorrow {\n     #[primary_span]"}, {"sha": "289baf17773731e0891dc26f99e825987c887d21", "filename": "compiler/rustc_driver/src/session_diagnostics.rs", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_driver%2Fsrc%2Fsession_diagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_driver%2Fsrc%2Fsession_diagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_driver%2Fsrc%2Fsession_diagnostics.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,38 +1,38 @@\n-use rustc_macros::DiagnosticHandler;\n+use rustc_macros::Diagnostic;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(driver::rlink_unable_to_read)]\n pub(crate) struct RlinkUnableToRead {\n     pub err: std::io::Error,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(driver::rlink_wrong_file_type)]\n pub(crate) struct RLinkWrongFileType;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(driver::rlink_empty_version_number)]\n pub(crate) struct RLinkEmptyVersionNumber;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(driver::rlink_encoding_version_mismatch)]\n pub(crate) struct RLinkEncodingVersionMismatch {\n     pub version_array: String,\n     pub rlink_version: u32,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(driver::rlink_rustc_version_mismatch)]\n pub(crate) struct RLinkRustcVersionMismatch<'a> {\n     pub rustc_version: String,\n     pub current_version: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(driver::rlink_no_a_file)]\n pub(crate) struct RlinkNotAFile;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(driver::unpretty_dump_fail)]\n pub(crate) struct UnprettyDumpFail {\n     pub path: String,"}, {"sha": "f9b46053486bcb3a976085c5e6253feae14b072e", "filename": "compiler/rustc_errors/src/diagnostic_builder.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_errors%2Fsrc%2Fdiagnostic_builder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_errors%2Fsrc%2Fdiagnostic_builder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_errors%2Fsrc%2Fdiagnostic_builder.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -14,9 +14,9 @@ use std::ops::{Deref, DerefMut};\n use std::thread::panicking;\n \n /// Trait implemented by error types. This should not be implemented manually. Instead, use\n-/// `#[derive(DiagnosticHandler)]` -- see [rustc_macros::DiagnosticHandler].\n+/// `#[derive(Diagnostic)]` -- see [rustc_macros::Diagnostic].\n #[cfg_attr(bootstrap, rustc_diagnostic_item = \"SessionDiagnostic\")]\n-#[cfg_attr(not(bootstrap), rustc_diagnostic_item = \"DiagnosticHandler\")]\n+#[cfg_attr(not(bootstrap), rustc_diagnostic_item = \"Diagnostic\")]\n pub trait IntoDiagnostic<'a, T: EmissionGuarantee = ErrorGuaranteed> {\n     /// Write out as a diagnostic out of `Handler`.\n     #[must_use]"}, {"sha": "bd93f0717f5801f7df0aa410faf9dedb7729870b", "filename": "compiler/rustc_expand/src/errors.rs", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_expand%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_expand%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_expand%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,45 +1,45 @@\n-use rustc_macros::DiagnosticHandler;\n+use rustc_macros::Diagnostic;\n use rustc_span::symbol::MacroRulesNormalizedIdent;\n use rustc_span::Span;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(expand::expr_repeat_no_syntax_vars)]\n pub(crate) struct NoSyntaxVarsExprRepeat {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(expand::must_repeat_once)]\n pub(crate) struct MustRepeatOnce {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(expand::count_repetition_misplaced)]\n pub(crate) struct CountRepetitionMisplaced {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(expand::meta_var_expr_unrecognized_var)]\n pub(crate) struct MetaVarExprUnrecognizedVar {\n     #[primary_span]\n     pub span: Span,\n     pub key: MacroRulesNormalizedIdent,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(expand::var_still_repeating)]\n pub(crate) struct VarStillRepeating {\n     #[primary_span]\n     pub span: Span,\n     pub ident: MacroRulesNormalizedIdent,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(expand::meta_var_dif_seq_matchers)]\n pub(crate) struct MetaVarsDifSeqMatchers {\n     #[primary_span]"}, {"sha": "097640f26c154a2f9216ec1c775a64a95d12f6d6", "filename": "compiler/rustc_interface/src/errors.rs", "status": "modified", "additions": 15, "deletions": 15, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_interface%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_interface%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_interface%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,10 +1,10 @@\n-use rustc_macros::DiagnosticHandler;\n+use rustc_macros::Diagnostic;\n use rustc_span::{Span, Symbol};\n \n use std::io;\n use std::path::Path;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(interface::ferris_identifier)]\n pub struct FerrisIdentifier {\n     #[primary_span]\n@@ -13,75 +13,75 @@ pub struct FerrisIdentifier {\n     pub first_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(interface::emoji_identifier)]\n pub struct EmojiIdentifier {\n     #[primary_span]\n     pub spans: Vec<Span>,\n     pub ident: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(interface::mixed_bin_crate)]\n pub struct MixedBinCrate;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(interface::mixed_proc_macro_crate)]\n pub struct MixedProcMacroCrate;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(interface::proc_macro_doc_without_arg)]\n pub struct ProcMacroDocWithoutArg;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(interface::error_writing_dependencies)]\n pub struct ErrorWritingDependencies<'a> {\n     pub path: &'a Path,\n     pub error: io::Error,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(interface::input_file_would_be_overwritten)]\n pub struct InputFileWouldBeOverWritten<'a> {\n     pub path: &'a Path,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(interface::generated_file_conflicts_with_directory)]\n pub struct GeneratedFileConflictsWithDirectory<'a> {\n     pub input_path: &'a Path,\n     pub dir_path: &'a Path,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(interface::temps_dir_error)]\n pub struct TempsDirError;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(interface::out_dir_error)]\n pub struct OutDirError;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(interface::cant_emit_mir)]\n pub struct CantEmitMIR {\n     pub error: io::Error,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(interface::rustc_error_fatal)]\n pub struct RustcErrorFatal {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(interface::rustc_error_unexpected_annotation)]\n pub struct RustcErrorUnexpectedAnnotation {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(interface::failed_writing_file)]\n pub struct FailedWritingFile<'a> {\n     pub path: &'a Path,"}, {"sha": "0c66ce475c41f006051072a77e7effa874c4d305", "filename": "compiler/rustc_lint/src/errors.rs", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_lint%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_lint%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,9 +1,9 @@\n use rustc_errors::{fluent, AddToDiagnostic, IntoDiagnostic, ErrorGuaranteed, Handler};\n-use rustc_macros::{DiagnosticHandler, SessionSubdiagnostic};\n+use rustc_macros::{Diagnostic, SessionSubdiagnostic};\n use rustc_session::lint::Level;\n use rustc_span::{Span, Symbol};\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(lint::overruled_attribute, code = \"E0453\")]\n pub struct OverruledAttribute {\n     #[primary_span]\n@@ -42,7 +42,7 @@ impl AddToDiagnostic for OverruledAttributeSub {\n     }\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(lint::malformed_attribute, code = \"E0452\")]\n pub struct MalformedAttribute {\n     #[primary_span]\n@@ -61,7 +61,7 @@ pub enum MalformedAttributeSub {\n     ReasonMustComeLast(#[primary_span] Span),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(lint::unknown_tool_in_scoped_lint, code = \"E0710\")]\n pub struct UnknownToolInScopedLint {\n     #[primary_span]\n@@ -72,7 +72,7 @@ pub struct UnknownToolInScopedLint {\n     pub is_nightly_build: Option<()>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(lint::builtin_ellipsis_inclusive_range_patterns, code = \"E0783\")]\n pub struct BuiltinEllpisisInclusiveRangePatterns {\n     #[primary_span]\n@@ -107,7 +107,7 @@ impl AddToDiagnostic for RequestedLevel {\n     }\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(lint::unsupported_group, code = \"E0602\")]\n pub struct UnsupportedGroup {\n     pub lint_group: String,\n@@ -136,23 +136,23 @@ impl IntoDiagnostic<'_> for CheckNameUnknown {\n     }\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(lint::check_name_unknown_tool, code = \"E0602\")]\n pub struct CheckNameUnknownTool {\n     pub tool_name: Symbol,\n     #[subdiagnostic]\n     pub sub: RequestedLevel,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(lint::check_name_warning)]\n pub struct CheckNameWarning {\n     pub msg: String,\n     #[subdiagnostic]\n     pub sub: RequestedLevel,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(lint::check_name_deprecated)]\n pub struct CheckNameDeprecated {\n     pub lint_name: String,"}, {"sha": "36d8ade22ae790f4cdd7c240668beedf1710d562", "filename": "compiler/rustc_lint/src/internal.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_lint%2Fsrc%2Finternal.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_lint%2Fsrc%2Finternal.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Finternal.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -372,7 +372,7 @@ declare_tool_lint! {\n declare_tool_lint! {\n     pub rustc::DIAGNOSTIC_OUTSIDE_OF_IMPL,\n     Allow,\n-    \"prevent creation of diagnostics outside of `DiagnosticHandler`/`AddToDiagnostic` impls\",\n+    \"prevent creation of diagnostics outside of `IntoDiagnostic`/`AddToDiagnostic` impls\",\n     report_in_external_macro: true\n }\n \n@@ -404,7 +404,7 @@ impl LateLintPass<'_> for Diagnostics {\n                 let Impl { of_trait: Some(of_trait), .. } = impl_ &&\n                 let Some(def_id) = of_trait.trait_def_id() &&\n                 let Some(name) = cx.tcx.get_diagnostic_name(def_id) &&\n-                matches!(name, sym::DiagnosticHandler | sym::AddSubdiagnostic | sym::DecorateLint)\n+                matches!(name, sym::Diagnostic | sym::AddSubdiagnostic | sym::DecorateLint)\n             {\n                 found_impl = true;\n                 break;"}, {"sha": "c1aae04fceeb978dc9720021ac9b97110d0af922", "filename": "compiler/rustc_macros/src/diagnostics/diagnostic.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_macros%2Fsrc%2Fdiagnostics%2Fdiagnostic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_macros%2Fsrc%2Fdiagnostics%2Fdiagnostic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_macros%2Fsrc%2Fdiagnostics%2Fdiagnostic.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -21,7 +21,7 @@ impl<'a> SessionDiagnosticDerive<'a> {\n             builder: DiagnosticDeriveBuilder {\n                 diag,\n                 fields: build_field_mapping(&structure),\n-                kind: DiagnosticDeriveKind::DiagnosticHandler,\n+                kind: DiagnosticDeriveKind::Diagnostic,\n                 code: None,\n                 slug: None,\n             },\n@@ -72,7 +72,7 @@ impl<'a> SessionDiagnosticDerive<'a> {\n             } else {\n                 span_err(\n                     ast.span().unwrap(),\n-                    \"`#[derive(DiagnosticHandler)]` can only be used on structs\",\n+                    \"`#[derive(Diagnostic)]` can only be used on structs\",\n                 )\n                 .emit();\n "}, {"sha": "32d6ba62a0d3e3f3eefa1c2aa5f6f28c52cdc432", "filename": "compiler/rustc_macros/src/diagnostics/diagnostic_builder.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_macros%2Fsrc%2Fdiagnostics%2Fdiagnostic_builder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_macros%2Fsrc%2Fdiagnostics%2Fdiagnostic_builder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_macros%2Fsrc%2Fdiagnostics%2Fdiagnostic_builder.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -21,12 +21,12 @@ use synstructure::{BindingInfo, Structure};\n /// What kind of diagnostic is being derived - a fatal/error/warning or a lint?\n #[derive(Copy, Clone, PartialEq, Eq)]\n pub(crate) enum DiagnosticDeriveKind {\n-    DiagnosticHandler,\n+    Diagnostic,\n     LintDiagnostic,\n }\n \n /// Tracks persistent information required for building up individual calls to diagnostic methods\n-/// for generated diagnostic derives - both `DiagnosticHandler` for fatal/errors/warnings and\n+/// for generated diagnostic derives - both `Diagnostic` for fatal/errors/warnings and\n /// `LintDiagnostic` for lints.\n pub(crate) struct DiagnosticDeriveBuilder {\n     /// The identifier to use for the generated `DiagnosticBuilder` instance.\n@@ -333,7 +333,7 @@ impl DiagnosticDeriveBuilder {\n             }\n             \"primary_span\" => {\n                 match self.kind {\n-                    DiagnosticDeriveKind::DiagnosticHandler => {\n+                    DiagnosticDeriveKind::Diagnostic => {\n                         report_error_if_not_applied_to_span(attr, &info)?;\n \n                         Ok(quote! {"}, {"sha": "1d5b32c2556fab7273bc70f83d5a1043d95044a2", "filename": "compiler/rustc_macros/src/diagnostics/mod.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_macros%2Fsrc%2Fdiagnostics%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_macros%2Fsrc%2Fdiagnostics%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_macros%2Fsrc%2Fdiagnostics%2Fmod.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -12,7 +12,7 @@ use quote::format_ident;\n use subdiagnostic::SessionSubdiagnosticDerive;\n use synstructure::Structure;\n \n-/// Implements `#[derive(DiagnosticHandler)]`, which allows for errors to be specified as a struct,\n+/// Implements `#[derive(Diagnostic)]`, which allows for errors to be specified as a struct,\n /// independent from the actual diagnostics emitting code.\n ///\n /// ```ignore (rust)\n@@ -22,7 +22,7 @@ use synstructure::Structure;\n /// # use rustc_span::{symbol::Ident, Span};\n /// # extern crate rust_middle;\n /// # use rustc_middle::ty::Ty;\n-/// #[derive(DiagnosticHandler)]\n+/// #[derive(Diagnostic)]\n /// #[diag(borrowck::move_out_of_borrow, code = \"E0505\")]\n /// pub struct MoveOutOfBorrowError<'tcx> {\n ///     pub name: Ident,\n@@ -56,7 +56,7 @@ use synstructure::Structure;\n /// });\n /// ```\n ///\n-/// See rustc dev guide for more examples on using the `#[derive(DiagnosticHandler)]`:\n+/// See rustc dev guide for more examples on using the `#[derive(Diagnostic)]`:\n /// <https://rustc-dev-guide.rust-lang.org/diagnostics/diagnostic-structs.html>\n pub fn session_diagnostic_derive(s: Structure<'_>) -> TokenStream {\n     SessionDiagnosticDerive::new(format_ident!(\"diag\"), format_ident!(\"handler\"), s).into_tokens()"}, {"sha": "9dd7ccad8bb5b0841363f9b9f63e29f9b116ba5b", "filename": "compiler/rustc_macros/src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_macros%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_macros%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_macros%2Fsrc%2Flib.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -127,7 +127,7 @@ decl_derive!([TypeFoldable, attributes(type_foldable)] => type_foldable::type_fo\n decl_derive!([TypeVisitable, attributes(type_visitable)] => type_visitable::type_visitable_derive);\n decl_derive!([Lift, attributes(lift)] => lift::lift_derive);\n decl_derive!(\n-    [DiagnosticHandler, attributes(\n+    [Diagnostic, attributes(\n         // struct attributes\n         diag,\n         help,"}, {"sha": "8ff4eb5fdbc65d1e648e9b53dc4b3bf0b3352f73", "filename": "compiler/rustc_metadata/src/errors.rs", "status": "modified", "additions": 77, "deletions": 77, "changes": 154, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_metadata%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_metadata%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_metadata%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -4,135 +4,135 @@ use std::{\n };\n \n use rustc_errors::{error_code, IntoDiagnostic, ErrorGuaranteed};\n-use rustc_macros::DiagnosticHandler;\n+use rustc_macros::Diagnostic;\n use rustc_session::config;\n use rustc_span::{sym, Span, Symbol};\n use rustc_target::spec::{PanicStrategy, TargetTriple};\n \n use crate::locator::CrateFlavor;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::rlib_required)]\n pub struct RlibRequired {\n     pub crate_name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::lib_required)]\n pub struct LibRequired<'a> {\n     pub crate_name: Symbol,\n     pub kind: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::crate_dep_multiple)]\n #[help]\n pub struct CrateDepMultiple {\n     pub crate_name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::two_panic_runtimes)]\n pub struct TwoPanicRuntimes {\n     pub prev_name: Symbol,\n     pub cur_name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::bad_panic_strategy)]\n pub struct BadPanicStrategy {\n     pub runtime: Symbol,\n     pub strategy: PanicStrategy,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::required_panic_strategy)]\n pub struct RequiredPanicStrategy {\n     pub crate_name: Symbol,\n     pub found_strategy: PanicStrategy,\n     pub desired_strategy: PanicStrategy,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::incompatible_panic_in_drop_strategy)]\n pub struct IncompatiblePanicInDropStrategy {\n     pub crate_name: Symbol,\n     pub found_strategy: PanicStrategy,\n     pub desired_strategy: PanicStrategy,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::multiple_names_in_link)]\n pub struct MultipleNamesInLink {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::multiple_kinds_in_link)]\n pub struct MultipleKindsInLink {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::link_name_form)]\n pub struct LinkNameForm {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::link_kind_form)]\n pub struct LinkKindForm {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::link_modifiers_form)]\n pub struct LinkModifiersForm {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::link_cfg_form)]\n pub struct LinkCfgForm {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::wasm_import_form)]\n pub struct WasmImportForm {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::empty_link_name, code = \"E0454\")]\n pub struct EmptyLinkName {\n     #[primary_span]\n     #[label]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::link_framework_apple, code = \"E0455\")]\n pub struct LinkFrameworkApple {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::framework_only_windows, code = \"E0455\")]\n pub struct FrameworkOnlyWindows {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::unknown_link_kind, code = \"E0458\")]\n pub struct UnknownLinkKind<'a> {\n     #[primary_span]\n@@ -141,199 +141,199 @@ pub struct UnknownLinkKind<'a> {\n     pub kind: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::multiple_link_modifiers)]\n pub struct MultipleLinkModifiers {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::multiple_cfgs)]\n pub struct MultipleCfgs {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::link_cfg_single_predicate)]\n pub struct LinkCfgSinglePredicate {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::multiple_wasm_import)]\n pub struct MultipleWasmImport {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::unexpected_link_arg)]\n pub struct UnexpectedLinkArg {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::invalid_link_modifier)]\n pub struct InvalidLinkModifier {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::multiple_modifiers)]\n pub struct MultipleModifiers<'a> {\n     #[primary_span]\n     pub span: Span,\n     pub modifier: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::bundle_needs_static)]\n pub struct BundleNeedsStatic {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::whole_archive_needs_static)]\n pub struct WholeArchiveNeedsStatic {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::as_needed_compatibility)]\n pub struct AsNeededCompatibility {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::unknown_link_modifier)]\n pub struct UnknownLinkModifier<'a> {\n     #[primary_span]\n     pub span: Span,\n     pub modifier: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::incompatible_wasm_link)]\n pub struct IncompatibleWasmLink {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::link_requires_name, code = \"E0459\")]\n pub struct LinkRequiresName {\n     #[primary_span]\n     #[label]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::raw_dylib_no_nul)]\n pub struct RawDylibNoNul {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::link_ordinal_raw_dylib)]\n pub struct LinkOrdinalRawDylib {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::lib_framework_apple)]\n pub struct LibFrameworkApple;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::empty_renaming_target)]\n pub struct EmptyRenamingTarget<'a> {\n     pub lib_name: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::renaming_no_link)]\n pub struct RenamingNoLink<'a> {\n     pub lib_name: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::multiple_renamings)]\n pub struct MultipleRenamings<'a> {\n     pub lib_name: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::no_link_mod_override)]\n pub struct NoLinkModOverride {\n     #[primary_span]\n     pub span: Option<Span>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::unsupported_abi_i686)]\n pub struct UnsupportedAbiI686 {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::unsupported_abi)]\n pub struct UnsupportedAbi {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::fail_create_file_encoder)]\n pub struct FailCreateFileEncoder {\n     pub err: Error,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::fail_seek_file)]\n pub struct FailSeekFile {\n     pub err: Error,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::fail_write_file)]\n pub struct FailWriteFile {\n     pub err: Error,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::crate_not_panic_runtime)]\n pub struct CrateNotPanicRuntime {\n     pub crate_name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::no_panic_strategy)]\n pub struct NoPanicStrategy {\n     pub crate_name: Symbol,\n     pub strategy: PanicStrategy,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::profiler_builtins_needs_core)]\n pub struct ProfilerBuiltinsNeedsCore;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::not_profiler_runtime)]\n pub struct NotProfilerRuntime {\n     pub crate_name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::no_multiple_global_alloc)]\n pub struct NoMultipleGlobalAlloc {\n     #[primary_span]\n@@ -343,66 +343,66 @@ pub struct NoMultipleGlobalAlloc {\n     pub span1: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::conflicting_global_alloc)]\n pub struct ConflictingGlobalAlloc {\n     pub crate_name: Symbol,\n     pub other_crate_name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::global_alloc_required)]\n pub struct GlobalAllocRequired;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::no_transitive_needs_dep)]\n pub struct NoTransitiveNeedsDep<'a> {\n     pub crate_name: Symbol,\n     pub needs_crate_name: &'a str,\n     pub deps_crate_name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::failed_write_error)]\n pub struct FailedWriteError {\n     pub filename: PathBuf,\n     pub err: Error,\n }\n \n-#[derive(SessionDiagnostic)]\n+#[derive(Diagnostic)]\n #[diag(metadata::missing_native_library)]\n pub struct MissingNativeLibrary<'a> {\n     pub libname: &'a str,\n }\n \n-#[derive(SessionDiagnostic)]\n+#[derive(Diagnostic)]\n #[diag(metadata::failed_create_tempdir)]\n pub struct FailedCreateTempdir {\n     pub err: Error,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::failed_create_file)]\n pub struct FailedCreateFile<'a> {\n     pub filename: &'a Path,\n     pub err: Error,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::failed_create_encoded_metadata)]\n pub struct FailedCreateEncodedMetadata {\n     pub err: Error,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::non_ascii_name)]\n pub struct NonAsciiName {\n     #[primary_span]\n     pub span: Span,\n     pub crate_name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::extern_location_not_exist)]\n pub struct ExternLocationNotExist<'a> {\n     #[primary_span]\n@@ -411,7 +411,7 @@ pub struct ExternLocationNotExist<'a> {\n     pub location: &'a Path,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::extern_location_not_file)]\n pub struct ExternLocationNotFile<'a> {\n     #[primary_span]\n@@ -444,7 +444,7 @@ impl IntoDiagnostic<'_> for MultipleCandidates {\n     }\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::multiple_matching_crates, code = \"E0464\")]\n #[note]\n pub struct MultipleMatchingCrates {\n@@ -454,23 +454,23 @@ pub struct MultipleMatchingCrates {\n     pub candidates: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::symbol_conflicts_current, code = \"E0519\")]\n pub struct SymbolConflictsCurrent {\n     #[primary_span]\n     pub span: Span,\n     pub crate_name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::symbol_conflicts_others, code = \"E0523\")]\n pub struct SymbolConflictsOthers {\n     #[primary_span]\n     pub span: Span,\n     pub crate_name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::stable_crate_id_collision)]\n pub struct StableCrateIdCollision {\n     #[primary_span]\n@@ -479,15 +479,15 @@ pub struct StableCrateIdCollision {\n     pub crate_name1: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::dl_error)]\n pub struct DlError {\n     #[primary_span]\n     pub span: Span,\n     pub err: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::newer_crate_version, code = \"E0460\")]\n #[note]\n #[note(metadata::found_crate_versions)]\n@@ -499,7 +499,7 @@ pub struct NewerCrateVersion {\n     pub found_crates: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::no_crate_with_triple, code = \"E0461\")]\n #[note(metadata::found_crate_versions)]\n pub struct NoCrateWithTriple<'a> {\n@@ -511,7 +511,7 @@ pub struct NoCrateWithTriple<'a> {\n     pub found_crates: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::found_staticlib, code = \"E0462\")]\n #[note(metadata::found_crate_versions)]\n #[help]\n@@ -523,7 +523,7 @@ pub struct FoundStaticlib {\n     pub found_crates: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::incompatible_rustc, code = \"E0514\")]\n #[note(metadata::found_crate_versions)]\n #[help]\n@@ -617,23 +617,23 @@ impl IntoDiagnostic<'_> for CannotFindCrate {\n     }\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::no_dylib_plugin, code = \"E0457\")]\n pub struct NoDylibPlugin {\n     #[primary_span]\n     pub span: Span,\n     pub crate_name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::crate_location_unknown_type)]\n pub struct CrateLocationUnknownType<'a> {\n     #[primary_span]\n     pub span: Span,\n     pub path: &'a Path,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::lib_filename_form)]\n pub struct LibFilenameForm<'a> {\n     #[primary_span]\n@@ -642,36 +642,36 @@ pub struct LibFilenameForm<'a> {\n     pub dll_suffix: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::multiple_import_name_type)]\n pub struct MultipleImportNameType {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::import_name_type_form)]\n pub struct ImportNameTypeForm {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::import_name_type_x86)]\n pub struct ImportNameTypeX86 {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::unknown_import_name_type)]\n pub struct UnknownImportNameType<'a> {\n     #[primary_span]\n     pub span: Span,\n     pub import_name_type: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(metadata::import_name_type_raw)]\n pub struct ImportNameTypeRaw {\n     #[primary_span]"}, {"sha": "6d15feb888a7304921de23dd29c7872543fd4e27", "filename": "compiler/rustc_middle/src/error.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_middle%2Fsrc%2Ferror.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_middle%2Fsrc%2Ferror.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Ferror.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,9 +1,9 @@\n-use rustc_macros::DiagnosticHandler;\n+use rustc_macros::Diagnostic;\n use rustc_span::Span;\n \n use crate::ty::Ty;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(middle::drop_check_overflow, code = \"E0320\")]\n #[note]\n pub struct DropCheckOverflow<'tcx> {\n@@ -13,7 +13,7 @@ pub struct DropCheckOverflow<'tcx> {\n     pub overflow_ty: Ty<'tcx>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(middle::opaque_hidden_type_mismatch)]\n pub struct OpaqueHiddenTypeMismatch<'tcx> {\n     pub self_ty: Ty<'tcx>,\n@@ -39,7 +39,7 @@ pub enum TypeMismatchReason {\n     },\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(middle::limit_invalid)]\n pub struct LimitInvalid<'a> {\n     #[primary_span]"}, {"sha": "5b1a88cb284507ee3d20fd9b23f1a47305057f7f", "filename": "compiler/rustc_mir_dataflow/src/errors.rs", "status": "modified", "additions": 11, "deletions": 11, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_mir_dataflow%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_mir_dataflow%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_dataflow%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,69 +1,69 @@\n-use rustc_macros::DiagnosticHandler;\n+use rustc_macros::Diagnostic;\n use rustc_span::{Span, Symbol};\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(mir_dataflow::path_must_end_in_filename)]\n pub(crate) struct PathMustEndInFilename {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(mir_dataflow::unknown_formatter)]\n pub(crate) struct UnknownFormatter {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(mir_dataflow::duplicate_values_for)]\n pub(crate) struct DuplicateValuesFor {\n     #[primary_span]\n     pub span: Span,\n     pub name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(mir_dataflow::requires_an_argument)]\n pub(crate) struct RequiresAnArgument {\n     #[primary_span]\n     pub span: Span,\n     pub name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(mir_dataflow::stop_after_dataflow_ended_compilation)]\n pub(crate) struct StopAfterDataFlowEndedCompilation;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(mir_dataflow::peek_must_be_place_or_ref_place)]\n pub(crate) struct PeekMustBePlaceOrRefPlace {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(mir_dataflow::peek_must_be_not_temporary)]\n pub(crate) struct PeekMustBeNotTemporary {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(mir_dataflow::peek_bit_not_set)]\n pub(crate) struct PeekBitNotSet {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(mir_dataflow::peek_argument_not_a_local)]\n pub(crate) struct PeekArgumentNotALocal {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(mir_dataflow::peek_argument_untracked)]\n pub(crate) struct PeekArgumentUntracked {\n     #[primary_span]"}, {"sha": "cdc2c74ac8ffe8c064b7f87d902f8e173c5342e9", "filename": "compiler/rustc_monomorphize/src/errors.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_monomorphize%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_monomorphize%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_monomorphize%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -2,10 +2,10 @@ use std::path::PathBuf;\n \n use rustc_errors::IntoDiagnostic;\n use rustc_errors::ErrorGuaranteed;\n-use rustc_macros::{DiagnosticHandler, LintDiagnostic};\n+use rustc_macros::{Diagnostic, LintDiagnostic};\n use rustc_span::Span;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(monomorphize::recursion_limit)]\n pub struct RecursionLimit {\n     #[primary_span]\n@@ -19,7 +19,7 @@ pub struct RecursionLimit {\n     pub path: PathBuf,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(monomorphize::type_length_limit)]\n #[help(monomorphize::consider_type_length_limit)]\n pub struct TypeLengthLimit {\n@@ -32,7 +32,7 @@ pub struct TypeLengthLimit {\n     pub type_length: usize,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(monomorphize::requires_lang_item)]\n pub struct RequiresLangItem {\n     pub lang_item: String,\n@@ -72,11 +72,11 @@ pub struct LargeAssignmentsLint {\n     pub limit: u64,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(monomorphize::unknown_partition_strategy)]\n pub struct UnknownPartitionStrategy;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(monomorphize::symbol_already_defined)]\n pub struct SymbolAlreadyDefined {\n     #[primary_span]"}, {"sha": "9989ebb7cdf42bebc8b788ab206bb4a613702ed7", "filename": "compiler/rustc_parse/src/parser/diagnostics.rs", "status": "modified", "additions": 42, "deletions": 42, "changes": 84, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fdiagnostics.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -20,7 +20,7 @@ use rustc_errors::{\n     fluent, Applicability, DiagnosticBuilder, DiagnosticMessage, Handler, MultiSpan, PResult,\n };\n use rustc_errors::{pluralize, struct_span_err, Diagnostic, ErrorGuaranteed};\n-use rustc_macros::{DiagnosticHandler, SessionSubdiagnostic};\n+use rustc_macros::{Diagnostic, SessionSubdiagnostic};\n use rustc_span::source_map::Spanned;\n use rustc_span::symbol::{kw, sym, Ident};\n use rustc_span::{Span, SpanSnippetError, DUMMY_SP};\n@@ -242,7 +242,7 @@ impl MultiSugg {\n     }\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::maybe_report_ambiguous_plus)]\n struct AmbiguousPlus {\n     pub sum_ty: String,\n@@ -251,7 +251,7 @@ struct AmbiguousPlus {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::maybe_recover_from_bad_type_plus, code = \"E0178\")]\n struct BadTypePlus {\n     pub ty: String,\n@@ -285,7 +285,7 @@ pub enum BadTypePlusSub {\n     },\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::maybe_recover_from_bad_qpath_stage_2)]\n struct BadQPathStage2 {\n     #[primary_span]\n@@ -294,7 +294,7 @@ struct BadQPathStage2 {\n     ty: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::incorrect_semicolon)]\n struct IncorrectSemicolon<'a> {\n     #[primary_span]\n@@ -305,15 +305,15 @@ struct IncorrectSemicolon<'a> {\n     name: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::incorrect_use_of_await)]\n struct IncorrectUseOfAwait {\n     #[primary_span]\n     #[suggestion(parser::parentheses_suggestion, applicability = \"machine-applicable\")]\n     span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::incorrect_use_of_await)]\n struct IncorrectAwait {\n     #[primary_span]\n@@ -324,7 +324,7 @@ struct IncorrectAwait {\n     question_mark: &'static str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::in_in_typo)]\n struct InInTypo {\n     #[primary_span]\n@@ -333,7 +333,7 @@ struct InInTypo {\n     sugg_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::invalid_variable_declaration)]\n pub struct InvalidVariableDeclaration {\n     #[primary_span]\n@@ -362,7 +362,7 @@ pub enum InvalidVariableDeclarationSub {\n     UseLetNotVar(#[primary_span] Span),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::invalid_comparison_operator)]\n pub(crate) struct InvalidComparisonOperator {\n     #[primary_span]\n@@ -389,7 +389,7 @@ pub(crate) enum InvalidComparisonOperatorSub {\n     Spaceship(#[primary_span] Span),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::invalid_logical_operator)]\n #[note]\n pub(crate) struct InvalidLogicalOperator {\n@@ -416,15 +416,15 @@ pub(crate) enum InvalidLogicalOperatorSub {\n     Disjunction(#[primary_span] Span),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::tilde_is_not_unary_operator)]\n pub(crate) struct TildeAsUnaryOperator(\n     #[primary_span]\n     #[suggestion_short(applicability = \"machine-applicable\", code = \"!\")]\n     pub Span,\n );\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::unexpected_token_after_not)]\n pub(crate) struct NotAsNegationOperator {\n     #[primary_span]\n@@ -458,7 +458,7 @@ pub enum NotAsNegationOperatorSub {\n     SuggestNotLogical(#[primary_span] Span),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::malformed_loop_label)]\n pub(crate) struct MalformedLoopLabel {\n     #[primary_span]\n@@ -467,7 +467,7 @@ pub(crate) struct MalformedLoopLabel {\n     pub correct_label: Ident,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::lifetime_in_borrow_expression)]\n pub(crate) struct LifetimeInBorrowExpression {\n     #[primary_span]\n@@ -477,23 +477,23 @@ pub(crate) struct LifetimeInBorrowExpression {\n     pub lifetime_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::field_expression_with_generic)]\n pub(crate) struct FieldExpressionWithGeneric(#[primary_span] pub Span);\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::macro_invocation_with_qualified_path)]\n pub(crate) struct MacroInvocationWithQualifiedPath(#[primary_span] pub Span);\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::unexpected_token_after_label)]\n pub(crate) struct UnexpectedTokenAfterLabel(\n     #[primary_span]\n     #[label(parser::unexpected_token_after_label)]\n     pub Span,\n );\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::require_colon_after_labeled_expression)]\n #[note]\n pub(crate) struct RequireColonAfterLabeledExpression {\n@@ -505,7 +505,7 @@ pub(crate) struct RequireColonAfterLabeledExpression {\n     pub label_end: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::do_catch_syntax_removed)]\n #[note]\n pub(crate) struct DoCatchSyntaxRemoved {\n@@ -514,7 +514,7 @@ pub(crate) struct DoCatchSyntaxRemoved {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::float_literal_requires_integer_part)]\n pub(crate) struct FloatLiteralRequiresIntegerPart {\n     #[primary_span]\n@@ -523,7 +523,7 @@ pub(crate) struct FloatLiteralRequiresIntegerPart {\n     pub correct: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::invalid_int_literal_width)]\n #[help]\n pub(crate) struct InvalidIntLiteralWidth {\n@@ -532,7 +532,7 @@ pub(crate) struct InvalidIntLiteralWidth {\n     pub width: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::invalid_num_literal_base_prefix)]\n #[note]\n pub(crate) struct InvalidNumLiteralBasePrefix {\n@@ -542,7 +542,7 @@ pub(crate) struct InvalidNumLiteralBasePrefix {\n     pub fixed: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::invalid_num_literal_suffix)]\n #[help]\n pub(crate) struct InvalidNumLiteralSuffix {\n@@ -552,7 +552,7 @@ pub(crate) struct InvalidNumLiteralSuffix {\n     pub suffix: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::invalid_float_literal_width)]\n #[help]\n pub(crate) struct InvalidFloatLiteralWidth {\n@@ -561,7 +561,7 @@ pub(crate) struct InvalidFloatLiteralWidth {\n     pub width: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::invalid_float_literal_suffix)]\n #[help]\n pub(crate) struct InvalidFloatLiteralSuffix {\n@@ -571,14 +571,14 @@ pub(crate) struct InvalidFloatLiteralSuffix {\n     pub suffix: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::int_literal_too_large)]\n pub(crate) struct IntLiteralTooLarge {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::missing_semicolon_before_array)]\n pub(crate) struct MissingSemicolonBeforeArray {\n     #[primary_span]\n@@ -587,7 +587,7 @@ pub(crate) struct MissingSemicolonBeforeArray {\n     pub semicolon: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::invalid_block_macro_segment)]\n pub(crate) struct InvalidBlockMacroSegment {\n     #[primary_span]\n@@ -596,7 +596,7 @@ pub(crate) struct InvalidBlockMacroSegment {\n     pub context: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::if_expression_missing_then_block)]\n pub(crate) struct IfExpressionMissingThenBlock {\n     #[primary_span]\n@@ -613,7 +613,7 @@ pub(crate) enum IfExpressionMissingThenBlockSub {\n     AddThenBlock(#[primary_span] Span),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::if_expression_missing_condition)]\n pub(crate) struct IfExpressionMissingCondition {\n     #[primary_span]\n@@ -623,14 +623,14 @@ pub(crate) struct IfExpressionMissingCondition {\n     pub block_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::expected_expression_found_let)]\n pub(crate) struct ExpectedExpressionFoundLet {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::expected_else_block)]\n pub(crate) struct ExpectedElseBlock {\n     #[primary_span]\n@@ -642,7 +642,7 @@ pub(crate) struct ExpectedElseBlock {\n     pub condition_start: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::outer_attribute_not_allowed_on_if_else)]\n pub(crate) struct OuterAttributeNotAllowedOnIfElse {\n     #[primary_span]\n@@ -659,7 +659,7 @@ pub(crate) struct OuterAttributeNotAllowedOnIfElse {\n     pub attributes: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::missing_in_in_for_loop)]\n pub(crate) struct MissingInInForLoop {\n     #[primary_span]\n@@ -677,23 +677,23 @@ pub(crate) enum MissingInInForLoopSub {\n     AddIn(#[primary_span] Span),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::missing_comma_after_match_arm)]\n pub(crate) struct MissingCommaAfterMatchArm {\n     #[primary_span]\n     #[suggestion(applicability = \"machine-applicable\", code = \",\")]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::catch_after_try)]\n #[help]\n pub(crate) struct CatchAfterTry {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::comma_after_base_struct)]\n #[note]\n pub(crate) struct CommaAfterBaseStruct {\n@@ -703,7 +703,7 @@ pub(crate) struct CommaAfterBaseStruct {\n     pub comma: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::eq_field_init)]\n pub(crate) struct EqFieldInit {\n     #[primary_span]\n@@ -712,7 +712,7 @@ pub(crate) struct EqFieldInit {\n     pub eq: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::dotdotdot)]\n pub(crate) struct DotDotDot {\n     #[primary_span]\n@@ -721,15 +721,15 @@ pub(crate) struct DotDotDot {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::left_arrow_operator)]\n pub(crate) struct LeftArrowOperator {\n     #[primary_span]\n     #[suggestion(applicability = \"maybe-incorrect\", code = \"< -\")]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::remove_let)]\n pub(crate) struct RemoveLet {\n     #[primary_span]"}, {"sha": "bff2978bd1331be674153360aa681fddcc31553f", "filename": "compiler/rustc_passes/src/errors.rs", "status": "modified", "additions": 52, "deletions": 52, "changes": 104, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_passes%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_passes%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,5 +1,5 @@\n use rustc_errors::{Applicability, MultiSpan};\n-use rustc_macros::{DiagnosticHandler, LintDiagnostic, SessionSubdiagnostic};\n+use rustc_macros::{Diagnostic, LintDiagnostic, SessionSubdiagnostic};\n use rustc_span::{Span, Symbol};\n \n #[derive(LintDiagnostic)]\n@@ -32,7 +32,7 @@ pub struct IgnoredInlineAttrFnProto;\n #[note]\n pub struct IgnoredInlineAttrConstants;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::inline_not_fn_or_closure, code = \"E0518\")]\n pub struct InlineNotFnOrClosure {\n     #[primary_span]\n@@ -53,7 +53,7 @@ pub struct IgnoredNoCoveragePropagate;\n #[diag(passes::no_coverage_fn_defn)]\n pub struct IgnoredNoCoverageFnDefn;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::no_coverage_not_coverable, code = \"E0788\")]\n pub struct IgnoredNoCoverageNotCoverable {\n     #[primary_span]\n@@ -62,7 +62,7 @@ pub struct IgnoredNoCoverageNotCoverable {\n     pub defn_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::should_be_applied_to_fn)]\n pub struct AttrShouldBeAppliedToFn {\n     #[primary_span]\n@@ -71,14 +71,14 @@ pub struct AttrShouldBeAppliedToFn {\n     pub defn_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::naked_tracked_caller, code = \"E0736\")]\n pub struct NakedTrackedCaller {\n     #[primary_span]\n     pub attr_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::should_be_applied_to_fn, code = \"E0739\")]\n pub struct TrackedCallerWrongLocation {\n     #[primary_span]\n@@ -87,7 +87,7 @@ pub struct TrackedCallerWrongLocation {\n     pub defn_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::should_be_applied_to_struct_enum, code = \"E0701\")]\n pub struct NonExhaustiveWrongLocation {\n     #[primary_span]\n@@ -96,7 +96,7 @@ pub struct NonExhaustiveWrongLocation {\n     pub defn_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::should_be_applied_to_trait)]\n pub struct AttrShouldBeAppliedToTrait {\n     #[primary_span]\n@@ -109,7 +109,7 @@ pub struct AttrShouldBeAppliedToTrait {\n #[diag(passes::target_feature_on_statement)]\n pub struct TargetFeatureOnStatement;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::should_be_applied_to_static)]\n pub struct AttrShouldBeAppliedToStatic {\n     #[primary_span]\n@@ -118,23 +118,23 @@ pub struct AttrShouldBeAppliedToStatic {\n     pub defn_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::doc_expect_str)]\n pub struct DocExpectStr<'a> {\n     #[primary_span]\n     pub attr_span: Span,\n     pub attr_name: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::doc_alias_empty)]\n pub struct DocAliasEmpty<'a> {\n     #[primary_span]\n     pub span: Span,\n     pub attr_str: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::doc_alias_bad_char)]\n pub struct DocAliasBadChar<'a> {\n     #[primary_span]\n@@ -143,15 +143,15 @@ pub struct DocAliasBadChar<'a> {\n     pub char_: char,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::doc_alias_start_end)]\n pub struct DocAliasStartEnd<'a> {\n     #[primary_span]\n     pub span: Span,\n     pub attr_str: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::doc_alias_bad_location)]\n pub struct DocAliasBadLocation<'a> {\n     #[primary_span]\n@@ -160,7 +160,7 @@ pub struct DocAliasBadLocation<'a> {\n     pub location: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::doc_alias_not_an_alias)]\n pub struct DocAliasNotAnAlias<'a> {\n     #[primary_span]\n@@ -175,57 +175,57 @@ pub struct DocAliasDuplicated {\n     pub first_defn: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::doc_alias_not_string_literal)]\n pub struct DocAliasNotStringLiteral {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::doc_alias_malformed)]\n pub struct DocAliasMalformed {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::doc_keyword_empty_mod)]\n pub struct DocKeywordEmptyMod {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::doc_keyword_not_mod)]\n pub struct DocKeywordNotMod {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::doc_keyword_invalid_ident)]\n pub struct DocKeywordInvalidIdent {\n     #[primary_span]\n     pub span: Span,\n     pub doc_keyword: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::doc_fake_variadic_not_valid)]\n pub struct DocFakeVariadicNotValid {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::doc_keyword_only_impl)]\n pub struct DocKeywordOnlyImpl {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::doc_inline_conflict)]\n #[help]\n pub struct DocKeywordConflict {\n@@ -243,7 +243,7 @@ pub struct DocInlineOnlyUse {\n     pub item_span: Option<Span>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::doc_attr_not_crate_level)]\n pub struct DocAttrNotCrateLevel<'a> {\n     #[primary_span]\n@@ -295,7 +295,7 @@ pub struct DocTestUnknownInclude {\n #[diag(passes::doc_invalid)]\n pub struct DocInvalid;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::pass_by_value)]\n pub struct PassByValue {\n     #[primary_span]\n@@ -304,7 +304,7 @@ pub struct PassByValue {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::allow_incoherent_impl)]\n pub struct AllowIncoherentImpl {\n     #[primary_span]\n@@ -313,7 +313,7 @@ pub struct AllowIncoherentImpl {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::has_incoherent_inherent_impl)]\n pub struct HasIncoherentInherentImpl {\n     #[primary_span]\n@@ -336,7 +336,7 @@ pub struct MustUseNoEffect {\n     pub target: rustc_hir::Target,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::must_not_suspend)]\n pub struct MustNotSuspend {\n     #[primary_span]\n@@ -372,7 +372,7 @@ pub struct LinkName<'a> {\n     pub value: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::no_link)]\n pub struct NoLink {\n     #[primary_span]\n@@ -381,7 +381,7 @@ pub struct NoLink {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::export_name)]\n pub struct ExportName {\n     #[primary_span]\n@@ -390,7 +390,7 @@ pub struct ExportName {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::rustc_layout_scalar_valid_range_not_struct)]\n pub struct RustcLayoutScalarValidRangeNotStruct {\n     #[primary_span]\n@@ -399,14 +399,14 @@ pub struct RustcLayoutScalarValidRangeNotStruct {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::rustc_layout_scalar_valid_range_arg)]\n pub struct RustcLayoutScalarValidRangeArg {\n     #[primary_span]\n     pub attr_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::rustc_legacy_const_generics_only)]\n pub struct RustcLegacyConstGenericsOnly {\n     #[primary_span]\n@@ -415,7 +415,7 @@ pub struct RustcLegacyConstGenericsOnly {\n     pub param_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::rustc_legacy_const_generics_index)]\n pub struct RustcLegacyConstGenericsIndex {\n     #[primary_span]\n@@ -424,7 +424,7 @@ pub struct RustcLegacyConstGenericsIndex {\n     pub generics_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::rustc_legacy_const_generics_index_exceed)]\n pub struct RustcLegacyConstGenericsIndexExceed {\n     #[primary_span]\n@@ -433,14 +433,14 @@ pub struct RustcLegacyConstGenericsIndexExceed {\n     pub arg_count: usize,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::rustc_legacy_const_generics_index_negative)]\n pub struct RustcLegacyConstGenericsIndexNegative {\n     #[primary_span]\n     pub invalid_args: Vec<Span>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::rustc_dirty_clean)]\n pub struct RustcDirtyClean {\n     #[primary_span]\n@@ -475,7 +475,7 @@ pub struct NoMangle {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::repr_ident, code = \"E0565\")]\n pub struct ReprIdent {\n     #[primary_span]\n@@ -486,21 +486,21 @@ pub struct ReprIdent {\n #[diag(passes::repr_conflicting, code = \"E0566\")]\n pub struct ReprConflicting;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::used_static)]\n pub struct UsedStatic {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::used_compiler_linker)]\n pub struct UsedCompilerLinker {\n     #[primary_span]\n     pub spans: Vec<Span>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::allow_internal_unstable)]\n pub struct AllowInternalUnstable {\n     #[primary_span]\n@@ -509,14 +509,14 @@ pub struct AllowInternalUnstable {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::debug_visualizer_placement)]\n pub struct DebugVisualizerPlacement {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::debug_visualizer_invalid)]\n #[note(passes::note_1)]\n #[note(passes::note_2)]\n@@ -526,7 +526,7 @@ pub struct DebugVisualizerInvalid {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::rustc_allow_const_fn_unstable)]\n pub struct RustcAllowConstFnUnstable {\n     #[primary_span]\n@@ -535,7 +535,7 @@ pub struct RustcAllowConstFnUnstable {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::rustc_std_internal_symbol)]\n pub struct RustcStdInternalSymbol {\n     #[primary_span]\n@@ -544,21 +544,21 @@ pub struct RustcStdInternalSymbol {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::const_trait)]\n pub struct ConstTrait {\n     #[primary_span]\n     pub attr_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::link_ordinal)]\n pub struct LinkOrdinal {\n     #[primary_span]\n     pub attr_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::stability_promotable)]\n pub struct StabilityPromotable {\n     #[primary_span]\n@@ -602,7 +602,7 @@ pub struct Unused {\n     pub note: UnusedNote,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::non_exported_macro_invalid_attrs, code = \"E0518\")]\n pub struct NonExportedMacroInvalidAttrs {\n     #[primary_span]\n@@ -621,7 +621,7 @@ pub struct UnusedDuplicate {\n     pub warning: Option<()>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::unused_multiple)]\n pub struct UnusedMultiple {\n     #[primary_span]\n@@ -632,7 +632,7 @@ pub struct UnusedMultiple {\n     pub name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::rustc_lint_opt_ty)]\n pub struct RustcLintOptTy {\n     #[primary_span]\n@@ -641,7 +641,7 @@ pub struct RustcLintOptTy {\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(passes::rustc_lint_opt_deny_field_access)]\n pub struct RustcLintOptDenyFieldAccess {\n     #[primary_span]"}, {"sha": "07ce92a9b2611fcb9e15bca962955baaa8c52617", "filename": "compiler/rustc_plugin_impl/src/errors.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_plugin_impl%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_plugin_impl%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_plugin_impl%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,17 +1,17 @@\n //! Errors emitted by plugin_impl\n \n-use rustc_macros::DiagnosticHandler;\n+use rustc_macros::Diagnostic;\n use rustc_span::Span;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(plugin_impl::load_plugin_error)]\n pub struct LoadPluginError {\n     #[primary_span]\n     pub span: Span,\n     pub msg: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(plugin_impl::malformed_plugin_attribute, code = \"E0498\")]\n pub struct MalformedPluginAttribute {\n     #[primary_span]"}, {"sha": "715521194822bbb3059ecb253865c59bab19b44e", "filename": "compiler/rustc_privacy/src/errors.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_privacy%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_privacy%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_privacy%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,8 +1,8 @@\n use rustc_errors::DiagnosticArgFromDisplay;\n-use rustc_macros::{DiagnosticHandler, LintDiagnostic, SessionSubdiagnostic};\n+use rustc_macros::{Diagnostic, LintDiagnostic, SessionSubdiagnostic};\n use rustc_span::{Span, Symbol};\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(privacy::field_is_private, code = \"E0451\")]\n pub struct FieldIsPrivate {\n     #[primary_span]\n@@ -29,7 +29,7 @@ pub enum FieldIsPrivateLabel {\n     },\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(privacy::item_is_private)]\n pub struct ItemIsPrivate<'a> {\n     #[primary_span]\n@@ -39,7 +39,7 @@ pub struct ItemIsPrivate<'a> {\n     pub descr: DiagnosticArgFromDisplay<'a>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(privacy::unnamed_item_is_private)]\n pub struct UnnamedItemIsPrivate {\n     #[primary_span]\n@@ -48,7 +48,7 @@ pub struct UnnamedItemIsPrivate {\n }\n \n // Duplicate of `InPublicInterface` but with a different error code, shares the same slug.\n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(privacy::in_public_interface, code = \"E0445\")]\n pub struct InPublicInterfaceTraits<'a> {\n     #[primary_span]\n@@ -62,7 +62,7 @@ pub struct InPublicInterfaceTraits<'a> {\n }\n \n // Duplicate of `InPublicInterfaceTraits` but with a different error code, shares the same slug.\n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(privacy::in_public_interface, code = \"E0446\")]\n pub struct InPublicInterface<'a> {\n     #[primary_span]"}, {"sha": "4c770152f124d611cf1bf056357b2a01880ff8e5", "filename": "compiler/rustc_query_system/src/error.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_query_system%2Fsrc%2Ferror.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_query_system%2Fsrc%2Ferror.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_query_system%2Fsrc%2Ferror.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -46,7 +46,7 @@ pub struct CycleUsage {\n     pub usage: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(query_system::cycle, code = \"E0391\")]\n pub struct Cycle {\n     #[primary_span]\n@@ -62,11 +62,11 @@ pub struct Cycle {\n     pub cycle_usage: Option<CycleUsage>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(query_system::reentrant)]\n pub struct Reentrant;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(query_system::increment_compilation)]\n #[help]\n #[note(query_system::increment_compilation_note1)]"}, {"sha": "8a15ba63661bcc62f5752cefaedb3d3489336968", "filename": "compiler/rustc_save_analysis/src/errors.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_save_analysis%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_save_analysis%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_save_analysis%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,8 +1,8 @@\n-use rustc_macros::DiagnosticHandler;\n+use rustc_macros::Diagnostic;\n \n use std::path::Path;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(save_analysis::could_not_open)]\n pub(crate) struct CouldNotOpen<'a> {\n     pub file_name: &'a Path,"}, {"sha": "7ffe757463f091005ef5ec024d8bf516e5fb262b", "filename": "compiler/rustc_session/src/errors.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_session%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_session%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_session%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -8,7 +8,7 @@ use rustc_span::{Span, Symbol};\n use rustc_target::abi::TargetDataLayoutErrors;\n use rustc_target::spec::{SplitDebuginfo, StackProtector, TargetTriple};\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(session::incorrect_cgu_reuse_type)]\n pub struct IncorrectCguReuseType<'a> {\n     #[primary_span]\n@@ -19,14 +19,14 @@ pub struct IncorrectCguReuseType<'a> {\n     pub at_least: u8,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(session::cgu_not_recorded)]\n pub struct CguNotRecorded<'a> {\n     pub cgu_user_name: &'a str,\n     pub cgu_name: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(session::feature_gate_error, code = \"E0658\")]\n pub struct FeatureGateError<'a> {\n     #[primary_span]\n@@ -46,7 +46,7 @@ pub struct FeatureDiagnosticHelp {\n     pub feature: Symbol,\n }\n \n-impl DiagnosticHandler<'_, !> for TargetDataLayoutErrors<'_> {\n+impl IntoDiagnostic<'_, !> for TargetDataLayoutErrors<'_> {\n     fn into_diagnostic(self, handler: &Handler) -> DiagnosticBuilder<'_, !> {\n         let mut diag;\n         match self {"}, {"sha": "ea69334616b156e94a4ee0dec3fb458f7bea2984", "filename": "compiler/rustc_span/src/symbol.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -177,7 +177,7 @@ symbols! {\n         DecorateLint,\n         Default,\n         Deref,\n-        DiagnosticHandler,\n+        Diagnostic,\n         DiagnosticMessage,\n         DirBuilder,\n         Display,"}, {"sha": "b02ee593cbef2bd9613980ad476fecd28028c3ae", "filename": "compiler/rustc_trait_selection/src/errors.rs", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_trait_selection%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_trait_selection%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,10 +1,10 @@\n use rustc_errors::{fluent, IntoDiagnostic, ErrorGuaranteed, Handler};\n-use rustc_macros::DiagnosticHandler;\n+use rustc_macros::Diagnostic;\n use rustc_middle::ty::{PolyTraitRef, Ty, Unevaluated};\n use rustc_session::Limit;\n use rustc_span::{Span, Symbol};\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(trait_selection::dump_vtable_entries)]\n pub struct DumpVTableEntries<'a> {\n     #[primary_span]\n@@ -13,15 +13,15 @@ pub struct DumpVTableEntries<'a> {\n     pub entries: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(trait_selection::unable_to_construct_constant_value)]\n pub struct UnableToConstructConstantValue<'a> {\n     #[primary_span]\n     pub span: Span,\n     pub unevaluated: Unevaluated<'a>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[help]\n #[diag(trait_selection::auto_deref_reached_recursion_limit, code = \"E0055\")]\n pub struct AutoDerefReachedRecursionLimit<'a> {\n@@ -33,23 +33,23 @@ pub struct AutoDerefReachedRecursionLimit<'a> {\n     pub crate_name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(trait_selection::empty_on_clause_in_rustc_on_unimplemented, code = \"E0232\")]\n pub struct EmptyOnClauseInOnUnimplemented {\n     #[primary_span]\n     #[label]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(trait_selection::invalid_on_clause_in_rustc_on_unimplemented, code = \"E0232\")]\n pub struct InvalidOnClauseInOnUnimplemented {\n     #[primary_span]\n     #[label]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(trait_selection::no_value_in_rustc_on_unimplemented, code = \"E0232\")]\n #[note]\n pub struct NoValueInOnUnimplemented {"}, {"sha": "851651873100de005a71e4a25f2bc6ffae35a97b", "filename": "compiler/rustc_ty_utils/src/errors.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_ty_utils%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_ty_utils%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ty_utils%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,16 +1,16 @@\n //! Errors emitted by ty_utils\n \n-use rustc_macros::{DiagnosticHandler, SessionSubdiagnostic};\n+use rustc_macros::{Diagnostic, SessionSubdiagnostic};\n use rustc_middle::ty::Ty;\n use rustc_span::Span;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(ty_utils::needs_drop_overflow)]\n pub struct NeedsDropOverflow<'tcx> {\n     pub query_ty: Ty<'tcx>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(ty_utils::generic_constant_too_complex)]\n #[help]\n pub struct GenericConstantTooComplex {"}, {"sha": "23fadff3248c85ab0f92e29a572037886624c4de", "filename": "compiler/rustc_typeck/src/check/expr.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fexpr.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -881,7 +881,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n             return;\n         }\n \n-        // FIXME: Make this use DiagnosticHandler once error codes can be dynamically set.\n+        // FIXME: Make this use Diagnostic once error codes can be dynamically set.\n         let mut err = self.tcx.sess.struct_span_err_with_code(\n             op_span,\n             \"invalid left-hand side of assignment\","}, {"sha": "6f00591d54e38e2e56e0c38e1e213c9b3a4f78a9", "filename": "compiler/rustc_typeck/src/errors.rs", "status": "modified", "additions": 27, "deletions": 27, "changes": 54, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_typeck%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/compiler%2Frustc_typeck%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Ferrors.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,11 +1,11 @@\n //! Errors emitted by typeck.\n use rustc_errors::IntoDiagnostic;\n use rustc_errors::{error_code, Applicability, DiagnosticBuilder, ErrorGuaranteed, Handler};\n-use rustc_macros::{DiagnosticHandler, LintDiagnostic, SessionSubdiagnostic};\n+use rustc_macros::{Diagnostic, LintDiagnostic, SessionSubdiagnostic};\n use rustc_middle::ty::Ty;\n use rustc_span::{symbol::Ident, Span, Symbol};\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::field_multiply_specified_in_initializer, code = \"E0062\")]\n pub struct FieldMultiplySpecifiedInInitializer {\n     #[primary_span]\n@@ -16,7 +16,7 @@ pub struct FieldMultiplySpecifiedInInitializer {\n     pub ident: Ident,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::unrecognized_atomic_operation, code = \"E0092\")]\n pub struct UnrecognizedAtomicOperation<'a> {\n     #[primary_span]\n@@ -25,7 +25,7 @@ pub struct UnrecognizedAtomicOperation<'a> {\n     pub op: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::wrong_number_of_generic_arguments_to_intrinsic, code = \"E0094\")]\n pub struct WrongNumberOfGenericArgumentsToIntrinsic<'a> {\n     #[primary_span]\n@@ -36,7 +36,7 @@ pub struct WrongNumberOfGenericArgumentsToIntrinsic<'a> {\n     pub descr: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::unrecognized_intrinsic_function, code = \"E0093\")]\n pub struct UnrecognizedIntrinsicFunction {\n     #[primary_span]\n@@ -45,7 +45,7 @@ pub struct UnrecognizedIntrinsicFunction {\n     pub name: Symbol,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::lifetimes_or_bounds_mismatch_on_trait, code = \"E0195\")]\n pub struct LifetimesOrBoundsMismatchOnTrait {\n     #[primary_span]\n@@ -57,15 +57,15 @@ pub struct LifetimesOrBoundsMismatchOnTrait {\n     pub ident: Ident,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::drop_impl_on_wrong_item, code = \"E0120\")]\n pub struct DropImplOnWrongItem {\n     #[primary_span]\n     #[label]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::field_already_declared, code = \"E0124\")]\n pub struct FieldAlreadyDeclared {\n     pub field_name: Ident,\n@@ -76,30 +76,30 @@ pub struct FieldAlreadyDeclared {\n     pub prev_span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::copy_impl_on_type_with_dtor, code = \"E0184\")]\n pub struct CopyImplOnTypeWithDtor {\n     #[primary_span]\n     #[label]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::multiple_relaxed_default_bounds, code = \"E0203\")]\n pub struct MultipleRelaxedDefaultBounds {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::copy_impl_on_non_adt, code = \"E0206\")]\n pub struct CopyImplOnNonAdt {\n     #[primary_span]\n     #[label]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::trait_object_declared_with_no_traits, code = \"E0224\")]\n pub struct TraitObjectDeclaredWithNoTraits {\n     #[primary_span]\n@@ -108,29 +108,29 @@ pub struct TraitObjectDeclaredWithNoTraits {\n     pub trait_alias_span: Option<Span>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0227\")]\n pub struct AmbiguousLifetimeBound {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::assoc_type_binding_not_allowed, code = \"E0229\")]\n pub struct AssocTypeBindingNotAllowed {\n     #[primary_span]\n     #[label]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::functional_record_update_on_non_struct, code = \"E0436\")]\n pub struct FunctionalRecordUpdateOnNonStruct {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::typeof_reserved_keyword_used, code = \"E0516\")]\n pub struct TypeofReservedKeywordUsed<'tcx> {\n     pub ty: Ty<'tcx>,\n@@ -141,7 +141,7 @@ pub struct TypeofReservedKeywordUsed<'tcx> {\n     pub opt_sugg: Option<(Span, Applicability)>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::return_stmt_outside_of_fn_body, code = \"E0572\")]\n pub struct ReturnStmtOutsideOfFnBody {\n     #[primary_span]\n@@ -152,29 +152,29 @@ pub struct ReturnStmtOutsideOfFnBody {\n     pub encl_fn_span: Option<Span>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::yield_expr_outside_of_generator, code = \"E0627\")]\n pub struct YieldExprOutsideOfGenerator {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::struct_expr_non_exhaustive, code = \"E0639\")]\n pub struct StructExprNonExhaustive {\n     #[primary_span]\n     pub span: Span,\n     pub what: &'static str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::method_call_on_unknown_type, code = \"E0699\")]\n pub struct MethodCallOnUnknownType {\n     #[primary_span]\n     pub span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::value_of_associated_struct_already_specified, code = \"E0719\")]\n pub struct ValueOfAssociatedStructAlreadySpecified {\n     #[primary_span]\n@@ -186,7 +186,7 @@ pub struct ValueOfAssociatedStructAlreadySpecified {\n     pub def_path: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::address_of_temporary_taken, code = \"E0745\")]\n pub struct AddressOfTemporaryTaken {\n     #[primary_span]\n@@ -232,7 +232,7 @@ pub enum ExpectedReturnTypeLabel<'tcx> {\n     },\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::unconstrained_opaque_type)]\n #[note]\n pub struct UnconstrainedOpaqueType {\n@@ -249,7 +249,7 @@ pub struct MissingTypeParams {\n     pub empty_generic_args: bool,\n }\n \n-// Manual implementation of `DiagnosticHandler` to be able to call `span_to_snippet`.\n+// Manual implementation of `IntoDiagnostic` to be able to call `span_to_snippet`.\n impl<'a> IntoDiagnostic<'a> for MissingTypeParams {\n     fn into_diagnostic(self, handler: &'a Handler) -> DiagnosticBuilder<'a, ErrorGuaranteed> {\n         let mut err = handler.struct_span_err_with_code(\n@@ -306,7 +306,7 @@ impl<'a> IntoDiagnostic<'a> for MissingTypeParams {\n     }\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::manual_implementation, code = \"E0183\")]\n #[help]\n pub struct ManualImplementation {\n@@ -316,7 +316,7 @@ pub struct ManualImplementation {\n     pub trait_name: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::substs_on_overridden_impl)]\n pub struct SubstsOnOverriddenImpl {\n     #[primary_span]\n@@ -339,7 +339,7 @@ pub struct ExternCrateNotIdiomatic {\n     pub suggestion_code: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::expected_used_symbol)]\n pub struct ExpectedUsedSymbol {\n     #[primary_span]"}, {"sha": "93766de9a9148962b2712efc4114bfe1d34ba24c", "filename": "src/test/ui-fulldeps/internal-lints/diagnostics.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/src%2Ftest%2Fui-fulldeps%2Finternal-lints%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/src%2Ftest%2Fui-fulldeps%2Finternal-lints%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui-fulldeps%2Finternal-lints%2Fdiagnostics.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -15,10 +15,10 @@ use rustc_errors::{\n     AddToDiagnostic, IntoDiagnostic, Diagnostic, DiagnosticBuilder,\n     ErrorGuaranteed, Handler, fluent\n };\n-use rustc_macros::{DiagnosticHandler, SessionSubdiagnostic};\n+use rustc_macros::{Diagnostic, SessionSubdiagnostic};\n use rustc_span::Span;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(parser::expect_path)]\n struct DeriveSessionDiagnostic {\n     #[primary_span]"}, {"sha": "fd8128c31f8e0ba9b39e4b0d5ca8a84775e4d06f", "filename": "src/test/ui-fulldeps/session-diagnostic/diagnostic-derive.rs", "status": "modified", "additions": 77, "deletions": 77, "changes": 154, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/src%2Ftest%2Fui-fulldeps%2Fsession-diagnostic%2Fdiagnostic-derive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/src%2Ftest%2Fui-fulldeps%2Fsession-diagnostic%2Fdiagnostic-derive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui-fulldeps%2Fsession-diagnostic%2Fdiagnostic-derive.rs?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,10 +1,10 @@\n // check-fail\n-// Tests error conditions for specifying diagnostics using #[derive(DiagnosticHandler)]\n+// Tests error conditions for specifying diagnostics using #[derive(Diagnostic)]\n \n // normalize-stderr-test \"the following other types implement trait `IntoDiagnosticArg`:(?:.*\\n){0,9}\\s+and \\d+ others\" -> \"normalized in stderr\"\n // normalize-stderr-test \"diagnostic_builder\\.rs:[0-9]+:[0-9]+\" -> \"diagnostic_builder.rs:LL:CC\"\n // The proc_macro2 crate handles spans differently when on beta/stable release rather than nightly,\n-// changing the output of this test. Since DiagnosticHandler is strictly internal to the compiler\n+// changing the output of this test. Since Diagnostic is strictly internal to the compiler\n // the test is just ignored on stable and beta:\n // ignore-beta\n // ignore-stable\n@@ -17,7 +17,7 @@ use rustc_span::symbol::Ident;\n use rustc_span::Span;\n \n extern crate rustc_macros;\n-use rustc_macros::{DiagnosticHandler, LintDiagnostic, SessionSubdiagnostic};\n+use rustc_macros::{Diagnostic, LintDiagnostic, SessionSubdiagnostic};\n \n extern crate rustc_middle;\n use rustc_middle::ty::Ty;\n@@ -27,115 +27,115 @@ use rustc_errors::{Applicability, MultiSpan};\n \n extern crate rustc_session;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct Hello {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct HelloWarn {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n-//~^ ERROR `#[derive(DiagnosticHandler)]` can only be used on structs\n-enum DiagnosticHandlerOnEnum {\n+//~^ ERROR `#[derive(Diagnostic)]` can only be used on structs\n+enum DiagnosticOnEnum {\n     Foo,\n     Bar,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n #[diag = \"E0123\"]\n //~^ ERROR `#[diag = ...]` is not a valid attribute\n struct WrongStructAttrStyle {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[nonsense(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n //~^ ERROR `#[nonsense(...)]` is not a valid attribute\n //~^^ ERROR diagnostic slug not specified\n //~^^^ ERROR cannot find attribute `nonsense` in this scope\n struct InvalidStructAttr {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(\"E0123\")]\n //~^ ERROR `#[diag(\"...\")]` is not a valid attribute\n //~^^ ERROR diagnostic slug not specified\n struct InvalidLitNestedAttr {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(nonsense, code = \"E0123\")]\n //~^ ERROR cannot find value `nonsense` in module `rustc_errors::fluent`\n struct InvalidNestedStructAttr {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(nonsense(\"foo\"), code = \"E0123\", slug = \"foo\")]\n //~^ ERROR `#[diag(nonsense(...))]` is not a valid attribute\n //~^^ ERROR diagnostic slug not specified\n struct InvalidNestedStructAttr1 {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(nonsense = \"...\", code = \"E0123\", slug = \"foo\")]\n //~^ ERROR `#[diag(nonsense = ...)]` is not a valid attribute\n //~^^ ERROR diagnostic slug not specified\n struct InvalidNestedStructAttr2 {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(nonsense = 4, code = \"E0123\", slug = \"foo\")]\n //~^ ERROR `#[diag(nonsense = ...)]` is not a valid attribute\n //~^^ ERROR diagnostic slug not specified\n struct InvalidNestedStructAttr3 {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\", slug = \"foo\")]\n //~^ ERROR `#[diag(slug = ...)]` is not a valid attribute\n struct InvalidNestedStructAttr4 {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct WrongPlaceField {\n     #[suggestion = \"bar\"]\n     //~^ ERROR `#[suggestion = ...]` is not a valid attribute\n     sp: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0456\")]\n //~^ ERROR specified multiple times\n //~^^ ERROR specified multiple times\n struct DiagSpecifiedTwice {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0456\", code = \"E0457\")]\n //~^ ERROR specified multiple times\n struct CodeSpecifiedTwice {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, typeck::ambiguous_lifetime_bound, code = \"E0456\")]\n //~^ ERROR `#[diag(typeck::ambiguous_lifetime_bound)]` is not a valid attribute\n struct SlugSpecifiedTwice {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n struct KindNotProvided {} //~ ERROR diagnostic slug not specified\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(code = \"E0456\")]\n //~^ ERROR diagnostic slug not specified\n struct SlugNotProvided {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound)]\n struct CodeNotProvided {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct MessageWrongType {\n     #[primary_span]\n     //~^ ERROR `#[primary_span]` attribute can only be applied to fields of type `Span` or `MultiSpan`\n     foo: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct InvalidPathFieldAttr {\n     #[nonsense]\n@@ -144,31 +144,31 @@ struct InvalidPathFieldAttr {\n     foo: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorWithField {\n     name: String,\n     #[label(typeck::label)]\n     span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorWithMessageAppliedToField {\n     #[label(typeck::label)]\n     //~^ ERROR the `#[label(...)]` attribute can only be applied to fields of type `Span` or `MultiSpan`\n     name: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorWithNonexistentField {\n     #[suggestion(typeck::suggestion, code = \"{name}\")]\n     //~^ ERROR `name` doesn't refer to a field on this type\n     suggestion: (Span, Applicability),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n //~^ ERROR invalid format string: expected `'}'`\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorMissingClosingBrace {\n@@ -178,7 +178,7 @@ struct ErrorMissingClosingBrace {\n     val: usize,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n //~^ ERROR invalid format string: unmatched `}`\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorMissingOpeningBrace {\n@@ -188,22 +188,22 @@ struct ErrorMissingOpeningBrace {\n     val: usize,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct LabelOnSpan {\n     #[label(typeck::label)]\n     sp: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct LabelOnNonSpan {\n     #[label(typeck::label)]\n     //~^ ERROR the `#[label(...)]` attribute can only be applied to fields of type `Span` or `MultiSpan`\n     id: u32,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct Suggest {\n     #[suggestion(typeck::suggestion, code = \"This is the suggested code\")]\n@@ -213,83 +213,83 @@ struct Suggest {\n     suggestion: (Span, Applicability),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct SuggestWithoutCode {\n     #[suggestion(typeck::suggestion)]\n     suggestion: (Span, Applicability),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct SuggestWithBadKey {\n     #[suggestion(nonsense = \"bar\")]\n     //~^ ERROR `#[suggestion(nonsense = ...)]` is not a valid attribute\n     suggestion: (Span, Applicability),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct SuggestWithShorthandMsg {\n     #[suggestion(msg = \"bar\")]\n     //~^ ERROR `#[suggestion(msg = ...)]` is not a valid attribute\n     suggestion: (Span, Applicability),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct SuggestWithoutMsg {\n     #[suggestion(code = \"bar\")]\n     suggestion: (Span, Applicability),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct SuggestWithTypesSwapped {\n     #[suggestion(typeck::suggestion, code = \"This is suggested code\")]\n     suggestion: (Applicability, Span),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct SuggestWithWrongTypeApplicabilityOnly {\n     #[suggestion(typeck::suggestion, code = \"This is suggested code\")]\n     //~^ ERROR wrong field type for suggestion\n     suggestion: Applicability,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct SuggestWithSpanOnly {\n     #[suggestion(typeck::suggestion, code = \"This is suggested code\")]\n     suggestion: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct SuggestWithDuplicateSpanAndApplicability {\n     #[suggestion(typeck::suggestion, code = \"This is suggested code\")]\n     //~^ ERROR type of field annotated with `#[suggestion(...)]` contains more than one `Span`\n     suggestion: (Span, Span, Applicability),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct SuggestWithDuplicateApplicabilityAndSpan {\n     #[suggestion(typeck::suggestion, code = \"This is suggested code\")]\n     //~^ ERROR type of field annotated with `#[suggestion(...)]` contains more than one\n     suggestion: (Applicability, Applicability, Span),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct WrongKindOfAnnotation {\n     #[label = \"bar\"]\n     //~^ ERROR `#[label = ...]` is not a valid attribute\n     z: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct OptionsInErrors {\n     #[label(typeck::label)]\n@@ -298,7 +298,7 @@ struct OptionsInErrors {\n     opt_sugg: Option<(Span, Applicability)>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0456\")]\n struct MoveOutOfBorrowError<'tcx> {\n     name: Ident,\n@@ -312,23 +312,23 @@ struct MoveOutOfBorrowError<'tcx> {\n     opt_sugg: Option<(Span, Applicability)>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorWithLifetime<'a> {\n     #[label(typeck::label)]\n     span: Span,\n     name: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorWithDefaultLabelAttr<'a> {\n     #[label]\n     span: Span,\n     name: &'a str,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n //~^ ERROR the trait bound `Hello: IntoDiagnosticArg` is not satisfied\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ArgFieldWithoutSkip {\n@@ -337,7 +337,7 @@ struct ArgFieldWithoutSkip {\n     other: Hello,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ArgFieldWithSkip {\n     #[primary_span]\n@@ -348,114 +348,114 @@ struct ArgFieldWithSkip {\n     other: Hello,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorWithSpannedNote {\n     #[note]\n     span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorWithSpannedNoteCustom {\n     #[note(typeck::note)]\n     span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n #[note]\n struct ErrorWithNote {\n     val: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n #[note(typeck::note)]\n struct ErrorWithNoteCustom {\n     val: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorWithSpannedHelp {\n     #[help]\n     span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorWithSpannedHelpCustom {\n     #[help(typeck::help)]\n     span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n #[help]\n struct ErrorWithHelp {\n     val: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n #[help(typeck::help)]\n struct ErrorWithHelpCustom {\n     val: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[help]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorWithHelpWrongOrder {\n     val: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[help(typeck::help)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorWithHelpCustomWrongOrder {\n     val: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[note]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorWithNoteWrongOrder {\n     val: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[note(typeck::note)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorWithNoteCustomWrongOrder {\n     val: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ApplicabilityInBoth {\n     #[suggestion(typeck::suggestion, code = \"...\", applicability = \"maybe-incorrect\")]\n     //~^ ERROR applicability cannot be set in both the field and attribute\n     suggestion: (Span, Applicability),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct InvalidApplicability {\n     #[suggestion(typeck::suggestion, code = \"...\", applicability = \"batman\")]\n     //~^ ERROR invalid applicability\n     suggestion: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ValidApplicability {\n     #[suggestion(typeck::suggestion, code = \"...\", applicability = \"maybe-incorrect\")]\n     suggestion: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct NoApplicability {\n     #[suggestion(typeck::suggestion, code = \"...\")]\n@@ -466,22 +466,22 @@ struct NoApplicability {\n #[note(parser::add_paren)]\n struct Note;\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound)]\n struct Subdiagnostic {\n     #[subdiagnostic]\n     note: Note,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct VecField {\n     #[primary_span]\n     #[label]\n     spans: Vec<Span>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct UnitField {\n     #[primary_span]\n@@ -492,7 +492,7 @@ struct UnitField {\n     bar: (),\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct OptUnitField {\n     #[primary_span]\n@@ -503,23 +503,23 @@ struct OptUnitField {\n     bar: Option<()>,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct LabelWithTrailingPath {\n     #[label(typeck::label, foo)]\n     //~^ ERROR `#[label(...)]` is not a valid attribute\n     span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct LabelWithTrailingNameValue {\n     #[label(typeck::label, foo = \"...\")]\n     //~^ ERROR `#[label(...)]` is not a valid attribute\n     span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct LabelWithTrailingList {\n     #[label(typeck::label, foo(\"...\"))]\n@@ -540,35 +540,35 @@ struct PrimarySpanOnLint {\n     span: Span,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n struct ErrorWithMultiSpan {\n     #[primary_span]\n     span: MultiSpan,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n #[warning]\n struct ErrorWithWarn {\n     val: String,\n }\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[error(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n //~^ ERROR `#[error(...)]` is not a valid attribute\n //~| ERROR diagnostic slug not specified\n //~| ERROR cannot find attribute `error` in this scope\n struct ErrorAttribute {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[warn_(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n //~^ ERROR `#[warn_(...)]` is not a valid attribute\n //~| ERROR diagnostic slug not specified\n //~| ERROR cannot find attribute `warn_` in this scope\n struct WarnAttribute {}\n \n-#[derive(DiagnosticHandler)]\n+#[derive(Diagnostic)]\n #[lint(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n //~^ ERROR `#[lint(...)]` is not a valid attribute\n //~| ERROR diagnostic slug not specified"}, {"sha": "b07b35f27235b9e139d670f574333b21a7188766", "filename": "src/test/ui-fulldeps/session-diagnostic/diagnostic-derive.stderr", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/a3396b207093c01065b63b0c58f1e6654629166d/src%2Ftest%2Fui-fulldeps%2Fsession-diagnostic%2Fdiagnostic-derive.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a3396b207093c01065b63b0c58f1e6654629166d/src%2Ftest%2Fui-fulldeps%2Fsession-diagnostic%2Fdiagnostic-derive.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui-fulldeps%2Fsession-diagnostic%2Fdiagnostic-derive.stderr?ref=a3396b207093c01065b63b0c58f1e6654629166d", "patch": "@@ -1,9 +1,9 @@\n-error: `#[derive(DiagnosticHandler)]` can only be used on structs\n+error: `#[derive(Diagnostic)]` can only be used on structs\n   --> $DIR/diagnostic-derive.rs:39:1\n    |\n LL | / #[diag(typeck::ambiguous_lifetime_bound, code = \"E0123\")]\n LL | |\n-LL | | enum DiagnosticHandlerOnEnum {\n+LL | | enum DiagnosticOnEnum {\n LL | |     Foo,\n LL | |     Bar,\n LL | | }\n@@ -214,22 +214,22 @@ LL |     #[suggestion(typeck::suggestion, code = \"{name}\")]\n error: invalid format string: expected `'}'` but string was terminated\n   --> $DIR/diagnostic-derive.rs:171:16\n    |\n-LL | #[derive(DiagnosticHandler)]\n+LL | #[derive(Diagnostic)]\n    |           -    ^ expected `'}'` in format string\n    |           |\n    |           because of this opening brace\n    |\n    = note: if you intended to print `{`, you can escape it using `{{`\n-   = note: this error originates in the derive macro `DiagnosticHandler` (in Nightly builds, run with -Z macro-backtrace for more info)\n+   = note: this error originates in the derive macro `Diagnostic` (in Nightly builds, run with -Z macro-backtrace for more info)\n \n error: invalid format string: unmatched `}` found\n   --> $DIR/diagnostic-derive.rs:181:15\n    |\n-LL | #[derive(DiagnosticHandler)]\n+LL | #[derive(Diagnostic)]\n    |               ^ unmatched `}` in format string\n    |\n    = note: if you intended to print `}`, you can escape it using `}}`\n-   = note: this error originates in the derive macro `DiagnosticHandler` (in Nightly builds, run with -Z macro-backtrace for more info)\n+   = note: this error originates in the derive macro `Diagnostic` (in Nightly builds, run with -Z macro-backtrace for more info)\n \n error: the `#[label(...)]` attribute can only be applied to fields of type `Span` or `MultiSpan`\n   --> $DIR/diagnostic-derive.rs:201:5\n@@ -448,7 +448,7 @@ LL | #[diag(nonsense, code = \"E0123\")]\n error[E0277]: the trait bound `Hello: IntoDiagnosticArg` is not satisfied\n   --> $DIR/diagnostic-derive.rs:331:10\n    |\n-LL | #[derive(DiagnosticHandler)]\n+LL | #[derive(Diagnostic)]\n    |          ^^^^^^^^^^^^^^^^^ the trait `IntoDiagnosticArg` is not implemented for `Hello`\n    |\n    = help: normalized in stderr\n@@ -457,7 +457,7 @@ note: required by a bound in `DiagnosticBuilder::<'a, G>::set_arg`\n    |\n LL |         arg: impl IntoDiagnosticArg,\n    |                   ^^^^^^^^^^^^^^^^^ required by this bound in `DiagnosticBuilder::<'a, G>::set_arg`\n-   = note: this error originates in the derive macro `DiagnosticHandler` (in Nightly builds, run with -Z macro-backtrace for more info)\n+   = note: this error originates in the derive macro `Diagnostic` (in Nightly builds, run with -Z macro-backtrace for more info)\n \n error: aborting due to 55 previous errors\n "}]}