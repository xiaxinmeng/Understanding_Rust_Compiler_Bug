{"sha": "53481a5a8fde83ed1a5d7e8302be028a4c7d8da5", "node_id": "C_kwDOAAsO6NoAKDUzNDgxYTVhOGZkZTgzZWQxYTVkN2U4MzAyYmUwMjhhNGM3ZDhkYTU", "commit": {"author": {"name": "Rose Hudson", "email": "cv21874@bristol.ac.uk", "date": "2022-06-22T13:06:13Z"}, "committer": {"name": "Rose Hudson", "email": "cv21874@bristol.ac.uk", "date": "2022-06-22T13:06:13Z"}, "message": "implement `iter_projections` function on `PlaceRef`\n\nthis makes the api more flexible. the original function now calls the PlaceRef\nversion to avoid duplicating the code.", "tree": {"sha": "f79479c3954db7cfe093b33a2e895cab6416a7ab", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f79479c3954db7cfe093b33a2e895cab6416a7ab"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/53481a5a8fde83ed1a5d7e8302be028a4c7d8da5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/53481a5a8fde83ed1a5d7e8302be028a4c7d8da5", "html_url": "https://github.com/rust-lang/rust/commit/53481a5a8fde83ed1a5d7e8302be028a4c7d8da5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/53481a5a8fde83ed1a5d7e8302be028a4c7d8da5/comments", "author": {"login": "rosefromthedead", "id": 3267222, "node_id": "MDQ6VXNlcjMyNjcyMjI=", "avatar_url": "https://avatars.githubusercontent.com/u/3267222?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rosefromthedead", "html_url": "https://github.com/rosefromthedead", "followers_url": "https://api.github.com/users/rosefromthedead/followers", "following_url": "https://api.github.com/users/rosefromthedead/following{/other_user}", "gists_url": "https://api.github.com/users/rosefromthedead/gists{/gist_id}", "starred_url": "https://api.github.com/users/rosefromthedead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rosefromthedead/subscriptions", "organizations_url": "https://api.github.com/users/rosefromthedead/orgs", "repos_url": "https://api.github.com/users/rosefromthedead/repos", "events_url": "https://api.github.com/users/rosefromthedead/events{/privacy}", "received_events_url": "https://api.github.com/users/rosefromthedead/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rosefromthedead", "id": 3267222, "node_id": "MDQ6VXNlcjMyNjcyMjI=", "avatar_url": "https://avatars.githubusercontent.com/u/3267222?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rosefromthedead", "html_url": "https://github.com/rosefromthedead", "followers_url": "https://api.github.com/users/rosefromthedead/followers", "following_url": "https://api.github.com/users/rosefromthedead/following{/other_user}", "gists_url": "https://api.github.com/users/rosefromthedead/gists{/gist_id}", "starred_url": "https://api.github.com/users/rosefromthedead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rosefromthedead/subscriptions", "organizations_url": "https://api.github.com/users/rosefromthedead/orgs", "repos_url": "https://api.github.com/users/rosefromthedead/repos", "events_url": "https://api.github.com/users/rosefromthedead/events{/privacy}", "received_events_url": "https://api.github.com/users/rosefromthedead/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3d829a0922d865d7a77fb284424fd8ba6afaea3b", "url": "https://api.github.com/repos/rust-lang/rust/commits/3d829a0922d865d7a77fb284424fd8ba6afaea3b", "html_url": "https://github.com/rust-lang/rust/commit/3d829a0922d865d7a77fb284424fd8ba6afaea3b"}], "stats": {"total": 22, "additions": 18, "deletions": 4}, "files": [{"sha": "3f5b16d5ea5f7a9d7014d17075e4c109b29d3fce", "filename": "compiler/rustc_middle/src/mir/mod.rs", "status": "modified", "additions": 18, "deletions": 4, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/53481a5a8fde83ed1a5d7e8302be028a4c7d8da5/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/53481a5a8fde83ed1a5d7e8302be028a4c7d8da5/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fmod.rs?ref=53481a5a8fde83ed1a5d7e8302be028a4c7d8da5", "patch": "@@ -2145,10 +2145,7 @@ impl<'tcx> Place<'tcx> {\n     pub fn iter_projections(\n         self,\n     ) -> impl Iterator<Item = (PlaceRef<'tcx>, PlaceElem<'tcx>)> + DoubleEndedIterator {\n-        self.projection.iter().enumerate().map(move |(i, proj)| {\n-            let base = PlaceRef { local: self.local, projection: &self.projection[..i] };\n-            (base, proj)\n-        })\n+        self.as_ref().iter_projections()\n     }\n \n     /// Generates a new place by appending `more_projections` to the existing ones\n@@ -2208,6 +2205,23 @@ impl<'tcx> PlaceRef<'tcx> {\n             None\n         }\n     }\n+\n+    /// Iterate over the projections in evaluation order, i.e., the first element is the base with\n+    /// its projection and then subsequently more projections are added.\n+    /// As a concrete example, given the place a.b.c, this would yield:\n+    /// - (a, .b)\n+    /// - (a.b, .c)\n+    ///\n+    /// Given a place without projections, the iterator is empty.\n+    #[inline]\n+    pub fn iter_projections(\n+        self,\n+    ) -> impl Iterator<Item = (PlaceRef<'tcx>, PlaceElem<'tcx>)> + DoubleEndedIterator {\n+        self.projection.iter().enumerate().map(move |(i, proj)| {\n+            let base = PlaceRef { local: self.local, projection: &self.projection[..i] };\n+            (base, *proj)\n+        })\n+    }\n }\n \n impl Debug for Place<'_> {"}]}