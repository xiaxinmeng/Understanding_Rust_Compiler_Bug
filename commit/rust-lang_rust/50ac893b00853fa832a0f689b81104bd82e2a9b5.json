{"sha": "50ac893b00853fa832a0f689b81104bd82e2a9b5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUwYWM4OTNiMDA4NTNmYTgzMmEwZjY4OWI4MTEwNGJkODJlMmE5YjU=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-05-05T21:31:10Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-05-05T21:31:45Z"}, "message": "Attempt to fix fs.dirname harder.", "tree": {"sha": "e1b2220a5fd356c41330d17234c2ca302d8f18c9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e1b2220a5fd356c41330d17234c2ca302d8f18c9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/50ac893b00853fa832a0f689b81104bd82e2a9b5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/50ac893b00853fa832a0f689b81104bd82e2a9b5", "html_url": "https://github.com/rust-lang/rust/commit/50ac893b00853fa832a0f689b81104bd82e2a9b5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/50ac893b00853fa832a0f689b81104bd82e2a9b5/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9a1f0977a227a14fa521f8e0efe5edcbf81eb597", "url": "https://api.github.com/repos/rust-lang/rust/commits/9a1f0977a227a14fa521f8e0efe5edcbf81eb597", "html_url": "https://github.com/rust-lang/rust/commit/9a1f0977a227a14fa521f8e0efe5edcbf81eb597"}], "stats": {"total": 11, "additions": 4, "deletions": 7}, "files": [{"sha": "0a951e5a6d6aa5781c8785f19acf8461becd5be5", "filename": "src/lib/fs.rs", "status": "modified", "additions": 2, "deletions": 7, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/50ac893b00853fa832a0f689b81104bd82e2a9b5/src%2Flib%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/50ac893b00853fa832a0f689b81104bd82e2a9b5/src%2Flib%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib%2Ffs.rs?ref=50ac893b00853fa832a0f689b81104bd82e2a9b5", "patch": "@@ -9,14 +9,9 @@ fn path_sep() -> str {\n type path = str;\n \n fn dirname(path p) -> path {\n-    auto sep = path_sep();\n-    assert (_str.byte_len(sep) == 1u);\n-    let int i = _str.rindex(p, sep.(0));\n+    let int i = _str.rindex(p, os_fs.path_sep as u8);\n     if (i == -1) {\n-        // FIXME: the '/' character is a path separator on all 3 platforms we\n-        // support. This should probably be generalized a bit more in the\n-        // future, but for now this should work.\n-        i = _str.rindex(p, '/' as u8);\n+        i = _str.rindex(p, os_fs.alt_path_sep as u8);\n         if (i == -1) {\n             ret p;\n         }"}, {"sha": "99f411e7343bbcc2e1307b99b8aff5770965da9d", "filename": "src/lib/posix_fs.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/50ac893b00853fa832a0f689b81104bd82e2a9b5/src%2Flib%2Fposix_fs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/50ac893b00853fa832a0f689b81104bd82e2a9b5/src%2Flib%2Fposix_fs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib%2Fposix_fs.rs?ref=50ac893b00853fa832a0f689b81104bd82e2a9b5", "patch": "@@ -20,6 +20,7 @@ fn list_dir(str path) -> vec[str] {\n }\n \n const char path_sep = '/';\n+const char alt_path_sep = '/';\n \n // Local Variables:\n // mode: rust;"}, {"sha": "94599e3c3dfa6109bd7c3a09b4cfd4106575150b", "filename": "src/lib/win32_fs.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/50ac893b00853fa832a0f689b81104bd82e2a9b5/src%2Flib%2Fwin32_fs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/50ac893b00853fa832a0f689b81104bd82e2a9b5/src%2Flib%2Fwin32_fs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib%2Fwin32_fs.rs?ref=50ac893b00853fa832a0f689b81104bd82e2a9b5", "patch": "@@ -14,6 +14,7 @@ fn list_dir(str path) -> vec[str] {\n  * tag type.\n  */\n const char path_sep = '/';\n+const char alt_path_sep = '\\\\';\n \n // Local Variables:\n // mode: rust;"}]}