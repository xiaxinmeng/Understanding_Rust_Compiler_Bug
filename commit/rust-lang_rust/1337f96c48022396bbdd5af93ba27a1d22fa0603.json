{"sha": "1337f96c48022396bbdd5af93ba27a1d22fa0603", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEzMzdmOTZjNDgwMjIzOTZiYmRkNWFmOTNiYTI3YTFkMjJmYTA2MDM=", "commit": {"author": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2021-02-14T17:58:07Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-02-14T17:58:07Z"}, "message": "Merge pull request #1138 from bjorn3/cirrus_ci\n\nTest FreeBSD on CI", "tree": {"sha": "dd4b3e8dbd902881b2ab8924d6418dbfa007c697", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/dd4b3e8dbd902881b2ab8924d6418dbfa007c697"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1337f96c48022396bbdd5af93ba27a1d22fa0603", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgKWSvCRBK7hj4Ov3rIwAAdHIIAGCvWhYN2ySG2tyqc7UVmny7\nYovrnohdO3XGEdKs6EQAC6TLKiRbUyXKi9cYdAAunPd1DeUG1Icd0mD0+SD3ePoS\nHYoZbdAAvB/R9v/YISUVTdPdExOIG3KUkqjDXAVdA2k4ZUdOv5WXIQ03tUnfWs8n\nSFVwWjFxqgMTlduxR/SdkXkIV2juyjUAl0lEUAsDQAkREqdqMoV7//LC7DITxpco\nmL0g0PAIcqjpLwaoJU1gNGrsupzN7KcQnbMn3/oUZR8z1Y7x6bkoQ5IziF06F221\n/XHrrzkvYLaOBgf2tE322rvhvqLcPFhVIGbNMVdghRPPR44Hoad0ota3PiMZZ9s=\n=GS53\n-----END PGP SIGNATURE-----\n", "payload": "tree dd4b3e8dbd902881b2ab8924d6418dbfa007c697\nparent 658d12408bfec3b499f24ccdffbec9e8679e87a1\nparent 47bc1db236e5117021aa2eda575436bf90f889b2\nauthor bjorn3 <bjorn3@users.noreply.github.com> 1613325487 +0100\ncommitter GitHub <noreply@github.com> 1613325487 +0100\n\nMerge pull request #1138 from bjorn3/cirrus_ci\n\nTest FreeBSD on CI"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1337f96c48022396bbdd5af93ba27a1d22fa0603", "html_url": "https://github.com/rust-lang/rust/commit/1337f96c48022396bbdd5af93ba27a1d22fa0603", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1337f96c48022396bbdd5af93ba27a1d22fa0603/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "658d12408bfec3b499f24ccdffbec9e8679e87a1", "url": "https://api.github.com/repos/rust-lang/rust/commits/658d12408bfec3b499f24ccdffbec9e8679e87a1", "html_url": "https://github.com/rust-lang/rust/commit/658d12408bfec3b499f24ccdffbec9e8679e87a1"}, {"sha": "47bc1db236e5117021aa2eda575436bf90f889b2", "url": "https://api.github.com/repos/rust-lang/rust/commits/47bc1db236e5117021aa2eda575436bf90f889b2", "html_url": "https://github.com/rust-lang/rust/commit/47bc1db236e5117021aa2eda575436bf90f889b2"}], "stats": {"total": 51, "additions": 38, "deletions": 13}, "files": [{"sha": "e173df423a76523f092160e138d648ea64c29651", "filename": ".cirrus.yml", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/1337f96c48022396bbdd5af93ba27a1d22fa0603/.cirrus.yml", "raw_url": "https://github.com/rust-lang/rust/raw/1337f96c48022396bbdd5af93ba27a1d22fa0603/.cirrus.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.cirrus.yml?ref=1337f96c48022396bbdd5af93ba27a1d22fa0603", "patch": "@@ -0,0 +1,25 @@\n+task:\n+  name: freebsd\n+  freebsd_instance:\n+    image: freebsd-12-1-release-amd64\n+  setup_rust_script:\n+    - pkg install -y curl git bash\n+    - curl https://sh.rustup.rs -sSf --output rustup.sh\n+    - sh rustup.sh --default-toolchain none -y --profile=minimal\n+  cargo_bin_cache:\n+    folder: ~/.cargo/bin\n+  target_cache:\n+    folder: target\n+  prepare_script:\n+    - . $HOME/.cargo/env\n+    - git config --global user.email \"user@example.com\"\n+    - git config --global user.name \"User\"\n+    - ./prepare.sh\n+  test_script:\n+    - . $HOME/.cargo/env\n+    - # Enable backtraces for easier debugging\n+    - export RUST_BACKTRACE=1\n+    - # Reduce amount of benchmark runs as they are slow\n+    - export COMPILE_RUNS=2\n+    - export RUN_RUNS=2\n+    - ./test.sh"}, {"sha": "52bc21d0a17603c7a6b15e111d61193591bc5721", "filename": "build.sh", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/1337f96c48022396bbdd5af93ba27a1d22fa0603/build.sh", "raw_url": "https://github.com/rust-lang/rust/raw/1337f96c48022396bbdd5af93ba27a1d22fa0603/build.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/build.sh?ref=1337f96c48022396bbdd5af93ba27a1d22fa0603", "patch": "@@ -1,4 +1,4 @@\n-#!/bin/bash\n+#!/usr/bin/env bash\n set -e\n \n # Settings\n@@ -34,13 +34,13 @@ done\n # Build cg_clif\n unset CARGO_TARGET_DIR\n unamestr=$(uname)\n-if [[ \"$unamestr\" == 'Linux' ]]; then\n+if [[ \"$unamestr\" == 'Linux' || \"$unamestr\" == \"FreeBSD\" ]]; then\n    export RUSTFLAGS='-Clink-arg=-Wl,-rpath=$ORIGIN/../lib '$RUSTFLAGS\n elif [[ \"$unamestr\" == 'Darwin' ]]; then\n    export RUSTFLAGS='-Csplit-debuginfo=unpacked -Clink-arg=-Wl,-rpath,@loader_path/../lib -Zosx-rpath-install-name '$RUSTFLAGS\n    dylib_ext='dylib'\n else\n-   echo \"Unsupported os\"\n+   echo \"Unsupported os $unamestr\"\n    exit 1\n fi\n if [[ \"$CHANNEL\" == \"release\" ]]; then"}, {"sha": "636aa5f3f3dc2d1793f27270e3f270353e7b8f54", "filename": "build_sysroot/build_sysroot.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1337f96c48022396bbdd5af93ba27a1d22fa0603/build_sysroot%2Fbuild_sysroot.sh", "raw_url": "https://github.com/rust-lang/rust/raw/1337f96c48022396bbdd5af93ba27a1d22fa0603/build_sysroot%2Fbuild_sysroot.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/build_sysroot%2Fbuild_sysroot.sh?ref=1337f96c48022396bbdd5af93ba27a1d22fa0603", "patch": "@@ -1,4 +1,4 @@\n-#!/bin/bash\n+#!/usr/bin/env bash\n \n # Requires the CHANNEL env var to be set to `debug` or `release.`\n "}, {"sha": "d6e012148ac7e552711535674ab9ef2b21adfbf1", "filename": "build_sysroot/prepare_sysroot_src.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1337f96c48022396bbdd5af93ba27a1d22fa0603/build_sysroot%2Fprepare_sysroot_src.sh", "raw_url": "https://github.com/rust-lang/rust/raw/1337f96c48022396bbdd5af93ba27a1d22fa0603/build_sysroot%2Fprepare_sysroot_src.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/build_sysroot%2Fprepare_sysroot_src.sh?ref=1337f96c48022396bbdd5af93ba27a1d22fa0603", "patch": "@@ -1,4 +1,4 @@\n-#!/bin/bash\n+#!/usr/bin/env bash\n set -e\n cd \"$(dirname \"$0\")\"\n "}, {"sha": "a7bbeb05cac5a094bc0103d5f676452cef77f8a5", "filename": "clean_all.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1337f96c48022396bbdd5af93ba27a1d22fa0603/clean_all.sh", "raw_url": "https://github.com/rust-lang/rust/raw/1337f96c48022396bbdd5af93ba27a1d22fa0603/clean_all.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clean_all.sh?ref=1337f96c48022396bbdd5af93ba27a1d22fa0603", "patch": "@@ -1,4 +1,4 @@\n-#!/bin/bash --verbose\n+#!/usr/bin/env bash\n set -e\n \n rm -rf target/ build/ build_sysroot/{sysroot_src/,target/,compiler-builtins/} perf.data{,.old}"}, {"sha": "ee995ffcfa9f7df9692746f6ca56506de949ef2b", "filename": "prepare.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1337f96c48022396bbdd5af93ba27a1d22fa0603/prepare.sh", "raw_url": "https://github.com/rust-lang/rust/raw/1337f96c48022396bbdd5af93ba27a1d22fa0603/prepare.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/prepare.sh?ref=1337f96c48022396bbdd5af93ba27a1d22fa0603", "patch": "@@ -1,4 +1,4 @@\n-#!/bin/bash --verbose\n+#!/usr/bin/env bash\n set -e\n \n rustup component add rust-src rustc-dev llvm-tools-preview"}, {"sha": "669d2d45b71b5471e874e475e63bcff7108884fc", "filename": "scripts/cargo.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1337f96c48022396bbdd5af93ba27a1d22fa0603/scripts%2Fcargo.sh", "raw_url": "https://github.com/rust-lang/rust/raw/1337f96c48022396bbdd5af93ba27a1d22fa0603/scripts%2Fcargo.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/scripts%2Fcargo.sh?ref=1337f96c48022396bbdd5af93ba27a1d22fa0603", "patch": "@@ -1,4 +1,4 @@\n-#!/bin/bash\n+#!/usr/bin/env bash\n \n dir=$(dirname \"$0\")\n source \"$dir/config.sh\""}, {"sha": "e1f54e4a8b551f23f64ecb0b02d951e9045e18fe", "filename": "scripts/config.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1337f96c48022396bbdd5af93ba27a1d22fa0603/scripts%2Fconfig.sh", "raw_url": "https://github.com/rust-lang/rust/raw/1337f96c48022396bbdd5af93ba27a1d22fa0603/scripts%2Fconfig.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/scripts%2Fconfig.sh?ref=1337f96c48022396bbdd5af93ba27a1d22fa0603", "patch": "@@ -3,7 +3,7 @@\n set -e\n \n unamestr=$(uname)\n-if [[ \"$unamestr\" == 'Linux' ]]; then\n+if [[ \"$unamestr\" == 'Linux' || \"$unamestr\" == 'FreeBSD' ]]; then\n    dylib_ext='so'\n elif [[ \"$unamestr\" == 'Darwin' ]]; then\n    dylib_ext='dylib'"}, {"sha": "694945a87c268deaa890288ab55ff7b5bbe1f601", "filename": "scripts/rustup.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1337f96c48022396bbdd5af93ba27a1d22fa0603/scripts%2Frustup.sh", "raw_url": "https://github.com/rust-lang/rust/raw/1337f96c48022396bbdd5af93ba27a1d22fa0603/scripts%2Frustup.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/scripts%2Frustup.sh?ref=1337f96c48022396bbdd5af93ba27a1d22fa0603", "patch": "@@ -1,4 +1,4 @@\n-#!/bin/bash\n+#!/usr/bin/env bash\n \n set -e\n "}, {"sha": "5bc454884446873b19943710c0ce9bdc7cdb844b", "filename": "scripts/test_bootstrap.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1337f96c48022396bbdd5af93ba27a1d22fa0603/scripts%2Ftest_bootstrap.sh", "raw_url": "https://github.com/rust-lang/rust/raw/1337f96c48022396bbdd5af93ba27a1d22fa0603/scripts%2Ftest_bootstrap.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/scripts%2Ftest_bootstrap.sh?ref=1337f96c48022396bbdd5af93ba27a1d22fa0603", "patch": "@@ -1,4 +1,4 @@\n-#!/bin/bash\n+#!/usr/bin/env bash\n set -e\n \n cd \"$(dirname \"$0\")/../\""}, {"sha": "cfc0c3fe9bd466b7fa899e9390a86bb0afe6262a", "filename": "scripts/tests.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1337f96c48022396bbdd5af93ba27a1d22fa0603/scripts%2Ftests.sh", "raw_url": "https://github.com/rust-lang/rust/raw/1337f96c48022396bbdd5af93ba27a1d22fa0603/scripts%2Ftests.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/scripts%2Ftests.sh?ref=1337f96c48022396bbdd5af93ba27a1d22fa0603", "patch": "@@ -1,4 +1,4 @@\n-#!/bin/bash\n+#!/usr/bin/env bash\n \n set -e\n "}, {"sha": "e222adc7b80582ec7169a0c65f2fd9d34af00341", "filename": "test.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1337f96c48022396bbdd5af93ba27a1d22fa0603/test.sh", "raw_url": "https://github.com/rust-lang/rust/raw/1337f96c48022396bbdd5af93ba27a1d22fa0603/test.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test.sh?ref=1337f96c48022396bbdd5af93ba27a1d22fa0603", "patch": "@@ -1,4 +1,4 @@\n-#!/bin/bash\n+#!/usr/bin/env bash\n set -e\n \n ./build.sh --sysroot none \"$@\""}]}