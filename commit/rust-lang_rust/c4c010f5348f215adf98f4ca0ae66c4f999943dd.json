{"sha": "c4c010f5348f215adf98f4ca0ae66c4f999943dd", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM0YzAxMGY1MzQ4ZjIxNWFkZjk4ZjRjYTBhZTY2YzRmOTk5OTQzZGQ=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-01-04T14:05:36Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-01-04T14:05:36Z"}, "message": "Add an error in case the doc alias is the same as the item it's aliasing", "tree": {"sha": "57a2286d5e043ee97a822596b2cc60374023ecd0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/57a2286d5e043ee97a822596b2cc60374023ecd0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c4c010f5348f215adf98f4ca0ae66c4f999943dd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c4c010f5348f215adf98f4ca0ae66c4f999943dd", "html_url": "https://github.com/rust-lang/rust/commit/c4c010f5348f215adf98f4ca0ae66c4f999943dd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c4c010f5348f215adf98f4ca0ae66c4f999943dd/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "887398ff688e2e3cf8a95e588d0b51420e08fb6b", "url": "https://api.github.com/repos/rust-lang/rust/commits/887398ff688e2e3cf8a95e588d0b51420e08fb6b", "html_url": "https://github.com/rust-lang/rust/commit/887398ff688e2e3cf8a95e588d0b51420e08fb6b"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "420c002c5fc4647451f80d53e9953de08890f50d", "filename": "compiler/rustc_passes/src/check_attr.rs", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/c4c010f5348f215adf98f4ca0ae66c4f999943dd/compiler%2Frustc_passes%2Fsrc%2Fcheck_attr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c4c010f5348f215adf98f4ca0ae66c4f999943dd/compiler%2Frustc_passes%2Fsrc%2Fcheck_attr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Fcheck_attr.rs?ref=c4c010f5348f215adf98f4ca0ae66c4f999943dd", "patch": "@@ -310,7 +310,7 @@ impl CheckAttrVisitor<'tcx> {\n                 .sess\n                 .struct_span_err(\n                     meta.name_value_literal_span().unwrap_or_else(|| meta.span()),\n-                    &format!(\"{:?} character isn't allowed in `#[doc(alias = \\\"...\\\")]`\", c,),\n+                    &format!(\"{:?} character isn't allowed in `#[doc(alias = \\\"...\\\")]`\", c),\n                 )\n                 .emit();\n             return false;\n@@ -358,6 +358,17 @@ impl CheckAttrVisitor<'tcx> {\n                 .emit();\n             return false;\n         }\n+        let item_name = self.tcx.hir().name(hir_id);\n+        if item_name.to_string() == doc_alias {\n+            self.tcx\n+                .sess\n+                .struct_span_err(\n+                    meta.span(),\n+                    &format!(\"`#[doc(alias = \\\"...\\\")]` is the same as the item's name\"),\n+                )\n+                .emit();\n+            return false;\n+        }\n         true\n     }\n "}]}