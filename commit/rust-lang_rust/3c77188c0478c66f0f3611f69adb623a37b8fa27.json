{"sha": "3c77188c0478c66f0f3611f69adb623a37b8fa27", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNjNzcxODhjMDQ3OGM2NmYwZjM2MTFmNjlhZGI2MjNhMzdiOGZhMjc=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-04-14T19:33:11Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-04-14T19:33:11Z"}, "message": "Auto merge of #5460 - phansch:fix_incorrect_tests, r=matthiaskrgr\n\nresult_map_unit_fn: Fix incorrect UI tests\n\n`x` and the `HasResult` struct were missing in this file.\n\nchangelog: none", "tree": {"sha": "16f7deac50f6f0d32d183f61ce4eab74d2770b9d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/16f7deac50f6f0d32d183f61ce4eab74d2770b9d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3c77188c0478c66f0f3611f69adb623a37b8fa27", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3c77188c0478c66f0f3611f69adb623a37b8fa27", "html_url": "https://github.com/rust-lang/rust/commit/3c77188c0478c66f0f3611f69adb623a37b8fa27", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3c77188c0478c66f0f3611f69adb623a37b8fa27/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d236b30a1d638340aad8345fa2946cfe9543dcf0", "url": "https://api.github.com/repos/rust-lang/rust/commits/d236b30a1d638340aad8345fa2946cfe9543dcf0", "html_url": "https://github.com/rust-lang/rust/commit/d236b30a1d638340aad8345fa2946cfe9543dcf0"}, {"sha": "9a52d520686627ab8835ed6d48dfffe3a1a6adac", "url": "https://api.github.com/repos/rust-lang/rust/commits/9a52d520686627ab8835ed6d48dfffe3a1a6adac", "html_url": "https://github.com/rust-lang/rust/commit/9a52d520686627ab8835ed6d48dfffe3a1a6adac"}], "stats": {"total": 67, "additions": 52, "deletions": 15}, "files": [{"sha": "b197c609d7bfcc7b347c8c8213a556a7365d8e09", "filename": "tests/ui/result_map_unit_fn_unfixable.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/3c77188c0478c66f0f3611f69adb623a37b8fa27/tests%2Fui%2Fresult_map_unit_fn_unfixable.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c77188c0478c66f0f3611f69adb623a37b8fa27/tests%2Fui%2Fresult_map_unit_fn_unfixable.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fresult_map_unit_fn_unfixable.rs?ref=3c77188c0478c66f0f3611f69adb623a37b8fa27", "patch": "@@ -2,6 +2,10 @@\n #![feature(never_type)]\n #![allow(unused)]\n \n+struct HasResult {\n+    field: Result<usize, usize>,\n+}\n+\n fn do_nothing<T>(_: T) {}\n \n fn diverge<T>(_: T) -> ! {\n@@ -14,6 +18,8 @@ fn plus_one(value: usize) -> usize {\n \n #[rustfmt::skip]\n fn result_map_unit_fn() {\n+    let x = HasResult { field: Ok(10) };\n+\n     x.field.map(|value| { do_nothing(value); do_nothing(value) });\n \n     x.field.map(|value| if value > 0 { do_nothing(value); do_nothing(value) });"}, {"sha": "b23cc608621d0fa3880ac27766d86d6349c5a76d", "filename": "tests/ui/result_map_unit_fn_unfixable.stderr", "status": "modified", "additions": 46, "deletions": 15, "changes": 61, "blob_url": "https://github.com/rust-lang/rust/blob/3c77188c0478c66f0f3611f69adb623a37b8fa27/tests%2Fui%2Fresult_map_unit_fn_unfixable.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3c77188c0478c66f0f3611f69adb623a37b8fa27/tests%2Fui%2Fresult_map_unit_fn_unfixable.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fresult_map_unit_fn_unfixable.stderr?ref=3c77188c0478c66f0f3611f69adb623a37b8fa27", "patch": "@@ -1,27 +1,58 @@\n-error[E0425]: cannot find value `x` in this scope\n-  --> $DIR/result_map_unit_fn_unfixable.rs:17:5\n+error: called `map(f)` on an `Result` value where `f` is a closure that returns the unit type\n+  --> $DIR/result_map_unit_fn_unfixable.rs:23:5\n    |\n LL |     x.field.map(|value| { do_nothing(value); do_nothing(value) });\n-   |     ^ not found in this scope\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^-\n+   |     |\n+   |     help: try this: `if let Ok(value) = x.field { ... }`\n+   |\n+   = note: `-D clippy::result-map-unit-fn` implied by `-D warnings`\n \n-error[E0425]: cannot find value `x` in this scope\n-  --> $DIR/result_map_unit_fn_unfixable.rs:19:5\n+error: called `map(f)` on an `Result` value where `f` is a closure that returns the unit type\n+  --> $DIR/result_map_unit_fn_unfixable.rs:25:5\n    |\n LL |     x.field.map(|value| if value > 0 { do_nothing(value); do_nothing(value) });\n-   |     ^ not found in this scope\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^-\n+   |     |\n+   |     help: try this: `if let Ok(value) = x.field { ... }`\n \n-error[E0425]: cannot find value `x` in this scope\n-  --> $DIR/result_map_unit_fn_unfixable.rs:23:5\n+error: called `map(f)` on an `Result` value where `f` is a closure that returns the unit type\n+  --> $DIR/result_map_unit_fn_unfixable.rs:29:5\n    |\n-LL |     x.field.map(|value| {\n-   |     ^ not found in this scope\n+LL |        x.field.map(|value| {\n+   |   _____^\n+   |  |_____|\n+   | ||\n+LL | ||         do_nothing(value);\n+LL | ||         do_nothing(value)\n+LL | ||     });\n+   | ||______^- help: try this: `if let Ok(value) = x.field { ... }`\n+   | |_______|\n+   | \n \n-error[E0425]: cannot find value `x` in this scope\n-  --> $DIR/result_map_unit_fn_unfixable.rs:27:5\n+error: called `map(f)` on an `Result` value where `f` is a closure that returns the unit type\n+  --> $DIR/result_map_unit_fn_unfixable.rs:33:5\n    |\n LL |     x.field.map(|value| { do_nothing(value); do_nothing(value); });\n-   |     ^ not found in this scope\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^-\n+   |     |\n+   |     help: try this: `if let Ok(value) = x.field { ... }`\n+\n+error: called `map(f)` on an `Result` value where `f` is a function that returns the unit type\n+  --> $DIR/result_map_unit_fn_unfixable.rs:37:5\n+   |\n+LL |     \"12\".parse::<i32>().map(diverge);\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^-\n+   |     |\n+   |     help: try this: `if let Ok(a) = \"12\".parse::<i32>() { diverge(a) }`\n+\n+error: called `map(f)` on an `Result` value where `f` is a function that returns the unit type\n+  --> $DIR/result_map_unit_fn_unfixable.rs:43:5\n+   |\n+LL |     y.map(do_nothing);\n+   |     ^^^^^^^^^^^^^^^^^-\n+   |     |\n+   |     help: try this: `if let Ok(_y) = y { do_nothing(_y) }`\n \n-error: aborting due to 4 previous errors\n+error: aborting due to 6 previous errors\n \n-For more information about this error, try `rustc --explain E0425`."}]}