{"sha": "76ff5b7c15b2c4e85895a49e5859e546d1d6227e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc2ZmY1YjdjMTViMmM0ZTg1ODk1YTQ5ZTU4NTllNTQ2ZDFkNjIyN2U=", "commit": {"author": {"name": "Edwin Cheng", "email": "edwin0cheng@gmail.com", "date": "2019-12-03T11:33:48Z"}, "committer": {"name": "Edwin Cheng", "email": "edwin0cheng@gmail.com", "date": "2019-12-06T15:48:45Z"}, "message": "Add tests", "tree": {"sha": "c7787cb5e4f1eae6c2946d880c9cdc6337535317", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c7787cb5e4f1eae6c2946d880c9cdc6337535317"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/76ff5b7c15b2c4e85895a49e5859e546d1d6227e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/76ff5b7c15b2c4e85895a49e5859e546d1d6227e", "html_url": "https://github.com/rust-lang/rust/commit/76ff5b7c15b2c4e85895a49e5859e546d1d6227e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/76ff5b7c15b2c4e85895a49e5859e546d1d6227e/comments", "author": {"login": "edwin0cheng", "id": 11014119, "node_id": "MDQ6VXNlcjExMDE0MTE5", "avatar_url": "https://avatars.githubusercontent.com/u/11014119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edwin0cheng", "html_url": "https://github.com/edwin0cheng", "followers_url": "https://api.github.com/users/edwin0cheng/followers", "following_url": "https://api.github.com/users/edwin0cheng/following{/other_user}", "gists_url": "https://api.github.com/users/edwin0cheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/edwin0cheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edwin0cheng/subscriptions", "organizations_url": "https://api.github.com/users/edwin0cheng/orgs", "repos_url": "https://api.github.com/users/edwin0cheng/repos", "events_url": "https://api.github.com/users/edwin0cheng/events{/privacy}", "received_events_url": "https://api.github.com/users/edwin0cheng/received_events", "type": "User", "site_admin": false}, "committer": {"login": "edwin0cheng", "id": 11014119, "node_id": "MDQ6VXNlcjExMDE0MTE5", "avatar_url": "https://avatars.githubusercontent.com/u/11014119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edwin0cheng", "html_url": "https://github.com/edwin0cheng", "followers_url": "https://api.github.com/users/edwin0cheng/followers", "following_url": "https://api.github.com/users/edwin0cheng/following{/other_user}", "gists_url": "https://api.github.com/users/edwin0cheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/edwin0cheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edwin0cheng/subscriptions", "organizations_url": "https://api.github.com/users/edwin0cheng/orgs", "repos_url": "https://api.github.com/users/edwin0cheng/repos", "events_url": "https://api.github.com/users/edwin0cheng/events{/privacy}", "received_events_url": "https://api.github.com/users/edwin0cheng/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a25e8cff6755c1a0c46ee3690dcd75b641c0b3e4", "url": "https://api.github.com/repos/rust-lang/rust/commits/a25e8cff6755c1a0c46ee3690dcd75b641c0b3e4", "html_url": "https://github.com/rust-lang/rust/commit/a25e8cff6755c1a0c46ee3690dcd75b641c0b3e4"}], "stats": {"total": 61, "additions": 61, "deletions": 0}, "files": [{"sha": "61cdd768e87b5bf30f2de680526599e97798b218", "filename": "crates/ra_hir_def/src/nameres/tests.rs", "status": "modified", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/76ff5b7c15b2c4e85895a49e5859e546d1d6227e/crates%2Fra_hir_def%2Fsrc%2Fnameres%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/76ff5b7c15b2c4e85895a49e5859e546d1d6227e/crates%2Fra_hir_def%2Fsrc%2Fnameres%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir_def%2Fsrc%2Fnameres%2Ftests.rs?ref=76ff5b7c15b2c4e85895a49e5859e546d1d6227e", "patch": "@@ -558,3 +558,35 @@ fn cfg_test() {\n         \u22eeFoo: t v\n     \"###);\n }\n+\n+#[test]\n+fn infer_multiple_namespace() {\n+    let map = def_map(\n+        r#\"\n+//- /main.rs\n+mod a {\n+    pub type T = ();\n+    pub use crate::b::*;\n+}\n+\n+use crate::a::T;\n+\n+mod b {\n+    pub const T: () = ();\n+}\n+\"#,\n+    );\n+\n+    assert_snapshot!(map, @r###\"\n+    \u22eecrate\n+    \u22eeT: t v\n+    \u22eea: t\n+    \u22eeb: t\n+    \u22ee\n+    \u22eecrate::b\n+    \u22eeT: v\n+    \u22ee\n+    \u22eecrate::a\n+    \u22eeT: t v    \n+\"###);\n+}"}, {"sha": "812f171db8ed428ccf7a996294cd000b66f7d73e", "filename": "crates/ra_hir_ty/src/tests/macros.rs", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/76ff5b7c15b2c4e85895a49e5859e546d1d6227e/crates%2Fra_hir_ty%2Fsrc%2Ftests%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/76ff5b7c15b2c4e85895a49e5859e546d1d6227e/crates%2Fra_hir_ty%2Fsrc%2Ftests%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir_ty%2Fsrc%2Ftests%2Fmacros.rs?ref=76ff5b7c15b2c4e85895a49e5859e546d1d6227e", "patch": "@@ -210,6 +210,35 @@ pub fn baz() -> usize { 31usize }\n     assert_eq!(\"(i32, usize)\", type_at_pos(&db, pos));\n }\n \n+#[test]\n+fn infer_type_value_non_legacy_macro_use_as() {\n+    assert_snapshot!(\n+        infer(r#\"\n+mod m {\n+    macro_rules! _foo {\n+        ($x:ident) => { type $x = u64; }\n+    }\n+    pub(crate) use _foo as foo;\n+}\n+\n+m::foo!(foo);\n+use foo as bar;\n+fn f() -> bar { 0 }\n+fn main() {  \n+    let _a  = f();\n+}\n+\"#),\n+        @r###\"\n+        [159; 164) '{ 0 }': u64\n+        [161; 162) '0': u64\n+        [175; 199) '{     ...f(); }': ()\n+        [187; 189) '_a': u64\n+        [193; 194) 'f': fn f() -> u64\n+        [193; 196) 'f()': u64        \n+    \"###\n+    );\n+}\n+\n #[test]\n fn infer_builtin_macros_line() {\n     assert_snapshot!("}]}