{"sha": "12c70871cca736afa44379e59f8573c60b0ccd0a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEyYzcwODcxY2NhNzM2YWZhNDQzNzllNTlmODU3M2M2MGIwY2NkMGE=", "commit": {"author": {"name": "Florian Diebold", "email": "flodiebold@gmail.com", "date": "2019-02-09T09:51:06Z"}, "committer": {"name": "Florian Diebold", "email": "flodiebold@gmail.com", "date": "2019-02-09T10:15:25Z"}, "message": "Remove SmolStr from project model", "tree": {"sha": "189d7482e74c54b9ee2f3bb05dc7207c4e424cb0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/189d7482e74c54b9ee2f3bb05dc7207c4e424cb0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/12c70871cca736afa44379e59f8573c60b0ccd0a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/12c70871cca736afa44379e59f8573c60b0ccd0a", "html_url": "https://github.com/rust-lang/rust/commit/12c70871cca736afa44379e59f8573c60b0ccd0a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/12c70871cca736afa44379e59f8573c60b0ccd0a/comments", "author": {"login": "flodiebold", "id": 906069, "node_id": "MDQ6VXNlcjkwNjA2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/906069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flodiebold", "html_url": "https://github.com/flodiebold", "followers_url": "https://api.github.com/users/flodiebold/followers", "following_url": "https://api.github.com/users/flodiebold/following{/other_user}", "gists_url": "https://api.github.com/users/flodiebold/gists{/gist_id}", "starred_url": "https://api.github.com/users/flodiebold/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flodiebold/subscriptions", "organizations_url": "https://api.github.com/users/flodiebold/orgs", "repos_url": "https://api.github.com/users/flodiebold/repos", "events_url": "https://api.github.com/users/flodiebold/events{/privacy}", "received_events_url": "https://api.github.com/users/flodiebold/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flodiebold", "id": 906069, "node_id": "MDQ6VXNlcjkwNjA2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/906069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flodiebold", "html_url": "https://github.com/flodiebold", "followers_url": "https://api.github.com/users/flodiebold/followers", "following_url": "https://api.github.com/users/flodiebold/following{/other_user}", "gists_url": "https://api.github.com/users/flodiebold/gists{/gist_id}", "starred_url": "https://api.github.com/users/flodiebold/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flodiebold/subscriptions", "organizations_url": "https://api.github.com/users/flodiebold/orgs", "repos_url": "https://api.github.com/users/flodiebold/repos", "events_url": "https://api.github.com/users/flodiebold/events{/privacy}", "received_events_url": "https://api.github.com/users/flodiebold/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ddbf43b630fa8159ab2ea5e959393bff44e0c73b", "url": "https://api.github.com/repos/rust-lang/rust/commits/ddbf43b630fa8159ab2ea5e959393bff44e0c73b", "html_url": "https://github.com/rust-lang/rust/commit/ddbf43b630fa8159ab2ea5e959393bff44e0c73b"}], "stats": {"total": 26, "additions": 7, "deletions": 19}, "files": [{"sha": "a76d0b2fe96e0645a15fc4f2a661a1456735a61f", "filename": "Cargo.lock", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/12c70871cca736afa44379e59f8573c60b0ccd0a/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/12c70871cca736afa44379e59f8573c60b0ccd0a/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=12c70871cca736afa44379e59f8573c60b0ccd0a", "patch": "@@ -1057,7 +1057,6 @@ dependencies = [\n  \"ra_db 0.1.0\",\n  \"ra_vfs 0.1.0\",\n  \"rustc-hash 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"smol_str 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"test_utils 0.1.0\",\n  \"walkdir 2.2.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]"}, {"sha": "996dce351e2abf84c4e57ee173110f13782806da", "filename": "crates/ra_project_model/Cargo.toml", "status": "modified", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/12c70871cca736afa44379e59f8573c60b0ccd0a/crates%2Fra_project_model%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/12c70871cca736afa44379e59f8573c60b0ccd0a/crates%2Fra_project_model%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_project_model%2FCargo.toml?ref=12c70871cca736afa44379e59f8573c60b0ccd0a", "patch": "@@ -5,21 +5,13 @@ version = \"0.1.0\"\n authors = [\"Aleksey Kladov <aleksey.kladov@gmail.com>\"]\n \n [dependencies]\n-# itertools = \"0.8.0\"\n-# join_to_string = \"0.1.3\"\n log = \"0.4.5\"\n-# relative-path = \"0.4.0\"\n-# rayon = \"1.0.2\"\n-# fst = \"0.3.1\"\n rustc-hash = \"1.0\"\n-# parking_lot = \"0.7.0\"\n-# unicase = \"2.2.0\"\n \n # TODO get rid of these?\n failure = \"0.1.4\"\n failure_derive = \"0.1.4\"\n \n-smol_str = { version = \"0.1.9\", features = [\"serde\"] }\n walkdir = \"2.2.7\"\n \n cargo_metadata = \"0.7.0\""}, {"sha": "8adf463a6eef41a2253f8915aa18ec519ce8046e", "filename": "crates/ra_project_model/src/cargo_workspace.rs", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/12c70871cca736afa44379e59f8573c60b0ccd0a/crates%2Fra_project_model%2Fsrc%2Fcargo_workspace.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12c70871cca736afa44379e59f8573c60b0ccd0a/crates%2Fra_project_model%2Fsrc%2Fcargo_workspace.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_project_model%2Fsrc%2Fcargo_workspace.rs?ref=12c70871cca736afa44379e59f8573c60b0ccd0a", "patch": "@@ -1,7 +1,6 @@\n use std::path::{Path, PathBuf};\n \n use cargo_metadata::{MetadataCommand, CargoOpt};\n-use smol_str::SmolStr;\n use ra_arena::{Arena, RawId, impl_arena_id};\n use rustc_hash::FxHashMap;\n use failure::format_err;\n@@ -31,7 +30,7 @@ impl_arena_id!(Target);\n \n #[derive(Debug, Clone)]\n struct PackageData {\n-    name: SmolStr,\n+    name: String,\n     manifest: PathBuf,\n     targets: Vec<Target>,\n     is_member: bool,\n@@ -41,13 +40,13 @@ struct PackageData {\n #[derive(Debug, Clone)]\n pub struct PackageDependency {\n     pub pkg: Package,\n-    pub name: SmolStr,\n+    pub name: String,\n }\n \n #[derive(Debug, Clone)]\n struct TargetData {\n     pkg: Package,\n-    name: SmolStr,\n+    name: String,\n     root: PathBuf,\n     kind: TargetKind,\n }"}, {"sha": "abc79684c51f0cb939954565788a967021b90e6e", "filename": "crates/ra_project_model/src/lib.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/12c70871cca736afa44379e59f8573c60b0ccd0a/crates%2Fra_project_model%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12c70871cca736afa44379e59f8573c60b0ccd0a/crates%2Fra_project_model%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_project_model%2Fsrc%2Flib.rs?ref=12c70871cca736afa44379e59f8573c60b0ccd0a", "patch": "@@ -47,7 +47,7 @@ impl ProjectWorkspace {\n                 if let (Some(&from), Some(&to)) =\n                     (sysroot_crates.get(&from), sysroot_crates.get(&to))\n                 {\n-                    if let Err(_) = crate_graph.add_dep(from, name.clone(), to) {\n+                    if let Err(_) = crate_graph.add_dep(from, name.into(), to) {\n                         log::error!(\"cyclic dependency between sysroot crates\")\n                     }\n                 }\n@@ -101,7 +101,7 @@ impl ProjectWorkspace {\n             for dep in pkg.dependencies(&self.cargo) {\n                 if let Some(&to) = pkg_to_lib_crate.get(&dep.pkg) {\n                     for &from in pkg_crates.get(&pkg).into_iter().flatten() {\n-                        if let Err(_) = crate_graph.add_dep(from, dep.name.clone(), to) {\n+                        if let Err(_) = crate_graph.add_dep(from, dep.name.clone().into(), to) {\n                             log::error!(\n                                 \"cyclic dependency {} -> {}\",\n                                 pkg.name(&self.cargo),"}, {"sha": "8b87aa7bdafd755f410c7b9f54740f7cd698a40e", "filename": "crates/ra_project_model/src/sysroot.rs", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/12c70871cca736afa44379e59f8573c60b0ccd0a/crates%2Fra_project_model%2Fsrc%2Fsysroot.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12c70871cca736afa44379e59f8573c60b0ccd0a/crates%2Fra_project_model%2Fsrc%2Fsysroot.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_project_model%2Fsrc%2Fsysroot.rs?ref=12c70871cca736afa44379e59f8573c60b0ccd0a", "patch": "@@ -3,8 +3,6 @@ use std::{\n     process::Command,\n };\n \n-use smol_str::SmolStr;\n-\n use ra_arena::{Arena, RawId, impl_arena_id};\n \n use crate::Result;\n@@ -20,7 +18,7 @@ impl_arena_id!(SysrootCrate);\n \n #[derive(Debug, Clone)]\n struct SysrootCrateData {\n-    name: SmolStr,\n+    name: String,\n     root: PathBuf,\n     deps: Vec<SysrootCrate>,\n }\n@@ -81,7 +79,7 @@ impl Sysroot {\n }\n \n impl SysrootCrate {\n-    pub fn name(self, sysroot: &Sysroot) -> &SmolStr {\n+    pub fn name(self, sysroot: &Sysroot) -> &str {\n         &sysroot.crates[self].name\n     }\n     pub fn root(self, sysroot: &Sysroot) -> &Path {"}]}