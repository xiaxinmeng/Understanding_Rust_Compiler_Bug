{"sha": "4269be382fdf1ac92665234502bab33ef9c0d8fa", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQyNjliZTM4MmZkZjFhYzkyNjY1MjM0NTAyYmFiMzNlZjljMGQ4ZmE=", "commit": {"author": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2019-04-18T13:21:05Z"}, "committer": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2019-04-18T13:32:49Z"}, "message": "Prefix PROFILER_SUPPORT and SANITIZER_SUPPORT test env vars with RUSTC_ to make things clearer.", "tree": {"sha": "fd3b55857ceae5c5de615459a483daf7a6e7edc2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fd3b55857ceae5c5de615459a483daf7a6e7edc2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4269be382fdf1ac92665234502bab33ef9c0d8fa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4269be382fdf1ac92665234502bab33ef9c0d8fa", "html_url": "https://github.com/rust-lang/rust/commit/4269be382fdf1ac92665234502bab33ef9c0d8fa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4269be382fdf1ac92665234502bab33ef9c0d8fa/comments", "author": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "committer": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "553ec5d3eb8af66f86599b0abb0efda74393921e", "url": "https://api.github.com/repos/rust-lang/rust/commits/553ec5d3eb8af66f86599b0abb0efda74393921e", "html_url": "https://github.com/rust-lang/rust/commit/553ec5d3eb8af66f86599b0abb0efda74393921e"}], "stats": {"total": 32, "additions": 16, "deletions": 16}, "files": [{"sha": "a443b7b5863e58b83aedd2d40ba5061650371d55", "filename": "src/bootstrap/test.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Fbootstrap%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Fbootstrap%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftest.rs?ref=4269be382fdf1ac92665234502bab33ef9c0d8fa", "patch": "@@ -1268,11 +1268,11 @@ impl Step for Compiletest {\n         builder.add_rust_test_threads(&mut cmd);\n \n         if builder.config.sanitizers {\n-            cmd.env(\"SANITIZER_SUPPORT\", \"1\");\n+            cmd.env(\"RUSTC_SANITIZER_SUPPORT\", \"1\");\n         }\n \n         if builder.config.profiler {\n-            cmd.env(\"PROFILER_SUPPORT\", \"1\");\n+            cmd.env(\"RUSTC_PROFILER_SUPPORT\", \"1\");\n         }\n \n         cmd.env(\"RUST_TEST_TMPDIR\", builder.out.join(\"tmp\"));"}, {"sha": "d6e45d838535f18253de34edefc11f698e9f3f93", "filename": "src/test/run-make-fulldeps/pgo-gen-lto/Makefile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fpgo-gen-lto%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fpgo-gen-lto%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fpgo-gen-lto%2FMakefile?ref=4269be382fdf1ac92665234502bab33ef9c0d8fa", "patch": "@@ -1,7 +1,7 @@\n -include ../tools.mk\n \n all:\n-ifeq ($(PROFILER_SUPPORT),1)\n+ifeq ($(RUSTC_PROFILER_SUPPORT),1)\n \t$(RUSTC) -Copt-level=3 -Clto=fat -Z pgo-gen=\"$(TMPDIR)\" test.rs\n \t$(call RUN,test) || exit 1\n \t[ -e \"$(TMPDIR)\"/default_*.profraw ] || (echo \"No .profraw file\"; exit 1)"}, {"sha": "bfb57bfeefe5cf9d953dc73723a169059de011f1", "filename": "src/test/run-make-fulldeps/pgo-gen-no-imp-symbols/Makefile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fpgo-gen-no-imp-symbols%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fpgo-gen-no-imp-symbols%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fpgo-gen-no-imp-symbols%2FMakefile?ref=4269be382fdf1ac92665234502bab33ef9c0d8fa", "patch": "@@ -1,7 +1,7 @@\n -include ../tools.mk\n \n all:\n-ifeq ($(PROFILER_SUPPORT),1)\n+ifeq ($(RUSTC_PROFILER_SUPPORT),1)\n \t$(RUSTC) -O -Ccodegen-units=1 -Z pgo-gen=\"$(TMPDIR)\" --emit=llvm-ir test.rs\n \t# We expect symbols starting with \"__llvm_profile_\".\n \t$(CGREP) \"__llvm_profile_\" < $(TMPDIR)/test.ll"}, {"sha": "28294f6e1d82d80b617c97898d9d32811b3eaf5d", "filename": "src/test/run-make-fulldeps/pgo-gen/Makefile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fpgo-gen%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fpgo-gen%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fpgo-gen%2FMakefile?ref=4269be382fdf1ac92665234502bab33ef9c0d8fa", "patch": "@@ -1,7 +1,7 @@\n -include ../tools.mk\n \n all:\n-ifeq ($(PROFILER_SUPPORT),1)\n+ifeq ($(RUSTC_PROFILER_SUPPORT),1)\n \t$(RUSTC) -g -Z pgo-gen=\"$(TMPDIR)\" test.rs\n \t$(call RUN,test) || exit 1\n \t[ -e \"$(TMPDIR)\"/default_*.profraw ] || (echo \"No .profraw file\"; exit 1)"}, {"sha": "880bc38f408e6cc2f88faf1a86503da5ba095a9a", "filename": "src/test/run-make-fulldeps/profile/Makefile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fprofile%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fprofile%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fprofile%2FMakefile?ref=4269be382fdf1ac92665234502bab33ef9c0d8fa", "patch": "@@ -1,7 +1,7 @@\n -include ../tools.mk\n \n all:\n-ifeq ($(PROFILER_SUPPORT),1)\n+ifeq ($(RUSTC_PROFILER_SUPPORT),1)\n \t$(RUSTC) -g -Z profile test.rs\n \t$(call RUN,test) || exit 1\n \t[ -e \"$(TMPDIR)/test.gcno\" ] || (echo \"No .gcno file\"; exit 1)"}, {"sha": "5f3486a495be2f98cc072ee23fa59925be9d8755", "filename": "src/test/run-make-fulldeps/sanitizer-address/Makefile", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-address%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-address%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-address%2FMakefile?ref=4269be382fdf1ac92665234502bab33ef9c0d8fa", "patch": "@@ -5,11 +5,11 @@ LOG := $(TMPDIR)/log.txt\n # NOTE the address sanitizer only supports x86_64 linux and macOS\n \n ifeq ($(TARGET),x86_64-apple-darwin)\n-ASAN_SUPPORT=$(SANITIZER_SUPPORT)\n+ASAN_SUPPORT=$(RUSTC_SANITIZER_SUPPORT)\n EXTRA_RUSTFLAG=-C rpath\n else\n ifeq ($(TARGET),x86_64-unknown-linux-gnu)\n-ASAN_SUPPORT=$(SANITIZER_SUPPORT)\n+ASAN_SUPPORT=$(RUSTC_SANITIZER_SUPPORT)\n \n # Apparently there are very specific Linux kernels, notably the one that's\n # currently on Travis CI, which contain a buggy commit that triggers failures in"}, {"sha": "bb323d2a6341af1c10b38ba539283d38c05f0c0a", "filename": "src/test/run-make-fulldeps/sanitizer-cdylib-link/Makefile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-cdylib-link%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-cdylib-link%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-cdylib-link%2FMakefile?ref=4269be382fdf1ac92665234502bab33ef9c0d8fa", "patch": "@@ -8,7 +8,7 @@ LOG := $(TMPDIR)/log.txt\n # is correctly detected.\n \n ifeq ($(TARGET),x86_64-unknown-linux-gnu)\n-ASAN_SUPPORT=$(SANITIZER_SUPPORT)\n+ASAN_SUPPORT=$(RUSTC_SANITIZER_SUPPORT)\n \n # See comment in sanitizer-address/Makefile for why this is here\n EXTRA_RUSTFLAG=-C relocation-model=dynamic-no-pic"}, {"sha": "77f119d8899675714887aa3405a0bf6d8bf6ba50", "filename": "src/test/run-make-fulldeps/sanitizer-dylib-link/Makefile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-dylib-link%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-dylib-link%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-dylib-link%2FMakefile?ref=4269be382fdf1ac92665234502bab33ef9c0d8fa", "patch": "@@ -8,7 +8,7 @@ LOG := $(TMPDIR)/log.txt\n # is correctly detected.\n \n ifeq ($(TARGET),x86_64-unknown-linux-gnu)\n-ASAN_SUPPORT=$(SANITIZER_SUPPORT)\n+ASAN_SUPPORT=$(RUSTC_SANITIZER_SUPPORT)\n \n # See comment in sanitizer-address/Makefile for why this is here\n EXTRA_RUSTFLAG=-C relocation-model=dynamic-no-pic"}, {"sha": "ac49e519c7b9630cc81788608047ec2498309a65", "filename": "src/test/run-make-fulldeps/sanitizer-invalid-cratetype/Makefile", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-invalid-cratetype%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-invalid-cratetype%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-invalid-cratetype%2FMakefile?ref=4269be382fdf1ac92665234502bab33ef9c0d8fa", "patch": "@@ -3,11 +3,11 @@\n # NOTE the address sanitizer only supports x86_64 linux and macOS\n \n ifeq ($(TARGET),x86_64-apple-darwin)\n-ASAN_SUPPORT=$(SANITIZER_SUPPORT)\n+ASAN_SUPPORT=$(RUSTC_SANITIZER_SUPPORT)\n EXTRA_RUSTFLAG=-C rpath\n else\n ifeq ($(TARGET),x86_64-unknown-linux-gnu)\n-ASAN_SUPPORT=$(SANITIZER_SUPPORT)\n+ASAN_SUPPORT=$(RUSTC_SANITIZER_SUPPORT)\n EXTRA_RUSTFLAG=\n endif\n endif"}, {"sha": "e84e1cbd2b61bfc30d698c7171117a06753c1d3d", "filename": "src/test/run-make-fulldeps/sanitizer-leak/Makefile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-leak%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-leak%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-leak%2FMakefile?ref=4269be382fdf1ac92665234502bab33ef9c0d8fa", "patch": "@@ -6,7 +6,7 @@\n # FIXME(#46126) ThinLTO for libstd broke this test\n \n all:\n-ifdef SANITIZER_SUPPORT\n+ifdef RUSTC_SANITIZER_SUPPORT\n \t$(RUSTC) -C opt-level=1 -g -Z sanitizer=leak -Z print-link-args leak.rs | $(CGREP) librustc_lsan\n \t$(TMPDIR)/leak 2>&1 | $(CGREP) 'detected memory leaks'\n endif"}, {"sha": "aca3591555cfdece3f836579d51a9b33fdd7ba75", "filename": "src/test/run-make-fulldeps/sanitizer-memory/Makefile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-memory%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-memory%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-memory%2FMakefile?ref=4269be382fdf1ac92665234502bab33ef9c0d8fa", "patch": "@@ -4,7 +4,7 @@\n # only-x86_64\n \n all:\n-ifdef SANITIZER_SUPPORT\n+ifdef RUSTC_SANITIZER_SUPPORT\n \t$(RUSTC) -g -Z sanitizer=memory -Z print-link-args uninit.rs | $(CGREP) librustc_msan\n \t$(TMPDIR)/uninit 2>&1 | $(CGREP) use-of-uninitialized-value\n endif"}, {"sha": "7a1b9509f4f9824ddc0e9419c1af03e2a4416617", "filename": "src/test/run-make-fulldeps/sanitizer-staticlib-link/Makefile", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-staticlib-link%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/4269be382fdf1ac92665234502bab33ef9c0d8fa/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-staticlib-link%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-staticlib-link%2FMakefile?ref=4269be382fdf1ac92665234502bab33ef9c0d8fa", "patch": "@@ -1,11 +1,11 @@\n -include ../tools.mk\n \n # This test builds a staticlib, then an executable that links to it.\n-# The staticlib and executable both  are compiled with address sanitizer, \n+# The staticlib and executable both  are compiled with address sanitizer,\n # and we assert that a fault in the staticlib is correctly detected.\n \n ifeq ($(TARGET),x86_64-unknown-linux-gnu)\n-ASAN_SUPPORT=$(SANITIZER_SUPPORT)\n+ASAN_SUPPORT=$(RUSTC_SANITIZER_SUPPORT)\n EXTRA_RUSTFLAG=\n endif\n "}]}