{"sha": "75d13734bf9dcb31c8487493ae7ba9c45bbc6031", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc1ZDEzNzM0YmY5ZGNiMzFjODQ4NzQ5M2FlN2JhOWM0NWJiYzYwMzE=", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2020-08-16T08:44:53Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2020-08-18T11:14:38Z"}, "message": "mir building: fix some comments", "tree": {"sha": "4a76c0a36d77b794851c4b555ab1d36908eb779b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4a76c0a36d77b794851c4b555ab1d36908eb779b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/75d13734bf9dcb31c8487493ae7ba9c45bbc6031", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/75d13734bf9dcb31c8487493ae7ba9c45bbc6031", "html_url": "https://github.com/rust-lang/rust/commit/75d13734bf9dcb31c8487493ae7ba9c45bbc6031", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/75d13734bf9dcb31c8487493ae7ba9c45bbc6031/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4717cf2fcbde585d81c47417b1fb921572a3c537", "url": "https://api.github.com/repos/rust-lang/rust/commits/4717cf2fcbde585d81c47417b1fb921572a3c537", "html_url": "https://github.com/rust-lang/rust/commit/4717cf2fcbde585d81c47417b1fb921572a3c537"}], "stats": {"total": 13, "additions": 7, "deletions": 6}, "files": [{"sha": "1c1c54434d619400e9da64ea9a276d34dfaafeed", "filename": "src/librustc_mir/transform/mod.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/75d13734bf9dcb31c8487493ae7ba9c45bbc6031/src%2Flibrustc_mir%2Ftransform%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/75d13734bf9dcb31c8487493ae7ba9c45bbc6031/src%2Flibrustc_mir%2Ftransform%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Ftransform%2Fmod.rs?ref=75d13734bf9dcb31c8487493ae7ba9c45bbc6031", "patch": "@@ -321,6 +321,7 @@ fn mir_validated(\n \n     // Ensure that we compute the `mir_const_qualif` for constants at\n     // this point, before we steal the mir-const result.\n+    // Also this means promotion can rely on all const checks having been done.\n     let _ = tcx.mir_const_qualif_opt_const_arg(def);\n \n     let mut body = tcx.mir_const(def).steal();\n@@ -336,7 +337,7 @@ fn mir_validated(\n     let promote: &[&dyn MirPass<'tcx>] = &[\n         // What we need to run borrowck etc.\n         &promote_pass,\n-        &simplify::SimplifyCfg::new(\"qualify-consts\"),\n+        &simplify::SimplifyCfg::new(\"promote-consts\"),\n     ];\n \n     let opt_coverage: &[&dyn MirPass<'tcx>] = if tcx.sess.opts.debugging_opts.instrument_coverage {"}, {"sha": "2c4f7544844d06eb2644c1213b87ce7813a28fe8", "filename": "src/test/mir-opt/issue-41697.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/75d13734bf9dcb31c8487493ae7ba9c45bbc6031/src%2Ftest%2Fmir-opt%2Fissue-41697.rs", "raw_url": "https://github.com/rust-lang/rust/raw/75d13734bf9dcb31c8487493ae7ba9c45bbc6031/src%2Ftest%2Fmir-opt%2Fissue-41697.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Fissue-41697.rs?ref=75d13734bf9dcb31c8487493ae7ba9c45bbc6031", "patch": "@@ -14,7 +14,7 @@ trait Foo {\n }\n \n // EMIT_MIR_FOR_EACH_BIT_WIDTH\n-// EMIT_MIR issue_41697.{{impl}}-{{constant}}.SimplifyCfg-qualify-consts.after.mir\n+// EMIT_MIR issue_41697.{{impl}}-{{constant}}.SimplifyCfg-promote-consts.after.mir\n impl Foo for [u8; 1+1] {\n     fn get(&self) -> [u8; 2] {\n         *self"}, {"sha": "1cef88fd1096b19b460cb27ad23f90f89b87474c", "filename": "src/test/mir-opt/issue_41697.{{impl}}-{{constant}}.SimplifyCfg-promote-consts.after.mir.32bit", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/75d13734bf9dcb31c8487493ae7ba9c45bbc6031/src%2Ftest%2Fmir-opt%2Fissue_41697.%7B%7Bimpl%7D%7D-%7B%7Bconstant%7D%7D.SimplifyCfg-promote-consts.after.mir.32bit", "raw_url": "https://github.com/rust-lang/rust/raw/75d13734bf9dcb31c8487493ae7ba9c45bbc6031/src%2Ftest%2Fmir-opt%2Fissue_41697.%7B%7Bimpl%7D%7D-%7B%7Bconstant%7D%7D.SimplifyCfg-promote-consts.after.mir.32bit", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Fissue_41697.%7B%7Bimpl%7D%7D-%7B%7Bconstant%7D%7D.SimplifyCfg-promote-consts.after.mir.32bit?ref=75d13734bf9dcb31c8487493ae7ba9c45bbc6031", "patch": "@@ -1,4 +1,4 @@\n-// MIR for `<impl at $DIR/issue-41697.rs:18:1: 22:2>::{{constant}}#0` after SimplifyCfg-qualify-consts\n+// MIR for `<impl at $DIR/issue-41697.rs:18:1: 22:2>::{{constant}}#0` after SimplifyCfg-promote-consts\n \n <impl at $DIR/issue-41697.rs:18:1: 22:2>::{{constant}}#0: usize = {\n     let mut _0: usize;                   // return place in scope 0 at $DIR/issue-41697.rs:18:19: 18:22", "previous_filename": "src/test/mir-opt/issue_41697.{{impl}}-{{constant}}.SimplifyCfg-qualify-consts.after.mir.32bit"}, {"sha": "1cef88fd1096b19b460cb27ad23f90f89b87474c", "filename": "src/test/mir-opt/issue_41697.{{impl}}-{{constant}}.SimplifyCfg-promote-consts.after.mir.64bit", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/75d13734bf9dcb31c8487493ae7ba9c45bbc6031/src%2Ftest%2Fmir-opt%2Fissue_41697.%7B%7Bimpl%7D%7D-%7B%7Bconstant%7D%7D.SimplifyCfg-promote-consts.after.mir.64bit", "raw_url": "https://github.com/rust-lang/rust/raw/75d13734bf9dcb31c8487493ae7ba9c45bbc6031/src%2Ftest%2Fmir-opt%2Fissue_41697.%7B%7Bimpl%7D%7D-%7B%7Bconstant%7D%7D.SimplifyCfg-promote-consts.after.mir.64bit", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Fissue_41697.%7B%7Bimpl%7D%7D-%7B%7Bconstant%7D%7D.SimplifyCfg-promote-consts.after.mir.64bit?ref=75d13734bf9dcb31c8487493ae7ba9c45bbc6031", "patch": "@@ -1,4 +1,4 @@\n-// MIR for `<impl at $DIR/issue-41697.rs:18:1: 22:2>::{{constant}}#0` after SimplifyCfg-qualify-consts\n+// MIR for `<impl at $DIR/issue-41697.rs:18:1: 22:2>::{{constant}}#0` after SimplifyCfg-promote-consts\n \n <impl at $DIR/issue-41697.rs:18:1: 22:2>::{{constant}}#0: usize = {\n     let mut _0: usize;                   // return place in scope 0 at $DIR/issue-41697.rs:18:19: 18:22", "previous_filename": "src/test/mir-opt/issue_41697.{{impl}}-{{constant}}.SimplifyCfg-qualify-consts.after.mir.64bit"}, {"sha": "b95e73854e35266ece9615039427493460a9bea3", "filename": "src/test/mir-opt/loop_test.main.SimplifyCfg-promote-consts.after.mir", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/75d13734bf9dcb31c8487493ae7ba9c45bbc6031/src%2Ftest%2Fmir-opt%2Floop_test.main.SimplifyCfg-promote-consts.after.mir", "raw_url": "https://github.com/rust-lang/rust/raw/75d13734bf9dcb31c8487493ae7ba9c45bbc6031/src%2Ftest%2Fmir-opt%2Floop_test.main.SimplifyCfg-promote-consts.after.mir", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Floop_test.main.SimplifyCfg-promote-consts.after.mir?ref=75d13734bf9dcb31c8487493ae7ba9c45bbc6031", "patch": "@@ -1,4 +1,4 @@\n-// MIR for `main` after SimplifyCfg-qualify-consts\n+// MIR for `main` after SimplifyCfg-promote-consts\n \n fn main() -> () {\n     let mut _0: ();                      // return place in scope 0 at $DIR/loop_test.rs:6:11: 6:11", "previous_filename": "src/test/mir-opt/loop_test.main.SimplifyCfg-qualify-consts.after.mir"}, {"sha": "7ded5b5757f55d0d16223f830a6b85796e113541", "filename": "src/test/mir-opt/loop_test.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/75d13734bf9dcb31c8487493ae7ba9c45bbc6031/src%2Ftest%2Fmir-opt%2Floop_test.rs", "raw_url": "https://github.com/rust-lang/rust/raw/75d13734bf9dcb31c8487493ae7ba9c45bbc6031/src%2Ftest%2Fmir-opt%2Floop_test.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Floop_test.rs?ref=75d13734bf9dcb31c8487493ae7ba9c45bbc6031", "patch": "@@ -2,7 +2,7 @@\n \n // Tests to make sure we correctly generate falseUnwind edges in loops\n \n-// EMIT_MIR loop_test.main.SimplifyCfg-qualify-consts.after.mir\n+// EMIT_MIR loop_test.main.SimplifyCfg-promote-consts.after.mir\n fn main() {\n     // Exit early at runtime. Since only care about the generated MIR\n     // and not the runtime behavior (which is exercised by other tests)"}]}