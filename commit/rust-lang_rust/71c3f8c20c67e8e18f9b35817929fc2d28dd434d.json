{"sha": "71c3f8c20c67e8e18f9b35817929fc2d28dd434d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjcxYzNmOGMyMGM2N2U4ZTE4ZjliMzU4MTc5MjlmYzJkMjhkZDQzNGQ=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-10-18T07:26:19Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-10-18T07:26:19Z"}, "message": "auto merge of #9924 : metajack/rust/fix-starts-with-ends-with, r=huonw\n\nd4a32386f3b6 broke these since slice_to() and slice_from() must get character\r\nboundaries, and arbitrary needle lengths don't necessarily map to character\r\nboundaries of the haystack.\r\n\r\nThis also adds new tests that would have caught this bug.", "tree": {"sha": "4e3a63498862bdfd204c49653abecc85ac909462", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4e3a63498862bdfd204c49653abecc85ac909462"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/71c3f8c20c67e8e18f9b35817929fc2d28dd434d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/71c3f8c20c67e8e18f9b35817929fc2d28dd434d", "html_url": "https://github.com/rust-lang/rust/commit/71c3f8c20c67e8e18f9b35817929fc2d28dd434d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/71c3f8c20c67e8e18f9b35817929fc2d28dd434d/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d0d554456a9c641c873f34c3f03a8679065d0f07", "url": "https://api.github.com/repos/rust-lang/rust/commits/d0d554456a9c641c873f34c3f03a8679065d0f07", "html_url": "https://github.com/rust-lang/rust/commit/d0d554456a9c641c873f34c3f03a8679065d0f07"}, {"sha": "090b2453a1a2df8ebd6216855515339822823d80", "url": "https://api.github.com/repos/rust-lang/rust/commits/090b2453a1a2df8ebd6216855515339822823d80", "html_url": "https://github.com/rust-lang/rust/commit/090b2453a1a2df8ebd6216855515339822823d80"}], "stats": {"total": 8, "additions": 6, "deletions": 2}, "files": [{"sha": "9d2f60fc27cbf42bb3ccc0547d36f28ad7498ca8", "filename": "src/libstd/str.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/71c3f8c20c67e8e18f9b35817929fc2d28dd434d/src%2Flibstd%2Fstr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/71c3f8c20c67e8e18f9b35817929fc2d28dd434d/src%2Flibstd%2Fstr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fstr.rs?ref=71c3f8c20c67e8e18f9b35817929fc2d28dd434d", "patch": "@@ -2010,13 +2010,13 @@ impl<'self> StrSlice<'self> for &'self str {\n     #[inline]\n     fn starts_with<'a>(&self, needle: &'a str) -> bool {\n         let n = needle.len();\n-        self.len() >= n && needle == self.slice_to(n)\n+        self.len() >= n && needle.as_bytes() == self.as_bytes().slice_to(n)\n     }\n \n     #[inline]\n     fn ends_with(&self, needle: &str) -> bool {\n         let (m, n) = (self.len(), needle.len());\n-        m >= n && needle == self.slice_from(m - n)\n+        m >= n && needle.as_bytes() == self.as_bytes().slice_from(m - n)\n     }\n \n     fn escape_default(&self) -> ~str {\n@@ -2886,6 +2886,8 @@ mod tests {\n         assert!((\"abc\".starts_with(\"a\")));\n         assert!((!\"a\".starts_with(\"abc\")));\n         assert!((!\"\".starts_with(\"abc\")));\n+        assert!((!\"\u00f6dd\".starts_with(\"-\")));\n+        assert!((\"\u00f6dd\".starts_with(\"\u00f6d\")));\n     }\n \n     #[test]\n@@ -2895,6 +2897,8 @@ mod tests {\n         assert!((\"abc\".ends_with(\"c\")));\n         assert!((!\"a\".ends_with(\"abc\")));\n         assert!((!\"\".ends_with(\"abc\")));\n+        assert!((!\"dd\u00f6\".ends_with(\"-\")));\n+        assert!((\"dd\u00f6\".ends_with(\"d\u00f6\")));\n     }\n \n     #[test]"}]}