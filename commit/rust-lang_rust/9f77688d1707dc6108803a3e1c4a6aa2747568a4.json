{"sha": "9f77688d1707dc6108803a3e1c4a6aa2747568a4", "node_id": "C_kwDOAAsO6NoAKDlmNzc2ODhkMTcwN2RjNjEwODgwM2EzZTFjNGE2YWEyNzQ3NTY4YTQ", "commit": {"author": {"name": "Santiago Pastorino", "email": "spastorino@gmail.com", "date": "2022-07-26T18:50:25Z"}, "committer": {"name": "Santiago Pastorino", "email": "spastorino@gmail.com", "date": "2022-08-04T14:26:53Z"}, "message": "Completely remove captures flag", "tree": {"sha": "d25dd0de9e78b38d948bab58acbfbd80e4e1ad3d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d25dd0de9e78b38d948bab58acbfbd80e4e1ad3d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9f77688d1707dc6108803a3e1c4a6aa2747568a4", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEF0ntrgrd9qf9uuThgTGiTgx5768FAmLr1y0ACgkQgTGiTgx5\n76+3qQ/9F17D2+fnrZ5CkHcimaGmslF4kvtOvadG0AECybTR80wB7yXSo3PyXMsQ\ntZT4oGRm+ATTrDLz8bFpshrBWBkI0OezNNvPDgixUkbDcq5wNOQ1SEeZUuqfSYDP\n44LrkJIjDPVDKfTON+uxE5IlLe5Kq8I/0odSkjOFDvcbeXpxzp5UEmTU+bmDMdKO\nbf6qoQf0OTKkyojhy4aFC8QBk4KYJUCt7gsiDev7pzm7xCXqw++WdDL6mHfb2cJt\nCSagqAL9L63vWz/hOe0P1kcugyZZvVNXdX1tGPegpe2yipKdl27ywWGR2Zh+43Ll\nlqC8qL1bUAqa7ghGjuaZh4GiVImFb8muy5ogyWhY8C280T56rouExveRClPq2z/Q\nTHqqGPgI0CZev7RDYqf+DJfL/V1KOC2B+Uxwf95+PxnLAyo12QgboOzGg6TMU7MR\n8YLCD3KMvyF+lwP8rokrPjT7QUvBE5hzFhjU3kKnesmqGaxaYiZF0hE+5nu5g6Pc\n5k7Q3I12Ug3Qdg3jEyoONncOts5yeNbyjaTSG8R0H8lU13Lx2zO5WPmsUzeFbG3K\nYdO2SowRjKvWIi3B7uMQGEgNSMc5vjvBe/mrY4DhCgoijUGdWh3oSA/MupJtWg7P\nrwepOu9CvT+18tK+qBxwNpcJxC3m15QSuKwaP+m9k2O0gbuCCVA=\n=wNxi\n-----END PGP SIGNATURE-----", "payload": "tree d25dd0de9e78b38d948bab58acbfbd80e4e1ad3d\nparent 20c88a2a307f61441e797839d94058bfac152dc8\nauthor Santiago Pastorino <spastorino@gmail.com> 1658861425 -0300\ncommitter Santiago Pastorino <spastorino@gmail.com> 1659623213 -0300\n\nCompletely remove captures flag\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9f77688d1707dc6108803a3e1c4a6aa2747568a4", "html_url": "https://github.com/rust-lang/rust/commit/9f77688d1707dc6108803a3e1c4a6aa2747568a4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9f77688d1707dc6108803a3e1c4a6aa2747568a4/comments", "author": {"login": "spastorino", "id": 52642, "node_id": "MDQ6VXNlcjUyNjQy", "avatar_url": "https://avatars.githubusercontent.com/u/52642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spastorino", "html_url": "https://github.com/spastorino", "followers_url": "https://api.github.com/users/spastorino/followers", "following_url": "https://api.github.com/users/spastorino/following{/other_user}", "gists_url": "https://api.github.com/users/spastorino/gists{/gist_id}", "starred_url": "https://api.github.com/users/spastorino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spastorino/subscriptions", "organizations_url": "https://api.github.com/users/spastorino/orgs", "repos_url": "https://api.github.com/users/spastorino/repos", "events_url": "https://api.github.com/users/spastorino/events{/privacy}", "received_events_url": "https://api.github.com/users/spastorino/received_events", "type": "User", "site_admin": false}, "committer": {"login": "spastorino", "id": 52642, "node_id": "MDQ6VXNlcjUyNjQy", "avatar_url": "https://avatars.githubusercontent.com/u/52642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spastorino", "html_url": "https://github.com/spastorino", "followers_url": "https://api.github.com/users/spastorino/followers", "following_url": "https://api.github.com/users/spastorino/following{/other_user}", "gists_url": "https://api.github.com/users/spastorino/gists{/gist_id}", "starred_url": "https://api.github.com/users/spastorino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spastorino/subscriptions", "organizations_url": "https://api.github.com/users/spastorino/orgs", "repos_url": "https://api.github.com/users/spastorino/repos", "events_url": "https://api.github.com/users/spastorino/events{/privacy}", "received_events_url": "https://api.github.com/users/spastorino/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "20c88a2a307f61441e797839d94058bfac152dc8", "url": "https://api.github.com/repos/rust-lang/rust/commits/20c88a2a307f61441e797839d94058bfac152dc8", "html_url": "https://github.com/rust-lang/rust/commit/20c88a2a307f61441e797839d94058bfac152dc8"}], "stats": {"total": 292, "additions": 99, "deletions": 193}, "files": [{"sha": "4166b4fc2e5bc1972789ee12ffd3dedb46246311", "filename": "compiler/rustc_ast_lowering/src/asm.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/9f77688d1707dc6108803a3e1c4a6aa2747568a4/compiler%2Frustc_ast_lowering%2Fsrc%2Fasm.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f77688d1707dc6108803a3e1c4a6aa2747568a4/compiler%2Frustc_ast_lowering%2Fsrc%2Fasm.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Fasm.rs?ref=9f77688d1707dc6108803a3e1c4a6aa2747568a4", "patch": "@@ -234,7 +234,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                                 &sym.path,\n                                 ParamMode::Optional,\n                                 ImplTraitContext::Disallowed(ImplTraitPosition::Path),\n-                                true,\n                             );\n                             hir::InlineAsmOperand::SymStatic { path, def_id }\n                         } else {"}, {"sha": "7cbfe143b4d83d3701a7b30e5571f8e4d4322c1c", "filename": "compiler/rustc_ast_lowering/src/block.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/9f77688d1707dc6108803a3e1c4a6aa2747568a4/compiler%2Frustc_ast_lowering%2Fsrc%2Fblock.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f77688d1707dc6108803a3e1c4a6aa2747568a4/compiler%2Frustc_ast_lowering%2Fsrc%2Fblock.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Fblock.rs?ref=9f77688d1707dc6108803a3e1c4a6aa2747568a4", "patch": "@@ -84,9 +84,10 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n     }\n \n     fn lower_local(&mut self, l: &Local) -> &'hir hir::Local<'hir> {\n-        let ty = l.ty.as_ref().map(|t| {\n-            self.lower_ty(t, ImplTraitContext::Disallowed(ImplTraitPosition::Variable), true)\n-        });\n+        let ty = l\n+            .ty\n+            .as_ref()\n+            .map(|t| self.lower_ty(t, ImplTraitContext::Disallowed(ImplTraitPosition::Variable)));\n         let init = l.kind.init().map(|init| self.lower_expr(init));\n         let hir_id = self.lower_node_id(l.id);\n         let pat = self.lower_pat(&l.pat);"}, {"sha": "983efa48a457982bf8ab37e2b9f0651c68a990a7", "filename": "compiler/rustc_ast_lowering/src/expr.rs", "status": "modified", "additions": 7, "deletions": 21, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/9f77688d1707dc6108803a3e1c4a6aa2747568a4/compiler%2Frustc_ast_lowering%2Fsrc%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f77688d1707dc6108803a3e1c4a6aa2747568a4/compiler%2Frustc_ast_lowering%2Fsrc%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Fexpr.rs?ref=9f77688d1707dc6108803a3e1c4a6aa2747568a4", "patch": "@@ -69,7 +69,6 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                         ParamMode::Optional,\n                         ParenthesizedGenericArgs::Err,\n                         ImplTraitContext::Disallowed(ImplTraitPosition::Path),\n-                        true,\n                     ));\n                     let args = self.lower_exprs(args);\n                     hir::ExprKind::MethodCall(hir_seg, args, self.lower_span(span))\n@@ -90,20 +89,14 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                 }\n                 ExprKind::Cast(ref expr, ref ty) => {\n                     let expr = self.lower_expr(expr);\n-                    let ty = self.lower_ty(\n-                        ty,\n-                        ImplTraitContext::Disallowed(ImplTraitPosition::Type),\n-                        true,\n-                    );\n+                    let ty =\n+                        self.lower_ty(ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type));\n                     hir::ExprKind::Cast(expr, ty)\n                 }\n                 ExprKind::Type(ref expr, ref ty) => {\n                     let expr = self.lower_expr(expr);\n-                    let ty = self.lower_ty(\n-                        ty,\n-                        ImplTraitContext::Disallowed(ImplTraitPosition::Type),\n-                        true,\n-                    );\n+                    let ty =\n+                        self.lower_ty(ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type));\n                     hir::ExprKind::Type(expr, ty)\n                 }\n                 ExprKind::AddrOf(k, m, ref ohs) => {\n@@ -233,7 +226,6 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                         path,\n                         ParamMode::Optional,\n                         ImplTraitContext::Disallowed(ImplTraitPosition::Path),\n-                        true,\n                     );\n                     hir::ExprKind::Path(qpath)\n                 }\n@@ -272,7 +264,6 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                             &se.path,\n                             ParamMode::Optional,\n                             ImplTraitContext::Disallowed(ImplTraitPosition::Path),\n-                            true,\n                         )),\n                         self.arena\n                             .alloc_from_iter(se.fields.iter().map(|x| self.lower_expr_field(x))),\n@@ -570,11 +561,9 @@ impl<'hir> LoweringContext<'_, 'hir> {\n         body: impl FnOnce(&mut Self) -> hir::Expr<'hir>,\n     ) -> hir::ExprKind<'hir> {\n         let output = match ret_ty {\n-            Some(ty) => hir::FnRetTy::Return(self.lower_ty(\n-                &ty,\n-                ImplTraitContext::Disallowed(ImplTraitPosition::AsyncBlock),\n-                true,\n-            )),\n+            Some(ty) => hir::FnRetTy::Return(\n+                self.lower_ty(&ty, ImplTraitContext::Disallowed(ImplTraitPosition::AsyncBlock)),\n+            ),\n             None => hir::FnRetTy::DefaultReturn(self.lower_span(span)),\n         };\n \n@@ -1178,7 +1167,6 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                         path,\n                         ParamMode::Optional,\n                         ImplTraitContext::Disallowed(ImplTraitPosition::Path),\n-                        true,\n                     );\n                     // Destructure like a tuple struct.\n                     let tuple_struct_pat =\n@@ -1195,7 +1183,6 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                         path,\n                         ParamMode::Optional,\n                         ImplTraitContext::Disallowed(ImplTraitPosition::Path),\n-                        true,\n                     );\n                     // Destructure like a unit struct.\n                     let unit_struct_pat = hir::PatKind::Path(qpath);\n@@ -1220,7 +1207,6 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                     &se.path,\n                     ParamMode::Optional,\n                     ImplTraitContext::Disallowed(ImplTraitPosition::Path),\n-                    true,\n                 );\n                 let fields_omitted = match &se.rest {\n                     StructRest::Base(e) => {"}, {"sha": "4cf0a8e0d2ed1da629871faec1fa1895993da8d4", "filename": "compiler/rustc_ast_lowering/src/item.rs", "status": "modified", "additions": 20, "deletions": 49, "changes": 69, "blob_url": "https://github.com/rust-lang/rust/blob/9f77688d1707dc6108803a3e1c4a6aa2747568a4/compiler%2Frustc_ast_lowering%2Fsrc%2Fitem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f77688d1707dc6108803a3e1c4a6aa2747568a4/compiler%2Frustc_ast_lowering%2Fsrc%2Fitem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Fitem.rs?ref=9f77688d1707dc6108803a3e1c4a6aa2747568a4", "patch": "@@ -308,7 +308,7 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                     &generics,\n                     id,\n                     ImplTraitContext::Disallowed(ImplTraitPosition::Generic),\n-                    |this| this.lower_ty(ty, ImplTraitContext::TypeAliasesOpaqueTy, true),\n+                    |this| this.lower_ty(ty, ImplTraitContext::TypeAliasesOpaqueTy),\n                 );\n                 hir::ItemKind::TyAlias(ty, generics)\n             }\n@@ -386,15 +386,11 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                             this.lower_trait_ref(\n                                 trait_ref,\n                                 ImplTraitContext::Disallowed(ImplTraitPosition::Trait),\n-                                true,\n                             )\n                         });\n \n-                        let lowered_ty = this.lower_ty(\n-                            ty,\n-                            ImplTraitContext::Disallowed(ImplTraitPosition::Type),\n-                            true,\n-                        );\n+                        let lowered_ty = this\n+                            .lower_ty(ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type));\n \n                         (trait_ref, lowered_ty)\n                     });\n@@ -438,7 +434,6 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                         let bounds = this.lower_param_bounds(\n                             bounds,\n                             ImplTraitContext::Disallowed(ImplTraitPosition::Bound),\n-                            true,\n                         );\n                         let items = this.arena.alloc_from_iter(\n                             items.iter().map(|item| this.lower_trait_item_ref(item)),\n@@ -458,7 +453,6 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                         this.lower_param_bounds(\n                             bounds,\n                             ImplTraitContext::Disallowed(ImplTraitPosition::Bound),\n-                            true,\n                         )\n                     },\n                 );\n@@ -481,7 +475,7 @@ impl<'hir> LoweringContext<'_, 'hir> {\n         span: Span,\n         body: Option<&Expr>,\n     ) -> (&'hir hir::Ty<'hir>, hir::BodyId) {\n-        let ty = self.lower_ty(ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type), true);\n+        let ty = self.lower_ty(ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type));\n         (ty, self.lower_const_body(span, body))\n     }\n \n@@ -667,11 +661,8 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                     hir::ForeignItemKind::Fn(fn_dec, fn_args, generics)\n                 }\n                 ForeignItemKind::Static(ref t, m, _) => {\n-                    let ty = self.lower_ty(\n-                        t,\n-                        ImplTraitContext::Disallowed(ImplTraitPosition::Type),\n-                        true,\n-                    );\n+                    let ty =\n+                        self.lower_ty(t, ImplTraitContext::Disallowed(ImplTraitPosition::Type));\n                     hir::ForeignItemKind::Static(ty, m)\n                 }\n                 ForeignItemKind::TyAlias(..) => hir::ForeignItemKind::Type,\n@@ -740,11 +731,10 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                 path,\n                 ParamMode::ExplicitNamed, // no `'_` in declarations (Issue #61124)\n                 ImplTraitContext::Disallowed(ImplTraitPosition::Path),\n-                true,\n             );\n             self.arena.alloc(t)\n         } else {\n-            self.lower_ty(&f.ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type), true)\n+            self.lower_ty(&f.ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type))\n         };\n         let hir_id = self.lower_node_id(f.id);\n         self.lower_attrs(hir_id, &f.attrs);\n@@ -767,8 +757,7 @@ impl<'hir> LoweringContext<'_, 'hir> {\n \n         let (generics, kind, has_default) = match i.kind {\n             AssocItemKind::Const(_, ref ty, ref default) => {\n-                let ty =\n-                    self.lower_ty(ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type), true);\n+                let ty = self.lower_ty(ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type));\n                 let body = default.as_ref().map(|x| self.lower_const_body(i.span, Some(x)));\n                 (hir::Generics::empty(), hir::TraitItemKind::Const(ty, body), body.is_some())\n             }\n@@ -806,17 +795,12 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                     ImplTraitContext::Disallowed(ImplTraitPosition::Generic),\n                     |this| {\n                         let ty = ty.as_ref().map(|x| {\n-                            this.lower_ty(\n-                                x,\n-                                ImplTraitContext::Disallowed(ImplTraitPosition::Type),\n-                                true,\n-                            )\n+                            this.lower_ty(x, ImplTraitContext::Disallowed(ImplTraitPosition::Type))\n                         });\n                         hir::TraitItemKind::Type(\n                             this.lower_param_bounds(\n                                 bounds,\n                                 ImplTraitContext::Disallowed(ImplTraitPosition::Generic),\n-                                true,\n                             ),\n                             ty,\n                         )\n@@ -869,8 +853,7 @@ impl<'hir> LoweringContext<'_, 'hir> {\n \n         let (generics, kind) = match &i.kind {\n             AssocItemKind::Const(_, ty, expr) => {\n-                let ty =\n-                    self.lower_ty(ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type), true);\n+                let ty = self.lower_ty(ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type));\n                 (\n                     hir::Generics::empty(),\n                     hir::ImplItemKind::Const(ty, self.lower_const_body(i.span, expr.as_deref())),\n@@ -904,7 +887,7 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                             hir::ImplItemKind::TyAlias(ty)\n                         }\n                         Some(ty) => {\n-                            let ty = this.lower_ty(ty, ImplTraitContext::TypeAliasesOpaqueTy, true);\n+                            let ty = this.lower_ty(ty, ImplTraitContext::TypeAliasesOpaqueTy);\n                             hir::ImplItemKind::TyAlias(ty)\n                         }\n                     },\n@@ -1429,7 +1412,7 @@ impl<'hir> LoweringContext<'_, 'hir> {\n             return None;\n         }\n \n-        let bounds = self.lower_param_bounds(bounds, itctx, true);\n+        let bounds = self.lower_param_bounds(bounds, itctx);\n \n         let ident = self.lower_ident(ident);\n         let param_span = ident.span;\n@@ -1475,8 +1458,7 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                     panic!(\"Missing resolution for lifetime {:?} at {:?}\", id, ident.span)\n                 });\n                 let lt_id = self.next_node_id();\n-                let lifetime =\n-                    self.new_named_lifetime_with_res(lt_id, ident_span, ident, res, true);\n+                let lifetime = self.new_named_lifetime_with_res(lt_id, ident_span, ident, res);\n                 Some(hir::WherePredicate::RegionPredicate(hir::WhereRegionPredicate {\n                     lifetime,\n                     span,\n@@ -1496,16 +1478,12 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                 span,\n             }) => hir::WherePredicate::BoundPredicate(hir::WhereBoundPredicate {\n                 bound_generic_params: self.lower_generic_params(bound_generic_params),\n-                bounded_ty: self.lower_ty(\n-                    bounded_ty,\n-                    ImplTraitContext::Disallowed(ImplTraitPosition::Type),\n-                    true,\n-                ),\n+                bounded_ty: self\n+                    .lower_ty(bounded_ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type)),\n                 bounds: self.arena.alloc_from_iter(bounds.iter().map(|bound| {\n                     self.lower_param_bound(\n                         bound,\n                         ImplTraitContext::Disallowed(ImplTraitPosition::Bound),\n-                        true,\n                     )\n                 })),\n                 span: self.lower_span(span),\n@@ -1517,27 +1495,20 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                 span,\n             }) => hir::WherePredicate::RegionPredicate(hir::WhereRegionPredicate {\n                 span: self.lower_span(span),\n-                lifetime: self.lower_lifetime(lifetime, true),\n+                lifetime: self.lower_lifetime(lifetime),\n                 bounds: self.lower_param_bounds(\n                     bounds,\n                     ImplTraitContext::Disallowed(ImplTraitPosition::Bound),\n-                    true,\n                 ),\n                 in_where_clause: true,\n             }),\n             WherePredicate::EqPredicate(WhereEqPredicate { id, ref lhs_ty, ref rhs_ty, span }) => {\n                 hir::WherePredicate::EqPredicate(hir::WhereEqPredicate {\n                     hir_id: self.lower_node_id(id),\n-                    lhs_ty: self.lower_ty(\n-                        lhs_ty,\n-                        ImplTraitContext::Disallowed(ImplTraitPosition::Type),\n-                        true,\n-                    ),\n-                    rhs_ty: self.lower_ty(\n-                        rhs_ty,\n-                        ImplTraitContext::Disallowed(ImplTraitPosition::Type),\n-                        true,\n-                    ),\n+                    lhs_ty: self\n+                        .lower_ty(lhs_ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type)),\n+                    rhs_ty: self\n+                        .lower_ty(rhs_ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type)),\n                     span: self.lower_span(span),\n                 })\n             }"}, {"sha": "4ca771bf4738ce3de77978648716d7e6066b4112", "filename": "compiler/rustc_ast_lowering/src/lib.rs", "status": "modified", "additions": 52, "deletions": 91, "changes": 143, "blob_url": "https://github.com/rust-lang/rust/blob/9f77688d1707dc6108803a3e1c4a6aa2747568a4/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f77688d1707dc6108803a3e1c4a6aa2747568a4/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs?ref=9f77688d1707dc6108803a3e1c4a6aa2747568a4", "patch": "@@ -932,7 +932,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         let kind = match constraint.kind {\n             AssocConstraintKind::Equality { ref term } => {\n                 let term = match term {\n-                    Term::Ty(ref ty) => self.lower_ty(ty, itctx, true).into(),\n+                    Term::Ty(ref ty) => self.lower_ty(ty, itctx).into(),\n                     Term::Const(ref c) => self.lower_anon_const(c).into(),\n                 };\n                 hir::TypeBindingKind::Equality { term }\n@@ -997,15 +997,14 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                                 tokens: None,\n                             },\n                             itctx,\n-                            true,\n                         );\n \n                         hir::TypeBindingKind::Equality { term: ty.into() }\n                     })\n                 } else {\n                     // Desugar `AssocTy: Bounds` into a type binding where the\n                     // later desugars into a trait predicate.\n-                    let bounds = self.lower_param_bounds(bounds, itctx, true);\n+                    let bounds = self.lower_param_bounds(bounds, itctx);\n \n                     hir::TypeBindingKind::Constraint { bounds }\n                 }\n@@ -1064,7 +1063,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         itctx: ImplTraitContext,\n     ) -> hir::GenericArg<'hir> {\n         match arg {\n-            ast::GenericArg::Lifetime(lt) => GenericArg::Lifetime(self.lower_lifetime(&lt, true)),\n+            ast::GenericArg::Lifetime(lt) => GenericArg::Lifetime(self.lower_lifetime(&lt)),\n             ast::GenericArg::Type(ty) => {\n                 match ty.kind {\n                     TyKind::Infer if self.tcx.features().generic_arg_infer => {\n@@ -1113,7 +1112,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                     }\n                     _ => {}\n                 }\n-                GenericArg::Type(self.lower_ty_direct(&ty, itctx, true))\n+                GenericArg::Type(self.lower_ty_direct(&ty, itctx))\n             }\n             ast::GenericArg::Const(ct) => GenericArg::Const(ConstArg {\n                 value: self.lower_anon_const(&ct),\n@@ -1123,8 +1122,8 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n     }\n \n     #[instrument(level = \"debug\", skip(self))]\n-    fn lower_ty(&mut self, t: &Ty, itctx: ImplTraitContext, captures: bool) -> &'hir hir::Ty<'hir> {\n-        self.arena.alloc(self.lower_ty_direct(t, itctx, captures))\n+    fn lower_ty(&mut self, t: &Ty, itctx: ImplTraitContext) -> &'hir hir::Ty<'hir> {\n+        self.arena.alloc(self.lower_ty_direct(t, itctx))\n     }\n \n     fn lower_path_ty(\n@@ -1134,7 +1133,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         path: &Path,\n         param_mode: ParamMode,\n         itctx: ImplTraitContext,\n-        captures: bool,\n     ) -> hir::Ty<'hir> {\n         // Check whether we should interpret this as a bare trait object.\n         // This check mirrors the one in late resolution.  We only introduce this special case in\n@@ -1154,7 +1152,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                         span: t.span\n                     },\n                     itctx,\n-                    captures,\n                 );\n                 let bounds = this.arena.alloc_from_iter([bound]);\n                 let lifetime_bound = this.elided_dyn_bound(t.span);\n@@ -1165,7 +1162,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         }\n \n         let id = self.lower_node_id(t.id);\n-        let qpath = self.lower_qpath(t.id, qself, path, param_mode, itctx, true);\n+        let qpath = self.lower_qpath(t.id, qself, path, param_mode, itctx);\n         self.ty_path(id, t.span, qpath)\n     }\n \n@@ -1177,16 +1174,11 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         self.ty(span, hir::TyKind::Tup(tys))\n     }\n \n-    fn lower_ty_direct(\n-        &mut self,\n-        t: &Ty,\n-        itctx: ImplTraitContext,\n-        captures: bool,\n-    ) -> hir::Ty<'hir> {\n+    fn lower_ty_direct(&mut self, t: &Ty, itctx: ImplTraitContext) -> hir::Ty<'hir> {\n         let kind = match t.kind {\n             TyKind::Infer => hir::TyKind::Infer,\n             TyKind::Err => hir::TyKind::Err,\n-            TyKind::Slice(ref ty) => hir::TyKind::Slice(self.lower_ty(ty, itctx, captures)),\n+            TyKind::Slice(ref ty) => hir::TyKind::Slice(self.lower_ty(ty, itctx)),\n             TyKind::Ptr(ref mt) => hir::TyKind::Ptr(self.lower_mt(mt, itctx)),\n             TyKind::Rptr(ref region, ref mt) => {\n                 let region = region.unwrap_or_else(|| {\n@@ -1201,7 +1193,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                     let span = self.tcx.sess.source_map().next_point(t.span.shrink_to_lo());\n                     Lifetime { ident: Ident::new(kw::UnderscoreLifetime, span), id }\n                 });\n-                let lifetime = self.lower_lifetime(&region, captures);\n+                let lifetime = self.lower_lifetime(&region);\n                 hir::TyKind::Rptr(lifetime, self.lower_mt(mt, itctx))\n             }\n             TyKind::BareFn(ref f) => {\n@@ -1216,16 +1208,14 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                 })\n             }\n             TyKind::Never => hir::TyKind::Never,\n-            TyKind::Tup(ref tys) => {\n-                hir::TyKind::Tup(self.arena.alloc_from_iter(\n-                    tys.iter().map(|ty| self.lower_ty_direct(ty, itctx, captures)),\n-                ))\n-            }\n+            TyKind::Tup(ref tys) => hir::TyKind::Tup(\n+                self.arena.alloc_from_iter(tys.iter().map(|ty| self.lower_ty_direct(ty, itctx))),\n+            ),\n             TyKind::Paren(ref ty) => {\n-                return self.lower_ty_direct(ty, itctx, captures);\n+                return self.lower_ty_direct(ty, itctx);\n             }\n             TyKind::Path(ref qself, ref path) => {\n-                return self.lower_path_ty(t, qself, path, ParamMode::Explicit, itctx, captures);\n+                return self.lower_path_ty(t, qself, path, ParamMode::Explicit, itctx);\n             }\n             TyKind::ImplicitSelf => {\n                 let res = self.expect_full_res(t.id);\n@@ -1241,10 +1231,9 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                     }),\n                 ))\n             }\n-            TyKind::Array(ref ty, ref length) => hir::TyKind::Array(\n-                self.lower_ty(ty, itctx, captures),\n-                self.lower_array_length(length),\n-            ),\n+            TyKind::Array(ref ty, ref length) => {\n+                hir::TyKind::Array(self.lower_ty(ty, itctx), self.lower_array_length(length))\n+            }\n             TyKind::Typeof(ref expr) => hir::TyKind::Typeof(self.lower_anon_const(expr)),\n             TyKind::TraitObject(ref bounds, kind) => {\n                 let mut lifetime_bound = None;\n@@ -1255,7 +1244,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                                 GenericBound::Trait(\n                                     ref ty,\n                                     TraitBoundModifier::None | TraitBoundModifier::MaybeConst,\n-                                ) => Some(this.lower_poly_trait_ref(ty, itctx, captures)),\n+                                ) => Some(this.lower_poly_trait_ref(ty, itctx)),\n                                 // `~const ?Bound` will cause an error during AST validation\n                                 // anyways, so treat it like `?Bound` as compilation proceeds.\n                                 GenericBound::Trait(\n@@ -1264,7 +1253,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                                 ) => None,\n                                 GenericBound::Outlives(ref lifetime) => {\n                                     if lifetime_bound.is_none() {\n-                                        lifetime_bound = Some(this.lower_lifetime(lifetime, true));\n+                                        lifetime_bound = Some(this.lower_lifetime(lifetime));\n                                     }\n                                     None\n                                 }\n@@ -1350,7 +1339,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         let mut collected_lifetimes = FxHashMap::default();\n         self.with_hir_id_owner(opaque_ty_node_id, |lctx| {\n             let hir_bounds = if origin == hir::OpaqueTyOrigin::TyAlias {\n-                lctx.lower_param_bounds(bounds, itctx, true)\n+                lctx.lower_param_bounds(bounds, itctx)\n             } else {\n                 debug!(?lctx.captured_lifetimes);\n \n@@ -1369,7 +1358,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n \n                 lctx.create_and_capture_lifetime_defs(&lifetimes_in_bounds, &binders_to_ignore);\n \n-                let ret = lctx.lower_param_bounds(bounds, itctx, false);\n+                let ret = lctx.lower_param_bounds(bounds, itctx);\n \n                 let ctxt = std::mem::replace(&mut lctx.captured_lifetimes, lifetime_stash).unwrap();\n \n@@ -1423,7 +1412,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n             |(_, (span, _, p_name, res))| {\n                 let id = self.next_node_id();\n                 let ident = Ident::new(p_name.ident().name, span);\n-                let l = self.new_named_lifetime_with_res(id, span, ident, res, false);\n+                let l = self.new_named_lifetime_with_res(id, span, ident, res);\n                 hir::GenericArg::Lifetime(l)\n             },\n         ));\n@@ -1579,7 +1568,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         }\n         let inputs = self.arena.alloc_from_iter(inputs.iter().map(|param| {\n             if fn_node_id.is_some() {\n-                self.lower_ty_direct(&param.ty, ImplTraitContext::Universal, true)\n+                self.lower_ty_direct(&param.ty, ImplTraitContext::Universal)\n             } else {\n                 self.lower_ty_direct(\n                     &param.ty,\n@@ -1593,7 +1582,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                         FnDeclKind::Trait => ImplTraitPosition::TraitParam,\n                         FnDeclKind::Impl => ImplTraitPosition::ImplParam,\n                     }),\n-                    true,\n                 )\n             }\n         }));\n@@ -1625,7 +1613,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                             FnDeclKind::Impl => ImplTraitPosition::ImplReturn,\n                         }),\n                     };\n-                    hir::FnRetTy::Return(self.lower_ty(ty, context, true))\n+                    hir::FnRetTy::Return(self.lower_ty(ty, context))\n                 }\n                 FnRetTy::Default(span) => hir::FnRetTy::DefaultReturn(self.lower_span(span)),\n             }\n@@ -1847,7 +1835,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n             self.arena.alloc_from_iter(captures.into_iter().map(|(_, (span, _, p_name, res))| {\n                 let id = self.next_node_id();\n                 let ident = Ident::new(p_name.ident().name, span);\n-                let l = self.new_named_lifetime_with_res(id, span, ident, res, true);\n+                let l = self.new_named_lifetime_with_res(id, span, ident, res);\n                 hir::GenericArg::Lifetime(l)\n             }));\n \n@@ -1877,7 +1865,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                 let context = ImplTraitContext::ReturnPositionOpaqueTy {\n                     origin: hir::OpaqueTyOrigin::FnReturn(fn_def_id),\n                 };\n-                self.lower_ty(ty, context, false)\n+                self.lower_ty(ty, context)\n             }\n             FnRetTy::Default(ret_ty_span) => self.arena.alloc(self.ty_tup(*ret_ty_span, &[])),\n         };\n@@ -1904,24 +1892,23 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         &mut self,\n         tpb: &GenericBound,\n         itctx: ImplTraitContext,\n-        captures: bool,\n     ) -> hir::GenericBound<'hir> {\n         match tpb {\n             GenericBound::Trait(p, modifier) => hir::GenericBound::Trait(\n-                self.lower_poly_trait_ref(p, itctx, captures),\n+                self.lower_poly_trait_ref(p, itctx),\n                 self.lower_trait_bound_modifier(*modifier),\n             ),\n             GenericBound::Outlives(lifetime) => {\n-                hir::GenericBound::Outlives(self.lower_lifetime(lifetime, captures))\n+                hir::GenericBound::Outlives(self.lower_lifetime(lifetime))\n             }\n         }\n     }\n \n-    fn lower_lifetime(&mut self, l: &Lifetime, captures: bool) -> hir::Lifetime {\n+    fn lower_lifetime(&mut self, l: &Lifetime) -> hir::Lifetime {\n         let span = self.lower_span(l.ident.span);\n         let ident = self.lower_ident(l.ident);\n         let res = self.resolver.get_lifetime_res(l.id).unwrap_or(LifetimeRes::Error);\n-        self.new_named_lifetime_with_res(l.id, span, ident, res, captures)\n+        self.new_named_lifetime_with_res(l.id, span, ident, res)\n     }\n \n     #[tracing::instrument(level = \"debug\", skip(self))]\n@@ -1931,37 +1918,31 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         span: Span,\n         ident: Ident,\n         res: LifetimeRes,\n-        captures: bool,\n     ) -> hir::Lifetime {\n         debug!(?self.captured_lifetimes);\n \n         let name = match res {\n             LifetimeRes::Param { mut param, binder } => {\n                 let p_name = ParamName::Plain(ident);\n                 if let Some(mut captured_lifetimes) = self.captured_lifetimes.take() {\n-                    if captures {\n-                        if !captured_lifetimes.binders_to_ignore.contains(&binder) {\n-                            match captured_lifetimes.captures.entry(param) {\n-                                Entry::Occupied(o) => param = self.local_def_id(o.get().1),\n-                                Entry::Vacant(v) => {\n-                                    let p_id = self.next_node_id();\n+                    if !captured_lifetimes.binders_to_ignore.contains(&binder) {\n+                        match captured_lifetimes.captures.entry(param) {\n+                            Entry::Occupied(o) => param = self.local_def_id(o.get().1),\n+                            Entry::Vacant(v) => {\n+                                let p_id = self.next_node_id();\n \n-                                    let p_def_id = self.create_def(\n-                                        captured_lifetimes.parent_def_id,\n-                                        p_id,\n-                                        DefPathData::LifetimeNs(p_name.ident().name),\n-                                    );\n+                                let p_def_id = self.create_def(\n+                                    captured_lifetimes.parent_def_id,\n+                                    p_id,\n+                                    DefPathData::LifetimeNs(p_name.ident().name),\n+                                );\n \n-                                    v.insert((span, p_id, p_name, res));\n-                                    param = p_def_id;\n-                                }\n+                                v.insert((span, p_id, p_name, res));\n+                                param = p_def_id;\n                             }\n                         }\n-                    } else {\n-                        if let Entry::Occupied(o) = captured_lifetimes.captures.entry(param) {\n-                            param = self.local_def_id(o.get().1);\n-                        }\n                     }\n+\n                     self.captured_lifetimes = Some(captured_lifetimes);\n                 }\n \n@@ -2054,20 +2035,15 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n             GenericParamKind::Type { ref default, .. } => {\n                 let kind = hir::GenericParamKind::Type {\n                     default: default.as_ref().map(|x| {\n-                        self.lower_ty(\n-                            x,\n-                            ImplTraitContext::Disallowed(ImplTraitPosition::Type),\n-                            true,\n-                        )\n+                        self.lower_ty(x, ImplTraitContext::Disallowed(ImplTraitPosition::Type))\n                     }),\n                     synthetic: false,\n                 };\n \n                 (hir::ParamName::Plain(self.lower_ident(param.ident)), kind)\n             }\n             GenericParamKind::Const { ref ty, kw_span: _, ref default } => {\n-                let ty =\n-                    self.lower_ty(&ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type), true);\n+                let ty = self.lower_ty(&ty, ImplTraitContext::Disallowed(ImplTraitPosition::Type));\n                 let default = default.as_ref().map(|def| self.lower_anon_const(def));\n                 (\n                     hir::ParamName::Plain(self.lower_ident(param.ident)),\n@@ -2077,20 +2053,8 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         }\n     }\n \n-    fn lower_trait_ref(\n-        &mut self,\n-        p: &TraitRef,\n-        itctx: ImplTraitContext,\n-        captures: bool,\n-    ) -> hir::TraitRef<'hir> {\n-        let path = match self.lower_qpath(\n-            p.ref_id,\n-            &None,\n-            &p.path,\n-            ParamMode::Explicit,\n-            itctx,\n-            captures,\n-        ) {\n+    fn lower_trait_ref(&mut self, p: &TraitRef, itctx: ImplTraitContext) -> hir::TraitRef<'hir> {\n+        let path = match self.lower_qpath(p.ref_id, &None, &p.path, ParamMode::Explicit, itctx) {\n             hir::QPath::Resolved(None, path) => path,\n             qpath => panic!(\"lower_trait_ref: unexpected QPath `{:?}`\", qpath),\n         };\n@@ -2102,38 +2066,35 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         &mut self,\n         p: &PolyTraitRef,\n         itctx: ImplTraitContext,\n-        captures: bool,\n     ) -> hir::PolyTraitRef<'hir> {\n         self.with_lifetime_binder(\n             p.trait_ref.ref_id,\n             &p.bound_generic_params,\n             |this, bound_generic_params| {\n-                let trait_ref = this.lower_trait_ref(&p.trait_ref, itctx, captures);\n+                let trait_ref = this.lower_trait_ref(&p.trait_ref, itctx);\n                 hir::PolyTraitRef { bound_generic_params, trait_ref, span: this.lower_span(p.span) }\n             },\n         )\n     }\n \n     fn lower_mt(&mut self, mt: &MutTy, itctx: ImplTraitContext) -> hir::MutTy<'hir> {\n-        hir::MutTy { ty: self.lower_ty(&mt.ty, itctx, true), mutbl: mt.mutbl }\n+        hir::MutTy { ty: self.lower_ty(&mt.ty, itctx), mutbl: mt.mutbl }\n     }\n \n     fn lower_param_bounds(\n         &mut self,\n         bounds: &[GenericBound],\n         itctx: ImplTraitContext,\n-        captures: bool,\n     ) -> hir::GenericBounds<'hir> {\n-        self.arena.alloc_from_iter(self.lower_param_bounds_mut(bounds, itctx, captures))\n+        self.arena.alloc_from_iter(self.lower_param_bounds_mut(bounds, itctx))\n     }\n \n     fn lower_param_bounds_mut<'s>(\n         &'s mut self,\n         bounds: &'s [GenericBound],\n         itctx: ImplTraitContext,\n-        captures: bool,\n     ) -> impl Iterator<Item = hir::GenericBound<'hir>> + Captures<'s> + Captures<'a> {\n-        bounds.iter().map(move |bound| self.lower_param_bound(bound, itctx, captures))\n+        bounds.iter().map(move |bound| self.lower_param_bound(bound, itctx))\n     }\n \n     fn lower_generic_and_bounds("}, {"sha": "bd2e76e5528dab08b8a07e00353bc7bdbfb1e906", "filename": "compiler/rustc_ast_lowering/src/pat.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9f77688d1707dc6108803a3e1c4a6aa2747568a4/compiler%2Frustc_ast_lowering%2Fsrc%2Fpat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f77688d1707dc6108803a3e1c4a6aa2747568a4/compiler%2Frustc_ast_lowering%2Fsrc%2Fpat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Fpat.rs?ref=9f77688d1707dc6108803a3e1c4a6aa2747568a4", "patch": "@@ -36,7 +36,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                             path,\n                             ParamMode::Optional,\n                             ImplTraitContext::Disallowed(ImplTraitPosition::Path),\n-                            true,\n                         );\n                         let (pats, ddpos) = self.lower_pat_tuple(pats, \"tuple struct\");\n                         break hir::PatKind::TupleStruct(qpath, pats, ddpos);\n@@ -53,7 +52,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                             path,\n                             ParamMode::Optional,\n                             ImplTraitContext::Disallowed(ImplTraitPosition::Path),\n-                            true,\n                         );\n                         break hir::PatKind::Path(qpath);\n                     }\n@@ -64,7 +62,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                             path,\n                             ParamMode::Optional,\n                             ImplTraitContext::Disallowed(ImplTraitPosition::Path),\n-                            true,\n                         );\n \n                         let fs = self.arena.alloc_from_iter(fields.iter().map(|f| hir::PatField {"}, {"sha": "393be3b454c3787c7630750abb2c1d79369dc1f4", "filename": "compiler/rustc_ast_lowering/src/path.rs", "status": "modified", "additions": 9, "deletions": 25, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/9f77688d1707dc6108803a3e1c4a6aa2747568a4/compiler%2Frustc_ast_lowering%2Fsrc%2Fpath.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f77688d1707dc6108803a3e1c4a6aa2747568a4/compiler%2Frustc_ast_lowering%2Fsrc%2Fpath.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Fpath.rs?ref=9f77688d1707dc6108803a3e1c4a6aa2747568a4", "patch": "@@ -24,10 +24,9 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         p: &Path,\n         param_mode: ParamMode,\n         itctx: ImplTraitContext,\n-        captures: bool,\n     ) -> hir::QPath<'hir> {\n         let qself_position = qself.as_ref().map(|q| q.position);\n-        let qself = qself.as_ref().map(|q| self.lower_ty(&q.ty, itctx, captures));\n+        let qself = qself.as_ref().map(|q| self.lower_ty(&q.ty, itctx));\n \n         let partial_res =\n             self.resolver.get_partial_res(id).unwrap_or_else(|| PartialRes::new(Res::Err));\n@@ -73,7 +72,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                         param_mode,\n                         parenthesized_generic_args,\n                         itctx,\n-                        captures,\n                     )\n                 },\n             )),\n@@ -120,7 +118,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                 param_mode,\n                 ParenthesizedGenericArgs::Err,\n                 itctx,\n-                captures,\n             ));\n             let qpath = hir::QPath::TypeRelative(ty, hir_segment);\n \n@@ -161,7 +158,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                     param_mode,\n                     ParenthesizedGenericArgs::Err,\n                     ImplTraitContext::Disallowed(ImplTraitPosition::Path),\n-                    true,\n                 )\n             })),\n             span: self.lower_span(p.span),\n@@ -186,7 +182,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         param_mode: ParamMode,\n         parenthesized_generic_args: ParenthesizedGenericArgs,\n         itctx: ImplTraitContext,\n-        captures: bool,\n     ) -> hir::PathSegment<'hir> {\n         debug!(\"path_span: {:?}, lower_path_segment(segment: {:?})\", path_span, segment,);\n         let (mut generic_args, infer_args) = if let Some(ref generic_args) = segment.args {\n@@ -259,7 +254,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                 segment.id,\n                 segment.ident.span,\n                 &mut generic_args,\n-                captures,\n             );\n         }\n \n@@ -289,7 +283,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         segment_id: NodeId,\n         segment_ident_span: Span,\n         generic_args: &mut GenericArgsCtor<'hir>,\n-        captures: bool,\n     ) {\n         let (start, end) = match self.resolver.get_lifetime_res(segment_id) {\n             Some(LifetimeRes::ElidedAnchor { start, end }) => (start, end),\n@@ -318,13 +311,10 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n             0,\n             (start.as_u32()..end.as_u32()).map(|i| {\n                 let id = NodeId::from_u32(i);\n-                let l = self.lower_lifetime(\n-                    &Lifetime {\n-                        id,\n-                        ident: Ident::new(kw::UnderscoreLifetime, elided_lifetime_span),\n-                    },\n-                    captures,\n-                );\n+                let l = self.lower_lifetime(&Lifetime {\n+                    id,\n+                    ident: Ident::new(kw::UnderscoreLifetime, elided_lifetime_span),\n+                });\n                 GenericArg::Lifetime(l)\n             }),\n         );\n@@ -368,18 +358,12 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         // we generally don't permit such things (see #51008).\n         let ParenthesizedArgs { span, inputs, inputs_span, output } = data;\n         let inputs = self.arena.alloc_from_iter(inputs.iter().map(|ty| {\n-            self.lower_ty_direct(\n-                ty,\n-                ImplTraitContext::Disallowed(ImplTraitPosition::FnTraitParam),\n-                true,\n-            )\n+            self.lower_ty_direct(ty, ImplTraitContext::Disallowed(ImplTraitPosition::FnTraitParam))\n         }));\n         let output_ty = match output {\n-            FnRetTy::Ty(ty) => self.lower_ty(\n-                &ty,\n-                ImplTraitContext::Disallowed(ImplTraitPosition::FnTraitReturn),\n-                true,\n-            ),\n+            FnRetTy::Ty(ty) => {\n+                self.lower_ty(&ty, ImplTraitContext::Disallowed(ImplTraitPosition::FnTraitReturn))\n+            }\n             FnRetTy::Default(_) => self.arena.alloc(self.ty_tup(*span, &[])),\n         };\n         let args = smallvec![GenericArg::Type(self.ty_tup(*inputs_span, inputs))];"}, {"sha": "a4e603de1ac24c50221deb0e20fb37ff21ff9c04", "filename": "src/test/ui/impl-trait/rpit-assoc-pair-with-lifetime.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/9f77688d1707dc6108803a3e1c4a6aa2747568a4/src%2Ftest%2Fui%2Fimpl-trait%2Frpit-assoc-pair-with-lifetime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f77688d1707dc6108803a3e1c4a6aa2747568a4/src%2Ftest%2Fui%2Fimpl-trait%2Frpit-assoc-pair-with-lifetime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Frpit-assoc-pair-with-lifetime.rs?ref=9f77688d1707dc6108803a3e1c4a6aa2747568a4", "patch": "@@ -0,0 +1,7 @@\n+// check-pass\n+\n+pub fn iter<'a>(v: Vec<(u32, &'a u32)>) -> impl DoubleEndedIterator<Item = (u32, &u32)> {\n+    v.into_iter()\n+}\n+\n+fn main() {}"}]}