{"sha": "6d58987538ed21b3ee3362cb6de3685df2021e45", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZkNTg5ODc1MzhlZDIxYjNlZTMzNjJjYjZkZTM2ODVkZjIwMjFlNDU=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2010-07-02T21:58:55Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2010-07-02T21:58:55Z"}, "message": "Walk (mut/constr stripped) TY_iso edges when boxed. Fault on non-boxed edges; they should not have made it past resolve.", "tree": {"sha": "2ad98ea22cfdc93ee25a262e14ee9f1240e86cff", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2ad98ea22cfdc93ee25a262e14ee9f1240e86cff"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6d58987538ed21b3ee3362cb6de3685df2021e45", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6d58987538ed21b3ee3362cb6de3685df2021e45", "html_url": "https://github.com/rust-lang/rust/commit/6d58987538ed21b3ee3362cb6de3685df2021e45", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6d58987538ed21b3ee3362cb6de3685df2021e45/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8b88fbf3aafbe94d0593a38b2abcad5b18646b18", "url": "https://api.github.com/repos/rust-lang/rust/commits/8b88fbf3aafbe94d0593a38b2abcad5b18646b18", "html_url": "https://github.com/rust-lang/rust/commit/8b88fbf3aafbe94d0593a38b2abcad5b18646b18"}], "stats": {"total": 11, "additions": 6, "deletions": 5}, "files": [{"sha": "d27b75b1967b48c9ceee231f6242fa1c044ba9ed", "filename": "src/boot/me/trans.ml", "status": "modified", "additions": 6, "deletions": 5, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/6d58987538ed21b3ee3362cb6de3685df2021e45/src%2Fboot%2Fme%2Ftrans.ml", "raw_url": "https://github.com/rust-lang/rust/raw/6d58987538ed21b3ee3362cb6de3685df2021e45/src%2Fboot%2Fme%2Ftrans.ml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fboot%2Fme%2Ftrans.ml?ref=6d58987538ed21b3ee3362cb6de3685df2021e45", "patch": "@@ -2613,19 +2613,20 @@ let trans_visitor\n       (curr_iso:Ast.ty_iso option)\n       (t:Ast.ty)\n       : Ast.ty =\n-    match (curr_iso, t) with\n-        (Some iso, Ast.TY_idx n) ->\n+    match (curr_iso, strip_mutable_or_constrained_ty t) with\n+        (_, Ast.TY_idx _) -> bug () \"traversing raw TY_idx (non-box )edge\"\n+      | (Some iso, Ast.TY_box (Ast.TY_idx n)) ->\n           Ast.TY_box (Ast.TY_iso { iso with Ast.iso_index = n })\n-      | (None, Ast.TY_idx _) ->\n+      | (None, Ast.TY_box (Ast.TY_idx _)) ->\n           bug () \"TY_idx outside TY_iso\"\n       | _ -> t\n \n   and maybe_enter_iso\n       (t:Ast.ty)\n       (curr_iso:Ast.ty_iso option)\n       : Ast.ty_iso option =\n-    match t with\n-        Ast.TY_iso tiso -> Some tiso\n+    match strip_mutable_or_constrained_ty t with\n+        Ast.TY_box (Ast.TY_iso tiso) -> Some tiso\n       | _ -> curr_iso\n \n   and mark_slot"}]}