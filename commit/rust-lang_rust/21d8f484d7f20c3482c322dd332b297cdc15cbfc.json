{"sha": "21d8f484d7f20c3482c322dd332b297cdc15cbfc", "node_id": "C_kwDOAAsO6NoAKDIxZDhmNDg0ZDdmMjBjMzQ4MmMzMjJkZDMzMmIyOTdjZGMxNWNiZmM", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-08-23T04:55:27Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-08-23T04:55:27Z"}, "message": "Rollup merge of #100832 - ehuss:bootstrap-cleanup, r=jyn514\n\nSome small bootstrap cleanup\n\nThis is a collection of a few small cleanups. See commits for more details.\n\n* Remove some unused fields from the tool_extended macro.\n* Remove rustfmt from publish_toolstate.\n* Remove Steve from toolstate failure notices.\n* Don't allow rustfmt to fail on dist.", "tree": {"sha": "41fb270caa49ad583526d37e0c9c2e7adf213391", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/41fb270caa49ad583526d37e0c9c2e7adf213391"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/21d8f484d7f20c3482c322dd332b297cdc15cbfc", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjBF2/CRBK7hj4Ov3rIwAAJiQIAFqGPM+OULpf54yGTxdppAxE\nPGKV5HimDOh7KngELywkdUQFWdswxTIxK5evtFKyQIwyNdzS/eVUmWH5Lpv+XJB1\nrapyh/faNAFVSQ+cQdJnjZQOxp42J8vMcug2jYz3JeXm4IjtEdtIyhmNVpCnomrW\nSboVdIlpsQJrT2H6v3z0ImTa+G8LnHEM360//7QTeK2veyegPElu7RTgujoGyLC6\nypIQkyEOQkhMRpTeCthv0ISCCf8SItFaTzCq9YbSv8jfbFeusWlXNMAUCf/C0Cj2\nOVk3bjiThiZGYwK4fyatl3UDup40H6KWtoTPaflhhx/qBzZOZqrxgWKsIkXJuqE=\n=jlbj\n-----END PGP SIGNATURE-----\n", "payload": "tree 41fb270caa49ad583526d37e0c9c2e7adf213391\nparent 579dfa42be707acd0e2fa378b505ed18ad7b5c75\nparent 757913df08f11e216b617a557959f5c28d2974ca\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1661230527 +0200\ncommitter GitHub <noreply@github.com> 1661230527 +0200\n\nRollup merge of #100832 - ehuss:bootstrap-cleanup, r=jyn514\n\nSome small bootstrap cleanup\n\nThis is a collection of a few small cleanups. See commits for more details.\n\n* Remove some unused fields from the tool_extended macro.\n* Remove rustfmt from publish_toolstate.\n* Remove Steve from toolstate failure notices.\n* Don't allow rustfmt to fail on dist.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/21d8f484d7f20c3482c322dd332b297cdc15cbfc", "html_url": "https://github.com/rust-lang/rust/commit/21d8f484d7f20c3482c322dd332b297cdc15cbfc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/21d8f484d7f20c3482c322dd332b297cdc15cbfc/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "579dfa42be707acd0e2fa378b505ed18ad7b5c75", "url": "https://api.github.com/repos/rust-lang/rust/commits/579dfa42be707acd0e2fa378b505ed18ad7b5c75", "html_url": "https://github.com/rust-lang/rust/commit/579dfa42be707acd0e2fa378b505ed18ad7b5c75"}, {"sha": "757913df08f11e216b617a557959f5c28d2974ca", "url": "https://api.github.com/repos/rust-lang/rust/commits/757913df08f11e216b617a557959f5c28d2974ca", "html_url": "https://github.com/rust-lang/rust/commit/757913df08f11e216b617a557959f5c28d2974ca"}], "stats": {"total": 41, "additions": 14, "deletions": 27}, "files": [{"sha": "6bf57a89e896f371941b7f65c1290f24dbe05b9a", "filename": "src/bootstrap/dist.rs", "status": "modified", "additions": 2, "deletions": 9, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/21d8f484d7f20c3482c322dd332b297cdc15cbfc/src%2Fbootstrap%2Fdist.rs", "raw_url": "https://github.com/rust-lang/rust/raw/21d8f484d7f20c3482c322dd332b297cdc15cbfc/src%2Fbootstrap%2Fdist.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdist.rs?ref=21d8f484d7f20c3482c322dd332b297cdc15cbfc", "patch": "@@ -1226,17 +1226,10 @@ impl Step for Rustfmt {\n \n         let rustfmt = builder\n             .ensure(tool::Rustfmt { compiler, target, extra_features: Vec::new() })\n-            .or_else(|| {\n-                missing_tool(\"Rustfmt\", builder.build.config.missing_tools);\n-                None\n-            })?;\n+            .expect(\"rustfmt expected to build - essential tool\");\n         let cargofmt = builder\n             .ensure(tool::Cargofmt { compiler, target, extra_features: Vec::new() })\n-            .or_else(|| {\n-                missing_tool(\"Cargofmt\", builder.build.config.missing_tools);\n-                None\n-            })?;\n-\n+            .expect(\"cargo fmt expected to build - essential tool\");\n         let mut tarball = Tarball::new(builder, \"rustfmt\", &target.triple);\n         tarball.set_overlay(OverlayKind::Rustfmt);\n         tarball.is_preview(true);"}, {"sha": "570da20e7d60dc9aab12314ecea4dc65d0b0dac6", "filename": "src/bootstrap/tool.rs", "status": "modified", "additions": 8, "deletions": 11, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/21d8f484d7f20c3482c322dd332b297cdc15cbfc/src%2Fbootstrap%2Ftool.rs", "raw_url": "https://github.com/rust-lang/rust/raw/21d8f484d7f20c3482c322dd332b297cdc15cbfc/src%2Fbootstrap%2Ftool.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftool.rs?ref=21d8f484d7f20c3482c322dd332b297cdc15cbfc", "patch": "@@ -778,12 +778,10 @@ impl Step for RustAnalyzerProcMacroSrv {\n macro_rules! tool_extended {\n     (($sel:ident, $builder:ident),\n        $($name:ident,\n-       $toolstate:ident,\n        $path:expr,\n        $tool_name:expr,\n        stable = $stable:expr,\n        $(in_tree = $in_tree:expr,)?\n-       $(submodule = $submodule:literal,)?\n        $(tool_std = $tool_std:literal,)?\n        $extra_deps:block;)+) => {\n         $(\n@@ -828,7 +826,6 @@ macro_rules! tool_extended {\n             #[allow(unused_mut)]\n             fn run(mut $sel, $builder: &Builder<'_>) -> Option<PathBuf> {\n                 $extra_deps\n-                $( $builder.update_submodule(&Path::new(\"src\").join(\"tools\").join($submodule)); )?\n                 $builder.ensure(ToolBuild {\n                     compiler: $sel.compiler,\n                     target: $sel.target,\n@@ -854,12 +851,12 @@ macro_rules! tool_extended {\n // Note: Most submodule updates for tools are handled by bootstrap.py, since they're needed just to\n // invoke Cargo to build bootstrap. See the comment there for more details.\n tool_extended!((self, builder),\n-    Cargofmt, rustfmt, \"src/tools/rustfmt\", \"cargo-fmt\", stable=true, in_tree=true, {};\n-    CargoClippy, clippy, \"src/tools/clippy\", \"cargo-clippy\", stable=true, in_tree=true, {};\n-    Clippy, clippy, \"src/tools/clippy\", \"clippy-driver\", stable=true, in_tree=true, {};\n-    Miri, miri, \"src/tools/miri\", \"miri\", stable=false, {};\n-    CargoMiri, miri, \"src/tools/miri/cargo-miri\", \"cargo-miri\", stable=false, {};\n-    Rls, rls, \"src/tools/rls\", \"rls\", stable=true, {\n+    Cargofmt, \"src/tools/rustfmt\", \"cargo-fmt\", stable=true, in_tree=true, {};\n+    CargoClippy, \"src/tools/clippy\", \"cargo-clippy\", stable=true, in_tree=true, {};\n+    Clippy, \"src/tools/clippy\", \"clippy-driver\", stable=true, in_tree=true, {};\n+    Miri, \"src/tools/miri\", \"miri\", stable=false, {};\n+    CargoMiri, \"src/tools/miri/cargo-miri\", \"cargo-miri\", stable=false, {};\n+    Rls, \"src/tools/rls\", \"rls\", stable=true, {\n         builder.ensure(Clippy {\n             compiler: self.compiler,\n             target: self.target,\n@@ -870,8 +867,8 @@ tool_extended!((self, builder),\n     // FIXME: tool_std is not quite right, we shouldn't allow nightly features.\n     // But `builder.cargo` doesn't know how to handle ToolBootstrap in stages other than 0,\n     // and this is close enough for now.\n-    RustDemangler, rust_demangler, \"src/tools/rust-demangler\", \"rust-demangler\", stable=false, in_tree=true, tool_std=true, {};\n-    Rustfmt, rustfmt, \"src/tools/rustfmt\", \"rustfmt\", stable=true, in_tree=true, {};\n+    RustDemangler, \"src/tools/rust-demangler\", \"rust-demangler\", stable=false, in_tree=true, tool_std=true, {};\n+    Rustfmt, \"src/tools/rustfmt\", \"rustfmt\", stable=true, in_tree=true, {};\n );\n \n impl<'a> Builder<'a> {"}, {"sha": "1c57b731aaa3f82b9af2534d6c5254d078c8bd4d", "filename": "src/tools/publish_toolstate.py", "status": "modified", "additions": 4, "deletions": 7, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/21d8f484d7f20c3482c322dd332b297cdc15cbfc/src%2Ftools%2Fpublish_toolstate.py", "raw_url": "https://github.com/rust-lang/rust/raw/21d8f484d7f20c3482c322dd332b297cdc15cbfc/src%2Ftools%2Fpublish_toolstate.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fpublish_toolstate.py?ref=21d8f484d7f20c3482c322dd332b297cdc15cbfc", "patch": "@@ -32,20 +32,18 @@\n MAINTAINERS = {\n     'miri': {'oli-obk', 'RalfJung'},\n     'rls': {'Xanewok'},\n-    'rustfmt': {'topecongiro', 'calebcartwright'},\n-    'book': {'carols10cents', 'steveklabnik'},\n+    'book': {'carols10cents'},\n     'nomicon': {'frewsxcv', 'Gankra', 'JohnTitor'},\n-    'reference': {'steveklabnik', 'Havvy', 'matthewjasper', 'ehuss'},\n-    'rust-by-example': {'steveklabnik', 'marioidival'},\n+    'reference': {'Havvy', 'matthewjasper', 'ehuss'},\n+    'rust-by-example': {'marioidival'},\n     'embedded-book': {'adamgreig', 'andre-richter', 'jamesmunns', 'therealprof'},\n-    'edition-guide': {'ehuss', 'steveklabnik'},\n+    'edition-guide': {'ehuss'},\n     'rustc-dev-guide': {'spastorino', 'amanjeev', 'JohnTitor'},\n }\n \n LABELS = {\n     'miri': ['A-miri', 'C-bug'],\n     'rls': ['A-rls', 'C-bug'],\n-    'rustfmt': ['A-rustfmt', 'C-bug'],\n     'book': ['C-bug'],\n     'nomicon': ['C-bug'],\n     'reference': ['C-bug'],\n@@ -58,7 +56,6 @@\n REPOS = {\n     'miri': 'https://github.com/rust-lang/miri',\n     'rls': 'https://github.com/rust-lang/rls',\n-    'rustfmt': 'https://github.com/rust-lang/rustfmt',\n     'book': 'https://github.com/rust-lang/book',\n     'nomicon': 'https://github.com/rust-lang/nomicon',\n     'reference': 'https://github.com/rust-lang/reference',"}]}