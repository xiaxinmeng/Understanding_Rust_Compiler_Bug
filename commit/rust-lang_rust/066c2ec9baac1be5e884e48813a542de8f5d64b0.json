{"sha": "066c2ec9baac1be5e884e48813a542de8f5d64b0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA2NmMyZWM5YmFhYzFiZTVlODg0ZTQ4ODEzYTU0MmRlOGY1ZDY0YjA=", "commit": {"author": {"name": "gnzlbg", "email": "gonzalobg88@gmail.com", "date": "2018-03-22T13:48:58Z"}, "committer": {"name": "gnzlbg", "email": "gonzalobg88@gmail.com", "date": "2018-03-26T08:20:41Z"}, "message": "require llvm 6", "tree": {"sha": "f69fbb70591875bca6c90e82eed7b581a09e8749", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f69fbb70591875bca6c90e82eed7b581a09e8749"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/066c2ec9baac1be5e884e48813a542de8f5d64b0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/066c2ec9baac1be5e884e48813a542de8f5d64b0", "html_url": "https://github.com/rust-lang/rust/commit/066c2ec9baac1be5e884e48813a542de8f5d64b0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/066c2ec9baac1be5e884e48813a542de8f5d64b0/comments", "author": {"login": "gnzlbg", "id": 904614, "node_id": "MDQ6VXNlcjkwNDYxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gnzlbg", "html_url": "https://github.com/gnzlbg", "followers_url": "https://api.github.com/users/gnzlbg/followers", "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}", "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}", "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions", "organizations_url": "https://api.github.com/users/gnzlbg/orgs", "repos_url": "https://api.github.com/users/gnzlbg/repos", "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}", "received_events_url": "https://api.github.com/users/gnzlbg/received_events", "type": "User", "site_admin": false}, "committer": {"login": "gnzlbg", "id": 904614, "node_id": "MDQ6VXNlcjkwNDYxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gnzlbg", "html_url": "https://github.com/gnzlbg", "followers_url": "https://api.github.com/users/gnzlbg/followers", "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}", "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}", "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions", "organizations_url": "https://api.github.com/users/gnzlbg/orgs", "repos_url": "https://api.github.com/users/gnzlbg/repos", "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}", "received_events_url": "https://api.github.com/users/gnzlbg/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d2cd57c8ff2116c2120da2668cee4ff2bf28315c", "url": "https://api.github.com/repos/rust-lang/rust/commits/d2cd57c8ff2116c2120da2668cee4ff2bf28315c", "html_url": "https://github.com/rust-lang/rust/commit/d2cd57c8ff2116c2120da2668cee4ff2bf28315c"}], "stats": {"total": 19, "additions": 17, "deletions": 2}, "files": [{"sha": "241ee8a48283ac5b35b63997f30b3be76ed04d2f", "filename": "src/librustc_trans/builder.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/066c2ec9baac1be5e884e48813a542de8f5d64b0/src%2Flibrustc_trans%2Fbuilder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/066c2ec9baac1be5e884e48813a542de8f5d64b0/src%2Flibrustc_trans%2Fbuilder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fbuilder.rs?ref=066c2ec9baac1be5e884e48813a542de8f5d64b0", "patch": "@@ -920,13 +920,17 @@ impl<'a, 'tcx> Builder<'a, 'tcx> {\n     pub fn minnum(&self, lhs: ValueRef, rhs: ValueRef) -> ValueRef {\n         self.count_insn(\"minnum\");\n         unsafe {\n-            llvm::LLVMRustBuildMinNum(self.llbuilder, lhs, rhs)\n+            let instr = llvm::LLVMRustBuildMinNum(self.llbuilder, lhs, rhs);\n+            bug!(\"LLVMRustBuildMinNum is not available in LLVM version < 6.0\");\n+            instr\n         }\n     }\n     pub fn maxnum(&self, lhs: ValueRef, rhs: ValueRef) -> ValueRef {\n         self.count_insn(\"maxnum\");\n         unsafe {\n-            llvm::LLVMRustBuildMaxNum(self.llbuilder, lhs, rhs)\n+            let instr = llvm::LLVMRustBuildMaxNum(self.llbuilder, lhs, rhs);\n+            bug!(\"LLVMRustBuildMaxNum is not available in LLVM version < 6.0\");\n+            instr\n         }\n     }\n "}, {"sha": "1b35f0adda6457d80c499da08872d4368cb39401", "filename": "src/rustllvm/RustWrapper.cpp", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/066c2ec9baac1be5e884e48813a542de8f5d64b0/src%2Frustllvm%2FRustWrapper.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/066c2ec9baac1be5e884e48813a542de8f5d64b0/src%2Frustllvm%2FRustWrapper.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2FRustWrapper.cpp?ref=066c2ec9baac1be5e884e48813a542de8f5d64b0", "patch": "@@ -1501,6 +1501,7 @@ LLVMBuildExactUDiv(LLVMBuilderRef B, LLVMValueRef LHS,\n }\n #endif\n \n+#if LLVM_VERSION_GE(6, 0)\n extern \"C\" LLVMValueRef\n LLVMRustBuildMinNum(LLVMBuilderRef B, LLVMValueRef LHS, LLVMValueRef RHS) {\n     return wrap(unwrap(B)->CreateMinNum(unwrap(LHS),unwrap(RHS)));\n@@ -1509,3 +1510,13 @@ extern \"C\" LLVMValueRef\n LLVMRustBuildMaxNum(LLVMBuilderRef B, LLVMValueRef LHS, LLVMValueRef RHS) {\n     return wrap(unwrap(B)->CreateMaxNum(unwrap(LHS),unwrap(RHS)));\n }\n+#else\n+extern \"C\" LLVMValueRef\n+LLVMRustBuildMinNum(LLVMBuilderRef, LLVMValueRef, LLVMValueRef) {\n+   return nullptr;\n+}\n+extern \"C\" LLVMValueRef\n+LLVMRustBuildMaxNum(LLVMBuilderRef, LLVMValueRef, LLVMValueRef) {\n+   return nullptr;\n+}\n+#endif"}]}