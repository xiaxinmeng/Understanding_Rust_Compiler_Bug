{"sha": "a0275e3bf3aa72b40f8f9cb1b3b64c620569377c", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEwMjc1ZTNiZjNhYTcyYjQwZjhmOWNiMWIzYjY0YzYyMDU2OTM3N2M=", "commit": {"author": {"name": "Oliver Scherer", "email": "github35764891676564198441@oli-obk.de", "date": "2019-05-11T14:04:14Z"}, "committer": {"name": "Oliver Scherer", "email": "github35764891676564198441@oli-obk.de", "date": "2019-05-25T08:07:02Z"}, "message": "Only print integers in symbol path's constants", "tree": {"sha": "338df78c75864964589bd6a967da414f7c2a491d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/338df78c75864964589bd6a967da414f7c2a491d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a0275e3bf3aa72b40f8f9cb1b3b64c620569377c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a0275e3bf3aa72b40f8f9cb1b3b64c620569377c", "html_url": "https://github.com/rust-lang/rust/commit/a0275e3bf3aa72b40f8f9cb1b3b64c620569377c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a0275e3bf3aa72b40f8f9cb1b3b64c620569377c/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dd327951eb61b95e28649768ae7e67aaba4e2ece", "url": "https://api.github.com/repos/rust-lang/rust/commits/dd327951eb61b95e28649768ae7e67aaba4e2ece", "html_url": "https://github.com/rust-lang/rust/commit/dd327951eb61b95e28649768ae7e67aaba4e2ece"}], "stats": {"total": 12, "additions": 10, "deletions": 2}, "files": [{"sha": "864071629078aab7e011b94c60b296f0cbf5c818", "filename": "src/librustc_codegen_utils/symbol_names.rs", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/a0275e3bf3aa72b40f8f9cb1b3b64c620569377c/src%2Flibrustc_codegen_utils%2Fsymbol_names.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a0275e3bf3aa72b40f8f9cb1b3b64c620569377c/src%2Flibrustc_codegen_utils%2Fsymbol_names.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_utils%2Fsymbol_names.rs?ref=a0275e3bf3aa72b40f8f9cb1b3b64c620569377c", "patch": "@@ -96,6 +96,7 @@ use rustc::ty::print::{PrettyPrinter, Printer, Print};\n use rustc::ty::query::Providers;\n use rustc::ty::subst::{Kind, SubstsRef, UnpackedKind};\n use rustc::ty::{self, Ty, TyCtxt, TypeFoldable};\n+use rustc::mir::interpret::{ConstValue, Scalar};\n use rustc::util::common::record_time;\n use rustc_data_structures::stable_hasher::{HashStable, StableHasher};\n use rustc_mir::monomorphize::item::{InstantiationMode, MonoItem, MonoItemExt};\n@@ -438,10 +439,17 @@ impl Printer<'tcx, 'tcx> for SymbolPrinter<'_, 'tcx> {\n     }\n \n     fn print_const(\n-        self,\n+        mut self,\n         ct: &'tcx ty::Const<'tcx>,\n     ) -> Result<Self::Const, Self::Error> {\n-        self.pretty_print_const(ct)\n+        // only print integers\n+        if let ConstValue::Scalar(Scalar::Bits { .. }) = ct.val {\n+            if ct.ty.is_integral() {\n+                return self.pretty_print_const(ct);\n+            }\n+        }\n+        self.write_str(\"_\")?;\n+        Ok(self)\n     }\n \n     fn path_crate("}]}