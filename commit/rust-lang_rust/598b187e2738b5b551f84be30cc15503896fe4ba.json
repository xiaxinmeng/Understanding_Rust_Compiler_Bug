{"sha": "598b187e2738b5b551f84be30cc15503896fe4ba", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU5OGIxODdlMjczOGI1YjU1MWY4NGJlMzBjYzE1NTAzODk2ZmU0YmE=", "commit": {"author": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2020-02-23T00:00:00Z"}, "committer": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2020-02-23T14:20:37Z"}, "message": "bootstrap: Remove commit hash from LLVM version suffix to avoid rebuilds\n\nThe custom LLVM version suffix was introduced to avoid unintentional\nlibrary names conflicts. By default it included the LLVM submodule\ncommit hash. Changing the version suffix requires the complete LLVM\nrebuild, and since then every change to the submodules required it as\nwell.\n\nRemove the commit hash from version suffix to avoid complete rebuilds,\nwhile leaving the `rust` string, the release number and release channel\nto disambiguate the library name.", "tree": {"sha": "c50508ec9149f4962969b5d1f43b53c9c76621b0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c50508ec9149f4962969b5d1f43b53c9c76621b0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/598b187e2738b5b551f84be30cc15503896fe4ba", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/598b187e2738b5b551f84be30cc15503896fe4ba", "html_url": "https://github.com/rust-lang/rust/commit/598b187e2738b5b551f84be30cc15503896fe4ba", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/598b187e2738b5b551f84be30cc15503896fe4ba/comments", "author": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9c230f39c159cf7645bc4dbab511b9586d033021", "url": "https://api.github.com/repos/rust-lang/rust/commits/9c230f39c159cf7645bc4dbab511b9586d033021", "html_url": "https://github.com/rust-lang/rust/commit/9c230f39c159cf7645bc4dbab511b9586d033021"}], "stats": {"total": 8, "additions": 2, "deletions": 6}, "files": [{"sha": "c22c2a336f1240e16d08d6ed9e80f329d5a215a8", "filename": "src/bootstrap/native.rs", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/598b187e2738b5b551f84be30cc15503896fe4ba/src%2Fbootstrap%2Fnative.rs", "raw_url": "https://github.com/rust-lang/rust/raw/598b187e2738b5b551f84be30cc15503896fe4ba/src%2Fbootstrap%2Fnative.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fnative.rs?ref=598b187e2738b5b551f84be30cc15503896fe4ba", "patch": "@@ -241,12 +241,8 @@ impl Step for Llvm {\n                 cfg.define(\"LLVM_VERSION_SUFFIX\", suffix);\n             }\n         } else {\n-            let mut default_suffix =\n-                format!(\"-rust-{}-{}\", channel::CFG_RELEASE_NUM, builder.config.channel,);\n-            if let Some(sha) = llvm_info.sha_short() {\n-                default_suffix.push_str(\"-\");\n-                default_suffix.push_str(sha);\n-            }\n+            let default_suffix =\n+                format!(\"-rust-{}-{}\", channel::CFG_RELEASE_NUM, builder.config.channel);\n             cfg.define(\"LLVM_VERSION_SUFFIX\", default_suffix);\n         }\n "}]}