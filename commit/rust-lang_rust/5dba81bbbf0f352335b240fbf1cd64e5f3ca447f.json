{"sha": "5dba81bbbf0f352335b240fbf1cd64e5f3ca447f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVkYmE4MWJiYmYwZjM1MjMzNWIyNDBmYmYxY2Q2NGU1ZjNjYTQ0N2Y=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2018-05-09T01:18:27Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-05-09T01:18:27Z"}, "message": "Merge pull request #2687 from Marwes/issue_2641\n\nfix: Don't insert an extra brace in macros with native newlines", "tree": {"sha": "9d70f8501a1aa7560c7ec0fc7dc301e84cf6a670", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9d70f8501a1aa7560c7ec0fc7dc301e84cf6a670"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5dba81bbbf0f352335b240fbf1cd64e5f3ca447f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJa8kxjCRBK7hj4Ov3rIwAAdHIIAJh9ux67XTrTI412RVQkn5JY\nAUUFgfZvkHwBePRgCTVHGv2D6L2KJGht5XiSU/9Tisvf6sAlh5LXgzw/qPiiTryy\nV9z8SrqiI4erqWDuIVS+9FYbGPcl+IcqKFOXUU+Opy6fHy+5kZA/UEM8yZYrbHO8\nHXy0ncT4MNeSE9zORZrOlZ5yMmbrGBaa7GQxTf+/tME4yX+K63lD9yOWR3MBCANV\nDzIwyl2z4N80EbBj4vimoFtB+9o1+vaJBf37KWuWsFUXWAXDsCsP5F+nbCmr2LOP\neS+W7ZCDvtkwLhKH80yv0LqL3OjRZgzcFLqZI3UYDCAkqQwm8o7ASyVDro0seok=\n=F4A7\n-----END PGP SIGNATURE-----\n", "payload": "tree 9d70f8501a1aa7560c7ec0fc7dc301e84cf6a670\nparent 659d0c97412f2b010003df445f4c9cd84aa4bc75\nparent 4c9ef93df7e7984bbe1077aa3c24ae538fa0a42c\nauthor Nick Cameron <nrc@ncameron.org> 1525828707 +1200\ncommitter GitHub <noreply@github.com> 1525828707 +1200\n\nMerge pull request #2687 from Marwes/issue_2641\n\nfix: Don't insert an extra brace in macros with native newlines"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5dba81bbbf0f352335b240fbf1cd64e5f3ca447f", "html_url": "https://github.com/rust-lang/rust/commit/5dba81bbbf0f352335b240fbf1cd64e5f3ca447f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5dba81bbbf0f352335b240fbf1cd64e5f3ca447f/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "659d0c97412f2b010003df445f4c9cd84aa4bc75", "url": "https://api.github.com/repos/rust-lang/rust/commits/659d0c97412f2b010003df445f4c9cd84aa4bc75", "html_url": "https://github.com/rust-lang/rust/commit/659d0c97412f2b010003df445f4c9cd84aa4bc75"}, {"sha": "4c9ef93df7e7984bbe1077aa3c24ae538fa0a42c", "url": "https://api.github.com/repos/rust-lang/rust/commits/4c9ef93df7e7984bbe1077aa3c24ae538fa0a42c", "html_url": "https://github.com/rust-lang/rust/commit/4c9ef93df7e7984bbe1077aa3c24ae538fa0a42c"}], "stats": {"total": 9, "additions": 8, "deletions": 1}, "files": [{"sha": "48c9295c4f9facefac5d1da9c1baf270e6c58deb", "filename": "src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5dba81bbbf0f352335b240fbf1cd64e5f3ca447f/src%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5dba81bbbf0f352335b240fbf1cd64e5f3ca447f/src%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib.rs?ref=5dba81bbbf0f352335b240fbf1cd64e5f3ca447f", "patch": "@@ -646,7 +646,7 @@ pub fn format_code_block(code_snippet: &str, config: &Config) -> Option<String>\n     // then unindent the whole code block.\n     let formatted = format_snippet(&snippet, config)?;\n     // 2 = \"}\\n\"\n-    let block_len = formatted.len().checked_sub(2).unwrap_or(0);\n+    let block_len = formatted.rfind('}').unwrap_or(formatted.len());\n     let mut is_indented = true;\n     for (kind, ref line) in LineClasses::new(&formatted[FN_MAIN_PREFIX.len()..block_len]) {\n         if !is_first {"}, {"sha": "11c9dca8a06c969f05c1f42fc7abd8f0d64c341a", "filename": "tests/config/issue-2641.toml", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5dba81bbbf0f352335b240fbf1cd64e5f3ca447f/tests%2Fconfig%2Fissue-2641.toml", "raw_url": "https://github.com/rust-lang/rust/raw/5dba81bbbf0f352335b240fbf1cd64e5f3ca447f/tests%2Fconfig%2Fissue-2641.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fconfig%2Fissue-2641.toml?ref=5dba81bbbf0f352335b240fbf1cd64e5f3ca447f", "patch": "@@ -0,0 +1 @@\n+newline_style = \"Windows\""}, {"sha": "c7ad60674fd5464443f746620fdc7980b4271743", "filename": "tests/source/issue-2641.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/5dba81bbbf0f352335b240fbf1cd64e5f3ca447f/tests%2Fsource%2Fissue-2641.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5dba81bbbf0f352335b240fbf1cd64e5f3ca447f/tests%2Fsource%2Fissue-2641.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fissue-2641.rs?ref=5dba81bbbf0f352335b240fbf1cd64e5f3ca447f", "patch": "@@ -0,0 +1,3 @@\n+macro_rules! a {\n+    () => {{}}\n+}"}, {"sha": "fbf5326c330dbe96013e0bbcaf408d869af740d3", "filename": "tests/target/issue-2641.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/5dba81bbbf0f352335b240fbf1cd64e5f3ca447f/tests%2Ftarget%2Fissue-2641.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5dba81bbbf0f352335b240fbf1cd64e5f3ca447f/tests%2Ftarget%2Fissue-2641.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-2641.rs?ref=5dba81bbbf0f352335b240fbf1cd64e5f3ca447f", "patch": "@@ -0,0 +1,3 @@\n+macro_rules! a {\n+    () => {{}};\n+}"}]}