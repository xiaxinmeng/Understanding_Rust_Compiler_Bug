{"sha": "d230242e234cb81e8137177429732a548c024204", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQyMzAyNDJlMjM0Y2I4MWU4MTM3MTc3NDI5NzMyYTU0OGMwMjQyMDQ=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2017-11-20T01:45:07Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-11-20T01:45:07Z"}, "message": "Merge pull request #2162 from utkarshkukreti/issue-1753\n\nFix missing trailing newline in --write-mode=diff.", "tree": {"sha": "db516f0fb00113d62dec83aace38da0c607d10ae", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/db516f0fb00113d62dec83aace38da0c607d10ae"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d230242e234cb81e8137177429732a548c024204", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJaEjOjCRBK7hj4Ov3rIwAAdHIIAFRSuBTaxpGiz1ejbW0kUWDV\ntxsNIFnbyu84603VYShMnwjktafTMt1xATfz6TKSYn0scizXGNK1XXvizIVA1BsU\n56vM4L9zbCdkh/30yUPGU06aGe9j/MFMn/41RPcr0XYbN4aLohTOfhvskk9P0CZx\nOx9oWyjjrYItqKgX6UDWjDfQYj+RTd7F+KTpewUU6dwibn84A9GeoPEPlCtFB8JZ\nMHau0hFY/iKWRRTBIngso6Rw8l0lOYKeUuKkuVYa09h1KR0hN6VlI4bS9tTAsEVb\nCQTOIj3ERZD+Ef7ZJCM+wJ4P3jOb8scfJ/qTion7DzUQAtoxv94ZzEeo6QxUOs0=\n=96DF\n-----END PGP SIGNATURE-----\n", "payload": "tree db516f0fb00113d62dec83aace38da0c607d10ae\nparent fa794f5808f0d95925afb31d188411ef5e2c28f7\nparent d44d4a3fbcc2d8fdec1c100215a690f1f5a3b45a\nauthor Nick Cameron <nrc@ncameron.org> 1511142307 +1300\ncommitter GitHub <noreply@github.com> 1511142307 +1300\n\nMerge pull request #2162 from utkarshkukreti/issue-1753\n\nFix missing trailing newline in --write-mode=diff."}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d230242e234cb81e8137177429732a548c024204", "html_url": "https://github.com/rust-lang/rust/commit/d230242e234cb81e8137177429732a548c024204", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d230242e234cb81e8137177429732a548c024204/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fa794f5808f0d95925afb31d188411ef5e2c28f7", "url": "https://api.github.com/repos/rust-lang/rust/commits/fa794f5808f0d95925afb31d188411ef5e2c28f7", "html_url": "https://github.com/rust-lang/rust/commit/fa794f5808f0d95925afb31d188411ef5e2c28f7"}, {"sha": "d44d4a3fbcc2d8fdec1c100215a690f1f5a3b45a", "url": "https://api.github.com/repos/rust-lang/rust/commits/d44d4a3fbcc2d8fdec1c100215a690f1f5a3b45a", "html_url": "https://github.com/rust-lang/rust/commit/d44d4a3fbcc2d8fdec1c100215a690f1f5a3b45a"}], "stats": {"total": 24, "additions": 20, "deletions": 4}, "files": [{"sha": "eb01bacbf2141397ac1b438099b2550348478c7e", "filename": "Cargo.lock", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d230242e234cb81e8137177429732a548c024204/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/d230242e234cb81e8137177429732a548c024204/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=d230242e234cb81e8137177429732a548c024204", "patch": "@@ -17,7 +17,7 @@ dependencies = [\n \n [[package]]\n name = \"diff\"\n-version = \"0.1.10\"\n+version = \"0.1.11\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n@@ -108,7 +108,7 @@ name = \"rustfmt-nightly\"\n version = \"0.2.15\"\n dependencies = [\n  \"derive-new 0.5.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"diff 0.1.10 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"diff 0.1.11 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"env_logger 0.4.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"getopts 0.2.15 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"kernel32-sys 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -253,7 +253,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n [metadata]\n \"checksum aho-corasick 0.6.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"500909c4f87a9e52355b26626d890833e9e1d53ac566db76c36faa984b889699\"\n \"checksum derive-new 0.5.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"415f627ab054041c3eb748c2e1da0ef751989f5f0c386b63a098e545854a98ba\"\n-\"checksum diff 0.1.10 (registry+https://github.com/rust-lang/crates.io-index)\" = \"0a515461b6c8c08419850ced27bc29e86166dcdcde8fbe76f8b1f0589bb49472\"\n+\"checksum diff 0.1.11 (registry+https://github.com/rust-lang/crates.io-index)\" = \"3c2b69f912779fbb121ceb775d74d51e915af17aaebc38d28a592843a2dd0a3a\"\n \"checksum dtoa 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"09c3753c3db574d215cba4ea76018483895d7bff25a31b49ba45db21c48e50ab\"\n \"checksum env_logger 0.4.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"3ddf21e73e016298f5cb37d6ef8e8da8e39f91f9ec8b0df44b7deb16a9f8cd5b\"\n \"checksum getopts 0.2.15 (registry+https://github.com/rust-lang/crates.io-index)\" = \"65922871abd2f101a2eb0eaebadc66668e54a87ad9c3dd82520b5f86ede5eff9\""}, {"sha": "34c1d81d40cda291c74cbb96326671c9ee254737", "filename": "src/checkstyle.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d230242e234cb81e8137177429732a548c024204/src%2Fcheckstyle.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d230242e234cb81e8137177429732a548c024204/src%2Fcheckstyle.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcheckstyle.rs?ref=d230242e234cb81e8137177429732a548c024204", "patch": "@@ -33,7 +33,7 @@ where\n {\n     if mode == WriteMode::Checkstyle {\n         let mut xml_tail = String::new();\n-        xml_tail.push_str(\"</checkstyle>\");\n+        xml_tail.push_str(\"</checkstyle>\\n\");\n         write!(out, \"{}\", xml_tail)?;\n     }\n     Ok(())"}, {"sha": "c2dac6c041689d3a6e3c36780c4b8056008a6cab", "filename": "src/rustfmt_diff.rs", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/d230242e234cb81e8137177429732a548c024204/src%2Frustfmt_diff.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d230242e234cb81e8137177429732a548c024204/src%2Frustfmt_diff.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustfmt_diff.rs?ref=d230242e234cb81e8137177429732a548c024204", "patch": "@@ -234,4 +234,20 @@ mod test {\n             ]\n         );\n     }\n+\n+    #[test]\n+    fn diff_trailing_newline() {\n+        let src = \"one\\ntwo\\nthree\\nfour\\nfive\";\n+        let dest = \"one\\ntwo\\nthree\\nfour\\nfive\\n\";\n+        let diff = make_diff(src, dest, 1);\n+        assert_eq!(\n+            diff,\n+            vec![\n+                Mismatch {\n+                    line_number: 5,\n+                    lines: vec![Context(\"five\".into()), Expected(\"\".into())],\n+                },\n+            ]\n+        );\n+    }\n }"}]}