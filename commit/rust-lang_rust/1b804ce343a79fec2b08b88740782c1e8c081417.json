{"sha": "1b804ce343a79fec2b08b88740782c1e8c081417", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFiODA0Y2UzNDNhNzlmZWMyYjA4Yjg4NzQwNzgyYzFlOGMwODE0MTc=", "commit": {"author": {"name": "Tim Chevalier", "email": "chevalier@alum.wellesley.edu", "date": "2012-08-22T23:43:23Z"}, "committer": {"name": "Tim Chevalier", "email": "chevalier@alum.wellesley.edu", "date": "2012-08-22T23:43:23Z"}, "message": "Merge find_linkage_attrs with find_linkage_metas\n\nThis gets rid of a gratuitous `match check`.", "tree": {"sha": "1b059512568fc79a8cc54fdf834f878ae38a28d4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1b059512568fc79a8cc54fdf834f878ae38a28d4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1b804ce343a79fec2b08b88740782c1e8c081417", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1b804ce343a79fec2b08b88740782c1e8c081417", "html_url": "https://github.com/rust-lang/rust/commit/1b804ce343a79fec2b08b88740782c1e8c081417", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1b804ce343a79fec2b08b88740782c1e8c081417/comments", "author": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "committer": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0a5f88a2406bf78a216ea8e2128441766dd7cd9c", "url": "https://api.github.com/repos/rust-lang/rust/commits/0a5f88a2406bf78a216ea8e2128441766dd7cd9c", "html_url": "https://github.com/rust-lang/rust/commit/0a5f88a2406bf78a216ea8e2128441766dd7cd9c"}], "stats": {"total": 35, "additions": 11, "deletions": 24}, "files": [{"sha": "c339d322af8dc9ea2bccab60c4f83427f4078e38", "filename": "src/libsyntax/attr.rs", "status": "modified", "additions": 5, "deletions": 15, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/1b804ce343a79fec2b08b88740782c1e8c081417/src%2Flibsyntax%2Fattr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1b804ce343a79fec2b08b88740782c1e8c081417/src%2Flibsyntax%2Fattr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fattr.rs?ref=1b804ce343a79fec2b08b88740782c1e8c081417", "patch": "@@ -297,25 +297,15 @@ fn remove_meta_items_by_name(items: ~[@ast::meta_item], name: ~str) ->\n     });\n }\n \n-fn find_linkage_attrs(attrs: ~[ast::attribute]) -> ~[ast::attribute] {\n-    let mut found = ~[];\n-    for find_attrs_by_name(attrs, ~\"link\").each |attr| {\n-        match attr.node.value.node {\n-          ast::meta_list(_, _) => vec::push(found, attr),\n-          _ => debug!{\"ignoring link attribute that has incorrect type\"}\n-        }\n-    }\n-    return found;\n-}\n-\n /**\n- * From a list of crate attributes get only the meta_items that impact crate\n+ * From a list of crate attributes get only the meta_items that affect crate\n  * linkage\n  */\n fn find_linkage_metas(attrs: ~[ast::attribute]) -> ~[@ast::meta_item] {\n-    do find_linkage_attrs(attrs).flat_map |attr| {\n-        match check attr.node.value.node {\n-          ast::meta_list(_, items) => /* FIXME (#2543) */ copy items\n+    do find_attrs_by_name(attrs, ~\"link\").flat_map |attr| {\n+        match attr.node.value.node {\n+            ast::meta_list(_, items) => /* FIXME (#2543) */ copy items,\n+            _ => ~[]\n         }\n     }\n }"}, {"sha": "9581dd9f04733520ad5ce1d092f6ccd09df89020", "filename": "src/libsyntax/print/pprust.rs", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1b804ce343a79fec2b08b88740782c1e8c081417/src%2Flibsyntax%2Fprint%2Fpprust.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1b804ce343a79fec2b08b88740782c1e8c081417/src%2Flibsyntax%2Fprint%2Fpprust.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fprint%2Fpprust.rs?ref=1b804ce343a79fec2b08b88740782c1e8c081417", "patch": "@@ -117,10 +117,6 @@ fn item_to_str(i: @ast::item, intr: ident_interner) -> ~str {\n     to_str(i, print_item, intr)\n }\n \n-fn attr_to_str(i: ast::attribute, intr: ident_interner) -> ~str {\n-    to_str(i, print_attribute, intr)\n-}\n-\n fn typarams_to_str(tps: ~[ast::ty_param], intr: ident_interner) -> ~str {\n     to_str(tps, print_type_params, intr)\n }\n@@ -165,8 +161,8 @@ fn block_to_str(blk: ast::blk, intr: ident_interner) -> ~str {\n     io::mem_buffer_str(buffer)\n }\n \n-fn meta_item_to_str(mi: ast::meta_item, intr: ident_interner) -> ~str {\n-    to_str(@mi, print_meta_item, intr)\n+fn meta_item_to_str(mi: @ast::meta_item, intr: ident_interner) -> ~str {\n+    to_str(mi, print_meta_item, intr)\n }\n \n fn attribute_to_str(attr: ast::attribute, intr: ident_interner) -> ~str {"}, {"sha": "1b4fad2ca66acb74038c760093b00479e2b60794", "filename": "src/rustc/metadata/decoder.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1b804ce343a79fec2b08b88740782c1e8c081417/src%2Frustc%2Fmetadata%2Fdecoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1b804ce343a79fec2b08b88740782c1e8c081417/src%2Frustc%2Fmetadata%2Fdecoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fmetadata%2Fdecoder.rs?ref=1b804ce343a79fec2b08b88740782c1e8c081417", "patch": "@@ -823,7 +823,7 @@ fn get_attributes(md: ebml::doc) -> ~[ast::attribute] {\n fn list_meta_items(intr: ident_interner,\n                    meta_items: ebml::doc, out: io::Writer) {\n     for get_meta_items(meta_items).each |mi| {\n-        out.write_str(fmt!{\"%s\\n\", pprust::meta_item_to_str(*mi, intr)});\n+        out.write_str(fmt!{\"%s\\n\", pprust::meta_item_to_str(mi, intr)});\n     }\n }\n "}, {"sha": "f330ad56947213b88e4f1774755b37c8da25b5c7", "filename": "src/rustc/metadata/loader.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/1b804ce343a79fec2b08b88740782c1e8c081417/src%2Frustc%2Fmetadata%2Floader.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1b804ce343a79fec2b08b88740782c1e8c081417/src%2Frustc%2Fmetadata%2Floader.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fmetadata%2Floader.rs?ref=1b804ce343a79fec2b08b88740782c1e8c081417", "patch": "@@ -136,8 +136,9 @@ fn crate_name_from_metas(metas: ~[@ast::meta_item]) -> ~str {\n \n fn note_linkage_attrs(intr: ident_interner, diag: span_handler,\n                       attrs: ~[ast::attribute]) {\n-    for attr::find_linkage_attrs(attrs).each |attr| {\n-        diag.handler().note(fmt!{\"meta: %s\", pprust::attr_to_str(attr,intr)});\n+    for attr::find_linkage_metas(attrs).each |mi| {\n+        diag.handler().note(fmt!{\"meta: %s\",\n+              pprust::meta_item_to_str(mi,intr)});\n     }\n }\n "}]}