{"sha": "b219a4c465a73f20e4bac326bb13134005427810", "node_id": "C_kwDOAAsO6NoAKGIyMTlhNGM0NjVhNzNmMjBlNGJhYzMyNmJiMTMxMzQwMDU0Mjc4MTA", "commit": {"author": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2021-10-19T12:15:47Z"}, "committer": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2021-10-19T12:20:00Z"}, "message": "internal: Parse const trait bounds", "tree": {"sha": "fcbcacda26561a82a6af5b0c29f08f3631617bb8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fcbcacda26561a82a6af5b0c29f08f3631617bb8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b219a4c465a73f20e4bac326bb13134005427810", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b219a4c465a73f20e4bac326bb13134005427810", "html_url": "https://github.com/rust-lang/rust/commit/b219a4c465a73f20e4bac326bb13134005427810", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b219a4c465a73f20e4bac326bb13134005427810/comments", "author": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "401daa5f77fd9cfb79d16fe3a54bc576d60b4c82", "url": "https://api.github.com/repos/rust-lang/rust/commits/401daa5f77fd9cfb79d16fe3a54bc576d60b4c82", "html_url": "https://github.com/rust-lang/rust/commit/401daa5f77fd9cfb79d16fe3a54bc576d60b4c82"}], "stats": {"total": 64, "additions": 45, "deletions": 19}, "files": [{"sha": "fa7c97d5a7c75138fcdd3839f6ae018e398509d8", "filename": "Cargo.lock", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b219a4c465a73f20e4bac326bb13134005427810/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/b219a4c465a73f20e4bac326bb13134005427810/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=b219a4c465a73f20e4bac326bb13134005427810", "patch": "@@ -1763,9 +1763,9 @@ dependencies = [\n \n [[package]]\n name = \"ungrammar\"\n-version = \"1.14.8\"\n+version = \"1.14.9\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"403c1892ad46cacffb28c73550172999c6c75f70ca9c97bcafc8ce99d6421529\"\n+checksum = \"66be59c2fd880e3d76d1a6cf6d34114008f1d8af2748d4ad9d39ea712f14fda9\"\n \n [[package]]\n name = \"unicase\""}, {"sha": "84da50b9f6cd963df05b04d398b780832a21d501", "filename": "Cargo.toml", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/b219a4c465a73f20e4bac326bb13134005427810/Cargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/b219a4c465a73f20e4bac326bb13134005427810/Cargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.toml?ref=b219a4c465a73f20e4bac326bb13134005427810", "patch": "@@ -19,7 +19,8 @@ miniz_oxide.opt-level = 3\n \n [profile.release]\n incremental = true\n-debug = 0 # Set this to 1 or 2 to get more useful backtraces in debugger.\n+# Set this to 1 or 2 to get more useful backtraces in debugger.\n+debug = 0\n \n [patch.'crates-io']\n # rowan = { path = \"../rowan\" }"}, {"sha": "1009c67ffa134be4983a736876a2642898d11d8a", "filename": "crates/parser/src/grammar/generic_params.rs", "status": "modified", "additions": 16, "deletions": 6, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/b219a4c465a73f20e4bac326bb13134005427810/crates%2Fparser%2Fsrc%2Fgrammar%2Fgeneric_params.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b219a4c465a73f20e4bac326bb13134005427810/crates%2Fparser%2Fsrc%2Fgrammar%2Fgeneric_params.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Fsrc%2Fgrammar%2Fgeneric_params.rs?ref=b219a4c465a73f20e4bac326bb13134005427810", "patch": "@@ -100,7 +100,7 @@ fn lifetime_bounds(p: &mut Parser) {\n }\n \n // test type_param_bounds\n-// struct S<T: 'a + ?Sized + (Copy)>;\n+// struct S<T: 'a + ?Sized + (Copy) + ~const Drop>;\n pub(super) fn bounds(p: &mut Parser) {\n     assert!(p.at(T![:]));\n     p.bump(T![:]);\n@@ -124,14 +124,24 @@ pub(super) fn bounds_without_colon_m(p: &mut Parser, marker: Marker) -> Complete\n fn type_bound(p: &mut Parser) -> bool {\n     let m = p.start();\n     let has_paren = p.eat(T!['(']);\n-    p.eat(T![?]);\n     match p.current() {\n         LIFETIME_IDENT => lifetime(p),\n         T![for] => types::for_type(p, false),\n-        _ if paths::is_use_path_start(p) => types::path_type_(p, false),\n-        _ => {\n-            m.abandon(p);\n-            return false;\n+        current => {\n+            match current {\n+                T![?] => p.bump_any(),\n+                T![~] => {\n+                    p.bump_any();\n+                    p.expect(T![const]);\n+                }\n+                _ => (),\n+            }\n+            if paths::is_use_path_start(p) {\n+                types::path_type_(p, false);\n+            } else {\n+                m.abandon(p);\n+                return false;\n+            }\n         }\n     }\n     if has_paren {"}, {"sha": "d5fc7893cfeb628e21886394587553a17ac697e6", "filename": "crates/syntax/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b219a4c465a73f20e4bac326bb13134005427810/crates%2Fsyntax%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/b219a4c465a73f20e4bac326bb13134005427810/crates%2Fsyntax%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fsyntax%2FCargo.toml?ref=b219a4c465a73f20e4bac326bb13134005427810", "patch": "@@ -29,7 +29,7 @@ rayon = \"1\"\n expect-test = \"1.2.0-pre.1\"\n proc-macro2 = \"1.0.8\"\n quote = \"1.0.2\"\n-ungrammar = \"=1.14.8\"\n+ungrammar = \"=1.14.9\"\n \n test_utils = { path = \"../test_utils\" }\n sourcegen = { path = \"../sourcegen\" }"}, {"sha": "005e78c48a1c15917459ab4d366f73c6ec4a2add", "filename": "crates/syntax/src/ast/generated/nodes.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b219a4c465a73f20e4bac326bb13134005427810/crates%2Fsyntax%2Fsrc%2Fast%2Fgenerated%2Fnodes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b219a4c465a73f20e4bac326bb13134005427810/crates%2Fsyntax%2Fsrc%2Fast%2Fgenerated%2Fnodes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fsyntax%2Fsrc%2Fast%2Fgenerated%2Fnodes.rs?ref=b219a4c465a73f20e4bac326bb13134005427810", "patch": "@@ -1271,6 +1271,8 @@ pub struct TypeBound {\n impl TypeBound {\n     pub fn lifetime(&self) -> Option<Lifetime> { support::child(&self.syntax) }\n     pub fn question_mark_token(&self) -> Option<SyntaxToken> { support::token(&self.syntax, T![?]) }\n+    pub fn tilde_token(&self) -> Option<SyntaxToken> { support::token(&self.syntax, T![~]) }\n+    pub fn const_token(&self) -> Option<SyntaxToken> { support::token(&self.syntax, T![const]) }\n     pub fn ty(&self) -> Option<Type> { support::child(&self.syntax) }\n }\n "}, {"sha": "a1a96581b4a21c0a3a140c1aef848a44db556fef", "filename": "crates/syntax/src/tests/sourcegen_ast.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b219a4c465a73f20e4bac326bb13134005427810/crates%2Fsyntax%2Fsrc%2Ftests%2Fsourcegen_ast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b219a4c465a73f20e4bac326bb13134005427810/crates%2Fsyntax%2Fsrc%2Ftests%2Fsourcegen_ast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fsyntax%2Fsrc%2Ftests%2Fsourcegen_ast.rs?ref=b219a4c465a73f20e4bac326bb13134005427810", "patch": "@@ -536,6 +536,7 @@ impl Field {\n                     \"?\" => \"question_mark\",\n                     \",\" => \"comma\",\n                     \"|\" => \"pipe\",\n+                    \"~\" => \"tilde\",\n                     _ => name,\n                 };\n                 format_ident!(\"{}_token\", name)"}, {"sha": "4cd03485f425d5fdae3311eec51a9ba0a7f949c1", "filename": "crates/syntax/test_data/parser/inline/ok/0007_type_param_bounds.rast", "status": "modified", "additions": 20, "deletions": 8, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/b219a4c465a73f20e4bac326bb13134005427810/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0007_type_param_bounds.rast", "raw_url": "https://github.com/rust-lang/rust/raw/b219a4c465a73f20e4bac326bb13134005427810/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0007_type_param_bounds.rast", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0007_type_param_bounds.rast?ref=b219a4c465a73f20e4bac326bb13134005427810", "patch": "@@ -1,17 +1,17 @@\n-SOURCE_FILE@0..35\n-  STRUCT@0..34\n+SOURCE_FILE@0..49\n+  STRUCT@0..48\n     STRUCT_KW@0..6 \"struct\"\n     WHITESPACE@6..7 \" \"\n     NAME@7..8\n       IDENT@7..8 \"S\"\n-    GENERIC_PARAM_LIST@8..33\n+    GENERIC_PARAM_LIST@8..47\n       L_ANGLE@8..9 \"<\"\n-      TYPE_PARAM@9..32\n+      TYPE_PARAM@9..46\n         NAME@9..10\n           IDENT@9..10 \"T\"\n         COLON@10..11 \":\"\n         WHITESPACE@11..12 \" \"\n-        TYPE_BOUND_LIST@12..32\n+        TYPE_BOUND_LIST@12..46\n           TYPE_BOUND@12..14\n             LIFETIME@12..14\n               LIFETIME_IDENT@12..14 \"'a\"\n@@ -36,6 +36,18 @@ SOURCE_FILE@0..35\n                   NAME_REF@27..31\n                     IDENT@27..31 \"Copy\"\n             R_PAREN@31..32 \")\"\n-      R_ANGLE@32..33 \">\"\n-    SEMICOLON@33..34 \";\"\n-  WHITESPACE@34..35 \"\\n\"\n+          WHITESPACE@32..33 \" \"\n+          PLUS@33..34 \"+\"\n+          WHITESPACE@34..35 \" \"\n+          TYPE_BOUND@35..46\n+            TILDE@35..36 \"~\"\n+            CONST_KW@36..41 \"const\"\n+            WHITESPACE@41..42 \" \"\n+            PATH_TYPE@42..46\n+              PATH@42..46\n+                PATH_SEGMENT@42..46\n+                  NAME_REF@42..46\n+                    IDENT@42..46 \"Drop\"\n+      R_ANGLE@46..47 \">\"\n+    SEMICOLON@47..48 \";\"\n+  WHITESPACE@48..49 \"\\n\""}, {"sha": "5da3083b9c56d40b25da57d5c3968160890bc14b", "filename": "crates/syntax/test_data/parser/inline/ok/0007_type_param_bounds.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b219a4c465a73f20e4bac326bb13134005427810/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0007_type_param_bounds.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b219a4c465a73f20e4bac326bb13134005427810/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0007_type_param_bounds.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0007_type_param_bounds.rs?ref=b219a4c465a73f20e4bac326bb13134005427810", "patch": "@@ -1 +1 @@\n-struct S<T: 'a + ?Sized + (Copy)>;\n+struct S<T: 'a + ?Sized + (Copy) + ~const Drop>;"}]}