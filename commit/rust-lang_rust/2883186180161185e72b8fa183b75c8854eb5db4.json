{"sha": "2883186180161185e72b8fa183b75c8854eb5db4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI4ODMxODYxODAxNjExODVlNzJiOGZhMTgzYjc1Yzg4NTRlYjVkYjQ=", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2017-01-19T00:33:25Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2017-01-19T00:33:25Z"}, "message": "Use multiline Diagnostic for candidate in other module", "tree": {"sha": "b6e9e0e3ec951e556ba207fd26168146ca2abd1e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b6e9e0e3ec951e556ba207fd26168146ca2abd1e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2883186180161185e72b8fa183b75c8854eb5db4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2883186180161185e72b8fa183b75c8854eb5db4", "html_url": "https://github.com/rust-lang/rust/commit/2883186180161185e72b8fa183b75c8854eb5db4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2883186180161185e72b8fa183b75c8854eb5db4/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c8af93f0901c336e873ce18274026d0fd9bc7c1f", "url": "https://api.github.com/repos/rust-lang/rust/commits/c8af93f0901c336e873ce18274026d0fd9bc7c1f", "html_url": "https://github.com/rust-lang/rust/commit/c8af93f0901c336e873ce18274026d0fd9bc7c1f"}], "stats": {"total": 75, "additions": 38, "deletions": 37}, "files": [{"sha": "fabc8790c2a6d304bd17a801acd288b8130b6656", "filename": "src/librustc_resolve/lib.rs", "status": "modified", "additions": 17, "deletions": 16, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/2883186180161185e72b8fa183b75c8854eb5db4/src%2Flibrustc_resolve%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2883186180161185e72b8fa183b75c8854eb5db4/src%2Flibrustc_resolve%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Flib.rs?ref=2883186180161185e72b8fa183b75c8854eb5db4", "patch": "@@ -67,6 +67,7 @@ use syntax_pos::{Span, DUMMY_SP, MultiSpan};\n use errors::DiagnosticBuilder;\n \n use std::cell::{Cell, RefCell};\n+use std::cmp;\n use std::fmt;\n use std::mem::replace;\n use std::rc::Rc;\n@@ -3224,7 +3225,7 @@ fn show_candidates(session: &mut DiagnosticBuilder,\n                    better: bool) {\n     // don't show more than MAX_CANDIDATES results, so\n     // we're consistent with the trait suggestions\n-    const MAX_CANDIDATES: usize = 5;\n+    const MAX_CANDIDATES: usize = 4;\n \n     // we want consistent results across executions, but candidates are produced\n     // by iterating through a hash map, so make sure they are ordered:\n@@ -3237,21 +3238,21 @@ fn show_candidates(session: &mut DiagnosticBuilder,\n         1 => \" is found in another module, you can import it\",\n         _ => \"s are found in other modules, you can import them\",\n     };\n-    session.help(&format!(\"possible {}candidate{} into scope:\", better, msg_diff));\n-\n-    let count = path_strings.len() as isize - MAX_CANDIDATES as isize + 1;\n-    for (idx, path_string) in path_strings.iter().enumerate() {\n-        if idx == MAX_CANDIDATES - 1 && count > 1 {\n-            session.help(\n-                &format!(\"  and {} other candidates\", count).to_string(),\n-            );\n-            break;\n-        } else {\n-            session.help(\n-                &format!(\"  `use {};`\", path_string).to_string(),\n-            );\n-        }\n-    }\n+\n+    let end = cmp::min(MAX_CANDIDATES, path_strings.len());\n+    session.help(&format!(\"possible {}candidate{} into scope:{}{}\",\n+                          better,\n+                          msg_diff,\n+                          &path_strings[0..end].iter().map(|candidate| {\n+                              format!(\"\\n  `use {};`\", candidate)\n+                          }).collect::<String>(),\n+                          if path_strings.len() > MAX_CANDIDATES {\n+                              format!(\"\\nand {} other candidates\",\n+                                      path_strings.len() - MAX_CANDIDATES)\n+                          } else {\n+                              \"\".to_owned()\n+                          }\n+                          ));\n }\n \n /// A somewhat inefficient routine to obtain the name of a module."}, {"sha": "d541aa599a48b2bdbbf24c1b8336c707c52ab246", "filename": "src/test/ui/resolve/enums-are-namespaced-xc.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fenums-are-namespaced-xc.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fenums-are-namespaced-xc.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Fenums-are-namespaced-xc.stderr?ref=2883186180161185e72b8fa183b75c8854eb5db4", "patch": "@@ -5,7 +5,7 @@ error[E0425]: cannot find value `A` in module `namespaced_enums`\n    |             ^^^^^^^^^^^^^^^^^^^ not found in `namespaced_enums`\n    |\n    = help: possible candidate is found in another module, you can import it into scope:\n-   = help:   `use namespaced_enums::Foo::A;`\n+             `use namespaced_enums::Foo::A;`\n \n error[E0425]: cannot find function `B` in module `namespaced_enums`\n   --> $DIR/enums-are-namespaced-xc.rs:18:13\n@@ -14,7 +14,7 @@ error[E0425]: cannot find function `B` in module `namespaced_enums`\n    |             ^^^^^^^^^^^^^^^^^^^ not found in `namespaced_enums`\n    |\n    = help: possible candidate is found in another module, you can import it into scope:\n-   = help:   `use namespaced_enums::Foo::B;`\n+             `use namespaced_enums::Foo::B;`\n \n error[E0422]: cannot find struct, variant or union type `C` in module `namespaced_enums`\n   --> $DIR/enums-are-namespaced-xc.rs:21:13\n@@ -23,7 +23,7 @@ error[E0422]: cannot find struct, variant or union type `C` in module `namespace\n    |             ^^^^^^^^^^^^^^^^^^^ not found in `namespaced_enums`\n    |\n    = help: possible candidate is found in another module, you can import it into scope:\n-   = help:   `use namespaced_enums::Foo::C;`\n+             `use namespaced_enums::Foo::C;`\n \n error: aborting due to 3 previous errors\n "}, {"sha": "69c48cc1f3241b9bbd0658c0119eabdb0410014a", "filename": "src/test/ui/resolve/issue-16058.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fissue-16058.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fissue-16058.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Fissue-16058.stderr?ref=2883186180161185e72b8fa183b75c8854eb5db4", "patch": "@@ -5,9 +5,9 @@ error[E0574]: expected struct, variant or union type, found enum `Result`\n    |         ^^^^^^ not a struct, variant or union type\n    |\n    = help: possible better candidates are found in other modules, you can import them into scope:\n-   = help:   `use std::fmt::Result;`\n-   = help:   `use std::io::Result;`\n-   = help:   `use std::thread::Result;`\n+             `use std::fmt::Result;`\n+             `use std::io::Result;`\n+             `use std::thread::Result;`\n \n error: aborting due to previous error\n "}, {"sha": "ea6841e600972e78c4f376da98d3b388f4cc56fb", "filename": "src/test/ui/resolve/issue-17518.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fissue-17518.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fissue-17518.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Fissue-17518.stderr?ref=2883186180161185e72b8fa183b75c8854eb5db4", "patch": "@@ -5,7 +5,7 @@ error[E0422]: cannot find struct, variant or union type `E` in this scope\n    |     ^ not found in this scope\n    |\n    = help: possible candidate is found in another module, you can import it into scope:\n-   = help:   `use SomeEnum::E;`\n+             `use SomeEnum::E;`\n \n error: aborting due to previous error\n "}, {"sha": "f38491d5362587200e7b7df5eca3ca0640604b79", "filename": "src/test/ui/resolve/issue-21221-1.stderr", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fissue-21221-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fissue-21221-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Fissue-21221-1.stderr?ref=2883186180161185e72b8fa183b75c8854eb5db4", "patch": "@@ -5,9 +5,9 @@ error[E0405]: cannot find trait `Mul` in this scope\n    |      ^^^ not found in this scope\n    |\n    = help: possible candidates are found in other modules, you can import them into scope:\n-   = help:   `use mul1::Mul;`\n-   = help:   `use mul2::Mul;`\n-   = help:   `use std::ops::Mul;`\n+             `use mul1::Mul;`\n+             `use mul2::Mul;`\n+             `use std::ops::Mul;`\n \n error[E0412]: cannot find type `Mul` in this scope\n   --> $DIR/issue-21221-1.rs:72:16\n@@ -16,11 +16,11 @@ error[E0412]: cannot find type `Mul` in this scope\n    |                ^^^ not found in this scope\n    |\n    = help: possible candidates are found in other modules, you can import them into scope:\n-   = help:   `use mul1::Mul;`\n-   = help:   `use mul2::Mul;`\n-   = help:   `use mul3::Mul;`\n-   = help:   `use mul4::Mul;`\n-   = help:   and 2 other candidates\n+             `use mul1::Mul;`\n+             `use mul2::Mul;`\n+             `use mul3::Mul;`\n+             `use mul4::Mul;`\n+           and 2 other candidates\n \n error[E0405]: cannot find trait `ThisTraitReallyDoesntExistInAnyModuleReally` in this scope\n   --> $DIR/issue-21221-1.rs:83:6\n@@ -35,7 +35,7 @@ error[E0405]: cannot find trait `Div` in this scope\n    |      ^^^ not found in this scope\n    |\n    = help: possible candidate is found in another module, you can import it into scope:\n-   = help:   `use std::ops::Div;`\n+             `use std::ops::Div;`\n \n error: cannot continue compilation due to previous error\n "}, {"sha": "14dac7de4b2e13af1aa4796bdcc75fa3830b189c", "filename": "src/test/ui/resolve/issue-21221-2.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fissue-21221-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fissue-21221-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Fissue-21221-2.stderr?ref=2883186180161185e72b8fa183b75c8854eb5db4", "patch": "@@ -5,7 +5,7 @@ error[E0405]: cannot find trait `T` in this scope\n    |      ^ not found in this scope\n    |\n    = help: possible candidate is found in another module, you can import it into scope:\n-   = help:   `use foo::bar::T;`\n+             `use foo::bar::T;`\n \n error: main function not found\n "}, {"sha": "e1e00571e5d4a1bb5d110828db316c98df5c828f", "filename": "src/test/ui/resolve/issue-21221-3.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fissue-21221-3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fissue-21221-3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Fissue-21221-3.stderr?ref=2883186180161185e72b8fa183b75c8854eb5db4", "patch": "@@ -5,7 +5,7 @@ error[E0405]: cannot find trait `OuterTrait` in this scope\n    |      ^^^^^^^^^^ not found in this scope\n    |\n    = help: possible candidate is found in another module, you can import it into scope:\n-   = help:   `use issue_21221_3::outer::OuterTrait;`\n+             `use issue_21221_3::outer::OuterTrait;`\n \n error: cannot continue compilation due to previous error\n "}, {"sha": "569315a59cf34c8d9d1a8e89f3840bd633f5d307", "filename": "src/test/ui/resolve/issue-21221-4.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fissue-21221-4.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fissue-21221-4.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Fissue-21221-4.stderr?ref=2883186180161185e72b8fa183b75c8854eb5db4", "patch": "@@ -5,7 +5,7 @@ error[E0405]: cannot find trait `T` in this scope\n    |      ^ not found in this scope\n    |\n    = help: possible candidate is found in another module, you can import it into scope:\n-   = help:   `use issue_21221_4::T;`\n+             `use issue_21221_4::T;`\n \n error: cannot continue compilation due to previous error\n "}, {"sha": "a7dd494d75b0df694304d8f1b2f3279e588a7f58", "filename": "src/test/ui/resolve/issue-3907.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fissue-3907.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fresolve%2Fissue-3907.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Fissue-3907.stderr?ref=2883186180161185e72b8fa183b75c8854eb5db4", "patch": "@@ -5,7 +5,7 @@ error[E0404]: expected trait, found type alias `Foo`\n    |      ^^^ type aliases cannot be used for traits\n    |\n    = help: possible better candidate is found in another module, you can import it into scope:\n-   = help:   `use issue_3907::Foo;`\n+             `use issue_3907::Foo;`\n \n error: cannot continue compilation due to previous error\n "}, {"sha": "9dab2f77898153eea02c08e92d5ca9bc2089b71a", "filename": "src/test/ui/span/issue-35987.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fspan%2Fissue-35987.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2883186180161185e72b8fa183b75c8854eb5db4/src%2Ftest%2Fui%2Fspan%2Fissue-35987.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2Fissue-35987.stderr?ref=2883186180161185e72b8fa183b75c8854eb5db4", "patch": "@@ -5,7 +5,7 @@ error[E0404]: expected trait, found type parameter `Add`\n    |                     ^^^ not a trait\n    |\n    = help: possible better candidate is found in another module, you can import it into scope:\n-   = help:   `use std::ops::Add;`\n+             `use std::ops::Add;`\n \n error: main function not found\n "}]}