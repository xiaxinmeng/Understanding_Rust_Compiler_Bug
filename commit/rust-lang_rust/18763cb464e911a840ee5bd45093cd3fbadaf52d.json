{"sha": "18763cb464e911a840ee5bd45093cd3fbadaf52d", "node_id": "C_kwDOAAsO6NoAKDE4NzYzY2I0NjRlOTExYTg0MGVlNWJkNDUwOTNjZDNmYmFkYWY1MmQ", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2023-06-02T23:02:07Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-06-02T23:02:07Z"}, "message": "Rollup merge of #112223 - compiler-errors:new-solver-auto-proj, r=BoxyUwU\n\nDon't ICE in new solver when auto traits have associated types\n\nPeople can write malformed auto traits, and that shouldn't cause the new solver to ICE", "tree": {"sha": "9e318c68a45ffbb209396b34288b23bfb9cceddb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9e318c68a45ffbb209396b34288b23bfb9cceddb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/18763cb464e911a840ee5bd45093cd3fbadaf52d", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkenTvCRBK7hj4Ov3rIwAABioIAAFa1MMwdxtuQDMyRzhVSGYq\niEwSL/XIRCSI6PbXdMC5Nv5cyNXZ9XqB/zk17ejHik+aHMtRcjTdCzugEOP1P5Jy\n+S+IOBblB90GIw4BwpEB3+NR35eEvmV0VwxiiMLCmNeU8E/QbHIeHHA69+F3GiCh\ncOprXgYndOaZA9JSNEgljyh0yVZJJmM4Bh8TA4R0Bxcp8UM2X4oOkWOnuYTE1SXM\nmngEINan8E8mXxUYehqIAw55HKzVe9EfSkMk1N2prdT6ugUbyhQqygtnOWkl456A\nB5EXTRrk/1Hvn/naoBSguKVXs9Qgn3dTLvJ+7yxCRh9SFGmooy8BU0NvuVmrW/s=\n=R8yD\n-----END PGP SIGNATURE-----\n", "payload": "tree 9e318c68a45ffbb209396b34288b23bfb9cceddb\nparent 163ce686bedd1f8ca86a6066d26ed480e65c5e2e\nparent ecd7809784ddb1e96c9f292347d73d074106e4e9\nauthor Michael Goulet <michael@errs.io> 1685746927 -0700\ncommitter GitHub <noreply@github.com> 1685746927 -0700\n\nRollup merge of #112223 - compiler-errors:new-solver-auto-proj, r=BoxyUwU\n\nDon't ICE in new solver when auto traits have associated types\n\nPeople can write malformed auto traits, and that shouldn't cause the new solver to ICE\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/18763cb464e911a840ee5bd45093cd3fbadaf52d", "html_url": "https://github.com/rust-lang/rust/commit/18763cb464e911a840ee5bd45093cd3fbadaf52d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/18763cb464e911a840ee5bd45093cd3fbadaf52d/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "163ce686bedd1f8ca86a6066d26ed480e65c5e2e", "url": "https://api.github.com/repos/rust-lang/rust/commits/163ce686bedd1f8ca86a6066d26ed480e65c5e2e", "html_url": "https://github.com/rust-lang/rust/commit/163ce686bedd1f8ca86a6066d26ed480e65c5e2e"}, {"sha": "ecd7809784ddb1e96c9f292347d73d074106e4e9", "url": "https://api.github.com/repos/rust-lang/rust/commits/ecd7809784ddb1e96c9f292347d73d074106e4e9", "html_url": "https://github.com/rust-lang/rust/commit/ecd7809784ddb1e96c9f292347d73d074106e4e9"}], "stats": {"total": 24, "additions": 21, "deletions": 3}, "files": [{"sha": "242f9ba87473fb6768fc38b21753c803cb0be69c", "filename": "compiler/rustc_trait_selection/src/solve/project_goals.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/18763cb464e911a840ee5bd45093cd3fbadaf52d/compiler%2Frustc_trait_selection%2Fsrc%2Fsolve%2Fproject_goals.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18763cb464e911a840ee5bd45093cd3fbadaf52d/compiler%2Frustc_trait_selection%2Fsrc%2Fsolve%2Fproject_goals.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Fsolve%2Fproject_goals.rs?ref=18763cb464e911a840ee5bd45093cd3fbadaf52d", "patch": "@@ -226,10 +226,14 @@ impl<'tcx> assembly::GoalKind<'tcx> for ProjectionPredicate<'tcx> {\n     }\n \n     fn consider_auto_trait_candidate(\n-        _ecx: &mut EvalCtxt<'_, 'tcx>,\n+        ecx: &mut EvalCtxt<'_, 'tcx>,\n         goal: Goal<'tcx, Self>,\n     ) -> QueryResult<'tcx> {\n-        bug!(\"auto traits do not have associated types: {:?}\", goal);\n+        ecx.tcx().sess.delay_span_bug(\n+            ecx.tcx().def_span(goal.predicate.def_id()),\n+            \"associated types not allowed on auto traits\",\n+        );\n+        Err(NoSolution)\n     }\n \n     fn consider_trait_alias_candidate("}, {"sha": "a57c6d9b0cbf9c631760bff757a330d5099e9a7c", "filename": "tests/ui/auto-traits/issue-23080-2.current.stderr", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/18763cb464e911a840ee5bd45093cd3fbadaf52d/tests%2Fui%2Fauto-traits%2Fissue-23080-2.current.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/18763cb464e911a840ee5bd45093cd3fbadaf52d/tests%2Fui%2Fauto-traits%2Fissue-23080-2.current.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fauto-traits%2Fissue-23080-2.current.stderr?ref=18763cb464e911a840ee5bd45093cd3fbadaf52d", "patch": "@@ -1,5 +1,5 @@\n error[E0380]: auto traits cannot have associated items\n-  --> $DIR/issue-23080-2.rs:5:10\n+  --> $DIR/issue-23080-2.rs:8:10\n    |\n LL | unsafe auto trait Trait {\n    |                   ----- auto traits cannot have associated items", "previous_filename": "tests/ui/auto-traits/issue-23080-2.stderr"}, {"sha": "a57c6d9b0cbf9c631760bff757a330d5099e9a7c", "filename": "tests/ui/auto-traits/issue-23080-2.next.stderr", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/18763cb464e911a840ee5bd45093cd3fbadaf52d/tests%2Fui%2Fauto-traits%2Fissue-23080-2.next.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/18763cb464e911a840ee5bd45093cd3fbadaf52d/tests%2Fui%2Fauto-traits%2Fissue-23080-2.next.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fauto-traits%2Fissue-23080-2.next.stderr?ref=18763cb464e911a840ee5bd45093cd3fbadaf52d", "patch": "@@ -0,0 +1,11 @@\n+error[E0380]: auto traits cannot have associated items\n+  --> $DIR/issue-23080-2.rs:8:10\n+   |\n+LL | unsafe auto trait Trait {\n+   |                   ----- auto traits cannot have associated items\n+LL |     type Output;\n+   |     -----^^^^^^- help: remove these associated items\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0380`."}, {"sha": "882b8f3938428e2e7313d94e77c4bdcdf5a604d4", "filename": "tests/ui/auto-traits/issue-23080-2.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/18763cb464e911a840ee5bd45093cd3fbadaf52d/tests%2Fui%2Fauto-traits%2Fissue-23080-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18763cb464e911a840ee5bd45093cd3fbadaf52d/tests%2Fui%2Fauto-traits%2Fissue-23080-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fauto-traits%2Fissue-23080-2.rs?ref=18763cb464e911a840ee5bd45093cd3fbadaf52d", "patch": "@@ -1,3 +1,6 @@\n+// revisions: current next\n+//[next] compile-flags: -Ztrait-solver=next\n+\n #![feature(auto_traits)]\n #![feature(negative_impls)]\n "}]}