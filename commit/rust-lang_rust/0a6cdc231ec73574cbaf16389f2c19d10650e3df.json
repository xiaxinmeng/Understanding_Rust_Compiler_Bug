{"sha": "0a6cdc231ec73574cbaf16389f2c19d10650e3df", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBhNmNkYzIzMWVjNzM1NzRjYmFmMTYzODlmMmMxOWQxMDY1MGUzZGY=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2020-01-07T23:42:53Z"}, "committer": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2020-01-07T23:42:53Z"}, "message": "slice patterns: harden match-based borrowck tests", "tree": {"sha": "07ee0078e8ee832ac3d35dc5e52b657f3f7570b6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/07ee0078e8ee832ac3d35dc5e52b657f3f7570b6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0a6cdc231ec73574cbaf16389f2c19d10650e3df", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0a6cdc231ec73574cbaf16389f2c19d10650e3df", "html_url": "https://github.com/rust-lang/rust/commit/0a6cdc231ec73574cbaf16389f2c19d10650e3df", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0a6cdc231ec73574cbaf16389f2c19d10650e3df/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "85976442558bf2d09cec3aa49c9c9ba86fb15c1f", "url": "https://api.github.com/repos/rust-lang/rust/commits/85976442558bf2d09cec3aa49c9c9ba86fb15c1f", "html_url": "https://github.com/rust-lang/rust/commit/85976442558bf2d09cec3aa49c9c9ba86fb15c1f"}], "stats": {"total": 978, "additions": 978, "deletions": 0}, "files": [{"sha": "232d43679b4840c4b616d66b9db780b00e906f01", "filename": "src/test/ui/borrowck/borrowck-move-out-from-array-match.rs", "status": "added", "additions": 118, "deletions": 0, "changes": 118, "blob_url": "https://github.com/rust-lang/rust/blob/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-match.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-match.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-match.rs?ref=0a6cdc231ec73574cbaf16389f2c19d10650e3df", "patch": "@@ -0,0 +1,118 @@\n+#![feature(slice_patterns)]\n+\n+fn array() -> [(String, String); 3] {\n+    Default::default()\n+}\n+\n+// Const Index + Const Index\n+\n+fn move_out_from_begin_and_end() {\n+    let a = array();\n+    match a {\n+        [_, _, _x] => {}\n+    }\n+    match a {\n+        [.., _y] => {} //~ ERROR use of moved value\n+    }\n+}\n+\n+fn move_out_from_begin_field_and_end() {\n+    let a = array();\n+    match a {\n+        [_, _, (_x, _)] => {}\n+    }\n+    match a {\n+        [.., _y] => {} //~ ERROR use of moved value\n+    }\n+}\n+\n+fn move_out_from_begin_field_and_end_field() {\n+    let a = array();\n+    match a {\n+        [_, _, (_x, _)] => {}\n+    }\n+    match a {\n+        [.., (_y, _)] => {} //~ ERROR use of moved value\n+    }\n+}\n+\n+// Const Index + Slice\n+\n+fn move_out_by_const_index_and_subslice() {\n+    let a = array();\n+    match a {\n+        [_x, _, _] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [_y @ .., _, _] => {}\n+    }\n+}\n+\n+fn move_out_by_const_index_end_and_subslice() {\n+    let a = array();\n+    match a {\n+        [.., _x] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [_, _, _y @ ..] => {}\n+    }\n+}\n+\n+fn move_out_by_const_index_field_and_subslice() {\n+    let a = array();\n+    match a {\n+        [(_x, _), _, _] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [_y @ .., _, _] => {}\n+    }\n+}\n+\n+fn move_out_by_const_index_end_field_and_subslice() {\n+    let a = array();\n+    match a {\n+        [.., (_x, _)] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [_, _, _y @ ..] => {}\n+    }\n+}\n+\n+fn move_out_by_subslice_and_const_index_field() {\n+    let a = array();\n+    match a {\n+        [_y @ .., _, _] => {}\n+    }\n+    match a {\n+        [(_x, _), _, _] => {} //~ ERROR use of moved value\n+    }\n+}\n+\n+fn move_out_by_subslice_and_const_index_end_field() {\n+    let a = array();\n+    match a {\n+        [_, _, _y @ ..] => {}\n+    }\n+    match a {\n+        [.., (_x, _)] => {} //~ ERROR use of moved value\n+    }\n+}\n+\n+// Slice + Slice\n+\n+fn move_out_by_subslice_and_subslice() {\n+    let a = array();\n+    match a {\n+        [x @ .., _] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [_, _y @ ..] => {}\n+    }\n+}\n+\n+fn main() {}"}, {"sha": "e46a58a8a35007d358b703cb5b891e481bf105e6", "filename": "src/test/ui/borrowck/borrowck-move-out-from-array-match.stderr", "status": "added", "additions": 113, "deletions": 0, "changes": 113, "blob_url": "https://github.com/rust-lang/rust/blob/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-match.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-match.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-match.stderr?ref=0a6cdc231ec73574cbaf16389f2c19d10650e3df", "patch": "@@ -0,0 +1,113 @@\n+error[E0382]: use of moved value: `a[..]`\n+  --> $DIR/borrowck-move-out-from-array-match.rs:15:14\n+   |\n+LL |         [_, _, _x] => {}\n+   |                -- value moved here\n+...\n+LL |         [.., _y] => {}\n+   |              ^^ value used here after move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a[..]`\n+  --> $DIR/borrowck-move-out-from-array-match.rs:25:14\n+   |\n+LL |         [_, _, (_x, _)] => {}\n+   |                 -- value moved here\n+...\n+LL |         [.., _y] => {}\n+   |              ^^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..].0` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a[..].0`\n+  --> $DIR/borrowck-move-out-from-array-match.rs:35:15\n+   |\n+LL |         [_, _, (_x, _)] => {}\n+   |                 -- value moved here\n+...\n+LL |         [.., (_y, _)] => {}\n+   |               ^^ value used here after move\n+   |\n+   = note: move occurs because `a[..].0` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-match.rs:46:11\n+   |\n+LL |         [_x, _, _] => {}\n+   |          -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-match.rs:57:11\n+   |\n+LL |         [.., _x] => {}\n+   |              -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-match.rs:68:11\n+   |\n+LL |         [(_x, _), _, _] => {}\n+   |           -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..].0` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-match.rs:79:11\n+   |\n+LL |         [.., (_x, _)] => {}\n+   |               -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..].0` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a[..].0`\n+  --> $DIR/borrowck-move-out-from-array-match.rs:91:11\n+   |\n+LL |         [_y @ .., _, _] => {}\n+   |          ------- value moved here\n+...\n+LL |         [(_x, _), _, _] => {}\n+   |           ^^ value used here after move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a[..].0`\n+  --> $DIR/borrowck-move-out-from-array-match.rs:101:15\n+   |\n+LL |         [_, _, _y @ ..] => {}\n+   |                ------- value moved here\n+...\n+LL |         [.., (_x, _)] => {}\n+   |               ^^ value used here after move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-match.rs:112:11\n+   |\n+LL |         [x @ .., _] => {}\n+   |          ------ value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error: aborting due to 10 previous errors\n+\n+For more information about this error, try `rustc --explain E0382`."}, {"sha": "e5e61697c68c6070145b50bc52569444710d4ae7", "filename": "src/test/ui/borrowck/borrowck-move-out-from-array-no-overlap-match.rs", "status": "added", "additions": 117, "deletions": 0, "changes": 117, "blob_url": "https://github.com/rust-lang/rust/blob/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-no-overlap-match.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-no-overlap-match.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-no-overlap-match.rs?ref=0a6cdc231ec73574cbaf16389f2c19d10650e3df", "patch": "@@ -0,0 +1,117 @@\n+// Due to #53114, which causes a \"read\" of the `_` patterns,\n+// the borrow-checker refuses this code, while it should probably be allowed.\n+// Once the bug is fixed, the test, which is derived from a\n+// passing test for `let` statements, should become check-pass.\n+\n+#![feature(slice_patterns)]\n+\n+fn array() -> [(String, String); 3] {\n+    Default::default()\n+}\n+\n+// Const Index + Const Index\n+\n+fn move_out_from_begin_and_one_from_end() {\n+    let a = array();\n+    match a {\n+        [_, _, _x] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [.., _y, _] => {}\n+    }\n+}\n+\n+fn move_out_from_begin_field_and_end_field() {\n+    let a = array();\n+    match a {\n+        [_, _, (_x, _)] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [.., (_, _y)] => {}\n+    }\n+}\n+\n+// Const Index + Slice\n+\n+fn move_out_by_const_index_and_subslice() {\n+    let a = array();\n+    match a {\n+        [_x, _, _] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [_, _y @ ..] => {}\n+    }\n+}\n+\n+fn move_out_by_const_index_end_and_subslice() {\n+    let a = array();\n+    match a {\n+        [.., _x] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [_y @ .., _] => {}\n+    }\n+}\n+\n+fn move_out_by_const_index_field_and_subslice() {\n+    let a = array();\n+    match a {\n+        [(_x, _), _, _] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [_, _y @ ..] => {}\n+    }\n+}\n+\n+fn move_out_by_const_index_end_field_and_subslice() {\n+    let a = array();\n+    match a {\n+        [.., (_x, _)] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [_y @ .., _] => {}\n+    }\n+}\n+\n+fn move_out_by_const_subslice_and_index_field() {\n+    let a = array();\n+    match a {\n+        [_, _y @ ..] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [(_x, _), _, _] => {}\n+    }\n+}\n+\n+fn move_out_by_const_subslice_and_end_index_field() {\n+    let a = array();\n+    match a {\n+        [_y @ .., _] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [.., (_x, _)] => {}\n+    }\n+}\n+\n+// Slice + Slice\n+\n+fn move_out_by_subslice_and_subslice() {\n+    let a = array();\n+    match a {\n+        [x @ .., _, _] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [_, _y @ ..] => {}\n+    }\n+}\n+\n+fn main() {}"}, {"sha": "72cd4207cce65e6986b171720cb1f9795f9bd4bf", "filename": "src/test/ui/borrowck/borrowck-move-out-from-array-no-overlap-match.stderr", "status": "added", "additions": 102, "deletions": 0, "changes": 102, "blob_url": "https://github.com/rust-lang/rust/blob/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-no-overlap-match.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-no-overlap-match.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-no-overlap-match.stderr?ref=0a6cdc231ec73574cbaf16389f2c19d10650e3df", "patch": "@@ -0,0 +1,102 @@\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-no-overlap-match.rs:19:11\n+   |\n+LL |         [_, _, _x] => {}\n+   |                -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-no-overlap-match.rs:30:11\n+   |\n+LL |         [_, _, (_x, _)] => {}\n+   |                 -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..].0` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-no-overlap-match.rs:43:11\n+   |\n+LL |         [_x, _, _] => {}\n+   |          -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-no-overlap-match.rs:54:11\n+   |\n+LL |         [.., _x] => {}\n+   |              -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-no-overlap-match.rs:65:11\n+   |\n+LL |         [(_x, _), _, _] => {}\n+   |           -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..].0` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-no-overlap-match.rs:76:11\n+   |\n+LL |         [.., (_x, _)] => {}\n+   |               -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..].0` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-no-overlap-match.rs:87:11\n+   |\n+LL |         [_, _y @ ..] => {}\n+   |             ------- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-no-overlap-match.rs:98:11\n+   |\n+LL |         [_y @ .., _] => {}\n+   |          ------- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-no-overlap-match.rs:111:11\n+   |\n+LL |         [x @ .., _, _] => {}\n+   |          ------ value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error: aborting due to 9 previous errors\n+\n+For more information about this error, try `rustc --explain E0382`."}, {"sha": "1ca3df52ada91c5800a97d071277d84322a62c8e", "filename": "src/test/ui/borrowck/borrowck-move-out-from-array-use-match.rs", "status": "added", "additions": 152, "deletions": 0, "changes": 152, "blob_url": "https://github.com/rust-lang/rust/blob/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-use-match.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-use-match.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-use-match.rs?ref=0a6cdc231ec73574cbaf16389f2c19d10650e3df", "patch": "@@ -0,0 +1,152 @@\n+#![feature(slice_patterns)]\n+\n+fn array() -> [(String, String); 3] {\n+    Default::default()\n+}\n+\n+// Const Index + Const Index\n+\n+fn move_out_from_begin_and_end() {\n+    let a = array();\n+    match a {\n+        [_, _, _x] => {}\n+    }\n+    match a {\n+        [.., ref _y] => {} //~ ERROR [E0382]\n+    }\n+}\n+\n+fn move_out_from_begin_field_and_end() {\n+    let a = array();\n+    match a {\n+        [_, _, (_x, _)] => {}\n+    }\n+    match a {\n+        [.., ref _y] => {} //~ ERROR [E0382]\n+    }\n+}\n+\n+fn move_out_from_begin_field_and_end_field() {\n+    let a = array();\n+    match a {\n+        [_, _, (_x, _)] => {}\n+    }\n+    match a {\n+        [.., (ref _y, _)] => {} //~ ERROR [E0382]\n+    }\n+}\n+\n+// Const Index + Slice\n+\n+fn move_out_by_const_index_and_subslice() {\n+    let a = array();\n+    match a {\n+        [_x, _, _] => {}\n+    }\n+    match a {\n+        //~^ ERROR [E0382]\n+        [ref _y @ .., _, _] => {}\n+    }\n+}\n+\n+fn move_out_by_const_index_end_and_subslice() {\n+    let a = array();\n+    match a {\n+        [.., _x] => {}\n+    }\n+    match a {\n+        //~^ ERROR [E0382]\n+        [_, _, ref _y @ ..] => {}\n+    }\n+}\n+\n+fn move_out_by_const_index_field_and_subslice() {\n+    let a = array();\n+    match a {\n+        [(_x, _), _, _] => {}\n+    }\n+    match a {\n+        //~^ ERROR [E0382]\n+        [ref _y @ .., _, _] => {}\n+    }\n+}\n+\n+fn move_out_by_const_index_end_field_and_subslice() {\n+    let a = array();\n+    match a {\n+        [.., (_x, _)] => {}\n+    }\n+    match a {\n+        //~^ ERROR [E0382]\n+        [_, _, ref _y @ ..] => {}\n+    }\n+}\n+\n+fn move_out_by_subslice_and_const_index_field() {\n+    let a = array();\n+    match a {\n+        [_y @ .., _, _] => {}\n+    }\n+    match a {\n+        [(ref _x, _), _, _] => {} //~ ERROR [E0382]\n+    }\n+}\n+\n+fn move_out_by_subslice_and_const_index_end_field() {\n+    let a = array();\n+    match a {\n+        [_, _, _y @ ..] => {}\n+    }\n+    match a {\n+        [.., (ref _x, _)] => {} //~ ERROR [E0382]\n+    }\n+}\n+\n+// Slice + Slice\n+\n+fn move_out_by_subslice_and_subslice() {\n+    let a = array();\n+    match a {\n+        [x @ .., _] => {}\n+    }\n+    match a {\n+        //~^ ERROR [E0382]\n+        [_, ref _y @ ..] => {}\n+    }\n+}\n+\n+// Move + Assign\n+\n+fn move_out_and_assign_end() {\n+    let mut a = array();\n+    match a {\n+        [_, _, _x] => {}\n+    }\n+    a[2] = Default::default(); //~ ERROR [E0382]\n+}\n+\n+fn move_out_and_assign_end_field() {\n+    let mut a = array();\n+    match a {\n+        [_, _, (_x, _)] => {}\n+    }\n+    a[2].1 = Default::default(); //~ ERROR [E0382]\n+}\n+\n+fn move_out_slice_and_assign_end() {\n+    let mut a = array();\n+    match a {\n+        [_, _, _x @ ..] => {}\n+    }\n+    a[0] = Default::default(); //~ ERROR [E0382]\n+}\n+\n+fn move_out_slice_and_assign_end_field() {\n+    let mut a = array();\n+    match a {\n+        [_, _, _x @ ..] => {}\n+    }\n+    a[0].1 = Default::default(); //~ ERROR [E0382]\n+}\n+\n+fn main() {}"}, {"sha": "028442a4c07ea227ed50a963cd29668b7c4589fa", "filename": "src/test/ui/borrowck/borrowck-move-out-from-array-use-match.stderr", "status": "added", "additions": 157, "deletions": 0, "changes": 157, "blob_url": "https://github.com/rust-lang/rust/blob/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-use-match.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-use-match.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-use-match.stderr?ref=0a6cdc231ec73574cbaf16389f2c19d10650e3df", "patch": "@@ -0,0 +1,157 @@\n+error[E0382]: borrow of moved value: `a[..]`\n+  --> $DIR/borrowck-move-out-from-array-use-match.rs:15:14\n+   |\n+LL |         [_, _, _x] => {}\n+   |                -- value moved here\n+...\n+LL |         [.., ref _y] => {}\n+   |              ^^^^^^ value borrowed here after move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: borrow of moved value: `a[..]`\n+  --> $DIR/borrowck-move-out-from-array-use-match.rs:25:14\n+   |\n+LL |         [_, _, (_x, _)] => {}\n+   |                 -- value moved here\n+...\n+LL |         [.., ref _y] => {}\n+   |              ^^^^^^ value borrowed here after partial move\n+   |\n+   = note: move occurs because `a[..].0` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0382]: borrow of moved value: `a[..].0`\n+  --> $DIR/borrowck-move-out-from-array-use-match.rs:35:15\n+   |\n+LL |         [_, _, (_x, _)] => {}\n+   |                 -- value moved here\n+...\n+LL |         [.., (ref _y, _)] => {}\n+   |               ^^^^^^ value borrowed here after move\n+   |\n+   = note: move occurs because `a[..].0` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-match.rs:46:11\n+   |\n+LL |         [_x, _, _] => {}\n+   |          -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-match.rs:57:11\n+   |\n+LL |         [.., _x] => {}\n+   |              -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-match.rs:68:11\n+   |\n+LL |         [(_x, _), _, _] => {}\n+   |           -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..].0` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-match.rs:79:11\n+   |\n+LL |         [.., (_x, _)] => {}\n+   |               -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..].0` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0382]: borrow of moved value: `a[..]`\n+  --> $DIR/borrowck-move-out-from-array-use-match.rs:91:11\n+   |\n+LL |         [_y @ .., _, _] => {}\n+   |          ------- value moved here\n+...\n+LL |         [(ref _x, _), _, _] => {}\n+   |           ^^^^^^ value borrowed here after move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: borrow of moved value: `a[..]`\n+  --> $DIR/borrowck-move-out-from-array-use-match.rs:101:15\n+   |\n+LL |         [_, _, _y @ ..] => {}\n+   |                ------- value moved here\n+...\n+LL |         [.., (ref _x, _)] => {}\n+   |               ^^^^^^ value borrowed here after move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-match.rs:112:11\n+   |\n+LL |         [x @ .., _] => {}\n+   |          ------ value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-match.rs:125:5\n+   |\n+LL |         [_, _, _x] => {}\n+   |                -- value moved here\n+LL |     }\n+LL |     a[2] = Default::default();\n+   |     ^^^^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-match.rs:133:5\n+   |\n+LL |         [_, _, (_x, _)] => {}\n+   |                 -- value moved here\n+LL |     }\n+LL |     a[2].1 = Default::default();\n+   |     ^^^^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..].0` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-match.rs:141:5\n+   |\n+LL |         [_, _, _x @ ..] => {}\n+   |                ------- value moved here\n+LL |     }\n+LL |     a[0] = Default::default();\n+   |     ^^^^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-match.rs:149:5\n+   |\n+LL |         [_, _, _x @ ..] => {}\n+   |                ------- value moved here\n+LL |     }\n+LL |     a[0].1 = Default::default();\n+   |     ^^^^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error: aborting due to 14 previous errors\n+\n+For more information about this error, try `rustc --explain E0382`."}, {"sha": "79fe593009652e920c5721fd9478c953e897456a", "filename": "src/test/ui/borrowck/borrowck-move-out-from-array-use-no-overlap-match.rs", "status": "added", "additions": 117, "deletions": 0, "changes": 117, "blob_url": "https://github.com/rust-lang/rust/blob/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-use-no-overlap-match.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-use-no-overlap-match.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-use-no-overlap-match.rs?ref=0a6cdc231ec73574cbaf16389f2c19d10650e3df", "patch": "@@ -0,0 +1,117 @@\n+// Due to #53114, which causes a \"read\" of the `_` patterns,\n+// the borrow-checker refuses this code, while it should probably be allowed.\n+// Once the bug is fixed, the test, which is derived from a\n+// passing test for `let` statements, should become check-pass.\n+\n+#![feature(slice_patterns)]\n+\n+fn array() -> [(String, String); 3] {\n+    Default::default()\n+}\n+\n+// Const Index + Const Index\n+\n+fn move_out_from_begin_and_one_from_end() {\n+    let a = array();\n+    match a {\n+        [_, _, _x] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [.., ref _y, _] => {}\n+    }\n+}\n+\n+fn move_out_from_begin_field_and_end_field() {\n+    let a = array();\n+    match a {\n+        [_, _, (_x, _)] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [.., (_, ref _y)] => {}\n+    }\n+}\n+\n+// Const Index + Slice\n+\n+fn move_out_by_const_index_and_subslice() {\n+    let a = array();\n+    match a {\n+        [_x, _, _] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [_, ref _y @ ..] => {}\n+    }\n+}\n+\n+fn move_out_by_const_index_end_and_subslice() {\n+    let a = array();\n+    match a {\n+        [.., _x] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [ref _y @ .., _] => {}\n+    }\n+}\n+\n+fn move_out_by_const_index_field_and_subslice() {\n+    let a = array();\n+    match a {\n+        [(_x, _), _, _] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [_, ref _y @ ..] => {}\n+    }\n+}\n+\n+fn move_out_by_const_index_end_field_and_subslice() {\n+    let a = array();\n+    match a {\n+        [.., (_x, _)] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [ref _y @ .., _] => {}\n+    }\n+}\n+\n+fn move_out_by_const_subslice_and_index_field() {\n+    let a = array();\n+    match a {\n+        [_, _y @ ..] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [(ref _x, _), _, _] => {}\n+    }\n+}\n+\n+fn move_out_by_const_subslice_and_end_index_field() {\n+    let a = array();\n+    match a {\n+        [_y @ .., _] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [.., (ref _x, _)] => {}\n+    }\n+}\n+\n+// Slice + Slice\n+\n+fn move_out_by_subslice_and_subslice() {\n+    let a = array();\n+    match a {\n+        [x @ .., _, _] => {}\n+    }\n+    match a {\n+        //~^ ERROR use of moved value\n+        [_, ref _y @ ..] => {}\n+    }\n+}\n+\n+fn main() {}"}, {"sha": "43ba2b664a1e1c7e82a4090e61cc03ed8806b473", "filename": "src/test/ui/borrowck/borrowck-move-out-from-array-use-no-overlap-match.stderr", "status": "added", "additions": 102, "deletions": 0, "changes": 102, "blob_url": "https://github.com/rust-lang/rust/blob/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-use-no-overlap-match.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0a6cdc231ec73574cbaf16389f2c19d10650e3df/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-use-no-overlap-match.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-move-out-from-array-use-no-overlap-match.stderr?ref=0a6cdc231ec73574cbaf16389f2c19d10650e3df", "patch": "@@ -0,0 +1,102 @@\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-no-overlap-match.rs:19:11\n+   |\n+LL |         [_, _, _x] => {}\n+   |                -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-no-overlap-match.rs:30:11\n+   |\n+LL |         [_, _, (_x, _)] => {}\n+   |                 -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..].0` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-no-overlap-match.rs:43:11\n+   |\n+LL |         [_x, _, _] => {}\n+   |          -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-no-overlap-match.rs:54:11\n+   |\n+LL |         [.., _x] => {}\n+   |              -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-no-overlap-match.rs:65:11\n+   |\n+LL |         [(_x, _), _, _] => {}\n+   |           -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..].0` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-no-overlap-match.rs:76:11\n+   |\n+LL |         [.., (_x, _)] => {}\n+   |               -- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..].0` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-no-overlap-match.rs:87:11\n+   |\n+LL |         [_, _y @ ..] => {}\n+   |             ------- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-no-overlap-match.rs:98:11\n+   |\n+LL |         [_y @ .., _] => {}\n+   |          ------- value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error[E0382]: use of moved value: `a`\n+  --> $DIR/borrowck-move-out-from-array-use-no-overlap-match.rs:111:11\n+   |\n+LL |         [x @ .., _, _] => {}\n+   |          ------ value moved here\n+LL |     }\n+LL |     match a {\n+   |           ^ value used here after partial move\n+   |\n+   = note: move occurs because `a[..]` has type `(std::string::String, std::string::String)`, which does not implement the `Copy` trait\n+\n+error: aborting due to 9 previous errors\n+\n+For more information about this error, try `rustc --explain E0382`."}]}