{"sha": "0222498610ebb192b4684637c9532b464716b2f9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAyMjI0OTg2MTBlYmIxOTJiNDY4NDYzN2M5NTMyYjQ2NDcxNmIyZjk=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-07-26T16:57:06Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-07-26T16:57:06Z"}, "message": "Rollup merge of #63007 - pietroalbini:debug-awscli-install, r=Mark-Simulacrum\n\nci: debug network failures while downloading awscli from PyPI\n\nThis adds some random debug code to our CI script while downloading awscli, to *hopefully* pinpoint what's causing the network failures.\n\nr? @Mark-Simulacrum\ncc #62967", "tree": {"sha": "3adbf9bcd1b4c3c03a5e4947658a8c9b1664c6c3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3adbf9bcd1b4c3c03a5e4947658a8c9b1664c6c3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0222498610ebb192b4684637c9532b464716b2f9", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdOzDiCRBK7hj4Ov3rIwAAdHIIAK2zyngoQiYtdjT57asVzW4o\niT+NBi5EN+aNnObqeEpy28hPk2NOHUHMPo59geE8RmcA51zxJZ3NZSEvKBWSVHyT\nECZuxbja/+HLdm1Jw4/3IfB6Sh8YFsFoWCENzoZHFLtLpq0DD8fgnKVtCvxUzb0N\n7cR36yRfe4xaRb9t1oIGyEX+f2LIRhm7U8QB2zvjD0Wy4UAnFAXBMjljKLRBvXei\n9JF8bklAhVdo9Ubw+Q4YUucJdDeLdJfQ9H2T+QtU1zvOW2OB7CpOjIYejN4adRV5\n9NP7yxwYEuw9En6frb7XPBJRmMG8d4biauiVw9zpqvb39dXToWIGou2+IIubomA=\n=WDK/\n-----END PGP SIGNATURE-----\n", "payload": "tree 3adbf9bcd1b4c3c03a5e4947658a8c9b1664c6c3\nparent 3a1ee9b70d72ac20b095a86696e46ee65d4eaa8d\nparent fb9f3e6dec8b1b6296c10abcbfdf59ce957bce09\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1564160226 +0200\ncommitter GitHub <noreply@github.com> 1564160226 +0200\n\nRollup merge of #63007 - pietroalbini:debug-awscli-install, r=Mark-Simulacrum\n\nci: debug network failures while downloading awscli from PyPI\n\nThis adds some random debug code to our CI script while downloading awscli, to *hopefully* pinpoint what's causing the network failures.\n\nr? @Mark-Simulacrum\ncc #62967\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0222498610ebb192b4684637c9532b464716b2f9", "html_url": "https://github.com/rust-lang/rust/commit/0222498610ebb192b4684637c9532b464716b2f9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0222498610ebb192b4684637c9532b464716b2f9/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3a1ee9b70d72ac20b095a86696e46ee65d4eaa8d", "url": "https://api.github.com/repos/rust-lang/rust/commits/3a1ee9b70d72ac20b095a86696e46ee65d4eaa8d", "html_url": "https://github.com/rust-lang/rust/commit/3a1ee9b70d72ac20b095a86696e46ee65d4eaa8d"}, {"sha": "fb9f3e6dec8b1b6296c10abcbfdf59ce957bce09", "url": "https://api.github.com/repos/rust-lang/rust/commits/fb9f3e6dec8b1b6296c10abcbfdf59ce957bce09", "html_url": "https://github.com/rust-lang/rust/commit/fb9f3e6dec8b1b6296c10abcbfdf59ce957bce09"}], "stats": {"total": 28, "additions": 27, "deletions": 1}, "files": [{"sha": "015fd8348855038e5c3aa79c3cd7a25c56414a56", "filename": ".azure-pipelines/steps/run.yml", "status": "modified", "additions": 27, "deletions": 1, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/0222498610ebb192b4684637c9532b464716b2f9/.azure-pipelines%2Fsteps%2Frun.yml", "raw_url": "https://github.com/rust-lang/rust/raw/0222498610ebb192b4684637c9532b464716b2f9/.azure-pipelines%2Fsteps%2Frun.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.azure-pipelines%2Fsteps%2Frun.yml?ref=0222498610ebb192b4684637c9532b464716b2f9", "patch": "@@ -140,9 +140,35 @@ steps:\n # images, etc.\n - bash: |\n     set -e\n+    # Temporary code to debug #62967.\n+    debug_failed_connections() {\n+        echo \"trying to ping pypi.org\"\n+        ping pypi.org -c10 || true\n+        echo \"trying to ping google.com\"\n+        ping google.com -c10 || true\n+        echo \"trying to ping 8.8.8.8\"\n+        ping 8.8.8.8 -c10 || true\n+        echo \"trying to download pypi.org\"\n+        curl https://pypi.org || true\n+        echo \"trying to download from our S3 bucket\"\n+        curl https://rust-lang-ci2.s3.amazonaws.com || true\n+        echo \"trying to dig pypi.org\"\n+        dig pypi.org || true\n+        echo \"trying to dig files.pythonhosted.org\"\n+        dig files.pythonhosted.org || true\n+        echo \"trying to connect to pypi.org with openssl\"\n+        echo | openssl s_client -connect pypi.org:443 || true\n+        echo \"trying to connect to files.pythonhosted.org with openssl\"\n+        echo | openssl s_client -connect files.pythonhosted.org:443 || true\n+    }\n+    debug_failed_connections_and_fail() {\n+        debug_failed_connections\n+        return 1\n+    }\n     source src/ci/shared.sh\n     sudo apt-get install -y python3-setuptools\n-    retry pip3 install -r src/ci/awscli-requirements.txt --upgrade --user\n+    debug_failed_connections\n+    retry pip3 install -r src/ci/awscli-requirements.txt --upgrade --user || debug_failed_connections_and_fail\n     echo \"##vso[task.prependpath]$HOME/.local/bin\"\n   displayName: Install awscli (Linux)\n   condition: and(succeeded(), not(variables.SKIP_JOB), eq(variables['Agent.OS'], 'Linux'))"}]}