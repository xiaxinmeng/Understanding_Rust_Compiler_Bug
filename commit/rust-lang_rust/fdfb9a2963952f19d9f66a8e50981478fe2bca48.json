{"sha": "fdfb9a2963952f19d9f66a8e50981478fe2bca48", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZkZmI5YTI5NjM5NTJmMTlkOWY2NmE4ZTUwOTgxNDc4ZmUyYmNhNDg=", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2018-01-22T02:20:18Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2018-01-22T23:46:50Z"}, "message": "Add explanation for E0607", "tree": {"sha": "04cf46ac7c1b4cb47db4cf8c45f8dfeebe707fda", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/04cf46ac7c1b4cb47db4cf8c45f8dfeebe707fda"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fdfb9a2963952f19d9f66a8e50981478fe2bca48", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fdfb9a2963952f19d9f66a8e50981478fe2bca48", "html_url": "https://github.com/rust-lang/rust/commit/fdfb9a2963952f19d9f66a8e50981478fe2bca48", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fdfb9a2963952f19d9f66a8e50981478fe2bca48/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4e68e2a41ad20a76d48e1491706a5ec26de4bf66", "url": "https://api.github.com/repos/rust-lang/rust/commits/4e68e2a41ad20a76d48e1491706a5ec26de4bf66", "html_url": "https://github.com/rust-lang/rust/commit/4e68e2a41ad20a76d48e1491706a5ec26de4bf66"}], "stats": {"total": 29, "additions": 25, "deletions": 4}, "files": [{"sha": "d31a99dd1711098050941791909a9cbcdc718fa0", "filename": "src/librustc_typeck/check/cast.rs", "status": "modified", "additions": 25, "deletions": 4, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/fdfb9a2963952f19d9f66a8e50981478fe2bca48/src%2Flibrustc_typeck%2Fcheck%2Fcast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fdfb9a2963952f19d9f66a8e50981478fe2bca48/src%2Flibrustc_typeck%2Fcheck%2Fcast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fcast.rs?ref=fdfb9a2963952f19d9f66a8e50981478fe2bca48", "patch": "@@ -281,10 +281,31 @@ impl<'a, 'gcx, 'tcx> CastCheck<'tcx> {\n                                 .emit();\n             }\n             CastError::SizedUnsizedCast => {\n-                type_error_struct!(fcx.tcx.sess, self.span, self.expr_ty, E0607,\n-                                 \"cannot cast thin pointer `{}` to fat pointer `{}`\",\n-                                 self.expr_ty,\n-                                 fcx.ty_to_string(self.cast_ty)).emit();\n+                let mut err = type_error_struct!(\n+                    fcx.tcx.sess,\n+                    self.span,\n+                    self.expr_ty,\n+                    E0607,\n+                    \"cannot cast thin pointer `{}` to fat pointer `{}`\",\n+                    self.expr_ty,\n+                    fcx.ty_to_string(self.cast_ty)\n+                );\n+                if fcx.tcx.sess.opts.debugging_opts.explain {\n+                    err.note(\n+                        \"Thin pointers are \\\"simple\\\" pointers: they are purely a reference to a \\\n+                         memory address.\\n\\n\\\n+                         Fat pointers are pointers referencing \\\"Dynamically Sized Types\\\" (also \\\n+                         called DST). DST don't have a statically known size, therefore they can \\\n+                         only exist behind some kind of pointers that contain additional \\\n+                         information. Slices and trait objects are DSTs. In the case of slices, \\\n+                         the additional information the fat pointer holds is their size.\");\n+                    err.note(\"to fix this error, don't try to cast directly between thin and fat \\\n+                              pointers\");\n+                    err.help(\"for more information about casts, take a look at [The Book]\\\n+                              (https://doc.rust-lang.org/book/first-edition/\\\n+                              casting-between-types.html)\");\n+                }\n+                err.emit();\n             }\n             CastError::UnknownCastPtrKind |\n             CastError::UnknownExprPtrKind => {"}]}