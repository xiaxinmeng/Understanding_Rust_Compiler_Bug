{"sha": "86500fbb134032ed28129272ef9fb3873934dd1b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg2NTAwZmJiMTM0MDMyZWQyODEyOTI3MmVmOWZiMzg3MzkzNGRkMWI=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-05-08T06:18:39Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-05-08T06:18:39Z"}, "message": "auto merge of #6297 : sammykim/rust/static-lint-table, r=luqmana", "tree": {"sha": "b160628b0843f5d9d575a60c2659b999083cbfed", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b160628b0843f5d9d575a60c2659b999083cbfed"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/86500fbb134032ed28129272ef9fb3873934dd1b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/86500fbb134032ed28129272ef9fb3873934dd1b", "html_url": "https://github.com/rust-lang/rust/commit/86500fbb134032ed28129272ef9fb3873934dd1b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/86500fbb134032ed28129272ef9fb3873934dd1b/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5a1afaf5810048e8c0c6e5160cf0bf8c323113cf", "url": "https://api.github.com/repos/rust-lang/rust/commits/5a1afaf5810048e8c0c6e5160cf0bf8c323113cf", "html_url": "https://github.com/rust-lang/rust/commit/5a1afaf5810048e8c0c6e5160cf0bf8c323113cf"}, {"sha": "356ebe879276c5627d6010fce9dc8b054165e17b", "url": "https://api.github.com/repos/rust-lang/rust/commits/356ebe879276c5627d6010fce9dc8b054165e17b", "html_url": "https://github.com/rust-lang/rust/commit/356ebe879276c5627d6010fce9dc8b054165e17b"}], "stats": {"total": 289, "additions": 145, "deletions": 144}, "files": [{"sha": "9ca1cc9b92430931ad401021572bc45d6abfb519", "filename": "src/librustc/middle/lint.rs", "status": "modified", "additions": 145, "deletions": 144, "changes": 289, "blob_url": "https://github.com/rust-lang/rust/blob/86500fbb134032ed28129272ef9fb3873934dd1b/src%2Flibrustc%2Fmiddle%2Flint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/86500fbb134032ed28129272ef9fb3873934dd1b/src%2Flibrustc%2Fmiddle%2Flint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Flint.rs?ref=86500fbb134032ed28129272ef9fb3873934dd1b", "patch": "@@ -90,156 +90,157 @@ struct LintSpec {\n \n pub type LintDict = @HashMap<~str, LintSpec>;\n \n+static lint_table: &'static [(&'static str, LintSpec)] = &[\n+    (\"ctypes\",\n+     LintSpec {\n+        lint: ctypes,\n+        desc: \"proper use of core::libc types in foreign modules\",\n+        default: warn\n+     }),\n+\n+    (\"unused_imports\",\n+     LintSpec {\n+        lint: unused_imports,\n+        desc: \"imports that are never used\",\n+        default: warn\n+     }),\n+\n+    (\"while_true\",\n+     LintSpec {\n+        lint: while_true,\n+        desc: \"suggest using loop { } instead of while(true) { }\",\n+        default: warn\n+     }),\n+\n+    (\"path_statement\",\n+     LintSpec {\n+        lint: path_statement,\n+        desc: \"path statements with no effect\",\n+        default: warn\n+     }),\n+\n+    (\"unrecognized_lint\",\n+     LintSpec {\n+        lint: unrecognized_lint,\n+        desc: \"unrecognized lint attribute\",\n+        default: warn\n+     }),\n+\n+    (\"non_implicitly_copyable_typarams\",\n+     LintSpec {\n+        lint: non_implicitly_copyable_typarams,\n+        desc: \"passing non implicitly copyable types as copy type params\",\n+        default: warn\n+     }),\n+\n+    (\"vecs_implicitly_copyable\",\n+     LintSpec {\n+        lint: vecs_implicitly_copyable,\n+        desc: \"make vecs and strs not implicitly copyable \\\n+              (only checked at top level)\",\n+        default: warn\n+     }),\n+\n+    (\"implicit_copies\",\n+     LintSpec {\n+        lint: implicit_copies,\n+        desc: \"implicit copies of non implicitly copyable data\",\n+        default: warn\n+     }),\n+\n+    (\"deprecated_pattern\",\n+     LintSpec {\n+        lint: deprecated_pattern,\n+        desc: \"warn about deprecated uses of pattern bindings\",\n+        default: allow\n+     }),\n+\n+    (\"non_camel_case_types\",\n+     LintSpec {\n+        lint: non_camel_case_types,\n+        desc: \"types, variants and traits should have camel case names\",\n+        default: allow\n+     }),\n+\n+    (\"managed_heap_memory\",\n+     LintSpec {\n+        lint: managed_heap_memory,\n+        desc: \"use of managed (@ type) heap memory\",\n+        default: allow\n+     }),\n+\n+    (\"owned_heap_memory\",\n+     LintSpec {\n+        lint: owned_heap_memory,\n+        desc: \"use of owned (~ type) heap memory\",\n+        default: allow\n+     }),\n+\n+    (\"heap_memory\",\n+     LintSpec {\n+        lint: heap_memory,\n+        desc: \"use of any (~ type or @ type) heap memory\",\n+        default: allow\n+     }),\n+\n+    (\"type_limits\",\n+     LintSpec {\n+        lint: type_limits,\n+        desc: \"comparisons made useless by limits of the types involved\",\n+        default: warn\n+     }),\n+\n+    (\"default_methods\",\n+     LintSpec {\n+        lint: default_methods,\n+        desc: \"allow default methods\",\n+        default: deny\n+     }),\n+\n+    (\"deprecated_mutable_fields\",\n+     LintSpec {\n+        lint: deprecated_mutable_fields,\n+        desc: \"deprecated mutable fields in structures\",\n+        default: deny\n+    }),\n+\n+    (\"unused_unsafe\",\n+     LintSpec {\n+        lint: unused_unsafe,\n+        desc: \"unnecessary use of an `unsafe` block\",\n+        default: warn\n+    }),\n+\n+    (\"unused_variable\",\n+     LintSpec {\n+        lint: unused_variable,\n+        desc: \"detect variables which are not used in any way\",\n+        default: warn\n+    }),\n+\n+    (\"dead_assignment\",\n+     LintSpec {\n+        lint: dead_assignment,\n+        desc: \"detect assignments that will never be read\",\n+        default: warn\n+    }),\n+\n+    (\"unused_mut\",\n+     LintSpec {\n+        lint: unused_mut,\n+        desc: \"detect mut variables which don't need to be mutable\",\n+        default: warn\n+    }),\n+];\n+\n /*\n   Pass names should not contain a '-', as the compiler normalizes\n   '-' to '_' in command-line flags\n  */\n pub fn get_lint_dict() -> LintDict {\n-    let v = ~[\n-        (~\"ctypes\",\n-         LintSpec {\n-            lint: ctypes,\n-            desc: \"proper use of core::libc types in foreign modules\",\n-            default: warn\n-         }),\n-\n-        (~\"unused_imports\",\n-         LintSpec {\n-            lint: unused_imports,\n-            desc: \"imports that are never used\",\n-            default: warn\n-         }),\n-\n-        (~\"while_true\",\n-         LintSpec {\n-            lint: while_true,\n-            desc: \"suggest using loop { } instead of while(true) { }\",\n-            default: warn\n-         }),\n-\n-        (~\"path_statement\",\n-         LintSpec {\n-            lint: path_statement,\n-            desc: \"path statements with no effect\",\n-            default: warn\n-         }),\n-\n-        (~\"unrecognized_lint\",\n-         LintSpec {\n-            lint: unrecognized_lint,\n-            desc: \"unrecognized lint attribute\",\n-            default: warn\n-         }),\n-\n-        (~\"non_implicitly_copyable_typarams\",\n-         LintSpec {\n-            lint: non_implicitly_copyable_typarams,\n-            desc: \"passing non implicitly copyable types as copy type params\",\n-            default: warn\n-         }),\n-\n-        (~\"vecs_implicitly_copyable\",\n-         LintSpec {\n-            lint: vecs_implicitly_copyable,\n-            desc: \"make vecs and strs not implicitly copyable \\\n-                  (only checked at top level)\",\n-            default: warn\n-         }),\n-\n-        (~\"implicit_copies\",\n-         LintSpec {\n-            lint: implicit_copies,\n-            desc: \"implicit copies of non implicitly copyable data\",\n-            default: warn\n-         }),\n-\n-        (~\"deprecated_pattern\",\n-         LintSpec {\n-            lint: deprecated_pattern,\n-            desc: \"warn about deprecated uses of pattern bindings\",\n-            default: allow\n-         }),\n-\n-        (~\"non_camel_case_types\",\n-         LintSpec {\n-            lint: non_camel_case_types,\n-            desc: \"types, variants and traits should have camel case names\",\n-            default: allow\n-         }),\n-\n-        (~\"managed_heap_memory\",\n-         LintSpec {\n-            lint: managed_heap_memory,\n-            desc: \"use of managed (@ type) heap memory\",\n-            default: allow\n-         }),\n-\n-        (~\"owned_heap_memory\",\n-         LintSpec {\n-            lint: owned_heap_memory,\n-            desc: \"use of owned (~ type) heap memory\",\n-            default: allow\n-         }),\n-\n-        (~\"heap_memory\",\n-         LintSpec {\n-            lint: heap_memory,\n-            desc: \"use of any (~ type or @ type) heap memory\",\n-            default: allow\n-         }),\n-\n-        (~\"type_limits\",\n-         LintSpec {\n-            lint: type_limits,\n-            desc: \"comparisons made useless by limits of the types involved\",\n-            default: warn\n-         }),\n-\n-        (~\"default_methods\",\n-         LintSpec {\n-            lint: default_methods,\n-            desc: \"allow default methods\",\n-            default: deny\n-         }),\n-\n-        (~\"deprecated_mutable_fields\",\n-         LintSpec {\n-            lint: deprecated_mutable_fields,\n-            desc: \"deprecated mutable fields in structures\",\n-            default: deny\n-        }),\n-\n-        (~\"unused_unsafe\",\n-         LintSpec {\n-            lint: unused_unsafe,\n-            desc: \"unnecessary use of an `unsafe` block\",\n-            default: warn\n-        }),\n-\n-        (~\"unused_variable\",\n-         LintSpec {\n-            lint: unused_variable,\n-            desc: \"detect variables which are not used in any way\",\n-            default: warn\n-        }),\n-\n-        (~\"dead_assignment\",\n-         LintSpec {\n-            lint: dead_assignment,\n-            desc: \"detect assignments that will never be read\",\n-            default: warn\n-        }),\n-\n-        (~\"unused_mut\",\n-         LintSpec {\n-            lint: unused_mut,\n-            desc: \"detect mut variables which don't need to be mutable\",\n-            default: warn\n-        }),\n-    ];\n     let mut map = HashMap::new();\n-    do vec::consume(v) |_, (k, v)| {\n-        map.insert(k, v);\n+    for lint_table.each|&(k, v)| {\n+        map.insert(k.to_str(), v);\n     }\n     return @map;\n }"}]}