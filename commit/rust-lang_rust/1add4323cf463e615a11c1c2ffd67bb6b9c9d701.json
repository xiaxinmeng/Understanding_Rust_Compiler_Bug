{"sha": "1add4323cf463e615a11c1c2ffd67bb6b9c9d701", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFhZGQ0MzIzY2Y0NjNlNjE1YTExYzFjMmZmZDY3YmI2YjljOWQ3MDE=", "commit": {"author": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2020-09-21T17:23:39Z"}, "committer": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2020-09-21T17:23:39Z"}, "message": "Update Cranelift", "tree": {"sha": "7578e2bafc9d4746db0b8c77f39c9ed3537c8b4a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7578e2bafc9d4746db0b8c77f39c9ed3537c8b4a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1add4323cf463e615a11c1c2ffd67bb6b9c9d701", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1add4323cf463e615a11c1c2ffd67bb6b9c9d701", "html_url": "https://github.com/rust-lang/rust/commit/1add4323cf463e615a11c1c2ffd67bb6b9c9d701", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1add4323cf463e615a11c1c2ffd67bb6b9c9d701/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bac34647572d490dbb37f1e343f244e576222679", "url": "https://api.github.com/repos/rust-lang/rust/commits/bac34647572d490dbb37f1e343f244e576222679", "html_url": "https://github.com/rust-lang/rust/commit/bac34647572d490dbb37f1e343f244e576222679"}], "stats": {"total": 33, "additions": 15, "deletions": 18}, "files": [{"sha": "55ea61170f24d253788fd0d1c3b8abc741b8fd41", "filename": "Cargo.lock", "status": "modified", "additions": 12, "deletions": 12, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/1add4323cf463e615a11c1c2ffd67bb6b9c9d701/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/1add4323cf463e615a11c1c2ffd67bb6b9c9d701/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=1add4323cf463e615a11c1c2ffd67bb6b9c9d701", "patch": "@@ -44,15 +44,15 @@ checksum = \"4785bdd1c96b2a846b2bd7cc02e86b6b3dbf14e7e53446c4f54c92a361040822\"\n [[package]]\n name = \"cranelift-bforest\"\n version = \"0.66.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#693c6ea7715060950702d85f2dcf16627026b0da\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#32db4dcbe98098e5be2e457339d6d1946c73225c\"\n dependencies = [\n  \"cranelift-entity\",\n ]\n \n [[package]]\n name = \"cranelift-codegen\"\n version = \"0.66.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#693c6ea7715060950702d85f2dcf16627026b0da\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#32db4dcbe98098e5be2e457339d6d1946c73225c\"\n dependencies = [\n  \"byteorder\",\n  \"cranelift-bforest\",\n@@ -70,7 +70,7 @@ dependencies = [\n [[package]]\n name = \"cranelift-codegen-meta\"\n version = \"0.66.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#693c6ea7715060950702d85f2dcf16627026b0da\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#32db4dcbe98098e5be2e457339d6d1946c73225c\"\n dependencies = [\n  \"cranelift-codegen-shared\",\n  \"cranelift-entity\",\n@@ -79,17 +79,17 @@ dependencies = [\n [[package]]\n name = \"cranelift-codegen-shared\"\n version = \"0.66.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#693c6ea7715060950702d85f2dcf16627026b0da\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#32db4dcbe98098e5be2e457339d6d1946c73225c\"\n \n [[package]]\n name = \"cranelift-entity\"\n version = \"0.66.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#693c6ea7715060950702d85f2dcf16627026b0da\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#32db4dcbe98098e5be2e457339d6d1946c73225c\"\n \n [[package]]\n name = \"cranelift-frontend\"\n version = \"0.66.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#693c6ea7715060950702d85f2dcf16627026b0da\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#32db4dcbe98098e5be2e457339d6d1946c73225c\"\n dependencies = [\n  \"cranelift-codegen\",\n  \"log\",\n@@ -100,7 +100,7 @@ dependencies = [\n [[package]]\n name = \"cranelift-module\"\n version = \"0.66.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#693c6ea7715060950702d85f2dcf16627026b0da\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#32db4dcbe98098e5be2e457339d6d1946c73225c\"\n dependencies = [\n  \"anyhow\",\n  \"cranelift-codegen\",\n@@ -112,7 +112,7 @@ dependencies = [\n [[package]]\n name = \"cranelift-native\"\n version = \"0.66.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#693c6ea7715060950702d85f2dcf16627026b0da\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#32db4dcbe98098e5be2e457339d6d1946c73225c\"\n dependencies = [\n  \"cranelift-codegen\",\n  \"raw-cpuid\",\n@@ -122,7 +122,7 @@ dependencies = [\n [[package]]\n name = \"cranelift-object\"\n version = \"0.66.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#693c6ea7715060950702d85f2dcf16627026b0da\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#32db4dcbe98098e5be2e457339d6d1946c73225c\"\n dependencies = [\n  \"anyhow\",\n  \"cranelift-codegen\",\n@@ -134,7 +134,7 @@ dependencies = [\n [[package]]\n name = \"cranelift-simplejit\"\n version = \"0.66.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#693c6ea7715060950702d85f2dcf16627026b0da\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/?branch=main#32db4dcbe98098e5be2e457339d6d1946c73225c\"\n dependencies = [\n  \"cranelift-codegen\",\n  \"cranelift-module\",\n@@ -371,9 +371,9 @@ dependencies = [\n \n [[package]]\n name = \"target-lexicon\"\n-version = \"0.10.0\"\n+version = \"0.11.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"ab0e7238dcc7b40a7be719a25365910f6807bd864f4cce6b2e6b873658e2b19d\"\n+checksum = \"fe2635952a442a01fd4cb53d98858b5e4bb461b02c0d111f22f31772e3e7a8b2\"\n \n [[package]]\n name = \"thiserror\""}, {"sha": "d57556ef1912bb72d647ab520c66ca1bd5b3b5c9", "filename": "Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1add4323cf463e615a11c1c2ffd67bb6b9c9d701/Cargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/1add4323cf463e615a11c1c2ffd67bb6b9c9d701/Cargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.toml?ref=1add4323cf463e615a11c1c2ffd67bb6b9c9d701", "patch": "@@ -14,7 +14,7 @@ cranelift-frontend = { git = \"https://github.com/bytecodealliance/wasmtime/\", br\n cranelift-module = { git = \"https://github.com/bytecodealliance/wasmtime/\", branch = \"main\" }\n cranelift-simplejit = { git = \"https://github.com/bytecodealliance/wasmtime/\", branch = \"main\", optional = true }\n cranelift-object = { git = \"https://github.com/bytecodealliance/wasmtime/\", branch = \"main\" }\n-target-lexicon = \"0.10.0\"\n+target-lexicon = \"0.11.0\"\n gimli = { version = \"0.21.0\", default-features = false, features = [\"write\"]}\n object = { version = \"0.21.1\", default-features = false, features = [\"std\", \"read_core\", \"write\", \"coff\", \"elf\", \"macho\", \"pe\"] }\n "}, {"sha": "bf4e8d6e02ea1ad182f467ab135f4a3d1a14da46", "filename": "src/backend.rs", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/1add4323cf463e615a11c1c2ffd67bb6b9c9d701/src%2Fbackend.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1add4323cf463e615a11c1c2ffd67bb6b9c9d701/src%2Fbackend.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbackend.rs?ref=1add4323cf463e615a11c1c2ffd67bb6b9c9d701", "patch": "@@ -159,13 +159,10 @@ pub(crate) fn with_object(sess: &Session, name: &str, f: impl FnOnce(&mut Object\n         target_lexicon::BinaryFormat::Elf => object::BinaryFormat::Elf,\n         target_lexicon::BinaryFormat::Coff => object::BinaryFormat::Coff,\n         target_lexicon::BinaryFormat::Macho => object::BinaryFormat::MachO,\n-        target_lexicon::BinaryFormat::Wasm => sess.fatal(\"binary format wasm is unsupported\"),\n-        target_lexicon::BinaryFormat::Unknown => sess.fatal(\"binary format is unknown\"),\n+        binary_format => sess.fatal(&format!(\"binary format {} is unsupported\", binary_format)),\n     };\n     let architecture = match triple.architecture {\n-        target_lexicon::Architecture::I386\n-        | target_lexicon::Architecture::I586\n-        | target_lexicon::Architecture::I686 => object::Architecture::I386,\n+        target_lexicon::Architecture::X86_32(_) => object::Architecture::I386,\n         target_lexicon::Architecture::X86_64 => object::Architecture::X86_64,\n         target_lexicon::Architecture::Arm(_) => object::Architecture::Arm,\n         target_lexicon::Architecture::Aarch64(_) => object::Architecture::Aarch64,"}]}