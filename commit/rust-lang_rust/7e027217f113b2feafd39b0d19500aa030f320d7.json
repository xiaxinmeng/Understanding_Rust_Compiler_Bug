{"sha": "7e027217f113b2feafd39b0d19500aa030f320d7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdlMDI3MjE3ZjExM2IyZmVhZmQzOWIwZDE5NTAwYWEwMzBmMzIwZDc=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2018-10-31T20:54:30Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2018-10-31T20:54:30Z"}, "message": "Fix dogfood and pedantic lints", "tree": {"sha": "33331faa84aa98a5fe6a5b8e3fda011771c1cdcd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/33331faa84aa98a5fe6a5b8e3fda011771c1cdcd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7e027217f113b2feafd39b0d19500aa030f320d7", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEvUKv4zqIn2RHUgCKtvoGpuDiZlsFAlvaFpsACgkQtvoGpuDi\nZlvDmw/+OQLi8bRPfDCiqmdXLL4OJxAltG0LczNfrdIiFO7ridxrOb6Wo6nW+rtY\nglmtBAcAzYptg+gBhQgm9/rgoXMNoTdJ/uqHzhm1WJStVWyNY63RCAlKNQwghh/A\nYVRtzThBpscvQibnR8onPOh0RGLZMqXU7HrgV9kkhiMQsZtouW3bkT8tCCebzVaL\njaFnU4FIx6gRFccuUolnLNI0I+XdC91VN6b1OmA5JTBQVWj9hzIISE1z4q4dFMXi\nBe/z1TGJXalhB705XDMG7I3q/7Sm0IvmYBR3HTY+tLxXOP4q7VBq18lhYUJviALT\nL50Yz6CRU0ftHIlAPV/nvUeONLO0QT0uDcPhdM/olF5LOqO4TdE98ZcUne6fcwA+\niFDfQK+Y+8o3RU/698anRC0E5Jn3KTW5MwSfEbcwrQxU6bkl0XhEUwXv7ualcyeo\noyn5xctnlJgWs6Z5FPbKZ6BPaKhYpwY0BDTKiRW8SLpaaovhozw1BABS5gmeNYiP\nTV0AeNx/NO9LSwNSP6Z2W8NEfUnKRGc0WKZj1rQqZuX/s/71BHQU+vdsO1/j+5kw\nSU2StJvPnNiIt1C5xwLDMrDOgPdTmFC8x+fXPNwb2j7oTpsA5kAxGRvTn6LVq3Ap\nfIMMQR+P7g5jKedZQOPjmM2P7P7ymP/uzoIInaxnFPDbqQ152Bk=\n=w0jJ\n-----END PGP SIGNATURE-----", "payload": "tree 33331faa84aa98a5fe6a5b8e3fda011771c1cdcd\nparent 64bd658516d6a097c04295a3f90537d757c258bd\nauthor Philipp Hansch <dev@phansch.net> 1541019270 +0100\ncommitter Philipp Hansch <dev@phansch.net> 1541019270 +0100\n\nFix dogfood and pedantic lints\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7e027217f113b2feafd39b0d19500aa030f320d7", "html_url": "https://github.com/rust-lang/rust/commit/7e027217f113b2feafd39b0d19500aa030f320d7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7e027217f113b2feafd39b0d19500aa030f320d7/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "64bd658516d6a097c04295a3f90537d757c258bd", "url": "https://api.github.com/repos/rust-lang/rust/commits/64bd658516d6a097c04295a3f90537d757c258bd", "html_url": "https://github.com/rust-lang/rust/commit/64bd658516d6a097c04295a3f90537d757c258bd"}], "stats": {"total": 40, "additions": 21, "deletions": 19}, "files": [{"sha": "656a271aec991689180e62ba67f04f6321acdf7c", "filename": "clippy_dev/src/lib.rs", "status": "modified", "additions": 20, "deletions": 18, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/7e027217f113b2feafd39b0d19500aa030f320d7/clippy_dev%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7e027217f113b2feafd39b0d19500aa030f320d7/clippy_dev%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Flib.rs?ref=7e027217f113b2feafd39b0d19500aa030f320d7", "patch": "@@ -78,26 +78,28 @@ pub fn gen_changelog_lint_list(lints: Vec<Lint>) -> Vec<String> {\n     lint_list_sorted.sort_by_key(|l| l.name.clone());\n     lint_list_sorted\n         .iter()\n-        .filter(|l| !l.is_internal())\n-        .map(|l| {\n-            format!(\"[`{}`]: {}#{}\", l.name, DOCS_LINK.clone(), l.name)\n-        })\n-        .collect()\n+        .filter_map(|l| {\n+            if l.is_internal() {\n+                None\n+            } else {\n+                Some(format!(\"[`{}`]: {}#{}\", l.name, DOCS_LINK.clone(), l.name))\n+            }\n+        }).collect()\n }\n \n-/// Generates the 'register_removed' code in `./clippy_lints/src/lib.rs`.\n-pub fn gen_deprecated(lints: Vec<Lint>) -> Vec<String> {\n+/// Generates the `register_removed` code in `./clippy_lints/src/lib.rs`.\n+pub fn gen_deprecated(lints: &[Lint]) -> Vec<String> {\n     lints.iter()\n-        .filter(|l| l.deprecation.is_some())\n-        .map(|l| {\n-            format!(\n-                r#\"    store.register_removed(\n-        \"{}\",\n-        \"{}\",\n-    );\"#,\n-                l.name,\n-                l.deprecation.clone().unwrap()\n-            )\n+        .filter_map(|l| {\n+            l.clone().deprecation.and_then(|depr_text| {\n+                Some(\n+                    format!(\n+                        \"    store.register_removed(\\n        \\\"{}\\\",\\n        \\\"{}\\\",\\n    );\",\n+                        l.name,\n+                        depr_text\n+                    )\n+                )\n+            })\n         })\n         .collect()\n }\n@@ -352,5 +354,5 @@ fn test_gen_deprecated() {\n         \"has been superseeded by should_assert_eq2\",\n     );\"#.to_string()\n     ];\n-    assert_eq!(expected, gen_deprecated(lints));\n+    assert_eq!(expected, gen_deprecated(&lints));\n }"}, {"sha": "887a4ab9328929322667145856dd88fedfdfea8b", "filename": "clippy_dev/src/main.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7e027217f113b2feafd39b0d19500aa030f320d7/clippy_dev%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7e027217f113b2feafd39b0d19500aa030f320d7/clippy_dev%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Fmain.rs?ref=7e027217f113b2feafd39b0d19500aa030f320d7", "patch": "@@ -88,6 +88,6 @@ fn update_lints() {\n         \"begin deprecated lints\",\n         \"end deprecated lints\",\n         false,\n-        || { gen_deprecated(lint_list.clone()) }\n+        || { gen_deprecated(&lint_list) }\n     );\n }"}]}