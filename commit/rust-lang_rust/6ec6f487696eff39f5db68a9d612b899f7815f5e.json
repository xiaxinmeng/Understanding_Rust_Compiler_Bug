{"sha": "6ec6f487696eff39f5db68a9d612b899f7815f5e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZlYzZmNDg3Njk2ZWZmMzlmNWRiNjhhOWQ2MTJiODk5Zjc4MTVmNWU=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2018-12-16T13:08:16Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-12-16T13:08:16Z"}, "message": "Rollup merge of #56439 - JohnGinger:master, r=nikomatsakis\n\nClearer error message for dead assign\n\nI'm not that this is the right place for this (if it needs an RFC or not).\n\nI had the problem where I misunderstood the compiler lint message https://github.com/rust-lang/rust/issues/56436 and other people seem to have had the same problem https://www.reddit.com/r/rust/comments/8cy9p4/value_assigned_to_is_never_read/.\n\nI think this new wording might be slightly clearer (and help out beginners like me). I'm very new though, so there might be some nuance I'm missing that would make this more confusing or a bad idea for other reasons.\n\nI thought I would create a PR to make it easy to change the code if the consensus was that it would make sense to make a change.\n\nIf this is the wrong place for this sort of thing I'll happily delete/move it.", "tree": {"sha": "1c94644474b30624e8900c6b7e1eda8802b4f783", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1c94644474b30624e8900c6b7e1eda8802b4f783"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6ec6f487696eff39f5db68a9d612b899f7815f5e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcFk5ACRBK7hj4Ov3rIwAAdHIIAAKSE8NjIKhYd631+rdL8vO6\nnNP1Y43r762EdC5MeZEe2UZ/5WIeTT755shq5AVMzq3SAMZOfdTuoj4qQa9XBXWu\nj5kPEvK/XI1DPWCe5WVAJpqypcRJUJaGzaXQhQtLzrm9MzRXQXLL4q2uM0DwRrhd\nYgkFsr1MDQHJ/g+aonaLiWHiSEzsvY25JJOMix29mfALl/taYhuaTCcF5TtT6WH6\nIwyeMj2+Mmew/ujiBDGzZn9SRHNX2xrdmsx3O8R9fpqxATw4IsxJYdbu54ld/y3H\nH5ceLZ+PBslVC2hjJ3u87fDQHljAMVe8cAAsOZQ75D9K6p9MdlJVM3eVDxgnNIY=\n=xZ+y\n-----END PGP SIGNATURE-----\n", "payload": "tree 1c94644474b30624e8900c6b7e1eda8802b4f783\nparent cdadb72a3329ac1fb463106bbce32b642498fb50\nparent c0e3f4b8bbf10cc308823c98913b942b75c6a543\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1544965696 +0100\ncommitter GitHub <noreply@github.com> 1544965696 +0100\n\nRollup merge of #56439 - JohnGinger:master, r=nikomatsakis\n\nClearer error message for dead assign\n\nI'm not that this is the right place for this (if it needs an RFC or not).\n\nI had the problem where I misunderstood the compiler lint message https://github.com/rust-lang/rust/issues/56436 and other people seem to have had the same problem https://www.reddit.com/r/rust/comments/8cy9p4/value_assigned_to_is_never_read/.\n\nI think this new wording might be slightly clearer (and help out beginners like me). I'm very new though, so there might be some nuance I'm missing that would make this more confusing or a bad idea for other reasons.\n\nI thought I would create a PR to make it easy to change the code if the consensus was that it would make sense to make a change.\n\nIf this is the wrong place for this sort of thing I'll happily delete/move it.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6ec6f487696eff39f5db68a9d612b899f7815f5e", "html_url": "https://github.com/rust-lang/rust/commit/6ec6f487696eff39f5db68a9d612b899f7815f5e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6ec6f487696eff39f5db68a9d612b899f7815f5e/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cdadb72a3329ac1fb463106bbce32b642498fb50", "url": "https://api.github.com/repos/rust-lang/rust/commits/cdadb72a3329ac1fb463106bbce32b642498fb50", "html_url": "https://github.com/rust-lang/rust/commit/cdadb72a3329ac1fb463106bbce32b642498fb50"}, {"sha": "c0e3f4b8bbf10cc308823c98913b942b75c6a543", "url": "https://api.github.com/repos/rust-lang/rust/commits/c0e3f4b8bbf10cc308823c98913b942b75c6a543", "html_url": "https://github.com/rust-lang/rust/commit/c0e3f4b8bbf10cc308823c98913b942b75c6a543"}], "stats": {"total": 23, "additions": 19, "deletions": 4}, "files": [{"sha": "31a75bd106e2cb36c6a9b13deabcb7c6a4375ab7", "filename": "src/librustc/middle/liveness.rs", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/6ec6f487696eff39f5db68a9d612b899f7815f5e/src%2Flibrustc%2Fmiddle%2Fliveness.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6ec6f487696eff39f5db68a9d612b899f7815f5e/src%2Flibrustc%2Fmiddle%2Fliveness.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fliveness.rs?ref=6ec6f487696eff39f5db68a9d612b899f7815f5e", "patch": "@@ -1657,11 +1657,15 @@ impl<'a, 'tcx> Liveness<'a, 'tcx> {\n     fn report_dead_assign(&self, hir_id: HirId, sp: Span, var: Variable, is_argument: bool) {\n         if let Some(name) = self.should_warn(var) {\n             if is_argument {\n-                self.ir.tcx.lint_hir(lint::builtin::UNUSED_ASSIGNMENTS, hir_id, sp,\n-                    &format!(\"value passed to `{}` is never read\", name));\n+                self.ir.tcx.struct_span_lint_hir(lint::builtin::UNUSED_ASSIGNMENTS, hir_id, sp,\n+                &format!(\"value passed to `{}` is never read\", name))\n+                .help(\"maybe it is overwritten before being read?\")\n+                .emit();\n             } else {\n-                self.ir.tcx.lint_hir(lint::builtin::UNUSED_ASSIGNMENTS, hir_id, sp,\n-                    &format!(\"value assigned to `{}` is never read\", name));\n+                self.ir.tcx.struct_span_lint_hir(lint::builtin::UNUSED_ASSIGNMENTS, hir_id, sp,\n+                &format!(\"value assigned to `{}` is never read\", name))\n+                .help(\"maybe it is overwritten before being read?\")\n+                .emit();\n             }\n         }\n     }"}, {"sha": "6b9e1dc70573ee58ffe0887bbaa6e0db04602ee8", "filename": "src/test/ui/lint/issue-47390-unused-variable-in-struct-pattern.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/6ec6f487696eff39f5db68a9d612b899f7815f5e/src%2Ftest%2Fui%2Flint%2Fissue-47390-unused-variable-in-struct-pattern.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/6ec6f487696eff39f5db68a9d612b899f7815f5e/src%2Ftest%2Fui%2Flint%2Fissue-47390-unused-variable-in-struct-pattern.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fissue-47390-unused-variable-in-struct-pattern.stderr?ref=6ec6f487696eff39f5db68a9d612b899f7815f5e", "patch": "@@ -55,6 +55,7 @@ note: lint level defined here\n LL | #![warn(unused)] // UI tests pass `-A unused` (#43896)\n    |         ^^^^^^\n    = note: #[warn(unused_assignments)] implied by #[warn(unused)]\n+   = help: maybe it is overwritten before being read?\n \n warning: unused variable: `fire`\n   --> $DIR/issue-47390-unused-variable-in-struct-pattern.rs:54:32"}, {"sha": "6e43cccdccff230b5b9916021bb0958e0e607d41", "filename": "src/test/ui/liveness/liveness-dead.stderr", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/6ec6f487696eff39f5db68a9d612b899f7815f5e/src%2Ftest%2Fui%2Fliveness%2Fliveness-dead.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/6ec6f487696eff39f5db68a9d612b899f7815f5e/src%2Ftest%2Fui%2Fliveness%2Fliveness-dead.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fliveness%2Fliveness-dead.stderr?ref=6ec6f487696eff39f5db68a9d612b899f7815f5e", "patch": "@@ -9,24 +9,31 @@ note: lint level defined here\n    |\n LL | #![deny(unused_assignments)]\n    |         ^^^^^^^^^^^^^^^^^^\n+   = help: maybe it is overwritten before being read?\n \n error: value assigned to `x` is never read\n   --> $DIR/liveness-dead.rs:27:5\n    |\n LL |     x = 4; //~ ERROR: value assigned to `x` is never read\n    |     ^\n+   |\n+   = help: maybe it is overwritten before being read?\n \n error: value passed to `x` is never read\n   --> $DIR/liveness-dead.rs:30:11\n    |\n LL | fn f4(mut x: i32) { //~ ERROR: value passed to `x` is never read\n    |           ^\n+   |\n+   = help: maybe it is overwritten before being read?\n \n error: value assigned to `x` is never read\n   --> $DIR/liveness-dead.rs:37:5\n    |\n LL |     x = 4; //~ ERROR: value assigned to `x` is never read\n    |     ^\n+   |\n+   = help: maybe it is overwritten before being read?\n \n error: aborting due to 4 previous errors\n "}, {"sha": "35ccc79a19ac094f3210762d67dcc006daa2e8a6", "filename": "src/test/ui/liveness/liveness-unused.stderr", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/6ec6f487696eff39f5db68a9d612b899f7815f5e/src%2Ftest%2Fui%2Fliveness%2Fliveness-unused.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/6ec6f487696eff39f5db68a9d612b899f7815f5e/src%2Ftest%2Fui%2Fliveness%2Fliveness-unused.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fliveness%2Fliveness-unused.stderr?ref=6ec6f487696eff39f5db68a9d612b899f7815f5e", "patch": "@@ -60,6 +60,7 @@ note: lint level defined here\n    |\n LL | #![deny(unused_assignments)]\n    |         ^^^^^^^^^^^^^^^^^^\n+   = help: maybe it is overwritten before being read?\n \n error: variable `z` is assigned to, but never used\n   --> $DIR/liveness-unused.rs:47:13\n@@ -106,6 +107,8 @@ error: value assigned to `x` is never read\n    |\n LL |         x = 0;  //~ ERROR value assigned to `x` is never read\n    |         ^\n+   |\n+   = help: maybe it is overwritten before being read?\n \n error: aborting due to 13 previous errors\n "}]}