{"sha": "25185c1418022868e2f7ec1599e32a34d63e8314", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI1MTg1YzE0MTgwMjI4NjhlMmY3ZWMxNTk5ZTMyYTM0ZDYzZTgzMTQ=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2020-12-18T18:27:28Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-12-18T18:27:28Z"}, "message": "Merge #6933\n\n6933: Reduce test verbosity r=matklad a=matklad\n\nbors r+\n\ud83e\udd16\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>", "tree": {"sha": "f0ce5fc87361263a4d4703b6ee418518bd0aa212", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f0ce5fc87361263a4d4703b6ee418518bd0aa212"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/25185c1418022868e2f7ec1599e32a34d63e8314", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJf3PSQCRBK7hj4Ov3rIwAAdHIIALMVvLMIkVdfFYl9oEPFxOfb\noH0FoVHR+pnRwJXDbi3DOVnwNYrJVjiAuCwkMHovPTQS701/WKbotnR6mUvQqvKz\nIq2tM5VZUseBsg7itUCiyok/exIROTa87UR5V3uMsVAm5/QP+/ABafpY33Do7rr6\nUD/SaSa9Kdjl7746A1PbEyVRN3i7Wesz/AN8zMu7qyJ+2iInv4Yihup7h3t68Wzw\nfpsQnZARXbg+6jdAIVM3/0nNPSsx8p+kLlY7zFoPWTjFcPXWRrhkv7uBhS7eqQVC\n3zuy8YB5M9OzP+SPgPhp7UUgpkW1FPDwqkzic6yHlrg2+L2YpT1oUt/Qlr30Go4=\n=9M0m\n-----END PGP SIGNATURE-----\n", "payload": "tree f0ce5fc87361263a4d4703b6ee418518bd0aa212\nparent 53f81e4e8c8307069d89cee58cb12142350b09c2\nparent ade2f5cd124049614801fc821298205006c6bdf4\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1608316048 +0000\ncommitter GitHub <noreply@github.com> 1608316048 +0000\n\nMerge #6933\n\n6933: Reduce test verbosity r=matklad a=matklad\n\nbors r+\n\ud83e\udd16\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/25185c1418022868e2f7ec1599e32a34d63e8314", "html_url": "https://github.com/rust-lang/rust/commit/25185c1418022868e2f7ec1599e32a34d63e8314", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/25185c1418022868e2f7ec1599e32a34d63e8314/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "53f81e4e8c8307069d89cee58cb12142350b09c2", "url": "https://api.github.com/repos/rust-lang/rust/commits/53f81e4e8c8307069d89cee58cb12142350b09c2", "html_url": "https://github.com/rust-lang/rust/commit/53f81e4e8c8307069d89cee58cb12142350b09c2"}, {"sha": "ade2f5cd124049614801fc821298205006c6bdf4", "url": "https://api.github.com/repos/rust-lang/rust/commits/ade2f5cd124049614801fc821298205006c6bdf4", "html_url": "https://github.com/rust-lang/rust/commit/ade2f5cd124049614801fc821298205006c6bdf4"}], "stats": {"total": 593, "additions": 140, "deletions": 453}, "files": [{"sha": "cbdd4ecc2a89a265fea9f3b08c3d913c47c60b29", "filename": "crates/ide/src/display/navigation_target.rs", "status": "modified", "additions": 40, "deletions": 30, "changes": 70, "blob_url": "https://github.com/rust-lang/rust/blob/25185c1418022868e2f7ec1599e32a34d63e8314/crates%2Fide%2Fsrc%2Fdisplay%2Fnavigation_target.rs", "raw_url": "https://github.com/rust-lang/rust/raw/25185c1418022868e2f7ec1599e32a34d63e8314/crates%2Fide%2Fsrc%2Fdisplay%2Fnavigation_target.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fdisplay%2Fnavigation_target.rs?ref=25185c1418022868e2f7ec1599e32a34d63e8314", "patch": "@@ -1,5 +1,7 @@\n //! FIXME: write short doc here\n \n+use std::fmt;\n+\n use either::Either;\n use hir::{AssocItem, Documentation, FieldSource, HasAttrs, HasSource, InFile, ModuleSource};\n use ide_db::{\n@@ -35,16 +37,14 @@ pub enum SymbolKind {\n     TypeAlias,\n     Trait,\n     Macro,\n-    // Do we actually need this?\n-    DocTest,\n }\n \n /// `NavigationTarget` represents and element in the editor's UI which you can\n /// click on to navigate to a particular piece of code.\n ///\n /// Typically, a `NavigationTarget` corresponds to some element in the source\n /// code, like a function or a struct, but this is not strictly required.\n-#[derive(Debug, Clone, PartialEq, Eq, Hash)]\n+#[derive(Clone, PartialEq, Eq, Hash)]\n pub struct NavigationTarget {\n     pub file_id: FileId,\n     /// Range which encompasses the whole element.\n@@ -64,12 +64,30 @@ pub struct NavigationTarget {\n     /// Clients should place the cursor on this range when navigating to this target.\n     pub focus_range: Option<TextRange>,\n     pub name: SmolStr,\n-    pub kind: SymbolKind,\n+    pub kind: Option<SymbolKind>,\n     pub container_name: Option<SmolStr>,\n     pub description: Option<String>,\n     pub docs: Option<Documentation>,\n }\n \n+impl fmt::Debug for NavigationTarget {\n+    fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {\n+        let mut f = f.debug_struct(\"NavigationTarget\");\n+        macro_rules! opt {\n+            ($($name:ident)*) => {$(\n+                if let Some(it) = &self.$name {\n+                    f.field(stringify!($name), it);\n+                }\n+            )*}\n+        }\n+        f.field(\"file_id\", &self.file_id).field(\"full_range\", &self.full_range);\n+        opt!(focus_range);\n+        f.field(\"name\", &self.name);\n+        opt!(kind container_name description docs);\n+        f.finish()\n+    }\n+}\n+\n pub(crate) trait ToNav {\n     fn to_nav(&self, db: &RootDatabase) -> NavigationTarget;\n }\n@@ -110,8 +128,13 @@ impl NavigationTarget {\n \n     #[cfg(test)]\n     pub(crate) fn debug_render(&self) -> String {\n-        let mut buf =\n-            format!(\"{} {:?} {:?} {:?}\", self.name, self.kind, self.file_id, self.full_range);\n+        let mut buf = format!(\n+            \"{} {:?} {:?} {:?}\",\n+            self.name,\n+            self.kind.unwrap(),\n+            self.file_id,\n+            self.full_range\n+        );\n         if let Some(focus_range) = self.focus_range {\n             buf.push_str(&format!(\" {:?}\", focus_range))\n         }\n@@ -146,7 +169,7 @@ impl NavigationTarget {\n         NavigationTarget {\n             file_id,\n             name,\n-            kind,\n+            kind: Some(kind),\n             full_range,\n             focus_range,\n             container_name: None,\n@@ -161,7 +184,7 @@ impl ToNav for FileSymbol {\n         NavigationTarget {\n             file_id: self.file_id,\n             name: self.name.clone(),\n-            kind: match self.kind {\n+            kind: Some(match self.kind {\n                 FileSymbolKind::Function => SymbolKind::Function,\n                 FileSymbolKind::Struct => SymbolKind::Struct,\n                 FileSymbolKind::Enum => SymbolKind::Enum,\n@@ -171,7 +194,7 @@ impl ToNav for FileSymbol {\n                 FileSymbolKind::Const => SymbolKind::Const,\n                 FileSymbolKind::Static => SymbolKind::Static,\n                 FileSymbolKind::Macro => SymbolKind::Macro,\n-            },\n+            }),\n             full_range: self.range,\n             focus_range: self.name_range,\n             container_name: self.container_name.clone(),\n@@ -386,7 +409,7 @@ impl ToNav for hir::Local {\n         NavigationTarget {\n             file_id: full_range.file_id,\n             name,\n-            kind: SymbolKind::Local,\n+            kind: Some(SymbolKind::Local),\n             full_range: full_range.range,\n             focus_range: None,\n             container_name: None,\n@@ -410,7 +433,7 @@ impl ToNav for hir::TypeParam {\n         NavigationTarget {\n             file_id: src.file_id.original_file(db),\n             name: self.name(db).to_string().into(),\n-            kind: SymbolKind::TypeParam,\n+            kind: Some(SymbolKind::TypeParam),\n             full_range,\n             focus_range,\n             container_name: None,\n@@ -427,7 +450,7 @@ impl ToNav for hir::LifetimeParam {\n         NavigationTarget {\n             file_id: src.file_id.original_file(db),\n             name: self.name(db).to_string().into(),\n-            kind: SymbolKind::LifetimeParam,\n+            kind: Some(SymbolKind::LifetimeParam),\n             full_range,\n             focus_range: Some(full_range),\n             container_name: None,\n@@ -484,34 +507,21 @@ fn foo() { enum FooInner { } }\n                         0,\n                     ),\n                     full_range: 0..17,\n-                    focus_range: Some(\n-                        5..13,\n-                    ),\n+                    focus_range: 5..13,\n                     name: \"FooInner\",\n                     kind: Enum,\n-                    container_name: None,\n-                    description: Some(\n-                        \"enum FooInner\",\n-                    ),\n-                    docs: None,\n+                    description: \"enum FooInner\",\n                 },\n                 NavigationTarget {\n                     file_id: FileId(\n                         0,\n                     ),\n                     full_range: 29..46,\n-                    focus_range: Some(\n-                        34..42,\n-                    ),\n+                    focus_range: 34..42,\n                     name: \"FooInner\",\n                     kind: Enum,\n-                    container_name: Some(\n-                        \"foo\",\n-                    ),\n-                    description: Some(\n-                        \"enum FooInner\",\n-                    ),\n-                    docs: None,\n+                    container_name: \"foo\",\n+                    description: \"enum FooInner\",\n                 },\n             ]\n         \"#]]"}, {"sha": "7a12e99652f6a0f4d4eaf572f5dae027701b259f", "filename": "crates/ide/src/goto_definition.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/25185c1418022868e2f7ec1599e32a34d63e8314/crates%2Fide%2Fsrc%2Fgoto_definition.rs", "raw_url": "https://github.com/rust-lang/rust/raw/25185c1418022868e2f7ec1599e32a34d63e8314/crates%2Fide%2Fsrc%2Fgoto_definition.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fgoto_definition.rs?ref=25185c1418022868e2f7ec1599e32a34d63e8314", "patch": "@@ -86,7 +86,7 @@ fn self_to_nav_target(self_param: ast::SelfParam, file_id: FileId) -> Option<Nav\n         full_range: self_param.syntax().text_range(),\n         focus_range: Some(self_token.text_range()),\n         name: self_token.text().clone(),\n-        kind: SymbolKind::SelfParam,\n+        kind: Some(SymbolKind::SelfParam),\n         container_name: None,\n         description: None,\n         docs: None,"}, {"sha": "b06fa5f1557598468a482a921a33bec4d803d2d9", "filename": "crates/ide/src/hover.rs", "status": "modified", "additions": 72, "deletions": 292, "changes": 364, "blob_url": "https://github.com/rust-lang/rust/blob/25185c1418022868e2f7ec1599e32a34d63e8314/crates%2Fide%2Fsrc%2Fhover.rs", "raw_url": "https://github.com/rust-lang/rust/raw/25185c1418022868e2f7ec1599e32a34d63e8314/crates%2Fide%2Fsrc%2Fhover.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fhover.rs?ref=25185c1418022868e2f7ec1599e32a34d63e8314", "patch": "@@ -2187,14 +2187,9 @@ fn foo_<|>test() {}\n                                     0,\n                                 ),\n                                 full_range: 0..24,\n-                                focus_range: Some(\n-                                    11..19,\n-                                ),\n+                                focus_range: 11..19,\n                                 name: \"foo_test\",\n                                 kind: Function,\n-                                container_name: None,\n-                                description: None,\n-                                docs: None,\n                             },\n                             kind: Test {\n                                 test_id: Path(\n@@ -2230,14 +2225,9 @@ mod tests<|> {\n                                     0,\n                                 ),\n                                 full_range: 0..46,\n-                                focus_range: Some(\n-                                    4..9,\n-                                ),\n+                                focus_range: 4..9,\n                                 name: \"tests\",\n                                 kind: Module,\n-                                container_name: None,\n-                                description: None,\n-                                docs: None,\n                             },\n                             kind: TestMod {\n                                 path: \"tests\",\n@@ -2269,16 +2259,10 @@ fn main() { let s<|>t = S{ f1:0 }; }\n                                         0,\n                                     ),\n                                     full_range: 0..19,\n-                                    focus_range: Some(\n-                                        7..8,\n-                                    ),\n+                                    focus_range: 7..8,\n                                     name: \"S\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct S\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct S\",\n                                 },\n                             },\n                         ],\n@@ -2308,16 +2292,10 @@ fn main() { let s<|>t = S{ f1:Arg(0) }; }\n                                         0,\n                                     ),\n                                     full_range: 17..37,\n-                                    focus_range: Some(\n-                                        24..25,\n-                                    ),\n+                                    focus_range: 24..25,\n                                     name: \"S\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct S\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct S\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -2327,16 +2305,10 @@ fn main() { let s<|>t = S{ f1:Arg(0) }; }\n                                         0,\n                                     ),\n                                     full_range: 0..16,\n-                                    focus_range: Some(\n-                                        7..10,\n-                                    ),\n+                                    focus_range: 7..10,\n                                     name: \"Arg\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct Arg\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct Arg\",\n                                 },\n                             },\n                         ],\n@@ -2366,16 +2338,10 @@ fn main() { let s<|>t = S{ f1: S{ f1: Arg(0) } }; }\n                                         0,\n                                     ),\n                                     full_range: 17..37,\n-                                    focus_range: Some(\n-                                        24..25,\n-                                    ),\n+                                    focus_range: 24..25,\n                                     name: \"S\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct S\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct S\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -2385,16 +2351,10 @@ fn main() { let s<|>t = S{ f1: S{ f1: Arg(0) } }; }\n                                         0,\n                                     ),\n                                     full_range: 0..16,\n-                                    focus_range: Some(\n-                                        7..10,\n-                                    ),\n+                                    focus_range: 7..10,\n                                     name: \"Arg\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct Arg\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct Arg\",\n                                 },\n                             },\n                         ],\n@@ -2427,16 +2387,10 @@ fn main() { let s<|>t = (A(1), B(2), M::C(3) ); }\n                                         0,\n                                     ),\n                                     full_range: 0..14,\n-                                    focus_range: Some(\n-                                        7..8,\n-                                    ),\n+                                    focus_range: 7..8,\n                                     name: \"A\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct A\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct A\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -2446,16 +2400,10 @@ fn main() { let s<|>t = (A(1), B(2), M::C(3) ); }\n                                         0,\n                                     ),\n                                     full_range: 15..29,\n-                                    focus_range: Some(\n-                                        22..23,\n-                                    ),\n+                                    focus_range: 22..23,\n                                     name: \"B\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct B\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct B\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -2465,16 +2413,10 @@ fn main() { let s<|>t = (A(1), B(2), M::C(3) ); }\n                                         0,\n                                     ),\n                                     full_range: 42..60,\n-                                    focus_range: Some(\n-                                        53..54,\n-                                    ),\n+                                    focus_range: 53..54,\n                                     name: \"C\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"pub struct C\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"pub struct C\",\n                                 },\n                             },\n                         ],\n@@ -2504,16 +2446,10 @@ fn main() { let s<|>t = foo(); }\n                                         0,\n                                     ),\n                                     full_range: 0..12,\n-                                    focus_range: Some(\n-                                        6..9,\n-                                    ),\n+                                    focus_range: 6..9,\n                                     name: \"Foo\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait Foo\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait Foo\",\n                                 },\n                             },\n                         ],\n@@ -2544,16 +2480,10 @@ fn main() { let s<|>t = foo(); }\n                                         0,\n                                     ),\n                                     full_range: 0..15,\n-                                    focus_range: Some(\n-                                        6..9,\n-                                    ),\n+                                    focus_range: 6..9,\n                                     name: \"Foo\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait Foo\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait Foo\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -2563,16 +2493,10 @@ fn main() { let s<|>t = foo(); }\n                                         0,\n                                     ),\n                                     full_range: 16..25,\n-                                    focus_range: Some(\n-                                        23..24,\n-                                    ),\n+                                    focus_range: 23..24,\n                                     name: \"S\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct S\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct S\",\n                                 },\n                             },\n                         ],\n@@ -2603,16 +2527,10 @@ fn main() { let s<|>t = foo(); }\n                                         0,\n                                     ),\n                                     full_range: 0..12,\n-                                    focus_range: Some(\n-                                        6..9,\n-                                    ),\n+                                    focus_range: 6..9,\n                                     name: \"Foo\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait Foo\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait Foo\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -2622,16 +2540,10 @@ fn main() { let s<|>t = foo(); }\n                                         0,\n                                     ),\n                                     full_range: 13..25,\n-                                    focus_range: Some(\n-                                        19..22,\n-                                    ),\n+                                    focus_range: 19..22,\n                                     name: \"Bar\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait Bar\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait Bar\",\n                                 },\n                             },\n                         ],\n@@ -2665,16 +2577,10 @@ fn main() { let s<|>t = foo(); }\n                                         0,\n                                     ),\n                                     full_range: 0..15,\n-                                    focus_range: Some(\n-                                        6..9,\n-                                    ),\n+                                    focus_range: 6..9,\n                                     name: \"Foo\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait Foo\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait Foo\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -2684,16 +2590,10 @@ fn main() { let s<|>t = foo(); }\n                                         0,\n                                     ),\n                                     full_range: 16..31,\n-                                    focus_range: Some(\n-                                        22..25,\n-                                    ),\n+                                    focus_range: 22..25,\n                                     name: \"Bar\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait Bar\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait Bar\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -2703,16 +2603,10 @@ fn main() { let s<|>t = foo(); }\n                                         0,\n                                     ),\n                                     full_range: 32..44,\n-                                    focus_range: Some(\n-                                        39..41,\n-                                    ),\n+                                    focus_range: 39..41,\n                                     name: \"S1\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct S1\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct S1\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -2722,16 +2616,10 @@ fn main() { let s<|>t = foo(); }\n                                         0,\n                                     ),\n                                     full_range: 45..57,\n-                                    focus_range: Some(\n-                                        52..54,\n-                                    ),\n+                                    focus_range: 52..54,\n                                     name: \"S2\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct S2\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct S2\",\n                                 },\n                             },\n                         ],\n@@ -2759,16 +2647,10 @@ fn foo(ar<|>g: &impl Foo) {}\n                                         0,\n                                     ),\n                                     full_range: 0..12,\n-                                    focus_range: Some(\n-                                        6..9,\n-                                    ),\n+                                    focus_range: 6..9,\n                                     name: \"Foo\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait Foo\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait Foo\",\n                                 },\n                             },\n                         ],\n@@ -2799,16 +2681,10 @@ fn foo(ar<|>g: &impl Foo + Bar<S>) {}\n                                         0,\n                                     ),\n                                     full_range: 0..12,\n-                                    focus_range: Some(\n-                                        6..9,\n-                                    ),\n+                                    focus_range: 6..9,\n                                     name: \"Foo\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait Foo\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait Foo\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -2818,16 +2694,10 @@ fn foo(ar<|>g: &impl Foo + Bar<S>) {}\n                                         0,\n                                     ),\n                                     full_range: 13..28,\n-                                    focus_range: Some(\n-                                        19..22,\n-                                    ),\n+                                    focus_range: 19..22,\n                                     name: \"Bar\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait Bar\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait Bar\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -2837,16 +2707,10 @@ fn foo(ar<|>g: &impl Foo + Bar<S>) {}\n                                         0,\n                                     ),\n                                     full_range: 29..39,\n-                                    focus_range: Some(\n-                                        36..37,\n-                                    ),\n+                                    focus_range: 36..37,\n                                     name: \"S\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct S\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct S\",\n                                 },\n                             },\n                         ],\n@@ -2882,16 +2746,10 @@ mod future {\n                                         0,\n                                     ),\n                                     full_range: 101..163,\n-                                    focus_range: Some(\n-                                        140..146,\n-                                    ),\n+                                    focus_range: 140..146,\n                                     name: \"Future\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"pub trait Future\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"pub trait Future\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -2901,16 +2759,10 @@ mod future {\n                                         0,\n                                     ),\n                                     full_range: 0..9,\n-                                    focus_range: Some(\n-                                        7..8,\n-                                    ),\n+                                    focus_range: 7..8,\n                                     name: \"S\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct S\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct S\",\n                                 },\n                             },\n                         ],\n@@ -2939,16 +2791,10 @@ fn foo(ar<|>g: &impl Foo<S>) {}\n                                         0,\n                                     ),\n                                     full_range: 0..15,\n-                                    focus_range: Some(\n-                                        6..9,\n-                                    ),\n+                                    focus_range: 6..9,\n                                     name: \"Foo\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait Foo\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait Foo\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -2958,16 +2804,10 @@ fn foo(ar<|>g: &impl Foo<S>) {}\n                                         0,\n                                     ),\n                                     full_range: 16..27,\n-                                    focus_range: Some(\n-                                        23..24,\n-                                    ),\n+                                    focus_range: 23..24,\n                                     name: \"S\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct S\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct S\",\n                                 },\n                             },\n                         ],\n@@ -3001,16 +2841,10 @@ fn main() { let s<|>t = foo(); }\n                                         0,\n                                     ),\n                                     full_range: 42..55,\n-                                    focus_range: Some(\n-                                        49..50,\n-                                    ),\n+                                    focus_range: 49..50,\n                                     name: \"B\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct B\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct B\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -3020,16 +2854,10 @@ fn main() { let s<|>t = foo(); }\n                                         0,\n                                     ),\n                                     full_range: 0..12,\n-                                    focus_range: Some(\n-                                        6..9,\n-                                    ),\n+                                    focus_range: 6..9,\n                                     name: \"Foo\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait Foo\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait Foo\",\n                                 },\n                             },\n                         ],\n@@ -3057,16 +2885,10 @@ fn foo(ar<|>g: &dyn Foo) {}\n                                         0,\n                                     ),\n                                     full_range: 0..12,\n-                                    focus_range: Some(\n-                                        6..9,\n-                                    ),\n+                                    focus_range: 6..9,\n                                     name: \"Foo\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait Foo\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait Foo\",\n                                 },\n                             },\n                         ],\n@@ -3095,16 +2917,10 @@ fn foo(ar<|>g: &dyn Foo<S>) {}\n                                         0,\n                                     ),\n                                     full_range: 0..15,\n-                                    focus_range: Some(\n-                                        6..9,\n-                                    ),\n+                                    focus_range: 6..9,\n                                     name: \"Foo\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait Foo\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait Foo\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -3114,16 +2930,10 @@ fn foo(ar<|>g: &dyn Foo<S>) {}\n                                         0,\n                                     ),\n                                     full_range: 16..27,\n-                                    focus_range: Some(\n-                                        23..24,\n-                                    ),\n+                                    focus_range: 23..24,\n                                     name: \"S\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct S\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct S\",\n                                 },\n                             },\n                         ],\n@@ -3155,16 +2965,10 @@ fn foo(a<|>rg: &impl ImplTrait<B<dyn DynTrait<B<S>>>>) {}\n                                         0,\n                                     ),\n                                     full_range: 0..21,\n-                                    focus_range: Some(\n-                                        6..15,\n-                                    ),\n+                                    focus_range: 6..15,\n                                     name: \"ImplTrait\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait ImplTrait\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait ImplTrait\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -3174,16 +2978,10 @@ fn foo(a<|>rg: &impl ImplTrait<B<dyn DynTrait<B<S>>>>) {}\n                                         0,\n                                     ),\n                                     full_range: 43..57,\n-                                    focus_range: Some(\n-                                        50..51,\n-                                    ),\n+                                    focus_range: 50..51,\n                                     name: \"B\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct B\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct B\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -3193,16 +2991,10 @@ fn foo(a<|>rg: &impl ImplTrait<B<dyn DynTrait<B<S>>>>) {}\n                                         0,\n                                     ),\n                                     full_range: 22..42,\n-                                    focus_range: Some(\n-                                        28..36,\n-                                    ),\n+                                    focus_range: 28..36,\n                                     name: \"DynTrait\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait DynTrait\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait DynTrait\",\n                                 },\n                             },\n                             HoverGotoTypeData {\n@@ -3212,16 +3004,10 @@ fn foo(a<|>rg: &impl ImplTrait<B<dyn DynTrait<B<S>>>>) {}\n                                         0,\n                                     ),\n                                     full_range: 58..69,\n-                                    focus_range: Some(\n-                                        65..66,\n-                                    ),\n+                                    focus_range: 65..66,\n                                     name: \"S\",\n                                     kind: Struct,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"struct S\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"struct S\",\n                                 },\n                             },\n                         ],\n@@ -3260,16 +3046,10 @@ fn main() { let s<|>t = test().get(); }\n                                         0,\n                                     ),\n                                     full_range: 0..62,\n-                                    focus_range: Some(\n-                                        6..9,\n-                                    ),\n+                                    focus_range: 6..9,\n                                     name: \"Foo\",\n                                     kind: Trait,\n-                                    container_name: None,\n-                                    description: Some(\n-                                        \"trait Foo\",\n-                                    ),\n-                                    docs: None,\n+                                    description: \"trait Foo\",\n                                 },\n                             },\n                         ],"}, {"sha": "8c00a71058c6bac32901eeca661d67bd4dcdccd2", "filename": "crates/ide/src/references.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/25185c1418022868e2f7ec1599e32a34d63e8314/crates%2Fide%2Fsrc%2Freferences.rs", "raw_url": "https://github.com/rust-lang/rust/raw/25185c1418022868e2f7ec1599e32a34d63e8314/crates%2Fide%2Fsrc%2Freferences.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Freferences.rs?ref=25185c1418022868e2f7ec1599e32a34d63e8314", "patch": "@@ -278,7 +278,7 @@ fn try_find_self_references(\n             full_range: self_param.syntax().text_range(),\n             focus_range: Some(param_self_token.text_range()),\n             name: param_self_token.text().clone(),\n-            kind: SymbolKind::SelfParam,\n+            kind: Some(SymbolKind::SelfParam),\n             container_name: None,\n             description: None,\n             docs: None,"}, {"sha": "ff386be80495178b5951aac4e1c30aaae6f34b1b", "filename": "crates/ide/src/runnables.rs", "status": "modified", "additions": 17, "deletions": 122, "changes": 139, "blob_url": "https://github.com/rust-lang/rust/blob/25185c1418022868e2f7ec1599e32a34d63e8314/crates%2Fide%2Fsrc%2Frunnables.rs", "raw_url": "https://github.com/rust-lang/rust/raw/25185c1418022868e2f7ec1599e32a34d63e8314/crates%2Fide%2Fsrc%2Frunnables.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Frunnables.rs?ref=25185c1418022868e2f7ec1599e32a34d63e8314", "patch": "@@ -208,7 +208,7 @@ fn module_def_doctest(sema: &Semantics<RootDatabase>, def: hir::ModuleDef) -> Op\n     nav.focus_range = None;\n     nav.description = None;\n     nav.docs = None;\n-    nav.kind = SymbolKind::DocTest;\n+    nav.kind = None;\n     let res = Runnable { nav, kind: RunnableKind::DocTest { test_id }, cfg: attrs.cfg() };\n     Some(res)\n }\n@@ -352,14 +352,9 @@ fn bench() {}\n                                 0,\n                             ),\n                             full_range: 1..13,\n-                            focus_range: Some(\n-                                4..8,\n-                            ),\n+                            focus_range: 4..8,\n                             name: \"main\",\n                             kind: Function,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: Bin,\n                         cfg: None,\n@@ -370,14 +365,9 @@ fn bench() {}\n                                 0,\n                             ),\n                             full_range: 15..39,\n-                            focus_range: Some(\n-                                26..34,\n-                            ),\n+                            focus_range: 26..34,\n                             name: \"test_foo\",\n                             kind: Function,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: Test {\n                             test_id: Path(\n@@ -395,14 +385,9 @@ fn bench() {}\n                                 0,\n                             ),\n                             full_range: 41..75,\n-                            focus_range: Some(\n-                                62..70,\n-                            ),\n+                            focus_range: 62..70,\n                             name: \"test_foo\",\n                             kind: Function,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: Test {\n                             test_id: Path(\n@@ -420,14 +405,9 @@ fn bench() {}\n                                 0,\n                             ),\n                             full_range: 77..99,\n-                            focus_range: Some(\n-                                89..94,\n-                            ),\n+                            focus_range: 89..94,\n                             name: \"bench\",\n                             kind: Function,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: Bench {\n                             test_id: Path(\n@@ -517,14 +497,9 @@ struct StructWithRunnable(String);\n                                 0,\n                             ),\n                             full_range: 1..13,\n-                            focus_range: Some(\n-                                4..8,\n-                            ),\n+                            focus_range: 4..8,\n                             name: \"main\",\n                             kind: Function,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: Bin,\n                         cfg: None,\n@@ -535,12 +510,7 @@ struct StructWithRunnable(String);\n                                 0,\n                             ),\n                             full_range: 15..74,\n-                            focus_range: None,\n                             name: \"should_have_runnable\",\n-                            kind: DocTest,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: DocTest {\n                             test_id: Path(\n@@ -555,12 +525,7 @@ struct StructWithRunnable(String);\n                                 0,\n                             ),\n                             full_range: 76..148,\n-                            focus_range: None,\n                             name: \"should_have_runnable_1\",\n-                            kind: DocTest,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: DocTest {\n                             test_id: Path(\n@@ -575,12 +540,7 @@ struct StructWithRunnable(String);\n                                 0,\n                             ),\n                             full_range: 150..254,\n-                            focus_range: None,\n                             name: \"should_have_runnable_2\",\n-                            kind: DocTest,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: DocTest {\n                             test_id: Path(\n@@ -595,12 +555,7 @@ struct StructWithRunnable(String);\n                                 0,\n                             ),\n                             full_range: 756..821,\n-                            focus_range: None,\n                             name: \"StructWithRunnable\",\n-                            kind: DocTest,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: DocTest {\n                             test_id: Path(\n@@ -639,14 +594,9 @@ impl Data {\n                                 0,\n                             ),\n                             full_range: 1..13,\n-                            focus_range: Some(\n-                                4..8,\n-                            ),\n+                            focus_range: 4..8,\n                             name: \"main\",\n                             kind: Function,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: Bin,\n                         cfg: None,\n@@ -657,12 +607,7 @@ impl Data {\n                                 0,\n                             ),\n                             full_range: 44..98,\n-                            focus_range: None,\n                             name: \"foo\",\n-                            kind: DocTest,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: DocTest {\n                             test_id: Path(\n@@ -696,14 +641,9 @@ mod test_mod {\n                                 0,\n                             ),\n                             full_range: 1..51,\n-                            focus_range: Some(\n-                                5..13,\n-                            ),\n+                            focus_range: 5..13,\n                             name: \"test_mod\",\n                             kind: Module,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: TestMod {\n                             path: \"test_mod\",\n@@ -716,14 +656,9 @@ mod test_mod {\n                                 0,\n                             ),\n                             full_range: 20..49,\n-                            focus_range: Some(\n-                                35..44,\n-                            ),\n+                            focus_range: 35..44,\n                             name: \"test_foo1\",\n                             kind: Function,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: Test {\n                             test_id: Path(\n@@ -776,14 +711,9 @@ mod root_tests {\n                                 0,\n                             ),\n                             full_range: 22..323,\n-                            focus_range: Some(\n-                                26..40,\n-                            ),\n+                            focus_range: 26..40,\n                             name: \"nested_tests_0\",\n                             kind: Module,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: TestMod {\n                             path: \"root_tests::nested_tests_0\",\n@@ -796,14 +726,9 @@ mod root_tests {\n                                 0,\n                             ),\n                             full_range: 51..192,\n-                            focus_range: Some(\n-                                55..69,\n-                            ),\n+                            focus_range: 55..69,\n                             name: \"nested_tests_1\",\n                             kind: Module,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: TestMod {\n                             path: \"root_tests::nested_tests_0::nested_tests_1\",\n@@ -816,14 +741,9 @@ mod root_tests {\n                                 0,\n                             ),\n                             full_range: 84..126,\n-                            focus_range: Some(\n-                                107..121,\n-                            ),\n+                            focus_range: 107..121,\n                             name: \"nested_test_11\",\n                             kind: Function,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: Test {\n                             test_id: Path(\n@@ -841,14 +761,9 @@ mod root_tests {\n                                 0,\n                             ),\n                             full_range: 140..182,\n-                            focus_range: Some(\n-                                163..177,\n-                            ),\n+                            focus_range: 163..177,\n                             name: \"nested_test_12\",\n                             kind: Function,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: Test {\n                             test_id: Path(\n@@ -866,14 +781,9 @@ mod root_tests {\n                                 0,\n                             ),\n                             full_range: 202..286,\n-                            focus_range: Some(\n-                                206..220,\n-                            ),\n+                            focus_range: 206..220,\n                             name: \"nested_tests_2\",\n                             kind: Module,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: TestMod {\n                             path: \"root_tests::nested_tests_0::nested_tests_2\",\n@@ -886,14 +796,9 @@ mod root_tests {\n                                 0,\n                             ),\n                             full_range: 235..276,\n-                            focus_range: Some(\n-                                258..271,\n-                            ),\n+                            focus_range: 258..271,\n                             name: \"nested_test_2\",\n                             kind: Function,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: Test {\n                             test_id: Path(\n@@ -929,14 +834,9 @@ fn test_foo1() {}\n                                 0,\n                             ),\n                             full_range: 1..50,\n-                            focus_range: Some(\n-                                36..45,\n-                            ),\n+                            focus_range: 36..45,\n                             name: \"test_foo1\",\n                             kind: Function,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: Test {\n                             test_id: Path(\n@@ -979,14 +879,9 @@ fn test_foo1() {}\n                                 0,\n                             ),\n                             full_range: 1..72,\n-                            focus_range: Some(\n-                                58..67,\n-                            ),\n+                            focus_range: 58..67,\n                             name: \"test_foo1\",\n                             kind: Function,\n-                            container_name: None,\n-                            description: None,\n-                            docs: None,\n                         },\n                         kind: Test {\n                             test_id: Path("}, {"sha": "66f8bee991579feea8218dca29cc620d8a67e44b", "filename": "crates/rust-analyzer/src/handlers.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/25185c1418022868e2f7ec1599e32a34d63e8314/crates%2Frust-analyzer%2Fsrc%2Fhandlers.rs", "raw_url": "https://github.com/rust-lang/rust/raw/25185c1418022868e2f7ec1599e32a34d63e8314/crates%2Frust-analyzer%2Fsrc%2Fhandlers.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fhandlers.rs?ref=25185c1418022868e2f7ec1599e32a34d63e8314", "patch": "@@ -385,7 +385,10 @@ pub(crate) fn handle_workspace_symbol(\n             #[allow(deprecated)]\n             let info = SymbolInformation {\n                 name: nav.name.to_string(),\n-                kind: to_proto::symbol_kind(nav.kind),\n+                kind: nav\n+                    .kind\n+                    .map(to_proto::symbol_kind)\n+                    .unwrap_or(lsp_types::SymbolKind::Variable),\n                 tags: None,\n                 location: to_proto::location_from_nav(snap, nav)?,\n                 container_name,\n@@ -1263,7 +1266,7 @@ pub(crate) fn handle_call_hierarchy_prepare(\n     let RangeInfo { range: _, info: navs } = nav_info;\n     let res = navs\n         .into_iter()\n-        .filter(|it| it.kind == SymbolKind::Function)\n+        .filter(|it| it.kind == Some(SymbolKind::Function))\n         .map(|it| to_proto::call_hierarchy_item(&snap, it))\n         .collect::<Result<Vec<_>>>()?;\n "}, {"sha": "6b2302803a64360323d4e1fcb4af5d10ed5bffa3", "filename": "crates/rust-analyzer/src/to_proto.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/25185c1418022868e2f7ec1599e32a34d63e8314/crates%2Frust-analyzer%2Fsrc%2Fto_proto.rs", "raw_url": "https://github.com/rust-lang/rust/raw/25185c1418022868e2f7ec1599e32a34d63e8314/crates%2Frust-analyzer%2Fsrc%2Fto_proto.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fto_proto.rs?ref=25185c1418022868e2f7ec1599e32a34d63e8314", "patch": "@@ -43,10 +43,9 @@ pub(crate) fn symbol_kind(symbol_kind: SymbolKind) -> lsp_types::SymbolKind {\n         SymbolKind::Static => lsp_types::SymbolKind::Constant,\n         SymbolKind::Const => lsp_types::SymbolKind::Constant,\n         SymbolKind::Impl => lsp_types::SymbolKind::Object,\n-        SymbolKind::Local\n-        | SymbolKind::SelfParam\n-        | SymbolKind::LifetimeParam\n-        | SymbolKind::DocTest => lsp_types::SymbolKind::Variable,\n+        SymbolKind::Local | SymbolKind::SelfParam | SymbolKind::LifetimeParam => {\n+            lsp_types::SymbolKind::Variable\n+        }\n         SymbolKind::Union => lsp_types::SymbolKind::Struct,\n     }\n }\n@@ -722,7 +721,7 @@ pub(crate) fn call_hierarchy_item(\n ) -> Result<lsp_types::CallHierarchyItem> {\n     let name = target.name.to_string();\n     let detail = target.description.clone();\n-    let kind = symbol_kind(target.kind);\n+    let kind = target.kind.map(symbol_kind).unwrap_or(lsp_types::SymbolKind::Function);\n     let (uri, range, selection_range) = location_info(snap, target)?;\n     Ok(lsp_types::CallHierarchyItem {\n         name,"}]}