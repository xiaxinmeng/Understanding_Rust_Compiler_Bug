{"sha": "b1f523525a8ae906d82ef0dccf716aa3b0cd6670", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIxZjUyMzUyNWE4YWU5MDZkODJlZjBkY2NmNzE2YWEzYjBjZDY2NzA=", "commit": {"author": {"name": "Steven Fackler", "email": "sfackler@gmail.com", "date": "2014-03-15T22:13:00Z"}, "committer": {"name": "Steven Fackler", "email": "sfackler@gmail.com", "date": "2014-03-15T22:13:00Z"}, "message": "Remove most ~[] usage in liburl", "tree": {"sha": "c08314284814bd870351a66cd6cfd60c89a7c2ed", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c08314284814bd870351a66cd6cfd60c89a7c2ed"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b1f523525a8ae906d82ef0dccf716aa3b0cd6670", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b1f523525a8ae906d82ef0dccf716aa3b0cd6670", "html_url": "https://github.com/rust-lang/rust/commit/b1f523525a8ae906d82ef0dccf716aa3b0cd6670", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b1f523525a8ae906d82ef0dccf716aa3b0cd6670/comments", "author": {"login": "sfackler", "id": 1455697, "node_id": "MDQ6VXNlcjE0NTU2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sfackler", "html_url": "https://github.com/sfackler", "followers_url": "https://api.github.com/users/sfackler/followers", "following_url": "https://api.github.com/users/sfackler/following{/other_user}", "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}", "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions", "organizations_url": "https://api.github.com/users/sfackler/orgs", "repos_url": "https://api.github.com/users/sfackler/repos", "events_url": "https://api.github.com/users/sfackler/events{/privacy}", "received_events_url": "https://api.github.com/users/sfackler/received_events", "type": "User", "site_admin": false}, "committer": {"login": "sfackler", "id": 1455697, "node_id": "MDQ6VXNlcjE0NTU2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sfackler", "html_url": "https://github.com/sfackler", "followers_url": "https://api.github.com/users/sfackler/followers", "following_url": "https://api.github.com/users/sfackler/following{/other_user}", "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}", "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions", "organizations_url": "https://api.github.com/users/sfackler/orgs", "repos_url": "https://api.github.com/users/sfackler/repos", "events_url": "https://api.github.com/users/sfackler/events{/privacy}", "received_events_url": "https://api.github.com/users/sfackler/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "352c5e7eb767401e426e526acf5c8fe0311d8c30", "url": "https://api.github.com/repos/rust-lang/rust/commits/352c5e7eb767401e426e526acf5c8fe0311d8c30", "html_url": "https://github.com/rust-lang/rust/commit/352c5e7eb767401e426e526acf5c8fe0311d8c30"}], "stats": {"total": 47, "additions": 24, "deletions": 23}, "files": [{"sha": "41a67790c94fa214b30e77bf830db81cef792d05", "filename": "src/liburl/lib.rs", "status": "modified", "additions": 24, "deletions": 23, "changes": 47, "blob_url": "https://github.com/rust-lang/rust/blob/b1f523525a8ae906d82ef0dccf716aa3b0cd6670/src%2Fliburl%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b1f523525a8ae906d82ef0dccf716aa3b0cd6670/src%2Fliburl%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliburl%2Flib.rs?ref=b1f523525a8ae906d82ef0dccf716aa3b0cd6670", "patch": "@@ -25,6 +25,7 @@ use std::hash::Hash;\n use std::io::BufReader;\n use std::from_str::FromStr;\n use std::uint;\n+use std::vec_ng::Vec;\n \n use collections::HashMap;\n \n@@ -42,7 +43,7 @@ use collections::HashMap;\n ///                 host: ~\"example.com\",\n ///                 port: Some(~\"8080\"),\n ///                 path: ~\"/foo/bar\",\n-///                 query: ~[(~\"baz\", ~\"qux\")],\n+///                 query: vec!((~\"baz\", ~\"qux\")),\n ///                 fragment: Some(~\"quz\") };\n /// // https://username@example.com:8080/foo/bar?baz=qux#quz\n /// ```\n@@ -58,7 +59,7 @@ pub struct Url {\n     port: Option<~str>,\n     /// The path component of a URL, for example `/foo/bar`.\n     path: ~str,\n-    /// The query component of a URL.  `~[(~\"baz\", ~\"qux\")]` represents the\n+    /// The query component of a URL.  `vec!((~\"baz\", ~\"qux\"))` represents the\n     /// fragment `baz=qux` in the above example.\n     query: Query,\n     /// The fragment component, such as `quz`.  Doesn't include the leading `#` character.\n@@ -69,7 +70,7 @@ pub struct Url {\n pub struct Path {\n     /// The path component of a URL, for example `/foo/bar`.\n     path: ~str,\n-    /// The query component of a URL.  `~[(~\"baz\", ~\"qux\")]` represents the\n+    /// The query component of a URL.  `vec!((~\"baz\", ~\"qux\"))` represents the\n     /// fragment `baz=qux` in the above example.\n     query: Query,\n     /// The fragment component, such as `quz`.  Doesn't include the leading `#` character.\n@@ -86,7 +87,7 @@ pub struct UserInfo {\n }\n \n /// Represents the query component of a URI.\n-pub type Query = ~[(~str, ~str)];\n+pub type Query = Vec<(~str, ~str)>;\n \n impl Url {\n     pub fn new(scheme: ~str,\n@@ -298,7 +299,7 @@ fn encode_plus(s: &str) -> ~str {\n /**\n  * Encode a hashmap to the 'application/x-www-form-urlencoded' media type.\n  */\n-pub fn encode_form_urlencoded(m: &HashMap<~str, ~[~str]>) -> ~str {\n+pub fn encode_form_urlencoded(m: &HashMap<~str, Vec<~str>>) -> ~str {\n     let mut out = ~\"\";\n     let mut first = true;\n \n@@ -324,7 +325,7 @@ pub fn encode_form_urlencoded(m: &HashMap<~str, ~[~str]>) -> ~str {\n  * Decode a string encoded with the 'application/x-www-form-urlencoded' media\n  * type into a hashmap.\n  */\n-pub fn decode_form_urlencoded(s: &[u8]) -> HashMap<~str, ~[~str]> {\n+pub fn decode_form_urlencoded(s: &[u8]) -> HashMap<~str, Vec<~str>> {\n     let mut rdr = BufReader::new(s);\n     let mut m = HashMap::new();\n     let mut key = ~\"\";\n@@ -342,7 +343,7 @@ pub fn decode_form_urlencoded(s: &[u8]) -> HashMap<~str, ~[~str]> {\n                 if key != ~\"\" && value != ~\"\" {\n                     let mut values = match m.pop(&key) {\n                         Some(values) => values,\n-                        None => ~[],\n+                        None => vec!(),\n                     };\n \n                     values.push(value);\n@@ -380,7 +381,7 @@ pub fn decode_form_urlencoded(s: &[u8]) -> HashMap<~str, ~[~str]> {\n     if key != ~\"\" && value != ~\"\" {\n         let mut values = match m.pop(&key) {\n             Some(values) => values,\n-            None => ~[],\n+            None => vec!(),\n         };\n \n         values.push(value);\n@@ -427,7 +428,7 @@ impl fmt::Show for UserInfo {\n }\n \n fn query_from_str(rawquery: &str) -> Query {\n-    let mut query: Query = ~[];\n+    let mut query: Query = vec!();\n     if !rawquery.is_empty() {\n         for p in rawquery.split('&') {\n             let (k, v) = split_char_first(p, '=');\n@@ -443,7 +444,7 @@ fn query_from_str(rawquery: &str) -> Query {\n  * # Example\n  *\n  * ```rust\n- * let query = ~[(~\"title\", ~\"The Village\"), (~\"north\", ~\"52.91\"), (~\"west\", ~\"4.10\")];\n+ * let query = vec!((~\"title\", ~\"The Village\"), (~\"north\", ~\"52.91\"), (~\"west\", ~\"4.10\"));\n  * println!(\"{}\", url::query_to_str(&query));  // title=The%20Village&north=52.91&west=4.10\n  * ```\n  */\n@@ -709,9 +710,9 @@ fn get_query_fragment(rawurl: &str) ->\n             let f = decode_component(rawurl.slice(\n                                                 1,\n                                                 rawurl.len()));\n-            return Ok((~[], Some(f)));\n+            return Ok((vec!(), Some(f)));\n         } else {\n-            return Ok((~[], None));\n+            return Ok((vec!(), None));\n         }\n     }\n     let (q, r) = split_char_first(rawurl.slice(1, rawurl.len()), '#');\n@@ -953,7 +954,7 @@ fn test_get_path() {\n \n #[cfg(test)]\n mod tests {\n-    use {encode_form_urlencoded, decode_form_urlencoded, decode_component,\n+    use {encode_form_urlencoded, decode_form_urlencoded,\n          decode, encode, from_str, encode_component, decode_component,\n          path_from_str, UserInfo, get_scheme};\n \n@@ -970,7 +971,7 @@ mod tests {\n         assert_eq!(&u.host, &~\"rust-lang.org\");\n         assert_eq!(&u.port, &Some(~\"8080\"));\n         assert_eq!(&u.path, &~\"/doc/~u\");\n-        assert_eq!(&u.query, &~[(~\"s\", ~\"v\")]);\n+        assert_eq!(&u.query, &vec!((~\"s\", ~\"v\")));\n         assert_eq!(&u.fragment, &Some(~\"something\"));\n     }\n \n@@ -981,7 +982,7 @@ mod tests {\n         let up = path_from_str(path);\n         let u = up.unwrap();\n         assert_eq!(&u.path, &~\"/doc/~u\");\n-        assert_eq!(&u.query, &~[(~\"s\", ~\"v\")]);\n+        assert_eq!(&u.query, &vec!((~\"s\", ~\"v\")));\n         assert_eq!(&u.fragment, &Some(~\"something\"));\n     }\n \n@@ -1121,15 +1122,15 @@ mod tests {\n         let url = ~\"http://rust-lang.org/doc%20uments?ba%25d%20=%23%26%2B\";\n         let u = from_str(url).unwrap();\n         assert!(u.path == ~\"/doc uments\");\n-        assert!(u.query == ~[(~\"ba%d \", ~\"#&+\")]);\n+        assert!(u.query == vec!((~\"ba%d \", ~\"#&+\")));\n     }\n \n     #[test]\n     fn test_path_component_encoding() {\n         let path = ~\"/doc%20uments?ba%25d%20=%23%26%2B\";\n         let p = path_from_str(path).unwrap();\n         assert!(p.path == ~\"/doc uments\");\n-        assert!(p.query == ~[(~\"ba%d \", ~\"#&+\")]);\n+        assert!(p.query == vec!((~\"ba%d \", ~\"#&+\")));\n     }\n \n     #[test]\n@@ -1256,16 +1257,16 @@ mod tests {\n         let mut m = HashMap::new();\n         assert_eq!(encode_form_urlencoded(&m), ~\"\");\n \n-        m.insert(~\"\", ~[]);\n-        m.insert(~\"foo\", ~[]);\n+        m.insert(~\"\", vec!());\n+        m.insert(~\"foo\", vec!());\n         assert_eq!(encode_form_urlencoded(&m), ~\"\");\n \n         let mut m = HashMap::new();\n-        m.insert(~\"foo\", ~[~\"bar\", ~\"123\"]);\n+        m.insert(~\"foo\", vec!(~\"bar\", ~\"123\"));\n         assert_eq!(encode_form_urlencoded(&m), ~\"foo=bar&foo=123\");\n \n         let mut m = HashMap::new();\n-        m.insert(~\"foo bar\", ~[~\"abc\", ~\"12 = 34\"]);\n+        m.insert(~\"foo bar\", vec!(~\"abc\", ~\"12 = 34\"));\n         assert!(encode_form_urlencoded(&m) ==\n             ~\"foo+bar=abc&foo+bar=12+%3D+34\");\n     }\n@@ -1277,7 +1278,7 @@ mod tests {\n         let s = \"a=1&foo+bar=abc&foo+bar=12+%3D+34\".as_bytes();\n         let form = decode_form_urlencoded(s);\n         assert_eq!(form.len(), 2);\n-        assert_eq!(form.get(&~\"a\"), &~[~\"1\"]);\n-        assert_eq!(form.get(&~\"foo bar\"), &~[~\"abc\", ~\"12 = 34\"]);\n+        assert_eq!(form.get(&~\"a\"), &vec!(~\"1\"));\n+        assert_eq!(form.get(&~\"foo bar\"), &vec!(~\"abc\", ~\"12 = 34\"));\n     }\n }"}]}