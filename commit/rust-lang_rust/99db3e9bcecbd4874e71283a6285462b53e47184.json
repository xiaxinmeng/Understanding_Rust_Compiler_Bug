{"sha": "99db3e9bcecbd4874e71283a6285462b53e47184", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk5ZGIzZTliY2VjYmQ0ODc0ZTcxMjgzYTYyODU0NjJiNTNlNDcxODQ=", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2018-10-09T16:48:44Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2018-10-11T10:51:53Z"}, "message": "impl Eq+Hash for TyLayout", "tree": {"sha": "8af68c9deb8a37f9defeeed5f05354f42abe0b24", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8af68c9deb8a37f9defeeed5f05354f42abe0b24"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/99db3e9bcecbd4874e71283a6285462b53e47184", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/99db3e9bcecbd4874e71283a6285462b53e47184", "html_url": "https://github.com/rust-lang/rust/commit/99db3e9bcecbd4874e71283a6285462b53e47184", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/99db3e9bcecbd4874e71283a6285462b53e47184/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cb6eeddd4dcefa4b71bb4b6bb087d05ad8e82145", "url": "https://api.github.com/repos/rust-lang/rust/commits/cb6eeddd4dcefa4b71bb4b6bb087d05ad8e82145", "html_url": "https://github.com/rust-lang/rust/commit/cb6eeddd4dcefa4b71bb4b6bb087d05ad8e82145"}], "stats": {"total": 25, "additions": 2, "deletions": 23}, "files": [{"sha": "c72a5894b6ac7f54f0b83bf1f9ed7bcf70e78479", "filename": "src/librustc_mir/interpret/operand.rs", "status": "modified", "additions": 1, "deletions": 22, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/99db3e9bcecbd4874e71283a6285462b53e47184/src%2Flibrustc_mir%2Finterpret%2Foperand.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99db3e9bcecbd4874e71283a6285462b53e47184/src%2Flibrustc_mir%2Finterpret%2Foperand.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Foperand.rs?ref=99db3e9bcecbd4874e71283a6285462b53e47184", "patch": "@@ -11,7 +11,6 @@\n //! Functions concerning immediate values and operands, and reading from operands.\n //! All high-level functions to read from memory work on operands as sources.\n \n-use std::hash::{Hash, Hasher};\n use std::convert::TryInto;\n \n use rustc::{mir, ty};\n@@ -290,7 +289,7 @@ impl<Tag> Operand<Tag> {\n     }\n }\n \n-#[derive(Copy, Clone, Debug)]\n+#[derive(Copy, Clone, Debug, Hash, PartialEq, Eq)]\n pub struct OpTy<'tcx, Tag=()> {\n     crate op: Operand<Tag>, // ideally we'd make this private, but const_prop needs this\n     pub layout: TyLayout<'tcx>,\n@@ -324,26 +323,6 @@ impl<'tcx, Tag> From<ValTy<'tcx, Tag>> for OpTy<'tcx, Tag> {\n     }\n }\n \n-// Validation needs to hash OpTy, but we cannot hash Layout -- so we just hash the type\n-impl<'tcx, Tag> Hash for OpTy<'tcx, Tag>\n-    where Tag: Hash\n-{\n-    fn hash<H: Hasher>(&self, state: &mut H) {\n-        self.op.hash(state);\n-        self.layout.ty.hash(state);\n-    }\n-}\n-impl<'tcx, Tag> PartialEq for OpTy<'tcx, Tag>\n-    where Tag: PartialEq\n-{\n-    fn eq(&self, other: &Self) -> bool {\n-        self.op == other.op && self.layout.ty == other.layout.ty\n-    }\n-}\n-impl<'tcx, Tag> Eq for OpTy<'tcx, Tag>\n-    where Tag: Eq\n-{}\n-\n impl<'tcx, Tag> OpTy<'tcx, Tag>\n {\n     #[inline]"}, {"sha": "6b28fd091748f14114b21d7224e82620b5a65d55", "filename": "src/librustc_target/abi/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99db3e9bcecbd4874e71283a6285462b53e47184/src%2Flibrustc_target%2Fabi%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99db3e9bcecbd4874e71283a6285462b53e47184/src%2Flibrustc_target%2Fabi%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_target%2Fabi%2Fmod.rs?ref=99db3e9bcecbd4874e71283a6285462b53e47184", "patch": "@@ -874,7 +874,7 @@ impl LayoutDetails {\n /// to those obtained from `layout_of(ty)`, as we need to produce\n /// layouts for which Rust types do not exist, such as enum variants\n /// or synthetic fields of enums (i.e. discriminants) and fat pointers.\n-#[derive(Copy, Clone, Debug)]\n+#[derive(Copy, Clone, Debug, PartialEq, Eq, Hash)]\n pub struct TyLayout<'a, Ty> {\n     pub ty: Ty,\n     pub details: &'a LayoutDetails"}]}