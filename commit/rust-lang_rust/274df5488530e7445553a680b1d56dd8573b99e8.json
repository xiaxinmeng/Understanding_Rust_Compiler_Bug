{"sha": "274df5488530e7445553a680b1d56dd8573b99e8", "node_id": "C_kwDOAAsO6NoAKDI3NGRmNTQ4ODUzMGU3NDQ1NTUzYTY4MGIxZDU2ZGQ4NTczYjk5ZTg", "commit": {"author": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2022-10-28T21:10:10Z"}, "committer": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2022-10-28T21:10:10Z"}, "message": "feat: Clicking the status bar item stops and starts the server", "tree": {"sha": "cb6bb53c5cbbed7533118f443b26891981084fb5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cb6bb53c5cbbed7533118f443b26891981084fb5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/274df5488530e7445553a680b1d56dd8573b99e8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/274df5488530e7445553a680b1d56dd8573b99e8", "html_url": "https://github.com/rust-lang/rust/commit/274df5488530e7445553a680b1d56dd8573b99e8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/274df5488530e7445553a680b1d56dd8573b99e8/comments", "author": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d022e0ec536948ced38ac67dec0d64c312264f7c", "url": "https://api.github.com/repos/rust-lang/rust/commits/d022e0ec536948ced38ac67dec0d64c312264f7c", "html_url": "https://github.com/rust-lang/rust/commit/d022e0ec536948ced38ac67dec0d64c312264f7c"}], "stats": {"total": 17, "additions": 11, "deletions": 6}, "files": [{"sha": "8592950e1023d81d67d87b2b4b746420d6ae9081", "filename": "editors/code/src/ctx.ts", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/274df5488530e7445553a680b1d56dd8573b99e8/editors%2Fcode%2Fsrc%2Fctx.ts", "raw_url": "https://github.com/rust-lang/rust/raw/274df5488530e7445553a680b1d56dd8573b99e8/editors%2Fcode%2Fsrc%2Fctx.ts", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fsrc%2Fctx.ts?ref=274df5488530e7445553a680b1d56dd8573b99e8", "patch": "@@ -204,13 +204,13 @@ export class Ctx {\n         }\n     }\n \n-    setServerStatus(status: ServerStatusParams) {\n+    setServerStatus(status: ServerStatusParams | { health: \"stopped\" }) {\n         let icon = \"\";\n         const statusBar = this.statusBar;\n         switch (status.health) {\n             case \"ok\":\n-                statusBar.tooltip = status.message ?? \"Ready\";\n-                statusBar.command = undefined;\n+                statusBar.tooltip = (status.message ?? \"Ready\") + \"Click to stop.\";\n+                statusBar.command = \"rust-analyzer.stopServer\";\n                 statusBar.color = undefined;\n                 statusBar.backgroundColor = undefined;\n                 break;\n@@ -234,6 +234,13 @@ export class Ctx {\n                 statusBar.backgroundColor = new vscode.ThemeColor(\"statusBarItem.errorBackground\");\n                 icon = \"$(error) \";\n                 break;\n+            case \"stopped\":\n+                statusBar.tooltip = \"Server is stopped. Click to start.\";\n+                statusBar.command = \"rust-analyzer.startServer\";\n+                statusBar.color = undefined;\n+                statusBar.backgroundColor = undefined;\n+                statusBar.text = `$(stop-circle) rust-analyzer`;\n+                return;\n         }\n         if (!status.quiescent) icon = \"$(sync~spin) \";\n         statusBar.text = `${icon}rust-analyzer`;"}, {"sha": "59705334726671c0e8a6e102088d32e679407661", "filename": "editors/code/src/main.ts", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/274df5488530e7445553a680b1d56dd8573b99e8/editors%2Fcode%2Fsrc%2Fmain.ts", "raw_url": "https://github.com/rust-lang/rust/raw/274df5488530e7445553a680b1d56dd8573b99e8/editors%2Fcode%2Fsrc%2Fmain.ts", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fsrc%2Fmain.ts?ref=274df5488530e7445553a680b1d56dd8573b99e8", "patch": "@@ -120,9 +120,7 @@ function createCommands(): Record<string, CommandFactory> {\n                 // FIXME: We should re-use the client, that is ctx.deactivate() if none of the configs have changed\n                 await ctx.stop();\n                 ctx.setServerStatus({\n-                    health: \"ok\",\n-                    quiescent: true,\n-                    message: \"server is not running\",\n+                    health: \"stopped\",\n                 });\n             },\n         },"}]}