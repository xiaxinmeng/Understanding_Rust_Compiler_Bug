{"sha": "b8bd1d0826b8f792eccb97a6560d002832bff562", "node_id": "C_kwDOAAsO6NoAKGI4YmQxZDA4MjZiOGY3OTJlY2NiOTdhNjU2MGQwMDI4MzJiZmY1NjI", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2022-12-09T05:09:56Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2022-12-13T18:06:14Z"}, "message": "Fix span for `&mut ` removal suggestion", "tree": {"sha": "a69cc6ff5277aea6c73db805d01be6d9253934ef", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a69cc6ff5277aea6c73db805d01be6d9253934ef"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b8bd1d0826b8f792eccb97a6560d002832bff562", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b8bd1d0826b8f792eccb97a6560d002832bff562", "html_url": "https://github.com/rust-lang/rust/commit/b8bd1d0826b8f792eccb97a6560d002832bff562", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b8bd1d0826b8f792eccb97a6560d002832bff562/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dd72b1a0df1277eb7abba9b9aab41456eeb8894a", "url": "https://api.github.com/repos/rust-lang/rust/commits/dd72b1a0df1277eb7abba9b9aab41456eeb8894a", "html_url": "https://github.com/rust-lang/rust/commit/dd72b1a0df1277eb7abba9b9aab41456eeb8894a"}], "stats": {"total": 59, "additions": 30, "deletions": 29}, "files": [{"sha": "033e42836459810a69eb2cc5c81df02c160072f4", "filename": "compiler/rustc_borrowck/src/diagnostics/move_errors.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b8bd1d0826b8f792eccb97a6560d002832bff562/compiler%2Frustc_borrowck%2Fsrc%2Fdiagnostics%2Fmove_errors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b8bd1d0826b8f792eccb97a6560d002832bff562/compiler%2Frustc_borrowck%2Fsrc%2Fdiagnostics%2Fmove_errors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Fdiagnostics%2Fmove_errors.rs?ref=b8bd1d0826b8f792eccb97a6560d002832bff562", "patch": "@@ -481,6 +481,7 @@ impl<'a, 'tcx> MirBorrowckCtxt<'a, 'tcx> {\n                 let (pat_span, suggestion, to_remove) = if inner_pat_snippet.starts_with(\"mut\")\n                     && inner_pat_snippet[\"mut\".len()..].starts_with(rustc_lexer::is_whitespace)\n                 {\n+                    let inner_pat_snippet = inner_pat_snippet[\"mut\".len()..].trim_start();\n                     let pat_span = pat_span.with_hi(\n                         pat_span.lo()\n                             + BytePos((pat_snippet.len() - inner_pat_snippet.len()) as u32),"}, {"sha": "0dc5e64e4ff3022ee92075d07b49bd3c2134729e", "filename": "src/test/ui/borrowck/borrowck-vec-pattern-nesting.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b8bd1d0826b8f792eccb97a6560d002832bff562/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-vec-pattern-nesting.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b8bd1d0826b8f792eccb97a6560d002832bff562/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-vec-pattern-nesting.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-vec-pattern-nesting.stderr?ref=b8bd1d0826b8f792eccb97a6560d002832bff562", "patch": "@@ -37,7 +37,7 @@ LL |         &mut [_a,\n help: consider removing the mutable borrow\n    |\n LL -         &mut [_a,\n-LL +         mut [_a,\n+LL +         [_a,\n    |\n \n error[E0508]: cannot move out of type `[Box<isize>]`, a non-copy slice\n@@ -69,7 +69,7 @@ LL |          _b] => {}\n help: consider removing the mutable borrow\n    |\n LL -         &mut [\n-LL +         mut [\n+LL +         [\n    |\n \n error[E0508]: cannot move out of type `[Box<isize>]`, a non-copy slice\n@@ -102,7 +102,7 @@ LL |         &mut [_a, _b, _c] => {}\n help: consider removing the mutable borrow\n    |\n LL -         &mut [_a, _b, _c] => {}\n-LL +         mut [_a, _b, _c] => {}\n+LL +         [_a, _b, _c] => {}\n    |\n \n error[E0508]: cannot move out of type `[Box<isize>]`, a non-copy slice"}, {"sha": "b96b3713f2a7ab74d37d5763832a0d2198a04462", "filename": "src/test/ui/suggestions/dont-suggest-ref/duplicate-suggestions.stderr", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/b8bd1d0826b8f792eccb97a6560d002832bff562/src%2Ftest%2Fui%2Fsuggestions%2Fdont-suggest-ref%2Fduplicate-suggestions.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b8bd1d0826b8f792eccb97a6560d002832bff562/src%2Ftest%2Fui%2Fsuggestions%2Fdont-suggest-ref%2Fduplicate-suggestions.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsuggestions%2Fdont-suggest-ref%2Fduplicate-suggestions.stderr?ref=b8bd1d0826b8f792eccb97a6560d002832bff562", "patch": "@@ -139,7 +139,7 @@ LL |     let &mut (X(_t), X(_u)) = &mut (xm.clone(), xm.clone());\n help: consider removing the mutable borrow\n    |\n LL -     let &mut (X(_t), X(_u)) = &mut (xm.clone(), xm.clone());\n-LL +     let mut (X(_t), X(_u)) = &mut (xm.clone(), xm.clone());\n+LL +     let (X(_t), X(_u)) = &mut (xm.clone(), xm.clone());\n    |\n \n error[E0507]: cannot move out of a mutable reference\n@@ -155,7 +155,7 @@ LL |     if let &mut (Either::One(_t), Either::Two(_u)) = &mut (em.clone(), em.c\n help: consider removing the mutable borrow\n    |\n LL -     if let &mut (Either::One(_t), Either::Two(_u)) = &mut (em.clone(), em.clone()) { }\n-LL +     if let mut (Either::One(_t), Either::Two(_u)) = &mut (em.clone(), em.clone()) { }\n+LL +     if let (Either::One(_t), Either::Two(_u)) = &mut (em.clone(), em.clone()) { }\n    |\n \n error[E0507]: cannot move out of a mutable reference\n@@ -171,7 +171,7 @@ LL |     while let &mut (Either::One(_t), Either::Two(_u)) = &mut (em.clone(), e\n help: consider removing the mutable borrow\n    |\n LL -     while let &mut (Either::One(_t), Either::Two(_u)) = &mut (em.clone(), em.clone()) { }\n-LL +     while let mut (Either::One(_t), Either::Two(_u)) = &mut (em.clone(), em.clone()) { }\n+LL +     while let (Either::One(_t), Either::Two(_u)) = &mut (em.clone(), em.clone()) { }\n    |\n \n error[E0507]: cannot move out of a mutable reference\n@@ -192,12 +192,12 @@ LL |         &mut (Either::Two(_t), Either::One(_u)) => (),\n help: consider removing the mutable borrow\n    |\n LL -         &mut (Either::One(_t), Either::Two(_u)) => (),\n-LL +         mut (Either::One(_t), Either::Two(_u)) => (),\n+LL +         (Either::One(_t), Either::Two(_u)) => (),\n    |\n help: consider removing the mutable borrow\n    |\n LL -         &mut (Either::Two(_t), Either::One(_u)) => (),\n-LL +         mut (Either::Two(_t), Either::One(_u)) => (),\n+LL +         (Either::Two(_t), Either::One(_u)) => (),\n    |\n \n error[E0507]: cannot move out of a mutable reference\n@@ -215,7 +215,7 @@ LL |         &mut (Either::One(_t), Either::Two(_u))\n help: consider removing the mutable borrow\n    |\n LL -         &mut (Either::One(_t), Either::Two(_u))\n-LL +         mut (Either::One(_t), Either::Two(_u))\n+LL +         (Either::One(_t), Either::Two(_u))\n    |\n \n error[E0507]: cannot move out of a mutable reference\n@@ -233,7 +233,7 @@ LL |         &mut (Either::One(_t), Either::Two(_u)) => (),\n help: consider removing the mutable borrow\n    |\n LL -         &mut (Either::One(_t), Either::Two(_u)) => (),\n-LL +         mut (Either::One(_t), Either::Two(_u)) => (),\n+LL +         (Either::One(_t), Either::Two(_u)) => (),\n    |\n \n error[E0507]: cannot move out of a mutable reference\n@@ -251,7 +251,7 @@ LL |         &mut (Either::One(_t), Either::Two(_u)) => (),\n help: consider removing the mutable borrow\n    |\n LL -         &mut (Either::One(_t), Either::Two(_u)) => (),\n-LL +         mut (Either::One(_t), Either::Two(_u)) => (),\n+LL +         (Either::One(_t), Either::Two(_u)) => (),\n    |\n \n error[E0507]: cannot move out of a mutable reference\n@@ -269,7 +269,7 @@ LL |         &mut (Either::One(_t), Either::Two(_u)) => (),\n help: consider removing the mutable borrow\n    |\n LL -         &mut (Either::One(_t), Either::Two(_u)) => (),\n-LL +         mut (Either::One(_t), Either::Two(_u)) => (),\n+LL +         (Either::One(_t), Either::Two(_u)) => (),\n    |\n \n error[E0507]: cannot move out of a shared reference\n@@ -301,7 +301,7 @@ LL |     fn f6(&mut (X(_t), X(_u)): &mut (X, X)) { }\n help: consider removing the mutable borrow\n    |\n LL -     fn f6(&mut (X(_t), X(_u)): &mut (X, X)) { }\n-LL +     fn f6(mut (X(_t), X(_u)): &mut (X, X)) { }\n+LL +     fn f6((X(_t), X(_u)): &mut (X, X)) { }\n    |\n \n error: aborting due to 17 previous errors"}, {"sha": "9009aeec746bd3698e7ffc28228b42351b3157fd", "filename": "src/test/ui/suggestions/dont-suggest-ref/simple.stderr", "status": "modified", "additions": 16, "deletions": 16, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/b8bd1d0826b8f792eccb97a6560d002832bff562/src%2Ftest%2Fui%2Fsuggestions%2Fdont-suggest-ref%2Fsimple.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b8bd1d0826b8f792eccb97a6560d002832bff562/src%2Ftest%2Fui%2Fsuggestions%2Fdont-suggest-ref%2Fsimple.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsuggestions%2Fdont-suggest-ref%2Fsimple.stderr?ref=b8bd1d0826b8f792eccb97a6560d002832bff562", "patch": "@@ -447,7 +447,7 @@ LL |     let &mut X(_t) = sm;\n help: consider removing the mutable borrow\n    |\n LL -     let &mut X(_t) = sm;\n-LL +     let mut X(_t) = sm;\n+LL +     let X(_t) = sm;\n    |\n \n error[E0507]: cannot move out of `rm` as enum variant `One` which is behind a mutable reference\n@@ -462,7 +462,7 @@ LL |     if let &mut Either::One(_t) = rm { }\n help: consider removing the mutable borrow\n    |\n LL -     if let &mut Either::One(_t) = rm { }\n-LL +     if let mut Either::One(_t) = rm { }\n+LL +     if let Either::One(_t) = rm { }\n    |\n \n error[E0507]: cannot move out of `rm` as enum variant `One` which is behind a mutable reference\n@@ -477,7 +477,7 @@ LL |     while let &mut Either::One(_t) = rm { }\n help: consider removing the mutable borrow\n    |\n LL -     while let &mut Either::One(_t) = rm { }\n-LL +     while let mut Either::One(_t) = rm { }\n+LL +     while let Either::One(_t) = rm { }\n    |\n \n error[E0507]: cannot move out of `rm` as enum variant `Two` which is behind a mutable reference\n@@ -496,12 +496,12 @@ LL |         &mut Either::Two(_t) => (),\n help: consider removing the mutable borrow\n    |\n LL -         &mut Either::One(_t) => (),\n-LL +         mut Either::One(_t) => (),\n+LL +         Either::One(_t) => (),\n    |\n help: consider removing the mutable borrow\n    |\n LL -         &mut Either::Two(_t) => (),\n-LL +         mut Either::Two(_t) => (),\n+LL +         Either::Two(_t) => (),\n    |\n \n error[E0507]: cannot move out of `rm` as enum variant `One` which is behind a mutable reference\n@@ -519,7 +519,7 @@ LL |         &mut Either::One(_t) => (),\n help: consider removing the mutable borrow\n    |\n LL -         &mut Either::One(_t) => (),\n-LL +         mut Either::One(_t) => (),\n+LL +         Either::One(_t) => (),\n    |\n \n error[E0507]: cannot move out of `rm` as enum variant `One` which is behind a mutable reference\n@@ -537,7 +537,7 @@ LL |         &mut Either::One(_t) => (),\n help: consider removing the mutable borrow\n    |\n LL -         &mut Either::One(_t) => (),\n-LL +         mut Either::One(_t) => (),\n+LL +         Either::One(_t) => (),\n    |\n \n error[E0507]: cannot move out of `rm` as enum variant `One` which is behind a mutable reference\n@@ -555,7 +555,7 @@ LL |         &mut Either::One(_t) => (),\n help: consider removing the mutable borrow\n    |\n LL -         &mut Either::One(_t) => (),\n-LL +         mut Either::One(_t) => (),\n+LL +         Either::One(_t) => (),\n    |\n \n error[E0507]: cannot move out of a shared reference\n@@ -792,7 +792,7 @@ LL |     let &mut X(_t) = &mut xm;\n help: consider removing the mutable borrow\n    |\n LL -     let &mut X(_t) = &mut xm;\n-LL +     let mut X(_t) = &mut xm;\n+LL +     let X(_t) = &mut xm;\n    |\n \n error[E0507]: cannot move out of a mutable reference\n@@ -807,7 +807,7 @@ LL |     if let &mut Either::One(_t) = &mut em { }\n help: consider removing the mutable borrow\n    |\n LL -     if let &mut Either::One(_t) = &mut em { }\n-LL +     if let mut Either::One(_t) = &mut em { }\n+LL +     if let Either::One(_t) = &mut em { }\n    |\n \n error[E0507]: cannot move out of a mutable reference\n@@ -822,7 +822,7 @@ LL |     while let &mut Either::One(_t) = &mut em { }\n help: consider removing the mutable borrow\n    |\n LL -     while let &mut Either::One(_t) = &mut em { }\n-LL +     while let mut Either::One(_t) = &mut em { }\n+LL +     while let Either::One(_t) = &mut em { }\n    |\n \n error[E0507]: cannot move out of a mutable reference\n@@ -840,7 +840,7 @@ LL |         &mut Either::One(_t)\n help: consider removing the mutable borrow\n    |\n LL -         &mut Either::One(_t)\n-LL +         mut Either::One(_t)\n+LL +         Either::One(_t)\n    |\n \n error[E0507]: cannot move out of a mutable reference\n@@ -858,7 +858,7 @@ LL |         &mut Either::One(_t) => (),\n help: consider removing the mutable borrow\n    |\n LL -         &mut Either::One(_t) => (),\n-LL +         mut Either::One(_t) => (),\n+LL +         Either::One(_t) => (),\n    |\n \n error[E0507]: cannot move out of a mutable reference\n@@ -876,7 +876,7 @@ LL |         &mut Either::One(_t) => (),\n help: consider removing the mutable borrow\n    |\n LL -         &mut Either::One(_t) => (),\n-LL +         mut Either::One(_t) => (),\n+LL +         Either::One(_t) => (),\n    |\n \n error[E0507]: cannot move out of a mutable reference\n@@ -894,7 +894,7 @@ LL |         &mut Either::One(_t) => (),\n help: consider removing the mutable borrow\n    |\n LL -         &mut Either::One(_t) => (),\n-LL +         mut Either::One(_t) => (),\n+LL +         Either::One(_t) => (),\n    |\n \n error[E0507]: cannot move out of a shared reference\n@@ -924,7 +924,7 @@ LL |     fn f2(&mut X(_t): &mut X) { }\n help: consider removing the mutable borrow\n    |\n LL -     fn f2(&mut X(_t): &mut X) { }\n-LL +     fn f2(mut X(_t): &mut X) { }\n+LL +     fn f2(X(_t): &mut X) { }\n    |\n \n error[E0507]: cannot move out of a shared reference"}]}