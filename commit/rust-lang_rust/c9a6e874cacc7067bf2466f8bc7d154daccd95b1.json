{"sha": "c9a6e874cacc7067bf2466f8bc7d154daccd95b1", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM5YTZlODc0Y2FjYzcwNjdiZjI0NjZmOGJjN2QxNTRkYWNjZDk1YjE=", "commit": {"author": {"name": "Chris Morgan", "email": "me@chrismorgan.info", "date": "2016-12-23T06:53:50Z"}, "committer": {"name": "Chris Morgan", "email": "me@chrismorgan.info", "date": "2016-12-23T06:53:50Z"}, "message": "Fix rustdoc highlighting of `&` and `*`.\n\nWhitespace tokens were included, so the span check used with `&` was\nincorrect, and it was never highlighted as kw-2.\n\nThe `*` in `*foo` and `*const T` should also be highlighted kw-2, so I\nadded them. Note that this *will* cause mishighlighting of code like\n`1*2`, but that should have been written `1 * 2`. Same deal with `1&2`.", "tree": {"sha": "fad3177787a19933f150281664ebd8cf56afa697", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fad3177787a19933f150281664ebd8cf56afa697"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c9a6e874cacc7067bf2466f8bc7d154daccd95b1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c9a6e874cacc7067bf2466f8bc7d154daccd95b1", "html_url": "https://github.com/rust-lang/rust/commit/c9a6e874cacc7067bf2466f8bc7d154daccd95b1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c9a6e874cacc7067bf2466f8bc7d154daccd95b1/comments", "author": {"login": "chris-morgan", "id": 392868, "node_id": "MDQ6VXNlcjM5Mjg2OA==", "avatar_url": "https://avatars.githubusercontent.com/u/392868?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chris-morgan", "html_url": "https://github.com/chris-morgan", "followers_url": "https://api.github.com/users/chris-morgan/followers", "following_url": "https://api.github.com/users/chris-morgan/following{/other_user}", "gists_url": "https://api.github.com/users/chris-morgan/gists{/gist_id}", "starred_url": "https://api.github.com/users/chris-morgan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chris-morgan/subscriptions", "organizations_url": "https://api.github.com/users/chris-morgan/orgs", "repos_url": "https://api.github.com/users/chris-morgan/repos", "events_url": "https://api.github.com/users/chris-morgan/events{/privacy}", "received_events_url": "https://api.github.com/users/chris-morgan/received_events", "type": "User", "site_admin": false}, "committer": {"login": "chris-morgan", "id": 392868, "node_id": "MDQ6VXNlcjM5Mjg2OA==", "avatar_url": "https://avatars.githubusercontent.com/u/392868?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chris-morgan", "html_url": "https://github.com/chris-morgan", "followers_url": "https://api.github.com/users/chris-morgan/followers", "following_url": "https://api.github.com/users/chris-morgan/following{/other_user}", "gists_url": "https://api.github.com/users/chris-morgan/gists{/gist_id}", "starred_url": "https://api.github.com/users/chris-morgan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chris-morgan/subscriptions", "organizations_url": "https://api.github.com/users/chris-morgan/orgs", "repos_url": "https://api.github.com/users/chris-morgan/repos", "events_url": "https://api.github.com/users/chris-morgan/events{/privacy}", "received_events_url": "https://api.github.com/users/chris-morgan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c217ab6c8dc1a305304b00a414be5f39ea6a2c81", "url": "https://api.github.com/repos/rust-lang/rust/commits/c217ab6c8dc1a305304b00a414be5f39ea6a2c81", "html_url": "https://github.com/rust-lang/rust/commit/c217ab6c8dc1a305304b00a414be5f39ea6a2c81"}], "stats": {"total": 8, "additions": 5, "deletions": 3}, "files": [{"sha": "a031be8b3c2be598bd34fadcaf0fc62a3df96bae", "filename": "src/librustdoc/html/highlight.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/c9a6e874cacc7067bf2466f8bc7d154daccd95b1/src%2Flibrustdoc%2Fhtml%2Fhighlight.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c9a6e874cacc7067bf2466f8bc7d154daccd95b1/src%2Flibrustdoc%2Fhtml%2Fhighlight.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fhighlight.rs?ref=c9a6e874cacc7067bf2466f8bc7d154daccd95b1", "patch": "@@ -218,9 +218,11 @@ impl<'a> Classifier<'a> {\n             token::Comment => Class::Comment,\n             token::DocComment(..) => Class::DocComment,\n \n-            // If this '&' token is directly adjacent to another token, assume\n-            // that it's the address-of operator instead of the and-operator.\n-            token::BinOp(token::And) if self.lexer.peek().sp.lo == tas.sp.hi => Class::RefKeyWord,\n+            // If this '&' or '*' token is followed by a non-whitespace token, assume that it's the\n+            // reference or dereference operator or a reference or pointer type, instead of the\n+            // bit-and or multiplication operator.\n+            token::BinOp(token::And) | token::BinOp(token::Star)\n+                if self.lexer.peek().tok != token::Whitespace => Class::RefKeyWord,\n \n             // Consider this as part of a macro invocation if there was a\n             // leading identifier."}]}