{"sha": "ff476b3009bd0f0137ade6eb02af2794c19066d2", "node_id": "C_kwDOAAsO6NoAKGZmNDc2YjMwMDliZDBmMDEzN2FkZTZlYjAyYWYyNzk0YzE5MDY2ZDI", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-01-18T21:00:46Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-01-18T21:00:46Z"}, "message": "Rollup merge of #92692 - jsha:cool-sidebar, r=GuillaumeGomez\n\nSimplify and unify rustdoc sidebar styles\n\nFixes #59860\n\nThis switches to just use size, weight, and spacing to distinguish headings in the sidebar. We no longer use boxes, horizontal bars, or centering to distinguish headings. This makes it much easier to understand the hierarchy of headings, and reduces visual noise.\n\nI also refactored how the mobile topbar works. Previously, we tried to shift around elements from the sidebar to make the topbar. Now, the topbar gets its own elements, which can be styled on their own. This makes styling and reasoning about those elements simpler.\n\nBecause the heading font sizes are bigger, increase the sidebar width slightly.\n\nAs a very minor change, removed version from the \"All types\" page. It's now only on the crate page.\n\nstruct - https://rustdoc.crud.net/jsha/cool-sidebar/std/vec/struct.Vec.html\ntrait - https://rustdoc.crud.net/jsha/cool-sidebar/std/io/trait.Read.html\ncrate - https://rustdoc.crud.net/jsha/cool-sidebar/std/index.html\nmod - https://rustdoc.crud.net/jsha/cool-sidebar/std/any/index.html\nmacro - https://rustdoc.crud.net/jsha/cool-sidebar/std/macro.panic.html\nfn - https://rustdoc.crud.net/jsha/cool-sidebar/std/io/fn.stdin.html\ntype alias - https://rustdoc.crud.net/jsha/cool-sidebar/std/io/type.Result.html\nkeyword - https://rustdoc.crud.net/jsha/cool-sidebar/std/keyword.as.html\nprimitive - https://rustdoc.crud.net/jsha/cool-sidebar/std/primitive.pointer.html\n\nr? `@GuillaumeGomez`\ncc `@camelid`\n[Discussed on Zulip](https://rust-lang.zulipchat.com/#narrow/stream/266220-rustdoc/topic/sidebar.20headings).\n\nNote: This has a lot of smaller commits, but I plan to squash them before merging.", "tree": {"sha": "0186be856984dacd7ec0efbfba050d8a2822148c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0186be856984dacd7ec0efbfba050d8a2822148c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ff476b3009bd0f0137ade6eb02af2794c19066d2", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJh5yp/CRBK7hj4Ov3rIwAA+YsIAAa15RopBSOuoT6M+EV3HUUf\n0m38OoWnJn4XuXdVCWpjvSBeUpVKveQLL9ShDOzIAW0rp49a9GeBILseFyQzFsJM\nzAhiQkTxDWMH/eiL5M2CBSfQB9QzL1X7oPCwWd6xQfkziSuH0Qqv7brxsxeyROiN\ncGrNBos7ID2yIVNQYpRNaC9+pOs8kECu81Na2QfKFEFG/4+2I9TOzyfGpnJ0OAYE\ntpGaAVewgRqBzdhujGSBfGJO1VKanFPpUmMPm6RNuKxPaWa45xOMm1Y/JBt+UHuc\nfxuOAOFlaQXiXWmkwY/qTqOd73Gyn9UmLLhGqovNTfZIBkw+8Mv/dNzvfGy8IwI=\n=eEa7\n-----END PGP SIGNATURE-----\n", "payload": "tree 0186be856984dacd7ec0efbfba050d8a2822148c\nparent 7889f961032fea47629f4dbdd40d92cea8dcc8de\nparent 6a5f8b1aef1417d7dc85b5d0a229d2db1930eb7c\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1642539646 +0100\ncommitter GitHub <noreply@github.com> 1642539646 +0100\n\nRollup merge of #92692 - jsha:cool-sidebar, r=GuillaumeGomez\n\nSimplify and unify rustdoc sidebar styles\n\nFixes #59860\n\nThis switches to just use size, weight, and spacing to distinguish headings in the sidebar. We no longer use boxes, horizontal bars, or centering to distinguish headings. This makes it much easier to understand the hierarchy of headings, and reduces visual noise.\n\nI also refactored how the mobile topbar works. Previously, we tried to shift around elements from the sidebar to make the topbar. Now, the topbar gets its own elements, which can be styled on their own. This makes styling and reasoning about those elements simpler.\n\nBecause the heading font sizes are bigger, increase the sidebar width slightly.\n\nAs a very minor change, removed version from the \"All types\" page. It's now only on the crate page.\n\nstruct - https://rustdoc.crud.net/jsha/cool-sidebar/std/vec/struct.Vec.html\ntrait - https://rustdoc.crud.net/jsha/cool-sidebar/std/io/trait.Read.html\ncrate - https://rustdoc.crud.net/jsha/cool-sidebar/std/index.html\nmod - https://rustdoc.crud.net/jsha/cool-sidebar/std/any/index.html\nmacro - https://rustdoc.crud.net/jsha/cool-sidebar/std/macro.panic.html\nfn - https://rustdoc.crud.net/jsha/cool-sidebar/std/io/fn.stdin.html\ntype alias - https://rustdoc.crud.net/jsha/cool-sidebar/std/io/type.Result.html\nkeyword - https://rustdoc.crud.net/jsha/cool-sidebar/std/keyword.as.html\nprimitive - https://rustdoc.crud.net/jsha/cool-sidebar/std/primitive.pointer.html\n\nr? `@GuillaumeGomez`\ncc `@camelid`\n[Discussed on Zulip](https://rust-lang.zulipchat.com/#narrow/stream/266220-rustdoc/topic/sidebar.20headings).\n\nNote: This has a lot of smaller commits, but I plan to squash them before merging.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ff476b3009bd0f0137ade6eb02af2794c19066d2", "html_url": "https://github.com/rust-lang/rust/commit/ff476b3009bd0f0137ade6eb02af2794c19066d2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ff476b3009bd0f0137ade6eb02af2794c19066d2/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7889f961032fea47629f4dbdd40d92cea8dcc8de", "url": "https://api.github.com/repos/rust-lang/rust/commits/7889f961032fea47629f4dbdd40d92cea8dcc8de", "html_url": "https://github.com/rust-lang/rust/commit/7889f961032fea47629f4dbdd40d92cea8dcc8de"}, {"sha": "6a5f8b1aef1417d7dc85b5d0a229d2db1930eb7c", "url": "https://api.github.com/repos/rust-lang/rust/commits/6a5f8b1aef1417d7dc85b5d0a229d2db1930eb7c", "html_url": "https://github.com/rust-lang/rust/commit/6a5f8b1aef1417d7dc85b5d0a229d2db1930eb7c"}], "stats": {"total": 588, "additions": 228, "deletions": 360}, "files": [{"sha": "2455d56bd2b3f9c1038bd4b58e81ed5b6b000ee2", "filename": "src/librustdoc/html/render/context.rs", "status": "modified", "additions": 2, "deletions": 10, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Frender%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Frender%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fcontext.rs?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -554,16 +554,8 @@ impl<'tcx> FormatRenderer<'tcx> for Context<'tcx> {\n             extra_scripts: &[],\n             static_extra_scripts: &[],\n         };\n-        let sidebar = if let Some(ref version) = self.shared.cache.crate_version {\n-            format!(\n-                \"<h2 class=\\\"location\\\">Crate {}</h2>\\\n-                     <div class=\\\"block version\\\">\\\n-                         <p>Version {}</p>\\\n-                     </div>\\\n-                     <a id=\\\"all-types\\\" href=\\\"index.html\\\"><p>Back to index</p></a>\",\n-                crate_name,\n-                Escape(version),\n-            )\n+        let sidebar = if self.shared.cache.crate_version.is_some() {\n+            format!(\"<h2 class=\\\"location\\\">Crate {}</h2>\", crate_name)\n         } else {\n             String::new()\n         };"}, {"sha": "29a793f3110b1ef0e360c54bd99df8adb9525957", "filename": "src/librustdoc/html/render/mod.rs", "status": "modified", "additions": 6, "deletions": 25, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -1744,13 +1744,6 @@ fn print_sidebar(cx: &Context<'_>, it: &clean::Item, buffer: &mut Buffer) {\n             buffer,\n             \"<h2 class=\\\"location\\\"><a href=\\\"#\\\">{}{}</a></h2>\",\n             match *it.kind {\n-                clean::StructItem(..) => \"Struct \",\n-                clean::TraitItem(..) => \"Trait \",\n-                clean::PrimitiveItem(..) => \"Primitive Type \",\n-                clean::UnionItem(..) => \"Union \",\n-                clean::EnumItem(..) => \"Enum \",\n-                clean::TypedefItem(..) => \"Type Definition \",\n-                clean::ForeignTypeItem => \"Foreign Type \",\n                 clean::ModuleItem(..) =>\n                     if it.is_crate() {\n                         \"Crate \"\n@@ -1763,26 +1756,14 @@ fn print_sidebar(cx: &Context<'_>, it: &clean::Item, buffer: &mut Buffer) {\n         );\n     }\n \n+    buffer.write_str(\"<div class=\\\"sidebar-elems\\\">\");\n     if it.is_crate() {\n+        write!(buffer, \"<div class=\\\"block\\\"><ul>\");\n         if let Some(ref version) = cx.cache().crate_version {\n-            write!(\n-                buffer,\n-                \"<div class=\\\"block version\\\">\\\n-                     <div class=\\\"narrow-helper\\\"></div>\\\n-                     <p>Version {}</p>\\\n-                 </div>\",\n-                Escape(version),\n-            );\n+            write!(buffer, \"<li class=\\\"version\\\">Version {}</li>\", Escape(version));\n         }\n-    }\n-\n-    buffer.write_str(\"<div class=\\\"sidebar-elems\\\">\");\n-    if it.is_crate() {\n-        write!(\n-            buffer,\n-            \"<a id=\\\"all-types\\\" href=\\\"all.html\\\"><p>See all {}'s items</p></a>\",\n-            it.name.as_ref().expect(\"crates always have a name\"),\n-        );\n+        write!(buffer, \"<li><a id=\\\"all-types\\\" href=\\\"all.html\\\">All Items</a></li>\");\n+        buffer.write_str(\"</div></ul>\");\n     }\n \n     match *it.kind {\n@@ -1806,7 +1787,7 @@ fn print_sidebar(cx: &Context<'_>, it: &clean::Item, buffer: &mut Buffer) {\n     // to navigate the documentation (though slightly inefficiently).\n \n     if !it.is_mod() {\n-        buffer.write_str(\"<h2 class=\\\"location\\\">Other items in<br>\");\n+        buffer.write_str(\"<h2 class=\\\"location\\\">In \");\n         for (i, name) in cx.current.iter().take(parentlen).enumerate() {\n             if i > 0 {\n                 buffer.write_str(\"::<wbr>\");"}, {"sha": "dbc068ce6b13b2a30a3fede073039be862764030", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 122, "deletions": 182, "changes": 304, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -169,8 +169,7 @@ h1.fqn {\n \tsection hierarchies. */\n h2,\n .top-doc h3,\n-.top-doc h4,\n-.sidebar .others h3 {\n+.top-doc h4 {\n \tborder-bottom: 1px solid;\n }\n h3.code-header {\n@@ -206,7 +205,11 @@ div.impl-items > div {\n }\n \n h1, h2, h3, h4, h5, h6,\n-.sidebar, a.source, .search-input, .search-results .result-name,\n+.sidebar,\n+.mobile-topbar,\n+a.source,\n+.search-input,\n+.search-results .result-name,\n .content table td:first-child > a,\n .item-left > a,\n .out-of-band,\n@@ -261,6 +264,11 @@ textarea {\n \tmargin: 0;\n }\n \n+button {\n+\t/* Buttons on Safari have different default padding than other platforms. Make them the same. */\n+\tpadding: 1px 6px;\n+}\n+\n /* end tweaks for normalize.css 8 */\n \n .rustdoc {\n@@ -359,15 +367,25 @@ nav.sub {\n }\n \n .sidebar {\n-\twidth: 200px;\n+\tfont-size: 0.9rem;\n+\twidth: 250px;\n+\tmin-width: 200px;\n \toverflow-y: scroll;\n \tposition: sticky;\n-\tmin-width: 200px;\n \theight: 100vh;\n \ttop: 0;\n \tleft: 0;\n }\n \n+.sidebar-elems,\n+.sidebar > .location {\n+\tpadding-left: 24px;\n+}\n+\n+.sidebar .location {\n+\toverflow-wrap: anywhere;\n+}\n+\n .rustdoc.source .sidebar {\n \twidth: 50px;\n \tmin-width: 0px;\n@@ -396,6 +414,10 @@ nav.sub {\n \tvisibility: visible;\n }\n \n+#all-types {\n+\tmargin-top: 1em;\n+}\n+\n /* Improve the scrollbar display on firefox */\n * {\n \tscrollbar-width: initial;\n@@ -415,48 +437,28 @@ nav.sub {\n \t-webkit-box-shadow: inset 0;\n }\n \n-.sidebar .block > ul > li {\n-\tmargin-right: -10px;\n-}\n-\n /* Everything else */\n \n .hidden {\n \tdisplay: none !important;\n }\n \n-.logo-container {\n+.sidebar .logo-container {\n \tdisplay: flex;\n \tmargin-top: 10px;\n \tmargin-bottom: 10px;\n \tjustify-content: center;\n }\n \n+.version {\n+\toverflow-wrap: break-word;\n+}\n+\n .logo-container > img {\n \theight: 100px;\n \twidth: 100px;\n }\n \n-.sidebar .location {\n-\tborder: 1px solid;\n-\tfont-size: 1.0625rem;\n-\tmargin: 30px 10px 20px 10px;\n-\ttext-align: center;\n-\tword-wrap: break-word;\n-\tfont-weight: inherit;\n-\tpadding: 0;\n-}\n-\n-.sidebar .version {\n-\tfont-size: 0.9375rem;\n-\ttext-align: center;\n-\tborder-bottom: 1px solid;\n-\toverflow-wrap: break-word;\n-\toverflow-wrap: anywhere;\n-\tword-wrap: break-word; /* deprecated */\n-\tword-break: break-word; /* Chrome, non-standard */\n-}\n-\n .location:empty {\n \tborder: none;\n }\n@@ -470,48 +472,45 @@ nav.sub {\n \n .block {\n \tpadding: 0;\n-\tmargin-bottom: 14px;\n-}\n-.block h2, .block h3 {\n-\ttext-align: center;\n }\n .block ul, .block li {\n-\tmargin: 0 10px;\n \tpadding: 0;\n \tlist-style: none;\n }\n \n .block a {\n \tdisplay: block;\n+\tpadding: 0.3em;\n+\tmargin-left: -0.3em;\n+\n \ttext-overflow: ellipsis;\n \toverflow: hidden;\n-\tline-height: 15px;\n-\tpadding: 7px 5px;\n-\tfont-size: 0.875rem;\n-\tfont-weight: 300;\n-\ttransition: border 500ms ease-out;\n }\n \n-.sidebar-title {\n-\tborder-top: 1px solid;\n-\tborder-bottom: 1px solid;\n-\ttext-align: center;\n-\tfont-size: 1.0625rem;\n-\tmargin-bottom: 5px;\n-\tfont-weight: inherit;\n+.sidebar h2 {\n+\tborder-bottom: none;\n+\tfont-weight: 500;\n \tpadding: 0;\n+\tmargin: 0;\n+\tmargin-top: 1rem;\n+\tmargin-bottom: 1rem;\n }\n \n-.sidebar-links {\n-\tmargin-bottom: 15px;\n+.sidebar h3 {\n+\tfont-size: 1.1rem;\n+\tfont-weight: 500;\n+\tpadding: 0;\n+\tmargin: 0;\n+\tmargin-top: 0.5rem;\n+\tmargin-bottom: 0.25rem;\n }\n \n-.sidebar-links > a {\n-\tpadding-left: 10px;\n-\twidth: 100%;\n+.sidebar-links,\n+.block {\n+\tmargin-bottom: 2em;\n }\n \n-.sidebar-menu {\n+.mobile-topbar {\n \tdisplay: none;\n }\n \n@@ -784,13 +783,12 @@ nav.sub {\n \tmargin-top: 0;\n }\n \n-nav:not(.sidebar) {\n+nav.sub {\n \tflex-grow: 1;\n-\tborder-bottom: 1px solid;\n \tpadding-bottom: 10px;\n \tmargin-bottom: 25px;\n }\n-.source nav:not(.sidebar).sub {\n+.source nav.sub {\n \tmargin-left: 32px;\n }\n nav.main {\n@@ -1395,18 +1393,6 @@ pre.rust {\n \tmargin-left: 5px;\n }\n \n-#all-types {\n-\ttext-align: center;\n-\tborder: 1px solid;\n-\tmargin: 0 10px;\n-\tmargin-bottom: 10px;\n-\tdisplay: block;\n-\tborder-radius: 7px;\n-}\n-#all-types > p {\n-\tmargin: 5px 0;\n-}\n-\n #sidebar-toggle {\n \tposition: sticky;\n \ttop: 0;\n@@ -1752,143 +1738,123 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n }\n \n @media (max-width: 700px) {\n-\tbody {\n+\t.rustdoc {\n \t\tpadding-top: 0px;\n+\t\t/* Sidebar should overlay main content, rather than pushing main content to the right.\n+\t\t   Turn off `display: flex` on the body element. */\n+\t\tdisplay: block;\n+\t\tscroll-margin-top: 45px;\n \t}\n \n \tmain {\n \t\tpadding-left: 15px;\n \t\tpadding-top: 0px;\n \t}\n \n-\t/* Space is at a premium on mobile, so remove the theme-picker icon. */\n-\t#theme-picker {\n-\t\tdisplay: none;\n-\t\twidth: 0;\n-\t}\n-\n \t.rustdoc {\n \t\tflex-direction: column;\n \t}\n \n-\t.rustdoc:not(.source) > .sidebar {\n-\t\twidth: 100%;\n-\t\theight: 45px;\n-\t\tmin-height: 40px;\n-\t\tmax-height: 45px;\n-\t\tmargin: 0;\n-\t\tpadding: 0 15px;\n-\t\tposition: static;\n-\t\tz-index: 11;\n-\t\toverflow-y: hidden;\n+\t/* Hide the logo and item name from the sidebar. Those are displayed\n+\t   in the mobile-topbar instead. */\n+\t.sidebar .sidebar-logo,\n+\t.sidebar .location {\n+\t\tdisplay: none;\n \t}\n \n-\t.rustdoc.source > .sidebar {\n+\t.sidebar-elems {\n+\t\tmargin-top: 1em;\n+\t}\n+\n+\t.sidebar {\n \t\tposition: fixed;\n-\t\ttop: 0;\n-\t\tleft: 0;\n+\t\ttop: 45px;\n+\t\t/* Hide the sidebar offscreen while not in use. Doing this instead of display: none means\n+\t\t   the sidebar stays visible for screen readers, which is useful for navigation. */\n+\t\tleft: -1000px;\n+\t\tmargin-left: 0;\n+\t\tbackground-color: rgba(0,0,0,0);\n \t\tmargin: 0;\n+\t\tpadding: 0;\n+\t\tpadding-left: 15px;\n \t\tz-index: 11;\n-\t\twidth: 0;\n \t}\n \n-\t.sidebar.mobile {\n-\t\tposition: sticky !important;\n+\t/* The source view uses a different design for the sidebar toggle, and doesn't have a topbar,\n+\t   so don't bump down the main content or the sidebar. */\n+\t.source main,\n+\t.source .sidebar {\n \t\ttop: 0;\n+\t\tpadding: 0;\n+\t}\n+\n+\t.sidebar.shown,\n+\t.sidebar.expanded,\n+\t.sidebar:focus-within {\n \t\tleft: 0;\n-\t\twidth: 100%;\n-\t\tmargin-left: 0;\n-\t\tbackground-color: rgba(0,0,0,0);\n \t}\n \n-\t.sidebar > .location {\n-\t\tfloat: right;\n-\t\tmargin: 0px;\n-\t\tmargin-top: 2px;\n-\t\tpadding: 3px 10px 1px 10px;\n-\t\tmin-height: 39px;\n-\t\tbackground: inherit;\n-\t\ttext-align: left;\n-\t\tfont-size: 1.5rem;\n+\t.rustdoc.source > .sidebar {\n+\t\tposition: fixed;\n+\t\tmargin: 0;\n+\t\tz-index: 11;\n+\t\twidth: 0;\n \t}\n \n-\t.sidebar .location:empty {\n-\t\tpadding: 0;\n+\t.mobile-topbar .location {\n+\t\tborder: none;\n+\t\tmargin: 0;\n+\t\tmargin-left: auto;\n+\t\tpadding: 0.3em;\n+\t\tpadding-right: 0.6em;\n+\t\ttext-overflow: ellipsis;\n+\t\toverflow-x: hidden;\n \t}\n \n-\t.rustdoc:not(.source) .sidebar .logo-container {\n-\t\twidth: 35px;\n-\t\theight: 35px;\n-\t\tmargin-top: 5px;\n-\t\tmargin-bottom: 5px;\n-\t\tfloat: left;\n-\t\tmargin-left: 50px;\n+\t.mobile-topbar .logo-container {\n+\t\tmax-height: 45px;\n \t}\n \n-\t.sidebar .logo-container > img {\n+\t.mobile-topbar .logo-container > img {\n \t\tmax-width: 35px;\n \t\tmax-height: 35px;\n+\t\tmargin-left: 20px;\n+\t\tmargin-top: 5px;\n+\t\tmargin-bottom: 5px;\n \t}\n \n-\t.sidebar-menu {\n-\t\tposition: fixed;\n+\t.mobile-topbar {\n+\t\tdisplay: flex;\n+\t\tflex-direction: row;\n+\t\tposition: sticky;\n \t\tz-index: 10;\n \t\tfont-size: 2rem;\n \t\tcursor: pointer;\n-\t\twidth: 45px;\n+\t\theight: 45px;\n+\t\twidth: 100%;\n \t\tleft: 0;\n \t\ttop: 0;\n-\t\ttext-align: center;\n-\t\tdisplay: block;\n-\t\tborder-bottom: 1px solid;\n-\t\tborder-right: 1px solid;\n-\t\theight: 45px;\n \t}\n \n-\t.rustdoc.source > .sidebar > .sidebar-menu {\n+\t.source .mobile-topbar {\n \t\tdisplay: none;\n \t}\n \n-\t/* We do NOT hide this element so that alternative device readers still have this information\n-\t   available. */\n-\t.sidebar-elems {\n-\t\tposition: fixed;\n-\t\tz-index: 1;\n-\t\ttop: 45px;\n-\t\tbottom: 0;\n-\t\twidth: 246px;\n-\t\t/* We move the sidebar to the left by its own width so it doesn't appear. */\n-\t\tleft: -246px;\n-\t\toverflow-y: auto;\n-\t\tborder-right: 1px solid;\n-\t}\n-\n-\t.sidebar > .block.version {\n-\t\toverflow: hidden;\n-\t\tborder-bottom: none;\n-\t\tmargin-bottom: 0;\n-\t\theight: 100%;\n-\t\tpadding-left: 12px;\n-\t}\n-\t.sidebar > .block.version > div.narrow-helper {\n-\t\tfloat: left;\n-\t\twidth: 1px;\n-\t\theight: 100%;\n-\t}\n-\t.sidebar > .block.version > p {\n-\t\t/* hide Version text if too narrow */\n-\t\tmargin: 0;\n-\t\tmin-width: 55px;\n-\t\t/* vertically center */\n-\t\tdisplay: flex;\n-\t\talign-items: center;\n-\t\theight: 100%;\n+\t.sidebar-menu-toggle {\n+\t\twidth: 45px;\n+\t\tborder: none;\n \t}\n \n \t.source nav:not(.sidebar).sub {\n \t\tmargin-left: 32px;\n \t}\n \n+\t/* Space is at a premium on mobile, so remove the theme-picker icon. */\n+\t#theme-picker {\n+\t\tdisplay: none;\n+\t\twidth: 0;\n+\t}\n+\n \t.content {\n \t\tmargin-left: 0px;\n \t}\n@@ -1925,28 +1891,6 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n \t\theight: 50px;\n \t}\n \n-\t.show-it, .sidebar-elems:focus-within {\n-\t\tz-index:  2;\n-\t\tleft: 0;\n-\t}\n-\n-\t.show-it > .block.items {\n-\t\tmargin: 8px 0;\n-\t}\n-\n-\t.show-it > .block.items > ul {\n-\t\tmargin: 0;\n-\t}\n-\n-\t.show-it > .block.items > ul > li {\n-\t\ttext-align: center;\n-\t\tmargin: 2px 0;\n-\t}\n-\n-\t.show-it > .block.items > ul > li > a {\n-\t\tfont-size: 1.3125rem;\n-\t}\n-\n \t/* Because of ios, we need to actually have a full height sidebar title so the\n \t * actual sidebar can show up. But then we need to make it transparent so we don't\n \t * hide content. The filler just allows to create the background for the sidebar\n@@ -1967,10 +1911,6 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n \t\tleft: -11px;\n \t}\n \n-\t#all-types {\n-\t\tmargin: 10px;\n-\t}\n-\n \t.sidebar.expanded #sidebar-toggle {\n \t\tfont-size: 1.5rem;\n \t}"}, {"sha": "82a2be67ceb0cb367974eb2a2b79018692ec4c84", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 3, "deletions": 24, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -57,7 +57,7 @@ pre, .rustdoc.source .example-wrap {\n \tbackground-color: #191f26;\n }\n \n-.sidebar {\n+.sidebar, .mobile-topbar, .sidebar-menu-toggle {\n \tbackground-color: #14191f;\n }\n \n@@ -100,12 +100,6 @@ pre, .rustdoc.source .example-wrap {\n \tbackground-color: #14191f;\n }\n \n-.sidebar .location {\n-\tborder-color: #000;\n-\tbackground-color: #0f1419;\n-\tcolor: #fff;\n-}\n-\n .sidebar-elems .location {\n \tcolor: #ff7733;\n }\n@@ -114,15 +108,6 @@ pre, .rustdoc.source .example-wrap {\n \tcolor: #fff;\n }\n \n-.sidebar .version {\n-\tborder-bottom-color: #424c57;\n-}\n-\n-.sidebar-title {\n-\tborder-top-color: #5c6773;\n-\tborder-bottom-color: #5c6773;\n-}\n-\n .block a:hover {\n \tbackground: transparent;\n \tcolor: #ffb44c;\n@@ -228,7 +213,8 @@ a.anchor,\n .small-section-header a,\n #source-sidebar a,\n pre.rust a,\n-.sidebar a,\n+.sidebar h2 a,\n+.sidebar h3 a,\n .in-band a {\n \tcolor: #c5c5c5;\n }\n@@ -581,13 +567,6 @@ kbd {\n \t}\n }\n \n-#all-types {\n-\tbackground-color: #14191f;\n-}\n-#all-types:hover {\n-\tbackground-color: rgba(70, 70, 70, 0.33);\n-}\n-\n .search-results .result-name span.alias {\n \tcolor: #c5c5c5;\n }"}, {"sha": "761bf50dd36b1ff7047a45502fa9fc100599fce1", "filename": "src/librustdoc/html/static/css/themes/dark.css", "status": "modified", "additions": 3, "deletions": 24, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -28,7 +28,7 @@ pre, .rustdoc.source .example-wrap {\n \tbackground-color: #2A2A2A;\n }\n \n-.sidebar {\n+.sidebar, .mobile-topbar, .sidebar-menu-toggle {\n \tbackground-color: #505050;\n }\n \n@@ -69,21 +69,6 @@ pre, .rustdoc.source .example-wrap {\n \tbackground-color: #565656;\n }\n \n-.sidebar .location {\n-\tborder-color: #fff;\n-\tbackground: #575757;\n-\tcolor: #DDD;\n-}\n-\n-.sidebar .version {\n-\tborder-bottom-color: #DDD;\n-}\n-\n-.sidebar-title {\n-\tborder-top-color: #777;\n-\tborder-bottom-color: #777;\n-}\n-\n .block a:hover {\n \tbackground: #444;\n }\n@@ -186,7 +171,8 @@ a.anchor,\n .small-section-header a,\n #source-sidebar a,\n pre.rust a,\n-.sidebar a,\n+.sidebar h2 a,\n+.sidebar h3 a,\n .in-band a {\n \tcolor: #ddd;\n }\n@@ -453,13 +439,6 @@ kbd {\n \t}\n }\n \n-#all-types {\n-\tbackground-color: #505050;\n-}\n-#all-types:hover {\n-\tbackground-color: #606060;\n-}\n-\n .search-results .result-name span.alias {\n \tcolor: #fff;\n }"}, {"sha": "7cca7d4004b5ee2ace913f6f7d64823eb4e912e7", "filename": "src/librustdoc/html/static/css/themes/light.css", "status": "modified", "additions": 3, "deletions": 24, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -30,7 +30,7 @@ pre, .rustdoc.source .example-wrap {\n \tbackground-color: #F5F5F5;\n }\n \n-.sidebar {\n+.sidebar, .mobile-topbar, .sidebar-menu-toggle {\n \tbackground-color: #F5F5F5;\n }\n \n@@ -69,21 +69,6 @@ pre, .rustdoc.source .example-wrap {\n \tbackground-color: #f1f1f1;\n }\n \n-.sidebar .location {\n-\tborder-color: #000;\n-\tbackground-color: #fff;\n-\tcolor: #333;\n-}\n-\n-.sidebar .version {\n-\tborder-bottom-color: #DDD;\n-}\n-\n-.sidebar-title {\n-\tborder-top-color: #777;\n-\tborder-bottom-color: #777;\n-}\n-\n .block a:hover {\n \tbackground: #F5F5F5;\n }\n@@ -183,7 +168,8 @@ a.anchor,\n .small-section-header a,\n #source-sidebar a,\n pre.rust a,\n-.sidebar a,\n+.sidebar h2 a,\n+.sidebar h3 a,\n .in-band a {\n \tcolor: #000;\n }\n@@ -440,13 +426,6 @@ kbd {\n \t}\n }\n \n-#all-types {\n-\tbackground-color: #fff;\n-}\n-#all-types:hover {\n-\tbackground-color: #f9f9f9;\n-}\n-\n .search-results .result-name span.alias {\n \tcolor: #000;\n }"}, {"sha": "161b95d99930e761de21ae49be2b8e41df3377ba", "filename": "src/librustdoc/html/static/js/main.js", "status": "modified", "additions": 21, "deletions": 39, "changes": 60, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -67,6 +67,13 @@ function resourcePath(basename, extension) {\n             ty: sidebarVars.attributes[\"data-ty\"].value,\n             relpath: sidebarVars.attributes[\"data-relpath\"].value,\n         };\n+        // FIXME: It would be nicer to generate this text content directly in HTML,\n+        // but with the current code it's hard to get the right information in the right place.\n+        var mobileLocationTitle = document.querySelector(\".mobile-topbar h2.location\");\n+        var locationTitle = document.querySelector(\".sidebar h2.location\");\n+        if (mobileLocationTitle && locationTitle) {\n+            mobileLocationTitle.innerText = locationTitle.innerText;\n+        }\n     }\n }());\n \n@@ -309,37 +316,6 @@ function hideThemeButtonState() {\n         return null;\n     }\n \n-    function showSidebar() {\n-        var elems = document.getElementsByClassName(\"sidebar-elems\")[0];\n-        if (elems) {\n-            addClass(elems, \"show-it\");\n-        }\n-        var sidebar = document.getElementsByClassName(\"sidebar\")[0];\n-        if (sidebar) {\n-            addClass(sidebar, \"mobile\");\n-            var filler = document.getElementById(\"sidebar-filler\");\n-            if (!filler) {\n-                var div = document.createElement(\"div\");\n-                div.id = \"sidebar-filler\";\n-                sidebar.appendChild(div);\n-            }\n-        }\n-    }\n-\n-    function hideSidebar() {\n-        var elems = document.getElementsByClassName(\"sidebar-elems\")[0];\n-        if (elems) {\n-            removeClass(elems, \"show-it\");\n-        }\n-        var sidebar = document.getElementsByClassName(\"sidebar\")[0];\n-        removeClass(sidebar, \"mobile\");\n-        var filler = document.getElementById(\"sidebar-filler\");\n-        if (filler) {\n-            filler.remove();\n-        }\n-        document.getElementsByTagName(\"body\")[0].style.marginTop = \"\";\n-    }\n-\n     var toggleAllDocsId = \"toggle-all-docs\";\n     var main = document.getElementById(MAIN_ID);\n     var savedHash = \"\";\n@@ -374,7 +350,8 @@ function hideThemeButtonState() {\n \n     function onHashChange(ev) {\n         // If we're in mobile mode, we should hide the sidebar in any case.\n-        hideSidebar();\n+        var sidebar = document.getElementsByClassName(\"sidebar\")[0];\n+        removeClass(sidebar, \"shown\");\n         handleHashes(ev);\n     }\n \n@@ -866,6 +843,11 @@ function hideThemeButtonState() {\n         });\n     }());\n \n+    function hideSidebar() {\n+        var sidebar = document.getElementsByClassName(\"sidebar\")[0];\n+        removeClass(sidebar, \"shown\");\n+    }\n+\n     function handleClick(id, f) {\n         var elem = document.getElementById(id);\n         if (elem) {\n@@ -906,16 +888,16 @@ function hideThemeButtonState() {\n         };\n     });\n \n-    var sidebar_menu = document.getElementsByClassName(\"sidebar-menu\")[0];\n-    if (sidebar_menu) {\n-        sidebar_menu.onclick = function() {\n+    var sidebar_menu_toggle = document.getElementsByClassName(\"sidebar-menu-toggle\")[0];\n+    if (sidebar_menu_toggle) {\n+        sidebar_menu_toggle.addEventListener(\"click\", function() {\n             var sidebar = document.getElementsByClassName(\"sidebar\")[0];\n-            if (hasClass(sidebar, \"mobile\")) {\n-                hideSidebar();\n+            if (!hasClass(sidebar, \"shown\")) {\n+                addClass(sidebar, \"shown\");\n             } else {\n-                showSidebar();\n+                removeClass(sidebar, \"shown\");\n             }\n-        };\n+        });\n     }\n \n     var buildHelperPopup = function() {"}, {"sha": "498f60e9f25ae4fd601dd22087421667209c8493", "filename": "src/librustdoc/html/static/js/source-script.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsource-script.js", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsource-script.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsource-script.js?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -139,7 +139,7 @@ function createSourceSidebar() {\n                                       currentFile, hasFoundFile);\n     });\n \n-    container.insertBefore(sidebar, document.querySelector(\".sidebar-logo\").nextSibling);\n+    container.appendChild(sidebar);\n     // Focus on the current file in the source files sidebar.\n     var selected_elem = sidebar.getElementsByClassName(\"selected\")[0];\n     if (typeof selected_elem !== \"undefined\") {"}, {"sha": "1322b854b7fc77298fa6390f3fb080d133439134", "filename": "src/librustdoc/templates/page.html", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Ftemplates%2Fpage.html", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Flibrustdoc%2Ftemplates%2Fpage.html", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Ftemplates%2Fpage.html?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -72,8 +72,20 @@\n     </div> {#- -#}\n     <![endif]--> {#- -#}\n     {{- layout.external_html.before_content|safe -}}\n+    <nav class=\"mobile-topbar\"> {#- -#}\n+        <button class=\"sidebar-menu-toggle\">&#9776;</button> {#- -#}\n+        <a class=\"sidebar-logo\" href=\"{{page.root_path|safe}}{{krate_with_trailing_slash|safe}}index.html\"> {#- -#}\n+            <div class=\"logo-container\"> {#- -#}\n+            {%- if !layout.logo.is_empty() -%}\n+                <img src=\"{{layout.logo}}\" alt=\"logo\"> {#- -#}\n+            {%- else -%}\n+                <img class=\"rust-logo\" src=\"{{static_root_path|safe}}rust-logo{{page.resource_suffix}}.svg\" alt=\"logo\"> {#- -#}\n+            {%- endif -%}\n+            </div>\n+        </a> {#- -#}\n+        <h2 class=\"location\"></h2>\n+    </nav>\n     <nav class=\"sidebar\"> {#- -#}\n-        <div class=\"sidebar-menu\" role=\"button\">&#9776;</div> {#- -#}\n         <a class=\"sidebar-logo\" href=\"{{page.root_path|safe}}{{krate_with_trailing_slash|safe}}index.html\"> {#- -#}\n             <div class=\"logo-container\"> {#- -#}\n                 {%- if !layout.logo.is_empty()  %}"}, {"sha": "2d48d21dc1b05da4e2d5571af6af732c40519fbc", "filename": "src/test/rustdoc-gui/anchors.goml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fanchors.goml", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fanchors.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fanchors.goml?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -20,7 +20,7 @@ assert-css: (\".srclink\", {\"text-decoration\": \"underline solid rgb(56, 115, 173)\"\n \n assert-css: (\"#top-doc-prose-title\", {\"color\": \"rgb(0, 0, 0)\"})\n \n-assert-css: (\".sidebar a\", {\"color\": \"rgb(0, 0, 0)\"})\n+assert-css: (\".sidebar a\", {\"color\": \"rgb(56, 115, 173)\"})\n assert-css: (\".in-band a\", {\"color\": \"rgb(0, 0, 0)\"})\n \n // We move the cursor over the \"Implementations\" title so the anchor is displayed."}, {"sha": "f93f3f0aefc51e9ad30e7969a9f63ba39292ea09", "filename": "src/test/rustdoc-gui/code-blocks-overflow.goml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fcode-blocks-overflow.goml", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fcode-blocks-overflow.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fcode-blocks-overflow.goml?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -5,4 +5,4 @@ size: (1080, 600)\n assert-count: (\".docblock > .example-wrap\", 2)\n assert: \".docblock > .example-wrap > .language-txt\"\n assert: \".docblock > .example-wrap > .rust-example-rendered\"\n-assert-css: (\".docblock > .example-wrap > pre\", {\"width\": \"796px\", \"overflow-x\": \"auto\"}, ALL)\n+assert-css: (\".docblock > .example-wrap > pre\", {\"width\": \"785.25px\", \"overflow-x\": \"auto\"}, ALL)"}, {"sha": "a9af88189a67de78bcee02314831f56d355ebbab", "filename": "src/test/rustdoc-gui/docblock-table-overflow.goml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fdocblock-table-overflow.goml", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fdocblock-table-overflow.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fdocblock-table-overflow.goml?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -4,7 +4,7 @@ goto: file://|DOC_PATH|/lib2/long_table/struct.Foo.html\n size: (1100, 800)\n // Logically, the \".docblock\" and the \"<p>\" should have the same scroll width.\n compare-elements-property: (\".top-doc .docblock\", \".top-doc .docblock > p\", [\"scrollWidth\"])\n-assert-property: (\".top-doc .docblock\", {\"scrollWidth\": \"816\"})\n+assert-property: (\".top-doc .docblock\", {\"scrollWidth\": \"801\"})\n // However, since there is overflow in the <table>, its scroll width is bigger.\n assert-property: (\".top-doc .docblock table\", {\"scrollWidth\": \"1573\"})\n \n@@ -16,6 +16,6 @@ compare-elements-property: (\n     \"#implementations + details .docblock > p\",\n     [\"scrollWidth\"],\n )\n-assert-property: (\"#implementations + details .docblock\", {\"scrollWidth\": \"816\"})\n+assert-property: (\"#implementations + details .docblock\", {\"scrollWidth\": \"801\"})\n // However, since there is overflow in the <table>, its scroll width is bigger.\n assert-property: (\"#implementations + details .docblock table\", {\"scrollWidth\": \"1573\"})"}, {"sha": "34ff2de3a9b2b5069313cb0012e64ab747a676f7", "filename": "src/test/rustdoc-gui/headings.goml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fheadings.goml", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fheadings.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fheadings.goml?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -110,7 +110,7 @@ assert-css: (\"h6#sub-sub-heading-for-enum-impl-item-doc\", {\"font-size\": \"15.2px\"\n assert-css: (\"h6#sub-sub-heading-for-enum-impl-item-doc\", {\"border-bottom-width\": \"0px\"})\n \n assert-text: (\".sidebar .others h3\", \"Modules\")\n-assert-css: (\".sidebar .others h3\", {\"border-bottom-width\": \"1px\"}, ALL)\n+assert-css: (\".sidebar .others h3\", {\"border-bottom-width\": \"0px\"}, ALL)\n \n goto: file://|DOC_PATH|/test_docs/union.HeavilyDocumentedUnion.html\n "}, {"sha": "acb30141ce577c9ff693714a14e7c2b4921adb4a", "filename": "src/test/rustdoc-gui/item-info-width.goml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fitem-info-width.goml", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fitem-info-width.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fitem-info-width.goml?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -3,5 +3,5 @@ goto: file://|DOC_PATH|/lib2/struct.Foo.html\n // We set a fixed size so there is no chance of \"random\" resize.\n size: (1100, 800)\n // We check that \".item-info\" is bigger than its content.\n-assert-css: (\".item-info\", {\"width\": \"807px\"})\n+assert-css: (\".item-info\", {\"width\": \"757px\"})\n assert-css: (\".item-info .stab\", {\"width\": \"341px\"})"}, {"sha": "3162a067d2107f8c16b7f2aa41552c9e82448808", "filename": "src/test/rustdoc-gui/search-result-display.goml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fsearch-result-display.goml", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fsearch-result-display.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsearch-result-display.goml?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -5,7 +5,7 @@ write: (\".search-input\", \"test\")\n wait-for: \"#titles\"\n // The width is returned by \"getComputedStyle\" which returns the exact number instead of the\n // CSS rule which is \"50%\"...\n-assert-css: (\".search-results div.desc\", {\"width\": \"320px\"})\n+assert-css: (\".search-results div.desc\", {\"width\": \"295px\"})\n size: (600, 100)\n // As counter-intuitive as it may seem, in this width, the width is \"100%\", which is why\n // when computed it's larger."}, {"sha": "547eb3fd1b3d107e63cfa1d864ddf3d2a1b73585", "filename": "src/test/rustdoc-gui/sidebar-mobile.goml", "status": "modified", "additions": 13, "deletions": 10, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fsidebar-mobile.goml", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fsidebar-mobile.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsidebar-mobile.goml?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -4,25 +4,28 @@\n goto: file://|DOC_PATH|/test_docs/struct.Foo.html\n // Switching to \"mobile view\" by reducing the width to 600px.\n size: (600, 600)\n-assert-css: (\".sidebar-elems\", {\"display\": \"block\", \"left\": \"-246px\"})\n+assert-css: (\".sidebar\", {\"display\": \"block\", \"left\": \"-1000px\"})\n // Opening the sidebar menu.\n-click: \".sidebar-menu\"\n-assert-css: (\".sidebar-elems\", {\"display\": \"block\", \"left\": \"0px\"})\n+click: \".sidebar-menu-toggle\"\n+assert-css: (\".sidebar\", {\"display\": \"block\", \"left\": \"0px\"})\n // Closing the sidebar menu.\n-click: \".sidebar-menu\"\n-assert-css: (\".sidebar-elems\", {\"display\": \"block\", \"left\": \"-246px\"})\n+click: \".sidebar-menu-toggle\"\n+assert-css: (\".sidebar\", {\"display\": \"block\", \"left\": \"-1000px\"})\n // Force the sidebar open by focusing a link inside it.\n // This makes it easier for keyboard users to get to it.\n focus: \".sidebar-title a\"\n-assert-css: (\".sidebar-elems\", {\"display\": \"block\", \"left\": \"0px\"})\n+assert-css: (\".sidebar\", {\"display\": \"block\", \"left\": \"0px\"})\n // When we tab out of the sidebar, close it.\n focus: \".search-input\"\n-assert-css: (\".sidebar-elems\", {\"display\": \"block\", \"left\": \"-246px\"})\n+assert-css: (\".sidebar\", {\"display\": \"block\", \"left\": \"-1000px\"})\n \n // Open the sidebar menu.\n-click: \".sidebar-menu\"\n-assert-css: (\".sidebar-elems\", {\"left\": \"0px\"})\n+click: \".sidebar-menu-toggle\"\n+assert-css: (\".sidebar\", {\"left\": \"0px\"})\n \n // Click elsewhere.\n click: \"body\"\n-assert-css: (\".sidebar-elems\", {\"left\": \"-246px\"})\n+assert-css: (\".sidebar\", {\"display\": \"block\", \"left\": \"-1000px\"})\n+\n+// Check that the topbar is visible\n+assert-property: (\".mobile-topbar\", {\"clientHeight\": \"45\"})"}, {"sha": "1c5eb9239ba8bba6468a73153205a0e4d10a8513", "filename": "src/test/rustdoc-gui/sidebar-source-code.goml", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fsidebar-source-code.goml", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fsidebar-source-code.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsidebar-source-code.goml?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -10,6 +10,7 @@ click: (10, 10)\n // We wait for the sidebar to be expanded (there is a 0.5s animation).\n wait-for: 600\n assert-css: (\"nav.sidebar.expanded\", {\"width\": \"300px\"})\n+assert-css: (\"nav.sidebar.expanded a\", {\"font-size\": \"14.4px\"})\n // We collapse the sidebar.\n click: (10, 10)\n // We wait for the sidebar to be collapsed (there is a 0.5s animation).\n@@ -30,3 +31,6 @@ click: (10, 10)\n // We ensure that the class has been removed.\n assert-false: \"nav.sidebar.expanded\"\n assert: \"nav.sidebar\"\n+\n+// Check that the topbar is not visible\n+assert-property: (\".mobile-topbar\", {\"offsetParent\": \"null\"})"}, {"sha": "a1175525858200b390f243e3e1d5399dec222256", "filename": "src/test/rustdoc-gui/sidebar.goml", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fsidebar.goml", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Fsidebar.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsidebar.goml?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -1,8 +1,14 @@\n goto: file://|DOC_PATH|/test_docs/index.html\n+show-text: true\n+local-storage: {\"rustdoc-theme\": \"light\"}\n+// We reload the page so the local storage settings are being used.\n+reload:\n+\n assert-text: (\".sidebar > .location\", \"Crate test_docs\")\n // In modules, we only have one \"location\" element.\n assert-count: (\".sidebar .location\", 1)\n-assert-text: (\".sidebar-elems > #all-types\", \"See all test_docs's items\")\n+assert-text: (\"#all-types\", \"All Items\")\n+assert-css: (\"#all-types\", {\"color\": \"rgb(56, 115, 173)\"})\n // We check that we have the crates list and that the \"current\" on is \"test_docs\".\n assert-text: (\".sidebar-elems .crate > ul > li > a.current\", \"test_docs\")\n // And we're also supposed to have the list of items in the current module.\n@@ -24,13 +30,14 @@ assert-count: (\".sidebar .location\", 2)\n assert-false: \".sidebar-elems > .crate\"\n \n click: \".sidebar-links a\"\n-assert-property: (\"html\", {\"scrollTop\": \"389\"})\n+assert-property-false: (\"html\", {\"scrollTop\": \"0\"})\n \n-click: \".sidebar h2.location\"\n+click: \".sidebar h2.location a\"\n assert-property: (\"html\", {\"scrollTop\": \"0\"})\n \n // We now go back to the crate page to click on the \"lib2\" crate link.\n goto: file://|DOC_PATH|/test_docs/index.html\n+assert-css: (\".sidebar-elems .crate > ul > li:first-child > a\", {\"color\": \"rgb(56, 115, 173)\"})\n click: \".sidebar-elems .crate > ul > li:first-child > a\"\n \n // PAGE: lib2/index.html\n@@ -51,8 +58,7 @@ click: \"#functions + .item-table .item-left > a\"\n // In items containing no items (like functions or constants) and in modules, we have one\n // \"location\" elements.\n assert-count: (\".sidebar .location\", 1)\n-// There is a \"<br>\" tag between \"in\" and \"lib2\", but it doesn't count as a space.\n-assert-text: (\".sidebar .sidebar-elems .location\", \"Other items inlib2\")\n+assert-text: (\".sidebar .sidebar-elems .location\", \"In lib2\")\n // We check that we don't have the crate list.\n assert-false: \".sidebar-elems > .crate\"\n "}, {"sha": "21874f786f1ad17cc81564f5e6cfa960fcad1965", "filename": "src/test/rustdoc-gui/type-declation-overflow.goml", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Ftype-declation-overflow.goml", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc-gui%2Ftype-declation-overflow.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Ftype-declation-overflow.goml?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -11,7 +11,7 @@ assert-property: (\".item-decl pre\", {\"scrollWidth\": \"1324\"})\n goto: file://|DOC_PATH|/lib2/too_long/type.ReallyLongTypeNameLongLongLong.html\n assert-property: (\"body\", {\"scrollWidth\": \"1100\"})\n // We now check that the section width hasn't grown because of it.\n-assert-property: (\"#main-content\", {\"scrollWidth\": \"840\"})\n+assert-property: (\"#main-content\", {\"scrollWidth\": \"825\"})\n // And now checking that it has scrollable content.\n assert-property: (\".item-decl pre\", {\"scrollWidth\": \"1103\"})\n \n@@ -20,6 +20,13 @@ assert-property: (\".item-decl pre\", {\"scrollWidth\": \"1103\"})\n goto: file://|DOC_PATH|/lib2/too_long/constant.ReallyLongTypeNameLongLongLongConstBecauseWhyNotAConstRightGigaGigaSupraLong.html\n assert-property: (\"body\", {\"scrollWidth\": \"1100\"})\n // We now check that the section width hasn't grown because of it.\n-assert-property: (\"#main-content\", {\"scrollWidth\": \"840\"})\n+assert-property: (\"#main-content\", {\"scrollWidth\": \"825\"})\n // And now checking that it has scrollable content.\n assert-property: (\".item-decl pre\", {\"scrollWidth\": \"950\"})\n+\n+// On mobile:\n+size: (600, 600)\n+goto: file://|DOC_PATH|/lib2/too_long/struct.SuperIncrediblyLongLongLongLongLongLongLongGigaGigaGigaMegaLongLongLongStructName.html\n+assert-property: (\".mobile-topbar .location\", {\"scrollWidth\": \"504\"})\n+assert-property: (\".mobile-topbar .location\", {\"clientWidth\": \"504\"})\n+assert-css: (\".mobile-topbar .location\", {\"overflow-x\": \"hidden\"})"}, {"sha": "08a35339680cd91b76502fc894b5538e2d90e5b5", "filename": "src/test/rustdoc/cap-lints.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc%2Fcap-lints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc%2Fcap-lints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fcap-lints.rs?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -3,7 +3,7 @@\n // therefore should not concern itself with the lints.\n #[deny(warnings)]\n \n-// @has cap_lints/struct.Foo.html //* 'Struct Foo'\n+// @has cap_lints/struct.Foo.html //* 'Foo'\n pub struct Foo {\n     field: i32,\n }"}, {"sha": "8413709f15e909af3052fc62aec17d6e9b616e82", "filename": "src/test/rustdoc/crate-version-escape.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc%2Fcrate-version-escape.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc%2Fcrate-version-escape.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fcrate-version-escape.rs?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -2,5 +2,4 @@\n \n #![crate_name = \"foo\"]\n \n-// @has 'foo/index.html' '//div[@class=\"block version\"]/p' 'Version <script>alert(\"hi\")</script>'\n-// @has 'foo/all.html' '//div[@class=\"block version\"]/p' 'Version <script>alert(\"hi\")</script>'\n+// @has 'foo/index.html' '//li[@class=\"version\"]' 'Version <script>alert(\"hi\")</script>'"}, {"sha": "2592c98530fe44e0292def4385de24f7aa30e967", "filename": "src/test/rustdoc/crate-version.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc%2Fcrate-version.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc%2Fcrate-version.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fcrate-version.rs?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -1,3 +1,3 @@\n // compile-flags: --crate-version=1.3.37\n \n-// @has 'crate_version/index.html' '//div[@class=\"block version\"]/p' 'Version 1.3.37'\n+// @has 'crate_version/index.html' '//*[@class=\"version\"]' 'Version 1.3.37'"}, {"sha": "69e8b856b0a26142cbf6461a5b336f35f42eefe5", "filename": "src/test/rustdoc/titles.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc%2Ftitles.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc%2Ftitles.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Ftitles.rs?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -1,10 +1,11 @@\n #![crate_name = \"foo\"]\n-\n #![feature(rustdoc_internals)]\n \n // @matches 'foo/index.html' '//h1' 'Crate foo'\n+// @matches 'foo/index.html' '//h2[@class=\"location\"]' 'Crate foo'\n \n // @matches 'foo/foo_mod/index.html' '//h1' 'Module foo::foo_mod'\n+// @matches 'foo/foo_mod/index.html' '//h2[@class=\"location\"]' 'Module foo_mod'\n pub mod foo_mod {\n     pub struct __Thing {}\n }\n@@ -18,15 +19,19 @@ extern \"C\" {\n pub fn foo_fn() {}\n \n // @matches 'foo/trait.FooTrait.html' '//h1' 'Trait foo::FooTrait'\n+// @matches 'foo/trait.FooTrait.html' '//h2[@class=\"location\"]' 'FooTrait'\n pub trait FooTrait {}\n \n // @matches 'foo/struct.FooStruct.html' '//h1' 'Struct foo::FooStruct'\n+// @matches 'foo/struct.FooStruct.html' '//h2[@class=\"location\"]' 'FooStruct'\n pub struct FooStruct;\n \n // @matches 'foo/enum.FooEnum.html' '//h1' 'Enum foo::FooEnum'\n+// @matches 'foo/enum.FooEnum.html' '//h2[@class=\"location\"]' 'FooEnum'\n pub enum FooEnum {}\n \n // @matches 'foo/type.FooType.html' '//h1' 'Type Definition foo::FooType'\n+// @matches 'foo/type.FooType.html' '//h2[@class=\"location\"]' 'FooType'\n pub type FooType = FooStruct;\n \n // @matches 'foo/macro.foo_macro.html' '//h1' 'Macro foo::foo_macro'"}, {"sha": "4ecd62cded22e9a22c56ff6c0356978b483002ed", "filename": "src/test/rustdoc/typedef.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc%2Ftypedef.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff476b3009bd0f0137ade6eb02af2794c19066d2/src%2Ftest%2Frustdoc%2Ftypedef.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Ftypedef.rs?ref=ff476b3009bd0f0137ade6eb02af2794c19066d2", "patch": "@@ -12,7 +12,7 @@ impl MyStruct {\n // @has - '//*[@class=\"impl has-srclink\"]//h3[@class=\"code-header in-band\"]' 'impl MyAlias'\n // @has - '//*[@class=\"impl has-srclink\"]//h3[@class=\"code-header in-band\"]' 'impl MyTrait for MyAlias'\n // @has - 'Alias docstring'\n-// @has - '//*[@class=\"sidebar\"]//*[@class=\"location\"]' 'Type Definition MyAlias'\n+// @has - '//*[@class=\"sidebar\"]//*[@class=\"location\"]' 'MyAlias'\n // @has - '//*[@class=\"sidebar\"]//a[@href=\"#implementations\"]' 'Methods'\n // @has - '//*[@class=\"sidebar\"]//a[@href=\"#trait-implementations\"]' 'Trait Implementations'\n /// Alias docstring"}]}