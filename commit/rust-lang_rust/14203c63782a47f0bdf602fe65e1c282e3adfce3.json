{"sha": "14203c63782a47f0bdf602fe65e1c282e3adfce3", "node_id": "C_kwDOAAsO6NoAKDE0MjAzYzYzNzgyYTQ3ZjBiZGY2MDJmZTY1ZTFjMjgyZTNhZGZjZTM", "commit": {"author": {"name": "Jonas Schievink", "email": "jonas.schievink@ferrous-systems.com", "date": "2022-03-18T14:34:31Z"}, "committer": {"name": "Jonas Schievink", "email": "jonas.schievink@ferrous-systems.com", "date": "2022-03-18T14:36:18Z"}, "message": "Complete assoc const patterns on builtin types", "tree": {"sha": "d95554b2291f2f561cc300cbbeec3a3d2e8a8d4e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d95554b2291f2f561cc300cbbeec3a3d2e8a8d4e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/14203c63782a47f0bdf602fe65e1c282e3adfce3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/14203c63782a47f0bdf602fe65e1c282e3adfce3", "html_url": "https://github.com/rust-lang/rust/commit/14203c63782a47f0bdf602fe65e1c282e3adfce3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/14203c63782a47f0bdf602fe65e1c282e3adfce3/comments", "author": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "849ac25f057c4edb4f2f58e479380b82d4967d0c", "url": "https://api.github.com/repos/rust-lang/rust/commits/849ac25f057c4edb4f2f58e479380b82d4967d0c", "html_url": "https://github.com/rust-lang/rust/commit/849ac25f057c4edb4f2f58e479380b82d4967d0c"}], "stats": {"total": 31, "additions": 28, "deletions": 3}, "files": [{"sha": "0d3a49c668d73d54fec1ae36c508150d77284bd1", "filename": "crates/ide_completion/src/completions/pattern.rs", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/14203c63782a47f0bdf602fe65e1c282e3adfce3/crates%2Fide_completion%2Fsrc%2Fcompletions%2Fpattern.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14203c63782a47f0bdf602fe65e1c282e3adfce3/crates%2Fide_completion%2Fsrc%2Fcompletions%2Fpattern.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_completion%2Fsrc%2Fcompletions%2Fpattern.rs?ref=14203c63782a47f0bdf602fe65e1c282e3adfce3", "patch": "@@ -141,7 +141,8 @@ fn pattern_path_completion(\n                 | hir::PathResolution::SelfType(_)\n                 | hir::PathResolution::Def(hir::ModuleDef::Adt(hir::Adt::Struct(_)))\n                 | hir::PathResolution::Def(hir::ModuleDef::Adt(hir::Adt::Enum(_)))\n-                | hir::PathResolution::Def(hir::ModuleDef::Adt(hir::Adt::Union(_)))) => {\n+                | hir::PathResolution::Def(hir::ModuleDef::Adt(hir::Adt::Union(_)))\n+                | hir::PathResolution::Def(hir::ModuleDef::BuiltinType(_))) => {\n                     let ty = match res {\n                         hir::PathResolution::TypeParam(param) => param.ty(ctx.db),\n                         hir::PathResolution::SelfType(impl_def) => impl_def.self_ty(ctx.db),\n@@ -158,6 +159,13 @@ fn pattern_path_completion(\n                         hir::PathResolution::Def(hir::ModuleDef::Adt(hir::Adt::Union(u))) => {\n                             u.ty(ctx.db)\n                         }\n+                        hir::PathResolution::Def(hir::ModuleDef::BuiltinType(ty)) => {\n+                            let module = match ctx.module {\n+                                Some(m) => m,\n+                                None => return,\n+                            };\n+                            ty.ty(ctx.db, module)\n+                        }\n                         _ => return,\n                     };\n "}, {"sha": "405a128b7e0f76c16965b536eb8eec9fa82dfcf0", "filename": "crates/ide_completion/src/tests/pattern.rs", "status": "modified", "additions": 19, "deletions": 2, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/14203c63782a47f0bdf602fe65e1c282e3adfce3/crates%2Fide_completion%2Fsrc%2Ftests%2Fpattern.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14203c63782a47f0bdf602fe65e1c282e3adfce3/crates%2Fide_completion%2Fsrc%2Ftests%2Fpattern.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_completion%2Fsrc%2Ftests%2Fpattern.rs?ref=14203c63782a47f0bdf602fe65e1c282e3adfce3", "patch": "@@ -493,7 +493,6 @@ fn f(e: MyEnum) {\n \n     check_empty(\n         r#\"\n-#[repr(C)]\n union U {\n     i: i32,\n     f: f32,\n@@ -515,5 +514,23 @@ fn f(u: U) {\n             ct C pub const C: i32\n             ct D pub const D: i32\n         \"#]],\n-    )\n+    );\n+\n+    check_empty(\n+        r#\"\n+#[lang = \"u32\"]\n+impl u32 {\n+    pub const MIN: Self = 0;\n+}\n+\n+fn f(v: u32) {\n+    match v {\n+        u32::$0\n+    }\n+}\n+        \"#,\n+        expect![[r#\"\n+            ct MIN pub const MIN: Self\n+        \"#]],\n+    );\n }"}]}