{"sha": "fc2aa3fe0ec13c8d6150a877d7193473aabc58c9", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZjMmFhM2ZlMGVjMTNjOGQ2MTUwYTg3N2Q3MTkzNDczYWFiYzU4Yzk=", "commit": {"author": {"name": "memoryruins", "email": "memoryruinsmusic@gmail.com", "date": "2018-10-29T04:09:32Z"}, "committer": {"name": "memoryruins", "email": "memoryruinsmusic@gmail.com", "date": "2018-10-29T04:09:32Z"}, "message": "Add UI test for #49296", "tree": {"sha": "69f2103edd3dc3517037869fcf3a1a8c2f10b9cc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/69f2103edd3dc3517037869fcf3a1a8c2f10b9cc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fc2aa3fe0ec13c8d6150a877d7193473aabc58c9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fc2aa3fe0ec13c8d6150a877d7193473aabc58c9", "html_url": "https://github.com/rust-lang/rust/commit/fc2aa3fe0ec13c8d6150a877d7193473aabc58c9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fc2aa3fe0ec13c8d6150a877d7193473aabc58c9/comments", "author": {"login": "memoryruins", "id": 6868531, "node_id": "MDQ6VXNlcjY4Njg1MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/6868531?v=4", "gravatar_id": "", "url": "https://api.github.com/users/memoryruins", "html_url": "https://github.com/memoryruins", "followers_url": "https://api.github.com/users/memoryruins/followers", "following_url": "https://api.github.com/users/memoryruins/following{/other_user}", "gists_url": "https://api.github.com/users/memoryruins/gists{/gist_id}", "starred_url": "https://api.github.com/users/memoryruins/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/memoryruins/subscriptions", "organizations_url": "https://api.github.com/users/memoryruins/orgs", "repos_url": "https://api.github.com/users/memoryruins/repos", "events_url": "https://api.github.com/users/memoryruins/events{/privacy}", "received_events_url": "https://api.github.com/users/memoryruins/received_events", "type": "User", "site_admin": false}, "committer": {"login": "memoryruins", "id": 6868531, "node_id": "MDQ6VXNlcjY4Njg1MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/6868531?v=4", "gravatar_id": "", "url": "https://api.github.com/users/memoryruins", "html_url": "https://github.com/memoryruins", "followers_url": "https://api.github.com/users/memoryruins/followers", "following_url": "https://api.github.com/users/memoryruins/following{/other_user}", "gists_url": "https://api.github.com/users/memoryruins/gists{/gist_id}", "starred_url": "https://api.github.com/users/memoryruins/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/memoryruins/subscriptions", "organizations_url": "https://api.github.com/users/memoryruins/orgs", "repos_url": "https://api.github.com/users/memoryruins/repos", "events_url": "https://api.github.com/users/memoryruins/events{/privacy}", "received_events_url": "https://api.github.com/users/memoryruins/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bcb05a0ab23291851d0a233547f2ad3cbb9cc222", "url": "https://api.github.com/repos/rust-lang/rust/commits/bcb05a0ab23291851d0a233547f2ad3cbb9cc222", "html_url": "https://github.com/rust-lang/rust/commit/bcb05a0ab23291851d0a233547f2ad3cbb9cc222"}], "stats": {"total": 35, "additions": 35, "deletions": 0}, "files": [{"sha": "a7c3c5318d4306b21c33e06af02eac8c66c21131", "filename": "src/test/ui/consts/const-eval/issue-49296.rs", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/fc2aa3fe0ec13c8d6150a877d7193473aabc58c9/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fissue-49296.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fc2aa3fe0ec13c8d6150a877d7193473aabc58c9/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fissue-49296.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fissue-49296.rs?ref=fc2aa3fe0ec13c8d6150a877d7193473aabc58c9", "patch": "@@ -0,0 +1,23 @@\n+// issue-49296: Unsafe shenigans in constants can result in missing errors\n+\n+#![feature(const_fn)]\n+#![feature(const_fn_union)]\n+\n+const unsafe fn transmute<T: Copy, U: Copy>(t: T) -> U {\n+    union Transmute<T: Copy, U: Copy> {\n+        from: T,\n+        to: U,\n+    }\n+\n+    Transmute { from: t }.to\n+}\n+\n+const fn wat(x: u64) -> &'static u64 {\n+    unsafe { transmute(&x) }\n+}\n+const X: u64 = *wat(42);\n+//~^ ERROR any use of this value will cause an error\n+\n+fn main() {\n+    println!(\"{}\", X);\n+}"}, {"sha": "37462db4c965e4308533e658cf064d91f2f39c7f", "filename": "src/test/ui/consts/const-eval/issue-49296.stderr", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/fc2aa3fe0ec13c8d6150a877d7193473aabc58c9/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fissue-49296.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fc2aa3fe0ec13c8d6150a877d7193473aabc58c9/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fissue-49296.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fissue-49296.stderr?ref=fc2aa3fe0ec13c8d6150a877d7193473aabc58c9", "patch": "@@ -0,0 +1,12 @@\n+error: any use of this value will cause an error\n+  --> $DIR/issue-49296.rs:18:1\n+   |\n+LL | const X: u64 = *wat(42);\n+   | ^^^^^^^^^^^^^^^--------^\n+   |                |\n+   |                dangling pointer was dereferenced\n+   |\n+   = note: #[deny(const_err)] on by default\n+\n+error: aborting due to previous error\n+"}]}