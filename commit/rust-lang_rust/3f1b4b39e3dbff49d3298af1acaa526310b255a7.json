{"sha": "3f1b4b39e3dbff49d3298af1acaa526310b255a7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNmMWI0YjM5ZTNkYmZmNDlkMzI5OGFmMWFjYWE1MjYzMTBiMjU1YTc=", "commit": {"author": {"name": "Jacob Hughes", "email": "j@jacobhughes.me", "date": "2020-09-23T02:54:52Z"}, "committer": {"name": "Jacob Hughes", "email": "j@jacobhughes.me", "date": "2020-09-23T02:54:52Z"}, "message": "Fix compilation & test failures", "tree": {"sha": "987d271bcec26db1ff27b0ca0c1c2db9821f8ce5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/987d271bcec26db1ff27b0ca0c1c2db9821f8ce5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3f1b4b39e3dbff49d3298af1acaa526310b255a7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3f1b4b39e3dbff49d3298af1acaa526310b255a7", "html_url": "https://github.com/rust-lang/rust/commit/3f1b4b39e3dbff49d3298af1acaa526310b255a7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3f1b4b39e3dbff49d3298af1acaa526310b255a7/comments", "author": {"login": "exrook", "id": 534850, "node_id": "MDQ6VXNlcjUzNDg1MA==", "avatar_url": "https://avatars.githubusercontent.com/u/534850?v=4", "gravatar_id": "", "url": "https://api.github.com/users/exrook", "html_url": "https://github.com/exrook", "followers_url": "https://api.github.com/users/exrook/followers", "following_url": "https://api.github.com/users/exrook/following{/other_user}", "gists_url": "https://api.github.com/users/exrook/gists{/gist_id}", "starred_url": "https://api.github.com/users/exrook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/exrook/subscriptions", "organizations_url": "https://api.github.com/users/exrook/orgs", "repos_url": "https://api.github.com/users/exrook/repos", "events_url": "https://api.github.com/users/exrook/events{/privacy}", "received_events_url": "https://api.github.com/users/exrook/received_events", "type": "User", "site_admin": false}, "committer": {"login": "exrook", "id": 534850, "node_id": "MDQ6VXNlcjUzNDg1MA==", "avatar_url": "https://avatars.githubusercontent.com/u/534850?v=4", "gravatar_id": "", "url": "https://api.github.com/users/exrook", "html_url": "https://github.com/exrook", "followers_url": "https://api.github.com/users/exrook/followers", "following_url": "https://api.github.com/users/exrook/following{/other_user}", "gists_url": "https://api.github.com/users/exrook/gists{/gist_id}", "starred_url": "https://api.github.com/users/exrook/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/exrook/subscriptions", "organizations_url": "https://api.github.com/users/exrook/orgs", "repos_url": "https://api.github.com/users/exrook/repos", "events_url": "https://api.github.com/users/exrook/events{/privacy}", "received_events_url": "https://api.github.com/users/exrook/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d281620d8f630346ea96c8c65b9fd7f5b7f1da9e", "url": "https://api.github.com/repos/rust-lang/rust/commits/d281620d8f630346ea96c8c65b9fd7f5b7f1da9e", "html_url": "https://github.com/rust-lang/rust/commit/d281620d8f630346ea96c8c65b9fd7f5b7f1da9e"}], "stats": {"total": 74, "additions": 40, "deletions": 34}, "files": [{"sha": "b807dff5fd25dfcee64692ab6e1d48337f36968a", "filename": "compiler/rustc_passes/src/stability.rs", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/3f1b4b39e3dbff49d3298af1acaa526310b255a7/compiler%2Frustc_passes%2Fsrc%2Fstability.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3f1b4b39e3dbff49d3298af1acaa526310b255a7/compiler%2Frustc_passes%2Fsrc%2Fstability.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Fstability.rs?ref=3f1b4b39e3dbff49d3298af1acaa526310b255a7", "patch": "@@ -43,6 +43,7 @@ enum AnnotationKind {\n /// have separate deprecation attributes from their parents, so we do not wish to inherit\n /// deprecation in this case. For example, inheriting deprecation for `T` in `Foo<T>`\n /// would cause a duplicate warning arising from both `Foo` and `T` being deprecated.\n+#[derive(Clone)]\n enum InheritDeprecation {\n     Yes,\n     No,\n@@ -81,7 +82,7 @@ impl<'a, 'tcx> Annotator<'a, 'tcx> {\n         debug!(\"annotate(id = {:?}, attrs = {:?})\", hir_id, attrs);\n         let mut did_error = false;\n         if !self.tcx.features().staged_api {\n-            did_error = self.forbid_staged_api_attrs(hir_id, attrs, inherit_deprecation);\n+            did_error = self.forbid_staged_api_attrs(hir_id, attrs, inherit_deprecation.clone());\n         }\n \n         let depr =\n@@ -257,7 +258,12 @@ impl<'a, 'tcx> Annotator<'a, 'tcx> {\n     }\n \n     // returns true if an error occurred, used to suppress some spurious errors\n-    fn forbid_staged_api_attrs(&mut self, hir_id: HirId, attrs: &[Attribute], inherit_deprecation: InheritDeprecation) -> bool {\n+    fn forbid_staged_api_attrs(\n+        &mut self,\n+        hir_id: HirId,\n+        attrs: &[Attribute],\n+        inherit_deprecation: InheritDeprecation,\n+    ) -> bool {\n         // Emit errors for non-staged-api crates.\n         let unstable_attrs = [\n             sym::unstable,"}, {"sha": "461b1d405cb1013065df692677d67722a56b1b66", "filename": "src/test/ui/stability-attribute/generics-default-stability.rs", "status": "modified", "additions": 16, "deletions": 16, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/3f1b4b39e3dbff49d3298af1acaa526310b255a7/src%2Ftest%2Fui%2Fstability-attribute%2Fgenerics-default-stability.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3f1b4b39e3dbff49d3298af1acaa526310b255a7/src%2Ftest%2Fui%2Fstability-attribute%2Fgenerics-default-stability.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fstability-attribute%2Fgenerics-default-stability.rs?ref=3f1b4b39e3dbff49d3298af1acaa526310b255a7", "patch": "@@ -82,30 +82,30 @@ fn main() {\n \n     let _ = STRUCT4;\n     let _: Struct4<isize> = Struct4 { field: 1 };\n-    //~^ use of deprecated item 'unstable_generic_param::Struct4': test [deprecated]\n-    //~^^ use of deprecated item 'unstable_generic_param::Struct4': test [deprecated]\n-    //~^^^ use of deprecated item 'unstable_generic_param::Struct4::field': test [deprecated]\n+    //~^ use of deprecated struct `unstable_generic_param::Struct4`: test [deprecated]\n+    //~^^ use of deprecated struct `unstable_generic_param::Struct4`: test [deprecated]\n+    //~^^^ use of deprecated field `unstable_generic_param::Struct4::field`: test [deprecated]\n     let _ = STRUCT4;\n-    let _: Struct4 = STRUCT4; //~ use of deprecated item 'unstable_generic_param::Struct4': test [deprecated]\n-    let _: Struct4<usize> = STRUCT4; //~ use of deprecated item 'unstable_generic_param::Struct4': test [deprecated]\n+    let _: Struct4 = STRUCT4; //~ use of deprecated struct `unstable_generic_param::Struct4`: test [deprecated]\n+    let _: Struct4<usize> = STRUCT4; //~ use of deprecated struct `unstable_generic_param::Struct4`: test [deprecated]\n     let _: Struct4<isize> = Struct4 { field: 0 };\n-    //~^ use of deprecated item 'unstable_generic_param::Struct4': test [deprecated]\n-    //~^^ use of deprecated item 'unstable_generic_param::Struct4': test [deprecated]\n-    //~^^^ use of deprecated item 'unstable_generic_param::Struct4::field': test [deprecated]\n+    //~^ use of deprecated struct `unstable_generic_param::Struct4`: test [deprecated]\n+    //~^^ use of deprecated struct `unstable_generic_param::Struct4`: test [deprecated]\n+    //~^^^ use of deprecated field `unstable_generic_param::Struct4::field`: test [deprecated]\n \n     let _ = STRUCT5;\n     let _: Struct5<isize> = Struct5 { field: 1 }; //~ ERROR use of unstable library feature 'unstable_default'\n-    //~^ use of deprecated item 'unstable_generic_param::Struct5': test [deprecated]\n-    //~^^ use of deprecated item 'unstable_generic_param::Struct5': test [deprecated]\n-    //~^^^ use of deprecated item 'unstable_generic_param::Struct5::field': test [deprecated]\n+    //~^ use of deprecated struct `unstable_generic_param::Struct5`: test [deprecated]\n+    //~^^ use of deprecated struct `unstable_generic_param::Struct5`: test [deprecated]\n+    //~^^^ use of deprecated field `unstable_generic_param::Struct5::field`: test [deprecated]\n     let _ = STRUCT5;\n-    let _: Struct5 = STRUCT5; //~ use of deprecated item 'unstable_generic_param::Struct5': test [deprecated]\n+    let _: Struct5 = STRUCT5; //~ use of deprecated struct `unstable_generic_param::Struct5`: test [deprecated]\n     let _: Struct5<usize> = STRUCT5; //~ ERROR use of unstable library feature 'unstable_default'\n-    //~^ use of deprecated item 'unstable_generic_param::Struct5': test [deprecated]\n+    //~^ use of deprecated struct `unstable_generic_param::Struct5`: test [deprecated]\n     let _: Struct5<isize> = Struct5 { field: 0 }; //~ ERROR use of unstable library feature 'unstable_default'\n-    //~^ use of deprecated item 'unstable_generic_param::Struct5': test [deprecated]\n-    //~^^ use of deprecated item 'unstable_generic_param::Struct5': test [deprecated]\n-    //~^^^ use of deprecated item 'unstable_generic_param::Struct5::field': test [deprecated]\n+    //~^ use of deprecated struct `unstable_generic_param::Struct5`: test [deprecated]\n+    //~^^ use of deprecated struct `unstable_generic_param::Struct5`: test [deprecated]\n+    //~^^^ use of deprecated field `unstable_generic_param::Struct5::field`: test [deprecated]\n \n     let _: Struct6<isize> = Struct6 { field: 1 }; // ok\n     let _: Struct6<isize> = Struct6 { field: 0 }; // ok"}, {"sha": "d9b238f8841bdf0bb991d40ab0f82e3314d4bb47", "filename": "src/test/ui/stability-attribute/generics-default-stability.stderr", "status": "modified", "additions": 16, "deletions": 16, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/3f1b4b39e3dbff49d3298af1acaa526310b255a7/src%2Ftest%2Fui%2Fstability-attribute%2Fgenerics-default-stability.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3f1b4b39e3dbff49d3298af1acaa526310b255a7/src%2Ftest%2Fui%2Fstability-attribute%2Fgenerics-default-stability.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fstability-attribute%2Fgenerics-default-stability.stderr?ref=3f1b4b39e3dbff49d3298af1acaa526310b255a7", "patch": "@@ -22,75 +22,75 @@ LL | impl Trait2<usize> for S {\n    |\n    = help: add `#![feature(unstable_default)]` to the crate attributes to enable\n \n-warning: use of deprecated item 'unstable_generic_param::Struct4': test\n+warning: use of deprecated struct `unstable_generic_param::Struct4`: test\n   --> $DIR/generics-default-stability.rs:84:29\n    |\n LL |     let _: Struct4<isize> = Struct4 { field: 1 };\n    |                             ^^^^^^^\n    |\n    = note: `#[warn(deprecated)]` on by default\n \n-warning: use of deprecated item 'unstable_generic_param::Struct4': test\n+warning: use of deprecated struct `unstable_generic_param::Struct4`: test\n   --> $DIR/generics-default-stability.rs:84:12\n    |\n LL |     let _: Struct4<isize> = Struct4 { field: 1 };\n    |            ^^^^^^^^^^^^^^\n \n-warning: use of deprecated item 'unstable_generic_param::Struct4': test\n+warning: use of deprecated struct `unstable_generic_param::Struct4`: test\n   --> $DIR/generics-default-stability.rs:89:12\n    |\n LL |     let _: Struct4 = STRUCT4;\n    |            ^^^^^^^\n \n-warning: use of deprecated item 'unstable_generic_param::Struct4': test\n+warning: use of deprecated struct `unstable_generic_param::Struct4`: test\n   --> $DIR/generics-default-stability.rs:90:12\n    |\n LL |     let _: Struct4<usize> = STRUCT4;\n    |            ^^^^^^^^^^^^^^\n \n-warning: use of deprecated item 'unstable_generic_param::Struct4': test\n+warning: use of deprecated struct `unstable_generic_param::Struct4`: test\n   --> $DIR/generics-default-stability.rs:91:29\n    |\n LL |     let _: Struct4<isize> = Struct4 { field: 0 };\n    |                             ^^^^^^^\n \n-warning: use of deprecated item 'unstable_generic_param::Struct4': test\n+warning: use of deprecated struct `unstable_generic_param::Struct4`: test\n   --> $DIR/generics-default-stability.rs:91:12\n    |\n LL |     let _: Struct4<isize> = Struct4 { field: 0 };\n    |            ^^^^^^^^^^^^^^\n \n-warning: use of deprecated item 'unstable_generic_param::Struct5': test\n+warning: use of deprecated struct `unstable_generic_param::Struct5`: test\n   --> $DIR/generics-default-stability.rs:97:29\n    |\n LL |     let _: Struct5<isize> = Struct5 { field: 1 };\n    |                             ^^^^^^^\n \n-warning: use of deprecated item 'unstable_generic_param::Struct5': test\n+warning: use of deprecated struct `unstable_generic_param::Struct5`: test\n   --> $DIR/generics-default-stability.rs:97:12\n    |\n LL |     let _: Struct5<isize> = Struct5 { field: 1 };\n    |            ^^^^^^^^^^^^^^\n \n-warning: use of deprecated item 'unstable_generic_param::Struct5': test\n+warning: use of deprecated struct `unstable_generic_param::Struct5`: test\n   --> $DIR/generics-default-stability.rs:102:12\n    |\n LL |     let _: Struct5 = STRUCT5;\n    |            ^^^^^^^\n \n-warning: use of deprecated item 'unstable_generic_param::Struct5': test\n+warning: use of deprecated struct `unstable_generic_param::Struct5`: test\n   --> $DIR/generics-default-stability.rs:103:12\n    |\n LL |     let _: Struct5<usize> = STRUCT5;\n    |            ^^^^^^^^^^^^^^\n \n-warning: use of deprecated item 'unstable_generic_param::Struct5': test\n+warning: use of deprecated struct `unstable_generic_param::Struct5`: test\n   --> $DIR/generics-default-stability.rs:105:29\n    |\n LL |     let _: Struct5<isize> = Struct5 { field: 0 };\n    |                             ^^^^^^^\n \n-warning: use of deprecated item 'unstable_generic_param::Struct5': test\n+warning: use of deprecated struct `unstable_generic_param::Struct5`: test\n   --> $DIR/generics-default-stability.rs:105:12\n    |\n LL |     let _: Struct5<isize> = Struct5 { field: 0 };\n@@ -176,25 +176,25 @@ LL |     let _: Box1<isize, System> = Box1::new(1);\n    |\n    = help: add `#![feature(box_alloc_param)]` to the crate attributes to enable\n \n-warning: use of deprecated item 'unstable_generic_param::Struct4::field': test\n+warning: use of deprecated field `unstable_generic_param::Struct4::field`: test\n   --> $DIR/generics-default-stability.rs:84:39\n    |\n LL |     let _: Struct4<isize> = Struct4 { field: 1 };\n    |                                       ^^^^^^^^\n \n-warning: use of deprecated item 'unstable_generic_param::Struct4::field': test\n+warning: use of deprecated field `unstable_generic_param::Struct4::field`: test\n   --> $DIR/generics-default-stability.rs:91:39\n    |\n LL |     let _: Struct4<isize> = Struct4 { field: 0 };\n    |                                       ^^^^^^^^\n \n-warning: use of deprecated item 'unstable_generic_param::Struct5::field': test\n+warning: use of deprecated field `unstable_generic_param::Struct5::field`: test\n   --> $DIR/generics-default-stability.rs:97:39\n    |\n LL |     let _: Struct5<isize> = Struct5 { field: 1 };\n    |                                       ^^^^^^^^\n \n-warning: use of deprecated item 'unstable_generic_param::Struct5::field': test\n+warning: use of deprecated field `unstable_generic_param::Struct5::field`: test\n   --> $DIR/generics-default-stability.rs:105:39\n    |\n LL |     let _: Struct5<isize> = Struct5 { field: 0 };"}]}