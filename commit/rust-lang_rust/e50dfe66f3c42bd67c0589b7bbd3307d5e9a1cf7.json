{"sha": "e50dfe66f3c42bd67c0589b7bbd3307d5e9a1cf7", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU1MGRmZTY2ZjNjNDJiZDY3YzA1ODliN2JiZDMzMDdkNWU5YTFjZjc=", "commit": {"author": {"name": "Wesley Wiser", "email": "wwiser@gmail.com", "date": "2018-06-06T01:37:31Z"}, "committer": {"name": "Wesley Wiser", "email": "wwiser@gmail.com", "date": "2018-08-02T22:57:24Z"}, "message": "Fix more missed query data", "tree": {"sha": "ee008c437c1807e351c94f493b767bd8d9f1a449", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ee008c437c1807e351c94f493b767bd8d9f1a449"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e50dfe66f3c42bd67c0589b7bbd3307d5e9a1cf7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e50dfe66f3c42bd67c0589b7bbd3307d5e9a1cf7", "html_url": "https://github.com/rust-lang/rust/commit/e50dfe66f3c42bd67c0589b7bbd3307d5e9a1cf7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e50dfe66f3c42bd67c0589b7bbd3307d5e9a1cf7/comments", "author": {"login": "wesleywiser", "id": 831192, "node_id": "MDQ6VXNlcjgzMTE5Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/831192?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wesleywiser", "html_url": "https://github.com/wesleywiser", "followers_url": "https://api.github.com/users/wesleywiser/followers", "following_url": "https://api.github.com/users/wesleywiser/following{/other_user}", "gists_url": "https://api.github.com/users/wesleywiser/gists{/gist_id}", "starred_url": "https://api.github.com/users/wesleywiser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wesleywiser/subscriptions", "organizations_url": "https://api.github.com/users/wesleywiser/orgs", "repos_url": "https://api.github.com/users/wesleywiser/repos", "events_url": "https://api.github.com/users/wesleywiser/events{/privacy}", "received_events_url": "https://api.github.com/users/wesleywiser/received_events", "type": "User", "site_admin": false}, "committer": {"login": "wesleywiser", "id": 831192, "node_id": "MDQ6VXNlcjgzMTE5Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/831192?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wesleywiser", "html_url": "https://github.com/wesleywiser", "followers_url": "https://api.github.com/users/wesleywiser/followers", "following_url": "https://api.github.com/users/wesleywiser/following{/other_user}", "gists_url": "https://api.github.com/users/wesleywiser/gists{/gist_id}", "starred_url": "https://api.github.com/users/wesleywiser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wesleywiser/subscriptions", "organizations_url": "https://api.github.com/users/wesleywiser/orgs", "repos_url": "https://api.github.com/users/wesleywiser/repos", "events_url": "https://api.github.com/users/wesleywiser/events{/privacy}", "received_events_url": "https://api.github.com/users/wesleywiser/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d3aa593a6b339ae1475aa50e564e2774057faaa5", "url": "https://api.github.com/repos/rust-lang/rust/commits/d3aa593a6b339ae1475aa50e564e2774057faaa5", "html_url": "https://github.com/rust-lang/rust/commit/d3aa593a6b339ae1475aa50e564e2774057faaa5"}], "stats": {"total": 9, "additions": 9, "deletions": 0}, "files": [{"sha": "0fa643d796e0e1c7a3451ad84c35b9f133bcd78e", "filename": "src/librustc/ty/query/plumbing.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/e50dfe66f3c42bd67c0589b7bbd3307d5e9a1cf7/src%2Flibrustc%2Fty%2Fquery%2Fplumbing.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e50dfe66f3c42bd67c0589b7bbd3307d5e9a1cf7/src%2Flibrustc%2Fty%2Fquery%2Fplumbing.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fquery%2Fplumbing.rs?ref=e50dfe66f3c42bd67c0589b7bbd3307d5e9a1cf7", "patch": "@@ -369,6 +369,7 @@ impl<'a, 'gcx, 'tcx> TyCtxt<'a, 'gcx, 'tcx> {\n             TryGetJob::NotYetStarted(job) => job,\n             TryGetJob::JobCompleted(result) => {\n                 return result.map(|(v, index)| {\n+                    self.sess.profiler(|p| p.record_query_hit(Q::CATEGORY));\n                     self.dep_graph.read_index(index);\n                     v\n                 })\n@@ -592,7 +593,15 @@ impl<'a, 'gcx, 'tcx> TyCtxt<'a, 'gcx, 'tcx> {\n             // DepNodeIndex. We must invoke the query itself. The performance cost\n             // this introduces should be negligible as we'll immediately hit the\n             // in-memory cache, or another query down the line will.\n+\n+            self.sess.profiler(|p| {\n+                p.start_activity(Q::CATEGORY);\n+                p.record_query(Q::CATEGORY);\n+            });\n+\n             let _ = self.get_query::<Q>(DUMMY_SP, key);\n+\n+            self.sess.profiler(|p| p.end_activity(Q::CATEGORY));\n         }\n     }\n "}]}