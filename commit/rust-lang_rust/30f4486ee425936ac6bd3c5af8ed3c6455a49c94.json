{"sha": "30f4486ee425936ac6bd3c5af8ed3c6455a49c94", "node_id": "MDY6Q29tbWl0NzI0NzEyOjMwZjQ0ODZlZTQyNTkzNmFjNmJkM2M1YWY4ZWQzYzY0NTVhNDljOTQ=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-05-24T16:53:35Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-05-24T16:53:35Z"}, "message": "Rollup merge of #85551 - GuillaumeGomez:fix-search-result-overflow, r=jsha\n\nFix search results display\n\nFixes https://github.com/rust-lang/rust/issues/85544.\n\ncc `@dns2utf8`\n\nr? `@jsha`", "tree": {"sha": "9d7439e707cd2f25830efe5c1a472727dc1d9319", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9d7439e707cd2f25830efe5c1a472727dc1d9319"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/30f4486ee425936ac6bd3c5af8ed3c6455a49c94", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgq9oPCRBK7hj4Ov3rIwAAYUQIAI1j7J1b0tnInWSla3BvKtff\nGXpEsLbw5eS3bEMfq6p1x9iT1uBMazy9kFMaJcJtdvngTRldQudNv+Jo5wnD018i\n+MOSGZoRuZb9SyQ1WqupWm1egKeNoyjZfQaGVrYmxhu1rxsHqznn7VtwYWi0xH0A\nSwLvxEGAHEeknYENRZgK8s0O0nxVuHno1NkvmtlYB09iCx4/Ju1fkk+xeAylviaD\nP3qxVdK5fOMoFw7Xk9YkWv0f2tTN/Jx1LdzRR/F6DWiPCbWtmAOzabULC0JoOlwG\nCFsPlQ4soRFDofOZDi4nXuWBpn1eShUTjysPL5MZRyt6s2zA4CY3tbiBry59uuY=\n=ItVc\n-----END PGP SIGNATURE-----\n", "payload": "tree 9d7439e707cd2f25830efe5c1a472727dc1d9319\nparent 2a8eeafa9df6c04e21cdc6b31b798977c68253c3\nparent 8968c0e48f460d042f20d79aa0ff8ef6b317f086\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1621875215 +0200\ncommitter GitHub <noreply@github.com> 1621875215 +0200\n\nRollup merge of #85551 - GuillaumeGomez:fix-search-result-overflow, r=jsha\n\nFix search results display\n\nFixes https://github.com/rust-lang/rust/issues/85544.\n\ncc `@dns2utf8`\n\nr? `@jsha`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/30f4486ee425936ac6bd3c5af8ed3c6455a49c94", "html_url": "https://github.com/rust-lang/rust/commit/30f4486ee425936ac6bd3c5af8ed3c6455a49c94", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/30f4486ee425936ac6bd3c5af8ed3c6455a49c94/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2a8eeafa9df6c04e21cdc6b31b798977c68253c3", "url": "https://api.github.com/repos/rust-lang/rust/commits/2a8eeafa9df6c04e21cdc6b31b798977c68253c3", "html_url": "https://github.com/rust-lang/rust/commit/2a8eeafa9df6c04e21cdc6b31b798977c68253c3"}, {"sha": "8968c0e48f460d042f20d79aa0ff8ef6b317f086", "url": "https://api.github.com/repos/rust-lang/rust/commits/8968c0e48f460d042f20d79aa0ff8ef6b317f086", "html_url": "https://github.com/rust-lang/rust/commit/8968c0e48f460d042f20d79aa0ff8ef6b317f086"}], "stats": {"total": 53, "additions": 46, "deletions": 7}, "files": [{"sha": "5ee92cce6552f4aba81d13e84a28579cbd9ac13b", "filename": "src/librustdoc/html/static/rustdoc.css", "status": "modified", "additions": 32, "deletions": 5, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/30f4486ee425936ac6bd3c5af8ed3c6455a49c94/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/30f4486ee425936ac6bd3c5af8ed3c6455a49c94/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css?ref=30f4486ee425936ac6bd3c5af8ed3c6455a49c94", "patch": "@@ -759,25 +759,40 @@ a {\n \n .search-results.active {\n \tdisplay: block;\n+\t/* prevent overhanging tabs from moving the first result */\n+\tclear: both;\n }\n \n-.search-results .desc {\n+.search-results .desc > span {\n \twhite-space: nowrap;\n \ttext-overflow: ellipsis;\n \toverflow: hidden;\n \tdisplay: block;\n }\n \n-.search-results a {\n+.search-results > a {\n+\tdisplay: block;\n+\twidth: 100%;\n \t/* A little margin ensures the browser's outlining of focused links has room to display. */\n \tmargin-left: 2px;\n \tmargin-right: 2px;\n-\tdisplay: block;\n+\tborder-bottom: 1px solid #aaa3;\n+}\n+\n+.search-results > a > div {\n+\tdisplay: flex;\n+\tflex-flow: row wrap;\n }\n \n-.result-name {\n+.search-results .result-name, .search-results div.desc, .search-results .result-description {\n \twidth: 50%;\n-\tfloat: left;\n+}\n+.search-results .result-name {\n+\tpadding-right: 1em;\n+}\n+\n+.search-results .result-name > span {\n+\tdisplay: inline-block;\n }\n \n .result-name span.primitive::after {\n@@ -1733,6 +1748,18 @@ details.undocumented[open] > summary::before {\n \t.search-container > div {\n \t\twidth: calc(100% - 32px);\n \t}\n+\n+\t/* Display an alternating layout on tablets and phones */\n+\t.search-results > a {\n+\t\tborder-bottom: 1px solid #aaa9;\n+\t\tpadding: 5px 0px;\n+\t}\n+\t.search-results .result-name, .search-results div.desc, .search-results .result-description {\n+\t\twidth: 100%;\n+\t}\n+\t.search-results div.desc, .search-results .result-description {\n+\t\tpadding-left: 2em;\n+\t}\n }\n \n @media print {"}, {"sha": "634e5fa57870828d634bad3cca9ea919f295ed00", "filename": "src/librustdoc/html/static/search.js", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/30f4486ee425936ac6bd3c5af8ed3c6455a49c94/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fsearch.js", "raw_url": "https://github.com/rust-lang/rust/raw/30f4486ee425936ac6bd3c5af8ed3c6455a49c94/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fsearch.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fsearch.js?ref=30f4486ee425936ac6bd3c5af8ed3c6455a49c94", "patch": "@@ -994,8 +994,8 @@ window.initSearch = function(rawSearchIndex) {\n                            (\"<span class=\\\"alias\\\"><b>\" + item.alias + \" </b></span><span \" +\n                               \"class=\\\"grey\\\"><i>&nbsp;- see&nbsp;</i></span>\") : \"\") +\n                           item.displayPath + \"<span class=\\\"\" + type + \"\\\">\" +\n-                          name + \"</span></div><div>\" +\n-                          \"<span class=\\\"desc\\\">\" + item.desc +\n+                          name + \"</span></div><div class=\\\"desc\\\">\" +\n+                          \"<span>\" + item.desc +\n                           \"&nbsp;</span></div></div></a>\";\n             });\n             output += \"</div>\";"}, {"sha": "96d15c624f115e771b10dd6cd568b19ca795a1f0", "filename": "src/test/rustdoc-gui/search-result-display.goml", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/30f4486ee425936ac6bd3c5af8ed3c6455a49c94/src%2Ftest%2Frustdoc-gui%2Fsearch-result-display.goml", "raw_url": "https://github.com/rust-lang/rust/raw/30f4486ee425936ac6bd3c5af8ed3c6455a49c94/src%2Ftest%2Frustdoc-gui%2Fsearch-result-display.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsearch-result-display.goml?ref=30f4486ee425936ac6bd3c5af8ed3c6455a49c94", "patch": "@@ -0,0 +1,12 @@\n+goto: file://|DOC_PATH|/test_docs/index.html\n+size: (900, 1000)\n+write: (\".search-input\", \"test\")\n+// Waiting for the search results to appear...\n+wait-for: \"#titles\"\n+// The width is returned by \"getComputedStyle\" which returns the exact number instead of the\n+// CSS rule which is \"50%\"...\n+assert: (\".search-results div.desc\", {\"width\": \"320px\"})\n+size: (600, 100)\n+// As counter-intuitive as it may seem, in this width, the width is \"100%\", which is why\n+// when computed it's larger.\n+assert: (\".search-results div.desc\", {\"width\": \"570px\"})"}]}