{"sha": "f99469d7c446e95da1e41ecb224abf6721e2f599", "node_id": "C_kwDOAAsO6NoAKGY5OTQ2OWQ3YzQ0NmU5NWRhMWU0MWVjYjIyNGFiZjY3MjFlMmY1OTk", "commit": {"author": {"name": "Esteban Kuber", "email": "esteban@kuber.com.ar", "date": "2021-11-24T17:11:15Z"}, "committer": {"name": "Esteban Kuber", "email": "esteban@kuber.com.ar", "date": "2021-11-24T20:02:16Z"}, "message": "Change how the fn params span is calculated\n\nUse the available Generics span field to avoid issues with `T: Fn()` bounds.\n\nThis is necessary to land #85346.", "tree": {"sha": "8af6d63e70d7f7af24b4b5f8dab51c79984c1435", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8af6d63e70d7f7af24b4b5f8dab51c79984c1435"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f99469d7c446e95da1e41ecb224abf6721e2f599", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f99469d7c446e95da1e41ecb224abf6721e2f599", "html_url": "https://github.com/rust-lang/rust/commit/f99469d7c446e95da1e41ecb224abf6721e2f599", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f99469d7c446e95da1e41ecb224abf6721e2f599/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f99e3582bd9838a36883a73380b1d0315cda76e8", "url": "https://api.github.com/repos/rust-lang/rust/commits/f99e3582bd9838a36883a73380b1d0315cda76e8", "html_url": "https://github.com/rust-lang/rust/commit/f99e3582bd9838a36883a73380b1d0315cda76e8"}], "stats": {"total": 12, "additions": 2, "deletions": 10}, "files": [{"sha": "acc91f861e474df3f36879b9e71277246cc04495", "filename": "src/items.rs", "status": "modified", "additions": 2, "deletions": 10, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/f99469d7c446e95da1e41ecb224abf6721e2f599/src%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f99469d7c446e95da1e41ecb224abf6721e2f599/src%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fitems.rs?ref=f99469d7c446e95da1e41ecb224abf6721e2f599", "patch": "@@ -2236,26 +2236,18 @@ fn rewrite_fn_base(\n         result.push_str(&param_indent.to_string_with_newline(context.config));\n     }\n \n-    // Skip `pub(crate)`.\n-    let lo_after_visibility = get_bytepos_after_visibility(fn_sig.visibility, span);\n-    // A conservative estimation, the goal is to be over all parens in generics\n-    let params_start = fn_sig\n-        .generics\n-        .params\n-        .last()\n-        .map_or(lo_after_visibility, |param| param.span().hi());\n     let params_end = if fd.inputs.is_empty() {\n         context\n             .snippet_provider\n-            .span_after(mk_sp(params_start, span.hi()), \")\")\n+            .span_after(mk_sp(fn_sig.generics.span.hi(), span.hi()), \")\")\n     } else {\n         let last_span = mk_sp(fd.inputs[fd.inputs.len() - 1].span().hi(), span.hi());\n         context.snippet_provider.span_after(last_span, \")\")\n     };\n     let params_span = mk_sp(\n         context\n             .snippet_provider\n-            .span_after(mk_sp(params_start, span.hi()), \"(\"),\n+            .span_after(mk_sp(fn_sig.generics.span.hi(), span.hi()), \"(\"),\n         params_end,\n     );\n     let param_str = rewrite_params("}]}