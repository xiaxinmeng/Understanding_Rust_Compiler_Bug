{"sha": "cf7e3969cd816782111d6ec24e50376e6a8ffcd6", "node_id": "C_kwDOAAsO6NoAKGNmN2UzOTY5Y2Q4MTY3ODIxMTFkNmVjMjRlNTAzNzZlNmE4ZmZjZDY", "commit": {"author": {"name": "Dylan DPC", "email": "99973273+Dylan-DPC@users.noreply.github.com", "date": "2022-05-23T13:11:05Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-05-23T13:11:05Z"}, "message": "Rollup merge of #97309 - JohnTitor:issue-90400, r=compiler-errors\n\nAdd some regression tests for #90400\n\nThis adds two regression tests taken from https://github.com/rust-lang/rust/issues/90400#issuecomment-954927836.\nNote that we cannot close the issue right now as the [original code](https://github.com/rust-lang/rust/issues/90400#issue-1039577786) still triggers an ICE.\n\nr? `@compiler-errors`", "tree": {"sha": "5ec45afb66a60a896fa8d89a5672f2b78643ef32", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5ec45afb66a60a896fa8d89a5672f2b78643ef32"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cf7e3969cd816782111d6ec24e50376e6a8ffcd6", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJii4fpCRBK7hj4Ov3rIwAAVQMIAGplHXxh3GBcCNQbHODbDFYZ\n0vDACQOnr6+z+YMR7hOVX+Y5auYX2jwfpZIAGbtpdvv1zfDTERNIlUjfg9DsmH/K\npkAoL6FZlYqf+g9Vxw5A/bGQS+BVeKt2SFEVeJrQXvSyV7ZEruXG2m7dc3GP50wt\nPrHo5A3SVtoah1dnJQ0fL973Ono5z724VBIe9kp7RfDTNMzrJIWqYNuAVKoHQsZz\nBDgoggLWXPCGF3Z0axW6fg/m7ya8QGkuP4OmuAmY6RCG+9hMxAFAIPqNbMbc/oB+\nkwtiyivsnOd8/QLRinXRHrYF3NMw5kzEXByndTHccl9ki1kQb/a600SkMYZjek4=\n=mhJ0\n-----END PGP SIGNATURE-----\n", "payload": "tree 5ec45afb66a60a896fa8d89a5672f2b78643ef32\nparent f4bf64c3f0c82cbae2844ffc6f1a01b5e18ffe73\nparent 622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c\nauthor Dylan DPC <99973273+Dylan-DPC@users.noreply.github.com> 1653311465 +0200\ncommitter GitHub <noreply@github.com> 1653311465 +0200\n\nRollup merge of #97309 - JohnTitor:issue-90400, r=compiler-errors\n\nAdd some regression tests for #90400\n\nThis adds two regression tests taken from https://github.com/rust-lang/rust/issues/90400#issuecomment-954927836.\nNote that we cannot close the issue right now as the [original code](https://github.com/rust-lang/rust/issues/90400#issue-1039577786) still triggers an ICE.\n\nr? `@compiler-errors`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cf7e3969cd816782111d6ec24e50376e6a8ffcd6", "html_url": "https://github.com/rust-lang/rust/commit/cf7e3969cd816782111d6ec24e50376e6a8ffcd6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cf7e3969cd816782111d6ec24e50376e6a8ffcd6/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f4bf64c3f0c82cbae2844ffc6f1a01b5e18ffe73", "url": "https://api.github.com/repos/rust-lang/rust/commits/f4bf64c3f0c82cbae2844ffc6f1a01b5e18ffe73", "html_url": "https://github.com/rust-lang/rust/commit/f4bf64c3f0c82cbae2844ffc6f1a01b5e18ffe73"}, {"sha": "622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c", "url": "https://api.github.com/repos/rust-lang/rust/commits/622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c", "html_url": "https://github.com/rust-lang/rust/commit/622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c"}], "stats": {"total": 106, "additions": 106, "deletions": 0}, "files": [{"sha": "8550a3e86379e8ea1d08f02bae56b4706f6cfd3b", "filename": "src/test/ui/type-alias-impl-trait/issue-90400-1.rs", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/cf7e3969cd816782111d6ec24e50376e6a8ffcd6/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf7e3969cd816782111d6ec24e50376e6a8ffcd6/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-1.rs?ref=cf7e3969cd816782111d6ec24e50376e6a8ffcd6", "patch": "@@ -0,0 +1,30 @@\n+// Regression test for #90400,\n+// taken from https://github.com/rust-lang/rust/issues/90400#issuecomment-954927836\n+\n+#![feature(generic_associated_types)]\n+#![feature(type_alias_impl_trait)]\n+\n+trait Bar {\n+    fn bar(&self);\n+}\n+\n+trait Foo {\n+    type FooFn<B>: FnOnce();\n+\n+    fn foo<B: Bar>(&self, bar: B) -> Self::FooFn<B>;\n+}\n+\n+struct MyFoo;\n+\n+impl Foo for MyFoo {\n+    type FooFn<B> = impl FnOnce();\n+\n+    fn foo<B: Bar>(&self, bar: B) -> Self::FooFn<B> {\n+        move || bar.bar() //~ ERROR: the trait bound `B: Bar` is not satisfied\n+    }\n+}\n+\n+fn main() {\n+    let boom: <MyFoo as Foo>::FooFn<u32> = unsafe { core::mem::zeroed() };\n+    boom();\n+}"}, {"sha": "428a1074031ee5ebc96403d334d701172eac3097", "filename": "src/test/ui/type-alias-impl-trait/issue-90400-1.stderr", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/cf7e3969cd816782111d6ec24e50376e6a8ffcd6/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cf7e3969cd816782111d6ec24e50376e6a8ffcd6/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-1.stderr?ref=cf7e3969cd816782111d6ec24e50376e6a8ffcd6", "patch": "@@ -0,0 +1,19 @@\n+error[E0277]: the trait bound `B: Bar` is not satisfied\n+  --> $DIR/issue-90400-1.rs:23:9\n+   |\n+LL |         move || bar.bar()\n+   |         ^^^^^^^^^^^^^^^^^ the trait `Bar` is not implemented for `B`\n+   |\n+note: required by a bound in `<MyFoo as Foo>::foo`\n+  --> $DIR/issue-90400-1.rs:22:15\n+   |\n+LL |     fn foo<B: Bar>(&self, bar: B) -> Self::FooFn<B> {\n+   |               ^^^ required by this bound in `<MyFoo as Foo>::foo`\n+help: consider restricting type parameter `B`\n+   |\n+LL |     type FooFn<B: Bar> = impl FnOnce();\n+   |                 +++++\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0277`."}, {"sha": "2b369bb8a2b92efd56e599cd02ee4852e5afab14", "filename": "src/test/ui/type-alias-impl-trait/issue-90400-2.rs", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/cf7e3969cd816782111d6ec24e50376e6a8ffcd6/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf7e3969cd816782111d6ec24e50376e6a8ffcd6/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-2.rs?ref=cf7e3969cd816782111d6ec24e50376e6a8ffcd6", "patch": "@@ -0,0 +1,38 @@\n+// Regression test for #90400,\n+// taken from https://github.com/rust-lang/rust/issues/90400#issuecomment-954927836\n+\n+#![feature(generic_associated_types)]\n+#![feature(type_alias_impl_trait)]\n+\n+trait Bar {\n+    fn bar(&self);\n+}\n+\n+trait Baz {\n+    fn baz(&self);\n+}\n+\n+trait Foo {\n+    type FooFn<B>: Baz;\n+\n+    fn foo<B: Bar>(&self, bar: B) -> Self::FooFn<B>;\n+}\n+\n+struct MyFoo;\n+impl Foo for MyFoo {\n+    type FooFn<B> = impl Baz;\n+\n+    fn foo<B: Bar>(&self, bar: B) -> Self::FooFn<B> {\n+        MyBaz(bar) //~ ERROR: the trait bound `B: Bar` is not satisfied\n+    }\n+}\n+\n+struct MyBaz<B: Bar>(B);\n+impl<B: Bar> Baz for MyBaz<B> {\n+    fn baz(&self) {}\n+}\n+\n+fn main() {\n+    let boom: <MyFoo as Foo>::FooFn<u32> = unsafe { core::mem::zeroed() };\n+    boom.baz();\n+}"}, {"sha": "5da05a4390f7b98a2cf39a8724bf2f9376ef0a31", "filename": "src/test/ui/type-alias-impl-trait/issue-90400-2.stderr", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/cf7e3969cd816782111d6ec24e50376e6a8ffcd6/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cf7e3969cd816782111d6ec24e50376e6a8ffcd6/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-2.stderr?ref=cf7e3969cd816782111d6ec24e50376e6a8ffcd6", "patch": "@@ -0,0 +1,19 @@\n+error[E0277]: the trait bound `B: Bar` is not satisfied\n+  --> $DIR/issue-90400-2.rs:26:9\n+   |\n+LL |         MyBaz(bar)\n+   |         ^^^^^^^^^^ the trait `Bar` is not implemented for `B`\n+   |\n+note: required because of the requirements on the impl of `Baz` for `MyBaz<B>`\n+  --> $DIR/issue-90400-2.rs:31:14\n+   |\n+LL | impl<B: Bar> Baz for MyBaz<B> {\n+   |              ^^^     ^^^^^^^^\n+help: consider restricting type parameter `B`\n+   |\n+LL |     type FooFn<B: Bar> = impl Baz;\n+   |                 +++++\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0277`."}]}