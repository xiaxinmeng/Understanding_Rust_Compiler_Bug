{"sha": "48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "node_id": "C_kwDOAAsO6NoAKDQ4MTcwZDVhMWNjYzRmZjFlOGEzNzBmYjYzYmQ4ZWIyOWRlOTJhMjU", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-06-29T22:23:50Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-06-29T22:23:50Z"}, "message": "Rollup merge of #96727 - oli-obk:no_expect, r=lcnr\n\nMake TAIT behave exactly like RPIT\n\nfixes https://github.com/rust-lang/rust/issues/96552\n\nThis makes type-alias-impl-trait behave like return-position-impl-trait. Unfortunately it also causes some cases to stop compiling due to \"needing type annotations\" and makes panicking cause fallback for the hidden type to `()`.\n\nAll of these are addressable, but we should probably address them for RPIT and TAIT together\n\nr? ``@lcnr``", "tree": {"sha": "fc60699e66d0ddc009a31c7eca445b3c41aae62a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fc60699e66d0ddc009a31c7eca445b3c41aae62a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJivND2CRBK7hj4Ov3rIwAA7nEIAHXw9ip7eIxGHiHMgLKqK3by\nEtm0m/u4kFUP3cHCGsCkEt45zYFrsEFBhbSU8EOJt5CO9AmfzrJHP3rZIhFPfPs/\nQG+J02d0QPgC4z6jVUkqW2Sj9/NGpZT/hMPBO/d1OKvANN/+L4o/L3WaKmLFblKM\nf321f1SRDtx5M8Hr7N8U7LOSEnz4UFh/Lzs956dmBisGVMJoaXwQZdhg4PDFXE0a\nvKwa/N3h5sUERdYbg70g7lm9r9S1Eq1rLh/iivZdRfYGPMczkWReV2eA6i63Ihjd\nxXu8pdOl5l0xY6dwIr51O6hfa2hOHhAphU+Gdeh8/pcj0V7EHPtc+Cx3dQK+wWM=\n=nUSe\n-----END PGP SIGNATURE-----\n", "payload": "tree fc60699e66d0ddc009a31c7eca445b3c41aae62a\nparent ddcbba036aee08f0709f98a92a342a278eae5c05\nparent c33b127d7c25977817faaae5eee84d57cde37c68\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1656541430 +0200\ncommitter GitHub <noreply@github.com> 1656541430 +0200\n\nRollup merge of #96727 - oli-obk:no_expect, r=lcnr\n\nMake TAIT behave exactly like RPIT\n\nfixes https://github.com/rust-lang/rust/issues/96552\n\nThis makes type-alias-impl-trait behave like return-position-impl-trait. Unfortunately it also causes some cases to stop compiling due to \"needing type annotations\" and makes panicking cause fallback for the hidden type to `()`.\n\nAll of these are addressable, but we should probably address them for RPIT and TAIT together\n\nr? ``@lcnr``\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "html_url": "https://github.com/rust-lang/rust/commit/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ddcbba036aee08f0709f98a92a342a278eae5c05", "url": "https://api.github.com/repos/rust-lang/rust/commits/ddcbba036aee08f0709f98a92a342a278eae5c05", "html_url": "https://github.com/rust-lang/rust/commit/ddcbba036aee08f0709f98a92a342a278eae5c05"}, {"sha": "c33b127d7c25977817faaae5eee84d57cde37c68", "url": "https://api.github.com/repos/rust-lang/rust/commits/c33b127d7c25977817faaae5eee84d57cde37c68", "html_url": "https://github.com/rust-lang/rust/commit/c33b127d7c25977817faaae5eee84d57cde37c68"}], "stats": {"total": 624, "additions": 378, "deletions": 246}, "files": [{"sha": "cc36d6a0a4fbef9ca772ad793972f5691332b60f", "filename": "compiler/rustc_infer/src/infer/opaque_types.rs", "status": "modified", "additions": 7, "deletions": 14, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/compiler%2Frustc_infer%2Fsrc%2Finfer%2Fopaque_types.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/compiler%2Frustc_infer%2Fsrc%2Finfer%2Fopaque_types.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_infer%2Fsrc%2Finfer%2Fopaque_types.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -5,7 +5,7 @@ use hir::{HirId, OpaqueTyOrigin};\n use rustc_data_structures::sync::Lrc;\n use rustc_data_structures::vec_map::VecMap;\n use rustc_hir as hir;\n-use rustc_middle::traits::{ObligationCause, ObligationCauseCode};\n+use rustc_middle::traits::ObligationCause;\n use rustc_middle::ty::fold::BottomUpFolder;\n use rustc_middle::ty::subst::{GenericArgKind, Subst};\n use rustc_middle::ty::{\n@@ -44,30 +44,23 @@ impl<'a, 'tcx> InferCtxt<'a, 'tcx> {\n         ty: Ty<'tcx>,\n         body_id: HirId,\n         span: Span,\n-        code: ObligationCauseCode<'tcx>,\n         param_env: ty::ParamEnv<'tcx>,\n     ) -> InferOk<'tcx, Ty<'tcx>> {\n         if !ty.has_opaque_types() {\n             return InferOk { value: ty, obligations: vec![] };\n         }\n         let mut obligations = vec![];\n+        let replace_opaque_type = |def_id| self.opaque_type_origin(def_id, span).is_some();\n         let value = ty.fold_with(&mut ty::fold::BottomUpFolder {\n             tcx: self.tcx,\n             lt_op: |lt| lt,\n             ct_op: |ct| ct,\n             ty_op: |ty| match *ty.kind() {\n-                // Closures can't create hidden types for opaque types of their parent, as they\n-                // do not have all the outlives information available. Also `type_of` looks for\n-                // hidden types in the owner (so the closure's parent), so it would not find these\n-                // definitions.\n-                ty::Opaque(def_id, _substs)\n-                    if matches!(\n-                        self.opaque_type_origin(def_id, span),\n-                        Some(OpaqueTyOrigin::FnReturn(..))\n-                    ) =>\n-                {\n-                    let span = if span.is_dummy() { self.tcx.def_span(def_id) } else { span };\n-                    let cause = ObligationCause::new(span, body_id, code.clone());\n+                ty::Opaque(def_id, _substs) if replace_opaque_type(def_id) => {\n+                    let def_span = self.tcx.def_span(def_id);\n+                    let span = if span.contains(def_span) { def_span } else { span };\n+                    let code = traits::ObligationCauseCode::OpaqueReturnType(None);\n+                    let cause = ObligationCause::new(span, body_id, code);\n                     // FIXME(compiler-errors): We probably should add a new TypeVariableOriginKind\n                     // for opaque types, and then use that kind to fix the spans for type errors\n                     // that we see later on."}, {"sha": "6222dbb40741c1d060cb98b88b673b68c18a4d16", "filename": "compiler/rustc_typeck/src/check/check.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fcheck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fcheck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fcheck.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -95,8 +95,7 @@ pub(super) fn check_fn<'a, 'tcx>(\n         fcx.register_infer_ok_obligations(fcx.infcx.replace_opaque_types_with_inference_vars(\n             declared_ret_ty,\n             body.value.hir_id,\n-            DUMMY_SP,\n-            traits::ObligationCauseCode::OpaqueReturnType(None),\n+            decl.output.span(),\n             param_env,\n         ));\n     // If we replaced declared_ret_ty with infer vars, then we must be infering"}, {"sha": "131e594ed94f7dcc4ae4cb099a8185bde18c34b0", "filename": "compiler/rustc_typeck/src/check/closure.rs", "status": "modified", "additions": 59, "deletions": 59, "changes": 118, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fclosure.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fclosure.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fclosure.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -10,12 +10,10 @@ use rustc_hir::lang_items::LangItem;\n use rustc_infer::infer::type_variable::{TypeVariableOrigin, TypeVariableOriginKind};\n use rustc_infer::infer::LateBoundRegionConversionTime;\n use rustc_infer::infer::{InferOk, InferResult};\n-use rustc_infer::traits::ObligationCauseCode;\n use rustc_middle::ty::fold::TypeFoldable;\n use rustc_middle::ty::subst::InternalSubsts;\n use rustc_middle::ty::{self, Ty};\n use rustc_span::source_map::Span;\n-use rustc_span::DUMMY_SP;\n use rustc_target::spec::abi::Abi;\n use rustc_trait_selection::traits::error_reporting::ArgKind;\n use rustc_trait_selection::traits::error_reporting::InferCtxtExt as _;\n@@ -429,14 +427,9 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         // in this binder we are creating.\n         assert!(!expected_sig.sig.skip_binder().has_vars_bound_above(ty::INNERMOST));\n         let bound_sig = expected_sig.sig.map_bound(|sig| {\n-            let output = self.hide_parent_opaque_types(\n-                sig.output(),\n-                expected_sig.cause_span.unwrap_or(DUMMY_SP),\n-                body.id().hir_id,\n-            );\n             self.tcx.mk_fn_sig(\n                 sig.inputs().iter().cloned(),\n-                output,\n+                sig.output(),\n                 sig.c_variadic,\n                 hir::Unsafety::Normal,\n                 Abi::RustCall,\n@@ -608,23 +601,22 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                 // function.\n                 Some(hir::GeneratorKind::Async(hir::AsyncGeneratorKind::Fn)) => {\n                     debug!(\"closure is async fn body\");\n-                    self.deduce_future_output_from_obligations(expr_def_id).unwrap_or_else(|| {\n-                        // AFAIK, deducing the future output\n-                        // always succeeds *except* in error cases\n-                        // like #65159. I'd like to return Error\n-                        // here, but I can't because I can't\n-                        // easily (and locally) prove that we\n-                        // *have* reported an\n-                        // error. --nikomatsakis\n-                        astconv.ty_infer(None, decl.output.span())\n-                    })\n+                    self.deduce_future_output_from_obligations(expr_def_id, body.id().hir_id)\n+                        .unwrap_or_else(|| {\n+                            // AFAIK, deducing the future output\n+                            // always succeeds *except* in error cases\n+                            // like #65159. I'd like to return Error\n+                            // here, but I can't because I can't\n+                            // easily (and locally) prove that we\n+                            // *have* reported an\n+                            // error. --nikomatsakis\n+                            astconv.ty_infer(None, decl.output.span())\n+                        })\n                 }\n \n                 _ => astconv.ty_infer(None, decl.output.span()),\n             },\n         };\n-        let supplied_return =\n-            self.hide_parent_opaque_types(supplied_return, decl.output.span(), body.id().hir_id);\n \n         let result = ty::Binder::bind_with_vars(\n             self.tcx.mk_fn_sig(\n@@ -645,67 +637,75 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         result\n     }\n \n-    fn hide_parent_opaque_types(&self, ty: Ty<'tcx>, span: Span, body_id: hir::HirId) -> Ty<'tcx> {\n-        let InferOk { value, obligations } = self.replace_opaque_types_with_inference_vars(\n-            ty,\n-            body_id,\n-            span,\n-            ObligationCauseCode::MiscObligation,\n-            self.param_env,\n-        );\n-        self.register_predicates(obligations);\n-        value\n-    }\n-\n     /// Invoked when we are translating the generator that results\n     /// from desugaring an `async fn`. Returns the \"sugared\" return\n     /// type of the `async fn` -- that is, the return type that the\n     /// user specified. The \"desugared\" return type is an `impl\n     /// Future<Output = T>`, so we do this by searching through the\n     /// obligations to extract the `T`.\n     #[instrument(skip(self), level = \"debug\")]\n-    fn deduce_future_output_from_obligations(&self, expr_def_id: DefId) -> Option<Ty<'tcx>> {\n+    fn deduce_future_output_from_obligations(\n+        &self,\n+        expr_def_id: DefId,\n+        body_id: hir::HirId,\n+    ) -> Option<Ty<'tcx>> {\n         let ret_coercion = self.ret_coercion.as_ref().unwrap_or_else(|| {\n             span_bug!(self.tcx.def_span(expr_def_id), \"async fn generator outside of a fn\")\n         });\n \n         let ret_ty = ret_coercion.borrow().expected_ty();\n         let ret_ty = self.inh.infcx.shallow_resolve(ret_ty);\n-        let (def_id, substs) = match *ret_ty.kind() {\n-            ty::Opaque(def_id, substs) => (def_id, substs),\n+\n+        let get_future_output = |predicate: ty::Predicate<'tcx>, span| {\n+            // Search for a pending obligation like\n+            //\n+            // `<R as Future>::Output = T`\n+            //\n+            // where R is the return type we are expecting. This type `T`\n+            // will be our output.\n+            let bound_predicate = predicate.kind();\n+            if let ty::PredicateKind::Projection(proj_predicate) = bound_predicate.skip_binder() {\n+                self.deduce_future_output_from_projection(\n+                    span,\n+                    bound_predicate.rebind(proj_predicate),\n+                )\n+            } else {\n+                None\n+            }\n+        };\n+\n+        let output_ty = match *ret_ty.kind() {\n+            ty::Infer(ty::TyVar(ret_vid)) => {\n+                self.obligations_for_self_ty(ret_vid).find_map(|(_, obligation)| {\n+                    get_future_output(obligation.predicate, obligation.cause.span)\n+                })?\n+            }\n+            ty::Opaque(def_id, substs) => self\n+                .tcx\n+                .bound_explicit_item_bounds(def_id)\n+                .transpose_iter()\n+                .map(|e| e.map_bound(|e| *e).transpose_tuple2())\n+                .find_map(|(p, s)| get_future_output(p.subst(self.tcx, substs), s.0))?,\n             ty::Error(_) => return None,\n             _ => span_bug!(\n                 self.tcx.def_span(expr_def_id),\n                 \"async fn generator return type not an inference variable\"\n             ),\n         };\n \n-        let item_bounds = self.tcx.bound_explicit_item_bounds(def_id);\n-\n-        // Search for a pending obligation like\n-        //\n-        // `<R as Future>::Output = T`\n-        //\n-        // where R is the return type we are expecting. This type `T`\n-        // will be our output.\n-        let output_ty = item_bounds\n-            .transpose_iter()\n-            .map(|e| e.map_bound(|e| *e).transpose_tuple2())\n-            .find_map(|(predicate, span)| {\n-                let bound_predicate = predicate.subst(self.tcx, substs).kind();\n-                if let ty::PredicateKind::Projection(proj_predicate) = bound_predicate.skip_binder()\n-                {\n-                    self.deduce_future_output_from_projection(\n-                        span.0,\n-                        bound_predicate.rebind(proj_predicate),\n-                    )\n-                } else {\n-                    None\n-                }\n-            });\n+        // async fn that have opaque types in their return type need to redo the conversion to inference variables\n+        // as they fetch the still opaque version from the signature.\n+        let InferOk { value: output_ty, obligations } = self\n+            .replace_opaque_types_with_inference_vars(\n+                output_ty,\n+                body_id,\n+                self.tcx.def_span(expr_def_id),\n+                self.param_env,\n+            );\n+        self.register_predicates(obligations);\n \n         debug!(\"deduce_future_output_from_obligations: output_ty={:?}\", output_ty);\n-        output_ty\n+        Some(output_ty)\n     }\n \n     /// Given a projection like"}, {"sha": "4c36289f47b857ac0e5c50ae4fa9df26d9dc7863", "filename": "src/test/ui/associated-type-bounds/assoc-type-eq-with-dyn-atb-fail.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fassociated-type-bounds%2Fassoc-type-eq-with-dyn-atb-fail.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fassociated-type-bounds%2Fassoc-type-eq-with-dyn-atb-fail.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fassociated-type-bounds%2Fassoc-type-eq-with-dyn-atb-fail.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -30,7 +30,7 @@ impl Thing for AssocNoCopy {\n     type Out = Box<dyn Bar<Assoc: Copy>>;\n \n     fn func() -> Self::Out {\n-        Box::new(AssocNoCopy)\n         //~^ ERROR the trait bound `String: Copy` is not satisfied\n+        Box::new(AssocNoCopy)\n     }\n }"}, {"sha": "a32ab453152a0b4663c06788b189aaba8cd23431", "filename": "src/test/ui/associated-type-bounds/assoc-type-eq-with-dyn-atb-fail.stderr", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fassociated-type-bounds%2Fassoc-type-eq-with-dyn-atb-fail.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fassociated-type-bounds%2Fassoc-type-eq-with-dyn-atb-fail.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fassociated-type-bounds%2Fassoc-type-eq-with-dyn-atb-fail.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,10 +1,8 @@\n error[E0277]: the trait bound `String: Copy` is not satisfied\n-  --> $DIR/assoc-type-eq-with-dyn-atb-fail.rs:33:9\n+  --> $DIR/assoc-type-eq-with-dyn-atb-fail.rs:32:18\n    |\n-LL |         Box::new(AssocNoCopy)\n-   |         ^^^^^^^^^^^^^^^^^^^^^ the trait `Copy` is not implemented for `String`\n-   |\n-   = note: required for the cast from `AssocNoCopy` to the object type `dyn Bar<Assoc = <AssocNoCopy as Thing>::Out::{opaque#0}>`\n+LL |     fn func() -> Self::Out {\n+   |                  ^^^^^^^^^ the trait `Copy` is not implemented for `String`\n \n error: aborting due to previous error\n "}, {"sha": "1dbf5db6c32ed9bdae77c7c18787f270c9d003db", "filename": "src/test/ui/async-await/issues/issue-65159.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fasync-await%2Fissues%2Fissue-65159.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fasync-await%2Fissues%2Fissue-65159.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fasync-await%2Fissues%2Fissue-65159.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -6,6 +6,7 @@ async fn copy() -> Result<()>\n //~^ ERROR this enum takes 2 generic arguments\n {\n     Ok(())\n+    //~^ ERROR type annotations needed\n }\n \n fn main() { }"}, {"sha": "9918f569cbc893528d5cbc7f4f0b69bd2753d43e", "filename": "src/test/ui/async-await/issues/issue-65159.stderr", "status": "modified", "additions": 14, "deletions": 2, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fasync-await%2Fissues%2Fissue-65159.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fasync-await%2Fissues%2Fissue-65159.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fasync-await%2Fissues%2Fissue-65159.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -16,6 +16,18 @@ help: add missing generic argument\n LL | async fn copy() -> Result<(), E>\n    |                             +++\n \n-error: aborting due to previous error\n+error[E0282]: type annotations needed\n+  --> $DIR/issue-65159.rs:8:5\n+   |\n+LL |     Ok(())\n+   |     ^^ cannot infer type of the type parameter `E` declared on the enum `Result`\n+   |\n+help: consider specifying the generic arguments\n+   |\n+LL |     Ok::<(), E>(())\n+   |       +++++++++\n+\n+error: aborting due to 2 previous errors\n \n-For more information about this error, try `rustc --explain E0107`.\n+Some errors have detailed explanations: E0107, E0282.\n+For more information about an error, try `rustc --explain E0107`."}, {"sha": "2c8a700bc2ea37cc53343d5edc97d9d7eaa116df", "filename": "src/test/ui/borrowck/issue-82126-mismatched-subst-and-hir.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fborrowck%2Fissue-82126-mismatched-subst-and-hir.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fborrowck%2Fissue-82126-mismatched-subst-and-hir.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fissue-82126-mismatched-subst-and-hir.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -17,6 +17,7 @@ async fn buy_lock(generator: &Mutex<MarketMultiplier>) -> LockedMarket<'_> {\n     //~^ ERROR this struct takes 0 lifetime arguments but 1 lifetime argument was supplied\n     //~^^ ERROR this struct takes 1 generic argument but 0 generic arguments were supplied\n     LockedMarket(generator.lock().unwrap().buy())\n+    //~^ ERROR cannot return value referencing temporary\n }\n \n struct LockedMarket<T>(T);"}, {"sha": "4bd0667304397e0a7b8eb91280cc183c52bcf03b", "filename": "src/test/ui/borrowck/issue-82126-mismatched-subst-and-hir.stderr", "status": "modified", "additions": 14, "deletions": 4, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fborrowck%2Fissue-82126-mismatched-subst-and-hir.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fborrowck%2Fissue-82126-mismatched-subst-and-hir.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fissue-82126-mismatched-subst-and-hir.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -7,7 +7,7 @@ LL | async fn buy_lock(generator: &Mutex<MarketMultiplier>) -> LockedMarket<'_>\n    |                                                           expected 0 lifetime arguments\n    |\n note: struct defined here, with 0 lifetime parameters\n-  --> $DIR/issue-82126-mismatched-subst-and-hir.rs:22:8\n+  --> $DIR/issue-82126-mismatched-subst-and-hir.rs:23:8\n    |\n LL | struct LockedMarket<T>(T);\n    |        ^^^^^^^^^^^^\n@@ -19,7 +19,7 @@ LL | async fn buy_lock(generator: &Mutex<MarketMultiplier>) -> LockedMarket<'_>\n    |                                                           ^^^^^^^^^^^^ expected 1 generic argument\n    |\n note: struct defined here, with 1 generic parameter: `T`\n-  --> $DIR/issue-82126-mismatched-subst-and-hir.rs:22:8\n+  --> $DIR/issue-82126-mismatched-subst-and-hir.rs:23:8\n    |\n LL | struct LockedMarket<T>(T);\n    |        ^^^^^^^^^^^^ -\n@@ -28,6 +28,16 @@ help: add missing generic argument\n LL | async fn buy_lock(generator: &Mutex<MarketMultiplier>) -> LockedMarket<'_, T> {\n    |                                                                          +++\n \n-error: aborting due to 2 previous errors\n+error[E0515]: cannot return value referencing temporary value\n+  --> $DIR/issue-82126-mismatched-subst-and-hir.rs:19:5\n+   |\n+LL |     LockedMarket(generator.lock().unwrap().buy())\n+   |     ^^^^^^^^^^^^^-------------------------^^^^^^^\n+   |     |            |\n+   |     |            temporary value created here\n+   |     returns a value referencing data owned by the current function\n+\n+error: aborting due to 3 previous errors\n \n-For more information about this error, try `rustc --explain E0107`.\n+Some errors have detailed explanations: E0107, E0515.\n+For more information about an error, try `rustc --explain E0107`."}, {"sha": "f53ed53f73c4987aac37a999e5b61a39aef5ece5", "filename": "src/test/ui/chalkify/bugs/async.stderr", "status": "modified", "additions": 3, "deletions": 6, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fchalkify%2Fbugs%2Fasync.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fchalkify%2Fbugs%2Fasync.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fchalkify%2Fbugs%2Fasync.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -29,13 +29,10 @@ LL |     T: Generator<ResumeTy, Yield = ()>,\n    |                            ^^^^^^^^^^ required by this bound in `std::future::from_generator`\n \n error[E0280]: the requirement `<impl Future<Output = u32> as Future>::Output == u32` is not satisfied\n-  --> $DIR/async.rs:7:29\n+  --> $DIR/async.rs:7:25\n    |\n-LL |   async fn foo(x: u32) -> u32 {\n-   |  _____________________________^\n-LL | |     x\n-LL | | }\n-   | |_^\n+LL | async fn foo(x: u32) -> u32 {\n+   |                         ^^^\n \n error: aborting due to 3 previous errors\n "}, {"sha": "50844fdc14d942785d7b567a0895c8ca84c6de39", "filename": "src/test/ui/generic-associated-types/bugs/issue-89008.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fgeneric-associated-types%2Fbugs%2Fissue-89008.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fgeneric-associated-types%2Fbugs%2Fissue-89008.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fgeneric-associated-types%2Fbugs%2Fissue-89008.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,10 +1,10 @@\n error[E0271]: type mismatch resolving `<Empty<_> as Stream>::Item == Repr`\n-  --> $DIR/issue-89008.rs:40:9\n+  --> $DIR/issue-89008.rs:39:43\n    |\n LL |     fn line_stream<'a, Repr>(&'a self) -> Self::LineStreamFut<'a, Repr> {\n-   |                        ---- this type parameter\n-LL |         async {empty()}\n-   |         ^^^^^^^^^^^^^^^ type mismatch resolving `<Empty<_> as Stream>::Item == Repr`\n+   |                        ----               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ type mismatch resolving `<Empty<_> as Stream>::Item == Repr`\n+   |                        |\n+   |                        this type parameter\n    |\n note: expected this to be `()`\n   --> $DIR/issue-89008.rs:18:17"}, {"sha": "22ff7ffa23cb3f9f1dea8d135b84457c27850057", "filename": "src/test/ui/impl-trait/issue-55872-1.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-55872-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-55872-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-55872-1.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -11,9 +11,9 @@ impl<S: Default> Bar for S {\n \n     fn foo<T: Default>() -> Self::E {\n         //~^ ERROR impl has stricter requirements than trait\n-        (S::default(), T::default())\n-        //~^ ERROR the trait bound `S: Copy` is not satisfied in `(S, T)` [E0277]\n+        //~| ERROR the trait bound `S: Copy` is not satisfied in `(S, T)` [E0277]\n         //~| ERROR the trait bound `T: Copy` is not satisfied in `(S, T)` [E0277]\n+        (S::default(), T::default())\n     }\n }\n "}, {"sha": "8912cce1b4b5ba068616f626381b6dec83655107", "filename": "src/test/ui/impl-trait/issue-55872-1.stderr", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-55872-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-55872-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-55872-1.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -8,10 +8,10 @@ LL |     fn foo<T: Default>() -> Self::E {\n    |               ^^^^^^^ impl has extra requirement `T: Default`\n \n error[E0277]: the trait bound `S: Copy` is not satisfied in `(S, T)`\n-  --> $DIR/issue-55872-1.rs:14:9\n+  --> $DIR/issue-55872-1.rs:12:29\n    |\n-LL |         (S::default(), T::default())\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ within `(S, T)`, the trait `Copy` is not implemented for `S`\n+LL |     fn foo<T: Default>() -> Self::E {\n+   |                             ^^^^^^^ within `(S, T)`, the trait `Copy` is not implemented for `S`\n    |\n    = note: required because it appears within the type `(S, T)`\n help: consider further restricting this bound\n@@ -20,10 +20,10 @@ LL | impl<S: Default + std::marker::Copy> Bar for S {\n    |                 +++++++++++++++++++\n \n error[E0277]: the trait bound `T: Copy` is not satisfied in `(S, T)`\n-  --> $DIR/issue-55872-1.rs:14:9\n+  --> $DIR/issue-55872-1.rs:12:29\n    |\n-LL |         (S::default(), T::default())\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ within `(S, T)`, the trait `Copy` is not implemented for `T`\n+LL |     fn foo<T: Default>() -> Self::E {\n+   |                             ^^^^^^^ within `(S, T)`, the trait `Copy` is not implemented for `T`\n    |\n    = note: required because it appears within the type `(S, T)`\n help: consider further restricting this bound"}, {"sha": "3ffce85e61ba4fd079c86c35a587f189f3dbd781", "filename": "src/test/ui/impl-trait/issue-55872-3.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-55872-3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-55872-3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-55872-3.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -12,8 +12,8 @@ pub trait Bar {\n impl<S> Bar for S {\n     type E = impl std::marker::Copy;\n     fn foo<T>() -> Self::E {\n+    //~^ ERROR the trait bound `impl Future<Output = ()>: Copy` is not satisfied [E0277]\n         async {}\n-        //~^ ERROR the trait bound `impl Future<Output = ()>: Copy` is not satisfied [E0277]\n     }\n }\n "}, {"sha": "6ab540e87516298b7f8bbfabf4facb9cb0e0eacc", "filename": "src/test/ui/impl-trait/issue-55872-3.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-55872-3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-55872-3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-55872-3.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,8 +1,8 @@\n error[E0277]: the trait bound `impl Future<Output = ()>: Copy` is not satisfied\n-  --> $DIR/issue-55872-3.rs:15:9\n+  --> $DIR/issue-55872-3.rs:14:20\n    |\n-LL |         async {}\n-   |         ^^^^^^^^ the trait `Copy` is not implemented for `impl Future<Output = ()>`\n+LL |     fn foo<T>() -> Self::E {\n+   |                    ^^^^^^^ the trait `Copy` is not implemented for `impl Future<Output = ()>`\n \n error: aborting due to previous error\n "}, {"sha": "8169cfafac71127665f97b6138b61fea1188f89b", "filename": "src/test/ui/impl-trait/issues/issue-70877.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-70877.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-70877.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-70877.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -13,7 +13,7 @@ impl Iterator for Bar {\n     type Item = FooItem;\n \n     fn next(&mut self) -> Option<Self::Item> {\n-        Some(Box::new(quux)) //~ ERROR mismatched types\n+        Some(Box::new(quux))\n     }\n }\n "}, {"sha": "8813bff3c353e3c656efc75d246b37af50949431", "filename": "src/test/ui/impl-trait/issues/issue-70877.stderr", "status": "modified", "additions": 1, "deletions": 16, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-70877.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-70877.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-70877.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,17 +1,3 @@\n-error[E0308]: mismatched types\n-  --> $DIR/issue-70877.rs:16:9\n-   |\n-LL | type FooRet = impl std::fmt::Debug;\n-   |               -------------------- the expected opaque type\n-...\n-LL |     fn next(&mut self) -> Option<Self::Item> {\n-   |                           ------------------ expected `Option<Box<(dyn for<'r> Fn(&'r (dyn ToString + 'r)) -> FooRet + 'static)>>` because of return type\n-LL |         Some(Box::new(quux))\n-   |         ^^^^^^^^^^^^^^^^^^^^ expected trait object `dyn Fn`, found fn item\n-   |\n-   = note: expected enum `Option<Box<(dyn for<'r> Fn(&'r (dyn ToString + 'r)) -> FooRet + 'static)>>`\n-              found enum `Option<Box<for<'r> fn(&'r (dyn ToString + 'r)) -> FooRet {quux}>>`\n-\n error: opaque type's hidden type cannot be another opaque type from the same scope\n   --> $DIR/issue-70877.rs:31:12\n    |\n@@ -29,6 +15,5 @@ note: opaque type being used as hidden type\n LL | type FooRet = impl std::fmt::Debug;\n    |               ^^^^^^^^^^^^^^^^^^^^\n \n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0308`."}, {"sha": "002e4cde40abe62cb380982e78d1a5b00e56f312", "filename": "src/test/ui/impl-trait/issues/issue-78722.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78722.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78722.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78722.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -7,7 +7,8 @@ type F = impl core::future::Future<Output = u8>;\n struct Bug {\n     V1: [(); {\n         fn concrete_use() -> F {\n-            async {} //~ ERROR type mismatch\n+            //~^ ERROR type mismatch\n+            async {}\n         }\n         let f: F = async { 1 };\n         //~^ ERROR `async` blocks are not allowed in constants"}, {"sha": "690d6abc76663cf7cacf3d993fa7a94c7493b846", "filename": "src/test/ui/impl-trait/issues/issue-78722.stderr", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78722.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78722.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78722.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,5 +1,5 @@\n error[E0658]: `async` blocks are not allowed in constants\n-  --> $DIR/issue-78722.rs:12:20\n+  --> $DIR/issue-78722.rs:13:20\n    |\n LL |         let f: F = async { 1 };\n    |                    ^^^^^^^^^^^\n@@ -8,7 +8,7 @@ LL |         let f: F = async { 1 };\n    = help: add `#![feature(const_async_blocks)]` to the crate attributes to enable\n \n error[E0493]: destructors cannot be evaluated at compile-time\n-  --> $DIR/issue-78722.rs:12:13\n+  --> $DIR/issue-78722.rs:13:13\n    |\n LL |         let f: F = async { 1 };\n    |             ^ constants cannot evaluate destructors\n@@ -17,10 +17,10 @@ LL |     }],\n    |     - value is dropped here\n \n error[E0271]: type mismatch resolving `<impl Future<Output = ()> as Future>::Output == u8`\n-  --> $DIR/issue-78722.rs:10:13\n+  --> $DIR/issue-78722.rs:9:30\n    |\n-LL |             async {}\n-   |             ^^^^^^^^ expected `()`, found `u8`\n+LL |         fn concrete_use() -> F {\n+   |                              ^ expected `()`, found `u8`\n \n error: aborting due to 3 previous errors\n "}, {"sha": "e76443a65dbf9ef2f82e3892796a256238d574fd", "filename": "src/test/ui/impl-trait/issues/issue-83919.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-83919.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-83919.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-83919.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -19,8 +19,9 @@ impl Foo for Implementor {\n     type Fut = impl Future<Output=Self::Fut2>;\n \n     fn get_fut(&self) -> Self::Fut {\n+    //~^ ERROR `{integer}` is not a future\n         async move {\n-            42 //~^ ERROR `{integer}` is not a future\n+            42\n             // 42 does not impl Future and rustc does actually point out the error,\n             // but rustc used to panic.\n             // Putting a valid Future here always worked fine."}, {"sha": "d39dcf7fbf5d94ef65321e251731eeb8519901aa", "filename": "src/test/ui/impl-trait/issues/issue-83919.stderr", "status": "modified", "additions": 3, "deletions": 8, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-83919.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-83919.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-83919.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,13 +1,8 @@\n error[E0277]: `{integer}` is not a future\n-  --> $DIR/issue-83919.rs:22:9\n+  --> $DIR/issue-83919.rs:21:26\n    |\n-LL | /         async move {\n-LL | |             42\n-LL | |             // 42 does not impl Future and rustc does actually point out the error,\n-LL | |             // but rustc used to panic.\n-LL | |             // Putting a valid Future here always worked fine.\n-LL | |         }\n-   | |_________^ `{integer}` is not a future\n+LL |     fn get_fut(&self) -> Self::Fut {\n+   |                          ^^^^^^^^^ `{integer}` is not a future\n    |\n    = help: the trait `Future` is not implemented for `{integer}`\n    = note: {integer} must be a future or must implement `IntoFuture` to be awaited"}, {"sha": "fcc077ec18eced86cd7f2807c85a3322bd5dcc97", "filename": "src/test/ui/impl-trait/nested-return-type2-tait2.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fnested-return-type2-tait2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fnested-return-type2-tait2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fnested-return-type2-tait2.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -24,8 +24,8 @@ type Traitable = impl Trait<Assoc = Sendable>;\n // var to make it uphold the `: Duh` bound on `Trait::Assoc`. The opaque\n // type does not implement `Duh`, even if its hidden type does. So we error out.\n fn foo() -> Traitable {\n-    || 42\n     //~^ ERROR `Sendable: Duh` is not satisfied\n+    || 42\n }\n \n fn main() {"}, {"sha": "3e19ad7b5c6cffc055fbda2f60bd31c8a8b18909", "filename": "src/test/ui/impl-trait/nested-return-type2-tait2.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fnested-return-type2-tait2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fnested-return-type2-tait2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fnested-return-type2-tait2.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,11 +1,11 @@\n error[E0277]: the trait bound `Sendable: Duh` is not satisfied\n-  --> $DIR/nested-return-type2-tait2.rs:27:5\n+  --> $DIR/nested-return-type2-tait2.rs:26:13\n    |\n-LL |     || 42\n-   |     ^^^^^ the trait `Duh` is not implemented for `Sendable`\n+LL | fn foo() -> Traitable {\n+   |             ^^^^^^^^^ the trait `Duh` is not implemented for `Sendable`\n    |\n    = help: the trait `Duh` is implemented for `i32`\n-note: required because of the requirements on the impl of `Trait` for `[closure@$DIR/nested-return-type2-tait2.rs:27:5: 27:10]`\n+note: required because of the requirements on the impl of `Trait` for `[closure@$DIR/nested-return-type2-tait2.rs:28:5: 28:10]`\n   --> $DIR/nested-return-type2-tait2.rs:14:31\n    |\n LL | impl<R: Duh, F: FnMut() -> R> Trait for F {"}, {"sha": "665c7a8cab91f66094680109c6d345570660e2f9", "filename": "src/test/ui/impl-trait/nested-return-type2-tait3.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fnested-return-type2-tait3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fnested-return-type2-tait3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fnested-return-type2-tait3.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -23,8 +23,8 @@ type Traitable = impl Trait<Assoc = impl Send>;\n // var to make it uphold the `: Duh` bound on `Trait::Assoc`. The opaque\n // type does not implement `Duh`, even if its hidden type does. So we error out.\n fn foo() -> Traitable {\n-    || 42\n     //~^ ERROR `impl Send: Duh` is not satisfied\n+    || 42\n }\n \n fn main() {"}, {"sha": "6185e4872a5e368b49c05c66d37e6fa0fb1cc188", "filename": "src/test/ui/impl-trait/nested-return-type2-tait3.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fnested-return-type2-tait3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fimpl-trait%2Fnested-return-type2-tait3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fnested-return-type2-tait3.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,11 +1,11 @@\n error[E0277]: the trait bound `impl Send: Duh` is not satisfied\n-  --> $DIR/nested-return-type2-tait3.rs:26:5\n+  --> $DIR/nested-return-type2-tait3.rs:25:13\n    |\n-LL |     || 42\n-   |     ^^^^^ the trait `Duh` is not implemented for `impl Send`\n+LL | fn foo() -> Traitable {\n+   |             ^^^^^^^^^ the trait `Duh` is not implemented for `impl Send`\n    |\n    = help: the trait `Duh` is implemented for `i32`\n-note: required because of the requirements on the impl of `Trait` for `[closure@$DIR/nested-return-type2-tait3.rs:26:5: 26:10]`\n+note: required because of the requirements on the impl of `Trait` for `[closure@$DIR/nested-return-type2-tait3.rs:27:5: 27:10]`\n   --> $DIR/nested-return-type2-tait3.rs:14:31\n    |\n LL | impl<R: Duh, F: FnMut() -> R> Trait for F {"}, {"sha": "95239e2e341c83dc07db154320e93d31fb82bf4a", "filename": "src/test/ui/lazy-type-alias-impl-trait/branches.rs", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Fbranches.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Fbranches.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Fbranches.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -7,8 +7,19 @@ fn foo(b: bool) -> Foo {\n         vec![42_i32]\n     } else {\n         std::iter::empty().collect()\n-        //~^ ERROR `Foo` cannot be built from an iterator over elements of type `_`\n     }\n }\n \n+type Bar = impl std::fmt::Debug;\n+\n+fn bar(b: bool) -> Bar {\n+    let x: Bar = if b {\n+        vec![42_i32]\n+    } else {\n+        std::iter::empty().collect()\n+        //~^ ERROR  a value of type `Bar` cannot be built from an iterator over elements of type `_`\n+    };\n+    x\n+}\n+\n fn main() {}"}, {"sha": "6b87da0c040d5ccacec4f3b544eb8af09cc48fab", "filename": "src/test/ui/lazy-type-alias-impl-trait/branches.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Fbranches.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Fbranches.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Fbranches.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,10 +1,10 @@\n-error[E0277]: a value of type `Foo` cannot be built from an iterator over elements of type `_`\n-  --> $DIR/branches.rs:9:28\n+error[E0277]: a value of type `Bar` cannot be built from an iterator over elements of type `_`\n+  --> $DIR/branches.rs:19:28\n    |\n LL |         std::iter::empty().collect()\n-   |                            ^^^^^^^ value of type `Foo` cannot be built from `std::iter::Iterator<Item=_>`\n+   |                            ^^^^^^^ value of type `Bar` cannot be built from `std::iter::Iterator<Item=_>`\n    |\n-   = help: the trait `FromIterator<_>` is not implemented for `Foo`\n+   = help: the trait `FromIterator<_>` is not implemented for `Bar`\n note: required by a bound in `collect`\n   --> $SRC_DIR/core/src/iter/traits/iterator.rs:LL:COL\n    |"}, {"sha": "04218f5643d1c9a9f96550ebf9b1c6fac0a1f5e8", "filename": "src/test/ui/lazy-type-alias-impl-trait/branches2.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Fbranches2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Fbranches2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Fbranches2.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,6 +1,6 @@\n #![feature(type_alias_impl_trait)]\n \n-// run-pass\n+// check-pass\n \n type Foo = impl std::iter::FromIterator<i32> + PartialEq<Vec<i32>> + std::fmt::Debug;\n "}, {"sha": "30c0af8a5dc979e2e0245096de4c33b417730fef", "filename": "src/test/ui/lazy-type-alias-impl-trait/branches3.rs", "status": "added", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Fbranches3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Fbranches3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Fbranches3.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -0,0 +1,36 @@\n+#![feature(type_alias_impl_trait)]\n+\n+type Foo = impl for<'a> FnOnce(&'a str) -> usize;\n+type Bar = impl FnOnce(&'static str) -> usize;\n+\n+fn foo() -> Foo {\n+    if true {\n+        |s| s.len() //~ ERROR type annotations needed\n+    } else {\n+        panic!()\n+    }\n+}\n+fn bar() -> Bar {\n+    if true {\n+        |s| s.len() //~ ERROR type annotations needed\n+    } else {\n+        panic!()\n+    }\n+}\n+\n+fn foo2() -> impl for<'a> FnOnce(&'a str) -> usize {\n+    if true {\n+        |s| s.len() //~ ERROR type annotations needed\n+    } else {\n+        panic!()\n+    }\n+}\n+fn bar2() -> impl FnOnce(&'static str) -> usize {\n+    if true {\n+        |s| s.len() //~ ERROR type annotations needed\n+    } else {\n+        panic!()\n+    }\n+}\n+\n+fn main() {}"}, {"sha": "77ce1d48480ad70fc2fd12b7946099808d51e3f1", "filename": "src/test/ui/lazy-type-alias-impl-trait/branches3.stderr", "status": "added", "additions": 51, "deletions": 0, "changes": 51, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Fbranches3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Fbranches3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Fbranches3.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -0,0 +1,51 @@\n+error[E0282]: type annotations needed\n+  --> $DIR/branches3.rs:8:10\n+   |\n+LL |         |s| s.len()\n+   |          ^\n+   |\n+   = note: type must be known at this point\n+help: consider giving this closure parameter an explicit type\n+   |\n+LL |         |s: _| s.len()\n+   |           +++\n+\n+error[E0282]: type annotations needed\n+  --> $DIR/branches3.rs:15:10\n+   |\n+LL |         |s| s.len()\n+   |          ^\n+   |\n+   = note: type must be known at this point\n+help: consider giving this closure parameter an explicit type\n+   |\n+LL |         |s: _| s.len()\n+   |           +++\n+\n+error[E0282]: type annotations needed\n+  --> $DIR/branches3.rs:23:10\n+   |\n+LL |         |s| s.len()\n+   |          ^\n+   |\n+   = note: type must be known at this point\n+help: consider giving this closure parameter an explicit type\n+   |\n+LL |         |s: _| s.len()\n+   |           +++\n+\n+error[E0282]: type annotations needed\n+  --> $DIR/branches3.rs:30:10\n+   |\n+LL |         |s| s.len()\n+   |          ^\n+   |\n+   = note: type must be known at this point\n+help: consider giving this closure parameter an explicit type\n+   |\n+LL |         |s: _| s.len()\n+   |           +++\n+\n+error: aborting due to 4 previous errors\n+\n+For more information about this error, try `rustc --explain E0282`."}, {"sha": "6b3d9ff4cdec84712392db473addd0dcfdba7ddd", "filename": "src/test/ui/lazy-type-alias-impl-trait/recursion2.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Frecursion2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Frecursion2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Frecursion2.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,13 +1,15 @@\n #![feature(type_alias_impl_trait)]\n \n+// check-pass\n+\n type Foo = impl std::fmt::Debug;\n \n fn foo(b: bool) -> Foo {\n     if b {\n         return vec![];\n     }\n     let x: Vec<i32> = foo(false);\n-    std::iter::empty().collect() //~ ERROR `Foo` cannot be built from an iterator\n+    std::iter::empty().collect()\n }\n \n fn bar(b: bool) -> impl std::fmt::Debug {"}, {"sha": "1f6201a8300c6dacc29aedef98bb0c9f600c1f95", "filename": "src/test/ui/lazy-type-alias-impl-trait/recursion2.stderr", "status": "removed", "additions": 0, "deletions": 16, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/ddcbba036aee08f0709f98a92a342a278eae5c05/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Frecursion2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ddcbba036aee08f0709f98a92a342a278eae5c05/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Frecursion2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flazy-type-alias-impl-trait%2Frecursion2.stderr?ref=ddcbba036aee08f0709f98a92a342a278eae5c05", "patch": "@@ -1,16 +0,0 @@\n-error[E0277]: a value of type `Foo` cannot be built from an iterator over elements of type `_`\n-  --> $DIR/recursion2.rs:10:24\n-   |\n-LL |     std::iter::empty().collect()\n-   |                        ^^^^^^^ value of type `Foo` cannot be built from `std::iter::Iterator<Item=_>`\n-   |\n-   = help: the trait `FromIterator<_>` is not implemented for `Foo`\n-note: required by a bound in `collect`\n-  --> $SRC_DIR/core/src/iter/traits/iterator.rs:LL:COL\n-   |\n-LL |     fn collect<B: FromIterator<Self::Item>>(self) -> B\n-   |                   ^^^^^^^^^^^^^^^^^^^^^^^^ required by this bound in `collect`\n-\n-error: aborting due to previous error\n-\n-For more information about this error, try `rustc --explain E0277`."}, {"sha": "12c187b9e82aa12ceda8b245dd250b946c8114ab", "filename": "src/test/ui/never_type/impl_trait_fallback2.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fnever_type%2Fimpl_trait_fallback2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fnever_type%2Fimpl_trait_fallback2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnever_type%2Fimpl_trait_fallback2.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -13,6 +13,7 @@ fn should_ret_unit() -> impl T {\n type Foo = impl T;\n \n fn a() -> Foo {\n+    //~^ ERROR `(): T` is not satisfied\n     panic!()\n }\n "}, {"sha": "78cc83bdbfadbb075e5026f83cd283db5addc2c2", "filename": "src/test/ui/never_type/impl_trait_fallback2.stderr", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fnever_type%2Fimpl_trait_fallback2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fnever_type%2Fimpl_trait_fallback2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnever_type%2Fimpl_trait_fallback2.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -6,6 +6,14 @@ LL | fn should_ret_unit() -> impl T {\n    |\n    = help: the trait `T` is implemented for `i32`\n \n-error: aborting due to previous error\n+error[E0277]: the trait bound `(): T` is not satisfied\n+  --> $DIR/impl_trait_fallback2.rs:15:11\n+   |\n+LL | fn a() -> Foo {\n+   |           ^^^ the trait `T` is not implemented for `()`\n+   |\n+   = help: the trait `T` is implemented for `i32`\n+\n+error: aborting due to 2 previous errors\n \n For more information about this error, try `rustc --explain E0277`."}, {"sha": "ed645b82394a0393f9ab0a7aec06629eccfaf8bb", "filename": "src/test/ui/never_type/impl_trait_fallback3.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fnever_type%2Fimpl_trait_fallback3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fnever_type%2Fimpl_trait_fallback3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnever_type%2Fimpl_trait_fallback3.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -7,9 +7,9 @@ trait T {\n }\n \n type Foo = impl T;\n-//~^ ERROR unconstrained opaque type\n \n fn a() -> Foo {\n+    //~^ ERROR the trait bound `(): T` is not satisfied\n     // This is not a defining use, it doesn't actually constrain the opaque type.\n     panic!()\n }"}, {"sha": "5d5d216fb9bcc359c1661460349c56600e771695", "filename": "src/test/ui/never_type/impl_trait_fallback3.stderr", "status": "modified", "additions": 5, "deletions": 6, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fnever_type%2Fimpl_trait_fallback3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Fnever_type%2Fimpl_trait_fallback3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnever_type%2Fimpl_trait_fallback3.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,10 +1,9 @@\n-error: unconstrained opaque type\n-  --> $DIR/impl_trait_fallback3.rs:9:12\n+error[E0277]: the trait bound `(): T` is not satisfied\n+  --> $DIR/impl_trait_fallback3.rs:11:11\n    |\n-LL | type Foo = impl T;\n-   |            ^^^^^^\n-   |\n-   = note: `Foo` must be used in combination with a concrete type within the same module\n+LL | fn a() -> Foo {\n+   |           ^^^ the trait `T` is not implemented for `()`\n \n error: aborting due to previous error\n \n+For more information about this error, try `rustc --explain E0277`."}, {"sha": "7bb490bbec8183912429093fb2305a932857f131", "filename": "src/test/ui/type-alias-impl-trait/closures_in_branches.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fclosures_in_branches.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fclosures_in_branches.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fclosures_in_branches.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -4,7 +4,7 @@ type Foo = impl std::ops::FnOnce(String) -> usize;\n \n fn foo(b: bool) -> Foo {\n     if b {\n-        |x| x.len()\n+        |x| x.len() //~ ERROR type annotations needed\n     } else {\n         panic!()\n     }"}, {"sha": "b7a7871143c63c9e2c9ec16462418cef7b4c9743", "filename": "src/test/ui/type-alias-impl-trait/closures_in_branches.stderr", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fclosures_in_branches.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fclosures_in_branches.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fclosures_in_branches.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,3 +1,15 @@\n+error[E0282]: type annotations needed\n+  --> $DIR/closures_in_branches.rs:7:10\n+   |\n+LL |         |x| x.len()\n+   |          ^\n+   |\n+   = note: type must be known at this point\n+help: consider giving this closure parameter an explicit type\n+   |\n+LL |         |x: _| x.len()\n+   |           +++\n+\n error[E0282]: type annotations needed\n   --> $DIR/closures_in_branches.rs:21:10\n    |\n@@ -10,6 +22,6 @@ help: consider giving this closure parameter an explicit type\n LL |         |x: _| x.len()\n    |           +++\n \n-error: aborting due to previous error\n+error: aborting due to 2 previous errors\n \n For more information about this error, try `rustc --explain E0282`."}, {"sha": "d8cf7d71fef7405b0181e284b28b7e1077bc09a2", "filename": "src/test/ui/type-alias-impl-trait/fallback.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Ffallback.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Ffallback.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Ffallback.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,7 +1,6 @@\n // Tests that we correctly handle opaque types being used opaquely,\n // even within their defining scope.\n //\n-// check-pass\n #![feature(type_alias_impl_trait)]\n \n type Foo = impl Copy;\n@@ -23,6 +22,7 @@ fn constrained_foo() -> Foo {\n // constraints on it.\n fn unconstrained_foo() -> Wrapper<Foo> {\n     Wrapper::Second\n+    //~^ ERROR: type annotations needed\n }\n \n fn main() {}"}, {"sha": "e009399a60abf0f9ea3f82619828cc8027c68c4f", "filename": "src/test/ui/type-alias-impl-trait/fallback.stderr", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Ffallback.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Ffallback.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Ffallback.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -0,0 +1,15 @@\n+error[E0283]: type annotations needed\n+  --> $DIR/fallback.rs:24:5\n+   |\n+LL |     Wrapper::Second\n+   |     ^^^^^^^^^^^^^^^ cannot infer type of the type parameter `T` declared on the enum `Wrapper`\n+   |\n+   = note: cannot satisfy `_: Copy`\n+help: consider specifying the generic argument\n+   |\n+LL |     Wrapper::<T>::Second\n+   |            +++++\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0283`."}, {"sha": "377ce85e8b221521da2d223ed81ccb67836f6ed3", "filename": "src/test/ui/type-alias-impl-trait/issue-53398-cyclic-types.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-53398-cyclic-types.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-53398-cyclic-types.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-53398-cyclic-types.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -3,7 +3,8 @@\n type Foo = impl Fn() -> Foo;\n \n fn foo() -> Foo {\n-    foo //~ ERROR: overflow evaluating the requirement `fn() -> Foo {foo}: Sized`\n+//~^ ERROR: overflow evaluating the requirement `fn() -> Foo {foo}: Sized`\n+    foo\n }\n \n fn main() {}"}, {"sha": "d20b1cc6d851bb135b3dd00fd87cc535e20c9141", "filename": "src/test/ui/type-alias-impl-trait/issue-53398-cyclic-types.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-53398-cyclic-types.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-53398-cyclic-types.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-53398-cyclic-types.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,8 +1,8 @@\n error[E0275]: overflow evaluating the requirement `fn() -> Foo {foo}: Sized`\n-  --> $DIR/issue-53398-cyclic-types.rs:6:5\n+  --> $DIR/issue-53398-cyclic-types.rs:5:13\n    |\n-LL |     foo\n-   |     ^^^\n+LL | fn foo() -> Foo {\n+   |             ^^^\n    |\n    = help: consider increasing the recursion limit by adding a `#![recursion_limit = \"256\"]` attribute to your crate (`issue_53398_cyclic_types`)\n "}, {"sha": "082b0f0c30973e991a386b76d418a9fc7ca031b2", "filename": "src/test/ui/type-alias-impl-trait/issue-60371.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-60371.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-60371.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-60371.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -11,7 +11,7 @@ error[E0277]: the trait bound `(): Bug` is not satisfied\n   --> $DIR/issue-60371.rs:10:40\n    |\n LL |     const FUN: fn() -> Self::Item = || ();\n-   |                                        ^^ the trait `Bug` is not implemented for `()`\n+   |                                        ^ the trait `Bug` is not implemented for `()`\n    |\n    = help: the trait `Bug` is implemented for `&()`\n "}, {"sha": "97332e16d84a22588fd1551aa921928491591507", "filename": "src/test/ui/type-alias-impl-trait/issue-63279.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-63279.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-63279.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-63279.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -5,6 +5,7 @@\n type Closure = impl FnOnce();\n \n fn c() -> Closure {\n+    //~^ ERROR: expected a `FnOnce<()>` closure, found `()`\n     || -> Closure { || () }\n     //~^ ERROR: mismatched types\n     //~| ERROR: mismatched types"}, {"sha": "57fc660901cd8e428fb93972266918c898ac946e", "filename": "src/test/ui/type-alias-impl-trait/issue-63279.stderr", "status": "modified", "additions": 20, "deletions": 12, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-63279.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-63279.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-63279.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,5 +1,14 @@\n error[E0277]: expected a `FnOnce<()>` closure, found `()`\n-  --> $DIR/issue-63279.rs:8:11\n+  --> $DIR/issue-63279.rs:7:11\n+   |\n+LL | fn c() -> Closure {\n+   |           ^^^^^^^ expected an `FnOnce<()>` closure, found `()`\n+   |\n+   = help: the trait `FnOnce<()>` is not implemented for `()`\n+   = note: wrap the `()` in a closure with no arguments: `|| { /* code */ }`\n+\n+error[E0277]: expected a `FnOnce<()>` closure, found `()`\n+  --> $DIR/issue-63279.rs:9:11\n    |\n LL |     || -> Closure { || () }\n    |           ^^^^^^^ expected an `FnOnce<()>` closure, found `()`\n@@ -8,33 +17,32 @@ LL |     || -> Closure { || () }\n    = note: wrap the `()` in a closure with no arguments: `|| { /* code */ }`\n \n error[E0308]: mismatched types\n-  --> $DIR/issue-63279.rs:8:21\n+  --> $DIR/issue-63279.rs:9:21\n    |\n LL |     || -> Closure { || () }\n    |                     ^^^^^ expected `()`, found closure\n    |\n    = note: expected unit type `()`\n-                found closure `[closure@$DIR/issue-63279.rs:8:21: 8:26]`\n+                found closure `[closure@$DIR/issue-63279.rs:9:21: 9:26]`\n help: use parentheses to call this closure\n    |\n LL |     || -> Closure { (|| ())() }\n    |                     +     +++\n \n error[E0308]: mismatched types\n-  --> $DIR/issue-63279.rs:8:5\n+  --> $DIR/issue-63279.rs:9:5\n    |\n-LL | type Closure = impl FnOnce();\n-   |                ------------- the expected opaque type\n-LL |\n-LL | fn c() -> Closure {\n-   |           ------- expected `Closure` because of return type\n LL |     || -> Closure { || () }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^ expected `()`, found closure\n    |\n-   = note: expected opaque type `Closure`\n-                  found closure `[closure@$DIR/issue-63279.rs:8:5: 8:28]`\n+   = note: expected unit type `()`\n+                found closure `[closure@$DIR/issue-63279.rs:9:5: 9:28]`\n+help: use parentheses to call this closure\n+   |\n+LL |     (|| -> Closure { || () })()\n+   |     +                       +++\n \n-error: aborting due to 3 previous errors\n+error: aborting due to 4 previous errors\n \n Some errors have detailed explanations: E0277, E0308.\n For more information about an error, try `rustc --explain E0277`."}, {"sha": "5ed29e0ac94ff77825ba3380e31cc2674183603c", "filename": "src/test/ui/type-alias-impl-trait/issue-74280.stderr", "status": "modified", "additions": 1, "deletions": 7, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-74280.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-74280.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-74280.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,17 +1,11 @@\n error[E0308]: mismatched types\n   --> $DIR/issue-74280.rs:9:5\n    |\n-LL | type Test = impl Copy;\n-   |             --------- the expected opaque type\n-LL |\n LL | fn test() -> Test {\n-   |              ---- expected `Test` because of return type\n+   |              ---- expected `_` because of return type\n LL |     let y = || -> Test { () };\n LL |     7\n    |     ^ expected `()`, found integer\n-   |\n-   = note: expected opaque type `Test`\n-                     found type `{integer}`\n \n error: aborting due to previous error\n "}, {"sha": "2c965b875a00b2ae36be171099137c05f9ec1fa1", "filename": "src/test/ui/type-alias-impl-trait/issue-94429.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-94429.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-94429.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-94429.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -13,7 +13,8 @@ impl Runnable for Implementor {\n     type Gen = impl Generator<Yield = (), Return = ()>;\n \n     fn run(&mut self) -> Self::Gen {\n-        move || { //~ ERROR: type mismatch resolving\n+    //~^ ERROR: type mismatch resolving\n+        move || {\n             yield 1;\n         }\n     }"}, {"sha": "57550104087f78d73f595186218f2ff666bc6502", "filename": "src/test/ui/type-alias-impl-trait/issue-94429.stderr", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-94429.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-94429.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-94429.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,10 +1,8 @@\n-error[E0271]: type mismatch resolving `<[generator@$DIR/issue-94429.rs:16:9: 18:10] as Generator>::Yield == ()`\n-  --> $DIR/issue-94429.rs:16:9\n+error[E0271]: type mismatch resolving `<[generator@$DIR/issue-94429.rs:17:9: 19:10] as Generator>::Yield == ()`\n+  --> $DIR/issue-94429.rs:15:26\n    |\n-LL | /         move || {\n-LL | |             yield 1;\n-LL | |         }\n-   | |_________^ expected integer, found `()`\n+LL |     fn run(&mut self) -> Self::Gen {\n+   |                          ^^^^^^^^^ expected integer, found `()`\n \n error: aborting due to previous error\n "}, {"sha": "da845e86147b7ffb620f880936aae59069a2095f", "filename": "src/test/ui/type-alias-impl-trait/multiple-def-uses-in-one-fn.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fmultiple-def-uses-in-one-fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fmultiple-def-uses-in-one-fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fmultiple-def-uses-in-one-fn.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -7,8 +7,8 @@\n type X<A, B> = impl Into<&'static A>;\n \n fn f<A, B: 'static>(a: &'static A, b: B) -> (X<A, B>, X<B, A>) {\n-    (a, a)\n     //~^ ERROR the trait bound `&'static B: From<&A>` is not satisfied\n+    (a, a)\n }\n \n fn main() {"}, {"sha": "cdaae99e286212fb9bf7589770169eabfe767a39", "filename": "src/test/ui/type-alias-impl-trait/multiple-def-uses-in-one-fn.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fmultiple-def-uses-in-one-fn.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fmultiple-def-uses-in-one-fn.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fmultiple-def-uses-in-one-fn.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,8 +1,8 @@\n error[E0277]: the trait bound `&'static B: From<&A>` is not satisfied\n-  --> $DIR/multiple-def-uses-in-one-fn.rs:10:9\n+  --> $DIR/multiple-def-uses-in-one-fn.rs:9:45\n    |\n-LL |     (a, a)\n-   |         ^ the trait `From<&A>` is not implemented for `&'static B`\n+LL | fn f<A, B: 'static>(a: &'static A, b: B) -> (X<A, B>, X<B, A>) {\n+   |                                             ^^^^^^^^^^^^^^^^^^ the trait `From<&A>` is not implemented for `&'static B`\n    |\n    = note: required because of the requirements on the impl of `Into<&'static B>` for `&A`\n help: consider introducing a `where` clause, but there might be an alternative better way to express this requirement"}, {"sha": "bbe709dccab4eb6e9404d4b5cba860ad4a7a2592", "filename": "src/test/ui/type-alias-impl-trait/multiple-def-uses-in-one-fn3.stderr", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fmultiple-def-uses-in-one-fn3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fmultiple-def-uses-in-one-fn3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fmultiple-def-uses-in-one-fn3.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,18 +1,15 @@\n error[E0308]: mismatched types\n   --> $DIR/multiple-def-uses-in-one-fn3.rs:14:9\n    |\n-LL | type X<A: ToString + Clone, B: ToString + Clone> = impl ToString;\n-   |                                                    ------------- the expected opaque type\n-...\n LL | fn g<A: ToString + Clone, B: ToString + Clone>(a: A, b: B) -> (X<A, B>, X<A, B>) {\n    |      -                    - found type parameter\n    |      |\n    |      expected type parameter\n LL |     (a, b)\n    |         ^ expected type parameter `A`, found type parameter `B`\n    |\n-   = note: expected opaque type `X<A, B>`\n-           found type parameter `B`\n+   = note: expected type parameter `A`\n+              found type parameter `B`\n    = note: a type parameter was expected, but a different one was found; you might be missing a type parameter or trait bound\n    = note: for more information, visit https://doc.rust-lang.org/book/ch10-02-traits.html#traits-as-parameters\n "}, {"sha": "8781196c39fa1366c63dc22f4e1930be5fbe591d", "filename": "src/test/ui/type-alias-impl-trait/self-referential-2.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential-2.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -4,7 +4,7 @@ type Foo = impl std::fmt::Debug;\n type Bar = impl PartialEq<Foo>;\n \n fn bar() -> Bar {\n-    42_i32 //~ ERROR can't compare `i32` with `Foo`\n+    42_i32 //~^ ERROR can't compare `i32` with `Foo`\n }\n \n fn main() {}"}, {"sha": "2b505d30730a3e2079a01e08368d12d0540e4329", "filename": "src/test/ui/type-alias-impl-trait/self-referential-2.stderr", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential-2.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,8 +1,10 @@\n error[E0277]: can't compare `i32` with `Foo`\n-  --> $DIR/self-referential-2.rs:7:5\n+  --> $DIR/self-referential-2.rs:6:13\n    |\n+LL | fn bar() -> Bar {\n+   |             ^^^ no implementation for `i32 == Foo`\n LL |     42_i32\n-   |     ^^^^^^ no implementation for `i32 == Foo`\n+   |     ------ return type was inferred to be `i32` here\n    |\n    = help: the trait `PartialEq<Foo>` is not implemented for `i32`\n    = help: the following other types implement trait `PartialEq<Rhs>`:"}, {"sha": "36742c8ad57fc986907739e97328f1b62e5b062d", "filename": "src/test/ui/type-alias-impl-trait/self-referential-4.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential-4.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential-4.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential-4.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -3,19 +3,19 @@\n type Bar<'a, 'b> = impl PartialEq<Bar<'b, 'static>> + std::fmt::Debug;\n \n fn bar<'a, 'b>(i: &'a i32) -> Bar<'a, 'b> {\n-    i //~ ERROR can't compare `&i32` with `Bar<'b, 'static>`\n+    i //~^ ERROR can't compare `&i32` with `Bar<'b, 'static>`\n }\n \n type Foo<'a, 'b> = impl PartialEq<Foo<'static, 'b>> + std::fmt::Debug;\n \n fn foo<'a, 'b>(i: &'a i32) -> Foo<'a, 'b> {\n-    i //~ ERROR can't compare `&i32` with `Foo<'static, 'b>`\n+    i //~^ ERROR can't compare `&i32` with `Foo<'static, 'b>`\n }\n \n type Moo<'a, 'b> = impl PartialEq<Moo<'static, 'a>> + std::fmt::Debug;\n \n fn moo<'a, 'b>(i: &'a i32) -> Moo<'a, 'b> {\n-    i //~ ERROR can't compare `&i32` with `Moo<'static, 'a>`\n+    i //~^ ERROR can't compare `&i32` with `Moo<'static, 'a>`\n }\n \n fn main() {"}, {"sha": "27880f792f462e6c279454d7f2806692aaf91b76", "filename": "src/test/ui/type-alias-impl-trait/self-referential-4.stderr", "status": "modified", "additions": 12, "deletions": 6, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential-4.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential-4.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential-4.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,8 +1,10 @@\n error[E0277]: can't compare `&i32` with `Bar<'b, 'static>`\n-  --> $DIR/self-referential-4.rs:6:5\n+  --> $DIR/self-referential-4.rs:5:31\n    |\n+LL | fn bar<'a, 'b>(i: &'a i32) -> Bar<'a, 'b> {\n+   |                               ^^^^^^^^^^^ no implementation for `&i32 == Bar<'b, 'static>`\n LL |     i\n-   |     ^ no implementation for `&i32 == Bar<'b, 'static>`\n+   |     - return type was inferred to be `&i32` here\n    |\n    = help: the trait `PartialEq<Bar<'b, 'static>>` is not implemented for `&i32`\n    = help: the following other types implement trait `PartialEq<Rhs>`:\n@@ -17,10 +19,12 @@ LL |     i\n            and 6 others\n \n error[E0277]: can't compare `&i32` with `Foo<'static, 'b>`\n-  --> $DIR/self-referential-4.rs:12:5\n+  --> $DIR/self-referential-4.rs:11:31\n    |\n+LL | fn foo<'a, 'b>(i: &'a i32) -> Foo<'a, 'b> {\n+   |                               ^^^^^^^^^^^ no implementation for `&i32 == Foo<'static, 'b>`\n LL |     i\n-   |     ^ no implementation for `&i32 == Foo<'static, 'b>`\n+   |     - return type was inferred to be `&i32` here\n    |\n    = help: the trait `PartialEq<Foo<'static, 'b>>` is not implemented for `&i32`\n    = help: the following other types implement trait `PartialEq<Rhs>`:\n@@ -35,10 +39,12 @@ LL |     i\n            and 6 others\n \n error[E0277]: can't compare `&i32` with `Moo<'static, 'a>`\n-  --> $DIR/self-referential-4.rs:18:5\n+  --> $DIR/self-referential-4.rs:17:31\n    |\n+LL | fn moo<'a, 'b>(i: &'a i32) -> Moo<'a, 'b> {\n+   |                               ^^^^^^^^^^^ no implementation for `&i32 == Moo<'static, 'a>`\n LL |     i\n-   |     ^ no implementation for `&i32 == Moo<'static, 'a>`\n+   |     - return type was inferred to be `&i32` here\n    |\n    = help: the trait `PartialEq<Moo<'static, 'a>>` is not implemented for `&i32`\n    = help: the following other types implement trait `PartialEq<Rhs>`:"}, {"sha": "3ff5406a382709831bd7b753b58e760cb70b800e", "filename": "src/test/ui/type-alias-impl-trait/self-referential.rs", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential.rs?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -3,19 +3,22 @@\n type Bar<'a, 'b> = impl PartialEq<Bar<'b, 'a>> + std::fmt::Debug;\n \n fn bar<'a, 'b>(i: &'a i32) -> Bar<'a, 'b> {\n-    i //~ ERROR can't compare `&i32` with `Bar<'b, 'a>`\n+    //~^ ERROR can't compare `&i32` with `Bar<'b, 'a>`\n+    i\n }\n \n type Foo<'a, 'b> = (i32, impl PartialEq<Foo<'a, 'b>> + std::fmt::Debug);\n \n fn foo<'a, 'b>(i: &'a i32) -> Foo<'a, 'b> {\n-    (42, i) //~ ERROR can't compare `&i32` with `(i32, &i32)`\n+    //~^ ERROR can't compare `&i32` with `(i32, &i32)`\n+    (42, i)\n }\n \n type Moo<'a, 'b> = (i32, impl PartialEq<Moo<'b, 'a>> + std::fmt::Debug);\n \n fn moo<'a, 'b>(i: &'a i32) -> Moo<'a, 'b> {\n-    (42, i) //~ ERROR can't compare `&i32` with `(i32, Moo<'b, 'a>::{opaque#0})`\n+    //~^ ERROR can't compare `&i32` with `(i32, Moo<'b, 'a>::{opaque#0})`\n+    (42, i)\n }\n \n fn main() {"}, {"sha": "97d510f6830af2ca621d5b191667081ad3af50d2", "filename": "src/test/ui/type-alias-impl-trait/self-referential.stderr", "status": "modified", "additions": 15, "deletions": 6, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fself-referential.stderr?ref=48170d5a1ccc4ff1e8a370fb63bd8eb29de92a25", "patch": "@@ -1,8 +1,11 @@\n error[E0277]: can't compare `&i32` with `Bar<'b, 'a>`\n-  --> $DIR/self-referential.rs:6:5\n+  --> $DIR/self-referential.rs:5:31\n    |\n+LL | fn bar<'a, 'b>(i: &'a i32) -> Bar<'a, 'b> {\n+   |                               ^^^^^^^^^^^ no implementation for `&i32 == Bar<'b, 'a>`\n+LL |\n LL |     i\n-   |     ^ no implementation for `&i32 == Bar<'b, 'a>`\n+   |     - return type was inferred to be `&i32` here\n    |\n    = help: the trait `PartialEq<Bar<'b, 'a>>` is not implemented for `&i32`\n    = help: the following other types implement trait `PartialEq<Rhs>`:\n@@ -17,10 +20,13 @@ LL |     i\n            and 6 others\n \n error[E0277]: can't compare `&i32` with `(i32, &i32)`\n-  --> $DIR/self-referential.rs:12:10\n+  --> $DIR/self-referential.rs:12:31\n    |\n+LL | fn foo<'a, 'b>(i: &'a i32) -> Foo<'a, 'b> {\n+   |                               ^^^^^^^^^^^ no implementation for `&i32 == (i32, &i32)`\n+LL |\n LL |     (42, i)\n-   |          ^ no implementation for `&i32 == (i32, &i32)`\n+   |     ------- return type was inferred to be `(i32, &i32)` here\n    |\n    = help: the trait `PartialEq<(i32, &i32)>` is not implemented for `&i32`\n    = help: the following other types implement trait `PartialEq<Rhs>`:\n@@ -35,10 +41,13 @@ LL |     (42, i)\n            and 6 others\n \n error[E0277]: can't compare `&i32` with `(i32, Moo<'b, 'a>::{opaque#0})`\n-  --> $DIR/self-referential.rs:18:10\n+  --> $DIR/self-referential.rs:19:31\n    |\n+LL | fn moo<'a, 'b>(i: &'a i32) -> Moo<'a, 'b> {\n+   |                               ^^^^^^^^^^^ no implementation for `&i32 == (i32, Moo<'b, 'a>::{opaque#0})`\n+LL |\n LL |     (42, i)\n-   |          ^ no implementation for `&i32 == (i32, Moo<'b, 'a>::{opaque#0})`\n+   |     ------- return type was inferred to be `(i32, &i32)` here\n    |\n    = help: the trait `PartialEq<(i32, Moo<'b, 'a>::{opaque#0})>` is not implemented for `&i32`\n    = help: the following other types implement trait `PartialEq<Rhs>`:"}]}