{"sha": "c3284733e3effa92cff2f87b7a38c27ac781411e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMzMjg0NzMzZTNlZmZhOTJjZmYyZjg3YjdhMzhjMjdhYzc4MTQxMWU=", "commit": {"author": {"name": "Huon Wilson", "email": "dbau.pp+github@gmail.com", "date": "2014-08-07T12:06:29Z"}, "committer": {"name": "Huon Wilson", "email": "dbau.pp+github@gmail.com", "date": "2014-08-09T03:00:58Z"}, "message": "move a test into a run make, to check external affect rather than\nimplementation details.\n\n(Mainly to avoid accessing the secret internal test module symbol name.)", "tree": {"sha": "a647e57d3e9c883493e32954736014d162faf1b0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a647e57d3e9c883493e32954736014d162faf1b0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c3284733e3effa92cff2f87b7a38c27ac781411e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c3284733e3effa92cff2f87b7a38c27ac781411e", "html_url": "https://github.com/rust-lang/rust/commit/c3284733e3effa92cff2f87b7a38c27ac781411e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c3284733e3effa92cff2f87b7a38c27ac781411e/comments", "author": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3826026f98de137adf51d3df88d5c4e40d790cf0", "url": "https://api.github.com/repos/rust-lang/rust/commits/3826026f98de137adf51d3df88d5c4e40d790cf0", "html_url": "https://github.com/rust-lang/rust/commit/3826026f98de137adf51d3df88d5c4e40d790cf0"}], "stats": {"total": 62, "additions": 26, "deletions": 36}, "files": [{"sha": "4517af8e24be595c38c3a735077297fd51572864", "filename": "src/test/run-make/test-harness/Makefile", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/c3284733e3effa92cff2f87b7a38c27ac781411e/src%2Ftest%2Frun-make%2Ftest-harness%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/c3284733e3effa92cff2f87b7a38c27ac781411e/src%2Ftest%2Frun-make%2Ftest-harness%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Ftest-harness%2FMakefile?ref=c3284733e3effa92cff2f87b7a38c27ac781411e", "patch": "@@ -0,0 +1,7 @@\n+-include ../tools.mk\n+\n+all:\n+\t# check that #[ignore(cfg(...))] does the right thing.\n+\t$(RUSTC) --test test-ignore-cfg.rs --cfg ignorecfg\n+\t$(call RUN,test-ignore-cfg) | grep 'shouldnotignore ... ok'\n+\t$(call RUN,test-ignore-cfg) | grep 'shouldignore ... ignored'"}, {"sha": "a8f88cc8544a927685fc18e484d59fe9c3fe0ed2", "filename": "src/test/run-make/test-harness/test-ignore-cfg.rs", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/c3284733e3effa92cff2f87b7a38c27ac781411e/src%2Ftest%2Frun-make%2Ftest-harness%2Ftest-ignore-cfg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c3284733e3effa92cff2f87b7a38c27ac781411e/src%2Ftest%2Frun-make%2Ftest-harness%2Ftest-ignore-cfg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Ftest-harness%2Ftest-ignore-cfg.rs?ref=c3284733e3effa92cff2f87b7a38c27ac781411e", "patch": "@@ -0,0 +1,19 @@\n+// Copyright 2014 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+#[test]\n+#[ignore(cfg(ignorecfg))]\n+fn shouldignore() {\n+}\n+\n+#[test]\n+#[ignore(cfg(noignorecfg))]\n+fn shouldnotignore() {\n+}"}, {"sha": "b36fbca2da048a68f9b82af3c19712e00677ec47", "filename": "src/test/run-pass/test-ignore-cfg.rs", "status": "removed", "additions": 0, "deletions": 36, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/3826026f98de137adf51d3df88d5c4e40d790cf0/src%2Ftest%2Frun-pass%2Ftest-ignore-cfg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3826026f98de137adf51d3df88d5c4e40d790cf0/src%2Ftest%2Frun-pass%2Ftest-ignore-cfg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Ftest-ignore-cfg.rs?ref=3826026f98de137adf51d3df88d5c4e40d790cf0", "patch": "@@ -1,36 +0,0 @@\n-// Copyright 2012-2014 The Rust Project Developers. See the COPYRIGHT\n-// file at the top-level directory of this distribution and at\n-// http://rust-lang.org/COPYRIGHT.\n-//\n-// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n-// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n-// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n-// option. This file may not be copied, modified, or distributed\n-// except according to those terms.\n-\n-// compile-flags: --test --cfg ignorecfg\n-// ignore-pretty: does not work well with `--test`\n-\n-#[test]\n-#[ignore(cfg(ignorecfg))]\n-fn shouldignore() {\n-}\n-\n-#[test]\n-#[ignore(cfg(noignorecfg))]\n-fn shouldnotignore() {\n-}\n-\n-#[test]\n-fn checktests() {\n-    // Pull the tests out of the secreturn test module\n-    let tests = __test::TESTS;\n-\n-    assert!(\n-        tests.iter().any(|t| t.desc.name.to_string().as_slice() == \"shouldignore\" &&\n-                         t.desc.ignore));\n-\n-    assert!(\n-        tests.iter().any(|t| t.desc.name.to_string().as_slice() == \"shouldnotignore\" &&\n-                         !t.desc.ignore));\n-}"}]}