{"sha": "005ea3b17375584f823c51d141248e3bcbc04115", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAwNWVhM2IxNzM3NTU4NGY4MjNjNTFkMTQxMjQ4ZTNiY2JjMDQxMTU=", "commit": {"author": {"name": "Luqman Aden", "email": "me@luqman.ca", "date": "2013-07-25T22:18:43Z"}, "committer": {"name": "Luqman Aden", "email": "me@luqman.ca", "date": "2013-07-25T22:27:18Z"}, "message": "libstd: Add ToStr impl for IpAddr.", "tree": {"sha": "92b4fb55bc62123601e2ba9dc4f48e95660a5dd6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/92b4fb55bc62123601e2ba9dc4f48e95660a5dd6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/005ea3b17375584f823c51d141248e3bcbc04115", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/005ea3b17375584f823c51d141248e3bcbc04115", "html_url": "https://github.com/rust-lang/rust/commit/005ea3b17375584f823c51d141248e3bcbc04115", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/005ea3b17375584f823c51d141248e3bcbc04115/comments", "author": {"login": "luqmana", "id": 287063, "node_id": "MDQ6VXNlcjI4NzA2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/287063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luqmana", "html_url": "https://github.com/luqmana", "followers_url": "https://api.github.com/users/luqmana/followers", "following_url": "https://api.github.com/users/luqmana/following{/other_user}", "gists_url": "https://api.github.com/users/luqmana/gists{/gist_id}", "starred_url": "https://api.github.com/users/luqmana/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luqmana/subscriptions", "organizations_url": "https://api.github.com/users/luqmana/orgs", "repos_url": "https://api.github.com/users/luqmana/repos", "events_url": "https://api.github.com/users/luqmana/events{/privacy}", "received_events_url": "https://api.github.com/users/luqmana/received_events", "type": "User", "site_admin": false}, "committer": {"login": "luqmana", "id": 287063, "node_id": "MDQ6VXNlcjI4NzA2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/287063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luqmana", "html_url": "https://github.com/luqmana", "followers_url": "https://api.github.com/users/luqmana/followers", "following_url": "https://api.github.com/users/luqmana/following{/other_user}", "gists_url": "https://api.github.com/users/luqmana/gists{/gist_id}", "starred_url": "https://api.github.com/users/luqmana/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luqmana/subscriptions", "organizations_url": "https://api.github.com/users/luqmana/orgs", "repos_url": "https://api.github.com/users/luqmana/repos", "events_url": "https://api.github.com/users/luqmana/events{/privacy}", "received_events_url": "https://api.github.com/users/luqmana/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d6e1a6b237d4c3b04a7dff6609c3427eb99bbc60", "url": "https://api.github.com/repos/rust-lang/rust/commits/d6e1a6b237d4c3b04a7dff6609c3427eb99bbc60", "html_url": "https://github.com/rust-lang/rust/commit/d6e1a6b237d4c3b04a7dff6609c3427eb99bbc60"}], "stats": {"total": 42, "additions": 42, "deletions": 0}, "files": [{"sha": "2b572574b60b207d9ac1541a2e9b2e40e9fd3280", "filename": "src/libstd/rt/io/net/ip.rs", "status": "modified", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/rust-lang/rust/blob/005ea3b17375584f823c51d141248e3bcbc04115/src%2Flibstd%2Frt%2Fio%2Fnet%2Fip.rs", "raw_url": "https://github.com/rust-lang/rust/raw/005ea3b17375584f823c51d141248e3bcbc04115/src%2Flibstd%2Frt%2Fio%2Fnet%2Fip.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Frt%2Fio%2Fnet%2Fip.rs?ref=005ea3b17375584f823c51d141248e3bcbc04115", "patch": "@@ -8,10 +8,52 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n+use num::FromStrRadix;\n+use to_str::ToStr;\n+\n type Port = u16;\n \n #[deriving(Eq, TotalEq)]\n pub enum IpAddr {\n     Ipv4(u8, u8, u8, u8, Port),\n     Ipv6(u16, u16, u16, u16, u16, u16, u16, u16, Port)\n }\n+\n+impl ToStr for IpAddr {\n+    fn to_str(&self) -> ~str {\n+        match *self {\n+            Ipv4(a, b, c, d, p) =>\n+                fmt!(\"%u.%u.%u.%u:%u\",\n+                    a as uint, b as uint, c as uint, d as uint, p as uint),\n+\n+            // Ipv4 Compatible address\n+            Ipv6(0, 0, 0, 0, 0, 0, g, h, p) => {\n+                let a = fmt!(\"%04x\", g as uint);\n+                let b = FromStrRadix::from_str_radix(a.slice(2, 4), 16).unwrap();\n+                let a = FromStrRadix::from_str_radix(a.slice(0, 2), 16).unwrap();\n+                let c = fmt!(\"%04x\", h as uint);\n+                let d = FromStrRadix::from_str_radix(c.slice(2, 4), 16).unwrap();\n+                let c = FromStrRadix::from_str_radix(c.slice(0, 2), 16).unwrap();\n+\n+                fmt!(\"[::%u.%u.%u.%u]:%u\", a, b, c, d, p as uint)\n+            }\n+\n+            // Ipv4-Mapped address\n+            Ipv6(0, 0, 0, 0, 0, 1, g, h, p) => {\n+                let a = fmt!(\"%04x\", g as uint);\n+                let b = FromStrRadix::from_str_radix(a.slice(2, 4), 16).unwrap();\n+                let a = FromStrRadix::from_str_radix(a.slice(0, 2), 16).unwrap();\n+                let c = fmt!(\"%04x\", h as uint);\n+                let d = FromStrRadix::from_str_radix(c.slice(2, 4), 16).unwrap();\n+                let c = FromStrRadix::from_str_radix(c.slice(0, 2), 16).unwrap();\n+\n+                fmt!(\"[::FFFF:%u.%u.%u.%u]:%u\", a, b, c, d, p as uint)\n+            }\n+\n+            Ipv6(a, b, c, d, e, f, g, h, p) =>\n+                fmt!(\"[%x:%x:%x:%x:%x:%x:%x:%x]:%u\",\n+                    a as uint, b as uint, c as uint, d as uint,\n+                    e as uint, f as uint, g as uint, h as uint, p as uint)\n+        }\n+    }\n+}"}]}