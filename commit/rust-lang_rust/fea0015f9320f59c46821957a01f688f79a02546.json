{"sha": "fea0015f9320f59c46821957a01f688f79a02546", "node_id": "C_kwDOAAsO6NoAKGZlYTAwMTVmOTMyMGY1OWM0NjgyMTk1N2EwMWY2ODhmNzlhMDI1NDY", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2021-12-02T02:51:27Z"}, "committer": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-02-09T17:35:46Z"}, "message": "Suggest collecting into `Vec<_>` when collecting into `[_]`", "tree": {"sha": "618eb44818009f740134138400638cd17c5dc596", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/618eb44818009f740134138400638cd17c5dc596"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fea0015f9320f59c46821957a01f688f79a02546", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fea0015f9320f59c46821957a01f688f79a02546", "html_url": "https://github.com/rust-lang/rust/commit/fea0015f9320f59c46821957a01f688f79a02546", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fea0015f9320f59c46821957a01f688f79a02546/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f43e3a86a7286057a748c731b732200e2ccde466", "url": "https://api.github.com/repos/rust-lang/rust/commits/f43e3a86a7286057a748c731b732200e2ccde466", "html_url": "https://github.com/rust-lang/rust/commit/f43e3a86a7286057a748c731b732200e2ccde466"}], "stats": {"total": 67, "additions": 67, "deletions": 0}, "files": [{"sha": "637d7bc44885e96902413d6eed0290f06004babf", "filename": "library/core/src/iter/traits/collect.rs", "status": "modified", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/fea0015f9320f59c46821957a01f688f79a02546/library%2Fcore%2Fsrc%2Fiter%2Ftraits%2Fcollect.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fea0015f9320f59c46821957a01f688f79a02546/library%2Fcore%2Fsrc%2Fiter%2Ftraits%2Fcollect.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fiter%2Ftraits%2Fcollect.rs?ref=fea0015f9320f59c46821957a01f688f79a02546", "patch": "@@ -81,6 +81,32 @@\n /// ```\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n #[rustc_on_unimplemented(\n+    on(\n+        _Self = \"[{A}]\",\n+        message = \"a value of type `{Self}` cannot be built since `{Self}` has no definite size\",\n+        label = \"try explicitly collecting into a `Vec<{A}>`\",\n+    ),\n+    on(\n+        all(\n+            A = \"{integer}\",\n+            any(\n+                _Self = \"[i8]\",\n+                _Self = \"[i16]\",\n+                _Self = \"[i32]\",\n+                _Self = \"[i64]\",\n+                _Self = \"[i128]\",\n+                _Self = \"[isize]\",\n+                _Self = \"[u8]\",\n+                _Self = \"[u16]\",\n+                _Self = \"[u32]\",\n+                _Self = \"[u64]\",\n+                _Self = \"[u128]\",\n+                _Self = \"[usize]\"\n+            )\n+        ),\n+        message = \"a value of type `{Self}` cannot be built since `{Self}` has no definite size\",\n+        label = \"try explicitly collecting into a `Vec<{A}>`\",\n+    ),\n     message = \"a value of type `{Self}` cannot be built from an iterator \\\n                over elements of type `{A}`\",\n     label = \"value of type `{Self}` cannot be built from `std::iter::Iterator<Item={A}>`\""}, {"sha": "905752dec7478749119da406f960da1469203698", "filename": "src/test/ui/iterators/collect-into-slice.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/fea0015f9320f59c46821957a01f688f79a02546/src%2Ftest%2Fui%2Fiterators%2Fcollect-into-slice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fea0015f9320f59c46821957a01f688f79a02546/src%2Ftest%2Fui%2Fiterators%2Fcollect-into-slice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fiterators%2Fcollect-into-slice.rs?ref=fea0015f9320f59c46821957a01f688f79a02546", "patch": "@@ -0,0 +1,15 @@\n+fn process_slice(data: &[i32]) {\n+    //~^ NOTE required by a bound in this\n+    todo!()\n+}\n+\n+fn main() {\n+    let some_generated_vec = (0..10).collect();\n+    //~^ ERROR the size for values of type `[i32]` cannot be known at compilation time\n+    //~| ERROR a value of type `[i32]` cannot be built since `[i32]` has no definite size\n+    //~| NOTE try explicitly collecting into a `Vec<{integer}>`\n+    //~| NOTE required by a bound in `collect`\n+    //~| NOTE all local variables must have a statically known size\n+    //~| NOTE doesn't have a size known at compile-time\n+    process_slice(&some_generated_vec);\n+}"}, {"sha": "521f239451d2f9913793f4488d3403cd26e1f2cb", "filename": "src/test/ui/iterators/collect-into-slice.stderr", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/fea0015f9320f59c46821957a01f688f79a02546/src%2Ftest%2Fui%2Fiterators%2Fcollect-into-slice.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fea0015f9320f59c46821957a01f688f79a02546/src%2Ftest%2Fui%2Fiterators%2Fcollect-into-slice.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fiterators%2Fcollect-into-slice.stderr?ref=fea0015f9320f59c46821957a01f688f79a02546", "patch": "@@ -0,0 +1,26 @@\n+error[E0277]: the size for values of type `[i32]` cannot be known at compilation time\n+  --> $DIR/collect-into-slice.rs:7:9\n+   |\n+LL |     let some_generated_vec = (0..10).collect();\n+   |         ^^^^^^^^^^^^^^^^^^ doesn't have a size known at compile-time\n+   |\n+   = help: the trait `Sized` is not implemented for `[i32]`\n+   = note: all local variables must have a statically known size\n+   = help: unsized locals are gated as an unstable feature\n+\n+error[E0277]: a value of type `[i32]` cannot be built since `[i32]` has no definite size\n+  --> $DIR/collect-into-slice.rs:7:38\n+   |\n+LL |     let some_generated_vec = (0..10).collect();\n+   |                                      ^^^^^^^ try explicitly collecting into a `Vec<{integer}>`\n+   |\n+   = help: the trait `FromIterator<{integer}>` is not implemented for `[i32]`\n+note: required by a bound in `collect`\n+  --> $SRC_DIR/core/src/iter/traits/iterator.rs:LL:COL\n+   |\n+LL |     fn collect<B: FromIterator<Self::Item>>(self) -> B\n+   |                   ^^^^^^^^^^^^^^^^^^^^^^^^ required by this bound in `collect`\n+\n+error: aborting due to 2 previous errors\n+\n+For more information about this error, try `rustc --explain E0277`."}]}