{"sha": "2aa9aaada5f7ebd0236bf7ebdbbce6ec8b684239", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJhYTlhYWFkYTVmN2ViZDAyMzZiZjdlYmRiYmNlNmVjOGI2ODQyMzk=", "commit": {"author": {"name": "Amanieu d'Antras", "email": "amanieu@gmail.com", "date": "2020-05-08T00:15:56Z"}, "committer": {"name": "Amanieu d'Antras", "email": "amanieu@gmail.com", "date": "2020-05-18T13:41:34Z"}, "message": "Add borrow-check test", "tree": {"sha": "329f5470a4a2b8f5ce576dceeac0e395b2cd5474", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/329f5470a4a2b8f5ce576dceeac0e395b2cd5474"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2aa9aaada5f7ebd0236bf7ebdbbce6ec8b684239", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2aa9aaada5f7ebd0236bf7ebdbbce6ec8b684239", "html_url": "https://github.com/rust-lang/rust/commit/2aa9aaada5f7ebd0236bf7ebdbbce6ec8b684239", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2aa9aaada5f7ebd0236bf7ebdbbce6ec8b684239/comments", "author": {"login": "Amanieu", "id": 278509, "node_id": "MDQ6VXNlcjI3ODUwOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/278509?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Amanieu", "html_url": "https://github.com/Amanieu", "followers_url": "https://api.github.com/users/Amanieu/followers", "following_url": "https://api.github.com/users/Amanieu/following{/other_user}", "gists_url": "https://api.github.com/users/Amanieu/gists{/gist_id}", "starred_url": "https://api.github.com/users/Amanieu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Amanieu/subscriptions", "organizations_url": "https://api.github.com/users/Amanieu/orgs", "repos_url": "https://api.github.com/users/Amanieu/repos", "events_url": "https://api.github.com/users/Amanieu/events{/privacy}", "received_events_url": "https://api.github.com/users/Amanieu/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Amanieu", "id": 278509, "node_id": "MDQ6VXNlcjI3ODUwOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/278509?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Amanieu", "html_url": "https://github.com/Amanieu", "followers_url": "https://api.github.com/users/Amanieu/followers", "following_url": "https://api.github.com/users/Amanieu/following{/other_user}", "gists_url": "https://api.github.com/users/Amanieu/gists{/gist_id}", "starred_url": "https://api.github.com/users/Amanieu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Amanieu/subscriptions", "organizations_url": "https://api.github.com/users/Amanieu/orgs", "repos_url": "https://api.github.com/users/Amanieu/repos", "events_url": "https://api.github.com/users/Amanieu/events{/privacy}", "received_events_url": "https://api.github.com/users/Amanieu/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f10803c81cf6417c2ebe982519fa7c4502cab2cf", "url": "https://api.github.com/repos/rust-lang/rust/commits/f10803c81cf6417c2ebe982519fa7c4502cab2cf", "html_url": "https://github.com/rust-lang/rust/commit/f10803c81cf6417c2ebe982519fa7c4502cab2cf"}], "stats": {"total": 51, "additions": 50, "deletions": 1}, "files": [{"sha": "c6b7d310dfa6cd83c226a46c9ef4dc35e3ea0c81", "filename": "src/test/ui/asm/bad-reg.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2aa9aaada5f7ebd0236bf7ebdbbce6ec8b684239/src%2Ftest%2Fui%2Fasm%2Fbad-reg.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2aa9aaada5f7ebd0236bf7ebdbbce6ec8b684239/src%2Ftest%2Fui%2Fasm%2Fbad-reg.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fasm%2Fbad-reg.stderr?ref=2aa9aaada5f7ebd0236bf7ebdbbce6ec8b684239", "patch": "@@ -18,7 +18,7 @@ LL |         asm!(\"{:z}\", in(reg) foo);\n    |               |\n    |               template modifier\n    |\n-   = note: the `reg` register class supports the following template modifiers: `l`, `h`, `x`, `e`, `r`\n+   = note: the `reg` register class supports the following template modifiers: `l`, `x`, `e`, `r`\n \n error: invalid asm template modifier for this register class\n   --> $DIR/bad-reg.rs:18:15"}, {"sha": "2be627c11657b4b95e645d3a5af41bc78bd3d5ce", "filename": "src/test/ui/asm/type-check-4.rs", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/2aa9aaada5f7ebd0236bf7ebdbbce6ec8b684239/src%2Ftest%2Fui%2Fasm%2Ftype-check-4.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aa9aaada5f7ebd0236bf7ebdbbce6ec8b684239/src%2Ftest%2Fui%2Fasm%2Ftype-check-4.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fasm%2Ftype-check-4.rs?ref=2aa9aaada5f7ebd0236bf7ebdbbce6ec8b684239", "patch": "@@ -0,0 +1,23 @@\n+// only-x86_64\n+\n+#![feature(asm)]\n+\n+fn main() {\n+    unsafe {\n+        // Can't output to borrowed values.\n+\n+        let mut a = 0isize;\n+        let p = &a;\n+        asm!(\"{}\", out(reg) a);\n+        //~^ cannot assign to `a` because it is borrowed\n+        println!(\"{}\", p);\n+\n+        // Can't read from mutable borrowed values.\n+\n+        let mut a = 0isize;\n+        let p = &mut a;\n+        asm!(\"{}\", in(reg) a);\n+        //~^ cannot use `a` because it was mutably borrowed\n+        println!(\"{}\", p);\n+    }\n+}"}, {"sha": "8035bbefc1aa1156ffc700fb77b9eff2fcc8c727", "filename": "src/test/ui/asm/type-check-4.stderr", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/2aa9aaada5f7ebd0236bf7ebdbbce6ec8b684239/src%2Ftest%2Fui%2Fasm%2Ftype-check-4.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2aa9aaada5f7ebd0236bf7ebdbbce6ec8b684239/src%2Ftest%2Fui%2Fasm%2Ftype-check-4.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fasm%2Ftype-check-4.stderr?ref=2aa9aaada5f7ebd0236bf7ebdbbce6ec8b684239", "patch": "@@ -0,0 +1,26 @@\n+error[E0506]: cannot assign to `a` because it is borrowed\n+  --> $DIR/type-check-4.rs:11:9\n+   |\n+LL |         let p = &a;\n+   |                 -- borrow of `a` occurs here\n+LL |         asm!(\"{}\", out(reg) a);\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^ assignment to borrowed `a` occurs here\n+LL |\n+LL |         println!(\"{}\", p);\n+   |                        - borrow later used here\n+\n+error[E0503]: cannot use `a` because it was mutably borrowed\n+  --> $DIR/type-check-4.rs:19:28\n+   |\n+LL |         let p = &mut a;\n+   |                 ------ borrow of `a` occurs here\n+LL |         asm!(\"{}\", in(reg) a);\n+   |                            ^ use of borrowed `a`\n+LL |\n+LL |         println!(\"{}\", p);\n+   |                        - borrow later used here\n+\n+error: aborting due to 2 previous errors\n+\n+Some errors have detailed explanations: E0503, E0506.\n+For more information about an error, try `rustc --explain E0503`."}]}