{"sha": "00ce770e348a4d00985b8872fc4874480115f621", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAwY2U3NzBlMzQ4YTRkMDA5ODViODg3MmZjNDg3NDQ4MDExNWY2MjE=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2018-01-06T11:53:33Z"}, "committer": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2018-01-22T09:54:30Z"}, "message": "Store a list of local macros on the resolver; use for resolving intra-doc macro links", "tree": {"sha": "2188ca41377705fe32ddac87030479d879189ac2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2188ca41377705fe32ddac87030479d879189ac2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/00ce770e348a4d00985b8872fc4874480115f621", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/00ce770e348a4d00985b8872fc4874480115f621", "html_url": "https://github.com/rust-lang/rust/commit/00ce770e348a4d00985b8872fc4874480115f621", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/00ce770e348a4d00985b8872fc4874480115f621/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7ac48d793bc06d2646244e070c25cc129e539d17", "url": "https://api.github.com/repos/rust-lang/rust/commits/7ac48d793bc06d2646244e070c25cc129e539d17", "html_url": "https://github.com/rust-lang/rust/commit/7ac48d793bc06d2646244e070c25cc129e539d17"}], "stats": {"total": 7, "additions": 6, "deletions": 1}, "files": [{"sha": "c55e23e917a1c856c848947dd5ad620c708e95a7", "filename": "src/librustc_resolve/lib.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/00ce770e348a4d00985b8872fc4874480115f621/src%2Flibrustc_resolve%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00ce770e348a4d00985b8872fc4874480115f621/src%2Flibrustc_resolve%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Flib.rs?ref=00ce770e348a4d00985b8872fc4874480115f621", "patch": "@@ -1320,6 +1320,7 @@ pub struct Resolver<'a> {\n     crate_loader: &'a mut CrateLoader,\n     macro_names: FxHashSet<Ident>,\n     global_macros: FxHashMap<Name, &'a NameBinding<'a>>,\n+    pub all_macros: FxHashMap<Name, Def>,\n     lexical_macro_resolutions: Vec<(Ident, &'a Cell<LegacyScope<'a>>)>,\n     macro_map: FxHashMap<DefId, Rc<SyntaxExtension>>,\n     macro_defs: FxHashMap<Mark, DefId>,\n@@ -1596,6 +1597,7 @@ impl<'a> Resolver<'a> {\n             crate_loader,\n             macro_names: FxHashSet(),\n             global_macros: FxHashMap(),\n+            all_macros: FxHashMap(),\n             lexical_macro_resolutions: Vec::new(),\n             macro_map: FxHashMap(),\n             macro_exports: Vec::new(),"}, {"sha": "080ef3252a633098a5530f26471806421fce9532", "filename": "src/librustc_resolve/macros.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/00ce770e348a4d00985b8872fc4874480115f621/src%2Flibrustc_resolve%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00ce770e348a4d00985b8872fc4874480115f621/src%2Flibrustc_resolve%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Fmacros.rs?ref=00ce770e348a4d00985b8872fc4874480115f621", "patch": "@@ -755,8 +755,9 @@ impl<'a> Resolver<'a> {\n             *legacy_scope = LegacyScope::Binding(self.arenas.alloc_legacy_binding(LegacyBinding {\n                 parent: Cell::new(*legacy_scope), ident: ident, def_id: def_id, span: item.span,\n             }));\n+            let def = Def::Macro(def_id, MacroKind::Bang);\n+            self.all_macros.insert(ident.name, def);\n             if attr::contains_name(&item.attrs, \"macro_export\") {\n-                let def = Def::Macro(def_id, MacroKind::Bang);\n                 self.macro_exports.push(Export {\n                     ident: ident.modern(),\n                     def: def,"}, {"sha": "5031dddfdf38fd0b9534d28856d5a4b55f76a93d", "filename": "src/librustdoc/clean/mod.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/00ce770e348a4d00985b8872fc4874480115f621/src%2Flibrustdoc%2Fclean%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00ce770e348a4d00985b8872fc4874480115f621/src%2Flibrustdoc%2Fclean%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Fmod.rs?ref=00ce770e348a4d00985b8872fc4874480115f621", "patch": "@@ -940,6 +940,8 @@ impl Clean<Attributes> for [ast::Attribute] {\n                                 .resolve_macro_to_def_inner(mark, &path, MacroKind::Bang, false);\n                             if let Ok(def) = res {\n                                 def\n+                            } else if let Some(def) = resolver.all_macros.get(&path_str.into()) {\n+                                *def\n                             } else {\n                                 continue;\n                             }"}]}