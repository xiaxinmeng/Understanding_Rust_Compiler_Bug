{"sha": "abcca1c7d1136e64db2853b3c7e38a0417155b97", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFiY2NhMWM3ZDExMzZlNjRkYjI4NTNiM2M3ZTM4YTA0MTcxNTViOTc=", "commit": {"author": {"name": "blake2-ppc", "email": "blake2-ppc", "date": "2013-09-30T00:34:36Z"}, "committer": {"name": "blake2-ppc", "email": "blake2-ppc", "date": "2013-09-30T03:13:04Z"}, "message": "rustc: Convert lang_item to use an iterator", "tree": {"sha": "2cbc8291425cac0c461cb6a5db5da5232d321767", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2cbc8291425cac0c461cb6a5db5da5232d321767"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/abcca1c7d1136e64db2853b3c7e38a0417155b97", "comment_count": 9, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/abcca1c7d1136e64db2853b3c7e38a0417155b97", "html_url": "https://github.com/rust-lang/rust/commit/abcca1c7d1136e64db2853b3c7e38a0417155b97", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/abcca1c7d1136e64db2853b3c7e38a0417155b97/comments", "author": null, "committer": null, "parents": [{"sha": "8e69c05b7c31b213c98f1682e65018ba112d5579", "url": "https://api.github.com/repos/rust-lang/rust/commits/8e69c05b7c31b213c98f1682e65018ba112d5579", "html_url": "https://github.com/rust-lang/rust/commit/8e69c05b7c31b213c98f1682e65018ba112d5579"}], "stats": {"total": 11, "additions": 6, "deletions": 5}, "files": [{"sha": "f84d9764714c47e066ed32dfcccbaca0486b62b4", "filename": "src/librustc/metadata/encoder.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/abcca1c7d1136e64db2853b3c7e38a0417155b97/src%2Flibrustc%2Fmetadata%2Fencoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/abcca1c7d1136e64db2853b3c7e38a0417155b97/src%2Flibrustc%2Fmetadata%2Fencoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmetadata%2Fencoder.rs?ref=abcca1c7d1136e64db2853b3c7e38a0417155b97", "patch": "@@ -1574,7 +1574,7 @@ fn encode_crate_deps(ecx: &EncodeContext,\n fn encode_lang_items(ecx: &EncodeContext, ebml_w: &mut writer::Encoder) {\n     ebml_w.start_tag(tag_lang_items);\n \n-    do ecx.tcx.lang_items.each_item |def_id, i| {\n+    for (i, def_id) in ecx.tcx.lang_items.items() {\n         for id in def_id.iter() {\n             if id.crate == LOCAL_CRATE {\n                 ebml_w.start_tag(tag_lang_items_item);\n@@ -1590,8 +1590,7 @@ fn encode_lang_items(ecx: &EncodeContext, ebml_w: &mut writer::Encoder) {\n                 ebml_w.end_tag();   // tag_lang_items_item\n             }\n         }\n-        true\n-    };\n+    }\n \n     ebml_w.end_tag();   // tag_lang_items\n }"}, {"sha": "92c619eba0ecdb101887c154373c7f141193d4b1", "filename": "src/librustc/middle/lang_items.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/abcca1c7d1136e64db2853b3c7e38a0417155b97/src%2Flibrustc%2Fmiddle%2Flang_items.rs", "raw_url": "https://github.com/rust-lang/rust/raw/abcca1c7d1136e64db2853b3c7e38a0417155b97/src%2Flibrustc%2Fmiddle%2Flang_items.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Flang_items.rs?ref=abcca1c7d1136e64db2853b3c7e38a0417155b97", "patch": "@@ -32,6 +32,8 @@ use syntax::visit;\n use syntax::visit::Visitor;\n \n use std::hashmap::HashMap;\n+use std::iter::Enumerate;\n+use std::vec;\n \n pub enum LangItem {\n     FreezeTraitLangItem,               // 0\n@@ -92,8 +94,8 @@ impl LanguageItems {\n         }\n     }\n \n-    pub fn each_item(&self, f: &fn(Option<DefId>, uint) -> bool) -> bool {\n-        self.items.iter().enumerate().advance(|(i, &item)| f(item, i))\n+    pub fn items<'a>(&'a self) -> Enumerate<vec::VecIterator<'a, Option<DefId>>> {\n+        self.items.iter().enumerate()\n     }\n \n     pub fn item_name(index: uint) -> &'static str {"}]}