{"sha": "e46aab5816e32316c33962939aa6e2bbcebd4c8c", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU0NmFhYjU4MTZlMzIzMTZjMzM5NjI5MzlhYTZlMmJiY2ViZDRjOGM=", "commit": {"author": {"name": "hyd-dev", "email": "yd-huang@outlook.com", "date": "2021-06-11T07:47:12Z"}, "committer": {"name": "hyd-dev", "email": "yd-huang@outlook.com", "date": "2021-06-11T07:47:12Z"}, "message": "Use `check_shim()` for `abort`", "tree": {"sha": "490eca90b8fc00f4aae489b76eac8bf62d0843ee", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/490eca90b8fc00f4aae489b76eac8bf62d0843ee"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e46aab5816e32316c33962939aa6e2bbcebd4c8c", "comment_count": 0, "verification": {"verified": false, "reason": "no_user", "signature": "-----BEGIN PGP SIGNATURE-----\n\niIsEABYIADMWIQRJ2jPMDdiQ+U4U42Z0+n/VuNoUuAUCYMMVABUceWQtaHVhbmdA\nb3V0bG9vay5jb20ACgkQdPp/1bjaFLgVjwEAt3nCiEVwe0QVOti9F3WWkrfuukCA\nP/U+w4X1tGDNMeEA/2KhrbLmR1G2c6T+kRMIdRkSEmxZGYTtY5HG0qSAK14B\n=siVG\n-----END PGP SIGNATURE-----", "payload": "tree 490eca90b8fc00f4aae489b76eac8bf62d0843ee\nparent c822ec59aa817a5018b8058cc66c98e6effb7e9c\nauthor hyd-dev <yd-huang@outlook.com> 1623397632 +0800\ncommitter hyd-dev <yd-huang@outlook.com> 1623397632 +0800\n\nUse `check_shim()` for `abort`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e46aab5816e32316c33962939aa6e2bbcebd4c8c", "html_url": "https://github.com/rust-lang/rust/commit/e46aab5816e32316c33962939aa6e2bbcebd4c8c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e46aab5816e32316c33962939aa6e2bbcebd4c8c/comments", "author": null, "committer": null, "parents": [{"sha": "c822ec59aa817a5018b8058cc66c98e6effb7e9c", "url": "https://api.github.com/repos/rust-lang/rust/commits/c822ec59aa817a5018b8058cc66c98e6effb7e9c", "html_url": "https://github.com/rust-lang/rust/commit/c822ec59aa817a5018b8058cc66c98e6effb7e9c"}], "stats": {"total": 17, "additions": 12, "deletions": 5}, "files": [{"sha": "23824305c980da9e102df0811e6351e980f8819e", "filename": "src/shims/foreign_items.rs", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/e46aab5816e32316c33962939aa6e2bbcebd4c8c/src%2Fshims%2Fforeign_items.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e46aab5816e32316c33962939aa6e2bbcebd4c8c/src%2Fshims%2Fforeign_items.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Fforeign_items.rs?ref=e46aab5816e32316c33962939aa6e2bbcebd4c8c", "patch": "@@ -244,11 +244,8 @@ pub trait EvalContextExt<'mir, 'tcx: 'mir>: crate::MiriEvalContextExt<'mir, 'tcx\n                     throw_machine_stop!(TerminationInfo::Exit(code.into()));\n                 }\n                 \"abort\" => {\n-                    this.check_abi_and_shim_symbol_clash(\n-                        abi,\n-                        Abi::C { unwind: false },\n-                        link_name_sym,\n-                    )?;\n+                    let &[] =\n+                        this.check_shim(abi, Abi::C { unwind: false }, link_name_sym, args)?;\n                     throw_machine_stop!(TerminationInfo::Abort(\n                         \"the program aborted execution\".to_owned()\n                     ))"}, {"sha": "85e1b9deeb36f548b0e93508e8a5b5b9d82eddac", "filename": "tests/compile-fail/function_calls/check_arg_count_abort.rs", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/e46aab5816e32316c33962939aa6e2bbcebd4c8c/tests%2Fcompile-fail%2Ffunction_calls%2Fcheck_arg_count_abort.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e46aab5816e32316c33962939aa6e2bbcebd4c8c/tests%2Fcompile-fail%2Ffunction_calls%2Fcheck_arg_count_abort.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Ffunction_calls%2Fcheck_arg_count_abort.rs?ref=e46aab5816e32316c33962939aa6e2bbcebd4c8c", "patch": "@@ -0,0 +1,10 @@\n+fn main() {\n+    extern \"C\" {\n+        fn abort(_: i32) -> !;\n+    }\n+\n+    unsafe {\n+        abort(1);\n+        //~^ ERROR Undefined Behavior: incorrect number of arguments: got 1, expected 0\n+    }\n+}"}]}