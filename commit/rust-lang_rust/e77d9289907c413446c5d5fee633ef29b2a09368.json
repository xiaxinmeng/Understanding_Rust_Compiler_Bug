{"sha": "e77d9289907c413446c5d5fee633ef29b2a09368", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU3N2Q5Mjg5OTA3YzQxMzQ0NmM1ZDVmZWU2MzNlZjI5YjJhMDkzNjg=", "commit": {"author": {"name": "Mark-Simulacrum", "email": "mark.simulacrum@gmail.com", "date": "2016-12-11T17:29:44Z"}, "committer": {"name": "Mark Simulacrum", "email": "mark.simulacrum@gmail.com", "date": "2016-12-21T03:01:40Z"}, "message": "Add notes regarding malloc_raw_dyn being unwind incompatible", "tree": {"sha": "1f63c50c686061ede7ebd94018437b115db3ba67", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1f63c50c686061ede7ebd94018437b115db3ba67"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e77d9289907c413446c5d5fee633ef29b2a09368", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e77d9289907c413446c5d5fee633ef29b2a09368", "html_url": "https://github.com/rust-lang/rust/commit/e77d9289907c413446c5d5fee633ef29b2a09368", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e77d9289907c413446c5d5fee633ef29b2a09368/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "59ef51c12a27ab17606eb7a1c1da58e9ec0c09ad", "url": "https://api.github.com/repos/rust-lang/rust/commits/59ef51c12a27ab17606eb7a1c1da58e9ec0c09ad", "html_url": "https://github.com/rust-lang/rust/commit/59ef51c12a27ab17606eb7a1c1da58e9ec0c09ad"}], "stats": {"total": 8, "additions": 5, "deletions": 3}, "files": [{"sha": "3bc39fad7f1b5f2b276f14288ed690f3d71eb181", "filename": "src/librustc/middle/lang_items.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e77d9289907c413446c5d5fee633ef29b2a09368/src%2Flibrustc%2Fmiddle%2Flang_items.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e77d9289907c413446c5d5fee633ef29b2a09368/src%2Flibrustc%2Fmiddle%2Flang_items.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Flang_items.rs?ref=e77d9289907c413446c5d5fee633ef29b2a09368", "patch": "@@ -327,6 +327,8 @@ language_item_table! {\n     PanicBoundsCheckFnLangItem,      \"panic_bounds_check\",      panic_bounds_check_fn;\n     PanicFmtLangItem,                \"panic_fmt\",               panic_fmt;\n \n+    // ExchangeMallocFnLangItem cannot unwind, or MIR trans will break. See note\n+    // on `malloc_raw_dyn` in librustc_trans/base.rs.\n     ExchangeMallocFnLangItem,        \"exchange_malloc\",         exchange_malloc_fn;\n     ExchangeFreeFnLangItem,          \"exchange_free\",           exchange_free_fn;\n     BoxFreeFnLangItem,               \"box_free\",                box_free_fn;"}, {"sha": "df6b563d9fefa1bf637a59c71a162c18dd452a12", "filename": "src/librustc_trans/base.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/e77d9289907c413446c5d5fee633ef29b2a09368/src%2Flibrustc_trans%2Fbase.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e77d9289907c413446c5d5fee633ef29b2a09368/src%2Flibrustc_trans%2Fbase.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fbase.rs?ref=e77d9289907c413446c5d5fee633ef29b2a09368", "patch": "@@ -199,9 +199,9 @@ fn require_alloc_fn<'blk, 'tcx>(\n     }\n }\n \n-// The following malloc_raw_dyn* functions allocate a box to contain\n-// a given type, but with a potentially dynamic size.\n-\n+// malloc_raw_dyn allocates a box to contain a given type, but with a potentially dynamic size.\n+//\n+// MIR requires that ExchangeMallocFnLangItem cannot unwind.\n pub fn malloc_raw_dyn<'blk, 'tcx>(bcx: &BlockAndBuilder<'blk, 'tcx>,\n                                   llty_ptr: Type,\n                                   info_ty: Ty<'tcx>,"}]}