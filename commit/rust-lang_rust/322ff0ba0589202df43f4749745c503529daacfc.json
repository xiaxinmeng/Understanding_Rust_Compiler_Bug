{"sha": "322ff0ba0589202df43f4749745c503529daacfc", "node_id": "C_kwDOAAsO6NoAKDMyMmZmMGJhMDU4OTIwMmRmNDNmNDc0OTc0NWM1MDM1MjlkYWFjZmM", "commit": {"author": {"name": "bjorn3", "email": "17426603+bjorn3@users.noreply.github.com", "date": "2022-09-25T14:05:01Z"}, "committer": {"name": "bjorn3", "email": "17426603+bjorn3@users.noreply.github.com", "date": "2022-09-25T14:05:01Z"}, "message": "Work around rustbuild bug", "tree": {"sha": "5c42193f0da9e08a3ca8e8a470116f9975ff5ead", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5c42193f0da9e08a3ca8e8a470116f9975ff5ead"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/322ff0ba0589202df43f4749745c503529daacfc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/322ff0ba0589202df43f4749745c503529daacfc", "html_url": "https://github.com/rust-lang/rust/commit/322ff0ba0589202df43f4749745c503529daacfc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/322ff0ba0589202df43f4749745c503529daacfc/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "94d52158c6ac7b1ce0350a334b28c9e3ccf00060", "url": "https://api.github.com/repos/rust-lang/rust/commits/94d52158c6ac7b1ce0350a334b28c9e3ccf00060", "html_url": "https://github.com/rust-lang/rust/commit/94d52158c6ac7b1ce0350a334b28c9e3ccf00060"}], "stats": {"total": 15, "additions": 15, "deletions": 0}, "files": [{"sha": "25103a2fd503622b916c164bd06518d09258356f", "filename": "scripts/setup_rust_fork.sh", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/322ff0ba0589202df43f4749745c503529daacfc/scripts%2Fsetup_rust_fork.sh", "raw_url": "https://github.com/rust-lang/rust/raw/322ff0ba0589202df43f4749745c503529daacfc/scripts%2Fsetup_rust_fork.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/scripts%2Fsetup_rust_fork.sh?ref=322ff0ba0589202df43f4749745c503529daacfc", "patch": "@@ -27,6 +27,21 @@ index d95b5b7f17f..00b6f0e3635 100644\n  [dev-dependencies]\n  rand = \"0.7\"\n  rand_xorshift = \"0.2\"\n+diff --git a/src/bootstrap/config.rs b/src/bootstrap/config.rs\n+index a6333976f2a..c9a872e876c 100644\n+--- a/src/bootstrap/config.rs\n++++ b/src/bootstrap/config.rs\n+@@ -917,6 +917,10 @@ pub fn parse(args: &[String]) -> Config {\n+             config.initial_cargo = config.out.join(config.build.triple).join(\"stage0/bin/cargo\");\n+         }\n+\n++        // Workaround for rustbuild bug\n++        config.initial_rustc = PathBuf::from(\"$(pwd)/../build/rustc-clif\");\n++        config.initial_cargo = PathBuf::from(\"$(rustup which cargo)\");\n++\n+         // NOTE: it's important this comes *after* we set \\`initial_rustc\\` just above.\n+         if config.dry_run {\n+             let dir = config.out.join(\"tmp-dry-run\");\n diff --git a/src/tools/compiletest/src/runtest.rs b/src/tools/compiletest/src/runtest.rs\n index 8431aa7b818..a3ff7e68ce5 100644\n --- a/src/tools/compiletest/src/runtest.rs"}]}