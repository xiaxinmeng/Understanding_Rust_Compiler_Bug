{"sha": "c8df0171e84deb4563f30f9f1c3cf61e859315fb", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM4ZGYwMTcxZTg0ZGViNDU2M2YzMGY5ZjFjM2NmNjFlODU5MzE1ZmI=", "commit": {"author": {"name": "Christian Poveda", "email": "christianpoveda@protonmail.com", "date": "2019-10-11T06:53:31Z"}, "committer": {"name": "Christian Poveda", "email": "christianpoveda@protonmail.com", "date": "2019-10-11T06:53:31Z"}, "message": "Move functions to eval libc constants to helpers", "tree": {"sha": "bbba7fadddf4930a84b6b88f7ebfd15e245eb2f4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bbba7fadddf4930a84b6b88f7ebfd15e245eb2f4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c8df0171e84deb4563f30f9f1c3cf61e859315fb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c8df0171e84deb4563f30f9f1c3cf61e859315fb", "html_url": "https://github.com/rust-lang/rust/commit/c8df0171e84deb4563f30f9f1c3cf61e859315fb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c8df0171e84deb4563f30f9f1c3cf61e859315fb/comments", "author": {"login": "pvdrz", "id": 31802960, "node_id": "MDQ6VXNlcjMxODAyOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/31802960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pvdrz", "html_url": "https://github.com/pvdrz", "followers_url": "https://api.github.com/users/pvdrz/followers", "following_url": "https://api.github.com/users/pvdrz/following{/other_user}", "gists_url": "https://api.github.com/users/pvdrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/pvdrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pvdrz/subscriptions", "organizations_url": "https://api.github.com/users/pvdrz/orgs", "repos_url": "https://api.github.com/users/pvdrz/repos", "events_url": "https://api.github.com/users/pvdrz/events{/privacy}", "received_events_url": "https://api.github.com/users/pvdrz/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pvdrz", "id": 31802960, "node_id": "MDQ6VXNlcjMxODAyOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/31802960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pvdrz", "html_url": "https://github.com/pvdrz", "followers_url": "https://api.github.com/users/pvdrz/followers", "following_url": "https://api.github.com/users/pvdrz/following{/other_user}", "gists_url": "https://api.github.com/users/pvdrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/pvdrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pvdrz/subscriptions", "organizations_url": "https://api.github.com/users/pvdrz/orgs", "repos_url": "https://api.github.com/users/pvdrz/repos", "events_url": "https://api.github.com/users/pvdrz/events{/privacy}", "received_events_url": "https://api.github.com/users/pvdrz/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "976c976f0948ebfb080f51c733c5bbe24c366554", "url": "https://api.github.com/repos/rust-lang/rust/commits/976c976f0948ebfb080f51c733c5bbe24c366554", "html_url": "https://github.com/rust-lang/rust/commit/976c976f0948ebfb080f51c733c5bbe24c366554"}], "stats": {"total": 22, "additions": 11, "deletions": 11}, "files": [{"sha": "39c7af94e0ae7227b385134b7090377ffbc91994", "filename": "src/helpers.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/c8df0171e84deb4563f30f9f1c3cf61e859315fb/src%2Fhelpers.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c8df0171e84deb4563f30f9f1c3cf61e859315fb/src%2Fhelpers.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fhelpers.rs?ref=c8df0171e84deb4563f30f9f1c3cf61e859315fb", "patch": "@@ -291,4 +291,15 @@ pub trait EvalContextExt<'mir, 'tcx: 'mir>: crate::MiriEvalContextExt<'mir, 'tcx\n             }\n         }\n     }\n+    /// Helper function to get a `libc` constant as a `Scalar`.\n+    fn eval_libc(&mut self, name: &str) -> InterpResult<'tcx, Scalar<Tag>> {\n+        self.eval_context_mut()\n+            .eval_path_scalar(&[\"libc\", name])?\n+            .ok_or_else(|| err_unsup_format!(\"Path libc::{} cannot be resolved.\", name).into())\n+            .and_then(|scalar| scalar.not_undef())\n+    }\n+    /// Helper function to get a `libc` constant as an `i32`.\n+    fn eval_libc_i32(&mut self, name: &str) -> InterpResult<'tcx, i32> {\n+        self.eval_libc(name).and_then(|scalar| scalar.to_i32())\n+    }\n }"}, {"sha": "00160156312a8dfa06ef7c6726287874222d050a", "filename": "src/shims/foreign_items.rs", "status": "modified", "additions": 0, "deletions": 11, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/c8df0171e84deb4563f30f9f1c3cf61e859315fb/src%2Fshims%2Fforeign_items.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c8df0171e84deb4563f30f9f1c3cf61e859315fb/src%2Fshims%2Fforeign_items.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Fforeign_items.rs?ref=c8df0171e84deb4563f30f9f1c3cf61e859315fb", "patch": "@@ -981,17 +981,6 @@ pub trait EvalContextExt<'mir, 'tcx: 'mir>: crate::MiriEvalContextExt<'mir, 'tcx\n         return Ok(None);\n     }\n \n-    fn eval_libc(&mut self, name: &str) -> InterpResult<'tcx, Scalar<Tag>> {\n-        self.eval_context_mut()\n-            .eval_path_scalar(&[\"libc\", name])?\n-            .ok_or_else(|| err_unsup_format!(\"Path libc::{} cannot be resolved.\", name).into())\n-            .and_then(|scalar| scalar.not_undef())\n-    }\n-\n-    fn eval_libc_i32(&mut self, name: &str) -> InterpResult<'tcx, i32> {\n-        self.eval_libc(name).and_then(|scalar| scalar.to_i32())\n-    }\n-\n     fn set_last_error(&mut self, scalar: Scalar<Tag>) -> InterpResult<'tcx> {\n         let this = self.eval_context_mut();\n         let tcx = &{ this.tcx.tcx };"}]}