{"sha": "fae40c507068b2d7aa5dc7bda729762e536aa8c2", "node_id": "C_kwDOAAsO6NoAKGZhZTQwYzUwNzA2OGIyZDdhYTVkYzdiZGE3Mjk3NjJlNTM2YWE4YzI", "commit": {"author": {"name": "Lucas Kent", "email": "rubickent@gmail.com", "date": "2021-12-12T02:04:00Z"}, "committer": {"name": "Lucas Kent", "email": "rubickent@gmail.com", "date": "2021-12-13T13:04:15Z"}, "message": "Suggest to specify a target triple when eh_personality lang item is missing", "tree": {"sha": "78562195a27fca1282342d96a9cc7a40503d5735", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/78562195a27fca1282342d96a9cc7a40503d5735"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fae40c507068b2d7aa5dc7bda729762e536aa8c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fae40c507068b2d7aa5dc7bda729762e536aa8c2", "html_url": "https://github.com/rust-lang/rust/commit/fae40c507068b2d7aa5dc7bda729762e536aa8c2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fae40c507068b2d7aa5dc7bda729762e536aa8c2/comments", "author": {"login": "rukai", "id": 5120858, "node_id": "MDQ6VXNlcjUxMjA4NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/5120858?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rukai", "html_url": "https://github.com/rukai", "followers_url": "https://api.github.com/users/rukai/followers", "following_url": "https://api.github.com/users/rukai/following{/other_user}", "gists_url": "https://api.github.com/users/rukai/gists{/gist_id}", "starred_url": "https://api.github.com/users/rukai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rukai/subscriptions", "organizations_url": "https://api.github.com/users/rukai/orgs", "repos_url": "https://api.github.com/users/rukai/repos", "events_url": "https://api.github.com/users/rukai/events{/privacy}", "received_events_url": "https://api.github.com/users/rukai/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rukai", "id": 5120858, "node_id": "MDQ6VXNlcjUxMjA4NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/5120858?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rukai", "html_url": "https://github.com/rukai", "followers_url": "https://api.github.com/users/rukai/followers", "following_url": "https://api.github.com/users/rukai/following{/other_user}", "gists_url": "https://api.github.com/users/rukai/gists{/gist_id}", "starred_url": "https://api.github.com/users/rukai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rukai/subscriptions", "organizations_url": "https://api.github.com/users/rukai/orgs", "repos_url": "https://api.github.com/users/rukai/repos", "events_url": "https://api.github.com/users/rukai/events{/privacy}", "received_events_url": "https://api.github.com/users/rukai/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6d6d0899c8bf9d321ffa12426ca7ae7e3e15478a", "url": "https://api.github.com/repos/rust-lang/rust/commits/6d6d0899c8bf9d321ffa12426ca7ae7e3e15478a", "html_url": "https://github.com/rust-lang/rust/commit/6d6d0899c8bf9d321ffa12426ca7ae7e3e15478a"}], "stats": {"total": 18, "additions": 15, "deletions": 3}, "files": [{"sha": "61c82f031dd5b055ae639ca5570afdaa0da79e71", "filename": "compiler/rustc_passes/src/weak_lang_items.rs", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/fae40c507068b2d7aa5dc7bda729762e536aa8c2/compiler%2Frustc_passes%2Fsrc%2Fweak_lang_items.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fae40c507068b2d7aa5dc7bda729762e536aa8c2/compiler%2Frustc_passes%2Fsrc%2Fweak_lang_items.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Fweak_lang_items.rs?ref=fae40c507068b2d7aa5dc7bda729762e536aa8c2", "patch": "@@ -67,10 +67,16 @@ fn verify<'tcx>(tcx: TyCtxt<'tcx>, items: &lang_items::LanguageItems) {\n             } else if item == LangItem::Oom {\n                 if !tcx.features().default_alloc_error_handler {\n                     tcx.sess.err(\"`#[alloc_error_handler]` function required, but not found\");\n-                    tcx.sess.note_without_error(\"Use `#![feature(default_alloc_error_handler)]` for a default error handler\");\n+                    tcx.sess.note_without_error(\"use `#![feature(default_alloc_error_handler)]` for a default error handler\");\n                 }\n             } else {\n-                tcx.sess.err(&format!(\"language item required, but not found: `{}`\", name));\n+                tcx\n+                    .sess\n+                    .diagnostic()\n+                    .struct_err(&format!(\"language item required, but not found: `{}`\", name))\n+                    .note(&format!(\"this can occur when a binary crate with `#![no_std]` is compiled for a target where `{}` is defined in the standard library\", name))\n+                    .help(&format!(\"you may be able to compile for a target that doesn't need `{}`, specify a target with `--target` or in `.cargo/config`\", name))\n+                    .emit();\n             }\n         }\n     }"}, {"sha": "39a66c08de0981ba517eef27a72e0f4cc1514d3b", "filename": "src/test/ui/extern-flag/empty-extern-arg.stderr", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/fae40c507068b2d7aa5dc7bda729762e536aa8c2/src%2Ftest%2Fui%2Fextern-flag%2Fempty-extern-arg.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fae40c507068b2d7aa5dc7bda729762e536aa8c2/src%2Ftest%2Fui%2Fextern-flag%2Fempty-extern-arg.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern-flag%2Fempty-extern-arg.stderr?ref=fae40c507068b2d7aa5dc7bda729762e536aa8c2", "patch": "@@ -1,6 +1,9 @@\n error: extern location for std does not exist: \n \n error: language item required, but not found: `eh_personality`\n+   |\n+   = note: this can occur when a binary crate with `#![no_std]` is compiled for a target where `eh_personality` is defined in the standard library\n+   = help: you may be able to compile for a target that doesn't need `eh_personality`, specify a target with `--target` or in `.cargo/config`\n \n error: `#[panic_handler]` function required, but not found\n "}, {"sha": "995fa7cf85e965761f4748d51f19f235c6ad92dd", "filename": "src/test/ui/missing/missing-alloc_error_handler.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fae40c507068b2d7aa5dc7bda729762e536aa8c2/src%2Ftest%2Fui%2Fmissing%2Fmissing-alloc_error_handler.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fae40c507068b2d7aa5dc7bda729762e536aa8c2/src%2Ftest%2Fui%2Fmissing%2Fmissing-alloc_error_handler.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmissing%2Fmissing-alloc_error_handler.stderr?ref=fae40c507068b2d7aa5dc7bda729762e536aa8c2", "patch": "@@ -1,6 +1,6 @@\n error: `#[alloc_error_handler]` function required, but not found\n \n-note: Use `#![feature(default_alloc_error_handler)]` for a default error handler\n+note: use `#![feature(default_alloc_error_handler)]` for a default error handler\n \n error: aborting due to previous error\n "}, {"sha": "cc25f08e33a80daee3add086ccdf6562078abb58", "filename": "src/test/ui/panic-handler/weak-lang-item.stderr", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/fae40c507068b2d7aa5dc7bda729762e536aa8c2/src%2Ftest%2Fui%2Fpanic-handler%2Fweak-lang-item.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fae40c507068b2d7aa5dc7bda729762e536aa8c2/src%2Ftest%2Fui%2Fpanic-handler%2Fweak-lang-item.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpanic-handler%2Fweak-lang-item.stderr?ref=fae40c507068b2d7aa5dc7bda729762e536aa8c2", "patch": "@@ -11,6 +11,9 @@ LL | extern crate core as other_core;\n    |\n \n error: language item required, but not found: `eh_personality`\n+   |\n+   = note: this can occur when a binary crate with `#![no_std]` is compiled for a target where `eh_personality` is defined in the standard library\n+   = help: you may be able to compile for a target that doesn't need `eh_personality`, specify a target with `--target` or in `.cargo/config`\n \n error: `#[panic_handler]` function required, but not found\n "}]}