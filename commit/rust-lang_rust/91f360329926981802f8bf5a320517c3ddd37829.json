{"sha": "91f360329926981802f8bf5a320517c3ddd37829", "node_id": "C_kwDOAAsO6NoAKDkxZjM2MDMyOTkyNjk4MTgwMmY4YmY1YTMyMDUxN2MzZGRkMzc4Mjk", "commit": {"author": {"name": "Esteban Kuber", "email": "esteban@kuber.com.ar", "date": "2022-01-21T00:15:39Z"}, "committer": {"name": "Esteban Kuber", "email": "esteban@kuber.com.ar", "date": "2022-03-05T02:42:55Z"}, "message": "Do not point at whole file missing `fn main`\n\nOnly point at the end of the crate. We could try making it point at the\nbeginning of the crate, but that is confused with `DUMMY_SP`, causing\nthe output to be *worse*.\n\nThis change will make it so that VSCode will *not* underline the whole\nfile when `main` is missing, so other errors will be visible.", "tree": {"sha": "d54e059b902be1bfcb98537cc09e27e8ca3958c4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d54e059b902be1bfcb98537cc09e27e8ca3958c4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/91f360329926981802f8bf5a320517c3ddd37829", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/91f360329926981802f8bf5a320517c3ddd37829", "html_url": "https://github.com/rust-lang/rust/commit/91f360329926981802f8bf5a320517c3ddd37829", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/91f360329926981802f8bf5a320517c3ddd37829/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "32cbc7630b2d6b7141e2588f91380c1a58cf0016", "url": "https://api.github.com/repos/rust-lang/rust/commits/32cbc7630b2d6b7141e2588f91380c1a58cf0016", "html_url": "https://github.com/rust-lang/rust/commit/32cbc7630b2d6b7141e2588f91380c1a58cf0016"}], "stats": {"total": 157, "additions": 54, "deletions": 103}, "files": [{"sha": "f5040a373c29637b1c72a243762b73ce58a76993", "filename": "compiler/rustc_passes/src/entry.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/compiler%2Frustc_passes%2Fsrc%2Fentry.rs", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/compiler%2Frustc_passes%2Fsrc%2Fentry.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Fentry.rs?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -218,9 +218,9 @@ fn no_main_err(tcx: TyCtxt<'_>, visitor: &EntryContext<'_, '_>) {\n     // The file may be empty, which leads to the diagnostic machinery not emitting this\n     // note. This is a relatively simple way to detect that case and emit a span-less\n     // note instead.\n-    if tcx.sess.source_map().lookup_line(sp.lo()).is_ok() {\n-        err.set_span(sp);\n-        err.span_label(sp, &note);\n+    if tcx.sess.source_map().lookup_line(sp.hi()).is_ok() {\n+        err.set_span(sp.shrink_to_hi());\n+        err.span_label(sp.shrink_to_hi(), &note);\n     } else {\n         err.note(&note);\n     }"}, {"sha": "0f62d4153089a6c6a478ee032f04b5d861f87014", "filename": "src/test/ui/attributes/issue-90873.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fattributes%2Fissue-90873.rs", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fattributes%2Fissue-90873.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fattributes%2Fissue-90873.rs?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,9 +1,9 @@\n #![u=||{static d=||1;}]\n //~^ unexpected token\n //~| cannot find attribute `u` in this scope\n-//~| `main` function not found in crate `issue_90873`\n //~| missing type for `static` item\n \n #![a={impl std::ops::Neg for i8 {}}]\n //~^ ERROR unexpected token\n //~| ERROR cannot find attribute `a` in this scope\n+//~| ERROR `main` function not found in crate `issue_90873`"}, {"sha": "fbdc05ef6f0044b1b2f2799961922792ea58b2b0", "filename": "src/test/ui/attributes/issue-90873.stderr", "status": "modified", "additions": 5, "deletions": 11, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fattributes%2Fissue-90873.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fattributes%2Fissue-90873.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fattributes%2Fissue-90873.stderr?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -10,7 +10,7 @@ LL | #![u=||{static d=||1;}]\n error: unexpected token: `{\n            impl std::ops::Neg for i8 {}\n        }`\n-  --> $DIR/issue-90873.rs:7:6\n+  --> $DIR/issue-90873.rs:6:6\n    |\n LL | #![a={impl std::ops::Neg for i8 {}}]\n    |      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n@@ -22,22 +22,16 @@ LL | #![u=||{static d=||1;}]\n    |    ^\n \n error: cannot find attribute `a` in this scope\n-  --> $DIR/issue-90873.rs:7:4\n+  --> $DIR/issue-90873.rs:6:4\n    |\n LL | #![a={impl std::ops::Neg for i8 {}}]\n    |    ^\n \n error[E0601]: `main` function not found in crate `issue_90873`\n-  --> $DIR/issue-90873.rs:1:1\n+  --> $DIR/issue-90873.rs:6:37\n    |\n-LL | / #![u=||{static d=||1;}]\n-LL | |\n-LL | |\n-LL | |\n-LL | |\n-LL | |\n-LL | | #![a={impl std::ops::Neg for i8 {}}]\n-   | |____________________________________^ consider adding a `main` function to `$DIR/issue-90873.rs`\n+LL | #![a={impl std::ops::Neg for i8 {}}]\n+   |                                     ^ consider adding a `main` function to `$DIR/issue-90873.rs`\n \n error: missing type for `static` item\n   --> $DIR/issue-90873.rs:1:16"}, {"sha": "d61872c48ea96c2187e943f4956500123c019c09", "filename": "src/test/ui/conditional-compilation/cfg-attr-cfg-2.stderr", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fconditional-compilation%2Fcfg-attr-cfg-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fconditional-compilation%2Fcfg-attr-cfg-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconditional-compilation%2Fcfg-attr-cfg-2.stderr?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,9 +1,8 @@\n error[E0601]: `main` function not found in crate `cfg_attr_cfg_2`\n-  --> $DIR/cfg-attr-cfg-2.rs:8:1\n+  --> $DIR/cfg-attr-cfg-2.rs:9:14\n    |\n-LL | / #[cfg_attr(foo, cfg(bar))]\n-LL | | fn main() { }\n-   | |_____________^ consider adding a `main` function to `$DIR/cfg-attr-cfg-2.rs`\n+LL | fn main() { }\n+   |              ^ consider adding a `main` function to `$DIR/cfg-attr-cfg-2.rs`\n \n error: aborting due to previous error\n "}, {"sha": "ff72c43efbd086f343d8a41396f6a93c654066ea", "filename": "src/test/ui/conditional-compilation/cfg-in-crate-1.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fconditional-compilation%2Fcfg-in-crate-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fconditional-compilation%2Fcfg-in-crate-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconditional-compilation%2Fcfg-in-crate-1.stderr?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,8 +1,8 @@\n error[E0601]: `main` function not found in crate `cfg_in_crate_1`\n-  --> $DIR/cfg-in-crate-1.rs:3:1\n+  --> $DIR/cfg-in-crate-1.rs:3:13\n    |\n LL | #![cfg(bar)]\n-   | ^^^^^^^^^^^^ consider adding a `main` function to `$DIR/cfg-in-crate-1.rs`\n+   |             ^ consider adding a `main` function to `$DIR/cfg-in-crate-1.rs`\n \n error: aborting due to previous error\n "}, {"sha": "ebebabe349b85a509ce23d641bc6948a7fb18b6e", "filename": "src/test/ui/continue-after-missing-main.nll.stderr", "status": "modified", "additions": 3, "deletions": 9, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fcontinue-after-missing-main.nll.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fcontinue-after-missing-main.nll.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcontinue-after-missing-main.nll.stderr?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,14 +1,8 @@\n error[E0601]: `main` function not found in crate `continue_after_missing_main`\n-  --> $DIR/continue-after-missing-main.rs:1:1\n+  --> $DIR/continue-after-missing-main.rs:30:2\n    |\n-LL | / #![allow(dead_code)]\n-LL | |\n-LL | | struct Tableau<'a, MP> {\n-LL | |     provider: &'a MP,\n-...  |\n-LL | |\n-LL | | }\n-   | |_^ consider adding a `main` function to `$DIR/continue-after-missing-main.rs`\n+LL | }\n+   |  ^ consider adding a `main` function to `$DIR/continue-after-missing-main.rs`\n \n error: aborting due to previous error\n "}, {"sha": "1019cacce64213feb8fcfe230fe78bbc46bd5857", "filename": "src/test/ui/continue-after-missing-main.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fcontinue-after-missing-main.rs", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fcontinue-after-missing-main.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcontinue-after-missing-main.rs?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,4 +1,4 @@\n-#![allow(dead_code)] //~ ERROR `main` function not found in crate\n+#![allow(dead_code)]\n \n struct Tableau<'a, MP> {\n     provider: &'a MP,\n@@ -27,4 +27,4 @@ fn create_and_solve_subproblems<'data_provider, 'original_data, MP>(\n ) {\n     let _: AdaptedMatrixProvider<'original_data, MP> = tableau.provider().clone_with_extra_bound();\n     //~^ ERROR lifetime mismatch\n-}\n+} //~ ERROR `main` function not found in crate"}, {"sha": "29e7dc1e56c732b2da0180afb3b6afc862d01150", "filename": "src/test/ui/continue-after-missing-main.stderr", "status": "modified", "additions": 3, "deletions": 9, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fcontinue-after-missing-main.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fcontinue-after-missing-main.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcontinue-after-missing-main.stderr?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,14 +1,8 @@\n error[E0601]: `main` function not found in crate `continue_after_missing_main`\n-  --> $DIR/continue-after-missing-main.rs:1:1\n+  --> $DIR/continue-after-missing-main.rs:30:2\n    |\n-LL | / #![allow(dead_code)]\n-LL | |\n-LL | | struct Tableau<'a, MP> {\n-LL | |     provider: &'a MP,\n-...  |\n-LL | |\n-LL | | }\n-   | |_^ consider adding a `main` function to `$DIR/continue-after-missing-main.rs`\n+LL | }\n+   |  ^ consider adding a `main` function to `$DIR/continue-after-missing-main.rs`\n \n error[E0623]: lifetime mismatch\n   --> $DIR/continue-after-missing-main.rs:28:56"}, {"sha": "c74c307c492fe385fd3c8e5073083d9448ea32b9", "filename": "src/test/ui/elided-test.stderr", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Felided-test.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Felided-test.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Felided-test.stderr?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,10 +1,8 @@\n error[E0601]: `main` function not found in crate `elided_test`\n-  --> $DIR/elided-test.rs:5:1\n+  --> $DIR/elided-test.rs:7:2\n    |\n-LL | / #[test]\n-LL | | fn main() {\n-LL | | }\n-   | |_^ consider adding a `main` function to `$DIR/elided-test.rs`\n+LL | }\n+   |  ^ consider adding a `main` function to `$DIR/elided-test.rs`\n \n error: aborting due to previous error\n "}, {"sha": "dab9c687e24980b0ce3a086f7e719af3c84564c3", "filename": "src/test/ui/entry-point/imported_main_const_fn_item_type_forbidden.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fentry-point%2Fimported_main_const_fn_item_type_forbidden.rs", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fentry-point%2Fimported_main_const_fn_item_type_forbidden.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fentry-point%2Fimported_main_const_fn_item_type_forbidden.rs?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,7 +1,6 @@\n #![feature(imported_main)]\n #![feature(type_alias_impl_trait)]\n #![allow(incomplete_features)]\n-//~^^^ ERROR `main` function not found in crate\n pub mod foo {\n     type MainFn = impl Fn();\n     //~^ ERROR could not find defining uses\n@@ -11,4 +10,4 @@ pub mod foo {\n     //~^ ERROR mismatched types [E0308]\n }\n \n-use foo::BAR as main;\n+use foo::BAR as main; //~ ERROR `main` function not found in crate"}, {"sha": "b9bc0262a56b21ee006e311ae6c8225025ff880b", "filename": "src/test/ui/entry-point/imported_main_const_fn_item_type_forbidden.stderr", "status": "modified", "additions": 7, "deletions": 13, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fentry-point%2Fimported_main_const_fn_item_type_forbidden.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fentry-point%2Fimported_main_const_fn_item_type_forbidden.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fentry-point%2Fimported_main_const_fn_item_type_forbidden.stderr?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,19 +1,13 @@\n error[E0601]: `main` function not found in crate `imported_main_const_fn_item_type_forbidden`\n-  --> $DIR/imported_main_const_fn_item_type_forbidden.rs:1:1\n+  --> $DIR/imported_main_const_fn_item_type_forbidden.rs:13:22\n    |\n-LL | / #![feature(imported_main)]\n-LL | | #![feature(type_alias_impl_trait)]\n-LL | | #![allow(incomplete_features)]\n-LL | |\n-...  |\n-LL | |\n-LL | | use foo::BAR as main;\n-   | |_____----------------^ consider adding a `main` function to `$DIR/imported_main_const_fn_item_type_forbidden.rs`\n-   |       |\n-   |       non-function item at `crate::main` is found\n+LL | use foo::BAR as main;\n+   |     ---------------- ^ consider adding a `main` function to `$DIR/imported_main_const_fn_item_type_forbidden.rs`\n+   |     |\n+   |     non-function item at `crate::main` is found\n \n error[E0308]: mismatched types\n-  --> $DIR/imported_main_const_fn_item_type_forbidden.rs:10:29\n+  --> $DIR/imported_main_const_fn_item_type_forbidden.rs:9:29\n    |\n LL |     type MainFn = impl Fn();\n    |                   --------- the expected opaque type\n@@ -25,7 +19,7 @@ LL |     pub const BAR: MainFn = bar;\n                   found fn item `fn() {bar}`\n \n error: could not find defining uses\n-  --> $DIR/imported_main_const_fn_item_type_forbidden.rs:6:19\n+  --> $DIR/imported_main_const_fn_item_type_forbidden.rs:5:19\n    |\n LL |     type MainFn = impl Fn();\n    |                   ^^^^^^^^^"}, {"sha": "1508280c0fa571bf85bfbfe81679050c0753249f", "filename": "src/test/ui/entry-point/imported_main_const_forbidden.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fentry-point%2Fimported_main_const_forbidden.rs", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fentry-point%2Fimported_main_const_forbidden.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fentry-point%2Fimported_main_const_forbidden.rs?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,7 +1,6 @@\n #![feature(imported_main)]\n-//~^ ERROR `main` function not found in crate\n pub mod foo {\n     pub const BAR: usize = 42;\n }\n \n-use foo::BAR as main;\n+use foo::BAR as main; //~ ERROR `main` function not found in crate"}, {"sha": "9d8b40dc3c9bc4c489b7026104a3b9f56fe8ecdb", "filename": "src/test/ui/entry-point/imported_main_const_forbidden.stderr", "status": "modified", "additions": 5, "deletions": 11, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fentry-point%2Fimported_main_const_forbidden.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fentry-point%2Fimported_main_const_forbidden.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fentry-point%2Fimported_main_const_forbidden.stderr?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,16 +1,10 @@\n error[E0601]: `main` function not found in crate `imported_main_const_forbidden`\n-  --> $DIR/imported_main_const_forbidden.rs:1:1\n+  --> $DIR/imported_main_const_forbidden.rs:6:22\n    |\n-LL | / #![feature(imported_main)]\n-LL | |\n-LL | | pub mod foo {\n-LL | |     pub const BAR: usize = 42;\n-LL | | }\n-LL | |\n-LL | | use foo::BAR as main;\n-   | |_____----------------^ consider adding a `main` function to `$DIR/imported_main_const_forbidden.rs`\n-   |       |\n-   |       non-function item at `crate::main` is found\n+LL | use foo::BAR as main;\n+   |     ---------------- ^ consider adding a `main` function to `$DIR/imported_main_const_forbidden.rs`\n+   |     |\n+   |     non-function item at `crate::main` is found\n \n error: aborting due to previous error\n "}, {"sha": "d7deeaed99da265dc77fa1519144cfcb4ce94437", "filename": "src/test/ui/main-wrong-location.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fmain-wrong-location.rs", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fmain-wrong-location.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmain-wrong-location.rs?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,6 +1,5 @@\n mod m {\n-//~^ ERROR `main` function not found\n     // An inferred main entry point\n     // must appear at the top of the crate\n     fn main() { }\n-}\n+} //~ ERROR `main` function not found"}, {"sha": "0058af9b79ebfe14cbbbf5ad5da956f75b74fc27", "filename": "src/test/ui/main-wrong-location.stderr", "status": "modified", "additions": 4, "deletions": 9, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fmain-wrong-location.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fmain-wrong-location.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmain-wrong-location.stderr?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,16 +1,11 @@\n error[E0601]: `main` function not found in crate `main_wrong_location`\n-  --> $DIR/main-wrong-location.rs:1:1\n+  --> $DIR/main-wrong-location.rs:5:2\n    |\n-LL | / mod m {\n-LL | |\n-LL | |     // An inferred main entry point\n-LL | |     // must appear at the top of the crate\n-LL | |     fn main() { }\n-LL | | }\n-   | |_^ the main function must be defined at the crate level (in `$DIR/main-wrong-location.rs`)\n+LL | }\n+   |  ^ the main function must be defined at the crate level (in `$DIR/main-wrong-location.rs`)\n    |\n note: here is a function named `main`\n-  --> $DIR/main-wrong-location.rs:5:5\n+  --> $DIR/main-wrong-location.rs:4:5\n    |\n LL |     fn main() { }\n    |     ^^^^^^^^^^^^^"}, {"sha": "5113dc6ec08c44a80cab77f93b8e755a4e3c0a8f", "filename": "src/test/ui/missing/missing-main.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fmissing%2Fmissing-main.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fmissing%2Fmissing-main.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmissing%2Fmissing-main.stderr?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,8 +1,8 @@\n error[E0601]: `main` function not found in crate `missing_main`\n-  --> $DIR/missing-main.rs:2:1\n+  --> $DIR/missing-main.rs:2:14\n    |\n LL | fn mian() { }\n-   | ^^^^^^^^^^^^^ consider adding a `main` function to `$DIR/missing-main.rs`\n+   |              ^ consider adding a `main` function to `$DIR/missing-main.rs`\n \n error: aborting due to previous error\n "}, {"sha": "8af7838c7913850179d3b6f6a4bbed7b6a79a423", "filename": "src/test/ui/parser/issues/issue-49040.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fparser%2Fissues%2Fissue-49040.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftest%2Fui%2Fparser%2Fissues%2Fissue-49040.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissues%2Fissue-49040.stderr?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -5,10 +5,10 @@ LL | #![allow(unused_variables)];\n    |                            ^ help: remove this semicolon\n \n error[E0601]: `main` function not found in crate `issue_49040`\n-  --> $DIR/issue-49040.rs:1:1\n+  --> $DIR/issue-49040.rs:1:29\n    |\n LL | #![allow(unused_variables)];\n-   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ consider adding a `main` function to `$DIR/issue-49040.rs`\n+   |                             ^ consider adding a `main` function to `$DIR/issue-49040.rs`\n \n error: aborting due to 2 previous errors\n "}, {"sha": "878897c410cf5e5c7014b75199df8ba15c964006", "filename": "src/tools/clippy/tests/ui/crashes/ice-6250.stderr", "status": "modified", "additions": 3, "deletions": 9, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fcrashes%2Fice-6250.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fcrashes%2Fice-6250.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fcrashes%2Fice-6250.stderr?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,14 +1,8 @@\n error[E0601]: `main` function not found in crate `ice_6250`\n-  --> $DIR/ice-6250.rs:4:1\n+  --> $DIR/ice-6250.rs:16:2\n    |\n-LL | / pub struct Cache {\n-LL | |     data: Vec<i32>,\n-LL | | }\n-LL | |\n-...  |\n-LL | |     }\n-LL | | }\n-   | |_^ consider adding a `main` function to `$DIR/ice-6250.rs`\n+LL | }\n+   |  ^ consider adding a `main` function to `$DIR/ice-6250.rs`\n \n error[E0308]: mismatched types\n   --> $DIR/ice-6250.rs:12:14"}, {"sha": "77a3c2ba4ad09ba0286e9dc34a19e1b847e83805", "filename": "src/tools/clippy/tests/ui/crashes/ice-6251.stderr", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fcrashes%2Fice-6251.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/91f360329926981802f8bf5a320517c3ddd37829/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fcrashes%2Fice-6251.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fcrashes%2Fice-6251.stderr?ref=91f360329926981802f8bf5a320517c3ddd37829", "patch": "@@ -1,10 +1,8 @@\n error[E0601]: `main` function not found in crate `ice_6251`\n-  --> $DIR/ice-6251.rs:4:1\n+  --> $DIR/ice-6251.rs:6:2\n    |\n-LL | / fn bug<T>() -> impl Iterator<Item = [(); { |x: [u8]| x }]> {\n-LL | |     std::iter::empty()\n-LL | | }\n-   | |_^ consider adding a `main` function to `$DIR/ice-6251.rs`\n+LL | }\n+   |  ^ consider adding a `main` function to `$DIR/ice-6251.rs`\n \n error[E0277]: the size for values of type `[u8]` cannot be known at compilation time\n   --> $DIR/ice-6251.rs:4:45"}]}