{"sha": "43c090ed69a624928c03ad61a29a59badf80ff7b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQzYzA5MGVkNjlhNjI0OTI4YzAzYWQ2MWEyOWE1OWJhZGY4MGZmN2I=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2016-08-18T12:39:11Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2016-08-18T12:39:11Z"}, "message": "Auto merge of #35732 - jonathandturner:region_error_labels, r=nikomatsakis\n\nMove 'doesn't live long enough' errors to labels\n\nThis patch moves the \"doesn't live long enough\" region-style errors to instead use labels.\n\nAn example follows.\n\nBefore:\n\n```\nerror: `x` does not live long enough\n  --> src/test/compile-fail/send-is-not-static-ensures-scoping.rs:26:18\n   |\n26 |         let y = &x;\n   |                  ^\n   |\nnote: reference must be valid for the block at 23:10...\n  --> src/test/compile-fail/send-is-not-static-ensures-scoping.rs:23:11\n   |\n23 | fn main() {\n   |           ^\nnote: ...but borrowed value is only valid for the block suffix following statement 0 at 25:18\n  --> src/test/compile-fail/send-is-not-static-ensures-scoping.rs:25:19\n   |\n25 |         let x = 1;\n   |                   ^\n```\n\nAfter:\n\n```\nerror: `x` does not live long enough\n  --> src/test/compile-fail/send-is-not-static-ensures-scoping.rs:26:18\n   |\n26 |         let y = &x;\n   |                  ^ does not live long enough\n...\n32 |     };\n   |     - borrowed value only valid until here\n...\n35 | }\n   | - borrowed value must be valid until here\n```\n\nr? @nikomatsakis", "tree": {"sha": "23a269ce2a994db3f06e173b465b231e94e0bf38", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/23a269ce2a994db3f06e173b465b231e94e0bf38"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/43c090ed69a624928c03ad61a29a59badf80ff7b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/43c090ed69a624928c03ad61a29a59badf80ff7b", "html_url": "https://github.com/rust-lang/rust/commit/43c090ed69a624928c03ad61a29a59badf80ff7b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/43c090ed69a624928c03ad61a29a59badf80ff7b/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9d6520f97ba9062e6a6103f4038357e928d2f851", "url": "https://api.github.com/repos/rust-lang/rust/commits/9d6520f97ba9062e6a6103f4038357e928d2f851", "html_url": "https://github.com/rust-lang/rust/commit/9d6520f97ba9062e6a6103f4038357e928d2f851"}, {"sha": "864b3efd3302c9447f4d689779efda4a7b52c294", "url": "https://api.github.com/repos/rust-lang/rust/commits/864b3efd3302c9447f4d689779efda4a7b52c294", "html_url": "https://github.com/rust-lang/rust/commit/864b3efd3302c9447f4d689779efda4a7b52c294"}], "stats": {"total": 173, "additions": 129, "deletions": 44}, "files": [{"sha": "667bf16874ec4df7165acfc0d41da0076e67334e", "filename": "src/librustc_borrowck/borrowck/gather_loans/lifetime.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Flibrustc_borrowck%2Fborrowck%2Fgather_loans%2Flifetime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Flibrustc_borrowck%2Fborrowck%2Fgather_loans%2Flifetime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_borrowck%2Fborrowck%2Fgather_loans%2Flifetime.rs?ref=43c090ed69a624928c03ad61a29a59badf80ff7b", "patch": "@@ -96,7 +96,7 @@ impl<'a, 'tcx> GuaranteeLifetimeContext<'a, 'tcx> {\n         //! Reports an error if `loan_region` is larger than `max_scope`\n \n         if !self.bccx.is_subregion_of(self.loan_region, max_scope) {\n-            Err(self.report_error(err_out_of_scope(max_scope, self.loan_region)))\n+            Err(self.report_error(err_out_of_scope(max_scope, self.loan_region, self.cause)))\n         } else {\n             Ok(())\n         }"}, {"sha": "fd5db97b5d8bc48ed3da920df32333b1caa638cb", "filename": "src/librustc_borrowck/borrowck/mod.rs", "status": "modified", "additions": 77, "deletions": 15, "changes": 92, "blob_url": "https://github.com/rust-lang/rust/blob/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Flibrustc_borrowck%2Fborrowck%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Flibrustc_borrowck%2Fborrowck%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_borrowck%2Fborrowck%2Fmod.rs?ref=43c090ed69a624928c03ad61a29a59badf80ff7b", "patch": "@@ -566,7 +566,7 @@ pub fn opt_loan_path<'tcx>(cmt: &mc::cmt<'tcx>) -> Option<Rc<LoanPath<'tcx>>> {\n #[derive(PartialEq)]\n pub enum bckerr_code {\n     err_mutbl,\n-    err_out_of_scope(ty::Region, ty::Region), // superscope, subscope\n+    err_out_of_scope(ty::Region, ty::Region, euv::LoanCause), // superscope, subscope, loan cause\n     err_borrowed_pointer_too_short(ty::Region, ty::Region), // loan, ptr\n }\n \n@@ -614,9 +614,9 @@ impl<'a, 'tcx> BorrowckCtxt<'a, 'tcx> {\n     pub fn report(&self, err: BckError<'tcx>) {\n         // Catch and handle some particular cases.\n         match (&err.code, &err.cause) {\n-            (&err_out_of_scope(ty::ReScope(_), ty::ReStatic),\n+            (&err_out_of_scope(ty::ReScope(_), ty::ReStatic, _),\n              &BorrowViolation(euv::ClosureCapture(span))) |\n-            (&err_out_of_scope(ty::ReScope(_), ty::ReFree(..)),\n+            (&err_out_of_scope(ty::ReScope(_), ty::ReFree(..), _),\n              &BorrowViolation(euv::ClosureCapture(span))) => {\n                 return self.report_out_of_scope_escaping_closure_capture(&err, span);\n             }\n@@ -963,6 +963,22 @@ impl<'a, 'tcx> BorrowckCtxt<'a, 'tcx> {\n             .emit();\n     }\n \n+    fn region_end_span(&self, region: ty::Region) -> Option<Span> {\n+        match region {\n+            ty::ReScope(scope) => {\n+                match scope.span(&self.tcx.region_maps, &self.tcx.map) {\n+                    Some(s) => {\n+                        Some(s.end_point())\n+                    }\n+                    None => {\n+                        None\n+                    }\n+                }\n+            }\n+            _ => None\n+        }\n+    }\n+\n     pub fn note_and_explain_bckerr(&self, db: &mut DiagnosticBuilder, err: BckError<'tcx>,\n         error_span: Span) {\n         let code = err.code;\n@@ -1003,19 +1019,65 @@ impl<'a, 'tcx> BorrowckCtxt<'a, 'tcx> {\n                 }\n             }\n \n-            err_out_of_scope(super_scope, sub_scope) => {\n-                self.tcx.note_and_explain_region(\n-                    db,\n-                    \"reference must be valid for \",\n-                    sub_scope,\n-                    \"...\");\n-                self.tcx.note_and_explain_region(\n-                    db,\n-                    \"...but borrowed value is only valid for \",\n-                    super_scope,\n-                    \"\");\n+            err_out_of_scope(super_scope, sub_scope, cause) => {\n+                match cause {\n+                    euv::ClosureCapture(s) => {\n+                        // The primary span starts out as the closure creation point.\n+                        // Change the primary span here to highlight the use of the variable\n+                        // in the closure, because it seems more natural. Highlight\n+                        // closure creation point as a secondary span.\n+                        match db.span.primary_span() {\n+                            Some(primary) => {\n+                                db.span = MultiSpan::from_span(s);\n+                                db.span_label(primary, &format!(\"capture occurs here\"));\n+                                db.span_label(s, &format!(\"does not live long enough\"));\n+                            }\n+                            None => ()\n+                        }\n+                    }\n+                    _ => {\n+                        db.span_label(error_span, &format!(\"does not live long enough\"));\n+                    }\n+                }\n+\n+                let sub_span = self.region_end_span(sub_scope);\n+                let super_span = self.region_end_span(super_scope);\n+\n+                match (sub_span, super_span) {\n+                    (Some(s1), Some(s2)) if s1 == s2 => {\n+                        db.span_label(s1, &\"borrowed value dropped before borrower\");\n+                        db.note(\"values in a scope are dropped in the opposite order \\\n+                                they are created\");\n+                    }\n+                    _ => {\n+                        match sub_span {\n+                            Some(s) => {\n+                                db.span_label(s, &\"borrowed value must be valid until here\");\n+                            }\n+                            None => {\n+                                self.tcx.note_and_explain_region(\n+                                    db,\n+                                    \"borrowed value must be valid for \",\n+                                    sub_scope,\n+                                    \"...\");\n+                            }\n+                        }\n+                        match super_span {\n+                            Some(s) => {\n+                                db.span_label(s, &\"borrowed value only valid until here\");\n+                            }\n+                            None => {\n+                                self.tcx.note_and_explain_region(\n+                                    db,\n+                                    \"...but borrowed value is only valid for \",\n+                                    super_scope,\n+                                    \"\");\n+                            }\n+                        }\n+                    }\n+                }\n+\n                 if let Some(span) = statement_scope_span(self.tcx, super_scope) {\n-                    db.span_label(error_span, &format!(\"does not live long enough\"));\n                     db.span_help(span,\n                                  \"consider using a `let` binding to increase its lifetime\");\n                 }"}, {"sha": "6c9f67b2b33d45151aba71dce7f1c157f940fdca", "filename": "src/test/compile-fail/borrowck/borrowck-let-suggestion-suffixes.rs", "status": "modified", "additions": 12, "deletions": 11, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fcompile-fail%2Fborrowck%2Fborrowck-let-suggestion-suffixes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fcompile-fail%2Fborrowck%2Fborrowck-let-suggestion-suffixes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fborrowck%2Fborrowck-let-suggestion-suffixes.rs?ref=43c090ed69a624928c03ad61a29a59badf80ff7b", "patch": "@@ -13,47 +13,48 @@ fn f() {\n     let mut v1 = Vec::new(); // statement 1\n \n     let mut v2 = Vec::new(); // statement 2\n-    //~^ NOTE reference must be valid for the block suffix following statement 2\n \n     let young = ['y'];       // statement 3\n-    //~^ NOTE ...but borrowed value is only valid for the block suffix following statement 3\n \n     v2.push(&young[0]);      // statement 4\n     //~^ ERROR `young[..]` does not live long enough\n+    //~| NOTE does not live long enough\n+    //~| NOTE values in a scope are dropped in the opposite order they are created\n \n     let mut v3 = Vec::new(); // statement 5\n-    //~^ NOTE reference must be valid for the block suffix following statement 5\n \n     v3.push(&'x');           // statement 6\n     //~^ ERROR borrowed value does not live long enough\n-    //~| does not live long enough\n-    //~| NOTE ...but borrowed value is only valid for the statement\n+    //~| NOTE does not live long enough\n+    //~| NOTE borrowed value only valid until here\n     //~| HELP consider using a `let` binding to increase its lifetime\n \n     {\n \n         let mut v4 = Vec::new(); // (sub) statement 0\n-        //~^ NOTE reference must be valid for the block suffix following statement 0\n \n         v4.push(&'y');\n         //~^ ERROR borrowed value does not live long enough\n-        //~| does not live long enough\n-        //~| NOTE ...but borrowed value is only valid for the statement\n+        //~| NOTE does not live long enough\n+        //~| NOTE borrowed value only valid until here\n         //~| HELP consider using a `let` binding to increase its lifetime\n \n     }                       // (statement 7)\n+    //~^ NOTE borrowed value must be valid until here\n \n     let mut v5 = Vec::new(); // statement 8\n-    //~^ NOTE reference must be valid for the block suffix following statement 8\n \n     v5.push(&'z');\n     //~^ ERROR borrowed value does not live long enough\n-    //~| does not live long enough\n-    //~| NOTE ...but borrowed value is only valid for the statement\n+    //~| NOTE does not live long enough\n+    //~| NOTE borrowed value only valid until here\n     //~| HELP consider using a `let` binding to increase its lifetime\n \n     v1.push(&old[0]);\n }\n+//~^ NOTE borrowed value dropped before borrower\n+//~| NOTE borrowed value must be valid until here\n+//~| NOTE borrowed value must be valid until here\n \n fn main() {\n     f();"}, {"sha": "ef8f44c1df78978c1d0974c6704e33f714ca7c8a", "filename": "src/test/compile-fail/borrowck/borrowck-let-suggestion.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fcompile-fail%2Fborrowck%2Fborrowck-let-suggestion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fcompile-fail%2Fborrowck%2Fborrowck-let-suggestion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fborrowck%2Fborrowck-let-suggestion.rs?ref=43c090ed69a624928c03ad61a29a59badf80ff7b", "patch": "@@ -11,11 +11,11 @@\n fn f() {\n     let x = [1].iter();\n     //~^ ERROR borrowed value does not live long enough\n-    //~|does not live long enough\n-    //~| NOTE reference must be valid for the block suffix following statement\n+    //~| NOTE does not live long enough\n+    //~| NOTE borrowed value only valid until here\n     //~| HELP consider using a `let` binding to increase its lifetime\n-    //~| NOTE ...but borrowed value is only valid for the statement at 12:4\n }\n+//~^ borrowed value must be valid until here\n \n fn main() {\n     f();"}, {"sha": "8dfcb08cff339b4153037ec430e0aa462a871b78", "filename": "src/test/compile-fail/impl-trait/loan-extend.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fcompile-fail%2Fimpl-trait%2Floan-extend.rs", "raw_url": "https://github.com/rust-lang/rust/raw/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fcompile-fail%2Fimpl-trait%2Floan-extend.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fimpl-trait%2Floan-extend.rs?ref=43c090ed69a624928c03ad61a29a59badf80ff7b", "patch": "@@ -14,10 +14,10 @@\n fn borrow<'a, T>(_: &'a mut T) -> impl Copy { () }\n \n fn main() {\n-    //~^ NOTE reference must be valid for the block\n     let long;\n     let mut short = 0;\n-    //~^ NOTE but borrowed value is only valid for the block suffix following statement 1\n     long = borrow(&mut short);\n     //~^ ERROR `short` does not live long enough\n-}\n+    //~| NOTE does not live long enough\n+    //~| NOTE values in a scope are dropped in the opposite order they are created\n+} //~ borrowed value dropped before borrower"}, {"sha": "18206a68515fe9c4503322588f7cd635582d5336", "filename": "src/test/compile-fail/region-borrow-params-issue-29793-small.rs", "status": "modified", "additions": 16, "deletions": 8, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fcompile-fail%2Fregion-borrow-params-issue-29793-small.rs", "raw_url": "https://github.com/rust-lang/rust/raw/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fcompile-fail%2Fregion-borrow-params-issue-29793-small.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fregion-borrow-params-issue-29793-small.rs?ref=43c090ed69a624928c03ad61a29a59badf80ff7b", "patch": "@@ -16,15 +16,19 @@\n \n fn escaping_borrow_of_closure_params_1() {\n     let g = |x: usize, y:usize| {\n-        //~^ NOTE reference must be valid for the scope of call-site for function\n-        //~| NOTE ...but borrowed value is only valid for the scope of function body\n-        //~| NOTE reference must be valid for the scope of call-site for function\n-        //~| NOTE ...but borrowed value is only valid for the scope of function body\n         let f = |t: bool| if t { x } else { y }; // (separate errors for `x` vs `y`)\n         //~^ ERROR `x` does not live long enough\n         //~| ERROR `y` does not live long enough\n+        //~| NOTE capture occurs here\n+        //~| NOTE capture occurs here\n+        //~| NOTE does not live long enough\n+        //~| NOTE does not live long enough\n+        //~| NOTE values in a scope are dropped in the opposite order they are created\n+        //~| NOTE values in a scope are dropped in the opposite order they are created\n         return f;\n     };\n+    //~^ NOTE borrowed value dropped before borrower\n+    //~| NOTE borrowed value dropped before borrower\n \n     // We delberately do not call `g`; this small version of the test,\n     // after adding such a call, was (properly) rejected even when the\n@@ -35,15 +39,19 @@ fn escaping_borrow_of_closure_params_1() {\n \n fn escaping_borrow_of_closure_params_2() {\n     let g = |x: usize, y:usize| {\n-        //~^ NOTE reference must be valid for the scope of call-site for function\n-        //~| NOTE ...but borrowed value is only valid for the scope of function body\n-        //~| NOTE reference must be valid for the scope of call-site for function\n-        //~| NOTE ...but borrowed value is only valid for the scope of function body\n         let f = |t: bool| if t { x } else { y }; // (separate errors for `x` vs `y`)\n         //~^ ERROR `x` does not live long enough\n         //~| ERROR `y` does not live long enough\n+        //~| NOTE capture occurs here\n+        //~| NOTE capture occurs here\n+        //~| NOTE does not live long enough\n+        //~| NOTE does not live long enough\n+        //~| NOTE values in a scope are dropped in the opposite order they are created\n+        //~| NOTE values in a scope are dropped in the opposite order they are created\n         f\n     };\n+    //~^ NOTE borrowed value dropped before borrower\n+    //~| NOTE borrowed value dropped before borrower\n \n     // (we don't call `g`; see above)\n }"}, {"sha": "1b7718d2283a7bfd6a617c112f8a5d19bdd209a6", "filename": "src/test/compile-fail/send-is-not-static-ensures-scoping.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fcompile-fail%2Fsend-is-not-static-ensures-scoping.rs", "raw_url": "https://github.com/rust-lang/rust/raw/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fcompile-fail%2Fsend-is-not-static-ensures-scoping.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fsend-is-not-static-ensures-scoping.rs?ref=43c090ed69a624928c03ad61a29a59badf80ff7b", "patch": "@@ -26,8 +26,8 @@ fn main() {\n         let y = &x; //~ ERROR `x` does not live long enough\n \n         scoped(|| {\n-            //~^ ERROR `y` does not live long enough\n             let _z = y;\n+            //~^ ERROR `y` does not live long enough\n         })\n     };\n "}, {"sha": "ce60521034ee7cc89b8dc89bbda548497297de34", "filename": "src/test/compile-fail/unboxed-closures-failed-recursive-fn-1.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fcompile-fail%2Funboxed-closures-failed-recursive-fn-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fcompile-fail%2Funboxed-closures-failed-recursive-fn-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Funboxed-closures-failed-recursive-fn-1.rs?ref=43c090ed69a624928c03ad61a29a59badf80ff7b", "patch": "@@ -22,8 +22,8 @@ fn a() {\n     let mut factorial: Option<Box<Fn(u32) -> u32>> = None;\n \n     let f = |x: u32| -> u32 {\n-        //~^ ERROR `factorial` does not live long enough\n         let g = factorial.as_ref().unwrap();\n+        //~^ ERROR `factorial` does not live long enough\n         if x == 0 {1} else {x * g(x-1)}\n     };\n "}, {"sha": "7bea8642cce1409193e89322cccebcf7df7bc6f4", "filename": "src/test/ui/span/issue-11925.rs", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fui%2Fspan%2Fissue-11925.rs", "raw_url": "https://github.com/rust-lang/rust/raw/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fui%2Fspan%2Fissue-11925.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2Fissue-11925.rs?ref=43c090ed69a624928c03ad61a29a59badf80ff7b", "patch": "@@ -15,7 +15,7 @@ fn to_fn_once<A,F:FnOnce<A>>(f: F) -> F { f }\n fn main() {\n     let r = {\n         let x: Box<_> = box 42;\n-        let f = to_fn_once(move|| &x); //~ ERROR: `x` does not live long enough\n+        let f = to_fn_once(move|| &x);\n         f()\n     };\n ", "previous_filename": "src/test/compile-fail/issue-11925.rs"}, {"sha": "d379cfc3d68a7bb870aa61e19d0bf314d0d2bbab", "filename": "src/test/ui/span/issue-11925.stderr", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fui%2Fspan%2Fissue-11925.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/43c090ed69a624928c03ad61a29a59badf80ff7b/src%2Ftest%2Fui%2Fspan%2Fissue-11925.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2Fissue-11925.stderr?ref=43c090ed69a624928c03ad61a29a59badf80ff7b", "patch": "@@ -0,0 +1,14 @@\n+error: `x` does not live long enough\n+  --> $DIR/issue-11925.rs:18:36\n+   |\n+18 |         let f = to_fn_once(move|| &x);\n+   |                                    ^\n+   |                                    |\n+   |                                    does not live long enough\n+   |                                    borrowed value only valid until here\n+...\n+23 | }\n+   | - borrowed value must be valid until here\n+\n+error: aborting due to previous error\n+"}]}