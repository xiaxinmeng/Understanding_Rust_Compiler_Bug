{"sha": "3a39b2aa5a68dd07aacab2106db3927f666a485a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNhMzliMmFhNWE2OGRkMDdhYWNhYjIxMDZkYjM5MjdmNjY2YTQ4NWE=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2018-01-23T13:23:58Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2018-01-23T13:23:58Z"}, "message": "Auto merge of #47620 - GuillaumeGomez:multiple-themes, r=QuietMisdreavus\n\nMultiple themes for rustdoc\n\nr? @QuietMisdreavus", "tree": {"sha": "20b5d74509612eb932733b3d7425f798a56d9921", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/20b5d74509612eb932733b3d7425f798a56d9921"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3a39b2aa5a68dd07aacab2106db3927f666a485a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3a39b2aa5a68dd07aacab2106db3927f666a485a", "html_url": "https://github.com/rust-lang/rust/commit/3a39b2aa5a68dd07aacab2106db3927f666a485a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3a39b2aa5a68dd07aacab2106db3927f666a485a/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "48a7ea9c4095e3218df39832dfc51a456534ecc9", "url": "https://api.github.com/repos/rust-lang/rust/commits/48a7ea9c4095e3218df39832dfc51a456534ecc9", "html_url": "https://github.com/rust-lang/rust/commit/48a7ea9c4095e3218df39832dfc51a456534ecc9"}, {"sha": "5b8504401c7590130eb01a34155b12c26881b0b1", "url": "https://api.github.com/repos/rust-lang/rust/commits/5b8504401c7590130eb01a34155b12c26881b0b1", "html_url": "https://github.com/rust-lang/rust/commit/5b8504401c7590130eb01a34155b12c26881b0b1"}], "stats": {"total": 616, "additions": 603, "deletions": 13}, "files": [{"sha": "03250542b4e790853076eac26076ab031f511221", "filename": "src/librustdoc/externalfiles.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fexternalfiles.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fexternalfiles.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fexternalfiles.rs?ref=3a39b2aa5a68dd07aacab2106db3927f666a485a", "patch": "@@ -14,7 +14,7 @@ use std::str;\n use html::markdown::{Markdown, RenderType};\n \n #[derive(Clone)]\n-pub struct ExternalHtml{\n+pub struct ExternalHtml {\n     /// Content that will be included inline in the <head> section of a\n     /// rendered Markdown file or generated documentation\n     pub in_header: String,"}, {"sha": "8395b0686e1b07f60f7b35841b13a63c74046e41", "filename": "src/librustdoc/html/layout.rs", "status": "modified", "additions": 18, "deletions": 3, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Flayout.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Flayout.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Flayout.rs?ref=3a39b2aa5a68dd07aacab2106db3927f666a485a", "patch": "@@ -10,6 +10,7 @@\n \n use std::fmt;\n use std::io;\n+use std::path::PathBuf;\n \n use externalfiles::ExternalHtml;\n \n@@ -31,7 +32,7 @@ pub struct Page<'a> {\n \n pub fn render<T: fmt::Display, S: fmt::Display>(\n     dst: &mut io::Write, layout: &Layout, page: &Page, sidebar: &S, t: &T,\n-    css_file_extension: bool)\n+    css_file_extension: bool, themes: &[PathBuf])\n     -> io::Result<()>\n {\n     write!(dst,\n@@ -47,8 +48,11 @@ r##\"<!DOCTYPE html>\n     <title>{title}</title>\n \n     <link rel=\"stylesheet\" type=\"text/css\" href=\"{root_path}normalize.css\">\n-    <link rel=\"stylesheet\" type=\"text/css\" href=\"{root_path}rustdoc.css\">\n-    <link rel=\"stylesheet\" type=\"text/css\" href=\"{root_path}main.css\">\n+    <link rel=\"stylesheet\" type=\"text/css\" href=\"{root_path}rustdoc.css\" id=\"mainThemeStyle\">\n+    {themes}\n+    <link rel=\"stylesheet\" type=\"text/css\" href=\"{root_path}dark.css\">\n+    <link rel=\"stylesheet\" type=\"text/css\" href=\"{root_path}main.css\" id=\"themeStyle\">\n+    <script src=\"{root_path}storage.js\"></script>\n     {css_extension}\n \n     {favicon}\n@@ -70,6 +74,11 @@ r##\"<!DOCTYPE html>\n         {sidebar}\n     </nav>\n \n+    <button id=\"theme-picker\">\n+        <img src=\"{root_path}brush.svg\" width=\"18\" alt=\"Pick another theme!\">\n+        <div id=\"theme-choices\"></div>\n+    </button>\n+    <script src=\"{root_path}theme.js\"></script>\n     <nav class=\"sub\">\n         <form class=\"search-form js-only\">\n             <div class=\"search-container\">\n@@ -176,6 +185,12 @@ r##\"<!DOCTYPE html>\n     after_content = layout.external_html.after_content,\n     sidebar   = *sidebar,\n     krate     = layout.krate,\n+    themes = themes.iter()\n+                   .filter_map(|t| t.file_stem())\n+                   .filter_map(|t| t.to_str())\n+                   .map(|t| format!(r#\"<link rel=\"stylesheet\" type=\"text/css\" href=\"{}{}\">\"#,\n+                                    page.root_path, t))\n+                   .collect::<String>(),\n     )\n }\n "}, {"sha": "e4878d6b631880c39327c51a1d78022f6799ed79", "filename": "src/librustdoc/html/render.rs", "status": "modified", "additions": 76, "deletions": 6, "changes": 82, "blob_url": "https://github.com/rust-lang/rust/blob/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender.rs?ref=3a39b2aa5a68dd07aacab2106db3927f666a485a", "patch": "@@ -132,6 +132,8 @@ pub struct SharedContext {\n     /// This flag indicates whether listings of modules (in the side bar and documentation itself)\n     /// should be ordered alphabetically or in order of appearance (in the source code).\n     pub sort_modules_alphabetically: bool,\n+    /// Additional themes to be added to the generated docs.\n+    pub themes: Vec<PathBuf>,\n }\n \n impl SharedContext {\n@@ -219,6 +221,17 @@ impl Error {\n     }\n }\n \n+macro_rules! try_none {\n+    ($e:expr, $file:expr) => ({\n+        use std::io;\n+        match $e {\n+            Some(e) => e,\n+            None => return Err(Error::new(io::Error::new(io::ErrorKind::Other, \"not found\"),\n+                                          $file))\n+        }\n+    })\n+}\n+\n macro_rules! try_err {\n     ($e:expr, $file:expr) => ({\n         match $e {\n@@ -489,7 +502,8 @@ pub fn run(mut krate: clean::Crate,\n            renderinfo: RenderInfo,\n            render_type: RenderType,\n            sort_modules_alphabetically: bool,\n-           deny_render_differences: bool) -> Result<(), Error> {\n+           deny_render_differences: bool,\n+           themes: Vec<PathBuf>) -> Result<(), Error> {\n     let src_root = match krate.src {\n         FileName::Real(ref p) => match p.parent() {\n             Some(p) => p.to_path_buf(),\n@@ -513,6 +527,7 @@ pub fn run(mut krate: clean::Crate,\n         markdown_warnings: RefCell::new(vec![]),\n         created_dirs: RefCell::new(FxHashSet()),\n         sort_modules_alphabetically,\n+        themes,\n     };\n \n     // If user passed in `--playground-url` arg, we fill in crate name here\n@@ -859,12 +874,65 @@ fn write_shared(cx: &Context,\n     // Add all the static files. These may already exist, but we just\n     // overwrite them anyway to make sure that they're fresh and up-to-date.\n \n-    write(cx.dst.join(\"main.js\"),\n-          include_bytes!(\"static/main.js\"))?;\n     write(cx.dst.join(\"rustdoc.css\"),\n           include_bytes!(\"static/rustdoc.css\"))?;\n+\n+    // To avoid \"main.css\" to be overwritten, we'll first run over the received themes and only\n+    // then we'll run over the \"official\" styles.\n+    let mut themes: HashSet<String> = HashSet::new();\n+\n+    for entry in &cx.shared.themes {\n+        let mut content = Vec::with_capacity(100000);\n+\n+        let mut f = try_err!(File::open(&entry), &entry);\n+        try_err!(f.read_to_end(&mut content), &entry);\n+        write(cx.dst.join(try_none!(entry.file_name(), &entry)), content.as_slice())?;\n+        themes.insert(try_none!(try_none!(entry.file_stem(), &entry).to_str(), &entry).to_owned());\n+    }\n+\n+    write(cx.dst.join(\"brush.svg\"),\n+          include_bytes!(\"static/brush.svg\"))?;\n     write(cx.dst.join(\"main.css\"),\n-          include_bytes!(\"static/styles/main.css\"))?;\n+          include_bytes!(\"static/themes/main.css\"))?;\n+    themes.insert(\"main\".to_owned());\n+    write(cx.dst.join(\"dark.css\"),\n+          include_bytes!(\"static/themes/dark.css\"))?;\n+    themes.insert(\"dark\".to_owned());\n+\n+    let mut themes: Vec<&String> = themes.iter().collect();\n+    themes.sort();\n+    // To avoid theme switch latencies as much as possible, we put everything theme related\n+    // at the beginning of the html files into another js file.\n+    write(cx.dst.join(\"theme.js\"), format!(\n+r#\"var themes = document.getElementById(\"theme-choices\");\n+var themePicker = document.getElementById(\"theme-picker\");\n+themePicker.onclick = function() {{\n+    if (themes.style.display === \"block\") {{\n+        themes.style.display = \"none\";\n+        themePicker.style.borderBottomRightRadius = \"3px\";\n+        themePicker.style.borderBottomLeftRadius = \"3px\";\n+    }} else {{\n+        themes.style.display = \"block\";\n+        themePicker.style.borderBottomRightRadius = \"0\";\n+        themePicker.style.borderBottomLeftRadius = \"0\";\n+    }}\n+}};\n+[{}].forEach(function(item) {{\n+    var div = document.createElement('div');\n+    div.innerHTML = item;\n+    div.onclick = function(el) {{\n+        switchTheme(currentTheme, mainTheme, item);\n+    }};\n+    themes.appendChild(div);\n+}});\n+\"#, themes.iter()\n+          .map(|s| format!(\"\\\"{}\\\"\", s))\n+          .collect::<Vec<String>>()\n+          .join(\",\")).as_bytes())?;\n+\n+    write(cx.dst.join(\"main.js\"), include_bytes!(\"static/main.js\"))?;\n+    write(cx.dst.join(\"storage.js\"), include_bytes!(\"static/storage.js\"))?;\n+\n     if let Some(ref css) = cx.shared.css_file_extension {\n         let out = cx.dst.join(\"theme.css\");\n         try_err!(fs::copy(css, out), css);\n@@ -1156,7 +1224,8 @@ impl<'a> SourceCollector<'a> {\n         };\n         layout::render(&mut w, &self.scx.layout,\n                        &page, &(\"\"), &Source(contents),\n-                       self.scx.css_file_extension.is_some())?;\n+                       self.scx.css_file_extension.is_some(),\n+                       &self.scx.themes)?;\n         w.flush()?;\n         self.scx.local_sources.insert(p.clone(), href);\n         Ok(())\n@@ -1520,7 +1589,8 @@ impl Context {\n             layout::render(writer, &self.shared.layout, &page,\n                            &Sidebar{ cx: self, item: it },\n                            &Item{ cx: self, item: it },\n-                           self.shared.css_file_extension.is_some())?;\n+                           self.shared.css_file_extension.is_some(),\n+                           &self.shared.themes)?;\n         } else {\n             let mut url = self.root_path();\n             if let Some(&(ref names, ty)) = cache().paths.get(&it.def_id) {"}, {"sha": "072264a64083094698bd7518156e2264e6ef88fe", "filename": "src/librustdoc/html/static/brush.svg", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fbrush.svg", "raw_url": "https://github.com/rust-lang/rust/raw/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fbrush.svg", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fbrush.svg?ref=3a39b2aa5a68dd07aacab2106db3927f666a485a", "patch": "@@ -0,0 +1 @@\n+<?xml version=\"1.0\" ?><svg height=\"1792\" viewBox=\"0 0 1792 1792\" width=\"1792\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M1615 0q70 0 122.5 46.5t52.5 116.5q0 63-45 151-332 629-465 752-97 91-218 91-126 0-216.5-92.5t-90.5-219.5q0-128 92-212l638-579q59-54 130-54zm-909 1034q39 76 106.5 130t150.5 76l1 71q4 213-129.5 347t-348.5 134q-123 0-218-46.5t-152.5-127.5-86.5-183-29-220q7 5 41 30t62 44.5 59 36.5 46 17q41 0 55-37 25-66 57.5-112.5t69.5-76 88-47.5 103-25.5 125-10.5z\"/></svg>\n\\ No newline at end of file"}, {"sha": "659bed18b003154d6eee016cec4f3076ad8fbfb4", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=3a39b2aa5a68dd07aacab2106db3927f666a485a", "patch": "@@ -122,6 +122,10 @@\n             }\n         }\n         document.getElementsByTagName(\"body\")[0].style.marginTop = '45px';\n+        var themePicker = document.getElementById(\"theme-picker\");\n+        if (themePicker) {\n+            themePicker.style.position = \"fixed\";\n+        }\n     }\n \n     function hideSidebar() {\n@@ -136,6 +140,10 @@\n             filler.remove();\n         }\n         document.getElementsByTagName(\"body\")[0].style.marginTop = '';\n+        var themePicker = document.getElementById(\"theme-picker\");\n+        if (themePicker) {\n+            themePicker.style.position = \"absolute\";\n+        }\n     }\n \n     // used for special search precedence\n@@ -1532,7 +1540,9 @@\n                 ul.appendChild(li);\n             }\n             div.appendChild(ul);\n-            sidebar.appendChild(div);\n+            if (sidebar) {\n+                sidebar.appendChild(div);\n+            }\n         }\n \n         block(\"primitive\", \"Primitive Types\");"}, {"sha": "c1ca86e3292a4709658da37351705a51d88746c5", "filename": "src/librustdoc/html/static/rustdoc.css", "status": "modified", "additions": 37, "deletions": 1, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css?ref=3a39b2aa5a68dd07aacab2106db3927f666a485a", "patch": "@@ -360,7 +360,8 @@ ul.item-list > li > .out-of-band {\n }\n \n h4 > code, h3 > code, .invisible > code {\n-\tposition: inherit;\n+\tmax-width: calc(100% - 41px);\n+\tdisplay: block;\n }\n \n .in-band, code {\n@@ -376,6 +377,7 @@ h4 > code, h3 > code, .invisible > code {\n \tmargin: 0px;\n \tpadding: 0px;\n \tdisplay: inline-block;\n+\tmax-width: calc(100% - 43px);\n }\n \n .in-band > code {\n@@ -1140,3 +1142,37 @@ kbd {\n \tborder-radius: 3px;\n \tbox-shadow: inset 0 -1px 0;\n }\n+\n+#theme-picker {\n+\tposition: absolute;\n+\tleft: 211px;\n+\ttop: 17px;\n+\tpadding: 4px;\n+\tborder: 1px solid;\n+\tborder-radius: 3px;\n+\tcursor: pointer;\n+}\n+\n+#theme-choices {\n+\tdisplay: none;\n+\tposition: absolute;\n+\tleft: -1px;\n+\ttop: 30px;\n+\tborder: 1px solid;\n+\tborder-radius: 3px;\n+\tz-index: 1;\n+}\n+\n+#theme-choices > div {\n+\tborder-top: 1px solid;\n+\tpadding: 4px;\n+\ttext-align: center;\n+}\n+\n+@media (max-width: 700px) {\n+\t#theme-picker {\n+\t\tleft: 109px;\n+\t\ttop: 7px;\n+\t\tz-index: 1;\n+\t}\n+}"}, {"sha": "0aa1065b3786a39c259789ebbb08da96d1cbadfc", "filename": "src/librustdoc/html/static/storage.js", "status": "added", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fstorage.js", "raw_url": "https://github.com/rust-lang/rust/raw/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fstorage.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fstorage.js?ref=3a39b2aa5a68dd07aacab2106db3927f666a485a", "patch": "@@ -0,0 +1,36 @@\n+/*!\n+ * Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+ * file at the top-level directory of this distribution and at\n+ * http://rust-lang.org/COPYRIGHT.\n+ *\n+ * Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+ * http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+ * <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+ * option. This file may not be copied, modified, or distributed\n+ * except according to those terms.\n+ */\n+\n+var currentTheme = document.getElementById(\"themeStyle\");\n+var mainTheme = document.getElementById(\"mainThemeStyle\");\n+\n+function updateLocalStorage(name, value) {\n+    if (typeof(Storage) !== \"undefined\") {\n+        localStorage[name] = value;\n+    } else {\n+        // No Web Storage support so we do nothing\n+    }\n+}\n+\n+function getCurrentValue(name) {\n+    if (typeof(Storage) !== \"undefined\" && localStorage[name] !== undefined) {\n+        return localStorage[name];\n+    }\n+    return null;\n+}\n+\n+function switchTheme(styleElem, mainStyleElem, newTheme) {\n+    styleElem.href = mainStyleElem.href.replace(\"rustdoc.css\", newTheme + \".css\");\n+    updateLocalStorage('theme', newTheme);\n+}\n+\n+switchTheme(currentTheme, mainTheme, getCurrentValue('theme') || 'main');"}, {"sha": "05ac0660396564dcfac4b44e7cc497e0dbe53e2e", "filename": "src/librustdoc/html/static/themes/dark.css", "status": "added", "additions": 384, "deletions": 0, "changes": 384, "blob_url": "https://github.com/rust-lang/rust/blob/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Fdark.css?ref=3a39b2aa5a68dd07aacab2106db3927f666a485a", "patch": "@@ -0,0 +1,384 @@\n+/**\n+ * Copyright 2015 The Rust Project Developers. See the COPYRIGHT\n+ * file at the top-level directory of this distribution and at\n+ * http://rust-lang.org/COPYRIGHT.\n+ *\n+ * Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+ * http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+ * <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+ * option. This file may not be copied, modified, or distributed\n+ * except according to those terms.\n+ */\n+\n+body {\n+\tbackground-color: #353535;\n+\tcolor: #ddd;\n+}\n+\n+h1, h2, h3:not(.impl):not(.method):not(.type):not(.tymethod), h4:not(.method):not(.type):not(.tymethod) {\n+\tcolor: #ddd;\n+}\n+h1.fqn {\n+\tborder-bottom-color: #d2d2d2;\n+}\n+h2, h3:not(.impl):not(.method):not(.type):not(.tymethod), h4:not(.method):not(.type):not(.tymethod) {\n+\tborder-bottom-color: #d2d2d2;\n+}\n+\n+.in-band {\n+\tbackground-color: #353535;\n+}\n+\n+.invisible {\n+\tbackground: rgba(0, 0, 0, 0);\n+}\n+\n+.docblock code, .docblock-short code {\n+\tbackground-color: #2A2A2A;\n+}\n+pre {\n+\tbackground-color: #2A2A2A;\n+}\n+\n+.sidebar {\n+\tbackground-color: #505050;\n+}\n+\n+.sidebar .current {\n+\tbackground-color: #333;\n+}\n+\n+.source .sidebar {\n+\tbackground-color: #353535;\n+}\n+\n+.sidebar .location {\n+\tborder-color: #fff;\n+\tbackground: #575757;\n+\tcolor: #DDD;\n+}\n+\n+.sidebar .version {\n+\tborder-bottom-color: #DDD;\n+}\n+\n+.sidebar-title {\n+\tborder-top-color: #777;\n+\tborder-bottom-color: #777;\n+}\n+\n+.block a:hover {\n+\tbackground: #444;\n+}\n+\n+.line-numbers span { color: #3B91E2; }\n+.line-numbers .line-highlighted {\n+\tbackground-color: #0a042f !important;\n+}\n+\n+.docblock h1, .docblock h2, .docblock h3, .docblock h4, .docblock h5 {\n+\tborder-bottom-color: #DDD;\n+}\n+\n+.docblock table {\n+\tborder-color: #ddd;\n+}\n+\n+.docblock table td {\n+\tborder-top-color: #ddd;\n+\tborder-bottom-color: #ddd;\n+}\n+\n+.docblock table th {\n+\tborder-top-color: #ddd;\n+\tborder-bottom-color: #ddd;\n+}\n+\n+:target { background: #494a3d; }\n+\n+:target > .in-band {\n+\tbackground: #494a3d;\n+}\n+\n+.content .method .where,\n+.content .fn .where,\n+.content .where.fmt-newline {\n+\tcolor: #ddd;\n+}\n+\n+.content .highlighted {\n+\tcolor: #eee !important;\n+\tbackground-color: #333;\n+}\n+.content .highlighted a, .content .highlighted span { color: #eee !important; }\n+.content .highlighted.trait { background-color: #013191; }\n+.content .highlighted.mod { background-color: #803a1b; }\n+.content .highlighted.externcrate { background-color: #396bac; }\n+.content .highlighted.enum { background-color: #5b4e68; }\n+.content .highlighted.struct { background-color: #194e9f; }\n+.content .highlighted.fn,\n+.content .highlighted.method,\n+.content .highlighted.tymethod { background-color: #4950ed; }\n+.content .highlighted.type { background-color: #38902c; }\n+.content .highlighted.foreigntype { background-color: #b200d6; }\n+.content .highlighted.macro { background-color: #217d1c; }\n+.content .highlighted.constant,\n+.content .highlighted.static { background-color: #0063cc; }\n+.content .highlighted.primitive { background-color: #00708a; }\n+\n+.content span.enum, .content a.enum, .block a.current.enum { color: #82b089; }\n+.content span.struct, .content a.struct, .block a.current.struct { color: #ff794d; }\n+.content span.type, .content a.type, .block a.current.type { color: #ff7f00; }\n+.content span.foreigntype, .content a.foreigntype, .block a.current.foreigntype { color: #dd7de8; }\n+.content span.macro, .content a.macro, .block a.current.macro { color: #09bd00; }\n+.content span.union, .content a.union, .block a.current.union { color: #a6ae37; }\n+.content span.constant, .content a.constant, .block a.current.constant,\n+.content span.static, .content a.static, .block a.current.static { color: #82a5c9; }\n+.content span.primitive, .content a.primitive, .block a.current.primitive { color: #43aec7; }\n+.content span.externcrate,\n+.content span.mod, .content a.mod, .block a.current.mod { color: #bda000; }\n+.content span.trait, .content a.trait, .block a.current.trait { color: #b78cf2; }\n+.content span.fn, .content a.fn, .block a.current.fn,\n+.content span.method, .content a.method, .block a.current.method,\n+.content span.tymethod, .content a.tymethod, .block a.current.tymethod,\n+.content .fnname{ color: #2BAB63; }\n+\n+pre.rust .comment { color: #8d8d8b; }\n+pre.rust .doccomment { color: #8ca375; }\n+\n+nav {\n+\tborder-bottom-color: #4e4e4e;\n+}\n+nav.main .current {\n+\tborder-top-color: #eee;\n+\tborder-bottom-color: #eee;\n+}\n+nav.main .separator {\n+\tborder-color: #eee;\n+}\n+a {\n+\tcolor: #ddd;\n+}\n+\n+.docblock a, .docblock-short a, .stability a {\n+\tcolor: #D2991D;\n+}\n+\n+a.test-arrow {\n+\tcolor: #dedede;\n+}\n+\n+.collapse-toggle {\n+\tcolor: #999;\n+}\n+\n+.search-input {\n+\tcolor: #111;\n+\tbox-shadow: 0 0 0 1px #000, 0 0 0 2px transparent;\n+\tbackground-color: #f0f0f0;\n+}\n+\n+.search-input:focus {\n+\tborder-color: #008dfd;\n+}\n+\n+.stab.unstable { background: #FFF5D6; border-color: #FFC600; color: #404040; }\n+.stab.deprecated { background: #F3DFFF; border-color: #7F0087;  color: #404040; }\n+.stab.portability { background: #C4ECFF; border-color: #7BA5DB;  color: #404040; }\n+\n+.module-item .stab {\n+\tcolor: #ddd;\n+}\n+\n+#help > div {\n+\tbackground: #4d4d4d;\n+\tborder-color: #bfbfbf;\n+}\n+\n+#help dt {\n+\tborder-color: #bfbfbf;\n+\tbackground: #fff;\n+\tcolor: black;\n+}\n+\n+.since {\n+\tcolor: grey;\n+}\n+\n+tr.result span.primitive::after {\n+\tcolor: #ddd;\n+}\n+\n+.line-numbers :target { background-color: transparent; }\n+\n+/* Code highlighting */\n+pre.rust .kw { color: #ab8ac1; }\n+pre.rust .kw-2, pre.rust .prelude-ty { color: #769acb; }\n+pre.rust .number, pre.rust .string { color: #83a300; }\n+pre.rust .self, pre.rust .bool-val, pre.rust .prelude-val,\n+pre.rust .attribute, pre.rust .attribute .ident { color: #ee6868; }\n+pre.rust .macro, pre.rust .macro-nonterminal { color: #3E999F; }\n+pre.rust .lifetime { color: #d97f26; }\n+pre.rust .question-mark {\n+\tcolor: #ff9011;\n+}\n+\n+a.test-arrow {\n+\tbackground-color: rgba(78, 139, 202, 0.2);\n+}\n+\n+a.test-arrow:hover{\n+\tbackground-color: #4e8bca;\n+}\n+\n+.toggle-label {\n+\tcolor: #999;\n+}\n+\n+:target > code {\n+\tbackground: #FDFFD3;\n+}\n+\n+pre.compile_fail {\n+\tborder-left: 2px solid rgba(255,0,0,.6);\n+}\n+\n+pre.compile_fail:hover, .information:hover + pre.compile_fail {\n+\tborder-left: 2px solid #f00;\n+}\n+\n+pre.ignore {\n+\tborder-left: 2px solid rgba(255,142,0,.6);\n+}\n+\n+pre.ignore:hover, .information:hover + pre.ignore {\n+\tborder-left: 2px solid #ff9200;\n+}\n+\n+.tooltip.compile_fail {\n+\tcolor: rgba(255,0,0,.6);\n+}\n+\n+.information > .compile_fail:hover {\n+\tcolor: #f00;\n+}\n+\n+.tooltip.ignore {\n+\tcolor: rgba(255,142,0,.6);\n+}\n+\n+.information > .ignore:hover {\n+\tcolor: rgba(255,142,0,1);\n+}\n+\n+.search-failed > a {\n+\tcolor: #0089ff;\n+}\n+\n+.tooltip .tooltiptext {\n+\tbackground-color: black;\n+\tcolor: #fff;\n+}\n+\n+.tooltip .tooltiptext::after {\n+\tborder-color: transparent black transparent transparent;\n+}\n+\n+.important-traits .tooltip .tooltiptext {\n+\tbackground-color: white;\n+\tcolor: black;\n+\tborder-color: black;\n+}\n+\n+#titles > div {\n+\tborder-bottom-color:  #ccc;\n+}\n+\n+#titles > div.selected {\n+\tborder-bottom-color: #0078ee;\n+}\n+\n+#titles > div:hover {\n+\tborder-bottom-color: #0089ff;\n+}\n+\n+#titles > div > div.count {\n+\tcolor: #888;\n+}\n+\n+.modal {\n+\tbackground-color: rgba(0,0,0,0.3);\n+}\n+\n+.modal-content {\n+\tbackground-color: #272727;\n+\tborder-color: #999;\n+}\n+\n+.modal-content > .close {\n+\tbackground-color: #272727;\n+\tborder-color: #999;\n+}\n+\n+.modal-content > .close:hover {\n+\tbackground-color: #ff1f1f;\n+\tcolor: white;\n+}\n+\n+.modal-content > .whiter {\n+\tbackground-color: #272727;\n+}\n+\n+.modal-content > .close:hover + .whiter {\n+\tbackground-color: #ff1f1f;\n+}\n+\n+@media (max-width: 700px) {\n+\t.sidebar-menu {\n+\t\tbackground-color: #505050;\n+\t\tborder-bottom-color: #e0e0e0;\n+\t\tborder-right-color: #e0e0e0;\n+\t}\n+\n+\t.sidebar-elems {\n+\t\tbackground-color: #505050;\n+\t\tborder-right-color: #000;\n+\t}\n+\n+\t#sidebar-filler {\n+\t\tbackground-color: #505050;\n+\t\tborder-bottom-color: #e0e0e0;\n+\t}\n+}\n+\n+kbd {\n+\tcolor: #444d56;\n+\tbackground-color: #fafbfc;\n+\tborder-color: #d1d5da;\n+\tborder-bottom-color: #c6cbd1;\n+\tbox-shadow-color: #c6cbd1;\n+}\n+\n+#theme-picker {\n+\tborder-color: #e0e0e0;\n+\tbackground: #f0f0f0;\n+}\n+\n+#theme-choices {\n+\tborder-color: #e0e0e0;\n+\tbackground-color: #353535;\n+}\n+\n+#theme-choices > div {\n+\tborder-top: #e0e0e0;\n+}\n+\n+#theme-choices > div:hover {\n+\tbackground-color: #444;\n+}\n+\n+@media (max-width: 700px) {\n+\t#theme-picker {\n+\t\tbackground: #353535;\n+\t}\n+}"}, {"sha": "84b21e7239fc10077e49c21f0eec28c76d702c09", "filename": "src/librustdoc/html/static/themes/main.css", "status": "renamed", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Fmain.css", "raw_url": "https://github.com/rust-lang/rust/raw/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Fmain.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Fmain.css?ref=3a39b2aa5a68dd07aacab2106db3927f666a485a", "patch": "@@ -351,3 +351,26 @@ kbd {\n \tborder-bottom-color: #c6cbd1;\n \tbox-shadow-color: #c6cbd1;\n }\n+\n+#theme-picker {\n+\tborder-color: #e0e0e0;\n+}\n+\n+#theme-choices {\n+\tborder-color: #ccc;\n+\tbackground-color: #fff;\n+}\n+\n+#theme-choices > div {\n+\tborder-top: #e0e0e0;\n+}\n+\n+#theme-choices > div:hover {\n+\tbackground-color: #eee;\n+}\n+\n+@media (max-width: 700px) {\n+\t#theme-picker {\n+\t\tbackground: #fff;\n+\t}\n+}", "previous_filename": "src/librustdoc/html/static/styles/main.css"}, {"sha": "ccd79e5b2c5f4e7066cdc8a44af7e885799ab18e", "filename": "src/librustdoc/lib.rs", "status": "modified", "additions": 16, "deletions": 1, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3a39b2aa5a68dd07aacab2106db3927f666a485a/src%2Flibrustdoc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Flib.rs?ref=3a39b2aa5a68dd07aacab2106db3927f666a485a", "patch": "@@ -264,6 +264,11 @@ pub fn opts() -> Vec<RustcOptGroup> {\n             o.optflag(\"\", \"deny-render-differences\", \"abort doc runs when markdown rendering \\\n                                                       differences are found\")\n         }),\n+        unstable(\"themes\", |o| {\n+            o.optmulti(\"\", \"themes\",\n+                       \"additional themes which will be added to the generated docs\",\n+                       \"FILES\")\n+        }),\n     ]\n }\n \n@@ -365,6 +370,15 @@ pub fn main_args(args: &[String]) -> isize {\n         }\n     }\n \n+    let mut themes = Vec::new();\n+    for theme in matches.opt_strs(\"themes\").iter().map(|s| PathBuf::from(&s)) {\n+        if !theme.is_file() {\n+            eprintln!(\"rustdoc: option --themes arguments must all be files\");\n+            return 1;\n+        }\n+        themes.push(theme);\n+    }\n+\n     let external_html = match ExternalHtml::load(\n             &matches.opt_strs(\"html-in-header\"),\n             &matches.opt_strs(\"html-before-content\"),\n@@ -413,7 +427,8 @@ pub fn main_args(args: &[String]) -> isize {\n                                   renderinfo,\n                                   render_type,\n                                   sort_modules_alphabetically,\n-                                  deny_render_differences)\n+                                  deny_render_differences,\n+                                  themes)\n                     .expect(\"failed to generate documentation\");\n                 0\n             }"}]}