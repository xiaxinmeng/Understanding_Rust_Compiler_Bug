{"sha": "cd0009eb3085c975ecaff6f40af7d1e99714feda", "node_id": "C_kwDOAAsO6NoAKGNkMDAwOWViMzA4NWM5NzVlY2FmZjZmNDBhZjdkMWU5OTcxNGZlZGE", "commit": {"author": {"name": "Caio", "email": "c410.f3r@gmail.com", "date": "2023-04-09T11:16:20Z"}, "committer": {"name": "Caio", "email": "c410.f3r@gmail.com", "date": "2023-04-09T11:16:20Z"}, "message": "Suppress the triggering of some lints in derived structures", "tree": {"sha": "cdf65a2d626e3abc762adab0c545d6ae88d31e75", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cdf65a2d626e3abc762adab0c545d6ae88d31e75"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cd0009eb3085c975ecaff6f40af7d1e99714feda", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cd0009eb3085c975ecaff6f40af7d1e99714feda", "html_url": "https://github.com/rust-lang/rust/commit/cd0009eb3085c975ecaff6f40af7d1e99714feda", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cd0009eb3085c975ecaff6f40af7d1e99714feda/comments", "author": {"login": "c410-f3r", "id": 17877264, "node_id": "MDQ6VXNlcjE3ODc3MjY0", "avatar_url": "https://avatars.githubusercontent.com/u/17877264?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c410-f3r", "html_url": "https://github.com/c410-f3r", "followers_url": "https://api.github.com/users/c410-f3r/followers", "following_url": "https://api.github.com/users/c410-f3r/following{/other_user}", "gists_url": "https://api.github.com/users/c410-f3r/gists{/gist_id}", "starred_url": "https://api.github.com/users/c410-f3r/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c410-f3r/subscriptions", "organizations_url": "https://api.github.com/users/c410-f3r/orgs", "repos_url": "https://api.github.com/users/c410-f3r/repos", "events_url": "https://api.github.com/users/c410-f3r/events{/privacy}", "received_events_url": "https://api.github.com/users/c410-f3r/received_events", "type": "User", "site_admin": false}, "committer": {"login": "c410-f3r", "id": 17877264, "node_id": "MDQ6VXNlcjE3ODc3MjY0", "avatar_url": "https://avatars.githubusercontent.com/u/17877264?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c410-f3r", "html_url": "https://github.com/c410-f3r", "followers_url": "https://api.github.com/users/c410-f3r/followers", "following_url": "https://api.github.com/users/c410-f3r/following{/other_user}", "gists_url": "https://api.github.com/users/c410-f3r/gists{/gist_id}", "starred_url": "https://api.github.com/users/c410-f3r/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c410-f3r/subscriptions", "organizations_url": "https://api.github.com/users/c410-f3r/orgs", "repos_url": "https://api.github.com/users/c410-f3r/repos", "events_url": "https://api.github.com/users/c410-f3r/events{/privacy}", "received_events_url": "https://api.github.com/users/c410-f3r/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e903af506f2a18978efc02f1407bc3949d479c92", "url": "https://api.github.com/repos/rust-lang/rust/commits/e903af506f2a18978efc02f1407bc3949d479c92", "html_url": "https://github.com/rust-lang/rust/commit/e903af506f2a18978efc02f1407bc3949d479c92"}], "stats": {"total": 476, "additions": 290, "deletions": 186}, "files": [{"sha": "6c050c2cb8b26ce0a423d74e5943337c174c7681", "filename": "clippy_lints/src/operators/arithmetic_side_effects.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cd0009eb3085c975ecaff6f40af7d1e99714feda/clippy_lints%2Fsrc%2Foperators%2Farithmetic_side_effects.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cd0009eb3085c975ecaff6f40af7d1e99714feda/clippy_lints%2Fsrc%2Foperators%2Farithmetic_side_effects.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Foperators%2Farithmetic_side_effects.rs?ref=cd0009eb3085c975ecaff6f40af7d1e99714feda", "patch": "@@ -1,4 +1,5 @@\n use super::ARITHMETIC_SIDE_EFFECTS;\n+use clippy_utils::is_from_proc_macro;\n use clippy_utils::{\n     consts::{constant, constant_simple, Constant},\n     diagnostics::span_lint,\n@@ -206,8 +207,9 @@ impl ArithmeticSideEffects {\n         self.issue_lint(cx, expr);\n     }\n \n-    fn should_skip_expr(&mut self, cx: &LateContext<'_>, expr: &hir::Expr<'_>) -> bool {\n+    fn should_skip_expr<'tcx>(&mut self, cx: &LateContext<'tcx>, expr: &hir::Expr<'tcx>) -> bool {\n         is_lint_allowed(cx, ARITHMETIC_SIDE_EFFECTS, expr.hir_id)\n+            || is_from_proc_macro(cx, expr)\n             || self.expr_span.is_some()\n             || self.const_span.map_or(false, |sp| sp.contains(expr.span))\n     }"}, {"sha": "ea9696691f96beefa89bc40e04f292f557fd0702", "filename": "clippy_lints/src/operators/numeric_arithmetic.rs", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/cd0009eb3085c975ecaff6f40af7d1e99714feda/clippy_lints%2Fsrc%2Foperators%2Fnumeric_arithmetic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cd0009eb3085c975ecaff6f40af7d1e99714feda/clippy_lints%2Fsrc%2Foperators%2Fnumeric_arithmetic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Foperators%2Fnumeric_arithmetic.rs?ref=cd0009eb3085c975ecaff6f40af7d1e99714feda", "patch": "@@ -1,12 +1,12 @@\n+use super::{FLOAT_ARITHMETIC, INTEGER_ARITHMETIC};\n use clippy_utils::consts::constant_simple;\n use clippy_utils::diagnostics::span_lint;\n+use clippy_utils::is_from_proc_macro;\n use clippy_utils::is_integer_literal;\n use rustc_hir as hir;\n use rustc_lint::LateContext;\n use rustc_span::source_map::Span;\n \n-use super::{FLOAT_ARITHMETIC, INTEGER_ARITHMETIC};\n-\n #[derive(Default)]\n pub struct Context {\n     expr_id: Option<hir::HirId>,\n@@ -19,6 +19,10 @@ impl Context {\n         self.expr_id.is_some() || self.const_span.map_or(false, |span| span.contains(e.span))\n     }\n \n+    fn skip_expr_involving_integers<'tcx>(cx: &LateContext<'tcx>, e: &hir::Expr<'tcx>) -> bool {\n+        is_from_proc_macro(cx, e)\n+    }\n+\n     pub fn check_binary<'tcx>(\n         &mut self,\n         cx: &LateContext<'tcx>,\n@@ -47,6 +51,9 @@ impl Context {\n \n         let (l_ty, r_ty) = (cx.typeck_results().expr_ty(l), cx.typeck_results().expr_ty(r));\n         if l_ty.peel_refs().is_integral() && r_ty.peel_refs().is_integral() {\n+            if Self::skip_expr_involving_integers(cx, expr) {\n+                return;\n+            }\n             match op {\n                 hir::BinOpKind::Div | hir::BinOpKind::Rem => match &r.kind {\n                     hir::ExprKind::Lit(_lit) => (),\n@@ -79,6 +86,9 @@ impl Context {\n         let ty = cx.typeck_results().expr_ty(arg);\n         if constant_simple(cx, cx.typeck_results(), expr).is_none() {\n             if ty.is_integral() {\n+                if Self::skip_expr_involving_integers(cx, expr) {\n+                    return;\n+                }\n                 span_lint(cx, INTEGER_ARITHMETIC, expr.span, \"integer arithmetic detected\");\n                 self.expr_id = Some(expr.hir_id);\n             } else if ty.is_floating_point() {"}, {"sha": "ab7e66a264daaa28f6852464d0b47921175f37dc", "filename": "tests/ui/arithmetic_side_effects.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/cd0009eb3085c975ecaff6f40af7d1e99714feda/tests%2Fui%2Farithmetic_side_effects.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cd0009eb3085c975ecaff6f40af7d1e99714feda/tests%2Fui%2Farithmetic_side_effects.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Farithmetic_side_effects.rs?ref=cd0009eb3085c975ecaff6f40af7d1e99714feda", "patch": "@@ -1,3 +1,5 @@\n+// aux-build:proc_macro_derive.rs\n+\n #![allow(\n     clippy::assign_op_pattern,\n     clippy::erasing_op,\n@@ -11,6 +13,8 @@\n #![feature(const_mut_refs, inline_const, saturating_int_impl)]\n #![warn(clippy::arithmetic_side_effects)]\n \n+extern crate proc_macro_derive;\n+\n use core::num::{Saturating, Wrapping};\n \n const ONE: i32 = 1;\n@@ -19,6 +23,9 @@ const ZERO: i32 = 0;\n #[derive(Clone, Copy)]\n pub struct Custom;\n \n+#[derive(proc_macro_derive::ShadowDerive)]\n+pub struct Nothing;\n+\n macro_rules! impl_arith {\n     ( $( $_trait:ident, $lhs:ty, $rhs:ty, $method:ident; )* ) => {\n         $("}, {"sha": "a036cadb9a03ffb2fbb27a8af481920d35502b3c", "filename": "tests/ui/arithmetic_side_effects.stderr", "status": "modified", "additions": 109, "deletions": 109, "changes": 218, "blob_url": "https://github.com/rust-lang/rust/blob/cd0009eb3085c975ecaff6f40af7d1e99714feda/tests%2Fui%2Farithmetic_side_effects.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cd0009eb3085c975ecaff6f40af7d1e99714feda/tests%2Fui%2Farithmetic_side_effects.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Farithmetic_side_effects.stderr?ref=cd0009eb3085c975ecaff6f40af7d1e99714feda", "patch": "@@ -1,655 +1,655 @@\n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:286:5\n+  --> $DIR/arithmetic_side_effects.rs:293:5\n    |\n LL |     _n += 1;\n    |     ^^^^^^^\n    |\n    = note: `-D clippy::arithmetic-side-effects` implied by `-D warnings`\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:287:5\n+  --> $DIR/arithmetic_side_effects.rs:294:5\n    |\n LL |     _n += &1;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:288:5\n+  --> $DIR/arithmetic_side_effects.rs:295:5\n    |\n LL |     _n -= 1;\n    |     ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:289:5\n+  --> $DIR/arithmetic_side_effects.rs:296:5\n    |\n LL |     _n -= &1;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:290:5\n+  --> $DIR/arithmetic_side_effects.rs:297:5\n    |\n LL |     _n /= 0;\n    |     ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:291:5\n+  --> $DIR/arithmetic_side_effects.rs:298:5\n    |\n LL |     _n /= &0;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:292:5\n+  --> $DIR/arithmetic_side_effects.rs:299:5\n    |\n LL |     _n %= 0;\n    |     ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:293:5\n+  --> $DIR/arithmetic_side_effects.rs:300:5\n    |\n LL |     _n %= &0;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:294:5\n+  --> $DIR/arithmetic_side_effects.rs:301:5\n    |\n LL |     _n *= 2;\n    |     ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:295:5\n+  --> $DIR/arithmetic_side_effects.rs:302:5\n    |\n LL |     _n *= &2;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:296:5\n+  --> $DIR/arithmetic_side_effects.rs:303:5\n    |\n LL |     _n += -1;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:297:5\n+  --> $DIR/arithmetic_side_effects.rs:304:5\n    |\n LL |     _n += &-1;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:298:5\n+  --> $DIR/arithmetic_side_effects.rs:305:5\n    |\n LL |     _n -= -1;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:299:5\n+  --> $DIR/arithmetic_side_effects.rs:306:5\n    |\n LL |     _n -= &-1;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:300:5\n+  --> $DIR/arithmetic_side_effects.rs:307:5\n    |\n LL |     _n /= -0;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:301:5\n+  --> $DIR/arithmetic_side_effects.rs:308:5\n    |\n LL |     _n /= &-0;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:302:5\n+  --> $DIR/arithmetic_side_effects.rs:309:5\n    |\n LL |     _n %= -0;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:303:5\n+  --> $DIR/arithmetic_side_effects.rs:310:5\n    |\n LL |     _n %= &-0;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:304:5\n+  --> $DIR/arithmetic_side_effects.rs:311:5\n    |\n LL |     _n *= -2;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:305:5\n+  --> $DIR/arithmetic_side_effects.rs:312:5\n    |\n LL |     _n *= &-2;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:306:5\n+  --> $DIR/arithmetic_side_effects.rs:313:5\n    |\n LL |     _custom += Custom;\n    |     ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:307:5\n+  --> $DIR/arithmetic_side_effects.rs:314:5\n    |\n LL |     _custom += &Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:308:5\n+  --> $DIR/arithmetic_side_effects.rs:315:5\n    |\n LL |     _custom -= Custom;\n    |     ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:309:5\n+  --> $DIR/arithmetic_side_effects.rs:316:5\n    |\n LL |     _custom -= &Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:310:5\n+  --> $DIR/arithmetic_side_effects.rs:317:5\n    |\n LL |     _custom /= Custom;\n    |     ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:311:5\n+  --> $DIR/arithmetic_side_effects.rs:318:5\n    |\n LL |     _custom /= &Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:312:5\n+  --> $DIR/arithmetic_side_effects.rs:319:5\n    |\n LL |     _custom %= Custom;\n    |     ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:313:5\n+  --> $DIR/arithmetic_side_effects.rs:320:5\n    |\n LL |     _custom %= &Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:314:5\n+  --> $DIR/arithmetic_side_effects.rs:321:5\n    |\n LL |     _custom *= Custom;\n    |     ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:315:5\n+  --> $DIR/arithmetic_side_effects.rs:322:5\n    |\n LL |     _custom *= &Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:316:5\n+  --> $DIR/arithmetic_side_effects.rs:323:5\n    |\n LL |     _custom >>= Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:317:5\n+  --> $DIR/arithmetic_side_effects.rs:324:5\n    |\n LL |     _custom >>= &Custom;\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:318:5\n+  --> $DIR/arithmetic_side_effects.rs:325:5\n    |\n LL |     _custom <<= Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:319:5\n+  --> $DIR/arithmetic_side_effects.rs:326:5\n    |\n LL |     _custom <<= &Custom;\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:320:5\n+  --> $DIR/arithmetic_side_effects.rs:327:5\n    |\n LL |     _custom += -Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:321:5\n+  --> $DIR/arithmetic_side_effects.rs:328:5\n    |\n LL |     _custom += &-Custom;\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:322:5\n+  --> $DIR/arithmetic_side_effects.rs:329:5\n    |\n LL |     _custom -= -Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:323:5\n+  --> $DIR/arithmetic_side_effects.rs:330:5\n    |\n LL |     _custom -= &-Custom;\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:324:5\n+  --> $DIR/arithmetic_side_effects.rs:331:5\n    |\n LL |     _custom /= -Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:325:5\n+  --> $DIR/arithmetic_side_effects.rs:332:5\n    |\n LL |     _custom /= &-Custom;\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:326:5\n+  --> $DIR/arithmetic_side_effects.rs:333:5\n    |\n LL |     _custom %= -Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:327:5\n+  --> $DIR/arithmetic_side_effects.rs:334:5\n    |\n LL |     _custom %= &-Custom;\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:328:5\n+  --> $DIR/arithmetic_side_effects.rs:335:5\n    |\n LL |     _custom *= -Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:329:5\n+  --> $DIR/arithmetic_side_effects.rs:336:5\n    |\n LL |     _custom *= &-Custom;\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:330:5\n+  --> $DIR/arithmetic_side_effects.rs:337:5\n    |\n LL |     _custom >>= -Custom;\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:331:5\n+  --> $DIR/arithmetic_side_effects.rs:338:5\n    |\n LL |     _custom >>= &-Custom;\n    |     ^^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:332:5\n+  --> $DIR/arithmetic_side_effects.rs:339:5\n    |\n LL |     _custom <<= -Custom;\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:333:5\n+  --> $DIR/arithmetic_side_effects.rs:340:5\n    |\n LL |     _custom <<= &-Custom;\n    |     ^^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:336:10\n+  --> $DIR/arithmetic_side_effects.rs:343:10\n    |\n LL |     _n = _n + 1;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:337:10\n+  --> $DIR/arithmetic_side_effects.rs:344:10\n    |\n LL |     _n = _n + &1;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:338:10\n+  --> $DIR/arithmetic_side_effects.rs:345:10\n    |\n LL |     _n = 1 + _n;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:339:10\n+  --> $DIR/arithmetic_side_effects.rs:346:10\n    |\n LL |     _n = &1 + _n;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:340:10\n+  --> $DIR/arithmetic_side_effects.rs:347:10\n    |\n LL |     _n = _n - 1;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:341:10\n+  --> $DIR/arithmetic_side_effects.rs:348:10\n    |\n LL |     _n = _n - &1;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:342:10\n+  --> $DIR/arithmetic_side_effects.rs:349:10\n    |\n LL |     _n = 1 - _n;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:343:10\n+  --> $DIR/arithmetic_side_effects.rs:350:10\n    |\n LL |     _n = &1 - _n;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:344:10\n+  --> $DIR/arithmetic_side_effects.rs:351:10\n    |\n LL |     _n = _n / 0;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:345:10\n+  --> $DIR/arithmetic_side_effects.rs:352:10\n    |\n LL |     _n = _n / &0;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:346:10\n+  --> $DIR/arithmetic_side_effects.rs:353:10\n    |\n LL |     _n = _n % 0;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:347:10\n+  --> $DIR/arithmetic_side_effects.rs:354:10\n    |\n LL |     _n = _n % &0;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:348:10\n+  --> $DIR/arithmetic_side_effects.rs:355:10\n    |\n LL |     _n = _n * 2;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:349:10\n+  --> $DIR/arithmetic_side_effects.rs:356:10\n    |\n LL |     _n = _n * &2;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:350:10\n+  --> $DIR/arithmetic_side_effects.rs:357:10\n    |\n LL |     _n = 2 * _n;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:351:10\n+  --> $DIR/arithmetic_side_effects.rs:358:10\n    |\n LL |     _n = &2 * _n;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:352:10\n+  --> $DIR/arithmetic_side_effects.rs:359:10\n    |\n LL |     _n = 23 + &85;\n    |          ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:353:10\n+  --> $DIR/arithmetic_side_effects.rs:360:10\n    |\n LL |     _n = &23 + 85;\n    |          ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:354:10\n+  --> $DIR/arithmetic_side_effects.rs:361:10\n    |\n LL |     _n = &23 + &85;\n    |          ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:355:15\n+  --> $DIR/arithmetic_side_effects.rs:362:15\n    |\n LL |     _custom = _custom + _custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:356:15\n+  --> $DIR/arithmetic_side_effects.rs:363:15\n    |\n LL |     _custom = _custom + &_custom;\n    |               ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:357:15\n+  --> $DIR/arithmetic_side_effects.rs:364:15\n    |\n LL |     _custom = Custom + _custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:358:15\n+  --> $DIR/arithmetic_side_effects.rs:365:15\n    |\n LL |     _custom = &Custom + _custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:359:15\n+  --> $DIR/arithmetic_side_effects.rs:366:15\n    |\n LL |     _custom = _custom - Custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:360:15\n+  --> $DIR/arithmetic_side_effects.rs:367:15\n    |\n LL |     _custom = _custom - &Custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:361:15\n+  --> $DIR/arithmetic_side_effects.rs:368:15\n    |\n LL |     _custom = Custom - _custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:362:15\n+  --> $DIR/arithmetic_side_effects.rs:369:15\n    |\n LL |     _custom = &Custom - _custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:363:15\n+  --> $DIR/arithmetic_side_effects.rs:370:15\n    |\n LL |     _custom = _custom / Custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:364:15\n+  --> $DIR/arithmetic_side_effects.rs:371:15\n    |\n LL |     _custom = _custom / &Custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:365:15\n+  --> $DIR/arithmetic_side_effects.rs:372:15\n    |\n LL |     _custom = _custom % Custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:366:15\n+  --> $DIR/arithmetic_side_effects.rs:373:15\n    |\n LL |     _custom = _custom % &Custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:367:15\n+  --> $DIR/arithmetic_side_effects.rs:374:15\n    |\n LL |     _custom = _custom * Custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:368:15\n+  --> $DIR/arithmetic_side_effects.rs:375:15\n    |\n LL |     _custom = _custom * &Custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:369:15\n+  --> $DIR/arithmetic_side_effects.rs:376:15\n    |\n LL |     _custom = Custom * _custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:370:15\n+  --> $DIR/arithmetic_side_effects.rs:377:15\n    |\n LL |     _custom = &Custom * _custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:371:15\n+  --> $DIR/arithmetic_side_effects.rs:378:15\n    |\n LL |     _custom = Custom + &Custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:372:15\n+  --> $DIR/arithmetic_side_effects.rs:379:15\n    |\n LL |     _custom = &Custom + Custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:373:15\n+  --> $DIR/arithmetic_side_effects.rs:380:15\n    |\n LL |     _custom = &Custom + &Custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:374:15\n+  --> $DIR/arithmetic_side_effects.rs:381:15\n    |\n LL |     _custom = _custom >> _custom;\n    |               ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:375:15\n+  --> $DIR/arithmetic_side_effects.rs:382:15\n    |\n LL |     _custom = _custom >> &_custom;\n    |               ^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:376:15\n+  --> $DIR/arithmetic_side_effects.rs:383:15\n    |\n LL |     _custom = Custom << _custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:377:15\n+  --> $DIR/arithmetic_side_effects.rs:384:15\n    |\n LL |     _custom = &Custom << _custom;\n    |               ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:380:10\n+  --> $DIR/arithmetic_side_effects.rs:387:10\n    |\n LL |     _n = -_n;\n    |          ^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:381:10\n+  --> $DIR/arithmetic_side_effects.rs:388:10\n    |\n LL |     _n = -&_n;\n    |          ^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:382:15\n+  --> $DIR/arithmetic_side_effects.rs:389:15\n    |\n LL |     _custom = -_custom;\n    |               ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:383:15\n+  --> $DIR/arithmetic_side_effects.rs:390:15\n    |\n LL |     _custom = -&_custom;\n    |               ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:392:5\n+  --> $DIR/arithmetic_side_effects.rs:399:5\n    |\n LL |     1 + i;\n    |     ^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:393:5\n+  --> $DIR/arithmetic_side_effects.rs:400:5\n    |\n LL |     i * 2;\n    |     ^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:394:5\n+  --> $DIR/arithmetic_side_effects.rs:401:5\n    |\n LL |     1 % i / 2;\n    |     ^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:395:5\n+  --> $DIR/arithmetic_side_effects.rs:402:5\n    |\n LL |     i - 2 + 2 - i;\n    |     ^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:396:5\n+  --> $DIR/arithmetic_side_effects.rs:403:5\n    |\n LL |     -i;\n    |     ^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:407:5\n+  --> $DIR/arithmetic_side_effects.rs:414:5\n    |\n LL |     i += 1;\n    |     ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:408:5\n+  --> $DIR/arithmetic_side_effects.rs:415:5\n    |\n LL |     i -= 1;\n    |     ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:409:5\n+  --> $DIR/arithmetic_side_effects.rs:416:5\n    |\n LL |     i *= 2;\n    |     ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:411:5\n+  --> $DIR/arithmetic_side_effects.rs:418:5\n    |\n LL |     i /= 0;\n    |     ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:413:5\n+  --> $DIR/arithmetic_side_effects.rs:420:5\n    |\n LL |     i /= var1;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:414:5\n+  --> $DIR/arithmetic_side_effects.rs:421:5\n    |\n LL |     i /= var2;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:416:5\n+  --> $DIR/arithmetic_side_effects.rs:423:5\n    |\n LL |     i %= 0;\n    |     ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:418:5\n+  --> $DIR/arithmetic_side_effects.rs:425:5\n    |\n LL |     i %= var1;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:419:5\n+  --> $DIR/arithmetic_side_effects.rs:426:5\n    |\n LL |     i %= var2;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:429:5\n+  --> $DIR/arithmetic_side_effects.rs:436:5\n    |\n LL |     10 / a\n    |     ^^^^^^"}, {"sha": "13d93f5c2758663fbeb32ba172d31aeeb89f7b63", "filename": "tests/ui/auxiliary/proc_macro_derive.rs", "status": "modified", "additions": 72, "deletions": 1, "changes": 73, "blob_url": "https://github.com/rust-lang/rust/blob/cd0009eb3085c975ecaff6f40af7d1e99714feda/tests%2Fui%2Fauxiliary%2Fproc_macro_derive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cd0009eb3085c975ecaff6f40af7d1e99714feda/tests%2Fui%2Fauxiliary%2Fproc_macro_derive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fauxiliary%2Fproc_macro_derive.rs?ref=cd0009eb3085c975ecaff6f40af7d1e99714feda", "patch": "@@ -9,7 +9,7 @@\n \n extern crate proc_macro;\n \n-use proc_macro::{quote, TokenStream};\n+use proc_macro::{quote, Delimiter, Group, Ident, Literal, Punct, Spacing, Span, TokenStream, TokenTree};\n \n #[proc_macro_derive(DeriveSomething)]\n pub fn derive(_: TokenStream) -> TokenStream {\n@@ -86,3 +86,74 @@ pub fn extra_lifetime(_input: TokenStream) -> TokenStream {\n         }\n     )\n }\n+\n+#[allow(unused)]\n+#[proc_macro_derive(ArithmeticDerive)]\n+pub fn arithmetic_derive(_: TokenStream) -> TokenStream {\n+    <TokenStream as FromIterator<TokenTree>>::from_iter(\n+        [\n+            Ident::new(\"fn\", Span::call_site()).into(),\n+            Ident::new(\"_foo\", Span::call_site()).into(),\n+            Group::new(Delimiter::Parenthesis, TokenStream::new()).into(),\n+            Group::new(\n+                Delimiter::Brace,\n+                <TokenStream as FromIterator<TokenTree>>::from_iter(\n+                    [\n+                        Ident::new(\"let\", Span::call_site()).into(),\n+                        Ident::new(\"mut\", Span::call_site()).into(),\n+                        Ident::new(\"_n\", Span::call_site()).into(),\n+                        Punct::new('=', Spacing::Alone).into(),\n+                        Literal::i32_unsuffixed(9).into(),\n+                        Punct::new(';', Spacing::Alone).into(),\n+                        Ident::new(\"_n\", Span::call_site()).into(),\n+                        Punct::new('=', Spacing::Alone).into(),\n+                        Literal::i32_unsuffixed(9).into(),\n+                        Punct::new('/', Spacing::Alone).into(),\n+                        Literal::i32_unsuffixed(2).into(),\n+                        Punct::new(';', Spacing::Alone).into(),\n+                        Ident::new(\"_n\", Span::call_site()).into(),\n+                        Punct::new('=', Spacing::Alone).into(),\n+                        Punct::new('-', Spacing::Alone).into(),\n+                        Ident::new(\"_n\", Span::call_site()).into(),\n+                        Punct::new(';', Spacing::Alone).into(),\n+                    ]\n+                    .into_iter(),\n+                ),\n+            )\n+            .into(),\n+        ]\n+        .into_iter(),\n+    )\n+}\n+\n+#[allow(unused)]\n+#[proc_macro_derive(ShadowDerive)]\n+pub fn shadow_derive(_: TokenStream) -> TokenStream {\n+    <TokenStream as FromIterator<TokenTree>>::from_iter(\n+        [\n+            Ident::new(\"fn\", Span::call_site()).into(),\n+            Ident::new(\"_foo\", Span::call_site()).into(),\n+            Group::new(Delimiter::Parenthesis, TokenStream::new()).into(),\n+            Group::new(\n+                Delimiter::Brace,\n+                <TokenStream as FromIterator<TokenTree>>::from_iter(\n+                    [\n+                        Ident::new(\"let\", Span::call_site()).into(),\n+                        Ident::new(\"_x\", Span::call_site()).into(),\n+                        Punct::new('=', Spacing::Alone).into(),\n+                        Literal::i32_unsuffixed(2).into(),\n+                        Punct::new(';', Spacing::Alone).into(),\n+                        Ident::new(\"let\", Span::call_site()).into(),\n+                        Ident::new(\"_x\", Span::call_site()).into(),\n+                        Punct::new('=', Spacing::Alone).into(),\n+                        Ident::new(\"_x\", Span::call_site()).into(),\n+                        Punct::new(';', Spacing::Alone).into(),\n+                    ]\n+                    .into_iter(),\n+                ),\n+            )\n+            .into(),\n+        ]\n+        .into_iter(),\n+    )\n+}"}, {"sha": "d253d103127d3a44f99511802c3b6e36222fc35f", "filename": "tests/ui/integer_arithmetic.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/cd0009eb3085c975ecaff6f40af7d1e99714feda/tests%2Fui%2Finteger_arithmetic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cd0009eb3085c975ecaff6f40af7d1e99714feda/tests%2Fui%2Finteger_arithmetic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Finteger_arithmetic.rs?ref=cd0009eb3085c975ecaff6f40af7d1e99714feda", "patch": "@@ -1,6 +1,13 @@\n+// aux-build:proc_macro_derive.rs\n+\n #![warn(clippy::integer_arithmetic, clippy::float_arithmetic)]\n #![allow(clippy::no_effect, clippy::unnecessary_operation, clippy::op_ref)]\n \n+extern crate proc_macro_derive;\n+\n+#[derive(proc_macro_derive::ShadowDerive)]\n+pub struct Nothing;\n+\n #[rustfmt::skip]\n fn main() {\n     let mut i = 1i32;"}, {"sha": "add3b6b90fa26108cb534a9f93e11cc8b167582c", "filename": "tests/ui/integer_arithmetic.stderr", "status": "modified", "additions": 27, "deletions": 27, "changes": 54, "blob_url": "https://github.com/rust-lang/rust/blob/cd0009eb3085c975ecaff6f40af7d1e99714feda/tests%2Fui%2Finteger_arithmetic.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cd0009eb3085c975ecaff6f40af7d1e99714feda/tests%2Fui%2Finteger_arithmetic.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Finteger_arithmetic.stderr?ref=cd0009eb3085c975ecaff6f40af7d1e99714feda", "patch": "@@ -1,166 +1,166 @@\n error: this operation will panic at runtime\n-  --> $DIR/integer_arithmetic.rs:30:5\n+  --> $DIR/integer_arithmetic.rs:37:5\n    |\n LL |     i /= 0;\n    |     ^^^^^^ attempt to divide `_` by zero\n    |\n    = note: `#[deny(unconditional_panic)]` on by default\n \n error: this operation will panic at runtime\n-  --> $DIR/integer_arithmetic.rs:35:5\n+  --> $DIR/integer_arithmetic.rs:42:5\n    |\n LL |     i %= 0;\n    |     ^^^^^^ attempt to calculate the remainder of `_` with a divisor of zero\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:9:5\n+  --> $DIR/integer_arithmetic.rs:16:5\n    |\n LL |     1 + i;\n    |     ^^^^^\n    |\n    = note: `-D clippy::integer-arithmetic` implied by `-D warnings`\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:10:5\n+  --> $DIR/integer_arithmetic.rs:17:5\n    |\n LL |     i * 2;\n    |     ^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:11:5\n+  --> $DIR/integer_arithmetic.rs:18:5\n    |\n LL | /     1 %\n LL | |     i / 2; // no error, this is part of the expression in the preceding line\n    | |_____^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:13:5\n+  --> $DIR/integer_arithmetic.rs:20:5\n    |\n LL |     i - 2 + 2 - i;\n    |     ^^^^^^^^^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:14:5\n+  --> $DIR/integer_arithmetic.rs:21:5\n    |\n LL |     -i;\n    |     ^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:15:5\n+  --> $DIR/integer_arithmetic.rs:22:5\n    |\n LL |     i >> 1;\n    |     ^^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:16:5\n+  --> $DIR/integer_arithmetic.rs:23:5\n    |\n LL |     i << 1;\n    |     ^^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:26:5\n+  --> $DIR/integer_arithmetic.rs:33:5\n    |\n LL |     i += 1;\n    |     ^^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:27:5\n+  --> $DIR/integer_arithmetic.rs:34:5\n    |\n LL |     i -= 1;\n    |     ^^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:28:5\n+  --> $DIR/integer_arithmetic.rs:35:5\n    |\n LL |     i *= 2;\n    |     ^^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:31:11\n+  --> $DIR/integer_arithmetic.rs:38:11\n    |\n LL |     i /= -1;\n    |           ^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:32:5\n+  --> $DIR/integer_arithmetic.rs:39:5\n    |\n LL |     i /= var1;\n    |     ^^^^^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:33:5\n+  --> $DIR/integer_arithmetic.rs:40:5\n    |\n LL |     i /= var2;\n    |     ^^^^^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:36:11\n+  --> $DIR/integer_arithmetic.rs:43:11\n    |\n LL |     i %= -1;\n    |           ^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:37:5\n+  --> $DIR/integer_arithmetic.rs:44:5\n    |\n LL |     i %= var1;\n    |     ^^^^^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:38:5\n+  --> $DIR/integer_arithmetic.rs:45:5\n    |\n LL |     i %= var2;\n    |     ^^^^^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:39:5\n+  --> $DIR/integer_arithmetic.rs:46:5\n    |\n LL |     i <<= 3;\n    |     ^^^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:40:5\n+  --> $DIR/integer_arithmetic.rs:47:5\n    |\n LL |     i >>= 2;\n    |     ^^^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:82:5\n+  --> $DIR/integer_arithmetic.rs:89:5\n    |\n LL |     3 + &1;\n    |     ^^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:83:5\n+  --> $DIR/integer_arithmetic.rs:90:5\n    |\n LL |     &3 + 1;\n    |     ^^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:84:5\n+  --> $DIR/integer_arithmetic.rs:91:5\n    |\n LL |     &3 + &1;\n    |     ^^^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:89:5\n+  --> $DIR/integer_arithmetic.rs:96:5\n    |\n LL |     a + x\n    |     ^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:93:5\n+  --> $DIR/integer_arithmetic.rs:100:5\n    |\n LL |     x + y\n    |     ^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:97:5\n+  --> $DIR/integer_arithmetic.rs:104:5\n    |\n LL |     x + y\n    |     ^^^^^\n \n error: integer arithmetic detected\n-  --> $DIR/integer_arithmetic.rs:101:5\n+  --> $DIR/integer_arithmetic.rs:108:5\n    |\n LL |     (&x + &y)\n    |     ^^^^^^^^^"}, {"sha": "ab7800a2110bdbf167f8d484e7f1ad4479895f23", "filename": "tests/ui/shadow.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/cd0009eb3085c975ecaff6f40af7d1e99714feda/tests%2Fui%2Fshadow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cd0009eb3085c975ecaff6f40af7d1e99714feda/tests%2Fui%2Fshadow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fshadow.rs?ref=cd0009eb3085c975ecaff6f40af7d1e99714feda", "patch": "@@ -1,6 +1,13 @@\n+// aux-build:proc_macro_derive.rs\n+\n #![warn(clippy::shadow_same, clippy::shadow_reuse, clippy::shadow_unrelated)]\n #![allow(clippy::let_unit_value)]\n \n+extern crate proc_macro_derive;\n+\n+#[derive(proc_macro_derive::ShadowDerive)]\n+pub struct Nothing;\n+\n fn shadow_same() {\n     let x = 1;\n     let x = x;"}, {"sha": "92bb937d08680194143f19907c9b699ad925a17f", "filename": "tests/ui/shadow.stderr", "status": "modified", "additions": 46, "deletions": 46, "changes": 92, "blob_url": "https://github.com/rust-lang/rust/blob/cd0009eb3085c975ecaff6f40af7d1e99714feda/tests%2Fui%2Fshadow.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cd0009eb3085c975ecaff6f40af7d1e99714feda/tests%2Fui%2Fshadow.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fshadow.stderr?ref=cd0009eb3085c975ecaff6f40af7d1e99714feda", "patch": "@@ -1,278 +1,278 @@\n error: `x` is shadowed by itself in `x`\n-  --> $DIR/shadow.rs:6:9\n+  --> $DIR/shadow.rs:13:9\n    |\n LL |     let x = x;\n    |         ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:5:9\n+  --> $DIR/shadow.rs:12:9\n    |\n LL |     let x = 1;\n    |         ^\n    = note: `-D clippy::shadow-same` implied by `-D warnings`\n \n error: `mut x` is shadowed by itself in `&x`\n-  --> $DIR/shadow.rs:7:13\n+  --> $DIR/shadow.rs:14:13\n    |\n LL |     let mut x = &x;\n    |             ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:6:9\n+  --> $DIR/shadow.rs:13:9\n    |\n LL |     let x = x;\n    |         ^\n \n error: `x` is shadowed by itself in `&mut x`\n-  --> $DIR/shadow.rs:8:9\n+  --> $DIR/shadow.rs:15:9\n    |\n LL |     let x = &mut x;\n    |         ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:7:9\n+  --> $DIR/shadow.rs:14:9\n    |\n LL |     let mut x = &x;\n    |         ^^^^^\n \n error: `x` is shadowed by itself in `*x`\n-  --> $DIR/shadow.rs:9:9\n+  --> $DIR/shadow.rs:16:9\n    |\n LL |     let x = *x;\n    |         ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:8:9\n+  --> $DIR/shadow.rs:15:9\n    |\n LL |     let x = &mut x;\n    |         ^\n \n error: `x` is shadowed\n-  --> $DIR/shadow.rs:14:9\n+  --> $DIR/shadow.rs:21:9\n    |\n LL |     let x = x.0;\n    |         ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:13:9\n+  --> $DIR/shadow.rs:20:9\n    |\n LL |     let x = ([[0]], ());\n    |         ^\n    = note: `-D clippy::shadow-reuse` implied by `-D warnings`\n \n error: `x` is shadowed\n-  --> $DIR/shadow.rs:15:9\n+  --> $DIR/shadow.rs:22:9\n    |\n LL |     let x = x[0];\n    |         ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:14:9\n+  --> $DIR/shadow.rs:21:9\n    |\n LL |     let x = x.0;\n    |         ^\n \n error: `x` is shadowed\n-  --> $DIR/shadow.rs:16:10\n+  --> $DIR/shadow.rs:23:10\n    |\n LL |     let [x] = x;\n    |          ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:15:9\n+  --> $DIR/shadow.rs:22:9\n    |\n LL |     let x = x[0];\n    |         ^\n \n error: `x` is shadowed\n-  --> $DIR/shadow.rs:17:9\n+  --> $DIR/shadow.rs:24:9\n    |\n LL |     let x = Some(x);\n    |         ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:16:10\n+  --> $DIR/shadow.rs:23:10\n    |\n LL |     let [x] = x;\n    |          ^\n \n error: `x` is shadowed\n-  --> $DIR/shadow.rs:18:9\n+  --> $DIR/shadow.rs:25:9\n    |\n LL |     let x = foo(x);\n    |         ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:17:9\n+  --> $DIR/shadow.rs:24:9\n    |\n LL |     let x = Some(x);\n    |         ^\n \n error: `x` is shadowed\n-  --> $DIR/shadow.rs:19:9\n+  --> $DIR/shadow.rs:26:9\n    |\n LL |     let x = || x;\n    |         ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:18:9\n+  --> $DIR/shadow.rs:25:9\n    |\n LL |     let x = foo(x);\n    |         ^\n \n error: `x` is shadowed\n-  --> $DIR/shadow.rs:20:9\n+  --> $DIR/shadow.rs:27:9\n    |\n LL |     let x = Some(1).map(|_| x)?;\n    |         ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:19:9\n+  --> $DIR/shadow.rs:26:9\n    |\n LL |     let x = || x;\n    |         ^\n \n error: `y` is shadowed\n-  --> $DIR/shadow.rs:22:9\n+  --> $DIR/shadow.rs:29:9\n    |\n LL |     let y = match y {\n    |         ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:21:9\n+  --> $DIR/shadow.rs:28:9\n    |\n LL |     let y = 1;\n    |         ^\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:31:9\n+  --> $DIR/shadow.rs:38:9\n    |\n LL |     let x = 2;\n    |         ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:30:9\n+  --> $DIR/shadow.rs:37:9\n    |\n LL |     let x = 1;\n    |         ^\n    = note: `-D clippy::shadow-unrelated` implied by `-D warnings`\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:36:13\n+  --> $DIR/shadow.rs:43:13\n    |\n LL |         let x = 1;\n    |             ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:35:10\n+  --> $DIR/shadow.rs:42:10\n    |\n LL |     fn f(x: u32) {\n    |          ^\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:41:14\n+  --> $DIR/shadow.rs:48:14\n    |\n LL |         Some(x) => {\n    |              ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:38:9\n+  --> $DIR/shadow.rs:45:9\n    |\n LL |     let x = 1;\n    |         ^\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:42:17\n+  --> $DIR/shadow.rs:49:17\n    |\n LL |             let x = 1;\n    |                 ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:41:14\n+  --> $DIR/shadow.rs:48:14\n    |\n LL |         Some(x) => {\n    |              ^\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:46:17\n+  --> $DIR/shadow.rs:53:17\n    |\n LL |     if let Some(x) = Some(1) {}\n    |                 ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:38:9\n+  --> $DIR/shadow.rs:45:9\n    |\n LL |     let x = 1;\n    |         ^\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:47:20\n+  --> $DIR/shadow.rs:54:20\n    |\n LL |     while let Some(x) = Some(1) {}\n    |                    ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:38:9\n+  --> $DIR/shadow.rs:45:9\n    |\n LL |     let x = 1;\n    |         ^\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:48:15\n+  --> $DIR/shadow.rs:55:15\n    |\n LL |     let _ = |[x]: [u32; 1]| {\n    |               ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:38:9\n+  --> $DIR/shadow.rs:45:9\n    |\n LL |     let x = 1;\n    |         ^\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:49:13\n+  --> $DIR/shadow.rs:56:13\n    |\n LL |         let x = 1;\n    |             ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:48:15\n+  --> $DIR/shadow.rs:55:15\n    |\n LL |     let _ = |[x]: [u32; 1]| {\n    |               ^\n \n error: `y` is shadowed\n-  --> $DIR/shadow.rs:52:17\n+  --> $DIR/shadow.rs:59:17\n    |\n LL |     if let Some(y) = y {}\n    |                 ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:51:9\n+  --> $DIR/shadow.rs:58:9\n    |\n LL |     let y = Some(1);\n    |         ^\n \n error: `_b` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:88:9\n+  --> $DIR/shadow.rs:95:9\n    |\n LL |     let _b = _a;\n    |         ^^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:87:28\n+  --> $DIR/shadow.rs:94:28\n    |\n LL | pub async fn foo2(_a: i32, _b: i64) {\n    |                            ^^\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:94:21\n+  --> $DIR/shadow.rs:101:21\n    |\n LL |         if let Some(x) = Some(1) { x } else { 1 }\n    |                     ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:93:13\n+  --> $DIR/shadow.rs:100:13\n    |\n LL |         let x = 1;\n    |             ^"}]}