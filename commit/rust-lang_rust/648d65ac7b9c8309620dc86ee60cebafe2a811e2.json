{"sha": "648d65ac7b9c8309620dc86ee60cebafe2a811e2", "node_id": "C_kwDOAAsO6NoAKDY0OGQ2NWFjN2I5YzgzMDk2MjBkYzg2ZWU2MGNlYmFmZTJhODExZTI", "commit": {"author": {"name": "Dylan DPC", "email": "99973273+Dylan-DPC@users.noreply.github.com", "date": "2022-04-13T15:35:34Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-04-13T15:35:34Z"}, "message": "Rollup merge of #95991 - PoorlyDefinedBehaviour:fix/issue_95898, r=fee1-dead\n\nfix: wrong trait import suggestion for T:\n\nThe suggestion to bound `T` had an extra `:`.\n\n```rust\nfn foo<T:>(t: T) {\n  t.clone();\n}\n```\n\n```\nerror[E0599]: no method named `clone` found for type parameter `T` in the current scope\n --> src/lib.rs:2:7\n  |\n2 |     t.clone();\n  |       ^^^^^ method not found in `T`\n  |\n  = help: items from traits can only be used if the type parameter is bounded by the trait\nhelp: the following trait defines an item `clone`, perhaps you need to restrict type parameter `T` with it:\n  |\n1 | fn foo<T: Clone:>(t: T) {\n  |        ~~~~~~~~\n ```\n\nFixes: #95898", "tree": {"sha": "a746c3bc511f7f9f3e0f1149525094319dc3c0d4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a746c3bc511f7f9f3e0f1149525094319dc3c0d4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/648d65ac7b9c8309620dc86ee60cebafe2a811e2", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJiVu3HCRBK7hj4Ov3rIwAAE78IAFNbNOpMUO5V42g3Z9UKP+R1\nVOB+SMsEfqxkRka60OMIhAD29OCAcP/Lt5YgKxOm8c2IdUqjRfFw7lR/Pfxn2gpw\nKQH3rwjhRRYqVr/dDFg5jOX2xtJKFjHz3KidsOqNdQZRuAeLmDq/XIDogGiHm/8A\nzLm9K1wn/csKnj663qgmQ1cPmfv6MmYRtr3PRkrxka+0icYHiVYD9XK5l1nhaldR\nYQA/k22/zLpxGBPTGxnhskLO54nqEwXQhhDC5/QSTDiceUkmI4JANVUC2xJFH+G8\nSswjbUavqZ3PvUqPXcnuTiNJQ4Thp6WEnwl6UqtHlNllnQSwFRH2EUcs+L/u5Z4=\n=4ZqZ\n-----END PGP SIGNATURE-----\n", "payload": "tree a746c3bc511f7f9f3e0f1149525094319dc3c0d4\nparent 032358bd30d2eaa31cdec4a40d8a4703fbec22cc\nparent 9b9f6771049ecd30f13138c32f23ba6562a613d5\nauthor Dylan DPC <99973273+Dylan-DPC@users.noreply.github.com> 1649864134 +0200\ncommitter GitHub <noreply@github.com> 1649864134 +0200\n\nRollup merge of #95991 - PoorlyDefinedBehaviour:fix/issue_95898, r=fee1-dead\n\nfix: wrong trait import suggestion for T:\n\nThe suggestion to bound `T` had an extra `:`.\n\n```rust\nfn foo<T:>(t: T) {\n  t.clone();\n}\n```\n\n```\nerror[E0599]: no method named `clone` found for type parameter `T` in the current scope\n --> src/lib.rs:2:7\n  |\n2 |     t.clone();\n  |       ^^^^^ method not found in `T`\n  |\n  = help: items from traits can only be used if the type parameter is bounded by the trait\nhelp: the following trait defines an item `clone`, perhaps you need to restrict type parameter `T` with it:\n  |\n1 | fn foo<T: Clone:>(t: T) {\n  |        ~~~~~~~~\n ```\n\nFixes: #95898\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/648d65ac7b9c8309620dc86ee60cebafe2a811e2", "html_url": "https://github.com/rust-lang/rust/commit/648d65ac7b9c8309620dc86ee60cebafe2a811e2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/648d65ac7b9c8309620dc86ee60cebafe2a811e2/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "032358bd30d2eaa31cdec4a40d8a4703fbec22cc", "url": "https://api.github.com/repos/rust-lang/rust/commits/032358bd30d2eaa31cdec4a40d8a4703fbec22cc", "html_url": "https://github.com/rust-lang/rust/commit/032358bd30d2eaa31cdec4a40d8a4703fbec22cc"}, {"sha": "9b9f6771049ecd30f13138c32f23ba6562a613d5", "url": "https://api.github.com/repos/rust-lang/rust/commits/9b9f6771049ecd30f13138c32f23ba6562a613d5", "html_url": "https://github.com/rust-lang/rust/commit/9b9f6771049ecd30f13138c32f23ba6562a613d5"}], "stats": {"total": 34, "additions": 32, "deletions": 2}, "files": [{"sha": "e6560ca4d9b90e7827e30827220cb075ade931cc", "filename": "compiler/rustc_typeck/src/check/method/suggest.rs", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/648d65ac7b9c8309620dc86ee60cebafe2a811e2/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fsuggest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/648d65ac7b9c8309620dc86ee60cebafe2a811e2/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fsuggest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fsuggest.rs?ref=648d65ac7b9c8309620dc86ee60cebafe2a811e2", "patch": "@@ -1880,9 +1880,15 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                                 };\n                             let sp = hir.span(id);\n                             let sp = if let Some(first_bound) = has_bounds {\n-                                // `sp` only covers `T`, change it so that it covers\n-                                // `T:` when appropriate\n                                 sp.until(first_bound.span())\n+                            } else if let Some(colon_sp) =\n+                                // If the generic param is declared with a colon but without bounds:\n+                                // fn foo<T:>(t: T) { ... }\n+                                param.colon_span_for_suggestions(\n+                                    self.inh.tcx.sess.source_map(),\n+                                )\n+                            {\n+                                sp.to(colon_sp)\n                             } else {\n                                 sp\n                             };"}, {"sha": "41a20b899599a7668d622404cdf3c8487bc93e96", "filename": "src/test/ui/traits/issue-95898.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/648d65ac7b9c8309620dc86ee60cebafe2a811e2/src%2Ftest%2Fui%2Ftraits%2Fissue-95898.rs", "raw_url": "https://github.com/rust-lang/rust/raw/648d65ac7b9c8309620dc86ee60cebafe2a811e2/src%2Ftest%2Fui%2Ftraits%2Fissue-95898.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Fissue-95898.rs?ref=648d65ac7b9c8309620dc86ee60cebafe2a811e2", "patch": "@@ -0,0 +1,9 @@\n+// Test for #95898: The trait suggestion had an extra `:` after the trait.\n+// edition:2021\n+\n+fn foo<T:>(t: T) {\n+    t.clone();\n+    //~^ ERROR no method named `clone` found for type parameter `T` in the current scope\n+}\n+\n+fn main() {}"}, {"sha": "d7d4790539604cfe93ab894a0ac2d305d5ec0e64", "filename": "src/test/ui/traits/issue-95898.stderr", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/648d65ac7b9c8309620dc86ee60cebafe2a811e2/src%2Ftest%2Fui%2Ftraits%2Fissue-95898.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/648d65ac7b9c8309620dc86ee60cebafe2a811e2/src%2Ftest%2Fui%2Ftraits%2Fissue-95898.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Fissue-95898.stderr?ref=648d65ac7b9c8309620dc86ee60cebafe2a811e2", "patch": "@@ -0,0 +1,15 @@\n+error[E0599]: no method named `clone` found for type parameter `T` in the current scope\n+  --> $DIR/issue-95898.rs:5:7\n+   |\n+LL |     t.clone();\n+   |       ^^^^^ method not found in `T`\n+   |\n+   = help: items from traits can only be used if the type parameter is bounded by the trait\n+help: the following trait defines an item `clone`, perhaps you need to restrict type parameter `T` with it:\n+   |\n+LL | fn foo<T: Clone>(t: T) {\n+   |        ~~~~~~~~\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0599`."}]}