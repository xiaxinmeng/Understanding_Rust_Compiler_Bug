{"sha": "9f05f29e564c03a432df78f7c4b6421e4fb1a338", "node_id": "MDY6Q29tbWl0NzI0NzEyOjlmMDVmMjllNTY0YzAzYTQzMmRmNzhmN2M0YjY0MjFlNGZiMWEzMzg=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-07-26T12:50:55Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-07-26T12:59:00Z"}, "message": "Incorporate edition flag testing into tests of `-Z borrowck=migrate`.", "tree": {"sha": "b547ed9933fab23067791d1e5c57563fc8f80d07", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b547ed9933fab23067791d1e5c57563fc8f80d07"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9f05f29e564c03a432df78f7c4b6421e4fb1a338", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9f05f29e564c03a432df78f7c4b6421e4fb1a338", "html_url": "https://github.com/rust-lang/rust/commit/9f05f29e564c03a432df78f7c4b6421e4fb1a338", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9f05f29e564c03a432df78f7c4b6421e4fb1a338/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "94a2972d3f4e727c4e05246b65e4f0d8effe2d41", "url": "https://api.github.com/repos/rust-lang/rust/commits/94a2972d3f4e727c4e05246b65e4f0d8effe2d41", "html_url": "https://github.com/rust-lang/rust/commit/94a2972d3f4e727c4e05246b65e4f0d8effe2d41"}], "stats": {"total": 59, "additions": 52, "deletions": 7}, "files": [{"sha": "fa82efa353384acd66a686043f9a7ff731fe0561", "filename": "src/test/ui/borrowck/borrowck-feature-nll-overrides-migrate.edition.stderr", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9f05f29e564c03a432df78f7c4b6421e4fb1a338/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-feature-nll-overrides-migrate.edition.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/9f05f29e564c03a432df78f7c4b6421e4fb1a338/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-feature-nll-overrides-migrate.edition.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-feature-nll-overrides-migrate.edition.stderr?ref=9f05f29e564c03a432df78f7c4b6421e4fb1a338", "patch": "@@ -1,5 +1,5 @@\n error[E0507]: cannot move out of borrowed content\n-  --> $DIR/borrowck-feature-nll-overrides-migrate.rs:30:17\n+  --> $DIR/borrowck-feature-nll-overrides-migrate.rs:32:17\n    |\n LL |                 (|| { let bar = foo; bar.take() })();\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ cannot move out of borrowed content", "previous_filename": "src/test/ui/borrowck/borrowck-feature-nll-overrides-migrate.stderr"}, {"sha": "72043938f53511f0e441e6c2b8bd6e1045d376a3", "filename": "src/test/ui/borrowck/borrowck-feature-nll-overrides-migrate.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/9f05f29e564c03a432df78f7c4b6421e4fb1a338/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-feature-nll-overrides-migrate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f05f29e564c03a432df78f7c4b6421e4fb1a338/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-feature-nll-overrides-migrate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-feature-nll-overrides-migrate.rs?ref=9f05f29e564c03a432df78f7c4b6421e4fb1a338", "patch": "@@ -18,7 +18,9 @@\n // NLL checks will be emitted as errors *even* in the presence of `-Z\n // borrowck=migrate`.\n \n-// compile-flags: -Z borrowck=migrate\n+// revisions: zflag edition\n+// [zflag]compile-flags: -Z borrowck=migrate\n+// [edition]compile-flags: --edition 2018\n \n #![feature(nll)]\n \n@@ -28,7 +30,8 @@ fn main() {\n         ref mut foo\n             if {\n                 (|| { let bar = foo; bar.take() })();\n-                //~^ ERROR cannot move out of borrowed content [E0507]\n+                //[zflag]~^ ERROR cannot move out of borrowed content [E0507]\n+                //[edition]~^^ ERROR cannot move out of borrowed content [E0507]\n                 false\n             } => {},\n         Some(ref _s) => println!(\"Note this arm is bogus; the `Some` became `None` in the guard.\"),"}, {"sha": "fa82efa353384acd66a686043f9a7ff731fe0561", "filename": "src/test/ui/borrowck/borrowck-feature-nll-overrides-migrate.zflag.stderr", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/9f05f29e564c03a432df78f7c4b6421e4fb1a338/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-feature-nll-overrides-migrate.zflag.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/9f05f29e564c03a432df78f7c4b6421e4fb1a338/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-feature-nll-overrides-migrate.zflag.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-feature-nll-overrides-migrate.zflag.stderr?ref=9f05f29e564c03a432df78f7c4b6421e4fb1a338", "patch": "@@ -0,0 +1,9 @@\n+error[E0507]: cannot move out of borrowed content\n+  --> $DIR/borrowck-feature-nll-overrides-migrate.rs:32:17\n+   |\n+LL |                 (|| { let bar = foo; bar.take() })();\n+   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ cannot move out of borrowed content\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0507`."}, {"sha": "f5a9db364065fab0b5da3b2f8589ec7f3e92f155", "filename": "src/test/ui/borrowck/borrowck-migrate-to-nll.edition.stderr", "status": "renamed", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9f05f29e564c03a432df78f7c4b6421e4fb1a338/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-migrate-to-nll.edition.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/9f05f29e564c03a432df78f7c4b6421e4fb1a338/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-migrate-to-nll.edition.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-migrate-to-nll.edition.stderr?ref=9f05f29e564c03a432df78f7c4b6421e4fb1a338", "patch": "@@ -1,5 +1,5 @@\n warning[E0507]: cannot move out of borrowed content\n-  --> $DIR/borrowck-migrate-to-nll.rs:26:17\n+  --> $DIR/borrowck-migrate-to-nll.rs:35:17\n    |\n LL |                 (|| { let bar = foo; bar.take() })();\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ cannot move out of borrowed content\n@@ -9,7 +9,7 @@ LL |                 (|| { let bar = foo; bar.take() })();\n            This warning will become a hard error in the future.\n \n warning[E0507]: cannot move out of `foo`, as it is immutable for the pattern guard\n-  --> $DIR/borrowck-migrate-to-nll.rs:26:17\n+  --> $DIR/borrowck-migrate-to-nll.rs:35:17\n    |\n LL |                 (|| { let bar = foo; bar.take() })();\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^", "previous_filename": "src/test/ui/borrowck/borrowck-migrate-to-nll.stderr"}, {"sha": "e7f2bfbfedba79bd74840fe89c9c01ea140e4a09", "filename": "src/test/ui/borrowck/borrowck-migrate-to-nll.rs", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/9f05f29e564c03a432df78f7c4b6421e4fb1a338/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-migrate-to-nll.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f05f29e564c03a432df78f7c4b6421e4fb1a338/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-migrate-to-nll.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-migrate-to-nll.rs?ref=9f05f29e564c03a432df78f7c4b6421e4fb1a338", "patch": "@@ -15,8 +15,17 @@\n // Therefore, for backwards-compatiblity, under borrowck=migrate the\n // NLL checks will be emitted as *warnings*.\n \n-// compile-flags: -Z borrowck=migrate\n-// run-pass\n+// NLL mode makes this compile-fail; we cannot currently encode a\n+// test that is run-pass or compile-fail based on compare-mode. So\n+// just ignore it instead:\n+\n+// ignore-compare-mode-nll\n+\n+// revisions: zflag edition\n+//[zflag]compile-flags: -Z borrowck=migrate\n+//[edition]compile-flags: --edition 2018\n+//[zflag] run-pass\n+//[edition] run-pass\n \n fn main() {\n     match Some(&4) {"}, {"sha": "f5a9db364065fab0b5da3b2f8589ec7f3e92f155", "filename": "src/test/ui/borrowck/borrowck-migrate-to-nll.zflag.stderr", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/9f05f29e564c03a432df78f7c4b6421e4fb1a338/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-migrate-to-nll.zflag.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/9f05f29e564c03a432df78f7c4b6421e4fb1a338/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-migrate-to-nll.zflag.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-migrate-to-nll.zflag.stderr?ref=9f05f29e564c03a432df78f7c4b6421e4fb1a338", "patch": "@@ -0,0 +1,24 @@\n+warning[E0507]: cannot move out of borrowed content\n+  --> $DIR/borrowck-migrate-to-nll.rs:35:17\n+   |\n+LL |                 (|| { let bar = foo; bar.take() })();\n+   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ cannot move out of borrowed content\n+   |\n+   = warning: This error has been downgraded to a warning for backwards compatibility with previous releases.\n+           It represents potential unsoundness in your code.\n+           This warning will become a hard error in the future.\n+\n+warning[E0507]: cannot move out of `foo`, as it is immutable for the pattern guard\n+  --> $DIR/borrowck-migrate-to-nll.rs:35:17\n+   |\n+LL |                 (|| { let bar = foo; bar.take() })();\n+   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |                 |\n+   |                 cannot move out of `foo`, as it is immutable for the pattern guard\n+   |                 cannot move\n+   |\n+   = note: variables bound in patterns are immutable until the end of the pattern guard\n+   = warning: This error has been downgraded to a warning for backwards compatibility with previous releases.\n+           It represents potential unsoundness in your code.\n+           This warning will become a hard error in the future.\n+"}]}