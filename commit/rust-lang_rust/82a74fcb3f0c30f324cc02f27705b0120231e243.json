{"sha": "82a74fcb3f0c30f324cc02f27705b0120231e243", "node_id": "MDY6Q29tbWl0NzI0NzEyOjgyYTc0ZmNiM2YwYzMwZjMyNGNjMDJmMjc3MDViMDEyMDIzMWUyNDM=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-06-28T23:32:41Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-06-28T23:55:07Z"}, "message": "Remove the last traces of the distinction between export / local meta items\n\nIssue #487", "tree": {"sha": "53ca874c82ea3ff6d64dd13997a826b4c4581bf1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/53ca874c82ea3ff6d64dd13997a826b4c4581bf1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/82a74fcb3f0c30f324cc02f27705b0120231e243", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/82a74fcb3f0c30f324cc02f27705b0120231e243", "html_url": "https://github.com/rust-lang/rust/commit/82a74fcb3f0c30f324cc02f27705b0120231e243", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/82a74fcb3f0c30f324cc02f27705b0120231e243/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dfcfef41df58108ee75067afaa63bbbcf43e38f8", "url": "https://api.github.com/repos/rust-lang/rust/commits/dfcfef41df58108ee75067afaa63bbbcf43e38f8", "html_url": "https://github.com/rust-lang/rust/commit/dfcfef41df58108ee75067afaa63bbbcf43e38f8"}], "stats": {"total": 30, "additions": 0, "deletions": 30}, "files": [{"sha": "f40a297c1e4a2b11ed99edbceac2643c6e61dca6", "filename": "src/comp/metadata/decoder.rs", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/82a74fcb3f0c30f324cc02f27705b0120231e243/src%2Fcomp%2Fmetadata%2Fdecoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/82a74fcb3f0c30f324cc02f27705b0120231e243/src%2Fcomp%2Fmetadata%2Fdecoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmetadata%2Fdecoder.rs?ref=82a74fcb3f0c30f324cc02f27705b0120231e243", "patch": "@@ -316,11 +316,6 @@ fn list_meta_items(&ebml::doc meta_items, io::writer out) {\n fn list_crate_attributes(&ebml::doc md, io::writer out) {\n     out.write_str(\"=Crate=\");\n \n-    // FIXME (#487): This is transitional until attributes are snapshotted\n-    out.write_str(\"old-style:\\n\");\n-    auto meta_items = ebml::get_doc(md, tag_meta_export);\n-    list_meta_items(meta_items, out);\n-\n     for (ast::attribute attr in get_attributes(md)) {\n         out.write_str(#fmt(\"%s\", pprust::attribute_to_str(attr)));\n     }"}, {"sha": "faa98066a6e00d731474898c34d2acb726975f2d", "filename": "src/comp/metadata/encoder.rs", "status": "modified", "additions": 0, "deletions": 21, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/82a74fcb3f0c30f324cc02f27705b0120231e243/src%2Fcomp%2Fmetadata%2Fencoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/82a74fcb3f0c30f324cc02f27705b0120231e243/src%2Fcomp%2Fmetadata%2Fencoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmetadata%2Fencoder.rs?ref=82a74fcb3f0c30f324cc02f27705b0120231e243", "patch": "@@ -457,32 +457,11 @@ fn encode_attributes(&ebml::writer ebml_w, &vec[attribute] attrs) {\n     ebml::end_tag(ebml_w);\n }\n \n-// FIXME (#487): Transitional\n-fn encode_meta_items(&ebml::writer ebml_w, &crate crate) {\n-    auto name = middle::attr::find_attrs_by_name(crate.node.attrs,\n-                                                 \"name\");\n-    auto value = middle::attr::find_attrs_by_name(crate.node.attrs,\n-                                                 \"value\");\n-    auto name_and_val = middle::attr::attr_metas(name + value);\n-\n-    ebml::start_tag(ebml_w, tag_meta_export);\n-    for (@meta_item mi in name_and_val) {\n-        encode_meta_item(ebml_w, *mi);\n-    }\n-    ebml::end_tag(ebml_w);\n-    ebml::start_tag(ebml_w, tag_meta_local);\n-    ebml::end_tag(ebml_w);\n-}\n-\n fn encode_metadata(&@crate_ctxt cx, &@crate crate) -> str {\n     auto string_w = io::string_writer();\n     auto buf_w = string_w.get_writer().get_buf_writer();\n     auto ebml_w = ebml::create_writer(buf_w);\n \n-    // FIXME: This is the old way of encoding crate meta items\n-    // Remove after going through a snapshot cycle\n-    encode_meta_items(ebml_w, *crate);\n-    // Encode crate attributes\n     encode_attributes(ebml_w, crate.node.attrs);\n     // Encode and index the paths.\n "}, {"sha": "27b93da73b315f5f0724792cd090cb295c241dd6", "filename": "src/comp/metadata/tags.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/82a74fcb3f0c30f324cc02f27705b0120231e243/src%2Fcomp%2Fmetadata%2Ftags.rs", "raw_url": "https://github.com/rust-lang/rust/raw/82a74fcb3f0c30f324cc02f27705b0120231e243/src%2Fcomp%2Fmetadata%2Ftags.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmetadata%2Ftags.rs?ref=82a74fcb3f0c30f324cc02f27705b0120231e243", "patch": "@@ -40,10 +40,6 @@ const uint tag_index_buckets_bucket_elt = 0x14u;\n \n const uint tag_index_table = 0x15u;\n \n-const uint tag_meta_export = 0x16u;\n-\n-const uint tag_meta_local = 0x17u;\n-\n const uint tag_meta_item_name_value = 0x18u;\n \n const uint tag_meta_item_name = 0x19u;"}]}