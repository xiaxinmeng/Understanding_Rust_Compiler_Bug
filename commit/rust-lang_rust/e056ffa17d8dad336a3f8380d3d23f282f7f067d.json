{"sha": "e056ffa17d8dad336a3f8380d3d23f282f7f067d", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUwNTZmZmExN2Q4ZGFkMzM2YTNmODM4MGQzZDIzZjI4MmY3ZjA2N2Q=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-12-07T21:29:04Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-12-07T21:33:00Z"}, "message": "Inject the view_items for core in the right place, add comment documenting why the wrong place was wrong.", "tree": {"sha": "f2f226ffc1ada86f906ae96363d9cdfc0de7cc78", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f2f226ffc1ada86f906ae96363d9cdfc0de7cc78"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e056ffa17d8dad336a3f8380d3d23f282f7f067d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e056ffa17d8dad336a3f8380d3d23f282f7f067d", "html_url": "https://github.com/rust-lang/rust/commit/e056ffa17d8dad336a3f8380d3d23f282f7f067d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e056ffa17d8dad336a3f8380d3d23f282f7f067d/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "799690bea0dbcf427bf7a9a813fec163eedf217d", "url": "https://api.github.com/repos/rust-lang/rust/commits/799690bea0dbcf427bf7a9a813fec163eedf217d", "html_url": "https://github.com/rust-lang/rust/commit/799690bea0dbcf427bf7a9a813fec163eedf217d"}], "stats": {"total": 15, "additions": 10, "deletions": 5}, "files": [{"sha": "03086444419c3fcc0a05b476e47b1267ede4c5ce", "filename": "src/comp/driver/rustc.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/e056ffa17d8dad336a3f8380d3d23f282f7f067d/src%2Fcomp%2Fdriver%2Frustc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e056ffa17d8dad336a3f8380d3d23f282f7f067d/src%2Fcomp%2Fdriver%2Frustc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fdriver%2Frustc.rs?ref=e056ffa17d8dad336a3f8380d3d23f282f7f067d", "patch": "@@ -123,12 +123,10 @@ fn inject_libcore_reference(sess: session::session,\n     let vi1 = spanned(ast::view_item_use(\"core\", [], n1));\n     let vi2 = spanned(ast::view_item_import_glob(@[\"core\"], n2));\n \n-    let cd1 = spanned(ast::cdir_view_item(vi1));\n-    let cd2 = spanned(ast::cdir_view_item(vi2));\n+    let vis = [vi1, vi2] + crate.node.module.view_items;\n \n-    let cdirs = [cd1, cd2] + crate.node.directives;\n-\n-    ret @{node: {directives: cdirs with crate.node} with *crate }\n+    ret @{node: {module: { view_items: vis with crate.node.module }\n+                 with crate.node} with *crate }\n }\n \n "}, {"sha": "be3bf5b5ee0b6c4ce7e80676d3c82b274ef9da15", "filename": "src/comp/syntax/ast.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/e056ffa17d8dad336a3f8380d3d23f282f7f067d/src%2Fcomp%2Fsyntax%2Fast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e056ffa17d8dad336a3f8380d3d23f282f7f067d/src%2Fcomp%2Fsyntax%2Fast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fsyntax%2Fast.rs?ref=e056ffa17d8dad336a3f8380d3d23f282f7f067d", "patch": "@@ -60,7 +60,14 @@ type crate_ =\n tag crate_directive_ {\n     cdir_src_mod(ident, [attribute]);\n     cdir_dir_mod(ident, [@crate_directive], [attribute]);\n+\n+    // NB: cdir_view_item is *not* processed by the rest of the compiler; the\n+    // attached view_items are sunk into the crate's module during parsing,\n+    // and processed (resolved, imported, etc.) there. This tag-variant exists\n+    // only to preserve the view items in order in case we decide to\n+    // pretty-print crates in the future.\n     cdir_view_item(@view_item);\n+\n     cdir_syntax(@path);\n }\n "}]}