{"sha": "12597428658fc7b72244e8717d0ca6fc83fca11c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEyNTk3NDI4NjU4ZmM3YjcyMjQ0ZTg3MTdkMGNhNmZjODNmY2ExMWM=", "commit": {"author": {"name": "Hudson Ayers", "email": "hudsonayers@google.com", "date": "2021-07-27T13:54:51Z"}, "committer": {"name": "Hudson Ayers", "email": "hudsonayers@google.com", "date": "2021-07-27T14:53:02Z"}, "message": "bootstrap.py: remove unused `git log` option\n\nWhen determining which LLVM artifacts to download, bootstrap.py\ncalls: `git log --author=bors --format=%H -n1 -m --first-parent --\nsrc/llvm-project src/bootstrap/download-ci-llvm-stamp src/version`.\nHowever, the `-m` option has no effect, per the `git log` help:\n\n> -m\n> This option makes diff output for merge commits to be shown in the\n> default format. -m will produce the output only if -p is given as\n> well. The default format could be changed using log.diffMerges\n> configuration parameter, which default value is separate.\n\nAccordingly, this commit removes use of the -m option in favor of\n`--no-patch`, to make clear that this command should never output\ndiff information, as the SHA-1 hash is the only desired output.\nTested using git 2.32, this does not change the\noutput of the command.\n\nThe motivation for this change is that some patched versions of git\nchange the behavior of the `-m` flag to imply `-p`, rather than to do\nnothing unless `-p` is passed. These patched versions of git lead to\nthis script not working. Google's corp-provided git is one such example.", "tree": {"sha": "80f0931a3b261fa9c8cf92c9f3ce1fb433703c6a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/80f0931a3b261fa9c8cf92c9f3ce1fb433703c6a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/12597428658fc7b72244e8717d0ca6fc83fca11c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/12597428658fc7b72244e8717d0ca6fc83fca11c", "html_url": "https://github.com/rust-lang/rust/commit/12597428658fc7b72244e8717d0ca6fc83fca11c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/12597428658fc7b72244e8717d0ca6fc83fca11c/comments", "author": {"login": "hudson-ayers", "id": 32688905, "node_id": "MDQ6VXNlcjMyNjg4OTA1", "avatar_url": "https://avatars.githubusercontent.com/u/32688905?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hudson-ayers", "html_url": "https://github.com/hudson-ayers", "followers_url": "https://api.github.com/users/hudson-ayers/followers", "following_url": "https://api.github.com/users/hudson-ayers/following{/other_user}", "gists_url": "https://api.github.com/users/hudson-ayers/gists{/gist_id}", "starred_url": "https://api.github.com/users/hudson-ayers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hudson-ayers/subscriptions", "organizations_url": "https://api.github.com/users/hudson-ayers/orgs", "repos_url": "https://api.github.com/users/hudson-ayers/repos", "events_url": "https://api.github.com/users/hudson-ayers/events{/privacy}", "received_events_url": "https://api.github.com/users/hudson-ayers/received_events", "type": "User", "site_admin": false}, "committer": {"login": "hudson-ayers", "id": 32688905, "node_id": "MDQ6VXNlcjMyNjg4OTA1", "avatar_url": "https://avatars.githubusercontent.com/u/32688905?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hudson-ayers", "html_url": "https://github.com/hudson-ayers", "followers_url": "https://api.github.com/users/hudson-ayers/followers", "following_url": "https://api.github.com/users/hudson-ayers/following{/other_user}", "gists_url": "https://api.github.com/users/hudson-ayers/gists{/gist_id}", "starred_url": "https://api.github.com/users/hudson-ayers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hudson-ayers/subscriptions", "organizations_url": "https://api.github.com/users/hudson-ayers/orgs", "repos_url": "https://api.github.com/users/hudson-ayers/repos", "events_url": "https://api.github.com/users/hudson-ayers/events{/privacy}", "received_events_url": "https://api.github.com/users/hudson-ayers/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fc24bcead1d401ae061538d011e4a319c4195b56", "url": "https://api.github.com/repos/rust-lang/rust/commits/fc24bcead1d401ae061538d011e4a319c4195b56", "html_url": "https://github.com/rust-lang/rust/commit/fc24bcead1d401ae061538d011e4a319c4195b56"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "f2e38a7eab6bc8c92f7de53d4f935bb74c61d035", "filename": "src/bootstrap/bootstrap.py", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/12597428658fc7b72244e8717d0ca6fc83fca11c/src%2Fbootstrap%2Fbootstrap.py", "raw_url": "https://github.com/rust-lang/rust/raw/12597428658fc7b72244e8717d0ca6fc83fca11c/src%2Fbootstrap%2Fbootstrap.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbootstrap.py?ref=12597428658fc7b72244e8717d0ca6fc83fca11c", "patch": "@@ -473,7 +473,7 @@ def download_toolchain(self, stage0=True, rustc_channel=None):\n             ]).decode(sys.getdefaultencoding()).strip()\n             llvm_sha = subprocess.check_output([\n                 \"git\", \"log\", \"--author=bors\", \"--format=%H\", \"-n1\",\n-                \"-m\", \"--first-parent\",\n+                \"--no-patch\", \"--first-parent\",\n                 \"--\",\n                 \"{}/src/llvm-project\".format(top_level),\n                 \"{}/src/bootstrap/download-ci-llvm-stamp\".format(top_level),"}]}