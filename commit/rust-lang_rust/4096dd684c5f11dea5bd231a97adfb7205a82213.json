{"sha": "4096dd684c5f11dea5bd231a97adfb7205a82213", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQwOTZkZDY4NGM1ZjExZGVhNWJkMjMxYTk3YWRmYjcyMDVhODIyMTM=", "commit": {"author": {"name": "Chris Krycho", "email": "chris@chriskrycho.com", "date": "2017-02-08T19:30:31Z"}, "committer": {"name": "Chris Krycho", "email": "chris@chriskrycho.com", "date": "2017-02-08T19:30:31Z"}, "message": "Add more examples, get everything passing at last.", "tree": {"sha": "9e3847e062333754ea9128f5c3a10acf0bf5f0b2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9e3847e062333754ea9128f5c3a10acf0bf5f0b2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4096dd684c5f11dea5bd231a97adfb7205a82213", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4096dd684c5f11dea5bd231a97adfb7205a82213", "html_url": "https://github.com/rust-lang/rust/commit/4096dd684c5f11dea5bd231a97adfb7205a82213", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4096dd684c5f11dea5bd231a97adfb7205a82213/comments", "author": {"login": "chriskrycho", "id": 2403023, "node_id": "MDQ6VXNlcjI0MDMwMjM=", "avatar_url": "https://avatars.githubusercontent.com/u/2403023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chriskrycho", "html_url": "https://github.com/chriskrycho", "followers_url": "https://api.github.com/users/chriskrycho/followers", "following_url": "https://api.github.com/users/chriskrycho/following{/other_user}", "gists_url": "https://api.github.com/users/chriskrycho/gists{/gist_id}", "starred_url": "https://api.github.com/users/chriskrycho/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chriskrycho/subscriptions", "organizations_url": "https://api.github.com/users/chriskrycho/orgs", "repos_url": "https://api.github.com/users/chriskrycho/repos", "events_url": "https://api.github.com/users/chriskrycho/events{/privacy}", "received_events_url": "https://api.github.com/users/chriskrycho/received_events", "type": "User", "site_admin": false}, "committer": {"login": "chriskrycho", "id": 2403023, "node_id": "MDQ6VXNlcjI0MDMwMjM=", "avatar_url": "https://avatars.githubusercontent.com/u/2403023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chriskrycho", "html_url": "https://github.com/chriskrycho", "followers_url": "https://api.github.com/users/chriskrycho/followers", "following_url": "https://api.github.com/users/chriskrycho/following{/other_user}", "gists_url": "https://api.github.com/users/chriskrycho/gists{/gist_id}", "starred_url": "https://api.github.com/users/chriskrycho/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chriskrycho/subscriptions", "organizations_url": "https://api.github.com/users/chriskrycho/orgs", "repos_url": "https://api.github.com/users/chriskrycho/repos", "events_url": "https://api.github.com/users/chriskrycho/events{/privacy}", "received_events_url": "https://api.github.com/users/chriskrycho/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3f0ca5578051f67046abb04d053118439b162f87", "url": "https://api.github.com/repos/rust-lang/rust/commits/3f0ca5578051f67046abb04d053118439b162f87", "html_url": "https://github.com/rust-lang/rust/commit/3f0ca5578051f67046abb04d053118439b162f87"}], "stats": {"total": 39, "additions": 33, "deletions": 6}, "files": [{"sha": "4910313af93032a8651160acdecadbe04de8ac2f", "filename": "src/doc/reference.md", "status": "modified", "additions": 33, "deletions": 6, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/4096dd684c5f11dea5bd231a97adfb7205a82213/src%2Fdoc%2Freference.md", "raw_url": "https://github.com/rust-lang/rust/raw/4096dd684c5f11dea5bd231a97adfb7205a82213/src%2Fdoc%2Freference.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Freference.md?ref=4096dd684c5f11dea5bd231a97adfb7205a82213", "patch": "@@ -1271,10 +1271,12 @@ guaranteed to refer to the same memory address.\n \n Constant values must not have destructors, and otherwise permit most forms of\n data. Constants may refer to the address of other constants, in which case the\n-address will have the `static` lifetime. (See below on [static lifetime\n-elision](#static-lifetime-elision).) The compiler is, however, still at \n-liberty to translate the constant many times, so the address referred to may not\n-be stable.\n+address will have elided lifetimes where applicable, otherwise \u2013 in most cases \u2013\n+defaulting to the `static` lifetime. (See below on [static lifetime elision].)\n+The compiler is, however, still at liberty to translate the constant many times,\n+so the address referred to may not be stable.\n+\n+[static lifetime elision]: #static-lifetime-elision\n \n Constants must be explicitly typed. The type may be `bool`, `char`, a number, or\n a type derived from those primitive types. The derived types are references with\n@@ -1298,6 +1300,8 @@ const BITS_N_STRINGS: BitsNStrings<'static> = BitsNStrings {\n };\n ```\n \n+\n+\n ### Static items\n \n A *static item* is similar to a *constant*, except that it represents a precise\n@@ -1364,7 +1368,7 @@ such, the constant declarations involving `'static` above may be written\n without the lifetimes. Returning to our previous example:\n \n ```rust\n-#[feature(static_in_const)]\n+# #![feature(static_in_const)]\n const BIT1: u32 = 1 << 0;\n const BIT2: u32 = 1 << 1;\n \n@@ -1382,6 +1386,27 @@ const BITS_N_STRINGS: BitsNStrings = BitsNStrings {\n };\n ```\n \n+Note that if the `static` or `const` items include function or closure\n+references, which themselves include references, the compiler will first try the\n+standard elision rules ([see discussion in the nomicon][elision-nomicon]). If it\n+is unable to resolve the lifetimes by its usual rules, it will default to using\n+the `'static` lifetime. By way of example:\n+\n+[elision-nomicon]: https://doc.rust-lang.org/nomicon/lifetime-elision.html\n+\n+```rust,ignore\n+// Resolved as `fn<'a>(&'a str) -> &'a str`.\n+const RESOLVED_SINGLE: fn(&str) -> &str = ..\n+\n+// Resolved as `Fn<'a, 'b, 'c>(&'a Foo, &'b Bar, &'c Baz) -> usize`.\n+const RESOLVED_MULTIPLE: Fn(&Foo, &Bar, &Baz) -> usize = ..\n+\n+// There is insufficient information to bound the return reference lifetime\n+// relative to the argument lifetimes, so the signature is resolved as\n+// `Fn(&'static Foo, &'static Bar) -> &'static Baz`.\n+const RESOLVED_STATIC: Fn(&Foo, &Bar) -> &Baz = ..\n+```\n+\n ### Traits\n \n A _trait_ describes an abstract interface that types can\n@@ -2079,7 +2104,9 @@ macro scope.\n \n ### Miscellaneous attributes\n \n-- `deprecated` - mark the item as deprecated; the full attribute is `#[deprecated(since = \"crate version\", note = \"...\")`, where both arguments are optional.\n+- `deprecated` - mark the item as deprecated; the full attribute is \n+  `#[deprecated(since = \"crate version\", note = \"...\")`, where both arguments \n+  are optional.\n - `export_name` - on statics and functions, this determines the name of the\n   exported symbol.\n - `link_section` - on statics and functions, this specifies the section of the"}]}