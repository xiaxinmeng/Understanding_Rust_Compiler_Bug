{"sha": "ee691e02c3031ec27e4136f9f1a9bddecd15cb20", "node_id": "C_kwDOAAsO6NoAKGVlNjkxZTAyYzMwMzFlYzI3ZTQxMzZmOWYxYTliZGRlY2QxNWNiMjA", "commit": {"author": {"name": "Rageking8", "email": "tomleetyt@gmail.com", "date": "2022-10-04T08:13:50Z"}, "committer": {"name": "Rageking8", "email": "tomleetyt@gmail.com", "date": "2022-10-04T08:15:09Z"}, "message": "add test for #102605", "tree": {"sha": "83ab9d8f13efdfed7eee383247bfb51bbb59f3ac", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/83ab9d8f13efdfed7eee383247bfb51bbb59f3ac"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ee691e02c3031ec27e4136f9f1a9bddecd15cb20", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ee691e02c3031ec27e4136f9f1a9bddecd15cb20", "html_url": "https://github.com/rust-lang/rust/commit/ee691e02c3031ec27e4136f9f1a9bddecd15cb20", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ee691e02c3031ec27e4136f9f1a9bddecd15cb20/comments", "author": {"login": "Rageking8", "id": 106309953, "node_id": "U_kgDOBlYpQQ", "avatar_url": "https://avatars.githubusercontent.com/u/106309953?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Rageking8", "html_url": "https://github.com/Rageking8", "followers_url": "https://api.github.com/users/Rageking8/followers", "following_url": "https://api.github.com/users/Rageking8/following{/other_user}", "gists_url": "https://api.github.com/users/Rageking8/gists{/gist_id}", "starred_url": "https://api.github.com/users/Rageking8/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Rageking8/subscriptions", "organizations_url": "https://api.github.com/users/Rageking8/orgs", "repos_url": "https://api.github.com/users/Rageking8/repos", "events_url": "https://api.github.com/users/Rageking8/events{/privacy}", "received_events_url": "https://api.github.com/users/Rageking8/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Rageking8", "id": 106309953, "node_id": "U_kgDOBlYpQQ", "avatar_url": "https://avatars.githubusercontent.com/u/106309953?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Rageking8", "html_url": "https://github.com/Rageking8", "followers_url": "https://api.github.com/users/Rageking8/followers", "following_url": "https://api.github.com/users/Rageking8/following{/other_user}", "gists_url": "https://api.github.com/users/Rageking8/gists{/gist_id}", "starred_url": "https://api.github.com/users/Rageking8/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Rageking8/subscriptions", "organizations_url": "https://api.github.com/users/Rageking8/orgs", "repos_url": "https://api.github.com/users/Rageking8/repos", "events_url": "https://api.github.com/users/Rageking8/events{/privacy}", "received_events_url": "https://api.github.com/users/Rageking8/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d9f8b4b98503e3f88623eb59d4f20432161b840a", "url": "https://api.github.com/repos/rust-lang/rust/commits/d9f8b4b98503e3f88623eb59d4f20432161b840a", "html_url": "https://github.com/rust-lang/rust/commit/d9f8b4b98503e3f88623eb59d4f20432161b840a"}], "stats": {"total": 56, "additions": 56, "deletions": 0}, "files": [{"sha": "3bbdf35af8f90630a134c2876d818a95403c6941", "filename": "src/test/ui/impl-trait/issue-102605.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/ee691e02c3031ec27e4136f9f1a9bddecd15cb20/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-102605.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ee691e02c3031ec27e4136f9f1a9bddecd15cb20/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-102605.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-102605.rs?ref=ee691e02c3031ec27e4136f9f1a9bddecd15cb20", "patch": "@@ -0,0 +1,15 @@\n+// edition:2021\n+\n+async fn foo() -> Result<(), String> {\n+    Ok(())\n+}\n+\n+fn convert_result<T, E>(r: Result<T, E>) -> Option<T> {\n+    None\n+}\n+\n+fn main() -> Option<()> {\n+    //~^ ERROR `main` has invalid return type `Option<()>`\n+    convert_result(foo())\n+    //~^ ERROR mismatched types\n+}"}, {"sha": "d4aba914908fdd6fd1d821df254bb09678beb389", "filename": "src/test/ui/impl-trait/issue-102605.stderr", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/rust-lang/rust/blob/ee691e02c3031ec27e4136f9f1a9bddecd15cb20/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-102605.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ee691e02c3031ec27e4136f9f1a9bddecd15cb20/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-102605.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissue-102605.stderr?ref=ee691e02c3031ec27e4136f9f1a9bddecd15cb20", "patch": "@@ -0,0 +1,41 @@\n+error[E0308]: mismatched types\n+  --> $DIR/issue-102605.rs:13:20\n+   |\n+LL |     convert_result(foo())\n+   |     -------------- ^^^^^ expected enum `Result`, found opaque type\n+   |     |\n+   |     arguments to this function are incorrect\n+   |\n+note: while checking the return type of the `async fn`\n+  --> $DIR/issue-102605.rs:3:19\n+   |\n+LL | async fn foo() -> Result<(), String> {\n+   |                   ^^^^^^^^^^^^^^^^^^ checked the `Output` of this `async fn`, found opaque type\n+   = note:     expected enum `Result<(), _>`\n+           found opaque type `impl Future<Output = Result<(), String>>`\n+note: function defined here\n+  --> $DIR/issue-102605.rs:7:4\n+   |\n+LL | fn convert_result<T, E>(r: Result<T, E>) -> Option<T> {\n+   |    ^^^^^^^^^^^^^^       ---------------\n+help: consider `await`ing on the `Future`\n+   |\n+LL |     convert_result(foo().await)\n+   |                         ++++++\n+help: try wrapping the expression in `Err`\n+   |\n+LL |     convert_result(Err(foo()))\n+   |                    ++++     +\n+\n+error[E0277]: `main` has invalid return type `Option<()>`\n+  --> $DIR/issue-102605.rs:11:14\n+   |\n+LL | fn main() -> Option<()> {\n+   |              ^^^^^^^^^^ `main` can only return types that implement `Termination`\n+   |\n+   = help: consider using `()`, or a `Result`\n+\n+error: aborting due to 2 previous errors\n+\n+Some errors have detailed explanations: E0277, E0308.\n+For more information about an error, try `rustc --explain E0277`."}]}