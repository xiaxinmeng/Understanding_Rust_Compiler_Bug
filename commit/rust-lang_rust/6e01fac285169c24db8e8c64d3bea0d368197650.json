{"sha": "6e01fac285169c24db8e8c64d3bea0d368197650", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZlMDFmYWMyODUxNjljMjRkYjhlOGM2NGQzYmVhMGQzNjgxOTc2NTA=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2016-05-27T22:08:00Z"}, "committer": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2016-05-27T22:08:00Z"}, "message": "Merge pull request #1008 from rust-lang-nursery/hrtb\n\nDon't ignore universal quantification in function types", "tree": {"sha": "4f295dccb32ced86c793f3d52d218a491a486a32", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4f295dccb32ced86c793f3d52d218a491a486a32"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6e01fac285169c24db8e8c64d3bea0d368197650", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6e01fac285169c24db8e8c64d3bea0d368197650", "html_url": "https://github.com/rust-lang/rust/commit/6e01fac285169c24db8e8c64d3bea0d368197650", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6e01fac285169c24db8e8c64d3bea0d368197650/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d633e831ba0f4b28fdd60b2b2b86ea2ca7030657", "url": "https://api.github.com/repos/rust-lang/rust/commits/d633e831ba0f4b28fdd60b2b2b86ea2ca7030657", "html_url": "https://github.com/rust-lang/rust/commit/d633e831ba0f4b28fdd60b2b2b86ea2ca7030657"}, {"sha": "0fae34dfa1e969052782831e39c5eb111e92502f", "url": "https://api.github.com/repos/rust-lang/rust/commits/0fae34dfa1e969052782831e39c5eb111e92502f", "html_url": "https://github.com/rust-lang/rust/commit/0fae34dfa1e969052782831e39c5eb111e92502f"}], "stats": {"total": 80, "additions": 54, "deletions": 26}, "files": [{"sha": "e1ca0e05ddd95c190160eea877a4ff8184a2d6aa", "filename": "Cargo.lock", "status": "modified", "additions": 37, "deletions": 25, "changes": 62, "blob_url": "https://github.com/rust-lang/rust/blob/6e01fac285169c24db8e8c64d3bea0d368197650/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/6e01fac285169c24db8e8c64d3bea0d368197650/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=6e01fac285169c24db8e8c64d3bea0d368197650", "patch": "@@ -6,18 +6,18 @@ dependencies = [\n  \"env_logger 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"getopts 0.2.14 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"regex 0.1.63 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"regex 0.1.71 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rustc-serialize 0.3.19 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"strings 0.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"syntex_syntax 0.32.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"term 0.4.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"toml 0.1.28 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"toml 0.1.30 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"unicode-segmentation 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n name = \"aho-corasick\"\n-version = \"0.5.1\"\n+version = \"0.5.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"memchr 0.1.11 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -39,7 +39,7 @@ version = \"0.3.3\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"log 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"regex 0.1.63 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"regex 0.1.71 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -49,16 +49,16 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"kernel32-sys\"\n-version = \"0.2.1\"\n+version = \"0.2.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"winapi 0.2.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.2.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"winapi-build 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n name = \"libc\"\n-version = \"0.2.9\"\n+version = \"0.2.11\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n@@ -71,29 +71,24 @@ name = \"memchr\"\n version = \"0.1.11\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"libc 0.2.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"libc 0.2.11 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n-[[package]]\n-name = \"mempool\"\n-version = \"0.3.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-\n [[package]]\n name = \"regex\"\n-version = \"0.1.63\"\n+version = \"0.1.71\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"aho-corasick 0.5.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"aho-corasick 0.5.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"memchr 0.1.11 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"mempool 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"regex-syntax 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"regex-syntax 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"thread_local 0.2.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"utf8-ranges 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n name = \"regex-syntax\"\n-version = \"0.3.1\"\n+version = \"0.3.3\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n@@ -115,7 +110,7 @@ version = \"0.32.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"bitflags 0.5.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"libc 0.2.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"libc 0.2.11 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rustc-serialize 0.3.19 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"term 0.2.14 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -127,22 +122,39 @@ name = \"term\"\n version = \"0.2.14\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"kernel32-sys 0.2.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.2.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"kernel32-sys 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.2.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n name = \"term\"\n version = \"0.4.4\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"kernel32-sys 0.2.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.2.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"kernel32-sys 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.2.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+]\n+\n+[[package]]\n+name = \"thread-id\"\n+version = \"2.0.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+dependencies = [\n+ \"kernel32-sys 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"libc 0.2.11 (registry+https://github.com/rust-lang/crates.io-index)\",\n+]\n+\n+[[package]]\n+name = \"thread_local\"\n+version = \"0.2.5\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+dependencies = [\n+ \"thread-id 2.0.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n name = \"toml\"\n-version = \"0.1.28\"\n+version = \"0.1.30\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"rustc-serialize 0.3.19 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -165,7 +177,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"winapi\"\n-version = \"0.2.6\"\n+version = \"0.2.7\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]"}, {"sha": "837fecd83ce089422bd51d34f10b3fbc0657b950", "filename": "src/patterns.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/6e01fac285169c24db8e8c64d3bea0d368197650/src%2Fpatterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6e01fac285169c24db8e8c64d3bea0d368197650/src%2Fpatterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fpatterns.rs?ref=6e01fac285169c24db8e8c64d3bea0d368197650", "patch": "@@ -28,7 +28,6 @@ impl Rewrite for Pat {\n                 };\n                 let mut_infix = format_mutability(mutability);\n                 let id_str = ident.node.to_string();\n-\n                 let sub_pat = match *sub_pat {\n                     Some(ref p) => {\n                         // 3 - ` @ `."}, {"sha": "8dd8c09959bb35157626356c199f19069d43f945", "filename": "src/types.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/6e01fac285169c24db8e8c64d3bea0d368197650/src%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6e01fac285169c24db8e8c64d3bea0d368197650/src%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftypes.rs?ref=6e01fac285169c24db8e8c64d3bea0d368197650", "patch": "@@ -600,6 +600,19 @@ fn rewrite_bare_fn(bare_fn: &ast::BareFnTy,\n                    -> Option<String> {\n     let mut result = String::with_capacity(128);\n \n+    if !bare_fn.lifetimes.is_empty() {\n+        result.push_str(\"for<\");\n+        // 6 = \"for<> \".len(), 4 = \"for<\".\n+        // This doesn't work out so nicely for mutliline situation with lots of\n+        // rightward drift. If that is a problem, we could use the list stuff.\n+        result.push_str(&try_opt!(bare_fn.lifetimes\n+                .iter()\n+                .map(|l| l.rewrite(context, try_opt!(width.checked_sub(6)), offset + 4))\n+                .collect::<Option<Vec<_>>>())\n+            .join(\", \"));\n+        result.push_str(\"> \");\n+    }\n+\n     result.push_str(&::utils::format_unsafety(bare_fn.unsafety));\n \n     if bare_fn.abi != abi::Abi::Rust {"}, {"sha": "92da1010641c256ee1fd37e6f372af4a8b3ae773", "filename": "tests/source/type.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6e01fac285169c24db8e8c64d3bea0d368197650/tests%2Fsource%2Ftype.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6e01fac285169c24db8e8c64d3bea0d368197650/tests%2Fsource%2Ftype.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Ftype.rs?ref=6e01fac285169c24db8e8c64d3bea0d368197650", "patch": "@@ -12,3 +12,5 @@ struct F {\n     i: extern \"C\" fn(x: u8, /* comment 4*/ y: String, // comment 3\n                      z: Foo, /* comment */ .../* comment 2*/ ),\n }\n+\n+fn issue_1006(def_id_to_string: for<'a, 'b> unsafe fn(TyCtxt<'b, 'tcx, 'tcx>, DefId) -> String) {}"}, {"sha": "75655c913ecbd51c0094287415fbb795d944d6fb", "filename": "tests/target/type.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6e01fac285169c24db8e8c64d3bea0d368197650/tests%2Ftarget%2Ftype.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6e01fac285169c24db8e8c64d3bea0d368197650/tests%2Ftarget%2Ftype.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Ftype.rs?ref=6e01fac285169c24db8e8c64d3bea0d368197650", "patch": "@@ -21,3 +21,5 @@ struct F {\n                      // comment\n                      ... /* comment 2 */),\n }\n+\n+fn issue_1006(def_id_to_string: for<'a, 'b> unsafe fn(TyCtxt<'b, 'tcx, 'tcx>, DefId) -> String) {}"}]}