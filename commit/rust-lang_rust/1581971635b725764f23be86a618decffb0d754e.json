{"sha": "1581971635b725764f23be86a618decffb0d754e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE1ODE5NzE2MzViNzI1NzY0ZjIzYmU4NmE2MThkZWNmZmIwZDc1NGU=", "commit": {"author": {"name": "jD91mZM2", "email": "me@krake.one", "date": "2018-07-24T03:27:45Z"}, "committer": {"name": "jD91mZM2", "email": "me@krake.one", "date": "2018-07-24T04:25:29Z"}, "message": "Stablize Redox Unix Sockets", "tree": {"sha": "6b7c13b0b80441cf0f8b1eea0e01937b438d4209", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6b7c13b0b80441cf0f8b1eea0e01937b438d4209"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1581971635b725764f23be86a618decffb0d754e", "comment_count": 0, "verification": {"verified": false, "reason": "unverified_email", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCAAdFiEEvF2uTsFosfm5TJhQMFXVRymnJmYFAltWqjkACgkQMFXVRymn\nJma66Af+IxUb0L3wpl3Bho8VWkz6ImdqegM5UlPABEv+CFZ9C0rjt6BD1xCeHKPo\nUNyIZMroLSJCAWeql2hBjfVByAHaX0rdQSUvBU4F5gn2h5Gm7zAfK3XRHdMEwcEA\nJiGsoNupjSCvQuN3+h6dQi9szdt7Q5pg+QJTuAc873sj14YqZ7B/ZC9jykr62Tl4\nZtQ3WA0LuGkFZm9rvXagyB0Te1QcFMLJbZdiwMHUxRZ7LQke2aW3PysPe9zTZkUr\nEIrwqBPmIBxuVmkfVW4KE3gY6Pw4jVrznOtWZjxy4KWyVasOlnrvSj46f22GgoAE\njKAkVZkJK1nelY2+M34uWzPNfq8Z9A==\n=mju4\n-----END PGP SIGNATURE-----", "payload": "tree 6b7c13b0b80441cf0f8b1eea0e01937b438d4209\nparent 0b56e7f1a911f1157cd46cedbb1a0544e3ee3c3c\nauthor jD91mZM2 <me@krake.one> 1532402865 +0200\ncommitter jD91mZM2 <me@krake.one> 1532406329 +0200\n\nStablize Redox Unix Sockets\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1581971635b725764f23be86a618decffb0d754e", "html_url": "https://github.com/rust-lang/rust/commit/1581971635b725764f23be86a618decffb0d754e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1581971635b725764f23be86a618decffb0d754e/comments", "author": {"login": "jD91mZM2", "id": 12830969, "node_id": "MDQ6VXNlcjEyODMwOTY5", "avatar_url": "https://avatars.githubusercontent.com/u/12830969?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jD91mZM2", "html_url": "https://github.com/jD91mZM2", "followers_url": "https://api.github.com/users/jD91mZM2/followers", "following_url": "https://api.github.com/users/jD91mZM2/following{/other_user}", "gists_url": "https://api.github.com/users/jD91mZM2/gists{/gist_id}", "starred_url": "https://api.github.com/users/jD91mZM2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jD91mZM2/subscriptions", "organizations_url": "https://api.github.com/users/jD91mZM2/orgs", "repos_url": "https://api.github.com/users/jD91mZM2/repos", "events_url": "https://api.github.com/users/jD91mZM2/events{/privacy}", "received_events_url": "https://api.github.com/users/jD91mZM2/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jD91mZM2", "id": 12830969, "node_id": "MDQ6VXNlcjEyODMwOTY5", "avatar_url": "https://avatars.githubusercontent.com/u/12830969?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jD91mZM2", "html_url": "https://github.com/jD91mZM2", "followers_url": "https://api.github.com/users/jD91mZM2/followers", "following_url": "https://api.github.com/users/jD91mZM2/following{/other_user}", "gists_url": "https://api.github.com/users/jD91mZM2/gists{/gist_id}", "starred_url": "https://api.github.com/users/jD91mZM2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jD91mZM2/subscriptions", "organizations_url": "https://api.github.com/users/jD91mZM2/orgs", "repos_url": "https://api.github.com/users/jD91mZM2/repos", "events_url": "https://api.github.com/users/jD91mZM2/events{/privacy}", "received_events_url": "https://api.github.com/users/jD91mZM2/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0b56e7f1a911f1157cd46cedbb1a0544e3ee3c3c", "url": "https://api.github.com/repos/rust-lang/rust/commits/0b56e7f1a911f1157cd46cedbb1a0544e3ee3c3c", "html_url": "https://github.com/rust-lang/rust/commit/0b56e7f1a911f1157cd46cedbb1a0544e3ee3c3c"}], "stats": {"total": 42, "additions": 41, "deletions": 1}, "files": [{"sha": "2ab7770324254b8109aaf705630c6cc0c42f5d5d", "filename": "src/libstd/sys/redox/ext/net.rs", "status": "modified", "additions": 41, "deletions": 1, "changes": 42, "blob_url": "https://github.com/rust-lang/rust/blob/1581971635b725764f23be86a618decffb0d754e/src%2Flibstd%2Fsys%2Fredox%2Fext%2Fnet.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1581971635b725764f23be86a618decffb0d754e/src%2Flibstd%2Fsys%2Fredox%2Fext%2Fnet.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fredox%2Fext%2Fnet.rs?ref=1581971635b725764f23be86a618decffb0d754e", "patch": "@@ -8,7 +8,7 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-#![unstable(feature = \"unix_socket_redox\", reason = \"new feature\", issue=\"51553\")]\n+#![stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n \n //! Unix-specific networking functionality\n \n@@ -37,6 +37,7 @@ use sys::{cvt, fd::FileDesc, syscall};\n /// let addr = socket.local_addr().expect(\"Couldn't get local address\");\n /// ```\n #[derive(Clone)]\n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n pub struct SocketAddr(());\n \n impl SocketAddr {\n@@ -64,6 +65,7 @@ impl SocketAddr {\n     /// let addr = socket.local_addr().expect(\"Couldn't get local address\");\n     /// assert_eq!(addr.as_pathname(), None);\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn as_pathname(&self) -> Option<&Path> {\n         None\n     }\n@@ -91,10 +93,12 @@ impl SocketAddr {\n     /// let addr = socket.local_addr().expect(\"Couldn't get local address\");\n     /// assert_eq!(addr.is_unnamed(), true);\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn is_unnamed(&self) -> bool {\n         false\n     }\n }\n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n impl fmt::Debug for SocketAddr {\n     fn fmt(&self, fmt: &mut fmt::Formatter) -> fmt::Result {\n         write!(fmt, \"SocketAddr\")\n@@ -115,8 +119,10 @@ impl fmt::Debug for SocketAddr {\n /// stream.read_to_string(&mut response).unwrap();\n /// println!(\"{}\", response);\n /// ```\n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n pub struct UnixStream(FileDesc);\n \n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n impl fmt::Debug for UnixStream {\n     fn fmt(&self, fmt: &mut fmt::Formatter) -> fmt::Result {\n         let mut builder = fmt.debug_struct(\"UnixStream\");\n@@ -147,6 +153,7 @@ impl UnixStream {\n     ///     }\n     /// };\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn connect<P: AsRef<Path>>(path: P) -> io::Result<UnixStream> {\n         if let Some(s) = path.as_ref().to_str() {\n             cvt(syscall::open(format!(\"chan:{}\", s), syscall::O_CLOEXEC))\n@@ -177,6 +184,7 @@ impl UnixStream {\n     ///     }\n     /// };\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn pair() -> io::Result<(UnixStream, UnixStream)> {\n         let server = cvt(syscall::open(\"chan:\", syscall::O_CREAT | syscall::O_CLOEXEC))\n             .map(FileDesc::new)?;\n@@ -200,6 +208,7 @@ impl UnixStream {\n     /// let socket = UnixStream::connect(\"/tmp/sock\").unwrap();\n     /// let sock_copy = socket.try_clone().expect(\"Couldn't clone socket\");\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn try_clone(&self) -> io::Result<UnixStream> {\n         self.0.duplicate().map(UnixStream)\n     }\n@@ -214,6 +223,7 @@ impl UnixStream {\n     /// let socket = UnixStream::connect(\"/tmp/sock\").unwrap();\n     /// let addr = socket.local_addr().expect(\"Couldn't get local address\");\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn local_addr(&self) -> io::Result<SocketAddr> {\n         Err(Error::new(ErrorKind::Other, \"UnixStream::local_addr unimplemented on redox\"))\n     }\n@@ -228,6 +238,7 @@ impl UnixStream {\n     /// let socket = UnixStream::connect(\"/tmp/sock\").unwrap();\n     /// let addr = socket.peer_addr().expect(\"Couldn't get peer address\");\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn peer_addr(&self) -> io::Result<SocketAddr> {\n         Err(Error::new(ErrorKind::Other, \"UnixStream::peer_addr unimplemented on redox\"))\n     }\n@@ -266,6 +277,7 @@ impl UnixStream {\n     /// let err = result.unwrap_err();\n     /// assert_eq!(err.kind(), io::ErrorKind::InvalidInput)\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn set_read_timeout(&self, _timeout: Option<Duration>) -> io::Result<()> {\n         Err(Error::new(ErrorKind::Other, \"UnixStream::set_read_timeout unimplemented on redox\"))\n     }\n@@ -304,6 +316,7 @@ impl UnixStream {\n     /// let err = result.unwrap_err();\n     /// assert_eq!(err.kind(), io::ErrorKind::InvalidInput)\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn set_write_timeout(&self, _timeout: Option<Duration>) -> io::Result<()> {\n         Err(Error::new(ErrorKind::Other, \"UnixStream::set_write_timeout unimplemented on redox\"))\n     }\n@@ -320,6 +333,7 @@ impl UnixStream {\n     /// socket.set_read_timeout(Some(Duration::new(1, 0))).expect(\"Couldn't set read timeout\");\n     /// assert_eq!(socket.read_timeout().unwrap(), Some(Duration::new(1, 0)));\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn read_timeout(&self) -> io::Result<Option<Duration>> {\n         Err(Error::new(ErrorKind::Other, \"UnixStream::read_timeout unimplemented on redox\"))\n     }\n@@ -336,6 +350,7 @@ impl UnixStream {\n     /// socket.set_write_timeout(Some(Duration::new(1, 0))).expect(\"Couldn't set write timeout\");\n     /// assert_eq!(socket.write_timeout().unwrap(), Some(Duration::new(1, 0)));\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn write_timeout(&self) -> io::Result<Option<Duration>> {\n         Err(Error::new(ErrorKind::Other, \"UnixStream::write_timeout unimplemented on redox\"))\n     }\n@@ -350,6 +365,7 @@ impl UnixStream {\n     /// let socket = UnixStream::connect(\"/tmp/sock\").unwrap();\n     /// socket.set_nonblocking(true).expect(\"Couldn't set nonblocking\");\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn set_nonblocking(&self, nonblocking: bool) -> io::Result<()> {\n         self.0.set_nonblocking(nonblocking)\n     }\n@@ -369,6 +385,7 @@ impl UnixStream {\n     ///\n     /// # Platform specific\n     /// On Redox this always returns None.\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn take_error(&self) -> io::Result<Option<io::Error>> {\n         Ok(None)\n     }\n@@ -390,11 +407,13 @@ impl UnixStream {\n     /// let socket = UnixStream::connect(\"/tmp/sock\").unwrap();\n     /// socket.shutdown(Shutdown::Both).expect(\"shutdown function failed\");\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn shutdown(&self, _how: Shutdown) -> io::Result<()> {\n         Err(Error::new(ErrorKind::Other, \"UnixStream::shutdown unimplemented on redox\"))\n     }\n }\n \n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n impl io::Read for UnixStream {\n     fn read(&mut self, buf: &mut [u8]) -> io::Result<usize> {\n         io::Read::read(&mut &*self, buf)\n@@ -406,6 +425,7 @@ impl io::Read for UnixStream {\n     }\n }\n \n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n impl<'a> io::Read for &'a UnixStream {\n     fn read(&mut self, buf: &mut [u8]) -> io::Result<usize> {\n         self.0.read(buf)\n@@ -417,6 +437,7 @@ impl<'a> io::Read for &'a UnixStream {\n     }\n }\n \n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n impl io::Write for UnixStream {\n     fn write(&mut self, buf: &[u8]) -> io::Result<usize> {\n         io::Write::write(&mut &*self, buf)\n@@ -427,6 +448,7 @@ impl io::Write for UnixStream {\n     }\n }\n \n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n impl<'a> io::Write for &'a UnixStream {\n     fn write(&mut self, buf: &[u8]) -> io::Result<usize> {\n         self.0.write(buf)\n@@ -437,18 +459,21 @@ impl<'a> io::Write for &'a UnixStream {\n     }\n }\n \n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n impl AsRawFd for UnixStream {\n     fn as_raw_fd(&self) -> RawFd {\n         self.0.raw()\n     }\n }\n \n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n impl FromRawFd for UnixStream {\n     unsafe fn from_raw_fd(fd: RawFd) -> UnixStream {\n         UnixStream(FileDesc::new(fd))\n     }\n }\n \n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n impl IntoRawFd for UnixStream {\n     fn into_raw_fd(self) -> RawFd {\n         self.0.into_raw()\n@@ -483,8 +508,10 @@ impl IntoRawFd for UnixStream {\n ///     }\n /// }\n /// ```\n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n pub struct UnixListener(FileDesc);\n \n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n impl fmt::Debug for UnixListener {\n     fn fmt(&self, fmt: &mut fmt::Formatter) -> fmt::Result {\n         let mut builder = fmt.debug_struct(\"UnixListener\");\n@@ -512,6 +539,7 @@ impl UnixListener {\n     ///     }\n     /// };\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn bind<P: AsRef<Path>>(path: P) -> io::Result<UnixListener> {\n         if let Some(s) = path.as_ref().to_str() {\n             cvt(syscall::open(format!(\"chan:{}\", s), syscall::O_CREAT | syscall::O_CLOEXEC))\n@@ -545,6 +573,7 @@ impl UnixListener {\n     ///     Err(e) => println!(\"accept function failed: {:?}\", e),\n     /// }\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn accept(&self) -> io::Result<(UnixStream, SocketAddr)> {\n         self.0.duplicate_path(b\"listen\").map(|fd| (UnixStream(fd), SocketAddr(())))\n     }\n@@ -564,6 +593,7 @@ impl UnixListener {\n     ///\n     /// let listener_copy = listener.try_clone().expect(\"try_clone failed\");\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn try_clone(&self) -> io::Result<UnixListener> {\n         self.0.duplicate().map(UnixListener)\n     }\n@@ -579,6 +609,7 @@ impl UnixListener {\n     ///\n     /// let addr = listener.local_addr().expect(\"Couldn't get local address\");\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn local_addr(&self) -> io::Result<SocketAddr> {\n         Err(Error::new(ErrorKind::Other, \"UnixListener::local_addr unimplemented on redox\"))\n     }\n@@ -594,6 +625,7 @@ impl UnixListener {\n     ///\n     /// listener.set_nonblocking(true).expect(\"Couldn't set non blocking\");\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn set_nonblocking(&self, nonblocking: bool) -> io::Result<()> {\n         self.0.set_nonblocking(nonblocking)\n     }\n@@ -614,6 +646,7 @@ impl UnixListener {\n     ///\n     /// # Platform specific\n     /// On Redox this always returns None.\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn take_error(&self) -> io::Result<Option<io::Error>> {\n         Ok(None)\n     }\n@@ -649,29 +682,34 @@ impl UnixListener {\n     ///     }\n     /// }\n     /// ```\n+    #[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n     pub fn incoming<'a>(&'a self) -> Incoming<'a> {\n         Incoming { listener: self }\n     }\n }\n \n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n impl AsRawFd for UnixListener {\n     fn as_raw_fd(&self) -> RawFd {\n         self.0.raw()\n     }\n }\n \n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n impl FromRawFd for UnixListener {\n     unsafe fn from_raw_fd(fd: RawFd) -> UnixListener {\n         UnixListener(FileDesc::new(fd))\n     }\n }\n \n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n impl IntoRawFd for UnixListener {\n     fn into_raw_fd(self) -> RawFd {\n         self.0.into_raw()\n     }\n }\n \n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n impl<'a> IntoIterator for &'a UnixListener {\n     type Item = io::Result<UnixStream>;\n     type IntoIter = Incoming<'a>;\n@@ -712,10 +750,12 @@ impl<'a> IntoIterator for &'a UnixListener {\n /// }\n /// ```\n #[derive(Debug)]\n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n pub struct Incoming<'a> {\n     listener: &'a UnixListener,\n }\n \n+#[stable(feature = \"unix_socket_redox\", since = \"1.29\")]\n impl<'a> Iterator for Incoming<'a> {\n     type Item = io::Result<UnixStream>;\n "}]}