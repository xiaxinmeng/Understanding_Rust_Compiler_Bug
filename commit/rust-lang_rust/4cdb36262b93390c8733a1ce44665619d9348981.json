{"sha": "4cdb36262b93390c8733a1ce44665619d9348981", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRjZGIzNjI2MmI5MzM5MGM4NzMzYTFjZTQ0NjY1NjE5ZDkzNDg5ODE=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-09-20T12:24:49Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-09-20T12:24:49Z"}, "message": "Auto merge of #44407 - mattico:print-native-cpu, r=arielb1\n\nAdd 'native' to -C target-cpu=help\n\nFixes #44393", "tree": {"sha": "bf4dd15c310505c6ba4f86bb6bd41d56aaa050e6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bf4dd15c310505c6ba4f86bb6bd41d56aaa050e6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4cdb36262b93390c8733a1ce44665619d9348981", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4cdb36262b93390c8733a1ce44665619d9348981", "html_url": "https://github.com/rust-lang/rust/commit/4cdb36262b93390c8733a1ce44665619d9348981", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4cdb36262b93390c8733a1ce44665619d9348981/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "183329cf738e8903058484845338f59a9e14d094", "url": "https://api.github.com/repos/rust-lang/rust/commits/183329cf738e8903058484845338f59a9e14d094", "html_url": "https://github.com/rust-lang/rust/commit/183329cf738e8903058484845338f59a9e14d094"}, {"sha": "824fb3817c0cbcb3a31a705d02a77219c8331608", "url": "https://api.github.com/repos/rust-lang/rust/commits/824fb3817c0cbcb3a31a705d02a77219c8331608", "html_url": "https://github.com/rust-lang/rust/commit/824fb3817c0cbcb3a31a705d02a77219c8331608"}], "stats": {"total": 7, "additions": 7, "deletions": 0}, "files": [{"sha": "2f966e5a1c5e2c6acc11a0da17f90057a6cef1c1", "filename": "src/rustllvm/PassWrapper.cpp", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/4cdb36262b93390c8733a1ce44665619d9348981/src%2Frustllvm%2FPassWrapper.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/4cdb36262b93390c8733a1ce44665619d9348981/src%2Frustllvm%2FPassWrapper.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2FPassWrapper.cpp?ref=4cdb36262b93390c8733a1ce44665619d9348981", "patch": "@@ -299,10 +299,17 @@ static size_t getLongestEntryLength(ArrayRef<SubtargetFeatureKV> Table) {\n extern \"C\" void LLVMRustPrintTargetCPUs(LLVMTargetMachineRef TM) {\n   const TargetMachine *Target = unwrap(TM);\n   const MCSubtargetInfo *MCInfo = Target->getMCSubtargetInfo();\n+  const Triple::ArchType HostArch = Triple(sys::getProcessTriple()).getArch();\n+  const Triple::ArchType TargetArch = Target->getTargetTriple().getArch();\n   const ArrayRef<SubtargetFeatureKV> CPUTable = MCInfo->getCPUTable();\n   unsigned MaxCPULen = getLongestEntryLength(CPUTable);\n \n   printf(\"Available CPUs for this target:\\n\");\n+  if (HostArch == TargetArch) {\n+    const StringRef HostCPU = sys::getHostCPUName();\n+    printf(\"    %-*s - Select the CPU of the current host (currently %.*s).\\n\",\n+      MaxCPULen, \"native\", (int)HostCPU.size(), HostCPU.data());\n+  }\n   for (auto &CPU : CPUTable)\n     printf(\"    %-*s - %s.\\n\", MaxCPULen, CPU.Key, CPU.Desc);\n   printf(\"\\n\");"}]}