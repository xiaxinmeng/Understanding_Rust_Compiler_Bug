{"sha": "49582725603102c9734bdcb44608a725d5c963b3", "node_id": "C_kwDOAAsO6NoAKDQ5NTgyNzI1NjAzMTAyYzk3MzRiZGNiNDQ2MDhhNzI1ZDVjOTYzYjM", "commit": {"author": {"name": "Pietro Albini", "email": "pietro.albini@ferrous-systems.com", "date": "2023-03-03T10:09:47Z"}, "committer": {"name": "Pietro Albini", "email": "pietro.albini@ferrous-systems.com", "date": "2023-03-03T10:09:47Z"}, "message": "change approach to prevent interleaving compiletest message", "tree": {"sha": "e85ad9170ac8563479e1c2160c95cef5e64e0635", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e85ad9170ac8563479e1c2160c95cef5e64e0635"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/49582725603102c9734bdcb44608a725d5c963b3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEMycKYjxLY0eb13b7zXazX3c0dp4FAmQBx3cACgkQzXazX3c0\ndp6y4RAAnQqprQ446GBQWaCGbFfP77G5Mvo/d/Nyc92ArpEh7JD8xX7dfHSS8B4e\n9sRUZncWXEqfa6Bq5srXpqNTFYshiKQpzETcTOsUnpGXBc2lKHjPLLtUzxGdgD+Y\nTclx6yEbsgURWjlfd50rYem7fuvkdkQ55hu2ws3zMl2LpOAfxcNPa/gskGzaaDaY\nbIN5ZP7qz409Sx01bLITROucuQlUZaPIXTsHppmvnMM8vaW/ih7Lra8x5XlVxjeh\n61hr8kZTk05Wa6mFS6A2P8CaGKO/cR18X46JWPy6em4dv8Fqzhznkm+2WCXjikI3\nKPic7E7YyWmvirSHcy7XviGD+cTAii4iM0YZ1yu7/7mMMm2S4mk4AfR0CLhfZU5H\nRP8vJYwSQ5GyqoL4y/6Oa9Nxr83fMbFywHH8ctyLjvXGkfWNF8L5ajvIYhR5YrYB\nOg1wUP3KHS4WQltyHGVQR+MbZylpzLrQ9g15Z4qqAu7DqBRvPB//hQNkC31+QQbe\n0Z0HXICjQiRyO4zXVaekp3Q2stQQFAQHdvNm1+ON4aZobRl1jN28mf8Jgfo8PByC\nU5rsmCULUHZTQX7G91W5RKm/OFGCdlBL1gVudxoqYhD/6W0S2/BNLj97+HNBm/D8\nVX7rHtLPPU6nSgnp7/YHxqZrfCPCve+4ZRL55cZ3mQNryIjK7uA=\n=Kwfz\n-----END PGP SIGNATURE-----", "payload": "tree e85ad9170ac8563479e1c2160c95cef5e64e0635\nparent 9a1ff1b95808c6639b8d00f46f675daafad566e7\nauthor Pietro Albini <pietro.albini@ferrous-systems.com> 1677838187 +0100\ncommitter Pietro Albini <pietro.albini@ferrous-systems.com> 1677838187 +0100\n\nchange approach to prevent interleaving compiletest message\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/49582725603102c9734bdcb44608a725d5c963b3", "html_url": "https://github.com/rust-lang/rust/commit/49582725603102c9734bdcb44608a725d5c963b3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/49582725603102c9734bdcb44608a725d5c963b3/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9a1ff1b95808c6639b8d00f46f675daafad566e7", "url": "https://api.github.com/repos/rust-lang/rust/commits/9a1ff1b95808c6639b8d00f46f675daafad566e7", "html_url": "https://github.com/rust-lang/rust/commit/9a1ff1b95808c6639b8d00f46f675daafad566e7"}], "stats": {"total": 9, "additions": 2, "deletions": 7}, "files": [{"sha": "cdc40d83151616b1d011c26308ed8fec5d64ead2", "filename": "src/bootstrap/render_tests.rs", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/49582725603102c9734bdcb44608a725d5c963b3/src%2Fbootstrap%2Frender_tests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/49582725603102c9734bdcb44608a725d5c963b3/src%2Fbootstrap%2Frender_tests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Frender_tests.rs?ref=49582725603102c9734bdcb44608a725d5c963b3", "patch": "@@ -7,7 +7,7 @@\n //! to reimplement all the rendering logic in this module because of that.\n \n use crate::builder::Builder;\n-use std::io::{BufRead, BufReader, Cursor, Write};\n+use std::io::{BufRead, BufReader, Write};\n use std::process::{ChildStdout, Command, Stdio};\n use std::time::Duration;\n use yansi_term::Color;\n@@ -43,7 +43,6 @@ pub(crate) fn try_run_tests(builder: &Builder<'_>, cmd: &mut Command) -> bool {\n \n fn run_tests(builder: &Builder<'_>, cmd: &mut Command) -> bool {\n     cmd.stdout(Stdio::piped());\n-    cmd.stderr(Stdio::piped());\n \n     builder.verbose(&format!(\"running: {cmd:?}\"));\n \n@@ -62,10 +61,6 @@ fn run_tests(builder: &Builder<'_>, cmd: &mut Command) -> bool {\n         );\n     }\n \n-    // Show the stderr emitted by the test runner at the end. As of 2023-03-02 this is only the\n-    // message at the end of a failed compiletest run.\n-    std::io::copy(&mut Cursor::new(&result.stderr), &mut std::io::stderr().lock()).unwrap();\n-\n     result.status.success()\n }\n "}, {"sha": "cbaa599f79308d2c203c4de2654d4353d01ef832", "filename": "src/tools/compiletest/src/main.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/49582725603102c9734bdcb44608a725d5c963b3/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/49582725603102c9734bdcb44608a725d5c963b3/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs?ref=49582725603102c9734bdcb44608a725d5c963b3", "patch": "@@ -422,7 +422,7 @@ pub fn run_tests(config: Config) {\n             // easy to miss which tests failed, and as such fail to reproduce\n             // the failure locally.\n \n-            eprintln!(\n+            println!(\n                 \"Some tests failed in compiletest suite={}{} mode={} host={} target={}\",\n                 config.suite,\n                 config.compare_mode.map(|c| format!(\" compare_mode={:?}\", c)).unwrap_or_default(),"}]}