{"sha": "6d38351db420bd7d069d17783f83b8936ffe361b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZkMzgzNTFkYjQyMGJkN2QwNjlkMTc3ODNmODNiODkzNmZmZTM2MWI=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2020-06-03T06:16:45Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-06-03T06:16:45Z"}, "message": "Merge #4721\n\n4721: Hide squiggly for unused and unnecessary diagnostics r=matklad a=GabbeV\n\nFixes #4229 \r\n\r\nWhen working with JavaScript or TypeScript in VSCode unused valiables are faded but don't have a squiggle. This PR makes rust-analyzer work similarly by setting the severity to hint when applying the unnecessary tag.\r\n\r\nVSCode usually shows a squiggle for error, warning and information and shows three dots for hint. When the unnecessary tag is present the squiggles will still show up but the three dots will not.\r\n\r\nThis is my first contribution to open source. Please tell me if i need to do anything more to get this PR considered.\n\nCo-authored-by: Gabriel Valfridsson <gabriel.valfridsson@gmail.com>", "tree": {"sha": "617ec9754a237837f358a0420ec42084173a146c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/617ec9754a237837f358a0420ec42084173a146c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6d38351db420bd7d069d17783f83b8936ffe361b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJe10BNCRBK7hj4Ov3rIwAAdHIIAG7TCnGydYHeH2IUs4Y9I477\nA18+5I0WsF6AMtL8PhKfPU62XTXLLGNCLbD3JGxjQSewsxxnJkGmdLEim4zNCIew\n5RFzzIAtU1wPyrJI1E/oz16dsqF8M9UENr0thzjCSuvQFZG6aZWSpUyyvU3idaR6\nHTSbQ8zz8X0545oXzq9aqzDu3da3T5dC9ceZoKCIw1OUN3PoxoVne2kyoFqRn1rt\nUz1+hoUa3WlnqC3Ts54MhKK+E34tx9PBFLTvqk2vjVZHeGY0p44OIGhs1mGhCeUj\n5HkW6t++FQq8nqVMxTaG8uZUA8/tRsdvAeP0dUwR+UHZvmCDiu5nQywpyTs7+Ac=\n=6Zz6\n-----END PGP SIGNATURE-----\n", "payload": "tree 617ec9754a237837f358a0420ec42084173a146c\nparent dff8140a2e9de8b6d9c64cfcc9a8d16db3a0fecd\nparent 599c105e6fabb2b81c2d0a11b86c0c96f6ab1b88\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1591165005 +0000\ncommitter GitHub <noreply@github.com> 1591165005 +0000\n\nMerge #4721\n\n4721: Hide squiggly for unused and unnecessary diagnostics r=matklad a=GabbeV\n\nFixes #4229 \r\n\r\nWhen working with JavaScript or TypeScript in VSCode unused valiables are faded but don't have a squiggle. This PR makes rust-analyzer work similarly by setting the severity to hint when applying the unnecessary tag.\r\n\r\nVSCode usually shows a squiggle for error, warning and information and shows three dots for hint. When the unnecessary tag is present the squiggles will still show up but the three dots will not.\r\n\r\nThis is my first contribution to open source. Please tell me if i need to do anything more to get this PR considered.\n\nCo-authored-by: Gabriel Valfridsson <gabriel.valfridsson@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6d38351db420bd7d069d17783f83b8936ffe361b", "html_url": "https://github.com/rust-lang/rust/commit/6d38351db420bd7d069d17783f83b8936ffe361b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6d38351db420bd7d069d17783f83b8936ffe361b/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dff8140a2e9de8b6d9c64cfcc9a8d16db3a0fecd", "url": "https://api.github.com/repos/rust-lang/rust/commits/dff8140a2e9de8b6d9c64cfcc9a8d16db3a0fecd", "html_url": "https://github.com/rust-lang/rust/commit/dff8140a2e9de8b6d9c64cfcc9a8d16db3a0fecd"}, {"sha": "599c105e6fabb2b81c2d0a11b86c0c96f6ab1b88", "url": "https://api.github.com/repos/rust-lang/rust/commits/599c105e6fabb2b81c2d0a11b86c0c96f6ab1b88", "html_url": "https://github.com/rust-lang/rust/commit/599c105e6fabb2b81c2d0a11b86c0c96f6ab1b88"}], "stats": {"total": 5, "additions": 3, "deletions": 2}, "files": [{"sha": "33b516e269b860289269d47d138d8937e13bec90", "filename": "crates/rust-analyzer/src/diagnostics/snapshots/rust_analyzer__diagnostics__to_proto__tests__snap_rustc_unused_variable.snap", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6d38351db420bd7d069d17783f83b8936ffe361b/crates%2Frust-analyzer%2Fsrc%2Fdiagnostics%2Fsnapshots%2Frust_analyzer__diagnostics__to_proto__tests__snap_rustc_unused_variable.snap", "raw_url": "https://github.com/rust-lang/rust/raw/6d38351db420bd7d069d17783f83b8936ffe361b/crates%2Frust-analyzer%2Fsrc%2Fdiagnostics%2Fsnapshots%2Frust_analyzer__diagnostics__to_proto__tests__snap_rustc_unused_variable.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fdiagnostics%2Fsnapshots%2Frust_analyzer__diagnostics__to_proto__tests__snap_rustc_unused_variable.snap?ref=6d38351db420bd7d069d17783f83b8936ffe361b", "patch": "@@ -29,7 +29,7 @@ expression: diag\n                 },\n             },\n             severity: Some(\n-                Warning,\n+                Hint,\n             ),\n             code: Some(\n                 String("}, {"sha": "6a6e7b45735a363af5c29d0dce7b0b3245a7d07f", "filename": "crates/rust-analyzer/src/diagnostics/to_proto.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/6d38351db420bd7d069d17783f83b8936ffe361b/crates%2Frust-analyzer%2Fsrc%2Fdiagnostics%2Fto_proto.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6d38351db420bd7d069d17783f83b8936ffe361b/crates%2Frust-analyzer%2Fsrc%2Fdiagnostics%2Fto_proto.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fdiagnostics%2Fto_proto.rs?ref=6d38351db420bd7d069d17783f83b8936ffe361b", "patch": "@@ -183,7 +183,7 @@ pub(crate) fn map_rust_diagnostic_to_lsp(\n         return Vec::new();\n     }\n \n-    let severity = map_level_to_severity(rd.level);\n+    let mut severity = map_level_to_severity(rd.level);\n \n     let mut source = String::from(\"rustc\");\n     let mut code = rd.code.as_ref().map(|c| c.code.clone());\n@@ -225,6 +225,7 @@ pub(crate) fn map_rust_diagnostic_to_lsp(\n     }\n \n     if is_unused_or_unnecessary(rd) {\n+        severity = Some(DiagnosticSeverity::Hint);\n         tags.push(DiagnosticTag::Unnecessary);\n     }\n "}]}