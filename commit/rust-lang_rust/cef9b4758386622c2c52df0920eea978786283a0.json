{"sha": "cef9b4758386622c2c52df0920eea978786283a0", "node_id": "C_kwDOAAsO6NoAKGNlZjliNDc1ODM4NjYyMmMyYzUyZGYwOTIwZWVhOTc4Nzg2MjgzYTA", "commit": {"author": {"name": "Mara Bos", "email": "m-ou.se@m-ou.se", "date": "2022-01-27T22:59:34Z"}, "committer": {"name": "Mara Bos", "email": "m-ou.se@m-ou.se", "date": "2022-01-27T23:20:25Z"}, "message": "Extend format-args capture test.", "tree": {"sha": "b871286d37f677b4d7fe938479ac46a093f69c45", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b871286d37f677b4d7fe938479ac46a093f69c45"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cef9b4758386622c2c52df0920eea978786283a0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cef9b4758386622c2c52df0920eea978786283a0", "html_url": "https://github.com/rust-lang/rust/commit/cef9b4758386622c2c52df0920eea978786283a0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cef9b4758386622c2c52df0920eea978786283a0/comments", "author": {"login": "m-ou-se", "id": 783247, "node_id": "MDQ6VXNlcjc4MzI0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/783247?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m-ou-se", "html_url": "https://github.com/m-ou-se", "followers_url": "https://api.github.com/users/m-ou-se/followers", "following_url": "https://api.github.com/users/m-ou-se/following{/other_user}", "gists_url": "https://api.github.com/users/m-ou-se/gists{/gist_id}", "starred_url": "https://api.github.com/users/m-ou-se/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m-ou-se/subscriptions", "organizations_url": "https://api.github.com/users/m-ou-se/orgs", "repos_url": "https://api.github.com/users/m-ou-se/repos", "events_url": "https://api.github.com/users/m-ou-se/events{/privacy}", "received_events_url": "https://api.github.com/users/m-ou-se/received_events", "type": "User", "site_admin": false}, "committer": {"login": "m-ou-se", "id": 783247, "node_id": "MDQ6VXNlcjc4MzI0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/783247?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m-ou-se", "html_url": "https://github.com/m-ou-se", "followers_url": "https://api.github.com/users/m-ou-se/followers", "following_url": "https://api.github.com/users/m-ou-se/following{/other_user}", "gists_url": "https://api.github.com/users/m-ou-se/gists{/gist_id}", "starred_url": "https://api.github.com/users/m-ou-se/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m-ou-se/subscriptions", "organizations_url": "https://api.github.com/users/m-ou-se/orgs", "repos_url": "https://api.github.com/users/m-ou-se/repos", "events_url": "https://api.github.com/users/m-ou-se/events{/privacy}", "received_events_url": "https://api.github.com/users/m-ou-se/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fb2d530dd29e72efa140f6a51f3c2ddf033bc199", "url": "https://api.github.com/repos/rust-lang/rust/commits/fb2d530dd29e72efa140f6a51f3c2ddf033bc199", "html_url": "https://github.com/rust-lang/rust/commit/fb2d530dd29e72efa140f6a51f3c2ddf033bc199"}], "stats": {"total": 26, "additions": 25, "deletions": 1}, "files": [{"sha": "6744444426472baeb402fd7a6a1a9919549183e0", "filename": "src/test/ui/fmt/format-args-capture-issue-93378.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cef9b4758386622c2c52df0920eea978786283a0/src%2Ftest%2Fui%2Ffmt%2Fformat-args-capture-issue-93378.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cef9b4758386622c2c52df0920eea978786283a0/src%2Ftest%2Fui%2Ffmt%2Fformat-args-capture-issue-93378.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffmt%2Fformat-args-capture-issue-93378.rs?ref=cef9b4758386622c2c52df0920eea978786283a0", "patch": "@@ -4,4 +4,8 @@ fn main() {\n \n     println!(\"{a} {b} {} {} {c} {}\", c = \"c\");\n     //~^ ERROR: invalid reference to positional arguments 1 and 2 (there is 1 argument)\n+\n+    let n = 1;\n+    println!(\"{a:.n$} {b:.*}\");\n+    //~^ ERROR: invalid reference to positional argument 0 (no arguments were given)\n }"}, {"sha": "588541044fe136369d16006abb4fc805a979d822", "filename": "src/test/ui/fmt/format-args-capture-issue-93378.stderr", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/cef9b4758386622c2c52df0920eea978786283a0/src%2Ftest%2Fui%2Ffmt%2Fformat-args-capture-issue-93378.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cef9b4758386622c2c52df0920eea978786283a0/src%2Ftest%2Fui%2Ffmt%2Fformat-args-capture-issue-93378.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffmt%2Fformat-args-capture-issue-93378.stderr?ref=cef9b4758386622c2c52df0920eea978786283a0", "patch": "@@ -6,5 +6,17 @@ LL |     println!(\"{a} {b} {} {} {c} {}\", c = \"c\");\n    |\n    = note: positional arguments are zero-based\n \n-error: aborting due to previous error\n+error: invalid reference to positional argument 0 (no arguments were given)\n+  --> $DIR/format-args-capture-issue-93378.rs:9:23\n+   |\n+LL |     println!(\"{a:.n$} {b:.*}\");\n+   |               ------- ^^^--^\n+   |               |          |\n+   |               |          this precision flag adds an extra required argument at position 0, which is why there are 3 arguments expected\n+   |               this parameter corresponds to the precision flag\n+   |\n+   = note: positional arguments are zero-based\n+   = note: for information about formatting flags, visit https://doc.rust-lang.org/std/fmt/index.html\n+\n+error: aborting due to 2 previous errors\n "}, {"sha": "d31d2a6c33657fff6b4975c399e33784cea5ccb2", "filename": "src/test/ui/fmt/format-args-capture.rs", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/cef9b4758386622c2c52df0920eea978786283a0/src%2Ftest%2Fui%2Ffmt%2Fformat-args-capture.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cef9b4758386622c2c52df0920eea978786283a0/src%2Ftest%2Fui%2Ffmt%2Fformat-args-capture.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffmt%2Fformat-args-capture.rs?ref=cef9b4758386622c2c52df0920eea978786283a0", "patch": "@@ -5,6 +5,7 @@ fn main() {\n     named_argument_takes_precedence_to_captured();\n     formatting_parameters_can_be_captured();\n     capture_raw_strings_and_idents();\n+    repeated_capture();\n \n     #[cfg(panic = \"unwind\")]\n     {\n@@ -80,3 +81,10 @@ fn formatting_parameters_can_be_captured() {\n     let s = format!(\"{x:-^width$.precision$}\");\n     assert_eq!(&s, \"--7.000--\");\n }\n+\n+fn repeated_capture() {\n+    let a = 1;\n+    let b = 2;\n+    let s = format!(\"{a} {b} {a}\");\n+    assert_eq!(&s, \"1 2 1\");\n+}"}]}