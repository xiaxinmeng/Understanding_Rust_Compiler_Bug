{"sha": "4db6abcd50eb07a7fa8349a059f80792b7b19a2e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRkYjZhYmNkNTBlYjA3YTdmYTgzNDlhMDU5ZjgwNzkyYjdiMTlhMmU=", "commit": {"author": {"name": "Glenn Hope", "email": "glenn.alexander.hope@gmail.com", "date": "2020-05-09T15:04:07Z"}, "committer": {"name": "Glenn Hope", "email": "glenn.alexander.hope@gmail.com", "date": "2020-05-09T18:09:38Z"}, "message": "Remove check for Fn, reflect this in test cases, make test cases more robust/explicit", "tree": {"sha": "b38a4245d906e1c5b7bef550e7bd78549aed3a4f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b38a4245d906e1c5b7bef550e7bd78549aed3a4f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4db6abcd50eb07a7fa8349a059f80792b7b19a2e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4db6abcd50eb07a7fa8349a059f80792b7b19a2e", "html_url": "https://github.com/rust-lang/rust/commit/4db6abcd50eb07a7fa8349a059f80792b7b19a2e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4db6abcd50eb07a7fa8349a059f80792b7b19a2e/comments", "author": {"login": "MrAwesome", "id": 145945, "node_id": "MDQ6VXNlcjE0NTk0NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/145945?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MrAwesome", "html_url": "https://github.com/MrAwesome", "followers_url": "https://api.github.com/users/MrAwesome/followers", "following_url": "https://api.github.com/users/MrAwesome/following{/other_user}", "gists_url": "https://api.github.com/users/MrAwesome/gists{/gist_id}", "starred_url": "https://api.github.com/users/MrAwesome/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MrAwesome/subscriptions", "organizations_url": "https://api.github.com/users/MrAwesome/orgs", "repos_url": "https://api.github.com/users/MrAwesome/repos", "events_url": "https://api.github.com/users/MrAwesome/events{/privacy}", "received_events_url": "https://api.github.com/users/MrAwesome/received_events", "type": "User", "site_admin": false}, "committer": {"login": "MrAwesome", "id": 145945, "node_id": "MDQ6VXNlcjE0NTk0NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/145945?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MrAwesome", "html_url": "https://github.com/MrAwesome", "followers_url": "https://api.github.com/users/MrAwesome/followers", "following_url": "https://api.github.com/users/MrAwesome/following{/other_user}", "gists_url": "https://api.github.com/users/MrAwesome/gists{/gist_id}", "starred_url": "https://api.github.com/users/MrAwesome/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MrAwesome/subscriptions", "organizations_url": "https://api.github.com/users/MrAwesome/orgs", "repos_url": "https://api.github.com/users/MrAwesome/repos", "events_url": "https://api.github.com/users/MrAwesome/events{/privacy}", "received_events_url": "https://api.github.com/users/MrAwesome/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "152cdcb45be7a8f0f24dbcd4177e0858d94516b6", "url": "https://api.github.com/repos/rust-lang/rust/commits/152cdcb45be7a8f0f24dbcd4177e0858d94516b6", "html_url": "https://github.com/rust-lang/rust/commit/152cdcb45be7a8f0f24dbcd4177e0858d94516b6"}], "stats": {"total": 76, "additions": 64, "deletions": 12}, "files": [{"sha": "e12a6659ab5b01a5b7118397012f00ec357162f0", "filename": "clippy_lints/src/wildcard_imports.rs", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/4db6abcd50eb07a7fa8349a059f80792b7b19a2e/clippy_lints%2Fsrc%2Fwildcard_imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4db6abcd50eb07a7fa8349a059f80792b7b19a2e/clippy_lints%2Fsrc%2Fwildcard_imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fwildcard_imports.rs?ref=4db6abcd50eb07a7fa8349a059f80792b7b19a2e", "patch": "@@ -43,9 +43,14 @@ declare_clippy_lint! {\n     ///\n     /// This can lead to confusing error messages at best and to unexpected behavior at worst.\n     ///\n-    /// Note that this will not warn about wildcard imports from modules named `prelude`; many\n-    /// crates (including the standard library) provide modules named \"prelude\" specifically\n-    /// designed for wildcard import.\n+    /// **Exceptions:**\n+    ///\n+    /// Wildcard imports are allowed from modules named `prelude`. Many crates (including the standard library)\n+    /// provide modules named \"prelude\" specifically designed for wildcard import.\n+    ///\n+    /// `use super::*` is allowed in test modules. This is defined as any module with \"test\" in the name.\n+    ///\n+    /// These exceptions can be disabled using the `warn-on-all-wildcard-imports` configuration flag.\n     ///\n     /// **Known problems:** If macros are imported through the wildcard, this macro is not included\n     /// by the suggestion and has to be added by hand.\n@@ -198,5 +203,5 @@ fn is_super_only_import(segments: &[PathSegment<'_>]) -> bool {\n }\n \n fn is_test_module_or_function(item: &Item<'_>) -> bool {\n-    matches!(item.kind, ItemKind::Fn(..) | ItemKind::Mod(..)) && item.ident.name.as_str().contains(\"test\")\n+    matches!(item.kind, ItemKind::Mod(..)) && item.ident.name.as_str().contains(\"test\")\n }"}, {"sha": "b47c8f23e2403a8b63c5303b2833ebe68e07e674", "filename": "tests/ui/wildcard_imports.fixed", "status": "modified", "additions": 23, "deletions": 2, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/4db6abcd50eb07a7fa8349a059f80792b7b19a2e/tests%2Fui%2Fwildcard_imports.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/4db6abcd50eb07a7fa8349a059f80792b7b19a2e/tests%2Fui%2Fwildcard_imports.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fwildcard_imports.fixed?ref=4db6abcd50eb07a7fa8349a059f80792b7b19a2e", "patch": "@@ -175,13 +175,34 @@ mod super_imports {\n         }\n     }\n \n-    mod inner {\n-        fn test_should_pass() {\n+    mod test_should_pass_inside_function {\n+        fn with_super_inside_function() {\n             use super::*;\n             let _ = foofoo();\n         }\n     }\n \n+    mod test_should_pass_further_inside {\n+        fn insidefoo() {}\n+        mod inner {\n+            use super::*;\n+            fn with_super() {\n+                let _ = insidefoo();\n+            }\n+        }\n+    }\n+\n+    mod should_be_replaced_futher_inside {\n+        fn insidefoo() {}\n+        mod inner {\n+            use super::insidefoo;\n+            fn with_super() {\n+                let _ = insidefoo();\n+            }\n+        }\n+    }\n+\n+\n     mod use_explicit_should_be_replaced {\n         use super_imports::foofoo;\n "}, {"sha": "3ad1a29aebad1f985a19e272ac55f071263f511c", "filename": "tests/ui/wildcard_imports.rs", "status": "modified", "additions": 22, "deletions": 2, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/4db6abcd50eb07a7fa8349a059f80792b7b19a2e/tests%2Fui%2Fwildcard_imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4db6abcd50eb07a7fa8349a059f80792b7b19a2e/tests%2Fui%2Fwildcard_imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fwildcard_imports.rs?ref=4db6abcd50eb07a7fa8349a059f80792b7b19a2e", "patch": "@@ -176,13 +176,33 @@ mod super_imports {\n         }\n     }\n \n-    mod inner {\n-        fn test_should_pass() {\n+    mod test_should_pass_inside_function {\n+        fn with_super_inside_function() {\n             use super::*;\n             let _ = foofoo();\n         }\n     }\n \n+    mod test_should_pass_further_inside {\n+        fn insidefoo() {}\n+        mod inner {\n+            use super::*;\n+            fn with_super() {\n+                let _ = insidefoo();\n+            }\n+        }\n+    }\n+\n+    mod should_be_replaced_futher_inside {\n+        fn insidefoo() {}\n+        mod inner {\n+            use super::*;\n+            fn with_super() {\n+                let _ = insidefoo();\n+            }\n+        }\n+    }\n+\n     mod use_explicit_should_be_replaced {\n         use super_imports::*;\n "}, {"sha": "de07bd1d69ba1ec9decc05da407336e75da83f0c", "filename": "tests/ui/wildcard_imports.stderr", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/4db6abcd50eb07a7fa8349a059f80792b7b19a2e/tests%2Fui%2Fwildcard_imports.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4db6abcd50eb07a7fa8349a059f80792b7b19a2e/tests%2Fui%2Fwildcard_imports.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fwildcard_imports.stderr?ref=4db6abcd50eb07a7fa8349a059f80792b7b19a2e", "patch": "@@ -99,22 +99,28 @@ LL |         use super::*;\n    |             ^^^^^^^^ help: try: `super::foofoo`\n \n error: usage of wildcard import\n-  --> $DIR/wildcard_imports.rs:187:13\n+  --> $DIR/wildcard_imports.rs:199:17\n+   |\n+LL |             use super::*;\n+   |                 ^^^^^^^^ help: try: `super::insidefoo`\n+\n+error: usage of wildcard import\n+  --> $DIR/wildcard_imports.rs:208:13\n    |\n LL |         use super_imports::*;\n    |             ^^^^^^^^^^^^^^^^ help: try: `super_imports::foofoo`\n \n error: usage of wildcard import\n-  --> $DIR/wildcard_imports.rs:196:17\n+  --> $DIR/wildcard_imports.rs:217:17\n    |\n LL |             use super::super::*;\n    |                 ^^^^^^^^^^^^^^^ help: try: `super::super::foofoo`\n \n error: usage of wildcard import\n-  --> $DIR/wildcard_imports.rs:205:13\n+  --> $DIR/wildcard_imports.rs:226:13\n    |\n LL |         use super::super::super_imports::*;\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `super::super::super_imports::foofoo`\n \n-error: aborting due to 19 previous errors\n+error: aborting due to 20 previous errors\n "}]}