{"sha": "53d58dbf5f8a65189e5f97ef46da6593484a9e79", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUzZDU4ZGJmNWY4YTY1MTg5ZTVmOTdlZjQ2ZGE2NTkzNDg0YTllNzk=", "commit": {"author": {"name": "Luca Barbieri", "email": "luca@luca-barbieri.com", "date": "2020-04-10T20:42:19Z"}, "committer": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2020-04-11T21:49:16Z"}, "message": "Require compiler-rt root at ../src/llvm-project/compiler-rt", "tree": {"sha": "3312976ae8b46bb6c65a1540993e63b4007bfec2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3312976ae8b46bb6c65a1540993e63b4007bfec2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/53d58dbf5f8a65189e5f97ef46da6593484a9e79", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/53d58dbf5f8a65189e5f97ef46da6593484a9e79", "html_url": "https://github.com/rust-lang/rust/commit/53d58dbf5f8a65189e5f97ef46da6593484a9e79", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/53d58dbf5f8a65189e5f97ef46da6593484a9e79/comments", "author": {"login": "luca-barbieri", "id": 298418, "node_id": "MDQ6VXNlcjI5ODQxOA==", "avatar_url": "https://avatars.githubusercontent.com/u/298418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luca-barbieri", "html_url": "https://github.com/luca-barbieri", "followers_url": "https://api.github.com/users/luca-barbieri/followers", "following_url": "https://api.github.com/users/luca-barbieri/following{/other_user}", "gists_url": "https://api.github.com/users/luca-barbieri/gists{/gist_id}", "starred_url": "https://api.github.com/users/luca-barbieri/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luca-barbieri/subscriptions", "organizations_url": "https://api.github.com/users/luca-barbieri/orgs", "repos_url": "https://api.github.com/users/luca-barbieri/repos", "events_url": "https://api.github.com/users/luca-barbieri/events{/privacy}", "received_events_url": "https://api.github.com/users/luca-barbieri/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ac2b84f9628c46c9c7e6c4870054f372962079ed", "url": "https://api.github.com/repos/rust-lang/rust/commits/ac2b84f9628c46c9c7e6c4870054f372962079ed", "html_url": "https://github.com/rust-lang/rust/commit/ac2b84f9628c46c9c7e6c4870054f372962079ed"}], "stats": {"total": 7, "additions": 5, "deletions": 2}, "files": [{"sha": "f44096af6dd53bb9c7a314de2f075f54278368e3", "filename": "src/bootstrap/compile.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/53d58dbf5f8a65189e5f97ef46da6593484a9e79/src%2Fbootstrap%2Fcompile.rs", "raw_url": "https://github.com/rust-lang/rust/raw/53d58dbf5f8a65189e5f97ef46da6593484a9e79/src%2Fbootstrap%2Fcompile.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fcompile.rs?ref=53d58dbf5f8a65189e5f97ef46da6593484a9e79", "patch": "@@ -186,6 +186,8 @@ pub fn std_cargo(builder: &Builder<'_>, target: Interned<String>, cargo: &mut Ca\n     // `compiler-rt` is located.\n     let compiler_builtins_root = builder.src.join(\"src/llvm-project/compiler-rt\");\n     let compiler_builtins_c_feature = if compiler_builtins_root.exists() {\n+        // Note that `libprofiler_builtins/build.rs` also computes this so if\n+        // you're changing something here please also change that.\n         cargo.env(\"RUST_COMPILER_RT_ROOT\", &compiler_builtins_root);\n         \" compiler-builtins-c\".to_string()\n     } else {"}, {"sha": "e23e2f2c1306f6a4caece4226eba825a4b9bbd63", "filename": "src/libprofiler_builtins/build.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/53d58dbf5f8a65189e5f97ef46da6593484a9e79/src%2Flibprofiler_builtins%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/53d58dbf5f8a65189e5f97ef46da6593484a9e79/src%2Flibprofiler_builtins%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibprofiler_builtins%2Fbuild.rs?ref=53d58dbf5f8a65189e5f97ef46da6593484a9e79", "patch": "@@ -63,8 +63,9 @@ fn main() {\n         cfg.define(\"COMPILER_RT_HAS_ATOMICS\", Some(\"1\"));\n     }\n \n-    let root = env::var_os(\"RUST_COMPILER_RT_ROOT\").unwrap();\n-    let root = Path::new(&root);\n+    // Note that this should exist if we're going to run (otherwise we just\n+    // don't build profiler builtins at all).\n+    let root = Path::new(\"../llvm-project/compiler-rt\");\n \n     let src_root = root.join(\"lib\").join(\"profile\");\n     for src in profile_sources {"}]}