{"sha": "a8ceab9cd78aa276ac988866be8344e92322e09c", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE4Y2VhYjljZDc4YWEyNzZhYzk4ODg2NmJlODM0NGU5MjMyMmUwOWM=", "commit": {"author": {"name": "Eduard-Mihai Burtescu", "email": "edy.burt@gmail.com", "date": "2018-05-21T15:30:55Z"}, "committer": {"name": "Eduard-Mihai Burtescu", "email": "edy.burt@gmail.com", "date": "2018-05-21T17:39:59Z"}, "message": "rustc_codegen_llvm: remove debuginfo::VariableKind::CapturedVariable.", "tree": {"sha": "8ec60757b50d0e72f167d8cb383e4c25c1d0c7d0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8ec60757b50d0e72f167d8cb383e4c25c1d0c7d0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a8ceab9cd78aa276ac988866be8344e92322e09c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a8ceab9cd78aa276ac988866be8344e92322e09c", "html_url": "https://github.com/rust-lang/rust/commit/a8ceab9cd78aa276ac988866be8344e92322e09c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a8ceab9cd78aa276ac988866be8344e92322e09c/comments", "author": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "98686ca2944db341b0933e341b1e9029a905e322", "url": "https://api.github.com/repos/rust-lang/rust/commits/98686ca2944db341b0933e341b1e9029a905e322", "html_url": "https://github.com/rust-lang/rust/commit/98686ca2944db341b0933e341b1e9029a905e322"}], "stats": {"total": 14, "additions": 3, "deletions": 11}, "files": [{"sha": "803966145f773268c1a513909be6e05e0c357a60", "filename": "src/librustc_codegen_llvm/debuginfo/mod.rs", "status": "modified", "additions": 2, "deletions": 10, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/a8ceab9cd78aa276ac988866be8344e92322e09c/src%2Flibrustc_codegen_llvm%2Fdebuginfo%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8ceab9cd78aa276ac988866be8344e92322e09c/src%2Flibrustc_codegen_llvm%2Fdebuginfo%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fdebuginfo%2Fmod.rs?ref=a8ceab9cd78aa276ac988866be8344e92322e09c", "patch": "@@ -147,7 +147,6 @@ pub enum VariableAccess<'a> {\n pub enum VariableKind {\n     ArgumentVariable(usize /*index*/),\n     LocalVariable,\n-    CapturedVariable,\n }\n \n /// Create any deferred debug metadata nodes\n@@ -478,6 +477,7 @@ pub fn declare_local<'a, 'tcx>(bx: &Builder<'a, 'tcx>,\n                                variable_access: VariableAccess,\n                                variable_kind: VariableKind,\n                                span: Span) {\n+    assert!(!dbg_context.get_ref(span).source_locations_enabled.get());\n     let cx = bx.cx;\n \n     let file = span_start(cx, span).file;\n@@ -490,8 +490,7 @@ pub fn declare_local<'a, 'tcx>(bx: &Builder<'a, 'tcx>,\n \n     let (argument_index, dwarf_tag) = match variable_kind {\n         ArgumentVariable(index) => (index as c_uint, DW_TAG_arg_variable),\n-        LocalVariable    |\n-        CapturedVariable => (0, DW_TAG_auto_variable)\n+        LocalVariable => (0, DW_TAG_auto_variable)\n     };\n     let align = cx.align_of(variable_type);\n \n@@ -529,14 +528,7 @@ pub fn declare_local<'a, 'tcx>(bx: &Builder<'a, 'tcx>,\n \n                 llvm::LLVMSetInstDebugLocation(bx.llbuilder, instr);\n             }\n-        }\n-    }\n-\n-    match variable_kind {\n-        ArgumentVariable(_) | CapturedVariable => {\n-            assert!(!dbg_context.get_ref(span).source_locations_enabled.get());\n             source_loc::set_debug_location(bx, UnknownLocation);\n         }\n-        _ => { /* nothing to do */ }\n     }\n }"}, {"sha": "a91a6e251aa7d06dfa1914438f4cfde51984dc49", "filename": "src/librustc_codegen_llvm/mir/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a8ceab9cd78aa276ac988866be8344e92322e09c/src%2Flibrustc_codegen_llvm%2Fmir%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8ceab9cd78aa276ac988866be8344e92322e09c/src%2Flibrustc_codegen_llvm%2Fmir%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fmir%2Fmod.rs?ref=a8ceab9cd78aa276ac988866be8344e92322e09c", "patch": "@@ -634,7 +634,7 @@ fn arg_local_refs<'a, 'tcx>(bx: &Builder<'a, 'tcx>,\n                     ty,\n                     scope,\n                     variable_access,\n-                    VariableKind::CapturedVariable,\n+                    VariableKind::LocalVariable,\n                     DUMMY_SP\n                 );\n             }"}]}