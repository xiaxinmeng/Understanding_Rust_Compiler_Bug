{"sha": "f38ec9ca34c501b2a618178a14fe2a3c9979ddc9", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYzOGVjOWNhMzRjNTAxYjJhNjE4MTc4YTE0ZmUyYTNjOTk3OWRkYzk=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2021-09-08T17:41:46Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2021-09-09T13:14:16Z"}, "message": "Revert \"Add test for restriction of anonymous types on validation\"\n\nThis reverts commit 8a1dd6918bb686a960ad5ced46a16b5b59668464.", "tree": {"sha": "8772cf80fbd4d8951e820d5e6f021410dac058b8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8772cf80fbd4d8951e820d5e6f021410dac058b8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f38ec9ca34c501b2a618178a14fe2a3c9979ddc9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f38ec9ca34c501b2a618178a14fe2a3c9979ddc9", "html_url": "https://github.com/rust-lang/rust/commit/f38ec9ca34c501b2a618178a14fe2a3c9979ddc9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f38ec9ca34c501b2a618178a14fe2a3c9979ddc9/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5560f6d90a6a15fdb52a30f97d28b439b72f6cf3", "url": "https://api.github.com/repos/rust-lang/rust/commits/5560f6d90a6a15fdb52a30f97d28b439b72f6cf3", "html_url": "https://github.com/rust-lang/rust/commit/5560f6d90a6a15fdb52a30f97d28b439b72f6cf3"}], "stats": {"total": 227, "additions": 0, "deletions": 227}, "files": [{"sha": "99637d1105301e6e34ce6097da15157d2d1ad88a", "filename": "src/test/ui/unnamed_fields/restrict_anonymous.rs", "status": "removed", "additions": 0, "deletions": 52, "changes": 52, "blob_url": "https://github.com/rust-lang/rust/blob/5560f6d90a6a15fdb52a30f97d28b439b72f6cf3/src%2Ftest%2Fui%2Funnamed_fields%2Frestrict_anonymous.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5560f6d90a6a15fdb52a30f97d28b439b72f6cf3/src%2Ftest%2Fui%2Funnamed_fields%2Frestrict_anonymous.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Funnamed_fields%2Frestrict_anonymous.rs?ref=5560f6d90a6a15fdb52a30f97d28b439b72f6cf3", "patch": "@@ -1,52 +0,0 @@\n-#![allow(incomplete_features)]\n-#![feature(unnamed_fields)]\n-\n-fn f() -> struct { field: u8 } {} //~ ERROR anonymous structs are not allowed outside of unnamed struct or union fields\n-//~^ ERROR anonymous structs are unimplemented\n-\n-fn f2(a: struct { field: u8 } ) {} //~ ERROR anonymous structs are not allowed outside of unnamed struct or union fields\n-//~^ ERROR anonymous structs are unimplemented\n-\n-union G {\n-    field: struct { field: u8 } //~ ERROR anonymous structs are not allowed outside of unnamed struct or union fields\n-    //~^ ERROR anonymous structs are unimplemented\n-}\n-//~| ERROR unions may not contain fields that need dropping [E0740]\n-\n-struct H { _: u8 } // Should error after hir checks\n-\n-struct I(struct { field: u8 }, u8); //~ ERROR anonymous structs are not allowed outside of unnamed struct or union fields\n-//~^ ERROR anonymous structs are unimplemented\n-\n-enum J {\n-    K(struct { field: u8 }), //~ ERROR anonymous structs are not allowed outside of unnamed struct or union fields\n-    //~^ ERROR anonymous structs are unimplemented\n-    L {\n-        _ : struct { field: u8 } //~ ERROR anonymous structs are not allowed outside of unnamed struct or union fields\n-        //~^ ERROR anonymous fields are not allowed outside of structs or unions\n-        //~| ERROR anonymous structs are unimplemented\n-    },\n-    M {\n-        _ : u8 //~ ERROR anonymous fields are not allowed outside of structs or unions\n-    }\n-}\n-\n-static M: union { field: u8 } = 0; //~ ERROR anonymous unions are not allowed outside of unnamed struct or union fields\n-//~^ ERROR anonymous unions are unimplemented\n-\n-type N = union { field: u8 }; //~ ERROR anonymous unions are not allowed outside of unnamed struct or union fields\n-//~^ ERROR anonymous unions are unimplemented\n-\n-fn main() {\n-    const O: struct { field: u8 } = 0; //~ ERROR anonymous structs are not allowed outside of unnamed struct or union fields\n-    //~^ ERROR anonymous structs are unimplemented\n-\n-    let p: [struct { field: u8 }; 1]; //~ ERROR anonymous structs are not allowed outside of unnamed struct or union fields\n-    //~^ ERROR anonymous structs are unimplemented\n-\n-    let q: (struct { field: u8 }, u8); //~ ERROR anonymous structs are not allowed outside of unnamed struct or union fields\n-    //~^ ERROR anonymous structs are unimplemented\n-\n-    let cl = || -> struct { field: u8 } {}; //~ ERROR anonymous structs are not allowed outside of unnamed struct or union fields\n-    //~^ ERROR anonymous structs are unimplemented\n-}"}, {"sha": "efcf544fde4dcc5662b20e51b91cf84c19ffc0cd", "filename": "src/test/ui/unnamed_fields/restrict_anonymous.stderr", "status": "removed", "additions": 0, "deletions": 175, "changes": 175, "blob_url": "https://github.com/rust-lang/rust/blob/5560f6d90a6a15fdb52a30f97d28b439b72f6cf3/src%2Ftest%2Fui%2Funnamed_fields%2Frestrict_anonymous.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5560f6d90a6a15fdb52a30f97d28b439b72f6cf3/src%2Ftest%2Fui%2Funnamed_fields%2Frestrict_anonymous.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Funnamed_fields%2Frestrict_anonymous.stderr?ref=5560f6d90a6a15fdb52a30f97d28b439b72f6cf3", "patch": "@@ -1,175 +0,0 @@\n-error: anonymous structs are not allowed outside of unnamed struct or union fields\n-  --> $DIR/restrict_anonymous.rs:4:11\n-   |\n-LL | fn f() -> struct { field: u8 } {}\n-   |           ^^^^^^^^^^^^^^^^^^^^ anonymous struct declared here\n-\n-error: anonymous structs are not allowed outside of unnamed struct or union fields\n-  --> $DIR/restrict_anonymous.rs:7:10\n-   |\n-LL | fn f2(a: struct { field: u8 } ) {}\n-   |          ^^^^^^^^^^^^^^^^^^^^ anonymous struct declared here\n-\n-error: anonymous structs are not allowed outside of unnamed struct or union fields\n-  --> $DIR/restrict_anonymous.rs:11:12\n-   |\n-LL |     field: struct { field: u8 }\n-   |            ^^^^^^^^^^^^^^^^^^^^ anonymous struct declared here\n-\n-error: anonymous structs are not allowed outside of unnamed struct or union fields\n-  --> $DIR/restrict_anonymous.rs:18:10\n-   |\n-LL | struct I(struct { field: u8 }, u8);\n-   |          ^^^^^^^^^^^^^^^^^^^^ anonymous struct declared here\n-\n-error: anonymous structs are not allowed outside of unnamed struct or union fields\n-  --> $DIR/restrict_anonymous.rs:22:7\n-   |\n-LL |     K(struct { field: u8 }),\n-   |       ^^^^^^^^^^^^^^^^^^^^ anonymous struct declared here\n-\n-error: anonymous fields are not allowed outside of structs or unions\n-  --> $DIR/restrict_anonymous.rs:25:9\n-   |\n-LL |         _ : struct { field: u8 }\n-   |         -^^^^^^^^^^^^^^^^^^^^^^^\n-   |         |\n-   |         anonymous field declared here\n-\n-error: anonymous structs are not allowed outside of unnamed struct or union fields\n-  --> $DIR/restrict_anonymous.rs:25:13\n-   |\n-LL |         _ : struct { field: u8 }\n-   |             ^^^^^^^^^^^^^^^^^^^^ anonymous struct declared here\n-\n-error: anonymous fields are not allowed outside of structs or unions\n-  --> $DIR/restrict_anonymous.rs:30:9\n-   |\n-LL |         _ : u8\n-   |         -^^^^^\n-   |         |\n-   |         anonymous field declared here\n-\n-error: anonymous unions are not allowed outside of unnamed struct or union fields\n-  --> $DIR/restrict_anonymous.rs:34:11\n-   |\n-LL | static M: union { field: u8 } = 0;\n-   |           ^^^^^^^^^^^^^^^^^^^ anonymous union declared here\n-\n-error: anonymous unions are not allowed outside of unnamed struct or union fields\n-  --> $DIR/restrict_anonymous.rs:37:10\n-   |\n-LL | type N = union { field: u8 };\n-   |          ^^^^^^^^^^^^^^^^^^^ anonymous union declared here\n-\n-error: anonymous structs are not allowed outside of unnamed struct or union fields\n-  --> $DIR/restrict_anonymous.rs:41:14\n-   |\n-LL |     const O: struct { field: u8 } = 0;\n-   |              ^^^^^^^^^^^^^^^^^^^^ anonymous struct declared here\n-\n-error: anonymous structs are not allowed outside of unnamed struct or union fields\n-  --> $DIR/restrict_anonymous.rs:44:13\n-   |\n-LL |     let p: [struct { field: u8 }; 1];\n-   |             ^^^^^^^^^^^^^^^^^^^^ anonymous struct declared here\n-\n-error: anonymous structs are not allowed outside of unnamed struct or union fields\n-  --> $DIR/restrict_anonymous.rs:47:13\n-   |\n-LL |     let q: (struct { field: u8 }, u8);\n-   |             ^^^^^^^^^^^^^^^^^^^^ anonymous struct declared here\n-\n-error: anonymous structs are not allowed outside of unnamed struct or union fields\n-  --> $DIR/restrict_anonymous.rs:50:20\n-   |\n-LL |     let cl = || -> struct { field: u8 } {};\n-   |                    ^^^^^^^^^^^^^^^^^^^^ anonymous struct declared here\n-\n-error: anonymous structs are unimplemented\n-  --> $DIR/restrict_anonymous.rs:4:11\n-   |\n-LL | fn f() -> struct { field: u8 } {}\n-   |           ^^^^^^^^^^^^^^^^^^^^\n-\n-error: anonymous structs are unimplemented\n-  --> $DIR/restrict_anonymous.rs:7:10\n-   |\n-LL | fn f2(a: struct { field: u8 } ) {}\n-   |          ^^^^^^^^^^^^^^^^^^^^\n-\n-error: anonymous structs are unimplemented\n-  --> $DIR/restrict_anonymous.rs:11:12\n-   |\n-LL |     field: struct { field: u8 }\n-   |            ^^^^^^^^^^^^^^^^^^^^\n-\n-error: anonymous structs are unimplemented\n-  --> $DIR/restrict_anonymous.rs:18:10\n-   |\n-LL | struct I(struct { field: u8 }, u8);\n-   |          ^^^^^^^^^^^^^^^^^^^^\n-\n-error: anonymous structs are unimplemented\n-  --> $DIR/restrict_anonymous.rs:22:7\n-   |\n-LL |     K(struct { field: u8 }),\n-   |       ^^^^^^^^^^^^^^^^^^^^\n-\n-error: anonymous structs are unimplemented\n-  --> $DIR/restrict_anonymous.rs:25:13\n-   |\n-LL |         _ : struct { field: u8 }\n-   |             ^^^^^^^^^^^^^^^^^^^^\n-\n-error: anonymous unions are unimplemented\n-  --> $DIR/restrict_anonymous.rs:34:11\n-   |\n-LL | static M: union { field: u8 } = 0;\n-   |           ^^^^^^^^^^^^^^^^^^^\n-\n-error: anonymous unions are unimplemented\n-  --> $DIR/restrict_anonymous.rs:37:10\n-   |\n-LL | type N = union { field: u8 };\n-   |          ^^^^^^^^^^^^^^^^^^^\n-\n-error: anonymous structs are unimplemented\n-  --> $DIR/restrict_anonymous.rs:44:13\n-   |\n-LL |     let p: [struct { field: u8 }; 1];\n-   |             ^^^^^^^^^^^^^^^^^^^^\n-\n-error: anonymous structs are unimplemented\n-  --> $DIR/restrict_anonymous.rs:47:13\n-   |\n-LL |     let q: (struct { field: u8 }, u8);\n-   |             ^^^^^^^^^^^^^^^^^^^^\n-\n-error: anonymous structs are unimplemented\n-  --> $DIR/restrict_anonymous.rs:50:20\n-   |\n-LL |     let cl = || -> struct { field: u8 } {};\n-   |                    ^^^^^^^^^^^^^^^^^^^^\n-\n-error: anonymous structs are unimplemented\n-  --> $DIR/restrict_anonymous.rs:41:14\n-   |\n-LL |     const O: struct { field: u8 } = 0;\n-   |              ^^^^^^^^^^^^^^^^^^^^\n-\n-error[E0740]: unions may not contain fields that need dropping\n-  --> $DIR/restrict_anonymous.rs:11:5\n-   |\n-LL |     field: struct { field: u8 }\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-note: `std::mem::ManuallyDrop` can be used to wrap the type\n-  --> $DIR/restrict_anonymous.rs:11:5\n-   |\n-LL |     field: struct { field: u8 }\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-\n-error: aborting due to 27 previous errors\n-\n-For more information about this error, try `rustc --explain E0740`."}]}