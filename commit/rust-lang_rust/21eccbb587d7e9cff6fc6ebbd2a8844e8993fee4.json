{"sha": "21eccbb587d7e9cff6fc6ebbd2a8844e8993fee4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIxZWNjYmI1ODdkN2U5Y2ZmNmZjNmViYmQyYTg4NDRlODk5M2ZlZTQ=", "commit": {"author": {"name": "Matthew Jasper", "email": "mjjasper1@gmail.com", "date": "2020-07-01T20:56:35Z"}, "committer": {"name": "Matthew Jasper", "email": "mjjasper1@gmail.com", "date": "2020-10-06T10:19:30Z"}, "message": "Fix ICE", "tree": {"sha": "79d3021d360b90e5fc1ea0ef86583b37da689d8a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/79d3021d360b90e5fc1ea0ef86583b37da689d8a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/21eccbb587d7e9cff6fc6ebbd2a8844e8993fee4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/21eccbb587d7e9cff6fc6ebbd2a8844e8993fee4", "html_url": "https://github.com/rust-lang/rust/commit/21eccbb587d7e9cff6fc6ebbd2a8844e8993fee4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/21eccbb587d7e9cff6fc6ebbd2a8844e8993fee4/comments", "author": {"login": "matthewjasper", "id": 20113453, "node_id": "MDQ6VXNlcjIwMTEzNDUz", "avatar_url": "https://avatars.githubusercontent.com/u/20113453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthewjasper", "html_url": "https://github.com/matthewjasper", "followers_url": "https://api.github.com/users/matthewjasper/followers", "following_url": "https://api.github.com/users/matthewjasper/following{/other_user}", "gists_url": "https://api.github.com/users/matthewjasper/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthewjasper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthewjasper/subscriptions", "organizations_url": "https://api.github.com/users/matthewjasper/orgs", "repos_url": "https://api.github.com/users/matthewjasper/repos", "events_url": "https://api.github.com/users/matthewjasper/events{/privacy}", "received_events_url": "https://api.github.com/users/matthewjasper/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matthewjasper", "id": 20113453, "node_id": "MDQ6VXNlcjIwMTEzNDUz", "avatar_url": "https://avatars.githubusercontent.com/u/20113453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthewjasper", "html_url": "https://github.com/matthewjasper", "followers_url": "https://api.github.com/users/matthewjasper/followers", "following_url": "https://api.github.com/users/matthewjasper/following{/other_user}", "gists_url": "https://api.github.com/users/matthewjasper/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthewjasper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthewjasper/subscriptions", "organizations_url": "https://api.github.com/users/matthewjasper/orgs", "repos_url": "https://api.github.com/users/matthewjasper/repos", "events_url": "https://api.github.com/users/matthewjasper/events{/privacy}", "received_events_url": "https://api.github.com/users/matthewjasper/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0dda4154bd254b629567739085471b8e50676c83", "url": "https://api.github.com/repos/rust-lang/rust/commits/0dda4154bd254b629567739085471b8e50676c83", "html_url": "https://github.com/rust-lang/rust/commit/0dda4154bd254b629567739085471b8e50676c83"}], "stats": {"total": 9, "additions": 5, "deletions": 4}, "files": [{"sha": "319217e8fdc449863275cc33eeeb33b831c363d2", "filename": "compiler/rustc_trait_selection/src/traits/select/confirmation.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/21eccbb587d7e9cff6fc6ebbd2a8844e8993fee4/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fselect%2Fconfirmation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/21eccbb587d7e9cff6fc6ebbd2a8844e8993fee4/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fselect%2Fconfirmation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fselect%2Fconfirmation.rs?ref=21eccbb587d7e9cff6fc6ebbd2a8844e8993fee4", "patch": "@@ -342,7 +342,8 @@ impl<'cx, 'tcx> SelectionContext<'cx, 'tcx> {\n     ) -> ImplSourceObjectData<'tcx, PredicateObligation<'tcx>> {\n         debug!(\"confirm_object_candidate({:?})\", obligation);\n \n-        let self_ty = self.infcx.replace_bound_vars_with_placeholders(&obligation.self_ty());\n+        let self_ty = self.infcx.shallow_resolve(obligation.self_ty());\n+        let self_ty = self.infcx.replace_bound_vars_with_placeholders(&self_ty);\n         let data = match self_ty.kind() {\n             ty::Dynamic(data, ..) => data,\n             _ => span_bug!(obligation.cause.span, \"object candidate with non-object\"),\n@@ -448,7 +449,7 @@ impl<'cx, 'tcx> SelectionContext<'cx, 'tcx> {\n         )\n         .map_bound(|(trait_ref, _)| trait_ref);\n \n-        let Normalized { value: trait_ref, obligations } = ensure_sufficient_stack(|| {\n+        let Normalized { value: trait_ref, mut obligations } = ensure_sufficient_stack(|| {\n             project::normalize_with_depth(\n                 self,\n                 obligation.param_env,\n@@ -458,12 +459,12 @@ impl<'cx, 'tcx> SelectionContext<'cx, 'tcx> {\n             )\n         });\n \n-        self.confirm_poly_trait_refs(\n+        obligations.extend(self.confirm_poly_trait_refs(\n             obligation.cause.clone(),\n             obligation.param_env,\n             obligation.predicate.to_poly_trait_ref(),\n             trait_ref,\n-        )?;\n+        )?);\n         Ok(ImplSourceFnPointerData { fn_ty: self_ty, nested: obligations })\n     }\n "}]}