{"sha": "d03185ed98b4ff022a111993d138923dbc8d5052", "node_id": "C_kwDOAAsO6NoAKGQwMzE4NWVkOThiNGZmMDIyYTExMTk5M2QxMzg5MjNkYmM4ZDUwNTI", "commit": {"author": {"name": "Ayrton", "email": "a.munoz3327@gmail.com", "date": "2022-10-05T01:37:30Z"}, "committer": {"name": "Ayrton", "email": "a.munoz3327@gmail.com", "date": "2022-10-10T16:07:22Z"}, "message": "Add Sony PlayStation 1 tier 3 target", "tree": {"sha": "87ba963fad6e6b04b330911fbe500023918c3ae8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/87ba963fad6e6b04b330911fbe500023918c3ae8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d03185ed98b4ff022a111993d138923dbc8d5052", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d03185ed98b4ff022a111993d138923dbc8d5052", "html_url": "https://github.com/rust-lang/rust/commit/d03185ed98b4ff022a111993d138923dbc8d5052", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d03185ed98b4ff022a111993d138923dbc8d5052/comments", "author": {"login": "ayrtonm", "id": 4975834, "node_id": "MDQ6VXNlcjQ5NzU4MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4975834?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ayrtonm", "html_url": "https://github.com/ayrtonm", "followers_url": "https://api.github.com/users/ayrtonm/followers", "following_url": "https://api.github.com/users/ayrtonm/following{/other_user}", "gists_url": "https://api.github.com/users/ayrtonm/gists{/gist_id}", "starred_url": "https://api.github.com/users/ayrtonm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ayrtonm/subscriptions", "organizations_url": "https://api.github.com/users/ayrtonm/orgs", "repos_url": "https://api.github.com/users/ayrtonm/repos", "events_url": "https://api.github.com/users/ayrtonm/events{/privacy}", "received_events_url": "https://api.github.com/users/ayrtonm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ayrtonm", "id": 4975834, "node_id": "MDQ6VXNlcjQ5NzU4MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4975834?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ayrtonm", "html_url": "https://github.com/ayrtonm", "followers_url": "https://api.github.com/users/ayrtonm/followers", "following_url": "https://api.github.com/users/ayrtonm/following{/other_user}", "gists_url": "https://api.github.com/users/ayrtonm/gists{/gist_id}", "starred_url": "https://api.github.com/users/ayrtonm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ayrtonm/subscriptions", "organizations_url": "https://api.github.com/users/ayrtonm/orgs", "repos_url": "https://api.github.com/users/ayrtonm/repos", "events_url": "https://api.github.com/users/ayrtonm/events{/privacy}", "received_events_url": "https://api.github.com/users/ayrtonm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c27948d255167d827421401950c6d723ba28de8f", "url": "https://api.github.com/repos/rust-lang/rust/commits/c27948d255167d827421401950c6d723ba28de8f", "html_url": "https://github.com/rust-lang/rust/commit/c27948d255167d827421401950c6d723ba28de8f"}], "stats": {"total": 89, "additions": 89, "deletions": 0}, "files": [{"sha": "12a66efdd46f9af10bd20ad8ed599a17247f4e27", "filename": "compiler/rustc_target/src/spec/mipsel_sony_psx.rs", "status": "added", "additions": 37, "deletions": 0, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/d03185ed98b4ff022a111993d138923dbc8d5052/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmipsel_sony_psx.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d03185ed98b4ff022a111993d138923dbc8d5052/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmipsel_sony_psx.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmipsel_sony_psx.rs?ref=d03185ed98b4ff022a111993d138923dbc8d5052", "patch": "@@ -0,0 +1,37 @@\n+use crate::spec::{cvs, Cc, LinkerFlavor, Lld, PanicStrategy, RelocModel, Target, TargetOptions};\n+\n+pub fn target() -> Target {\n+    Target {\n+        llvm_target: \"mipsel-sony-psx\".into(),\n+        pointer_width: 32,\n+        data_layout: \"e-m:m-p:32:32-i8:8:32-i16:16:32-i64:64-n32-S64\".into(),\n+        arch: \"mips\".into(),\n+\n+        options: TargetOptions {\n+            os: \"none\".into(),\n+            env: \"psx\".into(),\n+            vendor: \"sony\".into(),\n+            linker_flavor: LinkerFlavor::Gnu(Cc::No, Lld::Yes),\n+            cpu: \"mips1\".into(),\n+            executables: true,\n+            linker: Some(\"rust-lld\".into()),\n+            relocation_model: RelocModel::Static,\n+            exe_suffix: \".exe\".into(),\n+\n+            // PSX doesn't natively support floats.\n+            features: \"+soft-float\".into(),\n+\n+            // This should be 16 bits, but LLVM incorrectly tries emitting MIPS-II SYNC instructions\n+            // for atomic loads and stores. This crashes rustc so we have to disable the Atomic* API\n+            // until this is fixed upstream. See https://reviews.llvm.org/D122427#3420144 for more\n+            // info.\n+            max_atomic_width: Some(0),\n+\n+            // PSX does not support trap-on-condition instructions.\n+            llvm_args: cvs![\"-mno-check-zero-division\"],\n+            llvm_abiname: \"o32\".into(),\n+            panic_strategy: PanicStrategy::Abort,\n+            ..Default::default()\n+        },\n+    }\n+}"}, {"sha": "3ddabe84395acce5b46041a8394c8d012b8ae869", "filename": "compiler/rustc_target/src/spec/mod.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d03185ed98b4ff022a111993d138923dbc8d5052/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d03185ed98b4ff022a111993d138923dbc8d5052/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs?ref=d03185ed98b4ff022a111993d138923dbc8d5052", "patch": "@@ -1222,6 +1222,7 @@ supported_targets! {\n     (\"armv7a-kmc-solid_asp3-eabihf\", armv7a_kmc_solid_asp3_eabihf),\n \n     (\"mipsel-sony-psp\", mipsel_sony_psp),\n+    (\"mipsel-sony-psx\", mipsel_sony_psx),\n     (\"mipsel-unknown-none\", mipsel_unknown_none),\n     (\"thumbv4t-none-eabi\", thumbv4t_none_eabi),\n     (\"armv4t-none-eabi\", armv4t_none_eabi),"}, {"sha": "86bb2c0d3816ae2c94b3fb4ba11f299cdcae8c2c", "filename": "src/doc/rustc/src/SUMMARY.md", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d03185ed98b4ff022a111993d138923dbc8d5052/src%2Fdoc%2Frustc%2Fsrc%2FSUMMARY.md", "raw_url": "https://github.com/rust-lang/rust/raw/d03185ed98b4ff022a111993d138923dbc8d5052/src%2Fdoc%2Frustc%2Fsrc%2FSUMMARY.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2FSUMMARY.md?ref=d03185ed98b4ff022a111993d138923dbc8d5052", "patch": "@@ -29,6 +29,7 @@\n     - [\\*-kmc-solid_\\*](platform-support/kmc-solid.md)\n     - [m68k-unknown-linux-gnu](platform-support/m68k-unknown-linux-gnu.md)\n     - [mips64-openwrt-linux-musl](platform-support/mips64-openwrt-linux-musl.md)\n+    - [mipsel-sony-psx](platform-support/mipsel-sony-psx.md)\n     - [nvptx64-nvidia-cuda](platform-support/nvptx64-nvidia-cuda.md)\n     - [riscv32imac-unknown-xous-elf](platform-support/riscv32imac-unknown-xous-elf.md)\n     - [*-pc-windows-gnullvm](platform-support/pc-windows-gnullvm.md)"}, {"sha": "3ae9872cf62d4e8304d7b34d1bbe63fffa347194", "filename": "src/doc/rustc/src/platform-support.md", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d03185ed98b4ff022a111993d138923dbc8d5052/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md", "raw_url": "https://github.com/rust-lang/rust/raw/d03185ed98b4ff022a111993d138923dbc8d5052/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md?ref=d03185ed98b4ff022a111993d138923dbc8d5052", "patch": "@@ -260,6 +260,7 @@ target | std | host | notes\n `mips-unknown-linux-uclibc` | \u2713 |  | MIPS Linux with uClibc\n [`mips64-openwrt-linux-musl`](platform-support/mips64-openwrt-linux-musl.md) | ? |  | MIPS64 for OpenWrt Linux MUSL\n `mipsel-sony-psp` | * |  | MIPS (LE) Sony PlayStation Portable (PSP)\n+[`mipsel-sony-psx`](platform-support/mipsel-sony-psx.md) | * |  | MIPS (LE) Sony PlayStation 1 (PSX)\n `mipsel-unknown-linux-uclibc` | \u2713 |  | MIPS (LE) Linux with uClibc\n `mipsel-unknown-none` | * |  | Bare MIPS (LE) softfloat\n `mipsisa32r6-unknown-linux-gnu` | ? |  |"}, {"sha": "589100e8888b32c22e91e41089f38128843b9647", "filename": "src/doc/rustc/src/platform-support/mipsel-sony-psx.md", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/rust-lang/rust/blob/d03185ed98b4ff022a111993d138923dbc8d5052/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support%2Fmipsel-sony-psx.md", "raw_url": "https://github.com/rust-lang/rust/raw/d03185ed98b4ff022a111993d138923dbc8d5052/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support%2Fmipsel-sony-psx.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support%2Fmipsel-sony-psx.md?ref=d03185ed98b4ff022a111993d138923dbc8d5052", "patch": "@@ -0,0 +1,49 @@\n+# mipsel-sony-psx\n+\n+**Tier: 3**\n+\n+Sony PlayStation 1 (psx)\n+\n+## Designated Developer\n+\n+* [@ayrtonm](https://github.com/ayrtonm)\n+\n+## Requirements\n+\n+This target is cross-compiled.\n+It has no special requirements for the host.\n+\n+## Building\n+\n+The target can be built by enabling it for a `rustc` build:\n+\n+```toml\n+[build]\n+build-stage = 1\n+target = [\"mipsel-sony-psx\"]\n+```\n+\n+## Cross-compilation\n+\n+This target can be cross-compiled from any host.\n+\n+## Testing\n+\n+Currently there is no support to run the rustc test suite for this target.\n+\n+## Building Rust programs\n+\n+Since it is Tier 3, rust doesn't ship pre-compiled artifacts for this target.\n+\n+Just use the `build-std` nightly cargo feature to build the `core` and `alloc` libraries:\n+```shell\n+cargo build -Zbuild-std=core,alloc --target mipsel-sony-psx\n+```\n+\n+The command above generates an ELF. To generate binaries in the PSEXE format that emulators run, you can use [cargo-psx](https://github.com/ayrtonm/psx-sdk-rs#readme):\n+\n+```shell\n+cargo psx build\n+```\n+\n+or use `-Clink-arg=--oformat=binary` to produce a flat binary."}]}