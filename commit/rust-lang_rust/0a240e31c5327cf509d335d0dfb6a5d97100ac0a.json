{"sha": "0a240e31c5327cf509d335d0dfb6a5d97100ac0a", "node_id": "C_kwDOAAsO6NoAKDBhMjQwZTMxYzUzMjdjZjUwOWQzMzVkMGRmYjZhNWQ5NzEwMGFjMGE", "commit": {"author": {"name": "Jeroen Vannevel", "email": "jer_vannevel@outlook.com", "date": "2022-01-07T13:53:42Z"}, "committer": {"name": "Jeroen Vannevel", "email": "jer_vannevel@outlook.com", "date": "2022-01-07T13:53:42Z"}, "message": "succinct code", "tree": {"sha": "f03f106b59d3576dd6c4f55710d5a4d63a786868", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f03f106b59d3576dd6c4f55710d5a4d63a786868"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0a240e31c5327cf509d335d0dfb6a5d97100ac0a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCAAdFiEEEzoFOOQgvfPzrDpfeO9fUvOMSb0FAmHYReYACgkQeO9fUvOM\nSb0erwv+N6oJv/V3Ptz+jJfvWfTGV06Oxbsr36fXnxrCukvY8aXj5YmfK4FlqcXB\nk+Emsg1BXhrNroum1Fs9fTInpKO2iwN9Ji5NrzHojYI/NcObGyI5eaG0A4CLpW1C\njqo018a9kfcYaXHnjnY+8MU6WJIEPNmsoMF9czkhJeKPXdK3DDb9Z0GcLze5fZSG\nS0UYrHxxl6lZ0GulXU8/BgsbjVjcPcXkY7H0GO/3ajnsE0s9lxzvZOlJvWHceHJN\n0ICoSfxdEccaZ+DAT+8WpThCLvYea/82XZb9RuZNvpPqYniZ7NIKYIo1RhDl5XMe\nTLcjReGYsg2V8isTZnftFNOxS2tqHevVI58QTCbUOk/GkTFiq5rGSQamWrhtQjAq\nsqlg8PEkmA8EeYiCUet1b2UlWDTdI6DYAzjbxkoJMT0AJ9uFn+ZgMo8JchegrgYF\no0BaO2od9M00ZMQVkMI8JHasyvxULswe60wE+Ip4MRqDHsDmUK+Zi7zqyBmjnZ6f\nw/FZFFfQ\n=63FN\n-----END PGP SIGNATURE-----", "payload": "tree f03f106b59d3576dd6c4f55710d5a4d63a786868\nparent 4bcdb053253e82f88d9db7806571887da45599d7\nauthor Jeroen Vannevel <jer_vannevel@outlook.com> 1641563622 +0000\ncommitter Jeroen Vannevel <jer_vannevel@outlook.com> 1641563622 +0000\n\nsuccinct code\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0a240e31c5327cf509d335d0dfb6a5d97100ac0a", "html_url": "https://github.com/rust-lang/rust/commit/0a240e31c5327cf509d335d0dfb6a5d97100ac0a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0a240e31c5327cf509d335d0dfb6a5d97100ac0a/comments", "author": {"login": "Vannevelj", "id": 2777107, "node_id": "MDQ6VXNlcjI3NzcxMDc=", "avatar_url": "https://avatars.githubusercontent.com/u/2777107?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Vannevelj", "html_url": "https://github.com/Vannevelj", "followers_url": "https://api.github.com/users/Vannevelj/followers", "following_url": "https://api.github.com/users/Vannevelj/following{/other_user}", "gists_url": "https://api.github.com/users/Vannevelj/gists{/gist_id}", "starred_url": "https://api.github.com/users/Vannevelj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Vannevelj/subscriptions", "organizations_url": "https://api.github.com/users/Vannevelj/orgs", "repos_url": "https://api.github.com/users/Vannevelj/repos", "events_url": "https://api.github.com/users/Vannevelj/events{/privacy}", "received_events_url": "https://api.github.com/users/Vannevelj/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Vannevelj", "id": 2777107, "node_id": "MDQ6VXNlcjI3NzcxMDc=", "avatar_url": "https://avatars.githubusercontent.com/u/2777107?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Vannevelj", "html_url": "https://github.com/Vannevelj", "followers_url": "https://api.github.com/users/Vannevelj/followers", "following_url": "https://api.github.com/users/Vannevelj/following{/other_user}", "gists_url": "https://api.github.com/users/Vannevelj/gists{/gist_id}", "starred_url": "https://api.github.com/users/Vannevelj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Vannevelj/subscriptions", "organizations_url": "https://api.github.com/users/Vannevelj/orgs", "repos_url": "https://api.github.com/users/Vannevelj/repos", "events_url": "https://api.github.com/users/Vannevelj/events{/privacy}", "received_events_url": "https://api.github.com/users/Vannevelj/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4bcdb053253e82f88d9db7806571887da45599d7", "url": "https://api.github.com/repos/rust-lang/rust/commits/4bcdb053253e82f88d9db7806571887da45599d7", "html_url": "https://github.com/rust-lang/rust/commit/4bcdb053253e82f88d9db7806571887da45599d7"}], "stats": {"total": 21, "additions": 9, "deletions": 12}, "files": [{"sha": "c3d27f7ea65bec30f905f9cc41ad391db867cbb1", "filename": "crates/ide_assists/src/handlers/add_turbo_fish.rs", "status": "modified", "additions": 9, "deletions": 12, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/0a240e31c5327cf509d335d0dfb6a5d97100ac0a/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fadd_turbo_fish.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0a240e31c5327cf509d335d0dfb6a5d97100ac0a/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fadd_turbo_fish.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fadd_turbo_fish.rs?ref=0a240e31c5327cf509d335d0dfb6a5d97100ac0a", "patch": "@@ -1,4 +1,5 @@\n use ide_db::defs::{Definition, NameRefClass};\n+use itertools::Itertools;\n use syntax::{ast, AstNode, SyntaxKind, T};\n \n use crate::{\n@@ -94,8 +95,7 @@ pub(crate) fn add_turbo_fish(acc: &mut Assists, ctx: &AssistContext) -> Option<(\n                 builder.insert_snippet(cap, ident.text_range().end(), snip)\n             }\n             None => {\n-                let fish_head =\n-                    std::iter::repeat(\"_\").take(number_of_arguments).collect::<Vec<_>>().join(\", \");\n+                let fish_head = std::iter::repeat(\"_\").take(number_of_arguments).format(\", \");\n                 let snip = format!(\"::<{}>\", fish_head);\n                 builder.insert(ident.text_range().end(), snip);\n             }\n@@ -105,12 +105,9 @@ pub(crate) fn add_turbo_fish(acc: &mut Assists, ctx: &AssistContext) -> Option<(\n \n /// This will create a snippet string with tabstops marked\n fn get_snippet_fish_head(number_of_arguments: usize) -> String {\n-    let mut fish_head = String::new();\n-    let mut i = 1;\n-    while i < number_of_arguments {\n-        fish_head.push_str(&format!(\"${{{}:_}},\", i));\n-        i = i + 1;\n-    }\n+    let mut fish_head = (1..number_of_arguments)\n+        .format_with(\"\", |i, f| f(&format_args!(\"${{{}:_}}, \", i)))\n+        .to_string();\n \n     // tabstop 0 is a special case and always the last one\n     fish_head.push_str(\"${0:_}\");\n@@ -155,7 +152,7 @@ fn main() {\n             r#\"\n fn make<T, A>() -> T {}\n fn main() {\n-    make::<${1:_},${0:_}>();\n+    make::<${1:_}, ${0:_}>();\n }\n \"#,\n         );\n@@ -174,7 +171,7 @@ fn main() {\n             r#\"\n fn make<T, A, B, C, D, E, F>() -> T {}\n fn main() {\n-    make::<${1:_},${2:_},${3:_},${4:_},${5:_},${6:_},${0:_}>();\n+    make::<${1:_}, ${2:_}, ${3:_}, ${4:_}, ${5:_}, ${6:_}, ${0:_}>();\n }\n \"#,\n         );\n@@ -373,7 +370,7 @@ fn main() {\n             r#\"\n fn make<'a, T, A>(t: T, a: A) {}\n fn main() {\n-    make::<${1:_},${0:_}>(5, 2);\n+    make::<${1:_}, ${0:_}>(5, 2);\n }\n \"#,\n         );\n@@ -392,7 +389,7 @@ fn main() {\n             r#\"\n fn make<T, const N: usize>(t: T) {}\n fn main() {\n-    make::<${1:_},${0:_}>(3);\n+    make::<${1:_}, ${0:_}>(3);\n }\n \"#,\n         );"}]}