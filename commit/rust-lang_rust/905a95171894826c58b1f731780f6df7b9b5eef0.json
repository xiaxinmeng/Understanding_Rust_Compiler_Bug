{"sha": "905a95171894826c58b1f731780f6df7b9b5eef0", "node_id": "C_kwDOAAsO6NoAKDkwNWE5NTE3MTg5NDgyNmM1OGIxZjczMTc4MGY2ZGY3YjliNWVlZjA", "commit": {"author": {"name": "Alex Macleod", "email": "alex@macleod.io", "date": "2022-05-06T12:21:08Z"}, "committer": {"name": "Alex Macleod", "email": "alex@macleod.io", "date": "2022-05-06T14:36:46Z"}, "message": "Pass through extra args in `cargo dev lint`", "tree": {"sha": "06b308f5b2ffe0803e41d14fc5543945da45372a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/06b308f5b2ffe0803e41d14fc5543945da45372a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/905a95171894826c58b1f731780f6df7b9b5eef0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/905a95171894826c58b1f731780f6df7b9b5eef0", "html_url": "https://github.com/rust-lang/rust/commit/905a95171894826c58b1f731780f6df7b9b5eef0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/905a95171894826c58b1f731780f6df7b9b5eef0/comments", "author": {"login": "Alexendoo", "id": 1830331, "node_id": "MDQ6VXNlcjE4MzAzMzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1830331?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Alexendoo", "html_url": "https://github.com/Alexendoo", "followers_url": "https://api.github.com/users/Alexendoo/followers", "following_url": "https://api.github.com/users/Alexendoo/following{/other_user}", "gists_url": "https://api.github.com/users/Alexendoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/Alexendoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Alexendoo/subscriptions", "organizations_url": "https://api.github.com/users/Alexendoo/orgs", "repos_url": "https://api.github.com/users/Alexendoo/repos", "events_url": "https://api.github.com/users/Alexendoo/events{/privacy}", "received_events_url": "https://api.github.com/users/Alexendoo/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Alexendoo", "id": 1830331, "node_id": "MDQ6VXNlcjE4MzAzMzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1830331?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Alexendoo", "html_url": "https://github.com/Alexendoo", "followers_url": "https://api.github.com/users/Alexendoo/followers", "following_url": "https://api.github.com/users/Alexendoo/following{/other_user}", "gists_url": "https://api.github.com/users/Alexendoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/Alexendoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Alexendoo/subscriptions", "organizations_url": "https://api.github.com/users/Alexendoo/orgs", "repos_url": "https://api.github.com/users/Alexendoo/repos", "events_url": "https://api.github.com/users/Alexendoo/events{/privacy}", "received_events_url": "https://api.github.com/users/Alexendoo/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bbe6e944d5082ff2acc0960a95adda9cdf59b6ec", "url": "https://api.github.com/repos/rust-lang/rust/commits/bbe6e944d5082ff2acc0960a95adda9cdf59b6ec", "html_url": "https://github.com/rust-lang/rust/commit/bbe6e944d5082ff2acc0960a95adda9cdf59b6ec"}], "stats": {"total": 20, "additions": 18, "deletions": 2}, "files": [{"sha": "9e463aa741c758d7bdf3023d6eff1b0f4d353ba6", "filename": "clippy_dev/src/lint.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/905a95171894826c58b1f731780f6df7b9b5eef0/clippy_dev%2Fsrc%2Flint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/905a95171894826c58b1f731780f6df7b9b5eef0/clippy_dev%2Fsrc%2Flint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Flint.rs?ref=905a95171894826c58b1f731780f6df7b9b5eef0", "patch": "@@ -13,7 +13,7 @@ fn exit_if_err(status: io::Result<ExitStatus>) {\n     }\n }\n \n-pub fn run(path: &str) {\n+pub fn run<'a>(path: &str, args: impl Iterator<Item = &'a str>) {\n     let is_file = match fs::metadata(path) {\n         Ok(metadata) => metadata.is_file(),\n         Err(e) => {\n@@ -30,6 +30,7 @@ pub fn run(path: &str) {\n                 .args([\"-Z\", \"no-codegen\"])\n                 .args([\"--edition\", \"2021\"])\n                 .arg(path)\n+                .args(args)\n                 .status(),\n         );\n     } else {\n@@ -42,6 +43,8 @@ pub fn run(path: &str) {\n             .expect(\"failed to create tempdir\");\n \n         let status = Command::new(cargo_clippy_path())\n+            .arg(\"clippy\")\n+            .args(args)\n             .current_dir(path)\n             .env(\"CARGO_TARGET_DIR\", target.as_ref())\n             .status();"}, {"sha": "dcfaabbc204bb0a33f0e5ca884c88eadf54f18af", "filename": "clippy_dev/src/main.rs", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/905a95171894826c58b1f731780f6df7b9b5eef0/clippy_dev%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/905a95171894826c58b1f731780f6df7b9b5eef0/clippy_dev%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Fmain.rs?ref=905a95171894826c58b1f731780f6df7b9b5eef0", "patch": "@@ -76,7 +76,8 @@ fn main() {\n         },\n         (\"lint\", Some(matches)) => {\n             let path = matches.value_of(\"path\").unwrap();\n-            lint::run(path);\n+            let args = matches.values_of(\"args\").into_iter().flatten();\n+            lint::run(path, args);\n         },\n         (\"rename_lint\", Some(matches)) => {\n             let old_name = matches.value_of(\"old_name\").unwrap();\n@@ -278,11 +279,23 @@ fn get_clap_config<'a>() -> ArgMatches<'a> {\n                         Lint a package directory:\n                             cargo dev lint tests/ui-cargo/wildcard_dependencies/fail\n                             cargo dev lint ~/my-project\n+\n+                        Run rustfix:\n+                            cargo dev lint ~/my-project -- --fix\n+\n+                        Set lint levels:\n+                            cargo dev lint file.rs -- -W clippy::pedantic\n+                            cargo dev lint ~/my-project -- -- -W clippy::pedantic\n                 \"})\n                 .arg(\n                     Arg::with_name(\"path\")\n                         .required(true)\n                         .help(\"The path to a file or package directory to lint\"),\n+                )\n+                .arg(\n+                    Arg::with_name(\"args\")\n+                        .multiple(true)\n+                        .help(\"Pass extra arguments to cargo/clippy-driver\"),\n                 ),\n         )\n         .subcommand("}]}