{"sha": "625803d77ec76ad3ab87b1c1c8db7ac7e213761d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYyNTgwM2Q3N2VjNzZhZDNhYjg3YjFjMWM4ZGI3YWM3ZTIxMzc2MWQ=", "commit": {"author": {"name": "Rich Kadel", "email": "richkadel@google.com", "date": "2021-02-06T01:50:37Z"}, "committer": {"name": "Rich Kadel", "email": "richkadel@google.com", "date": "2021-02-11T19:40:30Z"}, "message": "Set SHELL = /bin/dash only if it exists", "tree": {"sha": "723a2e0d66e3708a6bbab481aa65960eda12abd8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/723a2e0d66e3708a6bbab481aa65960eda12abd8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/625803d77ec76ad3ab87b1c1c8db7ac7e213761d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/625803d77ec76ad3ab87b1c1c8db7ac7e213761d", "html_url": "https://github.com/rust-lang/rust/commit/625803d77ec76ad3ab87b1c1c8db7ac7e213761d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/625803d77ec76ad3ab87b1c1c8db7ac7e213761d/comments", "author": {"login": "richkadel", "id": 3827298, "node_id": "MDQ6VXNlcjM4MjcyOTg=", "avatar_url": "https://avatars.githubusercontent.com/u/3827298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/richkadel", "html_url": "https://github.com/richkadel", "followers_url": "https://api.github.com/users/richkadel/followers", "following_url": "https://api.github.com/users/richkadel/following{/other_user}", "gists_url": "https://api.github.com/users/richkadel/gists{/gist_id}", "starred_url": "https://api.github.com/users/richkadel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/richkadel/subscriptions", "organizations_url": "https://api.github.com/users/richkadel/orgs", "repos_url": "https://api.github.com/users/richkadel/repos", "events_url": "https://api.github.com/users/richkadel/events{/privacy}", "received_events_url": "https://api.github.com/users/richkadel/received_events", "type": "User", "site_admin": false}, "committer": {"login": "richkadel", "id": 3827298, "node_id": "MDQ6VXNlcjM4MjcyOTg=", "avatar_url": "https://avatars.githubusercontent.com/u/3827298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/richkadel", "html_url": "https://github.com/richkadel", "followers_url": "https://api.github.com/users/richkadel/followers", "following_url": "https://api.github.com/users/richkadel/following{/other_user}", "gists_url": "https://api.github.com/users/richkadel/gists{/gist_id}", "starred_url": "https://api.github.com/users/richkadel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/richkadel/subscriptions", "organizations_url": "https://api.github.com/users/richkadel/orgs", "repos_url": "https://api.github.com/users/richkadel/repos", "events_url": "https://api.github.com/users/richkadel/events{/privacy}", "received_events_url": "https://api.github.com/users/richkadel/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "01f5a2a81d02f42d4ea277772d0752e80f8d32d1", "url": "https://api.github.com/repos/rust-lang/rust/commits/01f5a2a81d02f42d4ea277772d0752e80f8d32d1", "html_url": "https://github.com/rust-lang/rust/commit/01f5a2a81d02f42d4ea277772d0752e80f8d32d1"}], "stats": {"total": 15, "additions": 11, "deletions": 4}, "files": [{"sha": "83f640e2f4013678f22de9cd1a45a91e5934701a", "filename": "src/test/run-make-fulldeps/tools.mk", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/625803d77ec76ad3ab87b1c1c8db7ac7e213761d/src%2Ftest%2Frun-make-fulldeps%2Ftools.mk", "raw_url": "https://github.com/rust-lang/rust/raw/625803d77ec76ad3ab87b1c1c8db7ac7e213761d/src%2Ftest%2Frun-make-fulldeps%2Ftools.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Ftools.mk?ref=625803d77ec76ad3ab87b1c1c8db7ac7e213761d", "patch": "@@ -21,11 +21,18 @@ CGREP := \"$(S)/src/etc/cat-and-grep.sh\"\n # diff with common flags for multi-platform diffs against text output\n DIFF := diff -u --strip-trailing-cr\n \n-# CI platforms use `/bin/dash`. When compiling in other environments, the\n-# default may be different (for example, may default to `/bin/bash`), and syntax\n-# and results could be different. Ensure Makefile `$(shell ...)` invocations\n-# always run in `dash`.\n+# Some of the Rust CI platforms use `/bin/dash` to run `shell` script in\n+# Makefiles. Other platforms, including many developer platforms, default to\n+# `/bin/bash`. (In many cases, `make` is actually using `/bin/sh`, but `sh`\n+# is configured to execute one or the other shell binary). `dash` features\n+# support only a small subset of `bash` features, so `dash` can be thought of as\n+# the lowest common denominator, and tests should be validated against `dash`\n+# whenever possible. Most developer platforms include `/bin/dash`, but to ensure\n+# tests still work when `/bin/dash`, if not available, this `SHELL` override is\n+# conditional:\n+ifneq (,$(wildcard /bin/dash))\n SHELL := /bin/dash\n+endif\n \n # This is the name of the binary we will generate and run; use this\n # e.g. for `$(CC) -o $(RUN_BINFILE)`."}]}