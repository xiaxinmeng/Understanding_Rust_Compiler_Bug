{"sha": "441669c382298661db59cdf4374dbd40ab75b222", "node_id": "C_kwDOAAsO6NoAKDQ0MTY2OWMzODIyOTg2NjFkYjU5Y2RmNDM3NGRiZDQwYWI3NWIyMjI", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-12-09T06:25:46Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-12-09T06:25:46Z"}, "message": "Rollup merge of #105442 - notriddle:notriddle/docblock-table-css, r=GuillaumeGomez\n\nrustdoc: clean up docblock table CSS\n\n# Preview\n\nhttp://notriddle.com/notriddle-rustdoc-demos/table-2/test_dingus/fn.test.html\n\n# Before\n\n![image](https://user-images.githubusercontent.com/1593513/206364287-1b80eaaf-2e0e-4138-8b56-4aa8ff39abac.png)\n\n# After\n\n![image](https://user-images.githubusercontent.com/1593513/206364209-d287d165-31be-4de1-9b43-05b35ce2a86b.png)\n\n# Details\n\n* The rule `display: block` had no noticeable effect. Technically, because markdown tables have a tbody and thead, they get wrapped in an [anonymous table box] in the CSS tree, nested within the `<table>` element's block layout box.\n\n  This rule was added in #87230 to make the table side-scrolling, but this same issue was doubly fixed in #88742 by wrapping it in an explicit `<div>` tag. Since accessibility advocates recommend the wrapper div over marking the table as `display: block`, we'll stick with that.\n\n  https://adrianroselli.com/2020/11/under-engineered-responsive-tables.html\n\n* The rule `width: calc(100% - 2px)` had no visible effect, because the anonymous table box was not affected.\n\n* The style is tweaked to basically be the same style GitHub uses. In particular, it adds zebra stripes, and removes dotted borders.\n\n  https://rust-lang.zulipchat.com/#narrow/stream/266220-rustdoc/topic/Markdown.20table.20styling\n\n[anonymous table box]: https://www.w3.org/TR/CSS2/tables.html#anonymous-boxes", "tree": {"sha": "aae293388492ec26ce63a07d0dc4f74021a7ac44", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/aae293388492ec26ce63a07d0dc4f74021a7ac44"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/441669c382298661db59cdf4374dbd40ab75b222", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjktTqCRBK7hj4Ov3rIwAACuYIAKCBamvidBuBkjmoKSDtN0op\nsvPj7sQ4kZ6uGVMiTf1gVwAoNawcNS3WNWjpcd9phP1pDOiFK3n43gco6vbMmqUm\nf2JckcbSFBPhWblyeiOVY4iG9rpzTTAbGAn5nH4AWl7R2n0P+1i5T7mxHcZUcxCT\n6X1DRhbsXdTHysIRly3yWJj2UVc3YiKaa8OwmT5QdshuXel8RzfHfYeIlAfGVI+B\n9g/M8z3oSNLTAEodJ5NpOupv/TWZAlowcraO1RGbOW0kIRlWUX5Tdu/7bzxsbESo\n9u0VYT6LACl2OeKAYfjnXrrZpKLA+u3eP8DWglKGftE34IMzUVVyIyBTnkZPY4w=\n=72ZO\n-----END PGP SIGNATURE-----\n", "payload": "tree aae293388492ec26ce63a07d0dc4f74021a7ac44\nparent 4b09861a68f71539919c6d5c880a1c528b7be8ab\nparent 34700f6594436b49005151ee12dd2ae06c7cad03\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1670567146 +0100\ncommitter GitHub <noreply@github.com> 1670567146 +0100\n\nRollup merge of #105442 - notriddle:notriddle/docblock-table-css, r=GuillaumeGomez\n\nrustdoc: clean up docblock table CSS\n\n# Preview\n\nhttp://notriddle.com/notriddle-rustdoc-demos/table-2/test_dingus/fn.test.html\n\n# Before\n\n![image](https://user-images.githubusercontent.com/1593513/206364287-1b80eaaf-2e0e-4138-8b56-4aa8ff39abac.png)\n\n# After\n\n![image](https://user-images.githubusercontent.com/1593513/206364209-d287d165-31be-4de1-9b43-05b35ce2a86b.png)\n\n# Details\n\n* The rule `display: block` had no noticeable effect. Technically, because markdown tables have a tbody and thead, they get wrapped in an [anonymous table box] in the CSS tree, nested within the `<table>` element's block layout box.\n\n  This rule was added in #87230 to make the table side-scrolling, but this same issue was doubly fixed in #88742 by wrapping it in an explicit `<div>` tag. Since accessibility advocates recommend the wrapper div over marking the table as `display: block`, we'll stick with that.\n\n  https://adrianroselli.com/2020/11/under-engineered-responsive-tables.html\n\n* The rule `width: calc(100% - 2px)` had no visible effect, because the anonymous table box was not affected.\n\n* The style is tweaked to basically be the same style GitHub uses. In particular, it adds zebra stripes, and removes dotted borders.\n\n  https://rust-lang.zulipchat.com/#narrow/stream/266220-rustdoc/topic/Markdown.20table.20styling\n\n[anonymous table box]: https://www.w3.org/TR/CSS2/tables.html#anonymous-boxes\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/441669c382298661db59cdf4374dbd40ab75b222", "html_url": "https://github.com/rust-lang/rust/commit/441669c382298661db59cdf4374dbd40ab75b222", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/441669c382298661db59cdf4374dbd40ab75b222/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4b09861a68f71539919c6d5c880a1c528b7be8ab", "url": "https://api.github.com/repos/rust-lang/rust/commits/4b09861a68f71539919c6d5c880a1c528b7be8ab", "html_url": "https://github.com/rust-lang/rust/commit/4b09861a68f71539919c6d5c880a1c528b7be8ab"}, {"sha": "34700f6594436b49005151ee12dd2ae06c7cad03", "url": "https://api.github.com/repos/rust-lang/rust/commits/34700f6594436b49005151ee12dd2ae06c7cad03", "html_url": "https://github.com/rust-lang/rust/commit/34700f6594436b49005151ee12dd2ae06c7cad03"}], "stats": {"total": 67, "additions": 57, "deletions": 10}, "files": [{"sha": "afcb4022402057fe3610a8f5bb91562b93da5a5d", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 4, "deletions": 10, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/441669c382298661db59cdf4374dbd40ab75b222/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/441669c382298661db59cdf4374dbd40ab75b222/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=441669c382298661db59cdf4374dbd40ab75b222", "patch": "@@ -630,22 +630,16 @@ pre, .rustdoc.source .example-wrap {\n \n .docblock table {\n \tmargin: .5em 0;\n-\twidth: calc(100% - 2px);\n-\toverflow-x: auto;\n-\tdisplay: block;\n \tborder-collapse: collapse;\n }\n \n-.docblock table td {\n+.docblock table td, .docblock table th {\n \tpadding: .5em;\n-\tborder: 1px dashed var(--border-color);\n-\tvertical-align: top;\n+\tborder: 1px solid var(--border-color);\n }\n \n-.docblock table th {\n-\tpadding: .5em;\n-\ttext-align: left;\n-\tborder: 1px solid var(--border-color);\n+.docblock table tbody tr:nth-child(2n) {\n+\tbackground: var(--table-alt-row-background-color);\n }\n \n /* Shift \"where ...\" part of method or fn definition down a line */"}, {"sha": "0436fe0138edc5815cdfb3fe817732ed6f28762d", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/441669c382298661db59cdf4374dbd40ab75b222/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/441669c382298661db59cdf4374dbd40ab75b222/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=441669c382298661db59cdf4374dbd40ab75b222", "patch": "@@ -87,6 +87,7 @@ Original by Dempfi (https://github.com/dempfi/ayu)\n \t--crate-search-hover-border: #e0e0e0;\n \t--source-sidebar-background-selected: #14191f;\n \t--source-sidebar-background-hover: #14191f;\n+\t--table-alt-row-background-color: #191f26;\n }\n \n h1, h2, h3, h4 {"}, {"sha": "d945e956c533e20b52fea54d922924363acd449d", "filename": "src/librustdoc/html/static/css/themes/dark.css", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/441669c382298661db59cdf4374dbd40ab75b222/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/441669c382298661db59cdf4374dbd40ab75b222/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css?ref=441669c382298661db59cdf4374dbd40ab75b222", "patch": "@@ -82,6 +82,7 @@\n \t--crate-search-hover-border: #2196f3;\n \t--source-sidebar-background-selected: #333;\n \t--source-sidebar-background-hover: #444;\n+\t--table-alt-row-background-color: #2A2A2A;\n }\n \n .content .item-info::before { color: #ccc; }"}, {"sha": "58955a79316af3f2485c68e681ba9ac247454934", "filename": "src/librustdoc/html/static/css/themes/light.css", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/441669c382298661db59cdf4374dbd40ab75b222/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/441669c382298661db59cdf4374dbd40ab75b222/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css?ref=441669c382298661db59cdf4374dbd40ab75b222", "patch": "@@ -79,6 +79,7 @@\n \t--crate-search-hover-border: #717171;\n \t--source-sidebar-background-selected: #fff;\n \t--source-sidebar-background-hover: #e0e0e0;\n+\t--table-alt-row-background-color: #F5F5F5;\n }\n \n .content .item-info::before { color: #ccc; }"}, {"sha": "8645c1b1949e3f79533a5d76345bea8aec5285b6", "filename": "src/test/rustdoc-gui/docblock-table.goml", "status": "modified", "additions": 47, "deletions": 0, "changes": 47, "blob_url": "https://github.com/rust-lang/rust/blob/441669c382298661db59cdf4374dbd40ab75b222/src%2Ftest%2Frustdoc-gui%2Fdocblock-table.goml", "raw_url": "https://github.com/rust-lang/rust/raw/441669c382298661db59cdf4374dbd40ab75b222/src%2Ftest%2Frustdoc-gui%2Fdocblock-table.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fdocblock-table.goml?ref=441669c382298661db59cdf4374dbd40ab75b222", "patch": "@@ -2,3 +2,50 @@ goto: \"file://\" + |DOC_PATH| + \"/test_docs/doc_block_table/struct.DocBlockTable.\n \n compare-elements-css: (\".impl-items .docblock table th\", \".top-doc .docblock table th\", [\"border\"])\n compare-elements-css: (\".impl-items .docblock table td\", \".top-doc .docblock table td\", [\"border\"])\n+\n+define-function: (\n+    \"check-colors\",\n+    (theme, border_color, zebra_stripe_color),\n+    [\n+        (\"local-storage\", {\"rustdoc-use-system-theme\": \"false\", \"rustdoc-theme\": |theme|}),\n+        (\"reload\"),\n+        (\"assert-css\", (\".top-doc .docblock table tbody tr:nth-child(1)\", {\n+            \"background-color\": \"rgba(0, 0, 0, 0)\",\n+        })),\n+        (\"assert-css\", (\".top-doc .docblock table tbody tr:nth-child(2)\", {\n+            \"background-color\": |zebra_stripe_color|,\n+        })),\n+        (\"assert-css\", (\".top-doc .docblock table tbody tr:nth-child(3)\", {\n+            \"background-color\": \"rgba(0, 0, 0, 0)\",\n+        })),\n+        (\"assert-css\", (\".top-doc .docblock table tbody tr:nth-child(4)\", {\n+            \"background-color\": |zebra_stripe_color|,\n+        })),\n+        (\"assert-css\", (\".top-doc .docblock table td\", {\n+            \"border-style\": \"solid\",\n+            \"border-width\": \"1px\",\n+            \"border-color\": |border_color|,\n+        })),\n+        (\"assert-css\", (\".top-doc .docblock table th\", {\n+            \"border-style\": \"solid\",\n+            \"border-width\": \"1px\",\n+            \"border-color\": |border_color|,\n+        })),\n+    ]\n+)\n+\n+call-function: (\"check-colors\", {\n+    \"theme\": \"dark\",\n+    \"border_color\": \"rgb(224, 224, 224)\",\n+    \"zebra_stripe_color\": \"rgb(42, 42, 42)\",\n+})\n+call-function: (\"check-colors\", {\n+    \"theme\": \"ayu\",\n+    \"border_color\": \"rgb(92, 103, 115)\",\n+    \"zebra_stripe_color\": \"rgb(25, 31, 38)\",\n+})\n+call-function: (\"check-colors\", {\n+    \"theme\": \"light\",\n+    \"border_color\": \"rgb(224, 224, 224)\",\n+    \"zebra_stripe_color\": \"rgb(245, 245, 245)\",\n+})"}, {"sha": "d6eeab803dfec3c7e9399be5f87f4cb3ba903b54", "filename": "src/test/rustdoc-gui/src/test_docs/lib.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/441669c382298661db59cdf4374dbd40ab75b222/src%2Ftest%2Frustdoc-gui%2Fsrc%2Ftest_docs%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/441669c382298661db59cdf4374dbd40ab75b222/src%2Ftest%2Frustdoc-gui%2Fsrc%2Ftest_docs%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsrc%2Ftest_docs%2Flib.rs?ref=441669c382298661db59cdf4374dbd40ab75b222", "patch": "@@ -343,6 +343,9 @@ pub mod doc_block_table {\n     /// | header1                  | header2                  |\n     /// |--------------------------|--------------------------|\n     /// | Lorem Ipsum, Lorem Ipsum | Lorem Ipsum, Lorem Ipsum |\n+    /// | Lorem Ipsum, Lorem Ipsum | Lorem Ipsum, Lorem Ipsum |\n+    /// | Lorem Ipsum, Lorem Ipsum | Lorem Ipsum, Lorem Ipsum |\n+    /// | Lorem Ipsum, Lorem Ipsum | Lorem Ipsum, Lorem Ipsum |\n     pub struct DocBlockTable {}\n \n     impl DocBlockTableTrait for DocBlockTable {"}]}