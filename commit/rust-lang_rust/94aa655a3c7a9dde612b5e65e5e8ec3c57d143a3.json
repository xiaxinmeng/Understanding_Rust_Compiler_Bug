{"sha": "94aa655a3c7a9dde612b5e65e5e8ec3c57d143a3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk0YWE2NTVhM2M3YTlkZGU2MTJiNWU2NWU1ZThlYzNjNTdkMTQzYTM=", "commit": {"author": {"name": "Tyler Mandry", "email": "tmandry@gmail.com", "date": "2020-01-24T08:30:58Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-01-24T08:30:58Z"}, "message": "Rollup merge of #68473 - nopsledder:rust_sanitizer_fuchsia, r=alexcrichton\n\nEnable ASan on Fuchsia\n\nThis change adds the x86_64-fuchsia and aarch64-fuchsia LLVM targets to\nthose allowed to invoke -Zsanitizer. Currently, the only overlap between\ncompiler_rt sanitizers supported by both rustc and Fuchsia is ASan.", "tree": {"sha": "e2a343848ec8c891f56fffc4aae764846ab9e4fc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e2a343848ec8c891f56fffc4aae764846ab9e4fc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/94aa655a3c7a9dde612b5e65e5e8ec3c57d143a3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJeKqtCCRBK7hj4Ov3rIwAAdHIIAIoUHNKwajFQCW9hLOQXStGm\ncMLRdj2iWdIJTBcRCT9+KTxN0a/B7zh0AuR4pqJX1CFrK99adCYfM1d4ZFcP1ofy\nWNLQWSo9yOglZQhG/q4k+NTswm60Pk3XqurnU4H62ekdpS+vJT0Qbo0wZUsw2K2s\n4r8/1HNHFXKnqUsghmQnCyl0EZ0R8dL6+OYiAxUDU0dtjWVedsKKq2lOTHNvcIP0\n8BkfHcIk6H28mkK2YgzAkiS1/LoQPRzk4KnscQh6ZtFNSeoGpTbdMsCEatUE08JT\nEt8uTu1b4Id+xoT45JIJhsG7DuuK2UIKvKP7ncsyv6/rqaW53lyfWb2UC4GrUd8=\n=AshZ\n-----END PGP SIGNATURE-----\n", "payload": "tree e2a343848ec8c891f56fffc4aae764846ab9e4fc\nparent e7752aefdc0765f9350cbe5d563d6f46f9045e26\nparent 192650a9aac7a2e006afbbafb83088eaf0d9d820\nauthor Tyler Mandry <tmandry@gmail.com> 1579854658 -0800\ncommitter GitHub <noreply@github.com> 1579854658 -0800\n\nRollup merge of #68473 - nopsledder:rust_sanitizer_fuchsia, r=alexcrichton\n\nEnable ASan on Fuchsia\n\nThis change adds the x86_64-fuchsia and aarch64-fuchsia LLVM targets to\nthose allowed to invoke -Zsanitizer. Currently, the only overlap between\ncompiler_rt sanitizers supported by both rustc and Fuchsia is ASan.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/94aa655a3c7a9dde612b5e65e5e8ec3c57d143a3", "html_url": "https://github.com/rust-lang/rust/commit/94aa655a3c7a9dde612b5e65e5e8ec3c57d143a3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/94aa655a3c7a9dde612b5e65e5e8ec3c57d143a3/comments", "author": {"login": "tmandry", "id": 2280544, "node_id": "MDQ6VXNlcjIyODA1NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2280544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmandry", "html_url": "https://github.com/tmandry", "followers_url": "https://api.github.com/users/tmandry/followers", "following_url": "https://api.github.com/users/tmandry/following{/other_user}", "gists_url": "https://api.github.com/users/tmandry/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmandry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmandry/subscriptions", "organizations_url": "https://api.github.com/users/tmandry/orgs", "repos_url": "https://api.github.com/users/tmandry/repos", "events_url": "https://api.github.com/users/tmandry/events{/privacy}", "received_events_url": "https://api.github.com/users/tmandry/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e7752aefdc0765f9350cbe5d563d6f46f9045e26", "url": "https://api.github.com/repos/rust-lang/rust/commits/e7752aefdc0765f9350cbe5d563d6f46f9045e26", "html_url": "https://github.com/rust-lang/rust/commit/e7752aefdc0765f9350cbe5d563d6f46f9045e26"}, {"sha": "192650a9aac7a2e006afbbafb83088eaf0d9d820", "url": "https://api.github.com/repos/rust-lang/rust/commits/192650a9aac7a2e006afbbafb83088eaf0d9d820", "html_url": "https://github.com/rust-lang/rust/commit/192650a9aac7a2e006afbbafb83088eaf0d9d820"}], "stats": {"total": 28, "additions": 25, "deletions": 3}, "files": [{"sha": "5bbd9f47fc907f51a3b4f45fb3ee2c447f97d268", "filename": "src/bootstrap/native.rs", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/94aa655a3c7a9dde612b5e65e5e8ec3c57d143a3/src%2Fbootstrap%2Fnative.rs", "raw_url": "https://github.com/rust-lang/rust/raw/94aa655a3c7a9dde612b5e65e5e8ec3c57d143a3/src%2Fbootstrap%2Fnative.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fnative.rs?ref=94aa655a3c7a9dde612b5e65e5e8ec3c57d143a3", "patch": "@@ -659,6 +659,24 @@ fn supported_sanitizers(out_dir: &Path, target: Interned<String>) -> Vec<Sanitiz\n                 });\n             }\n         }\n+        \"x86_64-fuchsia\" => {\n+            for s in &[\"asan\"] {\n+                result.push(SanitizerRuntime {\n+                    cmake_target: format!(\"clang_rt.{}-x86_64\", s),\n+                    path: out_dir.join(&format!(\"build/lib/fuchsia/libclang_rt.{}-x86_64.a\", s)),\n+                    name: format!(\"librustc_rt.{}.a\", s),\n+                });\n+            }\n+        }\n+        \"aarch64-fuchsia\" => {\n+            for s in &[\"asan\"] {\n+                result.push(SanitizerRuntime {\n+                    cmake_target: format!(\"clang_rt.{}-aarch64\", s),\n+                    path: out_dir.join(&format!(\"build/lib/fuchsia/libclang_rt.{}-aarch64.a\", s)),\n+                    name: format!(\"librustc_rt.{}.a\", s),\n+                });\n+            }\n+        }\n         _ => {}\n     }\n     result"}, {"sha": "f56a4170c0a4b3b0897aa58aeffe386241be8128", "filename": "src/librustc_codegen_ssa/back/link.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/94aa655a3c7a9dde612b5e65e5e8ec3c57d143a3/src%2Flibrustc_codegen_ssa%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/94aa655a3c7a9dde612b5e65e5e8ec3c57d143a3/src%2Flibrustc_codegen_ssa%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Fback%2Flink.rs?ref=94aa655a3c7a9dde612b5e65e5e8ec3c57d143a3", "patch": "@@ -777,7 +777,7 @@ fn link_sanitizer_runtime(sess: &Session, crate_type: config::CrateType, linker:\n             linker.args(&[\"-Wl,-rpath\".into(), \"-Xlinker\".into(), rpath.into()]);\n             linker.link_dylib(Symbol::intern(&libname));\n         }\n-        \"x86_64-unknown-linux-gnu\" => {\n+        \"x86_64-unknown-linux-gnu\" | \"x86_64-fuchsia\" | \"aarch64-fuchsia\" => {\n             let filename = format!(\"librustc_rt.{}.a\", name);\n             let path = default_tlib.join(&filename);\n             linker.link_whole_rlib(&path);"}, {"sha": "a40d6451b958c6cc865efc907825bdcaf0d143f5", "filename": "src/librustc_session/session.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/94aa655a3c7a9dde612b5e65e5e8ec3c57d143a3/src%2Flibrustc_session%2Fsession.rs", "raw_url": "https://github.com/rust-lang/rust/raw/94aa655a3c7a9dde612b5e65e5e8ec3c57d143a3/src%2Flibrustc_session%2Fsession.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_session%2Fsession.rs?ref=94aa655a3c7a9dde612b5e65e5e8ec3c57d143a3", "patch": "@@ -1127,8 +1127,12 @@ fn validate_commandline_args_with_session_available(sess: &Session) {\n \n     // Sanitizers can only be used on some tested platforms.\n     if let Some(ref sanitizer) = sess.opts.debugging_opts.sanitizer {\n-        const ASAN_SUPPORTED_TARGETS: &[&str] =\n-            &[\"x86_64-unknown-linux-gnu\", \"x86_64-apple-darwin\"];\n+        const ASAN_SUPPORTED_TARGETS: &[&str] = &[\n+            \"x86_64-unknown-linux-gnu\",\n+            \"x86_64-apple-darwin\",\n+            \"x86_64-fuchsia\",\n+            \"aarch64-fuchsia\",\n+        ];\n         const TSAN_SUPPORTED_TARGETS: &[&str] =\n             &[\"x86_64-unknown-linux-gnu\", \"x86_64-apple-darwin\"];\n         const LSAN_SUPPORTED_TARGETS: &[&str] ="}]}