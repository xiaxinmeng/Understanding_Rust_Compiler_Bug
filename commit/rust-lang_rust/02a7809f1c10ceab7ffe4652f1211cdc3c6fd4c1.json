{"sha": "02a7809f1c10ceab7ffe4652f1211cdc3c6fd4c1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAyYTc4MDlmMWMxMGNlYWI3ZmZlNDY1MmYxMjExY2RjM2M2ZmQ0YzE=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-04-11T15:28:14Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-04-18T12:47:28Z"}, "message": "Generate separate stamp files for `--compare-mode=nll`, and also use them. :)", "tree": {"sha": "bd0134530edfa7e56aa5c276218b966efb4b3519", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bd0134530edfa7e56aa5c276218b966efb4b3519"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/02a7809f1c10ceab7ffe4652f1211cdc3c6fd4c1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/02a7809f1c10ceab7ffe4652f1211cdc3c6fd4c1", "html_url": "https://github.com/rust-lang/rust/commit/02a7809f1c10ceab7ffe4652f1211cdc3c6fd4c1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/02a7809f1c10ceab7ffe4652f1211cdc3c6fd4c1/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ae6a9d4ba484f8f5bb9cbebf6da6d179bef519e1", "url": "https://api.github.com/repos/rust-lang/rust/commits/ae6a9d4ba484f8f5bb9cbebf6da6d179bef519e1", "html_url": "https://github.com/rust-lang/rust/commit/ae6a9d4ba484f8f5bb9cbebf6da6d179bef519e1"}], "stats": {"total": 11, "additions": 8, "deletions": 3}, "files": [{"sha": "37f7af0abe8f56e32d72a00640d59bfd365ee01a", "filename": "src/tools/compiletest/src/main.rs", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/02a7809f1c10ceab7ffe4652f1211cdc3c6fd4c1/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/02a7809f1c10ceab7ffe4652f1211cdc3c6fd4c1/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs?ref=02a7809f1c10ceab7ffe4652f1211cdc3c6fd4c1", "patch": "@@ -626,7 +626,7 @@ pub fn make_test(config: &Config, testpaths: &TestPaths) -> test::TestDescAndFn\n \n     // Debugging emscripten code doesn't make sense today\n     let ignore = early_props.ignore\n-        || (!up_to_date(config, testpaths, &early_props) && config.compare_mode.is_none())\n+        || !up_to_date(config, testpaths, &early_props)\n         || (config.mode == DebugInfoGdb || config.mode == DebugInfoLldb)\n             && config.target.contains(\"emscripten\");\n \n@@ -642,10 +642,15 @@ pub fn make_test(config: &Config, testpaths: &TestPaths) -> test::TestDescAndFn\n }\n \n fn stamp(config: &Config, testpaths: &TestPaths) -> PathBuf {\n+    let mode_suffix = match config.compare_mode {\n+        Some(ref mode) => format!(\"-{}\", mode.to_str()),\n+        None => format!(\"\"),\n+    };\n     let stamp_name = format!(\n-        \"{}-{}.stamp\",\n+        \"{}-{}{}.stamp\",\n         testpaths.file.file_name().unwrap().to_str().unwrap(),\n-        config.stage_id\n+        config.stage_id,\n+        mode_suffix\n     );\n     config\n         .build_base"}]}