{"sha": "27f9c7951fb30b299341668f16a6f84169e1379e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI3ZjljNzk1MWZiMzBiMjk5MzQxNjY4ZjE2YTZmODQxNjllMTM3OWU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-02-09T23:01:32Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-02-09T23:01:32Z"}, "message": "auto merge of #12124 : brson/rust/intrinsics, r=thestinger\n\nAs mentioned https://github.com/mozilla/rust/pull/11956#issuecomment-34561655 I've taken some of the most commonly-used intrinsics and put them in a more logical place, reduced the amount of code looking in `unstable::intrinsics`.\r\n\r\nr? @thestinger", "tree": {"sha": "e6efc500d66c8b387401a539544a884762d3a1e9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e6efc500d66c8b387401a539544a884762d3a1e9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/27f9c7951fb30b299341668f16a6f84169e1379e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/27f9c7951fb30b299341668f16a6f84169e1379e", "html_url": "https://github.com/rust-lang/rust/commit/27f9c7951fb30b299341668f16a6f84169e1379e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/27f9c7951fb30b299341668f16a6f84169e1379e/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7985fbcb4dc88ff0a6b26c8ae81ba189bfa28fe7", "url": "https://api.github.com/repos/rust-lang/rust/commits/7985fbcb4dc88ff0a6b26c8ae81ba189bfa28fe7", "html_url": "https://github.com/rust-lang/rust/commit/7985fbcb4dc88ff0a6b26c8ae81ba189bfa28fe7"}, {"sha": "1c4a2fd61cd2910985c57007df7a1ed0f6a5d6b5", "url": "https://api.github.com/repos/rust-lang/rust/commits/1c4a2fd61cd2910985c57007df7a1ed0f6a5d6b5", "html_url": "https://github.com/rust-lang/rust/commit/1c4a2fd61cd2910985c57007df7a1ed0f6a5d6b5"}], "stats": {"total": 234, "additions": 131, "deletions": 103}, "files": [{"sha": "e22f30871baa8639c519fb754aedb54e4f841554", "filename": "src/doc/guide-ffi.md", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Fdoc%2Fguide-ffi.md", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Fdoc%2Fguide-ffi.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Fguide-ffi.md?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -176,8 +176,8 @@ and `free`:\n ~~~~\n use std::cast;\n use std::libc::{c_void, size_t, malloc, free};\n+use std::mem;\n use std::ptr;\n-use std::unstable::intrinsics;\n \n // Define a wrapper around the handle returned by the foreign code.\n // Unique<T> has the same semantics as ~T\n@@ -199,7 +199,7 @@ impl<T: Send> Unique<T> {\n             // `*ptr` is uninitialized, and `*ptr = value` would attempt to destroy it\n             // move_val_init moves a value into this memory without\n             // attempting to drop the original value.\n-            intrinsics::move_val_init(&mut *ptr, value);\n+            mem::move_val_init(&mut *ptr, value);\n             Unique{ptr: ptr}\n         }\n     }\n@@ -226,7 +226,7 @@ impl<T: Send> Unique<T> {\n impl<T: Send> Drop for Unique<T> {\n     fn drop(&mut self) {\n         unsafe {\n-            let x = intrinsics::uninit(); // dummy value to swap in\n+            let x = mem::uninit(); // dummy value to swap in\n             // We need to move the object out of the box, so that\n             // the destructor is called (at the end of this scope.)\n             ptr::replace_ptr(self.ptr, x);"}, {"sha": "5ce034f26654913e097d29d66d5c6e0162d10f3c", "filename": "src/libarena/lib.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibarena%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibarena%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibarena%2Flib.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -32,10 +32,10 @@ use collections::list;\n use std::cast::{transmute, transmute_mut, transmute_mut_region};\n use std::cast;\n use std::cell::{Cell, RefCell};\n+use std::mem;\n use std::num;\n use std::ptr;\n use std::kinds::marker;\n-use std::mem;\n use std::rc::Rc;\n use std::rt::global_heap;\n use std::unstable::intrinsics::{TyDesc, get_tydesc};\n@@ -216,7 +216,7 @@ impl Arena {\n         unsafe {\n             let ptr = self.alloc_pod_inner(mem::size_of::<T>(), mem::min_align_of::<T>());\n             let ptr: *mut T = transmute(ptr);\n-            intrinsics::move_val_init(&mut (*ptr), op());\n+            mem::move_val_init(&mut (*ptr), op());\n             return transmute(ptr);\n         }\n     }\n@@ -278,7 +278,7 @@ impl Arena {\n             // has *not* been initialized yet.\n             *ty_ptr = transmute(tydesc);\n             // Actually initialize it\n-            intrinsics::move_val_init(&mut(*ptr), op());\n+            mem::move_val_init(&mut(*ptr), op());\n             // Now that we are done, update the tydesc to indicate that\n             // the object is there.\n             *ty_ptr = bitpack_tydesc_ptr(tydesc, true);\n@@ -379,7 +379,7 @@ impl TypedArenaChunk {\n         let mut chunk = unsafe {\n             let chunk = global_heap::exchange_malloc(size);\n             let mut chunk: ~TypedArenaChunk = cast::transmute(chunk);\n-            intrinsics::move_val_init(&mut chunk.next, next);\n+            mem::move_val_init(&mut chunk.next, next);\n             chunk\n         };\n \n@@ -466,7 +466,7 @@ impl<T> TypedArena<T> {\n             }\n \n             let ptr: &'a mut T = cast::transmute(this.ptr);\n-            intrinsics::move_val_init(ptr, object);\n+            mem::move_val_init(ptr, object);\n             this.ptr = this.ptr.offset(1);\n             let ptr: &'a T = ptr;\n             ptr"}, {"sha": "beac40308c021082d4ba535f07bbf2682b846338", "filename": "src/libcollections/priority_queue.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibcollections%2Fpriority_queue.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibcollections%2Fpriority_queue.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcollections%2Fpriority_queue.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -13,7 +13,7 @@\n #[allow(missing_doc)];\n \n use std::clone::Clone;\n-use std::unstable::intrinsics::{move_val_init, init};\n+use std::mem::{move_val_init, init};\n use std::util::{replace, swap};\n use std::vec;\n "}, {"sha": "c8754c839b28625e4d3b8741721a628b392ccc8f", "filename": "src/libnative/io/file.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibnative%2Fio%2Ffile.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibnative%2Fio%2Ffile.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibnative%2Fio%2Ffile.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -16,9 +16,9 @@ use std::io::IoError;\n use std::io;\n use std::libc::{c_int, c_void};\n use std::libc;\n+use std::mem;\n use std::os;\n use std::rt::rtio;\n-use std::unstable::intrinsics;\n use std::vec;\n \n use io::{IoResult, retry};\n@@ -147,7 +147,7 @@ impl rtio::RtioFileStream for FileDesc {\n         #[cfg(windows)]\n         fn os_pread(fd: c_int, buf: *u8, amt: uint, offset: u64) -> IoResult<int> {\n             unsafe {\n-                let mut overlap: libc::OVERLAPPED = intrinsics::init();\n+                let mut overlap: libc::OVERLAPPED = mem::init();\n                 let handle = libc::get_osfhandle(fd) as libc::HANDLE;\n                 let mut bytes_read = 0;\n                 overlap.Offset = offset as libc::DWORD;\n@@ -179,7 +179,7 @@ impl rtio::RtioFileStream for FileDesc {\n         #[cfg(windows)]\n         fn os_pwrite(fd: c_int, buf: *u8, amt: uint, offset: u64) -> IoResult<()> {\n             unsafe {\n-                let mut overlap: libc::OVERLAPPED = intrinsics::init();\n+                let mut overlap: libc::OVERLAPPED = mem::init();\n                 let handle = libc::get_osfhandle(fd) as libc::HANDLE;\n                 overlap.Offset = offset as libc::DWORD;\n                 overlap.OffsetHigh = (offset >> 32) as libc::DWORD;\n@@ -867,7 +867,7 @@ pub fn stat(p: &CString) -> IoResult<io::FileStat> {\n \n     #[cfg(windows)]\n     fn os_stat(p: &CString) -> IoResult<io::FileStat> {\n-        let mut stat: libc::stat = unsafe { intrinsics::uninit() };\n+        let mut stat: libc::stat = unsafe { mem::uninit() };\n         as_utf16_p(p.as_str().unwrap(), |up| {\n             match retry(|| unsafe { libc::wstat(up, &mut stat) }) {\n                 0 => Ok(mkstat(&stat, p)),\n@@ -878,7 +878,7 @@ pub fn stat(p: &CString) -> IoResult<io::FileStat> {\n \n     #[cfg(unix)]\n     fn os_stat(p: &CString) -> IoResult<io::FileStat> {\n-        let mut stat: libc::stat = unsafe { intrinsics::uninit() };\n+        let mut stat: libc::stat = unsafe { mem::uninit() };\n         match retry(|| unsafe { libc::stat(p.with_ref(|p| p), &mut stat) }) {\n             0 => Ok(mkstat(&stat, p)),\n             _ => Err(super::last_error()),\n@@ -897,7 +897,7 @@ pub fn lstat(p: &CString) -> IoResult<io::FileStat> {\n \n     #[cfg(unix)]\n     fn os_lstat(p: &CString) -> IoResult<io::FileStat> {\n-        let mut stat: libc::stat = unsafe { intrinsics::uninit() };\n+        let mut stat: libc::stat = unsafe { mem::uninit() };\n         match retry(|| unsafe { libc::lstat(p.with_ref(|p| p), &mut stat) }) {\n             0 => Ok(mkstat(&stat, p)),\n             _ => Err(super::last_error()),"}, {"sha": "ec6a5c5cb9bc9939754c889958eea23bc66247f4", "filename": "src/libnative/io/net.rs", "status": "modified", "additions": 7, "deletions": 8, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibnative%2Fio%2Fnet.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibnative%2Fio%2Fnet.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibnative%2Fio%2Fnet.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -15,7 +15,6 @@ use std::libc;\n use std::mem;\n use std::rt::rtio;\n use std::sync::arc::UnsafeArc;\n-use std::unstable::intrinsics;\n \n use super::{IoResult, retry};\n use super::file::keep_going;\n@@ -28,10 +27,10 @@ use super::file::keep_going;\n #[cfg(unix)]    pub type sock_t = super::file::fd_t;\n \n pub fn htons(u: u16) -> u16 {\n-    intrinsics::to_be16(u as i16) as u16\n+    mem::to_be16(u as i16) as u16\n }\n pub fn ntohs(u: u16) -> u16 {\n-    intrinsics::from_be16(u as i16) as u16\n+    mem::from_be16(u as i16) as u16\n }\n \n enum InAddr {\n@@ -68,7 +67,7 @@ fn ip_to_inaddr(ip: ip::IpAddr) -> InAddr {\n \n fn addr_to_sockaddr(addr: ip::SocketAddr) -> (libc::sockaddr_storage, uint) {\n     unsafe {\n-        let storage: libc::sockaddr_storage = intrinsics::init();\n+        let storage: libc::sockaddr_storage = mem::init();\n         let len = match ip_to_inaddr(addr.ip) {\n             InAddr(inaddr) => {\n                 let storage: *mut libc::sockaddr_in = cast::transmute(&storage);\n@@ -138,7 +137,7 @@ fn sockname(fd: sock_t,\n                                          *mut libc::socklen_t) -> libc::c_int)\n     -> IoResult<ip::SocketAddr>\n {\n-    let mut storage: libc::sockaddr_storage = unsafe { intrinsics::init() };\n+    let mut storage: libc::sockaddr_storage = unsafe { mem::init() };\n     let mut len = mem::size_of::<libc::sockaddr_storage>() as libc::socklen_t;\n     unsafe {\n         let storage = &mut storage as *mut libc::sockaddr_storage;\n@@ -225,7 +224,7 @@ pub fn init() {\n \n         LOCK.lock();\n         if !INITIALIZED {\n-            let mut data: WSADATA = intrinsics::init();\n+            let mut data: WSADATA = mem::init();\n             let ret = WSAStartup(0x202,      // version 2.2\n                                  &mut data);\n             assert_eq!(ret, 0);\n@@ -438,7 +437,7 @@ impl TcpAcceptor {\n \n     pub fn native_accept(&mut self) -> IoResult<TcpStream> {\n         unsafe {\n-            let mut storage: libc::sockaddr_storage = intrinsics::init();\n+            let mut storage: libc::sockaddr_storage = mem::init();\n             let storagep = &mut storage as *mut libc::sockaddr_storage;\n             let size = mem::size_of::<libc::sockaddr_storage>();\n             let mut size = size as libc::socklen_t;\n@@ -543,7 +542,7 @@ impl rtio::RtioSocket for UdpSocket {\n impl rtio::RtioUdpSocket for UdpSocket {\n     fn recvfrom(&mut self, buf: &mut [u8]) -> IoResult<(uint, ip::SocketAddr)> {\n         unsafe {\n-            let mut storage: libc::sockaddr_storage = intrinsics::init();\n+            let mut storage: libc::sockaddr_storage = mem::init();\n             let storagep = &mut storage as *mut libc::sockaddr_storage;\n             let mut addrlen: libc::socklen_t =\n                     mem::size_of::<libc::sockaddr_storage>() as libc::socklen_t;"}, {"sha": "a06cab33a52f76868fc24fb1a1211894876d6f2d", "filename": "src/libnative/io/timer_other.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibnative%2Fio%2Ftimer_other.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibnative%2Fio%2Ftimer_other.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibnative%2Fio%2Ftimer_other.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -49,11 +49,11 @@\n use std::comm::Data;\n use std::hashmap::HashMap;\n use std::libc;\n+use std::mem;\n use std::os;\n use std::ptr;\n use std::rt::rtio;\n use std::sync::atomics;\n-use std::unstable::intrinsics;\n \n use io::file::FileDesc;\n use io::IoResult;\n@@ -87,17 +87,17 @@ pub enum Req {\n // returns the current time (in milliseconds)\n fn now() -> u64 {\n     unsafe {\n-        let mut now: libc::timeval = intrinsics::init();\n+        let mut now: libc::timeval = mem::init();\n         assert_eq!(imp::gettimeofday(&mut now, ptr::null()), 0);\n         return (now.tv_sec as u64) * 1000 + (now.tv_usec as u64) / 1000;\n     }\n }\n \n fn helper(input: libc::c_int, messages: Port<Req>) {\n-    let mut set: imp::fd_set = unsafe { intrinsics::init() };\n+    let mut set: imp::fd_set = unsafe { mem::init() };\n \n     let mut fd = FileDesc::new(input, true);\n-    let mut timeout: libc::timeval = unsafe { intrinsics::init() };\n+    let mut timeout: libc::timeval = unsafe { mem::init() };\n \n     // active timers are those which are able to be selected upon (and it's a\n     // sorted list, and dead timers are those which have expired, but ownership"}, {"sha": "434794e32cb3c222e7f5527c2509e9c31f73a147", "filename": "src/libnative/io/timer_timerfd.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibnative%2Fio%2Ftimer_timerfd.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibnative%2Fio%2Ftimer_timerfd.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibnative%2Fio%2Ftimer_timerfd.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -34,7 +34,7 @@ use std::ptr;\n use std::os;\n use std::rt::rtio;\n use std::hashmap::HashMap;\n-use std::unstable::intrinsics;\n+use std::mem;\n \n use io::file::FileDesc;\n use io::IoResult;\n@@ -75,7 +75,7 @@ fn helper(input: libc::c_int, messages: Port<Req>) {\n     }\n \n     add(efd, input);\n-    let events: [imp::epoll_event, ..16] = unsafe { intrinsics::init() };\n+    let events: [imp::epoll_event, ..16] = unsafe { mem::init() };\n     let mut map: HashMap<libc::c_int, (Chan<()>, bool)> = HashMap::new();\n     'outer: loop {\n         let n = match unsafe {"}, {"sha": "1b3f5ec947d7f9dcce98154f0eefd9dd3878d054", "filename": "src/librustc/util/sha2.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibrustc%2Futil%2Fsha2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibrustc%2Futil%2Fsha2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Futil%2Fsha2.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -22,7 +22,7 @@ use extra::hex::ToHex;\n /// format.\n fn write_u32_be(dst: &mut[u8], input: u32) {\n     use std::cast::transmute;\n-    use std::unstable::intrinsics::to_be32;\n+    use std::mem::to_be32;\n     assert!(dst.len() == 4);\n     unsafe {\n         let x: *mut i32 = transmute(dst.unsafe_mut_ref(0));\n@@ -33,7 +33,7 @@ fn write_u32_be(dst: &mut[u8], input: u32) {\n /// Read a vector of bytes into a vector of u32s. The values are read in big-endian format.\n fn read_u32v_be(dst: &mut[u32], input: &[u8]) {\n     use std::cast::transmute;\n-    use std::unstable::intrinsics::to_be32;\n+    use std::mem::to_be32;\n     assert!(dst.len() * 4 == input.len());\n     unsafe {\n         let mut x: *mut i32 = transmute(dst.unsafe_mut_ref(0));"}, {"sha": "7c9448bb73241a6c34166c128bf0db81fce2d842", "filename": "src/librustdoc/html/markdown.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -28,6 +28,7 @@ use std::cast;\n use std::fmt;\n use std::io;\n use std::libc;\n+use std::mem;\n use std::str;\n use std::unstable::intrinsics;\n use std::vec;\n@@ -144,7 +145,7 @@ pub fn render(w: &mut io::Writer, s: &str) -> fmt::Result {\n             flags: 0,\n             link_attributes: None,\n         };\n-        let mut callbacks: sd_callbacks = intrinsics::init();\n+        let mut callbacks: sd_callbacks = mem::init();\n \n         sdhtml_renderer(&callbacks, &options, 0);\n         let opaque = my_opaque {\n@@ -197,7 +198,7 @@ pub fn find_testable_code(doc: &str, tests: &mut ::test::Collector) {\n                          MKDEXT_STRIKETHROUGH;\n         let callbacks = sd_callbacks {\n             blockcode: block,\n-            other: intrinsics::init()\n+            other: mem::init()\n         };\n \n         let tests = tests as *mut ::test::Collector as *libc::c_void;"}, {"sha": "87fadbba176f6bbf3206fb1c7fd533c9e1f2295e", "filename": "src/librustuv/net.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibrustuv%2Fnet.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibrustuv%2Fnet.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustuv%2Fnet.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -17,7 +17,6 @@ use std::mem;\n use std::ptr;\n use std::rt::rtio;\n use std::rt::task::BlockedTask;\n-use std::unstable::intrinsics;\n \n use access::Access;\n use homing::{HomingIO, HomeHandle};\n@@ -33,8 +32,8 @@ use uvll;\n /// Generic functions related to dealing with sockaddr things\n ////////////////////////////////////////////////////////////////////////////////\n \n-pub fn htons(u: u16) -> u16 { intrinsics::to_be16(u as i16) as u16 }\n-pub fn ntohs(u: u16) -> u16 { intrinsics::from_be16(u as i16) as u16 }\n+pub fn htons(u: u16) -> u16 { mem::to_be16(u as i16) as u16 }\n+pub fn ntohs(u: u16) -> u16 { mem::from_be16(u as i16) as u16 }\n \n pub fn sockaddr_to_addr(storage: &libc::sockaddr_storage,\n                         len: uint) -> ip::SocketAddr {\n@@ -80,7 +79,7 @@ pub fn sockaddr_to_addr(storage: &libc::sockaddr_storage,\n \n fn addr_to_sockaddr(addr: ip::SocketAddr) -> (libc::sockaddr_storage, uint) {\n     unsafe {\n-        let mut storage: libc::sockaddr_storage = intrinsics::init();\n+        let mut storage: libc::sockaddr_storage = mem::init();\n         let len = match addr.ip {\n             ip::Ipv4Addr(a, b, c, d) => {\n                 let storage: &mut libc::sockaddr_in =\n@@ -134,7 +133,7 @@ fn socket_name(sk: SocketNameKind,\n     };\n \n     // Allocate a sockaddr_storage since we don't know if it's ipv4 or ipv6\n-    let mut sockaddr: libc::sockaddr_storage = unsafe { intrinsics::init() };\n+    let mut sockaddr: libc::sockaddr_storage = unsafe { mem::init() };\n     let mut namelen = mem::size_of::<libc::sockaddr_storage>() as c_int;\n \n     let sockaddr_p = &mut sockaddr as *mut libc::sockaddr_storage;"}, {"sha": "f08f943306fcf5a10d163d2f87a38a722ada64bd", "filename": "src/libserialize/ebml.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibserialize%2Febml.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibserialize%2Febml.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibserialize%2Febml.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -132,7 +132,7 @@ pub mod reader {\n \n     pub fn vuint_at(data: &[u8], start: uint) -> Res {\n         use std::ptr::offset;\n-        use std::unstable::intrinsics::from_be32;\n+        use std::mem::from_be32;\n \n         if data.len() - start < 4 {\n             return vuint_at_slow(data, start);"}, {"sha": "cc6cd7666d642bbbce53ac37b5c6f924fafe8bf6", "filename": "src/libstd/c_str.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Fc_str.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Fc_str.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fc_str.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -70,14 +70,14 @@ use kinds::marker;\n use ops::Drop;\n use cmp::Eq;\n use clone::Clone;\n+use mem;\n use option::{Option, Some, None};\n use ptr::RawPtr;\n use ptr;\n use str::StrSlice;\n use str;\n use vec::{ImmutableVector, MutableVector};\n use vec;\n-use unstable::intrinsics;\n use rt::global_heap::malloc_raw;\n \n /// The representation of a C String.\n@@ -327,7 +327,7 @@ impl<'a> ToCStr for &'a [u8] {\n // Unsafe function that handles possibly copying the &[u8] into a stack array.\n unsafe fn with_c_str<T>(v: &[u8], checked: bool, f: |*libc::c_char| -> T) -> T {\n     if v.len() < BUF_LEN {\n-        let mut buf: [u8, .. BUF_LEN] = intrinsics::uninit();\n+        let mut buf: [u8, .. BUF_LEN] = mem::uninit();\n         vec::bytes::copy_memory(buf, v);\n         buf[v.len()] = 0;\n "}, {"sha": "258c0e23094041b2ead4f73a952b7698cf7fdfe5", "filename": "src/libstd/cast.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Fcast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Fcast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fcast.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -18,7 +18,7 @@ use ptr::copy_nonoverlapping_memory;\n /// Casts the value at `src` to U. The two types must have the same length.\n #[inline]\n pub unsafe fn transmute_copy<T, U>(src: &T) -> U {\n-    let mut dest: U = intrinsics::uninit();\n+    let mut dest: U = mem::uninit();\n     let dest_ptr: *mut u8 = transmute(&mut dest);\n     let src_ptr: *u8 = transmute(src);\n     copy_nonoverlapping_memory(dest_ptr, src_ptr, mem::size_of::<U>());"}, {"sha": "240f4c65501dc29fe024be036abe50c7692a2133", "filename": "src/libstd/io/extensions.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Fio%2Fextensions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Fio%2Fextensions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fio%2Fextensions.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -51,7 +51,7 @@ impl<'r, R: Reader> Iterator<u8> for Bytes<'r, R> {\n }\n \n pub fn u64_to_le_bytes<T>(n: u64, size: uint, f: |v: &[u8]| -> T) -> T {\n-    use unstable::intrinsics::{to_le16, to_le32, to_le64};\n+    use mem::{to_le16, to_le32, to_le64};\n     use cast::transmute;\n \n     // LLVM fails to properly optimize this when using shifts instead of the to_le* intrinsics\n@@ -77,7 +77,7 @@ pub fn u64_to_le_bytes<T>(n: u64, size: uint, f: |v: &[u8]| -> T) -> T {\n }\n \n pub fn u64_to_be_bytes<T>(n: u64, size: uint, f: |v: &[u8]| -> T) -> T {\n-    use unstable::intrinsics::{to_be16, to_be32, to_be64};\n+    use mem::{to_be16, to_be32, to_be64};\n     use cast::transmute;\n \n     // LLVM fails to properly optimize this when using shifts instead of the to_be* intrinsics\n@@ -105,7 +105,7 @@ pub fn u64_from_be_bytes(data: &[u8],\n                          size: uint)\n                       -> u64 {\n     use ptr::{copy_nonoverlapping_memory, offset, mut_offset};\n-    use unstable::intrinsics::from_be64;\n+    use mem::from_be64;\n     use vec::MutableVector;\n \n     assert!(size <= 8u);"}, {"sha": "ccedd34a0d13fb0264c05489485a8a3c1ac771cb", "filename": "src/libstd/mem.rs", "status": "modified", "additions": 59, "deletions": 1, "changes": 60, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Fmem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Fmem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fmem.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -8,9 +8,15 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-//! Functions relating to memory layout\n+//! Basic functions for dealing with memory\n+//!\n+//! This module contains functions for querying the size and alignment of\n+//! types, initializing and manipulating memory.\n+\n+#[allow(missing_doc)]; // FIXME\n \n use unstable::intrinsics;\n+use unstable::intrinsics::{bswap16, bswap32, bswap64};\n \n /// Returns the size of a type\n #[inline]\n@@ -68,6 +74,58 @@ pub fn pref_align_of_val<T>(_val: &T) -> uint {\n     pref_align_of::<T>()\n }\n \n+/// Create a value initialized to zero.\n+///\n+/// `init` is unsafe because it returns a zeroed-out datum,\n+/// which is unsafe unless T is Pod.\n+#[inline]\n+pub unsafe fn init<T>() -> T {\n+    intrinsics::init()\n+}\n+\n+/// Create an uninitialized value.\n+#[inline]\n+pub unsafe fn uninit<T>() -> T {\n+    intrinsics::uninit()\n+}\n+\n+/// Move a value to an uninitialized memory location.\n+///\n+/// Drop glue is not run on the destination.\n+#[inline]\n+pub unsafe fn move_val_init<T>(dst: &mut T, src: T) {\n+    intrinsics::move_val_init(dst, src)\n+}\n+\n+#[cfg(target_endian = \"little\")] #[inline] pub fn to_le16(x: i16) -> i16 { x }\n+#[cfg(target_endian = \"big\")]    #[inline] pub fn to_le16(x: i16) -> i16 { unsafe { bswap16(x) } }\n+#[cfg(target_endian = \"little\")] #[inline] pub fn to_le32(x: i32) -> i32 { x }\n+#[cfg(target_endian = \"big\")]    #[inline] pub fn to_le32(x: i32) -> i32 { unsafe { bswap32(x) } }\n+#[cfg(target_endian = \"little\")] #[inline] pub fn to_le64(x: i64) -> i64 { x }\n+#[cfg(target_endian = \"big\")]    #[inline] pub fn to_le64(x: i64) -> i64 { unsafe { bswap64(x) } }\n+\n+#[cfg(target_endian = \"little\")] #[inline] pub fn to_be16(x: i16) -> i16 { unsafe { bswap16(x) } }\n+#[cfg(target_endian = \"big\")]    #[inline] pub fn to_be16(x: i16) -> i16 { x }\n+#[cfg(target_endian = \"little\")] #[inline] pub fn to_be32(x: i32) -> i32 { unsafe { bswap32(x) } }\n+#[cfg(target_endian = \"big\")]    #[inline] pub fn to_be32(x: i32) -> i32 { x }\n+#[cfg(target_endian = \"little\")] #[inline] pub fn to_be64(x: i64) -> i64 { unsafe { bswap64(x) } }\n+#[cfg(target_endian = \"big\")]    #[inline] pub fn to_be64(x: i64) -> i64 { x }\n+\n+#[cfg(target_endian = \"little\")] #[inline] pub fn from_le16(x: i16) -> i16 { x }\n+#[cfg(target_endian = \"big\")]    #[inline] pub fn from_le16(x: i16) -> i16 { unsafe { bswap16(x) } }\n+#[cfg(target_endian = \"little\")] #[inline] pub fn from_le32(x: i32) -> i32 { x }\n+#[cfg(target_endian = \"big\")]    #[inline] pub fn from_le32(x: i32) -> i32 { unsafe { bswap32(x) } }\n+#[cfg(target_endian = \"little\")] #[inline] pub fn from_le64(x: i64) -> i64 { x }\n+#[cfg(target_endian = \"big\")]    #[inline] pub fn from_le64(x: i64) -> i64 { unsafe { bswap64(x) } }\n+\n+#[cfg(target_endian = \"little\")] #[inline] pub fn from_be16(x: i16) -> i16 { unsafe { bswap16(x) } }\n+#[cfg(target_endian = \"big\")]    #[inline] pub fn from_be16(x: i16) -> i16 { x }\n+#[cfg(target_endian = \"little\")] #[inline] pub fn from_be32(x: i32) -> i32 { unsafe { bswap32(x) } }\n+#[cfg(target_endian = \"big\")]    #[inline] pub fn from_be32(x: i32) -> i32 { x }\n+#[cfg(target_endian = \"little\")] #[inline] pub fn from_be64(x: i64) -> i64 { unsafe { bswap64(x) } }\n+#[cfg(target_endian = \"big\")]    #[inline] pub fn from_be64(x: i64) -> i64 { x }\n+\n+\n #[cfg(test)]\n mod tests {\n     use mem::*;"}, {"sha": "d22e91fb83e275c4b194f64d5a0aa1ae524eaf27", "filename": "src/libstd/ptr.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Fptr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Fptr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fptr.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -15,6 +15,7 @@ use clone::Clone;\n #[cfg(not(test))]\n use cmp::Equiv;\n use iter::{range, Iterator};\n+use mem;\n use option::{Option, Some, None};\n use unstable::intrinsics;\n use util::swap;\n@@ -132,7 +133,7 @@ pub unsafe fn zero_memory<T>(dst: *mut T, count: uint) {\n #[inline]\n pub unsafe fn swap_ptr<T>(x: *mut T, y: *mut T) {\n     // Give ourselves some scratch space to work with\n-    let mut tmp: T = intrinsics::uninit();\n+    let mut tmp: T = mem::uninit();\n     let t: *mut T = &mut tmp;\n \n     // Perform the swap\n@@ -160,7 +161,7 @@ pub unsafe fn replace_ptr<T>(dest: *mut T, mut src: T) -> T {\n  */\n #[inline(always)]\n pub unsafe fn read_ptr<T>(src: *T) -> T {\n-    let mut tmp: T = intrinsics::uninit();\n+    let mut tmp: T = mem::uninit();\n     copy_nonoverlapping_memory(&mut tmp, src, 1);\n     tmp\n }"}, {"sha": "b443182c157a343a8bb11ba39bba31ad7da2d28d", "filename": "src/libstd/rt/thread.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Frt%2Fthread.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Frt%2Fthread.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Frt%2Fthread.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -205,17 +205,17 @@ mod imp {\n     use cmp;\n     use libc::consts::os::posix01::{PTHREAD_CREATE_JOINABLE, PTHREAD_STACK_MIN};\n     use libc;\n+    use mem;\n     use os;\n     use ptr;\n-    use unstable::intrinsics;\n     use unstable::stack::RED_ZONE;\n \n     pub type rust_thread = libc::pthread_t;\n     pub type rust_thread_return = *u8;\n \n     pub unsafe fn create(stack: uint, p: ~proc()) -> rust_thread {\n-        let mut native: libc::pthread_t = intrinsics::uninit();\n-        let mut attr: libc::pthread_attr_t = intrinsics::uninit();\n+        let mut native: libc::pthread_t = mem::uninit();\n+        let mut attr: libc::pthread_attr_t = mem::uninit();\n         assert_eq!(pthread_attr_init(&mut attr), 0);\n         assert_eq!(pthread_attr_setdetachstate(&mut attr,\n                                                PTHREAD_CREATE_JOINABLE), 0);"}, {"sha": "624a5aa72de7b8fac65b0f359ad13103032706f1", "filename": "src/libstd/trie.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Ftrie.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Ftrie.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Ftrie.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -16,7 +16,7 @@ use iter::{Extendable, FromIterator, Iterator};\n use mem;\n use uint;\n use util::replace;\n-use unstable::intrinsics::init;\n+use mem::init;\n use vec;\n use ptr::RawPtr;\n use vec::{ImmutableVector, Items, MutableVector, MutItems, OwnedVector};"}, {"sha": "105236b5f4c732d84bb82d8bb3316ec99e7b2466", "filename": "src/libstd/unstable/intrinsics.rs", "status": "modified", "additions": 1, "deletions": 29, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Funstable%2Fintrinsics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Funstable%2Fintrinsics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Funstable%2Fintrinsics.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -288,8 +288,7 @@ extern \"rust-intrinsic\" {\n     /// Create a value initialized to zero.\n     ///\n     /// `init` is unsafe because it returns a zeroed-out datum,\n-    /// which is unsafe unless T is POD. We don't have a POD\n-    /// kind yet. (See #4074).\n+    /// which is unsafe unless T is Pod.\n     pub fn init<T>() -> T;\n \n     /// Create an uninitialized value.\n@@ -440,33 +439,6 @@ extern \"rust-intrinsic\" {\n     pub fn u64_mul_with_overflow(x: u64, y: u64) -> (u64, bool);\n }\n \n-#[cfg(target_endian = \"little\")] #[inline] pub fn to_le16(x: i16) -> i16 { x }\n-#[cfg(target_endian = \"big\")]    #[inline] pub fn to_le16(x: i16) -> i16 { unsafe { bswap16(x) } }\n-#[cfg(target_endian = \"little\")] #[inline] pub fn to_le32(x: i32) -> i32 { x }\n-#[cfg(target_endian = \"big\")]    #[inline] pub fn to_le32(x: i32) -> i32 { unsafe { bswap32(x) } }\n-#[cfg(target_endian = \"little\")] #[inline] pub fn to_le64(x: i64) -> i64 { x }\n-#[cfg(target_endian = \"big\")]    #[inline] pub fn to_le64(x: i64) -> i64 { unsafe { bswap64(x) } }\n-\n-#[cfg(target_endian = \"little\")] #[inline] pub fn to_be16(x: i16) -> i16 { unsafe { bswap16(x) } }\n-#[cfg(target_endian = \"big\")]    #[inline] pub fn to_be16(x: i16) -> i16 { x }\n-#[cfg(target_endian = \"little\")] #[inline] pub fn to_be32(x: i32) -> i32 { unsafe { bswap32(x) } }\n-#[cfg(target_endian = \"big\")]    #[inline] pub fn to_be32(x: i32) -> i32 { x }\n-#[cfg(target_endian = \"little\")] #[inline] pub fn to_be64(x: i64) -> i64 { unsafe { bswap64(x) } }\n-#[cfg(target_endian = \"big\")]    #[inline] pub fn to_be64(x: i64) -> i64 { x }\n-\n-#[cfg(target_endian = \"little\")] #[inline] pub fn from_le16(x: i16) -> i16 { x }\n-#[cfg(target_endian = \"big\")]    #[inline] pub fn from_le16(x: i16) -> i16 { unsafe { bswap16(x) } }\n-#[cfg(target_endian = \"little\")] #[inline] pub fn from_le32(x: i32) -> i32 { x }\n-#[cfg(target_endian = \"big\")]    #[inline] pub fn from_le32(x: i32) -> i32 { unsafe { bswap32(x) } }\n-#[cfg(target_endian = \"little\")] #[inline] pub fn from_le64(x: i64) -> i64 { x }\n-#[cfg(target_endian = \"big\")]    #[inline] pub fn from_le64(x: i64) -> i64 { unsafe { bswap64(x) } }\n-\n-#[cfg(target_endian = \"little\")] #[inline] pub fn from_be16(x: i16) -> i16 { unsafe { bswap16(x) } }\n-#[cfg(target_endian = \"big\")]    #[inline] pub fn from_be16(x: i16) -> i16 { x }\n-#[cfg(target_endian = \"little\")] #[inline] pub fn from_be32(x: i32) -> i32 { unsafe { bswap32(x) } }\n-#[cfg(target_endian = \"big\")]    #[inline] pub fn from_be32(x: i32) -> i32 { x }\n-#[cfg(target_endian = \"little\")] #[inline] pub fn from_be64(x: i64) -> i64 { unsafe { bswap64(x) } }\n-#[cfg(target_endian = \"big\")]    #[inline] pub fn from_be64(x: i64) -> i64 { x }\n \n /// `TypeId` represents a globally unique identifier for a type\n #[lang=\"type_id\"] // This needs to be kept in lockstep with the code in trans/intrinsic.rs and"}, {"sha": "3122e925e82d9f5d6fdfdcfc6967d451cee6be05", "filename": "src/libstd/unstable/mutex.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Funstable%2Fmutex.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Funstable%2Fmutex.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Funstable%2Fmutex.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -92,7 +92,7 @@ mod imp {\n     use libc;\n     use self::os::{PTHREAD_MUTEX_INITIALIZER, PTHREAD_COND_INITIALIZER,\n                    pthread_mutex_t, pthread_cond_t};\n-    use unstable::intrinsics;\n+    use mem;\n \n     type pthread_mutexattr_t = libc::c_void;\n     type pthread_condattr_t = libc::c_void;\n@@ -208,8 +208,8 @@ mod imp {\n     impl Mutex {\n         pub unsafe fn new() -> Mutex {\n             let mut m = Mutex {\n-                lock: intrinsics::init(),\n-                cond: intrinsics::init(),\n+                lock: mem::init(),\n+                cond: mem::init(),\n             };\n \n             pthread_mutex_init(&mut m.lock, 0 as *libc::c_void);"}, {"sha": "05c5d7e1588169f9317df831b66f98c89003270e", "filename": "src/libstd/util.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Futil.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -11,8 +11,8 @@\n //! Miscellaneous helpers for common patterns\n \n use cast;\n+use mem;\n use ptr;\n-use unstable::intrinsics;\n \n /// The identity function.\n #[inline]\n@@ -26,7 +26,7 @@ pub fn id<T>(x: T) -> T { x }\n pub fn swap<T>(x: &mut T, y: &mut T) {\n     unsafe {\n         // Give ourselves some scratch space to work with\n-        let mut tmp: T = intrinsics::uninit();\n+        let mut tmp: T = mem::uninit();\n         let t: *mut T = &mut tmp;\n \n         // Perform the swap, `&mut` pointers never alias"}, {"sha": "85413cb5bd6623dbfffe455cdd5fa484f03ae129", "filename": "src/libstd/vec.rs", "status": "modified", "additions": 5, "deletions": 6, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Fvec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Fvec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fvec.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -120,7 +120,6 @@ use mem::size_of;\n use kinds::marker;\n use uint;\n use unstable::finally::Finally;\n-use unstable::intrinsics;\n use unstable::raw::{Repr, Slice, Vec};\n use util;\n \n@@ -137,7 +136,7 @@ pub fn from_fn<T>(n_elts: uint, op: |uint| -> T) -> ~[T] {\n         let mut i: uint = 0u;\n         (|| {\n             while i < n_elts {\n-                intrinsics::move_val_init(&mut(*ptr::mut_offset(p, i as int)), op(i));\n+                mem::move_val_init(&mut(*ptr::mut_offset(p, i as int)), op(i));\n                 i += 1u;\n             }\n         }).finally(|| {\n@@ -164,7 +163,7 @@ pub fn from_elem<T:Clone>(n_elts: uint, t: T) -> ~[T] {\n         let mut i = 0u;\n         (|| {\n             while i < n_elts {\n-                intrinsics::move_val_init(&mut(*ptr::mut_offset(p, i as int)), t.clone());\n+                mem::move_val_init(&mut(*ptr::mut_offset(p, i as int)), t.clone());\n                 i += 1u;\n             }\n         }).finally(|| {\n@@ -1495,7 +1494,7 @@ impl<T> OwnedVector<T> for ~[T] {\n             (**repr).fill += mem::nonzero_size_of::<T>();\n             let p = to_unsafe_ptr(&((**repr).data));\n             let p = ptr::offset(p, fill as int) as *mut T;\n-            intrinsics::move_val_init(&mut(*p), t);\n+            mem::move_val_init(&mut(*p), t);\n         }\n     }\n \n@@ -1552,7 +1551,7 @@ impl<T> OwnedVector<T> for ~[T] {\n             ptr::copy_memory(p.offset(1), p, len - i);\n             // Write it in, overwriting the first copy of the `i`th\n             // element.\n-            intrinsics::move_val_init(&mut *p, x);\n+            mem::move_val_init(&mut *p, x);\n             self.set_len(len + 1);\n         }\n     }\n@@ -2397,7 +2396,7 @@ impl<'a,T> MutableVector<'a, T> for &'a mut [T] {\n \n     #[inline]\n     unsafe fn init_elem(self, i: uint, val: T) {\n-        intrinsics::move_val_init(&mut (*self.as_mut_ptr().offset(i as int)), val);\n+        mem::move_val_init(&mut (*self.as_mut_ptr().offset(i as int)), val);\n     }\n \n     #[inline]"}, {"sha": "90bc5836240124e6c6c43e798f9367286a57e113", "filename": "src/libstd/vec_ng.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Fvec_ng.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibstd%2Fvec_ng.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fvec_ng.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -17,14 +17,13 @@ use clone::Clone;\n use iter::{DoubleEndedIterator, Iterator};\n use num::CheckedMul;\n use container::Container;\n-use mem::size_of;\n+use mem::{size_of, move_val_init};\n use cast::{forget, transmute};\n use rt::global_heap::{malloc_raw, realloc_raw};\n use vec::{ImmutableVector, Items, MutableVector};\n use unstable::raw::Slice;\n use ptr::{offset, read_ptr};\n use libc::{free, c_void};\n-use unstable::intrinsics::move_val_init;\n \n pub struct Vec<T> {\n     priv len: uint,"}, {"sha": "36b267c7eb74173b3a405b1cff3f2f6541bd8897", "filename": "src/libuuid/lib.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibuuid%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Flibuuid%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibuuid%2Flib.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -203,7 +203,7 @@ impl Uuid {\n     /// * `d3` A 16-bit word\n     /// * `d4` Array of 8 octets\n     pub fn from_fields(d1: u32, d2: u16, d3: u16, d4: &[u8]) -> Uuid {\n-        use std::unstable::intrinsics::{to_be16, to_be32};\n+        use std::mem::{to_be16, to_be32};\n \n         // First construct a temporary field-based struct\n         let mut fields = UuidFields {\n@@ -329,7 +329,7 @@ impl Uuid {\n     ///\n     /// Example: `550e8400-e29b-41d4-a716-446655440000`\n     pub fn to_hyphenated_str(&self) -> ~str {\n-        use std::unstable::intrinsics::{to_be16, to_be32};\n+        use std::mem::{to_be16, to_be32};\n         // Convert to field-based struct as it matches groups in output.\n         // Ensure fields are in network byte order, as per RFC.\n         let mut uf: UuidFields;"}, {"sha": "5140a2984f224846c129b02a633d3d8d9440ea6a", "filename": "src/test/bench/shootout-k-nucleotide.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Ftest%2Fbench%2Fshootout-k-nucleotide.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Ftest%2Fbench%2Fshootout-k-nucleotide.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fbench%2Fshootout-k-nucleotide.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -16,8 +16,8 @@ use std::cast::transmute;\n use std::i32::range;\n use std::libc::{STDIN_FILENO, c_int, fdopen, fgets, fileno, fopen, fstat};\n use std::libc::{stat, strlen};\n+use std::mem::init;\n use std::ptr::null;\n-use std::unstable::intrinsics::init;\n use std::vec::{reverse};\n \n static LINE_LEN: uint = 80;"}, {"sha": "3c389f49aa14af6c5456d3ff1aad18262de92415", "filename": "src/test/run-pass/issue-10714.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Ftest%2Frun-pass%2Fissue-10714.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Ftest%2Frun-pass%2Fissue-10714.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fissue-10714.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -10,5 +10,5 @@\n \n enum v {}\n pub fn main() {\n-    let y: v = unsafe { ::std::unstable::intrinsics::uninit() };\n+    let y: v = unsafe { ::std::mem::uninit() };\n }"}, {"sha": "ea067bc65cb7417292ffa39135cf3cf6663dd372", "filename": "src/test/run-pass/type-use-i1-versus-i8.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Ftest%2Frun-pass%2Ftype-use-i1-versus-i8.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Ftest%2Frun-pass%2Ftype-use-i1-versus-i8.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Ftype-use-i1-versus-i8.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -8,12 +8,12 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-use std::unstable;\n+use std::mem;\n \n pub fn main() {\n     unsafe {\n         let mut x: bool = false;\n         // this line breaks it\n-        unstable::intrinsics::move_val_init(&mut x, false);\n+        mem::move_val_init(&mut x, false);\n     }\n }"}, {"sha": "df24a399f4a737df79794785856d6504c5dbb9fa", "filename": "src/test/run-pass/uninit-empty-types.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Ftest%2Frun-pass%2Funinit-empty-types.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27f9c7951fb30b299341668f16a6f84169e1379e/src%2Ftest%2Frun-pass%2Funinit-empty-types.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Funinit-empty-types.rs?ref=27f9c7951fb30b299341668f16a6f84169e1379e", "patch": "@@ -11,14 +11,14 @@\n // Test the uninit() construct returning various empty types.\n \n use std::vec;\n-use std::unstable::intrinsics;\n+use std::mem;\n \n #[deriving(Clone)]\n struct Foo;\n \n pub fn main() {\n     unsafe {\n-        let _x: Foo = intrinsics::uninit();\n-        let _x: [Foo, ..2] = intrinsics::uninit();\n+        let _x: Foo = mem::uninit();\n+        let _x: [Foo, ..2] = mem::uninit();\n     }\n }"}]}