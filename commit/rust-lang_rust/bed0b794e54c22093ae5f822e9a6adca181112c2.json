{"sha": "bed0b794e54c22093ae5f822e9a6adca181112c2", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJlZDBiNzk0ZTU0YzIyMDkzYWU1ZjgyMmU5YTZhZGNhMTgxMTEyYzI=", "commit": {"author": {"name": "oxalica", "email": "oxalicc@pm.me", "date": "2020-06-18T12:31:32Z"}, "committer": {"name": "oxalica", "email": "oxalicc@pm.me", "date": "2020-06-18T14:33:23Z"}, "message": "Allow overriding rust-analyzer display revision", "tree": {"sha": "2499b485f049a7b39fedb45b8a1de7c10050d12e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2499b485f049a7b39fedb45b8a1de7c10050d12e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bed0b794e54c22093ae5f822e9a6adca181112c2", "comment_count": 0, "verification": {"verified": false, "reason": "unknown_key", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEXLDp5dXVcfV/VA/qztOS3gxIPQAFAl7rezcACgkQztOS3gxI\nPQCDCw//ZRR8TTZ7gXmJCav5ic6feqy3HIsGUWD+hXHq1rHVWY353TuqRRX8+t52\nRqis81pW8pJFp0bwkLyeoP4xig5ds0YObkClq1XILDUIrQL4K6L/gCWFUUx2F4ft\nMiHH1U+/0K2qb2bhe5REhKUV2P+vXOsDmws0ZYO3mH+eYaHNyiBgFQ8BFl26q6i9\nLps6HU3yA05M2dW6VzjLHpGFF89hEUOPHHvxLoQohV874T60DXSQUI4l+UcGPkxk\nIi4diZM6x85XZ8mBB5hyf71Ev25GlaH59i75c1qGXZShOzZkFbWj7bG/5DeirGNb\n5SdUgarxBK4e3f2CoXg2v5HgHKeWlicnMcsFU1vuKi+QK1uy/EMIdGOYFrxSRKgW\nZFYNxFBilhBsUu2Fcvz43NXlxGgqtY0TF3nIIFh3V5AKBavxy4zqtzucc5sT7tla\n+QoU5OMrBp1eiP5sYWfxKXKWp3dtv2Pa6L5fJlCA6x5o9EYi47/XN6QXhXpkJjH5\n0kc8rUAQZ9FYqwrJA0bZmb9tfUx6U6sf/2DFgI3cGocyvdnS257WaDH7zRMbCkTl\nJs5LaQk2EawscjM+0gjBU4PdFuMcSyfUsAJPeYrsebSWPH3Ns667J8SNLQJHD3Qw\nfxCHCMgeHHc2/s0T/ebQj9E6s+ao908UeT9qyuHntwTNyDi8PkQ=\n=HLlG\n-----END PGP SIGNATURE-----", "payload": "tree 2499b485f049a7b39fedb45b8a1de7c10050d12e\nparent 0262dba97ef114bd7664a4e32be21caef2d63f0a\nauthor oxalica <oxalicc@pm.me> 1592483492 +0800\ncommitter oxalica <oxalicc@pm.me> 1592490803 +0800\n\nAllow overriding rust-analyzer display revision\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bed0b794e54c22093ae5f822e9a6adca181112c2", "html_url": "https://github.com/rust-lang/rust/commit/bed0b794e54c22093ae5f822e9a6adca181112c2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bed0b794e54c22093ae5f822e9a6adca181112c2/comments", "author": {"login": "oxalica", "id": 14816024, "node_id": "MDQ6VXNlcjE0ODE2MDI0", "avatar_url": "https://avatars.githubusercontent.com/u/14816024?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oxalica", "html_url": "https://github.com/oxalica", "followers_url": "https://api.github.com/users/oxalica/followers", "following_url": "https://api.github.com/users/oxalica/following{/other_user}", "gists_url": "https://api.github.com/users/oxalica/gists{/gist_id}", "starred_url": "https://api.github.com/users/oxalica/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oxalica/subscriptions", "organizations_url": "https://api.github.com/users/oxalica/orgs", "repos_url": "https://api.github.com/users/oxalica/repos", "events_url": "https://api.github.com/users/oxalica/events{/privacy}", "received_events_url": "https://api.github.com/users/oxalica/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oxalica", "id": 14816024, "node_id": "MDQ6VXNlcjE0ODE2MDI0", "avatar_url": "https://avatars.githubusercontent.com/u/14816024?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oxalica", "html_url": "https://github.com/oxalica", "followers_url": "https://api.github.com/users/oxalica/followers", "following_url": "https://api.github.com/users/oxalica/following{/other_user}", "gists_url": "https://api.github.com/users/oxalica/gists{/gist_id}", "starred_url": "https://api.github.com/users/oxalica/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oxalica/subscriptions", "organizations_url": "https://api.github.com/users/oxalica/orgs", "repos_url": "https://api.github.com/users/oxalica/repos", "events_url": "https://api.github.com/users/oxalica/events{/privacy}", "received_events_url": "https://api.github.com/users/oxalica/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0262dba97ef114bd7664a4e32be21caef2d63f0a", "url": "https://api.github.com/repos/rust-lang/rust/commits/0262dba97ef114bd7664a4e32be21caef2d63f0a", "html_url": "https://github.com/rust-lang/rust/commit/0262dba97ef114bd7664a4e32be21caef2d63f0a"}], "stats": {"total": 4, "additions": 3, "deletions": 1}, "files": [{"sha": "5f2162cba9e9fb9f2366894752e90f49d04880c6", "filename": "crates/rust-analyzer/build.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/bed0b794e54c22093ae5f822e9a6adca181112c2/crates%2Frust-analyzer%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bed0b794e54c22093ae5f822e9a6adca181112c2/crates%2Frust-analyzer%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fbuild.rs?ref=bed0b794e54c22093ae5f822e9a6adca181112c2", "patch": "@@ -5,11 +5,13 @@ use std::{env, path::PathBuf, process::Command};\n fn main() {\n     set_rerun();\n \n-    let rev = rev().unwrap_or_else(|| \"???????\".to_string());\n+    let rev = env::var(\"RUST_ANALYZER_REV\").ok().or_else(rev).unwrap_or_else(|| \"???????\".to_string());\n     println!(\"cargo:rustc-env=REV={}\", rev)\n }\n \n fn set_rerun() {\n+    println!(\"cargo:rerun-if-env-changed=RUST_ANALYZER_REV\");\n+\n     let mut manifest_dir = PathBuf::from(\n         env::var(\"CARGO_MANIFEST_DIR\").expect(\"`CARGO_MANIFEST_DIR` is always set by cargo.\"),\n     );"}]}