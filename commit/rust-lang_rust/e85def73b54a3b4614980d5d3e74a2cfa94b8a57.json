{"sha": "e85def73b54a3b4614980d5d3e74a2cfa94b8a57", "node_id": "C_kwDOAAsO6NoAKGU4NWRlZjczYjU0YTNiNDYxNDk4MGQ1ZDNlNzRhMmNmYTk0YjhhNTc", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-10-19T19:38:41Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-10-19T19:38:41Z"}, "message": "Rollup merge of #103246 - ferrocene:pa-rust-analyzer-hosts, r=Mark-Simulacrum\n\nMark `rust-analyzer` as a host-only tool\n\nAll tools meant to be shipped with host toolchains only should be marked as `ONLY_HOSTS = true`, but rust-analyzer was marked as `ONLY_HOSTS = false` incorrectly. This meant that bootstrap attempted to build rust-analyzer for cross-compilation-only targets, causing errors because libstd is not present on some of them.\n\nIt will still be possible to cross-compile rust-analyzer by passing a different `--host` flag to `./x`, like you can cross-compile other tools.\n\nThe problem can be reproduced by running:\n\n```\n./x build src/tools/rust-analyzer --target x86_64-unknown-linux-gnu,aarch64-unknown-none\n```", "tree": {"sha": "3e677484cf5c466b6dda2b4174cf05386ab52c47", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3e677484cf5c466b6dda2b4174cf05386ab52c47"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e85def73b54a3b4614980d5d3e74a2cfa94b8a57", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjUFJBCRBK7hj4Ov3rIwAABgUIAHgpIl0zK/fSkJyuQ8+QbLmv\nnrdr2sPV0/2+mUJPieUlLnbA90oLSMZjsVVeWtpQwFs2Cuz5VAqOmOKzJRHhAAUw\nEpEsPVG3pdAbUerhrqGBG7yUoaw/LqnIAJStJ2DAnXnVOcdv4e2lMOdiX6NAEnBD\nuk8hX+hAHfLq0wByMW3s1hhujvHBs0IQL5E+Dh9m1tO+SgqAaDvmqd/9dDYHOXSS\n5BXAPg2nGfcmYbhKYceYqkb16abpgbJlw41PI/u6BXE+yb0uK8FVzLrPaZclkghZ\nipnEb85PkguXi7ptZ+4hrTYBR0yCMvDG+TWVKy8RbM+7E0LBNjui4MiebhXuJ0A=\n=2dcE\n-----END PGP SIGNATURE-----\n", "payload": "tree 3e677484cf5c466b6dda2b4174cf05386ab52c47\nparent 12775ce16a4449c0f04cbce14efc56ac8d9ed39a\nparent 5b7bd2fed899b7966a09a6d5552a2e1985bc7526\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1666208321 +0200\ncommitter GitHub <noreply@github.com> 1666208321 +0200\n\nRollup merge of #103246 - ferrocene:pa-rust-analyzer-hosts, r=Mark-Simulacrum\n\nMark `rust-analyzer` as a host-only tool\n\nAll tools meant to be shipped with host toolchains only should be marked as `ONLY_HOSTS = true`, but rust-analyzer was marked as `ONLY_HOSTS = false` incorrectly. This meant that bootstrap attempted to build rust-analyzer for cross-compilation-only targets, causing errors because libstd is not present on some of them.\n\nIt will still be possible to cross-compile rust-analyzer by passing a different `--host` flag to `./x`, like you can cross-compile other tools.\n\nThe problem can be reproduced by running:\n\n```\n./x build src/tools/rust-analyzer --target x86_64-unknown-linux-gnu,aarch64-unknown-none\n```\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e85def73b54a3b4614980d5d3e74a2cfa94b8a57", "html_url": "https://github.com/rust-lang/rust/commit/e85def73b54a3b4614980d5d3e74a2cfa94b8a57", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e85def73b54a3b4614980d5d3e74a2cfa94b8a57/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "12775ce16a4449c0f04cbce14efc56ac8d9ed39a", "url": "https://api.github.com/repos/rust-lang/rust/commits/12775ce16a4449c0f04cbce14efc56ac8d9ed39a", "html_url": "https://github.com/rust-lang/rust/commit/12775ce16a4449c0f04cbce14efc56ac8d9ed39a"}, {"sha": "5b7bd2fed899b7966a09a6d5552a2e1985bc7526", "url": "https://api.github.com/repos/rust-lang/rust/commits/5b7bd2fed899b7966a09a6d5552a2e1985bc7526", "html_url": "https://github.com/rust-lang/rust/commit/5b7bd2fed899b7966a09a6d5552a2e1985bc7526"}], "stats": {"total": 4, "additions": 2, "deletions": 2}, "files": [{"sha": "eec74b2675a1e3dfb10eb2fbe2d287821fdd4286", "filename": "src/bootstrap/tool.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/e85def73b54a3b4614980d5d3e74a2cfa94b8a57/src%2Fbootstrap%2Ftool.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e85def73b54a3b4614980d5d3e74a2cfa94b8a57/src%2Fbootstrap%2Ftool.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftool.rs?ref=e85def73b54a3b4614980d5d3e74a2cfa94b8a57", "patch": "@@ -698,7 +698,7 @@ pub struct RustAnalyzer {\n impl Step for RustAnalyzer {\n     type Output = Option<PathBuf>;\n     const DEFAULT: bool = true;\n-    const ONLY_HOSTS: bool = false;\n+    const ONLY_HOSTS: bool = true;\n \n     fn should_run(run: ShouldRun<'_>) -> ShouldRun<'_> {\n         let builder = run.builder;\n@@ -742,7 +742,7 @@ pub struct RustAnalyzerProcMacroSrv {\n impl Step for RustAnalyzerProcMacroSrv {\n     type Output = Option<PathBuf>;\n     const DEFAULT: bool = true;\n-    const ONLY_HOSTS: bool = false;\n+    const ONLY_HOSTS: bool = true;\n \n     fn should_run(run: ShouldRun<'_>) -> ShouldRun<'_> {\n         let builder = run.builder;"}]}