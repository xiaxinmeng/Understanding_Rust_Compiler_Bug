{"sha": "a5216cf67d93de97091b41ecba85de2e08f39863", "node_id": "C_kwDOAAsO6NoAKGE1MjE2Y2Y2N2Q5M2RlOTcwOTFiNDFlY2JhODVkZTJlMDhmMzk4NjM", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-03-08T16:40:24Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-03-08T22:12:11Z"}, "message": "Unify inherent impl blocks by wrapping them into a div", "tree": {"sha": "84296c411ecd4d53166f87cbca254f4a002b7b8e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/84296c411ecd4d53166f87cbca254f4a002b7b8e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a5216cf67d93de97091b41ecba85de2e08f39863", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a5216cf67d93de97091b41ecba85de2e08f39863", "html_url": "https://github.com/rust-lang/rust/commit/a5216cf67d93de97091b41ecba85de2e08f39863", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a5216cf67d93de97091b41ecba85de2e08f39863/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a64180f67f148c0d13f30a8137dc4b8cc2b28757", "url": "https://api.github.com/repos/rust-lang/rust/commits/a64180f67f148c0d13f30a8137dc4b8cc2b28757", "html_url": "https://github.com/rust-lang/rust/commit/a64180f67f148c0d13f30a8137dc4b8cc2b28757"}], "stats": {"total": 21, "additions": 13, "deletions": 8}, "files": [{"sha": "f2856690d257a91eeecdf30c6e07e1c35e830614", "filename": "src/librustdoc/html/markdown.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a5216cf67d93de97091b41ecba85de2e08f39863/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a5216cf67d93de97091b41ecba85de2e08f39863/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs?ref=a5216cf67d93de97091b41ecba85de2e08f39863", "patch": "@@ -1460,6 +1460,7 @@ fn init_id_map() -> FxHashMap<String, usize> {\n     map.insert(\"provided-methods\".to_owned(), 1);\n     map.insert(\"implementors\".to_owned(), 1);\n     map.insert(\"synthetic-implementors\".to_owned(), 1);\n+    map.insert(\"implementations-list\".to_owned(), 1);\n     map.insert(\"trait-implementations-list\".to_owned(), 1);\n     map.insert(\"synthetic-implementations-list\".to_owned(), 1);\n     map.insert(\"blanket-implementations-list\".to_owned(), 1);"}, {"sha": "26f29a3524b00cf03763b36d98f60623374251f8", "filename": "src/librustdoc/html/render/mod.rs", "status": "modified", "additions": 10, "deletions": 6, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/a5216cf67d93de97091b41ecba85de2e08f39863/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a5216cf67d93de97091b41ecba85de2e08f39863/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs?ref=a5216cf67d93de97091b41ecba85de2e08f39863", "patch": "@@ -1065,14 +1065,15 @@ fn render_assoc_items_inner(\n     let (non_trait, traits): (Vec<_>, _) = v.iter().partition(|i| i.inner_impl().trait_.is_none());\n     if !non_trait.is_empty() {\n         let mut tmp_buf = Buffer::empty_from(w);\n-        let render_mode = match what {\n+        let (render_mode, id) = match what {\n             AssocItemRender::All => {\n                 tmp_buf.write_str(\n                     \"<h2 id=\\\"implementations\\\" class=\\\"small-section-header\\\">\\\n-                         Implementations<a href=\\\"#implementations\\\" class=\\\"anchor\\\"></a>\\\n-                    </h2>\",\n+                         Implementations\\\n+                         <a href=\\\"#implementations\\\" class=\\\"anchor\\\"></a>\\\n+                     </h2>\",\n                 );\n-                RenderMode::Normal\n+                (RenderMode::Normal, \"implementations-list\".to_owned())\n             }\n             AssocItemRender::DerefFor { trait_, type_, deref_mut_ } => {\n                 let id =\n@@ -1090,7 +1091,7 @@ fn render_assoc_items_inner(\n                     trait_ = trait_.print(cx),\n                     type_ = type_.print(cx),\n                 );\n-                RenderMode::ForDeref { mut_: deref_mut_ }\n+                (RenderMode::ForDeref { mut_: deref_mut_ }, cx.derive_id(id))\n             }\n         };\n         let mut impls_buf = Buffer::empty_from(w);\n@@ -1115,7 +1116,9 @@ fn render_assoc_items_inner(\n         }\n         if !impls_buf.is_empty() {\n             w.push_buffer(tmp_buf);\n+            write!(w, \"<div id=\\\"{}\\\">\", id);\n             w.push_buffer(impls_buf);\n+            w.write_str(\"</div>\");\n         }\n     }\n \n@@ -1146,7 +1149,8 @@ fn render_assoc_items_inner(\n             write!(\n                 w,\n                 \"<h2 id=\\\"trait-implementations\\\" class=\\\"small-section-header\\\">\\\n-                     Trait Implementations<a href=\\\"#trait-implementations\\\" class=\\\"anchor\\\"></a>\\\n+                     Trait Implementations\\\n+                     <a href=\\\"#trait-implementations\\\" class=\\\"anchor\\\"></a>\\\n                  </h2>\\\n                  <div id=\\\"trait-implementations-list\\\">{}</div>\",\n                 impls"}, {"sha": "90592335d5ddfa83cfa03112873620992a04047f", "filename": "src/librustdoc/html/static/js/main.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a5216cf67d93de97091b41ecba85de2e08f39863/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/a5216cf67d93de97091b41ecba85de2e08f39863/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js?ref=a5216cf67d93de97091b41ecba85de2e08f39863", "patch": "@@ -741,7 +741,7 @@ function hideThemeButtonState() {\n         } else {\n             addClass(innerToggle, \"will-expand\");\n             onEachLazy(document.getElementsByClassName(\"rustdoc-toggle\"), function(e) {\n-                if (e.parentNode.id !== MAIN_ID ||\n+                if (e.parentNode.id !== \"implementations-list\" ||\n                     (!hasClass(e, \"implementors-toggle\") &&\n                      !hasClass(e, \"type-contents-toggle\")))\n                 {"}, {"sha": "3f9a476d96e23b988b4d82d75a3586b7811329ca", "filename": "src/test/rustdoc/duplicate_impls/issue-33054.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a5216cf67d93de97091b41ecba85de2e08f39863/src%2Ftest%2Frustdoc%2Fduplicate_impls%2Fissue-33054.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a5216cf67d93de97091b41ecba85de2e08f39863/src%2Ftest%2Frustdoc%2Fduplicate_impls%2Fissue-33054.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fduplicate_impls%2Fissue-33054.rs?ref=a5216cf67d93de97091b41ecba85de2e08f39863", "patch": "@@ -2,7 +2,7 @@\n // @has - '//h3[@class=\"code-header in-band\"]' 'impl Foo'\n // @has - '//h3[@class=\"code-header in-band\"]' 'impl Bar for Foo'\n // @count - '//*[@id=\"trait-implementations-list\"]//*[@class=\"impl has-srclink\"]' 1\n-// @count - '//*[@id=\"main-content\"]/details/summary/*[@class=\"impl has-srclink\"]' 1\n+// @count - '//*[@id=\"main-content\"]/div[@id=\"implementations-list\"]/details/summary/*[@class=\"impl has-srclink\"]' 1\n // @has issue_33054/impls/bar/trait.Bar.html\n // @has - '//h3[@class=\"code-header in-band\"]' 'impl Bar for Foo'\n // @count - '//*[@class=\"struct\"]' 1"}]}