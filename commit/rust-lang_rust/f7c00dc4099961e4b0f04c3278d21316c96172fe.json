{"sha": "f7c00dc4099961e4b0f04c3278d21316c96172fe", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY3YzAwZGM0MDk5OTYxZTRiMGYwNGMzMjc4ZDIxMzE2Yzk2MTcyZmU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-09-05T12:52:34Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-09-05T12:52:34Z"}, "message": "Auto merge of #88604 - camelid:rustdoc-lifetime-bounds, r=GuillaumeGomez\n\nrustdoc: Clean up handling of lifetime bounds\n\nPreviously, rustdoc recorded lifetime bounds by rendering them into the\nname of the lifetime parameter. Now, it leaves the name as the actual\nname and instead records lifetime bounds in an `outlives` list, similar\nto how type parameter bounds are recorded.\n\nAlso, higher-ranked lifetimes cannot currently have bounds, so I simplified\nthe code to reflect that.\n\nr? `@GuillaumeGomez`", "tree": {"sha": "bc27b7c05d0b5f452e21f1f40ecd6dcf17dc8b8f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bc27b7c05d0b5f452e21f1f40ecd6dcf17dc8b8f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f7c00dc4099961e4b0f04c3278d21316c96172fe", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f7c00dc4099961e4b0f04c3278d21316c96172fe", "html_url": "https://github.com/rust-lang/rust/commit/f7c00dc4099961e4b0f04c3278d21316c96172fe", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f7c00dc4099961e4b0f04c3278d21316c96172fe/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7e1e3eb5e19c7d1a4eabe4da22bf2aa085772766", "url": "https://api.github.com/repos/rust-lang/rust/commits/7e1e3eb5e19c7d1a4eabe4da22bf2aa085772766", "html_url": "https://github.com/rust-lang/rust/commit/7e1e3eb5e19c7d1a4eabe4da22bf2aa085772766"}, {"sha": "3a3f99a79b00b5efcb1bf061404112a281084b97", "url": "https://api.github.com/repos/rust-lang/rust/commits/3a3f99a79b00b5efcb1bf061404112a281084b97", "html_url": "https://github.com/rust-lang/rust/commit/3a3f99a79b00b5efcb1bf061404112a281084b97"}], "stats": {"total": 160, "additions": 96, "deletions": 64}, "files": [{"sha": "11adb56490b32406e54f218cfe30b53aad27344f", "filename": "src/librustdoc/clean/auto_trait.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Flibrustdoc%2Fclean%2Fauto_trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Flibrustdoc%2Fclean%2Fauto_trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Fauto_trait.rs?ref=f7c00dc4099961e4b0f04c3278d21316c96172fe", "patch": "@@ -331,9 +331,10 @@ impl<'a, 'tcx> AutoTraitFinder<'a, 'tcx> {\n                 match br {\n                     // We only care about named late bound regions, as we need to add them\n                     // to the 'for<>' section\n-                    ty::BrNamed(_, name) => {\n-                        Some(GenericParamDef { name, kind: GenericParamDefKind::Lifetime })\n-                    }\n+                    ty::BrNamed(_, name) => Some(GenericParamDef {\n+                        name,\n+                        kind: GenericParamDefKind::Lifetime { outlives: vec![] },\n+                    }),\n                     _ => None,\n                 }\n             })\n@@ -659,7 +660,7 @@ impl<'a, 'tcx> AutoTraitFinder<'a, 'tcx> {\n                         bounds.insert(0, GenericBound::maybe_sized(self.cx));\n                     }\n                 }\n-                GenericParamDefKind::Lifetime => {}\n+                GenericParamDefKind::Lifetime { .. } => {}\n                 GenericParamDefKind::Const { ref mut default, .. } => {\n                     // We never want something like `impl<const N: usize = 10>`\n                     default.take();"}, {"sha": "71348b3eb65ff022d53f4d6b9c82d2f3da9f53ef", "filename": "src/librustdoc/clean/mod.rs", "status": "modified", "additions": 42, "deletions": 49, "changes": 91, "blob_url": "https://github.com/rust-lang/rust/blob/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Flibrustdoc%2Fclean%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Flibrustdoc%2Fclean%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Fmod.rs?ref=f7c00dc4099961e4b0f04c3278d21316c96172fe", "patch": "@@ -30,6 +30,7 @@ use rustc_target::spec::abi::Abi;\n use rustc_typeck::check::intrinsic::intrinsic_operation_unsafety;\n use rustc_typeck::hir_ty_to_ty;\n \n+use std::assert_matches::assert_matches;\n use std::collections::hash_map::Entry;\n use std::default::Default;\n use std::hash::Hash;\n@@ -199,9 +200,10 @@ impl Clean<GenericBound> for (ty::PolyTraitRef<'_>, &[TypeBinding]) {\n             .collect_referenced_late_bound_regions(&poly_trait_ref)\n             .into_iter()\n             .filter_map(|br| match br {\n-                ty::BrNamed(_, name) => {\n-                    Some(GenericParamDef { name, kind: GenericParamDefKind::Lifetime })\n-                }\n+                ty::BrNamed(_, name) => Some(GenericParamDef {\n+                    name,\n+                    kind: GenericParamDefKind::Lifetime { outlives: vec![] },\n+                }),\n                 _ => None,\n             })\n             .collect();\n@@ -241,30 +243,6 @@ impl Clean<Lifetime> for hir::Lifetime {\n     }\n }\n \n-impl Clean<Lifetime> for hir::GenericParam<'_> {\n-    fn clean(&self, _: &mut DocContext<'_>) -> Lifetime {\n-        match self.kind {\n-            hir::GenericParamKind::Lifetime { .. } => {\n-                if !self.bounds.is_empty() {\n-                    let mut bounds = self.bounds.iter().map(|bound| match bound {\n-                        hir::GenericBound::Outlives(lt) => lt,\n-                        _ => panic!(),\n-                    });\n-                    let name = bounds.next().expect(\"no more bounds\").name.ident();\n-                    let mut s = format!(\"{}: {}\", self.name.ident(), name);\n-                    for bound in bounds {\n-                        s.push_str(&format!(\" + {}\", bound.name.ident()));\n-                    }\n-                    Lifetime(Symbol::intern(&s))\n-                } else {\n-                    Lifetime(self.name.ident().name)\n-                }\n-            }\n-            _ => panic!(),\n-        }\n-    }\n-}\n-\n impl Clean<Constant> for hir::ConstArg {\n     fn clean(&self, cx: &mut DocContext<'_>) -> Constant {\n         Constant {\n@@ -302,11 +280,30 @@ impl Clean<Option<Lifetime>> for ty::RegionKind {\n impl Clean<WherePredicate> for hir::WherePredicate<'_> {\n     fn clean(&self, cx: &mut DocContext<'_>) -> WherePredicate {\n         match *self {\n-            hir::WherePredicate::BoundPredicate(ref wbp) => WherePredicate::BoundPredicate {\n-                ty: wbp.bounded_ty.clean(cx),\n-                bounds: wbp.bounds.clean(cx),\n-                bound_params: wbp.bound_generic_params.into_iter().map(|x| x.clean(cx)).collect(),\n-            },\n+            hir::WherePredicate::BoundPredicate(ref wbp) => {\n+                let bound_params = wbp\n+                    .bound_generic_params\n+                    .into_iter()\n+                    .map(|param| {\n+                        // Higher-ranked params must be lifetimes.\n+                        // Higher-ranked lifetimes can't have bounds.\n+                        assert_matches!(\n+                            param,\n+                            hir::GenericParam {\n+                                kind: hir::GenericParamKind::Lifetime { .. },\n+                                bounds: [],\n+                                ..\n+                            }\n+                        );\n+                        Lifetime(param.name.ident().name)\n+                    })\n+                    .collect();\n+                WherePredicate::BoundPredicate {\n+                    ty: wbp.bounded_ty.clean(cx),\n+                    bounds: wbp.bounds.clean(cx),\n+                    bound_params,\n+                }\n+            }\n \n             hir::WherePredicate::RegionPredicate(ref wrp) => WherePredicate::RegionPredicate {\n                 lifetime: wrp.lifetime.clean(cx),\n@@ -412,7 +409,9 @@ impl<'tcx> Clean<Type> for ty::ProjectionTy<'tcx> {\n impl Clean<GenericParamDef> for ty::GenericParamDef {\n     fn clean(&self, cx: &mut DocContext<'_>) -> GenericParamDef {\n         let (name, kind) = match self.kind {\n-            ty::GenericParamDefKind::Lifetime => (self.name, GenericParamDefKind::Lifetime),\n+            ty::GenericParamDefKind::Lifetime => {\n+                (self.name, GenericParamDefKind::Lifetime { outlives: vec![] })\n+            }\n             ty::GenericParamDefKind::Type { has_default, synthetic, .. } => {\n                 let default = if has_default {\n                     let mut default = cx.tcx.type_of(self.def_id).clean(cx);\n@@ -462,21 +461,15 @@ impl Clean<GenericParamDef> for hir::GenericParam<'_> {\n     fn clean(&self, cx: &mut DocContext<'_>) -> GenericParamDef {\n         let (name, kind) = match self.kind {\n             hir::GenericParamKind::Lifetime { .. } => {\n-                let name = if !self.bounds.is_empty() {\n-                    let mut bounds = self.bounds.iter().map(|bound| match bound {\n-                        hir::GenericBound::Outlives(lt) => lt,\n+                let outlives = self\n+                    .bounds\n+                    .iter()\n+                    .map(|bound| match bound {\n+                        hir::GenericBound::Outlives(lt) => lt.clean(cx),\n                         _ => panic!(),\n-                    });\n-                    let name = bounds.next().expect(\"no more bounds\").name.ident();\n-                    let mut s = format!(\"{}: {}\", self.name.ident(), name);\n-                    for bound in bounds {\n-                        s.push_str(&format!(\" + {}\", bound.name.ident()));\n-                    }\n-                    Symbol::intern(&s)\n-                } else {\n-                    self.name.ident().name\n-                };\n-                (name, GenericParamDefKind::Lifetime)\n+                    })\n+                    .collect();\n+                (self.name.ident().name, GenericParamDefKind::Lifetime { outlives })\n             }\n             hir::GenericParamKind::Type { ref default, synthetic } => (\n                 self.name.ident().name,\n@@ -536,7 +529,7 @@ impl Clean<Generics> for hir::Generics<'_> {\n             .map(|param| {\n                 let param: GenericParamDef = param.clean(cx);\n                 match param.kind {\n-                    GenericParamDefKind::Lifetime => unreachable!(),\n+                    GenericParamDefKind::Lifetime { .. } => unreachable!(),\n                     GenericParamDefKind::Type { did, ref bounds, .. } => {\n                         cx.impl_trait_bounds.insert(did.into(), bounds.clone());\n                     }\n@@ -569,7 +562,7 @@ impl Clean<Generics> for hir::Generics<'_> {\n                     {\n                         for param in &mut generics.params {\n                             match param.kind {\n-                                GenericParamDefKind::Lifetime => {}\n+                                GenericParamDefKind::Lifetime { .. } => {}\n                                 GenericParamDefKind::Type { bounds: ref mut ty_bounds, .. } => {\n                                     if &param.name == name {\n                                         mem::swap(bounds, ty_bounds);"}, {"sha": "5eff56a2200e10d396cfc9eba35c29b37b486859", "filename": "src/librustdoc/clean/types.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Flibrustdoc%2Fclean%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Flibrustdoc%2Fclean%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Ftypes.rs?ref=f7c00dc4099961e4b0f04c3278d21316c96172fe", "patch": "@@ -1231,7 +1231,9 @@ impl WherePredicate {\n \n #[derive(Clone, PartialEq, Eq, Debug, Hash)]\n crate enum GenericParamDefKind {\n-    Lifetime,\n+    Lifetime {\n+        outlives: Vec<Lifetime>,\n+    },\n     Type {\n         did: DefId,\n         bounds: Vec<GenericBound>,\n@@ -1257,7 +1259,7 @@ impl GenericParamDefKind {\n         match self {\n             GenericParamDefKind::Type { default, .. } => default.clone(),\n             GenericParamDefKind::Const { ty, .. } => Some(ty.clone()),\n-            GenericParamDefKind::Lifetime => None,\n+            GenericParamDefKind::Lifetime { .. } => None,\n         }\n     }\n }\n@@ -1271,7 +1273,7 @@ crate struct GenericParamDef {\n impl GenericParamDef {\n     crate fn is_synthetic_type_param(&self) -> bool {\n         match self.kind {\n-            GenericParamDefKind::Lifetime | GenericParamDefKind::Const { .. } => false,\n+            GenericParamDefKind::Lifetime { .. } | GenericParamDefKind::Const { .. } => false,\n             GenericParamDefKind::Type { ref synthetic, .. } => synthetic.is_some(),\n         }\n     }"}, {"sha": "ea0458034899c54b2db6ff4368c8b7ba506a1c56", "filename": "src/librustdoc/html/format.rs", "status": "modified", "additions": 18, "deletions": 4, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Flibrustdoc%2Fhtml%2Fformat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Flibrustdoc%2Fhtml%2Fformat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fformat.rs?ref=f7c00dc4099961e4b0f04c3278d21316c96172fe", "patch": "@@ -155,9 +155,23 @@ impl clean::GenericParamDef {\n         &'a self,\n         cx: &'a Context<'tcx>,\n     ) -> impl fmt::Display + 'a + Captures<'tcx> {\n-        display_fn(move |f| match self.kind {\n-            clean::GenericParamDefKind::Lifetime => write!(f, \"{}\", self.name),\n-            clean::GenericParamDefKind::Type { ref bounds, ref default, .. } => {\n+        display_fn(move |f| match &self.kind {\n+            clean::GenericParamDefKind::Lifetime { outlives } => {\n+                write!(f, \"{}\", self.name)?;\n+\n+                if !outlives.is_empty() {\n+                    f.write_str(\": \")?;\n+                    for (i, lt) in outlives.iter().enumerate() {\n+                        if i != 0 {\n+                            f.write_str(\" + \")?;\n+                        }\n+                        write!(f, \"{}\", lt.print())?;\n+                    }\n+                }\n+\n+                Ok(())\n+            }\n+            clean::GenericParamDefKind::Type { bounds, default, .. } => {\n                 f.write_str(&*self.name.as_str())?;\n \n                 if !bounds.is_empty() {\n@@ -178,7 +192,7 @@ impl clean::GenericParamDef {\n \n                 Ok(())\n             }\n-            clean::GenericParamDefKind::Const { ref ty, ref default, .. } => {\n+            clean::GenericParamDefKind::Const { ty, default, .. } => {\n                 if f.alternate() {\n                     write!(f, \"const {}: {:#}\", self.name, ty.print(cx))?;\n                 } else {"}, {"sha": "e6bbd237cda7d72f2f1320ae442c05cc6936f320", "filename": "src/librustdoc/json/conversions.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Flibrustdoc%2Fjson%2Fconversions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Flibrustdoc%2Fjson%2Fconversions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fjson%2Fconversions.rs?ref=f7c00dc4099961e4b0f04c3278d21316c96172fe", "patch": "@@ -326,7 +326,9 @@ impl FromWithTcx<clean::GenericParamDefKind> for GenericParamDefKind {\n     fn from_tcx(kind: clean::GenericParamDefKind, tcx: TyCtxt<'_>) -> Self {\n         use clean::GenericParamDefKind::*;\n         match kind {\n-            Lifetime => GenericParamDefKind::Lifetime,\n+            Lifetime { outlives } => GenericParamDefKind::Lifetime {\n+                outlives: outlives.into_iter().map(|lt| lt.0.to_string()).collect(),\n+            },\n             Type { did: _, bounds, default, synthetic: _ } => GenericParamDefKind::Type {\n                 bounds: bounds.into_iter().map(|x| x.into_tcx(tcx)).collect(),\n                 default: default.map(|x| x.into_tcx(tcx)),"}, {"sha": "5089cc30a1e398cb907aa45f6e585b0eed81572e", "filename": "src/librustdoc/json/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Flibrustdoc%2Fjson%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Flibrustdoc%2Fjson%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fjson%2Fmod.rs?ref=f7c00dc4099961e4b0f04c3278d21316c96172fe", "patch": "@@ -234,7 +234,7 @@ impl<'tcx> FormatRenderer<'tcx> for JsonRenderer<'tcx> {\n                     )\n                 })\n                 .collect(),\n-            format_version: 6,\n+            format_version: 7,\n         };\n         let mut p = self.out_path.clone();\n         p.push(output.index.get(&output.root).unwrap().name.clone().unwrap());"}, {"sha": "2dbe4c42b888ebcd1251167c7fb97f75d036c0ce", "filename": "src/librustdoc/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Flibrustdoc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Flibrustdoc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Flib.rs?ref=f7c00dc4099961e4b0f04c3278d21316c96172fe", "patch": "@@ -4,6 +4,7 @@\n )]\n #![feature(rustc_private)]\n #![feature(array_methods)]\n+#![feature(assert_matches)]\n #![feature(box_patterns)]\n #![feature(control_flow_enum)]\n #![feature(in_band_lifetimes)]"}, {"sha": "37cdc94441df7974d7cf1f0a68755835772c5629", "filename": "src/rustdoc-json-types/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Frustdoc-json-types%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Frustdoc-json-types%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc-json-types%2Flib.rs?ref=f7c00dc4099961e4b0f04c3278d21316c96172fe", "patch": "@@ -323,7 +323,7 @@ pub struct GenericParamDef {\n #[derive(Clone, Debug, Serialize, Deserialize, PartialEq)]\n #[serde(rename_all = \"snake_case\")]\n pub enum GenericParamDefKind {\n-    Lifetime,\n+    Lifetime { outlives: Vec<String> },\n     Type { bounds: Vec<GenericBound>, default: Option<Type> },\n     Const { ty: Type, default: Option<String> },\n }"}, {"sha": "9e64317ec203f9adc259366fac0427a8d99b2630", "filename": "src/test/rustdoc-json/structs/with_primitives.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Ftest%2Frustdoc-json%2Fstructs%2Fwith_primitives.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Ftest%2Frustdoc-json%2Fstructs%2Fwith_primitives.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-json%2Fstructs%2Fwith_primitives.rs?ref=f7c00dc4099961e4b0f04c3278d21316c96172fe", "patch": "@@ -1,7 +1,7 @@\n // @has with_primitives.json \"$.index[*][?(@.name=='WithPrimitives')].visibility\" \\\"public\\\"\n // @has - \"$.index[*][?(@.name=='WithPrimitives')].kind\" \\\"struct\\\"\n // @has - \"$.index[*][?(@.name=='WithPrimitives')].inner.generics.params[0].name\" \\\"\\'a\\\"\n-// @has - \"$.index[*][?(@.name=='WithPrimitives')].inner.generics.params[0].kind\" \\\"lifetime\\\"\n+// @has - \"$.index[*][?(@.name=='WithPrimitives')].inner.generics.params[0].kind.lifetime.outlives\" []\n // @has - \"$.index[*][?(@.name=='WithPrimitives')].inner.struct_type\" \\\"plain\\\"\n // @has - \"$.index[*][?(@.name=='WithPrimitives')].inner.fields_stripped\" true\n pub struct WithPrimitives<'a> {"}, {"sha": "b2e000b9757409dd2d892a86f9bc3ff37d0b3d15", "filename": "src/test/rustdoc-ui/bounded-hr-lifetime.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Ftest%2Frustdoc-ui%2Fbounded-hr-lifetime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Ftest%2Frustdoc-ui%2Fbounded-hr-lifetime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fbounded-hr-lifetime.rs?ref=f7c00dc4099961e4b0f04c3278d21316c96172fe", "patch": "@@ -0,0 +1,9 @@\n+// This test ensures that rustdoc doesn't panic on higher-ranked lifetimes\n+// with bounds, because an error should have already been emitted by rustc.\n+\n+pub fn hrlt<'b, 'c>()\n+where\n+    for<'a: 'b + 'c> &'a (): std::fmt::Debug,\n+    //~^ ERROR lifetime bounds cannot be used in this context\n+{\n+}"}, {"sha": "d8fcd6cb4b13f5fcc97a57a5c24cbdd1d0202e5f", "filename": "src/test/rustdoc-ui/bounded-hr-lifetime.stderr", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Ftest%2Frustdoc-ui%2Fbounded-hr-lifetime.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/f7c00dc4099961e4b0f04c3278d21316c96172fe/src%2Ftest%2Frustdoc-ui%2Fbounded-hr-lifetime.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fbounded-hr-lifetime.stderr?ref=f7c00dc4099961e4b0f04c3278d21316c96172fe", "patch": "@@ -0,0 +1,10 @@\n+error: lifetime bounds cannot be used in this context\n+  --> $DIR/bounded-hr-lifetime.rs:6:13\n+   |\n+LL |     for<'a: 'b + 'c> &'a (): std::fmt::Debug,\n+   |             ^^   ^^\n+\n+error: Compilation failed, aborting rustdoc\n+\n+error: aborting due to 2 previous errors\n+"}]}