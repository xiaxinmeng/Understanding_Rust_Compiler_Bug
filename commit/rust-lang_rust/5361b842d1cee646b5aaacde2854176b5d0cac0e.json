{"sha": "5361b842d1cee646b5aaacde2854176b5d0cac0e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUzNjFiODQyZDFjZWU2NDZiNWFhYWNkZTI4NTQxNzZiNWQwY2FjMGU=", "commit": {"author": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2019-04-15T11:04:32Z"}, "committer": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2019-04-15T11:21:52Z"}, "message": "Remove clippy::default_hash_types internal lint", "tree": {"sha": "8a0b6bc63cd8d8d6d0053079dc065f8895b5894e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8a0b6bc63cd8d8d6d0053079dc065f8895b5894e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5361b842d1cee646b5aaacde2854176b5d0cac0e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEdgbJzPSa+gJi9jP1Acg2tkD/37EFAly0aVAACgkQAcg2tkD/\n37GC8A//XMRChHN+6doS92VnsctoFNN4E0Q0zO/TGJpxnlLCmoTshO81hQ7d5z8K\njwatzDUcz7ezl4ECSvHGIRWBWbeDXyRV6vyInURFAiux6q392PUsBh6I5I5gnBq/\nh2BW3UEgHxIgNYdqq/2BiX7clZeBa2YPe4zZWnuWsry1OfKqnm0gS+VY8GBjOHWm\nhEhf/MfIFXS/WI68e0Yhv9u2btO7xu1mfP7LTAgULyBhS0ekIq626dMh5pu4v8Z7\nqkuL4DlBj1gI1glrSkhxMPUq+Oc+/h1Dq3BMyRfhxm5fFH1JNdNjg9JUSuSDXiGx\nVejSkswaU2wfgynlKZ2QCNgLYnSDGpMiF7YqMFfK50z+B7zPeFOyUxOcWx+xMsht\nJxa31INQeMuFKcbKhbT7QIKoMBkmX5EM/yn4/br6kPFYCnCdiUtcFeyzSbK8g5MG\nPKu+E4YDrGWFiegI8BEXr2XHUnTtqUql/xdl3IdtLmBbOeptPVnzPb99rdw7SEjK\nO6l7zLZmcWqQv8hCWl3tBpe1aVJgWfeQczL0RedVgnncgaRW/LjtZ+fV6piOFpGw\nmD6e0S1Slhgd2k+8yCH6sr6zT+AA9LXL+qqev1EgEV5XmrdOTH/wEZRC9grmw6mV\nAUZlU+doGPo5bpUl0i0z5h55vu3Jvc8b2epdVVXUF6e/OWqyd60=\n=6VaI\n-----END PGP SIGNATURE-----", "payload": "tree 8a0b6bc63cd8d8d6d0053079dc065f8895b5894e\nparent 0973f68fb851a1809f018c0f49a87237c46a6ef2\nauthor flip1995 <hello@philkrones.com> 1555326272 +0200\ncommitter flip1995 <hello@philkrones.com> 1555327312 +0200\n\nRemove clippy::default_hash_types internal lint\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5361b842d1cee646b5aaacde2854176b5d0cac0e", "html_url": "https://github.com/rust-lang/rust/commit/5361b842d1cee646b5aaacde2854176b5d0cac0e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5361b842d1cee646b5aaacde2854176b5d0cac0e/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0973f68fb851a1809f018c0f49a87237c46a6ef2", "url": "https://api.github.com/repos/rust-lang/rust/commits/0973f68fb851a1809f018c0f49a87237c46a6ef2", "html_url": "https://github.com/rust-lang/rust/commit/0973f68fb851a1809f018c0f49a87237c46a6ef2"}], "stats": {"total": 126, "additions": 3, "deletions": 123}, "files": [{"sha": "392388ffd8a112edf70f2b1efebcd36409ef6ea1", "filename": "clippy_dev/src/lib.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5361b842d1cee646b5aaacde2854176b5d0cac0e/clippy_dev%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5361b842d1cee646b5aaacde2854176b5d0cac0e/clippy_dev%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Flib.rs?ref=5361b842d1cee646b5aaacde2854176b5d0cac0e", "patch": "@@ -1,5 +1,3 @@\n-#![allow(clippy::default_hash_types)]\n-\n use itertools::Itertools;\n use lazy_static::lazy_static;\n use regex::Regex;"}, {"sha": "c670833446f47810e84ded0b02393f29b8d0ba1a", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5361b842d1cee646b5aaacde2854176b5d0cac0e/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5361b842d1cee646b5aaacde2854176b5d0cac0e/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=5361b842d1cee646b5aaacde2854176b5d0cac0e", "patch": "@@ -423,7 +423,6 @@ pub fn register_plugins(reg: &mut rustc_plugin::Registry<'_>, conf: &Conf) {\n     reg.register_late_lint_pass(box serde_api::Serde);\n     reg.register_early_lint_pass(box utils::internal_lints::Clippy);\n     reg.register_late_lint_pass(box utils::internal_lints::CompilerLintFunctions::new());\n-    reg.register_early_lint_pass(box utils::internal_lints::DefaultHashTypes::default());\n     reg.register_late_lint_pass(box utils::internal_lints::LintWithoutLintPass::default());\n     reg.register_late_lint_pass(box utils::inspector::Pass);\n     reg.register_late_lint_pass(box utils::author::Pass);\n@@ -647,7 +646,6 @@ pub fn register_plugins(reg: &mut rustc_plugin::Registry<'_>, conf: &Conf) {\n     reg.register_lint_group(\"clippy::internal\", Some(\"clippy_internal\"), vec![\n         utils::internal_lints::CLIPPY_LINTS_INTERNAL,\n         utils::internal_lints::COMPILER_LINT_FUNCTIONS,\n-        utils::internal_lints::DEFAULT_HASH_TYPES,\n         utils::internal_lints::LINT_WITHOUT_LINT_PASS,\n     ]);\n "}, {"sha": "bf2d462bc1ea508e6a34067e3142391529b5f5f2", "filename": "clippy_lints/src/types.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5361b842d1cee646b5aaacde2854176b5d0cac0e/clippy_lints%2Fsrc%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5361b842d1cee646b5aaacde2854176b5d0cac0e/clippy_lints%2Fsrc%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Ftypes.rs?ref=5361b842d1cee646b5aaacde2854176b5d0cac0e", "patch": "@@ -1,4 +1,3 @@\n-#![allow(clippy::default_hash_types)]\n \n use std::borrow::Cow;\n use std::cmp::Ordering;"}, {"sha": "0ebb19376c5cd9c1e1e8bde47debe80d4b90debf", "filename": "clippy_lints/src/utils/internal_lints.rs", "status": "modified", "additions": 3, "deletions": 62, "changes": 65, "blob_url": "https://github.com/rust-lang/rust/blob/5361b842d1cee646b5aaacde2854176b5d0cac0e/clippy_lints%2Fsrc%2Futils%2Finternal_lints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5361b842d1cee646b5aaacde2854176b5d0cac0e/clippy_lints%2Fsrc%2Futils%2Finternal_lints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Finternal_lints.rs?ref=5361b842d1cee646b5aaacde2854176b5d0cac0e", "patch": "@@ -1,6 +1,4 @@\n-use crate::utils::{\n-    match_def_path, match_type, paths, span_help_and_lint, span_lint, span_lint_and_sugg, walk_ptrs_ty,\n-};\n+use crate::utils::{match_def_path, match_type, paths, span_help_and_lint, span_lint, walk_ptrs_ty};\n use if_chain::if_chain;\n use rustc::hir;\n use rustc::hir::def::Def;\n@@ -9,8 +7,7 @@ use rustc::hir::*;\n use rustc::lint::{EarlyContext, EarlyLintPass, LateContext, LateLintPass, LintArray, LintPass};\n use rustc::{declare_tool_lint, lint_array};\n use rustc_data_structures::fx::{FxHashMap, FxHashSet};\n-use rustc_errors::Applicability;\n-use syntax::ast::{Crate as AstCrate, Ident, ItemKind, Name};\n+use syntax::ast::{Crate as AstCrate, ItemKind, Name};\n use syntax::source_map::Span;\n use syntax::symbol::LocalInternedString;\n \n@@ -56,17 +53,6 @@ declare_clippy_lint! {\n     \"declaring a lint without associating it in a LintPass\"\n }\n \n-declare_clippy_lint! {\n-    /// **What it does:** Checks for the presence of the default hash types \"HashMap\" or \"HashSet\"\n-    /// and recommends the FxHash* variants.\n-    ///\n-    /// **Why is this bad?** The FxHash variants have better performance\n-    /// and we don't need any collision prevention in clippy.\n-    pub DEFAULT_HASH_TYPES,\n-    internal,\n-    \"forbid HashMap and HashSet and suggest the FxHash* variants\"\n-}\n-\n declare_clippy_lint! {\n     /// **What it does:** Checks for calls to `cx.span_lint*` and suggests to use the `utils::*`\n     /// variant of the function.\n@@ -238,51 +224,6 @@ impl<'a, 'tcx: 'a> Visitor<'tcx> for LintCollector<'a, 'tcx> {\n     }\n }\n \n-pub struct DefaultHashTypes {\n-    map: FxHashMap<String, String>,\n-}\n-\n-impl DefaultHashTypes {\n-    pub fn default() -> Self {\n-        let mut map = FxHashMap::default();\n-        map.insert(\"HashMap\".to_string(), \"FxHashMap\".to_string());\n-        map.insert(\"HashSet\".to_string(), \"FxHashSet\".to_string());\n-        Self { map }\n-    }\n-}\n-\n-impl LintPass for DefaultHashTypes {\n-    fn get_lints(&self) -> LintArray {\n-        lint_array!(DEFAULT_HASH_TYPES)\n-    }\n-\n-    fn name(&self) -> &'static str {\n-        \"DefaultHashType\"\n-    }\n-}\n-\n-impl EarlyLintPass for DefaultHashTypes {\n-    fn check_ident(&mut self, cx: &EarlyContext<'_>, ident: Ident) {\n-        let ident_string = ident.to_string();\n-        if let Some(replace) = self.map.get(&ident_string) {\n-            let msg = format!(\n-                \"Prefer {} over {}, it has better performance \\\n-                 and we don't need any collision prevention in clippy\",\n-                replace, ident_string\n-            );\n-            span_lint_and_sugg(\n-                cx,\n-                DEFAULT_HASH_TYPES,\n-                ident.span,\n-                &msg,\n-                \"use\",\n-                replace.to_string(),\n-                Applicability::MaybeIncorrect, // FxHashMap, ... needs another import\n-            );\n-        }\n-    }\n-}\n-\n #[derive(Clone, Default)]\n pub struct CompilerLintFunctions {\n     map: FxHashMap<String, String>,\n@@ -325,7 +266,7 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for CompilerLintFunctions {\n                     COMPILER_LINT_FUNCTIONS,\n                     path.ident.span,\n                     \"usage of a compiler lint function\",\n-                    &format!(\"Please use the Clippy variant of this function: `{}`\", sugg),\n+                    &format!(\"please use the Clippy variant of this function: `{}`\", sugg),\n                 );\n             }\n         }"}, {"sha": "7d6cb4e1179030c241063054e94fa941ca1a0173", "filename": "tests/ui/fxhash.rs", "status": "removed", "additions": 0, "deletions": 16, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/0973f68fb851a1809f018c0f49a87237c46a6ef2/tests%2Fui%2Ffxhash.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0973f68fb851a1809f018c0f49a87237c46a6ef2/tests%2Fui%2Ffxhash.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ffxhash.rs?ref=0973f68fb851a1809f018c0f49a87237c46a6ef2", "patch": "@@ -1,16 +0,0 @@\n-#![warn(clippy::default_hash_types)]\n-#![feature(rustc_private)]\n-\n-extern crate rustc_data_structures;\n-\n-use rustc_data_structures::fx::{FxHashMap, FxHashSet};\n-use std::collections::{HashMap, HashSet};\n-\n-fn main() {\n-    let _map: HashMap<String, String> = HashMap::default();\n-    let _set: HashSet<String> = HashSet::default();\n-\n-    // test that the lint doesn't also match the Fx variants themselves \ud83d\ude02\n-    let _fx_map: FxHashMap<String, String> = FxHashMap::default();\n-    let _fx_set: FxHashSet<String> = FxHashSet::default();\n-}"}, {"sha": "a2dac67001859e3f6f6fd59adcce170d1f0e6fcc", "filename": "tests/ui/fxhash.stderr", "status": "removed", "additions": 0, "deletions": 40, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/0973f68fb851a1809f018c0f49a87237c46a6ef2/tests%2Fui%2Ffxhash.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0973f68fb851a1809f018c0f49a87237c46a6ef2/tests%2Fui%2Ffxhash.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ffxhash.stderr?ref=0973f68fb851a1809f018c0f49a87237c46a6ef2", "patch": "@@ -1,40 +0,0 @@\n-error: Prefer FxHashMap over HashMap, it has better performance and we don't need any collision prevention in clippy\n-  --> $DIR/fxhash.rs:7:24\n-   |\n-LL | use std::collections::{HashMap, HashSet};\n-   |                        ^^^^^^^ help: use: `FxHashMap`\n-   |\n-   = note: `-D clippy::default-hash-types` implied by `-D warnings`\n-\n-error: Prefer FxHashSet over HashSet, it has better performance and we don't need any collision prevention in clippy\n-  --> $DIR/fxhash.rs:7:33\n-   |\n-LL | use std::collections::{HashMap, HashSet};\n-   |                                 ^^^^^^^ help: use: `FxHashSet`\n-\n-error: Prefer FxHashMap over HashMap, it has better performance and we don't need any collision prevention in clippy\n-  --> $DIR/fxhash.rs:10:15\n-   |\n-LL |     let _map: HashMap<String, String> = HashMap::default();\n-   |               ^^^^^^^ help: use: `FxHashMap`\n-\n-error: Prefer FxHashMap over HashMap, it has better performance and we don't need any collision prevention in clippy\n-  --> $DIR/fxhash.rs:10:41\n-   |\n-LL |     let _map: HashMap<String, String> = HashMap::default();\n-   |                                         ^^^^^^^ help: use: `FxHashMap`\n-\n-error: Prefer FxHashSet over HashSet, it has better performance and we don't need any collision prevention in clippy\n-  --> $DIR/fxhash.rs:11:15\n-   |\n-LL |     let _set: HashSet<String> = HashSet::default();\n-   |               ^^^^^^^ help: use: `FxHashSet`\n-\n-error: Prefer FxHashSet over HashSet, it has better performance and we don't need any collision prevention in clippy\n-  --> $DIR/fxhash.rs:11:33\n-   |\n-LL |     let _set: HashSet<String> = HashSet::default();\n-   |                                 ^^^^^^^ help: use: `FxHashSet`\n-\n-error: aborting due to 6 previous errors\n-"}]}