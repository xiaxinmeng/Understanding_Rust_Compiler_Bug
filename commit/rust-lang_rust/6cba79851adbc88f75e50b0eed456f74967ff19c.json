{"sha": "6cba79851adbc88f75e50b0eed456f74967ff19c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZjYmE3OTg1MWFkYmM4OGY3NWU1MGIwZWVkNDU2Zjc0OTY3ZmYxOWM=", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2021-07-18T15:21:59Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2021-07-18T17:11:45Z"}, "message": "better support for running libcore and liballoc tests with Miri", "tree": {"sha": "b8001cb3861605ca4c7799bfd44f5b7a4ba4709b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b8001cb3861605ca4c7799bfd44f5b7a4ba4709b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6cba79851adbc88f75e50b0eed456f74967ff19c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6cba79851adbc88f75e50b0eed456f74967ff19c", "html_url": "https://github.com/rust-lang/rust/commit/6cba79851adbc88f75e50b0eed456f74967ff19c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6cba79851adbc88f75e50b0eed456f74967ff19c/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "18073052d8c3544ccb73effd289ed3acda0d66c0", "url": "https://api.github.com/repos/rust-lang/rust/commits/18073052d8c3544ccb73effd289ed3acda0d66c0", "html_url": "https://github.com/rust-lang/rust/commit/18073052d8c3544ccb73effd289ed3acda0d66c0"}], "stats": {"total": 8, "additions": 8, "deletions": 0}, "files": [{"sha": "fa1f361a5b6d1998e478024953a84e5803677dae", "filename": "library/alloc/src/lib.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/6cba79851adbc88f75e50b0eed456f74967ff19c/library%2Falloc%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6cba79851adbc88f75e50b0eed456f74967ff19c/library%2Falloc%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Flib.rs?ref=6cba79851adbc88f75e50b0eed456f74967ff19c", "patch": "@@ -56,6 +56,10 @@\n //! [`Rc`]: rc\n //! [`RefCell`]: core::cell\n \n+// To run liballoc tests without x.py without ending up with two copies of liballoc, Miri needs to be\n+// able to \"empty\" this crate. See <https://github.com/rust-lang/miri-test-libstd/issues/4>.\n+// rustc itself never sets the feature, so this line has no affect there.\n+#![cfg(any(not(feature = \"miri-test-libstd\"), test, doctest))]\n #![allow(unused_attributes)]\n #![stable(feature = \"alloc\", since = \"1.36.0\")]\n #![doc("}, {"sha": "23e022b7413780e00f606daccedb96f1a97c2b6c", "filename": "library/core/src/lib.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/6cba79851adbc88f75e50b0eed456f74967ff19c/library%2Fcore%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6cba79851adbc88f75e50b0eed456f74967ff19c/library%2Fcore%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Flib.rs?ref=6cba79851adbc88f75e50b0eed456f74967ff19c", "patch": "@@ -49,6 +49,10 @@\n //\n // This cfg won't affect doc tests.\n #![cfg(not(test))]\n+// To run libcore tests without x.py without ending up with two copies of libcore, Miri needs to be\n+// able to \"empty\" this crate. See <https://github.com/rust-lang/miri-test-libstd/issues/4>.\n+// rustc itself never sets the feature, so this line has no affect there.\n+#![cfg(any(not(feature = \"miri-test-libstd\"), test, doctest))]\n #![stable(feature = \"core\", since = \"1.6.0\")]\n #![doc(\n     html_playground_url = \"https://play.rust-lang.org/\","}]}