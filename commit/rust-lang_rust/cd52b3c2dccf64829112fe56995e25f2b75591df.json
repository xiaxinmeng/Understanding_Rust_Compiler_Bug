{"sha": "cd52b3c2dccf64829112fe56995e25f2b75591df", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNkNTJiM2MyZGNjZjY0ODI5MTEyZmU1Njk5NWUyNWYyYjc1NTkxZGY=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-11-05T12:07:51Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-11-05T14:26:02Z"}, "message": "Make `ui/span/borrowck-borrow-overloaded-auto-deref-mut.rs` robust w.r.t. NLL.", "tree": {"sha": "11eee238f8664ffa1bb24e7865865098d2b12483", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/11eee238f8664ffa1bb24e7865865098d2b12483"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cd52b3c2dccf64829112fe56995e25f2b75591df", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cd52b3c2dccf64829112fe56995e25f2b75591df", "html_url": "https://github.com/rust-lang/rust/commit/cd52b3c2dccf64829112fe56995e25f2b75591df", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cd52b3c2dccf64829112fe56995e25f2b75591df/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5f524ed5c4b0d5e0bf6a6ea52284704411712c82", "url": "https://api.github.com/repos/rust-lang/rust/commits/5f524ed5c4b0d5e0bf6a6ea52284704411712c82", "html_url": "https://github.com/rust-lang/rust/commit/5f524ed5c4b0d5e0bf6a6ea52284704411712c82"}], "stats": {"total": 33, "additions": 29, "deletions": 4}, "files": [{"sha": "389a1116c163ace63616dedc196c9467c8334fd9", "filename": "src/test/ui/span/borrowck-borrow-overloaded-auto-deref-mut.nll.stderr", "status": "modified", "additions": 23, "deletions": 2, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/cd52b3c2dccf64829112fe56995e25f2b75591df/src%2Ftest%2Fui%2Fspan%2Fborrowck-borrow-overloaded-auto-deref-mut.nll.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cd52b3c2dccf64829112fe56995e25f2b75591df/src%2Ftest%2Fui%2Fspan%2Fborrowck-borrow-overloaded-auto-deref-mut.nll.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2Fborrowck-borrow-overloaded-auto-deref-mut.nll.stderr?ref=cd52b3c2dccf64829112fe56995e25f2b75591df", "patch": "@@ -14,6 +14,16 @@ LL | fn deref_extend_mut_field1(x: &Own<Point>) -> &mut isize {\n LL |     &mut x.y //~ ERROR cannot borrow\n    |          ^ `x` is a `&` reference, so the data it refers to cannot be borrowed as mutable\n \n+error[E0499]: cannot borrow `*x` as mutable more than once at a time\n+  --> $DIR/borrowck-borrow-overloaded-auto-deref-mut.rs:88:19\n+   |\n+LL |     let _x = &mut x.x;\n+   |                   - first mutable borrow occurs here\n+LL |     let _y = &mut x.y; //~ ERROR cannot borrow\n+   |                   ^ second mutable borrow occurs here\n+LL |     use_mut(_x);\n+   |             -- first borrow later used here\n+\n error[E0596]: cannot borrow `x` as mutable, as it is not declared as mutable\n   --> $DIR/borrowck-borrow-overloaded-auto-deref-mut.rs:98:5\n    |\n@@ -30,6 +40,16 @@ LL | fn assign_field2<'a>(x: &'a Own<Point>) {\n LL |     x.y = 3; //~ ERROR cannot borrow\n    |     ^ `x` is a `&` reference, so the data it refers to cannot be borrowed as mutable\n \n+error[E0499]: cannot borrow `*x` as mutable more than once at a time\n+  --> $DIR/borrowck-borrow-overloaded-auto-deref-mut.rs:111:5\n+   |\n+LL |     let _p: &mut Point = &mut **x;\n+   |                                -- first mutable borrow occurs here\n+LL |     x.y = 3; //~ ERROR cannot borrow\n+   |     ^ second mutable borrow occurs here\n+LL |     use_mut(_p);\n+   |             -- first borrow later used here\n+\n error[E0596]: cannot borrow `x` as mutable, as it is not declared as mutable\n   --> $DIR/borrowck-borrow-overloaded-auto-deref-mut.rs:119:5\n    |\n@@ -62,6 +82,7 @@ LL | fn assign_method2<'a>(x: &'a Own<Point>) {\n LL |     *x.y_mut() = 3; //~ ERROR cannot borrow\n    |      ^ `x` is a `&` reference, so the data it refers to cannot be borrowed as mutable\n \n-error: aborting due to 8 previous errors\n+error: aborting due to 10 previous errors\n \n-For more information about this error, try `rustc --explain E0596`.\n+Some errors occurred: E0499, E0596.\n+For more information about an error, try `rustc --explain E0499`."}, {"sha": "48eb2e239f7cdc6a46ff85170949b339c8ed6128", "filename": "src/test/ui/span/borrowck-borrow-overloaded-auto-deref-mut.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cd52b3c2dccf64829112fe56995e25f2b75591df/src%2Ftest%2Fui%2Fspan%2Fborrowck-borrow-overloaded-auto-deref-mut.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cd52b3c2dccf64829112fe56995e25f2b75591df/src%2Ftest%2Fui%2Fspan%2Fborrowck-borrow-overloaded-auto-deref-mut.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2Fborrowck-borrow-overloaded-auto-deref-mut.rs?ref=cd52b3c2dccf64829112fe56995e25f2b75591df", "patch": "@@ -86,8 +86,8 @@ fn deref_extend_mut_field3(x: &mut Own<Point>) {\n \n     let _x = &mut x.x;\n     let _y = &mut x.y; //~ ERROR cannot borrow\n+    use_mut(_x);\n }\n-\n fn deref_extend_mut_field4<'a>(x: &'a mut Own<Point>) {\n     let p = &mut **x;\n     let _x = &mut p.x;\n@@ -109,8 +109,8 @@ fn assign_field3<'a>(x: &'a mut Own<Point>) {\n fn assign_field4<'a>(x: &'a mut Own<Point>) {\n     let _p: &mut Point = &mut **x;\n     x.y = 3; //~ ERROR cannot borrow\n+    use_mut(_p);\n }\n-\n fn deref_imm_method(x: Own<Point>) {\n     let __isize = x.get();\n }\n@@ -148,3 +148,5 @@ fn assign_method3<'a>(x: &'a mut Own<Point>) {\n }\n \n pub fn main() {}\n+\n+fn use_mut<T>(_: &mut T) {}"}, {"sha": "864357fee9f0cbbb59ac9bb328e3ee10c920dda4", "filename": "src/test/ui/span/borrowck-borrow-overloaded-auto-deref-mut.stderr", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cd52b3c2dccf64829112fe56995e25f2b75591df/src%2Ftest%2Fui%2Fspan%2Fborrowck-borrow-overloaded-auto-deref-mut.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cd52b3c2dccf64829112fe56995e25f2b75591df/src%2Ftest%2Fui%2Fspan%2Fborrowck-borrow-overloaded-auto-deref-mut.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2Fborrowck-borrow-overloaded-auto-deref-mut.stderr?ref=cd52b3c2dccf64829112fe56995e25f2b75591df", "patch": "@@ -21,6 +21,7 @@ LL |     let _x = &mut x.x;\n    |                   - first mutable borrow occurs here\n LL |     let _y = &mut x.y; //~ ERROR cannot borrow\n    |                   ^ second mutable borrow occurs here\n+LL |     use_mut(_x);\n LL | }\n    | - first borrow ends here\n \n@@ -47,6 +48,7 @@ LL |     let _p: &mut Point = &mut **x;\n    |                                -- first mutable borrow occurs here\n LL |     x.y = 3; //~ ERROR cannot borrow\n    |     ^ second mutable borrow occurs here\n+LL |     use_mut(_p);\n LL | }\n    | - first borrow ends here\n "}]}