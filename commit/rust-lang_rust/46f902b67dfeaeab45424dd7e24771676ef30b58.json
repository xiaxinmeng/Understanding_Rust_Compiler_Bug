{"sha": "46f902b67dfeaeab45424dd7e24771676ef30b58", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ2ZjkwMmI2N2RmZWFlYWI0NTQyNGRkN2UyNDc3MTY3NmVmMzBiNTg=", "commit": {"author": {"name": "Christian Poveda", "email": "christianpoveda@protonmail.com", "date": "2019-08-14T15:24:35Z"}, "committer": {"name": "Christian Poveda", "email": "christianpoveda@protonmail.com", "date": "2019-08-14T16:31:29Z"}, "message": "Rename export for shims::env::EnvVars", "tree": {"sha": "1e1b72c82afbb270d007f5f4fbfa7344996dd5df", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1e1b72c82afbb270d007f5f4fbfa7344996dd5df"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/46f902b67dfeaeab45424dd7e24771676ef30b58", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/46f902b67dfeaeab45424dd7e24771676ef30b58", "html_url": "https://github.com/rust-lang/rust/commit/46f902b67dfeaeab45424dd7e24771676ef30b58", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/46f902b67dfeaeab45424dd7e24771676ef30b58/comments", "author": {"login": "pvdrz", "id": 31802960, "node_id": "MDQ6VXNlcjMxODAyOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/31802960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pvdrz", "html_url": "https://github.com/pvdrz", "followers_url": "https://api.github.com/users/pvdrz/followers", "following_url": "https://api.github.com/users/pvdrz/following{/other_user}", "gists_url": "https://api.github.com/users/pvdrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/pvdrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pvdrz/subscriptions", "organizations_url": "https://api.github.com/users/pvdrz/orgs", "repos_url": "https://api.github.com/users/pvdrz/repos", "events_url": "https://api.github.com/users/pvdrz/events{/privacy}", "received_events_url": "https://api.github.com/users/pvdrz/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pvdrz", "id": 31802960, "node_id": "MDQ6VXNlcjMxODAyOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/31802960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pvdrz", "html_url": "https://github.com/pvdrz", "followers_url": "https://api.github.com/users/pvdrz/followers", "following_url": "https://api.github.com/users/pvdrz/following{/other_user}", "gists_url": "https://api.github.com/users/pvdrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/pvdrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pvdrz/subscriptions", "organizations_url": "https://api.github.com/users/pvdrz/orgs", "repos_url": "https://api.github.com/users/pvdrz/repos", "events_url": "https://api.github.com/users/pvdrz/events{/privacy}", "received_events_url": "https://api.github.com/users/pvdrz/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f451fe21bdae10709b98406544c61689e1691163", "url": "https://api.github.com/repos/rust-lang/rust/commits/f451fe21bdae10709b98406544c61689e1691163", "html_url": "https://github.com/rust-lang/rust/commit/f451fe21bdae10709b98406544c61689e1691163"}], "stats": {"total": 16, "additions": 8, "deletions": 8}, "files": [{"sha": "496bcf990adc1f77f1c0383bcde8148ccc221ecf", "filename": "src/eval.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/46f902b67dfeaeab45424dd7e24771676ef30b58/src%2Feval.rs", "raw_url": "https://github.com/rust-lang/rust/raw/46f902b67dfeaeab45424dd7e24771676ef30b58/src%2Feval.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Feval.rs?ref=46f902b67dfeaeab45424dd7e24771676ef30b58", "patch": "@@ -12,7 +12,7 @@ use crate::{\n     InterpResult, InterpError, InterpCx, StackPopCleanup, struct_error,\n     Scalar, Tag, Pointer, FnVal,\n     MemoryExtra, MiriMemoryKind, Evaluator, TlsEvalContextExt, HelpersEvalContextExt,\n-    ShimsEnvVars,\n+    EnvVars,\n };\n \n /// Configuration needed to spawn a Miri instance.\n@@ -39,9 +39,9 @@ pub fn create_ecx<'mir, 'tcx: 'mir>(\n         Evaluator::new(config.communicate),\n         MemoryExtra::new(StdRng::seed_from_u64(config.seed.unwrap_or(0)), config.validate),\n     );\n-\n-    ShimsEnvVars::init(config.communicate, &mut ecx, &tcx);\n-\n+    // Complete initialization.\n+    EnvVars::init(&mut ecx, &tcx, config.communicate);\n+    // Setup first stack-frame\n     let main_instance = ty::Instance::mono(ecx.tcx.tcx, main_id);\n     let main_mir = ecx.load_mir(main_instance.def)?;\n "}, {"sha": "738419c2498b7819947f4c0b5ce407f62bfb2635", "filename": "src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/46f902b67dfeaeab45424dd7e24771676ef30b58/src%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/46f902b67dfeaeab45424dd7e24771676ef30b58/src%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib.rs?ref=46f902b67dfeaeab45424dd7e24771676ef30b58", "patch": "@@ -33,7 +33,7 @@ pub use crate::shims::foreign_items::EvalContextExt as ForeignItemsEvalContextEx\n pub use crate::shims::intrinsics::EvalContextExt as IntrinsicsEvalContextExt;\n pub use crate::shims::tls::{EvalContextExt as TlsEvalContextExt, TlsData};\n pub use crate::shims::dlsym::{Dlsym, EvalContextExt as DlsymEvalContextExt};\n-pub use crate::shims::env::{EnvVars as ShimsEnvVars};\n+pub use crate::shims::env::EnvVars;\n pub use crate::operator::EvalContextExt as OperatorEvalContextExt;\n pub use crate::range_map::RangeMap;\n pub use crate::helpers::{EvalContextExt as HelpersEvalContextExt};"}, {"sha": "b4aac147f94fb184dde74ae8469955877f8e08e5", "filename": "src/machine.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/46f902b67dfeaeab45424dd7e24771676ef30b58/src%2Fmachine.rs", "raw_url": "https://github.com/rust-lang/rust/raw/46f902b67dfeaeab45424dd7e24771676ef30b58/src%2Fmachine.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmachine.rs?ref=46f902b67dfeaeab45424dd7e24771676ef30b58", "patch": "@@ -78,7 +78,7 @@ impl MemoryExtra {\n pub struct Evaluator<'tcx> {\n     /// Environment variables set by `setenv`.\n     /// Miri does not expose env vars from the host to the emulated program.\n-    pub(crate) env_vars: ShimsEnvVars,\n+    pub(crate) env_vars: EnvVars,\n \n     /// Program arguments (`Option` because we can only initialize them after creating the ecx).\n     /// These are *pointers* to argc/argv because macOS.\n@@ -102,7 +102,7 @@ impl<'tcx> Evaluator<'tcx> {\n         Evaluator {\n             // `env_vars` could be initialized properly here if `Memory` were available before\n             // calling this method.\n-            env_vars: ShimsEnvVars::default(),\n+            env_vars: EnvVars::default(),\n             argc: None,\n             argv: None,\n             cmd_line: None,"}, {"sha": "d283cde8e3e9b7656db25d9c7fcb5557cd609b0d", "filename": "src/shims/env.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/46f902b67dfeaeab45424dd7e24771676ef30b58/src%2Fshims%2Fenv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/46f902b67dfeaeab45424dd7e24771676ef30b58/src%2Fshims%2Fenv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Fenv.rs?ref=46f902b67dfeaeab45424dd7e24771676ef30b58", "patch": "@@ -12,9 +12,9 @@ pub struct EnvVars {\n \n impl EnvVars {\n     pub(crate) fn init<'mir, 'tcx>(\n-        communicate: bool,\n         ecx: &mut InterpCx<'mir, 'tcx, Evaluator<'tcx>>,\n         tcx: &TyCtxt<'tcx>,\n+        communicate: bool,\n     ) {\n         if communicate {\n             for (name, value) in std::env::vars() {"}]}