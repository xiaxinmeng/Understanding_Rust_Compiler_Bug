{"sha": "387a8888ee338bbe4628640cd4cd72037ac57032", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM4N2E4ODg4ZWUzMzhiYmU0NjI4NjQwY2Q0Y2Q3MjAzN2FjNTcwMzI=", "commit": {"author": {"name": "Tim Chevalier", "email": "chevalier@alum.wellesley.edu", "date": "2011-05-16T21:33:22Z"}, "committer": {"name": "Tim Chevalier", "email": "chevalier@alum.wellesley.edu", "date": "2011-05-16T23:59:30Z"}, "message": "Fix get_os and get_arch\n\nget_os and get_arch were failing to return a value in the error\ncase; they were also assuming that strings are indexed from 1. No\nidea how they ever worked, but anyway, fixed.", "tree": {"sha": "00cf6e5fa1a80ad96e55731d735db85604178f93", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/00cf6e5fa1a80ad96e55731d735db85604178f93"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/387a8888ee338bbe4628640cd4cd72037ac57032", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/387a8888ee338bbe4628640cd4cd72037ac57032", "html_url": "https://github.com/rust-lang/rust/commit/387a8888ee338bbe4628640cd4cd72037ac57032", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/387a8888ee338bbe4628640cd4cd72037ac57032/comments", "author": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "committer": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b42bb2cff249862d22c89af09a912fbb0a8d8862", "url": "https://api.github.com/repos/rust-lang/rust/commits/b42bb2cff249862d22c89af09a912fbb0a8d8862", "html_url": "https://github.com/rust-lang/rust/commit/b42bb2cff249862d22c89af09a912fbb0a8d8862"}], "stats": {"total": 29, "additions": 17, "deletions": 12}, "files": [{"sha": "6dd57ac02325eb51dda14fe5f8b4448eff1a9108", "filename": "src/comp/driver/rustc.rs", "status": "modified", "additions": 17, "deletions": 12, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/387a8888ee338bbe4628640cd4cd72037ac57032/src%2Fcomp%2Fdriver%2Frustc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/387a8888ee338bbe4628640cd4cd72037ac57032/src%2Fcomp%2Fdriver%2Frustc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fdriver%2Frustc.rs?ref=387a8888ee338bbe4628640cd4cd72037ac57032", "patch": "@@ -166,26 +166,31 @@ options:\n }\n \n fn get_os(str triple) -> session::os {\n-    if (_str::find(triple, \"win32\") > 0 ||\n-        _str::find(triple, \"mingw32\") > 0 ) {\n+    if (_str::find(triple, \"win32\") >= 0 ||\n+        _str::find(triple, \"mingw32\") >= 0 ) {\n         ret session::os_win32;\n-    } else if (_str::find(triple, \"darwin\") > 0) { ret session::os_macos; }\n-    else if (_str::find(triple, \"linux\") > 0) { ret session::os_linux; }\n+    } else if (_str::find(triple, \"darwin\") >= 0) { ret session::os_macos; }\n+    else if (_str::find(triple, \"linux\") >= 0) { ret session::os_linux; }\n+    else { log_err \"Unknown operating system!\"; fail; }\n }\n \n fn get_arch(str triple) -> session::arch {\n-    if (_str::find(triple, \"i386\") > 0 ||\n-        _str::find(triple, \"i486\") > 0 ||\n-        _str::find(triple, \"i586\") > 0 ||\n-        _str::find(triple, \"i686\") > 0 ||\n-        _str::find(triple, \"i786\") > 0 ) {\n+    if (_str::find(triple, \"i386\") >= 0 ||\n+        _str::find(triple, \"i486\") >= 0 ||\n+        _str::find(triple, \"i586\") >= 0 ||\n+        _str::find(triple, \"i686\") >= 0 ||\n+        _str::find(triple, \"i786\") >= 0 ) {\n         ret session::arch_x86;\n-    } else if (_str::find(triple, \"x86_64\") > 0) {\n+    } else if (_str::find(triple, \"x86_64\") >= 0) {\n         ret session::arch_x64;\n-    } else if (_str::find(triple, \"arm\") > 0 ||\n-        _str::find(triple, \"xscale\") > 0 ) {\n+    } else if (_str::find(triple, \"arm\") >= 0 ||\n+        _str::find(triple, \"xscale\") >= 0 ) {\n         ret session::arch_arm;\n     }\n+    else {\n+        log_err (\"Unknown architecture! \" + triple);\n+        fail;\n+    }\n }\n \n fn get_default_sysroot(str binary) -> str {"}]}