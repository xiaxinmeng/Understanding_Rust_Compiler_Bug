{"sha": "c31c60cbb9ceb75402240bfe1adc9c2b48a29aa0", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMzMWM2MGNiYjljZWI3NTQwMjI0MGJmZTFhZGM5YzJiNDhhMjlhYTA=", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2018-01-03T22:22:38Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2018-01-15T15:04:38Z"}, "message": "Reword diagnostic", "tree": {"sha": "4b678c7fcf172d79b0cfd2a39c0992dea67aadd3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4b678c7fcf172d79b0cfd2a39c0992dea67aadd3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c31c60cbb9ceb75402240bfe1adc9c2b48a29aa0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c31c60cbb9ceb75402240bfe1adc9c2b48a29aa0", "html_url": "https://github.com/rust-lang/rust/commit/c31c60cbb9ceb75402240bfe1adc9c2b48a29aa0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c31c60cbb9ceb75402240bfe1adc9c2b48a29aa0/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "846042161c17bcc696715b3dfe2e6c4970da0b34", "url": "https://api.github.com/repos/rust-lang/rust/commits/846042161c17bcc696715b3dfe2e6c4970da0b34", "html_url": "https://github.com/rust-lang/rust/commit/846042161c17bcc696715b3dfe2e6c4970da0b34"}], "stats": {"total": 22, "additions": 9, "deletions": 13}, "files": [{"sha": "cdb90c7ba7e96dd4561bb409babf6f5dcd582ffc", "filename": "src/librustc/infer/error_reporting/mod.rs", "status": "modified", "additions": 6, "deletions": 10, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/c31c60cbb9ceb75402240bfe1adc9c2b48a29aa0/src%2Flibrustc%2Finfer%2Ferror_reporting%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c31c60cbb9ceb75402240bfe1adc9c2b48a29aa0/src%2Flibrustc%2Finfer%2Ferror_reporting%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Finfer%2Ferror_reporting%2Fmod.rs?ref=c31c60cbb9ceb75402240bfe1adc9c2b48a29aa0", "patch": "@@ -1071,7 +1071,7 @@ impl<'a, 'gcx, 'tcx> InferCtxt<'a, 'gcx, 'tcx> {\n         // #45983: when trying to assign the contents of an argument to a binding outside of a\n         // closure, provide a specific message pointing this out.\n         if let (&SubregionOrigin::BindingTypeIsNotValidAtDecl(ref external_span),\n-                &SubregionOrigin::Subtype(TypeTrace { ref cause, .. }),\n+                &SubregionOrigin::Subtype(_),\n                 &RegionKind::ReFree(ref free_region)) = (&sub_origin, &sup_origin, sup_region) {\n             let hir = &self.tcx.hir;\n             if let Some(node_id) = hir.as_local_node_id(free_region.scope) {\n@@ -1084,15 +1084,11 @@ impl<'a, 'gcx, 'tcx> InferCtxt<'a, 'gcx, 'tcx> {\n                         let mut err = self.tcx.sess.struct_span_err(\n                             sp,\n                             \"borrowed data cannot be moved outside of its closure\");\n-                        let label = match cause.code {\n-                            ObligationCauseCode::ExprAssignable => {\n-                                \"cannot be assigned to binding outside of its closure\"\n-                            }\n-                            _ => \"cannot be moved outside of its closure\",\n-                        };\n-                        err.span_label(sp, label);\n-                        err.span_label(*closure_span, \"closure you can't escape\");\n-                        err.span_label(*external_span, \"binding declared outside of closure\");\n+                        err.span_label(sp, \"cannot be moved outside of its closure\");\n+                        err.span_label(*external_span,\n+                                       \"borrowed data cannot be moved into here...\");\n+                        err.span_label(*closure_span,\n+                                       \"...because it cannot outlive this closure\");\n                         err.emit();\n                         return;\n                     }"}, {"sha": "cbc4a557be9efcfe0bd7da0f2971668b4590a1a5", "filename": "src/test/ui/borrowck/issue-45983.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/c31c60cbb9ceb75402240bfe1adc9c2b48a29aa0/src%2Ftest%2Fui%2Fborrowck%2Fissue-45983.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c31c60cbb9ceb75402240bfe1adc9c2b48a29aa0/src%2Ftest%2Fui%2Fborrowck%2Fissue-45983.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fissue-45983.stderr?ref=c31c60cbb9ceb75402240bfe1adc9c2b48a29aa0", "patch": "@@ -2,11 +2,11 @@ error: borrowed data cannot be moved outside of its closure\n   --> $DIR/issue-45983.rs:17:27\n    |\n 16 |     let x = None;\n-   |         - binding declared outside of closure\n+   |         - borrowed data cannot be moved into here...\n 17 |     give_any(|y| x = Some(y));\n-   |              ---          ^ cannot be assigned to binding outside of its closure\n+   |              ---          ^ cannot be moved outside of its closure\n    |              |\n-   |              closure you can't escape\n+   |              ...because it cannot outlive this closure\n \n error: aborting due to previous error\n "}]}