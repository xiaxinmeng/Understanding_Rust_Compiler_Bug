{"sha": "bd4a2996d1ac30e49adfcb241cb8a436730c35ac", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJkNGEyOTk2ZDFhYzMwZTQ5YWRmY2IyNDFjYjhhNDM2NzMwYzM1YWM=", "commit": {"author": {"name": "Nicolas", "email": "abramlujan@gmail.com", "date": "2019-10-05T11:09:23Z"}, "committer": {"name": "Nicolas", "email": "abramlujan@gmail.com", "date": "2019-10-05T11:20:17Z"}, "message": "Add test for atomic fences", "tree": {"sha": "79efd738d465d84f0010c5452c620b20444aa350", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/79efd738d465d84f0010c5452c620b20444aa350"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bd4a2996d1ac30e49adfcb241cb8a436730c35ac", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bd4a2996d1ac30e49adfcb241cb8a436730c35ac", "html_url": "https://github.com/rust-lang/rust/commit/bd4a2996d1ac30e49adfcb241cb8a436730c35ac", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bd4a2996d1ac30e49adfcb241cb8a436730c35ac/comments", "author": {"login": "nico-abram", "id": 24706838, "node_id": "MDQ6VXNlcjI0NzA2ODM4", "avatar_url": "https://avatars.githubusercontent.com/u/24706838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nico-abram", "html_url": "https://github.com/nico-abram", "followers_url": "https://api.github.com/users/nico-abram/followers", "following_url": "https://api.github.com/users/nico-abram/following{/other_user}", "gists_url": "https://api.github.com/users/nico-abram/gists{/gist_id}", "starred_url": "https://api.github.com/users/nico-abram/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nico-abram/subscriptions", "organizations_url": "https://api.github.com/users/nico-abram/orgs", "repos_url": "https://api.github.com/users/nico-abram/repos", "events_url": "https://api.github.com/users/nico-abram/events{/privacy}", "received_events_url": "https://api.github.com/users/nico-abram/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nico-abram", "id": 24706838, "node_id": "MDQ6VXNlcjI0NzA2ODM4", "avatar_url": "https://avatars.githubusercontent.com/u/24706838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nico-abram", "html_url": "https://github.com/nico-abram", "followers_url": "https://api.github.com/users/nico-abram/followers", "following_url": "https://api.github.com/users/nico-abram/following{/other_user}", "gists_url": "https://api.github.com/users/nico-abram/gists{/gist_id}", "starred_url": "https://api.github.com/users/nico-abram/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nico-abram/subscriptions", "organizations_url": "https://api.github.com/users/nico-abram/orgs", "repos_url": "https://api.github.com/users/nico-abram/repos", "events_url": "https://api.github.com/users/nico-abram/events{/privacy}", "received_events_url": "https://api.github.com/users/nico-abram/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0c4003631d011ba569e49e6d1a63b90e92db3a49", "url": "https://api.github.com/repos/rust-lang/rust/commits/0c4003631d011ba569e49e6d1a63b90e92db3a49", "html_url": "https://github.com/rust-lang/rust/commit/0c4003631d011ba569e49e6d1a63b90e92db3a49"}], "stats": {"total": 14, "additions": 12, "deletions": 2}, "files": [{"sha": "5872a496dbfa4bb1de2b0718f13f41f2d36d45f0", "filename": "tests/run-pass/atomic.rs", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/bd4a2996d1ac30e49adfcb241cb8a436730c35ac/tests%2Frun-pass%2Fatomic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bd4a2996d1ac30e49adfcb241cb8a436730c35ac/tests%2Frun-pass%2Fatomic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fatomic.rs?ref=bd4a2996d1ac30e49adfcb241cb8a436730c35ac", "patch": "@@ -1,9 +1,10 @@\n-use std::sync::atomic::{AtomicBool, AtomicIsize, AtomicU64, Ordering::*};\n+use std::sync::atomic::{fence, AtomicBool, AtomicIsize, AtomicU64, Ordering::*};\n \n fn main() {\n     atomic_bool();\n     atomic_isize();\n     atomic_u64();\n+    atomic_fences();\n }\n \n fn atomic_bool() {\n@@ -57,6 +58,15 @@ fn atomic_u64() {\n \n     ATOMIC.store(1, SeqCst);\n     assert_eq!(ATOMIC.compare_exchange(0, 0x100, AcqRel, Acquire), Err(1));\n-    assert_eq!(ATOMIC.compare_exchange_weak(1, 0x100, AcqRel, Acquire), Ok(1));\n+    assert_eq!(\n+        ATOMIC.compare_exchange_weak(1, 0x100, AcqRel, Acquire),\n+        Ok(1)\n+    );\n     assert_eq!(ATOMIC.load(Relaxed), 0x100);\n }\n+\n+fn atomic_fences() {\n+    fence(SeqCst);\n+    fence(Release);\n+    fence(Acquire);\n+}"}]}