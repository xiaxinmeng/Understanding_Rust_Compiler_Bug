{"sha": "0ce06088f8b79ba53002d6a7254e6bb01b687552", "node_id": "C_kwDOAAsO6NoAKDBjZTA2MDg4ZjhiNzliYTUzMDAyZDZhNzI1NGU2YmIwMWI2ODc1NTI", "commit": {"author": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2023-03-06T21:39:42Z"}, "committer": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2023-03-06T21:39:42Z"}, "message": "Fix inlay-hint tests", "tree": {"sha": "bcbc8af55b894fb7eadba2881ff4fedbc8f39312", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bcbc8af55b894fb7eadba2881ff4fedbc8f39312"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0ce06088f8b79ba53002d6a7254e6bb01b687552", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0ce06088f8b79ba53002d6a7254e6bb01b687552", "html_url": "https://github.com/rust-lang/rust/commit/0ce06088f8b79ba53002d6a7254e6bb01b687552", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0ce06088f8b79ba53002d6a7254e6bb01b687552/comments", "author": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "199bc82ce88d95398a1c9b442f49c2794e07d042", "url": "https://api.github.com/repos/rust-lang/rust/commits/199bc82ce88d95398a1c9b442f49c2794e07d042", "html_url": "https://github.com/rust-lang/rust/commit/199bc82ce88d95398a1c9b442f49c2794e07d042"}], "stats": {"total": 129, "additions": 18, "deletions": 111}, "files": [{"sha": "6a50927333d4f6b47433cbb701cb4b54145536f1", "filename": "crates/ide/src/inlay_hints/bind_pat.rs", "status": "modified", "additions": 12, "deletions": 105, "changes": 117, "blob_url": "https://github.com/rust-lang/rust/blob/0ce06088f8b79ba53002d6a7254e6bb01b687552/crates%2Fide%2Fsrc%2Finlay_hints%2Fbind_pat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0ce06088f8b79ba53002d6a7254e6bb01b687552/crates%2Fide%2Fsrc%2Finlay_hints%2Fbind_pat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Finlay_hints%2Fbind_pat.rs?ref=0ce06088f8b79ba53002d6a7254e6bb01b687552", "patch": "@@ -176,15 +176,12 @@ fn pat_is_enum_variant(db: &RootDatabase, bind_pat: &ast::IdentPat, pat_ty: &hir\n mod tests {\n     // This module also contains tests for super::closure_ret\n \n-    use expect_test::expect;\n     use syntax::{TextRange, TextSize};\n     use test_utils::extract_annotations;\n \n     use crate::{fixture, inlay_hints::InlayHintsConfig};\n \n-    use crate::inlay_hints::tests::{\n-        check, check_expect, check_with_config, DISABLED_CONFIG, TEST_CONFIG,\n-    };\n+    use crate::inlay_hints::tests::{check, check_with_config, DISABLED_CONFIG, TEST_CONFIG};\n     use crate::ClosureReturnTypeHints;\n \n     #[track_caller]\n@@ -278,8 +275,7 @@ fn main() {\n     #[test]\n     fn iterator_hint_regression_issue_12674() {\n         // Ensure we don't crash while solving the projection type of iterators.\n-        check_expect(\n-            InlayHintsConfig { chaining_hints: true, ..DISABLED_CONFIG },\n+        let (analysis, file_id) = fixture::file(\n             r#\"\n //- minicore: iterators\n struct S<T>(T);\n@@ -302,107 +298,18 @@ impl<'a, T> Iterator for SliceIter<'a, T> {\n \n fn main(a: SliceIter<'_, Container>) {\n     a\n-    .filter_map(|c| Some(c.elements.iter().filter_map(|v| Some(v))))\n-    .map(|e| e);\n+        .filter_map(|c| Some(c.elements.iter().filter_map(|v| Some(v))))\n+        .map(|e| e);\n }\n-            \"#,\n-            expect![[r#\"\n-                [\n-                    InlayHint {\n-                        range: 484..554,\n-                        kind: Chaining,\n-                        label: [\n-                            \"impl \",\n-                            InlayHintLabelPart {\n-                                text: \"Iterator\",\n-                                linked_location: Some(\n-                                    FileRange {\n-                                        file_id: FileId(\n-                                            1,\n-                                        ),\n-                                        range: 2611..2619,\n-                                    },\n-                                ),\n-                                tooltip: \"\",\n-                            },\n-                            \"<\",\n-                            InlayHintLabelPart {\n-                                text: \"Item\",\n-                                linked_location: Some(\n-                                    FileRange {\n-                                        file_id: FileId(\n-                                            1,\n-                                        ),\n-                                        range: 2643..2647,\n-                                    },\n-                                ),\n-                                tooltip: \"\",\n-                            },\n-                            \" = impl \",\n-                            InlayHintLabelPart {\n-                                text: \"Iterator\",\n-                                linked_location: Some(\n-                                    FileRange {\n-                                        file_id: FileId(\n-                                            1,\n-                                        ),\n-                                        range: 2611..2619,\n-                                    },\n-                                ),\n-                                tooltip: \"\",\n-                            },\n-                            \"<\",\n-                            InlayHintLabelPart {\n-                                text: \"Item\",\n-                                linked_location: Some(\n-                                    FileRange {\n-                                        file_id: FileId(\n-                                            1,\n-                                        ),\n-                                        range: 2643..2647,\n-                                    },\n-                                ),\n-                                tooltip: \"\",\n-                            },\n-                            \" = &&str>>\",\n-                        ],\n-                    },\n-                    InlayHint {\n-                        range: 484..485,\n-                        kind: Chaining,\n-                        label: [\n-                            \"\",\n-                            InlayHintLabelPart {\n-                                text: \"SliceIter\",\n-                                linked_location: Some(\n-                                    FileRange {\n-                                        file_id: FileId(\n-                                            0,\n-                                        ),\n-                                        range: 289..298,\n-                                    },\n-                                ),\n-                                tooltip: \"\",\n-                            },\n-                            \"<\",\n-                            InlayHintLabelPart {\n-                                text: \"Container\",\n-                                linked_location: Some(\n-                                    FileRange {\n-                                        file_id: FileId(\n-                                            0,\n-                                        ),\n-                                        range: 238..247,\n-                                    },\n-                                ),\n-                                tooltip: \"\",\n-                            },\n-                            \">\",\n-                        ],\n-                    },\n-                ]\n-            \"#]],\n+\"#,\n         );\n+        analysis\n+            .inlay_hints(\n+                &InlayHintsConfig { chaining_hints: true, ..DISABLED_CONFIG },\n+                file_id,\n+                None,\n+            )\n+            .unwrap();\n     }\n \n     #[test]"}, {"sha": "0a7513e465a57766be3db556ad41512d61ed4746", "filename": "crates/ide/src/inlay_hints/chaining.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/0ce06088f8b79ba53002d6a7254e6bb01b687552/crates%2Fide%2Fsrc%2Finlay_hints%2Fchaining.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0ce06088f8b79ba53002d6a7254e6bb01b687552/crates%2Fide%2Fsrc%2Finlay_hints%2Fchaining.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Finlay_hints%2Fchaining.rs?ref=0ce06088f8b79ba53002d6a7254e6bb01b687552", "patch": "@@ -435,7 +435,7 @@ fn main() {\n                                         file_id: FileId(\n                                             1,\n                                         ),\n-                                        range: 2611..2619,\n+                                        range: 3386..3394,\n                                     },\n                                 ),\n                                 tooltip: \"\",\n@@ -448,7 +448,7 @@ fn main() {\n                                         file_id: FileId(\n                                             1,\n                                         ),\n-                                        range: 2643..2647,\n+                                        range: 3418..3422,\n                                     },\n                                 ),\n                                 tooltip: \"\",\n@@ -468,7 +468,7 @@ fn main() {\n                                         file_id: FileId(\n                                             1,\n                                         ),\n-                                        range: 2611..2619,\n+                                        range: 3386..3394,\n                                     },\n                                 ),\n                                 tooltip: \"\",\n@@ -481,7 +481,7 @@ fn main() {\n                                         file_id: FileId(\n                                             1,\n                                         ),\n-                                        range: 2643..2647,\n+                                        range: 3418..3422,\n                                     },\n                                 ),\n                                 tooltip: \"\",\n@@ -501,7 +501,7 @@ fn main() {\n                                         file_id: FileId(\n                                             1,\n                                         ),\n-                                        range: 2611..2619,\n+                                        range: 3386..3394,\n                                     },\n                                 ),\n                                 tooltip: \"\",\n@@ -514,7 +514,7 @@ fn main() {\n                                         file_id: FileId(\n                                             1,\n                                         ),\n-                                        range: 2643..2647,\n+                                        range: 3418..3422,\n                                     },\n                                 ),\n                                 tooltip: \"\","}]}