{"sha": "1825f80fab649f0a5647239c58bcfbc58f378947", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE4MjVmODBmYWI2NDlmMGE1NjQ3MjM5YzU4YmNmYmM1OGYzNzg5NDc=", "commit": {"author": {"name": "Martijn Vermaat", "email": "martijn@vermaat.name", "date": "2016-12-28T19:40:00Z"}, "committer": {"name": "Martijn Vermaat", "email": "martijn@vermaat.name", "date": "2016-12-28T19:40:00Z"}, "message": "Fix default terminfo code for reset (sg0 -> sgr0)\n\nResetting the terminal should first try `sgr0` (as per the comment), not\n`sg0` which I believe to be a typo.\n\nThis will at least fix rustc output in Emacs terminals (e.g., ansi-term)\nwith `TERM=eterm-color` which does not provide the next fallback `sgr`. In\nsuch a terminal, the final fallback `op` (`\\e[39;49`) is used  which\nresets only colors, not all attributes. This causes all text to be\nprinted in bold from the first string printed in bold by rustc onwards,\nincluding the terminal prompt and the output from all following commands.\n\nThe typo seems to have been introduced by #29999", "tree": {"sha": "cef9af3a745f5b6b09468dce5116739d42d63b37", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cef9af3a745f5b6b09468dce5116739d42d63b37"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1825f80fab649f0a5647239c58bcfbc58f378947", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1825f80fab649f0a5647239c58bcfbc58f378947", "html_url": "https://github.com/rust-lang/rust/commit/1825f80fab649f0a5647239c58bcfbc58f378947", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1825f80fab649f0a5647239c58bcfbc58f378947/comments", "author": {"login": "martijnvermaat", "id": 623509, "node_id": "MDQ6VXNlcjYyMzUwOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/623509?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martijnvermaat", "html_url": "https://github.com/martijnvermaat", "followers_url": "https://api.github.com/users/martijnvermaat/followers", "following_url": "https://api.github.com/users/martijnvermaat/following{/other_user}", "gists_url": "https://api.github.com/users/martijnvermaat/gists{/gist_id}", "starred_url": "https://api.github.com/users/martijnvermaat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martijnvermaat/subscriptions", "organizations_url": "https://api.github.com/users/martijnvermaat/orgs", "repos_url": "https://api.github.com/users/martijnvermaat/repos", "events_url": "https://api.github.com/users/martijnvermaat/events{/privacy}", "received_events_url": "https://api.github.com/users/martijnvermaat/received_events", "type": "User", "site_admin": false}, "committer": {"login": "martijnvermaat", "id": 623509, "node_id": "MDQ6VXNlcjYyMzUwOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/623509?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martijnvermaat", "html_url": "https://github.com/martijnvermaat", "followers_url": "https://api.github.com/users/martijnvermaat/followers", "following_url": "https://api.github.com/users/martijnvermaat/following{/other_user}", "gists_url": "https://api.github.com/users/martijnvermaat/gists{/gist_id}", "starred_url": "https://api.github.com/users/martijnvermaat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martijnvermaat/subscriptions", "organizations_url": "https://api.github.com/users/martijnvermaat/orgs", "repos_url": "https://api.github.com/users/martijnvermaat/repos", "events_url": "https://api.github.com/users/martijnvermaat/events{/privacy}", "received_events_url": "https://api.github.com/users/martijnvermaat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "371f4d6bf697ac4b08845b6e739ab263df6f8395", "url": "https://api.github.com/repos/rust-lang/rust/commits/371f4d6bf697ac4b08845b6e739ab263df6f8395", "html_url": "https://github.com/rust-lang/rust/commit/371f4d6bf697ac4b08845b6e739ab263df6f8395"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "68cfc7033ef5afa9938e483b13e6603a29e99954", "filename": "src/libterm/terminfo/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1825f80fab649f0a5647239c58bcfbc58f378947/src%2Flibterm%2Fterminfo%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1825f80fab649f0a5647239c58bcfbc58f378947/src%2Flibterm%2Fterminfo%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibterm%2Fterminfo%2Fmod.rs?ref=1825f80fab649f0a5647239c58bcfbc58f378947", "patch": "@@ -190,7 +190,7 @@ impl<T: Write + Send> Terminal for TerminfoTerminal<T> {\n     fn reset(&mut self) -> io::Result<bool> {\n         // are there any terminals that have color/attrs and not sgr0?\n         // Try falling back to sgr, then op\n-        let cmd = match [\"sg0\", \"sgr\", \"op\"]\n+        let cmd = match [\"sgr0\", \"sgr\", \"op\"]\n                             .iter()\n                             .filter_map(|cap| self.ti.strings.get(*cap))\n                             .next() {"}]}