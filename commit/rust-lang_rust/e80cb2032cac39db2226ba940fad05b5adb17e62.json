{"sha": "e80cb2032cac39db2226ba940fad05b5adb17e62", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU4MGNiMjAzMmNhYzM5ZGIyMjI2YmE5NDBmYWQwNWI1YWRiMTdlNjI=", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2020-03-14T12:28:17Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2020-03-14T16:21:38Z"}, "message": "resolve: Fix regression in resolution of raw keywords in paths", "tree": {"sha": "07cb20d67a3889e9196828027088ca40c7ca6eb4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/07cb20d67a3889e9196828027088ca40c7ca6eb4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e80cb2032cac39db2226ba940fad05b5adb17e62", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e80cb2032cac39db2226ba940fad05b5adb17e62", "html_url": "https://github.com/rust-lang/rust/commit/e80cb2032cac39db2226ba940fad05b5adb17e62", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e80cb2032cac39db2226ba940fad05b5adb17e62/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "42ce9b4e9054d63c8f352f994e2d5dae7d04130f", "url": "https://api.github.com/repos/rust-lang/rust/commits/42ce9b4e9054d63c8f352f994e2d5dae7d04130f", "html_url": "https://github.com/rust-lang/rust/commit/42ce9b4e9054d63c8f352f994e2d5dae7d04130f"}], "stats": {"total": 39, "additions": 29, "deletions": 10}, "files": [{"sha": "02ac560093d043af0f80f55d28c485e792cc9869", "filename": "src/librustc_resolve/lib.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e80cb2032cac39db2226ba940fad05b5adb17e62/src%2Flibrustc_resolve%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e80cb2032cac39db2226ba940fad05b5adb17e62/src%2Flibrustc_resolve%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Flib.rs?ref=e80cb2032cac39db2226ba940fad05b5adb17e62", "patch": "@@ -2183,11 +2183,8 @@ impl<'a> Resolver<'a> {\n                                     Applicability::MaybeIncorrect,\n                                 )),\n                             )\n-                        } else if !ident.is_reserved() {\n-                            (format!(\"maybe a missing crate `{}`?\", ident), None)\n                         } else {\n-                            // the parser will already have complained about the keyword being used\n-                            return PathResult::NonModule(PartialRes::new(Res::Err));\n+                            (format!(\"maybe a missing crate `{}`?\", ident), None)\n                         }\n                     } else if i == 0 {\n                         (format!(\"use of undeclared type or module `{}`\", ident), None)"}, {"sha": "4bd8efeaa3b97514c6573170bbb7540b6c09c4f5", "filename": "src/test/rustdoc-ui/issue-61732.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e80cb2032cac39db2226ba940fad05b5adb17e62/src%2Ftest%2Frustdoc-ui%2Fissue-61732.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e80cb2032cac39db2226ba940fad05b5adb17e62/src%2Ftest%2Frustdoc-ui%2Fissue-61732.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fissue-61732.rs?ref=e80cb2032cac39db2226ba940fad05b5adb17e62", "patch": "@@ -1,4 +1,4 @@\n // This previously triggered an ICE.\n \n pub(in crate::r#mod) fn main() {}\n-//~^ ERROR expected module, found unresolved item\n+//~^ ERROR failed to resolve: maybe a missing crate `r#mod`"}, {"sha": "8213422491120fd6b410ea2121f0be8a99bf1ff3", "filename": "src/test/rustdoc-ui/issue-61732.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/e80cb2032cac39db2226ba940fad05b5adb17e62/src%2Ftest%2Frustdoc-ui%2Fissue-61732.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e80cb2032cac39db2226ba940fad05b5adb17e62/src%2Ftest%2Frustdoc-ui%2Fissue-61732.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fissue-61732.stderr?ref=e80cb2032cac39db2226ba940fad05b5adb17e62", "patch": "@@ -1,11 +1,11 @@\n-error[E0577]: expected module, found unresolved item `crate::r#mod`\n-  --> $DIR/issue-61732.rs:3:8\n+error[E0433]: failed to resolve: maybe a missing crate `r#mod`?\n+  --> $DIR/issue-61732.rs:3:15\n    |\n LL | pub(in crate::r#mod) fn main() {}\n-   |        ^^^^^^^^^^^^ not a module\n+   |               ^^^^^ maybe a missing crate `r#mod`?\n \n error: Compilation failed, aborting rustdoc\n \n error: aborting due to 2 previous errors\n \n-For more information about this error, try `rustc --explain E0577`.\n+For more information about this error, try `rustc --explain E0433`."}, {"sha": "a46ce67d40d5a709d60fbba06c2e7a3adc612286", "filename": "src/test/ui/keyword/extern/keyword-extern-as-identifier-use.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/e80cb2032cac39db2226ba940fad05b5adb17e62/src%2Ftest%2Fui%2Fkeyword%2Fextern%2Fkeyword-extern-as-identifier-use.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e80cb2032cac39db2226ba940fad05b5adb17e62/src%2Ftest%2Fui%2Fkeyword%2Fextern%2Fkeyword-extern-as-identifier-use.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fkeyword%2Fextern%2Fkeyword-extern-as-identifier-use.rs?ref=e80cb2032cac39db2226ba940fad05b5adb17e62", "patch": "@@ -1,3 +1,4 @@\n use extern::foo; //~ ERROR expected identifier, found keyword `extern`\n+                 //~| ERROR unresolved import `r#extern`\n \n fn main() {}"}, {"sha": "edbb36452b6ce0139ff8239a8f962323af289e68", "filename": "src/test/ui/keyword/extern/keyword-extern-as-identifier-use.stderr", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/e80cb2032cac39db2226ba940fad05b5adb17e62/src%2Ftest%2Fui%2Fkeyword%2Fextern%2Fkeyword-extern-as-identifier-use.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e80cb2032cac39db2226ba940fad05b5adb17e62/src%2Ftest%2Fui%2Fkeyword%2Fextern%2Fkeyword-extern-as-identifier-use.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fkeyword%2Fextern%2Fkeyword-extern-as-identifier-use.stderr?ref=e80cb2032cac39db2226ba940fad05b5adb17e62", "patch": "@@ -9,5 +9,12 @@ help: you can escape reserved keywords to use them as identifiers\n LL | use r#extern::foo;\n    |     ^^^^^^^^\n \n-error: aborting due to previous error\n+error[E0432]: unresolved import `r#extern`\n+  --> $DIR/keyword-extern-as-identifier-use.rs:1:5\n+   |\n+LL | use extern::foo;\n+   |     ^^^^^^ maybe a missing crate `r#extern`?\n+\n+error: aborting due to 2 previous errors\n \n+For more information about this error, try `rustc --explain E0432`."}, {"sha": "1bcbef594374103c48081eb7dab0af0e6121deb6", "filename": "src/test/ui/resolve/raw-ident-in-path.rs", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e80cb2032cac39db2226ba940fad05b5adb17e62/src%2Ftest%2Fui%2Fresolve%2Fraw-ident-in-path.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e80cb2032cac39db2226ba940fad05b5adb17e62/src%2Ftest%2Fui%2Fresolve%2Fraw-ident-in-path.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Fraw-ident-in-path.rs?ref=e80cb2032cac39db2226ba940fad05b5adb17e62", "patch": "@@ -0,0 +1,5 @@\n+// Regression test for issue #63882.\n+\n+type A = crate::r#break; //~ ERROR cannot find type `r#break` in module `crate`\n+\n+fn main() {}"}, {"sha": "f2efcbc8e85863e7318fc33664ba908ee22ae675", "filename": "src/test/ui/resolve/raw-ident-in-path.stderr", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/e80cb2032cac39db2226ba940fad05b5adb17e62/src%2Ftest%2Fui%2Fresolve%2Fraw-ident-in-path.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e80cb2032cac39db2226ba940fad05b5adb17e62/src%2Ftest%2Fui%2Fresolve%2Fraw-ident-in-path.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Fraw-ident-in-path.stderr?ref=e80cb2032cac39db2226ba940fad05b5adb17e62", "patch": "@@ -0,0 +1,9 @@\n+error[E0412]: cannot find type `r#break` in module `crate`\n+  --> $DIR/raw-ident-in-path.rs:3:17\n+   |\n+LL | type A = crate::r#break;\n+   |                 ^^^^^^^ not found in `crate`\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0412`."}]}