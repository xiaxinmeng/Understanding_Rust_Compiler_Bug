{"sha": "f4c106f86a4fbb91f36aac59a6a98fff9d3c5c40", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY0YzEwNmY4NmE0ZmJiOTFmMzZhYWM1OWE2YTk4ZmZmOWQzYzVjNDA=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-07-31T17:48:45Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-07-31T17:48:45Z"}, "message": "Lifetimes in self param", "tree": {"sha": "6d81877635b5b0c05553f9535322c3edb1d8639b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6d81877635b5b0c05553f9535322c3edb1d8639b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f4c106f86a4fbb91f36aac59a6a98fff9d3c5c40", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f4c106f86a4fbb91f36aac59a6a98fff9d3c5c40", "html_url": "https://github.com/rust-lang/rust/commit/f4c106f86a4fbb91f36aac59a6a98fff9d3c5c40", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f4c106f86a4fbb91f36aac59a6a98fff9d3c5c40/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "599ca1ad890f7b8e1e3919f1727c21dad353f595", "url": "https://api.github.com/repos/rust-lang/rust/commits/599ca1ad890f7b8e1e3919f1727c21dad353f595", "html_url": "https://github.com/rust-lang/rust/commit/599ca1ad890f7b8e1e3919f1727c21dad353f595"}], "stats": {"total": 96, "additions": 61, "deletions": 35}, "files": [{"sha": "53ef281817b0f0c542725cc0b27437e2dd334d6b", "filename": "src/parser/grammar/mod.rs", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/f4c106f86a4fbb91f36aac59a6a98fff9d3c5c40/src%2Fparser%2Fgrammar%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f4c106f86a4fbb91f36aac59a6a98fff9d3c5c40/src%2Fparser%2Fgrammar%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fparser%2Fgrammar%2Fmod.rs?ref=f4c106f86a4fbb91f36aac59a6a98fff9d3c5c40", "patch": "@@ -126,15 +126,19 @@ fn fn_value_parameters(p: &mut Parser) {\n     // impl S {\n     //     fn a(self) {}\n     //     fn b(&self,) {}\n-    //     fn c(&mut self, x: i32) {}\n+    //     fn c(&'a self,) {}\n+    //     fn d(&'a mut self, x: i32) {}\n     // }\n     fn self_param(p: &mut Parser) {\n         let la1 = p.nth(1);\n         let la2 = p.nth(2);\n-        let n_toks = match (p.current(), la1, la2) {\n-            (SELF_KW, _, _) => 1,\n-            (AMPERSAND, SELF_KW, _) => 2,\n-            (AMPERSAND, MUT_KW, SELF_KW) => 3,\n+        let la3 = p.nth(3);\n+        let n_toks = match (p.current(), la1, la2, la3) {\n+            (SELF_KW, _, _, _) => 1,\n+            (AMPERSAND, SELF_KW, _, _) => 2,\n+            (AMPERSAND, MUT_KW, SELF_KW, _) => 3,\n+            (AMPERSAND, LIFETIME, SELF_KW, _) => 3,\n+            (AMPERSAND, LIFETIME, MUT_KW, SELF_KW) => 4,\n             _ => return,\n         };\n         let m = p.start();"}, {"sha": "7bb1ca50c0894cd80743f2d5eb8ca8c338df770f", "filename": "tests/data/parser/inline/0055_self_param.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/f4c106f86a4fbb91f36aac59a6a98fff9d3c5c40/tests%2Fdata%2Fparser%2Finline%2F0055_self_param.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f4c106f86a4fbb91f36aac59a6a98fff9d3c5c40/tests%2Fdata%2Fparser%2Finline%2F0055_self_param.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Finline%2F0055_self_param.rs?ref=f4c106f86a4fbb91f36aac59a6a98fff9d3c5c40", "patch": "@@ -1,5 +1,6 @@\n impl S {\n     fn a(self) {}\n     fn b(&self,) {}\n-    fn c(&mut self, x: i32) {}\n+    fn c(&'a self,) {}\n+    fn d(&'a mut self, x: i32) {}\n }"}, {"sha": "9ea55f589f88ff60a57560bfede875d4e07a5705", "filename": "tests/data/parser/inline/0055_self_param.txt", "status": "modified", "additions": 50, "deletions": 29, "changes": 79, "blob_url": "https://github.com/rust-lang/rust/blob/f4c106f86a4fbb91f36aac59a6a98fff9d3c5c40/tests%2Fdata%2Fparser%2Finline%2F0055_self_param.txt", "raw_url": "https://github.com/rust-lang/rust/raw/f4c106f86a4fbb91f36aac59a6a98fff9d3c5c40/tests%2Fdata%2Fparser%2Finline%2F0055_self_param.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Finline%2F0055_self_param.txt?ref=f4c106f86a4fbb91f36aac59a6a98fff9d3c5c40", "patch": "@@ -1,5 +1,5 @@\n-FILE@[0; 80)\n-  IMPL_ITEM@[0; 80)\n+FILE@[0; 106)\n+  IMPL_ITEM@[0; 106)\n     IMPL_KW@[0; 4)\n     PATH_TYPE@[4; 7)\n       PATH@[4; 7)\n@@ -42,36 +42,57 @@ FILE@[0; 80)\n         L_CURLY@[44; 45)\n         R_CURLY@[45; 46)\n         WHITESPACE@[46; 51)\n-    FN_ITEM@[51; 78)\n+    FN_ITEM@[51; 74)\n       FN_KW@[51; 53)\n       NAME@[53; 55)\n         WHITESPACE@[53; 54)\n         IDENT@[54; 55) \"c\"\n-      PARAM_LIST@[55; 75)\n+      PARAM_LIST@[55; 67)\n         L_PAREN@[55; 56)\n-        SELF_PARAM@[56; 65)\n+        SELF_PARAM@[56; 64)\n           AMPERSAND@[56; 57)\n-          MUT_KW@[57; 60)\n-          WHITESPACE@[60; 61)\n-          SELF_KW@[61; 65)\n-        COMMA@[65; 66)\n-        VALUE_PARAMETER@[66; 73)\n-          BIND_PAT@[66; 68)\n-            NAME@[66; 68)\n-              WHITESPACE@[66; 67)\n-              IDENT@[67; 68) \"x\"\n-          COLON@[68; 69)\n-          PATH_TYPE@[69; 73)\n-            PATH@[69; 73)\n-              PATH_SEGMENT@[69; 73)\n-                NAME_REF@[69; 73)\n-                  WHITESPACE@[69; 70)\n-                  IDENT@[70; 73) \"i32\"\n-        R_PAREN@[73; 74)\n-        WHITESPACE@[74; 75)\n-      BLOCK@[75; 78)\n-        L_CURLY@[75; 76)\n-        R_CURLY@[76; 77)\n-        WHITESPACE@[77; 78)\n-    R_CURLY@[78; 79)\n-    WHITESPACE@[79; 80)\n+          LIFETIME@[57; 59) \"'a\"\n+          WHITESPACE@[59; 60)\n+          SELF_KW@[60; 64)\n+        COMMA@[64; 65)\n+        R_PAREN@[65; 66)\n+        WHITESPACE@[66; 67)\n+      BLOCK@[67; 74)\n+        L_CURLY@[67; 68)\n+        R_CURLY@[68; 69)\n+        WHITESPACE@[69; 74)\n+    FN_ITEM@[74; 104)\n+      FN_KW@[74; 76)\n+      NAME@[76; 78)\n+        WHITESPACE@[76; 77)\n+        IDENT@[77; 78) \"d\"\n+      PARAM_LIST@[78; 101)\n+        L_PAREN@[78; 79)\n+        SELF_PARAM@[79; 91)\n+          AMPERSAND@[79; 80)\n+          LIFETIME@[80; 82) \"'a\"\n+          WHITESPACE@[82; 83)\n+          MUT_KW@[83; 86)\n+          WHITESPACE@[86; 87)\n+          SELF_KW@[87; 91)\n+        COMMA@[91; 92)\n+        VALUE_PARAMETER@[92; 99)\n+          BIND_PAT@[92; 94)\n+            NAME@[92; 94)\n+              WHITESPACE@[92; 93)\n+              IDENT@[93; 94) \"x\"\n+          COLON@[94; 95)\n+          PATH_TYPE@[95; 99)\n+            PATH@[95; 99)\n+              PATH_SEGMENT@[95; 99)\n+                NAME_REF@[95; 99)\n+                  WHITESPACE@[95; 96)\n+                  IDENT@[96; 99) \"i32\"\n+        R_PAREN@[99; 100)\n+        WHITESPACE@[100; 101)\n+      BLOCK@[101; 104)\n+        L_CURLY@[101; 102)\n+        R_CURLY@[102; 103)\n+        WHITESPACE@[103; 104)\n+    R_CURLY@[104; 105)\n+    WHITESPACE@[105; 106)"}]}