{"sha": "ff9c5db03cc4fad005b9e3651b42a6945a0d9f36", "node_id": "C_kwDOAAsO6NoAKGZmOWM1ZGIwM2NjNGZhZDAwNWI5ZTM2NTFiNDJhNjk0NWEwZDlmMzY", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2023-02-16T20:52:29Z"}, "committer": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2023-02-16T20:52:29Z"}, "message": "Tweak wording", "tree": {"sha": "801107b21226b642812bc2183aba1a207ac8352b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/801107b21226b642812bc2183aba1a207ac8352b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36", "html_url": "https://github.com/rust-lang/rust/commit/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3dd638fe6c0761aa0c124b7cf80a49ad7e04ed97", "url": "https://api.github.com/repos/rust-lang/rust/commits/3dd638fe6c0761aa0c124b7cf80a49ad7e04ed97", "html_url": "https://github.com/rust-lang/rust/commit/3dd638fe6c0761aa0c124b7cf80a49ad7e04ed97"}], "stats": {"total": 61, "additions": 40, "deletions": 21}, "files": [{"sha": "06b2b2451f0faff131c9af393b6387c59fa89647", "filename": "compiler/rustc_hir_typeck/src/callee.rs", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/compiler%2Frustc_hir_typeck%2Fsrc%2Fcallee.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/compiler%2Frustc_hir_typeck%2Fsrc%2Fcallee.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_typeck%2Fsrc%2Fcallee.rs?ref=ff9c5db03cc4fad005b9e3651b42a6945a0d9f36", "patch": "@@ -247,6 +247,15 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                 adjusted_ty,\n                 opt_input_type.as_ref().map(slice::from_ref),\n             ) {\n+                // Check for `self` receiver on the method, otherwise we can't use this as a `Fn*` trait.\n+                if !self.tcx.associated_item(ok.value.def_id).fn_has_self_parameter {\n+                    self.tcx.sess.delay_span_bug(\n+                        call_expr.span,\n+                        \"input to overloaded call fn is not a self receiver\",\n+                    );\n+                    return None;\n+                }\n+\n                 let method = self.register_infer_ok_obligations(ok);\n                 let mut autoref = None;\n                 if borrow {\n@@ -257,7 +266,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                         // caused an error elsewhere.\n                         self.tcx\n                             .sess\n-                            .delay_span_bug(call_expr.span, \"input to call/call_mut is not a ref?\");\n+                            .delay_span_bug(call_expr.span, \"input to call/call_mut is not a ref\");\n                         return None;\n                     };\n \n@@ -271,6 +280,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                         target: method.sig.inputs()[0],\n                     });\n                 }\n+\n                 return Some((autoref, method));\n             }\n         }\n@@ -823,7 +833,7 @@ impl<'a, 'tcx> DeferredCallResolution<'tcx> {\n                 );\n                 err.help(\n                     \"make sure the `fn`/`fn_mut`/`fn_once` lang items are defined \\\n-                     and have associated `call`/`call_mut`/`call_once` functions\",\n+                     and have correctly defined `call`/`call_mut`/`call_once` methods\",\n                 );\n                 err.emit();\n             }"}, {"sha": "ff603111e94c5cfb468ab4e26fc770667e912dfb", "filename": "tests/ui/lang-items/fn-fn_mut-call-ill-formed.bad_item.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.bad_item.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.bad_item.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.bad_item.stderr?ref=ff9c5db03cc4fad005b9e3651b42a6945a0d9f36", "patch": "@@ -4,15 +4,15 @@ error: failed to find an overloaded call trait for closure call\n LL |     a();\n    |     ^^^\n    |\n-   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have associated `call`/`call_mut`/`call_once` functions\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n error: failed to find an overloaded call trait for closure call\n   --> $DIR/fn-fn_mut-call-ill-formed.rs:43:5\n    |\n LL |     b();\n    |     ^^^\n    |\n-   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have associated `call`/`call_mut`/`call_once` functions\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n error: aborting due to 2 previous errors\n "}, {"sha": "ff603111e94c5cfb468ab4e26fc770667e912dfb", "filename": "tests/ui/lang-items/fn-fn_mut-call-ill-formed.bad_sig.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.bad_sig.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.bad_sig.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.bad_sig.stderr?ref=ff9c5db03cc4fad005b9e3651b42a6945a0d9f36", "patch": "@@ -4,15 +4,15 @@ error: failed to find an overloaded call trait for closure call\n LL |     a();\n    |     ^^^\n    |\n-   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have associated `call`/`call_mut`/`call_once` functions\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n error: failed to find an overloaded call trait for closure call\n   --> $DIR/fn-fn_mut-call-ill-formed.rs:43:5\n    |\n LL |     b();\n    |     ^^^\n    |\n-   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have associated `call`/`call_mut`/`call_once` functions\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n error: aborting due to 2 previous errors\n "}, {"sha": "02e33c597fe8776aac5dda70068b1574400dc73b", "filename": "tests/ui/lang-items/fn-fn_mut-call-ill-formed.fn_bad_item.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_bad_item.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_bad_item.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_bad_item.stderr?ref=ff9c5db03cc4fad005b9e3651b42a6945a0d9f36", "patch": "@@ -4,15 +4,15 @@ error: failed to find an overloaded call trait for closure call\n LL |     a();\n    |     ^^^\n    |\n-   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have associated `call`/`call_mut`/`call_once` functions\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n error: failed to find an overloaded call trait for closure call\n   --> $DIR/fn-fn_mut-call-ill-formed.rs:47:5\n    |\n LL |     b();\n    |     ^^^\n    |\n-   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have associated `call`/`call_mut`/`call_once` functions\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n error: aborting due to 2 previous errors\n "}, {"sha": "02e33c597fe8776aac5dda70068b1574400dc73b", "filename": "tests/ui/lang-items/fn-fn_mut-call-ill-formed.fn_bad_sig.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_bad_sig.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_bad_sig.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_bad_sig.stderr?ref=ff9c5db03cc4fad005b9e3651b42a6945a0d9f36", "patch": "@@ -4,15 +4,15 @@ error: failed to find an overloaded call trait for closure call\n LL |     a();\n    |     ^^^\n    |\n-   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have associated `call`/`call_mut`/`call_once` functions\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n error: failed to find an overloaded call trait for closure call\n   --> $DIR/fn-fn_mut-call-ill-formed.rs:47:5\n    |\n LL |     b();\n    |     ^^^\n    |\n-   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have associated `call`/`call_mut`/`call_once` functions\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n error: aborting due to 2 previous errors\n "}, {"sha": "02e33c597fe8776aac5dda70068b1574400dc73b", "filename": "tests/ui/lang-items/fn-fn_mut-call-ill-formed.fn_mut_bad_item.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_mut_bad_item.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_mut_bad_item.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_mut_bad_item.stderr?ref=ff9c5db03cc4fad005b9e3651b42a6945a0d9f36", "patch": "@@ -4,15 +4,15 @@ error: failed to find an overloaded call trait for closure call\n LL |     a();\n    |     ^^^\n    |\n-   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have associated `call`/`call_mut`/`call_once` functions\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n error: failed to find an overloaded call trait for closure call\n   --> $DIR/fn-fn_mut-call-ill-formed.rs:47:5\n    |\n LL |     b();\n    |     ^^^\n    |\n-   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have associated `call`/`call_mut`/`call_once` functions\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n error: aborting due to 2 previous errors\n "}, {"sha": "02e33c597fe8776aac5dda70068b1574400dc73b", "filename": "tests/ui/lang-items/fn-fn_mut-call-ill-formed.fn_mut_bad_sig.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_mut_bad_sig.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_mut_bad_sig.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_mut_bad_sig.stderr?ref=ff9c5db03cc4fad005b9e3651b42a6945a0d9f36", "patch": "@@ -4,15 +4,15 @@ error: failed to find an overloaded call trait for closure call\n LL |     a();\n    |     ^^^\n    |\n-   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have associated `call`/`call_mut`/`call_once` functions\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n error: failed to find an overloaded call trait for closure call\n   --> $DIR/fn-fn_mut-call-ill-formed.rs:47:5\n    |\n LL |     b();\n    |     ^^^\n    |\n-   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have associated `call`/`call_mut`/`call_once` functions\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n error: aborting due to 2 previous errors\n "}, {"sha": "02e33c597fe8776aac5dda70068b1574400dc73b", "filename": "tests/ui/lang-items/fn-fn_mut-call-ill-formed.fn_once_bad_item.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_once_bad_item.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_once_bad_item.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_once_bad_item.stderr?ref=ff9c5db03cc4fad005b9e3651b42a6945a0d9f36", "patch": "@@ -4,15 +4,15 @@ error: failed to find an overloaded call trait for closure call\n LL |     a();\n    |     ^^^\n    |\n-   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have associated `call`/`call_mut`/`call_once` functions\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n error: failed to find an overloaded call trait for closure call\n   --> $DIR/fn-fn_mut-call-ill-formed.rs:47:5\n    |\n LL |     b();\n    |     ^^^\n    |\n-   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have associated `call`/`call_mut`/`call_once` functions\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n error: aborting due to 2 previous errors\n "}, {"sha": "02e33c597fe8776aac5dda70068b1574400dc73b", "filename": "tests/ui/lang-items/fn-fn_mut-call-ill-formed.fn_once_bad_sig.stderr", "status": "modified", "additions": 13, "deletions": 4, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_once_bad_sig.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_once_bad_sig.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flang-items%2Ffn-fn_mut-call-ill-formed.fn_once_bad_sig.stderr?ref=ff9c5db03cc4fad005b9e3651b42a6945a0d9f36", "patch": "@@ -1,9 +1,18 @@\n-error[E0308]: mismatched types\n+error: failed to find an overloaded call trait for closure call\n+  --> $DIR/fn-fn_mut-call-ill-formed.rs:42:5\n+   |\n+LL |     a();\n+   |     ^^^\n+   |\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n+\n+error: failed to find an overloaded call trait for closure call\n   --> $DIR/fn-fn_mut-call-ill-formed.rs:47:5\n    |\n LL |     b();\n-   |     ^^^ expected `i32`, found `()`\n+   |     ^^^\n+   |\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n-error: aborting due to previous error\n+error: aborting due to 2 previous errors\n \n-For more information about this error, try `rustc --explain E0308`."}, {"sha": "c6e811a94fe2065187aae3684f5bcc3ba328207f", "filename": "tests/ui/lang-items/issue-86238.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Fissue-86238.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ff9c5db03cc4fad005b9e3651b42a6945a0d9f36/tests%2Fui%2Flang-items%2Fissue-86238.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flang-items%2Fissue-86238.stderr?ref=ff9c5db03cc4fad005b9e3651b42a6945a0d9f36", "patch": "@@ -4,7 +4,7 @@ error: failed to find an overloaded call trait for closure call\n LL |     one()\n    |     ^^^^^\n    |\n-   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have associated `call`/`call_mut`/`call_once` functions\n+   = help: make sure the `fn`/`fn_mut`/`fn_once` lang items are defined and have correctly defined `call`/`call_mut`/`call_once` methods\n \n error: aborting due to previous error\n "}]}