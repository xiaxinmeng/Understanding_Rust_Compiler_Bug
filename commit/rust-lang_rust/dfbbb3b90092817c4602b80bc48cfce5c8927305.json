{"sha": "dfbbb3b90092817c4602b80bc48cfce5c8927305", "node_id": "C_kwDOAAsO6NoAKGRmYmJiM2I5MDA5MjgxN2M0NjAyYjgwYmM0OGNmY2U1Yzg5MjczMDU", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2021-11-18T17:22:59Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-11-18T17:22:59Z"}, "message": "Rollup merge of #90989 - notriddle:notriddle/rustc-suggest-float-ending-in-dot, r=sanxiyn\n\nAvoid suggesting literal formatting that turns into member access\n\nFixes #90974", "tree": {"sha": "5f4f35ba5dc246744572f75aa1c638d99e8bfbb1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5f4f35ba5dc246744572f75aa1c638d99e8bfbb1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/dfbbb3b90092817c4602b80bc48cfce5c8927305", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhlovzCRBK7hj4Ov3rIwAAkw0IAAtiWwLaVKnz4AaoeZOlgW11\nFMJk5UPzQNaQhCK5NCkRfkyajJW4p8br54h00V8VP3+BEef5cSd59QJBvniOlKZg\nFaxu/Bf38Vm+8l+Dji9tgFJ5jA51jLPvgxh+tNf/ftf5bpaxqFt9eDLtYLYet1Yz\nte6kPu71H4fx0Dj//CllbVc+vGvJNMQHVTpHZBLZINolhbLlHoHXr4+Y/oF/mmKd\nKh2N+Y4gpHo875aFZ4WPdEJM3qhzq2bA6D8YjnlYOjcmuHRNtw9UIrMuFjvVqXIm\nLi7+SypV9DhtasdnJOCm/wvEqKI9Fv1Sl5G6RATvbyjlLgd8Dlz+Hw1wK8FTiis=\n=0dJO\n-----END PGP SIGNATURE-----\n", "payload": "tree 5f4f35ba5dc246744572f75aa1c638d99e8bfbb1\nparent 0a2b7d71d96a22126cce57f0dab5890d060f2259\nparent a7261c32f485872756b8dc1544963a59e86c6449\nauthor Yuki Okushi <jtitor@2k36.org> 1637256179 +0900\ncommitter GitHub <noreply@github.com> 1637256179 +0900\n\nRollup merge of #90989 - notriddle:notriddle/rustc-suggest-float-ending-in-dot, r=sanxiyn\n\nAvoid suggesting literal formatting that turns into member access\n\nFixes #90974\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/dfbbb3b90092817c4602b80bc48cfce5c8927305", "html_url": "https://github.com/rust-lang/rust/commit/dfbbb3b90092817c4602b80bc48cfce5c8927305", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/dfbbb3b90092817c4602b80bc48cfce5c8927305/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0a2b7d71d96a22126cce57f0dab5890d060f2259", "url": "https://api.github.com/repos/rust-lang/rust/commits/0a2b7d71d96a22126cce57f0dab5890d060f2259", "html_url": "https://github.com/rust-lang/rust/commit/0a2b7d71d96a22126cce57f0dab5890d060f2259"}, {"sha": "a7261c32f485872756b8dc1544963a59e86c6449", "url": "https://api.github.com/repos/rust-lang/rust/commits/a7261c32f485872756b8dc1544963a59e86c6449", "html_url": "https://github.com/rust-lang/rust/commit/a7261c32f485872756b8dc1544963a59e86c6449"}], "stats": {"total": 23, "additions": 22, "deletions": 1}, "files": [{"sha": "f96e9063c345c7977d2b8adf3b89a1a6a750af48", "filename": "compiler/rustc_typeck/src/check/method/suggest.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/dfbbb3b90092817c4602b80bc48cfce5c8927305/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fsuggest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dfbbb3b90092817c4602b80bc48cfce5c8927305/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fsuggest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fsuggest.rs?ref=dfbbb3b90092817c4602b80bc48cfce5c8927305", "patch": "@@ -317,14 +317,18 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                                     .span_to_snippet(lit.span)\n                                     .unwrap_or_else(|_| \"<numeric literal>\".to_owned());\n \n+                                // If this is a floating point literal that ends with '.',\n+                                // get rid of it to stop this from becoming a member access.\n+                                let snippet = snippet.strip_suffix('.').unwrap_or(&snippet);\n+\n                                 err.span_suggestion(\n                                     lit.span,\n                                     &format!(\n                                         \"you must specify a concrete type for this numeric value, \\\n                                          like `{}`\",\n                                         concrete_type\n                                     ),\n-                                    format!(\"{}_{}\", snippet, concrete_type),\n+                                    format!(\"{snippet}_{concrete_type}\"),\n                                     Applicability::MaybeIncorrect,\n                                 );\n                             }"}, {"sha": "83590dbf7ace7511523965bca7b011c64a6ca294", "filename": "src/test/ui/suggestions/issue-90974.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/dfbbb3b90092817c4602b80bc48cfce5c8927305/src%2Ftest%2Fui%2Fsuggestions%2Fissue-90974.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dfbbb3b90092817c4602b80bc48cfce5c8927305/src%2Ftest%2Fui%2Fsuggestions%2Fissue-90974.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsuggestions%2Fissue-90974.rs?ref=dfbbb3b90092817c4602b80bc48cfce5c8927305", "patch": "@@ -0,0 +1,3 @@\n+fn main() {\n+    println!(\"{}\", (3.).recip()); //~ERROR\n+}"}, {"sha": "e1fb479a3a7a0a0e2ef26f48bf32a976d3f11b68", "filename": "src/test/ui/suggestions/issue-90974.stderr", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/dfbbb3b90092817c4602b80bc48cfce5c8927305/src%2Ftest%2Fui%2Fsuggestions%2Fissue-90974.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/dfbbb3b90092817c4602b80bc48cfce5c8927305/src%2Ftest%2Fui%2Fsuggestions%2Fissue-90974.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsuggestions%2Fissue-90974.stderr?ref=dfbbb3b90092817c4602b80bc48cfce5c8927305", "patch": "@@ -0,0 +1,14 @@\n+error[E0689]: can't call method `recip` on ambiguous numeric type `{float}`\n+  --> $DIR/issue-90974.rs:2:25\n+   |\n+LL |     println!(\"{}\", (3.).recip());\n+   |                         ^^^^^\n+   |\n+help: you must specify a concrete type for this numeric value, like `f32`\n+   |\n+LL |     println!(\"{}\", (3_f32).recip());\n+   |                     ~~~~~\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0689`."}]}