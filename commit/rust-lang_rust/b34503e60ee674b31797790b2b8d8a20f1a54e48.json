{"sha": "b34503e60ee674b31797790b2b8d8a20f1a54e48", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIzNDUwM2U2MGVlNjc0YjMxNzk3NzkwYjJiOGQ4YTIwZjFhNTRlNDg=", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2018-08-17T21:52:34Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2018-08-22T22:13:17Z"}, "message": "Stabilize a few secondary macro features\n\n`tool_attributes`, `proc_macro_path_invoc`, partially `proc_macro_gen`", "tree": {"sha": "c4123ae60902eb6a225a264e16bc8ce4115fcfd7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c4123ae60902eb6a225a264e16bc8ce4115fcfd7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b34503e60ee674b31797790b2b8d8a20f1a54e48", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b34503e60ee674b31797790b2b8d8a20f1a54e48", "html_url": "https://github.com/rust-lang/rust/commit/b34503e60ee674b31797790b2b8d8a20f1a54e48", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b34503e60ee674b31797790b2b8d8a20f1a54e48/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b75b0471a8b87c44e0bd953d2a5c36d896128723", "url": "https://api.github.com/repos/rust-lang/rust/commits/b75b0471a8b87c44e0bd953d2a5c36d896128723", "html_url": "https://github.com/rust-lang/rust/commit/b75b0471a8b87c44e0bd953d2a5c36d896128723"}], "stats": {"total": 158, "additions": 27, "deletions": 131}, "files": [{"sha": "15fc84a3e2a3dad17eb2f2a2115c6c6f45fc6f02", "filename": "src/doc/unstable-book/src/language-features/tool-attributes.md", "status": "removed", "additions": 0, "deletions": 26, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/b75b0471a8b87c44e0bd953d2a5c36d896128723/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Ftool-attributes.md", "raw_url": "https://github.com/rust-lang/rust/raw/b75b0471a8b87c44e0bd953d2a5c36d896128723/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Ftool-attributes.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Ftool-attributes.md?ref=b75b0471a8b87c44e0bd953d2a5c36d896128723", "patch": "@@ -1,26 +0,0 @@\n-# `tool_attributes`\n-\n-The tracking issue for this feature is: [#44690]\n-\n-[#44690]: https://github.com/rust-lang/rust/issues/44690\n-\n-------------------------\n-\n-Tool attributes let you use scoped attributes to control the behavior\n-of certain tools.\n-\n-Currently tool names which can be appear in scoped attributes are restricted to\n-`clippy` and `rustfmt`.\n-\n-## An example\n-\n-```rust\n-#![feature(tool_attributes)]\n-\n-#[rustfmt::skip]\n-fn foo() { println!(\"hello, world\"); }\n-\n-fn main() {\n-    foo();\n-}\n-```"}, {"sha": "382a53b720ac123205f8930af6675210c78eda1b", "filename": "src/librustc_resolve/macros.rs", "status": "modified", "additions": 0, "deletions": 15, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Flibrustc_resolve%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Flibrustc_resolve%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Fmacros.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -367,17 +367,6 @@ impl<'a, 'cl> Resolver<'a, 'cl> {\n \n         let def = def?;\n \n-        if path.segments.len() > 1 {\n-            if kind != MacroKind::Bang {\n-                if def != Def::NonMacroAttr(NonMacroAttrKind::Tool) &&\n-                   !self.session.features_untracked().proc_macro_path_invoc {\n-                    let msg = format!(\"non-ident {} paths are unstable\", kind.descr());\n-                    emit_feature_err(&self.session.parse_sess, \"proc_macro_path_invoc\",\n-                                     path.span, GateIssue::Language, &msg);\n-                }\n-            }\n-        }\n-\n         match def {\n             Def::Macro(def_id, macro_kind) => {\n                 self.unused_macros.remove(&def_id);\n@@ -390,10 +379,6 @@ impl<'a, 'cl> Resolver<'a, 'cl> {\n             Def::NonMacroAttr(attr_kind) => {\n                 if kind == MacroKind::Attr {\n                     let features = self.session.features_untracked();\n-                    if attr_kind == NonMacroAttrKind::Tool && !features.tool_attributes {\n-                        feature_err(&self.session.parse_sess, \"tool_attributes\", path.span,\n-                                    GateIssue::Language, \"tool attributes are unstable\").emit();\n-                    }\n                     if attr_kind == NonMacroAttrKind::Custom {\n                         assert!(path.segments.len() == 1);\n                         let name = path.segments[0].ident.name.as_str();"}, {"sha": "494f6d29832dda19946a167002a63b330558f12c", "filename": "src/libsyntax/ext/expand.rs", "status": "modified", "additions": 5, "deletions": 10, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Flibsyntax%2Fext%2Fexpand.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Flibsyntax%2Fext%2Fexpand.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Fexpand.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -666,30 +666,25 @@ impl<'a, 'b> MacroExpander<'a, 'b> {\n             None => return,\n         };\n \n-        fragment.visit_with(&mut DisallowModules {\n+        fragment.visit_with(&mut DisallowMacros {\n             span,\n             parse_sess: self.cx.parse_sess,\n         });\n \n-        struct DisallowModules<'a> {\n+        struct DisallowMacros<'a> {\n             span: Span,\n             parse_sess: &'a ParseSess,\n         }\n \n-        impl<'ast, 'a> Visitor<'ast> for DisallowModules<'a> {\n+        impl<'ast, 'a> Visitor<'ast> for DisallowMacros<'a> {\n             fn visit_item(&mut self, i: &'ast ast::Item) {\n-                let name = match i.node {\n-                    ast::ItemKind::Mod(_) => Some(\"modules\"),\n-                    ast::ItemKind::MacroDef(_) => Some(\"macro definitions\"),\n-                    _ => None,\n-                };\n-                if let Some(name) = name {\n+                if let ast::ItemKind::MacroDef(_) = i.node {\n                     emit_feature_err(\n                         self.parse_sess,\n                         \"proc_macro_gen\",\n                         self.span,\n                         GateIssue::Language,\n-                        &format!(\"procedural macros cannot expand to {}\", name),\n+                        &format!(\"procedural macros cannot expand to macro definitions\"),\n                     );\n                 }\n                 visit::walk_item(self, i);"}, {"sha": "5e569025ab377591858d6d7689dd73a34b5bb17d", "filename": "src/libsyntax/feature_gate.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Flibsyntax%2Ffeature_gate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Flibsyntax%2Ffeature_gate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ffeature_gate.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -438,9 +438,6 @@ declare_features! (\n     (active, tbm_target_feature, \"1.27.0\", Some(44839), None),\n     (active, wasm_target_feature, \"1.30.0\", Some(44839), None),\n \n-    // Allows macro invocations of the form `#[foo::bar]`\n-    (active, proc_macro_path_invoc, \"1.27.0\", Some(38356), None),\n-\n     // Allows macro invocations on modules expressions and statements and\n     // procedural macros to expand to non-items.\n     (active, proc_macro_mod, \"1.27.0\", Some(38356), None),\n@@ -454,8 +451,6 @@ declare_features! (\n     // Access to crate names passed via `--extern` through prelude\n     (active, extern_prelude, \"1.27.0\", Some(44660), Some(Edition::Edition2018)),\n \n-    // Scoped attributes\n-    (active, tool_attributes, \"1.25.0\", Some(44690), None),\n     // Scoped lints\n     (active, tool_lints, \"1.28.0\", Some(44690), None),\n \n@@ -652,6 +647,10 @@ declare_features! (\n     (accepted, use_extern_macros, \"1.30.0\", Some(35896), None),\n     // Allows keywords to be escaped for use as identifiers\n     (accepted, raw_identifiers, \"1.30.0\", Some(48589), None),\n+    // Attributes scoped to tools\n+    (accepted, tool_attributes, \"1.30.0\", Some(44690), None),\n+    // Allows multi-segment paths in attributes and derives\n+    (accepted, proc_macro_path_invoc, \"1.30.0\", Some(38356), None),\n );\n \n // If you change this, please modify src/doc/unstable-book as well. You must"}, {"sha": "67fe93058aa8936270017b6c3eeee0b72c2c415d", "filename": "src/test/compile-fail-fulldeps/proc-macro/auxiliary/more-gates.rs", "status": "modified", "additions": 0, "deletions": 11, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fcompile-fail-fulldeps%2Fproc-macro%2Fauxiliary%2Fmore-gates.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fcompile-fail-fulldeps%2Fproc-macro%2Fauxiliary%2Fmore-gates.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail-fulldeps%2Fproc-macro%2Fauxiliary%2Fmore-gates.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -16,11 +16,6 @@ extern crate proc_macro;\n \n use proc_macro::*;\n \n-#[proc_macro_attribute]\n-pub fn attr2mod(_: TokenStream, _: TokenStream) -> TokenStream {\n-    \"mod test {}\".parse().unwrap()\n-}\n-\n #[proc_macro_attribute]\n pub fn attr2mac1(_: TokenStream, _: TokenStream) -> TokenStream {\n     \"macro_rules! foo1 { (a) => (a) }\".parse().unwrap()\n@@ -31,11 +26,6 @@ pub fn attr2mac2(_: TokenStream, _: TokenStream) -> TokenStream {\n     \"macro foo2(a) { a }\".parse().unwrap()\n }\n \n-#[proc_macro]\n-pub fn mac2mod(_: TokenStream) -> TokenStream {\n-    \"mod test2 {}\".parse().unwrap()\n-}\n-\n #[proc_macro]\n pub fn mac2mac1(_: TokenStream) -> TokenStream {\n     \"macro_rules! foo3 { (a) => (a) }\".parse().unwrap()\n@@ -49,7 +39,6 @@ pub fn mac2mac2(_: TokenStream) -> TokenStream {\n #[proc_macro]\n pub fn tricky(_: TokenStream) -> TokenStream {\n     \"fn foo() {\n-        mod test {}\n         macro_rules! foo { (a) => (a) }\n     }\".parse().unwrap()\n }"}, {"sha": "4c038179544ffff75f9ca952fbcf82ff8ee43a64", "filename": "src/test/compile-fail-fulldeps/proc-macro/more-gates.rs", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fcompile-fail-fulldeps%2Fproc-macro%2Fmore-gates.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fcompile-fail-fulldeps%2Fproc-macro%2Fmore-gates.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail-fulldeps%2Fproc-macro%2Fmore-gates.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -14,22 +14,17 @@ extern crate more_gates as foo;\n \n use foo::*;\n \n-#[attr2mod]\n-//~^ ERROR: cannot expand to modules\n-pub fn a() {}\n #[attr2mac1]\n //~^ ERROR: cannot expand to macro definitions\n pub fn a() {}\n #[attr2mac2]\n //~^ ERROR: cannot expand to macro definitions\n pub fn a() {}\n \n-mac2mod!(); //~ ERROR: cannot expand to modules\n mac2mac1!(); //~ ERROR: cannot expand to macro definitions\n mac2mac2!(); //~ ERROR: cannot expand to macro definitions\n \n tricky!();\n-//~^ ERROR: cannot expand to modules\n-//~| ERROR: cannot expand to macro definitions\n+//~^ ERROR: cannot expand to macro definitions\n \n fn main() {}"}, {"sha": "5cf65103ba3ebd61cde98e0737e4617678b29139", "filename": "src/test/compile-fail-fulldeps/proc-macro/proc-macro-gates.rs", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fcompile-fail-fulldeps%2Fproc-macro%2Fproc-macro-gates.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fcompile-fail-fulldeps%2Fproc-macro%2Fproc-macro-gates.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail-fulldeps%2Fproc-macro%2Fproc-macro-gates.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -10,7 +10,6 @@\n \n // aux-build:proc-macro-gates.rs\n // gate-test-proc_macro_non_items\n-// gate-test-proc_macro_path_invoc\n // gate-test-proc_macro_mod line\n // gate-test-proc_macro_expr\n // gate-test-proc_macro_mod\n@@ -22,20 +21,15 @@ extern crate proc_macro_gates as foo;\n \n use foo::*;\n \n-#[foo::a] //~ ERROR: non-ident attribute macro paths are unstable\n-fn _test() {}\n-\n fn _test_inner() {\n     #![a] // OK\n }\n \n #[a] //~ ERROR: custom attributes cannot be applied to modules\n-//~| ERROR: procedural macros cannot expand to modules\n mod _test2 {}\n \n mod _test2_inner {\n     #![a] //~ ERROR: custom attributes cannot be applied to modules\n-    //~| ERROR: procedural macros cannot expand to modules\n }\n \n #[a = y] //~ ERROR: must only be followed by a delimiter token"}, {"sha": "ac9eca38226691a2e33cf68e5db1ede16122423d", "filename": "src/test/run-pass-fulldeps/proc-macro/derive-b.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fderive-b.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fderive-b.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fderive-b.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -11,7 +11,7 @@\n // aux-build:derive-b.rs\n // ignore-stage1\n \n-#![feature(proc_macro_path_invoc, unrestricted_attribute_tokens)]\n+#![feature(unrestricted_attribute_tokens)]\n \n extern crate derive_b;\n "}, {"sha": "7bbdbc6505db5d40bc2a46dd642306f4a8de3552", "filename": "src/test/run-pass-fulldeps/proc-macro/issue-42708.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fissue-42708.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fissue-42708.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fissue-42708.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -11,7 +11,7 @@\n // aux-build:issue-42708.rs\n // ignore-stage1\n \n-#![feature(decl_macro, proc_macro_path_invoc)]\n+#![feature(decl_macro)]\n #![allow(unused)]\n \n extern crate issue_42708;"}, {"sha": "410faaeb3eeaccf7d646abcdcfa3797ee346d0a5", "filename": "src/test/run-pass-fulldeps/proc-macro/issue-50061.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fissue-50061.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fissue-50061.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fissue-50061.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -11,7 +11,7 @@\n // aux-build:issue-50061.rs\n // ignore-stage1\n \n-#![feature(proc_macro_path_invoc, decl_macro)]\n+#![feature(decl_macro)]\n \n extern crate issue_50061;\n "}, {"sha": "9d8e56e44cbb3c71847adc180661fadb6cf4c9a7", "filename": "src/test/run-pass/tool_attributes.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Frun-pass%2Ftool_attributes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Frun-pass%2Ftool_attributes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Ftool_attributes.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -10,7 +10,6 @@\n \n // Scoped attributes should not trigger an unused attributes lint.\n \n-#![feature(tool_attributes)]\n #![deny(unused_attributes)]\n \n fn main() {"}, {"sha": "977faf7decdf50741f1acd147a92a546a79c32ef", "filename": "src/test/ui-fulldeps/proc-macro/generate-mod.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui-fulldeps%2Fproc-macro%2Fgenerate-mod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui-fulldeps%2Fproc-macro%2Fgenerate-mod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui-fulldeps%2Fproc-macro%2Fgenerate-mod.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -12,8 +12,6 @@\n \n // aux-build:generate-mod.rs\n \n-#![feature(proc_macro_gen, proc_macro_path_invoc)]\n-\n extern crate generate_mod;\n \n struct FromOutside;"}, {"sha": "a981b1bc8b85a2930522ea6bc0ef59f73c533c5d", "filename": "src/test/ui-fulldeps/proc-macro/generate-mod.stderr", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui-fulldeps%2Fproc-macro%2Fgenerate-mod.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui-fulldeps%2Fproc-macro%2Fgenerate-mod.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui-fulldeps%2Fproc-macro%2Fgenerate-mod.stderr?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -1,29 +1,29 @@\n error[E0412]: cannot find type `FromOutside` in this scope\n-  --> $DIR/generate-mod.rs:21:1\n+  --> $DIR/generate-mod.rs:19:1\n    |\n LL | generate_mod::check!(); //~ ERROR cannot find type `FromOutside` in this scope\n    | ^^^^^^^^^^^^^^^^^^^^^^^ not found in this scope\n \n error[E0412]: cannot find type `Outer` in this scope\n-  --> $DIR/generate-mod.rs:21:1\n+  --> $DIR/generate-mod.rs:19:1\n    |\n LL | generate_mod::check!(); //~ ERROR cannot find type `FromOutside` in this scope\n    | ^^^^^^^^^^^^^^^^^^^^^^^ not found in this scope\n \n error[E0412]: cannot find type `FromOutside` in this scope\n-  --> $DIR/generate-mod.rs:24:1\n+  --> $DIR/generate-mod.rs:22:1\n    |\n LL | #[generate_mod::check_attr] //~ ERROR cannot find type `FromOutside` in this scope\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^ not found in this scope\n \n error[E0412]: cannot find type `OuterAttr` in this scope\n-  --> $DIR/generate-mod.rs:24:1\n+  --> $DIR/generate-mod.rs:22:1\n    |\n LL | #[generate_mod::check_attr] //~ ERROR cannot find type `FromOutside` in this scope\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^ not found in this scope\n \n warning: cannot find type `FromOutside` in this scope\n-  --> $DIR/generate-mod.rs:28:10\n+  --> $DIR/generate-mod.rs:26:10\n    |\n LL | #[derive(generate_mod::CheckDerive)] //~ WARN cannot find type `FromOutside` in this scope\n    |          ^^^^^^^^^^^^^^^^^^^^^^^^^ names from parent modules are not accessible without an explicit import\n@@ -33,7 +33,7 @@ LL | #[derive(generate_mod::CheckDerive)] //~ WARN cannot find type `FromOutside\n    = note: for more information, see issue #50504 <https://github.com/rust-lang/rust/issues/50504>\n \n warning: cannot find type `OuterDerive` in this scope\n-  --> $DIR/generate-mod.rs:28:10\n+  --> $DIR/generate-mod.rs:26:10\n    |\n LL | #[derive(generate_mod::CheckDerive)] //~ WARN cannot find type `FromOutside` in this scope\n    |          ^^^^^^^^^^^^^^^^^^^^^^^^^ names from parent modules are not accessible without an explicit import\n@@ -42,7 +42,7 @@ LL | #[derive(generate_mod::CheckDerive)] //~ WARN cannot find type `FromOutside\n    = note: for more information, see issue #50504 <https://github.com/rust-lang/rust/issues/50504>\n \n warning: cannot find type `FromOutside` in this scope\n-  --> $DIR/generate-mod.rs:35:14\n+  --> $DIR/generate-mod.rs:33:14\n    |\n LL |     #[derive(generate_mod::CheckDerive)] //~ WARN cannot find type `FromOutside` in this scope\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^ names from parent modules are not accessible without an explicit import\n@@ -51,7 +51,7 @@ LL |     #[derive(generate_mod::CheckDerive)] //~ WARN cannot find type `FromOut\n    = note: for more information, see issue #50504 <https://github.com/rust-lang/rust/issues/50504>\n \n warning: cannot find type `OuterDerive` in this scope\n-  --> $DIR/generate-mod.rs:35:14\n+  --> $DIR/generate-mod.rs:33:14\n    |\n LL |     #[derive(generate_mod::CheckDerive)] //~ WARN cannot find type `FromOutside` in this scope\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^ names from parent modules are not accessible without an explicit import"}, {"sha": "a8d82a35946498814ed182b94f7b36baf1fd718a", "filename": "src/test/ui/custom-attribute-multisegment.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Fcustom-attribute-multisegment.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Fcustom-attribute-multisegment.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcustom-attribute-multisegment.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -10,7 +10,7 @@\n \n // Unresolved multi-segment attributes are not treated as custom.\n \n-#![feature(custom_attribute, proc_macro_path_invoc)]\n+#![feature(custom_attribute)]\n \n mod existent {}\n "}, {"sha": "5aa1670b82888f9736776a1ae4b9f36b3248256d", "filename": "src/test/ui/feature-gates/feature-gate-tool_attributes.rs", "status": "removed", "additions": 0, "deletions": 15, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/b75b0471a8b87c44e0bd953d2a5c36d896128723/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-tool_attributes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b75b0471a8b87c44e0bd953d2a5c36d896128723/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-tool_attributes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-tool_attributes.rs?ref=b75b0471a8b87c44e0bd953d2a5c36d896128723", "patch": "@@ -1,15 +0,0 @@\n-// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n-// file at the top-level directory of this distribution and at\n-// http://rust-lang.org/COPYRIGHT.\n-//\n-// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n-// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n-// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n-// option. This file may not be copied, modified, or distributed\n-// except according to those terms.\n-\n-fn main() {\n-    #[rustfmt::skip] //~ ERROR tool attributes are unstable\n-    let x = 3\n-        ;\n-}"}, {"sha": "b024059d4501424b9720683b5f154e9fa6ccf0d0", "filename": "src/test/ui/feature-gates/feature-gate-tool_attributes.stderr", "status": "removed", "additions": 0, "deletions": 11, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/b75b0471a8b87c44e0bd953d2a5c36d896128723/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-tool_attributes.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b75b0471a8b87c44e0bd953d2a5c36d896128723/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-tool_attributes.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-tool_attributes.stderr?ref=b75b0471a8b87c44e0bd953d2a5c36d896128723", "patch": "@@ -1,11 +0,0 @@\n-error[E0658]: tool attributes are unstable (see issue #44690)\n-  --> $DIR/feature-gate-tool_attributes.rs:12:7\n-   |\n-LL |     #[rustfmt::skip] //~ ERROR tool attributes are unstable\n-   |       ^^^^^^^^^^^^^\n-   |\n-   = help: add #![feature(tool_attributes)] to the crate attributes to enable\n-\n-error: aborting due to previous error\n-\n-For more information about this error, try `rustc --explain E0658`."}, {"sha": "8d3cfb5a16706346e7fcd1900cb792f51a35e219", "filename": "src/test/ui/tool-attributes/tool-attributes-misplaced-1.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-misplaced-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-misplaced-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-misplaced-1.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -8,7 +8,7 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-#![feature(tool_attributes, custom_attribute)]\n+#![feature(custom_attribute)]\n \n type A = rustfmt; //~ ERROR expected type, found tool module `rustfmt`\n type B = rustfmt::skip; //~ ERROR expected type, found tool attribute `rustfmt::skip`"}, {"sha": "e61ea9d5b443f74fe90725795cf181819e07d5b6", "filename": "src/test/ui/tool-attributes/tool-attributes-misplaced-2.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-misplaced-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-misplaced-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-misplaced-2.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -8,8 +8,6 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-#![feature(tool_attributes)]\n-\n #[derive(rustfmt::skip)] //~ ERROR expected a macro, found tool attribute\n struct S;\n "}, {"sha": "ae47203a975802c050de96e3699e2733627c4443", "filename": "src/test/ui/tool-attributes/tool-attributes-misplaced-2.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-misplaced-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-misplaced-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-misplaced-2.stderr?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -1,11 +1,11 @@\n error: expected a macro, found tool attribute\n-  --> $DIR/tool-attributes-misplaced-2.rs:13:10\n+  --> $DIR/tool-attributes-misplaced-2.rs:11:10\n    |\n LL | #[derive(rustfmt::skip)] //~ ERROR expected a macro, found tool attribute\n    |          ^^^^^^^^^^^^^\n \n error: expected a macro, found tool attribute\n-  --> $DIR/tool-attributes-misplaced-2.rs:17:5\n+  --> $DIR/tool-attributes-misplaced-2.rs:15:5\n    |\n LL |     rustfmt::skip!(); //~ ERROR expected a macro, found tool attribute\n    |     ^^^^^^^^^^^^^"}, {"sha": "b6a24ccf748e1c3ba51254cfcd67cb884bb1d6c9", "filename": "src/test/ui/tool-attributes/tool-attributes-shadowing.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-shadowing.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-shadowing.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-shadowing.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -8,8 +8,6 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-#![feature(tool_attributes, proc_macro_path_invoc)]\n-\n mod rustfmt {}\n \n #[rustfmt::skip] //~ ERROR failed to resolve. Could not find `skip` in `rustfmt`"}, {"sha": "d593350f123c629351136bae9a2a06015f3abaa8", "filename": "src/test/ui/tool-attributes/tool-attributes-shadowing.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-shadowing.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-shadowing.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-shadowing.stderr?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -1,5 +1,5 @@\n error[E0433]: failed to resolve. Could not find `skip` in `rustfmt`\n-  --> $DIR/tool-attributes-shadowing.rs:15:12\n+  --> $DIR/tool-attributes-shadowing.rs:13:12\n    |\n LL | #[rustfmt::skip] //~ ERROR failed to resolve. Could not find `skip` in `rustfmt`\n    |            ^^^^ Could not find `skip` in `rustfmt`"}, {"sha": "cd2aeb7494a5a3202ea55c6e1001972cfe02877e", "filename": "src/test/ui/unknown-tool-name.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Funknown-tool-name.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Funknown-tool-name.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Funknown-tool-name.rs?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -8,7 +8,5 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-#![feature(proc_macro_path_invoc)]\n-\n #[foo::bar] //~ ERROR failed to resolve. Use of undeclared type or module `foo`\n fn main() {}"}, {"sha": "8381c6de83a6744a91e73809dac52955d24e5998", "filename": "src/test/ui/unknown-tool-name.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Funknown-tool-name.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b34503e60ee674b31797790b2b8d8a20f1a54e48/src%2Ftest%2Fui%2Funknown-tool-name.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Funknown-tool-name.stderr?ref=b34503e60ee674b31797790b2b8d8a20f1a54e48", "patch": "@@ -1,5 +1,5 @@\n error[E0433]: failed to resolve. Use of undeclared type or module `foo`\n-  --> $DIR/unknown-tool-name.rs:13:3\n+  --> $DIR/unknown-tool-name.rs:11:3\n    |\n LL | #[foo::bar] //~ ERROR failed to resolve. Use of undeclared type or module `foo`\n    |   ^^^ Use of undeclared type or module `foo`"}]}