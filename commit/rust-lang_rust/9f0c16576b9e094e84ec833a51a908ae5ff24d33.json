{"sha": "9f0c16576b9e094e84ec833a51a908ae5ff24d33", "node_id": "C_kwDOAAsO6NoAKDlmMGMxNjU3NmI5ZTA5NGU4NGVjODMzYTUxYTkwOGFlNWZmMjRkMzM", "commit": {"author": {"name": "SLASHLogin", "email": "loginmlgxd@gmail.com", "date": "2022-08-25T21:30:17Z"}, "committer": {"name": "SLASHLogin", "email": "loginmlgxd@gmail.com", "date": "2022-11-09T13:56:20Z"}, "message": "Port `symbol_already_defined` error", "tree": {"sha": "221c66bf1a33e0ca85fd50e472db1934267d9b0c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/221c66bf1a33e0ca85fd50e472db1934267d9b0c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9f0c16576b9e094e84ec833a51a908ae5ff24d33", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9f0c16576b9e094e84ec833a51a908ae5ff24d33", "html_url": "https://github.com/rust-lang/rust/commit/9f0c16576b9e094e84ec833a51a908ae5ff24d33", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9f0c16576b9e094e84ec833a51a908ae5ff24d33/comments", "author": {"login": "SLASHLogin", "id": 24846525, "node_id": "MDQ6VXNlcjI0ODQ2NTI1", "avatar_url": "https://avatars.githubusercontent.com/u/24846525?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SLASHLogin", "html_url": "https://github.com/SLASHLogin", "followers_url": "https://api.github.com/users/SLASHLogin/followers", "following_url": "https://api.github.com/users/SLASHLogin/following{/other_user}", "gists_url": "https://api.github.com/users/SLASHLogin/gists{/gist_id}", "starred_url": "https://api.github.com/users/SLASHLogin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SLASHLogin/subscriptions", "organizations_url": "https://api.github.com/users/SLASHLogin/orgs", "repos_url": "https://api.github.com/users/SLASHLogin/repos", "events_url": "https://api.github.com/users/SLASHLogin/events{/privacy}", "received_events_url": "https://api.github.com/users/SLASHLogin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "SLASHLogin", "id": 24846525, "node_id": "MDQ6VXNlcjI0ODQ2NTI1", "avatar_url": "https://avatars.githubusercontent.com/u/24846525?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SLASHLogin", "html_url": "https://github.com/SLASHLogin", "followers_url": "https://api.github.com/users/SLASHLogin/followers", "following_url": "https://api.github.com/users/SLASHLogin/following{/other_user}", "gists_url": "https://api.github.com/users/SLASHLogin/gists{/gist_id}", "starred_url": "https://api.github.com/users/SLASHLogin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SLASHLogin/subscriptions", "organizations_url": "https://api.github.com/users/SLASHLogin/orgs", "repos_url": "https://api.github.com/users/SLASHLogin/repos", "events_url": "https://api.github.com/users/SLASHLogin/events{/privacy}", "received_events_url": "https://api.github.com/users/SLASHLogin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4c625dc6824e3f07232239d618408eb4161d44a6", "url": "https://api.github.com/repos/rust-lang/rust/commits/4c625dc6824e3f07232239d618408eb4161d44a6", "html_url": "https://github.com/rust-lang/rust/commit/4c625dc6824e3f07232239d618408eb4161d44a6"}], "stats": {"total": 17, "additions": 13, "deletions": 4}, "files": [{"sha": "34b2c844f503216a1f6863623dffc7074d51c266", "filename": "compiler/rustc_codegen_llvm/src/errors.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/9f0c16576b9e094e84ec833a51a908ae5ff24d33/compiler%2Frustc_codegen_llvm%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f0c16576b9e094e84ec833a51a908ae5ff24d33/compiler%2Frustc_codegen_llvm%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_llvm%2Fsrc%2Ferrors.rs?ref=9f0c16576b9e094e84ec833a51a908ae5ff24d33", "patch": "@@ -2,6 +2,7 @@ use rustc_errors::fluent;\n use rustc_errors::DiagnosticBuilder;\n use rustc_macros::SessionDiagnostic;\n use rustc_session::SessionDiagnostic;\n+use rustc_span::Span;\n \n pub(crate) enum UnknownCTargetFeature<'a> {\n     UnknownFeaturePrefix { feature: &'a str },\n@@ -46,3 +47,11 @@ pub(crate) struct ErrorCreatingImportLibrary<'a> {\n #[derive(SessionDiagnostic)]\n #[diag(codegen_llvm::instrument_coverage_requires_llvm_12)]\n pub(crate) struct InstrumentCoverageRequiresLLVM12;\n+\n+#[derive(SessionDiagnostic)]\n+#[diag(codegen_llvm::SymbolAlreadyDefined)]\n+pub(crate) struct SymbolAlreadyDefined<'a> {\n+    #[primary_span]\n+    pub span: Span,\n+    pub symbol_name: &'a str,\n+}"}, {"sha": "d5096873c4378707ece903c8a16e8f45f4ce2d69", "filename": "compiler/rustc_codegen_llvm/src/mono_item.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/9f0c16576b9e094e84ec833a51a908ae5ff24d33/compiler%2Frustc_codegen_llvm%2Fsrc%2Fmono_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f0c16576b9e094e84ec833a51a908ae5ff24d33/compiler%2Frustc_codegen_llvm%2Fsrc%2Fmono_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_llvm%2Fsrc%2Fmono_item.rs?ref=9f0c16576b9e094e84ec833a51a908ae5ff24d33", "patch": "@@ -25,10 +25,7 @@ impl<'tcx> PreDefineMethods<'tcx> for CodegenCx<'_, 'tcx> {\n         let llty = self.layout_of(ty).llvm_type(self);\n \n         let g = self.define_global(symbol_name, llty).unwrap_or_else(|| {\n-            self.sess().span_fatal(\n-                self.tcx.def_span(def_id),\n-                &format!(\"symbol `{}` is already defined\", symbol_name),\n-            )\n+            self.sess().emit_fatal(SymbolAlreadyDefined { span: self.tcx.def_span(def_id), symbol_name })\n         });\n \n         unsafe {"}, {"sha": "c1222d3db5f769da4a1d9496113f6b13144ac58c", "filename": "compiler/rustc_error_messages/locales/en-US/codegen_llvm.ftl", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9f0c16576b9e094e84ec833a51a908ae5ff24d33/compiler%2Frustc_error_messages%2Flocales%2Fen-US%2Fcodegen_llvm.ftl", "raw_url": "https://github.com/rust-lang/rust/raw/9f0c16576b9e094e84ec833a51a908ae5ff24d33/compiler%2Frustc_error_messages%2Flocales%2Fen-US%2Fcodegen_llvm.ftl", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_messages%2Flocales%2Fen-US%2Fcodegen_llvm.ftl?ref=9f0c16576b9e094e84ec833a51a908ae5ff24d33", "patch": "@@ -18,3 +18,6 @@ codegen_llvm_error_creating_import_library =\n \n codegen_llvm_instrument_coverage_requires_llvm_12 =\n     rustc option `-C instrument-coverage` requires LLVM 12 or higher.\n+\n+codegen_llvm_symbol_already_defined = \n+    symbol `{$symbol_name}` is already defined"}]}