{"sha": "d286df1402f0e3a96e9ec11748e80c8be4bca92f", "node_id": "C_kwDOAAsO6NoAKGQyODZkZjE0MDJmMGUzYTk2ZTllYzExNzQ4ZTgwYzhiZTRiY2E5MmY", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-05-30T15:14:46Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-05-30T15:15:41Z"}, "message": "Add line number click GUI test", "tree": {"sha": "cbf54c6580da26ebdbcd36de868926c6b0289447", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cbf54c6580da26ebdbcd36de868926c6b0289447"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d286df1402f0e3a96e9ec11748e80c8be4bca92f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d286df1402f0e3a96e9ec11748e80c8be4bca92f", "html_url": "https://github.com/rust-lang/rust/commit/d286df1402f0e3a96e9ec11748e80c8be4bca92f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d286df1402f0e3a96e9ec11748e80c8be4bca92f/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "16d5cdc570b45a17a9c85953244ef6058929f608", "url": "https://api.github.com/repos/rust-lang/rust/commits/16d5cdc570b45a17a9c85953244ef6058929f608", "html_url": "https://github.com/rust-lang/rust/commit/16d5cdc570b45a17a9c85953244ef6058929f608"}], "stats": {"total": 12, "additions": 11, "deletions": 1}, "files": [{"sha": "509739c9f295165bb579ef9729a244f302b8a6bd", "filename": "src/test/rustdoc-gui/source-code-page.goml", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/d286df1402f0e3a96e9ec11748e80c8be4bca92f/src%2Ftest%2Frustdoc-gui%2Fsource-code-page.goml", "raw_url": "https://github.com/rust-lang/rust/raw/d286df1402f0e3a96e9ec11748e80c8be4bca92f/src%2Ftest%2Frustdoc-gui%2Fsource-code-page.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsource-code-page.goml?ref=d286df1402f0e3a96e9ec11748e80c8be4bca92f", "patch": "@@ -3,7 +3,7 @@ goto: file://|DOC_PATH|/src/test_docs/lib.rs.html\n // Check that we can click on the line number.\n click: \".line-numbers > span:nth-child(4)\" // This is the span for line 4.\n // Ensure that the page URL was updated.\n-assert-document-property: ({\"URL\": \"#4\"}, ENDS_WITH)\n+assert-document-property: ({\"URL\": \"lib.rs.html#4\"}, ENDS_WITH)\n assert-attribute: (\"//*[@id='4']\", {\"class\": \"line-highlighted\"})\n // We now check that the good spans are highlighted\n goto: file://|DOC_PATH|/src/test_docs/lib.rs.html#4-6\n@@ -17,3 +17,13 @@ compare-elements-position: (\"//*[@id='1']\", \".rust > code > span\", (\"y\"))\n \n // Assert that the line numbers text is aligned to the right.\n assert-css: (\".line-numbers\", {\"text-align\": \"right\"})\n+\n+// Now let's check that clicking on something else than the line number doesn't\n+// do anything (and certainly not add a `#NaN` to the URL!).\n+show-text: true\n+goto: file://|DOC_PATH|/src/test_docs/lib.rs.html\n+// We use this assert-position to know where we will click.\n+assert-position: (\"//*[@id='1']\", {\"x\": 104, \"y\": 103})\n+// We click on the left of the \"1\" span but still in the \"line-number\" `<pre>`.\n+click: (103, 103)\n+assert-document-property: ({\"URL\": \"/lib.rs.html\"}, ENDS_WITH)"}]}