{"sha": "8789ab10f93fb129649e34b5fa5f50ea2e8451c3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg3ODlhYjEwZjkzZmIxMjk2NDllMzRiNWZhNWY1MGVhMmU4NDUxYzM=", "commit": {"author": {"name": "Jakub Kulik", "email": "kulikjak@gmail.com", "date": "2021-05-13T10:40:06Z"}, "committer": {"name": "Jakub Kulik", "email": "kulikjak@gmail.com", "date": "2021-05-13T10:40:06Z"}, "message": "Update Docker to build the deprecated target alongside the new one", "tree": {"sha": "16776ef2864a26591daebad0dda8d144e278d877", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/16776ef2864a26591daebad0dda8d144e278d877"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8789ab10f93fb129649e34b5fa5f50ea2e8451c3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8789ab10f93fb129649e34b5fa5f50ea2e8451c3", "html_url": "https://github.com/rust-lang/rust/commit/8789ab10f93fb129649e34b5fa5f50ea2e8451c3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8789ab10f93fb129649e34b5fa5f50ea2e8451c3/comments", "author": {"login": "kulikjak", "id": 18516837, "node_id": "MDQ6VXNlcjE4NTE2ODM3", "avatar_url": "https://avatars.githubusercontent.com/u/18516837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kulikjak", "html_url": "https://github.com/kulikjak", "followers_url": "https://api.github.com/users/kulikjak/followers", "following_url": "https://api.github.com/users/kulikjak/following{/other_user}", "gists_url": "https://api.github.com/users/kulikjak/gists{/gist_id}", "starred_url": "https://api.github.com/users/kulikjak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kulikjak/subscriptions", "organizations_url": "https://api.github.com/users/kulikjak/orgs", "repos_url": "https://api.github.com/users/kulikjak/repos", "events_url": "https://api.github.com/users/kulikjak/events{/privacy}", "received_events_url": "https://api.github.com/users/kulikjak/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kulikjak", "id": 18516837, "node_id": "MDQ6VXNlcjE4NTE2ODM3", "avatar_url": "https://avatars.githubusercontent.com/u/18516837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kulikjak", "html_url": "https://github.com/kulikjak", "followers_url": "https://api.github.com/users/kulikjak/followers", "following_url": "https://api.github.com/users/kulikjak/following{/other_user}", "gists_url": "https://api.github.com/users/kulikjak/gists{/gist_id}", "starred_url": "https://api.github.com/users/kulikjak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kulikjak/subscriptions", "organizations_url": "https://api.github.com/users/kulikjak/orgs", "repos_url": "https://api.github.com/users/kulikjak/repos", "events_url": "https://api.github.com/users/kulikjak/events{/privacy}", "received_events_url": "https://api.github.com/users/kulikjak/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "631e98973868a0bfdcb91d42d7f2e9af1863721b", "url": "https://api.github.com/repos/rust-lang/rust/commits/631e98973868a0bfdcb91d42d7f2e9af1863721b", "html_url": "https://github.com/rust-lang/rust/commit/631e98973868a0bfdcb91d42d7f2e9af1863721b"}], "stats": {"total": 24, "additions": 10, "deletions": 14}, "files": [{"sha": "357ac7a2becb958d8bc64945093fb437d4435b64", "filename": "src/ci/docker/host-x86_64/dist-various-2/Dockerfile", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/8789ab10f93fb129649e34b5fa5f50ea2e8451c3/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-2%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/8789ab10f93fb129649e34b5fa5f50ea2e8451c3/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-2%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-2%2FDockerfile?ref=8789ab10f93fb129649e34b5fa5f50ea2e8451c3", "patch": "@@ -42,6 +42,9 @@ ENV \\\n     AR_x86_64_pc_solaris=x86_64-pc-solaris2.10-ar \\\n     CC_x86_64_pc_solaris=x86_64-pc-solaris2.10-gcc \\\n     CXX_x86_64_pc_solaris=x86_64-pc-solaris2.10-g++ \\\n+    AR_x86_64_sun_solaris=x86_64-sun-solaris2.10-ar \\\n+    CC_x86_64_sun_solaris=x86_64-sun-solaris2.10-gcc \\\n+    CXX_x86_64_sun_solaris=x86_64-sun-solaris2.10-g++ \\\n     CC_armv7_unknown_linux_gnueabi=arm-linux-gnueabi-gcc-8 \\\n     CXX_armv7_unknown_linux_gnueabi=arm-linux-gnueabi-g++-8 \\\n     AR_x86_64_fortanix_unknown_sgx=ar \\\n@@ -68,8 +71,10 @@ COPY host-x86_64/dist-various-2/shared.sh /tmp/\n COPY host-x86_64/dist-various-2/build-fuchsia-toolchain.sh /tmp/\n RUN /tmp/build-fuchsia-toolchain.sh\n COPY host-x86_64/dist-various-2/build-solaris-toolchain.sh /tmp/\n-RUN /tmp/build-solaris-toolchain.sh x86_64  amd64   solaris-i386\n-RUN /tmp/build-solaris-toolchain.sh sparcv9 sparcv9 solaris-sparc\n+RUN /tmp/build-solaris-toolchain.sh x86_64  amd64   solaris-i386  pc\n+# Build now deprecated Solaris target as well\n+RUN /tmp/build-solaris-toolchain.sh x86_64  amd64   solaris-i386  sun\n+RUN /tmp/build-solaris-toolchain.sh sparcv9 sparcv9 solaris-sparc sun\n COPY host-x86_64/dist-various-2/build-x86_64-fortanix-unknown-sgx-toolchain.sh /tmp/\n RUN /tmp/build-x86_64-fortanix-unknown-sgx-toolchain.sh\n \n@@ -99,6 +104,7 @@ ENV TARGETS=$TARGETS,wasm32-unknown-unknown\n ENV TARGETS=$TARGETS,wasm32-wasi\n ENV TARGETS=$TARGETS,sparcv9-sun-solaris\n ENV TARGETS=$TARGETS,x86_64-pc-solaris\n+ENV TARGETS=$TARGETS,x86_64-sun-solaris\n ENV TARGETS=$TARGETS,x86_64-unknown-linux-gnux32\n ENV TARGETS=$TARGETS,x86_64-fortanix-unknown-sgx\n ENV TARGETS=$TARGETS,nvptx64-nvidia-cuda"}, {"sha": "4cbc2ccfe3814c7164f5fc66050604d2b261b16b", "filename": "src/ci/docker/host-x86_64/dist-various-2/build-solaris-toolchain.sh", "status": "modified", "additions": 2, "deletions": 12, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/8789ab10f93fb129649e34b5fa5f50ea2e8451c3/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-2%2Fbuild-solaris-toolchain.sh", "raw_url": "https://github.com/rust-lang/rust/raw/8789ab10f93fb129649e34b5fa5f50ea2e8451c3/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-2%2Fbuild-solaris-toolchain.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-2%2Fbuild-solaris-toolchain.sh?ref=8789ab10f93fb129649e34b5fa5f50ea2e8451c3", "patch": "@@ -6,21 +6,11 @@ source shared.sh\n ARCH=$1\n LIB_ARCH=$2\n APT_ARCH=$3\n+MANUFACTURER=$4\n BINUTILS=2.28.1\n GCC=6.5.0\n \n-# Choose correct target based on the $ARCH\n-case \"$ARCH\" in\n-x86_64)\n-  TARGET=x86_64-pc-solaris2.10\n-  ;;\n-sparcv9)\n-  TARGET=sparcv9-sun-solaris2.10\n-  ;;\n-*)\n-  printf 'ERROR: unknown architecture: %s\\n' \"$ARCH\"\n-  exit 1\n-esac\n+TARGET=${ARCH}-${MANUFACTURER}-solaris2.10\n \n # First up, build binutils\n mkdir binutils"}]}