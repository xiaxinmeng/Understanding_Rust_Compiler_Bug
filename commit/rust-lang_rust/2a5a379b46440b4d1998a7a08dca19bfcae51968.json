{"sha": "2a5a379b46440b4d1998a7a08dca19bfcae51968", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJhNWEzNzliNDY0NDBiNGQxOTk4YTdhMDhkY2ExOWJmY2FlNTE5Njg=", "commit": {"author": {"name": "Alex Macleod", "email": "alex@macleod.io", "date": "2020-11-16T15:37:56Z"}, "committer": {"name": "Alex Macleod", "email": "alex@macleod.io", "date": "2020-11-16T23:13:45Z"}, "message": "Add two regression tests\n\nFor #78721 and #78722", "tree": {"sha": "71ee45bb40887ef387884e63dbabdf6e18c1550c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/71ee45bb40887ef387884e63dbabdf6e18c1550c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2a5a379b46440b4d1998a7a08dca19bfcae51968", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2a5a379b46440b4d1998a7a08dca19bfcae51968", "html_url": "https://github.com/rust-lang/rust/commit/2a5a379b46440b4d1998a7a08dca19bfcae51968", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2a5a379b46440b4d1998a7a08dca19bfcae51968/comments", "author": {"login": "Alexendoo", "id": 1830331, "node_id": "MDQ6VXNlcjE4MzAzMzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1830331?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Alexendoo", "html_url": "https://github.com/Alexendoo", "followers_url": "https://api.github.com/users/Alexendoo/followers", "following_url": "https://api.github.com/users/Alexendoo/following{/other_user}", "gists_url": "https://api.github.com/users/Alexendoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/Alexendoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Alexendoo/subscriptions", "organizations_url": "https://api.github.com/users/Alexendoo/orgs", "repos_url": "https://api.github.com/users/Alexendoo/repos", "events_url": "https://api.github.com/users/Alexendoo/events{/privacy}", "received_events_url": "https://api.github.com/users/Alexendoo/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Alexendoo", "id": 1830331, "node_id": "MDQ6VXNlcjE4MzAzMzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1830331?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Alexendoo", "html_url": "https://github.com/Alexendoo", "followers_url": "https://api.github.com/users/Alexendoo/followers", "following_url": "https://api.github.com/users/Alexendoo/following{/other_user}", "gists_url": "https://api.github.com/users/Alexendoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/Alexendoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Alexendoo/subscriptions", "organizations_url": "https://api.github.com/users/Alexendoo/orgs", "repos_url": "https://api.github.com/users/Alexendoo/repos", "events_url": "https://api.github.com/users/Alexendoo/events{/privacy}", "received_events_url": "https://api.github.com/users/Alexendoo/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f5230fbf76bafd86ee4376a0e26e551df8d17fec", "url": "https://api.github.com/repos/rust-lang/rust/commits/f5230fbf76bafd86ee4376a0e26e551df8d17fec", "html_url": "https://github.com/rust-lang/rust/commit/f5230fbf76bafd86ee4376a0e26e551df8d17fec"}], "stats": {"total": 90, "additions": 90, "deletions": 0}, "files": [{"sha": "f7dbef9e3ff02ad797b0f86e7d64281c01622ffb", "filename": "src/test/ui/impl-trait/issues/issue-78721.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/2a5a379b46440b4d1998a7a08dca19bfcae51968/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78721.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2a5a379b46440b4d1998a7a08dca19bfcae51968/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78721.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78721.rs?ref=2a5a379b46440b4d1998a7a08dca19bfcae51968", "patch": "@@ -0,0 +1,15 @@\n+// edition:2018\n+\n+#![feature(impl_trait_in_bindings)]\n+//~^ WARN the feature `impl_trait_in_bindings` is incomplete\n+\n+struct Bug {\n+    V1: [(); {\n+        let f: impl core::future::Future<Output = u8> = async { 1 };\n+        //~^ ERROR `async` blocks are not allowed in constants\n+        //~| ERROR destructors cannot be evaluated at compile-time\n+        1\n+    }],\n+}\n+\n+fn main() {}"}, {"sha": "353e882b1af61825437ec42cb4f5ba1c48bdee50", "filename": "src/test/ui/impl-trait/issues/issue-78721.stderr", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/2a5a379b46440b4d1998a7a08dca19bfcae51968/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78721.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2a5a379b46440b4d1998a7a08dca19bfcae51968/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78721.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78721.stderr?ref=2a5a379b46440b4d1998a7a08dca19bfcae51968", "patch": "@@ -0,0 +1,27 @@\n+warning: the feature `impl_trait_in_bindings` is incomplete and may not be safe to use and/or cause compiler crashes\n+  --> $DIR/issue-78721.rs:3:12\n+   |\n+LL | #![feature(impl_trait_in_bindings)]\n+   |            ^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+   = note: `#[warn(incomplete_features)]` on by default\n+   = note: see issue #63065 <https://github.com/rust-lang/rust/issues/63065> for more information\n+\n+error: `async` blocks are not allowed in constants\n+  --> $DIR/issue-78721.rs:8:57\n+   |\n+LL |         let f: impl core::future::Future<Output = u8> = async { 1 };\n+   |                                                         ^^^^^^^^^^^\n+\n+error[E0493]: destructors cannot be evaluated at compile-time\n+  --> $DIR/issue-78721.rs:8:13\n+   |\n+LL |         let f: impl core::future::Future<Output = u8> = async { 1 };\n+   |             ^ constants cannot evaluate destructors\n+...\n+LL |     }],\n+   |     - value is dropped here\n+\n+error: aborting due to 2 previous errors; 1 warning emitted\n+\n+For more information about this error, try `rustc --explain E0493`."}, {"sha": "58734d3a4455496be5c1312da9433314ec9518f7", "filename": "src/test/ui/impl-trait/issues/issue-78722.rs", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/2a5a379b46440b4d1998a7a08dca19bfcae51968/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78722.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2a5a379b46440b4d1998a7a08dca19bfcae51968/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78722.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78722.rs?ref=2a5a379b46440b4d1998a7a08dca19bfcae51968", "patch": "@@ -0,0 +1,21 @@\n+// edition:2018\n+\n+#![feature(type_alias_impl_trait)]\n+#![feature(impl_trait_in_bindings)]\n+//~^ WARN the feature `impl_trait_in_bindings` is incomplete\n+\n+type F = impl core::future::Future<Output = u8>;\n+\n+struct Bug {\n+    V1: [(); {\n+        fn concrete_use() -> F {\n+            async {}\n+        }\n+        let f: F = async { 1 };\n+        //~^ ERROR `async` blocks are not allowed in constants\n+        //~| ERROR destructors cannot be evaluated at compile-time\n+        1\n+    }],\n+}\n+\n+fn main() {}"}, {"sha": "0e1e92b912080d6ea01efbc7006f86cc5edb1442", "filename": "src/test/ui/impl-trait/issues/issue-78722.stderr", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/2a5a379b46440b4d1998a7a08dca19bfcae51968/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78722.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2a5a379b46440b4d1998a7a08dca19bfcae51968/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78722.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Fissue-78722.stderr?ref=2a5a379b46440b4d1998a7a08dca19bfcae51968", "patch": "@@ -0,0 +1,27 @@\n+warning: the feature `impl_trait_in_bindings` is incomplete and may not be safe to use and/or cause compiler crashes\n+  --> $DIR/issue-78722.rs:4:12\n+   |\n+LL | #![feature(impl_trait_in_bindings)]\n+   |            ^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+   = note: `#[warn(incomplete_features)]` on by default\n+   = note: see issue #63065 <https://github.com/rust-lang/rust/issues/63065> for more information\n+\n+error: `async` blocks are not allowed in constants\n+  --> $DIR/issue-78722.rs:14:20\n+   |\n+LL |         let f: F = async { 1 };\n+   |                    ^^^^^^^^^^^\n+\n+error[E0493]: destructors cannot be evaluated at compile-time\n+  --> $DIR/issue-78722.rs:14:13\n+   |\n+LL |         let f: F = async { 1 };\n+   |             ^ constants cannot evaluate destructors\n+...\n+LL |     }],\n+   |     - value is dropped here\n+\n+error: aborting due to 2 previous errors; 1 warning emitted\n+\n+For more information about this error, try `rustc --explain E0493`."}]}