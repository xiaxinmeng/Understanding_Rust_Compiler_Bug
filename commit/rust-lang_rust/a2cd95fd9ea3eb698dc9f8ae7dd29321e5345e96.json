{"sha": "a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEyY2Q5NWZkOWVhM2ViNjk4ZGM5ZjhhZTdkZDI5MzIxZTUzNDVlOTY=", "commit": {"author": {"name": "Alexander Regueiro", "email": "alexreg@me.com", "date": "2018-05-30T18:27:45Z"}, "committer": {"name": "Alexander Regueiro", "email": "alexreg@me.com", "date": "2018-06-30T22:52:33Z"}, "message": "Fixed bug with miri const evaluation where allocation is recursively borrowed.", "tree": {"sha": "13d9ec9ad20c59041fdea36e0f46c95529c3bae5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/13d9ec9ad20c59041fdea36e0f46c95529c3bae5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96", "html_url": "https://github.com/rust-lang/rust/commit/a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96/comments", "author": {"login": "alexreg", "id": 67036, "node_id": "MDQ6VXNlcjY3MDM2", "avatar_url": "https://avatars.githubusercontent.com/u/67036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexreg", "html_url": "https://github.com/alexreg", "followers_url": "https://api.github.com/users/alexreg/followers", "following_url": "https://api.github.com/users/alexreg/following{/other_user}", "gists_url": "https://api.github.com/users/alexreg/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexreg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexreg/subscriptions", "organizations_url": "https://api.github.com/users/alexreg/orgs", "repos_url": "https://api.github.com/users/alexreg/repos", "events_url": "https://api.github.com/users/alexreg/events{/privacy}", "received_events_url": "https://api.github.com/users/alexreg/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexreg", "id": 67036, "node_id": "MDQ6VXNlcjY3MDM2", "avatar_url": "https://avatars.githubusercontent.com/u/67036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexreg", "html_url": "https://github.com/alexreg", "followers_url": "https://api.github.com/users/alexreg/followers", "following_url": "https://api.github.com/users/alexreg/following{/other_user}", "gists_url": "https://api.github.com/users/alexreg/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexreg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexreg/subscriptions", "organizations_url": "https://api.github.com/users/alexreg/orgs", "repos_url": "https://api.github.com/users/alexreg/repos", "events_url": "https://api.github.com/users/alexreg/events{/privacy}", "received_events_url": "https://api.github.com/users/alexreg/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "349d53c2a90e7adc45b2c07bdb038cfb03669b37", "url": "https://api.github.com/repos/rust-lang/rust/commits/349d53c2a90e7adc45b2c07bdb038cfb03669b37", "html_url": "https://github.com/rust-lang/rust/commit/349d53c2a90e7adc45b2c07bdb038cfb03669b37"}], "stats": {"total": 10, "additions": 3, "deletions": 7}, "files": [{"sha": "8e1f24c3f016b733ba6d9bee6fa4f64b3c490f25", "filename": "src/librustc_mir/interpret/memory.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96/src%2Flibrustc_mir%2Finterpret%2Fmemory.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96/src%2Flibrustc_mir%2Finterpret%2Fmemory.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Fmemory.rs?ref=a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96", "patch": "@@ -305,7 +305,8 @@ impl<'a, 'mir, 'tcx, M: Machine<'mir, 'tcx>> Memory<'a, 'mir, 'tcx, M> {\n                 Some(alloc) => Ok(alloc),\n                 None => {\n                     // static alloc?\n-                    match self.tcx.alloc_map.lock().get(id) {\n+                    let alloc = self.tcx.alloc_map.lock().get(id);\n+                    match alloc {\n                         Some(AllocType::Memory(mem)) => Ok(mem),\n                         Some(AllocType::Function(..)) => {\n                             Err(EvalErrorKind::DerefFunctionPointer.into())"}, {"sha": "369f919471ca87f8637fe33118ecdf29f6010944", "filename": "src/test/compile-fail/issue-28324.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96/src%2Ftest%2Fcompile-fail%2Fissue-28324.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96/src%2Ftest%2Fcompile-fail%2Fissue-28324.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-28324.rs?ref=a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96", "patch": "@@ -16,5 +16,6 @@ extern {\n \n pub static BAZ: u32 = *&error_message_count;\n //~^ ERROR constant evaluation error\n+//~| tried to read foreign (extern) static\n \n fn main() {}"}, {"sha": "7248d0e543bdba2d138ebf308f15da3ef9c15c4e", "filename": "src/test/run-pass/auxiliary/pub_static_array.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96/src%2Ftest%2Frun-pass%2Fauxiliary%2Fpub_static_array.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96/src%2Ftest%2Frun-pass%2Fauxiliary%2Fpub_static_array.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fauxiliary%2Fpub_static_array.rs?ref=a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96", "previous_filename": "src/test/compile-fail/auxiliary/pub_static_array.rs"}, {"sha": "732d94cee8ed3f553a73551c9364855aa35990d1", "filename": "src/test/run-pass/static-array-across-crate.rs", "status": "renamed", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96/src%2Ftest%2Frun-pass%2Fstatic-array-across-crate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96/src%2Ftest%2Frun-pass%2Fstatic-array-across-crate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fstatic-array-across-crate.rs?ref=a2cd95fd9ea3eb698dc9f8ae7dd29321e5345e96", "patch": "@@ -15,13 +15,7 @@ extern crate pub_static_array as array;\n use array::ARRAY;\n \n static X: &'static u8 = &ARRAY[0];\n-//~^ ERROR: cannot refer to the interior of another static, use a constant\n-\n static Y: &'static u8 = &(&ARRAY)[0];\n-//~^ ERROR: cannot refer to the interior of another static, use a constant\n-\n static Z: u8 = (&ARRAY)[0];\n-//~^ ERROR: cannot refer to the interior of another static, use a constant\n-//~^^ ERROR: cannot refer to other statics by value\n \n pub fn main() {}", "previous_filename": "src/test/compile-fail/static-array-across-crate.rs"}]}