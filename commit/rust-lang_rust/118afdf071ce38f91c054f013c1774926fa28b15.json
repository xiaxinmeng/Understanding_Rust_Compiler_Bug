{"sha": "118afdf071ce38f91c054f013c1774926fa28b15", "node_id": "C_kwDOAAsO6NoAKDExOGFmZGYwNzFjZTM4ZjkxYzA1NGYwMTNjMTc3NDkyNmZhMjhiMTU", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2023-03-04T23:31:56Z"}, "committer": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2023-03-04T23:47:50Z"}, "message": "Retry pred_known_to_hold_modulo_regions with fulfillment if ambiguous", "tree": {"sha": "25fc2e00b88c030ccc809c3d8a61d3f21a627c29", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/25fc2e00b88c030ccc809c3d8a61d3f21a627c29"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/118afdf071ce38f91c054f013c1774926fa28b15", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/118afdf071ce38f91c054f013c1774926fa28b15", "html_url": "https://github.com/rust-lang/rust/commit/118afdf071ce38f91c054f013c1774926fa28b15", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/118afdf071ce38f91c054f013c1774926fa28b15/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "276b75a843af8822ffe4e395266d9445679a57a4", "url": "https://api.github.com/repos/rust-lang/rust/commits/276b75a843af8822ffe4e395266d9445679a57a4", "html_url": "https://github.com/rust-lang/rust/commit/276b75a843af8822ffe4e395266d9445679a57a4"}], "stats": {"total": 8, "additions": 5, "deletions": 3}, "files": [{"sha": "4e30108be94b811a4e4562036c426200d2c20d57", "filename": "compiler/rustc_trait_selection/src/traits/mod.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/118afdf071ce38f91c054f013c1774926fa28b15/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/118afdf071ce38f91c054f013c1774926fa28b15/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fmod.rs?ref=118afdf071ce38f91c054f013c1774926fa28b15", "patch": "@@ -155,10 +155,12 @@ fn pred_known_to_hold_modulo_regions<'tcx>(\n         predicate: pred.to_predicate(infcx.tcx),\n     };\n \n-    let result = infcx.predicate_must_hold_modulo_regions(&obligation);\n+    let result = infcx.evaluate_obligation_no_overflow(&obligation);\n     debug!(?result);\n \n-    if result && has_non_region_infer {\n+    if result.must_apply_modulo_regions() && !has_non_region_infer {\n+        true\n+    } else if result.may_apply() {\n         // Because of inference \"guessing\", selection can sometimes claim\n         // to succeed while the success requires a guess. To ensure\n         // this function's result remains infallible, we must confirm\n@@ -179,7 +181,7 @@ fn pred_known_to_hold_modulo_regions<'tcx>(\n             }\n         }\n     } else {\n-        result\n+        false\n     }\n }\n "}]}