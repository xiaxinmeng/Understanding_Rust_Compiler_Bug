{"sha": "52b4a2eb6f094db7eabcf605598b9266869fa9d6", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUyYjRhMmViNmYwOTRkYjdlYWJjZjYwNTU5OGI5MjY2ODY5ZmE5ZDY=", "commit": {"author": {"name": "blake2-ppc", "email": "blake2-ppc", "date": "2013-07-22T15:51:11Z"}, "committer": {"name": "blake2-ppc", "email": "blake2-ppc", "date": "2013-07-22T15:51:11Z"}, "message": "dlist: Fix .peek_next() w.r.t double ended iterators\n\n.peek_next() needs to check the element counter just like the .next()\nand .next_back() iterators do.\n\nAlso clarify .insert_next() doc w.r.t double ended iteration.", "tree": {"sha": "966fc89b57920c5f002c02f8d5b2d90c9057d4a3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/966fc89b57920c5f002c02f8d5b2d90c9057d4a3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/52b4a2eb6f094db7eabcf605598b9266869fa9d6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/52b4a2eb6f094db7eabcf605598b9266869fa9d6", "html_url": "https://github.com/rust-lang/rust/commit/52b4a2eb6f094db7eabcf605598b9266869fa9d6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/52b4a2eb6f094db7eabcf605598b9266869fa9d6/comments", "author": null, "committer": null, "parents": [{"sha": "cf437a273033a16c4084acc07b1341ee86bd5bbd", "url": "https://api.github.com/repos/rust-lang/rust/commits/cf437a273033a16c4084acc07b1341ee86bd5bbd", "html_url": "https://github.com/rust-lang/rust/commit/cf437a273033a16c4084acc07b1341ee86bd5bbd"}], "stats": {"total": 7, "additions": 6, "deletions": 1}, "files": [{"sha": "276d80043148158c3012ba99df6c32853c84e71a", "filename": "src/libextra/dlist.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/52b4a2eb6f094db7eabcf605598b9266869fa9d6/src%2Flibextra%2Fdlist.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52b4a2eb6f094db7eabcf605598b9266869fa9d6/src%2Flibextra%2Fdlist.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibextra%2Fdlist.rs?ref=52b4a2eb6f094db7eabcf605598b9266869fa9d6", "patch": "@@ -477,7 +477,9 @@ impl<'self, A> DoubleEndedIterator<&'self mut A> for MutDListIterator<'self, A>\n \n /// Allow mutating the DList while iterating\n pub trait ListInsertion<A> {\n-    /// Insert `elt` just after to the most recently yielded element\n+    /// Insert `elt` just after to the element most recently returned by `.next()`\n+    ///\n+    /// The inserted element does not appear in the iteration.\n     fn insert_next(&mut self, elt: A);\n \n     /// Provide a reference to the next element, without changing the iterator\n@@ -515,6 +517,9 @@ impl<'self, A> ListInsertion<A> for MutDListIterator<'self, A> {\n \n     #[inline]\n     fn peek_next<'a>(&'a mut self) -> Option<&'a mut A> {\n+        if self.nelem == 0 {\n+            return None\n+        }\n         self.head.resolve().map_consume(|head| &mut head.value)\n     }\n }"}]}