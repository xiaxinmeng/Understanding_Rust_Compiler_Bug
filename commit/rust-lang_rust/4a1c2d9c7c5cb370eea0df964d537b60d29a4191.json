{"sha": "4a1c2d9c7c5cb370eea0df964d537b60d29a4191", "node_id": "C_kwDOAAsO6NoAKDRhMWMyZDljN2M1Y2IzNzBlZWEwZGY5NjRkNTM3YjYwZDI5YTQxOTE", "commit": {"author": {"name": "bjorn3", "email": "17426603+bjorn3@users.noreply.github.com", "date": "2023-02-10T18:08:39Z"}, "committer": {"name": "bjorn3", "email": "17426603+bjorn3@users.noreply.github.com", "date": "2023-02-10T18:08:39Z"}, "message": "Fix signaling available_token_condvar when a new token is received\n\nThis slightly improves performance on systems with many cores and\nbarely affects systems with few cores.\n\nMy laptop (2 core + HT):\nBefore:\nBenchmark 2: RUSTC=rustc /home/bjorn/Projects/cg_clif2/./dist/cargo-clif build --manifest-path /home/bjorn/Projects/cg_clif2/./download/simple-raytracer/Cargo.toml --target-dir /home/bjorn/Projects/cg_clif2/./build/simple_raytracer\n  Time (mean \u00b1 \u03c3):     12.042 s \u00b1  0.313 s    [User: 29.434 s, System: 4.720 s]\n  Range (min \u2026 max):   11.670 s \u2026 12.795 s    10 runs\n\nAfter:\nBenchmark 2: RUSTC=rustc /home/bjorn/Projects/cg_clif2/./dist/cargo-clif build --manifest-path /home/bjorn/Projects/cg_clif2/./download/simple-raytracer/Cargo.toml --target-dir /home/bjorn/Projects/cg_clif2/./build/simple_raytracer\n  Time (mean \u00b1 \u03c3):     12.037 s \u00b1  0.384 s    [User: 29.960 s, System: 4.722 s]\n  Range (min \u2026 max):   11.673 s \u2026 12.769 s    10 runs\n\nDev desktop (32 cores)\nBefore:\nBenchmark 2: RUSTC=rustc /home/gh-bjorn3/cg_clif/./dist/cargo-clif build --manifest-path /home/gh-bjorn3/cg_clif/./download/simple-raytracer/Cargo.toml --target-dir /home/gh-bjorn3/cg_clif/./build/simple_raytracer\n  Time (mean \u00b1 \u03c3):     10.425 s \u00b1  0.104 s    [User: 25.877 s, System: 5.513 s]\n  Range (min \u2026 max):   10.267 s \u2026 10.640 s    10 runs\n\nAfter:\nBenchmark 2: RUSTC=rustc /home/gh-bjorn3/cg_clif/./dist/cargo-clif build --manifest-path /home/gh-bjorn3/cg_clif/./download/simple-raytracer/Cargo.toml --target-dir /home/gh-bjorn3/cg_clif/./build/simple_raytracer\n  Time (mean \u00b1 \u03c3):     10.212 s \u00b1  0.100 s    [User: 25.918 s, System: 5.555 s]\n  Range (min \u2026 max):   10.079 s \u2026 10.362 s    10 runs", "tree": {"sha": "c5adfb0743c806540c46db14117bdda392a08d4f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c5adfb0743c806540c46db14117bdda392a08d4f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4a1c2d9c7c5cb370eea0df964d537b60d29a4191", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4a1c2d9c7c5cb370eea0df964d537b60d29a4191", "html_url": "https://github.com/rust-lang/rust/commit/4a1c2d9c7c5cb370eea0df964d537b60d29a4191", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4a1c2d9c7c5cb370eea0df964d537b60d29a4191/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7870b296e45a3758ee3f8577303b24128695694f", "url": "https://api.github.com/repos/rust-lang/rust/commits/7870b296e45a3758ee3f8577303b24128695694f", "html_url": "https://github.com/rust-lang/rust/commit/7870b296e45a3758ee3f8577303b24128695694f"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "203219a8a754a6dbc6e548112d876324a750970d", "filename": "src/concurrency_limiter.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4a1c2d9c7c5cb370eea0df964d537b60d29a4191/src%2Fconcurrency_limiter.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a1c2d9c7c5cb370eea0df964d537b60d29a4191/src%2Fconcurrency_limiter.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconcurrency_limiter.rs?ref=4a1c2d9c7c5cb370eea0df964d537b60d29a4191", "patch": "@@ -32,7 +32,7 @@ impl ConcurrencyLimiter {\n         ConcurrencyLimiter {\n             helper_thread: Some(helper_thread),\n             state,\n-            available_token_condvar: Arc::new(Condvar::new()),\n+            available_token_condvar,\n             finished: false,\n         }\n     }"}]}