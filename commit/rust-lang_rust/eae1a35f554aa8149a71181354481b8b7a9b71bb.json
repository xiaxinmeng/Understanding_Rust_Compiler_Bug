{"sha": "eae1a35f554aa8149a71181354481b8b7a9b71bb", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVhZTFhMzVmNTU0YWE4MTQ5YTcxMTgxMzU0NDgxYjhiN2E5YjcxYmI=", "commit": {"author": {"name": "bobtwinkles", "email": "srkoser+GitHub@gmail.com", "date": "2018-01-27T10:18:12Z"}, "committer": {"name": "bobtwinkles", "email": "srkoser+GitHub@gmail.com", "date": "2018-02-05T20:00:40Z"}, "message": "mir: Add and fix tests for FalseUnwinds\n\nFix instructions on existing mir-opt tests after introducing false edges from\nloops. Also, add a test for issue 46036: infinite loops.", "tree": {"sha": "e8e8d81480df5a3d377d345c1f58865844f947c1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e8e8d81480df5a3d377d345c1f58865844f947c1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/eae1a35f554aa8149a71181354481b8b7a9b71bb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/eae1a35f554aa8149a71181354481b8b7a9b71bb", "html_url": "https://github.com/rust-lang/rust/commit/eae1a35f554aa8149a71181354481b8b7a9b71bb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/eae1a35f554aa8149a71181354481b8b7a9b71bb/comments", "author": {"login": "bobtwinkles", "id": 1514748, "node_id": "MDQ6VXNlcjE1MTQ3NDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1514748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bobtwinkles", "html_url": "https://github.com/bobtwinkles", "followers_url": "https://api.github.com/users/bobtwinkles/followers", "following_url": "https://api.github.com/users/bobtwinkles/following{/other_user}", "gists_url": "https://api.github.com/users/bobtwinkles/gists{/gist_id}", "starred_url": "https://api.github.com/users/bobtwinkles/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bobtwinkles/subscriptions", "organizations_url": "https://api.github.com/users/bobtwinkles/orgs", "repos_url": "https://api.github.com/users/bobtwinkles/repos", "events_url": "https://api.github.com/users/bobtwinkles/events{/privacy}", "received_events_url": "https://api.github.com/users/bobtwinkles/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bobtwinkles", "id": 1514748, "node_id": "MDQ6VXNlcjE1MTQ3NDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1514748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bobtwinkles", "html_url": "https://github.com/bobtwinkles", "followers_url": "https://api.github.com/users/bobtwinkles/followers", "following_url": "https://api.github.com/users/bobtwinkles/following{/other_user}", "gists_url": "https://api.github.com/users/bobtwinkles/gists{/gist_id}", "starred_url": "https://api.github.com/users/bobtwinkles/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bobtwinkles/subscriptions", "organizations_url": "https://api.github.com/users/bobtwinkles/orgs", "repos_url": "https://api.github.com/users/bobtwinkles/repos", "events_url": "https://api.github.com/users/bobtwinkles/events{/privacy}", "received_events_url": "https://api.github.com/users/bobtwinkles/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ed6a2ebcd6d36f2e0760d419094a653bda984bc2", "url": "https://api.github.com/repos/rust-lang/rust/commits/ed6a2ebcd6d36f2e0760d419094a653bda984bc2", "html_url": "https://github.com/rust-lang/rust/commit/ed6a2ebcd6d36f2e0760d419094a653bda984bc2"}], "stats": {"total": 71, "additions": 52, "deletions": 19}, "files": [{"sha": "b5cdded4d304a99fd9f1cdd4da9de60955cc2f9b", "filename": "src/test/compile-fail/issue-46036.rs", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/eae1a35f554aa8149a71181354481b8b7a9b71bb/src%2Ftest%2Fcompile-fail%2Fissue-46036.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eae1a35f554aa8149a71181354481b8b7a9b71bb/src%2Ftest%2Fcompile-fail%2Fissue-46036.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-46036.rs?ref=eae1a35f554aa8149a71181354481b8b7a9b71bb", "patch": "@@ -0,0 +1,23 @@\n+// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// Issue 46036: [NLL] false edges on infinite loops\n+// Infinite loops should create false edges to the cleanup block.\n+#![feature(nll)]\n+\n+struct Foo { x: &'static u32 }\n+\n+fn foo() {\n+    let a = 3;\n+    let foo = Foo { x: &a }; //~ ERROR E0597\n+    loop { }\n+}\n+\n+fn main() { }"}, {"sha": "958e9364c8fa854ec822f221b2363a54cfce3ece", "filename": "src/test/mir-opt/end_region_2.rs", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/eae1a35f554aa8149a71181354481b8b7a9b71bb/src%2Ftest%2Fmir-opt%2Fend_region_2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eae1a35f554aa8149a71181354481b8b7a9b71bb/src%2Ftest%2Fmir-opt%2Fend_region_2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Fend_region_2.rs?ref=eae1a35f554aa8149a71181354481b8b7a9b71bb", "patch": "@@ -46,17 +46,20 @@ fn main() {\n //         _3 = &'23_1rs _2;\n //         StorageLive(_5);\n //         _5 = _2;\n-//         switchInt(move _5) -> [0u8: bb3, otherwise: bb2];\n+//         switchInt(move _5) -> [0u8: bb4, otherwise: bb3];\n //     }\n //     bb2: {\n+//         ...\n+//     }\n+//     bb3: {\n //         _0 = ();\n //         StorageDead(_5);\n //         EndRegion('23_1rs);\n //         StorageDead(_3);\n //         StorageDead(_2);\n //         return;\n //     }\n-//     bb3: {\n+//     bb4: {\n //         _4 = ();\n //         StorageDead(_5);\n //         StorageLive(_7);\n@@ -67,6 +70,6 @@ fn main() {\n //         EndRegion('23_1rs);\n //         StorageDead(_3);\n //         StorageDead(_2);\n-//         goto -> bb1;\n+//         falseUnwind -> [real: bb1, cleanup: bb2];\n //     }\n // END rustc.main.SimplifyCfg-qualify-consts.after.mir"}, {"sha": "c1ebc525e88ed59f7eba208456a51c0283de6093", "filename": "src/test/mir-opt/end_region_3.rs", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/eae1a35f554aa8149a71181354481b8b7a9b71bb/src%2Ftest%2Fmir-opt%2Fend_region_3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eae1a35f554aa8149a71181354481b8b7a9b71bb/src%2Ftest%2Fmir-opt%2Fend_region_3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Fend_region_3.rs?ref=eae1a35f554aa8149a71181354481b8b7a9b71bb", "patch": "@@ -48,17 +48,20 @@ fn main() {\n //         _3 = &'26_1rs _1;\n //         StorageLive(_5);\n //         _5 = _1;\n-//         switchInt(move _5) -> [0u8: bb3, otherwise: bb2];\n+//         switchInt(move _5) -> [0u8: bb4, otherwise: bb3];\n //     }\n //     bb2: {\n+//         ...\n+//     }\n+//     bb3: {\n //         _0 = ();\n //         StorageDead(_5);\n //         EndRegion('26_1rs);\n //         StorageDead(_3);\n //         StorageDead(_1);\n //         return;\n //     }\n-//     bb3: {\n+//     bb4: {\n //         _4 = ();\n //         StorageDead(_5);\n //         StorageLive(_7);\n@@ -68,6 +71,6 @@ fn main() {\n //         StorageDead(_7);\n //         EndRegion('26_1rs);\n //         StorageDead(_3);\n-//         goto -> bb1;\n+//         falseUnwind -> [real: bb1, cleanup: bb2];\n //     }\n // END rustc.main.SimplifyCfg-qualify-consts.after.mir"}, {"sha": "70611306fd328f02ad7062ba3fd466ddc41e7896", "filename": "src/test/mir-opt/end_region_9.rs", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/eae1a35f554aa8149a71181354481b8b7a9b71bb/src%2Ftest%2Fmir-opt%2Fend_region_9.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eae1a35f554aa8149a71181354481b8b7a9b71bb/src%2Ftest%2Fmir-opt%2Fend_region_9.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Fend_region_9.rs?ref=eae1a35f554aa8149a71181354481b8b7a9b71bb", "patch": "@@ -58,15 +58,17 @@ fn main() {\n //        StorageLive(_2);\n //        _2 = const 3i32;\n //        StorageLive(_4);\n-//        goto -> bb1;\n+//        goto -> bb2;\n //    }\n-//\n //    bb1: {\n+//        ...\n+//    }\n+//    bb2: {\n //        StorageLive(_7);\n //        _7 = _1;\n-//        switchInt(move _7) -> [0u8: bb3, otherwise: bb2];\n+//        switchInt(move _7) -> [0u8: bb4, otherwise: bb3];\n //    }\n-//    bb2: {\n+//    bb3: {\n //        _0 = ();\n //        StorageDead(_7);\n //        EndRegion('33_0rs);\n@@ -75,13 +77,13 @@ fn main() {\n //        StorageDead(_1);\n //        return;\n //    }\n-//    bb3: {\n+//    bb4: {\n //        _4 = &'33_0rs _2;\n //        _6 = ();\n //        StorageDead(_7);\n //        _1 = const true;\n //        _3 = ();\n-//        goto -> bb1;\n+//        falseUnwind -> [real: bb2, cleanup: bb1];\n //    }\n // }\n // END rustc.main.SimplifyCfg-qualify-consts.after.mir"}, {"sha": "801c4eed4d20b1ec5eb8eb585b5d7d0cab511611", "filename": "src/test/mir-opt/end_region_cyclic.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/eae1a35f554aa8149a71181354481b8b7a9b71bb/src%2Ftest%2Fmir-opt%2Fend_region_cyclic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eae1a35f554aa8149a71181354481b8b7a9b71bb/src%2Ftest%2Fmir-opt%2Fend_region_cyclic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Fend_region_cyclic.rs?ref=eae1a35f554aa8149a71181354481b8b7a9b71bb", "patch": "@@ -131,7 +131,7 @@ fn query() -> bool { true }\n //         _1 = ();\n //         EndRegion('35_0rs);\n //         StorageDead(_2);\n-//         goto -> bb1;\n+//         falseUnwind -> [real: bb1, cleanup: bb2];\n //     }\n // }\n // END rustc.main.SimplifyCfg-qualify-consts.after.mir"}, {"sha": "4444d96798fcf2295c5df6233e585064ea2f87eb", "filename": "src/test/mir-opt/issue-38669.rs", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/eae1a35f554aa8149a71181354481b8b7a9b71bb/src%2Ftest%2Fmir-opt%2Fissue-38669.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eae1a35f554aa8149a71181354481b8b7a9b71bb/src%2Ftest%2Fmir-opt%2Fissue-38669.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Fissue-38669.rs?ref=eae1a35f554aa8149a71181354481b8b7a9b71bb", "patch": "@@ -25,27 +25,29 @@ fn main() {\n //     bb0: {\n //         StorageLive(_1);\n //         _1 = const false;\n-//         goto -> bb1;\n+//         goto -> bb2;\n //     }\n //\n //     bb1: {\n+//         resume;\n+//     }\n+//     bb2: {\n //         StorageLive(_4);\n //         _4 = _1;\n-//         switchInt(move _4) -> [0u8: bb3, otherwise: bb2];\n+//         switchInt(move _4) -> [0u8: bb4, otherwise: bb3];\n //     }\n-//\n-//     bb2: {\n+//     bb3: {\n //         _0 = ();\n //         StorageDead(_4);\n //         StorageDead(_1);\n //         return;\n //     }\n //\n-//     bb3: {\n+//     bb4: {\n //         _3 = ();\n //         StorageDead(_4);\n //         _1 = const true;\n //         _2 = ();\n-//         goto -> bb1;\n+//         falseUnwind -> [real: bb2, cleanup: bb1];\n //     }\n // END rustc.main.SimplifyCfg-initial.after.mir"}]}