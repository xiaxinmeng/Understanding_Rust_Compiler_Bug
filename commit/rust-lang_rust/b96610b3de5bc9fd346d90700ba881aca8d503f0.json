{"sha": "b96610b3de5bc9fd346d90700ba881aca8d503f0", "node_id": "C_kwDOAAsO6NoAKGI5NjYxMGIzZGU1YmM5ZmQzNDZkOTA3MDBiYTg4MWFjYThkNTAzZjA", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-05-20T16:38:24Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-05-20T16:38:24Z"}, "message": "Auto merge of #2135 - RalfJung:rustup, r=RalfJung\n\nrustup", "tree": {"sha": "10c235c6fdae056dd0ecb32ff9f78181389371bb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/10c235c6fdae056dd0ecb32ff9f78181389371bb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b96610b3de5bc9fd346d90700ba881aca8d503f0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b96610b3de5bc9fd346d90700ba881aca8d503f0", "html_url": "https://github.com/rust-lang/rust/commit/b96610b3de5bc9fd346d90700ba881aca8d503f0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b96610b3de5bc9fd346d90700ba881aca8d503f0/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d419efdba854e867075a37bd125506242acf94fa", "url": "https://api.github.com/repos/rust-lang/rust/commits/d419efdba854e867075a37bd125506242acf94fa", "html_url": "https://github.com/rust-lang/rust/commit/d419efdba854e867075a37bd125506242acf94fa"}, {"sha": "8b4d613cc81c8cc2b52485149e4aa1c8bae3394d", "url": "https://api.github.com/repos/rust-lang/rust/commits/8b4d613cc81c8cc2b52485149e4aa1c8bae3394d", "html_url": "https://github.com/rust-lang/rust/commit/8b4d613cc81c8cc2b52485149e4aa1c8bae3394d"}], "stats": {"total": 19, "additions": 12, "deletions": 7}, "files": [{"sha": "5526a13d5fc77f91cf35f154a53359c3e2411523", "filename": "rust-version", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b96610b3de5bc9fd346d90700ba881aca8d503f0/rust-version", "raw_url": "https://github.com/rust-lang/rust/raw/b96610b3de5bc9fd346d90700ba881aca8d503f0/rust-version", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/rust-version?ref=b96610b3de5bc9fd346d90700ba881aca8d503f0", "patch": "@@ -1 +1 @@\n-f24ef2e296ec6fc6fd2e24d7e4bfec3f4cb0577a\n+22ee39504a702f75485582d02060495a01254de1"}, {"sha": "7ab15b9f9ceb61c78a9dfbd1603419fb4485fd70", "filename": "src/machine.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/b96610b3de5bc9fd346d90700ba881aca8d503f0/src%2Fmachine.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b96610b3de5bc9fd346d90700ba881aca8d503f0/src%2Fmachine.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmachine.rs?ref=b96610b3de5bc9fd346d90700ba881aca8d503f0", "patch": "@@ -470,7 +470,12 @@ impl<'mir, 'tcx> Machine<'mir, 'tcx> for Evaluator<'mir, 'tcx> {\n     }\n \n     #[inline(always)]\n-    fn enforce_number_validity(ecx: &MiriEvalContext<'mir, 'tcx>) -> bool {\n+    fn enforce_number_init(ecx: &MiriEvalContext<'mir, 'tcx>) -> bool {\n+        ecx.machine.enforce_number_validity\n+    }\n+\n+    #[inline(always)]\n+    fn enforce_number_no_provenance(ecx: &MiriEvalContext<'mir, 'tcx>) -> bool {\n         ecx.machine.enforce_number_validity\n     }\n "}, {"sha": "bb9e8e1e220f4783a45d08d744ce9a9f5ebb9dca", "filename": "tests/compile-fail/ptr_integer_transmute.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b96610b3de5bc9fd346d90700ba881aca8d503f0/tests%2Fcompile-fail%2Fptr_integer_transmute.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b96610b3de5bc9fd346d90700ba881aca8d503f0/tests%2Fcompile-fail%2Fptr_integer_transmute.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Fptr_integer_transmute.rs?ref=b96610b3de5bc9fd346d90700ba881aca8d503f0", "patch": "@@ -2,5 +2,5 @@\n \n fn main() {\n     let r = &mut 42;\n-    let _i: usize = unsafe { std::mem::transmute(r) }; //~ ERROR expected initialized plain (non-pointer) bytes\n+    let _i: usize = unsafe { std::mem::transmute(r) }; //~ ERROR expected plain (non-pointer) bytes\n }"}, {"sha": "a684d65b2ce11e2fd76bdd38d32312537277b15f", "filename": "tests/compile-fail/strict_provenance_transmute.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b96610b3de5bc9fd346d90700ba881aca8d503f0/tests%2Fcompile-fail%2Fstrict_provenance_transmute.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b96610b3de5bc9fd346d90700ba881aca8d503f0/tests%2Fcompile-fail%2Fstrict_provenance_transmute.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Fstrict_provenance_transmute.rs?ref=b96610b3de5bc9fd346d90700ba881aca8d503f0", "patch": "@@ -7,7 +7,7 @@ use std::mem;\n // <https://github.com/rust-lang/unsafe-code-guidelines/issues/286#issuecomment-1085144431>.\n \n unsafe fn deref(left: *const u8, right: *const u8) {\n-    let left_int: usize = mem::transmute(left); //~ERROR expected initialized plain (non-pointer) bytes\n+    let left_int: usize = mem::transmute(left); //~ERROR expected plain (non-pointer) bytes\n     let right_int: usize = mem::transmute(right);\n     if left_int == right_int {\n         // The compiler is allowed to replace `left_int` by `right_int` here..."}, {"sha": "1cb687f9b008a76d6608a300dc391ac33ad5964f", "filename": "tests/compile-fail/uninit_float.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b96610b3de5bc9fd346d90700ba881aca8d503f0/tests%2Fcompile-fail%2Funinit_float.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b96610b3de5bc9fd346d90700ba881aca8d503f0/tests%2Fcompile-fail%2Funinit_float.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Funinit_float.rs?ref=b96610b3de5bc9fd346d90700ba881aca8d503f0", "patch": "@@ -4,5 +4,5 @@\n \n fn main() {\n     let _val = unsafe { std::mem::MaybeUninit::<f32>::uninit().assume_init() };\n-    //~^ ERROR type validation failed at .value: encountered uninitialized bytes, but expected initialized plain (non-pointer) bytes\n+    //~^ ERROR type validation failed at .value: encountered uninitialized bytes, but expected initialized bytes\n }"}, {"sha": "c700f1f46d993c38a23583b4339f110b3d18bb1c", "filename": "tests/compile-fail/uninit_integer.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b96610b3de5bc9fd346d90700ba881aca8d503f0/tests%2Fcompile-fail%2Funinit_integer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b96610b3de5bc9fd346d90700ba881aca8d503f0/tests%2Fcompile-fail%2Funinit_integer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Funinit_integer.rs?ref=b96610b3de5bc9fd346d90700ba881aca8d503f0", "patch": "@@ -4,5 +4,5 @@\n \n fn main() {\n     let _val = unsafe { std::mem::MaybeUninit::<usize>::uninit().assume_init() };\n-    //~^ ERROR type validation failed at .value: encountered uninitialized bytes, but expected initialized plain (non-pointer) bytes\n+    //~^ ERROR type validation failed at .value: encountered uninitialized bytes, but expected initialized bytes\n }"}, {"sha": "28bca0b19a78073d5f1cda4c531076d3a5840147", "filename": "tests/compile-fail/uninit_integer_signed.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b96610b3de5bc9fd346d90700ba881aca8d503f0/tests%2Fcompile-fail%2Funinit_integer_signed.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b96610b3de5bc9fd346d90700ba881aca8d503f0/tests%2Fcompile-fail%2Funinit_integer_signed.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Funinit_integer_signed.rs?ref=b96610b3de5bc9fd346d90700ba881aca8d503f0", "patch": "@@ -4,5 +4,5 @@\n \n fn main() {\n     let _val = unsafe { std::mem::MaybeUninit::<i32>::uninit().assume_init() };\n-    //~^ ERROR type validation failed at .value: encountered uninitialized bytes, but expected initialized plain (non-pointer) bytes\n+    //~^ ERROR type validation failed at .value: encountered uninitialized bytes, but expected initialized bytes\n }"}]}