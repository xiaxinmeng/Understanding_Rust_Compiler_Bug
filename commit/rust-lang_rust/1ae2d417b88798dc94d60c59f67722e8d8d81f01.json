{"sha": "1ae2d417b88798dc94d60c59f67722e8d8d81f01", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFhZTJkNDE3Yjg4Nzk4ZGM5NGQ2MGM1OWY2NzcyMmU4ZDhkODFmMDE=", "commit": {"author": {"name": "Marcus Klaas", "email": "mail@marcusklaas.nl", "date": "2015-09-01T18:42:07Z"}, "committer": {"name": "Marcus Klaas", "email": "mail@marcusklaas.nl", "date": "2015-09-01T18:42:07Z"}, "message": "Remove faulty shortcut in `rewrite_string_lit`\n\nRustfmt would leave the literal unchanged when it did not exceed the column limit in its original position, not considering its position after formatting.", "tree": {"sha": "cf52f9258cbf5e456c52d8e8064b6e4db77bdb9d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cf52f9258cbf5e456c52d8e8064b6e4db77bdb9d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1ae2d417b88798dc94d60c59f67722e8d8d81f01", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1ae2d417b88798dc94d60c59f67722e8d8d81f01", "html_url": "https://github.com/rust-lang/rust/commit/1ae2d417b88798dc94d60c59f67722e8d8d81f01", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1ae2d417b88798dc94d60c59f67722e8d8d81f01/comments", "author": {"login": "marcusklaas", "id": 1255413, "node_id": "MDQ6VXNlcjEyNTU0MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1255413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcusklaas", "html_url": "https://github.com/marcusklaas", "followers_url": "https://api.github.com/users/marcusklaas/followers", "following_url": "https://api.github.com/users/marcusklaas/following{/other_user}", "gists_url": "https://api.github.com/users/marcusklaas/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcusklaas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcusklaas/subscriptions", "organizations_url": "https://api.github.com/users/marcusklaas/orgs", "repos_url": "https://api.github.com/users/marcusklaas/repos", "events_url": "https://api.github.com/users/marcusklaas/events{/privacy}", "received_events_url": "https://api.github.com/users/marcusklaas/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marcusklaas", "id": 1255413, "node_id": "MDQ6VXNlcjEyNTU0MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1255413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcusklaas", "html_url": "https://github.com/marcusklaas", "followers_url": "https://api.github.com/users/marcusklaas/followers", "following_url": "https://api.github.com/users/marcusklaas/following{/other_user}", "gists_url": "https://api.github.com/users/marcusklaas/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcusklaas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcusklaas/subscriptions", "organizations_url": "https://api.github.com/users/marcusklaas/orgs", "repos_url": "https://api.github.com/users/marcusklaas/repos", "events_url": "https://api.github.com/users/marcusklaas/events{/privacy}", "received_events_url": "https://api.github.com/users/marcusklaas/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "81c8c020a8406ace24e0f81f6418736c89c533a3", "url": "https://api.github.com/repos/rust-lang/rust/commits/81c8c020a8406ace24e0f81f6418736c89c533a3", "html_url": "https://github.com/rust-lang/rust/commit/81c8c020a8406ace24e0f81f6418736c89c533a3"}], "stats": {"total": 20, "additions": 11, "deletions": 9}, "files": [{"sha": "e6e083d84bc0b7c40adb45cf7cfe74641693d737", "filename": "src/comment.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1ae2d417b88798dc94d60c59f67722e8d8d81f01/src%2Fcomment.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1ae2d417b88798dc94d60c59f67722e8d8d81f01/src%2Fcomment.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomment.rs?ref=1ae2d417b88798dc94d60c59f67722e8d8d81f01", "patch": "@@ -354,7 +354,7 @@ mod test {\n         check(\"/* comment */ some text /* more commentary */ result\", \"result\", Some(46));\n         check(\"sup // sup\", \"p\", Some(2));\n         check(\"sup\", \"x\", None);\n-        check(\"\u03c0? /**/ \u03c0 is nice!\", \"\u03c0 is nice\", Some(9));\n+        check(r#\"\u03c0? /**/ \u03c0 is nice!\"#, r#\"\u03c0 is nice\"#, Some(9));\n         check(\"/*sup yo? \\n sup*/ sup\", \"p\", Some(20));\n         check(\"hel/*lohello*/lo\", \"hello\", None);\n         check(\"acb\", \"ab\", None);"}, {"sha": "20c56ccd34ffdb2d1a72c44d31a574048e0cbe24", "filename": "src/expr.rs", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/1ae2d417b88798dc94d60c59f67722e8d8d81f01/src%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1ae2d417b88798dc94d60c59f67722e8d8d81f01/src%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fexpr.rs?ref=1ae2d417b88798dc94d60c59f67722e8d8d81f01", "patch": "@@ -20,7 +20,7 @@ use types::rewrite_path;\n use items::{span_lo_for_arg, span_hi_for_arg, rewrite_fn_input};\n \n use syntax::{ast, ptr};\n-use syntax::codemap::{CodeMap, Pos, Span, BytePos, mk_sp};\n+use syntax::codemap::{CodeMap, Span, BytePos, mk_sp};\n use syntax::visit::Visitor;\n \n impl Rewrite for ast::Expr {\n@@ -831,13 +831,7 @@ fn rewrite_string_lit(context: &RewriteContext,\n     if context.config.format_strings == false {\n         return Some(context.snippet(span));\n     }\n-    // Check if there is anything to fix: we always try to fixup multi-line\n-    // strings, or if the string is too long for the line.\n-    let l_loc = context.codemap.lookup_char_pos(span.lo);\n-    let r_loc = context.codemap.lookup_char_pos(span.hi);\n-    if l_loc.line == r_loc.line && r_loc.col.to_usize() <= context.config.max_width {\n-        return Some(context.snippet(span));\n-    }\n+\n     let fmt = StringFormat {\n         opener: \"\\\"\",\n         closer: \"\\\"\","}, {"sha": "d7e57ea65c7eaa1a1d4b4559d9273a54ff9a4dc1", "filename": "tests/source/string-lit.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/1ae2d417b88798dc94d60c59f67722e8d8d81f01/tests%2Fsource%2Fstring-lit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1ae2d417b88798dc94d60c59f67722e8d8d81f01/tests%2Fsource%2Fstring-lit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fstring-lit.rs?ref=1ae2d417b88798dc94d60c59f67722e8d8d81f01", "patch": "@@ -22,5 +22,8 @@ not\n remove\n formatting\"#;\n \n+    let xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx =\n+        funktion(\"yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy\");\n+\n     \"stuff\"\n }"}, {"sha": "2107d902e1912d06058195e0b6821b461f244337", "filename": "tests/target/string-lit.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/1ae2d417b88798dc94d60c59f67722e8d8d81f01/tests%2Ftarget%2Fstring-lit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1ae2d417b88798dc94d60c59f67722e8d8d81f01/tests%2Ftarget%2Fstring-lit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fstring-lit.rs?ref=1ae2d417b88798dc94d60c59f67722e8d8d81f01", "patch": "@@ -25,5 +25,10 @@ not\n remove\n formatting\"#;\n \n+    let xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx = funktion(\"yyyyyyyyyyyyyyyyyyyyy\\\n+                                                                            yyyyyyyyyyyyyyyyyyyyy\\\n+                                                                            yyyyyyyyyyyyyyyyyyyyy\\\n+                                                                            yyyyyyyyyy\");\n+\n     \"stuff\"\n }"}]}