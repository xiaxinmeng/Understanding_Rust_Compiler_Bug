{"sha": "2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJhYWZlNDUyYjg5OGFhM2ZkZmIyYzVhMWE2NDllZDA5MjJlMTQwMWQ=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-03-18T05:27:26Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-03-18T05:27:26Z"}, "message": "Auto merge of #82868 - petrochenkov:bto, r=estebank\n\nReport missing cases of `bare_trait_objects`\n\nFixes https://github.com/rust-lang/rust/issues/65371", "tree": {"sha": "b7c27651086eb8ec2358fdee1b6795d71c191c04", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b7c27651086eb8ec2358fdee1b6795d71c191c04"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "html_url": "https://github.com/rust-lang/rust/commit/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "81c1d7a1506e5f4bcc5f12fb49f3b6e9bb87c605", "url": "https://api.github.com/repos/rust-lang/rust/commits/81c1d7a1506e5f4bcc5f12fb49f3b6e9bb87c605", "html_url": "https://github.com/rust-lang/rust/commit/81c1d7a1506e5f4bcc5f12fb49f3b6e9bb87c605"}, {"sha": "b48530bf8b30c20a75f5bb7c2021a28c0ae40413", "url": "https://api.github.com/repos/rust-lang/rust/commits/b48530bf8b30c20a75f5bb7c2021a28c0ae40413", "html_url": "https://github.com/rust-lang/rust/commit/b48530bf8b30c20a75f5bb7c2021a28c0ae40413"}], "stats": {"total": 285, "additions": 192, "deletions": 93}, "files": [{"sha": "7e82d7ff77d9617c115b610ecbe9807001444d89", "filename": "compiler/rustc_ast/src/ast.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_ast%2Fsrc%2Fast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_ast%2Fsrc%2Fast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast%2Fsrc%2Fast.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -1964,7 +1964,7 @@ impl TyKind {\n }\n \n /// Syntax used to declare a trait object.\n-#[derive(Clone, Copy, PartialEq, Encodable, Decodable, Debug)]\n+#[derive(Clone, Copy, PartialEq, Encodable, Decodable, Debug, HashStable_Generic)]\n pub enum TraitObjectSyntax {\n     Dyn,\n     None,"}, {"sha": "f9872f84e125e27d693745b9e03d5f80bc564ecb", "filename": "compiler/rustc_ast_lowering/src/lib.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -1396,7 +1396,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                 if kind != TraitObjectSyntax::Dyn {\n                     self.maybe_lint_bare_trait(t.span, t.id, false);\n                 }\n-                hir::TyKind::TraitObject(bounds, lifetime_bound)\n+                hir::TyKind::TraitObject(bounds, lifetime_bound, kind)\n             }\n             TyKind::ImplTrait(def_node_id, ref bounds) => {\n                 let span = t.span;\n@@ -2648,6 +2648,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                         hir::TyKind::TraitObject(\n                             arena_vec![self; principal],\n                             self.elided_dyn_bound(span),\n+                            TraitObjectSyntax::None,\n                         )\n                     }\n                     _ => hir::TyKind::Path(hir::QPath::Resolved(None, path)),"}, {"sha": "d03584d49a5bcc595a2e3a94839a142cc6cb0a55", "filename": "compiler/rustc_hir/src/hir.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_hir%2Fsrc%2Fhir.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_hir%2Fsrc%2Fhir.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir%2Fsrc%2Fhir.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -6,7 +6,7 @@ use crate::{itemlikevisit, LangItem};\n \n use rustc_ast::util::parser::ExprPrecedence;\n use rustc_ast::{self as ast, CrateSugar, LlvmAsmDialect};\n-use rustc_ast::{Attribute, FloatTy, IntTy, Label, LitKind, StrStyle, UintTy};\n+use rustc_ast::{Attribute, FloatTy, IntTy, Label, LitKind, StrStyle, TraitObjectSyntax, UintTy};\n pub use rustc_ast::{BorrowKind, ImplPolarity, IsAuto};\n pub use rustc_ast::{CaptureBy, Movability, Mutability};\n use rustc_ast::{InlineAsmOptions, InlineAsmTemplatePiece};\n@@ -2327,7 +2327,7 @@ pub enum TyKind<'hir> {\n     OpaqueDef(ItemId, &'hir [GenericArg<'hir>]),\n     /// A trait object type `Bound1 + Bound2 + Bound3`\n     /// where `Bound` is a trait or a lifetime.\n-    TraitObject(&'hir [PolyTraitRef<'hir>], Lifetime),\n+    TraitObject(&'hir [PolyTraitRef<'hir>], Lifetime, TraitObjectSyntax),\n     /// Unused for now.\n     Typeof(AnonConst),\n     /// `TyKind::Infer` means the type should be inferred instead of it having been"}, {"sha": "701e4a632939473180b28cab0009da66dcf8d049", "filename": "compiler/rustc_hir/src/intravisit.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_hir%2Fsrc%2Fintravisit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_hir%2Fsrc%2Fintravisit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir%2Fsrc%2Fintravisit.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -709,7 +709,7 @@ pub fn walk_ty<'v, V: Visitor<'v>>(visitor: &mut V, typ: &'v Ty<'v>) {\n             visitor.visit_ty(ty);\n             visitor.visit_anon_const(length)\n         }\n-        TyKind::TraitObject(bounds, ref lifetime) => {\n+        TyKind::TraitObject(bounds, ref lifetime, _syntax) => {\n             for bound in bounds {\n                 visitor.visit_poly_trait_ref(bound, TraitBoundModifier::None);\n             }"}, {"sha": "b37a3e19b84081093e2d0d8b3c0050a95c4e07f1", "filename": "compiler/rustc_hir_pretty/src/lib.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_hir_pretty%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_hir_pretty%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_pretty%2Fsrc%2Flib.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -410,7 +410,10 @@ impl<'a> State<'a> {\n             }\n             hir::TyKind::OpaqueDef(..) => self.s.word(\"/*impl Trait*/\"),\n             hir::TyKind::Path(ref qpath) => self.print_qpath(qpath, false),\n-            hir::TyKind::TraitObject(bounds, ref lifetime) => {\n+            hir::TyKind::TraitObject(bounds, ref lifetime, syntax) => {\n+                if syntax == ast::TraitObjectSyntax::Dyn {\n+                    self.word_space(\"dyn\");\n+                }\n                 let mut first = true;\n                 for bound in bounds {\n                     if first {"}, {"sha": "35b9bc96f133999bc3496dba3029f2f0004387d2", "filename": "compiler/rustc_infer/src/infer/error_reporting/nice_region_error/find_anon_type.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_infer%2Fsrc%2Finfer%2Ferror_reporting%2Fnice_region_error%2Ffind_anon_type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_infer%2Fsrc%2Finfer%2Ferror_reporting%2Fnice_region_error%2Ffind_anon_type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_infer%2Fsrc%2Finfer%2Ferror_reporting%2Fnice_region_error%2Ffind_anon_type.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -99,7 +99,7 @@ impl Visitor<'tcx> for FindNestedTypeVisitor<'tcx> {\n                 return;\n             }\n \n-            hir::TyKind::TraitObject(bounds, _) => {\n+            hir::TyKind::TraitObject(bounds, ..) => {\n                 for bound in bounds {\n                     self.current_index.shift_in(1);\n                     self.visit_poly_trait_ref(bound, hir::TraitBoundModifier::None);"}, {"sha": "1e926989263c9cb66ea81f0eb7a356a6f6cbd3c4", "filename": "compiler/rustc_infer/src/infer/error_reporting/nice_region_error/static_impl_trait.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_infer%2Fsrc%2Finfer%2Ferror_reporting%2Fnice_region_error%2Fstatic_impl_trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_infer%2Fsrc%2Finfer%2Ferror_reporting%2Fnice_region_error%2Fstatic_impl_trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_infer%2Fsrc%2Finfer%2Ferror_reporting%2Fnice_region_error%2Fstatic_impl_trait.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -292,7 +292,7 @@ impl<'a, 'tcx> NiceRegionError<'a, 'tcx> {\n                         );\n                     }\n                 }\n-                TyKind::TraitObject(_, lt) => match lt.name {\n+                TyKind::TraitObject(_, lt, _) => match lt.name {\n                     LifetimeName::ImplicitObjectLifetimeDefault => {\n                         err.span_suggestion_verbose(\n                             fn_return.span.shrink_to_hi(),\n@@ -498,6 +498,7 @@ impl<'tcx> Visitor<'tcx> for HirTraitObjectVisitor {\n         if let TyKind::TraitObject(\n             poly_trait_refs,\n             Lifetime { name: LifetimeName::ImplicitObjectLifetimeDefault, .. },\n+            _,\n         ) = t.kind\n         {\n             for ptr in poly_trait_refs {"}, {"sha": "982c8a354b4ab20a91933e8613398ab32dd543c7", "filename": "compiler/rustc_middle/src/ty/diagnostics.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_middle%2Fsrc%2Fty%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_middle%2Fsrc%2Fty%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Fdiagnostics.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -314,6 +314,7 @@ impl<'v> hir::intravisit::Visitor<'v> for TraitObjectVisitor<'v> {\n                         hir::LifetimeName::ImplicitObjectLifetimeDefault | hir::LifetimeName::Static,\n                     ..\n                 },\n+                _,\n             ) => {\n                 self.0.push(ty);\n             }"}, {"sha": "2c61c0963ae2844b9dc65d9dd17b68e88dc6f03a", "filename": "compiler/rustc_resolve/src/late/lifetimes.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_resolve%2Fsrc%2Flate%2Flifetimes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_resolve%2Fsrc%2Flate%2Flifetimes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_resolve%2Fsrc%2Flate%2Flifetimes.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -540,7 +540,7 @@ impl<'a, 'tcx> Visitor<'tcx> for LifetimeContext<'a, 'tcx> {\n                 self.missing_named_lifetime_spots.pop();\n                 self.is_in_fn_syntax = was_in_fn_syntax;\n             }\n-            hir::TyKind::TraitObject(bounds, ref lifetime) => {\n+            hir::TyKind::TraitObject(bounds, ref lifetime, _) => {\n                 debug!(\"visit_ty: TraitObject(bounds={:?}, lifetime={:?})\", bounds, lifetime);\n                 for bound in bounds {\n                     self.visit_poly_trait_ref(bound, hir::TraitBoundModifier::None);\n@@ -2299,7 +2299,7 @@ impl<'a, 'tcx> LifetimeContext<'a, 'tcx> {\n                     self.outer_index.shift_in(1);\n                 }\n                 match ty.kind {\n-                    hir::TyKind::TraitObject(bounds, ref lifetime) => {\n+                    hir::TyKind::TraitObject(bounds, ref lifetime, _) => {\n                         for bound in bounds {\n                             self.visit_poly_trait_ref(bound, hir::TraitBoundModifier::None);\n                         }"}, {"sha": "a9ffb5542b6df6aa4c36b31125145542e33a1f64", "filename": "compiler/rustc_trait_selection/src/infer.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_trait_selection%2Fsrc%2Finfer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_trait_selection%2Fsrc%2Finfer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Finfer.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -124,7 +124,7 @@ impl<'tcx> InferCtxtBuilderExt<'tcx> for InferCtxtBuilder<'tcx> {\n             DUMMY_SP,\n             canonical_key,\n             |ref infcx, key, canonical_inference_vars| {\n-                let mut fulfill_cx = TraitEngine::new(infcx.tcx);\n+                let mut fulfill_cx = <dyn TraitEngine<'_>>::new(infcx.tcx);\n                 let value = operation(infcx, &mut *fulfill_cx, key)?;\n                 infcx.make_canonicalized_query_response(\n                     canonical_inference_vars,"}, {"sha": "4f5476ca5d0dc08ee6b54bb2d711f7233d192bb2", "filename": "compiler/rustc_trait_selection/src/traits/query/type_op/custom.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fquery%2Ftype_op%2Fcustom.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fquery%2Ftype_op%2Fcustom.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fquery%2Ftype_op%2Fcustom.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -62,7 +62,7 @@ fn scrape_region_constraints<'tcx, R>(\n     infcx: &InferCtxt<'_, 'tcx>,\n     op: impl FnOnce() -> Fallible<InferOk<'tcx, R>>,\n ) -> Fallible<(R, Option<Rc<QueryRegionConstraints<'tcx>>>)> {\n-    let mut fulfill_cx = TraitEngine::new(infcx.tcx);\n+    let mut fulfill_cx = <dyn TraitEngine<'_>>::new(infcx.tcx);\n     let dummy_body_id = ObligationCause::dummy().body_id;\n \n     // During NLL, we expect that nobody will register region"}, {"sha": "9d5b9d7357fc47e8c56dac714abb1a9754606d0a", "filename": "compiler/rustc_traits/src/dropck_outlives.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_traits%2Fsrc%2Fdropck_outlives.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_traits%2Fsrc%2Fdropck_outlives.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_traits%2Fsrc%2Fdropck_outlives.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -75,7 +75,7 @@ fn dropck_outlives<'tcx>(\n             // Set used to detect infinite recursion.\n             let mut ty_set = FxHashSet::default();\n \n-            let mut fulfill_cx = TraitEngine::new(infcx.tcx);\n+            let mut fulfill_cx = <dyn TraitEngine<'_>>::new(infcx.tcx);\n \n             let cause = ObligationCause::dummy();\n             let mut constraints = DtorckConstraint::empty();"}, {"sha": "7c5398003f3e61dde49b03c15c5dd85d67a6c31b", "filename": "compiler/rustc_typeck/src/astconv/mod.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fmod.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -1608,6 +1608,8 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n     // the whole path.\n     // Will fail except for `T::A` and `Self::A`; i.e., if `qself_ty`/`qself_def` are not a type\n     // parameter or `Self`.\n+    // NOTE: When this function starts resolving `Trait::AssocTy` successfully\n+    // it should also start reportint the `BARE_TRAIT_OBJECTS` lint.\n     pub fn associated_path_to_ty(\n         &self,\n         hir_ref_id: hir::HirId,\n@@ -2201,7 +2203,7 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n                     Some(ast_ty),\n                 ))\n             }\n-            hir::TyKind::TraitObject(ref bounds, ref lifetime) => {\n+            hir::TyKind::TraitObject(ref bounds, ref lifetime, _) => {\n                 self.conv_object_ty_poly_trait_ref(ast_ty.span, bounds, lifetime, borrowed)\n             }\n             hir::TyKind::Path(hir::QPath::Resolved(ref maybe_qself, ref path)) => {"}, {"sha": "94aee87364a69d16ff79bfeacb379e5a917b2772", "filename": "compiler/rustc_typeck/src/check/coercion.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fcoercion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fcoercion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fcoercion.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -1554,7 +1554,7 @@ impl<'tcx, 'exprs, E: AsCoercionSite> CoerceMany<'tcx, 'exprs, E> {\n         if let hir::FnRetTy::Return(ty) = fn_output {\n             // Get the return type.\n             if let hir::TyKind::OpaqueDef(..) = ty.kind {\n-                let ty = AstConv::ast_ty_to_ty(fcx, ty);\n+                let ty = <dyn AstConv<'_>>::ast_ty_to_ty(fcx, ty);\n                 // Get the `impl Trait`'s `DefId`.\n                 if let ty::Opaque(def_id, _) = ty.kind() {\n                     let hir_id = fcx.tcx.hir().local_def_id_to_hir_id(def_id.expect_local());\n@@ -1616,7 +1616,7 @@ impl<'tcx, 'exprs, E: AsCoercionSite> CoerceMany<'tcx, 'exprs, E> {\n     fn is_return_ty_unsized(&self, fcx: &FnCtxt<'a, 'tcx>, blk_id: hir::HirId) -> bool {\n         if let Some((fn_decl, _)) = fcx.get_fn_decl(blk_id) {\n             if let hir::FnRetTy::Return(ty) = fn_decl.output {\n-                let ty = AstConv::ast_ty_to_ty(fcx, ty);\n+                let ty = <dyn AstConv<'_>>::ast_ty_to_ty(fcx, ty);\n                 if let ty::Dynamic(..) = ty.kind() {\n                     return true;\n                 }"}, {"sha": "4d74962d28ed3d0438838ba97733662a53b8dc36", "filename": "compiler/rustc_typeck/src/check/dropck.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fdropck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fdropck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fdropck.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -77,7 +77,7 @@ fn ensure_drop_params_and_item_params_correspond<'tcx>(\n     tcx.infer_ctxt().enter(|ref infcx| {\n         let impl_param_env = tcx.param_env(self_type_did);\n         let tcx = infcx.tcx;\n-        let mut fulfillment_cx = TraitEngine::new(tcx);\n+        let mut fulfillment_cx = <dyn TraitEngine<'_>>::new(tcx);\n \n         let named_type = tcx.type_of(self_type_did);\n "}, {"sha": "dc8a804bfea98db6a415c72e710e33b1b9318ace", "filename": "compiler/rustc_typeck/src/check/fn_ctxt/_impl.rs", "status": "modified", "additions": 41, "deletions": 11, "changes": 52, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Ffn_ctxt%2F_impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Ffn_ctxt%2F_impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Ffn_ctxt%2F_impl.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -6,14 +6,15 @@ use crate::check::callee::{self, DeferredCallResolution};\n use crate::check::method::{self, MethodCallee, SelfSource};\n use crate::check::{BreakableCtxt, Diverges, Expectation, FallbackMode, FnCtxt, LocalTy};\n \n+use rustc_ast::TraitObjectSyntax;\n use rustc_data_structures::captures::Captures;\n use rustc_data_structures::fx::FxHashSet;\n use rustc_errors::{Applicability, DiagnosticBuilder, ErrorReported};\n use rustc_hir as hir;\n use rustc_hir::def::{CtorOf, DefKind, Res};\n use rustc_hir::def_id::DefId;\n use rustc_hir::lang_items::LangItem;\n-use rustc_hir::{ExprKind, GenericArg, Node, QPath};\n+use rustc_hir::{ExprKind, GenericArg, Node, QPath, TyKind};\n use rustc_infer::infer::canonical::{Canonical, OriginalQueryValues, QueryResponse};\n use rustc_infer::infer::error_reporting::TypeAnnotationNeeded::E0282;\n use rustc_infer::infer::{InferOk, InferResult};\n@@ -26,7 +27,9 @@ use rustc_middle::ty::{\n     self, AdtKind, CanonicalUserType, DefIdTree, GenericParamDefKind, ToPolyTraitRef, ToPredicate,\n     Ty, UserType,\n };\n-use rustc_session::{lint, parse::feature_err};\n+use rustc_session::lint;\n+use rustc_session::lint::builtin::BARE_TRAIT_OBJECTS;\n+use rustc_session::parse::feature_err;\n use rustc_span::source_map::{original_sp, DUMMY_SP};\n use rustc_span::symbol::{kw, sym, Ident};\n use rustc_span::{self, BytePos, MultiSpan, Span};\n@@ -472,7 +475,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n     }\n \n     pub fn to_ty(&self, ast_t: &hir::Ty<'_>) -> Ty<'tcx> {\n-        let t = AstConv::ast_ty_to_ty(self, ast_t);\n+        let t = <dyn AstConv<'_>>::ast_ty_to_ty(self, ast_t);\n         self.register_wf_obligation(t.into(), ast_t.span, traits::MiscObligation);\n         t\n     }\n@@ -854,7 +857,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                         // out unconstrained or ambiguous, as we're\n                         // just trying to get hints here.\n                         self.save_and_restore_in_snapshot_flag(|_| {\n-                            let mut fulfill = TraitEngine::new(self.tcx);\n+                            let mut fulfill = <dyn TraitEngine<'_>>::new(self.tcx);\n                             for obligation in ok.obligations {\n                                 fulfill.register_predicate_obligation(self, obligation);\n                             }\n@@ -947,6 +950,10 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n             result\n         });\n \n+        if result.is_ok() {\n+            self.maybe_lint_bare_trait(qpath, hir_id);\n+        }\n+\n         // Write back the new resolution.\n         self.write_resolution(hir_id, result);\n         (\n@@ -956,6 +963,29 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         )\n     }\n \n+    fn maybe_lint_bare_trait(&self, qpath: &QPath<'_>, hir_id: hir::HirId) {\n+        if let QPath::TypeRelative(self_ty, _) = qpath {\n+            if let TyKind::TraitObject([poly_trait_ref, ..], _, TraitObjectSyntax::None) =\n+                self_ty.kind\n+            {\n+                self.tcx.struct_span_lint_hir(BARE_TRAIT_OBJECTS, hir_id, self_ty.span, |lint| {\n+                    let mut db = lint\n+                        .build(&format!(\"trait objects without an explicit `dyn` are deprecated\"));\n+                    let (sugg, app) = match self.tcx.sess.source_map().span_to_snippet(self_ty.span)\n+                    {\n+                        Ok(s) if poly_trait_ref.trait_ref.path.is_global() => {\n+                            (format!(\"<dyn ({})>\", s), Applicability::MachineApplicable)\n+                        }\n+                        Ok(s) => (format!(\"<dyn {}>\", s), Applicability::MachineApplicable),\n+                        Err(_) => (\"<dyn <type>>\".to_string(), Applicability::HasPlaceholders),\n+                    };\n+                    db.span_suggestion(self_ty.span, \"use `dyn`\", sugg, app);\n+                    db.emit()\n+                });\n+            }\n+        }\n+    }\n+\n     /// Given a function `Node`, return its `FnDecl` if it exists, or `None` otherwise.\n     pub(in super::super) fn get_node_fn_decl(\n         &self,\n@@ -1174,9 +1204,9 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n \n         let path_segs = match res {\n             Res::Local(_) | Res::SelfCtor(_) => vec![],\n-            Res::Def(kind, def_id) => {\n-                AstConv::def_ids_for_value_path_segments(self, segments, self_ty, kind, def_id)\n-            }\n+            Res::Def(kind, def_id) => <dyn AstConv<'_>>::def_ids_for_value_path_segments(\n+                self, segments, self_ty, kind, def_id,\n+            ),\n             _ => bug!(\"instantiate_value_path on {:?}\", res),\n         };\n \n@@ -1219,7 +1249,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         // errors if type parameters are provided in an inappropriate place.\n \n         let generic_segs: FxHashSet<_> = path_segs.iter().map(|PathSeg(_, index)| index).collect();\n-        let generics_has_err = AstConv::prohibit_generics(\n+        let generics_has_err = <dyn AstConv<'_>>::prohibit_generics(\n             self,\n             segments.iter().enumerate().filter_map(|(index, seg)| {\n                 if !generic_segs.contains(&index) || is_alias_variant_ctor {\n@@ -1262,7 +1292,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n             if let GenericArgCountResult {\n                 correct: Err(GenericArgCountMismatch { reported: Some(_), .. }),\n                 ..\n-            } = AstConv::check_generic_arg_count_for_call(\n+            } = <dyn AstConv<'_>>::check_generic_arg_count_for_call(\n                 tcx,\n                 span,\n                 def_id,\n@@ -1370,7 +1400,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n             ) -> subst::GenericArg<'tcx> {\n                 match (&param.kind, arg) {\n                     (GenericParamDefKind::Lifetime, GenericArg::Lifetime(lt)) => {\n-                        AstConv::ast_region_to_region(self.fcx, lt, Some(param)).into()\n+                        <dyn AstConv<'_>>::ast_region_to_region(self.fcx, lt, Some(param)).into()\n                     }\n                     (GenericParamDefKind::Type { .. }, GenericArg::Type(ty)) => {\n                         self.fcx.to_ty(ty).into()\n@@ -1423,7 +1453,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         }\n \n         let substs = self_ctor_substs.unwrap_or_else(|| {\n-            AstConv::create_substs_for_generic_args(\n+            <dyn AstConv<'_>>::create_substs_for_generic_args(\n                 tcx,\n                 def_id,\n                 &[][..],"}, {"sha": "c92c7f7ad0b9a8d61dc0b3f1fd7d003b626e117e", "filename": "compiler/rustc_typeck/src/check/fn_ctxt/checks.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Ffn_ctxt%2Fchecks.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Ffn_ctxt%2Fchecks.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Ffn_ctxt%2Fchecks.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -875,7 +875,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         match *qpath {\n             QPath::Resolved(ref maybe_qself, ref path) => {\n                 let self_ty = maybe_qself.as_ref().map(|qself| self.to_ty(qself));\n-                let ty = AstConv::res_to_ty(self, self_ty, path, true);\n+                let ty = <dyn AstConv<'_>>::res_to_ty(self, self_ty, path, true);\n                 (path.res, ty)\n             }\n             QPath::TypeRelative(ref qself, ref segment) => {\n@@ -886,8 +886,9 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                 } else {\n                     Res::Err\n                 };\n-                let result =\n-                    AstConv::associated_path_to_ty(self, hir_id, path_span, ty, res, segment, true);\n+                let result = <dyn AstConv<'_>>::associated_path_to_ty(\n+                    self, hir_id, path_span, ty, res, segment, true,\n+                );\n                 let ty = result.map(|(ty, _, _)| ty).unwrap_or_else(|_| self.tcx().ty_error());\n                 let result = result.map(|(_, kind, def_id)| (kind, def_id));\n \n@@ -1000,7 +1001,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                                         // would trigger in `is_send::<T::AssocType>();`\n                                         // from `typeck-default-trait-impl-assoc-type.rs`.\n                                     } else {\n-                                        let ty = AstConv::ast_ty_to_ty(self, hir_ty);\n+                                        let ty = <dyn AstConv<'_>>::ast_ty_to_ty(self, hir_ty);\n                                         let ty = self.resolve_vars_if_possible(ty);\n                                         if ty == predicate.self_ty() {\n                                             error.obligation.cause.make_mut().span = hir_ty.span;"}, {"sha": "f90159efb5cd551d1052e2318d186658f078a480", "filename": "compiler/rustc_typeck/src/check/fn_ctxt/suggestions.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Ffn_ctxt%2Fsuggestions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Ffn_ctxt%2Fsuggestions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Ffn_ctxt%2Fsuggestions.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -461,7 +461,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                 // are not, the expectation must have been caused by something else.\n                 debug!(\"suggest_missing_return_type: return type {:?} node {:?}\", ty, ty.kind);\n                 let sp = ty.span;\n-                let ty = AstConv::ast_ty_to_ty(self, ty);\n+                let ty = <dyn AstConv<'_>>::ast_ty_to_ty(self, ty);\n                 debug!(\"suggest_missing_return_type: return type {:?}\", ty);\n                 debug!(\"suggest_missing_return_type: expected type {:?}\", ty);\n                 if ty.kind() == expected.kind() {\n@@ -486,7 +486,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         }\n         let found = self.resolve_vars_with_obligations(found);\n         if let hir::FnRetTy::Return(ty) = fn_decl.output {\n-            let ty = AstConv::ast_ty_to_ty(self, ty);\n+            let ty = <dyn AstConv<'_>>::ast_ty_to_ty(self, ty);\n             let ty = self.tcx.erase_late_bound_regions(Binder::bind(ty));\n             let ty = self.normalize_associated_types_in(expr.span, ty);\n             if self.can_coerce(found, ty) {"}, {"sha": "1dacbade1bd32a0d68eaf322841c2e6e19d5650e", "filename": "compiler/rustc_typeck/src/check/inherited.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Finherited.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Finherited.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Finherited.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -117,7 +117,7 @@ impl Inherited<'a, 'tcx> {\n                 maybe_typeck_results: infcx.in_progress_typeck_results,\n             },\n             infcx,\n-            fulfillment_cx: RefCell::new(TraitEngine::new(tcx)),\n+            fulfillment_cx: RefCell::new(<dyn TraitEngine<'_>>::new(tcx)),\n             locals: RefCell::new(Default::default()),\n             deferred_sized_obligations: RefCell::new(Vec::new()),\n             deferred_call_resolutions: RefCell::new(Default::default()),"}, {"sha": "4a2dd6faf0c323e814a066e9fa208095b1506cc2", "filename": "compiler/rustc_typeck/src/check/method/confirm.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fconfirm.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fconfirm.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fconfirm.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -314,7 +314,7 @@ impl<'a, 'tcx> ConfirmContext<'a, 'tcx> {\n         // variables.\n         let generics = self.tcx.generics_of(pick.item.def_id);\n \n-        let arg_count_correct = AstConv::check_generic_arg_count_for_call(\n+        let arg_count_correct = <dyn AstConv<'_>>::check_generic_arg_count_for_call(\n             self.tcx,\n             self.span,\n             pick.item.def_id,\n@@ -352,7 +352,8 @@ impl<'a, 'tcx> ConfirmContext<'a, 'tcx> {\n             ) -> subst::GenericArg<'tcx> {\n                 match (&param.kind, arg) {\n                     (GenericParamDefKind::Lifetime, GenericArg::Lifetime(lt)) => {\n-                        AstConv::ast_region_to_region(self.cfcx.fcx, lt, Some(param)).into()\n+                        <dyn AstConv<'_>>::ast_region_to_region(self.cfcx.fcx, lt, Some(param))\n+                            .into()\n                     }\n                     (GenericParamDefKind::Type { .. }, GenericArg::Type(ty)) => {\n                         self.cfcx.to_ty(ty).into()\n@@ -373,7 +374,7 @@ impl<'a, 'tcx> ConfirmContext<'a, 'tcx> {\n                 self.cfcx.var_for_def(self.cfcx.span, param)\n             }\n         }\n-        AstConv::create_substs_for_generic_args(\n+        <dyn AstConv<'_>>::create_substs_for_generic_args(\n             self.tcx,\n             pick.item.def_id,\n             parent_substs,"}, {"sha": "ad9bb70377968d526d91160a093c9ed887029325", "filename": "compiler/rustc_typeck/src/check/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmod.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -495,7 +495,7 @@ fn typeck_with_fallback<'tcx>(\n         let fcx = if let (Some(header), Some(decl)) = (fn_header, fn_decl) {\n             let fn_sig = if crate::collect::get_infer_ret_ty(&decl.output).is_some() {\n                 let fcx = FnCtxt::new(&inh, param_env, body.value.hir_id);\n-                AstConv::ty_of_fn(\n+                <dyn AstConv<'_>>::ty_of_fn(\n                     &fcx,\n                     header.unsafety,\n                     header.abi,\n@@ -527,7 +527,7 @@ fn typeck_with_fallback<'tcx>(\n             let fcx = FnCtxt::new(&inh, param_env, body.value.hir_id);\n             let expected_type = body_ty\n                 .and_then(|ty| match ty.kind {\n-                    hir::TyKind::Infer => Some(AstConv::ast_ty_to_ty(&fcx, ty)),\n+                    hir::TyKind::Infer => Some(<dyn AstConv<'_>>::ast_ty_to_ty(&fcx, ty)),\n                     _ => None,\n                 })\n                 .unwrap_or_else(|| match tcx.hir().get(id) {"}, {"sha": "8cae61e8c22f6ffd3708e706de6fbd333d15f96e", "filename": "compiler/rustc_typeck/src/coherence/builtin.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcoherence%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcoherence%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcoherence%2Fbuiltin.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -246,7 +246,7 @@ fn visit_implementation_of_dispatch_from_dyn(tcx: TyCtxt<'_>, impl_did: LocalDef\n                     ))\n                     .emit();\n                 } else {\n-                    let mut fulfill_cx = TraitEngine::new(infcx.tcx);\n+                    let mut fulfill_cx = <dyn TraitEngine<'_>>::new(infcx.tcx);\n \n                     for field in coerced_fields {\n                         let predicate = predicate_for_trait_def(\n@@ -506,7 +506,7 @@ pub fn coerce_unsized_info(tcx: TyCtxt<'tcx>, impl_did: DefId) -> CoerceUnsizedI\n             }\n         };\n \n-        let mut fulfill_cx = TraitEngine::new(infcx.tcx);\n+        let mut fulfill_cx = <dyn TraitEngine<'_>>::new(infcx.tcx);\n \n         // Register an obligation for `A: Trait<B>`.\n         let cause = traits::ObligationCause::misc(span, impl_hir_id);"}, {"sha": "e5136355ca9822ad553bfd1ad1b3468a39c5acdb", "filename": "compiler/rustc_typeck/src/collect.rs", "status": "modified", "additions": 27, "deletions": 15, "changes": 42, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcollect.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcollect.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcollect.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -310,7 +310,7 @@ impl ItemCtxt<'tcx> {\n     }\n \n     pub fn to_ty(&self, ast_ty: &hir::Ty<'_>) -> Ty<'tcx> {\n-        AstConv::ast_ty_to_ty(self, ast_ty)\n+        <dyn AstConv<'_>>::ast_ty_to_ty(self, ast_ty)\n     }\n \n     pub fn hir_id(&self) -> hir::HirId {\n@@ -1096,7 +1096,7 @@ fn super_predicates_that_define_assoc_type(\n         // Convert the bounds that follow the colon, e.g., `Bar + Zed` in `trait Foo: Bar + Zed`.\n         let self_param_ty = tcx.types.self_param;\n         let superbounds1 = if let Some(assoc_name) = assoc_name {\n-            AstConv::compute_bounds_that_match_assoc_type(\n+            <dyn AstConv<'_>>::compute_bounds_that_match_assoc_type(\n                 &icx,\n                 self_param_ty,\n                 &bounds,\n@@ -1105,7 +1105,13 @@ fn super_predicates_that_define_assoc_type(\n                 assoc_name,\n             )\n         } else {\n-            AstConv::compute_bounds(&icx, self_param_ty, &bounds, SizedByDefault::No, item.span)\n+            <dyn AstConv<'_>>::compute_bounds(\n+                &icx,\n+                self_param_ty,\n+                &bounds,\n+                SizedByDefault::No,\n+                item.span,\n+            )\n         };\n \n         let superbounds1 = superbounds1.predicates(tcx, self_param_ty);\n@@ -1689,7 +1695,7 @@ fn fn_sig(tcx: TyCtxt<'_>, def_id: DefId) -> ty::PolyFnSig<'_> {\n \n                     ty::Binder::bind(fn_sig)\n                 }\n-                None => AstConv::ty_of_fn(\n+                None => <dyn AstConv<'_>>::ty_of_fn(\n                     &icx,\n                     sig.header.unsafety,\n                     sig.header.abi,\n@@ -1706,7 +1712,7 @@ fn fn_sig(tcx: TyCtxt<'_>, def_id: DefId) -> ty::PolyFnSig<'_> {\n             ident,\n             generics,\n             ..\n-        }) => AstConv::ty_of_fn(\n+        }) => <dyn AstConv<'_>>::ty_of_fn(\n             &icx,\n             header.unsafety,\n             header.abi,\n@@ -1767,7 +1773,7 @@ fn impl_trait_ref(tcx: TyCtxt<'_>, def_id: DefId) -> Option<ty::TraitRef<'_>> {\n     match tcx.hir().expect_item(hir_id).kind {\n         hir::ItemKind::Impl(ref impl_) => impl_.of_trait.as_ref().map(|ast_trait_ref| {\n             let selfty = tcx.type_of(def_id);\n-            AstConv::instantiate_mono_trait_ref(&icx, ast_trait_ref, selfty)\n+            <dyn AstConv<'_>>::instantiate_mono_trait_ref(&icx, ast_trait_ref, selfty)\n         }),\n         _ => bug!(),\n     }\n@@ -2018,7 +2024,7 @@ fn gather_explicit_predicates_of(tcx: TyCtxt<'_>, def_id: DefId) -> ty::GenericP\n             GenericParamKind::Lifetime { .. } => {\n                 param.bounds.iter().for_each(|bound| match bound {\n                     hir::GenericBound::Outlives(lt) => {\n-                        let bound = AstConv::ast_region_to_region(&icx, &lt, None);\n+                        let bound = <dyn AstConv<'_>>::ast_region_to_region(&icx, &lt, None);\n                         let outlives = ty::Binder::bind(ty::OutlivesPredicate(region, bound));\n                         predicates.insert((outlives.to_predicate(tcx), lt.span));\n                     }\n@@ -2041,8 +2047,13 @@ fn gather_explicit_predicates_of(tcx: TyCtxt<'_>, def_id: DefId) -> ty::GenericP\n                 index += 1;\n \n                 let sized = SizedByDefault::Yes;\n-                let bounds =\n-                    AstConv::compute_bounds(&icx, param_ty, &param.bounds, sized, param.span);\n+                let bounds = <dyn AstConv<'_>>::compute_bounds(\n+                    &icx,\n+                    param_ty,\n+                    &param.bounds,\n+                    sized,\n+                    param.span,\n+                );\n                 predicates.extend(bounds.predicates(tcx, param_ty));\n             }\n             GenericParamKind::Const { .. } => {\n@@ -2091,7 +2102,7 @@ fn gather_explicit_predicates_of(tcx: TyCtxt<'_>, def_id: DefId) -> ty::GenericP\n                             };\n \n                             let mut bounds = Bounds::default();\n-                            let _ = AstConv::instantiate_poly_trait_ref(\n+                            let _ = <dyn AstConv<'_>>::instantiate_poly_trait_ref(\n                                 &icx,\n                                 &poly_trait_ref,\n                                 constness,\n@@ -2103,7 +2114,7 @@ fn gather_explicit_predicates_of(tcx: TyCtxt<'_>, def_id: DefId) -> ty::GenericP\n \n                         &hir::GenericBound::LangItemTrait(lang_item, span, hir_id, args) => {\n                             let mut bounds = Bounds::default();\n-                            AstConv::instantiate_lang_item_trait_ref(\n+                            <dyn AstConv<'_>>::instantiate_lang_item_trait_ref(\n                                 &icx,\n                                 lang_item,\n                                 span,\n@@ -2116,7 +2127,8 @@ fn gather_explicit_predicates_of(tcx: TyCtxt<'_>, def_id: DefId) -> ty::GenericP\n                         }\n \n                         hir::GenericBound::Outlives(lifetime) => {\n-                            let region = AstConv::ast_region_to_region(&icx, lifetime, None);\n+                            let region =\n+                                <dyn AstConv<'_>>::ast_region_to_region(&icx, lifetime, None);\n                             predicates.insert((\n                                 ty::Binder::bind(ty::PredicateKind::TypeOutlives(\n                                     ty::OutlivesPredicate(ty, region),\n@@ -2130,11 +2142,11 @@ fn gather_explicit_predicates_of(tcx: TyCtxt<'_>, def_id: DefId) -> ty::GenericP\n             }\n \n             hir::WherePredicate::RegionPredicate(region_pred) => {\n-                let r1 = AstConv::ast_region_to_region(&icx, &region_pred.lifetime, None);\n+                let r1 = <dyn AstConv<'_>>::ast_region_to_region(&icx, &region_pred.lifetime, None);\n                 predicates.extend(region_pred.bounds.iter().map(|bound| {\n                     let (r2, span) = match bound {\n                         hir::GenericBound::Outlives(lt) => {\n-                            (AstConv::ast_region_to_region(&icx, lt, None), lt.span)\n+                            (<dyn AstConv<'_>>::ast_region_to_region(&icx, lt, None), lt.span)\n                         }\n                         _ => bug!(),\n                     };\n@@ -2377,7 +2389,7 @@ fn compute_sig_of_foreign_fn_decl<'tcx>(\n     } else {\n         hir::Unsafety::Unsafe\n     };\n-    let fty = AstConv::ty_of_fn(\n+    let fty = <dyn AstConv<'_>>::ty_of_fn(\n         &ItemCtxt::new(tcx, def_id),\n         unsafety,\n         abi,"}, {"sha": "a5b36445aae2e2e31f157bd9f7f9595dbb045142", "filename": "compiler/rustc_typeck/src/collect/item_bounds.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcollect%2Fitem_bounds.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Fcollect%2Fitem_bounds.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcollect%2Fitem_bounds.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -25,7 +25,7 @@ fn associated_type_bounds<'tcx>(\n         InternalSubsts::identity_for_item(tcx, assoc_item_def_id),\n     );\n \n-    let bounds = AstConv::compute_bounds(\n+    let bounds = <dyn AstConv<'_>>::compute_bounds(\n         &ItemCtxt::new(tcx, assoc_item_def_id),\n         item_ty,\n         &bounds,\n@@ -66,7 +66,7 @@ fn opaque_type_bounds<'tcx>(\n         let item_ty =\n             tcx.mk_opaque(opaque_def_id, InternalSubsts::identity_for_item(tcx, opaque_def_id));\n \n-        let bounds = AstConv::compute_bounds(\n+        let bounds = <dyn AstConv<'_>>::compute_bounds(\n             &ItemCtxt::new(tcx, opaque_def_id),\n             item_ty,\n             &bounds,"}, {"sha": "88b47bf5b9cdd68afaea71da39a1520b0fca8737", "filename": "compiler/rustc_typeck/src/lib.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/compiler%2Frustc_typeck%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Flib.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -142,7 +142,7 @@ fn require_same_types<'tcx>(\n ) -> bool {\n     tcx.infer_ctxt().enter(|ref infcx| {\n         let param_env = ty::ParamEnv::empty();\n-        let mut fulfill_cx = TraitEngine::new(infcx.tcx);\n+        let mut fulfill_cx = <dyn TraitEngine<'_>>::new(infcx.tcx);\n         match infcx.at(&cause, param_env).eq(expected, actual) {\n             Ok(InferOk { obligations, .. }) => {\n                 fulfill_cx.register_predicate_obligations(infcx, obligations);\n@@ -444,7 +444,7 @@ pub fn hir_trait_to_predicates<'tcx>(\n     let env_def_id = tcx.hir().local_def_id(env_hir_id);\n     let item_cx = self::collect::ItemCtxt::new(tcx, env_def_id.to_def_id());\n     let mut bounds = Bounds::default();\n-    let _ = AstConv::instantiate_poly_trait_ref_inner(\n+    let _ = <dyn AstConv<'_>>::instantiate_poly_trait_ref_inner(\n         &item_cx,\n         hir_trait,\n         DUMMY_SP,"}, {"sha": "98c34f344251e54f8bbd02eccff48ea409e66b0d", "filename": "library/core/src/any.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/library%2Fcore%2Fsrc%2Fany.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/library%2Fcore%2Fsrc%2Fany.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fany.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -285,7 +285,7 @@ impl dyn Any + Send {\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     #[inline]\n     pub fn is<T: Any>(&self) -> bool {\n-        Any::is::<T>(self)\n+        <dyn Any>::is::<T>(self)\n     }\n \n     /// Forwards to the method defined on the type `Any`.\n@@ -309,7 +309,7 @@ impl dyn Any + Send {\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     #[inline]\n     pub fn downcast_ref<T: Any>(&self) -> Option<&T> {\n-        Any::downcast_ref::<T>(self)\n+        <dyn Any>::downcast_ref::<T>(self)\n     }\n \n     /// Forwards to the method defined on the type `Any`.\n@@ -337,7 +337,7 @@ impl dyn Any + Send {\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     #[inline]\n     pub fn downcast_mut<T: Any>(&mut self) -> Option<&mut T> {\n-        Any::downcast_mut::<T>(self)\n+        <dyn Any>::downcast_mut::<T>(self)\n     }\n }\n \n@@ -363,7 +363,7 @@ impl dyn Any + Send + Sync {\n     #[stable(feature = \"any_send_sync_methods\", since = \"1.28.0\")]\n     #[inline]\n     pub fn is<T: Any>(&self) -> bool {\n-        Any::is::<T>(self)\n+        <dyn Any>::is::<T>(self)\n     }\n \n     /// Forwards to the method defined on the type `Any`.\n@@ -387,7 +387,7 @@ impl dyn Any + Send + Sync {\n     #[stable(feature = \"any_send_sync_methods\", since = \"1.28.0\")]\n     #[inline]\n     pub fn downcast_ref<T: Any>(&self) -> Option<&T> {\n-        Any::downcast_ref::<T>(self)\n+        <dyn Any>::downcast_ref::<T>(self)\n     }\n \n     /// Forwards to the method defined on the type `Any`.\n@@ -415,7 +415,7 @@ impl dyn Any + Send + Sync {\n     #[stable(feature = \"any_send_sync_methods\", since = \"1.28.0\")]\n     #[inline]\n     pub fn downcast_mut<T: Any>(&mut self) -> Option<&mut T> {\n-        Any::downcast_mut::<T>(self)\n+        <dyn Any>::downcast_mut::<T>(self)\n     }\n }\n "}, {"sha": "17a961a5f6655efcfee3dee5a6cb84b79eeb4492", "filename": "src/librustdoc/clean/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Flibrustdoc%2Fclean%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Flibrustdoc%2Fclean%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Fmod.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -1477,7 +1477,7 @@ impl Clean<Type> for hir::Ty<'_> {\n                 }\n             }\n             TyKind::Path(_) => clean_qpath(&self, cx),\n-            TyKind::TraitObject(ref bounds, ref lifetime) => {\n+            TyKind::TraitObject(ref bounds, ref lifetime, _) => {\n                 match bounds[0].clean(cx).trait_ {\n                     ResolvedPath { path, param_names: None, did, is_generic } => {\n                         let mut bounds: Vec<self::GenericBound> = bounds[1..]"}, {"sha": "4c961e998df64aad2d21614ae0f029812119d130", "filename": "src/test/ui/lint/bare-trait-objects-path.rs", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Flint%2Fbare-trait-objects-path.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Flint%2Fbare-trait-objects-path.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fbare-trait-objects-path.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -0,0 +1,18 @@\n+#![feature(associated_type_defaults)]\n+\n+trait Assoc {\n+    fn func() {}\n+    const CONST: u8 = 0;\n+    type Ty = u8;\n+}\n+\n+trait Dyn {}\n+\n+impl Assoc for dyn Dyn {}\n+\n+fn main() {\n+    Dyn::func(); //~ WARN trait objects without an explicit `dyn` are deprecated\n+    ::Dyn::func(); //~ WARN trait objects without an explicit `dyn` are deprecated\n+    Dyn::CONST; //~ WARN trait objects without an explicit `dyn` are deprecated\n+    let _: Dyn::Ty; //~ ERROR ambiguous associated type\n+}"}, {"sha": "0a2dc5858285a8289181dc2291f5b0487fc76a0e", "filename": "src/test/ui/lint/bare-trait-objects-path.stderr", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Flint%2Fbare-trait-objects-path.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Flint%2Fbare-trait-objects-path.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fbare-trait-objects-path.stderr?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -0,0 +1,29 @@\n+error[E0223]: ambiguous associated type\n+  --> $DIR/bare-trait-objects-path.rs:17:12\n+   |\n+LL |     let _: Dyn::Ty;\n+   |            ^^^^^^^ help: use fully-qualified syntax: `<dyn Dyn as Trait>::Ty`\n+\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/bare-trait-objects-path.rs:14:5\n+   |\n+LL |     Dyn::func();\n+   |     ^^^ help: use `dyn`: `<dyn Dyn>`\n+   |\n+   = note: `#[warn(bare_trait_objects)]` on by default\n+\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/bare-trait-objects-path.rs:15:5\n+   |\n+LL |     ::Dyn::func();\n+   |     ^^^^^ help: use `dyn`: `<dyn (::Dyn)>`\n+\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/bare-trait-objects-path.rs:16:5\n+   |\n+LL |     Dyn::CONST;\n+   |     ^^^ help: use `dyn`: `<dyn Dyn>`\n+\n+error: aborting due to previous error; 3 warnings emitted\n+\n+For more information about this error, try `rustc --explain E0223`."}, {"sha": "f512d91ebeb4a298dc85eb4a69865dbe1bc83b4f", "filename": "src/test/ui/traits/impl.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Ftraits%2Fimpl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Ftraits%2Fimpl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Fimpl.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -30,8 +30,8 @@ fn main() {\n     let x: &dyn T = &42;\n \n     x.foo();\n-    T::foo(x);\n-    T::bar();\n+    <dyn T>::foo(x);\n+    <dyn T>::bar();\n \n     unsafe { assert_eq!(COUNT, 12); }\n "}, {"sha": "727897d20cb4cfae292a352cd021985092cc8110", "filename": "src/test/ui/traits/inheritance/repeated-supertrait-ambig.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Ftraits%2Finheritance%2Frepeated-supertrait-ambig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Ftraits%2Finheritance%2Frepeated-supertrait-ambig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Finheritance%2Frepeated-supertrait-ambig.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -31,7 +31,7 @@ fn with_trait<C:CompareToInts>(c: &C) -> bool {\n }\n \n fn with_ufcs1<C:CompareToInts>(c: &C) -> bool {\n-    CompareToInts::same_as(c, 22) //~ ERROR `dyn CompareToInts: CompareTo<i32>` is not satisfied\n+    <dyn CompareToInts>::same_as(c, 22) //~ ERROR `dyn CompareToInts: CompareTo<i32>` is not satisfi\n }\n \n fn with_ufcs2<C:CompareToInts>(c: &C) -> bool {"}, {"sha": "bb11f18e54505bd8f953ae9599edbb2a8f405847", "filename": "src/test/ui/traits/inheritance/repeated-supertrait-ambig.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Ftraits%2Finheritance%2Frepeated-supertrait-ambig.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Ftraits%2Finheritance%2Frepeated-supertrait-ambig.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Finheritance%2Frepeated-supertrait-ambig.stderr?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -21,8 +21,8 @@ error[E0277]: the trait bound `dyn CompareToInts: CompareTo<i32>` is not satisfi\n LL |     fn same_as(&self, t: T) -> bool;\n    |     -------------------------------- required by `CompareTo::same_as`\n ...\n-LL |     CompareToInts::same_as(c, 22)\n-   |     ^^^^^^^^^^^^^^^^^^^^^^ the trait `CompareTo<i32>` is not implemented for `dyn CompareToInts`\n+LL |     <dyn CompareToInts>::same_as(c, 22)\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ the trait `CompareTo<i32>` is not implemented for `dyn CompareToInts`\n \n error[E0277]: the trait bound `C: CompareTo<i32>` is not satisfied\n   --> $DIR/repeated-supertrait-ambig.rs:38:5"}, {"sha": "cb2581ffa99a5c43bc3210ef81c467032a1fb110", "filename": "src/test/ui/traits/inheritance/repeated-supertrait.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Ftraits%2Finheritance%2Frepeated-supertrait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Ftraits%2Finheritance%2Frepeated-supertrait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Finheritance%2Frepeated-supertrait.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -31,7 +31,7 @@ fn with_trait<C:CompareToInts>(c: &C) -> bool {\n }\n \n fn with_ufcs1<C:CompareToInts>(c: &C) -> bool {\n-    CompareToInts::same_as(c, 22_i64) && CompareToInts::same_as(c, 22_u64)\n+    <dyn CompareToInts>::same_as(c, 22_i64) && <dyn CompareToInts>::same_as(c, 22_u64)\n }\n \n fn with_ufcs2<C:CompareToInts>(c: &C) -> bool {"}, {"sha": "38d06b967bc7950f8878f4226f60b710a76a9588", "filename": "src/test/ui/traits/item-privacy.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Ftraits%2Fitem-privacy.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Ftraits%2Fitem-privacy.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Fitem-privacy.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -81,8 +81,8 @@ fn check_method() {\n     //~^ ERROR no function or associated item named `b` found\n     S::c(&S); // OK\n     // a, b, c are resolved as inherent items, their traits don't need to be in scope\n-    C::a(&S); //~ ERROR associated function `a` is private\n-    C::b(&S); // OK\n+    <dyn C>::a(&S); //~ ERROR associated function `a` is private\n+    <dyn C>::b(&S); // OK\n     C::c(&S); // OK\n }\n \n@@ -98,9 +98,9 @@ fn check_assoc_const() {\n     S::B; //~ ERROR no associated item named `B` found\n     S::C; // OK\n     // A, B, C are resolved as inherent items, their traits don't need to be in scope\n-    C::A; //~ ERROR associated constant `A` is private\n-          //~^ ERROR the trait `assoc_const::C` cannot be made into an object\n-    C::B; // ERROR the trait `assoc_const::C` cannot be made into an object\n+    <dyn C>::A; //~ ERROR associated constant `A` is private\n+                //~^ ERROR the trait `assoc_const::C` cannot be made into an object\n+    <dyn C>::B; // ERROR the trait `assoc_const::C` cannot be made into an object\n     C::C; // OK\n }\n "}, {"sha": "68d527dc786aa2cc8406d9cdda218097a0755837", "filename": "src/test/ui/traits/item-privacy.stderr", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Ftraits%2Fitem-privacy.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftest%2Fui%2Ftraits%2Fitem-privacy.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Fitem-privacy.stderr?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -67,10 +67,10 @@ LL | use method::B;\n    |\n \n error[E0624]: associated function `a` is private\n-  --> $DIR/item-privacy.rs:84:8\n+  --> $DIR/item-privacy.rs:84:14\n    |\n-LL |     C::a(&S);\n-   |        ^ private associated function\n+LL |     <dyn C>::a(&S);\n+   |              ^ private associated function\n \n error[E0599]: no associated item named `A` found for struct `S` in the current scope\n   --> $DIR/item-privacy.rs:97:8\n@@ -104,16 +104,16 @@ LL | use assoc_const::B;\n    |\n \n error[E0624]: associated constant `A` is private\n-  --> $DIR/item-privacy.rs:101:8\n+  --> $DIR/item-privacy.rs:101:14\n    |\n-LL |     C::A;\n-   |        ^ private associated constant\n+LL |     <dyn C>::A;\n+   |              ^ private associated constant\n \n error[E0038]: the trait `assoc_const::C` cannot be made into an object\n-  --> $DIR/item-privacy.rs:101:5\n+  --> $DIR/item-privacy.rs:101:6\n    |\n-LL |     C::A;\n-   |     ^ `assoc_const::C` cannot be made into an object\n+LL |     <dyn C>::A;\n+   |      ^^^^^ `assoc_const::C` cannot be made into an object\n    |\n    = help: consider moving `C` to another trait\n    = help: consider moving `B` to another trait"}, {"sha": "3ac6e6cbbefcf49f1b924cbb8b7278f7ebea0204", "filename": "src/tools/clippy/clippy_lints/src/lifetimes.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Flifetimes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Flifetimes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Flifetimes.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -387,7 +387,7 @@ impl<'a, 'tcx> Visitor<'tcx> for RefVisitor<'a, 'tcx> {\n                 self.nested_elision_site_lts.append(&mut sub_visitor.all_lts());\n                 return;\n             },\n-            TyKind::TraitObject(bounds, ref lt) => {\n+            TyKind::TraitObject(bounds, ref lt, _) => {\n                 if !lt.is_elided() {\n                     self.unelided_trait_object_lifetime = true;\n                 }"}, {"sha": "81090040d92e0af42b1f8a9a700305119d6bc3d8", "filename": "src/tools/clippy/clippy_lints/src/types/borrowed_box.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Ftypes%2Fborrowed_box.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Ftypes%2Fborrowed_box.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Ftypes%2Fborrowed_box.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -50,7 +50,7 @@ pub(super) fn check(cx: &LateContext<'_>, hir_ty: &hir::Ty<'_>, lt: &Lifetime, m\n                     // Originally reported as the issue #3128.\n                     let inner_snippet = snippet(cx, inner.span, \"..\");\n                     let suggestion = match &inner.kind {\n-                        TyKind::TraitObject(bounds, lt_bound) if bounds.len() > 1 || !lt_bound.is_elided() => {\n+                        TyKind::TraitObject(bounds, lt_bound, _) if bounds.len() > 1 || !lt_bound.is_elided() => {\n                             format!(\"&{}({})\", ltopt, &inner_snippet)\n                         },\n                         TyKind::Path(qpath)\n@@ -86,7 +86,7 @@ pub(super) fn check(cx: &LateContext<'_>, hir_ty: &hir::Ty<'_>, lt: &Lifetime, m\n // Returns true if given type is `Any` trait.\n fn is_any_trait(t: &hir::Ty<'_>) -> bool {\n     if_chain! {\n-        if let TyKind::TraitObject(ref traits, _) = t.kind;\n+        if let TyKind::TraitObject(ref traits, ..) = t.kind;\n         if !traits.is_empty();\n         // Only Send/Sync can be used as additional traits, so it is enough to\n         // check only the first trait."}, {"sha": "4a1a608e8ae62ea308ffa0f7dcb43e6f3b2129b0", "filename": "src/tools/clippy/clippy_lints/src/types/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Ftypes%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Ftypes%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Ftypes%2Fmod.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -911,7 +911,7 @@ impl<'tcx> Visitor<'tcx> for TypeComplexityVisitor {\n             // function types bring a lot of overhead\n             TyKind::BareFn(ref bare) if bare.abi == Abi::Rust => (50 * self.nest, 1),\n \n-            TyKind::TraitObject(ref param_bounds, _) => {\n+            TyKind::TraitObject(ref param_bounds, ..) => {\n                 let has_lifetime_parameters = param_bounds.iter().any(|bound| {\n                     bound\n                         .bound_generic_params"}, {"sha": "7f7d9c5f56a1e0463071f9a9784083beb9c46241", "filename": "src/tools/clippy/clippy_utils/src/hir_utils.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Fhir_utils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aafe452b898aa3fdfb2c5a1a649ed0922e1401d/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Fhir_utils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Fhir_utils.rs?ref=2aafe452b898aa3fdfb2c5a1a649ed0922e1401d", "patch": "@@ -892,7 +892,7 @@ impl<'a, 'tcx> SpanlessHash<'a, 'tcx> {\n             TyKind::OpaqueDef(_, arg_list) => {\n                 self.hash_generic_args(arg_list);\n             },\n-            TyKind::TraitObject(_, lifetime) => {\n+            TyKind::TraitObject(_, lifetime, _) => {\n                 self.hash_lifetime(lifetime);\n             },\n             TyKind::Typeof(anon_const) => {"}]}