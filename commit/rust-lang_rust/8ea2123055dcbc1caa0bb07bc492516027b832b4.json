{"sha": "8ea2123055dcbc1caa0bb07bc492516027b832b4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhlYTIxMjMwNTVkY2JjMWNhYTBiYjA3YmM0OTI1MTYwMjdiODMyYjQ=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-11-01T19:46:21Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-11-01T19:46:21Z"}, "message": "auto merge of #10220 : luqmana/rust/con, r=brson\n\nPreviously we were actually overwriting `CFG_{HOST,TARGET,BUILD}` with `CFG_{HOST,TARGET,BUILD}_TRIPLE(S)` since configure tested for the legacy one by checking if it was empty which would never be the case. That meant it wouldn't split up multiple triples and just treat it as one long triple.\r\n\r\nThis pull also fixes the rules that were changed when librustuv was added to use the right CFG_ vars and removes the legacy flags.", "tree": {"sha": "ae5ce8f02a23e7886060d90c33e56fc896c14f4a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ae5ce8f02a23e7886060d90c33e56fc896c14f4a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8ea2123055dcbc1caa0bb07bc492516027b832b4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8ea2123055dcbc1caa0bb07bc492516027b832b4", "html_url": "https://github.com/rust-lang/rust/commit/8ea2123055dcbc1caa0bb07bc492516027b832b4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8ea2123055dcbc1caa0bb07bc492516027b832b4/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fa2bb970d1c3085861ad0b1f88c2f7b4fb82464c", "url": "https://api.github.com/repos/rust-lang/rust/commits/fa2bb970d1c3085861ad0b1f88c2f7b4fb82464c", "html_url": "https://github.com/rust-lang/rust/commit/fa2bb970d1c3085861ad0b1f88c2f7b4fb82464c"}, {"sha": "d9decf30bd12f5b97a99739a57a2f8611fa36443", "url": "https://api.github.com/repos/rust-lang/rust/commits/d9decf30bd12f5b97a99739a57a2f8611fa36443", "html_url": "https://github.com/rust-lang/rust/commit/d9decf30bd12f5b97a99739a57a2f8611fa36443"}], "stats": {"total": 46, "additions": 10, "deletions": 36}, "files": [{"sha": "4baa17fe7c0894264f6e6c1d4d1b22cf11851476", "filename": "configure", "status": "modified", "additions": 0, "deletions": 26, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/8ea2123055dcbc1caa0bb07bc492516027b832b4/configure", "raw_url": "https://github.com/rust-lang/rust/raw/8ea2123055dcbc1caa0bb07bc492516027b832b4/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=8ea2123055dcbc1caa0bb07bc492516027b832b4", "patch": "@@ -400,11 +400,6 @@ valopt infodir \"${CFG_PREFIX}/share/info\" \"install additional info\"\n valopt mandir \"${CFG_PREFIX}/share/man\" \"install man pages in PATH\"\n valopt libdir \"${CFG_PREFIX}/lib\" \"install libraries\" \n \n-#Deprecated opts to keep compatibility\n-valopt build-triple \"${CFG_BUILD}\" \"LLVM build triple\"\n-valopt host-triples \"${CFG_HOST}\" \"LLVM host triples\"\n-valopt target-triples \"${CFG_TARGET}\" \"LLVM target triples\"\n-\n # Validate Options\n step_msg \"validating $CFG_SELF args\"\n validate_opt\n@@ -601,7 +596,6 @@ then\n fi\n \n # a little post-processing of various config values\n-\n CFG_PREFIX=${CFG_PREFIX%/}\n CFG_MANDIR=${CFG_MANDIR%/}\n CFG_HOST=\"$(echo $CFG_HOST | tr ',' ' ')\"\n@@ -616,26 +610,6 @@ do\n done\n CFG_TARGET=$V_TEMP\n \n-# copy host-triples to target-triples so that hosts are a subset of targets\n-# XXX: remove deprecated variables here\n-V_TEMP=\"\"\n-for i in $CFG_HOST_TRIPLES $CFG_TARGET_TRIPLES;\n-do\n-   echo \"$V_TEMP\" | grep -qF $i || V_TEMP=\"$V_TEMP${V_TEMP:+ }$i\"\n-done\n-CFG_TARGET_TRIPLES=$V_TEMP\n-\n-# XXX: Support for deprecated syntax, should be dropped.\n-if [ ! -z \"$CFG_BUILD_TRIPLE\" ]; then\n-    CFG_BUILD=${CFG_BUILD_TRIPLE}\n-fi\n-if [ ! -z \"$CFG_HOST_TRIPLES\" ]; then\n-    CFG_HOST=${CFG_HOST_TRIPLES}\n-fi\n-if [ ! -z \"$CFG_TARGET_TRIPLES\" ]; then\n-    CFG_TARGET=${CFG_TARGET_TRIPLES}\n-fi\n-\n # check target-specific tool-chains\n for i in $CFG_TARGET\n do"}, {"sha": "e671e65ea093dfd18ac1d401a30f169f79336178", "filename": "mk/stage0.mk", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/8ea2123055dcbc1caa0bb07bc492516027b832b4/mk%2Fstage0.mk", "raw_url": "https://github.com/rust-lang/rust/raw/8ea2123055dcbc1caa0bb07bc492516027b832b4/mk%2Fstage0.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fstage0.mk?ref=8ea2123055dcbc1caa0bb07bc492516027b832b4", "patch": "@@ -42,14 +42,14 @@ $(HLIB0_H_$(CFG_BUILD))/$(CFG_EXTRALIB_$(CFG_BUILD)): \\\n \t\t| $(HLIB0_H_$(CFG_BUILD))/\n \t$(Q)touch $@\n \n-$(HLIB0_H_$(CFG_BUILD_TRIPLE))/$(CFG_LIBRUSTUV_$(CFG_BUILD)): \\\n-\t\t$(HBIN0_H_$(CFG_BUILD_TRIPLE))/rustc$(X_$(CFG_BUILD)) \\\n-\t\t| $(HLIB0_H_$(CFG_BUILD_TRIPLE))/\n+$(HLIB0_H_$(CFG_BUILD))/$(CFG_LIBRUSTUV_$(CFG_BUILD)): \\\n+\t\t$(HBIN0_H_$(CFG_BUILD))/rustc$(X_$(CFG_BUILD)) \\\n+\t\t| $(HLIB0_H_$(CFG_BUILD))/\n \t$(Q)touch $@\n \n-$(HLIB0_H_$(CFG_BUILD_TRIPLE))/$(CFG_LIBRUSTC_$(CFG_BUILD)): \\\n-\t\t$(HBIN0_H_$(CFG_BUILD_TRIPLE))/rustc$(X_$(CFG_BUILD)) \\\n-\t\t| $(HLIB0_H_$(CFG_BUILD_TRIPLE))/\n+$(HLIB0_H_$(CFG_BUILD))/$(CFG_LIBRUSTC_$(CFG_BUILD)): \\\n+\t\t$(HBIN0_H_$(CFG_BUILD))/rustc$(X_$(CFG_BUILD)) \\\n+\t\t| $(HLIB0_H_$(CFG_BUILD))/\n \t$(Q)touch $@\n \n $(HLIB0_H_$(CFG_BUILD))/$(CFG_RUSTLLVM_$(CFG_BUILD)): \\\n@@ -124,5 +124,5 @@ endef\n \n # Use stage1 to build other architectures: then you don't have to wait\n # for stage2, but you get the latest updates to the compiler source.\n-$(foreach t,$(NON_BUILD_HOSTS),\t\t\t\t\t\t\t\t\\\n+$(foreach t,$(NON_BUILD_HOST),\t\t\t\t\t\t\t\t\\\n  $(eval $(call BOOTSTRAP_STAGE0,$(t),1,$(CFG_BUILD))))"}, {"sha": "02242897d3557a6e9c6a3a97ebed8ba8ebad26a9", "filename": "mk/tests.mk", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/8ea2123055dcbc1caa0bb07bc492516027b832b4/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/8ea2123055dcbc1caa0bb07bc492516027b832b4/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=8ea2123055dcbc1caa0bb07bc492516027b832b4", "patch": "@@ -164,7 +164,7 @@ $(info check: android device test dir $(CFG_ADB_TEST_DIR) ready \\\n                   $(CFG_ADB_TEST_DIR)) \\\n  $(shell adb push $(TLIB2_T_arm-linux-androideabi_H_$(CFG_BUILD))/$(EXTRALIB_GLOB_arm-linux-androideabi) \\\n                   $(CFG_ADB_TEST_DIR)) \\\n- $(shell adb push $(TLIB2_T_arm-linux-androideabi_H_$(CFG_BUILD_TRIPLE))/$(LIBRUSTUV_GLOB_arm-linux-androideabi) \\\n+ $(shell adb push $(TLIB2_T_arm-linux-androideabi_H_$(CFG_BUILD))/$(LIBRUSTUV_GLOB_arm-linux-androideabi) \\\n                   $(CFG_ADB_TEST_DIR)) \\\n  )\n else\n@@ -471,8 +471,8 @@ define DEF_RUSTPKG_STACK_FIX\n $$(call TEST_OK_FILE,$(1),$(2),$(3),rustpkg): export RUST_MIN_STACK=8000000\n endef\n \n-$(foreach host,$(CFG_HOST_TRIPLES), \\\n- $(foreach target,$(CFG_TARGET_TRIPLES), \\\n+$(foreach host,$(CFG_HOST), \\\n+ $(foreach target,$(CFG_TARGET), \\\n   $(foreach stage,$(STAGES), \\\n    $(eval $(call DEF_RUSTPKG_STACK_FIX,$(stage),$(target),$(host))))))\n "}]}