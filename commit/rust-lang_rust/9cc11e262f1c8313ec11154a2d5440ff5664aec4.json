{"sha": "9cc11e262f1c8313ec11154a2d5440ff5664aec4", "node_id": "C_kwDOAAsO6NoAKDljYzExZTI2MmYxYzgzMTNlYzExMTU0YTJkNTQ0MGZmNTY2NGFlYzQ", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-10-04T13:23:57Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-10-04T15:31:49Z"}, "message": "test Miri changes in PR CI; we no longer need xargo", "tree": {"sha": "89d76a9e3a632d2715db09e315d0a5b05776f299", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/89d76a9e3a632d2715db09e315d0a5b05776f299"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9cc11e262f1c8313ec11154a2d5440ff5664aec4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9cc11e262f1c8313ec11154a2d5440ff5664aec4", "html_url": "https://github.com/rust-lang/rust/commit/9cc11e262f1c8313ec11154a2d5440ff5664aec4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9cc11e262f1c8313ec11154a2d5440ff5664aec4/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6f2b52ff103f9095fb2817637bc7d388bd4c7f6b", "url": "https://api.github.com/repos/rust-lang/rust/commits/6f2b52ff103f9095fb2817637bc7d388bd4c7f6b", "html_url": "https://github.com/rust-lang/rust/commit/6f2b52ff103f9095fb2817637bc7d388bd4c7f6b"}], "stats": {"total": 90, "additions": 25, "deletions": 65}, "files": [{"sha": "641d04109af163a9404e724fd29f7d1a58946e8a", "filename": "Cargo.lock", "status": "modified", "additions": 22, "deletions": 51, "changes": 73, "blob_url": "https://github.com/rust-lang/rust/blob/9cc11e262f1c8313ec11154a2d5440ff5664aec4/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/9cc11e262f1c8313ec11154a2d5440ff5664aec4/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=9cc11e262f1c8313ec11154a2d5440ff5664aec4", "patch": "@@ -383,11 +383,12 @@ version = \"0.1.0\"\n dependencies = [\n  \"cargo_metadata 0.15.0\",\n  \"directories\",\n+ \"rustc-build-sysroot\",\n  \"rustc-workspace-hack\",\n+ \"rustc_tools_util 0.2.1\",\n  \"rustc_version\",\n  \"serde\",\n  \"serde_json\",\n- \"vergen\",\n ]\n \n [[package]]\n@@ -644,7 +645,7 @@ dependencies = [\n  \"regex\",\n  \"rustc-semver\",\n  \"rustc-workspace-hack\",\n- \"rustc_tools_util\",\n+ \"rustc_tools_util 0.2.0\",\n  \"semver\",\n  \"serde\",\n  \"syn\",\n@@ -1079,9 +1080,9 @@ dependencies = [\n \n [[package]]\n name = \"directories\"\n-version = \"3.0.2\"\n+version = \"4.0.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"e69600ff1703123957937708eb27f7a564e48885c537782722ed0ba3189ce1d7\"\n+checksum = \"f51c5d4ddabd36886dd3e1438cb358cdcb0d7c499cb99cb4ac2e38e18b5cb210\"\n dependencies = [\n  \"dirs-sys\",\n ]\n@@ -1171,26 +1172,6 @@ dependencies = [\n  \"log\",\n ]\n \n-[[package]]\n-name = \"enum-iterator\"\n-version = \"0.6.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"c79a6321a1197d7730510c7e3f6cb80432dfefecb32426de8cea0aa19b4bb8d7\"\n-dependencies = [\n- \"enum-iterator-derive\",\n-]\n-\n-[[package]]\n-name = \"enum-iterator-derive\"\n-version = \"0.6.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"1e94aa31f7c0dc764f57896dc615ddd76fc13b0d5dca7eb6cc5e018a5a09ec06\"\n-dependencies = [\n- \"proc-macro2\",\n- \"quote\",\n- \"syn\",\n-]\n-\n [[package]]\n name = \"env_logger\"\n version = \"0.7.1\"\n@@ -1528,18 +1509,6 @@ dependencies = [\n  \"wasi 0.9.0+wasi-snapshot-preview1\",\n ]\n \n-[[package]]\n-name = \"getset\"\n-version = \"0.1.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"24b328c01a4d71d2d8173daa93562a73ab0fe85616876f02500f53d82948c504\"\n-dependencies = [\n- \"proc-macro-error\",\n- \"proc-macro2\",\n- \"quote\",\n- \"syn\",\n-]\n-\n [[package]]\n name = \"gimli\"\n version = \"0.25.0\"\n@@ -3017,6 +2986,17 @@ dependencies = [\n  \"mdbook\",\n ]\n \n+[[package]]\n+name = \"rustc-build-sysroot\"\n+version = \"0.3.3\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"ec5f3689b6c560d6a3a17fcbe54204cd870b4fcf46342d60de16715b660d2c92\"\n+dependencies = [\n+ \"anyhow\",\n+ \"rustc_version\",\n+ \"tempfile\",\n+]\n+\n [[package]]\n name = \"rustc-demangle\"\n version = \"0.1.21\"\n@@ -4122,6 +4102,12 @@ dependencies = [\n name = \"rustc_tools_util\"\n version = \"0.2.0\"\n \n+[[package]]\n+name = \"rustc_tools_util\"\n+version = \"0.2.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"598f48ce2a421542b3e64828aa742b687cc1b91d2f96591cfdb7ac5988cd6366\"\n+\n [[package]]\n name = \"rustc_trait_selection\"\n version = \"0.0.0\"\n@@ -5306,21 +5292,6 @@ version = \"0.2.10\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"6454029bf181f092ad1b853286f23e2c507d8e8194d01d92da4a55c274a5508c\"\n \n-[[package]]\n-name = \"vergen\"\n-version = \"5.1.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"dfbc87f9a7a9d61b15d51d1d3547284f67b6b4f1494ce3fc5814c101f35a5183\"\n-dependencies = [\n- \"anyhow\",\n- \"chrono\",\n- \"enum-iterator\",\n- \"getset\",\n- \"git2\",\n- \"rustversion\",\n- \"thiserror\",\n-]\n-\n [[package]]\n name = \"version_check\"\n version = \"0.9.3\""}, {"sha": "ba9221ff45cb93e08b2275094829f90957326425", "filename": "src/bootstrap/test.rs", "status": "modified", "additions": 0, "deletions": 12, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/9cc11e262f1c8313ec11154a2d5440ff5664aec4/src%2Fbootstrap%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9cc11e262f1c8313ec11154a2d5440ff5664aec4/src%2Fbootstrap%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftest.rs?ref=9cc11e262f1c8313ec11154a2d5440ff5664aec4", "patch": "@@ -494,16 +494,6 @@ impl Step for Miri {\n         // sysroot does not seem to populate it, so we do that first.\n         builder.ensure(compile::Std::new(compiler_std, host));\n         let sysroot = builder.sysroot(compiler_std);\n-        let mut cargo =\n-            builder.cargo(compiler, Mode::ToolRustc, SourceType::Submodule, host, \"install\");\n-        cargo.arg(\"xargo\");\n-        // Configure `cargo install` path. cargo adds a `bin/`.\n-        cargo.env(\"CARGO_INSTALL_ROOT\", &builder.out);\n-\n-        let mut cargo = Command::from(cargo);\n-        if !try_run(builder, &mut cargo) {\n-            return;\n-        }\n \n         // # Run `cargo miri setup`.\n         let mut cargo = tool::prepare_tool_cargo(\n@@ -525,8 +515,6 @@ impl Step for Miri {\n         cargo.env(\"MIRI\", &miri);\n         // Debug things.\n         cargo.env(\"RUST_BACKTRACE\", \"1\");\n-        // Let cargo-miri know where xargo ended up.\n-        cargo.env(\"XARGO_CHECK\", builder.out.join(\"bin\").join(\"xargo-check\"));\n \n         let mut cargo = Command::from(cargo);\n         builder.run(&mut cargo);"}, {"sha": "67ff00cc1dfe2774998c71fba7ed29682d77c421", "filename": "src/ci/scripts/should-skip-this.sh", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/9cc11e262f1c8313ec11154a2d5440ff5664aec4/src%2Fci%2Fscripts%2Fshould-skip-this.sh", "raw_url": "https://github.com/rust-lang/rust/raw/9cc11e262f1c8313ec11154a2d5440ff5664aec4/src%2Fci%2Fscripts%2Fshould-skip-this.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fscripts%2Fshould-skip-this.sh?ref=9cc11e262f1c8313ec11154a2d5440ff5664aec4", "patch": "@@ -18,10 +18,11 @@ if [[ -n \"${CI_ONLY_WHEN_SUBMODULES_CHANGED-}\" ]]; then\n         # Submodules pseudo-files inside git have the 160000 permissions, so when\n         # those files are present in the diff a submodule was updated.\n         echo \"Submodules were updated\"\n-    elif ! git diff --quiet \"$BASE_COMMIT\" -- src/tools/clippy src/tools/rustfmt; then\n+    elif ! (git diff --quiet \"$BASE_COMMIT\" -- \\\n+             src/tools/clippy src/tools/rustfmt src/tools/miri); then\n         # There is not an easy blanket search for subtrees. For now, manually list\n         # the subtrees.\n-        echo \"Clippy or rustfmt subtrees were updated\"\n+        echo \"Tool subtrees were updated\"\n     elif ! (git diff --quiet \"$BASE_COMMIT\" -- \\\n              src/test/rustdoc-gui \\\n              src/librustdoc \\"}]}