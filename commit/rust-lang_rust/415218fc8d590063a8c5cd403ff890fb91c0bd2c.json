{"sha": "415218fc8d590063a8c5cd403ff890fb91c0bd2c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQxNTIxOGZjOGQ1OTAwNjNhOGM1Y2Q0MDNmZjg5MGZiOTFjMGJkMmM=", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2020-02-15T10:47:11Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2020-02-15T10:47:11Z"}, "message": "expand assoc-const test a bit, just to be sure", "tree": {"sha": "358a44244e481efc89f3fa875fdfd30c79cbbb7e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/358a44244e481efc89f3fa875fdfd30c79cbbb7e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/415218fc8d590063a8c5cd403ff890fb91c0bd2c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/415218fc8d590063a8c5cd403ff890fb91c0bd2c", "html_url": "https://github.com/rust-lang/rust/commit/415218fc8d590063a8c5cd403ff890fb91c0bd2c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/415218fc8d590063a8c5cd403ff890fb91c0bd2c/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2107e73d2f0605e916d7b17b1cc0dbb5a1353765", "url": "https://api.github.com/repos/rust-lang/rust/commits/2107e73d2f0605e916d7b17b1cc0dbb5a1353765", "html_url": "https://github.com/rust-lang/rust/commit/2107e73d2f0605e916d7b17b1cc0dbb5a1353765"}], "stats": {"total": 128, "additions": 110, "deletions": 18}, "files": [{"sha": "1b1987f4dc31b32bf0f42fefc868fecbf207fb6f", "filename": "src/test/ui/consts/issue-69020.default.stderr", "status": "modified", "additions": 24, "deletions": 4, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/415218fc8d590063a8c5cd403ff890fb91c0bd2c/src%2Ftest%2Fui%2Fconsts%2Fissue-69020.default.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/415218fc8d590063a8c5cd403ff890fb91c0bd2c/src%2Ftest%2Fui%2Fconsts%2Fissue-69020.default.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fissue-69020.default.stderr?ref=415218fc8d590063a8c5cd403ff890fb91c0bd2c", "patch": "@@ -1,10 +1,30 @@\n error: this arithmetic operation will overflow\n-  --> $DIR/issue-69020.rs:15:20\n+  --> $DIR/issue-69020.rs:21:22\n    |\n-LL |     const N: i32 = -i32::MIN + T::N;\n-   |                    ^^^^^^^^^ attempt to negate with overflow\n+LL |     const NEG: i32 = -i32::MIN + T::NEG;\n+   |                      ^^^^^^^^^ attempt to negate with overflow\n    |\n    = note: `#[deny(overflow)]` on by default\n \n-error: aborting due to previous error\n+error: this arithmetic operation will overflow\n+  --> $DIR/issue-69020.rs:23:22\n+   |\n+LL |     const ADD: i32 = (i32::MAX+1) + T::ADD;\n+   |                      ^^^^^^^^^^^^ attempt to add with overflow\n+\n+error: this operation will panic at runtime\n+  --> $DIR/issue-69020.rs:25:22\n+   |\n+LL |     const DIV: i32 = (1/0) + T::DIV;\n+   |                      ^^^^^ attempt to divide by zero\n+   |\n+   = note: `#[deny(panic)]` on by default\n+\n+error: this operation will panic at runtime\n+  --> $DIR/issue-69020.rs:27:22\n+   |\n+LL |     const OOB: i32 = [1][1] + T::OOB;\n+   |                      ^^^^^^ index out of bounds: the len is 1 but the index is 1\n+\n+error: aborting due to 4 previous errors\n "}, {"sha": "1b1987f4dc31b32bf0f42fefc868fecbf207fb6f", "filename": "src/test/ui/consts/issue-69020.noopt.stderr", "status": "modified", "additions": 24, "deletions": 4, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/415218fc8d590063a8c5cd403ff890fb91c0bd2c/src%2Ftest%2Fui%2Fconsts%2Fissue-69020.noopt.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/415218fc8d590063a8c5cd403ff890fb91c0bd2c/src%2Ftest%2Fui%2Fconsts%2Fissue-69020.noopt.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fissue-69020.noopt.stderr?ref=415218fc8d590063a8c5cd403ff890fb91c0bd2c", "patch": "@@ -1,10 +1,30 @@\n error: this arithmetic operation will overflow\n-  --> $DIR/issue-69020.rs:15:20\n+  --> $DIR/issue-69020.rs:21:22\n    |\n-LL |     const N: i32 = -i32::MIN + T::N;\n-   |                    ^^^^^^^^^ attempt to negate with overflow\n+LL |     const NEG: i32 = -i32::MIN + T::NEG;\n+   |                      ^^^^^^^^^ attempt to negate with overflow\n    |\n    = note: `#[deny(overflow)]` on by default\n \n-error: aborting due to previous error\n+error: this arithmetic operation will overflow\n+  --> $DIR/issue-69020.rs:23:22\n+   |\n+LL |     const ADD: i32 = (i32::MAX+1) + T::ADD;\n+   |                      ^^^^^^^^^^^^ attempt to add with overflow\n+\n+error: this operation will panic at runtime\n+  --> $DIR/issue-69020.rs:25:22\n+   |\n+LL |     const DIV: i32 = (1/0) + T::DIV;\n+   |                      ^^^^^ attempt to divide by zero\n+   |\n+   = note: `#[deny(panic)]` on by default\n+\n+error: this operation will panic at runtime\n+  --> $DIR/issue-69020.rs:27:22\n+   |\n+LL |     const OOB: i32 = [1][1] + T::OOB;\n+   |                      ^^^^^^ index out of bounds: the len is 1 but the index is 1\n+\n+error: aborting due to 4 previous errors\n "}, {"sha": "1b1987f4dc31b32bf0f42fefc868fecbf207fb6f", "filename": "src/test/ui/consts/issue-69020.opt.stderr", "status": "modified", "additions": 24, "deletions": 4, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/415218fc8d590063a8c5cd403ff890fb91c0bd2c/src%2Ftest%2Fui%2Fconsts%2Fissue-69020.opt.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/415218fc8d590063a8c5cd403ff890fb91c0bd2c/src%2Ftest%2Fui%2Fconsts%2Fissue-69020.opt.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fissue-69020.opt.stderr?ref=415218fc8d590063a8c5cd403ff890fb91c0bd2c", "patch": "@@ -1,10 +1,30 @@\n error: this arithmetic operation will overflow\n-  --> $DIR/issue-69020.rs:15:20\n+  --> $DIR/issue-69020.rs:21:22\n    |\n-LL |     const N: i32 = -i32::MIN + T::N;\n-   |                    ^^^^^^^^^ attempt to negate with overflow\n+LL |     const NEG: i32 = -i32::MIN + T::NEG;\n+   |                      ^^^^^^^^^ attempt to negate with overflow\n    |\n    = note: `#[deny(overflow)]` on by default\n \n-error: aborting due to previous error\n+error: this arithmetic operation will overflow\n+  --> $DIR/issue-69020.rs:23:22\n+   |\n+LL |     const ADD: i32 = (i32::MAX+1) + T::ADD;\n+   |                      ^^^^^^^^^^^^ attempt to add with overflow\n+\n+error: this operation will panic at runtime\n+  --> $DIR/issue-69020.rs:25:22\n+   |\n+LL |     const DIV: i32 = (1/0) + T::DIV;\n+   |                      ^^^^^ attempt to divide by zero\n+   |\n+   = note: `#[deny(panic)]` on by default\n+\n+error: this operation will panic at runtime\n+  --> $DIR/issue-69020.rs:27:22\n+   |\n+LL |     const OOB: i32 = [1][1] + T::OOB;\n+   |                      ^^^^^^ index out of bounds: the len is 1 but the index is 1\n+\n+error: aborting due to 4 previous errors\n "}, {"sha": "1b1987f4dc31b32bf0f42fefc868fecbf207fb6f", "filename": "src/test/ui/consts/issue-69020.opt_with_overflow_checks.stderr", "status": "modified", "additions": 24, "deletions": 4, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/415218fc8d590063a8c5cd403ff890fb91c0bd2c/src%2Ftest%2Fui%2Fconsts%2Fissue-69020.opt_with_overflow_checks.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/415218fc8d590063a8c5cd403ff890fb91c0bd2c/src%2Ftest%2Fui%2Fconsts%2Fissue-69020.opt_with_overflow_checks.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fissue-69020.opt_with_overflow_checks.stderr?ref=415218fc8d590063a8c5cd403ff890fb91c0bd2c", "patch": "@@ -1,10 +1,30 @@\n error: this arithmetic operation will overflow\n-  --> $DIR/issue-69020.rs:15:20\n+  --> $DIR/issue-69020.rs:21:22\n    |\n-LL |     const N: i32 = -i32::MIN + T::N;\n-   |                    ^^^^^^^^^ attempt to negate with overflow\n+LL |     const NEG: i32 = -i32::MIN + T::NEG;\n+   |                      ^^^^^^^^^ attempt to negate with overflow\n    |\n    = note: `#[deny(overflow)]` on by default\n \n-error: aborting due to previous error\n+error: this arithmetic operation will overflow\n+  --> $DIR/issue-69020.rs:23:22\n+   |\n+LL |     const ADD: i32 = (i32::MAX+1) + T::ADD;\n+   |                      ^^^^^^^^^^^^ attempt to add with overflow\n+\n+error: this operation will panic at runtime\n+  --> $DIR/issue-69020.rs:25:22\n+   |\n+LL |     const DIV: i32 = (1/0) + T::DIV;\n+   |                      ^^^^^ attempt to divide by zero\n+   |\n+   = note: `#[deny(panic)]` on by default\n+\n+error: this operation will panic at runtime\n+  --> $DIR/issue-69020.rs:27:22\n+   |\n+LL |     const OOB: i32 = [1][1] + T::OOB;\n+   |                      ^^^^^^ index out of bounds: the len is 1 but the index is 1\n+\n+error: aborting due to 4 previous errors\n "}, {"sha": "963ab01a33c24642b968d70ba6c75609afa39179", "filename": "src/test/ui/consts/issue-69020.rs", "status": "modified", "additions": 14, "deletions": 2, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/415218fc8d590063a8c5cd403ff890fb91c0bd2c/src%2Ftest%2Fui%2Fconsts%2Fissue-69020.rs", "raw_url": "https://github.com/rust-lang/rust/raw/415218fc8d590063a8c5cd403ff890fb91c0bd2c/src%2Ftest%2Fui%2Fconsts%2Fissue-69020.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fissue-69020.rs?ref=415218fc8d590063a8c5cd403ff890fb91c0bd2c", "patch": "@@ -8,10 +8,22 @@\n use std::i32;\n \n pub trait Foo {\n-    const N: i32;\n+    const NEG: i32;\n+    const ADD: i32;\n+    const DIV: i32;\n+    const OOB: i32;\n }\n \n+// These constants cannot be evaluated already (they depend on `T::N`), so\n+// they can just be linted like normal run-time code.  But codegen works\n+// a bit different in const context, so this test makes sure that we still catch overflow.\n impl<T: Foo> Foo for Vec<T> {\n-    const N: i32 = -i32::MIN + T::N;\n+    const NEG: i32 = -i32::MIN + T::NEG;\n     //~^ ERROR arithmetic operation will overflow\n+    const ADD: i32 = (i32::MAX+1) + T::ADD;\n+    //~^ ERROR arithmetic operation will overflow\n+    const DIV: i32 = (1/0) + T::DIV;\n+    //~^ ERROR operation will panic\n+    const OOB: i32 = [1][1] + T::OOB;\n+    //~^ ERROR operation will panic\n }"}]}