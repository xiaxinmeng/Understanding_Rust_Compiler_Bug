{"sha": "7b6ad606723d29b7b7f7316a019cb55c7ee48b5c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdiNmFkNjA2NzIzZDI5YjdiN2Y3MzE2YTAxOWNiNTVjN2VlNDhiNWM=", "commit": {"author": {"name": "Andrea Corradi", "email": "andreac@unstable.it", "date": "2019-05-02T22:01:41Z"}, "committer": {"name": "Andrea Corradi", "email": "andreac@unstable.it", "date": "2019-05-02T22:01:41Z"}, "message": "Add custom nth_back for Chain", "tree": {"sha": "a4c1670b52eff5f46628a4857f383bb612400a4e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a4c1670b52eff5f46628a4857f383bb612400a4e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7b6ad606723d29b7b7f7316a019cb55c7ee48b5c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7b6ad606723d29b7b7f7316a019cb55c7ee48b5c", "html_url": "https://github.com/rust-lang/rust/commit/7b6ad606723d29b7b7f7316a019cb55c7ee48b5c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7b6ad606723d29b7b7f7316a019cb55c7ee48b5c/comments", "author": {"login": "acrrd", "id": 1222231, "node_id": "MDQ6VXNlcjEyMjIyMzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1222231?v=4", "gravatar_id": "", "url": "https://api.github.com/users/acrrd", "html_url": "https://github.com/acrrd", "followers_url": "https://api.github.com/users/acrrd/followers", "following_url": "https://api.github.com/users/acrrd/following{/other_user}", "gists_url": "https://api.github.com/users/acrrd/gists{/gist_id}", "starred_url": "https://api.github.com/users/acrrd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/acrrd/subscriptions", "organizations_url": "https://api.github.com/users/acrrd/orgs", "repos_url": "https://api.github.com/users/acrrd/repos", "events_url": "https://api.github.com/users/acrrd/events{/privacy}", "received_events_url": "https://api.github.com/users/acrrd/received_events", "type": "User", "site_admin": false}, "committer": {"login": "acrrd", "id": 1222231, "node_id": "MDQ6VXNlcjEyMjIyMzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1222231?v=4", "gravatar_id": "", "url": "https://api.github.com/users/acrrd", "html_url": "https://github.com/acrrd", "followers_url": "https://api.github.com/users/acrrd/followers", "following_url": "https://api.github.com/users/acrrd/following{/other_user}", "gists_url": "https://api.github.com/users/acrrd/gists{/gist_id}", "starred_url": "https://api.github.com/users/acrrd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/acrrd/subscriptions", "organizations_url": "https://api.github.com/users/acrrd/orgs", "repos_url": "https://api.github.com/users/acrrd/repos", "events_url": "https://api.github.com/users/acrrd/events{/privacy}", "received_events_url": "https://api.github.com/users/acrrd/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d15fc173818ccea6f8d97af13a30d454f9e4b35c", "url": "https://api.github.com/repos/rust-lang/rust/commits/d15fc173818ccea6f8d97af13a30d454f9e4b35c", "html_url": "https://github.com/rust-lang/rust/commit/d15fc173818ccea6f8d97af13a30d454f9e4b35c"}], "stats": {"total": 39, "additions": 39, "deletions": 0}, "files": [{"sha": "0b9f7f6b609e7cee770fca3167c5417fc9816613", "filename": "src/libcore/iter/adapters/chain.rs", "status": "modified", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/7b6ad606723d29b7b7f7316a019cb55c7ee48b5c/src%2Flibcore%2Fiter%2Fadapters%2Fchain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7b6ad606723d29b7b7f7316a019cb55c7ee48b5c/src%2Flibcore%2Fiter%2Fadapters%2Fchain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fiter%2Fadapters%2Fchain.rs?ref=7b6ad606723d29b7b7f7316a019cb55c7ee48b5c", "patch": "@@ -207,6 +207,29 @@ impl<A, B> DoubleEndedIterator for Chain<A, B> where\n         }\n     }\n \n+    #[inline]\n+    fn nth_back(&mut self, mut n: usize) -> Option<A::Item> {\n+        match self.state {\n+            ChainState::Both | ChainState::Back => {\n+                for x in self.b.by_ref().rev() {\n+                    if n == 0 {\n+                        return Some(x)\n+                    }\n+                    n -= 1;\n+                }\n+                if let ChainState::Both = self.state {\n+                    self.state = ChainState::Front;\n+                }\n+            }\n+            ChainState::Front => {}\n+        }\n+        if let ChainState::Front = self.state {\n+            self.a.nth_back(n)\n+        } else {\n+            None\n+        }\n+    }\n+\n     fn try_rfold<Acc, F, R>(&mut self, init: Acc, mut f: F) -> R where\n         Self: Sized, F: FnMut(Acc, Self::Item) -> R, R: Try<Ok=Acc>\n     {"}, {"sha": "449e339f89ccc5590c2a3d99ed4371963f75d496", "filename": "src/libcore/tests/iter.rs", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/7b6ad606723d29b7b7f7316a019cb55c7ee48b5c/src%2Flibcore%2Ftests%2Fiter.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7b6ad606723d29b7b7f7316a019cb55c7ee48b5c/src%2Flibcore%2Ftests%2Fiter.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Ftests%2Fiter.rs?ref=7b6ad606723d29b7b7f7316a019cb55c7ee48b5c", "patch": "@@ -103,6 +103,22 @@ fn test_iterator_chain_nth() {\n     assert_eq!(it.next(), None);\n }\n \n+#[test]\n+fn test_iterator_chain_nth_back() {\n+    let xs = [0, 1, 2, 3, 4, 5];\n+    let ys = [30, 40, 50, 60];\n+    let zs = [];\n+    let expected = [0, 1, 2, 3, 4, 5, 30, 40, 50, 60];\n+    for (i, x) in expected.iter().rev().enumerate() {\n+        assert_eq!(Some(x), xs.iter().chain(&ys).nth_back(i));\n+    }\n+    assert_eq!(zs.iter().chain(&xs).nth_back(0), Some(&5));\n+\n+    let mut it = xs.iter().chain(&zs);\n+    assert_eq!(it.nth_back(5), Some(&0));\n+    assert_eq!(it.next(), None);\n+}\n+\n #[test]\n fn test_iterator_chain_last() {\n     let xs = [0, 1, 2, 3, 4, 5];"}]}