{"sha": "2a3262c75792d90341e21c241b2f95ef8cdccb23", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJhMzI2MmM3NTc5MmQ5MDM0MWUyMWMyNDFiMmY5NWVmOGNkY2NiMjM=", "commit": {"author": {"name": "Hirokazu Hata", "email": "h.hata.ai.t@gmail.com", "date": "2019-01-13T13:46:52Z"}, "committer": {"name": "Hirokazu Hata", "email": "h.hata.ai.t@gmail.com", "date": "2019-01-16T14:35:06Z"}, "message": "Add infer array test", "tree": {"sha": "3eba7d4770bb2a2d77f475c1747e531828768d09", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3eba7d4770bb2a2d77f475c1747e531828768d09"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2a3262c75792d90341e21c241b2f95ef8cdccb23", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2a3262c75792d90341e21c241b2f95ef8cdccb23", "html_url": "https://github.com/rust-lang/rust/commit/2a3262c75792d90341e21c241b2f95ef8cdccb23", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2a3262c75792d90341e21c241b2f95ef8cdccb23/comments", "author": {"login": "h-michael", "id": 4556097, "node_id": "MDQ6VXNlcjQ1NTYwOTc=", "avatar_url": "https://avatars.githubusercontent.com/u/4556097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/h-michael", "html_url": "https://github.com/h-michael", "followers_url": "https://api.github.com/users/h-michael/followers", "following_url": "https://api.github.com/users/h-michael/following{/other_user}", "gists_url": "https://api.github.com/users/h-michael/gists{/gist_id}", "starred_url": "https://api.github.com/users/h-michael/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/h-michael/subscriptions", "organizations_url": "https://api.github.com/users/h-michael/orgs", "repos_url": "https://api.github.com/users/h-michael/repos", "events_url": "https://api.github.com/users/h-michael/events{/privacy}", "received_events_url": "https://api.github.com/users/h-michael/received_events", "type": "User", "site_admin": false}, "committer": {"login": "h-michael", "id": 4556097, "node_id": "MDQ6VXNlcjQ1NTYwOTc=", "avatar_url": "https://avatars.githubusercontent.com/u/4556097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/h-michael", "html_url": "https://github.com/h-michael", "followers_url": "https://api.github.com/users/h-michael/followers", "following_url": "https://api.github.com/users/h-michael/following{/other_user}", "gists_url": "https://api.github.com/users/h-michael/gists{/gist_id}", "starred_url": "https://api.github.com/users/h-michael/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/h-michael/subscriptions", "organizations_url": "https://api.github.com/users/h-michael/orgs", "repos_url": "https://api.github.com/users/h-michael/repos", "events_url": "https://api.github.com/users/h-michael/events{/privacy}", "received_events_url": "https://api.github.com/users/h-michael/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d665acbbec39ffd26eb56b1194653459a0c495e7", "url": "https://api.github.com/repos/rust-lang/rust/commits/d665acbbec39ffd26eb56b1194653459a0c495e7", "html_url": "https://github.com/rust-lang/rust/commit/d665acbbec39ffd26eb56b1194653459a0c495e7"}], "stats": {"total": 61, "additions": 61, "deletions": 0}, "files": [{"sha": "09c8644f78e94d40e94b2849ef62e8a285799dcb", "filename": "crates/ra_hir/src/ty/tests.rs", "status": "modified", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/2a3262c75792d90341e21c241b2f95ef8cdccb23/crates%2Fra_hir%2Fsrc%2Fty%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2a3262c75792d90341e21c241b2f95ef8cdccb23/crates%2Fra_hir%2Fsrc%2Fty%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Ftests.rs?ref=2a3262c75792d90341e21c241b2f95ef8cdccb23", "patch": "@@ -334,6 +334,29 @@ fn test(x: &str, y: isize) {\n     );\n }\n \n+#[test]\n+fn infer_array() {\n+    check_inference(\n+        r#\"\n+fn test(x: &str, y: isize) {\n+    let a = [x];\n+    let b = [a, a];\n+    let c = [b, b];\n+\n+    let d = [y];\n+    let e = [d, d];\n+    let f = [e, e];\n+\n+    // we have not infered these case yet.\n+    let g = [1, 2];\n+    let h = [\"a\", \"b\"];\n+    let b = [a, [\"b\"]];\n+}\n+\"#,\n+        \"array.txt\",\n+    );\n+}\n+\n fn infer(content: &str) -> String {\n     let (db, _, file_id) = MockDatabase::with_single_file(content);\n     let source_file = db.source_file(file_id);"}, {"sha": "7711e378bc84169146454b97243ca0c02196efd4", "filename": "crates/ra_hir/src/ty/tests/data/array.txt", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/2a3262c75792d90341e21c241b2f95ef8cdccb23/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Farray.txt", "raw_url": "https://github.com/rust-lang/rust/raw/2a3262c75792d90341e21c241b2f95ef8cdccb23/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Farray.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Farray.txt?ref=2a3262c75792d90341e21c241b2f95ef8cdccb23", "patch": "@@ -0,0 +1,38 @@\n+[9; 10) 'x': &str\n+[18; 19) 'y': isize\n+[28; 258) '{     ...\"]]; }': ()\n+[38; 39) 'a': [&str,]\n+[42; 45) '[x]': [&str,]\n+[43; 44) 'x': &str\n+[55; 56) 'b': [[&str,], [&str,]]\n+[59; 65) '[a, a]': [[&str,], [&str,]]\n+[60; 61) 'a': [&str,]\n+[63; 64) 'a': [&str,]\n+[75; 76) 'c': [[[&str,], [&str,]], [[&str,], [&str,]]]\n+[79; 85) '[b, b]': [[[&str,], [&str,]], [[&str,], [&str,]]]\n+[80; 81) 'b': [[&str,], [&str,]]\n+[83; 84) 'b': [[&str,], [&str,]]\n+[96; 97) 'd': [isize,]\n+[100; 103) '[y]': [isize,]\n+[101; 102) 'y': isize\n+[113; 114) 'e': [[isize,], [isize,]]\n+[117; 123) '[d, d]': [[isize,], [isize,]]\n+[118; 119) 'd': [isize,]\n+[121; 122) 'd': [isize,]\n+[133; 134) 'f': [[[isize,], [isize,]], [[isize,], [isize,]]]\n+[137; 143) '[e, e]': [[[isize,], [isize,]], [[isize,], [isize,]]]\n+[138; 139) 'e': [[isize,], [isize,]]\n+[141; 142) 'e': [[isize,], [isize,]]\n+[197; 198) 'g': [_, _]\n+[201; 207) '[1, 2]': [_, _]\n+[202; 203) '1': [unknown]\n+[205; 206) '2': [unknown]\n+[217; 218) 'h': [_, _]\n+[221; 231) '[\"a\", \"b\"]': [_, _]\n+[222; 225) '\"a\"': [unknown]\n+[227; 230) '\"b\"': [unknown]\n+[241; 242) 'b': [[&str,], [_,]]\n+[245; 255) '[a, [\"b\"]]': [[&str,], [_,]]\n+[246; 247) 'a': [&str,]\n+[249; 254) '[\"b\"]': [_,]\n+[250; 253) '\"b\"': [unknown]"}]}