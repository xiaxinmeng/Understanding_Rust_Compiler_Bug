{"sha": "517692de437a250d3a8758594cae69f4fe4216a9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUxNzY5MmRlNDM3YTI1MGQzYTg3NTg1OTRjYWU2OWY0ZmU0MjE2YTk=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2019-07-17T15:06:48Z"}, "committer": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2019-07-17T15:06:48Z"}, "message": "Merge #1538\n\n1538: jemallocator 0.3 r=matklad a=kjeremy\n\n\n\nCo-authored-by: Jeremy A. Kolb <jkolb@ara.com>", "tree": {"sha": "328d88c4f7bedae98e5a65f168dcb1febc8b1791", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/328d88c4f7bedae98e5a65f168dcb1febc8b1791"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/517692de437a250d3a8758594cae69f4fe4216a9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/517692de437a250d3a8758594cae69f4fe4216a9", "html_url": "https://github.com/rust-lang/rust/commit/517692de437a250d3a8758594cae69f4fe4216a9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/517692de437a250d3a8758594cae69f4fe4216a9/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "parents": [{"sha": "c7ceea82a5ab8aabab2f98e7c1e1ec94e82087c2", "url": "https://api.github.com/repos/rust-lang/rust/commits/c7ceea82a5ab8aabab2f98e7c1e1ec94e82087c2", "html_url": "https://github.com/rust-lang/rust/commit/c7ceea82a5ab8aabab2f98e7c1e1ec94e82087c2"}, {"sha": "5e9198f809bb0935e3d2506a8c93597191e1a57c", "url": "https://api.github.com/repos/rust-lang/rust/commits/5e9198f809bb0935e3d2506a8c93597191e1a57c", "html_url": "https://github.com/rust-lang/rust/commit/5e9198f809bb0935e3d2506a8c93597191e1a57c"}], "stats": {"total": 64, "additions": 49, "deletions": 15}, "files": [{"sha": "03f5be16bee971831f1fa55ade1cfa282723a2ad", "filename": "Cargo.lock", "status": "modified", "additions": 44, "deletions": 10, "changes": 54, "blob_url": "https://github.com/rust-lang/rust/blob/517692de437a250d3a8758594cae69f4fe4216a9/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/517692de437a250d3a8758594cae69f4fe4216a9/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=517692de437a250d3a8758594cae69f4fe4216a9", "patch": "@@ -674,16 +674,17 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"jemalloc-ctl\"\n-version = \"0.2.0\"\n+version = \"0.3.3\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"jemalloc-sys 0.1.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"jemalloc-sys 0.3.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.60 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"paste 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n name = \"jemalloc-sys\"\n-version = \"0.1.8\"\n+version = \"0.3.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"cc 1.0.37 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -693,10 +694,10 @@ dependencies = [\n \n [[package]]\n name = \"jemallocator\"\n-version = \"0.1.9\"\n+version = \"0.3.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"jemalloc-sys 0.1.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"jemalloc-sys 0.3.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.60 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -988,6 +989,26 @@ dependencies = [\n  \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n+[[package]]\n+name = \"paste\"\n+version = \"0.1.5\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+dependencies = [\n+ \"paste-impl 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"proc-macro-hack 0.5.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n+]\n+\n+[[package]]\n+name = \"paste-impl\"\n+version = \"0.1.5\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+dependencies = [\n+ \"proc-macro-hack 0.5.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"proc-macro2 0.4.30 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"quote 0.6.13 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"syn 0.15.39 (registry+https://github.com/rust-lang/crates.io-index)\",\n+]\n+\n [[package]]\n name = \"percent-encoding\"\n version = \"1.0.1\"\n@@ -1046,6 +1067,16 @@ name = \"ppv-lite86\"\n version = \"0.2.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n+[[package]]\n+name = \"proc-macro-hack\"\n+version = \"0.5.8\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+dependencies = [\n+ \"proc-macro2 0.4.30 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"quote 0.6.13 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"syn 0.15.39 (registry+https://github.com/rust-lang/crates.io-index)\",\n+]\n+\n [[package]]\n name = \"proc-macro2\"\n version = \"0.4.30\"\n@@ -1256,8 +1287,8 @@ dependencies = [\n  \"backtrace 0.3.32 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"cpuprofiler 0.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"itertools 0.8.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"jemalloc-ctl 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"jemallocator 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"jemalloc-ctl 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"jemallocator 0.3.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"once_cell 0.2.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -2168,9 +2199,9 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum iovec 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"dbe6e417e7d0975db6512b90796e8ce223145ac4e33c377e4a42882a0e88bb08\"\n \"checksum itertools 0.8.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"5b8467d9c1cebe26feb08c640139247fac215782d35371ade9a2136ed6085358\"\n \"checksum itoa 0.4.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"501266b7edd0174f8530248f87f99c88fbe60ca4ef3dd486835b8d8d53136f7f\"\n-\"checksum jemalloc-ctl 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"4e93b0f37e7d735c6b610176d5b1bde8e1621ff3f6f7ac23cdfa4e7f7d0111b5\"\n-\"checksum jemalloc-sys 0.1.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"bfc62c8e50e381768ce8ee0428ee53741929f7ebd73e4d83f669bcf7693e00ae\"\n-\"checksum jemallocator 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9f0cd42ac65f758063fea55126b0148b1ce0a6354ff78e07a4d6806bc65c4ab3\"\n+\"checksum jemalloc-ctl 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"c502a5ff9dd2924f1ed32ba96e3b65735d837b4bfd978d3161b1702e66aca4b7\"\n+\"checksum jemalloc-sys 0.3.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"0d3b9f3f5c9b31aa0f5ed3260385ac205db665baa41d49bb8338008ae94ede45\"\n+\"checksum jemallocator 0.3.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"43ae63fcfc45e99ab3d1b29a46782ad679e98436c3169d15a167a1108a724b69\"\n \"checksum join_to_string 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"4dc7a5290e8c2606ce2be49f456d50f69173cb96d1541e4f66e34ac8b331a98f\"\n \"checksum kernel32-sys 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7507624b29483431c0ba2d82aece8ca6cdba9382bff4ddd0f7490560c056098d\"\n \"checksum lalrpop-intern 0.15.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"cc4fd87be4a815fd373e02773983940f0d75fb26fde8c098e9e45f7af03154c0\"\n@@ -2205,13 +2236,16 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum parking_lot 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f842b1982eb6c2fe34036a4fbfb06dd185a3f5c8edfaacdf7d1ea10b07de6252\"\n \"checksum parking_lot_core 0.5.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"cb88cb1cb3790baa6776844f968fea3be44956cf184fa1be5a03341f5491278c\"\n \"checksum parking_lot_core 0.6.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"67812d70a819b886655846594086c00ac1f3e8b77c36ef494aa730c620b19d57\"\n+\"checksum paste 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1f4a4a1c555c6505821f9d58b8779d0f630a6b7e4e1be24ba718610acf01fa79\"\n+\"checksum paste-impl 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"26e796e623b8b257215f27e6c80a5478856cae305f5b59810ff9acdaa34570e6\"\n \"checksum percent-encoding 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"31010dd2e1ac33d5b46a5b413495239882813e0369f8ed8a5e266f173602f831\"\n \"checksum pest 2.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"933085deae3f32071f135d799d75667b63c8dc1f4537159756e3d4ceab41868c\"\n \"checksum pest_derive 2.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"833d1ae558dc601e9a60366421196a8d94bc0ac980476d0b67e1d0988d72b2d0\"\n \"checksum pest_generator 2.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"63120576c4efd69615b5537d3d052257328a4ca82876771d6944424ccfd9f646\"\n \"checksum pest_meta 2.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f249ea6de7c7b7aba92b4ff4376a994c6dbd98fd2166c89d5c4947397ecb574d\"\n \"checksum petgraph 0.4.13 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9c3659d1ee90221741f65dd128d9998311b0e40c5d3c23a62445938214abce4f\"\n \"checksum ppv-lite86 0.2.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"e3cbf9f658cdb5000fcf6f362b8ea2ba154b9f146a61c7a20d647034c6b6561b\"\n+\"checksum proc-macro-hack 0.5.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"982a35d1194084ba319d65c4a68d24ca28f5fdb5b8bc20899e4eef8641ea5178\"\n \"checksum proc-macro2 0.4.30 (registry+https://github.com/rust-lang/crates.io-index)\" = \"cf3d2011ab5c909338f7887f4fc896d35932e29146c12c8d01da6b22a80ba759\"\n \"checksum proptest 0.9.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"cf147e022eacf0c8a054ab864914a7602618adba841d800a9a9868a5237a529f\"\n \"checksum quick-error 1.2.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9274b940887ce9addde99c4eee6b5c44cc494b182b97e73dc8ffdcb3397fd3f0\""}, {"sha": "84dcc9813bec892d0890674e045d4bbf05794446", "filename": "crates/ra_prof/Cargo.toml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/517692de437a250d3a8758594cae69f4fe4216a9/crates%2Fra_prof%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/517692de437a250d3a8758594cae69f4fe4216a9/crates%2Fra_prof%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_prof%2FCargo.toml?ref=517692de437a250d3a8758594cae69f4fe4216a9", "patch": "@@ -10,8 +10,8 @@ once_cell = \"0.2.0\"\n itertools = \"0.8.0\"\n backtrace = \"0.3.28\"\n cpuprofiler = { version = \"0.0.3\", optional = true }\n-jemallocator = { version = \"0.1.9\", optional = true }\n-jemalloc-ctl = { version = \"0.2.0\", optional = true }\n+jemallocator = { version = \"0.3.2\", optional = true }\n+jemalloc-ctl = { version = \"0.3.2\", optional = true }\n \n \n [features]"}, {"sha": "8e8cb729971265861d2f61faeef89dc3d95c2269", "filename": "crates/ra_prof/src/memory_usage.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/517692de437a250d3a8758594cae69f4fe4216a9/crates%2Fra_prof%2Fsrc%2Fmemory_usage.rs", "raw_url": "https://github.com/rust-lang/rust/raw/517692de437a250d3a8758594cae69f4fe4216a9/crates%2Fra_prof%2Fsrc%2Fmemory_usage.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_prof%2Fsrc%2Fmemory_usage.rs?ref=517692de437a250d3a8758594cae69f4fe4216a9", "patch": "@@ -8,10 +8,10 @@ pub struct MemoryUsage {\n impl MemoryUsage {\n     #[cfg(feature = \"jemalloc\")]\n     pub fn current() -> MemoryUsage {\n-        jemalloc_ctl::epoch().unwrap();\n+        jemalloc_ctl::epoch::advance().unwrap();\n         MemoryUsage {\n-            allocated: Bytes(jemalloc_ctl::stats::allocated().unwrap()),\n-            resident: Bytes(jemalloc_ctl::stats::resident().unwrap()),\n+            allocated: Bytes(jemalloc_ctl::stats::allocated::read().unwrap()),\n+            resident: Bytes(jemalloc_ctl::stats::resident::read().unwrap()),\n         }\n     }\n "}]}