{"sha": "e9daab25deb3bcfb98716ccd45d02674e0556275", "node_id": "C_kwDOAAsO6NoAKGU5ZGFhYjI1ZGViM2JjZmI5ODcxNmNjZDQ1ZDAyNjc0ZTA1NTYyNzU", "commit": {"author": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2023-04-05T16:11:10Z"}, "committer": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2023-04-05T22:43:09Z"}, "message": "rustdoc: avoid including line numbers in Google SERP snippets", "tree": {"sha": "a29099b195e4b01d859b1062f943a7afa13969bc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a29099b195e4b01d859b1062f943a7afa13969bc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e9daab25deb3bcfb98716ccd45d02674e0556275", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e9daab25deb3bcfb98716ccd45d02674e0556275", "html_url": "https://github.com/rust-lang/rust/commit/e9daab25deb3bcfb98716ccd45d02674e0556275", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e9daab25deb3bcfb98716ccd45d02674e0556275/comments", "author": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "committer": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4cb92cc83ac6b24d83f8a30763b276cadb8dc41d", "url": "https://api.github.com/repos/rust-lang/rust/commits/4cb92cc83ac6b24d83f8a30763b276cadb8dc41d", "html_url": "https://github.com/rust-lang/rust/commit/4cb92cc83ac6b24d83f8a30763b276cadb8dc41d"}], "stats": {"total": 20, "additions": 11, "deletions": 9}, "files": [{"sha": "27169c60b1f1f40474c759b0911dde3700356824", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/e9daab25deb3bcfb98716ccd45d02674e0556275/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/e9daab25deb3bcfb98716ccd45d02674e0556275/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=e9daab25deb3bcfb98716ccd45d02674e0556275", "patch": "@@ -348,7 +348,7 @@ pre.item-decl {\n .source .content pre {\n \tpadding: 20px;\n }\n-.rustdoc.source .example-wrap > pre.src-line-numbers  {\n+.rustdoc.source .example-wrap pre.src-line-numbers  {\n \tpadding: 20px 0 20px 4px;\n }\n \n@@ -533,17 +533,17 @@ ul.block, .block li {\n \tmargin-bottom: 0px;\n }\n \n-.rustdoc .example-wrap > pre {\n+.rustdoc .example-wrap pre {\n \tmargin: 0;\n \tflex-grow: 1;\n }\n \n-.rustdoc:not(.source) .example-wrap > pre {\n+.rustdoc:not(.source) .example-wrap pre {\n \toverflow: auto hidden;\n }\n \n-.rustdoc .example-wrap > pre.example-line-numbers,\n-.rustdoc .example-wrap > pre.src-line-numbers {\n+.rustdoc .example-wrap pre.example-line-numbers,\n+.rustdoc .example-wrap pre.src-line-numbers {\n \tflex-grow: 0;\n \tmin-width: fit-content; /* prevent collapsing into nothing in truncated scraped examples */\n \toverflow: initial;\n@@ -554,7 +554,7 @@ ul.block, .block li {\n \tcolor: var(--src-line-numbers-span-color);\n }\n \n-.rustdoc .example-wrap > pre.src-line-numbers {\n+.rustdoc .example-wrap pre.src-line-numbers {\n \tpadding: 14px 0;\n }\n .src-line-numbers a, .src-line-numbers span {\n@@ -702,7 +702,7 @@ h2.small-section-header > .anchor {\n }\n \n .main-heading a:hover,\n-.example-wrap > .rust a:hover,\n+.example-wrap .rust a:hover,\n .all-items a:hover,\n .docblock a:not(.test-arrow):not(.scrape-help):not(.tooltip):hover,\n .docblock-short a:not(.test-arrow):not(.scrape-help):not(.tooltip):hover,"}, {"sha": "42d01277db2c2f68a55c11fac0d66a1aa011f1d4", "filename": "src/librustdoc/html/templates/source.html", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/e9daab25deb3bcfb98716ccd45d02674e0556275/src%2Flibrustdoc%2Fhtml%2Ftemplates%2Fsource.html", "raw_url": "https://github.com/rust-lang/rust/raw/e9daab25deb3bcfb98716ccd45d02674e0556275/src%2Flibrustdoc%2Fhtml%2Ftemplates%2Fsource.html", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Ftemplates%2Fsource.html?ref=e9daab25deb3bcfb98716ccd45d02674e0556275", "patch": "@@ -1,13 +1,15 @@\n <div class=\"example-wrap\"> {# #}\n-    <pre class=\"src-line-numbers\">\n+    {# https://developers.google.com/search/docs/crawling-indexing/robots-meta-tag#data-nosnippet-attr\n+       Do not show \"1 2 3 4 5 ...\" in web search results. #}\n+    <div data-nosnippet><pre class=\"src-line-numbers\">\n         {% for line in lines.clone() %}\n             {% if embedded %}\n                 <span>{{line|safe}}</span>\n             {%~ else %}\n                 <a href=\"#{{line|safe}}\" id=\"{{line|safe}}\">{{line|safe}}</a>\n             {%~ endif %}\n         {% endfor %}\n-    </pre> {# #}\n+    </pre></div> {# #}\n     <pre class=\"rust\"> {# #}\n         <code>\n             {% if needs_expansion %}"}]}