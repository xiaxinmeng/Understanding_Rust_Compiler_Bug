{"sha": "25fd6338280caf93b30f8f92f217c8e50a8c0766", "node_id": "C_kwDOAAsO6NoAKDI1ZmQ2MzM4MjgwY2FmOTNiMzBmOGY5MmYyMTdjOGU1MGE4YzA3NjY", "commit": {"author": {"name": "nils", "email": "48135649+Nilstrieb@users.noreply.github.com", "date": "2023-01-12T14:44:51Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-01-12T14:44:51Z"}, "message": "Rollup merge of #106579 - estebank:issue-52144, r=Nilstrieb\n\nSuggest making private tuple struct field public\n\nFix #52144.", "tree": {"sha": "fb3e820479d1162409524fca09a16254cb5572b1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fb3e820479d1162409524fca09a16254cb5572b1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/25fd6338280caf93b30f8f92f217c8e50a8c0766", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjwBzjCRBK7hj4Ov3rIwAAFLcIAIIEa7JioJKriSLhtwryVPQw\njNsNWPPpgEtHlIICEG78X63GzIiqYXkWE0rkyXSSj6kyO607EZ+5UncQF4SKlQsi\ngrSJ4hTvw2koGMulQMDqRaN6TLR9oCLveg7Jq3dh6rzDQRmAiF9Hr0XMjsjqVpt1\n5cioqJKNvfCPWDp/Gs4PYuipTIhqCc+s2Wax+Oogh1nKjhA9IGWTibDK3L2DZxNQ\nTdmx+g3KdLgkxByOU4rTxK6mD6c168V5CQYEMwhwx6rn5hhtyb6ZKwv0ZF0RTMdi\nRftt56RQzzr8bJW53V8vILfY7drm+opaCDEvdWCCCw7SOf4TJxcNlOzlFpierX8=\n=FtTI\n-----END PGP SIGNATURE-----\n", "payload": "tree fb3e820479d1162409524fca09a16254cb5572b1\nparent 35cf81d707f5e0ef6578540ded961ca096abf9e8\nparent 41e66d902589964cda32a5a89c34023a9f78398b\nauthor nils <48135649+Nilstrieb@users.noreply.github.com> 1673534691 +0100\ncommitter GitHub <noreply@github.com> 1673534691 +0100\n\nRollup merge of #106579 - estebank:issue-52144, r=Nilstrieb\n\nSuggest making private tuple struct field public\n\nFix #52144.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/25fd6338280caf93b30f8f92f217c8e50a8c0766", "html_url": "https://github.com/rust-lang/rust/commit/25fd6338280caf93b30f8f92f217c8e50a8c0766", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/25fd6338280caf93b30f8f92f217c8e50a8c0766/comments", "author": {"login": "Nilstrieb", "id": 48135649, "node_id": "MDQ6VXNlcjQ4MTM1NjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/48135649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nilstrieb", "html_url": "https://github.com/Nilstrieb", "followers_url": "https://api.github.com/users/Nilstrieb/followers", "following_url": "https://api.github.com/users/Nilstrieb/following{/other_user}", "gists_url": "https://api.github.com/users/Nilstrieb/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nilstrieb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nilstrieb/subscriptions", "organizations_url": "https://api.github.com/users/Nilstrieb/orgs", "repos_url": "https://api.github.com/users/Nilstrieb/repos", "events_url": "https://api.github.com/users/Nilstrieb/events{/privacy}", "received_events_url": "https://api.github.com/users/Nilstrieb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "35cf81d707f5e0ef6578540ded961ca096abf9e8", "url": "https://api.github.com/repos/rust-lang/rust/commits/35cf81d707f5e0ef6578540ded961ca096abf9e8", "html_url": "https://github.com/rust-lang/rust/commit/35cf81d707f5e0ef6578540ded961ca096abf9e8"}, {"sha": "41e66d902589964cda32a5a89c34023a9f78398b", "url": "https://api.github.com/repos/rust-lang/rust/commits/41e66d902589964cda32a5a89c34023a9f78398b", "html_url": "https://github.com/rust-lang/rust/commit/41e66d902589964cda32a5a89c34023a9f78398b"}], "stats": {"total": 253, "additions": 246, "deletions": 7}, "files": [{"sha": "b1b04c92a75042cfa4af912ff5024c1acbde65f5", "filename": "compiler/rustc_resolve/src/build_reduced_graph.rs", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/25fd6338280caf93b30f8f92f217c8e50a8c0766/compiler%2Frustc_resolve%2Fsrc%2Fbuild_reduced_graph.rs", "raw_url": "https://github.com/rust-lang/rust/raw/25fd6338280caf93b30f8f92f217c8e50a8c0766/compiler%2Frustc_resolve%2Fsrc%2Fbuild_reduced_graph.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_resolve%2Fsrc%2Fbuild_reduced_graph.rs?ref=25fd6338280caf93b30f8f92f217c8e50a8c0766", "patch": "@@ -334,6 +334,15 @@ impl<'a, 'b> BuildReducedGraphVisitor<'a, 'b> {\n         self.r.field_names.insert(def_id, field_names);\n     }\n \n+    fn insert_field_visibilities_local(&mut self, def_id: DefId, vdata: &ast::VariantData) {\n+        let field_vis = vdata\n+            .fields()\n+            .iter()\n+            .map(|field| field.vis.span.until(field.ident.map_or(field.ty.span, |i| i.span)))\n+            .collect();\n+        self.r.field_visibility_spans.insert(def_id, field_vis);\n+    }\n+\n     fn insert_field_names_extern(&mut self, def_id: DefId) {\n         let field_names =\n             self.r.cstore().struct_field_names_untracked(def_id, self.r.session).collect();\n@@ -737,6 +746,7 @@ impl<'a, 'b> BuildReducedGraphVisitor<'a, 'b> {\n \n                 // Record field names for error reporting.\n                 self.insert_field_names_local(def_id, vdata);\n+                self.insert_field_visibilities_local(def_id, vdata);\n \n                 // If this is a tuple or unit struct, define a name\n                 // in the value namespace as well.\n@@ -770,6 +780,8 @@ impl<'a, 'b> BuildReducedGraphVisitor<'a, 'b> {\n                         Res::Def(DefKind::Ctor(CtorOf::Struct, ctor_kind), ctor_def_id.to_def_id());\n                     self.r.define(parent, ident, ValueNS, (ctor_res, ctor_vis, sp, expansion));\n                     self.r.visibilities.insert(ctor_def_id, ctor_vis);\n+                    // We need the field visibility spans also for the constructor for E0603.\n+                    self.insert_field_visibilities_local(ctor_def_id.to_def_id(), vdata);\n \n                     self.r\n                         .struct_constructors\n@@ -783,6 +795,7 @@ impl<'a, 'b> BuildReducedGraphVisitor<'a, 'b> {\n \n                 // Record field names for error reporting.\n                 self.insert_field_names_local(def_id, vdata);\n+                self.insert_field_visibilities_local(def_id, vdata);\n             }\n \n             ItemKind::Trait(..) => {\n@@ -1510,6 +1523,7 @@ impl<'a, 'b> Visitor<'b> for BuildReducedGraphVisitor<'a, 'b> {\n \n         // Record field names for error reporting.\n         self.insert_field_names_local(def_id.to_def_id(), &variant.data);\n+        self.insert_field_visibilities_local(def_id.to_def_id(), &variant.data);\n \n         visit::walk_variant(self, variant);\n     }"}, {"sha": "1a852de8eed690d29e6e2cabebff7ead288bb83c", "filename": "compiler/rustc_resolve/src/diagnostics.rs", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/25fd6338280caf93b30f8f92f217c8e50a8c0766/compiler%2Frustc_resolve%2Fsrc%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/25fd6338280caf93b30f8f92f217c8e50a8c0766/compiler%2Frustc_resolve%2Fsrc%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_resolve%2Fsrc%2Fdiagnostics.rs?ref=25fd6338280caf93b30f8f92f217c8e50a8c0766", "patch": "@@ -6,7 +6,9 @@ use rustc_ast::{self as ast, Crate, ItemKind, ModKind, NodeId, Path, CRATE_NODE_\n use rustc_ast_pretty::pprust;\n use rustc_data_structures::fx::FxHashSet;\n use rustc_errors::struct_span_err;\n-use rustc_errors::{Applicability, Diagnostic, DiagnosticBuilder, ErrorGuaranteed, MultiSpan};\n+use rustc_errors::{\n+    pluralize, Applicability, Diagnostic, DiagnosticBuilder, ErrorGuaranteed, MultiSpan,\n+};\n use rustc_feature::BUILTIN_ATTRIBUTES;\n use rustc_hir::def::Namespace::{self, *};\n use rustc_hir::def::{self, CtorKind, CtorOf, DefKind, NonMacroAttrKind, PerNS};\n@@ -1604,6 +1606,16 @@ impl<'a> Resolver<'a> {\n         err.span_label(ident.span, &format!(\"private {}\", descr));\n         if let Some(span) = ctor_fields_span {\n             err.span_label(span, \"a constructor is private if any of the fields is private\");\n+            if let Res::Def(_, d) = res && let Some(fields) = self.field_visibility_spans.get(&d) {\n+                err.multipart_suggestion_verbose(\n+                    &format!(\n+                        \"consider making the field{} publicly accessible\",\n+                        pluralize!(fields.len())\n+                    ),\n+                    fields.iter().map(|span| (*span, \"pub \".to_string())).collect(),\n+                    Applicability::MaybeIncorrect,\n+                );\n+            }\n         }\n \n         // Print the whole import chain to make it easier to see what happens."}, {"sha": "d92f5a7c05e6d8473ae85c0eff0107f9e6be3300", "filename": "compiler/rustc_resolve/src/late/diagnostics.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/25fd6338280caf93b30f8f92f217c8e50a8c0766/compiler%2Frustc_resolve%2Fsrc%2Flate%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/25fd6338280caf93b30f8f92f217c8e50a8c0766/compiler%2Frustc_resolve%2Fsrc%2Flate%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_resolve%2Fsrc%2Flate%2Fdiagnostics.rs?ref=25fd6338280caf93b30f8f92f217c8e50a8c0766", "patch": "@@ -1451,6 +1451,17 @@ impl<'a: 'ast, 'ast> LateResolutionVisitor<'a, '_, 'ast> {\n                         .collect();\n \n                     if non_visible_spans.len() > 0 {\n+                        if let Some(fields) = self.r.field_visibility_spans.get(&def_id) {\n+                            err.multipart_suggestion_verbose(\n+                                &format!(\n+                                    \"consider making the field{} publicly accessible\",\n+                                    pluralize!(fields.len())\n+                                ),\n+                                fields.iter().map(|span| (*span, \"pub \".to_string())).collect(),\n+                                Applicability::MaybeIncorrect,\n+                            );\n+                        }\n+\n                         let mut m: MultiSpan = non_visible_spans.clone().into();\n                         non_visible_spans\n                             .into_iter()"}, {"sha": "84d9794ccf26671471aab168841bca043c1acdff", "filename": "compiler/rustc_resolve/src/lib.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/25fd6338280caf93b30f8f92f217c8e50a8c0766/compiler%2Frustc_resolve%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/25fd6338280caf93b30f8f92f217c8e50a8c0766/compiler%2Frustc_resolve%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_resolve%2Fsrc%2Flib.rs?ref=25fd6338280caf93b30f8f92f217c8e50a8c0766", "patch": "@@ -881,6 +881,10 @@ pub struct Resolver<'a> {\n     /// Used for hints during error reporting.\n     field_names: FxHashMap<DefId, Vec<Spanned<Symbol>>>,\n \n+    /// Span of the privacy modifier in fields of an item `DefId` accessible with dot syntax.\n+    /// Used for hints during error reporting.\n+    field_visibility_spans: FxHashMap<DefId, Vec<Span>>,\n+\n     /// All imports known to succeed or fail.\n     determined_imports: Vec<&'a Import<'a>>,\n \n@@ -1268,6 +1272,7 @@ impl<'a> Resolver<'a> {\n \n             has_self: FxHashSet::default(),\n             field_names: FxHashMap::default(),\n+            field_visibility_spans: FxHashMap::default(),\n \n             determined_imports: Vec::new(),\n             indeterminate_imports: Vec::new(),"}, {"sha": "600dc7c876ff3f22709b2db583f0e9c538d7c1a9", "filename": "tests/ui/privacy/issue-75906.stderr", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fprivacy%2Fissue-75906.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fprivacy%2Fissue-75906.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fprivacy%2Fissue-75906.stderr?ref=25fd6338280caf93b30f8f92f217c8e50a8c0766", "patch": "@@ -9,6 +9,10 @@ note: constructor is not visible here due to private fields\n    |\n LL |     pub struct Bar(u8);\n    |                    ^^ private field\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct Bar(pub u8);\n+   |                    +++\n \n error: aborting due to previous error\n "}, {"sha": "3bed841d13ea29ec632522fda6830ea886e49c3c", "filename": "tests/ui/privacy/issue-75907.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fprivacy%2Fissue-75907.rs", "raw_url": "https://github.com/rust-lang/rust/raw/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fprivacy%2Fissue-75907.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fprivacy%2Fissue-75907.rs?ref=25fd6338280caf93b30f8f92f217c8e50a8c0766", "patch": "@@ -2,7 +2,7 @@\n \n mod foo {\n     pub(crate) struct Foo(u8);\n-    pub(crate) struct Bar(pub u8, u8, Foo);\n+    pub(crate) struct Bar(pub u8, pub(in crate::foo) u8, Foo);\n \n     pub(crate) fn make_bar() -> Bar {\n         Bar(1, 12, Foo(10))"}, {"sha": "f7cb874c2cc0d5e05995d4d45d274e167ca10d37", "filename": "tests/ui/privacy/issue-75907.stderr", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fprivacy%2Fissue-75907.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fprivacy%2Fissue-75907.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fprivacy%2Fissue-75907.stderr?ref=25fd6338280caf93b30f8f92f217c8e50a8c0766", "patch": "@@ -11,6 +11,10 @@ LL |     let Bar(x, y, Foo(z)) = make_bar();\n    |                ^  ^^^^^^ private field\n    |                |\n    |                private field\n+help: consider making the fields publicly accessible\n+   |\n+LL |     pub(crate) struct Bar(pub u8, pub u8, pub Foo);\n+   |                           ~~~     ~~~     +++\n \n error[E0532]: cannot match against a tuple struct which contains private fields\n   --> $DIR/issue-75907.rs:15:19\n@@ -23,6 +27,10 @@ note: constructor is not visible here due to private fields\n    |\n LL |     let Bar(x, y, Foo(z)) = make_bar();\n    |                       ^ private field\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub(crate) struct Foo(pub u8);\n+   |                           +++\n \n error: aborting due to 2 previous errors\n "}, {"sha": "615b0af2762d3de9e70a7d08a2f0a1b989f863cb", "filename": "tests/ui/privacy/privacy5.stderr", "status": "modified", "additions": 96, "deletions": 0, "changes": 96, "blob_url": "https://github.com/rust-lang/rust/blob/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fprivacy%2Fprivacy5.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fprivacy%2Fprivacy5.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fprivacy%2Fprivacy5.stderr?ref=25fd6338280caf93b30f8f92f217c8e50a8c0766", "patch": "@@ -12,6 +12,10 @@ note: the tuple struct constructor `A` is defined here\n    |\n LL |     pub struct A(());\n    |     ^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct A(pub ());\n+   |                  +++\n \n error[E0603]: tuple struct constructor `B` is private\n   --> $DIR/privacy5.rs:52:16\n@@ -27,6 +31,10 @@ note: the tuple struct constructor `B` is defined here\n    |\n LL |     pub struct B(isize);\n    |     ^^^^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct B(pub isize);\n+   |                  +++\n \n error[E0603]: tuple struct constructor `C` is private\n   --> $DIR/privacy5.rs:53:16\n@@ -42,6 +50,10 @@ note: the tuple struct constructor `C` is defined here\n    |\n LL |     pub struct C(pub isize, isize);\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+help: consider making the fields publicly accessible\n+   |\n+LL |     pub struct C(pub isize, pub isize);\n+   |                  ~~~        +++\n \n error[E0603]: tuple struct constructor `A` is private\n   --> $DIR/privacy5.rs:56:12\n@@ -57,6 +69,10 @@ note: the tuple struct constructor `A` is defined here\n    |\n LL |     pub struct A(());\n    |     ^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct A(pub ());\n+   |                  +++\n \n error[E0603]: tuple struct constructor `A` is private\n   --> $DIR/privacy5.rs:57:12\n@@ -72,6 +88,10 @@ note: the tuple struct constructor `A` is defined here\n    |\n LL |     pub struct A(());\n    |     ^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct A(pub ());\n+   |                  +++\n \n error[E0603]: tuple struct constructor `A` is private\n   --> $DIR/privacy5.rs:58:18\n@@ -87,6 +107,10 @@ note: the tuple struct constructor `A` is defined here\n    |\n LL |     pub struct A(());\n    |     ^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct A(pub ());\n+   |                  +++\n \n error[E0603]: tuple struct constructor `A` is private\n   --> $DIR/privacy5.rs:59:18\n@@ -102,6 +126,10 @@ note: the tuple struct constructor `A` is defined here\n    |\n LL |     pub struct A(());\n    |     ^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct A(pub ());\n+   |                  +++\n \n error[E0603]: tuple struct constructor `B` is private\n   --> $DIR/privacy5.rs:61:12\n@@ -117,6 +145,10 @@ note: the tuple struct constructor `B` is defined here\n    |\n LL |     pub struct B(isize);\n    |     ^^^^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct B(pub isize);\n+   |                  +++\n \n error[E0603]: tuple struct constructor `B` is private\n   --> $DIR/privacy5.rs:62:12\n@@ -132,6 +164,10 @@ note: the tuple struct constructor `B` is defined here\n    |\n LL |     pub struct B(isize);\n    |     ^^^^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct B(pub isize);\n+   |                  +++\n \n error[E0603]: tuple struct constructor `B` is private\n   --> $DIR/privacy5.rs:63:18\n@@ -147,6 +183,10 @@ note: the tuple struct constructor `B` is defined here\n    |\n LL |     pub struct B(isize);\n    |     ^^^^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct B(pub isize);\n+   |                  +++\n \n error[E0603]: tuple struct constructor `B` is private\n   --> $DIR/privacy5.rs:64:18\n@@ -162,6 +202,10 @@ note: the tuple struct constructor `B` is defined here\n    |\n LL |     pub struct B(isize);\n    |     ^^^^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct B(pub isize);\n+   |                  +++\n \n error[E0603]: tuple struct constructor `B` is private\n   --> $DIR/privacy5.rs:65:18\n@@ -177,6 +221,10 @@ note: the tuple struct constructor `B` is defined here\n    |\n LL |     pub struct B(isize);\n    |     ^^^^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct B(pub isize);\n+   |                  +++\n \n error[E0603]: tuple struct constructor `B` is private\n   --> $DIR/privacy5.rs:65:32\n@@ -192,6 +240,10 @@ note: the tuple struct constructor `B` is defined here\n    |\n LL |     pub struct B(isize);\n    |     ^^^^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct B(pub isize);\n+   |                  +++\n \n error[E0603]: tuple struct constructor `C` is private\n   --> $DIR/privacy5.rs:68:12\n@@ -207,6 +259,10 @@ note: the tuple struct constructor `C` is defined here\n    |\n LL |     pub struct C(pub isize, isize);\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+help: consider making the fields publicly accessible\n+   |\n+LL |     pub struct C(pub isize, pub isize);\n+   |                  ~~~        +++\n \n error[E0603]: tuple struct constructor `C` is private\n   --> $DIR/privacy5.rs:69:12\n@@ -222,6 +278,10 @@ note: the tuple struct constructor `C` is defined here\n    |\n LL |     pub struct C(pub isize, isize);\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+help: consider making the fields publicly accessible\n+   |\n+LL |     pub struct C(pub isize, pub isize);\n+   |                  ~~~        +++\n \n error[E0603]: tuple struct constructor `C` is private\n   --> $DIR/privacy5.rs:70:12\n@@ -237,6 +297,10 @@ note: the tuple struct constructor `C` is defined here\n    |\n LL |     pub struct C(pub isize, isize);\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+help: consider making the fields publicly accessible\n+   |\n+LL |     pub struct C(pub isize, pub isize);\n+   |                  ~~~        +++\n \n error[E0603]: tuple struct constructor `C` is private\n   --> $DIR/privacy5.rs:71:12\n@@ -252,6 +316,10 @@ note: the tuple struct constructor `C` is defined here\n    |\n LL |     pub struct C(pub isize, isize);\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+help: consider making the fields publicly accessible\n+   |\n+LL |     pub struct C(pub isize, pub isize);\n+   |                  ~~~        +++\n \n error[E0603]: tuple struct constructor `C` is private\n   --> $DIR/privacy5.rs:72:18\n@@ -267,6 +335,10 @@ note: the tuple struct constructor `C` is defined here\n    |\n LL |     pub struct C(pub isize, isize);\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+help: consider making the fields publicly accessible\n+   |\n+LL |     pub struct C(pub isize, pub isize);\n+   |                  ~~~        +++\n \n error[E0603]: tuple struct constructor `C` is private\n   --> $DIR/privacy5.rs:73:18\n@@ -282,6 +354,10 @@ note: the tuple struct constructor `C` is defined here\n    |\n LL |     pub struct C(pub isize, isize);\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+help: consider making the fields publicly accessible\n+   |\n+LL |     pub struct C(pub isize, pub isize);\n+   |                  ~~~        +++\n \n error[E0603]: tuple struct constructor `C` is private\n   --> $DIR/privacy5.rs:74:18\n@@ -297,6 +373,10 @@ note: the tuple struct constructor `C` is defined here\n    |\n LL |     pub struct C(pub isize, isize);\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+help: consider making the fields publicly accessible\n+   |\n+LL |     pub struct C(pub isize, pub isize);\n+   |                  ~~~        +++\n \n error[E0603]: tuple struct constructor `C` is private\n   --> $DIR/privacy5.rs:75:18\n@@ -312,6 +392,10 @@ note: the tuple struct constructor `C` is defined here\n    |\n LL |     pub struct C(pub isize, isize);\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+help: consider making the fields publicly accessible\n+   |\n+LL |     pub struct C(pub isize, pub isize);\n+   |                  ~~~        +++\n \n error[E0603]: tuple struct constructor `A` is private\n   --> $DIR/privacy5.rs:83:17\n@@ -327,6 +411,10 @@ note: the tuple struct constructor `A` is defined here\n    |\n LL |     pub struct A(());\n    |     ^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct A(pub ());\n+   |                  +++\n \n error[E0603]: tuple struct constructor `B` is private\n   --> $DIR/privacy5.rs:84:17\n@@ -342,6 +430,10 @@ note: the tuple struct constructor `B` is defined here\n    |\n LL |     pub struct B(isize);\n    |     ^^^^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct B(pub isize);\n+   |                  +++\n \n error[E0603]: tuple struct constructor `C` is private\n   --> $DIR/privacy5.rs:85:17\n@@ -357,6 +449,10 @@ note: the tuple struct constructor `C` is defined here\n    |\n LL |     pub struct C(pub isize, isize);\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+help: consider making the fields publicly accessible\n+   |\n+LL |     pub struct C(pub isize, pub isize);\n+   |                  ~~~        +++\n \n error[E0603]: tuple struct constructor `A` is private\n   --> $DIR/privacy5.rs:90:20"}, {"sha": "78e335b3db1cbaf08b9314e3f32f25e979f87d92", "filename": "tests/ui/privacy/suggest-making-field-public.fixed", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fprivacy%2Fsuggest-making-field-public.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fprivacy%2Fsuggest-making-field-public.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fprivacy%2Fsuggest-making-field-public.fixed?ref=25fd6338280caf93b30f8f92f217c8e50a8c0766", "patch": "@@ -0,0 +1,15 @@\n+// run-rustfix\n+mod a {\n+    pub struct A(pub String);\n+}\n+\n+mod b {\n+    use crate::a::A;\n+    pub fn x() {\n+        A(\"\".into()); //~ ERROR cannot initialize a tuple struct which contains private fields\n+    }\n+}\n+fn main() {\n+    a::A(\"a\".into()); //~ ERROR tuple struct constructor `A` is private\n+    b::x();\n+}"}, {"sha": "b65c801d10e6a3ca85b15893262ec6ea9ecc44df", "filename": "tests/ui/privacy/suggest-making-field-public.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fprivacy%2Fsuggest-making-field-public.rs", "raw_url": "https://github.com/rust-lang/rust/raw/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fprivacy%2Fsuggest-making-field-public.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fprivacy%2Fsuggest-making-field-public.rs?ref=25fd6338280caf93b30f8f92f217c8e50a8c0766", "patch": "@@ -0,0 +1,15 @@\n+// run-rustfix\n+mod a {\n+    pub struct A(pub(self)String);\n+}\n+\n+mod b {\n+    use crate::a::A;\n+    pub fn x() {\n+        A(\"\".into()); //~ ERROR cannot initialize a tuple struct which contains private fields\n+    }\n+}\n+fn main() {\n+    a::A(\"a\".into()); //~ ERROR tuple struct constructor `A` is private\n+    b::x();\n+}"}, {"sha": "e92e9aae310e3272a8c07016e8eadf9a5cc5ad26", "filename": "tests/ui/privacy/suggest-making-field-public.stderr", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fprivacy%2Fsuggest-making-field-public.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fprivacy%2Fsuggest-making-field-public.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fprivacy%2Fsuggest-making-field-public.stderr?ref=25fd6338280caf93b30f8f92f217c8e50a8c0766", "patch": "@@ -0,0 +1,39 @@\n+error[E0603]: tuple struct constructor `A` is private\n+  --> $DIR/suggest-making-field-public.rs:13:8\n+   |\n+LL |     pub struct A(pub(self)String);\n+   |                  --------------- a constructor is private if any of the fields is private\n+...\n+LL |     a::A(\"a\".into());\n+   |        ^ private tuple struct constructor\n+   |\n+note: the tuple struct constructor `A` is defined here\n+  --> $DIR/suggest-making-field-public.rs:3:5\n+   |\n+LL |     pub struct A(pub(self)String);\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct A(pub String);\n+   |                  ~~~\n+\n+error[E0423]: cannot initialize a tuple struct which contains private fields\n+  --> $DIR/suggest-making-field-public.rs:9:9\n+   |\n+LL |         A(\"\".into());\n+   |         ^\n+   |\n+note: constructor is not visible here due to private fields\n+  --> $DIR/suggest-making-field-public.rs:3:18\n+   |\n+LL |     pub struct A(pub(self)String);\n+   |                  ^^^^^^^^^^^^^^^ private field\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct A(pub String);\n+   |                  ~~~\n+\n+error: aborting due to 2 previous errors\n+\n+Some errors have detailed explanations: E0423, E0603.\n+For more information about an error, try `rustc --explain E0423`."}, {"sha": "7e439c10b7b8408c08d8a2055a5748757cd50135", "filename": "tests/ui/resolve/issue-42944.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fresolve%2Fissue-42944.rs", "raw_url": "https://github.com/rust-lang/rust/raw/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fresolve%2Fissue-42944.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fresolve%2Fissue-42944.rs?ref=25fd6338280caf93b30f8f92f217c8e50a8c0766", "patch": "@@ -1,5 +1,5 @@\n mod foo {\n-    pub struct Bx(());\n+    pub struct Bx(pub(in crate::foo) ());\n }\n \n mod bar {"}, {"sha": "4ffa9402c667e8892d26b906ca16d3c9185a0a54", "filename": "tests/ui/resolve/issue-42944.stderr", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fresolve%2Fissue-42944.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fresolve%2Fissue-42944.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fresolve%2Fissue-42944.stderr?ref=25fd6338280caf93b30f8f92f217c8e50a8c0766", "patch": "@@ -7,8 +7,8 @@ LL |         Bx(());\n note: tuple struct `foo::Bx` exists but is inaccessible\n   --> $DIR/issue-42944.rs:2:5\n    |\n-LL |     pub struct Bx(());\n-   |     ^^^^^^^^^^^^^^^^^^ not accessible\n+LL |     pub struct Bx(pub(in crate::foo) ());\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ not accessible\n \n error[E0423]: cannot initialize a tuple struct which contains private fields\n   --> $DIR/issue-42944.rs:9:9\n@@ -19,8 +19,12 @@ LL |         Bx(());\n note: constructor is not visible here due to private fields\n   --> $DIR/issue-42944.rs:2:19\n    |\n-LL |     pub struct Bx(());\n-   |                   ^^ private field\n+LL |     pub struct Bx(pub(in crate::foo) ());\n+   |                   ^^^^^^^^^^^^^^^^^^^^^ private field\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct Bx(pub ());\n+   |                   ~~~\n \n error: aborting due to 2 previous errors\n "}, {"sha": "c1fcaaf05738f0f348be28a8f5c9c85249f3002d", "filename": "tests/ui/resolve/privacy-struct-ctor.stderr", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fresolve%2Fprivacy-struct-ctor.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/25fd6338280caf93b30f8f92f217c8e50a8c0766/tests%2Fui%2Fresolve%2Fprivacy-struct-ctor.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fresolve%2Fprivacy-struct-ctor.stderr?ref=25fd6338280caf93b30f8f92f217c8e50a8c0766", "patch": "@@ -53,6 +53,10 @@ note: the tuple struct constructor `Z` is defined here\n    |\n LL |         pub(in m) struct Z(pub(in m::n) u8);\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |         pub(in m) struct Z(pub u8);\n+   |                            ~~~\n \n error[E0603]: tuple struct constructor `S` is private\n   --> $DIR/privacy-struct-ctor.rs:29:8\n@@ -68,6 +72,10 @@ note: the tuple struct constructor `S` is defined here\n    |\n LL |     pub struct S(u8);\n    |     ^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct S(pub u8);\n+   |                  +++\n \n error[E0603]: tuple struct constructor `S` is private\n   --> $DIR/privacy-struct-ctor.rs:31:19\n@@ -83,6 +91,10 @@ note: the tuple struct constructor `S` is defined here\n    |\n LL |     pub struct S(u8);\n    |     ^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |     pub struct S(pub u8);\n+   |                  +++\n \n error[E0603]: tuple struct constructor `Z` is private\n   --> $DIR/privacy-struct-ctor.rs:35:11\n@@ -98,6 +110,10 @@ note: the tuple struct constructor `Z` is defined here\n    |\n LL |         pub(in m) struct Z(pub(in m::n) u8);\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+help: consider making the field publicly accessible\n+   |\n+LL |         pub(in m) struct Z(pub u8);\n+   |                            ~~~\n \n error[E0603]: tuple struct constructor `S` is private\n   --> $DIR/privacy-struct-ctor.rs:41:16"}]}