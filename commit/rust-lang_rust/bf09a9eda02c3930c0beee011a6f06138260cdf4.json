{"sha": "bf09a9eda02c3930c0beee011a6f06138260cdf4", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJmMDlhOWVkYTAyYzM5MzBjMGJlZWUwMTFhNmYwNjEzODI2MGNkZjQ=", "commit": {"author": {"name": "billyevans", "email": "pervushinai@gmail.com", "date": "2016-05-06T23:27:32Z"}, "committer": {"name": "billyevans", "email": "pervushinai@gmail.com", "date": "2016-05-11T19:58:19Z"}, "message": "Add detailed error explanation for E0505\n\nPart of #32777", "tree": {"sha": "97a1b5c5895336fb227c4e75e37a0f642f86f5a0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/97a1b5c5895336fb227c4e75e37a0f642f86f5a0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bf09a9eda02c3930c0beee011a6f06138260cdf4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bf09a9eda02c3930c0beee011a6f06138260cdf4", "html_url": "https://github.com/rust-lang/rust/commit/bf09a9eda02c3930c0beee011a6f06138260cdf4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bf09a9eda02c3930c0beee011a6f06138260cdf4/comments", "author": {"login": "billyevans", "id": 1027458, "node_id": "MDQ6VXNlcjEwMjc0NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1027458?v=4", "gravatar_id": "", "url": "https://api.github.com/users/billyevans", "html_url": "https://github.com/billyevans", "followers_url": "https://api.github.com/users/billyevans/followers", "following_url": "https://api.github.com/users/billyevans/following{/other_user}", "gists_url": "https://api.github.com/users/billyevans/gists{/gist_id}", "starred_url": "https://api.github.com/users/billyevans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/billyevans/subscriptions", "organizations_url": "https://api.github.com/users/billyevans/orgs", "repos_url": "https://api.github.com/users/billyevans/repos", "events_url": "https://api.github.com/users/billyevans/events{/privacy}", "received_events_url": "https://api.github.com/users/billyevans/received_events", "type": "User", "site_admin": false}, "committer": {"login": "billyevans", "id": 1027458, "node_id": "MDQ6VXNlcjEwMjc0NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1027458?v=4", "gravatar_id": "", "url": "https://api.github.com/users/billyevans", "html_url": "https://github.com/billyevans", "followers_url": "https://api.github.com/users/billyevans/followers", "following_url": "https://api.github.com/users/billyevans/following{/other_user}", "gists_url": "https://api.github.com/users/billyevans/gists{/gist_id}", "starred_url": "https://api.github.com/users/billyevans/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/billyevans/subscriptions", "organizations_url": "https://api.github.com/users/billyevans/orgs", "repos_url": "https://api.github.com/users/billyevans/repos", "events_url": "https://api.github.com/users/billyevans/events{/privacy}", "received_events_url": "https://api.github.com/users/billyevans/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e37f8593e42335829e98fed27b8ececbad61a05d", "url": "https://api.github.com/repos/rust-lang/rust/commits/e37f8593e42335829e98fed27b8ececbad61a05d", "html_url": "https://github.com/rust-lang/rust/commit/e37f8593e42335829e98fed27b8ececbad61a05d"}], "stats": {"total": 80, "additions": 79, "deletions": 1}, "files": [{"sha": "b5d54567191c89bfe0ac3cf143a0ff1d4960c5c4", "filename": "src/librustc_borrowck/diagnostics.rs", "status": "modified", "additions": 79, "deletions": 1, "changes": 80, "blob_url": "https://github.com/rust-lang/rust/blob/bf09a9eda02c3930c0beee011a6f06138260cdf4/src%2Flibrustc_borrowck%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bf09a9eda02c3930c0beee011a6f06138260cdf4/src%2Flibrustc_borrowck%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_borrowck%2Fdiagnostics.rs?ref=bf09a9eda02c3930c0beee011a6f06138260cdf4", "patch": "@@ -642,6 +642,85 @@ fn print_fancy_ref(fancy_ref: &FancyNum){\n ```\n \"##,\n \n+E0505: r##\"\n+A value was moved out while it was still borrowed.\n+Erroneous code example:\n+\n+```compile_fail\n+struct Value {}\n+\n+fn eat(val: Value) {}\n+\n+fn main() {\n+    let x = Value{};\n+    {\n+        let _ref_to_val: &Value = &x;\n+        eat(x);\n+    }\n+}\n+```\n+\n+Here, the function `eat` takes the ownership of `x`. However,\n+`x` cannot be moved because it was borrowed to `_ref_to_val`.\n+To fix that you can do few different things:\n+\n+* Try to avoid moving the variable.\n+* Release borrow before move.\n+* Implement the `Copy` trait on the type.\n+\n+Examples:\n+\n+```\n+struct Value {}\n+\n+fn eat(val: &Value) {}\n+\n+fn main() {\n+    let x = Value{};\n+    {\n+        let _ref_to_val: &Value = &x;\n+        eat(&x); // pass by reference, if it's possible\n+    }\n+}\n+```\n+\n+Or:\n+\n+```\n+struct Value {}\n+\n+fn eat(val: Value) {}\n+\n+fn main() {\n+    let x = Value{};\n+    {\n+        let _ref_to_val: &Value = &x;\n+    }\n+    eat(x); // release borrow and then move it.\n+}\n+```\n+\n+Or:\n+\n+```\n+#[derive(Clone, Copy)] // implement Copy trait\n+struct Value {}\n+\n+fn eat(val: Value) {}\n+\n+fn main() {\n+    let x = Value{};\n+    {\n+        let _ref_to_val: &Value = &x;\n+        eat(x); // it will be copied here.\n+    }\n+}\n+```\n+\n+You can find more information about borrowing in the rust-book:\n+http://doc.rust-lang.org/stable/book/references-and-borrowing.html\n+\"##,\n+\n E0507: r##\"\n You tried to move out of a value which was borrowed. Erroneous code example:\n \n@@ -860,7 +939,6 @@ register_diagnostics! {\n     E0500, // closure requires unique access to `..` but .. is already borrowed\n     E0502, // cannot borrow `..`.. as .. because .. is also borrowed as ...\n     E0503, // cannot use `..` because it was mutably borrowed\n-    E0505, // cannot move out of `..` because it is borrowed\n     E0508, // cannot move out of type `..`, a non-copy fixed-size array\n     E0524, // two closures require unique access to `..` at the same time\n }"}]}