{"sha": "528972a28aa9e7e303e2283a31469c12c3d87e23", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUyODk3MmEyOGFhOWU3ZTMwM2UyMjgzYTMxNDY5YzEyYzNkODdlMjM=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-05-30T08:53:07Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-05-30T08:53:07Z"}, "message": "Rollup merge of #61333 - varkor:apit-const-param-ice, r=estebank\n\nFix ICE with APIT in a function with a const parameter\n\nFixes https://github.com/rust-lang/rust/issues/60953.", "tree": {"sha": "c960557e317e8e2d73db61fd13894d62884b2a66", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c960557e317e8e2d73db61fd13894d62884b2a66"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/528972a28aa9e7e303e2283a31469c12c3d87e23", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJc75nzCRBK7hj4Ov3rIwAAdHIIAKdETrCWnZ1KGSQMtjSxa5Sv\ndMosAzzCIhqW6aYdx1M3O5fbmXI9Pg25XNxwPgb2eBHokJc6tsHUWGFzqIPBOos9\n2oTthRJzRGlf9OjpSxBzTrbBup/pxOmfgLh/Vza3+BuD1Pi3D+BJnskacODXKFUg\nZcc5PpQO8HZYtJY40Gm3jhGurvJIbNwyWILdQ3BOW0SO6adgNFcYPhSt2p6vqzLH\n99wBXFLyWF9OTfkkbY3ZPHsCyCU56pjyG7U1nAOEWBdXU7uGU0yWMCPIesP/o0G8\nkfB4MGZs2QpcRfcsKvI7KrTr/QNippY91n3DKYU3GSmwSbG8ywDJD8yck9uGDuw=\n=m7sQ\n-----END PGP SIGNATURE-----\n", "payload": "tree c960557e317e8e2d73db61fd13894d62884b2a66\nparent 6282fae46f34cdf1700a218120655ce1582c4e07\nparent 998ef688a39a1b842b5d0a71ea92a8f825650975\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1559206387 +0200\ncommitter GitHub <noreply@github.com> 1559206387 +0200\n\nRollup merge of #61333 - varkor:apit-const-param-ice, r=estebank\n\nFix ICE with APIT in a function with a const parameter\n\nFixes https://github.com/rust-lang/rust/issues/60953.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/528972a28aa9e7e303e2283a31469c12c3d87e23", "html_url": "https://github.com/rust-lang/rust/commit/528972a28aa9e7e303e2283a31469c12c3d87e23", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/528972a28aa9e7e303e2283a31469c12c3d87e23/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6282fae46f34cdf1700a218120655ce1582c4e07", "url": "https://api.github.com/repos/rust-lang/rust/commits/6282fae46f34cdf1700a218120655ce1582c4e07", "html_url": "https://github.com/rust-lang/rust/commit/6282fae46f34cdf1700a218120655ce1582c4e07"}, {"sha": "998ef688a39a1b842b5d0a71ea92a8f825650975", "url": "https://api.github.com/repos/rust-lang/rust/commits/998ef688a39a1b842b5d0a71ea92a8f825650975", "html_url": "https://github.com/rust-lang/rust/commit/998ef688a39a1b842b5d0a71ea92a8f825650975"}], "stats": {"total": 28, "additions": 28, "deletions": 0}, "files": [{"sha": "08fbd0d20d74dac3a23818ad7ee4cf5e4fc187aa", "filename": "src/librustc/hir/lowering.rs", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/528972a28aa9e7e303e2283a31469c12c3d87e23/src%2Flibrustc%2Fhir%2Flowering.rs", "raw_url": "https://github.com/rust-lang/rust/raw/528972a28aa9e7e303e2283a31469c12c3d87e23/src%2Flibrustc%2Fhir%2Flowering.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Flowering.rs?ref=528972a28aa9e7e303e2283a31469c12c3d87e23", "patch": "@@ -1083,6 +1083,18 @@ impl<'a> LoweringContext<'a> {\n             .chain(in_band_defs)\n             .collect();\n \n+        // FIXME(const_generics): the compiler doesn't always cope with\n+        // unsorted generic parameters at the moment, so we make sure\n+        // that they're ordered correctly here for now. (When we chain\n+        // the `in_band_defs`, we might make the order unsorted.)\n+        lowered_generics.params.sort_by_key(|param| {\n+            match param.kind {\n+                hir::GenericParamKind::Lifetime { .. } => ParamKindOrd::Lifetime,\n+                hir::GenericParamKind::Type { .. } => ParamKindOrd::Type,\n+                hir::GenericParamKind::Const { .. } => ParamKindOrd::Const,\n+            }\n+        });\n+\n         (lowered_generics, res)\n     }\n "}, {"sha": "70e718d889029fa2130bebdad4127e32b2a6f7f9", "filename": "src/test/ui/const-generics/apit-with-const-param.rs", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/528972a28aa9e7e303e2283a31469c12c3d87e23/src%2Ftest%2Fui%2Fconst-generics%2Fapit-with-const-param.rs", "raw_url": "https://github.com/rust-lang/rust/raw/528972a28aa9e7e303e2283a31469c12c3d87e23/src%2Ftest%2Fui%2Fconst-generics%2Fapit-with-const-param.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fapit-with-const-param.rs?ref=528972a28aa9e7e303e2283a31469c12c3d87e23", "patch": "@@ -0,0 +1,10 @@\n+// run-pass\n+\n+#![feature(const_generics)]\n+//~^ WARN the feature `const_generics` is incomplete and may cause the compiler to crash\n+\n+trait Trait {}\n+\n+fn f<const N: usize>(_: impl Trait) {}\n+\n+fn main() {}"}, {"sha": "b3038ee64885130b974eddc787c02943a231953f", "filename": "src/test/ui/const-generics/apit-with-const-param.stderr", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/528972a28aa9e7e303e2283a31469c12c3d87e23/src%2Ftest%2Fui%2Fconst-generics%2Fapit-with-const-param.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/528972a28aa9e7e303e2283a31469c12c3d87e23/src%2Ftest%2Fui%2Fconst-generics%2Fapit-with-const-param.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fapit-with-const-param.stderr?ref=528972a28aa9e7e303e2283a31469c12c3d87e23", "patch": "@@ -0,0 +1,6 @@\n+warning: the feature `const_generics` is incomplete and may cause the compiler to crash\n+  --> $DIR/apit-with-const-param.rs:3:12\n+   |\n+LL | #![feature(const_generics)]\n+   |            ^^^^^^^^^^^^^^\n+"}]}