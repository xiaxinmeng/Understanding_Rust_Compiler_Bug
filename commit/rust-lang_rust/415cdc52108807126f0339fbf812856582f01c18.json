{"sha": "415cdc52108807126f0339fbf812856582f01c18", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQxNWNkYzUyMTA4ODA3MTI2ZjAzMzlmYmY4MTI4NTY1ODJmMDFjMTg=", "commit": {"author": {"name": "Florian Diebold", "email": "flodiebold@gmail.com", "date": "2019-01-12T17:47:43Z"}, "committer": {"name": "Florian Diebold", "email": "flodiebold@gmail.com", "date": "2019-01-19T14:49:48Z"}, "message": "Add some tests", "tree": {"sha": "2eb0dd8f216ab034c180d7c2ab3a463075ce073e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2eb0dd8f216ab034c180d7c2ab3a463075ce073e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/415cdc52108807126f0339fbf812856582f01c18", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/415cdc52108807126f0339fbf812856582f01c18", "html_url": "https://github.com/rust-lang/rust/commit/415cdc52108807126f0339fbf812856582f01c18", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/415cdc52108807126f0339fbf812856582f01c18/comments", "author": {"login": "flodiebold", "id": 906069, "node_id": "MDQ6VXNlcjkwNjA2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/906069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flodiebold", "html_url": "https://github.com/flodiebold", "followers_url": "https://api.github.com/users/flodiebold/followers", "following_url": "https://api.github.com/users/flodiebold/following{/other_user}", "gists_url": "https://api.github.com/users/flodiebold/gists{/gist_id}", "starred_url": "https://api.github.com/users/flodiebold/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flodiebold/subscriptions", "organizations_url": "https://api.github.com/users/flodiebold/orgs", "repos_url": "https://api.github.com/users/flodiebold/repos", "events_url": "https://api.github.com/users/flodiebold/events{/privacy}", "received_events_url": "https://api.github.com/users/flodiebold/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flodiebold", "id": 906069, "node_id": "MDQ6VXNlcjkwNjA2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/906069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flodiebold", "html_url": "https://github.com/flodiebold", "followers_url": "https://api.github.com/users/flodiebold/followers", "following_url": "https://api.github.com/users/flodiebold/following{/other_user}", "gists_url": "https://api.github.com/users/flodiebold/gists{/gist_id}", "starred_url": "https://api.github.com/users/flodiebold/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flodiebold/subscriptions", "organizations_url": "https://api.github.com/users/flodiebold/orgs", "repos_url": "https://api.github.com/users/flodiebold/repos", "events_url": "https://api.github.com/users/flodiebold/events{/privacy}", "received_events_url": "https://api.github.com/users/flodiebold/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bade91db081a3465dea3547ab8ab669f78fde9dc", "url": "https://api.github.com/repos/rust-lang/rust/commits/bade91db081a3465dea3547ab8ab669f78fde9dc", "html_url": "https://github.com/rust-lang/rust/commit/bade91db081a3465dea3547ab8ab669f78fde9dc"}], "stats": {"total": 121, "additions": 121, "deletions": 0}, "files": [{"sha": "c590a09db1335dd8a2fc4e4a02dd8b49228bb24e", "filename": "crates/ra_hir/src/ty/tests.rs", "status": "modified", "additions": 63, "deletions": 0, "changes": 63, "blob_url": "https://github.com/rust-lang/rust/blob/415cdc52108807126f0339fbf812856582f01c18/crates%2Fra_hir%2Fsrc%2Fty%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/415cdc52108807126f0339fbf812856582f01c18/crates%2Fra_hir%2Fsrc%2Fty%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Ftests.rs?ref=415cdc52108807126f0339fbf812856582f01c18", "patch": "@@ -418,6 +418,69 @@ fn test() {\n     );\n }\n \n+#[test]\n+fn infer_struct_generics() {\n+    check_inference(\n+        r#\"\n+struct A<T> {\n+    x: T,\n+}\n+\n+fn test(a1: A<u32>, i: i32) {\n+    a1.x;\n+    let a2 = A { x: i };\n+    a2.x;\n+    let a3 = A::<i128> { x: 1 };\n+    a3.x;\n+}\n+\"#,\n+        \"struct_generics.txt\",\n+    );\n+}\n+\n+#[test]\n+fn infer_function_generics() {\n+    check_inference(\n+        r#\"\n+fn id<T>(t: T) -> T { t }\n+\n+fn test() {\n+    id(1u32);\n+    id::<i128>(1);\n+    let x: u64 = id(1);\n+}\n+\"#,\n+        \"function_generics.txt\",\n+    );\n+}\n+\n+#[test]\n+fn infer_generic_chain() {\n+    check_inference(\n+        r#\"\n+struct A<T> {\n+    x: T,\n+}\n+impl<T2> A<T2> {\n+    fn x(self) -> T2 {\n+        self.x\n+    }\n+}\n+fn id<T>(t: T) -> T { t }\n+\n+fn test() -> i128 {\n+     let x = 1;\n+     let y = id(x);\n+     let a = A { x: id(y) };\n+     let z = id(a.x);\n+     let b = A { x: z };\n+     b.x()\n+}\n+\"#,\n+        \"generic_chain.txt\",\n+    );\n+}\n+\n fn infer(content: &str) -> String {\n     let (db, _, file_id) = MockDatabase::with_single_file(content);\n     let source_file = db.source_file(file_id);"}, {"sha": "179e136a018fc2c708bf8d57291421ca1c536cf6", "filename": "crates/ra_hir/src/ty/tests/data/function_generics.txt", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/415cdc52108807126f0339fbf812856582f01c18/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Ffunction_generics.txt", "raw_url": "https://github.com/rust-lang/rust/raw/415cdc52108807126f0339fbf812856582f01c18/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Ffunction_generics.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Ffunction_generics.txt?ref=415cdc52108807126f0339fbf812856582f01c18", "patch": "@@ -0,0 +1,14 @@\n+[10; 11) 't': [unknown]\n+[21; 26) '{ t }': [unknown]\n+[23; 24) 't': [unknown]\n+[38; 98) '{     ...(1); }': ()\n+[44; 46) 'id': fn([unknown]) -> [unknown]\n+[44; 52) 'id(1u32)': [unknown]\n+[47; 51) '1u32': [unknown]\n+[58; 68) 'id::<i128>': fn([unknown]) -> [unknown]\n+[58; 71) 'id::<i128>(1)': [unknown]\n+[69; 70) '1': [unknown]\n+[81; 82) 'x': u64\n+[90; 92) 'id': fn([unknown]) -> u64\n+[90; 95) 'id(1)': u64\n+[93; 94) '1': [unknown]"}, {"sha": "720609153905194b44df5f2eec9943bdf608c2ce", "filename": "crates/ra_hir/src/ty/tests/data/generic_chain.txt", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/415cdc52108807126f0339fbf812856582f01c18/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Fgeneric_chain.txt", "raw_url": "https://github.com/rust-lang/rust/raw/415cdc52108807126f0339fbf812856582f01c18/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Fgeneric_chain.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Fgeneric_chain.txt?ref=415cdc52108807126f0339fbf812856582f01c18", "patch": "@@ -0,0 +1,29 @@\n+[53; 57) 'self': A\n+[65; 87) '{     ...     }': [unknown]\n+[75; 79) 'self': A\n+[75; 81) 'self.x': [unknown]\n+[99; 100) 't': [unknown]\n+[110; 115) '{ t }': [unknown]\n+[112; 113) 't': [unknown]\n+[135; 261) '{     ....x() }': i128\n+[146; 147) 'x': [unknown]\n+[150; 151) '1': [unknown]\n+[162; 163) 'y': [unknown]\n+[166; 168) 'id': fn([unknown]) -> [unknown]\n+[166; 171) 'id(x)': [unknown]\n+[169; 170) 'x': [unknown]\n+[182; 183) 'a': A\n+[186; 200) 'A { x: id(y) }': A\n+[193; 195) 'id': fn([unknown]) -> [unknown]\n+[193; 198) 'id(y)': [unknown]\n+[196; 197) 'y': [unknown]\n+[211; 212) 'z': [unknown]\n+[215; 217) 'id': fn([unknown]) -> [unknown]\n+[215; 222) 'id(a.x)': [unknown]\n+[218; 219) 'a': A\n+[218; 221) 'a.x': [unknown]\n+[233; 234) 'b': A\n+[237; 247) 'A { x: z }': A\n+[244; 245) 'z': [unknown]\n+[254; 255) 'b': A\n+[254; 259) 'b.x()': i128"}, {"sha": "d1026b459edb46185651aee6c668d36d1c1c5092", "filename": "crates/ra_hir/src/ty/tests/data/struct_generics.txt", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/415cdc52108807126f0339fbf812856582f01c18/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Fstruct_generics.txt", "raw_url": "https://github.com/rust-lang/rust/raw/415cdc52108807126f0339fbf812856582f01c18/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Fstruct_generics.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Fstruct_generics.txt?ref=415cdc52108807126f0339fbf812856582f01c18", "patch": "@@ -0,0 +1,15 @@\n+[36; 38) 'a1': A\n+[48; 49) 'i': i32\n+[56; 147) '{     ...3.x; }': ()\n+[62; 64) 'a1': A\n+[62; 66) 'a1.x': [unknown]\n+[76; 78) 'a2': A\n+[81; 91) 'A { x: i }': A\n+[88; 89) 'i': i32\n+[97; 99) 'a2': A\n+[97; 101) 'a2.x': [unknown]\n+[111; 113) 'a3': A\n+[116; 134) 'A::<i1...x: 1 }': A\n+[131; 132) '1': [unknown]\n+[140; 142) 'a3': A\n+[140; 144) 'a3.x': [unknown]"}]}