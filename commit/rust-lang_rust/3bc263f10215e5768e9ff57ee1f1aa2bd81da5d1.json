{"sha": "3bc263f10215e5768e9ff57ee1f1aa2bd81da5d1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNiYzI2M2YxMDIxNWU1NzY4ZTlmZjU3ZWUxZjFhYTJiZDgxZGE1ZDE=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2010-06-29T17:25:25Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2010-06-29T17:25:25Z"}, "message": "Improve makefile to try to avoid wedging on failure-to-dep lib/std.rc", "tree": {"sha": "f814c9bf22b75349a288901e0725a6b43f548d67", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f814c9bf22b75349a288901e0725a6b43f548d67"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3bc263f10215e5768e9ff57ee1f1aa2bd81da5d1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3bc263f10215e5768e9ff57ee1f1aa2bd81da5d1", "html_url": "https://github.com/rust-lang/rust/commit/3bc263f10215e5768e9ff57ee1f1aa2bd81da5d1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3bc263f10215e5768e9ff57ee1f1aa2bd81da5d1/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "023e5af6398f8892fee429759096ba8c2480ed7d", "url": "https://api.github.com/repos/rust-lang/rust/commits/023e5af6398f8892fee429759096ba8c2480ed7d", "html_url": "https://github.com/rust-lang/rust/commit/023e5af6398f8892fee429759096ba8c2480ed7d"}], "stats": {"total": 15, "additions": 9, "deletions": 6}, "files": [{"sha": "bb7a59d425c5cd27b3202cf7e5e3c6b6a1584c49", "filename": "src/Makefile", "status": "modified", "additions": 9, "deletions": 6, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/3bc263f10215e5768e9ff57ee1f1aa2bd81da5d1/src%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/3bc263f10215e5768e9ff57ee1f1aa2bd81da5d1/src%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2FMakefile?ref=3bc263f10215e5768e9ff57ee1f1aa2bd81da5d1", "patch": "@@ -631,17 +631,17 @@ test/run-fail/%.bc: test/run-fail/%.rs $(REQ)\n ML_DEPFILES := $(BOOT_MLS:%.ml=%.d)\n C_DEPFILES := $(RUNTIME_CS:%.cpp=%.d)\n \n-%.d: %.cpp $(MKFILES)\n+%.d.tmp: %.cpp $(MKFILES)\n \t@$(call CFG_ECHO, dep: $<)\n \t$(CFG_QUIET)$(call CFG_DEPEND_C, $@ \\\n       $(patsubst %.cpp, %$(CFG_OBJ_SUFFIX), $<), \\\n       $(RUNTIME_INCS)) $< $(CFG_PATH_MUNGE) >$@\n \n-%.d: %.ml $(MKFILES)\n+%.d.tmp: %.ml $(MKFILES)\n \t@$(call CFG_ECHO, dep: $<)\n \t$(CFG_QUIET)ocamldep$(OPT) $(ML_INCS) $< $(CFG_PATH_MUNGE) >$@\n \n-%.d: %.mli $(MKFILES)\n+%.d.tmp: %.mli $(MKFILES)\n \t@$(call CFG_ECHO, dep: $<)\n \t$(CFG_QUIET)ocamldep$(OPT) $(ML_INCS) $< $(CFG_PATH_MUNGE) >$@\n \n@@ -656,18 +656,21 @@ CFG_INFO := $(info cfg: using built $(CFG_BOOT) for rust deps)\n STDLIB_DEPFILE := $(CFG_STDLIB).d\n CRATE_DEPFILES := $(ALL_TEST_CRATES:%.rc=%.d) $(STDLIB_DEPFILE)\n \n-$(STDLIB_DEPFILE): $(STDLIB_CRATE) $(MKFILES) $(CFG_BOOT)\n+$(STDLIB_DEPFILE).tmp: $(STDLIB_CRATE) $(MKFILES) $(CFG_BOOT)\n \t@$(call CFG_ECHO, dep: $<)\n \t$(BOOT) -shared -rdeps $< $(CFG_PATH_MUNGE) >$@\n \n-%.d: %.rc $(MKFILES) $(CFG_BOOT)\n+%.d.tmp: %.rc $(MKFILES) $(CFG_BOOT)\n \t@$(call CFG_ECHO, dep: $<)\n \t$(BOOT) -rdeps $< $(CFG_PATH_MUNGE) >$@\n \n-%.d: %.rs $(MKFILES) $(CFG_BOOT)\n+%.d.tmp: %.rs $(MKFILES) $(CFG_BOOT)\n \t@$(call CFG_ECHO, dep: $<)\n \t$(BOOT) -rdeps $< $(CFG_PATH_MUNGE) >$@\n \n+%.d: %.d.tmp\n+\t$(CFG_QUIET)mv $< $@\n+\n ifneq ($(MAKECMDGOALS),clean)\n -include $(CRATE_DEPFILES)\n endif"}]}