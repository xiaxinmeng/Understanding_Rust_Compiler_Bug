{"sha": "63a4cd60cde961b050d20ba2f891c8a581b141ed", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYzYTRjZDYwY2RlOTYxYjA1MGQyMGJhMmY4OTFjOGE1ODFiMTQxZWQ=", "commit": {"author": {"name": "Lzu Tao", "email": "taolzu@gmail.com", "date": "2019-10-14T17:56:27Z"}, "committer": {"name": "Lzu Tao", "email": "taolzu@gmail.com", "date": "2019-10-15T09:47:16Z"}, "message": "build: do not trace deploy step", "tree": {"sha": "006cf6215270c19d6e7bcad044a521ead560e3f6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/006cf6215270c19d6e7bcad044a521ead560e3f6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/63a4cd60cde961b050d20ba2f891c8a581b141ed", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/63a4cd60cde961b050d20ba2f891c8a581b141ed", "html_url": "https://github.com/rust-lang/rust/commit/63a4cd60cde961b050d20ba2f891c8a581b141ed", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/63a4cd60cde961b050d20ba2f891c8a581b141ed/comments", "author": {"login": "tesuji", "id": 15225902, "node_id": "MDQ6VXNlcjE1MjI1OTAy", "avatar_url": "https://avatars.githubusercontent.com/u/15225902?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tesuji", "html_url": "https://github.com/tesuji", "followers_url": "https://api.github.com/users/tesuji/followers", "following_url": "https://api.github.com/users/tesuji/following{/other_user}", "gists_url": "https://api.github.com/users/tesuji/gists{/gist_id}", "starred_url": "https://api.github.com/users/tesuji/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tesuji/subscriptions", "organizations_url": "https://api.github.com/users/tesuji/orgs", "repos_url": "https://api.github.com/users/tesuji/repos", "events_url": "https://api.github.com/users/tesuji/events{/privacy}", "received_events_url": "https://api.github.com/users/tesuji/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tesuji", "id": 15225902, "node_id": "MDQ6VXNlcjE1MjI1OTAy", "avatar_url": "https://avatars.githubusercontent.com/u/15225902?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tesuji", "html_url": "https://github.com/tesuji", "followers_url": "https://api.github.com/users/tesuji/followers", "following_url": "https://api.github.com/users/tesuji/following{/other_user}", "gists_url": "https://api.github.com/users/tesuji/gists{/gist_id}", "starred_url": "https://api.github.com/users/tesuji/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tesuji/subscriptions", "organizations_url": "https://api.github.com/users/tesuji/orgs", "repos_url": "https://api.github.com/users/tesuji/repos", "events_url": "https://api.github.com/users/tesuji/events{/privacy}", "received_events_url": "https://api.github.com/users/tesuji/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f4ea5251cb0205ca0a3ed2ac5eb295ec6f7f031c", "url": "https://api.github.com/repos/rust-lang/rust/commits/f4ea5251cb0205ca0a3ed2ac5eb295ec6f7f031c", "html_url": "https://github.com/rust-lang/rust/commit/f4ea5251cb0205ca0a3ed2ac5eb295ec6f7f031c"}], "stats": {"total": 34, "additions": 17, "deletions": 17}, "files": [{"sha": "66dcf7d727721833ec7b9fa52469919303fd7e23", "filename": ".travis.yml", "status": "modified", "additions": 17, "deletions": 17, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/63a4cd60cde961b050d20ba2f891c8a581b141ed/.travis.yml", "raw_url": "https://github.com/rust-lang/rust/raw/63a4cd60cde961b050d20ba2f891c8a581b141ed/.travis.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.travis.yml?ref=63a4cd60cde961b050d20ba2f891c8a581b141ed", "patch": "@@ -107,28 +107,28 @@ script:\n       fi\n     fi\n   - |\n-      rm rust-toolchain\n-      ./setup-toolchain.sh\n-      if [ \"$TRAVIS_OS_NAME\" == \"windows\" ]; then\n-        export PATH=$PATH:$(rustc --print sysroot)/bin\n-      else\n-        export LD_LIBRARY_PATH=$(rustc --print sysroot)/lib\n-      fi\n+    rm rust-toolchain\n+    ./setup-toolchain.sh\n+    if [ \"$TRAVIS_OS_NAME\" == \"windows\" ]; then\n+      export PATH=$PATH:$(rustc --print sysroot)/bin\n+    else\n+      export LD_LIBRARY_PATH=$(rustc --print sysroot)/lib\n+    fi\n   - |\n     if [ -z ${INTEGRATION} ]; then\n       travis_wait 30 ./ci/base-tests.sh && sleep 5\n     else\n       ./ci/integration-tests.sh && sleep 5\n     fi\n \n-after_success: |\n-  #!/bin/bash\n-  if [ \"$TRAVIS_OS_NAME\" == \"linux\" ]; then\n-    set -ex\n-    if [ -z ${INTEGRATION} ]; then\n-      ./.github/deploy.sh\n-    else\n-      echo \"Not deploying, because we're in an integration test run\"\n+after_success:\n+  - |\n+    if [ \"$TRAVIS_OS_NAME\" == \"linux\" ]; then\n+      set -e\n+      if [ -z ${INTEGRATION} ]; then\n+        ./.github/deploy.sh\n+      else\n+        echo \"Not deploying, because we're in an integration test run\"\n+      fi\n+      set +e\n     fi\n-    set +e\n-  fi"}]}