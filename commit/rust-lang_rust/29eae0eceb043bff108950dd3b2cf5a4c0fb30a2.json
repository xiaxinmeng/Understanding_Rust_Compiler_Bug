{"sha": "29eae0eceb043bff108950dd3b2cf5a4c0fb30a2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI5ZWFlMGVjZWIwNDNiZmYxMDg5NTBkZDNiMmNmNWE0YzBmYjMwYTI=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2015-08-12T05:11:34Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2015-08-12T05:42:20Z"}, "message": "rollup merge of #27650: dotdash/backtrace_test\n\nLLVM might perform tail merging on the calls that initiate the unwinding\nprocess which breaks debuginfo and therefore this test. Since tail\nmerging is guaranteed to break debuginfo, it should be disabled for this\ntest.\n\nThis allows us to restore a testcase that I had to remove earlier\nbecause of the same problem, because back then I didn't realize that\ndisabling tail merging was an option.\n\ncc #27619", "tree": {"sha": "da180e3768c031288d69f7f160055f8b8c645d7c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/da180e3768c031288d69f7f160055f8b8c645d7c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/29eae0eceb043bff108950dd3b2cf5a4c0fb30a2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/29eae0eceb043bff108950dd3b2cf5a4c0fb30a2", "html_url": "https://github.com/rust-lang/rust/commit/29eae0eceb043bff108950dd3b2cf5a4c0fb30a2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/29eae0eceb043bff108950dd3b2cf5a4c0fb30a2/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b5b8f1bd90f109a4e4f8ffa7b01a6b91cc2c77d6", "url": "https://api.github.com/repos/rust-lang/rust/commits/b5b8f1bd90f109a4e4f8ffa7b01a6b91cc2c77d6", "html_url": "https://github.com/rust-lang/rust/commit/b5b8f1bd90f109a4e4f8ffa7b01a6b91cc2c77d6"}, {"sha": "689d13dde95cdcfa1353e5382dee49c0acf1ded4", "url": "https://api.github.com/repos/rust-lang/rust/commits/689d13dde95cdcfa1353e5382dee49c0acf1ded4", "html_url": "https://github.com/rust-lang/rust/commit/689d13dde95cdcfa1353e5382dee49c0acf1ded4"}], "stats": {"total": 12, "additions": 11, "deletions": 1}, "files": [{"sha": "f889e381dc46e17e6a644bef275cf0e72b0e3e7d", "filename": "src/test/run-pass/backtrace-debuginfo.rs", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/29eae0eceb043bff108950dd3b2cf5a4c0fb30a2/src%2Ftest%2Frun-pass%2Fbacktrace-debuginfo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/29eae0eceb043bff108950dd3b2cf5a4c0fb30a2/src%2Ftest%2Frun-pass%2Fbacktrace-debuginfo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fbacktrace-debuginfo.rs?ref=29eae0eceb043bff108950dd3b2cf5a4c0fb30a2", "patch": "@@ -8,7 +8,13 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-// compile-flags:-g\n+// We disable tail merging here because it can't preserve debuginfo and thus\n+// potentially breaks the backtraces. Also, subtle changes can decide whether\n+// tail merging suceeds, so the test might work today but fail tomorrow due to a\n+// seemingly completely unrelated change.\n+// Unfortunately, LLVM has no \"disable\" option for this, so we have to set\n+// \"enable\" to 0 instead.\n+// compile-flags:-g -Cllvm-args=-enable-tail-merge=0\n // ignore-pretty as this critically relies on line numbers\n \n use std::io;\n@@ -97,6 +103,10 @@ fn inner_inlined(counter: &mut i32, main_pos: Pos, outer_pos: Pos) {\n     let inner_pos = pos!(); aux::callback_inlined(|aux_pos| {\n         check!(counter; main_pos, outer_pos, inner_pos, aux_pos);\n     });\n+\n+    // this tests a distinction between two independent calls to the inlined function.\n+    // (un)fortunately, LLVM somehow merges two consecutive such calls into one node.\n+    inner_further_inlined(counter, main_pos, outer_pos, pos!());\n }\n \n #[inline(never)]"}]}