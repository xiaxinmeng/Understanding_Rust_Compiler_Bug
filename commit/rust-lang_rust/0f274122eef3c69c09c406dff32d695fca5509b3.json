{"sha": "0f274122eef3c69c09c406dff32d695fca5509b3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBmMjc0MTIyZWVmM2M2OWMwOWM0MDZkZmYzMmQ2OTVmY2E1NTA5YjM=", "commit": {"author": {"name": "Kyle Stachowicz", "email": "kylestach99@gmail.com", "date": "2018-05-16T03:17:20Z"}, "committer": {"name": "Kyle Stachowicz", "email": "kylestach99@gmail.com", "date": "2018-05-18T23:57:15Z"}, "message": "Add test case for shadowed labels, with the inner broken multiple times", "tree": {"sha": "82d339bc69fc23fb16731e5020c495ccafaeff14", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/82d339bc69fc23fb16731e5020c495ccafaeff14"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0f274122eef3c69c09c406dff32d695fca5509b3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0f274122eef3c69c09c406dff32d695fca5509b3", "html_url": "https://github.com/rust-lang/rust/commit/0f274122eef3c69c09c406dff32d695fca5509b3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0f274122eef3c69c09c406dff32d695fca5509b3/comments", "author": {"login": "kylestach", "id": 9097872, "node_id": "MDQ6VXNlcjkwOTc4NzI=", "avatar_url": "https://avatars.githubusercontent.com/u/9097872?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kylestach", "html_url": "https://github.com/kylestach", "followers_url": "https://api.github.com/users/kylestach/followers", "following_url": "https://api.github.com/users/kylestach/following{/other_user}", "gists_url": "https://api.github.com/users/kylestach/gists{/gist_id}", "starred_url": "https://api.github.com/users/kylestach/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kylestach/subscriptions", "organizations_url": "https://api.github.com/users/kylestach/orgs", "repos_url": "https://api.github.com/users/kylestach/repos", "events_url": "https://api.github.com/users/kylestach/events{/privacy}", "received_events_url": "https://api.github.com/users/kylestach/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kylestach", "id": 9097872, "node_id": "MDQ6VXNlcjkwOTc4NzI=", "avatar_url": "https://avatars.githubusercontent.com/u/9097872?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kylestach", "html_url": "https://github.com/kylestach", "followers_url": "https://api.github.com/users/kylestach/followers", "following_url": "https://api.github.com/users/kylestach/following{/other_user}", "gists_url": "https://api.github.com/users/kylestach/gists{/gist_id}", "starred_url": "https://api.github.com/users/kylestach/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kylestach/subscriptions", "organizations_url": "https://api.github.com/users/kylestach/orgs", "repos_url": "https://api.github.com/users/kylestach/repos", "events_url": "https://api.github.com/users/kylestach/events{/privacy}", "received_events_url": "https://api.github.com/users/kylestach/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "acd6ab8f0f00365b424ac9cd83d9d08852add0bc", "url": "https://api.github.com/repos/rust-lang/rust/commits/acd6ab8f0f00365b424ac9cd83d9d08852add0bc", "html_url": "https://github.com/rust-lang/rust/commit/acd6ab8f0f00365b424ac9cd83d9d08852add0bc"}], "stats": {"total": 45, "additions": 37, "deletions": 8}, "files": [{"sha": "f19b793546eb1ab1b5fdf264b50eda9e45beabff", "filename": "src/test/ui/lint/unused_label.rs", "status": "modified", "additions": 20, "deletions": 6, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/0f274122eef3c69c09c406dff32d695fca5509b3/src%2Ftest%2Fui%2Flint%2Funused_label.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0f274122eef3c69c09c406dff32d695fca5509b3/src%2Ftest%2Fui%2Flint%2Funused_label.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Funused_label.rs?ref=0f274122eef3c69c09c406dff32d695fca5509b3", "patch": "@@ -33,27 +33,41 @@ fn main() {\n         break 'used_loop_label;\n     }\n \n-    'used_loop_label_outer_1: loop {\n-        'used_loop_label_inner_1: loop {\n+    'used_loop_label_outer_1: for _ in 0..10 {\n+        'used_loop_label_inner_1: for _ in 0..10 {\n             break 'used_loop_label_inner_1;\n         }\n         break 'used_loop_label_outer_1;\n     }\n \n-    'used_loop_label_outer_2: loop {\n-        'unused_loop_label_inner_2: loop {\n+    'used_loop_label_outer_2: for _ in 0..10 {\n+        'unused_loop_label_inner_2: for _ in 0..10 {\n             //~^ WARN unused label\n             break 'used_loop_label_outer_2;\n         }\n     }\n \n-    'unused_loop_label_outer_3: loop {\n+    'unused_loop_label_outer_3: for _ in 0..10 {\n         //~^ WARN unused label\n-        'used_loop_label_inner_3: loop {\n+        'used_loop_label_inner_3: for _ in 0..10 {\n             break 'used_loop_label_inner_3;\n         }\n     }\n \n+    // Test breaking many times with the same inner label doesn't break the\n+    // warning on the outer label\n+    'many_used_shadowed: for _ in 0..10 {\n+        //~^ WARN unused label\n+        'many_used_shadowed: for _ in 0..10 {\n+            //~^ WARN label name `'many_used_shadowed` shadows a label name that is already in scope\n+            if 1 % 2 == 0 {\n+                break 'many_used_shadowed;\n+            } else {\n+                break 'many_used_shadowed;\n+            }\n+        }\n+    }\n+\n     // This is diverging, so put it at the end so we don't get\n     // unreachable_code errors everywhere else\n     'unused_loop_label: loop {"}, {"sha": "e78df67794218cf8bf5adf99deb4db4961f51a6e", "filename": "src/test/ui/lint/unused_label.stderr", "status": "modified", "additions": 17, "deletions": 2, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/0f274122eef3c69c09c406dff32d695fca5509b3/src%2Ftest%2Fui%2Flint%2Funused_label.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0f274122eef3c69c09c406dff32d695fca5509b3/src%2Ftest%2Fui%2Flint%2Funused_label.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Funused_label.stderr?ref=0f274122eef3c69c09c406dff32d695fca5509b3", "patch": "@@ -21,18 +21,33 @@ LL |     'unused_for_label: for _ in 0..10 {\n warning: unused label\n   --> $DIR/unused_label.rs:44:9\n    |\n-LL |         'unused_loop_label_inner_2: loop {\n+LL |         'unused_loop_label_inner_2: for _ in 0..10 {\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused label\n   --> $DIR/unused_label.rs:50:5\n    |\n-LL |     'unused_loop_label_outer_3: loop {\n+LL |     'unused_loop_label_outer_3: for _ in 0..10 {\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused label\n   --> $DIR/unused_label.rs:59:5\n    |\n+LL |     'many_used_shadowed: for _ in 0..10 {\n+   |     ^^^^^^^^^^^^^^^^^^^\n+\n+warning: unused label\n+  --> $DIR/unused_label.rs:73:5\n+   |\n LL |     'unused_loop_label: loop {\n    |     ^^^^^^^^^^^^^^^^^^\n \n+warning: label name `'many_used_shadowed` shadows a label name that is already in scope\n+  --> $DIR/unused_label.rs:61:9\n+   |\n+LL |     'many_used_shadowed: for _ in 0..10 {\n+   |     ------------------- first declared here\n+LL |         //~^ WARN unused label\n+LL |         'many_used_shadowed: for _ in 0..10 {\n+   |         ^^^^^^^^^^^^^^^^^^^ lifetime 'many_used_shadowed already in scope\n+"}]}