{"sha": "0f822d775f046df87713edf8ffb4e308fc77b3ef", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBmODIyZDc3NWYwNDZkZjg3NzEzZWRmOGZmYjRlMzA4ZmM3N2IzZWY=", "commit": {"author": {"name": "Mark Mansi", "email": "markm@cs.wisc.edu", "date": "2019-06-03T04:20:36Z"}, "committer": {"name": "Mark Mansi", "email": "markm@cs.wisc.edu", "date": "2019-06-03T04:20:36Z"}, "message": "query-fy type_name", "tree": {"sha": "8fdcac7fd858cd2673b5e205b653f3f39abaac13", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8fdcac7fd858cd2673b5e205b653f3f39abaac13"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0f822d775f046df87713edf8ffb4e308fc77b3ef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0f822d775f046df87713edf8ffb4e308fc77b3ef", "html_url": "https://github.com/rust-lang/rust/commit/0f822d775f046df87713edf8ffb4e308fc77b3ef", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0f822d775f046df87713edf8ffb4e308fc77b3ef/comments", "author": {"login": "mark-i-m", "id": 8827840, "node_id": "MDQ6VXNlcjg4Mjc4NDA=", "avatar_url": "https://avatars.githubusercontent.com/u/8827840?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mark-i-m", "html_url": "https://github.com/mark-i-m", "followers_url": "https://api.github.com/users/mark-i-m/followers", "following_url": "https://api.github.com/users/mark-i-m/following{/other_user}", "gists_url": "https://api.github.com/users/mark-i-m/gists{/gist_id}", "starred_url": "https://api.github.com/users/mark-i-m/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mark-i-m/subscriptions", "organizations_url": "https://api.github.com/users/mark-i-m/orgs", "repos_url": "https://api.github.com/users/mark-i-m/repos", "events_url": "https://api.github.com/users/mark-i-m/events{/privacy}", "received_events_url": "https://api.github.com/users/mark-i-m/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mark-i-m", "id": 8827840, "node_id": "MDQ6VXNlcjg4Mjc4NDA=", "avatar_url": "https://avatars.githubusercontent.com/u/8827840?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mark-i-m", "html_url": "https://github.com/mark-i-m", "followers_url": "https://api.github.com/users/mark-i-m/followers", "following_url": "https://api.github.com/users/mark-i-m/following{/other_user}", "gists_url": "https://api.github.com/users/mark-i-m/gists{/gist_id}", "starred_url": "https://api.github.com/users/mark-i-m/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mark-i-m/subscriptions", "organizations_url": "https://api.github.com/users/mark-i-m/orgs", "repos_url": "https://api.github.com/users/mark-i-m/repos", "events_url": "https://api.github.com/users/mark-i-m/events{/privacy}", "received_events_url": "https://api.github.com/users/mark-i-m/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b7f5eab11c687f084e37a6a5fa5c46326d83a5b4", "url": "https://api.github.com/repos/rust-lang/rust/commits/b7f5eab11c687f084e37a6a5fa5c46326d83a5b4", "html_url": "https://github.com/rust-lang/rust/commit/b7f5eab11c687f084e37a6a5fa5c46326d83a5b4"}], "stats": {"total": 15, "additions": 12, "deletions": 3}, "files": [{"sha": "d7191743c36f6c50f468f25e76fccb44db1eb01b", "filename": "Cargo.lock", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0f822d775f046df87713edf8ffb4e308fc77b3ef/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/0f822d775f046df87713edf8ffb4e308fc77b3ef/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=0f822d775f046df87713edf8ffb4e308fc77b3ef", "patch": "@@ -2684,7 +2684,6 @@ dependencies = [\n  \"rustc_errors 0.0.0\",\n  \"rustc_fs_util 0.0.0\",\n  \"rustc_incremental 0.0.0\",\n- \"rustc_mir 0.0.0\",\n  \"rustc_target 0.0.0\",\n  \"serialize 0.0.0\",\n  \"syntax 0.0.0\","}, {"sha": "10efef54526a6d49a905927f24de082a9169d40f", "filename": "src/librustc/query/mod.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/0f822d775f046df87713edf8ffb4e308fc77b3ef/src%2Flibrustc%2Fquery%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0f822d775f046df87713edf8ffb4e308fc77b3ef/src%2Flibrustc%2Fquery%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fquery%2Fmod.rs?ref=0f822d775f046df87713edf8ffb4e308fc77b3ef", "patch": "@@ -441,6 +441,15 @@ rustc_queries! {\n             no_force\n             desc { \"extract field of const\" }\n         }\n+\n+        /// Produces an absolute path representation of the given type. See also the documentation\n+        /// on `std::any::type_name`.\n+        query type_name(key: Ty<'tcx>) -> &'tcx ty::Const<'tcx> {\n+            eval_always\n+            no_force\n+            desc { \"get absolute path of type\" }\n+        }\n+\n     }\n \n     TypeChecking {"}, {"sha": "98a829b2affecf044eebac96f9a3adad09284608", "filename": "src/librustc_codegen_llvm/intrinsic.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0f822d775f046df87713edf8ffb4e308fc77b3ef/src%2Flibrustc_codegen_llvm%2Fintrinsic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0f822d775f046df87713edf8ffb4e308fc77b3ef/src%2Flibrustc_codegen_llvm%2Fintrinsic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fintrinsic.rs?ref=0f822d775f046df87713edf8ffb4e308fc77b3ef", "patch": "@@ -212,7 +212,7 @@ impl IntrinsicCallMethods<'tcx> for Builder<'a, 'll, 'tcx> {\n             }\n             \"type_name\" => {\n                 let tp_ty = substs.type_at(0);\n-                let ty_name = rustc_mir::interpret::type_name(self.tcx, tp_ty);\n+                let ty_name = self.tcx.type_name(tp_ty);\n                 OperandRef::from_const(self, ty_name).immediate_or_packed_pair(self)\n             }\n             \"type_id\" => {"}, {"sha": "d59bee6943a51fa45a0b0e2a91e9c7ddf9345b73", "filename": "src/librustc_mir/interpret/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0f822d775f046df87713edf8ffb4e308fc77b3ef/src%2Flibrustc_mir%2Finterpret%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0f822d775f046df87713edf8ffb4e308fc77b3ef/src%2Flibrustc_mir%2Finterpret%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Fmod.rs?ref=0f822d775f046df87713edf8ffb4e308fc77b3ef", "patch": "@@ -33,4 +33,4 @@ pub use self::visitor::{ValueVisitor, MutValueVisitor};\n \n pub use self::validity::RefTracking;\n \n-pub use self::intrinsics::type_name;\n+pub(super) use self::intrinsics::type_name;"}, {"sha": "9213a009ea740374641900fa189a332c0c2b5f1e", "filename": "src/librustc_mir/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0f822d775f046df87713edf8ffb4e308fc77b3ef/src%2Flibrustc_mir%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0f822d775f046df87713edf8ffb4e308fc77b3ef/src%2Flibrustc_mir%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Flib.rs?ref=0f822d775f046df87713edf8ffb4e308fc77b3ef", "patch": "@@ -67,6 +67,7 @@ pub fn provide(providers: &mut Providers<'_>) {\n         let (param_env, (value, field)) = param_env_and_value.into_parts();\n         const_eval::const_field(tcx, param_env, None, field, value)\n     };\n+    providers.type_name = interpret::type_name;\n }\n \n __build_diagnostic_array! { librustc_mir, DIAGNOSTICS }"}]}