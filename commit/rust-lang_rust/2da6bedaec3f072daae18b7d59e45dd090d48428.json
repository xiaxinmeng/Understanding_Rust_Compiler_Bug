{"sha": "2da6bedaec3f072daae18b7d59e45dd090d48428", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJkYTZiZWRhZWMzZjA3MmRhYWUxOGI3ZDU5ZTQ1ZGQwOTBkNDg0Mjg=", "commit": {"author": {"name": "hyd-dev", "email": "yd-huang@outlook.com", "date": "2021-04-30T09:22:24Z"}, "committer": {"name": "hyd-dev", "email": "yd-huang@outlook.com", "date": "2021-05-01T14:28:33Z"}, "message": "Use `harness = false` instead of `#![feature(custom_test_frameworks)]`", "tree": {"sha": "8326665e32c3a926501d2ffb0b9c3e218d768e75", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8326665e32c3a926501d2ffb0b9c3e218d768e75"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2da6bedaec3f072daae18b7d59e45dd090d48428", "comment_count": 0, "verification": {"verified": false, "reason": "no_user", "signature": "-----BEGIN PGP SIGNATURE-----\n\niIsEABYIADMWIQRJ2jPMDdiQ+U4U42Z0+n/VuNoUuAUCYI1lnxUceWQtaHVhbmdA\nb3V0bG9vay5jb20ACgkQdPp/1bjaFLi0JQD/cI0j5Sy/gcEitHEjWw0E4X3jzqDa\ne9WaisxesyaJM34BAOd2tqJoNii1kqVRP5BGfcws1CvJXTnYfCFj32yHv2IL\n=kG2/\n-----END PGP SIGNATURE-----", "payload": "tree 8326665e32c3a926501d2ffb0b9c3e218d768e75\nparent 41f3fe64317a6ef144d2ac33e4e5870d894d6038\nauthor hyd-dev <yd-huang@outlook.com> 1619774544 +0800\ncommitter hyd-dev <yd-huang@outlook.com> 1619879313 +0800\n\nUse `harness = false` instead of `#![feature(custom_test_frameworks)]`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2da6bedaec3f072daae18b7d59e45dd090d48428", "html_url": "https://github.com/rust-lang/rust/commit/2da6bedaec3f072daae18b7d59e45dd090d48428", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2da6bedaec3f072daae18b7d59e45dd090d48428/comments", "author": null, "committer": null, "parents": [{"sha": "41f3fe64317a6ef144d2ac33e4e5870d894d6038", "url": "https://api.github.com/repos/rust-lang/rust/commits/41f3fe64317a6ef144d2ac33e4e5870d894d6038", "html_url": "https://github.com/rust-lang/rust/commit/41f3fe64317a6ef144d2ac33e4e5870d894d6038"}], "stats": {"total": 10, "additions": 5, "deletions": 5}, "files": [{"sha": "ab7d88e66934a6aed98cfd7134dc2580faebe090", "filename": "Cargo.toml", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2da6bedaec3f072daae18b7d59e45dd090d48428/Cargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/2da6bedaec3f072daae18b7d59e45dd090d48428/Cargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.toml?ref=2da6bedaec3f072daae18b7d59e45dd090d48428", "patch": "@@ -45,3 +45,7 @@ colored = \"2\"\n # This crate uses #[feature(rustc_private)]. \n # See https://github.com/rust-analyzer/rust-analyzer/pull/7891\n rustc_private = true\n+\n+[[test]]\n+name = \"compiletest\"\n+harness = false"}, {"sha": "a0d49c9ddcf4864115131b10a9951a3aea127174", "filename": "tests/compiletest.rs", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/2da6bedaec3f072daae18b7d59e45dd090d48428/tests%2Fcompiletest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2da6bedaec3f072daae18b7d59e45dd090d48428/tests%2Fcompiletest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompiletest.rs?ref=2da6bedaec3f072daae18b7d59e45dd090d48428", "patch": "@@ -1,7 +1,3 @@\n-#![feature(custom_test_frameworks)]\n-// Custom test runner, to avoid libtest being wrapped around compiletest which wraps libtest.\n-#![test_runner(test_runner)]\n-\n use std::env;\n use std::path::PathBuf;\n \n@@ -83,7 +79,7 @@ fn get_target() -> String {\n     env::var(\"MIRI_TEST_TARGET\").unwrap_or_else(|_| get_host())\n }\n \n-fn test_runner(_tests: &[&()]) {\n+fn main() {\n     // Add a test env var to do environment communication tests.\n     env::set_var(\"MIRI_ENV_VAR_TEST\", \"0\");\n     // Let the tests know where to store temp files (they might run for a different target, which can make this hard to find)."}]}