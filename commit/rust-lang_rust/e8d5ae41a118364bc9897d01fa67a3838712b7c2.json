{"sha": "e8d5ae41a118364bc9897d01fa67a3838712b7c2", "node_id": "C_kwDOAAsO6NoAKGU4ZDVhZTQxYTExODM2NGJjOTg5N2QwMWZhNjdhMzgzODcxMmI3YzI", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-02-09T13:44:10Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-02-09T13:55:26Z"}, "message": "Update rustdoc tests for headings indent", "tree": {"sha": "35802732347781b691a08d9053d09ad814a96ec0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/35802732347781b691a08d9053d09ad814a96ec0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e8d5ae41a118364bc9897d01fa67a3838712b7c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e8d5ae41a118364bc9897d01fa67a3838712b7c2", "html_url": "https://github.com/rust-lang/rust/commit/e8d5ae41a118364bc9897d01fa67a3838712b7c2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e8d5ae41a118364bc9897d01fa67a3838712b7c2/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6aad08f13ffba2a18428c4f5ad03977bc1503f5d", "url": "https://api.github.com/repos/rust-lang/rust/commits/6aad08f13ffba2a18428c4f5ad03977bc1503f5d", "html_url": "https://github.com/rust-lang/rust/commit/6aad08f13ffba2a18428c4f5ad03977bc1503f5d"}], "stats": {"total": 92, "additions": 13, "deletions": 79}, "files": [{"sha": "5c0bf0ed942f4169ffde9eae363db910791b9323", "filename": "src/librustdoc/html/markdown/tests.rs", "status": "modified", "additions": 7, "deletions": 34, "changes": 41, "blob_url": "https://github.com/rust-lang/rust/blob/e8d5ae41a118364bc9897d01fa67a3838712b7c2/src%2Flibrustdoc%2Fhtml%2Fmarkdown%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e8d5ae41a118364bc9897d01fa67a3838712b7c2/src%2Flibrustdoc%2Fhtml%2Fmarkdown%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fmarkdown%2Ftests.rs?ref=e8d5ae41a118364bc9897d01fa67a3838712b7c2", "patch": "@@ -159,10 +159,7 @@ fn test_header() {\n         assert_eq!(output, expect, \"original: {}\", input);\n     }\n \n-    t(\n-        \"# Foo bar\",\n-        \"<h2 id=\\\"foo-bar\\\"><a href=\\\"#foo-bar\\\">Foo bar</a></h2>\",\n-    );\n+    t(\"# Foo bar\", \"<h2 id=\\\"foo-bar\\\"><a href=\\\"#foo-bar\\\">Foo bar</a></h2>\");\n     t(\n         \"## Foo-bar_baz qux\",\n         \"<h3 id=\\\"foo-bar_baz-qux\\\">\\\n@@ -201,36 +198,12 @@ fn test_header_ids_multiple_blocks() {\n         assert_eq!(output, expect, \"original: {}\", input);\n     }\n \n-    t(\n-        &mut map,\n-        \"# Example\",\n-        \"<h2 id=\\\"example\\\"><a href=\\\"#example\\\">Example</a></h2>\",\n-    );\n-    t(\n-        &mut map,\n-        \"# Panics\",\n-        \"<h2 id=\\\"panics\\\"><a href=\\\"#panics\\\">Panics</a></h2>\",\n-    );\n-    t(\n-        &mut map,\n-        \"# Example\",\n-        \"<h2 id=\\\"example-1\\\"><a href=\\\"#example-1\\\">Example</a></h2>\",\n-    );\n-    t(\n-        &mut map,\n-        \"# Search\",\n-        \"<h2 id=\\\"search-1\\\"><a href=\\\"#search-1\\\">Search</a></h2>\",\n-    );\n-    t(\n-        &mut map,\n-        \"# Example\",\n-        \"<h2 id=\\\"example-2\\\"><a href=\\\"#example-2\\\">Example</a></h2>\",\n-    );\n-    t(\n-        &mut map,\n-        \"# Panics\",\n-        \"<h2 id=\\\"panics-1\\\"><a href=\\\"#panics-1\\\">Panics</a></h2>\",\n-    );\n+    t(&mut map, \"# Example\", \"<h2 id=\\\"example\\\"><a href=\\\"#example\\\">Example</a></h2>\");\n+    t(&mut map, \"# Panics\", \"<h2 id=\\\"panics\\\"><a href=\\\"#panics\\\">Panics</a></h2>\");\n+    t(&mut map, \"# Example\", \"<h2 id=\\\"example-1\\\"><a href=\\\"#example-1\\\">Example</a></h2>\");\n+    t(&mut map, \"# Search\", \"<h2 id=\\\"search-1\\\"><a href=\\\"#search-1\\\">Search</a></h2>\");\n+    t(&mut map, \"# Example\", \"<h2 id=\\\"example-2\\\"><a href=\\\"#example-2\\\">Example</a></h2>\");\n+    t(&mut map, \"# Panics\", \"<h2 id=\\\"panics-1\\\"><a href=\\\"#panics-1\\\">Panics</a></h2>\");\n }\n \n #[test]"}, {"sha": "ddfb23a4f86ba555a3cf20f84c2111e68a02356f", "filename": "src/test/rustdoc-gui/anchors.goml", "status": "modified", "additions": 0, "deletions": 42, "changes": 42, "blob_url": "https://github.com/rust-lang/rust/blob/e8d5ae41a118364bc9897d01fa67a3838712b7c2/src%2Ftest%2Frustdoc-gui%2Fanchors.goml", "raw_url": "https://github.com/rust-lang/rust/raw/e8d5ae41a118364bc9897d01fa67a3838712b7c2/src%2Ftest%2Frustdoc-gui%2Fanchors.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fanchors.goml?ref=e8d5ae41a118364bc9897d01fa67a3838712b7c2", "patch": "@@ -31,46 +31,4 @@ assert-css: (\"h2#implementations a.anchor\", {\"color\": \"rgb(0, 0, 0)\"})\n move-cursor-to: \"#impl\"\n assert-css: (\"#impl a.anchor\", {\"color\": \"rgb(0, 0, 0)\"})\n \n-// Now we check the positions: only the first heading of the top doc comment should\n-// have a different position.\n-move-cursor-to: \".top-doc .docblock .section-header:first-child\"\n-assert-css: (\n-    \".top-doc .docblock .section-header:first-child > a::before\",\n-    {\"left\": \"-10px\", \"padding-right\": \"10px\"},\n-)\n-// We also check that the heading itself has a different indent.\n-assert-css: (\".top-doc .docblock .section-header:first-child\", {\"margin-left\": \"15px\"})\n-\n-move-cursor-to: \".top-doc .docblock .section-header:not(:first-child)\"\n-assert-css: (\n-    \".top-doc .docblock .section-header:not(:first-child) > a::before\",\n-    {\"left\": \"-25px\", \"padding-right\": \"10px\"},\n-)\n-assert-css: (\".top-doc .docblock .section-header:not(:first-child)\", {\"margin-left\": \"0px\"})\n-\n-// Now let's check some other docblock headings...\n-// First the impl block docs.\n-move-cursor-to: \"#title-for-struct-impl-doc\"\n-assert-css: (\n-    \"#title-for-struct-impl-doc > a::before\",\n-    {\"left\": \"-25px\", \"padding-right\": \"10px\"},\n-)\n-assert-css: (\"#title-for-struct-impl-doc\", {\"margin-left\": \"0px\"})\n-// Now a method docs.\n-move-cursor-to: \"#title-for-struct-impl-item-doc\"\n-assert-css: (\n-    \"#title-for-struct-impl-item-doc > a::before\",\n-    {\"left\": \"-25px\", \"padding-right\": \"10px\"},\n-)\n assert-css: (\"#title-for-struct-impl-item-doc\", {\"margin-left\": \"0px\"})\n-\n-// Finally, we want to ensure that if the first element of the doc block isn't a heading,\n-// if there is a heading afterwards, it won't have the indent.\n-goto: file://|DOC_PATH|/test_docs/enum.WhoLetTheDogOut.html\n-\n-move-cursor-to: \".top-doc .docblock .section-header\"\n-assert-css: (\n-    \".top-doc .docblock .section-header > a::before\",\n-    {\"left\": \"-25px\", \"padding-right\": \"10px\"},\n-)\n-assert-css: (\".top-doc .docblock .section-header\", {\"margin-left\": \"0px\"})"}, {"sha": "cf9caa2d5866a150ad2da9e3d88fe02a500c1682", "filename": "src/test/rustdoc-gui/headers-color.goml", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/e8d5ae41a118364bc9897d01fa67a3838712b7c2/src%2Ftest%2Frustdoc-gui%2Fheaders-color.goml", "raw_url": "https://github.com/rust-lang/rust/raw/e8d5ae41a118364bc9897d01fa67a3838712b7c2/src%2Ftest%2Frustdoc-gui%2Fheaders-color.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fheaders-color.goml?ref=e8d5ae41a118364bc9897d01fa67a3838712b7c2", "patch": "@@ -40,7 +40,8 @@ goto: file://|DOC_PATH|/test_docs/index.html\n assert-css: (\".small-section-header a\", {\"color\": \"rgb(197, 197, 197)\"}, ALL)\n \n goto: file://|DOC_PATH|/test_docs/struct.HeavilyDocumentedStruct.html\n-assert-css: (\".section-header a\", {\"color\": \"rgb(57, 175, 215)\"}, ALL)\n+// We select headings (h2, h3, h...).\n+assert-css: (\".docblock > :not(p) > a\", {\"color\": \"rgb(57, 175, 215)\"}, ALL)\n \n // Dark theme\n local-storage: {\n@@ -78,7 +79,8 @@ goto: file://|DOC_PATH|/test_docs/index.html\n assert-css: (\".small-section-header a\", {\"color\": \"rgb(221, 221, 221)\"}, ALL)\n \n goto: file://|DOC_PATH|/test_docs/struct.HeavilyDocumentedStruct.html\n-assert-css: (\".section-header a\", {\"color\": \"rgb(210, 153, 29)\"}, ALL)\n+// We select headings (h2, h3, h...).\n+assert-css: (\".docblock > :not(p) > a\", {\"color\": \"rgb(210, 153, 29)\"}, ALL)\n \n // Light theme\n local-storage: {\"rustdoc-theme\": \"light\", \"rustdoc-use-system-theme\": \"false\"}\n@@ -111,4 +113,5 @@ goto: file://|DOC_PATH|/test_docs/index.html\n assert-css: (\".small-section-header a\", {\"color\": \"rgb(0, 0, 0)\"}, ALL)\n \n goto: file://|DOC_PATH|/test_docs/struct.HeavilyDocumentedStruct.html\n-assert-css: (\".section-header a\", {\"color\": \"rgb(56, 115, 173)\"}, ALL)\n+// We select headings (h2, h3, h...).\n+assert-css: (\".docblock > :not(p) > a\", {\"color\": \"rgb(56, 115, 173)\"}, ALL)"}]}