{"sha": "3c72a848e9d4470d49969fa0ef0a0a8a0c24d681", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNjNzJhODQ4ZTlkNDQ3MGQ0OTk2OWZhMGVmMGEwYThhMGMyNGQ2ODE=", "commit": {"author": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2018-02-04T22:00:56Z"}, "committer": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2018-02-04T22:00:56Z"}, "message": "save-analysis: avoid implicit unwrap\n\nWhen looking up a field defintion, since the name might be incorrect in the field init shorthand case.\n\ncc https://github.com/rust-lang-nursery/rls/issues/699", "tree": {"sha": "6378189381724ba42e87d9ce3212c483a81e0226", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6378189381724ba42e87d9ce3212c483a81e0226"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3c72a848e9d4470d49969fa0ef0a0a8a0c24d681", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3c72a848e9d4470d49969fa0ef0a0a8a0c24d681", "html_url": "https://github.com/rust-lang/rust/commit/3c72a848e9d4470d49969fa0ef0a0a8a0c24d681", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3c72a848e9d4470d49969fa0ef0a0a8a0c24d681/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0c6091fbd0eee290c651f73be899f221eeab3c05", "url": "https://api.github.com/repos/rust-lang/rust/commits/0c6091fbd0eee290c651f73be899f221eeab3c05", "html_url": "https://github.com/rust-lang/rust/commit/0c6091fbd0eee290c651f73be899f221eeab3c05"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "7bd7d5cb15d8eacda5a532da7cb883f8835ddbb6", "filename": "src/librustc_save_analysis/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3c72a848e9d4470d49969fa0ef0a0a8a0c24d681/src%2Flibrustc_save_analysis%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c72a848e9d4470d49969fa0ef0a0a8a0c24d681/src%2Flibrustc_save_analysis%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_save_analysis%2Flib.rs?ref=3c72a848e9d4470d49969fa0ef0a0a8a0c24d681", "patch": "@@ -791,7 +791,7 @@ impl<'l, 'tcx: 'l> SaveContext<'l, 'tcx> {\n         field_ref: &ast::Field,\n         variant: &ty::VariantDef,\n     ) -> Option<Ref> {\n-        let f = variant.field_named(field_ref.ident.node.name);\n+        let f = variant.find_field_named(field_ref.ident.node.name)?;\n         // We don't really need a sub-span here, but no harm done\n         let sub_span = self.span_utils.span_for_last_ident(field_ref.ident.span);\n         filter!(self.span_utils, sub_span, field_ref.ident.span, None);"}, {"sha": "07322d8bbc3253cb9c03556e479bb50c898c52f1", "filename": "src/test/run-make/save-analysis-fail/foo.rs", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/3c72a848e9d4470d49969fa0ef0a0a8a0c24d681/src%2Ftest%2Frun-make%2Fsave-analysis-fail%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c72a848e9d4470d49969fa0ef0a0a8a0c24d681/src%2Ftest%2Frun-make%2Fsave-analysis-fail%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fsave-analysis-fail%2Ffoo.rs?ref=3c72a848e9d4470d49969fa0ef0a0a8a0c24d681", "patch": "@@ -451,3 +451,11 @@ extern {\n     static EXTERN_FOO: u8;\n     fn extern_foo(a: u8, b: i32) -> String;\n }\n+\n+struct Rls699 {\n+  f: u32,\n+}\n+\n+fn new(f: u32) -> Rls699 {\n+    Rls699 { fs }\n+}"}]}