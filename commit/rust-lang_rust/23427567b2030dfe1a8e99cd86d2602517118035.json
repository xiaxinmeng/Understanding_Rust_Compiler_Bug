{"sha": "23427567b2030dfe1a8e99cd86d2602517118035", "node_id": "C_kwDOAAsO6NoAKDIzNDI3NTY3YjIwMzBkZmUxYThlOTljZDg2ZDI2MDI1MTcxMTgwMzU", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2021-11-25T14:39:04Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2021-11-26T20:03:45Z"}, "message": "Update test for anchors and headings position", "tree": {"sha": "1b39cc31cc320fc31dd7fa42c493c7b4dab087c7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1b39cc31cc320fc31dd7fa42c493c7b4dab087c7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/23427567b2030dfe1a8e99cd86d2602517118035", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/23427567b2030dfe1a8e99cd86d2602517118035", "html_url": "https://github.com/rust-lang/rust/commit/23427567b2030dfe1a8e99cd86d2602517118035", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/23427567b2030dfe1a8e99cd86d2602517118035/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "20eda22cbf36b5e9bf9fe28c53790c30fb31c9d3", "url": "https://api.github.com/repos/rust-lang/rust/commits/20eda22cbf36b5e9bf9fe28c53790c30fb31c9d3", "html_url": "https://github.com/rust-lang/rust/commit/20eda22cbf36b5e9bf9fe28c53790c30fb31c9d3"}], "stats": {"total": 48, "additions": 47, "deletions": 1}, "files": [{"sha": "8910cbbbb256c7c14cccd904c548591919a52576", "filename": "src/test/rustdoc-gui/anchors.goml", "status": "modified", "additions": 45, "deletions": 1, "changes": 46, "blob_url": "https://github.com/rust-lang/rust/blob/23427567b2030dfe1a8e99cd86d2602517118035/src%2Ftest%2Frustdoc-gui%2Fanchors.goml", "raw_url": "https://github.com/rust-lang/rust/raw/23427567b2030dfe1a8e99cd86d2602517118035/src%2Ftest%2Frustdoc-gui%2Fanchors.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fanchors.goml?ref=23427567b2030dfe1a8e99cd86d2602517118035", "patch": "@@ -1,4 +1,4 @@\n-// This test is to ensure that the anchors (`\u00a7`) have the expected color.\n+// This test is to ensure that the anchors (`\u00a7`) have the expected color and position.\n goto: file://|DOC_PATH|/test_docs/struct.HeavilyDocumentedStruct.html\n show-text: true\n \n@@ -28,3 +28,47 @@ assert-css: (\"h2#implementations a.anchor\", {\"color\": \"rgb(0, 0, 0)\"})\n // Same thing with the impl block title.\n move-cursor-to: \"#impl\"\n assert-css: (\"#impl a.anchor\", {\"color\": \"rgb(0, 0, 0)\"})\n+\n+// Now we check the positions: only the first heading of the top doc comment should\n+// have a different position.\n+move-cursor-to: \".top-doc .docblock .section-header:first-child\"\n+assert-css: (\n+    \".top-doc .docblock .section-header:first-child > a::before\",\n+    {\"left\": \"-10px\", \"padding-right\": \"10px\"}\n+)\n+// We also check that the heading itself has a different indent.\n+assert-css: (\".top-doc .docblock .section-header:first-child\", {\"margin-left\": \"15px\"})\n+\n+move-cursor-to: \".top-doc .docblock .section-header:not(:first-child)\"\n+assert-css: (\n+    \".top-doc .docblock .section-header:not(:first-child) > a::before\",\n+    {\"left\": \"-25px\", \"padding-right\": \"10px\"}\n+)\n+assert-css: (\".top-doc .docblock .section-header:not(:first-child)\", {\"margin-left\": \"0px\"})\n+\n+// Now let's check some other docblock headings...\n+// First the impl block docs.\n+move-cursor-to: \"#title-for-struct-impl-doc\"\n+assert-css: (\n+    \"#title-for-struct-impl-doc > a::before\",\n+    {\"left\": \"-25px\", \"padding-right\": \"10px\"}\n+)\n+assert-css: (\"#title-for-struct-impl-doc\", {\"margin-left\": \"0px\"})\n+// Now a method docs.\n+move-cursor-to: \"#title-for-struct-impl-item-doc\"\n+assert-css: (\n+    \"#title-for-struct-impl-item-doc > a::before\",\n+    {\"left\": \"-25px\", \"padding-right\": \"10px\"}\n+)\n+assert-css: (\"#title-for-struct-impl-item-doc\", {\"margin-left\": \"0px\"})\n+\n+// Finally, we want to ensure that if the first element of the doc block isn't a heading,\n+// if there is a heading afterwards, it won't have the indent.\n+goto: file://|DOC_PATH|/test_docs/enum.WhoLetTheDogOut.html\n+\n+move-cursor-to: \".top-doc .docblock .section-header\"\n+assert-css: (\n+    \".top-doc .docblock .section-header > a::before\",\n+    {\"left\": \"-25px\", \"padding-right\": \"10px\"}\n+)\n+assert-css: (\".top-doc .docblock .section-header\", {\"margin-left\": \"0px\"})"}, {"sha": "9b37703dded4b7acf9e494019ecc200c512ad997", "filename": "src/test/rustdoc-gui/src/test_docs/lib.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23427567b2030dfe1a8e99cd86d2602517118035/src%2Ftest%2Frustdoc-gui%2Fsrc%2Ftest_docs%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23427567b2030dfe1a8e99cd86d2602517118035/src%2Ftest%2Frustdoc-gui%2Fsrc%2Ftest_docs%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsrc%2Ftest_docs%2Flib.rs?ref=23427567b2030dfe1a8e99cd86d2602517118035", "patch": "@@ -47,6 +47,8 @@ impl AsRef<str> for Foo {\n }\n \n /// Just a normal enum.\n+///\n+/// # title!\n #[doc(alias = \"ThisIsAnAlias\")]\n pub enum WhoLetTheDogOut {\n     /// Woof!"}]}