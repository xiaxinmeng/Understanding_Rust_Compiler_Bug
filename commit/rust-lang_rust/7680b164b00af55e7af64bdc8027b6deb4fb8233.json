{"sha": "7680b164b00af55e7af64bdc8027b6deb4fb8233", "node_id": "C_kwDOAAsO6NoAKDc2ODBiMTY0YjAwYWY1NWU3YWY2NGJkYzgwMjdiNmRlYjRmYjgyMzM", "commit": {"author": {"name": "Nixon Enraght-Moony", "email": "nixon.emoony@gmail.com", "date": "2023-01-02T19:30:39Z"}, "committer": {"name": "Nixon Enraght-Moony", "email": "nixon.emoony@gmail.com", "date": "2023-01-03T14:54:46Z"}, "message": "jsondoclint: Parse args with clap.", "tree": {"sha": "61cd24d66ed9996b5b522b6b773edf662f80dcd1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/61cd24d66ed9996b5b522b6b773edf662f80dcd1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7680b164b00af55e7af64bdc8027b6deb4fb8233", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7680b164b00af55e7af64bdc8027b6deb4fb8233", "html_url": "https://github.com/rust-lang/rust/commit/7680b164b00af55e7af64bdc8027b6deb4fb8233", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7680b164b00af55e7af64bdc8027b6deb4fb8233/comments", "author": {"login": "aDotInTheVoid", "id": 28781354, "node_id": "MDQ6VXNlcjI4NzgxMzU0", "avatar_url": "https://avatars.githubusercontent.com/u/28781354?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aDotInTheVoid", "html_url": "https://github.com/aDotInTheVoid", "followers_url": "https://api.github.com/users/aDotInTheVoid/followers", "following_url": "https://api.github.com/users/aDotInTheVoid/following{/other_user}", "gists_url": "https://api.github.com/users/aDotInTheVoid/gists{/gist_id}", "starred_url": "https://api.github.com/users/aDotInTheVoid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aDotInTheVoid/subscriptions", "organizations_url": "https://api.github.com/users/aDotInTheVoid/orgs", "repos_url": "https://api.github.com/users/aDotInTheVoid/repos", "events_url": "https://api.github.com/users/aDotInTheVoid/events{/privacy}", "received_events_url": "https://api.github.com/users/aDotInTheVoid/received_events", "type": "User", "site_admin": false}, "committer": {"login": "aDotInTheVoid", "id": 28781354, "node_id": "MDQ6VXNlcjI4NzgxMzU0", "avatar_url": "https://avatars.githubusercontent.com/u/28781354?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aDotInTheVoid", "html_url": "https://github.com/aDotInTheVoid", "followers_url": "https://api.github.com/users/aDotInTheVoid/followers", "following_url": "https://api.github.com/users/aDotInTheVoid/following{/other_user}", "gists_url": "https://api.github.com/users/aDotInTheVoid/gists{/gist_id}", "starred_url": "https://api.github.com/users/aDotInTheVoid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aDotInTheVoid/subscriptions", "organizations_url": "https://api.github.com/users/aDotInTheVoid/orgs", "repos_url": "https://api.github.com/users/aDotInTheVoid/repos", "events_url": "https://api.github.com/users/aDotInTheVoid/events{/privacy}", "received_events_url": "https://api.github.com/users/aDotInTheVoid/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b435960c4cfd3975651c7051be56d7f5d6c201ab", "url": "https://api.github.com/repos/rust-lang/rust/commits/b435960c4cfd3975651c7051be56d7f5d6c201ab", "html_url": "https://github.com/rust-lang/rust/commit/b435960c4cfd3975651c7051be56d7f5d6c201ab"}], "stats": {"total": 33, "additions": 28, "deletions": 5}, "files": [{"sha": "0483d50fc2a699fbc0ea42f7123c175dc079035c", "filename": "Cargo.lock", "status": "modified", "additions": 17, "deletions": 1, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/7680b164b00af55e7af64bdc8027b6deb4fb8233/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/7680b164b00af55e7af64bdc8027b6deb4fb8233/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=7680b164b00af55e7af64bdc8027b6deb4fb8233", "patch": "@@ -597,7 +597,7 @@ checksum = \"23b71c3ce99b7611011217b366d923f1d0a7e07a92bb2dbf1e84508c673ca3bd\"\n dependencies = [\n  \"atty\",\n  \"bitflags\",\n- \"clap_derive\",\n+ \"clap_derive 3.2.18\",\n  \"clap_lex 0.2.2\",\n  \"indexmap\",\n  \"once_cell\",\n@@ -614,7 +614,9 @@ checksum = \"6bf8832993da70a4c6d13c581f4463c2bdda27b9bf1c5498dc4365543abe6d6f\"\n dependencies = [\n  \"atty\",\n  \"bitflags\",\n+ \"clap_derive 4.0.13\",\n  \"clap_lex 0.3.0\",\n+ \"once_cell\",\n  \"strsim\",\n  \"termcolor\",\n ]\n@@ -641,6 +643,19 @@ dependencies = [\n  \"syn\",\n ]\n \n+[[package]]\n+name = \"clap_derive\"\n+version = \"4.0.13\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"c42f169caba89a7d512b5418b09864543eeb4d497416c917d7137863bd2076ad\"\n+dependencies = [\n+ \"heck\",\n+ \"proc-macro-error\",\n+ \"proc-macro2\",\n+ \"quote\",\n+ \"syn\",\n+]\n+\n [[package]]\n name = \"clap_lex\"\n version = \"0.2.2\"\n@@ -2097,6 +2112,7 @@ name = \"jsondoclint\"\n version = \"0.1.0\"\n dependencies = [\n  \"anyhow\",\n+ \"clap 4.0.15\",\n  \"fs-err\",\n  \"rustdoc-json-types\",\n  \"serde_json\","}, {"sha": "0dda3935ed87358ac7709d04f13fd459a0f469eb", "filename": "src/tools/jsondoclint/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7680b164b00af55e7af64bdc8027b6deb4fb8233/src%2Ftools%2Fjsondoclint%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/7680b164b00af55e7af64bdc8027b6deb4fb8233/src%2Ftools%2Fjsondoclint%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fjsondoclint%2FCargo.toml?ref=7680b164b00af55e7af64bdc8027b6deb4fb8233", "patch": "@@ -7,6 +7,7 @@ edition = \"2021\"\n \n [dependencies]\n anyhow = \"1.0.62\"\n+clap = { version = \"4.0.15\", features = [\"derive\"] }\n fs-err = \"2.8.1\"\n rustdoc-json-types = { version = \"0.1.0\", path = \"../../rustdoc-json-types\" }\n serde_json = \"1.0.85\""}, {"sha": "91a7aeb063f0976717ca2e22c699e7e3610f16d2", "filename": "src/tools/jsondoclint/src/main.rs", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/7680b164b00af55e7af64bdc8027b6deb4fb8233/src%2Ftools%2Fjsondoclint%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7680b164b00af55e7af64bdc8027b6deb4fb8233/src%2Ftools%2Fjsondoclint%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fjsondoclint%2Fsrc%2Fmain.rs?ref=7680b164b00af55e7af64bdc8027b6deb4fb8233", "patch": "@@ -1,6 +1,5 @@\n-use std::env;\n-\n-use anyhow::{anyhow, bail, Result};\n+use anyhow::{bail, Result};\n+use clap::Parser;\n use fs_err as fs;\n use rustdoc_json_types::{Crate, Id, FORMAT_VERSION};\n use serde_json::Value;\n@@ -21,8 +20,15 @@ enum ErrorKind {\n     Custom(String),\n }\n \n+#[derive(Parser)]\n+struct Cli {\n+    /// The path to the json file to be linted\n+    path: String,\n+}\n+\n fn main() -> Result<()> {\n-    let path = env::args().nth(1).ok_or_else(|| anyhow!(\"no path given\"))?;\n+    let Cli { path } = Cli::parse();\n+\n     let contents = fs::read_to_string(&path)?;\n     let krate: Crate = serde_json::from_str(&contents)?;\n     assert_eq!(krate.format_version, FORMAT_VERSION);"}]}