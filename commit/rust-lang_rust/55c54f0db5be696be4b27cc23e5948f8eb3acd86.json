{"sha": "55c54f0db5be696be4b27cc23e5948f8eb3acd86", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU1YzU0ZjBkYjViZTY5NmJlNGIyN2NjMjNlNTk0OGY4ZWIzYWNkODY=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-08-23T01:05:34Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-08-23T01:05:34Z"}, "message": "Promote std::task::rustrt::leak to std::unsafe::leak\n\nI want to use this for std::istr", "tree": {"sha": "3b50a11abbffab2e864e7ef417eb3cce86f10c28", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3b50a11abbffab2e864e7ef417eb3cce86f10c28"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/55c54f0db5be696be4b27cc23e5948f8eb3acd86", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/55c54f0db5be696be4b27cc23e5948f8eb3acd86", "html_url": "https://github.com/rust-lang/rust/commit/55c54f0db5be696be4b27cc23e5948f8eb3acd86", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/55c54f0db5be696be4b27cc23e5948f8eb3acd86/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d6e4fa6b449e7226438d4645fb4c21fa1dc46479", "url": "https://api.github.com/repos/rust-lang/rust/commits/d6e4fa6b449e7226438d4645fb4c21fa1dc46479", "html_url": "https://github.com/rust-lang/rust/commit/d6e4fa6b449e7226438d4645fb4c21fa1dc46479"}], "stats": {"total": 11, "additions": 8, "deletions": 3}, "files": [{"sha": "2e88f12f6c0fdbd0bd4256decb868cf98aecfb53", "filename": "src/lib/task.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/55c54f0db5be696be4b27cc23e5948f8eb3acd86/src%2Flib%2Ftask.rs", "raw_url": "https://github.com/rust-lang/rust/raw/55c54f0db5be696be4b27cc23e5948f8eb3acd86/src%2Flib%2Ftask.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib%2Ftask.rs?ref=55c54f0db5be696be4b27cc23e5948f8eb3acd86", "patch": "@@ -25,8 +25,6 @@ native \"rust\" mod rustrt {\n     fn get_task_trampoline() -> u32;\n \n     fn migrate_alloc(alloc: *u8, target: task_id);\n-\n-    fn leak<@T>(thing: -T);\n }\n \n type rust_task =\n@@ -149,7 +147,7 @@ fn spawn_inner(thunk: -fn(), notify: option<comm::chan<task_notification>>) ->\n     rustrt::migrate_alloc(cast(raw_thunk.env), id);\n     rustrt::start_task(id);\n \n-    rustrt::leak(thunk);\n+    unsafe::leak(thunk);\n \n     ret id;\n }"}, {"sha": "6e1b4b3b7c3bbc74a2a281b2d8d086e5fbb1030c", "filename": "src/lib/unsafe.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/55c54f0db5be696be4b27cc23e5948f8eb3acd86/src%2Flib%2Funsafe.rs", "raw_url": "https://github.com/rust-lang/rust/raw/55c54f0db5be696be4b27cc23e5948f8eb3acd86/src%2Flib%2Funsafe.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib%2Funsafe.rs?ref=55c54f0db5be696be4b27cc23e5948f8eb3acd86", "patch": "@@ -4,6 +4,13 @@ native \"rust-intrinsic\" mod rusti {\n     fn cast<T, U>(src: &T) -> U;\n }\n \n+native \"rust\" mod rustrt {\n+    fn leak<@T>(thing: -T);\n+}\n+\n // Casts the value at `src` to U. The two types must have the same length.\n fn reinterpret_cast<T, U>(src: &T) -> U { ret rusti::cast(src); }\n \n+fn leak<@T>(thing: -T) {\n+    rustrt::leak(thing);\n+}\n\\ No newline at end of file"}]}