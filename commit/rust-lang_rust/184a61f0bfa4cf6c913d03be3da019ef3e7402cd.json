{"sha": "184a61f0bfa4cf6c913d03be3da019ef3e7402cd", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE4NGE2MWYwYmZhNGNmNmM5MTNkMDNiZTNkYTAxOWVmM2U3NDAyY2Q=", "commit": {"author": {"name": "csmoe", "email": "csmoe@msn.com", "date": "2019-10-24T06:25:23Z"}, "committer": {"name": "csmoe", "email": "csmoe@msn.com", "date": "2019-10-24T17:15:37Z"}, "message": "Don't assert for different instance on impl trait alias", "tree": {"sha": "5c93234377b1f4b9dfe604aa2bbe3e74d3e3d96c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5c93234377b1f4b9dfe604aa2bbe3e74d3e3d96c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/184a61f0bfa4cf6c913d03be3da019ef3e7402cd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/184a61f0bfa4cf6c913d03be3da019ef3e7402cd", "html_url": "https://github.com/rust-lang/rust/commit/184a61f0bfa4cf6c913d03be3da019ef3e7402cd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/184a61f0bfa4cf6c913d03be3da019ef3e7402cd/comments", "author": {"login": "csmoe", "id": 35686186, "node_id": "MDQ6VXNlcjM1Njg2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/35686186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/csmoe", "html_url": "https://github.com/csmoe", "followers_url": "https://api.github.com/users/csmoe/followers", "following_url": "https://api.github.com/users/csmoe/following{/other_user}", "gists_url": "https://api.github.com/users/csmoe/gists{/gist_id}", "starred_url": "https://api.github.com/users/csmoe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/csmoe/subscriptions", "organizations_url": "https://api.github.com/users/csmoe/orgs", "repos_url": "https://api.github.com/users/csmoe/repos", "events_url": "https://api.github.com/users/csmoe/events{/privacy}", "received_events_url": "https://api.github.com/users/csmoe/received_events", "type": "User", "site_admin": false}, "committer": {"login": "csmoe", "id": 35686186, "node_id": "MDQ6VXNlcjM1Njg2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/35686186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/csmoe", "html_url": "https://github.com/csmoe", "followers_url": "https://api.github.com/users/csmoe/followers", "following_url": "https://api.github.com/users/csmoe/following{/other_user}", "gists_url": "https://api.github.com/users/csmoe/gists{/gist_id}", "starred_url": "https://api.github.com/users/csmoe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/csmoe/subscriptions", "organizations_url": "https://api.github.com/users/csmoe/orgs", "repos_url": "https://api.github.com/users/csmoe/repos", "events_url": "https://api.github.com/users/csmoe/events{/privacy}", "received_events_url": "https://api.github.com/users/csmoe/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4a8c5b20c7772bc5342b83d4b0696ea216ef75a7", "url": "https://api.github.com/repos/rust-lang/rust/commits/4a8c5b20c7772bc5342b83d4b0696ea216ef75a7", "html_url": "https://github.com/rust-lang/rust/commit/4a8c5b20c7772bc5342b83d4b0696ea216ef75a7"}], "stats": {"total": 20, "additions": 18, "deletions": 2}, "files": [{"sha": "790407aae9ff10b7ef6a8f0ee4f49d143deff5dd", "filename": "src/librustc_typeck/check/mod.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/184a61f0bfa4cf6c913d03be3da019ef3e7402cd/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/184a61f0bfa4cf6c913d03be3da019ef3e7402cd/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs?ref=184a61f0bfa4cf6c913d03be3da019ef3e7402cd", "patch": "@@ -2761,8 +2761,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n \n         let mut opaque_types = self.opaque_types.borrow_mut();\n         for (ty, decl) in opaque_type_map {\n-            let old_value = opaque_types.insert(ty, decl);\n-            assert!(old_value.is_none(), \"instantiated twice: {:?}/{:?}\", ty, decl);\n+            let _ = opaque_types.insert(ty, decl);\n         }\n \n         value"}, {"sha": "12eb75ae4c019d4b07987ef38c35109e8696d7fc", "filename": "src/test/ui/type-alias-impl-trait/issue-65679-inst-opaque-ty-from-val-twice.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/184a61f0bfa4cf6c913d03be3da019ef3e7402cd/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-65679-inst-opaque-ty-from-val-twice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/184a61f0bfa4cf6c913d03be3da019ef3e7402cd/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-65679-inst-opaque-ty-from-val-twice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-65679-inst-opaque-ty-from-val-twice.rs?ref=184a61f0bfa4cf6c913d03be3da019ef3e7402cd", "patch": "@@ -0,0 +1,17 @@\n+// check-pass\n+\n+#![feature(type_alias_impl_trait)]\n+\n+type T = impl Sized;\n+// The concrete type referred by impl-trait-type-alias(`T`) is guaranteed\n+// to be the same as where it occurs, whereas `impl Trait`'s instance is location sensitive;\n+// so difference assertion should not be declared on impl-trait-type-alias's instances.\n+// for details, check RFC-2515:\n+// https://github.com/rust-lang/rfcs/blob/master/text/2515-type_alias_impl_trait.md\n+\n+fn take(_: fn() -> T) {}\n+\n+fn main() {\n+    take(|| {});\n+    take(|| {});\n+}"}]}