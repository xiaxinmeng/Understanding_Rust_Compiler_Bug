{"sha": "ee584c19c776cbc89c93bb226d1501c61d20c8eb", "node_id": "C_kwDOAAsO6NoAKGVlNTg0YzE5Yzc3NmNiYzg5YzkzYmIyMjZkMTUwMWM2MWQyMGM4ZWI", "commit": {"author": {"name": "Amos Wenger", "email": "amoswenger@gmail.com", "date": "2022-07-24T14:48:06Z"}, "committer": {"name": "Amos Wenger", "email": "amoswenger@gmail.com", "date": "2022-07-24T14:48:06Z"}, "message": "Make macros test order-resistant", "tree": {"sha": "1e05fb197915f59356eee455e2167d5a64575d84", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1e05fb197915f59356eee455e2167d5a64575d84"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ee584c19c776cbc89c93bb226d1501c61d20c8eb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ee584c19c776cbc89c93bb226d1501c61d20c8eb", "html_url": "https://github.com/rust-lang/rust/commit/ee584c19c776cbc89c93bb226d1501c61d20c8eb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ee584c19c776cbc89c93bb226d1501c61d20c8eb/comments", "author": {"login": "fasterthanlime", "id": 7998310, "node_id": "MDQ6VXNlcjc5OTgzMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/7998310?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fasterthanlime", "html_url": "https://github.com/fasterthanlime", "followers_url": "https://api.github.com/users/fasterthanlime/followers", "following_url": "https://api.github.com/users/fasterthanlime/following{/other_user}", "gists_url": "https://api.github.com/users/fasterthanlime/gists{/gist_id}", "starred_url": "https://api.github.com/users/fasterthanlime/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fasterthanlime/subscriptions", "organizations_url": "https://api.github.com/users/fasterthanlime/orgs", "repos_url": "https://api.github.com/users/fasterthanlime/repos", "events_url": "https://api.github.com/users/fasterthanlime/events{/privacy}", "received_events_url": "https://api.github.com/users/fasterthanlime/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fasterthanlime", "id": 7998310, "node_id": "MDQ6VXNlcjc5OTgzMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/7998310?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fasterthanlime", "html_url": "https://github.com/fasterthanlime", "followers_url": "https://api.github.com/users/fasterthanlime/followers", "following_url": "https://api.github.com/users/fasterthanlime/following{/other_user}", "gists_url": "https://api.github.com/users/fasterthanlime/gists{/gist_id}", "starred_url": "https://api.github.com/users/fasterthanlime/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fasterthanlime/subscriptions", "organizations_url": "https://api.github.com/users/fasterthanlime/orgs", "repos_url": "https://api.github.com/users/fasterthanlime/repos", "events_url": "https://api.github.com/users/fasterthanlime/events{/privacy}", "received_events_url": "https://api.github.com/users/fasterthanlime/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6c07c7182184a443179f3b2baea0b5e042821583", "url": "https://api.github.com/repos/rust-lang/rust/commits/6c07c7182184a443179f3b2baea0b5e042821583", "html_url": "https://github.com/rust-lang/rust/commit/6c07c7182184a443179f3b2baea0b5e042821583"}], "stats": {"total": 9, "additions": 7, "deletions": 2}, "files": [{"sha": "3ece1379ad774b495c0b8e2d568cdc8efa8bf23b", "filename": "src/tools/rust-analyzer/crates/hir-def/src/nameres/tests/macros.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/ee584c19c776cbc89c93bb226d1501c61d20c8eb/src%2Ftools%2Frust-analyzer%2Fcrates%2Fhir-def%2Fsrc%2Fnameres%2Ftests%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ee584c19c776cbc89c93bb226d1501c61d20c8eb/src%2Ftools%2Frust-analyzer%2Fcrates%2Fhir-def%2Fsrc%2Fnameres%2Ftests%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frust-analyzer%2Fcrates%2Fhir-def%2Fsrc%2Fnameres%2Ftests%2Fmacros.rs?ref=ee584c19c776cbc89c93bb226d1501c61d20c8eb", "patch": "@@ -1,4 +1,5 @@\n use super::*;\n+use itertools::Itertools;\n \n #[test]\n fn macro_rules_are_globally_visible() {\n@@ -1171,11 +1172,15 @@ fn proc_attr(a: TokenStream, b: TokenStream) -> TokenStream { a }\n     );\n \n     let root = &def_map[def_map.root()].scope;\n-    let actual = root.legacy_macros().map(|(name, _)| format!(\"{name}\\n\")).collect::<String>();\n+    let actual = root\n+        .legacy_macros()\n+        .sorted_by(|a, b| std::cmp::Ord::cmp(&a.0, &b.0))\n+        .map(|(name, _)| format!(\"{name}\\n\"))\n+        .collect::<String>();\n \n     expect![[r#\"\n-        macro20\n         legacy\n+        macro20\n         proc_attr\n     \"#]]\n     .assert_eq(&actual);"}]}