{"sha": "543e601a9d5e0efbb3fff803a0427efcceb0fef1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU0M2U2MDFhOWQ1ZTBlZmJiM2ZmZjgwM2EwNDI3ZWZjY2ViMGZlZjE=", "commit": {"author": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2021-09-07T06:30:04Z"}, "committer": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2021-09-07T06:30:04Z"}, "message": "fix(clippy): update loop lints to use arg.span\n\nAdapts clippy for fe1a7f71fbf3cf845a09a9b333a6adcf7e839607", "tree": {"sha": "450aa5319c5ab2fbbc027e22e740f039c0f72ad0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/450aa5319c5ab2fbbc027e22e740f039c0f72ad0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/543e601a9d5e0efbb3fff803a0427efcceb0fef1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/543e601a9d5e0efbb3fff803a0427efcceb0fef1", "html_url": "https://github.com/rust-lang/rust/commit/543e601a9d5e0efbb3fff803a0427efcceb0fef1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/543e601a9d5e0efbb3fff803a0427efcceb0fef1/comments", "author": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "committer": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fe1a7f71fbf3cf845a09a9b333a6adcf7e839607", "url": "https://api.github.com/repos/rust-lang/rust/commits/fe1a7f71fbf3cf845a09a9b333a6adcf7e839607", "html_url": "https://github.com/rust-lang/rust/commit/fe1a7f71fbf3cf845a09a9b333a6adcf7e839607"}], "stats": {"total": 19, "additions": 9, "deletions": 10}, "files": [{"sha": "e2f2e770fc2585b681f25865acc1656c37f31966", "filename": "src/tools/clippy/clippy_lints/src/loops/for_kv_map.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/543e601a9d5e0efbb3fff803a0427efcceb0fef1/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Ffor_kv_map.rs", "raw_url": "https://github.com/rust-lang/rust/raw/543e601a9d5e0efbb3fff803a0427efcceb0fef1/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Ffor_kv_map.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Ffor_kv_map.rs?ref=543e601a9d5e0efbb3fff803a0427efcceb0fef1", "patch": "@@ -15,7 +15,6 @@ pub(super) fn check<'tcx>(\n     pat: &'tcx Pat<'_>,\n     arg: &'tcx Expr<'_>,\n     body: &'tcx Expr<'_>,\n-    expr: &'tcx Expr<'_>,\n ) {\n     let pat_span = pat.span;\n \n@@ -43,7 +42,7 @@ pub(super) fn check<'tcx>(\n                 span_lint_and_then(\n                     cx,\n                     FOR_KV_MAP,\n-                    expr.span,\n+                    arg_span,\n                     &format!(\"you seem to want to iterate on a map's {}s\", kind),\n                     |diag| {\n                         let map = sugg::Sugg::hir(cx, arg, \"map\");"}, {"sha": "e640c62ebdaceabc102d798869f804e7a1d203b0", "filename": "src/tools/clippy/clippy_lints/src/loops/iter_next_loop.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/543e601a9d5e0efbb3fff803a0427efcceb0fef1/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Fiter_next_loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/543e601a9d5e0efbb3fff803a0427efcceb0fef1/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Fiter_next_loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Fiter_next_loop.rs?ref=543e601a9d5e0efbb3fff803a0427efcceb0fef1", "patch": "@@ -5,12 +5,12 @@ use rustc_hir::Expr;\n use rustc_lint::LateContext;\n use rustc_span::sym;\n \n-pub(super) fn check(cx: &LateContext<'_>, arg: &Expr<'_>, expr: &Expr<'_>) -> bool {\n+pub(super) fn check(cx: &LateContext<'_>, arg: &Expr<'_>) -> bool {\n     if is_trait_method(cx, arg, sym::Iterator) {\n         span_lint(\n             cx,\n             ITER_NEXT_LOOP,\n-            expr.span,\n+            arg.span,\n             \"you are iterating over `Iterator::next()` which is an Option; this will compile but is \\\n             probably not what you want\",\n         );"}, {"sha": "86bce75bdb2dd115101e5cb24494fb10d5234644", "filename": "src/tools/clippy/clippy_lints/src/loops/mod.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/543e601a9d5e0efbb3fff803a0427efcceb0fef1/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/543e601a9d5e0efbb3fff803a0427efcceb0fef1/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Fmod.rs?ref=543e601a9d5e0efbb3fff803a0427efcceb0fef1", "patch": "@@ -601,15 +601,15 @@ fn check_for_loop<'tcx>(\n         needless_range_loop::check(cx, pat, arg, body, expr);\n         explicit_counter_loop::check(cx, pat, arg, body, expr);\n     }\n-    check_for_loop_arg(cx, pat, arg, expr);\n-    for_kv_map::check(cx, pat, arg, body, expr);\n+    check_for_loop_arg(cx, pat, arg);\n+    for_kv_map::check(cx, pat, arg, body);\n     mut_range_bound::check(cx, arg, body);\n     single_element_loop::check(cx, pat, arg, body, expr);\n     same_item_push::check(cx, pat, arg, body, expr);\n     manual_flatten::check(cx, pat, arg, body, span);\n }\n \n-fn check_for_loop_arg(cx: &LateContext<'_>, pat: &Pat<'_>, arg: &Expr<'_>, expr: &Expr<'_>) {\n+fn check_for_loop_arg(cx: &LateContext<'_>, pat: &Pat<'_>, arg: &Expr<'_>) {\n     let mut next_loop_linted = false; // whether or not ITER_NEXT_LOOP lint was used\n \n     if let ExprKind::MethodCall(method, _, [self_arg], _) = arg.kind {\n@@ -622,7 +622,7 @@ fn check_for_loop_arg(cx: &LateContext<'_>, pat: &Pat<'_>, arg: &Expr<'_>, expr:\n                 explicit_into_iter_loop::check(cx, self_arg, arg);\n             },\n             \"next\" => {\n-                next_loop_linted = iter_next_loop::check(cx, arg, expr);\n+                next_loop_linted = iter_next_loop::check(cx, arg);\n             },\n             _ => {},\n         }"}, {"sha": "bdb042421e9c51ad8e3aff2602e320b8794f6c20", "filename": "src/tools/clippy/clippy_lints/src/loops/needless_range_loop.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/543e601a9d5e0efbb3fff803a0427efcceb0fef1/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Fneedless_range_loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/543e601a9d5e0efbb3fff803a0427efcceb0fef1/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Fneedless_range_loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Fneedless_range_loop.rs?ref=543e601a9d5e0efbb3fff803a0427efcceb0fef1", "patch": "@@ -146,7 +146,7 @@ pub(super) fn check<'tcx>(\n                     span_lint_and_then(\n                         cx,\n                         NEEDLESS_RANGE_LOOP,\n-                        expr.span,\n+                        arg.span,\n                         &format!(\"the loop variable `{}` is used to index `{}`\", ident.name, indexed),\n                         |diag| {\n                             multispan_sugg(\n@@ -172,7 +172,7 @@ pub(super) fn check<'tcx>(\n                     span_lint_and_then(\n                         cx,\n                         NEEDLESS_RANGE_LOOP,\n-                        expr.span,\n+                        arg.span,\n                         &format!(\"the loop variable `{}` is only used to index `{}`\", ident.name, indexed),\n                         |diag| {\n                             multispan_sugg("}]}