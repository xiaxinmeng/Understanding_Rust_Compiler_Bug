{"sha": "05b7eb6dff850ef9265f09ed18baf7f09590bf72", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA1YjdlYjZkZmY4NTBlZjkyNjVmMDllZDE4YmFmN2YwOTU5MGJmNzI=", "commit": {"author": {"name": "Tim Chevalier", "email": "chevalier@alum.wellesley.edu", "date": "2011-06-14T22:08:46Z"}, "committer": {"name": "Tim Chevalier", "email": "chevalier@alum.wellesley.edu", "date": "2011-06-14T22:11:48Z"}, "message": "Make the typechecker check that dynamically sized arguments are passed by alias\n\nBefore, this would cause an assertion failure in trans.", "tree": {"sha": "1eda89adfb3cfe5a556fb81b7f758c138ecc926f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1eda89adfb3cfe5a556fb81b7f758c138ecc926f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/05b7eb6dff850ef9265f09ed18baf7f09590bf72", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/05b7eb6dff850ef9265f09ed18baf7f09590bf72", "html_url": "https://github.com/rust-lang/rust/commit/05b7eb6dff850ef9265f09ed18baf7f09590bf72", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/05b7eb6dff850ef9265f09ed18baf7f09590bf72/comments", "author": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "committer": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c3015b895254e059b163479849dfb1353929206f", "url": "https://api.github.com/repos/rust-lang/rust/commits/c3015b895254e059b163479849dfb1353929206f", "html_url": "https://github.com/rust-lang/rust/commit/c3015b895254e059b163479849dfb1353929206f"}], "stats": {"total": 12, "additions": 11, "deletions": 1}, "files": [{"sha": "6a7d305fa23725a782b8ff59dfeb5abc7a4bd41a", "filename": "src/comp/middle/typeck.rs", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/05b7eb6dff850ef9265f09ed18baf7f09590bf72/src%2Fcomp%2Fmiddle%2Ftypeck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/05b7eb6dff850ef9265f09ed18baf7f09590bf72/src%2Fcomp%2Fmiddle%2Ftypeck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Ftypeck.rs?ref=05b7eb6dff850ef9265f09ed18baf7f09590bf72", "patch": "@@ -527,7 +527,17 @@ mod collect {\n     fn ty_of_arg(@ctxt cx, &ast::arg a) -> ty::arg {\n         auto ty_mode = ast_mode_to_mode(a.mode);\n         auto f = bind getter(cx, _);\n-        ret rec(mode=ty_mode, ty=ast_ty_to_ty(cx.tcx, f, a.ty));\n+        auto tt = ast_ty_to_ty(cx.tcx, f, a.ty);\n+        if (ty::type_has_dynamic_size(cx.tcx, tt)) {\n+            alt (ty_mode) {\n+                case (mo_val) {\n+                    cx.tcx.sess.span_err(a.ty.span,\n+                      \"Dynamically sized arguments must be passed by alias\");\n+                }\n+                case (_) { }\n+            }\n+        }\n+        ret rec(mode=ty_mode, ty=tt);\n     }\n \n     fn ty_of_method(@ctxt cx, &@ast::method m) -> ty::method {"}]}