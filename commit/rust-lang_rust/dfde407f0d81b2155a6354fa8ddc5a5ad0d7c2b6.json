{"sha": "dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRmZGU0MDdmMGQ4MWIyMTU1YTYzNTRmYThkZGM1YTVhZDBkN2MyYjY=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2018-04-12T20:16:43Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2018-04-12T20:16:43Z"}, "message": "Move unnecessary_fold UI tests to separate file", "tree": {"sha": "3993710bd4d62c6d91ba22d362ec54c84b635360", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3993710bd4d62c6d91ba22d362ec54c84b635360"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIcBAABCAAGBQJaz77EAAoJELb6Bqbg4mZbDw4P/0Z1lwIb4IxrIWLyjzis/429\nA1LBYD3T1xZ1ewgrmkdm0+w3FEJ1hbTZkYvsu+hfc03e7ghAoLOPvd7s1FHOt3Tc\n/uMuq3rlcxWYB9n4rKmzUATkbnoQsgLHroUdUnrb10LwtYkjr1Ponhi4gJLvlT3o\n+Bd6kX8uMg77Lx8pZwSpFtTt8M9h3NGUkTXBRUFUYRtIiBSGO+6Zf9f1wDN5mqpu\nvYjUXiZX837EMFEMk0Ixkej4pMMF69ZKZGbi3+K7L2xmyMb4tkqm5CFlCiC3A1TC\ngAjS4PWNpRWPg8/0pkuJqw8yhSTPgUEV+dv3d5oo9OzkmhEx2yQD1g7hjI1gskIt\n1i81hjSyw21yUMAdvim88CgdKRI3KcGPL3y3gsOSN0dIgX+i68oVl/ffVGBxCoRk\nCqThSe38O8KRR0T6dJxUU5sa26xx9NVBUEwkYuSH3XBS2sLoWrRTHP3nJGlXzw7/\niV94KPd/dom+HlcU39VDWukjf0wq0gfcbQgJ0fFDxKlcW0XomRxfS74eDwykl8VY\nL7JwyP7qjA9Z0dDX1irZe/ePYn0Nqk936qh7wskdZiqgG5oLFSI6+drO2GrEsroe\nXY5DjD28GfQbxbYY2CtuiDBMZyoJ3Ng17gOzETN8xSOZbuClvFOGQdOZm8WUzKw1\nelMsFdD5JXRzppBEaaQ4\n=efv3\n-----END PGP SIGNATURE-----", "payload": "tree 3993710bd4d62c6d91ba22d362ec54c84b635360\nparent 8ec61a613ad1278b18a4770332b6da128704fdd6\nauthor Philipp Hansch <dev@phansch.net> 1523564203 +0200\ncommitter Philipp Hansch <dev@phansch.net> 1523564203 +0200\n\nMove unnecessary_fold UI tests to separate file\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6", "html_url": "https://github.com/rust-lang/rust/commit/dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8ec61a613ad1278b18a4770332b6da128704fdd6", "url": "https://api.github.com/repos/rust-lang/rust/commits/8ec61a613ad1278b18a4770332b6da128704fdd6", "html_url": "https://github.com/rust-lang/rust/commit/8ec61a613ad1278b18a4770332b6da128704fdd6"}], "stats": {"total": 151, "additions": 77, "deletions": 74}, "files": [{"sha": "9e25365583331212c8bfd38b436c3005856399a9", "filename": "tests/ui/methods.rs", "status": "modified", "additions": 0, "deletions": 39, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6/tests%2Fui%2Fmethods.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6/tests%2Fui%2Fmethods.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmethods.rs?ref=dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6", "patch": "@@ -385,45 +385,6 @@ fn iter_skip_next() {\n     let _ = foo.filter().skip(42).next();\n }\n \n-/// Calls which should trigger the `UNNECESSARY_FOLD` lint\n-fn unnecessary_fold() {\n-    // Can be replaced by .any\n-    let _ = (0..3).fold(false, |acc, x| acc || x > 2);\n-    // Can be replaced by .all\n-    let _ = (0..3).fold(true, |acc, x| acc && x > 2);\n-    // Can be replaced by .sum\n-    let _ = (0..3).fold(0, |acc, x| acc + x);\n-    // Can be replaced by .product\n-    let _ = (0..3).fold(1, |acc, x| acc * x);\n-}\n-\n-/// Should trigger the `UNNECESSARY_FOLD` lint, with an error span including exactly `.fold(...)`\n-fn unnecessary_fold_span_for_multi_element_chain() {\n-    let _ = (0..3).map(|x| 2 * x).fold(false, |acc, x| acc || x > 2);\n-}\n-\n-/// Calls which should not trigger the `UNNECESSARY_FOLD` lint\n-fn unnecessary_fold_should_ignore() {\n-    let _ = (0..3).fold(true, |acc, x| acc || x > 2);\n-    let _ = (0..3).fold(false, |acc, x| acc && x > 2);\n-    let _ = (0..3).fold(1, |acc, x| acc + x);\n-    let _ = (0..3).fold(0, |acc, x| acc * x);\n-    let _ = (0..3).fold(0, |acc, x| 1 + acc + x);\n-\n-    // We only match against an accumulator on the left\n-    // hand side. We could lint for .sum and .product when\n-    // it's on the right, but don't for now (and this wouldn't\n-    // be valid if we extended the lint to cover arbitrary numeric\n-    // types).\n-    let _ = (0..3).fold(false, |acc, x| x > 2 || acc);\n-    let _ = (0..3).fold(true, |acc, x| x > 2 && acc);\n-    let _ = (0..3).fold(0, |acc, x| x + acc);\n-    let _ = (0..3).fold(1, |acc, x| x * acc);\n-\n-    let _ = [(0..2), (0..3)].iter().fold(0, |a, b| a + b.len());\n-    let _ = [(0..2), (0..3)].iter().fold(1, |a, b| a * b.len());\n-}\n-\n #[allow(similar_names)]\n fn main() {\n     let opt = Some(0);"}, {"sha": "1dd1ddc3caadb82ae7ef4128183000445575bd79", "filename": "tests/ui/methods.stderr", "status": "modified", "additions": 3, "deletions": 35, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6/tests%2Fui%2Fmethods.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6/tests%2Fui%2Fmethods.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmethods.stderr?ref=dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6", "patch": "@@ -493,45 +493,13 @@ error: called `skip(x).next()` on an iterator. This is more succinctly expressed\n 382 |     let _ = &some_vec[..].iter().skip(3).next();\n     |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: this `.fold` can be written more succinctly using another method\n-   --> $DIR/methods.rs:391:19\n-    |\n-391 |     let _ = (0..3).fold(false, |acc, x| acc || x > 2);\n-    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `.any(|x| x > 2)`\n-    |\n-    = note: `-D unnecessary-fold` implied by `-D warnings`\n-\n-error: this `.fold` can be written more succinctly using another method\n-   --> $DIR/methods.rs:393:19\n-    |\n-393 |     let _ = (0..3).fold(true, |acc, x| acc && x > 2);\n-    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `.all(|x| x > 2)`\n-\n-error: this `.fold` can be written more succinctly using another method\n-   --> $DIR/methods.rs:395:19\n-    |\n-395 |     let _ = (0..3).fold(0, |acc, x| acc + x);\n-    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `.sum()`\n-\n-error: this `.fold` can be written more succinctly using another method\n-   --> $DIR/methods.rs:397:19\n-    |\n-397 |     let _ = (0..3).fold(1, |acc, x| acc * x);\n-    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `.product()`\n-\n-error: this `.fold` can be written more succinctly using another method\n-   --> $DIR/methods.rs:402:34\n-    |\n-402 |     let _ = (0..3).map(|x| 2 * x).fold(false, |acc, x| acc || x > 2);\n-    |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `.any(|x| x > 2)`\n-\n error: used unwrap() on an Option value. If you don't want to handle the None case gracefully, consider using expect() to provide a better panic message\n-   --> $DIR/methods.rs:430:13\n+   --> $DIR/methods.rs:391:13\n     |\n-430 |     let _ = opt.unwrap();\n+391 |     let _ = opt.unwrap();\n     |             ^^^^^^^^^^^^\n     |\n     = note: `-D option-unwrap-used` implied by `-D warnings`\n \n-error: aborting due to 71 previous errors\n+error: aborting due to 66 previous errors\n "}, {"sha": "62198e21ef7ce7ca4fb5449cd108472aef35b948", "filename": "tests/ui/unnecessary_fold.rs", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6/tests%2Fui%2Funnecessary_fold.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6/tests%2Fui%2Funnecessary_fold.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Funnecessary_fold.rs?ref=dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6", "patch": "@@ -0,0 +1,40 @@\n+/// Calls which should trigger the `UNNECESSARY_FOLD` lint\n+fn unnecessary_fold() {\n+    // Can be replaced by .any\n+    let _ = (0..3).fold(false, |acc, x| acc || x > 2);\n+    // Can be replaced by .all\n+    let _ = (0..3).fold(true, |acc, x| acc && x > 2);\n+    // Can be replaced by .sum\n+    let _ = (0..3).fold(0, |acc, x| acc + x);\n+    // Can be replaced by .product\n+    let _ = (0..3).fold(1, |acc, x| acc * x);\n+}\n+\n+/// Should trigger the `UNNECESSARY_FOLD` lint, with an error span including exactly `.fold(...)`\n+fn unnecessary_fold_span_for_multi_element_chain() {\n+    let _ = (0..3).map(|x| 2 * x).fold(false, |acc, x| acc || x > 2);\n+}\n+\n+/// Calls which should not trigger the `UNNECESSARY_FOLD` lint\n+fn unnecessary_fold_should_ignore() {\n+    let _ = (0..3).fold(true, |acc, x| acc || x > 2);\n+    let _ = (0..3).fold(false, |acc, x| acc && x > 2);\n+    let _ = (0..3).fold(1, |acc, x| acc + x);\n+    let _ = (0..3).fold(0, |acc, x| acc * x);\n+    let _ = (0..3).fold(0, |acc, x| 1 + acc + x);\n+\n+    // We only match against an accumulator on the left\n+    // hand side. We could lint for .sum and .product when\n+    // it's on the right, but don't for now (and this wouldn't\n+    // be valid if we extended the lint to cover arbitrary numeric\n+    // types).\n+    let _ = (0..3).fold(false, |acc, x| x > 2 || acc);\n+    let _ = (0..3).fold(true, |acc, x| x > 2 && acc);\n+    let _ = (0..3).fold(0, |acc, x| x + acc);\n+    let _ = (0..3).fold(1, |acc, x| x * acc);\n+\n+    let _ = [(0..2), (0..3)].iter().fold(0, |a, b| a + b.len());\n+    let _ = [(0..2), (0..3)].iter().fold(1, |a, b| a * b.len());\n+}\n+\n+fn main() {}"}, {"sha": "8bc4b8244bd55b28ee29cf5e5b6b3468149f7684", "filename": "tests/ui/unnecessary_fold.stderr", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6/tests%2Fui%2Funnecessary_fold.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6/tests%2Fui%2Funnecessary_fold.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Funnecessary_fold.stderr?ref=dfde407f0d81b2155a6354fa8ddc5a5ad0d7c2b6", "patch": "@@ -0,0 +1,34 @@\n+error: this `.fold` can be written more succinctly using another method\n+ --> $DIR/unnecessary_fold.rs:4:19\n+  |\n+4 |     let _ = (0..3).fold(false, |acc, x| acc || x > 2);\n+  |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `.any(|x| x > 2)`\n+  |\n+  = note: `-D unnecessary-fold` implied by `-D warnings`\n+\n+error: this `.fold` can be written more succinctly using another method\n+ --> $DIR/unnecessary_fold.rs:6:19\n+  |\n+6 |     let _ = (0..3).fold(true, |acc, x| acc && x > 2);\n+  |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `.all(|x| x > 2)`\n+\n+error: this `.fold` can be written more succinctly using another method\n+ --> $DIR/unnecessary_fold.rs:8:19\n+  |\n+8 |     let _ = (0..3).fold(0, |acc, x| acc + x);\n+  |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `.sum()`\n+\n+error: this `.fold` can be written more succinctly using another method\n+  --> $DIR/unnecessary_fold.rs:10:19\n+   |\n+10 |     let _ = (0..3).fold(1, |acc, x| acc * x);\n+   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `.product()`\n+\n+error: this `.fold` can be written more succinctly using another method\n+  --> $DIR/unnecessary_fold.rs:15:34\n+   |\n+15 |     let _ = (0..3).map(|x| 2 * x).fold(false, |acc, x| acc || x > 2);\n+   |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `.any(|x| x > 2)`\n+\n+error: aborting due to 5 previous errors\n+"}]}