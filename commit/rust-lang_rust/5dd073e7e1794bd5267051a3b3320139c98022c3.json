{"sha": "5dd073e7e1794bd5267051a3b3320139c98022c3", "node_id": "C_kwDOAAsO6NoAKDVkZDA3M2U3ZTE3OTRiZDUyNjcwNTFhM2IzMzIwMTM5Yzk4MDIyYzM", "commit": {"author": {"name": "Florian Bartels", "email": "Florian.Bartels@elektrobit.com", "date": "2022-11-17T08:24:19Z"}, "committer": {"name": "Florian Bartels", "email": "Florian.Bartels@elektrobit.com", "date": "2022-11-17T09:41:41Z"}, "message": "Encourage developers not to use periods in target names\n\nThey can cause issues in e.g. cargo.", "tree": {"sha": "2f6799f2dd1d683aaa67c4fe114f190b025aadaa", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2f6799f2dd1d683aaa67c4fe114f190b025aadaa"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5dd073e7e1794bd5267051a3b3320139c98022c3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5dd073e7e1794bd5267051a3b3320139c98022c3", "html_url": "https://github.com/rust-lang/rust/commit/5dd073e7e1794bd5267051a3b3320139c98022c3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5dd073e7e1794bd5267051a3b3320139c98022c3/comments", "author": {"login": "flba-eb", "id": 108917393, "node_id": "U_kgDOBn3ykQ", "avatar_url": "https://avatars.githubusercontent.com/u/108917393?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flba-eb", "html_url": "https://github.com/flba-eb", "followers_url": "https://api.github.com/users/flba-eb/followers", "following_url": "https://api.github.com/users/flba-eb/following{/other_user}", "gists_url": "https://api.github.com/users/flba-eb/gists{/gist_id}", "starred_url": "https://api.github.com/users/flba-eb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flba-eb/subscriptions", "organizations_url": "https://api.github.com/users/flba-eb/orgs", "repos_url": "https://api.github.com/users/flba-eb/repos", "events_url": "https://api.github.com/users/flba-eb/events{/privacy}", "received_events_url": "https://api.github.com/users/flba-eb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flba-eb", "id": 108917393, "node_id": "U_kgDOBn3ykQ", "avatar_url": "https://avatars.githubusercontent.com/u/108917393?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flba-eb", "html_url": "https://github.com/flba-eb", "followers_url": "https://api.github.com/users/flba-eb/followers", "following_url": "https://api.github.com/users/flba-eb/following{/other_user}", "gists_url": "https://api.github.com/users/flba-eb/gists{/gist_id}", "starred_url": "https://api.github.com/users/flba-eb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flba-eb/subscriptions", "organizations_url": "https://api.github.com/users/flba-eb/orgs", "repos_url": "https://api.github.com/users/flba-eb/repos", "events_url": "https://api.github.com/users/flba-eb/events{/privacy}", "received_events_url": "https://api.github.com/users/flba-eb/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9340e5c1b9dee53fd32a18f7bfb54faabfe00b7b", "url": "https://api.github.com/repos/rust-lang/rust/commits/9340e5c1b9dee53fd32a18f7bfb54faabfe00b7b", "html_url": "https://github.com/rust-lang/rust/commit/9340e5c1b9dee53fd32a18f7bfb54faabfe00b7b"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "95932db14e1f659ca86fd8dcbe5f02ad04940d24", "filename": "src/doc/rustc/src/target-tier-policy.md", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5dd073e7e1794bd5267051a3b3320139c98022c3/src%2Fdoc%2Frustc%2Fsrc%2Ftarget-tier-policy.md", "raw_url": "https://github.com/rust-lang/rust/raw/5dd073e7e1794bd5267051a3b3320139c98022c3/src%2Fdoc%2Frustc%2Fsrc%2Ftarget-tier-policy.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Ftarget-tier-policy.md?ref=5dd073e7e1794bd5267051a3b3320139c98022c3", "patch": "@@ -158,6 +158,8 @@ approved by the appropriate team for that shared code before acceptance.\n     the name of the target makes people extremely likely to form incorrect\n     beliefs about what it targets, the name should be changed or augmented to\n     disambiguate it.\n+  - If possible, use only letters, numbers, dashes and underscores for the name.\n+    Periods (`.`) are known to cause issues in Cargo.\n - Tier 3 targets may have unusual requirements to build or use, but must not\n   create legal issues or impose onerous legal terms for the Rust project or for\n   Rust developers or users."}, {"sha": "c74d37c61e887bc3f30113490995c50c6bcb3700", "filename": "src/tools/tier-check/src/main.rs", "status": "modified", "additions": 17, "deletions": 1, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/5dd073e7e1794bd5267051a3b3320139c98022c3/src%2Ftools%2Ftier-check%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5dd073e7e1794bd5267051a3b3320139c98022c3/src%2Ftools%2Ftier-check%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Ftier-check%2Fsrc%2Fmain.rs?ref=5dd073e7e1794bd5267051a3b3320139c98022c3", "patch": "@@ -44,7 +44,23 @@ fn main() {\n             target, filename, src\n         );\n     }\n-    if !missing.is_empty() || !extra.is_empty() {\n+    // Check target names for unwanted characters like `.` that can cause problems e.g. in Cargo.\n+    // See also Tier 3 target policy.\n+    // If desired, target names can ignore this check.\n+    let ignore_target_names =\n+        vec![\"thumbv8m.base-none-eabi\", \"thumbv8m.main-none-eabi\", \"thumbv8m.main-none-eabihf\"];\n+    let mut invalid_target_name_found = false;\n+    for target in &target_list {\n+        if !ignore_target_names.contains(target)\n+            && !target.chars().all(|c| c.is_ascii_alphanumeric() || c == '-' || c == '_')\n+        {\n+            invalid_target_name_found = true;\n+            eprintln!(\n+                \"error: Target name `{target}` contains other characters than ASCII alphanumeric (a-z, A-Z, 0-9), dash (-) or underscore (_).\"\n+            );\n+        }\n+    }\n+    if !missing.is_empty() || !extra.is_empty() || invalid_target_name_found {\n         std::process::exit(1);\n     }\n }"}]}