{"sha": "4504e23a82a2c4e1d0ef6325541036eb0d5b66f0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ1MDRlMjNhODJhMmM0ZTFkMGVmNjMyNTU0MTAzNmViMGQ1YjY2ZjA=", "commit": {"author": {"name": "Brian Anderson", "email": "andersrb@gmail.com", "date": "2011-05-21T22:00:44Z"}, "committer": {"name": "Brian Anderson", "email": "andersrb@gmail.com", "date": "2011-05-21T22:18:48Z"}, "message": "rustc: Remove unnecessary pushdown from check_expr in the expr_if case", "tree": {"sha": "4f3b6a4fef49e15464e6b2aa0e11b1c4105c0153", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4f3b6a4fef49e15464e6b2aa0e11b1c4105c0153"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4504e23a82a2c4e1d0ef6325541036eb0d5b66f0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4504e23a82a2c4e1d0ef6325541036eb0d5b66f0", "html_url": "https://github.com/rust-lang/rust/commit/4504e23a82a2c4e1d0ef6325541036eb0d5b66f0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4504e23a82a2c4e1d0ef6325541036eb0d5b66f0/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4bcdf57d780ee7a2c07c6ad5094b3afacff5bae8", "url": "https://api.github.com/repos/rust-lang/rust/commits/4bcdf57d780ee7a2c07c6ad5094b3afacff5bae8", "html_url": "https://github.com/rust-lang/rust/commit/4bcdf57d780ee7a2c07c6ad5094b3afacff5bae8"}], "stats": {"total": 19, "additions": 7, "deletions": 12}, "files": [{"sha": "8da317dc8ba051c2337725becf46d5fb713eb4a7", "filename": "src/comp/middle/typeck.rs", "status": "modified", "additions": 7, "deletions": 12, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/4504e23a82a2c4e1d0ef6325541036eb0d5b66f0/src%2Fcomp%2Fmiddle%2Ftypeck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4504e23a82a2c4e1d0ef6325541036eb0d5b66f0/src%2Fcomp%2Fmiddle%2Ftypeck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Ftypeck.rs?ref=4504e23a82a2c4e1d0ef6325541036eb0d5b66f0", "patch": "@@ -2134,28 +2134,23 @@ fn check_expr(&@stmt_ctxt scx, &@ast::expr expr) {\n                                     cond);\n \n             check_block(scx, thn);\n-            auto thn_t = block_ty(scx.fcx.ccx.tcx, thn);\n \n-            auto if_t;\n-            alt (elsopt) {\n+            auto if_t = alt (elsopt) {\n                 case (some[@ast::expr](?els)) {\n                     check_expr(scx, els);\n+\n+                    auto thn_t = block_ty(scx.fcx.ccx.tcx, thn);\n                     auto elsopt_t = expr_ty(scx.fcx.ccx.tcx, els);\n                     if (!ty::type_is_bot(scx.fcx.ccx.tcx, elsopt_t)) {\n-                        Pushdown::pushdown_expr(scx, thn_t, els);\n-                        if_t = elsopt_t;\n+                        elsopt_t\n                     } else {\n-                        if_t = thn_t;\n+                        thn_t\n                     }\n                 }\n                 case (none[@ast::expr]) {\n-                    if_t = ty::mk_nil(scx.fcx.ccx.tcx);\n+                    ty::mk_nil(scx.fcx.ccx.tcx)\n                 }\n-            }\n-\n-            if (!ty::type_is_bot(scx.fcx.ccx.tcx, thn_t)) {\n-                Pushdown::pushdown_block(scx, if_t, thn);\n-            }\n+            };\n \n             write::ty_only_fixup(scx, a.id, if_t);\n         }"}]}