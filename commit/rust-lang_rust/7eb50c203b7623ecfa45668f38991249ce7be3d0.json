{"sha": "7eb50c203b7623ecfa45668f38991249ce7be3d0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdlYjUwYzIwM2I3NjIzZWNmYTQ1NjY4ZjM4OTkxMjQ5Y2U3YmUzZDA=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-12-14T14:56:28Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-12-14T14:56:28Z"}, "message": "auto merge of #10938 : jhasse/rust/patch-rustpkg, r=alexcrichton\n\nrustpkg assumes library files to be in a directory called `lib`, but on Windows they are instead in the `bin` directory. This patch changes nothing on Unix system, since `libdir()` returns `\"lib\"` there.", "tree": {"sha": "b0b4c1000ffd4260bec47f17a45f820a670e3fb7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b0b4c1000ffd4260bec47f17a45f820a670e3fb7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7eb50c203b7623ecfa45668f38991249ce7be3d0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7eb50c203b7623ecfa45668f38991249ce7be3d0", "html_url": "https://github.com/rust-lang/rust/commit/7eb50c203b7623ecfa45668f38991249ce7be3d0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7eb50c203b7623ecfa45668f38991249ce7be3d0/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b2750bca0c9a6b6e995624a56bb5236a91a20901", "url": "https://api.github.com/repos/rust-lang/rust/commits/b2750bca0c9a6b6e995624a56bb5236a91a20901", "html_url": "https://github.com/rust-lang/rust/commit/b2750bca0c9a6b6e995624a56bb5236a91a20901"}, {"sha": "85d33a093aadfc47a859724f192563195d454e7b", "url": "https://api.github.com/repos/rust-lang/rust/commits/85d33a093aadfc47a859724f192563195d454e7b", "html_url": "https://github.com/rust-lang/rust/commit/85d33a093aadfc47a859724f192563195d454e7b"}], "stats": {"total": 7, "additions": 4, "deletions": 3}, "files": [{"sha": "a6b1088335c63f2454ee181d843f6453541b7756", "filename": "src/librustpkg/path_util.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/7eb50c203b7623ecfa45668f38991249ce7be3d0/src%2Flibrustpkg%2Fpath_util.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7eb50c203b7623ecfa45668f38991249ce7be3d0/src%2Flibrustpkg%2Fpath_util.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Fpath_util.rs?ref=7eb50c203b7623ecfa45668f38991249ce7be3d0", "patch": "@@ -16,6 +16,7 @@ pub use package_id::PkgId;\n pub use target::{OutputType, Main, Lib, Test, Bench, Target, Build, Install};\n pub use version::{Version, NoVersion, split_version_general, try_parsing_version};\n pub use rustc::metadata::filesearch::rust_path;\n+use rustc::metadata::filesearch::libdir;\n use rustc::driver::driver::host_triple;\n \n use std::libc;\n@@ -113,7 +114,7 @@ pub fn target_build_dir(workspace: &Path) -> Path {\n /// Return the target-specific lib subdirectory, pushed onto `base`;\n /// doesn't check that it exists or create it\n fn target_lib_dir(workspace: &Path) -> Path {\n-    let mut dir = workspace.join(\"lib\");\n+    let mut dir = workspace.join(libdir());\n     dir.push(host_triple());\n     dir\n }\n@@ -184,7 +185,7 @@ pub fn installed_library_in_workspace(pkg_path: &Path, workspace: &Path) -> Opti\n                                                  short_name,\n                                                  Install,\n                                                  workspace,\n-                                                 \"lib\",\n+                                                 libdir(),\n                                                  &NoVersion)\n     }\n }\n@@ -212,7 +213,7 @@ pub fn library_in_workspace(path: &Path, short_name: &str, where: Target,\n \n // rustc doesn't use target-specific subdirectories\n pub fn system_library(sysroot: &Path, lib_name: &str) -> Option<Path> {\n-    library_in(lib_name, &NoVersion, &sysroot.join(\"lib\"))\n+    library_in(lib_name, &NoVersion, &sysroot.join(libdir()))\n }\n \n fn library_in(short_name: &str, version: &Version, dir_to_search: &Path) -> Option<Path> {"}]}