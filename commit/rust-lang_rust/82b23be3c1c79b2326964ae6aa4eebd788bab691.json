{"sha": "82b23be3c1c79b2326964ae6aa4eebd788bab691", "node_id": "C_kwDOAAsO6NoAKDgyYjIzYmUzYzFjNzliMjMyNjk2NGFlNmFhNGVlYmQ3ODhiYWI2OTE", "commit": {"author": {"name": "Will Crichton", "email": "wcrichto@cs.stanford.edu", "date": "2021-11-05T16:32:04Z"}, "committer": {"name": "Will Crichton", "email": "wcrichto@cs.stanford.edu", "date": "2021-11-05T16:32:04Z"}, "message": "Fix rustdoc-scrape-examples-macros test not being cross-platform", "tree": {"sha": "cb6f573034272e04223537fc7fb635ddffd4c4ed", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cb6f573034272e04223537fc7fb635ddffd4c4ed"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/82b23be3c1c79b2326964ae6aa4eebd788bab691", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/82b23be3c1c79b2326964ae6aa4eebd788bab691", "html_url": "https://github.com/rust-lang/rust/commit/82b23be3c1c79b2326964ae6aa4eebd788bab691", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/82b23be3c1c79b2326964ae6aa4eebd788bab691/comments", "author": {"login": "willcrichton", "id": 663326, "node_id": "MDQ6VXNlcjY2MzMyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/663326?v=4", "gravatar_id": "", "url": "https://api.github.com/users/willcrichton", "html_url": "https://github.com/willcrichton", "followers_url": "https://api.github.com/users/willcrichton/followers", "following_url": "https://api.github.com/users/willcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/willcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/willcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/willcrichton/subscriptions", "organizations_url": "https://api.github.com/users/willcrichton/orgs", "repos_url": "https://api.github.com/users/willcrichton/repos", "events_url": "https://api.github.com/users/willcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/willcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "willcrichton", "id": 663326, "node_id": "MDQ6VXNlcjY2MzMyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/663326?v=4", "gravatar_id": "", "url": "https://api.github.com/users/willcrichton", "html_url": "https://github.com/willcrichton", "followers_url": "https://api.github.com/users/willcrichton/followers", "following_url": "https://api.github.com/users/willcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/willcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/willcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/willcrichton/subscriptions", "organizations_url": "https://api.github.com/users/willcrichton/orgs", "repos_url": "https://api.github.com/users/willcrichton/repos", "events_url": "https://api.github.com/users/willcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/willcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c62817bfe2c4d5c1b993eee9c9d5f10ecd8fbc6e", "url": "https://api.github.com/repos/rust-lang/rust/commits/c62817bfe2c4d5c1b993eee9c9d5f10ecd8fbc6e", "html_url": "https://github.com/rust-lang/rust/commit/c62817bfe2c4d5c1b993eee9c9d5f10ecd8fbc6e"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "4934e875da6f1d9149c2aabbee518422a0f55810", "filename": "src/test/run-make-fulldeps/rustdoc-scrape-examples-macros/Makefile", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/82b23be3c1c79b2326964ae6aa4eebd788bab691/src%2Ftest%2Frun-make-fulldeps%2Frustdoc-scrape-examples-macros%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/82b23be3c1c79b2326964ae6aa4eebd788bab691/src%2Ftest%2Frun-make-fulldeps%2Frustdoc-scrape-examples-macros%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Frustdoc-scrape-examples-macros%2FMakefile?ref=82b23be3c1c79b2326964ae6aa4eebd788bab691", "patch": "@@ -1,14 +1,15 @@\n -include ../../run-make-fulldeps/tools.mk\n \n OUTPUT_DIR := \"$(TMPDIR)/rustdoc\"\n+DYLIB_NAME := $(shell echo | $(RUSTC) --crate-name foobar_macro --crate-type dylib --print file-names -)\n \n all:\n \t$(RUSTC) src/proc.rs --crate-name foobar_macro --edition=2021 --crate-type proc-macro --emit=dep-info,link\n \n \t$(RUSTC) src/lib.rs --crate-name foobar --edition=2021 --crate-type lib --emit=dep-info,link\n \n \t$(RUSTDOC) examples/ex.rs --crate-name ex --crate-type bin --output $(OUTPUT_DIR) \\\n-\t\t--extern foobar=$(TMPDIR)/libfoobar.rlib --extern foobar_macro=$(TMPDIR)/libfoobar_macro.so \\\n+\t\t--extern foobar=$(TMPDIR)/libfoobar.rlib --extern foobar_macro=$(TMPDIR)/$(DYLIB_NAME) \\\n \t\t-Z unstable-options --scrape-examples-output-path $(TMPDIR)/ex.calls --scrape-examples-target-crate foobar\n \n \t$(RUSTDOC) src/lib.rs --crate-name foobar --crate-type lib --output $(OUTPUT_DIR) \\"}]}