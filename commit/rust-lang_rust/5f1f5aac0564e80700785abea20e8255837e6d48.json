{"sha": "5f1f5aac0564e80700785abea20e8255837e6d48", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVmMWY1YWFjMDU2NGU4MDcwMDc4NWFiZWEyMGU4MjU1ODM3ZTZkNDg=", "commit": {"author": {"name": "topecongiro", "email": "seuchida@gmail.com", "date": "2019-03-24T22:54:31Z"}, "committer": {"name": "topecongiro", "email": "seuchida@gmail.com", "date": "2019-03-24T22:54:31Z"}, "message": "Make sure that we run rustfmt against every edition", "tree": {"sha": "147e18dc5bfbafa5b74a8c39c7504f4b12fe973e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/147e18dc5bfbafa5b74a8c39c7504f4b12fe973e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5f1f5aac0564e80700785abea20e8255837e6d48", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5f1f5aac0564e80700785abea20e8255837e6d48", "html_url": "https://github.com/rust-lang/rust/commit/5f1f5aac0564e80700785abea20e8255837e6d48", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5f1f5aac0564e80700785abea20e8255837e6d48/comments", "author": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "committer": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "288d7db5a9f38f2523d7e83b388744427be1e671", "url": "https://api.github.com/repos/rust-lang/rust/commits/288d7db5a9f38f2523d7e83b388744427be1e671", "html_url": "https://github.com/rust-lang/rust/commit/288d7db5a9f38f2523d7e83b388744427be1e671"}], "stats": {"total": 18, "additions": 8, "deletions": 10}, "files": [{"sha": "25ce43d47e242be7664d376b7d10c9d5c62d00df", "filename": "src/cargo-fmt/main.rs", "status": "modified", "additions": 8, "deletions": 10, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/5f1f5aac0564e80700785abea20e8255837e6d48/src%2Fcargo-fmt%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5f1f5aac0564e80700785abea20e8255837e6d48/src%2Fcargo-fmt%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcargo-fmt%2Fmain.rs?ref=5f1f5aac0564e80700785abea20e8255837e6d48", "patch": "@@ -311,8 +311,7 @@ fn run_rustfmt(\n     fmt_args: &[String],\n     verbosity: Verbosity,\n ) -> Result<i32, io::Error> {\n-    let default_edition = String::from(\"2015\");\n-    let mut by_edition = targets\n+    let by_edition = targets\n         .iter()\n         .inspect(|t| {\n             if verbosity == Verbosity::Verbose {\n@@ -324,10 +323,8 @@ fn run_rustfmt(\n             h.entry(t.0).or_insert_with(Vec::new).push(t.1);\n             h\n         });\n-    if by_edition.is_empty() {\n-        by_edition.insert(&default_edition, Vec::new());\n-    }\n \n+    let mut status = vec![];\n     for (edition, files) in by_edition {\n         let stdout = if verbosity == Verbosity::Quiet {\n             std::process::Stdio::null()\n@@ -357,13 +354,14 @@ fn run_rustfmt(\n                 _ => e,\n             })?;\n \n-        let status = command.wait()?;\n-        if !status.success() {\n-            return Ok(status.code().unwrap_or(FAILURE));\n-        }\n+        status.push(command.wait()?);\n     }\n \n-    Ok(SUCCESS)\n+    Ok(status\n+        .iter()\n+        .filter_map(|s| if s.success() { None } else { s.code() })\n+        .next()\n+        .unwrap_or(SUCCESS))\n }\n \n fn get_cargo_metadata(manifest_path: Option<&Path>) -> Result<cargo_metadata::Metadata, io::Error> {"}]}