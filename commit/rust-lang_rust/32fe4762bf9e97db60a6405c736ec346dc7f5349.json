{"sha": "32fe4762bf9e97db60a6405c736ec346dc7f5349", "node_id": "C_kwDOAAsO6NoAKDMyZmU0NzYyYmY5ZTk3ZGI2MGE2NDA1YzczNmVjMzQ2ZGM3ZjUzNDk", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-04-30T17:22:34Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-04-30T17:22:34Z"}, "message": "Auto merge of #8625 - Jarcho:rename_lint, r=xFrednet\n\nAdd `cargo dev rename_lint`\n\nfixes #7799\n\nchangelog: None", "tree": {"sha": "463cd52f410607decc971f04b11202ddf1511e4b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/463cd52f410607decc971f04b11202ddf1511e4b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/32fe4762bf9e97db60a6405c736ec346dc7f5349", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/32fe4762bf9e97db60a6405c736ec346dc7f5349", "html_url": "https://github.com/rust-lang/rust/commit/32fe4762bf9e97db60a6405c736ec346dc7f5349", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/32fe4762bf9e97db60a6405c736ec346dc7f5349/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ec46992008c0fd93ab0f3aef8438dd24eca28a9d", "url": "https://api.github.com/repos/rust-lang/rust/commits/ec46992008c0fd93ab0f3aef8438dd24eca28a9d", "html_url": "https://github.com/rust-lang/rust/commit/ec46992008c0fd93ab0f3aef8438dd24eca28a9d"}, {"sha": "b3de32ba3cc2985c4e1d890732548a99fd55bba0", "url": "https://api.github.com/repos/rust-lang/rust/commits/b3de32ba3cc2985c4e1d890732548a99fd55bba0", "html_url": "https://github.com/rust-lang/rust/commit/b3de32ba3cc2985c4e1d890732548a99fd55bba0"}], "stats": {"total": 913, "additions": 646, "deletions": 267}, "files": [{"sha": "fe380239fa65999d6865d12a4960bc79dc74e302", "filename": "clippy_dev/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/32fe4762bf9e97db60a6405c736ec346dc7f5349/clippy_dev%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/32fe4762bf9e97db60a6405c736ec346dc7f5349/clippy_dev%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2FCargo.toml?ref=32fe4762bf9e97db60a6405c736ec346dc7f5349", "patch": "@@ -4,6 +4,7 @@ version = \"0.0.1\"\n edition = \"2021\"\n \n [dependencies]\n+aho-corasick = \"0.7\"\n clap = \"2.33\"\n indoc = \"1.0\"\n itertools = \"0.10.1\""}, {"sha": "81e807cf10c7c3a489e3a601b569714b160fbf66", "filename": "clippy_dev/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/32fe4762bf9e97db60a6405c736ec346dc7f5349/clippy_dev%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/32fe4762bf9e97db60a6405c736ec346dc7f5349/clippy_dev%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Flib.rs?ref=32fe4762bf9e97db60a6405c736ec346dc7f5349", "patch": "@@ -1,3 +1,4 @@\n+#![feature(let_chains)]\n #![feature(let_else)]\n #![feature(once_cell)]\n #![feature(rustc_private)]"}, {"sha": "ebf8f38d4906eae4d15eaf1c3ef6179295216553", "filename": "clippy_dev/src/main.rs", "status": "modified", "additions": 30, "deletions": 3, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/32fe4762bf9e97db60a6405c736ec346dc7f5349/clippy_dev%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/32fe4762bf9e97db60a6405c736ec346dc7f5349/clippy_dev%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Fmain.rs?ref=32fe4762bf9e97db60a6405c736ec346dc7f5349", "patch": "@@ -19,9 +19,9 @@ fn main() {\n             if matches.is_present(\"print-only\") {\n                 update_lints::print_lints();\n             } else if matches.is_present(\"check\") {\n-                update_lints::run(update_lints::UpdateMode::Check);\n+                update_lints::update(update_lints::UpdateMode::Check);\n             } else {\n-                update_lints::run(update_lints::UpdateMode::Change);\n+                update_lints::update(update_lints::UpdateMode::Change);\n             }\n         },\n         (\"new_lint\", Some(matches)) => {\n@@ -31,7 +31,7 @@ fn main() {\n                 matches.value_of(\"category\"),\n                 matches.is_present(\"msrv\"),\n             ) {\n-                Ok(_) => update_lints::run(update_lints::UpdateMode::Change),\n+                Ok(_) => update_lints::update(update_lints::UpdateMode::Change),\n                 Err(e) => eprintln!(\"Unable to create lint: {}\", e),\n             }\n         },\n@@ -78,6 +78,12 @@ fn main() {\n             let path = matches.value_of(\"path\").unwrap();\n             lint::run(path);\n         },\n+        (\"rename_lint\", Some(matches)) => {\n+            let old_name = matches.value_of(\"old_name\").unwrap();\n+            let new_name = matches.value_of(\"new_name\").unwrap_or(old_name);\n+            let uplift = matches.is_present(\"uplift\");\n+            update_lints::rename(old_name, new_name, uplift);\n+        },\n         _ => {},\n     }\n }\n@@ -279,5 +285,26 @@ fn get_clap_config<'a>() -> ArgMatches<'a> {\n                         .help(\"The path to a file or package directory to lint\"),\n                 ),\n         )\n+        .subcommand(\n+            SubCommand::with_name(\"rename_lint\")\n+                .about(\"Renames the given lint\")\n+                .arg(\n+                    Arg::with_name(\"old_name\")\n+                        .index(1)\n+                        .required(true)\n+                        .help(\"The name of the lint to rename\"),\n+                )\n+                .arg(\n+                    Arg::with_name(\"new_name\")\n+                        .index(2)\n+                        .required_unless(\"uplift\")\n+                        .help(\"The new name of the lint\"),\n+                )\n+                .arg(\n+                    Arg::with_name(\"uplift\")\n+                        .long(\"uplift\")\n+                        .help(\"This lint will be uplifted into rustc\"),\n+                ),\n+        )\n         .get_matches()\n }"}, {"sha": "1a6a4336da27e2c2955fcf48a828e7138cd9a95b", "filename": "clippy_dev/src/update_lints.rs", "status": "modified", "additions": 365, "deletions": 24, "changes": 389, "blob_url": "https://github.com/rust-lang/rust/blob/32fe4762bf9e97db60a6405c736ec346dc7f5349/clippy_dev%2Fsrc%2Fupdate_lints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/32fe4762bf9e97db60a6405c736ec346dc7f5349/clippy_dev%2Fsrc%2Fupdate_lints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Fupdate_lints.rs?ref=32fe4762bf9e97db60a6405c736ec346dc7f5349", "patch": "@@ -1,11 +1,13 @@\n-use core::fmt::Write;\n+use aho_corasick::AhoCorasickBuilder;\n+use core::fmt::Write as _;\n use itertools::Itertools;\n use rustc_lexer::{tokenize, unescape, LiteralKind, TokenKind};\n-use std::collections::HashMap;\n+use std::collections::{HashMap, HashSet};\n use std::ffi::OsStr;\n use std::fs;\n-use std::path::Path;\n-use walkdir::WalkDir;\n+use std::io::{self, Read as _, Seek as _, Write as _};\n+use std::path::{Path, PathBuf};\n+use walkdir::{DirEntry, WalkDir};\n \n use crate::clippy_project_root;\n \n@@ -30,12 +32,19 @@ pub enum UpdateMode {\n /// # Panics\n ///\n /// Panics if a file path could not read from or then written to\n-#[allow(clippy::too_many_lines)]\n-pub fn run(update_mode: UpdateMode) {\n-    let (lints, deprecated_lints) = gather_all();\n+pub fn update(update_mode: UpdateMode) {\n+    let (lints, deprecated_lints, renamed_lints) = gather_all();\n+    generate_lint_files(update_mode, &lints, &deprecated_lints, &renamed_lints);\n+}\n \n-    let internal_lints = Lint::internal_lints(&lints);\n-    let usable_lints = Lint::usable_lints(&lints);\n+fn generate_lint_files(\n+    update_mode: UpdateMode,\n+    lints: &[Lint],\n+    deprecated_lints: &[DeprecatedLint],\n+    renamed_lints: &[RenamedLint],\n+) {\n+    let internal_lints = Lint::internal_lints(lints);\n+    let usable_lints = Lint::usable_lints(lints);\n     let mut sorted_usable_lints = usable_lints.clone();\n     sorted_usable_lints.sort_by_key(|lint| lint.name.clone());\n \n@@ -87,7 +96,7 @@ pub fn run(update_mode: UpdateMode) {\n     process_file(\n         \"clippy_lints/src/lib.deprecated.rs\",\n         update_mode,\n-        &gen_deprecated(&deprecated_lints),\n+        &gen_deprecated(deprecated_lints),\n     );\n \n     let all_group_lints = usable_lints.iter().filter(|l| {\n@@ -107,10 +116,16 @@ pub fn run(update_mode: UpdateMode) {\n             &content,\n         );\n     }\n+\n+    let content = gen_deprecated_lints_test(deprecated_lints);\n+    process_file(\"tests/ui/deprecated.rs\", update_mode, &content);\n+\n+    let content = gen_renamed_lints_test(renamed_lints);\n+    process_file(\"tests/ui/rename.rs\", update_mode, &content);\n }\n \n pub fn print_lints() {\n-    let (lint_list, _) = gather_all();\n+    let (lint_list, _, _) = gather_all();\n     let usable_lints = Lint::usable_lints(&lint_list);\n     let usable_lint_count = usable_lints.len();\n     let grouped_by_lint_group = Lint::by_lint_group(usable_lints.into_iter());\n@@ -128,6 +143,209 @@ pub fn print_lints() {\n     println!(\"there are {} lints\", usable_lint_count);\n }\n \n+/// Runs the `rename_lint` command.\n+///\n+/// This does the following:\n+/// * Adds an entry to `renamed_lints.rs`.\n+/// * Renames all lint attributes to the new name (e.g. `#[allow(clippy::lint_name)]`).\n+/// * Renames the lint struct to the new name.\n+/// * Renames the module containing the lint struct to the new name if it shares a name with the\n+///   lint.\n+///\n+/// # Panics\n+/// Panics for the following conditions:\n+/// * If a file path could not read from or then written to\n+/// * If either lint name has a prefix\n+/// * If `old_name` doesn't name an existing lint.\n+/// * If `old_name` names a deprecated or renamed lint.\n+#[allow(clippy::too_many_lines)]\n+pub fn rename(old_name: &str, new_name: &str, uplift: bool) {\n+    if let Some((prefix, _)) = old_name.split_once(\"::\") {\n+        panic!(\"`{}` should not contain the `{}` prefix\", old_name, prefix);\n+    }\n+    if let Some((prefix, _)) = new_name.split_once(\"::\") {\n+        panic!(\"`{}` should not contain the `{}` prefix\", new_name, prefix);\n+    }\n+\n+    let (mut lints, deprecated_lints, mut renamed_lints) = gather_all();\n+    let mut old_lint_index = None;\n+    let mut found_new_name = false;\n+    for (i, lint) in lints.iter().enumerate() {\n+        if lint.name == old_name {\n+            old_lint_index = Some(i);\n+        } else if lint.name == new_name {\n+            found_new_name = true;\n+        }\n+    }\n+    let old_lint_index = old_lint_index.unwrap_or_else(|| panic!(\"could not find lint `{}`\", old_name));\n+\n+    let lint = RenamedLint {\n+        old_name: format!(\"clippy::{}\", old_name),\n+        new_name: if uplift {\n+            new_name.into()\n+        } else {\n+            format!(\"clippy::{}\", new_name)\n+        },\n+    };\n+\n+    // Renamed lints and deprecated lints shouldn't have been found in the lint list, but check just in\n+    // case.\n+    assert!(\n+        !renamed_lints.iter().any(|l| lint.old_name == l.old_name),\n+        \"`{}` has already been renamed\",\n+        old_name\n+    );\n+    assert!(\n+        !deprecated_lints.iter().any(|l| lint.old_name == l.name),\n+        \"`{}` has already been deprecated\",\n+        old_name\n+    );\n+\n+    // Update all lint level attributes. (`clippy::lint_name`)\n+    for file in WalkDir::new(clippy_project_root())\n+        .into_iter()\n+        .map(Result::unwrap)\n+        .filter(|f| {\n+            let name = f.path().file_name();\n+            let ext = f.path().extension();\n+            (ext == Some(OsStr::new(\"rs\")) || ext == Some(OsStr::new(\"fixed\")))\n+                && name != Some(OsStr::new(\"rename.rs\"))\n+                && name != Some(OsStr::new(\"renamed_lints.rs\"))\n+        })\n+    {\n+        rewrite_file(file.path(), |s| {\n+            replace_ident_like(s, &[(&lint.old_name, &lint.new_name)])\n+        });\n+    }\n+\n+    renamed_lints.push(lint);\n+    renamed_lints.sort_by(|lhs, rhs| {\n+        lhs.new_name\n+            .starts_with(\"clippy::\")\n+            .cmp(&rhs.new_name.starts_with(\"clippy::\"))\n+            .reverse()\n+            .then_with(|| lhs.old_name.cmp(&rhs.old_name))\n+    });\n+\n+    write_file(\n+        Path::new(\"clippy_lints/src/renamed_lints.rs\"),\n+        &gen_renamed_lints_list(&renamed_lints),\n+    );\n+\n+    if uplift {\n+        write_file(Path::new(\"tests/ui/rename.rs\"), &gen_renamed_lints_test(&renamed_lints));\n+        println!(\n+            \"`{}` has be uplifted. All the code inside `clippy_lints` related to it needs to be removed manually.\",\n+            old_name\n+        );\n+    } else if found_new_name {\n+        write_file(Path::new(\"tests/ui/rename.rs\"), &gen_renamed_lints_test(&renamed_lints));\n+        println!(\n+            \"`{}` is already defined. The old linting code inside `clippy_lints` needs to be updated/removed manually.\",\n+            new_name\n+        );\n+    } else {\n+        // Rename the lint struct and source files sharing a name with the lint.\n+        let lint = &mut lints[old_lint_index];\n+        let old_name_upper = old_name.to_uppercase();\n+        let new_name_upper = new_name.to_uppercase();\n+        lint.name = new_name.into();\n+\n+        // Rename test files. only rename `.stderr` and `.fixed` files if the new test name doesn't exist.\n+        if try_rename_file(\n+            Path::new(&format!(\"tests/ui/{}.rs\", old_name)),\n+            Path::new(&format!(\"tests/ui/{}.rs\", new_name)),\n+        ) {\n+            try_rename_file(\n+                Path::new(&format!(\"tests/ui/{}.stderr\", old_name)),\n+                Path::new(&format!(\"tests/ui/{}.stderr\", new_name)),\n+            );\n+            try_rename_file(\n+                Path::new(&format!(\"tests/ui/{}.fixed\", old_name)),\n+                Path::new(&format!(\"tests/ui/{}.fixed\", new_name)),\n+            );\n+        }\n+\n+        // Try to rename the file containing the lint if the file name matches the lint's name.\n+        let replacements;\n+        let replacements = if lint.module == old_name\n+            && try_rename_file(\n+                Path::new(&format!(\"clippy_lints/src/{}.rs\", old_name)),\n+                Path::new(&format!(\"clippy_lints/src/{}.rs\", new_name)),\n+            ) {\n+            // Edit the module name in the lint list. Note there could be multiple lints.\n+            for lint in lints.iter_mut().filter(|l| l.module == old_name) {\n+                lint.module = new_name.into();\n+            }\n+            replacements = [(&*old_name_upper, &*new_name_upper), (old_name, new_name)];\n+            replacements.as_slice()\n+        } else if !lint.module.contains(\"::\")\n+            // Catch cases like `methods/lint_name.rs` where the lint is stored in `methods/mod.rs`\n+            && try_rename_file(\n+                Path::new(&format!(\"clippy_lints/src/{}/{}.rs\", lint.module, old_name)),\n+                Path::new(&format!(\"clippy_lints/src/{}/{}.rs\", lint.module, new_name)),\n+            )\n+        {\n+            // Edit the module name in the lint list. Note there could be multiple lints, or none.\n+            let renamed_mod = format!(\"{}::{}\", lint.module, old_name);\n+            for lint in lints.iter_mut().filter(|l| l.module == renamed_mod) {\n+                lint.module = format!(\"{}::{}\", lint.module, new_name);\n+            }\n+            replacements = [(&*old_name_upper, &*new_name_upper), (old_name, new_name)];\n+            replacements.as_slice()\n+        } else {\n+            replacements = [(&*old_name_upper, &*new_name_upper), (\"\", \"\")];\n+            &replacements[0..1]\n+        };\n+\n+        // Don't change `clippy_utils/src/renamed_lints.rs` here as it would try to edit the lint being\n+        // renamed.\n+        for (_, file) in clippy_lints_src_files().filter(|(rel_path, _)| rel_path != OsStr::new(\"renamed_lints.rs\")) {\n+            rewrite_file(file.path(), |s| replace_ident_like(s, replacements));\n+        }\n+\n+        generate_lint_files(UpdateMode::Change, &lints, &deprecated_lints, &renamed_lints);\n+        println!(\"{} has been successfully renamed\", old_name);\n+    }\n+\n+    println!(\"note: `cargo uitest` still needs to be run to update the test results\");\n+}\n+\n+/// Replace substrings if they aren't bordered by identifier characters. Returns `None` if there\n+/// were no replacements.\n+fn replace_ident_like(contents: &str, replacements: &[(&str, &str)]) -> Option<String> {\n+    fn is_ident_char(c: u8) -> bool {\n+        matches!(c, b'a'..=b'z' | b'A'..=b'Z' | b'0'..=b'9' | b'_')\n+    }\n+\n+    let searcher = AhoCorasickBuilder::new()\n+        .dfa(true)\n+        .match_kind(aho_corasick::MatchKind::LeftmostLongest)\n+        .build_with_size::<u16, _, _>(replacements.iter().map(|&(x, _)| x.as_bytes()))\n+        .unwrap();\n+\n+    let mut result = String::with_capacity(contents.len() + 1024);\n+    let mut pos = 0;\n+    let mut edited = false;\n+    for m in searcher.find_iter(contents) {\n+        let (old, new) = replacements[m.pattern()];\n+        result.push_str(&contents[pos..m.start()]);\n+        result.push_str(\n+            if !is_ident_char(contents.as_bytes().get(m.start().wrapping_sub(1)).copied().unwrap_or(0))\n+                && !is_ident_char(contents.as_bytes().get(m.end()).copied().unwrap_or(0))\n+            {\n+                edited = true;\n+                new\n+            } else {\n+                old\n+            },\n+        );\n+        pos = m.end();\n+    }\n+    result.push_str(&contents[pos..]);\n+    edited.then(|| result)\n+}\n+\n fn round_to_fifty(count: usize) -> usize {\n     count / 50 * 50\n }\n@@ -210,6 +428,19 @@ impl DeprecatedLint {\n     }\n }\n \n+struct RenamedLint {\n+    old_name: String,\n+    new_name: String,\n+}\n+impl RenamedLint {\n+    fn new(old_name: &str, new_name: &str) -> Self {\n+        Self {\n+            old_name: remove_line_splices(old_name),\n+            new_name: remove_line_splices(new_name),\n+        }\n+    }\n+}\n+\n /// Generates the code for registering a group\n fn gen_lint_group_list<'a>(group_name: &str, lints: impl Iterator<Item = &'a Lint>) -> String {\n     let mut details: Vec<_> = lints.map(|l| (&l.module, l.name.to_uppercase())).collect();\n@@ -278,18 +509,55 @@ fn gen_register_lint_list<'a>(\n     output\n }\n \n+fn gen_deprecated_lints_test(lints: &[DeprecatedLint]) -> String {\n+    let mut res: String = GENERATED_FILE_COMMENT.into();\n+    for lint in lints {\n+        writeln!(res, \"#![warn(clippy::{})]\", lint.name).unwrap();\n+    }\n+    res.push_str(\"\\nfn main() {}\\n\");\n+    res\n+}\n+\n+fn gen_renamed_lints_test(lints: &[RenamedLint]) -> String {\n+    let mut seen_lints = HashSet::new();\n+    let mut res: String = GENERATED_FILE_COMMENT.into();\n+    res.push_str(\"// run-rustfix\\n\\n\");\n+    for lint in lints {\n+        if seen_lints.insert(&lint.new_name) {\n+            writeln!(res, \"#![allow({})]\", lint.new_name).unwrap();\n+        }\n+    }\n+    seen_lints.clear();\n+    for lint in lints {\n+        if seen_lints.insert(&lint.old_name) {\n+            writeln!(res, \"#![warn({})]\", lint.old_name).unwrap();\n+        }\n+    }\n+    res.push_str(\"\\nfn main() {}\\n\");\n+    res\n+}\n+\n+fn gen_renamed_lints_list(lints: &[RenamedLint]) -> String {\n+    const HEADER: &str = \"\\\n+        // This file is managed by `cargo dev rename_lint`. Prefer using that when possible.\\n\\n\\\n+        #[rustfmt::skip]\\n\\\n+        pub static RENAMED_LINTS: &[(&str, &str)] = &[\\n\";\n+\n+    let mut res = String::from(HEADER);\n+    for lint in lints {\n+        writeln!(res, \"    (\\\"{}\\\", \\\"{}\\\"),\", lint.old_name, lint.new_name).unwrap();\n+    }\n+    res.push_str(\"];\\n\");\n+    res\n+}\n+\n /// Gathers all lints defined in `clippy_lints/src`\n-fn gather_all() -> (Vec<Lint>, Vec<DeprecatedLint>) {\n+fn gather_all() -> (Vec<Lint>, Vec<DeprecatedLint>, Vec<RenamedLint>) {\n     let mut lints = Vec::with_capacity(1000);\n     let mut deprecated_lints = Vec::with_capacity(50);\n-    let root_path = clippy_project_root().join(\"clippy_lints/src\");\n+    let mut renamed_lints = Vec::with_capacity(50);\n \n-    for (rel_path, file) in WalkDir::new(&root_path)\n-        .into_iter()\n-        .map(Result::unwrap)\n-        .filter(|f| f.path().extension() == Some(OsStr::new(\"rs\")))\n-        .map(|f| (f.path().strip_prefix(&root_path).unwrap().to_path_buf(), f))\n-    {\n+    for (rel_path, file) in clippy_lints_src_files() {\n         let path = file.path();\n         let contents =\n             fs::read_to_string(path).unwrap_or_else(|e| panic!(\"Cannot read from `{}`: {}\", path.display(), e));\n@@ -307,13 +575,21 @@ fn gather_all() -> (Vec<Lint>, Vec<DeprecatedLint>) {\n             module.strip_suffix(\".rs\").unwrap_or(&module)\n         };\n \n-        if module == \"deprecated_lints\" {\n-            parse_deprecated_contents(&contents, &mut deprecated_lints);\n-        } else {\n-            parse_contents(&contents, module, &mut lints);\n+        match module {\n+            \"deprecated_lints\" => parse_deprecated_contents(&contents, &mut deprecated_lints),\n+            \"renamed_lints\" => parse_renamed_contents(&contents, &mut renamed_lints),\n+            _ => parse_contents(&contents, module, &mut lints),\n         }\n     }\n-    (lints, deprecated_lints)\n+    (lints, deprecated_lints, renamed_lints)\n+}\n+\n+fn clippy_lints_src_files() -> impl Iterator<Item = (PathBuf, DirEntry)> {\n+    let root_path = clippy_project_root().join(\"clippy_lints/src\");\n+    let iter = WalkDir::new(&root_path).into_iter();\n+    iter.map(Result::unwrap)\n+        .filter(|f| f.path().extension() == Some(OsStr::new(\"rs\")))\n+        .map(move |f| (f.path().strip_prefix(&root_path).unwrap().to_path_buf(), f))\n }\n \n macro_rules! match_tokens {\n@@ -396,6 +672,25 @@ fn parse_deprecated_contents(contents: &str, lints: &mut Vec<DeprecatedLint>) {\n     }\n }\n \n+fn parse_renamed_contents(contents: &str, lints: &mut Vec<RenamedLint>) {\n+    for line in contents.lines() {\n+        let mut offset = 0usize;\n+        let mut iter = tokenize(line).map(|t| {\n+            let range = offset..offset + t.len;\n+            offset = range.end;\n+            (t.kind, &line[range])\n+        });\n+        let (old_name, new_name) = match_tokens!(\n+            iter,\n+            // (\"old_name\",\n+            Whitespace OpenParen Literal{kind: LiteralKind::Str{..},..}(old_name) Comma\n+            // \"new_name\"),\n+            Whitespace Literal{kind: LiteralKind::Str{..},..}(new_name) CloseParen Comma\n+        );\n+        lints.push(RenamedLint::new(old_name, new_name));\n+    }\n+}\n+\n /// Removes the line splices and surrounding quotes from a string literal\n fn remove_line_splices(s: &str) -> String {\n     let s = s\n@@ -464,6 +759,52 @@ fn replace_region_in_text<'a>(\n     Ok(res)\n }\n \n+fn try_rename_file(old_name: &Path, new_name: &Path) -> bool {\n+    match fs::OpenOptions::new().create_new(true).write(true).open(new_name) {\n+        Ok(file) => drop(file),\n+        Err(e) if matches!(e.kind(), io::ErrorKind::AlreadyExists | io::ErrorKind::NotFound) => return false,\n+        Err(e) => panic_file(e, new_name, \"create\"),\n+    };\n+    match fs::rename(old_name, new_name) {\n+        Ok(()) => true,\n+        Err(e) => {\n+            drop(fs::remove_file(new_name));\n+            if e.kind() == io::ErrorKind::NotFound {\n+                false\n+            } else {\n+                panic_file(e, old_name, \"rename\");\n+            }\n+        },\n+    }\n+}\n+\n+#[allow(clippy::needless_pass_by_value)]\n+fn panic_file(error: io::Error, name: &Path, action: &str) -> ! {\n+    panic!(\"failed to {} file `{}`: {}\", action, name.display(), error)\n+}\n+\n+fn rewrite_file(path: &Path, f: impl FnOnce(&str) -> Option<String>) {\n+    let mut file = fs::OpenOptions::new()\n+        .write(true)\n+        .read(true)\n+        .open(path)\n+        .unwrap_or_else(|e| panic_file(e, path, \"open\"));\n+    let mut buf = String::new();\n+    file.read_to_string(&mut buf)\n+        .unwrap_or_else(|e| panic_file(e, path, \"read\"));\n+    if let Some(new_contents) = f(&buf) {\n+        file.rewind().unwrap_or_else(|e| panic_file(e, path, \"write\"));\n+        file.write_all(new_contents.as_bytes())\n+            .unwrap_or_else(|e| panic_file(e, path, \"write\"));\n+        file.set_len(new_contents.len() as u64)\n+            .unwrap_or_else(|e| panic_file(e, path, \"write\"));\n+    }\n+}\n+\n+fn write_file(path: &Path, contents: &str) {\n+    fs::write(path, contents).unwrap_or_else(|e| panic_file(e, path, \"write\"));\n+}\n+\n #[cfg(test)]\n mod tests {\n     use super::*;"}, {"sha": "24cb4ec2677fd80d54ebcb2260141922578798c3", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 5, "deletions": 37, "changes": 42, "blob_url": "https://github.com/rust-lang/rust/blob/32fe4762bf9e97db60a6405c736ec346dc7f5349/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/32fe4762bf9e97db60a6405c736ec346dc7f5349/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=32fe4762bf9e97db60a6405c736ec346dc7f5349", "patch": "@@ -163,6 +163,8 @@ mod deprecated_lints;\n #[cfg_attr(feature = \"internal\", allow(clippy::missing_clippy_version_attribute))]\n mod utils;\n \n+mod renamed_lints;\n+\n // begin lints modules, do not remove this comment, it\u2019s used in `update_lints`\n mod absurd_extreme_comparisons;\n mod approx_const;\n@@ -938,43 +940,9 @@ fn register_removed_non_tool_lints(store: &mut rustc_lint::LintStore) {\n ///\n /// Used in `./src/driver.rs`.\n pub fn register_renamed(ls: &mut rustc_lint::LintStore) {\n-    // NOTE: when renaming a lint, add a corresponding test to tests/ui/rename.rs\n-    ls.register_renamed(\"clippy::stutter\", \"clippy::module_name_repetitions\");\n-    ls.register_renamed(\"clippy::new_without_default_derive\", \"clippy::new_without_default\");\n-    ls.register_renamed(\"clippy::cyclomatic_complexity\", \"clippy::cognitive_complexity\");\n-    ls.register_renamed(\"clippy::const_static_lifetime\", \"clippy::redundant_static_lifetimes\");\n-    ls.register_renamed(\"clippy::option_and_then_some\", \"clippy::bind_instead_of_map\");\n-    ls.register_renamed(\"clippy::box_vec\", \"clippy::box_collection\");\n-    ls.register_renamed(\"clippy::block_in_if_condition_expr\", \"clippy::blocks_in_if_conditions\");\n-    ls.register_renamed(\"clippy::block_in_if_condition_stmt\", \"clippy::blocks_in_if_conditions\");\n-    ls.register_renamed(\"clippy::option_map_unwrap_or\", \"clippy::map_unwrap_or\");\n-    ls.register_renamed(\"clippy::option_map_unwrap_or_else\", \"clippy::map_unwrap_or\");\n-    ls.register_renamed(\"clippy::result_map_unwrap_or_else\", \"clippy::map_unwrap_or\");\n-    ls.register_renamed(\"clippy::option_unwrap_used\", \"clippy::unwrap_used\");\n-    ls.register_renamed(\"clippy::result_unwrap_used\", \"clippy::unwrap_used\");\n-    ls.register_renamed(\"clippy::option_expect_used\", \"clippy::expect_used\");\n-    ls.register_renamed(\"clippy::result_expect_used\", \"clippy::expect_used\");\n-    ls.register_renamed(\"clippy::for_loop_over_option\", \"clippy::for_loops_over_fallibles\");\n-    ls.register_renamed(\"clippy::for_loop_over_result\", \"clippy::for_loops_over_fallibles\");\n-    ls.register_renamed(\"clippy::identity_conversion\", \"clippy::useless_conversion\");\n-    ls.register_renamed(\"clippy::zero_width_space\", \"clippy::invisible_characters\");\n-    ls.register_renamed(\"clippy::single_char_push_str\", \"clippy::single_char_add_str\");\n-    ls.register_renamed(\"clippy::if_let_some_result\", \"clippy::match_result_ok\");\n-    ls.register_renamed(\"clippy::disallowed_type\", \"clippy::disallowed_types\");\n-    ls.register_renamed(\"clippy::disallowed_method\", \"clippy::disallowed_methods\");\n-    ls.register_renamed(\"clippy::ref_in_deref\", \"clippy::needless_borrow\");\n-    ls.register_renamed(\"clippy::to_string_in_display\", \"clippy::recursive_format_impl\");\n-\n-    // uplifted lints\n-    ls.register_renamed(\"clippy::invalid_ref\", \"invalid_value\");\n-    ls.register_renamed(\"clippy::into_iter_on_array\", \"array_into_iter\");\n-    ls.register_renamed(\"clippy::unused_label\", \"unused_labels\");\n-    ls.register_renamed(\"clippy::drop_bounds\", \"drop_bounds\");\n-    ls.register_renamed(\"clippy::temporary_cstring_as_ptr\", \"temporary_cstring_as_ptr\");\n-    ls.register_renamed(\"clippy::panic_params\", \"non_fmt_panics\");\n-    ls.register_renamed(\"clippy::unknown_clippy_lints\", \"unknown_lints\");\n-    ls.register_renamed(\"clippy::invalid_atomic_ordering\", \"invalid_atomic_ordering\");\n-    ls.register_renamed(\"clippy::mem_discriminant_non_enum\", \"enum_intrinsics_non_enums\");\n+    for (old_name, new_name) in renamed_lints::RENAMED_LINTS {\n+        ls.register_renamed(old_name, new_name);\n+    }\n }\n \n // only exists to let the dogfood integration test works."}, {"sha": "bfc03116fe2d9542678069c605ebf0088137b99a", "filename": "clippy_lints/src/renamed_lints.rs", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/32fe4762bf9e97db60a6405c736ec346dc7f5349/clippy_lints%2Fsrc%2Frenamed_lints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/32fe4762bf9e97db60a6405c736ec346dc7f5349/clippy_lints%2Fsrc%2Frenamed_lints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Frenamed_lints.rs?ref=32fe4762bf9e97db60a6405c736ec346dc7f5349", "patch": "@@ -0,0 +1,39 @@\n+// This file is managed by `cargo dev rename_lint`. Prefer using that when possible.\n+\n+#[rustfmt::skip]\n+pub static RENAMED_LINTS: &[(&str, &str)] = &[\n+    (\"clippy::block_in_if_condition_expr\", \"clippy::blocks_in_if_conditions\"),\n+    (\"clippy::block_in_if_condition_stmt\", \"clippy::blocks_in_if_conditions\"),\n+    (\"clippy::box_vec\", \"clippy::box_collection\"),\n+    (\"clippy::const_static_lifetime\", \"clippy::redundant_static_lifetimes\"),\n+    (\"clippy::cyclomatic_complexity\", \"clippy::cognitive_complexity\"),\n+    (\"clippy::disallowed_method\", \"clippy::disallowed_methods\"),\n+    (\"clippy::disallowed_type\", \"clippy::disallowed_types\"),\n+    (\"clippy::for_loop_over_option\", \"clippy::for_loops_over_fallibles\"),\n+    (\"clippy::for_loop_over_result\", \"clippy::for_loops_over_fallibles\"),\n+    (\"clippy::identity_conversion\", \"clippy::useless_conversion\"),\n+    (\"clippy::if_let_some_result\", \"clippy::match_result_ok\"),\n+    (\"clippy::new_without_default_derive\", \"clippy::new_without_default\"),\n+    (\"clippy::option_and_then_some\", \"clippy::bind_instead_of_map\"),\n+    (\"clippy::option_expect_used\", \"clippy::expect_used\"),\n+    (\"clippy::option_map_unwrap_or\", \"clippy::map_unwrap_or\"),\n+    (\"clippy::option_map_unwrap_or_else\", \"clippy::map_unwrap_or\"),\n+    (\"clippy::option_unwrap_used\", \"clippy::unwrap_used\"),\n+    (\"clippy::ref_in_deref\", \"clippy::needless_borrow\"),\n+    (\"clippy::result_expect_used\", \"clippy::expect_used\"),\n+    (\"clippy::result_map_unwrap_or_else\", \"clippy::map_unwrap_or\"),\n+    (\"clippy::result_unwrap_used\", \"clippy::unwrap_used\"),\n+    (\"clippy::single_char_push_str\", \"clippy::single_char_add_str\"),\n+    (\"clippy::stutter\", \"clippy::module_name_repetitions\"),\n+    (\"clippy::to_string_in_display\", \"clippy::recursive_format_impl\"),\n+    (\"clippy::zero_width_space\", \"clippy::invisible_characters\"),\n+    (\"clippy::drop_bounds\", \"drop_bounds\"),\n+    (\"clippy::into_iter_on_array\", \"array_into_iter\"),\n+    (\"clippy::invalid_atomic_ordering\", \"invalid_atomic_ordering\"),\n+    (\"clippy::invalid_ref\", \"invalid_value\"),\n+    (\"clippy::mem_discriminant_non_enum\", \"enum_intrinsics_non_enums\"),\n+    (\"clippy::panic_params\", \"non_fmt_panics\"),\n+    (\"clippy::temporary_cstring_as_ptr\", \"temporary_cstring_as_ptr\"),\n+    (\"clippy::unknown_clippy_lints\", \"unknown_lints\"),\n+    (\"clippy::unused_label\", \"unused_labels\"),\n+];"}, {"sha": "07270bd76362a1a8cf4eadc533d6c0e01465d259", "filename": "tests/ui/deprecated.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/32fe4762bf9e97db60a6405c736ec346dc7f5349/tests%2Fui%2Fdeprecated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/32fe4762bf9e97db60a6405c736ec346dc7f5349/tests%2Fui%2Fdeprecated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fdeprecated.rs?ref=32fe4762bf9e97db60a6405c736ec346dc7f5349", "patch": "@@ -1,3 +1,7 @@\n+// This file was generated by `cargo dev update_lints`.\n+// Use that command to update this file and do not edit by hand.\n+// Manual edits will be overwritten.\n+\n #![warn(clippy::should_assert_eq)]\n #![warn(clippy::extend_from_slice)]\n #![warn(clippy::range_step_by_zero)]"}, {"sha": "0e142ac8f20e7a3a83d0f1792f7363cb402be641", "filename": "tests/ui/deprecated.stderr", "status": "modified", "additions": 16, "deletions": 16, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/32fe4762bf9e97db60a6405c736ec346dc7f5349/tests%2Fui%2Fdeprecated.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/32fe4762bf9e97db60a6405c736ec346dc7f5349/tests%2Fui%2Fdeprecated.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fdeprecated.stderr?ref=32fe4762bf9e97db60a6405c736ec346dc7f5349", "patch": "@@ -1,97 +1,97 @@\n error: lint `clippy::should_assert_eq` has been removed: `assert!()` will be more flexible with RFC 2011\n-  --> $DIR/deprecated.rs:1:9\n+  --> $DIR/deprecated.rs:5:9\n    |\n LL | #![warn(clippy::should_assert_eq)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n    = note: `-D renamed-and-removed-lints` implied by `-D warnings`\n \n error: lint `clippy::extend_from_slice` has been removed: `.extend_from_slice(_)` is a faster way to extend a Vec by a slice\n-  --> $DIR/deprecated.rs:2:9\n+  --> $DIR/deprecated.rs:6:9\n    |\n LL | #![warn(clippy::extend_from_slice)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::range_step_by_zero` has been removed: `iterator.step_by(0)` panics nowadays\n-  --> $DIR/deprecated.rs:3:9\n+  --> $DIR/deprecated.rs:7:9\n    |\n LL | #![warn(clippy::range_step_by_zero)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::unstable_as_slice` has been removed: `Vec::as_slice` has been stabilized in 1.7\n-  --> $DIR/deprecated.rs:4:9\n+  --> $DIR/deprecated.rs:8:9\n    |\n LL | #![warn(clippy::unstable_as_slice)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::unstable_as_mut_slice` has been removed: `Vec::as_mut_slice` has been stabilized in 1.7\n-  --> $DIR/deprecated.rs:5:9\n+  --> $DIR/deprecated.rs:9:9\n    |\n LL | #![warn(clippy::unstable_as_mut_slice)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::misaligned_transmute` has been removed: this lint has been split into cast_ptr_alignment and transmute_ptr_to_ptr\n-  --> $DIR/deprecated.rs:6:9\n+  --> $DIR/deprecated.rs:10:9\n    |\n LL | #![warn(clippy::misaligned_transmute)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::assign_ops` has been removed: using compound assignment operators (e.g., `+=`) is harmless\n-  --> $DIR/deprecated.rs:7:9\n+  --> $DIR/deprecated.rs:11:9\n    |\n LL | #![warn(clippy::assign_ops)]\n    |         ^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::if_let_redundant_pattern_matching` has been removed: this lint has been changed to redundant_pattern_matching\n-  --> $DIR/deprecated.rs:8:9\n+  --> $DIR/deprecated.rs:12:9\n    |\n LL | #![warn(clippy::if_let_redundant_pattern_matching)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::unsafe_vector_initialization` has been removed: the replacement suggested by this lint had substantially different behavior\n-  --> $DIR/deprecated.rs:9:9\n+  --> $DIR/deprecated.rs:13:9\n    |\n LL | #![warn(clippy::unsafe_vector_initialization)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::unused_collect` has been removed: `collect` has been marked as #[must_use] in rustc and that covers all cases of this lint\n-  --> $DIR/deprecated.rs:10:9\n+  --> $DIR/deprecated.rs:14:9\n    |\n LL | #![warn(clippy::unused_collect)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::replace_consts` has been removed: associated-constants `MIN`/`MAX` of integers are preferred to `{min,max}_value()` and module constants\n-  --> $DIR/deprecated.rs:11:9\n+  --> $DIR/deprecated.rs:15:9\n    |\n LL | #![warn(clippy::replace_consts)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::regex_macro` has been removed: the regex! macro has been removed from the regex crate in 2018\n-  --> $DIR/deprecated.rs:12:9\n+  --> $DIR/deprecated.rs:16:9\n    |\n LL | #![warn(clippy::regex_macro)]\n    |         ^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::find_map` has been removed: this lint has been replaced by `manual_find_map`, a more specific lint\n-  --> $DIR/deprecated.rs:13:9\n+  --> $DIR/deprecated.rs:17:9\n    |\n LL | #![warn(clippy::find_map)]\n    |         ^^^^^^^^^^^^^^^^\n \n error: lint `clippy::filter_map` has been removed: this lint has been replaced by `manual_filter_map`, a more specific lint\n-  --> $DIR/deprecated.rs:14:9\n+  --> $DIR/deprecated.rs:18:9\n    |\n LL | #![warn(clippy::filter_map)]\n    |         ^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::pub_enum_variant_names` has been removed: set the `avoid-breaking-exported-api` config option to `false` to enable the `enum_variant_names` lint for public items\n-  --> $DIR/deprecated.rs:15:9\n+  --> $DIR/deprecated.rs:19:9\n    |\n LL | #![warn(clippy::pub_enum_variant_names)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::wrong_pub_self_convention` has been removed: set the `avoid-breaking-exported-api` config option to `false` to enable the `wrong_self_convention` lint for public items\n-  --> $DIR/deprecated.rs:16:9\n+  --> $DIR/deprecated.rs:20:9\n    |\n LL | #![warn(clippy::wrong_pub_self_convention)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"}, {"sha": "9c4079ad6d306a39a07518382598878b349d39f9", "filename": "tests/ui/rename.fixed", "status": "modified", "additions": 44, "deletions": 45, "changes": 89, "blob_url": "https://github.com/rust-lang/rust/blob/32fe4762bf9e97db60a6405c736ec346dc7f5349/tests%2Fui%2Frename.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/32fe4762bf9e97db60a6405c736ec346dc7f5349/tests%2Fui%2Frename.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frename.fixed?ref=32fe4762bf9e97db60a6405c736ec346dc7f5349", "patch": "@@ -1,71 +1,70 @@\n-//! Test for Clippy lint renames.\n+// This file was generated by `cargo dev update_lints`.\n+// Use that command to update this file and do not edit by hand.\n+// Manual edits will be overwritten.\n+\n // run-rustfix\n \n-#![allow(dead_code)]\n-// allow the new lint name here, to test if the new name works\n-#![allow(clippy::module_name_repetitions)]\n-#![allow(clippy::new_without_default)]\n+#![allow(clippy::blocks_in_if_conditions)]\n+#![allow(clippy::box_collection)]\n #![allow(clippy::redundant_static_lifetimes)]\n #![allow(clippy::cognitive_complexity)]\n+#![allow(clippy::disallowed_methods)]\n+#![allow(clippy::disallowed_types)]\n+#![allow(clippy::for_loops_over_fallibles)]\n+#![allow(clippy::useless_conversion)]\n+#![allow(clippy::match_result_ok)]\n+#![allow(clippy::new_without_default)]\n #![allow(clippy::bind_instead_of_map)]\n-#![allow(clippy::box_collection)]\n-#![allow(clippy::blocks_in_if_conditions)]\n+#![allow(clippy::expect_used)]\n #![allow(clippy::map_unwrap_or)]\n #![allow(clippy::unwrap_used)]\n-#![allow(clippy::expect_used)]\n-#![allow(clippy::for_loops_over_fallibles)]\n-#![allow(clippy::useless_conversion)]\n-#![allow(clippy::invisible_characters)]\n+#![allow(clippy::needless_borrow)]\n #![allow(clippy::single_char_add_str)]\n-#![allow(clippy::match_result_ok)]\n-#![allow(clippy::disallowed_types)]\n-#![allow(clippy::disallowed_methods)]\n+#![allow(clippy::module_name_repetitions)]\n #![allow(clippy::recursive_format_impl)]\n-// uplifted lints\n-#![allow(invalid_value)]\n-#![allow(array_into_iter)]\n-#![allow(unused_labels)]\n+#![allow(clippy::invisible_characters)]\n #![allow(drop_bounds)]\n-#![allow(temporary_cstring_as_ptr)]\n-#![allow(non_fmt_panics)]\n-#![allow(unknown_lints)]\n+#![allow(array_into_iter)]\n #![allow(invalid_atomic_ordering)]\n+#![allow(invalid_value)]\n #![allow(enum_intrinsics_non_enums)]\n-// warn for the old lint name here, to test if the renaming worked\n-#![warn(clippy::module_name_repetitions)]\n-#![warn(clippy::new_without_default)]\n+#![allow(non_fmt_panics)]\n+#![allow(temporary_cstring_as_ptr)]\n+#![allow(unknown_lints)]\n+#![allow(unused_labels)]\n+#![warn(clippy::blocks_in_if_conditions)]\n+#![warn(clippy::blocks_in_if_conditions)]\n+#![warn(clippy::box_collection)]\n #![warn(clippy::redundant_static_lifetimes)]\n #![warn(clippy::cognitive_complexity)]\n+#![warn(clippy::disallowed_methods)]\n+#![warn(clippy::disallowed_types)]\n+#![warn(clippy::for_loops_over_fallibles)]\n+#![warn(clippy::for_loops_over_fallibles)]\n+#![warn(clippy::useless_conversion)]\n+#![warn(clippy::match_result_ok)]\n+#![warn(clippy::new_without_default)]\n #![warn(clippy::bind_instead_of_map)]\n-#![warn(clippy::box_collection)]\n-#![warn(clippy::blocks_in_if_conditions)]\n-#![warn(clippy::blocks_in_if_conditions)]\n-#![warn(clippy::map_unwrap_or)]\n+#![warn(clippy::expect_used)]\n #![warn(clippy::map_unwrap_or)]\n #![warn(clippy::map_unwrap_or)]\n #![warn(clippy::unwrap_used)]\n-#![warn(clippy::unwrap_used)]\n-#![warn(clippy::expect_used)]\n+#![warn(clippy::needless_borrow)]\n #![warn(clippy::expect_used)]\n-#![warn(clippy::for_loops_over_fallibles)]\n-#![warn(clippy::for_loops_over_fallibles)]\n-#![warn(clippy::useless_conversion)]\n-#![warn(clippy::invisible_characters)]\n+#![warn(clippy::map_unwrap_or)]\n+#![warn(clippy::unwrap_used)]\n #![warn(clippy::single_char_add_str)]\n-#![warn(clippy::match_result_ok)]\n-#![warn(clippy::disallowed_types)]\n-#![warn(clippy::disallowed_methods)]\n-#![warn(clippy::needless_borrow)]\n+#![warn(clippy::module_name_repetitions)]\n #![warn(clippy::recursive_format_impl)]\n-// uplifted lints\n-#![warn(invalid_value)]\n-#![warn(array_into_iter)]\n-#![warn(unused_labels)]\n+#![warn(clippy::invisible_characters)]\n #![warn(drop_bounds)]\n-#![warn(temporary_cstring_as_ptr)]\n-#![warn(non_fmt_panics)]\n-#![warn(unknown_lints)]\n+#![warn(array_into_iter)]\n #![warn(invalid_atomic_ordering)]\n+#![warn(invalid_value)]\n #![warn(enum_intrinsics_non_enums)]\n+#![warn(non_fmt_panics)]\n+#![warn(temporary_cstring_as_ptr)]\n+#![warn(unknown_lints)]\n+#![warn(unused_labels)]\n \n fn main() {}"}, {"sha": "e83e66b7fbd4211dbfc80dd2c903a5fcb807ca94", "filename": "tests/ui/rename.rs", "status": "modified", "additions": 44, "deletions": 45, "changes": 89, "blob_url": "https://github.com/rust-lang/rust/blob/32fe4762bf9e97db60a6405c736ec346dc7f5349/tests%2Fui%2Frename.rs", "raw_url": "https://github.com/rust-lang/rust/raw/32fe4762bf9e97db60a6405c736ec346dc7f5349/tests%2Fui%2Frename.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frename.rs?ref=32fe4762bf9e97db60a6405c736ec346dc7f5349", "patch": "@@ -1,71 +1,70 @@\n-//! Test for Clippy lint renames.\n+// This file was generated by `cargo dev update_lints`.\n+// Use that command to update this file and do not edit by hand.\n+// Manual edits will be overwritten.\n+\n // run-rustfix\n \n-#![allow(dead_code)]\n-// allow the new lint name here, to test if the new name works\n-#![allow(clippy::module_name_repetitions)]\n-#![allow(clippy::new_without_default)]\n+#![allow(clippy::blocks_in_if_conditions)]\n+#![allow(clippy::box_collection)]\n #![allow(clippy::redundant_static_lifetimes)]\n #![allow(clippy::cognitive_complexity)]\n+#![allow(clippy::disallowed_methods)]\n+#![allow(clippy::disallowed_types)]\n+#![allow(clippy::for_loops_over_fallibles)]\n+#![allow(clippy::useless_conversion)]\n+#![allow(clippy::match_result_ok)]\n+#![allow(clippy::new_without_default)]\n #![allow(clippy::bind_instead_of_map)]\n-#![allow(clippy::box_collection)]\n-#![allow(clippy::blocks_in_if_conditions)]\n+#![allow(clippy::expect_used)]\n #![allow(clippy::map_unwrap_or)]\n #![allow(clippy::unwrap_used)]\n-#![allow(clippy::expect_used)]\n-#![allow(clippy::for_loops_over_fallibles)]\n-#![allow(clippy::useless_conversion)]\n-#![allow(clippy::invisible_characters)]\n+#![allow(clippy::needless_borrow)]\n #![allow(clippy::single_char_add_str)]\n-#![allow(clippy::match_result_ok)]\n-#![allow(clippy::disallowed_types)]\n-#![allow(clippy::disallowed_methods)]\n+#![allow(clippy::module_name_repetitions)]\n #![allow(clippy::recursive_format_impl)]\n-// uplifted lints\n-#![allow(invalid_value)]\n-#![allow(array_into_iter)]\n-#![allow(unused_labels)]\n+#![allow(clippy::invisible_characters)]\n #![allow(drop_bounds)]\n-#![allow(temporary_cstring_as_ptr)]\n-#![allow(non_fmt_panics)]\n-#![allow(unknown_lints)]\n+#![allow(array_into_iter)]\n #![allow(invalid_atomic_ordering)]\n+#![allow(invalid_value)]\n #![allow(enum_intrinsics_non_enums)]\n-// warn for the old lint name here, to test if the renaming worked\n-#![warn(clippy::stutter)]\n-#![warn(clippy::new_without_default_derive)]\n+#![allow(non_fmt_panics)]\n+#![allow(temporary_cstring_as_ptr)]\n+#![allow(unknown_lints)]\n+#![allow(unused_labels)]\n+#![warn(clippy::block_in_if_condition_expr)]\n+#![warn(clippy::block_in_if_condition_stmt)]\n+#![warn(clippy::box_vec)]\n #![warn(clippy::const_static_lifetime)]\n #![warn(clippy::cyclomatic_complexity)]\n+#![warn(clippy::disallowed_method)]\n+#![warn(clippy::disallowed_type)]\n+#![warn(clippy::for_loop_over_option)]\n+#![warn(clippy::for_loop_over_result)]\n+#![warn(clippy::identity_conversion)]\n+#![warn(clippy::if_let_some_result)]\n+#![warn(clippy::new_without_default_derive)]\n #![warn(clippy::option_and_then_some)]\n-#![warn(clippy::box_vec)]\n-#![warn(clippy::block_in_if_condition_expr)]\n-#![warn(clippy::block_in_if_condition_stmt)]\n+#![warn(clippy::option_expect_used)]\n #![warn(clippy::option_map_unwrap_or)]\n #![warn(clippy::option_map_unwrap_or_else)]\n-#![warn(clippy::result_map_unwrap_or_else)]\n #![warn(clippy::option_unwrap_used)]\n-#![warn(clippy::result_unwrap_used)]\n-#![warn(clippy::option_expect_used)]\n+#![warn(clippy::ref_in_deref)]\n #![warn(clippy::result_expect_used)]\n-#![warn(clippy::for_loop_over_option)]\n-#![warn(clippy::for_loop_over_result)]\n-#![warn(clippy::identity_conversion)]\n-#![warn(clippy::zero_width_space)]\n+#![warn(clippy::result_map_unwrap_or_else)]\n+#![warn(clippy::result_unwrap_used)]\n #![warn(clippy::single_char_push_str)]\n-#![warn(clippy::if_let_some_result)]\n-#![warn(clippy::disallowed_type)]\n-#![warn(clippy::disallowed_method)]\n-#![warn(clippy::ref_in_deref)]\n+#![warn(clippy::stutter)]\n #![warn(clippy::to_string_in_display)]\n-// uplifted lints\n-#![warn(clippy::invalid_ref)]\n-#![warn(clippy::into_iter_on_array)]\n-#![warn(clippy::unused_label)]\n+#![warn(clippy::zero_width_space)]\n #![warn(clippy::drop_bounds)]\n-#![warn(clippy::temporary_cstring_as_ptr)]\n-#![warn(clippy::panic_params)]\n-#![warn(clippy::unknown_clippy_lints)]\n+#![warn(clippy::into_iter_on_array)]\n #![warn(clippy::invalid_atomic_ordering)]\n+#![warn(clippy::invalid_ref)]\n #![warn(clippy::mem_discriminant_non_enum)]\n+#![warn(clippy::panic_params)]\n+#![warn(clippy::temporary_cstring_as_ptr)]\n+#![warn(clippy::unknown_clippy_lints)]\n+#![warn(clippy::unused_label)]\n \n fn main() {}"}, {"sha": "f811b10d017104220a46575d3aa7d4af4ce9f827", "filename": "tests/ui/rename.stderr", "status": "modified", "additions": 97, "deletions": 97, "changes": 194, "blob_url": "https://github.com/rust-lang/rust/blob/32fe4762bf9e97db60a6405c736ec346dc7f5349/tests%2Fui%2Frename.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/32fe4762bf9e97db60a6405c736ec346dc7f5349/tests%2Fui%2Frename.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frename.stderr?ref=32fe4762bf9e97db60a6405c736ec346dc7f5349", "patch": "@@ -1,208 +1,208 @@\n-error: lint `clippy::stutter` has been renamed to `clippy::module_name_repetitions`\n+error: lint `clippy::block_in_if_condition_expr` has been renamed to `clippy::blocks_in_if_conditions`\n   --> $DIR/rename.rs:35:9\n    |\n-LL | #![warn(clippy::stutter)]\n-   |         ^^^^^^^^^^^^^^^ help: use the new name: `clippy::module_name_repetitions`\n+LL | #![warn(clippy::block_in_if_condition_expr)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::blocks_in_if_conditions`\n    |\n    = note: `-D renamed-and-removed-lints` implied by `-D warnings`\n \n-error: lint `clippy::new_without_default_derive` has been renamed to `clippy::new_without_default`\n+error: lint `clippy::block_in_if_condition_stmt` has been renamed to `clippy::blocks_in_if_conditions`\n   --> $DIR/rename.rs:36:9\n    |\n-LL | #![warn(clippy::new_without_default_derive)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::new_without_default`\n+LL | #![warn(clippy::block_in_if_condition_stmt)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::blocks_in_if_conditions`\n \n-error: lint `clippy::const_static_lifetime` has been renamed to `clippy::redundant_static_lifetimes`\n+error: lint `clippy::box_vec` has been renamed to `clippy::box_collection`\n   --> $DIR/rename.rs:37:9\n    |\n+LL | #![warn(clippy::box_vec)]\n+   |         ^^^^^^^^^^^^^^^ help: use the new name: `clippy::box_collection`\n+\n+error: lint `clippy::const_static_lifetime` has been renamed to `clippy::redundant_static_lifetimes`\n+  --> $DIR/rename.rs:38:9\n+   |\n LL | #![warn(clippy::const_static_lifetime)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::redundant_static_lifetimes`\n \n error: lint `clippy::cyclomatic_complexity` has been renamed to `clippy::cognitive_complexity`\n-  --> $DIR/rename.rs:38:9\n+  --> $DIR/rename.rs:39:9\n    |\n LL | #![warn(clippy::cyclomatic_complexity)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::cognitive_complexity`\n \n-error: lint `clippy::option_and_then_some` has been renamed to `clippy::bind_instead_of_map`\n-  --> $DIR/rename.rs:39:9\n-   |\n-LL | #![warn(clippy::option_and_then_some)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::bind_instead_of_map`\n-\n-error: lint `clippy::box_vec` has been renamed to `clippy::box_collection`\n+error: lint `clippy::disallowed_method` has been renamed to `clippy::disallowed_methods`\n   --> $DIR/rename.rs:40:9\n    |\n-LL | #![warn(clippy::box_vec)]\n-   |         ^^^^^^^^^^^^^^^ help: use the new name: `clippy::box_collection`\n+LL | #![warn(clippy::disallowed_method)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::disallowed_methods`\n \n-error: lint `clippy::block_in_if_condition_expr` has been renamed to `clippy::blocks_in_if_conditions`\n+error: lint `clippy::disallowed_type` has been renamed to `clippy::disallowed_types`\n   --> $DIR/rename.rs:41:9\n    |\n-LL | #![warn(clippy::block_in_if_condition_expr)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::blocks_in_if_conditions`\n+LL | #![warn(clippy::disallowed_type)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::disallowed_types`\n \n-error: lint `clippy::block_in_if_condition_stmt` has been renamed to `clippy::blocks_in_if_conditions`\n+error: lint `clippy::for_loop_over_option` has been renamed to `clippy::for_loops_over_fallibles`\n   --> $DIR/rename.rs:42:9\n    |\n-LL | #![warn(clippy::block_in_if_condition_stmt)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::blocks_in_if_conditions`\n+LL | #![warn(clippy::for_loop_over_option)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::for_loops_over_fallibles`\n \n-error: lint `clippy::option_map_unwrap_or` has been renamed to `clippy::map_unwrap_or`\n+error: lint `clippy::for_loop_over_result` has been renamed to `clippy::for_loops_over_fallibles`\n   --> $DIR/rename.rs:43:9\n    |\n-LL | #![warn(clippy::option_map_unwrap_or)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::map_unwrap_or`\n+LL | #![warn(clippy::for_loop_over_result)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::for_loops_over_fallibles`\n \n-error: lint `clippy::option_map_unwrap_or_else` has been renamed to `clippy::map_unwrap_or`\n+error: lint `clippy::identity_conversion` has been renamed to `clippy::useless_conversion`\n   --> $DIR/rename.rs:44:9\n    |\n-LL | #![warn(clippy::option_map_unwrap_or_else)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::map_unwrap_or`\n+LL | #![warn(clippy::identity_conversion)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::useless_conversion`\n \n-error: lint `clippy::result_map_unwrap_or_else` has been renamed to `clippy::map_unwrap_or`\n+error: lint `clippy::if_let_some_result` has been renamed to `clippy::match_result_ok`\n   --> $DIR/rename.rs:45:9\n    |\n-LL | #![warn(clippy::result_map_unwrap_or_else)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::map_unwrap_or`\n+LL | #![warn(clippy::if_let_some_result)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::match_result_ok`\n \n-error: lint `clippy::option_unwrap_used` has been renamed to `clippy::unwrap_used`\n+error: lint `clippy::new_without_default_derive` has been renamed to `clippy::new_without_default`\n   --> $DIR/rename.rs:46:9\n    |\n-LL | #![warn(clippy::option_unwrap_used)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::unwrap_used`\n+LL | #![warn(clippy::new_without_default_derive)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::new_without_default`\n \n-error: lint `clippy::result_unwrap_used` has been renamed to `clippy::unwrap_used`\n+error: lint `clippy::option_and_then_some` has been renamed to `clippy::bind_instead_of_map`\n   --> $DIR/rename.rs:47:9\n    |\n-LL | #![warn(clippy::result_unwrap_used)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::unwrap_used`\n+LL | #![warn(clippy::option_and_then_some)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::bind_instead_of_map`\n \n error: lint `clippy::option_expect_used` has been renamed to `clippy::expect_used`\n   --> $DIR/rename.rs:48:9\n    |\n LL | #![warn(clippy::option_expect_used)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::expect_used`\n \n-error: lint `clippy::result_expect_used` has been renamed to `clippy::expect_used`\n+error: lint `clippy::option_map_unwrap_or` has been renamed to `clippy::map_unwrap_or`\n   --> $DIR/rename.rs:49:9\n    |\n-LL | #![warn(clippy::result_expect_used)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::expect_used`\n+LL | #![warn(clippy::option_map_unwrap_or)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::map_unwrap_or`\n \n-error: lint `clippy::for_loop_over_option` has been renamed to `clippy::for_loops_over_fallibles`\n+error: lint `clippy::option_map_unwrap_or_else` has been renamed to `clippy::map_unwrap_or`\n   --> $DIR/rename.rs:50:9\n    |\n-LL | #![warn(clippy::for_loop_over_option)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::for_loops_over_fallibles`\n+LL | #![warn(clippy::option_map_unwrap_or_else)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::map_unwrap_or`\n \n-error: lint `clippy::for_loop_over_result` has been renamed to `clippy::for_loops_over_fallibles`\n+error: lint `clippy::option_unwrap_used` has been renamed to `clippy::unwrap_used`\n   --> $DIR/rename.rs:51:9\n    |\n-LL | #![warn(clippy::for_loop_over_result)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::for_loops_over_fallibles`\n+LL | #![warn(clippy::option_unwrap_used)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::unwrap_used`\n \n-error: lint `clippy::identity_conversion` has been renamed to `clippy::useless_conversion`\n+error: lint `clippy::ref_in_deref` has been renamed to `clippy::needless_borrow`\n   --> $DIR/rename.rs:52:9\n    |\n-LL | #![warn(clippy::identity_conversion)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::useless_conversion`\n+LL | #![warn(clippy::ref_in_deref)]\n+   |         ^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::needless_borrow`\n \n-error: lint `clippy::zero_width_space` has been renamed to `clippy::invisible_characters`\n+error: lint `clippy::result_expect_used` has been renamed to `clippy::expect_used`\n   --> $DIR/rename.rs:53:9\n    |\n-LL | #![warn(clippy::zero_width_space)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::invisible_characters`\n+LL | #![warn(clippy::result_expect_used)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::expect_used`\n \n-error: lint `clippy::single_char_push_str` has been renamed to `clippy::single_char_add_str`\n+error: lint `clippy::result_map_unwrap_or_else` has been renamed to `clippy::map_unwrap_or`\n   --> $DIR/rename.rs:54:9\n    |\n-LL | #![warn(clippy::single_char_push_str)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::single_char_add_str`\n+LL | #![warn(clippy::result_map_unwrap_or_else)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::map_unwrap_or`\n \n-error: lint `clippy::if_let_some_result` has been renamed to `clippy::match_result_ok`\n+error: lint `clippy::result_unwrap_used` has been renamed to `clippy::unwrap_used`\n   --> $DIR/rename.rs:55:9\n    |\n-LL | #![warn(clippy::if_let_some_result)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::match_result_ok`\n+LL | #![warn(clippy::result_unwrap_used)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::unwrap_used`\n \n-error: lint `clippy::disallowed_type` has been renamed to `clippy::disallowed_types`\n+error: lint `clippy::single_char_push_str` has been renamed to `clippy::single_char_add_str`\n   --> $DIR/rename.rs:56:9\n    |\n-LL | #![warn(clippy::disallowed_type)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::disallowed_types`\n+LL | #![warn(clippy::single_char_push_str)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::single_char_add_str`\n \n-error: lint `clippy::disallowed_method` has been renamed to `clippy::disallowed_methods`\n+error: lint `clippy::stutter` has been renamed to `clippy::module_name_repetitions`\n   --> $DIR/rename.rs:57:9\n    |\n-LL | #![warn(clippy::disallowed_method)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::disallowed_methods`\n+LL | #![warn(clippy::stutter)]\n+   |         ^^^^^^^^^^^^^^^ help: use the new name: `clippy::module_name_repetitions`\n \n-error: lint `clippy::ref_in_deref` has been renamed to `clippy::needless_borrow`\n+error: lint `clippy::to_string_in_display` has been renamed to `clippy::recursive_format_impl`\n   --> $DIR/rename.rs:58:9\n    |\n-LL | #![warn(clippy::ref_in_deref)]\n-   |         ^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::needless_borrow`\n+LL | #![warn(clippy::to_string_in_display)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::recursive_format_impl`\n \n-error: lint `clippy::to_string_in_display` has been renamed to `clippy::recursive_format_impl`\n+error: lint `clippy::zero_width_space` has been renamed to `clippy::invisible_characters`\n   --> $DIR/rename.rs:59:9\n    |\n-LL | #![warn(clippy::to_string_in_display)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::recursive_format_impl`\n+LL | #![warn(clippy::zero_width_space)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `clippy::invisible_characters`\n \n-error: lint `clippy::invalid_ref` has been renamed to `invalid_value`\n-  --> $DIR/rename.rs:61:9\n+error: lint `clippy::drop_bounds` has been renamed to `drop_bounds`\n+  --> $DIR/rename.rs:60:9\n    |\n-LL | #![warn(clippy::invalid_ref)]\n-   |         ^^^^^^^^^^^^^^^^^^^ help: use the new name: `invalid_value`\n+LL | #![warn(clippy::drop_bounds)]\n+   |         ^^^^^^^^^^^^^^^^^^^ help: use the new name: `drop_bounds`\n \n error: lint `clippy::into_iter_on_array` has been renamed to `array_into_iter`\n-  --> $DIR/rename.rs:62:9\n+  --> $DIR/rename.rs:61:9\n    |\n LL | #![warn(clippy::into_iter_on_array)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `array_into_iter`\n \n-error: lint `clippy::unused_label` has been renamed to `unused_labels`\n+error: lint `clippy::invalid_atomic_ordering` has been renamed to `invalid_atomic_ordering`\n+  --> $DIR/rename.rs:62:9\n+   |\n+LL | #![warn(clippy::invalid_atomic_ordering)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `invalid_atomic_ordering`\n+\n+error: lint `clippy::invalid_ref` has been renamed to `invalid_value`\n   --> $DIR/rename.rs:63:9\n    |\n-LL | #![warn(clippy::unused_label)]\n-   |         ^^^^^^^^^^^^^^^^^^^^ help: use the new name: `unused_labels`\n+LL | #![warn(clippy::invalid_ref)]\n+   |         ^^^^^^^^^^^^^^^^^^^ help: use the new name: `invalid_value`\n \n-error: lint `clippy::drop_bounds` has been renamed to `drop_bounds`\n+error: lint `clippy::mem_discriminant_non_enum` has been renamed to `enum_intrinsics_non_enums`\n   --> $DIR/rename.rs:64:9\n    |\n-LL | #![warn(clippy::drop_bounds)]\n-   |         ^^^^^^^^^^^^^^^^^^^ help: use the new name: `drop_bounds`\n+LL | #![warn(clippy::mem_discriminant_non_enum)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `enum_intrinsics_non_enums`\n \n-error: lint `clippy::temporary_cstring_as_ptr` has been renamed to `temporary_cstring_as_ptr`\n+error: lint `clippy::panic_params` has been renamed to `non_fmt_panics`\n   --> $DIR/rename.rs:65:9\n    |\n-LL | #![warn(clippy::temporary_cstring_as_ptr)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `temporary_cstring_as_ptr`\n+LL | #![warn(clippy::panic_params)]\n+   |         ^^^^^^^^^^^^^^^^^^^^ help: use the new name: `non_fmt_panics`\n \n-error: lint `clippy::panic_params` has been renamed to `non_fmt_panics`\n+error: lint `clippy::temporary_cstring_as_ptr` has been renamed to `temporary_cstring_as_ptr`\n   --> $DIR/rename.rs:66:9\n    |\n-LL | #![warn(clippy::panic_params)]\n-   |         ^^^^^^^^^^^^^^^^^^^^ help: use the new name: `non_fmt_panics`\n+LL | #![warn(clippy::temporary_cstring_as_ptr)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `temporary_cstring_as_ptr`\n \n error: lint `clippy::unknown_clippy_lints` has been renamed to `unknown_lints`\n   --> $DIR/rename.rs:67:9\n    |\n LL | #![warn(clippy::unknown_clippy_lints)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `unknown_lints`\n \n-error: lint `clippy::invalid_atomic_ordering` has been renamed to `invalid_atomic_ordering`\n+error: lint `clippy::unused_label` has been renamed to `unused_labels`\n   --> $DIR/rename.rs:68:9\n    |\n-LL | #![warn(clippy::invalid_atomic_ordering)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `invalid_atomic_ordering`\n-\n-error: lint `clippy::mem_discriminant_non_enum` has been renamed to `enum_intrinsics_non_enums`\n-  --> $DIR/rename.rs:69:9\n-   |\n-LL | #![warn(clippy::mem_discriminant_non_enum)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use the new name: `enum_intrinsics_non_enums`\n+LL | #![warn(clippy::unused_label)]\n+   |         ^^^^^^^^^^^^^^^^^^^^ help: use the new name: `unused_labels`\n \n error: aborting due to 34 previous errors\n "}]}