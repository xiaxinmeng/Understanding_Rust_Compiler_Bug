{"sha": "48c7bc17c68032d142dd6ce53b8f5933d52c2165", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ4YzdiYzE3YzY4MDMyZDE0MmRkNmNlNTNiOGY1OTMzZDUyYzIxNjU=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2013-06-11T19:36:42Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2013-06-11T19:36:42Z"}, "message": "rustc: Remove task type defs from trans", "tree": {"sha": "ed167efbff95578f45655a1aa2a0656467ba60e2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ed167efbff95578f45655a1aa2a0656467ba60e2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/48c7bc17c68032d142dd6ce53b8f5933d52c2165", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/48c7bc17c68032d142dd6ce53b8f5933d52c2165", "html_url": "https://github.com/rust-lang/rust/commit/48c7bc17c68032d142dd6ce53b8f5933d52c2165", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/48c7bc17c68032d142dd6ce53b8f5933d52c2165/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d1d855993d0386fc13ad1b74df565b5ba6f6e4ea", "url": "https://api.github.com/repos/rust-lang/rust/commits/d1d855993d0386fc13ad1b74df565b5ba6f6e4ea", "html_url": "https://github.com/rust-lang/rust/commit/d1d855993d0386fc13ad1b74df565b5ba6f6e4ea"}], "stats": {"total": 29, "additions": 0, "deletions": 29}, "files": [{"sha": "210daed51b09b44f83fe15eb087c07d64f167fb7", "filename": "src/librustc/middle/trans/base.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/48c7bc17c68032d142dd6ce53b8f5933d52c2165/src%2Flibrustc%2Fmiddle%2Ftrans%2Fbase.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48c7bc17c68032d142dd6ce53b8f5933d52c2165/src%2Flibrustc%2Fmiddle%2Ftrans%2Fbase.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Ftrans%2Fbase.rs?ref=48c7bc17c68032d142dd6ce53b8f5933d52c2165", "patch": "@@ -3064,9 +3064,6 @@ pub fn trans_crate(sess: session::Session,\n         }\n         let int_type = T_int(targ_cfg);\n         let float_type = T_float(targ_cfg);\n-        let task_type = T_task(targ_cfg);\n-        let taskptr_type = T_ptr(task_type);\n-        lib::llvm::associate_type(tn, @\"taskptr\", taskptr_type);\n         let tydesc_type = T_tydesc(targ_cfg);\n         lib::llvm::associate_type(tn, @\"tydesc\", tydesc_type);\n         let crate_map = decl_crate_map(sess, link_meta, llmod);\n@@ -3131,7 +3128,6 @@ pub fn trans_crate(sess: session::Session,\n               tydesc_type: tydesc_type,\n               int_type: int_type,\n               float_type: float_type,\n-              task_type: task_type,\n               opaque_vec_type: T_opaque_vec(targ_cfg),\n               builder: BuilderRef_res(unsafe { llvm::LLVMCreateBuilder() }),\n               shape_cx: mk_ctxt(llmod),"}, {"sha": "e0ba743f9139e6664305d68cf2df89a89d279f5b", "filename": "src/librustc/middle/trans/common.rs", "status": "modified", "additions": 0, "deletions": 25, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/48c7bc17c68032d142dd6ce53b8f5933d52c2165/src%2Flibrustc%2Fmiddle%2Ftrans%2Fcommon.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48c7bc17c68032d142dd6ce53b8f5933d52c2165/src%2Flibrustc%2Fmiddle%2Ftrans%2Fcommon.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Ftrans%2Fcommon.rs?ref=48c7bc17c68032d142dd6ce53b8f5933d52c2165", "patch": "@@ -221,7 +221,6 @@ pub struct CrateContext {\n      tydesc_type: TypeRef,\n      int_type: TypeRef,\n      float_type: TypeRef,\n-     task_type: TypeRef,\n      opaque_vec_type: TypeRef,\n      builder: BuilderRef_res,\n      shape_cx: shape::Ctxt,\n@@ -934,28 +933,6 @@ pub fn T_empty_struct() -> TypeRef { return T_struct([], false); }\n // they are described by this opaque type.\n pub fn T_vtable() -> TypeRef { T_array(T_ptr(T_i8()), 1u) }\n \n-pub fn T_task(targ_cfg: @session::config) -> TypeRef {\n-    let t = T_named_struct(\"task\");\n-\n-    // Refcount\n-    // Delegate pointer\n-    // Stack segment pointer\n-    // Runtime SP\n-    // Rust SP\n-    // GC chain\n-\n-\n-    // Domain pointer\n-    // Crate cache pointer\n-\n-    let t_int = T_int(targ_cfg);\n-    let elems =\n-        ~[t_int, t_int, t_int, t_int,\n-         t_int, t_int, t_int, t_int];\n-    set_struct_body(t, elems, false);\n-    return t;\n-}\n-\n pub fn T_tydesc_field(cx: @CrateContext, field: uint) -> TypeRef {\n     // Bit of a kludge: pick the fn typeref out of the tydesc..\n \n@@ -1085,8 +1062,6 @@ pub fn T_chan(cx: @CrateContext, _t: TypeRef) -> TypeRef {\n \n }\n \n-pub fn T_taskptr(cx: @CrateContext) -> TypeRef { return T_ptr(cx.task_type); }\n-\n \n pub fn T_opaque_cbox_ptr(cx: @CrateContext) -> TypeRef {\n     // closures look like boxes (even when they are ~fn or &fn)"}]}