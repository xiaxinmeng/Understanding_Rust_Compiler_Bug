{"sha": "b183612610c6383861f9c983a10588124800bac7", "node_id": "C_kwDOAAsO6NoAKGIxODM2MTI2MTBjNjM4Mzg2MWY5Yzk4M2ExMDU4ODEyNDgwMGJhYzc", "commit": {"author": {"name": "Ryo Yoshida", "email": "low.ryoshida@gmail.com", "date": "2023-01-05T11:19:46Z"}, "committer": {"name": "Ryo Yoshida", "email": "low.ryoshida@gmail.com", "date": "2023-01-05T14:10:06Z"}, "message": "Add `INTEGER` and `FLOAT` flags for type variables", "tree": {"sha": "2d2800b685407d8db5795b4fa6c6c15aa5dacf07", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2d2800b685407d8db5795b4fa6c6c15aa5dacf07"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b183612610c6383861f9c983a10588124800bac7", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEkSbsQIURluxz4rzf4laYqTBYYXEFAmO22j4ACgkQ4laYqTBY\nYXFO+Q//V+ux33wHy9hxkOYWdFdAkHjQk4xwV4gGClX/ggPtpSAcUB1F533Ub2Iz\nnhCAIwD+ldWm22gdXZhTkp79VqrnyAGMvk/nOB2PEur3St8sVhG7DLDdd6FEWc0J\npiQ1y8e/J1bz+Jb0ZULMQV8FgcfW76ig6pKV8qXrwy/PFGLTWLAj4Z5DGN7e8dVA\nlzWcBluMGFWbDJAk0uh08wb5SmlTuCDlHvLfAo6sWyP92iKxSVaBw2KxeFQNpJx0\nbw+3wkDW5xNn+EIGM1Cbggi89CUP7KOiEHLGsgyNmXor70jbRg1XfzJt/ul9t0Cd\nSKJfp/79DtpYvayuRM1e+4x8i+THCfTj8nwrs/retFUek9fotAPCLaqQKFB3kyN+\nr/vynUUkZi4hGMqJYpIO/68iZupWFsier2jT7UtXLpRQDg4PLDkJzrWFDuJ9rSii\nfLpF2Wz0KB3lXpK28QcAqvnVxXagE5GGalg9kqzW8vMQ6KfGeypqQ9M+jTHvt5IS\nOevDhMYDMDYQc3GZk7tVVXZCjsTkl6JvNWo4OX/mJQlc9roSV6AsJStmcbj6uCOB\nA7qU19BJ/jYCFKpgSliBIyEYjnrbg4+wpMiD3/pmiMhb9IqnENU3HKhu9gGS2iGV\nD/XGwfCGI/Snkk1f4rcN5UmSQNZGs2FYeBOr1iRlEQRbiBHl978=\n=wCmH\n-----END PGP SIGNATURE-----", "payload": "tree 2d2800b685407d8db5795b4fa6c6c15aa5dacf07\nparent 1bfc732b78aa1664245009c1d40d47d9ac149e94\nauthor Ryo Yoshida <low.ryoshida@gmail.com> 1672917586 +0900\ncommitter Ryo Yoshida <low.ryoshida@gmail.com> 1672927806 +0900\n\nAdd `INTEGER` and `FLOAT` flags for type variables\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b183612610c6383861f9c983a10588124800bac7", "html_url": "https://github.com/rust-lang/rust/commit/b183612610c6383861f9c983a10588124800bac7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b183612610c6383861f9c983a10588124800bac7/comments", "author": {"login": "lowr", "id": 24381114, "node_id": "MDQ6VXNlcjI0MzgxMTE0", "avatar_url": "https://avatars.githubusercontent.com/u/24381114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lowr", "html_url": "https://github.com/lowr", "followers_url": "https://api.github.com/users/lowr/followers", "following_url": "https://api.github.com/users/lowr/following{/other_user}", "gists_url": "https://api.github.com/users/lowr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lowr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lowr/subscriptions", "organizations_url": "https://api.github.com/users/lowr/orgs", "repos_url": "https://api.github.com/users/lowr/repos", "events_url": "https://api.github.com/users/lowr/events{/privacy}", "received_events_url": "https://api.github.com/users/lowr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lowr", "id": 24381114, "node_id": "MDQ6VXNlcjI0MzgxMTE0", "avatar_url": "https://avatars.githubusercontent.com/u/24381114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lowr", "html_url": "https://github.com/lowr", "followers_url": "https://api.github.com/users/lowr/followers", "following_url": "https://api.github.com/users/lowr/following{/other_user}", "gists_url": "https://api.github.com/users/lowr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lowr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lowr/subscriptions", "organizations_url": "https://api.github.com/users/lowr/orgs", "repos_url": "https://api.github.com/users/lowr/repos", "events_url": "https://api.github.com/users/lowr/events{/privacy}", "received_events_url": "https://api.github.com/users/lowr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1bfc732b78aa1664245009c1d40d47d9ac149e94", "url": "https://api.github.com/repos/rust-lang/rust/commits/1bfc732b78aa1664245009c1d40d47d9ac149e94", "html_url": "https://github.com/rust-lang/rust/commit/1bfc732b78aa1664245009c1d40d47d9ac149e94"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "a1fef48f25a8e646e6d7c5447f9008576390f08d", "filename": "crates/hir-ty/src/infer/unify.rs", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/b183612610c6383861f9c983a10588124800bac7/crates%2Fhir-ty%2Fsrc%2Finfer%2Funify.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b183612610c6383861f9c983a10588124800bac7/crates%2Fhir-ty%2Fsrc%2Finfer%2Funify.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir-ty%2Fsrc%2Finfer%2Funify.rs?ref=b183612610c6383861f9c983a10588124800bac7", "patch": "@@ -132,6 +132,8 @@ bitflags::bitflags! {\n     #[derive(Default)]\n     pub(crate) struct TypeVariableFlags: u8 {\n         const DIVERGING = 1 << 0;\n+        const INTEGER = 1 << 1;\n+        const FLOAT = 1 << 2;\n     }\n }\n \n@@ -258,8 +260,14 @@ impl<'a> InferenceTable<'a> {\n         // Chalk might have created some type variables for its own purposes that we don't know about...\n         self.extend_type_variable_table(var.index() as usize);\n         assert_eq!(var.index() as usize, self.type_variable_table.len() - 1);\n+        let flags = self.type_variable_table.get_mut(var.index() as usize).unwrap();\n         if diverging {\n-            self.type_variable_table[var.index() as usize] |= TypeVariableFlags::DIVERGING;\n+            *flags |= TypeVariableFlags::DIVERGING;\n+        }\n+        if matches!(kind, TyVariableKind::Integer) {\n+            *flags |= TypeVariableFlags::INTEGER;\n+        } else if matches!(kind, TyVariableKind::Float) {\n+            *flags |= TypeVariableFlags::FLOAT;\n         }\n         var.to_ty_with_kind(Interner, kind)\n     }"}]}