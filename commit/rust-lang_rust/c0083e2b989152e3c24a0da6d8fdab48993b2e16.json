{"sha": "c0083e2b989152e3c24a0da6d8fdab48993b2e16", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMwMDgzZTJiOTg5MTUyZTNjMjRhMGRhNmQ4ZmRhYjQ4OTkzYjJlMTY=", "commit": {"author": {"name": "Wilco Kusee", "email": "wilcokusee@gmail.com", "date": "2019-01-13T10:44:45Z"}, "committer": {"name": "Wilco Kusee", "email": "wilcokusee@gmail.com", "date": "2019-01-13T10:44:45Z"}, "message": "Add run-rustfix to collapsible_if test", "tree": {"sha": "d7bc918e045355266b1ec56cc12ee03e4bee251b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d7bc918e045355266b1ec56cc12ee03e4bee251b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c0083e2b989152e3c24a0da6d8fdab48993b2e16", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c0083e2b989152e3c24a0da6d8fdab48993b2e16", "html_url": "https://github.com/rust-lang/rust/commit/c0083e2b989152e3c24a0da6d8fdab48993b2e16", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c0083e2b989152e3c24a0da6d8fdab48993b2e16/comments", "author": {"login": "detrumi", "id": 5758008, "node_id": "MDQ6VXNlcjU3NTgwMDg=", "avatar_url": "https://avatars.githubusercontent.com/u/5758008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/detrumi", "html_url": "https://github.com/detrumi", "followers_url": "https://api.github.com/users/detrumi/followers", "following_url": "https://api.github.com/users/detrumi/following{/other_user}", "gists_url": "https://api.github.com/users/detrumi/gists{/gist_id}", "starred_url": "https://api.github.com/users/detrumi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/detrumi/subscriptions", "organizations_url": "https://api.github.com/users/detrumi/orgs", "repos_url": "https://api.github.com/users/detrumi/repos", "events_url": "https://api.github.com/users/detrumi/events{/privacy}", "received_events_url": "https://api.github.com/users/detrumi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "detrumi", "id": 5758008, "node_id": "MDQ6VXNlcjU3NTgwMDg=", "avatar_url": "https://avatars.githubusercontent.com/u/5758008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/detrumi", "html_url": "https://github.com/detrumi", "followers_url": "https://api.github.com/users/detrumi/followers", "following_url": "https://api.github.com/users/detrumi/following{/other_user}", "gists_url": "https://api.github.com/users/detrumi/gists{/gist_id}", "starred_url": "https://api.github.com/users/detrumi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/detrumi/subscriptions", "organizations_url": "https://api.github.com/users/detrumi/orgs", "repos_url": "https://api.github.com/users/detrumi/repos", "events_url": "https://api.github.com/users/detrumi/events{/privacy}", "received_events_url": "https://api.github.com/users/detrumi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "91ef4e3ae7b8cb71ac7e4f2940e87c23434101ec", "url": "https://api.github.com/repos/rust-lang/rust/commits/91ef4e3ae7b8cb71ac7e4f2940e87c23434101ec", "html_url": "https://github.com/rust-lang/rust/commit/91ef4e3ae7b8cb71ac7e4f2940e87c23434101ec"}], "stats": {"total": 206, "additions": 192, "deletions": 14}, "files": [{"sha": "2c6dd95a637990a03965fde79a6f0b2eedaccf93", "filename": "tests/ui/collapsible_if.fixed", "status": "added", "additions": 175, "deletions": 0, "changes": 175, "blob_url": "https://github.com/rust-lang/rust/blob/c0083e2b989152e3c24a0da6d8fdab48993b2e16/tests%2Fui%2Fcollapsible_if.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/c0083e2b989152e3c24a0da6d8fdab48993b2e16/tests%2Fui%2Fcollapsible_if.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcollapsible_if.fixed?ref=c0083e2b989152e3c24a0da6d8fdab48993b2e16", "patch": "@@ -0,0 +1,175 @@\n+// run-rustfix\n+#![allow(clippy::cyclomatic_complexity)]\n+\n+#[rustfmt::skip]\n+#[warn(clippy::collapsible_if)]\n+fn main() {\n+    let x = \"hello\";\n+    let y = \"world\";\n+    if x == \"hello\" && y == \"world\" {\n+    println!(\"Hello world!\");\n+}\n+\n+    if (x == \"hello\" || x == \"world\") && (y == \"world\" || y == \"hello\") {\n+    println!(\"Hello world!\");\n+}\n+\n+    if x == \"hello\" && x == \"world\" && (y == \"world\" || y == \"hello\") {\n+    println!(\"Hello world!\");\n+}\n+\n+    if (x == \"hello\" || x == \"world\") && y == \"world\" && y == \"hello\" {\n+    println!(\"Hello world!\");\n+}\n+\n+    if x == \"hello\" && x == \"world\" && y == \"world\" && y == \"hello\" {\n+    println!(\"Hello world!\");\n+}\n+\n+    if 42 == 1337 && 'a' != 'A' {\n+    println!(\"world!\")\n+}\n+\n+    // Collapse `else { if .. }` to `else if ..`\n+    if x == \"hello\" {\n+        print!(\"Hello \");\n+    } else if y == \"world\" {\n+    println!(\"world!\")\n+}\n+\n+    if x == \"hello\" {\n+        print!(\"Hello \");\n+    } else if let Some(42) = Some(42) {\n+    println!(\"world!\")\n+}\n+\n+    if x == \"hello\" {\n+        print!(\"Hello \");\n+    } else if y == \"world\" {\n+    println!(\"world\")\n+}\n+else {\n+    println!(\"!\")\n+}\n+\n+    if x == \"hello\" {\n+        print!(\"Hello \");\n+    } else if let Some(42) = Some(42) {\n+    println!(\"world\")\n+}\n+else {\n+    println!(\"!\")\n+}\n+\n+    if let Some(42) = Some(42) {\n+        print!(\"Hello \");\n+    } else if let Some(42) = Some(42) {\n+    println!(\"world\")\n+}\n+else {\n+    println!(\"!\")\n+}\n+\n+    if let Some(42) = Some(42) {\n+        print!(\"Hello \");\n+    } else if x == \"hello\" {\n+    println!(\"world\")\n+}\n+else {\n+    println!(\"!\")\n+}\n+\n+    if let Some(42) = Some(42) {\n+        print!(\"Hello \");\n+    } else if let Some(42) = Some(42) {\n+    println!(\"world\")\n+}\n+else {\n+    println!(\"!\")\n+}\n+\n+    // Works because any if with an else statement cannot be collapsed.\n+    if x == \"hello\" {\n+        if y == \"world\" {\n+            println!(\"Hello world!\");\n+        }\n+    } else {\n+        println!(\"Not Hello world\");\n+    }\n+\n+    if x == \"hello\" {\n+        if y == \"world\" {\n+            println!(\"Hello world!\");\n+        } else {\n+            println!(\"Hello something else\");\n+        }\n+    }\n+\n+    if x == \"hello\" {\n+        print!(\"Hello \");\n+        if y == \"world\" {\n+            println!(\"world!\")\n+        }\n+    }\n+\n+    if true {\n+    } else {\n+        assert!(true); // assert! is just an `if`\n+    }\n+\n+\n+    // The following tests check for the fix of https://github.com/rust-lang/rust-clippy/issues/798\n+    if x == \"hello\" {// Not collapsible\n+        if y == \"world\" {\n+            println!(\"Hello world!\");\n+        }\n+    }\n+\n+    if x == \"hello\" { // Not collapsible\n+        if y == \"world\" {\n+            println!(\"Hello world!\");\n+        }\n+    }\n+\n+    if x == \"hello\" {\n+        // Not collapsible\n+        if y == \"world\" {\n+            println!(\"Hello world!\");\n+        }\n+    }\n+\n+    if x == \"hello\" && y == \"world\" { // Collapsible\n+    println!(\"Hello world!\");\n+}\n+\n+    if x == \"hello\" {\n+        print!(\"Hello \");\n+    } else {\n+        // Not collapsible\n+        if y == \"world\" {\n+            println!(\"world!\")\n+        }\n+    }\n+\n+    if x == \"hello\" {\n+        print!(\"Hello \");\n+    } else {\n+        // Not collapsible\n+        if let Some(42) = Some(42) {\n+            println!(\"world!\")\n+        }\n+    }\n+\n+    if x == \"hello\" {\n+        /* Not collapsible */\n+        if y == \"world\" {\n+            println!(\"Hello world!\");\n+        }\n+    }\n+\n+    if x == \"hello\" { /* Not collapsible */\n+        if y == \"world\" {\n+            println!(\"Hello world!\");\n+        }\n+    }\n+}"}, {"sha": "f482d7704def92b7103bc9dafb6251944feb84c2", "filename": "tests/ui/collapsible_if.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/c0083e2b989152e3c24a0da6d8fdab48993b2e16/tests%2Fui%2Fcollapsible_if.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c0083e2b989152e3c24a0da6d8fdab48993b2e16/tests%2Fui%2Fcollapsible_if.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcollapsible_if.rs?ref=c0083e2b989152e3c24a0da6d8fdab48993b2e16", "patch": "@@ -1,3 +1,6 @@\n+// run-rustfix\n+#![allow(clippy::cyclomatic_complexity)]\n+\n #[rustfmt::skip]\n #[warn(clippy::collapsible_if)]\n fn main() {"}, {"sha": "d6d0b9d5d4eaa276de835167837ef68718173354", "filename": "tests/ui/collapsible_if.stderr", "status": "modified", "additions": 14, "deletions": 14, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/c0083e2b989152e3c24a0da6d8fdab48993b2e16/tests%2Fui%2Fcollapsible_if.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c0083e2b989152e3c24a0da6d8fdab48993b2e16/tests%2Fui%2Fcollapsible_if.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcollapsible_if.stderr?ref=c0083e2b989152e3c24a0da6d8fdab48993b2e16", "patch": "@@ -1,5 +1,5 @@\n error: this if statement can be collapsed\n-  --> $DIR/collapsible_if.rs:6:5\n+  --> $DIR/collapsible_if.rs:9:5\n    |\n LL | /     if x == \"hello\" {\n LL | |         if y == \"world\" {\n@@ -17,7 +17,7 @@ LL | }\n    |\n \n error: this if statement can be collapsed\n-  --> $DIR/collapsible_if.rs:12:5\n+  --> $DIR/collapsible_if.rs:15:5\n    |\n LL | /     if x == \"hello\" || x == \"world\" {\n LL | |         if y == \"world\" || y == \"hello\" {\n@@ -33,7 +33,7 @@ LL | }\n    |\n \n error: this if statement can be collapsed\n-  --> $DIR/collapsible_if.rs:18:5\n+  --> $DIR/collapsible_if.rs:21:5\n    |\n LL | /     if x == \"hello\" && x == \"world\" {\n LL | |         if y == \"world\" || y == \"hello\" {\n@@ -49,7 +49,7 @@ LL | }\n    |\n \n error: this if statement can be collapsed\n-  --> $DIR/collapsible_if.rs:24:5\n+  --> $DIR/collapsible_if.rs:27:5\n    |\n LL | /     if x == \"hello\" || x == \"world\" {\n LL | |         if y == \"world\" && y == \"hello\" {\n@@ -65,7 +65,7 @@ LL | }\n    |\n \n error: this if statement can be collapsed\n-  --> $DIR/collapsible_if.rs:30:5\n+  --> $DIR/collapsible_if.rs:33:5\n    |\n LL | /     if x == \"hello\" && x == \"world\" {\n LL | |         if y == \"world\" && y == \"hello\" {\n@@ -81,7 +81,7 @@ LL | }\n    |\n \n error: this if statement can be collapsed\n-  --> $DIR/collapsible_if.rs:36:5\n+  --> $DIR/collapsible_if.rs:39:5\n    |\n LL | /     if 42 == 1337 {\n LL | |         if 'a' != 'A' {\n@@ -97,7 +97,7 @@ LL | }\n    |\n \n error: this `else { if .. }` block can be collapsed\n-  --> $DIR/collapsible_if.rs:45:12\n+  --> $DIR/collapsible_if.rs:48:12\n    |\n LL |       } else {\n    |  ____________^\n@@ -114,7 +114,7 @@ LL | }\n    |\n \n error: this `else { if .. }` block can be collapsed\n-  --> $DIR/collapsible_if.rs:53:12\n+  --> $DIR/collapsible_if.rs:56:12\n    |\n LL |       } else {\n    |  ____________^\n@@ -131,7 +131,7 @@ LL | }\n    |\n \n error: this `else { if .. }` block can be collapsed\n-  --> $DIR/collapsible_if.rs:61:12\n+  --> $DIR/collapsible_if.rs:64:12\n    |\n LL |       } else {\n    |  ____________^\n@@ -153,7 +153,7 @@ LL | }\n    |\n \n error: this `else { if .. }` block can be collapsed\n-  --> $DIR/collapsible_if.rs:72:12\n+  --> $DIR/collapsible_if.rs:75:12\n    |\n LL |       } else {\n    |  ____________^\n@@ -175,7 +175,7 @@ LL | }\n    |\n \n error: this `else { if .. }` block can be collapsed\n-  --> $DIR/collapsible_if.rs:83:12\n+  --> $DIR/collapsible_if.rs:86:12\n    |\n LL |       } else {\n    |  ____________^\n@@ -197,7 +197,7 @@ LL | }\n    |\n \n error: this `else { if .. }` block can be collapsed\n-  --> $DIR/collapsible_if.rs:94:12\n+  --> $DIR/collapsible_if.rs:97:12\n    |\n LL |       } else {\n    |  ____________^\n@@ -219,7 +219,7 @@ LL | }\n    |\n \n error: this `else { if .. }` block can be collapsed\n-  --> $DIR/collapsible_if.rs:105:12\n+  --> $DIR/collapsible_if.rs:108:12\n    |\n LL |       } else {\n    |  ____________^\n@@ -241,7 +241,7 @@ LL | }\n    |\n \n error: this if statement can be collapsed\n-  --> $DIR/collapsible_if.rs:164:5\n+  --> $DIR/collapsible_if.rs:167:5\n    |\n LL | /     if x == \"hello\" {\n LL | |         if y == \"world\" { // Collapsible"}]}