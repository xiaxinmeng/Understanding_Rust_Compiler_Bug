{"sha": "b63868dedb06a2637917ef2ee3fe96dc83ff9d50", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI2Mzg2OGRlZGIwNmEyNjM3OTE3ZWYyZWUzZmU5NmRjODNmZjlkNTA=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-05-06T09:49:00Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-05-06T09:49:00Z"}, "message": "Auto merge of #5566 - oli-obk:sync-from-rustc, r=flip1995\n\nUpdate to rustc changes\n\nchangelog: none\n\nSo, turns out `git subtree push` dies in various interesting ways, but the source cause is that the rustc repo looks like\n\n```\n--- A --- B --- C ---\n     \\--- D ---/\n```\n\nwhere `B` is the commit where I added clippy to rustc and `D` is an arbitrary other PR and `C` is the master branch (or an earlier commit in it). When we now do `git subtree push`, it doesn't stop looking for things to merge at `B` as it needs to look at `D`, too, but then the bad thing happens, and it doesn't stop at `A` either, and just goes on looking at the entire history of rustc in a recursive bash script. That recursion then quickly runs into a stack overflow. While we can increase the stack size via `ulimit -s 60000`, that just means I was waiting for 30 minutes looking at `git subtree push` counting up the number of commits it has looked at. I aborted that, as a process that needs 30 mins for a push is not reasonable.\n\nThis PR cheats by just doing a `cp -r ../rustc/src/tools/clippy/* .` inside my clippy checkout and committing all changes. I'm working on getting us a better workflow, but until then, this workaround will work nicely. Note that this requires a `git subrepo pull` to have occurred in the `rustc` checkout. It's not necessary to merge that pull in order to update clippy, it's just necessary in order to not revert code in the clippy repo that hasn't been synced yet to the rustc repo.", "tree": {"sha": "4fd100d7fd438b45a5ec002f6f05c23bee269655", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4fd100d7fd438b45a5ec002f6f05c23bee269655"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b63868dedb06a2637917ef2ee3fe96dc83ff9d50", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b63868dedb06a2637917ef2ee3fe96dc83ff9d50", "html_url": "https://github.com/rust-lang/rust/commit/b63868dedb06a2637917ef2ee3fe96dc83ff9d50", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b63868dedb06a2637917ef2ee3fe96dc83ff9d50/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "76ddac5e8e9f588fda939cf8ec116e5926419758", "url": "https://api.github.com/repos/rust-lang/rust/commits/76ddac5e8e9f588fda939cf8ec116e5926419758", "html_url": "https://github.com/rust-lang/rust/commit/76ddac5e8e9f588fda939cf8ec116e5926419758"}, {"sha": "780a63a1ba84597eaf33e4d546bcf0edd6225836", "url": "https://api.github.com/repos/rust-lang/rust/commits/780a63a1ba84597eaf33e4d546bcf0edd6225836", "html_url": "https://github.com/rust-lang/rust/commit/780a63a1ba84597eaf33e4d546bcf0edd6225836"}], "stats": {"total": 4, "additions": 1, "deletions": 3}, "files": [{"sha": "d563eb886ae7e6618dc4832ef3a91572c02c0029", "filename": "clippy_lints/src/redundant_clone.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b63868dedb06a2637917ef2ee3fe96dc83ff9d50/clippy_lints%2Fsrc%2Fredundant_clone.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b63868dedb06a2637917ef2ee3fe96dc83ff9d50/clippy_lints%2Fsrc%2Fredundant_clone.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fredundant_clone.rs?ref=b63868dedb06a2637917ef2ee3fe96dc83ff9d50", "patch": "@@ -591,7 +591,7 @@ struct PossibleBorrowerMap<'a, 'tcx> {\n impl PossibleBorrowerMap<'_, '_> {\n     /// Returns true if the set of borrowers of `borrowed` living at `at` matches with `borrowers`.\n     fn only_borrowers(&mut self, borrowers: &[mir::Local], borrowed: mir::Local, at: mir::Location) -> bool {\n-        self.maybe_live.seek_after(at);\n+        self.maybe_live.seek_after_primary_effect(at);\n \n         self.bitset.0.clear();\n         let maybe_live = &mut self.maybe_live;"}, {"sha": "bc785b075e0282641b3f095be8e6c4665398f198", "filename": "tests/ui/builtin-type-shadow.stderr", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b63868dedb06a2637917ef2ee3fe96dc83ff9d50/tests%2Fui%2Fbuiltin-type-shadow.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b63868dedb06a2637917ef2ee3fe96dc83ff9d50/tests%2Fui%2Fbuiltin-type-shadow.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fbuiltin-type-shadow.stderr?ref=b63868dedb06a2637917ef2ee3fe96dc83ff9d50", "patch": "@@ -18,8 +18,6 @@ LL |     42\n    |\n    = note: expected type parameter `u32`\n                         found type `{integer}`\n-   = help: type parameters must be constrained to match other types\n-   = note: for more information, visit https://doc.rust-lang.org/book/ch10-02-traits.html#traits-as-parameters\n \n error: aborting due to 2 previous errors\n "}]}