{"sha": "ef65542b1d9b80272e1f8c49db47b45622c10ef8", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVmNjU1NDJiMWQ5YjgwMjcyZTFmOGM0OWRiNDdiNDU2MjJjMTBlZjg=", "commit": {"author": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-06-18T23:05:44Z"}, "committer": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-06-18T23:05:44Z"}, "message": "test: Add test cases for ivec::init_elt, ivec::last, and ivec::slice", "tree": {"sha": "d75d1a8b7d04512fcb892015e9d169b98d78150f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d75d1a8b7d04512fcb892015e9d169b98d78150f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ef65542b1d9b80272e1f8c49db47b45622c10ef8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ef65542b1d9b80272e1f8c49db47b45622c10ef8", "html_url": "https://github.com/rust-lang/rust/commit/ef65542b1d9b80272e1f8c49db47b45622c10ef8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ef65542b1d9b80272e1f8c49db47b45622c10ef8/comments", "author": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2ba7729ae742d163e79cf47f9d6de4856ccb1bfa", "url": "https://api.github.com/repos/rust-lang/rust/commits/2ba7729ae742d163e79cf47f9d6de4856ccb1bfa", "html_url": "https://github.com/rust-lang/rust/commit/2ba7729ae742d163e79cf47f9d6de4856ccb1bfa"}], "stats": {"total": 59, "additions": 57, "deletions": 2}, "files": [{"sha": "4a0b30a37d1461a0437133c450972d99a0c4c9d8", "filename": "src/test/run-pass/lib-ivec.rs", "status": "modified", "additions": 57, "deletions": 2, "changes": 59, "blob_url": "https://github.com/rust-lang/rust/blob/ef65542b1d9b80272e1f8c49db47b45622c10ef8/src%2Ftest%2Frun-pass%2Flib-ivec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ef65542b1d9b80272e1f8c49db47b45622c10ef8/src%2Ftest%2Frun-pass%2Flib-ivec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Flib-ivec.rs?ref=ef65542b1d9b80272e1f8c49db47b45622c10ef8", "patch": "@@ -2,6 +2,8 @@\n \n use std;\n import std::ivec;\n+import std::option::none;\n+import std::option::some;\n \n fn test_reserve_and_on_heap() {\n     let int[] v = ~[ 1, 2 ];\n@@ -37,14 +39,14 @@ fn test_unsafe_ptrs() {\n fn test_init_fn() {\n     fn square(uint n) -> uint { ret n * n; }\n \n-    // Test on-stack init-fn.\n+    // Test on-stack init_fn.\n     auto v = ivec::init_fn(square, 3u);\n     assert (ivec::len(v) == 3u);\n     assert (v.(0) == 0u);\n     assert (v.(1) == 1u);\n     assert (v.(2) == 4u);\n \n-    // Test on-heap init-fn.\n+    // Test on-heap init_fn.\n     v = ivec::init_fn(square, 5u);\n     assert (ivec::len(v) == 5u);\n     assert (v.(0) == 0u);\n@@ -54,9 +56,62 @@ fn test_init_fn() {\n     assert (v.(4) == 16u);\n }\n \n+fn test_init_elt() {\n+    // Test on-stack init_elt.\n+    auto v = ivec::init_elt(10u, 2u);\n+    assert (ivec::len(v) == 2u);\n+    assert (v.(0) == 10u);\n+    assert (v.(1) == 10u);\n+\n+    // Test on-heap init_elt.\n+    v = ivec::init_elt(20u, 6u);\n+    assert (v.(0) == 20u);\n+    assert (v.(1) == 20u);\n+    assert (v.(2) == 20u);\n+    assert (v.(3) == 20u);\n+    assert (v.(4) == 20u);\n+    assert (v.(5) == 20u);\n+}\n+\n+fn test_last() {\n+    auto n = ivec::last(~[]);\n+    assert (n == none);\n+    n = ivec::last(~[ 1, 2, 3 ]);\n+    assert (n == some(3));\n+    n = ivec::last(~[ 1, 2, 3, 4, 5 ]);\n+    assert (n == some(5));\n+}\n+\n+fn test_slice() {\n+    // Test on-stack -> on-stack slice.\n+    auto v = ivec::slice(~[ 1, 2, 3 ], 1u, 3u);\n+    assert (ivec::len(v) == 2u);\n+    assert (v.(0) == 2);\n+    assert (v.(1) == 3);\n+\n+    // Test on-heap -> on-stack slice.\n+    v = ivec::slice(~[ 1, 2, 3, 4, 5 ], 0u, 3u);\n+    assert (ivec::len(v) == 3u);\n+    assert (v.(0) == 1);\n+    assert (v.(1) == 2);\n+    assert (v.(2) == 3);\n+\n+    // Test on-heap -> on-heap slice.\n+    v = ivec::slice(~[ 1, 2, 3, 4, 5, 6 ], 1u, 6u);\n+    assert (ivec::len(v) == 5u);\n+    assert (v.(0) == 2);\n+    assert (v.(1) == 3);\n+    assert (v.(2) == 4);\n+    assert (v.(3) == 5);\n+    assert (v.(4) == 6);\n+}\n+\n fn main() {\n     test_reserve_and_on_heap();\n     test_unsafe_ptrs();\n     test_init_fn();\n+    test_init_elt();\n+    test_last();\n+    test_slice();\n }\n "}]}