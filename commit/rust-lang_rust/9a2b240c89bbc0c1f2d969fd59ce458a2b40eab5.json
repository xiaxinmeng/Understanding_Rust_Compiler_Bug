{"sha": "9a2b240c89bbc0c1f2d969fd59ce458a2b40eab5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjlhMmIyNDBjODliYmMwYzFmMmQ5NjlmZDU5Y2U0NThhMmI0MGVhYjU=", "commit": {"author": {"name": "Arkaitz Jimenez", "email": "arkaitzj@gmail.com", "date": "2012-06-03T19:51:17Z"}, "committer": {"name": "Arkaitz Jimenez", "email": "arkaitzj@gmail.com", "date": "2012-06-03T20:06:42Z"}, "message": "Show ellipsis sign when log line is truncated", "tree": {"sha": "61f9cf4ca1d92c820d50e5cef2b279d5110876bc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/61f9cf4ca1d92c820d50e5cef2b279d5110876bc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9a2b240c89bbc0c1f2d969fd59ce458a2b40eab5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9a2b240c89bbc0c1f2d969fd59ce458a2b40eab5", "html_url": "https://github.com/rust-lang/rust/commit/9a2b240c89bbc0c1f2d969fd59ce458a2b40eab5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9a2b240c89bbc0c1f2d969fd59ce458a2b40eab5/comments", "author": {"login": "arkaitzj", "id": 91765, "node_id": "MDQ6VXNlcjkxNzY1", "avatar_url": "https://avatars.githubusercontent.com/u/91765?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arkaitzj", "html_url": "https://github.com/arkaitzj", "followers_url": "https://api.github.com/users/arkaitzj/followers", "following_url": "https://api.github.com/users/arkaitzj/following{/other_user}", "gists_url": "https://api.github.com/users/arkaitzj/gists{/gist_id}", "starred_url": "https://api.github.com/users/arkaitzj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arkaitzj/subscriptions", "organizations_url": "https://api.github.com/users/arkaitzj/orgs", "repos_url": "https://api.github.com/users/arkaitzj/repos", "events_url": "https://api.github.com/users/arkaitzj/events{/privacy}", "received_events_url": "https://api.github.com/users/arkaitzj/received_events", "type": "User", "site_admin": false}, "committer": {"login": "arkaitzj", "id": 91765, "node_id": "MDQ6VXNlcjkxNzY1", "avatar_url": "https://avatars.githubusercontent.com/u/91765?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arkaitzj", "html_url": "https://github.com/arkaitzj", "followers_url": "https://api.github.com/users/arkaitzj/followers", "following_url": "https://api.github.com/users/arkaitzj/following{/other_user}", "gists_url": "https://api.github.com/users/arkaitzj/gists{/gist_id}", "starred_url": "https://api.github.com/users/arkaitzj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arkaitzj/subscriptions", "organizations_url": "https://api.github.com/users/arkaitzj/orgs", "repos_url": "https://api.github.com/users/arkaitzj/repos", "events_url": "https://api.github.com/users/arkaitzj/events{/privacy}", "received_events_url": "https://api.github.com/users/arkaitzj/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9b81dbfef3322ea2c05fe92a2b7cc6bbecbc33fe", "url": "https://api.github.com/repos/rust-lang/rust/commits/9b81dbfef3322ea2c05fe92a2b7cc6bbecbc33fe", "html_url": "https://github.com/rust-lang/rust/commit/9b81dbfef3322ea2c05fe92a2b7cc6bbecbc33fe"}], "stats": {"total": 8, "additions": 7, "deletions": 1}, "files": [{"sha": "27883391ccede76768ebf1ed0965fd9a0a94939f", "filename": "src/rt/rust_sched_loop.cpp", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/9a2b240c89bbc0c1f2d969fd59ce458a2b40eab5/src%2Frt%2Frust_sched_loop.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/9a2b240c89bbc0c1f2d969fd59ce458a2b40eab5/src%2Frt%2Frust_sched_loop.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_sched_loop.cpp?ref=9a2b240c89bbc0c1f2d969fd59ce458a2b40eab5", "patch": "@@ -54,7 +54,13 @@ rust_sched_loop::log(rust_task* task, uint32_t level, char const *fmt, ...) {\n     char buf[BUF_BYTES];\n     va_list args;\n     va_start(args, fmt);\n-    vsnprintf(buf, sizeof(buf), fmt, args);\n+    int formattedbytes = vsnprintf(buf, sizeof(buf), fmt, args);\n+    if( formattedbytes and (unsigned)formattedbytes > BUF_BYTES ){\n+        const char truncatedstr[] = \"[...]\";\n+        memcpy( &buf[BUF_BYTES-sizeof(truncatedstr)],\n+                truncatedstr,\n+                sizeof(truncatedstr));\n+    }\n     _log.trace_ln(task, level, buf);\n     va_end(args);\n }"}]}