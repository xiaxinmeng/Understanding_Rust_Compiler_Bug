{"sha": "7cdad775363e5c4b723870ecfcd091ee1a13a9dd", "node_id": "C_kwDOAAsO6NoAKDdjZGFkNzc1MzYzZTVjNGI3MjM4NzBlY2ZjZDA5MWVlMWExM2E5ZGQ", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-05-06T02:34:25Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-05-06T02:34:25Z"}, "message": "Rollup merge of #96741 - GuillaumeGomez:improve-settings-loading-strategy, r=jsha\n\nImprove settings loading strategy\n\nI learned about this thanks to ```@jsha``` who suggested this approach:\n\nIt improves the settings loading strategy by loading CSS and JS at the same time to prevent the style to be applied afterwards on slow connections.\n\nr? ```@jsha```", "tree": {"sha": "1c53ca2994bd2c18b7b1586b96805463003774d1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1c53ca2994bd2c18b7b1586b96805463003774d1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7cdad775363e5c4b723870ecfcd091ee1a13a9dd", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJidIkyCRBK7hj4Ov3rIwAAdi0IADRjsELpgDmOx9CDgaoMJlGn\nKNLyorQpTZNGOpcfcINfWuFw74HushXvoofim1Be2C1ApOkDEVQkvqjz1eVYVuVf\nG9lfab9rPUu+4taaKRbjTkgkb6c6i0U3KYL5W+KtRZLPbOOXL59ZWOXntW8C6yc/\nBt6DG/tyfNlurU0m5M+KLRI8ABUotHf70UX07/bGWvuhLrmzmubi0n3t8SZQbs3V\nYeBvcyORP3K8xrHtV/IGn4+JMpR6P7clhOZE7eqduPjV2ASb6/JaRb5TrQN3yVxo\nrdEgm9q8ukgbFM8TIKOqfzD4odNPvMTv48w603dupeb+thWP57iBiSIonh5k+eE=\n=gG19\n-----END PGP SIGNATURE-----\n", "payload": "tree 1c53ca2994bd2c18b7b1586b96805463003774d1\nparent b78179e1f7e48c0a44664435fecada88425e6042\nparent 87b6326d672f5d40b14460bdedebf4f69288fb6a\nauthor Michael Goulet <michael@errs.io> 1651804465 -0700\ncommitter GitHub <noreply@github.com> 1651804465 -0700\n\nRollup merge of #96741 - GuillaumeGomez:improve-settings-loading-strategy, r=jsha\n\nImprove settings loading strategy\n\nI learned about this thanks to ```@jsha``` who suggested this approach:\n\nIt improves the settings loading strategy by loading CSS and JS at the same time to prevent the style to be applied afterwards on slow connections.\n\nr? ```@jsha```\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7cdad775363e5c4b723870ecfcd091ee1a13a9dd", "html_url": "https://github.com/rust-lang/rust/commit/7cdad775363e5c4b723870ecfcd091ee1a13a9dd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7cdad775363e5c4b723870ecfcd091ee1a13a9dd/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b78179e1f7e48c0a44664435fecada88425e6042", "url": "https://api.github.com/repos/rust-lang/rust/commits/b78179e1f7e48c0a44664435fecada88425e6042", "html_url": "https://github.com/rust-lang/rust/commit/b78179e1f7e48c0a44664435fecada88425e6042"}, {"sha": "87b6326d672f5d40b14460bdedebf4f69288fb6a", "url": "https://api.github.com/repos/rust-lang/rust/commits/87b6326d672f5d40b14460bdedebf4f69288fb6a", "html_url": "https://github.com/rust-lang/rust/commit/87b6326d672f5d40b14460bdedebf4f69288fb6a"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "66a7d484f33b0f5523674a87ed744b91c986645a", "filename": "src/librustdoc/html/static/js/main.js", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7cdad775363e5c4b723870ecfcd091ee1a13a9dd/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/7cdad775363e5c4b723870ecfcd091ee1a13a9dd/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js?ref=7cdad775363e5c4b723870ecfcd091ee1a13a9dd", "patch": "@@ -303,6 +303,9 @@ function loadCss(cssFileName) {\n     getSettingsButton().onclick = event => {\n         addClass(getSettingsButton(), \"rotate\");\n         event.preventDefault();\n+        // Sending request for the CSS and the JS files at the same time so it will\n+        // hopefully be loaded when the JS will generate the settings content.\n+        loadCss(\"settings\");\n         loadScript(window.settingsJS);\n     };\n "}, {"sha": "e447d09ab6b97711822b9bb7c2b2d06b3983d4db", "filename": "src/librustdoc/html/static/js/settings.js", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/7cdad775363e5c4b723870ecfcd091ee1a13a9dd/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js", "raw_url": "https://github.com/rust-lang/rust/raw/7cdad775363e5c4b723870ecfcd091ee1a13a9dd/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js?ref=7cdad775363e5c4b723870ecfcd091ee1a13a9dd", "patch": "@@ -3,7 +3,7 @@\n /* eslint prefer-const: \"error\" */\n /* eslint prefer-arrow-callback: \"error\" */\n // Local js definitions:\n-/* global getSettingValue, getVirtualKey, updateLocalStorage, updateSystemTheme, loadCss */\n+/* global getSettingValue, getVirtualKey, updateLocalStorage, updateSystemTheme */\n /* global addClass, removeClass, onEach, onEachLazy, NOT_DISPLAYED_ID */\n /* global MAIN_ID, getVar, getSettingsButton, switchDisplayedElement, getNotDisplayedElem */\n \n@@ -209,9 +209,6 @@\n             },\n         ];\n \n-        // First, we add the settings.css file.\n-        loadCss(\"settings\");\n-\n         // Then we build the DOM.\n         const el = document.createElement(\"section\");\n         el.id = \"settings\";"}]}