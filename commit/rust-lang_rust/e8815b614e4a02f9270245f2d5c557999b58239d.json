{"sha": "e8815b614e4a02f9270245f2d5c557999b58239d", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU4ODE1YjYxNGU0YTAyZjkyNzAyNDVmMmQ1YzU1Nzk5OWI1ODIzOWQ=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2019-01-09T16:14:21Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2019-01-09T16:14:21Z"}, "message": "nicer trailing comma handling in types", "tree": {"sha": "790d941add3eb804b3b4bfbc570a4e8287127273", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/790d941add3eb804b3b4bfbc570a4e8287127273"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e8815b614e4a02f9270245f2d5c557999b58239d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e8815b614e4a02f9270245f2d5c557999b58239d", "html_url": "https://github.com/rust-lang/rust/commit/e8815b614e4a02f9270245f2d5c557999b58239d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e8815b614e4a02f9270245f2d5c557999b58239d/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ecfa68a3f50c2e305d2fcd7be09cde729147e023", "url": "https://api.github.com/repos/rust-lang/rust/commits/ecfa68a3f50c2e305d2fcd7be09cde729147e023", "html_url": "https://github.com/rust-lang/rust/commit/ecfa68a3f50c2e305d2fcd7be09cde729147e023"}], "stats": {"total": 36, "additions": 21, "deletions": 15}, "files": [{"sha": "b3172dc28376e936a77994587d87ab5b7244b9c7", "filename": "Cargo.lock", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/e8815b614e4a02f9270245f2d5c557999b58239d/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/e8815b614e4a02f9270245f2d5c557999b58239d/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=e8815b614e4a02f9270245f2d5c557999b58239d", "patch": "@@ -409,7 +409,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"join_to_string\"\n-version = \"0.1.1\"\n+version = \"0.1.3\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n@@ -646,7 +646,7 @@ version = \"0.1.0\"\n dependencies = [\n  \"clap 2.32.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"failure 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"join_to_string 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"join_to_string 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ra_ide_api_light 0.1.0\",\n  \"ra_syntax 0.1.0\",\n  \"tools 0.1.0\",\n@@ -672,6 +672,7 @@ dependencies = [\n  \"arrayvec 0.4.10 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ena 0.11.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"flexi_logger 0.10.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"join_to_string 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.4.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"parking_lot 0.7.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ra_arena 0.1.0\",\n@@ -709,7 +710,7 @@ name = \"ra_ide_api_light\"\n version = \"0.1.0\"\n dependencies = [\n  \"itertools 0.8.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"join_to_string 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"join_to_string 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"proptest 0.8.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ra_syntax 0.1.0\",\n  \"ra_text_edit 0.1.0\",\n@@ -1531,7 +1532,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum indexmap 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7e81a7c05f79578dbc15793d8b619db9ba32b4577003ef3af1a91c416798c58d\"\n \"checksum itertools 0.8.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"5b8467d9c1cebe26feb08c640139247fac215782d35371ade9a2136ed6085358\"\n \"checksum itoa 0.4.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1306f3464951f30e30d12373d31c79fbd52d236e5e896fd92f96ec7babbbe60b\"\n-\"checksum join_to_string 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7bddc885f3fd69dd4b5d747c2efe6dd2c36d795ea9938281ed50910e32c95e31\"\n+\"checksum join_to_string 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"4dc7a5290e8c2606ce2be49f456d50f69173cb96d1541e4f66e34ac8b331a98f\"\n \"checksum languageserver-types 0.53.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7c01845f71b8b3b3557a8179af4434a4b2570829da12371f05272d28183a06ce\"\n \"checksum lazy_static 1.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"a374c89b9db55895453a74c1e38861d9deec0b01b405a82516e9d5de4820dea1\"\n \"checksum libc 0.2.46 (registry+https://github.com/rust-lang/crates.io-index)\" = \"023a4cd09b2ff695f9734c1934145a315594b7986398496841c7031a5a1bbdbd\""}, {"sha": "0135e0e1665b3aca093da0183f6c71043fd8c903", "filename": "crates/ra_hir/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/e8815b614e4a02f9270245f2d5c557999b58239d/crates%2Fra_hir%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/e8815b614e4a02f9270245f2d5c557999b58239d/crates%2Fra_hir%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2FCargo.toml?ref=e8815b614e4a02f9270245f2d5c557999b58239d", "patch": "@@ -12,6 +12,7 @@ salsa = \"0.9.1\"\n rustc-hash = \"1.0\"\n parking_lot = \"0.7.0\"\n ena = \"0.11\"\n+join_to_string = \"0.1.3\"\n ra_syntax = { path = \"../ra_syntax\" }\n ra_arena = { path = \"../ra_arena\" }\n ra_db = { path = \"../ra_db\" }"}, {"sha": "eb7764f652c5dc0ab060dc95c0aff9547bcbc77d", "filename": "crates/ra_hir/src/ty.rs", "status": "modified", "additions": 13, "deletions": 9, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/e8815b614e4a02f9270245f2d5c557999b58239d/crates%2Fra_hir%2Fsrc%2Fty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e8815b614e4a02f9270245f2d5c557999b58239d/crates%2Fra_hir%2Fsrc%2Fty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty.rs?ref=e8815b614e4a02f9270245f2d5c557999b58239d", "patch": "@@ -25,6 +25,7 @@ use std::{fmt, mem};\n use log;\n use ena::unify::{InPlaceUnificationTable, UnifyKey, UnifyValue, NoError};\n use ra_arena::map::ArenaMap;\n+use join_to_string::join;\n \n use ra_db::Cancelable;\n \n@@ -396,18 +397,21 @@ impl fmt::Display for Ty {\n             Ty::Ref(t, m) => write!(f, \"&{}{}\", m.as_keyword_for_ref(), t),\n             Ty::Never => write!(f, \"!\"),\n             Ty::Tuple(ts) => {\n-                write!(f, \"(\")?;\n-                for t in ts.iter() {\n-                    write!(f, \"{},\", t)?;\n+                if ts.len() == 1 {\n+                    write!(f, \"({},)\", ts[0])\n+                } else {\n+                    join(ts.iter())\n+                        .surround_with(\"(\", \")\")\n+                        .separator(\", \")\n+                        .to_fmt(f)\n                 }\n-                write!(f, \")\")\n             }\n             Ty::FnPtr(sig) => {\n-                write!(f, \"fn(\")?;\n-                for t in &sig.input {\n-                    write!(f, \"{},\", t)?;\n-                }\n-                write!(f, \") -> {}\", sig.output)\n+                join(sig.input.iter())\n+                    .surround_with(\"fn(\", \")\")\n+                    .separator(\", \")\n+                    .to_fmt(f)?;\n+                write!(f, \" -> {}\", sig.output)\n             }\n             Ty::Adt { name, .. } => write!(f, \"{}\", name),\n             Ty::Unknown => write!(f, \"[unknown]\"),"}, {"sha": "b8593cfd1650d1ce245e749721bf18da2362d21c", "filename": "crates/ra_hir/src/ty/tests/data/backwards.txt", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e8815b614e4a02f9270245f2d5c557999b58239d/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Fbackwards.txt", "raw_url": "https://github.com/rust-lang/rust/raw/e8815b614e4a02f9270245f2d5c557999b58239d/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Fbackwards.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Fbackwards.txt?ref=e8815b614e4a02f9270245f2d5c557999b58239d", "patch": "@@ -4,7 +4,7 @@\n [88; 89) 'a': u32\n [92; 108) 'unknow...nction': [unknown]\n [92; 110) 'unknow...tion()': u32\n-[116; 125) 'takes_u32': fn(u32,) -> ()\n+[116; 125) 'takes_u32': fn(u32) -> ()\n [116; 128) 'takes_u32(a)': ()\n [126; 127) 'a': u32\n [138; 139) 'b': i32"}, {"sha": "8a515ac5e452a085dcb510f1d50e24da1d6bbdf8", "filename": "crates/ra_hir/src/ty/tests/data/binary_op.txt", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e8815b614e4a02f9270245f2d5c557999b58239d/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Fbinary_op.txt", "raw_url": "https://github.com/rust-lang/rust/raw/e8815b614e4a02f9270245f2d5c557999b58239d/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Fbinary_op.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Fbinary_op.txt?ref=e8815b614e4a02f9270245f2d5c557999b58239d", "patch": "@@ -22,7 +22,7 @@\n [166; 188) 'minus_...ONST_2': bool\n [181; 188) 'CONST_2': isize\n [198; 199) 'c': i32\n-[202; 203) 'f': fn(bool,) -> i32\n+[202; 203) 'f': fn(bool) -> i32\n [202; 211) 'f(z || y)': i32\n [202; 215) 'f(z || y) + 5': i32\n [204; 205) 'z': bool"}]}