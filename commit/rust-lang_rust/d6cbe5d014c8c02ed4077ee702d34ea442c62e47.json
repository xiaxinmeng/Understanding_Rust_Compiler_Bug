{"sha": "d6cbe5d014c8c02ed4077ee702d34ea442c62e47", "node_id": "C_kwDOAAsO6NoAKGQ2Y2JlNWQwMTRjOGMwMmVkNDA3N2VlNzAyZDM0ZWE0NDJjNjJlNDc", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-07-14T18:27:24Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-07-14T19:09:20Z"}, "message": "ensure that RangeMap panics on OOB", "tree": {"sha": "db5398a36f06a548655016aa997b7a1ef01fb075", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/db5398a36f06a548655016aa997b7a1ef01fb075"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d6cbe5d014c8c02ed4077ee702d34ea442c62e47", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d6cbe5d014c8c02ed4077ee702d34ea442c62e47", "html_url": "https://github.com/rust-lang/rust/commit/d6cbe5d014c8c02ed4077ee702d34ea442c62e47", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d6cbe5d014c8c02ed4077ee702d34ea442c62e47/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "421f92bee65452600c3ecdf63de5395809d78e55", "url": "https://api.github.com/repos/rust-lang/rust/commits/421f92bee65452600c3ecdf63de5395809d78e55", "html_url": "https://github.com/rust-lang/rust/commit/421f92bee65452600c3ecdf63de5395809d78e55"}], "stats": {"total": 18, "additions": 18, "deletions": 0}, "files": [{"sha": "c77ea63b0873f1eb3f83c338e10e158129ca6cca", "filename": "src/range_map.rs", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/d6cbe5d014c8c02ed4077ee702d34ea442c62e47/src%2Frange_map.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6cbe5d014c8c02ed4077ee702d34ea442c62e47/src%2Frange_map.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frange_map.rs?ref=d6cbe5d014c8c02ed4077ee702d34ea442c62e47", "patch": "@@ -77,6 +77,10 @@ impl<T> RangeMap<T> {\n         };\n         // The first offset that is not included any more.\n         let end = offset + len;\n+        assert!(\n+            end <= self.v.last().unwrap().range.end,\n+            \"iterating beyond the bounds of this RangeMap\"\n+        );\n         slice\n             .iter()\n             .take_while(move |elem| elem.range.start < end)\n@@ -279,4 +283,18 @@ mod tests {\n         assert_eq!(map.v.len(), 5);\n         assert_eq!(to_vec(&map, 10, 10), vec![23, 42, 23, 23, 23, 19, 19, 19, 19, 19]);\n     }\n+\n+    #[test]\n+    #[should_panic]\n+    fn out_of_range_iter_mut() {\n+        let mut map = RangeMap::<i32>::new(Size::from_bytes(20), -1);\n+        let _ = map.iter_mut(Size::from_bytes(11), Size::from_bytes(11));\n+    }\n+\n+    #[test]\n+    #[should_panic]\n+    fn out_of_range_iter() {\n+        let map = RangeMap::<i32>::new(Size::from_bytes(20), -1);\n+        let _ = map.iter(Size::from_bytes(11), Size::from_bytes(11));\n+    }\n }"}]}