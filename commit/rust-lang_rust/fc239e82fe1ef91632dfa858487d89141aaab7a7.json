{"sha": "fc239e82fe1ef91632dfa858487d89141aaab7a7", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZjMjM5ZTgyZmUxZWY5MTYzMmRmYTg1ODQ4N2Q4OTE0MWFhYWI3YTc=", "commit": {"author": {"name": "Gary Guo", "email": "gary@garyguo.net", "date": "2020-06-26T12:19:50Z"}, "committer": {"name": "Gary Guo", "email": "gary@garyguo.net", "date": "2020-06-26T20:36:14Z"}, "message": "Make `likely` and `unlikely` const\n\nThey are gated by internal feature gate const_likely", "tree": {"sha": "70619f809e6f43f5527c7a069e3e3b284d66d34e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/70619f809e6f43f5527c7a069e3e3b284d66d34e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fc239e82fe1ef91632dfa858487d89141aaab7a7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fc239e82fe1ef91632dfa858487d89141aaab7a7", "html_url": "https://github.com/rust-lang/rust/commit/fc239e82fe1ef91632dfa858487d89141aaab7a7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fc239e82fe1ef91632dfa858487d89141aaab7a7/comments", "author": {"login": "nbdd0121", "id": 4065244, "node_id": "MDQ6VXNlcjQwNjUyNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4065244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbdd0121", "html_url": "https://github.com/nbdd0121", "followers_url": "https://api.github.com/users/nbdd0121/followers", "following_url": "https://api.github.com/users/nbdd0121/following{/other_user}", "gists_url": "https://api.github.com/users/nbdd0121/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbdd0121/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbdd0121/subscriptions", "organizations_url": "https://api.github.com/users/nbdd0121/orgs", "repos_url": "https://api.github.com/users/nbdd0121/repos", "events_url": "https://api.github.com/users/nbdd0121/events{/privacy}", "received_events_url": "https://api.github.com/users/nbdd0121/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nbdd0121", "id": 4065244, "node_id": "MDQ6VXNlcjQwNjUyNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4065244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbdd0121", "html_url": "https://github.com/nbdd0121", "followers_url": "https://api.github.com/users/nbdd0121/followers", "following_url": "https://api.github.com/users/nbdd0121/following{/other_user}", "gists_url": "https://api.github.com/users/nbdd0121/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbdd0121/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbdd0121/subscriptions", "organizations_url": "https://api.github.com/users/nbdd0121/orgs", "repos_url": "https://api.github.com/users/nbdd0121/repos", "events_url": "https://api.github.com/users/nbdd0121/events{/privacy}", "received_events_url": "https://api.github.com/users/nbdd0121/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "224bc052564117abfb8716772779ade221133395", "url": "https://api.github.com/repos/rust-lang/rust/commits/224bc052564117abfb8716772779ade221133395", "html_url": "https://github.com/rust-lang/rust/commit/224bc052564117abfb8716772779ade221133395"}], "stats": {"total": 10, "additions": 10, "deletions": 0}, "files": [{"sha": "da174299fb9af4f8bc4c3778b725c0e259009e2e", "filename": "src/libcore/intrinsics.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fc239e82fe1ef91632dfa858487d89141aaab7a7/src%2Flibcore%2Fintrinsics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fc239e82fe1ef91632dfa858487d89141aaab7a7/src%2Flibcore%2Fintrinsics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fintrinsics.rs?ref=fc239e82fe1ef91632dfa858487d89141aaab7a7", "patch": "@@ -952,6 +952,7 @@ extern \"rust-intrinsic\" {\n     /// Any use other than with `if` statements will probably not have an effect.\n     ///\n     /// This intrinsic does not have a stable counterpart.\n+    #[rustc_const_unstable(feature = \"const_likely\", issue = \"none\")]\n     pub fn likely(b: bool) -> bool;\n \n     /// Hints to the compiler that branch condition is likely to be false.\n@@ -960,6 +961,7 @@ extern \"rust-intrinsic\" {\n     /// Any use other than with `if` statements will probably not have an effect.\n     ///\n     /// This intrinsic does not have a stable counterpart.\n+    #[rustc_const_unstable(feature = \"const_likely\", issue = \"none\")]\n     pub fn unlikely(b: bool) -> bool;\n \n     /// Executes a breakpoint trap, for inspection by a debugger."}, {"sha": "412d323b283a3bd542103d3d56334ddefd51b142", "filename": "src/libcore/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/fc239e82fe1ef91632dfa858487d89141aaab7a7/src%2Flibcore%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fc239e82fe1ef91632dfa858487d89141aaab7a7/src%2Flibcore%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Flib.rs?ref=fc239e82fe1ef91632dfa858487d89141aaab7a7", "patch": "@@ -92,6 +92,7 @@\n #![feature(const_slice_from_raw_parts)]\n #![feature(const_slice_ptr_len)]\n #![feature(const_type_name)]\n+#![feature(const_likely)]\n #![feature(custom_inner_attributes)]\n #![feature(decl_macro)]\n #![feature(doc_cfg)]"}, {"sha": "52cb700c3d58f86ddaf15f213e05f5dddb25a5a9", "filename": "src/librustc_mir/interpret/intrinsics.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fc239e82fe1ef91632dfa858487d89141aaab7a7/src%2Flibrustc_mir%2Finterpret%2Fintrinsics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fc239e82fe1ef91632dfa858487d89141aaab7a7/src%2Flibrustc_mir%2Finterpret%2Fintrinsics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Fintrinsics.rs?ref=fc239e82fe1ef91632dfa858487d89141aaab7a7", "patch": "@@ -399,6 +399,11 @@ impl<'mir, 'tcx: 'mir, M: Machine<'mir, 'tcx>> InterpCx<'mir, 'tcx, M> {\n                 );\n                 self.copy_op(self.operand_index(args[0], index)?, dest)?;\n             }\n+            sym::likely | sym::unlikely => {\n+                // These just return their argument\n+                let a = self.read_immediate(args[0])?;\n+                self.write_immediate(*a, dest)?;\n+            }\n             // FIXME(#73156): Handle source code coverage in const eval\n             sym::count_code_region => (),\n             _ => return Ok(false),"}, {"sha": "3e62486feb95ef02b62aabc2b0f1c4612b1ebb09", "filename": "src/librustc_span/symbol.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fc239e82fe1ef91632dfa858487d89141aaab7a7/src%2Flibrustc_span%2Fsymbol.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fc239e82fe1ef91632dfa858487d89141aaab7a7/src%2Flibrustc_span%2Fsymbol.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_span%2Fsymbol.rs?ref=fc239e82fe1ef91632dfa858487d89141aaab7a7", "patch": "@@ -427,6 +427,7 @@ symbols! {\n         lhs,\n         lib,\n         lifetime,\n+        likely,\n         line,\n         link,\n         linkage,\n@@ -813,6 +814,7 @@ symbols! {\n         underscore_lifetimes,\n         uniform_paths,\n         universal_impl_trait,\n+        unlikely,\n         unmarked_api,\n         unreachable_code,\n         unrestricted_attribute_tokens,"}]}