{"sha": "3132a9e7fc5ec94e649b7a53ac8d10b2f0ec91cd", "node_id": "C_kwDOAAsO6NoAKDMxMzJhOWU3ZmM1ZWM5NGU2NDliN2E1M2FjOGQxMGIyZjBlYzkxY2Q", "commit": {"author": {"name": "Jake Heinz", "email": "jh@discordapp.com", "date": "2023-05-02T08:19:59Z"}, "committer": {"name": "Jake Heinz", "email": "jh@discordapp.com", "date": "2023-05-02T08:19:59Z"}, "message": "fix: ide: exclude sized in go-to actions", "tree": {"sha": "26e35f12d1acc220e55510a097025d58a30e676c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/26e35f12d1acc220e55510a097025d58a30e676c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3132a9e7fc5ec94e649b7a53ac8d10b2f0ec91cd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3132a9e7fc5ec94e649b7a53ac8d10b2f0ec91cd", "html_url": "https://github.com/rust-lang/rust/commit/3132a9e7fc5ec94e649b7a53ac8d10b2f0ec91cd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3132a9e7fc5ec94e649b7a53ac8d10b2f0ec91cd/comments", "author": {"login": "jhgg", "id": 5489149, "node_id": "MDQ6VXNlcjU0ODkxNDk=", "avatar_url": "https://avatars.githubusercontent.com/u/5489149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhgg", "html_url": "https://github.com/jhgg", "followers_url": "https://api.github.com/users/jhgg/followers", "following_url": "https://api.github.com/users/jhgg/following{/other_user}", "gists_url": "https://api.github.com/users/jhgg/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhgg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhgg/subscriptions", "organizations_url": "https://api.github.com/users/jhgg/orgs", "repos_url": "https://api.github.com/users/jhgg/repos", "events_url": "https://api.github.com/users/jhgg/events{/privacy}", "received_events_url": "https://api.github.com/users/jhgg/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jhgg", "id": 5489149, "node_id": "MDQ6VXNlcjU0ODkxNDk=", "avatar_url": "https://avatars.githubusercontent.com/u/5489149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhgg", "html_url": "https://github.com/jhgg", "followers_url": "https://api.github.com/users/jhgg/followers", "following_url": "https://api.github.com/users/jhgg/following{/other_user}", "gists_url": "https://api.github.com/users/jhgg/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhgg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhgg/subscriptions", "organizations_url": "https://api.github.com/users/jhgg/orgs", "repos_url": "https://api.github.com/users/jhgg/repos", "events_url": "https://api.github.com/users/jhgg/events{/privacy}", "received_events_url": "https://api.github.com/users/jhgg/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2fdd1ac510f3e2254a89f4d8df7b1010934f81c5", "url": "https://api.github.com/repos/rust-lang/rust/commits/2fdd1ac510f3e2254a89f4d8df7b1010934f81c5", "html_url": "https://github.com/rust-lang/rust/commit/2fdd1ac510f3e2254a89f4d8df7b1010934f81c5"}], "stats": {"total": 27, "additions": 24, "deletions": 3}, "files": [{"sha": "4b1a716a2289a45e74e01167fe74be02e23bad3d", "filename": "crates/hir/src/lib.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/3132a9e7fc5ec94e649b7a53ac8d10b2f0ec91cd/crates%2Fhir%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3132a9e7fc5ec94e649b7a53ac8d10b2f0ec91cd/crates%2Fhir%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir%2Fsrc%2Flib.rs?ref=3132a9e7fc5ec94e649b7a53ac8d10b2f0ec91cd", "patch": "@@ -44,7 +44,7 @@ use hir_def::{\n     generics::{LifetimeParamData, TypeOrConstParamData, TypeParamProvenance},\n     hir::{BindingAnnotation, BindingId, ExprOrPatId, LabelId, Pat},\n     item_tree::ItemTreeNode,\n-    lang_item::{LangItem, LangItemTarget},\n+    lang_item::LangItemTarget,\n     layout::ReprOptions,\n     macro_id_to_def_id,\n     nameres::{self, diagnostics::DefDiagnostic, ModuleOrigin},\n@@ -114,6 +114,7 @@ pub use {\n         data::adt::StructKind,\n         find_path::PrefixKind,\n         import_map,\n+        lang_item::LangItem,\n         nameres::ModuleSource,\n         path::{ModPath, PathKind},\n         type_ref::{Mutability, TypeRef},"}, {"sha": "c47f85b7bf992d74b4cab5da0c31fe7510ea7868", "filename": "crates/ide/src/hover.rs", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/3132a9e7fc5ec94e649b7a53ac8d10b2f0ec91cd/crates%2Fide%2Fsrc%2Fhover.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3132a9e7fc5ec94e649b7a53ac8d10b2f0ec91cd/crates%2Fide%2Fsrc%2Fhover.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fhover.rs?ref=3132a9e7fc5ec94e649b7a53ac8d10b2f0ec91cd", "patch": "@@ -6,7 +6,7 @@ mod tests;\n use std::iter;\n \n use either::Either;\n-use hir::{HasSource, Semantics};\n+use hir::{db::DefDatabase, HasSource, LangItem, Semantics};\n use ide_db::{\n     base_db::FileRange,\n     defs::{Definition, IdentClass, OperatorClass},\n@@ -353,7 +353,14 @@ fn goto_type_action_for_def(db: &RootDatabase, def: Definition) -> Option<HoverA\n     };\n \n     if let Definition::GenericParam(hir::GenericParam::TypeParam(it)) = def {\n-        it.trait_bounds(db).into_iter().for_each(|it| push_new_def(it.into()));\n+        let krate = it.module(db).krate();\n+        let sized_trait =\n+            db.lang_item(krate.into(), LangItem::Sized).and_then(|lang_item| lang_item.as_trait());\n+\n+        it.trait_bounds(db)\n+            .into_iter()\n+            .filter(|&it| Some(it.into()) != sized_trait)\n+            .for_each(|it| push_new_def(it.into()));\n     } else {\n         let ty = match def {\n             Definition::Local(it) => it.ty(db),"}, {"sha": "64df511e46e04257dc5531484483a1bb890e60cb", "filename": "crates/ide/src/hover/tests.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/3132a9e7fc5ec94e649b7a53ac8d10b2f0ec91cd/crates%2Fide%2Fsrc%2Fhover%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3132a9e7fc5ec94e649b7a53ac8d10b2f0ec91cd/crates%2Fide%2Fsrc%2Fhover%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fhover%2Ftests.rs?ref=3132a9e7fc5ec94e649b7a53ac8d10b2f0ec91cd", "patch": "@@ -2098,6 +2098,19 @@ fn main() { let s$0t = S{ f1:Arg(0) }; }\n     );\n }\n \n+#[test]\n+fn test_hover_generic_excludes_sized_go_to_action() {\n+    check_actions(\n+        r#\"\n+//- minicore: sized\n+struct S<T$0>(T);\n+    \"#,\n+        expect![[r#\"\n+            []\n+        \"#]],\n+    );\n+}\n+\n #[test]\n fn test_hover_generic_struct_has_flattened_goto_type_actions() {\n     check_actions("}]}