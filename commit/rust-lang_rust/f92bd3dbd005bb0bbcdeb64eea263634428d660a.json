{"sha": "f92bd3dbd005bb0bbcdeb64eea263634428d660a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY5MmJkM2RiZDAwNWJiMGJiY2RlYjY0ZWVhMjYzNjM0NDI4ZDY2MGE=", "commit": {"author": {"name": "Felix Raimundo", "email": "felix.raimundo@tweag.io", "date": "2017-05-14T18:06:54Z"}, "committer": {"name": "Felix Raimundo", "email": "felix.raimundo@tweag.io", "date": "2017-05-15T06:10:22Z"}, "message": "Add links to the `thread::LocalKey` doc.\n\nPart of #29378 .", "tree": {"sha": "d6122da51729110d44eae9eef8c4991f33b15ca8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d6122da51729110d44eae9eef8c4991f33b15ca8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f92bd3dbd005bb0bbcdeb64eea263634428d660a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f92bd3dbd005bb0bbcdeb64eea263634428d660a", "html_url": "https://github.com/rust-lang/rust/commit/f92bd3dbd005bb0bbcdeb64eea263634428d660a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f92bd3dbd005bb0bbcdeb64eea263634428d660a/comments", "author": null, "committer": null, "parents": [{"sha": "77f1bec6f5eb9ed632c973b97b12701294e6d3a5", "url": "https://api.github.com/repos/rust-lang/rust/commits/77f1bec6f5eb9ed632c973b97b12701294e6d3a5", "html_url": "https://github.com/rust-lang/rust/commit/77f1bec6f5eb9ed632c973b97b12701294e6d3a5"}], "stats": {"total": 45, "additions": 30, "deletions": 15}, "files": [{"sha": "c2c6e6cf87dff4ad71fcde7e8f721f342ef3d37c", "filename": "src/libstd/thread/local.rs", "status": "modified", "additions": 30, "deletions": 15, "changes": 45, "blob_url": "https://github.com/rust-lang/rust/blob/f92bd3dbd005bb0bbcdeb64eea263634428d660a/src%2Flibstd%2Fthread%2Flocal.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f92bd3dbd005bb0bbcdeb64eea263634428d660a/src%2Flibstd%2Fthread%2Flocal.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fthread%2Flocal.rs?ref=f92bd3dbd005bb0bbcdeb64eea263634428d660a", "patch": "@@ -19,16 +19,16 @@ use mem;\n /// A thread local storage key which owns its contents.\n ///\n /// This key uses the fastest possible implementation available to it for the\n-/// target platform. It is instantiated with the `thread_local!` macro and the\n-/// primary method is the `with` method.\n+/// target platform. It is instantiated with the [`thread_local!`] macro and the\n+/// primary method is the [`with`] method.\n ///\n-/// The `with` method yields a reference to the contained value which cannot be\n+/// The [`with`] method yields a reference to the contained value which cannot be\n /// sent across threads or escape the given closure.\n ///\n /// # Initialization and Destruction\n ///\n-/// Initialization is dynamically performed on the first call to `with()`\n-/// within a thread, and values that implement `Drop` get destructed when a\n+/// Initialization is dynamically performed on the first call to [`with`]\n+/// within a thread, and values that implement [`Drop`] get destructed when a\n /// thread exits. Some caveats apply, which are explained below.\n ///\n /// # Examples\n@@ -77,6 +77,10 @@ use mem;\n /// 3. On macOS, initializing TLS during destruction of other TLS slots can\n ///    sometimes cancel *all* destructors for the current thread, whether or not\n ///    the slots have already had their destructors run or not.\n+///\n+/// [`with`]: ../../std/thread/struct.LocalKey.html#method.with\n+/// [`thread_local!`]: ../../std/macro.thread_local.html\n+/// [`Drop`]: ../../std/ops/trait.Drop.html\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub struct LocalKey<T: 'static> {\n     // This outer `LocalKey<T>` type is what's going to be stored in statics,\n@@ -106,7 +110,7 @@ impl<T: 'static> fmt::Debug for LocalKey<T> {\n     }\n }\n \n-/// Declare a new thread local storage key of type `std::thread::LocalKey`.\n+/// Declare a new thread local storage key of type [`std::thread::LocalKey`].\n ///\n /// # Syntax\n ///\n@@ -124,8 +128,10 @@ impl<T: 'static> fmt::Debug for LocalKey<T> {\n /// # fn main() {}\n /// ```\n ///\n-/// See [LocalKey documentation](thread/struct.LocalKey.html) for more\n+/// See [LocalKey documentation][`std::thread::LocalKey`] for more\n /// information.\n+///\n+/// [`std::thread::LocalKey`]: ../std/thread/struct.LocalKey.html\n #[macro_export]\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n #[allow_internal_unstable]\n@@ -195,11 +201,13 @@ macro_rules! __thread_local_inner {\n #[derive(Debug, Eq, PartialEq, Copy, Clone)]\n pub enum LocalKeyState {\n     /// All keys are in this state whenever a thread starts. Keys will\n-    /// transition to the `Valid` state once the first call to `with` happens\n+    /// transition to the `Valid` state once the first call to [`with`] happens\n     /// and the initialization expression succeeds.\n     ///\n     /// Keys in the `Uninitialized` state will yield a reference to the closure\n-    /// passed to `with` so long as the initialization routine does not panic.\n+    /// passed to [`with`] so long as the initialization routine does not panic.\n+    ///\n+    /// [`with`]: ../../std/thread/struct.LocalKey.html#method.with\n     Uninitialized,\n \n     /// Once a key has been accessed successfully, it will enter the `Valid`\n@@ -208,15 +216,19 @@ pub enum LocalKeyState {\n     /// `Destroyed` state.\n     ///\n     /// Keys in the `Valid` state will be guaranteed to yield a reference to the\n-    /// closure passed to `with`.\n+    /// closure passed to [`with`].\n+    ///\n+    /// [`with`]: ../../std/thread/struct.LocalKey.html#method.with\n     Valid,\n \n     /// When a thread exits, the destructors for keys will be run (if\n     /// necessary). While a destructor is running, and possibly after a\n     /// destructor has run, a key is in the `Destroyed` state.\n     ///\n     /// Keys in the `Destroyed` states will trigger a panic when accessed via\n-    /// `with`.\n+    /// [`with`].\n+    ///\n+    /// [`with`]: ../../std/thread/struct.LocalKey.html#method.with\n     Destroyed,\n }\n \n@@ -283,23 +295,26 @@ impl<T: 'static> LocalKey<T> {\n     /// Query the current state of this key.\n     ///\n     /// A key is initially in the `Uninitialized` state whenever a thread\n-    /// starts. It will remain in this state up until the first call to `with`\n+    /// starts. It will remain in this state up until the first call to [`with`]\n     /// within a thread has run the initialization expression successfully.\n     ///\n     /// Once the initialization expression succeeds, the key transitions to the\n-    /// `Valid` state which will guarantee that future calls to `with` will\n+    /// `Valid` state which will guarantee that future calls to [`with`] will\n     /// succeed within the thread.\n     ///\n     /// When a thread exits, each key will be destroyed in turn, and as keys are\n     /// destroyed they will enter the `Destroyed` state just before the\n     /// destructor starts to run. Keys may remain in the `Destroyed` state after\n     /// destruction has completed. Keys without destructors (e.g. with types\n-    /// that are `Copy`), may never enter the `Destroyed` state.\n+    /// that are [`Copy`]), may never enter the `Destroyed` state.\n     ///\n     /// Keys in the `Uninitialized` state can be accessed so long as the\n     /// initialization does not panic. Keys in the `Valid` state are guaranteed\n     /// to be able to be accessed. Keys in the `Destroyed` state will panic on\n-    /// any call to `with`.\n+    /// any call to [`with`].\n+    ///\n+    /// [`with`]: ../../std/thread/struct.LocalKey.html#method.with\n+    /// [`Copy`]: ../../std/marker/trait.Copy.html\n     #[unstable(feature = \"thread_local_state\",\n                reason = \"state querying was recently added\",\n                issue = \"27716\")]"}]}