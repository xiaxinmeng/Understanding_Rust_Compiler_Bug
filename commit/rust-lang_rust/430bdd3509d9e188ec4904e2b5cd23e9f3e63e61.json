{"sha": "430bdd3509d9e188ec4904e2b5cd23e9f3e63e61", "node_id": "C_kwDOAAsO6NoAKDQzMGJkZDM1MDlkOWUxODhlYzQ5MDRlMmI1Y2QyM2U5ZjNlNjNlNjE", "commit": {"author": {"name": "Luna Razzaghipour", "email": "lunarazzaghipour@gmail.com", "date": "2023-05-24T14:22:14Z"}, "committer": {"name": "Luna Razzaghipour", "email": "lunarazzaghipour@gmail.com", "date": "2023-05-24T14:22:14Z"}, "message": "Run the main thread under the User Interactive QoS class", "tree": {"sha": "ecdb1e21bf99ab46a11ce57550e86d3288d9a809", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ecdb1e21bf99ab46a11ce57550e86d3288d9a809"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/430bdd3509d9e188ec4904e2b5cd23e9f3e63e61", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN SSH SIGNATURE-----\nU1NIU0lHAAAAAQAAAGgAAAATZWNkc2Etc2hhMi1uaXN0cDI1NgAAAAhuaXN0cDI1NgAAAE\nEEtPEPU+w9oQ90uLBc4R0g0O7C/w+fcT4a+R4nvkvJXioSPGOafBHNQJufyTj3tLLeNtO4\n1H9ztJfn/DlLu2mXigAAAANnaXQAAAAAAAAABnNoYTUxMgAAAGMAAAATZWNkc2Etc2hhMi\n1uaXN0cDI1NgAAAEgAAAAgAkspKy/Yuw6qvNOJ5/vpOL9Yf+x2vbAayQyO9caiQ3cAAAAg\ncv/M2JfzE37kJExJufE9Vp4Ey+GQYPqS3uQPQj0mBiM=\n-----END SSH SIGNATURE-----", "payload": "tree ecdb1e21bf99ab46a11ce57550e86d3288d9a809\nparent 578d99477ab4e01721372014c1fdaf3479fdf34d\nauthor Luna Razzaghipour <lunarazzaghipour@gmail.com> 1684938134 +1000\ncommitter Luna Razzaghipour <lunarazzaghipour@gmail.com> 1684938134 +1000\n\nRun the main thread under the User Interactive QoS class\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/430bdd3509d9e188ec4904e2b5cd23e9f3e63e61", "html_url": "https://github.com/rust-lang/rust/commit/430bdd3509d9e188ec4904e2b5cd23e9f3e63e61", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/430bdd3509d9e188ec4904e2b5cd23e9f3e63e61/comments", "author": {"login": "lunacookies", "id": 31783266, "node_id": "MDQ6VXNlcjMxNzgzMjY2", "avatar_url": "https://avatars.githubusercontent.com/u/31783266?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lunacookies", "html_url": "https://github.com/lunacookies", "followers_url": "https://api.github.com/users/lunacookies/followers", "following_url": "https://api.github.com/users/lunacookies/following{/other_user}", "gists_url": "https://api.github.com/users/lunacookies/gists{/gist_id}", "starred_url": "https://api.github.com/users/lunacookies/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lunacookies/subscriptions", "organizations_url": "https://api.github.com/users/lunacookies/orgs", "repos_url": "https://api.github.com/users/lunacookies/repos", "events_url": "https://api.github.com/users/lunacookies/events{/privacy}", "received_events_url": "https://api.github.com/users/lunacookies/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lunacookies", "id": 31783266, "node_id": "MDQ6VXNlcjMxNzgzMjY2", "avatar_url": "https://avatars.githubusercontent.com/u/31783266?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lunacookies", "html_url": "https://github.com/lunacookies", "followers_url": "https://api.github.com/users/lunacookies/followers", "following_url": "https://api.github.com/users/lunacookies/following{/other_user}", "gists_url": "https://api.github.com/users/lunacookies/gists{/gist_id}", "starred_url": "https://api.github.com/users/lunacookies/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lunacookies/subscriptions", "organizations_url": "https://api.github.com/users/lunacookies/orgs", "repos_url": "https://api.github.com/users/lunacookies/repos", "events_url": "https://api.github.com/users/lunacookies/events{/privacy}", "received_events_url": "https://api.github.com/users/lunacookies/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "578d99477ab4e01721372014c1fdaf3479fdf34d", "url": "https://api.github.com/repos/rust-lang/rust/commits/578d99477ab4e01721372014c1fdaf3479fdf34d", "html_url": "https://github.com/rust-lang/rust/commit/578d99477ab4e01721372014c1fdaf3479fdf34d"}], "stats": {"total": 9, "additions": 8, "deletions": 1}, "files": [{"sha": "3224aeae5645b51cbae0b714d4f4d85811dee028", "filename": "crates/rust-analyzer/src/bin/main.rs", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/430bdd3509d9e188ec4904e2b5cd23e9f3e63e61/crates%2Frust-analyzer%2Fsrc%2Fbin%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/430bdd3509d9e188ec4904e2b5cd23e9f3e63e61/crates%2Frust-analyzer%2Fsrc%2Fbin%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fbin%2Fmain.rs?ref=430bdd3509d9e188ec4904e2b5cd23e9f3e63e61", "patch": "@@ -78,7 +78,14 @@ fn try_main(flags: flags::RustAnalyzer) -> Result<()> {\n                 println!(\"rust-analyzer {}\", rust_analyzer::version());\n                 return Ok(());\n             }\n-            with_extra_thread(\"LspServer\", stdx::thread::QoSClass::Utility, run_server)?;\n+\n+            // rust-analyzer\u2019s \u201cmain thread\u201d is actually a secondary thread\n+            // with an increased stack size at the User Initiated QoS class.\n+            // We use this QoS class because any delay in the main loop\n+            // will make actions like hitting enter in the editor slow.\n+            // rust-analyzer does not block the editor\u2019s render loop,\n+            // so we don\u2019t use User Interactive.\n+            with_extra_thread(\"LspServer\", stdx::thread::QoSClass::UserInitiated, run_server)?;\n         }\n         flags::RustAnalyzerCmd::Parse(cmd) => cmd.run()?,\n         flags::RustAnalyzerCmd::Symbols(cmd) => cmd.run()?,"}]}