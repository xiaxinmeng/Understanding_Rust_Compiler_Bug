{"sha": "00605d58debc26829a1ed106f7a4be3c95860866", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAwNjA1ZDU4ZGViYzI2ODI5YTFlZDEwNmY3YTRiZTNjOTU4NjA4NjY=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-03-26T02:01:00Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-03-26T02:01:00Z"}, "message": "auto merge of #5513 : apasel422/rust/deriving, r=luqmana\n\nThis removes some explicit implementations of `Eq` in favor of `#[deriving(Eq)]` and derives `Clone` for a few core types.", "tree": {"sha": "982a3c4132e439f00280eca48eaf27f9f8dced95", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/982a3c4132e439f00280eca48eaf27f9f8dced95"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/00605d58debc26829a1ed106f7a4be3c95860866", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/00605d58debc26829a1ed106f7a4be3c95860866", "html_url": "https://github.com/rust-lang/rust/commit/00605d58debc26829a1ed106f7a4be3c95860866", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/00605d58debc26829a1ed106f7a4be3c95860866/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b48e6998d7f9f2d6bde9e97a9a720cfd13eb3613", "url": "https://api.github.com/repos/rust-lang/rust/commits/b48e6998d7f9f2d6bde9e97a9a720cfd13eb3613", "html_url": "https://github.com/rust-lang/rust/commit/b48e6998d7f9f2d6bde9e97a9a720cfd13eb3613"}, {"sha": "45677eebf286a39c29d9cd789e76ea1cf2d2b1d0", "url": "https://api.github.com/repos/rust-lang/rust/commits/45677eebf286a39c29d9cd789e76ea1cf2d2b1d0", "html_url": "https://github.com/rust-lang/rust/commit/45677eebf286a39c29d9cd789e76ea1cf2d2b1d0"}], "stats": {"total": 81, "additions": 13, "deletions": 68}, "files": [{"sha": "c97df636386c036fa2625f05c131d599b6c6b136", "filename": "src/libcore/core.rc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Fcore.rc", "raw_url": "https://github.com/rust-lang/rust/raw/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Fcore.rc", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fcore.rc?ref=00605d58debc26829a1ed106f7a4be3c95860866", "patch": "@@ -231,6 +231,7 @@ pub mod rt;\n // can be resolved within libcore.\n #[doc(hidden)]\n pub mod core {\n+    pub use clone;\n     pub use cmp;\n     pub use condition;\n     pub use option;"}, {"sha": "2af9e91a30fce5970ec140d8abe210a30090e031", "filename": "src/libcore/either.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Feither.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Feither.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Feither.rs?ref=00605d58debc26829a1ed106f7a4be3c95860866", "patch": "@@ -17,7 +17,7 @@ use result;\n use vec;\n \n /// The either type\n-#[deriving(Eq)]\n+#[deriving(Clone, Eq)]\n pub enum Either<T, U> {\n     Left(T),\n     Right(U)"}, {"sha": "bb636636953b36db36ae053a9937cd021022c172", "filename": "src/libcore/option.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Foption.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Foption.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Foption.rs?ref=00605d58debc26829a1ed106f7a4be3c95860866", "patch": "@@ -52,7 +52,7 @@ use iter::{BaseIter, MutableIter};\n #[cfg(test)] use str;\n \n /// The option type\n-#[deriving(Eq)]\n+#[deriving(Clone, Eq)]\n pub enum Option<T> {\n     None,\n     Some(T),"}, {"sha": "76aaf14d4ac6ce50a07b347cd10da4d587d339b3", "filename": "src/libcore/path.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Fpath.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Fpath.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fpath.rs?ref=00605d58debc26829a1ed106f7a4be3c95860866", "patch": "@@ -20,7 +20,7 @@ use option::{None, Option, Some};\n use str;\n use to_str::ToStr;\n \n-#[deriving(Eq)]\n+#[deriving(Clone, Eq)]\n pub struct WindowsPath {\n     host: Option<~str>,\n     device: Option<~str>,\n@@ -32,7 +32,7 @@ pub fn WindowsPath(s: &str) -> WindowsPath {\n     GenericPath::from_str(s)\n }\n \n-#[deriving(Eq)]\n+#[deriving(Clone, Eq)]\n pub struct PosixPath {\n     is_absolute: bool,\n     components: ~[~str],"}, {"sha": "350a1de629cd4d370ca22a6c78354e35b803ca5b", "filename": "src/libcore/pipes.rs", "status": "modified", "additions": 1, "deletions": 8, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Fpipes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Fpipes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fpipes.rs?ref=00605d58debc26829a1ed106f7a4be3c95860866", "patch": "@@ -82,7 +82,6 @@ bounded and unbounded protocols allows for less code duplication.\n \n */\n \n-use cmp::Eq;\n use cast::{forget, reinterpret_cast, transmute};\n use cell::Cell;\n use either::{Either, Left, Right};\n@@ -103,20 +102,14 @@ macro_rules! move_it (\n )\n \n #[doc(hidden)]\n+#[deriving(Eq)]\n enum State {\n     Empty,\n     Full,\n     Blocked,\n     Terminated\n }\n \n-impl Eq for State {\n-    fn eq(&self, other: &State) -> bool {\n-        ((*self) as uint) == ((*other) as uint)\n-    }\n-    fn ne(&self, other: &State) -> bool { !(*self).eq(other) }\n-}\n-\n pub struct BufferHeader {\n     // Tracks whether this buffer needs to be freed. We can probably\n     // get away with restricting it to 0 or 1, if we're careful."}, {"sha": "0df9f78a3d6d77494a8ab2fb7b4b1b5f80dbfd9e", "filename": "src/libcore/result.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Fresult.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Fresult.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fresult.rs?ref=00605d58debc26829a1ed106f7a4be3c95860866", "patch": "@@ -20,7 +20,7 @@ use option::{None, Option, Some};\n use vec;\n \n /// The result type\n-#[deriving(Eq)]\n+#[deriving(Clone, Eq)]\n pub enum Result<T, U> {\n     /// Contains the successful result value\n     Ok(T),"}, {"sha": "349a10bb809830f4dc36d6f8fb719883679128bf", "filename": "src/libcore/task/mod.rs", "status": "modified", "additions": 1, "deletions": 10, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Ftask%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Ftask%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Ftask%2Fmod.rs?ref=00605d58debc26829a1ed106f7a4be3c95860866", "patch": "@@ -72,21 +72,12 @@ pub enum Task {\n  * If you wish for this result's delivery to block until all linked and/or\n  * children tasks complete, recommend using a result future.\n  */\n+#[deriving(Eq)]\n pub enum TaskResult {\n     Success,\n     Failure,\n }\n \n-impl Eq for TaskResult {\n-    fn eq(&self, other: &TaskResult) -> bool {\n-        match ((*self), (*other)) {\n-            (Success, Success) | (Failure, Failure) => true,\n-            (Success, _) | (Failure, _) => false\n-        }\n-    }\n-    fn ne(&self, other: &TaskResult) -> bool { !(*self).eq(other) }\n-}\n-\n /// Scheduler modes\n #[deriving(Eq)]\n pub enum SchedMode {"}, {"sha": "a69655cd1255a86051759ff5acb2fa24ec767097", "filename": "src/libcore/vec.rs", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Fvec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibcore%2Fvec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fvec.rs?ref=00605d58debc26829a1ed106f7a4be3c95860866", "patch": "@@ -2533,12 +2533,7 @@ impl<A:Copy> iter::CopyableNonstrictIter<A> for @[A] {\n impl<A:Clone> Clone for ~[A] {\n     #[inline]\n     fn clone(&self) -> ~[A] {\n-        let mut dolly = ~[];\n-        vec::reserve(&mut dolly, self.len());\n-        for self.each |item| {\n-            dolly.push(item.clone());\n-        }\n-        return dolly;\n+        self.map(|item| item.clone())\n     }\n }\n "}, {"sha": "7d20eb7b891febfb0c97b92e55ed8c6491ac836e", "filename": "src/libstd/bigint.rs", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibstd%2Fbigint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibstd%2Fbigint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fbigint.rs?ref=00605d58debc26829a1ed106f7a4be3c95860866", "patch": "@@ -557,13 +557,9 @@ priv fn get_radix_base(radix: uint) -> (uint, uint) {\n }\n \n /// A Sign is a BigInt's composing element.\n+#[deriving(Eq)]\n pub enum Sign { Minus, Zero, Plus }\n \n-impl Eq for Sign {\n-    fn eq(&self, other: &Sign) -> bool { self.cmp(other) == 0 }\n-    fn ne(&self, other: &Sign) -> bool { self.cmp(other) != 0 }\n-}\n-\n impl Ord for Sign {\n     fn lt(&self, other: &Sign) -> bool { self.cmp(other) <  0 }\n     fn le(&self, other: &Sign) -> bool { self.cmp(other) <= 0 }"}, {"sha": "a9b9b2977cded41ce233c62dc2504e64abe17cb1", "filename": "src/libstd/json.rs", "status": "modified", "additions": 1, "deletions": 9, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibstd%2Fjson.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibstd%2Fjson.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fjson.rs?ref=00605d58debc26829a1ed106f7a4be3c95860866", "patch": "@@ -35,6 +35,7 @@ pub enum Json {\n pub type List = ~[Json];\n pub type Object = LinearMap<~str, Json>;\n \n+#[deriving(Eq)]\n pub struct Error {\n     line: uint,\n     col: uint,\n@@ -1060,15 +1061,6 @@ impl Ord for Json {\n     fn gt(&self, other: &Json) -> bool { (*other).lt(&(*self))  }\n }\n \n-impl Eq for Error {\n-    fn eq(&self, other: &Error) -> bool {\n-        (*self).line == other.line &&\n-        (*self).col == other.col &&\n-        (*self).msg == other.msg\n-    }\n-    fn ne(&self, other: &Error) -> bool { !(*self).eq(other) }\n-}\n-\n trait ToJson { fn to_json(&self) -> Json; }\n \n impl ToJson for Json {"}, {"sha": "9ac302ed890cad0dd9b3a6c3feb2cf38b38f80d0", "filename": "src/libstd/time.rs", "status": "modified", "additions": 2, "deletions": 25, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibstd%2Ftime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00605d58debc26829a1ed106f7a4be3c95860866/src%2Flibstd%2Ftime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Ftime.rs?ref=00605d58debc26829a1ed106f7a4be3c95860866", "patch": "@@ -40,6 +40,7 @@ pub mod rustrt {\n /// A record specifying a time value in seconds and nanoseconds.\n #[auto_encode]\n #[auto_decode]\n+#[deriving(Eq)]\n pub struct Timespec { sec: i64, nsec: i32 }\n \n /*\n@@ -57,13 +58,6 @@ pub impl Timespec {\n     }\n }\n \n-impl Eq for Timespec {\n-    fn eq(&self, other: &Timespec) -> bool {\n-        self.sec == other.sec && self.nsec == other.nsec\n-    }\n-    fn ne(&self, other: &Timespec) -> bool { !self.eq(other) }\n-}\n-\n impl Ord for Timespec {\n     fn lt(&self, other: &Timespec) -> bool {\n         self.sec < other.sec ||\n@@ -117,6 +111,7 @@ pub fn tzset() {\n \n #[auto_encode]\n #[auto_decode]\n+#[deriving(Eq)]\n pub struct Tm {\n     tm_sec: i32, // seconds after the minute ~[0-60]\n     tm_min: i32, // minutes after the hour ~[0-59]\n@@ -132,24 +127,6 @@ pub struct Tm {\n     tm_nsec: i32, // nanoseconds\n }\n \n-impl Eq for Tm {\n-    fn eq(&self, other: &Tm) -> bool {\n-        self.tm_sec == (*other).tm_sec &&\n-        self.tm_min == (*other).tm_min &&\n-        self.tm_hour == (*other).tm_hour &&\n-        self.tm_mday == (*other).tm_mday &&\n-        self.tm_mon == (*other).tm_mon &&\n-        self.tm_year == (*other).tm_year &&\n-        self.tm_wday == (*other).tm_wday &&\n-        self.tm_yday == (*other).tm_yday &&\n-        self.tm_isdst == (*other).tm_isdst &&\n-        self.tm_gmtoff == (*other).tm_gmtoff &&\n-        self.tm_zone == (*other).tm_zone &&\n-        self.tm_nsec == (*other).tm_nsec\n-    }\n-    fn ne(&self, other: &Tm) -> bool { !self.eq(other) }\n-}\n-\n pub fn empty_tm() -> Tm {\n     Tm {\n         tm_sec: 0_i32,"}]}