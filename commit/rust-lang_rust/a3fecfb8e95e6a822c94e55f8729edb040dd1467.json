{"sha": "a3fecfb8e95e6a822c94e55f8729edb040dd1467", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEzZmVjZmI4ZTk1ZTZhODIyYzk0ZTU1Zjg3MjllZGIwNDBkZDE0Njc=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-02-28T11:15:36Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-02-28T11:15:36Z"}, "message": "Rollup merge of #48488 - varkor:handle-gdb-error-compiletest, r=michaelwoerister\n\nHandle gdb command failure gracefully in compiletest\n\nPreviously, if the gdb command was available, but threw an error, compiletest would panic.  This is obviously not good. Now, gdb is treated as missing if calling `gdb --version` does not output anything on stdout.", "tree": {"sha": "fdcff0ef64d41ea9975a1aad013c89fa1a78b0ea", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fdcff0ef64d41ea9975a1aad013c89fa1a78b0ea"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a3fecfb8e95e6a822c94e55f8729edb040dd1467", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJalo9ZCRBK7hj4Ov3rIwAAdHIIACwTtsejhUluLXATLQIgh9kw\n3lZIwaRhdy6wuXTFhh5NGlng13wFKgyrOWrFCo9iN/tWMrgvxFcGA7Y/LwWobqSY\nHow3QiR4i9bdUbcoQA6Zjb04HzrIJuy5kAO6tIoasN1ZSN6hCh8+BKSZ5Ck8VP3M\ni/RsozOGyogjBV/USqHTaEaW62JxcCqWjNW2dPOR5DdyOjjDr3ivhofALlt79BcB\nnhmmcy0IcZPFpIl0Meo6yWAyF2xczf57p9Ols+ybWlhgXu+Iz2zUjMib1YFKRmQ5\nZdIA1H97Hu5nVvkrg+JqZ9F95WqTr//fVUTlCC0y2QvFxz/phP5hMd1xYWiV4/0=\n=zv44\n-----END PGP SIGNATURE-----\n", "payload": "tree fdcff0ef64d41ea9975a1aad013c89fa1a78b0ea\nparent 428f00250d3cc859090c7db0e5e5df15b744cc02\nparent 70db41cdf74589c957cb930cdd58ebf6bafee5af\nauthor kennytm <kennytm@gmail.com> 1519816536 +0800\ncommitter GitHub <noreply@github.com> 1519816536 +0800\n\nRollup merge of #48488 - varkor:handle-gdb-error-compiletest, r=michaelwoerister\n\nHandle gdb command failure gracefully in compiletest\n\nPreviously, if the gdb command was available, but threw an error, compiletest would panic.  This is obviously not good. Now, gdb is treated as missing if calling `gdb --version` does not output anything on stdout.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a3fecfb8e95e6a822c94e55f8729edb040dd1467", "html_url": "https://github.com/rust-lang/rust/commit/a3fecfb8e95e6a822c94e55f8729edb040dd1467", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a3fecfb8e95e6a822c94e55f8729edb040dd1467/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "428f00250d3cc859090c7db0e5e5df15b744cc02", "url": "https://api.github.com/repos/rust-lang/rust/commits/428f00250d3cc859090c7db0e5e5df15b744cc02", "html_url": "https://github.com/rust-lang/rust/commit/428f00250d3cc859090c7db0e5e5df15b744cc02"}, {"sha": "70db41cdf74589c957cb930cdd58ebf6bafee5af", "url": "https://api.github.com/repos/rust-lang/rust/commits/70db41cdf74589c957cb930cdd58ebf6bafee5af", "html_url": "https://github.com/rust-lang/rust/commit/70db41cdf74589c957cb930cdd58ebf6bafee5af"}], "stats": {"total": 17, "additions": 6, "deletions": 11}, "files": [{"sha": "304143eaa0bfffcd32ea7c10e1303791786a9ca1", "filename": "src/tools/compiletest/src/main.rs", "status": "modified", "additions": 6, "deletions": 11, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/a3fecfb8e95e6a822c94e55f8729edb040dd1467/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3fecfb8e95e6a822c94e55f8729edb040dd1467/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs?ref=a3fecfb8e95e6a822c94e55f8729edb040dd1467", "patch": "@@ -736,17 +736,12 @@ fn analyze_gdb(gdb: Option<String>) -> (Option<String>, Option<u32>, bool) {\n         Some(ref s) => s,\n     };\n \n-    let version_line = Command::new(gdb)\n-        .arg(\"--version\")\n-        .output()\n-        .map(|output| {\n-            String::from_utf8_lossy(&output.stdout)\n-                .lines()\n-                .next()\n-                .unwrap()\n-                .to_string()\n-        })\n-        .ok();\n+    let mut version_line = None;\n+    if let Ok(output) = Command::new(gdb).arg(\"--version\").output() {\n+        if let Some(first_line) = String::from_utf8_lossy(&output.stdout).lines().next() {\n+            version_line = Some(first_line.to_string());\n+        }\n+    }\n \n     let version = match version_line {\n         Some(line) => extract_gdb_version(&line),"}]}