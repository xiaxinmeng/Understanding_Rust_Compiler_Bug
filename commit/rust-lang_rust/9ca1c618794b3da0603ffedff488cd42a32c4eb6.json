{"sha": "9ca1c618794b3da0603ffedff488cd42a32c4eb6", "node_id": "MDY6Q29tbWl0NzI0NzEyOjljYTFjNjE4Nzk0YjNkYTA2MDNmZmVkZmY0ODhjZDQyYTMyYzRlYjY=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2015-06-05T16:53:17Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2015-07-22T13:34:00Z"}, "message": "Instrumentation in effort to understand treatment of `allow_internal_unstable`.\n\nIt is all `debug!` instrumentation so it should not impose a cost on\nnon-debug builds.", "tree": {"sha": "c6fe2bded54dc421dca17017d444d28e19a4b98b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c6fe2bded54dc421dca17017d444d28e19a4b98b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9ca1c618794b3da0603ffedff488cd42a32c4eb6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9ca1c618794b3da0603ffedff488cd42a32c4eb6", "html_url": "https://github.com/rust-lang/rust/commit/9ca1c618794b3da0603ffedff488cd42a32c4eb6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9ca1c618794b3da0603ffedff488cd42a32c4eb6/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "07afe91fda3df8e3b7bbb14006a64d136627f33c", "url": "https://api.github.com/repos/rust-lang/rust/commits/07afe91fda3df8e3b7bbb14006a64d136627f33c", "html_url": "https://github.com/rust-lang/rust/commit/07afe91fda3df8e3b7bbb14006a64d136627f33c"}], "stats": {"total": 18, "additions": 16, "deletions": 2}, "files": [{"sha": "6d3bc7fb68c1418ca20b6775212eecb3b056bb9d", "filename": "src/librustc/middle/stability.rs", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/9ca1c618794b3da0603ffedff488cd42a32c4eb6/src%2Flibrustc%2Fmiddle%2Fstability.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9ca1c618794b3da0603ffedff488cd42a32c4eb6/src%2Flibrustc%2Fmiddle%2Fstability.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fstability.rs?ref=9ca1c618794b3da0603ffedff488cd42a32c4eb6", "patch": "@@ -543,9 +543,19 @@ pub fn check_pat(tcx: &ty::ctxt, pat: &ast::Pat,\n \n fn maybe_do_stability_check(tcx: &ty::ctxt, id: ast::DefId, span: Span,\n                             cb: &mut FnMut(ast::DefId, Span, &Option<&Stability>)) {\n-    if !is_staged_api(tcx, id) { return  }\n-    if is_internal(tcx, span) { return }\n+    if !is_staged_api(tcx, id) {\n+        debug!(\"maybe_do_stability_check: \\\n+                skipping id={:?} since it is not staged_api\", id);\n+        return;\n+    }\n+    if is_internal(tcx, span) {\n+        debug!(\"maybe_do_stability_check: \\\n+                skipping span={:?} since it is internal\", span);\n+        return;\n+    }\n     let ref stability = lookup(tcx, id);\n+    debug!(\"maybe_do_stability_check: \\\n+            inspecting id={:?} span={:?} of stability={:?}\", id, span, stability);\n     cb(id, span, stability);\n }\n "}, {"sha": "17e6b2c2e12df69fc03d79c0793281d380e528bc", "filename": "src/libsyntax/codemap.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9ca1c618794b3da0603ffedff488cd42a32c4eb6/src%2Flibsyntax%2Fcodemap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9ca1c618794b3da0603ffedff488cd42a32c4eb6/src%2Flibsyntax%2Fcodemap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fcodemap.rs?ref=9ca1c618794b3da0603ffedff488cd42a32c4eb6", "patch": "@@ -980,6 +980,10 @@ impl CodeMap {\n                             mac_span.lo <= span.lo && span.hi <= mac_span.hi\n                         });\n \n+                    debug!(\"span_allows_unstable: span: {:?} call_site: {:?} callee: {:?}\",\n+                           (span.lo, span.hi),\n+                           (info.call_site.lo, info.call_site.hi),\n+                           info.callee.span.map(|x| (x.lo, x.hi)));\n                     debug!(\"span_allows_unstable: from this expansion? {}, allows unstable? {}\",\n                            span_comes_from_this_expansion,\n                            info.callee.allow_internal_unstable);"}]}