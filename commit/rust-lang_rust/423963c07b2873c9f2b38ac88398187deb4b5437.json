{"sha": "423963c07b2873c9f2b38ac88398187deb4b5437", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQyMzk2M2MwN2IyODczYzlmMmIzOGFjODgzOTgxODdkZWI0YjU0Mzc=", "commit": {"author": {"name": "Joshua Nelson", "email": "jyn514@gmail.com", "date": "2021-04-22T23:38:20Z"}, "committer": {"name": "Joshua Nelson", "email": "jyn514@gmail.com", "date": "2021-04-22T23:38:20Z"}, "message": "Remove unnecessary `edition` field on SharedContext", "tree": {"sha": "69d5bbfdeff32da720650677aba9df1614f68a49", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/69d5bbfdeff32da720650677aba9df1614f68a49"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/423963c07b2873c9f2b38ac88398187deb4b5437", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/423963c07b2873c9f2b38ac88398187deb4b5437", "html_url": "https://github.com/rust-lang/rust/commit/423963c07b2873c9f2b38ac88398187deb4b5437", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/423963c07b2873c9f2b38ac88398187deb4b5437/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "640cc741e0ecd54d0365772675727b98584d4465", "url": "https://api.github.com/repos/rust-lang/rust/commits/640cc741e0ecd54d0365772675727b98584d4465", "html_url": "https://github.com/rust-lang/rust/commit/640cc741e0ecd54d0365772675727b98584d4465"}], "stats": {"total": 19, "additions": 10, "deletions": 9}, "files": [{"sha": "75174e84a08da4c06fe0b22149445c6561338b10", "filename": "src/librustdoc/html/render/context.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/423963c07b2873c9f2b38ac88398187deb4b5437/src%2Flibrustdoc%2Fhtml%2Frender%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/423963c07b2873c9f2b38ac88398187deb4b5437/src%2Flibrustdoc%2Fhtml%2Frender%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fcontext.rs?ref=423963c07b2873c9f2b38ac88398187deb4b5437", "patch": "@@ -111,8 +111,6 @@ crate struct SharedContext<'tcx> {\n     crate static_root_path: Option<String>,\n     /// The fs handle we are working with.\n     crate fs: DocFS,\n-    /// The default edition used to parse doctests.\n-    crate edition: Edition,\n     pub(super) codes: ErrorCodes,\n     pub(super) playground: Option<markdown::Playground>,\n     all: RefCell<AllTypes>,\n@@ -141,6 +139,10 @@ impl SharedContext<'_> {\n     crate fn maybe_collapsed_doc_value<'a>(&self, item: &'a clean::Item) -> Option<String> {\n         if self.collapsed { item.collapsed_doc_value() } else { item.doc_value() }\n     }\n+\n+    crate fn edition(&self) -> Edition {\n+        self.tcx.sess.edition()\n+    }\n }\n \n impl<'tcx> Context<'tcx> {\n@@ -434,7 +436,6 @@ impl<'tcx> FormatRenderer<'tcx> for Context<'tcx> {\n             resource_suffix,\n             static_root_path,\n             fs: DocFS::new(sender),\n-            edition: tcx.sess.edition(),\n             codes: ErrorCodes::from(unstable_features.is_nightly_build()),\n             playground,\n             all: RefCell::new(AllTypes::new()),"}, {"sha": "6cf4bedadcc933f1578a1253c99d1c9e56c27a13", "filename": "src/librustdoc/html/render/mod.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/423963c07b2873c9f2b38ac88398187deb4b5437/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/423963c07b2873c9f2b38ac88398187deb4b5437/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs?ref=423963c07b2873c9f2b38ac88398187deb4b5437", "patch": "@@ -530,7 +530,7 @@ fn render_markdown(\n             &links,\n             &mut ids,\n             cx.shared.codes,\n-            cx.shared.edition,\n+            cx.shared.edition(),\n             &cx.shared.playground\n         )\n         .into_string()\n@@ -660,7 +660,7 @@ fn short_item_info(\n                 &note,\n                 &mut ids,\n                 error_codes,\n-                cx.shared.edition,\n+                cx.shared.edition(),\n                 &cx.shared.playground,\n             );\n             message.push_str(&format!(\": {}\", html.into_string()));\n@@ -702,7 +702,7 @@ fn short_item_info(\n                     &unstable_reason.as_str(),\n                     &mut ids,\n                     error_codes,\n-                    cx.shared.edition,\n+                    cx.shared.edition(),\n                     &cx.shared.playground,\n                 )\n                 .into_string()\n@@ -1358,7 +1358,7 @@ fn render_impl(\n                     &i.impl_item.links(cx),\n                     &mut ids,\n                     cx.shared.codes,\n-                    cx.shared.edition,\n+                    cx.shared.edition(),\n                     &cx.shared.playground\n                 )\n                 .into_string()"}, {"sha": "8e10c696df05d3f9fa452f446ee7299d1a0c5805", "filename": "src/librustdoc/html/render/write_shared.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/423963c07b2873c9f2b38ac88398187deb4b5437/src%2Flibrustdoc%2Fhtml%2Frender%2Fwrite_shared.rs", "raw_url": "https://github.com/rust-lang/rust/raw/423963c07b2873c9f2b38ac88398187deb4b5437/src%2Flibrustdoc%2Fhtml%2Frender%2Fwrite_shared.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fwrite_shared.rs?ref=423963c07b2873c9f2b38ac88398187deb4b5437", "patch": "@@ -425,7 +425,7 @@ pub(super) fn write_shared(\n             md_opts.output = cx.dst.clone();\n             md_opts.external_html = (*cx.shared).layout.external_html.clone();\n \n-            crate::markdown::render(&index_page, md_opts, cx.shared.edition)\n+            crate::markdown::render(&index_page, md_opts, cx.shared.edition())\n                 .map_err(|e| Error::new(e, &index_page))?;\n         } else {\n             let dst = cx.dst.join(\"index.html\");"}, {"sha": "5a2a165191a604fb60d7099d64fd9cd084f9c247", "filename": "src/librustdoc/html/sources.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/423963c07b2873c9f2b38ac88398187deb4b5437/src%2Flibrustdoc%2Fhtml%2Fsources.rs", "raw_url": "https://github.com/rust-lang/rust/raw/423963c07b2873c9f2b38ac88398187deb4b5437/src%2Flibrustdoc%2Fhtml%2Fsources.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fsources.rs?ref=423963c07b2873c9f2b38ac88398187deb4b5437", "patch": "@@ -129,7 +129,7 @@ impl SourceCollector<'_, 'tcx> {\n             &self.scx.layout,\n             &page,\n             \"\",\n-            |buf: &mut _| print_src(buf, contents, self.scx.edition),\n+            |buf: &mut _| print_src(buf, contents, self.scx.edition()),\n             &self.scx.style_files,\n         );\n         self.scx.fs.write(&cur, v.as_bytes())?;"}]}