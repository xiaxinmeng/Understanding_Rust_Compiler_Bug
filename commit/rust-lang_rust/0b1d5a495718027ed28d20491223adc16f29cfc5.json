{"sha": "0b1d5a495718027ed28d20491223adc16f29cfc5", "node_id": "C_kwDOAAsO6NoAKDBiMWQ1YTQ5NTcxODAyN2VkMjhkMjA0OTEyMjNhZGMxNmYyOWNmYzU", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-07-24T14:17:33Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-07-24T17:35:05Z"}, "message": "test all of the autocfg queries", "tree": {"sha": "08846fe7ac6b988acd3b27625ab6b34d6f152895", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/08846fe7ac6b988acd3b27625ab6b34d6f152895"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0b1d5a495718027ed28d20491223adc16f29cfc5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0b1d5a495718027ed28d20491223adc16f29cfc5", "html_url": "https://github.com/rust-lang/rust/commit/0b1d5a495718027ed28d20491223adc16f29cfc5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0b1d5a495718027ed28d20491223adc16f29cfc5/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d905901d65a2725992fba6a634147b3ddaafaa1d", "url": "https://api.github.com/repos/rust-lang/rust/commits/d905901d65a2725992fba6a634147b3ddaafaa1d", "html_url": "https://github.com/rust-lang/rust/commit/d905901d65a2725992fba6a634147b3ddaafaa1d"}], "stats": {"total": 18, "additions": 15, "deletions": 3}, "files": [{"sha": "5fbf89c86b9694b305cbc21b84a0c611bd301006", "filename": "README.md", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/0b1d5a495718027ed28d20491223adc16f29cfc5/README.md", "raw_url": "https://github.com/rust-lang/rust/raw/0b1d5a495718027ed28d20491223adc16f29cfc5/README.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/README.md?ref=0b1d5a495718027ed28d20491223adc16f29cfc5", "patch": "@@ -409,9 +409,9 @@ Moreover, Miri recognizes some environment variables:\n   checkout. Note that changing files in that directory does not automatically\n   trigger a re-build of the standard library; you have to clear the Miri build\n   cache manually (on Linux, `rm -rf ~/.cache/miri`).\n-* `MIRI_SYSROOT` (recognized by `cargo miri` and the Miri driver) indicates the\n-  sysroot to use. Only set this if you do not want to use the automatically\n-  created sysroot.\n+* `MIRI_SYSROOT` (recognized by `cargo miri` and the Miri driver) indicates the sysroot to use. When\n+  using `cargo miri`, only set this if you do not want to use the automatically created sysroot. For\n+  directly invoking the Miri driver, this variable (or a `--sysroot` flag) is mandatory.\n * `MIRI_TEST_TARGET` (recognized by the test suite and the `./miri` script) indicates which target\n   architecture to test against.  `miri` and `cargo miri` accept the `--target` flag for the same\n   purpose."}, {"sha": "6c1f4d80d3392c26c13b3f4bd48bf6b5f18b9de0", "filename": "test-cargo-miri/build.rs", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/0b1d5a495718027ed28d20491223adc16f29cfc5/test-cargo-miri%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0b1d5a495718027ed28d20491223adc16f29cfc5/test-cargo-miri%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Fbuild.rs?ref=0b1d5a495718027ed28d20491223adc16f29cfc5", "patch": "@@ -25,4 +25,16 @@ fn main() {\n     let a = autocfg::new();\n     assert!(a.probe_sysroot_crate(\"std\"));\n     assert!(!a.probe_sysroot_crate(\"doesnotexist\"));\n+    assert!(a.probe_rustc_version(1, 0));\n+    assert!(!a.probe_rustc_version(2, 0));\n+    assert!(a.probe_type(\"i128\"));\n+    assert!(!a.probe_type(\"doesnotexist\"));\n+    assert!(a.probe_trait(\"Send\"));\n+    assert!(!a.probe_trait(\"doesnotexist\"));\n+    assert!(a.probe_path(\"std::num\"));\n+    assert!(!a.probe_path(\"doesnotexist\"));\n+    assert!(a.probe_constant(\"i32::MAX\"));\n+    assert!(!a.probe_constant(\"doesnotexist\"));\n+    assert!(a.probe_expression(\"Box::new(0)\"));\n+    assert!(!a.probe_expression(\"doesnotexist\"));\n }"}]}