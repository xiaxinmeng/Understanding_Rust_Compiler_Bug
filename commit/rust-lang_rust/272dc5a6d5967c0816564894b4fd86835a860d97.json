{"sha": "272dc5a6d5967c0816564894b4fd86835a860d97", "node_id": "C_kwDOAAsO6NoAKDI3MmRjNWE2ZDU5NjdjMDgxNjU2NDg5NGI0ZmQ4NjgzNWE4NjBkOTc", "commit": {"author": {"name": "bohan", "email": "bohan-zhang@foxmail.com", "date": "2023-05-04T08:30:02Z"}, "committer": {"name": "bohan", "email": "bohan-zhang@foxmail.com", "date": "2023-05-12T16:33:27Z"}, "message": "fix(parse): return unpected when current token is EOF", "tree": {"sha": "7bd36ac85162f9b1bdf496e912ce382afbde9dee", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7bd36ac85162f9b1bdf496e912ce382afbde9dee"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/272dc5a6d5967c0816564894b4fd86835a860d97", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/272dc5a6d5967c0816564894b4fd86835a860d97", "html_url": "https://github.com/rust-lang/rust/commit/272dc5a6d5967c0816564894b4fd86835a860d97", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/272dc5a6d5967c0816564894b4fd86835a860d97/comments", "author": {"login": "bvanjoi", "id": 30187863, "node_id": "MDQ6VXNlcjMwMTg3ODYz", "avatar_url": "https://avatars.githubusercontent.com/u/30187863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bvanjoi", "html_url": "https://github.com/bvanjoi", "followers_url": "https://api.github.com/users/bvanjoi/followers", "following_url": "https://api.github.com/users/bvanjoi/following{/other_user}", "gists_url": "https://api.github.com/users/bvanjoi/gists{/gist_id}", "starred_url": "https://api.github.com/users/bvanjoi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bvanjoi/subscriptions", "organizations_url": "https://api.github.com/users/bvanjoi/orgs", "repos_url": "https://api.github.com/users/bvanjoi/repos", "events_url": "https://api.github.com/users/bvanjoi/events{/privacy}", "received_events_url": "https://api.github.com/users/bvanjoi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bvanjoi", "id": 30187863, "node_id": "MDQ6VXNlcjMwMTg3ODYz", "avatar_url": "https://avatars.githubusercontent.com/u/30187863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bvanjoi", "html_url": "https://github.com/bvanjoi", "followers_url": "https://api.github.com/users/bvanjoi/followers", "following_url": "https://api.github.com/users/bvanjoi/following{/other_user}", "gists_url": "https://api.github.com/users/bvanjoi/gists{/gist_id}", "starred_url": "https://api.github.com/users/bvanjoi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bvanjoi/subscriptions", "organizations_url": "https://api.github.com/users/bvanjoi/orgs", "repos_url": "https://api.github.com/users/bvanjoi/repos", "events_url": "https://api.github.com/users/bvanjoi/events{/privacy}", "received_events_url": "https://api.github.com/users/bvanjoi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "077fc26f0acfa54e9c580534616c17ffc279a9d4", "url": "https://api.github.com/repos/rust-lang/rust/commits/077fc26f0acfa54e9c580534616c17ffc279a9d4", "html_url": "https://github.com/rust-lang/rust/commit/077fc26f0acfa54e9c580534616c17ffc279a9d4"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "c23420661fa595f871327b272fe7226f61dc2f34", "filename": "compiler/rustc_parse/src/parser/mod.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/272dc5a6d5967c0816564894b4fd86835a860d97/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/272dc5a6d5967c0816564894b4fd86835a860d97/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs?ref=272dc5a6d5967c0816564894b4fd86835a860d97", "patch": "@@ -536,7 +536,9 @@ impl<'a> Parser<'a> {\n         } else if inedible.contains(&self.token.kind) {\n             // leave it in the input\n             Ok(false)\n-        } else if self.last_unexpected_token_span == Some(self.token.span) {\n+        } else if self.token.kind != token::Eof\n+            && self.last_unexpected_token_span == Some(self.token.span)\n+        {\n             FatalError.raise();\n         } else {\n             self.expected_one_of_not_found(edible, inedible)"}, {"sha": "2502beab443738adfad219b2dac7ffb0057b26a1", "filename": "tests/ui/parser/issues/issue-111148.rs", "status": "added", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/272dc5a6d5967c0816564894b4fd86835a860d97/tests%2Fui%2Fparser%2Fissues%2Fissue-111148.rs", "raw_url": "https://github.com/rust-lang/rust/raw/272dc5a6d5967c0816564894b4fd86835a860d97/tests%2Fui%2Fparser%2Fissues%2Fissue-111148.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-111148.rs?ref=272dc5a6d5967c0816564894b4fd86835a860d97", "patch": "@@ -0,0 +1,2 @@\n+fn a<<i<Y<w<>#\n+//~^ ERROR expected one of `#`, `>`, `const`, identifier, or lifetime, found `<`"}, {"sha": "e6595a5cbcc45cfa879fc6accdcdf9b78b7a7d64", "filename": "tests/ui/parser/issues/issue-111148.stderr", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/272dc5a6d5967c0816564894b4fd86835a860d97/tests%2Fui%2Fparser%2Fissues%2Fissue-111148.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/272dc5a6d5967c0816564894b4fd86835a860d97/tests%2Fui%2Fparser%2Fissues%2Fissue-111148.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-111148.stderr?ref=272dc5a6d5967c0816564894b4fd86835a860d97", "patch": "@@ -0,0 +1,8 @@\n+error: expected one of `#`, `>`, `const`, identifier, or lifetime, found `<`\n+  --> $DIR/issue-111148.rs:1:6\n+   |\n+LL | fn a<<i<Y<w<>#\n+   |      ^ expected one of `#`, `>`, `const`, identifier, or lifetime\n+\n+error: aborting due to previous error\n+"}]}