{"sha": "44954ab52d82fe5ae5222c3bfd482d38c3db0baa", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ0OTU0YWI1MmQ4MmZlNWFlNTIyMmMzYmZkNDgyZDM4YzNkYjBiYWE=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2017-12-21T17:16:21Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2017-12-26T16:00:46Z"}, "message": "Clarify toolstate names. Move publish.py to a more convenient location.", "tree": {"sha": "d9dee3177bf9a289fb87a7a43f33bcb9c9cea3ad", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d9dee3177bf9a289fb87a7a43f33bcb9c9cea3ad"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/44954ab52d82fe5ae5222c3bfd482d38c3db0baa", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlpCci4ACgkQ/vbIBR0O\nATz9IQ/9HvBv94LjrP6phTwcZLSocAyhCS+bN37stMDb4VVHhGpXoLOCPXM55Jep\ngG/hFDzc+rbetXnMsjF++OJt7yrtSdfMQN5B8mqxwuvgiU46mR1yztEaSB3i3BZG\n2l4LxBB+X7tb1ca20FzDIey6+3hss70b9q/+yGwCJIz3C/mpEM5zEGFNJO9NIWPr\nTN5Aytb90Sb3Pi6x7ZyjAGNQ/JSubosdcxBay+ueDPDx2zWRLEYng7ffctjFBXwh\nTpm2MsH3hMiECqOTiTaLmX5fpv3H+StjT0AF4F2bU5C5t5hf51VgUC3Eb/lx5xPa\nTbLiCECXpLYIykggbgyIX1cail/XCMrJ1Uf2C+7QSzIUUdEMTtEHIVowgjxLwWtN\nXLC5iKfoJ0qkEqV5hePOE/hKwjatQeq5zfClXtJ7mrwqdZ3Wa/xp6JeKtn0PyzfR\nWmM0W8l9dGfSAkw88ShD9HwUxhxETkTUSo7Lmwoy+tkEPVYg8fSQFFzm7ygc+mBS\ncEBgU9kx2uV46mzoxJZqTMK3KV/Z53n14tULWMJwTvNWjvvbLudH5nZuaolwqSsQ\nlXUI0HHHjsqRfeVZhygfkuk/M64MT8EZWFYj4TAcooVL/GFEJyP6Hs3PzJjVhdZl\ntD8lZVa2UjmMiPb//44Id3TrDTg+L9dVhLR1HbKr74emyoTbC2Q=\n=6fqj\n-----END PGP SIGNATURE-----", "payload": "tree d9dee3177bf9a289fb87a7a43f33bcb9c9cea3ad\nparent d7488c308963ddc98811cafc95f75cd1647baf0a\nauthor kennytm <kennytm@gmail.com> 1513876581 +0800\ncommitter kennytm <kennytm@gmail.com> 1514304046 +0800\n\nClarify toolstate names. Move publish.py to a more convenient location.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/44954ab52d82fe5ae5222c3bfd482d38c3db0baa", "html_url": "https://github.com/rust-lang/rust/commit/44954ab52d82fe5ae5222c3bfd482d38c3db0baa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/44954ab52d82fe5ae5222c3bfd482d38c3db0baa/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d7488c308963ddc98811cafc95f75cd1647baf0a", "url": "https://api.github.com/repos/rust-lang/rust/commits/d7488c308963ddc98811cafc95f75cd1647baf0a", "html_url": "https://github.com/rust-lang/rust/commit/d7488c308963ddc98811cafc95f75cd1647baf0a"}], "stats": {"total": 25, "additions": 13, "deletions": 12}, "files": [{"sha": "74099b3014a26b41fad70d82827090def9be022d", "filename": ".travis.yml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/44954ab52d82fe5ae5222c3bfd482d38c3db0baa/.travis.yml", "raw_url": "https://github.com/rust-lang/rust/raw/44954ab52d82fe5ae5222c3bfd482d38c3db0baa/.travis.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.travis.yml?ref=44954ab52d82fe5ae5222c3bfd482d38c3db0baa", "patch": "@@ -188,7 +188,7 @@ matrix:\n       script:\n         MESSAGE_FILE=$(mktemp -t msg.XXXXXX);\n         . src/ci/docker/x86_64-gnu-tools/repo.sh;\n-        commit_toolstate_change \"$MESSAGE_FILE\" \"$TRAVIS_BUILD_DIR/src/ci/docker/x86_64-gnu-tools/publish.py\" \"$(git rev-parse HEAD)\" \"$(git log --format=%s -n1 HEAD)\" \"$MESSAGE_FILE\"\n+        commit_toolstate_change \"$MESSAGE_FILE\" \"$TRAVIS_BUILD_DIR/src/tools/publish_toolstate.py\" \"$(git rev-parse HEAD)\" \"$(git log --format=%s -n1 HEAD)\" \"$MESSAGE_FILE\"\n \n env:\n   global:"}, {"sha": "714c01aa5044609841c16762b8620bf5f30c8b64", "filename": "src/bootstrap/check.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/44954ab52d82fe5ae5222c3bfd482d38c3db0baa/src%2Fbootstrap%2Fcheck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/44954ab52d82fe5ae5222c3bfd482d38c3db0baa/src%2Fbootstrap%2Fcheck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fcheck.rs?ref=44954ab52d82fe5ae5222c3bfd482d38c3db0baa", "patch": "@@ -256,7 +256,7 @@ impl Step for Rls {\n         builder.add_rustc_lib_path(compiler, &mut cargo);\n \n         if try_run(build, &mut cargo) {\n-            build.save_toolstate(\"rls\", ToolState::Testing);\n+            build.save_toolstate(\"rls\", ToolState::TestPass);\n         }\n     }\n }\n@@ -302,7 +302,7 @@ impl Step for Rustfmt {\n         builder.add_rustc_lib_path(compiler, &mut cargo);\n \n         if try_run(build, &mut cargo) {\n-            build.save_toolstate(\"rustfmt\", ToolState::Testing);\n+            build.save_toolstate(\"rustfmt\", ToolState::TestPass);\n         }\n     }\n }\n@@ -352,7 +352,7 @@ impl Step for Miri {\n             builder.add_rustc_lib_path(compiler, &mut cargo);\n \n             if try_run(build, &mut cargo) {\n-                build.save_toolstate(\"miri\", ToolState::Testing);\n+                build.save_toolstate(\"miri\", ToolState::TestPass);\n             }\n         } else {\n             eprintln!(\"failed to test miri: could not build\");\n@@ -407,7 +407,7 @@ impl Step for Clippy {\n             builder.add_rustc_lib_path(compiler, &mut cargo);\n \n             if try_run(build, &mut cargo) {\n-                build.save_toolstate(\"clippy-driver\", ToolState::Testing);\n+                build.save_toolstate(\"clippy-driver\", ToolState::TestPass);\n             }\n         } else {\n             eprintln!(\"failed to test clippy: could not build\");"}, {"sha": "ea055cb5d1b99e4e2f3ade6ef961b9a403815363", "filename": "src/bootstrap/tool.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/44954ab52d82fe5ae5222c3bfd482d38c3db0baa/src%2Fbootstrap%2Ftool.rs", "raw_url": "https://github.com/rust-lang/rust/raw/44954ab52d82fe5ae5222c3bfd482d38c3db0baa/src%2Fbootstrap%2Ftool.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftool.rs?ref=44954ab52d82fe5ae5222c3bfd482d38c3db0baa", "patch": "@@ -116,9 +116,9 @@ impl Step for ToolBuild {\n         let mut cargo = prepare_tool_cargo(builder, compiler, target, \"build\", path);\n         let is_expected = build.try_run(&mut cargo);\n         build.save_toolstate(tool, if is_expected {\n-            ToolState::Compiling\n+            ToolState::TestFail\n         } else {\n-            ToolState::Broken\n+            ToolState::BuildFail\n         });\n \n         if !is_expected {"}, {"sha": "f63c1988906fbc0665120e41e956209b2ac2ce86", "filename": "src/bootstrap/toolstate.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/44954ab52d82fe5ae5222c3bfd482d38c3db0baa/src%2Fbootstrap%2Ftoolstate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/44954ab52d82fe5ae5222c3bfd482d38c3db0baa/src%2Fbootstrap%2Ftoolstate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftoolstate.rs?ref=44954ab52d82fe5ae5222c3bfd482d38c3db0baa", "patch": "@@ -9,19 +9,20 @@\n // except according to those terms.\n \n #[derive(Copy, Clone, Debug, Deserialize, Serialize, PartialEq, Eq)]\n+#[serde(rename_all = \"kebab-case\")]\n /// Whether a tool can be compiled, tested or neither\n pub enum ToolState {\n     /// The tool compiles successfully, but the test suite fails\n-    Compiling = 1,\n+    TestFail = 1,\n     /// The tool compiles successfully and its test suite passes\n-    Testing = 2,\n+    TestPass = 2,\n     /// The tool can't even be compiled\n-    Broken = 0,\n+    BuildFail = 0,\n }\n \n impl Default for ToolState {\n     fn default() -> Self {\n         // err on the safe side\n-        ToolState::Broken\n+        ToolState::BuildFail\n     }\n }"}, {"sha": "0d40863c0920fb08a587335712095fd813ad94c3", "filename": "src/ci/docker/x86_64-gnu-tools/checktools.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/44954ab52d82fe5ae5222c3bfd482d38c3db0baa/src%2Fci%2Fdocker%2Fx86_64-gnu-tools%2Fchecktools.sh", "raw_url": "https://github.com/rust-lang/rust/raw/44954ab52d82fe5ae5222c3bfd482d38c3db0baa/src%2Fci%2Fdocker%2Fx86_64-gnu-tools%2Fchecktools.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fx86_64-gnu-tools%2Fchecktools.sh?ref=44954ab52d82fe5ae5222c3bfd482d38c3db0baa", "patch": "@@ -41,6 +41,6 @@ $COMMIT\\t$(cat \"$TOOLSTATE_FILE\")\n     exit 0\n fi\n \n-if grep -q 'Broken\\|Compiling' \"$TOOLSTATE_FILE\"; then\n+if grep -q fail \"$TOOLSTATE_FILE\"; then\n     exit 4\n fi"}, {"sha": "b90947e5a434a3f03725779456dceb6aa0fe33b9", "filename": "src/tools/publish_toolstate.py", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/44954ab52d82fe5ae5222c3bfd482d38c3db0baa/src%2Ftools%2Fpublish_toolstate.py", "raw_url": "https://github.com/rust-lang/rust/raw/44954ab52d82fe5ae5222c3bfd482d38c3db0baa/src%2Ftools%2Fpublish_toolstate.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fpublish_toolstate.py?ref=44954ab52d82fe5ae5222c3bfd482d38c3db0baa", "previous_filename": "src/ci/docker/x86_64-gnu-tools/publish.py"}]}