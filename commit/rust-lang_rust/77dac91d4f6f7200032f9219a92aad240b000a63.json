{"sha": "77dac91d4f6f7200032f9219a92aad240b000a63", "node_id": "C_kwDOAAsO6NoAKDc3ZGFjOTFkNGY2ZjcyMDAwMzJmOTIxOWE5MmFhZDI0MGIwMDBhNjM", "commit": {"author": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2023-04-25T20:09:41Z"}, "committer": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2023-04-29T16:14:32Z"}, "message": "Add test.", "tree": {"sha": "3dd2f94c9e403fbe5c3a11e9f7fe0441e44f73a0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3dd2f94c9e403fbe5c3a11e9f7fe0441e44f73a0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/77dac91d4f6f7200032f9219a92aad240b000a63", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/77dac91d4f6f7200032f9219a92aad240b000a63", "html_url": "https://github.com/rust-lang/rust/commit/77dac91d4f6f7200032f9219a92aad240b000a63", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/77dac91d4f6f7200032f9219a92aad240b000a63/comments", "author": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6ce22733b973355573efd1e6294e585460e90e17", "url": "https://api.github.com/repos/rust-lang/rust/commits/6ce22733b973355573efd1e6294e585460e90e17", "html_url": "https://github.com/rust-lang/rust/commit/6ce22733b973355573efd1e6294e585460e90e17"}], "stats": {"total": 34, "additions": 34, "deletions": 0}, "files": [{"sha": "73aadf3b231cb721bbcf9944748c17f55e93a810", "filename": "tests/mir-opt/dead-store-elimination/place_mention.main.DeadStoreElimination.diff", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/77dac91d4f6f7200032f9219a92aad240b000a63/tests%2Fmir-opt%2Fdead-store-elimination%2Fplace_mention.main.DeadStoreElimination.diff", "raw_url": "https://github.com/rust-lang/rust/raw/77dac91d4f6f7200032f9219a92aad240b000a63/tests%2Fmir-opt%2Fdead-store-elimination%2Fplace_mention.main.DeadStoreElimination.diff", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fmir-opt%2Fdead-store-elimination%2Fplace_mention.main.DeadStoreElimination.diff?ref=77dac91d4f6f7200032f9219a92aad240b000a63", "patch": "@@ -0,0 +1,25 @@\n+- // MIR for `main` before DeadStoreElimination\n++ // MIR for `main` after DeadStoreElimination\n+  \n+  fn main() -> () {\n+      let mut _0: ();                      // return place in scope 0 at $DIR/place_mention.rs:+0:11: +0:11\n+      let mut _1: (&str, &str);            // in scope 0 at $DIR/place_mention.rs:+3:18: +3:36\n+      scope 1 {\n+      }\n+  \n+      bb0: {\n+          StorageLive(_1);                 // scope 0 at $DIR/place_mention.rs:+3:18: +3:36\n+-         _1 = (const \"Hello\", const \"World\"); // scope 0 at $DIR/place_mention.rs:+3:18: +3:36\n+-                                          // mir::Constant\n+-                                          // + span: $DIR/place_mention.rs:8:19: 8:26\n+-                                          // + literal: Const { ty: &str, val: Value(Slice(..)) }\n+-                                          // mir::Constant\n+-                                          // + span: $DIR/place_mention.rs:8:28: 8:35\n+-                                          // + literal: Const { ty: &str, val: Value(Slice(..)) }\n+          PlaceMention(_1);                // scope 0 at $DIR/place_mention.rs:+3:18: +3:36\n+          StorageDead(_1);                 // scope 0 at $DIR/place_mention.rs:+3:36: +3:37\n+          _0 = const ();                   // scope 0 at $DIR/place_mention.rs:+0:11: +4:2\n+          return;                          // scope 0 at $DIR/place_mention.rs:+4:2: +4:2\n+      }\n+  }\n+  "}, {"sha": "59dc74454a40218b8c7925374832969404f7ba98", "filename": "tests/mir-opt/dead-store-elimination/place_mention.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/77dac91d4f6f7200032f9219a92aad240b000a63/tests%2Fmir-opt%2Fdead-store-elimination%2Fplace_mention.rs", "raw_url": "https://github.com/rust-lang/rust/raw/77dac91d4f6f7200032f9219a92aad240b000a63/tests%2Fmir-opt%2Fdead-store-elimination%2Fplace_mention.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fmir-opt%2Fdead-store-elimination%2Fplace_mention.rs?ref=77dac91d4f6f7200032f9219a92aad240b000a63", "patch": "@@ -0,0 +1,9 @@\n+// unit-test: DeadStoreElimination\n+// compile-flags: -Zmir-keep-place-mention\n+\n+// EMIT_MIR place_mention.main.DeadStoreElimination.diff\n+fn main() {\n+    // Verify that we account for the `PlaceMention` statement as a use of the tuple,\n+    // and don't remove it as a dead store.\n+    let (_, _) = (\"Hello\", \"World\");\n+}"}]}