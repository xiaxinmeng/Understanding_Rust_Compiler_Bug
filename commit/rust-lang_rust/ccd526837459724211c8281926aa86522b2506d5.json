{"sha": "ccd526837459724211c8281926aa86522b2506d5", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNjZDUyNjgzNzQ1OTcyNDIxMWM4MjgxOTI2YWE4NjUyMmIyNTA2ZDU=", "commit": {"author": {"name": "Fedor Sakharov", "email": "fedor.sakharov@gmail.com", "date": "2020-05-14T10:53:45Z"}, "committer": {"name": "Fedor Sakharov", "email": "fedor.sakharov@gmail.com", "date": "2020-05-14T10:53:45Z"}, "message": "Ty -> Type", "tree": {"sha": "60c3623eaf5a9414a3dd043e67a0c39b98ef592c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/60c3623eaf5a9414a3dd043e67a0c39b98ef592c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ccd526837459724211c8281926aa86522b2506d5", "comment_count": 0, "verification": {"verified": false, "reason": "unknown_key", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEEOrvX5g4uaJk/ZAnkk9Q25ma/D+4FAl69IzkACgkQk9Q25ma/\nD+71twwAm64KeCiMZ3Nvd1rPZicMiN6QYpeXYoBg6/yX/YPlL1FL2SOt5VCM1XLN\na/jwEY279kUIiQEIMPkhz5rZeOP+EYM3a4NepjR0Kw95zvZLNR82QYQfz9LVDPBs\nzKTIgwVlDKhzFcLMfA1BwwLTGgg3FxP0qHQ2V8sRmZL863oSEpoQC/CR1BU8rGbr\n+/157L0ufI8W9lqBMvnyMyllyoqiy/YQOPzum9QE7EIBaLEvbKqqTbj+k4iuata9\n87Z9vnPm8Zp+HdlNsIfstNNg9oC64negypfhDEfWOsp/46cTd9jIGnDANz34Cepo\nHFVqjrb4cFcOYHJ8OCHo8qI+C0W8y98jOmCnhOQbUSfCapcinKOL2tE5Du7Gameb\nsaixL/cXyiJNC3zHcq4CD8JJUcUsQnpl0Nrx74ota42mjJzZOrnYyGDVpN/LHKG8\nRmTz4ATQ/nVvk/FaM0pvPR0sBwdth4quQZlw3xhbig7nYVT8QgU71EdOyU+rHoCg\nUw1Au63G\n=LJaC\n-----END PGP SIGNATURE-----", "payload": "tree 60c3623eaf5a9414a3dd043e67a0c39b98ef592c\nparent 12bf008ab12f87b2e6d4805681f5a389d9e2f425\nauthor Fedor Sakharov <fedor.sakharov@gmail.com> 1589453625 +0300\ncommitter Fedor Sakharov <fedor.sakharov@gmail.com> 1589453625 +0300\n\nTy -> Type\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ccd526837459724211c8281926aa86522b2506d5", "html_url": "https://github.com/rust-lang/rust/commit/ccd526837459724211c8281926aa86522b2506d5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ccd526837459724211c8281926aa86522b2506d5/comments", "author": {"login": "montekki", "id": 56672, "node_id": "MDQ6VXNlcjU2Njcy", "avatar_url": "https://avatars.githubusercontent.com/u/56672?v=4", "gravatar_id": "", "url": "https://api.github.com/users/montekki", "html_url": "https://github.com/montekki", "followers_url": "https://api.github.com/users/montekki/followers", "following_url": "https://api.github.com/users/montekki/following{/other_user}", "gists_url": "https://api.github.com/users/montekki/gists{/gist_id}", "starred_url": "https://api.github.com/users/montekki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/montekki/subscriptions", "organizations_url": "https://api.github.com/users/montekki/orgs", "repos_url": "https://api.github.com/users/montekki/repos", "events_url": "https://api.github.com/users/montekki/events{/privacy}", "received_events_url": "https://api.github.com/users/montekki/received_events", "type": "User", "site_admin": false}, "committer": {"login": "montekki", "id": 56672, "node_id": "MDQ6VXNlcjU2Njcy", "avatar_url": "https://avatars.githubusercontent.com/u/56672?v=4", "gravatar_id": "", "url": "https://api.github.com/users/montekki", "html_url": "https://github.com/montekki", "followers_url": "https://api.github.com/users/montekki/followers", "following_url": "https://api.github.com/users/montekki/following{/other_user}", "gists_url": "https://api.github.com/users/montekki/gists{/gist_id}", "starred_url": "https://api.github.com/users/montekki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/montekki/subscriptions", "organizations_url": "https://api.github.com/users/montekki/orgs", "repos_url": "https://api.github.com/users/montekki/repos", "events_url": "https://api.github.com/users/montekki/events{/privacy}", "received_events_url": "https://api.github.com/users/montekki/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "12bf008ab12f87b2e6d4805681f5a389d9e2f425", "url": "https://api.github.com/repos/rust-lang/rust/commits/12bf008ab12f87b2e6d4805681f5a389d9e2f425", "html_url": "https://github.com/rust-lang/rust/commit/12bf008ab12f87b2e6d4805681f5a389d9e2f425"}], "stats": {"total": 9, "additions": 7, "deletions": 2}, "files": [{"sha": "840cfdfc8238ef70579f1c2af3ee943cdd74ae2b", "filename": "crates/ra_hir/src/code_model.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/ccd526837459724211c8281926aa86522b2506d5/crates%2Fra_hir%2Fsrc%2Fcode_model.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ccd526837459724211c8281926aa86522b2506d5/crates%2Fra_hir%2Fsrc%2Fcode_model.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fcode_model.rs?ref=ccd526837459724211c8281926aa86522b2506d5", "patch": "@@ -990,10 +990,15 @@ impl TypeParam {\n         }\n     }\n \n-    pub fn default(self, db: &dyn HirDatabase) -> Option<Ty> {\n+    pub fn default(self, db: &dyn HirDatabase) -> Option<Type> {\n         let params = db.generic_defaults(self.id.parent);\n         let local_idx = hir_ty::param_idx(db, self.id)?;\n-        params.get(local_idx).map(|d| d.clone())\n+        let resolver = self.id.parent.resolver(db.upcast());\n+        let environment = TraitEnvironment::lower(db, &resolver);\n+        params.get(local_idx).cloned().map(|ty| Type {\n+            krate: self.id.parent.module(db.upcast()).krate,\n+            ty: InEnvironment { value: ty, environment },\n+        })\n     }\n }\n "}]}