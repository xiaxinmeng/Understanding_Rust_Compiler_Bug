{"sha": "38541b742aae367796c537c8575cc30811d42fb1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM4NTQxYjc0MmFhZTM2Nzc5NmM1MzdjODU3NWNjMzA4MTFkNDJmYjE=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2020-07-09T18:50:34Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-07-09T18:50:34Z"}, "message": "Rollup merge of #74107 - nbdd0121:rustdoc, r=GuillaumeGomez\n\nHide `&mut self` methods from Deref in sidebar if there are no `DerefMut` impl for the type.\n\nThis partially addresses #74083.", "tree": {"sha": "6d0e65c31db4f464a20a6cb9dd1676bfb58619ca", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6d0e65c31db4f464a20a6cb9dd1676bfb58619ca"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/38541b742aae367796c537c8575cc30811d42fb1", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfB2b6CRBK7hj4Ov3rIwAAdHIIAJp3naczyK6Hgf4B29/qxPzY\nwhpkF0guwFGx20KNnwSbmqitiXZZFQOqzrURf9AD/HVPUcmLM4EQ8hWvcV75j1IA\nKiKHM3PBrAVqPo7Z9z3Z8rnNC/x9NYKwFi8aISn09e2mYmjXqhy5jQdLophrTMjc\n+f/fGsA+hv/8kVcwucSLfs0M6GXdTz5PAMQkD8T8Mmw8ezNBBitIEnzs7ek0AUsx\ne5XPmun5fAXzn/YkWMp5agq1upXaCfaJll0tgD92D6COPjLtAJte/LveTqz2kE0V\nnWp0la2rAENHIS3xgbaGr+2sb//TiA6EOKsSfZzMG2C1RkKfEYpSZYbmOQ50aLY=\n=FT3J\n-----END PGP SIGNATURE-----\n", "payload": "tree 6d0e65c31db4f464a20a6cb9dd1676bfb58619ca\nparent 89c9e970ddbe47622bcc52b135d35508510daa55\nparent 368aa6f1e292d264bcb74fafa25069fe19c49450\nauthor Manish Goregaokar <manishsmail@gmail.com> 1594320634 -0700\ncommitter GitHub <noreply@github.com> 1594320634 -0700\n\nRollup merge of #74107 - nbdd0121:rustdoc, r=GuillaumeGomez\n\nHide `&mut self` methods from Deref in sidebar if there are no `DerefMut` impl for the type.\n\nThis partially addresses #74083.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/38541b742aae367796c537c8575cc30811d42fb1", "html_url": "https://github.com/rust-lang/rust/commit/38541b742aae367796c537c8575cc30811d42fb1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/38541b742aae367796c537c8575cc30811d42fb1/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "89c9e970ddbe47622bcc52b135d35508510daa55", "url": "https://api.github.com/repos/rust-lang/rust/commits/89c9e970ddbe47622bcc52b135d35508510daa55", "html_url": "https://github.com/rust-lang/rust/commit/89c9e970ddbe47622bcc52b135d35508510daa55"}, {"sha": "368aa6f1e292d264bcb74fafa25069fe19c49450", "url": "https://api.github.com/repos/rust-lang/rust/commits/368aa6f1e292d264bcb74fafa25069fe19c49450", "html_url": "https://github.com/rust-lang/rust/commit/368aa6f1e292d264bcb74fafa25069fe19c49450"}], "stats": {"total": 29, "additions": 28, "deletions": 1}, "files": [{"sha": "f769a0920d16bb92e942ffb075e08bdf17c2ee81", "filename": "src/librustdoc/html/render.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/38541b742aae367796c537c8575cc30811d42fb1/src%2Flibrustdoc%2Fhtml%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/38541b742aae367796c537c8575cc30811d42fb1/src%2Flibrustdoc%2Fhtml%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender.rs?ref=38541b742aae367796c537c8575cc30811d42fb1", "patch": "@@ -4054,6 +4054,10 @@ fn sidebar_assoc_items(it: &clean::Item) -> String {\n                         _ => None,\n                     })\n                 {\n+                    let deref_mut = v\n+                        .iter()\n+                        .filter(|i| i.inner_impl().trait_.is_some())\n+                        .any(|i| i.inner_impl().trait_.def_id() == c.deref_mut_trait_did);\n                     let inner_impl = target\n                         .def_id()\n                         .or(target\n@@ -4074,7 +4078,9 @@ fn sidebar_assoc_items(it: &clean::Item) -> String {\n                         let mut ret = impls\n                             .iter()\n                             .filter(|i| i.inner_impl().trait_.is_none())\n-                            .flat_map(|i| get_methods(i.inner_impl(), true, &mut used_links, true))\n+                            .flat_map(|i| {\n+                                get_methods(i.inner_impl(), true, &mut used_links, deref_mut)\n+                            })\n                             .collect::<Vec<_>>();\n                         // We want links' order to be reproducible so we don't use unstable sort.\n                         ret.sort();"}, {"sha": "28585dafa142a693d81a36dcb03f5cf6e1b6d118", "filename": "src/test/rustdoc/issue-74083.rs", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/38541b742aae367796c537c8575cc30811d42fb1/src%2Ftest%2Frustdoc%2Fissue-74083.rs", "raw_url": "https://github.com/rust-lang/rust/raw/38541b742aae367796c537c8575cc30811d42fb1/src%2Ftest%2Frustdoc%2Fissue-74083.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fissue-74083.rs?ref=38541b742aae367796c537c8575cc30811d42fb1", "patch": "@@ -0,0 +1,21 @@\n+use std::ops::Deref;\n+\n+pub struct Foo;\n+\n+impl Foo {\n+    pub fn foo(&mut self) {}\n+}\n+\n+// @has issue_74083/struct.Bar.html\n+// !@has - '//div[@class=\"sidebar-links\"]/a[@href=\"#method.foo\"]' 'foo'\n+pub struct Bar {\n+    foo: Foo,\n+}\n+\n+impl Deref for Bar {\n+    type Target = Foo;\n+\n+    fn deref(&self) -> &Foo {\n+        &self.foo\n+    }\n+}"}]}