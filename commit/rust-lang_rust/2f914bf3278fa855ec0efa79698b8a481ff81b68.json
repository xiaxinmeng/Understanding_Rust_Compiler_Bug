{"sha": "2f914bf3278fa855ec0efa79698b8a481ff81b68", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJmOTE0YmYzMjc4ZmE4NTVlYzBlZmE3OTY5OGI4YTQ4MWZmODFiNjg=", "commit": {"author": {"name": "Dylan DPC", "email": "dylan.dpc@gmail.com", "date": "2020-02-19T17:12:07Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-02-19T17:12:07Z"}, "message": "Rollup merge of #68863 - pietroalbini:azure-macos-10.15, r=Mark-Simulacrum\n\nci: switch macOS builders to 10.15\n\nAzure Pipelines is deprecating the macOS 10.13 image we're currently running, [and they plan to remove them](https://devblogs.microsoft.com/devops/removing-older-images-in-azure-pipelines-hosted-pools/) on March 23, 2020. This PR switches our macOS builders to macOS 10.15.\n\nr? @Mark-Simulacrum", "tree": {"sha": "5dbbab96a44a72a1c180d5a74d4b2579f4d19a32", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5dbbab96a44a72a1c180d5a74d4b2579f4d19a32"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2f914bf3278fa855ec0efa79698b8a481ff81b68", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJeTWxnCRBK7hj4Ov3rIwAAdHIIADptWC89LboN2U/csd7GRk79\n8UoPBdIEPyCq76n6hEfQy0wSNhB6XixthDqap+zMykeCbW+otClyOH5vHpV5jPlj\nHYy2bmZ5VUylFTdvu6j/bqqwP5/DLVbTixVTv7ITrVjjD29Nsox9KrDT5nIVD2y7\njW2xVZSXLn/iYYGHYlBAkPdTa5yMIUp1ckr7NNwimqWODlWSLYQeQaOUiwxIPf64\nUPHNXXXIblKUg3BafS4HapA4tBGPO6bd/UODDXQXAj6nEvOQZ5RjTFTecn9K6fO8\n5fl+F2jnQXirPXSRqhRp0bRij8InURy9ei0k8bfsCc0Mrwj8LQD6fA7N8Sdsh+k=\n=8IGS\n-----END PGP SIGNATURE-----\n", "payload": "tree 5dbbab96a44a72a1c180d5a74d4b2579f4d19a32\nparent 7710ae0e2653e0fa14ff9b7797ed29340e0284a8\nparent 79c166ef73df00eac96aaeadcb326c972c22068c\nauthor Dylan DPC <dylan.dpc@gmail.com> 1582132327 +0100\ncommitter GitHub <noreply@github.com> 1582132327 +0100\n\nRollup merge of #68863 - pietroalbini:azure-macos-10.15, r=Mark-Simulacrum\n\nci: switch macOS builders to 10.15\n\nAzure Pipelines is deprecating the macOS 10.13 image we're currently running, [and they plan to remove them](https://devblogs.microsoft.com/devops/removing-older-images-in-azure-pipelines-hosted-pools/) on March 23, 2020. This PR switches our macOS builders to macOS 10.15.\n\nr? @Mark-Simulacrum\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2f914bf3278fa855ec0efa79698b8a481ff81b68", "html_url": "https://github.com/rust-lang/rust/commit/2f914bf3278fa855ec0efa79698b8a481ff81b68", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2f914bf3278fa855ec0efa79698b8a481ff81b68/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7710ae0e2653e0fa14ff9b7797ed29340e0284a8", "url": "https://api.github.com/repos/rust-lang/rust/commits/7710ae0e2653e0fa14ff9b7797ed29340e0284a8", "html_url": "https://github.com/rust-lang/rust/commit/7710ae0e2653e0fa14ff9b7797ed29340e0284a8"}, {"sha": "79c166ef73df00eac96aaeadcb326c972c22068c", "url": "https://api.github.com/repos/rust-lang/rust/commits/79c166ef73df00eac96aaeadcb326c972c22068c", "html_url": "https://github.com/rust-lang/rust/commit/79c166ef73df00eac96aaeadcb326c972c22068c"}], "stats": {"total": 29, "additions": 5, "deletions": 24}, "files": [{"sha": "3d6d4065fe80ce4358012ae7caf0d3bab72f7b22", "filename": "src/bootstrap/test.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2f914bf3278fa855ec0efa79698b8a481ff81b68/src%2Fbootstrap%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2f914bf3278fa855ec0efa79698b8a481ff81b68/src%2Fbootstrap%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftest.rs?ref=2f914bf3278fa855ec0efa79698b8a481ff81b68", "patch": "@@ -1051,10 +1051,10 @@ impl Step for Compiletest {\n         cmd.arg(\"--docck-python\").arg(builder.python());\n \n         if builder.config.build.ends_with(\"apple-darwin\") {\n-            // Force /usr/bin/python on macOS for LLDB tests because we're loading the\n+            // Force /usr/bin/python3 on macOS for LLDB tests because we're loading the\n             // LLDB plugin's compiled module which only works with the system python\n             // (namely not Homebrew-installed python)\n-            cmd.arg(\"--lldb-python\").arg(\"/usr/bin/python\");\n+            cmd.arg(\"--lldb-python\").arg(\"/usr/bin/python3\");\n         } else {\n             cmd.arg(\"--lldb-python\").arg(builder.python());\n         }"}, {"sha": "74b7469ea27b7f64de3063543aa8092a8bc75e4d", "filename": "src/ci/azure-pipelines/auto.yml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2f914bf3278fa855ec0efa79698b8a481ff81b68/src%2Fci%2Fazure-pipelines%2Fauto.yml", "raw_url": "https://github.com/rust-lang/rust/raw/2f914bf3278fa855ec0efa79698b8a481ff81b68/src%2Fci%2Fazure-pipelines%2Fauto.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fazure-pipelines%2Fauto.yml?ref=2f914bf3278fa855ec0efa79698b8a481ff81b68", "patch": "@@ -63,7 +63,7 @@ jobs:\n - job: macOS\n   timeoutInMinutes: 600\n   pool:\n-    vmImage: macos-10.13\n+    vmImage: macos-10.15\n   steps:\n   - template: steps/run.yml\n   strategy:"}, {"sha": "ee9425aa1c51f94afabe6876bf67ce166e5ed75b", "filename": "src/ci/azure-pipelines/steps/run.yml", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2f914bf3278fa855ec0efa79698b8a481ff81b68/src%2Fci%2Fazure-pipelines%2Fsteps%2Frun.yml", "raw_url": "https://github.com/rust-lang/rust/raw/2f914bf3278fa855ec0efa79698b8a481ff81b68/src%2Fci%2Fazure-pipelines%2Fsteps%2Frun.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fazure-pipelines%2Fsteps%2Frun.yml?ref=2f914bf3278fa855ec0efa79698b8a481ff81b68", "patch": "@@ -51,10 +51,6 @@ steps:\n   displayName: Install clang\n   condition: and(succeeded(), not(variables.SKIP_JOB))\n \n-- bash: src/ci/scripts/switch-xcode.sh\n-  displayName: Switch to Xcode 9.3\n-  condition: and(succeeded(), not(variables.SKIP_JOB))\n-\n - bash: src/ci/scripts/install-wix.sh\n   displayName: Install wix\n   condition: and(succeeded(), not(variables.SKIP_JOB))"}, {"sha": "f8ddf0eb46cfd1d23b29f01960ad17962724d33c", "filename": "src/ci/azure-pipelines/try.yml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2f914bf3278fa855ec0efa79698b8a481ff81b68/src%2Fci%2Fazure-pipelines%2Ftry.yml", "raw_url": "https://github.com/rust-lang/rust/raw/2f914bf3278fa855ec0efa79698b8a481ff81b68/src%2Fci%2Fazure-pipelines%2Ftry.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fazure-pipelines%2Ftry.yml?ref=2f914bf3278fa855ec0efa79698b8a481ff81b68", "patch": "@@ -25,7 +25,7 @@ jobs:\n # - job: macOS\n #   timeoutInMinutes: 600\n #   pool:\n-#     vmImage: macos-10.13\n+#     vmImage: macos-10.15\n #   steps:\n #   - template: steps/run.yml\n #   strategy:"}, {"sha": "c242f5d4562690ba8f0c310bd86df305cee523ef", "filename": "src/ci/scripts/install-clang.sh", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2f914bf3278fa855ec0efa79698b8a481ff81b68/src%2Fci%2Fscripts%2Finstall-clang.sh", "raw_url": "https://github.com/rust-lang/rust/raw/2f914bf3278fa855ec0efa79698b8a481ff81b68/src%2Fci%2Fscripts%2Finstall-clang.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fscripts%2Finstall-clang.sh?ref=2f914bf3278fa855ec0efa79698b8a481ff81b68", "patch": "@@ -19,9 +19,7 @@ if isMacOS; then\n     # native clang is configured to use the correct path, but our custom one\n     # doesn't. This sets the SDKROOT environment variable to the SDK so that\n     # our own clang can figure out the correct include path on its own.\n-    if ! [[ -d \"/usr/include\" ]]; then\n-        ciCommandSetEnv SDKROOT \"$(xcrun --sdk macosx --show-sdk-path)\"\n-    fi\n+    ciCommandSetEnv SDKROOT \"$(xcrun --sdk macosx --show-sdk-path)\"\n \n     # Configure `AR` specifically so rustbuild doesn't try to infer it as\n     # `clang-ar` by accident."}, {"sha": "2cbb2ddbc7046ab77caf06977f76aad5e750568f", "filename": "src/ci/scripts/switch-xcode.sh", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/7710ae0e2653e0fa14ff9b7797ed29340e0284a8/src%2Fci%2Fscripts%2Fswitch-xcode.sh", "raw_url": "https://github.com/rust-lang/rust/raw/7710ae0e2653e0fa14ff9b7797ed29340e0284a8/src%2Fci%2Fscripts%2Fswitch-xcode.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fscripts%2Fswitch-xcode.sh?ref=7710ae0e2653e0fa14ff9b7797ed29340e0284a8", "patch": "@@ -1,13 +0,0 @@\n-#!/bin/bash\n-# Switch to XCode 9.3 on OSX since it seems to be the last version that supports\n-# i686-apple-darwin. We'll eventually want to upgrade this and it will probably\n-# force us to drop i686-apple-darwin, but let's keep the wheels turning for now.\n-\n-set -euo pipefail\n-IFS=$'\\n\\t'\n-\n-source \"$(cd \"$(dirname \"$0\")\" && pwd)/../shared.sh\"\n-\n-if isMacOS; then\n-    sudo xcode-select --switch /Applications/Xcode_9.3.app\n-fi"}]}