{"sha": "24a69ddbbccda30eaf9f4dfc0106fda80faa1397", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI0YTY5ZGRiYmNjZGEzMGVhZjlmNGRmYzAxMDZmZGE4MGZhYTEzOTc=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2013-10-29T23:49:38Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2013-10-29T23:49:38Z"}, "message": "rt: Remove four unused upcalls", "tree": {"sha": "d3a1e16f4a7cfe66dc9b2607e6de15cca25f8743", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d3a1e16f4a7cfe66dc9b2607e6de15cca25f8743"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/24a69ddbbccda30eaf9f4dfc0106fda80faa1397", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/24a69ddbbccda30eaf9f4dfc0106fda80faa1397", "html_url": "https://github.com/rust-lang/rust/commit/24a69ddbbccda30eaf9f4dfc0106fda80faa1397", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/24a69ddbbccda30eaf9f4dfc0106fda80faa1397/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "611c94d984c1c062d6e123d986c0511443900850", "url": "https://api.github.com/repos/rust-lang/rust/commits/611c94d984c1c062d6e123d986c0511443900850", "html_url": "https://github.com/rust-lang/rust/commit/611c94d984c1c062d6e123d986c0511443900850"}], "stats": {"total": 45, "additions": 0, "deletions": 45}, "files": [{"sha": "e7648a081be35cb22d8d3e7b8b0ba1ebf05115ca", "filename": "src/rt/rust_upcall.cpp", "status": "modified", "additions": 0, "deletions": 41, "changes": 41, "blob_url": "https://github.com/rust-lang/rust/blob/24a69ddbbccda30eaf9f4dfc0106fda80faa1397/src%2Frt%2Frust_upcall.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/24a69ddbbccda30eaf9f4dfc0106fda80faa1397/src%2Frt%2Frust_upcall.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_upcall.cpp?ref=24a69ddbbccda30eaf9f4dfc0106fda80faa1397", "patch": "@@ -26,34 +26,6 @@ typedef int _Unwind_Action;\n struct _Unwind_Context;\n struct _Unwind_Exception;\n \n-typedef void (*CDECL stack_switch_shim)(void*);\n-\n-/**********************************************************************\n- * Switches to the C-stack and invokes |fn_ptr|, passing |args| as argument.\n- * This is used by the C compiler to call foreign functions and by other\n- * upcalls to switch to the C stack.  The return value is passed through a\n- * field in the args parameter. This upcall is specifically for switching\n- * to the shim functions generated by rustc.\n- */\n-extern \"C\" CDECL void\n-upcall_call_shim_on_c_stack(void *args, void *fn_ptr) {\n-    stack_switch_shim f = (stack_switch_shim)fn_ptr;\n-    f(args);\n-}\n-\n-/*\n- * The opposite of above. Starts on a C stack and switches to the Rust\n- * stack. This is the only upcall that runs from the C stack.\n- */\n-extern \"C\" CDECL void\n-upcall_call_shim_on_rust_stack(void *args, void *fn_ptr) {\n-    // There's no task. Call the function and hope for the best\n-    stack_switch_shim f = (stack_switch_shim)fn_ptr;\n-    f(args);\n-}\n-\n-/**********************************************************************/\n-\n #ifdef __SEH__\n #  define PERSONALITY_FUNC __gxx_personality_seh0\n #else\n@@ -107,19 +79,6 @@ upcall_rust_personality(int version,\n     return args.retval;\n }\n \n-// NB: This needs to be blazing fast. Don't switch stacks\n-extern \"C\" CDECL void *\n-upcall_new_stack(size_t stk_sz, void *args_addr, size_t args_sz) {\n-    assert(false && \"newsched shouldn't be growing the stack\");\n-    return NULL;\n-}\n-\n-// NB: This needs to be blazing fast. Don't switch stacks\n-extern \"C\" CDECL void\n-upcall_del_stack() {\n-    assert(false && \"newsched shouldn't be growing the stack\");\n-}\n-\n // Landing pads need to call this to insert the\n // correct limit into TLS.\n // NB: This must run on the Rust stack because it"}, {"sha": "60e4d3abd7a3259ff1eafc12e014c3b5510bc62e", "filename": "src/rt/rustrt.def.in", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/24a69ddbbccda30eaf9f4dfc0106fda80faa1397/src%2Frt%2Frustrt.def.in", "raw_url": "https://github.com/rust-lang/rust/raw/24a69ddbbccda30eaf9f4dfc0106fda80faa1397/src%2Frt%2Frustrt.def.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frustrt.def.in?ref=24a69ddbbccda30eaf9f4dfc0106fda80faa1397", "patch": "@@ -25,10 +25,6 @@ rust_win32_rand_acquire\n rust_win32_rand_gen\n rust_win32_rand_release\n upcall_rust_personality\n-upcall_call_shim_on_c_stack\n-upcall_call_shim_on_rust_stack\n-upcall_new_stack\n-upcall_del_stack\n upcall_reset_stack_limit\n rust_uv_loop_new\n rust_uv_loop_delete"}]}