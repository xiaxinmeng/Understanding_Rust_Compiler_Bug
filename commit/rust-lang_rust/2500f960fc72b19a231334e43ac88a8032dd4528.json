{"sha": "2500f960fc72b19a231334e43ac88a8032dd4528", "node_id": "C_kwDOAAsO6NoAKDI1MDBmOTYwZmM3MmIxOWEyMzEzMzRlNDNhYzg4YTgwMzJkZDQ1Mjg", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2023-03-04T19:42:26Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2023-03-04T19:42:26Z"}, "message": "Auto merge of #10439 - giraffate:fix_fp_for_let_unit_value, r=Jarcho\n\nFix FP for `let_unit_value` when `await` used\n\nFix https://github.com/rust-lang/rust-clippy/issues/10433\n\nchangelog: Fix FP for `let_unit_value` when `await` used", "tree": {"sha": "91752422352701749456cf68298cd283e2faae33", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/91752422352701749456cf68298cd283e2faae33"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2500f960fc72b19a231334e43ac88a8032dd4528", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2500f960fc72b19a231334e43ac88a8032dd4528", "html_url": "https://github.com/rust-lang/rust/commit/2500f960fc72b19a231334e43ac88a8032dd4528", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2500f960fc72b19a231334e43ac88a8032dd4528/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "308d68040728254c9652adc73659dc1ad76c815c", "url": "https://api.github.com/repos/rust-lang/rust/commits/308d68040728254c9652adc73659dc1ad76c815c", "html_url": "https://github.com/rust-lang/rust/commit/308d68040728254c9652adc73659dc1ad76c815c"}, {"sha": "027f19c8b911458722511be4ffc469f505766ffa", "url": "https://api.github.com/repos/rust-lang/rust/commits/027f19c8b911458722511be4ffc469f505766ffa", "html_url": "https://github.com/rust-lang/rust/commit/027f19c8b911458722511be4ffc469f505766ffa"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "3430b6e373418dedc8bc13d32dc36311bc2461a0", "filename": "clippy_lints/src/unit_types/let_unit_value.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/2500f960fc72b19a231334e43ac88a8032dd4528/clippy_lints%2Fsrc%2Funit_types%2Flet_unit_value.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2500f960fc72b19a231334e43ac88a8032dd4528/clippy_lints%2Fsrc%2Funit_types%2Flet_unit_value.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Funit_types%2Flet_unit_value.rs?ref=2500f960fc72b19a231334e43ac88a8032dd4528", "patch": "@@ -5,7 +5,7 @@ use clippy_utils::visitors::{for_each_local_assignment, for_each_value_source};\n use core::ops::ControlFlow;\n use rustc_errors::Applicability;\n use rustc_hir::def::{DefKind, Res};\n-use rustc_hir::{Expr, ExprKind, HirId, HirIdSet, Local, Node, PatKind, QPath, TyKind};\n+use rustc_hir::{Expr, ExprKind, HirId, HirIdSet, Local, MatchSource, Node, PatKind, QPath, TyKind};\n use rustc_lint::{LateContext, LintContext};\n use rustc_middle::lint::in_external_macro;\n use rustc_middle::ty;\n@@ -41,6 +41,10 @@ pub(super) fn check<'tcx>(cx: &LateContext<'tcx>, local: &'tcx Local<'_>) {\n                 );\n             }\n         } else {\n+            if let ExprKind::Match(_, _, MatchSource::AwaitDesugar) = init.kind {\n+                return\n+            }\n+\n             span_lint_and_then(\n                 cx,\n                 LET_UNIT_VALUE,"}, {"sha": "76ff0645f4177d8b33cbf3629e5a00e439c08eec", "filename": "tests/ui/let_unit.fixed", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2500f960fc72b19a231334e43ac88a8032dd4528/tests%2Fui%2Flet_unit.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/2500f960fc72b19a231334e43ac88a8032dd4528/tests%2Fui%2Flet_unit.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flet_unit.fixed?ref=2500f960fc72b19a231334e43ac88a8032dd4528", "patch": "@@ -175,3 +175,7 @@ fn attributes() {\n     #[expect(clippy::let_unit_value)]\n     let _ = f();\n }\n+\n+async fn issue10433() {\n+    let _pending: () = std::future::pending().await;\n+}"}, {"sha": "895ccfe366a2d2d3a3e272bfb9aab2bded6b904e", "filename": "tests/ui/let_unit.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2500f960fc72b19a231334e43ac88a8032dd4528/tests%2Fui%2Flet_unit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2500f960fc72b19a231334e43ac88a8032dd4528/tests%2Fui%2Flet_unit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flet_unit.rs?ref=2500f960fc72b19a231334e43ac88a8032dd4528", "patch": "@@ -175,3 +175,7 @@ fn attributes() {\n     #[expect(clippy::let_unit_value)]\n     let _ = f();\n }\n+\n+async fn issue10433() {\n+    let _pending: () = std::future::pending().await;\n+}"}]}