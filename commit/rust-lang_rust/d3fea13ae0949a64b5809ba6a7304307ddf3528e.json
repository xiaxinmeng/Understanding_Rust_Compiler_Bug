{"sha": "d3fea13ae0949a64b5809ba6a7304307ddf3528e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQzZmVhMTNhZTA5NDlhNjRiNTgwOWJhNmE3MzA0MzA3ZGRmMzUyOGU=", "commit": {"author": {"name": "David Tolnay", "email": "dtolnay@gmail.com", "date": "2021-02-10T03:04:29Z"}, "committer": {"name": "David Tolnay", "email": "dtolnay@gmail.com", "date": "2021-02-10T04:39:54Z"}, "message": "bootstrap: Locate llvm-dwp based on llvm-config bindir", "tree": {"sha": "f5ef43fdbb28958f2c7cdd693bf3ed580760d54e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f5ef43fdbb28958f2c7cdd693bf3ed580760d54e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d3fea13ae0949a64b5809ba6a7304307ddf3528e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEERijF2Cz/ZdaBZKeK+boUO5X/bYIFAmAjY50ACgkQ+boUO5X/\nbYL2HQ/8CsQ/VeQ/ISBxoOgFk9UJwJvVLb4pRqxgPae14719mv6VwYaBF/Whr8WZ\nki5mXSSlHaYILVGejFwdavWW1TCctEg44N6PqV86shvjjXkCLZiArCW/N48bB/AH\nEWM/DzIjoYq529z7HeP78kiK8lDOkotI9SOGeRc+9KSniKu9rQPgRdIkAoDF+cYD\nh2lCfQGn3XgPXojgYzd6esHGJ3KK17S00V/c9eoJJ+l5h8a9seCcuQbK6w64Pn+/\nDYQM2RN7nP9Hav9i7d9NknfcV7EDTrcSl0JWnLMyjYCpqGhewP5d9vdpxNSXwIM9\nGd708kr/hh2xqv2917f70XWapNLDLzf47zLz9hYV5m1VvSy2zERBFYa77UIOXtX2\nxdCTNEIyigOjfNLUnAc3yV0M0cL/eX6M6R2/u+IOwxPYf0ZOoc3nFMbn+DRKwjvO\nzX5PdQ+K8u+pnxK5rigZmd+cwhlwXyUbXkB7sOiEtzF7RHmJ7jsrYL36SzwooWYU\n+nW5uKPKX+wdKmb3FMeGuFbYUtR/AaFmKZZ8788PiB0cxn9e2MWnfmho/rWW55Ql\nwJp5Z0c6x13YjpU2Zw7P4SWFkGvxKtzR8r+4vCPSWglA0pacvBpuqUerjUdXdDUg\nc6w4VGpaPDHMHURQwPLLBoLRtySvJ+q4IkCUmsxXjbDhe0JeoJ8=\n=oXPa\n-----END PGP SIGNATURE-----", "payload": "tree f5ef43fdbb28958f2c7cdd693bf3ed580760d54e\nparent 87bacf22ec93a9479dbd829de5d1917c16b17255\nauthor David Tolnay <dtolnay@gmail.com> 1612926269 -0800\ncommitter David Tolnay <dtolnay@gmail.com> 1612931994 -0800\n\nbootstrap: Locate llvm-dwp based on llvm-config bindir\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d3fea13ae0949a64b5809ba6a7304307ddf3528e", "html_url": "https://github.com/rust-lang/rust/commit/d3fea13ae0949a64b5809ba6a7304307ddf3528e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d3fea13ae0949a64b5809ba6a7304307ddf3528e/comments", "author": {"login": "dtolnay", "id": 1940490, "node_id": "MDQ6VXNlcjE5NDA0OTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtolnay", "html_url": "https://github.com/dtolnay", "followers_url": "https://api.github.com/users/dtolnay/followers", "following_url": "https://api.github.com/users/dtolnay/following{/other_user}", "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions", "organizations_url": "https://api.github.com/users/dtolnay/orgs", "repos_url": "https://api.github.com/users/dtolnay/repos", "events_url": "https://api.github.com/users/dtolnay/events{/privacy}", "received_events_url": "https://api.github.com/users/dtolnay/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dtolnay", "id": 1940490, "node_id": "MDQ6VXNlcjE5NDA0OTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtolnay", "html_url": "https://github.com/dtolnay", "followers_url": "https://api.github.com/users/dtolnay/followers", "following_url": "https://api.github.com/users/dtolnay/following{/other_user}", "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions", "organizations_url": "https://api.github.com/users/dtolnay/orgs", "repos_url": "https://api.github.com/users/dtolnay/repos", "events_url": "https://api.github.com/users/dtolnay/events{/privacy}", "received_events_url": "https://api.github.com/users/dtolnay/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "87bacf22ec93a9479dbd829de5d1917c16b17255", "url": "https://api.github.com/repos/rust-lang/rust/commits/87bacf22ec93a9479dbd829de5d1917c16b17255", "html_url": "https://github.com/rust-lang/rust/commit/87bacf22ec93a9479dbd829de5d1917c16b17255"}], "stats": {"total": 7, "additions": 5, "deletions": 2}, "files": [{"sha": "dee0c154201362f89c5f052033115188e24cd822", "filename": "src/bootstrap/compile.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/d3fea13ae0949a64b5809ba6a7304307ddf3528e/src%2Fbootstrap%2Fcompile.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d3fea13ae0949a64b5809ba6a7304307ddf3528e/src%2Fbootstrap%2Fcompile.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fcompile.rs?ref=d3fea13ae0949a64b5809ba6a7304307ddf3528e", "patch": "@@ -1075,8 +1075,11 @@ impl Step for Assemble {\n             let src_exe = exe(\"llvm-dwp\", target_compiler.host);\n             let dst_exe = exe(\"rust-llvm-dwp\", target_compiler.host);\n             let llvm_config_bin = builder.ensure(native::Llvm { target: target_compiler.host });\n-            let llvm_bin_dir = llvm_config_bin.parent().unwrap();\n-            builder.copy(&llvm_bin_dir.join(&src_exe), &libdir_bin.join(&dst_exe));\n+            if !builder.config.dry_run {\n+                let llvm_bin_dir = output(Command::new(llvm_config_bin).arg(\"--bindir\"));\n+                let llvm_bin_dir = Path::new(llvm_bin_dir.trim());\n+                builder.copy(&llvm_bin_dir.join(&src_exe), &libdir_bin.join(&dst_exe));\n+            }\n         }\n \n         // Ensure that `libLLVM.so` ends up in the newly build compiler directory,"}]}