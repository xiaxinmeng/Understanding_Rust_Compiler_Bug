{"sha": "1cc13b4f5a576e4517813ca47de316271f1e26b3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFjYzEzYjRmNWE1NzZlNDUxNzgxM2NhNDdkZTMxNjI3MWYxZTI2YjM=", "commit": {"author": {"name": "Mara Bos", "email": "m-ou.se@m-ou.se", "date": "2021-01-22T14:30:14Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-01-22T14:30:14Z"}, "message": "Rollup merge of #81225 - CraftSpider:json-opt-docs, r=jyn514\n\nMake 'docs' nullable in rustdoc-json output\n\nMatches the backing better, and makes it so there's a difference between 'empty docs' and 'no docs'.", "tree": {"sha": "066c1305b7c96a4ad770ead51b53213d43171dd0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/066c1305b7c96a4ad770ead51b53213d43171dd0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1cc13b4f5a576e4517813ca47de316271f1e26b3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgCuF3CRBK7hj4Ov3rIwAAdHIIACthWKsjpwylgTeQVjW9Ck0k\n/Kos3nESsDNNRBvCQQbnyqEtI86ErZ0i5fyxlLGv0OsFgLXawpPV9cfdwyLaxwLC\nWmor3bs3jaT4M0BCSoVe+ymd74Y1xaGcjsfAUOKvnIZrHLe2OLJAAFIOtO++J3VL\n/YA4+bIn1qUpEuQpgjCVHpSUE0yjwpxnUuBRBjLYpxYL1OMu/bUvRaNHzwANS9uC\nM4vDdnGWDeCH1fcf2pzmlD7kMLprgbq2lmPd/1T1zEFe/gp9Ey+zVo5CnImkQQsg\nqXhhK2deDqqRxGxBwWOlZLJR+TV5EDwcPWKZmM1V/boKa9A8ViQw1I8ThhUPgQc=\n=H1ax\n-----END PGP SIGNATURE-----\n", "payload": "tree 066c1305b7c96a4ad770ead51b53213d43171dd0\nparent 950ed27e8bb8952fce24afbaf19dd1afa5368f83\nparent 26565f05c045c15d4304e73639efcaf5b3100842\nauthor Mara Bos <m-ou.se@m-ou.se> 1611325814 +0000\ncommitter GitHub <noreply@github.com> 1611325814 +0000\n\nRollup merge of #81225 - CraftSpider:json-opt-docs, r=jyn514\n\nMake 'docs' nullable in rustdoc-json output\n\nMatches the backing better, and makes it so there's a difference between 'empty docs' and 'no docs'.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1cc13b4f5a576e4517813ca47de316271f1e26b3", "html_url": "https://github.com/rust-lang/rust/commit/1cc13b4f5a576e4517813ca47de316271f1e26b3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1cc13b4f5a576e4517813ca47de316271f1e26b3/comments", "author": {"login": "m-ou-se", "id": 783247, "node_id": "MDQ6VXNlcjc4MzI0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/783247?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m-ou-se", "html_url": "https://github.com/m-ou-se", "followers_url": "https://api.github.com/users/m-ou-se/followers", "following_url": "https://api.github.com/users/m-ou-se/following{/other_user}", "gists_url": "https://api.github.com/users/m-ou-se/gists{/gist_id}", "starred_url": "https://api.github.com/users/m-ou-se/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m-ou-se/subscriptions", "organizations_url": "https://api.github.com/users/m-ou-se/orgs", "repos_url": "https://api.github.com/users/m-ou-se/repos", "events_url": "https://api.github.com/users/m-ou-se/events{/privacy}", "received_events_url": "https://api.github.com/users/m-ou-se/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "950ed27e8bb8952fce24afbaf19dd1afa5368f83", "url": "https://api.github.com/repos/rust-lang/rust/commits/950ed27e8bb8952fce24afbaf19dd1afa5368f83", "html_url": "https://github.com/rust-lang/rust/commit/950ed27e8bb8952fce24afbaf19dd1afa5368f83"}, {"sha": "26565f05c045c15d4304e73639efcaf5b3100842", "url": "https://api.github.com/repos/rust-lang/rust/commits/26565f05c045c15d4304e73639efcaf5b3100842", "html_url": "https://github.com/rust-lang/rust/commit/26565f05c045c15d4304e73639efcaf5b3100842"}], "stats": {"total": 9, "additions": 5, "deletions": 4}, "files": [{"sha": "d8f1f51579624e0f086732d58f18949a5dc4608a", "filename": "src/librustdoc/json/conversions.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1cc13b4f5a576e4517813ca47de316271f1e26b3/src%2Flibrustdoc%2Fjson%2Fconversions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1cc13b4f5a576e4517813ca47de316271f1e26b3/src%2Flibrustdoc%2Fjson%2Fconversions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fjson%2Fconversions.rs?ref=1cc13b4f5a576e4517813ca47de316271f1e26b3", "patch": "@@ -27,7 +27,7 @@ impl JsonRenderer<'_> {\n                 name: name.map(|sym| sym.to_string()),\n                 source: self.convert_span(source),\n                 visibility: self.convert_visibility(visibility),\n-                docs: attrs.collapsed_doc_value().unwrap_or_default(),\n+                docs: attrs.collapsed_doc_value(),\n                 links: attrs\n                     .links\n                     .into_iter()"}, {"sha": "dc50c8a76b24f446edf9fd30fcf3c6a1549fbc1a", "filename": "src/librustdoc/json/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1cc13b4f5a576e4517813ca47de316271f1e26b3/src%2Flibrustdoc%2Fjson%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1cc13b4f5a576e4517813ca47de316271f1e26b3/src%2Flibrustdoc%2Fjson%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fjson%2Fmod.rs?ref=1cc13b4f5a576e4517813ca47de316271f1e26b3", "patch": "@@ -241,7 +241,7 @@ impl<'tcx> FormatRenderer<'tcx> for JsonRenderer<'tcx> {\n                     )\n                 })\n                 .collect(),\n-            format_version: 1,\n+            format_version: 2,\n         };\n         let mut p = self.out_path.clone();\n         p.push(output.index.get(&output.root).unwrap().name.clone().unwrap());"}, {"sha": "c148602009f9a38644681324b642ddd3ef9ccc14", "filename": "src/librustdoc/json/types.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/1cc13b4f5a576e4517813ca47de316271f1e26b3/src%2Flibrustdoc%2Fjson%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1cc13b4f5a576e4517813ca47de316271f1e26b3/src%2Flibrustdoc%2Fjson%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fjson%2Ftypes.rs?ref=1cc13b4f5a576e4517813ca47de316271f1e26b3", "patch": "@@ -68,8 +68,9 @@ pub struct Item {\n     /// By default all documented items are public, but you can tell rustdoc to output private items\n     /// so this field is needed to differentiate.\n     pub visibility: Visibility,\n-    /// The full markdown docstring of this item.\n-    pub docs: String,\n+    /// The full markdown docstring of this item. Absent if there is no documentation at all,\n+    /// Some(\"\") if there is some documentation but it is empty (EG `#[doc = \"\"]`).\n+    pub docs: Option<String>,\n     /// This mapping resolves [intra-doc links](https://github.com/rust-lang/rfcs/blob/master/text/1946-intra-rustdoc-links.md) from the docstring to their IDs\n     pub links: FxHashMap<String, Id>,\n     /// Stringified versions of the attributes on this item (e.g. `\"#[inline]\"`)"}]}