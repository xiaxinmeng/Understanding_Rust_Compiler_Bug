{"sha": "d8b572b820e2c1b59a26d28fc2c6234e34aedc6d", "node_id": "C_kwDOAAsO6NoAKGQ4YjU3MmI4MjBlMmMxYjU5YTI2ZDI4ZmMyYzYyMzRlMzRhZWRjNmQ", "commit": {"author": {"name": "Andrew Pollack", "email": "andrewpkq@gmail.com", "date": "2022-08-31T23:49:48Z"}, "committer": {"name": "Andrew Pollack", "email": "andrewpkq@gmail.com", "date": "2022-09-01T00:35:30Z"}, "message": "Tweaks to fuchsia doc walkthrough", "tree": {"sha": "a486e520d263aea9c96d722aa01902b1435c76be", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a486e520d263aea9c96d722aa01902b1435c76be"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d8b572b820e2c1b59a26d28fc2c6234e34aedc6d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d8b572b820e2c1b59a26d28fc2c6234e34aedc6d", "html_url": "https://github.com/rust-lang/rust/commit/d8b572b820e2c1b59a26d28fc2c6234e34aedc6d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d8b572b820e2c1b59a26d28fc2c6234e34aedc6d/comments", "author": {"login": "andrewpollack", "id": 24868505, "node_id": "MDQ6VXNlcjI0ODY4NTA1", "avatar_url": "https://avatars.githubusercontent.com/u/24868505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrewpollack", "html_url": "https://github.com/andrewpollack", "followers_url": "https://api.github.com/users/andrewpollack/followers", "following_url": "https://api.github.com/users/andrewpollack/following{/other_user}", "gists_url": "https://api.github.com/users/andrewpollack/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrewpollack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrewpollack/subscriptions", "organizations_url": "https://api.github.com/users/andrewpollack/orgs", "repos_url": "https://api.github.com/users/andrewpollack/repos", "events_url": "https://api.github.com/users/andrewpollack/events{/privacy}", "received_events_url": "https://api.github.com/users/andrewpollack/received_events", "type": "User", "site_admin": false}, "committer": {"login": "andrewpollack", "id": 24868505, "node_id": "MDQ6VXNlcjI0ODY4NTA1", "avatar_url": "https://avatars.githubusercontent.com/u/24868505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrewpollack", "html_url": "https://github.com/andrewpollack", "followers_url": "https://api.github.com/users/andrewpollack/followers", "following_url": "https://api.github.com/users/andrewpollack/following{/other_user}", "gists_url": "https://api.github.com/users/andrewpollack/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrewpollack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrewpollack/subscriptions", "organizations_url": "https://api.github.com/users/andrewpollack/orgs", "repos_url": "https://api.github.com/users/andrewpollack/repos", "events_url": "https://api.github.com/users/andrewpollack/events{/privacy}", "received_events_url": "https://api.github.com/users/andrewpollack/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9243168fa5615ec8ebe9164c6bc2fdcccffd08b6", "url": "https://api.github.com/repos/rust-lang/rust/commits/9243168fa5615ec8ebe9164c6bc2fdcccffd08b6", "html_url": "https://github.com/rust-lang/rust/commit/9243168fa5615ec8ebe9164c6bc2fdcccffd08b6"}], "stats": {"total": 28, "additions": 18, "deletions": 10}, "files": [{"sha": "10d12f88454d1152827f5f70b38ecafe3ce4584a", "filename": "src/doc/rustc/src/platform-support/fuchsia.md", "status": "modified", "additions": 18, "deletions": 10, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/d8b572b820e2c1b59a26d28fc2c6234e34aedc6d/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support%2Ffuchsia.md", "raw_url": "https://github.com/rust-lang/rust/raw/d8b572b820e2c1b59a26d28fc2c6234e34aedc6d/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support%2Ffuchsia.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support%2Ffuchsia.md?ref=d8b572b820e2c1b59a26d28fc2c6234e34aedc6d", "patch": "@@ -125,13 +125,20 @@ during compilation:\n [target.x86_64-fuchsia]\n \n rustflags = [\n-    \"-Lnative\", \"<SDK_PATH>/arch/x64/sysroot/lib\",\n-    \"-Lnative\", \"<SDK_PATH>/arch/x64/lib\"\n+    \"-Lnative=<SDK_PATH>/arch/x64/lib\",\n+    \"-Lnative=<SDK_PATH>/arch/x64/sysroot/lib\"\n ]\n ```\n \n *Note: Make sure to fill out `<SDK_PATH>` with the path to the downloaded [Fuchsia SDK].*\n \n+These options configure the following:\n+\n+* `-Lnative=${SDK_PATH}/arch/${ARCH}/lib`: Link against Fuchsia libraries from\n+  the SDK\n+* `-Lnative=${SDK_PATH}/arch/${ARCH}/sysroot/lib`: Link against Fuchsia kernel\n+  libraries from the SDK\n+\n In total, our new project will look like:\n \n **Current directory structure**\n@@ -368,6 +375,7 @@ language called CML. The Fuchsia devsite contains an [overview of CML] and a\n }\n ```\n \n+**Current directory structure**\n ```txt\n hello_fuchsia/\n \u2517\u2501 pkg/\n@@ -386,6 +394,9 @@ ${SDK_PATH}/tools/${ARCH}/cmc compile \\\n     -o pkg/meta/hello_fuchsia.cm\n ```\n \n+*Note: `--includepath` tells the compiler where to look for `include`s from our CML.\n+In our case, we're only using `syslog/client.shard.cml`.*\n+\n **Current directory structure**\n ```txt\n hello_fuchsia/\n@@ -397,19 +408,16 @@ hello_fuchsia/\n    \u2517\u2501 hello_fuchsia.cml\n ```\n \n-*Note: `--includepath` tells the compiler where to look for `include`s from our CML.\n-In our case, we're only using `syslog/client.shard.cml`.*\n-\n ### Building a Fuchsia package\n \n Next, we'll build a package manifest as defined by our manifest:\n \n ```sh\n ${SDK_PATH}/tools/${ARCH}/pm \\\n-    -o hello_fuchsia_manifest \\\n+    -o pkg/hello_fuchsia_manifest \\\n     -m pkg/hello_fuchsia.manifest \\\n     build \\\n-    -output-package-manifest hello_fuchsia_package_manifest\n+    -output-package-manifest pkg/hello_fuchsia_package_manifest\n ```\n \n This will produce `pkg/hello_fuchsia_manifest/` which is a package manifest we can\n@@ -469,15 +477,15 @@ We can publish our new package to that repository with:\n \n ```sh\n ${SDK_PATH}/tools/${ARCH}/pm publish \\\n-    -repo repo \\\n-    -lp -f <(echo \"hello_fuchsia_package_manifest\")\n+    -repo pkg/repo \\\n+    -lp -f <(echo \"pkg/hello_fuchsia_package_manifest\")\n ```\n \n Then we can add the repository to `ffx`'s package server as `hello-fuchsia` using:\n \n ```sh\n ${SDK_PATH}/tools/${ARCH}/ffx repository add-from-pm \\\n-    repo \\\n+    pkg/repo \\\n     -r hello-fuchsia\n ```\n "}]}