{"sha": "33cbf8908d4cf1c971128ee35e7bd2ea50225b63", "node_id": "C_kwDOAAsO6NoAKDMzY2JmODkwOGQ0Y2YxYzk3MTEyOGVlMzVlN2JkMmVhNTAyMjViNjM", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-02-06T21:21:09Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-02-07T16:07:53Z"}, "message": "Add test for block doc comments horizontal trim", "tree": {"sha": "1421dc8530d9c8ed98a7ca11b36bfcc2e8e0866b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1421dc8530d9c8ed98a7ca11b36bfcc2e8e0866b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/33cbf8908d4cf1c971128ee35e7bd2ea50225b63", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/33cbf8908d4cf1c971128ee35e7bd2ea50225b63", "html_url": "https://github.com/rust-lang/rust/commit/33cbf8908d4cf1c971128ee35e7bd2ea50225b63", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/33cbf8908d4cf1c971128ee35e7bd2ea50225b63/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e3942874a06677f17be284f27b5494531cc7224a", "url": "https://api.github.com/repos/rust-lang/rust/commits/e3942874a06677f17be284f27b5494531cc7224a", "html_url": "https://github.com/rust-lang/rust/commit/e3942874a06677f17be284f27b5494531cc7224a"}], "stats": {"total": 41, "additions": 27, "deletions": 14}, "files": [{"sha": "11d50603a1011fb84f483c82731bce45664789d8", "filename": "compiler/rustc_ast/src/util/comments/tests.rs", "status": "modified", "additions": 6, "deletions": 14, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/33cbf8908d4cf1c971128ee35e7bd2ea50225b63/compiler%2Frustc_ast%2Fsrc%2Futil%2Fcomments%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/33cbf8908d4cf1c971128ee35e7bd2ea50225b63/compiler%2Frustc_ast%2Fsrc%2Futil%2Fcomments%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast%2Fsrc%2Futil%2Fcomments%2Ftests.rs?ref=33cbf8908d4cf1c971128ee35e7bd2ea50225b63", "patch": "@@ -45,25 +45,17 @@ fn test_line_doc_comment() {\n #[test]\n fn test_doc_blocks() {\n     create_default_session_globals_then(|| {\n-        let stripped = beautify_doc_string(\n-            Symbol::intern(\n-                \" # Returns\n-     *\n-     \",\n-            ),\n-            CommentKind::Block,\n-        );\n+        let stripped =\n+            beautify_doc_string(Symbol::intern(\" # Returns\\n     *\\n     \"), CommentKind::Block);\n         assert_eq!(stripped.as_str(), \" # Returns\\n\\n\");\n \n         let stripped = beautify_doc_string(\n-            Symbol::intern(\n-                \"\n-     * # Returns\n-     *\n-     \",\n-            ),\n+            Symbol::intern(\"\\n     * # Returns\\n     *\\n     \"),\n             CommentKind::Block,\n         );\n         assert_eq!(stripped.as_str(), \" # Returns\\n\\n\");\n+\n+        let stripped = beautify_doc_string(Symbol::intern(\"\\n *     a\\n \"), CommentKind::Block);\n+        assert_eq!(stripped.as_str(), \"     a\\n\");\n     })\n }"}, {"sha": "c60dfa3f9518e0998a3a3016af866fedc4645b37", "filename": "src/test/rustdoc-ui/block-doc-comment.rs", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/33cbf8908d4cf1c971128ee35e7bd2ea50225b63/src%2Ftest%2Frustdoc-ui%2Fblock-doc-comment.rs", "raw_url": "https://github.com/rust-lang/rust/raw/33cbf8908d4cf1c971128ee35e7bd2ea50225b63/src%2Ftest%2Frustdoc-ui%2Fblock-doc-comment.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fblock-doc-comment.rs?ref=33cbf8908d4cf1c971128ee35e7bd2ea50225b63", "patch": "@@ -0,0 +1,16 @@\n+// check-pass\n+// compile-flags:--test\n+\n+// This test ensures that no code block is detected in the doc comments.\n+\n+pub mod Wormhole {\n+    /** # Returns\n+     *\n+     */\n+    pub fn foofoo() {}\n+    /**\n+     * # Returns\n+     *\n+     */\n+    pub fn barbar() {}\n+}"}, {"sha": "e5c27bebbdb23760134f4ddd98b349116b3c04e6", "filename": "src/test/rustdoc-ui/block-doc-comment.stdout", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/33cbf8908d4cf1c971128ee35e7bd2ea50225b63/src%2Ftest%2Frustdoc-ui%2Fblock-doc-comment.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/33cbf8908d4cf1c971128ee35e7bd2ea50225b63/src%2Ftest%2Frustdoc-ui%2Fblock-doc-comment.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fblock-doc-comment.stdout?ref=33cbf8908d4cf1c971128ee35e7bd2ea50225b63", "patch": "@@ -0,0 +1,5 @@\n+\n+running 0 tests\n+\n+test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s\n+"}]}