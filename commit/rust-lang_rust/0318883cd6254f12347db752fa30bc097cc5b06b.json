{"sha": "0318883cd6254f12347db752fa30bc097cc5b06b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAzMTg4ODNjZDYyNTRmMTIzNDdkYjc1MmZhMzBiYzA5N2NjNWIwNmI=", "commit": {"author": {"name": "Nikita Popov", "email": "nikita.ppv@gmail.com", "date": "2021-04-04T19:38:34Z"}, "committer": {"name": "Nikita Popov", "email": "nikita.ppv@gmail.com", "date": "2021-05-08T08:58:08Z"}, "message": "Make -Z new-llvm-pass-manager an Option<bool>\n\nTo allow it to have an LLVM version dependent default.", "tree": {"sha": "72ee70d0894e400081c53dd803ac498084b7acab", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/72ee70d0894e400081c53dd803ac498084b7acab"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0318883cd6254f12347db752fa30bc097cc5b06b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0318883cd6254f12347db752fa30bc097cc5b06b", "html_url": "https://github.com/rust-lang/rust/commit/0318883cd6254f12347db752fa30bc097cc5b06b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0318883cd6254f12347db752fa30bc097cc5b06b/comments", "author": {"login": "nikic", "id": 216080, "node_id": "MDQ6VXNlcjIxNjA4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/216080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikic", "html_url": "https://github.com/nikic", "followers_url": "https://api.github.com/users/nikic/followers", "following_url": "https://api.github.com/users/nikic/following{/other_user}", "gists_url": "https://api.github.com/users/nikic/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikic/subscriptions", "organizations_url": "https://api.github.com/users/nikic/orgs", "repos_url": "https://api.github.com/users/nikic/repos", "events_url": "https://api.github.com/users/nikic/events{/privacy}", "received_events_url": "https://api.github.com/users/nikic/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikic", "id": 216080, "node_id": "MDQ6VXNlcjIxNjA4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/216080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikic", "html_url": "https://github.com/nikic", "followers_url": "https://api.github.com/users/nikic/followers", "following_url": "https://api.github.com/users/nikic/following{/other_user}", "gists_url": "https://api.github.com/users/nikic/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikic/subscriptions", "organizations_url": "https://api.github.com/users/nikic/orgs", "repos_url": "https://api.github.com/users/nikic/repos", "events_url": "https://api.github.com/users/nikic/events{/privacy}", "received_events_url": "https://api.github.com/users/nikic/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "50e1dc1536264ab71c0850f346b12309477f29f7", "url": "https://api.github.com/repos/rust-lang/rust/commits/50e1dc1536264ab71c0850f346b12309477f29f7", "html_url": "https://github.com/rust-lang/rust/commit/50e1dc1536264ab71c0850f346b12309477f29f7"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "673f5c3c3623e137ea40084a67ae773c433414d0", "filename": "compiler/rustc_codegen_llvm/src/back/write.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0318883cd6254f12347db752fa30bc097cc5b06b/compiler%2Frustc_codegen_llvm%2Fsrc%2Fback%2Fwrite.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0318883cd6254f12347db752fa30bc097cc5b06b/compiler%2Frustc_codegen_llvm%2Fsrc%2Fback%2Fwrite.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_llvm%2Fsrc%2Fback%2Fwrite.rs?ref=0318883cd6254f12347db752fa30bc097cc5b06b", "patch": "@@ -410,7 +410,7 @@ fn get_pgo_use_path(config: &ModuleConfig) -> Option<CString> {\n \n pub(crate) fn should_use_new_llvm_pass_manager(config: &ModuleConfig) -> bool {\n     // The new pass manager is disabled by default.\n-    config.new_llvm_pass_manager\n+    config.new_llvm_pass_manager.unwrap_or(false)\n }\n \n pub(crate) unsafe fn optimize_with_new_llvm_pass_manager("}, {"sha": "dce8ab6f0267fd8c216f262a69356fd36ce7eae0", "filename": "compiler/rustc_codegen_ssa/src/back/write.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0318883cd6254f12347db752fa30bc097cc5b06b/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Fwrite.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0318883cd6254f12347db752fa30bc097cc5b06b/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Fwrite.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Fwrite.rs?ref=0318883cd6254f12347db752fa30bc097cc5b06b", "patch": "@@ -108,7 +108,7 @@ pub struct ModuleConfig {\n     pub vectorize_slp: bool,\n     pub merge_functions: bool,\n     pub inline_threshold: Option<u32>,\n-    pub new_llvm_pass_manager: bool,\n+    pub new_llvm_pass_manager: Option<bool>,\n     pub emit_lifetime_markers: bool,\n }\n "}, {"sha": "fd13cb3d59acd203b48255f5f09ca60c4ffc574e", "filename": "compiler/rustc_interface/src/tests.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0318883cd6254f12347db752fa30bc097cc5b06b/compiler%2Frustc_interface%2Fsrc%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0318883cd6254f12347db752fa30bc097cc5b06b/compiler%2Frustc_interface%2Fsrc%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_interface%2Fsrc%2Ftests.rs?ref=0318883cd6254f12347db752fa30bc097cc5b06b", "patch": "@@ -709,7 +709,7 @@ fn test_debugging_options_tracking_hash() {\n     tracked!(mir_emit_retag, true);\n     tracked!(mir_opt_level, Some(4));\n     tracked!(mutable_noalias, Some(true));\n-    tracked!(new_llvm_pass_manager, true);\n+    tracked!(new_llvm_pass_manager, Some(true));\n     tracked!(no_codegen, true);\n     tracked!(no_generate_arange_section, true);\n     tracked!(no_link, true);"}, {"sha": "da6e2af276053eb1c68ce532c25eb4dc8d4203ac", "filename": "compiler/rustc_session/src/options.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0318883cd6254f12347db752fa30bc097cc5b06b/compiler%2Frustc_session%2Fsrc%2Foptions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0318883cd6254f12347db752fa30bc097cc5b06b/compiler%2Frustc_session%2Fsrc%2Foptions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_session%2Fsrc%2Foptions.rs?ref=0318883cd6254f12347db752fa30bc097cc5b06b", "patch": "@@ -1112,7 +1112,7 @@ options! {DebuggingOptions, DebuggingSetter, basic_debugging_options,\n         \"MIR optimization level (0-4; default: 1 in non optimized builds and 2 in optimized builds)\"),\n     mutable_noalias: Option<bool> = (None, parse_opt_bool, [TRACKED],\n         \"emit noalias metadata for mutable references (default: yes for LLVM >= 12, otherwise no)\"),\n-    new_llvm_pass_manager: bool = (false, parse_bool, [TRACKED],\n+    new_llvm_pass_manager: Option<bool> = (None, parse_opt_bool, [TRACKED],\n         \"use new LLVM pass manager (default: no)\"),\n     nll_facts: bool = (false, parse_bool, [UNTRACKED],\n         \"dump facts from NLL analysis into side files (default: no)\"),"}]}