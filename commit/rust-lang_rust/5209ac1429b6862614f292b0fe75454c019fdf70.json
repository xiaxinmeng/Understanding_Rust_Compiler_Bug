{"sha": "5209ac1429b6862614f292b0fe75454c019fdf70", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUyMDlhYzE0MjliNjg2MjYxNGYyOTJiMGZlNzU0NTRjMDE5ZmRmNzA=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2018-09-10T05:46:49Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-09-10T05:46:49Z"}, "message": "Merge pull request #3157 from matthiaskrgr/Vinfo_impl_debug\n\nimpl std::fmt::Debug for VersionInfo", "tree": {"sha": "295e128b1f26fa0eaca65fdfd1161fca783a757c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/295e128b1f26fa0eaca65fdfd1161fca783a757c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5209ac1429b6862614f292b0fe75454c019fdf70", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJblgVJCRBK7hj4Ov3rIwAAdHIIAGIOm0Tp8HZf884nj+aCw/wC\naZ86JtPVczfPVGMLoD13s5a6DT+7PpgB3Hsty7jxnzdyoSi54r8X24LKhjodFmgv\n06VXAHwMggbxQmivXBlS/2o2/d+IHWiNm0xHX96xTCpwAHhcpLbqJNRCPk3MQhD6\n1yvd5q3vdhCgpbyOdxLuD3tHDwDrcZd821/wQ9O3mIHSCwwxtYy4ugfqvpC1OWkX\n0n/KQqk5ZvaOekoq8o0yB7PEuECcnMbT+gqjPs/8lqNbVHOa+mNJ36p2QAHuOZlR\npnai6ou/bo0m1J752u+B6dPBvS7cB+Enhl5X8fJtvIGmuYgc0Do91l6w2yOQIUc=\n=dE6Y\n-----END PGP SIGNATURE-----\n", "payload": "tree 295e128b1f26fa0eaca65fdfd1161fca783a757c\nparent f30cf51a7020ead8c2a80e01608ed4acc22450ad\nparent 61249b360e9aef29413516e07a57d3056648e9b3\nauthor Philipp Hansch <dev@phansch.net> 1536558409 +0100\ncommitter GitHub <noreply@github.com> 1536558409 +0100\n\nMerge pull request #3157 from matthiaskrgr/Vinfo_impl_debug\n\nimpl std::fmt::Debug for VersionInfo"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5209ac1429b6862614f292b0fe75454c019fdf70", "html_url": "https://github.com/rust-lang/rust/commit/5209ac1429b6862614f292b0fe75454c019fdf70", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5209ac1429b6862614f292b0fe75454c019fdf70/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f30cf51a7020ead8c2a80e01608ed4acc22450ad", "url": "https://api.github.com/repos/rust-lang/rust/commits/f30cf51a7020ead8c2a80e01608ed4acc22450ad", "html_url": "https://github.com/rust-lang/rust/commit/f30cf51a7020ead8c2a80e01608ed4acc22450ad"}, {"sha": "61249b360e9aef29413516e07a57d3056648e9b3", "url": "https://api.github.com/repos/rust-lang/rust/commits/61249b360e9aef29413516e07a57d3056648e9b3", "html_url": "https://github.com/rust-lang/rust/commit/61249b360e9aef29413516e07a57d3056648e9b3"}], "stats": {"total": 37, "additions": 35, "deletions": 2}, "files": [{"sha": "33e1d979dce405cc84a8dd8eb12559b7bea132c5", "filename": "rustc_tools_util/src/lib.rs", "status": "modified", "additions": 35, "deletions": 2, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/5209ac1429b6862614f292b0fe75454c019fdf70/rustc_tools_util%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5209ac1429b6862614f292b0fe75454c019fdf70/rustc_tools_util%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/rustc_tools_util%2Fsrc%2Flib.rs?ref=5209ac1429b6862614f292b0fe75454c019fdf70", "patch": "@@ -61,6 +61,30 @@ impl std::fmt::Display for VersionInfo {\n     }\n }\n \n+impl std::fmt::Debug for VersionInfo {\n+    fn fmt(&self, f: &mut std::fmt::Formatter) -> std::fmt::Result {\n+        write!(\n+            f,\n+            \"VersionInfo {{ crate_name: \\\"{}\\\", major: {}, minor: {}, patch: {}\",\n+            self.crate_name, self.major, self.minor, self.patch,\n+        )?;\n+        match self.commit_hash {\n+            Some(_) => {\n+                write!(\n+                    f,\n+                    \", commit_hash: \\\"{}\\\", commit_date: \\\"{}\\\" }}\",\n+                    self.commit_hash.clone().unwrap_or_default().trim(),\n+                    self.commit_date.clone().unwrap_or_default().trim()\n+                )?;\n+            },\n+            None => {\n+                write!(f, \" }}\")?;\n+            },\n+        }\n+        Ok(())\n+    }\n+}\n+\n pub fn get_channel() -> Option<String> {\n     if let Ok(channel) = env::var(\"CFG_RELEASE_CHANNEL\") {\n         Some(channel)\n@@ -105,8 +129,17 @@ mod test {\n     #[test]\n     fn test_display_local() {\n         let vi = get_version_info!();\n-        let fmt = format!(\"{}\", vi);\n-        assert_eq!(fmt, \"rustc_tools_util 0.1.0\");\n+        assert_eq!(vi.to_string(), \"rustc_tools_util 0.1.0\");\n+    }\n+\n+    #[test]\n+    fn test_debug_local() {\n+        let vi = get_version_info!();\n+        let s = format!(\"{:?}\", vi);\n+        assert_eq!(\n+            s,\n+            \"VersionInfo { crate_name: \\\"rustc_tools_util\\\", major: 0, minor: 1, patch: 0 }\"\n+        );\n     }\n \n }"}]}