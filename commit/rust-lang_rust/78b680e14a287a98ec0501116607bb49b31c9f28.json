{"sha": "78b680e14a287a98ec0501116607bb49b31c9f28", "node_id": "C_kwDOAAsO6NoAKDc4YjY4MGUxNGEyODdhOThlYzA1MDExMTY2MDdiYjQ5YjMxYzlmMjg", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-03-26T17:03:49Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-03-26T17:17:07Z"}, "message": "interpret: mark a dead match arm as dead", "tree": {"sha": "216fb12ae76a532f0577de66b25dad759e9d52d3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/216fb12ae76a532f0577de66b25dad759e9d52d3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/78b680e14a287a98ec0501116607bb49b31c9f28", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/78b680e14a287a98ec0501116607bb49b31c9f28", "html_url": "https://github.com/rust-lang/rust/commit/78b680e14a287a98ec0501116607bb49b31c9f28", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/78b680e14a287a98ec0501116607bb49b31c9f28/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1fca19c8ca4ae5e71e8b17a82c3acfeb78c48891", "url": "https://api.github.com/repos/rust-lang/rust/commits/1fca19c8ca4ae5e71e8b17a82c3acfeb78c48891", "html_url": "https://github.com/rust-lang/rust/commit/1fca19c8ca4ae5e71e8b17a82c3acfeb78c48891"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "abd7094440e57c2a1aac6ba98d2e5e3ef740c8b8", "filename": "compiler/rustc_const_eval/src/interpret/eval_context.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/78b680e14a287a98ec0501116607bb49b31c9f28/compiler%2Frustc_const_eval%2Fsrc%2Finterpret%2Feval_context.rs", "raw_url": "https://github.com/rust-lang/rust/raw/78b680e14a287a98ec0501116607bb49b31c9f28/compiler%2Frustc_const_eval%2Fsrc%2Finterpret%2Feval_context.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_const_eval%2Fsrc%2Finterpret%2Feval_context.rs?ref=78b680e14a287a98ec0501116607bb49b31c9f28", "patch": "@@ -444,6 +444,7 @@ impl<'mir, 'tcx: 'mir, M: Machine<'mir, 'tcx>> InterpCx<'mir, 'tcx, M> {\n         match scalar.try_to_int() {\n             Ok(int) => int.is_null(),\n             Err(_) => {\n+                // Can only happen during CTFE.\n                 let ptr = self.scalar_to_ptr(scalar);\n                 match self.memory.ptr_try_get_alloc(ptr) {\n                     Ok((alloc_id, offset, _)) => {\n@@ -455,7 +456,7 @@ impl<'mir, 'tcx: 'mir, M: Machine<'mir, 'tcx>> InterpCx<'mir, 'tcx, M> {\n                         // Note that one-past-the-end (offset == size) is still inbounds, and never null.\n                         offset > size\n                     }\n-                    Err(offset) => offset == 0,\n+                    Err(_offset) => bug!(\"a non-int scalar is always a pointer\"),\n                 }\n             }\n         }"}]}