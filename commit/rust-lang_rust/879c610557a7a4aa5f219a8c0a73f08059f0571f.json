{"sha": "879c610557a7a4aa5f219a8c0a73f08059f0571f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg3OWM2MTA1NTdhN2E0YWE1ZjIxOWE4YzBhNzNmMDgwNTlmMDU3MWY=", "commit": {"author": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2019-07-15T23:55:11Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-07-15T23:55:11Z"}, "message": "Rollup merge of #62673 - RalfJung:validity-msg, r=oli-obk\n\nmiri validation: better error messages for dangling references\n\nCc @oli-obk", "tree": {"sha": "7480de88baaa22a19262cb217f3ca32828af8358", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7480de88baaa22a19262cb217f3ca32828af8358"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/879c610557a7a4aa5f219a8c0a73f08059f0571f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdLRJfCRBK7hj4Ov3rIwAAdHIIALEn7E4FN4rEzEUi38lUZJzd\nXVLLpc3JJ3vyA3U9Z9Rj3HYGD1ZS+jpvYviweH1HfciHjG9mYgFX3AfZRdKFw8X3\nxOXrvR+ZD2G0aYtPBzzb0N03ok2MluSb+Fdf+Y0kL4TjwcUmG5zsT7Bt11xvCIL/\nP3vmX8ooLh6XpAJM4NkysS7skACmb1YaAj/K6cUnzSVfFwieGqZAqMfqQrJfqC4V\nQgTZmnltkXUFwSbM0WPS0HcRXvjYf/tr5UckB9RXhtUPISus2BOeTDylp+Er9gDM\n826SDYZkJWQCYNjyfg9xGH9fHSCS8nLrVvVX5TS4yauIWm7KogU/vmkTOLpi4OU=\n=SyDY\n-----END PGP SIGNATURE-----\n", "payload": "tree 7480de88baaa22a19262cb217f3ca32828af8358\nparent f9576a6fce3a185ef6f61045a566f47c7bd54758\nparent 5db782767c1b1ee0dd5b0119fed9a1b99410237f\nauthor Mark Rousskov <mark.simulacrum@gmail.com> 1563234911 -0400\ncommitter GitHub <noreply@github.com> 1563234911 -0400\n\nRollup merge of #62673 - RalfJung:validity-msg, r=oli-obk\n\nmiri validation: better error messages for dangling references\n\nCc @oli-obk\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/879c610557a7a4aa5f219a8c0a73f08059f0571f", "html_url": "https://github.com/rust-lang/rust/commit/879c610557a7a4aa5f219a8c0a73f08059f0571f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/879c610557a7a4aa5f219a8c0a73f08059f0571f/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f9576a6fce3a185ef6f61045a566f47c7bd54758", "url": "https://api.github.com/repos/rust-lang/rust/commits/f9576a6fce3a185ef6f61045a566f47c7bd54758", "html_url": "https://github.com/rust-lang/rust/commit/f9576a6fce3a185ef6f61045a566f47c7bd54758"}, {"sha": "5db782767c1b1ee0dd5b0119fed9a1b99410237f", "url": "https://api.github.com/repos/rust-lang/rust/commits/5db782767c1b1ee0dd5b0119fed9a1b99410237f", "html_url": "https://github.com/rust-lang/rust/commit/5db782767c1b1ee0dd5b0119fed9a1b99410237f"}], "stats": {"total": 10, "additions": 5, "deletions": 5}, "files": [{"sha": "da9780ac0a305ba93278f55fca283a889a9599be", "filename": "src/librustc_mir/interpret/validity.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/879c610557a7a4aa5f219a8c0a73f08059f0571f/src%2Flibrustc_mir%2Finterpret%2Fvalidity.rs", "raw_url": "https://github.com/rust-lang/rust/raw/879c610557a7a4aa5f219a8c0a73f08059f0571f/src%2Flibrustc_mir%2Finterpret%2Fvalidity.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Fvalidity.rs?ref=879c610557a7a4aa5f219a8c0a73f08059f0571f", "patch": "@@ -414,12 +414,12 @@ impl<'rt, 'mir, 'tcx, M: Machine<'mir, 'tcx>> ValueVisitor<'mir, 'tcx, M>\n                                     required.bytes(), has.bytes()), self.path),\n                             InterpError::ReadBytesAsPointer =>\n                                 return validation_failure!(\n-                                    \"integer pointer in non-ZST reference\",\n+                                    \"dangling reference (created from integer)\",\n                                     self.path\n                                 ),\n                             _ =>\n                                 return validation_failure!(\n-                                    \"dangling (not entirely in bounds) reference\",\n+                                    \"dangling reference (not entirely in bounds)\",\n                                     self.path\n                                 ),\n                         }"}, {"sha": "f1702955ed7b1618829066d125d360f09ceba8b8", "filename": "src/test/ui/consts/const-eval/ub-ref.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/879c610557a7a4aa5f219a8c0a73f08059f0571f/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fub-ref.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/879c610557a7a4aa5f219a8c0a73f08059f0571f/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fub-ref.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fub-ref.stderr?ref=879c610557a7a4aa5f219a8c0a73f08059f0571f", "patch": "@@ -34,7 +34,7 @@ error[E0080]: it is undefined behavior to use this value\n   --> $DIR/ub-ref.rs:20:1\n    |\n LL | const USIZE_AS_REF: &'static u8 = unsafe { mem::transmute(1337usize) };\n-   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ type validation failed: encountered integer pointer in non-ZST reference\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ type validation failed: encountered dangling reference (created from integer)\n    |\n    = note: The rules on what exactly is undefined behavior aren't clear, so this check might be overzealous. Please open an issue on the rust compiler repository if you believe it should not be considered undefined behavior\n "}, {"sha": "aac32ecc5b74757f7e2df4803086a569f806a04b", "filename": "src/test/ui/consts/const-eval/union-ub-fat-ptr.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/879c610557a7a4aa5f219a8c0a73f08059f0571f/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Funion-ub-fat-ptr.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/879c610557a7a4aa5f219a8c0a73f08059f0571f/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Funion-ub-fat-ptr.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Funion-ub-fat-ptr.stderr?ref=879c610557a7a4aa5f219a8c0a73f08059f0571f", "patch": "@@ -2,7 +2,7 @@ error[E0080]: it is undefined behavior to use this value\n   --> $DIR/union-ub-fat-ptr.rs:78:1\n    |\n LL | const B: &str = unsafe { SliceTransmute { repr: SliceRepr { ptr: &42, len: 999 } }.str};\n-   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ type validation failed: encountered dangling (not entirely in bounds) reference\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ type validation failed: encountered dangling reference (not entirely in bounds)\n    |\n    = note: The rules on what exactly is undefined behavior aren't clear, so this check might be overzealous. Please open an issue on the rust compiler repository if you believe it should not be considered undefined behavior\n \n@@ -26,7 +26,7 @@ error[E0080]: it is undefined behavior to use this value\n   --> $DIR/union-ub-fat-ptr.rs:90:1\n    |\n LL | const B2: &[u8] = unsafe { SliceTransmute { repr: SliceRepr { ptr: &42, len: 999 } }.slice};\n-   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ type validation failed: encountered dangling (not entirely in bounds) reference\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ type validation failed: encountered dangling reference (not entirely in bounds)\n    |\n    = note: The rules on what exactly is undefined behavior aren't clear, so this check might be overzealous. Please open an issue on the rust compiler repository if you believe it should not be considered undefined behavior\n "}]}