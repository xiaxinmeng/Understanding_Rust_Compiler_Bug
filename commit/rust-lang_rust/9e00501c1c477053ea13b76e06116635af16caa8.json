{"sha": "9e00501c1c477053ea13b76e06116635af16caa8", "node_id": "C_kwDOAAsO6NoAKDllMDA1MDFjMWM0NzcwNTNlYTEzYjc2ZTA2MTE2NjM1YWYxNmNhYTg", "commit": {"author": {"name": "Shinwoo Park", "email": "natural7530@gmail.com", "date": "2021-10-26T01:58:13Z"}, "committer": {"name": "Shinwoo Park", "email": "natural7530@gmail.com", "date": "2021-10-26T01:58:13Z"}, "message": "rustdoc: use ttf based font for cjk glyphs", "tree": {"sha": "afbf67a4010effc70ceeca9de760898ef302c9c6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/afbf67a4010effc70ceeca9de760898ef302c9c6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9e00501c1c477053ea13b76e06116635af16caa8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9e00501c1c477053ea13b76e06116635af16caa8", "html_url": "https://github.com/rust-lang/rust/commit/9e00501c1c477053ea13b76e06116635af16caa8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9e00501c1c477053ea13b76e06116635af16caa8/comments", "author": null, "committer": null, "parents": [{"sha": "bdcb52851231dc14bc6a7915dc62528cae7b8137", "url": "https://api.github.com/repos/rust-lang/rust/commits/bdcb52851231dc14bc6a7915dc62528cae7b8137", "html_url": "https://github.com/rust-lang/rust/commit/bdcb52851231dc14bc6a7915dc62528cae7b8137"}], "stats": {"total": 96, "additions": 61, "deletions": 35}, "files": [{"sha": "2672587cb9f1743b1b0a3528a3068b7f89857715", "filename": "src/librustdoc/html/render/write_shared.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/9e00501c1c477053ea13b76e06116635af16caa8/src%2Flibrustdoc%2Fhtml%2Frender%2Fwrite_shared.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9e00501c1c477053ea13b76e06116635af16caa8/src%2Flibrustdoc%2Fhtml%2Frender%2Fwrite_shared.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fwrite_shared.rs?ref=9e00501c1c477053ea13b76e06116635af16caa8", "patch": "@@ -39,9 +39,9 @@ static FILES_UNVERSIONED: Lazy<FxHashMap<&str, &[u8]>> = Lazy::new(|| {\n         \"SourceCodePro-Semibold.ttf.woff\" => static_files::source_code_pro::SEMIBOLD,\n         \"SourceCodePro-It.ttf.woff\" => static_files::source_code_pro::ITALIC,\n         \"SourceCodePro-LICENSE.txt\" => static_files::source_code_pro::LICENSE,\n-        \"noto-sans-kr-regular.woff2\" => static_files::noto_sans_kr::REGULAR2,\n-        \"noto-sans-kr-regular.woff\" => static_files::noto_sans_kr::REGULAR,\n-        \"noto-sans-kr-LICENSE.txt\" => static_files::noto_sans_kr::LICENSE,\n+        \"NanumBarunGothic.ttf.woff2\" => static_files::nanum_barun_gothic::REGULAR2,\n+        \"NanumBarunGothic.ttf.woff\" => static_files::nanum_barun_gothic::REGULAR,\n+        \"NanumBarunGothic-LICENSE.txt\" => static_files::nanum_barun_gothic::LICENSE,\n         \"LICENSE-MIT.txt\" => static_files::LICENSE_MIT,\n         \"LICENSE-APACHE.txt\" => static_files::LICENSE_APACHE,\n         \"COPYRIGHT.txt\" => static_files::COPYRIGHT,"}, {"sha": "d29c934c5e70624ef378f188a490a123003de358", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/9e00501c1c477053ea13b76e06116635af16caa8/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/9e00501c1c477053ea13b76e06116635af16caa8/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=9e00501c1c477053ea13b76e06116635af16caa8", "patch": "@@ -77,11 +77,11 @@\n \n /* Avoid using legacy CJK serif fonts in Windows like Batang. */\n @font-face {\n-\tfont-family: 'Noto Sans KR';\n-\tsrc: url(\"noto-sans-kr-regular.woff2\") format(\"woff2\"),\n-\t\turl(\"noto-sans-kr-regular.woff\") format(\"woff\");\n+\tfont-family: 'NanumBarunGothic';\n+\tsrc: url(\"NanumBarunGothic.ttf.woff2\") format(\"woff2\"),\n+\t\turl(\"NanumBarunGothic.ttf.woff\") format(\"woff\");\n \tfont-display: swap;\n-\tunicode-range: U+AC00-D7AF, U+3130-318F, U+1100-11FF, U+A960-A97F, U+D7B0-D7FF;\n+\tunicode-range: U+AC00-D7AF, U+1100-11FF, U+3130-318F, U+A960-A97F, U+D7B0-D7FF;\n }\n \n * {\n@@ -108,7 +108,7 @@ html {\n /* General structure and fonts */\n \n body {\n-\tfont: 16px/1.4 \"Source Serif 4\", \"Noto Sans KR\", serif;\n+\tfont: 16px/1.4 \"Source Serif 4\", NanumBarunGothic, serif;\n \tmargin: 0;\n \tposition: relative;\n \tpadding: 10px 15px 20px 15px;\n@@ -197,7 +197,7 @@ div.impl-items > div:not(.docblock):not(.item-info),\n .content ul.crate a.crate, a.srclink,\n /* This selector is for the items listed in the \"all items\" page. */\n #main > ul.docblock > li > a {\n-\tfont-family: \"Fira Sans\", Arial, sans-serif;\n+\tfont-family: \"Fira Sans\", Arial, NanumBarunGothic, sans-serif;\n }\n \n .content ul.crate a.crate {"}, {"sha": "0bf46682b5b893c026a8a97ad8838b5e893ab9d2", "filename": "src/librustdoc/html/static/fonts/NanumBarunGothic-LICENSE.txt", "status": "renamed", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/9e00501c1c477053ea13b76e06116635af16caa8/src%2Flibrustdoc%2Fhtml%2Fstatic%2Ffonts%2FNanumBarunGothic-LICENSE.txt", "raw_url": "https://github.com/rust-lang/rust/raw/9e00501c1c477053ea13b76e06116635af16caa8/src%2Flibrustdoc%2Fhtml%2Fstatic%2Ffonts%2FNanumBarunGothic-LICENSE.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Ffonts%2FNanumBarunGothic-LICENSE.txt?ref=9e00501c1c477053ea13b76e06116635af16caa8", "patch": "@@ -1,8 +1,14 @@\n-Copyright 2014, 2015 Adobe Systems Incorporated (http://www.adobe.com/), with Reserved Font Name 'Source'. All Rights Reserved. Source is a trademark of Adobe Systems Incorporated in the United States and/or other countries.\n+Copyright (c) 2010, NAVER Corporation (https://www.navercorp.com/),\n \n-This Font Software is licensed under the SIL Open Font License, Version 1.1.\n+with Reserved Font Name Nanum, Naver Nanum, NanumGothic, Naver NanumGothic,\n+NanumMyeongjo, Naver NanumMyeongjo, NanumBrush, Naver NanumBrush, NanumPen,\n+Naver NanumPen, Naver NanumGothicEco, NanumGothicEco, Naver NanumMyeongjoEco,\n+NanumMyeongjoEco, Naver NanumGothicLight, NanumGothicLight, NanumBarunGothic,\n+Naver NanumBarunGothic, NanumSquareRound, NanumBarunPen, MaruBuri\n \n-This license is copied below, and is also available with a FAQ at: http://scripts.sil.org/OFL\n+This Font Software is licensed under the SIL Open Font License, Version 1.1.\n+This license is copied below, and is also available with a FAQ at:\n+http://scripts.sil.org/OFL\n \n \n -----------------------------------------------------------", "previous_filename": "src/librustdoc/html/static/fonts/noto-sans-kr-LICENSE.txt"}, {"sha": "fb063e8fb7dc5435c591560e257903a35f76ee6a", "filename": "src/librustdoc/html/static/fonts/NanumBarunGothic.ttf.woff", "status": "added", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/9e00501c1c477053ea13b76e06116635af16caa8/src%2Flibrustdoc%2Fhtml%2Fstatic%2Ffonts%2FNanumBarunGothic.ttf.woff", "raw_url": "https://github.com/rust-lang/rust/raw/9e00501c1c477053ea13b76e06116635af16caa8/src%2Flibrustdoc%2Fhtml%2Fstatic%2Ffonts%2FNanumBarunGothic.ttf.woff", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Ffonts%2FNanumBarunGothic.ttf.woff?ref=9e00501c1c477053ea13b76e06116635af16caa8"}, {"sha": "1866ad4bcea609c1008f722bb47b8207534e9c7c", "filename": "src/librustdoc/html/static/fonts/NanumBarunGothic.ttf.woff2", "status": "added", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/9e00501c1c477053ea13b76e06116635af16caa8/src%2Flibrustdoc%2Fhtml%2Fstatic%2Ffonts%2FNanumBarunGothic.ttf.woff2", "raw_url": "https://github.com/rust-lang/rust/raw/9e00501c1c477053ea13b76e06116635af16caa8/src%2Flibrustdoc%2Fhtml%2Fstatic%2Ffonts%2FNanumBarunGothic.ttf.woff2", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Ffonts%2FNanumBarunGothic.ttf.woff2?ref=9e00501c1c477053ea13b76e06116635af16caa8"}, {"sha": "65e939c6b9f540950bc2bd4c41d60c556ddca6f7", "filename": "src/librustdoc/html/static/fonts/noto-sans-kr-regular.woff", "status": "removed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/bdcb52851231dc14bc6a7915dc62528cae7b8137/src%2Flibrustdoc%2Fhtml%2Fstatic%2Ffonts%2Fnoto-sans-kr-regular.woff", "raw_url": "https://github.com/rust-lang/rust/raw/bdcb52851231dc14bc6a7915dc62528cae7b8137/src%2Flibrustdoc%2Fhtml%2Fstatic%2Ffonts%2Fnoto-sans-kr-regular.woff", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Ffonts%2Fnoto-sans-kr-regular.woff?ref=bdcb52851231dc14bc6a7915dc62528cae7b8137"}, {"sha": "8126492e41df33eb26bc6f0351cd8ae77777e961", "filename": "src/librustdoc/html/static/fonts/noto-sans-kr-regular.woff2", "status": "removed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/bdcb52851231dc14bc6a7915dc62528cae7b8137/src%2Flibrustdoc%2Fhtml%2Fstatic%2Ffonts%2Fnoto-sans-kr-regular.woff2", "raw_url": "https://github.com/rust-lang/rust/raw/bdcb52851231dc14bc6a7915dc62528cae7b8137/src%2Flibrustdoc%2Fhtml%2Fstatic%2Ffonts%2Fnoto-sans-kr-regular.woff2", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Ffonts%2Fnoto-sans-kr-regular.woff2?ref=bdcb52851231dc14bc6a7915dc62528cae7b8137"}, {"sha": "56c5399d074b64c8f5479416a6f1a90a5ce020ec", "filename": "src/librustdoc/html/static_files.rs", "status": "modified", "additions": 29, "deletions": 9, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/9e00501c1c477053ea13b76e06116635af16caa8/src%2Flibrustdoc%2Fhtml%2Fstatic_files.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9e00501c1c477053ea13b76e06116635af16caa8/src%2Flibrustdoc%2Fhtml%2Fstatic_files.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic_files.rs?ref=9e00501c1c477053ea13b76e06116635af16caa8", "patch": "@@ -160,15 +160,35 @@ crate mod source_code_pro {\n     crate static LICENSE: &[u8] = include_bytes!(\"static/fonts/SourceCodePro-LICENSE.txt\");\n }\n \n-crate mod noto_sans_kr {\n-    /// The file `noto-sans-kr.woff`, the Regular variant of the Noto Sans KR font.\n-    crate static REGULAR: &[u8] = include_bytes!(\"static/fonts/noto-sans-kr-regular.woff\");\n-\n-    /// The file `noto-sans-kr.woff2`, the Regular variant of the Noto Sans KR font.\n-    crate static REGULAR2: &[u8] = include_bytes!(\"static/fonts/noto-sans-kr-regular.woff2\");\n-\n-    /// The file `noto-sans-kr-LICENSE.txt`, the license text of the Noto Sans KR font.\n-    crate static LICENSE: &[u8] = include_bytes!(\"static/fonts/noto-sans-kr-LICENSE.txt\");\n+/// Files related to the Nanum Barun Gothic font.\n+///\n+/// These files are used to avoid some legacy CJK serif fonts in Windows.\n+///\n+/// Note that the Noto Sans KR font, which was used previously but was not very readable on Windows,\n+/// has been replaced by the Nanum Barun Gothic font. This is due to Windows' implementation of font\n+/// rendering that distorts OpenType fonts too much.\n+///\n+/// The font files were generated with these commands:\n+///\n+/// ```sh\n+/// pyftsubset NanumBarunGothic.ttf \\\n+/// --unicodes=U+AC00-D7AF,U+1100-11FF,U+3130-318F,U+A960-A97F,U+D7B0-D7FF \\\n+/// --output-file=NanumBarunGothic.ttf.woff --flavor=woff\n+/// ```\n+/// ```sh\n+/// pyftsubset NanumBarunGothic.ttf \\\n+/// --unicodes=U+AC00-D7AF,U+1100-11FF,U+3130-318F,U+A960-A97F,U+D7B0-D7FF \\\n+/// --output-file=NanumBarunGothic.ttf.woff2 --flavor=woff2\n+/// ```\n+crate mod nanum_barun_gothic {\n+    /// The file `NanumBarunGothic.ttf.woff`, the Regular variant of the Nanum Barun Gothic font.\n+    crate static REGULAR: &[u8] = include_bytes!(\"static/fonts/NanumBarunGothic.ttf.woff\");\n+\n+    /// The file `NanumBarunGothic.ttf.woff2`, the Regular variant of the Nanum Barun Gothic font.\n+    crate static REGULAR2: &[u8] = include_bytes!(\"static/fonts/NanumBarunGothic.ttf.woff2\");\n+\n+    /// The file `NanumBarunGothic-LICENSE.txt`, the license text of the Nanum Barun Gothic font.\n+    crate static LICENSE: &[u8] = include_bytes!(\"static/fonts/NanumBarunGothic-LICENSE.txt\");\n }\n \n /// Files related to the sidebar in rustdoc sources."}, {"sha": "0316172ee1464663e393d4290d63f01f7491b59b", "filename": "src/test/rustdoc-gui/module-items-font.goml", "status": "modified", "additions": 14, "deletions": 14, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/9e00501c1c477053ea13b76e06116635af16caa8/src%2Ftest%2Frustdoc-gui%2Fmodule-items-font.goml", "raw_url": "https://github.com/rust-lang/rust/raw/9e00501c1c477053ea13b76e06116635af16caa8/src%2Ftest%2Frustdoc-gui%2Fmodule-items-font.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fmodule-items-font.goml?ref=9e00501c1c477053ea13b76e06116635af16caa8", "patch": "@@ -1,23 +1,23 @@\n // This test checks that the correct font is used on module items (in index.html pages).\n goto: file://|DOC_PATH|/test_docs/index.html\n-assert-css: (\".item-table .module-item a\", {\"font-family\": '\"Fira Sans\", Arial, sans-serif'}, ALL)\n-assert-css: (\".item-table .docblock-short\", {\"font-family\": '\"Source Serif 4\", \"Noto Sans KR\", serif'}, ALL)\n+assert-css: (\".item-table .module-item a\", {\"font-family\": '\"Fira Sans\", Arial, NanumBarunGothic, sans-serif'}, ALL)\n+assert-css: (\".item-table .docblock-short\", {\"font-family\": '\"Source Serif 4\", NanumBarunGothic, serif'}, ALL)\n \n // modules\n-assert-css: (\"#modules + .item-table .item-left a\", {\"font-family\": '\"Fira Sans\", Arial, sans-serif'})\n-assert-css: (\"#modules + .item-table .item-right.docblock-short\", {\"font-family\": '\"Source Serif 4\", \"Noto Sans KR\", serif'})\n+assert-css: (\"#modules + .item-table .item-left a\", {\"font-family\": '\"Fira Sans\", Arial, NanumBarunGothic, sans-serif'})\n+assert-css: (\"#modules + .item-table .item-right.docblock-short\", {\"font-family\": '\"Source Serif 4\", NanumBarunGothic, serif'})\n // structs\n-assert-css: (\"#structs + .item-table .item-left a\", {\"font-family\": '\"Fira Sans\", Arial, sans-serif'})\n-assert-css: (\"#structs + .item-table .item-right.docblock-short\", {\"font-family\": '\"Source Serif 4\", \"Noto Sans KR\", serif'})\n+assert-css: (\"#structs + .item-table .item-left a\", {\"font-family\": '\"Fira Sans\", Arial, NanumBarunGothic, sans-serif'})\n+assert-css: (\"#structs + .item-table .item-right.docblock-short\", {\"font-family\": '\"Source Serif 4\", NanumBarunGothic, serif'})\n // enums\n-assert-css: (\"#enums + .item-table .item-left a\", {\"font-family\": '\"Fira Sans\", Arial, sans-serif'})\n-assert-css: (\"#enums + .item-table .item-right.docblock-short\", {\"font-family\": '\"Source Serif 4\", \"Noto Sans KR\", serif'})\n+assert-css: (\"#enums + .item-table .item-left a\", {\"font-family\": '\"Fira Sans\", Arial, NanumBarunGothic, sans-serif'})\n+assert-css: (\"#enums + .item-table .item-right.docblock-short\", {\"font-family\": '\"Source Serif 4\", NanumBarunGothic, serif'})\n // traits\n-assert-css: (\"#traits + .item-table .item-left a\", {\"font-family\": '\"Fira Sans\", Arial, sans-serif'})\n-assert-css: (\"#traits + .item-table .item-right.docblock-short\", {\"font-family\": '\"Source Serif 4\", \"Noto Sans KR\", serif'})\n+assert-css: (\"#traits + .item-table .item-left a\", {\"font-family\": '\"Fira Sans\", Arial, NanumBarunGothic, sans-serif'})\n+assert-css: (\"#traits + .item-table .item-right.docblock-short\", {\"font-family\": '\"Source Serif 4\", NanumBarunGothic, serif'})\n // functions\n-assert-css: (\"#functions + .item-table .item-left a\", {\"font-family\": '\"Fira Sans\", Arial, sans-serif'})\n-assert-css: (\"#functions + .item-table .item-right.docblock-short\", {\"font-family\": '\"Source Serif 4\", \"Noto Sans KR\", serif'})\n+assert-css: (\"#functions + .item-table .item-left a\", {\"font-family\": '\"Fira Sans\", Arial, NanumBarunGothic, sans-serif'})\n+assert-css: (\"#functions + .item-table .item-right.docblock-short\", {\"font-family\": '\"Source Serif 4\", NanumBarunGothic, serif'})\n // keywords\n-assert-css: (\"#keywords + .item-table .item-left a\", {\"font-family\": '\"Fira Sans\", Arial, sans-serif'})\n-assert-css: (\"#keywords + .item-table .item-right.docblock-short\", {\"font-family\": '\"Source Serif 4\", \"Noto Sans KR\", serif'})\n+assert-css: (\"#keywords + .item-table .item-left a\", {\"font-family\": '\"Fira Sans\", Arial, NanumBarunGothic, sans-serif'})\n+assert-css: (\"#keywords + .item-table .item-right.docblock-short\", {\"font-family\": '\"Source Serif 4\", NanumBarunGothic, serif'})"}]}