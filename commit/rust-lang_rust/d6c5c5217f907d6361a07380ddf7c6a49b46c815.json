{"sha": "d6c5c5217f907d6361a07380ddf7c6a49b46c815", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ2YzVjNTIxN2Y5MDdkNjM2MWEwNzM4MGRkZjdjNmE0OWI0NmM4MTU=", "commit": {"author": {"name": "Mara Bos", "email": "m-ou.se@m-ou.se", "date": "2020-11-17T09:06:31Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-11-17T09:06:31Z"}, "message": "Rollup merge of #79107 - pietroalbini:build-manifest-newline, r=Mark-Simulacrum\n\nbuild-manifest: strip newline from rustc version\n\nBackport of https://github.com/rust-lang/rust/pull/79096 on the master branch. This will also need to be included in the beta bump tomorrow.\n\nr? `@Mark-Simulacrum`\n`@rustbot` modify labels: beta-nominated beta-accepted T-infra", "tree": {"sha": "b96ef923d413f4013a49db6ced0332effede9fc8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b96ef923d413f4013a49db6ced0332effede9fc8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d6c5c5217f907d6361a07380ddf7c6a49b46c815", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfs5KXCRBK7hj4Ov3rIwAAdHIIABp4Jt/OW5VkxJU6ynR7+qie\nhZ/jMiQ65LQfxHLDPd5UujLlQ5tBg1LIaIktyaILjUkb9rDdSqZUTsBdTZr5k7Jq\nNSsumn81whyDuJsqU0KPBau/dJETCnWywH0yRTXqEitVQS48qE83WKdi+GLxrfw0\n76UgDF6M3X5iphoR4Tq5BH1nZ7TZuSfpdxVsiUPsXb9W87WH0Cwbzi7rXJ/39beq\nFNk81CzT2F83qPkYgA0FsonAforKmxDbOPR3fG81A6i2msLeoE5NIq0HCd7XLf6C\nVKi5aRW9h0uRiQbMqkMj7QMEIxhhbp/VuqcDuqACtQ6h6X9eHYp6PRBP0kR8yzE=\n=gUvC\n-----END PGP SIGNATURE-----\n", "payload": "tree b96ef923d413f4013a49db6ced0332effede9fc8\nparent a207801551e39278e9d65581d33ed22b97e19294\nparent 32d3146ea6507e181f1738bda513d6ece63f071d\nauthor Mara Bos <m-ou.se@m-ou.se> 1605603991 +0100\ncommitter GitHub <noreply@github.com> 1605603991 +0100\n\nRollup merge of #79107 - pietroalbini:build-manifest-newline, r=Mark-Simulacrum\n\nbuild-manifest: strip newline from rustc version\n\nBackport of https://github.com/rust-lang/rust/pull/79096 on the master branch. This will also need to be included in the beta bump tomorrow.\n\nr? `@Mark-Simulacrum`\n`@rustbot` modify labels: beta-nominated beta-accepted T-infra\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d6c5c5217f907d6361a07380ddf7c6a49b46c815", "html_url": "https://github.com/rust-lang/rust/commit/d6c5c5217f907d6361a07380ddf7c6a49b46c815", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d6c5c5217f907d6361a07380ddf7c6a49b46c815/comments", "author": {"login": "m-ou-se", "id": 783247, "node_id": "MDQ6VXNlcjc4MzI0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/783247?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m-ou-se", "html_url": "https://github.com/m-ou-se", "followers_url": "https://api.github.com/users/m-ou-se/followers", "following_url": "https://api.github.com/users/m-ou-se/following{/other_user}", "gists_url": "https://api.github.com/users/m-ou-se/gists{/gist_id}", "starred_url": "https://api.github.com/users/m-ou-se/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m-ou-se/subscriptions", "organizations_url": "https://api.github.com/users/m-ou-se/orgs", "repos_url": "https://api.github.com/users/m-ou-se/repos", "events_url": "https://api.github.com/users/m-ou-se/events{/privacy}", "received_events_url": "https://api.github.com/users/m-ou-se/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a207801551e39278e9d65581d33ed22b97e19294", "url": "https://api.github.com/repos/rust-lang/rust/commits/a207801551e39278e9d65581d33ed22b97e19294", "html_url": "https://github.com/rust-lang/rust/commit/a207801551e39278e9d65581d33ed22b97e19294"}, {"sha": "32d3146ea6507e181f1738bda513d6ece63f071d", "url": "https://api.github.com/repos/rust-lang/rust/commits/32d3146ea6507e181f1738bda513d6ece63f071d", "html_url": "https://github.com/rust-lang/rust/commit/32d3146ea6507e181f1738bda513d6ece63f071d"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "11575139adcf6656b069e3e14ffa45e6d771afc4", "filename": "src/tools/build-manifest/src/versions.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/d6c5c5217f907d6361a07380ddf7c6a49b46c815/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fversions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6c5c5217f907d6361a07380ddf7c6a49b46c815/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fversions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fversions.rs?ref=d6c5c5217f907d6361a07380ddf7c6a49b46c815", "patch": "@@ -7,7 +7,6 @@ use std::path::{Path, PathBuf};\n use tar::Archive;\n \n const DEFAULT_TARGET: &str = \"x86_64-unknown-linux-gnu\";\n-const RUSTC_VERSION: &str = include_str!(\"../../../version\");\n \n #[derive(Debug, Hash, Eq, PartialEq, Clone)]\n pub(crate) enum PkgType {\n@@ -177,10 +176,10 @@ impl Versions {\n     ) -> Result<String, Error> {\n         let component_name = package.tarball_component_name();\n         let version = match self.channel.as_str() {\n-            \"stable\" => RUSTC_VERSION.into(),\n+            \"stable\" => self.rustc_version().into(),\n             \"beta\" => \"beta\".into(),\n             \"nightly\" => \"nightly\".into(),\n-            _ => format!(\"{}-dev\", RUSTC_VERSION),\n+            _ => format!(\"{}-dev\", self.rustc_version()),\n         };\n \n         if package.target_independent() {\n@@ -199,6 +198,7 @@ impl Versions {\n     }\n \n     pub(crate) fn rustc_version(&self) -> &str {\n-        RUSTC_VERSION\n+        const RUSTC_VERSION: &str = include_str!(\"../../../version\");\n+        RUSTC_VERSION.trim()\n     }\n }"}]}