{"sha": "c8e3c517828e2b0c3695140825e6f4ac497c0777", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM4ZTNjNTE3ODI4ZTJiMGMzNjk1MTQwODI1ZTZmNGFjNDk3YzA3Nzc=", "commit": {"author": {"name": "Tyler Mandry", "email": "tmandry@gmail.com", "date": "2019-10-11T22:10:00Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-10-11T22:10:00Z"}, "message": "Rollup merge of #65310 - da-x:issue-56195, r=petrochenkov\n\nderiving: avoid dummy Span on an artificial `type_ident` path\n\nThe dummy Span pointed to the beginning of the source file instead to where the `#[derive]` is located. Later, it tripped the `in_derive_expansion(span)` check at `src/librustc/middle/stability.rs`, causing a span-less deprecation warning to be emitted.\n\nFixes #56195, Fixes #55417.", "tree": {"sha": "330e62c67797cffbfb908e458941befb8eb22851", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/330e62c67797cffbfb908e458941befb8eb22851"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c8e3c517828e2b0c3695140825e6f4ac497c0777", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdoP24CRBK7hj4Ov3rIwAAdHIIACz2gWilu9b9Esi6IzZQUnQv\noSjGZjk0c/h7ib2It0UFEL154VxcCPuuauLXJcgHUHL3Fdd50zF2S5933jOwXETy\nlQHakOcV9lMxYYTko3NatPwqJV22MCaSIfO8PYPXe+0zWtq+jt4r/UsU+U96BiMT\n0kKEQaoskh67iTYVdmpSmO9x2XDjIQmrF3DBz3EdAFA1AnRtgSqViS2cVJbtWMu7\nch5hkCU1JSN1mmmEsPFkQMU/Cx2esTyUcrfp0qZs8ynuEK8tYWYhmQpyD4i3pSqB\nbJchLGbmbkc1Jw2yXJDwmHl1P/RerA5JFgZmzzj+9k04ie9/swdBQyOs+Osc2cc=\n=XEvx\n-----END PGP SIGNATURE-----\n", "payload": "tree 330e62c67797cffbfb908e458941befb8eb22851\nparent 811bd38ae1f183981e5ec1dc1fe096bd17929825\nparent e285175b63626bf930b90b27ba78b35842d0da2f\nauthor Tyler Mandry <tmandry@gmail.com> 1570831800 -0700\ncommitter GitHub <noreply@github.com> 1570831800 -0700\n\nRollup merge of #65310 - da-x:issue-56195, r=petrochenkov\n\nderiving: avoid dummy Span on an artificial `type_ident` path\n\nThe dummy Span pointed to the beginning of the source file instead to where the `#[derive]` is located. Later, it tripped the `in_derive_expansion(span)` check at `src/librustc/middle/stability.rs`, causing a span-less deprecation warning to be emitted.\n\nFixes #56195, Fixes #55417.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c8e3c517828e2b0c3695140825e6f4ac497c0777", "html_url": "https://github.com/rust-lang/rust/commit/c8e3c517828e2b0c3695140825e6f4ac497c0777", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c8e3c517828e2b0c3695140825e6f4ac497c0777/comments", "author": {"login": "tmandry", "id": 2280544, "node_id": "MDQ6VXNlcjIyODA1NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2280544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmandry", "html_url": "https://github.com/tmandry", "followers_url": "https://api.github.com/users/tmandry/followers", "following_url": "https://api.github.com/users/tmandry/following{/other_user}", "gists_url": "https://api.github.com/users/tmandry/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmandry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmandry/subscriptions", "organizations_url": "https://api.github.com/users/tmandry/orgs", "repos_url": "https://api.github.com/users/tmandry/repos", "events_url": "https://api.github.com/users/tmandry/events{/privacy}", "received_events_url": "https://api.github.com/users/tmandry/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "811bd38ae1f183981e5ec1dc1fe096bd17929825", "url": "https://api.github.com/repos/rust-lang/rust/commits/811bd38ae1f183981e5ec1dc1fe096bd17929825", "html_url": "https://github.com/rust-lang/rust/commit/811bd38ae1f183981e5ec1dc1fe096bd17929825"}, {"sha": "e285175b63626bf930b90b27ba78b35842d0da2f", "url": "https://api.github.com/repos/rust-lang/rust/commits/e285175b63626bf930b90b27ba78b35842d0da2f", "html_url": "https://github.com/rust-lang/rust/commit/e285175b63626bf930b90b27ba78b35842d0da2f"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "abdcb6c8e3d37a3b2fa5cea5fb3d4fced9104abc", "filename": "src/libsyntax_ext/deriving/generic/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c8e3c517828e2b0c3695140825e6f4ac497c0777/src%2Flibsyntax_ext%2Fderiving%2Fgeneric%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c8e3c517828e2b0c3695140825e6f4ac497c0777/src%2Flibsyntax_ext%2Fderiving%2Fgeneric%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax_ext%2Fderiving%2Fgeneric%2Fmod.rs?ref=c8e3c517828e2b0c3695140825e6f4ac497c0777", "patch": "@@ -192,7 +192,7 @@ use syntax::util::map_in_place::MapInPlace;\n use syntax::ptr::P;\n use syntax::symbol::{Symbol, kw, sym};\n use syntax::parse::ParseSess;\n-use syntax_pos::{DUMMY_SP, Span};\n+use syntax_pos::{Span};\n \n use ty::{LifetimeBounds, Path, Ptr, PtrTy, Self_, Ty};\n \n@@ -1022,7 +1022,7 @@ impl<'a> MethodDef<'a> {\n                                  // [fields of next Self arg], [etc]>\n         let mut patterns = Vec::new();\n         for i in 0..self_args.len() {\n-            let struct_path = cx.path(DUMMY_SP, vec![type_ident]);\n+            let struct_path = cx.path(trait_.span, vec![type_ident]);\n             let (pat, ident_expr) = trait_.create_struct_pattern(cx,\n                                                                  struct_path,\n                                                                  struct_def,"}, {"sha": "ac771ac81d118097440239f29c261dcad60561f0", "filename": "src/test/ui/deprecation/derive_on_deprecated.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/c8e3c517828e2b0c3695140825e6f4ac497c0777/src%2Ftest%2Fui%2Fdeprecation%2Fderive_on_deprecated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c8e3c517828e2b0c3695140825e6f4ac497c0777/src%2Ftest%2Fui%2Fdeprecation%2Fderive_on_deprecated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdeprecation%2Fderive_on_deprecated.rs?ref=c8e3c517828e2b0c3695140825e6f4ac497c0777", "patch": "@@ -6,4 +6,10 @@\n #[derive(Default)]\n struct X;\n \n+#[deprecated(note=\"Do not use this\")]\n+#[derive(Debug, Clone, Copy, PartialEq, Eq, PartialOrd, Ord, Default, Hash)]\n+pub struct Step<I> {\n+    _skip: Option<I>,\n+}\n+\n fn main() {}"}]}