{"sha": "c12eabfb11384dfd45cab87a809aa442203dcc53", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMxMmVhYmZiMTEzODRkZmQ0NWNhYjg3YTgwOWFhNDQyMjAzZGNjNTM=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-01-12T18:26:45Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-01-12T19:17:08Z"}, "message": "Rollup merge of #47382 - topecongiro:issue-43105, r=eddyb\n\nIgnore CTFE errors while lowering patterns\n\nCloses #43105.\n\nr? @eddyb", "tree": {"sha": "0f7929e306da4893a0db5671686f08d4443d8859", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0f7929e306da4893a0db5671686f08d4443d8859"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c12eabfb11384dfd45cab87a809aa442203dcc53", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlpZCbQACgkQ/vbIBR0O\nATzoFg/9GxyR0xCO8DTocrgwtnB7/bkRZxbRcrGUXN1N8bFzFyfKzx0+YAJYyjQe\nFHDkYD8V8tKGWsAFyo7Xiua9jn7KcyIG8PhvlxuNGdTJ4GL6CCgM3F2OH0BQf1Te\nw5PahCE+HPPvu8BSUCHEV2BfK76FrbFInFeqZ46KQ0y2F6XfE5i5Ha+7Sdo5/KxT\n6YPPp/ehaMH6NvpRbn7HVMDQfQxPF7Lx425oDWuIwvoq9i4w4+xiKFGqedx0iIes\nzplvn0sYDiWq2zEC/oqo5KJvMJjVivEhW126HxSIZ4W93QqdZGYBbH8WjITde1hz\nlOU5xtWimRkDZZGGHl2WfZVfeByBHYE6fKyVGP6MJTotY/jX0sVhbG4oxMYSyTWb\nQSvCvQ05fG7qe6WYrfMsOZgTTZG6isHz/2Sz05RVES6fu/K1U8Q1EjCTFt7uPdSl\nBBGywB+Toonv0WNGA/UPEzIKnm/4K5StBaH8tQROnNGXCvp6vEtGXMDh2DNlEob9\nXD1mDEBIH1fOeeWNXreZEfMYxm+QmIQc4bFPbgsOu6po/i8AlkNdgCWXDx6tRUHY\nwZ2DLSAv/P/uK3bxarLtLXvp9ebMzFiJcTkDLR04MRc5EeMVc4U6TMzsegZ2UvqL\nxs0MV+y0ng3gnRxRLwxq7KFEl/tN11bL80+vioaHvW/AnDc963U=\n=EV1d\n-----END PGP SIGNATURE-----", "payload": "tree 0f7929e306da4893a0db5671686f08d4443d8859\nparent 21ac84e094d0e86f23eae6ed78305f413ee8d3ed\nparent 42410a96c40790fb050b528cb1a6277743f15d4f\nauthor kennytm <kennytm@gmail.com> 1515781605 +0800\ncommitter kennytm <kennytm@gmail.com> 1515784628 +0800\n\nRollup merge of #47382 - topecongiro:issue-43105, r=eddyb\n\nIgnore CTFE errors while lowering patterns\n\nCloses #43105.\n\nr? @eddyb\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c12eabfb11384dfd45cab87a809aa442203dcc53", "html_url": "https://github.com/rust-lang/rust/commit/c12eabfb11384dfd45cab87a809aa442203dcc53", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c12eabfb11384dfd45cab87a809aa442203dcc53/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "21ac84e094d0e86f23eae6ed78305f413ee8d3ed", "url": "https://api.github.com/repos/rust-lang/rust/commits/21ac84e094d0e86f23eae6ed78305f413ee8d3ed", "html_url": "https://github.com/rust-lang/rust/commit/21ac84e094d0e86f23eae6ed78305f413ee8d3ed"}, {"sha": "42410a96c40790fb050b528cb1a6277743f15d4f", "url": "https://api.github.com/repos/rust-lang/rust/commits/42410a96c40790fb050b528cb1a6277743f15d4f", "html_url": "https://github.com/rust-lang/rust/commit/42410a96c40790fb050b528cb1a6277743f15d4f"}], "stats": {"total": 24, "additions": 23, "deletions": 1}, "files": [{"sha": "3cfa1d6797d1f098dd4ce6cc46fd5154e923a5a8", "filename": "src/librustc_const_eval/pattern.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/c12eabfb11384dfd45cab87a809aa442203dcc53/src%2Flibrustc_const_eval%2Fpattern.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c12eabfb11384dfd45cab87a809aa442203dcc53/src%2Flibrustc_const_eval%2Fpattern.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_const_eval%2Fpattern.rs?ref=c12eabfb11384dfd45cab87a809aa442203dcc53", "patch": "@@ -280,7 +280,8 @@ impl<'a, 'tcx> Pattern<'tcx> {\n         let mut pcx = PatternContext::new(tcx, param_env_and_substs, tables);\n         let result = pcx.lower_pattern(pat);\n         if !pcx.errors.is_empty() {\n-            span_bug!(pat.span, \"encountered errors lowering pattern: {:?}\", pcx.errors)\n+            let msg = format!(\"encountered errors lowering pattern: {:?}\", pcx.errors);\n+            tcx.sess.delay_span_bug(pat.span, &msg);\n         }\n         debug!(\"Pattern::from_hir({:?}) = {:?}\", pat, result);\n         result"}, {"sha": "fb419d751b4e82c6391b921842158ed60ec42263", "filename": "src/test/compile-fail/issue-43105.rs", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/c12eabfb11384dfd45cab87a809aa442203dcc53/src%2Ftest%2Fcompile-fail%2Fissue-43105.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c12eabfb11384dfd45cab87a809aa442203dcc53/src%2Ftest%2Fcompile-fail%2Fissue-43105.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-43105.rs?ref=c12eabfb11384dfd45cab87a809aa442203dcc53", "patch": "@@ -0,0 +1,21 @@\n+// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+fn xyz() -> u8 { 42 }\n+\n+const NUM: u8 = xyz();\n+//~^ ERROR calls in constants are limited to constant functions, struct and enum constructors\n+\n+fn main() {\n+    match 1 {\n+        NUM => unimplemented!(),\n+        _ => unimplemented!(),\n+    }\n+}"}]}