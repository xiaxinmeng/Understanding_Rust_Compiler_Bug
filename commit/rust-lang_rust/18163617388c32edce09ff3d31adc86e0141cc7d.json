{"sha": "18163617388c32edce09ff3d31adc86e0141cc7d", "node_id": "C_kwDOAAsO6NoAKDE4MTYzNjE3Mzg4YzMyZWRjZTA5ZmYzZDMxYWRjODZlMDE0MWNjN2Q", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-01-10T12:18:05Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-01-10T12:18:05Z"}, "message": "Auto merge of #8257 - camsteffen:internal-features, r=giraffate\n\nCombine internal cargo features\n\nchangelog: none\n\nThis is just simpler and I don't see any downsides.", "tree": {"sha": "ece4e2d62bcc1df94363cac230e4817799713b0c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ece4e2d62bcc1df94363cac230e4817799713b0c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/18163617388c32edce09ff3d31adc86e0141cc7d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/18163617388c32edce09ff3d31adc86e0141cc7d", "html_url": "https://github.com/rust-lang/rust/commit/18163617388c32edce09ff3d31adc86e0141cc7d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/18163617388c32edce09ff3d31adc86e0141cc7d/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "88cfd70100366fcd8eebcb33cc20a5c929ccc08a", "url": "https://api.github.com/repos/rust-lang/rust/commits/88cfd70100366fcd8eebcb33cc20a5c929ccc08a", "html_url": "https://github.com/rust-lang/rust/commit/88cfd70100366fcd8eebcb33cc20a5c929ccc08a"}, {"sha": "e2ce4f9462c1d65b4dce084186c0e532c27fe5a3", "url": "https://api.github.com/repos/rust-lang/rust/commits/e2ce4f9462c1d65b4dce084186c0e532c27fe5a3", "html_url": "https://github.com/rust-lang/rust/commit/e2ce4f9462c1d65b4dce084186c0e532c27fe5a3"}], "stats": {"total": 123, "additions": 58, "deletions": 65}, "files": [{"sha": "f3dd9275a42be6cd00a326912009fa3cb8a4df66", "filename": ".cargo/config.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/.cargo%2Fconfig.toml", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/.cargo%2Fconfig.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.cargo%2Fconfig.toml?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -2,7 +2,7 @@\n uitest = \"test --test compile-test\"\n dev = \"run --package clippy_dev --bin clippy_dev --manifest-path clippy_dev/Cargo.toml --\"\n lintcheck = \"run --package lintcheck --bin lintcheck --manifest-path lintcheck/Cargo.toml  -- \"\n-collect-metadata = \"test --test dogfood --features metadata-collector-lint -- run_metadata_collection_lint --ignored\"\n+collect-metadata = \"test --test dogfood --features internal -- run_metadata_collection_lint --ignored\"\n \n [build]\n # -Zbinary-dep-depinfo allows us to track which rlib files to use for compiling UI tests"}, {"sha": "8b5e814b1772e8df7a5e1e083ad2376340773835", "filename": ".github/workflows/clippy.yml", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/.github%2Fworkflows%2Fclippy.yml", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/.github%2Fworkflows%2Fclippy.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fclippy.yml?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -49,17 +49,17 @@ jobs:\n         echo \"LD_LIBRARY_PATH=${SYSROOT}/lib${LD_LIBRARY_PATH+:${LD_LIBRARY_PATH}}\" >> $GITHUB_ENV\n \n     - name: Build\n-      run: cargo build --features deny-warnings,internal-lints,metadata-collector-lint\n+      run: cargo build --features deny-warnings,internal\n \n     - name: Test\n-      run: cargo test --features deny-warnings,internal-lints,metadata-collector-lint\n+      run: cargo test --features deny-warnings,internal\n \n     - name: Test clippy_lints\n-      run: cargo test --features deny-warnings,internal-lints,metadata-collector-lint\n+      run: cargo test --features deny-warnings,internal\n       working-directory: clippy_lints\n \n     - name: Test clippy_utils\n-      run: cargo test --features deny-warnings,internal-lints,metadata-collector-lint\n+      run: cargo test --features deny-warnings,internal\n       working-directory: clippy_utils\n \n     - name: Test rustc_tools_util"}, {"sha": "eb045ec30dc31d574730ab0dcd2d9c9249e94be7", "filename": ".github/workflows/clippy_bors.yml", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/.github%2Fworkflows%2Fclippy_bors.yml", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/.github%2Fworkflows%2Fclippy_bors.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fclippy_bors.yml?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -112,17 +112,17 @@ jobs:\n         echo \"$SYSROOT/bin\" >> $GITHUB_PATH\n \n     - name: Build\n-      run: cargo build --features deny-warnings,internal-lints,metadata-collector-lint\n+      run: cargo build --features deny-warnings,internal\n \n     - name: Test\n-      run: cargo test --features deny-warnings,internal-lints,metadata-collector-lint\n+      run: cargo test --features deny-warnings,internal\n \n     - name: Test clippy_lints\n-      run: cargo test --features deny-warnings,internal-lints,metadata-collector-lint\n+      run: cargo test --features deny-warnings,internal\n       working-directory: clippy_lints\n \n     - name: Test clippy_utils\n-      run: cargo test --features deny-warnings,internal-lints,metadata-collector-lint\n+      run: cargo test --features deny-warnings,internal\n       working-directory: clippy_utils\n \n     - name: Test rustc_tools_util"}, {"sha": "cb49dd84c39a9b67e7f42fc4f9df6eb39f0d84d4", "filename": "Cargo.toml", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/Cargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/Cargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.toml?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -57,8 +57,7 @@ rustc_tools_util = { version = \"0.2\", path = \"rustc_tools_util\" }\n [features]\n deny-warnings = [\"clippy_lints/deny-warnings\"]\n integration = [\"tempfile\"]\n-internal-lints = [\"clippy_lints/internal-lints\"]\n-metadata-collector-lint = [\"internal-lints\", \"clippy_lints/metadata-collector-lint\"]\n+internal = [\"clippy_lints/internal\"]\n \n [package.metadata.rust-analyzer]\n # This package uses #[feature(rustc_private)]"}, {"sha": "d368ef1f46a2a98866e6aedcf32581c9ce17c047", "filename": "clippy_dev/src/update_lints.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_dev%2Fsrc%2Fupdate_lints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_dev%2Fsrc%2Fupdate_lints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Fupdate_lints.rs?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -321,7 +321,7 @@ fn gen_register_lint_list<'a>(\n \n     for (is_public, module_name, lint_name) in details {\n         if !is_public {\n-            output.push_str(\"    #[cfg(feature = \\\"internal-lints\\\")]\\n\");\n+            output.push_str(\"    #[cfg(feature = \\\"internal\\\")]\\n\");\n         }\n         output.push_str(&format!(\"    {}::{},\\n\", module_name, lint_name));\n     }"}, {"sha": "e9f87b60ece4345d94a49464f191368b027ff877", "filename": "clippy_lints/Cargo.toml", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_lints%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_lints%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2FCargo.toml?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -30,8 +30,7 @@ url = { version = \"2.2\", features = [\"serde\"] }\n [features]\n deny-warnings = [\"clippy_utils/deny-warnings\"]\n # build clippy with internal lints enabled, off by default\n-internal-lints = [\"clippy_utils/internal-lints\"]\n-metadata-collector-lint = [\"serde_json\", \"clippy_utils/metadata-collector-lint\"]\n+internal = [\"clippy_utils/internal\", \"serde_json\"]\n \n [package.metadata.rust-analyzer]\n # This crate uses #[feature(rustc_private)]"}, {"sha": "832178c2db5e52d167760ba2198e9ef516dac345", "filename": "clippy_lints/src/lib.register_lints.rs", "status": "modified", "additions": 14, "deletions": 14, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_lints%2Fsrc%2Flib.register_lints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_lints%2Fsrc%2Flib.register_lints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.register_lints.rs?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -3,33 +3,33 @@\n // Manual edits will be overwritten.\n \n store.register_lints(&[\n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     utils::internal_lints::CLIPPY_LINTS_INTERNAL,\n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     utils::internal_lints::COLLAPSIBLE_SPAN_LINT_CALLS,\n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     utils::internal_lints::COMPILER_LINT_FUNCTIONS,\n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     utils::internal_lints::DEFAULT_LINT,\n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     utils::internal_lints::IF_CHAIN_STYLE,\n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     utils::internal_lints::INTERNING_DEFINED_SYMBOL,\n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     utils::internal_lints::INVALID_CLIPPY_VERSION_ATTRIBUTE,\n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     utils::internal_lints::INVALID_PATHS,\n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     utils::internal_lints::LINT_WITHOUT_LINT_PASS,\n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     utils::internal_lints::MATCH_TYPE_ON_DIAGNOSTIC_ITEM,\n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     utils::internal_lints::MISSING_CLIPPY_VERSION_ATTRIBUTE,\n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     utils::internal_lints::OUTER_EXPN_EXPN_DATA,\n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     utils::internal_lints::PRODUCE_ICE,\n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     utils::internal_lints::UNNECESSARY_SYMBOL_STR,\n     absurd_extreme_comparisons::ABSURD_EXTREME_COMPARISONS,\n     approx_const::APPROX_CONSTANT,"}, {"sha": "0d765c2bcde1bf41ade1ae5183c4b2dbd7955ba2", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 5, "deletions": 8, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -153,12 +153,9 @@ macro_rules! declare_clippy_lint {\n     };\n }\n \n-#[cfg(feature = \"metadata-collector-lint\")]\n+#[cfg(feature = \"internal\")]\n mod deprecated_lints;\n-#[cfg_attr(\n-    any(feature = \"internal-lints\", feature = \"metadata-collector-lint\"),\n-    allow(clippy::missing_clippy_version_attribute)\n-)]\n+#[cfg_attr(feature = \"internal\", allow(clippy::missing_clippy_version_attribute))]\n mod utils;\n \n // begin lints modules, do not remove this comment, it\u2019s used in `update_lints`\n@@ -472,7 +469,7 @@ pub fn register_plugins(store: &mut rustc_lint::LintStore, sess: &Session, conf:\n     include!(\"lib.register_restriction.rs\");\n     include!(\"lib.register_pedantic.rs\");\n \n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     include!(\"lib.register_internal.rs\");\n \n     include!(\"lib.register_all.rs\");\n@@ -484,7 +481,7 @@ pub fn register_plugins(store: &mut rustc_lint::LintStore, sess: &Session, conf:\n     include!(\"lib.register_cargo.rs\");\n     include!(\"lib.register_nursery.rs\");\n \n-    #[cfg(feature = \"metadata-collector-lint\")]\n+    #[cfg(feature = \"internal\")]\n     {\n         if std::env::var(\"ENABLE_METADATA_COLLECTION\").eq(&Ok(\"1\".to_string())) {\n             store.register_late_pass(|| Box::new(utils::internal_lints::metadata_collector::MetadataCollector::new()));\n@@ -493,7 +490,7 @@ pub fn register_plugins(store: &mut rustc_lint::LintStore, sess: &Session, conf:\n     }\n \n     // all the internal lints\n-    #[cfg(feature = \"internal-lints\")]\n+    #[cfg(feature = \"internal\")]\n     {\n         store.register_early_pass(|| Box::new(utils::internal_lints::ClippyLintsInternal));\n         store.register_early_pass(|| Box::new(utils::internal_lints::ProduceIce));"}, {"sha": "4e1c538c1c20a166036bd51c85a16d51b2395590", "filename": "clippy_lints/src/utils/conf.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_lints%2Fsrc%2Futils%2Fconf.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_lints%2Fsrc%2Futils%2Fconf.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Fconf.rs?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -113,7 +113,7 @@ macro_rules! define_Conf {\n             }\n         }\n \n-        #[cfg(feature = \"metadata-collector-lint\")]\n+        #[cfg(feature = \"internal\")]\n         pub mod metadata {\n             use crate::utils::internal_lints::metadata_collector::ClippyConfiguration;\n "}, {"sha": "67faca70d5cd6976ccfc9bc19aab4380395410f6", "filename": "clippy_lints/src/utils/internal_lints.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_lints%2Fsrc%2Futils%2Finternal_lints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_lints%2Fsrc%2Futils%2Finternal_lints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Finternal_lints.rs?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -35,7 +35,7 @@ use rustc_typeck::hir_ty_to_ty;\n \n use std::borrow::{Borrow, Cow};\n \n-#[cfg(feature = \"metadata-collector-lint\")]\n+#[cfg(feature = \"internal\")]\n pub mod metadata_collector;\n \n declare_clippy_lint! {"}, {"sha": "02f5d45cc18f4e6978e7530f4c92f23d3f596fd6", "filename": "clippy_lints/src/utils/internal_lints/metadata_collector.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_lints%2Fsrc%2Futils%2Finternal_lints%2Fmetadata_collector.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_lints%2Fsrc%2Futils%2Finternal_lints%2Fmetadata_collector.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Finternal_lints%2Fmetadata_collector.rs?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -1,8 +1,7 @@\n //! This lint is used to collect metadata about clippy lints. This metadata is exported as a json\n //! file and then used to generate the [clippy lint list](https://rust-lang.github.io/rust-clippy/master/index.html)\n //!\n-//! This module and therefor the entire lint is guarded by a feature flag called\n-//! `metadata-collector-lint`\n+//! This module and therefore the entire lint is guarded by a feature flag called `internal`\n //!\n //! The module transforms all lint names to ascii lowercase to ensure that we don't have mismatches\n //! during any comparison or mapping. (Please take care of this, it's not fun to spend time on such"}, {"sha": "dc385ebacba664db68ea0ed564508f9ef7a312cb", "filename": "clippy_lints/src/utils/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_lints%2Fsrc%2Futils%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_lints%2Fsrc%2Futils%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Fmod.rs?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -1,5 +1,5 @@\n pub mod author;\n pub mod conf;\n pub mod inspector;\n-#[cfg(any(feature = \"internal-lints\", feature = \"metadata-collector-lint\"))]\n+#[cfg(feature = \"internal\")]\n pub mod internal_lints;"}, {"sha": "565dd1faa3d7fe2d398a402e42c8ca8b51461645", "filename": "clippy_utils/Cargo.toml", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_utils%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_utils%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_utils%2FCargo.toml?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -11,8 +11,7 @@ rustc-semver = \"1.1\"\n \n [features]\n deny-warnings = []\n-internal-lints = []\n-metadata-collector-lint = []\n+internal = []\n \n [package.metadata.rust-analyzer]\n # This crate uses #[feature(rustc_private)]"}, {"sha": "ca222c3d669956d4b97eb5e4bd9f46ead9aa0d1d", "filename": "clippy_utils/src/diagnostics.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_utils%2Fsrc%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_utils%2Fsrc%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_utils%2Fsrc%2Fdiagnostics.rs?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -198,7 +198,7 @@ pub fn span_lint_hir_and_then(\n ///     |\n ///     = note: `-D fold-any` implied by `-D warnings`\n /// ```\n-#[cfg_attr(feature = \"internal-lints\", allow(clippy::collapsible_span_lint_calls))]\n+#[cfg_attr(feature = \"internal\", allow(clippy::collapsible_span_lint_calls))]\n pub fn span_lint_and_sugg<'a, T: LintContext>(\n     cx: &'a T,\n     lint: &'static Lint,"}, {"sha": "c06a1f826fa2a10a73f72acd291ebf7fb2b4de72", "filename": "clippy_utils/src/paths.rs", "status": "modified", "additions": 15, "deletions": 15, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_utils%2Fsrc%2Fpaths.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/clippy_utils%2Fsrc%2Fpaths.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_utils%2Fsrc%2Fpaths.rs?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -5,16 +5,16 @@\n //! See <https://github.com/rust-lang/rust-clippy/issues/5393> for more information.\n \n pub const ANY_TRAIT: [&str; 3] = [\"core\", \"any\", \"Any\"];\n-#[cfg(feature = \"metadata-collector-lint\")]\n+#[cfg(feature = \"internal\")]\n pub const APPLICABILITY: [&str; 2] = [\"rustc_lint_defs\", \"Applicability\"];\n-#[cfg(feature = \"metadata-collector-lint\")]\n+#[cfg(feature = \"internal\")]\n pub const APPLICABILITY_VALUES: [[&str; 3]; 4] = [\n     [\"rustc_lint_defs\", \"Applicability\", \"Unspecified\"],\n     [\"rustc_lint_defs\", \"Applicability\", \"HasPlaceholders\"],\n     [\"rustc_lint_defs\", \"Applicability\", \"MaybeIncorrect\"],\n     [\"rustc_lint_defs\", \"Applicability\", \"MachineApplicable\"],\n ];\n-#[cfg(feature = \"metadata-collector-lint\")]\n+#[cfg(feature = \"internal\")]\n pub const DIAGNOSTIC_BUILDER: [&str; 3] = [\"rustc_errors\", \"diagnostic_builder\", \"DiagnosticBuilder\"];\n pub const ARC_PTR_EQ: [&str; 4] = [\"alloc\", \"sync\", \"Arc\", \"ptr_eq\"];\n #[allow(clippy::invalid_paths)] // `check_path` does not seem to work for macros\n@@ -45,7 +45,7 @@ pub const DISPLAY_TRAIT: [&str; 3] = [\"core\", \"fmt\", \"Display\"];\n pub const DOUBLE_ENDED_ITERATOR: [&str; 4] = [\"core\", \"iter\", \"traits\", \"DoubleEndedIterator\"];\n pub const DROP: [&str; 3] = [\"core\", \"mem\", \"drop\"];\n pub const DURATION: [&str; 3] = [\"core\", \"time\", \"Duration\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const EARLY_CONTEXT: [&str; 2] = [\"rustc_lint\", \"EarlyContext\"];\n #[allow(clippy::invalid_paths)] // `check_path` does not seem to work for macros\n pub const EPRINT_MACRO: [&str; 3] = [\"std\", \"macros\", \"eprint\"];\n@@ -71,9 +71,9 @@ pub const HASH: [&str; 3] = [\"core\", \"hash\", \"Hash\"];\n pub const HASHMAP_CONTAINS_KEY: [&str; 6] = [\"std\", \"collections\", \"hash\", \"map\", \"HashMap\", \"contains_key\"];\n pub const HASHMAP_ENTRY: [&str; 5] = [\"std\", \"collections\", \"hash\", \"map\", \"Entry\"];\n pub const HASHMAP_INSERT: [&str; 6] = [\"std\", \"collections\", \"hash\", \"map\", \"HashMap\", \"insert\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const IDENT: [&str; 3] = [\"rustc_span\", \"symbol\", \"Ident\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const IDENT_AS_STR: [&str; 4] = [\"rustc_span\", \"symbol\", \"Ident\", \"as_str\"];\n pub const INDEX: [&str; 3] = [\"core\", \"ops\", \"Index\"];\n pub const INDEX_MUT: [&str; 3] = [\"core\", \"ops\", \"IndexMut\"];\n@@ -85,11 +85,11 @@ pub const IPADDR_V6: [&str; 5] = [\"std\", \"net\", \"ip\", \"IpAddr\", \"V6\"];\n pub const ITER_REPEAT: [&str; 5] = [\"core\", \"iter\", \"sources\", \"repeat\", \"repeat\"];\n #[allow(clippy::invalid_paths)] // internal lints do not know about all external crates\n pub const ITERTOOLS_NEXT_TUPLE: [&str; 3] = [\"itertools\", \"Itertools\", \"next_tuple\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const KW_MODULE: [&str; 3] = [\"rustc_span\", \"symbol\", \"kw\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const LATE_CONTEXT: [&str; 2] = [\"rustc_lint\", \"LateContext\"];\n-#[cfg(any(feature = \"internal-lints\", feature = \"metadata-collector-lint\"))]\n+#[cfg(feature = \"internal\")]\n pub const LINT: [&str; 2] = [\"rustc_lint_defs\", \"Lint\"];\n pub const MEM_DISCRIMINANT: [&str; 3] = [\"core\", \"mem\", \"discriminant\"];\n pub const MEM_FORGET: [&str; 3] = [\"core\", \"mem\", \"forget\"];\n@@ -179,17 +179,17 @@ pub const STR_ENDS_WITH: [&str; 4] = [\"core\", \"str\", \"<impl str>\", \"ends_with\"];\n pub const STR_FROM_UTF8: [&str; 4] = [\"core\", \"str\", \"converts\", \"from_utf8\"];\n pub const STR_LEN: [&str; 4] = [\"core\", \"str\", \"<impl str>\", \"len\"];\n pub const STR_STARTS_WITH: [&str; 4] = [\"core\", \"str\", \"<impl str>\", \"starts_with\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const SYMBOL: [&str; 3] = [\"rustc_span\", \"symbol\", \"Symbol\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const SYMBOL_AS_STR: [&str; 4] = [\"rustc_span\", \"symbol\", \"Symbol\", \"as_str\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const SYMBOL_INTERN: [&str; 4] = [\"rustc_span\", \"symbol\", \"Symbol\", \"intern\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const SYMBOL_TO_IDENT_STRING: [&str; 4] = [\"rustc_span\", \"symbol\", \"Symbol\", \"to_ident_string\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const SYM_MODULE: [&str; 3] = [\"rustc_span\", \"symbol\", \"sym\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const SYNTAX_CONTEXT: [&str; 3] = [\"rustc_span\", \"hygiene\", \"SyntaxContext\"];\n pub const TO_OWNED_METHOD: [&str; 4] = [\"alloc\", \"borrow\", \"ToOwned\", \"to_owned\"];\n pub const TO_STRING_METHOD: [&str; 4] = [\"alloc\", \"string\", \"ToString\", \"to_string\"];"}, {"sha": "762b67fc5854d2ca3764739fa9ffbc738de30f29", "filename": "tests/compile-test.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/tests%2Fcompile-test.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/tests%2Fcompile-test.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-test.rs?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -15,7 +15,7 @@ use std::path::{Path, PathBuf};\n mod cargo;\n \n // whether to run internal tests or not\n-const RUN_INTERNAL_TESTS: bool = cfg!(feature = \"internal-lints\");\n+const RUN_INTERNAL_TESTS: bool = cfg!(feature = \"internal\");\n \n /// All crates used in UI tests are listed here\n static TEST_DEPENDENCIES: &[&str] = &["}, {"sha": "6f7de9c67a9b7806b4dd6444a7760d550b6823cb", "filename": "tests/dogfood.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/18163617388c32edce09ff3d31adc86e0141cc7d/tests%2Fdogfood.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18163617388c32edce09ff3d31adc86e0141cc7d/tests%2Fdogfood.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdogfood.rs?ref=18163617388c32edce09ff3d31adc86e0141cc7d", "patch": "@@ -42,8 +42,8 @@ fn dogfood_clippy() {\n         .args(&[\"-D\", \"clippy::pedantic\"])\n         .arg(\"-Cdebuginfo=0\"); // disable debuginfo to generate less data in the target dir\n \n-    // internal lints only exist if we build with the internal-lints feature\n-    if cfg!(feature = \"internal-lints\") {\n+    // internal lints only exist if we build with the internal feature\n+    if cfg!(feature = \"internal\") {\n         command.args(&[\"-D\", \"clippy::internal\"]);\n     }\n \n@@ -180,7 +180,7 @@ fn dogfood_subprojects() {\n \n #[test]\n #[ignore]\n-#[cfg(feature = \"metadata-collector-lint\")]\n+#[cfg(feature = \"internal\")]\n fn run_metadata_collection_lint() {\n     use std::fs::File;\n     use std::time::SystemTime;\n@@ -233,8 +233,8 @@ fn run_clippy_for_project(project: &str) {\n         .args(&[\"-D\", \"clippy::pedantic\"])\n         .arg(\"-Cdebuginfo=0\"); // disable debuginfo to generate less data in the target dir\n \n-    // internal lints only exist if we build with the internal-lints feature\n-    if cfg!(feature = \"internal-lints\") {\n+    // internal lints only exist if we build with the internal feature\n+    if cfg!(feature = \"internal\") {\n         command.args(&[\"-D\", \"clippy::internal\"]);\n     }\n "}]}