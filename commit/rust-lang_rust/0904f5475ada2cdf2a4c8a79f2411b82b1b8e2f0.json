{"sha": "0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA5MDRmNTQ3NWFkYTJjZGYyYTRjOGE3OWYyNDExYjgyYjFiOGUyZjA=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-12-19T13:58:22Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-12-19T13:58:22Z"}, "message": "Auto merge of #6473 - phansch:split-up-ui-test, r=flip1995\n\nUI Tests: Separate suspicious_else_formatting tests\n\nWas briefly looking into https://github.com/rust-lang/rust-clippy/issues/3864 when I saw that the tests could benefit from being in their own file.\n\n---\nchangelog: none", "tree": {"sha": "1e838d7655a7eec3c0c2a873f41841bf66e6313f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1e838d7655a7eec3c0c2a873f41841bf66e6313f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0", "html_url": "https://github.com/rust-lang/rust/commit/0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "73feb31bc3d6b71e97d8ba63f3c52f975c2c93e8", "url": "https://api.github.com/repos/rust-lang/rust/commits/73feb31bc3d6b71e97d8ba63f3c52f975c2c93e8", "html_url": "https://github.com/rust-lang/rust/commit/73feb31bc3d6b71e97d8ba63f3c52f975c2c93e8"}, {"sha": "8ddf4ce87a1a0a50d015e40bf9cebede68f64d0a", "url": "https://api.github.com/repos/rust-lang/rust/commits/8ddf4ce87a1a0a50d015e40bf9cebede68f64d0a", "html_url": "https://github.com/rust-lang/rust/commit/8ddf4ce87a1a0a50d015e40bf9cebede68f64d0a"}], "stats": {"total": 332, "additions": 164, "deletions": 168}, "files": [{"sha": "0d14807ff1cfcf1f2745b521f0c101c7ca85eddb", "filename": "tests/ui/formatting.rs", "status": "modified", "additions": 1, "deletions": 86, "changes": 87, "blob_url": "https://github.com/rust-lang/rust/blob/0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0/tests%2Fui%2Fformatting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0/tests%2Fui%2Fformatting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fformatting.rs?ref=0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0", "patch": "@@ -10,91 +10,6 @@ fn foo() -> bool {\n \n #[rustfmt::skip]\n fn main() {\n-    // weird `else` formatting:\n-    if foo() {\n-    } {\n-    }\n-\n-    if foo() {\n-    } if foo() {\n-    }\n-\n-    let _ = { // if as the last expression\n-        let _ = 0;\n-\n-        if foo() {\n-        } if foo() {\n-        }\n-        else {\n-        }\n-    };\n-\n-    let _ = { // if in the middle of a block\n-        if foo() {\n-        } if foo() {\n-        }\n-        else {\n-        }\n-\n-        let _ = 0;\n-    };\n-\n-    if foo() {\n-    } else\n-    {\n-    }\n-\n-    if foo() {\n-    }\n-    else\n-    {\n-    }\n-\n-    if foo() {\n-    } else\n-    if foo() { // the span of the above error should continue here\n-    }\n-\n-    if foo() {\n-    }\n-    else\n-    if foo() { // the span of the above error should continue here\n-    }\n-\n-    // those are ok:\n-    if foo() {\n-    }\n-    {\n-    }\n-\n-    if foo() {\n-    } else {\n-    }\n-\n-    if foo() {\n-    }\n-    else {\n-    }\n-\n-    if foo() {\n-    }\n-    if foo() {\n-    }\n-\n-    if foo() {\n-    } else if foo() {\n-    }\n-\n-    if foo() {\n-    }\n-    else if foo() {\n-    }\n-\n-    if foo() {\n-    }\n-    else if\n-    foo() {}\n-\n     // weird op_eq formatting:\n     let mut a = 42;\n     a =- 35;\n@@ -146,7 +61,7 @@ fn main() {\n \n     // don't lint if the indentation suggests not to\n     let _ = &[\n-        1 + 2, 3 \n+        1 + 2, 3\n                 - 4, 5\n     ];\n     // lint if it doesn't"}, {"sha": "bde434c7e2e78737ae451a9c8dd776712aba5090", "filename": "tests/ui/formatting.stderr", "status": "modified", "additions": 7, "deletions": 82, "changes": 89, "blob_url": "https://github.com/rust-lang/rust/blob/0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0/tests%2Fui%2Fformatting.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0/tests%2Fui%2Fformatting.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fformatting.stderr?ref=0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0", "patch": "@@ -1,80 +1,5 @@\n-error: this looks like an `else {..}` but the `else` is missing\n-  --> $DIR/formatting.rs:15:6\n-   |\n-LL |     } {\n-   |      ^\n-   |\n-   = note: `-D clippy::suspicious-else-formatting` implied by `-D warnings`\n-   = note: to remove this lint, add the missing `else` or add a new line before the next block\n-\n-error: this looks like an `else if` but the `else` is missing\n-  --> $DIR/formatting.rs:19:6\n-   |\n-LL |     } if foo() {\n-   |      ^\n-   |\n-   = note: to remove this lint, add the missing `else` or add a new line before the second `if`\n-\n-error: this looks like an `else if` but the `else` is missing\n-  --> $DIR/formatting.rs:26:10\n-   |\n-LL |         } if foo() {\n-   |          ^\n-   |\n-   = note: to remove this lint, add the missing `else` or add a new line before the second `if`\n-\n-error: this looks like an `else if` but the `else` is missing\n-  --> $DIR/formatting.rs:34:10\n-   |\n-LL |         } if foo() {\n-   |          ^\n-   |\n-   = note: to remove this lint, add the missing `else` or add a new line before the second `if`\n-\n-error: this is an `else {..}` but the formatting might hide it\n-  --> $DIR/formatting.rs:43:6\n-   |\n-LL |       } else\n-   |  ______^\n-LL | |     {\n-   | |____^\n-   |\n-   = note: to remove this lint, remove the `else` or remove the new line between `else` and `{..}`\n-\n-error: this is an `else {..}` but the formatting might hide it\n-  --> $DIR/formatting.rs:48:6\n-   |\n-LL |       }\n-   |  ______^\n-LL | |     else\n-LL | |     {\n-   | |____^\n-   |\n-   = note: to remove this lint, remove the `else` or remove the new line between `else` and `{..}`\n-\n-error: this is an `else if` but the formatting might hide it\n-  --> $DIR/formatting.rs:54:6\n-   |\n-LL |       } else\n-   |  ______^\n-LL | |     if foo() { // the span of the above error should continue here\n-   | |____^\n-   |\n-   = note: to remove this lint, remove the `else` or remove the new line between `else` and `if`\n-\n-error: this is an `else if` but the formatting might hide it\n-  --> $DIR/formatting.rs:59:6\n-   |\n-LL |       }\n-   |  ______^\n-LL | |     else\n-LL | |     if foo() { // the span of the above error should continue here\n-   | |____^\n-   |\n-   = note: to remove this lint, remove the `else` or remove the new line between `else` and `if`\n-\n error: this looks like you are trying to use `.. -= ..`, but you really are doing `.. = (- ..)`\n-  --> $DIR/formatting.rs:100:6\n+  --> $DIR/formatting.rs:15:6\n    |\n LL |     a =- 35;\n    |      ^^^^\n@@ -83,23 +8,23 @@ LL |     a =- 35;\n    = note: to remove this lint, use either `-=` or `= -`\n \n error: this looks like you are trying to use `.. *= ..`, but you really are doing `.. = (* ..)`\n-  --> $DIR/formatting.rs:101:6\n+  --> $DIR/formatting.rs:16:6\n    |\n LL |     a =* &191;\n    |      ^^^^\n    |\n    = note: to remove this lint, use either `*=` or `= *`\n \n error: this looks like you are trying to use `.. != ..`, but you really are doing `.. = (! ..)`\n-  --> $DIR/formatting.rs:104:6\n+  --> $DIR/formatting.rs:19:6\n    |\n LL |     b =! false;\n    |      ^^^^\n    |\n    = note: to remove this lint, use either `!=` or `= !`\n \n error: possibly missing a comma here\n-  --> $DIR/formatting.rs:113:19\n+  --> $DIR/formatting.rs:28:19\n    |\n LL |         -1, -2, -3 // <= no comma here\n    |                   ^\n@@ -108,20 +33,20 @@ LL |         -1, -2, -3 // <= no comma here\n    = note: to remove this lint, add a comma or write the expr in a single line\n \n error: possibly missing a comma here\n-  --> $DIR/formatting.rs:117:19\n+  --> $DIR/formatting.rs:32:19\n    |\n LL |         -1, -2, -3 // <= no comma here\n    |                   ^\n    |\n    = note: to remove this lint, add a comma or write the expr in a single line\n \n error: possibly missing a comma here\n-  --> $DIR/formatting.rs:154:11\n+  --> $DIR/formatting.rs:69:11\n    |\n LL |         -1\n    |           ^\n    |\n    = note: to remove this lint, add a comma or write the expr in a single line\n \n-error: aborting due to 14 previous errors\n+error: aborting due to 6 previous errors\n "}, {"sha": "226010ec6df3a24c63898f53a81c227b8a3781af", "filename": "tests/ui/suspicious_else_formatting.rs", "status": "added", "additions": 79, "deletions": 0, "changes": 79, "blob_url": "https://github.com/rust-lang/rust/blob/0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0/tests%2Fui%2Fsuspicious_else_formatting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0/tests%2Fui%2Fsuspicious_else_formatting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuspicious_else_formatting.rs?ref=0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0", "patch": "@@ -0,0 +1,79 @@\n+#![warn(clippy::suspicious_else_formatting)]\n+\n+fn foo() -> bool {\n+    true\n+}\n+\n+#[rustfmt::skip]\n+fn main() {\n+    // weird `else` formatting:\n+    if foo() {\n+    } {\n+    }\n+\n+    if foo() {\n+    } if foo() {\n+    }\n+\n+    let _ = { // if as the last expression\n+        let _ = 0;\n+\n+        if foo() {\n+        } if foo() {\n+        }\n+        else {\n+        }\n+    };\n+\n+    let _ = { // if in the middle of a block\n+        if foo() {\n+        } if foo() {\n+        }\n+        else {\n+        }\n+\n+        let _ = 0;\n+    };\n+\n+    if foo() {\n+    } else\n+    {\n+    }\n+\n+    if foo() {\n+    }\n+    else\n+    {\n+    }\n+\n+    if foo() {\n+    } else\n+    if foo() { // the span of the above error should continue here\n+    }\n+\n+    if foo() {\n+    }\n+    else\n+    if foo() { // the span of the above error should continue here\n+    }\n+\n+    // those are ok:\n+    if foo() {\n+    }\n+    {\n+    }\n+\n+    if foo() {\n+    } else {\n+    }\n+\n+    if foo() {\n+    }\n+    else {\n+    }\n+\n+    if foo() {\n+    }\n+    if foo() {\n+    }\n+}"}, {"sha": "bbc036d376fefc9ead1a8cb034eceb23f3a728c5", "filename": "tests/ui/suspicious_else_formatting.stderr", "status": "added", "additions": 77, "deletions": 0, "changes": 77, "blob_url": "https://github.com/rust-lang/rust/blob/0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0/tests%2Fui%2Fsuspicious_else_formatting.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0/tests%2Fui%2Fsuspicious_else_formatting.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuspicious_else_formatting.stderr?ref=0904f5475ada2cdf2a4c8a79f2411b82b1b8e2f0", "patch": "@@ -0,0 +1,77 @@\n+error: this looks like an `else {..}` but the `else` is missing\n+  --> $DIR/suspicious_else_formatting.rs:11:6\n+   |\n+LL |     } {\n+   |      ^\n+   |\n+   = note: `-D clippy::suspicious-else-formatting` implied by `-D warnings`\n+   = note: to remove this lint, add the missing `else` or add a new line before the next block\n+\n+error: this looks like an `else if` but the `else` is missing\n+  --> $DIR/suspicious_else_formatting.rs:15:6\n+   |\n+LL |     } if foo() {\n+   |      ^\n+   |\n+   = note: to remove this lint, add the missing `else` or add a new line before the second `if`\n+\n+error: this looks like an `else if` but the `else` is missing\n+  --> $DIR/suspicious_else_formatting.rs:22:10\n+   |\n+LL |         } if foo() {\n+   |          ^\n+   |\n+   = note: to remove this lint, add the missing `else` or add a new line before the second `if`\n+\n+error: this looks like an `else if` but the `else` is missing\n+  --> $DIR/suspicious_else_formatting.rs:30:10\n+   |\n+LL |         } if foo() {\n+   |          ^\n+   |\n+   = note: to remove this lint, add the missing `else` or add a new line before the second `if`\n+\n+error: this is an `else {..}` but the formatting might hide it\n+  --> $DIR/suspicious_else_formatting.rs:39:6\n+   |\n+LL |       } else\n+   |  ______^\n+LL | |     {\n+   | |____^\n+   |\n+   = note: to remove this lint, remove the `else` or remove the new line between `else` and `{..}`\n+\n+error: this is an `else {..}` but the formatting might hide it\n+  --> $DIR/suspicious_else_formatting.rs:44:6\n+   |\n+LL |       }\n+   |  ______^\n+LL | |     else\n+LL | |     {\n+   | |____^\n+   |\n+   = note: to remove this lint, remove the `else` or remove the new line between `else` and `{..}`\n+\n+error: this is an `else if` but the formatting might hide it\n+  --> $DIR/suspicious_else_formatting.rs:50:6\n+   |\n+LL |       } else\n+   |  ______^\n+LL | |     if foo() { // the span of the above error should continue here\n+   | |____^\n+   |\n+   = note: to remove this lint, remove the `else` or remove the new line between `else` and `if`\n+\n+error: this is an `else if` but the formatting might hide it\n+  --> $DIR/suspicious_else_formatting.rs:55:6\n+   |\n+LL |       }\n+   |  ______^\n+LL | |     else\n+LL | |     if foo() { // the span of the above error should continue here\n+   | |____^\n+   |\n+   = note: to remove this lint, remove the `else` or remove the new line between `else` and `if`\n+\n+error: aborting due to 8 previous errors\n+"}]}