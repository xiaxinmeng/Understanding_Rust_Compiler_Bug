{"sha": "29a2a1ecd1fe33260a9390dd05899daf6a2ba69b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI5YTJhMWVjZDFmZTMzMjYwYTkzOTBkZDA1ODk5ZGFmNmEyYmE2OWI=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-05-05T05:09:36Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-05-05T05:09:36Z"}, "message": "auto merge of #6234 : yichoi/rust/glob-dummy-pull, r=thestinger\n\ntransitional patch to resolve compile/link failure on android\r\n\r\nafter #6161 landed, I've encountered below errors since android does not support glob in libc.\r\n\r\n/opt/ndk_standalone/bin/../lib/gcc/arm-linux-androideabi/4.6/../../../../arm-linux-androideabi/bin/ld: /home/yichoi/rust_work/build/x86_64-unknown-linux-gnu/stage1/lib/rustc/arm-linux-androideabi/lib/libcore-c3ca5d77d81b46c1-0.7-pre.so: error: undefined reference to 'glob'\r\n\r\n/opt/ndk_standalone/bin/../lib/gcc/arm-linux-androideabi/4.6/../../../../arm-linux-androideabi/bin/ld: /home/yichoi/rust_work/build/x86_64-unknown-linux-gnu/stage1/lib/rustc/arm-linux-androideabi/lib/libcore-c3ca5d77d81b46c1-0.7-pre.so: error: undefined reference to 'globfre\r\n\r\nSince android does not have `glob.h`, `glob_t` definition comes from\r\nhttps://groups.google.com/forum/?fromgroups=#!topic/android-ndk/vSH6MWPD0Vk\r\n\r\n#6100 should be resolved.", "tree": {"sha": "8a3f7b80262b646f12cbba5b58a156e51f5b0992", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8a3f7b80262b646f12cbba5b58a156e51f5b0992"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/29a2a1ecd1fe33260a9390dd05899daf6a2ba69b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/29a2a1ecd1fe33260a9390dd05899daf6a2ba69b", "html_url": "https://github.com/rust-lang/rust/commit/29a2a1ecd1fe33260a9390dd05899daf6a2ba69b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/29a2a1ecd1fe33260a9390dd05899daf6a2ba69b/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d74ac9ea03eb8faab72ce48b89dd47a14f45982a", "url": "https://api.github.com/repos/rust-lang/rust/commits/d74ac9ea03eb8faab72ce48b89dd47a14f45982a", "html_url": "https://github.com/rust-lang/rust/commit/d74ac9ea03eb8faab72ce48b89dd47a14f45982a"}, {"sha": "987ad9c8782ba254c8326c9caac9796bcce9beb9", "url": "https://api.github.com/repos/rust-lang/rust/commits/987ad9c8782ba254c8326c9caac9796bcce9beb9", "html_url": "https://github.com/rust-lang/rust/commit/987ad9c8782ba254c8326c9caac9796bcce9beb9"}], "stats": {"total": 41, "additions": 39, "deletions": 2}, "files": [{"sha": "b6fe78288e97aae07f651bb0fcfa3cf186cab3c0", "filename": "src/rt/rust_android_dummy.cpp", "status": "modified", "additions": 16, "deletions": 2, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/29a2a1ecd1fe33260a9390dd05899daf6a2ba69b/src%2Frt%2Frust_android_dummy.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/29a2a1ecd1fe33260a9390dd05899daf6a2ba69b/src%2Frt%2Frust_android_dummy.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_android_dummy.cpp?ref=29a2a1ecd1fe33260a9390dd05899daf6a2ba69b", "patch": "@@ -2,12 +2,12 @@\n // Use of this source code is governed by a BSD-style license that can be\n // found in the LICENSE file.\n \n+#ifdef __ANDROID__\n+\n #include \"rust_android_dummy.h\"\n #include <math.h>\n #include <errno.h>\n \n-#ifdef __ANDROID__\n-\n int backtrace(void **array, int size) { return 0; }\n \n char **backtrace_symbols(void *const *array, int size) { return 0; }\n@@ -59,7 +59,21 @@ extern \"C\" void srand()\n extern \"C\" void atof()\n {\n }\n+\n extern \"C\" void tgammaf()\n {\n }\n+\n+extern \"C\" int glob(const char *pattern,\n+                    int flags,\n+                    int (*errfunc) (const char *epath, int eerrno),\n+                    glob_t *pglob)\n+{\n+    return 0;\n+}\n+\n+extern \"C\" void globfree(glob_t *pglob)\n+{\n+}\n+\n #endif"}, {"sha": "d2329a46c831a908c343c40aeedddbdb7be8a478", "filename": "src/rt/rust_android_dummy.h", "status": "modified", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/29a2a1ecd1fe33260a9390dd05899daf6a2ba69b/src%2Frt%2Frust_android_dummy.h", "raw_url": "https://github.com/rust-lang/rust/raw/29a2a1ecd1fe33260a9390dd05899daf6a2ba69b/src%2Frt%2Frust_android_dummy.h", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_android_dummy.h?ref=29a2a1ecd1fe33260a9390dd05899daf6a2ba69b", "patch": "@@ -11,4 +11,27 @@ char **backtrace_symbols (void *__const *__array, int __size);\n \n void backtrace_symbols_fd (void *__const *__array, int __size, int __fd);\n \n+#include <sys/types.h>\n+\n+struct stat;\n+typedef struct {\n+    size_t gl_pathc;    /* Count of total paths so far. */\n+    size_t gl_matchc;   /* Count of paths matching pattern. */\n+    size_t gl_offs;     /* Reserved at beginning of gl_pathv. */\n+    int gl_flags;       /* Copy of flags parameter to glob. */\n+    char **gl_pathv;    /* List of paths matching pattern. */\n+                /* Copy of errfunc parameter to glob. */\n+    int (*gl_errfunc)(const char *, int);\n+\n+    /*\n+     * Alternate filesystem access methods for glob; replacement\n+     * versions of closedir(3), readdir(3), opendir(3), stat(2)\n+     * and lstat(2).\n+     */\n+    void (*gl_closedir)(void *);\n+    struct dirent *(*gl_readdir)(void *);\n+    void *(*gl_opendir)(const char *);\n+    int (*gl_lstat)(const char *, struct stat *);\n+} glob_t;\n+\n #endif"}]}