{"sha": "54561148581f002793ab42893de4e3f7c26bd7ed", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU0NTYxMTQ4NTgxZjAwMjc5M2FiNDI4OTNkZTRlM2Y3YzI2YmQ3ZWQ=", "commit": {"author": {"name": "Matthew Kuo", "email": "matthew.kuo@dialexa.com", "date": "2020-03-04T07:09:53Z"}, "committer": {"name": "Matthew Kuo", "email": "matthew.kuo@dialexa.com", "date": "2020-03-04T07:17:41Z"}, "message": "test(pattern): add tests for combinations of pattern features\n\nReference issue #67311\n\nTests combinations of the following pattern features:\n- bindings_after_at\n- or_patterns\n- slice_patterns\n- box_patterns", "tree": {"sha": "f5200a8a091cf5b81361a4c8d0ead01ae137b8e4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f5200a8a091cf5b81361a4c8d0ead01ae137b8e4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/54561148581f002793ab42893de4e3f7c26bd7ed", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/54561148581f002793ab42893de4e3f7c26bd7ed", "html_url": "https://github.com/rust-lang/rust/commit/54561148581f002793ab42893de4e3f7c26bd7ed", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/54561148581f002793ab42893de4e3f7c26bd7ed/comments", "author": {"login": "thekuom", "id": 15683724, "node_id": "MDQ6VXNlcjE1NjgzNzI0", "avatar_url": "https://avatars.githubusercontent.com/u/15683724?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thekuom", "html_url": "https://github.com/thekuom", "followers_url": "https://api.github.com/users/thekuom/followers", "following_url": "https://api.github.com/users/thekuom/following{/other_user}", "gists_url": "https://api.github.com/users/thekuom/gists{/gist_id}", "starred_url": "https://api.github.com/users/thekuom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thekuom/subscriptions", "organizations_url": "https://api.github.com/users/thekuom/orgs", "repos_url": "https://api.github.com/users/thekuom/repos", "events_url": "https://api.github.com/users/thekuom/events{/privacy}", "received_events_url": "https://api.github.com/users/thekuom/received_events", "type": "User", "site_admin": false}, "committer": {"login": "thekuom", "id": 15683724, "node_id": "MDQ6VXNlcjE1NjgzNzI0", "avatar_url": "https://avatars.githubusercontent.com/u/15683724?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thekuom", "html_url": "https://github.com/thekuom", "followers_url": "https://api.github.com/users/thekuom/followers", "following_url": "https://api.github.com/users/thekuom/following{/other_user}", "gists_url": "https://api.github.com/users/thekuom/gists{/gist_id}", "starred_url": "https://api.github.com/users/thekuom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thekuom/subscriptions", "organizations_url": "https://api.github.com/users/thekuom/orgs", "repos_url": "https://api.github.com/users/thekuom/repos", "events_url": "https://api.github.com/users/thekuom/events{/privacy}", "received_events_url": "https://api.github.com/users/thekuom/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "592e9c37008c2389451d28874a748f5b38612ca5", "url": "https://api.github.com/repos/rust-lang/rust/commits/592e9c37008c2389451d28874a748f5b38612ca5", "html_url": "https://github.com/rust-lang/rust/commit/592e9c37008c2389451d28874a748f5b38612ca5"}], "stats": {"total": 283, "additions": 283, "deletions": 0}, "files": [{"sha": "aafd47993836ca4fb3d8a8d931855d5724cf8682", "filename": "src/test/ui/or-patterns/box-patterns.rs", "status": "added", "additions": 37, "deletions": 0, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/54561148581f002793ab42893de4e3f7c26bd7ed/src%2Ftest%2Fui%2For-patterns%2Fbox-patterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54561148581f002793ab42893de4e3f7c26bd7ed/src%2Ftest%2Fui%2For-patterns%2Fbox-patterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2For-patterns%2Fbox-patterns.rs?ref=54561148581f002793ab42893de4e3f7c26bd7ed", "patch": "@@ -0,0 +1,37 @@\n+// Test or-patterns with box-patterns\n+\n+// run-pass\n+\n+#![feature(or_patterns)]\n+#![feature(box_patterns)]\n+\n+#[derive(Debug, PartialEq)]\n+enum MatchArm {\n+    Arm(usize),\n+    Wild,\n+}\n+\n+#[derive(Debug)]\n+enum Test {\n+    Foo,\n+    Bar,\n+    Baz,\n+    Qux,\n+}\n+\n+fn test(x: Option<Box<Test>>) -> MatchArm {\n+    match x {\n+        Some(box Test::Foo | box Test::Bar) => MatchArm::Arm(0),\n+        Some(box Test::Baz) => MatchArm::Arm(1),\n+        Some(_) => MatchArm::Arm(2),\n+        _ => MatchArm::Wild,\n+    }\n+}\n+\n+fn main() {\n+    assert_eq!(test(Some(Box::new(Test::Foo))), MatchArm::Arm(0));\n+    assert_eq!(test(Some(Box::new(Test::Bar))), MatchArm::Arm(0));\n+    assert_eq!(test(Some(Box::new(Test::Baz))), MatchArm::Arm(1));\n+    assert_eq!(test(Some(Box::new(Test::Qux))), MatchArm::Arm(2));\n+    assert_eq!(test(None), MatchArm::Wild);\n+}"}, {"sha": "2f2e865d985288142362ba9df62f8fe142eddf59", "filename": "src/test/ui/or-patterns/slice-patterns.rs", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/rust-lang/rust/blob/54561148581f002793ab42893de4e3f7c26bd7ed/src%2Ftest%2Fui%2For-patterns%2Fslice-patterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54561148581f002793ab42893de4e3f7c26bd7ed/src%2Ftest%2Fui%2For-patterns%2Fslice-patterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2For-patterns%2Fslice-patterns.rs?ref=54561148581f002793ab42893de4e3f7c26bd7ed", "patch": "@@ -0,0 +1,42 @@\n+// Test or-patterns with slice-patterns\n+\n+// run-pass\n+\n+#![feature(or_patterns)]\n+\n+#[derive(Debug, PartialEq)]\n+enum MatchArm {\n+    Arm(usize),\n+    Wild,\n+}\n+\n+#[derive(Debug)]\n+enum Test {\n+    Foo,\n+    Bar,\n+    Baz,\n+    Qux,\n+}\n+\n+fn test(foo: &[Option<Test>]) -> MatchArm {\n+    match foo {\n+        [.., Some(Test::Foo | Test::Qux)] => MatchArm::Arm(0),\n+        [Some(Test::Foo), .., Some(Test::Bar | Test::Baz)] => MatchArm::Arm(1),\n+        [.., Some(Test::Bar | Test::Baz), _] => MatchArm::Arm(2),\n+        _ => MatchArm::Wild,\n+    }\n+}\n+\n+fn main() {\n+    let foo = vec![\n+        Some(Test::Foo),\n+        Some(Test::Bar),\n+        Some(Test::Baz),\n+        Some(Test::Qux),\n+    ];\n+\n+    assert_eq!(test(&foo), MatchArm::Arm(0));\n+    assert_eq!(test(&foo[..3]), MatchArm::Arm(1));\n+    assert_eq!(test(&foo[1..3]), MatchArm::Arm(2));\n+    assert_eq!(test(&foo[4..]), MatchArm::Wild);\n+}"}, {"sha": "ef9669a6b9e5ae9fca05f23ff0dea1f983269711", "filename": "src/test/ui/pattern/bindings-after-at/box-patterns.rs", "status": "added", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/54561148581f002793ab42893de4e3f7c26bd7ed/src%2Ftest%2Fui%2Fpattern%2Fbindings-after-at%2Fbox-patterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54561148581f002793ab42893de4e3f7c26bd7ed/src%2Ftest%2Fui%2Fpattern%2Fbindings-after-at%2Fbox-patterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpattern%2Fbindings-after-at%2Fbox-patterns.rs?ref=54561148581f002793ab42893de4e3f7c26bd7ed", "patch": "@@ -0,0 +1,36 @@\n+// Test bindings-after-at with box-patterns\n+\n+// run-pass\n+\n+#![feature(bindings_after_at)]\n+#![feature(box_patterns)]\n+\n+#[derive(Debug, PartialEq)]\n+enum MatchArm {\n+    Arm(usize),\n+    Wild,\n+}\n+\n+fn test(x: Option<Box<i32>>) -> MatchArm {\n+    match x {\n+        ref bar @ Some(box n) if n > 0 => {\n+            // bar is a &Option<Box<i32>>\n+            assert_eq!(bar, &x);\n+\n+            MatchArm::Arm(0)\n+        },\n+        Some(ref bar @ box n) if n < 0 => {\n+            // bar is a &Box<i32> here\n+            assert_eq!(**bar, n);\n+\n+            MatchArm::Arm(1)\n+        },\n+        _ => MatchArm::Wild,\n+    }\n+}\n+\n+fn main() {\n+    assert_eq!(test(Some(Box::new(2))), MatchArm::Arm(0));\n+    assert_eq!(test(Some(Box::new(-1))), MatchArm::Arm(1));\n+    assert_eq!(test(Some(Box::new(0))), MatchArm::Wild);\n+}"}, {"sha": "ca8826f03f1ad0acf841861fd770af2f6e033404", "filename": "src/test/ui/pattern/bindings-after-at/or-patterns-box-patterns.rs", "status": "added", "additions": 45, "deletions": 0, "changes": 45, "blob_url": "https://github.com/rust-lang/rust/blob/54561148581f002793ab42893de4e3f7c26bd7ed/src%2Ftest%2Fui%2Fpattern%2Fbindings-after-at%2For-patterns-box-patterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54561148581f002793ab42893de4e3f7c26bd7ed/src%2Ftest%2Fui%2Fpattern%2Fbindings-after-at%2For-patterns-box-patterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpattern%2Fbindings-after-at%2For-patterns-box-patterns.rs?ref=54561148581f002793ab42893de4e3f7c26bd7ed", "patch": "@@ -0,0 +1,45 @@\n+// Test bindings-after-at with or-patterns and box-patterns\n+\n+// run-pass\n+\n+#![feature(bindings_after_at)]\n+#![feature(or_patterns)]\n+#![feature(box_patterns)]\n+\n+#[derive(Debug, PartialEq)]\n+enum MatchArm {\n+    Arm(usize),\n+    Wild,\n+}\n+\n+#[derive(Debug, PartialEq)]\n+enum Test {\n+    Foo,\n+    Bar,\n+    Baz,\n+    Qux,\n+}\n+\n+fn test(foo: Option<Box<Test>>) -> MatchArm {\n+    match foo {\n+        ref bar @ Some(box Test::Foo | box Test::Bar) => {\n+            assert_eq!(bar, &foo);\n+\n+            MatchArm::Arm(0)\n+        },\n+        Some(ref bar @ box Test::Baz | ref bar @ box Test::Qux) => {\n+            assert!(**bar == Test::Baz || **bar == Test::Qux);\n+\n+            MatchArm::Arm(1)\n+        },\n+        _ => MatchArm::Wild,\n+    }\n+}\n+\n+fn main() {\n+    assert_eq!(test(Some(Box::new(Test::Foo))), MatchArm::Arm(0));\n+    assert_eq!(test(Some(Box::new(Test::Bar))), MatchArm::Arm(0));\n+    assert_eq!(test(Some(Box::new(Test::Baz))), MatchArm::Arm(1));\n+    assert_eq!(test(Some(Box::new(Test::Qux))), MatchArm::Arm(1));\n+    assert_eq!(test(None), MatchArm::Wild);\n+}"}, {"sha": "154df74cc33d83c2e63c77d7dcf6b8d5b3180fa7", "filename": "src/test/ui/pattern/bindings-after-at/or-patterns-slice-patterns.rs", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/rust-lang/rust/blob/54561148581f002793ab42893de4e3f7c26bd7ed/src%2Ftest%2Fui%2Fpattern%2Fbindings-after-at%2For-patterns-slice-patterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54561148581f002793ab42893de4e3f7c26bd7ed/src%2Ftest%2Fui%2Fpattern%2Fbindings-after-at%2For-patterns-slice-patterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpattern%2Fbindings-after-at%2For-patterns-slice-patterns.rs?ref=54561148581f002793ab42893de4e3f7c26bd7ed", "patch": "@@ -0,0 +1,43 @@\n+// Test bindings-after-at with or-patterns and slice-patterns\n+\n+// run-pass\n+\n+#![feature(bindings_after_at)]\n+#![feature(or_patterns)]\n+\n+#[derive(Debug, PartialEq)]\n+enum MatchArm {\n+    Arm(usize),\n+    Wild,\n+}\n+\n+#[derive(Debug, PartialEq)]\n+enum Test {\n+    Foo,\n+    Bar,\n+    Baz,\n+    Qux,\n+}\n+\n+fn test(foo: &[Option<Test>]) -> MatchArm {\n+    match foo {\n+        bar @ [Some(Test::Foo), .., Some(Test::Foo | Test::Qux)] => {\n+            assert_eq!(bar, foo);\n+\n+            MatchArm::Arm(0)\n+        },\n+        [.., bar @ Some(Test::Bar | Test::Qux), _] => {\n+            assert!(bar == &Some(Test::Bar) || bar == &Some(Test::Qux));\n+\n+            MatchArm::Arm(1)\n+        },\n+        _ => MatchArm::Wild,\n+    }\n+}\n+\n+fn main() {\n+    let foo = vec![Some(Test::Foo), Some(Test::Bar), Some(Test::Baz), Some(Test::Qux)];\n+    assert_eq!(test(&foo), MatchArm::Arm(0));\n+    assert_eq!(test(&foo[..3]), MatchArm::Arm(1));\n+    assert_eq!(test(&foo[1..2]), MatchArm::Wild);\n+}"}, {"sha": "a0e14004ab1b0b35b0878eaeee73184b11408585", "filename": "src/test/ui/pattern/bindings-after-at/or-patterns.rs", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/54561148581f002793ab42893de4e3f7c26bd7ed/src%2Ftest%2Fui%2Fpattern%2Fbindings-after-at%2For-patterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54561148581f002793ab42893de4e3f7c26bd7ed/src%2Ftest%2Fui%2Fpattern%2Fbindings-after-at%2For-patterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpattern%2Fbindings-after-at%2For-patterns.rs?ref=54561148581f002793ab42893de4e3f7c26bd7ed", "patch": "@@ -0,0 +1,40 @@\n+// Test bindings-after-at with or-patterns\n+\n+// run-pass\n+\n+#![feature(bindings_after_at)]\n+#![feature(or_patterns)]\n+\n+#[derive(Debug, PartialEq)]\n+enum MatchArm {\n+    Arm(usize),\n+    Wild,\n+}\n+\n+#[derive(Debug, Clone, Copy, PartialEq)]\n+enum Test {\n+    Foo,\n+    Bar,\n+    Baz,\n+    Qux,\n+}\n+\n+fn test(foo: Option<Test>) -> MatchArm {\n+    match foo {\n+        bar @ Some(Test::Foo | Test::Bar) => {\n+            assert!(bar == Some(Test::Foo) || bar == Some(Test::Bar));\n+\n+            MatchArm::Arm(0)\n+        },\n+        Some(_) => MatchArm::Arm(1),\n+        _ => MatchArm::Wild,\n+    }\n+}\n+\n+fn main() {\n+    assert_eq!(test(Some(Test::Foo)), MatchArm::Arm(0));\n+    assert_eq!(test(Some(Test::Bar)), MatchArm::Arm(0));\n+    assert_eq!(test(Some(Test::Baz)), MatchArm::Arm(1));\n+    assert_eq!(test(Some(Test::Qux)), MatchArm::Arm(1));\n+    assert_eq!(test(None), MatchArm::Wild);\n+}"}, {"sha": "7e50527af0b97b69b753112f4ca8aa150d638769", "filename": "src/test/ui/pattern/bindings-after-at/slice-patterns.rs", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/54561148581f002793ab42893de4e3f7c26bd7ed/src%2Ftest%2Fui%2Fpattern%2Fbindings-after-at%2Fslice-patterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54561148581f002793ab42893de4e3f7c26bd7ed/src%2Ftest%2Fui%2Fpattern%2Fbindings-after-at%2Fslice-patterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpattern%2Fbindings-after-at%2Fslice-patterns.rs?ref=54561148581f002793ab42893de4e3f7c26bd7ed", "patch": "@@ -0,0 +1,40 @@\n+// Test bindings-after-at with slice-patterns\n+\n+// run-pass\n+\n+#![feature(bindings_after_at)]\n+\n+#[derive(Debug, PartialEq)]\n+enum MatchArm {\n+    Arm(usize),\n+    Wild,\n+}\n+\n+fn test(foo: &[i32]) -> MatchArm {\n+    match foo {\n+        [bar @ .., n] if n == &5 => {\n+            for i in bar {\n+                assert!(i < &5);\n+            }\n+\n+            MatchArm::Arm(0)\n+        },\n+        bar @ [x0, .., xn] => {\n+            assert_eq!(x0, &1);\n+            assert_eq!(x0, &1);\n+            assert_eq!(xn, &4);\n+            assert_eq!(bar, &[1, 2, 3, 4]);\n+\n+            MatchArm::Arm(1)\n+        },\n+        _ => MatchArm::Wild,\n+    }\n+}\n+\n+fn main() {\n+    let foo = vec![1, 2, 3, 4, 5];\n+\n+    assert_eq!(test(&foo), MatchArm::Arm(0));\n+    assert_eq!(test(&foo[..4]), MatchArm::Arm(1));\n+    assert_eq!(test(&foo[0..1]), MatchArm::Wild);\n+}"}]}