{"sha": "47e0bb59dbfe1010ed19bfd49c21fa7da4ab4f42", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ3ZTBiYjU5ZGJmZTEwMTBlZDE5YmZkNDljMjFmYTdkYTRhYjRmNDI=", "commit": {"author": {"name": "Oliver Schneider", "email": "git-spam-no-reply9815368754983@oli-obk.de", "date": "2018-03-07T07:17:03Z"}, "committer": {"name": "Oliver Schneider", "email": "git-spam-no-reply9815368754983@oli-obk.de", "date": "2018-03-08T07:35:39Z"}, "message": "Clean up the binary hex lint", "tree": {"sha": "66252210ae3764923b8254ee29151ca23fe2b193", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/66252210ae3764923b8254ee29151ca23fe2b193"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/47e0bb59dbfe1010ed19bfd49c21fa7da4ab4f42", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEYFTdM4NKd7XQft77pp+NIls619kFAlqg58sACgkQpp+NIls6\n19kuvw//W6fZR2sNNsEjZftrKd1zoQ9/YSU3crUjAr6i+eyfFqbCIAUkjVYsiwzy\nLzEdVNnn0c8q6lXLGWO9pXcp0tQepKAXBWJNuPLOTc/aBap2To/PimnaMExy23DH\n1gG0Z2BNYEVKW+ccnISBNjLoqBh+wIywhG+LqMYc2mb+NxxEGSkEfYfciQBNSZFm\nqCHbRqpAeMFhjiioQBg+qJdWexqez9uatwnoHxt1snCETOw+W1XXttRXPhJEx2HZ\n/KHfYSBA7aY6tO6smnc3QirgoexL3RTgUmpnju2VdOtwR93Z4Z516cGgWLNdO9Ly\nn4Tfk1brYxyLAV4WJ9zTtxJm2xEsc2zHYQ/r4lUBANVjoQxz6nE1TPSpCKPtBVD5\nQKsud8GfdfR+ksJCeJM9O6norgk2E0LmgqCIWetf4NnXps5LnOPjkb7/f4MQQW6a\ncRMj5ezwr+6y4wKfCGuO8pYYhdAefBarxabHOXrtI4ADhszzxonci+mmDPi7rvfA\nLKa4s6AsnEMrUbGRrCXEhX+Bxr3nzccNDwTtbfQQWaDM6Enm4Ena+M4ZHBreTj+t\nEcDLgrAeU6280Zbc75RcQ5GI27E+vTF4gn8HLvK3Yao8Y1oq6aH3EFHrNiHYXH/k\nDmbpDbFmOXXEkYsdNaDfLjpcnxb0rwqEprHb3MUM7xvuT9f14sk=\n=2uSF\n-----END PGP SIGNATURE-----", "payload": "tree 66252210ae3764923b8254ee29151ca23fe2b193\nparent c0fc6a8b6b5bba6eed003fdc08e3af1967ab349d\nauthor Oliver Schneider <git-spam-no-reply9815368754983@oli-obk.de> 1520407023 +0100\ncommitter Oliver Schneider <git-spam-no-reply9815368754983@oli-obk.de> 1520494539 +0100\n\nClean up the binary hex lint\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/47e0bb59dbfe1010ed19bfd49c21fa7da4ab4f42", "html_url": "https://github.com/rust-lang/rust/commit/47e0bb59dbfe1010ed19bfd49c21fa7da4ab4f42", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/47e0bb59dbfe1010ed19bfd49c21fa7da4ab4f42/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c0fc6a8b6b5bba6eed003fdc08e3af1967ab349d", "url": "https://api.github.com/repos/rust-lang/rust/commits/c0fc6a8b6b5bba6eed003fdc08e3af1967ab349d", "html_url": "https://github.com/rust-lang/rust/commit/c0fc6a8b6b5bba6eed003fdc08e3af1967ab349d"}], "stats": {"total": 8, "additions": 5, "deletions": 3}, "files": [{"sha": "266f322e39777e69ad48059eb3355934e1f995f6", "filename": "src/librustc_lint/types.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/47e0bb59dbfe1010ed19bfd49c21fa7da4ab4f42/src%2Flibrustc_lint%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/47e0bb59dbfe1010ed19bfd49c21fa7da4ab4f42/src%2Flibrustc_lint%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Ftypes.rs?ref=47e0bb59dbfe1010ed19bfd49c21fa7da4ab4f42", "patch": "@@ -21,7 +21,7 @@ use lint::{LintPass, LateLintPass};\n use std::cmp;\n use std::{i8, i16, i32, i64, u8, u16, u32, u64, f32, f64};\n \n-use syntax::ast;\n+use syntax::{ast, attr};\n use syntax::abi::Abi;\n use syntax_pos::Span;\n use syntax::codemap;\n@@ -365,12 +365,14 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for TypeLimits {\n         ) {\n             let (t, actually) = match ty {\n                 ty::TyInt(t) => {\n-                    let bits = int_ty_bits(t, cx.sess().target.isize_ty);\n+                    let ity = attr::IntType::SignedInt(t);\n+                    let bits = layout::Integer::from_attr(cx.tcx, ity).size().bits();\n                     let actually = (val << (128 - bits)) as i128 >> (128 - bits);\n                     (format!(\"{:?}\", t), actually.to_string())\n                 }\n                 ty::TyUint(t) => {\n-                    let bits = uint_ty_bits(t, cx.sess().target.usize_ty);\n+                    let ity = attr::IntType::UnsignedInt(t);\n+                    let bits = layout::Integer::from_attr(cx.tcx, ity).size().bits();\n                     let actually = (val << (128 - bits)) >> (128 - bits);\n                     (format!(\"{:?}\", t), actually.to_string())\n                 }"}]}