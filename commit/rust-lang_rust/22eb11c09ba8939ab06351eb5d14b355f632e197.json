{"sha": "22eb11c09ba8939ab06351eb5d14b355f632e197", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIyZWIxMWMwOWJhODkzOWFiMDYzNTFlYjVkMTRiMzU1ZjYzMmUxOTc=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-11-06T22:01:14Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-11-06T22:01:14Z"}, "message": "auto merge of #10227 : kud1ing/rust/ios, r=alexcrichton", "tree": {"sha": "e823b8b63030586cf3cc254aba383a61aa4c154f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e823b8b63030586cf3cc254aba383a61aa4c154f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/22eb11c09ba8939ab06351eb5d14b355f632e197", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/22eb11c09ba8939ab06351eb5d14b355f632e197", "html_url": "https://github.com/rust-lang/rust/commit/22eb11c09ba8939ab06351eb5d14b355f632e197", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/22eb11c09ba8939ab06351eb5d14b355f632e197/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fdc830df31df205c8edc5e11268a011d44c8bc09", "url": "https://api.github.com/repos/rust-lang/rust/commits/fdc830df31df205c8edc5e11268a011d44c8bc09", "html_url": "https://github.com/rust-lang/rust/commit/fdc830df31df205c8edc5e11268a011d44c8bc09"}, {"sha": "2a333ed0884c65d06591607e6e9b2857bd327d6e", "url": "https://api.github.com/repos/rust-lang/rust/commits/2a333ed0884c65d06591607e6e9b2857bd327d6e", "html_url": "https://github.com/rust-lang/rust/commit/2a333ed0884c65d06591607e6e9b2857bd327d6e"}], "stats": {"total": 33, "additions": 26, "deletions": 7}, "files": [{"sha": "d9df4d42f5796c3031176c56133caa7eb750c9aa", "filename": "mk/platform.mk", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/22eb11c09ba8939ab06351eb5d14b355f632e197/mk%2Fplatform.mk", "raw_url": "https://github.com/rust-lang/rust/raw/22eb11c09ba8939ab06351eb5d14b355f632e197/mk%2Fplatform.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fplatform.mk?ref=22eb11c09ba8939ab06351eb5d14b355f632e197", "patch": "@@ -195,8 +195,8 @@ CFG_RUN_TARG_i686-unknown-linux-gnu=$(call CFG_RUN_i686-unknown-linux-gnu,,$(2))\n \n # arm-apple-darwin configuration\n ifeq ($(CFG_OSTYPE),apple-darwin)\n-CFG_IOS_SDK = $(shell xcrun --show-sdk-path -sdk iphoneos)\n-CFG_IOS_FLAGS = -target arm-apple-darwin -isysroot $(CFG_IOS_SDK) -I $(CFG_IOS_SDK)/usr/include -I $(CFG_IOS_SDK)/usr/include/c++/4.2.1 -I /usr/include\n+CFG_IOS_SDK = $(shell xcrun --show-sdk-path -sdk iphoneos 2>/dev/null)\n+CFG_IOS_FLAGS = -target arm-apple-darwin -isysroot $(CFG_IOS_SDK) -I$(CFG_IOS_SDK)/usr/include -I$(CFG_IOS_SDK)/usr/include/c++/4.2.1\n CC_arm-apple-darwin = $(shell xcrun -find -sdk iphoneos clang)\n CXX_arm-apple-darwin = $(shell xcrun -find -sdk iphoneos clang++)\n CPP_arm-apple-darwin = $(shell xcrun -find -sdk iphoneos clang++)"}, {"sha": "3d5e9cbcb82a150b6b3107323371fe1e77f73f0a", "filename": "mk/rt.mk", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/22eb11c09ba8939ab06351eb5d14b355f632e197/mk%2Frt.mk", "raw_url": "https://github.com/rust-lang/rust/raw/22eb11c09ba8939ab06351eb5d14b355f632e197/mk%2Frt.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Frt.mk?ref=22eb11c09ba8939ab06351eb5d14b355f632e197", "patch": "@@ -28,6 +28,13 @@ LIBUV_FLAGS_i386 = -m32 -fPIC -I$(S)src/etc/mingw-fix-include\n LIBUV_FLAGS_x86_64 = -m64 -fPIC\n ifeq ($(OSTYPE_$(1)), linux-androideabi)\n LIBUV_FLAGS_arm = -fPIC -DANDROID -std=gnu99\n+else ifeq ($(OSTYPE_$(1)), apple-darwin)\n+  ifeq ($(HOST_$(1)), arm)\n+    IOS_SDK := $(shell xcrun --show-sdk-path -sdk iphoneos 2>/dev/null)\n+    LIBUV_FLAGS_arm := -fPIC -std=gnu99 -I$(IOS_SDK)/usr/include -I$(IOS_SDK)/usr/include/c++/4.2.1\n+  else\n+    LIBUV_FLAGS_arm := -fPIC -std=gnu99\n+  endif\n else\n LIBUV_FLAGS_arm = -fPIC -std=gnu99\n endif"}, {"sha": "7227c15cc47e9803324a07e8e0d8a95f91fd0703", "filename": "src/rt/arch/arm/_context.S", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/22eb11c09ba8939ab06351eb5d14b355f632e197/src%2Frt%2Farch%2Farm%2F_context.S", "raw_url": "https://github.com/rust-lang/rust/raw/22eb11c09ba8939ab06351eb5d14b355f632e197/src%2Frt%2Farch%2Farm%2F_context.S", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Farch%2Farm%2F_context.S?ref=22eb11c09ba8939ab06351eb5d14b355f632e197", "patch": "@@ -6,8 +6,11 @@\n .text\n .code 32\n .arm\n+#if defined(__APPLE__)\n+.align 2\n+#else\n .align\n-\n+#endif\n \n .globl swap_registers\n swap_registers:"}, {"sha": "cce14ed5a3ecf09f01ba2c2a1e9290d674a7a01d", "filename": "src/rt/arch/arm/record_sp.S", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/22eb11c09ba8939ab06351eb5d14b355f632e197/src%2Frt%2Farch%2Farm%2Frecord_sp.S", "raw_url": "https://github.com/rust-lang/rust/raw/22eb11c09ba8939ab06351eb5d14b355f632e197/src%2Frt%2Farch%2Farm%2Frecord_sp.S", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Farch%2Farm%2Frecord_sp.S?ref=22eb11c09ba8939ab06351eb5d14b355f632e197", "patch": "@@ -6,8 +6,11 @@\n .text\n .code 32\n .arm\n+#if defined(__APPLE__)\n+.align 2\n+#else\n .align\n-\n+#endif\n \n .globl record_sp_limit\n .globl get_sp_limit"}, {"sha": "e8141d37ff1c5093a19e0c316b7cc82e9b28bb1d", "filename": "src/rt/rust_builtin.cpp", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/22eb11c09ba8939ab06351eb5d14b355f632e197/src%2Frt%2Frust_builtin.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/22eb11c09ba8939ab06351eb5d14b355f632e197/src%2Frt%2Frust_builtin.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_builtin.cpp?ref=22eb11c09ba8939ab06351eb5d14b355f632e197", "patch": "@@ -17,8 +17,14 @@\n #include <time.h>\n \n #ifdef __APPLE__\n-#include <crt_externs.h>\n-#include <mach/mach_time.h>\n+    #include <TargetConditionals.h>\n+    #include <mach/mach_time.h>\n+\n+    #if (TARGET_OS_IPHONE)\n+        extern char **environ;\n+    #else\n+        #include <crt_externs.h>\n+    #endif\n #endif\n \n #if !defined(__WIN32__)\n@@ -57,7 +63,7 @@ rust_env_pairs() {\n #else\n extern \"C\" CDECL char**\n rust_env_pairs() {\n-#ifdef __APPLE__\n+#if defined(__APPLE__) && !(TARGET_OS_IPHONE)\n     char **environ = *_NSGetEnviron();\n #endif\n     return environ;"}]}