{"sha": "cbcea24824456ccbbb50a4ef471cb5714dbd7147", "node_id": "C_kwDOAAsO6NoAKGNiY2VhMjQ4MjQ0NTZjY2JiYjUwYTRlZjQ3MWNiNTcxNGRiZDcxNDc", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-09-01T19:37:15Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-09-01T19:37:15Z"}, "message": "Rollup merge of #101256 - andrewpollack:fuchsia-docs-adding, r=tmandry\n\nFixes/adjustments to Fuchsia doc walkthrough\n\nSmall fixes/adjustments missed during #100927", "tree": {"sha": "79a4bf4b43438345ecea3012d8967f09596e3bbb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/79a4bf4b43438345ecea3012d8967f09596e3bbb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cbcea24824456ccbbb50a4ef471cb5714dbd7147", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjEQnrCRBK7hj4Ov3rIwAALugIAFrL/Hu6LJ0AkcaZNaQrOLt7\nbDsZRNAsZWeVrF13FIneR6t9O6EASX3xdL2esvPuupfkHHcELSpgXh8B9zuN4YkJ\nYTSkm+VJ+SDWKBhOLVytMOq3F3Wg2ueeq+YNQBjUfkbanZZwL3qTYv+ULW1fnYz3\nXPZSDlZZVzth3Zvb+JMXt/9kZ14rbUsmxBjlkpAImLzK0UStmFqDojbqDGBYXyWM\nIdyL4Xz7IoYPOudkzcLf3YKllU28kxsN6JbL721pJ2GFfBXKW+MG1MKaWKCvRHIL\nzqFKJIMZh6XKfSoCuwN3V8wucuSkJjy2DkvRftS7JdDrZb0PPlF89DPdBZj+0Vg=\n=tRlb\n-----END PGP SIGNATURE-----\n", "payload": "tree 79a4bf4b43438345ecea3012d8967f09596e3bbb\nparent 418748ff6b4f475edc7a640819e8f5bcac89a50a\nparent d8b572b820e2c1b59a26d28fc2c6234e34aedc6d\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1662061035 +0200\ncommitter GitHub <noreply@github.com> 1662061035 +0200\n\nRollup merge of #101256 - andrewpollack:fuchsia-docs-adding, r=tmandry\n\nFixes/adjustments to Fuchsia doc walkthrough\n\nSmall fixes/adjustments missed during #100927\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cbcea24824456ccbbb50a4ef471cb5714dbd7147", "html_url": "https://github.com/rust-lang/rust/commit/cbcea24824456ccbbb50a4ef471cb5714dbd7147", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cbcea24824456ccbbb50a4ef471cb5714dbd7147/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "418748ff6b4f475edc7a640819e8f5bcac89a50a", "url": "https://api.github.com/repos/rust-lang/rust/commits/418748ff6b4f475edc7a640819e8f5bcac89a50a", "html_url": "https://github.com/rust-lang/rust/commit/418748ff6b4f475edc7a640819e8f5bcac89a50a"}, {"sha": "d8b572b820e2c1b59a26d28fc2c6234e34aedc6d", "url": "https://api.github.com/repos/rust-lang/rust/commits/d8b572b820e2c1b59a26d28fc2c6234e34aedc6d", "html_url": "https://github.com/rust-lang/rust/commit/d8b572b820e2c1b59a26d28fc2c6234e34aedc6d"}], "stats": {"total": 28, "additions": 18, "deletions": 10}, "files": [{"sha": "53a510f080ece9cd899052107f28de1fad2a15ba", "filename": "src/doc/rustc/src/platform-support/fuchsia.md", "status": "modified", "additions": 18, "deletions": 10, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/cbcea24824456ccbbb50a4ef471cb5714dbd7147/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support%2Ffuchsia.md", "raw_url": "https://github.com/rust-lang/rust/raw/cbcea24824456ccbbb50a4ef471cb5714dbd7147/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support%2Ffuchsia.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support%2Ffuchsia.md?ref=cbcea24824456ccbbb50a4ef471cb5714dbd7147", "patch": "@@ -125,13 +125,20 @@ during compilation:\n [target.x86_64-fuchsia]\n \n rustflags = [\n-    \"-Lnative\", \"<SDK_PATH>/arch/x64/sysroot/lib\",\n-    \"-Lnative\", \"<SDK_PATH>/arch/x64/lib\"\n+    \"-Lnative=<SDK_PATH>/arch/x64/lib\",\n+    \"-Lnative=<SDK_PATH>/arch/x64/sysroot/lib\"\n ]\n ```\n \n *Note: Make sure to fill out `<SDK_PATH>` with the path to the downloaded [Fuchsia SDK].*\n \n+These options configure the following:\n+\n+* `-Lnative=${SDK_PATH}/arch/${ARCH}/lib`: Link against Fuchsia libraries from\n+  the SDK\n+* `-Lnative=${SDK_PATH}/arch/${ARCH}/sysroot/lib`: Link against Fuchsia kernel\n+  libraries from the SDK\n+\n In total, our new project will look like:\n \n **Current directory structure**\n@@ -368,6 +375,7 @@ language called CML. The Fuchsia devsite contains an [overview of CML] and a\n }\n ```\n \n+**Current directory structure**\n ```txt\n hello_fuchsia/\n \u2517\u2501 pkg/\n@@ -386,6 +394,9 @@ ${SDK_PATH}/tools/${ARCH}/cmc compile \\\n     -o pkg/meta/hello_fuchsia.cm\n ```\n \n+*Note: `--includepath` tells the compiler where to look for `include`s from our CML.\n+In our case, we're only using `syslog/client.shard.cml`.*\n+\n **Current directory structure**\n ```txt\n hello_fuchsia/\n@@ -397,19 +408,16 @@ hello_fuchsia/\n    \u2517\u2501 hello_fuchsia.cml\n ```\n \n-*Note: `--includepath` tells the compiler where to look for `include`s from our CML.\n-In our case, we're only using `syslog/client.shard.cml`.*\n-\n ### Building a Fuchsia package\n \n Next, we'll build a package manifest as defined by our manifest:\n \n ```sh\n ${SDK_PATH}/tools/${ARCH}/pm \\\n-    -o hello_fuchsia_manifest \\\n+    -o pkg/hello_fuchsia_manifest \\\n     -m pkg/hello_fuchsia.manifest \\\n     build \\\n-    -output-package-manifest hello_fuchsia_package_manifest\n+    -output-package-manifest pkg/hello_fuchsia_package_manifest\n ```\n \n This will produce `pkg/hello_fuchsia_manifest/` which is a package manifest we can\n@@ -469,15 +477,15 @@ We can publish our new package to that repository with:\n \n ```sh\n ${SDK_PATH}/tools/${ARCH}/pm publish \\\n-    -repo repo \\\n-    -lp -f <(echo \"hello_fuchsia_package_manifest\")\n+    -repo pkg/repo \\\n+    -lp -f <(echo \"pkg/hello_fuchsia_package_manifest\")\n ```\n \n Then we can add the repository to `ffx`'s package server as `hello-fuchsia` using:\n \n ```sh\n ${SDK_PATH}/tools/${ARCH}/ffx repository add-from-pm \\\n-    repo \\\n+    pkg/repo \\\n     -r hello-fuchsia\n ```\n "}]}