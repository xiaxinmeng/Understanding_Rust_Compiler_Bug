{"sha": "ed1297c92a77997178ad7aadb9d0cc087d15e0af", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVkMTI5N2M5MmE3Nzk5NzE3OGFkN2FhZGI5ZDBjYzA4N2QxNWUwYWY=", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2020-05-17T18:08:23Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2020-05-20T18:33:37Z"}, "message": "rustc_target: Avoid an inappropriate use of `post_link_objects`", "tree": {"sha": "baf169c197f457ffda6841423f9b3adc3ad4338e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/baf169c197f457ffda6841423f9b3adc3ad4338e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ed1297c92a77997178ad7aadb9d0cc087d15e0af", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ed1297c92a77997178ad7aadb9d0cc087d15e0af", "html_url": "https://github.com/rust-lang/rust/commit/ed1297c92a77997178ad7aadb9d0cc087d15e0af", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ed1297c92a77997178ad7aadb9d0cc087d15e0af/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f182c4af8a22df906f6e901cb11a1a804f29f32c", "url": "https://api.github.com/repos/rust-lang/rust/commits/f182c4af8a22df906f6e901cb11a1a804f29f32c", "html_url": "https://github.com/rust-lang/rust/commit/f182c4af8a22df906f6e901cb11a1a804f29f32c"}], "stats": {"total": 8, "additions": 5, "deletions": 3}, "files": [{"sha": "475a33af29c793a3f7a69a09db2dda9e37ea6a8a", "filename": "src/librustc_target/spec/x86_64_fortanix_unknown_sgx.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ed1297c92a77997178ad7aadb9d0cc087d15e0af/src%2Flibrustc_target%2Fspec%2Fx86_64_fortanix_unknown_sgx.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ed1297c92a77997178ad7aadb9d0cc087d15e0af/src%2Flibrustc_target%2Fspec%2Fx86_64_fortanix_unknown_sgx.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_target%2Fspec%2Fx86_64_fortanix_unknown_sgx.rs?ref=ed1297c92a77997178ad7aadb9d0cc087d15e0af", "patch": "@@ -1,6 +1,6 @@\n use std::iter;\n \n-use super::{crt_objects, LinkerFlavor, LldFlavor, PanicStrategy, Target, TargetOptions};\n+use super::{LinkerFlavor, LldFlavor, PanicStrategy, Target, TargetOptions};\n \n pub fn target() -> Result<Target, String> {\n     const PRE_LINK_ARGS: &[&str] = &[\n@@ -68,8 +68,6 @@ pub fn target() -> Result<Target, String> {\n             PRE_LINK_ARGS.iter().cloned().map(String::from).collect(),\n         ))\n         .collect(),\n-        // FIXME: libunwind is certainly not a CRT object, use some other option instead.\n-        post_link_objects: crt_objects::all(\"libunwind.a\"),\n         override_export_symbols: Some(EXPORT_SYMBOLS.iter().cloned().map(String::from).collect()),\n         relax_elf_relocations: true,\n         ..Default::default()"}, {"sha": "cc025da1af5557d7a74cee57ddbfb1f35a04c888", "filename": "src/libunwind/lib.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ed1297c92a77997178ad7aadb9d0cc087d15e0af/src%2Flibunwind%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ed1297c92a77997178ad7aadb9d0cc087d15e0af/src%2Flibunwind%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibunwind%2Flib.rs?ref=ed1297c92a77997178ad7aadb9d0cc087d15e0af", "patch": "@@ -27,3 +27,7 @@ extern \"C\" {}\n #[link(name = \"gcc_eh\", kind = \"static-nobundle\", cfg(target_feature = \"crt-static\"))]\n #[link(name = \"gcc_s\", cfg(not(target_feature = \"crt-static\")))]\n extern \"C\" {}\n+\n+#[cfg(all(target_vendor = \"fortanix\", target_env = \"sgx\"))]\n+#[link(name = \"unwind\", kind = \"static-nobundle\")]\n+extern \"C\" {}"}]}