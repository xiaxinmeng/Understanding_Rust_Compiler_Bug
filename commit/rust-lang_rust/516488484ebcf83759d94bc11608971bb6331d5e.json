{"sha": "516488484ebcf83759d94bc11608971bb6331d5e", "node_id": "C_kwDOAAsO6NoAKDUxNjQ4ODQ4NGViY2Y4Mzc1OWQ5NGJjMTE2MDg5NzFiYjYzMzFkNWU", "commit": {"author": {"name": "Lo\u00efc BRANSTETT", "email": "lolo.branstett@numericable.fr", "date": "2022-03-03T10:52:09Z"}, "committer": {"name": "Lo\u00efc BRANSTETT", "email": "lolo.branstett@numericable.fr", "date": "2022-03-03T10:52:09Z"}, "message": "Fix invalid lint_node_id being put on a removed stmt", "tree": {"sha": "67ec51d8ad35863f178abafba39e028746d811ff", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/67ec51d8ad35863f178abafba39e028746d811ff"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/516488484ebcf83759d94bc11608971bb6331d5e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/516488484ebcf83759d94bc11608971bb6331d5e", "html_url": "https://github.com/rust-lang/rust/commit/516488484ebcf83759d94bc11608971bb6331d5e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/516488484ebcf83759d94bc11608971bb6331d5e/comments", "author": {"login": "Urgau", "id": 3616612, "node_id": "MDQ6VXNlcjM2MTY2MTI=", "avatar_url": "https://avatars.githubusercontent.com/u/3616612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Urgau", "html_url": "https://github.com/Urgau", "followers_url": "https://api.github.com/users/Urgau/followers", "following_url": "https://api.github.com/users/Urgau/following{/other_user}", "gists_url": "https://api.github.com/users/Urgau/gists{/gist_id}", "starred_url": "https://api.github.com/users/Urgau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Urgau/subscriptions", "organizations_url": "https://api.github.com/users/Urgau/orgs", "repos_url": "https://api.github.com/users/Urgau/repos", "events_url": "https://api.github.com/users/Urgau/events{/privacy}", "received_events_url": "https://api.github.com/users/Urgau/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Urgau", "id": 3616612, "node_id": "MDQ6VXNlcjM2MTY2MTI=", "avatar_url": "https://avatars.githubusercontent.com/u/3616612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Urgau", "html_url": "https://github.com/Urgau", "followers_url": "https://api.github.com/users/Urgau/followers", "following_url": "https://api.github.com/users/Urgau/following{/other_user}", "gists_url": "https://api.github.com/users/Urgau/gists{/gist_id}", "starred_url": "https://api.github.com/users/Urgau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Urgau/subscriptions", "organizations_url": "https://api.github.com/users/Urgau/orgs", "repos_url": "https://api.github.com/users/Urgau/repos", "events_url": "https://api.github.com/users/Urgau/events{/privacy}", "received_events_url": "https://api.github.com/users/Urgau/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2f8d1a835b4e7feaf625f74d0d5cb9b84dbc845a", "url": "https://api.github.com/repos/rust-lang/rust/commits/2f8d1a835b4e7feaf625f74d0d5cb9b84dbc845a", "html_url": "https://github.com/rust-lang/rust/commit/2f8d1a835b4e7feaf625f74d0d5cb9b84dbc845a"}], "stats": {"total": 24, "additions": 22, "deletions": 2}, "files": [{"sha": "4af376b983c94a44ec2baca5bca2df9d3cd2c483", "filename": "compiler/rustc_expand/src/expand.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/516488484ebcf83759d94bc11608971bb6331d5e/compiler%2Frustc_expand%2Fsrc%2Fexpand.rs", "raw_url": "https://github.com/rust-lang/rust/raw/516488484ebcf83759d94bc11608971bb6331d5e/compiler%2Frustc_expand%2Fsrc%2Fexpand.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_expand%2Fsrc%2Fexpand.rs?ref=516488484ebcf83759d94bc11608971bb6331d5e", "patch": "@@ -1841,7 +1841,7 @@ impl<'a, 'b> MutVisitor for InvocationCollector<'a, 'b> {\n         self.flat_map_node(node)\n     }\n \n-    fn flat_map_stmt(&mut self, mut node: ast::Stmt) -> SmallVec<[ast::Stmt; 1]> {\n+    fn flat_map_stmt(&mut self, node: ast::Stmt) -> SmallVec<[ast::Stmt; 1]> {\n         // FIXME: invocations in semicolon-less expressions positions are expanded as expressions,\n         // changing that requires some compatibility measures.\n         if node.is_expr() {\n@@ -1863,7 +1863,7 @@ impl<'a, 'b> MutVisitor for InvocationCollector<'a, 'b> {\n                     self.cx.current_expansion.is_trailing_mac = false;\n                     res\n                 }\n-                _ => assign_id!(self, &mut node.id, || noop_flat_map_stmt(node, self)),\n+                _ => noop_flat_map_stmt(node, self),\n             };\n         }\n "}, {"sha": "cf76487ed46fb56d9060485f7b23397c71653fb0", "filename": "src/test/ui/check-cfg/stmt-no-ice.rs", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/516488484ebcf83759d94bc11608971bb6331d5e/src%2Ftest%2Fui%2Fcheck-cfg%2Fstmt-no-ice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/516488484ebcf83759d94bc11608971bb6331d5e/src%2Ftest%2Fui%2Fcheck-cfg%2Fstmt-no-ice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcheck-cfg%2Fstmt-no-ice.rs?ref=516488484ebcf83759d94bc11608971bb6331d5e", "patch": "@@ -0,0 +1,10 @@\n+// This test checks that there is no ICE with this code\n+//\n+// check-pass\n+// compile-flags:--check-cfg=names() -Z unstable-options\n+\n+fn main() {\n+    #[cfg(crossbeam_loom)]\n+    //~^ WARNING unexpected `cfg` condition name\n+    {}\n+}"}, {"sha": "da65b596911d2884254267724cea4fd3c9d732f7", "filename": "src/test/ui/check-cfg/stmt-no-ice.stderr", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/516488484ebcf83759d94bc11608971bb6331d5e/src%2Ftest%2Fui%2Fcheck-cfg%2Fstmt-no-ice.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/516488484ebcf83759d94bc11608971bb6331d5e/src%2Ftest%2Fui%2Fcheck-cfg%2Fstmt-no-ice.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcheck-cfg%2Fstmt-no-ice.stderr?ref=516488484ebcf83759d94bc11608971bb6331d5e", "patch": "@@ -0,0 +1,10 @@\n+warning: unexpected `cfg` condition name\n+  --> $DIR/stmt-no-ice.rs:7:11\n+   |\n+LL |     #[cfg(crossbeam_loom)]\n+   |           ^^^^^^^^^^^^^^\n+   |\n+   = note: `#[warn(unexpected_cfgs)]` on by default\n+\n+warning: 1 warning emitted\n+"}]}