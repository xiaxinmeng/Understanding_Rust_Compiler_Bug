{"sha": "6a4b44426b7fd04592e618a93378510963ceda11", "node_id": "C_kwDOAAsO6NoAKDZhNGI0NDQyNmI3ZmQwNDU5MmU2MThhOTMzNzg1MTA5NjNjZWRhMTE", "commit": {"author": {"name": "Chris Denton", "email": "christophersdenton@gmail.com", "date": "2022-04-07T19:15:16Z"}, "committer": {"name": "Chris Denton", "email": "christophersdenton@gmail.com", "date": "2022-04-07T19:34:55Z"}, "message": "Windows: Increase a pipe's buffer capacity to 64kb\n\nThis brings it inline with typical Linux defaults: https://www.man7.org/linux/man-pages/man7/pipe.7.html", "tree": {"sha": "d635b1fc5db070f6fafc67c410b7e4edda855b24", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d635b1fc5db070f6fafc67c410b7e4edda855b24"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6a4b44426b7fd04592e618a93378510963ceda11", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE+p/jD6jrzmnSIWJLcTRy8vRWJ94FAmJPPN8ACgkQcTRy8vRW\nJ97jphAAnloAMQsvCB0Sf3tNIzqUJW9DzGyQOJJ2TmbGNgkKxQLdDfyGKozNQFmW\nV/wmpWVqy5wkuuEzyZuxp2Ho6cOjJVd1KR8YlizAW2EAbwNtQgxweUJ4nqdlpDSV\n3DQFdTUD07+/gkuG8xJqMDxO9YQ3N0C6cJg5QCKQtzGrvzoSL6JccXCTOw5cmzoX\nChOEwKrK+yaYMzP0eKsBJBov9f3XGVDCrrbuC141P06gEXoLW3KLuGYubHhMcmgi\nVIJZrpHT6CQ7hd6dzSiwf78ktRBOnfClspd4g+vOqTsFpoeUUu/mTrFyvk38+dYv\n8wiHw7yU4VwctKwWcWyin9cuXv9gX16hLrtDJ34PqINuyBDYm/AqvQIAMkrFj9U+\nCvdpqhEnnZ0bAVdu90Jl4wIhIku4+I6ZDIHbswV0N/GgtxjNzbkVi6b5ITo0snsU\nPNGK4TrlWxjVjdi07b9ZL6hVuMiD0AzDbah8HSbvUng1TLcEjUiR3943k69f8tPC\neHsCkmZ+xg3KmDV2plWKp2WdXof0++9XXEilor/Uj0fJOWET0hptVa9xhAajxQT1\nPamQkhVLfEX0AANSHwiju3Gz6nqgswLyXrS1941j0Herr9WKZ7HWslQeX7vWzgRo\nhhHyEgesh0mT9ILIhMTsuY5r5RIb5OlBHGl/CX4zOt//3sBIUP4=\n=j4J/\n-----END PGP SIGNATURE-----", "payload": "tree d635b1fc5db070f6fafc67c410b7e4edda855b24\nparent dd38eea722c1f6f970a314435533e91cc2c14ffb\nauthor Chris Denton <christophersdenton@gmail.com> 1649358916 +0100\ncommitter Chris Denton <christophersdenton@gmail.com> 1649360095 +0100\n\nWindows: Increase a pipe's buffer capacity to 64kb\n\nThis brings it inline with typical Linux defaults: https://www.man7.org/linux/man-pages/man7/pipe.7.html\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6a4b44426b7fd04592e618a93378510963ceda11", "html_url": "https://github.com/rust-lang/rust/commit/6a4b44426b7fd04592e618a93378510963ceda11", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6a4b44426b7fd04592e618a93378510963ceda11/comments", "author": {"login": "ChrisDenton", "id": 4459874, "node_id": "MDQ6VXNlcjQ0NTk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4459874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChrisDenton", "html_url": "https://github.com/ChrisDenton", "followers_url": "https://api.github.com/users/ChrisDenton/followers", "following_url": "https://api.github.com/users/ChrisDenton/following{/other_user}", "gists_url": "https://api.github.com/users/ChrisDenton/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChrisDenton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChrisDenton/subscriptions", "organizations_url": "https://api.github.com/users/ChrisDenton/orgs", "repos_url": "https://api.github.com/users/ChrisDenton/repos", "events_url": "https://api.github.com/users/ChrisDenton/events{/privacy}", "received_events_url": "https://api.github.com/users/ChrisDenton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ChrisDenton", "id": 4459874, "node_id": "MDQ6VXNlcjQ0NTk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4459874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChrisDenton", "html_url": "https://github.com/ChrisDenton", "followers_url": "https://api.github.com/users/ChrisDenton/followers", "following_url": "https://api.github.com/users/ChrisDenton/following{/other_user}", "gists_url": "https://api.github.com/users/ChrisDenton/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChrisDenton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChrisDenton/subscriptions", "organizations_url": "https://api.github.com/users/ChrisDenton/orgs", "repos_url": "https://api.github.com/users/ChrisDenton/repos", "events_url": "https://api.github.com/users/ChrisDenton/events{/privacy}", "received_events_url": "https://api.github.com/users/ChrisDenton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dd38eea722c1f6f970a314435533e91cc2c14ffb", "url": "https://api.github.com/repos/rust-lang/rust/commits/dd38eea722c1f6f970a314435533e91cc2c14ffb", "html_url": "https://github.com/rust-lang/rust/commit/dd38eea722c1f6f970a314435533e91cc2c14ffb"}], "stats": {"total": 7, "additions": 5, "deletions": 2}, "files": [{"sha": "09d1dd55989e19fbab6ad7eb4a0e737b3403ed7f", "filename": "library/std/src/sys/windows/pipe.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/6a4b44426b7fd04592e618a93378510963ceda11/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fpipe.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a4b44426b7fd04592e618a93378510963ceda11/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fpipe.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fpipe.rs?ref=6a4b44426b7fd04592e618a93378510963ceda11", "patch": "@@ -53,6 +53,9 @@ pub struct Pipes {\n /// with `OVERLAPPED` instances, but also works out ok if it's only ever used\n /// once at a time (which we do indeed guarantee).\n pub fn anon_pipe(ours_readable: bool, their_handle_inheritable: bool) -> io::Result<Pipes> {\n+    // A 64kb pipe capacity is the same as a typical Linux default.\n+    const PIPE_BUFFER_CAPACITY: u32 = 64 * 1024;\n+\n     // Note that we specifically do *not* use `CreatePipe` here because\n     // unfortunately the anonymous pipes returned do not support overlapped\n     // operations. Instead, we create a \"hopefully unique\" name and create a\n@@ -91,8 +94,8 @@ pub fn anon_pipe(ours_readable: bool, their_handle_inheritable: bool) -> io::Res\n                     | c::PIPE_WAIT\n                     | reject_remote_clients_flag,\n                 1,\n-                4096,\n-                4096,\n+                PIPE_BUFFER_CAPACITY,\n+                PIPE_BUFFER_CAPACITY,\n                 0,\n                 ptr::null_mut(),\n             );"}]}