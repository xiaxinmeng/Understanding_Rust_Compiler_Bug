{"sha": "d774bc39e0d2f039c119a38a82389621bb264eda", "node_id": "C_kwDOAAsO6NoAKGQ3NzRiYzM5ZTBkMmYwMzljMTE5YTM4YTgyMzg5NjIxYmIyNjRlZGE", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2022-06-26T04:15:01Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-06-26T04:15:01Z"}, "message": "Rollup merge of #98502 - GuillaumeGomez:source-sidebar-hover, r=notriddle\n\nFix source sidebar hover in ayu theme\n\nIn the screenshot below, `rc.rs` should be orange:\n\n![Screenshot from 2022-06-25 22-24-06](https://user-images.githubusercontent.com/3050060/175789532-99e8781d-2e62-43f7-bbd9-1b1151e1f8c1.png)\n\nIt's because the CSS selector was not precise enough and was \"overloaded\" with another one. This PR fixes it and adds a test for the colors in the source sidebar.\n\ncc `@jsha`\nr? `@notriddle`", "tree": {"sha": "a98a307c51869e4ab0dfa82c70bb5778961923a0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a98a307c51869e4ab0dfa82c70bb5778961923a0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d774bc39e0d2f039c119a38a82389621bb264eda", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJit91FCRBK7hj4Ov3rIwAAc4MIAGl6MHi/tPHy8SYk0jzOtrtx\n9KNNIfKPz55QPGH3Kd1ot/EKHCYVi531SseHzJrGo346OjUdJJ50LDk+2pLf3hB1\n9Ry0ooRoDzx+gMF/WEd6u6HMvQ8XR4pugUE6ir21iBQUEVQy0iOyPk5w9nCExHNm\n79epzQGTfBOPXu0nAwMWshbFV6uF92tD0m4bhNiUkuBVL6ClfiAfUXJhOPUPfGnO\nmBAtSEojZ7K+2x/Uq35dB0d03zCRZMYsf4xoVGap4qVZ1IQueXvUPWYlHbSu5xS2\n7/8uZE592BQtCdrqZI9NKmmNXbt6IWZAmbzBynhauEB48jbqn3Jw2JFVejBPtCw=\n=ReGf\n-----END PGP SIGNATURE-----\n", "payload": "tree a98a307c51869e4ab0dfa82c70bb5778961923a0\nparent b1d66d810d9502ab1bca311b776548ced3b1b711\nparent 2bb46bedfc775c977c1048b4f154ca413597ac9f\nauthor Yuki Okushi <jtitor@2k36.org> 1656216901 +0900\ncommitter GitHub <noreply@github.com> 1656216901 +0900\n\nRollup merge of #98502 - GuillaumeGomez:source-sidebar-hover, r=notriddle\n\nFix source sidebar hover in ayu theme\n\nIn the screenshot below, `rc.rs` should be orange:\n\n![Screenshot from 2022-06-25 22-24-06](https://user-images.githubusercontent.com/3050060/175789532-99e8781d-2e62-43f7-bbd9-1b1151e1f8c1.png)\n\nIt's because the CSS selector was not precise enough and was \"overloaded\" with another one. This PR fixes it and adds a test for the colors in the source sidebar.\n\ncc `@jsha`\nr? `@notriddle`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d774bc39e0d2f039c119a38a82389621bb264eda", "html_url": "https://github.com/rust-lang/rust/commit/d774bc39e0d2f039c119a38a82389621bb264eda", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d774bc39e0d2f039c119a38a82389621bb264eda/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b1d66d810d9502ab1bca311b776548ced3b1b711", "url": "https://api.github.com/repos/rust-lang/rust/commits/b1d66d810d9502ab1bca311b776548ced3b1b711", "html_url": "https://github.com/rust-lang/rust/commit/b1d66d810d9502ab1bca311b776548ced3b1b711"}, {"sha": "2bb46bedfc775c977c1048b4f154ca413597ac9f", "url": "https://api.github.com/repos/rust-lang/rust/commits/2bb46bedfc775c977c1048b4f154ca413597ac9f", "html_url": "https://github.com/rust-lang/rust/commit/2bb46bedfc775c977c1048b4f154ca413597ac9f"}], "stats": {"total": 111, "additions": 105, "deletions": 6}, "files": [{"sha": "5b37ecf19da9407de7043581816ea77a8290c2a8", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d774bc39e0d2f039c119a38a82389621bb264eda/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/d774bc39e0d2f039c119a38a82389621bb264eda/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=d774bc39e0d2f039c119a38a82389621bb264eda", "patch": "@@ -629,11 +629,11 @@ kbd {\n \tcolor: #fff;\n \tborder-bottom-color: #5c6773;\n }\n-div.files > a:hover, div.name:hover {\n+#source-sidebar div.files > a:hover, div.name:hover {\n \tbackground-color: #14191f;\n \tcolor: #ffb44c;\n }\n-div.files > .selected {\n+#source-sidebar div.files > .selected {\n \tbackground-color: #14191f;\n \tcolor: #ffb44c;\n }"}, {"sha": "ffb59f7762b6df65df324287333435425505e567", "filename": "src/librustdoc/html/static/css/themes/dark.css", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d774bc39e0d2f039c119a38a82389621bb264eda/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/d774bc39e0d2f039c119a38a82389621bb264eda/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css?ref=d774bc39e0d2f039c119a38a82389621bb264eda", "patch": "@@ -499,10 +499,10 @@ kbd {\n #source-sidebar > .title {\n \tborder-bottom-color: #ccc;\n }\n-div.files > a:hover, div.name:hover {\n+#source-sidebar div.files > a:hover, div.name:hover {\n \tbackground-color: #444;\n }\n-div.files > .selected {\n+#source-sidebar div.files > .selected {\n \tbackground-color: #333;\n }\n "}, {"sha": "ba798ee2a0eea2c85b0a47460ab8374623f44caa", "filename": "src/librustdoc/html/static/css/themes/light.css", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d774bc39e0d2f039c119a38a82389621bb264eda/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/d774bc39e0d2f039c119a38a82389621bb264eda/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css?ref=d774bc39e0d2f039c119a38a82389621bb264eda", "patch": "@@ -483,10 +483,10 @@ kbd {\n #source-sidebar > .title {\n \tborder-bottom-color: #ccc;\n }\n-div.files > a:hover, div.name:hover {\n+#source-sidebar div.files > a:hover, div.name:hover {\n \tbackground-color: #E0E0E0;\n }\n-div.files > .selected {\n+#source-sidebar div.files > .selected {\n \tbackground-color: #fff;\n }\n "}, {"sha": "8f53e8627ee1c8bb973c5c270a478c89c788571c", "filename": "src/test/rustdoc-gui/sidebar-source-code-display.goml", "status": "modified", "additions": 99, "deletions": 0, "changes": 99, "blob_url": "https://github.com/rust-lang/rust/blob/d774bc39e0d2f039c119a38a82389621bb264eda/src%2Ftest%2Frustdoc-gui%2Fsidebar-source-code-display.goml", "raw_url": "https://github.com/rust-lang/rust/raw/d774bc39e0d2f039c119a38a82389621bb264eda/src%2Ftest%2Frustdoc-gui%2Fsidebar-source-code-display.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsidebar-source-code-display.goml?ref=d774bc39e0d2f039c119a38a82389621bb264eda", "patch": "@@ -17,3 +17,102 @@ assert-css: (\".sidebar > *:not(#sidebar-toggle)\", {\"visibility\": \"hidden\", \"opac\n click: \"#sidebar-toggle\"\n // Because of the transition CSS, we check by using `wait-for-css` instead of `assert-css`.\n wait-for-css: (\"#sidebar-toggle\", {\"visibility\": \"visible\", \"opacity\": 1})\n+\n+// Now we check the display of the sidebar items.\n+show-text: true\n+\n+// First we start with the light theme.\n+local-storage: {\"rustdoc-theme\": \"light\", \"rustdoc-use-system-theme\": \"false\"}\n+reload:\n+// Waiting for the sidebar to be displayed...\n+wait-for-css: (\"#sidebar-toggle\", {\"visibility\": \"visible\", \"opacity\": 1})\n+assert-css: (\n+    \"#source-sidebar .expand + .children a.selected\",\n+    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(255, 255, 255)\"},\n+)\n+// Without hover.\n+assert-css: (\n+    \"#source-sidebar .expand + .children > .files a:not(.selected)\",\n+    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n+)\n+// With hover.\n+move-cursor-to: \"#source-sidebar .expand + .children > .files a:not(.selected)\"\n+assert-css: (\n+    \"#source-sidebar .expand + .children > .files a:not(.selected)\",\n+    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(224, 224, 224)\"},\n+)\n+// Without hover.\n+assert-css: (\n+    \"#source-sidebar .expand + .children .folders .name\",\n+    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n+)\n+// With hover.\n+move-cursor-to: \"#source-sidebar .expand + .children .folders .name\"\n+assert-css: (\n+    \"#source-sidebar .expand + .children .folders .name\",\n+    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(224, 224, 224)\"},\n+)\n+\n+// Now with the dark theme.\n+local-storage: {\"rustdoc-theme\": \"dark\", \"rustdoc-use-system-theme\": \"false\"}\n+reload:\n+// Waiting for the sidebar to be displayed...\n+wait-for-css: (\"#sidebar-toggle\", {\"visibility\": \"visible\", \"opacity\": 1})\n+assert-css: (\n+    \"#source-sidebar .expand + .children a.selected\",\n+    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(51, 51, 51)\"},\n+)\n+// Without hover.\n+assert-css: (\n+    \"#source-sidebar .expand + .children > .files a:not(.selected)\",\n+    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n+)\n+// With hover.\n+move-cursor-to: \"#source-sidebar .expand + .children > .files a:not(.selected)\"\n+assert-css: (\n+    \"#source-sidebar .expand + .children > .files a:not(.selected)\",\n+    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(68, 68, 68)\"},\n+)\n+// Without hover.\n+assert-css: (\n+    \"#source-sidebar .expand + .children .folders .name\",\n+    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n+)\n+// With hover.\n+move-cursor-to: \"#source-sidebar .expand + .children .folders .name\"\n+assert-css: (\n+    \"#source-sidebar .expand + .children .folders .name\",\n+    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(68, 68, 68)\"},\n+)\n+\n+// And finally with the ayu theme.\n+local-storage: {\"rustdoc-theme\": \"ayu\", \"rustdoc-use-system-theme\": \"false\"}\n+reload:\n+// Waiting for the sidebar to be displayed...\n+wait-for-css: (\"#sidebar-toggle\", {\"visibility\": \"visible\", \"opacity\": 1})\n+assert-css: (\n+    \"#source-sidebar .expand + .children a.selected\",\n+    {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n+)\n+// Without hover.\n+assert-css: (\n+    \"#source-sidebar .expand + .children > .files a:not(.selected)\",\n+    {\"color\": \"rgb(197, 197, 197)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n+)\n+// With hover.\n+move-cursor-to: \"#source-sidebar .expand + .children > .files a:not(.selected)\"\n+assert-css: (\n+    \"#source-sidebar .expand + .children > .files a:not(.selected)\",\n+    {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n+)\n+// Without hover.\n+assert-css: (\n+    \"#source-sidebar .expand + .children .folders .name\",\n+    {\"color\": \"rgb(197, 197, 197)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n+)\n+// With hover.\n+move-cursor-to: \"#source-sidebar .expand + .children .folders .name\"\n+assert-css: (\n+    \"#source-sidebar .expand + .children .folders .name\",\n+    {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n+)"}]}