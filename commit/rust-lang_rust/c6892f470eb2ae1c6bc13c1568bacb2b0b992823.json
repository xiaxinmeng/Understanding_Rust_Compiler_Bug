{"sha": "c6892f470eb2ae1c6bc13c1568bacb2b0b992823", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM2ODkyZjQ3MGViMmFlMWM2YmMxM2MxNTY4YmFjYjJiMGI5OTI4MjM=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2017-10-18T17:59:53Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-10-18T17:59:53Z"}, "message": "Rollup merge of #45340 - stjepang:localkey-state-doc-skip-uninitialized, r=alexcrichton\n\nDocs: a LocalKey might start in the Valid state\n\nAdd a comment to the docs for `LocalKey::state` explaining that some keys might skip the `Uninitialized` state and start in the `Valid` state.\n\ncc #27716\n\nr? @alexcrichton", "tree": {"sha": "3626db14a757e0dfba36350e37bc884c097ca749", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3626db14a757e0dfba36350e37bc884c097ca749"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c6892f470eb2ae1c6bc13c1568bacb2b0b992823", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c6892f470eb2ae1c6bc13c1568bacb2b0b992823", "html_url": "https://github.com/rust-lang/rust/commit/c6892f470eb2ae1c6bc13c1568bacb2b0b992823", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c6892f470eb2ae1c6bc13c1568bacb2b0b992823/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c77068a94b385201f8f121b5c7edb7bb2827f553", "url": "https://api.github.com/repos/rust-lang/rust/commits/c77068a94b385201f8f121b5c7edb7bb2827f553", "html_url": "https://github.com/rust-lang/rust/commit/c77068a94b385201f8f121b5c7edb7bb2827f553"}, {"sha": "a50fe312dc9fec9f9fc3576bc244ef2517ac8f4a", "url": "https://api.github.com/repos/rust-lang/rust/commits/a50fe312dc9fec9f9fc3576bc244ef2517ac8f4a", "html_url": "https://github.com/rust-lang/rust/commit/a50fe312dc9fec9f9fc3576bc244ef2517ac8f4a"}], "stats": {"total": 5, "additions": 4, "deletions": 1}, "files": [{"sha": "cb18eed8ee54b63e6eb8ce493c2a35075d7e03cd", "filename": "src/libstd/thread/local.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/c6892f470eb2ae1c6bc13c1568bacb2b0b992823/src%2Flibstd%2Fthread%2Flocal.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c6892f470eb2ae1c6bc13c1568bacb2b0b992823/src%2Flibstd%2Fthread%2Flocal.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fthread%2Flocal.rs?ref=c6892f470eb2ae1c6bc13c1568bacb2b0b992823", "patch": "@@ -325,7 +325,10 @@ impl<T: 'static> LocalKey<T> {\n     ///\n     /// Once the initialization expression succeeds, the key transitions to the\n     /// `Valid` state which will guarantee that future calls to [`with`] will\n-    /// succeed within the thread.\n+    /// succeed within the thread. Some keys might skip the `Uninitialized`\n+    /// state altogether and start in the `Valid` state as an optimization\n+    /// (e.g. keys initialized with a constant expression), but no guarantees\n+    /// are made.\n     ///\n     /// When a thread exits, each key will be destroyed in turn, and as keys are\n     /// destroyed they will enter the `Destroyed` state just before the"}]}