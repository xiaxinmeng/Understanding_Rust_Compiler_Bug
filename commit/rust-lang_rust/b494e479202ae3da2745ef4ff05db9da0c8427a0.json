{"sha": "b494e479202ae3da2745ef4ff05db9da0c8427a0", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI0OTRlNDc5MjAyYWUzZGEyNzQ1ZWY0ZmYwNWRiOWRhMGM4NDI3YTA=", "commit": {"author": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2021-03-27T17:51:06Z"}, "committer": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2021-03-27T17:53:13Z"}, "message": "Snippet support in extract_type_alias", "tree": {"sha": "a65aea3c8fe4d386b14c2fcbeb4bbef22957a4b0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a65aea3c8fe4d386b14c2fcbeb4bbef22957a4b0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b494e479202ae3da2745ef4ff05db9da0c8427a0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b494e479202ae3da2745ef4ff05db9da0c8427a0", "html_url": "https://github.com/rust-lang/rust/commit/b494e479202ae3da2745ef4ff05db9da0c8427a0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b494e479202ae3da2745ef4ff05db9da0c8427a0/comments", "author": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "201fbac8a97ba240ba6112c8f3ceca9ed1f23a3d", "url": "https://api.github.com/repos/rust-lang/rust/commits/201fbac8a97ba240ba6112c8f3ceca9ed1f23a3d", "html_url": "https://github.com/rust-lang/rust/commit/201fbac8a97ba240ba6112c8f3ceca9ed1f23a3d"}], "stats": {"total": 41, "additions": 26, "deletions": 15}, "files": [{"sha": "171b879188b3cecf02702e7a9ff93d9a41761ca8", "filename": "crates/ide_assists/src/handlers/extract_type_alias.rs", "status": "modified", "additions": 24, "deletions": 13, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/b494e479202ae3da2745ef4ff05db9da0c8427a0/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fextract_type_alias.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b494e479202ae3da2745ef4ff05db9da0c8427a0/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fextract_type_alias.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fextract_type_alias.rs?ref=b494e479202ae3da2745ef4ff05db9da0c8427a0", "patch": "@@ -16,10 +16,10 @@ use crate::{AssistContext, AssistId, AssistKind, Assists};\n // ```\n // ->\n // ```\n-// type Type = (u8, u8, u8);\n+// type ${0:Type} = (u8, u8, u8);\n //\n // struct S {\n-//     field: Type,\n+//     field: ${0:Type},\n // }\n // ```\n pub(crate) fn extract_type_alias(acc: &mut Assists, ctx: &AssistContext) -> Option<()> {\n@@ -56,9 +56,20 @@ pub(crate) fn extract_type_alias(acc: &mut Assists, ctx: &AssistContext) -> Opti\n         target,\n         |builder| {\n             builder.edit_file(ctx.frange.file_id);\n-            // FIXME: add snippet support\n-            builder.replace(target, \"Type\");\n-            builder.insert(insert, format!(\"type Type = {};\\n\\n\", node));\n+            match ctx.config.snippet_cap {\n+                Some(cap) => {\n+                    builder.replace_snippet(cap, target, \"${0:Type}\");\n+                    builder.insert_snippet(\n+                        cap,\n+                        insert,\n+                        format!(\"type ${{0:Type}} = {};\\n\\n\", node),\n+                    );\n+                }\n+                None => {\n+                    builder.replace(target, \"Type\");\n+                    builder.insert(insert, format!(\"type Type = {};\\n\\n\", node));\n+                }\n+            }\n         },\n     )\n }\n@@ -91,10 +102,10 @@ struct S {\n }\n             \",\n             r#\"\n-type Type = u8;\n+type ${0:Type} = u8;\n \n struct S {\n-    field: Type,\n+    field: ${0:Type},\n }\n             \"#,\n         );\n@@ -114,10 +125,10 @@ fn f() {\n             r#\"\n fn generic<T>() {}\n \n-type Type = ();\n+type ${0:Type} = ();\n \n fn f() {\n-    generic::<Type>();\n+    generic::<${0:Type}>();\n }\n             \"#,\n         );\n@@ -135,10 +146,10 @@ struct S {\n             \",\n             r#\"\n struct Vec<T> {}\n-type Type = Vec<u8>;\n+type ${0:Type} = Vec<u8>;\n \n struct S {\n-    v: Vec<Vec<Type>>,\n+    v: Vec<Vec<${0:Type}>>,\n }\n             \"#,\n         );\n@@ -154,10 +165,10 @@ struct S {\n }\n             \",\n             r#\"\n-type Type = u8;\n+type ${0:Type} = u8;\n \n struct S {\n-    field: (Type,),\n+    field: (${0:Type},),\n }\n             \"#,\n         );"}, {"sha": "becd640b107fe631519f16252df46f3221b4c91e", "filename": "crates/ide_assists/src/tests/generated.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b494e479202ae3da2745ef4ff05db9da0c8427a0/crates%2Fide_assists%2Fsrc%2Ftests%2Fgenerated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b494e479202ae3da2745ef4ff05db9da0c8427a0/crates%2Fide_assists%2Fsrc%2Ftests%2Fgenerated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_assists%2Fsrc%2Ftests%2Fgenerated.rs?ref=b494e479202ae3da2745ef4ff05db9da0c8427a0", "patch": "@@ -338,10 +338,10 @@ struct S {\n }\n \"#####,\n         r#####\"\n-type Type = (u8, u8, u8);\n+type ${0:Type} = (u8, u8, u8);\n \n struct S {\n-    field: Type,\n+    field: ${0:Type},\n }\n \"#####,\n     )"}]}