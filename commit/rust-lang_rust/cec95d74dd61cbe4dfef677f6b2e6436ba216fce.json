{"sha": "cec95d74dd61cbe4dfef677f6b2e6436ba216fce", "node_id": "C_kwDOAAsO6NoAKGNlYzk1ZDc0ZGQ2MWNiZTRkZmVmNjc3ZjZiMmU2NDM2YmEyMTZmY2U", "commit": {"author": {"name": "Trevor Gross", "email": "tmgross@umich.edu", "date": "2023-06-10T03:55:26Z"}, "committer": {"name": "Trevor Gross", "email": "tmgross@umich.edu", "date": "2023-06-10T03:56:12Z"}, "message": "Add deprecation warning for python <3.6 in x.py\n\nSoft deprecate old python versions to give users a warning that\neventually it may not be supported.", "tree": {"sha": "dc6003595a7b6217f0fd83d825550c1f847d3206", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/dc6003595a7b6217f0fd83d825550c1f847d3206"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cec95d74dd61cbe4dfef677f6b2e6436ba216fce", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cec95d74dd61cbe4dfef677f6b2e6436ba216fce", "html_url": "https://github.com/rust-lang/rust/commit/cec95d74dd61cbe4dfef677f6b2e6436ba216fce", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cec95d74dd61cbe4dfef677f6b2e6436ba216fce/comments", "author": {"login": "tgross35", "id": 13724985, "node_id": "MDQ6VXNlcjEzNzI0OTg1", "avatar_url": "https://avatars.githubusercontent.com/u/13724985?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tgross35", "html_url": "https://github.com/tgross35", "followers_url": "https://api.github.com/users/tgross35/followers", "following_url": "https://api.github.com/users/tgross35/following{/other_user}", "gists_url": "https://api.github.com/users/tgross35/gists{/gist_id}", "starred_url": "https://api.github.com/users/tgross35/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tgross35/subscriptions", "organizations_url": "https://api.github.com/users/tgross35/orgs", "repos_url": "https://api.github.com/users/tgross35/repos", "events_url": "https://api.github.com/users/tgross35/events{/privacy}", "received_events_url": "https://api.github.com/users/tgross35/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tgross35", "id": 13724985, "node_id": "MDQ6VXNlcjEzNzI0OTg1", "avatar_url": "https://avatars.githubusercontent.com/u/13724985?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tgross35", "html_url": "https://github.com/tgross35", "followers_url": "https://api.github.com/users/tgross35/followers", "following_url": "https://api.github.com/users/tgross35/following{/other_user}", "gists_url": "https://api.github.com/users/tgross35/gists{/gist_id}", "starred_url": "https://api.github.com/users/tgross35/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tgross35/subscriptions", "organizations_url": "https://api.github.com/users/tgross35/orgs", "repos_url": "https://api.github.com/users/tgross35/repos", "events_url": "https://api.github.com/users/tgross35/events{/privacy}", "received_events_url": "https://api.github.com/users/tgross35/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "397641f3bd4f4211d0a1e9ada8d477bf495735b2", "url": "https://api.github.com/repos/rust-lang/rust/commits/397641f3bd4f4211d0a1e9ada8d477bf495735b2", "html_url": "https://github.com/rust-lang/rust/commit/397641f3bd4f4211d0a1e9ada8d477bf495735b2"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "7163df5cfe99b0d63419d31ef0de2796208a438b", "filename": "x.py", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/cec95d74dd61cbe4dfef677f6b2e6436ba216fce/x.py", "raw_url": "https://github.com/rust-lang/rust/raw/cec95d74dd61cbe4dfef677f6b2e6436ba216fce/x.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/x.py?ref=cec95d74dd61cbe4dfef677f6b2e6436ba216fce", "patch": "@@ -9,12 +9,17 @@\n if __name__ == '__main__':\n     import os\n     import sys\n+    import warnings\n+    from inspect import cleandoc\n+\n+    major = sys.version_info.major\n+    minor = sys.version_info.minor\n \n     # If this is python2, check if python3 is available and re-execute with that\n     # interpreter. Only python3 allows downloading CI LLVM.\n     #\n     # This matters if someone's system `python` is python2.\n-    if sys.version_info.major < 3:\n+    if major < 3:\n         try:\n             os.execvp(\"py\", [\"py\", \"-3\"] + sys.argv)\n         except OSError:\n@@ -24,6 +29,19 @@\n                 # Python 3 isn't available, fall back to python 2\n                 pass\n \n+    # soft deprecation of old python versions\n+    skip_check = os.environ.get(\"RUST_IGNORE_OLD_PYTHON\") == \"1\"\n+    if major < 3 or (major == 3 and minor < 6):\n+        msg = cleandoc(\"\"\"\n+            Using python {}.{} but >= 3.6 is recommended. Your python version\n+            should continue to work for the near future, but this will\n+            eventually change. If python >= 3.6 is not available on your system,\n+            please file an issue to help us understand timelines.\n+\n+            This message can be suppressed by setting `RUST_IGNORE_OLD_PYTHON=1`\n+        \"\"\".format(major, minor))\n+        warnings.warn(msg)\n+\n     rust_dir = os.path.dirname(os.path.abspath(__file__))\n     # For the import below, have Python search in src/bootstrap first.\n     sys.path.insert(0, os.path.join(rust_dir, \"src\", \"bootstrap\"))"}]}