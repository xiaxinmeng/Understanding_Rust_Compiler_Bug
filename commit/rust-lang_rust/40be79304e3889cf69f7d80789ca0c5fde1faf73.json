{"sha": "40be79304e3889cf69f7d80789ca0c5fde1faf73", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQwYmU3OTMwNGUzODg5Y2Y2OWY3ZDgwNzg5Y2EwYzVmZGUxZmFmNzM=", "commit": {"author": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2015-04-28T10:19:25Z"}, "committer": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2015-04-28T10:19:25Z"}, "message": "Tweak rules around attributes for modules", "tree": {"sha": "4c0e5914e2aed79459eed72e6787b5d6c826b73d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4c0e5914e2aed79459eed72e6787b5d6c826b73d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/40be79304e3889cf69f7d80789ca0c5fde1faf73", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/40be79304e3889cf69f7d80789ca0c5fde1faf73", "html_url": "https://github.com/rust-lang/rust/commit/40be79304e3889cf69f7d80789ca0c5fde1faf73", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/40be79304e3889cf69f7d80789ca0c5fde1faf73/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "81b8eb7993897345120e112561a355dc51a6802f", "url": "https://api.github.com/repos/rust-lang/rust/commits/81b8eb7993897345120e112561a355dc51a6802f", "html_url": "https://github.com/rust-lang/rust/commit/81b8eb7993897345120e112561a355dc51a6802f"}], "stats": {"total": 15, "additions": 12, "deletions": 3}, "files": [{"sha": "8d360ab3376befed9c835fc62d38f09130933245", "filename": "src/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/40be79304e3889cf69f7d80789ca0c5fde1faf73/src%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/40be79304e3889cf69f7d80789ca0c5fde1faf73/src%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmod.rs?ref=40be79304e3889cf69f7d80789ca0c5fde1faf73", "patch": "@@ -265,7 +265,7 @@ fn run(args: Vec<String>, write_mode: WriteMode) {\n fn main() {\n     let args: Vec<_> = std::env::args().collect();\n     //run(args, WriteMode::Display);\n-    run(args, WriteMode::NewFile(\"new\"));\n+    run(args, WriteMode::Overwrite);\n     std::env::set_exit_status(0);\n \n     // TODO unit tests"}, {"sha": "8825a0947925386912925c88c4c523ada24870f5", "filename": "src/visitor.rs", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/40be79304e3889cf69f7d80789ca0c5fde1faf73/src%2Fvisitor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/40be79304e3889cf69f7d80789ca0c5fde1faf73/src%2Fvisitor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fvisitor.rs?ref=40be79304e3889cf69f7d80789ca0c5fde1faf73", "patch": "@@ -109,8 +109,17 @@ impl<'a, 'v> visit::Visitor<'v> for FmtVisitor<'a> {\n     }\n \n     fn visit_item(&mut self, item: &'v ast::Item) {\n-        if self.visit_attrs(&item.attrs) {\n-            return;\n+        // Don't look at attributes for modules.\n+        // We want to avoid looking at attributes in another file, which the AST\n+        // doesn't distinguish. FIXME This is overly conservative and means we miss\n+        // attributes on inline modules.\n+        match item.node {\n+            ast::Item_::ItemMod(_) => {}\n+            _ => {\n+                if self.visit_attrs(&item.attrs) {\n+                    return;\n+                }\n+            }\n         }\n \n         match item.node {"}]}