{"sha": "d57192d5c17e3af2b1e73b26e5d35ac4af3e7160", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ1NzE5MmQ1YzE3ZTNhZjJiMWU3M2IyNmU1ZDM1YWM0YWYzZTcxNjA=", "commit": {"author": {"name": "Oliver 'ker' Schneider", "email": "git-spam-no-reply9815368754983@oli-obk.de", "date": "2016-06-25T16:12:29Z"}, "committer": {"name": "Oliver 'ker' Schneider", "email": "git-spam-no-reply9815368754983@oli-obk.de", "date": "2016-06-25T16:12:29Z"}, "message": "don't depend on regex_macros anymore", "tree": {"sha": "cf4d169f1d69700c2bceccf23b144b0e60dc8871", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cf4d169f1d69700c2bceccf23b144b0e60dc8871"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160", "html_url": "https://github.com/rust-lang/rust/commit/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e25d732750c89771c05dcc9b4c71a8d2ea7854f3", "url": "https://api.github.com/repos/rust-lang/rust/commits/e25d732750c89771c05dcc9b4c71a8d2ea7854f3", "html_url": "https://github.com/rust-lang/rust/commit/e25d732750c89771c05dcc9b4c71a8d2ea7854f3"}], "stats": {"total": 97, "additions": 49, "deletions": 48}, "files": [{"sha": "34e50956cc56b8b1a4d912866bd384c4f4a465c7", "filename": ".travis.yml", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160/.travis.yml", "raw_url": "https://github.com/rust-lang/rust/raw/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160/.travis.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.travis.yml?ref=d57192d5c17e3af2b1e73b26e5d35ac4af3e7160", "patch": "@@ -26,13 +26,6 @@ script:\n  - cd clippy_lints && PATH=$PATH:~/rust/cargo/bin cargo clippy -- -D clippy && cd ..\n \n after_success:\n-# only test regex_macros if it compiles\n-- |\n-    #!/bin/bash\n-    cargo test --no-run --features 'debugging test-regex_macros'\n-    if [ \"$?\" != 101 ]; then\n-        cargo test --features 'debugging test-regex_macros' compile_test\n-    fi\n # trigger rebuild of the clippy-service, to keep it up to date with clippy itself\n - |\n     #!/bin/bash"}, {"sha": "9b68a7364ff1804488e13718211a58915d98f3d9", "filename": "Cargo.toml", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160/Cargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160/Cargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.toml?ref=d57192d5c17e3af2b1e73b26e5d35ac4af3e7160", "patch": "@@ -24,17 +24,17 @@ name = \"cargo-clippy\"\n test = false\n \n [dependencies]\n-regex_macros = { version = \"0.1.33\", optional = true }\n # begin automatic update\n clippy_lints = { version = \"0.0.77\", path = \"clippy_lints\" }\n # end automatic update\n \n [dev-dependencies]\n compiletest_rs = \"0.2.0\"\n lazy_static = \"0.1.15\"\n-regex = \"0.1.56\"\n+regex = \"0.1.71\"\n rustc-serialize = \"0.3\"\n+mini-macro = { version = \"0.1\", path = \"mini-macro\" }\n+\n \n [features]\n debugging = []\n-test-regex_macros = [\"regex_macros\"]"}, {"sha": "171e5dd81727ba98f9c40464131e406f2d187191", "filename": "mini-macro/Cargo.toml", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160/mini-macro%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160/mini-macro%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mini-macro%2FCargo.toml?ref=d57192d5c17e3af2b1e73b26e5d35ac4af3e7160", "patch": "@@ -0,0 +1,16 @@\n+[package]\n+name = \"mini-macro\"\n+version = \"0.1.0\"\n+authors = [\n+\t\"Manish Goregaokar <manishsmail@gmail.com>\",\n+\t\"Andre Bogus <bogusandre@gmail.com>\",\n+\t\"Georg Brandl <georg@python.org>\",\n+\t\"Martin Carton <cartonmartin@gmail.com>\",\n+\t\"Oliver Schneider <clippy-iethah7aipeen8neex1a@oli-obk.de>\"\n+]\n+\n+[lib]\n+name = \"mini_macro\"\n+plugin = true\n+\n+[dependencies]"}, {"sha": "699d17d4d70ca1dd00b4d06632251da62f6d8be3", "filename": "mini-macro/src/lib.rs", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160/mini-macro%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160/mini-macro%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mini-macro%2Fsrc%2Flib.rs?ref=d57192d5c17e3af2b1e73b26e5d35ac4af3e7160", "patch": "@@ -0,0 +1,22 @@\n+#![feature(plugin_registrar, rustc_private)]\n+\n+extern crate syntax;\n+extern crate rustc;\n+extern crate rustc_plugin;\n+\n+use syntax::codemap::Span;\n+use syntax::ast::TokenTree;\n+use syntax::ext::base::{ExtCtxt, MacResult, MacEager};\n+use syntax::ext::build::AstBuilder;  // trait for expr_usize\n+use rustc_plugin::Registry;\n+\n+fn expand_macro(cx: &mut ExtCtxt, sp: Span, _: &[TokenTree]) -> Box<MacResult + 'static> {\n+    let e = cx.expr_usize(sp, 42);\n+    let e = cx.expr_mut_addr_of(sp, e);\n+    MacEager::expr(cx.expr_mut_addr_of(sp, e))\n+}\n+\n+#[plugin_registrar]\n+pub fn plugin_registrar(reg: &mut Registry) {\n+    reg.register_macro(\"mini_macro\", expand_macro);\n+}"}, {"sha": "aab196fb79545b039d9392af4d0e73cccab22446", "filename": "tests/compile-fail-regex_macros/regex.rs", "status": "removed", "additions": 0, "deletions": 12, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/e25d732750c89771c05dcc9b4c71a8d2ea7854f3/tests%2Fcompile-fail-regex_macros%2Fregex.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e25d732750c89771c05dcc9b4c71a8d2ea7854f3/tests%2Fcompile-fail-regex_macros%2Fregex.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail-regex_macros%2Fregex.rs?ref=e25d732750c89771c05dcc9b4c71a8d2ea7854f3", "patch": "@@ -1,12 +0,0 @@\n-#![feature(plugin)]\n-#![plugin(clippy, regex_macros)]\n-\n-#![allow(unused)]\n-#![deny(invalid_regex, trivial_regex, regex_macro)]\n-\n-extern crate regex;\n-\n-fn main() {\n-    let some_regex = regex!(\"for real!\"); //~ERROR `regex!(_)`\n-    let other_regex = regex!(\"[a-z]_[A-Z]\"); //~ERROR `regex!(_)`\n-}"}, {"sha": "d21d97509241f24c4b225c486ee30dc3b5e26736", "filename": "tests/compile-test.rs", "status": "modified", "additions": 1, "deletions": 14, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160/tests%2Fcompile-test.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160/tests%2Fcompile-test.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-test.rs?ref=d57192d5c17e3af2b1e73b26e5d35ac4af3e7160", "patch": "@@ -1,7 +1,7 @@\n extern crate compiletest_rs as compiletest;\n \n use std::path::PathBuf;\n-use std::env::{set_var, var, temp_dir};\n+use std::env::{set_var, var};\n \n fn run_mode(dir: &'static str, mode: &'static str) {\n     let mut config = compiletest::default_config();\n@@ -14,10 +14,6 @@ fn run_mode(dir: &'static str, mode: &'static str) {\n     }\n \n     config.mode = cfg_mode;\n-    if cfg!(windows) {\n-        // work around https://github.com/laumann/compiletest-rs/issues/35 on msvc windows\n-        config.build_base = temp_dir();\n-    }\n     config.src_base = PathBuf::from(format!(\"tests/{}\", dir));\n \n     compiletest::run_tests(&config);\n@@ -28,17 +24,8 @@ fn prepare_env() {\n }\n \n #[test]\n-#[cfg(not(feature = \"test-regex_macros\"))]\n fn compile_test() {\n     prepare_env();\n     run_mode(\"run-pass\", \"run-pass\");\n     run_mode(\"compile-fail\", \"compile-fail\");\n }\n-\n-#[test]\n-#[cfg(feature = \"test-regex_macros\")]\n-fn compile_test() {\n-    prepare_env();\n-    run_mode(\"run-pass-regex_macros\", \"run-pass\");\n-    run_mode(\"compile-fail-regex_macros\", \"compile-fail\");\n-}"}, {"sha": "92b44dbdd482ec510f5d50a35af63741c72d9e5a", "filename": "tests/run-pass-regex_macros/mut_mut_macro.rs", "status": "removed", "additions": 0, "deletions": 12, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/e25d732750c89771c05dcc9b4c71a8d2ea7854f3/tests%2Frun-pass-regex_macros%2Fmut_mut_macro.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e25d732750c89771c05dcc9b4c71a8d2ea7854f3/tests%2Frun-pass-regex_macros%2Fmut_mut_macro.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass-regex_macros%2Fmut_mut_macro.rs?ref=e25d732750c89771c05dcc9b4c71a8d2ea7854f3", "patch": "@@ -1,12 +0,0 @@\n-#![feature(plugin)]\n-#![plugin(clippy, regex_macros)]\n-\n-#[macro_use]\n-extern crate regex;\n-\n-#[deny(mut_mut)]\n-#[allow(regex_macro)]\n-fn main() {\n-    let pattern = regex!(r\"^(?P<level>[#]+)\\s(?P<title>.+)$\");\n-    assert!(pattern.is_match(\"# headline\"));\n-}"}, {"sha": "68d86a4d394293177f2d8a618da0fb8ceae9ce5c", "filename": "tests/run-pass/procedural_macro.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160/tests%2Frun-pass%2Fprocedural_macro.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d57192d5c17e3af2b1e73b26e5d35ac4af3e7160/tests%2Frun-pass%2Fprocedural_macro.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fprocedural_macro.rs?ref=d57192d5c17e3af2b1e73b26e5d35ac4af3e7160", "patch": "@@ -0,0 +1,7 @@\n+#![feature(plugin)]\n+#![plugin(clippy, mini_macro)]\n+\n+#[deny(warnings)]\n+fn main() {\n+    let _ = mini_macro!();\n+}"}]}