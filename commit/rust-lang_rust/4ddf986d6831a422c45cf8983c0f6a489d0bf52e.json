{"sha": "4ddf986d6831a422c45cf8983c0f6a489d0bf52e", "node_id": "C_kwDOAAsO6NoAKDRkZGY5ODZkNjgzMWE0MjJjNDVjZjg5ODNjMGY2YTQ4OWQwYmY1MmU", "commit": {"author": {"name": "Eric Huss", "email": "eric@huss.org", "date": "2022-01-30T16:37:49Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-01-30T16:37:49Z"}, "message": "Rollup merge of #93183 - jsha:mobile-nav-fixes, r=GuillaumeGomez\n\nrustdoc: mobile nav fixes\n\n- Make sure the mobile-topbar doesn't overflow its height if the user sets a bigger font.\n\n- Make sure the sidebar can be scrolled all the way to the bottom by shortening it to accommodate the mobile-topbar.\n\n- Make the item name in the mobile-topbar clickable to go to the top of the page.\n\n- Remove excess padding sidebar in mobile mode.\n\nDemo https://rustdoc.crud.net/jsha/mobile-nav-fixes/std/string/struct.String.html\n\nr? `@GuillaumeGomez`", "tree": {"sha": "0c939fc1bd6930b6d697d64754a640a2ffa31c02", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0c939fc1bd6930b6d697d64754a640a2ffa31c02"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4ddf986d6831a422c45cf8983c0f6a489d0bf52e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJh9r7dCRBK7hj4Ov3rIwAAb4sIAIZxqJeTgW/Xuua987Rhck+d\noWBvWlQKrULNORGk9IA2DDwfDAgmACsuNTPS2Or1zKUBHdHP4rVQDCzFT2QIhCuw\ns/f277QZGcwW9WZ4fSW/75+ohGJYR8z5DwT19OkTqtn1aZ4LNQlPPnEXBTqndkKB\n91wLMWnLd826WGGVRpUjNofSC4vKjNXq6xb5Odj5AQLfQAD5KzZTWw6L0MTe6iUV\nAQfyOgIFLCrmblXvEy2ggTzGAHArSKNToPZtVnnqxGQNpevGooJIJzNffD8bXCqx\njQ0ud4WgdKqUqz+/8DDy4HhEVC5TNteN1T7EPnAaOeVDBsyUyK4jChAfgLdAUxU=\n=42lC\n-----END PGP SIGNATURE-----\n", "payload": "tree 0c939fc1bd6930b6d697d64754a640a2ffa31c02\nparent ba013373d8aad473d2b6c6c90bb876cd45f53164\nparent a998a374769f80e08fb7e1269b6fcd886ce453cf\nauthor Eric Huss <eric@huss.org> 1643560669 -0800\ncommitter GitHub <noreply@github.com> 1643560669 -0800\n\nRollup merge of #93183 - jsha:mobile-nav-fixes, r=GuillaumeGomez\n\nrustdoc: mobile nav fixes\n\n- Make sure the mobile-topbar doesn't overflow its height if the user sets a bigger font.\n\n- Make sure the sidebar can be scrolled all the way to the bottom by shortening it to accommodate the mobile-topbar.\n\n- Make the item name in the mobile-topbar clickable to go to the top of the page.\n\n- Remove excess padding sidebar in mobile mode.\n\nDemo https://rustdoc.crud.net/jsha/mobile-nav-fixes/std/string/struct.String.html\n\nr? `@GuillaumeGomez`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4ddf986d6831a422c45cf8983c0f6a489d0bf52e", "html_url": "https://github.com/rust-lang/rust/commit/4ddf986d6831a422c45cf8983c0f6a489d0bf52e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/comments", "author": {"login": "ehuss", "id": 43198, "node_id": "MDQ6VXNlcjQzMTk4", "avatar_url": "https://avatars.githubusercontent.com/u/43198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehuss", "html_url": "https://github.com/ehuss", "followers_url": "https://api.github.com/users/ehuss/followers", "following_url": "https://api.github.com/users/ehuss/following{/other_user}", "gists_url": "https://api.github.com/users/ehuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehuss/subscriptions", "organizations_url": "https://api.github.com/users/ehuss/orgs", "repos_url": "https://api.github.com/users/ehuss/repos", "events_url": "https://api.github.com/users/ehuss/events{/privacy}", "received_events_url": "https://api.github.com/users/ehuss/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ba013373d8aad473d2b6c6c90bb876cd45f53164", "url": "https://api.github.com/repos/rust-lang/rust/commits/ba013373d8aad473d2b6c6c90bb876cd45f53164", "html_url": "https://github.com/rust-lang/rust/commit/ba013373d8aad473d2b6c6c90bb876cd45f53164"}, {"sha": "a998a374769f80e08fb7e1269b6fcd886ce453cf", "url": "https://api.github.com/repos/rust-lang/rust/commits/a998a374769f80e08fb7e1269b6fcd886ce453cf", "html_url": "https://github.com/rust-lang/rust/commit/a998a374769f80e08fb7e1269b6fcd886ce453cf"}], "stats": {"total": 30, "additions": 26, "deletions": 4}, "files": [{"sha": "87403a8b83417d16bd1ddf283180d3289b8f5455", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=4ddf986d6831a422c45cf8983c0f6a489d0bf52e", "patch": "@@ -1799,8 +1799,9 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n \t\tbackground-color: rgba(0,0,0,0);\n \t\tmargin: 0;\n \t\tpadding: 0;\n-\t\tpadding-left: 15px;\n \t\tz-index: 11;\n+\t\t/* Reduce height slightly to account for mobile topbar. */\n+\t\theight: calc(100vh - 45px);\n \t}\n \n \t/* The source view uses a different design for the sidebar toggle, and doesn't have a topbar,\n@@ -1831,7 +1832,13 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n \t\tpadding: 0.3em;\n \t\tpadding-right: 0.6em;\n \t\ttext-overflow: ellipsis;\n-\t\toverflow-x: hidden;\n+\t\toverflow: hidden;\n+\t\twhite-space: nowrap;\n+\t\t/* Rare exception to specifying font sizes in rem. Since the topbar\n+\t\t   height is specified in pixels, this also has to be specified in\n+\t\t   pixels to avoid overflowing the topbar when the user sets a bigger\n+\t\t   font size. */\n+\t\tfont-size: 22.4px;\n \t}\n \n \t.mobile-topbar .logo-container {\n@@ -1864,6 +1871,9 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n \n \t.sidebar-menu-toggle {\n \t\twidth: 45px;\n+\t\t/* Rare exception to specifying font sizes in rem. Since this is acting\n+\t\t   as an icon, it's okay to specify its sizes in pixels. */\n+\t\tfont-size: 32px;\n \t\tborder: none;\n \t}\n "}, {"sha": "cee45e1de39b11fb686557a0bccde8c9e55922d4", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=4ddf986d6831a422c45cf8983c0f6a489d0bf52e", "patch": "@@ -216,6 +216,7 @@ a.anchor,\n pre.rust a,\n .sidebar h2 a,\n .sidebar h3 a,\n+.mobile-topbar h2 a,\n .in-band a {\n \tcolor: #c5c5c5;\n }"}, {"sha": "c5817ba4e73598cf9516ff9f69c24018d2bcdd0e", "filename": "src/librustdoc/html/static/css/themes/dark.css", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css?ref=4ddf986d6831a422c45cf8983c0f6a489d0bf52e", "patch": "@@ -192,6 +192,7 @@ a.anchor,\n pre.rust a,\n .sidebar h2 a,\n .sidebar h3 a,\n+.mobile-topbar h2 a,\n .in-band a {\n \tcolor: #ddd;\n }"}, {"sha": "3d2cd23ae3aa8262b10bdbcbf5624712b690a55b", "filename": "src/librustdoc/html/static/css/themes/light.css", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css?ref=4ddf986d6831a422c45cf8983c0f6a489d0bf52e", "patch": "@@ -189,6 +189,7 @@ a.anchor,\n pre.rust a,\n .sidebar h2 a,\n .sidebar h3 a,\n+.mobile-topbar h2 a,\n .in-band a {\n \tcolor: #000;\n }"}, {"sha": "3c21a96cef02a4b812815bfd6db9f42de60e1e56", "filename": "src/librustdoc/html/static/js/main.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js?ref=4ddf986d6831a422c45cf8983c0f6a489d0bf52e", "patch": "@@ -72,7 +72,7 @@ function resourcePath(basename, extension) {\n         var mobileLocationTitle = document.querySelector(\".mobile-topbar h2.location\");\n         var locationTitle = document.querySelector(\".sidebar h2.location\");\n         if (mobileLocationTitle && locationTitle) {\n-            mobileLocationTitle.innerText = locationTitle.innerText;\n+            mobileLocationTitle.innerHTML = locationTitle.innerHTML;\n         }\n     }\n }());"}, {"sha": "8f9c9248f5ff1e4edf132b60ad222a92e9c80cd4", "filename": "src/test/rustdoc-gui/mobile.goml", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Ftest%2Frustdoc-gui%2Fmobile.goml", "raw_url": "https://github.com/rust-lang/rust/raw/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Ftest%2Frustdoc-gui%2Fmobile.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fmobile.goml?ref=4ddf986d6831a422c45cf8983c0f6a489d0bf52e", "patch": "@@ -2,13 +2,17 @@\n goto: file://|DOC_PATH|/staged_api/struct.Foo.html\n size: (400, 600)\n \n+font-size: 18\n+\n // The out-of-band info (source, stable version, collapse) should be below the\n // h1 when the screen gets narrow enough.\n assert-css: (\".main-heading\", {\n   \"display\": \"flex\",\n   \"flex-direction\": \"column\"\n })\n \n+assert-property: (\".mobile-topbar h2.location\", {\"offsetHeight\": 45})\n+\n // Note: We can't use assert-text here because the 'Since' is set by CSS and\n // is therefore not part of the DOM.\n assert-css: (\".content .out-of-band .since::before\", { \"content\": \"\\\"Since \\\"\" })"}, {"sha": "60bcffe120beca8385c09f91fdd79427f077b9d2", "filename": "src/test/rustdoc-gui/sidebar-mobile.goml", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Ftest%2Frustdoc-gui%2Fsidebar-mobile.goml", "raw_url": "https://github.com/rust-lang/rust/raw/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Ftest%2Frustdoc-gui%2Fsidebar-mobile.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsidebar-mobile.goml?ref=4ddf986d6831a422c45cf8983c0f6a489d0bf52e", "patch": "@@ -35,3 +35,8 @@ assert-property: (\".mobile-topbar\", {\"clientHeight\": \"45\"})\n click: \".sidebar-menu-toggle\"\n click: \".sidebar-links a\"\n assert-position: (\"#method\\.must_use\", {\"y\": 45})\n+\n+// Check that the bottom-most item on the sidebar menu can be scrolled fully into view.\n+click: \".sidebar-menu-toggle\"\n+scroll-to: \".block.keyword li:nth-child(1)\"\n+assert-position: (\".block.keyword li:nth-child(1)\", {\"y\": 542.96875})"}, {"sha": "229c6d6ba6b9682f454fb5af4baa1d7b3c903d54", "filename": "src/test/rustdoc-gui/type-declation-overflow.goml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Ftest%2Frustdoc-gui%2Ftype-declation-overflow.goml", "raw_url": "https://github.com/rust-lang/rust/raw/4ddf986d6831a422c45cf8983c0f6a489d0bf52e/src%2Ftest%2Frustdoc-gui%2Ftype-declation-overflow.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Ftype-declation-overflow.goml?ref=4ddf986d6831a422c45cf8983c0f6a489d0bf52e", "patch": "@@ -31,6 +31,6 @@ assert-property: (\".item-decl pre\", {\"scrollWidth\": \"950\"})\n // On mobile:\n size: (600, 600)\n goto: file://|DOC_PATH|/lib2/too_long/struct.SuperIncrediblyLongLongLongLongLongLongLongGigaGigaGigaMegaLongLongLongStructName.html\n-assert-property: (\".mobile-topbar .location\", {\"scrollWidth\": \"504\"})\n+assert-property: (\".mobile-topbar .location\", {\"scrollWidth\": \"986\"})\n assert-property: (\".mobile-topbar .location\", {\"clientWidth\": \"504\"})\n assert-css: (\".mobile-topbar .location\", {\"overflow-x\": \"hidden\"})"}]}