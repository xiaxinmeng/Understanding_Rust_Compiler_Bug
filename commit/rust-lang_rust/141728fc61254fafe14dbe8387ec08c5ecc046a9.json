{"sha": "141728fc61254fafe14dbe8387ec08c5ecc046a9", "node_id": "C_kwDOAAsO6NoAKDE0MTcyOGZjNjEyNTRmYWZlMTRkYmU4Mzg3ZWMwOGM1ZWNjMDQ2YTk", "commit": {"author": {"name": "Dylan DPC", "email": "99973273+Dylan-DPC@users.noreply.github.com", "date": "2022-08-29T11:19:44Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-08-29T11:19:44Z"}, "message": "Rollup merge of #100934 - a1phyr:improve_fmt_PadAdapter, r=Mark-Simulacrum\n\nRemove a panicking branch from `fmt::builders::PadAdapter`", "tree": {"sha": "f4b94f581959f39efd7415d0f923702759515fb0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f4b94f581959f39efd7415d0f923702759515fb0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/141728fc61254fafe14dbe8387ec08c5ecc046a9", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjDKDQCRBK7hj4Ov3rIwAAqf0IAB+APj0ZwUHntVHBpKxrmmAG\n4WRNjEI1Ib2X5waQ99xYCuL8O+cr1HHcNF5u+IUenELrpgN9LtY87ux6G2HSSM5t\nu4gflVey/40obQr+bDNLWFkEVCvjVxY5ENwh/xdmwl7NkSWII2ozGPIQc4/yrz8t\n3ekdmfYLLRdd3D9jx7l5/nnIsYthdmOnYQC/cXXNb2oM7psPU/+n68JT3/xEVbTg\naOHUtA9Xe9Q61Y2Jb6xUvjz0s8CLHQeWV3c+j2BowSy1FcH8vWkPCKFtqPHEsxJf\nO6NwRpdmTq3ZxI/EUtnJFc7GEgsRZ3dFy5dnhKQeO3FG2UWHVaqjfJAnhVuTv/0=\n=yJb3\n-----END PGP SIGNATURE-----\n", "payload": "tree f4b94f581959f39efd7415d0f923702759515fb0\nparent 395ce34a95653d9c07e71567cf1b1070742868f3\nparent 3aa6fe376d776aa62a89d7b7ef4929eda51ce034\nauthor Dylan DPC <99973273+Dylan-DPC@users.noreply.github.com> 1661771984 +0530\ncommitter GitHub <noreply@github.com> 1661771984 +0530\n\nRollup merge of #100934 - a1phyr:improve_fmt_PadAdapter, r=Mark-Simulacrum\n\nRemove a panicking branch from `fmt::builders::PadAdapter`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/141728fc61254fafe14dbe8387ec08c5ecc046a9", "html_url": "https://github.com/rust-lang/rust/commit/141728fc61254fafe14dbe8387ec08c5ecc046a9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/141728fc61254fafe14dbe8387ec08c5ecc046a9/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "395ce34a95653d9c07e71567cf1b1070742868f3", "url": "https://api.github.com/repos/rust-lang/rust/commits/395ce34a95653d9c07e71567cf1b1070742868f3", "html_url": "https://github.com/rust-lang/rust/commit/395ce34a95653d9c07e71567cf1b1070742868f3"}, {"sha": "3aa6fe376d776aa62a89d7b7ef4929eda51ce034", "url": "https://api.github.com/repos/rust-lang/rust/commits/3aa6fe376d776aa62a89d7b7ef4929eda51ce034", "html_url": "https://github.com/rust-lang/rust/commit/3aa6fe376d776aa62a89d7b7ef4929eda51ce034"}], "stats": {"total": 18, "additions": 4, "deletions": 14}, "files": [{"sha": "7da49b04aaae99cd51f8c48cc6a15296b7283061", "filename": "library/core/src/fmt/builders.rs", "status": "modified", "additions": 4, "deletions": 14, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/141728fc61254fafe14dbe8387ec08c5ecc046a9/library%2Fcore%2Fsrc%2Ffmt%2Fbuilders.rs", "raw_url": "https://github.com/rust-lang/rust/raw/141728fc61254fafe14dbe8387ec08c5ecc046a9/library%2Fcore%2Fsrc%2Ffmt%2Fbuilders.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Ffmt%2Fbuilders.rs?ref=141728fc61254fafe14dbe8387ec08c5ecc046a9", "patch": "@@ -28,24 +28,14 @@ impl<'buf, 'state> PadAdapter<'buf, 'state> {\n }\n \n impl fmt::Write for PadAdapter<'_, '_> {\n-    fn write_str(&mut self, mut s: &str) -> fmt::Result {\n-        while !s.is_empty() {\n+    fn write_str(&mut self, s: &str) -> fmt::Result {\n+        for s in s.split_inclusive('\\n') {\n             if self.state.on_newline {\n                 self.buf.write_str(\"    \")?;\n             }\n \n-            let split = match s.find('\\n') {\n-                Some(pos) => {\n-                    self.state.on_newline = true;\n-                    pos + 1\n-                }\n-                None => {\n-                    self.state.on_newline = false;\n-                    s.len()\n-                }\n-            };\n-            self.buf.write_str(&s[..split])?;\n-            s = &s[split..];\n+            self.state.on_newline = s.ends_with('\\n');\n+            self.buf.write_str(s)?;\n         }\n \n         Ok(())"}]}