{"sha": "d194676667f256e08dfb9fbc536d53d92bf8910f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQxOTQ2NzY2NjdmMjU2ZTA4ZGZiOWZiYzUzNmQ1M2Q5MmJmODkxMGY=", "commit": {"author": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2020-02-19T05:28:56Z"}, "committer": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2020-02-19T05:29:06Z"}, "message": "Remove special case for `simd_shuffle` arg promotion\n\nAfter rust-lang/stdarch#825, these intrinsics are now defined with\n`#[rustc_args_required_const(2)]`, so the special-case is no longer\nnecessary.", "tree": {"sha": "28740e0490ff45224581a702343aa8ff6b5b30f5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/28740e0490ff45224581a702343aa8ff6b5b30f5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d194676667f256e08dfb9fbc536d53d92bf8910f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d194676667f256e08dfb9fbc536d53d92bf8910f", "html_url": "https://github.com/rust-lang/rust/commit/d194676667f256e08dfb9fbc536d53d92bf8910f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d194676667f256e08dfb9fbc536d53d92bf8910f/comments", "author": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e0e5d82e1677c82d209b214bbfc2cc5705c2336a", "url": "https://api.github.com/repos/rust-lang/rust/commits/e0e5d82e1677c82d209b214bbfc2cc5705c2336a", "html_url": "https://github.com/rust-lang/rust/commit/e0e5d82e1677c82d209b214bbfc2cc5705c2336a"}], "stats": {"total": 12, "additions": 0, "deletions": 12}, "files": [{"sha": "9db9ab0de0b7fc0c32510104c24c9b34f4e4d125", "filename": "src/librustc_mir/transform/promote_consts.rs", "status": "modified", "additions": 0, "deletions": 12, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/d194676667f256e08dfb9fbc536d53d92bf8910f/src%2Flibrustc_mir%2Ftransform%2Fpromote_consts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d194676667f256e08dfb9fbc536d53d92bf8910f/src%2Flibrustc_mir%2Ftransform%2Fpromote_consts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Ftransform%2Fpromote_consts.rs?ref=d194676667f256e08dfb9fbc536d53d92bf8910f", "patch": "@@ -24,7 +24,6 @@ use rustc_span::{Span, DUMMY_SP};\n use syntax::ast::LitKind;\n \n use rustc_index::vec::{Idx, IndexVec};\n-use rustc_target::spec::abi::Abi;\n \n use std::cell::Cell;\n use std::{cmp, iter, mem, usize};\n@@ -218,17 +217,6 @@ impl<'tcx> Visitor<'tcx> for Collector<'_, 'tcx> {\n \n         if let TerminatorKind::Call { ref func, .. } = *kind {\n             if let ty::FnDef(def_id, _) = func.ty(self.body, self.tcx).kind {\n-                let fn_sig = self.tcx.fn_sig(def_id);\n-                if let Abi::RustIntrinsic | Abi::PlatformIntrinsic = fn_sig.abi() {\n-                    let name = self.tcx.item_name(def_id);\n-                    // FIXME(eddyb) use `#[rustc_args_required_const(2)]` for shuffles.\n-                    if name.as_str().starts_with(\"simd_shuffle\") {\n-                        self.candidates.push(Candidate::Argument { bb: location.block, index: 2 });\n-\n-                        return; // Don't double count `simd_shuffle` candidates\n-                    }\n-                }\n-\n                 if let Some(constant_args) = args_required_const(self.tcx, def_id) {\n                     for index in constant_args {\n                         self.candidates.push(Candidate::Argument { bb: location.block, index });"}]}