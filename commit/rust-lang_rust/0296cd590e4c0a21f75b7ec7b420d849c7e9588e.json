{"sha": "0296cd590e4c0a21f75b7ec7b420d849c7e9588e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAyOTZjZDU5MGU0YzBhMjFmNzViN2VjN2I0MjBkODQ5YzdlOTU4OGU=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2021-03-06T20:02:06Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2021-03-07T08:12:59Z"}, "message": ":arrow_up: xflags", "tree": {"sha": "1b57a3f77193cbd62c22f65720575e5e765674cc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1b57a3f77193cbd62c22f65720575e5e765674cc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0296cd590e4c0a21f75b7ec7b420d849c7e9588e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0296cd590e4c0a21f75b7ec7b420d849c7e9588e", "html_url": "https://github.com/rust-lang/rust/commit/0296cd590e4c0a21f75b7ec7b420d849c7e9588e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0296cd590e4c0a21f75b7ec7b420d849c7e9588e/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "71b8fb7c572eb658ee1136f086d6348aafba1e1d", "url": "https://api.github.com/repos/rust-lang/rust/commits/71b8fb7c572eb658ee1136f086d6348aafba1e1d", "html_url": "https://github.com/rust-lang/rust/commit/71b8fb7c572eb658ee1136f086d6348aafba1e1d"}], "stats": {"total": 44, "additions": 23, "deletions": 21}, "files": [{"sha": "c392a89070442593609444e3f485bd0f4d5cdb06", "filename": "Cargo.lock", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/0296cd590e4c0a21f75b7ec7b420d849c7e9588e/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/0296cd590e4c0a21f75b7ec7b420d849c7e9588e/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=0296cd590e4c0a21f75b7ec7b420d849c7e9588e", "patch": "@@ -1919,18 +1919,18 @@ checksum = \"06069a848f95fceae3e5e03c0ddc8cb78452b56654ee0c8e68f938cf790fb9e3\"\n \n [[package]]\n name = \"xflags\"\n-version = \"0.1.4\"\n+version = \"0.2.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"222e914b43cec5d7305ac5116d10a14b3a52c50e9062d642c92631f3beabc729\"\n+checksum = \"59ad6ce6a0b7224130015b4ebac796478ac04e0079f5d222a690efea06a9208a\"\n dependencies = [\n  \"xflags-macros\",\n ]\n \n [[package]]\n name = \"xflags-macros\"\n-version = \"0.1.4\"\n+version = \"0.2.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"52f18f5b4aa7f95e209d5b9274f6164c3938920b4d5c75f97f0dd16daee25ddd\"\n+checksum = \"c8037d3ca14996158b03c0fa905d0834906ef0fc7044df72c1f5ff690e5e62c9\"\n dependencies = [\n  \"proc-macro2\",\n ]"}, {"sha": "3130785ccc5acf7405cfa49142492e5bdf1134af", "filename": "crates/rust-analyzer/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0296cd590e4c0a21f75b7ec7b420d849c7e9588e/crates%2Frust-analyzer%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/0296cd590e4c0a21f75b7ec7b420d849c7e9588e/crates%2Frust-analyzer%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2FCargo.toml?ref=0296cd590e4c0a21f75b7ec7b420d849c7e9588e", "patch": "@@ -24,7 +24,7 @@ jod-thread = \"0.1.0\"\n log = \"0.4.8\"\n lsp-types = { version = \"0.88.0\", features = [\"proposed\"] }\n parking_lot = \"0.11.0\"\n-xflags = \"0.1.2\"\n+xflags = \"0.2.1\"\n oorandom = \"11.1.2\"\n rustc-hash = \"1.1.0\"\n serde = { version = \"1.0.106\", features = [\"derive\"] }"}, {"sha": "3a7caaf3fcb9c446b798a28e07c527983752c9dc", "filename": "crates/rust-analyzer/src/bin/flags.rs", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/0296cd590e4c0a21f75b7ec7b420d849c7e9588e/crates%2Frust-analyzer%2Fsrc%2Fbin%2Fflags.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0296cd590e4c0a21f75b7ec7b420d849c7e9588e/crates%2Frust-analyzer%2Fsrc%2Fbin%2Fflags.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fbin%2Fflags.rs?ref=0296cd590e4c0a21f75b7ec7b420d849c7e9588e", "patch": "@@ -6,7 +6,9 @@ use ide_ssr::{SsrPattern, SsrRule};\n use rust_analyzer::cli::{BenchWhat, Position, Verbosity};\n use vfs::AbsPathBuf;\n \n-xflags::args_parser! {\n+xflags::xflags! {\n+    src \"./src/bin/flags.rs\"\n+\n     /// LSP server for the Rust programming language.\n     cmd rust-analyzer {\n         /// Verbosity level, can be repeated multiple times.\n@@ -120,7 +122,7 @@ xflags::args_parser! {\n \n // generated start\n // The following code is generated by `xflags` macro.\n-// Run `env XFLAGS_DUMP= cargo build` to regenerate.\n+// Run `env UPDATE_XFLAGS=1 cargo build` to regenerate.\n #[derive(Debug)]\n pub struct RustAnalyzer {\n     pub verbose: u32,\n@@ -158,7 +160,7 @@ pub struct Parse {\n }\n \n #[derive(Debug)]\n-pub struct Symbols {}\n+pub struct Symbols;\n \n #[derive(Debug)]\n pub struct Highlight {\n@@ -211,14 +213,13 @@ pub struct Search {\n }\n \n #[derive(Debug)]\n-pub struct ProcMacro {}\n+pub struct ProcMacro;\n \n impl RustAnalyzer {\n-    pub const HELP: &'static str = Self::_HELP;\n+    pub const HELP: &'static str = Self::HELP_;\n \n     pub fn from_env() -> xflags::Result<Self> {\n-        let mut p = xflags::rt::Parser::new_from_env();\n-        Self::_parse(&mut p)\n+        Self::from_env_()\n     }\n }\n // generated end"}, {"sha": "e084f0df65d047b4fe08e1d3f0c02a9b89029bf9", "filename": "xtask/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0296cd590e4c0a21f75b7ec7b420d849c7e9588e/xtask%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/0296cd590e4c0a21f75b7ec7b420d849c7e9588e/xtask%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/xtask%2FCargo.toml?ref=0296cd590e4c0a21f75b7ec7b420d849c7e9588e", "patch": "@@ -15,5 +15,5 @@ ungrammar = \"=1.11\"\n walkdir = \"2.3.1\"\n write-json = \"0.1.0\"\n xshell = \"0.1\"\n-xflags = \"0.1.2\"\n+xflags = \"0.2.1\"\n # Avoid adding more dependencies to this crate"}, {"sha": "b39d937cac7dc3ad821e489d9e41a5fb269687b7", "filename": "xtask/src/flags.rs", "status": "modified", "additions": 9, "deletions": 8, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/0296cd590e4c0a21f75b7ec7b420d849c7e9588e/xtask%2Fsrc%2Fflags.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0296cd590e4c0a21f75b7ec7b420d849c7e9588e/xtask%2Fsrc%2Fflags.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/xtask%2Fsrc%2Fflags.rs?ref=0296cd590e4c0a21f75b7ec7b420d849c7e9588e", "patch": "@@ -2,7 +2,9 @@\n \n use crate::install::{ClientOpt, Malloc, ServerOpt};\n \n-xflags::args_parser! {\n+xflags::xflags! {\n+    src \"./src/flags.rs\"\n+\n     /// Run custom build command.\n     cmd xtask {\n         default cmd help {\n@@ -55,7 +57,7 @@ xflags::args_parser! {\n \n // generated start\n // The following code is generated by `xflags` macro.\n-// Run `env XFLAGS_DUMP= cargo build` to regenerate.\n+// Run `env UPDATE_XFLAGS=1 cargo build` to regenerate.\n #[derive(Debug)]\n pub struct Xtask {\n     pub subcommand: XtaskCmd,\n@@ -96,13 +98,13 @@ pub struct Codegen {\n }\n \n #[derive(Debug)]\n-pub struct Lint {}\n+pub struct Lint;\n \n #[derive(Debug)]\n-pub struct FuzzTests {}\n+pub struct FuzzTests;\n \n #[derive(Debug)]\n-pub struct PreCache {}\n+pub struct PreCache;\n \n #[derive(Debug)]\n pub struct Release {\n@@ -131,11 +133,10 @@ pub struct Bb {\n }\n \n impl Xtask {\n-    pub const HELP: &'static str = Self::_HELP;\n+    pub const HELP: &'static str = Self::HELP_;\n \n     pub fn from_env() -> xflags::Result<Self> {\n-        let mut p = xflags::rt::Parser::new_from_env();\n-        Self::_parse(&mut p)\n+        Self::from_env_()\n     }\n }\n // generated end"}]}