{"sha": "b3856568af3a21bfd13584e06fce852f84811fdb", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIzODU2NTY4YWYzYTIxYmZkMTM1ODRlMDZmY2U4NTJmODQ4MTFmZGI=", "commit": {"author": {"name": "Wilco Kusee", "email": "wilcokusee@gmail.com", "date": "2019-11-29T15:06:20Z"}, "committer": {"name": "Wilco Kusee", "email": "wilcokusee@gmail.com", "date": "2019-11-29T15:06:20Z"}, "message": "Push identifier check to rename function", "tree": {"sha": "260eca3225c76cfbea645a0cbaeafb12d855e01f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/260eca3225c76cfbea645a0cbaeafb12d855e01f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b3856568af3a21bfd13584e06fce852f84811fdb", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQEcBAABAgAGBQJd4TPsAAoJENWyu1zcMzS8ss4H/263Qo29A4LnMV2frt34U8by\nfHFNjHAk40XXr1UcUDmAhFqIkbaoniT9Nrlh1mE6HjA6fnt8sXDfOX5Lkw2FS2aT\nyOsv2r/wqlMA5tR0oLdDblXVZsnd00qLpAO5B6yDDpZSLy0w9gWHoQO671uKrjgK\nir9GzHp+6cepCWJ2lidUD5ZlPoj/vjN5GPuQQzJbq3ioGWPtAGMKOnqjuc28QpNm\njXmiFBqD2JjTUY/Nc5WnY/f+VDSi9Xf4W+W3Aow/a9Pt43aVg+J4I14fU9W5ut/g\nmHvFft8XuyyOnZtv0A14pGq05iUFTOHmGx2coIc3BPJAXZ/F2Fa4tyT1DUT1KKE=\n=S4ky\n-----END PGP SIGNATURE-----", "payload": "tree 260eca3225c76cfbea645a0cbaeafb12d855e01f\nparent 645df2b5f5664b7730293d8f7441364799aacbf9\nauthor Wilco Kusee <wilcokusee@gmail.com> 1575039980 +0100\ncommitter Wilco Kusee <wilcokusee@gmail.com> 1575039980 +0100\n\nPush identifier check to rename function\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b3856568af3a21bfd13584e06fce852f84811fdb", "html_url": "https://github.com/rust-lang/rust/commit/b3856568af3a21bfd13584e06fce852f84811fdb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b3856568af3a21bfd13584e06fce852f84811fdb/comments", "author": {"login": "detrumi", "id": 5758008, "node_id": "MDQ6VXNlcjU3NTgwMDg=", "avatar_url": "https://avatars.githubusercontent.com/u/5758008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/detrumi", "html_url": "https://github.com/detrumi", "followers_url": "https://api.github.com/users/detrumi/followers", "following_url": "https://api.github.com/users/detrumi/following{/other_user}", "gists_url": "https://api.github.com/users/detrumi/gists{/gist_id}", "starred_url": "https://api.github.com/users/detrumi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/detrumi/subscriptions", "organizations_url": "https://api.github.com/users/detrumi/orgs", "repos_url": "https://api.github.com/users/detrumi/repos", "events_url": "https://api.github.com/users/detrumi/events{/privacy}", "received_events_url": "https://api.github.com/users/detrumi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "detrumi", "id": 5758008, "node_id": "MDQ6VXNlcjU3NTgwMDg=", "avatar_url": "https://avatars.githubusercontent.com/u/5758008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/detrumi", "html_url": "https://github.com/detrumi", "followers_url": "https://api.github.com/users/detrumi/followers", "following_url": "https://api.github.com/users/detrumi/following{/other_user}", "gists_url": "https://api.github.com/users/detrumi/gists{/gist_id}", "starred_url": "https://api.github.com/users/detrumi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/detrumi/subscriptions", "organizations_url": "https://api.github.com/users/detrumi/orgs", "repos_url": "https://api.github.com/users/detrumi/repos", "events_url": "https://api.github.com/users/detrumi/events{/privacy}", "received_events_url": "https://api.github.com/users/detrumi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "645df2b5f5664b7730293d8f7441364799aacbf9", "url": "https://api.github.com/repos/rust-lang/rust/commits/645df2b5f5664b7730293d8f7441364799aacbf9", "html_url": "https://github.com/rust-lang/rust/commit/645df2b5f5664b7730293d8f7441364799aacbf9"}], "stats": {"total": 18, "additions": 9, "deletions": 9}, "files": [{"sha": "d1bff4a761eb8be29bdc95c526cda036578b14b9", "filename": "crates/ra_ide/src/lib.rs", "status": "modified", "additions": 1, "deletions": 8, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/b3856568af3a21bfd13584e06fce852f84811fdb/crates%2Fra_ide%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b3856568af3a21bfd13584e06fce852f84811fdb/crates%2Fra_ide%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide%2Fsrc%2Flib.rs?ref=b3856568af3a21bfd13584e06fce852f84811fdb", "patch": "@@ -56,7 +56,7 @@ use ra_db::{\n     salsa::{self, ParallelDatabase},\n     CheckCanceled, Env, FileLoader, SourceDatabase,\n };\n-use ra_syntax::{tokenize, SourceFile, SyntaxKind, TextRange, TextUnit};\n+use ra_syntax::{SourceFile, TextRange, TextUnit};\n \n use crate::{db::LineIndexDatabase, display::ToNav, symbol_index::FileSymbol};\n \n@@ -470,13 +470,6 @@ impl Analysis {\n         position: FilePosition,\n         new_name: &str,\n     ) -> Cancelable<Option<RangeInfo<SourceChange>>> {\n-        let tokens = tokenize(new_name);\n-        if tokens.len() != 1\n-            || (tokens[0].kind != SyntaxKind::IDENT && tokens[0].kind != SyntaxKind::UNDERSCORE)\n-        {\n-            return Ok(None);\n-        }\n-\n         self.with_db(|db| references::rename(db, position, new_name))\n     }\n "}, {"sha": "b804d5f6dac2098f0ead08ccfaa133c16a82a122", "filename": "crates/ra_ide/src/references/rename.rs", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/b3856568af3a21bfd13584e06fce852f84811fdb/crates%2Fra_ide%2Fsrc%2Freferences%2Frename.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b3856568af3a21bfd13584e06fce852f84811fdb/crates%2Fra_ide%2Fsrc%2Freferences%2Frename.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide%2Fsrc%2Freferences%2Frename.rs?ref=b3856568af3a21bfd13584e06fce852f84811fdb", "patch": "@@ -2,7 +2,7 @@\n \n use hir::ModuleSource;\n use ra_db::{RelativePath, RelativePathBuf, SourceDatabase, SourceDatabaseExt};\n-use ra_syntax::{algo::find_node_at_offset, ast, AstNode, SyntaxNode};\n+use ra_syntax::{algo::find_node_at_offset, ast, tokenize, AstNode, SyntaxKind, SyntaxNode};\n use ra_text_edit::TextEdit;\n \n use crate::{\n@@ -17,6 +17,13 @@ pub(crate) fn rename(\n     position: FilePosition,\n     new_name: &str,\n ) -> Option<RangeInfo<SourceChange>> {\n+    let tokens = tokenize(new_name);\n+    if tokens.len() != 1\n+        || (tokens[0].kind != SyntaxKind::IDENT && tokens[0].kind != SyntaxKind::UNDERSCORE)\n+    {\n+        return None;\n+    }\n+\n     let parse = db.parse(position.file_id);\n     if let Some((ast_name, ast_module)) =\n         find_name_and_module_at_offset(parse.tree().syntax(), position)"}]}