{"sha": "f77fd90affcf794354ca8d120e9cc55dc64f4cf1", "node_id": "C_kwDOAAsO6NoAKGY3N2ZkOTBhZmZjZjc5NDM1NGNhOGQxMjBlOWNjNTVkYzY0ZjRjZjE", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2022-05-01T17:58:24Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2022-05-11T09:43:27Z"}, "message": "ast: Introduce some traits to get AST node properties generically\n\nAnd use them to avoid constructing some artificial `Nonterminal` tokens during expansion", "tree": {"sha": "3ca8316e497030846578d739c6fa7b01a454a840", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3ca8316e497030846578d739c6fa7b01a454a840"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f77fd90affcf794354ca8d120e9cc55dc64f4cf1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f77fd90affcf794354ca8d120e9cc55dc64f4cf1", "html_url": "https://github.com/rust-lang/rust/commit/f77fd90affcf794354ca8d120e9cc55dc64f4cf1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f77fd90affcf794354ca8d120e9cc55dc64f4cf1/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8fcf113743a06756a024ecae49a571d96d9bc24e", "url": "https://api.github.com/repos/rust-lang/rust/commits/8fcf113743a06756a024ecae49a571d96d9bc24e", "html_url": "https://github.com/rust-lang/rust/commit/8fcf113743a06756a024ecae49a571d96d9bc24e"}], "stats": {"total": 17, "additions": 3, "deletions": 14}, "files": [{"sha": "41ba9a847e67a0bc2bf4167aac630782e8e3be2a", "filename": "src/attr.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f77fd90affcf794354ca8d120e9cc55dc64f4cf1/src%2Fattr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f77fd90affcf794354ca8d120e9cc55dc64f4cf1/src%2Fattr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fattr.rs?ref=f77fd90affcf794354ca8d120e9cc55dc64f4cf1", "patch": "@@ -1,7 +1,7 @@\n //! Format attributes and meta items.\n \n use rustc_ast::ast;\n-use rustc_ast::AstLike;\n+use rustc_ast::HasAttrs;\n use rustc_span::{symbol::sym, Span, Symbol};\n \n use self::doc_comment::DocCommentFormatter;"}, {"sha": "ebadf3dd598bd1e0b49b15eacc2cd9eeaacd059a", "filename": "src/formatting.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f77fd90affcf794354ca8d120e9cc55dc64f4cf1/src%2Fformatting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f77fd90affcf794354ca8d120e9cc55dc64f4cf1/src%2Fformatting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fformatting.rs?ref=f77fd90affcf794354ca8d120e9cc55dc64f4cf1", "patch": "@@ -5,7 +5,6 @@ use std::io::{self, Write};\n use std::time::{Duration, Instant};\n \n use rustc_ast::ast;\n-use rustc_ast::AstLike;\n use rustc_span::Span;\n \n use self::newline_style::apply_newline_style;"}, {"sha": "81da724329f02edc918bc6eaf5b91e76238dc011", "filename": "src/modules.rs", "status": "modified", "additions": 1, "deletions": 11, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/f77fd90affcf794354ca8d120e9cc55dc64f4cf1/src%2Fmodules.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f77fd90affcf794354ca8d120e9cc55dc64f4cf1/src%2Fmodules.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmodules.rs?ref=f77fd90affcf794354ca8d120e9cc55dc64f4cf1", "patch": "@@ -4,7 +4,6 @@ use std::path::{Path, PathBuf};\n \n use rustc_ast::ast;\n use rustc_ast::visit::Visitor;\n-use rustc_ast::AstLike;\n use rustc_span::symbol::{self, sym, Symbol};\n use rustc_span::Span;\n use thiserror::Error;\n@@ -50,19 +49,10 @@ impl<'a> Module<'a> {\n             ast_mod_kind,\n         }\n     }\n-}\n \n-impl<'a> AstLike for Module<'a> {\n-    const SUPPORTS_CUSTOM_INNER_ATTRS: bool = true;\n-    fn attrs(&self) -> &[ast::Attribute] {\n+    pub(crate) fn attrs(&self) -> &[ast::Attribute] {\n         &self.inner_attr\n     }\n-    fn visit_attrs(&mut self, f: impl FnOnce(&mut Vec<ast::Attribute>)) {\n-        f(&mut self.inner_attr)\n-    }\n-    fn tokens_mut(&mut self) -> Option<&mut Option<rustc_ast::tokenstream::LazyTokenStream>> {\n-        unimplemented!()\n-    }\n }\n \n /// Maps each module to the corresponding file."}, {"sha": "9a0e0752c12f5ed3ec755a389ac1cd696a647fd5", "filename": "src/visitor.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f77fd90affcf794354ca8d120e9cc55dc64f4cf1/src%2Fvisitor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f77fd90affcf794354ca8d120e9cc55dc64f4cf1/src%2Fvisitor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fvisitor.rs?ref=f77fd90affcf794354ca8d120e9cc55dc64f4cf1", "patch": "@@ -1,7 +1,7 @@\n use std::cell::{Cell, RefCell};\n use std::rc::Rc;\n \n-use rustc_ast::{ast, token::Delimiter, visit, AstLike};\n+use rustc_ast::{ast, token::Delimiter, visit};\n use rustc_data_structures::sync::Lrc;\n use rustc_span::{symbol, BytePos, Pos, Span};\n "}]}