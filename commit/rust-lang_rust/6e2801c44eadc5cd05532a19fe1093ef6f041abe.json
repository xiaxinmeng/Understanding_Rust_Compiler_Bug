{"sha": "6e2801c44eadc5cd05532a19fe1093ef6f041abe", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZlMjgwMWM0NGVhZGM1Y2QwNTUzMmExOWZlMTA5M2VmNmYwNDFhYmU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-02-28T03:56:16Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-02-28T03:56:16Z"}, "message": "Auto merge of #82594 - nagisa:nagisa/remove-rumprun, r=petrochenkov\n\nRemove the x86_64-rumprun-netbsd target\n\nHerein we remove the target from the compiler and the code from libstd intended to support the now-defunct rumprun project.\n\nCloses #81514", "tree": {"sha": "bccc9f718b26c9b959ecd8b20a40ad7af8ca50dd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bccc9f718b26c9b959ecd8b20a40ad7af8ca50dd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6e2801c44eadc5cd05532a19fe1093ef6f041abe", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6e2801c44eadc5cd05532a19fe1093ef6f041abe", "html_url": "https://github.com/rust-lang/rust/commit/6e2801c44eadc5cd05532a19fe1093ef6f041abe", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6e2801c44eadc5cd05532a19fe1093ef6f041abe/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "130b2ab0ed272f93dd5d019e72ac1fd4b4a77323", "url": "https://api.github.com/repos/rust-lang/rust/commits/130b2ab0ed272f93dd5d019e72ac1fd4b4a77323", "html_url": "https://github.com/rust-lang/rust/commit/130b2ab0ed272f93dd5d019e72ac1fd4b4a77323"}, {"sha": "a757fae24596e936b819a8974054eca95d95a58e", "url": "https://api.github.com/repos/rust-lang/rust/commits/a757fae24596e936b819a8974054eca95d95a58e", "html_url": "https://github.com/rust-lang/rust/commit/a757fae24596e936b819a8974054eca95d95a58e"}], "stats": {"total": 72, "additions": 4, "deletions": 68}, "files": [{"sha": "b53d851e051bc2fbab5e552b9662bb117f34e12b", "filename": "compiler/rustc_target/src/spec/mod.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/6e2801c44eadc5cd05532a19fe1093ef6f041abe/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6e2801c44eadc5cd05532a19fe1093ef6f041abe/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs?ref=6e2801c44eadc5cd05532a19fe1093ef6f041abe", "patch": "@@ -702,7 +702,6 @@ supported_targets! {\n     (\"powerpc-unknown-netbsd\", powerpc_unknown_netbsd),\n     (\"sparc64-unknown-netbsd\", sparc64_unknown_netbsd),\n     (\"x86_64-unknown-netbsd\", x86_64_unknown_netbsd),\n-    (\"x86_64-rumprun-netbsd\", x86_64_rumprun_netbsd),\n \n     (\"i686-unknown-haiku\", i686_unknown_haiku),\n     (\"x86_64-unknown-haiku\", x86_64_unknown_haiku),"}, {"sha": "d84a63562c70ae2b01e91d3b48dd2e12c99b5195", "filename": "compiler/rustc_target/src/spec/x86_64_rumprun_netbsd.rs", "status": "removed", "additions": 0, "deletions": 25, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/130b2ab0ed272f93dd5d019e72ac1fd4b4a77323/compiler%2Frustc_target%2Fsrc%2Fspec%2Fx86_64_rumprun_netbsd.rs", "raw_url": "https://github.com/rust-lang/rust/raw/130b2ab0ed272f93dd5d019e72ac1fd4b4a77323/compiler%2Frustc_target%2Fsrc%2Fspec%2Fx86_64_rumprun_netbsd.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Fx86_64_rumprun_netbsd.rs?ref=130b2ab0ed272f93dd5d019e72ac1fd4b4a77323", "patch": "@@ -1,25 +0,0 @@\n-use crate::spec::{LinkerFlavor, StackProbeType, Target, TargetOptions};\n-\n-pub fn target() -> Target {\n-    let mut base = super::netbsd_base::opts();\n-    base.vendor = \"rumprun\".to_string();\n-    base.cpu = \"x86-64\".to_string();\n-    base.pre_link_args.get_mut(&LinkerFlavor::Gcc).unwrap().push(\"-m64\".to_string());\n-    base.linker = Some(\"x86_64-rumprun-netbsd-gcc\".to_string());\n-    base.max_atomic_width = Some(64);\n-\n-    base.dynamic_linking = false;\n-    base.has_rpath = false;\n-    base.position_independent_executables = false;\n-    base.disable_redzone = true;\n-    base.stack_probes = StackProbeType::InlineOrCall { min_llvm_version_for_inline: (11, 0, 1) };\n-\n-    Target {\n-        llvm_target: \"x86_64-rumprun-netbsd\".to_string(),\n-        pointer_width: 64,\n-        data_layout: \"e-m:e-p270:32:32-p271:32:32-p272:64:64-i64:64-f80:128-n8:16:32:64-S128\"\n-            .to_string(),\n-        arch: \"x86_64\".to_string(),\n-        options: TargetOptions { mcount: \"__mcount\".to_string(), ..base },\n-    }\n-}"}, {"sha": "d7bba50c76ab831cf30a2d162c239b0d9c31c567", "filename": "library/std/src/sys/unix/stack_overflow.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/6e2801c44eadc5cd05532a19fe1093ef6f041abe/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fstack_overflow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6e2801c44eadc5cd05532a19fe1093ef6f041abe/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fstack_overflow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fstack_overflow.rs?ref=6e2801c44eadc5cd05532a19fe1093ef6f041abe", "patch": "@@ -34,7 +34,7 @@ impl Drop for Handler {\n     target_os = \"freebsd\",\n     target_os = \"solaris\",\n     target_os = \"illumos\",\n-    all(target_os = \"netbsd\", not(target_vendor = \"rumprun\")),\n+    target_os = \"netbsd\",\n     target_os = \"openbsd\"\n ))]\n mod imp {\n@@ -218,7 +218,7 @@ mod imp {\n     target_os = \"freebsd\",\n     target_os = \"solaris\",\n     target_os = \"illumos\",\n-    all(target_os = \"netbsd\", not(target_vendor = \"rumprun\")),\n+    target_os = \"netbsd\",\n     target_os = \"openbsd\",\n )))]\n mod imp {"}, {"sha": "40c9630751416208735ef7dbdd546ba3782b4456", "filename": "library/std/src/sys/unix/thread.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/6e2801c44eadc5cd05532a19fe1093ef6f041abe/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fthread.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6e2801c44eadc5cd05532a19fe1093ef6f041abe/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fthread.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fthread.rs?ref=6e2801c44eadc5cd05532a19fe1093ef6f041abe", "patch": "@@ -202,7 +202,7 @@ impl Drop for Thread {\n     not(target_os = \"linux\"),\n     not(target_os = \"freebsd\"),\n     not(target_os = \"macos\"),\n-    not(all(target_os = \"netbsd\", not(target_vendor = \"rumprun\"))),\n+    not(target_os = \"netbsd\"),\n     not(target_os = \"openbsd\"),\n     not(target_os = \"solaris\")\n ))]\n@@ -222,7 +222,7 @@ pub mod guard {\n     target_os = \"linux\",\n     target_os = \"freebsd\",\n     target_os = \"macos\",\n-    all(target_os = \"netbsd\", not(target_vendor = \"rumprun\")),\n+    target_os = \"netbsd\",\n     target_os = \"openbsd\",\n     target_os = \"solaris\"\n ))]"}, {"sha": "d8bf152e4d638a1962986c841520a58873a6aa59", "filename": "library/unwind/build.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6e2801c44eadc5cd05532a19fe1093ef6f041abe/library%2Funwind%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6e2801c44eadc5cd05532a19fe1093ef6f041abe/library%2Funwind%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Funwind%2Fbuild.rs?ref=6e2801c44eadc5cd05532a19fe1093ef6f041abe", "patch": "@@ -22,8 +22,6 @@ fn main() {\n         }\n     } else if target.contains(\"freebsd\") {\n         println!(\"cargo:rustc-link-lib=gcc_s\");\n-    } else if target.contains(\"rumprun\") {\n-        println!(\"cargo:rustc-link-lib=unwind\");\n     } else if target.contains(\"netbsd\") {\n         println!(\"cargo:rustc-link-lib=gcc_s\");\n     } else if target.contains(\"openbsd\") {"}, {"sha": "1f8f9fc518ac17dc9d59ad81c25377179b563e5a", "filename": "src/ci/docker/host-x86_64/dist-various-1/Dockerfile", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/6e2801c44eadc5cd05532a19fe1093ef6f041abe/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-1%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/6e2801c44eadc5cd05532a19fe1093ef6f041abe/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-1%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-1%2FDockerfile?ref=6e2801c44eadc5cd05532a19fe1093ef6f041abe", "patch": "@@ -44,9 +44,6 @@ RUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-ins\n \n WORKDIR /build\n \n-COPY host-x86_64/dist-various-1/build-rumprun.sh /build\n-RUN ./build-rumprun.sh\n-\n COPY host-x86_64/dist-various-1/install-x86_64-redox.sh /build\n RUN ./install-x86_64-redox.sh\n \n@@ -112,7 +109,6 @@ ENV RUN_MAKE_TARGETS=$RUN_MAKE_TARGETS,thumbv7em-none-eabihf\n \n ENV TARGETS=asmjs-unknown-emscripten\n ENV TARGETS=$TARGETS,wasm32-unknown-emscripten\n-ENV TARGETS=$TARGETS,x86_64-rumprun-netbsd\n ENV TARGETS=$TARGETS,mips-unknown-linux-musl\n ENV TARGETS=$TARGETS,mipsel-unknown-linux-musl\n ENV TARGETS=$TARGETS,mips64-unknown-linux-muslabi64"}, {"sha": "bee2d7a476cbcfd3b2c345751951851fb8ddb4c8", "filename": "src/ci/docker/host-x86_64/dist-various-1/build-rumprun.sh", "status": "removed", "additions": 0, "deletions": 29, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/130b2ab0ed272f93dd5d019e72ac1fd4b4a77323/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-1%2Fbuild-rumprun.sh", "raw_url": "https://github.com/rust-lang/rust/raw/130b2ab0ed272f93dd5d019e72ac1fd4b4a77323/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-1%2Fbuild-rumprun.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-1%2Fbuild-rumprun.sh?ref=130b2ab0ed272f93dd5d019e72ac1fd4b4a77323", "patch": "@@ -1,29 +0,0 @@\n-#!/usr/bin/env bash\n-set -ex\n-\n-hide_output() {\n-  set +x\n-  on_err=\"\n-echo ERROR: An error was encountered with the build.\n-cat /tmp/build.log\n-exit 1\n-\"\n-  trap \"$on_err\" ERR\n-  bash -c \"while true; do sleep 30; echo \\$(date) - building ...; done\" &\n-  PING_LOOP_PID=$!\n-  \"$@\" &> /tmp/build.log\n-  trap - ERR\n-  kill $PING_LOOP_PID\n-  rm /tmp/build.log\n-  set -x\n-}\n-\n-git clone https://github.com/rumpkernel/rumprun\n-cd rumprun\n-git reset --hard b04d42225a12a6fae57a78a9c1cf23642e46cd00\n-git submodule update --init\n-\n-# Disable -Werror, to avoid breaking the build with newer compilers.\n-CC=cc NOGCCERROR=1 hide_output ./build-rr.sh -d /usr/local hw\n-cd ..\n-rm -rf rumprun"}, {"sha": "a4ace91730ec352b1f6c378927ddc669c928e45d", "filename": "src/doc/rustc/src/platform-support.md", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/6e2801c44eadc5cd05532a19fe1093ef6f041abe/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md", "raw_url": "https://github.com/rust-lang/rust/raw/6e2801c44eadc5cd05532a19fe1093ef6f041abe/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md?ref=6e2801c44eadc5cd05532a19fe1093ef6f041abe", "patch": "@@ -133,7 +133,6 @@ target | std | host | notes\n `x86_64-fortanix-unknown-sgx` | \u2713 |  | [Fortanix ABI] for 64-bit Intel SGX\n `x86_64-fuchsia` | \u2713 |  | 64-bit Fuchsia\n `x86_64-linux-android` | \u2713 |  | 64-bit x86 Android\n-`x86_64-rumprun-netbsd` | \u2713 |  | 64-bit NetBSD Rump Kernel\n `x86_64-sun-solaris` | \u2713 |  | 64-bit Solaris 10/11, illumos\n `x86_64-unknown-freebsd` | \u2713 | \u2713 | 64-bit FreeBSD\n `x86_64-unknown-illumos` | \u2713 | \u2713 | illumos"}, {"sha": "c544d1f41ce0b6b8b279782bb3fcda083c1e0731", "filename": "src/librustdoc/clean/cfg.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/6e2801c44eadc5cd05532a19fe1093ef6f041abe/src%2Flibrustdoc%2Fclean%2Fcfg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6e2801c44eadc5cd05532a19fe1093ef6f041abe/src%2Flibrustdoc%2Fclean%2Fcfg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Fcfg.rs?ref=6e2801c44eadc5cd05532a19fe1093ef6f041abe", "patch": "@@ -505,7 +505,6 @@ impl<'a> fmt::Display for Display<'a> {\n                     (sym::target_vendor, Some(vendor)) => match &*vendor.as_str() {\n                         \"apple\" => \"Apple\",\n                         \"pc\" => \"PC\",\n-                        \"rumprun\" => \"Rumprun\",\n                         \"sun\" => \"Sun\",\n                         \"fortanix\" => \"Fortanix\",\n                         _ => \"\","}, {"sha": "4e605caafe22e95cd74118f629c43b9ba23f9bad", "filename": "src/tools/build-manifest/src/main.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/6e2801c44eadc5cd05532a19fe1093ef6f041abe/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6e2801c44eadc5cd05532a19fe1093ef6f041abe/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs?ref=6e2801c44eadc5cd05532a19fe1093ef6f041abe", "patch": "@@ -139,7 +139,6 @@ static TARGETS: &[&str] = &[\n     \"x86_64-linux-android\",\n     \"x86_64-pc-windows-gnu\",\n     \"x86_64-pc-windows-msvc\",\n-    \"x86_64-rumprun-netbsd\",\n     \"x86_64-sun-solaris\",\n     \"x86_64-pc-solaris\",\n     \"x86_64-unknown-freebsd\","}]}