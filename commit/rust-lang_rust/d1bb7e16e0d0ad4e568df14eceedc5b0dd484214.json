{"sha": "d1bb7e16e0d0ad4e568df14eceedc5b0dd484214", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQxYmI3ZTE2ZTBkMGFkNGU1NjhkZjE0ZWNlZWRjNWIwZGQ0ODQyMTQ=", "commit": {"author": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2020-01-21T14:50:22Z"}, "committer": {"name": "Shotaro Yamada", "email": "sinkuu@sinkuu.xyz", "date": "2020-01-21T23:10:05Z"}, "message": "Privatize private fields of OutputFilenames", "tree": {"sha": "0ec18da65c7f9b93d28c98ab800cd38d6e9b5fb8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0ec18da65c7f9b93d28c98ab800cd38d6e9b5fb8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d1bb7e16e0d0ad4e568df14eceedc5b0dd484214", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d1bb7e16e0d0ad4e568df14eceedc5b0dd484214", "html_url": "https://github.com/rust-lang/rust/commit/d1bb7e16e0d0ad4e568df14eceedc5b0dd484214", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d1bb7e16e0d0ad4e568df14eceedc5b0dd484214/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "sinkuu", "id": 7091080, "node_id": "MDQ6VXNlcjcwOTEwODA=", "avatar_url": "https://avatars.githubusercontent.com/u/7091080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sinkuu", "html_url": "https://github.com/sinkuu", "followers_url": "https://api.github.com/users/sinkuu/followers", "following_url": "https://api.github.com/users/sinkuu/following{/other_user}", "gists_url": "https://api.github.com/users/sinkuu/gists{/gist_id}", "starred_url": "https://api.github.com/users/sinkuu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sinkuu/subscriptions", "organizations_url": "https://api.github.com/users/sinkuu/orgs", "repos_url": "https://api.github.com/users/sinkuu/repos", "events_url": "https://api.github.com/users/sinkuu/events{/privacy}", "received_events_url": "https://api.github.com/users/sinkuu/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b5a3341f1b8b475990e9d1b071b88d3c280936b4", "url": "https://api.github.com/repos/rust-lang/rust/commits/b5a3341f1b8b475990e9d1b071b88d3c280936b4", "html_url": "https://github.com/rust-lang/rust/commit/b5a3341f1b8b475990e9d1b071b88d3c280936b4"}], "stats": {"total": 47, "additions": 26, "deletions": 21}, "files": [{"sha": "3e65da9c47b7e8c6454984434bc4aa36b922e296", "filename": "src/librustc_interface/util.rs", "status": "modified", "additions": 14, "deletions": 19, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/d1bb7e16e0d0ad4e568df14eceedc5b0dd484214/src%2Flibrustc_interface%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d1bb7e16e0d0ad4e568df14eceedc5b0dd484214/src%2Flibrustc_interface%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2Futil.rs?ref=d1bb7e16e0d0ad4e568df14eceedc5b0dd484214", "patch": "@@ -550,13 +550,13 @@ pub fn build_output_filenames(\n                 .or_else(|| attr::find_crate_name(attrs).map(|n| n.to_string()))\n                 .unwrap_or_else(|| input.filestem().to_owned());\n \n-            OutputFilenames {\n-                out_directory: dirpath,\n-                out_filestem: stem,\n-                single_output_file: None,\n-                extra: sess.opts.cg.extra_filename.clone(),\n-                outputs: sess.opts.output_types.clone(),\n-            }\n+            OutputFilenames::new(\n+                dirpath,\n+                stem,\n+                None,\n+                sess.opts.cg.extra_filename.clone(),\n+                sess.opts.output_types.clone(),\n+            )\n         }\n \n         Some(ref out_file) => {\n@@ -578,18 +578,13 @@ pub fn build_output_filenames(\n                 sess.warn(\"ignoring --out-dir flag due to -o flag\");\n             }\n \n-            OutputFilenames {\n-                out_directory: out_file.parent().unwrap_or_else(|| Path::new(\"\")).to_path_buf(),\n-                out_filestem: out_file\n-                    .file_stem()\n-                    .unwrap_or_default()\n-                    .to_str()\n-                    .unwrap()\n-                    .to_string(),\n-                single_output_file: ofile,\n-                extra: sess.opts.cg.extra_filename.clone(),\n-                outputs: sess.opts.output_types.clone(),\n-            }\n+            OutputFilenames::new(\n+                out_file.parent().unwrap_or_else(|| Path::new(\"\")).to_path_buf(),\n+                out_file.file_stem().unwrap_or_default().to_str().unwrap().to_string(),\n+                ofile,\n+                sess.opts.cg.extra_filename.clone(),\n+                sess.opts.output_types.clone(),\n+            )\n         }\n     }\n }"}, {"sha": "08960cd44984b547c06385021b3791fb24c7ace1", "filename": "src/librustc_session/config.rs", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/d1bb7e16e0d0ad4e568df14eceedc5b0dd484214/src%2Flibrustc_session%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d1bb7e16e0d0ad4e568df14eceedc5b0dd484214/src%2Flibrustc_session%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_session%2Fconfig.rs?ref=d1bb7e16e0d0ad4e568df14eceedc5b0dd484214", "patch": "@@ -447,9 +447,9 @@ impl Input {\n #[derive(Clone, Hash)]\n pub struct OutputFilenames {\n     pub out_directory: PathBuf,\n-    pub out_filestem: String,\n+    out_filestem: String,\n     pub single_output_file: Option<PathBuf>,\n-    pub extra: String,\n+    extra: String,\n     pub outputs: OutputTypes,\n }\n \n@@ -458,6 +458,16 @@ impl_stable_hash_via_hash!(OutputFilenames);\n pub const RUST_CGU_EXT: &str = \"rcgu\";\n \n impl OutputFilenames {\n+    pub fn new(\n+        out_directory: PathBuf,\n+        out_filestem: String,\n+        single_output_file: Option<PathBuf>,\n+        extra: String,\n+        outputs: OutputTypes,\n+    ) -> Self {\n+        OutputFilenames { out_directory, out_filestem, single_output_file, extra, outputs }\n+    }\n+\n     pub fn path(&self, flavor: OutputType) -> PathBuf {\n         self.outputs\n             .get(&flavor)"}]}