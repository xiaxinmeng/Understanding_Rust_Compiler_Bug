{"sha": "e620a1d57cb1a49b1c6e7e45c19f9102dc0876d3", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU2MjBhMWQ1N2NiMWE0OWIxYzZlN2U0NWMxOWY5MTAyZGMwODc2ZDM=", "commit": {"author": {"name": "Devon Hollowood", "email": "devonhollowood@gmail.com", "date": "2015-12-16T23:28:06Z"}, "committer": {"name": "Devon Hollowood", "email": "devonhollowood@gmail.com", "date": "2015-12-17T01:28:26Z"}, "message": "Make suggested changes", "tree": {"sha": "91b25354f8919491dcb8a6ce54fd53b78fbc2524", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/91b25354f8919491dcb8a6ce54fd53b78fbc2524"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e620a1d57cb1a49b1c6e7e45c19f9102dc0876d3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e620a1d57cb1a49b1c6e7e45c19f9102dc0876d3", "html_url": "https://github.com/rust-lang/rust/commit/e620a1d57cb1a49b1c6e7e45c19f9102dc0876d3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e620a1d57cb1a49b1c6e7e45c19f9102dc0876d3/comments", "author": {"login": "devonhollowood", "id": 7864326, "node_id": "MDQ6VXNlcjc4NjQzMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/7864326?v=4", "gravatar_id": "", "url": "https://api.github.com/users/devonhollowood", "html_url": "https://github.com/devonhollowood", "followers_url": "https://api.github.com/users/devonhollowood/followers", "following_url": "https://api.github.com/users/devonhollowood/following{/other_user}", "gists_url": "https://api.github.com/users/devonhollowood/gists{/gist_id}", "starred_url": "https://api.github.com/users/devonhollowood/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/devonhollowood/subscriptions", "organizations_url": "https://api.github.com/users/devonhollowood/orgs", "repos_url": "https://api.github.com/users/devonhollowood/repos", "events_url": "https://api.github.com/users/devonhollowood/events{/privacy}", "received_events_url": "https://api.github.com/users/devonhollowood/received_events", "type": "User", "site_admin": false}, "committer": {"login": "devonhollowood", "id": 7864326, "node_id": "MDQ6VXNlcjc4NjQzMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/7864326?v=4", "gravatar_id": "", "url": "https://api.github.com/users/devonhollowood", "html_url": "https://github.com/devonhollowood", "followers_url": "https://api.github.com/users/devonhollowood/followers", "following_url": "https://api.github.com/users/devonhollowood/following{/other_user}", "gists_url": "https://api.github.com/users/devonhollowood/gists{/gist_id}", "starred_url": "https://api.github.com/users/devonhollowood/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/devonhollowood/subscriptions", "organizations_url": "https://api.github.com/users/devonhollowood/orgs", "repos_url": "https://api.github.com/users/devonhollowood/repos", "events_url": "https://api.github.com/users/devonhollowood/events{/privacy}", "received_events_url": "https://api.github.com/users/devonhollowood/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6960bf2ebc711385048834863eda081bae2633db", "url": "https://api.github.com/repos/rust-lang/rust/commits/6960bf2ebc711385048834863eda081bae2633db", "html_url": "https://github.com/rust-lang/rust/commit/6960bf2ebc711385048834863eda081bae2633db"}], "stats": {"total": 10, "additions": 3, "deletions": 7}, "files": [{"sha": "3b093027f481943ee137a343d237b5f79a0b3ef5", "filename": "src/misc.rs", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/e620a1d57cb1a49b1c6e7e45c19f9102dc0876d3/src%2Fmisc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e620a1d57cb1a49b1c6e7e45c19f9102dc0876d3/src%2Fmisc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmisc.rs?ref=e620a1d57cb1a49b1c6e7e45c19f9102dc0876d3", "patch": "@@ -9,7 +9,6 @@ use rustc::middle::ty;\n use rustc::middle::const_eval::ConstVal::Float;\n use rustc::middle::const_eval::eval_const_expr_partial;\n use rustc::middle::const_eval::EvalHint::ExprTypeChecked;\n-use rustc::middle::def::Def;\n \n use utils::{get_item_name, match_path, snippet, span_lint, walk_ptrs_ty, is_integer_literal};\n use utils::span_help_and_lint;\n@@ -327,7 +326,7 @@ impl LateLintPass for PatternPass {\n /// **Known problems:** This lint's idea of a \"used\" variable is not quite the same as in the\n /// built-in `unused_variables` lint. For example, in the following code\n /// ```\n-/// fn foo(_y: u32) -> u32) {\n+/// fn foo(y: u32) -> u32) {\n ///     let _x = 1;\n ///     _x +=1;\n ///     y\n@@ -363,10 +362,7 @@ impl LateLintPass for UsedUnderscoreBinding {\n                 ident.name.as_str().chars().next() == Some('_') //starts with '_'\n                 && ident.name.as_str().chars().skip(1).next() != Some('_') //doesn't start with \"__\"\n                 && ident.name != ident.unhygienic_name //not in macro\n-                && cx.tcx.def_map.borrow().values().any(|res| match res.base_def {\n-                                                  Def::DefLocal(_, _) => true,\n-                                                  _ => false\n-                                            }) //local variable\n+                && cx.tcx.def_map.borrow().contains_key(&expr.id) //local variable\n             },\n             ExprField(_, spanned) => {\n                 let name = spanned.node.as_str();"}, {"sha": "5567f23a9ff7f729a9352708b57bd12821d53460", "filename": "tests/compile-fail/used_underscore_binding.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e620a1d57cb1a49b1c6e7e45c19f9102dc0876d3/tests%2Fcompile-fail%2Fused_underscore_binding.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e620a1d57cb1a49b1c6e7e45c19f9102dc0876d3/tests%2Fcompile-fail%2Fused_underscore_binding.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Fused_underscore_binding.rs?ref=e620a1d57cb1a49b1c6e7e45c19f9102dc0876d3", "patch": "@@ -2,7 +2,7 @@\n #![plugin(clippy)]\n #![deny(clippy)]\n \n-fn prefix_underscore(_x: u32) -> u32{\n+fn prefix_underscore(_x: u32) -> u32 {\n     _x + 1 //~ ERROR used binding which is prefixed with an underscore\n }\n "}]}