{"sha": "f4c6d8f77c23aef7fc7a2128e99f8801b8176a09", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY0YzZkOGY3N2MyM2FlZjdmYzdhMjEyOGU5OWY4ODAxYjgxNzZhMDk=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro.albini@ferrous-systems.com", "date": "2021-07-19T13:26:47Z"}, "committer": {"name": "Pietro Albini", "email": "pietro.albini@ferrous-systems.com", "date": "2021-07-19T14:16:14Z"}, "message": "refactor gating of mingw", "tree": {"sha": "e1bc27c534cb4d5996f4b8d56c23ad50efdb31bf", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e1bc27c534cb4d5996f4b8d56c23ad50efdb31bf"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f4c6d8f77c23aef7fc7a2128e99f8801b8176a09", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEMycKYjxLY0eb13b7zXazX3c0dp4FAmD1iS4ACgkQzXazX3c0\ndp4KpA//c6rkFjihdZPhDztOxW6Fcw+LE/fg1IeFGrmXeyARaEKz1fRcCPK4bNgB\nBwfTju2G1cS+7wQNDYAB7V/nOC/cbpdGbxNv6lHEJoZ5hFIQc+YwYw96UDlo/Yvl\ntnxk4c1rgiqn0SsZ3FGOuAFFZtda1nQ5a7H+1GAYRZOMgU2T0ql2k5x55fdMiQjs\nurTfTubAkZtNdNWFaj+E1I9LkH8VktWmX6lXZasoM0hcQjXIoaMBR48j8/E7YZo1\ntdc/Rz9Zxm8BGb4AQ8/JYW+nFLqO/rOI6OGb4u1cpAetBsgbZJAVFT/SnFOhaot3\nLWt4CRcZsEHshNpAEhLI34edWcr10I6Tko3LUMvZp4uT3M/0vtldLXwvNn3gNhug\nRE/XWHWFoCaty+5iwHCYeyFGN4SJgXcZdIpPkti5USKBjTxu04kWoT4ebNZspfbC\n/qkPGCnyr9Rk3T7IwCq9hHZaPndro1LGqiYfMb4VEzFAPWZ8G9EFKvaVlTGT3CD6\nagCxNQq8tX1qi+jmCn+Sqw5604/CNkwt58bcUxImUpegwuv1NQspIvJEALGC82m9\ne0nF1Rd1DqhJoDg/aqyVNDwREX/hDgUQLMHT+89DvrER/nuNydBVhhOSHq+jyo/Z\nCSVqmqtg8Yx/nOQPt5tYLihI1TJ8piZC0P/95sNvzl/jRGwoCj0=\n=q+eq\n-----END PGP SIGNATURE-----", "payload": "tree e1bc27c534cb4d5996f4b8d56c23ad50efdb31bf\nparent 82faa9caffd766b626c216f895f083f874f2440f\nauthor Pietro Albini <pietro.albini@ferrous-systems.com> 1626701207 +0200\ncommitter Pietro Albini <pietro.albini@ferrous-systems.com> 1626704174 +0200\n\nrefactor gating of mingw\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f4c6d8f77c23aef7fc7a2128e99f8801b8176a09", "html_url": "https://github.com/rust-lang/rust/commit/f4c6d8f77c23aef7fc7a2128e99f8801b8176a09", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f4c6d8f77c23aef7fc7a2128e99f8801b8176a09/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "82faa9caffd766b626c216f895f083f874f2440f", "url": "https://api.github.com/repos/rust-lang/rust/commits/82faa9caffd766b626c216f895f083f874f2440f", "html_url": "https://github.com/rust-lang/rust/commit/82faa9caffd766b626c216f895f083f874f2440f"}], "stats": {"total": 10, "additions": 4, "deletions": 6}, "files": [{"sha": "9776b097bec07364c54bb9d87d98c14ab0354117", "filename": "src/bootstrap/dist.rs", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/f4c6d8f77c23aef7fc7a2128e99f8801b8176a09/src%2Fbootstrap%2Fdist.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f4c6d8f77c23aef7fc7a2128e99f8801b8176a09/src%2Fbootstrap%2Fdist.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdist.rs?ref=f4c6d8f77c23aef7fc7a2128e99f8801b8176a09", "patch": "@@ -1386,6 +1386,10 @@ impl Step for Extended {\n             tarballs.push(builder.ensure(Docs { host: target }));\n         }\n \n+        if target.contains(\"windows-gnu\") {\n+            tarballs.push(builder.ensure(Mingw { host: target }).expect(\"missing mingw\"));\n+        }\n+\n         if builder.config.profiler_enabled(target)\n             || should_build_extended_tool(builder, \"rust-demangler\")\n         {\n@@ -1404,19 +1408,13 @@ impl Step for Extended {\n         add_tool!(\"miri\" => Miri { compiler, target });\n         add_tool!(\"analysis\" => Analysis { compiler, target });\n \n-        let mingw_installer = builder.ensure(Mingw { host: target });\n-\n         let etc = builder.src.join(\"src/etc/installer\");\n \n         // Avoid producing tarballs during a dry run.\n         if builder.config.dry_run {\n             return;\n         }\n \n-        if target.contains(\"pc-windows-gnu\") {\n-            tarballs.push(mingw_installer.unwrap());\n-        }\n-\n         let tarball = Tarball::new(builder, \"rust\", &target.triple);\n         let generated = tarball.combine(&tarballs);\n "}]}