{"sha": "efd81b435b6c873ae39d4d3598a583fc03dd55c9", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVmZDgxYjQzNWI2Yzg3M2FlMzlkNGQzNTk4YTU4M2ZjMDNkZDU1Yzk=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-08-28T08:24:07Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-08-28T08:24:07Z"}, "message": "Rollup merge of #75989 - matklad:renamerustdoctest, r=GuillaumeGomez\n\nRename rustdoc/test -> rustdoc/doctest\n\nThis modules contains the implementation of doctests, and not the\ntests of rustdoc itself. This name is confusing, so let's rename it to\ndoctest for clarity.", "tree": {"sha": "1c4269359eb7b91b4aa64d557b356292c279e11e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1c4269359eb7b91b4aa64d557b356292c279e11e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/efd81b435b6c873ae39d4d3598a583fc03dd55c9", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfSL8oCRBK7hj4Ov3rIwAAdHIIAKX+zpFsrPMrupXPdQfbMd2p\nL7Zv5QKfptMLP3V3+zvXguzc9mAK/xXyzKC223dgfO5Bp+AqnbAwWQeEYO0JFTwI\nJn02BXLdN/30tnUlX35XfewdZtelur+tf8KyJ6hitpOeCCotJLE1dR9ZqB7yluR3\nQD0SYB5GviKn3PccApn8j5JMmWCbjP7ur+LVXgHQHiWp4kFcCw6eJ2LREn0nUbsU\ny45Axj/Q9irPjQzbO5anMgq9uqtWYpjJIK84JWIrrihNRCP0uWYclLcusg5TtBYW\nCEC1OULJT/A50OIlRsu+bW1me9AZVG04kqSNSjAo+IleuvPP4yN68na2E9dpaM8=\n=G46o\n-----END PGP SIGNATURE-----\n", "payload": "tree 1c4269359eb7b91b4aa64d557b356292c279e11e\nparent cd77b62174432003d7637518de903b27735ec520\nparent df975cf9c27681da7751c12f19850e67940593df\nauthor Pietro Albini <pietro@pietroalbini.org> 1598603047 +0200\ncommitter GitHub <noreply@github.com> 1598603047 +0200\n\nRollup merge of #75989 - matklad:renamerustdoctest, r=GuillaumeGomez\n\nRename rustdoc/test -> rustdoc/doctest\n\nThis modules contains the implementation of doctests, and not the\ntests of rustdoc itself. This name is confusing, so let's rename it to\ndoctest for clarity.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/efd81b435b6c873ae39d4d3598a583fc03dd55c9", "html_url": "https://github.com/rust-lang/rust/commit/efd81b435b6c873ae39d4d3598a583fc03dd55c9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/efd81b435b6c873ae39d4d3598a583fc03dd55c9/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cd77b62174432003d7637518de903b27735ec520", "url": "https://api.github.com/repos/rust-lang/rust/commits/cd77b62174432003d7637518de903b27735ec520", "html_url": "https://github.com/rust-lang/rust/commit/cd77b62174432003d7637518de903b27735ec520"}, {"sha": "df975cf9c27681da7751c12f19850e67940593df", "url": "https://api.github.com/repos/rust-lang/rust/commits/df975cf9c27681da7751c12f19850e67940593df", "html_url": "https://github.com/rust-lang/rust/commit/df975cf9c27681da7751c12f19850e67940593df"}], "stats": {"total": 14, "additions": 7, "deletions": 7}, "files": [{"sha": "7b7c152d8abbf65e6c57a9b3dc41d9b712fff52e", "filename": "src/librustdoc/doctest.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/efd81b435b6c873ae39d4d3598a583fc03dd55c9/src%2Flibrustdoc%2Fdoctest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efd81b435b6c873ae39d4d3598a583fc03dd55c9/src%2Flibrustdoc%2Fdoctest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fdoctest.rs?ref=efd81b435b6c873ae39d4d3598a583fc03dd55c9", "previous_filename": "src/librustdoc/test.rs"}, {"sha": "a96186a95e16b904cb84dfd4ef9228bab5cefeeb", "filename": "src/librustdoc/doctest/tests.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/efd81b435b6c873ae39d4d3598a583fc03dd55c9/src%2Flibrustdoc%2Fdoctest%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efd81b435b6c873ae39d4d3598a583fc03dd55c9/src%2Flibrustdoc%2Fdoctest%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fdoctest%2Ftests.rs?ref=efd81b435b6c873ae39d4d3598a583fc03dd55c9", "previous_filename": "src/librustdoc/test/tests.rs"}, {"sha": "56499f736e163bf0b3d07107a10708b94e10b3f8", "filename": "src/librustdoc/html/markdown.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/efd81b435b6c873ae39d4d3598a583fc03dd55c9/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efd81b435b6c873ae39d4d3598a583fc03dd55c9/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs?ref=efd81b435b6c873ae39d4d3598a583fc03dd55c9", "patch": "@@ -34,9 +34,9 @@ use std::fmt::Write;\n use std::ops::Range;\n use std::str;\n \n+use crate::doctest;\n use crate::html::highlight;\n use crate::html::toc::TocBuilder;\n-use crate::test;\n \n use pulldown_cmark::{html, CodeBlockKind, CowStr, Event, Options, Parser, Tag};\n \n@@ -243,7 +243,7 @@ impl<'a, I: Iterator<Item = Event<'a>>> Iterator for CodeBlocks<'_, 'a, I> {\n                 .collect::<Vec<Cow<'_, str>>>()\n                 .join(\"\\n\");\n             let krate = krate.as_ref().map(|s| &**s);\n-            let (test, _) = test::make_test(&test, krate, false, &Default::default(), edition);\n+            let (test, _) = doctest::make_test(&test, krate, false, &Default::default(), edition);\n             let channel = if test.contains(\"#![feature(\") { \"&amp;version=nightly\" } else { \"\" };\n \n             let edition_string = format!(\"&amp;edition={}\", edition);\n@@ -568,7 +568,7 @@ impl<'a, I: Iterator<Item = Event<'a>>> Iterator for Footnotes<'a, I> {\n     }\n }\n \n-pub fn find_testable_code<T: test::Tester>(\n+pub fn find_testable_code<T: doctest::Tester>(\n     doc: &str,\n     tests: &mut T,\n     error_codes: ErrorCodes,"}, {"sha": "8658b39b4557815f3200e0e07adabe02d6706198", "filename": "src/librustdoc/lib.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/efd81b435b6c873ae39d4d3598a583fc03dd55c9/src%2Flibrustdoc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efd81b435b6c873ae39d4d3598a583fc03dd55c9/src%2Flibrustdoc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Flib.rs?ref=efd81b435b6c873ae39d4d3598a583fc03dd55c9", "patch": "@@ -64,13 +64,13 @@ mod docfs;\n mod doctree;\n #[macro_use]\n mod error;\n+mod doctest;\n mod fold;\n crate mod formats;\n pub mod html;\n mod json;\n mod markdown;\n mod passes;\n-mod test;\n mod theme;\n mod visit_ast;\n mod visit_lib;\n@@ -476,7 +476,7 @@ fn main_options(options: config::Options) -> MainResult {\n \n     match (options.should_test, options.markdown_input()) {\n         (true, true) => return wrap_return(&diag, markdown::test(options)),\n-        (true, false) => return test::run(options),\n+        (true, false) => return doctest::run(options),\n         (false, true) => {\n             return wrap_return(\n                 &diag,"}, {"sha": "3a87e1c46a6155e5a16a74a955178074f0357b87", "filename": "src/librustdoc/markdown.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/efd81b435b6c873ae39d4d3598a583fc03dd55c9/src%2Flibrustdoc%2Fmarkdown.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efd81b435b6c873ae39d4d3598a583fc03dd55c9/src%2Flibrustdoc%2Fmarkdown.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fmarkdown.rs?ref=efd81b435b6c873ae39d4d3598a583fc03dd55c9", "patch": "@@ -7,10 +7,10 @@ use rustc_span::edition::Edition;\n use rustc_span::source_map::DUMMY_SP;\n \n use crate::config::{Options, RenderOptions};\n+use crate::doctest::{Collector, TestOptions};\n use crate::html::escape::Escape;\n use crate::html::markdown;\n use crate::html::markdown::{find_testable_code, ErrorCodes, IdMap, Markdown, MarkdownWithToc};\n-use crate::test::{Collector, TestOptions};\n \n /// Separate any lines at the start of the file that begin with `# ` or `%`.\n fn extract_leading_metadata(s: &str) -> (Vec<&str>, &str) {"}, {"sha": "cbbe86dc433f33456a7343750e21f044bbf51eda", "filename": "src/librustdoc/passes/doc_test_lints.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/efd81b435b6c873ae39d4d3598a583fc03dd55c9/src%2Flibrustdoc%2Fpasses%2Fdoc_test_lints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efd81b435b6c873ae39d4d3598a583fc03dd55c9/src%2Flibrustdoc%2Fpasses%2Fdoc_test_lints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fdoc_test_lints.rs?ref=efd81b435b6c873ae39d4d3598a583fc03dd55c9", "patch": "@@ -54,7 +54,7 @@ impl Tests {\n     }\n }\n \n-impl crate::test::Tester for Tests {\n+impl crate::doctest::Tester for Tests {\n     fn add_test(&mut self, _: String, _: LangString, _: usize) {\n         self.found_tests += 1;\n     }"}]}