{"sha": "1129e8678038cfc938559b90b4155dde8b84edf3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjExMjllODY3ODAzOGNmYzkzODU1OWI5MGI0MTU1ZGRlOGI4NGVkZjM=", "commit": {"author": {"name": "LeSeulArtichaut", "email": "leseulartichaut@gmail.com", "date": "2021-01-23T17:05:59Z"}, "committer": {"name": "LeSeulArtichaut", "email": "leseulartichaut@gmail.com", "date": "2021-01-23T17:05:59Z"}, "message": "Cleanup `render_stability_since_raw` to remove code duplication", "tree": {"sha": "0eb056e3a3d93dc98f847fcf5d2733302238ed06", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0eb056e3a3d93dc98f847fcf5d2733302238ed06"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1129e8678038cfc938559b90b4155dde8b84edf3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1129e8678038cfc938559b90b4155dde8b84edf3", "html_url": "https://github.com/rust-lang/rust/commit/1129e8678038cfc938559b90b4155dde8b84edf3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1129e8678038cfc938559b90b4155dde8b84edf3/comments", "author": {"login": "LeSeulArtichaut", "id": 38361244, "node_id": "MDQ6VXNlcjM4MzYxMjQ0", "avatar_url": "https://avatars.githubusercontent.com/u/38361244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LeSeulArtichaut", "html_url": "https://github.com/LeSeulArtichaut", "followers_url": "https://api.github.com/users/LeSeulArtichaut/followers", "following_url": "https://api.github.com/users/LeSeulArtichaut/following{/other_user}", "gists_url": "https://api.github.com/users/LeSeulArtichaut/gists{/gist_id}", "starred_url": "https://api.github.com/users/LeSeulArtichaut/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LeSeulArtichaut/subscriptions", "organizations_url": "https://api.github.com/users/LeSeulArtichaut/orgs", "repos_url": "https://api.github.com/users/LeSeulArtichaut/repos", "events_url": "https://api.github.com/users/LeSeulArtichaut/events{/privacy}", "received_events_url": "https://api.github.com/users/LeSeulArtichaut/received_events", "type": "User", "site_admin": false}, "committer": {"login": "LeSeulArtichaut", "id": 38361244, "node_id": "MDQ6VXNlcjM4MzYxMjQ0", "avatar_url": "https://avatars.githubusercontent.com/u/38361244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LeSeulArtichaut", "html_url": "https://github.com/LeSeulArtichaut", "followers_url": "https://api.github.com/users/LeSeulArtichaut/followers", "following_url": "https://api.github.com/users/LeSeulArtichaut/following{/other_user}", "gists_url": "https://api.github.com/users/LeSeulArtichaut/gists{/gist_id}", "starred_url": "https://api.github.com/users/LeSeulArtichaut/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LeSeulArtichaut/subscriptions", "organizations_url": "https://api.github.com/users/LeSeulArtichaut/orgs", "repos_url": "https://api.github.com/users/LeSeulArtichaut/repos", "events_url": "https://api.github.com/users/LeSeulArtichaut/events{/privacy}", "received_events_url": "https://api.github.com/users/LeSeulArtichaut/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "65767e56537e20903b54ecde7c371cbfb1b201b0", "url": "https://api.github.com/repos/rust-lang/rust/commits/65767e56537e20903b54ecde7c371cbfb1b201b0", "html_url": "https://github.com/rust-lang/rust/commit/65767e56537e20903b54ecde7c371cbfb1b201b0"}], "stats": {"total": 43, "additions": 17, "deletions": 26}, "files": [{"sha": "f15d43b7b16002034f8e27a2f30d93b41467b3bb", "filename": "src/librustdoc/html/render/mod.rs", "status": "modified", "additions": 17, "deletions": 26, "changes": 43, "blob_url": "https://github.com/rust-lang/rust/blob/1129e8678038cfc938559b90b4155dde8b84edf3/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1129e8678038cfc938559b90b4155dde8b84edf3/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs?ref=1129e8678038cfc938559b90b4155dde8b84edf3", "patch": "@@ -2934,34 +2934,25 @@ fn render_stability_since_raw(\n     containing_ver: Option<&str>,\n     containing_const_ver: Option<&str>,\n ) {\n-    let ver = ver.and_then(|inner| if !inner.is_empty() { Some(inner) } else { None });\n+    let ver = ver.filter(|inner| !inner.is_empty());\n+    let const_ver = const_ver.filter(|inner| !inner.is_empty());\n \n-    let const_ver = const_ver.and_then(|inner| if !inner.is_empty() { Some(inner) } else { None });\n-\n-    if let Some(v) = ver {\n-        if let Some(cv) = const_ver {\n-            if const_ver != containing_const_ver {\n-                write!(\n-                    w,\n-                    \"<span class=\\\"since\\\" title=\\\"Stable since Rust version {0}, const since {1}\\\">{0} (const: {1})</span>\",\n-                    v, cv\n-                );\n-            } else if ver != containing_ver {\n-                write!(\n-                    w,\n-                    \"<span class=\\\"since\\\" title=\\\"Stable since Rust version {0}\\\">{0}</span>\",\n-                    v\n-                );\n-            }\n-        } else {\n-            if ver != containing_ver {\n-                write!(\n-                    w,\n-                    \"<span class=\\\"since\\\" title=\\\"Stable since Rust version {0}\\\">{0}</span>\",\n-                    v\n-                );\n-            }\n+    match (ver, const_ver) {\n+        (Some(v), Some(cv)) if const_ver != containing_const_ver => {\n+            write!(\n+                w,\n+                \"<span class=\\\"since\\\" title=\\\"Stable since Rust version {0}, const since {1}\\\">{0} (const: {1})</span>\",\n+                v, cv\n+            );\n+        }\n+        (Some(v), _) if ver != containing_ver => {\n+            write!(\n+                w,\n+                \"<span class=\\\"since\\\" title=\\\"Stable since Rust version {0}\\\">{0}</span>\",\n+                v\n+            );\n         }\n+        _ => {}\n     }\n }\n "}]}