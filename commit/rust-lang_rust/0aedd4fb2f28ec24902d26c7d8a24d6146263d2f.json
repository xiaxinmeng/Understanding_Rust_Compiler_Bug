{"sha": "0aedd4fb2f28ec24902d26c7d8a24d6146263d2f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBhZWRkNGZiMmYyOGVjMjQ5MDJkMjZjN2Q4YTI0ZDYxNDYyNjNkMmY=", "commit": {"author": {"name": "Hirokazu Hata", "email": "h.hata.ai.t@gmail.com", "date": "2019-01-16T15:08:53Z"}, "committer": {"name": "Hirokazu Hata", "email": "h.hata.ai.t@gmail.com", "date": "2019-01-16T15:08:53Z"}, "message": "Add Ty::Array to walk_mut", "tree": {"sha": "e67129e4e514e140463d8f0f7bd7556793cac484", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e67129e4e514e140463d8f0f7bd7556793cac484"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0aedd4fb2f28ec24902d26c7d8a24d6146263d2f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0aedd4fb2f28ec24902d26c7d8a24d6146263d2f", "html_url": "https://github.com/rust-lang/rust/commit/0aedd4fb2f28ec24902d26c7d8a24d6146263d2f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0aedd4fb2f28ec24902d26c7d8a24d6146263d2f/comments", "author": {"login": "h-michael", "id": 4556097, "node_id": "MDQ6VXNlcjQ1NTYwOTc=", "avatar_url": "https://avatars.githubusercontent.com/u/4556097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/h-michael", "html_url": "https://github.com/h-michael", "followers_url": "https://api.github.com/users/h-michael/followers", "following_url": "https://api.github.com/users/h-michael/following{/other_user}", "gists_url": "https://api.github.com/users/h-michael/gists{/gist_id}", "starred_url": "https://api.github.com/users/h-michael/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/h-michael/subscriptions", "organizations_url": "https://api.github.com/users/h-michael/orgs", "repos_url": "https://api.github.com/users/h-michael/repos", "events_url": "https://api.github.com/users/h-michael/events{/privacy}", "received_events_url": "https://api.github.com/users/h-michael/received_events", "type": "User", "site_admin": false}, "committer": {"login": "h-michael", "id": 4556097, "node_id": "MDQ6VXNlcjQ1NTYwOTc=", "avatar_url": "https://avatars.githubusercontent.com/u/4556097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/h-michael", "html_url": "https://github.com/h-michael", "followers_url": "https://api.github.com/users/h-michael/followers", "following_url": "https://api.github.com/users/h-michael/following{/other_user}", "gists_url": "https://api.github.com/users/h-michael/gists{/gist_id}", "starred_url": "https://api.github.com/users/h-michael/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/h-michael/subscriptions", "organizations_url": "https://api.github.com/users/h-michael/orgs", "repos_url": "https://api.github.com/users/h-michael/repos", "events_url": "https://api.github.com/users/h-michael/events{/privacy}", "received_events_url": "https://api.github.com/users/h-michael/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f66ca1bd2e0e5e198f60d0b0b6e2d953c81b0645", "url": "https://api.github.com/repos/rust-lang/rust/commits/f66ca1bd2e0e5e198f60d0b0b6e2d953c81b0645", "html_url": "https://github.com/rust-lang/rust/commit/f66ca1bd2e0e5e198f60d0b0b6e2d953c81b0645"}], "stats": {"total": 70, "additions": 35, "deletions": 35}, "files": [{"sha": "c7c0636017f9001e5ba9a21a51c6c4e8786c715d", "filename": "crates/ra_hir/src/ty.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/0aedd4fb2f28ec24902d26c7d8a24d6146263d2f/crates%2Fra_hir%2Fsrc%2Fty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0aedd4fb2f28ec24902d26c7d8a24d6146263d2f/crates%2Fra_hir%2Fsrc%2Fty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty.rs?ref=0aedd4fb2f28ec24902d26c7d8a24d6146263d2f", "patch": "@@ -356,7 +356,7 @@ impl Ty {\n     fn walk_mut(&mut self, f: &mut impl FnMut(&mut Ty)) {\n         f(self);\n         match self {\n-            Ty::Slice(t) => Arc::make_mut(t).walk_mut(f),\n+            Ty::Slice(t) | Ty::Array(t) => Arc::make_mut(t).walk_mut(f),\n             Ty::RawPtr(t, _) => Arc::make_mut(t).walk_mut(f),\n             Ty::Ref(t, _) => Arc::make_mut(t).walk_mut(f),\n             Ty::Tuple(ts) => {\n@@ -1105,7 +1105,7 @@ impl<'a, D: HirDatabase> InferenceContext<'a, D> {\n                 }\n \n                 Ty::Tuple(Arc::from(ty_vec))\n-            },\n+            }\n             Expr::Array { exprs } => {\n                 let elem_ty = match &expected.ty {\n                     Ty::Slice(inner) | Ty::Array(inner) => Ty::clone(&inner),\n@@ -1117,7 +1117,7 @@ impl<'a, D: HirDatabase> InferenceContext<'a, D> {\n                 }\n \n                 Ty::Array(Arc::new(elem_ty))\n-            },\n+            }\n             Expr::Literal(lit) => match lit {\n                 Literal::Bool(..) => Ty::Bool,\n                 Literal::String(..) => Ty::Ref(Arc::new(Ty::Str), Mutability::Shared),"}, {"sha": "acdf74ba49ddb104da877d675922d4c29efa1028", "filename": "crates/ra_hir/src/ty/tests/data/array.txt", "status": "modified", "additions": 32, "deletions": 32, "changes": 64, "blob_url": "https://github.com/rust-lang/rust/blob/0aedd4fb2f28ec24902d26c7d8a24d6146263d2f/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Farray.txt", "raw_url": "https://github.com/rust-lang/rust/raw/0aedd4fb2f28ec24902d26c7d8a24d6146263d2f/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Farray.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Ftests%2Fdata%2Farray.txt?ref=0aedd4fb2f28ec24902d26c7d8a24d6146263d2f", "patch": "@@ -1,52 +1,52 @@\n [9; 10) 'x': &str\n [18; 19) 'y': isize\n [28; 293) '{     ... []; }': ()\n-[38; 39) 'a': [_]\n-[42; 45) '[x]': [_]\n+[38; 39) 'a': [&str]\n+[42; 45) '[x]': [&str]\n [43; 44) 'x': &str\n-[55; 56) 'b': [_]\n-[59; 65) '[a, a]': [_]\n-[60; 61) 'a': [_]\n-[63; 64) 'a': [_]\n-[75; 76) 'c': [_]\n-[79; 85) '[b, b]': [_]\n-[80; 81) 'b': [_]\n-[83; 84) 'b': [_]\n-[96; 97) 'd': [_]\n-[100; 112) '[y, 1, 2, 3]': [_]\n+[55; 56) 'b': [[&str]]\n+[59; 65) '[a, a]': [[&str]]\n+[60; 61) 'a': [&str]\n+[63; 64) 'a': [&str]\n+[75; 76) 'c': [[[&str]]]\n+[79; 85) '[b, b]': [[[&str]]]\n+[80; 81) 'b': [[&str]]\n+[83; 84) 'b': [[&str]]\n+[96; 97) 'd': [isize]\n+[100; 112) '[y, 1, 2, 3]': [isize]\n [101; 102) 'y': isize\n [104; 105) '1': isize\n [107; 108) '2': isize\n [110; 111) '3': isize\n-[122; 123) 'd': [_]\n-[126; 138) '[1, y, 2, 3]': [_]\n+[122; 123) 'd': [isize]\n+[126; 138) '[1, y, 2, 3]': [isize]\n [127; 128) '1': isize\n [130; 131) 'y': isize\n [133; 134) '2': isize\n [136; 137) '3': isize\n-[148; 149) 'e': [_]\n-[152; 155) '[y]': [_]\n+[148; 149) 'e': [isize]\n+[152; 155) '[y]': [isize]\n [153; 154) 'y': isize\n-[165; 166) 'f': [_]\n-[169; 175) '[d, d]': [_]\n-[170; 171) 'd': [_]\n-[173; 174) 'd': [_]\n-[185; 186) 'g': [_]\n-[189; 195) '[e, e]': [_]\n-[190; 191) 'e': [_]\n-[193; 194) 'e': [_]\n-[206; 207) 'h': [_]\n-[210; 216) '[1, 2]': [_]\n+[165; 166) 'f': [[isize]]\n+[169; 175) '[d, d]': [[isize]]\n+[170; 171) 'd': [isize]\n+[173; 174) 'd': [isize]\n+[185; 186) 'g': [[isize]]\n+[189; 195) '[e, e]': [[isize]]\n+[190; 191) 'e': [isize]\n+[193; 194) 'e': [isize]\n+[206; 207) 'h': [i32]\n+[210; 216) '[1, 2]': [i32]\n [211; 212) '1': i32\n [214; 215) '2': i32\n-[226; 227) 'i': [_]\n-[230; 240) '[\"a\", \"b\"]': [_]\n+[226; 227) 'i': [&str]\n+[230; 240) '[\"a\", \"b\"]': [&str]\n [231; 234) '\"a\"': &str\n [236; 239) '\"b\"': &str\n-[251; 252) 'b': [_]\n-[255; 265) '[a, [\"b\"]]': [_]\n-[256; 257) 'a': [_]\n-[259; 264) '[\"b\"]': [_]\n+[251; 252) 'b': [[&str]]\n+[255; 265) '[a, [\"b\"]]': [[&str]]\n+[256; 257) 'a': [&str]\n+[259; 264) '[\"b\"]': [&str]\n [260; 263) '\"b\"': &str\n [275; 276) 'x': [u8]\n [288; 290) '[]': [u8]"}]}