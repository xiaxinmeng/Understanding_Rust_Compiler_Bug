{"sha": "eb854ffb4423c053451882fdc204fd717bb07ad4", "node_id": "MDY6Q29tbWl0NzI0NzEyOmViODU0ZmZiNDQyM2MwNTM0NTE4ODJmZGMyMDRmZDcxN2JiMDdhZDQ=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-02-09T19:31:44Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-02-09T19:37:56Z"}, "message": "Add several 1-word .bss fragments for FreeBSD.", "tree": {"sha": "7215c91037afac519ff4f7bf5eca86b3142cc60e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7215c91037afac519ff4f7bf5eca86b3142cc60e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/eb854ffb4423c053451882fdc204fd717bb07ad4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/eb854ffb4423c053451882fdc204fd717bb07ad4", "html_url": "https://github.com/rust-lang/rust/commit/eb854ffb4423c053451882fdc204fd717bb07ad4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/eb854ffb4423c053451882fdc204fd717bb07ad4/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "60635999f313981abe157318025a19d60d8d310a", "url": "https://api.github.com/repos/rust-lang/rust/commits/60635999f313981abe157318025a19d60d8d310a", "html_url": "https://github.com/rust-lang/rust/commit/60635999f313981abe157318025a19d60d8d310a"}], "stats": {"total": 21, "additions": 21, "deletions": 0}, "files": [{"sha": "3cc936c05a5d42393b6b8720bc9d811ec62bbf9b", "filename": "src/boot/be/elf.ml", "status": "modified", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/eb854ffb4423c053451882fdc204fd717bb07ad4/src%2Fboot%2Fbe%2Felf.ml", "raw_url": "https://github.com/rust-lang/rust/raw/eb854ffb4423c053451882fdc204fd717bb07ad4/src%2Fboot%2Fbe%2Felf.ml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fboot%2Fbe%2Felf.ml?ref=eb854ffb4423c053451882fdc204fd717bb07ad4", "patch": "@@ -1644,6 +1644,27 @@ let emit_file\n     htab_put text_frags None code;\n     htab_put rodata_frags None data;\n \n+    if sess.Session.sess_targ = FreeBSD_x86_elf\n+    then\n+      (* \n+       * FreeBSD wants some extra symbols in .bss so its libc can fill\n+       * them in, I think.\n+       *)\n+      List.iter\n+        (fun x -> htab_put bss_frags (Some x) (WORD (TY_u32, (IMM 0L))))\n+        [\n+          \"environ\";\n+          \"optind\";\n+          \"optarg\";\n+          \"_CurrentRuneLocale\";\n+          \"__stack_chk_guard\";\n+          \"__mb_sb_limit\";\n+          \"__isthreaded\";\n+          \"__stdinp\";\n+          \"__stderrp\";\n+          \"__stdoutp\";\n+        ];\n+\n     Hashtbl.iter\n       begin\n         fun _ tab ->"}]}