{"sha": "12dc03033f9d441f1382a7684480c4a863b33bb8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEyZGMwMzAzM2Y5ZDQ0MWYxMzgyYTc2ODQ0ODBjNGE4NjNiMzNiYjg=", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2021-02-23T20:27:32Z"}, "committer": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2021-02-26T09:59:40Z"}, "message": "lintcheck: fix bug when getting the config toml path.\n\nIn order to check if we need to recheck crates, I was getting the path from clap only\nwhich is None if we don't pass it via cmdline args.\n\nUse the dedicated lintcheck_config_toml() fnuction instead!", "tree": {"sha": "4456cf2f9cbc90a3e6ffef039f77cc509c68078a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4456cf2f9cbc90a3e6ffef039f77cc509c68078a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/12dc03033f9d441f1382a7684480c4a863b33bb8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/12dc03033f9d441f1382a7684480c4a863b33bb8", "html_url": "https://github.com/rust-lang/rust/commit/12dc03033f9d441f1382a7684480c4a863b33bb8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/12dc03033f9d441f1382a7684480c4a863b33bb8/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d5223be2e30a9d116b839bda418bec99d2949a68", "url": "https://api.github.com/repos/rust-lang/rust/commits/d5223be2e30a9d116b839bda418bec99d2949a68", "html_url": "https://github.com/rust-lang/rust/commit/d5223be2e30a9d116b839bda418bec99d2949a68"}], "stats": {"total": 7, "additions": 4, "deletions": 3}, "files": [{"sha": "a4e6fe76c3222200802e57622eb8d29f44dcb94a", "filename": "clippy_dev/src/lintcheck.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/12dc03033f9d441f1382a7684480c4a863b33bb8/clippy_dev%2Fsrc%2Flintcheck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12dc03033f9d441f1382a7684480c4a863b33bb8/clippy_dev%2Fsrc%2Flintcheck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Flintcheck.rs?ref=12dc03033f9d441f1382a7684480c4a863b33bb8", "patch": "@@ -336,8 +336,8 @@ fn build_clippy() {\n }\n \n /// Read a `toml` file and return a list of `CrateSources` that we want to check with clippy\n-fn read_crates(toml_path: Option<&str>) -> (String, Vec<CrateSource>) {\n-    let toml_path = lintcheck_config_toml(toml_path);\n+fn read_crates(clap_toml_path: Option<&str>) -> (String, Vec<CrateSource>) {\n+    let toml_path = lintcheck_config_toml(clap_toml_path);\n     // save it so that we can use the name of the sources.toml as name for the logfile later.\n     let toml_filename = toml_path.file_stem().unwrap().to_str().unwrap().to_string();\n     let toml_content: String =\n@@ -478,7 +478,8 @@ pub fn run(clap_config: &ArgMatches) {\n     build_clippy();\n     println!(\"Done compiling\");\n \n-    let clap_toml_path = clap_config.value_of(\"crates-toml\");\n+    let clap_toml_path: Option<&str> = clap_config.value_of(\"crates-toml\");\n+    let toml_path = lintcheck_config_toml(clap_toml_path);\n \n     // if the clippy bin is newer than our logs, throw away target dirs to force clippy to\n     // refresh the logs"}]}