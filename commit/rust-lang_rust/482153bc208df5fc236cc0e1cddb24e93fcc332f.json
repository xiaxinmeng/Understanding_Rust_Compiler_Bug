{"sha": "482153bc208df5fc236cc0e1cddb24e93fcc332f", "node_id": "C_kwDOAAsO6NoAKDQ4MjE1M2JjMjA4ZGY1ZmMyMzZjYzBlMWNkZGIyNGU5M2ZjYzMzMmY", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-07-31T08:03:26Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-07-31T08:03:26Z"}, "message": "Auto merge of #99529 - Milo123459:stage-1-test, r=jyn514\n\nRun `x test --stage 1` in CI\n\nFixes #99135\n\nr? `@jyn514`", "tree": {"sha": "5673f88baca7242e57f6858fc6d690153cf8a5b3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5673f88baca7242e57f6858fc6d690153cf8a5b3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/482153bc208df5fc236cc0e1cddb24e93fcc332f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/482153bc208df5fc236cc0e1cddb24e93fcc332f", "html_url": "https://github.com/rust-lang/rust/commit/482153bc208df5fc236cc0e1cddb24e93fcc332f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/482153bc208df5fc236cc0e1cddb24e93fcc332f/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a2318651d4d2c6280a5047544cbf4180119ba966", "url": "https://api.github.com/repos/rust-lang/rust/commits/a2318651d4d2c6280a5047544cbf4180119ba966", "html_url": "https://github.com/rust-lang/rust/commit/a2318651d4d2c6280a5047544cbf4180119ba966"}, {"sha": "1f7b6552bb67ac7e4c844776863988a1264c5ee0", "url": "https://api.github.com/repos/rust-lang/rust/commits/1f7b6552bb67ac7e4c844776863988a1264c5ee0", "html_url": "https://github.com/rust-lang/rust/commit/1f7b6552bb67ac7e4c844776863988a1264c5ee0"}], "stats": {"total": 55, "additions": 54, "deletions": 1}, "files": [{"sha": "1f95c1bcab4a56df72a65c8749848d77dcbf2885", "filename": ".github/workflows/ci.yml", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/482153bc208df5fc236cc0e1cddb24e93fcc332f/.github%2Fworkflows%2Fci.yml", "raw_url": "https://github.com/rust-lang/rust/raw/482153bc208df5fc236cc0e1cddb24e93fcc332f/.github%2Fworkflows%2Fci.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fci.yml?ref=482153bc208df5fc236cc0e1cddb24e93fcc332f", "patch": "@@ -278,6 +278,10 @@ jobs:\n             env:\n               RUST_BACKTRACE: 1\n             os: ubuntu-20.04-xl\n+          - name: x86_64-gnu-llvm-12-stage1\n+            env:\n+              RUST_BACKTRACE: 1\n+            os: ubuntu-20.04-xl\n           - name: x86_64-gnu-nopt\n             os: ubuntu-20.04-xl\n             env: {}"}, {"sha": "c2f3a16d273b0fc03e16f4b3af1279fa235af128", "filename": "src/ci/docker/host-x86_64/x86_64-gnu-llvm-12-stage1/Dockerfile", "status": "added", "additions": 44, "deletions": 0, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/482153bc208df5fc236cc0e1cddb24e93fcc332f/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-llvm-12-stage1%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/482153bc208df5fc236cc0e1cddb24e93fcc332f/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-llvm-12-stage1%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-llvm-12-stage1%2FDockerfile?ref=482153bc208df5fc236cc0e1cddb24e93fcc332f", "patch": "@@ -0,0 +1,44 @@\n+FROM ubuntu:20.04\n+\n+ARG DEBIAN_FRONTEND=noninteractive\n+RUN apt-get update && apt-get install -y --no-install-recommends \\\n+    g++ \\\n+    gcc-multilib \\\n+    make \\\n+    ninja-build \\\n+    file \\\n+    curl \\\n+    ca-certificates \\\n+    python2.7 \\\n+    git \\\n+    cmake \\\n+    sudo \\\n+    gdb \\\n+    llvm-12-tools \\\n+    llvm-12-dev \\\n+    libedit-dev \\\n+    libssl-dev \\\n+    pkg-config \\\n+    zlib1g-dev \\\n+    xz-utils \\\n+    nodejs\n+\n+COPY scripts/sccache.sh /scripts/\n+RUN sh /scripts/sccache.sh\n+\n+# using llvm-link-shared due to libffi issues -- see #34486\n+ENV RUST_CONFIGURE_ARGS \\\n+    --build=x86_64-unknown-linux-gnu \\\n+    --llvm-root=/usr/lib/llvm-12 \\\n+    --enable-llvm-link-shared \\\n+    --set rust.thin-lto-import-instr-limit=10\n+\n+ENV SCRIPT python2.7 ../x.py --stage 1 test --exclude src/tools/tidy && \\\n+    # Run the `mir-opt` tests again but this time for a 32-bit target.\n+    # This enforces that tests using `// EMIT_MIR_FOR_EACH_BIT_WIDTH` have\n+    # both 32-bit and 64-bit outputs updated by the PR author, before\n+    # the PR is approved and tested for merging.\n+    # It will also detect tests lacking `// EMIT_MIR_FOR_EACH_BIT_WIDTH`,\n+    # despite having different output on 32-bit vs 64-bit targets.\n+    python2.7 ../x.py --stage 1 test src/test/mir-opt \\\n+    --host='' --target=i686-unknown-linux-gnu\n\\ No newline at end of file"}, {"sha": "cb660881b075fa54a41091fb06f4f651ed054070", "filename": "src/ci/github-actions/ci.yml", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/482153bc208df5fc236cc0e1cddb24e93fcc332f/src%2Fci%2Fgithub-actions%2Fci.yml", "raw_url": "https://github.com/rust-lang/rust/raw/482153bc208df5fc236cc0e1cddb24e93fcc332f/src%2Fci%2Fgithub-actions%2Fci.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fgithub-actions%2Fci.yml?ref=482153bc208df5fc236cc0e1cddb24e93fcc332f", "patch": "@@ -286,7 +286,7 @@ jobs:\n \n           - name: x86_64-gnu-llvm-12\n             <<: *job-linux-xl\n-\n+            \n           - name: x86_64-gnu-tools\n             env:\n               CI_ONLY_WHEN_SUBMODULES_CHANGED: 1\n@@ -436,6 +436,11 @@ jobs:\n               RUST_BACKTRACE: 1\n             <<: *job-linux-xl\n \n+          - name: x86_64-gnu-llvm-12-stage1\n+            env:\n+              RUST_BACKTRACE: 1\n+            <<: *job-linux-xl\n+\n           - name: x86_64-gnu-nopt\n             <<: *job-linux-xl\n "}]}