{"sha": "61919022ddf1f490414304b107946127cd15c6f1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYxOTE5MDIyZGRmMWY0OTA0MTQzMDRiMTA3OTQ2MTI3Y2QxNWM2ZjE=", "commit": {"author": {"name": "Seiichi Uchida", "email": "seuchida@gmail.com", "date": "2018-03-05T15:41:16Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-03-05T15:41:16Z"}, "message": "Merge pull request #2507 from kngwyu/issue-2506\n\nIssue 2506", "tree": {"sha": "fbcd5a512565a518b5e3b4895e7c86d221a2d41f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fbcd5a512565a518b5e3b4895e7c86d221a2d41f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/61919022ddf1f490414304b107946127cd15c6f1", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJanWUcCRBK7hj4Ov3rIwAAdHIIAEwysyB8OqvbE7TRrKmBq+r4\nnz/0/1l+4rfi2I+NyfXsNJ47yyL8N23VFE2/OEfYQR4i//PJ5iM8JdQm0q7n7Y72\naWfXvJEGm1TYrsa5PQSemb6aDiMETsNM2W9FckHBioQYKw1rPV/Ry5fe/02vAmxR\ndh6ADp2q2QrqQbzX19b1UeCFtUz2xJsNEGk+mpHdg5xm0ffu3yoTORXpAg5hHaUv\nVH8a490tECQaKAVnZrXPfCFTONbTK3zO6Wt9qFd19tDJqLQwsfMQZ55YH5QL+EiU\nYXBtRZsHIp2tK1OoBYgM0Im4hqdANuoBmcJDNSf7Y40pMJqP0q0hH26iNtXpNNY=\n=uLS2\n-----END PGP SIGNATURE-----\n", "payload": "tree fbcd5a512565a518b5e3b4895e7c86d221a2d41f\nparent 5025a53b30f9690a277baf14dca1ba15a383d3da\nparent 8ea79aa0259c497006bdd56e0690c1420b6d8514\nauthor Seiichi Uchida <seuchida@gmail.com> 1520264476 +0900\ncommitter GitHub <noreply@github.com> 1520264476 +0900\n\nMerge pull request #2507 from kngwyu/issue-2506\n\nIssue 2506"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/61919022ddf1f490414304b107946127cd15c6f1", "html_url": "https://github.com/rust-lang/rust/commit/61919022ddf1f490414304b107946127cd15c6f1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/61919022ddf1f490414304b107946127cd15c6f1/comments", "author": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5025a53b30f9690a277baf14dca1ba15a383d3da", "url": "https://api.github.com/repos/rust-lang/rust/commits/5025a53b30f9690a277baf14dca1ba15a383d3da", "html_url": "https://github.com/rust-lang/rust/commit/5025a53b30f9690a277baf14dca1ba15a383d3da"}, {"sha": "8ea79aa0259c497006bdd56e0690c1420b6d8514", "url": "https://api.github.com/repos/rust-lang/rust/commits/8ea79aa0259c497006bdd56e0690c1420b6d8514", "html_url": "https://github.com/rust-lang/rust/commit/8ea79aa0259c497006bdd56e0690c1420b6d8514"}], "stats": {"total": 51, "additions": 50, "deletions": 1}, "files": [{"sha": "fd6b6e3ca56ec1f8278e0edce8312b1df1366474", "filename": "src/types.rs", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/61919022ddf1f490414304b107946127cd15c6f1/src%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/61919022ddf1f490414304b107946127cd15c6f1/src%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftypes.rs?ref=61919022ddf1f490414304b107946127cd15c6f1", "patch": "@@ -616,7 +616,18 @@ impl Rewrite for ast::TraitRef {\n impl Rewrite for ast::Ty {\n     fn rewrite(&self, context: &RewriteContext, shape: Shape) -> Option<String> {\n         match self.node {\n-            ast::TyKind::TraitObject(ref bounds, ..) => bounds.rewrite(context, shape),\n+            ast::TyKind::TraitObject(ref bounds, tobj_syntax) => {\n+                // we have to consider 'dyn' keyword is used or not!!!\n+                let is_dyn = tobj_syntax == ast::TraitObjectSyntax::Dyn;\n+                // 4 is length of 'dyn '\n+                let shape = if is_dyn { shape.offset_left(4)? } else { shape };\n+                let res = bounds.rewrite(context, shape)?;\n+                if is_dyn {\n+                    Some(format!(\"dyn {}\", res))\n+                } else {\n+                    Some(res)\n+                }\n+            }\n             ast::TyKind::Ptr(ref mt) => {\n                 let prefix = match mt.mutbl {\n                     Mutability::Mutable => \"*mut \","}, {"sha": "fd0ecc9c661e7ca9379d32bd6eb75f9ed774f73a", "filename": "tests/source/issue-2506.rs", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/61919022ddf1f490414304b107946127cd15c6f1/tests%2Fsource%2Fissue-2506.rs", "raw_url": "https://github.com/rust-lang/rust/raw/61919022ddf1f490414304b107946127cd15c6f1/tests%2Fsource%2Fissue-2506.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fissue-2506.rs?ref=61919022ddf1f490414304b107946127cd15c6f1", "patch": "@@ -0,0 +1,16 @@\n+#![feature(dyn_trait)]\n+fn main() {\n+    // checks rustfmt doesn't remove dyn\n+    trait MyTrait {\n+        fn method(&self) -> u64;\n+    }\n+    fn f1(a: Box<dyn MyTrait>) {}\n+\n+    // checks if line wrap works correctly\n+    trait Very_______________________Long__________________Name____________________Trait {\n+        fn method(&self) -> u64;\n+    }\n+\n+    fn f2(a: Box<dyn Very_______________________Long__________________Name____________________Trait+ 'static,>) {}\n+\n+}"}, {"sha": "ee2debee9fb981415b5dd001268321031511a50b", "filename": "tests/target/issue-2506.rs", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/61919022ddf1f490414304b107946127cd15c6f1/tests%2Ftarget%2Fissue-2506.rs", "raw_url": "https://github.com/rust-lang/rust/raw/61919022ddf1f490414304b107946127cd15c6f1/tests%2Ftarget%2Fissue-2506.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-2506.rs?ref=61919022ddf1f490414304b107946127cd15c6f1", "patch": "@@ -0,0 +1,22 @@\n+#![feature(dyn_trait)]\n+fn main() {\n+    // checks rustfmt doesn't remove dyn\n+    trait MyTrait {\n+        fn method(&self) -> u64;\n+    }\n+    fn f1(a: Box<dyn MyTrait>) {}\n+\n+    // checks if line wrap works correctly\n+    trait Very_______________________Long__________________Name____________________Trait\n+         {\n+        fn method(&self) -> u64;\n+    }\n+\n+    fn f2(\n+        a: Box<\n+            dyn Very_______________________Long__________________Name____________________Trait\n+                + 'static,\n+        >,\n+    ) {\n+    }\n+}"}]}