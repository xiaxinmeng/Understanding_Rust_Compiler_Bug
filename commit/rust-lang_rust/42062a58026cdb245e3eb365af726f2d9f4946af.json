{"sha": "42062a58026cdb245e3eb365af726f2d9f4946af", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQyMDYyYTU4MDI2Y2RiMjQ1ZTNlYjM2NWFmNzI2ZjJkOWY0OTQ2YWY=", "commit": {"author": {"name": "Stein Somers", "email": "git@steinsomers.be", "date": "2020-06-22T18:12:11Z"}, "committer": {"name": "Stein Somers", "email": "git@steinsomers.be", "date": "2020-06-26T08:05:21Z"}, "message": "Shortcuts for min/max on ordinary BTreeMap/BTreeSet iterators", "tree": {"sha": "9fbf91061aed07128c731dc73a632eb554dba34e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9fbf91061aed07128c731dc73a632eb554dba34e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/42062a58026cdb245e3eb365af726f2d9f4946af", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/42062a58026cdb245e3eb365af726f2d9f4946af", "html_url": "https://github.com/rust-lang/rust/commit/42062a58026cdb245e3eb365af726f2d9f4946af", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/42062a58026cdb245e3eb365af726f2d9f4946af/comments", "author": {"login": "ssomers", "id": 10174877, "node_id": "MDQ6VXNlcjEwMTc0ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/10174877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssomers", "html_url": "https://github.com/ssomers", "followers_url": "https://api.github.com/users/ssomers/followers", "following_url": "https://api.github.com/users/ssomers/following{/other_user}", "gists_url": "https://api.github.com/users/ssomers/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssomers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssomers/subscriptions", "organizations_url": "https://api.github.com/users/ssomers/orgs", "repos_url": "https://api.github.com/users/ssomers/repos", "events_url": "https://api.github.com/users/ssomers/events{/privacy}", "received_events_url": "https://api.github.com/users/ssomers/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ssomers", "id": 10174877, "node_id": "MDQ6VXNlcjEwMTc0ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/10174877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssomers", "html_url": "https://github.com/ssomers", "followers_url": "https://api.github.com/users/ssomers/followers", "following_url": "https://api.github.com/users/ssomers/following{/other_user}", "gists_url": "https://api.github.com/users/ssomers/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssomers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssomers/subscriptions", "organizations_url": "https://api.github.com/users/ssomers/orgs", "repos_url": "https://api.github.com/users/ssomers/repos", "events_url": "https://api.github.com/users/ssomers/events{/privacy}", "received_events_url": "https://api.github.com/users/ssomers/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e093b6525079cb71d4158f97480ac6f6ce311eac", "url": "https://api.github.com/repos/rust-lang/rust/commits/e093b6525079cb71d4158f97480ac6f6ce311eac", "html_url": "https://github.com/rust-lang/rust/commit/e093b6525079cb71d4158f97480ac6f6ce311eac"}], "stats": {"total": 141, "additions": 141, "deletions": 0}, "files": [{"sha": "bb9091a66594bda1665309811e38deab38fe4bd4", "filename": "src/liballoc/collections/btree/map.rs", "status": "modified", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/42062a58026cdb245e3eb365af726f2d9f4946af/src%2Fliballoc%2Fcollections%2Fbtree%2Fmap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/42062a58026cdb245e3eb365af726f2d9f4946af/src%2Fliballoc%2Fcollections%2Fbtree%2Fmap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Fcollections%2Fbtree%2Fmap.rs?ref=42062a58026cdb245e3eb365af726f2d9f4946af", "patch": "@@ -1396,6 +1396,14 @@ impl<'a, K: 'a, V: 'a> Iterator for Iter<'a, K, V> {\n     fn last(mut self) -> Option<(&'a K, &'a V)> {\n         self.next_back()\n     }\n+\n+    fn min(mut self) -> Option<(&'a K, &'a V)> {\n+        self.next()\n+    }\n+\n+    fn max(mut self) -> Option<(&'a K, &'a V)> {\n+        self.next_back()\n+    }\n }\n \n #[stable(feature = \"fused\", since = \"1.26.0\")]\n@@ -1458,6 +1466,14 @@ impl<'a, K: 'a, V: 'a> Iterator for IterMut<'a, K, V> {\n     fn last(mut self) -> Option<(&'a K, &'a mut V)> {\n         self.next_back()\n     }\n+\n+    fn min(mut self) -> Option<(&'a K, &'a mut V)> {\n+        self.next()\n+    }\n+\n+    fn max(mut self) -> Option<(&'a K, &'a mut V)> {\n+        self.next_back()\n+    }\n }\n \n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n@@ -1595,6 +1611,14 @@ impl<'a, K, V> Iterator for Keys<'a, K, V> {\n     fn last(mut self) -> Option<&'a K> {\n         self.next_back()\n     }\n+\n+    fn min(mut self) -> Option<&'a K> {\n+        self.next()\n+    }\n+\n+    fn max(mut self) -> Option<&'a K> {\n+        self.next_back()\n+    }\n }\n \n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n@@ -1768,6 +1792,14 @@ impl<'a, K, V> Iterator for Range<'a, K, V> {\n     fn last(mut self) -> Option<(&'a K, &'a V)> {\n         self.next_back()\n     }\n+\n+    fn min(mut self) -> Option<(&'a K, &'a V)> {\n+        self.next()\n+    }\n+\n+    fn max(mut self) -> Option<(&'a K, &'a V)> {\n+        self.next_back()\n+    }\n }\n \n #[stable(feature = \"map_values_mut\", since = \"1.10.0\")]\n@@ -1853,6 +1885,14 @@ impl<'a, K, V> Iterator for RangeMut<'a, K, V> {\n     fn last(mut self) -> Option<(&'a K, &'a mut V)> {\n         self.next_back()\n     }\n+\n+    fn min(mut self) -> Option<(&'a K, &'a mut V)> {\n+        self.next()\n+    }\n+\n+    fn max(mut self) -> Option<(&'a K, &'a mut V)> {\n+        self.next_back()\n+    }\n }\n \n impl<'a, K, V> RangeMut<'a, K, V> {"}, {"sha": "d8959966fe5ad38a8f846780af27892a77fba621", "filename": "src/liballoc/collections/btree/set.rs", "status": "modified", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/42062a58026cdb245e3eb365af726f2d9f4946af/src%2Fliballoc%2Fcollections%2Fbtree%2Fset.rs", "raw_url": "https://github.com/rust-lang/rust/raw/42062a58026cdb245e3eb365af726f2d9f4946af/src%2Fliballoc%2Fcollections%2Fbtree%2Fset.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Fcollections%2Fbtree%2Fset.rs?ref=42062a58026cdb245e3eb365af726f2d9f4946af", "patch": "@@ -1291,12 +1291,22 @@ impl<'a, T> Iterator for Iter<'a, T> {\n     fn next(&mut self) -> Option<&'a T> {\n         self.iter.next()\n     }\n+\n     fn size_hint(&self) -> (usize, Option<usize>) {\n         self.iter.size_hint()\n     }\n+\n     fn last(mut self) -> Option<&'a T> {\n         self.next_back()\n     }\n+\n+    fn min(mut self) -> Option<&'a T> {\n+        self.next()\n+    }\n+\n+    fn max(mut self) -> Option<&'a T> {\n+        self.next_back()\n+    }\n }\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n impl<'a, T> DoubleEndedIterator for Iter<'a, T> {\n@@ -1321,6 +1331,7 @@ impl<T> Iterator for IntoIter<T> {\n     fn next(&mut self) -> Option<T> {\n         self.iter.next().map(|(k, _)| k)\n     }\n+\n     fn size_hint(&self) -> (usize, Option<usize>) {\n         self.iter.size_hint()\n     }\n@@ -1359,6 +1370,14 @@ impl<'a, T> Iterator for Range<'a, T> {\n     fn last(mut self) -> Option<&'a T> {\n         self.next_back()\n     }\n+\n+    fn min(mut self) -> Option<&'a T> {\n+        self.next()\n+    }\n+\n+    fn max(mut self) -> Option<&'a T> {\n+        self.next_back()\n+    }\n }\n \n #[stable(feature = \"btree_range\", since = \"1.17.0\")]\n@@ -1429,6 +1448,10 @@ impl<'a, T: Ord> Iterator for Difference<'a, T> {\n         };\n         (self_len.saturating_sub(other_len), Some(self_len))\n     }\n+\n+    fn min(mut self) -> Option<&'a T> {\n+        self.next()\n+    }\n }\n \n #[stable(feature = \"fused\", since = \"1.26.0\")]\n@@ -1460,6 +1483,10 @@ impl<'a, T: Ord> Iterator for SymmetricDifference<'a, T> {\n         // the number of elements to less than half the range of usize.\n         (0, Some(a_len + b_len))\n     }\n+\n+    fn min(mut self) -> Option<&'a T> {\n+        self.next()\n+    }\n }\n \n #[stable(feature = \"fused\", since = \"1.26.0\")]\n@@ -1516,6 +1543,10 @@ impl<'a, T: Ord> Iterator for Intersection<'a, T> {\n             IntersectionInner::Answer(Some(_)) => (1, Some(1)),\n         }\n     }\n+\n+    fn min(mut self) -> Option<&'a T> {\n+        self.next()\n+    }\n }\n \n #[stable(feature = \"fused\", since = \"1.26.0\")]\n@@ -1541,6 +1572,10 @@ impl<'a, T: Ord> Iterator for Union<'a, T> {\n         // No checked_add - see SymmetricDifference::size_hint.\n         (max(a_len, b_len), Some(a_len + b_len))\n     }\n+\n+    fn min(mut self) -> Option<&'a T> {\n+        self.next()\n+    }\n }\n \n #[stable(feature = \"fused\", since = \"1.26.0\")]"}, {"sha": "682d829d219f31ee918ed1fb42ef9c65a00b5189", "filename": "src/liballoc/tests/btree/map.rs", "status": "modified", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/42062a58026cdb245e3eb365af726f2d9f4946af/src%2Fliballoc%2Ftests%2Fbtree%2Fmap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/42062a58026cdb245e3eb365af726f2d9f4946af/src%2Fliballoc%2Ftests%2Fbtree%2Fmap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Ftests%2Fbtree%2Fmap.rs?ref=42062a58026cdb245e3eb365af726f2d9f4946af", "patch": "@@ -309,6 +309,41 @@ fn test_iter_mixed() {\n     test(size, map.into_iter());\n }\n \n+#[test]\n+fn test_iter_min_max() {\n+    let mut a = BTreeMap::new();\n+    assert_eq!(a.iter().min(), None);\n+    assert_eq!(a.iter().max(), None);\n+    assert_eq!(a.iter_mut().min(), None);\n+    assert_eq!(a.iter_mut().max(), None);\n+    assert_eq!(a.range(..).min(), None);\n+    assert_eq!(a.range(..).max(), None);\n+    assert_eq!(a.range_mut(..).min(), None);\n+    assert_eq!(a.range_mut(..).max(), None);\n+    assert_eq!(a.keys().min(), None);\n+    assert_eq!(a.keys().max(), None);\n+    assert_eq!(a.values().min(), None);\n+    assert_eq!(a.values().max(), None);\n+    assert_eq!(a.values_mut().min(), None);\n+    assert_eq!(a.values_mut().max(), None);\n+    a.insert(1, 42);\n+    a.insert(2, 24);\n+    assert_eq!(a.iter().min(), Some((&1, &42)));\n+    assert_eq!(a.iter().max(), Some((&2, &24)));\n+    assert_eq!(a.iter_mut().min(), Some((&1, &mut 42)));\n+    assert_eq!(a.iter_mut().max(), Some((&2, &mut 24)));\n+    assert_eq!(a.range(..).min(), Some((&1, &42)));\n+    assert_eq!(a.range(..).max(), Some((&2, &24)));\n+    assert_eq!(a.range_mut(..).min(), Some((&1, &mut 42)));\n+    assert_eq!(a.range_mut(..).max(), Some((&2, &mut 24)));\n+    assert_eq!(a.keys().min(), Some(&1));\n+    assert_eq!(a.keys().max(), Some(&2));\n+    assert_eq!(a.values().min(), Some(&24));\n+    assert_eq!(a.values().max(), Some(&42));\n+    assert_eq!(a.values_mut().min(), Some(&mut 24));\n+    assert_eq!(a.values_mut().max(), Some(&mut 42));\n+}\n+\n fn range_keys(map: &BTreeMap<i32, i32>, range: impl RangeBounds<i32>) -> Vec<i32> {\n     map.range(range)\n         .map(|(&k, &v)| {"}, {"sha": "b6c34b7c6c346dae023617482ffba7cbff6917d7", "filename": "src/liballoc/tests/btree/set.rs", "status": "modified", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/42062a58026cdb245e3eb365af726f2d9f4946af/src%2Fliballoc%2Ftests%2Fbtree%2Fset.rs", "raw_url": "https://github.com/rust-lang/rust/raw/42062a58026cdb245e3eb365af726f2d9f4946af/src%2Fliballoc%2Ftests%2Fbtree%2Fset.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Ftests%2Fbtree%2Fset.rs?ref=42062a58026cdb245e3eb365af726f2d9f4946af", "patch": "@@ -33,6 +33,37 @@ fn test_hash() {\n     assert_eq!(hash(&x), hash(&y));\n }\n \n+#[test]\n+fn test_iter_min_max() {\n+    let mut a = BTreeSet::new();\n+    assert_eq!(a.iter().min(), None);\n+    assert_eq!(a.iter().max(), None);\n+    assert_eq!(a.range(..).min(), None);\n+    assert_eq!(a.range(..).max(), None);\n+    assert_eq!(a.difference(&BTreeSet::new()).min(), None);\n+    assert_eq!(a.difference(&BTreeSet::new()).max(), None);\n+    assert_eq!(a.intersection(&a).min(), None);\n+    assert_eq!(a.intersection(&a).max(), None);\n+    assert_eq!(a.symmetric_difference(&BTreeSet::new()).min(), None);\n+    assert_eq!(a.symmetric_difference(&BTreeSet::new()).max(), None);\n+    assert_eq!(a.union(&a).min(), None);\n+    assert_eq!(a.union(&a).max(), None);\n+    a.insert(1);\n+    a.insert(2);\n+    assert_eq!(a.iter().min(), Some(&1));\n+    assert_eq!(a.iter().max(), Some(&2));\n+    assert_eq!(a.range(..).min(), Some(&1));\n+    assert_eq!(a.range(..).max(), Some(&2));\n+    assert_eq!(a.difference(&BTreeSet::new()).min(), Some(&1));\n+    assert_eq!(a.difference(&BTreeSet::new()).max(), Some(&2));\n+    assert_eq!(a.intersection(&a).min(), Some(&1));\n+    assert_eq!(a.intersection(&a).max(), Some(&2));\n+    assert_eq!(a.symmetric_difference(&BTreeSet::new()).min(), Some(&1));\n+    assert_eq!(a.symmetric_difference(&BTreeSet::new()).max(), Some(&2));\n+    assert_eq!(a.union(&a).min(), Some(&1));\n+    assert_eq!(a.union(&a).max(), Some(&2));\n+}\n+\n fn check<F>(a: &[i32], b: &[i32], expected: &[i32], f: F)\n where\n     F: FnOnce(&BTreeSet<i32>, &BTreeSet<i32>, &mut dyn FnMut(&i32) -> bool) -> bool,"}]}