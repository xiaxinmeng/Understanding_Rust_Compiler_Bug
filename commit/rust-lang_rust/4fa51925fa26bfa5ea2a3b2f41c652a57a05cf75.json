{"sha": "4fa51925fa26bfa5ea2a3b2f41c652a57a05cf75", "node_id": "C_kwDOAAsO6NoAKDRmYTUxOTI1ZmEyNmJmYTVlYTJhM2IyZjQxYzY1MmE1N2EwNWNmNzU", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-12-28T16:18:03Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-12-28T16:18:14Z"}, "message": "print sysroot build failure error", "tree": {"sha": "3f3371d2d31c34c176d7d79e25cd91401f93a927", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3f3371d2d31c34c176d7d79e25cd91401f93a927"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4fa51925fa26bfa5ea2a3b2f41c652a57a05cf75", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4fa51925fa26bfa5ea2a3b2f41c652a57a05cf75", "html_url": "https://github.com/rust-lang/rust/commit/4fa51925fa26bfa5ea2a3b2f41c652a57a05cf75", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4fa51925fa26bfa5ea2a3b2f41c652a57a05cf75/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fba3d79df09780a9529db09086810759f6dc60ad", "url": "https://api.github.com/repos/rust-lang/rust/commits/fba3d79df09780a9529db09086810759f6dc60ad", "html_url": "https://github.com/rust-lang/rust/commit/fba3d79df09780a9529db09086810759f6dc60ad"}], "stats": {"total": 8, "additions": 5, "deletions": 3}, "files": [{"sha": "2e4f0a71013c06b9fa64b1ea01963d742fa5a3d9", "filename": "src/tools/miri/cargo-miri/src/setup.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/4fa51925fa26bfa5ea2a3b2f41c652a57a05cf75/src%2Ftools%2Fmiri%2Fcargo-miri%2Fsrc%2Fsetup.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4fa51925fa26bfa5ea2a3b2f41c652a57a05cf75/src%2Ftools%2Fmiri%2Fcargo-miri%2Fsrc%2Fsetup.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiri%2Fcargo-miri%2Fsrc%2Fsetup.rs?ref=4fa51925fa26bfa5ea2a3b2f41c652a57a05cf75", "patch": "@@ -137,9 +137,11 @@ pub fn setup(subcommand: &MiriCommand, target: &str, rustc_version: &VersionMeta\n         .rustflags(rustflags)\n         .cargo(cargo_cmd)\n         .build_from_source(&rust_src)\n-        .unwrap_or_else(|_| {\n-            if only_setup {\n-                show_error!(\"failed to build sysroot, see error details above\")\n+        .unwrap_or_else(|err| {\n+            if print_sysroot {\n+                show_error!(\"failed to build sysroot\")\n+            } else if only_setup {\n+                show_error!(\"failed to build sysroot: {err:?}\")\n             } else {\n                 show_error!(\n                     \"failed to build sysroot; run `cargo miri setup` to see the error details\""}]}