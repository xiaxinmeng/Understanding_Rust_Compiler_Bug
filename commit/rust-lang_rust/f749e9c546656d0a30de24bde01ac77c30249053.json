{"sha": "f749e9c546656d0a30de24bde01ac77c30249053", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY3NDllOWM1NDY2NTZkMGEzMGRlMjRiZGUwMWFjNzdjMzAyNDkwNTM=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-07-28T09:36:01Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-07-28T09:36:01Z"}, "message": "Merge #9712\n\n9712: minor: simplify r=matklad a=matklad\n\nbors r+\n\ud83e\udd16\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>", "tree": {"sha": "400a9707ce85ccd19878f8051841d100c8ac0bb0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/400a9707ce85ccd19878f8051841d100c8ac0bb0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f749e9c546656d0a30de24bde01ac77c30249053", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhASUBCRBK7hj4Ov3rIwAAj+gIABDNJ0JzmCVLmr0fX9MZOYKu\nw2vJ0hio/56OcKGShTKqULP3fiqRu/0byuVTdp5gNQq3FwT9BM/awPhZ5H7NzQCn\nBD/qzV8/vgagM1uv5DfogNDtaSwMplSQorD7RT9Q4yBYsbXm2lLtSRW3bF+MlZzN\nKS/tLjBBtIuCaVbQ72SE3vHQEQEqa+2n/lxxaZoon6SVZgp5yd3kVy8gJV/ofTcH\ndhOd88okuhIelyfUEH4WWpKkmjh5L/bpmUsakzV9dNzDtIupwftsLgLd83HJcE/8\n/ugJ/N0FHt3QWBpk8p3BqGrSyB/+sdexMIA2ky3AQnMOb2+2HQqH0g0JIU7w6VM=\n=Yy3i\n-----END PGP SIGNATURE-----\n", "payload": "tree 400a9707ce85ccd19878f8051841d100c8ac0bb0\nparent 6a2a0b7abb5f7de9675cd2b84287dc1e4156001b\nparent ea9f6920fbc5f06442fdf3bc6ec6b0e31f4a2bfd\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1627464961 +0000\ncommitter GitHub <noreply@github.com> 1627464961 +0000\n\nMerge #9712\n\n9712: minor: simplify r=matklad a=matklad\n\nbors r+\n\ud83e\udd16\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f749e9c546656d0a30de24bde01ac77c30249053", "html_url": "https://github.com/rust-lang/rust/commit/f749e9c546656d0a30de24bde01ac77c30249053", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f749e9c546656d0a30de24bde01ac77c30249053/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6a2a0b7abb5f7de9675cd2b84287dc1e4156001b", "url": "https://api.github.com/repos/rust-lang/rust/commits/6a2a0b7abb5f7de9675cd2b84287dc1e4156001b", "html_url": "https://github.com/rust-lang/rust/commit/6a2a0b7abb5f7de9675cd2b84287dc1e4156001b"}, {"sha": "ea9f6920fbc5f06442fdf3bc6ec6b0e31f4a2bfd", "url": "https://api.github.com/repos/rust-lang/rust/commits/ea9f6920fbc5f06442fdf3bc6ec6b0e31f4a2bfd", "html_url": "https://github.com/rust-lang/rust/commit/ea9f6920fbc5f06442fdf3bc6ec6b0e31f4a2bfd"}], "stats": {"total": 25, "additions": 11, "deletions": 14}, "files": [{"sha": "99a29b43d20419189d4eeb0a604d8adcc0970606", "filename": "crates/rust-analyzer/src/config.rs", "status": "modified", "additions": 6, "deletions": 9, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/f749e9c546656d0a30de24bde01ac77c30249053/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f749e9c546656d0a30de24bde01ac77c30249053/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs?ref=f749e9c546656d0a30de24bde01ac77c30249053", "patch": "@@ -582,9 +582,6 @@ impl Config {\n     pub fn code_action_group(&self) -> bool {\n         self.experimental(\"codeActionGroup\")\n     }\n-    pub fn experimental_hover_actions(&self) -> bool {\n-        self.experimental(\"hoverActions\")\n-    }\n     pub fn server_status_notification(&self) -> bool {\n         self.experimental(\"serverStatusNotification\")\n     }\n@@ -790,13 +787,13 @@ impl Config {\n         }\n     }\n     pub fn hover_actions(&self) -> HoverActionsConfig {\n+        let enable = self.experimental(\"hoverActions\") && self.data.hoverActions_enable;\n         HoverActionsConfig {\n-            implementations: self.data.hoverActions_enable\n-                && self.data.hoverActions_implementations,\n-            references: self.data.hoverActions_enable && self.data.hoverActions_references,\n-            run: self.data.hoverActions_enable && self.data.hoverActions_run,\n-            debug: self.data.hoverActions_enable && self.data.hoverActions_debug,\n-            goto_type_def: self.data.hoverActions_enable && self.data.hoverActions_gotoTypeDef,\n+            implementations: enable && self.data.hoverActions_implementations,\n+            references: enable && self.data.hoverActions_references,\n+            run: enable && self.data.hoverActions_run,\n+            debug: enable && self.data.hoverActions_debug,\n+            goto_type_def: enable && self.data.hoverActions_gotoTypeDef,\n         }\n     }\n     pub fn highlighting_strings(&self) -> bool {"}, {"sha": "129b35999d0d3661c5a6cf441bdb7d9c542a9cdd", "filename": "crates/rust-analyzer/src/handlers.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/f749e9c546656d0a30de24bde01ac77c30249053/crates%2Frust-analyzer%2Fsrc%2Fhandlers.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f749e9c546656d0a30de24bde01ac77c30249053/crates%2Frust-analyzer%2Fsrc%2Fhandlers.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fhandlers.rs?ref=f749e9c546656d0a30de24bde01ac77c30249053", "patch": "@@ -882,7 +882,11 @@ pub(crate) fn handle_hover(\n             contents: HoverContents::Markup(to_proto::markup_content(info.info.markup)),\n             range: Some(range),\n         },\n-        actions: prepare_hover_actions(&snap, &info.info.actions),\n+        actions: if snap.config.hover_actions().none() {\n+            Vec::new()\n+        } else {\n+            prepare_hover_actions(&snap, &info.info.actions)\n+        },\n     };\n \n     Ok(Some(hover))\n@@ -1594,10 +1598,6 @@ fn prepare_hover_actions(\n     snap: &GlobalStateSnapshot,\n     actions: &[HoverAction],\n ) -> Vec<lsp_ext::CommandLinkGroup> {\n-    if snap.config.hover_actions().none() || !snap.config.experimental_hover_actions() {\n-        return Vec::new();\n-    }\n-\n     actions\n         .iter()\n         .filter_map(|it| match it {"}]}