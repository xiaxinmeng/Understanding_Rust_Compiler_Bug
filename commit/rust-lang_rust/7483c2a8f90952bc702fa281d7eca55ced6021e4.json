{"sha": "7483c2a8f90952bc702fa281d7eca55ced6021e4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc0ODNjMmE4ZjkwOTUyYmM3MDJmYTI4MWQ3ZWNhNTVjZWQ2MDIxZTQ=", "commit": {"author": {"name": "Marcus Klaas de Vries", "email": "mail@marcusklaas.nl", "date": "2015-11-23T21:09:28Z"}, "committer": {"name": "Marcus Klaas de Vries", "email": "mail@marcusklaas.nl", "date": "2015-11-23T21:09:28Z"}, "message": "Merge pull request #642 from rust-lang-nursery/impl\n\nImplement formatting of impls", "tree": {"sha": "5b6f38b561304eac9bb13852af1cf9bb612f6239", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5b6f38b561304eac9bb13852af1cf9bb612f6239"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7483c2a8f90952bc702fa281d7eca55ced6021e4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7483c2a8f90952bc702fa281d7eca55ced6021e4", "html_url": "https://github.com/rust-lang/rust/commit/7483c2a8f90952bc702fa281d7eca55ced6021e4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7483c2a8f90952bc702fa281d7eca55ced6021e4/comments", "author": {"login": "marcusklaas", "id": 1255413, "node_id": "MDQ6VXNlcjEyNTU0MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1255413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcusklaas", "html_url": "https://github.com/marcusklaas", "followers_url": "https://api.github.com/users/marcusklaas/followers", "following_url": "https://api.github.com/users/marcusklaas/following{/other_user}", "gists_url": "https://api.github.com/users/marcusklaas/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcusklaas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcusklaas/subscriptions", "organizations_url": "https://api.github.com/users/marcusklaas/orgs", "repos_url": "https://api.github.com/users/marcusklaas/repos", "events_url": "https://api.github.com/users/marcusklaas/events{/privacy}", "received_events_url": "https://api.github.com/users/marcusklaas/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marcusklaas", "id": 1255413, "node_id": "MDQ6VXNlcjEyNTU0MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1255413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcusklaas", "html_url": "https://github.com/marcusklaas", "followers_url": "https://api.github.com/users/marcusklaas/followers", "following_url": "https://api.github.com/users/marcusklaas/following{/other_user}", "gists_url": "https://api.github.com/users/marcusklaas/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcusklaas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcusklaas/subscriptions", "organizations_url": "https://api.github.com/users/marcusklaas/orgs", "repos_url": "https://api.github.com/users/marcusklaas/repos", "events_url": "https://api.github.com/users/marcusklaas/events{/privacy}", "received_events_url": "https://api.github.com/users/marcusklaas/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5a3f5bc1f61a73ab8db241dfadf0855c504a9906", "url": "https://api.github.com/repos/rust-lang/rust/commits/5a3f5bc1f61a73ab8db241dfadf0855c504a9906", "html_url": "https://github.com/rust-lang/rust/commit/5a3f5bc1f61a73ab8db241dfadf0855c504a9906"}, {"sha": "d405fdc2363486173b56deef1dc05ef7ea53c04b", "url": "https://api.github.com/repos/rust-lang/rust/commits/d405fdc2363486173b56deef1dc05ef7ea53c04b", "html_url": "https://github.com/rust-lang/rust/commit/d405fdc2363486173b56deef1dc05ef7ea53c04b"}], "stats": {"total": 47, "additions": 43, "deletions": 4}, "files": [{"sha": "6ca82721689972d4ad06deea95ab9c65b52de59f", "filename": "src/items.rs", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/7483c2a8f90952bc702fa281d7eca55ced6021e4/src%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7483c2a8f90952bc702fa281d7eca55ced6021e4/src%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fitems.rs?ref=7483c2a8f90952bc702fa281d7eca55ced6021e4", "patch": "@@ -506,10 +506,6 @@ pub fn format_impl(context: &RewriteContext, item: &ast::Item, offset: Indent) -\n         result.push('{');\n \n         if !items.is_empty() {\n-            result.push('\\n');\n-            let indent_str = context.block_indent.to_string(context.config);\n-            result.push_str(&indent_str);\n-\n             let mut visitor = FmtVisitor::from_codemap(context.parse_session, context.config, None);\n             visitor.block_indent = context.block_indent.block_indent(context.config);\n \n@@ -521,8 +517,11 @@ pub fn format_impl(context: &RewriteContext, item: &ast::Item, offset: Indent) -\n                 visitor.visit_impl_item(&item);\n             }\n \n+            result.push('\\n');\n             result.push_str(trim_newlines(&visitor.buffer.to_string()));\n             result.push('\\n');\n+\n+            let indent_str = context.block_indent.to_string(context.config);\n             result.push_str(&indent_str);\n         }\n         result.push('}');"}, {"sha": "499b07afd27b6e939a0e280e861d34023077dde4", "filename": "tests/source/impls.rs", "status": "modified", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/7483c2a8f90952bc702fa281d7eca55ced6021e4/tests%2Fsource%2Fimpls.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7483c2a8f90952bc702fa281d7eca55ced6021e4/tests%2Fsource%2Fimpls.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fimpls.rs?ref=7483c2a8f90952bc702fa281d7eca55ced6021e4", "patch": "@@ -21,3 +21,23 @@ impl<'a, 'b, X, Y: Foo<Bar>> Foo<'a, X> for Bar<'b, Y> where X: Fooooooooooooooo\n {\n     fn foo() { \"hi\" }    \n }\n+\n+impl Foo {\n+    fn foo() {}\n+}\n+\n+mod a {\n+    impl Foo {\n+        // Hello!\n+        fn foo() {}\n+    }\n+}\n+\n+\n+mod b {\n+    mod a {\n+        impl Foo {\n+            fn foo() {}\n+        }\n+    }\n+}"}, {"sha": "d491dbfcea8cc44724f067545fe60e3c74174c71", "filename": "tests/target/impls.rs", "status": "modified", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/7483c2a8f90952bc702fa281d7eca55ced6021e4/tests%2Ftarget%2Fimpls.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7483c2a8f90952bc702fa281d7eca55ced6021e4/tests%2Ftarget%2Fimpls.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fimpls.rs?ref=7483c2a8f90952bc702fa281d7eca55ced6021e4", "patch": "@@ -36,3 +36,23 @@ impl<'a, 'b, X, Y: Foo<Bar>> Foo<'a, X> for Bar<'b, Y> where X: Fooooooooooooooo\n         \"hi\"\n     }\n }\n+\n+impl Foo {\n+    fn foo() {}\n+}\n+\n+mod a {\n+    impl Foo {\n+        // Hello!\n+        fn foo() {}\n+    }\n+}\n+\n+\n+mod b {\n+    mod a {\n+        impl Foo {\n+            fn foo() {}\n+        }\n+    }\n+}"}]}