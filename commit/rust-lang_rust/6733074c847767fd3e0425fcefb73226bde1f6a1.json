{"sha": "6733074c847767fd3e0425fcefb73226bde1f6a1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY3MzMwNzRjODQ3NzY3ZmQzZTA0MjVmY2VmYjczMjI2YmRlMWY2YTE=", "commit": {"author": {"name": "Jeremy Soller", "email": "jackpot51@gmail.com", "date": "2016-11-23T21:22:39Z"}, "committer": {"name": "Jeremy Soller", "email": "jackpot51@gmail.com", "date": "2016-11-23T21:22:39Z"}, "message": "Allow setting nonblock on sockets", "tree": {"sha": "1d931b8c3ec476c4191402c9bce2eaee5470b0c4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1d931b8c3ec476c4191402c9bce2eaee5470b0c4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6733074c847767fd3e0425fcefb73226bde1f6a1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6733074c847767fd3e0425fcefb73226bde1f6a1", "html_url": "https://github.com/rust-lang/rust/commit/6733074c847767fd3e0425fcefb73226bde1f6a1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6733074c847767fd3e0425fcefb73226bde1f6a1/comments", "author": {"login": "jackpot51", "id": 7741236, "node_id": "MDQ6VXNlcjc3NDEyMzY=", "avatar_url": "https://avatars.githubusercontent.com/u/7741236?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackpot51", "html_url": "https://github.com/jackpot51", "followers_url": "https://api.github.com/users/jackpot51/followers", "following_url": "https://api.github.com/users/jackpot51/following{/other_user}", "gists_url": "https://api.github.com/users/jackpot51/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackpot51/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackpot51/subscriptions", "organizations_url": "https://api.github.com/users/jackpot51/orgs", "repos_url": "https://api.github.com/users/jackpot51/repos", "events_url": "https://api.github.com/users/jackpot51/events{/privacy}", "received_events_url": "https://api.github.com/users/jackpot51/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jackpot51", "id": 7741236, "node_id": "MDQ6VXNlcjc3NDEyMzY=", "avatar_url": "https://avatars.githubusercontent.com/u/7741236?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackpot51", "html_url": "https://github.com/jackpot51", "followers_url": "https://api.github.com/users/jackpot51/followers", "following_url": "https://api.github.com/users/jackpot51/following{/other_user}", "gists_url": "https://api.github.com/users/jackpot51/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackpot51/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackpot51/subscriptions", "organizations_url": "https://api.github.com/users/jackpot51/orgs", "repos_url": "https://api.github.com/users/jackpot51/repos", "events_url": "https://api.github.com/users/jackpot51/events{/privacy}", "received_events_url": "https://api.github.com/users/jackpot51/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4a0bc71bb7e32d7f63d10be13055942fb5dc6aca", "url": "https://api.github.com/repos/rust-lang/rust/commits/4a0bc71bb7e32d7f63d10be13055942fb5dc6aca", "html_url": "https://github.com/rust-lang/rust/commit/4a0bc71bb7e32d7f63d10be13055942fb5dc6aca"}], "stats": {"total": 27, "additions": 16, "deletions": 11}, "files": [{"sha": "b716965860e1dc914c69972a347dc2db012d6bbf", "filename": "src/libstd/sys/redox/fd.rs", "status": "modified", "additions": 10, "deletions": 5, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/6733074c847767fd3e0425fcefb73226bde1f6a1/src%2Flibstd%2Fsys%2Fredox%2Ffd.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6733074c847767fd3e0425fcefb73226bde1f6a1/src%2Flibstd%2Fsys%2Fredox%2Ffd.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fredox%2Ffd.rs?ref=6733074c847767fd3e0425fcefb73226bde1f6a1", "patch": "@@ -48,6 +48,16 @@ impl FileDesc {\n         cvt(libc::write(self.fd, buf))\n     }\n \n+    pub fn duplicate(&self) -> io::Result<FileDesc> {\n+        let new_fd = cvt(libc::dup(self.fd, &[]))?;\n+        Ok(FileDesc::new(new_fd))\n+    }\n+\n+    pub fn nonblocking(&self) -> io::Result<bool> {\n+        let flags = cvt(libc::fcntl(self.fd, libc::F_GETFL, 0))?;\n+        Ok(flags & libc::O_NONBLOCK == libc::O_NONBLOCK)\n+    }\n+\n     pub fn set_cloexec(&self) -> io::Result<()> {\n         let mut flags = cvt(libc::fcntl(self.fd, libc::F_GETFL, 0))?;\n         flags |= libc::O_CLOEXEC;\n@@ -63,11 +73,6 @@ impl FileDesc {\n         }\n         cvt(libc::fcntl(self.fd, libc::F_SETFL, flags)).and(Ok(()))\n     }\n-\n-    pub fn duplicate(&self) -> io::Result<FileDesc> {\n-        let new_fd = cvt(libc::dup(self.fd, &[]))?;\n-        Ok(FileDesc::new(new_fd))\n-    }\n }\n \n impl<'a> Read for &'a FileDesc {"}, {"sha": "ceaa5df267fd33254171e59aba6f08e1d123b3e3", "filename": "src/libstd/sys/redox/net/tcp.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6733074c847767fd3e0425fcefb73226bde1f6a1/src%2Flibstd%2Fsys%2Fredox%2Fnet%2Ftcp.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6733074c847767fd3e0425fcefb73226bde1f6a1/src%2Flibstd%2Fsys%2Fredox%2Fnet%2Ftcp.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fredox%2Fnet%2Ftcp.rs?ref=6733074c847767fd3e0425fcefb73226bde1f6a1", "patch": "@@ -58,7 +58,7 @@ impl TcpStream {\n     }\n \n     pub fn nonblocking(&self) -> Result<bool> {\n-        Err(Error::new(ErrorKind::Other, \"TcpStream::nonblocking not implemented\"))\n+        self.0.fd().nonblocking()\n     }\n \n     pub fn only_v6(&self) -> Result<bool> {\n@@ -81,8 +81,8 @@ impl TcpStream {\n         Err(Error::new(ErrorKind::Other, \"TcpStream::set_nodelay not implemented\"))\n     }\n \n-    pub fn set_nonblocking(&self, _nonblocking: bool) -> Result<()> {\n-        Err(Error::new(ErrorKind::Other, \"TcpStream::set_nonblocking not implemented\"))\n+    pub fn set_nonblocking(&self, nonblocking: bool) -> Result<()> {\n+        self.0.fd().set_nonblocking(nonblocking)\n     }\n \n     pub fn set_only_v6(&self, _only_v6: bool) -> Result<()> {"}, {"sha": "7856de033eb15d4066fde020486a53c0bca94780", "filename": "src/libstd/sys/redox/net/udp.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6733074c847767fd3e0425fcefb73226bde1f6a1/src%2Flibstd%2Fsys%2Fredox%2Fnet%2Fudp.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6733074c847767fd3e0425fcefb73226bde1f6a1/src%2Flibstd%2Fsys%2Fredox%2Fnet%2Fudp.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fredox%2Fnet%2Fudp.rs?ref=6733074c847767fd3e0425fcefb73226bde1f6a1", "patch": "@@ -90,7 +90,7 @@ impl UdpSocket {\n     }\n \n     pub fn nonblocking(&self) -> Result<bool> {\n-        Err(Error::new(ErrorKind::Other, \"UdpSocket::nonblocking not implemented\"))\n+        self.0.fd().nonblocking()\n     }\n \n     pub fn only_v6(&self) -> Result<bool> {\n@@ -125,8 +125,8 @@ impl UdpSocket {\n         Err(Error::new(ErrorKind::Other, \"UdpSocket::set_multicast_ttl_v4 not implemented\"))\n     }\n \n-    pub fn set_nonblocking(&self, _nonblocking: bool) -> Result<()> {\n-        Err(Error::new(ErrorKind::Other, \"UdpSocket::set_nonblocking not implemented\"))\n+    pub fn set_nonblocking(&self, nonblocking: bool) -> Result<()> {\n+        self.0.fd().set_nonblocking(nonblocking)\n     }\n \n     pub fn set_only_v6(&self, _only_v6: bool) -> Result<()> {"}]}