{"sha": "d199b83b5571f18391fc82d253ccd51d4a5cbaa3", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQxOTliODNiNTU3MWYxODM5MWZjODJkMjUzY2NkNTFkNGE1Y2JhYTM=", "commit": {"author": {"name": "CohenArthur", "email": "arthur.cohen@epita.fr", "date": "2020-08-22T13:19:48Z"}, "committer": {"name": "CohenArthur", "email": "arthur.cohen@epita.fr", "date": "2020-08-22T13:19:48Z"}, "message": "FunctionCx: WIP: Replace .constants with codegen_cx.constants", "tree": {"sha": "4636607c4e903fd5944b968f9dad00f5a3ce3832", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4636607c4e903fd5944b968f9dad00f5a3ce3832"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d199b83b5571f18391fc82d253ccd51d4a5cbaa3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d199b83b5571f18391fc82d253ccd51d4a5cbaa3", "html_url": "https://github.com/rust-lang/rust/commit/d199b83b5571f18391fc82d253ccd51d4a5cbaa3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d199b83b5571f18391fc82d253ccd51d4a5cbaa3/comments", "author": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "committer": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cb69c7019c91f284a28d83ab898ee2d8dd0653f2", "url": "https://api.github.com/repos/rust-lang/rust/commits/cb69c7019c91f284a28d83ab898ee2d8dd0653f2", "html_url": "https://github.com/rust-lang/rust/commit/cb69c7019c91f284a28d83ab898ee2d8dd0653f2"}], "stats": {"total": 10, "additions": 5, "deletions": 5}, "files": [{"sha": "1466ae9f8285626e28e13f65c8e3d50f7cd5bc50", "filename": "src/base.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d199b83b5571f18391fc82d253ccd51d4a5cbaa3/src%2Fbase.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d199b83b5571f18391fc82d253ccd51d4a5cbaa3/src%2Fbase.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbase.rs?ref=d199b83b5571f18391fc82d253ccd51d4a5cbaa3", "patch": "@@ -49,7 +49,7 @@ pub(crate) fn trans_fn<'tcx, B: Backend + 'static>(\n         cold_blocks: EntitySet::new(),\n \n         clif_comments,\n-        constants_cx: &mut cx.constants_cx,\n+        constants_cx: &mut cxcodegen_cx.constants_cx,\n         vtables: &mut cx.vtables,\n         source_info_set: indexmap::IndexSet::new(),\n         next_ssa_var: 0,"}, {"sha": "1eb6042b0b281d320e0554fb4ff4b7ad6e420e51", "filename": "src/constant.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d199b83b5571f18391fc82d253ccd51d4a5cbaa3/src%2Fconstant.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d199b83b5571f18391fc82d253ccd51d4a5cbaa3/src%2Fconstant.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconstant.rs?ref=d199b83b5571f18391fc82d253ccd51d4a5cbaa3", "patch": "@@ -167,7 +167,7 @@ pub(crate) fn trans_const_value<'tcx>(\n                     let alloc_kind = fxcodegen_cx.tcx.get_global_alloc(ptr.alloc_id);\n                     let base_addr = match alloc_kind {\n                         Some(GlobalAlloc::Memory(alloc)) => {\n-                            fx.constants_cx.todo.push(TodoItem::Alloc(ptr.alloc_id));\n+                            fxcodegen_cx.constants_cx.todo.push(TodoItem::Alloc(ptr.alloc_id));\n                             let data_id = data_id_for_alloc_id(fxcodegen_cx.module, ptr.alloc_id, alloc.align, alloc.mutability);\n                             let local_data_id = fxcodegen_cx.module.declare_data_in_func(data_id, &mut fx.bcx.func);\n                             #[cfg(debug_assertions)]\n@@ -216,7 +216,7 @@ fn pointer_for_allocation<'tcx>(\n     alloc: &'tcx Allocation,\n ) -> crate::pointer::Pointer {\n     let alloc_id = fxcodegen_cx.tcx.create_memory_alloc(alloc);\n-    fx.constants_cx.todo.push(TodoItem::Alloc(alloc_id));\n+    fxcodegen_cx.constants_cx.todo.push(TodoItem::Alloc(alloc_id));\n     let data_id = data_id_for_alloc_id(fxcodegen_cx.module, alloc_id, alloc.align, alloc.mutability);\n \n     let local_data_id = fxcodegen_cx.module.declare_data_in_func(data_id, &mut fx.bcx.func);"}, {"sha": "ab397d7c7fd467fee4a318135c09e18243b43fc4", "filename": "src/driver/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d199b83b5571f18391fc82d253ccd51d4a5cbaa3/src%2Fdriver%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d199b83b5571f18391fc82d253ccd51d4a5cbaa3/src%2Fdriver%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdriver%2Fmod.rs?ref=d199b83b5571f18391fc82d253ccd51d4a5cbaa3", "patch": "@@ -88,7 +88,7 @@ fn trans_mono_item<'tcx, B: Backend + 'static>(\n             cxcodegen_cx.tcx.sess.time(\"codegen fn\", || crate::base::trans_fn(cx, inst, linkage));\n         }\n         MonoItem::Static(def_id) => {\n-            crate::constant::codegen_static(&mut cx.constants_cx, def_id);\n+            crate::constant::codegen_static(&mut cxcodegen_cx.constants_cx, def_id);\n         }\n         MonoItem::GlobalAsm(hir_id) => {\n             let item = tcx.hir().expect_item(hir_id);"}, {"sha": "9ab9ad8c81a35ebe23724877f564af811a523ba6", "filename": "src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d199b83b5571f18391fc82d253ccd51d4a5cbaa3/src%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d199b83b5571f18391fc82d253ccd51d4a5cbaa3/src%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib.rs?ref=d199b83b5571f18391fc82d253ccd51d4a5cbaa3", "patch": "@@ -160,7 +160,7 @@ impl<'tcx, B: Backend + 'static> CodegenCx<'tcx, B> {\n     }\n \n     fn finalize(mut self) -> (Module<B>, String, Option<DebugContext<'tcx>>, UnwindContext<'tcx>) {\n-        self.constants_cx.finalize(selfcodegen_cx.tcx, &mut selfcodegen_cx.module);\n+        selfcodegen_cx.constants_cx.finalize(selfcodegen_cx.tcx, &mut selfcodegen_cx.module);\n         (selfcodegen_cx.module, self.global_asm, self.debug_context, self.unwind_context)\n     }\n }"}]}