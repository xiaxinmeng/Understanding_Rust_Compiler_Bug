{"sha": "e771a7d3533664b5b0c6e8430d1d8e41cdfb8d68", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU3NzFhN2QzNTMzNjY0YjViMGM2ZTg0MzBkMWQ4ZTQxY2RmYjhkNjg=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2018-12-15T13:57:17Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2018-12-15T13:57:17Z"}, "message": "Revert \"Rollup merge of #56758 - Manishearth:emoji-status-toolstate, r=kennytm\"\n\nThis reverts commit 050bb10dc3e1d1c6a0aee3c50955d401658dece5, reversing\nchanges made to c530e31245ba10b2587bc908a65bd6e7910bc50f.", "tree": {"sha": "7e2c9ebc07bd6a30722923697b94fefd82ec3a81", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7e2c9ebc07bd6a30722923697b94fefd82ec3a81"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e771a7d3533664b5b0c6e8430d1d8e41cdfb8d68", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v2\n\niQIcBAABCAAGBQJcFQhBAAoJED4Gq+gLqvGcy8kP/0+8ce3Feu1voL3171jl4biF\nxblCmWq+zljoCAkPDTtR2vDDKIw1s9WYmKyuNo/Pz0OAoOEMl6ihTiRDqSG6pkTO\nI1NXix42olJfo68Up5WNew0Om19s015Q6UHDKNHnN2tmIFixZ9yAeg/EsESyY8KF\n1inxGtavoWLK5sYICO82+kySZtVRO709fdwTlK+l/LnnQ7jXTXtZ/YIiOCw+t/xV\nXJLv8oMs7Clw18bcz5GFmcamDaWFu4lPT1X4xQ6tjhDKkux3AAYs2+mgQaUow8j+\n5f0aN7zmI4Z3qcQUvNjyi5FpJFjJrydkWvtsZm6lTbfYUIa2slXB6A8JVenaXAUU\nhvPR8788gQNxMbdQTCWcLOO4ML9XH8KwSm07ToPJlLgVrzRoQSosL9R0of0FAD+2\nRbnY6E5rQvn8gYnBSkD+x4XC8IF3WYv2Qnylpdj8ggqdARv9bKYMxo4iTbOiJNR6\nVI679s3/mzFOeLU0u6lwPMmJ+RyCrhszAECbCRhfwb6M9fjAm9e3VQvxgk0cUIV5\nV72QkkozeGcQWMUzDTsOAoKGlLIFgD+2wwoq66Id+brijKcgxMzC//Ea0NV5D2oS\n/dzmNd3GgSpns1ySYH/CtCM1ZWT4dUPoaPh8CiSJ1WNFCBvU62Q+lak1j2ib51zQ\nQvsHdqZG5LUQL4JKSlvm\n=a+OR\n-----END PGP SIGNATURE-----", "payload": "tree 7e2c9ebc07bd6a30722923697b94fefd82ec3a81\nparent 0a1b2267e45ed0a5bdbfcbe522024729c8bd1387\nauthor Pietro Albini <pietro@pietroalbini.org> 1544882237 +0100\ncommitter Pietro Albini <pietro@pietroalbini.org> 1544882237 +0100\n\nRevert \"Rollup merge of #56758 - Manishearth:emoji-status-toolstate, r=kennytm\"\n\nThis reverts commit 050bb10dc3e1d1c6a0aee3c50955d401658dece5, reversing\nchanges made to c530e31245ba10b2587bc908a65bd6e7910bc50f.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e771a7d3533664b5b0c6e8430d1d8e41cdfb8d68", "html_url": "https://github.com/rust-lang/rust/commit/e771a7d3533664b5b0c6e8430d1d8e41cdfb8d68", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e771a7d3533664b5b0c6e8430d1d8e41cdfb8d68/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0a1b2267e45ed0a5bdbfcbe522024729c8bd1387", "url": "https://api.github.com/repos/rust-lang/rust/commits/0a1b2267e45ed0a5bdbfcbe522024729c8bd1387", "html_url": "https://github.com/rust-lang/rust/commit/0a1b2267e45ed0a5bdbfcbe522024729c8bd1387"}], "stats": {"total": 32, "additions": 7, "deletions": 25}, "files": [{"sha": "4ade87f5d65bd2c167175bcf27ca178a28df1b50", "filename": "src/tools/publish_toolstate.py", "status": "modified", "additions": 7, "deletions": 25, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/e771a7d3533664b5b0c6e8430d1d8e41cdfb8d68/src%2Ftools%2Fpublish_toolstate.py", "raw_url": "https://github.com/rust-lang/rust/raw/e771a7d3533664b5b0c6e8430d1d8e41cdfb8d68/src%2Ftools%2Fpublish_toolstate.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fpublish_toolstate.py?ref=e771a7d3533664b5b0c6e8430d1d8e41cdfb8d68", "patch": "@@ -34,16 +34,6 @@\n     'rust-by-example': '@steveklabnik @marioidival @projektir',\n }\n \n-EMOJI = {\n-    'miri': '\ud83d\udef0\ufe0f',\n-    'clippy-driver': '\ud83d\udcce',\n-    'rls': '\ud83d\udcbb',\n-    'rustfmt': '\ud83d\udcdd',\n-    'book': '\ud83d\udcd6',\n-    'nomicon': '\ud83d\udc7f',\n-    'reference': '\ud83d\udcda',\n-    'rust-by-example': '\ud83d\udc69\u200d\ud83c\udfeb',\n-}\n \n def read_current_status(current_commit, path):\n     '''Reads build status of `current_commit` from content of `history/*.tsv`\n@@ -73,12 +63,13 @@ def update_latest(\n         }\n \n         slug = 'rust-lang/rust'\n-        long_message = textwrap.dedent('''\\\n+        message = textwrap.dedent('''\\\n+            \ud83d\udce3 Toolstate changed by {}!\n+\n             Tested on commit {}@{}.\n             Direct link to PR: <{}>\n \n-        ''').format(slug, current_commit, relevant_pr_url)\n-        emoji_status = []\n+        ''').format(relevant_pr_number, slug, current_commit, relevant_pr_url)\n         anything_changed = False\n         for status in latest:\n             tool = status['tool']\n@@ -90,18 +81,12 @@ def update_latest(\n                 status[os] = new\n                 if new > old:\n                     changed = True\n-                    long_message += '\ud83c\udf89 {} on {}: {} \u2192 {}.\\n' \\\n-                        .format(tool, os, old, new)\n-                    emoji = \"{}\ud83c\udf89\".format(EMOJI.get(tool))\n-                    if msg not in emoji_status:\n-                        emoji_status += [msg]\n+                    message += '\ud83c\udf89 {} on {}: {} \u2192 {} (cc {}, @rust-lang/infra).\\n' \\\n+                        .format(tool, os, old, new, MAINTAINERS.get(tool))\n                 elif new < old:\n                     changed = True\n-                    long_message += '\ud83d\udc94 {} on {}: {} \u2192 {} (cc {}, @rust-lang/infra).\\n' \\\n+                    message += '\ud83d\udc94 {} on {}: {} \u2192 {} (cc {}, @rust-lang/infra).\\n' \\\n                         .format(tool, os, old, new, MAINTAINERS.get(tool))\n-                    emoji = \"{}\ud83d\udc94\".format(EMOJI.get(tool))\n-                    if msg not in emoji_status:\n-                        emoji_status += [msg]\n \n             if changed:\n                 status['commit'] = current_commit\n@@ -111,9 +96,6 @@ def update_latest(\n         if not anything_changed:\n             return ''\n \n-        short_message = \"\ud83d\udce3 Toolstate changed by {}! ({})\"\n-            .format(relevant_pr_number, '/'.join(emoji_status))\n-        message = short_message + \"\\n\\n\" + long_message\n         f.seek(0)\n         f.truncate(0)\n         json.dump(latest, f, indent=4, separators=(',', ': '))"}]}