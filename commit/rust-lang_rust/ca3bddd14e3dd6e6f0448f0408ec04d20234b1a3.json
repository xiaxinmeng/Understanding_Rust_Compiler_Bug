{"sha": "ca3bddd14e3dd6e6f0448f0408ec04d20234b1a3", "node_id": "C_kwDOAAsO6NoAKGNhM2JkZGQxNGUzZGQ2ZTZmMDQ0OGYwNDA4ZWMwNGQyMDIzNGIxYTM", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2022-05-18T23:22:41Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-05-18T23:22:41Z"}, "message": "Rollup merge of #96866 - Mark-Simulacrum:intelligent-tiering-ci, r=pietroalbini\n\nSwitch CI bucket uploads to intelligent tiering\n\nWe currently upload approximately 166 GB/day into this bucket (estimate based on\nduration of storage and total current size). My estimate is that this change\nshould decrease our costs (which are currently in credits) and is in the worst\ncase (if all objects are brought into hot storage due to unanticipated frequent\naccess) only going to add an additional ~$4 to the monthly bill. If access is\nrare (as expected) to most objects then we expect to save approximately\n~$350/month (after this change takes full effect in ~168 days).\n\nr? ``@pietroalbini``", "tree": {"sha": "cc5a904648b0d03da6cf37b9763fe51812aadd49", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cc5a904648b0d03da6cf37b9763fe51812aadd49"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ca3bddd14e3dd6e6f0448f0408ec04d20234b1a3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJihX/CCRBK7hj4Ov3rIwAAeJIIAIhTyPxH9vCyCn22WHas34Za\nM4cF/F8UgcMA41NgeWRh4UiwCHFQIsTDQ8rOb4DhAQ6OVi011dhsCVLNmNIsmnkE\nZhcSuAh7oC1rh+7bXU2B1rAw9M3YJtq1OpSYJLUesvvjokTHxKKLT/dFIC53xO2C\nNsOmvDn5UGSMun1J10rU8bbVJlEHASYS+2n5uTfMvasyEY0yyhGgxS4aSJhWmmVn\nJxsW/LybZTSnEcUy8uwl3HayM2895ub6lzzrfqq9pPjH4UyyI/EHTkdSiyNpdGZj\n3vGfV1J3err71xfdpxitY2Px22jSxHiGl04Hq8qXnziqGzFd6xZiP7sIb929JCA=\n=2pYp\n-----END PGP SIGNATURE-----\n", "payload": "tree cc5a904648b0d03da6cf37b9763fe51812aadd49\nparent cd282d7f75da9080fda0f1740a729516e7fbec68\nparent 10a5f28ff4580b5bb143e744c62340886e67682a\nauthor Yuki Okushi <jtitor@2k36.org> 1652916161 +0900\ncommitter GitHub <noreply@github.com> 1652916161 +0900\n\nRollup merge of #96866 - Mark-Simulacrum:intelligent-tiering-ci, r=pietroalbini\n\nSwitch CI bucket uploads to intelligent tiering\n\nWe currently upload approximately 166 GB/day into this bucket (estimate based on\nduration of storage and total current size). My estimate is that this change\nshould decrease our costs (which are currently in credits) and is in the worst\ncase (if all objects are brought into hot storage due to unanticipated frequent\naccess) only going to add an additional ~$4 to the monthly bill. If access is\nrare (as expected) to most objects then we expect to save approximately\n~$350/month (after this change takes full effect in ~168 days).\n\nr? ``@pietroalbini``\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ca3bddd14e3dd6e6f0448f0408ec04d20234b1a3", "html_url": "https://github.com/rust-lang/rust/commit/ca3bddd14e3dd6e6f0448f0408ec04d20234b1a3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ca3bddd14e3dd6e6f0448f0408ec04d20234b1a3/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cd282d7f75da9080fda0f1740a729516e7fbec68", "url": "https://api.github.com/repos/rust-lang/rust/commits/cd282d7f75da9080fda0f1740a729516e7fbec68", "html_url": "https://github.com/rust-lang/rust/commit/cd282d7f75da9080fda0f1740a729516e7fbec68"}, {"sha": "10a5f28ff4580b5bb143e744c62340886e67682a", "url": "https://api.github.com/repos/rust-lang/rust/commits/10a5f28ff4580b5bb143e744c62340886e67682a", "html_url": "https://github.com/rust-lang/rust/commit/10a5f28ff4580b5bb143e744c62340886e67682a"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "cea9b770f2a20a8b4e66b53c5256ff11eeddf026", "filename": "src/ci/scripts/upload-artifacts.sh", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ca3bddd14e3dd6e6f0448f0408ec04d20234b1a3/src%2Fci%2Fscripts%2Fupload-artifacts.sh", "raw_url": "https://github.com/rust-lang/rust/raw/ca3bddd14e3dd6e6f0448f0408ec04d20234b1a3/src%2Fci%2Fscripts%2Fupload-artifacts.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fscripts%2Fupload-artifacts.sh?ref=ca3bddd14e3dd6e6f0448f0408ec04d20234b1a3", "patch": "@@ -38,4 +38,5 @@ if [[ \"${DEPLOY_ALT-0}\" -eq \"1\" ]]; then\n fi\n deploy_url=\"s3://${DEPLOY_BUCKET}/${deploy_dir}/$(ciCommit)\"\n \n-retry aws s3 cp --no-progress --recursive --acl public-read \"${upload_dir}\" \"${deploy_url}\"\n+retry aws s3 cp --storage-class INTELLIGENT_TIERING \\\n+    --no-progress --recursive --acl public-read \"${upload_dir}\" \"${deploy_url}\""}]}