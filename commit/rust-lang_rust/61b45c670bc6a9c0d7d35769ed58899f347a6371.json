{"sha": "61b45c670bc6a9c0d7d35769ed58899f347a6371", "node_id": "C_kwDOAAsO6NoAKDYxYjQ1YzY3MGJjNmE5YzBkN2QzNTc2OWVkNTg4OTlmMzQ3YTYzNzE", "commit": {"author": {"name": "Josh Triplett", "email": "josh@joshtriplett.org", "date": "2022-06-19T03:00:21Z"}, "committer": {"name": "Josh Triplett", "email": "josh@joshtriplett.org", "date": "2022-07-15T09:54:06Z"}, "message": "Support setting file accessed/modified timestamps\n\nAdd `struct FileTimes` to contain the relevant file timestamps, since\nmost platforms require setting all of them at once. (This also allows\nfor future platform-specific extensions such as setting creation time.)\n\nAdd `File::set_file_time` to set the timestamps for a `File`.\n\nImplement the `sys` backends for UNIX, macOS (which needs to fall back\nto `futimes` before macOS 10.13 because it lacks `futimens`), Windows,\nand WASI.", "tree": {"sha": "966bb1912f78dded9499f0eef0fbde2a45cd7ee8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/966bb1912f78dded9499f0eef0fbde2a45cd7ee8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/61b45c670bc6a9c0d7d35769ed58899f347a6371", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/61b45c670bc6a9c0d7d35769ed58899f347a6371", "html_url": "https://github.com/rust-lang/rust/commit/61b45c670bc6a9c0d7d35769ed58899f347a6371", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/61b45c670bc6a9c0d7d35769ed58899f347a6371/comments", "author": {"login": "joshtriplett", "id": 162737, "node_id": "MDQ6VXNlcjE2MjczNw==", "avatar_url": "https://avatars.githubusercontent.com/u/162737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joshtriplett", "html_url": "https://github.com/joshtriplett", "followers_url": "https://api.github.com/users/joshtriplett/followers", "following_url": "https://api.github.com/users/joshtriplett/following{/other_user}", "gists_url": "https://api.github.com/users/joshtriplett/gists{/gist_id}", "starred_url": "https://api.github.com/users/joshtriplett/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joshtriplett/subscriptions", "organizations_url": "https://api.github.com/users/joshtriplett/orgs", "repos_url": "https://api.github.com/users/joshtriplett/repos", "events_url": "https://api.github.com/users/joshtriplett/events{/privacy}", "received_events_url": "https://api.github.com/users/joshtriplett/received_events", "type": "User", "site_admin": false}, "committer": {"login": "joshtriplett", "id": 162737, "node_id": "MDQ6VXNlcjE2MjczNw==", "avatar_url": "https://avatars.githubusercontent.com/u/162737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joshtriplett", "html_url": "https://github.com/joshtriplett", "followers_url": "https://api.github.com/users/joshtriplett/followers", "following_url": "https://api.github.com/users/joshtriplett/following{/other_user}", "gists_url": "https://api.github.com/users/joshtriplett/gists{/gist_id}", "starred_url": "https://api.github.com/users/joshtriplett/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joshtriplett/subscriptions", "organizations_url": "https://api.github.com/users/joshtriplett/orgs", "repos_url": "https://api.github.com/users/joshtriplett/repos", "events_url": "https://api.github.com/users/joshtriplett/events{/privacy}", "received_events_url": "https://api.github.com/users/joshtriplett/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "21e9336fe81a1fce364349bb7a35a0347c369f34", "url": "https://api.github.com/repos/rust-lang/rust/commits/21e9336fe81a1fce364349bb7a35a0347c369f34", "html_url": "https://github.com/rust-lang/rust/commit/21e9336fe81a1fce364349bb7a35a0347c369f34"}], "stats": {"total": 224, "additions": 222, "deletions": 2}, "files": [{"sha": "0500e826768af368a80df4bd557284b9f3e8bfd3", "filename": "library/std/src/fs.rs", "status": "modified", "additions": 72, "deletions": 0, "changes": 72, "blob_url": "https://github.com/rust-lang/rust/blob/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Ffs.rs?ref=61b45c670bc6a9c0d7d35769ed58899f347a6371", "patch": "@@ -184,6 +184,11 @@ pub struct DirEntry(fs_imp::DirEntry);\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub struct OpenOptions(fs_imp::OpenOptions);\n \n+/// Representation of the various timestamps on a file.\n+#[derive(Copy, Clone, Debug, Default)]\n+#[unstable(feature = \"file_set_times\", issue = \"98245\")]\n+pub struct FileTimes(fs_imp::FileTimes);\n+\n /// Representation of the various permissions on a file.\n ///\n /// This module only currently provides one bit of information,\n@@ -590,6 +595,49 @@ impl File {\n     pub fn set_permissions(&self, perm: Permissions) -> io::Result<()> {\n         self.inner.set_permissions(perm.0)\n     }\n+\n+    /// Changes the timestamps of the underlying file.\n+    ///\n+    /// # Platform-specific behavior\n+    ///\n+    /// This function currently corresponds to the `futimens` function on Unix (falling back to\n+    /// `futimes` on macOS before 10.13) and the `SetFileTime` function on Windows. Note that this\n+    /// [may change in the future][changes].\n+    ///\n+    /// [changes]: io#platform-specific-behavior\n+    ///\n+    /// # Errors\n+    ///\n+    /// This function will return an error if the user lacks permission to change timestamps on the\n+    /// underlying file. It may also return an error in other os-specific unspecified cases.\n+    ///\n+    /// This function may return an error if the operating system lacks support to change one or\n+    /// more of the timestamps set in the `FileTimes` structure.\n+    ///\n+    /// # Examples\n+    ///\n+    /// ```no_run\n+    /// #![feature(file_set_times)]\n+    ///\n+    /// fn main() -> std::io::Result<()> {\n+    ///     use std::fs::{self, File, FileTimes};\n+    ///\n+    ///     let src = fs::metadata(\"src\")?;\n+    ///     let dest = File::options().write(true).open(\"dest\")?;\n+    ///     let times = FileTimes::new()\n+    ///         .set_accessed(src.accessed()?)\n+    ///         .set_modified(src.modified()?);\n+    ///     dest.set_times(times)?;\n+    ///     Ok(())\n+    /// }\n+    /// ```\n+    #[unstable(feature = \"file_set_times\", issue = \"98245\")]\n+    #[doc(alias = \"futimens\")]\n+    #[doc(alias = \"futimes\")]\n+    #[doc(alias = \"SetFileTime\")]\n+    pub fn set_times(&self, times: FileTimes) -> io::Result<()> {\n+        self.inner.set_times(times.0)\n+    }\n }\n \n // In addition to the `impl`s here, `File` also has `impl`s for\n@@ -1246,6 +1294,30 @@ impl FromInner<fs_imp::FileAttr> for Metadata {\n     }\n }\n \n+impl FileTimes {\n+    /// Create a new `FileTimes` with no times set.\n+    ///\n+    /// Using the resulting `FileTimes` in [`File::set_times`] will not modify any timestamps.\n+    #[unstable(feature = \"file_set_times\", issue = \"98245\")]\n+    pub fn new() -> Self {\n+        Self::default()\n+    }\n+\n+    /// Set the last access time of a file.\n+    #[unstable(feature = \"file_set_times\", issue = \"98245\")]\n+    pub fn set_accessed(mut self, t: SystemTime) -> Self {\n+        self.0.set_accessed(t.into_inner());\n+        self\n+    }\n+\n+    /// Set the last modified time of a file.\n+    #[unstable(feature = \"file_set_times\", issue = \"98245\")]\n+    pub fn set_modified(mut self, t: SystemTime) -> Self {\n+        self.0.set_modified(t.into_inner());\n+        self\n+    }\n+}\n+\n impl Permissions {\n     /// Returns `true` if these permissions describe a readonly (unwritable) file.\n     ///"}, {"sha": "db81b26e7e7a8df6d86f28c66b2a99818e0bdb43", "filename": "library/std/src/sys/unix/fs.rs", "status": "modified", "additions": 64, "deletions": 0, "changes": 64, "blob_url": "https://github.com/rust-lang/rust/blob/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Fsys%2Funix%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Fsys%2Funix%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Ffs.rs?ref=61b45c670bc6a9c0d7d35769ed58899f347a6371", "patch": "@@ -311,6 +311,9 @@ pub struct FilePermissions {\n     mode: mode_t,\n }\n \n+#[derive(Copy, Clone)]\n+pub struct FileTimes([libc::timespec; 2]);\n+\n #[derive(Copy, Clone, PartialEq, Eq, Hash, Debug)]\n pub struct FileType {\n     mode: mode_t,\n@@ -503,6 +506,43 @@ impl FilePermissions {\n     }\n }\n \n+impl FileTimes {\n+    pub fn set_accessed(&mut self, t: SystemTime) {\n+        self.0[0] = t.t.to_timespec().expect(\"Invalid system time\");\n+    }\n+\n+    pub fn set_modified(&mut self, t: SystemTime) {\n+        self.0[1] = t.t.to_timespec().expect(\"Invalid system time\");\n+    }\n+}\n+\n+struct TimespecDebugAdapter<'a>(&'a libc::timespec);\n+\n+impl fmt::Debug for TimespecDebugAdapter<'_> {\n+    fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {\n+        f.debug_struct(\"timespec\")\n+            .field(\"tv_sec\", &self.0.tv_sec)\n+            .field(\"tv_nsec\", &self.0.tv_nsec)\n+            .finish()\n+    }\n+}\n+\n+impl fmt::Debug for FileTimes {\n+    fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {\n+        f.debug_struct(\"FileTimes\")\n+            .field(\"accessed\", &TimespecDebugAdapter(&self.0[0]))\n+            .field(\"modified\", &TimespecDebugAdapter(&self.0[1]))\n+            .finish()\n+    }\n+}\n+\n+impl Default for FileTimes {\n+    fn default() -> Self {\n+        let omit = libc::timespec { tv_sec: 0, tv_nsec: libc::UTIME_OMIT as _ };\n+        Self([omit; 2])\n+    }\n+}\n+\n impl FileType {\n     pub fn is_dir(&self) -> bool {\n         self.is(libc::S_IFDIR)\n@@ -1021,6 +1061,30 @@ impl File {\n         cvt_r(|| unsafe { libc::fchmod(self.as_raw_fd(), perm.mode) })?;\n         Ok(())\n     }\n+\n+    pub fn set_times(&self, times: FileTimes) -> io::Result<()> {\n+        cfg_if::cfg_if! {\n+            // futimens requires macOS 10.13\n+            if #[cfg(target_os = \"macos\")] {\n+                fn ts_to_tv(ts: &libc::timespec) -> libc::timeval {\n+                    libc::timeval { tv_sec: ts.tv_sec, tv_usec: (ts.tv_nsec / 1000) as _ }\n+                }\n+                cvt(unsafe {\n+                    weak!(fn futimens(c_int, *const libc::timespec) -> c_int);\n+                    futimens.get()\n+                        .map(|futimens| futimens(self.as_raw_fd(), times.0.as_ptr()))\n+                        .unwrap_or_else(|| {\n+                            let timevals = [ts_to_tv(&times.0[0]), ts_to_tv(&times.0[1])];\n+                            libc::futimes(self.as_raw_fd(), timevals.as_ptr())\n+                        })\n+                })?;\n+            } else {\n+                cvt(unsafe { libc::futimens(self.as_raw_fd(), times.0.as_ptr()) })?;\n+            }\n+        }\n+\n+        Ok(())\n+    }\n }\n \n impl DirBuilder {"}, {"sha": "0e1a6257ed763e223630189b71c198fd1d95c320", "filename": "library/std/src/sys/unsupported/fs.rs", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Fsys%2Funsupported%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Fsys%2Funsupported%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funsupported%2Ffs.rs?ref=61b45c670bc6a9c0d7d35769ed58899f347a6371", "patch": "@@ -17,6 +17,9 @@ pub struct DirEntry(!);\n #[derive(Clone, Debug)]\n pub struct OpenOptions {}\n \n+#[derive(Copy, Clone, Debug, Default)]\n+pub struct FileTimes {}\n+\n pub struct FilePermissions(!);\n \n pub struct FileType(!);\n@@ -86,6 +89,11 @@ impl fmt::Debug for FilePermissions {\n     }\n }\n \n+impl FileTimes {\n+    pub fn set_accessed(&mut self, _t: SystemTime) {}\n+    pub fn set_modified(&mut self, _t: SystemTime) {}\n+}\n+\n impl FileType {\n     pub fn is_dir(&self) -> bool {\n         self.0\n@@ -237,6 +245,10 @@ impl File {\n     pub fn set_permissions(&self, _perm: FilePermissions) -> io::Result<()> {\n         self.0\n     }\n+\n+    pub fn set_times(&self, _times: FileTimes) -> io::Result<()> {\n+        self.0\n+    }\n }\n \n impl DirBuilder {"}, {"sha": "6614ae397b57f43ec617eb6040ab9ed5c7ea3526", "filename": "library/std/src/sys/wasi/fs.rs", "status": "modified", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Fsys%2Fwasi%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Fsys%2Fwasi%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwasi%2Ffs.rs?ref=61b45c670bc6a9c0d7d35769ed58899f347a6371", "patch": "@@ -63,6 +63,12 @@ pub struct FilePermissions {\n     readonly: bool,\n }\n \n+#[derive(Copy, Clone, Debug, Default)]\n+pub struct FileTimes {\n+    accessed: Option<wasi::Timestamp>,\n+    modified: Option<wasi::Timestamp>,\n+}\n+\n #[derive(PartialEq, Eq, Hash, Debug, Copy, Clone)]\n pub struct FileType {\n     bits: wasi::Filetype,\n@@ -112,6 +118,16 @@ impl FilePermissions {\n     }\n }\n \n+impl FileTimes {\n+    pub fn set_accessed(&mut self, t: SystemTime) {\n+        self.accessed = Some(t.to_wasi_timestamp_or_panic());\n+    }\n+\n+    pub fn set_modified(&mut self, t: SystemTime) {\n+        self.modified = Some(t.to_wasi_timestamp_or_panic());\n+    }\n+}\n+\n impl FileType {\n     pub fn is_dir(&self) -> bool {\n         self.bits == wasi::FILETYPE_DIRECTORY\n@@ -459,6 +475,15 @@ impl File {\n         unsupported()\n     }\n \n+    pub fn set_times(&self, times: FileTimes) -> io::Result<()> {\n+        self.fd.filestat_set_times(\n+            times.accessed.unwrap_or(0),\n+            times.modified.unwrap_or(0),\n+            times.accessed.map_or(0, |_| wasi::FSTFLAGS_ATIM)\n+                | times.modified.map_or(0, |_| wasi::FSTFLAGS_MTIM),\n+        )\n+    }\n+\n     pub fn read_link(&self, file: &Path) -> io::Result<PathBuf> {\n         read_link(&self.fd, file)\n     }"}, {"sha": "3d326e49106cab07b0934819328d3e35e3c4130d", "filename": "library/std/src/sys/wasi/time.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Fsys%2Fwasi%2Ftime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Fsys%2Fwasi%2Ftime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwasi%2Ftime.rs?ref=61b45c670bc6a9c0d7d35769ed58899f347a6371", "patch": "@@ -47,6 +47,10 @@ impl SystemTime {\n         SystemTime(Duration::from_nanos(ts))\n     }\n \n+    pub fn to_wasi_timestamp_or_panic(&self) -> wasi::Timestamp {\n+        self.0.as_nanos().try_into().expect(\"time does not fit in WASI timestamp\")\n+    }\n+\n     pub fn sub_time(&self, other: &SystemTime) -> Result<Duration, Duration> {\n         self.0.checked_sub(other.0).ok_or_else(|| other.0 - self.0)\n     }"}, {"sha": "abb471213d25122d97b3dc77ca789c56e7bcf2f4", "filename": "library/std/src/sys/windows/c.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fc.rs?ref=61b45c670bc6a9c0d7d35769ed58899f347a6371", "patch": "@@ -607,7 +607,7 @@ pub struct SOCKADDR {\n }\n \n #[repr(C)]\n-#[derive(Copy, Clone)]\n+#[derive(Copy, Clone, Debug, Default)]\n pub struct FILETIME {\n     pub dwLowDateTime: DWORD,\n     pub dwHighDateTime: DWORD,\n@@ -875,6 +875,12 @@ extern \"system\" {\n     pub fn GetSystemDirectoryW(lpBuffer: LPWSTR, uSize: UINT) -> UINT;\n     pub fn RemoveDirectoryW(lpPathName: LPCWSTR) -> BOOL;\n     pub fn SetFileAttributesW(lpFileName: LPCWSTR, dwFileAttributes: DWORD) -> BOOL;\n+    pub fn SetFileTime(\n+        hFile: BorrowedHandle<'_>,\n+        lpCreationTime: Option<&FILETIME>,\n+        lpLastAccessTime: Option<&FILETIME>,\n+        lpLastWriteTime: Option<&FILETIME>,\n+    ) -> BOOL;\n     pub fn SetLastError(dwErrCode: DWORD);\n     pub fn GetCommandLineW() -> LPWSTR;\n     pub fn GetTempPathW(nBufferLength: DWORD, lpBuffer: LPCWSTR) -> DWORD;"}, {"sha": "e3809f3579dfdbcfdd0cf1d315dcc495b80524b7", "filename": "library/std/src/sys/windows/fs.rs", "status": "modified", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Ffs.rs?ref=61b45c670bc6a9c0d7d35769ed58899f347a6371", "patch": "@@ -82,6 +82,12 @@ pub struct FilePermissions {\n     attrs: c::DWORD,\n }\n \n+#[derive(Copy, Clone, Debug, Default)]\n+pub struct FileTimes {\n+    accessed: c::FILETIME,\n+    modified: c::FILETIME,\n+}\n+\n #[derive(Debug)]\n pub struct DirBuilder;\n \n@@ -550,6 +556,14 @@ impl File {\n         })?;\n         Ok(())\n     }\n+\n+    pub fn set_times(&self, times: FileTimes) -> io::Result<()> {\n+        cvt(unsafe {\n+            c::SetFileTime(self.as_handle(), None, Some(&times.accessed), Some(&times.modified))\n+        })?;\n+        Ok(())\n+    }\n+\n     /// Get only basic file information such as attributes and file times.\n     fn basic_info(&self) -> io::Result<c::FILE_BASIC_INFO> {\n         unsafe {\n@@ -895,6 +909,16 @@ impl FilePermissions {\n     }\n }\n \n+impl FileTimes {\n+    pub fn set_accessed(&mut self, t: SystemTime) {\n+        self.accessed = t.into_inner();\n+    }\n+\n+    pub fn set_modified(&mut self, t: SystemTime) {\n+        self.modified = t.into_inner();\n+    }\n+}\n+\n impl FileType {\n     fn new(attrs: c::DWORD, reparse_tag: c::DWORD) -> FileType {\n         FileType { attributes: attrs, reparse_tag }"}, {"sha": "b8209a8544585f1f5f6bafbdb88a2538564ebde7", "filename": "library/std/src/sys/windows/time.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Ftime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Ftime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Ftime.rs?ref=61b45c670bc6a9c0d7d35769ed58899f347a6371", "patch": "@@ -2,6 +2,7 @@ use crate::cmp::Ordering;\n use crate::fmt;\n use crate::mem;\n use crate::sys::c;\n+use crate::sys_common::IntoInner;\n use crate::time::Duration;\n \n use core::hash::{Hash, Hasher};\n@@ -136,6 +137,12 @@ impl From<c::FILETIME> for SystemTime {\n     }\n }\n \n+impl IntoInner<c::FILETIME> for SystemTime {\n+    fn into_inner(self) -> c::FILETIME {\n+        self.t\n+    }\n+}\n+\n impl Hash for SystemTime {\n     fn hash<H: Hasher>(&self, state: &mut H) {\n         self.intervals().hash(state)"}, {"sha": "759a59e1f98d2e8c0dec05cf630f3eb0bbf5eb8f", "filename": "library/std/src/time.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Ftime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/61b45c670bc6a9c0d7d35769ed58899f347a6371/library%2Fstd%2Fsrc%2Ftime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Ftime.rs?ref=61b45c670bc6a9c0d7d35769ed58899f347a6371", "patch": "@@ -38,7 +38,7 @@ use crate::error::Error;\n use crate::fmt;\n use crate::ops::{Add, AddAssign, Sub, SubAssign};\n use crate::sys::time;\n-use crate::sys_common::FromInner;\n+use crate::sys_common::{FromInner, IntoInner};\n \n #[stable(feature = \"time\", since = \"1.3.0\")]\n pub use core::time::Duration;\n@@ -686,3 +686,9 @@ impl FromInner<time::SystemTime> for SystemTime {\n         SystemTime(time)\n     }\n }\n+\n+impl IntoInner<time::SystemTime> for SystemTime {\n+    fn into_inner(self) -> time::SystemTime {\n+        self.0\n+    }\n+}"}]}