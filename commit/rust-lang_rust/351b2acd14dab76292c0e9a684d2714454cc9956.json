{"sha": "351b2acd14dab76292c0e9a684d2714454cc9956", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM1MWIyYWNkMTRkYWI3NjI5MmMwZTlhNjg0ZDI3MTQ0NTRjYzk5NTY=", "commit": {"author": {"name": "Rune Tynan", "email": "runetynan@gmail.com", "date": "2021-01-24T04:03:01Z"}, "committer": {"name": "Rune Tynan", "email": "runetynan@gmail.com", "date": "2021-01-24T04:03:01Z"}, "message": "Make bad shlex parsing a pretty error", "tree": {"sha": "8224d80c368676ece09067b22f9bb3e516407a8d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8224d80c368676ece09067b22f9bb3e516407a8d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/351b2acd14dab76292c0e9a684d2714454cc9956", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEETdpCnQmiF6hBYUqdfsyTL4sscx4FAmAM8XUACgkQfsyTL4ss\ncx7tsw//UeOIWXWDEAs4k/D1JAH8v/lhZsvutcVdpbhpbYMHS/V3hPNerPsilcqp\nVuS2b4fDQy+4AqXucelrTDzzKdHc445Rf2sMWVNP5oIjPlGg7Ha9PPz3eRctt/is\nQtDKsSg++gMaKyEvO7VYRs6q+Fjor5a6jP7X0fmTi3xwOqyCV8JQXqVu5jyaxBR8\n7GUWLpBfCZ8C9rFk2PyRlR8/2fzbgHl7/NMVX4jX3LWYuRBxPZ7t/o4LtwUSMzT3\nyScSXuYtArq+In+jjFb9GmM4sTO2ET1lfQA8vqVNDccBiWwudtlOPsRXBtAC+imk\nXwI9NG2ff6hA/U7K7IO8/RMJO9px811uOVrW6KoY0GipWI5OFC8maiYIMcRc2NnG\n7AIenXuWCpYYv3g/WhIaoUbD/E52FyqslvYk7pk1HcGa+nx3i5wvLR0vaQb5vCM3\nwDlN4jojx0O1QgD+LC4+V/bl+JCk0VbCCT6Pk0wOTxR0oMN80o/FtzrpldNX07RJ\nlLtGpepgya/xAAnujOooKfajznb9NltOjFvELN3mOe7l213xg/T5w+XnFJEA5oLU\nnTsDFcZCe0WLxIfdEOZuQwJON6BXMkMC7L9vhOAelCzSumyIQ/YMHxlBTF6xdHgf\n1EkjFj4x8IuLIXFikm+GNYeMQTZ2WznQK9ZJ48bYfgWmN2Bx9NQ=\n=W45v\n-----END PGP SIGNATURE-----", "payload": "tree 8224d80c368676ece09067b22f9bb3e516407a8d\nparent b814b639836aa76b5c6deaa585367150bb2debf4\nauthor Rune Tynan <runetynan@gmail.com> 1611460981 -0500\ncommitter Rune Tynan <runetynan@gmail.com> 1611460981 -0500\n\nMake bad shlex parsing a pretty error\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/351b2acd14dab76292c0e9a684d2714454cc9956", "html_url": "https://github.com/rust-lang/rust/commit/351b2acd14dab76292c0e9a684d2714454cc9956", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/351b2acd14dab76292c0e9a684d2714454cc9956/comments", "author": {"login": "CraftSpider", "id": 13342132, "node_id": "MDQ6VXNlcjEzMzQyMTMy", "avatar_url": "https://avatars.githubusercontent.com/u/13342132?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CraftSpider", "html_url": "https://github.com/CraftSpider", "followers_url": "https://api.github.com/users/CraftSpider/followers", "following_url": "https://api.github.com/users/CraftSpider/following{/other_user}", "gists_url": "https://api.github.com/users/CraftSpider/gists{/gist_id}", "starred_url": "https://api.github.com/users/CraftSpider/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CraftSpider/subscriptions", "organizations_url": "https://api.github.com/users/CraftSpider/orgs", "repos_url": "https://api.github.com/users/CraftSpider/repos", "events_url": "https://api.github.com/users/CraftSpider/events{/privacy}", "received_events_url": "https://api.github.com/users/CraftSpider/received_events", "type": "User", "site_admin": false}, "committer": {"login": "CraftSpider", "id": 13342132, "node_id": "MDQ6VXNlcjEzMzQyMTMy", "avatar_url": "https://avatars.githubusercontent.com/u/13342132?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CraftSpider", "html_url": "https://github.com/CraftSpider", "followers_url": "https://api.github.com/users/CraftSpider/followers", "following_url": "https://api.github.com/users/CraftSpider/following{/other_user}", "gists_url": "https://api.github.com/users/CraftSpider/gists{/gist_id}", "starred_url": "https://api.github.com/users/CraftSpider/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CraftSpider/subscriptions", "organizations_url": "https://api.github.com/users/CraftSpider/orgs", "repos_url": "https://api.github.com/users/CraftSpider/repos", "events_url": "https://api.github.com/users/CraftSpider/events{/privacy}", "received_events_url": "https://api.github.com/users/CraftSpider/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b814b639836aa76b5c6deaa585367150bb2debf4", "url": "https://api.github.com/repos/rust-lang/rust/commits/b814b639836aa76b5c6deaa585367150bb2debf4", "html_url": "https://github.com/rust-lang/rust/commit/b814b639836aa76b5c6deaa585367150bb2debf4"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "376639ced0aa68b962777c9448e97c263ddfff45", "filename": "src/tools/jsondocck/src/main.rs", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/351b2acd14dab76292c0e9a684d2714454cc9956/src%2Ftools%2Fjsondocck%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/351b2acd14dab76292c0e9a684d2714454cc9956/src%2Ftools%2Fjsondocck%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fjsondocck%2Fsrc%2Fmain.rs?ref=351b2acd14dab76292c0e9a684d2714454cc9956", "patch": "@@ -149,7 +149,20 @@ fn get_commands(template: &str) -> Result<Vec<Command>, ()> {\n             }\n         }\n \n-        let args = cap.name(\"args\").map_or(vec![], |m| shlex::split(m.as_str()).unwrap());\n+        let args = cap.name(\"args\")\n+            .map_or(Some(vec![]), |m| shlex::split(m.as_str()));\n+\n+        let args = match args {\n+            Some(args) => args,\n+            None => {\n+                print_err(\n+                    &format!(\"Invalid arguments to shlex::split: `{}`\", cap.name(\"args\").unwrap().as_str()),\n+                    lineno\n+                );\n+                errors = true;\n+                continue;\n+            }\n+        };\n \n         if !cmd.validate(&args, commands.len(), lineno) {\n             errors = true;"}]}