{"sha": "50fda1eead10af900a7b7c9f07983937e66bcc3c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUwZmRhMWVlYWQxMGFmOTAwYTdiN2M5ZjA3OTgzOTM3ZTY2YmNjM2M=", "commit": {"author": {"name": "Steven Fackler", "email": "sfackler@gmail.com", "date": "2016-03-16T03:38:58Z"}, "committer": {"name": "Steven Fackler", "email": "sfackler@gmail.com", "date": "2016-03-16T03:51:48Z"}, "message": "Update rpass tests for panic hooks", "tree": {"sha": "db155d151f59fdc958bc5f0d88d9fa9739025ce8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/db155d151f59fdc958bc5f0d88d9fa9739025ce8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/50fda1eead10af900a7b7c9f07983937e66bcc3c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/50fda1eead10af900a7b7c9f07983937e66bcc3c", "html_url": "https://github.com/rust-lang/rust/commit/50fda1eead10af900a7b7c9f07983937e66bcc3c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/50fda1eead10af900a7b7c9f07983937e66bcc3c/comments", "author": {"login": "sfackler", "id": 1455697, "node_id": "MDQ6VXNlcjE0NTU2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sfackler", "html_url": "https://github.com/sfackler", "followers_url": "https://api.github.com/users/sfackler/followers", "following_url": "https://api.github.com/users/sfackler/following{/other_user}", "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}", "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions", "organizations_url": "https://api.github.com/users/sfackler/orgs", "repos_url": "https://api.github.com/users/sfackler/repos", "events_url": "https://api.github.com/users/sfackler/events{/privacy}", "received_events_url": "https://api.github.com/users/sfackler/received_events", "type": "User", "site_admin": false}, "committer": {"login": "sfackler", "id": 1455697, "node_id": "MDQ6VXNlcjE0NTU2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sfackler", "html_url": "https://github.com/sfackler", "followers_url": "https://api.github.com/users/sfackler/followers", "following_url": "https://api.github.com/users/sfackler/following{/other_user}", "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}", "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions", "organizations_url": "https://api.github.com/users/sfackler/orgs", "repos_url": "https://api.github.com/users/sfackler/repos", "events_url": "https://api.github.com/users/sfackler/events{/privacy}", "received_events_url": "https://api.github.com/users/sfackler/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "157e1bc6811b033bf640b68ffdf3ea0f1b804ccf", "url": "https://api.github.com/repos/rust-lang/rust/commits/157e1bc6811b033bf640b68ffdf3ea0f1b804ccf", "html_url": "https://github.com/rust-lang/rust/commit/157e1bc6811b033bf640b68ffdf3ea0f1b804ccf"}], "stats": {"total": 44, "additions": 22, "deletions": 22}, "files": [{"sha": "7c2e3f0c91baff5774974c863736bb22470a1015", "filename": "src/test/run-pass/panic-handler-chain.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/50fda1eead10af900a7b7c9f07983937e66bcc3c/src%2Ftest%2Frun-pass%2Fpanic-handler-chain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/50fda1eead10af900a7b7c9f07983937e66bcc3c/src%2Ftest%2Frun-pass%2Fpanic-handler-chain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fpanic-handler-chain.rs?ref=50fda1eead10af900a7b7c9f07983937e66bcc3c", "patch": "@@ -17,12 +17,12 @@ static A: AtomicUsize = AtomicUsize::new(0);\n static B: AtomicUsize = AtomicUsize::new(0);\n \n fn main() {\n-    panic::set_handler(|_| { A.fetch_add(1, Ordering::SeqCst); });\n-    let handler = panic::take_handler();\n-    panic::set_handler(move |info| {\n+    panic::set_hook(Box::new(|_| { A.fetch_add(1, Ordering::SeqCst); }));\n+    let hook = panic::take_hook();\n+    panic::set_hook(Box::new(move |info| {\n         B.fetch_add(1, Ordering::SeqCst);\n-        handler(info);\n-    });\n+        hook(info);\n+    }));\n \n     let _ = thread::spawn(|| {\n         panic!();"}, {"sha": "311310712df8360096fd7cac349c3dd55cd9d699", "filename": "src/test/run-pass/panic-handler-flail-wildly.rs", "status": "modified", "additions": 15, "deletions": 15, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/50fda1eead10af900a7b7c9f07983937e66bcc3c/src%2Ftest%2Frun-pass%2Fpanic-handler-flail-wildly.rs", "raw_url": "https://github.com/rust-lang/rust/raw/50fda1eead10af900a7b7c9f07983937e66bcc3c/src%2Ftest%2Frun-pass%2Fpanic-handler-flail-wildly.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fpanic-handler-flail-wildly.rs?ref=50fda1eead10af900a7b7c9f07983937e66bcc3c", "patch": "@@ -15,28 +15,28 @@ use std::panic;\n use std::thread;\n \n fn a() {\n-    panic::set_handler(|_| println!(\"hello yes this is a\"));\n-    panic::take_handler();\n-    panic::set_handler(|_| println!(\"hello yes this is a part 2\"));\n-    panic::take_handler();\n+    panic::set_hook(Box::new(|_| println!(\"hello yes this is a\")));\n+    panic::take_hook();\n+    panic::set_hook(Box::new(|_| println!(\"hello yes this is a part 2\")));\n+    panic::take_hook();\n }\n \n fn b() {\n-    panic::take_handler();\n-    panic::take_handler();\n-    panic::take_handler();\n-    panic::take_handler();\n-    panic::take_handler();\n+    panic::take_hook();\n+    panic::take_hook();\n+    panic::take_hook();\n+    panic::take_hook();\n+    panic::take_hook();\n     panic!();\n }\n \n fn c() {\n-    panic::set_handler(|_| ());\n-    panic::set_handler(|_| ());\n-    panic::set_handler(|_| ());\n-    panic::set_handler(|_| ());\n-    panic::set_handler(|_| ());\n-    panic::set_handler(|_| ());\n+    panic::set_hook(Box::new(|_| ()));\n+    panic::set_hook(Box::new(|_| ()));\n+    panic::set_hook(Box::new(|_| ()));\n+    panic::set_hook(Box::new(|_| ()));\n+    panic::set_hook(Box::new(|_| ()));\n+    panic::set_hook(Box::new(|_| ()));\n     panic!();\n }\n "}, {"sha": "196e08a63a7f0fafecb1ac889681a7398e5264a7", "filename": "src/test/run-pass/panic-handler-set-twice.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/50fda1eead10af900a7b7c9f07983937e66bcc3c/src%2Ftest%2Frun-pass%2Fpanic-handler-set-twice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/50fda1eead10af900a7b7c9f07983937e66bcc3c/src%2Ftest%2Frun-pass%2Fpanic-handler-set-twice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fpanic-handler-set-twice.rs?ref=50fda1eead10af900a7b7c9f07983937e66bcc3c", "patch": "@@ -18,8 +18,8 @@ use std::thread;\n static A: AtomicUsize = AtomicUsize::new(0);\n \n fn main() {\n-    panic::set_handler(|_| ());\n-    panic::set_handler(|info| { A.fetch_add(1, Ordering::SeqCst); });\n+    panic::set_hook(Box::new(|_| ()));\n+    panic::set_hook(Box::new(|info| { A.fetch_add(1, Ordering::SeqCst); }));\n \n     let _ = thread::spawn(|| {\n         panic!();"}]}