{"sha": "72c235d6aea713d233fa1536b344c59b93c28295", "node_id": "MDY6Q29tbWl0NzI0NzEyOjcyYzIzNWQ2YWVhNzEzZDIzM2ZhMTUzNmIzNDRjNTliOTNjMjgyOTU=", "commit": {"author": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2018-05-10T13:48:45Z"}, "committer": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2018-05-10T13:48:45Z"}, "message": "WIP patch test stderr", "tree": {"sha": "3c9f589590ebd58cd78f00a87f21c7763d00abca", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3c9f589590ebd58cd78f00a87f21c7763d00abca"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/72c235d6aea713d233fa1536b344c59b93c28295", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/72c235d6aea713d233fa1536b344c59b93c28295", "html_url": "https://github.com/rust-lang/rust/commit/72c235d6aea713d233fa1536b344c59b93c28295", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/72c235d6aea713d233fa1536b344c59b93c28295/comments", "author": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c990309f61a18be4a5d12aa4f0d9dcf8f2e004d5", "url": "https://api.github.com/repos/rust-lang/rust/commits/c990309f61a18be4a5d12aa4f0d9dcf8f2e004d5", "html_url": "https://github.com/rust-lang/rust/commit/c990309f61a18be4a5d12aa4f0d9dcf8f2e004d5"}], "stats": {"total": 56, "additions": 49, "deletions": 7}, "files": [{"sha": "dd69e18652c9afc598ffeb6050598a55b560acaf", "filename": "src/test/ui/nll/get_default.nll.stderr", "status": "modified", "additions": 49, "deletions": 7, "changes": 56, "blob_url": "https://github.com/rust-lang/rust/blob/72c235d6aea713d233fa1536b344c59b93c28295/src%2Ftest%2Fui%2Fnll%2Fget_default.nll.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/72c235d6aea713d233fa1536b344c59b93c28295/src%2Ftest%2Fui%2Fnll%2Fget_default.nll.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnll%2Fget_default.nll.stderr?ref=72c235d6aea713d233fa1536b344c59b93c28295", "patch": "@@ -4,14 +4,14 @@ error[E0502]: cannot borrow `*map` as mutable because it is also borrowed as imm\n LL |         match map.get() {\n    |               --- immutable borrow occurs here\n ...\n-LL |                 map.set(String::new()); // Just AST errors here\n+LL |                 map.set(String::new()); // Ideally, this would not error.\n    |                 ^^^ mutable borrow occurs here\n ...\n LL | }\n    | - immutable borrow ends here\n \n error[E0502]: cannot borrow `*map` as mutable because it is also borrowed as immutable (Ast)\n-  --> $DIR/get_default.rs:44:17\n+  --> $DIR/get_default.rs:45:17\n    |\n LL |         match map.get() {\n    |               --- immutable borrow occurs here\n@@ -23,29 +23,71 @@ LL | }\n    | - immutable borrow ends here\n \n error[E0502]: cannot borrow `*map` as mutable because it is also borrowed as immutable (Ast)\n-  --> $DIR/get_default.rs:50:17\n+  --> $DIR/get_default.rs:51:17\n    |\n LL |         match map.get() {\n    |               --- immutable borrow occurs here\n ...\n-LL |                 map.set(String::new()); // Just AST errors here\n+LL |                 map.set(String::new()); // Ideally, just AST would error here\n    |                 ^^^ mutable borrow occurs here\n ...\n LL | }\n    | - immutable borrow ends here\n \n error[E0502]: cannot borrow `*map` as mutable because it is also borrowed as immutable (Mir)\n-  --> $DIR/get_default.rs:44:17\n+  --> $DIR/get_default.rs:33:17\n+   |\n+LL |         match map.get() {\n+   |               --- immutable borrow occurs here\n+...\n+LL |                 map.set(String::new()); // Ideally, this would not error.\n+   |                 ^^^ mutable borrow occurs here\n+   |\n+note: borrowed value must be valid for the anonymous lifetime #1 defined on the function body at 26:1...\n+  --> $DIR/get_default.rs:26:1\n+   |\n+LL | / fn ok(map: &mut Map) -> &String {\n+LL | |     loop {\n+LL | |         match map.get() {\n+LL | |             Some(v) => {\n+...  |\n+LL | |     }\n+LL | | }\n+   | |_^\n+\n+error[E0502]: cannot borrow `*map` as mutable because it is also borrowed as immutable (Mir)\n+  --> $DIR/get_default.rs:51:17\n+   |\n+LL |         match map.get() {\n+   |               --- immutable borrow occurs here\n+...\n+LL |                 map.set(String::new()); // Ideally, just AST would error here\n+   |                 ^^^ mutable borrow occurs here\n+   |\n+note: borrowed value must be valid for the anonymous lifetime #1 defined on the function body at 41:1...\n+  --> $DIR/get_default.rs:41:1\n+   |\n+LL | / fn err(map: &mut Map) -> &String {\n+LL | |     loop {\n+LL | |         match map.get() {\n+LL | |             Some(v) => {\n+...  |\n+LL | |     }\n+LL | | }\n+   | |_^\n+\n+error[E0502]: cannot borrow `*map` as mutable because it is also borrowed as immutable (Mir)\n+  --> $DIR/get_default.rs:45:17\n    |\n LL |         match map.get() {\n    |               --- immutable borrow occurs here\n LL |             Some(v) => {\n LL |                 map.set(String::new()); // Both AST and MIR error here\n-   |                 ^^^^^^^^^^^^^^^^^^^^^^ mutable borrow occurs here\n+   |                 ^^^ mutable borrow occurs here\n ...\n LL |                 return v;\n    |                        - borrow later used here\n \n-error: aborting due to 4 previous errors\n+error: aborting due to 6 previous errors\n \n For more information about this error, try `rustc --explain E0502`."}]}