{"sha": "c034f4a44a4b3d69f4f7f2efeecb5f9742ec0d24", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMwMzRmNGE0NGE0YjNkNjlmNGY3ZjJlZmVlY2I1Zjk3NDJlYzBkMjQ=", "commit": {"author": {"name": "Earl St Sauver", "email": "estsauver@gmail.com", "date": "2015-01-17T00:54:11Z"}, "committer": {"name": "Earl St Sauver", "email": "estsauver@gmail.com", "date": "2015-01-19T02:06:15Z"}, "message": "Make date of nightly in rustup match server TZ", "tree": {"sha": "9c383008b3a94a18ae13f70bb6abf73ce3ff590a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9c383008b3a94a18ae13f70bb6abf73ce3ff590a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c034f4a44a4b3d69f4f7f2efeecb5f9742ec0d24", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c034f4a44a4b3d69f4f7f2efeecb5f9742ec0d24", "html_url": "https://github.com/rust-lang/rust/commit/c034f4a44a4b3d69f4f7f2efeecb5f9742ec0d24", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c034f4a44a4b3d69f4f7f2efeecb5f9742ec0d24/comments", "author": {"login": "estsauver", "id": 766985, "node_id": "MDQ6VXNlcjc2Njk4NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/766985?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estsauver", "html_url": "https://github.com/estsauver", "followers_url": "https://api.github.com/users/estsauver/followers", "following_url": "https://api.github.com/users/estsauver/following{/other_user}", "gists_url": "https://api.github.com/users/estsauver/gists{/gist_id}", "starred_url": "https://api.github.com/users/estsauver/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estsauver/subscriptions", "organizations_url": "https://api.github.com/users/estsauver/orgs", "repos_url": "https://api.github.com/users/estsauver/repos", "events_url": "https://api.github.com/users/estsauver/events{/privacy}", "received_events_url": "https://api.github.com/users/estsauver/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estsauver", "id": 766985, "node_id": "MDQ6VXNlcjc2Njk4NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/766985?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estsauver", "html_url": "https://github.com/estsauver", "followers_url": "https://api.github.com/users/estsauver/followers", "following_url": "https://api.github.com/users/estsauver/following{/other_user}", "gists_url": "https://api.github.com/users/estsauver/gists{/gist_id}", "starred_url": "https://api.github.com/users/estsauver/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estsauver/subscriptions", "organizations_url": "https://api.github.com/users/estsauver/orgs", "repos_url": "https://api.github.com/users/estsauver/repos", "events_url": "https://api.github.com/users/estsauver/events{/privacy}", "received_events_url": "https://api.github.com/users/estsauver/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "653e6880c96f858ff1d9a42b525bf3a903ae94c8", "url": "https://api.github.com/repos/rust-lang/rust/commits/653e6880c96f858ff1d9a42b525bf3a903ae94c8", "html_url": "https://github.com/rust-lang/rust/commit/653e6880c96f858ff1d9a42b525bf3a903ae94c8"}], "stats": {"total": 11, "additions": 8, "deletions": 3}, "files": [{"sha": "476d19d0b450337740fcdac6db4d15a1273b3475", "filename": "src/etc/rustup.sh", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/c034f4a44a4b3d69f4f7f2efeecb5f9742ec0d24/src%2Fetc%2Frustup.sh", "raw_url": "https://github.com/rust-lang/rust/raw/c034f4a44a4b3d69f4f7f2efeecb5f9742ec0d24/src%2Fetc%2Frustup.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Frustup.sh?ref=c034f4a44a4b3d69f4f7f2efeecb5f9742ec0d24", "patch": "@@ -433,11 +433,16 @@ CFG_TMP_DIR=$(mktemp -d 2>/dev/null \\\n            || mktemp -d -t 'rustup-tmp-install' 2>/dev/null \\\n            || create_tmp_dir)\n \n-# If we're saving nightlies and we didn't specify which one, grab todays.\n-# Otherwise we'll use the latest version.\n+# If we're saving nightlies and we didn't specify which one, grab the latest\n+# verison from the perspective of the server. Buildbot has typically finished\n+# building and uploading by ~8UTC, but we want to include a little buffer.\n+#\n+# FIXME It would be better to use the known most recent nightly that has been\n+# built. This is waiting on a change to have buildbot publish metadata that\n+# can be queried.\n if [ -n \"${CFG_SAVE}\" -a -z \"${CFG_DATE}\" ];\n then\n-    CFG_DATE=`date \"+%Y-%m-%d\"`\n+    CFG_DATE=`TZ=Etc/UTC+9 date \"+%Y-%m-%d\"`\n fi\n \n RUST_URL=\"https://static.rust-lang.org/dist\""}]}