{"sha": "60547f6500b0bf726e675b058ad0bdfe21455c11", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYwNTQ3ZjY1MDBiMGJmNzI2ZTY3NWIwNThhZDBiZGZlMjE0NTVjMTE=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-08-24T05:04:11Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-08-24T17:24:59Z"}, "message": "Use memmove to load istr literals. Issue #855", "tree": {"sha": "38b923aca491c0f723675a40f5f39d0ee998936e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/38b923aca491c0f723675a40f5f39d0ee998936e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/60547f6500b0bf726e675b058ad0bdfe21455c11", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/60547f6500b0bf726e675b058ad0bdfe21455c11", "html_url": "https://github.com/rust-lang/rust/commit/60547f6500b0bf726e675b058ad0bdfe21455c11", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/60547f6500b0bf726e675b058ad0bdfe21455c11/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "629ee94a0b360e2df1a1bbf7bf61ef346adf36ad", "url": "https://api.github.com/repos/rust-lang/rust/commits/629ee94a0b360e2df1a1bbf7bf61ef346adf36ad", "html_url": "https://github.com/rust-lang/rust/commit/629ee94a0b360e2df1a1bbf7bf61ef346adf36ad"}], "stats": {"total": 15, "additions": 4, "deletions": 11}, "files": [{"sha": "1f37f81e52e5408e4780a64445ccefb257e08cb7", "filename": "src/comp/middle/trans.rs", "status": "modified", "additions": 4, "deletions": 11, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/60547f6500b0bf726e675b058ad0bdfe21455c11/src%2Fcomp%2Fmiddle%2Ftrans.rs", "raw_url": "https://github.com/rust-lang/rust/raw/60547f6500b0bf726e675b058ad0bdfe21455c11/src%2Fcomp%2Fmiddle%2Ftrans.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Ftrans.rs?ref=60547f6500b0bf726e675b058ad0bdfe21455c11", "patch": "@@ -2383,17 +2383,10 @@ fn trans_lit_istr(cx: &@block_ctxt, s: str) -> result {\n     let llvecptr = alloc_res.llptr;\n     let llfirsteltptr = alloc_res.llfirsteltptr;\n \n-    // FIXME: Do something smarter here to load the string\n-    let i = 0u;\n-    while i < strlen {\n-        bld::Store(bcx, C_u8(s[i] as uint),\n-                        bld::InBoundsGEP(bcx, llfirsteltptr,\n-                                              [C_uint(i)]));\n-        i += 1u;\n-    }\n-    bld::Store(bcx, C_u8(0u),\n-                    bld::InBoundsGEP(bcx, llfirsteltptr,\n-                                          [C_uint(strlen)]));\n+    let llcstr = C_cstr(bcx_ccx(cx), s);\n+\n+    // FIXME: We need to avoid this memmove\n+    bcx = call_memmove(bcx, llfirsteltptr, llcstr, C_uint(veclen)).bcx;\n \n     ret rslt(bcx, llvecptr);\n }"}]}