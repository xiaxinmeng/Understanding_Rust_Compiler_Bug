{"sha": "9fbd7f478e59cca00011b6ac0ed89bada8823e2a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjlmYmQ3ZjQ3OGU1OWNjYTAwMDExYjZhYzBlZDg5YmFkYTg4MjNlMmE=", "commit": {"author": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2020-01-29T14:46:38Z"}, "committer": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2020-01-31T09:39:05Z"}, "message": "Don't trigger `debug_assert_with_mut_call` on `.await`", "tree": {"sha": "4a900f6d5f293e678d1ab4c84a9cc4bcda8dbd62", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4a900f6d5f293e678d1ab4c84a9cc4bcda8dbd62"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9fbd7f478e59cca00011b6ac0ed89bada8823e2a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZxoS6lESXlRGMHWcaTCGhp1QZjcFAl4z9bkACgkQaTCGhp1Q\nZje/8w//T1qTw2n1jqhLIUk6mHsMxdWD0ofhflVE2avWn0PCaj+7PoqLHn5XoZcP\nv2TT8RJ6JSD8NPZO6KhigP0W5Ni7U8velQXowO6uJZuR8QLkEUyN4km6G/md5ICB\n8drMtgrd1I92Ca4Ps5wlRX9//MNcv7IzUt9ZswmDehqw0aaNxtERbShstPRrXc/C\nVyUbsqzLnw7susFclJ/LKaHAtYV57t+jChv7WaaOgm5Qa9WukO50sjmSZW63Foxg\n/1qtV1EYaHWAkE1xYYYIsaM/euqp0nwtF4U/OZ5Yu0U3qjp2vD88s73GoeIDTbmG\n13OsAFMyjAajBsecTtp4AsvKKp8/LzK5ixXfzp9M9aGJCcAxq4Xm9fqddd9RcBcA\nUnLz+Gg3qg34AN5EIjkKxcvVj62m2A5v7Phh4Xn7aBI8nr6mu0Zo8xO2aCTgOLHw\nnR5dLmb4Um+wV7bdPKBM+3dlDccrR1OSUqX4hGzM1m+xTUPz6WY1+s1fSnI311K2\nPhqb9vKIDSmU4fA73QerikYz+uuZf4T3r5RjO2SHsHTglX/6xn4z9ocqBbQ0id/L\nOlehUpS7sbV/hUbbuCN2frNm9yG36NDWjYE8mYlprpZijjsOFr89K6has6JuOBD9\nNnyBA+NLxDYLQX0C2mm5IN8yeZtZnaa5BX7ZiLFwB/qfoYKnFfw=\n=3rxC\n-----END PGP SIGNATURE-----", "payload": "tree 4a900f6d5f293e678d1ab4c84a9cc4bcda8dbd62\nparent b31a3dff480ffad248fa5b2c66fbe9b9d6726314\nauthor flip1995 <hello@philkrones.com> 1580309198 +0100\ncommitter flip1995 <hello@philkrones.com> 1580463545 +0100\n\nDon't trigger `debug_assert_with_mut_call` on `.await`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9fbd7f478e59cca00011b6ac0ed89bada8823e2a", "html_url": "https://github.com/rust-lang/rust/commit/9fbd7f478e59cca00011b6ac0ed89bada8823e2a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9fbd7f478e59cca00011b6ac0ed89bada8823e2a/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b31a3dff480ffad248fa5b2c66fbe9b9d6726314", "url": "https://api.github.com/repos/rust-lang/rust/commits/b31a3dff480ffad248fa5b2c66fbe9b9d6726314", "html_url": "https://github.com/rust-lang/rust/commit/b31a3dff480ffad248fa5b2c66fbe9b9d6726314"}], "stats": {"total": 4, "additions": 3, "deletions": 1}, "files": [{"sha": "881f59bbabdffb76b5db63d732ae364996fde469", "filename": "clippy_lints/src/mutable_debug_assertion.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9fbd7f478e59cca00011b6ac0ed89bada8823e2a/clippy_lints%2Fsrc%2Fmutable_debug_assertion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9fbd7f478e59cca00011b6ac0ed89bada8823e2a/clippy_lints%2Fsrc%2Fmutable_debug_assertion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmutable_debug_assertion.rs?ref=9fbd7f478e59cca00011b6ac0ed89bada8823e2a", "patch": "@@ -4,7 +4,7 @@ use matches::matches;\n use rustc::hir::map::Map;\n use rustc::ty;\n use rustc_hir::intravisit::{walk_expr, NestedVisitorMap, Visitor};\n-use rustc_hir::{BorrowKind, Expr, ExprKind, Mutability, StmtKind, UnOp};\n+use rustc_hir::{BorrowKind, Expr, ExprKind, MatchSource, Mutability, StmtKind, UnOp};\n use rustc_lint::{LateContext, LateLintPass};\n use rustc_session::{declare_lint_pass, declare_tool_lint};\n use rustc_span::Span;\n@@ -147,6 +147,8 @@ impl<'a, 'tcx> Visitor<'tcx> for MutArgVisitor<'a, 'tcx> {\n                     }\n                 }\n             },\n+            // Don't check await desugars\n+            ExprKind::Match(_, _, MatchSource::AwaitDesugar) => return,\n             _ if !self.found => self.expr_span = Some(expr.span),\n             _ => return,\n         }"}]}