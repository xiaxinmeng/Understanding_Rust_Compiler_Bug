{"sha": "1b6997d0692e743066dfc40e7ab4b65f8ed2e7fd", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFiNjk5N2QwNjkyZTc0MzA2NmRmYzQwZTdhYjRiNjVmOGVkMmU3ZmQ=", "commit": {"author": {"name": "Erick Tryzelaar", "email": "erick.tryzelaar@gmail.com", "date": "2014-04-02T05:07:37Z"}, "committer": {"name": "Erick Tryzelaar", "email": "erick.tryzelaar@gmail.com", "date": "2014-04-04T03:28:59Z"}, "message": "test: avoid infinite loop in out-of-stack.rs\n\nThis fixes #13238. It avoids an infinite loop when compiling\nthe tests with `-g`. Without this change, the debuginfo on\n`black_box` prevents the method from being inlined, which\nallows llvm to convert `silent_recurse` into a tail-call. This\nthen loops forever instead of consuming all the stack like it\nis supposed to. This patch forces inlining `black_box`, which\ntriggers the right error.", "tree": {"sha": "85342621e7062b6aa347dd1fbd3487af89af9b74", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/85342621e7062b6aa347dd1fbd3487af89af9b74"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1b6997d0692e743066dfc40e7ab4b65f8ed2e7fd", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1b6997d0692e743066dfc40e7ab4b65f8ed2e7fd", "html_url": "https://github.com/rust-lang/rust/commit/1b6997d0692e743066dfc40e7ab4b65f8ed2e7fd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1b6997d0692e743066dfc40e7ab4b65f8ed2e7fd/comments", "author": {"login": "erickt", "id": 84711, "node_id": "MDQ6VXNlcjg0NzEx", "avatar_url": "https://avatars.githubusercontent.com/u/84711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erickt", "html_url": "https://github.com/erickt", "followers_url": "https://api.github.com/users/erickt/followers", "following_url": "https://api.github.com/users/erickt/following{/other_user}", "gists_url": "https://api.github.com/users/erickt/gists{/gist_id}", "starred_url": "https://api.github.com/users/erickt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erickt/subscriptions", "organizations_url": "https://api.github.com/users/erickt/orgs", "repos_url": "https://api.github.com/users/erickt/repos", "events_url": "https://api.github.com/users/erickt/events{/privacy}", "received_events_url": "https://api.github.com/users/erickt/received_events", "type": "User", "site_admin": false}, "committer": {"login": "erickt", "id": 84711, "node_id": "MDQ6VXNlcjg0NzEx", "avatar_url": "https://avatars.githubusercontent.com/u/84711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erickt", "html_url": "https://github.com/erickt", "followers_url": "https://api.github.com/users/erickt/followers", "following_url": "https://api.github.com/users/erickt/following{/other_user}", "gists_url": "https://api.github.com/users/erickt/gists{/gist_id}", "starred_url": "https://api.github.com/users/erickt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erickt/subscriptions", "organizations_url": "https://api.github.com/users/erickt/orgs", "repos_url": "https://api.github.com/users/erickt/repos", "events_url": "https://api.github.com/users/erickt/events{/privacy}", "received_events_url": "https://api.github.com/users/erickt/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3961957bd61b7f9ab350c0a6621a1ad18716c332", "url": "https://api.github.com/repos/rust-lang/rust/commits/3961957bd61b7f9ab350c0a6621a1ad18716c332", "html_url": "https://github.com/rust-lang/rust/commit/3961957bd61b7f9ab350c0a6621a1ad18716c332"}], "stats": {"total": 3, "additions": 3, "deletions": 0}, "files": [{"sha": "71fde8667032207ba9db4c6a23a5adaa73cbaec0", "filename": "src/test/run-pass/out-of-stack.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/1b6997d0692e743066dfc40e7ab4b65f8ed2e7fd/src%2Ftest%2Frun-pass%2Fout-of-stack.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1b6997d0692e743066dfc40e7ab4b65f8ed2e7fd/src%2Ftest%2Frun-pass%2Fout-of-stack.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fout-of-stack.rs?ref=1b6997d0692e743066dfc40e7ab4b65f8ed2e7fd", "patch": "@@ -17,6 +17,9 @@ use std::os;\n use std::str;\n \n // lifted from the test module\n+// Inlining to avoid llvm turning the recursive functions into tail calls,\n+// which doesn't consume stack.\n+#[inline(always)]\n pub fn black_box<T>(dummy: T) { unsafe { asm!(\"\" : : \"r\"(&dummy)) } }\n \n fn silent_recurse() {"}]}