{"sha": "a30129be5ae8fd3dc698cc035339ed651b30de02", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEzMDEyOWJlNWFlOGZkM2RjNjk4Y2MwMzUzMzllZDY1MWIzMGRlMDI=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-01-13T14:03:07Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-01-13T14:20:09Z"}, "message": "build with clang?", "tree": {"sha": "bb5a6ba81fe9b9fbe7fca71059e253b597952512", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bb5a6ba81fe9b9fbe7fca71059e253b597952512"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a30129be5ae8fd3dc698cc035339ed651b30de02", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a30129be5ae8fd3dc698cc035339ed651b30de02", "html_url": "https://github.com/rust-lang/rust/commit/a30129be5ae8fd3dc698cc035339ed651b30de02", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a30129be5ae8fd3dc698cc035339ed651b30de02/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ab6e992c8719ed58c66309c5274f8a13807e6afa", "url": "https://api.github.com/repos/rust-lang/rust/commits/ab6e992c8719ed58c66309c5274f8a13807e6afa", "html_url": "https://github.com/rust-lang/rust/commit/ab6e992c8719ed58c66309c5274f8a13807e6afa"}], "stats": {"total": 16, "additions": 11, "deletions": 5}, "files": [{"sha": "395ce1ef402d183a04878f4f8badf7b4c6c110c3", "filename": ".github/workflows/release.yaml", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/a30129be5ae8fd3dc698cc035339ed651b30de02/.github%2Fworkflows%2Frelease.yaml", "raw_url": "https://github.com/rust-lang/rust/raw/a30129be5ae8fd3dc698cc035339ed651b30de02/.github%2Fworkflows%2Frelease.yaml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Frelease.yaml?ref=a30129be5ae8fd3dc698cc035339ed651b30de02", "patch": "@@ -38,21 +38,27 @@ jobs:\n           override: true\n \n       - name: Build\n+        if: matrix.os == 'ubuntu-latest'\n         uses: actions-rs/cargo@v1\n+        env:\n+          CC: clang\n         with:\n           command: build\n-          args: --package ra_lsp_server --bin ra_lsp_server --target x86_64-unknown-linux-musl --release\n+          args: --package ra_lsp_server --bin ra_lsp_server --release --target x86_64-unknown-linux-musl\n \n-      - name: Strip symbols\n-        if: matrix.os == 'ubuntu-latest'\n-        run: strip ./target/release/ra_lsp_server\n+      - name: Build\n+        if: matrix.os != 'ubuntu-latest'\n+        uses: actions-rs/cargo@v1\n+        with:\n+          command: build\n+          args: --package ra_lsp_server --bin ra_lsp_server --release\n \n       - name: Create distribution dir\n         run: mkdir ./dist\n \n       - name: Copy binary\n         if: matrix.os == 'ubuntu-latest'\n-        run: cp ./target/release/ra_lsp_server ./dist/ra_lsp_server-linux\n+        run: cp ./target/x86_64-unknown-linux-musl/release/ra_lsp_server ./dist/ra_lsp_server-linux && strip ./dist/ra_lsp_server-linux\n \n       - name: Copy binary\n         if: matrix.os == 'macos-latest'"}]}