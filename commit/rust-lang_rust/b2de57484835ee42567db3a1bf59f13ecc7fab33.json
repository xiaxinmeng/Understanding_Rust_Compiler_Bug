{"sha": "b2de57484835ee42567db3a1bf59f13ecc7fab33", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIyZGU1NzQ4NDgzNWVlNDI1NjdkYjNhMWJmNTlmMTNlY2M3ZmFiMzM=", "commit": {"author": {"name": "Seiichi Uchida", "email": "seuchida@gmail.com", "date": "2018-10-11T14:10:57Z"}, "committer": {"name": "Seiichi Uchida", "email": "seuchida@gmail.com", "date": "2018-10-11T14:34:36Z"}, "message": "Add format_doc_comments", "tree": {"sha": "41bfe37e7f9f48401d2457209d13e6e273819936", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/41bfe37e7f9f48401d2457209d13e6e273819936"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b2de57484835ee42567db3a1bf59f13ecc7fab33", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b2de57484835ee42567db3a1bf59f13ecc7fab33", "html_url": "https://github.com/rust-lang/rust/commit/b2de57484835ee42567db3a1bf59f13ecc7fab33", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b2de57484835ee42567db3a1bf59f13ecc7fab33/comments", "author": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "committer": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "15717be9c51aeab30571f5f10e1f0c3be15ad1ba", "url": "https://api.github.com/repos/rust-lang/rust/commits/15717be9c51aeab30571f5f10e1f0c3be15ad1ba", "html_url": "https://github.com/rust-lang/rust/commit/15717be9c51aeab30571f5f10e1f0c3be15ad1ba"}], "stats": {"total": 64, "additions": 59, "deletions": 5}, "files": [{"sha": "f23506d5fe8d28e02d2aa0cf533e906ebd725de4", "filename": "Configurations.md", "status": "modified", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/rust-lang/rust/blob/b2de57484835ee42567db3a1bf59f13ecc7fab33/Configurations.md", "raw_url": "https://github.com/rust-lang/rust/raw/b2de57484835ee42567db3a1bf59f13ecc7fab33/Configurations.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Configurations.md?ref=b2de57484835ee42567db3a1bf59f13ecc7fab33", "patch": "@@ -1979,6 +1979,56 @@ fn main() {\n }\n ```\n \n+## `format_doc_comments`\n+\n+Format doc comments.\n+\n+- **Default value**: `false`\n+- **Possible values**: `true`, `false`\n+- **Stable**: No\n+\n+#### `false` (default):\n+\n+```rust\n+/// Adds one to the number given.\n+///\n+/// # Examples\n+///\n+/// ```rust\n+/// let five=5;\n+///\n+/// assert_eq!(\n+///     6,\n+///     add_one(5)\n+/// );\n+/// # fn add_one(x: i32) -> i32 {\n+/// #     x + 1\n+/// # }\n+/// ```\n+fn add_one(x: i32) -> i32 {\n+    x + 1\n+}\n+```\n+\n+#### `true`\n+\n+```rust\n+/// Adds one to the number given.\n+///\n+/// # Examples\n+///\n+/// ```rust\n+/// let five = 5;\n+///\n+/// assert_eq!(6, add_one(5));\n+/// # fn add_one(x: i32) -> i32 {\n+/// #     x + 1\n+/// # }\n+/// ```\n+fn add_one(x: i32) -> i32 {\n+    x + 1\n+}\n+```\n \n ## `wrap_comments`\n "}, {"sha": "213879e50a1948a0fef958fa194c9aafa8581920", "filename": "src/comment.rs", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/b2de57484835ee42567db3a1bf59f13ecc7fab33/src%2Fcomment.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b2de57484835ee42567db3a1bf59f13ecc7fab33/src%2Fcomment.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomment.rs?ref=b2de57484835ee42567db3a1bf59f13ecc7fab33", "patch": "@@ -333,7 +333,10 @@ fn identify_comment(\n     let rewritten_first_group =\n         if !config.normalize_comments() && has_bare_lines && style.is_block_comment() {\n             light_rewrite_block_comment_with_bare_lines(first_group, shape, config)?\n-        } else if !config.normalize_comments() && !config.wrap_comments() {\n+        } else if !config.normalize_comments()\n+            && !config.wrap_comments()\n+            && !config.format_doc_comments()\n+        {\n             light_rewrite_comment(first_group, shape.indent, config, is_doc_comment)?\n         } else {\n             rewrite_comment_inner(\n@@ -593,7 +596,7 @@ fn rewrite_comment_inner(\n                     _ if code_block_buffer.is_empty() => String::new(),\n                     _ => {\n                         let mut config = config.clone();\n-                        config.set().wrap_comments(false);\n+                        config.set().format_doc_comments(false);\n                         match ::format_code_block(&code_block_buffer, &config) {\n                             Some(ref s) => trim_custom_comment_prefix(s),\n                             None => trim_custom_comment_prefix(&code_block_buffer),\n@@ -1622,7 +1625,7 @@ mod test {\n \n     #[test]\n     #[rustfmt::skip]\n-    fn format_comments() {\n+    fn format_doc_comments() {\n         let mut wrap_normalize_config: ::config::Config = Default::default();\n         wrap_normalize_config.set().wrap_comments(true);\n         wrap_normalize_config.set().normalize_comments(true);"}, {"sha": "98754eb0b60a75275de5d65d9808a52e2878815b", "filename": "src/config/mod.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b2de57484835ee42567db3a1bf59f13ecc7fab33/src%2Fconfig%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b2de57484835ee42567db3a1bf59f13ecc7fab33/src%2Fconfig%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconfig%2Fmod.rs?ref=b2de57484835ee42567db3a1bf59f13ecc7fab33", "patch": "@@ -46,6 +46,7 @@ create_config! {\n \n     // Comments. macros, and strings\n     wrap_comments: bool, false, false, \"Break comments to fit on the line\";\n+    format_doc_comments: bool, false, false, \"Format doc comments.\";\n     comment_width: usize, 80, false,\n         \"Maximum length of comments. No effect unless wrap_comments = true\";\n     normalize_comments: bool, false, false, \"Convert /* */ comments to // comments where possible\";"}, {"sha": "58d98acfa2556ea40a0dd115db04206ee6cde36a", "filename": "tests/source/doc-comment-with-example.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b2de57484835ee42567db3a1bf59f13ecc7fab33/tests%2Fsource%2Fdoc-comment-with-example.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b2de57484835ee42567db3a1bf59f13ecc7fab33/tests%2Fsource%2Fdoc-comment-with-example.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fdoc-comment-with-example.rs?ref=b2de57484835ee42567db3a1bf59f13ecc7fab33", "patch": "@@ -1,4 +1,4 @@\n-// rustfmt-wrap_comments: true\n+// rustfmt-format_doc_comments: true\n \n /// Foo\n ///"}, {"sha": "bec931d13c7879f59386001135b84aa0565cb091", "filename": "tests/target/doc-comment-with-example.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b2de57484835ee42567db3a1bf59f13ecc7fab33/tests%2Ftarget%2Fdoc-comment-with-example.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b2de57484835ee42567db3a1bf59f13ecc7fab33/tests%2Ftarget%2Fdoc-comment-with-example.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fdoc-comment-with-example.rs?ref=b2de57484835ee42567db3a1bf59f13ecc7fab33", "patch": "@@ -1,4 +1,4 @@\n-// rustfmt-wrap_comments: true\n+// rustfmt-format_doc_comments: true\n \n /// Foo\n ///"}]}