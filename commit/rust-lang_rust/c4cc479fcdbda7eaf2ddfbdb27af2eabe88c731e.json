{"sha": "c4cc479fcdbda7eaf2ddfbdb27af2eabe88c731e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM0Y2M0NzlmY2RiZGE3ZWFmMmRkZmJkYjI3YWYyZWFiZTg4YzczMWU=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2018-11-09T02:14:44Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-11-09T02:14:44Z"}, "message": "Merge pull request #3183 from scampi/issue3182\n\ndo not wrap comments in doctest to avoid failing doctest runs", "tree": {"sha": "fe61bca3e68942785743e29ba2e7698abfd26c3f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fe61bca3e68942785743e29ba2e7698abfd26c3f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c4cc479fcdbda7eaf2ddfbdb27af2eabe88c731e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJb5O2UCRBK7hj4Ov3rIwAAdHIIAEP5Kco8dtHpzm5A9+0u1L2h\nYeF3YnGNFuA9foUVnYLk5TjOzBaLmGghGkxynRsVjdxT/M/vldIMact7dvEkSY7G\ng44ViixLJoiJjXou/B240811Y7ij2o93An9io6RHjsrK59Qfs33PxgBIPzzZNzk6\n457xgfpk/5Ly12ytT6ez9F3b1GHi2ZYDm+SUOBh47rPtYXvs+S1U41mX9uFUbjZg\nLgsQr8oYaJwGjuC1jQrW24CWVkU+BJ84crtBC8+8OQtpDfDMJLt3rC6nvaGwnwx0\nOaE1vcrtR5U/EMCtq3ehusLRMPqifC3GkiH0zLhWhhnBWJoNGN4Bg7OT3FCvEFM=\n=nvAY\n-----END PGP SIGNATURE-----\n", "payload": "tree fe61bca3e68942785743e29ba2e7698abfd26c3f\nparent 9534dfc062f636ecd9bdb5d617a8d6a192e6ff27\nparent a5043a81be1b6288e96b8320cf69f397e4be7159\nauthor Nick Cameron <nrc@ncameron.org> 1541729684 +1300\ncommitter GitHub <noreply@github.com> 1541729684 +1300\n\nMerge pull request #3183 from scampi/issue3182\n\ndo not wrap comments in doctest to avoid failing doctest runs"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c4cc479fcdbda7eaf2ddfbdb27af2eabe88c731e", "html_url": "https://github.com/rust-lang/rust/commit/c4cc479fcdbda7eaf2ddfbdb27af2eabe88c731e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c4cc479fcdbda7eaf2ddfbdb27af2eabe88c731e/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9534dfc062f636ecd9bdb5d617a8d6a192e6ff27", "url": "https://api.github.com/repos/rust-lang/rust/commits/9534dfc062f636ecd9bdb5d617a8d6a192e6ff27", "html_url": "https://github.com/rust-lang/rust/commit/9534dfc062f636ecd9bdb5d617a8d6a192e6ff27"}, {"sha": "a5043a81be1b6288e96b8320cf69f397e4be7159", "url": "https://api.github.com/repos/rust-lang/rust/commits/a5043a81be1b6288e96b8320cf69f397e4be7159", "html_url": "https://github.com/rust-lang/rust/commit/a5043a81be1b6288e96b8320cf69f397e4be7159"}], "stats": {"total": 26, "additions": 3, "deletions": 23}, "files": [{"sha": "bc46ab6edc276b2992aff8a62d3d30eec181195a", "filename": "src/comment.rs", "status": "modified", "additions": 3, "deletions": 10, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/c4cc479fcdbda7eaf2ddfbdb27af2eabe88c731e/src%2Fcomment.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c4cc479fcdbda7eaf2ddfbdb27af2eabe88c731e/src%2Fcomment.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomment.rs?ref=c4cc479fcdbda7eaf2ddfbdb27af2eabe88c731e", "patch": "@@ -626,7 +626,7 @@ impl<'a> CommentRewrite<'a> {\n                     _ if self.code_block_buffer.is_empty() => String::new(),\n                     _ => {\n                         let mut config = self.fmt.config.clone();\n-                        config.set().format_doc_comments(false);\n+                        config.set().wrap_comments(false);\n                         match ::format_code_block(&self.code_block_buffer, &config) {\n                             Some(ref s) => trim_custom_comment_prefix(&s.snippet),\n                             None => trim_custom_comment_prefix(&self.code_block_buffer),\n@@ -798,16 +798,9 @@ fn trim_custom_comment_prefix(s: &str) -> String {\n         .map(|line| {\n             let left_trimmed = line.trim_left();\n             if left_trimmed.starts_with(RUSTFMT_CUSTOM_COMMENT_PREFIX) {\n-                let orig = left_trimmed.trim_left_matches(RUSTFMT_CUSTOM_COMMENT_PREFIX);\n-                // due to comment wrapping, a line that was originally behind `#` is split over\n-                // multiple lines, which needs then to be prefixed with a `#`\n-                if !orig.trim_left().starts_with(\"# \") {\n-                    Cow::from(format!(\"# {}\", orig))\n-                } else {\n-                    Cow::from(orig)\n-                }\n+                left_trimmed.trim_left_matches(RUSTFMT_CUSTOM_COMMENT_PREFIX)\n             } else {\n-                Cow::from(line)\n+                line\n             }\n         })\n         .collect::<Vec<_>>()"}, {"sha": "d8de8443812e4d81f977e8716f4d5589a0ea4e82", "filename": "tests/target/issue-3182.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/c4cc479fcdbda7eaf2ddfbdb27af2eabe88c731e/tests%2Ftarget%2Fissue-3182.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c4cc479fcdbda7eaf2ddfbdb27af2eabe88c731e/tests%2Ftarget%2Fissue-3182.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-3182.rs?ref=c4cc479fcdbda7eaf2ddfbdb27af2eabe88c731e", "previous_filename": "tests/source/wrapped_hidden_code_block.rs"}, {"sha": "572f448c4e7ce3cd96a03557048a71db259a3bfd", "filename": "tests/target/wrapped_hidden_code_block.rs", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/9534dfc062f636ecd9bdb5d617a8d6a192e6ff27/tests%2Ftarget%2Fwrapped_hidden_code_block.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9534dfc062f636ecd9bdb5d617a8d6a192e6ff27/tests%2Ftarget%2Fwrapped_hidden_code_block.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fwrapped_hidden_code_block.rs?ref=9534dfc062f636ecd9bdb5d617a8d6a192e6ff27", "patch": "@@ -1,13 +0,0 @@\n-// rustfmt-max_width: 79\n-// rustfmt-wrap_comments: true\n-\n-/// ```rust\n-/// # #![cfg_attr(not(dox), feature(cfg_target_feature, target_feature,\n-/// # stdsimd)not(dox), feature(cfg_target_feature, target_feature,\n-/// # stdsimd))]\n-///\n-/// // Est lectus hendrerit lorem, eget dignissim orci nisl sit amet massa.\n-/// // Etiam volutpat lobortis eros.\n-/// let x = 42;\n-/// ```\n-fn func() {}"}]}