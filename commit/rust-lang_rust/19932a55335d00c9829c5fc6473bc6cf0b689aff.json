{"sha": "19932a55335d00c9829c5fc6473bc6cf0b689aff", "node_id": "C_kwDOAAsO6NoAKDE5OTMyYTU1MzM1ZDAwYzk4MjljNWZjNjQ3M2JjNmNmMGI2ODlhZmY", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-07-19T11:30:48Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-07-19T11:30:48Z"}, "message": "Rollup merge of #99435 - CAD97:revert-dollar-dollar-crate, r=Mark-Simulacrum\n\nRevert \"Stabilize $$ in Rust 1.63.0\"\n\nThis mechanically reverts commit 9edaa76adce4de737db54194eb13d6c298827b37, the one commit from #95860.\n\nhttps://github.com/rust-lang/rust/issues/99035; the behavior of `$$crate` is potentially unexpected and not ready to be stabilized. https://github.com/rust-lang/rust/pull/99193 attempts to forbid `$$crate` without also destabilizing `$$` more generally.\n\n`@rustbot` modify labels +T-compiler +T-lang +P-medium +beta-nominated +relnotes\n\n(applying the labels I think are accurate from the issue and alternative partial revert)\n\ncc `@Mark-Simulacrum`", "tree": {"sha": "e70cf7b3b0d90d5b46ac93890d1b089bb58e0bb4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e70cf7b3b0d90d5b46ac93890d1b089bb58e0bb4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/19932a55335d00c9829c5fc6473bc6cf0b689aff", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJi1pXpCRBK7hj4Ov3rIwAAE0kIAKZyI+SQVNrHm5msjFZP8BW/\neIEe7ztIpZgU+RNfpVFhPif1JSBtPYmiCyqe8Nhs5fpugZtxVv3hyRwfoSsnjF3k\nLbFPf72hf7MQTOhflNuCPC3XRMDM3E/RNqkudxLvOgCm1gMMZXq93MNy8uLjuGJl\n6QK5CTB7aMikyvE0u6WwapwtsW0UL7Bgilu7VIFY/9pzNIaeGk4dyLcMLidzyzjM\n8R2ZIFKHvR6l0jkpNiTgUvP5d+RhscHdtF9f8iN9eums7mfEew81MShTqcH0iFub\n1dRlWXJyKpvxDBTGjcs1Jji+UfDP0TEHWEbCx/5qkOy1/ys1VKQopfV5dWH4dNM=\n=8pwS\n-----END PGP SIGNATURE-----\n", "payload": "tree e70cf7b3b0d90d5b46ac93890d1b089bb58e0bb4\nparent 7d754976c4644c783091107bf2d85136f3d89fdc\nparent c0569f2aa7311d295cb273f66fbe365f2b5ad893\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1658230248 +0200\ncommitter GitHub <noreply@github.com> 1658230248 +0200\n\nRollup merge of #99435 - CAD97:revert-dollar-dollar-crate, r=Mark-Simulacrum\n\nRevert \"Stabilize $$ in Rust 1.63.0\"\n\nThis mechanically reverts commit 9edaa76adce4de737db54194eb13d6c298827b37, the one commit from #95860.\n\nhttps://github.com/rust-lang/rust/issues/99035; the behavior of `$$crate` is potentially unexpected and not ready to be stabilized. https://github.com/rust-lang/rust/pull/99193 attempts to forbid `$$crate` without also destabilizing `$$` more generally.\n\n`@rustbot` modify labels +T-compiler +T-lang +P-medium +beta-nominated +relnotes\n\n(applying the labels I think are accurate from the issue and alternative partial revert)\n\ncc `@Mark-Simulacrum`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/19932a55335d00c9829c5fc6473bc6cf0b689aff", "html_url": "https://github.com/rust-lang/rust/commit/19932a55335d00c9829c5fc6473bc6cf0b689aff", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/19932a55335d00c9829c5fc6473bc6cf0b689aff/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7d754976c4644c783091107bf2d85136f3d89fdc", "url": "https://api.github.com/repos/rust-lang/rust/commits/7d754976c4644c783091107bf2d85136f3d89fdc", "html_url": "https://github.com/rust-lang/rust/commit/7d754976c4644c783091107bf2d85136f3d89fdc"}, {"sha": "c0569f2aa7311d295cb273f66fbe365f2b5ad893", "url": "https://api.github.com/repos/rust-lang/rust/commits/c0569f2aa7311d295cb273f66fbe365f2b5ad893", "html_url": "https://github.com/rust-lang/rust/commit/c0569f2aa7311d295cb273f66fbe365f2b5ad893"}], "stats": {"total": 76, "additions": 57, "deletions": 19}, "files": [{"sha": "707cb73f097f87062f999dc9eb8cebbd476af86b", "filename": "compiler/rustc_expand/src/mbe/quoted.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/19932a55335d00c9829c5fc6473bc6cf0b689aff/compiler%2Frustc_expand%2Fsrc%2Fmbe%2Fquoted.rs", "raw_url": "https://github.com/rust-lang/rust/raw/19932a55335d00c9829c5fc6473bc6cf0b689aff/compiler%2Frustc_expand%2Fsrc%2Fmbe%2Fquoted.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_expand%2Fsrc%2Fmbe%2Fquoted.rs?ref=19932a55335d00c9829c5fc6473bc6cf0b689aff", "patch": "@@ -234,6 +234,8 @@ fn parse_tree(\n                             sess,\n                             &Token { kind: token::Dollar, span },\n                         );\n+                    } else {\n+                        maybe_emit_macro_metavar_expr_feature(features, sess, span);\n                     }\n                     TokenTree::token(token::Dollar, span)\n                 }"}, {"sha": "c248c46f52cd35fa9676dbdd9e91247ca22f5ec7", "filename": "src/test/ui/macros/rfc-3086-metavar-expr/allowed-features.rs", "status": "removed", "additions": 0, "deletions": 12, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/7d754976c4644c783091107bf2d85136f3d89fdc/src%2Ftest%2Fui%2Fmacros%2Frfc-3086-metavar-expr%2Fallowed-features.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7d754976c4644c783091107bf2d85136f3d89fdc/src%2Ftest%2Fui%2Fmacros%2Frfc-3086-metavar-expr%2Fallowed-features.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Frfc-3086-metavar-expr%2Fallowed-features.rs?ref=7d754976c4644c783091107bf2d85136f3d89fdc", "patch": "@@ -1,12 +0,0 @@\n-// check-pass\n-\n-macro_rules! dollar_dollar {\n-    () => {\n-        macro_rules! bar {\n-            ( $$( $$any:tt )* ) => { $$( $$any )* };\n-        }\n-    };\n-}\n-\n-fn main() {\n-}"}, {"sha": "b4fef11f1e29a0546d5f71a062de9d5998c79a69", "filename": "src/test/ui/macros/rfc-3086-metavar-expr/required-feature.rs", "status": "renamed", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/19932a55335d00c9829c5fc6473bc6cf0b689aff/src%2Ftest%2Fui%2Fmacros%2Frfc-3086-metavar-expr%2Frequired-feature.rs", "raw_url": "https://github.com/rust-lang/rust/raw/19932a55335d00c9829c5fc6473bc6cf0b689aff/src%2Ftest%2Fui%2Fmacros%2Frfc-3086-metavar-expr%2Frequired-feature.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Frfc-3086-metavar-expr%2Frequired-feature.rs?ref=19932a55335d00c9829c5fc6473bc6cf0b689aff", "patch": "@@ -5,6 +5,18 @@ macro_rules! count {\n     };\n }\n \n+macro_rules! dollar_dollar {\n+    () => {\n+        macro_rules! bar {\n+            ( $$( $$any:tt )* ) => { $$( $$any )* };\n+            //~^ ERROR meta-variable expressions are unstable\n+            //~| ERROR meta-variable expressions are unstable\n+            //~| ERROR meta-variable expressions are unstable\n+            //~| ERROR meta-variable expressions are unstable\n+        }\n+    };\n+}\n+\n macro_rules! index {\n     ( $( $e:stmt ),* ) => {\n         $( ${ignore(e)} ${index()} )*", "previous_filename": "src/test/ui/macros/rfc-3086-metavar-expr/required-features.rs"}, {"sha": "ecf598b104d058240ac7990f15e16725e1952ab8", "filename": "src/test/ui/macros/rfc-3086-metavar-expr/required-feature.stderr", "status": "renamed", "additions": 43, "deletions": 7, "changes": 50, "blob_url": "https://github.com/rust-lang/rust/blob/19932a55335d00c9829c5fc6473bc6cf0b689aff/src%2Ftest%2Fui%2Fmacros%2Frfc-3086-metavar-expr%2Frequired-feature.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/19932a55335d00c9829c5fc6473bc6cf0b689aff/src%2Ftest%2Fui%2Fmacros%2Frfc-3086-metavar-expr%2Frequired-feature.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Frfc-3086-metavar-expr%2Frequired-feature.stderr?ref=19932a55335d00c9829c5fc6473bc6cf0b689aff", "patch": "@@ -1,5 +1,5 @@\n error[E0658]: meta-variable expressions are unstable\n-  --> $DIR/required-features.rs:3:10\n+  --> $DIR/required-feature.rs:3:10\n    |\n LL |         ${ count(e) }\n    |          ^^^^^^^^^^^^\n@@ -8,7 +8,43 @@ LL |         ${ count(e) }\n    = help: add `#![feature(macro_metavar_expr)]` to the crate attributes to enable\n \n error[E0658]: meta-variable expressions are unstable\n-  --> $DIR/required-features.rs:10:13\n+  --> $DIR/required-feature.rs:11:16\n+   |\n+LL |             ( $$( $$any:tt )* ) => { $$( $$any )* };\n+   |                ^\n+   |\n+   = note: see issue #83527 <https://github.com/rust-lang/rust/issues/83527> for more information\n+   = help: add `#![feature(macro_metavar_expr)]` to the crate attributes to enable\n+\n+error[E0658]: meta-variable expressions are unstable\n+  --> $DIR/required-feature.rs:11:20\n+   |\n+LL |             ( $$( $$any:tt )* ) => { $$( $$any )* };\n+   |                    ^\n+   |\n+   = note: see issue #83527 <https://github.com/rust-lang/rust/issues/83527> for more information\n+   = help: add `#![feature(macro_metavar_expr)]` to the crate attributes to enable\n+\n+error[E0658]: meta-variable expressions are unstable\n+  --> $DIR/required-feature.rs:11:39\n+   |\n+LL |             ( $$( $$any:tt )* ) => { $$( $$any )* };\n+   |                                       ^\n+   |\n+   = note: see issue #83527 <https://github.com/rust-lang/rust/issues/83527> for more information\n+   = help: add `#![feature(macro_metavar_expr)]` to the crate attributes to enable\n+\n+error[E0658]: meta-variable expressions are unstable\n+  --> $DIR/required-feature.rs:11:43\n+   |\n+LL |             ( $$( $$any:tt )* ) => { $$( $$any )* };\n+   |                                           ^\n+   |\n+   = note: see issue #83527 <https://github.com/rust-lang/rust/issues/83527> for more information\n+   = help: add `#![feature(macro_metavar_expr)]` to the crate attributes to enable\n+\n+error[E0658]: meta-variable expressions are unstable\n+  --> $DIR/required-feature.rs:22:13\n    |\n LL |         $( ${ignore(e)} ${index()} )*\n    |             ^^^^^^^^^^^\n@@ -17,7 +53,7 @@ LL |         $( ${ignore(e)} ${index()} )*\n    = help: add `#![feature(macro_metavar_expr)]` to the crate attributes to enable\n \n error[E0658]: meta-variable expressions are unstable\n-  --> $DIR/required-features.rs:10:26\n+  --> $DIR/required-feature.rs:22:26\n    |\n LL |         $( ${ignore(e)} ${index()} )*\n    |                          ^^^^^^^^^\n@@ -26,7 +62,7 @@ LL |         $( ${ignore(e)} ${index()} )*\n    = help: add `#![feature(macro_metavar_expr)]` to the crate attributes to enable\n \n error[E0658]: meta-variable expressions are unstable\n-  --> $DIR/required-features.rs:18:19\n+  --> $DIR/required-feature.rs:30:19\n    |\n LL |         0 $( + 1 ${ignore(i)} )*\n    |                   ^^^^^^^^^^^\n@@ -35,7 +71,7 @@ LL |         0 $( + 1 ${ignore(i)} )*\n    = help: add `#![feature(macro_metavar_expr)]` to the crate attributes to enable\n \n error[E0658]: meta-variable expressions are unstable\n-  --> $DIR/required-features.rs:25:13\n+  --> $DIR/required-feature.rs:37:13\n    |\n LL |         $( ${ignore(e)} ${length()} )*\n    |             ^^^^^^^^^^^\n@@ -44,14 +80,14 @@ LL |         $( ${ignore(e)} ${length()} )*\n    = help: add `#![feature(macro_metavar_expr)]` to the crate attributes to enable\n \n error[E0658]: meta-variable expressions are unstable\n-  --> $DIR/required-features.rs:25:26\n+  --> $DIR/required-feature.rs:37:26\n    |\n LL |         $( ${ignore(e)} ${length()} )*\n    |                          ^^^^^^^^^^\n    |\n    = note: see issue #83527 <https://github.com/rust-lang/rust/issues/83527> for more information\n    = help: add `#![feature(macro_metavar_expr)]` to the crate attributes to enable\n \n-error: aborting due to 6 previous errors\n+error: aborting due to 10 previous errors\n \n For more information about this error, try `rustc --explain E0658`.", "previous_filename": "src/test/ui/macros/rfc-3086-metavar-expr/required-features.stderr"}]}