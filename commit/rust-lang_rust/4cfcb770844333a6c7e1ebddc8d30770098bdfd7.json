{"sha": "4cfcb770844333a6c7e1ebddc8d30770098bdfd7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRjZmNiNzcwODQ0MzMzYTZjN2UxZWJkZGM4ZDMwNzcwMDk4YmRmZDc=", "commit": {"author": {"name": "Sydney Acksman", "email": "obsidianminor@gmail.com", "date": "2019-10-24T14:46:19Z"}, "committer": {"name": "Sydney Acksman", "email": "obsidianminor@gmail.com", "date": "2019-10-24T14:47:26Z"}, "message": "Changed APIT with explicit generic args span to specific arg spans", "tree": {"sha": "0b0576cc7f13abaa85bfef6ccc7a06efb60ae07a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0b0576cc7f13abaa85bfef6ccc7a06efb60ae07a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4cfcb770844333a6c7e1ebddc8d30770098bdfd7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4cfcb770844333a6c7e1ebddc8d30770098bdfd7", "html_url": "https://github.com/rust-lang/rust/commit/4cfcb770844333a6c7e1ebddc8d30770098bdfd7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4cfcb770844333a6c7e1ebddc8d30770098bdfd7/comments", "author": {"login": "ObsidianMinor", "id": 10121870, "node_id": "MDQ6VXNlcjEwMTIxODcw", "avatar_url": "https://avatars.githubusercontent.com/u/10121870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ObsidianMinor", "html_url": "https://github.com/ObsidianMinor", "followers_url": "https://api.github.com/users/ObsidianMinor/followers", "following_url": "https://api.github.com/users/ObsidianMinor/following{/other_user}", "gists_url": "https://api.github.com/users/ObsidianMinor/gists{/gist_id}", "starred_url": "https://api.github.com/users/ObsidianMinor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ObsidianMinor/subscriptions", "organizations_url": "https://api.github.com/users/ObsidianMinor/orgs", "repos_url": "https://api.github.com/users/ObsidianMinor/repos", "events_url": "https://api.github.com/users/ObsidianMinor/events{/privacy}", "received_events_url": "https://api.github.com/users/ObsidianMinor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ObsidianMinor", "id": 10121870, "node_id": "MDQ6VXNlcjEwMTIxODcw", "avatar_url": "https://avatars.githubusercontent.com/u/10121870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ObsidianMinor", "html_url": "https://github.com/ObsidianMinor", "followers_url": "https://api.github.com/users/ObsidianMinor/followers", "following_url": "https://api.github.com/users/ObsidianMinor/following{/other_user}", "gists_url": "https://api.github.com/users/ObsidianMinor/gists{/gist_id}", "starred_url": "https://api.github.com/users/ObsidianMinor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ObsidianMinor/subscriptions", "organizations_url": "https://api.github.com/users/ObsidianMinor/orgs", "repos_url": "https://api.github.com/users/ObsidianMinor/repos", "events_url": "https://api.github.com/users/ObsidianMinor/events{/privacy}", "received_events_url": "https://api.github.com/users/ObsidianMinor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4a8c5b20c7772bc5342b83d4b0696ea216ef75a7", "url": "https://api.github.com/repos/rust-lang/rust/commits/4a8c5b20c7772bc5342b83d4b0696ea216ef75a7", "html_url": "https://github.com/rust-lang/rust/commit/4a8c5b20c7772bc5342b83d4b0696ea216ef75a7"}], "stats": {"total": 43, "additions": 29, "deletions": 14}, "files": [{"sha": "97f7c6a2c8a73b5ec0ed95ed15d7b18cf3513e59", "filename": "src/librustc_typeck/astconv.rs", "status": "modified", "additions": 17, "deletions": 4, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/4cfcb770844333a6c7e1ebddc8d30770098bdfd7/src%2Flibrustc_typeck%2Fastconv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cfcb770844333a6c7e1ebddc8d30770098bdfd7/src%2Flibrustc_typeck%2Fastconv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fastconv.rs?ref=4cfcb770844333a6c7e1ebddc8d30770098bdfd7", "patch": "@@ -215,7 +215,6 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n     /// Report error if there is an explicit type parameter when using `impl Trait`.\n     fn check_impl_trait(\n         tcx: TyCtxt<'_>,\n-        span: Span,\n         seg: &hir::PathSegment,\n         generics: &ty::Generics,\n     ) -> bool {\n@@ -228,14 +227,28 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n         });\n \n         if explicit && impl_trait {\n+            let spans =\n+                seg.generic_args().args\n+                    .iter()\n+                    .filter_map(|arg|\n+                        match arg {\n+                            GenericArg::Type(_) => Some(arg.span()),\n+                            _ => None\n+                        })\n+                    .collect::<Vec<_>>();\n+\n             let mut err = struct_span_err! {\n                 tcx.sess,\n-                span,\n+                spans.clone(),\n                 E0632,\n                 \"cannot provide explicit generic arguments when `impl Trait` is \\\n-                 used in argument position\"\n+                used in argument position\"\n             };\n \n+            for span in spans {\n+                err.span_label(span, \"explicit generic argument not allowed\");\n+            }\n+\n             err.emit();\n         }\n \n@@ -254,7 +267,7 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n         let empty_args = P(hir::GenericArgs {\n             args: HirVec::new(), bindings: HirVec::new(), parenthesized: false,\n         });\n-        let suppress_mismatch = Self::check_impl_trait(tcx, span, seg, &def);\n+        let suppress_mismatch = Self::check_impl_trait(tcx, seg, &def);\n         Self::check_generic_arg_count(\n             tcx,\n             span,"}, {"sha": "8f05ab3c4940c30e22f0f170108907dbeb31e65e", "filename": "src/test/ui/impl-trait/issues/universal-issue-48703.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4cfcb770844333a6c7e1ebddc8d30770098bdfd7/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Funiversal-issue-48703.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4cfcb770844333a6c7e1ebddc8d30770098bdfd7/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Funiversal-issue-48703.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Funiversal-issue-48703.stderr?ref=4cfcb770844333a6c7e1ebddc8d30770098bdfd7", "patch": "@@ -1,8 +1,8 @@\n error[E0632]: cannot provide explicit generic arguments when `impl Trait` is used in argument position\n-  --> $DIR/universal-issue-48703.rs:8:5\n+  --> $DIR/universal-issue-48703.rs:8:11\n    |\n LL |     foo::<String>('a');\n-   |     ^^^^^^^^^^^^^\n+   |           ^^^^^^ explicit generic argument not allowed\n \n error: aborting due to previous error\n "}, {"sha": "c980e9463e48ae383b377412b67cfaac37976414", "filename": "src/test/ui/impl-trait/issues/universal-turbofish-in-method-issue-50950.stderr", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4cfcb770844333a6c7e1ebddc8d30770098bdfd7/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Funiversal-turbofish-in-method-issue-50950.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4cfcb770844333a6c7e1ebddc8d30770098bdfd7/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Funiversal-turbofish-in-method-issue-50950.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fissues%2Funiversal-turbofish-in-method-issue-50950.stderr?ref=4cfcb770844333a6c7e1ebddc8d30770098bdfd7", "patch": "@@ -1,8 +1,10 @@\n error[E0632]: cannot provide explicit generic arguments when `impl Trait` is used in argument position\n-  --> $DIR/universal-turbofish-in-method-issue-50950.rs:14:9\n+  --> $DIR/universal-turbofish-in-method-issue-50950.rs:14:24\n    |\n LL |     evt.handle_event::<TestEvent, fn(TestEvent)>(|_evt| {\n-   |         ^^^^^^^^^^^^\n+   |                        ^^^^^^^^^  ^^^^^^^^^^^^^ explicit generic argument not allowed\n+   |                        |\n+   |                        explicit generic argument not allowed\n \n error: aborting due to previous error\n "}, {"sha": "951d7edb7f523ec14cbd3ad24f921b9d963fe8a5", "filename": "src/test/ui/synthetic-param.stderr", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/4cfcb770844333a6c7e1ebddc8d30770098bdfd7/src%2Ftest%2Fui%2Fsynthetic-param.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4cfcb770844333a6c7e1ebddc8d30770098bdfd7/src%2Ftest%2Fui%2Fsynthetic-param.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsynthetic-param.stderr?ref=4cfcb770844333a6c7e1ebddc8d30770098bdfd7", "patch": "@@ -1,20 +1,20 @@\n error[E0632]: cannot provide explicit generic arguments when `impl Trait` is used in argument position\n-  --> $DIR/synthetic-param.rs:20:5\n+  --> $DIR/synthetic-param.rs:20:12\n    |\n LL |     func::<u8>(42);\n-   |     ^^^^^^^^^^\n+   |            ^^ explicit generic argument not allowed\n \n error[E0632]: cannot provide explicit generic arguments when `impl Trait` is used in argument position\n-  --> $DIR/synthetic-param.rs:23:5\n+  --> $DIR/synthetic-param.rs:23:17\n    |\n LL |     Foo::func::<u8>(42);\n-   |     ^^^^^^^^^^^^^^^\n+   |                 ^^ explicit generic argument not allowed\n \n error[E0632]: cannot provide explicit generic arguments when `impl Trait` is used in argument position\n-  --> $DIR/synthetic-param.rs:26:5\n+  --> $DIR/synthetic-param.rs:26:23\n    |\n LL |     Bar::<i8>::func::<u8>(42);\n-   |     ^^^^^^^^^^^^^^^^^^^^^\n+   |                       ^^ explicit generic argument not allowed\n \n error: aborting due to 3 previous errors\n "}]}