{"sha": "cb250b722e8c9c8b2e6dff249ce8e027dce2cd65", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNiMjUwYjcyMmU4YzljOGIyZTZkZmYyNDljZThlMDI3ZGNlMmNkNjU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-07-31T02:57:34Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-07-31T02:57:34Z"}, "message": "Auto merge of #27370 - alexcrichton:stabilize-easy, r=brson\n\nThe following APIs were all marked with a `#[stable]` tag:\r\n\r\n* process::Child::id\r\n* error::Error::is\r\n* error::Error::downcast\r\n* error::Error::downcast_ref\r\n* error::Error::downcast_mut\r\n* io::Error::get_ref\r\n* io::Error::get_mut\r\n* io::Error::into_inner\r\n* hash::Hash::hash_slice\r\n* hash::Hasher::write_{i,u}{8,16,32,64,size}", "tree": {"sha": "d461b5e0dc9af3ffe4f051f31cd5b1450977130e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d461b5e0dc9af3ffe4f051f31cd5b1450977130e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cb250b722e8c9c8b2e6dff249ce8e027dce2cd65", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cb250b722e8c9c8b2e6dff249ce8e027dce2cd65", "html_url": "https://github.com/rust-lang/rust/commit/cb250b722e8c9c8b2e6dff249ce8e027dce2cd65", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cb250b722e8c9c8b2e6dff249ce8e027dce2cd65/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dc966ef95cf9c428b29e1346e54768f7411466c8", "url": "https://api.github.com/repos/rust-lang/rust/commits/dc966ef95cf9c428b29e1346e54768f7411466c8", "html_url": "https://github.com/rust-lang/rust/commit/dc966ef95cf9c428b29e1346e54768f7411466c8"}, {"sha": "76db37ee4b916a678181b36e42c26d92524e7041", "url": "https://api.github.com/repos/rust-lang/rust/commits/76db37ee4b916a678181b36e42c26d92524e7041", "html_url": "https://github.com/rust-lang/rust/commit/76db37ee4b916a678181b36e42c26d92524e7041"}], "stats": {"total": 142, "additions": 111, "deletions": 31}, "files": [{"sha": "e35f380d06f3d8be57ea8fe50c27f4c3aefaeb2e", "filename": "src/libcore/hash/mod.rs", "status": "modified", "additions": 11, "deletions": 12, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/cb250b722e8c9c8b2e6dff249ce8e027dce2cd65/src%2Flibcore%2Fhash%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cb250b722e8c9c8b2e6dff249ce8e027dce2cd65/src%2Flibcore%2Fhash%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fhash%2Fmod.rs?ref=cb250b722e8c9c8b2e6dff249ce8e027dce2cd65", "patch": "@@ -91,8 +91,7 @@ pub trait Hash {\n     fn hash<H: Hasher>(&self, state: &mut H);\n \n     /// Feeds a slice of this type into the state provided.\n-    #[unstable(feature = \"hash_slice\",\n-               reason = \"module was recently redesigned\")]\n+    #[stable(feature = \"hash_slice\", since = \"1.3.0\")]\n     fn hash_slice<H: Hasher>(data: &[Self], state: &mut H) where Self: Sized {\n         for piece in data {\n             piece.hash(state);\n@@ -113,29 +112,29 @@ pub trait Hasher {\n \n     /// Write a single `u8` into this hasher\n     #[inline]\n-    #[unstable(feature = \"hasher_write\", reason = \"module was recently redesigned\")]\n+    #[stable(feature = \"hasher_write\", since = \"1.3.0\")]\n     fn write_u8(&mut self, i: u8) { self.write(&[i]) }\n     /// Write a single `u16` into this hasher.\n     #[inline]\n-    #[unstable(feature = \"hasher_write\", reason = \"module was recently redesigned\")]\n+    #[stable(feature = \"hasher_write\", since = \"1.3.0\")]\n     fn write_u16(&mut self, i: u16) {\n         self.write(&unsafe { mem::transmute::<_, [u8; 2]>(i) })\n     }\n     /// Write a single `u32` into this hasher.\n     #[inline]\n-    #[unstable(feature = \"hasher_write\", reason = \"module was recently redesigned\")]\n+    #[stable(feature = \"hasher_write\", since = \"1.3.0\")]\n     fn write_u32(&mut self, i: u32) {\n         self.write(&unsafe { mem::transmute::<_, [u8; 4]>(i) })\n     }\n     /// Write a single `u64` into this hasher.\n     #[inline]\n-    #[unstable(feature = \"hasher_write\", reason = \"module was recently redesigned\")]\n+    #[stable(feature = \"hasher_write\", since = \"1.3.0\")]\n     fn write_u64(&mut self, i: u64) {\n         self.write(&unsafe { mem::transmute::<_, [u8; 8]>(i) })\n     }\n     /// Write a single `usize` into this hasher.\n     #[inline]\n-    #[unstable(feature = \"hasher_write\", reason = \"module was recently redesigned\")]\n+    #[stable(feature = \"hasher_write\", since = \"1.3.0\")]\n     fn write_usize(&mut self, i: usize) {\n         if cfg!(target_pointer_width = \"32\") {\n             self.write_u32(i as u32)\n@@ -146,23 +145,23 @@ pub trait Hasher {\n \n     /// Write a single `i8` into this hasher.\n     #[inline]\n-    #[unstable(feature = \"hasher_write\", reason = \"module was recently redesigned\")]\n+    #[stable(feature = \"hasher_write\", since = \"1.3.0\")]\n     fn write_i8(&mut self, i: i8) { self.write_u8(i as u8) }\n     /// Write a single `i16` into this hasher.\n     #[inline]\n-    #[unstable(feature = \"hasher_write\", reason = \"module was recently redesigned\")]\n+    #[stable(feature = \"hasher_write\", since = \"1.3.0\")]\n     fn write_i16(&mut self, i: i16) { self.write_u16(i as u16) }\n     /// Write a single `i32` into this hasher.\n     #[inline]\n-    #[unstable(feature = \"hasher_write\", reason = \"module was recently redesigned\")]\n+    #[stable(feature = \"hasher_write\", since = \"1.3.0\")]\n     fn write_i32(&mut self, i: i32) { self.write_u32(i as u32) }\n     /// Write a single `i64` into this hasher.\n     #[inline]\n-    #[unstable(feature = \"hasher_write\", reason = \"module was recently redesigned\")]\n+    #[stable(feature = \"hasher_write\", since = \"1.3.0\")]\n     fn write_i64(&mut self, i: i64) { self.write_u64(i as u64) }\n     /// Write a single `isize` into this hasher.\n     #[inline]\n-    #[unstable(feature = \"hasher_write\", reason = \"module was recently redesigned\")]\n+    #[stable(feature = \"hasher_write\", since = \"1.3.0\")]\n     fn write_isize(&mut self, i: isize) { self.write_usize(i as usize) }\n }\n "}, {"sha": "4d08f08bb6eb93929aaedd3ce690008ddc78796f", "filename": "src/libstd/error.rs", "status": "modified", "additions": 93, "deletions": 9, "changes": 102, "blob_url": "https://github.com/rust-lang/rust/blob/cb250b722e8c9c8b2e6dff249ce8e027dce2cd65/src%2Flibstd%2Ferror.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cb250b722e8c9c8b2e6dff249ce8e027dce2cd65/src%2Flibstd%2Ferror.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Ferror.rs?ref=cb250b722e8c9c8b2e6dff249ce8e027dce2cd65", "patch": "@@ -168,7 +168,7 @@ impl Error for string::FromUtf16Error {\n // copied from any.rs\n impl Error + 'static {\n     /// Returns true if the boxed type is the same as `T`\n-    #[unstable(feature = \"error_downcast\", reason = \"recently added\")]\n+    #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     #[inline]\n     pub fn is<T: Error + 'static>(&self) -> bool {\n         // Get TypeId of the type this function is instantiated with\n@@ -183,7 +183,7 @@ impl Error + 'static {\n \n     /// Returns some reference to the boxed value if it is of type `T`, or\n     /// `None` if it isn't.\n-    #[unstable(feature = \"error_downcast\", reason = \"recently added\")]\n+    #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     #[inline]\n     pub fn downcast_ref<T: Error + 'static>(&self) -> Option<&T> {\n         if self.is::<T>() {\n@@ -201,7 +201,7 @@ impl Error + 'static {\n \n     /// Returns some mutable reference to the boxed value if it is of type `T`, or\n     /// `None` if it isn't.\n-    #[unstable(feature = \"error_downcast\", reason = \"recently added\")]\n+    #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     #[inline]\n     pub fn downcast_mut<T: Error + 'static>(&mut self) -> Option<&mut T> {\n         if self.is::<T>() {\n@@ -220,21 +220,44 @@ impl Error + 'static {\n \n impl Error + 'static + Send {\n     /// Forwards to the method defined on the type `Any`.\n-    #[unstable(feature = \"error_downcast\", reason = \"recently added\")]\n+    #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     #[inline]\n     pub fn is<T: Error + 'static>(&self) -> bool {\n         <Error + 'static>::is::<T>(self)\n     }\n \n     /// Forwards to the method defined on the type `Any`.\n-    #[unstable(feature = \"error_downcast\", reason = \"recently added\")]\n+    #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     #[inline]\n     pub fn downcast_ref<T: Error + 'static>(&self) -> Option<&T> {\n         <Error + 'static>::downcast_ref::<T>(self)\n     }\n \n     /// Forwards to the method defined on the type `Any`.\n-    #[unstable(feature = \"error_downcast\", reason = \"recently added\")]\n+    #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n+    #[inline]\n+    pub fn downcast_mut<T: Error + 'static>(&mut self) -> Option<&mut T> {\n+        <Error + 'static>::downcast_mut::<T>(self)\n+    }\n+}\n+\n+impl Error + 'static + Send + Sync {\n+    /// Forwards to the method defined on the type `Any`.\n+    #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n+    #[inline]\n+    pub fn is<T: Error + 'static>(&self) -> bool {\n+        <Error + 'static>::is::<T>(self)\n+    }\n+\n+    /// Forwards to the method defined on the type `Any`.\n+    #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n+    #[inline]\n+    pub fn downcast_ref<T: Error + 'static>(&self) -> Option<&T> {\n+        <Error + 'static>::downcast_ref::<T>(self)\n+    }\n+\n+    /// Forwards to the method defined on the type `Any`.\n+    #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     #[inline]\n     pub fn downcast_mut<T: Error + 'static>(&mut self) -> Option<&mut T> {\n         <Error + 'static>::downcast_mut::<T>(self)\n@@ -243,7 +266,7 @@ impl Error + 'static + Send {\n \n impl Error {\n     #[inline]\n-    #[unstable(feature = \"error_downcast\", reason = \"recently added\")]\n+    #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     /// Attempt to downcast the box to a concrete type.\n     pub fn downcast<T: Error + 'static>(self: Box<Self>) -> Result<Box<T>, Box<Error>> {\n         if self.is::<T>() {\n@@ -264,13 +287,74 @@ impl Error {\n \n impl Error + Send {\n     #[inline]\n-    #[unstable(feature = \"error_downcast\", reason = \"recently added\")]\n+    #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     /// Attempt to downcast the box to a concrete type.\n-    pub fn downcast<T: Error + 'static>(self: Box<Self>) -> Result<Box<T>, Box<Error + Send>> {\n+    pub fn downcast<T: Error + 'static>(self: Box<Self>)\n+                                        -> Result<Box<T>, Box<Error + Send>> {\n         let err: Box<Error> = self;\n         <Error>::downcast(err).map_err(|s| unsafe {\n             // reapply the Send marker\n             transmute::<Box<Error>, Box<Error + Send>>(s)\n         })\n     }\n }\n+\n+impl Error + Send + Sync {\n+    #[inline]\n+    #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n+    /// Attempt to downcast the box to a concrete type.\n+    pub fn downcast<T: Error + 'static>(self: Box<Self>)\n+                                        -> Result<Box<T>, Box<Self>> {\n+        let err: Box<Error> = self;\n+        <Error>::downcast(err).map_err(|s| unsafe {\n+            // reapply the Send+Sync marker\n+            transmute::<Box<Error>, Box<Error + Send + Sync>>(s)\n+        })\n+    }\n+}\n+\n+#[cfg(test)]\n+mod tests {\n+    use prelude::v1::*;\n+    use super::Error;\n+    use fmt;\n+\n+    #[derive(Debug, PartialEq)]\n+    struct A;\n+    #[derive(Debug, PartialEq)]\n+    struct B;\n+\n+    impl fmt::Display for A {\n+        fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\n+            write!(f, \"A\")\n+        }\n+    }\n+    impl fmt::Display for B {\n+        fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\n+            write!(f, \"B\")\n+        }\n+    }\n+\n+    impl Error for A {\n+        fn description(&self) -> &str { \"A-desc\" }\n+    }\n+    impl Error for B {\n+        fn description(&self) -> &str { \"A-desc\" }\n+    }\n+\n+    #[test]\n+    fn downcasting() {\n+        let mut a = A;\n+        let mut a = &mut a as &mut (Error + 'static);\n+        assert_eq!(a.downcast_ref::<A>(), Some(&A));\n+        assert_eq!(a.downcast_ref::<B>(), None);\n+        assert_eq!(a.downcast_mut::<A>(), Some(&mut A));\n+        assert_eq!(a.downcast_mut::<B>(), None);\n+\n+        let a: Box<Error> = Box::new(A);\n+        match a.downcast::<B>() {\n+            Ok(..) => panic!(\"expected error\"),\n+            Err(e) => assert_eq!(*e.downcast::<A>().unwrap(), A),\n+        }\n+    }\n+}"}, {"sha": "e12e202148b53e8d970ea7a5f1842b936359e9cd", "filename": "src/libstd/io/error.rs", "status": "modified", "additions": 6, "deletions": 9, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/cb250b722e8c9c8b2e6dff249ce8e027dce2cd65/src%2Flibstd%2Fio%2Ferror.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cb250b722e8c9c8b2e6dff249ce8e027dce2cd65/src%2Flibstd%2Fio%2Ferror.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fio%2Ferror.rs?ref=cb250b722e8c9c8b2e6dff249ce8e027dce2cd65", "patch": "@@ -219,8 +219,7 @@ impl Error {\n     ///\n     /// If this `Error` was constructed via `new` then this function will\n     /// return `Some`, otherwise it will return `None`.\n-    #[unstable(feature = \"io_error_inner\",\n-               reason = \"recently added and requires UFCS to downcast\")]\n+    #[stable(feature = \"io_error_inner\", since = \"1.3.0\")]\n     pub fn get_ref(&self) -> Option<&(error::Error+Send+Sync+'static)> {\n         match self.repr {\n             Repr::Os(..) => None,\n@@ -233,8 +232,7 @@ impl Error {\n     ///\n     /// If this `Error` was constructed via `new` then this function will\n     /// return `Some`, otherwise it will return `None`.\n-    #[unstable(feature = \"io_error_inner\",\n-               reason = \"recently added and requires UFCS to downcast\")]\n+    #[stable(feature = \"io_error_inner\", since = \"1.3.0\")]\n     pub fn get_mut(&mut self) -> Option<&mut (error::Error+Send+Sync+'static)> {\n         match self.repr {\n             Repr::Os(..) => None,\n@@ -246,8 +244,7 @@ impl Error {\n     ///\n     /// If this `Error` was constructed via `new` then this function will\n     /// return `Some`, otherwise it will return `None`.\n-    #[unstable(feature = \"io_error_inner\",\n-               reason = \"recently added and requires UFCS to downcast\")]\n+    #[stable(feature = \"io_error_inner\", since = \"1.3.0\")]\n     pub fn into_inner(self) -> Option<Box<error::Error+Send+Sync>> {\n         match self.repr {\n             Repr::Os(..) => None,\n@@ -349,10 +346,10 @@ mod test {\n         // we have to call all of these UFCS style right now since method\n         // resolution won't implicitly drop the Send+Sync bounds\n         let mut err = Error::new(ErrorKind::Other, TestError);\n-        assert!(error::Error::is::<TestError>(err.get_ref().unwrap()));\n+        assert!(err.get_ref().unwrap().is::<TestError>());\n         assert_eq!(\"asdf\", err.get_ref().unwrap().description());\n-        assert!(error::Error::is::<TestError>(err.get_mut().unwrap()));\n+        assert!(err.get_mut().unwrap().is::<TestError>());\n         let extracted = err.into_inner().unwrap();\n-        error::Error::downcast::<TestError>(extracted).unwrap();\n+        extracted.downcast::<TestError>().unwrap();\n     }\n }"}, {"sha": "74a6655862738ed8121be9b4bded3aefe8ba0841", "filename": "src/libstd/process.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cb250b722e8c9c8b2e6dff249ce8e027dce2cd65/src%2Flibstd%2Fprocess.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cb250b722e8c9c8b2e6dff249ce8e027dce2cd65/src%2Flibstd%2Fprocess.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fprocess.rs?ref=cb250b722e8c9c8b2e6dff249ce8e027dce2cd65", "patch": "@@ -505,7 +505,7 @@ impl Child {\n     }\n \n     /// Returns the OS-assigned process identifier associated with this child.\n-    #[unstable(feature = \"process_id\", reason = \"api recently added\")]\n+    #[stable(feature = \"process_id\", since = \"1.3.0\")]\n     pub fn id(&self) -> u32 {\n         self.handle.id()\n     }"}]}