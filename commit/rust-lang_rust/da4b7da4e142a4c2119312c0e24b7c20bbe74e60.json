{"sha": "da4b7da4e142a4c2119312c0e24b7c20bbe74e60", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRhNGI3ZGE0ZTE0MmE0YzIxMTkzMTJjMGUyNGI3YzIwYmJlNzRlNjA=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-11-17T02:33:00Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-11-17T02:33:00Z"}, "message": "rt: Make stack growth code build on Linux", "tree": {"sha": "35ab347a8c79605ea6f5604fe590897b4c5fdf93", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/35ab347a8c79605ea6f5604fe590897b4c5fdf93"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/da4b7da4e142a4c2119312c0e24b7c20bbe74e60", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/da4b7da4e142a4c2119312c0e24b7c20bbe74e60", "html_url": "https://github.com/rust-lang/rust/commit/da4b7da4e142a4c2119312c0e24b7c20bbe74e60", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/da4b7da4e142a4c2119312c0e24b7c20bbe74e60/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "68aff2ad6d55a051e9347aa38f945d114f282691", "url": "https://api.github.com/repos/rust-lang/rust/commits/68aff2ad6d55a051e9347aa38f945d114f282691", "html_url": "https://github.com/rust-lang/rust/commit/68aff2ad6d55a051e9347aa38f945d114f282691"}], "stats": {"total": 14, "additions": 7, "deletions": 7}, "files": [{"sha": "0208fe7ab55536047e8c26537ccdd25030afa4c5", "filename": "mk/rt.mk", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/da4b7da4e142a4c2119312c0e24b7c20bbe74e60/mk%2Frt.mk", "raw_url": "https://github.com/rust-lang/rust/raw/da4b7da4e142a4c2119312c0e24b7c20bbe74e60/mk%2Frt.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Frt.mk?ref=da4b7da4e142a4c2119312c0e24b7c20bbe74e60", "patch": "@@ -67,8 +67,7 @@ RUNTIME_CS_$(1) := \\\n \n RUNTIME_S_$(1) := rt/arch/$$(HOST_$(1))/_context.S \\\n                   rt/arch/$$(HOST_$(1))/ccall.S \\\n-                  rt/arch/$$(HOST_$(1))/morestack.S \\\n-                  rt/arch/$$(HOST_$(1))/record_sp.S\n+                  rt/arch/$$(HOST_$(1))/morestack.S\n \n RUNTIME_HDR_$(1) := rt/globals.h \\\n                rt/rust.h \\"}, {"sha": "b8e14bdb579961368482fde0e698ab703f6d5cca", "filename": "src/rt/arch/i386/morestack.S", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/da4b7da4e142a4c2119312c0e24b7c20bbe74e60/src%2Frt%2Farch%2Fi386%2Fmorestack.S", "raw_url": "https://github.com/rust-lang/rust/raw/da4b7da4e142a4c2119312c0e24b7c20bbe74e60/src%2Frt%2Farch%2Fi386%2Fmorestack.S", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Farch%2Fi386%2Fmorestack.S?ref=da4b7da4e142a4c2119312c0e24b7c20bbe74e60", "patch": "@@ -106,13 +106,18 @@ L$bail:\n \n #ifdef __APPLE__\n \n-\t.section\t__IMPORT,__pointers,non_lazy_symbol_pointers\n+\t\t.section\t__IMPORT,__pointers,non_lazy_symbol_pointers\n rust_new_stack_sym:\n     .indirect_symbol RUST_NEW_STACK\n     .long 0\n rust_del_stack_sym:\n     .indirect_symbol RUST_DEL_STACK\n     .long 0\n \n+#else\n+\n+rust_new_stack_sym:\n+rust_del_stack_sym:\n+\n #endif\n "}, {"sha": "cf6091818cc08fb46e4bca3239d7b47fae1357b3", "filename": "src/rt/rust_scheduler.cpp", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/da4b7da4e142a4c2119312c0e24b7c20bbe74e60/src%2Frt%2Frust_scheduler.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/da4b7da4e142a4c2119312c0e24b7c20bbe74e60/src%2Frt%2Frust_scheduler.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_scheduler.cpp?ref=da4b7da4e142a4c2119312c0e24b7c20bbe74e60", "patch": "@@ -13,9 +13,6 @@ DWORD rust_scheduler::task_key;\n \n bool rust_scheduler::tls_initialized = false;\n \n-// Defined in arch/*/record_sp.S.\n-extern \"C\" void rust_record_sp(uintptr_t sp);\n-\n rust_scheduler::rust_scheduler(rust_kernel *kernel,\n                                rust_srv *srv,\n                                int id) :\n@@ -289,7 +286,6 @@ rust_scheduler::start_main_loop() {\n              scheduled_task->state->name);\n \n         place_task_in_tls(scheduled_task);\n-        rust_record_sp(scheduled_task->stk->limit);\n         //pthread_setspecific(89, (void *)scheduled_task->stk->limit);\n \n         interrupt_flag = 0;"}]}