{"sha": "1adf0519bcc8286c06e12aa7e5b16298addfea4a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFhZGYwNTE5YmNjODI4NmMwNmUxMmFhN2U1YjE2Mjk4YWRkZmVhNGE=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2019-09-12T21:35:28Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-09-12T21:35:28Z"}, "message": "Merge #1835\n\n1835: rename AdtDef -> Adt r=matklad a=matklad\n\n\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>", "tree": {"sha": "3fe7cb05dc4d92d19ecbb87bfafc4a9ff202153e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3fe7cb05dc4d92d19ecbb87bfafc4a9ff202153e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1adf0519bcc8286c06e12aa7e5b16298addfea4a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJderohCRBK7hj4Ov3rIwAAdHIIAH9v6NZWprv9ryLCLPQfuard\nnImkaBTBRdOcfF20CC2NbWjhqkQWdjyH6FhQEJSwYFBIWJBf2K4ZwNsdpgGyrIwV\nYoYleOt3HWMG0KLbGXIEocx/hpuG049l3P7s75me11pbp8tjc7ND5KzRE/MVQ63g\nLXVLnwPN3ZigC/NLEVbMSG6HGIvacGlSNiOHAgvIi6qYB8Bh90QEkXIIht9mSByc\n8Voet7l3YD/4rdSwz2D7H4XzZAODZInhwxv5v0jNxNiFehWYmQ3DvcQQup3ha3aL\nEfoNOlGDw+TVj08bS+9PSTGHJarwOox/d0TYThwT8+/Fn6ct5IhaFWAlwgmYCA4=\n=3Lz+\n-----END PGP SIGNATURE-----\n", "payload": "tree 3fe7cb05dc4d92d19ecbb87bfafc4a9ff202153e\nparent d8b621cf26b59ff5ae9379b50fc822590b6a3a4e\nparent 114a1b878e95c20490af574550ea0825b7a8f9d1\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1568324128 +0000\ncommitter GitHub <noreply@github.com> 1568324128 +0000\n\nMerge #1835\n\n1835: rename AdtDef -> Adt r=matklad a=matklad\n\n\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1adf0519bcc8286c06e12aa7e5b16298addfea4a", "html_url": "https://github.com/rust-lang/rust/commit/1adf0519bcc8286c06e12aa7e5b16298addfea4a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1adf0519bcc8286c06e12aa7e5b16298addfea4a/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d8b621cf26b59ff5ae9379b50fc822590b6a3a4e", "url": "https://api.github.com/repos/rust-lang/rust/commits/d8b621cf26b59ff5ae9379b50fc822590b6a3a4e", "html_url": "https://github.com/rust-lang/rust/commit/d8b621cf26b59ff5ae9379b50fc822590b6a3a4e"}, {"sha": "114a1b878e95c20490af574550ea0825b7a8f9d1", "url": "https://api.github.com/repos/rust-lang/rust/commits/114a1b878e95c20490af574550ea0825b7a8f9d1", "html_url": "https://github.com/rust-lang/rust/commit/114a1b878e95c20490af574550ea0825b7a8f9d1"}], "stats": {"total": 276, "additions": 135, "deletions": 141}, "files": [{"sha": "543ed164c7773767ea19dabf2e68252fb986a03e", "filename": "crates/ra_assists/src/fill_match_arms.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_assists%2Fsrc%2Ffill_match_arms.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_assists%2Fsrc%2Ffill_match_arms.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_assists%2Fsrc%2Ffill_match_arms.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -1,6 +1,6 @@\n use std::iter;\n \n-use hir::{db::HirDatabase, AdtDef, HasSource};\n+use hir::{db::HirDatabase, Adt, HasSource};\n use ra_syntax::ast::{self, AstNode, NameOwner};\n \n use crate::{ast_editor::AstBuilder, Assist, AssistCtx, AssistId};\n@@ -60,7 +60,7 @@ fn resolve_enum_def(\n     let expr_ty = analyzer.type_of(db, &expr)?;\n \n     analyzer.autoderef(db, expr_ty).find_map(|ty| match ty.as_adt() {\n-        Some((AdtDef::Enum(e), _)) => Some(e.source(db).ast),\n+        Some((Adt::Enum(e), _)) => Some(e.source(db).ast),\n         _ => None,\n     })\n }"}, {"sha": "56f2b7aa36d330a32de5ba44f5a5654973767e82", "filename": "crates/ra_hir/src/adt.rs", "status": "modified", "additions": 1, "deletions": 21, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fadt.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fadt.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fadt.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -9,29 +9,9 @@ use ra_syntax::ast::{self, NameOwner, StructKind, TypeAscriptionOwner};\n use crate::{\n     db::{AstDatabase, DefDatabase, HirDatabase},\n     type_ref::TypeRef,\n-    AsName, Crate, Enum, EnumVariant, FieldSource, HasSource, Name, Source, Struct, StructField,\n-    Union,\n+    AsName, Enum, EnumVariant, FieldSource, HasSource, Name, Source, Struct, StructField,\n };\n \n-#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash)]\n-pub enum AdtDef {\n-    Struct(Struct),\n-    Union(Union),\n-    Enum(Enum),\n-}\n-impl_froms!(AdtDef: Struct, Union, Enum);\n-\n-impl AdtDef {\n-    pub(crate) fn krate(self, db: &impl HirDatabase) -> Option<Crate> {\n-        match self {\n-            AdtDef::Struct(s) => s.module(db),\n-            AdtDef::Union(s) => s.module(db),\n-            AdtDef::Enum(e) => e.module(db),\n-        }\n-        .krate(db)\n-    }\n-}\n-\n impl Struct {\n     pub(crate) fn variant_data(self, db: &impl DefDatabase) -> Arc<VariantData> {\n         db.struct_data(self).variant_data.clone()"}, {"sha": "c1938bd8670486b74927a03b39ad016a22e384d4", "filename": "crates/ra_hir/src/code_model.rs", "status": "modified", "additions": 38, "deletions": 6, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fcode_model.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fcode_model.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fcode_model.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -127,9 +127,7 @@ impl BuiltinType {\n pub enum ModuleDef {\n     Module(Module),\n     Function(Function),\n-    Struct(Struct),\n-    Union(Union),\n-    Enum(Enum),\n+    Adt(Adt),\n     // Can't be directly declared, but can be imported.\n     EnumVariant(EnumVariant),\n     Const(Const),\n@@ -141,9 +139,7 @@ pub enum ModuleDef {\n impl_froms!(\n     ModuleDef: Module,\n     Function,\n-    Struct,\n-    Union,\n-    Enum,\n+    Adt(Struct, Enum, Union),\n     EnumVariant,\n     Const,\n     Static,\n@@ -500,6 +496,42 @@ impl EnumVariant {\n     }\n }\n \n+/// A Data Type\n+#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash)]\n+pub enum Adt {\n+    Struct(Struct),\n+    Union(Union),\n+    Enum(Enum),\n+}\n+impl_froms!(Adt: Struct, Union, Enum);\n+\n+impl Adt {\n+    pub fn ty(self, db: &impl HirDatabase) -> Ty {\n+        match self {\n+            Adt::Struct(it) => it.ty(db),\n+            Adt::Union(it) => it.ty(db),\n+            Adt::Enum(it) => it.ty(db),\n+        }\n+    }\n+\n+    pub(crate) fn krate(self, db: &impl HirDatabase) -> Option<Crate> {\n+        match self {\n+            Adt::Struct(s) => s.module(db),\n+            Adt::Union(s) => s.module(db),\n+            Adt::Enum(e) => e.module(db),\n+        }\n+        .krate(db)\n+    }\n+\n+    pub(crate) fn resolver(self, db: &impl HirDatabase) -> Resolver {\n+        match self {\n+            Adt::Struct(it) => it.resolver(db),\n+            Adt::Union(it) => it.resolver(db),\n+            Adt::Enum(it) => it.resolver(db),\n+        }\n+    }\n+}\n+\n /// The defs which have a body.\n #[derive(Debug, Clone, Copy, PartialEq, Eq, Hash)]\n pub enum DefWithBody {"}, {"sha": "030ec53a29d68433ffe4fb39139e276b0eba0591", "filename": "crates/ra_hir/src/expr/validation.rs", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fexpr%2Fvalidation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fexpr%2Fvalidation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fexpr%2Fvalidation.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -4,14 +4,13 @@ use ra_syntax::ast;\n use rustc_hash::FxHashSet;\n \n use crate::{\n-    adt::AdtDef,\n     db::HirDatabase,\n     diagnostics::{DiagnosticSink, MissingFields, MissingOkInTailExpr},\n     expr::AstPtr,\n     name,\n     path::{PathKind, PathSegment},\n     ty::{ApplicationTy, InferenceResult, Ty, TypeCtor},\n-    Function, Name, Path,\n+    Adt, Function, Name, Path,\n };\n \n use super::{Expr, ExprId, RecordLitField};\n@@ -59,7 +58,7 @@ impl<'a, 'b> ExprValidator<'a, 'b> {\n         }\n \n         let struct_def = match self.infer[id].as_adt() {\n-            Some((AdtDef::Struct(s), _)) => s,\n+            Some((Adt::Struct(s), _)) => s,\n             _ => return,\n         };\n \n@@ -124,7 +123,7 @@ impl<'a, 'b> ExprValidator<'a, 'b> {\n             _ => return,\n         };\n \n-        let std_result_ctor = TypeCtor::Adt(AdtDef::Enum(std_result_enum));\n+        let std_result_ctor = TypeCtor::Adt(Adt::Enum(std_result_enum));\n         let params = match &mismatch.expected {\n             Ty::Apply(ApplicationTy { ctor, parameters }) if ctor == &std_result_ctor => parameters,\n             _ => return,"}, {"sha": "77fb76bfcc1c55815a09ebcc98444a665615c651", "filename": "crates/ra_hir/src/generics.rs", "status": "modified", "additions": 16, "deletions": 26, "changes": 42, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fgenerics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fgenerics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fgenerics.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -12,8 +12,8 @@ use crate::{\n     name::SELF_TYPE,\n     path::Path,\n     type_ref::{TypeBound, TypeRef},\n-    AdtDef, AsName, Container, Enum, EnumVariant, Function, HasSource, ImplBlock, Name, Struct,\n-    Trait, TypeAlias, Union,\n+    Adt, AsName, Container, Enum, EnumVariant, Function, HasSource, ImplBlock, Name, Struct, Trait,\n+    TypeAlias, Union,\n };\n \n /// Data about a generic parameter (to a function, struct, impl, ...).\n@@ -47,17 +47,22 @@ pub struct WherePredicate {\n #[derive(Clone, Copy, PartialEq, Eq, Debug, Hash)]\n pub enum GenericDef {\n     Function(Function),\n-    Struct(Struct),\n-    Union(Union),\n-    Enum(Enum),\n+    Adt(Adt),\n     Trait(Trait),\n     TypeAlias(TypeAlias),\n     ImplBlock(ImplBlock),\n     // enum variants cannot have generics themselves, but their parent enums\n     // can, and this makes some code easier to write\n     EnumVariant(EnumVariant),\n }\n-impl_froms!(GenericDef: Function, Struct, Union, Enum, Trait, TypeAlias, ImplBlock, EnumVariant);\n+impl_froms!(\n+    GenericDef: Function,\n+    Adt(Struct, Enum, Union),\n+    Trait,\n+    TypeAlias,\n+    ImplBlock,\n+    EnumVariant\n+);\n \n impl GenericParams {\n     pub(crate) fn generic_params_query(\n@@ -69,20 +74,17 @@ impl GenericParams {\n             GenericDef::Function(it) => it.container(db).map(GenericDef::from),\n             GenericDef::TypeAlias(it) => it.container(db).map(GenericDef::from),\n             GenericDef::EnumVariant(it) => Some(it.parent_enum(db).into()),\n-            GenericDef::Struct(_)\n-            | GenericDef::Union(_)\n-            | GenericDef::Enum(_)\n-            | GenericDef::Trait(_) => None,\n+            GenericDef::Adt(_) | GenericDef::Trait(_) => None,\n             GenericDef::ImplBlock(_) => None,\n         };\n         generics.parent_params = parent.map(|p| db.generic_params(p));\n         let start = generics.parent_params.as_ref().map(|p| p.params.len()).unwrap_or(0) as u32;\n         // FIXME: add `: Sized` bound for everything except for `Self` in traits\n         match def {\n             GenericDef::Function(it) => generics.fill(&it.source(db).ast, start),\n-            GenericDef::Struct(it) => generics.fill(&it.source(db).ast, start),\n-            GenericDef::Union(it) => generics.fill(&it.source(db).ast, start),\n-            GenericDef::Enum(it) => generics.fill(&it.source(db).ast, start),\n+            GenericDef::Adt(Adt::Struct(it)) => generics.fill(&it.source(db).ast, start),\n+            GenericDef::Adt(Adt::Union(it)) => generics.fill(&it.source(db).ast, start),\n+            GenericDef::Adt(Adt::Enum(it)) => generics.fill(&it.source(db).ast, start),\n             GenericDef::Trait(it) => {\n                 // traits get the Self type as an implicit first type parameter\n                 generics.params.push(GenericParam { idx: start, name: SELF_TYPE, default: None });\n@@ -186,9 +188,7 @@ impl GenericDef {\n     pub(crate) fn resolver(&self, db: &impl HirDatabase) -> crate::Resolver {\n         match self {\n             GenericDef::Function(inner) => inner.resolver(db),\n-            GenericDef::Struct(inner) => inner.resolver(db),\n-            GenericDef::Union(inner) => inner.resolver(db),\n-            GenericDef::Enum(inner) => inner.resolver(db),\n+            GenericDef::Adt(adt) => adt.resolver(db),\n             GenericDef::Trait(inner) => inner.resolver(db),\n             GenericDef::TypeAlias(inner) => inner.resolver(db),\n             GenericDef::ImplBlock(inner) => inner.resolver(db),\n@@ -206,16 +206,6 @@ impl From<Container> for GenericDef {\n     }\n }\n \n-impl From<crate::adt::AdtDef> for GenericDef {\n-    fn from(adt: crate::adt::AdtDef) -> Self {\n-        match adt {\n-            AdtDef::Struct(s) => s.into(),\n-            AdtDef::Union(u) => u.into(),\n-            AdtDef::Enum(e) => e.into(),\n-        }\n-    }\n-}\n-\n pub trait HasGenericParams: Copy {\n     fn generic_params(self, db: &impl DefDatabase) -> Arc<GenericParams>;\n }"}, {"sha": "e3b71cec31865e428a424621cc3efa742130ecb6", "filename": "crates/ra_hir/src/lang_item.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Flang_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Flang_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Flang_item.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -5,7 +5,7 @@ use ra_syntax::{ast::AttrsOwner, SmolStr};\n \n use crate::{\n     db::{AstDatabase, DefDatabase, HirDatabase},\n-    Crate, Enum, Function, HasSource, ImplBlock, Module, ModuleDef, Static, Struct, Trait,\n+    Adt, Crate, Enum, Function, HasSource, ImplBlock, Module, ModuleDef, Static, Struct, Trait,\n };\n \n #[derive(Debug, Clone, Copy, PartialEq, Eq, Hash)]\n@@ -107,8 +107,10 @@ impl LangItems {\n                 ModuleDef::Trait(trait_) => {\n                     self.collect_lang_item(db, trait_, LangItemTarget::Trait)\n                 }\n-                ModuleDef::Enum(e) => self.collect_lang_item(db, e, LangItemTarget::Enum),\n-                ModuleDef::Struct(s) => self.collect_lang_item(db, s, LangItemTarget::Struct),\n+                ModuleDef::Adt(Adt::Enum(e)) => self.collect_lang_item(db, e, LangItemTarget::Enum),\n+                ModuleDef::Adt(Adt::Struct(s)) => {\n+                    self.collect_lang_item(db, s, LangItemTarget::Struct)\n+                }\n                 ModuleDef::Function(f) => self.collect_lang_item(db, f, LangItemTarget::Function),\n                 ModuleDef::Static(s) => self.collect_lang_item(db, s, LangItemTarget::Static),\n                 _ => {}"}, {"sha": "508da362315d315f23df3f2921f3c9465e3246e5", "filename": "crates/ra_hir/src/lib.rs", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Flib.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -8,13 +8,20 @@\n //! applied. So, the relation between syntax and HIR is many-to-one.\n \n macro_rules! impl_froms {\n-    ($e:ident: $($v:ident),*) => {\n+    ($e:ident: $($v:ident $(($($sv:ident),*))?),*) => {\n         $(\n             impl From<$v> for $e {\n                 fn from(it: $v) -> $e {\n                     $e::$v(it)\n                 }\n             }\n+            $($(\n+                impl From<$sv> for $e {\n+                    fn from(it: $sv) -> $e {\n+                        $e::$v($v::$sv(it))\n+                    }\n+                }\n+            )*)?\n         )*\n     }\n }\n@@ -57,7 +64,7 @@ use crate::{\n };\n \n pub use self::{\n-    adt::{AdtDef, VariantDef},\n+    adt::VariantDef,\n     either::Either,\n     expr::ExprScopes,\n     generics::{GenericParam, GenericParams, HasGenericParams},\n@@ -78,7 +85,7 @@ pub use self::{\n pub use self::code_model::{\n     docs::{DocDef, Docs, Documentation},\n     src::{HasBodySource, HasSource, Source},\n-    BuiltinType, Const, ConstData, Container, Crate, CrateDependency, DefWithBody, Enum,\n+    Adt, BuiltinType, Const, ConstData, Container, Crate, CrateDependency, DefWithBody, Enum,\n     EnumVariant, FieldSource, FnData, Function, HasBody, MacroDef, Module, ModuleDef, ModuleSource,\n     Static, Struct, StructField, Trait, TypeAlias, Union,\n };"}, {"sha": "3a3bf6b5f70b0981fc82d9ad7c82a141e11f050e", "filename": "crates/ra_hir/src/nameres.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fnameres.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fnameres.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fnameres.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -69,7 +69,8 @@ use crate::{\n     diagnostics::DiagnosticSink,\n     ids::MacroDefId,\n     nameres::diagnostics::DefDiagnostic,\n-    AstId, BuiltinType, Crate, HirFileId, MacroDef, Module, ModuleDef, Name, Path, PathKind, Trait,\n+    Adt, AstId, BuiltinType, Crate, HirFileId, MacroDef, Module, ModuleDef, Name, Path, PathKind,\n+    Trait,\n };\n \n pub(crate) use self::raw::{ImportSourceMap, RawItems};\n@@ -425,7 +426,7 @@ impl CrateDefMap {\n                         }\n                     }\n                 }\n-                ModuleDef::Enum(e) => {\n+                ModuleDef::Adt(Adt::Enum(e)) => {\n                     // enum variant\n                     tested_by!(can_import_enum_variant);\n                     match e.variant(db, &segment.name) {"}, {"sha": "7d2f313c1d4ef7ece51ac9e031feef4b1e4bbfff", "filename": "crates/ra_hir/src/nameres/collector.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fnameres%2Fcollector.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fnameres%2Fcollector.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fnameres%2Fcollector.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -13,7 +13,7 @@ use crate::{\n         raw, Crate, CrateDefMap, CrateModuleId, ModuleData, ModuleDef, PerNs, ReachedFixedPoint,\n         Resolution, ResolveMode,\n     },\n-    AstId, Const, Enum, Function, HirFileId, MacroDef, Module, Name, Path, PathKind, Static,\n+    Adt, AstId, Const, Enum, Function, HirFileId, MacroDef, Module, Name, Path, PathKind, Static,\n     Struct, Trait, TypeAlias, Union,\n };\n \n@@ -314,7 +314,7 @@ where\n                             .push((module_id, import_id));\n                     }\n                 }\n-                Some(ModuleDef::Enum(e)) => {\n+                Some(ModuleDef::Adt(Adt::Enum(e))) => {\n                     tested_by!(glob_enum);\n                     // glob import from enum => just import all the variants\n                     let variants = e.variants(self.db);"}, {"sha": "a77a9aeb19af4db6dd5f720f4d75341b9d85f0f2", "filename": "crates/ra_hir/src/resolve.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fresolve.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fresolve.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fresolve.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -15,7 +15,7 @@ use crate::{\n     name::{Name, SELF_PARAM, SELF_TYPE},\n     nameres::{CrateDefMap, CrateModuleId, PerNs},\n     path::Path,\n-    Enum, MacroDef, ModuleDef, Struct, Trait,\n+    Adt, Enum, MacroDef, ModuleDef, Struct, Trait,\n };\n \n #[derive(Debug, Clone, Default)]\n@@ -143,7 +143,7 @@ impl Resolver {\n     ) -> Option<Struct> {\n         let res = self.resolve_path_segments(db, path).into_fully_resolved().take_types()?;\n         match res {\n-            Resolution::Def(ModuleDef::Struct(it)) => Some(it),\n+            Resolution::Def(ModuleDef::Adt(Adt::Struct(it))) => Some(it),\n             _ => None,\n         }\n     }\n@@ -152,7 +152,7 @@ impl Resolver {\n     pub(crate) fn resolve_known_enum(&self, db: &impl HirDatabase, path: &Path) -> Option<Enum> {\n         let res = self.resolve_path_segments(db, path).into_fully_resolved().take_types()?;\n         match res {\n-            Resolution::Def(ModuleDef::Enum(it)) => Some(it),\n+            Resolution::Def(ModuleDef::Adt(Adt::Enum(it))) => Some(it),\n             _ => None,\n         }\n     }"}, {"sha": "375850b92ee08a2e871b04c8183a45f814a2dabd", "filename": "crates/ra_hir/src/ty.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -16,7 +16,7 @@ use std::ops::Deref;\n use std::sync::Arc;\n use std::{fmt, mem};\n \n-use crate::{db::HirDatabase, type_ref::Mutability, AdtDef, GenericParams, Name, Trait, TypeAlias};\n+use crate::{db::HirDatabase, type_ref::Mutability, Adt, GenericParams, Name, Trait, TypeAlias};\n use display::{HirDisplay, HirFormatter};\n \n pub(crate) use autoderef::autoderef;\n@@ -47,7 +47,7 @@ pub enum TypeCtor {\n     Float(primitive::UncertainFloatTy),\n \n     /// Structures, enumerations and unions.\n-    Adt(AdtDef),\n+    Adt(Adt),\n \n     /// The pointee of a string slice. Written as `str`.\n     Str,\n@@ -458,7 +458,7 @@ impl Ty {\n         }\n     }\n \n-    pub fn as_adt(&self) -> Option<(AdtDef, &Substs)> {\n+    pub fn as_adt(&self) -> Option<(Adt, &Substs)> {\n         match self {\n             Ty::Apply(ApplicationTy { ctor: TypeCtor::Adt(adt_def), parameters }) => {\n                 Some((*adt_def, parameters))\n@@ -726,9 +726,9 @@ impl HirDisplay for ApplicationTy {\n             }\n             TypeCtor::Adt(def_id) => {\n                 let name = match def_id {\n-                    AdtDef::Struct(s) => s.name(f.db),\n-                    AdtDef::Union(u) => u.name(f.db),\n-                    AdtDef::Enum(e) => e.name(f.db),\n+                    Adt::Struct(s) => s.name(f.db),\n+                    Adt::Union(u) => u.name(f.db),\n+                    Adt::Enum(e) => e.name(f.db),\n                 }\n                 .unwrap_or_else(Name::missing);\n                 write!(f, \"{}\", name)?;"}, {"sha": "540a99b152b1289645875ffec50c2bca8201d01d", "filename": "crates/ra_hir/src/ty/infer.rs", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fty%2Finfer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fty%2Finfer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Finfer.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -48,7 +48,7 @@ use crate::{\n     resolve::{Resolution, Resolver},\n     ty::infer::diagnostics::InferenceDiagnostic,\n     type_ref::{Mutability, TypeRef},\n-    AdtDef, ConstData, DefWithBody, FnData, Function, HasBody, ImplItem, ModuleDef, Name, Path,\n+    Adt, ConstData, DefWithBody, FnData, Function, HasBody, ImplItem, ModuleDef, Name, Path,\n     StructField,\n };\n \n@@ -668,7 +668,7 @@ impl<'a, D: HirDatabase> InferenceContext<'a, D> {\n         // FIXME remove the duplication between here and `Ty::from_path`?\n         let substs = Ty::substs_from_path(self.db, resolver, path, def);\n         match def {\n-            TypableDef::Struct(s) => {\n+            TypableDef::Adt(Adt::Struct(s)) => {\n                 let ty = s.ty(self.db);\n                 let ty = self.insert_type_vars(ty.apply_substs(substs));\n                 (ty, Some(s.into()))\n@@ -678,10 +678,10 @@ impl<'a, D: HirDatabase> InferenceContext<'a, D> {\n                 let ty = self.insert_type_vars(ty.apply_substs(substs));\n                 (ty, Some(var.into()))\n             }\n-            TypableDef::Union(_)\n+            TypableDef::Adt(Adt::Enum(_))\n+            | TypableDef::Adt(Adt::Union(_))\n             | TypableDef::TypeAlias(_)\n             | TypableDef::Function(_)\n-            | TypableDef::Enum(_)\n             | TypableDef::Const(_)\n             | TypableDef::Static(_)\n             | TypableDef::BuiltinType(_) => (Ty::Unknown, None),\n@@ -1185,7 +1185,7 @@ impl<'a, D: HirDatabase> InferenceContext<'a, D> {\n                             let i = name.to_string().parse::<usize>().ok();\n                             i.and_then(|i| a_ty.parameters.0.get(i).cloned())\n                         }\n-                        TypeCtor::Adt(AdtDef::Struct(s)) => s.field(self.db, name).map(|field| {\n+                        TypeCtor::Adt(Adt::Struct(s)) => s.field(self.db, name).map(|field| {\n                             self.write_field_resolution(tgt_expr, field);\n                             field.ty(self.db).subst(&a_ty.parameters)\n                         }),\n@@ -1489,7 +1489,7 @@ impl<'a, D: HirDatabase> InferenceContext<'a, D> {\n         trait_.associated_type_by_name(self.db, &name::OUTPUT)\n     }\n \n-    fn resolve_boxed_box(&self) -> Option<AdtDef> {\n+    fn resolve_boxed_box(&self) -> Option<Adt> {\n         let boxed_box_path = Path {\n             kind: PathKind::Abs,\n             segments: vec![\n@@ -1499,7 +1499,7 @@ impl<'a, D: HirDatabase> InferenceContext<'a, D> {\n             ],\n         };\n         let struct_ = self.resolver.resolve_known_struct(self.db, &boxed_box_path)?;\n-        Some(AdtDef::Struct(struct_))\n+        Some(Adt::Struct(struct_))\n     }\n }\n "}, {"sha": "946e9e9fb848bd73639fc901fd1b7676383f024d", "filename": "crates/ra_hir/src/ty/lower.rs", "status": "modified", "additions": 11, "deletions": 23, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fty%2Flower.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_hir%2Fsrc%2Fty%2Flower.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Flower.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -20,7 +20,7 @@ use crate::{\n     nameres::Namespace,\n     path::{GenericArg, PathSegment},\n     resolve::{Resolution, Resolver},\n-    ty::AdtDef,\n+    ty::Adt,\n     type_ref::{TypeBound, TypeRef},\n     BuiltinType, Const, Enum, EnumVariant, Function, ModuleDef, Path, Static, Struct, StructField,\n     Trait, TypeAlias, Union,\n@@ -172,9 +172,7 @@ impl Ty {\n     ) -> Substs {\n         let def_generic: Option<GenericDef> = match resolved {\n             TypableDef::Function(func) => Some(func.into()),\n-            TypableDef::Struct(s) => Some(s.into()),\n-            TypableDef::Union(u) => Some(u.into()),\n-            TypableDef::Enum(e) => Some(e.into()),\n+            TypableDef::Adt(adt) => Some(adt.into()),\n             TypableDef::EnumVariant(var) => Some(var.parent_enum(db).into()),\n             TypableDef::TypeAlias(t) => Some(t.into()),\n             TypableDef::Const(_) | TypableDef::Static(_) | TypableDef::BuiltinType(_) => None,\n@@ -193,9 +191,7 @@ impl Ty {\n         let last = path.segments.last().expect(\"path should have at least one segment\");\n         let segment = match resolved {\n             TypableDef::Function(_)\n-            | TypableDef::Struct(_)\n-            | TypableDef::Union(_)\n-            | TypableDef::Enum(_)\n+            | TypableDef::Adt(_)\n             | TypableDef::Const(_)\n             | TypableDef::Static(_)\n             | TypableDef::TypeAlias(_)\n@@ -410,20 +406,18 @@ fn assoc_type_bindings_from_type_bound<'a>(\n pub(crate) fn type_for_def(db: &impl HirDatabase, def: TypableDef, ns: Namespace) -> Ty {\n     match (def, ns) {\n         (TypableDef::Function(f), Namespace::Values) => type_for_fn(db, f),\n-        (TypableDef::Struct(s), Namespace::Types) => type_for_adt(db, s),\n-        (TypableDef::Struct(s), Namespace::Values) => type_for_struct_constructor(db, s),\n-        (TypableDef::Enum(e), Namespace::Types) => type_for_adt(db, e),\n+        (TypableDef::Adt(Adt::Struct(s)), Namespace::Values) => type_for_struct_constructor(db, s),\n+        (TypableDef::Adt(adt), Namespace::Types) => type_for_adt(db, adt),\n         (TypableDef::EnumVariant(v), Namespace::Values) => type_for_enum_variant_constructor(db, v),\n-        (TypableDef::Union(u), Namespace::Types) => type_for_adt(db, u),\n         (TypableDef::TypeAlias(t), Namespace::Types) => type_for_type_alias(db, t),\n         (TypableDef::Const(c), Namespace::Values) => type_for_const(db, c),\n         (TypableDef::Static(c), Namespace::Values) => type_for_static(db, c),\n         (TypableDef::BuiltinType(t), Namespace::Types) => type_for_builtin(t),\n \n         // 'error' cases:\n         (TypableDef::Function(_), Namespace::Types) => Ty::Unknown,\n-        (TypableDef::Union(_), Namespace::Values) => Ty::Unknown,\n-        (TypableDef::Enum(_), Namespace::Values) => Ty::Unknown,\n+        (TypableDef::Adt(Adt::Union(_)), Namespace::Values) => Ty::Unknown,\n+        (TypableDef::Adt(Adt::Enum(_)), Namespace::Values) => Ty::Unknown,\n         (TypableDef::EnumVariant(_), Namespace::Types) => Ty::Unknown,\n         (TypableDef::TypeAlias(_), Namespace::Values) => Ty::Unknown,\n         (TypableDef::Const(_), Namespace::Types) => Ty::Unknown,\n@@ -591,7 +585,7 @@ fn type_for_enum_variant_constructor(db: &impl HirDatabase, def: EnumVariant) ->\n     Ty::apply(TypeCtor::FnDef(def.into()), substs)\n }\n \n-fn type_for_adt(db: &impl HirDatabase, adt: impl Into<AdtDef> + HasGenericParams) -> Ty {\n+fn type_for_adt(db: &impl HirDatabase, adt: impl Into<Adt> + HasGenericParams) -> Ty {\n     let generics = adt.generic_params(db);\n     Ty::apply(TypeCtor::Adt(adt.into()), Substs::identity(&generics))\n }\n@@ -608,9 +602,7 @@ fn type_for_type_alias(db: &impl HirDatabase, t: TypeAlias) -> Ty {\n #[derive(Clone, Copy, Debug, PartialEq, Eq, Hash)]\n pub enum TypableDef {\n     Function(Function),\n-    Struct(Struct),\n-    Union(Union),\n-    Enum(Enum),\n+    Adt(Adt),\n     EnumVariant(EnumVariant),\n     TypeAlias(TypeAlias),\n     Const(Const),\n@@ -619,9 +611,7 @@ pub enum TypableDef {\n }\n impl_froms!(\n     TypableDef: Function,\n-    Struct,\n-    Union,\n-    Enum,\n+    Adt(Struct, Enum, Union),\n     EnumVariant,\n     TypeAlias,\n     Const,\n@@ -633,9 +623,7 @@ impl From<ModuleDef> for Option<TypableDef> {\n     fn from(def: ModuleDef) -> Option<TypableDef> {\n         let res = match def {\n             ModuleDef::Function(f) => f.into(),\n-            ModuleDef::Struct(s) => s.into(),\n-            ModuleDef::Union(u) => u.into(),\n-            ModuleDef::Enum(e) => e.into(),\n+            ModuleDef::Adt(adt) => adt.into(),\n             ModuleDef::EnumVariant(v) => v.into(),\n             ModuleDef::TypeAlias(t) => t.into(),\n             ModuleDef::Const(v) => v.into(),"}, {"sha": "9e64c86590c9b837416433f2227f9365824a4d6d", "filename": "crates/ra_ide_api/src/completion/complete_dot.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_dot.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_dot.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_dot.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -1,4 +1,4 @@\n-use hir::{AdtDef, Ty, TypeCtor};\n+use hir::{Adt, Ty, TypeCtor};\n \n use crate::completion::completion_item::CompletionKind;\n use crate::{\n@@ -37,7 +37,7 @@ fn complete_fields(acc: &mut Completions, ctx: &CompletionContext, receiver: Ty)\n     for receiver in ctx.analyzer.autoderef(ctx.db, receiver) {\n         if let Ty::Apply(a_ty) = receiver {\n             match a_ty.ctor {\n-                TypeCtor::Adt(AdtDef::Struct(s)) => {\n+                TypeCtor::Adt(Adt::Struct(s)) => {\n                     for field in s.fields(ctx.db) {\n                         acc.add_field(ctx, field, &a_ty.parameters);\n                     }"}, {"sha": "4d3414f33babec45acfe42521b5c568343f1e197", "filename": "crates/ra_ide_api/src/completion/complete_path.rs", "status": "modified", "additions": 4, "deletions": 9, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_path.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_path.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_path.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -1,4 +1,4 @@\n-use hir::{Either, Resolution};\n+use hir::{Adt, Either, Resolution};\n use ra_syntax::AstNode;\n use test_utils::tested_by;\n \n@@ -37,19 +37,14 @@ pub(super) fn complete_path(acc: &mut Completions, ctx: &CompletionContext) {\n                 acc.add_resolution(ctx, name.to_string(), &res.def.map(hir::Resolution::Def));\n             }\n         }\n-        hir::ModuleDef::Enum(_)\n-        | hir::ModuleDef::Struct(_)\n-        | hir::ModuleDef::Union(_)\n-        | hir::ModuleDef::TypeAlias(_) => {\n-            if let hir::ModuleDef::Enum(e) = def {\n+        hir::ModuleDef::Adt(_) | hir::ModuleDef::TypeAlias(_) => {\n+            if let hir::ModuleDef::Adt(Adt::Enum(e)) = def {\n                 for variant in e.variants(ctx.db) {\n                     acc.add_enum_variant(ctx, variant);\n                 }\n             }\n             let ty = match def {\n-                hir::ModuleDef::Enum(e) => e.ty(ctx.db),\n-                hir::ModuleDef::Struct(s) => s.ty(ctx.db),\n-                hir::ModuleDef::Union(u) => u.ty(ctx.db),\n+                hir::ModuleDef::Adt(adt) => adt.ty(ctx.db),\n                 hir::ModuleDef::TypeAlias(a) => a.ty(ctx.db),\n                 _ => unreachable!(),\n             };"}, {"sha": "fb7f9feb8ceca3988347e60fb2af64f4d410c493", "filename": "crates/ra_ide_api/src/completion/complete_pattern.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_pattern.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_pattern.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_pattern.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -15,7 +15,7 @@ pub(super) fn complete_pattern(acc: &mut Completions, ctx: &CompletionContext) {\n             _ => continue,\n         };\n         match def {\n-            hir::ModuleDef::Enum(..)\n+            hir::ModuleDef::Adt(hir::Adt::Enum(..))\n             | hir::ModuleDef::EnumVariant(..)\n             | hir::ModuleDef::Const(..)\n             | hir::ModuleDef::Module(..) => (),"}, {"sha": "95bbd34b71a9b7e14d2556d13088d2eb52c59920", "filename": "crates/ra_ide_api/src/completion/presentation.rs", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fpresentation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fpresentation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fpresentation.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -67,9 +67,13 @@ impl Completions {\n             Resolution::Def(Function(func)) => {\n                 return self.add_function_with_name(ctx, Some(local_name), *func);\n             }\n-            Resolution::Def(Struct(it)) => (CompletionItemKind::Struct, it.docs(ctx.db)),\n-            Resolution::Def(Union(it)) => (CompletionItemKind::Struct, it.docs(ctx.db)),\n-            Resolution::Def(Enum(it)) => (CompletionItemKind::Enum, it.docs(ctx.db)),\n+            Resolution::Def(Adt(hir::Adt::Struct(it))) => {\n+                (CompletionItemKind::Struct, it.docs(ctx.db))\n+            }\n+            Resolution::Def(Adt(hir::Adt::Union(it))) => {\n+                (CompletionItemKind::Struct, it.docs(ctx.db))\n+            }\n+            Resolution::Def(Adt(hir::Adt::Enum(it))) => (CompletionItemKind::Enum, it.docs(ctx.db)),\n             Resolution::Def(EnumVariant(it)) => (CompletionItemKind::EnumVariant, it.docs(ctx.db)),\n             Resolution::Def(Const(it)) => (CompletionItemKind::Const, it.docs(ctx.db)),\n             Resolution::Def(Static(it)) => (CompletionItemKind::Static, it.docs(ctx.db)),"}, {"sha": "03382ab3cba9c437aeda0bb386218baf87b8eaf3", "filename": "crates/ra_ide_api/src/display/navigation_target.rs", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fdisplay%2Fnavigation_target.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fdisplay%2Fnavigation_target.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fdisplay%2Fnavigation_target.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -178,11 +178,11 @@ impl NavigationTarget {\n         )\n     }\n \n-    pub(crate) fn from_adt_def(db: &RootDatabase, adt_def: hir::AdtDef) -> NavigationTarget {\n+    pub(crate) fn from_adt_def(db: &RootDatabase, adt_def: hir::Adt) -> NavigationTarget {\n         match adt_def {\n-            hir::AdtDef::Struct(it) => NavigationTarget::from_def_source(db, it),\n-            hir::AdtDef::Union(it) => NavigationTarget::from_def_source(db, it),\n-            hir::AdtDef::Enum(it) => NavigationTarget::from_def_source(db, it),\n+            hir::Adt::Struct(it) => NavigationTarget::from_def_source(db, it),\n+            hir::Adt::Union(it) => NavigationTarget::from_def_source(db, it),\n+            hir::Adt::Enum(it) => NavigationTarget::from_def_source(db, it),\n         }\n     }\n \n@@ -193,9 +193,7 @@ impl NavigationTarget {\n         let nav = match module_def {\n             hir::ModuleDef::Module(module) => NavigationTarget::from_module(db, module),\n             hir::ModuleDef::Function(func) => NavigationTarget::from_def_source(db, func),\n-            hir::ModuleDef::Struct(it) => NavigationTarget::from_adt_def(db, it.into()),\n-            hir::ModuleDef::Enum(it) => NavigationTarget::from_adt_def(db, it.into()),\n-            hir::ModuleDef::Union(it) => NavigationTarget::from_adt_def(db, it.into()),\n+            hir::ModuleDef::Adt(it) => NavigationTarget::from_adt_def(db, it),\n             hir::ModuleDef::Const(it) => NavigationTarget::from_def_source(db, it),\n             hir::ModuleDef::Static(it) => NavigationTarget::from_def_source(db, it),\n             hir::ModuleDef::EnumVariant(it) => NavigationTarget::from_def_source(db, it),"}, {"sha": "28a6bef12d4fb5c02c7c7ffff98fb55b08578593", "filename": "crates/ra_ide_api/src/hover.rs", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fhover.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fhover.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fhover.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -1,4 +1,4 @@\n-use hir::{HasSource, HirDisplay};\n+use hir::{Adt, HasSource, HirDisplay};\n use ra_db::SourceDatabase;\n use ra_syntax::{\n     algo::{\n@@ -129,9 +129,9 @@ pub(crate) fn hover(db: &RootDatabase, position: FilePosition) -> Option<RangeIn\n                         }\n                     }\n                     hir::ModuleDef::Function(it) => res.extend(from_def_source(db, it)),\n-                    hir::ModuleDef::Struct(it) => res.extend(from_def_source(db, it)),\n-                    hir::ModuleDef::Union(it) => res.extend(from_def_source(db, it)),\n-                    hir::ModuleDef::Enum(it) => res.extend(from_def_source(db, it)),\n+                    hir::ModuleDef::Adt(Adt::Struct(it)) => res.extend(from_def_source(db, it)),\n+                    hir::ModuleDef::Adt(Adt::Union(it)) => res.extend(from_def_source(db, it)),\n+                    hir::ModuleDef::Adt(Adt::Enum(it)) => res.extend(from_def_source(db, it)),\n                     hir::ModuleDef::EnumVariant(it) => res.extend(from_def_source(db, it)),\n                     hir::ModuleDef::Const(it) => res.extend(from_def_source(db, it)),\n                     hir::ModuleDef::Static(it) => res.extend(from_def_source(db, it)),\n@@ -145,9 +145,9 @@ pub(crate) fn hover(db: &RootDatabase, position: FilePosition) -> Option<RangeIn\n             Some(SelfType(ty)) => {\n                 if let Some((adt_def, _)) = ty.as_adt() {\n                     res.extend(match adt_def {\n-                        hir::AdtDef::Struct(it) => from_def_source(db, it),\n-                        hir::AdtDef::Union(it) => from_def_source(db, it),\n-                        hir::AdtDef::Enum(it) => from_def_source(db, it),\n+                        hir::Adt::Struct(it) => from_def_source(db, it),\n+                        hir::Adt::Union(it) => from_def_source(db, it),\n+                        hir::Adt::Enum(it) => from_def_source(db, it),\n                     })\n                 }\n             }"}, {"sha": "6c2a7b260b4e51314b795edce14f5ccdf1b52f0d", "filename": "crates/ra_ide_api/src/name_ref_kind.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fname_ref_kind.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fname_ref_kind.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fname_ref_kind.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -60,7 +60,7 @@ pub(crate) fn classify_name_ref(\n         let record_lit = field_expr.syntax().ancestors().find_map(ast::RecordLit::cast);\n \n         if let Some(ty) = record_lit.and_then(|lit| analyzer.type_of(db, &lit.into())) {\n-            if let Some((hir::AdtDef::Struct(s), _)) = ty.as_adt() {\n+            if let Some((hir::Adt::Struct(s), _)) = ty.as_adt() {\n                 let hir_path = hir::Path::from_name_ref(name_ref);\n                 let hir_name = hir_path.as_ident().unwrap();\n "}, {"sha": "86ab3a26056e80c12268ae9ce0b8577f9a4ea0c0", "filename": "crates/ra_ide_api/src/syntax_highlighting.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fsyntax_highlighting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1adf0519bcc8286c06e12aa7e5b16298addfea4a/crates%2Fra_ide_api%2Fsrc%2Fsyntax_highlighting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fsyntax_highlighting.rs?ref=1adf0519bcc8286c06e12aa7e5b16298addfea4a", "patch": "@@ -107,9 +107,7 @@ pub(crate) fn highlight(db: &RootDatabase, file_id: FileId) -> Vec<HighlightedRa\n                         Some(AssocItem(hir::ImplItem::TypeAlias(_))) => \"type\",\n                         Some(Def(hir::ModuleDef::Module(_))) => \"module\",\n                         Some(Def(hir::ModuleDef::Function(_))) => \"function\",\n-                        Some(Def(hir::ModuleDef::Struct(_))) => \"type\",\n-                        Some(Def(hir::ModuleDef::Union(_))) => \"type\",\n-                        Some(Def(hir::ModuleDef::Enum(_))) => \"type\",\n+                        Some(Def(hir::ModuleDef::Adt(_))) => \"type\",\n                         Some(Def(hir::ModuleDef::EnumVariant(_))) => \"constant\",\n                         Some(Def(hir::ModuleDef::Const(_))) => \"constant\",\n                         Some(Def(hir::ModuleDef::Static(_))) => \"constant\","}]}