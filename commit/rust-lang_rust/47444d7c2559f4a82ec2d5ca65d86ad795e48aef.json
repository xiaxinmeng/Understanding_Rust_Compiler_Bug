{"sha": "47444d7c2559f4a82ec2d5ca65d86ad795e48aef", "node_id": "C_kwDOAAsO6NoAKDQ3NDQ0ZDdjMjU1OWY0YTgyZWMyZDVjYTY1ZDg2YWQ3OTVlNDhhZWY", "commit": {"author": {"name": "Erik Desjardins", "email": "erikdesjardins@users.noreply.github.com", "date": "2023-05-20T21:54:31Z"}, "committer": {"name": "Erik Desjardins", "email": "erikdesjardins@users.noreply.github.com", "date": "2023-05-20T22:12:54Z"}, "message": "improve code checking for drop_in_place lang item", "tree": {"sha": "6cedf9ce3daaa323b961d9e4b6438c16e164f288", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6cedf9ce3daaa323b961d9e4b6438c16e164f288"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/47444d7c2559f4a82ec2d5ca65d86ad795e48aef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/47444d7c2559f4a82ec2d5ca65d86ad795e48aef", "html_url": "https://github.com/rust-lang/rust/commit/47444d7c2559f4a82ec2d5ca65d86ad795e48aef", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/47444d7c2559f4a82ec2d5ca65d86ad795e48aef/comments", "author": {"login": "erikdesjardins", "id": 7673145, "node_id": "MDQ6VXNlcjc2NzMxNDU=", "avatar_url": "https://avatars.githubusercontent.com/u/7673145?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erikdesjardins", "html_url": "https://github.com/erikdesjardins", "followers_url": "https://api.github.com/users/erikdesjardins/followers", "following_url": "https://api.github.com/users/erikdesjardins/following{/other_user}", "gists_url": "https://api.github.com/users/erikdesjardins/gists{/gist_id}", "starred_url": "https://api.github.com/users/erikdesjardins/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erikdesjardins/subscriptions", "organizations_url": "https://api.github.com/users/erikdesjardins/orgs", "repos_url": "https://api.github.com/users/erikdesjardins/repos", "events_url": "https://api.github.com/users/erikdesjardins/events{/privacy}", "received_events_url": "https://api.github.com/users/erikdesjardins/received_events", "type": "User", "site_admin": false}, "committer": {"login": "erikdesjardins", "id": 7673145, "node_id": "MDQ6VXNlcjc2NzMxNDU=", "avatar_url": "https://avatars.githubusercontent.com/u/7673145?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erikdesjardins", "html_url": "https://github.com/erikdesjardins", "followers_url": "https://api.github.com/users/erikdesjardins/followers", "following_url": "https://api.github.com/users/erikdesjardins/following{/other_user}", "gists_url": "https://api.github.com/users/erikdesjardins/gists{/gist_id}", "starred_url": "https://api.github.com/users/erikdesjardins/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erikdesjardins/subscriptions", "organizations_url": "https://api.github.com/users/erikdesjardins/orgs", "repos_url": "https://api.github.com/users/erikdesjardins/repos", "events_url": "https://api.github.com/users/erikdesjardins/events{/privacy}", "received_events_url": "https://api.github.com/users/erikdesjardins/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "58c39999499b3bb8966387c47699ac694bbd7a1c", "url": "https://api.github.com/repos/rust-lang/rust/commits/58c39999499b3bb8966387c47699ac694bbd7a1c", "html_url": "https://github.com/rust-lang/rust/commit/58c39999499b3bb8966387c47699ac694bbd7a1c"}], "stats": {"total": 6, "additions": 2, "deletions": 4}, "files": [{"sha": "b7d4d90f1093074e95f27acfa02b2e5217de4c49", "filename": "compiler/rustc_ty_utils/src/abi.rs", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/47444d7c2559f4a82ec2d5ca65d86ad795e48aef/compiler%2Frustc_ty_utils%2Fsrc%2Fabi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/47444d7c2559f4a82ec2d5ca65d86ad795e48aef/compiler%2Frustc_ty_utils%2Fsrc%2Fabi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ty_utils%2Fsrc%2Fabi.rs?ref=47444d7c2559f4a82ec2d5ca65d86ad795e48aef", "patch": "@@ -375,10 +375,8 @@ fn fn_abi_new_uncached<'tcx>(\n     use SpecAbi::*;\n     let rust_abi = matches!(sig.abi, RustIntrinsic | PlatformIntrinsic | Rust | RustCall);\n \n-    let is_drop_in_place = match (cx.tcx.lang_items().drop_in_place_fn(), fn_def_id) {\n-        (Some(drop_in_place_fn), Some(fn_def_id)) => drop_in_place_fn == fn_def_id,\n-        _ => false,\n-    };\n+    let is_drop_in_place =\n+        fn_def_id.is_some() && fn_def_id == cx.tcx.lang_items().drop_in_place_fn();\n \n     let arg_of = |ty: Ty<'tcx>, arg_idx: Option<usize>| -> Result<_, FnAbiError<'tcx>> {\n         let span = tracing::debug_span!(\"arg_of\");"}]}