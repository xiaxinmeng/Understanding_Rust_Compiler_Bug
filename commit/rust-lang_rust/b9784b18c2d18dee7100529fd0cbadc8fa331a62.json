{"sha": "b9784b18c2d18dee7100529fd0cbadc8fa331a62", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI5Nzg0YjE4YzJkMThkZWU3MTAwNTI5ZmQwY2JhZGM4ZmEzMzFhNjI=", "commit": {"author": {"name": "Nikita Popov", "email": "nikita.ppv@gmail.com", "date": "2019-07-20T10:12:12Z"}, "committer": {"name": "Nikita Popov", "email": "nikita.ppv@gmail.com", "date": "2019-07-20T15:17:48Z"}, "message": "Don't link mcjit/interpreter LLVM components", "tree": {"sha": "0840cb8756a0ee887eff7f9b89821233667fb26f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0840cb8756a0ee887eff7f9b89821233667fb26f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b9784b18c2d18dee7100529fd0cbadc8fa331a62", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b9784b18c2d18dee7100529fd0cbadc8fa331a62", "html_url": "https://github.com/rust-lang/rust/commit/b9784b18c2d18dee7100529fd0cbadc8fa331a62", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b9784b18c2d18dee7100529fd0cbadc8fa331a62/comments", "author": {"login": "nikic", "id": 216080, "node_id": "MDQ6VXNlcjIxNjA4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/216080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikic", "html_url": "https://github.com/nikic", "followers_url": "https://api.github.com/users/nikic/followers", "following_url": "https://api.github.com/users/nikic/following{/other_user}", "gists_url": "https://api.github.com/users/nikic/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikic/subscriptions", "organizations_url": "https://api.github.com/users/nikic/orgs", "repos_url": "https://api.github.com/users/nikic/repos", "events_url": "https://api.github.com/users/nikic/events{/privacy}", "received_events_url": "https://api.github.com/users/nikic/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikic", "id": 216080, "node_id": "MDQ6VXNlcjIxNjA4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/216080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikic", "html_url": "https://github.com/nikic", "followers_url": "https://api.github.com/users/nikic/followers", "following_url": "https://api.github.com/users/nikic/following{/other_user}", "gists_url": "https://api.github.com/users/nikic/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikic/subscriptions", "organizations_url": "https://api.github.com/users/nikic/orgs", "repos_url": "https://api.github.com/users/nikic/repos", "events_url": "https://api.github.com/users/nikic/events{/privacy}", "received_events_url": "https://api.github.com/users/nikic/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f69b07144a151f46aaee1b6230ba4160e9394562", "url": "https://api.github.com/repos/rust-lang/rust/commits/f69b07144a151f46aaee1b6230ba4160e9394562", "html_url": "https://github.com/rust-lang/rust/commit/f69b07144a151f46aaee1b6230ba4160e9394562"}], "stats": {"total": 19, "additions": 3, "deletions": 16}, "files": [{"sha": "3def2d8232f63e2bbc1496bfc32b165380187462", "filename": "src/librustc_llvm/build.rs", "status": "modified", "additions": 3, "deletions": 10, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/b9784b18c2d18dee7100529fd0cbadc8fa331a62/src%2Flibrustc_llvm%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b9784b18c2d18dee7100529fd0cbadc8fa331a62/src%2Flibrustc_llvm%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_llvm%2Fbuild.rs?ref=b9784b18c2d18dee7100529fd0cbadc8fa331a62", "patch": "@@ -71,7 +71,8 @@ fn main() {\n \n     let mut optional_components =\n         vec![\"x86\", \"arm\", \"aarch64\", \"amdgpu\", \"mips\", \"powerpc\",\n-             \"systemz\", \"jsbackend\", \"webassembly\", \"msp430\", \"sparc\", \"nvptx\"];\n+             \"systemz\", \"jsbackend\", \"webassembly\", \"msp430\", \"sparc\", \"nvptx\",\n+             \"hexagon\"];\n \n     let mut version_cmd = Command::new(&llvm_config);\n     version_cmd.arg(\"--version\");\n@@ -82,27 +83,19 @@ fn main() {\n         if let (Some(major), Some(minor)) = (parts.next(), parts.next()) {\n             (major, minor)\n         } else {\n-            (3, 9)\n+            (6, 0)\n         };\n \n-    if major > 3 {\n-        optional_components.push(\"hexagon\");\n-    }\n-\n     if major > 6 {\n         optional_components.push(\"riscv\");\n     }\n \n-    // FIXME: surely we don't need all these components, right? Stuff like mcjit\n-    //        or interpreter the compiler itself never uses.\n     let required_components = &[\"ipo\",\n                                 \"bitreader\",\n                                 \"bitwriter\",\n                                 \"linker\",\n                                 \"asmparser\",\n-                                \"mcjit\",\n                                 \"lto\",\n-                                \"interpreter\",\n                                 \"instrumentation\"];\n \n     let components = output(Command::new(&llvm_config).arg(\"--components\"));"}, {"sha": "0cda3465dc0930dff71451bed2873465884ea93f", "filename": "src/rustllvm/PassWrapper.cpp", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b9784b18c2d18dee7100529fd0cbadc8fa331a62/src%2Frustllvm%2FPassWrapper.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/b9784b18c2d18dee7100529fd0cbadc8fa331a62/src%2Frustllvm%2FPassWrapper.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2FPassWrapper.cpp?ref=b9784b18c2d18dee7100529fd0cbadc8fa331a62", "patch": "@@ -26,8 +26,6 @@\n using namespace llvm;\n using namespace llvm::legacy;\n \n-extern cl::opt<bool> EnableARMEHABI;\n-\n typedef struct LLVMOpaquePass *LLVMPassRef;\n typedef struct LLVMOpaqueTargetMachine *LLVMTargetMachineRef;\n "}, {"sha": "c3f0d174d4b411cbed5c8323fd29611dc35e3e06", "filename": "src/rustllvm/rustllvm.h", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b9784b18c2d18dee7100529fd0cbadc8fa331a62/src%2Frustllvm%2Frustllvm.h", "raw_url": "https://github.com/rust-lang/rust/raw/b9784b18c2d18dee7100529fd0cbadc8fa331a62/src%2Frustllvm%2Frustllvm.h", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2Frustllvm.h?ref=b9784b18c2d18dee7100529fd0cbadc8fa331a62", "patch": "@@ -1,15 +1,11 @@\n #include \"llvm-c/BitReader.h\"\n #include \"llvm-c/Core.h\"\n-#include \"llvm-c/ExecutionEngine.h\"\n #include \"llvm-c/Object.h\"\n #include \"llvm/ADT/ArrayRef.h\"\n #include \"llvm/ADT/DenseSet.h\"\n #include \"llvm/ADT/Triple.h\"\n #include \"llvm/Analysis/Lint.h\"\n #include \"llvm/Analysis/Passes.h\"\n-#include \"llvm/ExecutionEngine/ExecutionEngine.h\"\n-#include \"llvm/ExecutionEngine/Interpreter.h\"\n-#include \"llvm/ExecutionEngine/MCJIT.h\"\n #include \"llvm/IR/IRBuilder.h\"\n #include \"llvm/IR/InlineAsm.h\"\n #include \"llvm/IR/LLVMContext.h\""}]}