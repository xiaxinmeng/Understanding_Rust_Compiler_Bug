{"sha": "ca0aefa8bfbd1f1906f6aa7bba430c1765d2345f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNhMGFlZmE4YmZiZDFmMTkwNmY2YWE3YmJhNDMwYzE3NjVkMjM0NWY=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-01-27T06:45:28Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-01-27T06:54:16Z"}, "message": "rustdoc: Add resource arg tys to doc tree", "tree": {"sha": "bac35a55656ea7d2106a5e043fe90b54ad809b40", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bac35a55656ea7d2106a5e043fe90b54ad809b40"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ca0aefa8bfbd1f1906f6aa7bba430c1765d2345f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ca0aefa8bfbd1f1906f6aa7bba430c1765d2345f", "html_url": "https://github.com/rust-lang/rust/commit/ca0aefa8bfbd1f1906f6aa7bba430c1765d2345f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ca0aefa8bfbd1f1906f6aa7bba430c1765d2345f/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e51ae2331704e2ad55d0bdae8fd57c55ac012dca", "url": "https://api.github.com/repos/rust-lang/rust/commits/e51ae2331704e2ad55d0bdae8fd57c55ac012dca", "html_url": "https://github.com/rust-lang/rust/commit/e51ae2331704e2ad55d0bdae8fd57c55ac012dca"}], "stats": {"total": 43, "additions": 42, "deletions": 1}, "files": [{"sha": "f705f2b591578198f8202290674b54cc9d8c5071", "filename": "src/rustdoc/demo.rs", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/ca0aefa8bfbd1f1906f6aa7bba430c1765d2345f/src%2Frustdoc%2Fdemo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca0aefa8bfbd1f1906f6aa7bba430c1765d2345f/src%2Frustdoc%2Fdemo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Fdemo.rs?ref=ca0aefa8bfbd1f1906f6aa7bba430c1765d2345f", "patch": "@@ -70,3 +70,32 @@ mod blade_runner {\n                 Alien 3 was crap though.\"\n     )];\n }\n+\n+#[doc(\n+    brief = \"Bored\",\n+    desc = \"\n+\n+    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed nec\n+    molestie nisl. Duis massa risus, pharetra a scelerisque a,\n+    molestie eu velit. Donec mattis ligula at ante imperdiet ut\n+    dapibus mauris malesuada. Sed gravida nisi a metus elementum sit\n+    amet hendrerit dolor bibendum. Aenean sit amet neque massa, sed\n+    tempus tortor. Sed ut lobortis enim. Proin a mauris quis nunc\n+    fermentum ultrices eget a erat. Mauris in lectus vitae metus\n+    sodales auctor. Morbi nunc quam, ultricies at venenatis non,\n+    pellentesque ac dui.\n+\n+    Quisque vitae est id eros placerat laoreet sit amet eu\n+    nisi. Curabitur suscipit neque porttitor est euismod\n+    lacinia. Curabitur non quam vitae ipsum adipiscing\n+    condimentum. Mauris ut ante eget metus sollicitudin\n+    blandit. Aliquam erat volutpat. Morbi sed nisl mauris. Nulla\n+    facilisi. Phasellus at mollis ipsum. Maecenas sed convallis\n+    sapien. Nullam in ligula turpis. Pellentesque a neque augue. Sed\n+    eget ante feugiat tortor congue auctor ac quis ante. Proin\n+    condimentum lacinia tincidunt.\n+\n+\")]\n+resource bored(bored: bool) {\n+    log(error, bored);\n+}\n\\ No newline at end of file"}, {"sha": "12a1e68b42bb399b61de9ebb1b2d3bc1257ce87f", "filename": "src/rustdoc/tystr_pass.rs", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/ca0aefa8bfbd1f1906f6aa7bba430c1765d2345f/src%2Frustdoc%2Ftystr_pass.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca0aefa8bfbd1f1906f6aa7bba430c1765d2345f/src%2Frustdoc%2Ftystr_pass.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Ftystr_pass.rs?ref=ca0aefa8bfbd1f1906f6aa7bba430c1765d2345f", "patch": "@@ -134,6 +134,9 @@ fn get_arg_tys(srv: astsrv::srv, fn_id: doc::ast_id) -> [(str, str)] {\n         alt ctxt.ast_map.get(fn_id) {\n           ast_map::node_item(@{\n             node: ast::item_fn(decl, _, _), _\n+          }) |\n+          ast_map::node_item(@{\n+            node: ast::item_res(decl, _, _, _, _), _\n           }) {\n             vec::map(decl.inputs) {|arg|\n                 (arg.ident, pprust::ty_to_str(arg.ty))\n@@ -231,6 +234,7 @@ fn fold_res(\n     let srv = fold.ctxt;\n \n     ~{\n+        args: merge_arg_tys(srv, doc.id, doc.args),\n         sig: some(astsrv::exec(srv) {|ctxt|\n             alt ctxt.ast_map.get(doc.id) {\n               ast_map::node_item(@{\n@@ -250,6 +254,14 @@ fn should_add_resource_sigs() {\n     let srv = astsrv::mk_srv_from_str(source);\n     let doc = extract::from_srv(srv, \"\");\n     let doc = run(srv, doc);\n-    log(error, doc.topmod.resources[0].sig);\n     assert doc.topmod.resources[0].sig == some(\"resource r(b: bool)\");\n }\n+\n+#[test]\n+fn should_add_resource_arg_tys() {\n+    let source = \"resource r(a: bool) { }\";\n+    let srv = astsrv::mk_srv_from_str(source);\n+    let doc = extract::from_srv(srv, \"\");\n+    let doc = run(srv, doc);\n+    assert doc.topmod.resources[0].args[0].ty == some(\"bool\");\n+}\n\\ No newline at end of file"}]}