{"sha": "2c946bc303d3a3cbc8f3eb17976dc94d9e4c71a7", "node_id": "C_kwDOAAsO6NoAKDJjOTQ2YmMzMDNkM2EzY2JjOGYzZWIxNzk3NmRjOTRkOWU0YzcxYTc", "commit": {"author": {"name": "Yuki Okushi", "email": "huyuumi.dev+love@gmail.com", "date": "2023-01-11T05:18:58Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-01-11T05:18:58Z"}, "message": "Rollup merge of #106689 - GuillaumeGomez:rustdoc-gui-files-array, r=notriddle\n\nFix invalid files array re-creation in rustdoc-gui tester\n\nIt fixes the error <code>expected `runTest` first argument to be a string</code>:\n\n```\n{\n  file_name: {\n    file_name: '/home/imperio/rust/rust/src/test/rustdoc-gui/type-declation-overflow.goml',\n    output: 'type-declation-overflow... FAILED\\n' +\n      '...'\n  },\n  output: Error: expected `runTest` first argument to be a string\n      at runTest (/home/imperio/rust/rust/node_modules/browser-ui-test/src/index.js:591:15)\n      at runTests (/home/imperio/rust/rust/src/tools/rustdoc-gui/tester.js:144:26)\n      at main (/home/imperio/rust/rust/src/tools/rustdoc-gui/tester.js:278:15)\n} Error: expected `runTest` first argument to be a string\n    at runTest (/home/imperio/rust/rust/node_modules/browser-ui-test/src/index.js:591:15)\n    at runTests (/home/imperio/rust/rust/src/tools/rustdoc-gui/tester.js:144:26)\n    at main (/home/imperio/rust/rust/src/tools/rustdoc-gui/tester.js:278:15)\n```\n\nThe problem was that I concatenated two arrays of object whereas `files` is supposed to be an array of string.\n\nr? `@notriddle`", "tree": {"sha": "e964c8db9c2800bc119fcc6c46f3e1d8935638e8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e964c8db9c2800bc119fcc6c46f3e1d8935638e8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2c946bc303d3a3cbc8f3eb17976dc94d9e4c71a7", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjvkbCCRBK7hj4Ov3rIwAA4qYIACj8Z471jbB+sByhzG5k8kw8\nN+ORmu6GYLfmT2afI4sf4DGIVEcXShJ08tLBgnxb1S9kggpIbEUOza+FAhlrwtd0\nWUGdFgcPHW+DvNvcIX80dF7qZMKqZOFrCVk6UTFvjqbO1YmeTCoROZo0YkVezDGh\nurcHgC7d+CORCPWPB9YGZO7K2lvGHYCo+crvXT0Zc+RErGq7n5yygvSpSRQgMFxD\nILTk+Je5ljBUFVLFLRiNxuHLdWHIea7jJTzSO4yPEOx5BdJuNLObJ8qa+6XfO6Io\nu6gPlFYfkzC6qX7OOpfVKcvQuFaKejFPWzIVL+A9dkCMRuEznCbOXWDVyNTwezk=\n=jvir\n-----END PGP SIGNATURE-----\n", "payload": "tree e964c8db9c2800bc119fcc6c46f3e1d8935638e8\nparent c2d1cac36bba4f10071f9a5baddefb5925374a9a\nparent 2214c6d194d668efe6b1ee000a150372110c114b\nauthor Yuki Okushi <huyuumi.dev+love@gmail.com> 1673414338 +0900\ncommitter GitHub <noreply@github.com> 1673414338 +0900\n\nRollup merge of #106689 - GuillaumeGomez:rustdoc-gui-files-array, r=notriddle\n\nFix invalid files array re-creation in rustdoc-gui tester\n\nIt fixes the error <code>expected `runTest` first argument to be a string</code>:\n\n```\n{\n  file_name: {\n    file_name: '/home/imperio/rust/rust/src/test/rustdoc-gui/type-declation-overflow.goml',\n    output: 'type-declation-overflow... FAILED\\n' +\n      '...'\n  },\n  output: Error: expected `runTest` first argument to be a string\n      at runTest (/home/imperio/rust/rust/node_modules/browser-ui-test/src/index.js:591:15)\n      at runTests (/home/imperio/rust/rust/src/tools/rustdoc-gui/tester.js:144:26)\n      at main (/home/imperio/rust/rust/src/tools/rustdoc-gui/tester.js:278:15)\n} Error: expected `runTest` first argument to be a string\n    at runTest (/home/imperio/rust/rust/node_modules/browser-ui-test/src/index.js:591:15)\n    at runTests (/home/imperio/rust/rust/src/tools/rustdoc-gui/tester.js:144:26)\n    at main (/home/imperio/rust/rust/src/tools/rustdoc-gui/tester.js:278:15)\n```\n\nThe problem was that I concatenated two arrays of object whereas `files` is supposed to be an array of string.\n\nr? `@notriddle`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2c946bc303d3a3cbc8f3eb17976dc94d9e4c71a7", "html_url": "https://github.com/rust-lang/rust/commit/2c946bc303d3a3cbc8f3eb17976dc94d9e4c71a7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2c946bc303d3a3cbc8f3eb17976dc94d9e4c71a7/comments", "author": null, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c2d1cac36bba4f10071f9a5baddefb5925374a9a", "url": "https://api.github.com/repos/rust-lang/rust/commits/c2d1cac36bba4f10071f9a5baddefb5925374a9a", "html_url": "https://github.com/rust-lang/rust/commit/c2d1cac36bba4f10071f9a5baddefb5925374a9a"}, {"sha": "2214c6d194d668efe6b1ee000a150372110c114b", "url": "https://api.github.com/repos/rust-lang/rust/commits/2214c6d194d668efe6b1ee000a150372110c114b", "html_url": "https://github.com/rust-lang/rust/commit/2214c6d194d668efe6b1ee000a150372110c114b"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "554b2f81fa3bbfa5a748edc7860c98d225fb61a9", "filename": "src/tools/rustdoc-gui/tester.js", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/2c946bc303d3a3cbc8f3eb17976dc94d9e4c71a7/src%2Ftools%2Frustdoc-gui%2Ftester.js", "raw_url": "https://github.com/rust-lang/rust/raw/2c946bc303d3a3cbc8f3eb17976dc94d9e4c71a7/src%2Ftools%2Frustdoc-gui%2Ftester.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustdoc-gui%2Ftester.js?ref=2c946bc303d3a3cbc8f3eb17976dc94d9e4c71a7", "patch": "@@ -278,7 +278,8 @@ async function main(argv) {\n         await runTests(opts, framework_options, files, new_results, status_bar, it + 1 >= NB_RETRY);\n         Array.prototype.push.apply(results.successful, new_results.successful);\n         // We generate the new list of files with the previously failing tests.\n-        files = Array.prototype.concat(new_results.failed, new_results.errored);\n+        files = Array.prototype.concat(new_results.failed, new_results.errored).map(\n+            f => f['file_name']);\n         if (files.length > originalFilesLen / 2) {\n             // If we have too many failing tests, it's very likely not flaky failures anymore so\n             // no need to retry."}]}