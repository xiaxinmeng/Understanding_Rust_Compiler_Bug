{"sha": "d1e84c615c31be8fa6ca40fddaabc5ed30910efa", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQxZTg0YzYxNWMzMWJlOGZhNmNhNDBmZGRhYWJjNWVkMzA5MTBlZmE=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-04-16T18:26:55Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-04-16T18:32:54Z"}, "message": "Add run-rustfix for deref_addrof lint\n\n* renames `tests/ui/reference.{rs,stderr}` to\n  `tests/ui/deref_addrof.{rs,stderr}\n* Moves small part of the testfile to a separate file as the lint\n  triggered again on the fixed code (as intended)\n* Adds `// run-rustfix` to `tests/ui/deref_addrof.rs`", "tree": {"sha": "8a87efd18d120437f924a6960dbfd0fc6bbe8405", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8a87efd18d120437f924a6960dbfd0fc6bbe8405"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d1e84c615c31be8fa6ca40fddaabc5ed30910efa", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJEBAABCgAuFiEEj4U0bmbiMSg/mWqvgqphyqETl+YFAly2H9gQHGRldkBwaGFu\nc2NoLm5ldAAKCRCCqmHKoROX5pCtD/44JFBCWWZ5DIyb1FkIkP5o6Uy0Sg87XNeW\neznjNjG1rAv6eac70UHBftmS1wo8v6P/ATFiHUgQ/gh4eXyt8lK2vS15NyqyYYtH\ntIhgvBPkUFPACTLvNiLK4L5/8eow9q5p0NOFXzwCEhEH3OiJ7X1ML99pEN0i1T3w\nUJ6h8udo9hTLpswmhHTz5NZ1ubtkZgq+KjqfVzzHR0tfEh4zrxy9xMxfDxL6dD5Z\nf0lFDQS5UfZ+6FUlupujPHW0QUAUI/jS9i107TAEKWK+L43mOIbrzjfKnE1Js61B\n8nbsWdiGeVT5xPddIExGGEbsUKEU3pzGLwLU0p6xxjpL8bNucGCMQXvdxqmVmWIA\nu+dsHlRO5ZGqHEYCm7EhCvBr577AeJEb5VT3PrYQ55l/3YpqiKnTMdj+StriJ66T\njH0Ho/2tRZ3+R741e4Jq9Bh4Qx18wD9Co09vG5lqZ71smRI4wUs07Mkdr3IufNIM\nfPTE4zStoaMy8EXJmeL0nwOSy1uAojc8oHahJkN7Zbhs4yM+8+drl7rHOQpyRbmm\nAB/hJSvc+npdfu0w8ddC4TaDzsBOvzJ1uCdiEEWT6qKFbhEE7jP43vQikaaU2o4c\niOl4nk/xiNjo7MPBXaOKxPSWmJfAYJbejft/57dNm+1FqD+XQOD8tUeiEpcAzNqk\npQ/DxDGMuA==\n=nlyO\n-----END PGP SIGNATURE-----", "payload": "tree 8a87efd18d120437f924a6960dbfd0fc6bbe8405\nparent d516925ec8ff4d39e32830442959fad16407e87e\nauthor Philipp Hansch <dev@phansch.net> 1555439215 +0200\ncommitter Philipp Hansch <dev@phansch.net> 1555439574 +0200\n\nAdd run-rustfix for deref_addrof lint\n\n* renames `tests/ui/reference.{rs,stderr}` to\n  `tests/ui/deref_addrof.{rs,stderr}\n* Moves small part of the testfile to a separate file as the lint\n  triggered again on the fixed code (as intended)\n* Adds `// run-rustfix` to `tests/ui/deref_addrof.rs`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d1e84c615c31be8fa6ca40fddaabc5ed30910efa", "html_url": "https://github.com/rust-lang/rust/commit/d1e84c615c31be8fa6ca40fddaabc5ed30910efa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d1e84c615c31be8fa6ca40fddaabc5ed30910efa/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d516925ec8ff4d39e32830442959fad16407e87e", "url": "https://api.github.com/repos/rust-lang/rust/commits/d516925ec8ff4d39e32830442959fad16407e87e", "html_url": "https://github.com/rust-lang/rust/commit/d516925ec8ff4d39e32830442959fad16407e87e"}], "stats": {"total": 138, "additions": 94, "deletions": 44}, "files": [{"sha": "9e5b51d6d5e6d5da7344e0bdc33bacb163882010", "filename": "tests/ui/deref_addrof.fixed", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/d1e84c615c31be8fa6ca40fddaabc5ed30910efa/tests%2Fui%2Fderef_addrof.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/d1e84c615c31be8fa6ca40fddaabc5ed30910efa/tests%2Fui%2Fderef_addrof.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fderef_addrof.fixed?ref=d1e84c615c31be8fa6ca40fddaabc5ed30910efa", "patch": "@@ -0,0 +1,39 @@\n+// run-rustfix\n+\n+fn get_number() -> usize {\n+    10\n+}\n+\n+fn get_reference(n: &usize) -> &usize {\n+    n\n+}\n+\n+#[allow(clippy::many_single_char_names, clippy::double_parens)]\n+#[allow(unused_variables, unused_parens)]\n+#[warn(clippy::deref_addrof)]\n+fn main() {\n+    let a = 10;\n+    let aref = &a;\n+\n+    let b = a;\n+\n+    let b = get_number();\n+\n+    let b = *get_reference(&a);\n+\n+    let bytes: Vec<usize> = vec![1, 2, 3, 4];\n+    let b = bytes[1..2][0];\n+\n+    //This produces a suggestion of 'let b = (a);' which\n+    //will trigger the 'unused_parens' lint\n+    let b = (a);\n+\n+    let b = a;\n+\n+    #[rustfmt::skip]\n+    let b = a;\n+\n+    let b = &a;\n+\n+    let b = *aref;\n+}"}, {"sha": "5641a73cbc1cb1b73e766dbbfb8de1d515a12e6d", "filename": "tests/ui/deref_addrof.rs", "status": "renamed", "additions": 3, "deletions": 17, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/d1e84c615c31be8fa6ca40fddaabc5ed30910efa/tests%2Fui%2Fderef_addrof.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d1e84c615c31be8fa6ca40fddaabc5ed30910efa/tests%2Fui%2Fderef_addrof.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fderef_addrof.rs?ref=d1e84c615c31be8fa6ca40fddaabc5ed30910efa", "patch": "@@ -1,3 +1,5 @@\n+// run-rustfix\n+\n fn get_number() -> usize {\n     10\n }\n@@ -7,7 +9,7 @@ fn get_reference(n: &usize) -> &usize {\n }\n \n #[allow(clippy::many_single_char_names, clippy::double_parens)]\n-#[allow(unused_variables)]\n+#[allow(unused_variables, unused_parens)]\n #[warn(clippy::deref_addrof)]\n fn main() {\n     let a = 10;\n@@ -34,20 +36,4 @@ fn main() {\n     let b = *&&a;\n \n     let b = **&aref;\n-\n-    //This produces a suggestion of 'let b = *&a;' which\n-    //will trigger the 'clippy::deref_addrof' lint again\n-    let b = **&&a;\n-\n-    {\n-        let mut x = 10;\n-        let y = *&mut x;\n-    }\n-\n-    {\n-        //This produces a suggestion of 'let y = *&mut x' which\n-        //will trigger the 'clippy::deref_addrof' lint again\n-        let mut x = 10;\n-        let y = **&mut &mut x;\n-    }\n }", "previous_filename": "tests/ui/reference.rs"}, {"sha": "bc51719e8a7a0e6bb9dfd4a4c4137208b59e8891", "filename": "tests/ui/deref_addrof.stderr", "status": "renamed", "additions": 9, "deletions": 27, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/d1e84c615c31be8fa6ca40fddaabc5ed30910efa/tests%2Fui%2Fderef_addrof.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d1e84c615c31be8fa6ca40fddaabc5ed30910efa/tests%2Fui%2Fderef_addrof.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fderef_addrof.stderr?ref=d1e84c615c31be8fa6ca40fddaabc5ed30910efa", "patch": "@@ -1,70 +1,52 @@\n error: immediately dereferencing a reference\n-  --> $DIR/reference.rs:16:13\n+  --> $DIR/deref_addrof.rs:18:13\n    |\n LL |     let b = *&a;\n    |             ^^^ help: try this: `a`\n    |\n    = note: `-D clippy::deref-addrof` implied by `-D warnings`\n \n error: immediately dereferencing a reference\n-  --> $DIR/reference.rs:18:13\n+  --> $DIR/deref_addrof.rs:20:13\n    |\n LL |     let b = *&get_number();\n    |             ^^^^^^^^^^^^^^ help: try this: `get_number()`\n \n error: immediately dereferencing a reference\n-  --> $DIR/reference.rs:23:13\n+  --> $DIR/deref_addrof.rs:25:13\n    |\n LL |     let b = *&bytes[1..2][0];\n    |             ^^^^^^^^^^^^^^^^ help: try this: `bytes[1..2][0]`\n \n error: immediately dereferencing a reference\n-  --> $DIR/reference.rs:27:13\n+  --> $DIR/deref_addrof.rs:29:13\n    |\n LL |     let b = *&(a);\n    |             ^^^^^ help: try this: `(a)`\n \n error: immediately dereferencing a reference\n-  --> $DIR/reference.rs:29:13\n+  --> $DIR/deref_addrof.rs:31:13\n    |\n LL |     let b = *(&a);\n    |             ^^^^^ help: try this: `a`\n \n error: immediately dereferencing a reference\n-  --> $DIR/reference.rs:32:13\n+  --> $DIR/deref_addrof.rs:34:13\n    |\n LL |     let b = *((&a));\n    |             ^^^^^^^ help: try this: `a`\n \n error: immediately dereferencing a reference\n-  --> $DIR/reference.rs:34:13\n+  --> $DIR/deref_addrof.rs:36:13\n    |\n LL |     let b = *&&a;\n    |             ^^^^ help: try this: `&a`\n \n error: immediately dereferencing a reference\n-  --> $DIR/reference.rs:36:14\n+  --> $DIR/deref_addrof.rs:38:14\n    |\n LL |     let b = **&aref;\n    |              ^^^^^^ help: try this: `aref`\n \n-error: immediately dereferencing a reference\n-  --> $DIR/reference.rs:40:14\n-   |\n-LL |     let b = **&&a;\n-   |              ^^^^ help: try this: `&a`\n-\n-error: immediately dereferencing a reference\n-  --> $DIR/reference.rs:44:17\n-   |\n-LL |         let y = *&mut x;\n-   |                 ^^^^^^^ help: try this: `x`\n-\n-error: immediately dereferencing a reference\n-  --> $DIR/reference.rs:51:18\n-   |\n-LL |         let y = **&mut &mut x;\n-   |                  ^^^^^^^^^^^^ help: try this: `&mut x`\n-\n-error: aborting due to 11 previous errors\n+error: aborting due to 8 previous errors\n ", "previous_filename": "tests/ui/reference.stderr"}, {"sha": "e19af5b9087faabb1d3753dabfafca40959bcbaf", "filename": "tests/ui/deref_addrof_double_trigger.rs", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/d1e84c615c31be8fa6ca40fddaabc5ed30910efa/tests%2Fui%2Fderef_addrof_double_trigger.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d1e84c615c31be8fa6ca40fddaabc5ed30910efa/tests%2Fui%2Fderef_addrof_double_trigger.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fderef_addrof_double_trigger.rs?ref=d1e84c615c31be8fa6ca40fddaabc5ed30910efa", "patch": "@@ -0,0 +1,21 @@\n+#[warn(clippy::deref_addrof)]\n+#[allow(unused_variables)]\n+fn main() {\n+    let a = 10;\n+\n+    //This produces a suggestion of 'let b = *&a;' which\n+    //will trigger the 'clippy::deref_addrof' lint again\n+    let b = **&&a;\n+\n+    {\n+        let mut x = 10;\n+        let y = *&mut x;\n+    }\n+\n+    {\n+        //This produces a suggestion of 'let y = *&mut x' which\n+        //will trigger the 'clippy::deref_addrof' lint again\n+        let mut x = 10;\n+        let y = **&mut &mut x;\n+    }\n+}"}, {"sha": "89284e1a8ed68847c2adc9c5f71cfad13b4c7772", "filename": "tests/ui/deref_addrof_double_trigger.stderr", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/d1e84c615c31be8fa6ca40fddaabc5ed30910efa/tests%2Fui%2Fderef_addrof_double_trigger.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d1e84c615c31be8fa6ca40fddaabc5ed30910efa/tests%2Fui%2Fderef_addrof_double_trigger.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fderef_addrof_double_trigger.stderr?ref=d1e84c615c31be8fa6ca40fddaabc5ed30910efa", "patch": "@@ -0,0 +1,22 @@\n+error: immediately dereferencing a reference\n+  --> $DIR/deref_addrof_double_trigger.rs:8:14\n+   |\n+LL |     let b = **&&a;\n+   |              ^^^^ help: try this: `&a`\n+   |\n+   = note: `-D clippy::deref-addrof` implied by `-D warnings`\n+\n+error: immediately dereferencing a reference\n+  --> $DIR/deref_addrof_double_trigger.rs:12:17\n+   |\n+LL |         let y = *&mut x;\n+   |                 ^^^^^^^ help: try this: `x`\n+\n+error: immediately dereferencing a reference\n+  --> $DIR/deref_addrof_double_trigger.rs:19:18\n+   |\n+LL |         let y = **&mut &mut x;\n+   |                  ^^^^^^^^^^^^ help: try this: `&mut x`\n+\n+error: aborting due to 3 previous errors\n+"}]}