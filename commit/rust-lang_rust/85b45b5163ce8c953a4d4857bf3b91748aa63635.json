{"sha": "85b45b5163ce8c953a4d4857bf3b91748aa63635", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg1YjQ1YjUxNjNjZThjOTUzYTRkNDg1N2JmM2I5MTc0OGFhNjM2MzU=", "commit": {"author": {"name": "Dylan DPC", "email": "dylan.dpc@gmail.com", "date": "2021-05-23T01:23:47Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-05-23T01:23:47Z"}, "message": "Rollup merge of #85575 - jsha:fix-toggle-settings, r=GuillaumeGomez\n\nFix auto-hide for implementations and implementors.\n\nThis sets their toggles to be closed in the HTML (matching the default\nsetting), and opens them if the setting indicates to do so.\n\nThis distinguishes between implementations and implementors based on\nbeing descendants of certain named elements.\n\nDemo https://hoffman-andrews.com/rust/fix-toggle-settings/std/io/trait.Read.html#implementors\nand https://hoffman-andrews.com/rust/fix-toggle-settings/std/string/struct.String.html#trait-implementations\n\nFixes #85411\n\nr? `@GuillaumeGomez`", "tree": {"sha": "78b04e67a165bfb802b9576f9eb15d8846022777", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/78b04e67a165bfb802b9576f9eb15d8846022777"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/85b45b5163ce8c953a4d4857bf3b91748aa63635", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgqa6kCRBK7hj4Ov3rIwAACp8IAKR5rLkmZ99W6SI3l/aggxWO\nQpLv4BJpuBS/nVC51sVsCwp3J34Ik7uluwUaqvW54CuHiLYfftj5DdcY/Etc04ME\nGAgcml7NeR1Fsksq2b02BtxlBSXRoGDd5ldUa4zKhsEyY5bps0V7wGhShrfLj38o\ni5ITRviZSH0GYHVqeKYz22CrRUhYiArbUL7QXPHu9WsTeu/U7EuCLIeafsSi++kC\njjkK5ETUap+LHa0nNFIWq+bon8bUzSVtu3yP1xZVhaZJTltxsdkYATB9WVHA0Ryy\n3ljU1Mybg0nuKgoDth8Q6LriC2lcZVYqN1s/EJjk5m8IesVUUWHxV3ETPHeZ9J0=\n=esrc\n-----END PGP SIGNATURE-----\n", "payload": "tree 78b04e67a165bfb802b9576f9eb15d8846022777\nparent 75edb7693769d96c9fc76ff61ea9882f81d2b7e7\nparent 5ebbed6cb02fb4d0272a0b86c500d8f668de321d\nauthor Dylan DPC <dylan.dpc@gmail.com> 1621733027 +0200\ncommitter GitHub <noreply@github.com> 1621733027 +0200\n\nRollup merge of #85575 - jsha:fix-toggle-settings, r=GuillaumeGomez\n\nFix auto-hide for implementations and implementors.\n\nThis sets their toggles to be closed in the HTML (matching the default\nsetting), and opens them if the setting indicates to do so.\n\nThis distinguishes between implementations and implementors based on\nbeing descendants of certain named elements.\n\nDemo https://hoffman-andrews.com/rust/fix-toggle-settings/std/io/trait.Read.html#implementors\nand https://hoffman-andrews.com/rust/fix-toggle-settings/std/string/struct.String.html#trait-implementations\n\nFixes #85411\n\nr? `@GuillaumeGomez`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/85b45b5163ce8c953a4d4857bf3b91748aa63635", "html_url": "https://github.com/rust-lang/rust/commit/85b45b5163ce8c953a4d4857bf3b91748aa63635", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/85b45b5163ce8c953a4d4857bf3b91748aa63635/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "75edb7693769d96c9fc76ff61ea9882f81d2b7e7", "url": "https://api.github.com/repos/rust-lang/rust/commits/75edb7693769d96c9fc76ff61ea9882f81d2b7e7", "html_url": "https://github.com/rust-lang/rust/commit/75edb7693769d96c9fc76ff61ea9882f81d2b7e7"}, {"sha": "5ebbed6cb02fb4d0272a0b86c500d8f668de321d", "url": "https://api.github.com/repos/rust-lang/rust/commits/5ebbed6cb02fb4d0272a0b86c500d8f668de321d", "html_url": "https://github.com/rust-lang/rust/commit/5ebbed6cb02fb4d0272a0b86c500d8f668de321d"}], "stats": {"total": 30, "additions": 24, "deletions": 6}, "files": [{"sha": "b3bd1cd012166397665a99a7711b2527537a5071", "filename": "src/librustdoc/html/render/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/85b45b5163ce8c953a4d4857bf3b91748aa63635/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/85b45b5163ce8c953a4d4857bf3b91748aa63635/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs?ref=85b45b5163ce8c953a4d4857bf3b91748aa63635", "patch": "@@ -1545,7 +1545,7 @@ fn render_impl(\n     let open_details = |close_tags: &mut String| {\n         if toggled {\n             close_tags.insert_str(0, \"</details>\");\n-            \"<details class=\\\"rustdoc-toggle implementors-toggle\\\" open><summary>\"\n+            \"<details class=\\\"rustdoc-toggle implementors-toggle\\\"><summary>\"\n         } else {\n             \"\"\n         }"}, {"sha": "a96b0c871089983e87bae81b6efcdbd423bef91a", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 21, "deletions": 4, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/85b45b5163ce8c953a4d4857bf3b91748aa63635/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/85b45b5163ce8c953a4d4857bf3b91748aa63635/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=85b45b5163ce8c953a4d4857bf3b91748aa63635", "patch": "@@ -776,12 +776,29 @@ function hideThemeButtonState() {\n \n         var hideMethodDocs = getSettingValue(\"auto-hide-method-docs\") === \"true\";\n         var hideImplementors = getSettingValue(\"auto-collapse-implementors\") !== \"false\";\n+        var hideImplementations = getSettingValue(\"auto-hide-trait-implementations\") !== \"false\";\n         var hideLargeItemContents = getSettingValue(\"auto-hide-large-items\") !== \"false\";\n \n-        onEachLazy(document.getElementsByTagName(\"details\"), function (e) {\n-            var showLargeItem = !hideLargeItemContents && hasClass(e, \"type-contents-toggle\");\n-            var showImplementor = !hideImplementors && hasClass(e, \"implementors-toggle\");\n-            if (showLargeItem || showImplementor) {\n+        function openImplementors(id) {\n+            var list = document.getElementById(id);\n+            if (list !== null) {\n+                onEachLazy(list.getElementsByClassName(\"implementors-toggle\"), function(e) {\n+                    e.open = true;\n+                });\n+            }\n+        }\n+\n+        if (!hideImplementations) {\n+            openImplementors(\"trait-implementations-list\");\n+            openImplementors(\"blanket-implementations-list\");\n+        }\n+\n+        if (!hideImplementors) {\n+            openImplementors(\"implementors-list\");\n+        }\n+\n+        onEachLazy(document.getElementsByClassName(\"rustdoc-toggle\"), function (e) {\n+            if (!hideLargeItemContents && hasClass(e, \"type-contents-toggle\")) {\n                 e.open = true;\n             }\n             if (hideMethodDocs && hasClass(e, \"method-toggle\")) {"}, {"sha": "5b448bd1923b00833c05dff88a610a011d0277ed", "filename": "src/test/rustdoc/manual_impl.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/85b45b5163ce8c953a4d4857bf3b91748aa63635/src%2Ftest%2Frustdoc%2Fmanual_impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/85b45b5163ce8c953a4d4857bf3b91748aa63635/src%2Ftest%2Frustdoc%2Fmanual_impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fmanual_impl.rs?ref=85b45b5163ce8c953a4d4857bf3b91748aa63635", "patch": "@@ -65,7 +65,8 @@ impl T for S2 {\n }\n \n // @has manual_impl/struct.S3.html '//*[@class=\"trait\"]' 'T'\n-// @has  - '//details[@open=\"\"]/div[@class=\"docblock\"]' 'Docs associated with the S3 trait implementation.'\n+// @has  - '//details/div[@class=\"docblock\"]' 'Docs associated with the S3 trait implementation.'\n+// @!has  - '//details[@open=\"\"]/div[@class=\"docblock\"]' 'Docs associated with the S3 trait implementation.'\n // @has  - '//details[@open=\"\"]/div[@class=\"docblock\"]' 'Docs associated with the S3 trait b_method implementation.'\n // @!has - '//div[@class=\"impl-items\"]/details[@open=\"\"]//div[@class=\"docblock\"]' 'Docs associated with the trait a_method definition.'\n // @has - '//div[@class=\"impl-items\"]/details//div[@class=\"docblock\"]' 'Docs associated with the trait a_method definition.'"}]}