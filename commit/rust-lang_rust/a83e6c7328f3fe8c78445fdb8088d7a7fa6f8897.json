{"sha": "a83e6c7328f3fe8c78445fdb8088d7a7fa6f8897", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE4M2U2YzczMjhmM2ZlOGM3ODQ0NWZkYjgwODhkN2E3ZmE2Zjg4OTc=", "commit": {"author": {"name": "Joshua M. Clulow", "email": "jmc@oxide.computer", "date": "2020-03-17T06:15:34Z"}, "committer": {"name": "Joshua M. Clulow", "email": "jmc@oxide.computer", "date": "2020-03-17T06:15:34Z"}, "message": "use \"gcc\" instead of \"cc\" on *-sun-solaris systems when linking\n\nOn illumos and Solaris systems, Rust will use GCC as the link editor.\nRust does this by invoking \"cc\", which on many (Linux and perhaps BSD)\nsystems is generally either GCC or a GCC-compatible front-end.  On\nhistorical Solaris systems, \"cc\" was often the Sun Studio compiler.\nThis history casts a long shadow, and as such, even most modern\nillumos-based operating systems tend to install GCC as \"gcc\", without\nalso making it available as \"cc\".\n\nWe should invoke GCC as \"gcc\" on such systems to ensure we get the right\ncompiler driver.", "tree": {"sha": "fd0d915bae0abbb9272bd0f1f570991ddab22753", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fd0d915bae0abbb9272bd0f1f570991ddab22753"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a83e6c7328f3fe8c78445fdb8088d7a7fa6f8897", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a83e6c7328f3fe8c78445fdb8088d7a7fa6f8897", "html_url": "https://github.com/rust-lang/rust/commit/a83e6c7328f3fe8c78445fdb8088d7a7fa6f8897", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a83e6c7328f3fe8c78445fdb8088d7a7fa6f8897/comments", "author": {"login": "jclulow", "id": 304070, "node_id": "MDQ6VXNlcjMwNDA3MA==", "avatar_url": "https://avatars.githubusercontent.com/u/304070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jclulow", "html_url": "https://github.com/jclulow", "followers_url": "https://api.github.com/users/jclulow/followers", "following_url": "https://api.github.com/users/jclulow/following{/other_user}", "gists_url": "https://api.github.com/users/jclulow/gists{/gist_id}", "starred_url": "https://api.github.com/users/jclulow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jclulow/subscriptions", "organizations_url": "https://api.github.com/users/jclulow/orgs", "repos_url": "https://api.github.com/users/jclulow/repos", "events_url": "https://api.github.com/users/jclulow/events{/privacy}", "received_events_url": "https://api.github.com/users/jclulow/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jclulow", "id": 304070, "node_id": "MDQ6VXNlcjMwNDA3MA==", "avatar_url": "https://avatars.githubusercontent.com/u/304070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jclulow", "html_url": "https://github.com/jclulow", "followers_url": "https://api.github.com/users/jclulow/followers", "following_url": "https://api.github.com/users/jclulow/following{/other_user}", "gists_url": "https://api.github.com/users/jclulow/gists{/gist_id}", "starred_url": "https://api.github.com/users/jclulow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jclulow/subscriptions", "organizations_url": "https://api.github.com/users/jclulow/orgs", "repos_url": "https://api.github.com/users/jclulow/repos", "events_url": "https://api.github.com/users/jclulow/events{/privacy}", "received_events_url": "https://api.github.com/users/jclulow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5e9ebf4da3522c479aea9c242cb3686f8d6afa78", "url": "https://api.github.com/repos/rust-lang/rust/commits/5e9ebf4da3522c479aea9c242cb3686f8d6afa78", "html_url": "https://github.com/rust-lang/rust/commit/5e9ebf4da3522c479aea9c242cb3686f8d6afa78"}], "stats": {"total": 8, "additions": 7, "deletions": 1}, "files": [{"sha": "d7081e60bd1fcce09c5e1c0c3d1a4e94d52cd392", "filename": "src/librustc_codegen_ssa/back/link.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/a83e6c7328f3fe8c78445fdb8088d7a7fa6f8897/src%2Flibrustc_codegen_ssa%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a83e6c7328f3fe8c78445fdb8088d7a7fa6f8897/src%2Flibrustc_codegen_ssa%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Fback%2Flink.rs?ref=a83e6c7328f3fe8c78445fdb8088d7a7fa6f8897", "patch": "@@ -839,7 +839,13 @@ pub fn linker_and_flavor(sess: &Session) -> (PathBuf, LinkerFlavor) {\n                             \"emcc\"\n                         }\n                     }\n-                    LinkerFlavor::Gcc => \"cc\",\n+                    LinkerFlavor::Gcc => {\n+                        if cfg!(target_os = \"solaris\") {\n+                            \"gcc\"\n+                        } else {\n+                            \"cc\"\n+                        }\n+                    }\n                     LinkerFlavor::Ld => \"ld\",\n                     LinkerFlavor::Msvc => \"link.exe\",\n                     LinkerFlavor::Lld(_) => \"lld\","}]}