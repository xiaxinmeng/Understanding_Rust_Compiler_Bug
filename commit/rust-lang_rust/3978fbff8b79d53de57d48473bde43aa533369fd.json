{"sha": "3978fbff8b79d53de57d48473bde43aa533369fd", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM5NzhmYmZmOGI3OWQ1M2RlNTdkNDg0NzNiZGU0M2FhNTMzMzY5ZmQ=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-02-03T00:30:22Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-02-03T02:10:24Z"}, "message": "rt: Remove rust_task::can_schedule. Does nothing", "tree": {"sha": "eedd614937b44394cebb2fc51a30b2f65c3d63d0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/eedd614937b44394cebb2fc51a30b2f65c3d63d0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3978fbff8b79d53de57d48473bde43aa533369fd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3978fbff8b79d53de57d48473bde43aa533369fd", "html_url": "https://github.com/rust-lang/rust/commit/3978fbff8b79d53de57d48473bde43aa533369fd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3978fbff8b79d53de57d48473bde43aa533369fd/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ed3a5ad5ad01a7213cecb6361b83d710f8eb4249", "url": "https://api.github.com/repos/rust-lang/rust/commits/ed3a5ad5ad01a7213cecb6361b83d710f8eb4249", "html_url": "https://github.com/rust-lang/rust/commit/ed3a5ad5ad01a7213cecb6361b83d710f8eb4249"}], "stats": {"total": 25, "additions": 5, "deletions": 20}, "files": [{"sha": "508c87d820d7886c3e3b6a570a390fc53b5159e5", "filename": "src/rt/rust_scheduler.cpp", "status": "modified", "additions": 5, "deletions": 13, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/3978fbff8b79d53de57d48473bde43aa533369fd/src%2Frt%2Frust_scheduler.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/3978fbff8b79d53de57d48473bde43aa533369fd/src%2Frt%2Frust_scheduler.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_scheduler.cpp?ref=3978fbff8b79d53de57d48473bde43aa533369fd", "patch": "@@ -135,16 +135,10 @@ rust_scheduler::reap_dead_tasks(int id) {\n     for (size_t i = 0; i < dead_tasks_len; ++i) {\n         rust_task *task = dead_tasks_copy[i];\n         task->lock.lock();\n-        // Make sure this task isn't still running somewhere else...\n-        if (task->can_schedule(id)) {\n-            DLOG(this, task,\n-                \"deleting unreferenced dead task %s @0x%\" PRIxPTR,\n-                task->name, task);\n-            task->lock.unlock();\n-        } else {\n-            task->lock.unlock();\n-            dead_tasks_copy[i] = NULL;\n-        }\n+        DLOG(this, task,\n+             \"deleting unreferenced dead task %s @0x%\" PRIxPTR,\n+             task->name, task);\n+        task->lock.unlock();\n     }\n \n     // Now grab the lock again and remove the tasks that were truly dead\n@@ -192,9 +186,7 @@ rust_scheduler::schedule_task(int id) {\n         // Look around for a runnable task, starting at k.\n         for(size_t j = 0; j < running_tasks.length(); ++j) {\n             size_t  i = (j + k) % running_tasks.length();\n-            if (running_tasks[i]->can_schedule(id)) {\n-                return (rust_task *)running_tasks[i];\n-            }\n+            return (rust_task *)running_tasks[i];\n         }\n     }\n     return NULL;"}, {"sha": "098e9e3c131c943c09e6abeddfaa30bd59d41230", "filename": "src/rt/rust_task.cpp", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/3978fbff8b79d53de57d48473bde43aa533369fd/src%2Frt%2Frust_task.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/3978fbff8b79d53de57d48473bde43aa533369fd/src%2Frt%2Frust_task.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_task.cpp?ref=3978fbff8b79d53de57d48473bde43aa533369fd", "patch": "@@ -623,11 +623,6 @@ rust_task::backtrace() {\n #endif\n }\n \n-bool rust_task::can_schedule(int id)\n-{\n-    return true;\n-}\n-\n void *\n rust_task::calloc(size_t size, const char *tag) {\n     return local_region.calloc(size, tag);"}, {"sha": "c3a53ee4eac8e8113640ecf2a6bbd06c86d53c32", "filename": "src/rt/rust_task.h", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3978fbff8b79d53de57d48473bde43aa533369fd/src%2Frt%2Frust_task.h", "raw_url": "https://github.com/rust-lang/rust/raw/3978fbff8b79d53de57d48473bde43aa533369fd/src%2Frt%2Frust_task.h", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_task.h?ref=3978fbff8b79d53de57d48473bde43aa533369fd", "patch": "@@ -171,8 +171,6 @@ rust_task : public kernel_owned<rust_task>, rust_cond\n     frame_glue_fns *get_frame_glue_fns(uintptr_t fp);\n     rust_crate_cache * get_crate_cache();\n \n-    bool can_schedule(int worker);\n-\n     void *calloc(size_t size, const char *tag);\n \n     rust_port_id register_port(rust_port *port);"}]}