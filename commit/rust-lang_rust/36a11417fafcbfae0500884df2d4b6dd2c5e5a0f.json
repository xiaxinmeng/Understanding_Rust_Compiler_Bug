{"sha": "36a11417fafcbfae0500884df2d4b6dd2c5e5a0f", "node_id": "C_kwDOAAsO6NoAKDM2YTExNDE3ZmFmY2JmYWUwNTAwODg0ZGYyZDRiNmRkMmM1ZTVhMGY", "commit": {"author": {"name": "5225225", "email": "5225225@mailbox.org", "date": "2022-01-09T22:15:23Z"}, "committer": {"name": "5225225", "email": "5225225@mailbox.org", "date": "2022-01-09T23:31:57Z"}, "message": "Make message for &T -> &mut T transmute more accurate", "tree": {"sha": "cc5028df556c92a96758b13b593adac75cc86f34", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cc5028df556c92a96758b13b593adac75cc86f34"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/36a11417fafcbfae0500884df2d4b6dd2c5e5a0f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/36a11417fafcbfae0500884df2d4b6dd2c5e5a0f", "html_url": "https://github.com/rust-lang/rust/commit/36a11417fafcbfae0500884df2d4b6dd2c5e5a0f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/36a11417fafcbfae0500884df2d4b6dd2c5e5a0f/comments", "author": {"login": "5225225", "id": 8584210, "node_id": "MDQ6VXNlcjg1ODQyMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/8584210?v=4", "gravatar_id": "", "url": "https://api.github.com/users/5225225", "html_url": "https://github.com/5225225", "followers_url": "https://api.github.com/users/5225225/followers", "following_url": "https://api.github.com/users/5225225/following{/other_user}", "gists_url": "https://api.github.com/users/5225225/gists{/gist_id}", "starred_url": "https://api.github.com/users/5225225/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/5225225/subscriptions", "organizations_url": "https://api.github.com/users/5225225/orgs", "repos_url": "https://api.github.com/users/5225225/repos", "events_url": "https://api.github.com/users/5225225/events{/privacy}", "received_events_url": "https://api.github.com/users/5225225/received_events", "type": "User", "site_admin": false}, "committer": {"login": "5225225", "id": 8584210, "node_id": "MDQ6VXNlcjg1ODQyMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/8584210?v=4", "gravatar_id": "", "url": "https://api.github.com/users/5225225", "html_url": "https://github.com/5225225", "followers_url": "https://api.github.com/users/5225225/followers", "following_url": "https://api.github.com/users/5225225/following{/other_user}", "gists_url": "https://api.github.com/users/5225225/gists{/gist_id}", "starred_url": "https://api.github.com/users/5225225/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/5225225/subscriptions", "organizations_url": "https://api.github.com/users/5225225/orgs", "repos_url": "https://api.github.com/users/5225225/repos", "events_url": "https://api.github.com/users/5225225/events{/privacy}", "received_events_url": "https://api.github.com/users/5225225/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "092e1c9d23158d81be27bb6f71bdd0c6282478fb", "url": "https://api.github.com/repos/rust-lang/rust/commits/092e1c9d23158d81be27bb6f71bdd0c6282478fb", "html_url": "https://github.com/rust-lang/rust/commit/092e1c9d23158d81be27bb6f71bdd0c6282478fb"}], "stats": {"total": 10, "additions": 5, "deletions": 5}, "files": [{"sha": "2b373a53b635d4c94b637b06b29454a3f5bcd29f", "filename": "compiler/rustc_lint/src/builtin.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/36a11417fafcbfae0500884df2d4b6dd2c5e5a0f/compiler%2Frustc_lint%2Fsrc%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/36a11417fafcbfae0500884df2d4b6dd2c5e5a0f/compiler%2Frustc_lint%2Fsrc%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Fbuiltin.rs?ref=36a11417fafcbfae0500884df2d4b6dd2c5e5a0f", "patch": "@@ -1248,7 +1248,7 @@ declare_lint! {\n     /// [`UnsafeCell`]: https://doc.rust-lang.org/std/cell/struct.UnsafeCell.html\n     MUTABLE_TRANSMUTES,\n     Deny,\n-    \"mutating transmuted &mut T from &T may cause undefined behavior\"\n+    \"transmuting &T to &mut T is undefined behavior, even if the reference is unused\"\n }\n \n declare_lint_pass!(MutableTransmutes => [MUTABLE_TRANSMUTES]);\n@@ -1260,8 +1260,8 @@ impl<'tcx> LateLintPass<'tcx> for MutableTransmutes {\n             get_transmute_from_to(cx, expr).map(|(ty1, ty2)| (ty1.kind(), ty2.kind()))\n         {\n             if to_mt == hir::Mutability::Mut && from_mt == hir::Mutability::Not {\n-                let msg = \"mutating transmuted &mut T from &T may cause undefined behavior, \\\n-                               consider instead using an UnsafeCell\";\n+                let msg = \"transmuting &T to &mut T is undefined behavior, \\\n+                    even if the reference is unused, consider instead using an UnsafeCell\";\n                 cx.struct_span_lint(MUTABLE_TRANSMUTES, expr.span, |lint| lint.build(msg).emit());\n             }\n         }"}, {"sha": "9f3f76c1ef3e0c91452c7d13f458703485e142cc", "filename": "src/test/ui/transmute/transmute-imut-to-mut.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/36a11417fafcbfae0500884df2d4b6dd2c5e5a0f/src%2Ftest%2Fui%2Ftransmute%2Ftransmute-imut-to-mut.rs", "raw_url": "https://github.com/rust-lang/rust/raw/36a11417fafcbfae0500884df2d4b6dd2c5e5a0f/src%2Ftest%2Fui%2Ftransmute%2Ftransmute-imut-to-mut.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftransmute%2Ftransmute-imut-to-mut.rs?ref=36a11417fafcbfae0500884df2d4b6dd2c5e5a0f", "patch": "@@ -4,5 +4,5 @@ use std::mem::transmute;\n \n fn main() {\n     let _a: &mut u8 = unsafe { transmute(&1u8) };\n-    //~^ ERROR mutating transmuted &mut T from &T may cause undefined behavior\n+    //~^ ERROR transmuting &T to &mut T is undefined behavior, even if the reference is unused, consider instead using an UnsafeCell\n }"}, {"sha": "1e9dff3ce89b26071e6db0ccb1c7deec0337e91a", "filename": "src/test/ui/transmute/transmute-imut-to-mut.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/36a11417fafcbfae0500884df2d4b6dd2c5e5a0f/src%2Ftest%2Fui%2Ftransmute%2Ftransmute-imut-to-mut.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/36a11417fafcbfae0500884df2d4b6dd2c5e5a0f/src%2Ftest%2Fui%2Ftransmute%2Ftransmute-imut-to-mut.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftransmute%2Ftransmute-imut-to-mut.stderr?ref=36a11417fafcbfae0500884df2d4b6dd2c5e5a0f", "patch": "@@ -1,4 +1,4 @@\n-error: mutating transmuted &mut T from &T may cause undefined behavior, consider instead using an UnsafeCell\n+error: transmuting &T to &mut T is undefined behavior, even if the reference is unused, consider instead using an UnsafeCell\n   --> $DIR/transmute-imut-to-mut.rs:6:32\n    |\n LL |     let _a: &mut u8 = unsafe { transmute(&1u8) };"}]}