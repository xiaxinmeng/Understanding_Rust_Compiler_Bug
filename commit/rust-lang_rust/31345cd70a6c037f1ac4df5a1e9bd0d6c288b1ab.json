{"sha": "31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab", "node_id": "C_kwDOAAsO6NoAKDMxMzQ1Y2Q3MGE2YzAzN2YxYWM0ZGY1YTFlOWJkMGQ2YzI4OGIxYWI", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-02-08T06:13:27Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-02-08T06:13:27Z"}, "message": "Rollup merge of #107771 - estebank:ice-msg, r=compiler-errors\n\nTweak ICE message\n\nModify main message to be more conversational and emit one fewer note.", "tree": {"sha": "bb1021d287b7c44cba3670037306cdab70777a70", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bb1021d287b7c44cba3670037306cdab70777a70"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJj4z2HCRBK7hj4Ov3rIwAAy4sIACpr34KfU2l+SyEh7OieYbpF\n12Y68odMY9xnemfFf1DrzB+An2KEgL/Humwru8g85t04QbgA9uvibFgLIDo7cLIS\nDLC+IhQnB5x1Hofqk58CgrwCwjOW7TId60u+Yv9Ie/WBuM4Lk0mP4oAXF/Oh9O3c\npRo+X3qW4g2JFf4yff1ONff6mo0CgpTEjWxxiTGZqXPFD6F9L2cBIBFmXAroiZL+\niWeAwLkj9UHFuhKBfNi5zQAkc33AD50fwi5Lix3XB0tiaQ6iNswSQtRTPyU7ReED\nSf9b6hkqalETb7xdH1yTarracebNNbp30rVL/RD5Uu93BeP3gAxvjLKxDPc1QC0=\n=fMq4\n-----END PGP SIGNATURE-----\n", "payload": "tree bb1021d287b7c44cba3670037306cdab70777a70\nparent 86cc4141f78f094ff639c76fe3c8ab72f64def26\nparent a7597a15265df589b29ed3c61a3047994fc45d0a\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1675836807 +0100\ncommitter GitHub <noreply@github.com> 1675836807 +0100\n\nRollup merge of #107771 - estebank:ice-msg, r=compiler-errors\n\nTweak ICE message\n\nModify main message to be more conversational and emit one fewer note.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab", "html_url": "https://github.com/rust-lang/rust/commit/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "86cc4141f78f094ff639c76fe3c8ab72f64def26", "url": "https://api.github.com/repos/rust-lang/rust/commits/86cc4141f78f094ff639c76fe3c8ab72f64def26", "html_url": "https://github.com/rust-lang/rust/commit/86cc4141f78f094ff639c76fe3c8ab72f64def26"}, {"sha": "a7597a15265df589b29ed3c61a3047994fc45d0a", "url": "https://api.github.com/repos/rust-lang/rust/commits/a7597a15265df589b29ed3c61a3047994fc45d0a", "html_url": "https://github.com/rust-lang/rust/commit/a7597a15265df589b29ed3c61a3047994fc45d0a"}], "stats": {"total": 25, "additions": 9, "deletions": 16}, "files": [{"sha": "a392d70f100a4826ddc9e6227c7c20bcabbdbccc", "filename": "compiler/rustc_driver_impl/src/lib.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/compiler%2Frustc_driver_impl%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/compiler%2Frustc_driver_impl%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_driver_impl%2Fsrc%2Flib.rs?ref=31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab", "patch": "@@ -1200,11 +1200,9 @@ pub fn report_ice(info: &panic::PanicInfo<'_>, bug_report_url: &str) {\n     if !info.payload().is::<rustc_errors::ExplicitBug>()\n         && !info.payload().is::<rustc_errors::DelayedBugPanic>()\n     {\n-        let mut d = rustc_errors::Diagnostic::new(rustc_errors::Level::Bug, \"unexpected panic\");\n-        handler.emit_diagnostic(&mut d);\n+        handler.emit_err(session_diagnostics::Ice);\n     }\n \n-    handler.emit_note(session_diagnostics::Ice);\n     handler.emit_note(session_diagnostics::IceBugReport { bug_report_url });\n     handler.emit_note(session_diagnostics::IceVersion {\n         version: util::version_str!().unwrap_or(\"unknown_version\"),"}, {"sha": "81f28c1755deb452976804391ac6d6b5f9ce0d0b", "filename": "tests/ui/consts/const-eval/const-eval-query-stack.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-query-stack.rs", "raw_url": "https://github.com/rust-lang/rust/raw/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-query-stack.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-query-stack.rs?ref=31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab", "patch": "@@ -1,8 +1,7 @@\n // compile-flags: -Ztreat-err-as-bug=1\n // failure-status: 101\n // rustc-env:RUST_BACKTRACE=1\n-// normalize-stderr-test \"\\nerror: internal compiler error.*\\n\\n\" -> \"\"\n-// normalize-stderr-test \"note:.*unexpectedly panicked.*\\n\\n\" -> \"\"\n+// normalize-stderr-test \"\\nerror: .*unexpectedly panicked.*\\n\\n\" -> \"\"\n // normalize-stderr-test \"note: we would appreciate a bug report.*\\n\\n\" -> \"\"\n // normalize-stderr-test \"note: compiler flags.*\\n\\n\" -> \"\"\n // normalize-stderr-test \"note: rustc.*running on.*\\n\\n\" -> \"\""}, {"sha": "01fb8153cf3846c9be84c82096379456d5c275fc", "filename": "tests/ui/consts/const-eval/const-eval-query-stack.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-query-stack.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-query-stack.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-query-stack.stderr?ref=31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab", "patch": "@@ -1,5 +1,5 @@\n error[E0080]: evaluation of constant value failed\n-  --> $DIR/const-eval-query-stack.rs:17:16\n+  --> $DIR/const-eval-query-stack.rs:16:16\n    |\n LL | const X: i32 = 1 / 0;\n    |                ^^^^^ attempt to divide `1_i32` by zero"}, {"sha": "5a18983a3fa709b892d0efa52feae2183d90a4aa", "filename": "tests/ui/fmt/respanned-literal-issue-106191.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Ffmt%2Frespanned-literal-issue-106191.rs", "raw_url": "https://github.com/rust-lang/rust/raw/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Ffmt%2Frespanned-literal-issue-106191.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ffmt%2Frespanned-literal-issue-106191.rs?ref=31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab", "patch": "@@ -3,7 +3,7 @@\n // known-bug: #106191\n // unset-rustc-env:RUST_BACKTRACE\n // had to be reverted\n-// error-pattern:internal compiler error\n+// error-pattern:unexpectedly panicked\n // failure-status:101\n // dont-check-compiler-stderr\n "}, {"sha": "f3a773837785e3a98f80e9fcc421b06006b29cb4", "filename": "tests/ui/impl-trait/issues/issue-86800.stderr", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Fimpl-trait%2Fissues%2Fissue-86800.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Fimpl-trait%2Fissues%2Fissue-86800.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fimpl-trait%2Fissues%2Fissue-86800.stderr?ref=31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab", "patch": "@@ -9,9 +9,7 @@ LL | type TransactionFuture<'__, O> = impl '__ + Future<Output = TransactionResu\n \n stack backtrace:\n \n-error: internal compiler error: unexpected panic\n-\n-\n+error: the compiler unexpectedly panicked. this is a bug.\n \n \n "}, {"sha": "a3a514fb830958beb540e7452e46f0733f02c019", "filename": "tests/ui/layout/valid_range_oob.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Flayout%2Fvalid_range_oob.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Flayout%2Fvalid_range_oob.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flayout%2Fvalid_range_oob.stderr?ref=31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab", "patch": "@@ -1,4 +1,4 @@\n-error: internal compiler error: unexpected panic\n+error: the compiler unexpectedly panicked. this is a bug.\n \n query stack during panic:\n #0 [layout_of] computing layout of `Foo`"}, {"sha": "7bf08bee9222465b3d01f963615c1fc7da3ba0aa", "filename": "tests/ui/panics/default-backtrace-ice.stderr", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Fpanics%2Fdefault-backtrace-ice.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Fpanics%2Fdefault-backtrace-ice.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fpanics%2Fdefault-backtrace-ice.stderr?ref=31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab", "patch": "@@ -4,9 +4,7 @@ LL | fn main() { missing_ident; }\n \n stack backtrace:\n \n-error: internal compiler error: unexpected panic\n-\n-\n+error: the compiler unexpectedly panicked. this is a bug.\n \n \n "}, {"sha": "22c6175048a63ecff25877a248f98d99c970b54a", "filename": "tests/ui/treat-err-as-bug/delay_span_bug.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Ftreat-err-as-bug%2Fdelay_span_bug.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Ftreat-err-as-bug%2Fdelay_span_bug.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftreat-err-as-bug%2Fdelay_span_bug.stderr?ref=31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab", "patch": "@@ -4,7 +4,7 @@ error: internal compiler error: delayed span bug triggered by #[rustc_error(dela\n LL | fn main() {}\n    | ^^^^^^^^^\n \n-error: internal compiler error: unexpected panic\n+error: the compiler unexpectedly panicked. this is a bug.\n \n query stack during panic:\n #0 [trigger_delay_span_bug] triggering a delay span bug"}, {"sha": "3a56445a26b58102caea740bef520fef157f3a00", "filename": "tests/ui/treat-err-as-bug/err.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Ftreat-err-as-bug%2Ferr.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab/tests%2Fui%2Ftreat-err-as-bug%2Ferr.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftreat-err-as-bug%2Ferr.stderr?ref=31345cd70a6c037f1ac4df5a1e9bd0d6c288b1ab", "patch": "@@ -4,7 +4,7 @@ error[E0080]: could not evaluate static initializer\n LL | pub static C: u32 = 0 - 1;\n    |                     ^^^^^ attempt to compute `0_u32 - 1_u32`, which would overflow\n \n-error: internal compiler error: unexpected panic\n+error: the compiler unexpectedly panicked. this is a bug.\n \n query stack during panic:\n #0 [eval_to_allocation_raw] const-evaluating + checking `C`"}]}