{"sha": "50bb6ba13eeb66e96db5455d0dc2a7cab5b02e1e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUwYmI2YmExM2VlYjY2ZTk2ZGI1NDU1ZDBkYzJhN2NhYjViMDJlMWU=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2018-01-08T22:43:20Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2018-01-12T21:51:34Z"}, "message": "Move forward to add rustdoc test", "tree": {"sha": "57dec4960aec0660f00bff3290172b39059e3244", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/57dec4960aec0660f00bff3290172b39059e3244"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/50bb6ba13eeb66e96db5455d0dc2a7cab5b02e1e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/50bb6ba13eeb66e96db5455d0dc2a7cab5b02e1e", "html_url": "https://github.com/rust-lang/rust/commit/50bb6ba13eeb66e96db5455d0dc2a7cab5b02e1e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/50bb6ba13eeb66e96db5455d0dc2a7cab5b02e1e/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "43acd233b396383a30860108e437829521eba114", "url": "https://api.github.com/repos/rust-lang/rust/commits/43acd233b396383a30860108e437829521eba114", "html_url": "https://github.com/rust-lang/rust/commit/43acd233b396383a30860108e437829521eba114"}], "stats": {"total": 27, "additions": 11, "deletions": 16}, "files": [{"sha": "be62ce3bf3a0a0861af68fa1626cd07108aea2f8", "filename": "src/bootstrap/builder.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/50bb6ba13eeb66e96db5455d0dc2a7cab5b02e1e/src%2Fbootstrap%2Fbuilder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/50bb6ba13eeb66e96db5455d0dc2a7cab5b02e1e/src%2Fbootstrap%2Fbuilder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbuilder.rs?ref=50bb6ba13eeb66e96db5455d0dc2a7cab5b02e1e", "patch": "@@ -254,7 +254,9 @@ impl<'a> Builder<'a> {\n             Kind::Test => describe!(check::Tidy, check::Bootstrap, check::DefaultCompiletest,\n                 check::HostCompiletest, check::Crate, check::CrateLibrustc, check::Rustdoc,\n                 check::Linkcheck, check::Cargotest, check::Cargo, check::Rls, check::Docs,\n-                check::ErrorIndex, check::Distcheck, check::Rustfmt, check::Miri, check::Clippy),\n+                check::ErrorIndex, check::Distcheck, check::Rustfmt, check::Miri, check::Clippy,\n+                check::RustdocJS),\n+\n             Kind::Bench => describe!(check::Crate, check::CrateLibrustc),\n             Kind::Doc => describe!(doc::UnstableBook, doc::UnstableBookGen, doc::TheBook,\n                 doc::Standalone, doc::Std, doc::Test, doc::Rustc, doc::ErrorIndex, doc::Nomicon,"}, {"sha": "265e7721a97c0047dbff90df898e87c5a41bd991", "filename": "src/bootstrap/check.rs", "status": "modified", "additions": 7, "deletions": 14, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/50bb6ba13eeb66e96db5455d0dc2a7cab5b02e1e/src%2Fbootstrap%2Fcheck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/50bb6ba13eeb66e96db5455d0dc2a7cab5b02e1e/src%2Fbootstrap%2Fcheck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fcheck.rs?ref=50bb6ba13eeb66e96db5455d0dc2a7cab5b02e1e", "patch": "@@ -430,12 +430,12 @@ pub struct RustdocJS {\n }\n \n impl Step for RustdocJS {\n-    type Output = PathBuf;\n+    type Output = ();\n     const DEFAULT: bool = true;\n     const ONLY_HOSTS: bool = true;\n \n     fn should_run(run: ShouldRun) -> ShouldRun {\n-        run.path(\"node\")\n+        run.path(\"src/tests/rustdoc-js\")\n     }\n \n     fn make_run(run: RunConfig) {\n@@ -444,17 +444,11 @@ impl Step for RustdocJS {\n         });\n     }\n \n-    fn run(self, _: &Builder) {\n-        let cmd = if cfg!(target_os = \"windows\") {\n-            let command = Command::new(\"cmd\");\n-            command.args(&[\"/C\", \"node src/tools/rustdoc-js/tester.js\"]);\n-            command\n-        } else {\n-            let command = Command::new(\"sh\");\n-            command.args(&[\"-c\", \"node src/tools/rustdoc-js/tester.js\"]);\n-            command\n-        };\n-        builder.run(cmd);\n+    fn run(self, builder: &Builder) {\n+        let nodejs = builder.config.nodejs.clone();\n+        let mut command = Command::new(&nodejs.expect(\"no nodejs found\"));\n+        command.args(&[\"src/tools/rustdoc-js/tester.js\", &*self.host]);\n+        builder.run(&mut command);\n     }\n }\n \n@@ -604,7 +598,6 @@ static HOST_COMPILETESTS: &[Test] = &[\n     },\n     Test { path: \"src/test/run-make\", mode: \"run-make\", suite: \"run-make\" },\n     Test { path: \"src/test/rustdoc\", mode: \"rustdoc\", suite: \"rustdoc\" },\n-    Test { path: \"src/test/rustdoc-js\", mode: \"rustdoc-js\", suite: \"rustdoc-js\" },\n \n     Test { path: \"src/test/pretty\", mode: \"pretty\", suite: \"pretty\" },\n     Test { path: \"src/test/run-pass/pretty\", mode: \"pretty\", suite: \"run-pass\" },"}, {"sha": "96947800d44b6daab6b5736eaa7e7188fe91496d", "filename": "src/bootstrap/tool.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/50bb6ba13eeb66e96db5455d0dc2a7cab5b02e1e/src%2Fbootstrap%2Ftool.rs", "raw_url": "https://github.com/rust-lang/rust/raw/50bb6ba13eeb66e96db5455d0dc2a7cab5b02e1e/src%2Fbootstrap%2Ftool.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftool.rs?ref=50bb6ba13eeb66e96db5455d0dc2a7cab5b02e1e", "patch": "@@ -260,7 +260,7 @@ tool!(\n     BuildManifest, \"src/tools/build-manifest\", \"build-manifest\", Mode::Libstd;\n     RemoteTestClient, \"src/tools/remote-test-client\", \"remote-test-client\", Mode::Libstd;\n     RustInstaller, \"src/tools/rust-installer\", \"fabricate\", Mode::Libstd;\n-    RustdocJS, \"node\", \"node\", Mode::Tool;\n+    RustdocJS, \"rustdoc-js\", \"js-tests\", Mode::Tool;\n );\n \n #[derive(Debug, Copy, Clone, Hash, PartialEq, Eq)]"}]}