{"sha": "9505919be5a9cee11c34d257eefe6c252e82223b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk1MDU5MTliZTVhOWNlZTExYzM0ZDI1N2VlZmU2YzI1MmU4MjIyM2I=", "commit": {"author": {"name": "Philipp Krones", "email": "hello@philkrones.com", "date": "2020-06-23T12:39:43Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-06-23T12:39:43Z"}, "message": "Rollup merge of #5709 - ebroto:5389_ice, r=Manishearth\n\nFix ICE in consts::binop\n\nchangelog: Fix ICE in `consts::binop`\n\nFixes #5389", "tree": {"sha": "3975ff524f0391f274d8bce181ceade815b188c7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3975ff524f0391f274d8bce181ceade815b188c7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9505919be5a9cee11c34d257eefe6c252e82223b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJe8fgPCRBK7hj4Ov3rIwAAdHIIAH4XgRHyX2b6FxNpW+AMwHPL\n066OOba4RnSUHNB1wS2Wj744EIVsuTZFvePLi1BjW1i+nBFiQNdcK//4j6Kn21mJ\n/5oA0i6qcbVmbCBLkFUI7dmBrc3MD1quuu/JrSRkoAU27mh7D0YW7kJRUtmbHIlh\n5hy7v0+qLbp+l4TTANjfgutOnoaZVuFiidnxYCpzgnTKD0MXrD7thP8XqOUmwHbm\nSyohtgCfmTYlGWXaN67rIrTXhd7/wW7J+RziqM7dhxUkeFSFlFoJrG/JHL34OoGn\nVS76zH8KQGPIfFkCFqlCP0rR1lu7Z688HtpGWUBDJBC4XXfVpLH2Tuz/LXssDBM=\n=7h19\n-----END PGP SIGNATURE-----\n", "payload": "tree 3975ff524f0391f274d8bce181ceade815b188c7\nparent 1f39eeb06d3be2f565a5e9105339fb0feb366173\nparent b21ef2b365ef4f5c973327f3f6064b8be42d1dae\nauthor Philipp Krones <hello@philkrones.com> 1592915983 +0200\ncommitter GitHub <noreply@github.com> 1592915983 +0200\n\nRollup merge of #5709 - ebroto:5389_ice, r=Manishearth\n\nFix ICE in consts::binop\n\nchangelog: Fix ICE in `consts::binop`\n\nFixes #5389\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9505919be5a9cee11c34d257eefe6c252e82223b", "html_url": "https://github.com/rust-lang/rust/commit/9505919be5a9cee11c34d257eefe6c252e82223b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9505919be5a9cee11c34d257eefe6c252e82223b/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1f39eeb06d3be2f565a5e9105339fb0feb366173", "url": "https://api.github.com/repos/rust-lang/rust/commits/1f39eeb06d3be2f565a5e9105339fb0feb366173", "html_url": "https://github.com/rust-lang/rust/commit/1f39eeb06d3be2f565a5e9105339fb0feb366173"}, {"sha": "b21ef2b365ef4f5c973327f3f6064b8be42d1dae", "url": "https://api.github.com/repos/rust-lang/rust/commits/b21ef2b365ef4f5c973327f3f6064b8be42d1dae", "html_url": "https://github.com/rust-lang/rust/commit/b21ef2b365ef4f5c973327f3f6064b8be42d1dae"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "550752396c7324f7f857199be2c37c34844b605f", "filename": "clippy_lints/src/consts.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9505919be5a9cee11c34d257eefe6c252e82223b/clippy_lints%2Fsrc%2Fconsts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9505919be5a9cee11c34d257eefe6c252e82223b/clippy_lints%2Fsrc%2Fconsts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fconsts.rs?ref=9505919be5a9cee11c34d257eefe6c252e82223b", "patch": "@@ -396,7 +396,7 @@ impl<'c, 'cc> ConstEvalLateContext<'c, 'cc> {\n         let l = self.expr(left)?;\n         let r = self.expr(right);\n         match (l, r) {\n-            (Constant::Int(l), Some(Constant::Int(r))) => match self.tables.expr_ty(left).kind {\n+            (Constant::Int(l), Some(Constant::Int(r))) => match self.tables.expr_ty_opt(left)?.kind {\n                 ty::Int(ity) => {\n                     let l = sext(self.lcx.tcx, l, ity);\n                     let r = sext(self.lcx.tcx, r, ity);"}, {"sha": "de262199004b025dd1dfebd5c16c98a8ed459589", "filename": "tests/ui/crashes/ice-5389.rs", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/9505919be5a9cee11c34d257eefe6c252e82223b/tests%2Fui%2Fcrashes%2Fice-5389.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9505919be5a9cee11c34d257eefe6c252e82223b/tests%2Fui%2Fcrashes%2Fice-5389.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcrashes%2Fice-5389.rs?ref=9505919be5a9cee11c34d257eefe6c252e82223b", "patch": "@@ -0,0 +1,13 @@\n+#![allow(clippy::explicit_counter_loop)]\n+\n+fn main() {\n+    let v = vec![1, 2, 3];\n+    let mut i = 0;\n+    let max_storage_size = [0; 128 * 1024];\n+    for item in &v {\n+        bar(i, *item);\n+        i += 1;\n+    }\n+}\n+\n+fn bar(_: usize, _: u32) {}"}]}