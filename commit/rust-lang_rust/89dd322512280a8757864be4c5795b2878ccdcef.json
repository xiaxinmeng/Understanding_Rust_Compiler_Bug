{"sha": "89dd322512280a8757864be4c5795b2878ccdcef", "node_id": "C_kwDOAAsO6NoAKDg5ZGQzMjI1MTIyODBhODc1Nzg2NGJlNGM1Nzk1YjI4NzhjY2RjZWY", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-12-02T13:19:27Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-12-02T13:19:27Z"}, "message": "Auto merge of #2708 - RalfJung:verbose-setup, r=RalfJung\n\nforward verbosity to cargo setup", "tree": {"sha": "cbabe43662c0739bc1a297c3ae0f21a97dcba57e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cbabe43662c0739bc1a297c3ae0f21a97dcba57e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/89dd322512280a8757864be4c5795b2878ccdcef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/89dd322512280a8757864be4c5795b2878ccdcef", "html_url": "https://github.com/rust-lang/rust/commit/89dd322512280a8757864be4c5795b2878ccdcef", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/89dd322512280a8757864be4c5795b2878ccdcef/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "90118a197ba91c248376e1ff72bdf7dc370776f6", "url": "https://api.github.com/repos/rust-lang/rust/commits/90118a197ba91c248376e1ff72bdf7dc370776f6", "html_url": "https://github.com/rust-lang/rust/commit/90118a197ba91c248376e1ff72bdf7dc370776f6"}, {"sha": "5fd4b84e20315dcdb0bf05bff8512cc9f78d7380", "url": "https://api.github.com/repos/rust-lang/rust/commits/5fd4b84e20315dcdb0bf05bff8512cc9f78d7380", "html_url": "https://github.com/rust-lang/rust/commit/5fd4b84e20315dcdb0bf05bff8512cc9f78d7380"}], "stats": {"total": 9, "additions": 6, "deletions": 3}, "files": [{"sha": "91945ad39f50b2381bf68bf7a4255e5c6b586919", "filename": "src/tools/miri/cargo-miri/src/phases.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/89dd322512280a8757864be4c5795b2878ccdcef/src%2Ftools%2Fmiri%2Fcargo-miri%2Fsrc%2Fphases.rs", "raw_url": "https://github.com/rust-lang/rust/raw/89dd322512280a8757864be4c5795b2878ccdcef/src%2Ftools%2Fmiri%2Fcargo-miri%2Fsrc%2Fphases.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiri%2Fcargo-miri%2Fsrc%2Fphases.rs?ref=89dd322512280a8757864be4c5795b2878ccdcef", "patch": "@@ -94,7 +94,7 @@ pub fn phase_cargo_miri(mut args: impl Iterator<Item = String>) {\n     let target = target.as_ref().unwrap_or(host);\n \n     // We always setup.\n-    setup(&subcommand, target, &rustc_version);\n+    setup(&subcommand, target, &rustc_version, verbose);\n \n     // Invoke actual cargo for the job, but with different flags.\n     // We re-use `cargo test` and `cargo run`, which makes target and binary handling very easy but"}, {"sha": "a696546954f90b9b3450aeb4610784cd1139742d", "filename": "src/tools/miri/cargo-miri/src/setup.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/89dd322512280a8757864be4c5795b2878ccdcef/src%2Ftools%2Fmiri%2Fcargo-miri%2Fsrc%2Fsetup.rs", "raw_url": "https://github.com/rust-lang/rust/raw/89dd322512280a8757864be4c5795b2878ccdcef/src%2Ftools%2Fmiri%2Fcargo-miri%2Fsrc%2Fsetup.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiri%2Fcargo-miri%2Fsrc%2Fsetup.rs?ref=89dd322512280a8757864be4c5795b2878ccdcef", "patch": "@@ -13,7 +13,7 @@ use crate::util::*;\n /// Performs the setup required to make `cargo miri` work: Getting a custom-built libstd. Then sets\n /// `MIRI_SYSROOT`. Skipped if `MIRI_SYSROOT` is already set, in which case we expect the user has\n /// done all this already.\n-pub fn setup(subcommand: &MiriCommand, target: &str, rustc_version: &VersionMeta) {\n+pub fn setup(subcommand: &MiriCommand, target: &str, rustc_version: &VersionMeta, verbose: usize) {\n     let only_setup = matches!(subcommand, MiriCommand::Setup);\n     let ask_user = !only_setup;\n     let print_sysroot = only_setup && has_arg_flag(\"--print-sysroot\"); // whether we just print the sysroot path\n@@ -100,7 +100,10 @@ pub fn setup(subcommand: &MiriCommand, target: &str, rustc_version: &VersionMeta\n         command.env(\"RUSTC_WRAPPER\", \"\");\n \n         if only_setup && !print_sysroot {\n-            // Forward output.\n+            // Forward output. Even make it verbose, if requested.\n+            for _ in 0..verbose {\n+                command.arg(\"-v\");\n+            }\n         } else {\n             // Supress output.\n             command.stdout(process::Stdio::null());"}]}