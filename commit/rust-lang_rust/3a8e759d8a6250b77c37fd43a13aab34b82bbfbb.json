{"sha": "3a8e759d8a6250b77c37fd43a13aab34b82bbfbb", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNhOGU3NTlkOGE2MjUwYjc3YzM3ZmQ0M2ExM2FhYjM0YjgyYmJmYmI=", "commit": {"author": {"name": "Cameron Steffen", "email": "cam.steffen94@gmail.com", "date": "2021-04-26T20:47:39Z"}, "committer": {"name": "Cameron Steffen", "email": "cam.steffen94@gmail.com", "date": "2021-04-26T21:07:48Z"}, "message": "Update MSRV contribution docs", "tree": {"sha": "26836a970f38c25cc6a0b422730abd6881aa4610", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/26836a970f38c25cc6a0b422730abd6881aa4610"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3a8e759d8a6250b77c37fd43a13aab34b82bbfbb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3a8e759d8a6250b77c37fd43a13aab34b82bbfbb", "html_url": "https://github.com/rust-lang/rust/commit/3a8e759d8a6250b77c37fd43a13aab34b82bbfbb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3a8e759d8a6250b77c37fd43a13aab34b82bbfbb/comments", "author": {"login": "camsteffen", "id": 5565418, "node_id": "MDQ6VXNlcjU1NjU0MTg=", "avatar_url": "https://avatars.githubusercontent.com/u/5565418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/camsteffen", "html_url": "https://github.com/camsteffen", "followers_url": "https://api.github.com/users/camsteffen/followers", "following_url": "https://api.github.com/users/camsteffen/following{/other_user}", "gists_url": "https://api.github.com/users/camsteffen/gists{/gist_id}", "starred_url": "https://api.github.com/users/camsteffen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/camsteffen/subscriptions", "organizations_url": "https://api.github.com/users/camsteffen/orgs", "repos_url": "https://api.github.com/users/camsteffen/repos", "events_url": "https://api.github.com/users/camsteffen/events{/privacy}", "received_events_url": "https://api.github.com/users/camsteffen/received_events", "type": "User", "site_admin": false}, "committer": {"login": "camsteffen", "id": 5565418, "node_id": "MDQ6VXNlcjU1NjU0MTg=", "avatar_url": "https://avatars.githubusercontent.com/u/5565418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/camsteffen", "html_url": "https://github.com/camsteffen", "followers_url": "https://api.github.com/users/camsteffen/followers", "following_url": "https://api.github.com/users/camsteffen/following{/other_user}", "gists_url": "https://api.github.com/users/camsteffen/gists{/gist_id}", "starred_url": "https://api.github.com/users/camsteffen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/camsteffen/subscriptions", "organizations_url": "https://api.github.com/users/camsteffen/orgs", "repos_url": "https://api.github.com/users/camsteffen/repos", "events_url": "https://api.github.com/users/camsteffen/events{/privacy}", "received_events_url": "https://api.github.com/users/camsteffen/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "340b570ea0479dc3a9f9bbe1031f8686c9f660e1", "url": "https://api.github.com/repos/rust-lang/rust/commits/340b570ea0479dc3a9f9bbe1031f8686c9f660e1", "html_url": "https://github.com/rust-lang/rust/commit/340b570ea0479dc3a9f9bbe1031f8686c9f660e1"}], "stats": {"total": 24, "additions": 15, "deletions": 9}, "files": [{"sha": "d6cc6d0c2c76394842dd80d085e811bf96b78725", "filename": "doc/adding_lints.md", "status": "modified", "additions": 15, "deletions": 9, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/3a8e759d8a6250b77c37fd43a13aab34b82bbfbb/doc%2Fadding_lints.md", "raw_url": "https://github.com/rust-lang/rust/raw/3a8e759d8a6250b77c37fd43a13aab34b82bbfbb/doc%2Fadding_lints.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/doc%2Fadding_lints.md?ref=3a8e759d8a6250b77c37fd43a13aab34b82bbfbb", "patch": "@@ -390,17 +390,23 @@ pass.\n \n ## Specifying the lint's minimum supported Rust version (MSRV)\n \n-Projects supporting older versions of Rust would need to disable a lint if it\n-targets features present in later versions. Support for this can be added by\n-specifying an MSRV in your lint like so,\n+Sometimes a lint makes suggestions that require a certain version of Rust. For example, the `manual_strip` lint suggests\n+using `str::strip_prefix` and `str::strip_suffix` which is only available after Rust 1.45. In such cases, you need to\n+ensure that the MSRV configured for the project is >= the MSRV of the required Rust feature. If multiple features are\n+required, just use the one with a lower MSRV.\n+\n+First, add an MSRV alias for the required feature in [`clippy_utils::msrvs`](/clippy_utils/src/msrvs.rs). This can be\n+accessed later as `msrvs::STR_STRIP_PREFIX`, for example.\n \n ```rust\n-const MANUAL_STRIP_MSRV: RustcVersion = RustcVersion::new(1, 45, 0);\n+msrv_aliases! {\n+    ..\n+    1,45,0 { STR_STRIP_PREFIX }\n+}\n ```\n \n-The project's MSRV will also have to be an attribute in the lint so you'll have\n-to add a struct and constructor for your lint. The project's MSRV needs to be\n-passed when the lint is registered in `lib.rs`\n+In order to access the project-configured MSRV, you need to have an `msrv` field in the LintPass struct, and a\n+constructor to initialize the field. The `msrv` value is passed to the constructor in `clippy_lints/lib.rs`.\n \n ```rust\n pub struct ManualStrip {\n@@ -415,11 +421,11 @@ impl ManualStrip {\n }\n ```\n \n-The project's MSRV can then be matched against the lint's `msrv` in the LintPass\n+The project's MSRV can then be matched against the feature MSRV in the LintPass\n using the `meets_msrv` utility function.\n \n ``` rust\n-if !meets_msrv(self.msrv.as_ref(), &MANUAL_STRIP_MSRV) {\n+if !meets_msrv(self.msrv.as_ref(), &msrvs::STR_STRIP_PREFIX) {\n     return;\n }\n ```"}]}