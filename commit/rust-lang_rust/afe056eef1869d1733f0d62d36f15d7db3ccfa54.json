{"sha": "afe056eef1869d1733f0d62d36f15d7db3ccfa54", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFmZTA1NmVlZjE4NjlkMTczM2YwZDYyZDM2ZjE1ZDdkYjNjY2ZhNTQ=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-06-21T20:00:56Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-06-21T20:00:56Z"}, "message": "Merge #9364\n\n9364: Split hover actions config into its own config struct r=Veykril a=Veykril\n\nbors r+\n\nCo-authored-by: Lukas Wirth <lukastw97@gmail.com>", "tree": {"sha": "9fd993577a98b82bd159fad239ecbc96115bc637", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9fd993577a98b82bd159fad239ecbc96115bc637"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/afe056eef1869d1733f0d62d36f15d7db3ccfa54", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJg0O/4CRBK7hj4Ov3rIwAA2VUIAB0APR18QjXmhRwXMvZF6c/z\ne3rPtJ9jlSNkAVvz/mF6t4m8h2XAOEK97/UI3Oy5npMPdzsARkjlNIzwFuXFUNDd\nNEJyqiAxW7qUGsIL9cAydSKkApqVKkqj+RVX8VYnV8E1edqjn43BCKC36Y6ss369\n/eWRXRQwLFf+FQT6t8TgznjbhJ+xAM6QXp+lxbYiy6lPtI7i0Lkn11EAWg4k6a99\nF61u8pB6wZOmMPILXFj8tToLjvXhZvTR6bGoKhrL8rCTCNDtFHqXD1dOpPQOStAD\nri5cOafdtv5ehASSNjsVrfPMGOo/U5gNqBhyH0ZKV7+hhl6fUoA+4F3vxLwoyfg=\n=Ne1H\n-----END PGP SIGNATURE-----\n", "payload": "tree 9fd993577a98b82bd159fad239ecbc96115bc637\nparent d2b89ebb92593139dc3eb9738ef7bef7bb5bf414\nparent 65d683df367ac1d2b8c421c61b76c9e2c26b8704\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1624305656 +0000\ncommitter GitHub <noreply@github.com> 1624305656 +0000\n\nMerge #9364\n\n9364: Split hover actions config into its own config struct r=Veykril a=Veykril\n\nbors r+\n\nCo-authored-by: Lukas Wirth <lukastw97@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/afe056eef1869d1733f0d62d36f15d7db3ccfa54", "html_url": "https://github.com/rust-lang/rust/commit/afe056eef1869d1733f0d62d36f15d7db3ccfa54", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/afe056eef1869d1733f0d62d36f15d7db3ccfa54/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d2b89ebb92593139dc3eb9738ef7bef7bb5bf414", "url": "https://api.github.com/repos/rust-lang/rust/commits/d2b89ebb92593139dc3eb9738ef7bef7bb5bf414", "html_url": "https://github.com/rust-lang/rust/commit/d2b89ebb92593139dc3eb9738ef7bef7bb5bf414"}, {"sha": "65d683df367ac1d2b8c421c61b76c9e2c26b8704", "url": "https://api.github.com/repos/rust-lang/rust/commits/65d683df367ac1d2b8c421c61b76c9e2c26b8704", "html_url": "https://github.com/rust-lang/rust/commit/65d683df367ac1d2b8c421c61b76c9e2c26b8704"}], "stats": {"total": 254, "additions": 157, "deletions": 97}, "files": [{"sha": "c6d6bb74a829d314182ff279bdb2acdf142e682b", "filename": "crates/ide/src/hover.rs", "status": "modified", "additions": 78, "deletions": 57, "changes": 135, "blob_url": "https://github.com/rust-lang/rust/blob/afe056eef1869d1733f0d62d36f15d7db3ccfa54/crates%2Fide%2Fsrc%2Fhover.rs", "raw_url": "https://github.com/rust-lang/rust/raw/afe056eef1869d1733f0d62d36f15d7db3ccfa54/crates%2Fide%2Fsrc%2Fhover.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fhover.rs?ref=afe056eef1869d1733f0d62d36f15d7db3ccfa54", "patch": "@@ -1,5 +1,5 @@\n use either::Either;\n-use hir::{AsAssocItem, HasAttrs, HasSource, HirDisplay};\n+use hir::{AsAssocItem, HasAttrs, HasSource, HirDisplay, Semantics};\n use ide_db::{\n     base_db::SourceDatabase,\n     defs::{Definition, NameClass, NameRefClass},\n@@ -30,39 +30,20 @@ use crate::{\n \n #[derive(Clone, Debug, PartialEq, Eq)]\n pub struct HoverConfig {\n-    pub implementations: bool,\n-    pub references: bool,\n-    pub run: bool,\n-    pub debug: bool,\n-    pub goto_type_def: bool,\n     pub links_in_hover: bool,\n-    pub markdown: bool,\n-    pub documentation: bool,\n+    pub documentation: Option<HoverDocFormat>,\n }\n \n impl HoverConfig {\n-    pub const NO_ACTIONS: Self = Self {\n-        implementations: false,\n-        references: false,\n-        run: false,\n-        debug: false,\n-        goto_type_def: false,\n-        links_in_hover: true,\n-        markdown: true,\n-        documentation: true,\n-    };\n-\n-    pub fn any_actions(&self) -> bool {\n-        self.implementations || self.references || self.runnable() || self.goto_type_def\n-    }\n-\n-    pub fn no_actions(&self) -> bool {\n-        !self.any_actions()\n+    fn markdown(&self) -> bool {\n+        matches!(self.documentation, Some(HoverDocFormat::Markdown))\n     }\n+}\n \n-    pub fn runnable(&self) -> bool {\n-        self.run || self.debug\n-    }\n+#[derive(Clone, Debug, PartialEq, Eq)]\n+pub enum HoverDocFormat {\n+    Markdown,\n+    PlainText,\n }\n \n #[derive(Debug, Clone)]\n@@ -95,9 +76,7 @@ pub struct HoverResult {\n pub(crate) fn hover(\n     db: &RootDatabase,\n     position: FilePosition,\n-    links_in_hover: bool,\n-    documentation: bool,\n-    markdown: bool,\n+    config: &HoverConfig,\n ) -> Option<RangeInfo<HoverResult>> {\n     let sema = hir::Semantics::new(db);\n     let file = sema.parse(position.file_id).syntax().clone();\n@@ -156,10 +135,8 @@ pub(crate) fn hover(\n             }\n             _ => None,\n         };\n-        if let Some(markup) =\n-            hover_for_definition(db, definition, famous_defs.as_ref(), documentation)\n-        {\n-            res.markup = process_markup(sema.db, definition, &markup, links_in_hover, markdown);\n+        if let Some(markup) = hover_for_definition(db, definition, famous_defs.as_ref(), config) {\n+            res.markup = process_markup(sema.db, definition, &markup, config);\n             if let Some(action) = show_implementations_action(db, definition) {\n                 res.actions.push(action);\n             }\n@@ -181,8 +158,7 @@ pub(crate) fn hover(\n         }\n     }\n \n-    if let res @ Some(_) = hover_for_keyword(&sema, links_in_hover, markdown, documentation, &token)\n-    {\n+    if let res @ Some(_) = hover_for_keyword(&sema, config, &token) {\n         return res;\n     }\n \n@@ -201,7 +177,7 @@ pub(crate) fn hover(\n         }\n     };\n \n-    res.markup = if markdown {\n+    res.markup = if config.markdown() {\n         Markup::fenced_block(&ty.display(db))\n     } else {\n         ty.display(db).to_string().into()\n@@ -375,13 +351,12 @@ fn process_markup(\n     db: &RootDatabase,\n     def: Definition,\n     markup: &Markup,\n-    links_in_hover: bool,\n-    markdown: bool,\n+    config: &HoverConfig,\n ) -> Markup {\n     let markup = markup.as_str();\n-    let markup = if !markdown {\n+    let markup = if !config.markdown() {\n         remove_markdown(markup)\n-    } else if links_in_hover {\n+    } else if config.links_in_hover {\n         rewrite_links(db, markup, &def)\n     } else {\n         remove_links(markup)\n@@ -428,7 +403,7 @@ fn hover_for_definition(\n     db: &RootDatabase,\n     def: Definition,\n     famous_defs: Option<&FamousDefs>,\n-    documentation: bool,\n+    config: &HoverConfig,\n ) -> Option<Markup> {\n     let mod_path = definition_mod_path(db, &def);\n     let (label, docs) = match def {\n@@ -466,7 +441,11 @@ fn hover_for_definition(\n         Definition::Label(it) => return Some(Markup::fenced_block(&it.name(db))),\n     };\n \n-    return hover_markup(docs.filter(|_| documentation).map(Into::into), label, mod_path);\n+    return hover_markup(\n+        docs.filter(|_| config.documentation.is_some()).map(Into::into),\n+        label,\n+        mod_path,\n+    );\n \n     fn label_and_docs<D>(db: &RootDatabase, def: D) -> (String, Option<hir::Documentation>)\n     where\n@@ -502,13 +481,11 @@ fn hover_for_local(it: hir::Local, db: &RootDatabase) -> Option<Markup> {\n }\n \n fn hover_for_keyword(\n-    sema: &hir::Semantics<RootDatabase>,\n-    links_in_hover: bool,\n-    markdown: bool,\n-    documentation: bool,\n+    sema: &Semantics<RootDatabase>,\n+    config: &HoverConfig,\n     token: &SyntaxToken,\n ) -> Option<RangeInfo<HoverResult>> {\n-    if !token.kind().is_keyword() || !documentation {\n+    if !token.kind().is_keyword() || !config.documentation.is_some() {\n         return None;\n     }\n     let famous_defs = FamousDefs(sema, sema.scope(&token.parent()?).krate());\n@@ -520,8 +497,7 @@ fn hover_for_keyword(\n         sema.db,\n         Definition::ModuleDef(doc_owner.into()),\n         &hover_markup(Some(docs.into()), token.text().into(), None)?,\n-        links_in_hover,\n-        markdown,\n+        config,\n     );\n     Some(RangeInfo::new(token.text_range(), HoverResult { markup, actions: Default::default() }))\n }\n@@ -561,16 +537,34 @@ mod tests {\n     use expect_test::{expect, Expect};\n     use ide_db::base_db::FileLoader;\n \n-    use crate::fixture;\n+    use crate::{fixture, hover::HoverDocFormat, HoverConfig};\n \n     fn check_hover_no_result(ra_fixture: &str) {\n         let (analysis, position) = fixture::position(ra_fixture);\n-        assert!(analysis.hover(position, true, true, true).unwrap().is_none());\n+        assert!(analysis\n+            .hover(\n+                position,\n+                &HoverConfig {\n+                    links_in_hover: true,\n+                    documentation: Some(HoverDocFormat::Markdown)\n+                }\n+            )\n+            .unwrap()\n+            .is_none());\n     }\n \n     fn check(ra_fixture: &str, expect: Expect) {\n         let (analysis, position) = fixture::position(ra_fixture);\n-        let hover = analysis.hover(position, true, true, true).unwrap().unwrap();\n+        let hover = analysis\n+            .hover(\n+                position,\n+                &HoverConfig {\n+                    links_in_hover: true,\n+                    documentation: Some(HoverDocFormat::Markdown),\n+                },\n+            )\n+            .unwrap()\n+            .unwrap();\n \n         let content = analysis.db.file_text(position.file_id);\n         let hovered_element = &content[hover.range];\n@@ -581,7 +575,16 @@ mod tests {\n \n     fn check_hover_no_links(ra_fixture: &str, expect: Expect) {\n         let (analysis, position) = fixture::position(ra_fixture);\n-        let hover = analysis.hover(position, false, true, true).unwrap().unwrap();\n+        let hover = analysis\n+            .hover(\n+                position,\n+                &HoverConfig {\n+                    links_in_hover: false,\n+                    documentation: Some(HoverDocFormat::Markdown),\n+                },\n+            )\n+            .unwrap()\n+            .unwrap();\n \n         let content = analysis.db.file_text(position.file_id);\n         let hovered_element = &content[hover.range];\n@@ -592,7 +595,16 @@ mod tests {\n \n     fn check_hover_no_markdown(ra_fixture: &str, expect: Expect) {\n         let (analysis, position) = fixture::position(ra_fixture);\n-        let hover = analysis.hover(position, true, true, false).unwrap().unwrap();\n+        let hover = analysis\n+            .hover(\n+                position,\n+                &HoverConfig {\n+                    links_in_hover: true,\n+                    documentation: Some(HoverDocFormat::PlainText),\n+                },\n+            )\n+            .unwrap()\n+            .unwrap();\n \n         let content = analysis.db.file_text(position.file_id);\n         let hovered_element = &content[hover.range];\n@@ -603,7 +615,16 @@ mod tests {\n \n     fn check_actions(ra_fixture: &str, expect: Expect) {\n         let (analysis, position) = fixture::position(ra_fixture);\n-        let hover = analysis.hover(position, true, true, true).unwrap().unwrap();\n+        let hover = analysis\n+            .hover(\n+                position,\n+                &HoverConfig {\n+                    links_in_hover: true,\n+                    documentation: Some(HoverDocFormat::Markdown),\n+                },\n+            )\n+            .unwrap()\n+            .unwrap();\n         expect.assert_debug_eq(&hover.info.actions)\n     }\n "}, {"sha": "b978e36af2e5b3a76197b4ef51033751cf6af742", "filename": "crates/ide/src/lib.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/afe056eef1869d1733f0d62d36f15d7db3ccfa54/crates%2Fide%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/afe056eef1869d1733f0d62d36f15d7db3ccfa54/crates%2Fide%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Flib.rs?ref=afe056eef1869d1733f0d62d36f15d7db3ccfa54", "patch": "@@ -75,7 +75,7 @@ pub use crate::{\n     expand_macro::ExpandedMacro,\n     file_structure::{StructureNode, StructureNodeKind},\n     folding_ranges::{Fold, FoldKind},\n-    hover::{HoverAction, HoverConfig, HoverGotoTypeData, HoverResult},\n+    hover::{HoverAction, HoverConfig, HoverDocFormat, HoverGotoTypeData, HoverResult},\n     inlay_hints::{InlayHint, InlayHintsConfig, InlayKind},\n     markup::Markup,\n     move_item::Direction,\n@@ -408,11 +408,9 @@ impl Analysis {\n     pub fn hover(\n         &self,\n         position: FilePosition,\n-        links_in_hover: bool,\n-        documentation: bool,\n-        markdown: bool,\n+        config: &HoverConfig,\n     ) -> Cancellable<Option<RangeInfo<HoverResult>>> {\n-        self.with_db(|db| hover::hover(db, position, links_in_hover, documentation, markdown))\n+        self.with_db(|db| hover::hover(db, position, config))\n     }\n \n     /// Return URL(s) for the documentation of the symbol under the cursor."}, {"sha": "b9aa6f0aada0fb8efe25facccc981bbf56abdfe4", "filename": "crates/rust-analyzer/src/config.rs", "status": "modified", "additions": 67, "deletions": 20, "changes": 87, "blob_url": "https://github.com/rust-lang/rust/blob/afe056eef1869d1733f0d62d36f15d7db3ccfa54/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/afe056eef1869d1733f0d62d36f15d7db3ccfa54/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs?ref=afe056eef1869d1733f0d62d36f15d7db3ccfa54", "patch": "@@ -10,7 +10,10 @@\n use std::{ffi::OsString, iter, path::PathBuf};\n \n use flycheck::FlycheckConfig;\n-use ide::{AssistConfig, CompletionConfig, DiagnosticsConfig, HoverConfig, InlayHintsConfig};\n+use ide::{\n+    AssistConfig, CompletionConfig, DiagnosticsConfig, HoverConfig, HoverDocFormat,\n+    InlayHintsConfig,\n+};\n use ide_db::helpers::{\n     insert_use::{ImportGranularity, InsertUseConfig, PrefixKind},\n     SnippetCap,\n@@ -32,6 +35,9 @@ use crate::{\n //\n // However, editor specific config, which the server doesn't know about, should\n // be specified directly in `package.json`.\n+//\n+// To deprecate an option by replacing it with another name use `new_name | `old_name` so that we keep\n+// parsing the old name.\n config_data! {\n     struct ConfigData {\n         /// How imports should be grouped into use statements.\n@@ -309,6 +315,37 @@ impl LensConfig {\n     }\n }\n \n+#[derive(Clone, Debug, PartialEq, Eq)]\n+pub struct HoverActionsConfig {\n+    pub implementations: bool,\n+    pub references: bool,\n+    pub run: bool,\n+    pub debug: bool,\n+    pub goto_type_def: bool,\n+}\n+\n+impl HoverActionsConfig {\n+    pub const NO_ACTIONS: Self = Self {\n+        implementations: false,\n+        references: false,\n+        run: false,\n+        debug: false,\n+        goto_type_def: false,\n+    };\n+\n+    pub fn any(&self) -> bool {\n+        self.implementations || self.references || self.runnable() || self.goto_type_def\n+    }\n+\n+    pub fn none(&self) -> bool {\n+        !self.any()\n+    }\n+\n+    pub fn runnable(&self) -> bool {\n+        self.run || self.debug\n+    }\n+}\n+\n #[derive(Debug, Clone)]\n pub struct FilesConfig {\n     pub watcher: FilesWatcher,\n@@ -527,7 +564,7 @@ impl Config {\n     pub fn code_action_group(&self) -> bool {\n         self.experimental(\"codeActionGroup\")\n     }\n-    pub fn hover_actions(&self) -> bool {\n+    pub fn experimental_hover_actions(&self) -> bool {\n         self.experimental(\"hoverActions\")\n     }\n     pub fn server_status_notification(&self) -> bool {\n@@ -727,31 +764,41 @@ impl Config {\n             refs: self.data.lens_enable && self.data.lens_references,\n         }\n     }\n-    pub fn highlighting_strings(&self) -> bool {\n-        self.data.highlighting_strings\n-    }\n-    pub fn hover(&self) -> HoverConfig {\n-        HoverConfig {\n+    pub fn hover_actions(&self) -> HoverActionsConfig {\n+        HoverActionsConfig {\n             implementations: self.data.hoverActions_enable\n                 && self.data.hoverActions_implementations,\n             references: self.data.hoverActions_enable && self.data.hoverActions_references,\n             run: self.data.hoverActions_enable && self.data.hoverActions_run,\n             debug: self.data.hoverActions_enable && self.data.hoverActions_debug,\n             goto_type_def: self.data.hoverActions_enable && self.data.hoverActions_gotoTypeDef,\n+        }\n+    }\n+    pub fn highlighting_strings(&self) -> bool {\n+        self.data.highlighting_strings\n+    }\n+    pub fn hover(&self) -> HoverConfig {\n+        HoverConfig {\n             links_in_hover: self.data.hover_linksInHover,\n-            markdown: try_or!(\n-                self.caps\n-                    .text_document\n-                    .as_ref()?\n-                    .hover\n-                    .as_ref()?\n-                    .content_format\n-                    .as_ref()?\n-                    .as_slice(),\n-                &[]\n-            )\n-            .contains(&MarkupKind::Markdown),\n-            documentation: self.data.hover_documentation,\n+            documentation: self.data.hover_documentation.then(|| {\n+                let is_markdown = try_or!(\n+                    self.caps\n+                        .text_document\n+                        .as_ref()?\n+                        .hover\n+                        .as_ref()?\n+                        .content_format\n+                        .as_ref()?\n+                        .as_slice(),\n+                    &[]\n+                )\n+                .contains(&MarkupKind::Markdown);\n+                if is_markdown {\n+                    HoverDocFormat::Markdown\n+                } else {\n+                    HoverDocFormat::PlainText\n+                }\n+            }),\n         }\n     }\n "}, {"sha": "dcead5f5c3af553f47746c8e1f3d663c39ed29a2", "filename": "crates/rust-analyzer/src/handlers.rs", "status": "modified", "additions": 9, "deletions": 15, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/afe056eef1869d1733f0d62d36f15d7db3ccfa54/crates%2Frust-analyzer%2Fsrc%2Fhandlers.rs", "raw_url": "https://github.com/rust-lang/rust/raw/afe056eef1869d1733f0d62d36f15d7db3ccfa54/crates%2Frust-analyzer%2Fsrc%2Fhandlers.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fhandlers.rs?ref=afe056eef1869d1733f0d62d36f15d7db3ccfa54", "patch": "@@ -861,13 +861,7 @@ pub(crate) fn handle_hover(\n ) -> Result<Option<lsp_ext::Hover>> {\n     let _p = profile::span(\"handle_hover\");\n     let position = from_proto::file_position(&snap, params.text_document_position_params)?;\n-    let hover_config = snap.config.hover();\n-    let info = match snap.analysis.hover(\n-        position,\n-        hover_config.links_in_hover,\n-        hover_config.documentation,\n-        hover_config.markdown,\n-    )? {\n+    let info = match snap.analysis.hover(position, &snap.config.hover())? {\n         None => return Ok(None),\n         Some(info) => info,\n     };\n@@ -1487,7 +1481,7 @@ fn show_impl_command_link(\n     snap: &GlobalStateSnapshot,\n     position: &FilePosition,\n ) -> Option<lsp_ext::CommandLinkGroup> {\n-    if snap.config.hover().implementations {\n+    if snap.config.hover_actions().implementations {\n         if let Some(nav_data) = snap.analysis.goto_implementation(*position).unwrap_or(None) {\n             let uri = to_proto::url(snap, position.file_id);\n             let line_index = snap.file_line_index(position.file_id).ok()?;\n@@ -1513,7 +1507,7 @@ fn show_ref_command_link(\n     snap: &GlobalStateSnapshot,\n     position: &FilePosition,\n ) -> Option<lsp_ext::CommandLinkGroup> {\n-    if snap.config.hover().references {\n+    if snap.config.hover_actions().references {\n         if let Some(ref_search_res) = snap.analysis.find_all_refs(*position, None).unwrap_or(None) {\n             let uri = to_proto::url(snap, position.file_id);\n             let line_index = snap.file_line_index(position.file_id).ok()?;\n@@ -1544,21 +1538,21 @@ fn runnable_action_links(\n     runnable: Runnable,\n ) -> Option<lsp_ext::CommandLinkGroup> {\n     let cargo_spec = CargoTargetSpec::for_file(snap, runnable.nav.file_id).ok()?;\n-    let hover_config = snap.config.hover();\n-    if !hover_config.runnable() || should_skip_target(&runnable, cargo_spec.as_ref()) {\n+    let hover_actions_config = snap.config.hover_actions();\n+    if !hover_actions_config.runnable() || should_skip_target(&runnable, cargo_spec.as_ref()) {\n         return None;\n     }\n \n     let action: &'static _ = runnable.action();\n     to_proto::runnable(snap, runnable).ok().map(|r| {\n         let mut group = lsp_ext::CommandLinkGroup::default();\n \n-        if hover_config.run {\n+        if hover_actions_config.run {\n             let run_command = to_proto::command::run_single(&r, action.run_title);\n             group.commands.push(to_command_link(run_command, r.label.clone()));\n         }\n \n-        if hover_config.debug {\n+        if hover_actions_config.debug {\n             let dbg_command = to_proto::command::debug_single(&r);\n             group.commands.push(to_command_link(dbg_command, r.label));\n         }\n@@ -1571,7 +1565,7 @@ fn goto_type_action_links(\n     snap: &GlobalStateSnapshot,\n     nav_targets: &[HoverGotoTypeData],\n ) -> Option<lsp_ext::CommandLinkGroup> {\n-    if !snap.config.hover().goto_type_def || nav_targets.is_empty() {\n+    if !snap.config.hover_actions().goto_type_def || nav_targets.is_empty() {\n         return None;\n     }\n \n@@ -1591,7 +1585,7 @@ fn prepare_hover_actions(\n     snap: &GlobalStateSnapshot,\n     actions: &[HoverAction],\n ) -> Vec<lsp_ext::CommandLinkGroup> {\n-    if snap.config.hover().no_actions() || !snap.config.hover_actions() {\n+    if snap.config.hover_actions().none() || !snap.config.experimental_hover_actions() {\n         return Vec::new();\n     }\n "}]}