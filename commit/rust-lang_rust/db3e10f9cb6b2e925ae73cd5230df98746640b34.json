{"sha": "db3e10f9cb6b2e925ae73cd5230df98746640b34", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRiM2UxMGY5Y2I2YjJlOTI1YWU3M2NkNTIzMGRmOTg3NDY2NDBiMzQ=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2020-08-02T20:08:45Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-08-02T20:08:45Z"}, "message": "Rollup merge of #75031 - JohnTitor:unused-parens-braces-yield, r=lcnr\n\nDo not trigger `unused_{braces,parens}` lints with `yield`\n\nFixes #74883\nr? @lcnr", "tree": {"sha": "4d1e532bc1a23a64e8c9eda7442c35edc3a02ddd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4d1e532bc1a23a64e8c9eda7442c35edc3a02ddd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/db3e10f9cb6b2e925ae73cd5230df98746640b34", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfJx1NCRBK7hj4Ov3rIwAAdHIIABfX6rx4JLuo7ouWQ/k0P5MK\nTTscj2sCLCHerrn+QlEkZ6N2DqhuWp1k0xoLNSFtrNIrDH1V4aOb9Oxzgo65ZI+L\nPQQGLBv3DXoke+ttQ63YbrpI2whN0jr4zTUnNHJtHd5QyYu/yNLsGbwfCzUSOdhP\nFWE+Vam0YT8Wn/VpzVyzabhFWwYOQmABehMOLppDc0AQteqaEogGSIzG6VyUN8vI\nqpUwO9WyeupEcuHJhyu0Rot105dXYmK2x+7MTHXzPfhOdJDEdSn5tyJCW60zIjcD\nFnV0Qq5Wenc81BYVLRBVQ5wgzhgpeblO+DJsoLnlAO4pW/fbHbKpyMcdeU76W5U=\n=/idt\n-----END PGP SIGNATURE-----\n", "payload": "tree 4d1e532bc1a23a64e8c9eda7442c35edc3a02ddd\nparent 1b350ecb60aa1ec1d0eb58b43ebf6a335dc8076c\nparent 2e7ba785b34b040154761d42bdd4a208707e0d29\nauthor Manish Goregaokar <manishsmail@gmail.com> 1596398925 -0700\ncommitter GitHub <noreply@github.com> 1596398925 -0700\n\nRollup merge of #75031 - JohnTitor:unused-parens-braces-yield, r=lcnr\n\nDo not trigger `unused_{braces,parens}` lints with `yield`\n\nFixes #74883\nr? @lcnr\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/db3e10f9cb6b2e925ae73cd5230df98746640b34", "html_url": "https://github.com/rust-lang/rust/commit/db3e10f9cb6b2e925ae73cd5230df98746640b34", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/db3e10f9cb6b2e925ae73cd5230df98746640b34/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1b350ecb60aa1ec1d0eb58b43ebf6a335dc8076c", "url": "https://api.github.com/repos/rust-lang/rust/commits/1b350ecb60aa1ec1d0eb58b43ebf6a335dc8076c", "html_url": "https://github.com/rust-lang/rust/commit/1b350ecb60aa1ec1d0eb58b43ebf6a335dc8076c"}, {"sha": "2e7ba785b34b040154761d42bdd4a208707e0d29", "url": "https://api.github.com/repos/rust-lang/rust/commits/2e7ba785b34b040154761d42bdd4a208707e0d29", "html_url": "https://github.com/rust-lang/rust/commit/2e7ba785b34b040154761d42bdd4a208707e0d29"}], "stats": {"total": 97, "additions": 96, "deletions": 1}, "files": [{"sha": "a33f920603592691d95881aa371ebc80b2d565f7", "filename": "src/librustc_lint/unused.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/db3e10f9cb6b2e925ae73cd5230df98746640b34/src%2Flibrustc_lint%2Funused.rs", "raw_url": "https://github.com/rust-lang/rust/raw/db3e10f9cb6b2e925ae73cd5230df98746640b34/src%2Flibrustc_lint%2Funused.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Funused.rs?ref=db3e10f9cb6b2e925ae73cd5230df98746640b34", "patch": "@@ -422,7 +422,7 @@ trait UnusedDelimLint {\n         lhs_needs_parens\n             || (followed_by_block\n                 && match inner.kind {\n-                    ExprKind::Ret(_) | ExprKind::Break(..) => true,\n+                    ExprKind::Ret(_) | ExprKind::Break(..) | ExprKind::Yield(..) => true,\n                     _ => parser::contains_exterior_struct_lit(&inner),\n                 })\n     }"}, {"sha": "02182ec299321fedb2d0593714b251f624039022", "filename": "src/test/ui/lint/issue-74883-unused-paren-baren-yield.rs", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/db3e10f9cb6b2e925ae73cd5230df98746640b34/src%2Ftest%2Fui%2Flint%2Fissue-74883-unused-paren-baren-yield.rs", "raw_url": "https://github.com/rust-lang/rust/raw/db3e10f9cb6b2e925ae73cd5230df98746640b34/src%2Ftest%2Fui%2Flint%2Fissue-74883-unused-paren-baren-yield.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fissue-74883-unused-paren-baren-yield.rs?ref=db3e10f9cb6b2e925ae73cd5230df98746640b34", "patch": "@@ -0,0 +1,33 @@\n+#![feature(generator_trait)]\n+#![feature(generators)]\n+#![deny(unused_braces, unused_parens)]\n+\n+use std::ops::Generator;\n+use std::pin::Pin;\n+\n+fn main() {\n+    let mut x = |_| {\n+        while let Some(_) = (yield) {}\n+        while let Some(_) = {yield} {}\n+\n+        // Only warn these cases\n+        while let Some(_) = ({yield}) {} //~ ERROR: unnecessary parentheses\n+        while let Some(_) = ((yield)) {} //~ ERROR: unnecessary parentheses\n+        {{yield}}; //~ ERROR: unnecessary braces\n+        {( yield )}; //~ ERROR: unnecessary parentheses\n+\n+        // FIXME: Reduce duplicate warnings.\n+        // Perhaps we should tweak checks in `BlockRetValue`?\n+        while let Some(_) = {(yield)} {}\n+        //~^ ERROR: unnecessary braces\n+        //~| ERROR: unnecessary parentheses\n+        while let Some(_) = {{yield}} {}\n+        //~^ ERROR: unnecessary braces\n+        //~| ERROR: unnecessary braces\n+\n+        // FIXME: It'd be great if we could also warn them.\n+        ((yield));\n+        ({ yield });\n+    };\n+    let _ = Pin::new(&mut x).resume(Some(5));\n+}"}, {"sha": "267cc9e031a11f96aaa23d4891639e9db47a761e", "filename": "src/test/ui/lint/issue-74883-unused-paren-baren-yield.stderr", "status": "added", "additions": 62, "deletions": 0, "changes": 62, "blob_url": "https://github.com/rust-lang/rust/blob/db3e10f9cb6b2e925ae73cd5230df98746640b34/src%2Ftest%2Fui%2Flint%2Fissue-74883-unused-paren-baren-yield.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/db3e10f9cb6b2e925ae73cd5230df98746640b34/src%2Ftest%2Fui%2Flint%2Fissue-74883-unused-paren-baren-yield.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fissue-74883-unused-paren-baren-yield.stderr?ref=db3e10f9cb6b2e925ae73cd5230df98746640b34", "patch": "@@ -0,0 +1,62 @@\n+error: unnecessary parentheses around `let` scrutinee expression\n+  --> $DIR/issue-74883-unused-paren-baren-yield.rs:14:29\n+   |\n+LL |         while let Some(_) = ({yield}) {}\n+   |                             ^^^^^^^^^ help: remove these parentheses\n+   |\n+note: the lint level is defined here\n+  --> $DIR/issue-74883-unused-paren-baren-yield.rs:3:24\n+   |\n+LL | #![deny(unused_braces, unused_parens)]\n+   |                        ^^^^^^^^^^^^^\n+\n+error: unnecessary parentheses around `let` scrutinee expression\n+  --> $DIR/issue-74883-unused-paren-baren-yield.rs:15:29\n+   |\n+LL |         while let Some(_) = ((yield)) {}\n+   |                             ^^^^^^^^^ help: remove these parentheses\n+\n+error: unnecessary braces around block return value\n+  --> $DIR/issue-74883-unused-paren-baren-yield.rs:16:10\n+   |\n+LL |         {{yield}};\n+   |          ^^^^^^^ help: remove these braces\n+   |\n+note: the lint level is defined here\n+  --> $DIR/issue-74883-unused-paren-baren-yield.rs:3:9\n+   |\n+LL | #![deny(unused_braces, unused_parens)]\n+   |         ^^^^^^^^^^^^^\n+\n+error: unnecessary parentheses around block return value\n+  --> $DIR/issue-74883-unused-paren-baren-yield.rs:17:10\n+   |\n+LL |         {( yield )};\n+   |          ^^^^^^^^^ help: remove these parentheses\n+\n+error: unnecessary braces around `let` scrutinee expression\n+  --> $DIR/issue-74883-unused-paren-baren-yield.rs:21:29\n+   |\n+LL |         while let Some(_) = {(yield)} {}\n+   |                             ^^^^^^^^^ help: remove these braces\n+\n+error: unnecessary parentheses around block return value\n+  --> $DIR/issue-74883-unused-paren-baren-yield.rs:21:30\n+   |\n+LL |         while let Some(_) = {(yield)} {}\n+   |                              ^^^^^^^ help: remove these parentheses\n+\n+error: unnecessary braces around `let` scrutinee expression\n+  --> $DIR/issue-74883-unused-paren-baren-yield.rs:24:29\n+   |\n+LL |         while let Some(_) = {{yield}} {}\n+   |                             ^^^^^^^^^ help: remove these braces\n+\n+error: unnecessary braces around block return value\n+  --> $DIR/issue-74883-unused-paren-baren-yield.rs:24:30\n+   |\n+LL |         while let Some(_) = {{yield}} {}\n+   |                              ^^^^^^^ help: remove these braces\n+\n+error: aborting due to 8 previous errors\n+"}]}