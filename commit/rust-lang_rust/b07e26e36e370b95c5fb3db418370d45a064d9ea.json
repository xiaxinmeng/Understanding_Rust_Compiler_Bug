{"sha": "b07e26e36e370b95c5fb3db418370d45a064d9ea", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIwN2UyNmUzNmUzNzBiOTVjNWZiM2RiNDE4MzcwZDQ1YTA2NGQ5ZWE=", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2017-12-10T00:30:47Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2017-12-12T21:02:23Z"}, "message": "Resolve absolute paths as extern under a feature flag", "tree": {"sha": "c2003a6a56b313b5727ba07cf196f979036a46b5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c2003a6a56b313b5727ba07cf196f979036a46b5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b07e26e36e370b95c5fb3db418370d45a064d9ea", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b07e26e36e370b95c5fb3db418370d45a064d9ea", "html_url": "https://github.com/rust-lang/rust/commit/b07e26e36e370b95c5fb3db418370d45a064d9ea", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b07e26e36e370b95c5fb3db418370d45a064d9ea/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9552b9cfd22b9378bb2a86f8f0738f92c1982d20", "url": "https://api.github.com/repos/rust-lang/rust/commits/9552b9cfd22b9378bb2a86f8f0738f92c1982d20", "html_url": "https://github.com/rust-lang/rust/commit/9552b9cfd22b9378bb2a86f8f0738f92c1982d20"}], "stats": {"total": 241, "additions": 238, "deletions": 3}, "files": [{"sha": "914fb0670b6058d1208aa5882e35b804758242ab", "filename": "src/librustc/middle/cstore.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Flibrustc%2Fmiddle%2Fcstore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Flibrustc%2Fmiddle%2Fcstore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fcstore.rs?ref=b07e26e36e370b95c5fb3db418370d45a064d9ea", "patch": "@@ -357,6 +357,7 @@ impl CrateStore for DummyCrateStore {\n pub trait CrateLoader {\n     fn process_item(&mut self, item: &ast::Item, defs: &Definitions);\n     fn postprocess(&mut self, krate: &ast::Crate);\n+    fn resolve_crate_from_path(&mut self, name: Symbol, span: Span) -> CrateNum;\n }\n \n // This method is used when generating the command line to pass through to"}, {"sha": "58453066cf34b06e67fe42dd222b0b46eb1a0c4c", "filename": "src/librustc_metadata/creader.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Flibrustc_metadata%2Fcreader.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Flibrustc_metadata%2Fcreader.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Fcreader.rs?ref=b07e26e36e370b95c5fb3db418370d45a064d9ea", "patch": "@@ -1087,4 +1087,8 @@ impl<'a> middle::cstore::CrateLoader for CrateLoader<'a> {\n             _ => {}\n         }\n     }\n+\n+    fn resolve_crate_from_path(&mut self, name: Symbol, span: Span) -> CrateNum {\n+        self.resolve_crate(&None, name, name, None, span, PathKind::Crate, DepKind::Explicit).0\n+    }\n }"}, {"sha": "ca822faeeac01378c2d1db70cda033f19217fed9", "filename": "src/librustc_resolve/lib.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Flibrustc_resolve%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Flibrustc_resolve%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Flib.rs?ref=b07e26e36e370b95c5fb3db418370d45a064d9ea", "patch": "@@ -58,6 +58,7 @@ use syntax::ast::{Item, ItemKind, ImplItem, ImplItemKind};\n use syntax::ast::{Local, Mutability, Pat, PatKind, Path};\n use syntax::ast::{QSelf, TraitItemKind, TraitRef, Ty, TyKind};\n use syntax::feature_gate::{feature_err, emit_feature_err, GateIssue};\n+use syntax::parse::token;\n \n use syntax_pos::{Span, DUMMY_SP, MultiSpan};\n use errors::{DiagnosticBuilder, DiagnosticId};\n@@ -2959,6 +2960,16 @@ impl<'a> Resolver<'a> {\n                     // `$crate::a::b`\n                     module = Some(self.resolve_crate_root(ident.node.ctxt));\n                     continue\n+                } else if i == 1 && self.session.features.borrow().extern_absolute_paths &&\n+                                    path[0].node.name == keywords::CrateRoot.name() &&\n+                                    !token::Ident(ident.node).is_path_segment_keyword() {\n+                    // `::extern_crate::a::b`\n+                    let crate_id = self.crate_loader.resolve_crate_from_path(name, ident.span);\n+                    let crate_root =\n+                        self.get_module(DefId { krate: crate_id, index: CRATE_DEF_INDEX });\n+                    self.populate_module_if_necessary(crate_root);\n+                    module = Some(crate_root);\n+                    continue\n                 }\n             }\n "}, {"sha": "2dbcbb364d86ce8888be8762dbfa3556ec266d5f", "filename": "src/librustc_resolve/resolve_imports.rs", "status": "modified", "additions": 55, "deletions": 3, "changes": 58, "blob_url": "https://github.com/rust-lang/rust/blob/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Flibrustc_resolve%2Fresolve_imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Flibrustc_resolve%2Fresolve_imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Fresolve_imports.rs?ref=b07e26e36e370b95c5fb3db418370d45a064d9ea", "patch": "@@ -12,14 +12,14 @@ use self::ImportDirectiveSubclass::*;\n \n use {AmbiguityError, Module, PerNS};\n use Namespace::{self, TypeNS, MacroNS};\n-use {NameBinding, NameBindingKind, PathResult, PrivacyError};\n+use {NameBinding, NameBindingKind, ToNameBinding, PathResult, PrivacyError};\n use Resolver;\n use {names_to_string, module_to_string};\n use {resolve_error, ResolutionError};\n \n use rustc::ty;\n use rustc::lint::builtin::PUB_USE_OF_PRIVATE_EXTERN_CRATE;\n-use rustc::hir::def_id::DefId;\n+use rustc::hir::def_id::{CRATE_DEF_INDEX, DefId};\n use rustc::hir::def::*;\n use rustc::session::DiagnosticMessageId;\n use rustc::util::nodemap::{FxHashMap, FxHashSet};\n@@ -602,8 +602,60 @@ impl<'a, 'b:'a> ImportResolver<'a, 'b> {\n     // If appropriate, returns an error to report.\n     fn finalize_import(&mut self, directive: &'b ImportDirective<'b>) -> Option<(Span, String)> {\n         self.current_module = directive.parent;\n-\n         let ImportDirective { ref module_path, span, .. } = *directive;\n+\n+        // Extern crate mode for absolute paths needs some\n+        // special support for single-segment imports.\n+        let extern_absolute_paths = self.session.features.borrow().extern_absolute_paths;\n+        if module_path.len() == 1 && module_path[0].node.name == keywords::CrateRoot.name() {\n+            match directive.subclass {\n+                GlobImport { .. } if extern_absolute_paths => {\n+                    return Some((directive.span,\n+                                 \"cannot glob-import all possible crates\".to_string()));\n+                }\n+                SingleImport { source, target, .. } => {\n+                    let crate_root = if source.name == keywords::Crate.name() {\n+                        if target.name == keywords::Crate.name() {\n+                            return Some((directive.span,\n+                                         \"crate root imports need to be explicitly named: \\\n+                                          `use crate as name;`\".to_string()));\n+                        } else {\n+                            Some(self.resolve_crate_root(source.ctxt.modern()))\n+                        }\n+                    } else if extern_absolute_paths &&\n+                              !token::Ident(source).is_path_segment_keyword() {\n+                        let crate_id =\n+                            self.crate_loader.resolve_crate_from_path(source.name, directive.span);\n+                        let crate_root =\n+                            self.get_module(DefId { krate: crate_id, index: CRATE_DEF_INDEX });\n+                        self.populate_module_if_necessary(crate_root);\n+                        Some(crate_root)\n+                    } else {\n+                        None\n+                    };\n+\n+                    if let Some(crate_root) = crate_root {\n+                        let binding = (crate_root, ty::Visibility::Public, directive.span,\n+                                       directive.expansion).to_name_binding(self.arenas);\n+                        let binding = self.arenas.alloc_name_binding(NameBinding {\n+                            kind: NameBindingKind::Import {\n+                                binding,\n+                                directive,\n+                                used: Cell::new(false),\n+                                legacy_self_import: false,\n+                            },\n+                            vis: directive.vis.get(),\n+                            span: directive.span,\n+                            expansion: directive.expansion,\n+                        });\n+                        let _ = self.try_define(directive.parent, target, TypeNS, binding);\n+                        return None;\n+                    }\n+                }\n+                _ => {}\n+            }\n+        }\n+\n         let module_result = self.resolve_path(&module_path, None, true, span);\n         let module = match module_result {\n             PathResult::Module(module) => module,"}, {"sha": "c7bfb121f801efd59cc2705a970d1fe30137c621", "filename": "src/libsyntax/feature_gate.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Flibsyntax%2Ffeature_gate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Flibsyntax%2Ffeature_gate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ffeature_gate.rs?ref=b07e26e36e370b95c5fb3db418370d45a064d9ea", "patch": "@@ -430,6 +430,9 @@ declare_features! (\n \n     // generic associated types (RFC 1598)\n     (active, generic_associated_types, \"1.23.0\", Some(44265)),\n+\n+    // Resolve absolute paths as paths from other crates\n+    (active, extern_absolute_paths, \"1.24.0\", Some(44660)),\n );\n \n declare_features! ("}, {"sha": "c3da4a518720d4e8ccdc8efcfe7e4b254e6d93da", "filename": "src/test/compile-fail/rfc-2126-extern-absolute-paths/auxiliary/xcrate.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Fcompile-fail%2Frfc-2126-extern-absolute-paths%2Fauxiliary%2Fxcrate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Fcompile-fail%2Frfc-2126-extern-absolute-paths%2Fauxiliary%2Fxcrate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Frfc-2126-extern-absolute-paths%2Fauxiliary%2Fxcrate.rs?ref=b07e26e36e370b95c5fb3db418370d45a064d9ea", "patch": "@@ -0,0 +1,15 @@\n+// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+#[derive(Debug)]\n+pub struct S;\n+\n+#[derive(Debug)]\n+pub struct Z;"}, {"sha": "14d5d9caa317f5ed95a9ff6f5dc6144488d89e81", "filename": "src/test/compile-fail/rfc-2126-extern-absolute-paths/non-existent-1.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Fcompile-fail%2Frfc-2126-extern-absolute-paths%2Fnon-existent-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Fcompile-fail%2Frfc-2126-extern-absolute-paths%2Fnon-existent-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Frfc-2126-extern-absolute-paths%2Fnon-existent-1.rs?ref=b07e26e36e370b95c5fb3db418370d45a064d9ea", "patch": "@@ -0,0 +1,15 @@\n+// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+#![feature(extern_absolute_paths)]\n+\n+use xcrate::S; //~ ERROR can't find crate for `xcrate`\n+\n+fn main() {}"}, {"sha": "defd103f9e457d55d901594a566fdd1cfb4be4ad", "filename": "src/test/compile-fail/rfc-2126-extern-absolute-paths/non-existent-2.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Fcompile-fail%2Frfc-2126-extern-absolute-paths%2Fnon-existent-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Fcompile-fail%2Frfc-2126-extern-absolute-paths%2Fnon-existent-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Frfc-2126-extern-absolute-paths%2Fnon-existent-2.rs?ref=b07e26e36e370b95c5fb3db418370d45a064d9ea", "patch": "@@ -0,0 +1,15 @@\n+// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+#![feature(extern_absolute_paths)]\n+\n+fn main() {\n+    let s = ::xcrate::S; //~ ERROR can't find crate for `xcrate`\n+}"}, {"sha": "be1708e2b57489e333a8d68f80c517e0b74a8cb0", "filename": "src/test/compile-fail/rfc-2126-extern-absolute-paths/non-existent-3.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Fcompile-fail%2Frfc-2126-extern-absolute-paths%2Fnon-existent-3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Fcompile-fail%2Frfc-2126-extern-absolute-paths%2Fnon-existent-3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Frfc-2126-extern-absolute-paths%2Fnon-existent-3.rs?ref=b07e26e36e370b95c5fb3db418370d45a064d9ea", "patch": "@@ -0,0 +1,15 @@\n+// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+#![feature(extern_absolute_paths)]\n+\n+use ycrate; //~ ERROR can't find crate for `ycrate`\n+\n+fn main() {}"}, {"sha": "e44465750d1ddc024999c0455e97a8c6d6a93af6", "filename": "src/test/compile-fail/rfc-2126-extern-absolute-paths/single-segment.rs", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Fcompile-fail%2Frfc-2126-extern-absolute-paths%2Fsingle-segment.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Fcompile-fail%2Frfc-2126-extern-absolute-paths%2Fsingle-segment.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Frfc-2126-extern-absolute-paths%2Fsingle-segment.rs?ref=b07e26e36e370b95c5fb3db418370d45a064d9ea", "patch": "@@ -0,0 +1,24 @@\n+// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// aux-build:xcrate.rs\n+\n+#![feature(crate_in_paths)]\n+#![feature(extern_absolute_paths)]\n+\n+use crate; //~ ERROR unresolved import `crate`\n+           //~^ NOTE crate root imports need to be explicitly named: `use crate as name;`\n+use *; //~ ERROR unresolved import `*`\n+       //~^ NOTE cannot glob-import all possible crates\n+\n+fn main() {\n+    let s = ::xcrate; //~ ERROR expected value, found module `xcrate`\n+                      //~^ NOTE not a value\n+}"}, {"sha": "7003541e86cd331bd89cca4dc8a8cf4b63029261", "filename": "src/test/run-pass/rfc-2126-crate-paths/crate-path-absolute.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Frun-pass%2Frfc-2126-crate-paths%2Fcrate-path-absolute.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Frun-pass%2Frfc-2126-crate-paths%2Fcrate-path-absolute.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Frfc-2126-crate-paths%2Fcrate-path-absolute.rs?ref=b07e26e36e370b95c5fb3db418370d45a064d9ea", "patch": "@@ -11,10 +11,12 @@\n #![feature(crate_in_paths)]\n \n use crate::m::f;\n+use crate as root;\n \n mod m {\n     pub fn f() -> u8 { 1 }\n     pub fn g() -> u8 { 2 }\n+    pub fn h() -> u8 { 3 }\n \n     // OK, visibilities are implicitly absolute like imports\n     pub(in crate::m) struct S;\n@@ -23,14 +25,17 @@ mod m {\n mod n\n {\n     use crate::m::f;\n+    use crate as root;\n     pub fn check() {\n         assert_eq!(f(), 1);\n         assert_eq!(::crate::m::g(), 2);\n+        assert_eq!(root::m::h(), 3);\n     }\n }\n \n fn main() {\n     assert_eq!(f(), 1);\n     assert_eq!(::crate::m::g(), 2);\n+    assert_eq!(root::m::h(), 3);\n     n::check();\n }"}, {"sha": "c3da4a518720d4e8ccdc8efcfe7e4b254e6d93da", "filename": "src/test/run-pass/rfc-2126-extern-absolute-paths/auxiliary/xcrate.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Frun-pass%2Frfc-2126-extern-absolute-paths%2Fauxiliary%2Fxcrate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Frun-pass%2Frfc-2126-extern-absolute-paths%2Fauxiliary%2Fxcrate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Frfc-2126-extern-absolute-paths%2Fauxiliary%2Fxcrate.rs?ref=b07e26e36e370b95c5fb3db418370d45a064d9ea", "patch": "@@ -0,0 +1,15 @@\n+// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+#[derive(Debug)]\n+pub struct S;\n+\n+#[derive(Debug)]\n+pub struct Z;"}, {"sha": "0fa125a3e503e3d600545c39301b0cdcfb1b7e43", "filename": "src/test/run-pass/rfc-2126-extern-absolute-paths/basic.rs", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Frun-pass%2Frfc-2126-extern-absolute-paths%2Fbasic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Frun-pass%2Frfc-2126-extern-absolute-paths%2Fbasic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Frfc-2126-extern-absolute-paths%2Fbasic.rs?ref=b07e26e36e370b95c5fb3db418370d45a064d9ea", "patch": "@@ -0,0 +1,31 @@\n+// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// aux-build:xcrate.rs\n+\n+#![feature(extern_absolute_paths)]\n+\n+use xcrate::Z;\n+\n+fn f() {\n+    use xcrate;\n+    use xcrate as ycrate;\n+    let s = xcrate::S;\n+    assert_eq!(format!(\"{:?}\", s), \"S\");\n+    let z = ycrate::Z;\n+    assert_eq!(format!(\"{:?}\", z), \"Z\");\n+}\n+\n+fn main() {\n+    let s = ::xcrate::S;\n+    assert_eq!(format!(\"{:?}\", s), \"S\");\n+    let z = Z;\n+    assert_eq!(format!(\"{:?}\", z), \"Z\");\n+}"}, {"sha": "40fdbf0bbdba6da225d7e962fe1c2a3ffdea59f5", "filename": "src/test/ui/feature-gate-extern_absolute_paths.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Fui%2Ffeature-gate-extern_absolute_paths.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Fui%2Ffeature-gate-extern_absolute_paths.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gate-extern_absolute_paths.rs?ref=b07e26e36e370b95c5fb3db418370d45a064d9ea", "patch": "@@ -0,0 +1,15 @@\n+// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+use core::default; //~ ERROR unresolved import `core`\n+\n+fn main() {\n+    let _: u8 = ::core::default::Default(); //~ ERROR failed to resolve\n+}"}, {"sha": "111cd06cb3c3e8d352927e86b80b20d9334d6c6d", "filename": "src/test/ui/feature-gate-extern_absolute_paths.stderr", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Fui%2Ffeature-gate-extern_absolute_paths.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b07e26e36e370b95c5fb3db418370d45a064d9ea/src%2Ftest%2Fui%2Ffeature-gate-extern_absolute_paths.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gate-extern_absolute_paths.stderr?ref=b07e26e36e370b95c5fb3db418370d45a064d9ea", "patch": "@@ -0,0 +1,14 @@\n+error[E0432]: unresolved import `core`\n+  --> $DIR/feature-gate-extern_absolute_paths.rs:11:5\n+   |\n+11 | use core::default; //~ ERROR unresolved import `core`\n+   |     ^^^^ Maybe a missing `extern crate core;`?\n+\n+error[E0433]: failed to resolve. Maybe a missing `extern crate core;`?\n+  --> $DIR/feature-gate-extern_absolute_paths.rs:14:19\n+   |\n+14 |     let _: u8 = ::core::default::Default(); //~ ERROR failed to resolve\n+   |                   ^^^^ Maybe a missing `extern crate core;`?\n+\n+error: aborting due to 2 previous errors\n+"}]}