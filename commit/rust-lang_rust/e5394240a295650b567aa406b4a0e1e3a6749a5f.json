{"sha": "e5394240a295650b567aa406b4a0e1e3a6749a5f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU1Mzk0MjQwYTI5NTY1MGI1NjdhYTQwNmI0YTBlMWUzYTY3NDlhNWY=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-05-14T00:42:32Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-05-14T00:42:32Z"}, "message": "Auto merge of #25208 - lfairy:version-hash, r=brson\n\nThe code takes a prefix of the MD5 hash of the version string.\r\n\r\nSince the hash command differs across GNU and BSD platforms, we scan for\r\nthe right one in the configure script.\r\n\r\nCloses #25007", "tree": {"sha": "6dc2325c3039db85303702ef5f68e810be5d065e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6dc2325c3039db85303702ef5f68e810be5d065e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e5394240a295650b567aa406b4a0e1e3a6749a5f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e5394240a295650b567aa406b4a0e1e3a6749a5f", "html_url": "https://github.com/rust-lang/rust/commit/e5394240a295650b567aa406b4a0e1e3a6749a5f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e5394240a295650b567aa406b4a0e1e3a6749a5f/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5a341ecfc985c190d8c359a8c995a094ef22ab9e", "url": "https://api.github.com/repos/rust-lang/rust/commits/5a341ecfc985c190d8c359a8c995a094ef22ab9e", "html_url": "https://github.com/rust-lang/rust/commit/5a341ecfc985c190d8c359a8c995a094ef22ab9e"}, {"sha": "2c0db5e331b2b15633fc9028cf019f6a2fe48a6f", "url": "https://api.github.com/repos/rust-lang/rust/commits/2c0db5e331b2b15633fc9028cf019f6a2fe48a6f", "html_url": "https://github.com/rust-lang/rust/commit/2c0db5e331b2b15633fc9028cf019f6a2fe48a6f"}], "stats": {"total": 22, "additions": 19, "deletions": 3}, "files": [{"sha": "4e763f7613977df5b5036b0d8406493d4e7ce93d", "filename": "configure", "status": "modified", "additions": 16, "deletions": 2, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/e5394240a295650b567aa406b4a0e1e3a6749a5f/configure", "raw_url": "https://github.com/rust-lang/rust/raw/e5394240a295650b567aa406b4a0e1e3a6749a5f/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=e5394240a295650b567aa406b4a0e1e3a6749a5f", "patch": "@@ -106,8 +106,8 @@ probe() {\n         T=$(command -v $P 2>&1)\n         if [ $? -eq 0 ]\n         then\n-            VER0=$($P --version 2>/dev/null | head -1 \\\n-                |  sed -e 's/[^0-9]*\\([vV]\\?[0-9.]\\+[^ ]*\\).*/\\1/' )\n+            VER0=$($P --version 2>/dev/null \\\n+                |  grep -o '[vV]\\?[0-9][0-9.][a-z0-9.-]*' | head -1 )\n             if [ $? -eq 0 -a \"x${VER0}\" != \"x\" ]\n             then\n               VER=\"($VER0)\"\n@@ -711,6 +711,20 @@ else\n     probe_need CFG_GIT     git\n fi\n \n+# Use `md5sum` on GNU platforms, or `md5 -q` on BSD\n+probe CFG_MD5              md5\n+probe CFG_MD5SUM           md5sum\n+if [ -n \"$CFG_MD5\" ]\n+then\n+    CFG_HASH_COMMAND=\"$CFG_MD5 -q | head -c 8\"\n+elif [ -n \"$CFG_MD5SUM\" ]\n+then\n+    CFG_HASH_COMMAND=\"$CFG_MD5SUM | head -c 8\"\n+else\n+    err 'could not find one of: md5 md5sum'\n+fi\n+putvar CFG_HASH_COMMAND\n+\n probe CFG_CLANG            clang++\n probe CFG_CCACHE           ccache\n probe CFG_GCC              gcc"}, {"sha": "964153e4494d3f1000b0add0f16758ec5dd5e9f5", "filename": "mk/main.mk", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/e5394240a295650b567aa406b4a0e1e3a6749a5f/mk%2Fmain.mk", "raw_url": "https://github.com/rust-lang/rust/raw/e5394240a295650b567aa406b4a0e1e3a6749a5f/mk%2Fmain.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fmain.mk?ref=e5394240a295650b567aa406b4a0e1e3a6749a5f", "patch": "@@ -20,7 +20,9 @@ CFG_RELEASE_NUM=1.1.0\n # versions (section 9)\n CFG_PRERELEASE_VERSION=.1\n \n-CFG_FILENAME_EXTRA=4e7c5e5c\n+# Append a version-dependent hash to each library, so we can install different\n+# versions in the same place\n+CFG_FILENAME_EXTRA=$(shell printf '%s' $(CFG_RELEASE) | $(CFG_HASH_COMMAND))\n \n ifeq ($(CFG_RELEASE_CHANNEL),stable)\n # This is the normal semver version string, e.g. \"0.12.0\", \"0.12.0-nightly\""}]}