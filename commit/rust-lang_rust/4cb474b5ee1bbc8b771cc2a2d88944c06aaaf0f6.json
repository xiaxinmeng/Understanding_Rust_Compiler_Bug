{"sha": "4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRjYjQ3NGI1ZWUxYmJjOGI3NzFjYzJhMmQ4ODk0NGMwNmFhYWYwZjY=", "commit": {"author": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2017-11-24T01:07:37Z"}, "committer": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2017-11-24T01:07:37Z"}, "message": "Remove `force_format_strings` in favour of `format_strings`", "tree": {"sha": "39e30ca0e75cbc04c869580105f2c12acc5d0cce", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/39e30ca0e75cbc04c869580105f2c12acc5d0cce"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6", "html_url": "https://github.com/rust-lang/rust/commit/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8a7b6b88068fd2e1d06d9a16444783e07f93316a", "url": "https://api.github.com/repos/rust-lang/rust/commits/8a7b6b88068fd2e1d06d9a16444783e07f93316a", "html_url": "https://github.com/rust-lang/rust/commit/8a7b6b88068fd2e1d06d9a16444783e07f93316a"}], "stats": {"total": 87, "additions": 4, "deletions": 83}, "files": [{"sha": "946689e940bb2d0aca840d3acad2e6b5d6c28c25", "filename": "Configurations.md", "status": "modified", "additions": 1, "deletions": 12, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6/Configurations.md", "raw_url": "https://github.com/rust-lang/rust/raw/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6/Configurations.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Configurations.md?ref=4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6", "patch": "@@ -1017,17 +1017,6 @@ extern {\n }\n ```\n \n-## `force_format_strings`\n-\n-Always format string literals\n-\n-- **Default value**: `false`\n-- **Possible values**: `true`, `false`\n-\n-See [`format_strings`](#format_strings).\n-\n-See also [`max_width`](#max_width).\n-\n ## `format_strings`\n \n Format string literals where necessary\n@@ -1049,7 +1038,7 @@ let lorem =\n      adipiscing elit lorem ipsum dolor sit\";\n ```\n \n-See also [`force_format_strings`](#force_format_strings), [`max_width`](#max_width).\n+See also [`max_width`](#max_width).\n \n ## `hard_tabs`\n "}, {"sha": "75fff0131f46d5892872498e4ab4ff4af5805b5b", "filename": "src/config.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6/src%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6/src%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconfig.rs?ref=4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6", "patch": "@@ -584,7 +584,6 @@ create_config! {\n                                                 expressions. A value of zero means always break \\\n                                                 if-else expressions.\";\n     format_strings: bool, false, false, \"Format string literals where necessary\";\n-    force_format_strings: bool, false, false, \"Always format string literals\";\n     hard_tabs: bool, false, false, \"Use tab characters for indentation, spaces for alignment\";\n     wrap_comments: bool, false, false, \"Break comments to fit on the line\";\n     comment_width: usize, 80, false,"}, {"sha": "ad8cb25b53f6f0abbcb8702e86353a9346f83178", "filename": "src/expr.rs", "status": "modified", "additions": 1, "deletions": 30, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6/src%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6/src%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fexpr.rs?ref=4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6", "patch": "@@ -1739,7 +1739,7 @@ pub fn rewrite_literal(context: &RewriteContext, l: &ast::Lit, shape: Shape) ->\n fn rewrite_string_lit(context: &RewriteContext, span: Span, shape: Shape) -> Option<String> {\n     let string_lit = context.snippet(span);\n \n-    if !context.config.format_strings() && !context.config.force_format_strings() {\n+    if !context.config.format_strings() {\n         if string_lit\n             .lines()\n             .rev()\n@@ -1767,12 +1767,6 @@ fn rewrite_string_lit(context: &RewriteContext, span: Span, shape: Shape) -> Opt\n         }\n     }\n \n-    if !context.config.force_format_strings()\n-        && !string_requires_rewrite(context, span, &string_lit, shape)\n-    {\n-        return wrap_str(string_lit, context.config.max_width(), shape);\n-    }\n-\n     // Remove the quote characters.\n     let str_lit = &string_lit[1..string_lit.len() - 1];\n \n@@ -1783,29 +1777,6 @@ fn rewrite_string_lit(context: &RewriteContext, span: Span, shape: Shape) -> Opt\n     )\n }\n \n-fn string_requires_rewrite(\n-    context: &RewriteContext,\n-    span: Span,\n-    string: &str,\n-    shape: Shape,\n-) -> bool {\n-    if context.codemap.lookup_char_pos(span.lo()).col.0 != shape.indent.width() {\n-        return true;\n-    }\n-\n-    for (i, line) in string.lines().enumerate() {\n-        if i == 0 {\n-            if line.len() > shape.width {\n-                return true;\n-            }\n-        } else if line.len() > shape.width + shape.indent.width() {\n-            return true;\n-        }\n-    }\n-\n-    false\n-}\n-\n pub fn rewrite_call(\n     context: &RewriteContext,\n     callee: &str,"}, {"sha": "49f32c557b3b6cc1d6b30b29d14b92e97ad0b804", "filename": "tests/source/configs-force_format_strings-false.rs", "status": "removed", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/8a7b6b88068fd2e1d06d9a16444783e07f93316a/tests%2Fsource%2Fconfigs-force_format_strings-false.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8a7b6b88068fd2e1d06d9a16444783e07f93316a/tests%2Fsource%2Fconfigs-force_format_strings-false.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fconfigs-force_format_strings-false.rs?ref=8a7b6b88068fd2e1d06d9a16444783e07f93316a", "patch": "@@ -1,9 +0,0 @@\n-// rustfmt-force_format_strings: false\n-// rustfmt-format_strings: false\n-// rustfmt-max_width: 50\n-// rustfmt-error_on_line_overflow: false\n-// Force format strings\n-\n-fn main() {\n-    let lorem = \"ipsum dolor sit amet consectetur adipiscing elit lorem ipsum dolor sit\";\n-}"}, {"sha": "7a87bed4d15dcf1b79edbdd03b5f5a69dfed3fef", "filename": "tests/source/configs-force_format_strings-true.rs", "status": "removed", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/8a7b6b88068fd2e1d06d9a16444783e07f93316a/tests%2Fsource%2Fconfigs-force_format_strings-true.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8a7b6b88068fd2e1d06d9a16444783e07f93316a/tests%2Fsource%2Fconfigs-force_format_strings-true.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fconfigs-force_format_strings-true.rs?ref=8a7b6b88068fd2e1d06d9a16444783e07f93316a", "patch": "@@ -1,8 +0,0 @@\n-// rustfmt-force_format_strings: true\n-// rustfmt-format_strings: false\n-// rustfmt-max_width: 50\n-// Force format strings\n-\n-fn main() {\n-    let lorem = \"ipsum dolor sit amet consectetur adipiscing elit lorem ipsum dolor sit\";\n-}"}, {"sha": "927ada0ffb2e0d5ce3a06d4a67cb40eb50c8e9ad", "filename": "tests/source/long-match-arms-brace-newline.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6/tests%2Fsource%2Flong-match-arms-brace-newline.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6/tests%2Fsource%2Flong-match-arms-brace-newline.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Flong-match-arms-brace-newline.rs?ref=4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6", "patch": "@@ -1,5 +1,4 @@\n // rustfmt-format_strings: true\n-// rustfmt-force_format_strings: true\n // rustfmt-max_width: 80\n // rustfmt-control_brace_style: AlwaysNextLine\n "}, {"sha": "e86f65f9f525b7af48be88908db8bf0befd7c526", "filename": "tests/source/string-lit.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6/tests%2Fsource%2Fstring-lit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6/tests%2Fsource%2Fstring-lit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fstring-lit.rs?ref=4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6", "patch": "@@ -1,4 +1,4 @@\n-// rustfmt-force_format_strings: true\n+// rustfmt-format_strings: true\n // rustfmt-error_on_line_overflow: false\n // Long string literals\n "}, {"sha": "49f32c557b3b6cc1d6b30b29d14b92e97ad0b804", "filename": "tests/target/configs-force_format_strings-false.rs", "status": "removed", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/8a7b6b88068fd2e1d06d9a16444783e07f93316a/tests%2Ftarget%2Fconfigs-force_format_strings-false.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8a7b6b88068fd2e1d06d9a16444783e07f93316a/tests%2Ftarget%2Fconfigs-force_format_strings-false.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs-force_format_strings-false.rs?ref=8a7b6b88068fd2e1d06d9a16444783e07f93316a", "patch": "@@ -1,9 +0,0 @@\n-// rustfmt-force_format_strings: false\n-// rustfmt-format_strings: false\n-// rustfmt-max_width: 50\n-// rustfmt-error_on_line_overflow: false\n-// Force format strings\n-\n-fn main() {\n-    let lorem = \"ipsum dolor sit amet consectetur adipiscing elit lorem ipsum dolor sit\";\n-}"}, {"sha": "49ba3e7d46c3e5426b95239d0fd33b811a600551", "filename": "tests/target/configs-force_format_strings-true.rs", "status": "removed", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/8a7b6b88068fd2e1d06d9a16444783e07f93316a/tests%2Ftarget%2Fconfigs-force_format_strings-true.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8a7b6b88068fd2e1d06d9a16444783e07f93316a/tests%2Ftarget%2Fconfigs-force_format_strings-true.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs-force_format_strings-true.rs?ref=8a7b6b88068fd2e1d06d9a16444783e07f93316a", "patch": "@@ -1,10 +0,0 @@\n-// rustfmt-force_format_strings: true\n-// rustfmt-format_strings: false\n-// rustfmt-max_width: 50\n-// Force format strings\n-\n-fn main() {\n-    let lorem = \"ipsum dolor sit amet \\\n-                 consectetur adipiscing elit \\\n-                 lorem ipsum dolor sit\";\n-}"}, {"sha": "aeb384e7203edac6d865a368e3feb784a05717db", "filename": "tests/target/long-match-arms-brace-newline.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6/tests%2Ftarget%2Flong-match-arms-brace-newline.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6/tests%2Ftarget%2Flong-match-arms-brace-newline.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Flong-match-arms-brace-newline.rs?ref=4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6", "patch": "@@ -1,5 +1,4 @@\n // rustfmt-format_strings: true\n-// rustfmt-force_format_strings: true\n // rustfmt-max_width: 80\n // rustfmt-control_brace_style: AlwaysNextLine\n "}, {"sha": "f60002ac618d3277c4e0d14b2dcc6528c4571a81", "filename": "tests/target/string-lit.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6/tests%2Ftarget%2Fstring-lit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6/tests%2Ftarget%2Fstring-lit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fstring-lit.rs?ref=4cb474b5ee1bbc8b771cc2a2d88944c06aaaf0f6", "patch": "@@ -1,4 +1,4 @@\n-// rustfmt-force_format_strings: true\n+// rustfmt-format_strings: true\n // rustfmt-error_on_line_overflow: false\n // Long string literals\n "}]}