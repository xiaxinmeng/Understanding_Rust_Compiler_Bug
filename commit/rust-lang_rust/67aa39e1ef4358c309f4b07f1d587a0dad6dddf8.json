{"sha": "67aa39e1ef4358c309f4b07f1d587a0dad6dddf8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY3YWEzOWUxZWY0MzU4YzMwOWY0YjA3ZjFkNTg3YTBkYWQ2ZGRkZjg=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2010-09-12T08:05:56Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2010-09-12T08:05:56Z"}, "message": "Fix a leak when box types are used via type descriptors.", "tree": {"sha": "624b28749ce5e58e5aa1bc559be2c9e24aa994fa", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/624b28749ce5e58e5aa1bc559be2c9e24aa994fa"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/67aa39e1ef4358c309f4b07f1d587a0dad6dddf8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/67aa39e1ef4358c309f4b07f1d587a0dad6dddf8", "html_url": "https://github.com/rust-lang/rust/commit/67aa39e1ef4358c309f4b07f1d587a0dad6dddf8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/67aa39e1ef4358c309f4b07f1d587a0dad6dddf8/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a493350eb5ab38ba8a6563f3eb4a090d257b0d3a", "url": "https://api.github.com/repos/rust-lang/rust/commits/a493350eb5ab38ba8a6563f3eb4a090d257b0d3a", "html_url": "https://github.com/rust-lang/rust/commit/a493350eb5ab38ba8a6563f3eb4a090d257b0d3a"}], "stats": {"total": 12, "additions": 10, "deletions": 2}, "files": [{"sha": "56fe9b98b38e1cecd7813846c684153d4dd5b647", "filename": "src/Makefile", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/67aa39e1ef4358c309f4b07f1d587a0dad6dddf8/src%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/67aa39e1ef4358c309f4b07f1d587a0dad6dddf8/src%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2FMakefile?ref=67aa39e1ef4358c309f4b07f1d587a0dad6dddf8", "patch": "@@ -488,6 +488,7 @@ TEST_XFAILS_LLVM := $(TASK_XFAILS) \\\n                       lazy-and-or.rs \\\n                       lazy-init.rs \\\n                       lazychan.rs \\\n+                      leak-box-as-tydesc.rs \\\n                       lib-deque.rs \\\n                       lib-int.rs \\\n                       lib-io.rs \\"}, {"sha": "ad0d6445d70ca3843c03aba1fc32e1dbf10b2f17", "filename": "src/boot/me/trans.ml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/67aa39e1ef4358c309f4b07f1d587a0dad6dddf8/src%2Fboot%2Fme%2Ftrans.ml", "raw_url": "https://github.com/rust-lang/rust/raw/67aa39e1ef4358c309f4b07f1d587a0dad6dddf8/src%2Fboot%2Fme%2Ftrans.ml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fboot%2Fme%2Ftrans.ml?ref=67aa39e1ef4358c309f4b07f1d587a0dad6dddf8", "patch": "@@ -2562,8 +2562,8 @@ let trans_visitor\n \n   and get_tydesc (idopt:node_id option) (ty:Ast.ty) : Il.cell =\n     log cx \"getting tydesc for %a\" Ast.sprintf_ty ty;\n-    let (ty, mut) = simplified_ty_innermost_was_mutable ty in\n-    match ty with\n+    let (ty', mut) = simplified_ty_innermost_was_mutable ty in\n+    match ty' with\n         Ast.TY_param (idx, _) ->\n           (get_ty_param_in_current_frame idx)\n       | t when has_parametric_types t ->"}, {"sha": "7da40cfe9facec80760de199da6a37997edbb4a5", "filename": "src/test/run-pass/leak-box-as-tydesc.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/67aa39e1ef4358c309f4b07f1d587a0dad6dddf8/src%2Ftest%2Frun-pass%2Fleak-box-as-tydesc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/67aa39e1ef4358c309f4b07f1d587a0dad6dddf8/src%2Ftest%2Frun-pass%2Fleak-box-as-tydesc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fleak-box-as-tydesc.rs?ref=67aa39e1ef4358c309f4b07f1d587a0dad6dddf8", "patch": "@@ -0,0 +1,7 @@\n+fn leaky[T](T t) {\n+}\n+\n+fn main() {\n+  auto x = @10;\n+  leaky[@int](x);\n+}\n\\ No newline at end of file"}]}