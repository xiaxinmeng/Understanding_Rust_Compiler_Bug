{"sha": "d5e5d22bdb0299950d38c24d2c1503addf4f898d", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ1ZTVkMjJiZGIwMjk5OTUwZDM4YzI0ZDJjMTUwM2FkZGY0Zjg5OGQ=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-10-06T05:46:34Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-10-06T05:46:34Z"}, "message": "auto merge of #9738 : catamorphism/rust/rustpkg-test-docs-need-to-submit, r=alexcrichton\n\nr? anybody Talk about `rustpkg test` in the tutorial, and update its usage message.\r\n\r\n@steveklabnik, it would be great if you could look this over :-)", "tree": {"sha": "ecfeec220c730550d95c9afa19dc6717e734a5ca", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ecfeec220c730550d95c9afa19dc6717e734a5ca"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d5e5d22bdb0299950d38c24d2c1503addf4f898d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d5e5d22bdb0299950d38c24d2c1503addf4f898d", "html_url": "https://github.com/rust-lang/rust/commit/d5e5d22bdb0299950d38c24d2c1503addf4f898d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d5e5d22bdb0299950d38c24d2c1503addf4f898d/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0114ab631dadaa05f04b5bad89cfc08e673b8c4f", "url": "https://api.github.com/repos/rust-lang/rust/commits/0114ab631dadaa05f04b5bad89cfc08e673b8c4f", "html_url": "https://github.com/rust-lang/rust/commit/0114ab631dadaa05f04b5bad89cfc08e673b8c4f"}, {"sha": "8ba148b295bfaf6198ce4ce34c9eb6b93346c092", "url": "https://api.github.com/repos/rust-lang/rust/commits/8ba148b295bfaf6198ce4ce34c9eb6b93346c092", "html_url": "https://github.com/rust-lang/rust/commit/8ba148b295bfaf6198ce4ce34c9eb6b93346c092"}], "stats": {"total": 54, "additions": 51, "deletions": 3}, "files": [{"sha": "fb15e0c0cf298e6785e4b6c474f26adf7f4d740c", "filename": "doc/tutorial-rustpkg.md", "status": "modified", "additions": 48, "deletions": 0, "changes": 48, "blob_url": "https://github.com/rust-lang/rust/blob/d5e5d22bdb0299950d38c24d2c1503addf4f898d/doc%2Ftutorial-rustpkg.md", "raw_url": "https://github.com/rust-lang/rust/raw/d5e5d22bdb0299950d38c24d2c1503addf4f898d/doc%2Ftutorial-rustpkg.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/doc%2Ftutorial-rustpkg.md?ref=d5e5d22bdb0299950d38c24d2c1503addf4f898d", "patch": "@@ -206,6 +206,54 @@ note: Installed package github.com/YOUR_USERNAME/hello-0.1 to /home/yourusername\n \n That's it!\n \n+# Testing your Package\n+\n+Testing your package is simple as well. First, let's change `src/hello/lib.rs` to contain\n+a function that can be sensibly tested:\n+\n+~~~\n+#[desc = \"A Rust package for determining whether unsigned integers are even.\"];\n+#[license = \"MIT\"];\n+\n+pub fn is_even(i: uint) -> bool {\n+\ti % 2 == 0\n+}\n+~~~\n+\n+Once you've edited `lib.rs`, you can create a second crate file, `src/hello/test.rs`,\n+to put tests in:\n+\n+~~~\n+#[license = \"MIT\"];\n+extern mod hello;\n+use hello::is_even;\n+\n+#[test]\n+fn test_is_even() {\n+   assert!(is_even(0));\n+   assert!(!is_even(1));\n+   assert!(is_even(2));\t\n+}\n+~~~\n+\n+Note that you have to import the crate you just created in `lib.rs` with the\n+`extern mod hello` directive. That's because you're putting the tests in a different\n+crate from the main library that you created.\n+\n+Now, you can use the `rustpkg test` command to build this test crate (and anything else\n+it depends on) and run the tests, all in one step:\n+\n+~~~ {.notrust}\n+$ rustpkg test hello\n+WARNING: The Rust package manager is experimental and may be unstable\n+note: Installed package hello-0.1 to /Users/tjc/.rust\n+\n+running 1 test\n+test test_is_even ... ok\n+\n+test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured\n+~~~\n+\n # More resources\n \n There's a lot more going on with `rustpkg`, this is just to get you started."}, {"sha": "4b10451c81363dbee8596fdbc22163184ad03109", "filename": "src/librustpkg/usage.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d5e5d22bdb0299950d38c24d2c1503addf4f898d/src%2Flibrustpkg%2Fusage.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d5e5d22bdb0299950d38c24d2c1503addf4f898d/src%2Flibrustpkg%2Fusage.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Fusage.rs?ref=d5e5d22bdb0299950d38c24d2c1503addf4f898d", "patch": "@@ -141,9 +141,9 @@ information.\");\n pub fn test() {\n     io::println(\"rustpkg [options..] test\n \n-Build all targets described in the package script in the current directory\n-with the test flag. The test bootstraps will be run afterwards and the output\n-and exit code will be redirected.\n+Build all test crates in the current directory with the test flag.\n+Then, run all the resulting test executables, redirecting the output\n+and exit code.\n \n Options:\n     -c, --cfg      Pass a cfg flag to the package script\");"}]}