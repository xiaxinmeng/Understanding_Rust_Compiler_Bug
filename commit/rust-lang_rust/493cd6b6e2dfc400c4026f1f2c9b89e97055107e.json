{"sha": "493cd6b6e2dfc400c4026f1f2c9b89e97055107e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ5M2NkNmI2ZTJkZmM0MDBjNDAyNmYxZjJjOWI4OWU5NzA1NTEwN2U=", "commit": {"author": {"name": "Robin Kruppe", "email": "robin.kruppe@gmail.com", "date": "2017-05-27T18:13:32Z"}, "committer": {"name": "Robin Kruppe", "email": "robin.kruppe@gmail.com", "date": "2017-05-27T19:08:13Z"}, "message": "Reduce API surface of rustc_trans\n\nMark various items and fields as private or pub(crate), and remove a function that turns out to be unused.\nThese are not used anywhere in-tree, but I guess it's a [breaking-change] for plugins.", "tree": {"sha": "a64721216e91b2668cd90f07d8c00b680addce2d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a64721216e91b2668cd90f07d8c00b680addce2d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/493cd6b6e2dfc400c4026f1f2c9b89e97055107e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/493cd6b6e2dfc400c4026f1f2c9b89e97055107e", "html_url": "https://github.com/rust-lang/rust/commit/493cd6b6e2dfc400c4026f1f2c9b89e97055107e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/493cd6b6e2dfc400c4026f1f2c9b89e97055107e/comments", "author": null, "committer": null, "parents": [{"sha": "557967766be6139bd747ab2c3dc56ff0c9b8852a", "url": "https://api.github.com/repos/rust-lang/rust/commits/557967766be6139bd747ab2c3dc56ff0c9b8852a", "html_url": "https://github.com/rust-lang/rust/commit/557967766be6139bd747ab2c3dc56ff0c9b8852a"}], "stats": {"total": 39, "additions": 13, "deletions": 26}, "files": [{"sha": "b5ef4aac34c89586436a73ade3cff6f517807bb5", "filename": "src/librustc_trans/assert_module_sources.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/493cd6b6e2dfc400c4026f1f2c9b89e97055107e/src%2Flibrustc_trans%2Fassert_module_sources.rs", "raw_url": "https://github.com/rust-lang/rust/raw/493cd6b6e2dfc400c4026f1f2c9b89e97055107e/src%2Flibrustc_trans%2Fassert_module_sources.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fassert_module_sources.rs?ref=493cd6b6e2dfc400c4026f1f2c9b89e97055107e", "patch": "@@ -40,8 +40,8 @@ const CFG: &'static str = \"cfg\";\n #[derive(Debug, PartialEq)]\n enum Disposition { Reused, Translated }\n \n-pub fn assert_module_sources<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n-                                       modules: &[ModuleTranslation]) {\n+pub(crate) fn assert_module_sources<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n+                                              modules: &[ModuleTranslation]) {\n     let _ignore = tcx.dep_graph.in_ignore();\n \n     if tcx.sess.opts.incremental.is_none() {"}, {"sha": "8e14335ceacb9950a2d8ffe9cddc52114db062bc", "filename": "src/librustc_trans/back/symbol_names.rs", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/493cd6b6e2dfc400c4026f1f2c9b89e97055107e/src%2Flibrustc_trans%2Fback%2Fsymbol_names.rs", "raw_url": "https://github.com/rust-lang/rust/raw/493cd6b6e2dfc400c4026f1f2c9b89e97055107e/src%2Flibrustc_trans%2Fback%2Fsymbol_names.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fback%2Fsymbol_names.rs?ref=493cd6b6e2dfc400c4026f1f2c9b89e97055107e", "patch": "@@ -348,16 +348,6 @@ impl ItemPathBuffer for SymbolPathBuffer {\n     }\n }\n \n-pub fn exported_name_from_type_and_prefix<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n-                                                    t: Ty<'tcx>,\n-                                                    prefix: &str)\n-                                                    -> String {\n-    let hash = get_symbol_hash(tcx, None, t, None);\n-    let mut buffer = SymbolPathBuffer::new();\n-    buffer.push(prefix);\n-    buffer.finish(hash)\n-}\n-\n // Name sanitation. LLVM will happily accept identifiers with weird names, but\n // gas doesn't!\n // gas accepts the following characters in symbols: a-z, A-Z, 0-9, ., _, $"}, {"sha": "cb3bc7bd200e2fcd5bc3175a965efc1b1f73c806", "filename": "src/librustc_trans/lib.rs", "status": "modified", "additions": 11, "deletions": 14, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/493cd6b6e2dfc400c4026f1f2c9b89e97055107e/src%2Flibrustc_trans%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/493cd6b6e2dfc400c4026f1f2c9b89e97055107e/src%2Flibrustc_trans%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Flib.rs?ref=493cd6b6e2dfc400c4026f1f2c9b89e97055107e", "patch": "@@ -63,10 +63,9 @@ extern crate syntax_pos;\n extern crate rustc_errors as errors;\n extern crate serialize;\n \n-pub use rustc::session;\n-pub use rustc::middle;\n-pub use rustc::lint;\n-pub use rustc::util;\n+use rustc::session;\n+use rustc::middle;\n+use rustc::util;\n \n pub use base::trans_crate;\n pub use back::symbol_names::provide;\n@@ -75,20 +74,18 @@ pub use metadata::LlvmMetadataLoader;\n pub use llvm_util::{init, target_features, print_version, print_passes, print, enable_llvm_debug};\n \n pub mod back {\n-    pub use rustc::hir::svh;\n-\n-    pub mod archive;\n-    pub mod linker;\n+    mod archive;\n+    pub(crate) mod linker;\n     pub mod link;\n-    pub mod lto;\n-    pub mod symbol_export;\n-    pub mod symbol_names;\n+    mod lto;\n+    pub(crate) mod symbol_export;\n+    pub(crate) mod symbol_names;\n     pub mod write;\n-    pub mod msvc;\n-    pub mod rpath;\n+    mod msvc;\n+    mod rpath;\n }\n \n-pub mod diagnostics;\n+mod diagnostics;\n \n mod abi;\n mod adt;"}]}