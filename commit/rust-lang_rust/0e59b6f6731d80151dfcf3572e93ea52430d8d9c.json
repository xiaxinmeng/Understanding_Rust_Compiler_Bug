{"sha": "0e59b6f6731d80151dfcf3572e93ea52430d8d9c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBlNTliNmY2NzMxZDgwMTUxZGZjZjM1NzJlOTNlYTUyNDMwZDhkOWM=", "commit": {"author": {"name": "Aaron Hill", "email": "aa1ronham@gmail.com", "date": "2020-10-03T16:56:32Z"}, "committer": {"name": "Aaron Hill", "email": "aa1ronham@gmail.com", "date": "2020-10-04T16:06:51Z"}, "message": "Merge `fs` and `fs_libc` tests", "tree": {"sha": "c800030b4a9559140811b97310ec338f05804a0d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c800030b4a9559140811b97310ec338f05804a0d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0e59b6f6731d80151dfcf3572e93ea52430d8d9c", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE7J9Gc3TfBwj2K399tAh+UQ6YsWQFAl958xsACgkQtAh+UQ6Y\nsWQ6CQ//RQ29gwbRWkmWgTc7mdgTif5EYixjkbO9ySR1slhimXgfWhyRs7fYUgY/\n5R6CxOBitT1j+kpuvSkKzuPxzAnvJeqOIGRXjtCX6ULLYKWn88pbU1uxhmKTNrbX\njTZsTr6AaJBQ6gTuxcL4u9DBDGIPh1GImTmSEYBDqIFNo8jscSijoiwusK/wh/hf\nmyEOT3hSScEylQ9lAEzKsLs9ntnkatHKO4BfVtxjhlkIxh2YiAA1kADr6RhPTDyW\n7b8LS8/voM3JnEIj4uo3XT0fZ53kcKzVypidJL7b+3lPp3bztBdMZBQMlVeVIXMU\nDQhN39XlKAvB2XUB9N1BE51uR57yMwPA0VKqBAsB/T+iydQUvsoTuM29H2aYtL8f\n94lmFN4kCkVQw2tMtpGJmyHKk830inJ23tGsMf2YlUu2wyosWFtBrPe/6yT8JHZO\nTXY0dZ+32qc/np4BhJjn/8eDdtKDbkKtldZPZy1e9OkFtQC4VlJjOQkn6A6K1qHG\nd68rIt6cLveNSsMVwdumWG0uiqX9cvl1P6TnmQYVl+0vNlARPLgs8Em5OJ7YwkcJ\nTXsLJD6jvKMA1umLeSvxo2IYU52B/P03hEQsNwL89XrOpYNDCoxxrfinAQKGCQ6U\n2mDd7Xowuh8fPN5Wt5VqZ3YYTOzAgNkmOYKOXsvn9WDYfC/RLhs=\n=8BaW\n-----END PGP SIGNATURE-----", "payload": "tree c800030b4a9559140811b97310ec338f05804a0d\nparent 8b89c7e1da6231b998addb8d0dab43f68c1975f0\nauthor Aaron Hill <aa1ronham@gmail.com> 1601744192 -0400\ncommitter Aaron Hill <aa1ronham@gmail.com> 1601827611 -0400\n\nMerge `fs` and `fs_libc` tests\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0e59b6f6731d80151dfcf3572e93ea52430d8d9c", "html_url": "https://github.com/rust-lang/rust/commit/0e59b6f6731d80151dfcf3572e93ea52430d8d9c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0e59b6f6731d80151dfcf3572e93ea52430d8d9c/comments", "author": {"login": "Aaron1011", "id": 1408859, "node_id": "MDQ6VXNlcjE0MDg4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aaron1011", "html_url": "https://github.com/Aaron1011", "followers_url": "https://api.github.com/users/Aaron1011/followers", "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}", "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions", "organizations_url": "https://api.github.com/users/Aaron1011/orgs", "repos_url": "https://api.github.com/users/Aaron1011/repos", "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Aaron1011/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Aaron1011", "id": 1408859, "node_id": "MDQ6VXNlcjE0MDg4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aaron1011", "html_url": "https://github.com/Aaron1011", "followers_url": "https://api.github.com/users/Aaron1011/followers", "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}", "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions", "organizations_url": "https://api.github.com/users/Aaron1011/orgs", "repos_url": "https://api.github.com/users/Aaron1011/repos", "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Aaron1011/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8b89c7e1da6231b998addb8d0dab43f68c1975f0", "url": "https://api.github.com/repos/rust-lang/rust/commits/8b89c7e1da6231b998addb8d0dab43f68c1975f0", "html_url": "https://github.com/rust-lang/rust/commit/8b89c7e1da6231b998addb8d0dab43f68c1975f0"}], "stats": {"total": 31, "additions": 11, "deletions": 20}, "files": [{"sha": "ca3c6a6d29171b15a4ada6d9e70ae0436d5c677b", "filename": "tests/run-pass/fs.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/0e59b6f6731d80151dfcf3572e93ea52430d8d9c/tests%2Frun-pass%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0e59b6f6731d80151dfcf3572e93ea52430d8d9c/tests%2Frun-pass%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Ffs.rs?ref=0e59b6f6731d80151dfcf3572e93ea52430d8d9c", "patch": "@@ -25,6 +25,7 @@ fn main() {\n     test_errors();\n     test_rename();\n     test_directory();\n+    test_dup_stdout_stderr();\n }\n \n fn tmp() -> PathBuf {\n@@ -335,3 +336,13 @@ fn test_directory() {\n     // Reading the metadata of a non-existent directory should fail with a \"not found\" error.\n     assert_eq!(ErrorKind::NotFound, check_metadata(&[], &dir_path).unwrap_err().kind());\n }\n+\n+fn test_dup_stdout_stderr() {\n+    let bytes = b\"hello dup fd\\n\";\n+    unsafe {\n+        let new_stdout = libc::fcntl(1, libc::F_DUPFD, 0);\n+        let new_stderr = libc::fcntl(2, libc::F_DUPFD, 0);\n+        libc::write(new_stdout, bytes.as_ptr() as *const libc::c_void, bytes.len());\n+        libc::write(new_stderr, bytes.as_ptr() as *const libc::c_void, bytes.len());\n+    }\n+}"}, {"sha": "b6fa69e3d5d2e8c4626550dcb2c413f91dfcd156", "filename": "tests/run-pass/fs.stderr", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/0e59b6f6731d80151dfcf3572e93ea52430d8d9c/tests%2Frun-pass%2Ffs.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0e59b6f6731d80151dfcf3572e93ea52430d8d9c/tests%2Frun-pass%2Ffs.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Ffs.stderr?ref=0e59b6f6731d80151dfcf3572e93ea52430d8d9c", "previous_filename": "tests/run-pass/fs_libc.stderr"}, {"sha": "b6fa69e3d5d2e8c4626550dcb2c413f91dfcd156", "filename": "tests/run-pass/fs.stdout", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/0e59b6f6731d80151dfcf3572e93ea52430d8d9c/tests%2Frun-pass%2Ffs.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/0e59b6f6731d80151dfcf3572e93ea52430d8d9c/tests%2Frun-pass%2Ffs.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Ffs.stdout?ref=0e59b6f6731d80151dfcf3572e93ea52430d8d9c", "previous_filename": "tests/run-pass/fs_libc.stdout"}, {"sha": "e3deb7a5bcd8a60509b02d072c9e6513c96fe8b2", "filename": "tests/run-pass/fs_libc.rs", "status": "removed", "additions": 0, "deletions": 20, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/8b89c7e1da6231b998addb8d0dab43f68c1975f0/tests%2Frun-pass%2Ffs_libc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8b89c7e1da6231b998addb8d0dab43f68c1975f0/tests%2Frun-pass%2Ffs_libc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Ffs_libc.rs?ref=8b89c7e1da6231b998addb8d0dab43f68c1975f0", "patch": "@@ -1,20 +0,0 @@\n-// ignore-windows\n-// compile-flags: -Zmiri-disable-isolation\n-\n-#![feature(rustc_private)]\n-\n-extern crate libc;\n-\n-fn main() {\n-    dup_stdout_stderr_test();\n-}\n-\n-fn dup_stdout_stderr_test() {\n-    let bytes = b\"hello dup fd\\n\";\n-    unsafe {\n-        let new_stdout = libc::fcntl(1, libc::F_DUPFD, 0);\n-        let new_stderr = libc::fcntl(2, libc::F_DUPFD, 0);\n-        libc::write(new_stdout, bytes.as_ptr() as *const libc::c_void, bytes.len());\n-        libc::write(new_stderr, bytes.as_ptr() as *const libc::c_void, bytes.len());\n-    }\n-}"}]}