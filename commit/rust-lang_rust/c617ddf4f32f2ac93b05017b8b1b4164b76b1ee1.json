{"sha": "c617ddf4f32f2ac93b05017b8b1b4164b76b1ee1", "node_id": "C_kwDOAAsO6NoAKGM2MTdkZGY0ZjMyZjJhYzkzYjA1MDE3YjhiMWI0MTY0Yjc2YjFlZTE", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2023-04-11T03:18:49Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-04-11T03:18:49Z"}, "message": "Rollup merge of #109527 - lnicola:rust-gdb-substitute-path, r=cuviper\n\nSet up standard library path substitution in rust-gdb and gdbgui\n\nFixes #62945\n\n---\n\nOnly lightly tested (in release mode, where the paths are a bit of a mess) because my `gdb` appears to crash with `internal-error: inside_main_func: Assertion 'block != nullptr' failed.` and I don't have `gdbgui`. Please review carefully my shell syntax.\n\nThere's also `rust-lldb`, but I don't know the equivalent for it.", "tree": {"sha": "190a809c1458fe49d6f4e1a2ad62d1a718f7b1d7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/190a809c1458fe49d6f4e1a2ad62d1a718f7b1d7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c617ddf4f32f2ac93b05017b8b1b4164b76b1ee1", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkNNGZCRBK7hj4Ov3rIwAAKGkIAJ+HkkVrvlJ4n1AIZ8Ez4VWa\nQ+gBjdX83yunDUIGwjkGF2WhTAZuVK3pEzF5fX1cHX5a2I2hPUB8u0XT21LzX+VN\nzOwfcTOtq8+KkR6MZHuGZmUT1UnADduyK6oJRP/92VGZT4T+6Tzf4Ap6U/qmrVKH\nTx004b5/Q0tn3Yvxc2+YZWCADWF8+SyyPlsLoZ73eDDyLv9s4hsQglQUouO0PbDU\nWp3zWp+OxBGwncHTHvvLPeXCWPreT2/Fs3QjwaRnBDk/M5MbnbzpCQHK1Q+jncxY\nkTPWWgWf1xGwnnw8Q8YtXq6d/8mbQRUwGaE4FKAt5ZL7AYipjgSXxuv3bvP+OeI=\n=ENbA\n-----END PGP SIGNATURE-----\n", "payload": "tree 190a809c1458fe49d6f4e1a2ad62d1a718f7b1d7\nparent 5ca6e98f133744d147f9c84e83482912ac840406\nparent 8dd0ec6de7c8473e5730972c4e6206d5fb47b4e6\nauthor Yuki Okushi <jtitor@2k36.org> 1681183129 +0900\ncommitter GitHub <noreply@github.com> 1681183129 +0900\n\nRollup merge of #109527 - lnicola:rust-gdb-substitute-path, r=cuviper\n\nSet up standard library path substitution in rust-gdb and gdbgui\n\nFixes #62945\n\n---\n\nOnly lightly tested (in release mode, where the paths are a bit of a mess) because my `gdb` appears to crash with `internal-error: inside_main_func: Assertion 'block != nullptr' failed.` and I don't have `gdbgui`. Please review carefully my shell syntax.\n\nThere's also `rust-lldb`, but I don't know the equivalent for it.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c617ddf4f32f2ac93b05017b8b1b4164b76b1ee1", "html_url": "https://github.com/rust-lang/rust/commit/c617ddf4f32f2ac93b05017b8b1b4164b76b1ee1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c617ddf4f32f2ac93b05017b8b1b4164b76b1ee1/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5ca6e98f133744d147f9c84e83482912ac840406", "url": "https://api.github.com/repos/rust-lang/rust/commits/5ca6e98f133744d147f9c84e83482912ac840406", "html_url": "https://github.com/rust-lang/rust/commit/5ca6e98f133744d147f9c84e83482912ac840406"}, {"sha": "8dd0ec6de7c8473e5730972c4e6206d5fb47b4e6", "url": "https://api.github.com/repos/rust-lang/rust/commits/8dd0ec6de7c8473e5730972c4e6206d5fb47b4e6", "html_url": "https://github.com/rust-lang/rust/commit/8dd0ec6de7c8473e5730972c4e6206d5fb47b4e6"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "d812f7a802b1c18da052ff2c284cde7cf8a5a792", "filename": "src/etc/rust-gdb", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c617ddf4f32f2ac93b05017b8b1b4164b76b1ee1/src%2Fetc%2Frust-gdb", "raw_url": "https://github.com/rust-lang/rust/raw/c617ddf4f32f2ac93b05017b8b1b4164b76b1ee1/src%2Fetc%2Frust-gdb", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Frust-gdb?ref=c617ddf4f32f2ac93b05017b8b1b4164b76b1ee1", "patch": "@@ -13,6 +13,8 @@ fi\n # Find out where the pretty printer Python module is\n RUSTC_SYSROOT=\"$(\"$RUSTC\" --print=sysroot)\"\n GDB_PYTHON_MODULE_DIRECTORY=\"$RUSTC_SYSROOT/lib/rustlib/etc\"\n+# Get the commit hash for path remapping\n+RUSTC_COMMIT_HASH=\"$(\"$RUSTC\" -vV | sed -n 's/commit-hash: \\(\\w*\\)/\\1/p')\"\n \n # Run GDB with the additional arguments that load the pretty printers\n # Set the environment variable `RUST_GDB` to overwrite the call to a\n@@ -21,4 +23,6 @@ RUST_GDB=\"${RUST_GDB:-gdb}\"\n PYTHONPATH=\"$PYTHONPATH:$GDB_PYTHON_MODULE_DIRECTORY\" exec ${RUST_GDB} \\\n   --directory=\"$GDB_PYTHON_MODULE_DIRECTORY\" \\\n   -iex \"add-auto-load-safe-path $GDB_PYTHON_MODULE_DIRECTORY\" \\\n+  -iex \"set substitute-path /rustc/$RUSTC_COMMIT_HASH $RUSTC_SYSROOT/lib/rustlib/src/rust\" \\\n   \"$@\"\n+ \n\\ No newline at end of file"}, {"sha": "e7bafcc99b81db73b6732f603f20047390f4613f", "filename": "src/etc/rust-gdbgui", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/c617ddf4f32f2ac93b05017b8b1b4164b76b1ee1/src%2Fetc%2Frust-gdbgui", "raw_url": "https://github.com/rust-lang/rust/raw/c617ddf4f32f2ac93b05017b8b1b4164b76b1ee1/src%2Fetc%2Frust-gdbgui", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Frust-gdbgui?ref=c617ddf4f32f2ac93b05017b8b1b4164b76b1ee1", "patch": "@@ -42,6 +42,8 @@ fi\n # Find out where the pretty printer Python module is\n RUSTC_SYSROOT=\"$(\"$RUSTC\" --print=sysroot)\"\n GDB_PYTHON_MODULE_DIRECTORY=\"$RUSTC_SYSROOT/lib/rustlib/etc\"\n+# Get the commit hash for path remapping\n+RUSTC_COMMIT_HASH=\"$(\"$RUSTC\" -vV | sed -n 's/commit-hash: \\(\\w*\\)/\\1/p')\"\n \n # Set the environment variable `RUST_GDB` to overwrite the call to a\n # different/specific command (defaults to `gdb`).\n@@ -53,7 +55,9 @@ RUST_GDBGUI=\"${RUST_GDBGUI:-gdbgui}\"\n \n # These arguments get passed through to GDB and make it load the\n # Rust pretty printers.\n-GDB_ARGS=\"--directory=\\\"$GDB_PYTHON_MODULE_DIRECTORY\\\" -iex \\\"add-auto-load-safe-path $GDB_PYTHON_MODULE_DIRECTORY\\\"\"\n+GDB_ARGS=\"--directory=\\\"$GDB_PYTHON_MODULE_DIRECTORY\\\"\" \\\n+   \"-iex \\\"add-auto-load-safe-path $GDB_PYTHON_MODULE_DIRECTORY\\\"\" \\\n+   \"-iex \\\"set substitute-path /rustc/$RUSTC_COMMIT_HASH $RUSTC_SYSROOT/lib/rustlib/src/rust\\\"\"\n \n # Finally we execute gdbgui.\n PYTHONPATH=\"$PYTHONPATH:$GDB_PYTHON_MODULE_DIRECTORY\" \\"}]}