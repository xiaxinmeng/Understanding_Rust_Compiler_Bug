{"sha": "9dd2c890662c83428ab17262281c51c6eb84e315", "node_id": "MDY6Q29tbWl0NzI0NzEyOjlkZDJjODkwNjYyYzgzNDI4YWIxNzI2MjI4MWM1MWM2ZWI4NGUzMTU=", "commit": {"author": {"name": "Alex Burka", "email": "web@alexburka.com", "date": "2018-11-01T03:32:45Z"}, "committer": {"name": "Alex Burka", "email": "web@alexburka.com", "date": "2018-11-01T03:32:45Z"}, "message": "enforce unused-must-use lint in macros", "tree": {"sha": "a341bb16c7f9901c3ea22d7b44431b91dc7378b5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a341bb16c7f9901c3ea22d7b44431b91dc7378b5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9dd2c890662c83428ab17262281c51c6eb84e315", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9dd2c890662c83428ab17262281c51c6eb84e315", "html_url": "https://github.com/rust-lang/rust/commit/9dd2c890662c83428ab17262281c51c6eb84e315", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9dd2c890662c83428ab17262281c51c6eb84e315/comments", "author": null, "committer": null, "parents": [{"sha": "1cf82fd9c0e8eb9ff29d4165f9824c483bd72f7d", "url": "https://api.github.com/repos/rust-lang/rust/commits/1cf82fd9c0e8eb9ff29d4165f9824c483bd72f7d", "html_url": "https://github.com/rust-lang/rust/commit/1cf82fd9c0e8eb9ff29d4165f9824c483bd72f7d"}], "stats": {"total": 34, "additions": 33, "deletions": 1}, "files": [{"sha": "6d365e6d1ecbf1c7d0066b342df471aed461454d", "filename": "src/librustc_lint/unused.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9dd2c890662c83428ab17262281c51c6eb84e315/src%2Flibrustc_lint%2Funused.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9dd2c890662c83428ab17262281c51c6eb84e315/src%2Flibrustc_lint%2Funused.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Funused.rs?ref=9dd2c890662c83428ab17262281c51c6eb84e315", "patch": "@@ -29,7 +29,8 @@ use rustc::hir;\n declare_lint! {\n     pub UNUSED_MUST_USE,\n     Warn,\n-    \"unused result of a type flagged as #[must_use]\"\n+    \"unused result of a type flagged as #[must_use]\",\n+    report_in_external_macro: true\n }\n \n declare_lint! {"}, {"sha": "ad7cc37da52ca3b3a6b7791ed4764fdc1ccfbb96", "filename": "src/test/ui/macros/must-use-in-macro-55516.rs", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/9dd2c890662c83428ab17262281c51c6eb84e315/src%2Ftest%2Fui%2Fmacros%2Fmust-use-in-macro-55516.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9dd2c890662c83428ab17262281c51c6eb84e315/src%2Ftest%2Fui%2Fmacros%2Fmust-use-in-macro-55516.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Fmust-use-in-macro-55516.rs?ref=9dd2c890662c83428ab17262281c51c6eb84e315", "patch": "@@ -0,0 +1,21 @@\n+// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// compile-pass\n+// compile-flags: -Wunused\n+\n+// make sure write!() can't hide its unused Result\n+\n+fn main() {\n+    use std::fmt::Write;\n+    let mut example = String::new();\n+    write!(&mut example, \"{}\", 42); //~WARN must be used\n+}\n+"}, {"sha": "b03a5806da5c3d28837c0947fc95a85e69937581", "filename": "src/test/ui/macros/must-use-in-macro-55516.stderr", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/9dd2c890662c83428ab17262281c51c6eb84e315/src%2Ftest%2Fui%2Fmacros%2Fmust-use-in-macro-55516.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/9dd2c890662c83428ab17262281c51c6eb84e315/src%2Ftest%2Fui%2Fmacros%2Fmust-use-in-macro-55516.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Fmust-use-in-macro-55516.stderr?ref=9dd2c890662c83428ab17262281c51c6eb84e315", "patch": "@@ -0,0 +1,10 @@\n+warning: unused `std::result::Result` that must be used\n+  --> $DIR/must-use-in-macro-55516.rs:19:5\n+   |\n+LL |     write!(&mut example, \"{}\", 42); //~WARN must be used\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+   = note: `-W unused-must-use` implied by `-W unused`\n+   = note: this `Result` may be an `Err` variant, which should be handled\n+   = note: this error originates in a macro outside of the current crate (in Nightly builds, run with -Z external-macro-backtrace for more info)\n+"}]}