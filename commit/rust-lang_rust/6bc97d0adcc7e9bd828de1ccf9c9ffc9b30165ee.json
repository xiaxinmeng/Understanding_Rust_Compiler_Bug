{"sha": "6bc97d0adcc7e9bd828de1ccf9c9ffc9b30165ee", "node_id": "C_kwDOAAsO6NoAKDZiYzk3ZDBhZGNjN2U5YmQ4MjhkZTFjY2Y5YzlmZmM5YjMwMTY1ZWU", "commit": {"author": {"name": "Pietro Albini", "email": "pietro.albini@ferrous-systems.com", "date": "2022-07-11T08:15:13Z"}, "committer": {"name": "Pietro Albini", "email": "pietro.albini@ferrous-systems.com", "date": "2022-07-11T08:15:13Z"}, "message": " configure nightly branch name in stage0.json", "tree": {"sha": "763d9d417ab5f65884c5b24a4b01c8a27f27f47f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/763d9d417ab5f65884c5b24a4b01c8a27f27f47f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6bc97d0adcc7e9bd828de1ccf9c9ffc9b30165ee", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEMycKYjxLY0eb13b7zXazX3c0dp4FAmLL3BQACgkQzXazX3c0\ndp7TyQ/8C8lB89XozJeBLY+cBCdMafcLMrEvwHdtadT6Y2BUarU1b6Qr+qgTUV6V\n2P+QDgLjgrd4R0zjtiNpDs5PAIeTc0tOiNKf+JCVnS0j8YiP4ezrY1/w+DG9QkZQ\nGFX5gWCJvd2iYjk95kl70U9kIBjcOVIfKqDfV5I0aw2gC2Vro1BiH8O9JzlAMXzG\nneavoaye2Zu9FbSrqVcBBuB/qr2j3MT/BWlZTEWjfODaHzxrd/4WnahBgSbqzXN7\niPA6OqTgLVlOtlABYtPSoRbq71kcPXmBxAnigH04ByKjkWvGCY+8vkKXdjGRfeG5\nfJ+j+nfQT2xNt0hQZHtd1kXP6PTgtg23972TSWeCeOzB9+Mc5GD9FN0NXgYxq4d6\n/DoJTMHS9+x3nz+0SMCsZ4djbNTK2hHmUEZVIbmlOdpICDMeLiOdWi1yhgtt3NiV\nsapqtT8h31/u6yzOoaOL6elaCQd+HF1kSmEDdPmnHp4JLysz2zgWP/OsSnbDOY5e\n9ul0npJasMU0k1BWkj1sUAJcS6JaQ1CqV8qXA8m17Iwse2l1GGumWcoFwuxdMiwO\nL4PDCPkx6UkV9kxhehY2hRqjlp29yVtM3LTRF+0PWEux5uSdzxd9XALNBJ73YBAr\n/+7qvrUU0V/rJY72ZIUKXyo8859JxlH2vWMT+R5eOZrgpXtC0is=\n=YfSr\n-----END PGP SIGNATURE-----", "payload": "tree 763d9d417ab5f65884c5b24a4b01c8a27f27f47f\nparent b6df2a70f0ef9013bbbbfca342c29d165ea467fa\nauthor Pietro Albini <pietro.albini@ferrous-systems.com> 1657527313 +0200\ncommitter Pietro Albini <pietro.albini@ferrous-systems.com> 1657527313 +0200\n\n configure nightly branch name in stage0.json\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6bc97d0adcc7e9bd828de1ccf9c9ffc9b30165ee", "html_url": "https://github.com/rust-lang/rust/commit/6bc97d0adcc7e9bd828de1ccf9c9ffc9b30165ee", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6bc97d0adcc7e9bd828de1ccf9c9ffc9b30165ee/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b6df2a70f0ef9013bbbbfca342c29d165ea467fa", "url": "https://api.github.com/repos/rust-lang/rust/commits/b6df2a70f0ef9013bbbbfca342c29d165ea467fa", "html_url": "https://github.com/rust-lang/rust/commit/b6df2a70f0ef9013bbbbfca342c29d165ea467fa"}], "stats": {"total": 17, "additions": 8, "deletions": 9}, "files": [{"sha": "62dd9a6b36502bb7bb76217261985c23e80eebc6", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/6bc97d0adcc7e9bd828de1ccf9c9ffc9b30165ee/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6bc97d0adcc7e9bd828de1ccf9c9ffc9b30165ee/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=6bc97d0adcc7e9bd828de1ccf9c9ffc9b30165ee", "patch": "@@ -226,6 +226,7 @@ pub struct Stage0Config {\n     pub artifacts_server: String,\n     pub artifacts_with_llvm_assertions_server: String,\n     pub git_merge_commit_email: String,\n+    pub nightly_branch: String,\n }\n #[derive(Default, Deserialize)]\n #[cfg_attr(test, derive(Clone))]"}, {"sha": "cd421c249d8da660eb7f0fe5d9391b64a418182b", "filename": "src/bootstrap/lib.rs", "status": "modified", "additions": 5, "deletions": 8, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/6bc97d0adcc7e9bd828de1ccf9c9ffc9b30165ee/src%2Fbootstrap%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6bc97d0adcc7e9bd828de1ccf9c9ffc9b30165ee/src%2Fbootstrap%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Flib.rs?ref=6bc97d0adcc7e9bd828de1ccf9c9ffc9b30165ee", "patch": "@@ -1280,14 +1280,11 @@ impl Build {\n         // Figure out how many merge commits happened since we branched off master.\n         // That's our beta number!\n         // (Note that we use a `..` range, not the `...` symmetric difference.)\n-        let count = output(\n-            self.config\n-                .git()\n-                .arg(\"rev-list\")\n-                .arg(\"--count\")\n-                .arg(\"--merges\")\n-                .arg(\"refs/remotes/origin/master..HEAD\"),\n-        );\n+        let count =\n+            output(self.config.git().arg(\"rev-list\").arg(\"--count\").arg(\"--merges\").arg(format!(\n+                \"refs/remotes/origin/{}..HEAD\",\n+                self.config.stage0_metadata.config.nightly_branch\n+            )));\n         let n = count.trim().parse().unwrap();\n         self.prerelease_version.set(Some(n));\n         n"}, {"sha": "ab8a79e2af595d30e9d84ff0f3559476ff1a52ec", "filename": "src/stage0.json", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/6bc97d0adcc7e9bd828de1ccf9c9ffc9b30165ee/src%2Fstage0.json", "raw_url": "https://github.com/rust-lang/rust/raw/6bc97d0adcc7e9bd828de1ccf9c9ffc9b30165ee/src%2Fstage0.json", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fstage0.json?ref=6bc97d0adcc7e9bd828de1ccf9c9ffc9b30165ee", "patch": "@@ -3,7 +3,8 @@\n     \"dist_server\": \"https://static.rust-lang.org\",\n     \"artifacts_server\": \"https://ci-artifacts.rust-lang.org/rustc-builds\",\n     \"artifacts_with_llvm_assertions_server\": \"https://ci-artifacts.rust-lang.org/rustc-builds-alt\",\n-    \"git_merge_commit_email\": \"bors@rust-lang.org\"\n+    \"git_merge_commit_email\": \"bors@rust-lang.org\",\n+    \"nightly_branch\": \"master\"\n   },\n   \"__comments\": [\n     \"The configuration above this comment is editable, and can be changed\","}]}