{"sha": "f7a4a87de2840789e12722afc7df9f4db2db013c", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY3YTRhODdkZTI4NDA3ODllMTI3MjJhZmM3ZGY5ZjRkYjJkYjAxM2M=", "commit": {"author": {"name": "lbrande", "email": "lovbra00@gmail.com", "date": "2021-02-19T13:48:07Z"}, "committer": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2021-02-24T10:58:37Z"}, "message": "De Morgan's Law assist now correctly parenthesizes binary expressions.", "tree": {"sha": "cbc35e6f34db1216977269d7077d5a1889a41b86", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cbc35e6f34db1216977269d7077d5a1889a41b86"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f7a4a87de2840789e12722afc7df9f4db2db013c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f7a4a87de2840789e12722afc7df9f4db2db013c", "html_url": "https://github.com/rust-lang/rust/commit/f7a4a87de2840789e12722afc7df9f4db2db013c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f7a4a87de2840789e12722afc7df9f4db2db013c/comments", "author": {"login": "lbrande", "id": 6149236, "node_id": "MDQ6VXNlcjYxNDkyMzY=", "avatar_url": "https://avatars.githubusercontent.com/u/6149236?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lbrande", "html_url": "https://github.com/lbrande", "followers_url": "https://api.github.com/users/lbrande/followers", "following_url": "https://api.github.com/users/lbrande/following{/other_user}", "gists_url": "https://api.github.com/users/lbrande/gists{/gist_id}", "starred_url": "https://api.github.com/users/lbrande/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lbrande/subscriptions", "organizations_url": "https://api.github.com/users/lbrande/orgs", "repos_url": "https://api.github.com/users/lbrande/repos", "events_url": "https://api.github.com/users/lbrande/events{/privacy}", "received_events_url": "https://api.github.com/users/lbrande/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "aa38fa1c72673cb2470651025782fb0fcfad738c", "url": "https://api.github.com/repos/rust-lang/rust/commits/aa38fa1c72673cb2470651025782fb0fcfad738c", "html_url": "https://github.com/rust-lang/rust/commit/aa38fa1c72673cb2470651025782fb0fcfad738c"}], "stats": {"total": 18, "additions": 7, "deletions": 11}, "files": [{"sha": "e478ff2ce93d43b7a543fcfd3d399f0a39e6a354", "filename": "crates/ide_assists/src/handlers/apply_demorgan.rs", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/f7a4a87de2840789e12722afc7df9f4db2db013c/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fapply_demorgan.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7a4a87de2840789e12722afc7df9f4db2db013c/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fapply_demorgan.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fapply_demorgan.rs?ref=f7a4a87de2840789e12722afc7df9f4db2db013c", "patch": "@@ -7,18 +7,17 @@ use crate::{utils::invert_boolean_expression, AssistContext, AssistId, AssistKin\n // Apply https://en.wikipedia.org/wiki/De_Morgan%27s_laws[De Morgan's law].\n // This transforms expressions of the form `!l || !r` into `!(l && r)`.\n // This also works with `&&`. This assist can only be applied with the cursor\n-// on either `||` or `&&`, with both operands being a negation of some kind.\n-// This means something of the form `!x` or `x != y`.\n+// on either `||` or `&&`.\n //\n // ```\n // fn main() {\n-//     if x != 4 ||$0 !y {}\n+//     if x != 4 ||$0 y < 3 {}\n // }\n // ```\n // ->\n // ```\n // fn main() {\n-//     if !(x == 4 && y) {}\n+//     if !(x == 4 && !(y < 3)) {}\n // }\n // ```\n pub(crate) fn apply_demorgan(acc: &mut Assists, ctx: &AssistContext) -> Option<()> {"}, {"sha": "ee9c870e84db2dab9e3ceaa60db572550cb9a2d7", "filename": "crates/ide_assists/src/tests/generated.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/f7a4a87de2840789e12722afc7df9f4db2db013c/crates%2Fide_assists%2Fsrc%2Ftests%2Fgenerated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7a4a87de2840789e12722afc7df9f4db2db013c/crates%2Fide_assists%2Fsrc%2Ftests%2Fgenerated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_assists%2Fsrc%2Ftests%2Fgenerated.rs?ref=f7a4a87de2840789e12722afc7df9f4db2db013c", "patch": "@@ -147,12 +147,12 @@ fn doctest_apply_demorgan() {\n         \"apply_demorgan\",\n         r#####\"\n fn main() {\n-    if x != 4 ||$0 !y {}\n+    if x != 4 ||$0 y < 3 {}\n }\n \"#####,\n         r#####\"\n fn main() {\n-    if !(x == 4 && y) {}\n+    if !(x == 4 && !(y < 3)) {}\n }\n \"#####,\n     )"}, {"sha": "cd026d432fa453f3d83759ef3f28d537786d33ac", "filename": "crates/ide_assists/src/utils.rs", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/f7a4a87de2840789e12722afc7df9f4db2db013c/crates%2Fide_assists%2Fsrc%2Futils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7a4a87de2840789e12722afc7df9f4db2db013c/crates%2Fide_assists%2Fsrc%2Futils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_assists%2Fsrc%2Futils.rs?ref=f7a4a87de2840789e12722afc7df9f4db2db013c", "patch": "@@ -217,11 +217,8 @@ fn invert_special_case(expr: &ast::Expr) -> Option<ast::Expr> {\n         ast::Expr::BinExpr(bin) => match bin.op_kind()? {\n             ast::BinOp::NegatedEqualityTest => bin.replace_op(T![==]).map(|it| it.into()),\n             ast::BinOp::EqualityTest => bin.replace_op(T![!=]).map(|it| it.into()),\n-            // Parenthesize composite boolean expressions before prefixing `!`\n-            ast::BinOp::BooleanAnd | ast::BinOp::BooleanOr => {\n-                Some(make::expr_prefix(T![!], make::expr_paren(expr.clone())))\n-            }\n-            _ => None,\n+            // Parenthesize other expressions before prefixing `!`\n+            _ => Some(make::expr_prefix(T![!], make::expr_paren(expr.clone()))),\n         },\n         ast::Expr::MethodCallExpr(mce) => {\n             let receiver = mce.receiver()?;"}]}