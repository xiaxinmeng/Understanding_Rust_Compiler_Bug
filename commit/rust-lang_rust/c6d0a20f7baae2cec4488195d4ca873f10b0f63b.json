{"sha": "c6d0a20f7baae2cec4488195d4ca873f10b0f63b", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM2ZDBhMjBmN2JhYWUyY2VjNDQ4ODE5NWQ0Y2E4NzNmMTBiMGY2M2I=", "commit": {"author": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2021-07-26T03:34:43Z"}, "committer": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2021-08-13T09:28:50Z"}, "message": "handle the case when container is not impl", "tree": {"sha": "3e270ecb001cbe45fce4e6beaa43a5de2c01e68d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3e270ecb001cbe45fce4e6beaa43a5de2c01e68d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c6d0a20f7baae2cec4488195d4ca873f10b0f63b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEQ7Fl7qPq2YcWF1dqAn35M4hird0FAmEWO1IACgkQAn35M4hi\nrd0kRQ/7BbEObnJcTE+Nj9rAdhqRlzZo0bu9jVizNzW34jBj2erbouBtLUePMDKF\nB4CIl0I+MIGWNzk9h3FkC/8LO2IjBQNiYX7iytmH2B2+DGu7CTF68d/TZLmSwn/u\nSY0stWVChFCaBPsquPdV/cIxQ8ar6O1p7HZ/jre5t180p9IlwV17CJUqAVU/b2/F\nYz++mP9kIdTl8J3/t7zTEqONvIoUsfi49W0IGnBUd79HGoygziDXc+hO9QI80X2Z\nxoXWE2SgtfhT7CokAApOfA2Aqadlfsiv/M27SkF8bvGLoxhXDSpHNPpJx2OItd3L\nDm7Th/J/5oIDmM3SUN6czwi4IrjVJ+GlAWgNiR9HUBLWgTE+wPZ3uO3tQfbR2w8W\nMA/vbibhfxmqIT3pYW1yQ1SvKvfZ8zG1ciZ6YlSZObEAFB+l7U5dL0/XE47gKIGL\nfpzFJhk+KmYy49Cu/iKblWJJrXnpiEP7o6jgGBu9HU1D9Zf/1TTWUgjC6E3OOPS3\nkFOzjhXD4IGWUVpUB73ChbTPWkxwN/MyiqRIrguW0JQLETwri2se2ei3CbODFr7i\nrZmI55LJWWCxTo6GgPelQuKi8F7KqYJrHzeUnxMa5plKlhvbwnlFaT2WfQjs4qT8\nEdif86DLTzhhiNlDOK5fIZ+N+zQbUj9Ip8frQddOLSERPoWhtBw=\n=t2Fq\n-----END PGP SIGNATURE-----", "payload": "tree 3e270ecb001cbe45fce4e6beaa43a5de2c01e68d\nparent bcf0e2f52849dc5d23cde3df3d18a3524ead9629\nauthor Deadbeef <ent3rm4n@gmail.com> 1627270483 +0800\ncommitter Deadbeef <ent3rm4n@gmail.com> 1628846930 +0000\n\nhandle the case when container is not impl\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c6d0a20f7baae2cec4488195d4ca873f10b0f63b", "html_url": "https://github.com/rust-lang/rust/commit/c6d0a20f7baae2cec4488195d4ca873f10b0f63b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c6d0a20f7baae2cec4488195d4ca873f10b0f63b/comments", "author": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bcf0e2f52849dc5d23cde3df3d18a3524ead9629", "url": "https://api.github.com/repos/rust-lang/rust/commits/bcf0e2f52849dc5d23cde3df3d18a3524ead9629", "html_url": "https://github.com/rust-lang/rust/commit/bcf0e2f52849dc5d23cde3df3d18a3524ead9629"}], "stats": {"total": 15, "additions": 9, "deletions": 6}, "files": [{"sha": "5cb2b90fe1116bb7a424ee59332f5008bfb3e8d0", "filename": "compiler/rustc_middle/src/ty/assoc.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/c6d0a20f7baae2cec4488195d4ca873f10b0f63b/compiler%2Frustc_middle%2Fsrc%2Fty%2Fassoc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c6d0a20f7baae2cec4488195d4ca873f10b0f63b/compiler%2Frustc_middle%2Fsrc%2Fty%2Fassoc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Fassoc.rs?ref=c6d0a20f7baae2cec4488195d4ca873f10b0f63b", "patch": "@@ -16,12 +16,10 @@ pub enum AssocItemContainer {\n }\n \n impl AssocItemContainer {\n-    /// Asserts that this is the `DefId` of an associated item declared\n-    /// in an impl, and returns the trait `DefId`.\n-    pub fn assert_impl(&self) -> DefId {\n+    pub fn impl_def_id(&self) -> Option<DefId> {\n         match *self {\n-            ImplContainer(id) => id,\n-            _ => bug!(\"associated item has wrong container type: {:?}\", self),\n+            ImplContainer(id) => Some(id),\n+            _ => None,\n         }\n     }\n "}, {"sha": "a2ffb30f43bd76a1289544672cb119e7b2bb3a35", "filename": "compiler/rustc_typeck/src/check/compare_method.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/c6d0a20f7baae2cec4488195d4ca873f10b0f63b/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fcompare_method.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c6d0a20f7baae2cec4488195d4ca873f10b0f63b/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fcompare_method.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fcompare_method.rs?ref=c6d0a20f7baae2cec4488195d4ca873f10b0f63b", "patch": "@@ -1293,7 +1293,12 @@ pub fn check_type_bounds<'tcx>(\n \n     tcx.infer_ctxt().enter(move |infcx| {\n         // if the item is inside a const impl, we transform the predicates to be const.\n-        let constness = tcx.impl_constness(impl_ty.container.assert_impl());\n+        let constness = impl_ty\n+            .container\n+            .impl_def_id()\n+            .map(|did| tcx.impl_constness(did))\n+            .unwrap_or(hir::Constness::NotConst);\n+\n         let pred_map = match constness {\n             hir::Constness::NotConst => |p, _| p,\n             hir::Constness::Const => |p: ty::Predicate<'tcx>, tcx: TyCtxt<'tcx>| {"}]}