{"sha": "328d123f5baeab8ff9a1f63a6744f6eec89818ab", "node_id": "MDY6Q29tbWl0NzI0NzEyOjMyOGQxMjNmNWJhZWFiOGZmOWExZjYzYTY3NDRmNmVlYzg5ODE4YWI=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-12-21T22:37:11Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-12-21T22:42:26Z"}, "message": "specify completion item kind", "tree": {"sha": "673bdc09262b66ef825d7363ae05f79359555309", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/673bdc09262b66ef825d7363ae05f79359555309"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/328d123f5baeab8ff9a1f63a6744f6eec89818ab", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/328d123f5baeab8ff9a1f63a6744f6eec89818ab", "html_url": "https://github.com/rust-lang/rust/commit/328d123f5baeab8ff9a1f63a6744f6eec89818ab", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/328d123f5baeab8ff9a1f63a6744f6eec89818ab/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "284e89406906b97eec8e0f91bce2955a5e94b880", "url": "https://api.github.com/repos/rust-lang/rust/commits/284e89406906b97eec8e0f91bce2955a5e94b880", "html_url": "https://github.com/rust-lang/rust/commit/284e89406906b97eec8e0f91bce2955a5e94b880"}], "stats": {"total": 29, "additions": 17, "deletions": 12}, "files": [{"sha": "d742d62955a05ed186d825d3de43db1c9dfa14d6", "filename": "crates/ra_analysis/src/completion.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/328d123f5baeab8ff9a1f63a6744f6eec89818ab/crates%2Fra_analysis%2Fsrc%2Fcompletion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/328d123f5baeab8ff9a1f63a6744f6eec89818ab/crates%2Fra_analysis%2Fsrc%2Fcompletion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_analysis%2Fsrc%2Fcompletion.rs?ref=328d123f5baeab8ff9a1f63a6744f6eec89818ab", "patch": "@@ -18,7 +18,7 @@ use crate::{\n     },\n };\n \n-pub use crate::completion::completion_item::{CompletionItem, InsertText};\n+pub use crate::completion::completion_item::{CompletionItem, InsertText, CompletionItemKind};\n \n /// Main entry point for copmletion. We run comletion as a two-phase process.\n ///"}, {"sha": "5427fcb11f2f0759b8f786b0c9dc5d6e160062d0", "filename": "crates/ra_analysis/src/completion/complete_keyword.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/328d123f5baeab8ff9a1f63a6744f6eec89818ab/crates%2Fra_analysis%2Fsrc%2Fcompletion%2Fcomplete_keyword.rs", "raw_url": "https://github.com/rust-lang/rust/raw/328d123f5baeab8ff9a1f63a6744f6eec89818ab/crates%2Fra_analysis%2Fsrc%2Fcompletion%2Fcomplete_keyword.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_analysis%2Fsrc%2Fcompletion%2Fcomplete_keyword.rs?ref=328d123f5baeab8ff9a1f63a6744f6eec89818ab", "patch": "@@ -5,10 +5,11 @@ use ra_syntax::{\n     SyntaxKind::*, SyntaxNodeRef,\n };\n \n-use crate::completion::{CompletionContext, CompletionItem, Completions, CompletionKind};\n+use crate::completion::{CompletionContext, CompletionItem, Completions, CompletionKind, CompletionItemKind};\n \n fn keyword(kw: &str, snippet: &str) -> CompletionItem {\n     CompletionItem::new(CompletionKind::Keyword, kw)\n+        .kind(CompletionItemKind::Keyword)\n         .snippet(snippet)\n         .build()\n }"}, {"sha": "91de8ca3773e5165b3ce0dad66d34ac026f207de", "filename": "crates/ra_analysis/src/completion/complete_snippet.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/328d123f5baeab8ff9a1f63a6744f6eec89818ab/crates%2Fra_analysis%2Fsrc%2Fcompletion%2Fcomplete_snippet.rs", "raw_url": "https://github.com/rust-lang/rust/raw/328d123f5baeab8ff9a1f63a6744f6eec89818ab/crates%2Fra_analysis%2Fsrc%2Fcompletion%2Fcomplete_snippet.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_analysis%2Fsrc%2Fcompletion%2Fcomplete_snippet.rs?ref=328d123f5baeab8ff9a1f63a6744f6eec89818ab", "patch": "@@ -1,7 +1,9 @@\n-use crate::completion::{CompletionItem, Completions, CompletionKind, CompletionContext, completion_item::Builder};\n+use crate::completion::{CompletionItem, Completions, CompletionKind, CompletionItemKind, CompletionContext, completion_item::Builder};\n \n fn snippet(label: &str, snippet: &str) -> Builder {\n-    CompletionItem::new(CompletionKind::Snippet, label).snippet(snippet)\n+    CompletionItem::new(CompletionKind::Snippet, label)\n+        .snippet(snippet)\n+        .kind(CompletionItemKind::Keyword)\n }\n \n pub(super) fn complete_expr_snippet(acc: &mut Completions, ctx: &CompletionContext) {"}, {"sha": "89fbe62d869d88c7da9af3ee9a61dc955afeac01", "filename": "crates/ra_analysis/src/completion/completion_item.rs", "status": "modified", "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/328d123f5baeab8ff9a1f63a6744f6eec89818ab/crates%2Fra_analysis%2Fsrc%2Fcompletion%2Fcompletion_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/328d123f5baeab8ff9a1f63a6744f6eec89818ab/crates%2Fra_analysis%2Fsrc%2Fcompletion%2Fcompletion_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_analysis%2Fsrc%2Fcompletion%2Fcompletion_item.rs?ref=328d123f5baeab8ff9a1f63a6744f6eec89818ab", "patch": "@@ -3,13 +3,13 @@\n /// `CompletionItem`, use `new` method and the `Builder` struct.\n #[derive(Debug)]\n pub struct CompletionItem {\n+    /// Used only internally in tests, to check only specific kind of\n+    /// completion.\n+    completion_kind: CompletionKind,\n     label: String,\n     lookup: Option<String>,\n     snippet: Option<String>,\n     kind: Option<CompletionItemKind>,\n-    /// Used only internally in tests, to check only specific kind of\n-    /// completion.\n-    completion_kind: CompletionKind,\n }\n \n pub enum InsertText {\n@@ -38,10 +38,11 @@ impl CompletionItem {\n     pub(crate) fn new(completion_kind: CompletionKind, label: impl Into<String>) -> Builder {\n         let label = label.into();\n         Builder {\n+            completion_kind,\n             label,\n             lookup: None,\n             snippet: None,\n-            completion_kind,\n+            kind: None,\n         }\n     }\n     /// What user sees in pop-up in the UI.\n@@ -73,10 +74,11 @@ impl CompletionItem {\n /// A helper to make `CompletionItem`s.\n #[must_use]\n pub(crate) struct Builder {\n+    completion_kind: CompletionKind,\n     label: String,\n     lookup: Option<String>,\n     snippet: Option<String>,\n-    completion_kind: CompletionKind,\n+    kind: Option<CompletionItemKind>,\n }\n \n impl Builder {\n@@ -89,7 +91,7 @@ impl Builder {\n             label: self.label,\n             lookup: self.lookup,\n             snippet: self.snippet,\n-            kind: None,\n+            kind: self.kind,\n             completion_kind: self.completion_kind,\n         }\n     }\n@@ -101,8 +103,8 @@ impl Builder {\n         self.snippet = Some(snippet.into());\n         self\n     }\n-    pub(crate) fn kind(mut self, kind: CompletionKind) -> Builder {\n-        self.completion_kind = kind;\n+    pub(crate) fn kind(mut self, kind: CompletionItemKind) -> Builder {\n+        self.kind = Some(kind);\n         self\n     }\n }"}]}