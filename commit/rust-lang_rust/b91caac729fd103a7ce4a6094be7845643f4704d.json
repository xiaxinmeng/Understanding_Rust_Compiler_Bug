{"sha": "b91caac729fd103a7ce4a6094be7845643f4704d", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI5MWNhYWM3MjlmZDEwM2E3Y2U0YTYwOTRiZTc4NDU2NDNmNDcwNGQ=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2014-02-07T07:24:41Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2014-02-07T21:21:35Z"}, "message": "rustc: Remove 'morestack_addr' intrinsic. Unused", "tree": {"sha": "de10f0a647a7d622dc4cefbcbe7774292de3c3f5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/de10f0a647a7d622dc4cefbcbe7774292de3c3f5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b91caac729fd103a7ce4a6094be7845643f4704d", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b91caac729fd103a7ce4a6094be7845643f4704d", "html_url": "https://github.com/rust-lang/rust/commit/b91caac729fd103a7ce4a6094be7845643f4704d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b91caac729fd103a7ce4a6094be7845643f4704d/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6aad3bf944da209d1852c51144ba584de400a10c", "url": "https://api.github.com/repos/rust-lang/rust/commits/6aad3bf944da209d1852c51144ba584de400a10c", "html_url": "https://github.com/rust-lang/rust/commit/6aad3bf944da209d1852c51144ba584de400a10c"}], "stats": {"total": 41, "additions": 0, "deletions": 41}, "files": [{"sha": "8896a3de733377857f033f91cd0489261c9940d0", "filename": "src/librustc/middle/trans/intrinsic.rs", "status": "modified", "additions": 0, "deletions": 11, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/b91caac729fd103a7ce4a6094be7845643f4704d/src%2Flibrustc%2Fmiddle%2Ftrans%2Fintrinsic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b91caac729fd103a7ce4a6094be7845643f4704d/src%2Flibrustc%2Fmiddle%2Ftrans%2Fintrinsic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Ftrans%2Fintrinsic.rs?ref=b91caac729fd103a7ce4a6094be7845643f4704d", "patch": "@@ -463,17 +463,6 @@ pub fn trans_intrinsic(ccx: @CrateContext,\n                                         abi::tydesc_field_visit_glue, None);\n             RetVoid(bcx);\n         }\n-        \"morestack_addr\" => {\n-            // FIXME This is a hack to grab the address of this particular\n-            // native function. There should be a general in-language\n-            // way to do this\n-            let llfty = type_of_rust_fn(bcx.ccx(), false, [], ty::mk_nil());\n-            let morestack_addr = decl_cdecl_fn(bcx.ccx().llmod, \"__morestack\",\n-                                               llfty, ty::mk_nil());\n-            let morestack_addr = PointerCast(bcx, morestack_addr,\n-                                             Type::nil().ptr_to());\n-            Ret(bcx, morestack_addr);\n-        }\n         \"offset\" => {\n             let ptr = get_param(decl, first_real_arg);\n             let offset = get_param(decl, first_real_arg + 1);"}, {"sha": "b9f7efca67ebc56d9125e8ab7c7a68e651451bf9", "filename": "src/librustc/middle/typeck/check/mod.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/b91caac729fd103a7ce4a6094be7845643f4704d/src%2Flibrustc%2Fmiddle%2Ftypeck%2Fcheck%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b91caac729fd103a7ce4a6094be7845643f4704d/src%2Flibrustc%2Fmiddle%2Ftypeck%2Fcheck%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Ftypeck%2Fcheck%2Fmod.rs?ref=b91caac729fd103a7ce4a6094be7845643f4704d", "patch": "@@ -4128,9 +4128,6 @@ pub fn check_intrinsic_type(ccx: @CrateCtxt, it: &ast::ForeignItem) {\n               });\n               (0, ~[ td_ptr, visitor_object_ty ], ty::mk_nil())\n             }\n-            \"morestack_addr\" => {\n-              (0u, ~[], ty::mk_nil_ptr(ccx.tcx))\n-            }\n             \"offset\" => {\n               (1,\n                ~["}, {"sha": "7ca28711504c9a56df31fc53961fbbefd797563b", "filename": "src/libstd/unstable/intrinsics.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/b91caac729fd103a7ce4a6094be7845643f4704d/src%2Flibstd%2Funstable%2Fintrinsics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b91caac729fd103a7ce4a6094be7845643f4704d/src%2Flibstd%2Funstable%2Fintrinsics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Funstable%2Fintrinsics.rs?ref=b91caac729fd103a7ce4a6094be7845643f4704d", "patch": "@@ -310,9 +310,6 @@ extern \"rust-intrinsic\" {\n \n     pub fn visit_tydesc(td: *TyDesc, tv: &mut TyVisitor);\n \n-    /// Get the address of the `__morestack` stack growth function.\n-    pub fn morestack_addr() -> *();\n-\n     /// Calculates the offset from a pointer. The offset *must* be in-bounds of\n     /// the object, or one-byte-past-the-end. An arithmetic overflow is also\n     /// undefined behaviour."}, {"sha": "ec678df357a8ddd4ffde27790768887fa4402f11", "filename": "src/test/run-pass/morestack-address.rs", "status": "removed", "additions": 0, "deletions": 24, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/6aad3bf944da209d1852c51144ba584de400a10c/src%2Ftest%2Frun-pass%2Fmorestack-address.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6aad3bf944da209d1852c51144ba584de400a10c/src%2Ftest%2Frun-pass%2Fmorestack-address.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fmorestack-address.rs?ref=6aad3bf944da209d1852c51144ba584de400a10c", "patch": "@@ -1,24 +0,0 @@\n-// Copyright 2012 The Rust Project Developers. See the COPYRIGHT\n-// file at the top-level directory of this distribution and at\n-// http://rust-lang.org/COPYRIGHT.\n-//\n-// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n-// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n-// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n-// option. This file may not be copied, modified, or distributed\n-// except according to those terms.\n-\n-mod rusti {\n-    #[nolink]\n-    extern \"rust-intrinsic\" {\n-        pub fn morestack_addr() -> *();\n-    }\n-}\n-\n-pub fn main() {\n-    unsafe {\n-        let addr = rusti::morestack_addr();\n-        assert!(addr.is_not_null());\n-        error!(\"{}\", addr);\n-    }\n-}"}]}