{"sha": "2a182f3f1f2c7b1a5359885b3b55e20885fe4183", "node_id": "C_kwDOAAsO6NoAKDJhMTgyZjNmMWYyYzdiMWE1MzU5ODg1YjNiNTVlMjA4ODVmZTQxODM", "commit": {"author": {"name": "hecatia-elegua", "email": "108802164+hecatia-elegua@users.noreply.github.com", "date": "2023-05-10T10:51:08Z"}, "committer": {"name": "hecatia-elegua", "email": "108802164+hecatia-elegua@users.noreply.github.com", "date": "2023-05-10T10:51:08Z"}, "message": "Add doc(alias)-based method completion", "tree": {"sha": "6f669c7739ff94e92d82d2f9ecfeafaf4a8118df", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6f669c7739ff94e92d82d2f9ecfeafaf4a8118df"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2a182f3f1f2c7b1a5359885b3b55e20885fe4183", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2a182f3f1f2c7b1a5359885b3b55e20885fe4183", "html_url": "https://github.com/rust-lang/rust/commit/2a182f3f1f2c7b1a5359885b3b55e20885fe4183", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2a182f3f1f2c7b1a5359885b3b55e20885fe4183/comments", "author": {"login": "hecatia-elegua", "id": 108802164, "node_id": "U_kgDOBnwwdA", "avatar_url": "https://avatars.githubusercontent.com/u/108802164?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hecatia-elegua", "html_url": "https://github.com/hecatia-elegua", "followers_url": "https://api.github.com/users/hecatia-elegua/followers", "following_url": "https://api.github.com/users/hecatia-elegua/following{/other_user}", "gists_url": "https://api.github.com/users/hecatia-elegua/gists{/gist_id}", "starred_url": "https://api.github.com/users/hecatia-elegua/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hecatia-elegua/subscriptions", "organizations_url": "https://api.github.com/users/hecatia-elegua/orgs", "repos_url": "https://api.github.com/users/hecatia-elegua/repos", "events_url": "https://api.github.com/users/hecatia-elegua/events{/privacy}", "received_events_url": "https://api.github.com/users/hecatia-elegua/received_events", "type": "User", "site_admin": false}, "committer": {"login": "hecatia-elegua", "id": 108802164, "node_id": "U_kgDOBnwwdA", "avatar_url": "https://avatars.githubusercontent.com/u/108802164?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hecatia-elegua", "html_url": "https://github.com/hecatia-elegua", "followers_url": "https://api.github.com/users/hecatia-elegua/followers", "following_url": "https://api.github.com/users/hecatia-elegua/following{/other_user}", "gists_url": "https://api.github.com/users/hecatia-elegua/gists{/gist_id}", "starred_url": "https://api.github.com/users/hecatia-elegua/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hecatia-elegua/subscriptions", "organizations_url": "https://api.github.com/users/hecatia-elegua/orgs", "repos_url": "https://api.github.com/users/hecatia-elegua/repos", "events_url": "https://api.github.com/users/hecatia-elegua/events{/privacy}", "received_events_url": "https://api.github.com/users/hecatia-elegua/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d4b668a3bbf528822d7dd6f3206b740653f23c11", "url": "https://api.github.com/repos/rust-lang/rust/commits/d4b668a3bbf528822d7dd6f3206b740653f23c11", "html_url": "https://github.com/rust-lang/rust/commit/d4b668a3bbf528822d7dd6f3206b740653f23c11"}], "stats": {"total": 68, "additions": 66, "deletions": 2}, "files": [{"sha": "87346f501d2bb15e89feea29cabf89544ecd319d", "filename": "crates/ide-completion/src/completions.rs", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/2a182f3f1f2c7b1a5359885b3b55e20885fe4183/crates%2Fide-completion%2Fsrc%2Fcompletions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2a182f3f1f2c7b1a5359885b3b55e20885fe4183/crates%2Fide-completion%2Fsrc%2Fcompletions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide-completion%2Fsrc%2Fcompletions.rs?ref=2a182f3f1f2c7b1a5359885b3b55e20885fe4183", "patch": "@@ -295,9 +295,12 @@ impl Completions {\n             Visible::Editable => true,\n             Visible::No => return,\n         };\n+        let doc_aliases = ctx.doc_aliases(&func);\n         self.add(\n             render_fn(\n-                RenderContext::new(ctx).private_editable(is_private_editable),\n+                RenderContext::new(ctx)\n+                    .private_editable(is_private_editable)\n+                    .doc_aliases(doc_aliases),\n                 path_ctx,\n                 local_name,\n                 func,\n@@ -322,9 +325,12 @@ impl Completions {\n             Visible::Editable => true,\n             Visible::No => return,\n         };\n+        let doc_aliases = ctx.doc_aliases(&func);\n         self.add(\n             render_method(\n-                RenderContext::new(ctx).private_editable(is_private_editable),\n+                RenderContext::new(ctx)\n+                    .private_editable(is_private_editable)\n+                    .doc_aliases(doc_aliases),\n                 dot_access,\n                 receiver,\n                 local_name,\n@@ -349,10 +355,12 @@ impl Completions {\n             Visible::Editable => true,\n             Visible::No => return,\n         };\n+        let doc_aliases = ctx.doc_aliases(&func);\n         self.add(\n             render_method(\n                 RenderContext::new(ctx)\n                     .private_editable(is_private_editable)\n+                    .doc_aliases(doc_aliases)\n                     .import_to_add(Some(import)),\n                 dot_access,\n                 None,"}, {"sha": "3824720839eb9ebdea5a4bb460419cd9be9299dc", "filename": "crates/ide-completion/src/tests/special.rs", "status": "modified", "additions": 56, "deletions": 0, "changes": 56, "blob_url": "https://github.com/rust-lang/rust/blob/2a182f3f1f2c7b1a5359885b3b55e20885fe4183/crates%2Fide-completion%2Fsrc%2Ftests%2Fspecial.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2a182f3f1f2c7b1a5359885b3b55e20885fe4183/crates%2Fide-completion%2Fsrc%2Ftests%2Fspecial.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide-completion%2Fsrc%2Ftests%2Fspecial.rs?ref=2a182f3f1f2c7b1a5359885b3b55e20885fe4183", "patch": "@@ -1106,6 +1106,62 @@ fn here_we_go() {\n     );\n }\n \n+#[test]\n+fn completes_struct_fn_name_via_doc_alias_in_fn_body() {\n+    check(\n+        r#\"\n+struct Foo;\n+impl Foo {\n+    #[doc(alias = \"qux\")]\n+    fn bar() -> u8 { 1 }\n+}\n+\n+fn here_we_go() {\n+    Foo::q$0\n+}\n+\"#,\n+        expect![[r#\"\n+            fn bar() (alias qux) fn() -> u8\n+        \"#]],\n+    );\n+}\n+\n+#[test]\n+fn completes_method_name_via_doc_alias_in_fn_body() {\n+    check(\n+        r#\"\n+struct Foo {\n+    bar: u8\n+}\n+impl Foo {\n+    #[doc(alias = \"qux\")]\n+    fn baz(&self) -> u8 {\n+        self.bar\n+    }\n+}\n+\n+fn here_we_go() {\n+    let foo = Foo { field: 42 };\n+    foo.q$0\n+}\n+\"#,\n+        expect![[r#\"\n+            fd bar               u8\n+            me baz() (alias qux) fn(&self) -> u8\n+            sn box               Box::new(expr)\n+            sn call              function(expr)\n+            sn dbg               dbg!(expr)\n+            sn dbgr              dbg!(&expr)\n+            sn let               let\n+            sn letm              let mut\n+            sn match             match expr {}\n+            sn ref               &expr\n+            sn refm              &mut expr\n+            sn unsafe            unsafe {}\n+        \"#]],\n+    );\n+}\n+\n #[test]\n fn completes_fn_name_via_doc_alias_in_fn_body() {\n     check("}]}