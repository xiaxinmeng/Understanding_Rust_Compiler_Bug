{"sha": "8568f44fe172b0e7b7d9ce5a66d6e69ad9ffc669", "node_id": "C_kwDOAAsO6NoAKDg1NjhmNDRmZTE3MmIwZTdiN2Q5Y2U1YTY2ZDZlNjlhZDlmZmM2Njk", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-01-12T20:00:36Z"}, "committer": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-01-12T20:01:01Z"}, "message": "suggest deref/unboxing before wrapping variant", "tree": {"sha": "3a782ae54261b2537b21f62482b0143ec6065286", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3a782ae54261b2537b21f62482b0143ec6065286"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8568f44fe172b0e7b7d9ce5a66d6e69ad9ffc669", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8568f44fe172b0e7b7d9ce5a66d6e69ad9ffc669", "html_url": "https://github.com/rust-lang/rust/commit/8568f44fe172b0e7b7d9ce5a66d6e69ad9ffc669", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8568f44fe172b0e7b7d9ce5a66d6e69ad9ffc669/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "40f33a7a4c3cf928576429a89bca522b94b081cd", "url": "https://api.github.com/repos/rust-lang/rust/commits/40f33a7a4c3cf928576429a89bca522b94b081cd", "html_url": "https://github.com/rust-lang/rust/commit/40f33a7a4c3cf928576429a89bca522b94b081cd"}], "stats": {"total": 10, "additions": 5, "deletions": 5}, "files": [{"sha": "c351a9f70404a8df1fbf8d595025c5a46bc94738", "filename": "compiler/rustc_typeck/src/check/demand.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8568f44fe172b0e7b7d9ce5a66d6e69ad9ffc669/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fdemand.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8568f44fe172b0e7b7d9ce5a66d6e69ad9ffc669/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fdemand.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fdemand.rs?ref=8568f44fe172b0e7b7d9ce5a66d6e69ad9ffc669", "patch": "@@ -31,8 +31,8 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         error: TypeError<'tcx>,\n     ) {\n         self.annotate_expected_due_to_let_ty(err, expr, error);\n-        self.suggest_compatible_variants(err, expr, expected, expr_ty);\n         self.suggest_deref_ref_or_into(err, expr, expected, expr_ty, expected_ty_expr);\n+        self.suggest_compatible_variants(err, expr, expected, expr_ty);\n         if self.suggest_calling_boxed_future_when_appropriate(err, expr, expected, expr_ty) {\n             return;\n         }"}, {"sha": "9a31dc89197e36209a295f4c8e319761ee1448c9", "filename": "src/test/ui/suggestions/boxed-variant-field.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/8568f44fe172b0e7b7d9ce5a66d6e69ad9ffc669/src%2Ftest%2Fui%2Fsuggestions%2Fboxed-variant-field.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/8568f44fe172b0e7b7d9ce5a66d6e69ad9ffc669/src%2Ftest%2Fui%2Fsuggestions%2Fboxed-variant-field.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsuggestions%2Fboxed-variant-field.stderr?ref=8568f44fe172b0e7b7d9ce5a66d6e69ad9ffc669", "patch": "@@ -6,14 +6,14 @@ LL |         Ty::List(elem) => foo(elem),\n    |\n    = note: expected enum `Ty`\n             found struct `Box<Ty>`\n-help: try wrapping the expression in `Ty::List`\n-   |\n-LL |         Ty::List(elem) => foo(Ty::List(elem)),\n-   |                               +++++++++    +\n help: consider unboxing the value\n    |\n LL |         Ty::List(elem) => foo(*elem),\n    |                               +\n+help: try wrapping the expression in `Ty::List`\n+   |\n+LL |         Ty::List(elem) => foo(Ty::List(elem)),\n+   |                               +++++++++    +\n \n error: aborting due to previous error\n "}]}