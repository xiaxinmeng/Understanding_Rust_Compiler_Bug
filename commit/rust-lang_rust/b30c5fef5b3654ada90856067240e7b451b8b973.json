{"sha": "b30c5fef5b3654ada90856067240e7b451b8b973", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIzMGM1ZmVmNWIzNjU0YWRhOTA4NTYwNjcyNDBlN2I0NTFiOGI5NzM=", "commit": {"author": {"name": "hyd-dev", "email": "yd-huang@outlook.com", "date": "2021-04-30T10:50:40Z"}, "committer": {"name": "hyd-dev", "email": "yd-huang@outlook.com", "date": "2021-04-30T11:35:59Z"}, "message": "Rustup for rust-lang/rust#84401", "tree": {"sha": "a14d193584a3ad626e892feb13aa83626c8aa7ed", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a14d193584a3ad626e892feb13aa83626c8aa7ed"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b30c5fef5b3654ada90856067240e7b451b8b973", "comment_count": 0, "verification": {"verified": false, "reason": "no_user", "signature": "-----BEGIN PGP SIGNATURE-----\n\niIsEABYIADMWIQRJ2jPMDdiQ+U4U42Z0+n/VuNoUuAUCYIvrnxUceWQtaHVhbmdA\nb3V0bG9vay5jb20ACgkQdPp/1bjaFLhdKQD7ByAGiSf1GqkeQgiuVS36zzeTEvfj\nVilMKjJ+XiCy8yEA/2NwJ/C+ioW1JtII5HBmJmgGVgGC3/pxfOrZeDGpoRkL\n=vf74\n-----END PGP SIGNATURE-----", "payload": "tree a14d193584a3ad626e892feb13aa83626c8aa7ed\nparent 5faf5a5ca059f6eb067fc86e47480f5668ac6e8c\nauthor hyd-dev <yd-huang@outlook.com> 1619779840 +0800\ncommitter hyd-dev <yd-huang@outlook.com> 1619782559 +0800\n\nRustup for rust-lang/rust#84401\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b30c5fef5b3654ada90856067240e7b451b8b973", "html_url": "https://github.com/rust-lang/rust/commit/b30c5fef5b3654ada90856067240e7b451b8b973", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b30c5fef5b3654ada90856067240e7b451b8b973/comments", "author": null, "committer": null, "parents": [{"sha": "5faf5a5ca059f6eb067fc86e47480f5668ac6e8c", "url": "https://api.github.com/repos/rust-lang/rust/commits/5faf5a5ca059f6eb067fc86e47480f5668ac6e8c", "html_url": "https://github.com/rust-lang/rust/commit/5faf5a5ca059f6eb067fc86e47480f5668ac6e8c"}], "stats": {"total": 28, "additions": 25, "deletions": 3}, "files": [{"sha": "8397fde946c56151079eecca409a79937a2089e9", "filename": "benches/helpers/miri_helper.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b30c5fef5b3654ada90856067240e7b451b8b973/benches%2Fhelpers%2Fmiri_helper.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b30c5fef5b3654ada90856067240e7b451b8b973/benches%2Fhelpers%2Fmiri_helper.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/benches%2Fhelpers%2Fmiri_helper.rs?ref=b30c5fef5b3654ada90856067240e7b451b8b973", "patch": "@@ -26,7 +26,7 @@ impl rustc_driver::Callbacks for MiriCompilerCalls<'_> {\n \n             self.bencher.iter(|| {\n                 let config = miri::MiriConfig::default();\n-                miri::eval_main(tcx, entry_def_id.to_def_id(), config);\n+                miri::eval_main(tcx, entry_def_id, config);\n             });\n         });\n "}, {"sha": "1f61617e119f4be173294707babc35d6d04a82ea", "filename": "rust-version", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b30c5fef5b3654ada90856067240e7b451b8b973/rust-version", "raw_url": "https://github.com/rust-lang/rust/raw/b30c5fef5b3654ada90856067240e7b451b8b973/rust-version", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/rust-version?ref=b30c5fef5b3654ada90856067240e7b451b8b973", "patch": "@@ -1 +1 @@\n-06f0adb34570ba83fee391abeb0bec0eec28a234\n+bcd696d722c04a0f8c34d884aa4ed2322f55cdd8"}, {"sha": "41776090be443de04fefb2580e9e9a8c7794aa35", "filename": "src/bin/miri.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b30c5fef5b3654ada90856067240e7b451b8b973/src%2Fbin%2Fmiri.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b30c5fef5b3654ada90856067240e7b451b8b973/src%2Fbin%2Fmiri.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbin%2Fmiri.rs?ref=b30c5fef5b3654ada90856067240e7b451b8b973", "patch": "@@ -50,7 +50,7 @@ impl rustc_driver::Callbacks for MiriCompilerCalls {\n                 env::set_current_dir(cwd).unwrap();\n             }\n \n-            if let Some(return_code) = miri::eval_main(tcx, entry_def_id.to_def_id(), config) {\n+            if let Some(return_code) = miri::eval_main(tcx, entry_def_id, config) {\n                 std::process::exit(\n                     i32::try_from(return_code).expect(\"Return value was too large!\"),\n                 );"}, {"sha": "4dbe1aeff23a3c44403caa73d10e683ecd349670", "filename": "test-cargo-miri/Cargo.toml", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b30c5fef5b3654ada90856067240e7b451b8b973/test-cargo-miri%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/b30c5fef5b3654ada90856067240e7b451b8b973/test-cargo-miri%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2FCargo.toml?ref=b30c5fef5b3654ada90856067240e7b451b8b973", "patch": "@@ -23,3 +23,7 @@ serde_derive = \"1.0\" # not actually used, but exercises some unique code path (`\n \n [lib]\n test = false # test that this is respected (will show in the output)\n+\n+[[test]]\n+name = \"main\"\n+harness = false"}, {"sha": "9d8eb067d6fa73a98d91557c0b01322d918bbfbc", "filename": "test-cargo-miri/src/lib.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b30c5fef5b3654ada90856067240e7b451b8b973/test-cargo-miri%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b30c5fef5b3654ada90856067240e7b451b8b973/test-cargo-miri%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Fsrc%2Flib.rs?ref=b30c5fef5b3654ada90856067240e7b451b8b973", "patch": "@@ -14,3 +14,7 @@ pub fn make_true() -> bool {\n     issue_1760::use_the_dependency!();\n     issue_1691::use_me()\n }\n+\n+pub fn main() {\n+    println!(\"imported main\");\n+}"}, {"sha": "e36abd870663e25bcb4ea7a4c14572a926530e02", "filename": "test-cargo-miri/test.cross-target.stdout.ref", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b30c5fef5b3654ada90856067240e7b451b8b973/test-cargo-miri%2Ftest.cross-target.stdout.ref", "raw_url": "https://github.com/rust-lang/rust/raw/b30c5fef5b3654ada90856067240e7b451b8b973/test-cargo-miri%2Ftest.cross-target.stdout.ref", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Ftest.cross-target.stdout.ref?ref=b30c5fef5b3654ada90856067240e7b451b8b973", "patch": "@@ -3,6 +3,7 @@ running 1 test\n .\n test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\n \n+imported main\n \n running 7 tests\n ..i...."}, {"sha": "470e5b36fc515dc3883d2c889941675596f207b2", "filename": "test-cargo-miri/test.default.stdout.ref", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b30c5fef5b3654ada90856067240e7b451b8b973/test-cargo-miri%2Ftest.default.stdout.ref", "raw_url": "https://github.com/rust-lang/rust/raw/b30c5fef5b3654ada90856067240e7b451b8b973/test-cargo-miri%2Ftest.default.stdout.ref", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Ftest.default.stdout.ref?ref=b30c5fef5b3654ada90856067240e7b451b8b973", "patch": "@@ -3,6 +3,7 @@ running 1 test\n .\n test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\n \n+imported main\n \n running 7 tests\n ..i...."}, {"sha": "fb722c5e71239692bc4c383780692ed614bcc434", "filename": "test-cargo-miri/test.filter.cross-target.stdout.ref", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b30c5fef5b3654ada90856067240e7b451b8b973/test-cargo-miri%2Ftest.filter.cross-target.stdout.ref", "raw_url": "https://github.com/rust-lang/rust/raw/b30c5fef5b3654ada90856067240e7b451b8b973/test-cargo-miri%2Ftest.filter.cross-target.stdout.ref", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Ftest.filter.cross-target.stdout.ref?ref=b30c5fef5b3654ada90856067240e7b451b8b973", "patch": "@@ -3,6 +3,7 @@ running 0 tests\n \n test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 1 filtered out\n \n+imported main\n \n running 1 test\n test simple1 ... ok"}, {"sha": "cf1b309a127867dae4c8a1cd00b3d2bcfbb21ca4", "filename": "test-cargo-miri/test.filter.stdout.ref", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b30c5fef5b3654ada90856067240e7b451b8b973/test-cargo-miri%2Ftest.filter.stdout.ref", "raw_url": "https://github.com/rust-lang/rust/raw/b30c5fef5b3654ada90856067240e7b451b8b973/test-cargo-miri%2Ftest.filter.stdout.ref", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Ftest.filter.stdout.ref?ref=b30c5fef5b3654ada90856067240e7b451b8b973", "patch": "@@ -3,6 +3,7 @@ running 0 tests\n \n test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 1 filtered out\n \n+imported main\n \n running 1 test\n test simple1 ... ok"}, {"sha": "bb94c8f37876ca35598b66dc6885413e86820d35", "filename": "test-cargo-miri/tests/main.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/b30c5fef5b3654ada90856067240e7b451b8b973/test-cargo-miri%2Ftests%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b30c5fef5b3654ada90856067240e7b451b8b973/test-cargo-miri%2Ftests%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Ftests%2Fmain.rs?ref=b30c5fef5b3654ada90856067240e7b451b8b973", "patch": "@@ -0,0 +1,3 @@\n+#![feature(imported_main)]\n+\n+use cargo_miri_test::main;"}, {"sha": "3b84d1abe6f3df15469de3a71dcc55bb0ecef793", "filename": "tests/run-pass/main_fn.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/b30c5fef5b3654ada90856067240e7b451b8b973/tests%2Frun-pass%2Fmain_fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b30c5fef5b3654ada90856067240e7b451b8b973/tests%2Frun-pass%2Fmain_fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fmain_fn.rs?ref=b30c5fef5b3654ada90856067240e7b451b8b973", "patch": "@@ -0,0 +1,7 @@\n+#![feature(imported_main)]\n+\n+mod foo {\n+    pub(crate) fn bar() {}\n+}\n+\n+use foo::bar as main;"}]}