{"sha": "5691da4c84655e0d966ac11406fa7a90bdd02643", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU2OTFkYTRjODQ2NTVlMGQ5NjZhYzExNDA2ZmE3YTkwYmRkMDI2NDM=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-08-05T11:16:38Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-08-05T11:16:38Z"}, "message": "Expr macros", "tree": {"sha": "566597ece1387006e3c8e55d82c5f93ed55ee112", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/566597ece1387006e3c8e55d82c5f93ed55ee112"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5691da4c84655e0d966ac11406fa7a90bdd02643", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5691da4c84655e0d966ac11406fa7a90bdd02643", "html_url": "https://github.com/rust-lang/rust/commit/5691da4c84655e0d966ac11406fa7a90bdd02643", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5691da4c84655e0d966ac11406fa7a90bdd02643/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c871022f9810547f3eeaa5af3a3dc4bc0c85a386", "url": "https://api.github.com/repos/rust-lang/rust/commits/c871022f9810547f3eeaa5af3a3dc4bc0c85a386", "html_url": "https://github.com/rust-lang/rust/commit/c871022f9810547f3eeaa5af3a3dc4bc0c85a386"}], "stats": {"total": 55, "additions": 42, "deletions": 13}, "files": [{"sha": "15669f99dcb567114f999bff489c09133759df76", "filename": "src/grammar/expressions/mod.rs", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/5691da4c84655e0d966ac11406fa7a90bdd02643/src%2Fgrammar%2Fexpressions%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5691da4c84655e0d966ac11406fa7a90bdd02643/src%2Fgrammar%2Fexpressions%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fgrammar%2Fexpressions%2Fmod.rs?ref=5691da4c84655e0d966ac11406fa7a90bdd02643", "patch": "@@ -202,16 +202,22 @@ fn arg_list(p: &mut Parser) {\n //     let _ = a;\n //     let _ = a::b;\n //     let _ = ::a::<b>;\n+//     let _ = format!();\n // }\n fn path_expr(p: &mut Parser, r: Restrictions) -> CompletedMarker {\n     assert!(paths::is_path_start(p));\n     let m = p.start();\n     paths::expr_path(p);\n-    if p.at(L_CURLY) && !r.forbid_structs {\n-        struct_lit(p);\n-        m.complete(p, STRUCT_LIT)\n-    } else {\n-        m.complete(p, PATH_EXPR)\n+    match p.current() {\n+        L_CURLY if !r.forbid_structs => {\n+            struct_lit(p);\n+            m.complete(p, STRUCT_LIT)\n+        }\n+        EXCL => {\n+            items::macro_call_after_excl(p);\n+            m.complete(p, MACRO_CALL)\n+        }\n+        _ => m.complete(p, PATH_EXPR)\n     }\n }\n "}, {"sha": "657078765623822aa9ee19bd2c404410f808bc3b", "filename": "src/grammar/items/mod.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/5691da4c84655e0d966ac11406fa7a90bdd02643/src%2Fgrammar%2Fitems%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5691da4c84655e0d966ac11406fa7a90bdd02643/src%2Fgrammar%2Fitems%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fgrammar%2Fitems%2Fmod.rs?ref=5691da4c84655e0d966ac11406fa7a90bdd02643", "patch": "@@ -277,14 +277,18 @@ fn mod_item(p: &mut Parser) {\n     }\n }\n \n-enum MacroFlavor {\n+pub(super) enum MacroFlavor {\n     Curly,\n     NonCurly,\n }\n \n fn macro_call(p: &mut Parser) -> MacroFlavor {\n     assert!(paths::is_path_start(p));\n     paths::use_path(p);\n+    macro_call_after_excl(p)\n+}\n+\n+pub(super) fn macro_call_after_excl(p: &mut Parser) -> MacroFlavor {\n     p.expect(EXCL);\n     p.eat(IDENT);\n     let flavor = match p.current() {"}, {"sha": "333ebabef48ae9f626800cc5efe768513e0e973e", "filename": "tests/data/parser/inline/0039_path_expr.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5691da4c84655e0d966ac11406fa7a90bdd02643/tests%2Fdata%2Fparser%2Finline%2F0039_path_expr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5691da4c84655e0d966ac11406fa7a90bdd02643/tests%2Fdata%2Fparser%2Finline%2F0039_path_expr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Finline%2F0039_path_expr.rs?ref=5691da4c84655e0d966ac11406fa7a90bdd02643", "patch": "@@ -2,4 +2,5 @@ fn foo() {\n     let _ = a;\n     let _ = a::b;\n     let _ = ::a::<b>;\n+    let _ = format!();\n }"}, {"sha": "a3e2dbbe89bf982e016dc9d285a63125a8edd458", "filename": "tests/data/parser/inline/0039_path_expr.txt", "status": "modified", "additions": 25, "deletions": 7, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/5691da4c84655e0d966ac11406fa7a90bdd02643/tests%2Fdata%2Fparser%2Finline%2F0039_path_expr.txt", "raw_url": "https://github.com/rust-lang/rust/raw/5691da4c84655e0d966ac11406fa7a90bdd02643/tests%2Fdata%2Fparser%2Finline%2F0039_path_expr.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Finline%2F0039_path_expr.txt?ref=5691da4c84655e0d966ac11406fa7a90bdd02643", "patch": "@@ -1,5 +1,5 @@\n-FILE@[0; 68)\n-  FN_ITEM@[0; 68)\n+FILE@[0; 91)\n+  FN_ITEM@[0; 91)\n     FN_KW@[0; 2)\n     NAME@[2; 6)\n       WHITESPACE@[2; 3)\n@@ -8,7 +8,7 @@ FILE@[0; 68)\n       L_PAREN@[6; 7)\n       R_PAREN@[7; 8)\n       WHITESPACE@[8; 9)\n-    BLOCK_EXPR@[9; 68)\n+    BLOCK_EXPR@[9; 91)\n       L_CURLY@[9; 10)\n       LET_STMT@[10; 30)\n         WHITESPACE@[10; 15)\n@@ -46,7 +46,7 @@ FILE@[0; 68)\n                 IDENT@[41; 42) \"b\"\n         SEMI@[42; 43)\n         WHITESPACE@[43; 48)\n-      LET_STMT@[48; 66)\n+      LET_STMT@[48; 70)\n         LET_KW@[48; 51)\n         PLACEHOLDER_PAT@[51; 54)\n           WHITESPACE@[51; 52)\n@@ -71,6 +71,24 @@ FILE@[0; 68)\n                           IDENT@[62; 63) \"b\"\n                 R_ANGLE@[63; 64)\n         SEMI@[64; 65)\n-        WHITESPACE@[65; 66)\n-      R_CURLY@[66; 67)\n-      WHITESPACE@[67; 68)\n+        WHITESPACE@[65; 70)\n+      LET_STMT@[70; 89)\n+        LET_KW@[70; 73)\n+        PLACEHOLDER_PAT@[73; 76)\n+          WHITESPACE@[73; 74)\n+          UNDERSCORE@[74; 75)\n+          WHITESPACE@[75; 76)\n+        EQ@[76; 77)\n+        MACRO_CALL@[77; 87)\n+          PATH@[77; 84)\n+            PATH_SEGMENT@[77; 84)\n+              NAME_REF@[77; 84)\n+                WHITESPACE@[77; 78)\n+                IDENT@[78; 84) \"format\"\n+          EXCL@[84; 85)\n+          L_PAREN@[85; 86)\n+          R_PAREN@[86; 87)\n+        SEMI@[87; 88)\n+        WHITESPACE@[88; 89)\n+      R_CURLY@[89; 90)\n+      WHITESPACE@[90; 91)"}]}