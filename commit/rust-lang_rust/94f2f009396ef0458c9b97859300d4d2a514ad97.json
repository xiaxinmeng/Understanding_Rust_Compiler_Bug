{"sha": "94f2f009396ef0458c9b97859300d4d2a514ad97", "node_id": "C_kwDOAAsO6NoAKDk0ZjJmMDA5Mzk2ZWYwNDU4YzliOTc4NTkzMDBkNGQyYTUxNGFkOTc", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2022-06-05T10:29:20Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2022-06-05T10:29:20Z"}, "message": "remove azure pipelines configuration", "tree": {"sha": "cc6cb5613ab569d7a2302c61d34d9f04e1398d9a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cc6cb5613ab569d7a2302c61d34d9f04e1398d9a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/94f2f009396ef0458c9b97859300d4d2a514ad97", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE1JbYPtLJAsc22U9xPgar6Auq8ZwFAmKchYcACgkQPgar6Auq\n8ZzqyQ/9GX/OVedLKUTX2A9AMqdGXA+Gged7Bmlew+G0AF9T8NaG6s2hhxJ6G/eY\nHIo7/fa2UP6TASoBZxLvHiPLVWjGW6S3/Xs12FuOzjzeox41pTDYv7F+m/2tme48\nm4c7D3PjQOvqQ188RBUL8VA1N8EAN9jkMBzjQWilf4z8YigRJFN7sfIQUl6YJtNY\nrUXlQ7R23PEpwcntwJnPMFG2w0bsp3luLyqOjachZ82o4zZwaaHa1fibmXCCCFQH\nxEi+q4uvUQKzQhpVQWn1r12VJLL+g9PSe7o9OrfPkMOhdXJBuBOowZYOkf38VSkb\nb75uU07KWa4vktIdFSEIuWC1atEozuHcTAVqJSkSUPLflu1FcH78xpEO0W8yTH/P\nIQjV5UtgdMZa07dt82sp+FqGgx2OB8yuMM3wcNmfQQqQmEsuIbHsBnR1Lv+sqPWy\nnWgH0sb2wvpmUreAD6ljSwHcyz6wZtwE2wSlPbYgRrIOq70QN6sVGinTG1fRDqN+\nH58zB9a47K3IHWCzbql/el5HEP6ugOzAYl7iL3MUTAAUiR6IHRGqssy2sGoJV9eW\nNiVo0B0R2UPZPOqmSwLGi5rkCV110ndXTzOZfFfav94dnccNO5z/IiDx4W3QQYBm\nF+JG/01cdlAhJZLoTQCdaWeTA2SXgFZWFfuamXaQKSMe7hmVfk8=\n=bjjZ\n-----END PGP SIGNATURE-----", "payload": "tree cc6cb5613ab569d7a2302c61d34d9f04e1398d9a\nparent a2da4af33c5e6a22fff0a223f99d53cba4a5aa52\nauthor Pietro Albini <pietro@pietroalbini.org> 1654424960 +0200\ncommitter Pietro Albini <pietro@pietroalbini.org> 1654424960 +0200\n\nremove azure pipelines configuration\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/94f2f009396ef0458c9b97859300d4d2a514ad97", "html_url": "https://github.com/rust-lang/rust/commit/94f2f009396ef0458c9b97859300d4d2a514ad97", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/94f2f009396ef0458c9b97859300d4d2a514ad97/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a2da4af33c5e6a22fff0a223f99d53cba4a5aa52", "url": "https://api.github.com/repos/rust-lang/rust/commits/a2da4af33c5e6a22fff0a223f99d53cba4a5aa52", "html_url": "https://github.com/rust-lang/rust/commit/a2da4af33c5e6a22fff0a223f99d53cba4a5aa52"}], "stats": {"total": 122, "additions": 7, "deletions": 115}, "files": [{"sha": "a7be9978c0bc564cc06ad5f15ecd654937f60c57", "filename": ".github/workflows/ci.yml", "status": "modified", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/94f2f009396ef0458c9b97859300d4d2a514ad97/.github%2Fworkflows%2Fci.yml", "raw_url": "https://github.com/rust-lang/rust/raw/94f2f009396ef0458c9b97859300d4d2a514ad97/.github%2Fworkflows%2Fci.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fci.yml?ref=94f2f009396ef0458c9b97859300d4d2a514ad97", "patch": "@@ -98,9 +98,6 @@ jobs:\n       - name: install WIX\n         run: src/ci/scripts/install-wix.sh\n         if: success() && !env.SKIP_JOB\n-      - name: ensure the build happens on a partition with enough space\n-        run: src/ci/scripts/symlink-build-dir.sh\n-        if: success() && !env.SKIP_JOB\n       - name: disable git crlf conversion\n         run: src/ci/scripts/disable-git-crlf-conversion.sh\n         if: success() && !env.SKIP_JOB\n@@ -496,9 +493,6 @@ jobs:\n       - name: install WIX\n         run: src/ci/scripts/install-wix.sh\n         if: success() && !env.SKIP_JOB\n-      - name: ensure the build happens on a partition with enough space\n-        run: src/ci/scripts/symlink-build-dir.sh\n-        if: success() && !env.SKIP_JOB\n       - name: disable git crlf conversion\n         run: src/ci/scripts/disable-git-crlf-conversion.sh\n         if: success() && !env.SKIP_JOB\n@@ -609,9 +603,6 @@ jobs:\n       - name: install WIX\n         run: src/ci/scripts/install-wix.sh\n         if: success() && !env.SKIP_JOB\n-      - name: ensure the build happens on a partition with enough space\n-        run: src/ci/scripts/symlink-build-dir.sh\n-        if: success() && !env.SKIP_JOB\n       - name: disable git crlf conversion\n         run: src/ci/scripts/disable-git-crlf-conversion.sh\n         if: success() && !env.SKIP_JOB"}, {"sha": "37c2e9bc35a0db9ba3efc3b679453db8a7089237", "filename": "src/ci/azure-pipelines/auto.yml", "status": "removed", "additions": 0, "deletions": 26, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/a2da4af33c5e6a22fff0a223f99d53cba4a5aa52/src%2Fci%2Fazure-pipelines%2Fauto.yml", "raw_url": "https://github.com/rust-lang/rust/raw/a2da4af33c5e6a22fff0a223f99d53cba4a5aa52/src%2Fci%2Fazure-pipelines%2Fauto.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fazure-pipelines%2Fauto.yml?ref=a2da4af33c5e6a22fff0a223f99d53cba4a5aa52", "patch": "@@ -1,26 +0,0 @@\n-#####################################\n-##    READ BEFORE CHANGING THIS    ##\n-#####################################\n-\n-# We're in the process of evaluating GitHub Actions as a possible replacement\n-# for Azure Pipelines, and at the moment the configuration is duplicated\n-# between the two CI providers. Be sure to also change the configuration in\n-# src/ci/github-actions when changing this file.\n-\n-#####################################\n-\n-#\n-# Azure Pipelines \"auto\" branch build for Rust on macOS\n-#\n-\n-pr: none\n-trigger:\n-  - auto\n-\n-jobs:\n-- job: Dummy\n-  timeoutInMinutes: 600\n-  pool:\n-    vmImage: ubuntu-16.04\n-  steps:\n-  - bash: echo \"We're running this job since bors is still gating on Azure\""}, {"sha": "62bb6f47334123f79f34d6d77bd552ba99ea2900", "filename": "src/ci/azure-pipelines/try.yml", "status": "removed", "additions": 0, "deletions": 22, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/a2da4af33c5e6a22fff0a223f99d53cba4a5aa52/src%2Fci%2Fazure-pipelines%2Ftry.yml", "raw_url": "https://github.com/rust-lang/rust/raw/a2da4af33c5e6a22fff0a223f99d53cba4a5aa52/src%2Fci%2Fazure-pipelines%2Ftry.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fazure-pipelines%2Ftry.yml?ref=a2da4af33c5e6a22fff0a223f99d53cba4a5aa52", "patch": "@@ -1,22 +0,0 @@\n-#####################################\n-##    READ BEFORE CHANGING THIS    ##\n-#####################################\n-\n-# We're in the process of evaluating GitHub Actions as a possible replacement\n-# for Azure Pipelines, and at the moment the configuration is duplicated\n-# between the two CI providers. Be sure to also change the configuration in\n-# src/ci/github-actions when changing this file.\n-\n-#####################################\n-\n-pr: none\n-trigger:\n-- try\n-\n-jobs:\n-- job: Dummy\n-  timeoutInMinutes: 600\n-  pool:\n-    vmImage: ubuntu-16.04\n-  steps:\n-  - bash: echo \"We're running this job since bors is still gating on Azure\""}, {"sha": "57832ac2b9594866920b9a39aefb340a3a55e83f", "filename": "src/ci/github-actions/ci.yml", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/94f2f009396ef0458c9b97859300d4d2a514ad97/src%2Fci%2Fgithub-actions%2Fci.yml", "raw_url": "https://github.com/rust-lang/rust/raw/94f2f009396ef0458c9b97859300d4d2a514ad97/src%2Fci%2Fgithub-actions%2Fci.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fgithub-actions%2Fci.yml?ref=94f2f009396ef0458c9b97859300d4d2a514ad97", "patch": "@@ -161,10 +161,6 @@ x--expand-yaml-anchors--remove:\n         run: src/ci/scripts/install-wix.sh\n         <<: *step\n \n-      - name: ensure the build happens on a partition with enough space\n-        run: src/ci/scripts/symlink-build-dir.sh\n-        <<: *step\n-\n       - name: disable git crlf conversion\n         run: src/ci/scripts/disable-git-crlf-conversion.sh\n         <<: *step"}, {"sha": "0bc35f932832cfa84a8723791293b26883ea6613", "filename": "src/ci/scripts/setup-environment.sh", "status": "modified", "additions": 0, "deletions": 15, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/94f2f009396ef0458c9b97859300d4d2a514ad97/src%2Fci%2Fscripts%2Fsetup-environment.sh", "raw_url": "https://github.com/rust-lang/rust/raw/94f2f009396ef0458c9b97859300d4d2a514ad97/src%2Fci%2Fscripts%2Fsetup-environment.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fscripts%2Fsetup-environment.sh?ref=94f2f009396ef0458c9b97859300d4d2a514ad97", "patch": "@@ -8,21 +8,6 @@ IFS=$'\\n\\t'\n \n source \"$(cd \"$(dirname \"$0\")\" && pwd)/../shared.sh\"\n \n-# Since matrix variables are readonly in Azure Pipelines, we take\n-# INITIAL_RUST_CONFIGURE_ARGS and establish RUST_CONFIGURE_ARGS\n-# which downstream steps can alter\n-if isAzurePipelines; then\n-    # macOS ships with Bash 3.16, so we cannot use [[ -v FOO ]],\n-    # which was introduced in Bash 4.2\n-    if [[ -z \"${INITIAL_RUST_CONFIGURE_ARGS+x}\" ]]; then\n-        INITIAL_RUST_CONFIG=\"\"\n-        echo \"No initial Rust configure args set\"\n-    else\n-        INITIAL_RUST_CONFIG=\"${INITIAL_RUST_CONFIGURE_ARGS}\"\n-        ciCommandSetEnv RUST_CONFIGURE_ARGS \"${INITIAL_RUST_CONFIG}\"\n-    fi\n-fi\n-\n # Load extra environment variables\n vars=\"${EXTRA_VARIABLES-}\"\n echo \"${vars}\" | jq '' >/dev/null  # Validate JSON and exit on errors"}, {"sha": "23849f7047c546e173c94f3471a5749899ecae3d", "filename": "src/ci/scripts/symlink-build-dir.sh", "status": "removed", "additions": 0, "deletions": 15, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/a2da4af33c5e6a22fff0a223f99d53cba4a5aa52/src%2Fci%2Fscripts%2Fsymlink-build-dir.sh", "raw_url": "https://github.com/rust-lang/rust/raw/a2da4af33c5e6a22fff0a223f99d53cba4a5aa52/src%2Fci%2Fscripts%2Fsymlink-build-dir.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fscripts%2Fsymlink-build-dir.sh?ref=a2da4af33c5e6a22fff0a223f99d53cba4a5aa52", "patch": "@@ -1,15 +0,0 @@\n-#!/bin/bash\n-# We've had multiple issues with the default disk running out of disk space\n-# during builds, and it looks like other disks mounted in the VMs have more\n-# space available. This script synlinks the build directory to those other\n-# disks, in the CI providers and OSes affected by this.\n-\n-set -euo pipefail\n-IFS=$'\\n\\t'\n-\n-source \"$(cd \"$(dirname \"$0\")\" && pwd)/../shared.sh\"\n-\n-if isWindows && isAzurePipelines; then\n-    cmd //c \"mkdir c:\\\\MORE_SPACE\"\n-    cmd //c \"mklink /J build c:\\\\MORE_SPACE\"\n-fi"}, {"sha": "8a88c56194c604a3e351d7dbd853d4c13c6f5cfb", "filename": "src/ci/shared.sh", "status": "modified", "additions": 7, "deletions": 24, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/94f2f009396ef0458c9b97859300d4d2a514ad97/src%2Fci%2Fshared.sh", "raw_url": "https://github.com/rust-lang/rust/raw/94f2f009396ef0458c9b97859300d4d2a514ad97/src%2Fci%2Fshared.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fshared.sh?ref=94f2f009396ef0458c9b97859300d4d2a514ad97", "patch": "@@ -28,11 +28,7 @@ function retry {\n }\n \n function isCI {\n-    [[ \"${CI-false}\" = \"true\" ]] || isAzurePipelines || isGitHubActions\n-}\n-\n-function isAzurePipelines {\n-    [[ \"${TF_BUILD-False}\" = \"True\" ]]\n+    [[ \"${CI-false}\" = \"true\" ]] || isGitHubActions\n }\n \n function isGitHubActions {\n@@ -63,9 +59,7 @@ function isCiBranch {\n     fi\n     name=\"$1\"\n \n-    if isAzurePipelines; then\n-        [[ \"${BUILD_SOURCEBRANCHNAME}\" = \"${name}\" ]]\n-    elif isGitHubActions; then\n+    if isGitHubActions; then\n         [[ \"${GITHUB_REF}\" = \"refs/heads/${name}\" ]]\n     else\n         echo \"isCiBranch only works inside CI!\"\n@@ -74,10 +68,7 @@ function isCiBranch {\n }\n \n function ciBaseBranch {\n-    if isAzurePipelines; then\n-        echo \"unsupported on Azure Pipelines\"\n-        exit 1\n-    elif isGitHubActions; then\n+    if isGitHubActions; then\n         echo \"${GITHUB_BASE_REF#refs/heads/}\"\n     else\n         echo \"ciBaseBranch only works inside CI!\"\n@@ -86,9 +77,7 @@ function ciBaseBranch {\n }\n \n function ciCommit {\n-    if isAzurePipelines; then\n-        echo \"${BUILD_SOURCEVERSION}\"\n-    elif isGitHubActions; then\n+    if isGitHubActions; then\n         echo \"${GITHUB_SHA}\"\n     else\n         echo \"ciCommit only works inside CI!\"\n@@ -97,9 +86,7 @@ function ciCommit {\n }\n \n function ciCheckoutPath {\n-    if isAzurePipelines; then\n-        echo \"${BUILD_SOURCESDIRECTORY}\"\n-    elif isGitHubActions; then\n+    if isGitHubActions; then\n         echo \"${GITHUB_WORKSPACE}\"\n     else\n         echo \"ciCheckoutPath only works inside CI!\"\n@@ -114,9 +101,7 @@ function ciCommandAddPath {\n     fi\n     path=\"$1\"\n \n-    if isAzurePipelines; then\n-        echo \"##vso[task.prependpath]${path}\"\n-    elif isGitHubActions; then\n+    if isGitHubActions; then\n         echo \"${path}\" >> \"${GITHUB_PATH}\"\n     else\n         echo \"ciCommandAddPath only works inside CI!\"\n@@ -132,9 +117,7 @@ function ciCommandSetEnv {\n     name=\"$1\"\n     value=\"$2\"\n \n-    if isAzurePipelines; then\n-        echo \"##vso[task.setvariable variable=${name}]${value}\"\n-    elif isGitHubActions; then\n+    if isGitHubActions; then\n         echo \"${name}=${value}\" >> \"${GITHUB_ENV}\"\n     else\n         echo \"ciCommandSetEnv only works inside CI!\""}]}