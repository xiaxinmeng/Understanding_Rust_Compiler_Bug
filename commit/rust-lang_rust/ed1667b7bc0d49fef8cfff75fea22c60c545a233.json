{"sha": "ed1667b7bc0d49fef8cfff75fea22c60c545a233", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVkMTY2N2I3YmMwZDQ5ZmVmOGNmZmY3NWZlYTIyYzYwYzU0NWEyMzM=", "commit": {"author": {"name": "Oliver Schneider", "email": "github35764891676564198441@oli-obk.de", "date": "2018-08-09T07:41:32Z"}, "committer": {"name": "Oliver Schneider", "email": "github35764891676564198441@oli-obk.de", "date": "2018-08-09T07:41:32Z"}, "message": "Version checks are useless now that we ride the trains", "tree": {"sha": "2473660fe07a69df8c3c0ccfd87efc52e62c0747", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2473660fe07a69df8c3c0ccfd87efc52e62c0747"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ed1667b7bc0d49fef8cfff75fea22c60c545a233", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ed1667b7bc0d49fef8cfff75fea22c60c545a233", "html_url": "https://github.com/rust-lang/rust/commit/ed1667b7bc0d49fef8cfff75fea22c60c545a233", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ed1667b7bc0d49fef8cfff75fea22c60c545a233/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "99a087bea59c8f808b5485c6113edf9ce774e94a", "url": "https://api.github.com/repos/rust-lang/rust/commits/99a087bea59c8f808b5485c6113edf9ce774e94a", "html_url": "https://github.com/rust-lang/rust/commit/99a087bea59c8f808b5485c6113edf9ce774e94a"}], "stats": {"total": 98, "additions": 0, "deletions": 98}, "files": [{"sha": "798b713a07f67b2a76562588f79c3df08f50c63a", "filename": "Cargo.toml", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ed1667b7bc0d49fef8cfff75fea22c60c545a233/Cargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/ed1667b7bc0d49fef8cfff75fea22c60c545a233/Cargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.toml?ref=ed1667b7bc0d49fef8cfff75fea22c60c545a233", "patch": "@@ -59,9 +59,5 @@ derive-new = \"0.5\"\n # for more information.\n rustc-workspace-hack = \"1.0.0\"\n \n-[build-dependencies]\n-rustc_version = \"0.2.2\"\n-ansi_term = \"0.11\"\n-\n [features]\n debugging = []"}, {"sha": "3b9f217c8848fa968dd5a70092ad2284c0f7ad78", "filename": "build.rs", "status": "modified", "additions": 0, "deletions": 87, "changes": 87, "blob_url": "https://github.com/rust-lang/rust/blob/ed1667b7bc0d49fef8cfff75fea22c60c545a233/build.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ed1667b7bc0d49fef8cfff75fea22c60c545a233/build.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/build.rs?ref=ed1667b7bc0d49fef8cfff75fea22c60c545a233", "patch": "@@ -13,98 +13,11 @@\n //! This build script was originally taken from the Rocket web framework:\n //! https://github.com/SergioBenitez/Rocket\n \n-use ansi_term::Colour::Red;\n-use rustc_version::{version_meta, version_meta_for, Channel, Version, VersionMeta};\n use std::env;\n \n fn main() {\n-    check_rustc_version();\n-\n     // Forward the profile to the main compilation\n     println!(\"cargo:rustc-env=PROFILE={}\", env::var(\"PROFILE\").unwrap());\n     // Don't rebuild even if nothing changed\n     println!(\"cargo:rerun-if-changed=build.rs\");\n }\n-\n-fn check_rustc_version() {\n-    let string = include_str!(\"min_version.txt\");\n-    let min_version_meta = version_meta_for(string).expect(\"Could not parse version string in min_version.txt\");\n-    let current_version_meta = version_meta().expect(\"Could not retrieve current rustc version information from ENV\");\n-\n-    let min_version = min_version_meta.clone().semver;\n-    let min_date_str = min_version_meta\n-        .clone()\n-        .commit_date\n-        .expect(\"min_version.txt does not contain a rustc commit date\");\n-\n-    // Dev channel (rustc built from git) does not have any date or commit information in rustc -vV\n-    // `current_version_meta.commit_date` would crash, so we return early here.\n-    if current_version_meta.channel == Channel::Dev {\n-        return;\n-    }\n-\n-    let current_version = current_version_meta.clone().semver;\n-    let current_date_str = current_version_meta\n-        .clone()\n-        .commit_date\n-        .expect(\"current rustc version information does not contain a rustc commit date\");\n-\n-    let print_version_err = |version: &Version, date: &str| {\n-        eprintln!(\n-            \"> {} {}. {} {}.\\n\",\n-            \"Installed rustc version is:\",\n-            format!(\"{} ({})\", version, date),\n-            \"Minimum required rustc version:\",\n-            format!(\"{} ({})\", min_version, min_date_str)\n-        );\n-    };\n-\n-    if !correct_channel(&current_version_meta) {\n-        eprintln!(\n-            \"\\n{} {}\",\n-            Red.bold().paint(\"error:\"),\n-            \"Clippy requires a nightly version of Rust.\"\n-        );\n-        print_version_err(&current_version, &*current_date_str);\n-        eprintln!(\n-            \"{}{}{}\",\n-            \"See the README (\", \"https://github.com/rust-lang-nursery/rust-clippy#usage\", \") for more information.\"\n-        );\n-        panic!(\"Aborting compilation due to incompatible compiler.\")\n-    }\n-\n-    let current_date = str_to_ymd(&current_date_str).unwrap();\n-    let min_date = str_to_ymd(&min_date_str).unwrap();\n-\n-    if current_date < min_date {\n-        eprintln!(\n-            \"\\n{} {}\",\n-            Red.bold().paint(\"error:\"),\n-            \"Clippy does not support this version of rustc nightly.\"\n-        );\n-        eprintln!(\n-            \"> {}{}{}\",\n-            \"Use `\", \"rustup update\", \"` or your preferred method to update Rust.\"\n-        );\n-        print_version_err(&current_version, &*current_date_str);\n-        panic!(\"Aborting compilation due to incompatible compiler.\")\n-    }\n-}\n-\n-fn correct_channel(version_meta: &VersionMeta) -> bool {\n-    match version_meta.channel {\n-        Channel::Stable | Channel::Beta => false,\n-        Channel::Nightly | Channel::Dev => true,\n-    }\n-}\n-\n-/// Convert a string of %Y-%m-%d to a single u32 maintaining ordering.\n-fn str_to_ymd(ymd: &str) -> Option<u32> {\n-    let ymd: Vec<u32> = ymd.split(\"-\").filter_map(|s| s.parse::<u32>().ok()).collect();\n-    if ymd.len() != 3 {\n-        return None;\n-    }\n-\n-    let (y, m, d) = (ymd[0], ymd[1], ymd[2]);\n-    Some((y << 9) | (m << 5) | d)\n-}"}, {"sha": "bd6a57973fc5a29484ba2305a0575f5bf0dfe498", "filename": "min_version.txt", "status": "removed", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/99a087bea59c8f808b5485c6113edf9ce774e94a/min_version.txt", "raw_url": "https://github.com/rust-lang/rust/raw/99a087bea59c8f808b5485c6113edf9ce774e94a/min_version.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/min_version.txt?ref=99a087bea59c8f808b5485c6113edf9ce774e94a", "patch": "@@ -1,7 +0,0 @@\n-rustc 1.28.0-nightly (e3bf634e0 2018-06-28)\n-binary: rustc\n-commit-hash: e3bf634e060bc2f8665878288bcea02008ca346e\n-commit-date: 2018-06-28\n-host: x86_64-unknown-linux-gnu\n-release: 1.28.0-nightly\n-LLVM version: 6.0"}]}