{"sha": "9a6c82094fb6d26084d641696873bb55f9e61cc8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjlhNmM4MjA5NGZiNmQyNjA4NGQ2NDE2OTY4NzNiYjU1ZjllNjFjYzg=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-04-19T10:08:00Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-04-19T10:08:34Z"}, "message": "Add run-rustfix for match_as_ref lint\n\n* Extracts `match_as_ref` into separate file\n* Adds `// run-rustfix` to `tests/ui/match_as_ref.rs`", "tree": {"sha": "28f5936485f2bbae3e4232b30211331c53bbd42b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/28f5936485f2bbae3e4232b30211331c53bbd42b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9a6c82094fb6d26084d641696873bb55f9e61cc8", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJEBAABCgAuFiEEj4U0bmbiMSg/mWqvgqphyqETl+YFAly5nj0QHGRldkBwaGFu\nc2NoLm5ldAAKCRCCqmHKoROX5vN0D/9QjmCreYGYJxwu9gSef0bAMGS/7YXkNtmM\nRLpH5wKzL6hQdhQdDs6O2ZeY/sCU8qwyTzTKvRKSkF/Tj/J6GVIsb4hQqt+d91i8\nAY/KdxH/IQjteTfFJ/e0SGI9G0SpkD5nJcQor7836YZGfhNZ4mgMr4uyyCzN6FDW\nbLNkUPAzgOdtIuHCVgk4FR3sl9TqQA72ORHkh+BGCcCbwDOwujUYJQ7FACF+DEDU\n4neaNDXrC32wCWpOFWFfvp08X0wL+8+MynLOTKX017kQ0B2iMb37yvQxSSaApaY9\nK3fH4QBdLAh5N92klXwiYubJZqf874pRRYtNLMwhU1ZJH4TenRND1zuZmmXs6FF+\nwHsuDj6R9dSDDXTt/WX11Ri6kWSTyH7E6hCMIrw8MdqLCs2O6swTJTxCWWcNPMUp\nGfkDjf9PsxPhBrPbg8wXikvnY4x9LeHokBzSkL37DUbIFCccNbVwL5v1EXHRuTph\niQFKFGGU7HHHfDhhPzUrE/WEG1zqTkMLLeggimB+vsWQe+0Xt5RbpmC0JX7eKIZV\n1JIO0JO6nTd1uGbnighHQKC5sbPZYfKNYZqWSdZBXumFy001q3ih7689n4f3ACxW\nHx/iBZFE1Yw9Aufs0mjSf3x9UR1vYui73GE+Uzf0C5CkDb0Y1nQIfXG0TO0OJ/Fq\n8dHsVbkxHg==\n=CtcM\n-----END PGP SIGNATURE-----", "payload": "tree 28f5936485f2bbae3e4232b30211331c53bbd42b\nparent 0d9ef393b8c2596aca6a037d3efb513afdf17875\nauthor Philipp Hansch <dev@phansch.net> 1555668480 +0200\ncommitter Philipp Hansch <dev@phansch.net> 1555668514 +0200\n\nAdd run-rustfix for match_as_ref lint\n\n* Extracts `match_as_ref` into separate file\n* Adds `// run-rustfix` to `tests/ui/match_as_ref.rs`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9a6c82094fb6d26084d641696873bb55f9e61cc8", "html_url": "https://github.com/rust-lang/rust/commit/9a6c82094fb6d26084d641696873bb55f9e61cc8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9a6c82094fb6d26084d641696873bb55f9e61cc8/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0d9ef393b8c2596aca6a037d3efb513afdf17875", "url": "https://api.github.com/repos/rust-lang/rust/commits/0d9ef393b8c2596aca6a037d3efb513afdf17875", "html_url": "https://github.com/rust-lang/rust/commit/0d9ef393b8c2596aca6a037d3efb513afdf17875"}], "stats": {"total": 98, "additions": 60, "deletions": 38}, "files": [{"sha": "75085367f961f39d7945d80faeef0cf05f1adff2", "filename": "tests/ui/match_as_ref.fixed", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/9a6c82094fb6d26084d641696873bb55f9e61cc8/tests%2Fui%2Fmatch_as_ref.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/9a6c82094fb6d26084d641696873bb55f9e61cc8/tests%2Fui%2Fmatch_as_ref.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmatch_as_ref.fixed?ref=9a6c82094fb6d26084d641696873bb55f9e61cc8", "patch": "@@ -0,0 +1,14 @@\n+// run-rustfix\n+\n+#![allow(unused)]\n+#![warn(clippy::match_as_ref)]\n+\n+fn match_as_ref() {\n+    let owned: Option<()> = None;\n+    let borrowed: Option<&()> = owned.as_ref();\n+\n+    let mut mut_owned: Option<()> = None;\n+    let borrow_mut: Option<&mut ()> = mut_owned.as_mut();\n+}\n+\n+fn main() {}"}, {"sha": "62c06f352514156cec330fe4c1724115a2953cab", "filename": "tests/ui/match_as_ref.rs", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/9a6c82094fb6d26084d641696873bb55f9e61cc8/tests%2Fui%2Fmatch_as_ref.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9a6c82094fb6d26084d641696873bb55f9e61cc8/tests%2Fui%2Fmatch_as_ref.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmatch_as_ref.rs?ref=9a6c82094fb6d26084d641696873bb55f9e61cc8", "patch": "@@ -0,0 +1,20 @@\n+// run-rustfix\n+\n+#![allow(unused)]\n+#![warn(clippy::match_as_ref)]\n+\n+fn match_as_ref() {\n+    let owned: Option<()> = None;\n+    let borrowed: Option<&()> = match owned {\n+        None => None,\n+        Some(ref v) => Some(v),\n+    };\n+\n+    let mut mut_owned: Option<()> = None;\n+    let borrow_mut: Option<&mut ()> = match mut_owned {\n+        None => None,\n+        Some(ref mut v) => Some(v),\n+    };\n+}\n+\n+fn main() {}"}, {"sha": "09115b85d35b8563aea5a07c8760f5d7a30a54c7", "filename": "tests/ui/match_as_ref.stderr", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/9a6c82094fb6d26084d641696873bb55f9e61cc8/tests%2Fui%2Fmatch_as_ref.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/9a6c82094fb6d26084d641696873bb55f9e61cc8/tests%2Fui%2Fmatch_as_ref.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmatch_as_ref.stderr?ref=9a6c82094fb6d26084d641696873bb55f9e61cc8", "patch": "@@ -0,0 +1,24 @@\n+error: use as_ref() instead\n+  --> $DIR/match_as_ref.rs:8:33\n+   |\n+LL |       let borrowed: Option<&()> = match owned {\n+   |  _________________________________^\n+LL | |         None => None,\n+LL | |         Some(ref v) => Some(v),\n+LL | |     };\n+   | |_____^ help: try this: `owned.as_ref()`\n+   |\n+   = note: `-D clippy::match-as-ref` implied by `-D warnings`\n+\n+error: use as_mut() instead\n+  --> $DIR/match_as_ref.rs:14:39\n+   |\n+LL |       let borrow_mut: Option<&mut ()> = match mut_owned {\n+   |  _______________________________________^\n+LL | |         None => None,\n+LL | |         Some(ref mut v) => Some(v),\n+LL | |     };\n+   | |_____^ help: try this: `mut_owned.as_mut()`\n+\n+error: aborting due to 2 previous errors\n+"}, {"sha": "0360cc739c8142298e5c0bade56ef42f2419aef5", "filename": "tests/ui/matches.rs", "status": "modified", "additions": 0, "deletions": 14, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/9a6c82094fb6d26084d641696873bb55f9e61cc8/tests%2Fui%2Fmatches.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9a6c82094fb6d26084d641696873bb55f9e61cc8/tests%2Fui%2Fmatches.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmatches.rs?ref=9a6c82094fb6d26084d641696873bb55f9e61cc8", "patch": "@@ -136,20 +136,6 @@ fn match_wild_err_arm() {\n     }\n }\n \n-fn match_as_ref() {\n-    let owned: Option<()> = None;\n-    let borrowed: Option<&()> = match owned {\n-        None => None,\n-        Some(ref v) => Some(v),\n-    };\n-\n-    let mut mut_owned: Option<()> = None;\n-    let borrow_mut: Option<&mut ()> = match mut_owned {\n-        None => None,\n-        Some(ref mut v) => Some(v),\n-    };\n-}\n-\n macro_rules! foo_variant(\n     ($idx:expr) => (Foo::get($idx).unwrap())\n );"}, {"sha": "27438258d2325d024e73982c28ccf382c5eaa574", "filename": "tests/ui/matches.stderr", "status": "modified", "additions": 2, "deletions": 24, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/9a6c82094fb6d26084d641696873bb55f9e61cc8/tests%2Fui%2Fmatches.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/9a6c82094fb6d26084d641696873bb55f9e61cc8/tests%2Fui%2Fmatches.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmatches.stderr?ref=9a6c82094fb6d26084d641696873bb55f9e61cc8", "patch": "@@ -256,30 +256,8 @@ LL |         Ok(3) => println!(\"ok\"),\n    |                  ^^^^^^^^^^^^^^\n    = note: this error originates in a macro outside of the current crate (in Nightly builds, run with -Z external-macro-backtrace for more info)\n \n-error: use as_ref() instead\n-  --> $DIR/matches.rs:141:33\n-   |\n-LL |       let borrowed: Option<&()> = match owned {\n-   |  _________________________________^\n-LL | |         None => None,\n-LL | |         Some(ref v) => Some(v),\n-LL | |     };\n-   | |_____^ help: try this: `owned.as_ref()`\n-   |\n-   = note: `-D clippy::match-as-ref` implied by `-D warnings`\n-\n-error: use as_mut() instead\n-  --> $DIR/matches.rs:147:39\n-   |\n-LL |       let borrow_mut: Option<&mut ()> = match mut_owned {\n-   |  _______________________________________^\n-LL | |         None => None,\n-LL | |         Some(ref mut v) => Some(v),\n-LL | |     };\n-   | |_____^ help: try this: `mut_owned.as_mut()`\n-\n error: you don't need to add `&` to all patterns\n-  --> $DIR/matches.rs:174:5\n+  --> $DIR/matches.rs:160:5\n    |\n LL | /     match foo_variant!(0) {\n LL | |         &Foo::A => println!(\"A\"),\n@@ -292,5 +270,5 @@ LL |     match *foo_variant!(0) {\n LL |         Foo::A => println!(\"A\"),\n    |\n \n-error: aborting due to 20 previous errors\n+error: aborting due to 18 previous errors\n "}]}