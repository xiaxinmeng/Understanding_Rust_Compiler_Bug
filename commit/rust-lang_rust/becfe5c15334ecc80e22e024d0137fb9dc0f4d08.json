{"sha": "becfe5c15334ecc80e22e024d0137fb9dc0f4d08", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJlY2ZlNWMxNTMzNGVjYzgwZTIyZTAyNGQwMTM3ZmI5ZGMwZjRkMDg=", "commit": {"author": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2019-11-24T20:12:38Z"}, "committer": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2019-11-24T22:21:44Z"}, "message": "Fix test.", "tree": {"sha": "5f935c45a0d99c82634fd21b3f0b004e2bc6d9dc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5f935c45a0d99c82634fd21b3f0b004e2bc6d9dc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/becfe5c15334ecc80e22e024d0137fb9dc0f4d08", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/becfe5c15334ecc80e22e024d0137fb9dc0f4d08", "html_url": "https://github.com/rust-lang/rust/commit/becfe5c15334ecc80e22e024d0137fb9dc0f4d08", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/becfe5c15334ecc80e22e024d0137fb9dc0f4d08/comments", "author": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "27513a21c4bea1774c295c398af413631807cb5c", "url": "https://api.github.com/repos/rust-lang/rust/commits/27513a21c4bea1774c295c398af413631807cb5c", "html_url": "https://github.com/rust-lang/rust/commit/27513a21c4bea1774c295c398af413631807cb5c"}], "stats": {"total": 7, "additions": 6, "deletions": 1}, "files": [{"sha": "62a66aefd2deb2854d052d709b603908b9b1fc5a", "filename": "src/test/run-make-fulldeps/issue-19371/foo.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/becfe5c15334ecc80e22e024d0137fb9dc0f4d08/src%2Ftest%2Frun-make-fulldeps%2Fissue-19371%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/becfe5c15334ecc80e22e024d0137fb9dc0f4d08/src%2Ftest%2Frun-make-fulldeps%2Fissue-19371%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fissue-19371%2Ffoo.rs?ref=becfe5c15334ecc80e22e024d0137fb9dc0f4d08", "patch": "@@ -66,6 +66,11 @@ fn compile(code: String, output: PathBuf, sysroot: PathBuf) {\n \n     interface::run_compiler(config, |compiler| {\n         // This runs all the passes prior to linking, too.\n-        compiler.link().ok();\n+        let linker = compiler.enter(|queries| {\n+            queries.linker()\n+        });\n+        if let Ok(linker) = linker {\n+            linker.link();\n+        }\n     });\n }"}]}