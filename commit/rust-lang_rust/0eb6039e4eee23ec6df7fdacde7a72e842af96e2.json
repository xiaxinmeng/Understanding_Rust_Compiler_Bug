{"sha": "0eb6039e4eee23ec6df7fdacde7a72e842af96e2", "node_id": "C_kwDOAAsO6NoAKDBlYjYwMzllNGVlZTIzZWM2ZGY3ZmRhY2RlN2E3MmU4NDJhZjk2ZTI", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-12-11T17:20:14Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-12-11T17:20:14Z"}, "message": "Merge #10987\n\n10987: fix: respect inner attributes for Structs and Enums r=lnicola a=rainy-me\n\nfix: #10980 (the allow/deny issue is not fully resolved though.)\n\nCo-authored-by: rainy-me <github@yue.coffee>", "tree": {"sha": "d59283b098a6a2ae2cb447ebcf33c57543111209", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d59283b098a6a2ae2cb447ebcf33c57543111209"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0eb6039e4eee23ec6df7fdacde7a72e842af96e2", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhtN3OCRBK7hj4Ov3rIwAAQbgIAJWWZQUM1KVLFT/y/7CywcqV\noWwv0Do57sKDisr3XkTsSr7E//d9h7SuG7Ejlh+StGhudxgoF2uW4xqoYBLojx9q\n7oldJEE2hmBiQx3e17xg5IVOq6IIV5qqz0oGkeOYbsaxsftWI+eAmrrJ8Em4LgMM\nnFGsuS4igDwcNrDKpo9Yn4CaGq04ykKgrWTz4wrtsCE1OMbL+MK4V5P1pE/+yM1+\nzVjnzZ5TqXUS+Q9IhNJvLIRggnbiE4C5YAOqQwsRMxZPb0m+0DFf7jKiHVMd1kab\nC4lBLkos6kQ2+vIS0S9Pt9Y+Kma7t3iMlX0hGNdSrg4ZgBYiCL2AxHV2MHSqWxQ=\n=fxeG\n-----END PGP SIGNATURE-----\n", "payload": "tree d59283b098a6a2ae2cb447ebcf33c57543111209\nparent 4f04d8477a1aac357e137df47f4e1ff277325c89\nparent a0c52794bdbc83790b8a33bd9660e267556ef839\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1639243214 +0000\ncommitter GitHub <noreply@github.com> 1639243214 +0000\n\nMerge #10987\n\n10987: fix: respect inner attributes for Structs and Enums r=lnicola a=rainy-me\n\nfix: #10980 (the allow/deny issue is not fully resolved though.)\n\nCo-authored-by: rainy-me <github@yue.coffee>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0eb6039e4eee23ec6df7fdacde7a72e842af96e2", "html_url": "https://github.com/rust-lang/rust/commit/0eb6039e4eee23ec6df7fdacde7a72e842af96e2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0eb6039e4eee23ec6df7fdacde7a72e842af96e2/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4f04d8477a1aac357e137df47f4e1ff277325c89", "url": "https://api.github.com/repos/rust-lang/rust/commits/4f04d8477a1aac357e137df47f4e1ff277325c89", "html_url": "https://github.com/rust-lang/rust/commit/4f04d8477a1aac357e137df47f4e1ff277325c89"}, {"sha": "a0c52794bdbc83790b8a33bd9660e267556ef839", "url": "https://api.github.com/repos/rust-lang/rust/commits/a0c52794bdbc83790b8a33bd9660e267556ef839", "html_url": "https://github.com/rust-lang/rust/commit/a0c52794bdbc83790b8a33bd9660e267556ef839"}], "stats": {"total": 17, "additions": 15, "deletions": 2}, "files": [{"sha": "9a0f457905f291e442224d2fe91fe44028e41f6b", "filename": "crates/hir_ty/src/diagnostics/decl_check.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/0eb6039e4eee23ec6df7fdacde7a72e842af96e2/crates%2Fhir_ty%2Fsrc%2Fdiagnostics%2Fdecl_check.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0eb6039e4eee23ec6df7fdacde7a72e842af96e2/crates%2Fhir_ty%2Fsrc%2Fdiagnostics%2Fdecl_check.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Fdiagnostics%2Fdecl_check.rs?ref=0eb6039e4eee23ec6df7fdacde7a72e842af96e2", "patch": "@@ -181,8 +181,12 @@ impl<'a> DeclValidator<'a> {\n                 AttrDefId::ExternBlockId(id) => Some(id.lookup(self.db.upcast()).container.into()),\n                 // These warnings should not explore macro definitions at all\n                 AttrDefId::MacroDefId(_) => None,\n-                // Will never occur under an enum/struct/union/type alias\n-                AttrDefId::AdtId(_) => None,\n+                AttrDefId::AdtId(aid) => match aid {\n+                    AdtId::StructId(sid) => Some(sid.lookup(self.db.upcast()).container.into()),\n+                    AdtId::EnumId(eid) => Some(eid.lookup(self.db.upcast()).container.into()),\n+                    // Unions aren't yet supported\n+                    AdtId::UnionId(_) => None,\n+                },\n                 AttrDefId::FieldId(_) => None,\n                 AttrDefId::EnumVariantId(_) => None,\n                 AttrDefId::TypeAliasId(_) => None,"}, {"sha": "6a78c08d44c19f39e42baa64f940cf2ccb0a1201", "filename": "crates/ide_diagnostics/src/handlers/incorrect_case.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/0eb6039e4eee23ec6df7fdacde7a72e842af96e2/crates%2Fide_diagnostics%2Fsrc%2Fhandlers%2Fincorrect_case.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0eb6039e4eee23ec6df7fdacde7a72e842af96e2/crates%2Fide_diagnostics%2Fsrc%2Fhandlers%2Fincorrect_case.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_diagnostics%2Fsrc%2Fhandlers%2Fincorrect_case.rs?ref=0eb6039e4eee23ec6df7fdacde7a72e842af96e2", "patch": "@@ -332,6 +332,15 @@ fn main() {\n         check_diagnostics(\n             r#\"\n #![allow(non_snake_case)]\n+#![allow(non_camel_case_types)]\n+\n+struct S {\n+    fooBar: bool,\n+}\n+\n+enum E {\n+    fooBar,\n+}\n \n mod F {\n     fn CheckItWorksWithCrateAttr(BAD_NAME_HI: u8) {}"}]}