{"sha": "29a9f36685c8da552d0d8772778ff4ec70af0032", "node_id": "C_kwDOAAsO6NoAKDI5YTlmMzY2ODVjOGRhNTUyZDBkODc3Mjc3OGZmNGVjNzBhZjAwMzI", "commit": {"author": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2022-06-18T17:36:12Z"}, "committer": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2022-06-18T17:36:12Z"}, "message": "Fix bug when using `--bless`", "tree": {"sha": "c1c2bdbd85a072cb9cc568353bcbbc8230d8012b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c1c2bdbd85a072cb9cc568353bcbbc8230d8012b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/29a9f36685c8da552d0d8772778ff4ec70af0032", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/29a9f36685c8da552d0d8772778ff4ec70af0032", "html_url": "https://github.com/rust-lang/rust/commit/29a9f36685c8da552d0d8772778ff4ec70af0032", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/29a9f36685c8da552d0d8772778ff4ec70af0032/comments", "author": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "committer": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b068e6aeb75c0991927fb5751ce81e3ac2d46aec", "url": "https://api.github.com/repos/rust-lang/rust/commits/b068e6aeb75c0991927fb5751ce81e3ac2d46aec", "html_url": "https://github.com/rust-lang/rust/commit/b068e6aeb75c0991927fb5751ce81e3ac2d46aec"}], "stats": {"total": 4, "additions": 1, "deletions": 3}, "files": [{"sha": "70b6af717cd384c81526a267ee437e75d134ac51", "filename": "src/etc/htmldocck.py", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29a9f36685c8da552d0d8772778ff4ec70af0032/src%2Fetc%2Fhtmldocck.py", "raw_url": "https://github.com/rust-lang/rust/raw/29a9f36685c8da552d0d8772778ff4ec70af0032/src%2Fetc%2Fhtmldocck.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fhtmldocck.py?ref=29a9f36685c8da552d0d8772778ff4ec70af0032", "patch": "@@ -417,7 +417,7 @@ def check_snapshot(snapshot_name, actual_tree, normalize_to_text):\n     snapshot_path = '{}.{}.{}'.format(rust_test_path[:-3], snapshot_name, 'html')\n     try:\n         with open(snapshot_path, 'r') as snapshot_file:\n-            expected_str = snapshot_file.read()\n+            expected_str = snapshot_file.read().replace(\"{{channel}}\", channel)\n     except FileNotFoundError:\n         if bless:\n             expected_str = None\n@@ -429,8 +429,6 @@ def check_snapshot(snapshot_name, actual_tree, normalize_to_text):\n     else:\n         actual_str = flatten(actual_tree)\n \n-    expected_str = expected_str.replace(\"{{channel}}\", channel)\n-\n     # Conditions:\n     #  1. Is --bless\n     #  2. Are actual and expected tree different"}]}