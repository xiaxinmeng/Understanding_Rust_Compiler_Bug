{"sha": "8771319dfa545611452e23ae0f41b1b5f133514a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg3NzEzMTlkZmE1NDU2MTE0NTJlMjNhZTBmNDFiMWI1ZjEzMzUxNGE=", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2020-04-12T18:02:48Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2020-04-12T18:04:17Z"}, "message": "rustbuild: Remove LLD flavor workaround for MSVC", "tree": {"sha": "e9519b8dfa5fa5e6a5eba4b6e5a979d3a36da6a4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e9519b8dfa5fa5e6a5eba4b6e5a979d3a36da6a4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8771319dfa545611452e23ae0f41b1b5f133514a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8771319dfa545611452e23ae0f41b1b5f133514a", "html_url": "https://github.com/rust-lang/rust/commit/8771319dfa545611452e23ae0f41b1b5f133514a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8771319dfa545611452e23ae0f41b1b5f133514a/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4d1fbaccb822b6d52dc786589de7918d3c5effb1", "url": "https://api.github.com/repos/rust-lang/rust/commits/4d1fbaccb822b6d52dc786589de7918d3c5effb1", "html_url": "https://github.com/rust-lang/rust/commit/4d1fbaccb822b6d52dc786589de7918d3c5effb1"}], "stats": {"total": 21, "additions": 0, "deletions": 21}, "files": [{"sha": "a8c00c8c3ca88368764e4d5cb22068f9057671fc", "filename": "src/bootstrap/bin/rustc.rs", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/8771319dfa545611452e23ae0f41b1b5f133514a/src%2Fbootstrap%2Fbin%2Frustc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8771319dfa545611452e23ae0f41b1b5f133514a/src%2Fbootstrap%2Fbin%2Frustc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbin%2Frustc.rs?ref=8771319dfa545611452e23ae0f41b1b5f133514a", "patch": "@@ -134,11 +134,6 @@ fn main() {\n             cmd.arg(format!(\"-Clinker={}\", host_linker));\n         }\n \n-        // Override linker flavor if necessary.\n-        if let Ok(host_linker_flavor) = env::var(\"RUSTC_HOST_LINKER_FLAVOR\") {\n-            cmd.arg(format!(\"-Clinker-flavor={}\", host_linker_flavor));\n-        }\n-\n         if let Ok(s) = env::var(\"RUSTC_HOST_CRT_STATIC\") {\n             if s == \"true\" {\n                 cmd.arg(\"-C\").arg(\"target-feature=+crt-static\");"}, {"sha": "8d6c2db792645ad0af93f7861768f0c576c4c116", "filename": "src/bootstrap/builder.rs", "status": "modified", "additions": 0, "deletions": 16, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/8771319dfa545611452e23ae0f41b1b5f133514a/src%2Fbootstrap%2Fbuilder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8771319dfa545611452e23ae0f41b1b5f133514a/src%2Fbootstrap%2Fbuilder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbuilder.rs?ref=8771319dfa545611452e23ae0f41b1b5f133514a", "patch": "@@ -969,27 +969,11 @@ impl<'a> Builder<'a> {\n         // See https://github.com/rust-lang/rust/issues/68647.\n         let can_use_lld = mode != Mode::Std;\n \n-        // FIXME: The beta compiler doesn't pick the `lld-link` flavor for `*-pc-windows-msvc`\n-        // Remove `RUSTC_HOST_LINKER_FLAVOR` when this is fixed\n-        let lld_linker_flavor = |linker: &Path, target: Interned<String>| {\n-            compiler.stage == 0\n-                && linker.file_name() == Some(OsStr::new(\"rust-lld\"))\n-                && target.contains(\"pc-windows-msvc\")\n-        };\n-\n         if let Some(host_linker) = self.linker(compiler.host, can_use_lld) {\n-            if lld_linker_flavor(host_linker, compiler.host) {\n-                cargo.env(\"RUSTC_HOST_LINKER_FLAVOR\", \"lld-link\");\n-            }\n-\n             cargo.env(\"RUSTC_HOST_LINKER\", host_linker);\n         }\n \n         if let Some(target_linker) = self.linker(target, can_use_lld) {\n-            if lld_linker_flavor(target_linker, target) {\n-                rustflags.arg(\"-Clinker-flavor=lld-link\");\n-            }\n-\n             let target = crate::envify(&target);\n             cargo.env(&format!(\"CARGO_TARGET_{}_LINKER\", target), target_linker);\n         }"}]}