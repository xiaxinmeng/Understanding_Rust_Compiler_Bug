{"sha": "6af3e2d707230cf4d0879dc81ceccc83e72fed25", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZhZjNlMmQ3MDcyMzBjZjRkMDg3OWRjODFjZWNjYzgzZTcyZmVkMjU=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-07-16T18:19:02Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-07-17T11:24:48Z"}, "message": "Rollup merge of #52435 - ljedrz:misc_capacity, r=estebank\n\nCalculate the exact capacity for 2 HashMaps", "tree": {"sha": "98666e4f610e27864f139f321b57b89ba658b497", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/98666e4f610e27864f139f321b57b89ba658b497"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6af3e2d707230cf4d0879dc81ceccc83e72fed25", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAltN0gAACgkQ/vbIBR0O\nATwtUA/7BXUmBNb+cvYCb4iCIA1muEHRRWmlJB6LftarPko9qIe8x5eH2VpMfU6n\nfXBULqojkSZQXsQ9ir2M+68pDlKMG3FSQlLIs3/vx5NKslLRMzbP6MwlaQIWptGv\nq3h0qxBW8efUpADZyNnF0SEdznrZF6oMKc+u6H6qdc60zS98a1hbdFbQ5KFjDK8H\nQR+NVx7aSZPu85uFK2FfMkv+uhLYT/vsZTRp2FZ/nT7XsJvX6e4/FiIBlNqKLdGP\nm1L7Mv0Q+ZZoIpEysMQn37d9A90g1AIEabyKwHYDEUUy3ZjwfDRUL57WWaFFCBIZ\nonSgRwIzNB/ps8kHzfWPx6z7JPHWo+Z68H3g3P3Gn3MB5KMYsplMSszj2SBwl4Tj\nkX1Utr8RyMKVVvrwBYWBfDBmFIMYSio+rMSUU/Kzm+J0IdaXu+hDPhn9A3IJEmS8\nlzksLj8Tktb0GTR45pfvyxwalNO1nD03YOvNh5Na4EzEy3n8sCPYd15ldVK8WFTz\nMJmnEk/aRCxn/CiiHOWPC76wZ/AH0s0FDyqocwYCNFt4ngKB4NU8maKz3I32sgCb\npXRhLCzn8rP0rFJEl3gCgF/eC7ULGTk9wKJJmrRws+KYjSTdDQ89L85U91jgrVwU\ncxjkFiSLEWyi/9z77wUgn5qs328vGaFiv6CxgUnKti/FtbxjVCE=\n=mvL9\n-----END PGP SIGNATURE-----", "payload": "tree 98666e4f610e27864f139f321b57b89ba658b497\nparent 2d1880893fca2d24344519a08cc00535f6b52530\nparent d85bcef4670ca816e04467bd287e58460c34750e\nauthor kennytm <kennytm@gmail.com> 1531765142 +0800\ncommitter kennytm <kennytm@gmail.com> 1531826688 +0800\n\nRollup merge of #52435 - ljedrz:misc_capacity, r=estebank\n\nCalculate the exact capacity for 2 HashMaps\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6af3e2d707230cf4d0879dc81ceccc83e72fed25", "html_url": "https://github.com/rust-lang/rust/commit/6af3e2d707230cf4d0879dc81ceccc83e72fed25", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6af3e2d707230cf4d0879dc81ceccc83e72fed25/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2d1880893fca2d24344519a08cc00535f6b52530", "url": "https://api.github.com/repos/rust-lang/rust/commits/2d1880893fca2d24344519a08cc00535f6b52530", "html_url": "https://github.com/rust-lang/rust/commit/2d1880893fca2d24344519a08cc00535f6b52530"}, {"sha": "d85bcef4670ca816e04467bd287e58460c34750e", "url": "https://api.github.com/repos/rust-lang/rust/commits/d85bcef4670ca816e04467bd287e58460c34750e", "html_url": "https://github.com/rust-lang/rust/commit/d85bcef4670ca816e04467bd287e58460c34750e"}], "stats": {"total": 5, "additions": 3, "deletions": 2}, "files": [{"sha": "fa0b1983510b90075b44b6ff0175a5cf58ada47a", "filename": "src/bootstrap/metadata.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6af3e2d707230cf4d0879dc81ceccc83e72fed25/src%2Fbootstrap%2Fmetadata.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6af3e2d707230cf4d0879dc81ceccc83e72fed25/src%2Fbootstrap%2Fmetadata.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fmetadata.rs?ref=6af3e2d707230cf4d0879dc81ceccc83e72fed25", "patch": "@@ -51,7 +51,7 @@ pub fn build(build: &mut Build) {\n     build_krate(\"\", build, &mut resolves, \"src/libtest\");\n     build_krate(&build.rustc_features(), build, &mut resolves, \"src/rustc\");\n \n-    let mut id2name = HashMap::new();\n+    let mut id2name = HashMap::with_capacity(build.crates.len());\n     for (name, krate) in build.crates.iter() {\n         id2name.insert(krate.id.clone(), name.clone());\n     }"}, {"sha": "5f10c56e8e214cd5f287cd7050a8b54fab2d8a9b", "filename": "src/librustc_driver/profile/trace.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/6af3e2d707230cf4d0879dc81ceccc83e72fed25/src%2Flibrustc_driver%2Fprofile%2Ftrace.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6af3e2d707230cf4d0879dc81ceccc83e72fed25/src%2Flibrustc_driver%2Fprofile%2Ftrace.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_driver%2Fprofile%2Ftrace.rs?ref=6af3e2d707230cf4d0879dc81ceccc83e72fed25", "patch": "@@ -220,7 +220,8 @@ pub fn write_counts(count_file: &mut File, counts: &mut HashMap<String,QueryMetr\n }\n \n pub fn write_traces(html_file: &mut File, counts_file: &mut File, traces: &Vec<Rec>) {\n-    let mut counts : HashMap<String,QueryMetric> = HashMap::new();\n+    let capacity = traces.iter().fold(0, |acc, t| acc + 1 + t.extent.len());\n+    let mut counts : HashMap<String, QueryMetric> = HashMap::with_capacity(capacity);\n     compute_counts_rec(&mut counts, traces);\n     write_counts(counts_file, &mut counts);\n "}]}