{"sha": "5d40e4515f33343f919aaaa7c37e6ec4c779ea09", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVkNDBlNDUxNWYzMzM0M2Y5MTlhYWFhN2MzN2U2ZWM0Yzc3OWVhMDk=", "commit": {"author": {"name": "Aaron Hill", "email": "aa1ronham@gmail.com", "date": "2020-08-16T23:08:35Z"}, "committer": {"name": "Aaron Hill", "email": "aa1ronham@gmail.com", "date": "2020-08-16T23:08:43Z"}, "message": "Don't use `dep_graph.with_ignore` when encoding fn param names\n\nThe call to `with_ignore` was added years ago, and should no longer be\nnecessary with the modern incremental query infrastructure.\n\nI also removed a related FIXME comment for issue #38501, which was\nclosed months ago.", "tree": {"sha": "0723425619affce05e51528f850782c62f9fa6bc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0723425619affce05e51528f850782c62f9fa6bc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5d40e4515f33343f919aaaa7c37e6ec4c779ea09", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE7J9Gc3TfBwj2K399tAh+UQ6YsWQFAl85vMQACgkQtAh+UQ6Y\nsWThbw/+Ipo36z3NAKspGTAV/L3fiPk/RFRZ5rYumvOKWzPdTkkH+f2R0Nwx/T7E\nEJkKaGTRnJIw272wfMXE2A45zV4FTBisB4uuFYrxqcyDwK/l4cSHMla8+shc3LaS\nF+8yMtXCcpx+argJRZgndCKWLg6tIofqd1tGYNoe/cpcqoJb2Ff1UM2Hk0Mkuj1e\npX4lFbe6hkx1D4sJ1tx16/Ret7XR4oBUDzbqZCCvcr3rjb6G5WT1Kfu9jGm4M4kL\ndYxIPBMxdPYgFW3Mic9lPcG5RW8XUtRspkNYcvmbxtxcvvF5PH2hiRo5/sMJ1yWy\nGjFpxmVhTZd5MKYK2uzp4Mkm4odjqoRm1TI5k0559/ON6GlvEr+JyQDnvO34Tcl8\nxFmNyDQuGVtu091Rm1jMMyTONZ7rRvHOPwQTnQLHa9owUOrskHLgKidgGYh49SXU\nijBtNjRXoLGZzc6nTb5O7JwvpRb43Hg04ojDnkS9/MO0/jgn+hGOMpDPimVeEiA1\n5qfOw/fe0qBaINSZzY6Rp4FIBKVgdB/3X0dEbFa0VbdG+M1iGklBtS4rb83BxV8v\nduLuKQOYPmGgzgKWH2FKIynBc2U7vOwRzpdn8jHxKCSyl/VZ8rG+tXZiHv2U932/\nxYdose8ZS6u3IM3Y6jmtHiCXZYEvqq13DuaCS5KbkyZ/yROdVJ8=\n=Vemw\n-----END PGP SIGNATURE-----", "payload": "tree 0723425619affce05e51528f850782c62f9fa6bc\nparent 9b4db695b0ab13885a61deb1b2e4d6599b8c5bbc\nauthor Aaron Hill <aa1ronham@gmail.com> 1597619315 -0400\ncommitter Aaron Hill <aa1ronham@gmail.com> 1597619323 -0400\n\nDon't use `dep_graph.with_ignore` when encoding fn param names\n\nThe call to `with_ignore` was added years ago, and should no longer be\nnecessary with the modern incremental query infrastructure.\n\nI also removed a related FIXME comment for issue #38501, which was\nclosed months ago.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5d40e4515f33343f919aaaa7c37e6ec4c779ea09", "html_url": "https://github.com/rust-lang/rust/commit/5d40e4515f33343f919aaaa7c37e6ec4c779ea09", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5d40e4515f33343f919aaaa7c37e6ec4c779ea09/comments", "author": {"login": "Aaron1011", "id": 1408859, "node_id": "MDQ6VXNlcjE0MDg4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aaron1011", "html_url": "https://github.com/Aaron1011", "followers_url": "https://api.github.com/users/Aaron1011/followers", "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}", "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions", "organizations_url": "https://api.github.com/users/Aaron1011/orgs", "repos_url": "https://api.github.com/users/Aaron1011/repos", "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Aaron1011/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Aaron1011", "id": 1408859, "node_id": "MDQ6VXNlcjE0MDg4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aaron1011", "html_url": "https://github.com/Aaron1011", "followers_url": "https://api.github.com/users/Aaron1011/followers", "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}", "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions", "organizations_url": "https://api.github.com/users/Aaron1011/orgs", "repos_url": "https://api.github.com/users/Aaron1011/repos", "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Aaron1011/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9b4db695b0ab13885a61deb1b2e4d6599b8c5bbc", "url": "https://api.github.com/repos/rust-lang/rust/commits/9b4db695b0ab13885a61deb1b2e4d6599b8c5bbc", "html_url": "https://github.com/rust-lang/rust/commit/9b4db695b0ab13885a61deb1b2e4d6599b8c5bbc"}], "stats": {"total": 6, "additions": 1, "deletions": 5}, "files": [{"sha": "358067fae9ceb51afef4982b33f29aa6973803e6", "filename": "src/librustc_metadata/rmeta/decoder/cstore_impl.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/5d40e4515f33343f919aaaa7c37e6ec4c779ea09/src%2Flibrustc_metadata%2Frmeta%2Fdecoder%2Fcstore_impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d40e4515f33343f919aaaa7c37e6ec4c779ea09/src%2Flibrustc_metadata%2Frmeta%2Fdecoder%2Fcstore_impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Frmeta%2Fdecoder%2Fcstore_impl.rs?ref=5d40e4515f33343f919aaaa7c37e6ec4c779ea09", "patch": "@@ -136,10 +136,6 @@ provide! { <'tcx> tcx, def_id, other, cdata,\n     item_attrs => { tcx.arena.alloc_from_iter(\n         cdata.get_item_attrs(def_id.index, tcx.sess).into_iter()\n     ) }\n-    // FIXME(#38501) We've skipped a `read` on the `hir_owner_nodes` of\n-    // a `fn` when encoding, so the dep-tracking wouldn't work.\n-    // This is only used by rustdoc anyway, which shouldn't have\n-    // incremental recompilation ever enabled.\n     fn_arg_names => { cdata.get_fn_param_names(tcx, def_id.index) }\n     rendered_const => { cdata.get_rendered_const(def_id.index) }\n     impl_parent => { cdata.get_parent_impl(def_id.index) }"}, {"sha": "f5227c5600cf6d6af2e24230558eeab6a7d7a333", "filename": "src/librustc_metadata/rmeta/encoder.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5d40e4515f33343f919aaaa7c37e6ec4c779ea09/src%2Flibrustc_metadata%2Frmeta%2Fencoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d40e4515f33343f919aaaa7c37e6ec4c779ea09/src%2Flibrustc_metadata%2Frmeta%2Fencoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Frmeta%2Fencoder.rs?ref=5d40e4515f33343f919aaaa7c37e6ec4c779ea09", "patch": "@@ -1089,7 +1089,7 @@ impl EncodeContext<'a, 'tcx> {\n     }\n \n     fn encode_fn_param_names_for_body(&mut self, body_id: hir::BodyId) -> Lazy<[Ident]> {\n-        self.tcx.dep_graph.with_ignore(|| self.lazy(self.tcx.hir().body_param_names(body_id)))\n+        self.lazy(self.tcx.hir().body_param_names(body_id))\n     }\n \n     fn encode_fn_param_names(&mut self, param_names: &[Ident]) -> Lazy<[Ident]> {"}]}