{"sha": "4b052024a05d529e2c51cf40a525340f20310466", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRiMDUyMDI0YTA1ZDUyOWUyYzUxY2Y0MGE1MjUzNDBmMjAzMTA0NjY=", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2020-07-22T15:44:15Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2020-07-22T16:12:32Z"}, "message": "build: Remove unnecessary `cargo:rerun-if-env-changed` annotations", "tree": {"sha": "fe74b6dd20dfa7025513888220592e9d3796bbdc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fe74b6dd20dfa7025513888220592e9d3796bbdc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4b052024a05d529e2c51cf40a525340f20310466", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4b052024a05d529e2c51cf40a525340f20310466", "html_url": "https://github.com/rust-lang/rust/commit/4b052024a05d529e2c51cf40a525340f20310466", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4b052024a05d529e2c51cf40a525340f20310466/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "69d68f90964a46e479eec02a4d9c45aaaa45b411", "url": "https://api.github.com/repos/rust-lang/rust/commits/69d68f90964a46e479eec02a4d9c45aaaa45b411", "html_url": "https://github.com/rust-lang/rust/commit/69d68f90964a46e479eec02a4d9c45aaaa45b411"}], "stats": {"total": 60, "additions": 2, "deletions": 58}, "files": [{"sha": "9b861f9640904b51bdc7ef32d294f40d054ebb26", "filename": "src/librustc_ast/build.rs", "status": "removed", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_ast%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_ast%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_ast%2Fbuild.rs?ref=69d68f90964a46e479eec02a4d9c45aaaa45b411", "patch": "@@ -1,5 +0,0 @@\n-fn main() {\n-    println!(\"cargo:rerun-if-changed=build.rs\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_RELEASE_CHANNEL\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_DISABLE_UNSTABLE_FEATURES\");\n-}"}, {"sha": "863f2b7337b2588aa7f31db1693496f9468d8121", "filename": "src/librustc_attr/build.rs", "status": "removed", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_attr%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_attr%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_attr%2Fbuild.rs?ref=69d68f90964a46e479eec02a4d9c45aaaa45b411", "patch": "@@ -1,5 +0,0 @@\n-fn main() {\n-    println!(\"cargo:rerun-if-changed=build.rs\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_RELEASE\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_RELEASE_CHANNEL\");\n-}"}, {"sha": "d1fc624c689279cf3b11d79c508a63031e2fbff5", "filename": "src/librustc_codegen_llvm/build.rs", "status": "removed", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_codegen_llvm%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_codegen_llvm%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fbuild.rs?ref=69d68f90964a46e479eec02a4d9c45aaaa45b411", "patch": "@@ -1,6 +0,0 @@\n-fn main() {\n-    println!(\"cargo:rerun-if-changed=build.rs\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_VERSION\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_PREFIX\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_LLVM_ROOT\");\n-}"}, {"sha": "ea2af6e192e7c1d0c927393717dcab497c453240", "filename": "src/librustc_codegen_ssa/build.rs", "status": "removed", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_codegen_ssa%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_codegen_ssa%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Fbuild.rs?ref=69d68f90964a46e479eec02a4d9c45aaaa45b411", "patch": "@@ -1,4 +0,0 @@\n-fn main() {\n-    println!(\"cargo:rerun-if-changed=build.rs\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_RELEASE_CHANNEL\");\n-}"}, {"sha": "414d13445f01e70b3784b2cb3b503c0d3f58d2c7", "filename": "src/librustc_driver/build.rs", "status": "removed", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_driver%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_driver%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_driver%2Fbuild.rs?ref=69d68f90964a46e479eec02a4d9c45aaaa45b411", "patch": "@@ -1,7 +0,0 @@\n-fn main() {\n-    println!(\"cargo:rerun-if-changed=build.rs\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_RELEASE\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_VERSION\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_VER_DATE\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_VER_HASH\");\n-}"}, {"sha": "d230ba91039adc9581745ee39a492fa91e3b52b0", "filename": "src/librustc_incremental/build.rs", "status": "removed", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_incremental%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_incremental%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_incremental%2Fbuild.rs?ref=69d68f90964a46e479eec02a4d9c45aaaa45b411", "patch": "@@ -1,4 +0,0 @@\n-fn main() {\n-    println!(\"cargo:rerun-if-changed=build.rs\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_VERSION\");\n-}"}, {"sha": "79a343e0fee0bfcc2ce20a53e36fc92f822b0ec0", "filename": "src/librustc_interface/build.rs", "status": "removed", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_interface%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_interface%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2Fbuild.rs?ref=69d68f90964a46e479eec02a4d9c45aaaa45b411", "patch": "@@ -1,4 +0,0 @@\n-fn main() {\n-    println!(\"cargo:rerun-if-changed=build.rs\");\n-    println!(\"cargo:rerun-if-env-changed=RUSTC_INSTALL_BINDIR\");\n-}"}, {"sha": "f00bd7d47f0358102f4708b7755a89b1868660cc", "filename": "src/librustc_llvm/build.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4b052024a05d529e2c51cf40a525340f20310466/src%2Flibrustc_llvm%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4b052024a05d529e2c51cf40a525340f20310466/src%2Flibrustc_llvm%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_llvm%2Fbuild.rs?ref=4b052024a05d529e2c51cf40a525340f20310466", "patch": "@@ -163,7 +163,7 @@ fn main() {\n         cfg.define(&flag, None);\n     }\n \n-    println!(\"cargo:rerun-if-changed-env=LLVM_RUSTLLVM\");\n+    println!(\"cargo:rerun-if-env-changed=LLVM_RUSTLLVM\");\n     if env::var_os(\"LLVM_RUSTLLVM\").is_some() {\n         cfg.define(\"LLVM_RUSTLLVM\", None);\n     }"}, {"sha": "7d5c58ecea2a135c1c076d2d8f04bb562468670f", "filename": "src/librustc_metadata/build.rs", "status": "removed", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_metadata%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_metadata%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Fbuild.rs?ref=69d68f90964a46e479eec02a4d9c45aaaa45b411", "patch": "@@ -1,5 +0,0 @@\n-fn main() {\n-    println!(\"cargo:rerun-if-changed=build.rs\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_VERSION\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_VIRTUAL_RUST_SOURCE_BASE_DIR\");\n-}"}, {"sha": "af7723aea34e466edfd582741d409baec623c5ea", "filename": "src/librustc_middle/build.rs", "status": "removed", "additions": 0, "deletions": 12, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_middle%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_middle%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_middle%2Fbuild.rs?ref=69d68f90964a46e479eec02a4d9c45aaaa45b411", "patch": "@@ -1,12 +0,0 @@\n-use std::env;\n-\n-fn main() {\n-    println!(\"cargo:rerun-if-changed=build.rs\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_LIBDIR_RELATIVE\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_COMPILER_HOST_TRIPLE\");\n-    println!(\"cargo:rerun-if-env-changed=RUSTC_VERIFY_LLVM_IR\");\n-\n-    if env::var_os(\"RUSTC_VERIFY_LLVM_IR\").is_some() {\n-        println!(\"cargo:rustc-cfg=always_verify_llvm_ir\");\n-    }\n-}"}, {"sha": "1b8f6cdd8bebcc7a2d8bd328a4dd14d25a7c27be", "filename": "src/librustc_session/session.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4b052024a05d529e2c51cf40a525340f20310466/src%2Flibrustc_session%2Fsession.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4b052024a05d529e2c51cf40a525340f20310466/src%2Flibrustc_session%2Fsession.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_session%2Fsession.rs?ref=4b052024a05d529e2c51cf40a525340f20310466", "patch": "@@ -548,7 +548,7 @@ impl Session {\n         self.opts.debugging_opts.asm_comments\n     }\n     pub fn verify_llvm_ir(&self) -> bool {\n-        self.opts.debugging_opts.verify_llvm_ir || cfg!(always_verify_llvm_ir)\n+        self.opts.debugging_opts.verify_llvm_ir || option_env!(\"RUSTC_VERIFY_LLVM_IR\").is_some()\n     }\n     pub fn borrowck_stats(&self) -> bool {\n         self.opts.debugging_opts.borrowck_stats"}, {"sha": "368200b776d74c4454a705eb210bdc09ce53274c", "filename": "src/librustc_target/build.rs", "status": "removed", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_target%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/69d68f90964a46e479eec02a4d9c45aaaa45b411/src%2Flibrustc_target%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_target%2Fbuild.rs?ref=69d68f90964a46e479eec02a4d9c45aaaa45b411", "patch": "@@ -1,4 +0,0 @@\n-fn main() {\n-    println!(\"cargo:rerun-if-changed=build.rs\");\n-    println!(\"cargo:rerun-if-env-changed=CFG_DEFAULT_LINKER\");\n-}"}]}