{"sha": "baf9a7cb57120ec1411196214fd0d1c33fb18bf6", "node_id": "C_kwDOAAsO6NoAKGJhZjlhN2NiNTcxMjBlYzE0MTExOTYyMTRmZDBkMWMzM2ZiMThiZjY", "commit": {"author": {"name": "Ding Xiang Fei", "email": "dingxiangfei2009@protonmail.ch", "date": "2022-07-21T15:39:01Z"}, "committer": {"name": "Ding Xiang Fei", "email": "dingxiangfei2009@protonmail.ch", "date": "2022-07-21T15:40:03Z"}, "message": "provide a test for #93951", "tree": {"sha": "97429e8c5833ad3e43376dcf3a1d4af68cfc4e19", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/97429e8c5833ad3e43376dcf3a1d4af68cfc4e19"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/baf9a7cb57120ec1411196214fd0d1c33fb18bf6", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE0u8S3YU336XkLsQOPNdIZH7vY1kFAmLZc1cACgkQPNdIZH7v\nY1lIWw//e94ZIJqBm9b05CNItJ0TBHI2xMH1EOWeqyO0TvO/aBSdXAjnpzlgDD4T\n1+88x7abGmWHJbxIhnGycL312+mWQ1QX2xab6FtDvYuMSnplvksIyUyBQ9sppHcW\nZsZBnKrJoY0ckdmvpV1h30M51T+bLO0iioj8mjUAhMwzwKF3CjBizjILkSUpvdEf\n6jCK83PcPV4jZG+I+BJu+eRnSSUqp746iFomWJtcjP6idc0FhF8dqAK+UvfJW/xU\nXB9QvTuoYJidQm8xzQUWoJ3nhq2hWajQCdwgGI1hpCdQr9j1f7HRbybZpRp93IMm\nLt9gMrlt3d77O89ySRENnqowSfD4JZvJywmncd+C1Bn8mf+8bSoaikfKz/H+NVAQ\nTHqPn59UY46rW5q71LgDusRhBrrCXOMuITVoBnnDhJprNR1i20kQA4c0VmrskxU0\noIT1K/WOGqHu7YCOpiou2X8dIc3zmaR+kqHbrlQDewy4itPNvdwh/XEg12zFZO2P\np+K86fkkb3SNHyPqfgV5swFVsEcZddUuIbnHZisf6xCDLOPlonWmr3fyXwePFlOV\nppMOiG1bcAhj7xWNhTEldRd/85628EBjR7aQfzXiljUUyLM8ZXxO/jGTF3zBiISL\nFlIaCYrtJNsIYt7mlOjtDoJ69rxNuhjwpW7QYzKqXDP0rV0HF8Q=\n=xGmV\n-----END PGP SIGNATURE-----", "payload": "tree 97429e8c5833ad3e43376dcf3a1d4af68cfc4e19\nparent 9b566401068cb8450912f6ab48f3d0e60f5cb482\nauthor Ding Xiang Fei <dingxiangfei2009@protonmail.ch> 1658417941 +0800\ncommitter Ding Xiang Fei <dingxiangfei2009@protonmail.ch> 1658418003 +0800\n\nprovide a test for #93951\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/baf9a7cb57120ec1411196214fd0d1c33fb18bf6", "html_url": "https://github.com/rust-lang/rust/commit/baf9a7cb57120ec1411196214fd0d1c33fb18bf6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/baf9a7cb57120ec1411196214fd0d1c33fb18bf6/comments", "author": {"login": "dingxiangfei2009", "id": 6884440, "node_id": "MDQ6VXNlcjY4ODQ0NDA=", "avatar_url": "https://avatars.githubusercontent.com/u/6884440?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dingxiangfei2009", "html_url": "https://github.com/dingxiangfei2009", "followers_url": "https://api.github.com/users/dingxiangfei2009/followers", "following_url": "https://api.github.com/users/dingxiangfei2009/following{/other_user}", "gists_url": "https://api.github.com/users/dingxiangfei2009/gists{/gist_id}", "starred_url": "https://api.github.com/users/dingxiangfei2009/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dingxiangfei2009/subscriptions", "organizations_url": "https://api.github.com/users/dingxiangfei2009/orgs", "repos_url": "https://api.github.com/users/dingxiangfei2009/repos", "events_url": "https://api.github.com/users/dingxiangfei2009/events{/privacy}", "received_events_url": "https://api.github.com/users/dingxiangfei2009/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dingxiangfei2009", "id": 6884440, "node_id": "MDQ6VXNlcjY4ODQ0NDA=", "avatar_url": "https://avatars.githubusercontent.com/u/6884440?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dingxiangfei2009", "html_url": "https://github.com/dingxiangfei2009", "followers_url": "https://api.github.com/users/dingxiangfei2009/followers", "following_url": "https://api.github.com/users/dingxiangfei2009/following{/other_user}", "gists_url": "https://api.github.com/users/dingxiangfei2009/gists{/gist_id}", "starred_url": "https://api.github.com/users/dingxiangfei2009/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dingxiangfei2009/subscriptions", "organizations_url": "https://api.github.com/users/dingxiangfei2009/orgs", "repos_url": "https://api.github.com/users/dingxiangfei2009/repos", "events_url": "https://api.github.com/users/dingxiangfei2009/events{/privacy}", "received_events_url": "https://api.github.com/users/dingxiangfei2009/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9b566401068cb8450912f6ab48f3d0e60f5cb482", "url": "https://api.github.com/repos/rust-lang/rust/commits/9b566401068cb8450912f6ab48f3d0e60f5cb482", "html_url": "https://github.com/rust-lang/rust/commit/9b566401068cb8450912f6ab48f3d0e60f5cb482"}], "stats": {"total": 11, "additions": 11, "deletions": 0}, "files": [{"sha": "064f28b4d94089d06c634fbe693a0f0e96d4e345", "filename": "src/test/ui/let-else/let-else-temporary-lifetime.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/baf9a7cb57120ec1411196214fd0d1c33fb18bf6/src%2Ftest%2Fui%2Flet-else%2Flet-else-temporary-lifetime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/baf9a7cb57120ec1411196214fd0d1c33fb18bf6/src%2Ftest%2Fui%2Flet-else%2Flet-else-temporary-lifetime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flet-else%2Flet-else-temporary-lifetime.rs?ref=baf9a7cb57120ec1411196214fd0d1c33fb18bf6", "patch": "@@ -1,6 +1,7 @@\n // run-pass\n #![feature(let_else)]\n \n+use std::fmt::Display;\n use std::rc::Rc;\n use std::sync::atomic::{AtomicU8, Ordering};\n \n@@ -18,12 +19,22 @@ impl Drop for Droppy {\n     }\n }\n \n+fn foo<'a>(x: &'a str) -> Result<impl Display + 'a, ()> {\n+    Ok(x)\n+}\n+\n fn main() {\n     assert_eq!(TRACKER.load(Ordering::Acquire), 0);\n     let 0 = Droppy::default().inner else { return };\n     assert_eq!(TRACKER.load(Ordering::Acquire), 1);\n     println!(\"Should have dropped \ud83d\udc46\");\n \n+    {\n+        let x = String::from(\"Hey\");\n+\n+        let Ok(s) = foo(&x) else { panic!() };\n+        assert_eq!(s.to_string(), x);\n+    }\n     {\n         // test let-else drops temps after statement\n         let rc = Rc::new(0);"}]}