{"sha": "1c7202b2eebb6a514fa1b175e38a66ac518ff409", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFjNzIwMmIyZWViYjZhNTE0ZmExYjE3NWUzOGE2NmFjNTE4ZmY0MDk=", "commit": {"author": {"name": "St\u00e9phane Campinas", "email": "stephane.campinas@gmail.com", "date": "2019-04-15T10:50:01Z"}, "committer": {"name": "St\u00e9phane Campinas", "email": "stephane.campinas@gmail.com", "date": "2019-04-15T12:00:11Z"}, "message": "fix test_ignore_path_set test when run on beta\n\n```\n---- ignore_path::test::test_ignore_path_set stdout ----\nWarning: can't set `ignore = IgnoreList({\"foo.rs\", \"bar_dir/*\"})`, unstable features are only available in nightly channel.\nthread 'ignore_path::test::test_ignore_path_set' panicked at 'assertion failed: ignore_path_set.is_match(&FileName::Real(PathBuf::from(\"src/foo.rs\")))', src/ignore_path.rs:51:9\nnote: Run with `RUST_BACKTRACE=1` environment variable to display a backtrace.\nfailures:\n    ignore_path::test::test_ignore_path_set\n```", "tree": {"sha": "486397da00b7a60c39ba8a2eb60db3eecbcbbd05", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/486397da00b7a60c39ba8a2eb60db3eecbcbbd05"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1c7202b2eebb6a514fa1b175e38a66ac518ff409", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCgAdFiEEipi5pnt+pUplKNfibVYg2QghATMFAly0cksACgkQbVYg2Qgh\nATP9Gwf/aI29PZ92x4DvzI1QxOWpa3A9hEBPMINLBfxEnPfxnOMOqd9Hqy4AwxAp\n4TUATXlyi6GF9qmxNMOiwKybBERRjq3x3fYJ3ZoD6Jbea1fNSR3oz5JOzxKZEcXE\n4PdAfMHu7qXvziPgqtKg8MofCg4CjnOiPNry6TQ8G5+Xxx9GBPyM1enKk0JkR9JR\nmrQgFw2ebKe1vXPOPqBrIDJHrmf9B5duoE3FRiMLRgpN4nWYIpZWkEQjBvWcfnSd\nnpXIWz5htrkU/oVaBk7RJkGx+GuenohktwOKdREamH1/1zRdOj+IMvGj4OFO2IC8\ntSKnUCwzk0/2Kv8WqNm3le7VgGQw7w==\n=RmUQ\n-----END PGP SIGNATURE-----", "payload": "tree 486397da00b7a60c39ba8a2eb60db3eecbcbbd05\nparent 31fbf344396679b2b8e1b5e327a0bd35a27133ae\nauthor St\u00e9phane Campinas <stephane.campinas@gmail.com> 1555325401 +0200\ncommitter St\u00e9phane Campinas <stephane.campinas@gmail.com> 1555329611 +0200\n\nfix test_ignore_path_set test when run on beta\n\n```\n---- ignore_path::test::test_ignore_path_set stdout ----\nWarning: can't set `ignore = IgnoreList({\"foo.rs\", \"bar_dir/*\"})`, unstable features are only available in nightly channel.\nthread 'ignore_path::test::test_ignore_path_set' panicked at 'assertion failed: ignore_path_set.is_match(&FileName::Real(PathBuf::from(\"src/foo.rs\")))', src/ignore_path.rs:51:9\nnote: Run with `RUST_BACKTRACE=1` environment variable to display a backtrace.\nfailures:\n    ignore_path::test::test_ignore_path_set\n```\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1c7202b2eebb6a514fa1b175e38a66ac518ff409", "html_url": "https://github.com/rust-lang/rust/commit/1c7202b2eebb6a514fa1b175e38a66ac518ff409", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1c7202b2eebb6a514fa1b175e38a66ac518ff409/comments", "author": {"login": "scampi", "id": 795879, "node_id": "MDQ6VXNlcjc5NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/795879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scampi", "html_url": "https://github.com/scampi", "followers_url": "https://api.github.com/users/scampi/followers", "following_url": "https://api.github.com/users/scampi/following{/other_user}", "gists_url": "https://api.github.com/users/scampi/gists{/gist_id}", "starred_url": "https://api.github.com/users/scampi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scampi/subscriptions", "organizations_url": "https://api.github.com/users/scampi/orgs", "repos_url": "https://api.github.com/users/scampi/repos", "events_url": "https://api.github.com/users/scampi/events{/privacy}", "received_events_url": "https://api.github.com/users/scampi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "scampi", "id": 795879, "node_id": "MDQ6VXNlcjc5NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/795879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scampi", "html_url": "https://github.com/scampi", "followers_url": "https://api.github.com/users/scampi/followers", "following_url": "https://api.github.com/users/scampi/following{/other_user}", "gists_url": "https://api.github.com/users/scampi/gists{/gist_id}", "starred_url": "https://api.github.com/users/scampi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scampi/subscriptions", "organizations_url": "https://api.github.com/users/scampi/orgs", "repos_url": "https://api.github.com/users/scampi/repos", "events_url": "https://api.github.com/users/scampi/events{/privacy}", "received_events_url": "https://api.github.com/users/scampi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "31fbf344396679b2b8e1b5e327a0bd35a27133ae", "url": "https://api.github.com/repos/rust-lang/rust/commits/31fbf344396679b2b8e1b5e327a0bd35a27133ae", "html_url": "https://github.com/rust-lang/rust/commit/31fbf344396679b2b8e1b5e327a0bd35a27133ae"}], "stats": {"total": 24, "additions": 12, "deletions": 12}, "files": [{"sha": "6299aedf4a755199870f88c4d6f73ac2f44411b3", "filename": "src/ignore_path.rs", "status": "modified", "additions": 12, "deletions": 12, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/1c7202b2eebb6a514fa1b175e38a66ac518ff409/src%2Fignore_path.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1c7202b2eebb6a514fa1b175e38a66ac518ff409/src%2Fignore_path.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fignore_path.rs?ref=1c7202b2eebb6a514fa1b175e38a66ac518ff409", "patch": "@@ -39,17 +39,17 @@ mod test {\n \n     #[test]\n     fn test_ignore_path_set() {\n-        let config = Config::from_toml(\n-            \"ignore = [\n-            \\\"foo.rs\\\",\n-            \\\"bar_dir/*\\\",\n-        ]\",\n-        )\n-        .unwrap();\n-        let ignore_path_set = IgnorePathSet::from_ignore_list(&config.ignore()).unwrap();\n-\n-        assert!(ignore_path_set.is_match(&FileName::Real(PathBuf::from(\"src/foo.rs\"))));\n-        assert!(ignore_path_set.is_match(&FileName::Real(PathBuf::from(\"bar_dir/baz.rs\"))));\n-        assert!(!ignore_path_set.is_match(&FileName::Real(PathBuf::from(\"src/bar.rs\"))));\n+        match option_env!(\"CFG_RELEASE_CHANNEL\") {\n+            // this test requires nightly\n+            None | Some(\"nightly\") => {\n+                let config = Config::from_toml(r#\"ignore = [\"foo.rs\", \"bar_dir/*\"]\"#).unwrap();\n+                let ignore_path_set = IgnorePathSet::from_ignore_list(&config.ignore()).unwrap();\n+\n+                assert!(ignore_path_set.is_match(&FileName::Real(PathBuf::from(\"src/foo.rs\"))));\n+                assert!(ignore_path_set.is_match(&FileName::Real(PathBuf::from(\"bar_dir/baz.rs\"))));\n+                assert!(!ignore_path_set.is_match(&FileName::Real(PathBuf::from(\"src/bar.rs\"))));\n+            }\n+            _ => (),\n+        };\n     }\n }"}]}