{"sha": "c465bf7f67ff12b9d7246a26ea83f66f0de228da", "node_id": "C_kwDOAAsO6NoAKGM0NjViZjdmNjdmZjEyYjlkNzI0NmEyNmVhODNmNjZmMGRlMjI4ZGE", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2023-03-14T13:30:21Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2023-03-14T13:30:21Z"}, "message": "Auto merge of #10499 - blyxyas:fix-almost_swapped, r=giraffate\n\nFix `almost_swapped` false positive (`let mut a = b; a = a`)\n\nFixes `2` in #10421\nchangelog: [`almost_swapped`]: Fix false positive when a variable is changed to itself. (`a = a`)", "tree": {"sha": "a7c14837cd0c1662914615f452860dcc92bb271b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a7c14837cd0c1662914615f452860dcc92bb271b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c465bf7f67ff12b9d7246a26ea83f66f0de228da", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c465bf7f67ff12b9d7246a26ea83f66f0de228da", "html_url": "https://github.com/rust-lang/rust/commit/c465bf7f67ff12b9d7246a26ea83f66f0de228da", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c465bf7f67ff12b9d7246a26ea83f66f0de228da/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5941616ddc63d52421c8daa026e4cb7a3a888474", "url": "https://api.github.com/repos/rust-lang/rust/commits/5941616ddc63d52421c8daa026e4cb7a3a888474", "html_url": "https://github.com/rust-lang/rust/commit/5941616ddc63d52421c8daa026e4cb7a3a888474"}, {"sha": "6631480a7b7cb7b3e7d53c9c4cd7915f7ebc3110", "url": "https://api.github.com/repos/rust-lang/rust/commits/6631480a7b7cb7b3e7d53c9c4cd7915f7ebc3110", "html_url": "https://github.com/rust-lang/rust/commit/6631480a7b7cb7b3e7d53c9c4cd7915f7ebc3110"}], "stats": {"total": 17, "additions": 17, "deletions": 0}, "files": [{"sha": "5087c19e5f3e278b4072a3567d61a51e1205cff6", "filename": "clippy_lints/src/swap.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c465bf7f67ff12b9d7246a26ea83f66f0de228da/clippy_lints%2Fsrc%2Fswap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c465bf7f67ff12b9d7246a26ea83f66f0de228da/clippy_lints%2Fsrc%2Fswap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fswap.rs?ref=c465bf7f67ff12b9d7246a26ea83f66f0de228da", "patch": "@@ -190,6 +190,7 @@ fn check_suspicious_swap(cx: &LateContext<'_>, block: &Block<'_>) {\n             && first.span.eq_ctxt(second.span)\n             && is_same(cx, lhs0, rhs1)\n             && is_same(cx, lhs1, rhs0)\n+\t\t\t&& !is_same(cx, lhs1, rhs1) // Ignore a = b; a = a (#10421)\n             && let Some(lhs_sugg) = match &lhs0 {\n                 ExprOrIdent::Expr(expr) => Sugg::hir_opt(cx, expr),\n                 ExprOrIdent::Ident(ident) => Some(Sugg::NonParen(ident.as_str().into())),"}, {"sha": "775b0dbde88a039c4d092379edd622ba2444b530", "filename": "tests/ui/swap.fixed", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/c465bf7f67ff12b9d7246a26ea83f66f0de228da/tests%2Fui%2Fswap.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/c465bf7f67ff12b9d7246a26ea83f66f0de228da/tests%2Fui%2Fswap.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fswap.fixed?ref=c465bf7f67ff12b9d7246a26ea83f66f0de228da", "patch": "@@ -186,3 +186,11 @@ const fn issue_9864(mut u: u32) -> u32 {\n     v = temp;\n     u + v\n }\n+\n+#[allow(clippy::let_and_return)]\n+const fn issue_10421(x: u32) -> u32 {\n+    let a = x;\n+    let a = a;\n+    let a = a;\n+    a\n+}"}, {"sha": "bc9a78b49c77ce72e482bc286b14c4b0d2fb3f9e", "filename": "tests/ui/swap.rs", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/c465bf7f67ff12b9d7246a26ea83f66f0de228da/tests%2Fui%2Fswap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c465bf7f67ff12b9d7246a26ea83f66f0de228da/tests%2Fui%2Fswap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fswap.rs?ref=c465bf7f67ff12b9d7246a26ea83f66f0de228da", "patch": "@@ -215,3 +215,11 @@ const fn issue_9864(mut u: u32) -> u32 {\n     v = temp;\n     u + v\n }\n+\n+#[allow(clippy::let_and_return)]\n+const fn issue_10421(x: u32) -> u32 {\n+    let a = x;\n+    let a = a;\n+    let a = a;\n+    a\n+}"}]}