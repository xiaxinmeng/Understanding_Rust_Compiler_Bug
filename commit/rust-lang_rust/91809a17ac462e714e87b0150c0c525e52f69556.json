{"sha": "91809a17ac462e714e87b0150c0c525e52f69556", "node_id": "MDY6Q29tbWl0NzI0NzEyOjkxODA5YTE3YWM0NjJlNzE0ZTg3YjAxNTBjMGM1MjVlNTJmNjk1NTY=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2010-12-31T01:46:56Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2010-12-31T01:46:56Z"}, "message": "Teach typeck.ast_ty_to_ty about ty_obj.", "tree": {"sha": "afc665a62b5b007d35066e6c8d9c4807b18ea6ac", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/afc665a62b5b007d35066e6c8d9c4807b18ea6ac"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/91809a17ac462e714e87b0150c0c525e52f69556", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/91809a17ac462e714e87b0150c0c525e52f69556", "html_url": "https://github.com/rust-lang/rust/commit/91809a17ac462e714e87b0150c0c525e52f69556", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/91809a17ac462e714e87b0150c0c525e52f69556/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a99713265baca22050e1ab4994feaa70ac31667b", "url": "https://api.github.com/repos/rust-lang/rust/commits/a99713265baca22050e1ab4994feaa70ac31667b", "html_url": "https://github.com/rust-lang/rust/commit/a99713265baca22050e1ab4994feaa70ac31667b"}], "stats": {"total": 16, "additions": 13, "deletions": 3}, "files": [{"sha": "76a272b391be6c3e2a87bd60087c0e4a9d789d31", "filename": "src/comp/middle/typeck.rs", "status": "modified", "additions": 13, "deletions": 3, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/91809a17ac462e714e87b0150c0c525e52f69556/src%2Fcomp%2Fmiddle%2Ftypeck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/91809a17ac462e714e87b0150c0c525e52f69556/src%2Fcomp%2Fmiddle%2Ftypeck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Ftypeck.rs?ref=91809a17ac462e714e87b0150c0c525e52f69556", "patch": "@@ -108,7 +108,7 @@ fn ast_ty_to_ty(ty_getter getter, &@ast.ty ast_ty) -> @ty.t {\n \n         case (ast.ty_fn(?inputs, ?output)) {\n             auto f = bind ast_arg_to_arg(getter, _);\n-            auto i = _vec.map[rec(ast.mode mode, @ast.ty ty),arg](f, inputs);\n+            auto i = _vec.map[ast.ty_arg, arg](f, inputs);\n             sty = ty.ty_fn(i, ast_ty_to_ty(getter, output));\n         }\n \n@@ -134,8 +134,18 @@ fn ast_ty_to_ty(ty_getter getter, &@ast.ty ast_ty) -> @ty.t {\n             cname = t0.cname;\n         }\n \n-        case (_) {\n-            fail;\n+        case (ast.ty_obj(?meths)) {\n+            let vec[ty.method] tmeths = vec();\n+            auto f = bind ast_arg_to_arg(getter, _);\n+            for (ast.ty_method m in meths) {\n+                auto ins = _vec.map[ast.ty_arg, arg](f, m.inputs);\n+                auto out = ast_ty_to_ty(getter, m.output);\n+                append[ty.method](tmeths,\n+                                  rec(ident=m.ident,\n+                                      inputs=ins,\n+                                      output=out));\n+            }\n+            sty = ty.ty_obj(tmeths);\n         }\n     }\n "}]}