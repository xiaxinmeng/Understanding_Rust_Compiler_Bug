{"sha": "f16060f386c3ceee257b2c38ce5072b2d0943b6a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYxNjA2MGYzODZjM2NlZWUyNTdiMmMzOGNlNTA3MmIyZDA5NDNiNmE=", "commit": {"author": {"name": "Juan Aguilar Santillana", "email": "mhpoin@gmail.com", "date": "2020-05-09T23:25:30Z"}, "committer": {"name": "Juan Aguilar Santillana", "email": "mhpoin@gmail.com", "date": "2020-05-09T23:25:30Z"}, "message": "Add UI test where `annotated_files` count is > 1 #64205", "tree": {"sha": "cff1a3e8daf0c2dc1497a6f5b520901c1b1ae6fd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cff1a3e8daf0c2dc1497a6f5b520901c1b1ae6fd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f16060f386c3ceee257b2c38ce5072b2d0943b6a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f16060f386c3ceee257b2c38ce5072b2d0943b6a", "html_url": "https://github.com/rust-lang/rust/commit/f16060f386c3ceee257b2c38ce5072b2d0943b6a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f16060f386c3ceee257b2c38ce5072b2d0943b6a/comments", "author": {"login": "botika", "id": 2625545, "node_id": "MDQ6VXNlcjI2MjU1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2625545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/botika", "html_url": "https://github.com/botika", "followers_url": "https://api.github.com/users/botika/followers", "following_url": "https://api.github.com/users/botika/following{/other_user}", "gists_url": "https://api.github.com/users/botika/gists{/gist_id}", "starred_url": "https://api.github.com/users/botika/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/botika/subscriptions", "organizations_url": "https://api.github.com/users/botika/orgs", "repos_url": "https://api.github.com/users/botika/repos", "events_url": "https://api.github.com/users/botika/events{/privacy}", "received_events_url": "https://api.github.com/users/botika/received_events", "type": "User", "site_admin": false}, "committer": {"login": "botika", "id": 2625545, "node_id": "MDQ6VXNlcjI2MjU1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2625545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/botika", "html_url": "https://github.com/botika", "followers_url": "https://api.github.com/users/botika/followers", "following_url": "https://api.github.com/users/botika/following{/other_user}", "gists_url": "https://api.github.com/users/botika/gists{/gist_id}", "starred_url": "https://api.github.com/users/botika/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/botika/subscriptions", "organizations_url": "https://api.github.com/users/botika/orgs", "repos_url": "https://api.github.com/users/botika/repos", "events_url": "https://api.github.com/users/botika/events{/privacy}", "received_events_url": "https://api.github.com/users/botika/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e9c78db0861f6495f903a41e087c9628d777b87b", "url": "https://api.github.com/repos/rust-lang/rust/commits/e9c78db0861f6495f903a41e087c9628d777b87b", "html_url": "https://github.com/rust-lang/rust/commit/e9c78db0861f6495f903a41e087c9628d777b87b"}], "stats": {"total": 107, "additions": 107, "deletions": 0}, "files": [{"sha": "c05d15643dbb12518c3cd69d646758985408a701", "filename": "src/test/ui/annotate-snippet/auxiliary/multispan.rs", "status": "added", "additions": 37, "deletions": 0, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/f16060f386c3ceee257b2c38ce5072b2d0943b6a/src%2Ftest%2Fui%2Fannotate-snippet%2Fauxiliary%2Fmultispan.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f16060f386c3ceee257b2c38ce5072b2d0943b6a/src%2Ftest%2Fui%2Fannotate-snippet%2Fauxiliary%2Fmultispan.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fannotate-snippet%2Fauxiliary%2Fmultispan.rs?ref=f16060f386c3ceee257b2c38ce5072b2d0943b6a", "patch": "@@ -0,0 +1,37 @@\n+// force-host\n+// no-prefer-dynamic\n+\n+#![crate_type = \"proc-macro\"]\n+#![feature(proc_macro_diagnostic, proc_macro_span, proc_macro_def_site)]\n+\n+extern crate proc_macro;\n+\n+use proc_macro::{TokenStream, TokenTree, Span, Diagnostic};\n+\n+fn parse(input: TokenStream) -> Result<(), Diagnostic> {\n+    let mut hi_spans = vec![];\n+    for tree in input {\n+        if let TokenTree::Ident(ref ident) = tree {\n+            if ident.to_string() == \"hi\" {\n+                hi_spans.push(ident.span());\n+            }\n+        }\n+    }\n+\n+    if !hi_spans.is_empty() {\n+        return Err(Span::def_site()\n+                       .error(\"hello to you, too!\")\n+                       .span_note(hi_spans, \"found these 'hi's\"));\n+    }\n+\n+    Ok(())\n+}\n+\n+#[proc_macro]\n+pub fn hello(input: TokenStream) -> TokenStream {\n+    if let Err(diag) = parse(input) {\n+        diag.emit();\n+    }\n+\n+    TokenStream::new()\n+}"}, {"sha": "325252d7716f60b1ab6d5c720e627e9c29ce52cf", "filename": "src/test/ui/annotate-snippet/multispan.rs", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/f16060f386c3ceee257b2c38ce5072b2d0943b6a/src%2Ftest%2Fui%2Fannotate-snippet%2Fmultispan.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f16060f386c3ceee257b2c38ce5072b2d0943b6a/src%2Ftest%2Fui%2Fannotate-snippet%2Fmultispan.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fannotate-snippet%2Fmultispan.rs?ref=f16060f386c3ceee257b2c38ce5072b2d0943b6a", "patch": "@@ -0,0 +1,28 @@\n+// aux-build:multispan.rs\n+// compile-flags: --error-format human-annotate-rs\n+\n+#![feature(proc_macro_hygiene)]\n+\n+extern crate multispan;\n+\n+use multispan::hello;\n+\n+fn main() {\n+    // This one emits no error.\n+    hello!();\n+\n+    // Exactly one 'hi'.\n+    hello!(hi); //~ ERROR hello to you, too!\n+\n+    // Now two, back to back.\n+    hello!(hi hi); //~ ERROR hello to you, too!\n+\n+    // Now three, back to back.\n+    hello!(hi hi hi); //~ ERROR hello to you, too!\n+\n+    // Now several, with spacing.\n+    hello!(hi hey hi yo hi beep beep hi hi); //~ ERROR hello to you, too!\n+    hello!(hi there, hi how are you? hi... hi.); //~ ERROR hello to you, too!\n+    hello!(whoah. hi di hi di ho); //~ ERROR hello to you, too!\n+    hello!(hi good hi and good bye); //~ ERROR hello to you, too!\n+}"}, {"sha": "4ac31e32ba7cfa80f6e025598f8ad3f7f4ab3e3c", "filename": "src/test/ui/annotate-snippet/multispan.stderr", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/rust-lang/rust/blob/f16060f386c3ceee257b2c38ce5072b2d0943b6a/src%2Ftest%2Fui%2Fannotate-snippet%2Fmultispan.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/f16060f386c3ceee257b2c38ce5072b2d0943b6a/src%2Ftest%2Fui%2Fannotate-snippet%2Fmultispan.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fannotate-snippet%2Fmultispan.stderr?ref=f16060f386c3ceee257b2c38ce5072b2d0943b6a", "patch": "@@ -0,0 +1,42 @@\n+error: hello to you, too!\n+  --> $DIR/multispan.rs:15:5\n+   |\n+LL |     hello!(hi);\n+   |     ^^^^^^^^^^^\n+   |\n+error: hello to you, too!\n+  --> $DIR/multispan.rs:18:5\n+   |\n+LL |     hello!(hi hi);\n+   |     ^^^^^^^^^^^^^^\n+   |\n+error: hello to you, too!\n+  --> $DIR/multispan.rs:21:5\n+   |\n+LL |     hello!(hi hi hi);\n+   |     ^^^^^^^^^^^^^^^^^\n+   |\n+error: hello to you, too!\n+  --> $DIR/multispan.rs:24:5\n+   |\n+LL |     hello!(hi hey hi yo hi beep beep hi hi);\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+error: hello to you, too!\n+  --> $DIR/multispan.rs:25:5\n+   |\n+LL |     hello!(hi there, hi how are you? hi... hi.);\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+error: hello to you, too!\n+  --> $DIR/multispan.rs:26:5\n+   |\n+LL |     hello!(whoah. hi di hi di ho);\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+error: hello to you, too!\n+  --> $DIR/multispan.rs:27:5\n+   |\n+LL |     hello!(hi good hi and good bye);\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |"}]}