{"sha": "63cfbf5d9f402357c0eaf8923363a4ea26942ec0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYzY2ZiZjVkOWY0MDIzNTdjMGVhZjg5MjMzNjNhNGVhMjY5NDJlYzA=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-08-29T14:25:28Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-08-29T14:25:28Z"}, "message": "Rollup merge of #85534 - csmoe:demagnle-assert, r=michaelwoerister\n\nadd rustc-demangle assertion on mangled symbol\n\ncc https://github.com/rust-lang/rust/issues/60705#issuecomment-844880365\nr? `@michaelwoerister`", "tree": {"sha": "13aee7bebdb9404ada3a59148e6807857b898e77", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/13aee7bebdb9404ada3a59148e6807857b898e77"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/63cfbf5d9f402357c0eaf8923363a4ea26942ec0", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhK5jYCRBK7hj4Ov3rIwAABaYIAIagoMcJrSIz1FjsKwY/rUnk\nkG1yetK4AIydYps3B4x9HENdvWVfL2TIYm5rq4TlezSGsAYk0ra42Igv2QOOt2/m\nNz+kx7Z1x+l/684nTzwSzo7c0fVsPA2zh2rRszGswZyisD6UHPzejqwEpZ5tEz7y\nYxZlGprxLmiOf+LuVnYE8vemvxl34MASTQMSUkBzjvOI6l+u08phvaRQM2eMWbUn\n42hha0uExOGPnXKYF7IKiMxzTPUoxL92yamG93SBroPgEJ4/M56B5M2wVFj/pRrP\n9tgVC+ySaDsyUOpFwYCf2m0hZo2g2QfIOSlyEI9AAlEeg3BEAYmU2RzRaYGwC9U=\n=Un0o\n-----END PGP SIGNATURE-----\n", "payload": "tree 13aee7bebdb9404ada3a59148e6807857b898e77\nparent 22973a884455fa2885699c1479603c8abe44232b\nparent 5eb960c8d9b33caade6fc637b8258f5a25572461\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1630247128 +0200\ncommitter GitHub <noreply@github.com> 1630247128 +0200\n\nRollup merge of #85534 - csmoe:demagnle-assert, r=michaelwoerister\n\nadd rustc-demangle assertion on mangled symbol\n\ncc https://github.com/rust-lang/rust/issues/60705#issuecomment-844880365\nr? `@michaelwoerister`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/63cfbf5d9f402357c0eaf8923363a4ea26942ec0", "html_url": "https://github.com/rust-lang/rust/commit/63cfbf5d9f402357c0eaf8923363a4ea26942ec0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/63cfbf5d9f402357c0eaf8923363a4ea26942ec0/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "22973a884455fa2885699c1479603c8abe44232b", "url": "https://api.github.com/repos/rust-lang/rust/commits/22973a884455fa2885699c1479603c8abe44232b", "html_url": "https://github.com/rust-lang/rust/commit/22973a884455fa2885699c1479603c8abe44232b"}, {"sha": "5eb960c8d9b33caade6fc637b8258f5a25572461", "url": "https://api.github.com/repos/rust-lang/rust/commits/5eb960c8d9b33caade6fc637b8258f5a25572461", "html_url": "https://github.com/rust-lang/rust/commit/5eb960c8d9b33caade6fc637b8258f5a25572461"}], "stats": {"total": 12, "additions": 10, "deletions": 2}, "files": [{"sha": "220c9f7e2ec2bbeca37d4835041743be5d7e2e3f", "filename": "compiler/rustc_symbol_mangling/src/lib.rs", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/63cfbf5d9f402357c0eaf8923363a4ea26942ec0/compiler%2Frustc_symbol_mangling%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/63cfbf5d9f402357c0eaf8923363a4ea26942ec0/compiler%2Frustc_symbol_mangling%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_symbol_mangling%2Fsrc%2Flib.rs?ref=63cfbf5d9f402357c0eaf8923363a4ea26942ec0", "patch": "@@ -246,10 +246,18 @@ fn compute_symbol_name(\n         tcx.symbol_mangling_version(mangling_version_crate)\n     };\n \n-    match mangling_version {\n+    let symbol = match mangling_version {\n         SymbolManglingVersion::Legacy => legacy::mangle(tcx, instance, instantiating_crate),\n         SymbolManglingVersion::V0 => v0::mangle(tcx, instance, instantiating_crate),\n-    }\n+    };\n+\n+    debug_assert!(\n+        rustc_demangle::try_demangle(&symbol).is_ok(),\n+        \"compute_symbol_name: `{}` cannot be demangled\",\n+        symbol\n+    );\n+\n+    symbol\n }\n \n fn is_generic(substs: SubstsRef<'_>) -> bool {"}]}