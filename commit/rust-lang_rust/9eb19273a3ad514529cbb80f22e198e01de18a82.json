{"sha": "9eb19273a3ad514529cbb80f22e198e01de18a82", "node_id": "MDY6Q29tbWl0NzI0NzEyOjllYjE5MjczYTNhZDUxNDUyOWNiYjgwZjIyZTE5OGUwMWRlMThhODI=", "commit": {"author": {"name": "Nikita Popov", "email": "nikita.ppv@gmail.com", "date": "2018-11-02T14:17:39Z"}, "committer": {"name": "Nikita Popov", "email": "nikita.ppv@gmail.com", "date": "2018-11-04T17:50:57Z"}, "message": "Update llvm-emscripten\n\nThis updates emscripten to version 1.38.15, which is based on\nLLVM 6.0.1.", "tree": {"sha": "9a12db483f20cee5cf14ce5f64672a58943d8be4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9a12db483f20cee5cf14ce5f64672a58943d8be4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9eb19273a3ad514529cbb80f22e198e01de18a82", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9eb19273a3ad514529cbb80f22e198e01de18a82", "html_url": "https://github.com/rust-lang/rust/commit/9eb19273a3ad514529cbb80f22e198e01de18a82", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9eb19273a3ad514529cbb80f22e198e01de18a82/comments", "author": {"login": "nikic", "id": 216080, "node_id": "MDQ6VXNlcjIxNjA4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/216080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikic", "html_url": "https://github.com/nikic", "followers_url": "https://api.github.com/users/nikic/followers", "following_url": "https://api.github.com/users/nikic/following{/other_user}", "gists_url": "https://api.github.com/users/nikic/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikic/subscriptions", "organizations_url": "https://api.github.com/users/nikic/orgs", "repos_url": "https://api.github.com/users/nikic/repos", "events_url": "https://api.github.com/users/nikic/events{/privacy}", "received_events_url": "https://api.github.com/users/nikic/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikic", "id": 216080, "node_id": "MDQ6VXNlcjIxNjA4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/216080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikic", "html_url": "https://github.com/nikic", "followers_url": "https://api.github.com/users/nikic/followers", "following_url": "https://api.github.com/users/nikic/following{/other_user}", "gists_url": "https://api.github.com/users/nikic/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikic/subscriptions", "organizations_url": "https://api.github.com/users/nikic/orgs", "repos_url": "https://api.github.com/users/nikic/repos", "events_url": "https://api.github.com/users/nikic/events{/privacy}", "received_events_url": "https://api.github.com/users/nikic/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ac708826b0d97e105f91a4cde41bfe14cff032f2", "url": "https://api.github.com/repos/rust-lang/rust/commits/ac708826b0d97e105f91a4cde41bfe14cff032f2", "html_url": "https://github.com/rust-lang/rust/commit/ac708826b0d97e105f91a4cde41bfe14cff032f2"}], "stats": {"total": 22, "additions": 11, "deletions": 11}, "files": [{"sha": "6274efaec6c0829b241344364bcf172c0518b916", "filename": ".gitmodules", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9eb19273a3ad514529cbb80f22e198e01de18a82/.gitmodules", "raw_url": "https://github.com/rust-lang/rust/raw/9eb19273a3ad514529cbb80f22e198e01de18a82/.gitmodules", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.gitmodules?ref=9eb19273a3ad514529cbb80f22e198e01de18a82", "patch": "@@ -43,7 +43,7 @@\n \turl = https://github.com/rust-lang/rust-by-example.git\n [submodule \"src/llvm-emscripten\"]\n \tpath = src/llvm-emscripten\n-\turl = https://github.com/rust-lang/llvm.git\n+\turl = https://github.com/kripken/emscripten-fastcomp\n [submodule \"src/stdsimd\"]\n \tpath = src/stdsimd\n \turl = https://github.com/rust-lang-nursery/stdsimd.git"}, {"sha": "cef0849937bf01861602cc947e48c63e562b2fc5", "filename": "src/bootstrap/compile.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9eb19273a3ad514529cbb80f22e198e01de18a82/src%2Fbootstrap%2Fcompile.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9eb19273a3ad514529cbb80f22e198e01de18a82/src%2Fbootstrap%2Fcompile.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fcompile.rs?ref=9eb19273a3ad514529cbb80f22e198e01de18a82", "patch": "@@ -736,7 +736,7 @@ pub fn build_codegen_backend(builder: &Builder,\n \n             // Pass down configuration from the LLVM build into the build of\n             // librustc_llvm and librustc_codegen_llvm.\n-            if builder.is_rust_llvm(target) {\n+            if builder.is_rust_llvm(target) && backend != \"emscripten\" {\n                 cargo.env(\"LLVM_RUSTLLVM\", \"1\");\n             }\n             cargo.env(\"LLVM_CONFIG\", &llvm_config);"}, {"sha": "9eaffbf83eb4e43e897c93dfc814c4b53ec2f50e", "filename": "src/ci/docker/asmjs/Dockerfile", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/9eb19273a3ad514529cbb80f22e198e01de18a82/src%2Fci%2Fdocker%2Fasmjs%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9eb19273a3ad514529cbb80f22e198e01de18a82/src%2Fci%2Fdocker%2Fasmjs%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fasmjs%2FDockerfile?ref=9eb19273a3ad514529cbb80f22e198e01de18a82", "patch": "@@ -20,11 +20,11 @@ COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n ENV PATH=$PATH:/emsdk-portable\n-ENV PATH=$PATH:/emsdk-portable/clang/e1.37.13_64bit/\n-ENV PATH=$PATH:/emsdk-portable/emscripten/1.37.13/\n-ENV PATH=$PATH:/emsdk-portable/node/4.1.1_64bit/bin/\n-ENV EMSCRIPTEN=/emsdk-portable/emscripten/1.37.13/\n-ENV BINARYEN_ROOT=/emsdk-portable/clang/e1.37.13_64bit/binaryen/\n+ENV PATH=$PATH:/emsdk-portable/clang/e1.38.15_64bit/\n+ENV PATH=$PATH:/emsdk-portable/emscripten/1.38.15/\n+ENV PATH=$PATH:/emsdk-portable/node/8.9.1_64bit/bin/\n+ENV EMSCRIPTEN=/emsdk-portable/emscripten/1.38.15/\n+ENV BINARYEN_ROOT=/emsdk-portable/clang/e1.38.15_64bit/binaryen/\n ENV EM_CONFIG=/emsdk-portable/.emscripten\n \n ENV TARGETS=asmjs-unknown-emscripten"}, {"sha": "dc4b2af792cf60eb7008e645d3f0ba253fafafae", "filename": "src/ci/docker/scripts/emscripten.sh", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9eb19273a3ad514529cbb80f22e198e01de18a82/src%2Fci%2Fdocker%2Fscripts%2Femscripten.sh", "raw_url": "https://github.com/rust-lang/rust/raw/9eb19273a3ad514529cbb80f22e198e01de18a82/src%2Fci%2Fdocker%2Fscripts%2Femscripten.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fscripts%2Femscripten.sh?ref=9eb19273a3ad514529cbb80f22e198e01de18a82", "patch": "@@ -33,8 +33,8 @@ curl -fL https://s3.amazonaws.com/mozilla-games/emscripten/releases/emsdk-portab\n \n cd /emsdk-portable\n ./emsdk update\n-hide_output ./emsdk install sdk-1.37.13-64bit\n-./emsdk activate sdk-1.37.13-64bit\n+hide_output ./emsdk install sdk-1.38.15-64bit\n+./emsdk activate sdk-1.38.15-64bit\n \n # Compile and cache libc\n source ./emsdk_env.sh"}, {"sha": "272d3ff91b38eac051bdbaf6cf84db5c901ce2f8", "filename": "src/llvm-emscripten", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": null, "raw_url": null, "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fllvm-emscripten?ref=9eb19273a3ad514529cbb80f22e198e01de18a82", "patch": "@@ -1 +1 @@\n-Subproject commit 2717444753318e461e0c3b30dacd03ffbac96903\n+Subproject commit 272d3ff91b38eac051bdbaf6cf84db5c901ce2f8"}, {"sha": "902e62ab4a1d9235d034be4249c8a9136c8b66a0", "filename": "src/rustllvm/PassWrapper.cpp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9eb19273a3ad514529cbb80f22e198e01de18a82/src%2Frustllvm%2FPassWrapper.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/9eb19273a3ad514529cbb80f22e198e01de18a82/src%2Frustllvm%2FPassWrapper.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2FPassWrapper.cpp?ref=9eb19273a3ad514529cbb80f22e198e01de18a82", "patch": "@@ -444,7 +444,7 @@ extern \"C\" void LLVMRustConfigurePassManagerBuilder(\n     LLVMPassManagerBuilderRef PMBR, LLVMRustCodeGenOptLevel OptLevel,\n     bool MergeFunctions, bool SLPVectorize, bool LoopVectorize, bool PrepareForThinLTO,\n     const char* PGOGenPath, const char* PGOUsePath) {\n-#if LLVM_RUSTLLVM\n+#if LLVM_VERSION_GE(7, 0)\n   unwrap(PMBR)->MergeFunctions = MergeFunctions;\n #endif\n   unwrap(PMBR)->SLPVectorize = SLPVectorize;"}]}