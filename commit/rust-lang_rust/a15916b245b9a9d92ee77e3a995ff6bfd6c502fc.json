{"sha": "a15916b245b9a9d92ee77e3a995ff6bfd6c502fc", "node_id": "MDY6Q29tbWl0NzI0NzEyOmExNTkxNmIyNDViOWE5ZDkyZWU3N2UzYTk5NWZmNmJmZDZjNTAyZmM=", "commit": {"author": {"name": "Clint Frederickson", "email": "clint.frederickson@ironcorelabs.com", "date": "2019-02-05T20:56:29Z"}, "committer": {"name": "Clint Frederickson", "email": "clint.frederickson@ironcorelabs.com", "date": "2019-02-05T20:56:29Z"}, "message": "[WIP] add better error message for partial move", "tree": {"sha": "d6d49870bf95c2b24dbaf798800469be6a16f68a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d6d49870bf95c2b24dbaf798800469be6a16f68a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a15916b245b9a9d92ee77e3a995ff6bfd6c502fc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a15916b245b9a9d92ee77e3a995ff6bfd6c502fc", "html_url": "https://github.com/rust-lang/rust/commit/a15916b245b9a9d92ee77e3a995ff6bfd6c502fc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a15916b245b9a9d92ee77e3a995ff6bfd6c502fc/comments", "author": {"login": "clintfred", "id": 19213143, "node_id": "MDQ6VXNlcjE5MjEzMTQz", "avatar_url": "https://avatars.githubusercontent.com/u/19213143?v=4", "gravatar_id": "", "url": "https://api.github.com/users/clintfred", "html_url": "https://github.com/clintfred", "followers_url": "https://api.github.com/users/clintfred/followers", "following_url": "https://api.github.com/users/clintfred/following{/other_user}", "gists_url": "https://api.github.com/users/clintfred/gists{/gist_id}", "starred_url": "https://api.github.com/users/clintfred/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/clintfred/subscriptions", "organizations_url": "https://api.github.com/users/clintfred/orgs", "repos_url": "https://api.github.com/users/clintfred/repos", "events_url": "https://api.github.com/users/clintfred/events{/privacy}", "received_events_url": "https://api.github.com/users/clintfred/received_events", "type": "User", "site_admin": false}, "committer": {"login": "clintfred", "id": 19213143, "node_id": "MDQ6VXNlcjE5MjEzMTQz", "avatar_url": "https://avatars.githubusercontent.com/u/19213143?v=4", "gravatar_id": "", "url": "https://api.github.com/users/clintfred", "html_url": "https://github.com/clintfred", "followers_url": "https://api.github.com/users/clintfred/followers", "following_url": "https://api.github.com/users/clintfred/following{/other_user}", "gists_url": "https://api.github.com/users/clintfred/gists{/gist_id}", "starred_url": "https://api.github.com/users/clintfred/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/clintfred/subscriptions", "organizations_url": "https://api.github.com/users/clintfred/orgs", "repos_url": "https://api.github.com/users/clintfred/repos", "events_url": "https://api.github.com/users/clintfred/events{/privacy}", "received_events_url": "https://api.github.com/users/clintfred/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8bf7fda6b5fec99a11ae0fb8d5c3dbd150063741", "url": "https://api.github.com/repos/rust-lang/rust/commits/8bf7fda6b5fec99a11ae0fb8d5c3dbd150063741", "html_url": "https://github.com/rust-lang/rust/commit/8bf7fda6b5fec99a11ae0fb8d5c3dbd150063741"}], "stats": {"total": 9, "additions": 6, "deletions": 3}, "files": [{"sha": "53b486cc6e316277069d29713b7dff07b5515ae5", "filename": "src/librustc_mir/borrow_check/error_reporting.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/a15916b245b9a9d92ee77e3a995ff6bfd6c502fc/src%2Flibrustc_mir%2Fborrow_check%2Ferror_reporting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a15916b245b9a9d92ee77e3a995ff6bfd6c502fc/src%2Flibrustc_mir%2Fborrow_check%2Ferror_reporting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Ferror_reporting.rs?ref=a15916b245b9a9d92ee77e3a995ff6bfd6c502fc", "patch": "@@ -130,13 +130,15 @@ impl<'cx, 'gcx, 'tcx> MirBorrowckCtxt<'cx, 'gcx, 'tcx> {\n             );\n \n             let mut is_loop_move = false;\n+            let mut is_partial_move = false;\n             for move_site in &move_site_vec {\n                 let move_out = self.move_data.moves[(*move_site).moi];\n                 let moved_place = &self.move_data.move_paths[move_out.path].place;\n \n                 let move_spans = self.move_spans(moved_place, move_out.source);\n                 let move_span = move_spans.args_or_use();\n \n+                is_partial_move = used_place.is_prefix_of(moved_place);\n                 let move_msg = if move_spans.for_closure() {\n                     \" into closure\"\n                 } else {\n@@ -175,8 +177,9 @@ impl<'cx, 'gcx, 'tcx> MirBorrowckCtxt<'cx, 'gcx, 'tcx> {\n                 err.span_label(\n                     span,\n                     format!(\n-                        \"value {} here after move\",\n-                        desired_action.as_verb_in_past_tense()\n+                        \"value {} here {}\",\n+                        desired_action.as_verb_in_past_tense(),\n+                        if is_partial_move { \"after partial move\" } else { \"after move\" },\n                     ),\n                 );\n             }"}, {"sha": "99cbf64fd5d466b6a3701d981fa651ef60760b53", "filename": "src/test/ui/borrowck/borrowck-uninit-field-access.mir.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a15916b245b9a9d92ee77e3a995ff6bfd6c502fc/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-uninit-field-access.mir.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a15916b245b9a9d92ee77e3a995ff6bfd6c502fc/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-uninit-field-access.mir.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-uninit-field-access.mir.stderr?ref=a15916b245b9a9d92ee77e3a995ff6bfd6c502fc", "patch": "@@ -20,7 +20,7 @@ error[E0382]: use of moved value: `line2`\n LL |     let _moved = (line2.origin, line2.middle);\n    |                                 ------------ value moved here\n LL |     line2.consume(); //[ast]~ ERROR use of partially moved value: `line2` [E0382]\n-   |     ^^^^^ value used here after move\n+   |     ^^^^^ value used here after partial move\n    |\n    = note: move occurs because `line2.middle` has type `Point`, which does not implement the `Copy` trait\n "}]}