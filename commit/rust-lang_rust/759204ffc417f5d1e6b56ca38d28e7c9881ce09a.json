{"sha": "759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc1OTIwNGZmYzQxN2Y1ZDFlNmI1NmNhMzhkMjhlN2M5ODgxY2UwOWE=", "commit": {"author": {"name": "Dylan DPC", "email": "dylan.dpc@gmail.com", "date": "2021-03-10T16:55:38Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-03-10T16:55:38Z"}, "message": "Rollup merge of #82217 - m-ou-se:edition-prelude, r=nikomatsakis\n\nEdition-specific preludes\n\nThis changes `{std,core}::prelude` to export edition-specific preludes under `rust_2015`, `rust_2018` and `rust_2021`. (As suggested in https://github.com/rust-lang/rust/issues/51418#issuecomment-395630382.) For now they all just re-export `v1::*`, but this allows us to add things to the 2021edition prelude soon.\n\nThis also changes the compiler to make the automatically injected prelude import dependent on the selected edition.\n\ncc `@rust-lang/libs` `@djc`", "tree": {"sha": "d8d70c6aa5832a0cf8f59326d71c84b3fa6d114c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d8d70c6aa5832a0cf8f59326d71c84b3fa6d114c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgSPoLCRBK7hj4Ov3rIwAAdHIIAFUM1FY58957NLNEGlw9Pp2B\nOuw+b6IVFJvH5N6ynZ1/0az5VKTbyvNMwhcGiYrBcO4R0WBkcRLPpjvMGwKdj/tp\nkhLoNzcHIvHv1ZVS6kdyat6S1fcX8cTx6B8dfXjxS2aD9pUoaqevv9IF7AnsesbE\nAQkd8SWlXvXpkz8oRcCzt3ol36ECOXBw52fUjDInuJZXl6LQMIMDmIDYM4GM0mNQ\nbIaw2CDNHK/+hAkQyN1/eB8lp9puulCnKZscgySLZvC8mSMvT7Qx5WfG7Wy6tI87\nyj3Jn4fgCKCyilii13bIM6VvYoFYQaH94r/GFJgL6x9IV9unR4OsBbxJ+WOItb8=\n=uhp+\n-----END PGP SIGNATURE-----\n", "payload": "tree d8d70c6aa5832a0cf8f59326d71c84b3fa6d114c\nparent 49bf48a33d1a8532c57a0e6f760d9b7b88c39abf\nparent 76fd8d7e74a000be4d736c47b55c583d31c907d0\nauthor Dylan DPC <dylan.dpc@gmail.com> 1615395338 +0100\ncommitter GitHub <noreply@github.com> 1615395338 +0100\n\nRollup merge of #82217 - m-ou-se:edition-prelude, r=nikomatsakis\n\nEdition-specific preludes\n\nThis changes `{std,core}::prelude` to export edition-specific preludes under `rust_2015`, `rust_2018` and `rust_2021`. (As suggested in https://github.com/rust-lang/rust/issues/51418#issuecomment-395630382.) For now they all just re-export `v1::*`, but this allows us to add things to the 2021edition prelude soon.\n\nThis also changes the compiler to make the automatically injected prelude import dependent on the selected edition.\n\ncc `@rust-lang/libs` `@djc`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "html_url": "https://github.com/rust-lang/rust/commit/759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "49bf48a33d1a8532c57a0e6f760d9b7b88c39abf", "url": "https://api.github.com/repos/rust-lang/rust/commits/49bf48a33d1a8532c57a0e6f760d9b7b88c39abf", "html_url": "https://github.com/rust-lang/rust/commit/49bf48a33d1a8532c57a0e6f760d9b7b88c39abf"}, {"sha": "76fd8d7e74a000be4d736c47b55c583d31c907d0", "url": "https://api.github.com/repos/rust-lang/rust/commits/76fd8d7e74a000be4d736c47b55c583d31c907d0", "html_url": "https://github.com/rust-lang/rust/commit/76fd8d7e74a000be4d736c47b55c583d31c907d0"}], "stats": {"total": 146, "additions": 113, "deletions": 33}, "files": [{"sha": "fbd8be22a9de2391ee0138cbfab8c97054ba8c3a", "filename": "compiler/rustc_builtin_macros/src/standard_library_imports.rs", "status": "modified", "additions": 19, "deletions": 11, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/compiler%2Frustc_builtin_macros%2Fsrc%2Fstandard_library_imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/compiler%2Frustc_builtin_macros%2Fsrc%2Fstandard_library_imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_builtin_macros%2Fsrc%2Fstandard_library_imports.rs?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -2,7 +2,7 @@ use rustc_ast as ast;\n use rustc_expand::base::{ExtCtxt, ResolverExpand};\n use rustc_expand::expand::ExpansionConfig;\n use rustc_session::Session;\n-use rustc_span::edition::Edition;\n+use rustc_span::edition::Edition::*;\n use rustc_span::hygiene::AstPass;\n use rustc_span::symbol::{kw, sym, Ident, Symbol};\n use rustc_span::DUMMY_SP;\n@@ -13,7 +13,7 @@ pub fn inject(\n     sess: &Session,\n     alt_std_name: Option<Symbol>,\n ) -> ast::Crate {\n-    let rust_2018 = sess.parse_sess.edition >= Edition::Edition2018;\n+    let edition = sess.parse_sess.edition;\n \n     // the first name in this list is the crate name of the crate with the prelude\n     let names: &[Symbol] = if sess.contains_name(&krate.attrs, sym::no_core) {\n@@ -42,7 +42,11 @@ pub fn inject(\n \n     // .rev() to preserve ordering above in combination with insert(0, ...)\n     for &name in names.iter().rev() {\n-        let ident = if rust_2018 { Ident::new(name, span) } else { Ident::new(name, call_site) };\n+        let ident = if edition >= Edition2018 {\n+            Ident::new(name, span)\n+        } else {\n+            Ident::new(name, call_site)\n+        };\n         krate.items.insert(\n             0,\n             cx.item(\n@@ -58,14 +62,18 @@ pub fn inject(\n     // the one with the prelude.\n     let name = names[0];\n \n-    let import_path = if rust_2018 {\n-        [name, sym::prelude, sym::v1].iter().map(|symbol| Ident::new(*symbol, span)).collect()\n-    } else {\n-        [kw::PathRoot, name, sym::prelude, sym::v1]\n-            .iter()\n-            .map(|symbol| Ident::new(*symbol, span))\n-            .collect()\n-    };\n+    let root = (edition == Edition2015).then(|| kw::PathRoot);\n+\n+    let import_path = root\n+        .iter()\n+        .chain(&[name, sym::prelude])\n+        .chain(&[match edition {\n+            Edition2015 => sym::rust_2015,\n+            Edition2018 => sym::rust_2018,\n+            Edition2021 => sym::rust_2021,\n+        }])\n+        .map(|&symbol| Ident::new(symbol, span))\n+        .collect();\n \n     let use_item = cx.item(\n         span,"}, {"sha": "3a8514c72adc430ddd80605ce140fb4de3683a4b", "filename": "compiler/rustc_span/src/symbol.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -958,8 +958,11 @@ symbols! {\n         rt,\n         rtm_target_feature,\n         rust,\n+        rust_2015,\n         rust_2015_preview,\n+        rust_2018,\n         rust_2018_preview,\n+        rust_2021,\n         rust_2021_preview,\n         rust_begin_unwind,\n         rust_eh_catch_typeinfo,"}, {"sha": "8f57db49496c306c066c7a087e1a0d71b304a199", "filename": "library/core/src/prelude/mod.rs", "status": "modified", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/library%2Fcore%2Fsrc%2Fprelude%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/library%2Fcore%2Fsrc%2Fprelude%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fprelude%2Fmod.rs?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -1,5 +1,41 @@\n //! The libcore prelude\n+//!\n+//! This module is intended for users of libcore which do not link to libstd as\n+//! well. This module is imported by default when `#![no_std]` is used in the\n+//! same manner as the standard library's prelude.\n \n #![stable(feature = \"core_prelude\", since = \"1.4.0\")]\n \n pub mod v1;\n+\n+/// The 2015 version of the core prelude.\n+///\n+/// See the [module-level documentation](self) for more.\n+#[unstable(feature = \"prelude_2015\", issue = \"none\")]\n+pub mod rust_2015 {\n+    #[unstable(feature = \"prelude_2015\", issue = \"none\")]\n+    #[doc(no_inline)]\n+    pub use super::v1::*;\n+}\n+\n+/// The 2018 version of the core prelude.\n+///\n+/// See the [module-level documentation](self) for more.\n+#[unstable(feature = \"prelude_2018\", issue = \"none\")]\n+pub mod rust_2018 {\n+    #[unstable(feature = \"prelude_2018\", issue = \"none\")]\n+    #[doc(no_inline)]\n+    pub use super::v1::*;\n+}\n+\n+/// The 2021 version of the core prelude.\n+///\n+/// See the [module-level documentation](self) for more.\n+#[unstable(feature = \"prelude_2021\", issue = \"none\")]\n+pub mod rust_2021 {\n+    #[unstable(feature = \"prelude_2021\", issue = \"none\")]\n+    #[doc(no_inline)]\n+    pub use super::v1::*;\n+\n+    // FIXME: Add more things.\n+}"}, {"sha": "c7cb2a69ff73ca6617effdedda60e9ff5f1d53a0", "filename": "library/core/src/prelude/v1.rs", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/library%2Fcore%2Fsrc%2Fprelude%2Fv1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/library%2Fcore%2Fsrc%2Fprelude%2Fv1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fprelude%2Fv1.rs?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -1,8 +1,6 @@\n-//! The core prelude\n+//! The first version of the core prelude.\n //!\n-//! This module is intended for users of libcore which do not link to libstd as\n-//! well. This module is imported by default when `#![no_std]` is used in the\n-//! same manner as the standard library's prelude.\n+//! See the [module-level documentation](super) for more.\n \n #![stable(feature = \"core_prelude\", since = \"1.4.0\")]\n "}, {"sha": "8149858e10338846d04da9eda1da899e2c4462af", "filename": "library/std/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/library%2Fstd%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/library%2Fstd%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Flib.rs?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -302,6 +302,7 @@\n #![feature(panic_internals)]\n #![feature(panic_unwind)]\n #![feature(pin_static_ref)]\n+#![feature(prelude_2021)]\n #![feature(prelude_import)]\n #![feature(ptr_internals)]\n #![feature(raw)]"}, {"sha": "505b5f3013b357bc2c4d2aefc27f85f7eb9576ac", "filename": "library/std/src/prelude/mod.rs", "status": "modified", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/library%2Fstd%2Fsrc%2Fprelude%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/library%2Fstd%2Fsrc%2Fprelude%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fprelude%2Fmod.rs?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -84,3 +84,37 @@\n #![stable(feature = \"rust1\", since = \"1.0.0\")]\n \n pub mod v1;\n+\n+/// The 2015 version of the prelude of The Rust Standard Library.\n+///\n+/// See the [module-level documentation](self) for more.\n+#[unstable(feature = \"prelude_2015\", issue = \"none\")]\n+pub mod rust_2015 {\n+    #[unstable(feature = \"prelude_2015\", issue = \"none\")]\n+    #[doc(no_inline)]\n+    pub use super::v1::*;\n+}\n+\n+/// The 2018 version of the prelude of The Rust Standard Library.\n+///\n+/// See the [module-level documentation](self) for more.\n+#[unstable(feature = \"prelude_2018\", issue = \"none\")]\n+pub mod rust_2018 {\n+    #[unstable(feature = \"prelude_2018\", issue = \"none\")]\n+    #[doc(no_inline)]\n+    pub use super::v1::*;\n+}\n+\n+/// The 2021 version of the prelude of The Rust Standard Library.\n+///\n+/// See the [module-level documentation](self) for more.\n+#[unstable(feature = \"prelude_2021\", issue = \"none\")]\n+pub mod rust_2021 {\n+    #[unstable(feature = \"prelude_2021\", issue = \"none\")]\n+    #[doc(no_inline)]\n+    pub use super::v1::*;\n+\n+    #[unstable(feature = \"prelude_2021\", issue = \"none\")]\n+    #[doc(no_inline)]\n+    pub use core::prelude::rust_2021::*;\n+}"}, {"sha": "ec89bb6d2a48fb42752bac1492981cedd5601d7f", "filename": "library/std/src/prelude/v1.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/library%2Fstd%2Fsrc%2Fprelude%2Fv1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/library%2Fstd%2Fsrc%2Fprelude%2Fv1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fprelude%2Fv1.rs?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -1,6 +1,6 @@\n //! The first version of the prelude of The Rust Standard Library.\n //!\n-//! See the [module-level documentation](../index.html) for more.\n+//! See the [module-level documentation](super) for more.\n \n #![stable(feature = \"rust1\", since = \"1.0.0\")]\n "}, {"sha": "c86d8a119718868deece861c72d75cba50bd15f4", "filename": "src/test/pretty/asm.pp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fpretty%2Fasm.pp", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fpretty%2Fasm.pp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fpretty%2Fasm.pp?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -2,7 +2,7 @@\n #![no_std]\n #![feature(asm)]\n #[prelude_import]\n-use ::std::prelude::v1::*;\n+use ::std::prelude::rust_2015::*;\n #[macro_use]\n extern crate std;\n "}, {"sha": "4f6a924909029ec7798ae331a20a061d8c04a6b0", "filename": "src/test/pretty/cast-lt.pp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fpretty%2Fcast-lt.pp", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fpretty%2Fcast-lt.pp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fpretty%2Fcast-lt.pp?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -1,7 +1,7 @@\n #![feature(prelude_import)]\n #![no_std]\n #[prelude_import]\n-use ::std::prelude::v1::*;\n+use ::std::prelude::rust_2015::*;\n #[macro_use]\n extern crate std;\n // pretty-compare-only"}, {"sha": "f4be3c1c63a84e5d8fda7b09ff7cf076ed3bebe6", "filename": "src/test/pretty/dollar-crate.pp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fpretty%2Fdollar-crate.pp", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fpretty%2Fdollar-crate.pp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fpretty%2Fdollar-crate.pp?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -1,7 +1,7 @@\n #![feature(prelude_import)]\n #![no_std]\n #[prelude_import]\n-use ::std::prelude::v1::*;\n+use ::std::prelude::rust_2015::*;\n #[macro_use]\n extern crate std;\n // pretty-compare-only"}, {"sha": "1579ea41cfdf1b62ad4fb4f735505e39efff1c67", "filename": "src/test/pretty/expanded-and-path-remap-80832.pp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fpretty%2Fexpanded-and-path-remap-80832.pp", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fpretty%2Fexpanded-and-path-remap-80832.pp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fpretty%2Fexpanded-and-path-remap-80832.pp?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -1,7 +1,7 @@\n #![feature(prelude_import)]\n #![no_std]\n #[prelude_import]\n-use ::std::prelude::v1::*;\n+use ::std::prelude::rust_2015::*;\n #[macro_use]\n extern crate std;\n // Test for issue 80832"}, {"sha": "dd0b8899b2d9d5ee57d4a8aa2bbf3c00199be497", "filename": "src/test/pretty/issue-12590-c.pp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fpretty%2Fissue-12590-c.pp", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fpretty%2Fissue-12590-c.pp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fpretty%2Fissue-12590-c.pp?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -1,7 +1,7 @@\n #![feature(prelude_import)]\n #![no_std]\n #[prelude_import]\n-use ::std::prelude::v1::*;\n+use ::std::prelude::rust_2015::*;\n #[macro_use]\n extern crate std;\n // pretty-compare-only"}, {"sha": "199aee05622beed636c3966d6a00f091fae86cdd", "filename": "src/test/pretty/issue-4264.pp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fpretty%2Fissue-4264.pp", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fpretty%2Fissue-4264.pp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fpretty%2Fissue-4264.pp?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -1,5 +1,5 @@\n #[prelude_import]\n-use ::std::prelude::v1::*;\n+use ::std::prelude::rust_2015::*;\n #[macro_use]\n extern crate std;\n // pretty-compare-only"}, {"sha": "535f57bf6af85776077724557ef3a5408373edf2", "filename": "src/test/ui/ast-json/ast-json-output.stdout", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fui%2Fast-json%2Fast-json-output.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fui%2Fast-json%2Fast-json-output.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fast-json%2Fast-json-output.stdout?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -1 +1 @@\n-{\"attrs\":[{\"kind\":{\"variant\":\"Normal\",\"fields\":[{\"path\":{\"span\":{\"lo\":0,\"hi\":0},\"segments\":[{\"ident\":{\"name\":\"crate_type\",\"span\":{\"lo\":0,\"hi\":0}},\"id\":0,\"args\":null}],\"tokens\":null},\"args\":{\"variant\":\"Eq\",\"fields\":[{\"lo\":0,\"hi\":0},{\"kind\":{\"variant\":\"Interpolated\",\"fields\":[{\"variant\":\"NtExpr\",\"fields\":[{\"id\":0,\"kind\":{\"variant\":\"Lit\",\"fields\":[{\"token\":{\"kind\":\"Str\",\"symbol\":\"lib\",\"suffix\":null},\"kind\":{\"variant\":\"Str\",\"fields\":[\"lib\",\"Cooked\"]},\"span\":{\"lo\":0,\"hi\":0}}]},\"span\":{\"lo\":0,\"hi\":0},\"attrs\":{\"0\":null},\"tokens\":{\"0\":[[{\"variant\":\"Token\",\"fields\":[{\"kind\":{\"variant\":\"Literal\",\"fields\":[{\"kind\":\"Str\",\"symbol\":\"lib\",\"suffix\":null}]},\"span\":{\"lo\":0,\"hi\":0}}]},\"Alone\"]]}}]}]},\"span\":{\"lo\":0,\"hi\":0}}]},\"tokens\":null},{\"0\":[[{\"variant\":\"Token\",\"fields\":[{\"kind\":\"Pound\",\"span\":{\"lo\":0,\"hi\":0}}]},\"Joint\"],[{\"variant\":\"Token\",\"fields\":[{\"kind\":\"Not\",\"span\":{\"lo\":0,\"hi\":0}}]},\"Alone\"],[{\"variant\":\"Delimited\",\"fields\":[{\"open\":{\"lo\":0,\"hi\":0},\"close\":{\"lo\":0,\"hi\":0}},\"Bracket\",{\"0\":[[{\"variant\":\"Token\",\"fields\":[{\"kind\":{\"variant\":\"Ident\",\"fields\":[\"crate_type\",false]},\"span\":{\"lo\":0,\"hi\":0}}]},\"Alone\"],[{\"variant\":\"Token\",\"fields\":[{\"kind\":\"Eq\",\"span\":{\"lo\":0,\"hi\":0}}]},\"Alone\"],[{\"variant\":\"Token\",\"fields\":[{\"kind\":{\"variant\":\"Literal\",\"fields\":[{\"kind\":\"Str\",\"symbol\":\"lib\",\"suffix\":null}]},\"span\":{\"lo\":0,\"hi\":0}}]},\"Alone\"]]}]},\"Alone\"]]}]},\"id\":null,\"style\":\"Inner\",\"span\":{\"lo\":0,\"hi\":0}}],\"items\":[{\"attrs\":[{\"kind\":{\"variant\":\"Normal\",\"fields\":[{\"path\":{\"span\":{\"lo\":0,\"hi\":0},\"segments\":[{\"ident\":{\"name\":\"prelude_import\",\"span\":{\"lo\":0,\"hi\":0}},\"id\":0,\"args\":null}],\"tokens\":null},\"args\":\"Empty\",\"tokens\":null},null]},\"id\":null,\"style\":\"Outer\",\"span\":{\"lo\":0,\"hi\":0}}],\"id\":0,\"span\":{\"lo\":0,\"hi\":0},\"vis\":{\"kind\":\"Inherited\",\"span\":{\"lo\":0,\"hi\":0},\"tokens\":null},\"ident\":{\"name\":\"\",\"span\":{\"lo\":0,\"hi\":0}},\"kind\":{\"variant\":\"Use\",\"fields\":[{\"prefix\":{\"span\":{\"lo\":0,\"hi\":0},\"segments\":[{\"ident\":{\"name\":\"{{root}}\",\"span\":{\"lo\":0,\"hi\":0}},\"id\":0,\"args\":null},{\"ident\":{\"name\":\"std\",\"span\":{\"lo\":0,\"hi\":0}},\"id\":0,\"args\":null},{\"ident\":{\"name\":\"prelude\",\"span\":{\"lo\":0,\"hi\":0}},\"id\":0,\"args\":null},{\"ident\":{\"name\":\"v1\",\"span\":{\"lo\":0,\"hi\":0}},\"id\":0,\"args\":null}],\"tokens\":null},\"kind\":\"Glob\",\"span\":{\"lo\":0,\"hi\":0}}]},\"tokens\":null},{\"attrs\":[{\"kind\":{\"variant\":\"Normal\",\"fields\":[{\"path\":{\"span\":{\"lo\":0,\"hi\":0},\"segments\":[{\"ident\":{\"name\":\"macro_use\",\"span\":{\"lo\":0,\"hi\":0}},\"id\":0,\"args\":null}],\"tokens\":null},\"args\":\"Empty\",\"tokens\":null},null]},\"id\":null,\"style\":\"Outer\",\"span\":{\"lo\":0,\"hi\":0}}],\"id\":0,\"span\":{\"lo\":0,\"hi\":0},\"vis\":{\"kind\":\"Inherited\",\"span\":{\"lo\":0,\"hi\":0},\"tokens\":null},\"ident\":{\"name\":\"std\",\"span\":{\"lo\":0,\"hi\":0}},\"kind\":{\"variant\":\"ExternCrate\",\"fields\":[null]},\"tokens\":null},{\"attrs\":[],\"id\":0,\"span\":{\"lo\":0,\"hi\":0},\"vis\":{\"kind\":\"Inherited\",\"span\":{\"lo\":0,\"hi\":0},\"tokens\":null},\"ident\":{\"name\":\"core\",\"span\":{\"lo\":0,\"hi\":0}},\"kind\":{\"variant\":\"ExternCrate\",\"fields\":[null]},\"tokens\":null}],\"span\":{\"lo\":0,\"hi\":0},\"proc_macros\":[]}\n+{\"attrs\":[{\"kind\":{\"variant\":\"Normal\",\"fields\":[{\"path\":{\"span\":{\"lo\":0,\"hi\":0},\"segments\":[{\"ident\":{\"name\":\"crate_type\",\"span\":{\"lo\":0,\"hi\":0}},\"id\":0,\"args\":null}],\"tokens\":null},\"args\":{\"variant\":\"Eq\",\"fields\":[{\"lo\":0,\"hi\":0},{\"kind\":{\"variant\":\"Interpolated\",\"fields\":[{\"variant\":\"NtExpr\",\"fields\":[{\"id\":0,\"kind\":{\"variant\":\"Lit\",\"fields\":[{\"token\":{\"kind\":\"Str\",\"symbol\":\"lib\",\"suffix\":null},\"kind\":{\"variant\":\"Str\",\"fields\":[\"lib\",\"Cooked\"]},\"span\":{\"lo\":0,\"hi\":0}}]},\"span\":{\"lo\":0,\"hi\":0},\"attrs\":{\"0\":null},\"tokens\":{\"0\":[[{\"variant\":\"Token\",\"fields\":[{\"kind\":{\"variant\":\"Literal\",\"fields\":[{\"kind\":\"Str\",\"symbol\":\"lib\",\"suffix\":null}]},\"span\":{\"lo\":0,\"hi\":0}}]},\"Alone\"]]}}]}]},\"span\":{\"lo\":0,\"hi\":0}}]},\"tokens\":null},{\"0\":[[{\"variant\":\"Token\",\"fields\":[{\"kind\":\"Pound\",\"span\":{\"lo\":0,\"hi\":0}}]},\"Joint\"],[{\"variant\":\"Token\",\"fields\":[{\"kind\":\"Not\",\"span\":{\"lo\":0,\"hi\":0}}]},\"Alone\"],[{\"variant\":\"Delimited\",\"fields\":[{\"open\":{\"lo\":0,\"hi\":0},\"close\":{\"lo\":0,\"hi\":0}},\"Bracket\",{\"0\":[[{\"variant\":\"Token\",\"fields\":[{\"kind\":{\"variant\":\"Ident\",\"fields\":[\"crate_type\",false]},\"span\":{\"lo\":0,\"hi\":0}}]},\"Alone\"],[{\"variant\":\"Token\",\"fields\":[{\"kind\":\"Eq\",\"span\":{\"lo\":0,\"hi\":0}}]},\"Alone\"],[{\"variant\":\"Token\",\"fields\":[{\"kind\":{\"variant\":\"Literal\",\"fields\":[{\"kind\":\"Str\",\"symbol\":\"lib\",\"suffix\":null}]},\"span\":{\"lo\":0,\"hi\":0}}]},\"Alone\"]]}]},\"Alone\"]]}]},\"id\":null,\"style\":\"Inner\",\"span\":{\"lo\":0,\"hi\":0}}],\"items\":[{\"attrs\":[{\"kind\":{\"variant\":\"Normal\",\"fields\":[{\"path\":{\"span\":{\"lo\":0,\"hi\":0},\"segments\":[{\"ident\":{\"name\":\"prelude_import\",\"span\":{\"lo\":0,\"hi\":0}},\"id\":0,\"args\":null}],\"tokens\":null},\"args\":\"Empty\",\"tokens\":null},null]},\"id\":null,\"style\":\"Outer\",\"span\":{\"lo\":0,\"hi\":0}}],\"id\":0,\"span\":{\"lo\":0,\"hi\":0},\"vis\":{\"kind\":\"Inherited\",\"span\":{\"lo\":0,\"hi\":0},\"tokens\":null},\"ident\":{\"name\":\"\",\"span\":{\"lo\":0,\"hi\":0}},\"kind\":{\"variant\":\"Use\",\"fields\":[{\"prefix\":{\"span\":{\"lo\":0,\"hi\":0},\"segments\":[{\"ident\":{\"name\":\"{{root}}\",\"span\":{\"lo\":0,\"hi\":0}},\"id\":0,\"args\":null},{\"ident\":{\"name\":\"std\",\"span\":{\"lo\":0,\"hi\":0}},\"id\":0,\"args\":null},{\"ident\":{\"name\":\"prelude\",\"span\":{\"lo\":0,\"hi\":0}},\"id\":0,\"args\":null},{\"ident\":{\"name\":\"rust_2015\",\"span\":{\"lo\":0,\"hi\":0}},\"id\":0,\"args\":null}],\"tokens\":null},\"kind\":\"Glob\",\"span\":{\"lo\":0,\"hi\":0}}]},\"tokens\":null},{\"attrs\":[{\"kind\":{\"variant\":\"Normal\",\"fields\":[{\"path\":{\"span\":{\"lo\":0,\"hi\":0},\"segments\":[{\"ident\":{\"name\":\"macro_use\",\"span\":{\"lo\":0,\"hi\":0}},\"id\":0,\"args\":null}],\"tokens\":null},\"args\":\"Empty\",\"tokens\":null},null]},\"id\":null,\"style\":\"Outer\",\"span\":{\"lo\":0,\"hi\":0}}],\"id\":0,\"span\":{\"lo\":0,\"hi\":0},\"vis\":{\"kind\":\"Inherited\",\"span\":{\"lo\":0,\"hi\":0},\"tokens\":null},\"ident\":{\"name\":\"std\",\"span\":{\"lo\":0,\"hi\":0}},\"kind\":{\"variant\":\"ExternCrate\",\"fields\":[null]},\"tokens\":null},{\"attrs\":[],\"id\":0,\"span\":{\"lo\":0,\"hi\":0},\"vis\":{\"kind\":\"Inherited\",\"span\":{\"lo\":0,\"hi\":0},\"tokens\":null},\"ident\":{\"name\":\"core\",\"span\":{\"lo\":0,\"hi\":0}},\"kind\":{\"variant\":\"ExternCrate\",\"fields\":[null]},\"tokens\":null}],\"span\":{\"lo\":0,\"hi\":0},\"proc_macros\":[]}"}, {"sha": "4cda07758527ae0e99e653e9cbfd1e4e9594b64e", "filename": "src/test/ui/imports/extern-prelude-extern-crate-restricted-shadowing.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fui%2Fimports%2Fextern-prelude-extern-crate-restricted-shadowing.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fui%2Fimports%2Fextern-prelude-extern-crate-restricted-shadowing.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimports%2Fextern-prelude-extern-crate-restricted-shadowing.stderr?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -24,10 +24,10 @@ LL |         extern crate std as Vec;\n LL | define_vec!();\n    | -------------- in this macro invocation\n note: `Vec` could also refer to the struct defined here\n-  --> $SRC_DIR/std/src/prelude/v1.rs:LL:COL\n+  --> $SRC_DIR/std/src/prelude/mod.rs:LL:COL\n    |\n-LL | pub use crate::vec::Vec;\n-   |         ^^^^^^^^^^^^^^^\n+LL |     pub use super::v1::*;\n+   |             ^^^^^^^^^^^^\n    = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n \n error: aborting due to 2 previous errors"}, {"sha": "fa42611d0b32e656f904ff9d7adeeab33ace2314", "filename": "src/test/ui/issues/issue-27033.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fui%2Fissues%2Fissue-27033.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fui%2Fissues%2Fissue-27033.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-27033.stderr?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -4,10 +4,10 @@ error[E0530]: match bindings cannot shadow unit variants\n LL |         None @ _ => {}\n    |         ^^^^ cannot be named the same as a unit variant\n    | \n-  ::: $SRC_DIR/std/src/prelude/v1.rs:LL:COL\n+  ::: $SRC_DIR/std/src/prelude/mod.rs:LL:COL\n    |\n-LL | pub use crate::option::Option::{self, None, Some};\n-   |                                       ---- the unit variant `None` is defined here\n+LL |     pub use super::v1::*;\n+   |             ------------ the unit variant `None` is defined here\n \n error[E0530]: match bindings cannot shadow constants\n   --> $DIR/issue-27033.rs:7:9"}, {"sha": "14a49f20e6b22f9850e8c588f4c779f8e78d7a9b", "filename": "src/test/ui/issues/issue-60662.stdout", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fui%2Fissues%2Fissue-60662.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fui%2Fissues%2Fissue-60662.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-60662.stdout?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -3,7 +3,7 @@\n \n #![feature(type_alias_impl_trait)]\n #[prelude_import]\n-use ::std::prelude::v1::*;\n+use ::std::prelude::rust_2015::*;\n #[macro_use]\n extern crate std;\n "}, {"sha": "aa51fc8240d635ff0232d2d536c47e5d3fdaa536", "filename": "src/test/ui/proc-macro/meta-macro-hygiene.stdout", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fui%2Fproc-macro%2Fmeta-macro-hygiene.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fui%2Fproc-macro%2Fmeta-macro-hygiene.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fmeta-macro-hygiene.stdout?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -15,7 +15,7 @@ Respanned: TokenStream [Ident { ident: \"$crate\", span: $DIR/auxiliary/make-macro\n \n #![no_std /* 0#0 */]\n #[prelude_import /* 0#1 */]\n-use core /* 0#1 */::prelude /* 0#1 */::v1 /* 0#1 */::*;\n+use core /* 0#1 */::prelude /* 0#1 */::rust_2018 /* 0#1 */::*;\n #[macro_use /* 0#1 */]\n extern crate core /* 0#1 */;\n #[macro_use /* 0#1 */]"}, {"sha": "ba3b3ee78278480fe5f3ff65c1e684772f226d05", "filename": "src/test/ui/proc-macro/nonterminal-token-hygiene.stdout", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fui%2Fproc-macro%2Fnonterminal-token-hygiene.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fui%2Fproc-macro%2Fnonterminal-token-hygiene.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fnonterminal-token-hygiene.stdout?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -35,7 +35,7 @@ PRINT-BANG INPUT (DEBUG): TokenStream [\n \n #![no_std /* 0#0 */]\n #[prelude_import /* 0#1 */]\n-use ::core /* 0#1 */::prelude /* 0#1 */::v1 /* 0#1 */::*;\n+use ::core /* 0#1 */::prelude /* 0#1 */::rust_2015 /* 0#1 */::*;\n #[macro_use /* 0#1 */]\n extern crate core /* 0#2 */;\n #[macro_use /* 0#1 */]"}, {"sha": "aeee43b01cc021d62666b1e60c94b746b04f587d", "filename": "src/test/ui/rfc-2497-if-let-chains/ast-pretty-check.stdout", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fui%2Frfc-2497-if-let-chains%2Fast-pretty-check.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/759204ffc417f5d1e6b56ca38d28e7c9881ce09a/src%2Ftest%2Fui%2Frfc-2497-if-let-chains%2Fast-pretty-check.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2497-if-let-chains%2Fast-pretty-check.stdout?ref=759204ffc417f5d1e6b56ca38d28e7c9881ce09a", "patch": "@@ -1,7 +1,7 @@\n #![feature(prelude_import)]\n #![no_std]\n #[prelude_import]\n-use ::std::prelude::v1::*;\n+use ::std::prelude::rust_2015::*;\n #[macro_use]\n extern crate std;\n // build-pass (FIXME(62277): could be check-pass?)"}]}