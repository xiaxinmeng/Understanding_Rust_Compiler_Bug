{"sha": "8a70ea2394a1d431bc7ee70957afbf3979d176a0", "node_id": "C_kwDOAAsO6NoAKDhhNzBlYTIzOTRhMWQ0MzFiYzdlZTcwOTU3YWZiZjM5NzlkMTc2YTA", "commit": {"author": {"name": "Eric Huss", "email": "eric@huss.org", "date": "2022-02-01T04:12:59Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-02-01T04:12:59Z"}, "message": "Rollup merge of #93504 - solid-rs:fix-kmc-solid-stack-size, r=nagisa\n\nkmc-solid: Increase the default stack size\n\nThis PR increases the default minimum stack size on the [`*-kmc-solid_*`](https://doc.rust-lang.org/nightly/rustc/platform-support/kmc-solid.html) Tier 3 targets to 64KiB (Arm) and 128KiB (AArch64).\n\nThis value was chosen as a middle ground between supporting a relatively complex program (e.g., an application using a full-fledged off-the-shelf web server framework) with no additional configuration and minimizing resource consumption for the embedded platform that doesn't support lazily-allocated pages nor over-commitment (i.e., wasted stack spaces are wasted physical memory). If the need arises, the users can always set the `RUST_MIN_STACK` environmental variable to override the default stack size or use the platform API directly.", "tree": {"sha": "58fef9498f97a4fe12f3d8ebee80b00a2ff85431", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/58fef9498f97a4fe12f3d8ebee80b00a2ff85431"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8a70ea2394a1d431bc7ee70957afbf3979d176a0", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJh+LNLCRBK7hj4Ov3rIwAA5kYIAIjHHZE+usSCkwU9HvR0BnGm\nzT4n+YMND3pqF62Fl0KID/yiHh/Eon1RS7Lh+BwO67o5iywCuV5YME8wM5IXMqfm\nbcOIdPAH1Of8pUupVfz2XfR64ZE8qB2kc/bkgNeprREOEZ9ojtU8B+CytKo4wvIc\nzJZ7CoZYs9EkXczXAL+izjDZqO8wAK9/Shu5wla7g0gtWP0ad5Mu12gQCH98/M2H\nQOkE0NjC8IvxOwSW0a5xwzl+4h8x2DfK0wlFgvK3bL0eabhxfRDmLz1MR8PTjTAA\nohSHFZvBXDP8YtwMkE0iBNpsCUYNn0Px9qgxIljr6ckv7e1fNqgdv+6+CHNYx38=\n=bnC+\n-----END PGP SIGNATURE-----\n", "payload": "tree 58fef9498f97a4fe12f3d8ebee80b00a2ff85431\nparent 445fbff6a4d4cd181094cada847651883bd417a1\nparent 1a77d6227cccdd66367fd1e9cd736c03ddda64ec\nauthor Eric Huss <eric@huss.org> 1643688779 -0800\ncommitter GitHub <noreply@github.com> 1643688779 -0800\n\nRollup merge of #93504 - solid-rs:fix-kmc-solid-stack-size, r=nagisa\n\nkmc-solid: Increase the default stack size\n\nThis PR increases the default minimum stack size on the [`*-kmc-solid_*`](https://doc.rust-lang.org/nightly/rustc/platform-support/kmc-solid.html) Tier 3 targets to 64KiB (Arm) and 128KiB (AArch64).\n\nThis value was chosen as a middle ground between supporting a relatively complex program (e.g., an application using a full-fledged off-the-shelf web server framework) with no additional configuration and minimizing resource consumption for the embedded platform that doesn't support lazily-allocated pages nor over-commitment (i.e., wasted stack spaces are wasted physical memory). If the need arises, the users can always set the `RUST_MIN_STACK` environmental variable to override the default stack size or use the platform API directly.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8a70ea2394a1d431bc7ee70957afbf3979d176a0", "html_url": "https://github.com/rust-lang/rust/commit/8a70ea2394a1d431bc7ee70957afbf3979d176a0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8a70ea2394a1d431bc7ee70957afbf3979d176a0/comments", "author": {"login": "ehuss", "id": 43198, "node_id": "MDQ6VXNlcjQzMTk4", "avatar_url": "https://avatars.githubusercontent.com/u/43198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehuss", "html_url": "https://github.com/ehuss", "followers_url": "https://api.github.com/users/ehuss/followers", "following_url": "https://api.github.com/users/ehuss/following{/other_user}", "gists_url": "https://api.github.com/users/ehuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehuss/subscriptions", "organizations_url": "https://api.github.com/users/ehuss/orgs", "repos_url": "https://api.github.com/users/ehuss/repos", "events_url": "https://api.github.com/users/ehuss/events{/privacy}", "received_events_url": "https://api.github.com/users/ehuss/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "445fbff6a4d4cd181094cada847651883bd417a1", "url": "https://api.github.com/repos/rust-lang/rust/commits/445fbff6a4d4cd181094cada847651883bd417a1", "html_url": "https://github.com/rust-lang/rust/commit/445fbff6a4d4cd181094cada847651883bd417a1"}, {"sha": "1a77d6227cccdd66367fd1e9cd736c03ddda64ec", "url": "https://api.github.com/repos/rust-lang/rust/commits/1a77d6227cccdd66367fd1e9cd736c03ddda64ec", "html_url": "https://github.com/rust-lang/rust/commit/1a77d6227cccdd66367fd1e9cd736c03ddda64ec"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "5b718a460dfa9e4c991e49d5e57e623a004090c3", "filename": "library/std/src/sys/itron/thread.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/8a70ea2394a1d431bc7ee70957afbf3979d176a0/library%2Fstd%2Fsrc%2Fsys%2Fitron%2Fthread.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8a70ea2394a1d431bc7ee70957afbf3979d176a0/library%2Fstd%2Fsrc%2Fsys%2Fitron%2Fthread.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fitron%2Fthread.rs?ref=8a70ea2394a1d431bc7ee70957afbf3979d176a0", "patch": "@@ -77,7 +77,8 @@ const LIFECYCLE_DETACHED_OR_JOINED: usize = usize::MAX;\n const LIFECYCLE_EXITED_OR_FINISHED_OR_JOIN_FINALIZE: usize = usize::MAX;\n // there's no single value for `JOINING`\n \n-pub const DEFAULT_MIN_STACK_SIZE: usize = 1024 * crate::mem::size_of::<usize>();\n+// 64KiB for 32-bit ISAs, 128KiB for 64-bit ISAs.\n+pub const DEFAULT_MIN_STACK_SIZE: usize = 0x4000 * crate::mem::size_of::<usize>();\n \n impl Thread {\n     /// # Safety"}]}