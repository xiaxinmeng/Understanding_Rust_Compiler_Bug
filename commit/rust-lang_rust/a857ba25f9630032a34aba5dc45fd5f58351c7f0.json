{"sha": "a857ba25f9630032a34aba5dc45fd5f58351c7f0", "node_id": "C_kwDOAAsO6NoAKGE4NTdiYTI1Zjk2MzAwMzJhMzRhYmE1ZGM0NWZkNWY1ODM1MWM3ZjA", "commit": {"author": {"name": "R\u00e9my Rakic", "email": "remy.rakic+github@gmail.com", "date": "2023-03-28T13:22:01Z"}, "committer": {"name": "R\u00e9my Rakic", "email": "remy.rakic+github@gmail.com", "date": "2023-03-28T13:22:01Z"}, "message": "address review comments\n\nMove tests and limit the init mask's structures/fields visibility.", "tree": {"sha": "c7c07d6d8d50f9629df1c3063fba0d899bb7c7c0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c7c07d6d8d50f9629df1c3063fba0d899bb7c7c0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a857ba25f9630032a34aba5dc45fd5f58351c7f0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a857ba25f9630032a34aba5dc45fd5f58351c7f0", "html_url": "https://github.com/rust-lang/rust/commit/a857ba25f9630032a34aba5dc45fd5f58351c7f0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a857ba25f9630032a34aba5dc45fd5f58351c7f0/comments", "author": {"login": "lqd", "id": 247183, "node_id": "MDQ6VXNlcjI0NzE4Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/247183?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lqd", "html_url": "https://github.com/lqd", "followers_url": "https://api.github.com/users/lqd/followers", "following_url": "https://api.github.com/users/lqd/following{/other_user}", "gists_url": "https://api.github.com/users/lqd/gists{/gist_id}", "starred_url": "https://api.github.com/users/lqd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lqd/subscriptions", "organizations_url": "https://api.github.com/users/lqd/orgs", "repos_url": "https://api.github.com/users/lqd/repos", "events_url": "https://api.github.com/users/lqd/events{/privacy}", "received_events_url": "https://api.github.com/users/lqd/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lqd", "id": 247183, "node_id": "MDQ6VXNlcjI0NzE4Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/247183?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lqd", "html_url": "https://github.com/lqd", "followers_url": "https://api.github.com/users/lqd/followers", "following_url": "https://api.github.com/users/lqd/following{/other_user}", "gists_url": "https://api.github.com/users/lqd/gists{/gist_id}", "starred_url": "https://api.github.com/users/lqd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lqd/subscriptions", "organizations_url": "https://api.github.com/users/lqd/orgs", "repos_url": "https://api.github.com/users/lqd/repos", "events_url": "https://api.github.com/users/lqd/events{/privacy}", "received_events_url": "https://api.github.com/users/lqd/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9f16a81bc86e4b3c851abd58a4852e6dad7eb17e", "url": "https://api.github.com/repos/rust-lang/rust/commits/9f16a81bc86e4b3c851abd58a4852e6dad7eb17e", "html_url": "https://github.com/rust-lang/rust/commit/9f16a81bc86e4b3c851abd58a4852e6dad7eb17e"}], "stats": {"total": 14, "additions": 8, "deletions": 6}, "files": [{"sha": "2f2c7b154165a2f6b937d0e804f79644ae38c0f7", "filename": "compiler/rustc_middle/src/mir/interpret/allocation.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a857ba25f9630032a34aba5dc45fd5f58351c7f0/compiler%2Frustc_middle%2Fsrc%2Fmir%2Finterpret%2Fallocation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a857ba25f9630032a34aba5dc45fd5f58351c7f0/compiler%2Frustc_middle%2Fsrc%2Fmir%2Finterpret%2Fallocation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fmir%2Finterpret%2Fallocation.rs?ref=a857ba25f9630032a34aba5dc45fd5f58351c7f0", "patch": "@@ -2,8 +2,6 @@\n \n mod init_mask;\n mod provenance_map;\n-#[cfg(test)]\n-mod tests;\n \n use std::borrow::Cow;\n use std::fmt;"}, {"sha": "9a02bc0cc15f80114e0c28a12b85eec54c41ff31", "filename": "compiler/rustc_middle/src/mir/interpret/allocation/init_mask.rs", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/a857ba25f9630032a34aba5dc45fd5f58351c7f0/compiler%2Frustc_middle%2Fsrc%2Fmir%2Finterpret%2Fallocation%2Finit_mask.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a857ba25f9630032a34aba5dc45fd5f58351c7f0/compiler%2Frustc_middle%2Fsrc%2Fmir%2Finterpret%2Fallocation%2Finit_mask.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fmir%2Finterpret%2Fallocation%2Finit_mask.rs?ref=a857ba25f9630032a34aba5dc45fd5f58351c7f0", "patch": "@@ -1,3 +1,6 @@\n+#[cfg(test)]\n+mod tests;\n+\n use std::hash;\n use std::iter;\n use std::ops::Range;\n@@ -16,12 +19,12 @@ type Block = u64;\n /// value.\n #[derive(Clone, Debug, Eq, PartialEq, TyEncodable, TyDecodable, Hash, HashStable)]\n pub struct InitMask {\n-    pub(crate) blocks: InitMaskBlocks,\n+    blocks: InitMaskBlocks,\n     len: Size,\n }\n \n #[derive(Clone, Debug, Eq, PartialEq, TyEncodable, TyDecodable, Hash, HashStable)]\n-pub(crate) enum InitMaskBlocks {\n+enum InitMaskBlocks {\n     Lazy {\n         /// Whether the lazy init mask is fully initialized or uninitialized.\n         state: bool,\n@@ -180,8 +183,8 @@ impl InitMask {\n // Note: for performance reasons when interning, some of the fields can be partially\n // hashed. (see the `Hash` impl below for more details), so the impl is not derived.\n #[derive(Clone, Debug, Eq, PartialEq, TyEncodable, TyDecodable, HashStable)]\n-pub(crate) struct InitMaskMaterialized {\n-    pub(crate) blocks: Vec<Block>,\n+struct InitMaskMaterialized {\n+    blocks: Vec<Block>,\n }\n \n // Const allocations are only hashed for interning. However, they can be large, making the hashing"}, {"sha": "1a7934bc210dbc07a49df6aa11764bc4a6e4bddc", "filename": "compiler/rustc_middle/src/mir/interpret/allocation/init_mask/tests.rs", "status": "renamed", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a857ba25f9630032a34aba5dc45fd5f58351c7f0/compiler%2Frustc_middle%2Fsrc%2Fmir%2Finterpret%2Fallocation%2Finit_mask%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a857ba25f9630032a34aba5dc45fd5f58351c7f0/compiler%2Frustc_middle%2Fsrc%2Fmir%2Finterpret%2Fallocation%2Finit_mask%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fmir%2Finterpret%2Fallocation%2Finit_mask%2Ftests.rs?ref=a857ba25f9630032a34aba5dc45fd5f58351c7f0", "patch": "@@ -1,4 +1,5 @@\n use super::*;\n+use crate::mir::interpret::alloc_range;\n \n #[test]\n fn uninit_mask() {", "previous_filename": "compiler/rustc_middle/src/mir/interpret/allocation/tests.rs"}]}