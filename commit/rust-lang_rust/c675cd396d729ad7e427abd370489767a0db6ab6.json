{"sha": "c675cd396d729ad7e427abd370489767a0db6ab6", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM2NzVjZDM5NmQ3MjlhZDdlNDI3YWJkMzcwNDg5NzY3YTBkYjZhYjY=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-09-24T21:15:16Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-09-24T21:15:49Z"}, "message": "rustdoc: Fix for generations of anchors. #3570", "tree": {"sha": "23e869801abce2fef8765c36255e9cd18679ccfd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/23e869801abce2fef8765c36255e9cd18679ccfd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c675cd396d729ad7e427abd370489767a0db6ab6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c675cd396d729ad7e427abd370489767a0db6ab6", "html_url": "https://github.com/rust-lang/rust/commit/c675cd396d729ad7e427abd370489767a0db6ab6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c675cd396d729ad7e427abd370489767a0db6ab6/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "991cbfe42c8836e8b4adfcaf288d5c0b8d57397c", "url": "https://api.github.com/repos/rust-lang/rust/commits/991cbfe42c8836e8b4adfcaf288d5c0b8d57397c", "html_url": "https://github.com/rust-lang/rust/commit/991cbfe42c8836e8b4adfcaf288d5c0b8d57397c"}], "stats": {"total": 9, "additions": 8, "deletions": 1}, "files": [{"sha": "8ebe401dc14a9b0cc73102664c2966cad417baed", "filename": "src/rustdoc/markdown_index_pass.rs", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/c675cd396d729ad7e427abd370489767a0db6ab6/src%2Frustdoc%2Fmarkdown_index_pass.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c675cd396d729ad7e427abd370489767a0db6ab6/src%2Frustdoc%2Fmarkdown_index_pass.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Fmarkdown_index_pass.rs?ref=c675cd396d729ad7e427abd370489767a0db6ab6", "patch": "@@ -127,7 +127,12 @@ fn pandoc_header_id(header: ~str) -> ~str {\n         return s;\n     }\n     fn replace_with_hyphens(s: ~str) -> ~str {\n-        str::replace(s, ~\" \", ~\"-\")\n+        // Collapse sequences of whitespace to a single dash\n+        // XXX: Hacky implementation here that only covers\n+        // one or two spaces.\n+        let s = str::replace(s, ~\"  \", ~\"-\");\n+        let s = str::replace(s, ~\" \", ~\"-\");\n+        return s;\n     }\n     fn convert_to_lowercase(s: ~str) -> ~str { str::to_lower(s) }\n     fn remove_up_to_first_letter(s: ~str) -> ~str { s }\n@@ -144,6 +149,8 @@ fn should_remove_punctuation_from_headers() {\n         == ~\"impl-of-numnum-for-int\";\n     assert pandoc_header_id(~\"impl of num::num for ^int\")\n         == ~\"impl-of-numnum-for-int\";\n+    assert pandoc_header_id(~\"impl for & condvar\")\n+        == ~\"impl-for-condvar\";\n }\n \n #[test]"}]}