{"sha": "b8669dff556a03ca37b39cbb81be65c94d24defe", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI4NjY5ZGZmNTU2YTAzY2EzN2IzOWNiYjgxYmU2NWM5NGQyNGRlZmU=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2016-12-26T18:27:51Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2017-01-03T17:35:20Z"}, "message": "Ensure type is copyable before emitting note suggesting adding manual deref.\n\ndrive-by: fix merge conflict; fix test expected error output post rebase.", "tree": {"sha": "68ccf7cd1e809b8402246107679232364278a5cb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/68ccf7cd1e809b8402246107679232364278a5cb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b8669dff556a03ca37b39cbb81be65c94d24defe", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b8669dff556a03ca37b39cbb81be65c94d24defe", "html_url": "https://github.com/rust-lang/rust/commit/b8669dff556a03ca37b39cbb81be65c94d24defe", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b8669dff556a03ca37b39cbb81be65c94d24defe/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0d395841fc5141462c88a4167b2f675405d3a8eb", "url": "https://api.github.com/repos/rust-lang/rust/commits/0d395841fc5141462c88a4167b2f675405d3a8eb", "html_url": "https://github.com/rust-lang/rust/commit/0d395841fc5141462c88a4167b2f675405d3a8eb"}], "stats": {"total": 10, "additions": 5, "deletions": 5}, "files": [{"sha": "925d28247b610cc1268ff5a83623f975801d885a", "filename": "src/librustc_typeck/check/op.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/b8669dff556a03ca37b39cbb81be65c94d24defe/src%2Flibrustc_typeck%2Fcheck%2Fop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b8669dff556a03ca37b39cbb81be65c94d24defe/src%2Flibrustc_typeck%2Fcheck%2Fop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fop.rs?ref=b8669dff556a03ca37b39cbb81be65c94d24defe", "patch": "@@ -206,8 +206,9 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n                             lhs_ty);\n \n                         if let TypeVariants::TyRef(_, ref ty_mut) = lhs_ty.sty {\n-                            if self.lookup_op_method(expr, ty_mut.ty, vec![rhs_ty_var],\n-                                    token::intern(name), trait_def_id,\n+                            if !self.infcx.type_moves_by_default(ty_mut.ty, lhs_expr.span) &&\n+                                self.lookup_op_method(expr, ty_mut.ty, vec![rhs_ty_var],\n+                                    Symbol::intern(name), trait_def_id,\n                                     lhs_expr).is_ok() {\n                                 err.span_note(\n                                     lhs_expr.span,"}, {"sha": "a49cfaa17606dfcad53844dd0f3351440a9dd77f", "filename": "src/test/compile-fail/binary-op-on-double-ref.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b8669dff556a03ca37b39cbb81be65c94d24defe/src%2Ftest%2Fcompile-fail%2Fbinary-op-on-double-ref.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b8669dff556a03ca37b39cbb81be65c94d24defe/src%2Ftest%2Fcompile-fail%2Fbinary-op-on-double-ref.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fbinary-op-on-double-ref.rs?ref=b8669dff556a03ca37b39cbb81be65c94d24defe", "patch": "@@ -12,9 +12,9 @@ fn main() {\n     let v = vec![1, 2, 3, 4, 5, 6, 7, 8, 9];\n     let vr = v.iter().filter(|x| {\n         x % 2 == 0\n-        //~^ ERROR binary operation `%` cannot be applied to type `&&_`\n+        //~^ ERROR binary operation `%` cannot be applied to type `&&{integer}`\n         //~| NOTE this is a reference of type that `%` can be applied to\n-        //~| NOTE an implementation of `std::ops::Rem` might be missing for `&&_`\n+        //~| NOTE an implementation of `std::ops::Rem` might be missing for `&&{integer}`\n     });\n     println!(\"{:?}\", vr);\n }"}, {"sha": "f85422f76d40ee0d492fe6f219b2e62d9c7ed848", "filename": "src/test/compile-fail/str-concat-on-double-ref.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b8669dff556a03ca37b39cbb81be65c94d24defe/src%2Ftest%2Fcompile-fail%2Fstr-concat-on-double-ref.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b8669dff556a03ca37b39cbb81be65c94d24defe/src%2Ftest%2Fcompile-fail%2Fstr-concat-on-double-ref.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fstr-concat-on-double-ref.rs?ref=b8669dff556a03ca37b39cbb81be65c94d24defe", "patch": "@@ -13,7 +13,6 @@ fn main() {\n     let b: &str = &\"2\";\n     let c = a + b;\n     //~^ ERROR binary operation `+` cannot be applied to type `&std::string::String`\n-    //~| NOTE this is a reference of type that `+` can be applied to\n     //~| NOTE an implementation of `std::ops::Add` might be missing for `&std::string::String`\n     println!(\"{:?}\", c);\n }"}]}