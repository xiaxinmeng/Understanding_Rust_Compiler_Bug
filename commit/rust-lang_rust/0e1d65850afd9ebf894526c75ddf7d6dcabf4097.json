{"sha": "0e1d65850afd9ebf894526c75ddf7d6dcabf4097", "node_id": "C_kwDOAAsO6NoAKDBlMWQ2NTg1MGFmZDllYmY4OTQ1MjZjNzVkZGY3ZDZkY2FiZjQwOTc", "commit": {"author": {"name": "alex-semenyuk", "email": "alexsemenyuk88@gmail.com", "date": "2022-07-30T14:21:37Z"}, "committer": {"name": "alex-semenyuk", "email": "alexsemenyuk88@gmail.com", "date": "2022-08-04T18:30:50Z"}, "message": "Fix cast_abs_to_unsigned generates non-compiling code when original code is in parens", "tree": {"sha": "6be5dcae9b8ce08e8ecd250a3c90e54f0e7a9c5b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6be5dcae9b8ce08e8ecd250a3c90e54f0e7a9c5b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0e1d65850afd9ebf894526c75ddf7d6dcabf4097", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0e1d65850afd9ebf894526c75ddf7d6dcabf4097", "html_url": "https://github.com/rust-lang/rust/commit/0e1d65850afd9ebf894526c75ddf7d6dcabf4097", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0e1d65850afd9ebf894526c75ddf7d6dcabf4097/comments", "author": {"login": "alex-semenyuk", "id": 5480441, "node_id": "MDQ6VXNlcjU0ODA0NDE=", "avatar_url": "https://avatars.githubusercontent.com/u/5480441?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alex-semenyuk", "html_url": "https://github.com/alex-semenyuk", "followers_url": "https://api.github.com/users/alex-semenyuk/followers", "following_url": "https://api.github.com/users/alex-semenyuk/following{/other_user}", "gists_url": "https://api.github.com/users/alex-semenyuk/gists{/gist_id}", "starred_url": "https://api.github.com/users/alex-semenyuk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alex-semenyuk/subscriptions", "organizations_url": "https://api.github.com/users/alex-semenyuk/orgs", "repos_url": "https://api.github.com/users/alex-semenyuk/repos", "events_url": "https://api.github.com/users/alex-semenyuk/events{/privacy}", "received_events_url": "https://api.github.com/users/alex-semenyuk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alex-semenyuk", "id": 5480441, "node_id": "MDQ6VXNlcjU0ODA0NDE=", "avatar_url": "https://avatars.githubusercontent.com/u/5480441?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alex-semenyuk", "html_url": "https://github.com/alex-semenyuk", "followers_url": "https://api.github.com/users/alex-semenyuk/followers", "following_url": "https://api.github.com/users/alex-semenyuk/following{/other_user}", "gists_url": "https://api.github.com/users/alex-semenyuk/gists{/gist_id}", "starred_url": "https://api.github.com/users/alex-semenyuk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alex-semenyuk/subscriptions", "organizations_url": "https://api.github.com/users/alex-semenyuk/orgs", "repos_url": "https://api.github.com/users/alex-semenyuk/repos", "events_url": "https://api.github.com/users/alex-semenyuk/events{/privacy}", "received_events_url": "https://api.github.com/users/alex-semenyuk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "580f642cfac7d7035c563a060265b3dbef092ada", "url": "https://api.github.com/repos/rust-lang/rust/commits/580f642cfac7d7035c563a060265b3dbef092ada", "html_url": "https://github.com/rust-lang/rust/commit/580f642cfac7d7035c563a060265b3dbef092ada"}], "stats": {"total": 14, "additions": 12, "deletions": 2}, "files": [{"sha": "6426e8c25ac1c728de493d03ad475bdbc4256651", "filename": "clippy_lints/src/casts/cast_abs_to_unsigned.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0e1d65850afd9ebf894526c75ddf7d6dcabf4097/clippy_lints%2Fsrc%2Fcasts%2Fcast_abs_to_unsigned.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0e1d65850afd9ebf894526c75ddf7d6dcabf4097/clippy_lints%2Fsrc%2Fcasts%2Fcast_abs_to_unsigned.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fcasts%2Fcast_abs_to_unsigned.rs?ref=0e1d65850afd9ebf894526c75ddf7d6dcabf4097", "patch": "@@ -37,7 +37,7 @@ pub(super) fn check(\n             span,\n             &format!(\"casting the result of `{cast_from}::abs()` to {cast_to}\"),\n             \"replace with\",\n-            format!(\"{}.unsigned_abs()\", Sugg::hir(cx, &args[0], \"..\")),\n+            format!(\"{}.unsigned_abs()\", Sugg::hir(cx, &args[0], \"..\").maybe_par()),\n             Applicability::MachineApplicable,\n         );\n     }"}, {"sha": "7ecefd7b13439f5e7df85c5ad3fff049371be523", "filename": "tests/ui/cast_abs_to_unsigned.fixed", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0e1d65850afd9ebf894526c75ddf7d6dcabf4097/tests%2Fui%2Fcast_abs_to_unsigned.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/0e1d65850afd9ebf894526c75ddf7d6dcabf4097/tests%2Fui%2Fcast_abs_to_unsigned.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcast_abs_to_unsigned.fixed?ref=0e1d65850afd9ebf894526c75ddf7d6dcabf4097", "patch": "@@ -26,4 +26,6 @@ fn main() {\n     let _ = a.unsigned_abs() as u32;\n     let _ = a.unsigned_abs() as u64;\n     let _ = a.unsigned_abs() as u128;\n+\n+    let _ = (x as i64 - y as i64).unsigned_abs() as u32;\n }"}, {"sha": "30c603fca9a149265ac7d4b0d5a43d9811a71c9b", "filename": "tests/ui/cast_abs_to_unsigned.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0e1d65850afd9ebf894526c75ddf7d6dcabf4097/tests%2Fui%2Fcast_abs_to_unsigned.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0e1d65850afd9ebf894526c75ddf7d6dcabf4097/tests%2Fui%2Fcast_abs_to_unsigned.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcast_abs_to_unsigned.rs?ref=0e1d65850afd9ebf894526c75ddf7d6dcabf4097", "patch": "@@ -26,4 +26,6 @@ fn main() {\n     let _ = a.abs() as u32;\n     let _ = a.abs() as u64;\n     let _ = a.abs() as u128;\n+\n+    let _ = (x as i64 - y as i64).abs() as u32;\n }"}, {"sha": "0455377452676fe855f8994121c3309b1517dc08", "filename": "tests/ui/cast_abs_to_unsigned.stderr", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/0e1d65850afd9ebf894526c75ddf7d6dcabf4097/tests%2Fui%2Fcast_abs_to_unsigned.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0e1d65850afd9ebf894526c75ddf7d6dcabf4097/tests%2Fui%2Fcast_abs_to_unsigned.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcast_abs_to_unsigned.stderr?ref=0e1d65850afd9ebf894526c75ddf7d6dcabf4097", "patch": "@@ -96,5 +96,11 @@ error: casting the result of `isize::abs()` to u128\n LL |     let _ = a.abs() as u128;\n    |             ^^^^^^^ help: replace with: `a.unsigned_abs()`\n \n-error: aborting due to 16 previous errors\n+error: casting the result of `i64::abs()` to u32\n+  --> $DIR/cast_abs_to_unsigned.rs:30:13\n+   |\n+LL |     let _ = (x as i64 - y as i64).abs() as u32;\n+   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: replace with: `(x as i64 - y as i64).unsigned_abs()`\n+\n+error: aborting due to 17 previous errors\n "}]}