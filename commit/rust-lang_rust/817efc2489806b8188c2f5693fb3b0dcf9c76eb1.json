{"sha": "817efc2489806b8188c2f5693fb3b0dcf9c76eb1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjgxN2VmYzI0ODk4MDZiODE4OGMyZjU2OTNmYjNiMGRjZjljNzZlYjE=", "commit": {"author": {"name": "Scott McMurray", "email": "scottmcm@users.noreply.github.com", "date": "2018-07-25T00:55:36Z"}, "committer": {"name": "Scott McMurray", "email": "scottmcm@users.noreply.github.com", "date": "2018-08-19T23:53:42Z"}, "message": "Suggest `try` if someone uses `do catch`", "tree": {"sha": "4207e449a909b32308c0b9ccb134f15d09bb95ba", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4207e449a909b32308c0b9ccb134f15d09bb95ba"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/817efc2489806b8188c2f5693fb3b0dcf9c76eb1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/817efc2489806b8188c2f5693fb3b0dcf9c76eb1", "html_url": "https://github.com/rust-lang/rust/commit/817efc2489806b8188c2f5693fb3b0dcf9c76eb1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/817efc2489806b8188c2f5693fb3b0dcf9c76eb1/comments", "author": {"login": "scottmcm", "id": 18526288, "node_id": "MDQ6VXNlcjE4NTI2Mjg4", "avatar_url": "https://avatars.githubusercontent.com/u/18526288?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scottmcm", "html_url": "https://github.com/scottmcm", "followers_url": "https://api.github.com/users/scottmcm/followers", "following_url": "https://api.github.com/users/scottmcm/following{/other_user}", "gists_url": "https://api.github.com/users/scottmcm/gists{/gist_id}", "starred_url": "https://api.github.com/users/scottmcm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scottmcm/subscriptions", "organizations_url": "https://api.github.com/users/scottmcm/orgs", "repos_url": "https://api.github.com/users/scottmcm/repos", "events_url": "https://api.github.com/users/scottmcm/events{/privacy}", "received_events_url": "https://api.github.com/users/scottmcm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "scottmcm", "id": 18526288, "node_id": "MDQ6VXNlcjE4NTI2Mjg4", "avatar_url": "https://avatars.githubusercontent.com/u/18526288?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scottmcm", "html_url": "https://github.com/scottmcm", "followers_url": "https://api.github.com/users/scottmcm/followers", "following_url": "https://api.github.com/users/scottmcm/following{/other_user}", "gists_url": "https://api.github.com/users/scottmcm/gists{/gist_id}", "starred_url": "https://api.github.com/users/scottmcm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scottmcm/subscriptions", "organizations_url": "https://api.github.com/users/scottmcm/orgs", "repos_url": "https://api.github.com/users/scottmcm/repos", "events_url": "https://api.github.com/users/scottmcm/events{/privacy}", "received_events_url": "https://api.github.com/users/scottmcm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "91967a8f163b44eb46bdac130ffded7752ae298c", "url": "https://api.github.com/repos/rust-lang/rust/commits/91967a8f163b44eb46bdac130ffded7752ae298c", "html_url": "https://github.com/rust-lang/rust/commit/91967a8f163b44eb46bdac130ffded7752ae298c"}], "stats": {"total": 29, "additions": 29, "deletions": 0}, "files": [{"sha": "ad57530474ce7709fe5b58c731e603811584c66c", "filename": "src/libsyntax/parse/parser.rs", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/817efc2489806b8188c2f5693fb3b0dcf9c76eb1/src%2Flibsyntax%2Fparse%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/817efc2489806b8188c2f5693fb3b0dcf9c76eb1/src%2Flibsyntax%2Fparse%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Fparser.rs?ref=817efc2489806b8188c2f5693fb3b0dcf9c76eb1", "patch": "@@ -2386,6 +2386,11 @@ impl<'a> Parser<'a> {\n                         BlockCheckMode::Unsafe(ast::UserProvided),\n                         attrs);\n                 }\n+                if self.is_do_catch_block() {\n+                    let mut db = self.fatal(\"found removed `do catch` syntax\");\n+                    db.help(\"Following RFC #2388, the new non-placeholder syntax is `try`\");\n+                    return Err(db);\n+                }\n                 if self.is_try_block() {\n                     let lo = self.span;\n                     assert!(self.eat_keyword(keywords::Try));\n@@ -4406,6 +4411,13 @@ impl<'a> Parser<'a> {\n         )\n     }\n \n+    fn is_do_catch_block(&mut self) -> bool {\n+        self.token.is_keyword(keywords::Do) &&\n+        self.look_ahead(1, |t| t.is_keyword(keywords::Catch)) &&\n+        self.look_ahead(2, |t| *t == token::OpenDelim(token::Brace)) &&\n+        !self.restrictions.contains(Restrictions::NO_STRUCT_LITERAL)\n+    }\n+\n     fn is_try_block(&mut self) -> bool {\n         self.token.is_keyword(keywords::Try) &&\n         self.look_ahead(1, |t| *t == token::OpenDelim(token::Brace)) &&"}, {"sha": "449135e69c3197c22bd39509efcf9c74e36428a0", "filename": "src/test/parse-fail/do-catch-suggests-try.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/817efc2489806b8188c2f5693fb3b0dcf9c76eb1/src%2Ftest%2Fparse-fail%2Fdo-catch-suggests-try.rs", "raw_url": "https://github.com/rust-lang/rust/raw/817efc2489806b8188c2f5693fb3b0dcf9c76eb1/src%2Ftest%2Fparse-fail%2Fdo-catch-suggests-try.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fparse-fail%2Fdo-catch-suggests-try.rs?ref=817efc2489806b8188c2f5693fb3b0dcf9c76eb1", "patch": "@@ -0,0 +1,17 @@\n+// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// compile-flags: -Z parse-only\n+\n+fn main() {\n+    let _: Option<()> = do catch {};\n+    //~^ ERROR found removed `do catch` syntax\n+    //~^^ HELP Following RFC #2388, the new non-placeholder syntax is `try`\n+}"}]}