{"sha": "c8def9222be5079585e15b2902039d371b7527ce", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM4ZGVmOTIyMmJlNTA3OTU4NWUxNWIyOTAyMDM5ZDM3MWI3NTI3Y2U=", "commit": {"author": {"name": "Jimmy Brush", "email": "code@jimmah.com", "date": "2018-02-12T18:32:55Z"}, "committer": {"name": "Jimmy Brush", "email": "code@jimmah.com", "date": "2018-02-14T03:10:27Z"}, "message": "handle -no-pie error from clang", "tree": {"sha": "160e3f39476a78715829735a6692c9a91c027a61", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/160e3f39476a78715829735a6692c9a91c027a61"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c8def9222be5079585e15b2902039d371b7527ce", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA1EtiBaDzGKsVzCxjAopB5kfVmQFAlqDqKMACgkQjAopB5kf\nVmTCvRAAoR44ar7lXUzQh+wrTKcq2Ui85g9bTyhJNMQnIeF9HzIAMbTBRESZR8m1\nWucOc/+D95fhJjVCONmvT3AgHaI9ZlOzBGJ5TJ40/2EW/oGdQ5cGmdJtEpA7AqnL\n0dOqoziTpbrLX8wjphF6T3V51v/SFQmZLphNxzL27pPVVReshCwaonfvabiQbI2W\nY6533fikEn7uiy2rMwS5nFuI6gJMdl0BIPFqobeLFqcgawKMSdcq7ou7UxciwxOT\nuxZK2olZtVpDOR/B55ZMTK+QKYyA+yd27MpIdHrjgyWG/55f3EmGT/RLo9bn5uP2\nOlpMFu8NU9Z9mYAbiw07pY24NDeCPyowxCKqT3oNWDYviSK6N03eV/obq1jqb26R\nlQvwulMMldO9+f4wZEmJEzfnO3xZFYUJeYwdtP7+Madt+LhyFDlHYkrXsh39gJqR\nBFtYgqMQdQNxg+NQKF5Z6sgzL/PMLgSaHhtdTqK+Ik1auqyFHcyIjOjWHJ/sA/yM\n3g4lMRrTS4CQNYUScs9K6FbRtkQ19BSWAw3Em1PDU2aoZ1v8ha7gyv+dqLJJJUoY\nRv6t8KA7+51m+j16jv4IgqIXrOdxMSeEdRE7B6WETJ/YUmBJ/9d4H/eGaBIuBHlI\nZ7Fj9TNNCSyZRxuwGMaPMEQ1rhsndPGGH/zpdVp9NP28lPs/i40=\n=cjtI\n-----END PGP SIGNATURE-----", "payload": "tree 160e3f39476a78715829735a6692c9a91c027a61\nparent f0e9af1c5509ecd57c2398085b639abfb15f4ba1\nauthor Jimmy Brush <code@jimmah.com> 1518460375 -0500\ncommitter Jimmy Brush <code@jimmah.com> 1518577827 -0500\n\nhandle -no-pie error from clang\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c8def9222be5079585e15b2902039d371b7527ce", "html_url": "https://github.com/rust-lang/rust/commit/c8def9222be5079585e15b2902039d371b7527ce", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c8def9222be5079585e15b2902039d371b7527ce/comments", "author": {"login": "canarysnort01", "id": 24806352, "node_id": "MDQ6VXNlcjI0ODA2MzUy", "avatar_url": "https://avatars.githubusercontent.com/u/24806352?v=4", "gravatar_id": "", "url": "https://api.github.com/users/canarysnort01", "html_url": "https://github.com/canarysnort01", "followers_url": "https://api.github.com/users/canarysnort01/followers", "following_url": "https://api.github.com/users/canarysnort01/following{/other_user}", "gists_url": "https://api.github.com/users/canarysnort01/gists{/gist_id}", "starred_url": "https://api.github.com/users/canarysnort01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/canarysnort01/subscriptions", "organizations_url": "https://api.github.com/users/canarysnort01/orgs", "repos_url": "https://api.github.com/users/canarysnort01/repos", "events_url": "https://api.github.com/users/canarysnort01/events{/privacy}", "received_events_url": "https://api.github.com/users/canarysnort01/received_events", "type": "User", "site_admin": false}, "committer": {"login": "canarysnort01", "id": 24806352, "node_id": "MDQ6VXNlcjI0ODA2MzUy", "avatar_url": "https://avatars.githubusercontent.com/u/24806352?v=4", "gravatar_id": "", "url": "https://api.github.com/users/canarysnort01", "html_url": "https://github.com/canarysnort01", "followers_url": "https://api.github.com/users/canarysnort01/followers", "following_url": "https://api.github.com/users/canarysnort01/following{/other_user}", "gists_url": "https://api.github.com/users/canarysnort01/gists{/gist_id}", "starred_url": "https://api.github.com/users/canarysnort01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/canarysnort01/subscriptions", "organizations_url": "https://api.github.com/users/canarysnort01/orgs", "repos_url": "https://api.github.com/users/canarysnort01/repos", "events_url": "https://api.github.com/users/canarysnort01/events{/privacy}", "received_events_url": "https://api.github.com/users/canarysnort01/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f0e9af1c5509ecd57c2398085b639abfb15f4ba1", "url": "https://api.github.com/repos/rust-lang/rust/commits/f0e9af1c5509ecd57c2398085b639abfb15f4ba1", "html_url": "https://github.com/rust-lang/rust/commit/f0e9af1c5509ecd57c2398085b639abfb15f4ba1"}], "stats": {"total": 12, "additions": 7, "deletions": 5}, "files": [{"sha": "0a3e6265c1b7e4d81cf678823b450923f4002f4a", "filename": "src/librustc_trans/back/link.rs", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/c8def9222be5079585e15b2902039d371b7527ce/src%2Flibrustc_trans%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c8def9222be5079585e15b2902039d371b7527ce/src%2Flibrustc_trans%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fback%2Flink.rs?ref=c8def9222be5079585e15b2902039d371b7527ce", "patch": "@@ -664,11 +664,13 @@ fn link_natively(sess: &Session,\n         let out = String::from_utf8_lossy(&out);\n \n         // Check to see if the link failed with \"unrecognized command line option:\n-        // '-no-pie'\". If so, reperform the link step without the -no-pie option. This\n-        // is safe because if the linker doesn't support -no-pie then it should not\n-        // default to linking executables as pie. Different versions of gcc seem to\n-        // use different quotes in the error message so don't check for them.\n-        if out.contains(\"unrecognized command line option\") &&\n+        // '-no-pie'\" for gcc or \"unknown argument: '-no-pie'\" for clang. If so,\n+        // reperform the link step without the -no-pie option. This is safe because\n+        // if the linker doesn't support -no-pie then it should not default to\n+        // linking executables as pie. Different versions of gcc seem to use\n+        // different quotes in the error message so don't check for them.\n+        if (out.contains(\"unrecognized command line option\") ||\n+            out.contains(\"unknown argument\")) &&\n            out.contains(\"-no-pie\") &&\n            cmd.get_args().iter().any(|e| e.to_string_lossy() == \"-no-pie\") {\n             info!(\"linker output: {:?}\", out);"}]}