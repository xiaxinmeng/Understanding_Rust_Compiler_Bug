{"sha": "0a014c684140c8df32aea55801f006a1b8aa973c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBhMDE0YzY4NDE0MGM4ZGYzMmFlYTU1ODAxZjAwNmExYjhhYTk3M2M=", "commit": {"author": {"name": "Jeremy Soller", "email": "jackpot51@gmail.com", "date": "2016-12-19T22:49:57Z"}, "committer": {"name": "Jeremy Soller", "email": "jackpot51@gmail.com", "date": "2016-12-19T22:49:57Z"}, "message": "Move prefix to [install] section", "tree": {"sha": "698604640d87789e85b5183d0beb30f2587bb54b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/698604640d87789e85b5183d0beb30f2587bb54b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0a014c684140c8df32aea55801f006a1b8aa973c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0a014c684140c8df32aea55801f006a1b8aa973c", "html_url": "https://github.com/rust-lang/rust/commit/0a014c684140c8df32aea55801f006a1b8aa973c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0a014c684140c8df32aea55801f006a1b8aa973c/comments", "author": {"login": "jackpot51", "id": 7741236, "node_id": "MDQ6VXNlcjc3NDEyMzY=", "avatar_url": "https://avatars.githubusercontent.com/u/7741236?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackpot51", "html_url": "https://github.com/jackpot51", "followers_url": "https://api.github.com/users/jackpot51/followers", "following_url": "https://api.github.com/users/jackpot51/following{/other_user}", "gists_url": "https://api.github.com/users/jackpot51/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackpot51/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackpot51/subscriptions", "organizations_url": "https://api.github.com/users/jackpot51/orgs", "repos_url": "https://api.github.com/users/jackpot51/repos", "events_url": "https://api.github.com/users/jackpot51/events{/privacy}", "received_events_url": "https://api.github.com/users/jackpot51/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jackpot51", "id": 7741236, "node_id": "MDQ6VXNlcjc3NDEyMzY=", "avatar_url": "https://avatars.githubusercontent.com/u/7741236?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackpot51", "html_url": "https://github.com/jackpot51", "followers_url": "https://api.github.com/users/jackpot51/followers", "following_url": "https://api.github.com/users/jackpot51/following{/other_user}", "gists_url": "https://api.github.com/users/jackpot51/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackpot51/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackpot51/subscriptions", "organizations_url": "https://api.github.com/users/jackpot51/orgs", "repos_url": "https://api.github.com/users/jackpot51/repos", "events_url": "https://api.github.com/users/jackpot51/events{/privacy}", "received_events_url": "https://api.github.com/users/jackpot51/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "58b94bd3a84600047f6a994b55b51bb2baf143d9", "url": "https://api.github.com/repos/rust-lang/rust/commits/58b94bd3a84600047f6a994b55b51bb2baf143d9", "html_url": "https://github.com/rust-lang/rust/commit/58b94bd3a84600047f6a994b55b51bb2baf143d9"}], "stats": {"total": 25, "additions": 20, "deletions": 5}, "files": [{"sha": "942555274057ecc96f849f4138f94ff80f3950d9", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/0a014c684140c8df32aea55801f006a1b8aa973c/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0a014c684140c8df32aea55801f006a1b8aa973c/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=0a014c684140c8df32aea55801f006a1b8aa973c", "patch": "@@ -113,6 +113,7 @@ pub struct Target {\n #[derive(RustcDecodable, Default)]\n struct TomlConfig {\n     build: Option<Build>,\n+    install: Option<Install>,\n     llvm: Option<Llvm>,\n     rust: Option<Rust>,\n     target: Option<HashMap<String, TomlTarget>>,\n@@ -126,7 +127,6 @@ struct Build {\n     target: Vec<String>,\n     cargo: Option<String>,\n     rustc: Option<String>,\n-    prefix: Option<String>,\n     compiler_docs: Option<bool>,\n     docs: Option<bool>,\n     submodules: Option<bool>,\n@@ -136,6 +136,12 @@ struct Build {\n     python: Option<String>,\n }\n \n+/// TOML representation of various global install decisions.\n+#[derive(RustcDecodable, Default, Clone)]\n+struct Install {\n+    prefix: Option<String>,\n+}\n+\n /// TOML representation of how the LLVM build is configured.\n #[derive(RustcDecodable, Default)]\n struct Llvm {\n@@ -239,7 +245,6 @@ impl Config {\n         }\n         config.rustc = build.rustc.map(PathBuf::from);\n         config.cargo = build.cargo.map(PathBuf::from);\n-        config.prefix = build.prefix;\n         config.nodejs = build.nodejs.map(PathBuf::from);\n         config.gdb = build.gdb.map(PathBuf::from);\n         config.python = build.python.map(PathBuf::from);\n@@ -248,6 +253,10 @@ impl Config {\n         set(&mut config.submodules, build.submodules);\n         set(&mut config.vendor, build.vendor);\n \n+        if let Some(ref install) = toml.install {\n+            config.prefix = install.prefix.clone();\n+        }\n+\n         if let Some(ref llvm) = toml.llvm {\n             set(&mut config.ccache, llvm.ccache);\n             set(&mut config.ninja, llvm.ninja);\n@@ -257,6 +266,7 @@ impl Config {\n             set(&mut config.llvm_version_check, llvm.version_check);\n             set(&mut config.llvm_static_stdcpp, llvm.static_libstdcpp);\n         }\n+        \n         if let Some(ref rust) = toml.rust {\n             set(&mut config.rust_debug_assertions, rust.debug_assertions);\n             set(&mut config.rust_debuginfo, rust.debuginfo);"}, {"sha": "4a08d66d8d9a0a9b65e0a0ba6ba2d3254dfc208a", "filename": "src/bootstrap/config.toml.example", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/0a014c684140c8df32aea55801f006a1b8aa973c/src%2Fbootstrap%2Fconfig.toml.example", "raw_url": "https://github.com/rust-lang/rust/raw/0a014c684140c8df32aea55801f006a1b8aa973c/src%2Fbootstrap%2Fconfig.toml.example", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.toml.example?ref=0a014c684140c8df32aea55801f006a1b8aa973c", "patch": "@@ -70,9 +70,6 @@\n # specified, use this rustc binary instead as the stage0 snapshot compiler.\n #rustc = \"/path/to/bin/rustc\"\n \n-# Instead of installing to /usr/local, install to this path instead.\n-#prefix = \"/path/to/install\"\n-\n # Flag to specify whether any documentation is built. If false, rustdoc and\n # friends will still be compiled but they will not be used to generate any\n # documentation.\n@@ -101,6 +98,14 @@\n # Indicate whether the vendored sources are used for Rust dependencies or not\n #vendor = false\n \n+# =============================================================================\n+# General install configuration options\n+# =============================================================================\n+[install]\n+\n+# Instead of installing to /usr/local, install to this path instead.\n+#prefix = \"/path/to/install\"\n+\n # =============================================================================\n # Options for compiling Rust code itself\n # ============================================================================="}]}