{"sha": "ba97ad35097146570508dff455f88a194daca3b6", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJhOTdhZDM1MDk3MTQ2NTcwNTA4ZGZmNDU1Zjg4YTE5NGRhY2EzYjY=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-03-20T17:06:21Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-03-24T14:36:13Z"}, "message": "ci: move the whole workspace directory on gha/linux\n\nMoving just the `obj` directory created problems with mountpoints and\nDocker containers, so this tries to symlink the parent directory.", "tree": {"sha": "2d5701b10d1c3103eac9b70baa460756c155990a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2d5701b10d1c3103eac9b70baa460756c155990a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ba97ad35097146570508dff455f88a194daca3b6", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE1JbYPtLJAsc22U9xPgar6Auq8ZwFAl56Gt0ACgkQPgar6Auq\n8ZyL2RAAx7YgmHGLoYegNInbxv3eZuFHllg/FmuZyWnfkiaPbikHv7bpsqTiXrXJ\nLxRGDxrt/fL667G2H8zzgsRKXXcCJ173aV47hbHW9m7UZgoojyHvV2WLt0W/nFVI\nRm6LzG7xHyERHDr40vAQEa2d2nuc72rx1VjQ4hZjXncdPA17OlqdM1R4GcihT9QX\nyN4P3sl2MljOPbexyCopJK0nG2grp7oIpUhmx+eO98/x+FijeVw+ezQdQD5HC8dy\n6rhZ0gjpZw/J6ZkpP1EipsOMWlUlBgK+O41SrRZiAUW3Y449K3yG6IdpC1iyB2jO\nTqPTLvd4s1IbIgOZvZOY0b46+jawnlmmXK33BTEo5BVHnwzBNFyvuF33iJcifUxJ\nlY6BJ+WmaCJJblMiNbmfZqIXzrA646aHYzRQI78ffVFnJxR5NnIW1rB3br2vbHin\nc3EmMnJjTpJXvy5XIL+AlvBc3ghvlx/cMNH2X4obHlVNfWSxrbr/vRcLThpeyrRD\n7HB23zr76+L5HX833Av8W6A+dCwzcBkfQc965Iky/qyg3P7klMBntgC99elMB0sE\nGYiG2jwSeL4Rha6iYqeJ9QU/zuFff1/4AOby3Lw0v92UriFH9zrdRZiricOjJd97\nPoy85b4OKiMgtIYyXX8dl+T8ymFk6SACAfwoRsHv9oPMRnPu9Vg=\n=R5XA\n-----END PGP SIGNATURE-----", "payload": "tree 2d5701b10d1c3103eac9b70baa460756c155990a\nparent 11aafa5305656ca3190d099c1bb92b47e587cd0c\nauthor Pietro Albini <pietro@pietroalbini.org> 1584723981 +0100\ncommitter Pietro Albini <pietro@pietroalbini.org> 1585060573 +0100\n\nci: move the whole workspace directory on gha/linux\n\nMoving just the `obj` directory created problems with mountpoints and\nDocker containers, so this tries to symlink the parent directory.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ba97ad35097146570508dff455f88a194daca3b6", "html_url": "https://github.com/rust-lang/rust/commit/ba97ad35097146570508dff455f88a194daca3b6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ba97ad35097146570508dff455f88a194daca3b6/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "11aafa5305656ca3190d099c1bb92b47e587cd0c", "url": "https://api.github.com/repos/rust-lang/rust/commits/11aafa5305656ca3190d099c1bb92b47e587cd0c", "html_url": "https://github.com/rust-lang/rust/commit/11aafa5305656ca3190d099c1bb92b47e587cd0c"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "c77059c00ac2a583b95b932bf9fe357203c17de9", "filename": "src/ci/scripts/symlink-build-dir.sh", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/ba97ad35097146570508dff455f88a194daca3b6/src%2Fci%2Fscripts%2Fsymlink-build-dir.sh", "raw_url": "https://github.com/rust-lang/rust/raw/ba97ad35097146570508dff455f88a194daca3b6/src%2Fci%2Fscripts%2Fsymlink-build-dir.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fscripts%2Fsymlink-build-dir.sh?ref=ba97ad35097146570508dff455f88a194daca3b6", "patch": "@@ -15,5 +15,13 @@ if isWindows && isAzurePipelines; then\n elif isLinux && isGitHubActions; then\n     sudo mkdir -p /mnt/more-space\n     sudo chown -R \"$(whoami):\" /mnt/more-space\n-    ln -s /mnt/more-space obj\n+\n+    # Switch the whole workspace to the /mnt partition, which has more space.\n+    # We don't just symlink the `obj` directory as doing that creates problems\n+    # with the docker container.\n+    current_dir=\"$(readlink -f \"$(pwd)\")\"\n+    cd /tmp\n+    mv \"${current_dir}\" /mnt/more-space/workspace\n+    ln -s /mnt/more-space/workspace \"${current_dir}\"\n+    cd \"${current_dir}\"\n fi"}]}