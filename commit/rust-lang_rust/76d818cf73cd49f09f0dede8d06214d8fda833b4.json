{"sha": "76d818cf73cd49f09f0dede8d06214d8fda833b4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc2ZDgxOGNmNzNjZDQ5ZjA5ZjBkZWRlOGQwNjIxNGQ4ZmRhODMzYjQ=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-04-06T20:52:46Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-04-06T20:52:46Z"}, "message": "Rollup merge of #59740 - cuviper:folded-extend, r=scottmcm\n\nUse for_each to extend collections\n\nThis updates the `Extend` implementations to use `for_each` for many\ncollections: `BinaryHeap`, `BTreeMap`, `BTreeSet`, `LinkedList`, `Path`,\n`TokenStream`, `VecDeque`, and `Wtf8Buf`.\n\nFolding with `for_each` enables better performance than a `for`-loop for\nsome iterators, especially if they can just forward to internal\niterators, like `Chain` and `FlatMap` do.", "tree": {"sha": "e61696cb41473e3f578ebb8bb850d77c196d1662", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e61696cb41473e3f578ebb8bb850d77c196d1662"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/76d818cf73cd49f09f0dede8d06214d8fda833b4", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcqRGeCRBK7hj4Ov3rIwAAdHIIAGgWyHzC5fqUV/lXiTAucCql\nDbVlrqkc5B6evybO47PbIL1P1LBoy4VougIPkwWeRsg/WRO3VGNbCM+xh8Q6WZCp\nhxIeOfRx3JuE418eyYTkPdwI5nteeKb5/1ZMHQKSOrR3cV+6bkOiPhm3SdsLQi/K\ny0O6YlaclvK05ztiFoCgl7vTxlCEI+pu8Jq80IfvQbICXUzx+IX38eqrXOqR/QnK\nOiycpb/SXa1y5GUNf2WgxV48yCMiIctwN+M9rEMFGqyQC203R4RAtpmqalV9jpgU\npvH7ucJx76ZzLhGj/Yk3PbH8FNnmtplkGDujZHb99CsyJLI0MjHhg6CL1pF6/6s=\n=T6FM\n-----END PGP SIGNATURE-----\n", "payload": "tree e61696cb41473e3f578ebb8bb850d77c196d1662\nparent ed45788e532449e27411e9ccebecc36562c4bbcf\nparent 0730a01c5ca3b0e8760d72a05c47d4199bd64728\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1554583966 +0200\ncommitter GitHub <noreply@github.com> 1554583966 +0200\n\nRollup merge of #59740 - cuviper:folded-extend, r=scottmcm\n\nUse for_each to extend collections\n\nThis updates the `Extend` implementations to use `for_each` for many\ncollections: `BinaryHeap`, `BTreeMap`, `BTreeSet`, `LinkedList`, `Path`,\n`TokenStream`, `VecDeque`, and `Wtf8Buf`.\n\nFolding with `for_each` enables better performance than a `for`-loop for\nsome iterators, especially if they can just forward to internal\niterators, like `Chain` and `FlatMap` do.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/76d818cf73cd49f09f0dede8d06214d8fda833b4", "html_url": "https://github.com/rust-lang/rust/commit/76d818cf73cd49f09f0dede8d06214d8fda833b4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/76d818cf73cd49f09f0dede8d06214d8fda833b4/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ed45788e532449e27411e9ccebecc36562c4bbcf", "url": "https://api.github.com/repos/rust-lang/rust/commits/ed45788e532449e27411e9ccebecc36562c4bbcf", "html_url": "https://github.com/rust-lang/rust/commit/ed45788e532449e27411e9ccebecc36562c4bbcf"}, {"sha": "0730a01c5ca3b0e8760d72a05c47d4199bd64728", "url": "https://api.github.com/repos/rust-lang/rust/commits/0730a01c5ca3b0e8760d72a05c47d4199bd64728", "html_url": "https://github.com/rust-lang/rust/commit/0730a01c5ca3b0e8760d72a05c47d4199bd64728"}], "stats": {"total": 32, "additions": 10, "deletions": 22}, "files": [{"sha": "8c142a3d317c6f12476e44a4147a473e3f285250", "filename": "src/liballoc/collections/binary_heap.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Fliballoc%2Fcollections%2Fbinary_heap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Fliballoc%2Fcollections%2Fbinary_heap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Fcollections%2Fbinary_heap.rs?ref=76d818cf73cd49f09f0dede8d06214d8fda833b4", "patch": "@@ -1177,9 +1177,7 @@ impl<T: Ord> BinaryHeap<T> {\n \n         self.reserve(lower);\n \n-        for elem in iterator {\n-            self.push(elem);\n-        }\n+        iterator.for_each(move |elem| self.push(elem));\n     }\n }\n "}, {"sha": "6b079fc87cc78905f431a097a2aa8aaee7a33f3b", "filename": "src/liballoc/collections/btree/map.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Fliballoc%2Fcollections%2Fbtree%2Fmap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Fliballoc%2Fcollections%2Fbtree%2Fmap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Fcollections%2Fbtree%2Fmap.rs?ref=76d818cf73cd49f09f0dede8d06214d8fda833b4", "patch": "@@ -1727,9 +1727,9 @@ impl<K: Ord, V> FromIterator<(K, V)> for BTreeMap<K, V> {\n impl<K: Ord, V> Extend<(K, V)> for BTreeMap<K, V> {\n     #[inline]\n     fn extend<T: IntoIterator<Item = (K, V)>>(&mut self, iter: T) {\n-        for (k, v) in iter {\n+        iter.into_iter().for_each(move |(k, v)| {\n             self.insert(k, v);\n-        }\n+        });\n     }\n }\n "}, {"sha": "16a96ca19b82462b4a99f2e234f3e1c85b630e4f", "filename": "src/liballoc/collections/btree/set.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Fliballoc%2Fcollections%2Fbtree%2Fset.rs", "raw_url": "https://github.com/rust-lang/rust/raw/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Fliballoc%2Fcollections%2Fbtree%2Fset.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Fcollections%2Fbtree%2Fset.rs?ref=76d818cf73cd49f09f0dede8d06214d8fda833b4", "patch": "@@ -883,9 +883,9 @@ impl<'a, T> IntoIterator for &'a BTreeSet<T> {\n impl<T: Ord> Extend<T> for BTreeSet<T> {\n     #[inline]\n     fn extend<Iter: IntoIterator<Item = T>>(&mut self, iter: Iter) {\n-        for elem in iter {\n+        iter.into_iter().for_each(move |elem| {\n             self.insert(elem);\n-        }\n+        });\n     }\n }\n "}, {"sha": "d6d84a4f083d060ca380ffccca8cece42deccc11", "filename": "src/liballoc/collections/linked_list.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Fliballoc%2Fcollections%2Flinked_list.rs", "raw_url": "https://github.com/rust-lang/rust/raw/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Fliballoc%2Fcollections%2Flinked_list.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Fcollections%2Flinked_list.rs?ref=76d818cf73cd49f09f0dede8d06214d8fda833b4", "patch": "@@ -1107,9 +1107,7 @@ impl<T> Extend<T> for LinkedList<T> {\n \n impl<I: IntoIterator> SpecExtend<I> for LinkedList<I::Item> {\n     default fn spec_extend(&mut self, iter: I) {\n-        for elt in iter {\n-            self.push_back(elt);\n-        }\n+        iter.into_iter().for_each(move |elt| self.push_back(elt));\n     }\n }\n "}, {"sha": "4bea615ab861face0477a12fc36446c2f32874c2", "filename": "src/liballoc/collections/vec_deque.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Fliballoc%2Fcollections%2Fvec_deque.rs", "raw_url": "https://github.com/rust-lang/rust/raw/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Fliballoc%2Fcollections%2Fvec_deque.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Fcollections%2Fvec_deque.rs?ref=76d818cf73cd49f09f0dede8d06214d8fda833b4", "patch": "@@ -2677,9 +2677,7 @@ impl<'a, T> IntoIterator for &'a mut VecDeque<T> {\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n impl<A> Extend<A> for VecDeque<A> {\n     fn extend<T: IntoIterator<Item = A>>(&mut self, iter: T) {\n-        for elt in iter {\n-            self.push_back(elt);\n-        }\n+        iter.into_iter().for_each(move |elt| self.push_back(elt));\n     }\n }\n "}, {"sha": "1e0f1ed578aaed4a99016f92b92bf0ba1e377aeb", "filename": "src/libproc_macro/lib.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Flibproc_macro%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Flibproc_macro%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibproc_macro%2Flib.rs?ref=76d818cf73cd49f09f0dede8d06214d8fda833b4", "patch": "@@ -160,9 +160,7 @@ impl iter::FromIterator<TokenTree> for TokenStream {\n impl iter::FromIterator<TokenStream> for TokenStream {\n     fn from_iter<I: IntoIterator<Item = TokenStream>>(streams: I) -> Self {\n         let mut builder = bridge::client::TokenStreamBuilder::new();\n-        for stream in streams {\n-            builder.push(stream.0);\n-        }\n+        streams.into_iter().for_each(|stream| builder.push(stream.0));\n         TokenStream(builder.build())\n     }\n }"}, {"sha": "1bbda9b5bcb1aa2e5d7f81b863a62f35c892705c", "filename": "src/libstd/path.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Flibstd%2Fpath.rs", "raw_url": "https://github.com/rust-lang/rust/raw/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Flibstd%2Fpath.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fpath.rs?ref=76d818cf73cd49f09f0dede8d06214d8fda833b4", "patch": "@@ -1551,9 +1551,7 @@ impl<P: AsRef<Path>> iter::FromIterator<P> for PathBuf {\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n impl<P: AsRef<Path>> iter::Extend<P> for PathBuf {\n     fn extend<I: IntoIterator<Item = P>>(&mut self, iter: I) {\n-        for p in iter {\n-            self.push(p.as_ref())\n-        }\n+        iter.into_iter().for_each(move |p| self.push(p.as_ref()));\n     }\n }\n "}, {"sha": "f17020de44ec538ecbbf88f7e7aea934f6685cf0", "filename": "src/libstd/sys_common/wtf8.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Flibstd%2Fsys_common%2Fwtf8.rs", "raw_url": "https://github.com/rust-lang/rust/raw/76d818cf73cd49f09f0dede8d06214d8fda833b4/src%2Flibstd%2Fsys_common%2Fwtf8.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys_common%2Fwtf8.rs?ref=76d818cf73cd49f09f0dede8d06214d8fda833b4", "patch": "@@ -388,9 +388,7 @@ impl Extend<CodePoint> for Wtf8Buf {\n         let (low, _high) = iterator.size_hint();\n         // Lower bound of one byte per code point (ASCII only)\n         self.bytes.reserve(low);\n-        for code_point in iterator {\n-            self.push(code_point);\n-        }\n+        iterator.for_each(move |code_point| self.push(code_point));\n     }\n }\n "}]}