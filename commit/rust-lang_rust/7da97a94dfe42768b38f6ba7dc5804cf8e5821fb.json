{"sha": "7da97a94dfe42768b38f6ba7dc5804cf8e5821fb", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdkYTk3YTk0ZGZlNDI3NjhiMzhmNmJhN2RjNTgwNGNmOGU1ODIxZmI=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2018-10-09T06:08:50Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2018-10-15T18:44:22Z"}, "message": "Use `WalkDir` to also gather from subdirectories\n\n`fs::read_dir` does not recurse into subdirectories.", "tree": {"sha": "8be6c7677146248e8ca8f0f34acc96398a8b3c0e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8be6c7677146248e8ca8f0f34acc96398a8b3c0e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7da97a94dfe42768b38f6ba7dc5804cf8e5821fb", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEvUKv4zqIn2RHUgCKtvoGpuDiZlsFAlvE4AYACgkQtvoGpuDi\nZluCwQ//YGLcp0wQOZASUCq+o5xl0nnYB6/GIOWJWiwVG7sGFT22XVo4pviDnZDp\nUsbLdrnm9N72P1vsy9gEROJdA0mc/V8TB+DZky1ckgr+TH/zVg/bKBd4I4E4s2pc\no2nsJEnQmsx0LNgypD2dKKq6N6yLjN/Z7UVd2sN+Sx/86XLVbgQ97giOicvtprzs\n52+HcPYFdx1e0+bW6U/OFigMBmH/ZAMAczSZQFetu6Cr/1sbLgYnadMnfy7UNmqx\nKXjAei9QwfmtUjJrb39TPeVOI9c+huGz4Mq8BBwk8VLsgFW//Vmg1LlxB0DOjJ88\nocYdaD1kvcy6Bza/zNoHstWal+jduFM5FQ2LJ3MCiwNxOb9ZawfeHocOuAI4Tx9d\nFiK5sbRU0yqL6eQX18tkpoFeo1bu0TGn8zg6W6ZgmGz0snEPzHZeCgrKqhesJjcf\nRbmqYSSHKdckFV+zvAdN/2B9bkbZTxK/fHy3NFjlzo8Ro1q0BN1Jgs9z2pkGvOvG\nSnPjuMkUHK9BfB401LHl6yOwOwG95ecjtzK1sxnvXj+MbgaEoJmMpSViHKPNoex3\nAXf3iMuDFxu22O1cGB2c1BYo5eQm9TVINpKVhYsHILFpATFFt25U7TyW/2xQOAvg\nRpDSYDun/8zTANlFm/860Mr8xG50KPHhxXwLeN2dpJDBa4mxVU8=\n=EXBB\n-----END PGP SIGNATURE-----", "payload": "tree 8be6c7677146248e8ca8f0f34acc96398a8b3c0e\nparent 0f4b13bc1bbd43ed21878c21291dddde7e4b9028\nauthor Philipp Hansch <dev@phansch.net> 1539065330 +0200\ncommitter Philipp Hansch <dev@phansch.net> 1539629062 +0200\n\nUse `WalkDir` to also gather from subdirectories\n\n`fs::read_dir` does not recurse into subdirectories.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7da97a94dfe42768b38f6ba7dc5804cf8e5821fb", "html_url": "https://github.com/rust-lang/rust/commit/7da97a94dfe42768b38f6ba7dc5804cf8e5821fb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7da97a94dfe42768b38f6ba7dc5804cf8e5821fb/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0f4b13bc1bbd43ed21878c21291dddde7e4b9028", "url": "https://api.github.com/repos/rust-lang/rust/commits/0f4b13bc1bbd43ed21878c21291dddde7e4b9028", "html_url": "https://github.com/rust-lang/rust/commit/0f4b13bc1bbd43ed21878c21291dddde7e4b9028"}], "stats": {"total": 10, "additions": 6, "deletions": 4}, "files": [{"sha": "5380ecd9814eaa6694d701342e56f3a0464e3595", "filename": "clippy_dev/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7da97a94dfe42768b38f6ba7dc5804cf8e5821fb/clippy_dev%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/7da97a94dfe42768b38f6ba7dc5804cf8e5821fb/clippy_dev%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2FCargo.toml?ref=7da97a94dfe42768b38f6ba7dc5804cf8e5821fb", "patch": "@@ -9,3 +9,4 @@ clap = \"~2.32\"\n itertools = \"0.7\"\n regex = \"1\"\n lazy_static = \"1.0\"\n+walkdir = \"2\""}, {"sha": "d312eadf89e05b78e081c2755b3c8c2ea8e5dbe6", "filename": "clippy_dev/src/lib.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/7da97a94dfe42768b38f6ba7dc5804cf8e5821fb/clippy_dev%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7da97a94dfe42768b38f6ba7dc5804cf8e5821fb/clippy_dev%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Flib.rs?ref=7da97a94dfe42768b38f6ba7dc5804cf8e5821fb", "patch": "@@ -14,6 +14,7 @@\n use itertools::Itertools;\n use lazy_static::lazy_static;\n use regex::Regex;\n+use walkdir::WalkDir;\n use std::collections::HashMap;\n use std::ffi::OsStr;\n use std::fs;\n@@ -70,7 +71,7 @@ pub fn gather_all() -> impl Iterator<Item=Lint> {\n     lint_files().flat_map(|f| gather_from_file(&f))\n }\n \n-fn gather_from_file(dir_entry: &fs::DirEntry) -> impl Iterator<Item=Lint> {\n+fn gather_from_file(dir_entry: &walkdir::DirEntry) -> impl Iterator<Item=Lint> {\n     let mut file = fs::File::open(dir_entry.path()).unwrap();\n     let mut content = String::new();\n     file.read_to_string(&mut content).unwrap();\n@@ -89,9 +90,9 @@ fn parse_contents(content: &str, filename: &str) -> impl Iterator<Item=Lint> {\n }\n \n /// Collects all .rs files in the `clippy_lints/src` directory\n-fn lint_files() -> impl Iterator<Item=fs::DirEntry> {\n-    fs::read_dir(\"../clippy_lints/src\")\n-        .unwrap()\n+fn lint_files() -> impl Iterator<Item=walkdir::DirEntry> {\n+    WalkDir::new(\"../clippy_lints/src\")\n+        .into_iter()\n         .filter_map(|f| f.ok())\n         .filter(|f| f.path().extension() == Some(OsStr::new(\"rs\")))\n }"}]}