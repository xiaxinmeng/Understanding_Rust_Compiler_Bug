{"sha": "b21ef2b365ef4f5c973327f3f6064b8be42d1dae", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIyMWVmMmIzNjVlZjRmNWM5NzMzMjdmM2Y2MDY0YjhiZTQyZDFkYWU=", "commit": {"author": {"name": "Eduardo Broto", "email": "ebroto@tutanota.com", "date": "2020-06-12T22:52:32Z"}, "committer": {"name": "Eduardo Broto", "email": "ebroto@tutanota.com", "date": "2020-06-12T22:52:32Z"}, "message": "Fix ICE in consts::binop", "tree": {"sha": "431579ce5929b381c38e43574c6d97740958eecf", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/431579ce5929b381c38e43574c6d97740958eecf"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b21ef2b365ef4f5c973327f3f6064b8be42d1dae", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b21ef2b365ef4f5c973327f3f6064b8be42d1dae", "html_url": "https://github.com/rust-lang/rust/commit/b21ef2b365ef4f5c973327f3f6064b8be42d1dae", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b21ef2b365ef4f5c973327f3f6064b8be42d1dae/comments", "author": {"login": "ebroto", "id": 816908, "node_id": "MDQ6VXNlcjgxNjkwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/816908?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebroto", "html_url": "https://github.com/ebroto", "followers_url": "https://api.github.com/users/ebroto/followers", "following_url": "https://api.github.com/users/ebroto/following{/other_user}", "gists_url": "https://api.github.com/users/ebroto/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebroto/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebroto/subscriptions", "organizations_url": "https://api.github.com/users/ebroto/orgs", "repos_url": "https://api.github.com/users/ebroto/repos", "events_url": "https://api.github.com/users/ebroto/events{/privacy}", "received_events_url": "https://api.github.com/users/ebroto/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ebroto", "id": 816908, "node_id": "MDQ6VXNlcjgxNjkwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/816908?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebroto", "html_url": "https://github.com/ebroto", "followers_url": "https://api.github.com/users/ebroto/followers", "following_url": "https://api.github.com/users/ebroto/following{/other_user}", "gists_url": "https://api.github.com/users/ebroto/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebroto/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebroto/subscriptions", "organizations_url": "https://api.github.com/users/ebroto/orgs", "repos_url": "https://api.github.com/users/ebroto/repos", "events_url": "https://api.github.com/users/ebroto/events{/privacy}", "received_events_url": "https://api.github.com/users/ebroto/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f065d4b887e6722d617eacc93d5dcb75e6b32105", "url": "https://api.github.com/repos/rust-lang/rust/commits/f065d4b887e6722d617eacc93d5dcb75e6b32105", "html_url": "https://github.com/rust-lang/rust/commit/f065d4b887e6722d617eacc93d5dcb75e6b32105"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "e3c6908b76b18e3689e578ff63f4bf5f190603eb", "filename": "clippy_lints/src/consts.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b21ef2b365ef4f5c973327f3f6064b8be42d1dae/clippy_lints%2Fsrc%2Fconsts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b21ef2b365ef4f5c973327f3f6064b8be42d1dae/clippy_lints%2Fsrc%2Fconsts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fconsts.rs?ref=b21ef2b365ef4f5c973327f3f6064b8be42d1dae", "patch": "@@ -396,7 +396,7 @@ impl<'c, 'cc> ConstEvalLateContext<'c, 'cc> {\n         let l = self.expr(left)?;\n         let r = self.expr(right);\n         match (l, r) {\n-            (Constant::Int(l), Some(Constant::Int(r))) => match self.tables.expr_ty(left).kind {\n+            (Constant::Int(l), Some(Constant::Int(r))) => match self.tables.expr_ty_opt(left)?.kind {\n                 ty::Int(ity) => {\n                     let l = sext(self.lcx.tcx, l, ity);\n                     let r = sext(self.lcx.tcx, r, ity);"}, {"sha": "de262199004b025dd1dfebd5c16c98a8ed459589", "filename": "tests/ui/crashes/ice-5389.rs", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/b21ef2b365ef4f5c973327f3f6064b8be42d1dae/tests%2Fui%2Fcrashes%2Fice-5389.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b21ef2b365ef4f5c973327f3f6064b8be42d1dae/tests%2Fui%2Fcrashes%2Fice-5389.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcrashes%2Fice-5389.rs?ref=b21ef2b365ef4f5c973327f3f6064b8be42d1dae", "patch": "@@ -0,0 +1,13 @@\n+#![allow(clippy::explicit_counter_loop)]\n+\n+fn main() {\n+    let v = vec![1, 2, 3];\n+    let mut i = 0;\n+    let max_storage_size = [0; 128 * 1024];\n+    for item in &v {\n+        bar(i, *item);\n+        i += 1;\n+    }\n+}\n+\n+fn bar(_: usize, _: u32) {}"}]}