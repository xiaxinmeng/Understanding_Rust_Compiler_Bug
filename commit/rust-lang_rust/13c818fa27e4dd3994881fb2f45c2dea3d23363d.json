{"sha": "13c818fa27e4dd3994881fb2f45c2dea3d23363d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEzYzgxOGZhMjdlNGRkMzk5NDg4MWZiMmY0NWMyZGVhM2QyMzM2M2Q=", "commit": {"author": {"name": "projektir", "email": "oprojektir@gmail.com", "date": "2017-04-12T02:29:42Z"}, "committer": {"name": "projektir", "email": "oprojektir@gmail.com", "date": "2017-04-12T04:19:38Z"}, "message": "Updating docs for std::sync::Weak #29377", "tree": {"sha": "15e9eb56ece33294108cef680e5a0dd9acef489a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/15e9eb56ece33294108cef680e5a0dd9acef489a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/13c818fa27e4dd3994881fb2f45c2dea3d23363d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/13c818fa27e4dd3994881fb2f45c2dea3d23363d", "html_url": "https://github.com/rust-lang/rust/commit/13c818fa27e4dd3994881fb2f45c2dea3d23363d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/13c818fa27e4dd3994881fb2f45c2dea3d23363d/comments", "author": {"login": "projektir", "id": 16269746, "node_id": "MDQ6VXNlcjE2MjY5NzQ2", "avatar_url": "https://avatars.githubusercontent.com/u/16269746?v=4", "gravatar_id": "", "url": "https://api.github.com/users/projektir", "html_url": "https://github.com/projektir", "followers_url": "https://api.github.com/users/projektir/followers", "following_url": "https://api.github.com/users/projektir/following{/other_user}", "gists_url": "https://api.github.com/users/projektir/gists{/gist_id}", "starred_url": "https://api.github.com/users/projektir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/projektir/subscriptions", "organizations_url": "https://api.github.com/users/projektir/orgs", "repos_url": "https://api.github.com/users/projektir/repos", "events_url": "https://api.github.com/users/projektir/events{/privacy}", "received_events_url": "https://api.github.com/users/projektir/received_events", "type": "User", "site_admin": false}, "committer": {"login": "projektir", "id": 16269746, "node_id": "MDQ6VXNlcjE2MjY5NzQ2", "avatar_url": "https://avatars.githubusercontent.com/u/16269746?v=4", "gravatar_id": "", "url": "https://api.github.com/users/projektir", "html_url": "https://github.com/projektir", "followers_url": "https://api.github.com/users/projektir/followers", "following_url": "https://api.github.com/users/projektir/following{/other_user}", "gists_url": "https://api.github.com/users/projektir/gists{/gist_id}", "starred_url": "https://api.github.com/users/projektir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/projektir/subscriptions", "organizations_url": "https://api.github.com/users/projektir/orgs", "repos_url": "https://api.github.com/users/projektir/repos", "events_url": "https://api.github.com/users/projektir/events{/privacy}", "received_events_url": "https://api.github.com/users/projektir/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ad36c2f5528d617db66c244d8bcbfc4b36da0ca0", "url": "https://api.github.com/repos/rust-lang/rust/commits/ad36c2f5528d617db66c244d8bcbfc4b36da0ca0", "html_url": "https://github.com/rust-lang/rust/commit/ad36c2f5528d617db66c244d8bcbfc4b36da0ca0"}], "stats": {"total": 66, "additions": 33, "deletions": 33}, "files": [{"sha": "182a107e3f76915b24151ecda567306c012d42f4", "filename": "src/liballoc/arc.rs", "status": "modified", "additions": 33, "deletions": 33, "changes": 66, "blob_url": "https://github.com/rust-lang/rust/blob/13c818fa27e4dd3994881fb2f45c2dea3d23363d/src%2Fliballoc%2Farc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/13c818fa27e4dd3994881fb2f45c2dea3d23363d/src%2Fliballoc%2Farc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Farc.rs?ref=13c818fa27e4dd3994881fb2f45c2dea3d23363d", "patch": "@@ -165,18 +165,29 @@ unsafe impl<T: ?Sized + Sync + Send> Sync for Arc<T> {}\n #[unstable(feature = \"coerce_unsized\", issue = \"27732\")]\n impl<T: ?Sized + Unsize<U>, U: ?Sized> CoerceUnsized<Arc<U>> for Arc<T> {}\n \n-/// A weak version of [`Arc`][arc].\n+/// `Weak` is a version of [`Arc`] that holds a non-owning reference to the\n+/// managed value. The value is accessed by calling [`upgrade`] on the `Weak`\n+/// pointer, which returns an [`Option`]`<`[`Arc`]`<T>>`.\n ///\n-/// `Weak` pointers do not count towards determining if the inner value\n-/// should be dropped.\n+/// Since a `Weak` reference does not count towards ownership, it will not\n+/// prevent the inner value from being dropped, and `Weak` itself makes no\n+/// guarantees about the value still being present and may return [`None`]\n+/// when [`upgrade`]d.\n ///\n-/// The typical way to obtain a `Weak` pointer is to call\n-/// [`Arc::downgrade`][downgrade].\n+/// A `Weak` pointer is useful for keeping a temporary reference to the value\n+/// within [`Arc`] without extending its lifetime. It is also used to prevent\n+/// circular references between [`Arc`] pointers, since mutual owning references\n+/// would never allow either [`Arc`] to be dropped. For example, a tree could\n+/// have strong [`Arc`] pointers from parent nodes to children, and `Weak`\n+/// pointers from children back to their parents.\n ///\n-/// See the [`Arc`][arc] documentation for more details.\n+/// The typical way to obtain a `Weak` pointer is to call [`Arc::downgrade`].\n ///\n-/// [arc]: struct.Arc.html\n-/// [downgrade]: struct.Arc.html#method.downgrade\n+/// [`Arc`]: struct.Arc.html\n+/// [`Arc::downgrade`]: struct.Arc.html#method.downgrade\n+/// [`upgrade`]: struct.Weak.html#method.upgrade\n+/// [`Option`]: ../../std/option/enum.Option.html\n+/// [`None`]: ../../std/option/enum.Option.html#variant.None\n #[stable(feature = \"arc_weak\", since = \"1.4.0\")]\n pub struct Weak<T: ?Sized> {\n     ptr: Shared<ArcInner<T>>,\n@@ -766,14 +777,11 @@ unsafe impl<#[may_dangle] T: ?Sized> Drop for Arc<T> {\n }\n \n impl<T> Weak<T> {\n-    /// Constructs a new `Weak<T>`, without an accompanying instance of `T`.\n-    ///\n-    /// This allocates memory for `T`, but does not initialize it. Calling\n-    /// [`upgrade`][upgrade] on the return value always gives\n-    /// [`None`][option].\n+    /// Constructs a new `Weak<T>`, allocating memory for `T` without initializing\n+    /// it. Calling [`upgrade`] on the return value always gives [`None`].\n     ///\n-    /// [upgrade]: struct.Weak.html#method.upgrade\n-    /// [option]: ../../std/option/enum.Option.html\n+    /// [`upgrade`]: struct.Weak.html#method.upgrade\n+    /// [`None`]: ../../std/option/enum.Option.html#variant.None\n     ///\n     /// # Examples\n     ///\n@@ -798,13 +806,13 @@ impl<T> Weak<T> {\n }\n \n impl<T: ?Sized> Weak<T> {\n-    /// Upgrades the `Weak` pointer to an [`Arc`][arc], if possible.\n+    /// Attempts to upgrade the `Weak` pointer to an [`Arc`], extending\n+    /// the lifetime of the value if successful.\n     ///\n-    /// Returns [`None`][option] if the strong count has reached zero and the\n-    /// inner value was destroyed.\n+    /// Returns [`None`] if the value has since been dropped.\n     ///\n-    /// [arc]: struct.Arc.html\n-    /// [option]: ../../std/option/enum.Option.html\n+    /// [`Arc`]: struct.Arc.html\n+    /// [`None`]: ../../std/option/enum.Option.html#variant.None\n     ///\n     /// # Examples\n     ///\n@@ -865,10 +873,7 @@ impl<T: ?Sized> Weak<T> {\n \n #[stable(feature = \"arc_weak\", since = \"1.4.0\")]\n impl<T: ?Sized> Clone for Weak<T> {\n-    /// Makes a clone of the `Weak` pointer.\n-    ///\n-    /// This creates another pointer to the same inner value, increasing the\n-    /// weak reference count.\n+    /// Makes a clone of the `Weak` pointer that points to the same value.\n     ///\n     /// # Examples\n     ///\n@@ -900,14 +905,11 @@ impl<T: ?Sized> Clone for Weak<T> {\n \n #[stable(feature = \"downgraded_weak\", since = \"1.10.0\")]\n impl<T> Default for Weak<T> {\n-    /// Constructs a new `Weak<T>`, without an accompanying instance of `T`.\n+    /// Constructs a new `Weak<T>`, allocating memory for `T` without initializing\n+    /// it. Calling [`upgrade`] on the return value always gives [`None`].\n     ///\n-    /// This allocates memory for `T`, but does not initialize it. Calling\n-    /// [`upgrade`][upgrade] on the return value always gives\n-    /// [`None`][option].\n-    ///\n-    /// [upgrade]: struct.Weak.html#method.upgrade\n-    /// [option]: ../../std/option/enum.Option.html\n+    /// [`upgrade`]: struct.Weak.html#method.upgrade\n+    /// [`None`]: ../../std/option/enum.Option.html#variant.None\n     ///\n     /// # Examples\n     ///\n@@ -926,8 +928,6 @@ impl<T> Default for Weak<T> {\n impl<T: ?Sized> Drop for Weak<T> {\n     /// Drops the `Weak` pointer.\n     ///\n-    /// This will decrement the weak reference count.\n-    ///\n     /// # Examples\n     ///\n     /// ```"}]}