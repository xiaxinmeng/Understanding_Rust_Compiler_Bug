{"sha": "1bba58504414c845bd6b24b31c3be2d3f982c511", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFiYmE1ODUwNDQxNGM4NDViZDZiMjRiMzFjM2JlMmQzZjk4MmM1MTE=", "commit": {"author": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-07-06T01:29:18Z"}, "committer": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-07-06T01:29:47Z"}, "message": "stdlib: Implement ivec::foldl", "tree": {"sha": "c8eae6ff53ed0cebc966951bcac168e414845ee6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c8eae6ff53ed0cebc966951bcac168e414845ee6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1bba58504414c845bd6b24b31c3be2d3f982c511", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1bba58504414c845bd6b24b31c3be2d3f982c511", "html_url": "https://github.com/rust-lang/rust/commit/1bba58504414c845bd6b24b31c3be2d3f982c511", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1bba58504414c845bd6b24b31c3be2d3f982c511/comments", "author": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2cb129355b93b8f5d932120a2f002fb59d1344fd", "url": "https://api.github.com/repos/rust-lang/rust/commits/2cb129355b93b8f5d932120a2f002fb59d1344fd", "html_url": "https://github.com/rust-lang/rust/commit/2cb129355b93b8f5d932120a2f002fb59d1344fd"}], "stats": {"total": 23, "additions": 23, "deletions": 0}, "files": [{"sha": "a9a5509dae91ebf3b13a13b747941ca4d0e40dfb", "filename": "src/lib/ivec.rs", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1bba58504414c845bd6b24b31c3be2d3f982c511/src%2Flib%2Fivec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1bba58504414c845bd6b24b31c3be2d3f982c511/src%2Flib%2Fivec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib%2Fivec.rs?ref=1bba58504414c845bd6b24b31c3be2d3f982c511", "patch": "@@ -183,6 +183,14 @@ fn filter_map[T,U](fn(&T)->option::t[U] f, &T[mutable?] v) -> U[] {\n     ret result;\n }\n \n+fn foldl[T,U](fn(&U,&T)->U p, &U z, &T[mutable?] v) -> U {\n+    auto sz = len(v);\n+    if (sz == 0u) { ret z; }\n+    auto first = v.(0);\n+    auto rest = slice(v, 1u, sz);\n+    ret p(foldl[T,U](p, z, rest), first);\n+}\n+\n fn any[T](fn(&T)->bool f, &T[] v) -> bool {\n     for (T elem in v) { if (f(elem)) { ret true; } }\n     ret false;"}, {"sha": "b71a9a545e616d33d2dcc16df3d667af347d8f88", "filename": "src/test/run-pass/lib-ivec.rs", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/1bba58504414c845bd6b24b31c3be2d3f982c511/src%2Ftest%2Frun-pass%2Flib-ivec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1bba58504414c845bd6b24b31c3be2d3f982c511/src%2Ftest%2Frun-pass%2Flib-ivec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Flib-ivec.rs?ref=1bba58504414c845bd6b24b31c3be2d3f982c511", "patch": "@@ -16,6 +16,8 @@ fn square_if_odd(&uint n) -> option::t[uint] {\n     ret if (n % 2u == 1u) { some(n * n) } else { none };\n }\n \n+fn add(&uint x, &uint y) -> uint { ret x + y; }\n+\n fn test_reserve_and_on_heap() {\n     let int[] v = ~[ 1, 2 ];\n     assert (!ivec::on_heap(v));\n@@ -210,6 +212,18 @@ fn test_filter_map() {\n     assert (w.(2) == 25u);\n }\n \n+fn test_foldl() {\n+    // Test on-stack fold.\n+    auto v = ~[ 1u, 2u, 3u ];\n+    auto sum = ivec::foldl(add, 0u, v);\n+    assert (sum == 6u);\n+\n+    // Test on-heap fold.\n+    v = ~[ 1u, 2u, 3u, 4u, 5u ];\n+    sum = ivec::foldl(add, 0u, v);\n+    assert (sum == 15u);\n+}\n+\n fn test_any_and_all() {\n     assert (ivec::any(is_three, ~[ 1u, 2u, 3u ]));\n     assert (!ivec::any(is_three, ~[ 0u, 1u, 2u ]));\n@@ -243,6 +257,7 @@ fn main() {\n     // Functional utilities\n     test_map();\n     test_filter_map();\n+    test_foldl();\n     test_any_and_all();\n }\n "}]}