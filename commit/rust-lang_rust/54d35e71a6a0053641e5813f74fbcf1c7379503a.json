{"sha": "54d35e71a6a0053641e5813f74fbcf1c7379503a", "node_id": "C_kwDOAAsO6NoAKDU0ZDM1ZTcxYTZhMDA1MzY0MWU1ODEzZjc0ZmJjZjFjNzM3OTUwM2E", "commit": {"author": {"name": "Yiming Lei", "email": "yiming.lei@futurewei.com", "date": "2022-07-08T19:42:29Z"}, "committer": {"name": "Yiming Lei", "email": "yiming.lei@futurewei.com", "date": "2022-07-09T00:23:36Z"}, "message": "distinguish the method and associated function diagnostic information\nMethods are defined within the context of a struct and their first parameter is always self\nAssociated functions don\u2019t take self as a parameter\n\tmodified:   compiler/rustc_typeck/src/check/method/suggest.rs\n\tmodified:   src/test/ui/auto-ref-slice-plus-ref.stderr\n\tmodified:   src/test/ui/block-result/issue-3563.stderr\n\tmodified:   src/test/ui/issues/issue-28344.stderr\n\tmodified:   src/test/ui/suggestions/dont-suggest-pin-array-dot-set.stderr\n\tmodified:   src/test/ui/suggestions/suggest-methods.stderr\n\tmodified:   src/test/ui/traits/trait-upcasting/subtrait-method.stderr", "tree": {"sha": "f67c42d21f3e420969da9910b6d43b1990f2d27c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f67c42d21f3e420969da9910b6d43b1990f2d27c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/54d35e71a6a0053641e5813f74fbcf1c7379503a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/54d35e71a6a0053641e5813f74fbcf1c7379503a", "html_url": "https://github.com/rust-lang/rust/commit/54d35e71a6a0053641e5813f74fbcf1c7379503a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/54d35e71a6a0053641e5813f74fbcf1c7379503a/comments", "author": null, "committer": null, "parents": [{"sha": "c461f7a16e8372216dbf7a54ab86ee958bec83b5", "url": "https://api.github.com/repos/rust-lang/rust/commits/c461f7a16e8372216dbf7a54ab86ee958bec83b5", "html_url": "https://github.com/rust-lang/rust/commit/c461f7a16e8372216dbf7a54ab86ee958bec83b5"}], "stats": {"total": 61, "additions": 37, "deletions": 24}, "files": [{"sha": "4b91049355804d4784be4af1b68d0e24173c652c", "filename": "compiler/rustc_typeck/src/check/method/suggest.rs", "status": "modified", "additions": 23, "deletions": 10, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/54d35e71a6a0053641e5813f74fbcf1c7379503a/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fsuggest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54d35e71a6a0053641e5813f74fbcf1c7379503a/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fsuggest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fsuggest.rs?ref=54d35e71a6a0053641e5813f74fbcf1c7379503a", "patch": "@@ -1035,16 +1035,29 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                     // that had unsatisfied trait bounds\n                     if unsatisfied_predicates.is_empty() {\n                         let def_kind = lev_candidate.kind.as_def_kind();\n-                        err.span_suggestion(\n-                            span,\n-                            &format!(\n-                                \"there is {} {} with a similar name\",\n-                                def_kind.article(),\n-                                def_kind.descr(lev_candidate.def_id),\n-                            ),\n-                            lev_candidate.name,\n-                            Applicability::MaybeIncorrect,\n-                        );\n+                        // Methods are defined within the context of a struct and their first parameter is always self,\n+                        // which represents the instance of the struct the method is being called on\n+                        // Associated functions don\u2019t take self as a parameter and\n+                        // they are not methods because they don\u2019t have an instance of the struct to work with.\n+                        if def_kind == DefKind::AssocFn && lev_candidate.fn_has_self_parameter {\n+                            err.span_suggestion(\n+                                span,\n+                                &format!(\"there is a method with a similar name\",),\n+                                lev_candidate.name,\n+                                Applicability::MaybeIncorrect,\n+                            );\n+                        } else {\n+                            err.span_suggestion(\n+                                span,\n+                                &format!(\n+                                    \"there is {} {} with a similar name\",\n+                                    def_kind.article(),\n+                                    def_kind.descr(lev_candidate.def_id),\n+                                ),\n+                                lev_candidate.name,\n+                                Applicability::MaybeIncorrect,\n+                            );\n+                        }\n                     }\n                 }\n "}, {"sha": "e2883050720d662b791326fed5d87e99c6951a68", "filename": "src/test/ui/auto-ref-slice-plus-ref.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/54d35e71a6a0053641e5813f74fbcf1c7379503a/src%2Ftest%2Fui%2Fauto-ref-slice-plus-ref.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/54d35e71a6a0053641e5813f74fbcf1c7379503a/src%2Ftest%2Fui%2Fauto-ref-slice-plus-ref.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fauto-ref-slice-plus-ref.stderr?ref=54d35e71a6a0053641e5813f74fbcf1c7379503a", "patch": "@@ -2,7 +2,7 @@ error[E0599]: no method named `test_mut` found for struct `Vec<{integer}>` in th\n   --> $DIR/auto-ref-slice-plus-ref.rs:7:7\n    |\n LL |     a.test_mut();\n-   |       ^^^^^^^^ help: there is an associated function with a similar name: `get_mut`\n+   |       ^^^^^^^^ help: there is a method with a similar name: `get_mut`\n    |\n    = help: items from traits can only be used if the trait is implemented and in scope\n note: `MyIter` defines an item `test_mut`, perhaps you need to implement it"}, {"sha": "be551f6e889fc63964d44af2f699d84027a373ab", "filename": "src/test/ui/block-result/issue-3563.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/54d35e71a6a0053641e5813f74fbcf1c7379503a/src%2Ftest%2Fui%2Fblock-result%2Fissue-3563.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/54d35e71a6a0053641e5813f74fbcf1c7379503a/src%2Ftest%2Fui%2Fblock-result%2Fissue-3563.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fblock-result%2Fissue-3563.stderr?ref=54d35e71a6a0053641e5813f74fbcf1c7379503a", "patch": "@@ -2,7 +2,7 @@ error[E0599]: no method named `b` found for reference `&Self` in the current sco\n   --> $DIR/issue-3563.rs:3:17\n    |\n LL |         || self.b()\n-   |                 ^ help: there is an associated function with a similar name: `a`\n+   |                 ^ help: there is a method with a similar name: `a`\n \n error: aborting due to previous error\n "}, {"sha": "85a8698afc5a701229c9a9eb0637fb260343a9d6", "filename": "src/test/ui/issues/issue-28344.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/54d35e71a6a0053641e5813f74fbcf1c7379503a/src%2Ftest%2Fui%2Fissues%2Fissue-28344.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/54d35e71a6a0053641e5813f74fbcf1c7379503a/src%2Ftest%2Fui%2Fissues%2Fissue-28344.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-28344.stderr?ref=54d35e71a6a0053641e5813f74fbcf1c7379503a", "patch": "@@ -25,7 +25,7 @@ LL |     let x: u8 = BitXor::bitor(0 as u8, 0 as u8);\n    |                         ^^^^^\n    |                         |\n    |                         function or associated item not found in `dyn BitXor<_>`\n-   |                         help: there is an associated function with a similar name: `bitxor`\n+   |                         help: there is a method with a similar name: `bitxor`\n \n warning: trait objects without an explicit `dyn` are deprecated\n   --> $DIR/issue-28344.rs:10:13\n@@ -53,7 +53,7 @@ LL |     let g = BitXor::bitor;\n    |                     ^^^^^\n    |                     |\n    |                     function or associated item not found in `dyn BitXor<_>`\n-   |                     help: there is an associated function with a similar name: `bitxor`\n+   |                     help: there is a method with a similar name: `bitxor`\n \n error: aborting due to 4 previous errors; 2 warnings emitted\n "}, {"sha": "c66da3ea6d97642b20e78b765d192603c3e7ed3f", "filename": "src/test/ui/suggestions/dont-suggest-pin-array-dot-set.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/54d35e71a6a0053641e5813f74fbcf1c7379503a/src%2Ftest%2Fui%2Fsuggestions%2Fdont-suggest-pin-array-dot-set.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/54d35e71a6a0053641e5813f74fbcf1c7379503a/src%2Ftest%2Fui%2Fsuggestions%2Fdont-suggest-pin-array-dot-set.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsuggestions%2Fdont-suggest-pin-array-dot-set.stderr?ref=54d35e71a6a0053641e5813f74fbcf1c7379503a", "patch": "@@ -2,7 +2,7 @@ error[E0599]: no method named `set` found for array `[u8; 1]` in the current sco\n   --> $DIR/dont-suggest-pin-array-dot-set.rs:14:7\n    |\n LL |     a.set(0, 3);\n-   |       ^^^ help: there is an associated function with a similar name: `get`\n+   |       ^^^ help: there is a method with a similar name: `get`\n \n error: aborting due to previous error\n "}, {"sha": "4277b23fdc12752a36cd295a279883a175e1bed0", "filename": "src/test/ui/suggestions/suggest-methods.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/54d35e71a6a0053641e5813f74fbcf1c7379503a/src%2Ftest%2Fui%2Fsuggestions%2Fsuggest-methods.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/54d35e71a6a0053641e5813f74fbcf1c7379503a/src%2Ftest%2Fui%2Fsuggestions%2Fsuggest-methods.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsuggestions%2Fsuggest-methods.stderr?ref=54d35e71a6a0053641e5813f74fbcf1c7379503a", "patch": "@@ -5,25 +5,25 @@ LL | struct Foo;\n    |        --- method `bat` not found for this struct\n ...\n LL |     f.bat(1.0);\n-   |       ^^^ help: there is an associated function with a similar name: `bar`\n+   |       ^^^ help: there is a method with a similar name: `bar`\n \n error[E0599]: no method named `is_emtpy` found for struct `String` in the current scope\n   --> $DIR/suggest-methods.rs:21:15\n    |\n LL |     let _ = s.is_emtpy();\n-   |               ^^^^^^^^ help: there is an associated function with a similar name: `is_empty`\n+   |               ^^^^^^^^ help: there is a method with a similar name: `is_empty`\n \n error[E0599]: no method named `count_eos` found for type `u32` in the current scope\n   --> $DIR/suggest-methods.rs:25:19\n    |\n LL |     let _ = 63u32.count_eos();\n-   |                   ^^^^^^^^^ help: there is an associated function with a similar name: `count_zeros`\n+   |                   ^^^^^^^^^ help: there is a method with a similar name: `count_zeros`\n \n error[E0599]: no method named `count_o` found for type `u32` in the current scope\n   --> $DIR/suggest-methods.rs:28:19\n    |\n LL |     let _ = 63u32.count_o();\n-   |                   ^^^^^^^ help: there is an associated function with a similar name: `count_ones`\n+   |                   ^^^^^^^ help: there is a method with a similar name: `count_ones`\n \n error: aborting due to 4 previous errors\n "}, {"sha": "af7a410f6d92c205a25cae81e1fd7acdf9f39d21", "filename": "src/test/ui/traits/trait-upcasting/subtrait-method.stderr", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/54d35e71a6a0053641e5813f74fbcf1c7379503a/src%2Ftest%2Fui%2Ftraits%2Ftrait-upcasting%2Fsubtrait-method.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/54d35e71a6a0053641e5813f74fbcf1c7379503a/src%2Ftest%2Fui%2Ftraits%2Ftrait-upcasting%2Fsubtrait-method.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Ftrait-upcasting%2Fsubtrait-method.stderr?ref=54d35e71a6a0053641e5813f74fbcf1c7379503a", "patch": "@@ -2,7 +2,7 @@ error[E0599]: no method named `c` found for reference `&dyn Bar` in the current\n   --> $DIR/subtrait-method.rs:56:9\n    |\n LL |     bar.c();\n-   |         ^ help: there is an associated function with a similar name: `a`\n+   |         ^ help: there is a method with a similar name: `a`\n    |\n    = help: items from traits can only be used if the trait is implemented and in scope\n note: `Baz` defines an item `c`, perhaps you need to implement it\n@@ -15,7 +15,7 @@ error[E0599]: no method named `b` found for reference `&dyn Foo` in the current\n   --> $DIR/subtrait-method.rs:60:9\n    |\n LL |     foo.b();\n-   |         ^ help: there is an associated function with a similar name: `a`\n+   |         ^ help: there is a method with a similar name: `a`\n    |\n    = help: items from traits can only be used if the trait is implemented and in scope\n note: `Bar` defines an item `b`, perhaps you need to implement it\n@@ -28,7 +28,7 @@ error[E0599]: no method named `c` found for reference `&dyn Foo` in the current\n   --> $DIR/subtrait-method.rs:62:9\n    |\n LL |     foo.c();\n-   |         ^ help: there is an associated function with a similar name: `a`\n+   |         ^ help: there is a method with a similar name: `a`\n    |\n    = help: items from traits can only be used if the trait is implemented and in scope\n note: `Baz` defines an item `c`, perhaps you need to implement it\n@@ -41,7 +41,7 @@ error[E0599]: no method named `b` found for reference `&dyn Foo` in the current\n   --> $DIR/subtrait-method.rs:66:9\n    |\n LL |     foo.b();\n-   |         ^ help: there is an associated function with a similar name: `a`\n+   |         ^ help: there is a method with a similar name: `a`\n    |\n    = help: items from traits can only be used if the trait is implemented and in scope\n note: `Bar` defines an item `b`, perhaps you need to implement it\n@@ -54,7 +54,7 @@ error[E0599]: no method named `c` found for reference `&dyn Foo` in the current\n   --> $DIR/subtrait-method.rs:68:9\n    |\n LL |     foo.c();\n-   |         ^ help: there is an associated function with a similar name: `a`\n+   |         ^ help: there is a method with a similar name: `a`\n    |\n    = help: items from traits can only be used if the trait is implemented and in scope\n note: `Baz` defines an item `c`, perhaps you need to implement it"}]}