{"sha": "3c6fc06906472969beffbede0c350044aa56b21b", "node_id": "C_kwDOAAsO6NoAKDNjNmZjMDY5MDY0NzI5NjliZWZmYmVkZTBjMzUwMDQ0YWE1NmIyMWI", "commit": {"author": {"name": "Dylan DPC", "email": "99973273+Dylan-DPC@users.noreply.github.com", "date": "2022-11-19T06:24:46Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-11-19T06:24:46Z"}, "message": "Rollup merge of #104566 - matthiaskrgr:clippy_perf_nov18, r=oli-obk\n\ncouple of clippy::perf fixes", "tree": {"sha": "80601247b3ab12b085d677ff7f72f093d18ff779", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/80601247b3ab12b085d677ff7f72f093d18ff779"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3c6fc06906472969beffbede0c350044aa56b21b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjeHauCRBK7hj4Ov3rIwAA6PYIAHBb4OGAaTi7/vA6QDSHxfUd\nGGs/pJ2qQcXxSPYfD/ixDg5MkzWPvuGWogOK++q17H0OKsXftUj8yB81IiZ4YnTi\nIN+DA2EFVGcT23SbwkCn5vpInmNvqlUZpWPGk3WmRfI9i2TL9gyny2M5196FiHKA\ncXTlqi6GOrMmQAiTLI7o+YTr8vtATogHqCYeAVXbm46pD5zSyZ8hoKslryiHf+dn\nhdUySSsISzGVss+eGshbg7r+Ti9HEuAt4LVMOBa5uJGIdTsDQJNJq2SB7wGjKqXu\nDrJxS6192+lvaznlhqwQ/T3z0Xl+JXEEAhG0/5Off3BA4cMj7MiVLU1zbQrTVIM=\n=w3YW\n-----END PGP SIGNATURE-----\n", "payload": "tree 80601247b3ab12b085d677ff7f72f093d18ff779\nparent 7f35493e9964f8d2e62ac127d2d948b60846109b\nparent e3036df0032bb6726408a9f6705acaf38e55d59f\nauthor Dylan DPC <99973273+Dylan-DPC@users.noreply.github.com> 1668839086 +0530\ncommitter GitHub <noreply@github.com> 1668839086 +0530\n\nRollup merge of #104566 - matthiaskrgr:clippy_perf_nov18, r=oli-obk\n\ncouple of clippy::perf fixes\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3c6fc06906472969beffbede0c350044aa56b21b", "html_url": "https://github.com/rust-lang/rust/commit/3c6fc06906472969beffbede0c350044aa56b21b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3c6fc06906472969beffbede0c350044aa56b21b/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7f35493e9964f8d2e62ac127d2d948b60846109b", "url": "https://api.github.com/repos/rust-lang/rust/commits/7f35493e9964f8d2e62ac127d2d948b60846109b", "html_url": "https://github.com/rust-lang/rust/commit/7f35493e9964f8d2e62ac127d2d948b60846109b"}, {"sha": "e3036df0032bb6726408a9f6705acaf38e55d59f", "url": "https://api.github.com/repos/rust-lang/rust/commits/e3036df0032bb6726408a9f6705acaf38e55d59f", "html_url": "https://github.com/rust-lang/rust/commit/e3036df0032bb6726408a9f6705acaf38e55d59f"}], "stats": {"total": 30, "additions": 14, "deletions": 16}, "files": [{"sha": "04fe6c4007e948fd106f14fb95947ae1003e3090", "filename": "compiler/rustc_expand/src/base.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_expand%2Fsrc%2Fbase.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_expand%2Fsrc%2Fbase.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_expand%2Fsrc%2Fbase.rs?ref=3c6fc06906472969beffbede0c350044aa56b21b", "patch": "@@ -1436,7 +1436,7 @@ fn pretty_printing_compatibility_hack(item: &Item, sess: &ParseSess) -> bool {\n                             let crate_matches = if c.starts_with(\"allsorts-rental\") {\n                                 true\n                             } else {\n-                                let mut version = c.trim_start_matches(\"rental-\").split(\".\");\n+                                let mut version = c.trim_start_matches(\"rental-\").split('.');\n                                 version.next() == Some(\"0\")\n                                     && version.next() == Some(\"5\")\n                                     && version"}, {"sha": "cdf279313a6726e0985cdd0d51c45d11576c7618", "filename": "compiler/rustc_lint/src/unused.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_lint%2Fsrc%2Funused.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_lint%2Fsrc%2Funused.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Funused.rs?ref=3c6fc06906472969beffbede0c350044aa56b21b", "patch": "@@ -582,15 +582,15 @@ trait UnusedDelimLint {\n                 let sm = cx.sess().source_map();\n                 let lo_replace =\n                     if keep_space.0 &&\n-                        let Ok(snip) = sm.span_to_prev_source(lo) && !snip.ends_with(\" \") {\n+                        let Ok(snip) = sm.span_to_prev_source(lo) && !snip.ends_with(' ') {\n                         \" \".to_string()\n                         } else {\n                             \"\".to_string()\n                         };\n \n                 let hi_replace =\n                     if keep_space.1 &&\n-                        let Ok(snip) = sm.span_to_next_source(hi) && !snip.starts_with(\" \") {\n+                        let Ok(snip) = sm.span_to_next_source(hi) && !snip.starts_with(' ') {\n                         \" \".to_string()\n                         } else {\n                             \"\".to_string()"}, {"sha": "dff088b9bdfa66140867a8cc88f7e400a6c29961", "filename": "compiler/rustc_macros/src/diagnostics/utils.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_macros%2Fsrc%2Fdiagnostics%2Futils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_macros%2Fsrc%2Fdiagnostics%2Futils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_macros%2Fsrc%2Fdiagnostics%2Futils.rs?ref=3c6fc06906472969beffbede0c350044aa56b21b", "patch": "@@ -830,5 +830,5 @@ pub(super) fn should_generate_set_arg(field: &Field) -> bool {\n }\n \n pub(super) fn is_doc_comment(attr: &Attribute) -> bool {\n-    attr.path.segments.last().unwrap().ident.to_string() == \"doc\"\n+    attr.path.segments.last().unwrap().ident == \"doc\"\n }"}, {"sha": "93d6850560d7cbeb996261db2b5e19ffb7c427b7", "filename": "compiler/rustc_middle/src/ty/print/pretty.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_middle%2Fsrc%2Fty%2Fprint%2Fpretty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_middle%2Fsrc%2Fty%2Fprint%2Fpretty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Fprint%2Fpretty.rs?ref=3c6fc06906472969beffbede0c350044aa56b21b", "patch": "@@ -2194,11 +2194,9 @@ impl<'tcx> FmtPrinter<'_, 'tcx> {\n \n         define_scoped_cx!(self);\n \n-        let possible_names =\n-            ('a'..='z').rev().map(|s| Symbol::intern(&format!(\"'{s}\"))).collect::<Vec<_>>();\n+        let possible_names = ('a'..='z').rev().map(|s| Symbol::intern(&format!(\"'{s}\")));\n \n         let mut available_names = possible_names\n-            .into_iter()\n             .filter(|name| !self.used_region_names.contains(&name))\n             .collect::<Vec<_>>();\n         debug!(?available_names);"}, {"sha": "cc69a1bb02db19cac318ec2c149bd18d7dcfc9bf", "filename": "compiler/rustc_mir_dataflow/src/value_analysis.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_mir_dataflow%2Fsrc%2Fvalue_analysis.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_mir_dataflow%2Fsrc%2Fvalue_analysis.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_dataflow%2Fsrc%2Fvalue_analysis.rs?ref=3c6fc06906472969beffbede0c350044aa56b21b", "patch": "@@ -899,7 +899,7 @@ fn debug_with_context_rec<V: Debug + Eq>(\n         let info_elem = map.places[child].proj_elem.unwrap();\n         let child_place_str = match info_elem {\n             TrackElem::Field(field) => {\n-                if place_str.starts_with(\"*\") {\n+                if place_str.starts_with('*') {\n                     format!(\"({}).{}\", place_str, field.index())\n                 } else {\n                     format!(\"{}.{}\", place_str, field.index())"}, {"sha": "2558ac801addd18c6a3a492db233d7245292787f", "filename": "compiler/rustc_parse/src/parser/diagnostics.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fdiagnostics.rs?ref=3c6fc06906472969beffbede0c350044aa56b21b", "patch": "@@ -1660,14 +1660,14 @@ impl<'a> Parser<'a> {\n                 let left = begin_par_sp;\n                 let right = self.prev_token.span;\n                 let left_snippet = if let Ok(snip) = sm.span_to_prev_source(left) &&\n-                        !snip.ends_with(\" \") {\n+                        !snip.ends_with(' ') {\n                                 \" \".to_string()\n                             } else {\n                                 \"\".to_string()\n                             };\n \n                 let right_snippet = if let Ok(snip) = sm.span_to_next_source(right) &&\n-                        !snip.starts_with(\" \") {\n+                        !snip.starts_with(' ') {\n                                 \" \".to_string()\n                             } else {\n                                 \"\".to_string()"}, {"sha": "acb9bd8e78a4a57077e348f4e369eabd910f9730", "filename": "compiler/rustc_passes/src/check_attr.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_passes%2Fsrc%2Fcheck_attr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_passes%2Fsrc%2Fcheck_attr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Fcheck_attr.rs?ref=3c6fc06906472969beffbede0c350044aa56b21b", "patch": "@@ -353,7 +353,7 @@ impl CheckAttrVisitor<'_> {\n                 attr.span,\n                 OnlyHasEffectOn {\n                     attr_name: attr.name_or_empty(),\n-                    target_name: allowed_target.name().replace(\" \", \"_\"),\n+                    target_name: allowed_target.name().replace(' ', \"_\"),\n                 },\n             );\n         }"}, {"sha": "5d0224c35f3645a8716d2820e8d8a4f0f49914e9", "filename": "compiler/rustc_passes/src/dead.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_passes%2Fsrc%2Fdead.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c6fc06906472969beffbede0c350044aa56b21b/compiler%2Frustc_passes%2Fsrc%2Fdead.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Fdead.rs?ref=3c6fc06906472969beffbede0c350044aa56b21b", "patch": "@@ -772,7 +772,7 @@ impl<'tcx> DeadVisitor<'tcx> {\n         self.tcx.emit_spanned_lint(\n             lint,\n             tcx.hir().local_def_id_to_hir_id(first_id),\n-            MultiSpan::from_spans(spans.clone()),\n+            MultiSpan::from_spans(spans),\n             diag,\n         );\n     }"}, {"sha": "e0cdb86d9d1dc152e47f97f85e5ea4456ed0f2ea", "filename": "src/librustdoc/config.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3c6fc06906472969beffbede0c350044aa56b21b/src%2Flibrustdoc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c6fc06906472969beffbede0c350044aa56b21b/src%2Flibrustdoc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fconfig.rs?ref=3c6fc06906472969beffbede0c350044aa56b21b", "patch": "@@ -418,7 +418,7 @@ impl Options {\n             ) {\n                 Ok(p) => p,\n                 Err(e) => {\n-                    diag.struct_err(&e.to_string()).emit();\n+                    diag.struct_err(e).emit();\n                     return Err(1);\n                 }\n             };\n@@ -561,7 +561,7 @@ impl Options {\n             ) {\n                 Ok(p) => p,\n                 Err(e) => {\n-                    diag.struct_err(&e.to_string()).emit();\n+                    diag.struct_err(e).emit();\n                     return Err(1);\n                 }\n             };"}, {"sha": "1f87f95563ad550d789ec580f3d4eff64fcb71ce", "filename": "src/librustdoc/html/static_files.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3c6fc06906472969beffbede0c350044aa56b21b/src%2Flibrustdoc%2Fhtml%2Fstatic_files.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c6fc06906472969beffbede0c350044aa56b21b/src%2Flibrustdoc%2Fhtml%2Fstatic_files.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic_files.rs?ref=3c6fc06906472969beffbede0c350044aa56b21b", "patch": "@@ -58,7 +58,7 @@ pub(crate) fn suffix_path(filename: &str, suffix: &str) -> PathBuf {\n }\n \n pub(crate) fn static_filename(filename: &str, contents: &[u8]) -> PathBuf {\n-    let filename = filename.rsplit(\"/\").next().unwrap();\n+    let filename = filename.rsplit('/').next().unwrap();\n     suffix_path(filename, &static_suffix(contents))\n }\n "}, {"sha": "cfba7d583b138633d8ad151badc188f60a1784b0", "filename": "src/tools/miropt-test-tools/src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3c6fc06906472969beffbede0c350044aa56b21b/src%2Ftools%2Fmiropt-test-tools%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c6fc06906472969beffbede0c350044aa56b21b/src%2Ftools%2Fmiropt-test-tools%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiropt-test-tools%2Fsrc%2Flib.rs?ref=3c6fc06906472969beffbede0c350044aa56b21b", "patch": "@@ -11,7 +11,7 @@ pub fn files_for_miropt_test(testfile: &std::path::Path, bit_width: u32) -> Vec<\n     let test_file_contents = fs::read_to_string(&testfile).unwrap();\n \n     let test_dir = testfile.parent().unwrap();\n-    let test_crate = testfile.file_stem().unwrap().to_str().unwrap().replace(\"-\", \"_\");\n+    let test_crate = testfile.file_stem().unwrap().to_str().unwrap().replace('-', \"_\");\n \n     let bit_width = if test_file_contents.lines().any(|l| l == \"// EMIT_MIR_FOR_EACH_BIT_WIDTH\") {\n         format!(\".{}bit\", bit_width)"}]}