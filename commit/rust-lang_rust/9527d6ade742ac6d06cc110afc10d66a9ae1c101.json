{"sha": "9527d6ade742ac6d06cc110afc10d66a9ae1c101", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk1MjdkNmFkZTc0MmFjNmQwNmNjMTEwYWZjMTBkNjZhOWFlMWMxMDE=", "commit": {"author": {"name": "David Wood", "email": "david@davidtw.co", "date": "2018-07-12T19:14:13Z"}, "committer": {"name": "David Wood", "email": "david@davidtw.co", "date": "2018-07-12T19:21:45Z"}, "message": "Moved non_exhaustive message to fields/variants section and onto type.", "tree": {"sha": "8c1be2f8bb9046d83e652a2b960a70e132420fa5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8c1be2f8bb9046d83e652a2b960a70e132420fa5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9527d6ade742ac6d06cc110afc10d66a9ae1c101", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEWwgxPGhT5b/6kagXAXYLT59T8VQFAltHqkkACgkQAXYLT59T\n8VTN1A//aMv5NS+amRfz8zE28NyfcrYyqt89Y6L2VA1cfXsLbYwCL+j7rDOclLEt\nn8pcPEHZvlxiNTT7YzvKdpz+tYqkCQHU1SpxuPNQbNQcM952e6oJ2meECPCHzdR/\nQ3oyjbnRZ7TTpu6Kf3J3b9J/FTRwfIyra9ABr7CHP5KOJKlpyRBXnyHT7I4LnyzN\nZEe12ScwN1CCe/M15zAJ0FodW8e22yBnBWzsv96sCIzckwGRPYeLXTaxwSVBUVDc\nIRQaBlfqY5hMSxgzEAMHIbXA1HTqrt7DProBscqMbHYUKvMH4qllHbOEFCxhiw3u\nNpWgHGBQLa7V8xYK1c68tCirnvn+HIVZ98RxuhJSOlS0Ts0OnMrk6+bf1zaUOVi9\nlmQpYtzwdoEpB65q3JdMuNGIpQLJiW+yTQyMTuxrbJEFzk7MEH5q4EatHueW1f8P\nHT8mvm0cSihBlZnCj9RwhEmD5RLN/chwHIkP0FJ2fJ9WQXqJPSghGYIrtgjy0B23\nxPXEpeKYlzC1S3X4HvEOA7YXJHTzw/ouCjq2t99LEoQoTbmSsAahOVlGUlIWWOyF\ndZEzesudPvxJ+UcCoGh47TSR2gXBchtkQDTUSb/1t2g2vtVcaipLSgXRJxZQYGu8\nAGeFVWT0DuN2h3q9DRTgnstTBPEt+/CvMoZNqB1iTEiP2vLPMOQ=\n=IJMH\n-----END PGP SIGNATURE-----", "payload": "tree 8c1be2f8bb9046d83e652a2b960a70e132420fa5\nparent 5ccafa106fe1972158ce5c4dcd36e92df7c2be74\nauthor David Wood <david@davidtw.co> 1531422853 +0100\ncommitter David Wood <david@davidtw.co> 1531423305 +0100\n\nMoved non_exhaustive message to fields/variants section and onto type.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9527d6ade742ac6d06cc110afc10d66a9ae1c101", "html_url": "https://github.com/rust-lang/rust/commit/9527d6ade742ac6d06cc110afc10d66a9ae1c101", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9527d6ade742ac6d06cc110afc10d66a9ae1c101/comments", "author": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5ccafa106fe1972158ce5c4dcd36e92df7c2be74", "url": "https://api.github.com/repos/rust-lang/rust/commits/5ccafa106fe1972158ce5c4dcd36e92df7c2be74", "html_url": "https://github.com/rust-lang/rust/commit/5ccafa106fe1972158ce5c4dcd36e92df7c2be74"}], "stats": {"total": 37, "additions": 18, "deletions": 19}, "files": [{"sha": "c344302cabf598cff0a740e223b3b3918a11ac83", "filename": "src/librustdoc/html/render.rs", "status": "modified", "additions": 14, "deletions": 17, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/9527d6ade742ac6d06cc110afc10d66a9ae1c101/src%2Flibrustdoc%2Fhtml%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9527d6ade742ac6d06cc110afc10d66a9ae1c101/src%2Flibrustdoc%2Fhtml%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender.rs?ref=9527d6ade742ac6d06cc110afc10d66a9ae1c101", "patch": "@@ -2194,7 +2194,6 @@ fn document(w: &mut fmt::Formatter, cx: &Context, item: &clean::Item) -> fmt::Re\n         info!(\"Documenting {}\", name);\n     }\n     document_stability(w, cx, item)?;\n-    document_non_exhaustive(w, item)?;\n     let prefix = render_assoc_const_value(item);\n     document_full(w, item, cx, &prefix)?;\n     Ok(())\n@@ -2263,20 +2262,13 @@ fn document_stability(w: &mut fmt::Formatter, cx: &Context, item: &clean::Item)\n     Ok(())\n }\n \n+fn document_non_exhaustive_header(item: &clean::Item) -> &str {\n+    if item.is_non_exhaustive() { \" (Non-exhaustive)\" } else { \"\" }\n+}\n+\n fn document_non_exhaustive(w: &mut fmt::Formatter, item: &clean::Item) -> fmt::Result {\n     if item.is_non_exhaustive() {\n-        write!(w, \"<div class='non-exhaustive'><div class='stab non-exhaustive'>\")?;\n-        write!(w, \"<details><summary><span class=microscope>\ud83d\udd2c</span>\")?;\n-\n-        if item.is_struct() {\n-            write!(w, \"This struct is marked as non exhaustive.\")?;\n-        } else if item.is_enum() {\n-            write!(w, \"This enum is marked as non exhaustive.\")?;\n-        } else {\n-            write!(w, \"This type is marked as non exhaustive.\")?;\n-        }\n-\n-        write!(w, \"</summary><p>\")?;\n+        write!(w, \"<p class='non-exhaustive'>\")?;\n \n         if item.is_struct() {\n             write!(w, \"This struct is marked as non-exhaustive as additional fields may be \\\n@@ -2293,7 +2285,7 @@ fn document_non_exhaustive(w: &mut fmt::Formatter, item: &clean::Item) -> fmt::R\n                        constructors.\")?;\n         }\n \n-        write!(w, \"</p></details></div></div>\")?;\n+        write!(w, \"</p>\")?;\n     }\n \n     Ok(())\n@@ -3159,7 +3151,9 @@ fn item_struct(w: &mut fmt::Formatter, cx: &Context, it: &clean::Item,\n     if let doctree::Plain = s.struct_type {\n         if fields.peek().is_some() {\n             write!(w, \"<h2 id='fields' class='fields small-section-header'>\n-                       Fields<a href='#fields' class='anchor'></a></h2>\")?;\n+                       Fields{}<a href='#fields' class='anchor'></a></h2>\",\n+                       document_non_exhaustive_header(it))?;\n+            document_non_exhaustive(w, it)?;\n             for (field, ty) in fields {\n                 let id = derive_id(format!(\"{}.{}\",\n                                            ItemType::StructField,\n@@ -3291,7 +3285,9 @@ fn item_enum(w: &mut fmt::Formatter, cx: &Context, it: &clean::Item,\n     document(w, cx, it)?;\n     if !e.variants.is_empty() {\n         write!(w, \"<h2 id='variants' class='variants small-section-header'>\n-                   Variants<a href='#variants' class='anchor'></a></h2>\\n\")?;\n+                   Variants{}<a href='#variants' class='anchor'></a></h2>\\n\",\n+                   document_non_exhaustive_header(it))?;\n+        document_non_exhaustive(w, it)?;\n         for variant in &e.variants {\n             let id = derive_id(format!(\"{}.{}\",\n                                        ItemType::Variant,\n@@ -3392,7 +3388,8 @@ const ATTRIBUTE_WHITELIST: &'static [&'static str] = &[\n     \"must_use\",\n     \"no_mangle\",\n     \"repr\",\n-    \"unsafe_destructor_blind_to_params\"\n+    \"unsafe_destructor_blind_to_params\",\n+    \"non_exhaustive\"\n ];\n \n fn render_attributes(w: &mut fmt::Formatter, it: &clean::Item) -> fmt::Result {"}, {"sha": "f97ff45b22f7a715d45b3c8b25840002773582cc", "filename": "src/librustdoc/html/static/themes/dark.css", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9527d6ade742ac6d06cc110afc10d66a9ae1c101/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/9527d6ade742ac6d06cc110afc10d66a9ae1c101/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Fdark.css?ref=9527d6ade742ac6d06cc110afc10d66a9ae1c101", "patch": "@@ -148,6 +148,8 @@ pre {\n .content .fnname{ color: #2BAB63; }\n .content span.keyword, .content a.keyword, .block a.current.keyword { color: #de5249; }\n \n+.non-exhaustive { color: #DDD; margin-bottom: 1em; }\n+\n pre.rust .comment { color: #8d8d8b; }\n pre.rust .doccomment { color: #8ca375; }\n \n@@ -188,7 +190,6 @@ a.test-arrow {\n \tborder-color: #008dfd;\n }\n \n-.stab.non-exhaustive { background: #2a2a2a; border-color: #707070; }\n .stab.unstable { background: #FFF5D6; border-color: #FFC600; color: #404040; }\n .stab.deprecated { background: #F3DFFF; border-color: #7F0087;  color: #404040; }\n .stab.portability { background: #C4ECFF; border-color: #7BA5DB;  color: #404040; }"}, {"sha": "da8b24f3b171f45e37803952399255cd6cef276b", "filename": "src/librustdoc/html/static/themes/light.css", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9527d6ade742ac6d06cc110afc10d66a9ae1c101/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/9527d6ade742ac6d06cc110afc10d66a9ae1c101/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Flight.css?ref=9527d6ade742ac6d06cc110afc10d66a9ae1c101", "patch": "@@ -148,6 +148,8 @@ pre {\n .content .fnname { color: #9a6e31; }\n .content span.keyword, .content a.keyword, .block a.current.keyword { color: #de5249; }\n \n+.non-exhaustive { color: #222; margin-bottom: 1em; }\n+\n pre.rust .comment { color: #8E908C; }\n pre.rust .doccomment { color: #4D4D4C; }\n \n@@ -188,7 +190,6 @@ a.test-arrow {\n \tborder-color: #66afe9;\n }\n \n-.stab.non-exhaustive { background: #F5F5F5; border-color: #D3D3D3; }\n .stab.unstable { background: #FFF5D6; border-color: #FFC600; }\n .stab.deprecated { background: #F3DFFF; border-color: #7F0087; }\n .stab.portability { background: #C4ECFF; border-color: #7BA5DB; }"}]}