{"sha": "027f19c8b911458722511be4ffc469f505766ffa", "node_id": "C_kwDOAAsO6NoAKDAyN2YxOWM4YjkxMTQ1ODcyMjUxMWJlNGZmYzQ2OWY1MDU3NjZmZmE", "commit": {"author": {"name": "Takayuki Nakata", "email": "f.seasons017@gmail.com", "date": "2023-03-03T13:41:39Z"}, "committer": {"name": "Takayuki Nakata", "email": "f.seasons017@gmail.com", "date": "2023-03-03T13:41:39Z"}, "message": "Fix FP for `let_unit_value` when `await` used", "tree": {"sha": "b775a7507a45627696d60274085aeaf43757130c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b775a7507a45627696d60274085aeaf43757130c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/027f19c8b911458722511be4ffc469f505766ffa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/027f19c8b911458722511be4ffc469f505766ffa", "html_url": "https://github.com/rust-lang/rust/commit/027f19c8b911458722511be4ffc469f505766ffa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/027f19c8b911458722511be4ffc469f505766ffa/comments", "author": {"login": "giraffate", "id": 17407489, "node_id": "MDQ6VXNlcjE3NDA3NDg5", "avatar_url": "https://avatars.githubusercontent.com/u/17407489?v=4", "gravatar_id": "", "url": "https://api.github.com/users/giraffate", "html_url": "https://github.com/giraffate", "followers_url": "https://api.github.com/users/giraffate/followers", "following_url": "https://api.github.com/users/giraffate/following{/other_user}", "gists_url": "https://api.github.com/users/giraffate/gists{/gist_id}", "starred_url": "https://api.github.com/users/giraffate/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/giraffate/subscriptions", "organizations_url": "https://api.github.com/users/giraffate/orgs", "repos_url": "https://api.github.com/users/giraffate/repos", "events_url": "https://api.github.com/users/giraffate/events{/privacy}", "received_events_url": "https://api.github.com/users/giraffate/received_events", "type": "User", "site_admin": false}, "committer": {"login": "giraffate", "id": 17407489, "node_id": "MDQ6VXNlcjE3NDA3NDg5", "avatar_url": "https://avatars.githubusercontent.com/u/17407489?v=4", "gravatar_id": "", "url": "https://api.github.com/users/giraffate", "html_url": "https://github.com/giraffate", "followers_url": "https://api.github.com/users/giraffate/followers", "following_url": "https://api.github.com/users/giraffate/following{/other_user}", "gists_url": "https://api.github.com/users/giraffate/gists{/gist_id}", "starred_url": "https://api.github.com/users/giraffate/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/giraffate/subscriptions", "organizations_url": "https://api.github.com/users/giraffate/orgs", "repos_url": "https://api.github.com/users/giraffate/repos", "events_url": "https://api.github.com/users/giraffate/events{/privacy}", "received_events_url": "https://api.github.com/users/giraffate/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8b65632b6ef737979d42f83664271d6baa8c0270", "url": "https://api.github.com/repos/rust-lang/rust/commits/8b65632b6ef737979d42f83664271d6baa8c0270", "html_url": "https://github.com/rust-lang/rust/commit/8b65632b6ef737979d42f83664271d6baa8c0270"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "3430b6e373418dedc8bc13d32dc36311bc2461a0", "filename": "clippy_lints/src/unit_types/let_unit_value.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/027f19c8b911458722511be4ffc469f505766ffa/clippy_lints%2Fsrc%2Funit_types%2Flet_unit_value.rs", "raw_url": "https://github.com/rust-lang/rust/raw/027f19c8b911458722511be4ffc469f505766ffa/clippy_lints%2Fsrc%2Funit_types%2Flet_unit_value.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Funit_types%2Flet_unit_value.rs?ref=027f19c8b911458722511be4ffc469f505766ffa", "patch": "@@ -5,7 +5,7 @@ use clippy_utils::visitors::{for_each_local_assignment, for_each_value_source};\n use core::ops::ControlFlow;\n use rustc_errors::Applicability;\n use rustc_hir::def::{DefKind, Res};\n-use rustc_hir::{Expr, ExprKind, HirId, HirIdSet, Local, Node, PatKind, QPath, TyKind};\n+use rustc_hir::{Expr, ExprKind, HirId, HirIdSet, Local, MatchSource, Node, PatKind, QPath, TyKind};\n use rustc_lint::{LateContext, LintContext};\n use rustc_middle::lint::in_external_macro;\n use rustc_middle::ty;\n@@ -41,6 +41,10 @@ pub(super) fn check<'tcx>(cx: &LateContext<'tcx>, local: &'tcx Local<'_>) {\n                 );\n             }\n         } else {\n+            if let ExprKind::Match(_, _, MatchSource::AwaitDesugar) = init.kind {\n+                return\n+            }\n+\n             span_lint_and_then(\n                 cx,\n                 LET_UNIT_VALUE,"}, {"sha": "76ff0645f4177d8b33cbf3629e5a00e439c08eec", "filename": "tests/ui/let_unit.fixed", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/027f19c8b911458722511be4ffc469f505766ffa/tests%2Fui%2Flet_unit.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/027f19c8b911458722511be4ffc469f505766ffa/tests%2Fui%2Flet_unit.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flet_unit.fixed?ref=027f19c8b911458722511be4ffc469f505766ffa", "patch": "@@ -175,3 +175,7 @@ fn attributes() {\n     #[expect(clippy::let_unit_value)]\n     let _ = f();\n }\n+\n+async fn issue10433() {\n+    let _pending: () = std::future::pending().await;\n+}"}, {"sha": "895ccfe366a2d2d3a3e272bfb9aab2bded6b904e", "filename": "tests/ui/let_unit.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/027f19c8b911458722511be4ffc469f505766ffa/tests%2Fui%2Flet_unit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/027f19c8b911458722511be4ffc469f505766ffa/tests%2Fui%2Flet_unit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flet_unit.rs?ref=027f19c8b911458722511be4ffc469f505766ffa", "patch": "@@ -175,3 +175,7 @@ fn attributes() {\n     #[expect(clippy::let_unit_value)]\n     let _ = f();\n }\n+\n+async fn issue10433() {\n+    let _pending: () = std::future::pending().await;\n+}"}]}