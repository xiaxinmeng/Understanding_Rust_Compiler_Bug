{"sha": "2b26b8b32bb2246caa0a82b6ea16f11da3686d0e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJiMjZiOGIzMmJiMjI0NmNhYTBhODJiNmVhMTZmMTFkYTM2ODZkMGU=", "commit": {"author": {"name": "Jonathan Schwender", "email": "schwenderjonathan@gmail.com", "date": "2020-05-26T13:16:57Z"}, "committer": {"name": "Jonathan Schwender", "email": "schwenderjonathan@gmail.com", "date": "2020-05-26T13:43:19Z"}, "message": "Fix documentation example for gcov profiling\n\nIncremental compilation needs to be turned off. Also added the other RUSTFLAGS that should/need to be turned on.", "tree": {"sha": "c2042564a4d4d04bfba84c438414ed2b8e1b3820", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c2042564a4d4d04bfba84c438414ed2b8e1b3820"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2b26b8b32bb2246caa0a82b6ea16f11da3686d0e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEET02/mD9Y7iMa76F2AJoKzGAWgRMFAl7NHPcACgkQAJoKzGAW\ngRNdiw//dnwUrA6OpFEIICFXf9hrpu8TLyWtjjHIFK56WirfNS1Iek/GQe43Yzai\nRb1UU4t8wvUBaZ7qqt6YQZ8Iymdn3B1uQzkXG/QeNfZH6Q2/8ONxCUj/sWxgq9JH\nhBJ+8JKWN43BFt6dP2zcR2zakpOTufsb3arbBOcLRiHUho6wGcxn/ttBQk0zomtV\n9iXbZk1s9rWNe9o/ZQ2u66OuH7WpuEhRn543qyICXke5EbXA57zIkrhRyDxo+Zbx\nxuE6EKy9c7xRUHwgW6ECATTc33UGnussX+yzDQJk6xdAVqQKNuFznOfm5okmAPXd\n9Ba/T615kAFQcivsRBuQTdPKAadyK+8fhUqAiBb3T7Q0OuCEGhtQVhnCEnxV/OgC\nI2QE26mk6xCzJsiPiubgmzBjhCnTRvAzBwCZ3N6vIp7+yib6ee9O3B8mYakjjRL0\n8oMkAbpoV7ebKOAleLLpne/qcH0MNTpsc8GMwSqoKFgYX4aTaOTWPT/EV0uEJhLv\n10j87QI/yAfaLWzNN09DohcmNj0kCX1vNogF1pNn+4WQsvZcUBj20eX7BOuCYw16\nbGmg2hCthFSq8ZAXEQUUfGlK24SHnuEQhPBG/mcUWBgIqNZfBi7Q/lz+nPJw004K\nSSBhPU8YiuvigL8VtN05Utv206V53EJ0S8eNXEpe36LOpDZBYTE=\n=zV57\n-----END PGP SIGNATURE-----", "payload": "tree c2042564a4d4d04bfba84c438414ed2b8e1b3820\nparent 62da38d00d8d09dbaaa092c7b5e7ea343fdc2126\nauthor Jonathan Schwender <schwenderjonathan@gmail.com> 1590499017 +0200\ncommitter Jonathan Schwender <schwenderjonathan@gmail.com> 1590500599 +0200\n\nFix documentation example for gcov profiling\n\nIncremental compilation needs to be turned off. Also added the other RUSTFLAGS that should/need to be turned on.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2b26b8b32bb2246caa0a82b6ea16f11da3686d0e", "html_url": "https://github.com/rust-lang/rust/commit/2b26b8b32bb2246caa0a82b6ea16f11da3686d0e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2b26b8b32bb2246caa0a82b6ea16f11da3686d0e/comments", "author": {"login": "jschwe", "id": 55576758, "node_id": "MDQ6VXNlcjU1NTc2NzU4", "avatar_url": "https://avatars.githubusercontent.com/u/55576758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jschwe", "html_url": "https://github.com/jschwe", "followers_url": "https://api.github.com/users/jschwe/followers", "following_url": "https://api.github.com/users/jschwe/following{/other_user}", "gists_url": "https://api.github.com/users/jschwe/gists{/gist_id}", "starred_url": "https://api.github.com/users/jschwe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jschwe/subscriptions", "organizations_url": "https://api.github.com/users/jschwe/orgs", "repos_url": "https://api.github.com/users/jschwe/repos", "events_url": "https://api.github.com/users/jschwe/events{/privacy}", "received_events_url": "https://api.github.com/users/jschwe/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jschwe", "id": 55576758, "node_id": "MDQ6VXNlcjU1NTc2NzU4", "avatar_url": "https://avatars.githubusercontent.com/u/55576758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jschwe", "html_url": "https://github.com/jschwe", "followers_url": "https://api.github.com/users/jschwe/followers", "following_url": "https://api.github.com/users/jschwe/following{/other_user}", "gists_url": "https://api.github.com/users/jschwe/gists{/gist_id}", "starred_url": "https://api.github.com/users/jschwe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jschwe/subscriptions", "organizations_url": "https://api.github.com/users/jschwe/orgs", "repos_url": "https://api.github.com/users/jschwe/repos", "events_url": "https://api.github.com/users/jschwe/events{/privacy}", "received_events_url": "https://api.github.com/users/jschwe/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "62da38d00d8d09dbaaa092c7b5e7ea343fdc2126", "url": "https://api.github.com/repos/rust-lang/rust/commits/62da38d00d8d09dbaaa092c7b5e7ea343fdc2126", "html_url": "https://github.com/rust-lang/rust/commit/62da38d00d8d09dbaaa092c7b5e7ea343fdc2126"}], "stats": {"total": 7, "additions": 6, "deletions": 1}, "files": [{"sha": "b3b3e4eb4058f1c65e6723958e6e46857b09f259", "filename": "src/doc/unstable-book/src/compiler-flags/profile.md", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/2b26b8b32bb2246caa0a82b6ea16f11da3686d0e/src%2Fdoc%2Funstable-book%2Fsrc%2Fcompiler-flags%2Fprofile.md", "raw_url": "https://github.com/rust-lang/rust/raw/2b26b8b32bb2246caa0a82b6ea16f11da3686d0e/src%2Fdoc%2Funstable-book%2Fsrc%2Fcompiler-flags%2Fprofile.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Fcompiler-flags%2Fprofile.md?ref=2b26b8b32bb2246caa0a82b6ea16f11da3686d0e", "patch": "@@ -12,10 +12,15 @@ For example:\n ```Bash\n cargo new testgcov --bin\n cd testgcov\n-export RUSTFLAGS=\"-Zprofile\"\n+export RUSTFLAGS=\"-Zprofile -Ccodegen-units=1 -Copt-level=0 -Clink-dead-code -Coverflow-checks=off -Zpanic_abort_tests -Cpanic=abort\"\n+export CARGO_INCREMENTAL=0\n cargo build\n cargo run\n ```\n \n Once you've built and run your program, files with the `gcno` (after build) and `gcda` (after execution) extensions will be created.\n You can parse them with [llvm-cov gcov](https://llvm.org/docs/CommandGuide/llvm-cov.html#llvm-cov-gcov) or [grcov](https://github.com/mozilla/grcov).\n+\n+Please note that `RUSTFLAGS` apply to everything that cargo builds and runs during a build, including build scripts!\n+To avoid this, pass a `RUSTC_WRAPPER` program to cargo that only adds the profiling flags to rustc for the specific \n+crates you want to profile."}]}