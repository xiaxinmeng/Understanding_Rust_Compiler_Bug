{"sha": "54d49af3ff1f23e8e8b580483e6b3a4f708285bd", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU0ZDQ5YWYzZmYxZjIzZThlOGI1ODA0ODNlNmIzYTRmNzA4Mjg1YmQ=", "commit": {"author": {"name": "rhysd", "email": "lin90162@yahoo.co.jp", "date": "2019-02-01T19:54:51Z"}, "committer": {"name": "rhysd", "email": "lin90162@yahoo.co.jp", "date": "2019-02-01T19:54:51Z"}, "message": "add more test cases for dbg_macro rule", "tree": {"sha": "b576b19cc1a84e0889e9bbeecb36c2b285b71151", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b576b19cc1a84e0889e9bbeecb36c2b285b71151"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/54d49af3ff1f23e8e8b580483e6b3a4f708285bd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/54d49af3ff1f23e8e8b580483e6b3a4f708285bd", "html_url": "https://github.com/rust-lang/rust/commit/54d49af3ff1f23e8e8b580483e6b3a4f708285bd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/54d49af3ff1f23e8e8b580483e6b3a4f708285bd/comments", "author": {"login": "rhysd", "id": 823277, "node_id": "MDQ6VXNlcjgyMzI3Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/823277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rhysd", "html_url": "https://github.com/rhysd", "followers_url": "https://api.github.com/users/rhysd/followers", "following_url": "https://api.github.com/users/rhysd/following{/other_user}", "gists_url": "https://api.github.com/users/rhysd/gists{/gist_id}", "starred_url": "https://api.github.com/users/rhysd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rhysd/subscriptions", "organizations_url": "https://api.github.com/users/rhysd/orgs", "repos_url": "https://api.github.com/users/rhysd/repos", "events_url": "https://api.github.com/users/rhysd/events{/privacy}", "received_events_url": "https://api.github.com/users/rhysd/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rhysd", "id": 823277, "node_id": "MDQ6VXNlcjgyMzI3Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/823277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rhysd", "html_url": "https://github.com/rhysd", "followers_url": "https://api.github.com/users/rhysd/followers", "following_url": "https://api.github.com/users/rhysd/following{/other_user}", "gists_url": "https://api.github.com/users/rhysd/gists{/gist_id}", "starred_url": "https://api.github.com/users/rhysd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rhysd/subscriptions", "organizations_url": "https://api.github.com/users/rhysd/orgs", "repos_url": "https://api.github.com/users/rhysd/repos", "events_url": "https://api.github.com/users/rhysd/events{/privacy}", "received_events_url": "https://api.github.com/users/rhysd/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "268ff853263da6d518e233cf2a514bde50975f1d", "url": "https://api.github.com/repos/rust-lang/rust/commits/268ff853263da6d518e233cf2a514bde50975f1d", "html_url": "https://github.com/rust-lang/rust/commit/268ff853263da6d518e233cf2a514bde50975f1d"}], "stats": {"total": 76, "additions": 69, "deletions": 7}, "files": [{"sha": "0b8f0c3f5fc4af416a93b261eb20c3b7f6f4ccb3", "filename": "clippy_lints/src/dbg_macro.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/54d49af3ff1f23e8e8b580483e6b3a4f708285bd/clippy_lints%2Fsrc%2Fdbg_macro.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54d49af3ff1f23e8e8b580483e6b3a4f708285bd/clippy_lints%2Fsrc%2Fdbg_macro.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fdbg_macro.rs?ref=54d49af3ff1f23e8e8b580483e6b3a4f708285bd", "patch": "@@ -1,7 +1,6 @@\n use crate::utils::span_help_and_lint;\n use rustc::lint::{EarlyContext, EarlyLintPass, LintArray, LintPass};\n use rustc::{declare_tool_lint, lint_array};\n-use rustc_errors::Applicability;\n use syntax::ast;\n \n /// **What it does:** Checks for usage of dbg!() macro."}, {"sha": "d2df7fbd3e84c727d263648fff82d7edb684abab", "filename": "tests/ui/dbg_macro.rs", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/54d49af3ff1f23e8e8b580483e6b3a4f708285bd/tests%2Fui%2Fdbg_macro.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54d49af3ff1f23e8e8b580483e6b3a4f708285bd/tests%2Fui%2Fdbg_macro.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fdbg_macro.rs?ref=54d49af3ff1f23e8e8b580483e6b3a4f708285bd", "patch": "@@ -1,5 +1,23 @@\n #![warn(clippy::dbg_macro)]\n \n+fn foo(n: u32) -> u32 {\n+    if let Some(n) = dbg!(n.checked_sub(4)) {\n+        n\n+    } else {\n+        n\n+    }\n+}\n+\n+fn factorial(n: u32) -> u32 {\n+    if dbg!(n <= 1) {\n+        dbg!(1)\n+    } else {\n+        dbg!(n * factorial(n - 1))\n+    }\n+}\n+\n fn main() {\n     dbg!(42);\n+    dbg!(dbg!(dbg!(42)));\n+    foo(3) + dbg!(factorial(4));\n }"}, {"sha": "28e59f4c11b3084d588957776d1738345863c84d", "filename": "tests/ui/dbg_macro.stderr", "status": "modified", "additions": 51, "deletions": 6, "changes": 57, "blob_url": "https://github.com/rust-lang/rust/blob/54d49af3ff1f23e8e8b580483e6b3a4f708285bd/tests%2Fui%2Fdbg_macro.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/54d49af3ff1f23e8e8b580483e6b3a4f708285bd/tests%2Fui%2Fdbg_macro.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fdbg_macro.stderr?ref=54d49af3ff1f23e8e8b580483e6b3a4f708285bd", "patch": "@@ -1,14 +1,59 @@\n error: `dbg!` macro is intended as a debugging tool\n-  --> $DIR/dbg_macro.rs:4:5\n+  --> $DIR/dbg_macro.rs:4:22\n+   |\n+LL |     if let Some(n) = dbg!(n.checked_sub(4)) {\n+   |                      ^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+   = note: `-D clippy::dbg-macro` implied by `-D warnings`\n+   = help: ensure to avoid having uses of it in version control\n+\n+error: `dbg!` macro is intended as a debugging tool\n+  --> $DIR/dbg_macro.rs:12:8\n+   |\n+LL |     if dbg!(n <= 1) {\n+   |        ^^^^^^^^^^^^\n+   |\n+   = help: ensure to avoid having uses of it in version control\n+\n+error: `dbg!` macro is intended as a debugging tool\n+  --> $DIR/dbg_macro.rs:13:9\n+   |\n+LL |         dbg!(1)\n+   |         ^^^^^^^\n+   |\n+   = help: ensure to avoid having uses of it in version control\n+\n+error: `dbg!` macro is intended as a debugging tool\n+  --> $DIR/dbg_macro.rs:15:9\n+   |\n+LL |         dbg!(n * factorial(n - 1))\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+   = help: ensure to avoid having uses of it in version control\n+\n+error: `dbg!` macro is intended as a debugging tool\n+  --> $DIR/dbg_macro.rs:20:5\n    |\n LL |     dbg!(42);\n    |     ^^^^^^^^\n    |\n-   = note: `-D clippy::dbg-macro` implied by `-D warnings`\n-help: ensure to avoid having uses of it in version control\n+   = help: ensure to avoid having uses of it in version control\n+\n+error: `dbg!` macro is intended as a debugging tool\n+  --> $DIR/dbg_macro.rs:21:5\n+   |\n+LL |     dbg!(dbg!(dbg!(42)));\n+   |     ^^^^^^^^^^^^^^^^^^^^\n+   |\n+   = help: ensure to avoid having uses of it in version control\n+\n+error: `dbg!` macro is intended as a debugging tool\n+  --> $DIR/dbg_macro.rs:22:14\n+   |\n+LL |     foo(3) + dbg!(factorial(4));\n+   |              ^^^^^^^^^^^^^^^^^^\n    |\n-LL |     42;\n-   |     ^^\n+   = help: ensure to avoid having uses of it in version control\n \n-error: aborting due to previous error\n+error: aborting due to 7 previous errors\n "}]}