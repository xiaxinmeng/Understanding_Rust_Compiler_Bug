{"sha": "d7159bdbad331266a4b62dd316408f54e225e53e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ3MTU5YmRiYWQzMzEyNjZhNGI2MmRkMzE2NDA4ZjU0ZTIyNWU1M2U=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2021-08-30T14:47:17Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2021-09-01T09:01:42Z"}, "message": "Add tests for implementors associated types display", "tree": {"sha": "1cf2b8b44f448fa0dee6d32413fd927cccac4580", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1cf2b8b44f448fa0dee6d32413fd927cccac4580"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d7159bdbad331266a4b62dd316408f54e225e53e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d7159bdbad331266a4b62dd316408f54e225e53e", "html_url": "https://github.com/rust-lang/rust/commit/d7159bdbad331266a4b62dd316408f54e225e53e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d7159bdbad331266a4b62dd316408f54e225e53e/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "eb913664333036b185bd5d5f3df3ce270864aaa6", "url": "https://api.github.com/repos/rust-lang/rust/commits/eb913664333036b185bd5d5f3df3ce270864aaa6", "html_url": "https://github.com/rust-lang/rust/commit/eb913664333036b185bd5d5f3df3ce270864aaa6"}], "stats": {"total": 52, "additions": 40, "deletions": 12}, "files": [{"sha": "c9042eb4813ab8a187dfb4969ddcb8bbb8d19a76", "filename": "src/test/rustdoc-gui/implementors.goml", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/d7159bdbad331266a4b62dd316408f54e225e53e/src%2Ftest%2Frustdoc-gui%2Fimplementors.goml", "raw_url": "https://github.com/rust-lang/rust/raw/d7159bdbad331266a4b62dd316408f54e225e53e/src%2Ftest%2Frustdoc-gui%2Fimplementors.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fimplementors.goml?ref=d7159bdbad331266a4b62dd316408f54e225e53e", "patch": "@@ -3,14 +3,14 @@\n goto: file://|DOC_PATH|/implementors/trait.Whatever.html\n assert: \"#implementors-list\"\n // There are supposed to be two implementors listed.\n-assert-count: (\"#implementors-list > .impl\", 2)\n+assert-count: (\"#implementors-list .impl\", 2)\n // Now we check that both implementors have an anchor, an ID and a similar DOM.\n-assert: (\"#implementors-list > .impl:nth-child(1) > a.anchor\")\n-assert-attribute: (\"#implementors-list > .impl:nth-child(1)\", {\"id\": \"impl-Whatever\"})\n-assert-attribute: (\"#implementors-list > .impl:nth-child(1) > a.anchor\", {\"href\": \"#impl-Whatever\"})\n-assert: \"#implementors-list > .impl:nth-child(1) > .code-header.in-band\"\n+assert: (\"#implementors-list .impl:nth-child(1) > a.anchor\")\n+assert-attribute: (\"#implementors-list .impl:nth-child(1)\", {\"id\": \"impl-Whatever\"})\n+assert-attribute: (\"#implementors-list .impl:nth-child(1) > a.anchor\", {\"href\": \"#impl-Whatever\"})\n+assert: \"#implementors-list .impl:nth-child(1) > .code-header.in-band\"\n \n-assert: (\"#implementors-list > .impl:nth-child(2) > a.anchor\")\n-assert-attribute: (\"#implementors-list > .impl:nth-child(2)\", {\"id\": \"impl-Whatever-1\"})\n-assert-attribute: (\"#implementors-list > .impl:nth-child(2) > a.anchor\", {\"href\": \"#impl-Whatever-1\"})\n-assert: \"#implementors-list > .impl:nth-child(2) > .code-header.in-band\"\n+assert: (\"#implementors-list .impl:nth-child(2) > a.anchor\")\n+assert-attribute: (\"#implementors-list .impl:nth-child(2)\", {\"id\": \"impl-Whatever-1\"})\n+assert-attribute: (\"#implementors-list .impl:nth-child(2) > a.anchor\", {\"href\": \"#impl-Whatever-1\"})\n+assert: \"#implementors-list .impl:nth-child(2) > .code-header.in-band\""}, {"sha": "6417a6ac5af6de314d594cc47833508831e24a08", "filename": "src/test/rustdoc-gui/src/lib2/implementors/lib.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d7159bdbad331266a4b62dd316408f54e225e53e/src%2Ftest%2Frustdoc-gui%2Fsrc%2Flib2%2Fimplementors%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d7159bdbad331266a4b62dd316408f54e225e53e/src%2Ftest%2Frustdoc-gui%2Fsrc%2Flib2%2Fimplementors%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsrc%2Flib2%2Fimplementors%2Flib.rs?ref=d7159bdbad331266a4b62dd316408f54e225e53e", "patch": "@@ -1,7 +1,11 @@\n pub trait Whatever {\n+    type Foo;\n+\n     fn method() {}\n }\n \n pub struct Struct;\n \n-impl Whatever for Struct {}\n+impl Whatever for Struct {\n+    type Foo = u8;\n+}"}, {"sha": "cb63a9f60022702881b01a86ac23d0299b5226f0", "filename": "src/test/rustdoc-gui/src/lib2/lib.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d7159bdbad331266a4b62dd316408f54e225e53e/src%2Ftest%2Frustdoc-gui%2Fsrc%2Flib2%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d7159bdbad331266a4b62dd316408f54e225e53e/src%2Ftest%2Frustdoc-gui%2Fsrc%2Flib2%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsrc%2Flib2%2Flib.rs?ref=d7159bdbad331266a4b62dd316408f54e225e53e", "patch": "@@ -38,7 +38,9 @@ impl Trait for Foo {\n }\n \n \n-impl implementors::Whatever for Foo {}\n+impl implementors::Whatever for Foo {\n+    type Foo = u32;\n+}\n \n pub mod sub_mod {\n     /// ```txt"}, {"sha": "4b2a266c7128ae1f4d7e66701c57a95dd7b10b23", "filename": "src/test/rustdoc-gui/toggle-implementors.goml", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/d7159bdbad331266a4b62dd316408f54e225e53e/src%2Ftest%2Frustdoc-gui%2Ftoggle-implementors.goml", "raw_url": "https://github.com/rust-lang/rust/raw/d7159bdbad331266a4b62dd316408f54e225e53e/src%2Ftest%2Frustdoc-gui%2Ftoggle-implementors.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Ftoggle-implementors.goml?ref=d7159bdbad331266a4b62dd316408f54e225e53e", "patch": "@@ -0,0 +1,13 @@\n+// This test ensures two things:\n+//\n+// 1. The implementors toggle are not open by default.\n+// 2. The \"auto-collapse-implementors\" setting is working as expected.\n+goto: file://|DOC_PATH|/implementors/trait.Whatever.html\n+\n+// First, checking that they are not open by default.\n+assert-attribute-false: (\"#implementors-list > details\", {\"open\": \"\"}, ALL)\n+\n+// Second, checking \"auto-collapse-implementors\" setting.\n+local-storage: {\"rustdoc-auto-collapse-implementors\": false}\n+reload:\n+assert-attribute: (\"#implementors-list > details\", {\"open\": \"\"}, ALL)"}, {"sha": "4d25835bf08fd231d479e4306ac9a3ed7af15af6", "filename": "src/test/rustdoc/trait-impl-items-links-and-anchors.rs", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/d7159bdbad331266a4b62dd316408f54e225e53e/src%2Ftest%2Frustdoc%2Ftrait-impl-items-links-and-anchors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d7159bdbad331266a4b62dd316408f54e225e53e/src%2Ftest%2Frustdoc%2Ftrait-impl-items-links-and-anchors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Ftrait-impl-items-links-and-anchors.rs?ref=d7159bdbad331266a4b62dd316408f54e225e53e", "patch": "@@ -1,6 +1,6 @@\n pub trait MyTrait {\n     type Assoc;\n-    const VALUE: u32;\n+    const VALUE: u32 = 12;\n     fn trait_function(&self);\n     fn defaulted(&self) {}\n     fn defaulted_override(&self) {}\n@@ -38,9 +38,11 @@ impl MyTrait for Vec<u8> {\n }\n \n impl MyTrait for MyStruct {\n+    // @has trait_impl_items_links_and_anchors/trait.MyTrait.html '//div[@id=\"associatedtype.Assoc-3\"]//a[@class=\"anchor\"]/@href' #associatedtype.Assoc-3\n     // @has trait_impl_items_links_and_anchors/struct.MyStruct.html '//div[@id=\"associatedtype.Assoc\"]//a[@class=\"type\"]/@href' trait.MyTrait.html#associatedtype.Assoc\n     // @has trait_impl_items_links_and_anchors/struct.MyStruct.html '//div[@id=\"associatedtype.Assoc\"]//a[@class=\"anchor\"]/@href' #associatedtype.Assoc\n     type Assoc = bool;\n+    // @has trait_impl_items_links_and_anchors/trait.MyTrait.html '//div[@id=\"associatedconstant.VALUE-3\"]//a[@class=\"anchor\"]/@href' #associatedconstant.VALUE-3\n     // @has trait_impl_items_links_and_anchors/struct.MyStruct.html '//div[@id=\"associatedconstant.VALUE\"]//a[@class=\"constant\"]/@href' trait.MyTrait.html#associatedconstant.VALUE\n     // @has trait_impl_items_links_and_anchors/struct.MyStruct.html '//div[@id=\"associatedconstant.VALUE\"]//a[@class=\"anchor\"]/@href' #associatedconstant.VALUE\n     const VALUE: u32 = 20;\n@@ -55,3 +57,10 @@ impl MyTrait for MyStruct {\n }\n \n pub struct MyStruct;\n+\n+// We check that associated items with default values aren't generated in the implementors list.\n+impl MyTrait for (u8, u8) {\n+    // @!has trait_impl_items_links_and_anchors/trait.MyTrait.html '//div[@id=\"associatedconstant.VALUE-4\"]'\n+    type Assoc = bool;\n+    fn trait_function(&self) {}\n+}"}]}