{"sha": "bf193d69fe48f4ec3cac57ab7abb4e9f2a291661", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJmMTkzZDY5ZmU0OGY0ZWMzY2FjNTdhYjdhYmI0ZTlmMmEyOTE2NjE=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-01-28T15:19:16Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-01-28T15:19:16Z"}, "message": "Auto merge of #81441 - tmiasko:ctfe-inline, r=oli-obk\n\nTry inlining trivial functions used by CTFE\n\nr? `@ghost`", "tree": {"sha": "00d12382e71d698743c2d1006823cd4cf03108cf", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/00d12382e71d698743c2d1006823cd4cf03108cf"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bf193d69fe48f4ec3cac57ab7abb4e9f2a291661", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bf193d69fe48f4ec3cac57ab7abb4e9f2a291661", "html_url": "https://github.com/rust-lang/rust/commit/bf193d69fe48f4ec3cac57ab7abb4e9f2a291661", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bf193d69fe48f4ec3cac57ab7abb4e9f2a291661/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "643a79af3d5a31fa87c8a4c9d7f8bc4ebe2add4b", "url": "https://api.github.com/repos/rust-lang/rust/commits/643a79af3d5a31fa87c8a4c9d7f8bc4ebe2add4b", "html_url": "https://github.com/rust-lang/rust/commit/643a79af3d5a31fa87c8a4c9d7f8bc4ebe2add4b"}, {"sha": "20982b386fa9908f11d4c0b6db8c9ccf53700f8b", "url": "https://api.github.com/repos/rust-lang/rust/commits/20982b386fa9908f11d4c0b6db8c9ccf53700f8b", "html_url": "https://github.com/rust-lang/rust/commit/20982b386fa9908f11d4c0b6db8c9ccf53700f8b"}], "stats": {"total": 21, "additions": 19, "deletions": 2}, "files": [{"sha": "efde7fe6948c28e973e1f01153af95aa29dd5cf3", "filename": "compiler/rustc_mir/src/interpret/place.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/bf193d69fe48f4ec3cac57ab7abb4e9f2a291661/compiler%2Frustc_mir%2Fsrc%2Finterpret%2Fplace.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bf193d69fe48f4ec3cac57ab7abb4e9f2a291661/compiler%2Frustc_mir%2Fsrc%2Finterpret%2Fplace.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir%2Fsrc%2Finterpret%2Fplace.rs?ref=bf193d69fe48f4ec3cac57ab7abb4e9f2a291661", "patch": "@@ -153,6 +153,7 @@ impl<Tag> MemPlace<Tag> {\n         }\n     }\n \n+    #[inline]\n     pub fn offset(\n         self,\n         offset: Size,"}, {"sha": "88b2923f6c48f95ae45e4d0eb90db72ab55dfad0", "filename": "compiler/rustc_target/src/abi/mod.rs", "status": "modified", "additions": 18, "deletions": 2, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/bf193d69fe48f4ec3cac57ab7abb4e9f2a291661/compiler%2Frustc_target%2Fsrc%2Fabi%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bf193d69fe48f4ec3cac57ab7abb4e9f2a291661/compiler%2Frustc_target%2Fsrc%2Fabi%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fabi%2Fmod.rs?ref=bf193d69fe48f4ec3cac57ab7abb4e9f2a291661", "patch": "@@ -441,36 +441,50 @@ pub struct Align {\n }\n \n impl Align {\n+    #[inline]\n     pub fn from_bits(bits: u64) -> Result<Align, String> {\n         Align::from_bytes(Size::from_bits(bits).bytes())\n     }\n \n+    #[inline]\n     pub fn from_bytes(align: u64) -> Result<Align, String> {\n         // Treat an alignment of 0 bytes like 1-byte alignment.\n         if align == 0 {\n             return Ok(Align { pow2: 0 });\n         }\n \n+        #[cold]\n+        fn not_power_of_2(align: u64) -> String {\n+            format!(\"`{}` is not a power of 2\", align)\n+        }\n+\n+        #[cold]\n+        fn too_large(align: u64) -> String {\n+            format!(\"`{}` is too large\", align)\n+        }\n+\n         let mut bytes = align;\n         let mut pow2: u8 = 0;\n         while (bytes & 1) == 0 {\n             pow2 += 1;\n             bytes >>= 1;\n         }\n         if bytes != 1 {\n-            return Err(format!(\"`{}` is not a power of 2\", align));\n+            return Err(not_power_of_2(align));\n         }\n         if pow2 > 29 {\n-            return Err(format!(\"`{}` is too large\", align));\n+            return Err(too_large(align));\n         }\n \n         Ok(Align { pow2 })\n     }\n \n+    #[inline]\n     pub fn bytes(self) -> u64 {\n         1 << self.pow2\n     }\n \n+    #[inline]\n     pub fn bits(self) -> u64 {\n         self.bytes() * 8\n     }\n@@ -479,12 +493,14 @@ impl Align {\n     /// (the largest power of two that the offset is a multiple of).\n     ///\n     /// N.B., for an offset of `0`, this happens to return `2^64`.\n+    #[inline]\n     pub fn max_for_offset(offset: Size) -> Align {\n         Align { pow2: offset.bytes().trailing_zeros() as u8 }\n     }\n \n     /// Lower the alignment, if necessary, such that the given offset\n     /// is aligned to it (the offset is a multiple of the alignment).\n+    #[inline]\n     pub fn restrict_for_offset(self, offset: Size) -> Align {\n         self.min(Align::max_for_offset(offset))\n     }"}]}