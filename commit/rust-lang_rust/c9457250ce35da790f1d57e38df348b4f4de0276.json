{"sha": "c9457250ce35da790f1d57e38df348b4f4de0276", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM5NDU3MjUwY2UzNWRhNzkwZjFkNTdlMzhkZjM0OGI0ZjRkZTAyNzY=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-03-22T09:51:27Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-03-22T14:43:40Z"}, "message": "Rollup merge of #49158 - varkor:compiletest-triples, r=rkruppe\n\nMake compiletest do exact matching on triples\n\nThis avoids the issues of the previous substring matching, ensuring `ARCH_TABLE` and `OS_TABLE` will no longer contain redundant entries. Fixes #48893.\n\nr? @rkruppe", "tree": {"sha": "82aca28b3e863b52da17ac0ad56b9ac07ca4838b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/82aca28b3e863b52da17ac0ad56b9ac07ca4838b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c9457250ce35da790f1d57e38df348b4f4de0276", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlqzwRwACgkQ/vbIBR0O\nATyoUA/+IGtOtEalbVHpdu+Wy0wuTlJ0vTXIms4KpQQO9IjWb+JmrEH9rRiFRjFE\nzsjp6usN+XNIwHLH0tFL8P48sFtGxiama3Iz0XPooppfkxYtaP8VZEBy8T9yg1wX\nbKQkIapVJ8LdFwIuUMEgld5X2Gu56by9M3AooqHg5zeUnC2xywoh+2vMKuFqpfRw\nJqYxAsE93NqAPXaV8Wu03v9CF+osXUu5na21oykVrJlWSCq0rttxTB+H8QwLbQjh\nbMy9woLuVq4I7HMJskD87rW1CfKX+s3xmFK+Ene1Zvmb3XxDx4uh8zY5WURCUryd\nPMrMcoy9alK3Ro96QNDa68T0kgM4wfiUgxD6khGBJEgv2iUZfmoYiLP8kJS9akSg\nHwrWQPLJxYFct04yX9y+WcNJl6Xj/AZIggFYl2KBfKN67INKC3mRKVJgBNjojs2v\njKAOy3EXQrw7N6KDt7QSA7yQzbGDRXd/cJOZNvf31hU6KCBazqtjDlvBcsbfTi+Y\nGYxsq6qUNcXE75jA+Xkj/N3WzFhgtvIz71tkkuBhOV3Z0Fjd+elaz9g+N0hzCTiR\n9n0qSSWN72I5+SXKNOf3ExTxzSCNHTJG7/3M4nWSMHiJio7Qrrj5CJYa2Hv6/PvV\nQs2tqWW/NvIaJMqIzMxgwpPNN8UZH9SwqOpuyV6+R16AARPibvA=\n=Ymut\n-----END PGP SIGNATURE-----", "payload": "tree 82aca28b3e863b52da17ac0ad56b9ac07ca4838b\nparent 20eaf351a20d1ac1ff2de9abc80fe7bff9737843\nparent 61e1fbc659103513e68eae29ea830d798e2ec2d5\nauthor kennytm <kennytm@gmail.com> 1521712287 +0800\ncommitter kennytm <kennytm@gmail.com> 1521729820 +0800\n\nRollup merge of #49158 - varkor:compiletest-triples, r=rkruppe\n\nMake compiletest do exact matching on triples\n\nThis avoids the issues of the previous substring matching, ensuring `ARCH_TABLE` and `OS_TABLE` will no longer contain redundant entries. Fixes #48893.\n\nr? @rkruppe\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c9457250ce35da790f1d57e38df348b4f4de0276", "html_url": "https://github.com/rust-lang/rust/commit/c9457250ce35da790f1d57e38df348b4f4de0276", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c9457250ce35da790f1d57e38df348b4f4de0276/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "20eaf351a20d1ac1ff2de9abc80fe7bff9737843", "url": "https://api.github.com/repos/rust-lang/rust/commits/20eaf351a20d1ac1ff2de9abc80fe7bff9737843", "html_url": "https://github.com/rust-lang/rust/commit/20eaf351a20d1ac1ff2de9abc80fe7bff9737843"}, {"sha": "61e1fbc659103513e68eae29ea830d798e2ec2d5", "url": "https://api.github.com/repos/rust-lang/rust/commits/61e1fbc659103513e68eae29ea830d798e2ec2d5", "html_url": "https://github.com/rust-lang/rust/commit/61e1fbc659103513e68eae29ea830d798e2ec2d5"}], "stats": {"total": 43, "additions": 36, "deletions": 7}, "files": [{"sha": "367d509cadfe3755e38ad0f17a79bbe3dfc80b3f", "filename": "src/test/codegen/abi-main-signature-16bit-c-int.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c9457250ce35da790f1d57e38df348b4f4de0276/src%2Ftest%2Fcodegen%2Fabi-main-signature-16bit-c-int.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c9457250ce35da790f1d57e38df348b4f4de0276/src%2Ftest%2Fcodegen%2Fabi-main-signature-16bit-c-int.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fabi-main-signature-16bit-c-int.rs?ref=c9457250ce35da790f1d57e38df348b4f4de0276", "patch": "@@ -19,6 +19,7 @@\n // ignore-mips\n // ignore-mips64\n // ignore-powerpc\n+// ignore-powerpc64\n // ignore-s390x\n // ignore-sparc\n // ignore-wasm32"}, {"sha": "d6dd3f356b5fe7b363d4799ab2f6c7eb75f45fb8", "filename": "src/test/codegen/fastcall-inreg.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c9457250ce35da790f1d57e38df348b4f4de0276/src%2Ftest%2Fcodegen%2Ffastcall-inreg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c9457250ce35da790f1d57e38df348b4f4de0276/src%2Ftest%2Fcodegen%2Ffastcall-inreg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Ffastcall-inreg.rs?ref=c9457250ce35da790f1d57e38df348b4f4de0276", "patch": "@@ -23,6 +23,8 @@\n // ignore-mips\n // ignore-mips64\n // ignore-msp430\n+// ignore-powerpc64\n+// ignore-powerpc64le\n // ignore-powerpc\n // ignore-r600\n // ignore-amdgcn"}, {"sha": "6b79e79fa0080df6e56c9c97fc9e60186e6ab24b", "filename": "src/test/codegen/global_asm.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c9457250ce35da790f1d57e38df348b4f4de0276/src%2Ftest%2Fcodegen%2Fglobal_asm.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c9457250ce35da790f1d57e38df348b4f4de0276/src%2Ftest%2Fcodegen%2Fglobal_asm.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fglobal_asm.rs?ref=c9457250ce35da790f1d57e38df348b4f4de0276", "patch": "@@ -19,6 +19,8 @@\n // ignore-mips\n // ignore-mips64\n // ignore-msp430\n+// ignore-powerpc64\n+// ignore-powerpc64le\n // ignore-powerpc\n // ignore-r600\n // ignore-amdgcn"}, {"sha": "3f73a1cabbf19630d0e2a583af34ca75860bafbb", "filename": "src/test/codegen/global_asm_include.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c9457250ce35da790f1d57e38df348b4f4de0276/src%2Ftest%2Fcodegen%2Fglobal_asm_include.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c9457250ce35da790f1d57e38df348b4f4de0276/src%2Ftest%2Fcodegen%2Fglobal_asm_include.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fglobal_asm_include.rs?ref=c9457250ce35da790f1d57e38df348b4f4de0276", "patch": "@@ -19,6 +19,8 @@\n // ignore-mips\n // ignore-mips64\n // ignore-msp430\n+// ignore-powerpc64\n+// ignore-powerpc64le\n // ignore-powerpc\n // ignore-r600\n // ignore-amdgcn"}, {"sha": "3e118a50d454e10dc0642dff7ce357e9afa250d9", "filename": "src/test/codegen/global_asm_x2.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c9457250ce35da790f1d57e38df348b4f4de0276/src%2Ftest%2Fcodegen%2Fglobal_asm_x2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c9457250ce35da790f1d57e38df348b4f4de0276/src%2Ftest%2Fcodegen%2Fglobal_asm_x2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fglobal_asm_x2.rs?ref=c9457250ce35da790f1d57e38df348b4f4de0276", "patch": "@@ -19,6 +19,8 @@\n // ignore-mips\n // ignore-mips64\n // ignore-msp430\n+// ignore-powerpc64\n+// ignore-powerpc64le\n // ignore-powerpc\n // ignore-r600\n // ignore-amdgcn"}, {"sha": "2eeed2b788ce2f68154dfa32243aa51bc7a6fc2a", "filename": "src/test/codegen/repr-transparent-aggregates-1.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c9457250ce35da790f1d57e38df348b4f4de0276/src%2Ftest%2Fcodegen%2Frepr-transparent-aggregates-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c9457250ce35da790f1d57e38df348b4f4de0276/src%2Ftest%2Fcodegen%2Frepr-transparent-aggregates-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Frepr-transparent-aggregates-1.rs?ref=c9457250ce35da790f1d57e38df348b4f4de0276", "patch": "@@ -14,6 +14,7 @@\n // ignore-mips\n // ignore-mips64\n // ignore-powerpc\n+// ignore-powerpc64\n // See repr-transparent.rs\n \n #![crate_type=\"lib\"]"}, {"sha": "c612f0117aaf7f311365369302807cea21eef268", "filename": "src/tools/compiletest/src/util.rs", "status": "modified", "additions": 26, "deletions": 7, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/c9457250ce35da790f1d57e38df348b4f4de0276/src%2Ftools%2Fcompiletest%2Fsrc%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c9457250ce35da790f1d57e38df348b4f4de0276/src%2Ftools%2Fcompiletest%2Fsrc%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Futil.rs?ref=c9457250ce35da790f1d57e38df348b4f4de0276", "patch": "@@ -14,42 +14,59 @@ use common::Config;\n /// Conversion table from triple OS name to Rust SYSNAME\n const OS_TABLE: &'static [(&'static str, &'static str)] = &[\n     (\"android\", \"android\"),\n+    (\"androideabi\", \"android\"),\n     (\"bitrig\", \"bitrig\"),\n     (\"cloudabi\", \"cloudabi\"),\n     (\"darwin\", \"macos\"),\n     (\"dragonfly\", \"dragonfly\"),\n+    (\"emscripten\", \"emscripten\"),\n     (\"freebsd\", \"freebsd\"),\n+    (\"fuchsia\", \"fuchsia\"),\n     (\"haiku\", \"haiku\"),\n     (\"ios\", \"ios\"),\n+    (\"l4re\", \"l4re\"),\n     (\"linux\", \"linux\"),\n     (\"mingw32\", \"windows\"),\n     (\"netbsd\", \"netbsd\"),\n     (\"openbsd\", \"openbsd\"),\n+    (\"redox\", \"redox\"),\n+    (\"solaris\", \"solaris\"),\n     (\"win32\", \"windows\"),\n     (\"windows\", \"windows\"),\n-    (\"solaris\", \"solaris\"),\n-    (\"emscripten\", \"emscripten\"),\n ];\n \n const ARCH_TABLE: &'static [(&'static str, &'static str)] = &[\n     (\"aarch64\", \"aarch64\"),\n     (\"amd64\", \"x86_64\"),\n     (\"arm\", \"arm\"),\n     (\"arm64\", \"aarch64\"),\n+    (\"armv4t\", \"arm\"),\n+    (\"armv5te\", \"arm\"),\n+    (\"armv7\", \"arm\"),\n+    (\"armv7s\", \"arm\"),\n+    (\"asmjs\", \"asmjs\"),\n     (\"hexagon\", \"hexagon\"),\n     (\"i386\", \"x86\"),\n     (\"i586\", \"x86\"),\n     (\"i686\", \"x86\"),\n-    (\"mips64\", \"mips64\"),\n     (\"mips\", \"mips\"),\n+    (\"mips64\", \"mips64\"),\n+    (\"mips64el\", \"mips64\"),\n+    (\"mipsel\", \"mips\"),\n     (\"msp430\", \"msp430\"),\n     (\"powerpc\", \"powerpc\"),\n+    (\"powerpc64\", \"powerpc64\"),\n+    (\"powerpc64le\", \"powerpc64\"),\n     (\"s390x\", \"s390x\"),\n     (\"sparc\", \"sparc\"),\n+    (\"sparc64\", \"sparc64\"),\n+    (\"sparcv9\", \"sparc64\"),\n+    (\"thumbv6m\", \"thumb\"),\n+    (\"thumbv7em\", \"thumb\"),\n+    (\"thumbv7m\", \"thumb\"),\n+    (\"wasm32\", \"wasm32\"),\n     (\"x86_64\", \"x86_64\"),\n     (\"xcore\", \"xcore\"),\n-    (\"asmjs\", \"asmjs\"),\n-    (\"wasm32\", \"wasm32\"),\n ];\n \n pub fn matches_os(triple: &str, name: &str) -> bool {\n@@ -58,16 +75,18 @@ pub fn matches_os(triple: &str, name: &str) -> bool {\n     if triple == \"wasm32-unknown-unknown\" {\n         return name == \"emscripten\" || name == \"wasm32-bare\"\n     }\n+    let triple: Vec<_> = triple.split('-').collect();\n     for &(triple_os, os) in OS_TABLE {\n-        if triple.contains(triple_os) {\n+        if triple.contains(&triple_os) {\n             return os == name;\n         }\n     }\n     panic!(\"Cannot determine OS from triple\");\n }\n pub fn get_arch(triple: &str) -> &'static str {\n+    let triple: Vec<_> = triple.split('-').collect();\n     for &(triple_arch, arch) in ARCH_TABLE {\n-        if triple.contains(triple_arch) {\n+        if triple.contains(&triple_arch) {\n             return arch;\n         }\n     }"}]}