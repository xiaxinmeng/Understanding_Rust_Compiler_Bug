{"sha": "aab063a40e46357ef803c0f369afa1a1dcafb4bd", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFhYjA2M2E0MGU0NjM1N2VmODAzYzBmMzY5YWZhMWExZGNhZmI0YmQ=", "commit": {"author": {"name": "ljedrz", "email": "ljedrz@gmail.com", "date": "2018-08-09T07:58:36Z"}, "committer": {"name": "ljedrz", "email": "ljedrz@gmail.com", "date": "2018-08-09T07:59:13Z"}, "message": "Use Cow<str> in describe_num_args", "tree": {"sha": "fb58f978515af78b72de44c73b0464f55f31f070", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fb58f978515af78b72de44c73b0464f55f31f070"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/aab063a40e46357ef803c0f369afa1a1dcafb4bd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/aab063a40e46357ef803c0f369afa1a1dcafb4bd", "html_url": "https://github.com/rust-lang/rust/commit/aab063a40e46357ef803c0f369afa1a1dcafb4bd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/aab063a40e46357ef803c0f369afa1a1dcafb4bd/comments", "author": {"login": "ljedrz", "id": 3750347, "node_id": "MDQ6VXNlcjM3NTAzNDc=", "avatar_url": "https://avatars.githubusercontent.com/u/3750347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ljedrz", "html_url": "https://github.com/ljedrz", "followers_url": "https://api.github.com/users/ljedrz/followers", "following_url": "https://api.github.com/users/ljedrz/following{/other_user}", "gists_url": "https://api.github.com/users/ljedrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/ljedrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ljedrz/subscriptions", "organizations_url": "https://api.github.com/users/ljedrz/orgs", "repos_url": "https://api.github.com/users/ljedrz/repos", "events_url": "https://api.github.com/users/ljedrz/events{/privacy}", "received_events_url": "https://api.github.com/users/ljedrz/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ljedrz", "id": 3750347, "node_id": "MDQ6VXNlcjM3NTAzNDc=", "avatar_url": "https://avatars.githubusercontent.com/u/3750347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ljedrz", "html_url": "https://github.com/ljedrz", "followers_url": "https://api.github.com/users/ljedrz/followers", "following_url": "https://api.github.com/users/ljedrz/following{/other_user}", "gists_url": "https://api.github.com/users/ljedrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/ljedrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ljedrz/subscriptions", "organizations_url": "https://api.github.com/users/ljedrz/orgs", "repos_url": "https://api.github.com/users/ljedrz/repos", "events_url": "https://api.github.com/users/ljedrz/events{/privacy}", "received_events_url": "https://api.github.com/users/ljedrz/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c7646d54ddb46a64576bad4c0ad618366a2ef8e0", "url": "https://api.github.com/repos/rust-lang/rust/commits/c7646d54ddb46a64576bad4c0ad618366a2ef8e0", "html_url": "https://github.com/rust-lang/rust/commit/c7646d54ddb46a64576bad4c0ad618366a2ef8e0"}], "stats": {"total": 14, "additions": 8, "deletions": 6}, "files": [{"sha": "61f52194aad3e4a4e239362e37d6eae16322d540", "filename": "src/libsyntax_ext/format.rs", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/aab063a40e46357ef803c0f369afa1a1dcafb4bd/src%2Flibsyntax_ext%2Fformat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/aab063a40e46357ef803c0f369afa1a1dcafb4bd/src%2Flibsyntax_ext%2Fformat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax_ext%2Fformat.rs?ref=aab063a40e46357ef803c0f369afa1a1dcafb4bd", "patch": "@@ -14,8 +14,7 @@ use self::Position::*;\n use fmt_macros as parse;\n \n use syntax::ast;\n-use syntax::ext::base;\n-use syntax::ext::base::*;\n+use syntax::ext::base::{self, *};\n use syntax::ext::build::AstBuilder;\n use syntax::feature_gate;\n use syntax::parse::token;\n@@ -24,6 +23,7 @@ use syntax::symbol::Symbol;\n use syntax::tokenstream;\n use syntax_pos::{MultiSpan, Span, DUMMY_SP};\n \n+use std::borrow::Cow;\n use std::collections::hash_map::Entry;\n use std::collections::{HashMap, HashSet};\n \n@@ -143,8 +143,10 @@ fn parse_args(ecx: &mut ExtCtxt,\n         ecx.span_err(sp, \"requires at least a format string argument\");\n         return None;\n     }\n+\n     let fmtstr = panictry!(p.parse_expr());\n     let mut named = false;\n+\n     while p.token != token::Eof {\n         if !p.eat(&token::Comma) {\n             ecx.span_err(p.span, \"expected token: `,`\");\n@@ -264,11 +266,11 @@ impl<'a, 'b> Context<'a, 'b> {\n         }\n     }\n \n-    fn describe_num_args(&self) -> String {\n+    fn describe_num_args(&self) -> Cow<str> {\n         match self.args.len() {\n-            0 => \"no arguments were given\".to_string(),\n-            1 => \"there is 1 argument\".to_string(),\n-            x => format!(\"there are {} arguments\", x),\n+            0 => \"no arguments were given\".into(),\n+            1 => \"there is 1 argument\".into(),\n+            x => format!(\"there are {} arguments\", x).into(),\n         }\n     }\n "}]}