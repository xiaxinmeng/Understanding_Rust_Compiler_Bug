{"sha": "c3c47f5f55ca800b229fb5821825036fcc9ae0fc", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMzYzQ3ZjVmNTVjYTgwMGIyMjlmYjU4MjE4MjUwMzZmY2M5YWUwZmM=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2015-01-15T22:11:58Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2015-01-15T22:11:58Z"}, "message": "rollup merge of #21161: japaric/ufcs-hash\n\nexpansion now uses `::std::hash::Hash::hash(&*__self_0_0, __arg_0)` instead of\n`(*__self_0_0).hash(__arg_0)`\n\ncloses #21160\n\nr? @alexcrichton", "tree": {"sha": "993a4ddd6b74809230df4caeac0d382374247e68", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/993a4ddd6b74809230df4caeac0d382374247e68"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c3c47f5f55ca800b229fb5821825036fcc9ae0fc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c3c47f5f55ca800b229fb5821825036fcc9ae0fc", "html_url": "https://github.com/rust-lang/rust/commit/c3c47f5f55ca800b229fb5821825036fcc9ae0fc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c3c47f5f55ca800b229fb5821825036fcc9ae0fc/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9d4d5ca6e7d19fd9be6775289e465fefddab69f5", "url": "https://api.github.com/repos/rust-lang/rust/commits/9d4d5ca6e7d19fd9be6775289e465fefddab69f5", "html_url": "https://github.com/rust-lang/rust/commit/9d4d5ca6e7d19fd9be6775289e465fefddab69f5"}, {"sha": "28b0d4029e3ae65505b19bf74379a8516b0e1fc9", "url": "https://api.github.com/repos/rust-lang/rust/commits/28b0d4029e3ae65505b19bf74379a8516b0e1fc9", "html_url": "https://github.com/rust-lang/rust/commit/28b0d4029e3ae65505b19bf74379a8516b0e1fc9"}], "stats": {"total": 41, "additions": 39, "deletions": 2}, "files": [{"sha": "6e048e0e83cb58946cd4e133e1183a3b177ac5d4", "filename": "src/libcollections/btree/set.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c3c47f5f55ca800b229fb5821825036fcc9ae0fc/src%2Flibcollections%2Fbtree%2Fset.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c3c47f5f55ca800b229fb5821825036fcc9ae0fc/src%2Flibcollections%2Fbtree%2Fset.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcollections%2Fbtree%2Fset.rs?ref=c3c47f5f55ca800b229fb5821825036fcc9ae0fc", "patch": "@@ -18,6 +18,8 @@ use core::cmp::Ordering::{self, Less, Greater, Equal};\n use core::default::Default;\n use core::fmt::Show;\n use core::fmt;\n+// NOTE(stage0) remove import after a snapshot\n+#[cfg(stage0)]\n use core::hash::Hash;\n use core::iter::{Peekable, Map, FromIterator};\n use core::ops::{BitOr, BitAnd, BitXor, Sub};"}, {"sha": "8dcbc74f0eb6e6583cebaca4af0f6b53425924cf", "filename": "src/librustc/middle/region.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c3c47f5f55ca800b229fb5821825036fcc9ae0fc/src%2Flibrustc%2Fmiddle%2Fregion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c3c47f5f55ca800b229fb5821825036fcc9ae0fc/src%2Flibrustc%2Fmiddle%2Fregion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fregion.rs?ref=c3c47f5f55ca800b229fb5821825036fcc9ae0fc", "patch": "@@ -22,6 +22,8 @@ use util::nodemap::{FnvHashMap, FnvHashSet, NodeMap};\n use util::common::can_reach;\n \n use std::cell::RefCell;\n+// NOTE(stage0) remove import after a snapshot\n+#[cfg(stage0)]\n use std::hash::{Hash};\n use syntax::codemap::Span;\n use syntax::{ast, visit};"}, {"sha": "43ca7b131455b4b2fb14f04bbaae74f704ead1b2", "filename": "src/libstd/io/process.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c3c47f5f55ca800b229fb5821825036fcc9ae0fc/src%2Flibstd%2Fio%2Fprocess.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c3c47f5f55ca800b229fb5821825036fcc9ae0fc/src%2Flibstd%2Fio%2Fprocess.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fio%2Fprocess.rs?ref=c3c47f5f55ca800b229fb5821825036fcc9ae0fc", "patch": "@@ -21,6 +21,8 @@ use prelude::v1::*;\n use collections::HashMap;\n use ffi::CString;\n use fmt;\n+// NOTE(stage0) remove import after a snapshot\n+#[cfg(stage0)]\n use hash::Hash;\n use io::pipe::{PipeStream, PipePair};\n use io::{IoResult, IoError};"}, {"sha": "889a212a2872911931f1b40e965577e27e289527", "filename": "src/libsyntax/ext/deriving/hash.rs", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/c3c47f5f55ca800b229fb5821825036fcc9ae0fc/src%2Flibsyntax%2Fext%2Fderiving%2Fhash.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c3c47f5f55ca800b229fb5821825036fcc9ae0fc/src%2Flibsyntax%2Fext%2Fderiving%2Fhash.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Fderiving%2Fhash.rs?ref=c3c47f5f55ca800b229fb5821825036fcc9ae0fc", "patch": "@@ -65,9 +65,19 @@ fn hash_substructure(cx: &mut ExtCtxt, trait_span: Span, substr: &Substructure)\n         [ref state_expr] => state_expr,\n         _ => cx.span_bug(trait_span, \"incorrect number of arguments in `deriving(Hash)`\")\n     };\n-    let hash_ident = substr.method_ident;\n     let call_hash = |&: span, thing_expr| {\n-        let expr = cx.expr_method_call(span, thing_expr, hash_ident, vec!(state_expr.clone()));\n+        let hash_path = {\n+            let strs = vec![\n+                cx.ident_of(\"std\"),\n+                cx.ident_of(\"hash\"),\n+                cx.ident_of(\"Hash\"),\n+                cx.ident_of(\"hash\"),\n+            ];\n+\n+            cx.expr_path(cx.path_global(span, strs))\n+        };\n+        let ref_thing = cx.expr_addr_of(span, thing_expr);\n+        let expr = cx.expr_call(span, hash_path, vec!(ref_thing, state_expr.clone()));\n         cx.stmt_expr(expr)\n     };\n     let mut stmts = Vec::new();"}, {"sha": "0ee381669351a6287a3bea5bddd1454b732945c0", "filename": "src/test/compile-fail/issue-21160.rs", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/c3c47f5f55ca800b229fb5821825036fcc9ae0fc/src%2Ftest%2Fcompile-fail%2Fissue-21160.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c3c47f5f55ca800b229fb5821825036fcc9ae0fc/src%2Ftest%2Fcompile-fail%2Fissue-21160.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-21160.rs?ref=c3c47f5f55ca800b229fb5821825036fcc9ae0fc", "patch": "@@ -0,0 +1,21 @@\n+// Copyright 2015 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+struct Bar;\n+\n+impl Bar {\n+    fn hash<T>(&self, _: T) {}\n+}\n+\n+#[derive(Hash)]\n+struct Foo(Bar);\n+//~^ error: the trait `core::hash::Hash<__S>` is not implemented for the type `Bar`\n+\n+fn main() {}"}]}