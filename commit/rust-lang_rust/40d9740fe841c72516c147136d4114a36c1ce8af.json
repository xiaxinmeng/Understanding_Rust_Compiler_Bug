{"sha": "40d9740fe841c72516c147136d4114a36c1ce8af", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQwZDk3NDBmZTg0MWM3MjUxNmMxNDcxMzZkNDExNGEzNmMxY2U4YWY=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-09-12T04:17:35Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-09-12T04:17:35Z"}, "message": "Rollup merge of #54087 - ollie27:rustdoc_blanket_impl, r=QuietMisdreavus\n\nrustdoc: Remove generated blanket impls from trait pages\n\n#53801 only deduped the generated blanket impls but they shouldn't be displayed at all because the original blanket impl is already in the \"Implementors\" section. This also removes the impls from the sidebar.\n\nFixes #53689\n\nr? @QuietMisdreavus", "tree": {"sha": "071c95d83fe7ffadfe5dc318d2dcb44a9fef38a8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/071c95d83fe7ffadfe5dc318d2dcb44a9fef38a8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/40d9740fe841c72516c147136d4114a36c1ce8af", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbmJNgCRBK7hj4Ov3rIwAAdHIIAEWY/5YbNgNAtM15nm+wljxF\nt3SC0hp3CDeexIA+dSfaj+qB1x153WfmSgYUSC13F16SXorYj0jSa87dsIm9q8vP\nqM79VGUNLsDqcLCvhv2E1FBw7gI5BkHS3DbKjby2X1LZHYngLfQT/PE88NB43ZCI\nPUzgENXPAI2DmldPt1h9/u5Yg8JFYfgjEaOxkNm9KwR40j4gd0wrAcUeqAA4ReaR\n2r58Gljramhv+nh/92Ju7QMrHMDQ+/6xvJsA8OsQkZTGYnerMM2UuvUXjhjTed2d\nWxtxg1MtwhYDntFDdXTIBfsPv/2MyEMP+sLpZJopmlzow4O8g/UWP5LBBJV3FcU=\n=OG1Y\n-----END PGP SIGNATURE-----\n", "payload": "tree 071c95d83fe7ffadfe5dc318d2dcb44a9fef38a8\nparent 85b6bf9acef2e486be74ed23ea8bd43cd3045caf\nparent d3e56854e1746dd853404d98dfdcbfb89cf9a294\nauthor kennytm <kennytm@gmail.com> 1536725855 +0800\ncommitter GitHub <noreply@github.com> 1536725855 +0800\n\nRollup merge of #54087 - ollie27:rustdoc_blanket_impl, r=QuietMisdreavus\n\nrustdoc: Remove generated blanket impls from trait pages\n\n#53801 only deduped the generated blanket impls but they shouldn't be displayed at all because the original blanket impl is already in the \"Implementors\" section. This also removes the impls from the sidebar.\n\nFixes #53689\n\nr? @QuietMisdreavus\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/40d9740fe841c72516c147136d4114a36c1ce8af", "html_url": "https://github.com/rust-lang/rust/commit/40d9740fe841c72516c147136d4114a36c1ce8af", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/40d9740fe841c72516c147136d4114a36c1ce8af/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "85b6bf9acef2e486be74ed23ea8bd43cd3045caf", "url": "https://api.github.com/repos/rust-lang/rust/commits/85b6bf9acef2e486be74ed23ea8bd43cd3045caf", "html_url": "https://github.com/rust-lang/rust/commit/85b6bf9acef2e486be74ed23ea8bd43cd3045caf"}, {"sha": "d3e56854e1746dd853404d98dfdcbfb89cf9a294", "url": "https://api.github.com/repos/rust-lang/rust/commits/d3e56854e1746dd853404d98dfdcbfb89cf9a294", "html_url": "https://github.com/rust-lang/rust/commit/d3e56854e1746dd853404d98dfdcbfb89cf9a294"}], "stats": {"total": 63, "additions": 49, "deletions": 14}, "files": [{"sha": "45a5e5115a39b0ed23d77d2bd248722109d3b667", "filename": "src/librustdoc/html/render.rs", "status": "modified", "additions": 12, "deletions": 14, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/40d9740fe841c72516c147136d4114a36c1ce8af/src%2Flibrustdoc%2Fhtml%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/40d9740fe841c72516c147136d4114a36c1ce8af/src%2Flibrustdoc%2Fhtml%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender.rs?ref=40d9740fe841c72516c147136d4114a36c1ce8af", "patch": "@@ -1257,9 +1257,11 @@ impl DocFolder for Cache {\n         // Collect all the implementors of traits.\n         if let clean::ImplItem(ref i) = item.inner {\n             if let Some(did) = i.trait_.def_id() {\n-                self.implementors.entry(did).or_default().push(Impl {\n-                    impl_item: item.clone(),\n-                });\n+                if i.blanket_impl.is_none() {\n+                    self.implementors.entry(did).or_default().push(Impl {\n+                        impl_item: item.clone(),\n+                    });\n+                }\n             }\n         }\n \n@@ -2931,7 +2933,6 @@ fn item_trait(\n \n \n         let (synthetic, concrete): (Vec<&&Impl>, Vec<&&Impl>) = local.iter()\n-            .filter(|i| i.inner_impl().blanket_impl.is_none())\n             .partition(|i| i.inner_impl().synthetic);\n \n         if !foreign.is_empty() {\n@@ -2941,17 +2942,14 @@ fn item_trait(\n                 </h2>\n             \")?;\n \n-            let mut foreign_cache = FxHashSet();\n             for implementor in foreign {\n-                if foreign_cache.insert(implementor.inner_impl().to_string()) {\n-                    let assoc_link = AssocItemLink::GotoSource(\n-                        implementor.impl_item.def_id,\n-                        &implementor.inner_impl().provided_trait_methods\n-                    );\n-                    render_impl(w, cx, &implementor, assoc_link,\n-                                RenderMode::Normal, implementor.impl_item.stable_since(), false,\n-                                None)?;\n-                }\n+                let assoc_link = AssocItemLink::GotoSource(\n+                    implementor.impl_item.def_id,\n+                    &implementor.inner_impl().provided_trait_methods\n+                );\n+                render_impl(w, cx, &implementor, assoc_link,\n+                            RenderMode::Normal, implementor.impl_item.stable_since(), false,\n+                            None)?;\n             }\n         }\n "}, {"sha": "7b7f9013ca3341a29ba95ff71a2f2ad264e90ebb", "filename": "src/test/rustdoc/auxiliary/issue-53689.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/40d9740fe841c72516c147136d4114a36c1ce8af/src%2Ftest%2Frustdoc%2Fauxiliary%2Fissue-53689.rs", "raw_url": "https://github.com/rust-lang/rust/raw/40d9740fe841c72516c147136d4114a36c1ce8af/src%2Ftest%2Frustdoc%2Fauxiliary%2Fissue-53689.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fauxiliary%2Fissue-53689.rs?ref=40d9740fe841c72516c147136d4114a36c1ce8af", "patch": "@@ -0,0 +1,11 @@\n+// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+pub struct MyStruct;"}, {"sha": "bfe5adf8888e6c44f6e2e54112e61c767dcb4f16", "filename": "src/test/rustdoc/issue-53689.rs", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/40d9740fe841c72516c147136d4114a36c1ce8af/src%2Ftest%2Frustdoc%2Fissue-53689.rs", "raw_url": "https://github.com/rust-lang/rust/raw/40d9740fe841c72516c147136d4114a36c1ce8af/src%2Ftest%2Frustdoc%2Fissue-53689.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fissue-53689.rs?ref=40d9740fe841c72516c147136d4114a36c1ce8af", "patch": "@@ -0,0 +1,26 @@\n+// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// aux-build:issue-53689.rs\n+\n+#![crate_name = \"foo\"]\n+\n+extern crate issue_53689;\n+\n+// @has foo/trait.MyTrait.html\n+// @!has - 'MyStruct'\n+// @count - '//*[code=\"impl<T> MyTrait for T\"]' 1\n+pub trait MyTrait {}\n+\n+impl<T> MyTrait for T {}\n+\n+mod a {\n+    pub use issue_53689::MyStruct;\n+}"}]}