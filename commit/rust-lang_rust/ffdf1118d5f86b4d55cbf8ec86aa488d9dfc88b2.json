{"sha": "ffdf1118d5f86b4d55cbf8ec86aa488d9dfc88b2", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZmZGYxMTE4ZDVmODZiNGQ1NWNiZjhlYzg2YWE0ODhkOWRmYzg4YjI=", "commit": {"author": {"name": "Michael Sproul", "email": "micsproul@gmail.com", "date": "2015-01-17T19:31:55Z"}, "committer": {"name": "Michael Sproul", "email": "micsproul@gmail.com", "date": "2015-01-17T22:35:16Z"}, "message": "Implement the error trait for errors in std::sync.", "tree": {"sha": "2db64ca102e35eb65cb33986e2fd7849b7275c06", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2db64ca102e35eb65cb33986e2fd7849b7275c06"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ffdf1118d5f86b4d55cbf8ec86aa488d9dfc88b2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ffdf1118d5f86b4d55cbf8ec86aa488d9dfc88b2", "html_url": "https://github.com/rust-lang/rust/commit/ffdf1118d5f86b4d55cbf8ec86aa488d9dfc88b2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ffdf1118d5f86b4d55cbf8ec86aa488d9dfc88b2/comments", "author": {"login": "michaelsproul", "id": 4452260, "node_id": "MDQ6VXNlcjQ0NTIyNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelsproul", "html_url": "https://github.com/michaelsproul", "followers_url": "https://api.github.com/users/michaelsproul/followers", "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}", "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions", "organizations_url": "https://api.github.com/users/michaelsproul/orgs", "repos_url": "https://api.github.com/users/michaelsproul/repos", "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelsproul/received_events", "type": "User", "site_admin": false}, "committer": {"login": "michaelsproul", "id": 4452260, "node_id": "MDQ6VXNlcjQ0NTIyNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelsproul", "html_url": "https://github.com/michaelsproul", "followers_url": "https://api.github.com/users/michaelsproul/followers", "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}", "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions", "organizations_url": "https://api.github.com/users/michaelsproul/orgs", "repos_url": "https://api.github.com/users/michaelsproul/repos", "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelsproul/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f4f10dba2975b51c2d2c92157018db3ac13d4d4a", "url": "https://api.github.com/repos/rust-lang/rust/commits/f4f10dba2975b51c2d2c92157018db3ac13d4d4a", "html_url": "https://github.com/rust-lang/rust/commit/f4f10dba2975b51c2d2c92157018db3ac13d4d4a"}], "stats": {"total": 29, "additions": 23, "deletions": 6}, "files": [{"sha": "e28c3c37b6f765ee7df620998bd0359b5c04f4fe", "filename": "src/libstd/sync/poison.rs", "status": "modified", "additions": 23, "deletions": 6, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/ffdf1118d5f86b4d55cbf8ec86aa488d9dfc88b2/src%2Flibstd%2Fsync%2Fpoison.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ffdf1118d5f86b4d55cbf8ec86aa488d9dfc88b2/src%2Flibstd%2Fsync%2Fpoison.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsync%2Fpoison.rs?ref=ffdf1118d5f86b4d55cbf8ec86aa488d9dfc88b2", "patch": "@@ -11,7 +11,7 @@\n use prelude::v1::*;\n \n use cell::UnsafeCell;\n-use error::FromError;\n+use error::{Error, FromError};\n use fmt;\n use thread::Thread;\n \n@@ -92,7 +92,13 @@ pub type TryLockResult<Guard> = Result<Guard, TryLockError<Guard>>;\n \n impl<T> fmt::Show for PoisonError<T> {\n     fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\n-        \"poisoned lock: another task failed inside\".fmt(f)\n+        self.description().fmt(f)\n+    }\n+}\n+\n+impl<T> Error for PoisonError<T> {\n+    fn description(&self) -> &str {\n+        \"poisoned lock: another task failed inside\"\n     }\n }\n \n@@ -126,11 +132,22 @@ impl<T> FromError<PoisonError<T>> for TryLockError<T> {\n \n impl<T> fmt::Show for TryLockError<T> {\n     fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\n+        self.description().fmt(f)\n+    }\n+}\n+\n+impl<T> Error for TryLockError<T> {\n+    fn description(&self) -> &str {\n+        match *self {\n+            TryLockError::Poisoned(ref p) => p.description(),\n+            TryLockError::WouldBlock => \"try_lock failed because the operation would block\"\n+        }\n+    }\n+\n+    fn cause(&self) -> Option<&Error> {\n         match *self {\n-            TryLockError::Poisoned(ref p) => p.fmt(f),\n-            TryLockError::WouldBlock => {\n-                \"try_lock failed because the operation would block\".fmt(f)\n-            }\n+            TryLockError::Poisoned(ref p) => Some(p),\n+            _ => None\n         }\n     }\n }"}]}