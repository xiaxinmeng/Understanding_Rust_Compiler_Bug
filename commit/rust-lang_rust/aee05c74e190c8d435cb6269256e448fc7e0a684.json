{"sha": "aee05c74e190c8d435cb6269256e448fc7e0a684", "node_id": "C_kwDOAAsO6NoAKGFlZTA1Yzc0ZTE5MGM4ZDQzNWNiNjI2OTI1NmU0NDhmYzdlMGE2ODQ", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-05-31T09:19:08Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-05-31T09:19:08Z"}, "message": "Rollup merge of #111979 - jyn514:cargoflags, r=albertlarsan68\n\nRespect CARGOFLAGS in bootstrap.py\n\nThis makes it possible to pass flags to bootstrap itself, for consistency with std/rustc: https://github.com/rust-lang/rust/blob/04265621f9a82cfc2fc2278b935dcc5d4a1c39b7/src/bootstrap/builder.rs#L1446-L1447\nLike RUSTFLAGS, this doesn't support CARGOFLAGS_BOOTSTRAP: https://github.com/rust-lang/rust/blob/6674dcda7a1da4c66e0aa0cfc67b27e42f4ebb34/src/bootstrap/bootstrap.py#L883-L884\n\nI found this useful recently when I wanted to pass `-Zsparse-registry` to an old checkout of the compiler from before it was stabilized in cargo.", "tree": {"sha": "24e88a1687614790fbb1dd6d0bfb9caf6d8a86db", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/24e88a1687614790fbb1dd6d0bfb9caf6d8a86db"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/aee05c74e190c8d435cb6269256e448fc7e0a684", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkdxEMCRBK7hj4Ov3rIwAAy7EIADA/jf1IyztJVRZqxqjj1Sxb\nRNsnJRwZYCQ23GgLNX94wFAkZsw77MVJs6hlXi+ECY2XpZkGEIEaS1iX769GTh2I\ngp8hA8Vdg37YjIc6C77BUs6zq8b5/ZoyF36IiAhnphtlqKJEUUcDtihNw5OKdNFl\nJHbsN9zk97OIBH99H//V4hfHAhdn/jBGy8gPXhqLPdmENKwMpUx1nvEx1caN57LN\n92vkPBMZpxwa48pZHGponUtl8eI7VHdzoVE8opSIYqONA0R0BOcL3i+qFXqyvoQy\nXhTG8qqPqp4cY+vvNiV1uhoHj9UtdW0BuhXJDxGSqxFlRdk60YTs7QQoRtUD1eg=\n=RyLc\n-----END PGP SIGNATURE-----\n", "payload": "tree 24e88a1687614790fbb1dd6d0bfb9caf6d8a86db\nparent ef82bd4b5508f7b55ecae7f1b12613018fbf51ae\nparent 6674dcda7a1da4c66e0aa0cfc67b27e42f4ebb34\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1685524748 +0200\ncommitter GitHub <noreply@github.com> 1685524748 +0200\n\nRollup merge of #111979 - jyn514:cargoflags, r=albertlarsan68\n\nRespect CARGOFLAGS in bootstrap.py\n\nThis makes it possible to pass flags to bootstrap itself, for consistency with std/rustc: https://github.com/rust-lang/rust/blob/04265621f9a82cfc2fc2278b935dcc5d4a1c39b7/src/bootstrap/builder.rs#L1446-L1447\nLike RUSTFLAGS, this doesn't support CARGOFLAGS_BOOTSTRAP: https://github.com/rust-lang/rust/blob/6674dcda7a1da4c66e0aa0cfc67b27e42f4ebb34/src/bootstrap/bootstrap.py#L883-L884\n\nI found this useful recently when I wanted to pass `-Zsparse-registry` to an old checkout of the compiler from before it was stabilized in cargo.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/aee05c74e190c8d435cb6269256e448fc7e0a684", "html_url": "https://github.com/rust-lang/rust/commit/aee05c74e190c8d435cb6269256e448fc7e0a684", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/aee05c74e190c8d435cb6269256e448fc7e0a684/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ef82bd4b5508f7b55ecae7f1b12613018fbf51ae", "url": "https://api.github.com/repos/rust-lang/rust/commits/ef82bd4b5508f7b55ecae7f1b12613018fbf51ae", "html_url": "https://github.com/rust-lang/rust/commit/ef82bd4b5508f7b55ecae7f1b12613018fbf51ae"}, {"sha": "6674dcda7a1da4c66e0aa0cfc67b27e42f4ebb34", "url": "https://api.github.com/repos/rust-lang/rust/commits/6674dcda7a1da4c66e0aa0cfc67b27e42f4ebb34", "html_url": "https://github.com/rust-lang/rust/commit/6674dcda7a1da4c66e0aa0cfc67b27e42f4ebb34"}], "stats": {"total": 4, "additions": 4, "deletions": 0}, "files": [{"sha": "75df5345169276074936865e926afe5ca96c4266", "filename": "src/bootstrap/bootstrap.py", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/aee05c74e190c8d435cb6269256e448fc7e0a684/src%2Fbootstrap%2Fbootstrap.py", "raw_url": "https://github.com/rust-lang/rust/raw/aee05c74e190c8d435cb6269256e448fc7e0a684/src%2Fbootstrap%2Fbootstrap.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbootstrap.py?ref=aee05c74e190c8d435cb6269256e448fc7e0a684", "patch": "@@ -918,6 +918,10 @@ def build_bootstrap(self, color, verbose_count):\n             args.append(\"--color=always\")\n         elif color == \"never\":\n             args.append(\"--color=never\")\n+        try:\n+            args += env[\"CARGOFLAGS\"].split()\n+        except KeyError:\n+            pass\n \n         # Run this from the source directory so cargo finds .cargo/config\n         run(args, env=env, verbose=self.verbose, cwd=self.rust_root)"}]}