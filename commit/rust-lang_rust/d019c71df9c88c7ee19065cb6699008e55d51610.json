{"sha": "d019c71df9c88c7ee19065cb6699008e55d51610", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQwMTljNzFkZjljODhjN2VlMTkwNjVjYjY2OTkwMDhlNTVkNTE2MTA=", "commit": {"author": {"name": "Fabian Wolff", "email": "fabian.wolff@alumni.ethz.ch", "date": "2021-07-05T15:56:43Z"}, "committer": {"name": "Fabian Wolff", "email": "fabian.wolff@alumni.ethz.ch", "date": "2021-07-05T16:10:34Z"}, "message": "Fix double warning about illegal floating-point literal pattern", "tree": {"sha": "29dc4cbb4ea149572dd2e9f0d9221596c53324e4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/29dc4cbb4ea149572dd2e9f0d9221596c53324e4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d019c71df9c88c7ee19065cb6699008e55d51610", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d019c71df9c88c7ee19065cb6699008e55d51610", "html_url": "https://github.com/rust-lang/rust/commit/d019c71df9c88c7ee19065cb6699008e55d51610", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d019c71df9c88c7ee19065cb6699008e55d51610/comments", "author": {"login": "FabianWolff", "id": 16052130, "node_id": "MDQ6VXNlcjE2MDUyMTMw", "avatar_url": "https://avatars.githubusercontent.com/u/16052130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FabianWolff", "html_url": "https://github.com/FabianWolff", "followers_url": "https://api.github.com/users/FabianWolff/followers", "following_url": "https://api.github.com/users/FabianWolff/following{/other_user}", "gists_url": "https://api.github.com/users/FabianWolff/gists{/gist_id}", "starred_url": "https://api.github.com/users/FabianWolff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FabianWolff/subscriptions", "organizations_url": "https://api.github.com/users/FabianWolff/orgs", "repos_url": "https://api.github.com/users/FabianWolff/repos", "events_url": "https://api.github.com/users/FabianWolff/events{/privacy}", "received_events_url": "https://api.github.com/users/FabianWolff/received_events", "type": "User", "site_admin": false}, "committer": {"login": "FabianWolff", "id": 16052130, "node_id": "MDQ6VXNlcjE2MDUyMTMw", "avatar_url": "https://avatars.githubusercontent.com/u/16052130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FabianWolff", "html_url": "https://github.com/FabianWolff", "followers_url": "https://api.github.com/users/FabianWolff/followers", "following_url": "https://api.github.com/users/FabianWolff/following{/other_user}", "gists_url": "https://api.github.com/users/FabianWolff/gists{/gist_id}", "starred_url": "https://api.github.com/users/FabianWolff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FabianWolff/subscriptions", "organizations_url": "https://api.github.com/users/FabianWolff/orgs", "repos_url": "https://api.github.com/users/FabianWolff/repos", "events_url": "https://api.github.com/users/FabianWolff/events{/privacy}", "received_events_url": "https://api.github.com/users/FabianWolff/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5249414809d40fe22eca0c36105a2f71b9006e04", "url": "https://api.github.com/repos/rust-lang/rust/commits/5249414809d40fe22eca0c36105a2f71b9006e04", "html_url": "https://github.com/rust-lang/rust/commit/5249414809d40fe22eca0c36105a2f71b9006e04"}], "stats": {"total": 322, "additions": 50, "deletions": 272}, "files": [{"sha": "cb9c89324d6b3098b6b854dc0bd34914497b530c", "filename": "compiler/rustc_mir_build/src/thir/pattern/const_to_pat.rs", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/d019c71df9c88c7ee19065cb6699008e55d51610/compiler%2Frustc_mir_build%2Fsrc%2Fthir%2Fpattern%2Fconst_to_pat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d019c71df9c88c7ee19065cb6699008e55d51610/compiler%2Frustc_mir_build%2Fsrc%2Fthir%2Fpattern%2Fconst_to_pat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_build%2Fsrc%2Fthir%2Fpattern%2Fconst_to_pat.rs?ref=d019c71df9c88c7ee19065cb6699008e55d51610", "patch": "@@ -272,12 +272,14 @@ impl<'a, 'tcx> ConstToPat<'a, 'tcx> {\n \n         let kind = match cv.ty.kind() {\n             ty::Float(_) => {\n-                tcx.struct_span_lint_hir(\n-                    lint::builtin::ILLEGAL_FLOATING_POINT_LITERAL_PATTERN,\n-                    id,\n-                    span,\n-                    |lint| lint.build(\"floating-point types cannot be used in patterns\").emit(),\n-                );\n+                if self.include_lint_checks {\n+                    tcx.struct_span_lint_hir(\n+                        lint::builtin::ILLEGAL_FLOATING_POINT_LITERAL_PATTERN,\n+                        id,\n+                        span,\n+                        |lint| lint.build(\"floating-point types cannot be used in patterns\").emit(),\n+                    );\n+                }\n                 PatKind::Constant { value: cv }\n             }\n             ty::Adt(adt_def, _) if adt_def.is_union() => {"}, {"sha": "7f6a432d5ab1bcf2fc876bd91f8e6e065f8a27eb", "filename": "src/test/ui/deduplicate-diagnostics-2.deduplicate.stderr", "status": "removed", "additions": 0, "deletions": 30, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/5249414809d40fe22eca0c36105a2f71b9006e04/src%2Ftest%2Fui%2Fdeduplicate-diagnostics-2.deduplicate.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5249414809d40fe22eca0c36105a2f71b9006e04/src%2Ftest%2Fui%2Fdeduplicate-diagnostics-2.deduplicate.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdeduplicate-diagnostics-2.deduplicate.stderr?ref=5249414809d40fe22eca0c36105a2f71b9006e04", "patch": "@@ -1,30 +0,0 @@\n-warning: floating-point types cannot be used in patterns\n-  --> $DIR/deduplicate-diagnostics-2.rs:7:9\n-   |\n-LL |         1.0 => {}\n-   |         ^^^\n-   |\n-   = note: `#[warn(illegal_floating_point_literal_pattern)]` on by default\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-warning: floating-point types cannot be used in patterns\n-  --> $DIR/deduplicate-diagnostics-2.rs:11:9\n-   |\n-LL |         2.0 => {}\n-   |         ^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-warning: floating-point types cannot be used in patterns\n-  --> $DIR/deduplicate-diagnostics-2.rs:7:9\n-   |\n-LL |         1.0 => {}\n-   |         ^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-warning: 3 warnings emitted\n-"}, {"sha": "f2315bc91ec64cbb6e271766cc23197b7ab41621", "filename": "src/test/ui/deduplicate-diagnostics-2.duplicate.stderr", "status": "removed", "additions": 0, "deletions": 39, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/5249414809d40fe22eca0c36105a2f71b9006e04/src%2Ftest%2Fui%2Fdeduplicate-diagnostics-2.duplicate.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5249414809d40fe22eca0c36105a2f71b9006e04/src%2Ftest%2Fui%2Fdeduplicate-diagnostics-2.duplicate.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdeduplicate-diagnostics-2.duplicate.stderr?ref=5249414809d40fe22eca0c36105a2f71b9006e04", "patch": "@@ -1,39 +0,0 @@\n-warning: floating-point types cannot be used in patterns\n-  --> $DIR/deduplicate-diagnostics-2.rs:7:9\n-   |\n-LL |         1.0 => {}\n-   |         ^^^\n-   |\n-   = note: `#[warn(illegal_floating_point_literal_pattern)]` on by default\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-warning: floating-point types cannot be used in patterns\n-  --> $DIR/deduplicate-diagnostics-2.rs:11:9\n-   |\n-LL |         2.0 => {}\n-   |         ^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-warning: floating-point types cannot be used in patterns\n-  --> $DIR/deduplicate-diagnostics-2.rs:7:9\n-   |\n-LL |         1.0 => {}\n-   |         ^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-warning: floating-point types cannot be used in patterns\n-  --> $DIR/deduplicate-diagnostics-2.rs:11:9\n-   |\n-LL |         2.0 => {}\n-   |         ^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-warning: 4 warnings emitted\n-"}, {"sha": "f46a7c0c1c4d816954aeb64ad052ccb9c51ef426", "filename": "src/test/ui/deduplicate-diagnostics-2.rs", "status": "removed", "additions": 0, "deletions": 17, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/5249414809d40fe22eca0c36105a2f71b9006e04/src%2Ftest%2Fui%2Fdeduplicate-diagnostics-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5249414809d40fe22eca0c36105a2f71b9006e04/src%2Ftest%2Fui%2Fdeduplicate-diagnostics-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdeduplicate-diagnostics-2.rs?ref=5249414809d40fe22eca0c36105a2f71b9006e04", "patch": "@@ -1,17 +0,0 @@\n-// build-pass\n-// revisions: duplicate deduplicate\n-//[deduplicate] compile-flags: -Z deduplicate-diagnostics=yes\n-\n-fn main() {\n-    match 0.0 {\n-        1.0 => {} //~ WARNING floating-point types cannot be used in patterns\n-                  //~| WARNING this was previously accepted\n-                  //~| WARNING floating-point types cannot be used in patterns\n-                  //~| WARNING this was previously accepted\n-        2.0 => {} //~ WARNING floating-point types cannot be used in patterns\n-                  //~| WARNING this was previously accepted\n-                  //[duplicate]~| WARNING floating-point types cannot be used in patterns\n-                  //[duplicate]~| WARNING this was previously accepted\n-        _ => {}\n-    }\n-}"}, {"sha": "9d7072f1665d1520985eabbfbde2df995efa76e6", "filename": "src/test/ui/issues/issue-41255.rs", "status": "modified", "additions": 0, "deletions": 24, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Fissues%2Fissue-41255.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Fissues%2Fissue-41255.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-41255.rs?ref=d019c71df9c88c7ee19065cb6699008e55d51610", "patch": "@@ -10,65 +10,41 @@ fn main() {\n     match x {\n         5.0 => {}, //~ ERROR floating-point types cannot be used in patterns\n                    //~| WARNING hard error\n-                   //~| ERROR floating-point types cannot be used in patterns\n-                   //~| WARNING this was previously accepted by the compiler but is being\n         5.0f32 => {}, //~ ERROR floating-point types cannot be used in patterns\n-                      //~| ERROR floating-point types cannot be used in patterns\n-                      //~| WARNING hard error\n                       //~| WARNING hard error\n         -5.0 => {}, //~ ERROR floating-point types cannot be used in patterns\n-                    //~| ERROR floating-point types cannot be used in patterns\n-                    //~| WARNING hard error\n                     //~| WARNING hard error\n         1.0 .. 33.0 => {}, //~ ERROR floating-point types cannot be used in patterns\n                            //~| WARNING hard error\n                            //~| ERROR floating-point types cannot be used in patterns\n                            //~| WARNING hard error\n-                           //~| ERROR floating-point types cannot be used in patterns\n-                           //~| WARNING hard error\n-                           //~| ERROR floating-point types cannot be used in patterns\n-                           //~| WARNING hard error\n         39.0 ..= 70.0 => {}, //~ ERROR floating-point types cannot be used in patterns\n-                             //~| ERROR floating-point types cannot be used in patterns\n-                             //~| WARNING hard error\n-                             //~| ERROR floating-point types cannot be used in patterns\n                              //~| ERROR floating-point types cannot be used in patterns\n                              //~| WARNING hard error\n                              //~| WARNING hard error\n-                             //~| WARNING hard error\n \n         ..71.0 => {}\n         //~^ ERROR floating-point types cannot be used in patterns\n-        //~| ERROR floating-point types cannot be used in patterns\n-        //~| WARNING hard error\n         //~| WARNING this was previously accepted by the compiler\n         ..=72.0 => {}\n         //~^ ERROR floating-point types cannot be used in patterns\n-        //~| ERROR floating-point types cannot be used in patterns\n-        //~| WARNING hard error\n         //~| WARNING this was previously accepted by the compiler\n         71.0.. => {}\n         //~^ ERROR floating-point types cannot be used in patterns\n-        //~| ERROR floating-point types cannot be used in patterns\n-        //~| WARNING hard error\n         //~| WARNING this was previously accepted by the compiler\n         _ => {},\n     };\n     let y = 5.0;\n     // Same for tuples\n     match (x, 5) {\n         (3.14, 1) => {}, //~ ERROR floating-point types cannot be used\n-                         //~| ERROR floating-point types cannot be used\n-                         //~| WARNING hard error\n                          //~| WARNING hard error\n         _ => {},\n     }\n     // Or structs\n     struct Foo { x: f32 };\n     match (Foo { x }) {\n         Foo { x: 2.0 } => {}, //~ ERROR floating-point types cannot be used\n-                              //~| ERROR floating-point types cannot be used\n-                              //~| WARNING hard error\n                               //~| WARNING hard error\n         _ => {},\n     }"}, {"sha": "bf81c8d371c0b985fda0901b87964e78e242023f", "filename": "src/test/ui/issues/issue-41255.stderr", "status": "modified", "additions": 12, "deletions": 120, "changes": 132, "blob_url": "https://github.com/rust-lang/rust/blob/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Fissues%2Fissue-41255.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Fissues%2Fissue-41255.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-41255.stderr?ref=d019c71df9c88c7ee19065cb6699008e55d51610", "patch": "@@ -13,7 +13,7 @@ LL | #![forbid(illegal_floating_point_literal_pattern)]\n    = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n \n error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:15:9\n+  --> $DIR/issue-41255.rs:13:9\n    |\n LL |         5.0f32 => {},\n    |         ^^^^^^\n@@ -22,7 +22,7 @@ LL |         5.0f32 => {},\n    = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n \n error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:19:10\n+  --> $DIR/issue-41255.rs:15:10\n    |\n LL |         -5.0 => {},\n    |          ^^^\n@@ -31,7 +31,7 @@ LL |         -5.0 => {},\n    = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n \n error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:23:9\n+  --> $DIR/issue-41255.rs:17:9\n    |\n LL |         1.0 .. 33.0 => {},\n    |         ^^^\n@@ -40,7 +40,7 @@ LL |         1.0 .. 33.0 => {},\n    = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n \n error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:23:16\n+  --> $DIR/issue-41255.rs:17:16\n    |\n LL |         1.0 .. 33.0 => {},\n    |                ^^^^\n@@ -49,7 +49,7 @@ LL |         1.0 .. 33.0 => {},\n    = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n \n error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:31:9\n+  --> $DIR/issue-41255.rs:21:9\n    |\n LL |         39.0 ..= 70.0 => {},\n    |         ^^^^\n@@ -58,7 +58,7 @@ LL |         39.0 ..= 70.0 => {},\n    = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n \n error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:31:18\n+  --> $DIR/issue-41255.rs:21:18\n    |\n LL |         39.0 ..= 70.0 => {},\n    |                  ^^^^\n@@ -67,7 +67,7 @@ LL |         39.0 ..= 70.0 => {},\n    = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n \n error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:40:11\n+  --> $DIR/issue-41255.rs:26:11\n    |\n LL |         ..71.0 => {}\n    |           ^^^^\n@@ -76,7 +76,7 @@ LL |         ..71.0 => {}\n    = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n \n error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:45:12\n+  --> $DIR/issue-41255.rs:29:12\n    |\n LL |         ..=72.0 => {}\n    |            ^^^^\n@@ -85,7 +85,7 @@ LL |         ..=72.0 => {}\n    = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n \n error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:50:9\n+  --> $DIR/issue-41255.rs:32:9\n    |\n LL |         71.0.. => {}\n    |         ^^^^\n@@ -94,7 +94,7 @@ LL |         71.0.. => {}\n    = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n \n error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:60:10\n+  --> $DIR/issue-41255.rs:40:10\n    |\n LL |         (3.14, 1) => {},\n    |          ^^^^\n@@ -103,121 +103,13 @@ LL |         (3.14, 1) => {},\n    = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n \n error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:69:18\n+  --> $DIR/issue-41255.rs:47:18\n    |\n LL |         Foo { x: 2.0 } => {},\n    |                  ^^^\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n    = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n \n-error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:11:9\n-   |\n-LL |         5.0 => {},\n-   |         ^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:15:9\n-   |\n-LL |         5.0f32 => {},\n-   |         ^^^^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:19:10\n-   |\n-LL |         -5.0 => {},\n-   |          ^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:23:9\n-   |\n-LL |         1.0 .. 33.0 => {},\n-   |         ^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:23:16\n-   |\n-LL |         1.0 .. 33.0 => {},\n-   |                ^^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:31:9\n-   |\n-LL |         39.0 ..= 70.0 => {},\n-   |         ^^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:31:18\n-   |\n-LL |         39.0 ..= 70.0 => {},\n-   |                  ^^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:40:11\n-   |\n-LL |         ..71.0 => {}\n-   |           ^^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:45:12\n-   |\n-LL |         ..=72.0 => {}\n-   |            ^^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:50:9\n-   |\n-LL |         71.0.. => {}\n-   |         ^^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:60:10\n-   |\n-LL |         (3.14, 1) => {},\n-   |          ^^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-41255.rs:69:18\n-   |\n-LL |         Foo { x: 2.0 } => {},\n-   |                  ^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-error: aborting due to 24 previous errors\n+error: aborting due to 12 previous errors\n "}, {"sha": "0260caa82cb1d33a1cb0f17f9ed68e73b2b57ff3", "filename": "src/test/ui/issues/issue-6804.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Fissues%2Fissue-6804.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Fissues%2Fissue-6804.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-6804.rs?ref=d019c71df9c88c7ee19065cb6699008e55d51610", "patch": "@@ -9,16 +9,12 @@ fn main() {\n     let x = NAN;\n     match x {\n         NAN => {}, //~ ERROR floating-point types cannot be used\n-        //~^ WARN this was previously accepted by the compiler but is being phased out\n-        //~| ERROR floating-point types cannot be used in patterns\n         //~| WARN this was previously accepted by the compiler but is being phased out\n         _ => {},\n     };\n \n     match [x, 1.0] {\n         [NAN, _] => {}, //~ ERROR floating-point types cannot be used\n-                        //~| ERROR floating-point types cannot be used\n-        //~| WARN this was previously accepted by the compiler but is being phased out\n         //~| WARN this was previously accepted by the compiler but is being phased out\n         _ => {},\n     };"}, {"sha": "4e2961e5e23be4a15dba1e58a8f6e69ee769ddc3", "filename": "src/test/ui/issues/issue-6804.stderr", "status": "modified", "additions": 2, "deletions": 20, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Fissues%2Fissue-6804.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Fissues%2Fissue-6804.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-6804.stderr?ref=d019c71df9c88c7ee19065cb6699008e55d51610", "patch": "@@ -13,31 +13,13 @@ LL | #![deny(illegal_floating_point_literal_pattern)]\n    = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n \n error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-6804.rs:19:10\n+  --> $DIR/issue-6804.rs:17:10\n    |\n LL |         [NAN, _] => {},\n    |          ^^^\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n    = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n \n-error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-6804.rs:11:9\n-   |\n-LL |         NAN => {},\n-   |         ^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-error: floating-point types cannot be used in patterns\n-  --> $DIR/issue-6804.rs:19:10\n-   |\n-LL |         [NAN, _] => {},\n-   |          ^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-error: aborting due to 4 previous errors\n+error: aborting due to 2 previous errors\n "}, {"sha": "0e8a837d987f6b48c598ef0eb80bfb00d7856833", "filename": "src/test/ui/lint/issue-86600-lint-twice.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Flint%2Fissue-86600-lint-twice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Flint%2Fissue-86600-lint-twice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fissue-86600-lint-twice.rs?ref=d019c71df9c88c7ee19065cb6699008e55d51610", "patch": "@@ -0,0 +1,15 @@\n+// Regression test for #86600, where an instance of the\n+// `illegal_floating_point_literal_pattern` lint was issued twice.\n+\n+// check-pass\n+\n+fn main() {\n+    let x = 42.0;\n+\n+    match x {\n+        5.0 => {}\n+        //~^ WARNING: floating-point types cannot be used in patterns\n+        //~| WARNING: this was previously accepted by the compiler\n+        _ => {}\n+    }\n+}"}, {"sha": "8da3fb5a8394a68b7c3157460ff9211d5c1e7417", "filename": "src/test/ui/lint/issue-86600-lint-twice.stderr", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Flint%2Fissue-86600-lint-twice.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Flint%2Fissue-86600-lint-twice.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fissue-86600-lint-twice.stderr?ref=d019c71df9c88c7ee19065cb6699008e55d51610", "patch": "@@ -0,0 +1,12 @@\n+warning: floating-point types cannot be used in patterns\n+  --> $DIR/issue-86600-lint-twice.rs:10:9\n+   |\n+LL |         5.0 => {}\n+   |         ^^^\n+   |\n+   = note: `#[warn(illegal_floating_point_literal_pattern)]` on by default\n+   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n+   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n+\n+warning: 1 warning emitted\n+"}, {"sha": "59a22c33778c5f14583620b97138ba8ff8409df2", "filename": "src/test/ui/rfc-1445-restrict-constants-in-patterns/match-forbidden-without-eq.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Frfc-1445-restrict-constants-in-patterns%2Fmatch-forbidden-without-eq.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Frfc-1445-restrict-constants-in-patterns%2Fmatch-forbidden-without-eq.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-1445-restrict-constants-in-patterns%2Fmatch-forbidden-without-eq.rs?ref=d019c71df9c88c7ee19065cb6699008e55d51610", "patch": "@@ -17,8 +17,6 @@ fn main() {\n     match x {\n         f32::INFINITY => { }\n         //~^ WARNING floating-point types cannot be used in patterns\n-        //~| WARNING will become a hard error in a future release\n-        //~| WARNING floating-point types cannot be used in patterns\n         //~| WARNING this was previously accepted by the compiler but is being phased out\n         _ => { }\n     }"}, {"sha": "df4809dabf159beae8fc19dddb3c55e882017450", "filename": "src/test/ui/rfc-1445-restrict-constants-in-patterns/match-forbidden-without-eq.stderr", "status": "modified", "additions": 1, "deletions": 10, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Frfc-1445-restrict-constants-in-patterns%2Fmatch-forbidden-without-eq.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d019c71df9c88c7ee19065cb6699008e55d51610/src%2Ftest%2Fui%2Frfc-1445-restrict-constants-in-patterns%2Fmatch-forbidden-without-eq.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-1445-restrict-constants-in-patterns%2Fmatch-forbidden-without-eq.stderr?ref=d019c71df9c88c7ee19065cb6699008e55d51610", "patch": "@@ -14,14 +14,5 @@ LL |         f32::INFINITY => { }\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n    = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n \n-warning: floating-point types cannot be used in patterns\n-  --> $DIR/match-forbidden-without-eq.rs:18:9\n-   |\n-LL |         f32::INFINITY => { }\n-   |         ^^^^^^^^^^^^^\n-   |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #41620 <https://github.com/rust-lang/rust/issues/41620>\n-\n-error: aborting due to previous error; 2 warnings emitted\n+error: aborting due to previous error; 1 warning emitted\n "}]}