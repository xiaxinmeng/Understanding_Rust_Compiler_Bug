{"sha": "4728433c9ec07814b15868cb092afa2d60963cee", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ3Mjg0MzNjOWVjMDc4MTRiMTU4NjhjYjA5MmFmYTJkNjA5NjNjZWU=", "commit": {"author": {"name": "Andy Russell", "email": "arussell123@gmail.com", "date": "2018-10-19T00:34:01Z"}, "committer": {"name": "Andy Russell", "email": "arussell123@gmail.com", "date": "2019-03-24T16:21:03Z"}, "message": "make asm diagnostic instruction optional\n\n`DiagnosticInfoInlineAsm::getInstruction` may return a null pointer, so\nthe instruction shouldn't be blindly unwrapped.", "tree": {"sha": "e4dd8d429e8a55efe5eee897d9a1611edd2e1187", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e4dd8d429e8a55efe5eee897d9a1611edd2e1187"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4728433c9ec07814b15868cb092afa2d60963cee", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQFKBAABCAA0FiEELriChyEaiMu0yCg7viIhAz7bw3QFAlyXrnMWHGFydXNzZWxs\nMTIzQGdtYWlsLmNvbQAKCRC+IiEDPtvDdAjEB/9QNr9qIVwuJlfZT1tAO/l09vy7\nt7NEXQAc9zK2SPo/+H2xz+3HaNXa4b/Du0+i15njSG0N3juN4/F33gzr78SNoQh8\n2rBTmVIboLqLPkXvA4iBa26gJbcLRB0zTfanQVjzbafAhnn3o8DFFnD+FJ6bIv1Y\nYMrc7rvI3HS0v9GT+N6SAyBhAsHIWCHyzuHGLY2BQjccGn3ehtGvOyFj/OQy0tr8\nQF82su/BNNUyKdyuc9Bl2Qzc5K5knT87l69o6iDY9urul4PQGUpD4Ry69a7t+UlS\nqRDQ/Kf3TF4sjL/0cTdcb+Z618pgNwk5ifzznAaC9ijsVu5UyvwajsRpQ//t\n=DVUf\n-----END PGP SIGNATURE-----", "payload": "tree e4dd8d429e8a55efe5eee897d9a1611edd2e1187\nparent 0633c55d2030969d91b57142b8582c53101e6339\nauthor Andy Russell <arussell123@gmail.com> 1539909241 -0400\ncommitter Andy Russell <arussell123@gmail.com> 1553444463 -0400\n\nmake asm diagnostic instruction optional\n\n`DiagnosticInfoInlineAsm::getInstruction` may return a null pointer, so\nthe instruction shouldn't be blindly unwrapped.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4728433c9ec07814b15868cb092afa2d60963cee", "html_url": "https://github.com/rust-lang/rust/commit/4728433c9ec07814b15868cb092afa2d60963cee", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4728433c9ec07814b15868cb092afa2d60963cee/comments", "author": {"login": "euclio", "id": 1372438, "node_id": "MDQ6VXNlcjEzNzI0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1372438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/euclio", "html_url": "https://github.com/euclio", "followers_url": "https://api.github.com/users/euclio/followers", "following_url": "https://api.github.com/users/euclio/following{/other_user}", "gists_url": "https://api.github.com/users/euclio/gists{/gist_id}", "starred_url": "https://api.github.com/users/euclio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/euclio/subscriptions", "organizations_url": "https://api.github.com/users/euclio/orgs", "repos_url": "https://api.github.com/users/euclio/repos", "events_url": "https://api.github.com/users/euclio/events{/privacy}", "received_events_url": "https://api.github.com/users/euclio/received_events", "type": "User", "site_admin": false}, "committer": {"login": "euclio", "id": 1372438, "node_id": "MDQ6VXNlcjEzNzI0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1372438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/euclio", "html_url": "https://github.com/euclio", "followers_url": "https://api.github.com/users/euclio/followers", "following_url": "https://api.github.com/users/euclio/following{/other_user}", "gists_url": "https://api.github.com/users/euclio/gists{/gist_id}", "starred_url": "https://api.github.com/users/euclio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/euclio/subscriptions", "organizations_url": "https://api.github.com/users/euclio/orgs", "repos_url": "https://api.github.com/users/euclio/repos", "events_url": "https://api.github.com/users/euclio/events{/privacy}", "received_events_url": "https://api.github.com/users/euclio/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0633c55d2030969d91b57142b8582c53101e6339", "url": "https://api.github.com/repos/rust-lang/rust/commits/0633c55d2030969d91b57142b8582c53101e6339", "html_url": "https://github.com/rust-lang/rust/commit/0633c55d2030969d91b57142b8582c53101e6339"}], "stats": {"total": 31, "additions": 29, "deletions": 2}, "files": [{"sha": "04e65ac4233002b3796957ebdd3443a54928cbb8", "filename": "src/librustc_codegen_llvm/llvm/diagnostic.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4728433c9ec07814b15868cb092afa2d60963cee/src%2Flibrustc_codegen_llvm%2Fllvm%2Fdiagnostic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4728433c9ec07814b15868cb092afa2d60963cee/src%2Flibrustc_codegen_llvm%2Fllvm%2Fdiagnostic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fllvm%2Fdiagnostic.rs?ref=4728433c9ec07814b15868cb092afa2d60963cee", "patch": "@@ -88,7 +88,7 @@ impl OptimizationDiagnostic<'ll> {\n pub struct InlineAsmDiagnostic<'ll> {\n     pub cookie: c_uint,\n     pub message: &'ll Twine,\n-    pub instruction: &'ll Value,\n+    pub instruction: Option<&'ll Value>,\n }\n \n impl InlineAsmDiagnostic<'ll> {\n@@ -107,7 +107,7 @@ impl InlineAsmDiagnostic<'ll> {\n         InlineAsmDiagnostic {\n             cookie,\n             message: message.unwrap(),\n-            instruction: instruction.unwrap(),\n+            instruction,\n         }\n     }\n }"}, {"sha": "90b3f1f9714b216c5cec4c50ec4e0133df181129", "filename": "src/test/ui/issues/issue-23458.rs", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/4728433c9ec07814b15868cb092afa2d60963cee/src%2Ftest%2Fui%2Fissues%2Fissue-23458.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4728433c9ec07814b15868cb092afa2d60963cee/src%2Ftest%2Fui%2Fissues%2Fissue-23458.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-23458.rs?ref=4728433c9ec07814b15868cb092afa2d60963cee", "patch": "@@ -0,0 +1,10 @@\n+#![feature(asm)]\n+\n+// only-x86_64\n+\n+fn main() {\n+    unsafe {\n+        asm!(\"int $3\"); //~ ERROR too few operands for instruction\n+                        //~| ERROR invalid operand in inline asm\n+    }\n+}"}, {"sha": "aff0f82af6fdce567ca2bbcc8d13c23096bdafdb", "filename": "src/test/ui/issues/issue-23458.stderr", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/4728433c9ec07814b15868cb092afa2d60963cee/src%2Ftest%2Fui%2Fissues%2Fissue-23458.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4728433c9ec07814b15868cb092afa2d60963cee/src%2Ftest%2Fui%2Fissues%2Fissue-23458.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-23458.stderr?ref=4728433c9ec07814b15868cb092afa2d60963cee", "patch": "@@ -0,0 +1,17 @@\n+error: invalid operand in inline asm: 'int $3'\n+  --> $DIR/issue-23458.rs:7:9\n+   |\n+LL |         asm!(\"int $3\");\n+   |         ^^^^^^^^^^^^^^^\n+\n+error: <inline asm>:1:2: error: too few operands for instruction\n+        int \n+        ^\n+\n+  --> $DIR/issue-23458.rs:7:9\n+   |\n+LL |         asm!(\"int $3\");\n+   |         ^^^^^^^^^^^^^^^\n+\n+error: aborting due to 2 previous errors\n+"}]}