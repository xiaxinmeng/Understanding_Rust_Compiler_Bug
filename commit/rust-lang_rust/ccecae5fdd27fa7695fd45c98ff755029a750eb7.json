{"sha": "ccecae5fdd27fa7695fd45c98ff755029a750eb7", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNjZWNhZTVmZGQyN2ZhNzY5NWZkNDVjOThmZjc1NTAyOWE3NTBlYjc=", "commit": {"author": {"name": "Josh Stone", "email": "jistone@redhat.com", "date": "2020-04-17T20:59:14Z"}, "committer": {"name": "Josh Stone", "email": "jistone@redhat.com", "date": "2020-04-17T20:59:14Z"}, "message": "Fix unused results from mem::replace", "tree": {"sha": "805b8f0ac90ac90ac76588663dbf98dc7bd0d689", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/805b8f0ac90ac90ac76588663dbf98dc7bd0d689"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ccecae5fdd27fa7695fd45c98ff755029a750eb7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ccecae5fdd27fa7695fd45c98ff755029a750eb7", "html_url": "https://github.com/rust-lang/rust/commit/ccecae5fdd27fa7695fd45c98ff755029a750eb7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ccecae5fdd27fa7695fd45c98ff755029a750eb7/comments", "author": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7c4ca59f4b10d20f0f3e902f847641311abb093c", "url": "https://api.github.com/repos/rust-lang/rust/commits/7c4ca59f4b10d20f0f3e902f847641311abb093c", "html_url": "https://github.com/rust-lang/rust/commit/7c4ca59f4b10d20f0f3e902f847641311abb093c"}], "stats": {"total": 28, "additions": 14, "deletions": 14}, "files": [{"sha": "549933ceeb6457f13813fbced35c37effe67a12f", "filename": "src/libcore/marker.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Flibcore%2Fmarker.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Flibcore%2Fmarker.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fmarker.rs?ref=ccecae5fdd27fa7695fd45c98ff755029a750eb7", "patch": "@@ -709,6 +709,7 @@ unsafe impl<T: ?Sized> Freeze for &mut T {}\n /// So this, for example, can only be done on types implementing `Unpin`:\n ///\n /// ```rust\n+/// # #![allow(unused_must_use)]\n /// use std::mem;\n /// use std::pin::Pin;\n ///"}, {"sha": "a04a1b220fee130553f41ffe9d1af9c523dbca63", "filename": "src/librustc_parse/parser/expr.rs", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Flibrustc_parse%2Fparser%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Flibrustc_parse%2Fparser%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_parse%2Fparser%2Fexpr.rs?ref=ccecae5fdd27fa7695fd45c98ff755029a750eb7", "patch": "@@ -547,8 +547,7 @@ impl<'a> Parser<'a> {\n                 // Rewind to before attempting to parse the type with generics, to recover\n                 // from situations like `x as usize < y` in which we first tried to parse\n                 // `usize < y` as a type with generic arguments.\n-                let parser_snapshot_after_type = self.clone();\n-                mem::replace(self, parser_snapshot_before_type);\n+                let parser_snapshot_after_type = mem::replace(self, parser_snapshot_before_type);\n \n                 match self.parse_path(PathStyle::Expr) {\n                     Ok(path) => {\n@@ -560,7 +559,7 @@ impl<'a> Parser<'a> {\n                                 // example because `parse_ty_no_plus` returns `Err` on keywords,\n                                 // but `parse_path` returns `Ok` on them due to error recovery.\n                                 // Return original error and parser state.\n-                                mem::replace(self, parser_snapshot_after_type);\n+                                *self = parser_snapshot_after_type;\n                                 return Err(type_err);\n                             }\n                         };\n@@ -601,7 +600,7 @@ impl<'a> Parser<'a> {\n                     Err(mut path_err) => {\n                         // Couldn't parse as a path, return original error and parser state.\n                         path_err.cancel();\n-                        mem::replace(self, parser_snapshot_after_type);\n+                        *self = parser_snapshot_after_type;\n                         return Err(type_err);\n                     }\n                 }"}, {"sha": "85e0414369a2abdaefede25ae0acee6dfb109402", "filename": "src/librustc_parse/parser/generics.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Flibrustc_parse%2Fparser%2Fgenerics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Flibrustc_parse%2Fparser%2Fgenerics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_parse%2Fparser%2Fgenerics.rs?ref=ccecae5fdd27fa7695fd45c98ff755029a750eb7", "patch": "@@ -105,7 +105,7 @@ impl<'a> Parser<'a> {\n                     }\n                     Err(mut err) => {\n                         err.cancel();\n-                        std::mem::replace(self, snapshot);\n+                        *self = snapshot;\n                         break;\n                     }\n                 }"}, {"sha": "0496b0f334838e5b8f768af9915307817278f7c1", "filename": "src/librustc_parse/parser/item.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Flibrustc_parse%2Fparser%2Fitem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Flibrustc_parse%2Fparser%2Fitem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_parse%2Fparser%2Fitem.rs?ref=ccecae5fdd27fa7695fd45c98ff755029a750eb7", "patch": "@@ -1650,7 +1650,7 @@ impl<'a> Parser<'a> {\n                 // Recover from attempting to parse the argument as a type without pattern.\n                 Err(mut err) => {\n                     err.cancel();\n-                    mem::replace(self, parser_snapshot_before_ty);\n+                    *self = parser_snapshot_before_ty;\n                     self.recover_arg_parse()?\n                 }\n             }"}, {"sha": "e5d0ab247aa46ed4a9bcf0d61f3af0df96f11582", "filename": "src/librustc_parse/parser/stmt.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Flibrustc_parse%2Fparser%2Fstmt.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Flibrustc_parse%2Fparser%2Fstmt.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_parse%2Fparser%2Fstmt.rs?ref=ccecae5fdd27fa7695fd45c98ff755029a750eb7", "patch": "@@ -163,8 +163,8 @@ impl<'a> Parser<'a> {\n                 Ok(ty) => (None, Some(ty)),\n                 Err(mut err) => {\n                     // Rewind to before attempting to parse the type and continue parsing.\n-                    let parser_snapshot_after_type = self.clone();\n-                    mem::replace(self, parser_snapshot_before_type);\n+                    let parser_snapshot_after_type =\n+                        mem::replace(self, parser_snapshot_before_type);\n                     if let Ok(snip) = self.span_to_snippet(pat.span) {\n                         err.span_label(pat.span, format!(\"while parsing the type for `{}`\", snip));\n                     }\n@@ -201,7 +201,7 @@ impl<'a> Parser<'a> {\n                 // Couldn't parse the type nor the initializer, only raise the type error and\n                 // return to the parser state before parsing the type as the initializer.\n                 // let x: <parse_error>;\n-                mem::replace(self, snapshot);\n+                *self = snapshot;\n                 return Err(ty_err);\n             }\n             (Err(err), None) => {"}, {"sha": "34725d2d5234b9cb4912666d68deb8bf8774c99d", "filename": "src/librustc_resolve/late/lifetimes.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Flibrustc_resolve%2Flate%2Flifetimes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Flibrustc_resolve%2Flate%2Flifetimes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Flate%2Flifetimes.rs?ref=ccecae5fdd27fa7695fd45c98ff755029a750eb7", "patch": "@@ -26,7 +26,7 @@ use rustc_span::symbol::{kw, sym};\n use rustc_span::Span;\n use std::borrow::Cow;\n use std::cell::Cell;\n-use std::mem::{replace, take};\n+use std::mem::take;\n \n use log::debug;\n \n@@ -371,7 +371,7 @@ impl<'a, 'tcx> Visitor<'tcx> for LifetimeContext<'a, 'tcx> {\n         self.with(Scope::Body { id: body.id(), s: self.scope }, |_, this| {\n             this.visit_body(body);\n         });\n-        replace(&mut self.labels_in_fn, saved);\n+        self.labels_in_fn = saved;\n     }\n \n     fn visit_item(&mut self, item: &'tcx hir::Item<'tcx>) {"}, {"sha": "094c468a6770e25f5d2bcc37e530d42b0cd08d3a", "filename": "src/libstd/thread/local.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Flibstd%2Fthread%2Flocal.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Flibstd%2Fthread%2Flocal.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fthread%2Flocal.rs?ref=ccecae5fdd27fa7695fd45c98ff755029a750eb7", "patch": "@@ -301,7 +301,7 @@ mod lazy {\n             // value (an aliasing violation). To avoid setting the \"I'm running a\n             // destructor\" flag we just use `mem::replace` which should sequence the\n             // operations a little differently and make this safe to call.\n-            mem::replace(&mut *ptr, Some(value));\n+            let _ = mem::replace(&mut *ptr, Some(value));\n \n             // After storing `Some` we want to get a reference to the contents of\n             // what we just stored. While we could use `unwrap` here and it should"}, {"sha": "19703904ece91923cde03c7a0b5321920edd03c3", "filename": "src/test/ui/imports/import-in-block.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Ftest%2Fui%2Fimports%2Fimport-in-block.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Ftest%2Fui%2Fimports%2Fimport-in-block.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimports%2Fimport-in-block.rs?ref=ccecae5fdd27fa7695fd45c98ff755029a750eb7", "patch": "@@ -4,7 +4,7 @@\n pub fn main() {\n     use std::mem::replace;\n     let mut x = 5;\n-    replace(&mut x, 6);\n+    let _ = replace(&mut x, 6);\n     {\n         use std::mem::*;\n         let mut y = 6;"}, {"sha": "8e4319a8b18ec2b15ec3b28f5da028936430b6ee", "filename": "src/test/ui/issues/issue-23611-enum-swap-in-drop.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Ftest%2Fui%2Fissues%2Fissue-23611-enum-swap-in-drop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ccecae5fdd27fa7695fd45c98ff755029a750eb7/src%2Ftest%2Fui%2Fissues%2Fissue-23611-enum-swap-in-drop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-23611-enum-swap-in-drop.rs?ref=ccecae5fdd27fa7695fd45c98ff755029a750eb7", "patch": "@@ -154,7 +154,7 @@ impl<'a> Drop for E<'a> {\n         };\n \n         if do_drop {\n-            mem::replace(self, E::A(GaspA(f_a, 0xA3A0, log, D::new(\"drop\", 6, log)), true));\n+            let _ = mem::replace(self, E::A(GaspA(f_a, 0xA3A0, log, D::new(\"drop\", 6, log)), true));\n         }\n     }\n }"}]}