{"sha": "6bc0357dadd9d41a8166d4c2ab8a27c0bb8150d3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZiYzAzNTdkYWRkOWQ0MWE4MTY2ZDRjMmFiOGEyN2MwYmI4MTUwZDM=", "commit": {"author": {"name": "Alexis Bourget", "email": "alexis.bourget@gmail.com", "date": "2020-09-10T13:41:16Z"}, "committer": {"name": "Alexis Bourget", "email": "alexis.bourget@gmail.com", "date": "2020-09-21T19:50:27Z"}, "message": "Move vec-cycle test", "tree": {"sha": "b5ea412aa68591fb7234e326df7a94862af8373f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b5ea412aa68591fb7234e326df7a94862af8373f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6bc0357dadd9d41a8166d4c2ab8a27c0bb8150d3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6bc0357dadd9d41a8166d4c2ab8a27c0bb8150d3", "html_url": "https://github.com/rust-lang/rust/commit/6bc0357dadd9d41a8166d4c2ab8a27c0bb8150d3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6bc0357dadd9d41a8166d4c2ab8a27c0bb8150d3/comments", "author": {"login": "poliorcetics", "id": 7951708, "node_id": "MDQ6VXNlcjc5NTE3MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/7951708?v=4", "gravatar_id": "", "url": "https://api.github.com/users/poliorcetics", "html_url": "https://github.com/poliorcetics", "followers_url": "https://api.github.com/users/poliorcetics/followers", "following_url": "https://api.github.com/users/poliorcetics/following{/other_user}", "gists_url": "https://api.github.com/users/poliorcetics/gists{/gist_id}", "starred_url": "https://api.github.com/users/poliorcetics/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/poliorcetics/subscriptions", "organizations_url": "https://api.github.com/users/poliorcetics/orgs", "repos_url": "https://api.github.com/users/poliorcetics/repos", "events_url": "https://api.github.com/users/poliorcetics/events{/privacy}", "received_events_url": "https://api.github.com/users/poliorcetics/received_events", "type": "User", "site_admin": false}, "committer": {"login": "poliorcetics", "id": 7951708, "node_id": "MDQ6VXNlcjc5NTE3MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/7951708?v=4", "gravatar_id": "", "url": "https://api.github.com/users/poliorcetics", "html_url": "https://github.com/poliorcetics", "followers_url": "https://api.github.com/users/poliorcetics/followers", "following_url": "https://api.github.com/users/poliorcetics/following{/other_user}", "gists_url": "https://api.github.com/users/poliorcetics/gists{/gist_id}", "starred_url": "https://api.github.com/users/poliorcetics/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/poliorcetics/subscriptions", "organizations_url": "https://api.github.com/users/poliorcetics/orgs", "repos_url": "https://api.github.com/users/poliorcetics/repos", "events_url": "https://api.github.com/users/poliorcetics/events{/privacy}", "received_events_url": "https://api.github.com/users/poliorcetics/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "275eed7eb1d45e8173b932e2abfdae2201d2cf62", "url": "https://api.github.com/repos/rust-lang/rust/commits/275eed7eb1d45e8173b932e2abfdae2201d2cf62", "html_url": "https://github.com/rust-lang/rust/commit/275eed7eb1d45e8173b932e2abfdae2201d2cf62"}], "stats": {"total": 78, "additions": 39, "deletions": 39}, "files": [{"sha": "d93de65d3d8d7244fa4a73ea91f79762e4ce3ca4", "filename": "library/alloc/tests/vec.rs", "status": "modified", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/6bc0357dadd9d41a8166d4c2ab8a27c0bb8150d3/library%2Falloc%2Ftests%2Fvec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6bc0357dadd9d41a8166d4c2ab8a27c0bb8150d3/library%2Falloc%2Ftests%2Fvec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Ftests%2Fvec.rs?ref=6bc0357dadd9d41a8166d4c2ab8a27c0bb8150d3", "patch": "@@ -1,4 +1,5 @@\n use std::borrow::Cow;\n+use std::cell::Cell;\n use std::collections::TryReserveError::*;\n use std::fmt::Debug;\n use std::iter::InPlaceIterable;\n@@ -1831,3 +1832,41 @@ fn partialeq_vec_full() {\n     assert_partial_eq_valid!(vec2,vec3; array2,array3);\n     assert_partial_eq_valid!(vec2,vec3; arrayref2,arrayref3);\n }\n+\n+#[test]\n+fn test_vec_cycle() {\n+    #[derive(Debug)]\n+    struct C<'a> {\n+        v: Vec<Cell<Option<&'a C<'a>>>>,\n+    }\n+\n+    impl<'a> C<'a> {\n+        fn new() -> C<'a> {\n+            C { v: Vec::new() }\n+        }\n+    }\n+\n+    let mut c1 = C::new();\n+    let mut c2 = C::new();\n+    let mut c3 = C::new();\n+\n+    // Push\n+    c1.v.push(Cell::new(None));\n+    c1.v.push(Cell::new(None));\n+\n+    c2.v.push(Cell::new(None));\n+    c2.v.push(Cell::new(None));\n+\n+    c3.v.push(Cell::new(None));\n+    c3.v.push(Cell::new(None));\n+\n+    // Set\n+    c1.v[0].set(Some(&c2));\n+    c1.v[1].set(Some(&c3));\n+\n+    c2.v[0].set(Some(&c2));\n+    c2.v[1].set(Some(&c3));\n+\n+    c3.v[0].set(Some(&c1));\n+    c3.v[1].set(Some(&c2));\n+}"}, {"sha": "82bce437282628cf7f41ad34b870006fd94c9e5d", "filename": "src/test/ui/array-slice-vec/vec_cycle.rs", "status": "removed", "additions": 0, "deletions": 39, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/275eed7eb1d45e8173b932e2abfdae2201d2cf62/src%2Ftest%2Fui%2Farray-slice-vec%2Fvec_cycle.rs", "raw_url": "https://github.com/rust-lang/rust/raw/275eed7eb1d45e8173b932e2abfdae2201d2cf62/src%2Ftest%2Fui%2Farray-slice-vec%2Fvec_cycle.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Farray-slice-vec%2Fvec_cycle.rs?ref=275eed7eb1d45e8173b932e2abfdae2201d2cf62", "patch": "@@ -1,39 +0,0 @@\n-// run-pass\n-\n-use std::cell::Cell;\n-\n-#[derive(Debug)]\n-struct C<'a> {\n-    v: Vec<Cell<Option<&'a C<'a>>>>,\n-}\n-\n-impl<'a> C<'a> {\n-    fn new() -> C<'a> {\n-        C { v: Vec::new() }\n-    }\n-}\n-\n-fn f() {\n-    let (mut c1, mut c2, mut c3);\n-    c1 = C::new();\n-    c2 = C::new();\n-    c3 = C::new();\n-\n-    c1.v.push(Cell::new(None));\n-    c1.v.push(Cell::new(None));\n-    c2.v.push(Cell::new(None));\n-    c2.v.push(Cell::new(None));\n-    c3.v.push(Cell::new(None));\n-    c3.v.push(Cell::new(None));\n-\n-    c1.v[0].set(Some(&c2));\n-    c1.v[1].set(Some(&c3));\n-    c2.v[0].set(Some(&c2));\n-    c2.v[1].set(Some(&c3));\n-    c3.v[0].set(Some(&c1));\n-    c3.v[1].set(Some(&c2));\n-}\n-\n-fn main() {\n-    f();\n-}"}]}