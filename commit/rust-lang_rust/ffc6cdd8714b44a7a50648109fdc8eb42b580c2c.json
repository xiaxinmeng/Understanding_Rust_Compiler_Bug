{"sha": "ffc6cdd8714b44a7a50648109fdc8eb42b580c2c", "node_id": "C_kwDOAAsO6NoAKGZmYzZjZGQ4NzE0YjQ0YTdhNTA2NDgxMDlmZGM4ZWI0MmI1ODBjMmM", "commit": {"author": {"name": "Dezhi Wu", "email": "wu543065657@163.com", "date": "2021-10-28T02:13:43Z"}, "committer": {"name": "Dezhi Wu", "email": "wu543065657@163.com", "date": "2021-10-28T02:13:43Z"}, "message": "Fix: transform the asciidoc form link to markdown style when generating the package.json", "tree": {"sha": "afda1872badc2bbba118832067da25848d7101ae", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/afda1872badc2bbba118832067da25848d7101ae"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ffc6cdd8714b44a7a50648109fdc8eb42b580c2c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ffc6cdd8714b44a7a50648109fdc8eb42b580c2c", "html_url": "https://github.com/rust-lang/rust/commit/ffc6cdd8714b44a7a50648109fdc8eb42b580c2c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ffc6cdd8714b44a7a50648109fdc8eb42b580c2c/comments", "author": {"login": "dzvon", "id": 3402811, "node_id": "MDQ6VXNlcjM0MDI4MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/3402811?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dzvon", "html_url": "https://github.com/dzvon", "followers_url": "https://api.github.com/users/dzvon/followers", "following_url": "https://api.github.com/users/dzvon/following{/other_user}", "gists_url": "https://api.github.com/users/dzvon/gists{/gist_id}", "starred_url": "https://api.github.com/users/dzvon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dzvon/subscriptions", "organizations_url": "https://api.github.com/users/dzvon/orgs", "repos_url": "https://api.github.com/users/dzvon/repos", "events_url": "https://api.github.com/users/dzvon/events{/privacy}", "received_events_url": "https://api.github.com/users/dzvon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dzvon", "id": 3402811, "node_id": "MDQ6VXNlcjM0MDI4MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/3402811?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dzvon", "html_url": "https://github.com/dzvon", "followers_url": "https://api.github.com/users/dzvon/followers", "following_url": "https://api.github.com/users/dzvon/following{/other_user}", "gists_url": "https://api.github.com/users/dzvon/gists{/gist_id}", "starred_url": "https://api.github.com/users/dzvon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dzvon/subscriptions", "organizations_url": "https://api.github.com/users/dzvon/orgs", "repos_url": "https://api.github.com/users/dzvon/repos", "events_url": "https://api.github.com/users/dzvon/events{/privacy}", "received_events_url": "https://api.github.com/users/dzvon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1a24ee9a1bd43666da4351526889db9cc967f4f8", "url": "https://api.github.com/repos/rust-lang/rust/commits/1a24ee9a1bd43666da4351526889db9cc967f4f8", "html_url": "https://github.com/rust-lang/rust/commit/1a24ee9a1bd43666da4351526889db9cc967f4f8"}], "stats": {"total": 21, "additions": 18, "deletions": 3}, "files": [{"sha": "ee6ab698fa4c8ac696b03f234990c94fff7ff61b", "filename": "crates/rust-analyzer/src/config.rs", "status": "modified", "additions": 17, "deletions": 2, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/ffc6cdd8714b44a7a50648109fdc8eb42b580c2c/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ffc6cdd8714b44a7a50648109fdc8eb42b580c2c/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs?ref=ffc6cdd8714b44a7a50648109fdc8eb42b580c2c", "patch": "@@ -1289,6 +1289,21 @@ mod tests {\n             .to_string();\n         schema.push_str(\",\\n\");\n \n+        let mut new_schema = schema.clone();\n+        let url_matches = schema.match_indices(\"https://\");\n+        let mut cnt = 0;\n+        for (idx, _) in url_matches {\n+            let link = &schema[idx..];\n+            // matching on whitespace to ignore normal links\n+            if let Some(link_end) = link.find(|c| c == ' ' || c == '[') {\n+                if link.chars().nth(link_end) == Some('[') {\n+                    new_schema.insert(idx + cnt, '(');\n+                    new_schema.insert(idx + link_end + cnt + 1, ')');\n+                    cnt = cnt + 2;\n+                }\n+            }\n+        }\n+\n         let package_json_path = project_root().join(\"editors/code/package.json\");\n         let mut package_json = fs::read_to_string(&package_json_path).unwrap();\n \n@@ -1299,9 +1314,9 @@ mod tests {\n         let end = package_json.find(end_marker).unwrap();\n \n         let p = remove_ws(&package_json[start..end]);\n-        let s = remove_ws(&schema);\n+        let s = remove_ws(&new_schema);\n         if !p.contains(&s) {\n-            package_json.replace_range(start..end, &schema);\n+            package_json.replace_range(start..end, &new_schema);\n             ensure_file_contents(&package_json_path, &package_json)\n         }\n     }"}, {"sha": "fffaf6c9b8617a691199009a599a25a9d69aef39", "filename": "editors/code/package.json", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ffc6cdd8714b44a7a50648109fdc8eb42b580c2c/editors%2Fcode%2Fpackage.json", "raw_url": "https://github.com/rust-lang/rust/raw/ffc6cdd8714b44a7a50648109fdc8eb42b580c2c/editors%2Fcode%2Fpackage.json", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fpackage.json?ref=ffc6cdd8714b44a7a50648109fdc8eb42b580c2c", "patch": "@@ -436,7 +436,7 @@\n                     ]\n                 },\n                 \"rust-analyzer.assist.importGroup\": {\n-                    \"markdownDescription\": \"Group inserted imports by the https://rust-analyzer.github.io/manual.html#auto-import [following order]. Groups are separated by newlines.\",\n+                    \"markdownDescription\": \"Group inserted imports by the (https://rust-analyzer.github.io/manual.html#auto-import)[following order]. Groups are separated by newlines.\",\n                     \"default\": true,\n                     \"type\": \"boolean\"\n                 },"}]}