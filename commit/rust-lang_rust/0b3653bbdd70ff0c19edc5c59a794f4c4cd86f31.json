{"sha": "0b3653bbdd70ff0c19edc5c59a794f4c4cd86f31", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBiMzY1M2JiZGQ3MGZmMGMxOWVkYzVjNTlhNzk0ZjRjNGNkODZmMzE=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2021-07-06T13:45:15Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2021-07-06T14:34:51Z"}, "message": "migrate cpu-usage-over-time.py to python 3\n\nThe only change here is a fix for `sys.platform` on Linux. Python 3.3\nchanged the API to return \"linux\" instead of \"linux2\"/\"linux3\", so this\ncommit uses `.startswith(\"python\")` to make the code work on Python 3\nwithout breaking Python 2.", "tree": {"sha": "50280ee7c5d04556708d44e3f09fca4059e66678", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/50280ee7c5d04556708d44e3f09fca4059e66678"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0b3653bbdd70ff0c19edc5c59a794f4c4cd86f31", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE1JbYPtLJAsc22U9xPgar6Auq8ZwFAmDkahEACgkQPgar6Auq\n8ZyZ2A/9HYmfGeq//nTT604hczwjr8Krw38nG34179u87KXHq53ShjWPKT/RkNBd\nVKPCkwD35Xf7H/Ir1JvLuI4zluLNH0YjVb16g62m5SGAl59lPoGGQ8vUg9jKHzNq\n4q/2rrVKntALMMNe3Cy3i/uV/g6c65Oe4VMcn9YUKRw66bKf6vgeQXhUXJL7sIfM\nkag/XBJJe51qP9z808sQWMFGSQK0lolPl7sN/D1ft3Wr+qx7AN3dJLyFNLGb3f1B\na3ecWBPQhXyk7wEbcD7hUlIDqDkCfuwgrFTKUZ7cP+SFeffI9LRmie4Y/MdGY/c5\nAdECfk9ZFQJamw5oh3rPBq+h65slF8Gfrhh261c+/2TngGKdF3YG2dmT1E/lXRZj\nvb+Y1UTljS4HPMbRw8d8U/orSEfURfj6m1pVg9OetHwEPqJabK42uvLIuQbDq8oF\nCDIrgZ8QiuHJsNVD2bsXW5jBVHLKxNhSbvbFLXIlX3nJj4X3/nV07ZyQ4jeVzcmx\nP3NUUpMa1hBa0ng0A+a4nPDMZ1CHfKkN8Ij8mwPCC/HiPDVAF28dTJn1Fub+izRt\nPRcTXr32KQd+Q4OuaWQgQ9SkvwFP/qIrKgYL526rlgF3QNR9YvgMzyib9K0XBjy2\nE4p+vG4VQO8Z8ASKo9ZvFezw0EMNIF4GsbRWokMHhXfN//Ix0FE=\n=HHUS\n-----END PGP SIGNATURE-----", "payload": "tree 50280ee7c5d04556708d44e3f09fca4059e66678\nparent d04ec4735810553224eb5eaf948ec78f84eac06c\nauthor Pietro Albini <pietro@pietroalbini.org> 1625579115 +0200\ncommitter Pietro Albini <pietro@pietroalbini.org> 1625582091 +0200\n\nmigrate cpu-usage-over-time.py to python 3\n\nThe only change here is a fix for `sys.platform` on Linux. Python 3.3\nchanged the API to return \"linux\" instead of \"linux2\"/\"linux3\", so this\ncommit uses `.startswith(\"python\")` to make the code work on Python 3\nwithout breaking Python 2.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0b3653bbdd70ff0c19edc5c59a794f4c4cd86f31", "html_url": "https://github.com/rust-lang/rust/commit/0b3653bbdd70ff0c19edc5c59a794f4c4cd86f31", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0b3653bbdd70ff0c19edc5c59a794f4c4cd86f31/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d04ec4735810553224eb5eaf948ec78f84eac06c", "url": "https://api.github.com/repos/rust-lang/rust/commits/d04ec4735810553224eb5eaf948ec78f84eac06c", "html_url": "https://github.com/rust-lang/rust/commit/d04ec4735810553224eb5eaf948ec78f84eac06c"}], "stats": {"total": 9, "additions": 6, "deletions": 3}, "files": [{"sha": "267c3964d0d692d2e8e975fa5868943a547c00fc", "filename": "src/ci/cpu-usage-over-time.py", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/0b3653bbdd70ff0c19edc5c59a794f4c4cd86f31/src%2Fci%2Fcpu-usage-over-time.py", "raw_url": "https://github.com/rust-lang/rust/raw/0b3653bbdd70ff0c19edc5c59a794f4c4cd86f31/src%2Fci%2Fcpu-usage-over-time.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fcpu-usage-over-time.py?ref=0b3653bbdd70ff0c19edc5c59a794f4c4cd86f31", "patch": "@@ -1,4 +1,4 @@\n-#!/usr/bin/env python\n+#!/usr/bin/env python3\n # ignore-tidy-linelength\n \n # This is a small script that we use on CI to collect CPU usage statistics of\n@@ -37,7 +37,10 @@\n import sys\n import time\n \n-if sys.platform == 'linux2':\n+# Python 3.3 changed the value of `sys.platform` on Linux from \"linux2\" to just\n+# \"linux\". We check here with `.startswith` to keep compatibility with older\n+# Python versions (especially Python 2.7).\n+if sys.platform.startswith('linux'):\n     class State:\n         def __init__(self):\n             with open('/proc/stat', 'r') as file:"}, {"sha": "853b4628fab2f3d1c487afcc46db4018ec9ae988", "filename": "src/ci/scripts/collect-cpu-stats.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0b3653bbdd70ff0c19edc5c59a794f4c4cd86f31/src%2Fci%2Fscripts%2Fcollect-cpu-stats.sh", "raw_url": "https://github.com/rust-lang/rust/raw/0b3653bbdd70ff0c19edc5c59a794f4c4cd86f31/src%2Fci%2Fscripts%2Fcollect-cpu-stats.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fscripts%2Fcollect-cpu-stats.sh?ref=0b3653bbdd70ff0c19edc5c59a794f4c4cd86f31", "patch": "@@ -6,4 +6,4 @@\n set -euo pipefail\n IFS=$'\\n\\t'\n \n-python src/ci/cpu-usage-over-time.py &> cpu-usage.csv &\n+python3 src/ci/cpu-usage-over-time.py &> cpu-usage.csv &"}]}