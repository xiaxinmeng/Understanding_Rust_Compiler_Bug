{"sha": "d7bc758638772dbc5718eb33347998cfce0bee5e", "node_id": "C_kwDOAAsO6NoAKGQ3YmM3NTg2Mzg3NzJkYmM1NzE4ZWIzMzM0Nzk5OGNmY2UwYmVlNWU", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-01-14T17:45:26Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-01-14T17:45:26Z"}, "message": "Rollup merge of #106563 - clubby789:gce-macro-braces, r=TaKO8Ki\n\nFix `unused_braces` on generic const expr macro call\n\nFixes #106545\n\n`@rustbot` label +A-const-generics +A-lint", "tree": {"sha": "b6891731a10f07f8d10c5203167d2f7aa6b90759", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b6891731a10f07f8d10c5203167d2f7aa6b90759"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d7bc758638772dbc5718eb33347998cfce0bee5e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjwuo2CRBK7hj4Ov3rIwAAIPwIAJ9C5VKvLq5WvNsZo5xiX10S\nUXfdtRFNp03LtL/kDKbFSIr9z1L47haVWs2wL3jDDwdBf9Qqn21EE9MeWk3gwVPP\nNO3x0Vmc0KZdWrYZUoDTDpQ/oxqb+0iwQmDDnvLPQ1fNwbz/c0HQNHodZc6ckeXV\n09CKCv2hToOfa2aMtCzCtWJ3aByfUVU7f+FfT8ul3+kTtb90lM2pVNhxoAj1C/hN\n2n3kaXPX6vBGdMsSuQdSPJF0RI8yBIjxTDrjqtj9Dv8OU0UOmI/X/vZS1L1Q5f0o\nQxpefcfas5+avDlbZ40t4BL2XqyvtwV9y36MraD36ME9dxxewCXG6861KHptZIc=\n=DbMG\n-----END PGP SIGNATURE-----\n", "payload": "tree b6891731a10f07f8d10c5203167d2f7aa6b90759\nparent 085d2f1f0913890b531fde75d9300bd995dfb568\nparent 4f64de83bc5731946c9acdd4f572e24bfbaef4b9\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1673718326 +0100\ncommitter GitHub <noreply@github.com> 1673718326 +0100\n\nRollup merge of #106563 - clubby789:gce-macro-braces, r=TaKO8Ki\n\nFix `unused_braces` on generic const expr macro call\n\nFixes #106545\n\n`@rustbot` label +A-const-generics +A-lint\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d7bc758638772dbc5718eb33347998cfce0bee5e", "html_url": "https://github.com/rust-lang/rust/commit/d7bc758638772dbc5718eb33347998cfce0bee5e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d7bc758638772dbc5718eb33347998cfce0bee5e/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "085d2f1f0913890b531fde75d9300bd995dfb568", "url": "https://api.github.com/repos/rust-lang/rust/commits/085d2f1f0913890b531fde75d9300bd995dfb568", "html_url": "https://github.com/rust-lang/rust/commit/085d2f1f0913890b531fde75d9300bd995dfb568"}, {"sha": "4f64de83bc5731946c9acdd4f572e24bfbaef4b9", "url": "https://api.github.com/repos/rust-lang/rust/commits/4f64de83bc5731946c9acdd4f572e24bfbaef4b9", "html_url": "https://github.com/rust-lang/rust/commit/4f64de83bc5731946c9acdd4f572e24bfbaef4b9"}], "stats": {"total": 17, "additions": 16, "deletions": 1}, "files": [{"sha": "f2ee9ab1a19873cfac16b3e6f2c29c253a5267a5", "filename": "compiler/rustc_lint/src/unused.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d7bc758638772dbc5718eb33347998cfce0bee5e/compiler%2Frustc_lint%2Fsrc%2Funused.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d7bc758638772dbc5718eb33347998cfce0bee5e/compiler%2Frustc_lint%2Fsrc%2Funused.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Funused.rs?ref=d7bc758638772dbc5718eb33347998cfce0bee5e", "patch": "@@ -1105,6 +1105,7 @@ impl UnusedDelimLint for UnusedBraces {\n                                 || matches!(expr.kind, ast::ExprKind::Lit(_)))\n                             && !cx.sess().source_map().is_multiline(value.span)\n                             && value.attrs.is_empty()\n+                            && !expr.span.from_expansion()\n                             && !value.span.from_expansion()\n                             && !inner.span.from_expansion()\n                         {"}, {"sha": "4c1926387b926a4e843b3e6c5176af7d0b964c95", "filename": "tests/ui/const-generics/unused_braces.fixed", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/d7bc758638772dbc5718eb33347998cfce0bee5e/tests%2Fui%2Fconst-generics%2Funused_braces.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/d7bc758638772dbc5718eb33347998cfce0bee5e/tests%2Fui%2Fconst-generics%2Funused_braces.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fconst-generics%2Funused_braces.fixed?ref=d7bc758638772dbc5718eb33347998cfce0bee5e", "patch": "@@ -2,10 +2,17 @@\n // run-rustfix\n #![warn(unused_braces)]\n \n+macro_rules! make_1 {\n+    () => {\n+        1\n+    }\n+}\n+\n struct A<const N: usize>;\n \n fn main() {\n     let _: A<7>; // ok\n     let _: A<7>; //~ WARN unnecessary braces\n     let _: A<{ 3 + 5 }>; // ok\n+    let _: A<{make_1!()}>; // ok\n }"}, {"sha": "e9f15b401807915c0f85cf7893e8e14d67d60ab0", "filename": "tests/ui/const-generics/unused_braces.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/d7bc758638772dbc5718eb33347998cfce0bee5e/tests%2Fui%2Fconst-generics%2Funused_braces.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d7bc758638772dbc5718eb33347998cfce0bee5e/tests%2Fui%2Fconst-generics%2Funused_braces.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fconst-generics%2Funused_braces.rs?ref=d7bc758638772dbc5718eb33347998cfce0bee5e", "patch": "@@ -2,10 +2,17 @@\n // run-rustfix\n #![warn(unused_braces)]\n \n+macro_rules! make_1 {\n+    () => {\n+        1\n+    }\n+}\n+\n struct A<const N: usize>;\n \n fn main() {\n     let _: A<7>; // ok\n     let _: A<{ 7 }>; //~ WARN unnecessary braces\n     let _: A<{ 3 + 5 }>; // ok\n+    let _: A<{make_1!()}>; // ok\n }"}, {"sha": "2c8031c430020b8f86e38ab53137ab02c3783e30", "filename": "tests/ui/const-generics/unused_braces.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d7bc758638772dbc5718eb33347998cfce0bee5e/tests%2Fui%2Fconst-generics%2Funused_braces.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d7bc758638772dbc5718eb33347998cfce0bee5e/tests%2Fui%2Fconst-generics%2Funused_braces.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fconst-generics%2Funused_braces.stderr?ref=d7bc758638772dbc5718eb33347998cfce0bee5e", "patch": "@@ -1,5 +1,5 @@\n warning: unnecessary braces around const expression\n-  --> $DIR/unused_braces.rs:9:14\n+  --> $DIR/unused_braces.rs:15:14\n    |\n LL |     let _: A<{ 7 }>;\n    |              ^^ ^^"}]}