{"sha": "e86c128aa3f76e46131d52da1c7ee00921e72094", "node_id": "C_kwDOAAsO6NoAKGU4NmMxMjhhYTNmNzZlNDYxMzFkNTJkYTFjN2VlMDA5MjFlNzIwOTQ", "commit": {"author": {"name": "Ivan Markov", "email": "ivan.markov@gmail.com", "date": "2022-08-03T19:07:25Z"}, "committer": {"name": "Ivan Markov", "email": "ivan.markov@gmail.com", "date": "2022-08-03T19:30:23Z"}, "message": "FilesTimes support does not build for ESP-IDF", "tree": {"sha": "9c72448c02e2e36889fcfefb114495c509a1e4d7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9c72448c02e2e36889fcfefb114495c509a1e4d7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e86c128aa3f76e46131d52da1c7ee00921e72094", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e86c128aa3f76e46131d52da1c7ee00921e72094", "html_url": "https://github.com/rust-lang/rust/commit/e86c128aa3f76e46131d52da1c7ee00921e72094", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e86c128aa3f76e46131d52da1c7ee00921e72094/comments", "author": {"login": "ivmarkov", "id": 2607589, "node_id": "MDQ6VXNlcjI2MDc1ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/2607589?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ivmarkov", "html_url": "https://github.com/ivmarkov", "followers_url": "https://api.github.com/users/ivmarkov/followers", "following_url": "https://api.github.com/users/ivmarkov/following{/other_user}", "gists_url": "https://api.github.com/users/ivmarkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/ivmarkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ivmarkov/subscriptions", "organizations_url": "https://api.github.com/users/ivmarkov/orgs", "repos_url": "https://api.github.com/users/ivmarkov/repos", "events_url": "https://api.github.com/users/ivmarkov/events{/privacy}", "received_events_url": "https://api.github.com/users/ivmarkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ivmarkov", "id": 2607589, "node_id": "MDQ6VXNlcjI2MDc1ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/2607589?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ivmarkov", "html_url": "https://github.com/ivmarkov", "followers_url": "https://api.github.com/users/ivmarkov/followers", "following_url": "https://api.github.com/users/ivmarkov/following{/other_user}", "gists_url": "https://api.github.com/users/ivmarkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/ivmarkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ivmarkov/subscriptions", "organizations_url": "https://api.github.com/users/ivmarkov/orgs", "repos_url": "https://api.github.com/users/ivmarkov/repos", "events_url": "https://api.github.com/users/ivmarkov/events{/privacy}", "received_events_url": "https://api.github.com/users/ivmarkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "04f72f95384d97f4c4e7a59e60cb85ec581ebe06", "url": "https://api.github.com/repos/rust-lang/rust/commits/04f72f95384d97f4c4e7a59e60cb85ec581ebe06", "html_url": "https://github.com/rust-lang/rust/commit/04f72f95384d97f4c4e7a59e60cb85ec581ebe06"}], "stats": {"total": 10, "additions": 7, "deletions": 3}, "files": [{"sha": "b5cc8038ca44f817ddb6c971224aa5e29fed4625", "filename": "library/std/src/sys/unix/fs.rs", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/e86c128aa3f76e46131d52da1c7ee00921e72094/library%2Fstd%2Fsrc%2Fsys%2Funix%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e86c128aa3f76e46131d52da1c7ee00921e72094/library%2Fstd%2Fsrc%2Fsys%2Funix%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Ffs.rs?ref=e86c128aa3f76e46131d52da1c7ee00921e72094", "patch": "@@ -544,9 +544,11 @@ impl Default for FileTimes {\n     fn default() -> Self {\n         // Redox doesn't appear to support `UTIME_OMIT`, so we stub it out here, and always return\n         // an error in `set_times`.\n-        #[cfg(target_os = \"redox\")]\n+        // ESP-IDF does not support `futimens` at all and the behavior for that OS is therefore\n+        // the same as for Redox.\n+        #[cfg(any(target_os = \"redox\", target_os = \"espidf\"))]\n         let omit = libc::timespec { tv_sec: 0, tv_nsec: 0 };\n-        #[cfg(not(target_os = \"redox\"))]\n+        #[cfg(not(any(target_os = \"redox\", target_os = \"espidf\")))]\n         let omit = libc::timespec { tv_sec: 0, tv_nsec: libc::UTIME_OMIT as _ };\n         Self([omit; 2])\n     }\n@@ -1077,8 +1079,10 @@ impl File {\n \n     pub fn set_times(&self, times: FileTimes) -> io::Result<()> {\n         cfg_if::cfg_if! {\n-            if #[cfg(target_os = \"redox\")] {\n+            if #[cfg(any(target_os = \"redox\", target_os = \"espidf\"))] {\n                 // Redox doesn't appear to support `UTIME_OMIT`.\n+                // ESP-IDF does not support `futimens` at all and the behavior for that OS is therefore\n+                // the same as for Redox.\n                 drop(times);\n                 Err(io::const_io_error!(\n                     io::ErrorKind::Unsupported,"}]}