{"sha": "4103e5b34bcd5fff13afe79494d6955d7996c804", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQxMDNlNWIzNGJjZDVmZmYxM2FmZTc5NDk0ZDY5NTVkNzk5NmM4MDQ=", "commit": {"author": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2019-01-11T05:13:45Z"}, "committer": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2019-01-11T05:13:45Z"}, "message": "Add a profiles section to the manifest", "tree": {"sha": "cdba93d285d27b07ef948e3c7ddb7b1433b28801", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cdba93d285d27b07ef948e3c7ddb7b1433b28801"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4103e5b34bcd5fff13afe79494d6955d7996c804", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4103e5b34bcd5fff13afe79494d6955d7996c804", "html_url": "https://github.com/rust-lang/rust/commit/4103e5b34bcd5fff13afe79494d6955d7996c804", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4103e5b34bcd5fff13afe79494d6955d7996c804/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb", "url": "https://api.github.com/repos/rust-lang/rust/commits/c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb", "html_url": "https://github.com/rust-lang/rust/commit/c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb"}], "stats": {"total": 25, "additions": 24, "deletions": 1}, "files": [{"sha": "b00daa716777fd3a298c0f223995c5c3a5fee040", "filename": "src/tools/build-manifest/src/main.rs", "status": "modified", "additions": 24, "deletions": 1, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/4103e5b34bcd5fff13afe79494d6955d7996c804/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4103e5b34bcd5fff13afe79494d6955d7996c804/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs?ref=4103e5b34bcd5fff13afe79494d6955d7996c804", "patch": "@@ -131,7 +131,8 @@ struct Manifest {\n     manifest_version: String,\n     date: String,\n     pkg: BTreeMap<String, Package>,\n-    renames: BTreeMap<String, Rename>\n+    renames: BTreeMap<String, Rename>,\n+    profiles: BTreeMap<String, Vec<String>>,\n }\n \n #[derive(Serialize)]\n@@ -340,6 +341,7 @@ impl Builder {\n             date: self.date.to_string(),\n             pkg: BTreeMap::new(),\n             renames: BTreeMap::new(),\n+            profiles: BTreeMap::new(),\n         };\n \n         self.package(\"rustc\", &mut manifest.pkg, HOSTS);\n@@ -355,6 +357,20 @@ impl Builder {\n         self.package(\"llvm-tools-preview\", &mut manifest.pkg, TARGETS);\n         self.package(\"lldb-preview\", &mut manifest.pkg, TARGETS);\n \n+        self.profile(\"minimal\",\n+                     &mut manifest.profiles,\n+                     &[\"rustc\", \"cargo\", \"rust-std\", \"rust-mingw\"]);\n+        self.profile(\"default\",\n+                     &mut manifest.profiles,\n+                     &[\"rustc\", \"cargo\", \"rust-std\", \"rust-mingw\",\n+                       \"rust-docs\", \"rustfmt-preview\", \"clippy-preview\"]);\n+        self.profile(\"complete\",\n+                     &mut manifest.profiles,\n+                     &[\"rustc\", \"cargo\", \"rust-std\", \"rust-mingw\",\n+                       \"rust-docs\", \"rustfmt-preview\", \"clippy-preview\",\n+                       \"rls-preview\", \"rust-src\", \"llvm-tools-preview\",\n+                       \"lldb-preview\", \"rust-analysis\"]);\n+\n         manifest.renames.insert(\"rls\".to_owned(), Rename { to: \"rls-preview\".to_owned() });\n         manifest.renames.insert(\"rustfmt\".to_owned(), Rename { to: \"rustfmt-preview\".to_owned() });\n         manifest.renames.insert(\"clippy\".to_owned(), Rename { to: \"clippy-preview\".to_owned() });\n@@ -453,6 +469,13 @@ impl Builder {\n         return manifest;\n     }\n \n+    fn profile(&mut self,\n+               profile_name: &str,\n+               dst: &mut BTreeMap<String, Vec<String>>,\n+               pkgs: &[&str]) {\n+        dst.insert(profile_name.to_owned(), pkgs.iter().map(|s| (*s).to_owned()).collect());\n+    }\n+\n     fn package(&mut self,\n                pkgname: &str,\n                dst: &mut BTreeMap<String, Package>,"}]}