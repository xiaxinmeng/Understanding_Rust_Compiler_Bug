{"sha": "66d3672b2696918a074d193813af1f74d1c48be9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY2ZDM2NzJiMjY5NjkxOGEwNzRkMTkzODEzYWYxZjc0ZDFjNDhiZTk=", "commit": {"author": {"name": "Josh Mcguigan", "email": "joshmcg88@gmail.com", "date": "2018-10-15T11:44:39Z"}, "committer": {"name": "Josh Mcguigan", "email": "joshmcg88@gmail.com", "date": "2018-10-15T11:44:39Z"}, "message": "out_of_bounds_indexing improved reporting of out of bounds value", "tree": {"sha": "e700328d1d9bd50ddc1b0897c65c99817fb8d38a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e700328d1d9bd50ddc1b0897c65c99817fb8d38a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/66d3672b2696918a074d193813af1f74d1c48be9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/66d3672b2696918a074d193813af1f74d1c48be9", "html_url": "https://github.com/rust-lang/rust/commit/66d3672b2696918a074d193813af1f74d1c48be9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/66d3672b2696918a074d193813af1f74d1c48be9/comments", "author": {"login": "JoshMcguigan", "id": 22216761, "node_id": "MDQ6VXNlcjIyMjE2NzYx", "avatar_url": "https://avatars.githubusercontent.com/u/22216761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JoshMcguigan", "html_url": "https://github.com/JoshMcguigan", "followers_url": "https://api.github.com/users/JoshMcguigan/followers", "following_url": "https://api.github.com/users/JoshMcguigan/following{/other_user}", "gists_url": "https://api.github.com/users/JoshMcguigan/gists{/gist_id}", "starred_url": "https://api.github.com/users/JoshMcguigan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JoshMcguigan/subscriptions", "organizations_url": "https://api.github.com/users/JoshMcguigan/orgs", "repos_url": "https://api.github.com/users/JoshMcguigan/repos", "events_url": "https://api.github.com/users/JoshMcguigan/events{/privacy}", "received_events_url": "https://api.github.com/users/JoshMcguigan/received_events", "type": "User", "site_admin": false}, "committer": {"login": "JoshMcguigan", "id": 22216761, "node_id": "MDQ6VXNlcjIyMjE2NzYx", "avatar_url": "https://avatars.githubusercontent.com/u/22216761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JoshMcguigan", "html_url": "https://github.com/JoshMcguigan", "followers_url": "https://api.github.com/users/JoshMcguigan/followers", "following_url": "https://api.github.com/users/JoshMcguigan/following{/other_user}", "gists_url": "https://api.github.com/users/JoshMcguigan/gists{/gist_id}", "starred_url": "https://api.github.com/users/JoshMcguigan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JoshMcguigan/subscriptions", "organizations_url": "https://api.github.com/users/JoshMcguigan/orgs", "repos_url": "https://api.github.com/users/JoshMcguigan/repos", "events_url": "https://api.github.com/users/JoshMcguigan/events{/privacy}", "received_events_url": "https://api.github.com/users/JoshMcguigan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5c3928282699244f5e85a66f0cded09ea3dfbeda", "url": "https://api.github.com/repos/rust-lang/rust/commits/5c3928282699244f5e85a66f0cded09ea3dfbeda", "html_url": "https://github.com/rust-lang/rust/commit/5c3928282699244f5e85a66f0cded09ea3dfbeda"}], "stats": {"total": 72, "additions": 36, "deletions": 36}, "files": [{"sha": "f960ab5958ce59e581e832c31a6a248be83985b3", "filename": "clippy_lints/src/indexing_slicing.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/66d3672b2696918a074d193813af1f74d1c48be9/clippy_lints%2Fsrc%2Findexing_slicing.rs", "raw_url": "https://github.com/rust-lang/rust/raw/66d3672b2696918a074d193813af1f74d1c48be9/clippy_lints%2Fsrc%2Findexing_slicing.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Findexing_slicing.rs?ref=66d3672b2696918a074d193813af1f74d1c48be9", "patch": "@@ -120,7 +120,7 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for IndexingSlicing {\n                             utils::span_lint(\n                                 cx,\n                                 OUT_OF_BOUNDS_INDEXING,\n-                                expr.span,\n+                                range.start.map_or(expr.span, |start| start.span),\n                                 \"range is out of bounds\",\n                             );\n                             return;\n@@ -132,7 +132,7 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for IndexingSlicing {\n                             utils::span_lint(\n                                 cx,\n                                 OUT_OF_BOUNDS_INDEXING,\n-                                expr.span,\n+                                range.end.map_or(expr.span, |end| end.span),\n                                 \"range is out of bounds\",\n                             );\n                             return;"}, {"sha": "fafcb1bc4853f13d8655bf8b1e7b91d11980e961", "filename": "tests/ui/indexing_slicing.stderr", "status": "modified", "additions": 34, "deletions": 34, "changes": 68, "blob_url": "https://github.com/rust-lang/rust/blob/66d3672b2696918a074d193813af1f74d1c48be9/tests%2Fui%2Findexing_slicing.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/66d3672b2696918a074d193813af1f74d1c48be9/tests%2Fui%2Findexing_slicing.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Findexing_slicing.stderr?ref=66d3672b2696918a074d193813af1f74d1c48be9", "patch": "@@ -48,18 +48,18 @@ error: slicing may panic.\n    = help: Consider using `.get(n..)` or .get_mut(n..)` instead\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:30:6\n+  --> $DIR/indexing_slicing.rs:30:11\n    |\n 30 |     &x[..=4];\n-   |      ^^^^^^^\n+   |           ^\n    |\n    = note: `-D clippy::out-of-bounds-indexing` implied by `-D warnings`\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:31:6\n+  --> $DIR/indexing_slicing.rs:31:11\n    |\n 31 |     &x[1..5];\n-   |      ^^^^^^^\n+   |           ^\n \n error: slicing may panic.\n   --> $DIR/indexing_slicing.rs:32:6\n@@ -70,34 +70,34 @@ error: slicing may panic.\n    = help: Consider using `.get(..n)`or `.get_mut(..n)` instead\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:32:6\n+  --> $DIR/indexing_slicing.rs:32:8\n    |\n 32 |     &x[5..][..10]; // Two lint reports, one for [5..] and another for [..10].\n-   |      ^^^^^^\n+   |        ^\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:33:6\n+  --> $DIR/indexing_slicing.rs:33:8\n    |\n 33 |     &x[5..];\n-   |      ^^^^^^\n+   |        ^\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:34:6\n+  --> $DIR/indexing_slicing.rs:34:10\n    |\n 34 |     &x[..5];\n-   |      ^^^^^^\n+   |          ^\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:35:6\n+  --> $DIR/indexing_slicing.rs:35:8\n    |\n 35 |     &x[5..].iter().map(|x| 2 * x).collect::<Vec<i32>>();\n-   |      ^^^^^^\n+   |        ^\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:36:6\n+  --> $DIR/indexing_slicing.rs:36:12\n    |\n 36 |     &x[0..=4];\n-   |      ^^^^^^^^\n+   |            ^\n \n error: slicing may panic.\n   --> $DIR/indexing_slicing.rs:37:6\n@@ -148,46 +148,46 @@ error: slicing may panic.\n    = help: Consider using `.get(..n)`or `.get_mut(..n)` instead\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:60:6\n+  --> $DIR/indexing_slicing.rs:60:12\n    |\n 60 |     &empty[1..5];\n-   |      ^^^^^^^^^^^\n+   |            ^\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:61:6\n+  --> $DIR/indexing_slicing.rs:61:16\n    |\n 61 |     &empty[0..=4];\n-   |      ^^^^^^^^^^^^\n+   |                ^\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:62:6\n+  --> $DIR/indexing_slicing.rs:62:15\n    |\n 62 |     &empty[..=4];\n-   |      ^^^^^^^^^^^\n+   |               ^\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:63:6\n+  --> $DIR/indexing_slicing.rs:63:12\n    |\n 63 |     &empty[1..];\n-   |      ^^^^^^^^^^\n+   |            ^\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:64:6\n+  --> $DIR/indexing_slicing.rs:64:14\n    |\n 64 |     &empty[..4];\n-   |      ^^^^^^^^^^\n+   |              ^\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:65:6\n+  --> $DIR/indexing_slicing.rs:65:16\n    |\n 65 |     &empty[0..=0];\n-   |      ^^^^^^^^^^^^\n+   |                ^\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:66:6\n+  --> $DIR/indexing_slicing.rs:66:15\n    |\n 66 |     &empty[..=0];\n-   |      ^^^^^^^^^^^\n+   |               ^\n \n error: indexing may panic.\n   --> $DIR/indexing_slicing.rs:74:5\n@@ -230,10 +230,10 @@ error: slicing may panic.\n    = help: Consider using `.get(..n)`or `.get_mut(..n)` instead\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:78:6\n+  --> $DIR/indexing_slicing.rs:78:8\n    |\n 78 |     &x[10..][..100]; // Two lint reports, one for [10..] and another for [..100].\n-   |      ^^^^^^^\n+   |        ^^\n \n error: slicing may panic.\n   --> $DIR/indexing_slicing.rs:79:6\n@@ -268,16 +268,16 @@ error: indexing may panic.\n    = help: Consider using `.get(n)` or `.get_mut(n)` instead\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:97:6\n+  --> $DIR/indexing_slicing.rs:97:13\n    |\n 97 |     &x[num..10]; // should trigger out of bounds error\n-   |      ^^^^^^^^^^\n+   |             ^^\n \n error: range is out of bounds\n-  --> $DIR/indexing_slicing.rs:98:6\n+  --> $DIR/indexing_slicing.rs:98:8\n    |\n 98 |     &x[10..num]; // should trigger out of bounds error\n-   |      ^^^^^^^^^^\n+   |        ^^\n \n error: aborting due to 39 previous errors\n "}]}