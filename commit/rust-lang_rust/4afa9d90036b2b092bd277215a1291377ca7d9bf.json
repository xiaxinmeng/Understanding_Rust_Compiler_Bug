{"sha": "4afa9d90036b2b092bd277215a1291377ca7d9bf", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRhZmE5ZDkwMDM2YjJiMDkyYmQyNzcyMTVhMTI5MTM3N2NhN2Q5YmY=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-11-10T11:34:13Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-11-10T11:34:13Z"}, "message": "Auto merge of #29699 - tamird:valgrind-supp, r=alexcrichton\n\nQuite a bit of cruft in the valgrind suppressions. I started from a clean slate and found a few unique failures; this commit also moves the tests \"fixed\" by these suppressions into run-pass-valgrind.", "tree": {"sha": "af34101e97bc5f408684d7e7b8788b25b0c36a1f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/af34101e97bc5f408684d7e7b8788b25b0c36a1f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4afa9d90036b2b092bd277215a1291377ca7d9bf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4afa9d90036b2b092bd277215a1291377ca7d9bf", "html_url": "https://github.com/rust-lang/rust/commit/4afa9d90036b2b092bd277215a1291377ca7d9bf", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4afa9d90036b2b092bd277215a1291377ca7d9bf/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4b23a0962db486c8a96d673a1b17decc26a26b34", "url": "https://api.github.com/repos/rust-lang/rust/commits/4b23a0962db486c8a96d673a1b17decc26a26b34", "html_url": "https://github.com/rust-lang/rust/commit/4b23a0962db486c8a96d673a1b17decc26a26b34"}, {"sha": "269a8111920b0d5faecd98d94d750608a6c09379", "url": "https://api.github.com/repos/rust-lang/rust/commits/269a8111920b0d5faecd98d94d750608a6c09379", "html_url": "https://github.com/rust-lang/rust/commit/269a8111920b0d5faecd98d94d750608a6c09379"}], "stats": {"total": 623, "additions": 144, "deletions": 479}, "files": [{"sha": "a5a4869ae9aa997557ffb9cb7bb4a0a3e17338fa", "filename": "mk/main.mk", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4afa9d90036b2b092bd277215a1291377ca7d9bf/mk%2Fmain.mk", "raw_url": "https://github.com/rust-lang/rust/raw/4afa9d90036b2b092bd277215a1291377ca7d9bf/mk%2Fmain.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fmain.mk?ref=4afa9d90036b2b092bd277215a1291377ca7d9bf", "patch": "@@ -111,8 +111,7 @@ CFG_RUSTC_FLAGS := $(RUSTFLAGS)\n CFG_GCCISH_CFLAGS :=\n CFG_GCCISH_LINK_FLAGS :=\n \n-# Turn off broken quarantine (see jemalloc/jemalloc#161)\n-CFG_JEMALLOC_FLAGS := --disable-fill\n+CFG_JEMALLOC_FLAGS :=\n \n ifdef CFG_DISABLE_OPTIMIZE\n   $(info cfg: disabling rustc optimization (CFG_DISABLE_OPTIMIZE))\n@@ -184,7 +183,7 @@ include $(CFG_SRC_DIR)mk/platform.mk\n \n # Run the stage1/2 compilers under valgrind\n ifdef VALGRIND_COMPILE\n-  CFG_VALGRIND_COMPILE :=$(CFG_VALGRIND)\n+  CFG_VALGRIND_COMPILE := $(CFG_VALGRIND)\n else\n   CFG_VALGRIND_COMPILE :=\n endif\n@@ -202,6 +201,7 @@ endif\n \n ifdef CFG_ENABLE_VALGRIND\n   $(info cfg: enabling valgrind (CFG_ENABLE_VALGRIND))\n+  CFG_JEMALLOC_FLAGS += --enable-valgrind\n else\n   CFG_VALGRIND :=\n endif"}, {"sha": "866578930a3d8dca0f83d6ce285bc32e0913914d", "filename": "src/etc/apple-darwin.supp", "status": "modified", "additions": 100, "deletions": 4, "changes": 104, "blob_url": "https://github.com/rust-lang/rust/blob/4afa9d90036b2b092bd277215a1291377ca7d9bf/src%2Fetc%2Fapple-darwin.supp", "raw_url": "https://github.com/rust-lang/rust/raw/4afa9d90036b2b092bd277215a1291377ca7d9bf/src%2Fetc%2Fapple-darwin.supp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fapple-darwin.supp?ref=4afa9d90036b2b092bd277215a1291377ca7d9bf", "patch": "@@ -1,9 +1,105 @@\n {\n-   issue_1333_setenv_leak\n+   osx-frameworks.rs-fails-otherwise-1\n    Memcheck:Leak\n-   fun:malloc_zone_malloc\n+   match-leak-kinds: possible\n+   fun:malloc\n+   ...\n+   fun:__CFInitialize\n+   fun:_ZN16ImageLoaderMachO11doImageInitERKN11ImageLoader11LinkContextE\n+   fun:_ZN16ImageLoaderMachO16doInitializationERKN11ImageLoader11LinkContextE\n+   fun:_ZN11ImageLoader23recursiveInitializationERKNS_11LinkContextEjRNS_21InitializerTimingListERNS_15UninitedUpwardsE\n+   fun:_ZN11ImageLoader23recursiveInitializationERKNS_11LinkContextEjRNS_21InitializerTimingListERNS_15UninitedUpwardsE\n+   fun:_ZN11ImageLoader19processInitializersERKNS_11LinkContextEjRNS_21InitializerTimingListERNS_15UninitedUpwardsE\n+   fun:_ZN11ImageLoader15runInitializersERKNS_11LinkContextERNS_21InitializerTimingListE\n+   fun:_ZN4dyld24initializeMainExecutableEv\n+}\n+\n+{\n+   osx-frameworks.rs-fails-otherwise-2\n+   Memcheck:Leak\n+   match-leak-kinds: possible\n+   fun:malloc_zone_calloc\n+   ...\n+   fun:__CFInitialize\n+   fun:_ZN16ImageLoaderMachO11doImageInitERKN11ImageLoader11LinkContextE\n+   fun:_ZN16ImageLoaderMachO16doInitializationERKN11ImageLoader11LinkContextE\n+   fun:_ZN11ImageLoader23recursiveInitializationERKNS_11LinkContextEjRNS_21InitializerTimingListERNS_15UninitedUpwardsE\n+   fun:_ZN11ImageLoader23recursiveInitializationERKNS_11LinkContextEjRNS_21InitializerTimingListERNS_15UninitedUpwardsE\n+   fun:_ZN11ImageLoader19processInitializersERKNS_11LinkContextEjRNS_21InitializerTimingListERNS_15UninitedUpwardsE\n+}\n+\n+{\n+   osx-frameworks.rs-fails-otherwise-3\n+   Memcheck:Leak\n+   match-leak-kinds: possible\n+   fun:realloc\n+   fun:_ZL12realizeClassP10objc_class\n+   fun:_ZL12realizeClassP10objc_class\n+   fun:_ZN13list_array_ttIm15protocol_list_tE11attachListsEPKPS0_j\n+   fun:_read_images\n+   fun:map_images_nolock\n+   fun:map_2_images\n+   fun:_ZN4dyldL18notifyBatchPartialE17dyld_image_statesbPFPKcS0_jPK15dyld_image_infoE\n+   fun:_ZN4dyld36registerImageStateBatchChangeHandlerE17dyld_image_statesPFPKcS0_jPK15dyld_image_infoE\n+   fun:dyld_register_image_state_change_handler\n+   fun:_objc_init\n+   fun:_os_object_init\n+}\n+\n+{\n+   osx-frameworks.rs-fails-otherwise-4\n+   Memcheck:Leak\n+   match-leak-kinds: possible\n+   fun:calloc\n    ...\n-   fun:setenv\n-   fun:setenv__c_stack_shim\n+   fun:__CFInitialize\n+   fun:_ZN16ImageLoaderMachO11doImageInitERKN11ImageLoader11LinkContextE\n+   fun:_ZN16ImageLoaderMachO16doInitializationERKN11ImageLoader11LinkContextE\n+   fun:_ZN11ImageLoader23recursiveInitializationERKNS_11LinkContextEjRNS_21InitializerTimingListERNS_15UninitedUpwardsE\n+}\n+\n+{\n+   osx-frameworks.rs-fails-otherwise-5\n+   Memcheck:Leak\n+   match-leak-kinds: definite\n+   fun:calloc\n+   ...\n+   fun:__CFInitialize\n+   fun:_ZN16ImageLoaderMachO11doImageInitERKN11ImageLoader11LinkContextE\n+   fun:_ZN16ImageLoaderMachO16doInitializationERKN11ImageLoader11LinkContextE\n+   fun:_ZN11ImageLoader23recursiveInitializationERKNS_11LinkContextEjRNS_21InitializerTimingListERNS_15UninitedUpwardsE\n+}\n+\n+{\n+   osx-frameworks.rs-fails-otherwise-6\n+   Memcheck:Leak\n+   match-leak-kinds: definite\n+   fun:malloc\n+   fun:strdup\n+   fun:_CFProcessPath\n+   fun:__CFInitialize\n+   fun:_ZN16ImageLoaderMachO11doImageInitERKN11ImageLoader11LinkContextE\n+   fun:_ZN16ImageLoaderMachO16doInitializationERKN11ImageLoader11LinkContextE\n+   fun:_ZN11ImageLoader23recursiveInitializationERKNS_11LinkContextEjRNS_21InitializerTimingListERNS_15UninitedUpwardsE\n+   fun:_ZN11ImageLoader23recursiveInitializationERKNS_11LinkContextEjRNS_21InitializerTimingListERNS_15UninitedUpwardsE\n+   fun:_ZN11ImageLoader19processInitializersERKNS_11LinkContextEjRNS_21InitializerTimingListERNS_15UninitedUpwardsE\n+   fun:_ZN11ImageLoader15runInitializersERKNS_11LinkContextERNS_21InitializerTimingListE\n+   fun:_ZN4dyld24initializeMainExecutableEv\n+   fun:_ZN4dyld5_mainEPK12macho_headermiPPKcS5_S5_Pm\n+}\n+\n+{\n+   osx-frameworks.rs-fails-otherwise-7\n+   Memcheck:Leak\n+   match-leak-kinds: definite\n+   fun:malloc_zone_malloc\n    ...\n+   fun:__CFInitialize\n+   fun:_ZN16ImageLoaderMachO11doImageInitERKN11ImageLoader11LinkContextE\n+   fun:_ZN16ImageLoaderMachO16doInitializationERKN11ImageLoader11LinkContextE\n+   fun:_ZN11ImageLoader23recursiveInitializationERKNS_11LinkContextEjRNS_21InitializerTimingListERNS_15UninitedUpwardsE\n+   fun:_ZN11ImageLoader23recursiveInitializationERKNS_11LinkContextEjRNS_21InitializerTimingListERNS_15UninitedUpwardsE\n+   fun:_ZN11ImageLoader19processInitializersERKNS_11LinkContextEjRNS_21InitializerTimingListERNS_15UninitedUpwardsE\n+   fun:_ZN11ImageLoader15runInitializersERKNS_11LinkContextERNS_21InitializerTimingListE\n+   fun:_ZN4dyld24initializeMainExecutableEv\n }"}, {"sha": "e4368da90331f3ab3732d7e0253eb6d0c79d1151", "filename": "src/etc/x86.supp", "status": "modified", "additions": 40, "deletions": 471, "changes": 511, "blob_url": "https://github.com/rust-lang/rust/blob/4afa9d90036b2b092bd277215a1291377ca7d9bf/src%2Fetc%2Fx86.supp", "raw_url": "https://github.com/rust-lang/rust/raw/4afa9d90036b2b092bd277215a1291377ca7d9bf/src%2Fetc%2Fx86.supp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fx86.supp?ref=4afa9d90036b2b092bd277215a1291377ca7d9bf", "patch": "@@ -1,496 +1,65 @@\n {\n-   our-failure-to-setup-freeres-structure\n-   Memcheck:Free\n-   fun:free\n-   fun:__libc_freeres\n-   fun:_vgnU_freeres\n-}\n-\n-{\n-   our-failure-to-setup-freeres-structure2\n-   Memcheck:Free\n-   fun:free\n-   fun:free_mem\n-   fun:__libc_freeres\n-   fun:_vgnU_freeres\n-}\n-\n-{\n- leaked-TLS-chunk-x86-exit-path-fails-to-clean-up\n- Memcheck:Leak\n- fun:calloc\n- fun:_dl_allocate_tls\n-}\n-\n-{\n-   linux-dl-prob\n-   Memcheck:Param\n-   read(buf)\n-   ...\n-   fun:_dl_map_object\n-}\n-\n-{\n-   mac-dyld-oddity\n-   Memcheck:Cond\n-   fun:_ZN4dyld5_mainEPK12macho_headermiPPKcS5_S5_\n-   fun:_ZN13dyldbootstrap5startEPK12macho_headeriPPKcl\n-   fun:_dyld_start\n-   obj:*\n-}\n-\n-{\n-   mac-dlopen-weirdness\n-   Memcheck:Cond\n-   fun:_ZNK16ImageLoaderMachO9getRPathsERKN11ImageLoader11LinkContextERSt6vectorIPKcSaIS6_EE\n-   fun:_ZN11ImageLoader22recursiveLoadLibrariesERKNS_11LinkContextEbRKNS_10RPathChainE\n-   fun:_ZN11ImageLoader4linkERKNS_11LinkContextEbbRKNS_10RPathChainE\n-   fun:_ZN4dyld4linkEP11ImageLoaderbRKNS0_10RPathChainE\n-   fun:dlopen\n-   fun:dlopen\n-   fun:_ZN16rust_crate_cache3libC1EP8rust_domPKc\n-   fun:_ZN16rust_crate_cache7get_libEmPKc\n-   fun:_ZL11fetch_c_symP9rust_taskPK10rust_cratemmPKcS5_\n-}\n-\n-{\n-   mac-dlopen-weirdness-2\n-   Memcheck:Value4\n-   fun:_ZNK16ImageLoaderMachO9getRPathsERKN11ImageLoader11LinkContextERSt6vectorIPKcSaIS6_EE\n-   fun:_ZN11ImageLoader22recursiveLoadLibrariesERKNS_11LinkContextEbRKNS_10RPathChainE\n-   fun:_ZN11ImageLoader4linkERKNS_11LinkContextEbbRKNS_10RPathChainE\n-   fun:_ZN4dyld4linkEP11ImageLoaderbRKNS0_10RPathChainE\n-   fun:dlopen\n-   fun:dlopen\n-   fun:_ZN16rust_crate_cache3libC1EP8rust_domPKc\n-   fun:_ZN16rust_crate_cache7get_libEmPKc\n-   fun:_ZL11fetch_c_symP9rust_taskPK10rust_cratemmPKcS5_\n-}\n-\n-{\n-   mac-dlopen-weirdness-3\n-   Memcheck:Value4\n-   fun:strcpy\n-   fun:_ZN11ImageLoader22recursiveLoadLibrariesERKNS_11LinkContextEbRKNS_10RPathChainE\n-   fun:_ZN11ImageLoader4linkERKNS_11LinkContextEbbRKNS_10RPathChainE\n-   fun:_ZN4dyld4linkEP11ImageLoaderbRKNS0_10RPathChainE\n-   fun:dlopen\n-   fun:dlopen\n-   fun:_ZN16rust_crate_cache3libC1EP8rust_domPKc\n-   fun:_ZN16rust_crate_cache7get_libEmPKc\n-   fun:_ZL11fetch_c_symP9rust_taskPK10rust_cratemmPKcS5_\n-}\n-\n-{\n-   mac-dlopen-weirdness-4\n-   Memcheck:Value4\n-   obj:*\n-   fun:_ZNK16ImageLoaderMachO9getRPathsERKN11ImageLoader11LinkContextERSt6vectorIPKcSaIS6_EE\n-   fun:_ZN11ImageLoader22recursiveLoadLibrariesERKNS_11LinkContextEbRKNS_10RPathChainE\n-   fun:_ZN11ImageLoader4linkERKNS_11LinkContextEbbRKNS_10RPathChainE\n-   fun:_ZN4dyld4linkEP11ImageLoaderbRKNS0_10RPathChainE\n-   fun:dlopen\n-   fun:dlopen\n-   fun:_ZN16rust_crate_cache3libC1EP8rust_domPKc\n-   fun:_ZN16rust_crate_cache7get_libEmPKc\n-   fun:_ZL11fetch_c_symP9rust_taskPK10rust_cratemmPKcS5_\n-}\n-\n-{\n-   mac-dlopen-weirdness-5\n-   Memcheck:Cond\n-   fun:memcpy\n-   fun:strdup\n-   fun:_ZNK16ImageLoaderMachO9getRPathsERKN11ImageLoader11LinkContextERSt6vectorIPKcSaIS6_EE\n-   fun:_ZN11ImageLoader22recursiveLoadLibrariesERKNS_11LinkContextEbRKNS_10RPathChainE\n-   fun:_ZN11ImageLoader4linkERKNS_11LinkContextEbbRKNS_10RPathChainE\n-   fun:_ZN4dyld4linkEP11ImageLoaderbRKNS0_10RPathChainE\n-   fun:dlopen\n-   fun:dlopen\n-   fun:_ZN16rust_crate_cache3libC1EP8rust_domPKc\n-   fun:_ZN16rust_crate_cache7get_libEmPKc\n-   fun:_ZL11fetch_c_symP9rust_taskPK10rust_cratemmPKcS5_\n-}\n-\n-{\n-   mac-dlopen-weirdness-6\n-   Memcheck:Value4\n-   fun:memcpy\n-   fun:strdup\n-   fun:_ZNK16ImageLoaderMachO9getRPathsERKN11ImageLoader11LinkContextERSt6vectorIPKcSaIS6_EE\n-   fun:_ZN11ImageLoader22recursiveLoadLibrariesERKNS_11LinkContextEbRKNS_10RPathChainE\n-   fun:_ZN11ImageLoader4linkERKNS_11LinkContextEbbRKNS_10RPathChainE\n-   fun:_ZN4dyld4linkEP11ImageLoaderbRKNS0_10RPathChainE\n-   fun:dlopen\n-   fun:dlopen\n-   fun:_ZN16rust_crate_cache3libC1EP8rust_domPKc\n-   fun:_ZN16rust_crate_cache7get_libEmPKc\n-   fun:_ZL11fetch_c_symP9rust_taskPK10rust_cratemmPKcS5_\n-}\n-\n-{\n-   mac-dyld\n-   Memcheck:Cond\n-   ...\n-   fun:_ZN13dyldbootstrap5startEPK12macho_headeriPPKcl\n-   fun:_dyld_start\n-   obj:*\n-}\n-\n-{\n-   mac-dyld-2\n-   Memcheck:Value4\n-   ...\n-   fun:_ZN13dyldbootstrap5startEPK12macho_headeriPPKcl\n-   fun:_dyld_start\n-   obj:*\n-}\n-\n-{\n-   mac-dyld-3\n-   Memcheck:Param\n-   stat(path)\n-   ...\n-   fun:_ZN13dyldbootstrap5startEPK12macho_headeriPPKcl\n-   fun:_dyld_start\n-   obj:*\n-}\n-\n-{\n-   mac-dyld-4\n-   Memcheck:Param\n-   open(filename)\n-   ...\n-   fun:_ZN13dyldbootstrap5startEPK12macho_headeriPPKcl\n-   fun:_dyld_start\n-   obj:*\n-}\n-\n-{\n-   mac-dyld-5\n-   Memcheck:Cond\n-   ...\n-   fun:_ZN4dyld4loadEPKcRKNS_11LoadContextE\n-   fun:_ZN4dyld5_mainEPK12macho_headermiPPKcS5_S5_\n-}\n-\n-{\n-   mac-dyld-6\n-   Memcheck:Value4\n-   ...\n-   fun:_ZN4dyld4loadEPKcRKNS_11LoadContextE\n-   fun:_ZN4dyld5_mainEPK12macho_headermiPPKcS5_S5_\n-}\n-\n-{\n-   mac-dyld-7\n-   Memcheck:Value4\n-   ...\n-   fun:_ZN4dyld4loadEPKcRKNS_11LoadContextE\n-}\n-\n-{\n-   mac-dyld-8\n-   Memcheck:Cond\n-   ...\n-   fun:_ZN4dyld4loadEPKcRKNS_11LoadContextE\n-}\n-\n-{\n-   mac-dyld-9\n-   Memcheck:Value4\n-   ...\n-   fun:_ZN4dyldL10loadPhase0EPKcRKNS_11LoadContextEPSt6vectorIS1_SaIS1_EE\n-}\n-\n-{\n-   mac-dyld-10\n-   Memcheck:Cond\n-   ...\n-   fun:_ZN4dyldL10loadPhase0EPKcRKNS_11LoadContextEPSt6vectorIS1_SaIS1_EE\n-}\n-\n-{\n-   mac-dyld-11\n-   Memcheck:Param\n-   stat(path)\n-   ...\n-   fun:_ZN4dyld5_mainEPK12macho_headermiPPKcS5_S5_\n-   fun:_ZN13dyldbootstrap5startEPK12macho_headeriPPKcl\n-}\n-\n-{\n-   mac-dyld-12\n-   Memcheck:Param\n-   open(filename)\n-   ...\n-   fun:_ZN4dyld5_mainEPK12macho_headermiPPKcS5_S5_\n-   fun:_ZN13dyldbootstrap5startEPK12macho_headeriPPKcl\n-}\n-\n-{\n-   mac-dyld-13\n-   Memcheck:Cond\n-   ...\n-   fun:_ZN4dyld5_mainEPK12macho_headermiPPKcS5_S5_\n-   fun:_ZN13dyldbootstrap5startEPK12macho_headeriPPKcl\n-   fun:_dyld_start\n-}\n-\n-{\n-   mac-dyld-14\n-   Memcheck:Value4\n-   ...\n-   fun:_ZN4dyld5_mainEPK12macho_headermiPPKcS5_S5_\n-   fun:_ZN13dyldbootstrap5startEPK12macho_headeriPPKcl\n-   fun:_dyld_start\n-}\n-\n-{\n-   mac-dyld-15\n-   Memcheck:Value4\n-   ...\n-   fun:_ZN4dyld5_mainEPK12macho_headermiPPKcS5_S5_\n-   fun:_ZN13dyldbootstrap5startEPK12macho_headeriPPKcl\n-}\n-\n-{\n-   mac-dyld-16\n-   Memcheck:Value4\n-   ...\n-   fun:_ZN4dyld4linkEP11ImageLoaderbRKNS0_10RPathChainE\n-   fun:_ZN4dyld5_mainEPK12macho_headermiPPKcS5_S5_\n-}\n-\n-{\n-   mac-dyld-17\n-   Memcheck:Value4\n-   ...\n-   fun:_ZN4dyld4linkEP11ImageLoaderbRKNS0_10RPathChainE\n-}\n-\n-{\n-   mac-dyld-18\n-   Memcheck:Cond\n-   ...\n-   fun:_ZN4dyld5_mainEPK12macho_headermiPPKcS5_S5_\n-   fun:_ZN13dyldbootstrap5startEPK12macho_headeriPPKcl\n-}\n-\n-{\n-   mac-dyld-19\n-   Memcheck:Value4\n-   ...\n-   fun:_ZN4dyld5_mainEPK12macho_headermiPPKcS5_S5_\n-}\n-\n-{\n-   mac-dyld-20\n-   Memcheck:Value4\n-   ...\n-   fun:_ZN4dyld24initializeMainExecutableEv\n-}\n-\n-{\n-   mac-dyld-21\n-   Memcheck:Cond\n-   ...\n-   fun:_ZN4dyld24initializeMainExecutableEv\n-   fun:_ZN4dyld5_mainEPK12macho_headermiPPKcS5_S5_\n-}\n-\n-{\n-   mac-dyld-22\n-   Memcheck:Cond\n-   ...\n-   fun:_ZN4dyld24initializeMainExecutableEv\n-}\n-\n-{\n-   mac-dyld-23\n-   Memcheck:Value4\n-   ...\n-   fun:_ZN11ImageLoader15runInitializersERKNS_11LinkContextE\n-}\n-\n-{\n-   mac-dyld-24\n+   goddammit-llvm-why-u-no-valgrind\n    Memcheck:Cond\n+   fun:*\n    ...\n-   fun:dyld_stub_binder_\n-   fun:main\n-}\n-\n-{\n-   mac-dyld-25\n-   Memcheck:Value4\n-   ...\n-   fun:dyld_stub_binder_\n-   fun:main\n }\n \n {\n-   mac-dyld-26\n-   Memcheck:Cond\n-   ...\n-   fun:dyld_stub_binder_\n+   down-with-thread-dtors.rs-fails-otherwise-1\n+   Memcheck:Addr1\n    ...\n+   fun:tlv_finalize\n+   fun:_pthread_tsd_cleanup\n+   fun:_pthread_exit\n+   fun:_pthread_body\n+   fun:_pthread_start\n+   fun:thread_start\n }\n \n {\n-   mac-dyld-27\n-   Memcheck:Value4\n-   ...\n-   fun:dyld_stub_binder_\n+   down-with-thread-dtors.rs-fails-otherwise-2\n+   Memcheck:Addr2\n    ...\n+   fun:tlv_finalize\n+   fun:_pthread_tsd_cleanup\n+   fun:_pthread_exit\n+   fun:_pthread_body\n+   fun:_pthread_start\n+   fun:thread_start\n }\n \n {\n-   mac-dyld-28\n-   Memcheck:Cond\n-   fun:_ZN4dyld14runTerminatorsEPv\n+   down-with-thread-dtors.rs-fails-otherwise-3\n+   Memcheck:Addr4\n    ...\n+   fun:tlv_finalize\n+   fun:_pthread_tsd_cleanup\n+   fun:_pthread_exit\n+   fun:_pthread_body\n+   fun:_pthread_start\n+   fun:thread_start\n }\n \n {\n-   mac-dyld-29\n-   Memcheck:Cond\n-   fun:_ZN4dyldL18notifyBatchPartialE17dyld_image_statesbPFPKcS0_jPK15dyld_image_infoE\n+   down-with-thread-dtors.rs-fails-otherwise-4\n+   Memcheck:Addr8\n    ...\n+   fun:tlv_finalize\n+   fun:_pthread_tsd_cleanup\n+   fun:_pthread_exit\n+   fun:_pthread_body\n+   fun:_pthread_start\n+   fun:thread_start\n }\n \n {\n-   mac-dyld-30\n-   Memcheck:Value4\n-   fun:_ZN4dyldL18notifyBatchPartialE17dyld_image_statesbPFPKcS0_jPK15dyld_image_infoE\n-   ...\n-}\n-\n-{\n-   llvm-user-new-leak\n+   down-with-thread-dtors.rs-fails-otherwise-5\n    Memcheck:Leak\n-   fun:_Znwj\n-   fun:_ZN4llvm4UsernwEjj\n-}\n-\n-{\n-   race-or-something-ask-pcwalton-0\n-   Memcheck:Value4\n-   fun:*task_start_wrapper*\n-   ...\n-}\n-\n-{\n-   race-or-something-ask-pcwalton-1\n-   Memcheck:Value4\n-   ...\n-   fun:*build_start_wrapper*\n-   ...\n-}\n-\n-{\n-   lock_and_signal-probably-threadsafe-access-outside-of-lock\n-   Helgrind:Race\n-   fun:_ZN15lock_and_signal27lock_held_by_current_threadEv\n-   ...\n-}\n-\n-{\n-   lock_and_signal-probably-threadsafe-access-outside-of-lock2\n-   Helgrind:Race\n-   fun:_ZN15lock_and_signal6unlockEv\n-   ...\n-}\n-\n-{\n-   lock_and_signal-probably-threadsafe-access-outside-of-lock3\n-   Helgrind:Race\n-   fun:_ZN15lock_and_signal4lockEv\n-   ...\n-}\n-\n-{\n-   lock_and_signal-probably-threadsafe-access-outside-of-lock4\n-   Helgrind:Race\n-   fun:_ZN15lock_and_signal4waitEv\n-   ...\n-}\n-\n-{\n-   uv-async-send-does-racy-things\n-   Helgrind:Race\n-   fun:pipecb\n-   fun:ev_invoke_pending\n-   fun:ev_run\n-   fun:uv_run\n-   ...\n-}\n-\n-{\n-   uv-loop-init-does-some-checks-that-are-not-lock-protected\n-   Helgrind:Race\n-   fun:loop_init\n-   fun:ev_loop_new\n-   fun:uv_loop_new\n-   ...\n-}\n-\n-{\n-   random-locking-order-but-it-only-happens-in-a-single-thread-at-a-time-I-polled-2-other-people-and-they-thought-it-was-prabably-ok\n-   Helgrind:LockOrder\n-   fun:pthread_mutex_lock\n-   fun:_ZN15lock_and_signal4lockEv\n-   fun:_ZN18rust_port_selector6selectEP9rust_taskPP9rust_portS4_mPm\n-   ...\n-}\n-\n-{\n-   random-locking-order-but-it-only-happens-in-a-single-thread-at-a-time-I-polled-2-other-people-and-they-thought-it-was-prabably-ok\n-   Helgrind:LockOrder\n-   fun:pthread_mutex_lock\n-   fun:pthread_mutex_lock\n-   fun:_ZN15lock_and_signal4lockEv\n-   fun:_ZN18rust_port_selector6selectEP9rust_taskPP9rust_portS4_mPm\n-   ...\n-}\n-\n-{\n-   random-locking-order-but-it-only-happens-in-a-single-thread-at-a-time-I-polled-2-other-people-and-they-thought-it-was-prabably-ok-i686\n-   Helgrind:LockOrder\n-   fun:pthread_mutex_lock\n-   fun:pthread_mutex_lock\n-   fun:_ZN15lock_and_signal4lockEv\n-   fun:_ZN18rust_port_selector6selectEP9rust_taskPP9rust_portS4_jPj\n-}\n-\n-{\n-   libunwind-surely-this-is-ok\n-   Helgrind:Race\n-   ...\n-   fun:_Unwind_RaiseException\n-   fun:__cxa_throw\n-   ...\n-}\n-\n-{\n-   libunwind-surely-this-is-ok2\n-   Helgrind:Race\n-   ...\n-   fun:_Unwind_Resume\n-   ...\n-}\n-\n-{\n-   libunwind-surely-this-is-ok3\n-   Helgrind:Race\n-   fun:_Unwind_SetGR\n-   fun:__gxx_personality_v0\n-   ...\n-}\n-\n-{\n-   goddammit-llvm-why-u-no-valgrind\n-   Memcheck:Cond\n-   fun:*\n+   match-leak-kinds: definite\n+   fun:malloc\n+   fun:tlv_allocate_and_initialize_for_key\n+   fun:tlv_get_addr\n    ...\n+   fun:start\n }"}, {"sha": "5c449d511d53bf01c672a8720287bb81db462d79", "filename": "src/test/run-pass-valgrind/down-with-thread-dtors.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/4afa9d90036b2b092bd277215a1291377ca7d9bf/src%2Ftest%2Frun-pass-valgrind%2Fdown-with-thread-dtors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4afa9d90036b2b092bd277215a1291377ca7d9bf/src%2Ftest%2Frun-pass-valgrind%2Fdown-with-thread-dtors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-valgrind%2Fdown-with-thread-dtors.rs?ref=4afa9d90036b2b092bd277215a1291377ca7d9bf", "previous_filename": "src/test/run-pass/down-with-thread-dtors.rs"}, {"sha": "76ecbfd2f223d2945f3c0ca41ebc2b564dbbe624", "filename": "src/test/run-pass-valgrind/exit-flushes.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/4afa9d90036b2b092bd277215a1291377ca7d9bf/src%2Ftest%2Frun-pass-valgrind%2Fexit-flushes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4afa9d90036b2b092bd277215a1291377ca7d9bf/src%2Ftest%2Frun-pass-valgrind%2Fexit-flushes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-valgrind%2Fexit-flushes.rs?ref=4afa9d90036b2b092bd277215a1291377ca7d9bf", "previous_filename": "src/test/run-pass/exit-flushes.rs"}, {"sha": "41b34dc79bd954d274f098a255ad2560576819ca", "filename": "src/test/run-pass-valgrind/osx-frameworks.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/4afa9d90036b2b092bd277215a1291377ca7d9bf/src%2Ftest%2Frun-pass-valgrind%2Fosx-frameworks.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4afa9d90036b2b092bd277215a1291377ca7d9bf/src%2Ftest%2Frun-pass-valgrind%2Fosx-frameworks.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-valgrind%2Fosx-frameworks.rs?ref=4afa9d90036b2b092bd277215a1291377ca7d9bf", "previous_filename": "src/test/run-pass/osx-frameworks.rs"}, {"sha": "aa1ef2025a015a8894e4508fba5a509b073aa01d", "filename": "src/test/run-pass/atomic-print.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4afa9d90036b2b092bd277215a1291377ca7d9bf/src%2Ftest%2Frun-pass%2Fatomic-print.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4afa9d90036b2b092bd277215a1291377ca7d9bf/src%2Ftest%2Frun-pass%2Fatomic-print.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fatomic-print.rs?ref=4afa9d90036b2b092bd277215a1291377ca7d9bf", "patch": "@@ -41,7 +41,7 @@ fn main(){\n             match line.chars().next().unwrap() {\n                 '1' => assert_eq!(line, \"11111\"),\n                 '2' => assert_eq!(line, \"22222\"),\n-                _   => panic!(\"Unexpected character\")\n+                chr => panic!(\"unexpected character {:?}\", chr)\n             }\n         }\n     }"}]}