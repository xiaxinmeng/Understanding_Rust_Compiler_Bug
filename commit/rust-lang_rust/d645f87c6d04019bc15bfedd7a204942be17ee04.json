{"sha": "d645f87c6d04019bc15bfedd7a204942be17ee04", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ2NDVmODdjNmQwNDAxOWJjMTViZmVkZDdhMjA0OTQyYmUxN2VlMDQ=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-11-11T23:50:57Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-11-12T00:11:34Z"}, "message": "Rehabilitate run-pass/task-comm.rs", "tree": {"sha": "9d28a85bd25aeeba76a51a9374f53495bd115925", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9d28a85bd25aeeba76a51a9374f53495bd115925"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d645f87c6d04019bc15bfedd7a204942be17ee04", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d645f87c6d04019bc15bfedd7a204942be17ee04", "html_url": "https://github.com/rust-lang/rust/commit/d645f87c6d04019bc15bfedd7a204942be17ee04", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d645f87c6d04019bc15bfedd7a204942be17ee04/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3d9023fa4ddc8dbb5d9be0e4e4ef5c284c6b077a", "url": "https://api.github.com/repos/rust-lang/rust/commits/3d9023fa4ddc8dbb5d9be0e4e4ef5c284c6b077a", "html_url": "https://github.com/rust-lang/rust/commit/3d9023fa4ddc8dbb5d9be0e4e4ef5c284c6b077a"}], "stats": {"total": 18, "additions": 9, "deletions": 9}, "files": [{"sha": "ad4bb2ee1ce6c5792d434560b2fb39029ab34fbe", "filename": "src/test/run-pass/task-comm.rs", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/d645f87c6d04019bc15bfedd7a204942be17ee04/src%2Ftest%2Frun-pass%2Ftask-comm.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d645f87c6d04019bc15bfedd7a204942be17ee04/src%2Ftest%2Frun-pass%2Ftask-comm.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Ftask-comm.rs?ref=d645f87c6d04019bc15bfedd7a204942be17ee04", "patch": "@@ -1,4 +1,3 @@\n-// xfail-test\n use std;\n \n import std::task;\n@@ -19,7 +18,8 @@ fn main() {\n     test06();\n }\n \n-fn test00_start(ch: chan<int>, message: int, count: int) {\n+fn test00_start(&&args: (chan<int>, int, int)) {\n+    let (ch, message, count) = args;\n     log \"Starting test00_start\";\n     let i: int = 0;\n     while i < count {\n@@ -43,8 +43,8 @@ fn test00() {\n     let tasks = [];\n     while i < number_of_tasks {\n         i = i + 1;\n-        let thunk = bind test00_start(ch, i, number_of_messages);\n-        tasks += [task::spawn_joinable(thunk)];\n+        tasks += [task::spawn_joinable(\n+            (ch, i, number_of_messages), test00_start)];\n     }\n     let sum: int = 0;\n     for t in tasks {\n@@ -90,7 +90,7 @@ fn test03() {\n     log v.length();\n }\n \n-fn test04_start() {\n+fn test04_start(&&_args: ()) {\n     log \"Started task\";\n     let i: int = 1024 * 1024;\n     while i > 0 { i = i - 1; }\n@@ -100,7 +100,7 @@ fn test04_start() {\n fn test04() {\n     log \"Spawning lots of tasks.\";\n     let i: int = 4;\n-    while i > 0 { i = i - 1; let f = test04_start; task::spawn(f); }\n+    while i > 0 { i = i - 1; task::spawn((), test04_start); }\n     log \"Finishing up.\";\n }\n \n@@ -115,15 +115,15 @@ fn test05_start(ch: chan<int>) {\n fn test05() {\n     let po = comm::port();\n     let ch = chan(po);\n-    task::spawn(bind test05_start(ch));\n+    task::spawn(ch, test05_start);\n     let value: int;\n     value = recv(po);\n     value = recv(po);\n     value = recv(po);\n     log value;\n }\n \n-fn test06_start(task_number: int) {\n+fn test06_start(&&task_number: int) {\n     log \"Started task.\";\n     let i: int = 0;\n     while i < 1000000 { i = i + 1; }\n@@ -139,7 +139,7 @@ fn test06() {\n     let tasks = [];\n     while i < number_of_tasks {\n         i = i + 1;\n-        tasks += [task::spawn_joinable(bind test06_start(i))];\n+        tasks += [task::spawn_joinable(copy i, test06_start)];\n     }\n \n "}]}