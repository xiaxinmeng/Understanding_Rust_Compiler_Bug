{"sha": "9ae76b363c1c109b1e2ab363f92ef9db80b18075", "node_id": "MDY6Q29tbWl0NzI0NzEyOjlhZTc2YjM2M2MxYzEwOWIxZTJhYjM2M2Y5MmVmOWRiODBiMTgwNzU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2016-01-21T19:01:24Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2016-01-21T19:01:24Z"}, "message": "Auto merge of #31028 - erickt:ast-json, r=michaelwoerister\n\nThe protocol for `serialize::{En,De}code` doesn't allow for two integers to be serialized next to each other.\n\nCloses #31025.\n\ncc @michaelwoerister", "tree": {"sha": "27d2b8ab9ec2068368663827c90a605a7c20f3f1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/27d2b8ab9ec2068368663827c90a605a7c20f3f1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9ae76b363c1c109b1e2ab363f92ef9db80b18075", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9ae76b363c1c109b1e2ab363f92ef9db80b18075", "html_url": "https://github.com/rust-lang/rust/commit/9ae76b363c1c109b1e2ab363f92ef9db80b18075", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9ae76b363c1c109b1e2ab363f92ef9db80b18075/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c6ba7fee97e6834f3a72281f88621c10bd562669", "url": "https://api.github.com/repos/rust-lang/rust/commits/c6ba7fee97e6834f3a72281f88621c10bd562669", "html_url": "https://github.com/rust-lang/rust/commit/c6ba7fee97e6834f3a72281f88621c10bd562669"}, {"sha": "1dc7eb8853f3ff5d8e4f7e4a717c55a7073f5533", "url": "https://api.github.com/repos/rust-lang/rust/commits/1dc7eb8853f3ff5d8e4f7e4a717c55a7073f5533", "html_url": "https://github.com/rust-lang/rust/commit/1dc7eb8853f3ff5d8e4f7e4a717c55a7073f5533"}], "stats": {"total": 25, "additions": 20, "deletions": 5}, "files": [{"sha": "8d6c0df981f23d09eaa9f4c56b9800c3656fe70a", "filename": "src/libsyntax/codemap.rs", "status": "modified", "additions": 20, "deletions": 5, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/9ae76b363c1c109b1e2ab363f92ef9db80b18075/src%2Flibsyntax%2Fcodemap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9ae76b363c1c109b1e2ab363f92ef9db80b18075/src%2Flibsyntax%2Fcodemap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fcodemap.rs?ref=9ae76b363c1c109b1e2ab363f92ef9db80b18075", "patch": "@@ -164,16 +164,31 @@ impl Eq for Span {}\n \n impl Encodable for Span {\n     fn encode<S: Encoder>(&self, s: &mut S) -> Result<(), S::Error> {\n-        try!(s.emit_u32(self.lo.0));\n-        s.emit_u32(self.hi.0)\n+        s.emit_struct(\"Span\", 2, |s| {\n+            try!(s.emit_struct_field(\"lo\", 0, |s| {\n+                self.lo.encode(s)\n+            }));\n+\n+            s.emit_struct_field(\"hi\", 1, |s| {\n+                self.hi.encode(s)\n+            })\n+        })\n     }\n }\n \n impl Decodable for Span {\n     fn decode<D: Decoder>(d: &mut D) -> Result<Span, D::Error> {\n-        let lo = BytePos(try! { d.read_u32() });\n-        let hi = BytePos(try! { d.read_u32() });\n-        Ok(mk_sp(lo, hi))\n+        d.read_struct(\"Span\", 2, |d| {\n+            let lo = try!(d.read_struct_field(\"lo\", 0, |d| {\n+                BytePos::decode(d)\n+            }));\n+\n+            let hi = try!(d.read_struct_field(\"hi\", 1, |d| {\n+                BytePos::decode(d)\n+            }));\n+\n+            Ok(mk_sp(lo, hi))\n+        })\n     }\n }\n "}]}