{"sha": "d0563c64b8264e55b130c2fe7044b37daf6d91b0", "node_id": "C_kwDOAAsO6NoAKGQwNTYzYzY0YjgyNjRlNTViMTMwYzJmZTcwNDRiMzdkYWY2ZDkxYjA", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-12-09T21:31:58Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-12-09T21:31:58Z"}, "message": "Rollup merge of #105504 - notriddle:notriddle/stab-css, r=GuillaumeGomez\n\nrustdoc: make stability badge CSS more consistent\n\n# Before\n\n![image](https://user-images.githubusercontent.com/1593513/206763667-8e0deb74-be63-4906-8229-9a7eb51725c2.png)\n\n![image](https://user-images.githubusercontent.com/1593513/206764007-6301c0e8-4594-4a41-ba93-105824dffee6.png)\n\n# After\n\n![image](https://user-images.githubusercontent.com/1593513/206763698-e187cee2-3a50-4e48-b7b5-c3cfa41a797d.png)\n\n![image](https://user-images.githubusercontent.com/1593513/206764058-3999ee67-1439-4c98-8216-b90575342aa8.png)\n\n# Description\n\n* They all get rounded corners now. A test case has been added for this, too.\n\n* There are now broadly two kinds of stability badge, where there used to be three: item-info \"fat badge\", and the \"thin badge\" in both item tables and in docblocks (which got merged). The fat badges can have icons, while the thin badges can't.\n\n* The old Ayu design doesn't make sense to me. Does anyone know why it was done that way?", "tree": {"sha": "f7a9d6bd6c86ffeaf8606e9166e24428ca09bc26", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f7a9d6bd6c86ffeaf8606e9166e24428ca09bc26"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d0563c64b8264e55b130c2fe7044b37daf6d91b0", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjk6lOCRBK7hj4Ov3rIwAA4fIIADzaEOGitGPGT8wKwfWqB8nR\nIHWSYMnTpe5xBIbQ62xqDwnFJPf1Qz7roVp0Phmy9pCO2E/cJf87oEfoUYxJAsxq\nquEotpZOMaetoGebDC9Ffa8rKnkDBevGvuy9UfxWCOjbXmx5/yzWQSTKIZJWgAiI\nmfexeZlHYv+UFjBLdVdIK1jutxic+bsEZxilyLyTxMUVUaNY4Xui7qFVwkSJtqyt\nKImmcdeEh53Oadww11YdjbyVhbtfh6YyZsnjvcTsfMYAIXUopk5lQ48KYHth/4PM\n4+UbwzolaVKcKjGjciZE5tAlL5rRo6fZhux4IH3X5bSmEOPEYD69JvQLuONBr3Y=\n=9/Zz\n-----END PGP SIGNATURE-----\n", "payload": "tree f7a9d6bd6c86ffeaf8606e9166e24428ca09bc26\nparent f78babd6c480266996d6cbfde747600fcf73cf09\nparent d60967bef29b4b9ad5c145f216a582da28b22505\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1670621518 +0100\ncommitter GitHub <noreply@github.com> 1670621518 +0100\n\nRollup merge of #105504 - notriddle:notriddle/stab-css, r=GuillaumeGomez\n\nrustdoc: make stability badge CSS more consistent\n\n# Before\n\n![image](https://user-images.githubusercontent.com/1593513/206763667-8e0deb74-be63-4906-8229-9a7eb51725c2.png)\n\n![image](https://user-images.githubusercontent.com/1593513/206764007-6301c0e8-4594-4a41-ba93-105824dffee6.png)\n\n# After\n\n![image](https://user-images.githubusercontent.com/1593513/206763698-e187cee2-3a50-4e48-b7b5-c3cfa41a797d.png)\n\n![image](https://user-images.githubusercontent.com/1593513/206764058-3999ee67-1439-4c98-8216-b90575342aa8.png)\n\n# Description\n\n* They all get rounded corners now. A test case has been added for this, too.\n\n* There are now broadly two kinds of stability badge, where there used to be three: item-info \"fat badge\", and the \"thin badge\" in both item tables and in docblocks (which got merged). The fat badges can have icons, while the thin badges can't.\n\n* The old Ayu design doesn't make sense to me. Does anyone know why it was done that way?\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d0563c64b8264e55b130c2fe7044b37daf6d91b0", "html_url": "https://github.com/rust-lang/rust/commit/d0563c64b8264e55b130c2fe7044b37daf6d91b0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d0563c64b8264e55b130c2fe7044b37daf6d91b0/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f78babd6c480266996d6cbfde747600fcf73cf09", "url": "https://api.github.com/repos/rust-lang/rust/commits/f78babd6c480266996d6cbfde747600fcf73cf09", "html_url": "https://github.com/rust-lang/rust/commit/f78babd6c480266996d6cbfde747600fcf73cf09"}, {"sha": "d60967bef29b4b9ad5c145f216a582da28b22505", "url": "https://api.github.com/repos/rust-lang/rust/commits/d60967bef29b4b9ad5c145f216a582da28b22505", "html_url": "https://github.com/rust-lang/rust/commit/d60967bef29b4b9ad5c145f216a582da28b22505"}], "stats": {"total": 81, "additions": 54, "deletions": 27}, "files": [{"sha": "91162ca4892ca0a43caa71b64d54696bee1a69a7", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 13, "deletions": 22, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/d0563c64b8264e55b130c2fe7044b37daf6d91b0/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/d0563c64b8264e55b130c2fe7044b37daf6d91b0/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=d0563c64b8264e55b130c2fe7044b37daf6d91b0", "patch": "@@ -212,7 +212,7 @@ pre.rust a,\n .mobile-topbar h2 a,\n h1 a,\n .search-results a,\n-.item-left .stab,\n+.stab,\n .result-name .primitive > i, .result-name .keyword > i {\n \tcolor: var(--main-color);\n }\n@@ -960,22 +960,29 @@ so that we can apply CSS-filters to change the arrow color in themes */\n }\n \n .item-info .stab {\n-\twidth: fit-content;\n \t/* This min-height is needed to unify the height of the stab elements because some of them\n \t   have emojis.\n \t*/\n \tmin-height: 36px;\n \tdisplay: flex;\n-\talign-items: center;\n-\twhite-space: pre-wrap;\n-}\n-.stab {\n \tpadding: 3px;\n \tmargin-bottom: 5px;\n+}\n+.item-left .stab {\n+\tmargin-left: 0.3125em;\n+}\n+.stab {\n+\tpadding: 0 2px;\n \tfont-size: 0.875rem;\n \tfont-weight: normal;\n \tcolor: var(--main-color);\n \tbackground-color: var(--stab-background-color);\n+\twidth: fit-content;\n+\talign-items: center;\n+\twhite-space: pre-wrap;\n+\tborder-radius: 3px;\n+\tdisplay: inline-flex;\n+\tvertical-align: text-bottom;\n }\n \n .stab.portability > code {\n@@ -988,12 +995,6 @@ so that we can apply CSS-filters to change the arrow color in themes */\n \tmargin-right: 0.3rem;\n }\n \n-/* This is to prevent the `.stab` elements to overflow the .docblock elements. */\n-.docblock .stab {\n-\tpadding: 0 0.125em;\n-\tmargin-bottom: 0;\n-}\n-\n /* Black one-pixel outline around emoji shapes */\n .emoji {\n \ttext-shadow:\n@@ -1003,16 +1004,6 @@ so that we can apply CSS-filters to change the arrow color in themes */\n \t\t0 -1px 0 black;\n }\n \n-.item-left .stab {\n-\tborder-radius: 3px;\n-\tdisplay: inline-block;\n-\tline-height: 1.2;\n-\tmargin-bottom: 0;\n-\tmargin-left: 0.3125em;\n-\tpadding: 2px;\n-\tvertical-align: text-bottom;\n-}\n-\n .module-item.unstable,\n .import-item.unstable {\n \topacity: 0.65;"}, {"sha": "eba845bf5a91565f2219f56f71c9eeb8701526a2", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/d0563c64b8264e55b130c2fe7044b37daf6d91b0/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/d0563c64b8264e55b130c2fe7044b37daf6d91b0/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=d0563c64b8264e55b130c2fe7044b37daf6d91b0", "patch": "@@ -160,11 +160,6 @@ body.source .example-wrap pre.rust a {\n \tbackground: #333;\n }\n \n-.module-item .stab,\n-.import-item .stab {\n-\tcolor: #000;\n-}\n-\n .result-name .primitive > i, .result-name .keyword > i {\n \tcolor: #788797;\n }"}, {"sha": "aaed8440a40bd44807ac174149a1128732eba65e", "filename": "src/test/rustdoc-gui/stab-badge.goml", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/rust-lang/rust/blob/d0563c64b8264e55b130c2fe7044b37daf6d91b0/src%2Ftest%2Frustdoc-gui%2Fstab-badge.goml", "raw_url": "https://github.com/rust-lang/rust/raw/d0563c64b8264e55b130c2fe7044b37daf6d91b0/src%2Ftest%2Frustdoc-gui%2Fstab-badge.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fstab-badge.goml?ref=d0563c64b8264e55b130c2fe7044b37daf6d91b0", "patch": "@@ -0,0 +1,41 @@\n+// All stability badges should have rounded corners and colored backgrounds.\n+goto: \"file://\" + |DOC_PATH| + \"/test_docs/index.html\"\n+show-text: true\n+define-function: (\n+\t\"check-badge\",\n+\t(theme, background, color),\n+\t[\n+        (\"local-storage\", {\"rustdoc-use-system-theme\": \"false\", \"rustdoc-theme\": |theme|}),\n+        (\"goto\", \"file://\" + |DOC_PATH| + \"/test_docs/index.html\"),\n+\t\t(\"assert\", (\".docblock .stab\")),\n+\t\t(\"assert\", (\".item-table .stab\")),\n+\t\t(\"assert-css\", (\".stab\", {\n+\t\t\t\"border-radius\": \"3px\",\n+\t\t\t\"color\": |color|,\n+\t\t\t\"background-color\": |background|,\n+\t\t})),\n+        (\"goto\", \"file://\" + |DOC_PATH| + \"/test_docs/fn.replaced_function.html\"),\n+\t\t(\"assert\", (\".item-info .stab\")),\n+\t\t(\"assert-css\", (\".stab\", {\n+\t\t\t\"border-radius\": \"3px\",\n+\t\t\t\"color\": |color|,\n+\t\t\t\"background-color\": |background|,\n+\t\t})),\n+\t]\n+)\n+\n+call-function: (\"check-badge\", {\n+\t\"theme\": \"ayu\",\n+\t\"color\": \"rgb(197, 197, 197)\",\n+\t\"background\": \"rgb(49, 69, 89)\",\n+})\n+call-function: (\"check-badge\", {\n+\t\"theme\": \"dark\",\n+\t\"color\": \"rgb(221, 221, 221)\",\n+\t\"background\": \"rgb(49, 69, 89)\",\n+})\n+call-function: (\"check-badge\", {\n+\t\"theme\": \"light\",\n+\t\"color\": \"rgb(0, 0, 0)\",\n+\t\"background\": \"rgb(255, 245, 214)\",\n+})"}]}