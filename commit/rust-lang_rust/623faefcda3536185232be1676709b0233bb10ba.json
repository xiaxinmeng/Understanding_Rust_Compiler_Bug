{"sha": "623faefcda3536185232be1676709b0233bb10ba", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYyM2ZhZWZjZGEzNTM2MTg1MjMyYmUxNjc2NzA5YjAyMzNiYjEwYmE=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-05-01T23:57:21Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-05-02T09:21:39Z"}, "message": "Cleanup inline tests", "tree": {"sha": "ae6ebf582326ff8743f03dbf208c7456627db0c4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ae6ebf582326ff8743f03dbf208c7456627db0c4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/623faefcda3536185232be1676709b0233bb10ba", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/623faefcda3536185232be1676709b0233bb10ba", "html_url": "https://github.com/rust-lang/rust/commit/623faefcda3536185232be1676709b0233bb10ba", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/623faefcda3536185232be1676709b0233bb10ba/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "642a3392d94b85cf5802cef9ceaa3de7e4571680", "url": "https://api.github.com/repos/rust-lang/rust/commits/642a3392d94b85cf5802cef9ceaa3de7e4571680", "html_url": "https://github.com/rust-lang/rust/commit/642a3392d94b85cf5802cef9ceaa3de7e4571680"}], "stats": {"total": 95, "additions": 63, "deletions": 32}, "files": [{"sha": "efb424dae72cfd1d9b221d4dd5e61779c9d23cb8", "filename": "crates/ra_parser/src/grammar/expressions/atom.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fexpressions%2Fatom.rs", "raw_url": "https://github.com/rust-lang/rust/raw/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fexpressions%2Fatom.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fexpressions%2Fatom.rs?ref=623faefcda3536185232be1676709b0233bb10ba", "patch": "@@ -92,6 +92,8 @@ pub(super) fn atom_expr(p: &mut Parser, r: Restrictions) -> Option<(CompletedMar\n                 T![loop] => loop_expr(p, Some(m)),\n                 T![for] => for_expr(p, Some(m)),\n                 T![while] => while_expr(p, Some(m)),\n+                // test labeled_block\n+                // fn f() { 'label: {}; }\n                 T!['{'] => {\n                     block_expr(p);\n                     m.complete(p, EFFECT_EXPR)\n@@ -115,6 +117,8 @@ pub(super) fn atom_expr(p: &mut Parser, r: Restrictions) -> Option<(CompletedMar\n             m.complete(p, EFFECT_EXPR)\n         }\n         T![match] => match_expr(p),\n+        // test unsafe_block\n+        // fn f() { unsafe { } }\n         T![unsafe] if la == T!['{'] => {\n             let m = p.start();\n             p.bump(T![unsafe]);\n@@ -466,8 +470,6 @@ fn match_guard(p: &mut Parser) -> CompletedMarker {\n // test block_expr\n // fn foo() {\n //     {};\n-//     unsafe {};\n-//     'label: {};\n // }\n pub(super) fn block_expr(p: &mut Parser) -> CompletedMarker {\n     assert!(p.at(T!['{']));"}, {"sha": "f3a5e309652e9885761fafb8aaf07f43da24aa04", "filename": "crates/ra_syntax/test_data/parser/inline/ok/0105_block_expr.rast", "status": "modified", "additions": 6, "deletions": 26, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0105_block_expr.rast", "raw_url": "https://github.com/rust-lang/rust/raw/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0105_block_expr.rast", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0105_block_expr.rast?ref=623faefcda3536185232be1676709b0233bb10ba", "patch": "@@ -1,5 +1,5 @@\n-SOURCE_FILE@0..52\n-  FN_DEF@0..51\n+SOURCE_FILE@0..21\n+  FN_DEF@0..20\n     FN_KW@0..2 \"fn\"\n     WHITESPACE@2..3 \" \"\n     NAME@3..6\n@@ -8,34 +8,14 @@ SOURCE_FILE@0..52\n       L_PAREN@6..7 \"(\"\n       R_PAREN@7..8 \")\"\n     WHITESPACE@8..9 \" \"\n-    BLOCK_EXPR@9..51\n+    BLOCK_EXPR@9..20\n       L_CURLY@9..10 \"{\"\n       WHITESPACE@10..15 \"\\n    \"\n       EXPR_STMT@15..18\n         BLOCK_EXPR@15..17\n           L_CURLY@15..16 \"{\"\n           R_CURLY@16..17 \"}\"\n         SEMICOLON@17..18 \";\"\n-      WHITESPACE@18..23 \"\\n    \"\n-      EXPR_STMT@23..33\n-        EFFECT_EXPR@23..32\n-          UNSAFE_KW@23..29 \"unsafe\"\n-          WHITESPACE@29..30 \" \"\n-          BLOCK_EXPR@30..32\n-            L_CURLY@30..31 \"{\"\n-            R_CURLY@31..32 \"}\"\n-        SEMICOLON@32..33 \";\"\n-      WHITESPACE@33..38 \"\\n    \"\n-      EXPR_STMT@38..49\n-        EFFECT_EXPR@38..48\n-          LABEL@38..45\n-            LIFETIME@38..44 \"\\'label\"\n-            COLON@44..45 \":\"\n-          WHITESPACE@45..46 \" \"\n-          BLOCK_EXPR@46..48\n-            L_CURLY@46..47 \"{\"\n-            R_CURLY@47..48 \"}\"\n-        SEMICOLON@48..49 \";\"\n-      WHITESPACE@49..50 \"\\n\"\n-      R_CURLY@50..51 \"}\"\n-  WHITESPACE@51..52 \"\\n\"\n+      WHITESPACE@18..19 \"\\n\"\n+      R_CURLY@19..20 \"}\"\n+  WHITESPACE@20..21 \"\\n\""}, {"sha": "9c6019fb1a66af857226be9ddd007f0fed5c10b2", "filename": "crates/ra_syntax/test_data/parser/inline/ok/0105_block_expr.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0105_block_expr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0105_block_expr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0105_block_expr.rs?ref=623faefcda3536185232be1676709b0233bb10ba", "patch": "@@ -1,5 +1,3 @@\n fn foo() {\n     {};\n-    unsafe {};\n-    'label: {};\n }"}, {"sha": "93cc41533f52788775e38a923f4e97775aaf2993", "filename": "crates/ra_syntax/test_data/parser/inline/ok/0127_attr_on_last_expr_in_block.rast", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0127_attr_on_last_expr_in_block.rast", "raw_url": "https://github.com/rust-lang/rust/raw/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0127_attr_on_last_expr_in_block.rast", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0127_attr_on_last_expr_in_block.rast?ref=623faefcda3536185232be1676709b0233bb10ba", "patch": "@@ -15,7 +15,7 @@ SOURCE_FILE@0..47\n         BLOCK_EXPR@15..31\n           L_CURLY@15..16 \"{\"\n           WHITESPACE@16..17 \" \"\n-          EFFECT_EXPR@17..29\n+          TRY_EXPR@17..29\n             ATTR@17..21\n               POUND@17..18 \"#\"\n               L_BRACK@18..19 \"[\""}, {"sha": "8e8d9e992094aac979160efbf1caab2e5fc5560c", "filename": "crates/ra_syntax/test_data/parser/inline/ok/0137_await_expr.rast", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0137_await_expr.rast", "raw_url": "https://github.com/rust-lang/rust/raw/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0137_await_expr.rast", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0137_await_expr.rast?ref=623faefcda3536185232be1676709b0233bb10ba", "patch": "@@ -39,7 +39,7 @@ SOURCE_FILE@0..67\n       WHITESPACE@38..43 \"\\n    \"\n       EXPR_STMT@43..64\n         METHOD_CALL_EXPR@43..63\n-          EFFECT_EXPR@43..55\n+          TRY_EXPR@43..55\n             AWAIT_EXPR@43..54\n               CALL_EXPR@43..48\n                 FIELD_EXPR@43..46"}, {"sha": "9efebd8b8abb5be674e6356d894a6c28cba98309", "filename": "crates/ra_syntax/test_data/parser/inline/ok/0161_labeled_block.rast", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0161_labeled_block.rast", "raw_url": "https://github.com/rust-lang/rust/raw/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0161_labeled_block.rast", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0161_labeled_block.rast?ref=623faefcda3536185232be1676709b0233bb10ba", "patch": "@@ -0,0 +1,26 @@\n+SOURCE_FILE@0..23\n+  FN_DEF@0..22\n+    FN_KW@0..2 \"fn\"\n+    WHITESPACE@2..3 \" \"\n+    NAME@3..4\n+      IDENT@3..4 \"f\"\n+    PARAM_LIST@4..6\n+      L_PAREN@4..5 \"(\"\n+      R_PAREN@5..6 \")\"\n+    WHITESPACE@6..7 \" \"\n+    BLOCK_EXPR@7..22\n+      L_CURLY@7..8 \"{\"\n+      WHITESPACE@8..9 \" \"\n+      EXPR_STMT@9..20\n+        EFFECT_EXPR@9..19\n+          LABEL@9..16\n+            LIFETIME@9..15 \"\\'label\"\n+            COLON@15..16 \":\"\n+          WHITESPACE@16..17 \" \"\n+          BLOCK_EXPR@17..19\n+            L_CURLY@17..18 \"{\"\n+            R_CURLY@18..19 \"}\"\n+        SEMICOLON@19..20 \";\"\n+      WHITESPACE@20..21 \" \"\n+      R_CURLY@21..22 \"}\"\n+  WHITESPACE@22..23 \"\\n\""}, {"sha": "18b4ff4b1badae1507f6dcf910c5b0d689fee246", "filename": "crates/ra_syntax/test_data/parser/inline/ok/0161_labeled_block.rs", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0161_labeled_block.rs", "raw_url": "https://github.com/rust-lang/rust/raw/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0161_labeled_block.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0161_labeled_block.rs?ref=623faefcda3536185232be1676709b0233bb10ba", "patch": "@@ -0,0 +1 @@\n+fn f() { 'label: {}; }"}, {"sha": "4991f2c36b871f6c87e5341a375d8ffc1de0ec4d", "filename": "crates/ra_syntax/test_data/parser/inline/ok/0162_unsafe_block.rast", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0162_unsafe_block.rast", "raw_url": "https://github.com/rust-lang/rust/raw/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0162_unsafe_block.rast", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0162_unsafe_block.rast?ref=623faefcda3536185232be1676709b0233bb10ba", "patch": "@@ -0,0 +1,23 @@\n+SOURCE_FILE@0..22\n+  FN_DEF@0..21\n+    FN_KW@0..2 \"fn\"\n+    WHITESPACE@2..3 \" \"\n+    NAME@3..4\n+      IDENT@3..4 \"f\"\n+    PARAM_LIST@4..6\n+      L_PAREN@4..5 \"(\"\n+      R_PAREN@5..6 \")\"\n+    WHITESPACE@6..7 \" \"\n+    BLOCK_EXPR@7..21\n+      L_CURLY@7..8 \"{\"\n+      WHITESPACE@8..9 \" \"\n+      EFFECT_EXPR@9..19\n+        UNSAFE_KW@9..15 \"unsafe\"\n+        WHITESPACE@15..16 \" \"\n+        BLOCK_EXPR@16..19\n+          L_CURLY@16..17 \"{\"\n+          WHITESPACE@17..18 \" \"\n+          R_CURLY@18..19 \"}\"\n+      WHITESPACE@19..20 \" \"\n+      R_CURLY@20..21 \"}\"\n+  WHITESPACE@21..22 \"\\n\""}, {"sha": "dfb9b2a1c18721c7ab11d87727db82431992e8b2", "filename": "crates/ra_syntax/test_data/parser/inline/ok/0162_unsafe_block.rs", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0162_unsafe_block.rs", "raw_url": "https://github.com/rust-lang/rust/raw/623faefcda3536185232be1676709b0233bb10ba/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0162_unsafe_block.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0162_unsafe_block.rs?ref=623faefcda3536185232be1676709b0233bb10ba", "patch": "@@ -0,0 +1 @@\n+fn f() { unsafe { } }"}]}