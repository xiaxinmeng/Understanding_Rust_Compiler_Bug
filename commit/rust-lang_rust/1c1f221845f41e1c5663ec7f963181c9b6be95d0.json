{"sha": "1c1f221845f41e1c5663ec7f963181c9b6be95d0", "node_id": "C_kwDOAAsO6NoAKDFjMWYyMjE4NDVmNDFlMWM1NjYzZWM3Zjk2MzE4MWM5YjZiZTk1ZDA", "commit": {"author": {"name": "Mara Bos", "email": "m-ou.se@m-ou.se", "date": "2022-05-25T10:18:48Z"}, "committer": {"name": "Mara Bos", "email": "m-ou.se@m-ou.se", "date": "2022-05-25T10:18:48Z"}, "message": "Tweak memory ordering diagnostic.", "tree": {"sha": "eedc71c60ae9e8f11991dd38e7d916bc5b26996f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/eedc71c60ae9e8f11991dd38e7d916bc5b26996f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1c1f221845f41e1c5663ec7f963181c9b6be95d0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1c1f221845f41e1c5663ec7f963181c9b6be95d0", "html_url": "https://github.com/rust-lang/rust/commit/1c1f221845f41e1c5663ec7f963181c9b6be95d0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1c1f221845f41e1c5663ec7f963181c9b6be95d0/comments", "author": {"login": "m-ou-se", "id": 783247, "node_id": "MDQ6VXNlcjc4MzI0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/783247?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m-ou-se", "html_url": "https://github.com/m-ou-se", "followers_url": "https://api.github.com/users/m-ou-se/followers", "following_url": "https://api.github.com/users/m-ou-se/following{/other_user}", "gists_url": "https://api.github.com/users/m-ou-se/gists{/gist_id}", "starred_url": "https://api.github.com/users/m-ou-se/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m-ou-se/subscriptions", "organizations_url": "https://api.github.com/users/m-ou-se/orgs", "repos_url": "https://api.github.com/users/m-ou-se/repos", "events_url": "https://api.github.com/users/m-ou-se/events{/privacy}", "received_events_url": "https://api.github.com/users/m-ou-se/received_events", "type": "User", "site_admin": false}, "committer": {"login": "m-ou-se", "id": 783247, "node_id": "MDQ6VXNlcjc4MzI0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/783247?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m-ou-se", "html_url": "https://github.com/m-ou-se", "followers_url": "https://api.github.com/users/m-ou-se/followers", "following_url": "https://api.github.com/users/m-ou-se/following{/other_user}", "gists_url": "https://api.github.com/users/m-ou-se/gists{/gist_id}", "starred_url": "https://api.github.com/users/m-ou-se/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m-ou-se/subscriptions", "organizations_url": "https://api.github.com/users/m-ou-se/orgs", "repos_url": "https://api.github.com/users/m-ou-se/repos", "events_url": "https://api.github.com/users/m-ou-se/events{/privacy}", "received_events_url": "https://api.github.com/users/m-ou-se/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1b83dcffcee773bc94db998f8c37e1b1bfb67698", "url": "https://api.github.com/repos/rust-lang/rust/commits/1b83dcffcee773bc94db998f8c37e1b1bfb67698", "html_url": "https://github.com/rust-lang/rust/commit/1b83dcffcee773bc94db998f8c37e1b1bfb67698"}], "stats": {"total": 61, "additions": 24, "deletions": 37}, "files": [{"sha": "b3802b719fe369be7f5c37469d05ea2456f3fae9", "filename": "compiler/rustc_lint/src/types.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/1c1f221845f41e1c5663ec7f963181c9b6be95d0/compiler%2Frustc_lint%2Fsrc%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1c1f221845f41e1c5663ec7f963181c9b6be95d0/compiler%2Frustc_lint%2Fsrc%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Ftypes.rs?ref=1c1f221845f41e1c5663ec7f963181c9b6be95d0", "patch": "@@ -1582,7 +1582,12 @@ impl InvalidAtomicOrdering {\n                 ))\n                 .span_label(fail_order_arg.span, format!(\"{fail_ordering} failure ordering\"))\n                 .span_label(success_order_arg.span, format!(\"{success_ordering} success ordering\"))\n-                .help(format!(\"consider using {success_suggestion} success ordering instead\"))\n+                .span_suggestion_short(\n+                    success_order_arg.span,\n+                    format!(\"consider using {success_suggestion} success ordering instead\"),\n+                    success_suggestion.to_string(),\n+                    Applicability::MaybeIncorrect,\n+                )\n                 .emit();\n             });\n         }"}, {"sha": "030b065cf4f8b25e40df0edbce74a16647f417e0", "filename": "src/test/ui/lint/lint-invalid-atomic-ordering-exchange-weak.stderr", "status": "modified", "additions": 6, "deletions": 12, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/1c1f221845f41e1c5663ec7f963181c9b6be95d0/src%2Ftest%2Fui%2Flint%2Flint-invalid-atomic-ordering-exchange-weak.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1c1f221845f41e1c5663ec7f963181c9b6be95d0/src%2Ftest%2Fui%2Flint%2Flint-invalid-atomic-ordering-exchange-weak.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-invalid-atomic-ordering-exchange-weak.stderr?ref=1c1f221845f41e1c5663ec7f963181c9b6be95d0", "patch": "@@ -86,8 +86,7 @@ LL |     let _ = x.compare_exchange_weak(ptr2, ptr, Ordering::Release, Ordering:\n    |                                                ^^^^^^^^^^^^^^^^^  ----------------- Acquire failure ordering\n    |                                                |\n    |                                                Release success ordering\n-   |\n-   = help: consider using AcqRel success ordering instead\n+   |                                                help: consider using AcqRel success ordering instead\n \n error: compare_exchange_weak's success ordering must be at least as strong as its failure ordering\n   --> $DIR/lint-invalid-atomic-ordering-exchange-weak.rs:48:48\n@@ -96,8 +95,7 @@ LL |     let _ = x.compare_exchange_weak(ptr2, ptr, Ordering::Release, Ordering:\n    |                                                ^^^^^^^^^^^^^^^^^  ---------------- SeqCst failure ordering\n    |                                                |\n    |                                                Release success ordering\n-   |\n-   = help: consider using SeqCst success ordering instead\n+   |                                                help: consider using SeqCst success ordering instead\n \n error: compare_exchange_weak's success ordering must be at least as strong as its failure ordering\n   --> $DIR/lint-invalid-atomic-ordering-exchange-weak.rs:52:48\n@@ -106,8 +104,7 @@ LL |     let _ = x.compare_exchange_weak(ptr, ptr2, Ordering::Relaxed, Ordering:\n    |                                                ^^^^^^^^^^^^^^^^^  ---------------- SeqCst failure ordering\n    |                                                |\n    |                                                Relaxed success ordering\n-   |\n-   = help: consider using SeqCst success ordering instead\n+   |                                                help: consider using SeqCst success ordering instead\n \n error: compare_exchange_weak's success ordering must be at least as strong as its failure ordering\n   --> $DIR/lint-invalid-atomic-ordering-exchange-weak.rs:54:48\n@@ -116,8 +113,7 @@ LL |     let _ = x.compare_exchange_weak(ptr, ptr2, Ordering::Relaxed, Ordering:\n    |                                                ^^^^^^^^^^^^^^^^^  ----------------- Acquire failure ordering\n    |                                                |\n    |                                                Relaxed success ordering\n-   |\n-   = help: consider using Acquire success ordering instead\n+   |                                                help: consider using Acquire success ordering instead\n \n error: compare_exchange_weak's success ordering must be at least as strong as its failure ordering\n   --> $DIR/lint-invalid-atomic-ordering-exchange-weak.rs:58:48\n@@ -126,8 +122,7 @@ LL |     let _ = x.compare_exchange_weak(ptr2, ptr, Ordering::Acquire, Ordering:\n    |                                                ^^^^^^^^^^^^^^^^^  ---------------- SeqCst failure ordering\n    |                                                |\n    |                                                Acquire success ordering\n-   |\n-   = help: consider using SeqCst success ordering instead\n+   |                                                help: consider using SeqCst success ordering instead\n \n error: compare_exchange_weak's success ordering must be at least as strong as its failure ordering\n   --> $DIR/lint-invalid-atomic-ordering-exchange-weak.rs:60:48\n@@ -136,8 +131,7 @@ LL |     let _ = x.compare_exchange_weak(ptr2, ptr, Ordering::AcqRel, Ordering::\n    |                                                ^^^^^^^^^^^^^^^^  ---------------- SeqCst failure ordering\n    |                                                |\n    |                                                AcqRel success ordering\n-   |\n-   = help: consider using SeqCst success ordering instead\n+   |                                                help: consider using SeqCst success ordering instead\n \n error: aborting due to 16 previous errors\n "}, {"sha": "7bb12a81683466370366234871a1d0c5a8b3dd87", "filename": "src/test/ui/lint/lint-invalid-atomic-ordering-exchange.stderr", "status": "modified", "additions": 6, "deletions": 12, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/1c1f221845f41e1c5663ec7f963181c9b6be95d0/src%2Ftest%2Fui%2Flint%2Flint-invalid-atomic-ordering-exchange.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1c1f221845f41e1c5663ec7f963181c9b6be95d0/src%2Ftest%2Fui%2Flint%2Flint-invalid-atomic-ordering-exchange.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-invalid-atomic-ordering-exchange.stderr?ref=1c1f221845f41e1c5663ec7f963181c9b6be95d0", "patch": "@@ -86,8 +86,7 @@ LL |     let _ = x.compare_exchange(0, 0, Ordering::Release, Ordering::Acquire);\n    |                                      ^^^^^^^^^^^^^^^^^  ----------------- Acquire failure ordering\n    |                                      |\n    |                                      Release success ordering\n-   |\n-   = help: consider using AcqRel success ordering instead\n+   |                                      help: consider using AcqRel success ordering instead\n \n error: compare_exchange's success ordering must be at least as strong as its failure ordering\n   --> $DIR/lint-invalid-atomic-ordering-exchange.rs:46:38\n@@ -96,8 +95,7 @@ LL |     let _ = x.compare_exchange(0, 0, Ordering::Release, Ordering::SeqCst);\n    |                                      ^^^^^^^^^^^^^^^^^  ---------------- SeqCst failure ordering\n    |                                      |\n    |                                      Release success ordering\n-   |\n-   = help: consider using SeqCst success ordering instead\n+   |                                      help: consider using SeqCst success ordering instead\n \n error: compare_exchange's success ordering must be at least as strong as its failure ordering\n   --> $DIR/lint-invalid-atomic-ordering-exchange.rs:50:38\n@@ -106,8 +104,7 @@ LL |     let _ = x.compare_exchange(0, 0, Ordering::Relaxed, Ordering::SeqCst);\n    |                                      ^^^^^^^^^^^^^^^^^  ---------------- SeqCst failure ordering\n    |                                      |\n    |                                      Relaxed success ordering\n-   |\n-   = help: consider using SeqCst success ordering instead\n+   |                                      help: consider using SeqCst success ordering instead\n \n error: compare_exchange's success ordering must be at least as strong as its failure ordering\n   --> $DIR/lint-invalid-atomic-ordering-exchange.rs:52:38\n@@ -116,8 +113,7 @@ LL |     let _ = x.compare_exchange(0, 0, Ordering::Relaxed, Ordering::Acquire);\n    |                                      ^^^^^^^^^^^^^^^^^  ----------------- Acquire failure ordering\n    |                                      |\n    |                                      Relaxed success ordering\n-   |\n-   = help: consider using Acquire success ordering instead\n+   |                                      help: consider using Acquire success ordering instead\n \n error: compare_exchange's success ordering must be at least as strong as its failure ordering\n   --> $DIR/lint-invalid-atomic-ordering-exchange.rs:56:38\n@@ -126,8 +122,7 @@ LL |     let _ = x.compare_exchange(0, 0, Ordering::Acquire, Ordering::SeqCst);\n    |                                      ^^^^^^^^^^^^^^^^^  ---------------- SeqCst failure ordering\n    |                                      |\n    |                                      Acquire success ordering\n-   |\n-   = help: consider using SeqCst success ordering instead\n+   |                                      help: consider using SeqCst success ordering instead\n \n error: compare_exchange's success ordering must be at least as strong as its failure ordering\n   --> $DIR/lint-invalid-atomic-ordering-exchange.rs:58:38\n@@ -136,8 +131,7 @@ LL |     let _ = x.compare_exchange(0, 0, Ordering::AcqRel, Ordering::SeqCst);\n    |                                      ^^^^^^^^^^^^^^^^  ---------------- SeqCst failure ordering\n    |                                      |\n    |                                      AcqRel success ordering\n-   |\n-   = help: consider using SeqCst success ordering instead\n+   |                                      help: consider using SeqCst success ordering instead\n \n error: aborting due to 16 previous errors\n "}, {"sha": "f79936cbda93194b7bc34a208c1d1b05332e733a", "filename": "src/test/ui/lint/lint-invalid-atomic-ordering-fetch-update.stderr", "status": "modified", "additions": 6, "deletions": 12, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/1c1f221845f41e1c5663ec7f963181c9b6be95d0/src%2Ftest%2Fui%2Flint%2Flint-invalid-atomic-ordering-fetch-update.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1c1f221845f41e1c5663ec7f963181c9b6be95d0/src%2Ftest%2Fui%2Flint%2Flint-invalid-atomic-ordering-fetch-update.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-invalid-atomic-ordering-fetch-update.stderr?ref=1c1f221845f41e1c5663ec7f963181c9b6be95d0", "patch": "@@ -86,8 +86,7 @@ LL |     let _ = x.fetch_update(Ordering::Release, Ordering::Acquire, |old| Some\n    |                            ^^^^^^^^^^^^^^^^^  ----------------- Acquire failure ordering\n    |                            |\n    |                            Release success ordering\n-   |\n-   = help: consider using AcqRel success ordering instead\n+   |                            help: consider using AcqRel success ordering instead\n \n error: fetch_update's success ordering must be at least as strong as its failure ordering\n   --> $DIR/lint-invalid-atomic-ordering-fetch-update.rs:46:28\n@@ -96,8 +95,7 @@ LL |     let _ = x.fetch_update(Ordering::Release, Ordering::SeqCst, |old| Some(\n    |                            ^^^^^^^^^^^^^^^^^  ---------------- SeqCst failure ordering\n    |                            |\n    |                            Release success ordering\n-   |\n-   = help: consider using SeqCst success ordering instead\n+   |                            help: consider using SeqCst success ordering instead\n \n error: fetch_update's success ordering must be at least as strong as its failure ordering\n   --> $DIR/lint-invalid-atomic-ordering-fetch-update.rs:50:28\n@@ -106,8 +104,7 @@ LL |     let _ = x.fetch_update(Ordering::Relaxed, Ordering::SeqCst, |old| Some(\n    |                            ^^^^^^^^^^^^^^^^^  ---------------- SeqCst failure ordering\n    |                            |\n    |                            Relaxed success ordering\n-   |\n-   = help: consider using SeqCst success ordering instead\n+   |                            help: consider using SeqCst success ordering instead\n \n error: fetch_update's success ordering must be at least as strong as its failure ordering\n   --> $DIR/lint-invalid-atomic-ordering-fetch-update.rs:52:28\n@@ -116,8 +113,7 @@ LL |     let _ = x.fetch_update(Ordering::Relaxed, Ordering::Acquire, |old| Some\n    |                            ^^^^^^^^^^^^^^^^^  ----------------- Acquire failure ordering\n    |                            |\n    |                            Relaxed success ordering\n-   |\n-   = help: consider using Acquire success ordering instead\n+   |                            help: consider using Acquire success ordering instead\n \n error: fetch_update's success ordering must be at least as strong as its failure ordering\n   --> $DIR/lint-invalid-atomic-ordering-fetch-update.rs:56:28\n@@ -126,8 +122,7 @@ LL |     let _ = x.fetch_update(Ordering::Acquire, Ordering::SeqCst, |old| Some(\n    |                            ^^^^^^^^^^^^^^^^^  ---------------- SeqCst failure ordering\n    |                            |\n    |                            Acquire success ordering\n-   |\n-   = help: consider using SeqCst success ordering instead\n+   |                            help: consider using SeqCst success ordering instead\n \n error: fetch_update's success ordering must be at least as strong as its failure ordering\n   --> $DIR/lint-invalid-atomic-ordering-fetch-update.rs:58:28\n@@ -136,8 +131,7 @@ LL |     let _ = x.fetch_update(Ordering::AcqRel, Ordering::SeqCst, |old| Some(o\n    |                            ^^^^^^^^^^^^^^^^  ---------------- SeqCst failure ordering\n    |                            |\n    |                            AcqRel success ordering\n-   |\n-   = help: consider using SeqCst success ordering instead\n+   |                            help: consider using SeqCst success ordering instead\n \n error: aborting due to 16 previous errors\n "}]}