{"sha": "762b988a0a7740d6a9b5f99932036a4ae03dd6cb", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc2MmI5ODhhMGE3NzQwZDZhOWI1Zjk5OTMyMDM2YTRhZTAzZGQ2Y2I=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-02-15T16:55:59Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-02-16T06:11:52Z"}, "message": "Rollup merge of #58448 - euclio:missing-summaries, r=QuietMisdreavus\n\nrustdoc: mask `compiler_builtins` docs\n\nFixes #46783.\n\nI wasn't able to fully confirm the underlying cause, but my theory is that functions in `compiler_builtins` were overwriting functions with the same names in libcore in the search index. Since the functions in `compiler_builtins` didn't have docs, that's why they weren't appearing in the results.\n\nMasking the `compiler_builtins` crate fixes the search results. It appears that this crate was accidentally unmasked in #49503.", "tree": {"sha": "13a74da7decc8d8b9b316852d01d7baa56f34619", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/13a74da7decc8d8b9b316852d01d7baa56f34619"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/762b988a0a7740d6a9b5f99932036a4ae03dd6cb", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlxnqagACgkQ/vbIBR0O\nATzAww//U4mPxiH9jtGMNODu3zDjXi3eN0pM08HZPOLfM4XVAIINLskiXGTpNFL2\nPKLYO+PNGnPCZh/yLB5pKzqdzQyJvCai95IVcDROvHszifnr1vWBQqwxEdf6aotS\nw4ADn04m0eoGOL0X9J9+BjF6277CRjhpfcyROfXWEmfNIHkB+XZpQsIJZUu/Yt8H\n0WEFKU42a57qjS/xCiaSzFu0PwDXZZJhmC8/NyhzhVdlHaqlF1yMgR8/LlB284a4\ngMMNRX4o+4y1LbTEobDSbeS7HXzUHJshseZwye3SeYAL1Fa6kJ+Hn0OFS/kJz1Ix\nyo91XwVugiGhWh7TnsrnHHtxf3aeFxagkoBr6tB4D1Q6SpZqDajxFUQDaVnqk2Bo\nv/h9o2h1W1bljds1EZmfLE0RaoxGk2EMG17OjuXNgSSh+vs6es/EhwE3HuBelvad\nRlIg/XYB3tXhEyvqFqRWtLkSdfdEOtsInoU+SqxfVuMJmJwlIMNPc6P+gEq3H0zj\n6+DCRvQymXiEtQYFtwIuEPx1U/oio+HX3sw6TYinS2k4Hg38hPsm4RVnWzXgr3Ct\nYqPq0vR05NQ+8jtcaps813Me/30/HNWNnjZwOdekAzkzNVeorwvhE3B3N+daWpCP\nuFAr8fnKbWDxRgkJn/p82oFUuSBVkgnRQzS5UsC563l4xnvx9JU=\n=5Gzh\n-----END PGP SIGNATURE-----", "payload": "tree 13a74da7decc8d8b9b316852d01d7baa56f34619\nparent 30019ed41324c7018c3432482208d86d43517c6d\nparent f565efd617fc2b74bca7fa637faf9c6241008442\nauthor kennytm <kennytm@gmail.com> 1550249759 +0800\ncommitter kennytm <kennytm@gmail.com> 1550297512 +0800\n\nRollup merge of #58448 - euclio:missing-summaries, r=QuietMisdreavus\n\nrustdoc: mask `compiler_builtins` docs\n\nFixes #46783.\n\nI wasn't able to fully confirm the underlying cause, but my theory is that functions in `compiler_builtins` were overwriting functions with the same names in libcore in the search index. Since the functions in `compiler_builtins` didn't have docs, that's why they weren't appearing in the results.\n\nMasking the `compiler_builtins` crate fixes the search results. It appears that this crate was accidentally unmasked in #49503.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/762b988a0a7740d6a9b5f99932036a4ae03dd6cb", "html_url": "https://github.com/rust-lang/rust/commit/762b988a0a7740d6a9b5f99932036a4ae03dd6cb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/762b988a0a7740d6a9b5f99932036a4ae03dd6cb/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "30019ed41324c7018c3432482208d86d43517c6d", "url": "https://api.github.com/repos/rust-lang/rust/commits/30019ed41324c7018c3432482208d86d43517c6d", "html_url": "https://github.com/rust-lang/rust/commit/30019ed41324c7018c3432482208d86d43517c6d"}, {"sha": "f565efd617fc2b74bca7fa637faf9c6241008442", "url": "https://api.github.com/repos/rust-lang/rust/commits/f565efd617fc2b74bca7fa637faf9c6241008442", "html_url": "https://github.com/rust-lang/rust/commit/f565efd617fc2b74bca7fa637faf9c6241008442"}], "stats": {"total": 7, "additions": 6, "deletions": 1}, "files": [{"sha": "ab471112832219e871f5b7c14a16551a57855ba5", "filename": "src/librustdoc/clean/mod.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/762b988a0a7740d6a9b5f99932036a4ae03dd6cb/src%2Flibrustdoc%2Fclean%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/762b988a0a7740d6a9b5f99932036a4ae03dd6cb/src%2Flibrustdoc%2Fclean%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Fmod.rs?ref=762b988a0a7740d6a9b5f99932036a4ae03dd6cb", "patch": "@@ -165,7 +165,12 @@ impl<'a, 'tcx, 'rcx> Clean<Crate> for visit_ast::RustdocVisitor<'a, 'tcx, 'rcx>\n         match module.inner {\n             ModuleItem(ref module) => {\n                 for it in &module.items {\n-                    if it.is_extern_crate() && it.attrs.has_doc_flag(\"masked\") {\n+                    // `compiler_builtins` should be masked too, but we can't apply\n+                    // `#[doc(masked)]` to the injected `extern crate` because it's unstable.\n+                    if it.is_extern_crate()\n+                        && (it.attrs.has_doc_flag(\"masked\")\n+                            || self.cx.tcx.is_compiler_builtins(it.def_id.krate))\n+                    {\n                         masked_crates.insert(it.def_id.krate);\n                     }\n                 }"}]}