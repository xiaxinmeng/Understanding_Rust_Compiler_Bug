{"sha": "3f983ca084b1e1766b604622366c1fb1c7e07858", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNmOTgzY2EwODRiMWUxNzY2YjYwNDYyMjM2NmMxZmIxYzdlMDc4NTg=", "commit": {"author": {"name": "Zack Corr", "email": "zackcorr95@gmail.com", "date": "2012-06-02T08:11:31Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-06-03T03:54:39Z"}, "message": "Fix cargo to install from archives correctly", "tree": {"sha": "9cee4f360d6ff979d2e2911e283fe68d2c0d99f3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9cee4f360d6ff979d2e2911e283fe68d2c0d99f3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3f983ca084b1e1766b604622366c1fb1c7e07858", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3f983ca084b1e1766b604622366c1fb1c7e07858", "html_url": "https://github.com/rust-lang/rust/commit/3f983ca084b1e1766b604622366c1fb1c7e07858", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3f983ca084b1e1766b604622366c1fb1c7e07858/comments", "author": {"login": "z0w0", "id": 676417, "node_id": "MDQ6VXNlcjY3NjQxNw==", "avatar_url": "https://avatars.githubusercontent.com/u/676417?v=4", "gravatar_id": "", "url": "https://api.github.com/users/z0w0", "html_url": "https://github.com/z0w0", "followers_url": "https://api.github.com/users/z0w0/followers", "following_url": "https://api.github.com/users/z0w0/following{/other_user}", "gists_url": "https://api.github.com/users/z0w0/gists{/gist_id}", "starred_url": "https://api.github.com/users/z0w0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/z0w0/subscriptions", "organizations_url": "https://api.github.com/users/z0w0/orgs", "repos_url": "https://api.github.com/users/z0w0/repos", "events_url": "https://api.github.com/users/z0w0/events{/privacy}", "received_events_url": "https://api.github.com/users/z0w0/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ce2719a4d98bf7cc57b757f10e551cd874ff0d9a", "url": "https://api.github.com/repos/rust-lang/rust/commits/ce2719a4d98bf7cc57b757f10e551cd874ff0d9a", "html_url": "https://github.com/rust-lang/rust/commit/ce2719a4d98bf7cc57b757f10e551cd874ff0d9a"}], "stats": {"total": 33, "additions": 16, "deletions": 17}, "files": [{"sha": "86235583b4736de677105faf6e0821d494b12548", "filename": "src/cargo/cargo.rs", "status": "modified", "additions": 16, "deletions": 17, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/3f983ca084b1e1766b604622366c1fb1c7e07858/src%2Fcargo%2Fcargo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3f983ca084b1e1766b604622366c1fb1c7e07858/src%2Fcargo%2Fcargo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcargo%2Fcargo.rs?ref=3f983ca084b1e1766b604622366c1fb1c7e07858", "patch": "@@ -137,15 +137,10 @@ fn is_uuid(id: str) -> bool {\n // FIXME: implement URI/URL parsing so we don't have to resort to weak checks\n \n fn is_archive_uri(uri: str) -> bool {\n-    let (_, ext) = path::splitext(uri);\n-\n-    alt ext {\n-        \".tar\" { ret true; }\n-        \".tar.gz\" { ret true; }\n-        \".tar.xy\" { ret true; }\n-        \".tar.bz2\" { ret true; }\n-        _ { ret false; }\n-    }\n+    str::ends_with(uri, \".tar\")\n+    || str::ends_with(uri, \".tar.gz\")\n+    || str::ends_with(uri, \".tar.xz\")\n+    || str::ends_with(uri, \".tar.bz2\")\n }\n \n fn is_archive_url(url: str) -> bool {\n@@ -156,7 +151,7 @@ fn is_archive_url(url: str) -> bool {\n         option::some(idx) {\n             str::ends_with(url, \".tar\")\n             || str::ends_with(url, \".tar.gz\")\n-            || str::ends_with(url, \".tar.xy\")\n+            || str::ends_with(url, \".tar.xz\")\n             || str::ends_with(url, \".tar.bz2\")\n         }\n         option::none { false }\n@@ -641,7 +636,7 @@ fn install_curl(c: cargo, wd: str, url: str) {\n }\n \n fn install_file(c: cargo, wd: str, path: str) {\n-    info(\"installing with file from \" + path + \"...\");\n+    info(\"installing with tar from \" + path + \"...\");\n     run::run_program(\"tar\", [\"-x\", \"--strip-components=1\",\n                              \"-C\", wd, \"-f\", path]);\n     install_source(c, wd);\n@@ -687,7 +682,9 @@ fn install_uuid(c: cargo, wd: str, uuid: str) {\n         install_package(c, wd, p);\n         ret;\n     } else if vec::len(ps) == 0u {\n-        cargo_suggestion(c, false, { || error(\"no packages match uuid\"); });\n+        cargo_suggestion(c, false, { ||\n+            error(\"can't find package: \" + uuid);\n+        });\n         ret;\n     }\n     error(\"found multiple packages:\");\n@@ -709,7 +706,9 @@ fn install_named(c: cargo, wd: str, name: str) {\n         install_package(c, wd, p);\n         ret;\n     } else if vec::len(ps) == 0u {\n-        cargo_suggestion(c, false, { || error(\"no packages match name\"); });\n+        cargo_suggestion(c, false, { ||\n+            error(\"can't find package: \" + name);\n+        });\n         ret;\n     }\n     error(\"found multiple packages:\");\n@@ -732,7 +731,7 @@ fn install_uuid_specific(c: cargo, wd: str, src: str, uuid: str) {\n       }\n       _ { }\n     }\n-    error(\"can't find package \" + src + \"/\" + uuid);\n+    error(\"can't find package: \" + src + \"/\" + uuid);\n }\n \n fn install_named_specific(c: cargo, wd: str, src: str, name: str) {\n@@ -748,7 +747,7 @@ fn install_named_specific(c: cargo, wd: str, src: str, name: str) {\n         }\n         _ { }\n     }\n-    error(\"can't find package \" + src + \"/\" + name);\n+    error(\"can't find package: \" + src + \"/\" + name);\n }\n \n fn cmd_uninstall(c: cargo) {\n@@ -1074,10 +1073,10 @@ Packages:\n     install [options] [source/]<uuid>       Install a package by uuid\n     install [options] <url>                 Install a package via curl (HTTP,\n                                             FTP, etc.) from an\n-                                            .tar[.gz|bz2|xy] file\n+                                            .tar[.gz|bz2|xz] file\n     install [options] <url> [ref]           Install a package via git\n     install [options] <file>                Install a package directly from an\n-                                            .tar[.gz|bz2|xy] file\n+                                            .tar[.gz|bz2|xz] file\n     uninstall [options] <name>              Remove a package by (meta) name\n     uninstall [options] <uuid>              Remove a package by (meta) uuid\n "}]}