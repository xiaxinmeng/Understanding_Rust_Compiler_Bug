{"sha": "ba72d9722caf48ad5f184d4da61117f80d98761e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJhNzJkOTcyMmNhZjQ4YWQ1ZjE4NGQ0ZGE2MTExN2Y4MGQ5ODc2MWU=", "commit": {"author": {"name": "Richard Diamond", "email": "wichard@vitalitystudios.com", "date": "2015-09-07T00:26:41Z"}, "committer": {"name": "Richard Diamond", "email": "wichard@vitalitystudios.com", "date": "2015-09-07T00:26:41Z"}, "message": "Don't add unnamed address attributes to intrinsics.\n\nIntrinsics never have an address, so it doesn't make sense to say that their\naddress is unnamed.", "tree": {"sha": "7cc168bbb00d87c0c29ae06c4afca394c3c8dd21", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7cc168bbb00d87c0c29ae06c4afca394c3c8dd21"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ba72d9722caf48ad5f184d4da61117f80d98761e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ba72d9722caf48ad5f184d4da61117f80d98761e", "html_url": "https://github.com/rust-lang/rust/commit/ba72d9722caf48ad5f184d4da61117f80d98761e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ba72d9722caf48ad5f184d4da61117f80d98761e/comments", "author": {"login": "DiamondLovesYou", "id": 650357, "node_id": "MDQ6VXNlcjY1MDM1Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/650357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DiamondLovesYou", "html_url": "https://github.com/DiamondLovesYou", "followers_url": "https://api.github.com/users/DiamondLovesYou/followers", "following_url": "https://api.github.com/users/DiamondLovesYou/following{/other_user}", "gists_url": "https://api.github.com/users/DiamondLovesYou/gists{/gist_id}", "starred_url": "https://api.github.com/users/DiamondLovesYou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DiamondLovesYou/subscriptions", "organizations_url": "https://api.github.com/users/DiamondLovesYou/orgs", "repos_url": "https://api.github.com/users/DiamondLovesYou/repos", "events_url": "https://api.github.com/users/DiamondLovesYou/events{/privacy}", "received_events_url": "https://api.github.com/users/DiamondLovesYou/received_events", "type": "User", "site_admin": false}, "committer": {"login": "DiamondLovesYou", "id": 650357, "node_id": "MDQ6VXNlcjY1MDM1Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/650357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DiamondLovesYou", "html_url": "https://github.com/DiamondLovesYou", "followers_url": "https://api.github.com/users/DiamondLovesYou/followers", "following_url": "https://api.github.com/users/DiamondLovesYou/following{/other_user}", "gists_url": "https://api.github.com/users/DiamondLovesYou/gists{/gist_id}", "starred_url": "https://api.github.com/users/DiamondLovesYou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DiamondLovesYou/subscriptions", "organizations_url": "https://api.github.com/users/DiamondLovesYou/orgs", "repos_url": "https://api.github.com/users/DiamondLovesYou/repos", "events_url": "https://api.github.com/users/DiamondLovesYou/events{/privacy}", "received_events_url": "https://api.github.com/users/DiamondLovesYou/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "01b9cc58ba0c91ec265d8c1ad9225b2ca777464e", "url": "https://api.github.com/repos/rust-lang/rust/commits/01b9cc58ba0c91ec265d8c1ad9225b2ca777464e", "html_url": "https://github.com/rust-lang/rust/commit/01b9cc58ba0c91ec265d8c1ad9225b2ca777464e"}], "stats": {"total": 24, "additions": 24, "deletions": 0}, "files": [{"sha": "75874963f5f9254ac19268cdd2bd94a0fedf745a", "filename": "src/librustc_trans/trans/context.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ba72d9722caf48ad5f184d4da61117f80d98761e/src%2Flibrustc_trans%2Ftrans%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ba72d9722caf48ad5f184d4da61117f80d98761e/src%2Flibrustc_trans%2Ftrans%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Ftrans%2Fcontext.rs?ref=ba72d9722caf48ad5f184d4da61117f80d98761e", "patch": "@@ -798,6 +798,7 @@ fn declare_intrinsic(ccx: &CrateContext, key: &str) -> Option<ValueRef> {\n             if key == $name {\n                 let f = declare::declare_cfn(ccx, $name, Type::func(&[], &$ret),\n                                              ccx.tcx().mk_nil());\n+                llvm::SetUnnamedAddr(f, false);\n                 ccx.intrinsics().borrow_mut().insert($name, f.clone());\n                 return Some(f);\n             }\n@@ -806,6 +807,7 @@ fn declare_intrinsic(ccx: &CrateContext, key: &str) -> Option<ValueRef> {\n             if key == $name {\n                 let f = declare::declare_cfn(ccx, $name, Type::func(&[$($arg),*], &$ret),\n                                              ccx.tcx().mk_nil());\n+                llvm::SetUnnamedAddr(f, false);\n                 ccx.intrinsics().borrow_mut().insert($name, f.clone());\n                 return Some(f);\n             }"}, {"sha": "0f239c8426575fb176c3a7e0b8c0876ebca98a54", "filename": "src/test/codegen/intrinsic-no-unnamed-attr.rs", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/ba72d9722caf48ad5f184d4da61117f80d98761e/src%2Ftest%2Fcodegen%2Fintrinsic-no-unnamed-attr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ba72d9722caf48ad5f184d4da61117f80d98761e/src%2Ftest%2Fcodegen%2Fintrinsic-no-unnamed-attr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fintrinsic-no-unnamed-attr.rs?ref=ba72d9722caf48ad5f184d4da61117f80d98761e", "patch": "@@ -0,0 +1,22 @@\n+// Copyright 2015 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// compile-flags: -C no-prepopulate-passes\n+\n+#![feature(intrinsics)]\n+\n+extern \"rust-intrinsic\" {\n+    fn sqrtf32(x: f32) -> f32;\n+}\n+// CHECK: @llvm.sqrt.f32(float) #{{[0-9]*}}\n+\n+fn main() {\n+    unsafe { sqrtf32(0.0f32); }\n+}"}]}