{"sha": "7b952cb1aac99c621e14c5fb63c66fc67c8470fc", "node_id": "C_kwDOAAsO6NoAKDdiOTUyY2IxYWFjOTljNjIxZTE0YzVmYjYzYzY2ZmM2N2M4NDcwZmM", "commit": {"author": {"name": "zhoufan", "email": "1247714429@qq.com", "date": "2021-12-14T07:34:57Z"}, "committer": {"name": "zhoufan", "email": "1247714429@qq.com", "date": "2021-12-14T07:34:57Z"}, "message": "infer associated method in local scope", "tree": {"sha": "f374c403fe3916d2130949351c47e5ff2583220e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f374c403fe3916d2130949351c47e5ff2583220e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7b952cb1aac99c621e14c5fb63c66fc67c8470fc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7b952cb1aac99c621e14c5fb63c66fc67c8470fc", "html_url": "https://github.com/rust-lang/rust/commit/7b952cb1aac99c621e14c5fb63c66fc67c8470fc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7b952cb1aac99c621e14c5fb63c66fc67c8470fc/comments", "author": {"login": "xffxff", "id": 30254428, "node_id": "MDQ6VXNlcjMwMjU0NDI4", "avatar_url": "https://avatars.githubusercontent.com/u/30254428?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xffxff", "html_url": "https://github.com/xffxff", "followers_url": "https://api.github.com/users/xffxff/followers", "following_url": "https://api.github.com/users/xffxff/following{/other_user}", "gists_url": "https://api.github.com/users/xffxff/gists{/gist_id}", "starred_url": "https://api.github.com/users/xffxff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xffxff/subscriptions", "organizations_url": "https://api.github.com/users/xffxff/orgs", "repos_url": "https://api.github.com/users/xffxff/repos", "events_url": "https://api.github.com/users/xffxff/events{/privacy}", "received_events_url": "https://api.github.com/users/xffxff/received_events", "type": "User", "site_admin": false}, "committer": {"login": "xffxff", "id": 30254428, "node_id": "MDQ6VXNlcjMwMjU0NDI4", "avatar_url": "https://avatars.githubusercontent.com/u/30254428?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xffxff", "html_url": "https://github.com/xffxff", "followers_url": "https://api.github.com/users/xffxff/followers", "following_url": "https://api.github.com/users/xffxff/following{/other_user}", "gists_url": "https://api.github.com/users/xffxff/gists{/gist_id}", "starred_url": "https://api.github.com/users/xffxff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xffxff/subscriptions", "organizations_url": "https://api.github.com/users/xffxff/orgs", "repos_url": "https://api.github.com/users/xffxff/repos", "events_url": "https://api.github.com/users/xffxff/events{/privacy}", "received_events_url": "https://api.github.com/users/xffxff/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "791722b70ad08641a48f96faedffdda6d2880366", "url": "https://api.github.com/repos/rust-lang/rust/commits/791722b70ad08641a48f96faedffdda6d2880366", "html_url": "https://github.com/rust-lang/rust/commit/791722b70ad08641a48f96faedffdda6d2880366"}], "stats": {"total": 33, "additions": 32, "deletions": 1}, "files": [{"sha": "06689e1d29f90329a0e6ffeaa2c48e22cdf7a3e3", "filename": "crates/hir_ty/src/infer/path.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7b952cb1aac99c621e14c5fb63c66fc67c8470fc/crates%2Fhir_ty%2Fsrc%2Finfer%2Fpath.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7b952cb1aac99c621e14c5fb63c66fc67c8470fc/crates%2Fhir_ty%2Fsrc%2Finfer%2Fpath.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Finfer%2Fpath.rs?ref=7b952cb1aac99c621e14c5fb63c66fc67c8470fc", "patch": "@@ -227,7 +227,7 @@ impl<'a> InferenceContext<'a> {\n             self.table.trait_env.clone(),\n             krate,\n             &traits_in_scope,\n-            None,\n+            self.resolver.module(),\n             Some(name),\n             method_resolution::LookupMode::Path,\n             move |_ty, item| {"}, {"sha": "11bdfa85a9f2746eba7d31c3f5340e385653205c", "filename": "crates/hir_ty/src/tests/method_resolution.rs", "status": "modified", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/7b952cb1aac99c621e14c5fb63c66fc67c8470fc/crates%2Fhir_ty%2Fsrc%2Ftests%2Fmethod_resolution.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7b952cb1aac99c621e14c5fb63c66fc67c8470fc/crates%2Fhir_ty%2Fsrc%2Ftests%2Fmethod_resolution.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Ftests%2Fmethod_resolution.rs?ref=7b952cb1aac99c621e14c5fb63c66fc67c8470fc", "patch": "@@ -84,6 +84,37 @@ fn infer_associated_method_struct() {\n     );\n }\n \n+#[test]\n+fn infer_associated_method_struct_in_local_scope() {\n+    check_infer(\n+        r#\"\n+        fn mismatch() {\n+            struct A;\n+\n+            impl A {\n+                fn from(_: i32, _: i32) -> Self {\n+                    A\n+                }\n+            }\n+\n+            let _a = A::from(1, 2);\n+        }\n+        \"#,\n+        expect![[r#\"\n+            14..146 '{     ... 2); }': ()\n+            125..127 '_a': A\n+            130..137 'A::from': fn from(i32, i32) -> A\n+            130..143 'A::from(1, 2)': A\n+            138..139 '1': i32\n+            141..142 '2': i32\n+            60..61 '_': i32\n+            68..69 '_': i32\n+            84..109 '{     ...     }': A\n+            98..99 'A': A\n+        \"#]],\n+    );\n+}\n+\n #[test]\n fn infer_associated_method_enum() {\n     check_infer("}]}