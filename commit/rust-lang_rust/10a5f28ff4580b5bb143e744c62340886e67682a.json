{"sha": "10a5f28ff4580b5bb143e744c62340886e67682a", "node_id": "C_kwDOAAsO6NoAKDEwYTVmMjhmZjQ1ODBiNWJiMTQzZTc0NGM2MjM0MDg4NmU2NzY4MmE", "commit": {"author": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2022-05-09T00:21:25Z"}, "committer": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2022-05-09T00:25:33Z"}, "message": "Switch CI bucket to intelligent tiering\n\nWe currently upload approximately 166 GB/day into this bucket (estimate based on\nduration of storage and total current size). My estimate is that this change\nshould decrease our costs (which are currently in credits) and is in the worst\ncase (if all objects are brought into hot storage due to unanticipated frequent\naccess) only going to add an additional ~$4 to the monthly bill. If access is\nrare (as expected) to most objects then we expect to save approximately\n~$350/month (after this change takes full effect in ~168 days).", "tree": {"sha": "1bca2ec50cd21ccf113c44bb94ae7fb8e7c2bfae", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1bca2ec50cd21ccf113c44bb94ae7fb8e7c2bfae"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/10a5f28ff4580b5bb143e744c62340886e67682a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/10a5f28ff4580b5bb143e744c62340886e67682a", "html_url": "https://github.com/rust-lang/rust/commit/10a5f28ff4580b5bb143e744c62340886e67682a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/10a5f28ff4580b5bb143e744c62340886e67682a/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "68461648bf20a230898404d2231d386fbcc09b73", "url": "https://api.github.com/repos/rust-lang/rust/commits/68461648bf20a230898404d2231d386fbcc09b73", "html_url": "https://github.com/rust-lang/rust/commit/68461648bf20a230898404d2231d386fbcc09b73"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "cea9b770f2a20a8b4e66b53c5256ff11eeddf026", "filename": "src/ci/scripts/upload-artifacts.sh", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/10a5f28ff4580b5bb143e744c62340886e67682a/src%2Fci%2Fscripts%2Fupload-artifacts.sh", "raw_url": "https://github.com/rust-lang/rust/raw/10a5f28ff4580b5bb143e744c62340886e67682a/src%2Fci%2Fscripts%2Fupload-artifacts.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fscripts%2Fupload-artifacts.sh?ref=10a5f28ff4580b5bb143e744c62340886e67682a", "patch": "@@ -38,4 +38,5 @@ if [[ \"${DEPLOY_ALT-0}\" -eq \"1\" ]]; then\n fi\n deploy_url=\"s3://${DEPLOY_BUCKET}/${deploy_dir}/$(ciCommit)\"\n \n-retry aws s3 cp --no-progress --recursive --acl public-read \"${upload_dir}\" \"${deploy_url}\"\n+retry aws s3 cp --storage-class INTELLIGENT_TIERING \\\n+    --no-progress --recursive --acl public-read \"${upload_dir}\" \"${deploy_url}\""}]}