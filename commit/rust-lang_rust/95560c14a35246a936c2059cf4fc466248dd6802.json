{"sha": "95560c14a35246a936c2059cf4fc466248dd6802", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk1NTYwYzE0YTM1MjQ2YTkzNmMyMDU5Y2Y0ZmM0NjYyNDhkZDY4MDI=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2016-02-29T17:34:13Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2016-02-29T17:36:00Z"}, "message": "test: Mark all rpass-valgrind as no-prefer-dynamic\n\nThis applies the same fix as added in 595d5b2f which is to just compile all\nvalgrind tests statically instead of dynamically. It looks like this is a\nresurgence of either #30383 or #31328 in some weird fashion.\n\nI'm not actually sure what's going on with the bots, and it's unclear whether\nthis is a valgrind bug or a libstd bug, but for now let's just get things\nlanding again.\n\nCloses #30383", "tree": {"sha": "74583e0d6ddaee4595e65dedbd0d2b5cf1012f15", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/74583e0d6ddaee4595e65dedbd0d2b5cf1012f15"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/95560c14a35246a936c2059cf4fc466248dd6802", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/95560c14a35246a936c2059cf4fc466248dd6802", "html_url": "https://github.com/rust-lang/rust/commit/95560c14a35246a936c2059cf4fc466248dd6802", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/95560c14a35246a936c2059cf4fc466248dd6802/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b643782a10288a86a500168d754026bd0fce2ab5", "url": "https://api.github.com/repos/rust-lang/rust/commits/b643782a10288a86a500168d754026bd0fce2ab5", "html_url": "https://github.com/rust-lang/rust/commit/b643782a10288a86a500168d754026bd0fce2ab5"}], "stats": {"total": 11, "additions": 11, "deletions": 0}, "files": [{"sha": "247e82c2f09245ec06c8d6639b4a2889a505d94c", "filename": "src/test/run-pass-valgrind/cast-enum-with-dtor.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/95560c14a35246a936c2059cf4fc466248dd6802/src%2Ftest%2Frun-pass-valgrind%2Fcast-enum-with-dtor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/95560c14a35246a936c2059cf4fc466248dd6802/src%2Ftest%2Frun-pass-valgrind%2Fcast-enum-with-dtor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-valgrind%2Fcast-enum-with-dtor.rs?ref=95560c14a35246a936c2059cf4fc466248dd6802", "patch": "@@ -8,6 +8,8 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n+// no-prefer-dynamic\n+\n #![allow(dead_code)]\n #![feature(const_fn)]\n "}, {"sha": "220968529de2022d26505289cab6a4f1ec2603d7", "filename": "src/test/run-pass-valgrind/cleanup-auto-borrow-obj.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/95560c14a35246a936c2059cf4fc466248dd6802/src%2Ftest%2Frun-pass-valgrind%2Fcleanup-auto-borrow-obj.rs", "raw_url": "https://github.com/rust-lang/rust/raw/95560c14a35246a936c2059cf4fc466248dd6802/src%2Ftest%2Frun-pass-valgrind%2Fcleanup-auto-borrow-obj.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-valgrind%2Fcleanup-auto-borrow-obj.rs?ref=95560c14a35246a936c2059cf4fc466248dd6802", "patch": "@@ -8,6 +8,7 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n+// no-prefer-dynamic\n \n // This would previously leak the Box<Trait> because we wouldn't\n // schedule cleanups when auto borrowing trait objects."}, {"sha": "b7c94ed6944f66b8be3da30a587108cc8001319e", "filename": "src/test/run-pass-valgrind/cleanup-stdin.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/95560c14a35246a936c2059cf4fc466248dd6802/src%2Ftest%2Frun-pass-valgrind%2Fcleanup-stdin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/95560c14a35246a936c2059cf4fc466248dd6802/src%2Ftest%2Frun-pass-valgrind%2Fcleanup-stdin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-valgrind%2Fcleanup-stdin.rs?ref=95560c14a35246a936c2059cf4fc466248dd6802", "patch": "@@ -8,6 +8,8 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n+// no-prefer-dynamic\n+\n fn main() {\n     let _ = std::io::stdin();\n     let _ = std::io::stdout();"}, {"sha": "995da8c73fab8b8f74077e655c465ff7436a2d25", "filename": "src/test/run-pass-valgrind/dst-dtor-1.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/95560c14a35246a936c2059cf4fc466248dd6802/src%2Ftest%2Frun-pass-valgrind%2Fdst-dtor-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/95560c14a35246a936c2059cf4fc466248dd6802/src%2Ftest%2Frun-pass-valgrind%2Fdst-dtor-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-valgrind%2Fdst-dtor-1.rs?ref=95560c14a35246a936c2059cf4fc466248dd6802", "patch": "@@ -8,6 +8,8 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n+// no-prefer-dynamic\n+\n static mut DROP_RAN: bool = false;\n \n struct Foo;"}, {"sha": "471169340d793057daa42a23fb657b78e6e03cbe", "filename": "src/test/run-pass-valgrind/dst-dtor-2.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/95560c14a35246a936c2059cf4fc466248dd6802/src%2Ftest%2Frun-pass-valgrind%2Fdst-dtor-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/95560c14a35246a936c2059cf4fc466248dd6802/src%2Ftest%2Frun-pass-valgrind%2Fdst-dtor-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-valgrind%2Fdst-dtor-2.rs?ref=95560c14a35246a936c2059cf4fc466248dd6802", "patch": "@@ -8,6 +8,8 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n+// no-prefer-dynamic\n+\n static mut DROP_RAN: isize = 0;\n \n struct Foo;"}, {"sha": "1897b921401823e08ee49160a41e0373acc8f2e3", "filename": "src/test/run-pass-valgrind/exit-flushes.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/95560c14a35246a936c2059cf4fc466248dd6802/src%2Ftest%2Frun-pass-valgrind%2Fexit-flushes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/95560c14a35246a936c2059cf4fc466248dd6802/src%2Ftest%2Frun-pass-valgrind%2Fexit-flushes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-valgrind%2Fexit-flushes.rs?ref=95560c14a35246a936c2059cf4fc466248dd6802", "patch": "@@ -8,6 +8,7 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n+// no-prefer-dynamic\n // ignore-macos this needs valgrind 3.11 or higher; see\n // https://github.com/rust-lang/rust/pull/30365#issuecomment-165763679\n "}, {"sha": "468a20db6f74d653c315281b09d47e4251716abd", "filename": "src/test/run-pass-valgrind/osx-frameworks.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/95560c14a35246a936c2059cf4fc466248dd6802/src%2Ftest%2Frun-pass-valgrind%2Fosx-frameworks.rs", "raw_url": "https://github.com/rust-lang/rust/raw/95560c14a35246a936c2059cf4fc466248dd6802/src%2Ftest%2Frun-pass-valgrind%2Fosx-frameworks.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-valgrind%2Fosx-frameworks.rs?ref=95560c14a35246a936c2059cf4fc466248dd6802", "patch": "@@ -8,6 +8,7 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n+// no-prefer-dynamic\n // pretty-expanded FIXME #23616\n \n #![feature(libc)]"}]}