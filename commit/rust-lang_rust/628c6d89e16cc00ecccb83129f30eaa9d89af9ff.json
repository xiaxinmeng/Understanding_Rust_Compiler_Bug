{"sha": "628c6d89e16cc00ecccb83129f30eaa9d89af9ff", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYyOGM2ZDg5ZTE2Y2MwMGVjY2NiODMxMjlmMzBlYWE5ZDg5YWY5ZmY=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-12-22T18:04:44Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-12-22T18:12:30Z"}, "message": "Rollup merge of #56945 - JohnHeitmann:rustdoc-js-tester-fix, r=GuillaumeGomez\n\nFix rustdoc-js tests\n\nFixes rustdoc-js tests by teaching tester.js how to handle single-line js comments.\n\nAlso, added speculative support for template strings, and warnings for future debuggers.", "tree": {"sha": "f3c99f0c4260087b900046ac613919b92e99a788", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f3c99f0c4260087b900046ac613919b92e99a788"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/628c6d89e16cc00ecccb83129f30eaa9d89af9ff", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlwefo4ACgkQ/vbIBR0O\nATzNGRAAhwBfSI3kwAOsEh2HdU4Nk3gGYzk9CJxdCvlY3tcM9D+x1Q6fPL/+4S25\ny4lqzOUflWR+9cGBmau5nc7W/PEi05UiALiXPBUm0KHmBVmhbXHlUqZO/aOdLwr7\nmEO3yhi3T8MTjBweZ25PBJc7vfpTnYOcn73b7iaBVD7zpRApIMSiTrhRnlILf4DP\nZp5wlujv4Y/aRteVWN1OReQxP6CIQO4k4cydYOgvDQyWrmZvELL1A9md0a7AHMpA\nb6QzeFD4zrXIxhYKPTcOC+9aIR1RS3A7nDAYIhgM7ilW2cd++OlyYCSaRvTuGE6b\nFrWAYAEepcVArNxrV+mHMKX7FSV2jRldomxGAH4nt862F8AFTfXE55hiZcfUmtAs\npjTSxKAxQGc2XRaQ4QRMYELh591YG2sT5UTbsBbSmDs4vbgCHElM+ReiWZ6U4l7n\nvXTHVwJOnshRRDn8+mqWBh/St/NfswGp10ggzw77rpaeS3X6wbV5+l4eVGS63p+n\ny+11VBJaaWCQtrk+HCV6m4sm3X5glO7hMPX+cqQaoHcvxdGxVtIEzsWnOVdxLmfL\n5WeS8t+DKgtBUwYie6WidPlMct4xNl3vHa/GvFSscwpuKyhCoJ1kU9OM0i4xfiuZ\nwouiSk4IX2beiTeKNirdrBpzBR++xj9pBBlLXeRvQlLR6kRIWWo=\n=pQgn\n-----END PGP SIGNATURE-----", "payload": "tree f3c99f0c4260087b900046ac613919b92e99a788\nparent 26842aeac6645320a1241f6236e975f09ff34281\nparent 5056669fc83b256cef39927d51b67f320ab1f325\nauthor kennytm <kennytm@gmail.com> 1545501884 +0800\ncommitter kennytm <kennytm@gmail.com> 1545502350 +0800\n\nRollup merge of #56945 - JohnHeitmann:rustdoc-js-tester-fix, r=GuillaumeGomez\n\nFix rustdoc-js tests\n\nFixes rustdoc-js tests by teaching tester.js how to handle single-line js comments.\n\nAlso, added speculative support for template strings, and warnings for future debuggers.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/628c6d89e16cc00ecccb83129f30eaa9d89af9ff", "html_url": "https://github.com/rust-lang/rust/commit/628c6d89e16cc00ecccb83129f30eaa9d89af9ff", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/628c6d89e16cc00ecccb83129f30eaa9d89af9ff/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "26842aeac6645320a1241f6236e975f09ff34281", "url": "https://api.github.com/repos/rust-lang/rust/commits/26842aeac6645320a1241f6236e975f09ff34281", "html_url": "https://github.com/rust-lang/rust/commit/26842aeac6645320a1241f6236e975f09ff34281"}, {"sha": "5056669fc83b256cef39927d51b67f320ab1f325", "url": "https://api.github.com/repos/rust-lang/rust/commits/5056669fc83b256cef39927d51b67f320ab1f325", "html_url": "https://github.com/rust-lang/rust/commit/5056669fc83b256cef39927d51b67f320ab1f325"}], "stats": {"total": 16, "additions": 14, "deletions": 2}, "files": [{"sha": "65ed86742e74b2f841b016de58043b6b33a4f588", "filename": "src/tools/rustdoc-js/tester.js", "status": "modified", "additions": 14, "deletions": 2, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/628c6d89e16cc00ecccb83129f30eaa9d89af9ff/src%2Ftools%2Frustdoc-js%2Ftester.js", "raw_url": "https://github.com/rust-lang/rust/raw/628c6d89e16cc00ecccb83129f30eaa9d89af9ff/src%2Ftools%2Frustdoc-js%2Ftester.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustdoc-js%2Ftester.js?ref=628c6d89e16cc00ecccb83129f30eaa9d89af9ff", "patch": "@@ -26,7 +26,10 @@ function getNextStep(content, pos, stop) {\n     return pos;\n }\n \n-// Stupid function extractor based on indent.\n+// Stupid function extractor based on indent. Doesn't support block\n+// comments. If someone puts a ' or an \" in a block comment this\n+// will blow up. Template strings are not tested and might also be\n+// broken.\n function extractFunction(content, functionName) {\n     var indent = 0;\n     var splitter = \"function \" + functionName + \"(\";\n@@ -51,7 +54,14 @@ function extractFunction(content, functionName) {\n             continue;\n         }\n         while (pos < content.length) {\n-            if (content[pos] === '\"' || content[pos] === \"'\") {\n+            // Eat single-line comments\n+            if (content[pos] === '/' && pos > 0 && content[pos-1] === '/') {\n+                do {\n+                    pos += 1;\n+                } while (pos < content.length && content[pos] !== '\\n');\n+\n+            // Eat quoted strings\n+            } else if (content[pos] === '\"' || content[pos] === \"'\" || content[pos] === \"`\") {\n                 var stop = content[pos];\n                 var is_escaped = false;\n                 do {\n@@ -62,6 +72,8 @@ function extractFunction(content, functionName) {\n                     }\n                 } while (pos < content.length &&\n                          (content[pos] !== stop || content[pos - 1] === '\\\\'));\n+\n+            // Otherwise, check for indent\n             } else if (content[pos] === '{') {\n                 indent += 1;\n             } else if (content[pos] === '}') {"}]}