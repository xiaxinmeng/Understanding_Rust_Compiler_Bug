{"sha": "34e31830c0da20a7ccc1a83a423437fb2ee073d3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM0ZTMxODMwYzBkYTIwYTdjY2MxYTgzYTQyMzQzN2ZiMmVlMDczZDM=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2018-11-26T16:17:38Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2018-12-06T22:34:36Z"}, "message": "Prevent lazy iterations over DOM", "tree": {"sha": "82416a835df2027b93d713418860490e1bcc8229", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/82416a835df2027b93d713418860490e1bcc8229"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/34e31830c0da20a7ccc1a83a423437fb2ee073d3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/34e31830c0da20a7ccc1a83a423437fb2ee073d3", "html_url": "https://github.com/rust-lang/rust/commit/34e31830c0da20a7ccc1a83a423437fb2ee073d3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/34e31830c0da20a7ccc1a83a423437fb2ee073d3/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "edfe2a893e2ca1330c4fe422d61214f6cb2144f0", "url": "https://api.github.com/repos/rust-lang/rust/commits/edfe2a893e2ca1330c4fe422d61214f6cb2144f0", "html_url": "https://github.com/rust-lang/rust/commit/edfe2a893e2ca1330c4fe422d61214f6cb2144f0"}], "stats": {"total": 204, "additions": 99, "deletions": 105}, "files": [{"sha": "adc49da61da13ff9222fa6f101574d9fef831c5e", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 99, "deletions": 105, "changes": 204, "blob_url": "https://github.com/rust-lang/rust/blob/34e31830c0da20a7ccc1a83a423437fb2ee073d3/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/34e31830c0da20a7ccc1a83a423437fb2ee073d3/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=34e31830c0da20a7ccc1a83a423437fb2ee073d3", "patch": "@@ -148,12 +148,10 @@ if (!DOMTokenList.prototype.remove) {\n     var TY_PRIMITIVE = itemTypes.indexOf(\"primitive\");\n     var TY_KEYWORD = itemTypes.indexOf(\"keyword\");\n \n-    onEach(document.getElementsByClassName(\"js-only\"), function(e) {\n+    onEach(Array.prototype.slice.call(document.getElementsByClassName(\"js-only\")), function(e) {\n         removeClass(e, \"js-only\");\n     });\n \n-    console.log('1', Date.now() - start);\n-\n     function getQueryStringParams() {\n         var params = {};\n         window.location.search.substring(1).split(\"&\").\n@@ -170,6 +168,8 @@ if (!DOMTokenList.prototype.remove) {\n           window.history && typeof window.history.pushState === \"function\";\n     }\n \n+    var main = document.getElementById(\"main\");\n+\n     function highlightSourceLines(ev) {\n         // If we're in mobile mode, we should add the sidebar in any case.\n         hideSidebar();\n@@ -190,8 +190,9 @@ if (!DOMTokenList.prototype.remove) {\n                     x.scrollIntoView();\n                 }\n             }\n-            onEach(document.getElementsByClassName(\"line-numbers\"), function(e) {\n-                onEach(e.getElementsByTagName(\"span\"), function(i_e) {\n+            onEach(Array.prototype.slice.call(document.getElementsByClassName(\"line-numbers\")),\n+                   function(e) {\n+                onEach(Array.prototype.slice.call(e.getElementsByTagName(\"span\")), function(i_e) {\n                     removeClass(i_e, \"line-highlighted\");\n                 });\n             });\n@@ -200,7 +201,7 @@ if (!DOMTokenList.prototype.remove) {\n             }\n         } else if (ev !== null && search && !hasClass(search, \"hidden\") && ev.newURL) {\n             addClass(search, \"hidden\");\n-            removeClass(document.getElementById(\"main\"), \"hidden\");\n+            removeClass(main, \"hidden\");\n             var hash = ev.newURL.slice(ev.newURL.indexOf(\"#\") + 1);\n             if (browserSupportsHistoryApi()) {\n                 history.replaceState(hash, \"\", \"?search=#\" + hash);\n@@ -233,8 +234,6 @@ if (!DOMTokenList.prototype.remove) {\n     highlightSourceLines(null);\n     window.onhashchange = highlightSourceLines;\n \n-    console.log('2', Date.now() - start);\n-\n     // Gets the human-readable string for the virtual-key code of the\n     // given KeyboardEvent, ev.\n     //\n@@ -279,7 +278,7 @@ if (!DOMTokenList.prototype.remove) {\n         } else if (hasClass(search, \"hidden\") === false) {\n             ev.preventDefault();\n             addClass(search, \"hidden\");\n-            removeClass(document.getElementById(\"main\"), \"hidden\");\n+            removeClass(main, \"hidden\");\n             document.title = titleBeforeSearch;\n         }\n         defocusSearchBar();\n@@ -407,8 +406,6 @@ if (!DOMTokenList.prototype.remove) {\n         };\n     }\n \n-    console.log('3', Date.now() - start);\n-\n     /**\n      * A function to compute the Levenshtein distance between two strings\n      * Licensed under the Creative Commons Attribution-ShareAlike 3.0 Unported\n@@ -1183,7 +1180,7 @@ if (!DOMTokenList.prototype.remove) {\n                 dst = dst[0];\n                 if (window.location.pathname === dst.pathname) {\n                     addClass(document.getElementById(\"search\"), \"hidden\");\n-                    removeClass(document.getElementById(\"main\"), \"hidden\");\n+                    removeClass(main, \"hidden\");\n                     document.location.href = dst.href;\n                 }\n             };\n@@ -1411,7 +1408,7 @@ if (!DOMTokenList.prototype.remove) {\n                 \"</div><div id=\\\"results\\\">\" +\n                 ret_others[0] + ret_in_args[0] + ret_returned[0] + \"</div>\";\n \n-            addClass(document.getElementById(\"main\"), \"hidden\");\n+            addClass(main, \"hidden\");\n             var search = document.getElementById(\"search\");\n             removeClass(search, \"hidden\");\n             search.innerHTML = output;\n@@ -1421,7 +1418,7 @@ if (!DOMTokenList.prototype.remove) {\n                 td_width = tds[0].offsetWidth;\n             }\n             var width = search.offsetWidth - 40 - td_width;\n-            onEach(search.getElementsByClassName(\"desc\"), function(e) {\n+            onEach(Array.prototype.slice.call(search.getElementsByClassName(\"desc\")), function(e) {\n                 e.style.width = width + \"px\";\n             });\n             initSearchNav();\n@@ -1619,7 +1616,6 @@ if (!DOMTokenList.prototype.remove) {\n                     if (browserSupportsHistoryApi()) {\n                         history.replaceState(\"\", \"std - Rust\", \"?search=\");\n                     }\n-                    var main = document.getElementById(\"main\");\n                     if (hasClass(main, \"content\")) {\n                         removeClass(main, \"hidden\");\n                     }\n@@ -1666,7 +1662,6 @@ if (!DOMTokenList.prototype.remove) {\n                     // When browsing back from search results the main page\n                     // visibility must be reset.\n                     if (!params.search) {\n-                        var main = document.getElementById(\"main\");\n                         if (hasClass(main, \"content\")) {\n                             removeClass(main, \"hidden\");\n                         }\n@@ -1862,8 +1857,6 @@ if (!DOMTokenList.prototype.remove) {\n         window.register_implementors(window.pending_implementors);\n     }\n \n-    console.log('4', Date.now() - start);\n-\n     function labelForToggleButton(sectionIsCollapsed) {\n         if (sectionIsCollapsed) {\n             // button will expand the section\n@@ -1889,31 +1882,35 @@ if (!DOMTokenList.prototype.remove) {\n     }\n \n     function toggleAllDocs(pageId, fromAutoCollapse) {\n-        var toggle = document.getElementById(\"toggle-all-docs\");\n-        if (!toggle) {\n+        var innerToggle = document.getElementById(\"toggle-all-docs\");\n+        if (!innerToggle) {\n             return;\n         }\n-        if (hasClass(toggle, \"will-expand\")) {\n+        if (hasClass(innerToggle, \"will-expand\")) {\n             updateLocalStorage(\"rustdoc-collapse\", \"false\");\n-            removeClass(toggle, \"will-expand\");\n-            onEveryMatchingChild(toggle, \"inner\", function(e) {\n+            removeClass(innerToggle, \"will-expand\");\n+            onEveryMatchingChild(innerToggle, \"inner\", function(e) {\n                 e.innerHTML = labelForToggleButton(false);\n             });\n-            toggle.title = \"collapse all docs\";\n+            innerToggle.title = \"collapse all docs\";\n             if (fromAutoCollapse !== true) {\n-                onEach(document.getElementsByClassName(\"collapse-toggle\"), function(e) {\n+                onEach(Array.prototype.slice.call(\n+                           document.getElementsByClassName(\"collapse-toggle\")),\n+                       function(e) {\n                     collapseDocs(e, \"show\");\n                 });\n             }\n         } else {\n             updateLocalStorage(\"rustdoc-collapse\", \"true\");\n-            addClass(toggle, \"will-expand\");\n-            onEveryMatchingChild(toggle, \"inner\", function(e) {\n+            addClass(innerToggle, \"will-expand\");\n+            onEveryMatchingChild(innerToggle, \"inner\", function(e) {\n                 e.innerHTML = labelForToggleButton(true);\n             });\n-            toggle.title = \"expand all docs\";\n+            innerToggle.title = \"expand all docs\";\n             if (fromAutoCollapse !== true) {\n-                onEach(document.getElementsByClassName(\"collapse-toggle\"), function(e) {\n+                onEach(Array.prototype.slice.call(\n+                           document.getElementsByClassName(\"collapse-toggle\")),\n+                       function(e) {\n                     collapseDocs(e, \"hide\", pageId);\n                 });\n             }\n@@ -1987,12 +1984,12 @@ if (!DOMTokenList.prototype.remove) {\n                 }\n                 if (action === \"hide\") {\n                     addClass(relatedDoc, \"hidden-by-usual-hider\");\n-                    onEach(toggle.childNodes, adjustToggle(true));\n+                    onEach(Array.prototype.slice.call(toggle.childNodes), adjustToggle(true));\n                     addClass(toggle.parentNode, \"collapsed\");\n                 } else if (action === \"show\") {\n                     removeClass(relatedDoc, \"hidden-by-usual-hider\");\n                     removeClass(toggle.parentNode, \"collapsed\");\n-                    onEach(toggle.childNodes, adjustToggle(false));\n+                    onEach(Array.prototype.slice.call(toggle.childNodes), adjustToggle(false));\n                 }\n             }\n         } else {\n@@ -2025,13 +2022,13 @@ if (!DOMTokenList.prototype.remove) {\n             if (action === \"show\") {\n                 removeClass(relatedDoc, \"fns-now-collapsed\");\n                 removeClass(docblock, \"hidden-by-usual-hider\");\n-                onEach(toggle.childNodes, adjustToggle(false));\n-                onEach(relatedDoc.childNodes, implHider(false));\n+                onEach(Array.prototype.slice.call(toggle.childNodes), adjustToggle(false));\n+                onEach(Array.prototype.slice.call(relatedDoc.childNodes), implHider(false));\n             } else if (action === \"hide\") {\n                 addClass(relatedDoc, \"fns-now-collapsed\");\n                 addClass(docblock, \"hidden-by-usual-hider\");\n-                onEach(toggle.childNodes, adjustToggle(true));\n-                onEach(relatedDoc.childNodes, implHider(true));\n+                onEach(Array.prototype.slice.call(toggle.childNodes), adjustToggle(true));\n+                onEach(Array.prototype.slice.call(relatedDoc.childNodes), implHider(true));\n             }\n         }\n     }\n@@ -2055,7 +2052,9 @@ if (!DOMTokenList.prototype.remove) {\n             var impl_list = document.getElementById(\"implementations-list\");\n \n             if (impl_list !== null) {\n-                onEach(impl_list.getElementsByClassName(\"collapse-toggle\"), collapser);\n+                onEach(Array.prototype.slice.call(\n+                           impl_list.getElementsByClassName(\"collapse-toggle\")),\n+                       collapser);\n             }\n         }\n     }\n@@ -2069,30 +2068,30 @@ if (!DOMTokenList.prototype.remove) {\n         referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n     }\n \n-    var toggle = document.createElement(\"a\");\n-    toggle.href = \"javascript:void(0)\";\n-    toggle.className = \"collapse-toggle\";\n-    toggle.innerHTML = \"[<span class=\\\"inner\\\">\" + labelForToggleButton(false) + \"</span>]\";\n+    function createSimpleToggle(sectionIsCollapsed) {\n+        var toggle = document.createElement(\"a\");\n+        toggle.href = \"javascript:void(0)\";\n+        toggle.className = \"collapse-toggle\";\n+        toggle.innerHTML = \"[<span class=\\\"inner\\\">\" + labelForToggleButton(sectionIsCollapsed) +\n+                           \"</span>]\";\n+        return toggle;\n+    }\n+\n+    var toggle = createSimpleToggle(false);\n \n     var func = function(e) {\n         var next = e.nextElementSibling;\n-        if (next && hasClass(e, \"impl\") && hasClass(next, \"docblock\")) {\n-            next = next.nextElementSibling;\n-        }\n         if (!next) {\n             return;\n         }\n-        if ((hasClass(e, \"method\") || hasClass(e, \"associatedconstant\") ||\n-             next.getElementsByClassName(\"method\").length > 0) &&\n-            (hasClass(next, \"docblock\") ||\n-             hasClass(e, \"impl\") ||\n-             (hasClass(next, \"stability\") &&\n-              hasClass(next.nextElementSibling, \"docblock\")))) {\n+        if (hasClass(next, \"docblock\") ||\n+            (hasClass(next, \"stability\") &&\n+             hasClass(next.nextElementSibling, \"docblock\"))) {\n             insertAfter(toggle.cloneNode(true), e.childNodes[e.childNodes.length - 1]);\n         }\n     };\n \n-    var func2 = function(e) {\n+    var funcImpl = function(e) {\n         var next = e.nextElementSibling;\n         if (next && hasClass(next, \"docblock\")) {\n             next = next.nextElementSibling;\n@@ -2105,13 +2104,9 @@ if (!DOMTokenList.prototype.remove) {\n         }\n     };\n \n-    console.log('5', Date.now() - start);\n-    onEach(document.getElementsByClassName(\"method\"), func);\n-    console.log('6', Date.now() - start);\n-    onEach(document.getElementsByClassName(\"associatedconstant\"), func);\n-    console.log('7', Date.now() - start);\n-    onEach(document.getElementsByClassName(\"impl\"), func2   );\n-    console.log('8', Date.now() - start);\n+    onEach(Array.prototype.slice.call(document.getElementsByClassName(\"method\")), func);\n+    onEach(Array.prototype.slice.call(document.getElementsByClassName(\"associatedconstant\")), func);\n+    onEach(Array.prototype.slice.call(document.getElementsByClassName(\"impl\")), funcImpl);\n     var impl_call = function() {};\n     if (getCurrentValue(\"rustdoc-method-docs\") !== \"false\") {\n         impl_call = function(e, newToggle, pageId) {\n@@ -2132,7 +2127,8 @@ if (!DOMTokenList.prototype.remove) {\n     function toggleClicked() {\n         if (hasClass(this, \"collapsed\")) {\n             removeClass(this, \"collapsed\");\n-            onEach(this.parentNode.getElementsByClassName(\"hidden\"), function(x) {\n+            onEach(Array.prototype.slice.call(this.parentNode.getElementsByClassName(\"hidden\")),\n+                   function(x) {\n                 if (hasClass(x, \"content\") === false) {\n                     removeClass(x, \"hidden\");\n                     addClass(x, \"x\");\n@@ -2142,7 +2138,8 @@ if (!DOMTokenList.prototype.remove) {\n                              \"</span>] Hide undocumented items\";\n         } else {\n             addClass(this, \"collapsed\");\n-            onEach(this.parentNode.getElementsByClassName(\"x\"), function(x) {\n+            onEach(Array.prototype.slice.call(this.parentNode.getElementsByClassName(\"x\")),\n+                   function(x) {\n                 if (hasClass(x, \"content\") === false) {\n                     addClass(x, \"hidden\");\n                     removeClass(x, \"x\");\n@@ -2152,8 +2149,8 @@ if (!DOMTokenList.prototype.remove) {\n                              \"</span>] Show hidden undocumented items\";\n         }\n     }\n-    onEach(document.getElementsByClassName(\"impl-items\"), function(e) {\n-        onEach(e.getElementsByClassName(\"associatedconstant\"), func);\n+    onEach(Array.prototype.slice.call(document.getElementsByClassName(\"impl-items\")), function(e) {\n+        onEach(Array.prototype.slice.call(e.getElementsByClassName(\"associatedconstant\")), func);\n         var hiddenElems = e.getElementsByClassName(\"hidden\");\n         var needToggle = false;\n \n@@ -2166,13 +2163,12 @@ if (!DOMTokenList.prototype.remove) {\n             }\n         }\n         if (needToggle === true) {\n-            var toggle = newToggle.cloneNode(true);\n-            toggle.onclick = toggleClicked;\n-            e.insertBefore(toggle, e.firstChild);\n-            impl_call(e, toggle, pageId);\n+            var inner_toggle = newToggle.cloneNode(true);\n+            inner_toggle.onclick = toggleClicked;\n+            e.insertBefore(inner_toggle, e.firstChild);\n+            impl_call(e, inner_toggle, pageId);\n         }\n     });\n-    console.log('9', Date.now() - start);\n \n     function createToggle(otherMessage, fontSize, extraClass, show) {\n         var span = document.createElement(\"span\");\n@@ -2214,15 +2210,18 @@ if (!DOMTokenList.prototype.remove) {\n         if (hasClass(e, \"autohide\")) {\n             var wrap = e.previousElementSibling;\n             if (wrap && hasClass(wrap, \"toggle-wrapper\")) {\n-                var toggle = wrap.childNodes[0];\n+                var inner_toggle = wrap.childNodes[0];\n                 var extra = e.childNodes[0].tagName === \"H3\";\n \n                 e.style.display = \"none\";\n                 addClass(wrap, \"collapsed\");\n-                onEach(toggle.getElementsByClassName(\"inner\"), function(e) {\n+                onEach(Array.prototype.slice.call(inner_toggle.getElementsByClassName(\"inner\")),\n+                       function(e) {\n                     e.innerHTML = labelForToggleButton(true);\n                 });\n-                onEach(toggle.getElementsByClassName(\"toggle-label\"), function(e) {\n+                onEach(Array.prototype.slice.call(\n+                           inner_toggle.getElementsByClassName(\"toggle-label\")),\n+                       function(e) {\n                     e.style.display = \"inline-block\";\n                     if (extra === true) {\n                         i_e.innerHTML = \" Show \" + e.childNodes[0].innerHTML;\n@@ -2269,40 +2268,28 @@ if (!DOMTokenList.prototype.remove) {\n         }\n     }\n \n-    console.log('10', Date.now() - start);\n-    onEach(document.getElementsByClassName(\"docblock\"), buildToggleWrapper);\n-    console.log('11', Date.now() - start);\n-    onEach(document.getElementsByClassName(\"sub-variant\"), buildToggleWrapper);\n-    console.log('12', Date.now() - start);\n-\n-    function createToggleWrapper(tog) {\n-        var span = document.createElement(\"span\");\n-        span.className = \"toggle-label\";\n-        span.style.display = \"none\";\n-        span.innerHTML = \"&nbsp;Expand&nbsp;attributes\";\n-        tog.appendChild(span);\n-\n-        var wrapper = document.createElement(\"div\");\n-        wrapper.className = \"toggle-wrapper toggle-attributes\";\n-        wrapper.appendChild(tog);\n-        return wrapper;\n-    }\n+    onEach(Array.prototype.slice.call(document.getElementsByClassName(\"docblock\")),\n+           buildToggleWrapper);\n+    onEach(Array.prototype.slice.call(document.getElementsByClassName(\"sub-variant\")),\n+           buildToggleWrapper);\n \n     // In the search display, allows to switch between tabs.\n     function printTab(nb) {\n         if (nb === 0 || nb === 1 || nb === 2) {\n             currentTab = nb;\n         }\n         var nb_copy = nb;\n-        onEach(document.getElementById(\"titles\").childNodes, function(elem) {\n+        onEach(Array.prototype.slice.call(document.getElementById(\"titles\").childNodes),\n+               function(elem) {\n             if (nb_copy === 0) {\n                 addClass(elem, \"selected\");\n             } else {\n                 removeClass(elem, \"selected\");\n             }\n             nb_copy -= 1;\n         });\n-        onEach(document.getElementById(\"results\").childNodes, function(elem) {\n+        onEach(Array.prototype.slice.call(document.getElementById(\"results\").childNodes),\n+               function(elem) {\n             if (nb === 0) {\n                 elem.style.display = \"\";\n             } else {\n@@ -2312,18 +2299,31 @@ if (!DOMTokenList.prototype.remove) {\n         });\n     }\n \n+    function createToggleWrapper(tog) {\n+        var span = document.createElement(\"span\");\n+        span.className = \"toggle-label\";\n+        span.style.display = \"none\";\n+        span.innerHTML = \"&nbsp;Expand&nbsp;attributes\";\n+        tog.appendChild(span);\n+\n+        var wrapper = document.createElement(\"div\");\n+        wrapper.className = \"toggle-wrapper toggle-attributes\";\n+        wrapper.appendChild(tog);\n+        return wrapper;\n+    }\n+\n     // To avoid checking on \"rustdoc-item-attributes\" value on every loop...\n     var itemAttributesFunc = function() {};\n     if (getCurrentValue(\"rustdoc-item-attributes\") !== \"false\") {\n         itemAttributesFunc = function(x) {\n             collapseDocs(x.previousSibling.childNodes[0], \"toggle\");\n         };\n     }\n-    onEach(document.getElementById(\"main\").getElementsByClassName(\"attributes\"), function(i_e) {\n-        i_e.parentNode.insertBefore(createToggleWrapper(toggle.cloneNode(true)), i_e);\n+    var attributesToggle = createToggleWrapper(createSimpleToggle(false));\n+    onEach(Array.prototype.slice.call(main.getElementsByClassName(\"attributes\")), function(i_e) {\n+        i_e.parentNode.insertBefore(attributesToggle.cloneNode(true), i_e);\n         itemAttributesFunc(i_e);\n     });\n-    console.log('12a', Date.now() - start);\n \n     // To avoid checking on \"rustdoc-line-numbers\" value on every loop...\n     var lineNumbersFunc = function() {};\n@@ -2340,8 +2340,8 @@ if (!DOMTokenList.prototype.remove) {\n             x.parentNode.insertBefore(node, x);\n         };\n     }\n-    console.log('13', Date.now() - start);\n-    onEach(document.getElementsByClassName(\"rust-example-rendered\"), function(e) {\n+    onEach(Array.prototype.slice.call(document.getElementsByClassName(\"rust-example-rendered\")),\n+           function(e) {\n         if (hasClass(e, \"compile_fail\")) {\n             e.addEventListener(\"mouseover\", function(event) {\n                 this.parentElement.previousElementSibling.childNodes[0].style.color = \"#f00\";\n@@ -2359,7 +2359,6 @@ if (!DOMTokenList.prototype.remove) {\n         }\n         lineNumbersFunc(e);\n     });\n-    console.log('14', Date.now() - start);\n \n     function showModal(content) {\n         var modal = document.createElement(\"div\");\n@@ -2380,16 +2379,16 @@ if (!DOMTokenList.prototype.remove) {\n         }\n     }\n \n-    onEach(document.getElementsByClassName(\"important-traits\"), function(e) {\n+    onEach(Array.prototype.slice.call(document.getElementsByClassName(\"important-traits\")),\n+           function(e) {\n         e.onclick = function() {\n             showModal(e.lastElementChild.innerHTML);\n         };\n     });\n-    console.log('15', Date.now() - start);\n \n     function putBackSearch(search_input) {\n         if (search_input.value !== \"\") {\n-            addClass(document.getElementById(\"main\"), \"hidden\");\n+            addClass(main, \"hidden\");\n             removeClass(document.getElementById(\"search\"), \"hidden\");\n             if (browserSupportsHistoryApi()) {\n                 history.replaceState(search_input.value,\n@@ -2407,7 +2406,7 @@ if (!DOMTokenList.prototype.remove) {\n \n     var params = getQueryStringParams();\n     if (params && params.search) {\n-        addClass(document.getElementById(\"main\"), \"hidden\");\n+        addClass(main, \"hidden\");\n         var search = document.getElementById(\"search\");\n         removeClass(search, \"hidden\");\n         search.innerHTML = \"<h3 style=\\\"text-align: center;\\\">Loading search results...</h3>\";\n@@ -2429,23 +2428,18 @@ if (!DOMTokenList.prototype.remove) {\n         hideSidebar();\n     };\n \n-    console.log('16', Date.now() - start);\n     autoCollapse(getPageId(), getCurrentValue(\"rustdoc-collapse\") === \"true\");\n-    console.log('17', Date.now() - start);\n \n     if (window.location.hash && window.location.hash.length > 0) {\n         expandSection(window.location.hash.replace(/^#/, \"\"));\n     }\n \n-    var main = document.getElementById(\"main\");\n     if (main) {\n-        console.log('18', Date.now() - start);\n-        onEach(main.childNodes, function(e) {\n+        onEach(Array.prototype.slice.call(main.childNodes), function(e) {\n             if (e.tagName === \"H2\" || e.tagName === \"H3\") {\n                 e.nextElementSibling.style.display = \"block\";\n             }\n         });\n-        console.log('19', Date.now() - start);\n     }\n \n     function addSearchOptions(crates) {"}]}