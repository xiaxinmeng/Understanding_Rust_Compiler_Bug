{"sha": "8e9ccbf97a70259b6c6576e8fd7d77d28238737e", "node_id": "C_kwDOAAsO6NoAKDhlOWNjYmY5N2E3MDI1OWI2YzY1NzZlOGZkN2Q3N2QyODIzODczN2U", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2022-01-03T02:03:03Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-01-03T02:03:03Z"}, "message": "Merge #11177\n\n11177: internal: dont descend into comments r=Veykril a=jhgg\n\nfixes #11176\n\nCo-authored-by: Jake Heinz <jh@discordapp.com>", "tree": {"sha": "89f603be5b568a07d545129ea87f6f2ff74ff6f4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/89f603be5b568a07d545129ea87f6f2ff74ff6f4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8e9ccbf97a70259b6c6576e8fd7d77d28238737e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJh0llXCRBK7hj4Ov3rIwAABK8IAHelVLUZ2OrZUmW5lugHVOVw\ntaCoMMKit+eL4fZ3ReMGaJy31chgo8YlEJyev+KsnXZ0RlErBGF4OkVyctOI7iDD\nXpblaeNpQIDZP17wmi8EMJO2HjUS20BktLxD1+Sg41CkaSSm4jL0FJ2fvGYabEZ/\nUY29l4h/7YgGKfIhH1b6EXaMWILVH5MyNXuDcw2Bu64YwqSrx52Thqh/cAyGaqjl\n7HlV48WPe8v8Km1GTY/Jdk6hYAmeec6yERftj3yoggOHjNVwHjyPcdbsmkqzVUJI\nWQ+r+l1qiD7vut9RdeGHVl6u7piZ/NzRjnhDj2S+fwiMCcSp5l9joJcjxsg/V6Y=\n=4air\n-----END PGP SIGNATURE-----\n", "payload": "tree 89f603be5b568a07d545129ea87f6f2ff74ff6f4\nparent abbc7e3a0ed66e87b378476452f027732762a86a\nparent 04decd5e6b36574ca30369c26481d5a51d739971\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1641175383 +0000\ncommitter GitHub <noreply@github.com> 1641175383 +0000\n\nMerge #11177\n\n11177: internal: dont descend into comments r=Veykril a=jhgg\n\nfixes #11176\n\nCo-authored-by: Jake Heinz <jh@discordapp.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8e9ccbf97a70259b6c6576e8fd7d77d28238737e", "html_url": "https://github.com/rust-lang/rust/commit/8e9ccbf97a70259b6c6576e8fd7d77d28238737e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8e9ccbf97a70259b6c6576e8fd7d77d28238737e/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "abbc7e3a0ed66e87b378476452f027732762a86a", "url": "https://api.github.com/repos/rust-lang/rust/commits/abbc7e3a0ed66e87b378476452f027732762a86a", "html_url": "https://github.com/rust-lang/rust/commit/abbc7e3a0ed66e87b378476452f027732762a86a"}, {"sha": "04decd5e6b36574ca30369c26481d5a51d739971", "url": "https://api.github.com/repos/rust-lang/rust/commits/04decd5e6b36574ca30369c26481d5a51d739971", "html_url": "https://github.com/rust-lang/rust/commit/04decd5e6b36574ca30369c26481d5a51d739971"}], "stats": {"total": 5, "additions": 4, "deletions": 1}, "files": [{"sha": "f20d629fbf1d069867ead0036be92c953bb3fd26", "filename": "crates/ide/src/syntax_highlighting.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/8e9ccbf97a70259b6c6576e8fd7d77d28238737e/crates%2Fide%2Fsrc%2Fsyntax_highlighting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8e9ccbf97a70259b6c6576e8fd7d77d28238737e/crates%2Fide%2Fsrc%2Fsyntax_highlighting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fsyntax_highlighting.rs?ref=8e9ccbf97a70259b6c6576e8fd7d77d28238737e", "patch": "@@ -282,7 +282,10 @@ fn traverse(\n \n         // only attempt to descend if we are inside a macro call or attribute\n         // as calling `descend_into_macros_single` gets rather expensive if done for every single token\n-        let descend_token = current_macro_call.is_some() || current_attr_call.is_some();\n+        // additionally, do not descend into comments, descending maps down to doc attributes which get\n+        // tagged as string literals.\n+        let descend_token = (current_macro_call.is_some() || current_attr_call.is_some())\n+            && element.kind() != COMMENT;\n         let element_to_highlight = if descend_token {\n             let token = match &element {\n                 NodeOrToken::Node(_) => continue,"}]}