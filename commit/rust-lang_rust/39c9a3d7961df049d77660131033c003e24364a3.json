{"sha": "39c9a3d7961df049d77660131033c003e24364a3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM5YzlhM2Q3OTYxZGYwNDlkNzc2NjAxMzEwMzNjMDAzZTI0MzY0YTM=", "commit": {"author": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2017-09-05T20:28:15Z"}, "committer": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2017-09-14T04:36:29Z"}, "message": "Attempt to fix the component manifest problem for rls-preview\n\ncc #44270", "tree": {"sha": "a3ff4a6713f39c6350ca6078befa6c6b300f329f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a3ff4a6713f39c6350ca6078befa6c6b300f329f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/39c9a3d7961df049d77660131033c003e24364a3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/39c9a3d7961df049d77660131033c003e24364a3", "html_url": "https://github.com/rust-lang/rust/commit/39c9a3d7961df049d77660131033c003e24364a3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/39c9a3d7961df049d77660131033c003e24364a3/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d1ca653b170c235ad01a83d89fcb18b1f8b6a3b0", "url": "https://api.github.com/repos/rust-lang/rust/commits/d1ca653b170c235ad01a83d89fcb18b1f8b6a3b0", "html_url": "https://github.com/rust-lang/rust/commit/d1ca653b170c235ad01a83d89fcb18b1f8b6a3b0"}], "stats": {"total": 17, "additions": 13, "deletions": 4}, "files": [{"sha": "7bca088dbd5a8f8529738b5fce536ca66a030576", "filename": "src/bootstrap/dist.rs", "status": "modified", "additions": 13, "deletions": 4, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/39c9a3d7961df049d77660131033c003e24364a3/src%2Fbootstrap%2Fdist.rs", "raw_url": "https://github.com/rust-lang/rust/raw/39c9a3d7961df049d77660131033c003e24364a3/src%2Fbootstrap%2Fdist.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdist.rs?ref=39c9a3d7961df049d77660131033c003e24364a3", "patch": "@@ -1098,8 +1098,14 @@ impl Step for Rls {\n            .arg(\"--output-dir\").arg(&distdir(build))\n            .arg(\"--non-installed-overlay\").arg(&overlay)\n            .arg(format!(\"--package-name={}-{}\", name, target))\n-           .arg(\"--component-name=rls\")\n            .arg(\"--legacy-manifest-dirs=rustlib,cargo\");\n+\n+        if build.config.channel == \"nightly\" {\n+            cmd.arg(\"--component-name=rls\");\n+        } else {\n+            cmd.arg(\"--component-name=rls-preview\");\n+        }\n+\n         build.run(&mut cmd);\n         distdir(build).join(format!(\"{}-{}.tar.gz\", name, target))\n     }\n@@ -1302,9 +1308,12 @@ impl Step for Extended {\n             cp_r(&work.join(&format!(\"{}-{}\", pkgname(build, \"rust-std\"), target))\n                         .join(format!(\"rust-std-{}\", target)),\n                     &exe.join(\"rust-std\"));\n-            cp_r(&work.join(&format!(\"{}-{}\", pkgname(build, \"rls\"), target))\n-                        .join(\"rls\"),\n-                    &exe.join(\"rls\"));\n+            let rls_path = if build.config.channel == \"nightly\" {\n+                work.join(&format!(\"{}-{}\", pkgname(build, \"rls\"), target)).join(\"rls\")\n+            } else {\n+                work.join(&format!(\"{}-{}\", pkgname(build, \"rls\"), target)).join(\"rls-preview\")\n+            };\n+            cp_r(&rls_path, &exe.join(\"rls\"));\n             cp_r(&work.join(&format!(\"{}-{}\", pkgname(build, \"rust-analysis\"), target))\n                         .join(format!(\"rust-analysis-{}\", target)),\n                     &exe.join(\"rust-analysis\"));"}]}