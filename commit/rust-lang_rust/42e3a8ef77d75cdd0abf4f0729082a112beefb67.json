{"sha": "42e3a8ef77d75cdd0abf4f0729082a112beefb67", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQyZTNhOGVmNzdkNzVjZGQwYWJmNGYwNzI5MDgyYTExMmJlZWZiNjc=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-08-07T12:21:15Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-08-07T12:23:05Z"}, "message": "infix range is range", "tree": {"sha": "41df9eb51fa2abfdd9449cb2bac700f47d806184", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/41df9eb51fa2abfdd9449cb2bac700f47d806184"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/42e3a8ef77d75cdd0abf4f0729082a112beefb67", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/42e3a8ef77d75cdd0abf4f0729082a112beefb67", "html_url": "https://github.com/rust-lang/rust/commit/42e3a8ef77d75cdd0abf4f0729082a112beefb67", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/42e3a8ef77d75cdd0abf4f0729082a112beefb67/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ede506e0314a0560710cad291c1f91d939068cec", "url": "https://api.github.com/repos/rust-lang/rust/commits/ede506e0314a0560710cad291c1f91d939068cec", "html_url": "https://github.com/rust-lang/rust/commit/ede506e0314a0560710cad291c1f91d939068cec"}], "stats": {"total": 41, "additions": 27, "deletions": 14}, "files": [{"sha": "55e965ff420770fa1883dee57d2d8b8f557d3a2e", "filename": "src/grammar/expressions/mod.rs", "status": "modified", "additions": 4, "deletions": 7, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/42e3a8ef77d75cdd0abf4f0729082a112beefb67/src%2Fgrammar%2Fexpressions%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/42e3a8ef77d75cdd0abf4f0729082a112beefb67/src%2Fgrammar%2Fexpressions%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fgrammar%2Fexpressions%2Fmod.rs?ref=42e3a8ef77d75cdd0abf4f0729082a112beefb67", "patch": "@@ -92,17 +92,20 @@ fn expr_bp(p: &mut Parser, r: Restrictions, bp: u8) {\n     };\n \n     loop {\n+        let is_range = p.current() == DOTDOT;\n         let (op_bp, op) = current_op(p);\n         if op_bp < bp {\n             break;\n         }\n+        let m = lhs.precede(p);\n         match op {\n             Op::Simple => p.bump(),\n             Op::Composite(kind, n) => {\n                 p.bump_compound(kind, n);\n             }\n         }\n-        lhs = bin_expr(p, r, lhs, op_bp + 1);\n+        expr_bp(p, r, op_bp + 1);\n+        lhs = m.complete(p, if is_range { RANGE_EXPR } else { BIN_EXPR });\n     }\n }\n \n@@ -330,9 +333,3 @@ fn struct_lit(p: &mut Parser) {\n     }\n     p.expect(R_CURLY);\n }\n-\n-fn bin_expr(p: &mut Parser, r: Restrictions, lhs: CompletedMarker, bp: u8) -> CompletedMarker {\n-    let m = lhs.precede(p);\n-    expr_bp(p, r, bp);\n-    m.complete(p, BIN_EXPR)\n-}"}, {"sha": "03f4ae7b208ba09d2ee989ff65dfa95f18922b89", "filename": "tests/data/parser/ok/0029_range_forms.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/42e3a8ef77d75cdd0abf4f0729082a112beefb67/tests%2Fdata%2Fparser%2Fok%2F0029_range_forms.rs", "raw_url": "https://github.com/rust-lang/rust/raw/42e3a8ef77d75cdd0abf4f0729082a112beefb67/tests%2Fdata%2Fparser%2Fok%2F0029_range_forms.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Fok%2F0029_range_forms.rs?ref=42e3a8ef77d75cdd0abf4f0729082a112beefb67", "patch": "@@ -2,4 +2,5 @@ fn foo() {\n     ..1 + 1;\n     ..z = 2;\n     x = false..1 == 1;\n+    let x = 1..;\n }"}, {"sha": "2dbc6bdeece3bc2c4e6374f6b8fece9d42fbc2ec", "filename": "tests/data/parser/ok/0029_range_forms.txt", "status": "modified", "additions": 22, "deletions": 7, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/42e3a8ef77d75cdd0abf4f0729082a112beefb67/tests%2Fdata%2Fparser%2Fok%2F0029_range_forms.txt", "raw_url": "https://github.com/rust-lang/rust/raw/42e3a8ef77d75cdd0abf4f0729082a112beefb67/tests%2Fdata%2Fparser%2Fok%2F0029_range_forms.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Fok%2F0029_range_forms.txt?ref=42e3a8ef77d75cdd0abf4f0729082a112beefb67", "patch": "@@ -1,5 +1,5 @@\n-FILE@[0; 62)\n-  FN_ITEM@[0; 61)\n+FILE@[0; 79)\n+  FN_ITEM@[0; 78)\n     FN_KW@[0; 2)\n     WHITESPACE@[2; 3)\n     NAME@[3; 6)\n@@ -8,7 +8,7 @@ FILE@[0; 62)\n       L_PAREN@[6; 7)\n       R_PAREN@[7; 8)\n     WHITESPACE@[8; 9)\n-    BLOCK_EXPR@[9; 61)\n+    BLOCK_EXPR@[9; 78)\n       L_CURLY@[9; 10)\n       WHITESPACE@[10; 15)\n       EXPR_STMT@[15; 23)\n@@ -50,7 +50,7 @@ FILE@[0; 62)\n           WHITESPACE@[42; 43)\n           EQ@[43; 44)\n           WHITESPACE@[44; 45)\n-          BIN_EXPR@[45; 58)\n+          RANGE_EXPR@[45; 58)\n             LITERAL@[45; 50)\n               FALSE_KW@[45; 50)\n             DOTDOT@[50; 52)\n@@ -63,6 +63,21 @@ FILE@[0; 62)\n               LITERAL@[57; 58)\n                 INT_NUMBER@[57; 58) \"1\"\n         SEMI@[58; 59)\n-      WHITESPACE@[59; 60)\n-      R_CURLY@[60; 61)\n-  WHITESPACE@[61; 62)\n+      WHITESPACE@[59; 64)\n+      LET_STMT@[64; 76)\n+        LET_KW@[64; 67)\n+        WHITESPACE@[67; 68)\n+        BIND_PAT@[68; 69)\n+          NAME@[68; 69)\n+            IDENT@[68; 69) \"x\"\n+        WHITESPACE@[69; 70)\n+        EQ@[70; 71)\n+        WHITESPACE@[71; 72)\n+        RANGE_EXPR@[72; 75)\n+          LITERAL@[72; 73)\n+            INT_NUMBER@[72; 73) \"1\"\n+          DOTDOT@[73; 75)\n+        SEMI@[75; 76)\n+      WHITESPACE@[76; 77)\n+      R_CURLY@[77; 78)\n+  WHITESPACE@[78; 79)"}]}