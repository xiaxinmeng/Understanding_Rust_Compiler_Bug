{"sha": "403ae37ce8f680e378dc77904a27453df0867b99", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQwM2FlMzdjZThmNjgwZTM3OGRjNzc5MDRhMjc0NTNkZjA4NjdiOTk=", "commit": {"author": {"name": "Mark Simulacrum", "email": "mark.simulacrum@gmail.com", "date": "2017-03-05T17:36:31Z"}, "committer": {"name": "Mark Simulacrum", "email": "mark.simulacrum@gmail.com", "date": "2017-03-06T14:04:04Z"}, "message": "Remove reference to Ty.", "tree": {"sha": "dd5e69756c13accab0358667848df53f51511013", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/dd5e69756c13accab0358667848df53f51511013"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/403ae37ce8f680e378dc77904a27453df0867b99", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/403ae37ce8f680e378dc77904a27453df0867b99", "html_url": "https://github.com/rust-lang/rust/commit/403ae37ce8f680e378dc77904a27453df0867b99", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/403ae37ce8f680e378dc77904a27453df0867b99/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "89fe4df9c7095f3f449a89bae97d087e7df08fcb", "url": "https://api.github.com/repos/rust-lang/rust/commits/89fe4df9c7095f3f449a89bae97d087e7df08fcb", "html_url": "https://github.com/rust-lang/rust/commit/89fe4df9c7095f3f449a89bae97d087e7df08fcb"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "2b9ccf6d3e246c666e0eabf9c9d812638324313f", "filename": "src/librustc_typeck/check/mod.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/403ae37ce8f680e378dc77904a27453df0867b99/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/403ae37ce8f680e378dc77904a27453df0867b99/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs?ref=403ae37ce8f680e378dc77904a27453df0867b99", "patch": "@@ -1935,10 +1935,10 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n             // We must collect the defaults *before* we do any unification. Because we have\n             // directly attached defaults to the type variables any unification that occurs\n             // will erase defaults causing conflicting defaults to be completely ignored.\n-            let default_map: FxHashMap<_, _> =\n+            let default_map: FxHashMap<Ty<'tcx>, _> =\n                 unsolved_variables\n                     .iter()\n-                    .filter_map(|t| self.default(t).map(|d| (t, d)))\n+                    .filter_map(|t| self.default(t).map(|d| (*t, d)))\n                     .collect();\n \n             let mut unbound_tyvars = FxHashSet();\n@@ -2068,7 +2068,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n     fn apply_defaults_and_return_conflicts<'b>(\n         &'b self,\n         unbound_vars: &'b FxHashSet<Ty<'tcx>>,\n-        default_map: &'b FxHashMap<&'b Ty<'tcx>, type_variable::Default<'tcx>>,\n+        default_map: &'b FxHashMap<Ty<'tcx>, type_variable::Default<'tcx>>,\n         conflict: Option<Ty<'tcx>>,\n     ) -> impl Iterator<Item=(Ty<'tcx>, type_variable::Default<'tcx>)> + 'b {\n         use rustc::ty::error::UnconstrainedNumeric::Neither;\n@@ -2087,7 +2087,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n                         self.demand_eqtype(syntax_pos::DUMMY_SP, ty, self.tcx.types.f64)\n                     },\n                     Neither => {\n-                        if let Some(default) = default_map.get(&ty) {\n+                        if let Some(default) = default_map.get(ty) {\n                             let default = default.clone();\n                             let default_ty = self.normalize_associated_types_in(\n                                 default.origin_span, &default.ty);"}]}