{"sha": "8f8b3f26c2aac88b8d9ad4a43124142724f29df0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhmOGIzZjI2YzJhYWM4OGI4ZDlhZDRhNDMxMjQxNDI3MjRmMjlkZjA=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2019-08-01T09:34:53Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2019-08-01T13:57:21Z"}, "message": "ci: forward the TOOLSTATE_PUBLISH environment variable inside docker\n\nA recent commit modified toolstate to only push updated data when the\nTOOLSTATE_PUBLISH environment variable is present. This worked fine on\nWindows but failed on Linux, since Linux jobs run inside Docker\ncontainers and the variable wasn't forwarded inside it.\n\nThis changes the Docker startup code to set the TOOLSTATE_PUBLISH\nenviornment variable inside the container if it's present outside.", "tree": {"sha": "059ba23d7366faf08528492154c5e20435a7975a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/059ba23d7366faf08528492154c5e20435a7975a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8f8b3f26c2aac88b8d9ad4a43124142724f29df0", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE1JbYPtLJAsc22U9xPgar6Auq8ZwFAl1C78MACgkQPgar6Auq\n8ZxUOw/9ESq/SVJhxTSRL2uZuTNGJ3sHVCKtpMpDpcI5dooYF6X+2ov+Br4EdJRL\nH5gIw2/qYXpZ8QHt8NuuoaqOQlqbNFyRX9/QCsRdeRe+qex1Z8Ubhj1uGazvJNKV\nDixMDsgwaRZ1sF4muwlJtO02sIH5DBYiAM8jW0aUzcgbLiEZsdS3rWFN8CiAj+Bt\n/L+1ULrlT+yIFhBbr46W80ZDWtUkIik0g3aCZG5It14JN420QrEqq7ralzrC0MqO\ncE6E44xppFp6cqxhqYrjVRirmrzAzFPw2y7euNVFXt5Cs2awkP8k7HoZh66NMEqo\nuWjCaugPfkfUM1uH04cfdmH6qUiUnDXVfE/JH6ECOZM2hXV0ccuNK8iH9uoHbBqu\nZy0P3omkZRqPhgB4VA+gGY2c3ajx9+DGaDuK6jRUBQ2rcr7TzdZwNL8g70sDRyvI\nFYDucNgxqu6XC7+1wcuAW3zeSzOjJPIpzPc24q00iGcVNfCncCRZle3YU2teHM6t\n9BxVao/Jkr/qzxquUYk+8WZQEPOxRiypjc9zK1M4JU2m326UHekmYF8nV8bJAsR7\nVqAKChani4086y8FlpwXpMbY9CDhAJ4+qJa2L9317yiHszOm3GVzerwrXFwhZft6\ncMwJAGNRzAFVbL4kn4voAFkWj6ye61S1ClOOVesmACd9uW7lDgg=\n=24mw\n-----END PGP SIGNATURE-----", "payload": "tree 059ba23d7366faf08528492154c5e20435a7975a\nparent 09e39897587dca70f0b15093d425a682c392349c\nauthor Pietro Albini <pietro@pietroalbini.org> 1564652093 +0200\ncommitter Pietro Albini <pietro@pietroalbini.org> 1564667841 +0200\n\nci: forward the TOOLSTATE_PUBLISH environment variable inside docker\n\nA recent commit modified toolstate to only push updated data when the\nTOOLSTATE_PUBLISH environment variable is present. This worked fine on\nWindows but failed on Linux, since Linux jobs run inside Docker\ncontainers and the variable wasn't forwarded inside it.\n\nThis changes the Docker startup code to set the TOOLSTATE_PUBLISH\nenviornment variable inside the container if it's present outside.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8f8b3f26c2aac88b8d9ad4a43124142724f29df0", "html_url": "https://github.com/rust-lang/rust/commit/8f8b3f26c2aac88b8d9ad4a43124142724f29df0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8f8b3f26c2aac88b8d9ad4a43124142724f29df0/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "09e39897587dca70f0b15093d425a682c392349c", "url": "https://api.github.com/repos/rust-lang/rust/commits/09e39897587dca70f0b15093d425a682c392349c", "html_url": "https://github.com/rust-lang/rust/commit/09e39897587dca70f0b15093d425a682c392349c"}], "stats": {"total": 1, "additions": 1, "deletions": 0}, "files": [{"sha": "415d6b63eb8dc1152de7a0c191c0ce0cc4da250a", "filename": "src/ci/docker/run.sh", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/8f8b3f26c2aac88b8d9ad4a43124142724f29df0/src%2Fci%2Fdocker%2Frun.sh", "raw_url": "https://github.com/rust-lang/rust/raw/8f8b3f26c2aac88b8d9ad4a43124142724f29df0/src%2Fci%2Fdocker%2Frun.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Frun.sh?ref=8f8b3f26c2aac88b8d9ad4a43124142724f29df0", "patch": "@@ -172,6 +172,7 @@ docker \\\n   --env BUILD_SOURCEBRANCHNAME \\\n   --env TOOLSTATE_REPO_ACCESS_TOKEN \\\n   --env TOOLSTATE_REPO \\\n+  --env TOOLSTATE_PUBLISH \\\n   --env CI_JOB_NAME=\"${CI_JOB_NAME-$IMAGE}\" \\\n   --init \\\n   --rm \\"}]}