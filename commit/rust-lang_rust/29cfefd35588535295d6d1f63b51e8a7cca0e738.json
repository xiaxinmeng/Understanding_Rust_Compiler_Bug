{"sha": "29cfefd35588535295d6d1f63b51e8a7cca0e738", "node_id": "C_kwDOAAsO6NoAKDI5Y2ZlZmQzNTU4ODUzNTI5NWQ2ZDFmNjNiNTFlOGE3Y2NhMGU3Mzg", "commit": {"author": {"name": "Nilstrieb", "email": "48135649+Nilstrieb@users.noreply.github.com", "date": "2022-07-27T11:58:29Z"}, "committer": {"name": "Nilstrieb", "email": "48135649+Nilstrieb@users.noreply.github.com", "date": "2022-07-27T12:15:44Z"}, "message": "Fix process-spawn-nonexistent on WSL\n\nIf appendWindowsPath is set to true (the default IIRC), running invalid\ncommands returns PermissionDenied instead of NotFound.", "tree": {"sha": "132154afdaa16611c6994465aea75acd0890d007", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/132154afdaa16611c6994465aea75acd0890d007"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/29cfefd35588535295d6d1f63b51e8a7cca0e738", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/29cfefd35588535295d6d1f63b51e8a7cca0e738", "html_url": "https://github.com/rust-lang/rust/commit/29cfefd35588535295d6d1f63b51e8a7cca0e738", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/29cfefd35588535295d6d1f63b51e8a7cca0e738/comments", "author": {"login": "Nilstrieb", "id": 48135649, "node_id": "MDQ6VXNlcjQ4MTM1NjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/48135649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nilstrieb", "html_url": "https://github.com/Nilstrieb", "followers_url": "https://api.github.com/users/Nilstrieb/followers", "following_url": "https://api.github.com/users/Nilstrieb/following{/other_user}", "gists_url": "https://api.github.com/users/Nilstrieb/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nilstrieb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nilstrieb/subscriptions", "organizations_url": "https://api.github.com/users/Nilstrieb/orgs", "repos_url": "https://api.github.com/users/Nilstrieb/repos", "events_url": "https://api.github.com/users/Nilstrieb/events{/privacy}", "received_events_url": "https://api.github.com/users/Nilstrieb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Nilstrieb", "id": 48135649, "node_id": "MDQ6VXNlcjQ4MTM1NjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/48135649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nilstrieb", "html_url": "https://github.com/Nilstrieb", "followers_url": "https://api.github.com/users/Nilstrieb/followers", "following_url": "https://api.github.com/users/Nilstrieb/following{/other_user}", "gists_url": "https://api.github.com/users/Nilstrieb/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nilstrieb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nilstrieb/subscriptions", "organizations_url": "https://api.github.com/users/Nilstrieb/orgs", "repos_url": "https://api.github.com/users/Nilstrieb/repos", "events_url": "https://api.github.com/users/Nilstrieb/events{/privacy}", "received_events_url": "https://api.github.com/users/Nilstrieb/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ff693dc7b8119a1761edf0d08156bb670708824a", "url": "https://api.github.com/repos/rust-lang/rust/commits/ff693dc7b8119a1761edf0d08156bb670708824a", "html_url": "https://github.com/rust-lang/rust/commit/ff693dc7b8119a1761edf0d08156bb670708824a"}], "stats": {"total": 12, "additions": 7, "deletions": 5}, "files": [{"sha": "a513722639adb13123f191b728ebc563291da5f6", "filename": "src/test/ui/process/process-spawn-nonexistent.rs", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/29cfefd35588535295d6d1f63b51e8a7cca0e738/src%2Ftest%2Fui%2Fprocess%2Fprocess-spawn-nonexistent.rs", "raw_url": "https://github.com/rust-lang/rust/raw/29cfefd35588535295d6d1f63b51e8a7cca0e738/src%2Ftest%2Fui%2Fprocess%2Fprocess-spawn-nonexistent.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fprocess%2Fprocess-spawn-nonexistent.rs?ref=29cfefd35588535295d6d1f63b51e8a7cca0e738", "patch": "@@ -6,9 +6,11 @@ use std::io::ErrorKind;\n use std::process::Command;\n \n fn main() {\n-    assert_eq!(Command::new(\"nonexistent\")\n-                   .spawn()\n-                   .unwrap_err()\n-                   .kind(),\n-               ErrorKind::NotFound);\n+    let result = Command::new(\"nonexistent\").spawn().unwrap_err().kind();\n+\n+    assert!(matches!(\n+        result,\n+        // Under WSL with appendWindowsPath=true, this fails with PermissionDenied\n+        ErrorKind::NotFound | ErrorKind::PermissionDenied\n+    ));\n }"}]}