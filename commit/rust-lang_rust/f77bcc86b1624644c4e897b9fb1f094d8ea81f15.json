{"sha": "f77bcc86b1624644c4e897b9fb1f094d8ea81f15", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY3N2JjYzg2YjE2MjQ2NDRjNGU4OTdiOWZiMWYwOTRkOGVhODFmMTU=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2016-07-18T23:25:11Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2016-07-19T05:32:59Z"}, "message": "rustc: Remove soft-float from MIPS targets\n\nRight now two MIPS targets in the compiler, `mips-unknown-linux-{gnu,musl}` both\ngenerate object files using the soft-float ABI through LLVM by default. This is\nalso expressed as the `-C soft-float` codegen option and otherwise isn't used\nfor any other target in the compiler. This option was added quite some time ago\n(back in #9617), and nowadays it's more appropriate to be done through a codegen\noption.\n\nThis is motivated by #34743 which necessitated an upgrade in the CMake\ninstallation on our bots which necessitated an upgrade in the Ubuntu version\nwhich invalidated the MIPS compilers we were using. The new MIPS compilers\n(coming from Debian I believe) all have hard float enabled by default and soft\nfloat support not built in. This meant that we couldn't upgrade the bots\nuntil #34841 landed because otherwise we would fail to compile C code as the\n`-msoft-float` option wouldn't work.\n\nUnfortunately, though, this means that once we upgrade the bots the C code we're\ncompiling will be compiled for hard float and the Rust code will be compiled\nfor soft float, a bad mismatch! This PR remedies the situation such that Rust\nwill compile with hard float as well.\n\nIf this lands it will likely produce broken nightlies for a day or two while we\nget around to upgrading the bots because the current C toolchain only produces\nsoft-float binaries, and now rust will be hard-float. Hopefully, though, the\nupgrade can go smoothly!", "tree": {"sha": "8f3d4742dbba5fb1ec942693096383b9cea07596", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8f3d4742dbba5fb1ec942693096383b9cea07596"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f77bcc86b1624644c4e897b9fb1f094d8ea81f15", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f77bcc86b1624644c4e897b9fb1f094d8ea81f15", "html_url": "https://github.com/rust-lang/rust/commit/f77bcc86b1624644c4e897b9fb1f094d8ea81f15", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f77bcc86b1624644c4e897b9fb1f094d8ea81f15/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "06ca016b6e779ba972efb9d1735afc527d301505", "url": "https://api.github.com/repos/rust-lang/rust/commits/06ca016b6e779ba972efb9d1735afc527d301505", "html_url": "https://github.com/rust-lang/rust/commit/06ca016b6e779ba972efb9d1735afc527d301505"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "ceb17e53a5552e41540b94e3d850f72d4d08b07c", "filename": "src/librustc_back/target/mips_unknown_linux_gnu.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f77bcc86b1624644c4e897b9fb1f094d8ea81f15/src%2Flibrustc_back%2Ftarget%2Fmips_unknown_linux_gnu.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f77bcc86b1624644c4e897b9fb1f094d8ea81f15/src%2Flibrustc_back%2Ftarget%2Fmips_unknown_linux_gnu.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fmips_unknown_linux_gnu.rs?ref=f77bcc86b1624644c4e897b9fb1f094d8ea81f15", "patch": "@@ -22,7 +22,7 @@ pub fn target() -> Target {\n         target_vendor: \"unknown\".to_string(),\n         options: TargetOptions {\n             cpu: \"mips32r2\".to_string(),\n-            features: \"+mips32r2,+soft-float\".to_string(),\n+            features: \"+mips32r2\".to_string(),\n             max_atomic_width: 32,\n             ..super::linux_base::opts()\n         },"}]}