{"sha": "f22a80890a5e7245afccef0ab7f7ccc45105df4d", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYyMmE4MDg5MGE1ZTcyNDVhZmNjZWYwYWI3ZjdjY2M0NTEwNWRmNGQ=", "commit": {"author": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2021-05-16T13:35:10Z"}, "committer": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2021-05-24T17:53:44Z"}, "message": "Use parse_target_triple in rustdoc", "tree": {"sha": "399a3dc6b8055fe591a9ca2a89ac86ce3d11d015", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/399a3dc6b8055fe591a9ca2a89ac86ce3d11d015"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f22a80890a5e7245afccef0ab7f7ccc45105df4d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f22a80890a5e7245afccef0ab7f7ccc45105df4d", "html_url": "https://github.com/rust-lang/rust/commit/f22a80890a5e7245afccef0ab7f7ccc45105df4d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f22a80890a5e7245afccef0ab7f7ccc45105df4d/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8260b8325ca820ab9dc6b224c0db0ca06f1c2b91", "url": "https://api.github.com/repos/rust-lang/rust/commits/8260b8325ca820ab9dc6b224c0db0ca06f1c2b91", "html_url": "https://github.com/rust-lang/rust/commit/8260b8325ca820ab9dc6b224c0db0ca06f1c2b91"}], "stats": {"total": 20, "additions": 9, "deletions": 11}, "files": [{"sha": "1c6fad2ae8e1cb66e29a3e7237fa1867d1d9fd7c", "filename": "compiler/rustc_session/src/config.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/f22a80890a5e7245afccef0ab7f7ccc45105df4d/compiler%2Frustc_session%2Fsrc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f22a80890a5e7245afccef0ab7f7ccc45105df4d/compiler%2Frustc_session%2Fsrc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_session%2Fsrc%2Fconfig.rs?ref=f22a80890a5e7245afccef0ab7f7ccc45105df4d", "patch": "@@ -1507,7 +1507,10 @@ fn collect_print_requests(\n     prints\n }\n \n-fn parse_target_triple(matches: &getopts::Matches, error_format: ErrorOutputType) -> TargetTriple {\n+pub fn parse_target_triple(\n+    matches: &getopts::Matches,\n+    error_format: ErrorOutputType,\n+) -> TargetTriple {\n     match matches.opt_str(\"target\") {\n         Some(target) if target.ends_with(\".json\") => {\n             let path = Path::new(&target);"}, {"sha": "6e1fdf67a652fc762d38221d7ef9e81944b4c6f0", "filename": "src/librustdoc/config.rs", "status": "modified", "additions": 5, "deletions": 10, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/f22a80890a5e7245afccef0ab7f7ccc45105df4d/src%2Flibrustdoc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f22a80890a5e7245afccef0ab7f7ccc45105df4d/src%2Flibrustdoc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fconfig.rs?ref=f22a80890a5e7245afccef0ab7f7ccc45105df4d", "patch": "@@ -6,8 +6,10 @@ use std::path::PathBuf;\n use std::str::FromStr;\n \n use rustc_data_structures::fx::FxHashMap;\n-use rustc_session::config::{self, parse_crate_types_from_list, parse_externs, CrateType};\n-use rustc_session::config::{get_cmd_lint_options, host_triple, nightly_options};\n+use rustc_session::config::{\n+    self, parse_crate_types_from_list, parse_externs, parse_target_triple, CrateType,\n+};\n+use rustc_session::config::{get_cmd_lint_options, nightly_options};\n use rustc_session::config::{CodegenOptions, DebuggingOptions, ErrorOutputType, Externs};\n use rustc_session::getopts;\n use rustc_session::lint::Level;\n@@ -562,14 +564,7 @@ impl Options {\n             }\n         }\n \n-        let target =\n-            matches.opt_str(\"target\").map_or(TargetTriple::from_triple(host_triple()), |target| {\n-                if target.ends_with(\".json\") {\n-                    TargetTriple::from_path(Path::new(&target))\n-                } else {\n-                    TargetTriple::TargetTriple(target)\n-                }\n-            });\n+        let target = parse_target_triple(matches, error_format);\n \n         let show_coverage = matches.opt_present(\"show-coverage\");\n "}]}