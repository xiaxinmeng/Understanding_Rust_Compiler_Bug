{"sha": "083c2f6ceb82b75ec04c73f2b39a414985fd9a92", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA4M2MyZjZjZWI4MmI3NWVjMDRjNzNmMmIzOWE0MTQ5ODVmZDlhOTI=", "commit": {"author": {"name": "David Wood", "email": "david@davidtw.co", "date": "2020-07-12T17:22:09Z"}, "committer": {"name": "David Wood", "email": "david@davidtw.co", "date": "2020-07-12T17:22:09Z"}, "message": "pprust: support multiline comments within lines\n\nThis commit adds support to rustc_ast_pretty for multiline comments that\nstart and end within a line of source code.\n\nSigned-off-by: David Wood <david@davidtw.co>", "tree": {"sha": "1f2ba135e6e8d06cf2f2a4687f537aeb2604d3a5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1f2ba135e6e8d06cf2f2a4687f537aeb2604d3a5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/083c2f6ceb82b75ec04c73f2b39a414985fd9a92", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEfgm2/wUjk9OnjxlyJZLnbIc4H9kFAl8LRsYACgkQJZLnbIc4\nH9lEYw/+MWcxk40Tt0S45Ha2jiKRb4m1LlFNRQZbp0VmfHrPKVz5+S456E0Um/9r\n1eQjJhqlBdBl25kWA9RpoODRSGgoXte5ZRWUU5bAUtE7dHjWkIPGXN5V81T4Q1D1\nJ6AjopBNaloejmNriHYors7sWPVov8sO+0TdZi4EKbhHQrFrYTxHX5l9pXJaoUVm\nWj9+UstXh8iAb+HizqOmHUiprXNTVm+z643bGzFF+hbZVYKTIyoDUYY1vcwHUDV5\nRN6YxfU022+siqKIDKbKAmte75Sy0gfGQDxq3iD7+ppfAUtDUhGtfVLwG0mcSrm8\nV/YCZkohUASZHgxrhMdZPG1el3avbiMY9yf80nA7cGYR/ksE4llS+nuGRfHiuP67\npSZglGeZzMp8ByaBOLh2oDherqE/1qPFM6d5QJBIBT5YAhzwTl7OZqdYXkaWFDjR\nQmfkqkNHAHloFHGdXZORqQ+9UmZgFrW5l2hRYKTBYRuWYrF5w8lJmp/CFOsexlL5\njb0IPZjzlnZeKJG9/5yZbmo7KY1f1W9UdW/+hmpOUOo+Wu0+8Cxg6BGWwf0JzJzU\nKfDavZko6SOP1UW63JCPJ2xU6MPLs7e9p0GPPJLB5gUU74B+R9fk4e5qNkqmUmH0\nTbVF4pMFfVWdX7yn2bXgurFhfJ0FD6IfKN/FRYlXfrNkslBM6/Q=\n=1ogJ\n-----END PGP SIGNATURE-----", "payload": "tree 1f2ba135e6e8d06cf2f2a4687f537aeb2604d3a5\nparent 346aec9b02f3c74f3fce97fd6bda24709d220e49\nauthor David Wood <david@davidtw.co> 1594574529 +0100\ncommitter David Wood <david@davidtw.co> 1594574529 +0100\n\npprust: support multiline comments within lines\n\nThis commit adds support to rustc_ast_pretty for multiline comments that\nstart and end within a line of source code.\n\nSigned-off-by: David Wood <david@davidtw.co>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/083c2f6ceb82b75ec04c73f2b39a414985fd9a92", "html_url": "https://github.com/rust-lang/rust/commit/083c2f6ceb82b75ec04c73f2b39a414985fd9a92", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/083c2f6ceb82b75ec04c73f2b39a414985fd9a92/comments", "author": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "346aec9b02f3c74f3fce97fd6bda24709d220e49", "url": "https://api.github.com/repos/rust-lang/rust/commits/346aec9b02f3c74f3fce97fd6bda24709d220e49", "html_url": "https://github.com/rust-lang/rust/commit/346aec9b02f3c74f3fce97fd6bda24709d220e49"}], "stats": {"total": 49, "additions": 47, "deletions": 2}, "files": [{"sha": "c33cae57872ac2bfd0c62c25a97b9c1aa1a62c6b", "filename": "src/librustc_ast_pretty/pprust.rs", "status": "modified", "additions": 13, "deletions": 2, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/083c2f6ceb82b75ec04c73f2b39a414985fd9a92/src%2Flibrustc_ast_pretty%2Fpprust.rs", "raw_url": "https://github.com/rust-lang/rust/raw/083c2f6ceb82b75ec04c73f2b39a414985fd9a92/src%2Flibrustc_ast_pretty%2Fpprust.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_ast_pretty%2Fpprust.rs?ref=083c2f6ceb82b75ec04c73f2b39a414985fd9a92", "patch": "@@ -450,9 +450,20 @@ pub trait PrintState<'a>: std::ops::Deref<Target = pp::Printer> + std::ops::Dere\n     fn print_comment(&mut self, cmnt: &comments::Comment) {\n         match cmnt.style {\n             comments::Mixed => {\n-                assert_eq!(cmnt.lines.len(), 1);\n                 self.zerobreak();\n-                self.word(cmnt.lines[0].clone());\n+                if let Some((last, lines)) = cmnt.lines.split_last() {\n+                    self.ibox(0);\n+\n+                    for line in lines {\n+                        self.word(line.clone());\n+                        self.hardbreak()\n+                    }\n+\n+                    self.word(last.clone());\n+                    self.space();\n+\n+                    self.end();\n+                }\n                 self.zerobreak()\n             }\n             comments::Isolated => {"}, {"sha": "a002f09be3b4eb89e2e498215d95eceb52e0872b", "filename": "src/test/pretty/issue-73626.rs", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/083c2f6ceb82b75ec04c73f2b39a414985fd9a92/src%2Ftest%2Fpretty%2Fissue-73626.rs", "raw_url": "https://github.com/rust-lang/rust/raw/083c2f6ceb82b75ec04c73f2b39a414985fd9a92/src%2Ftest%2Fpretty%2Fissue-73626.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fpretty%2Fissue-73626.rs?ref=083c2f6ceb82b75ec04c73f2b39a414985fd9a92", "patch": "@@ -0,0 +1,34 @@\n+fn main(/*\n+    ---\n+*/) {\n+    let x /* this is one line */ = 3;\n+\n+    let x /*\n+           * this\n+           * is\n+           * multiple\n+           * lines\n+           */ = 3;\n+\n+    let x = /*\n+           * this\n+           * is\n+           * multiple\n+           * lines\n+           * after\n+           * the\n+           * =\n+           */ 3;\n+\n+    let x /*\n+           * this\n+           * is\n+           * multiple\n+           * lines\n+           * including\n+           * a\n+\n+           * blank\n+           * line\n+           */ = 3;\n+}"}]}