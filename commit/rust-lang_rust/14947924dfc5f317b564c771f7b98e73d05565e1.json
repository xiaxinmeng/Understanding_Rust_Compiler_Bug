{"sha": "14947924dfc5f317b564c771f7b98e73d05565e1", "node_id": "C_kwDOAAsO6NoAKDE0OTQ3OTI0ZGZjNWYzMTdiNTY0Yzc3MWY3Yjk4ZTczZDA1NTY1ZTE", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-06-09T04:33:01Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-06-09T04:33:01Z"}, "message": "Auto merge of #97772 - GuillaumeGomez:minifier-update, r=notriddle\n\nUpdate minifier version to 0.2.1\n\nThis change and these changes come from an idea of `@camelid:` instead of creating a string, we just `write` the type into the file directly.\n\nI don't think it'll have a big impact on perf but it's still a potential small improvement.\n\nr? `@notriddle`", "tree": {"sha": "c38cbc8a1679ef5ff5c6c1de047558e58e800b6a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c38cbc8a1679ef5ff5c6c1de047558e58e800b6a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/14947924dfc5f317b564c771f7b98e73d05565e1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/14947924dfc5f317b564c771f7b98e73d05565e1", "html_url": "https://github.com/rust-lang/rust/commit/14947924dfc5f317b564c771f7b98e73d05565e1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/14947924dfc5f317b564c771f7b98e73d05565e1/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "282445a288b3c409a998eb72e51827537e81abd3", "url": "https://api.github.com/repos/rust-lang/rust/commits/282445a288b3c409a998eb72e51827537e81abd3", "html_url": "https://github.com/rust-lang/rust/commit/282445a288b3c409a998eb72e51827537e81abd3"}, {"sha": "edd26add3b20ad399c7e53f245b5e12e3e1bac70", "url": "https://api.github.com/repos/rust-lang/rust/commits/edd26add3b20ad399c7e53f245b5e12e3e1bac70", "html_url": "https://github.com/rust-lang/rust/commit/edd26add3b20ad399c7e53f245b5e12e3e1bac70"}], "stats": {"total": 19, "additions": 11, "deletions": 8}, "files": [{"sha": "72fa97d1f77e35944b837e955573b937541e5ef3", "filename": "Cargo.lock", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/14947924dfc5f317b564c771f7b98e73d05565e1/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/14947924dfc5f317b564c771f7b98e73d05565e1/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=14947924dfc5f317b564c771f7b98e73d05565e1", "patch": "@@ -2394,9 +2394,9 @@ dependencies = [\n \n [[package]]\n name = \"minifier\"\n-version = \"0.1.0\"\n+version = \"0.2.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"7071d17e2898e134cabf624f43cdefa0cedf57c739e964df3d0df9d028701a72\"\n+checksum = \"ac96d1e7a65f206443f95afff6de8f1690c77c97d6fc9c9bb2d2cd0662e9ff9f\"\n \n [[package]]\n name = \"minimal-lexical\""}, {"sha": "78470e8deb342567c5251285498a572f7a56f7bd", "filename": "src/librustdoc/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/14947924dfc5f317b564c771f7b98e73d05565e1/src%2Flibrustdoc%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/14947924dfc5f317b564c771f7b98e73d05565e1/src%2Flibrustdoc%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2FCargo.toml?ref=14947924dfc5f317b564c771f7b98e73d05565e1", "patch": "@@ -11,7 +11,7 @@ arrayvec = { version = \"0.7\", default-features = false }\n askama = { version = \"0.11\", default-features = false, features = [\"config\"] }\n atty = \"0.2\"\n pulldown-cmark = { version = \"0.9\", default-features = false }\n-minifier = \"0.1.0\"\n+minifier = \"0.2.1\"\n serde = { version = \"1.0\", features = [\"derive\"] }\n serde_json = \"1.0\"\n smallvec = \"1.6.1\""}, {"sha": "8f08ff2ece3f661f46476866b70ec8697ef00d76", "filename": "src/librustdoc/html/render/write_shared.rs", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/14947924dfc5f317b564c771f7b98e73d05565e1/src%2Flibrustdoc%2Fhtml%2Frender%2Fwrite_shared.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14947924dfc5f317b564c771f7b98e73d05565e1/src%2Flibrustdoc%2Fhtml%2Frender%2Fwrite_shared.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fwrite_shared.rs?ref=14947924dfc5f317b564c771f7b98e73d05565e1", "patch": "@@ -122,11 +122,13 @@ impl Context<'_> {\n         if minify {\n             let contents = contents.as_ref();\n             let contents = if resource.extension() == Some(OsStr::new(\"css\")) {\n-                minifier::css::minify(contents).map_err(|e| {\n-                    Error::new(format!(\"failed to minify CSS file: {}\", e), resource.path(self))\n-                })?\n+                minifier::css::minify(contents)\n+                    .map_err(|e| {\n+                        Error::new(format!(\"failed to minify CSS file: {}\", e), resource.path(self))\n+                    })?\n+                    .to_string()\n             } else {\n-                minifier::js::minify(contents)\n+                minifier::js::minify(contents).to_string()\n             };\n             self.write_shared(resource, contents, emit)\n         } else {"}, {"sha": "0118d7dd20722146e8c6092de9702d94251550eb", "filename": "src/librustdoc/theme.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/14947924dfc5f317b564c771f7b98e73d05565e1/src%2Flibrustdoc%2Ftheme.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14947924dfc5f317b564c771f7b98e73d05565e1/src%2Flibrustdoc%2Ftheme.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Ftheme.rs?ref=14947924dfc5f317b564c771f7b98e73d05565e1", "patch": "@@ -185,6 +185,7 @@ fn build_rule(v: &[u8], positions: &[usize]) -> String {\n             .intersperse(\" \")\n             .collect::<String>(),\n     )\n+    .map(|css| css.to_string())\n     .unwrap_or_else(|_| String::new())\n }\n "}, {"sha": "ae8f43c6d55bab036b6a2a3e24abffd607c48a53", "filename": "src/librustdoc/theme/tests.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/14947924dfc5f317b564c771f7b98e73d05565e1/src%2Flibrustdoc%2Ftheme%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14947924dfc5f317b564c771f7b98e73d05565e1/src%2Flibrustdoc%2Ftheme%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Ftheme%2Ftests.rs?ref=14947924dfc5f317b564c771f7b98e73d05565e1", "patch": "@@ -106,7 +106,7 @@ fn check_invalid_css() {\n #[test]\n fn test_with_minification() {\n     let text = include_str!(\"../html/static/css/themes/dark.css\");\n-    let minified = minifier::css::minify(&text).expect(\"CSS minification failed\");\n+    let minified = minifier::css::minify(&text).expect(\"CSS minification failed\").to_string();\n \n     let against = load_css_paths(text.as_bytes());\n     let other = load_css_paths(minified.as_bytes());"}]}