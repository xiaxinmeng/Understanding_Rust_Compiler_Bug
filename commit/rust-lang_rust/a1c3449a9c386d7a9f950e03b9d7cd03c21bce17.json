{"sha": "a1c3449a9c386d7a9f950e03b9d7cd03c21bce17", "node_id": "MDY6Q29tbWl0NzI0NzEyOmExYzM0NDlhOWMzODZkN2E5Zjk1MGUwM2I5ZDdjZDAzYzIxYmNlMTc=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2018-01-21T22:11:39Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-01-21T22:11:39Z"}, "message": "Rollup merge of #47512 - GuillaumeGomez:e0659, r=petrochenkov\n\nAdd E0659 for ambiguous names\n\nStill on the tracks of the \"no error without error code\" road.", "tree": {"sha": "e516820c3a781237ce71a6b4399ac7f945216921", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e516820c3a781237ce71a6b4399ac7f945216921"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17", "html_url": "https://github.com/rust-lang/rust/commit/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ab54a9c73c0bdb7df9693598c9e18840fccac6e1", "url": "https://api.github.com/repos/rust-lang/rust/commits/ab54a9c73c0bdb7df9693598c9e18840fccac6e1", "html_url": "https://github.com/rust-lang/rust/commit/ab54a9c73c0bdb7df9693598c9e18840fccac6e1"}, {"sha": "f66e711f8b7a62ff76bbf29df0dc21eac8000501", "url": "https://api.github.com/repos/rust-lang/rust/commits/f66e711f8b7a62ff76bbf29df0dc21eac8000501", "html_url": "https://github.com/rust-lang/rust/commit/f66e711f8b7a62ff76bbf29df0dc21eac8000501"}], "stats": {"total": 103, "additions": 91, "deletions": 12}, "files": [{"sha": "8a29155d12d5b749303ce20e5b10842ad41c5105", "filename": "src/librustc_resolve/diagnostics.rs", "status": "modified", "additions": 53, "deletions": 0, "changes": 53, "blob_url": "https://github.com/rust-lang/rust/blob/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17/src%2Flibrustc_resolve%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17/src%2Flibrustc_resolve%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Fdiagnostics.rs?ref=a1c3449a9c386d7a9f950e03b9d7cd03c21bce17", "patch": "@@ -1621,6 +1621,59 @@ println!(\"const value: {}\", SomeModule::PRIVATE); // ok!\n ```\n \"##,\n \n+E0659: r##\"\n+An item usage is ambiguous.\n+\n+Erroneous code example:\n+\n+```compile_fail,E0659\n+pub mod moon {\n+    pub fn foo() {}\n+}\n+\n+pub mod earth {\n+    pub fn foo() {}\n+}\n+\n+mod collider {\n+    pub use moon::*;\n+    pub use earth::*;\n+}\n+\n+fn main() {\n+    collider::foo(); // ERROR: `foo` is ambiguous\n+}\n+```\n+\n+This error generally appears when two items with the same name are imported into\n+a module. Here, the `foo` functions are imported and reexported from the\n+`collider` module and therefore, when we're using `collider::foo()`, both\n+functions collide.\n+\n+To solve this error, the best solution is generally to keep the path before the\n+item when using it. Example:\n+\n+```\n+pub mod moon {\n+    pub fn foo() {}\n+}\n+\n+pub mod earth {\n+    pub fn foo() {}\n+}\n+\n+mod collider {\n+    pub use moon;\n+    pub use earth;\n+}\n+\n+fn main() {\n+    collider::moon::foo(); // ok!\n+    collider::earth::foo(); // ok!\n+}\n+```\n+\"##,\n+\n }\n \n register_diagnostics! {"}, {"sha": "d9ae776a4d7b26a9b499578b8714813a50edbe25", "filename": "src/librustc_resolve/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17/src%2Flibrustc_resolve%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17/src%2Flibrustc_resolve%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Flib.rs?ref=a1c3449a9c386d7a9f950e03b9d7cd03c21bce17", "patch": "@@ -3802,7 +3802,7 @@ impl<'a> Resolver<'a> {\n                 self.session.buffer_lint(lint::builtin::LEGACY_IMPORTS, id, span, &msg);\n             } else {\n                 let mut err =\n-                    self.session.struct_span_err(span, &format!(\"`{}` is ambiguous\", name));\n+                    struct_span_err!(self.session, span, E0659, \"`{}` is ambiguous\", name);\n                 err.span_note(b1.span, &msg1);\n                 match b2.def() {\n                     Def::Macro(..) if b2.span == DUMMY_SP =>"}, {"sha": "4bd452b0aac3d50d93320392d9a4ebd7413af5ba", "filename": "src/test/compile-fail/E0659.rs", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17/src%2Ftest%2Fcompile-fail%2FE0659.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17/src%2Ftest%2Fcompile-fail%2FE0659.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2FE0659.rs?ref=a1c3449a9c386d7a9f950e03b9d7cd03c21bce17", "patch": "@@ -0,0 +1,26 @@\n+// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+mod moon {\n+    pub fn foo() {}\n+}\n+\n+mod earth {\n+    pub fn foo() {}\n+}\n+\n+mod collider {\n+    pub use moon::*;\n+    pub use earth::*;\n+}\n+\n+fn main() {\n+    collider::foo(); //~ ERROR E0659\n+}"}, {"sha": "a74401314a18cb3698e6ac419087d5872bcbd23e", "filename": "src/test/ui/imports/duplicate.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17/src%2Ftest%2Fui%2Fimports%2Fduplicate.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17/src%2Ftest%2Fui%2Fimports%2Fduplicate.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimports%2Fduplicate.stderr?ref=a1c3449a9c386d7a9f950e03b9d7cd03c21bce17", "patch": "@@ -12,7 +12,7 @@ help: You can use `as` to change the binding name of the import\n 25 |     use a::foo as Otherfoo; //~ ERROR the name `foo` is defined multiple times\n    |         ^^^^^^^^^^^^^^^^^^\n \n-error: `foo` is ambiguous\n+error[E0659]: `foo` is ambiguous\n   --> $DIR/duplicate.rs:56:9\n    |\n 56 |     use self::foo::bar; //~ ERROR `foo` is ambiguous\n@@ -30,7 +30,7 @@ note: `foo` could also refer to the name imported here\n    |         ^^^^^^^^^^^\n    = note: consider adding an explicit import of `foo` to disambiguate\n \n-error: `foo` is ambiguous\n+error[E0659]: `foo` is ambiguous\n   --> $DIR/duplicate.rs:45:5\n    |\n 45 |     f::foo(); //~ ERROR `foo` is ambiguous\n@@ -48,7 +48,7 @@ note: `foo` could also refer to the name imported here\n    |             ^^^^\n    = note: consider adding an explicit import of `foo` to disambiguate\n \n-error: `foo` is ambiguous\n+error[E0659]: `foo` is ambiguous\n   --> $DIR/duplicate.rs:46:5\n    |\n 46 |     g::foo(); //~ ERROR `foo` is ambiguous\n@@ -66,7 +66,7 @@ note: `foo` could also refer to the name imported here\n    |             ^^^^\n    = note: consider adding an explicit import of `foo` to disambiguate\n \n-error: `foo` is ambiguous\n+error[E0659]: `foo` is ambiguous\n   --> $DIR/duplicate.rs:59:9\n    |\n 59 |         foo::bar(); //~ ERROR `foo` is ambiguous"}, {"sha": "32d78666004c422196b5e60c1f9ba69692753b2b", "filename": "src/test/ui/imports/macro-paths.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17/src%2Ftest%2Fui%2Fimports%2Fmacro-paths.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17/src%2Ftest%2Fui%2Fimports%2Fmacro-paths.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimports%2Fmacro-paths.stderr?ref=a1c3449a9c386d7a9f950e03b9d7cd03c21bce17", "patch": "@@ -1,4 +1,4 @@\n-error: `bar` is ambiguous\n+error[E0659]: `bar` is ambiguous\n   --> $DIR/macro-paths.rs:25:5\n    |\n 25 |     bar::m! { //~ ERROR ambiguous\n@@ -16,7 +16,7 @@ note: `bar` could also refer to the name imported here\n    |         ^^^^^^\n    = note: macro-expanded items do not shadow when used in a macro invocation path\n \n-error: `baz` is ambiguous\n+error[E0659]: `baz` is ambiguous\n   --> $DIR/macro-paths.rs:35:5\n    |\n 35 |     baz::m! { //~ ERROR ambiguous"}, {"sha": "75294f7bf1256391a89fcb3fc3d709fd9e5f24e8", "filename": "src/test/ui/imports/macros.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17/src%2Ftest%2Fui%2Fimports%2Fmacros.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17/src%2Ftest%2Fui%2Fimports%2Fmacros.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimports%2Fmacros.stderr?ref=a1c3449a9c386d7a9f950e03b9d7cd03c21bce17", "patch": "@@ -15,7 +15,7 @@ note: `m` could also refer to the macro imported here\n 49 |     use two_macros::m;\n    |         ^^^^^^^^^^^^^\n \n-error: `m` is ambiguous\n+error[E0659]: `m` is ambiguous\n   --> $DIR/macros.rs:28:5\n    |\n 28 |     m! { //~ ERROR ambiguous\n@@ -33,7 +33,7 @@ note: `m` could also refer to the name imported here\n    |         ^^^^^^^^^^^^^\n    = note: macro-expanded macro imports do not shadow\n \n-error: `m` is ambiguous\n+error[E0659]: `m` is ambiguous\n   --> $DIR/macros.rs:41:9\n    |\n 41 |         m! { //~ ERROR ambiguous"}, {"sha": "8f4325fa12c72576aa5155ddf414e358e122e266", "filename": "src/test/ui/imports/shadow_builtin_macros.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17/src%2Ftest%2Fui%2Fimports%2Fshadow_builtin_macros.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a1c3449a9c386d7a9f950e03b9d7cd03c21bce17/src%2Ftest%2Fui%2Fimports%2Fshadow_builtin_macros.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimports%2Fshadow_builtin_macros.stderr?ref=a1c3449a9c386d7a9f950e03b9d7cd03c21bce17", "patch": "@@ -9,7 +9,7 @@ error: `panic` is already in scope\n    |\n    = note: macro-expanded `macro_rules!`s may not shadow existing macros (see RFC 1560)\n \n-error: `panic` is ambiguous\n+error[E0659]: `panic` is ambiguous\n   --> $DIR/shadow_builtin_macros.rs:27:14\n    |\n 27 |     fn f() { panic!(); } //~ ERROR ambiguous\n@@ -23,7 +23,7 @@ note: `panic` could refer to the name imported here\n    = note: `panic` is also a builtin macro\n    = note: consider adding an explicit import of `panic` to disambiguate\n \n-error: `panic` is ambiguous\n+error[E0659]: `panic` is ambiguous\n   --> $DIR/shadow_builtin_macros.rs:32:14\n    |\n 32 |     fn f() { panic!(); } //~ ERROR ambiguous\n@@ -37,7 +37,7 @@ note: `panic` could refer to the name imported here\n    = note: `panic` is also a builtin macro\n    = note: macro-expanded macro imports do not shadow\n \n-error: `n` is ambiguous\n+error[E0659]: `n` is ambiguous\n   --> $DIR/shadow_builtin_macros.rs:61:5\n    |\n 61 |     n!(); //~ ERROR ambiguous"}]}