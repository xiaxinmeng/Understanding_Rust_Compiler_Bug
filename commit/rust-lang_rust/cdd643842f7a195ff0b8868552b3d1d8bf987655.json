{"sha": "cdd643842f7a195ff0b8868552b3d1d8bf987655", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNkZDY0Mzg0MmY3YTE5NWZmMGI4ODY4NTUyYjNkMWQ4YmY5ODc2NTU=", "commit": {"author": {"name": "Oliver Schneider", "email": "oli-obk@users.noreply.github.com", "date": "2018-01-18T13:46:36Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-01-18T13:46:36Z"}, "message": "Merge pull request #2375 from rust-lang-nursery/needless-range\n\nVarious needless_pass_by_value false positive fixes", "tree": {"sha": "01caa7b16655fced3f9f58eeac255e95c483297a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/01caa7b16655fced3f9f58eeac255e95c483297a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cdd643842f7a195ff0b8868552b3d1d8bf987655", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJaYKU8CRBK7hj4Ov3rIwAAdHIIAKt4cIxRXC96J4qI5SPyyG5c\nD9NOw1zDvqLNWTw62jCk/ujXEtVvYFePGRpSWISKX0IAmrfTQyMwwfINqo2EwrNp\nHivPQWLiNiVIOEs5kF3FiizIsZ0gy9Jpg9bdZ6gaKUC8YUnt+JLxehTE6QEartC0\n2AobuOzkLFkAf/yrmUf/GpqWR9qRF63qUpywaFmDUMlbR7uQfiTGuIo1B2YPTrp5\nJwsqgr97iiJyGm4+/kKx8llBXZfPmqoNx4JmvVwc6f8oTrD+nRpufb7T+nxDBRXo\nuhlv+L9/HTlNigcHGC9guQRfmBxB7FqVBF8+plPEhkAQof4vwq6X1Z9PlXZOmAU=\n=kXii\n-----END PGP SIGNATURE-----\n", "payload": "tree 01caa7b16655fced3f9f58eeac255e95c483297a\nparent 9a5f25aab3976f73f4a092295da626b30e3c7445\nparent 8217e33718402111d871551e8608bd6f7868a9a4\nauthor Oliver Schneider <oli-obk@users.noreply.github.com> 1516283196 +0100\ncommitter GitHub <noreply@github.com> 1516283196 +0100\n\nMerge pull request #2375 from rust-lang-nursery/needless-range\n\nVarious needless_pass_by_value false positive fixes"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cdd643842f7a195ff0b8868552b3d1d8bf987655", "html_url": "https://github.com/rust-lang/rust/commit/cdd643842f7a195ff0b8868552b3d1d8bf987655", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cdd643842f7a195ff0b8868552b3d1d8bf987655/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9a5f25aab3976f73f4a092295da626b30e3c7445", "url": "https://api.github.com/repos/rust-lang/rust/commits/9a5f25aab3976f73f4a092295da626b30e3c7445", "html_url": "https://github.com/rust-lang/rust/commit/9a5f25aab3976f73f4a092295da626b30e3c7445"}, {"sha": "8217e33718402111d871551e8608bd6f7868a9a4", "url": "https://api.github.com/repos/rust-lang/rust/commits/8217e33718402111d871551e8608bd6f7868a9a4", "html_url": "https://github.com/rust-lang/rust/commit/8217e33718402111d871551e8608bd6f7868a9a4"}], "stats": {"total": 208, "additions": 156, "deletions": 52}, "files": [{"sha": "21a7542e6c766a65a10459d12d819673ded75605", "filename": "clippy_lints/src/needless_pass_by_value.rs", "status": "modified", "additions": 25, "deletions": 9, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/cdd643842f7a195ff0b8868552b3d1d8bf987655/clippy_lints%2Fsrc%2Fneedless_pass_by_value.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cdd643842f7a195ff0b8868552b3d1d8bf987655/clippy_lints%2Fsrc%2Fneedless_pass_by_value.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fneedless_pass_by_value.rs?ref=cdd643842f7a195ff0b8868552b3d1d8bf987655", "patch": "@@ -6,6 +6,7 @@ use rustc::ty::{self, RegionKind, TypeFoldable};\n use rustc::traits;\n use rustc::middle::expr_use_visitor as euv;\n use rustc::middle::mem_categorization as mc;\n+use syntax::abi::Abi;\n use syntax::ast::NodeId;\n use syntax_pos::Span;\n use syntax::errors::DiagnosticBuilder;\n@@ -71,13 +72,18 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for NeedlessPassByValue {\n         }\n \n         match kind {\n-            FnKind::ItemFn(.., attrs) => for a in attrs {\n-                if_chain! {\n-                    if a.meta_item_list().is_some();\n-                    if let Some(name) = a.name();\n-                    if name == \"proc_macro_derive\";\n-                    then {\n-                        return;\n+            FnKind::ItemFn(.., abi, _, attrs) => {\n+                if abi != Abi::Rust {\n+                    return;\n+                }\n+                for a in attrs {\n+                    if_chain! {\n+                        if a.meta_item_list().is_some();\n+                        if let Some(name) = a.name();\n+                        if name == \"proc_macro_derive\";\n+                        then {\n+                            return;\n+                        }\n                     }\n                 }\n             },\n@@ -96,10 +102,11 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for NeedlessPassByValue {\n \n         // Allow `Borrow` or functions to be taken by value\n         let borrow_trait = need!(get_trait_def_id(cx, &paths::BORROW_TRAIT));\n-        let fn_traits = [\n+        let whitelisted_traits = [\n             need!(cx.tcx.lang_items().fn_trait()),\n             need!(cx.tcx.lang_items().fn_once_trait()),\n             need!(cx.tcx.lang_items().fn_mut_trait()),\n+            need!(get_trait_def_id(cx, &paths::RANGE_ARGUMENT_TRAIT))\n         ];\n \n         let sized_trait = need!(cx.tcx.lang_items().sized_trait());\n@@ -183,7 +190,7 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for NeedlessPassByValue {\n                 if !is_self(arg);\n                 if !ty.is_mutable_pointer();\n                 if !is_copy(cx, ty);\n-                if !fn_traits.iter().any(|&t| implements_trait(cx, ty, t, &[]));\n+                if !whitelisted_traits.iter().any(|&t| implements_trait(cx, ty, t, &[]));\n                 if !implements_borrow_trait;\n                 if !all_borrowable_trait;\n \n@@ -196,6 +203,15 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for NeedlessPassByValue {\n \n                     // Dereference suggestion\n                     let sugg = |db: &mut DiagnosticBuilder| {\n+                        if let ty::TypeVariants::TyAdt(ref def, ..) = ty.sty {\n+                            if let Some(span) = cx.tcx.hir.span_if_local(def.did) {\n+                                let param_env = ty::ParamEnv::empty(traits::Reveal::UserFacing);\n+                                if param_env.can_type_implement_copy(cx.tcx, ty, span).is_ok() {\n+                                    db.span_help(span, \"consider marking this type as Copy\");\n+                                }\n+                            }\n+                        }\n+\n                         let deref_span = spans_need_deref.get(&canonical_id);\n                         if_chain! {\n                             if match_type(cx, ty, &paths::VEC);"}, {"sha": "20244a19f4f08d9080c62eaf43c15329eda54687", "filename": "clippy_lints/src/utils/paths.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/cdd643842f7a195ff0b8868552b3d1d8bf987655/clippy_lints%2Fsrc%2Futils%2Fpaths.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cdd643842f7a195ff0b8868552b3d1d8bf987655/clippy_lints%2Fsrc%2Futils%2Fpaths.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Fpaths.rs?ref=cdd643842f7a195ff0b8868552b3d1d8bf987655", "patch": "@@ -55,6 +55,7 @@ pub const OPTION_SOME: [&str; 4] = [\"core\", \"option\", \"Option\", \"Some\"];\n pub const PTR_NULL: [&str; 2] = [\"ptr\", \"null\"];\n pub const PTR_NULL_MUT: [&str; 2] = [\"ptr\", \"null_mut\"];\n pub const RANGE: [&str; 3] = [\"core\", \"ops\", \"Range\"];\n+pub const RANGE_ARGUMENT_TRAIT: [&str; 3] = [\"alloc\", \"range\", \"RangeArgument\"];\n pub const RANGE_FROM: [&str; 3] = [\"core\", \"ops\", \"RangeFrom\"];\n pub const RANGE_FROM_STD: [&str; 3] = [\"std\", \"ops\", \"RangeFrom\"];\n pub const RANGE_FULL: [&str; 3] = [\"core\", \"ops\", \"RangeFull\"];"}, {"sha": "6e87fcc7b44f85f062df63e0b94b8b88253c00d0", "filename": "tests/ui/needless_pass_by_value.rs", "status": "modified", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/cdd643842f7a195ff0b8868552b3d1d8bf987655/tests%2Fui%2Fneedless_pass_by_value.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cdd643842f7a195ff0b8868552b3d1d8bf987655/tests%2Fui%2Fneedless_pass_by_value.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fneedless_pass_by_value.rs?ref=cdd643842f7a195ff0b8868552b3d1d8bf987655", "patch": "@@ -4,6 +4,8 @@\n #![warn(needless_pass_by_value)]\n #![allow(dead_code, single_match, if_let_redundant_pattern_matching, many_single_char_names)]\n \n+#![feature(collections_range)]\n+\n use std::borrow::Borrow;\n use std::convert::AsRef;\n \n@@ -110,4 +112,29 @@ trait FalsePositive {\n     }\n }\n \n+// shouldn't warn on extern funcs\n+extern \"C\" fn ext(x: String) -> usize { x.len() }\n+\n+// whitelist RangeArgument\n+fn range<T: ::std::collections::range::RangeArgument<usize>>(range: T) {\n+    let _ = range.start();\n+}\n+\n+struct CopyWrapper(u32);\n+\n+fn bar_copy(x: u32, y: CopyWrapper) {\n+    assert_eq!(x, 42);\n+    assert_eq!(y.0, 42);\n+}\n+\n+// x and y should be warned, but z is ok\n+fn test_destructure_copy(x: CopyWrapper, y: CopyWrapper, z: CopyWrapper) {\n+    let CopyWrapper(s) = z; // moved\n+    let CopyWrapper(ref t) = y; // not moved\n+    let CopyWrapper(_) = y; // still not moved\n+\n+    assert_eq!(x.0, s);\n+    println!(\"{}\", t);\n+}\n+\n fn main() {}"}, {"sha": "469c16fa3d5bf080b4bf9d242049b3fcd6502759", "filename": "tests/ui/needless_pass_by_value.stderr", "status": "modified", "additions": 103, "deletions": 43, "changes": 146, "blob_url": "https://github.com/rust-lang/rust/blob/cdd643842f7a195ff0b8868552b3d1d8bf987655/tests%2Fui%2Fneedless_pass_by_value.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cdd643842f7a195ff0b8868552b3d1d8bf987655/tests%2Fui%2Fneedless_pass_by_value.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fneedless_pass_by_value.stderr?ref=cdd643842f7a195ff0b8868552b3d1d8bf987655", "patch": "@@ -1,128 +1,188 @@\n error: this argument is passed by value, but not consumed in the function body\n-  --> $DIR/needless_pass_by_value.rs:12:23\n+  --> $DIR/needless_pass_by_value.rs:14:23\n    |\n-12 | fn foo<T: Default>(v: Vec<T>, w: Vec<T>, mut x: Vec<T>, y: Vec<T>) -> Vec<T> {\n+14 | fn foo<T: Default>(v: Vec<T>, w: Vec<T>, mut x: Vec<T>, y: Vec<T>) -> Vec<T> {\n    |                       ^^^^^^ help: consider changing the type to: `&[T]`\n    |\n    = note: `-D needless-pass-by-value` implied by `-D warnings`\n \n error: this argument is passed by value, but not consumed in the function body\n-  --> $DIR/needless_pass_by_value.rs:26:11\n+  --> $DIR/needless_pass_by_value.rs:28:11\n    |\n-26 | fn bar(x: String, y: Wrapper) {\n+28 | fn bar(x: String, y: Wrapper) {\n    |           ^^^^^^ help: consider changing the type to: `&str`\n \n error: this argument is passed by value, but not consumed in the function body\n-  --> $DIR/needless_pass_by_value.rs:26:22\n+  --> $DIR/needless_pass_by_value.rs:28:22\n    |\n-26 | fn bar(x: String, y: Wrapper) {\n+28 | fn bar(x: String, y: Wrapper) {\n    |                      ^^^^^^^ help: consider taking a reference instead: `&Wrapper`\n \n error: this argument is passed by value, but not consumed in the function body\n-  --> $DIR/needless_pass_by_value.rs:32:71\n+  --> $DIR/needless_pass_by_value.rs:34:71\n    |\n-32 | fn test_borrow_trait<T: Borrow<str>, U: AsRef<str>, V>(t: T, u: U, v: V) {\n+34 | fn test_borrow_trait<T: Borrow<str>, U: AsRef<str>, V>(t: T, u: U, v: V) {\n    |                                                                       ^ help: consider taking a reference instead: `&V`\n \n error: this argument is passed by value, but not consumed in the function body\n-  --> $DIR/needless_pass_by_value.rs:44:18\n+  --> $DIR/needless_pass_by_value.rs:46:18\n    |\n-44 | fn test_match(x: Option<Option<String>>, y: Option<Option<String>>) {\n+46 | fn test_match(x: Option<Option<String>>, y: Option<Option<String>>) {\n    |                  ^^^^^^^^^^^^^^^^^^^^^^\n help: consider taking a reference instead\n    |\n-44 | fn test_match(x: &Option<Option<String>>, y: Option<Option<String>>) {\n-45 |     match *x {\n+46 | fn test_match(x: &Option<Option<String>>, y: Option<Option<String>>) {\n+47 |     match *x {\n    |\n \n error: this argument is passed by value, but not consumed in the function body\n-  --> $DIR/needless_pass_by_value.rs:57:24\n+  --> $DIR/needless_pass_by_value.rs:59:24\n    |\n-57 | fn test_destructure(x: Wrapper, y: Wrapper, z: Wrapper) {\n+59 | fn test_destructure(x: Wrapper, y: Wrapper, z: Wrapper) {\n    |                        ^^^^^^^ help: consider taking a reference instead: `&Wrapper`\n \n error: this argument is passed by value, but not consumed in the function body\n-  --> $DIR/needless_pass_by_value.rs:57:36\n+  --> $DIR/needless_pass_by_value.rs:59:36\n    |\n-57 | fn test_destructure(x: Wrapper, y: Wrapper, z: Wrapper) {\n+59 | fn test_destructure(x: Wrapper, y: Wrapper, z: Wrapper) {\n    |                                    ^^^^^^^\n help: consider taking a reference instead\n    |\n-57 | fn test_destructure(x: Wrapper, y: &Wrapper, z: Wrapper) {\n-58 |     let Wrapper(s) = z; // moved\n-59 |     let Wrapper(ref t) = *y; // not moved\n-60 |     let Wrapper(_) = *y; // still not moved\n+59 | fn test_destructure(x: Wrapper, y: &Wrapper, z: Wrapper) {\n+60 |     let Wrapper(s) = z; // moved\n+61 |     let Wrapper(ref t) = *y; // not moved\n+62 |     let Wrapper(_) = *y; // still not moved\n    |\n \n error: this argument is passed by value, but not consumed in the function body\n-  --> $DIR/needless_pass_by_value.rs:73:49\n+  --> $DIR/needless_pass_by_value.rs:75:49\n    |\n-73 | fn test_blanket_ref<T: Foo, S: Serialize>(_foo: T, _serializable: S) {}\n+75 | fn test_blanket_ref<T: Foo, S: Serialize>(_foo: T, _serializable: S) {}\n    |                                                 ^ help: consider taking a reference instead: `&T`\n \n error: this argument is passed by value, but not consumed in the function body\n-  --> $DIR/needless_pass_by_value.rs:75:18\n+  --> $DIR/needless_pass_by_value.rs:77:18\n    |\n-75 | fn issue_2114(s: String, t: String, u: Vec<i32>, v: Vec<i32>) {\n+77 | fn issue_2114(s: String, t: String, u: Vec<i32>, v: Vec<i32>) {\n    |                  ^^^^^^ help: consider taking a reference instead: `&String`\n \n error: this argument is passed by value, but not consumed in the function body\n-  --> $DIR/needless_pass_by_value.rs:75:29\n+  --> $DIR/needless_pass_by_value.rs:77:29\n    |\n-75 | fn issue_2114(s: String, t: String, u: Vec<i32>, v: Vec<i32>) {\n+77 | fn issue_2114(s: String, t: String, u: Vec<i32>, v: Vec<i32>) {\n    |                             ^^^^^^\n help: consider changing the type to\n    |\n-75 | fn issue_2114(s: String, t: &str, u: Vec<i32>, v: Vec<i32>) {\n+77 | fn issue_2114(s: String, t: &str, u: Vec<i32>, v: Vec<i32>) {\n    |                             ^^^^\n help: change `t.clone()` to\n    |\n-77 |     let _ = t.to_string();\n+79 |     let _ = t.to_string();\n    |             ^^^^^^^^^^^^^\n \n error: this argument is passed by value, but not consumed in the function body\n-  --> $DIR/needless_pass_by_value.rs:75:40\n+  --> $DIR/needless_pass_by_value.rs:77:40\n    |\n-75 | fn issue_2114(s: String, t: String, u: Vec<i32>, v: Vec<i32>) {\n+77 | fn issue_2114(s: String, t: String, u: Vec<i32>, v: Vec<i32>) {\n    |                                        ^^^^^^^^ help: consider taking a reference instead: `&Vec<i32>`\n \n error: this argument is passed by value, but not consumed in the function body\n-  --> $DIR/needless_pass_by_value.rs:75:53\n+  --> $DIR/needless_pass_by_value.rs:77:53\n    |\n-75 | fn issue_2114(s: String, t: String, u: Vec<i32>, v: Vec<i32>) {\n+77 | fn issue_2114(s: String, t: String, u: Vec<i32>, v: Vec<i32>) {\n    |                                                     ^^^^^^^^\n help: consider changing the type to\n    |\n-75 | fn issue_2114(s: String, t: String, u: Vec<i32>, v: &[i32]) {\n+77 | fn issue_2114(s: String, t: String, u: Vec<i32>, v: &[i32]) {\n    |                                                     ^^^^^^\n help: change `v.clone()` to\n    |\n-79 |     let _ = v.to_owned();\n+81 |     let _ = v.to_owned();\n    |             ^^^^^^^^^^^^\n \n error: this argument is passed by value, but not consumed in the function body\n-  --> $DIR/needless_pass_by_value.rs:87:12\n+  --> $DIR/needless_pass_by_value.rs:89:12\n    |\n-87 |         s: String,\n+89 |         s: String,\n    |            ^^^^^^ help: consider changing the type to: `&str`\n \n error: this argument is passed by value, but not consumed in the function body\n-  --> $DIR/needless_pass_by_value.rs:88:12\n+  --> $DIR/needless_pass_by_value.rs:90:12\n    |\n-88 |         t: String,\n+90 |         t: String,\n    |            ^^^^^^ help: consider taking a reference instead: `&String`\n \n error: this argument is passed by value, but not consumed in the function body\n-   --> $DIR/needless_pass_by_value.rs:100:13\n+   --> $DIR/needless_pass_by_value.rs:102:13\n     |\n-100 |         _u: U,\n+102 |         _u: U,\n     |             ^ help: consider taking a reference instead: `&U`\n \n error: this argument is passed by value, but not consumed in the function body\n-   --> $DIR/needless_pass_by_value.rs:101:13\n+   --> $DIR/needless_pass_by_value.rs:103:13\n     |\n-101 |         _s: Self,\n+103 |         _s: Self,\n     |             ^^^^ help: consider taking a reference instead: `&Self`\n \n-error: aborting due to 16 previous errors\n+error: this argument is passed by value, but not consumed in the function body\n+   --> $DIR/needless_pass_by_value.rs:125:24\n+    |\n+125 | fn bar_copy(x: u32, y: CopyWrapper) {\n+    |                        ^^^^^^^^^^^ help: consider taking a reference instead: `&CopyWrapper`\n+    |\n+help: consider marking this type as Copy\n+   --> $DIR/needless_pass_by_value.rs:123:1\n+    |\n+123 | struct CopyWrapper(u32);\n+    | ^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+error: this argument is passed by value, but not consumed in the function body\n+   --> $DIR/needless_pass_by_value.rs:131:29\n+    |\n+131 | fn test_destructure_copy(x: CopyWrapper, y: CopyWrapper, z: CopyWrapper) {\n+    |                             ^^^^^^^^^^^ help: consider taking a reference instead: `&CopyWrapper`\n+    |\n+help: consider marking this type as Copy\n+   --> $DIR/needless_pass_by_value.rs:123:1\n+    |\n+123 | struct CopyWrapper(u32);\n+    | ^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+error: this argument is passed by value, but not consumed in the function body\n+   --> $DIR/needless_pass_by_value.rs:131:45\n+    |\n+131 | fn test_destructure_copy(x: CopyWrapper, y: CopyWrapper, z: CopyWrapper) {\n+    |                                             ^^^^^^^^^^^\n+    |\n+help: consider marking this type as Copy\n+   --> $DIR/needless_pass_by_value.rs:123:1\n+    |\n+123 | struct CopyWrapper(u32);\n+    | ^^^^^^^^^^^^^^^^^^^^^^^^\n+help: consider taking a reference instead\n+    |\n+131 | fn test_destructure_copy(x: CopyWrapper, y: &CopyWrapper, z: CopyWrapper) {\n+132 |     let CopyWrapper(s) = z; // moved\n+133 |     let CopyWrapper(ref t) = *y; // not moved\n+134 |     let CopyWrapper(_) = *y; // still not moved\n+    |\n+\n+error: this argument is passed by value, but not consumed in the function body\n+   --> $DIR/needless_pass_by_value.rs:131:61\n+    |\n+131 | fn test_destructure_copy(x: CopyWrapper, y: CopyWrapper, z: CopyWrapper) {\n+    |                                                             ^^^^^^^^^^^\n+    |\n+help: consider marking this type as Copy\n+   --> $DIR/needless_pass_by_value.rs:123:1\n+    |\n+123 | struct CopyWrapper(u32);\n+    | ^^^^^^^^^^^^^^^^^^^^^^^^\n+help: consider taking a reference instead\n+    |\n+131 | fn test_destructure_copy(x: CopyWrapper, y: CopyWrapper, z: &CopyWrapper) {\n+132 |     let CopyWrapper(s) = *z; // moved\n+    |\n+\n+error: aborting due to 20 previous errors\n "}]}