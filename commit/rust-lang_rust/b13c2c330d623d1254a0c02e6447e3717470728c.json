{"sha": "b13c2c330d623d1254a0c02e6447e3717470728c", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIxM2MyYzMzMGQ2MjNkMTI1NGEwYzAyZTY0NDdlMzcxNzQ3MDcyOGM=", "commit": {"author": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2019-10-28T22:21:53Z"}, "committer": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2019-11-08T23:00:20Z"}, "message": "Bless tests now that we do promotion if `min_const_fn` fails\n\nWe bailed out of `QualifyAndPromoteConsts` immediately if the\n`min_const_fn` checks failed, which sometimes resulted in additional,\nspurious errors since promotion was skipped.\n\nWe now do promotion in a completely separate pass, so this is no longer\nan issue.", "tree": {"sha": "cb4ab868ce4e94646f53da1db5cf5975a70e6173", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cb4ab868ce4e94646f53da1db5cf5975a70e6173"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b13c2c330d623d1254a0c02e6447e3717470728c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b13c2c330d623d1254a0c02e6447e3717470728c", "html_url": "https://github.com/rust-lang/rust/commit/b13c2c330d623d1254a0c02e6447e3717470728c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b13c2c330d623d1254a0c02e6447e3717470728c/comments", "author": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b316384e145d4b21b4e882e7abd29fb41d46e33c", "url": "https://api.github.com/repos/rust-lang/rust/commits/b316384e145d4b21b4e882e7abd29fb41d46e33c", "html_url": "https://github.com/rust-lang/rust/commit/b316384e145d4b21b4e882e7abd29fb41d46e33c"}], "stats": {"total": 35, "additions": 7, "deletions": 28}, "files": [{"sha": "db68a05905a144ba8da92d365e6591521a368fcc", "filename": "src/test/ui/consts/min_const_fn/min_const_fn.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b13c2c330d623d1254a0c02e6447e3717470728c/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b13c2c330d623d1254a0c02e6447e3717470728c/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.rs?ref=b13c2c330d623d1254a0c02e6447e3717470728c", "patch": "@@ -136,7 +136,6 @@ const fn no_rpit() -> impl std::fmt::Debug {} //~ ERROR `impl Trait` in const fn\n const fn no_dyn_trait(_x: &dyn std::fmt::Debug) {} //~ ERROR trait bounds other than `Sized`\n const fn no_dyn_trait_ret() -> &'static dyn std::fmt::Debug { &() }\n //~^ ERROR trait bounds other than `Sized`\n-//~| ERROR cannot return reference to temporary value\n \n const fn no_unsafe() { unsafe {} }\n "}, {"sha": "64b2ce83da2f84a2208b0a50f9dd87363a5c392f", "filename": "src/test/ui/consts/min_const_fn/min_const_fn.stderr", "status": "modified", "additions": 5, "deletions": 14, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/b13c2c330d623d1254a0c02e6447e3717470728c/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b13c2c330d623d1254a0c02e6447e3717470728c/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.stderr?ref=b13c2c330d623d1254a0c02e6447e3717470728c", "patch": "@@ -286,17 +286,8 @@ LL | const fn no_dyn_trait_ret() -> &'static dyn std::fmt::Debug { &() }\n    = note: for more information, see issue https://github.com/rust-lang/rust/issues/57563\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n-error[E0515]: cannot return reference to temporary value\n-  --> $DIR/min_const_fn.rs:137:63\n-   |\n-LL | const fn no_dyn_trait_ret() -> &'static dyn std::fmt::Debug { &() }\n-   |                                                               ^--\n-   |                                                               ||\n-   |                                                               |temporary value created here\n-   |                                                               returns a reference to data owned by the current function\n-\n error[E0723]: trait bounds other than `Sized` on const fn parameters are unstable\n-  --> $DIR/min_const_fn.rs:143:41\n+  --> $DIR/min_const_fn.rs:142:41\n    |\n LL | const fn really_no_traits_i_mean_it() { (&() as &dyn std::fmt::Debug, ()).1 }\n    |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n@@ -305,7 +296,7 @@ LL | const fn really_no_traits_i_mean_it() { (&() as &dyn std::fmt::Debug, ()).1\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n error[E0723]: function pointers in const fn are unstable\n-  --> $DIR/min_const_fn.rs:146:21\n+  --> $DIR/min_const_fn.rs:145:21\n    |\n LL | const fn no_fn_ptrs(_x: fn()) {}\n    |                     ^^\n@@ -314,15 +305,15 @@ LL | const fn no_fn_ptrs(_x: fn()) {}\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n error[E0723]: function pointers in const fn are unstable\n-  --> $DIR/min_const_fn.rs:148:27\n+  --> $DIR/min_const_fn.rs:147:27\n    |\n LL | const fn no_fn_ptrs2() -> fn() { fn foo() {} foo }\n    |                           ^^^^\n    |\n    = note: for more information, see issue https://github.com/rust-lang/rust/issues/57563\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n-error: aborting due to 37 previous errors\n+error: aborting due to 36 previous errors\n \n-Some errors have detailed explanations: E0493, E0515, E0723.\n+Some errors have detailed explanations: E0493, E0723.\n For more information about an error, try `rustc --explain E0493`."}, {"sha": "6ca1e59b3af106815ab316f2ceb094b9a3e6084a", "filename": "src/test/ui/consts/min_const_fn/min_const_fn_dyn.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b13c2c330d623d1254a0c02e6447e3717470728c/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn_dyn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b13c2c330d623d1254a0c02e6447e3717470728c/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn_dyn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn_dyn.rs?ref=b13c2c330d623d1254a0c02e6447e3717470728c", "patch": "@@ -11,6 +11,5 @@ const fn no_inner_dyn_trait2(x: Hide) {\n }\n const fn no_inner_dyn_trait_ret() -> Hide { Hide(HasDyn { field: &0 }) }\n //~^ ERROR trait bounds other than `Sized`\n-//~| ERROR temporary value dropped while borrowed\n \n fn main() {}"}, {"sha": "e20b4f9dcb47137bdb2ffb393a9aad69743ea25c", "filename": "src/test/ui/consts/min_const_fn/min_const_fn_dyn.stderr", "status": "modified", "additions": 2, "deletions": 12, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/b13c2c330d623d1254a0c02e6447e3717470728c/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn_dyn.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b13c2c330d623d1254a0c02e6447e3717470728c/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn_dyn.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn_dyn.stderr?ref=b13c2c330d623d1254a0c02e6447e3717470728c", "patch": "@@ -16,16 +16,6 @@ LL | const fn no_inner_dyn_trait_ret() -> Hide { Hide(HasDyn { field: &0 }) }\n    = note: for more information, see issue https://github.com/rust-lang/rust/issues/57563\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n-error[E0716]: temporary value dropped while borrowed\n-  --> $DIR/min_const_fn_dyn.rs:12:67\n-   |\n-LL | const fn no_inner_dyn_trait_ret() -> Hide { Hide(HasDyn { field: &0 }) }\n-   |                                                                  -^    - temporary value is freed at the end of this statement\n-   |                                                                  ||\n-   |                                                                  |creates a temporary which is freed while still in use\n-   |                                                                  cast requires that borrow lasts for `'static`\n-\n-error: aborting due to 3 previous errors\n+error: aborting due to 2 previous errors\n \n-Some errors have detailed explanations: E0716, E0723.\n-For more information about an error, try `rustc --explain E0716`.\n+For more information about this error, try `rustc --explain E0723`."}]}