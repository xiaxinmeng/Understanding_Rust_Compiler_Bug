{"sha": "f28a9d8f5203fc01c870ec15b44f8156ebc63168", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYyOGE5ZDhmNTIwM2ZjMDFjODcwZWMxNWI0NGY4MTU2ZWJjNjMxNjg=", "commit": {"author": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-04-08T01:00:29Z"}, "committer": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-04-08T01:02:01Z"}, "message": "rustc: Pointer cast when crossing a box boundary for statically-sized elements in trans_index()", "tree": {"sha": "67b1980c1308322945af7e76cfb2199328f832e8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/67b1980c1308322945af7e76cfb2199328f832e8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f28a9d8f5203fc01c870ec15b44f8156ebc63168", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f28a9d8f5203fc01c870ec15b44f8156ebc63168", "html_url": "https://github.com/rust-lang/rust/commit/f28a9d8f5203fc01c870ec15b44f8156ebc63168", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f28a9d8f5203fc01c870ec15b44f8156ebc63168/comments", "author": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "009e01dbe74699d137410c13fca70370d376a824", "url": "https://api.github.com/repos/rust-lang/rust/commits/009e01dbe74699d137410c13fca70370d376a824", "html_url": "https://github.com/rust-lang/rust/commit/009e01dbe74699d137410c13fca70370d376a824"}], "stats": {"total": 4, "additions": 4, "deletions": 0}, "files": [{"sha": "28b22ea2a5ed7cdd37b49b09e875642bf678e89c", "filename": "src/comp/middle/trans.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/f28a9d8f5203fc01c870ec15b44f8156ebc63168/src%2Fcomp%2Fmiddle%2Ftrans.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f28a9d8f5203fc01c870ec15b44f8156ebc63168/src%2Fcomp%2Fmiddle%2Ftrans.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Ftrans.rs?ref=f28a9d8f5203fc01c870ec15b44f8156ebc63168", "patch": "@@ -3892,6 +3892,10 @@ fn trans_index(@block_ctxt cx, &ast.span sp, @ast.expr base,\n         elt = next_cx.build.GEP(body, vec(C_int(0), scaled_ix));\n     } else {\n         elt = next_cx.build.GEP(body, vec(C_int(0), ix_val));\n+\n+        // We're crossing a box boundary here, so we may need to pointer cast.\n+        auto llunitty = type_of(next_cx.fcx.ccx, unit_ty);\n+        elt = next_cx.build.PointerCast(elt, T_ptr(llunitty));\n     }\n \n     ret lval_mem(next_cx, elt);"}]}