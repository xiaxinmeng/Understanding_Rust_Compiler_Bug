{"sha": "f458d8f669b9d61e52e289750c6b0773b8ab070b", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY0NThkOGY2NjliOWQ2MWU1MmUyODk3NTBjNmIwNzczYjhhYjA3MGI=", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2021-06-30T20:21:00Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-06-30T20:21:00Z"}, "message": "Rollup merge of #86746 - GuillaumeGomez:query-type-filter, r=notriddle\n\nFix rustdoc query type filter\n\nI realized while reviewing #86659 that the type filter was broken on search so I'd prefer it to get merged before merging #86659.\n\nr? `@notriddle`", "tree": {"sha": "d777fab2b7b623a2e402e37985f84fb260b4bc1f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d777fab2b7b623a2e402e37985f84fb260b4bc1f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f458d8f669b9d61e52e289750c6b0773b8ab070b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJg3NItCRBK7hj4Ov3rIwAAFr4IAFP9fU9KXdoWCG8jzkLvPV45\n8Nsr7ORn3luPghPKy0j1lFlLA8AphZC9z915GMLWgMHlBD7kLGwyfg6iG+sMdCCr\nxzRWOtMjQp5rP77TkLpufEGxdQndUN7u+L6NsdBECXSiVeEIoZ86vjkVUjqrPCSL\n+fVikWGnaDafz9Uj7zd12zZ8/AmBW+2CjD3nJKt6eOjgeL2KaYHlGAsmH11ZHv0d\nn8YjiBeeotFIDbLYP9lSAv5e+e+HGf4nLEnF2PqAOpDJf7mav6qGBRTmvdINOobv\nuBNMZkns6jWGFh9NpbeM3XoLwpnTS6w1CdlZDlDtkkPMceYMBwjQCcHcjhFegfg=\n=Obhv\n-----END PGP SIGNATURE-----\n", "payload": "tree d777fab2b7b623a2e402e37985f84fb260b4bc1f\nparent e52a0ec5b8adedab4c72f005f39d283f8d32520b\nparent 855923c895681976d7a3ce6ff376f9b4c3b21ae8\nauthor Yuki Okushi <jtitor@2k36.org> 1625084460 +0900\ncommitter GitHub <noreply@github.com> 1625084460 +0900\n\nRollup merge of #86746 - GuillaumeGomez:query-type-filter, r=notriddle\n\nFix rustdoc query type filter\n\nI realized while reviewing #86659 that the type filter was broken on search so I'd prefer it to get merged before merging #86659.\n\nr? `@notriddle`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f458d8f669b9d61e52e289750c6b0773b8ab070b", "html_url": "https://github.com/rust-lang/rust/commit/f458d8f669b9d61e52e289750c6b0773b8ab070b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f458d8f669b9d61e52e289750c6b0773b8ab070b/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e52a0ec5b8adedab4c72f005f39d283f8d32520b", "url": "https://api.github.com/repos/rust-lang/rust/commits/e52a0ec5b8adedab4c72f005f39d283f8d32520b", "html_url": "https://github.com/rust-lang/rust/commit/e52a0ec5b8adedab4c72f005f39d283f8d32520b"}, {"sha": "855923c895681976d7a3ce6ff376f9b4c3b21ae8", "url": "https://api.github.com/repos/rust-lang/rust/commits/855923c895681976d7a3ce6ff376f9b4c3b21ae8", "html_url": "https://github.com/rust-lang/rust/commit/855923c895681976d7a3ce6ff376f9b4c3b21ae8"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "f6343e4c3d246c4496cbda98b8cb0ef2168db7ca", "filename": "src/librustdoc/html/static/search.js", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/f458d8f669b9d61e52e289750c6b0773b8ab070b/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fsearch.js", "raw_url": "https://github.com/rust-lang/rust/raw/f458d8f669b9d61e52e289750c6b0773b8ab070b/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fsearch.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fsearch.js?ref=f458d8f669b9d61e52e289750c6b0773b8ab070b", "patch": "@@ -801,7 +801,8 @@ window.initSearch = function(rawSearchIndex) {\n                     results_returned[fullId].lev =\n                         Math.min(results_returned[fullId].lev, returned);\n                 }\n-                if (index !== -1 || lev <= MAX_LEV_DISTANCE) {\n+                if (typePassesFilter(typeFilter, ty.ty) &&\n+                        (index !== -1 || lev <= MAX_LEV_DISTANCE)) {\n                     if (index !== -1 && paths.length < 2) {\n                         lev = 0;\n                     }"}, {"sha": "f656aa72986fdb52a601c1526a0cd68983cbc526", "filename": "src/test/rustdoc-js-std/typed-query.js", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/f458d8f669b9d61e52e289750c6b0773b8ab070b/src%2Ftest%2Frustdoc-js-std%2Ftyped-query.js", "raw_url": "https://github.com/rust-lang/rust/raw/f458d8f669b9d61e52e289750c6b0773b8ab070b/src%2Ftest%2Frustdoc-js-std%2Ftyped-query.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-js-std%2Ftyped-query.js?ref=f458d8f669b9d61e52e289750c6b0773b8ab070b", "patch": "@@ -0,0 +1,12 @@\n+// exact-check\n+\n+const QUERY = 'macro:print';\n+\n+const EXPECTED = {\n+    'others': [\n+        { 'path': 'std', 'name': 'print' },\n+        { 'path': 'std', 'name': 'eprint' },\n+        { 'path': 'std', 'name': 'println' },\n+        { 'path': 'std', 'name': 'eprintln' },\n+    ],\n+};"}]}