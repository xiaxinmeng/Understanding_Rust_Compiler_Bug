{"sha": "9ecb97ae58c6fde97bfe58aeddd11790899bd4ec", "node_id": "MDY6Q29tbWl0NzI0NzEyOjllY2I5N2FlNThjNmZkZTk3YmZlNThhZWRkZDExNzkwODk5YmQ0ZWM=", "commit": {"author": {"name": "Young-il Choi", "email": "duddlf.choi@samsung.com", "date": "2013-05-03T15:47:54Z"}, "committer": {"name": "Young-il Choi", "email": "duddlf.choi@samsung.com", "date": "2013-05-03T15:47:54Z"}, "message": "mk: install.mk directory argument pass for install-runtime-target", "tree": {"sha": "e06b2e8ec0b035daa43d86e11490dab9aa4fb2c4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e06b2e8ec0b035daa43d86e11490dab9aa4fb2c4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9ecb97ae58c6fde97bfe58aeddd11790899bd4ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9ecb97ae58c6fde97bfe58aeddd11790899bd4ec", "html_url": "https://github.com/rust-lang/rust/commit/9ecb97ae58c6fde97bfe58aeddd11790899bd4ec", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9ecb97ae58c6fde97bfe58aeddd11790899bd4ec/comments", "author": {"login": "yichoi", "id": 3222276, "node_id": "MDQ6VXNlcjMyMjIyNzY=", "avatar_url": "https://avatars.githubusercontent.com/u/3222276?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yichoi", "html_url": "https://github.com/yichoi", "followers_url": "https://api.github.com/users/yichoi/followers", "following_url": "https://api.github.com/users/yichoi/following{/other_user}", "gists_url": "https://api.github.com/users/yichoi/gists{/gist_id}", "starred_url": "https://api.github.com/users/yichoi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yichoi/subscriptions", "organizations_url": "https://api.github.com/users/yichoi/orgs", "repos_url": "https://api.github.com/users/yichoi/repos", "events_url": "https://api.github.com/users/yichoi/events{/privacy}", "received_events_url": "https://api.github.com/users/yichoi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "yichoi", "id": 3222276, "node_id": "MDQ6VXNlcjMyMjIyNzY=", "avatar_url": "https://avatars.githubusercontent.com/u/3222276?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yichoi", "html_url": "https://github.com/yichoi", "followers_url": "https://api.github.com/users/yichoi/followers", "following_url": "https://api.github.com/users/yichoi/following{/other_user}", "gists_url": "https://api.github.com/users/yichoi/gists{/gist_id}", "starred_url": "https://api.github.com/users/yichoi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yichoi/subscriptions", "organizations_url": "https://api.github.com/users/yichoi/orgs", "repos_url": "https://api.github.com/users/yichoi/repos", "events_url": "https://api.github.com/users/yichoi/events{/privacy}", "received_events_url": "https://api.github.com/users/yichoi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "35214d3c6cd5f70b38baa6d879ca40d9db8118ba", "url": "https://api.github.com/repos/rust-lang/rust/commits/35214d3c6cd5f70b38baa6d879ca40d9db8118ba", "html_url": "https://github.com/rust-lang/rust/commit/35214d3c6cd5f70b38baa6d879ca40d9db8118ba"}], "stats": {"total": 41, "additions": 24, "deletions": 17}, "files": [{"sha": "5fa477a790d4f8cb591e143d52f449721371d1b8", "filename": "mk/install.mk", "status": "modified", "additions": 24, "deletions": 17, "changes": 41, "blob_url": "https://github.com/rust-lang/rust/blob/9ecb97ae58c6fde97bfe58aeddd11790899bd4ec/mk%2Finstall.mk", "raw_url": "https://github.com/rust-lang/rust/raw/9ecb97ae58c6fde97bfe58aeddd11790899bd4ec/mk%2Finstall.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Finstall.mk?ref=9ecb97ae58c6fde97bfe58aeddd11790899bd4ec", "patch": "@@ -157,40 +157,46 @@ uninstall:\n \n # target platform specific variables\n # for arm-linux-androidabi\n-define DEF_ADB_STATUS\n-CFG_ADB_DEVICE=$(1)\n+define DEF_ADB_DEVICE_STATUS\n+CFG_ADB_DEVICE_STATUS=$(1)\n endef\n \n $(foreach target,$(CFG_TARGET_TRIPLES), \\\n   $(if $(findstring $(target),\"arm-linux-androideabi\"), \\\n-    $(if $(findstring adb,$(shell which adb)), \\\n-      $(if $(findstring device,$(shell adb devices 2>/dev/null | grep -E '^[A-Za-z0-9-]+[[:blank:]]+device')), \\\n-        $(info install: install-runtime-target for arm-linux-androideabi enabled \\\n+    $(if $(findstring adb,$(CFG_ADB)), \\\n+      $(if $(findstring device,$(shell adb devices 2>/dev/null | grep -E '^[_A-Za-z0-9-]+[[:blank:]]+device')), \\\n+        $(info install: install-runtime-target for $(target) enabled \\\n           $(info install: android device attached) \\\n-          $(eval $(call DEF_ADB_STATUS, true))), \\\n-        $(info install: install-runtime-target for arm-linux-androideabi disabled \\\n+          $(eval $(call DEF_ADB_DEVICE_STATUS, true))), \\\n+        $(info install: install-runtime-target for $(target) disabled \\\n           $(info install: android device not attached) \\\n-          $(eval $(call DEF_ADB_STATUS, false))) \\\n+          $(eval $(call DEF_ADB_DEVICE_STATUS, false))) \\\n       ), \\\n-      $(info install: install-runtime-target for arm-linux-androideabi disabled \\\n+      $(info install: install-runtime-target for $(target) disabled \\\n         $(info install: adb not found) \\\n-        $(eval $(call DEF_ADB_STATUS, false))) \\\n+        $(eval $(call DEF_ADB_DEVICE_STATUS, false))) \\\n     ), \\\n   ) \\\n )\n \n-ifeq ($(CFG_ADB_DEVICE),true)\n-\n+ifeq (install-runtime-target,$(firstword $(MAKECMDGOALS)))\n+$(eval $(wordlist 2,$(words $(MAKECMDGOALS)),$(MAKECMDGOALS)):;@:)\n+L_TOKEN := $(word 2,$(MAKECMDGOALS))\n+ifeq ($(L_TOKEN),)\n CFG_RUNTIME_PUSH_DIR=/system/lib\n+else\n+CFG_RUNTIME_PUSH_DIR=$(L_TOKEN)\n+endif\n \n+ifeq ($(CFG_ADB_DEVICE_STATUS),true)\n ifdef VERBOSE\n  ADB = adb $(1)\n  ADB_PUSH = adb push $(1) $(2)\n  ADB_SHELL = adb shell $(1) $(2) \n else\n- ADB = $(Q)$(call E, adb $(1)) && adb $(1) 1>/dev/null 2>/dev/null\n- ADB_PUSH = $(Q)$(call E, adb push $(1)) && adb push $(1) $(2) 1>/dev/null 2>/dev/null\n- ADB_SHELL = $(Q)$(call E, adb shell $(1) $(2)) && adb shell $(1) $(2) 1>/dev/null 2>/dev/null\n+ ADB = $(Q)$(call E, adb $(1)) && adb $(1) 1>/dev/null \n+ ADB_PUSH = $(Q)$(call E, adb push $(1)) && adb push $(1) $(2) 1>/dev/null\n+ ADB_SHELL = $(Q)$(call E, adb shell $(1) $(2)) && adb shell $(1) $(2) 1>/dev/null\n endif\n \n define INSTALL_RUNTIME_TARGET_N\n@@ -215,8 +221,9 @@ $(eval $(call INSTALL_RUNTIME_TARGET_CLEANUP_N,arm-linux-androideabi))\n install-runtime-target: \\\n \tinstall-runtime-target-arm-linux-androideabi-cleanup \\\n \tinstall-runtime-target-arm-linux-androideabi-host-$(CFG_BUILD_TRIPLE)\n-\n else\n install-runtime-target: \n-\t@echo\n+\t@echo \"No device to install runtime library\"\n+\t@echo \n+endif\n endif"}]}