{"sha": "ae90dcf0207c57c3034f00b07048d63f8b2363c8", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFlOTBkY2YwMjA3YzU3YzMwMzRmMDBiMDcwNDhkNjNmOGIyMzYzYzg=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-08-09T13:16:51Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-08-09T13:16:51Z"}, "message": "Auto merge of #85357 - Andy-Python-Programmer:aarch64_uefi_target, r=petrochenkov\n\nAdd `aarch64-unknown-uefi` target\n\nThis pull request adds the `aarch64-unknown-uefi` target.", "tree": {"sha": "f2c0b5877ef83c955488d43e0fffb31cdae3f6ef", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f2c0b5877ef83c955488d43e0fffb31cdae3f6ef"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ae90dcf0207c57c3034f00b07048d63f8b2363c8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ae90dcf0207c57c3034f00b07048d63f8b2363c8", "html_url": "https://github.com/rust-lang/rust/commit/ae90dcf0207c57c3034f00b07048d63f8b2363c8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ae90dcf0207c57c3034f00b07048d63f8b2363c8/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "eaf6f463599df1f18da94a6965e216ea15795417", "url": "https://api.github.com/repos/rust-lang/rust/commits/eaf6f463599df1f18da94a6965e216ea15795417", "html_url": "https://github.com/rust-lang/rust/commit/eaf6f463599df1f18da94a6965e216ea15795417"}, {"sha": "44b81fb8fc565610d88156608f21a2e3efce2aac", "url": "https://api.github.com/repos/rust-lang/rust/commits/44b81fb8fc565610d88156608f21a2e3efce2aac", "html_url": "https://github.com/rust-lang/rust/commit/44b81fb8fc565610d88156608f21a2e3efce2aac"}], "stats": {"total": 29, "additions": 29, "deletions": 0}, "files": [{"sha": "20c528d25f3861efd8e1cad2e1ba86c819ab5fdd", "filename": "compiler/rustc_target/src/spec/aarch64_unknown_uefi.rs", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/ae90dcf0207c57c3034f00b07048d63f8b2363c8/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_unknown_uefi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ae90dcf0207c57c3034f00b07048d63f8b2363c8/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_unknown_uefi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_unknown_uefi.rs?ref=ae90dcf0207c57c3034f00b07048d63f8b2363c8", "patch": "@@ -0,0 +1,27 @@\n+// This defines the aarch64 target for UEFI systems as described in the UEFI specification. See the\n+// uefi-base module for generic UEFI options.\n+\n+use super::uefi_msvc_base;\n+use crate::spec::{LinkerFlavor, LldFlavor, Target};\n+\n+pub fn target() -> Target {\n+    let mut base = uefi_msvc_base::opts();\n+\n+    base.max_atomic_width = Some(64);\n+\n+    let pre_link_args_msvc = vec![\"/machine:arm64\".to_string()];\n+\n+    base.pre_link_args.get_mut(&LinkerFlavor::Msvc).unwrap().extend(pre_link_args_msvc.clone());\n+    base.pre_link_args\n+        .get_mut(&LinkerFlavor::Lld(LldFlavor::Link))\n+        .unwrap()\n+        .extend(pre_link_args_msvc);\n+\n+    Target {\n+        llvm_target: \"aarch64-unknown-windows\".to_string(),\n+        pointer_width: 64,\n+        data_layout: \"e-m:w-p:64:64-i32:32-i64:64-i128:128-n32:64-S128\".to_string(),\n+        arch: \"aarch64\".to_string(),\n+        options: base,\n+    }\n+}"}, {"sha": "9c957cba6cc098b4073aefa67a5f9b8732bbda43", "filename": "compiler/rustc_target/src/spec/mod.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/ae90dcf0207c57c3034f00b07048d63f8b2363c8/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ae90dcf0207c57c3034f00b07048d63f8b2363c8/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs?ref=ae90dcf0207c57c3034f00b07048d63f8b2363c8", "patch": "@@ -918,6 +918,7 @@ supported_targets! {\n \n     (\"x86_64-unknown-uefi\", x86_64_unknown_uefi),\n     (\"i686-unknown-uefi\", i686_unknown_uefi),\n+    (\"aarch64-unknown-uefi\", aarch64_unknown_uefi),\n \n     (\"nvptx64-nvidia-cuda\", nvptx64_nvidia_cuda),\n "}, {"sha": "b5d20a6a4cd8119e7f054c3ba90f7e716d65ea61", "filename": "src/doc/rustc/src/platform-support.md", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/ae90dcf0207c57c3034f00b07048d63f8b2363c8/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md", "raw_url": "https://github.com/rust-lang/rust/raw/ae90dcf0207c57c3034f00b07048d63f8b2363c8/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md?ref=ae90dcf0207c57c3034f00b07048d63f8b2363c8", "patch": "@@ -200,6 +200,7 @@ target | std | host | notes\n `aarch64-apple-tvos` | * |  | ARM64 tvOS\n `aarch64-unknown-freebsd` | \u2713 | \u2713 | ARM64 FreeBSD\n `aarch64-unknown-hermit` | ? |  |\n+`aarch64-unknown-uefi` | * |  | ARM64 UEFI\n `aarch64-unknown-linux-gnu_ilp32` | \u2713 | \u2713 | ARM64 Linux (ILP32 ABI)\n `aarch64-unknown-netbsd` | \u2713 | \u2713 |\n `aarch64-unknown-openbsd` | \u2713 | \u2713 | ARM64 OpenBSD"}]}