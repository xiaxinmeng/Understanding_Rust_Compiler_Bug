{"sha": "be0484b65def1c07aa2fbc456db0d02f59895b4a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJlMDQ4NGI2NWRlZjFjMDdhYTJmYmM0NTZkYjBkMDJmNTk4OTViNGE=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2020-11-24T16:36:16Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2020-11-24T20:31:27Z"}, "message": "Clean up document_item_info calls", "tree": {"sha": "30a1a7675852540116817d9074bc4349f8312ba2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/30a1a7675852540116817d9074bc4349f8312ba2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/be0484b65def1c07aa2fbc456db0d02f59895b4a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/be0484b65def1c07aa2fbc456db0d02f59895b4a", "html_url": "https://github.com/rust-lang/rust/commit/be0484b65def1c07aa2fbc456db0d02f59895b4a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/be0484b65def1c07aa2fbc456db0d02f59895b4a/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "caf6c5790a858893c1d32ed2054c9577d12e7493", "url": "https://api.github.com/repos/rust-lang/rust/commits/caf6c5790a858893c1d32ed2054c9577d12e7493", "html_url": "https://github.com/rust-lang/rust/commit/caf6c5790a858893c1d32ed2054c9577d12e7493"}], "stats": {"total": 27, "additions": 20, "deletions": 7}, "files": [{"sha": "bbd4be88e6a8bdd54641899fa2367d1af87ef495", "filename": "src/librustdoc/html/render/mod.rs", "status": "modified", "additions": 20, "deletions": 7, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/be0484b65def1c07aa2fbc456db0d02f59895b4a/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/be0484b65def1c07aa2fbc456db0d02f59895b4a/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs?ref=be0484b65def1c07aa2fbc456db0d02f59895b4a", "patch": "@@ -1880,10 +1880,17 @@ fn render_markdown(\n fn document_short(\n     w: &mut Buffer,\n     item: &clean::Item,\n+    cx: &Context,\n     link: AssocItemLink<'_>,\n     prefix: &str,\n     is_hidden: bool,\n+    parent: Option<&clean::Item>,\n+    show_def_docs: bool,\n ) {\n+    document_item_info(w, cx, item, is_hidden, parent);\n+    if !show_def_docs {\n+        return;\n+    }\n     if let Some(s) = item.doc_value() {\n         let mut summary_html = MarkdownSummaryLine(s, &item.links()).into_string();\n \n@@ -3806,13 +3813,22 @@ fn render_impl(\n                     if let Some(it) = t.items.iter().find(|i| i.name == item.name) {\n                         // We need the stability of the item from the trait\n                         // because impls can't have a stability.\n-                        document_item_info(w, cx, it, is_hidden, Some(parent));\n                         if item.doc_value().is_some() {\n+                            document_item_info(w, cx, it, is_hidden, Some(parent));\n                             document_full(w, item, cx, \"\", is_hidden);\n-                        } else if show_def_docs {\n+                        } else {\n                             // In case the item isn't documented,\n                             // provide short documentation from the trait.\n-                            document_short(w, it, link, \"\", is_hidden);\n+                            document_short(\n+                                w,\n+                                it,\n+                                cx,\n+                                link,\n+                                \"\",\n+                                is_hidden,\n+                                Some(parent),\n+                                show_def_docs,\n+                            );\n                         }\n                     }\n                 } else {\n@@ -3822,10 +3838,7 @@ fn render_impl(\n                     }\n                 }\n             } else {\n-                document_item_info(w, cx, item, is_hidden, Some(parent));\n-                if show_def_docs {\n-                    document_short(w, item, link, \"\", is_hidden);\n-                }\n+                document_short(w, item, cx, link, \"\", is_hidden, Some(parent), show_def_docs);\n             }\n         }\n     }"}]}