{"sha": "bc63c0edc0d1e82302305a479f53aa1137e96179", "node_id": "C_kwDOAAsO6NoAKGJjNjNjMGVkYzBkMWU4MjMwMjMwNWE0NzlmNTNhYTExMzdlOTYxNzk", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-12-10T20:02:08Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-12-10T20:02:08Z"}, "message": "Add test for non-rust code block hashtag prepended lines", "tree": {"sha": "d8e2dd09307ceba2b6fb8b46bbbd775ae85eb29b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d8e2dd09307ceba2b6fb8b46bbbd775ae85eb29b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bc63c0edc0d1e82302305a479f53aa1137e96179", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bc63c0edc0d1e82302305a479f53aa1137e96179", "html_url": "https://github.com/rust-lang/rust/commit/bc63c0edc0d1e82302305a479f53aa1137e96179", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bc63c0edc0d1e82302305a479f53aa1137e96179/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e81ad69331dd5fafc9f89756c08a3882680b70e7", "url": "https://api.github.com/repos/rust-lang/rust/commits/e81ad69331dd5fafc9f89756c08a3882680b70e7", "html_url": "https://github.com/rust-lang/rust/commit/e81ad69331dd5fafc9f89756c08a3882680b70e7"}], "stats": {"total": 37, "additions": 37, "deletions": 0}, "files": [{"sha": "68b31a6ee083d1f82b1bfcfa4131913e451cd0e9", "filename": "src/librustdoc/html/markdown/tests.rs", "status": "modified", "additions": 37, "deletions": 0, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/bc63c0edc0d1e82302305a479f53aa1137e96179/src%2Flibrustdoc%2Fhtml%2Fmarkdown%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bc63c0edc0d1e82302305a479f53aa1137e96179/src%2Flibrustdoc%2Fhtml%2Fmarkdown%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fmarkdown%2Ftests.rs?ref=bc63c0edc0d1e82302305a479f53aa1137e96179", "patch": "@@ -309,3 +309,40 @@ fn test_find_testable_code_line() {\n     t(\"```rust\\n```\\n```rust\\n```\", &[1, 3]);\n     t(\"```rust\\n```\\n ```rust\\n```\", &[1, 3]);\n }\n+\n+#[test]\n+fn test_ascii_with_prepending_hashtag() {\n+    fn t(input: &str, expect: &str) {\n+        let mut map = IdMap::new();\n+        let output = Markdown {\n+            content: input,\n+            links: &[],\n+            ids: &mut map,\n+            error_codes: ErrorCodes::Yes,\n+            edition: DEFAULT_EDITION,\n+            playground: &None,\n+            heading_offset: HeadingOffset::H2,\n+        }\n+        .into_string();\n+        assert_eq!(output, expect, \"original: {}\", input);\n+    }\n+\n+    t(\n+        r#\"```ascii\n+#..#.####.#....#.....##..\n+#..#.#....#....#....#..#.\n+####.###..#....#....#..#.\n+#..#.#....#....#....#..#.\n+#..#.#....#....#....#..#.\n+#..#.####.####.####..##..\n+```\"#,\n+        \"<div class=\\\"example-wrap\\\"><pre class=\\\"language-ascii\\\"><code>\\\n+#..#.####.#....#.....##..\n+#..#.#....#....#....#..#.\n+####.###..#....#....#..#.\n+#..#.#....#....#....#..#.\n+#..#.#....#....#....#..#.\n+#..#.####.####.####..##..\n+</code></pre></div>\",\n+    );\n+}"}]}