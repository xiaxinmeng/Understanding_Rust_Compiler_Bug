{"sha": "dfe84494c142356a53f12279698f7bfc3b056481", "node_id": "C_kwDOAAsO6NoAKGRmZTg0NDk0YzE0MjM1NmE1M2YxMjI3OTY5OGY3YmZjM2IwNTY0ODE", "commit": {"author": {"name": "Amos Wenger", "email": "amoswenger@gmail.com", "date": "2022-07-24T14:48:06Z"}, "committer": {"name": "Amos Wenger", "email": "amoswenger@gmail.com", "date": "2022-07-24T14:48:06Z"}, "message": "Make macros test order-resistant", "tree": {"sha": "0d6aa1c54acec244039a2a4c6cfb620fb1c56988", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0d6aa1c54acec244039a2a4c6cfb620fb1c56988"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/dfe84494c142356a53f12279698f7bfc3b056481", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/dfe84494c142356a53f12279698f7bfc3b056481", "html_url": "https://github.com/rust-lang/rust/commit/dfe84494c142356a53f12279698f7bfc3b056481", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/dfe84494c142356a53f12279698f7bfc3b056481/comments", "author": {"login": "fasterthanlime", "id": 7998310, "node_id": "MDQ6VXNlcjc5OTgzMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/7998310?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fasterthanlime", "html_url": "https://github.com/fasterthanlime", "followers_url": "https://api.github.com/users/fasterthanlime/followers", "following_url": "https://api.github.com/users/fasterthanlime/following{/other_user}", "gists_url": "https://api.github.com/users/fasterthanlime/gists{/gist_id}", "starred_url": "https://api.github.com/users/fasterthanlime/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fasterthanlime/subscriptions", "organizations_url": "https://api.github.com/users/fasterthanlime/orgs", "repos_url": "https://api.github.com/users/fasterthanlime/repos", "events_url": "https://api.github.com/users/fasterthanlime/events{/privacy}", "received_events_url": "https://api.github.com/users/fasterthanlime/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fasterthanlime", "id": 7998310, "node_id": "MDQ6VXNlcjc5OTgzMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/7998310?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fasterthanlime", "html_url": "https://github.com/fasterthanlime", "followers_url": "https://api.github.com/users/fasterthanlime/followers", "following_url": "https://api.github.com/users/fasterthanlime/following{/other_user}", "gists_url": "https://api.github.com/users/fasterthanlime/gists{/gist_id}", "starred_url": "https://api.github.com/users/fasterthanlime/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fasterthanlime/subscriptions", "organizations_url": "https://api.github.com/users/fasterthanlime/orgs", "repos_url": "https://api.github.com/users/fasterthanlime/repos", "events_url": "https://api.github.com/users/fasterthanlime/events{/privacy}", "received_events_url": "https://api.github.com/users/fasterthanlime/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "56c369db488361822ec4b2dbf954f6c48d384855", "url": "https://api.github.com/repos/rust-lang/rust/commits/56c369db488361822ec4b2dbf954f6c48d384855", "html_url": "https://github.com/rust-lang/rust/commit/56c369db488361822ec4b2dbf954f6c48d384855"}], "stats": {"total": 9, "additions": 7, "deletions": 2}, "files": [{"sha": "3ece1379ad774b495c0b8e2d568cdc8efa8bf23b", "filename": "crates/hir-def/src/nameres/tests/macros.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/dfe84494c142356a53f12279698f7bfc3b056481/crates%2Fhir-def%2Fsrc%2Fnameres%2Ftests%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dfe84494c142356a53f12279698f7bfc3b056481/crates%2Fhir-def%2Fsrc%2Fnameres%2Ftests%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir-def%2Fsrc%2Fnameres%2Ftests%2Fmacros.rs?ref=dfe84494c142356a53f12279698f7bfc3b056481", "patch": "@@ -1,4 +1,5 @@\n use super::*;\n+use itertools::Itertools;\n \n #[test]\n fn macro_rules_are_globally_visible() {\n@@ -1171,11 +1172,15 @@ fn proc_attr(a: TokenStream, b: TokenStream) -> TokenStream { a }\n     );\n \n     let root = &def_map[def_map.root()].scope;\n-    let actual = root.legacy_macros().map(|(name, _)| format!(\"{name}\\n\")).collect::<String>();\n+    let actual = root\n+        .legacy_macros()\n+        .sorted_by(|a, b| std::cmp::Ord::cmp(&a.0, &b.0))\n+        .map(|(name, _)| format!(\"{name}\\n\"))\n+        .collect::<String>();\n \n     expect![[r#\"\n-        macro20\n         legacy\n+        macro20\n         proc_attr\n     \"#]]\n     .assert_eq(&actual);"}]}