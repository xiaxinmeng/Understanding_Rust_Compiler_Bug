{"sha": "b0d4f092010a0867be8b396929a2428d5c44c6d4", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIwZDRmMDkyMDEwYTA4NjdiZThiMzk2OTI5YTI0MjhkNWM0NGM2ZDQ=", "commit": {"author": {"name": "Michael Sullivan", "email": "sully@msully.net", "date": "2012-07-05T21:38:38Z"}, "committer": {"name": "Michael Sullivan", "email": "sully@msully.net", "date": "2012-07-05T21:48:23Z"}, "message": "Consider slices to be a structural type. Closes #2748.", "tree": {"sha": "bb477ca04f65d0c0a50411bc4c7284aabfce7d81", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bb477ca04f65d0c0a50411bc4c7284aabfce7d81"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b0d4f092010a0867be8b396929a2428d5c44c6d4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b0d4f092010a0867be8b396929a2428d5c44c6d4", "html_url": "https://github.com/rust-lang/rust/commit/b0d4f092010a0867be8b396929a2428d5c44c6d4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b0d4f092010a0867be8b396929a2428d5c44c6d4/comments", "author": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "committer": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7babcf55d7093ce5f26a4ac9dc1fad81b0db1cb7", "url": "https://api.github.com/repos/rust-lang/rust/commits/7babcf55d7093ce5f26a4ac9dc1fad81b0db1cb7", "html_url": "https://github.com/rust-lang/rust/commit/7babcf55d7093ce5f26a4ac9dc1fad81b0db1cb7"}], "stats": {"total": 27, "additions": 23, "deletions": 4}, "files": [{"sha": "cff52a8c1ddd197b173f2030d0a54819dee220be", "filename": "src/rustc/middle/trans/base.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b0d4f092010a0867be8b396929a2428d5c44c6d4/src%2Frustc%2Fmiddle%2Ftrans%2Fbase.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b0d4f092010a0867be8b396929a2428d5c44c6d4/src%2Frustc%2Fmiddle%2Ftrans%2Fbase.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fmiddle%2Ftrans%2Fbase.rs?ref=b0d4f092010a0867be8b396929a2428d5c44c6d4", "patch": "@@ -1369,7 +1369,7 @@ fn copy_val_no_check(bcx: block, action: copy_action, dst: ValueRef,\n     let _icx = bcx.insn_ctxt(\"copy_val_no_check\");\n     let ccx = bcx.ccx();\n     let mut bcx = bcx;\n-    if ty::type_is_scalar(t) || ty::type_is_slice(t) {\n+    if ty::type_is_scalar(t) {\n         Store(bcx, src, dst);\n         ret bcx;\n     }\n@@ -1401,7 +1401,7 @@ fn move_val(cx: block, action: copy_action, dst: ValueRef,\n     let mut src_val = src.val;\n     let tcx = cx.tcx();\n     let mut cx = cx;\n-    if ty::type_is_scalar(t) || ty::type_is_slice(t) {\n+    if ty::type_is_scalar(t) {\n         if src.kind == owned { src_val = Load(cx, src_val); }\n         Store(cx, src_val, dst);\n         ret cx;"}, {"sha": "298aecf4fd7dcd994e7ac363cc1fa8a7622896ba", "filename": "src/rustc/middle/ty.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b0d4f092010a0867be8b396929a2428d5c44c6d4/src%2Frustc%2Fmiddle%2Fty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b0d4f092010a0867be8b396929a2428d5c44c6d4/src%2Frustc%2Fmiddle%2Fty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fmiddle%2Fty.rs?ref=b0d4f092010a0867be8b396929a2428d5c44c6d4", "patch": "@@ -1074,8 +1074,10 @@ fn type_is_bool(ty: t) -> bool { get(ty).struct == ty_bool }\n fn type_is_structural(ty: t) -> bool {\n     alt get(ty).struct {\n       ty_rec(_) | ty_class(*) | ty_tup(_) | ty_enum(*) | ty_fn(_) |\n-      ty_trait(*) | ty_evec(_, vstore_fixed(_))\n-      | ty_estr(vstore_fixed(_)) { true }\n+      ty_trait(*) |\n+      ty_evec(_, vstore_fixed(_)) | ty_estr(vstore_fixed(_)) |\n+      ty_evec(_, vstore_slice(_)) | ty_estr(vstore_slice(_))\n+      { true }\n       _ { false }\n     }\n }"}, {"sha": "7f1d4a45b61d86c045cd8c53e67082846feeff4f", "filename": "src/test/run-pass/issue-2748-a.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/b0d4f092010a0867be8b396929a2428d5c44c6d4/src%2Ftest%2Frun-pass%2Fissue-2748-a.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b0d4f092010a0867be8b396929a2428d5c44c6d4/src%2Ftest%2Frun-pass%2Fissue-2748-a.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fissue-2748-a.rs?ref=b0d4f092010a0867be8b396929a2428d5c44c6d4", "patch": "@@ -0,0 +1,9 @@\n+class CMap/& {\n+    let buf: [u8]/&;\n+\n+    new(buf: [u8]/&) {\n+        self.buf = buf;\n+    }\n+}\n+\n+fn main() { }"}, {"sha": "a1bcdc5cd5d69ccb80819f12a88264df8df328c0", "filename": "src/test/run-pass/issue-2748-b.rs", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/b0d4f092010a0867be8b396929a2428d5c44c6d4/src%2Ftest%2Frun-pass%2Fissue-2748-b.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b0d4f092010a0867be8b396929a2428d5c44c6d4/src%2Ftest%2Frun-pass%2Fissue-2748-b.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fissue-2748-b.rs?ref=b0d4f092010a0867be8b396929a2428d5c44c6d4", "patch": "@@ -0,0 +1,8 @@\n+fn thing(x: &[int]) -> &[int] { x }\n+fn main() {\n+    let x = &[1,2,3];\n+    let y = x;\n+    let z = thing(x);\n+    assert(z[2] == x[2]);\n+    assert(z[1] == y[1]);\n+}"}]}