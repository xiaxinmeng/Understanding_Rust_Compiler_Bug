{"sha": "273ddafac59869d35dc654be79e89b0c33b33569", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI3M2RkYWZhYzU5ODY5ZDM1ZGM2NTRiZTc5ZTg5YjBjMzNiMzM1Njk=", "commit": {"author": {"name": "Oliver Schneider", "email": "git-spam-no-reply9815368754983@oli-obk.de", "date": "2017-11-29T16:20:00Z"}, "committer": {"name": "Oliver Schneider", "email": "git-spam-no-reply9815368754983@oli-obk.de", "date": "2017-11-29T16:20:00Z"}, "message": "Fix #2188", "tree": {"sha": "4d0061365983183e04e928fa2ae6a4847f8aa6f8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4d0061365983183e04e928fa2ae6a4847f8aa6f8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/273ddafac59869d35dc654be79e89b0c33b33569", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEYFTdM4NKd7XQft77pp+NIls619kFAloe3jAACgkQpp+NIls6\n19mJexAAow1FPVIIZkW6UL0CrNbeqnhjaYaYB6lHwS2AN003WKkbwFFiL+plV446\nq4H97nhPLGfXWOc4GRbKDJMKqBmm1Ig+7tUIkiZbL1PpzS2GyW0A6k14T73L+IAE\nII6fqG3BsPsqXigaZNrPEiXazd8FOLbIW7DD3OLwzB7xIBHwtkK5I7Rb1mMTbBSK\nhfrEjW5AwAVRWRHIdQ84GOb8a6zLMM8+OllCqSFRnX5+rEdfsmsshx/cMotBFurE\n9JNYL/OfpvV15FuNz1otewP3dp/oOpVKVrIVf+PPpsNO4nThKS/6oHodrlmtCRHa\nU/SA7nrxkDLP9ITfg3Ig5GfkxmahhSYPeLXqE3PJ7WryBlpE9yPdSnY/99wnzLes\nLMmRuyxo/Oh80Q9Ln3e9zcjYhZjCUrzxgPmYCld7pkvQRWdCRVGuHGLybspSACZN\ndx3N7QoJLOLTh3dnEvwW6aePzb9ZOcKDwKbJ60gA/TTjQxGrD5Js27NUuqIPelxs\n1cNFBoebu8lh1KNpuvYzU7Mz4nvtDOiBQlM+43L5FaNfkSqssTpKbUU0mT2Fdjbk\nncjAuGEHYHUqNwW6+SzMfKIXiPD/Y5hEZfl0I5HCzcp3Y7L0d9Qd155eIiHpmw86\nESEKVS7cPBtn1PayFqdOFatWAT+ME7l50Ssm+o0nGO3Q1Z5eCPk=\n=Yi2K\n-----END PGP SIGNATURE-----", "payload": "tree 4d0061365983183e04e928fa2ae6a4847f8aa6f8\nparent d5b73c184b31f90ae0ef299e109d87225f139d5e\nauthor Oliver Schneider <git-spam-no-reply9815368754983@oli-obk.de> 1511972400 +0100\ncommitter Oliver Schneider <git-spam-no-reply9815368754983@oli-obk.de> 1511972400 +0100\n\nFix #2188\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/273ddafac59869d35dc654be79e89b0c33b33569", "html_url": "https://github.com/rust-lang/rust/commit/273ddafac59869d35dc654be79e89b0c33b33569", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/273ddafac59869d35dc654be79e89b0c33b33569/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d5b73c184b31f90ae0ef299e109d87225f139d5e", "url": "https://api.github.com/repos/rust-lang/rust/commits/d5b73c184b31f90ae0ef299e109d87225f139d5e", "html_url": "https://github.com/rust-lang/rust/commit/d5b73c184b31f90ae0ef299e109d87225f139d5e"}], "stats": {"total": 17, "additions": 16, "deletions": 1}, "files": [{"sha": "5b9830ad0ab8b0e76ad753d238fa7490e17854cf", "filename": "clippy_lints/src/fallible_impl_from.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/273ddafac59869d35dc654be79e89b0c33b33569/clippy_lints%2Fsrc%2Ffallible_impl_from.rs", "raw_url": "https://github.com/rust-lang/rust/raw/273ddafac59869d35dc654be79e89b0c33b33569/clippy_lints%2Fsrc%2Ffallible_impl_from.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Ffallible_impl_from.rs?ref=273ddafac59869d35dc654be79e89b0c33b33569", "patch": "@@ -2,7 +2,7 @@ use rustc::lint::*;\n use rustc::hir;\n use rustc::ty;\n use syntax_pos::Span;\n-use utils::{match_def_path, method_chain_args, span_lint_and_then, walk_ptrs_ty};\n+use utils::{match_def_path, method_chain_args, span_lint_and_then, walk_ptrs_ty, is_expn_of};\n use utils::paths::{BEGIN_PANIC, BEGIN_PANIC_FMT, FROM_TRAIT, OPTION, RESULT};\n \n /// **What it does:** Checks for impls of `From<..>` that contain `panic!()` or `unwrap()`\n@@ -66,6 +66,7 @@ fn lint_impl_body<'a, 'tcx>(cx: &LateContext<'a, 'tcx>, impl_span: Span, impl_it\n                 if let ExprPath(QPath::Resolved(_, ref path)) = func_expr.node;\n                 if match_def_path(self.tcx, path.def.def_id(), &BEGIN_PANIC) ||\n                     match_def_path(self.tcx, path.def.def_id(), &BEGIN_PANIC_FMT);\n+                if is_expn_of(expr.span, \"unreachable\").is_none();\n                 then {\n                     self.result.push(expr.span);\n                 }"}, {"sha": "db11891907130fa01c980e1b2f1629e781b84116", "filename": "tests/ui/fallible_impl_from.rs", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/273ddafac59869d35dc654be79e89b0c33b33569/tests%2Fui%2Ffallible_impl_from.rs", "raw_url": "https://github.com/rust-lang/rust/raw/273ddafac59869d35dc654be79e89b0c33b33569/tests%2Fui%2Ffallible_impl_from.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ffallible_impl_from.rs?ref=273ddafac59869d35dc654be79e89b0c33b33569", "patch": "@@ -61,4 +61,18 @@ impl<'a> From<&'a mut <Box<u32> as ProjStrTrait>::ProjString> for Invalid {\n     }\n }\n \n+struct Unreachable;\n+\n+impl From<String> for Unreachable {\n+    fn from(s: String) -> Unreachable {\n+        if s.is_empty() {\n+            return Unreachable;\n+        }\n+        match s.chars().next() {\n+            Some(_) => Unreachable,\n+            None => unreachable!(), // do not lint the unreachable macro\n+        }\n+    }\n+}\n+\n fn main() {}"}]}