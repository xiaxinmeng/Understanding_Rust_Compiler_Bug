{"sha": "b608e02e1cedb99ee8a069e3647dde5316b41968", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI2MDhlMDJlMWNlZGI5OWVlOGEwNjllMzY0N2RkZTUzMTZiNDE5Njg=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-08-03T19:24:50Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-08-03T19:24:50Z"}, "message": "Doctests: Enable running doc tests for restriction lints", "tree": {"sha": "7fb14941b4ff4bc42bec5138e1919e24a4a065ad", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7fb14941b4ff4bc42bec5138e1919e24a4a065ad"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b608e02e1cedb99ee8a069e3647dde5316b41968", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJEBAABCgAuFiEEj4U0bmbiMSg/mWqvgqphyqETl+YFAl1F35UQHGRldkBwaGFu\nc2NoLm5ldAAKCRCCqmHKoROX5gfeEACeSZ23Ci22NpT0ZsestosC5xheyK1eoNpG\nHUoERz7a4N19XgUQjNp7I7pVxXR4Qmfkxy6CZGPCJGCoZNojuZFvzNQnp24k861Y\nwgM6i9Prsdtoi1vIdYcN593wR56UXJCercNSMdqAyE56tUokfTP9mK4NSCvusljx\nYQzmMxDzzyk16ijMBc1/VIKdykhMx44EbvhqEyWg9H6mf2VOv/OLD1lesOFY1EM8\nNOQtj4eNlgaaJ676z84l2/V6LWIQ11hXmMxzI9O+HziOU0DZfvDcRj6LQJEIfC5H\neklNeRt0uwavZhhoTUJNJsABpitzgBBRRtN5U52Kadjhlz9QekbvrQxAxY+Kcjui\n4f6CWBzK6nEPo5PJ2PCS1Wh+NY2Zb4OPwYma00sM5+j8XlVyTwCE3VhkgTLdq7kA\nl/rILtGDxwMIwLiI0EVxbjA4VxwZJ7xkc349A6sgLfxEg6/kq6xQjOsfR0yFuqBY\nn1Ci/R93l4+V5/7nrEdmUhjfZE91/QQfhxAZpaRt0m2ZZMG6YpNzYRU9gMeldxMQ\nQzGsnmlaHuCE++YdckDwkrDXENzKlEu9l8YGuVn4CW5OQwpE6ExA1Smicz5ycjIP\nUbD+8SIlS7sVNKOqlUMIaeM7/hjjtZjut9bMfotyDiBo3J/raIKSiM7cx9B9X7JG\nx6EJWr9nIw==\n=lKsy\n-----END PGP SIGNATURE-----", "payload": "tree 7fb14941b4ff4bc42bec5138e1919e24a4a065ad\nparent 5c1e30ab05841af32e206c8111f5343be3475a90\nauthor Philipp Hansch <dev@phansch.net> 1564860290 +0200\ncommitter Philipp Hansch <dev@phansch.net> 1564860290 +0200\n\nDoctests: Enable running doc tests for restriction lints\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b608e02e1cedb99ee8a069e3647dde5316b41968", "html_url": "https://github.com/rust-lang/rust/commit/b608e02e1cedb99ee8a069e3647dde5316b41968", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b608e02e1cedb99ee8a069e3647dde5316b41968/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5c1e30ab05841af32e206c8111f5343be3475a90", "url": "https://api.github.com/repos/rust-lang/rust/commits/5c1e30ab05841af32e206c8111f5343be3475a90", "html_url": "https://github.com/rust-lang/rust/commit/5c1e30ab05841af32e206c8111f5343be3475a90"}], "stats": {"total": 73, "additions": 57, "deletions": 16}, "files": [{"sha": "9e0d114569e8af86572acb51e3e5a5a449c3e5be", "filename": "clippy_lints/src/arithmetic.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Farithmetic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Farithmetic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Farithmetic.rs?ref=b608e02e1cedb99ee8a069e3647dde5316b41968", "patch": "@@ -16,7 +16,8 @@ declare_clippy_lint! {\n     ///\n     /// **Example:**\n     /// ```rust\n-    /// a + 1\n+    /// # let a = 0;\n+    /// a + 1;\n     /// ```\n     pub INTEGER_ARITHMETIC,\n     restriction,\n@@ -33,7 +34,8 @@ declare_clippy_lint! {\n     ///\n     /// **Example:**\n     /// ```rust\n-    /// a + 1.0\n+    /// # let a = 0.0;\n+    /// a + 1.0;\n     /// ```\n     pub FLOAT_ARITHMETIC,\n     restriction,"}, {"sha": "6daf204a5f187587644bab1c255baba8de62b262", "filename": "clippy_lints/src/else_if_without_else.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Felse_if_without_else.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Felse_if_without_else.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Felse_if_without_else.rs?ref=b608e02e1cedb99ee8a069e3647dde5316b41968", "patch": "@@ -16,6 +16,9 @@ declare_clippy_lint! {\n     ///\n     /// **Example:**\n     /// ```rust\n+    /// # fn a() {}\n+    /// # fn b() {}\n+    /// # let x: i32 = 1;\n     /// if x.is_positive() {\n     ///     a();\n     /// } else if x.is_negative() {\n@@ -26,6 +29,9 @@ declare_clippy_lint! {\n     /// Could be written:\n     ///\n     /// ```rust\n+    /// # fn a() {}\n+    /// # fn b() {}\n+    /// # let x: i32 = 1;\n     /// if x.is_positive() {\n     ///     a();\n     /// } else if x.is_negative() {"}, {"sha": "06e5458c185efa25eab8ac50d9e1b634eb4a6f64", "filename": "clippy_lints/src/indexing_slicing.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Findexing_slicing.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Findexing_slicing.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Findexing_slicing.rs?ref=b608e02e1cedb99ee8a069e3647dde5316b41968", "patch": "@@ -47,7 +47,7 @@ declare_clippy_lint! {\n     /// **Known problems:** Hopefully none.\n     ///\n     /// **Example:**\n-    /// ```rust\n+    /// ```rust,no_run\n     /// // Vector\n     /// let x = vec![0; 5];\n     ///"}, {"sha": "ac983b5a28ae0daa9a63429c6a25a97ff4faef30", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=b608e02e1cedb99ee8a069e3647dde5316b41968", "patch": "@@ -115,7 +115,7 @@ macro_rules! declare_clippy_lint {\n     };\n     { $(#[$attr:meta])* pub $name:tt, restriction, $description:tt } => {\n         declare_tool_lint! {\n-            pub clippy::$name, Allow, $description, report_in_external_macro: true\n+            $(#[$attr])* pub clippy::$name, Allow, $description, report_in_external_macro: true\n         }\n     };\n     { $(#[$attr:meta])* pub $name:tt, cargo, $description:tt } => {"}, {"sha": "b0a4d2691cc395b3d3c97253de04989d94428bda", "filename": "clippy_lints/src/matches.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fmatches.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fmatches.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmatches.rs?ref=b608e02e1cedb99ee8a069e3647dde5316b41968", "patch": "@@ -205,6 +205,8 @@ declare_clippy_lint! {\n     ///\n     /// **Example:**\n     /// ```rust\n+    /// # enum Foo { A(usize), B(usize) }\n+    /// # let x = Foo::B(1);\n     /// match x {\n     ///     A => {},\n     ///     _ => {},"}, {"sha": "54b0a61937e7eb54f3bd3a3e0c571710828d4177", "filename": "clippy_lints/src/mem_forget.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fmem_forget.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fmem_forget.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmem_forget.rs?ref=b608e02e1cedb99ee8a069e3647dde5316b41968", "patch": "@@ -14,6 +14,8 @@ declare_clippy_lint! {\n     ///\n     /// **Example:**\n     /// ```rust\n+    /// # use std::mem;\n+    /// # use std::rc::Rc;\n     /// mem::forget(Rc::new(55))\n     /// ```\n     pub MEM_FORGET,"}, {"sha": "476bf3b5634ac85b2bec11c514da27841ea6214b", "filename": "clippy_lints/src/methods/mod.rs", "status": "modified", "additions": 30, "deletions": 6, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs?ref=b608e02e1cedb99ee8a069e3647dde5316b41968", "patch": "@@ -40,8 +40,19 @@ declare_clippy_lint! {\n     /// **Known problems:** None.\n     ///\n     /// **Example:**\n+    ///\n+    /// Using unwrap on an `Option`:\n+    ///\n     /// ```rust\n-    /// x.unwrap()\n+    /// let opt = Some(1);\n+    /// opt.unwrap();\n+    /// ```\n+    ///\n+    /// Better:\n+    ///\n+    /// ```rust\n+    /// let opt = Some(1);\n+    /// opt.expect(\"more helpful message\");\n     /// ```\n     pub OPTION_UNWRAP_USED,\n     restriction,\n@@ -62,8 +73,18 @@ declare_clippy_lint! {\n     /// **Known problems:** None.\n     ///\n     /// **Example:**\n+    /// Using unwrap on an `Option`:\n+    ///\n     /// ```rust\n-    /// x.unwrap()\n+    /// let res: Result<usize, ()> = Ok(1);\n+    /// res.unwrap();\n+    /// ```\n+    ///\n+    /// Better:\n+    ///\n+    /// ```rust\n+    /// let res: Result<usize, ()> = Ok(1);\n+    /// res.expect(\"more helpful message\");\n     /// ```\n     pub RESULT_UNWRAP_USED,\n     restriction,\n@@ -141,9 +162,10 @@ declare_clippy_lint! {\n     ///\n     /// **Example:**\n     /// ```rust\n-    /// impl X {\n-    ///     pub fn as_str(self) -> &str {\n-    ///         ..\n+    /// # struct X;\n+    /// impl<'a> X {\n+    ///     pub fn as_str(self) -> &'a str {\n+    ///         \"foo\"\n     ///     }\n     /// }\n     /// ```\n@@ -467,7 +489,9 @@ declare_clippy_lint! {\n     ///\n     /// **Example:**\n     /// ```rust\n-    /// x.clone()\n+    /// # use std::rc::Rc;\n+    /// let x = Rc::new(1);\n+    /// x.clone();\n     /// ```\n     pub CLONE_ON_REF_PTR,\n     restriction,"}, {"sha": "f8a24982934c736485934c98b786aa327b2b7e34", "filename": "clippy_lints/src/misc.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fmisc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fmisc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmisc.rs?ref=b608e02e1cedb99ee8a069e3647dde5316b41968", "patch": "@@ -226,8 +226,9 @@ declare_clippy_lint! {\n     ///\n     /// **Example:**\n     /// ```rust\n-    /// const ONE = 1.00f64;\n-    /// x == ONE  // where both are floats\n+    /// let x: f64 = 1.0;\n+    /// const ONE: f64 = 1.00;\n+    /// x == ONE;  // where both are floats\n     /// ```\n     pub FLOAT_CMP_CONST,\n     restriction,"}, {"sha": "115bde34480685adbd220ec835b0bb935955f5e3", "filename": "clippy_lints/src/missing_inline.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fmissing_inline.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fmissing_inline.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmissing_inline.rs?ref=b608e02e1cedb99ee8a069e3647dde5316b41968", "patch": "@@ -33,7 +33,7 @@ declare_clippy_lint! {\n     ///\n     /// struct Baz;\n     /// impl Baz {\n-    ///    fn priv() {} // ok\n+    ///    fn private() {} // ok\n     /// }\n     ///\n     /// impl Bar for Baz {\n@@ -42,8 +42,8 @@ declare_clippy_lint! {\n     ///\n     /// pub struct PubBaz;\n     /// impl PubBaz {\n-    ///    fn priv() {} // ok\n-    ///    pub not_ptriv() {} // missing #[inline]\n+    ///    fn private() {} // ok\n+    ///    pub fn not_ptrivate() {} // missing #[inline]\n     /// }\n     ///\n     /// impl Bar for PubBaz {"}, {"sha": "b5413b388b65dcde50f40b8d7a53746d6e58b22b", "filename": "clippy_lints/src/shadow.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fshadow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fshadow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fshadow.rs?ref=b608e02e1cedb99ee8a069e3647dde5316b41968", "patch": "@@ -20,6 +20,7 @@ declare_clippy_lint! {\n     ///\n     /// **Example:**\n     /// ```rust\n+    /// # let x = 1;\n     /// let x = &x;\n     /// ```\n     pub SHADOW_SAME,\n@@ -41,10 +42,12 @@ declare_clippy_lint! {\n     ///\n     /// **Example:**\n     /// ```rust\n+    /// let x = 2;\n     /// let x = x + 1;\n     /// ```\n     /// use different variable name:\n     /// ```rust\n+    /// let x = 2;\n     /// let y = x + 1;\n     /// ```\n     pub SHADOW_REUSE,"}, {"sha": "0de63b5ff3e568da2fc9c2da15373ca6d370c9c0", "filename": "clippy_lints/src/strings.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fstrings.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fstrings.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fstrings.rs?ref=b608e02e1cedb99ee8a069e3647dde5316b41968", "patch": "@@ -48,7 +48,7 @@ declare_clippy_lint! {\n     ///\n     /// ```rust\n     /// let x = \"Hello\".to_owned();\n-    /// x + \", World\"\n+    /// x + \", World\";\n     /// ```\n     pub STRING_ADD,\n     restriction,"}, {"sha": "9e26b3e5b9c1317bf94df86b90d8be34345fa603", "filename": "clippy_lints/src/write.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fwrite.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b608e02e1cedb99ee8a069e3647dde5316b41968/clippy_lints%2Fsrc%2Fwrite.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fwrite.rs?ref=b608e02e1cedb99ee8a069e3647dde5316b41968", "patch": "@@ -77,6 +77,7 @@ declare_clippy_lint! {\n     ///\n     /// **Example:**\n     /// ```rust\n+    /// # let foo = \"bar\";\n     /// println!(\"{:?}\", foo);\n     /// ```\n     pub USE_DEBUG,"}]}