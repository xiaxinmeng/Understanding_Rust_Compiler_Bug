{"sha": "e0072e39a788ada2a636ab88a0b97534544c4125", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUwMDcyZTM5YTc4OGFkYTJhNjM2YWI4OGEwYjk3NTM0NTQ0YzQxMjU=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2012-12-20T01:24:19Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2012-12-20T01:24:19Z"}, "message": "doc: structure expressions. cc: #4217", "tree": {"sha": "5069851a182a02ab8e6bfe7bd309b175a65babaf", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5069851a182a02ab8e6bfe7bd309b175a65babaf"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e0072e39a788ada2a636ab88a0b97534544c4125", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e0072e39a788ada2a636ab88a0b97534544c4125", "html_url": "https://github.com/rust-lang/rust/commit/e0072e39a788ada2a636ab88a0b97534544c4125", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e0072e39a788ada2a636ab88a0b97534544c4125/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "46766974c73ff17a3b2cd4f2fb2cb06b7845ded4", "url": "https://api.github.com/repos/rust-lang/rust/commits/46766974c73ff17a3b2cd4f2fb2cb06b7845ded4", "html_url": "https://github.com/rust-lang/rust/commit/46766974c73ff17a3b2cd4f2fb2cb06b7845ded4"}], "stats": {"total": 39, "additions": 37, "deletions": 2}, "files": [{"sha": "c73211acef937ab4a481223560562000356671fe", "filename": "doc/rust.md", "status": "modified", "additions": 37, "deletions": 2, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/e0072e39a788ada2a636ab88a0b97534544c4125/doc%2Frust.md", "raw_url": "https://github.com/rust-lang/rust/raw/e0072e39a788ada2a636ab88a0b97534544c4125/doc%2Frust.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/doc%2Frust.md?ref=e0072e39a788ada2a636ab88a0b97534544c4125", "patch": "@@ -1503,6 +1503,39 @@ values.\n (\"a\", 4u, true);\n ~~~~~~~~\n \n+### Structure expressions\n+\n+~~~~~~~~{.ebnf .gram}\n+struct_expr : expr_path '{' ident ':' expr\n+                      [ ',' ident ':' expr ] *\n+                      [ \"..\" expr ] '}'\n+~~~~~~~~\n+\n+A _structure expression_ consists of the [path](#paths) of a [structure item](#structures),\n+followed by a brace-enclosed list of one or more comma-separated name-value pairs,\n+providing the field values of a new instance of the structure.\n+A field name can be any identifier, and is separated from its value expression by a colon.\n+To indicate that a field is mutable, the `mut` keyword is written before its name.\n+\n+The following are examples of structure expressions:\n+\n+~~~~\n+Point {x: 10f, y: 20f};\n+game::User {name: \"Joe\", age: 35u, mut score: 100_000};\n+~~~~\n+\n+A structure expression forms a new value of the named structure type.\n+\n+A structure expression can terminate with the syntax `..` followed by an expression to denote a functional update.\n+The expression following `..` (the base) must be of the same structure type as the new structure type being formed.\n+A new structure will be created, of the same type as the base expression, with the given values for the fields that were explicitly specified,\n+and the values in the base record for all other fields.\n+\n+~~~~\n+let base = Point3d {x: 1, y: 2, z: 3};\n+Point3d {y: 0, z: 10, .. base};\n+~~~~\n+\n ### Record expressions\n \n ~~~~~~~~{.ebnf .gram}\n@@ -1511,9 +1544,11 @@ rec_expr : '{' ident ':' expr\n                [ \"..\" expr ] '}'\n ~~~~~~~~\n \n+> **Note:** In future versions of Rust, record expressions and [record types](#record-types) will be removed.\n+\n A [_record_](#record-types) _expression_ is one or more comma-separated\n-name-value pairs enclosed by braces. A fieldname can be any identifier\n-(including keywords), and is separated from its value expression by a\n+name-value pairs enclosed by braces. A fieldname can be any identifier,\n+and is separated from its value expression by a\n colon. To indicate that a field is mutable, the `mut` keyword is\n written before its name.\n "}]}