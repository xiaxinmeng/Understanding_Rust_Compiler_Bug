{"sha": "a63696dfe2bd47d34925a3ad44db9d2ede949e36", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE2MzY5NmRmZTJiZDQ3ZDM0OTI1YTNhZDQ0ZGI5ZDJlZGU5NDllMzY=", "commit": {"author": {"name": "Rafael Avila de Espindola", "email": "espindola@dream.(none)", "date": "2011-02-16T20:34:59Z"}, "committer": {"name": "Rafael Avila de Espindola", "email": "espindola@dream.(none)", "date": "2011-02-16T20:34:59Z"}, "message": "Add a more specialized decl_native_fn_and_pair. Native functions now have\nthe right name.", "tree": {"sha": "5b7fa9de6a7df5c3fac02ca5301fdcf82ad1a9eb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5b7fa9de6a7df5c3fac02ca5301fdcf82ad1a9eb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a63696dfe2bd47d34925a3ad44db9d2ede949e36", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a63696dfe2bd47d34925a3ad44db9d2ede949e36", "html_url": "https://github.com/rust-lang/rust/commit/a63696dfe2bd47d34925a3ad44db9d2ede949e36", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a63696dfe2bd47d34925a3ad44db9d2ede949e36/comments", "author": null, "committer": null, "parents": [{"sha": "293637139fe55990397849badfb60c96d4211b31", "url": "https://api.github.com/repos/rust-lang/rust/commits/293637139fe55990397849badfb60c96d4211b31", "html_url": "https://github.com/rust-lang/rust/commit/293637139fe55990397849badfb60c96d4211b31"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "544075faf15c5f25746ef23f32bf870d080b1751", "filename": "src/Makefile", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a63696dfe2bd47d34925a3ad44db9d2ede949e36/src%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/a63696dfe2bd47d34925a3ad44db9d2ede949e36/src%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2FMakefile?ref=a63696dfe2bd47d34925a3ad44db9d2ede949e36", "patch": "@@ -507,6 +507,7 @@ TEST_XFAILS_RUSTC := $(filter-out \\\n                         linear-for-loop.rs \\\n                         multiline-comment.rs \\\n                         mutual-recursion-group.rs \\\n+                        native2.rs \\\n                         obj-drop.rs \\\n                         obj-recursion.rs \\\n                         obj-with-vec.rs \\"}, {"sha": "94fa9f9105e5ce14f42a652134e7eda344ffd8cb", "filename": "src/comp/middle/trans.rs", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/a63696dfe2bd47d34925a3ad44db9d2ede949e36/src%2Fcomp%2Fmiddle%2Ftrans.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a63696dfe2bd47d34925a3ad44db9d2ede949e36/src%2Fcomp%2Fmiddle%2Ftrans.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Ftrans.rs?ref=a63696dfe2bd47d34925a3ad44db9d2ede949e36", "patch": "@@ -4062,12 +4062,24 @@ fn decl_fn_and_pair(@crate_ctxt cx,\n     cx.fn_pairs.insert(id, gvar);\n }\n \n+fn decl_native_fn_and_pair(@crate_ctxt cx,\n+                           str name,\n+                           &ast.ann ann,\n+                           ast.def_id id) {\n+\n+    auto llpairty = node_type(cx, ann);\n+    auto llfty = get_pair_fn_ty(llpairty);\n+\n+    let ValueRef llfn = decl_fastcall_fn(cx.llmod, name, llfty);\n+    cx.item_ids.insert(id, llfn);\n+}\n+\n fn collect_native_item(&@crate_ctxt cx, @ast.native_item i) -> @crate_ctxt {\n     alt (i.node) {\n         case (ast.native_item_fn(?name, _, _, ?fid, ?ann)) {\n             cx.native_items.insert(fid, i);\n             if (! cx.obj_methods.contains_key(fid)) {\n-                decl_fn_and_pair(cx, \"fn\", name, ann, fid);\n+                decl_native_fn_and_pair(cx, name, ann, fid);\n             }\n         }\n         case (_) { /* fall through */ }"}]}