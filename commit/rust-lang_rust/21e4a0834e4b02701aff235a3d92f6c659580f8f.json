{"sha": "21e4a0834e4b02701aff235a3d92f6c659580f8f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIxZTRhMDgzNGU0YjAyNzAxYWZmMjM1YTNkOTJmNmM2NTk1ODBmOGY=", "commit": {"author": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2018-07-25T13:40:43Z"}, "committer": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2018-07-25T13:40:43Z"}, "message": "Nit: improve comment in hr-fn-aau-eq-abu.rs", "tree": {"sha": "8972a6ff4c991bc041b4f647f4a216dde15a75e5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8972a6ff4c991bc041b4f647f4a216dde15a75e5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/21e4a0834e4b02701aff235a3d92f6c659580f8f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/21e4a0834e4b02701aff235a3d92f6c659580f8f", "html_url": "https://github.com/rust-lang/rust/commit/21e4a0834e4b02701aff235a3d92f6c659580f8f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/21e4a0834e4b02701aff235a3d92f6c659580f8f/comments", "author": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3171cbe9867485d1902d8ee3e6e6014291dce396", "url": "https://api.github.com/repos/rust-lang/rust/commits/3171cbe9867485d1902d8ee3e6e6014291dce396", "html_url": "https://github.com/rust-lang/rust/commit/3171cbe9867485d1902d8ee3e6e6014291dce396"}], "stats": {"total": 20, "additions": 10, "deletions": 10}, "files": [{"sha": "9b8268d9736aad949fd3237dced69bd5624669f5", "filename": "src/test/ui/nll/relate_tys/hr-fn-aau-eq-abu.rs", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/21e4a0834e4b02701aff235a3d92f6c659580f8f/src%2Ftest%2Fui%2Fnll%2Frelate_tys%2Fhr-fn-aau-eq-abu.rs", "raw_url": "https://github.com/rust-lang/rust/raw/21e4a0834e4b02701aff235a3d92f6c659580f8f/src%2Ftest%2Fui%2Fnll%2Frelate_tys%2Fhr-fn-aau-eq-abu.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnll%2Frelate_tys%2Fhr-fn-aau-eq-abu.rs?ref=21e4a0834e4b02701aff235a3d92f6c659580f8f", "patch": "@@ -8,12 +8,16 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-// Test an interesting corner case: a fn that takes two arguments that\n-// are references with the same lifetime is in fact equivalent to a fn\n-// that takes two references with distinct lifetimes. This is true\n-// because the two functions can call one another -- effectively, the\n-// single lifetime `'a` is just inferred to be the intersection of the\n-// two distinct lifetimes.\n+// Test an interesting corner case that ought to be legal (though the\n+// current code actually gets it wrong, see below): a fn that takes\n+// two arguments that are references with the same lifetime is in fact\n+// equivalent to a fn that takes two references with distinct\n+// lifetimes. This is true because the two functions can call one\n+// another -- effectively, the single lifetime `'a` is just inferred\n+// to be the intersection of the two distinct lifetimes.\n+//\n+// FIXME: However, we currently reject this example with an error,\n+// because of how we handle binders and equality in `relate_tys`.\n //\n // compile-flags:-Zno-leak-check\n \n@@ -28,10 +32,6 @@ fn make_cell_aa() -> Cell<for<'a> fn(&'a u32, &'a u32)> {\n fn aa_eq_ab() {\n     let a: Cell<for<'a, 'b> fn(&'a u32, &'b u32)> = make_cell_aa();\n     //~^ ERROR higher-ranked subtype error\n-    //\n-    // FIXME -- this .. arguably ought to be accepted. However, the\n-    // current leak check also rejects this example, and it's kind of\n-    // a pain to support it. There are some comments in `relate_tys`\n     drop(a);\n }\n "}]}