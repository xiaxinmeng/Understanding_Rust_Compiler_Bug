{"sha": "09165ff5761bb1f397e37ee2d32d96adf7afdd86", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA5MTY1ZmY1NzYxYmIxZjM5N2UzN2VlMmQzMmQ5NmFkZjdhZmRkODY=", "commit": {"author": {"name": "Yuki Okushi", "email": "huyuumi.dev@gmail.com", "date": "2020-02-16T20:44:38Z"}, "committer": {"name": "Yuki Okushi", "email": "huyuumi.dev@gmail.com", "date": "2020-02-17T02:13:42Z"}, "message": "Don't lint `single_component_path_imports` in macros", "tree": {"sha": "0dbf995bade7922b13f6b45643881c91a9650304", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0dbf995bade7922b13f6b45643881c91a9650304"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/09165ff5761bb1f397e37ee2d32d96adf7afdd86", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/09165ff5761bb1f397e37ee2d32d96adf7afdd86", "html_url": "https://github.com/rust-lang/rust/commit/09165ff5761bb1f397e37ee2d32d96adf7afdd86", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/09165ff5761bb1f397e37ee2d32d96adf7afdd86/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "578960d61dbc01ff2db05ea818e41414a7acc12e", "url": "https://api.github.com/repos/rust-lang/rust/commits/578960d61dbc01ff2db05ea818e41414a7acc12e", "html_url": "https://github.com/rust-lang/rust/commit/578960d61dbc01ff2db05ea818e41414a7acc12e"}], "stats": {"total": 21, "additions": 20, "deletions": 1}, "files": [{"sha": "5a9bc73fe42b2d78b0b3abcef2cfeecf31fd78c7", "filename": "clippy_lints/src/single_component_path_imports.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/09165ff5761bb1f397e37ee2d32d96adf7afdd86/clippy_lints%2Fsrc%2Fsingle_component_path_imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/09165ff5761bb1f397e37ee2d32d96adf7afdd86/clippy_lints%2Fsrc%2Fsingle_component_path_imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fsingle_component_path_imports.rs?ref=09165ff5761bb1f397e37ee2d32d96adf7afdd86", "patch": "@@ -1,4 +1,4 @@\n-use crate::utils::span_lint_and_sugg;\n+use crate::utils::{in_macro, span_lint_and_sugg};\n use if_chain::if_chain;\n use rustc_errors::Applicability;\n use rustc_lint::{EarlyContext, EarlyLintPass};\n@@ -39,6 +39,7 @@ declare_lint_pass!(SingleComponentPathImports => [SINGLE_COMPONENT_PATH_IMPORTS]\n impl EarlyLintPass for SingleComponentPathImports {\n     fn check_item(&mut self, cx: &EarlyContext<'_>, item: &Item) {\n         if_chain! {\n+            if !in_macro(item.span);\n             if cx.sess.opts.edition == Edition::Edition2018;\n             if !item.vis.node.is_pub();\n             if let ItemKind::Use(use_tree) = &item.kind;"}, {"sha": "9095069b09399eda7f49ca6c55c1e95bba685719", "filename": "tests/ui/single_component_path_imports.fixed", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/09165ff5761bb1f397e37ee2d32d96adf7afdd86/tests%2Fui%2Fsingle_component_path_imports.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/09165ff5761bb1f397e37ee2d32d96adf7afdd86/tests%2Fui%2Fsingle_component_path_imports.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsingle_component_path_imports.fixed?ref=09165ff5761bb1f397e37ee2d32d96adf7afdd86", "patch": "@@ -7,6 +7,15 @@\n use serde as edres;\n pub use serde;\n \n+macro_rules! m {\n+    () => {\n+        use regex;\n+    };\n+}\n+\n fn main() {\n     regex::Regex::new(r\"^\\d{4}-\\d{2}-\\d{2}$\").unwrap();\n+\n+    // False positive #5154, shouldn't trigger lint.\n+    m!();\n }"}, {"sha": "1ebb3ee59b8bf219f047ae45e6cbe51fc4cb5353", "filename": "tests/ui/single_component_path_imports.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/09165ff5761bb1f397e37ee2d32d96adf7afdd86/tests%2Fui%2Fsingle_component_path_imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/09165ff5761bb1f397e37ee2d32d96adf7afdd86/tests%2Fui%2Fsingle_component_path_imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsingle_component_path_imports.rs?ref=09165ff5761bb1f397e37ee2d32d96adf7afdd86", "patch": "@@ -7,6 +7,15 @@ use regex;\n use serde as edres;\n pub use serde;\n \n+macro_rules! m {\n+    () => {\n+        use regex;\n+    };\n+}\n+\n fn main() {\n     regex::Regex::new(r\"^\\d{4}-\\d{2}-\\d{2}$\").unwrap();\n+\n+    // False positive #5154, shouldn't trigger lint.\n+    m!();\n }"}]}