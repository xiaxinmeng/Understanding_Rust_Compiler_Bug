{"sha": "c906759807dfe106c7c59f939c7be492b4f16d8f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM5MDY3NTk4MDdkZmUxMDZjN2M1OWY5MzljN2JlNDkyYjRmMTZkOGY=", "commit": {"author": {"name": "Roy Frostig", "email": "rfrostig@mozilla.com", "date": "2010-07-17T01:04:34Z"}, "committer": {"name": "Roy Frostig", "email": "rfrostig@mozilla.com", "date": "2010-07-17T01:04:34Z"}, "message": "Fix IL translation of pattern-alt to allow a value of mutable/constrained type to be the subject of a pattern-alt.", "tree": {"sha": "2f4218336824218c41315381863b59a81ea309c5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2f4218336824218c41315381863b59a81ea309c5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c906759807dfe106c7c59f939c7be492b4f16d8f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c906759807dfe106c7c59f939c7be492b4f16d8f", "html_url": "https://github.com/rust-lang/rust/commit/c906759807dfe106c7c59f939c7be492b4f16d8f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c906759807dfe106c7c59f939c7be492b4f16d8f/comments", "author": {"login": "froystig", "id": 123903, "node_id": "MDQ6VXNlcjEyMzkwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/123903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/froystig", "html_url": "https://github.com/froystig", "followers_url": "https://api.github.com/users/froystig/followers", "following_url": "https://api.github.com/users/froystig/following{/other_user}", "gists_url": "https://api.github.com/users/froystig/gists{/gist_id}", "starred_url": "https://api.github.com/users/froystig/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/froystig/subscriptions", "organizations_url": "https://api.github.com/users/froystig/orgs", "repos_url": "https://api.github.com/users/froystig/repos", "events_url": "https://api.github.com/users/froystig/events{/privacy}", "received_events_url": "https://api.github.com/users/froystig/received_events", "type": "User", "site_admin": false}, "committer": {"login": "froystig", "id": 123903, "node_id": "MDQ6VXNlcjEyMzkwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/123903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/froystig", "html_url": "https://github.com/froystig", "followers_url": "https://api.github.com/users/froystig/followers", "following_url": "https://api.github.com/users/froystig/following{/other_user}", "gists_url": "https://api.github.com/users/froystig/gists{/gist_id}", "starred_url": "https://api.github.com/users/froystig/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/froystig/subscriptions", "organizations_url": "https://api.github.com/users/froystig/orgs", "repos_url": "https://api.github.com/users/froystig/repos", "events_url": "https://api.github.com/users/froystig/events{/privacy}", "received_events_url": "https://api.github.com/users/froystig/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1ac01e16cf8d85334c25d68fc31db1beac740fc0", "url": "https://api.github.com/repos/rust-lang/rust/commits/1ac01e16cf8d85334c25d68fc31db1beac740fc0", "html_url": "https://github.com/rust-lang/rust/commit/1ac01e16cf8d85334c25d68fc31db1beac740fc0"}], "stats": {"total": 13, "additions": 7, "deletions": 6}, "files": [{"sha": "fec0d6ee41fd6edb759a046d23b04aa2182333a7", "filename": "src/boot/me/trans.ml", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/c906759807dfe106c7c59f939c7be492b4f16d8f/src%2Fboot%2Fme%2Ftrans.ml", "raw_url": "https://github.com/rust-lang/rust/raw/c906759807dfe106c7c59f939c7be492b4f16d8f/src%2Fboot%2Fme%2Ftrans.ml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fboot%2Fme%2Ftrans.ml?ref=c906759807dfe106c7c59f939c7be492b4f16d8f", "patch": "@@ -3961,7 +3961,7 @@ let trans_visitor\n           | Ast.PAT_tag (lval, pats) ->\n               let tag_name = tag_ctor_name_to_tag_name (lval_to_name lval) in\n               let ty_tag =\n-                match src_ty with\n+                match strip_mutable_or_constrained_ty src_ty with\n                     Ast.TY_tag tag_ty -> tag_ty\n                   | Ast.TY_iso ti -> (ti.Ast.iso_group).(ti.Ast.iso_index)\n                   | _ -> bug cx \"expected tag type\"\n@@ -4009,8 +4009,8 @@ let trans_visitor\n           | Ast.PAT_wild -> []    (* irrefutable *)\n       in\n \n-      let (lval_cell, lval_slot) = trans_lval at.Ast.alt_tag_lval in\n-      let next_jumps = trans_pat pat lval_cell lval_slot in\n+      let (lval_cell, lval_ty) = trans_lval at.Ast.alt_tag_lval in\n+      let next_jumps = trans_pat pat lval_cell lval_ty in\n         trans_block block;\n         let last_jump = mark() in\n           emit (Il.jmp Il.JMP Il.CodeNone);"}, {"sha": "14047f446e346335b90e34c74a42976aea5bd478", "filename": "src/boot/me/type.ml", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/c906759807dfe106c7c59f939c7be492b4f16d8f/src%2Fboot%2Fme%2Ftype.ml", "raw_url": "https://github.com/rust-lang/rust/raw/c906759807dfe106c7c59f939c7be492b4f16d8f/src%2Fboot%2Fme%2Ftype.ml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fboot%2Fme%2Ftype.ml?ref=c906759807dfe106c7c59f939c7be492b4f16d8f", "patch": "@@ -390,15 +390,16 @@ let check_stmt (cx:Semant.ctxt) : (fn_ctx -> Ast.stmt -> unit) =\n               Ast.sprintf_ty ty\n \n         | `Module items, Ast.COMP_named ((Ast.COMP_ident id) as name_comp)\n-              | `Module items, Ast.COMP_named ((Ast.COMP_app (id, _))\n-                as name_comp) ->\n+        | `Module items, Ast.COMP_named ((Ast.COMP_app (id, _))\n+                                           as name_comp) ->\n             let mod_item =\n               try\n                 Hashtbl.find items id\n               with Not_found ->\n                 Common.bug\n                   ()\n-                  \"internal_check_ext_lval: ident not found in mod item\"\n+                  \"internal_check_ext_lval: ident %s not found in mod item\"\n+                  id\n             in\n             let lty =\n               internal_check_mod_item_decl"}]}