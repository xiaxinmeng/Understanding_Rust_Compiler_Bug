{"sha": "fa1e34fbaf5a21d6ddc677c280ff8510b471bb96", "node_id": "C_kwDOAAsO6NoAKGZhMWUzNGZiYWY1YTIxZDZkZGM2NzdjMjgwZmY4NTEwYjQ3MWJiOTY", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-12-23T00:17:52Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-12-23T00:17:52Z"}, "message": "Rollup merge of #106059 - jyn514:setup-twice, r=Nilstrieb\n\nAvoid running the `Profile` step twice on `x setup`\n\nPrevents runs like the following:\n```\n$ x setup\nWelcome to the Rust project! What do you want to do with x.py?\na) library: Contribute to the standard library\nb) compiler: Contribute to the compiler itself\nc) codegen: Contribute to the compiler, and also modify LLVM or codegen\nd) tools: Contribute to tools which depend on the compiler, but do not modify it directly (e.g. rustdoc, clippy, miri)\ne) user: Install Rust from source\nPlease choose one (a/b/c/d/e): b\n\nTo get started, try one of the following commands:\n- `x.py check`\n- `x.py build`\n- `x.py test`\nFor more suggestions, see https://rustc-dev-guide.rust-lang.org/building/suggested.html\n`x.py` will now use the configuration at /home/nilsh/projects/rustfast/src/bootstrap/defaults/config.compiler.toml\nWelcome to the Rust project! What do you want to do with x.py?\n...\n```\n\nr? `@Nilstrieb`", "tree": {"sha": "4cbd9a5fb5c227eec30174ce198c4592cd8bf80d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4cbd9a5fb5c227eec30174ce198c4592cd8bf80d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fa1e34fbaf5a21d6ddc677c280ff8510b471bb96", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjpPOwCRBK7hj4Ov3rIwAAYdMIAFhFTW0JU4TcD+H10CzaDMrv\n6h/x48QouP4OoGPgI4BR26S6YRG47nE8jv78K0VMf8oTVxuIQt5xWTw2NptLbZ+l\nWeKRUIdFVgp8SsmYsTifJ9G7/PlY7r/k6Fs9QvH+X1PxFk/s1X+EDtKzrxD+iuPo\n9+IKOkQfcW2M3cixaCo5WE/V2QZuUX25aW6mKSkvy7/+rve7uYE6fCmk0rJEjqp2\nk3Y4lCJqdFNRa780we4O2sgYJazcqQEgUJ0/GHi69CXwWXPUrPfRabAK53LGmJfl\nCfGCdRyL39G7ficHNXCFWJFB7rcXwRGTqs2ogtpFlBIMrNWZ4o6Jg0lOMfikRbw=\n=4dnK\n-----END PGP SIGNATURE-----\n", "payload": "tree 4cbd9a5fb5c227eec30174ce198c4592cd8bf80d\nparent bbde21303a4cf07610df10d4ad938133c9754498\nparent 103816d704133fc954344d551af04cb333b03e94\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1671754672 +0100\ncommitter GitHub <noreply@github.com> 1671754672 +0100\n\nRollup merge of #106059 - jyn514:setup-twice, r=Nilstrieb\n\nAvoid running the `Profile` step twice on `x setup`\n\nPrevents runs like the following:\n```\n$ x setup\nWelcome to the Rust project! What do you want to do with x.py?\na) library: Contribute to the standard library\nb) compiler: Contribute to the compiler itself\nc) codegen: Contribute to the compiler, and also modify LLVM or codegen\nd) tools: Contribute to tools which depend on the compiler, but do not modify it directly (e.g. rustdoc, clippy, miri)\ne) user: Install Rust from source\nPlease choose one (a/b/c/d/e): b\n\nTo get started, try one of the following commands:\n- `x.py check`\n- `x.py build`\n- `x.py test`\nFor more suggestions, see https://rustc-dev-guide.rust-lang.org/building/suggested.html\n`x.py` will now use the configuration at /home/nilsh/projects/rustfast/src/bootstrap/defaults/config.compiler.toml\nWelcome to the Rust project! What do you want to do with x.py?\n...\n```\n\nr? `@Nilstrieb`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fa1e34fbaf5a21d6ddc677c280ff8510b471bb96", "html_url": "https://github.com/rust-lang/rust/commit/fa1e34fbaf5a21d6ddc677c280ff8510b471bb96", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fa1e34fbaf5a21d6ddc677c280ff8510b471bb96/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bbde21303a4cf07610df10d4ad938133c9754498", "url": "https://api.github.com/repos/rust-lang/rust/commits/bbde21303a4cf07610df10d4ad938133c9754498", "html_url": "https://github.com/rust-lang/rust/commit/bbde21303a4cf07610df10d4ad938133c9754498"}, {"sha": "103816d704133fc954344d551af04cb333b03e94", "url": "https://api.github.com/repos/rust-lang/rust/commits/103816d704133fc954344d551af04cb333b03e94", "html_url": "https://github.com/rust-lang/rust/commit/103816d704133fc954344d551af04cb333b03e94"}], "stats": {"total": 4, "additions": 4, "deletions": 0}, "files": [{"sha": "cd360cbef9654b3108d2c1100f6613c5039f6278", "filename": "src/bootstrap/setup.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fa1e34fbaf5a21d6ddc677c280ff8510b471bb96/src%2Fbootstrap%2Fsetup.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fa1e34fbaf5a21d6ddc677c280ff8510b471bb96/src%2Fbootstrap%2Fsetup.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fsetup.rs?ref=fa1e34fbaf5a21d6ddc677c280ff8510b471bb96", "patch": "@@ -96,6 +96,10 @@ impl Step for Profile {\n     }\n \n     fn make_run(run: RunConfig<'_>) {\n+        if run.builder.config.dry_run() {\n+            return;\n+        }\n+\n         // for Profile, `run.paths` will have 1 and only 1 element\n         // this is because we only accept at most 1 path from user input.\n         // If user calls `x.py setup` without arguments, the interactive TUI"}]}