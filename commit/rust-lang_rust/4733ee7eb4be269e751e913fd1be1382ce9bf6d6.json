{"sha": "4733ee7eb4be269e751e913fd1be1382ce9bf6d6", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ3MzNlZTdlYjRiZTI2OWU3NTFlOTEzZmQxYmUxMzgyY2U5YmY2ZDY=", "commit": {"author": {"name": "Corey Farwell", "email": "coreyf@rwell.org", "date": "2017-05-02T13:09:58Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-05-02T13:09:58Z"}, "message": "Rollup merge of #41692 - est31:anon_params, r=eddyb\n\nAdd a lint to disallow anonymous parameters\n\nAdds a (allow by default) lint to disallow anonymous parameters, like it was decided in RFC 1685 (rust-lang/rfcs#1685).\n\ncc tracking issue #41686", "tree": {"sha": "3fee4163ba5e6ad3ffb723e06d2db234a9a75391", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3fee4163ba5e6ad3ffb723e06d2db234a9a75391"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4733ee7eb4be269e751e913fd1be1382ce9bf6d6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4733ee7eb4be269e751e913fd1be1382ce9bf6d6", "html_url": "https://github.com/rust-lang/rust/commit/4733ee7eb4be269e751e913fd1be1382ce9bf6d6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4733ee7eb4be269e751e913fd1be1382ce9bf6d6/comments", "author": {"login": "frewsxcv", "id": 416575, "node_id": "MDQ6VXNlcjQxNjU3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/416575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frewsxcv", "html_url": "https://github.com/frewsxcv", "followers_url": "https://api.github.com/users/frewsxcv/followers", "following_url": "https://api.github.com/users/frewsxcv/following{/other_user}", "gists_url": "https://api.github.com/users/frewsxcv/gists{/gist_id}", "starred_url": "https://api.github.com/users/frewsxcv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frewsxcv/subscriptions", "organizations_url": "https://api.github.com/users/frewsxcv/orgs", "repos_url": "https://api.github.com/users/frewsxcv/repos", "events_url": "https://api.github.com/users/frewsxcv/events{/privacy}", "received_events_url": "https://api.github.com/users/frewsxcv/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7dbb93a39150aebdccb51321bc5872b15a204085", "url": "https://api.github.com/repos/rust-lang/rust/commits/7dbb93a39150aebdccb51321bc5872b15a204085", "html_url": "https://github.com/rust-lang/rust/commit/7dbb93a39150aebdccb51321bc5872b15a204085"}, {"sha": "6cc765dcad14e305f892398d16e270b480eb435b", "url": "https://api.github.com/repos/rust-lang/rust/commits/6cc765dcad14e305f892398d16e270b480eb435b", "html_url": "https://github.com/rust-lang/rust/commit/6cc765dcad14e305f892398d16e270b480eb435b"}], "stats": {"total": 69, "additions": 69, "deletions": 0}, "files": [{"sha": "c9ec152841b2025a1e57e8b09344355aba06a405", "filename": "src/librustc_lint/builtin.rs", "status": "modified", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/4733ee7eb4be269e751e913fd1be1382ce9bf6d6/src%2Flibrustc_lint%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4733ee7eb4be269e751e913fd1be1382ce9bf6d6/src%2Flibrustc_lint%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Fbuiltin.rs?ref=4733ee7eb4be269e751e913fd1be1382ce9bf6d6", "patch": "@@ -45,6 +45,7 @@ use syntax::ast;\n use syntax::attr;\n use syntax::feature_gate::{AttributeGate, AttributeType, Stability, deprecated_attributes};\n use syntax_pos::Span;\n+use syntax::symbol::keywords;\n \n use rustc::hir::{self, PatKind};\n use rustc::hir::intravisit::FnKind;\n@@ -605,6 +606,44 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for MissingDebugImplementations {\n     }\n }\n \n+declare_lint! {\n+    pub ANONYMOUS_PARAMETERS,\n+    Allow,\n+    \"detects anonymous parameters\"\n+}\n+\n+/// Checks for use of anonymous parameters (RFC 1685)\n+#[derive(Clone)]\n+pub struct AnonymousParameters;\n+\n+impl LintPass for AnonymousParameters {\n+    fn get_lints(&self) -> LintArray {\n+        lint_array!(ANONYMOUS_PARAMETERS)\n+    }\n+}\n+\n+impl EarlyLintPass for AnonymousParameters {\n+    fn check_trait_item(&mut self, cx: &EarlyContext, it: &ast::TraitItem) {\n+        match it.node {\n+            ast::TraitItemKind::Method(ref sig, _) => {\n+                for arg in sig.decl.inputs.iter() {\n+                    match arg.pat.node {\n+                        ast::PatKind::Ident(_, ident, None) => {\n+                            if ident.node.name == keywords::Invalid.name() {\n+                                cx.span_lint(ANONYMOUS_PARAMETERS,\n+                                             arg.pat.span,\n+                                             \"use of deprecated anonymous parameter\");\n+                            }\n+                        }\n+                        _ => (),\n+                    }\n+                }\n+            },\n+            _ => (),\n+        }\n+    }\n+}\n+\n declare_lint! {\n     DEPRECATED_ATTR,\n     Warn,"}, {"sha": "c1c14cb1fd29e3d8f3e6d6500a193d0f65fa4367", "filename": "src/librustc_lint/lib.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/4733ee7eb4be269e751e913fd1be1382ce9bf6d6/src%2Flibrustc_lint%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4733ee7eb4be269e751e913fd1be1382ce9bf6d6/src%2Flibrustc_lint%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Flib.rs?ref=4733ee7eb4be269e751e913fd1be1382ce9bf6d6", "patch": "@@ -112,6 +112,7 @@ pub fn register_builtins(store: &mut lint::LintStore, sess: Option<&Session>) {\n     add_early_builtin!(sess,\n                        UnusedParens,\n                        UnusedImportBraces,\n+                       AnonymousParameters,\n                        );\n \n     add_early_builtin_with_new!(sess,\n@@ -244,6 +245,10 @@ pub fn register_builtins(store: &mut lint::LintStore, sess: Option<&Session>) {\n             id: LintId::of(MISSING_FRAGMENT_SPECIFIER),\n             reference: \"issue #40107 <https://github.com/rust-lang/rust/issues/40107>\",\n         },\n+        FutureIncompatibleInfo {\n+            id: LintId::of(ANONYMOUS_PARAMETERS),\n+            reference: \"issue #41686 <https://github.com/rust-lang/rust/issues/41686>\",\n+        },\n         ]);\n \n     // Register renamed and removed lints"}, {"sha": "76edae17dc104cd3b0336f47b2ae32f1a07dc3ea", "filename": "src/test/compile-fail/anon-params-deprecated.rs", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/4733ee7eb4be269e751e913fd1be1382ce9bf6d6/src%2Ftest%2Fcompile-fail%2Fanon-params-deprecated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4733ee7eb4be269e751e913fd1be1382ce9bf6d6/src%2Ftest%2Fcompile-fail%2Fanon-params-deprecated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fanon-params-deprecated.rs?ref=4733ee7eb4be269e751e913fd1be1382ce9bf6d6", "patch": "@@ -0,0 +1,25 @@\n+// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+#![forbid(anonymous_parameters)]\n+// Test for the anonymous_parameters deprecation lint (RFC 1685)\n+\n+trait T {\n+    fn foo(i32); //~ ERROR use of deprecated anonymous parameter\n+                 //~| WARNING hard error\n+\n+    fn bar_with_default_impl(String, String) {}\n+    //~^ ERROR use of deprecated anonymous parameter\n+    //~| WARNING hard error\n+    //~| ERROR use of deprecated anonymous parameter\n+    //~| WARNING hard error\n+}\n+\n+fn main() {}"}]}