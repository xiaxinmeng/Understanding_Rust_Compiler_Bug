{"sha": "3e22f80f443469f470561bceb2d84427ebab677f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNlMjJmODBmNDQzNDY5ZjQ3MDU2MWJjZWIyZDg0NDI3ZWJhYjY3N2Y=", "commit": {"author": {"name": "Zac Pullar-Strecker", "email": "zacmps@gmail.com", "date": "2020-06-30T08:23:06Z"}, "committer": {"name": "Zac Pullar-Strecker", "email": "zacmps@gmail.com", "date": "2020-06-30T08:23:06Z"}, "message": "Switch to Path::parse and add tests", "tree": {"sha": "47927e25f7fa31861d57322878649e29735852af", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/47927e25f7fa31861d57322878649e29735852af"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3e22f80f443469f470561bceb2d84427ebab677f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3e22f80f443469f470561bceb2d84427ebab677f", "html_url": "https://github.com/rust-lang/rust/commit/3e22f80f443469f470561bceb2d84427ebab677f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3e22f80f443469f470561bceb2d84427ebab677f/comments", "author": {"login": "zacps", "id": 9827696, "node_id": "MDQ6VXNlcjk4Mjc2OTY=", "avatar_url": "https://avatars.githubusercontent.com/u/9827696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zacps", "html_url": "https://github.com/zacps", "followers_url": "https://api.github.com/users/zacps/followers", "following_url": "https://api.github.com/users/zacps/following{/other_user}", "gists_url": "https://api.github.com/users/zacps/gists{/gist_id}", "starred_url": "https://api.github.com/users/zacps/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zacps/subscriptions", "organizations_url": "https://api.github.com/users/zacps/orgs", "repos_url": "https://api.github.com/users/zacps/repos", "events_url": "https://api.github.com/users/zacps/events{/privacy}", "received_events_url": "https://api.github.com/users/zacps/received_events", "type": "User", "site_admin": false}, "committer": {"login": "zacps", "id": 9827696, "node_id": "MDQ6VXNlcjk4Mjc2OTY=", "avatar_url": "https://avatars.githubusercontent.com/u/9827696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zacps", "html_url": "https://github.com/zacps", "followers_url": "https://api.github.com/users/zacps/followers", "following_url": "https://api.github.com/users/zacps/following{/other_user}", "gists_url": "https://api.github.com/users/zacps/gists{/gist_id}", "starred_url": "https://api.github.com/users/zacps/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zacps/subscriptions", "organizations_url": "https://api.github.com/users/zacps/orgs", "repos_url": "https://api.github.com/users/zacps/repos", "events_url": "https://api.github.com/users/zacps/events{/privacy}", "received_events_url": "https://api.github.com/users/zacps/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "48d858f54d5b5a1a2808c8621c5d570d12874b88", "url": "https://api.github.com/repos/rust-lang/rust/commits/48d858f54d5b5a1a2808c8621c5d570d12874b88", "html_url": "https://github.com/rust-lang/rust/commit/48d858f54d5b5a1a2808c8621c5d570d12874b88"}], "stats": {"total": 1338, "additions": 667, "deletions": 671}, "files": [{"sha": "78a661c85a52f16482553e150cc0747b0c7b3141", "filename": "crates/ra_ide/src/hover.rs", "status": "modified", "additions": 667, "deletions": 671, "changes": 1338, "blob_url": "https://github.com/rust-lang/rust/blob/3e22f80f443469f470561bceb2d84427ebab677f/crates%2Fra_ide%2Fsrc%2Fhover.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3e22f80f443469f470561bceb2d84427ebab677f/crates%2Fra_ide%2Fsrc%2Fhover.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide%2Fsrc%2Fhover.rs?ref=3e22f80f443469f470561bceb2d84427ebab677f", "patch": "@@ -17,7 +17,7 @@ use ra_ide_db::{\n     RootDatabase,\n };\n use ra_syntax::{\n-    ast, ast::{Path, MacroCall}, match_ast, AstNode, SyntaxKind::*, SyntaxNode, SyntaxToken, TokenAtOffset,\n+    ast, ast::Path, match_ast, AstNode, SyntaxKind::*, SyntaxToken, TokenAtOffset,\n };\n use ra_tt::{Ident, Leaf, Literal, TokenTree};\n use url::Url;\n@@ -534,10 +534,7 @@ fn try_resolve_intra(\n     let link_target = strip_prefixes_suffixes(link_target);\n \n     // Parse link as a module path\n-    // This expects a full document, which a single path isn't, but we can just ignore the errors.\n-    let parsed = SyntaxNode::new_root(ra_syntax::parse_text(link_target).0);\n-    // TODO: Proper parsing\n-    let path = parsed.descendants().filter_map(Path::cast).next()?;\n+    let path = Path::parse(link_target).ok()?;\n     let modpath = ModPath::from_src(path, &Hygiene::new_unhygienic()).unwrap();\n \n     // Resolve it relative to symbol's location (according to the RFC this should consider small scopes\n@@ -613,7 +610,6 @@ fn get_doc_url(db: &RootDatabase, krate: &Crate) -> Option<Url> {\n     let attrs = db.attrs(AttrDef::from(krate.root_module(db)?).into());\n     let doc_attr_q = attrs.by_key(\"doc\");\n \n-    // TODO: Tests for this parsing\n     let doc_url = if doc_attr_q.exists() {\n         doc_attr_q.tt_values().map(|tt| {\n             let name = tt.token_trees.iter()\n@@ -1830,32 +1826,32 @@ fn func(foo: i32) { if true { <|>foo; }; }\n         );\n         assert_debug_snapshot!(actions,\n             @r###\"\n-            [\n-                GoToType(\n-                    [\n-                        HoverGotoTypeData {\n-                            mod_path: \"S\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 0..19,\n-                                name: \"S\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    7..8,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"struct S\",\n-                                ),\n-                                docs: None,\n-                            },\n+        [\n+            GoToType(\n+                [\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::S\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 0..19,\n+                            name: \"S\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                7..8,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"struct S\",\n+                            ),\n+                            docs: None,\n                         },\n-                    ],\n-                ),\n-            ]\n-            \"###);\n+                    },\n+                ],\n+            ),\n+        ]\n+        \"###);\n     }\n \n     #[test]\n@@ -1874,51 +1870,51 @@ fn func(foo: i32) { if true { <|>foo; }; }\n         );\n         assert_debug_snapshot!(actions,\n             @r###\"\n-            [\n-                GoToType(\n-                    [\n-                        HoverGotoTypeData {\n-                            mod_path: \"S\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 17..37,\n-                                name: \"S\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    24..25,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"struct S\",\n-                                ),\n-                                docs: None,\n-                            },\n+        [\n+            GoToType(\n+                [\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::S\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 17..37,\n+                            name: \"S\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                24..25,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"struct S\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"Arg\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 0..16,\n-                                name: \"Arg\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    7..10,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"struct Arg\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::Arg\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 0..16,\n+                            name: \"Arg\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                7..10,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"struct Arg\",\n+                            ),\n+                            docs: None,\n                         },\n-                    ],\n-                ),\n-            ]\n-            \"###);\n+                    },\n+                ],\n+            ),\n+        ]\n+        \"###);\n     }\n \n     #[test]\n@@ -1937,51 +1933,51 @@ fn func(foo: i32) { if true { <|>foo; }; }\n         );\n         assert_debug_snapshot!(actions,\n             @r###\"\n-            [\n-                GoToType(\n-                    [\n-                        HoverGotoTypeData {\n-                            mod_path: \"S\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 17..37,\n-                                name: \"S\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    24..25,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"struct S\",\n-                                ),\n-                                docs: None,\n-                            },\n+        [\n+            GoToType(\n+                [\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::S\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 17..37,\n+                            name: \"S\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                24..25,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"struct S\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"Arg\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 0..16,\n-                                name: \"Arg\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    7..10,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"struct Arg\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::Arg\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 0..16,\n+                            name: \"Arg\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                7..10,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"struct Arg\",\n+                            ),\n+                            docs: None,\n                         },\n-                    ],\n-                ),\n-            ]\n-            \"###);\n+                    },\n+                ],\n+            ),\n+        ]\n+        \"###);\n     }\n \n     #[test]\n@@ -2003,70 +1999,70 @@ fn func(foo: i32) { if true { <|>foo; }; }\n         );\n         assert_debug_snapshot!(actions,\n             @r###\"\n-            [\n-                GoToType(\n-                    [\n-                        HoverGotoTypeData {\n-                            mod_path: \"A\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 0..14,\n-                                name: \"A\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    7..8,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"struct A\",\n-                                ),\n-                                docs: None,\n-                            },\n+        [\n+            GoToType(\n+                [\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::A\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 0..14,\n+                            name: \"A\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                7..8,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"struct A\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"B\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 15..29,\n-                                name: \"B\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    22..23,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"struct B\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::B\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 15..29,\n+                            name: \"B\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                22..23,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"struct B\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"M::C\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 42..60,\n-                                name: \"C\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    53..54,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"pub struct C\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::M::C\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 42..60,\n+                            name: \"C\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                53..54,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"pub struct C\",\n+                            ),\n+                            docs: None,\n                         },\n-                    ],\n-                ),\n-            ]\n-               \"###);\n+                    },\n+                ],\n+            ),\n+        ]\n+        \"###);\n     }\n \n     #[test]\n@@ -2086,32 +2082,32 @@ fn func(foo: i32) { if true { <|>foo; }; }\n         );\n         assert_debug_snapshot!(actions,\n             @r###\"\n-            [\n-                GoToType(\n-                    [\n-                        HoverGotoTypeData {\n-                            mod_path: \"Foo\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 0..12,\n-                                name: \"Foo\",\n-                                kind: TRAIT_DEF,\n-                                focus_range: Some(\n-                                    6..9,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"trait Foo\",\n-                                ),\n-                                docs: None,\n-                            },\n+        [\n+            GoToType(\n+                [\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::Foo\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 0..12,\n+                            name: \"Foo\",\n+                            kind: TRAIT_DEF,\n+                            focus_range: Some(\n+                                6..9,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"trait Foo\",\n+                            ),\n+                            docs: None,\n                         },\n-                    ],\n-                ),\n-            ]\n-            \"###);\n+                    },\n+                ],\n+            ),\n+        ]\n+        \"###);\n     }\n \n     #[test]\n@@ -2132,51 +2128,51 @@ fn func(foo: i32) { if true { <|>foo; }; }\n         );\n         assert_debug_snapshot!(actions,\n             @r###\"\n-            [\n-                GoToType(\n-                    [\n-                        HoverGotoTypeData {\n-                            mod_path: \"Foo\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 0..15,\n-                                name: \"Foo\",\n-                                kind: TRAIT_DEF,\n-                                focus_range: Some(\n-                                    6..9,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"trait Foo\",\n-                                ),\n-                                docs: None,\n-                            },\n+        [\n+            GoToType(\n+                [\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::Foo\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 0..15,\n+                            name: \"Foo\",\n+                            kind: TRAIT_DEF,\n+                            focus_range: Some(\n+                                6..9,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"trait Foo\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"S\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 16..25,\n-                                name: \"S\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    23..24,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"struct S\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::S\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 16..25,\n+                            name: \"S\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                23..24,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"struct S\",\n+                            ),\n+                            docs: None,\n                         },\n-                    ],\n-                ),\n-            ]\n-            \"###);\n+                    },\n+                ],\n+            ),\n+        ]\n+        \"###);\n     }\n \n     #[test]\n@@ -2197,51 +2193,51 @@ fn func(foo: i32) { if true { <|>foo; }; }\n         );\n         assert_debug_snapshot!(actions,\n             @r###\"\n-            [\n-                GoToType(\n-                    [\n-                        HoverGotoTypeData {\n-                            mod_path: \"Foo\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 0..12,\n-                                name: \"Foo\",\n-                                kind: TRAIT_DEF,\n-                                focus_range: Some(\n-                                    6..9,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"trait Foo\",\n-                                ),\n-                                docs: None,\n-                            },\n+        [\n+            GoToType(\n+                [\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::Foo\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 0..12,\n+                            name: \"Foo\",\n+                            kind: TRAIT_DEF,\n+                            focus_range: Some(\n+                                6..9,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"trait Foo\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"Bar\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 13..25,\n-                                name: \"Bar\",\n-                                kind: TRAIT_DEF,\n-                                focus_range: Some(\n-                                    19..22,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"trait Bar\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::Bar\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 13..25,\n+                            name: \"Bar\",\n+                            kind: TRAIT_DEF,\n+                            focus_range: Some(\n+                                19..22,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"trait Bar\",\n+                            ),\n+                            docs: None,\n                         },\n-                    ],\n-                ),\n-            ]\n-            \"###);\n+                    },\n+                ],\n+            ),\n+        ]\n+        \"###);\n     }\n \n     #[test]\n@@ -2264,89 +2260,89 @@ fn func(foo: i32) { if true { <|>foo; }; }\n         );\n         assert_debug_snapshot!(actions,\n             @r###\"\n-            [\n-                GoToType(\n-                    [\n-                        HoverGotoTypeData {\n-                            mod_path: \"Foo\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 0..15,\n-                                name: \"Foo\",\n-                                kind: TRAIT_DEF,\n-                                focus_range: Some(\n-                                    6..9,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"trait Foo\",\n-                                ),\n-                                docs: None,\n-                            },\n+        [\n+            GoToType(\n+                [\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::Foo\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 0..15,\n+                            name: \"Foo\",\n+                            kind: TRAIT_DEF,\n+                            focus_range: Some(\n+                                6..9,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"trait Foo\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"Bar\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 16..31,\n-                                name: \"Bar\",\n-                                kind: TRAIT_DEF,\n-                                focus_range: Some(\n-                                    22..25,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"trait Bar\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::Bar\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 16..31,\n+                            name: \"Bar\",\n+                            kind: TRAIT_DEF,\n+                            focus_range: Some(\n+                                22..25,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"trait Bar\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"S1\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 32..44,\n-                                name: \"S1\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    39..41,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"struct S1\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::S1\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 32..44,\n+                            name: \"S1\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                39..41,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"struct S1\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"S2\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 45..57,\n-                                name: \"S2\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    52..54,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"struct S2\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::S2\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 45..57,\n+                            name: \"S2\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                52..54,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"struct S2\",\n+                            ),\n+                            docs: None,\n                         },\n-                    ],\n-                ),\n-            ]\n-               \"###);\n+                    },\n+                ],\n+            ),\n+        ]\n+        \"###);\n     }\n \n     #[test]\n@@ -2361,32 +2357,32 @@ fn func(foo: i32) { if true { <|>foo; }; }\n         );\n         assert_debug_snapshot!(actions,\n             @r###\"\n-            [\n-                GoToType(\n-                    [\n-                        HoverGotoTypeData {\n-                            mod_path: \"Foo\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 0..12,\n-                                name: \"Foo\",\n-                                kind: TRAIT_DEF,\n-                                focus_range: Some(\n-                                    6..9,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"trait Foo\",\n-                                ),\n-                                docs: None,\n-                            },\n+        [\n+            GoToType(\n+                [\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::Foo\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 0..12,\n+                            name: \"Foo\",\n+                            kind: TRAIT_DEF,\n+                            focus_range: Some(\n+                                6..9,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"trait Foo\",\n+                            ),\n+                            docs: None,\n                         },\n-                    ],\n-                ),\n-            ]\n-            \"###);\n+                    },\n+                ],\n+            ),\n+        ]\n+        \"###);\n     }\n \n     #[test]\n@@ -2404,70 +2400,70 @@ fn func(foo: i32) { if true { <|>foo; }; }\n         );\n         assert_debug_snapshot!(actions,\n             @r###\"\n-            [\n-                GoToType(\n-                    [\n-                        HoverGotoTypeData {\n-                            mod_path: \"Foo\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 0..12,\n-                                name: \"Foo\",\n-                                kind: TRAIT_DEF,\n-                                focus_range: Some(\n-                                    6..9,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"trait Foo\",\n-                                ),\n-                                docs: None,\n-                            },\n+        [\n+            GoToType(\n+                [\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::Foo\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 0..12,\n+                            name: \"Foo\",\n+                            kind: TRAIT_DEF,\n+                            focus_range: Some(\n+                                6..9,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"trait Foo\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"Bar\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 13..28,\n-                                name: \"Bar\",\n-                                kind: TRAIT_DEF,\n-                                focus_range: Some(\n-                                    19..22,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"trait Bar\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::Bar\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 13..28,\n+                            name: \"Bar\",\n+                            kind: TRAIT_DEF,\n+                            focus_range: Some(\n+                                19..22,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"trait Bar\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"S\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 29..39,\n-                                name: \"S\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    36..37,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"struct S\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::S\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 29..39,\n+                            name: \"S\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                36..37,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"struct S\",\n+                            ),\n+                            docs: None,\n                         },\n-                    ],\n-                ),\n-            ]\n-            \"###);\n+                    },\n+                ],\n+            ),\n+        ]\n+        \"###);\n     }\n \n     #[test]\n@@ -2483,51 +2479,51 @@ fn func(foo: i32) { if true { <|>foo; }; }\n         );\n         assert_debug_snapshot!(actions,\n             @r###\"\n-            [\n-                GoToType(\n-                    [\n-                        HoverGotoTypeData {\n-                            mod_path: \"Foo\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 0..15,\n-                                name: \"Foo\",\n-                                kind: TRAIT_DEF,\n-                                focus_range: Some(\n-                                    6..9,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"trait Foo\",\n-                                ),\n-                                docs: None,\n-                            },\n+        [\n+            GoToType(\n+                [\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::Foo\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 0..15,\n+                            name: \"Foo\",\n+                            kind: TRAIT_DEF,\n+                            focus_range: Some(\n+                                6..9,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"trait Foo\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"S\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 16..27,\n-                                name: \"S\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    23..24,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"struct S\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::S\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 16..27,\n+                            name: \"S\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                23..24,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"struct S\",\n+                            ),\n+                            docs: None,\n                         },\n-                    ],\n-                ),\n-            ]\n-            \"###);\n+                    },\n+                ],\n+            ),\n+        ]\n+        \"###);\n     }\n \n     #[test]\n@@ -2555,7 +2551,7 @@ fn func(foo: i32) { if true { <|>foo; }; }\n             GoToType(\n                 [\n                     HoverGotoTypeData {\n-                        mod_path: \"B\",\n+                        mod_path: \"test::B\",\n                         nav: NavigationTarget {\n                             file_id: FileId(\n                                 1,\n@@ -2574,7 +2570,7 @@ fn func(foo: i32) { if true { <|>foo; }; }\n                         },\n                     },\n                     HoverGotoTypeData {\n-                        mod_path: \"Foo\",\n+                        mod_path: \"test::Foo\",\n                         nav: NavigationTarget {\n                             file_id: FileId(\n                                 1,\n@@ -2610,32 +2606,32 @@ fn func(foo: i32) { if true { <|>foo; }; }\n         );\n         assert_debug_snapshot!(actions,\n             @r###\"\n-            [\n-                GoToType(\n-                    [\n-                        HoverGotoTypeData {\n-                            mod_path: \"Foo\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 0..12,\n-                                name: \"Foo\",\n-                                kind: TRAIT_DEF,\n-                                focus_range: Some(\n-                                    6..9,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"trait Foo\",\n-                                ),\n-                                docs: None,\n-                            },\n+        [\n+            GoToType(\n+                [\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::Foo\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 0..12,\n+                            name: \"Foo\",\n+                            kind: TRAIT_DEF,\n+                            focus_range: Some(\n+                                6..9,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"trait Foo\",\n+                            ),\n+                            docs: None,\n                         },\n-                    ],\n-                ),\n-            ]\n-            \"###);\n+                    },\n+                ],\n+            ),\n+        ]\n+        \"###);\n     }\n \n     #[test]\n@@ -2651,51 +2647,51 @@ fn func(foo: i32) { if true { <|>foo; }; }\n         );\n         assert_debug_snapshot!(actions,\n             @r###\"\n-            [\n-                GoToType(\n-                    [\n-                        HoverGotoTypeData {\n-                            mod_path: \"Foo\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 0..15,\n-                                name: \"Foo\",\n-                                kind: TRAIT_DEF,\n-                                focus_range: Some(\n-                                    6..9,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"trait Foo\",\n-                                ),\n-                                docs: None,\n-                            },\n+        [\n+            GoToType(\n+                [\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::Foo\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 0..15,\n+                            name: \"Foo\",\n+                            kind: TRAIT_DEF,\n+                            focus_range: Some(\n+                                6..9,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"trait Foo\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"S\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 16..27,\n-                                name: \"S\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    23..24,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"struct S\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::S\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 16..27,\n+                            name: \"S\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                23..24,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"struct S\",\n+                            ),\n+                            docs: None,\n                         },\n-                    ],\n-                ),\n-            ]\n-            \"###);\n+                    },\n+                ],\n+            ),\n+        ]\n+        \"###);\n     }\n \n     #[test]\n@@ -2714,89 +2710,89 @@ fn func(foo: i32) { if true { <|>foo; }; }\n         );\n         assert_debug_snapshot!(actions,\n             @r###\"\n-            [\n-                GoToType(\n-                    [\n-                        HoverGotoTypeData {\n-                            mod_path: \"ImplTrait\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 0..21,\n-                                name: \"ImplTrait\",\n-                                kind: TRAIT_DEF,\n-                                focus_range: Some(\n-                                    6..15,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"trait ImplTrait\",\n-                                ),\n-                                docs: None,\n-                            },\n+        [\n+            GoToType(\n+                [\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::ImplTrait\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 0..21,\n+                            name: \"ImplTrait\",\n+                            kind: TRAIT_DEF,\n+                            focus_range: Some(\n+                                6..15,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"trait ImplTrait\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"B\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 43..57,\n-                                name: \"B\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    50..51,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"struct B\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::B\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 43..57,\n+                            name: \"B\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                50..51,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"struct B\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"DynTrait\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 22..42,\n-                                name: \"DynTrait\",\n-                                kind: TRAIT_DEF,\n-                                focus_range: Some(\n-                                    28..36,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"trait DynTrait\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::DynTrait\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 22..42,\n+                            name: \"DynTrait\",\n+                            kind: TRAIT_DEF,\n+                            focus_range: Some(\n+                                28..36,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"trait DynTrait\",\n+                            ),\n+                            docs: None,\n                         },\n-                        HoverGotoTypeData {\n-                            mod_path: \"S\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 58..69,\n-                                name: \"S\",\n-                                kind: STRUCT_DEF,\n-                                focus_range: Some(\n-                                    65..66,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"struct S\",\n-                                ),\n-                                docs: None,\n-                            },\n+                    },\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::S\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 58..69,\n+                            name: \"S\",\n+                            kind: STRUCT_DEF,\n+                            focus_range: Some(\n+                                65..66,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"struct S\",\n+                            ),\n+                            docs: None,\n                         },\n-                    ],\n-                ),\n-            ]\n-            \"###);\n+                    },\n+                ],\n+            ),\n+        ]\n+        \"###);\n     }\n \n     #[test]\n@@ -2828,31 +2824,31 @@ fn func(foo: i32) { if true { <|>foo; }; }\n         );\n         assert_debug_snapshot!(actions,\n             @r###\"\n-            [\n-                GoToType(\n-                    [\n-                        HoverGotoTypeData {\n-                            mod_path: \"Foo\",\n-                            nav: NavigationTarget {\n-                                file_id: FileId(\n-                                    1,\n-                                ),\n-                                full_range: 0..62,\n-                                name: \"Foo\",\n-                                kind: TRAIT_DEF,\n-                                focus_range: Some(\n-                                    6..9,\n-                                ),\n-                                container_name: None,\n-                                description: Some(\n-                                    \"trait Foo\",\n-                                ),\n-                                docs: None,\n-                            },\n+        [\n+            GoToType(\n+                [\n+                    HoverGotoTypeData {\n+                        mod_path: \"test::Foo\",\n+                        nav: NavigationTarget {\n+                            file_id: FileId(\n+                                1,\n+                            ),\n+                            full_range: 0..62,\n+                            name: \"Foo\",\n+                            kind: TRAIT_DEF,\n+                            focus_range: Some(\n+                                6..9,\n+                            ),\n+                            container_name: None,\n+                            description: Some(\n+                                \"trait Foo\",\n+                            ),\n+                            docs: None,\n                         },\n-                    ],\n-                ),\n-            ]\n-            \"###);\n+                    },\n+                ],\n+            ),\n+        ]\n+        \"###);\n     }\n }"}]}