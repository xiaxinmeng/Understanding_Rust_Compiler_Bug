{"sha": "b476d979d2102078f6106247488d28a4e2fd8881", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI0NzZkOTc5ZDIxMDIwNzhmNjEwNjI0NzQ4OGQyOGE0ZTJmZDg4ODE=", "commit": {"author": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2013-12-28T00:39:39Z"}, "committer": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2014-01-03T22:01:59Z"}, "message": "libsyntax: De-`@mut` `SCTable::rename_memo`", "tree": {"sha": "2aed58897e785bad6a272ebad75c64f9d64876d2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2aed58897e785bad6a272ebad75c64f9d64876d2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b476d979d2102078f6106247488d28a4e2fd8881", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b476d979d2102078f6106247488d28a4e2fd8881", "html_url": "https://github.com/rust-lang/rust/commit/b476d979d2102078f6106247488d28a4e2fd8881", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b476d979d2102078f6106247488d28a4e2fd8881/comments", "author": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4d6dde7f49eea0031a7faa651edef0a231dcb081", "url": "https://api.github.com/repos/rust-lang/rust/commits/4d6dde7f49eea0031a7faa651edef0a231dcb081", "html_url": "https://github.com/rust-lang/rust/commit/4d6dde7f49eea0031a7faa651edef0a231dcb081"}], "stats": {"total": 11, "additions": 6, "deletions": 5}, "files": [{"sha": "4d744f4df29b6c36be75f6bc8f2152f91536bc95", "filename": "src/libsyntax/ast.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b476d979d2102078f6106247488d28a4e2fd8881/src%2Flibsyntax%2Fast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b476d979d2102078f6106247488d28a4e2fd8881/src%2Flibsyntax%2Fast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fast.rs?ref=b476d979d2102078f6106247488d28a4e2fd8881", "patch": "@@ -91,7 +91,7 @@ pub type SyntaxContext = u32;\n pub struct SCTable {\n     table: RefCell<~[SyntaxContext_]>,\n     mark_memo: RefCell<HashMap<(SyntaxContext,Mrk),SyntaxContext>>,\n-    rename_memo: HashMap<(SyntaxContext,Ident,Name),SyntaxContext>\n+    rename_memo: RefCell<HashMap<(SyntaxContext,Ident,Name),SyntaxContext>>,\n }\n \n // NB: these must be placed in any SCTable..."}, {"sha": "082eb188c20e1f4158c4d832eb919acc9d945d42", "filename": "src/libsyntax/ast_util.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/b476d979d2102078f6106247488d28a4e2fd8881/src%2Flibsyntax%2Fast_util.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b476d979d2102078f6106247488d28a4e2fd8881/src%2Flibsyntax%2Fast_util.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fast_util.rs?ref=b476d979d2102078f6106247488d28a4e2fd8881", "patch": "@@ -748,17 +748,18 @@ pub fn new_rename_internal(id:Ident, to:Name, tail:SyntaxContext, table: &mut SC\n     let key = (tail,id,to);\n     // FIXME #5074\n     //let try_lookup = table.rename_memo.find(&key);\n-    match table.rename_memo.contains_key(&key) {\n+    let mut rename_memo = table.rename_memo.borrow_mut();\n+    match rename_memo.get().contains_key(&key) {\n         false => {\n             let new_idx = {\n                 let mut table = table.table.borrow_mut();\n                 idx_push(table.get(), Rename(id,to,tail))\n             };\n-            table.rename_memo.insert(key,new_idx);\n+            rename_memo.get().insert(key,new_idx);\n             new_idx\n         }\n         true => {\n-            match table.rename_memo.find(&key) {\n+            match rename_memo.get().find(&key) {\n                 None => fail!(\"internal error: key disappeared 2013042902\"),\n                 Some(idxptr) => {*idxptr}\n             }\n@@ -773,7 +774,7 @@ pub fn new_sctable_internal() -> SCTable {\n     SCTable {\n         table: RefCell::new(~[EmptyCtxt,IllegalCtxt]),\n         mark_memo: RefCell::new(HashMap::new()),\n-        rename_memo: HashMap::new()\n+        rename_memo: RefCell::new(HashMap::new()),\n     }\n }\n "}]}