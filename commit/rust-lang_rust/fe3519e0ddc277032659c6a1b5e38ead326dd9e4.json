{"sha": "fe3519e0ddc277032659c6a1b5e38ead326dd9e4", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZlMzUxOWUwZGRjMjc3MDMyNjU5YzZhMWI1ZTM4ZWFkMzI2ZGQ5ZTQ=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2018-12-08T11:09:32Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2018-12-08T11:09:32Z"}, "message": "Swap if branches", "tree": {"sha": "1e6349442704cf23a2e17d05a8c3818e9a0c0bf0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1e6349442704cf23a2e17d05a8c3818e9a0c0bf0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fe3519e0ddc277032659c6a1b5e38ead326dd9e4", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEvUKv4zqIn2RHUgCKtvoGpuDiZlsFAlwLpngACgkQtvoGpuDi\nZlsmWg/9GECAS9ypyI+7dI0QB134SeCo+eYF2lu7tiZ/wWRW0kwstq7bqrcoSavO\nL1IVp+GQ+jDrsXgLlZqZSowhLd3RhlubSg6pyPnbP4nsfDo2TeXHf0Kvg+uSLfCq\nCdjDs37kIdcnz+BUpidOGU2MuSMl98AQ1krcDLdo5KSyN75wVAu8shlKziKBNx7u\nXj3N89csVMqBv7RmiPtpWfypas3ls3VYXNPww0JmBE0Zr93JTLzYG68MlIANOKrT\nXgw7iH3r+GGqIEOnk5xd1Mk2khp/uyBJQ1hoL4jErnPG8jGN/SC9thzp8PcVq+W2\nZblPAs7GJb9q3FrmdBLdZy2gxn52qccyLWG/qmBV7eEBYr7al/8717JCPVz1XXJl\nu5xQQljOlYNhMoI9G7nYBswQBV5jGfZVQam+eWnGMwVaGAWTtOFVrYdiPEEfnoLo\nCbMTNKJ7yT4+8K3jmdbh17rjfcHKljbgvFICLu94q3Q+Ffady5tXye4Gu5Q60gtQ\n4sZ2XDzDjjZkojNDSg6iY+OP9F+yC8et0oiN//JwNcx8rerRcwf9dtEFYVnv8fol\nVIRGLR58LAK8gqbTjJCB5AA/dhgkJtK6Q17/UfuM3Khzer6eVS9aDO9UvTRbrfkd\nSsFRAHcZJfyW1L3TlzIIfIMsdMuk0rPMtPPn+Th7QsehdSJMie8=\n=zdU6\n-----END PGP SIGNATURE-----", "payload": "tree 1e6349442704cf23a2e17d05a8c3818e9a0c0bf0\nparent d90cad24a19190fd51c7a90203a29c5c91780711\nauthor Philipp Hansch <dev@phansch.net> 1544267372 +0100\ncommitter Philipp Hansch <dev@phansch.net> 1544267372 +0100\n\nSwap if branches\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fe3519e0ddc277032659c6a1b5e38ead326dd9e4", "html_url": "https://github.com/rust-lang/rust/commit/fe3519e0ddc277032659c6a1b5e38ead326dd9e4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fe3519e0ddc277032659c6a1b5e38ead326dd9e4/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d90cad24a19190fd51c7a90203a29c5c91780711", "url": "https://api.github.com/repos/rust-lang/rust/commits/d90cad24a19190fd51c7a90203a29c5c91780711", "html_url": "https://github.com/rust-lang/rust/commit/d90cad24a19190fd51c7a90203a29c5c91780711"}], "stats": {"total": 6, "additions": 3, "deletions": 3}, "files": [{"sha": "d311f76074cc0e37ed17846dc380ecc5b58f0057", "filename": "clippy_lints/src/methods/mod.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fe3519e0ddc277032659c6a1b5e38ead326dd9e4/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fe3519e0ddc277032659c6a1b5e38ead326dd9e4/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs?ref=fe3519e0ddc277032659c6a1b5e38ead326dd9e4", "patch": "@@ -1333,7 +1333,9 @@ fn lint_clone_on_copy(cx: &LateContext<'_, '_>, expr: &hir::Expr, arg: &hir::Exp\n         let snip;\n         if let Some(snippet) = sugg::Sugg::hir_opt(cx, arg) {\n             // x.clone() might have dereferenced x, possibly through Deref impls\n-            if cx.tables.expr_ty(arg) != ty {\n+            if cx.tables.expr_ty(arg) == ty {\n+                snip = Some((\"try removing the `clone` call\", format!(\"{}\", snippet)));\n+            } else {\n                 let parent = cx.tcx.hir().get_parent_node(expr.id);\n                 match cx.tcx.hir().get(parent) {\n                     hir::Node::Expr(parent) => match parent.node {\n@@ -1367,8 +1369,6 @@ fn lint_clone_on_copy(cx: &LateContext<'_, '_>, expr: &hir::Expr, arg: &hir::Exp\n                     .count();\n                 let derefs: String = iter::repeat('*').take(deref_count).collect();\n                 snip = Some((\"try dereferencing it\", format!(\"{}{}\", derefs, snippet)));\n-            } else {\n-                snip = Some((\"try removing the `clone` call\", format!(\"{}\", snippet)));\n             }\n         } else {\n             snip = None;"}]}