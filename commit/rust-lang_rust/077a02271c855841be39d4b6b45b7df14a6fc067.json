{"sha": "077a02271c855841be39d4b6b45b7df14a6fc067", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA3N2EwMjI3MWM4NTU4NDFiZTM5ZDRiNmI0NWI3ZGYxNGE2ZmMwNjc=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2019-01-13T18:56:20Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2019-01-13T18:56:20Z"}, "message": "fix go to parent module", "tree": {"sha": "72e29840557575a3745bd773142d2a6ef759d722", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/72e29840557575a3745bd773142d2a6ef759d722"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/077a02271c855841be39d4b6b45b7df14a6fc067", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/077a02271c855841be39d4b6b45b7df14a6fc067", "html_url": "https://github.com/rust-lang/rust/commit/077a02271c855841be39d4b6b45b7df14a6fc067", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/077a02271c855841be39d4b6b45b7df14a6fc067/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4209022e5b8dc185b098d76fd6701cd046b7c37d", "url": "https://api.github.com/repos/rust-lang/rust/commits/4209022e5b8dc185b098d76fd6701cd046b7c37d", "html_url": "https://github.com/rust-lang/rust/commit/4209022e5b8dc185b098d76fd6701cd046b7c37d"}], "stats": {"total": 23, "additions": 21, "deletions": 2}, "files": [{"sha": "230d0f67aac7950f31f0879717739638cae5048e", "filename": "crates/ra_ide_api/src/navigation_target.rs", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/077a02271c855841be39d4b6b45b7df14a6fc067/crates%2Fra_ide_api%2Fsrc%2Fnavigation_target.rs", "raw_url": "https://github.com/rust-lang/rust/raw/077a02271c855841be39d4b6b45b7df14a6fc067/crates%2Fra_ide_api%2Fsrc%2Fnavigation_target.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fnavigation_target.rs?ref=077a02271c855841be39d4b6b45b7df14a6fc067", "patch": "@@ -89,6 +89,25 @@ impl NavigationTarget {\n         Ok(res)\n     }\n \n+    pub(crate) fn from_module_to_decl(\n+        db: &RootDatabase,\n+        module: hir::Module,\n+    ) -> Cancelable<NavigationTarget> {\n+        let name = module\n+            .name(db)?\n+            .map(|it| it.to_string().into())\n+            .unwrap_or_default();\n+        if let Some((file_id, source)) = module.declaration_source(db)? {\n+            return Ok(NavigationTarget::from_syntax(\n+                file_id,\n+                name,\n+                None,\n+                source.syntax(),\n+            ));\n+        }\n+        NavigationTarget::from_module(db, module)\n+    }\n+\n     // TODO once Def::Item is gone, this should be able to always return a NavigationTarget\n     pub(crate) fn from_def(db: &RootDatabase, def: Def) -> Cancelable<Option<NavigationTarget>> {\n         let res = match def {"}, {"sha": "675042a6c0ff7f4b84eda6d66327628e61275d58", "filename": "crates/ra_ide_api/src/parent_module.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/077a02271c855841be39d4b6b45b7df14a6fc067/crates%2Fra_ide_api%2Fsrc%2Fparent_module.rs", "raw_url": "https://github.com/rust-lang/rust/raw/077a02271c855841be39d4b6b45b7df14a6fc067/crates%2Fra_ide_api%2Fsrc%2Fparent_module.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fparent_module.rs?ref=077a02271c855841be39d4b6b45b7df14a6fc067", "patch": "@@ -12,7 +12,7 @@ pub(crate) fn parent_module(\n         None => return Ok(Vec::new()),\n         Some(it) => it,\n     };\n-    let nav = NavigationTarget::from_module(db, module)?;\n+    let nav = NavigationTarget::from_module_to_decl(db, module)?;\n     Ok(vec![nav])\n }\n \n@@ -31,7 +31,7 @@ mod tests {\n             \",\n         );\n         let nav = analysis.parent_module(pos).unwrap().pop().unwrap();\n-        nav.assert_match(\"foo SOURCE_FILE FileId(2) [0; 10)\");\n+        nav.assert_match(\"foo MODULE FileId(1) [0; 8)\");\n     }\n \n     #[test]"}]}