{"sha": "b80ee3969fcaeb2bfb4e82808b725964d2356448", "node_id": "C_kwDOAAsO6NoAKGI4MGVlMzk2OWZjYWViMmJmYjRlODI4MDhiNzI1OTY0ZDIzNTY0NDg", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2023-04-11T03:07:58Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2023-04-11T03:07:58Z"}, "message": "Auto merge of #109850 - MU001999:master, r=estebank\n\nEmits non-overlapping suggestions for arguments with wrong types\n\nFixes #109831", "tree": {"sha": "7e0a79becc51ef73d911b3bd176b437901fa768d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7e0a79becc51ef73d911b3bd176b437901fa768d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b80ee3969fcaeb2bfb4e82808b725964d2356448", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b80ee3969fcaeb2bfb4e82808b725964d2356448", "html_url": "https://github.com/rust-lang/rust/commit/b80ee3969fcaeb2bfb4e82808b725964d2356448", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b80ee3969fcaeb2bfb4e82808b725964d2356448/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5ca6e98f133744d147f9c84e83482912ac840406", "url": "https://api.github.com/repos/rust-lang/rust/commits/5ca6e98f133744d147f9c84e83482912ac840406", "html_url": "https://github.com/rust-lang/rust/commit/5ca6e98f133744d147f9c84e83482912ac840406"}, {"sha": "80e428553144d441893fc07ea2b88081d93806fe", "url": "https://api.github.com/repos/rust-lang/rust/commits/80e428553144d441893fc07ea2b88081d93806fe", "html_url": "https://github.com/rust-lang/rust/commit/80e428553144d441893fc07ea2b88081d93806fe"}], "stats": {"total": 66, "additions": 63, "deletions": 3}, "files": [{"sha": "cf93d1d21820d7845fd559e3c3898546a610b5fd", "filename": "compiler/rustc_hir_typeck/src/fn_ctxt/checks.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b80ee3969fcaeb2bfb4e82808b725964d2356448/compiler%2Frustc_hir_typeck%2Fsrc%2Ffn_ctxt%2Fchecks.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b80ee3969fcaeb2bfb4e82808b725964d2356448/compiler%2Frustc_hir_typeck%2Fsrc%2Ffn_ctxt%2Fchecks.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_typeck%2Fsrc%2Ffn_ctxt%2Fchecks.rs?ref=b80ee3969fcaeb2bfb4e82808b725964d2356448", "patch": "@@ -1191,11 +1191,11 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n             // index position where it *should have been*, which is *after* the previous one.\n             if let Some(provided_idx) = provided_idx {\n                 prev = provided_idx.index() as i64;\n+                continue;\n             }\n             let idx = ProvidedIdx::from_usize((prev + 1) as usize);\n-            if let None = provided_idx\n-                && let Some((_, arg_span)) = provided_arg_tys.get(idx)\n-            {\n+            if let Some((_, arg_span)) = provided_arg_tys.get(idx) {\n+                prev += 1;\n                 // There is a type that was *not* found anywhere, so it isn't a move, but a\n                 // replacement and we look at what type it should have been. This will allow us\n                 // To suggest a multipart suggestion when encountering `foo(1, \"\")` where the def"}, {"sha": "2e8ae40f63059452cd88e13fcb35334eb3d9fbf3", "filename": "tests/ui/argument-suggestions/issue-109831.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/b80ee3969fcaeb2bfb4e82808b725964d2356448/tests%2Fui%2Fargument-suggestions%2Fissue-109831.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b80ee3969fcaeb2bfb4e82808b725964d2356448/tests%2Fui%2Fargument-suggestions%2Fissue-109831.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fargument-suggestions%2Fissue-109831.rs?ref=b80ee3969fcaeb2bfb4e82808b725964d2356448", "patch": "@@ -0,0 +1,9 @@\n+struct A;\n+struct B;\n+\n+fn f(b1: B, b2: B, a2: C) {} //~ ERROR E0412\n+\n+fn main() {\n+    f(A, A, B, C); //~ ERROR E0425\n+    //~^ ERROR E0061\n+}"}, {"sha": "7b9a3c9ef2c6c2cbf0cb3e3df3650e6ce997435e", "filename": "tests/ui/argument-suggestions/issue-109831.stderr", "status": "added", "additions": 51, "deletions": 0, "changes": 51, "blob_url": "https://github.com/rust-lang/rust/blob/b80ee3969fcaeb2bfb4e82808b725964d2356448/tests%2Fui%2Fargument-suggestions%2Fissue-109831.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b80ee3969fcaeb2bfb4e82808b725964d2356448/tests%2Fui%2Fargument-suggestions%2Fissue-109831.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fargument-suggestions%2Fissue-109831.stderr?ref=b80ee3969fcaeb2bfb4e82808b725964d2356448", "patch": "@@ -0,0 +1,51 @@\n+error[E0412]: cannot find type `C` in this scope\n+  --> $DIR/issue-109831.rs:4:24\n+   |\n+LL | struct A;\n+   | --------- similarly named struct `A` defined here\n+...\n+LL | fn f(b1: B, b2: B, a2: C) {}\n+   |                        ^\n+   |\n+help: a struct with a similar name exists\n+   |\n+LL | fn f(b1: B, b2: B, a2: A) {}\n+   |                        ~\n+help: you might be missing a type parameter\n+   |\n+LL | fn f<C>(b1: B, b2: B, a2: C) {}\n+   |     +++\n+\n+error[E0425]: cannot find value `C` in this scope\n+  --> $DIR/issue-109831.rs:7:16\n+   |\n+LL | struct A;\n+   | --------- similarly named unit struct `A` defined here\n+...\n+LL |     f(A, A, B, C);\n+   |                ^ help: a unit struct with a similar name exists: `A`\n+\n+error[E0061]: this function takes 3 arguments but 4 arguments were supplied\n+  --> $DIR/issue-109831.rs:7:5\n+   |\n+LL |     f(A, A, B, C);\n+   |     ^ -  -     - unexpected argument\n+   |       |  |\n+   |       |  expected `B`, found `A`\n+   |       expected `B`, found `A`\n+   |\n+note: function defined here\n+  --> $DIR/issue-109831.rs:4:4\n+   |\n+LL | fn f(b1: B, b2: B, a2: C) {}\n+   |    ^ -----  -----  -----\n+help: remove the extra argument\n+   |\n+LL -     f(A, A, B, C);\n+LL +     f(/* B */, /* B */, B);\n+   |\n+\n+error: aborting due to 3 previous errors\n+\n+Some errors have detailed explanations: E0061, E0412, E0425.\n+For more information about an error, try `rustc --explain E0061`."}]}