{"sha": "1a3a7f42373e1115c9868d2f7173a302e79d6d12", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFhM2E3ZjQyMzczZTExMTVjOTg2OGQyZjcxNzNhMzAyZTc5ZDZkMTI=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2020-07-02T14:02:52Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-07-02T14:02:52Z"}, "message": "Merge #5188\n\n5188: Implement StatusBar r=matklad a=matklad\n\n\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>", "tree": {"sha": "163308ea226abf520bc819ead1d554e5d9cedd58", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/163308ea226abf520bc819ead1d554e5d9cedd58"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1a3a7f42373e1115c9868d2f7173a302e79d6d12", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJe/ekMCRBK7hj4Ov3rIwAAdHIIAFHNk3jX9uWfDkdC+EeONelb\nlK+CJ+hG6v6JcZ2iXhTck7f2ocHvmCgO8Bk79+zXX6wJhSm/9N51PSQvBZ6eVIU5\n7/Sb4bWT0VMrwUdvjojIPYqReMRae2qV2otfZ2HQffxKzWJ84iSizwzglqjOp+GS\nyfxIIP4b+yE0St/yDoDMNDjewkPe/NMGmlVpw6eY7wHsxim0ogQ+rDk/nV9sWxyq\n4Qs/HZi6PgS8BdZLRvWT7zRQm9CJzfjaxxveYDVFw1+Qgo2aeD0APTrQMnzQgQ8o\n/sEGeInWVn3yp5IHxNTX/z4AnGzF/M8dVW+ekCB3vCWytQiC6uidnOGmOUfZF6g=\n=aUAr\n-----END PGP SIGNATURE-----\n", "payload": "tree 163308ea226abf520bc819ead1d554e5d9cedd58\nparent e75b4fc85e82c749d1b961841b55ca1345fdf6f7\nparent 4f26a3734ea3ca9da658c2c33c11ef4b87fddf89\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1593698572 +0000\ncommitter GitHub <noreply@github.com> 1593698572 +0000\n\nMerge #5188\n\n5188: Implement StatusBar r=matklad a=matklad\n\n\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1a3a7f42373e1115c9868d2f7173a302e79d6d12", "html_url": "https://github.com/rust-lang/rust/commit/1a3a7f42373e1115c9868d2f7173a302e79d6d12", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1a3a7f42373e1115c9868d2f7173a302e79d6d12/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e75b4fc85e82c749d1b961841b55ca1345fdf6f7", "url": "https://api.github.com/repos/rust-lang/rust/commits/e75b4fc85e82c749d1b961841b55ca1345fdf6f7", "html_url": "https://github.com/rust-lang/rust/commit/e75b4fc85e82c749d1b961841b55ca1345fdf6f7"}, {"sha": "4f26a3734ea3ca9da658c2c33c11ef4b87fddf89", "url": "https://api.github.com/repos/rust-lang/rust/commits/4f26a3734ea3ca9da658c2c33c11ef4b87fddf89", "html_url": "https://github.com/rust-lang/rust/commit/4f26a3734ea3ca9da658c2c33c11ef4b87fddf89"}], "stats": {"total": 156, "additions": 144, "deletions": 12}, "files": [{"sha": "21acfe6445e2dc80118a1456b14146f860bf9510", "filename": "crates/rust-analyzer/src/config.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1a3a7f42373e1115c9868d2f7173a302e79d6d12/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1a3a7f42373e1115c9868d2f7173a302e79d6d12/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs?ref=1a3a7f42373e1115c9868d2f7173a302e79d6d12", "patch": "@@ -130,6 +130,7 @@ pub struct ClientCapsConfig {\n     pub code_action_group: bool,\n     pub resolve_code_action: bool,\n     pub hover_actions: bool,\n+    pub status_notification: bool,\n }\n \n impl Config {\n@@ -365,6 +366,7 @@ impl Config {\n             self.client_caps.code_action_group = get_bool(\"codeActionGroup\");\n             self.client_caps.resolve_code_action = get_bool(\"resolveCodeAction\");\n             self.client_caps.hover_actions = get_bool(\"hoverActions\");\n+            self.client_caps.status_notification = get_bool(\"statusNotification\");\n         }\n     }\n }"}, {"sha": "640b3959df21b406f7635ebfc44b9305f0af5cec", "filename": "crates/rust-analyzer/src/global_state.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1a3a7f42373e1115c9868d2f7173a302e79d6d12/crates%2Frust-analyzer%2Fsrc%2Fglobal_state.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1a3a7f42373e1115c9868d2f7173a302e79d6d12/crates%2Frust-analyzer%2Fsrc%2Fglobal_state.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fglobal_state.rs?ref=1a3a7f42373e1115c9868d2f7173a302e79d6d12", "patch": "@@ -31,6 +31,8 @@ use crate::{\n pub(crate) enum Status {\n     Loading,\n     Ready,\n+    Invalid,\n+    NeedsReload,\n }\n \n impl Default for Status {"}, {"sha": "d225ad5ff3bfc673413a7c182e14b6c89e9aa217", "filename": "crates/rust-analyzer/src/lsp_ext.rs", "status": "modified", "additions": 17, "deletions": 1, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/1a3a7f42373e1115c9868d2f7173a302e79d6d12/crates%2Frust-analyzer%2Fsrc%2Flsp_ext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1a3a7f42373e1115c9868d2f7173a302e79d6d12/crates%2Frust-analyzer%2Fsrc%2Flsp_ext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Flsp_ext.rs?ref=1a3a7f42373e1115c9868d2f7173a302e79d6d12", "patch": "@@ -3,7 +3,7 @@\n use std::{collections::HashMap, path::PathBuf};\n \n use lsp_types::request::Request;\n-use lsp_types::{Position, Range, TextDocumentIdentifier};\n+use lsp_types::{notification::Notification, Position, Range, TextDocumentIdentifier};\n use serde::{Deserialize, Serialize};\n \n pub enum AnalyzerStatus {}\n@@ -208,6 +208,22 @@ pub struct SsrParams {\n     pub parse_only: bool,\n }\n \n+pub enum StatusNotification {}\n+\n+#[serde(rename_all = \"camelCase\")]\n+#[derive(Serialize, Deserialize)]\n+pub enum Status {\n+    Loading,\n+    Ready,\n+    NeedsReload,\n+    Invalid,\n+}\n+\n+impl Notification for StatusNotification {\n+    type Params = Status;\n+    const METHOD: &'static str = \"rust-analyzer/status\";\n+}\n+\n pub enum CodeActionRequest {}\n \n impl Request for CodeActionRequest {"}, {"sha": "d4d18a8082b10c41b60df489bfbdbb19ac1388e2", "filename": "crates/rust-analyzer/src/main_loop.rs", "status": "modified", "additions": 52, "deletions": 4, "changes": 56, "blob_url": "https://github.com/rust-lang/rust/blob/1a3a7f42373e1115c9868d2f7173a302e79d6d12/crates%2Frust-analyzer%2Fsrc%2Fmain_loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1a3a7f42373e1115c9868d2f7173a302e79d6d12/crates%2Frust-analyzer%2Fsrc%2Fmain_loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fmain_loop.rs?ref=1a3a7f42373e1115c9868d2f7173a302e79d6d12", "patch": "@@ -111,6 +111,35 @@ impl GlobalState {\n     }\n \n     fn run(mut self, inbox: Receiver<lsp_server::Message>) -> Result<()> {\n+        let registration_options = lsp_types::TextDocumentRegistrationOptions {\n+            document_selector: Some(vec![\n+                lsp_types::DocumentFilter {\n+                    language: None,\n+                    scheme: None,\n+                    pattern: Some(\"**/*.rs\".into()),\n+                },\n+                lsp_types::DocumentFilter {\n+                    language: None,\n+                    scheme: None,\n+                    pattern: Some(\"**/Cargo.toml\".into()),\n+                },\n+                lsp_types::DocumentFilter {\n+                    language: None,\n+                    scheme: None,\n+                    pattern: Some(\"**/Cargo.lock\".into()),\n+                },\n+            ]),\n+        };\n+        let registration = lsp_types::Registration {\n+            id: \"textDocument/didSave\".to_string(),\n+            method: \"textDocument/didSave\".to_string(),\n+            register_options: Some(serde_json::to_value(registration_options).unwrap()),\n+        };\n+        self.send_request::<lsp_types::request::RegisterCapability>(\n+            lsp_types::RegistrationParams { registrations: vec![registration] },\n+            |_, _| (),\n+        );\n+\n         self.reload();\n \n         while let Some(event) = self.next_event(&inbox) {\n@@ -169,16 +198,16 @@ impl GlobalState {\n                 }\n                 vfs::loader::Message::Progress { n_total, n_done } => {\n                     if n_total == 0 {\n-                        self.status = Status::Ready;\n+                        self.transition(Status::Invalid);\n                     } else {\n                         let state = if n_done == 0 {\n-                            self.status = Status::Loading;\n+                            self.transition(Status::Loading);\n                             Progress::Begin\n                         } else if n_done < n_total {\n                             Progress::Report\n                         } else {\n                             assert_eq!(n_done, n_total);\n-                            self.status = Status::Ready;\n+                            self.transition(Status::Ready);\n                             Progress::End\n                         };\n                         self.report_progress(\n@@ -274,6 +303,19 @@ impl GlobalState {\n         Ok(())\n     }\n \n+    fn transition(&mut self, new_status: Status) {\n+        self.status = Status::Ready;\n+        if self.config.client_caps.status_notification {\n+            let lsp_status = match new_status {\n+                Status::Loading => lsp_ext::Status::Loading,\n+                Status::Ready => lsp_ext::Status::Ready,\n+                Status::Invalid => lsp_ext::Status::Invalid,\n+                Status::NeedsReload => lsp_ext::Status::NeedsReload,\n+            };\n+            self.send_notification::<lsp_ext::StatusNotification>(lsp_status);\n+        }\n+    }\n+\n     fn on_request(&mut self, request_received: Instant, req: Request) -> Result<()> {\n         self.register_request(&req, request_received);\n \n@@ -383,10 +425,16 @@ impl GlobalState {\n                 );\n                 Ok(())\n             })?\n-            .on::<lsp_types::notification::DidSaveTextDocument>(|this, _params| {\n+            .on::<lsp_types::notification::DidSaveTextDocument>(|this, params| {\n                 if let Some(flycheck) = &this.flycheck {\n                     flycheck.handle.update();\n                 }\n+                let uri = params.text_document.uri.as_str();\n+                if uri.ends_with(\"Cargo.toml\") || uri.ends_with(\"Cargo.lock\") {\n+                    if matches!(this.status, Status::Ready | Status::Invalid) {\n+                        this.transition(Status::NeedsReload);\n+                    }\n+                }\n                 Ok(())\n             })?\n             .on::<lsp_types::notification::DidChangeConfiguration>(|this, _params| {"}, {"sha": "523b04b97a66aa4ab0e4482fac0d8bbc26e103e7", "filename": "crates/rust-analyzer/src/reload.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1a3a7f42373e1115c9868d2f7173a302e79d6d12/crates%2Frust-analyzer%2Fsrc%2Freload.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1a3a7f42373e1115c9868d2f7173a302e79d6d12/crates%2Frust-analyzer%2Fsrc%2Freload.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Freload.rs?ref=1a3a7f42373e1115c9868d2f7173a302e79d6d12", "patch": "@@ -78,7 +78,7 @@ impl GlobalState {\n                     .collect(),\n             };\n             let registration = lsp_types::Registration {\n-                id: \"file-watcher\".to_string(),\n+                id: \"workspace/didChangeWatchedFiles\".to_string(),\n                 method: \"workspace/didChangeWatchedFiles\".to_string(),\n                 register_options: Some(serde_json::to_value(registration_options).unwrap()),\n             };"}, {"sha": "7bf687794c3432d48c536c12b26d7385758f93c8", "filename": "crates/rust-analyzer/tests/heavy_tests/support.rs", "status": "modified", "additions": 12, "deletions": 5, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/1a3a7f42373e1115c9868d2f7173a302e79d6d12/crates%2Frust-analyzer%2Ftests%2Fheavy_tests%2Fsupport.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1a3a7f42373e1115c9868d2f7173a302e79d6d12/crates%2Frust-analyzer%2Ftests%2Fheavy_tests%2Fsupport.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Ftests%2Fheavy_tests%2Fsupport.rs?ref=1a3a7f42373e1115c9868d2f7173a302e79d6d12", "patch": "@@ -176,12 +176,19 @@ impl Server {\n         while let Some(msg) = self.recv() {\n             match msg {\n                 Message::Request(req) => {\n-                    if req.method != \"window/workDoneProgress/create\"\n-                        && !(req.method == \"client/registerCapability\"\n-                            && req.params.to_string().contains(\"workspace/didChangeWatchedFiles\"))\n-                    {\n-                        panic!(\"unexpected request: {:?}\", req)\n+                    if req.method == \"window/workDoneProgress/create\" {\n+                        continue;\n                     }\n+                    if req.method == \"client/registerCapability\" {\n+                        let params = req.params.to_string();\n+                        if [\"workspace/didChangeWatchedFiles\", \"textDocument/didSave\"]\n+                            .iter()\n+                            .any(|&it| params.contains(it))\n+                        {\n+                            continue;\n+                        }\n+                    }\n+                    panic!(\"unexpected request: {:?}\", req)\n                 }\n                 Message::Notification(_) => (),\n                 Message::Response(res) => {"}, {"sha": "6d6bbac7ca1d959e54098917110f7c8132a031fc", "filename": "docs/dev/lsp-extensions.md", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/1a3a7f42373e1115c9868d2f7173a302e79d6d12/docs%2Fdev%2Flsp-extensions.md", "raw_url": "https://github.com/rust-lang/rust/raw/1a3a7f42373e1115c9868d2f7173a302e79d6d12/docs%2Fdev%2Flsp-extensions.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/docs%2Fdev%2Flsp-extensions.md?ref=1a3a7f42373e1115c9868d2f7173a302e79d6d12", "patch": "@@ -399,6 +399,18 @@ Returns internal status message, mostly for debugging purposes.\n \n Reloads project information (that is, re-executes `cargo metadata`).\n \n+## Status Notification\n+\n+**Client Capability:** `{ \"statusNotification\": boolean }`\n+\n+**Method:** `rust-analyzer/status`\n+\n+**Notification:** `\"loading\" | \"ready\" | \"invalid\" | \"needsReload\"`\n+\n+This notification is sent from server to client.\n+The client can use it to display persistent status to the user (in modline).\n+For `needsReload` state, the client can provide a context-menu action to run `rust-analyzer/reloadWorkspace` request.\n+\n ## Syntax Tree\n \n **Method:** `rust-analyzer/syntaxTree`"}, {"sha": "3e5915c28d4bd059a1d97680ecff6401187de5f4", "filename": "editors/code/src/client.ts", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/1a3a7f42373e1115c9868d2f7173a302e79d6d12/editors%2Fcode%2Fsrc%2Fclient.ts", "raw_url": "https://github.com/rust-lang/rust/raw/1a3a7f42373e1115c9868d2f7173a302e79d6d12/editors%2Fcode%2Fsrc%2Fclient.ts", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fsrc%2Fclient.ts?ref=1a3a7f42373e1115c9868d2f7173a302e79d6d12", "patch": "@@ -161,6 +161,7 @@ class ExperimentalFeatures implements lc.StaticFeature {\n         caps.codeActionGroup = true;\n         caps.resolveCodeAction = true;\n         caps.hoverActions = true;\n+        caps.statusNotification = true;\n         capabilities.experimental = caps;\n     }\n     initialize(_capabilities: lc.ServerCapabilities<any>, _documentSelector: lc.DocumentSelector | undefined): void {"}, {"sha": "6e767babf449ea20cc6595e91b4606a7b895d34b", "filename": "editors/code/src/ctx.ts", "status": "modified", "additions": 42, "deletions": 1, "changes": 43, "blob_url": "https://github.com/rust-lang/rust/blob/1a3a7f42373e1115c9868d2f7173a302e79d6d12/editors%2Fcode%2Fsrc%2Fctx.ts", "raw_url": "https://github.com/rust-lang/rust/raw/1a3a7f42373e1115c9868d2f7173a302e79d6d12/editors%2Fcode%2Fsrc%2Fctx.ts", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fsrc%2Fctx.ts?ref=1a3a7f42373e1115c9868d2f7173a302e79d6d12", "patch": "@@ -1,16 +1,19 @@\n import * as vscode from 'vscode';\n import * as lc from 'vscode-languageclient';\n+import * as ra from './lsp_ext';\n \n import { Config } from './config';\n import { createClient } from './client';\n import { isRustEditor, RustEditor } from './util';\n+import { Status } from './lsp_ext';\n \n export class Ctx {\n     private constructor(\n         readonly config: Config,\n         private readonly extCtx: vscode.ExtensionContext,\n         readonly client: lc.LanguageClient,\n         readonly serverPath: string,\n+        readonly statusBar: vscode.StatusBarItem,\n     ) {\n \n     }\n@@ -22,9 +25,18 @@ export class Ctx {\n         cwd: string,\n     ): Promise<Ctx> {\n         const client = createClient(serverPath, cwd);\n-        const res = new Ctx(config, extCtx, client, serverPath);\n+\n+        const statusBar = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n+        extCtx.subscriptions.push(statusBar);\n+        statusBar.text = \"rust-analyzer\";\n+        statusBar.tooltip = \"ready\";\n+        statusBar.show();\n+\n+        const res = new Ctx(config, extCtx, client, serverPath, statusBar);\n+\n         res.pushCleanup(client.start());\n         await client.onReady();\n+        client.onNotification(ra.status, (status) => res.setStatus(status));\n         return res;\n     }\n \n@@ -54,6 +66,35 @@ export class Ctx {\n         return this.extCtx.subscriptions;\n     }\n \n+    setStatus(status: Status) {\n+        switch (status) {\n+            case \"loading\":\n+                this.statusBar.text = \"$(sync~spin) rust-analyzer\";\n+                this.statusBar.tooltip = \"Loading the project\";\n+                this.statusBar.command = undefined;\n+                this.statusBar.color = undefined;\n+                break;\n+            case \"ready\":\n+                this.statusBar.text = \"rust-analyzer\";\n+                this.statusBar.tooltip = \"Ready\";\n+                this.statusBar.command = undefined;\n+                this.statusBar.color = undefined;\n+                break;\n+            case \"invalid\":\n+                this.statusBar.text = \"$(error) rust-analyzer\";\n+                this.statusBar.tooltip = \"Failed to load the project\";\n+                this.statusBar.command = undefined;\n+                this.statusBar.color = new vscode.ThemeColor(\"notificationsErrorIcon.foreground\");\n+                break;\n+            case \"needsReload\":\n+                this.statusBar.text = \"$(warning) rust-analyzer\";\n+                this.statusBar.tooltip = \"Click to reload\";\n+                this.statusBar.command = \"rust-analyzer.reloadWorkspace\";\n+                this.statusBar.color = new vscode.ThemeColor(\"notificationsWarningIcon.foreground\");\n+                break;\n+        }\n+    }\n+\n     pushCleanup(d: Disposable) {\n         this.extCtx.subscriptions.push(d);\n     }"}, {"sha": "bf4703239d1e21a4f7d7783cdf00eb9d6969b777", "filename": "editors/code/src/lsp_ext.ts", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/1a3a7f42373e1115c9868d2f7173a302e79d6d12/editors%2Fcode%2Fsrc%2Flsp_ext.ts", "raw_url": "https://github.com/rust-lang/rust/raw/1a3a7f42373e1115c9868d2f7173a302e79d6d12/editors%2Fcode%2Fsrc%2Flsp_ext.ts", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fsrc%2Flsp_ext.ts?ref=1a3a7f42373e1115c9868d2f7173a302e79d6d12", "patch": "@@ -6,6 +6,9 @@ import * as lc from \"vscode-languageclient\";\n \n export const analyzerStatus = new lc.RequestType<null, string, void>(\"rust-analyzer/analyzerStatus\");\n \n+export type Status = \"loading\" | \"ready\" | \"invalid\" | \"needsReload\";\n+export const status = new lc.NotificationType<Status>(\"rust-analyzer/status\");\n+\n export const reloadWorkspace = new lc.RequestType<null, null, void>(\"rust-analyzer/reloadWorkspace\");\n \n export interface SyntaxTreeParams {"}]}