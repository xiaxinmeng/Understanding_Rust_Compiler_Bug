{"sha": "20b20b23eac9809172eeaab71a3952ec53d37ce6", "node_id": "C_kwDOAAsO6NoAKDIwYjIwYjIzZWFjOTgwOTE3MmVlYWFiNzFhMzk1MmVjNTNkMzdjZTY", "commit": {"author": {"name": "Ali MJ Al-Nasrawy", "email": "alimjalnasrawy@gmail.com", "date": "2023-03-03T03:46:23Z"}, "committer": {"name": "Ali MJ Al-Nasrawy", "email": "alimjalnasrawy@gmail.com", "date": "2023-03-03T08:10:40Z"}, "message": "add known-bug tests", "tree": {"sha": "2bcfd31a9acd7e64ba33f34d4ca5033186c5d8ce", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2bcfd31a9acd7e64ba33f34d4ca5033186c5d8ce"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/20b20b23eac9809172eeaab71a3952ec53d37ce6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/20b20b23eac9809172eeaab71a3952ec53d37ce6", "html_url": "https://github.com/rust-lang/rust/commit/20b20b23eac9809172eeaab71a3952ec53d37ce6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/20b20b23eac9809172eeaab71a3952ec53d37ce6/comments", "author": {"login": "aliemjay", "id": 28497461, "node_id": "MDQ6VXNlcjI4NDk3NDYx", "avatar_url": "https://avatars.githubusercontent.com/u/28497461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aliemjay", "html_url": "https://github.com/aliemjay", "followers_url": "https://api.github.com/users/aliemjay/followers", "following_url": "https://api.github.com/users/aliemjay/following{/other_user}", "gists_url": "https://api.github.com/users/aliemjay/gists{/gist_id}", "starred_url": "https://api.github.com/users/aliemjay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aliemjay/subscriptions", "organizations_url": "https://api.github.com/users/aliemjay/orgs", "repos_url": "https://api.github.com/users/aliemjay/repos", "events_url": "https://api.github.com/users/aliemjay/events{/privacy}", "received_events_url": "https://api.github.com/users/aliemjay/received_events", "type": "User", "site_admin": false}, "committer": {"login": "aliemjay", "id": 28497461, "node_id": "MDQ6VXNlcjI4NDk3NDYx", "avatar_url": "https://avatars.githubusercontent.com/u/28497461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aliemjay", "html_url": "https://github.com/aliemjay", "followers_url": "https://api.github.com/users/aliemjay/followers", "following_url": "https://api.github.com/users/aliemjay/following{/other_user}", "gists_url": "https://api.github.com/users/aliemjay/gists{/gist_id}", "starred_url": "https://api.github.com/users/aliemjay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aliemjay/subscriptions", "organizations_url": "https://api.github.com/users/aliemjay/orgs", "repos_url": "https://api.github.com/users/aliemjay/repos", "events_url": "https://api.github.com/users/aliemjay/events{/privacy}", "received_events_url": "https://api.github.com/users/aliemjay/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "13471d3b2046cce78181dde6cfc146c09f55e29e", "url": "https://api.github.com/repos/rust-lang/rust/commits/13471d3b2046cce78181dde6cfc146c09f55e29e", "html_url": "https://github.com/rust-lang/rust/commit/13471d3b2046cce78181dde6cfc146c09f55e29e"}], "stats": {"total": 137, "additions": 137, "deletions": 0}, "files": [{"sha": "623e5e1a71fdc91d215a0de1f83fa5faf5f028aa", "filename": "tests/ui/nll/closure-requirements/type-test-subject-non-trivial-region.rs", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-non-trivial-region.rs", "raw_url": "https://github.com/rust-lang/rust/raw/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-non-trivial-region.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-non-trivial-region.rs?ref=20b20b23eac9809172eeaab71a3952ec53d37ce6", "patch": "@@ -0,0 +1,19 @@\n+// chek-fail\n+// known-bug: #108639\n+\n+trait Trait {\n+    type Item<'a>: 'a;\n+}\n+\n+fn assert_static<T: 'static>(_: T) {}\n+fn relate<T>(_: T, _: T) {}\n+\n+fn test_args<I: Trait>() {\n+    let closure = |a, b| {\n+        relate(&a, b);\n+        assert_static(a);\n+    };\n+    closure(None::<I::Item<'_>>, &None::<I::Item<'_>>);\n+}\n+\n+fn main() {}"}, {"sha": "83f0b64d5a7373773fc397c433d66aec85922184", "filename": "tests/ui/nll/closure-requirements/type-test-subject-non-trivial-region.stderr", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-non-trivial-region.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-non-trivial-region.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-non-trivial-region.stderr?ref=20b20b23eac9809172eeaab71a3952ec53d37ce6", "patch": "@@ -0,0 +1,12 @@\n+error[E0310]: the associated type `<I as Trait>::Item<'_>` may not live long enough\n+  --> $DIR/type-test-subject-non-trivial-region.rs:14:9\n+   |\n+LL |         assert_static(a);\n+   |         ^^^^^^^^^^^^^^^^\n+   |\n+   = help: consider adding an explicit lifetime bound `<I as Trait>::Item<'_>: 'static`...\n+   = note: ...so that the type `<I as Trait>::Item<'_>` will meet its required lifetime bounds\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0310`."}, {"sha": "4e0158336695226b826246059150ffce68b06652", "filename": "tests/ui/nll/closure-requirements/type-test-subject-opaque-1.rs", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-opaque-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-opaque-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-opaque-1.rs?ref=20b20b23eac9809172eeaab71a3952ec53d37ce6", "patch": "@@ -0,0 +1,18 @@\n+// check-fail\n+// known-bug: #107426\n+\n+use std::marker::PhantomData;\n+#[derive(Clone, Copy)]\n+pub struct Scope<'a>(&'a PhantomData<&'a mut &'a ()>);\n+fn event<'a, F: FnMut() + 'a>(_: Scope<'a>, _: F) {}\n+fn make_fn<'a>(_: Scope<'a>) -> impl Fn() + Copy + 'a {\n+    || {}\n+}\n+\n+fn foo(cx: Scope) {\n+    let open_toggle = make_fn(cx);\n+\n+    || event(cx, open_toggle);\n+}\n+\n+fn main() {}"}, {"sha": "e54bc8406de48b192c372f92a51ffaebbb3a0a0b", "filename": "tests/ui/nll/closure-requirements/type-test-subject-opaque-1.stderr", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-opaque-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-opaque-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-opaque-1.stderr?ref=20b20b23eac9809172eeaab71a3952ec53d37ce6", "patch": "@@ -0,0 +1,8 @@\n+error: `make_fn::{opaque#0}<'_>` does not live long enough\n+  --> $DIR/type-test-subject-opaque-1.rs:15:8\n+   |\n+LL |     || event(cx, open_toggle);\n+   |        ^^^^^^^^^^^^^^^^^^^^^^\n+\n+error: aborting due to previous error\n+"}, {"sha": "fc1923bb76f1fc35ae9f9d94eb2d358dd03500a0", "filename": "tests/ui/nll/closure-requirements/type-test-subject-opaque-2.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-opaque-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-opaque-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-opaque-2.rs?ref=20b20b23eac9809172eeaab71a3952ec53d37ce6", "patch": "@@ -0,0 +1,17 @@\n+// check-fail\n+// known-bug: #107516\n+\n+fn iter1<'a: 'a>() -> impl Iterator<Item = &'static str> {\n+    None.into_iter()\n+}\n+\n+fn iter2<'a>() -> impl Iterator<Item = &'a str> {\n+    None.into_iter()\n+}\n+\n+struct Bivar<'a, I: Iterator<Item = &'a str> + 'a>(I);\n+\n+fn main() {\n+    let _ = || Bivar(iter1());\n+    let _ = || Bivar(iter2());\n+}"}, {"sha": "f6266dd4eb5dce21d6f2e59b0d07109036deb289", "filename": "tests/ui/nll/closure-requirements/type-test-subject-opaque-2.stderr", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-opaque-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-opaque-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-opaque-2.stderr?ref=20b20b23eac9809172eeaab71a3952ec53d37ce6", "patch": "@@ -0,0 +1,18 @@\n+error[E0310]: the opaque type `iter1<'_>::{opaque#0}` may not live long enough\n+  --> $DIR/type-test-subject-opaque-2.rs:15:16\n+   |\n+LL |     let _ = || Bivar(iter1());\n+   |                ^^^^^^^^^^^^^^\n+   |\n+   = help: consider adding an explicit lifetime bound `iter1<'_>::{opaque#0}: 'static`...\n+   = note: ...so that the type `impl Iterator<Item = &'static str>` will meet its required lifetime bounds\n+\n+error: `iter2<'_>::{opaque#0}<'_>` does not live long enough\n+  --> $DIR/type-test-subject-opaque-2.rs:16:16\n+   |\n+LL |     let _ = || Bivar(iter2());\n+   |                ^^^^^^^^^^^^^^\n+\n+error: aborting due to 2 previous errors\n+\n+For more information about this error, try `rustc --explain E0310`."}, {"sha": "25ce0891a8a6694a8b45b3cd7b950024b999dc4e", "filename": "tests/ui/nll/closure-requirements/type-test-subject-unnamed-region.rs", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-unnamed-region.rs", "raw_url": "https://github.com/rust-lang/rust/raw/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-unnamed-region.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-unnamed-region.rs?ref=20b20b23eac9809172eeaab71a3952ec53d37ce6", "patch": "@@ -0,0 +1,24 @@\n+// check-fail\n+// known-bug: #108635\n+\n+trait Trait {\n+    type Item<'a>: 'a;\n+}\n+\n+fn assert_static<T: 'static>(_: T) {}\n+\n+fn test_args<I: Trait>() {\n+    let closure = |a, _b| assert_static(a);\n+\n+    closure(None::<I::Item<'_>>, &None::<I::Item<'_>>);\n+}\n+\n+fn test_upvars<I: Trait>() {\n+    let upvars = (None::<I::Item<'_>>, &None::<I::Item<'_>>);\n+    let _closure = || {\n+        let (a, _b) = upvars;\n+        assert_static(a);\n+    };\n+}\n+\n+fn main() {}"}, {"sha": "201329bb005cae9f3e4e8df88c9072d61bdd52ad", "filename": "tests/ui/nll/closure-requirements/type-test-subject-unnamed-region.stderr", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-unnamed-region.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/20b20b23eac9809172eeaab71a3952ec53d37ce6/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-unnamed-region.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fnll%2Fclosure-requirements%2Ftype-test-subject-unnamed-region.stderr?ref=20b20b23eac9809172eeaab71a3952ec53d37ce6", "patch": "@@ -0,0 +1,21 @@\n+error[E0310]: the associated type `<I as Trait>::Item<'_>` may not live long enough\n+  --> $DIR/type-test-subject-unnamed-region.rs:11:27\n+   |\n+LL |     let closure = |a, _b| assert_static(a);\n+   |                           ^^^^^^^^^^^^^^^^\n+   |\n+   = help: consider adding an explicit lifetime bound `<I as Trait>::Item<'_>: 'static`...\n+   = note: ...so that the type `<I as Trait>::Item<'_>` will meet its required lifetime bounds\n+\n+error[E0310]: the associated type `<I as Trait>::Item<'_>` may not live long enough\n+  --> $DIR/type-test-subject-unnamed-region.rs:20:9\n+   |\n+LL |         assert_static(a);\n+   |         ^^^^^^^^^^^^^^^^\n+   |\n+   = help: consider adding an explicit lifetime bound `<I as Trait>::Item<'_>: 'static`...\n+   = note: ...so that the type `<I as Trait>::Item<'_>` will meet its required lifetime bounds\n+\n+error: aborting due to 2 previous errors\n+\n+For more information about this error, try `rustc --explain E0310`."}]}