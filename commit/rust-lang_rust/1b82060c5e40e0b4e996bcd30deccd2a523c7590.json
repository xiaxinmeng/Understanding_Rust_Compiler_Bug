{"sha": "1b82060c5e40e0b4e996bcd30deccd2a523c7590", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFiODIwNjBjNWU0MGUwYjRlOTk2YmNkMzBkZWNjZDJhNTIzYzc1OTA=", "commit": {"author": {"name": "Rafael \u00c1vila de Esp\u00edndola", "email": "respindola@mozilla.com", "date": "2011-01-25T23:15:19Z"}, "committer": {"name": "Rafael \u00c1vila de Esp\u00edndola", "email": "respindola@mozilla.com", "date": "2011-01-25T23:16:52Z"}, "message": "Print an error if we try to refer to a module in an expr_path.", "tree": {"sha": "13eb7356df6235fb560be3a8e5d5310c71b774d4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/13eb7356df6235fb560be3a8e5d5310c71b774d4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1b82060c5e40e0b4e996bcd30deccd2a523c7590", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1b82060c5e40e0b4e996bcd30deccd2a523c7590", "html_url": "https://github.com/rust-lang/rust/commit/1b82060c5e40e0b4e996bcd30deccd2a523c7590", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1b82060c5e40e0b4e996bcd30deccd2a523c7590/comments", "author": null, "committer": null, "parents": [{"sha": "9e2324ad1e3f2abf528fbbbdafe2cb8a18c3151d", "url": "https://api.github.com/repos/rust-lang/rust/commits/9e2324ad1e3f2abf528fbbbdafe2cb8a18c3151d", "html_url": "https://github.com/rust-lang/rust/commit/9e2324ad1e3f2abf528fbbbdafe2cb8a18c3151d"}], "stats": {"total": 23, "additions": 22, "deletions": 1}, "files": [{"sha": "8ad5c4bccf9537c2c2be8229e0f20a767723df3b", "filename": "src/Makefile", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/1b82060c5e40e0b4e996bcd30deccd2a523c7590/src%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/1b82060c5e40e0b4e996bcd30deccd2a523c7590/src%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2FMakefile?ref=1b82060c5e40e0b4e996bcd30deccd2a523c7590", "patch": "@@ -504,6 +504,7 @@ TEST_XFAILS_RUSTC := $(filter-out \\\n                         arg-count-mismatch.rs \\\n                         arg-type-mismatch.rs \\\n                         bad-expr-path.rs \\\n+                        bad-expr-path2.rs \\\n                         import.rs \\\n                         import2.rs \\\n                         import3.rs \\"}, {"sha": "f372e3d73f67ae7d4b663bc37d056af3304484bc", "filename": "src/comp/middle/resolve.rs", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/1b82060c5e40e0b4e996bcd30deccd2a523c7590/src%2Fcomp%2Fmiddle%2Fresolve.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1b82060c5e40e0b4e996bcd30deccd2a523c7590/src%2Fcomp%2Fmiddle%2Fresolve.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Fresolve.rs?ref=1b82060c5e40e0b4e996bcd30deccd2a523c7590", "patch": "@@ -444,7 +444,17 @@ fn fold_expr_path(&env e, &span sp, &ast.path p, &option.t[def] d,\n     // the expr_field(expr_field(...(expr_path(...)))) we should return.\n \n     auto index = new_def_hash[def_wrap]();\n-    find_final_def(e, index, sp, p.node.idents, none[ast.def_id]);\n+    auto d = find_final_def(e, index, sp, p.node.idents, none[ast.def_id]);\n+    alt (d) {\n+        case (def_wrap_expr_field(_)) {\n+        }\n+        case (def_wrap_other(_)) {\n+        }\n+        case (def_wrap_mod(?m)) {\n+            e.sess.span_err(sp,\n+                            \"can't refer to a module as a first-class value\");\n+        }\n+    }\n \n     auto p_ = rec(node=rec(idents = vec(id0) with p.node) with p);\n     auto ex = @fold.respan[ast.expr_](sp, ast.expr_path(p_, d_, a));"}, {"sha": "a2f58f8ede1acce01ef4992599301daea8ba946e", "filename": "src/test/compile-fail/bad-expr-path2.rs", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/1b82060c5e40e0b4e996bcd30deccd2a523c7590/src%2Ftest%2Fcompile-fail%2Fbad-expr-path2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1b82060c5e40e0b4e996bcd30deccd2a523c7590/src%2Ftest%2Fcompile-fail%2Fbad-expr-path2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fbad-expr-path2.rs?ref=1b82060c5e40e0b4e996bcd30deccd2a523c7590", "patch": "@@ -0,0 +1,10 @@\n+// error-pattern: can't refer to a module as a first-class value\n+\n+mod m1 {\n+  mod a {\n+  }\n+}\n+\n+fn main(vec[str] args) {\n+  log m1.a;\n+}"}]}