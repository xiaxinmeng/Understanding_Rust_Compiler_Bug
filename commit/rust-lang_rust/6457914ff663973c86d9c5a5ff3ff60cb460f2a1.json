{"sha": "6457914ff663973c86d9c5a5ff3ff60cb460f2a1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY0NTc5MTRmZjY2Mzk3M2M4NmQ5YzVhNWZmM2ZmNjBjYjQ2MGYyYTE=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2019-10-30T15:32:40Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2019-11-01T14:06:21Z"}, "message": "ui test formulation of regression test for issue 64872.\n\n(Many thanks to alex for 1. making this even smaller than what I had\noriginally minimized, and 2. pointing out that there is precedent for\nhaving ui tests with crate dependency chains of length > 2, thus\nallowing me to avoid encoding this as a run-make test.)", "tree": {"sha": "7c9c32cc1915b965f24b3c8fdd9f906f5fd44dd4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7c9c32cc1915b965f24b3c8fdd9f906f5fd44dd4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6457914ff663973c86d9c5a5ff3ff60cb460f2a1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6457914ff663973c86d9c5a5ff3ff60cb460f2a1", "html_url": "https://github.com/rust-lang/rust/commit/6457914ff663973c86d9c5a5ff3ff60cb460f2a1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6457914ff663973c86d9c5a5ff3ff60cb460f2a1/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d21f9b7fd6d4e41257bb4a6db64e9873767374dc", "url": "https://api.github.com/repos/rust-lang/rust/commits/d21f9b7fd6d4e41257bb4a6db64e9873767374dc", "html_url": "https://github.com/rust-lang/rust/commit/d21f9b7fd6d4e41257bb4a6db64e9873767374dc"}], "stats": {"total": 61, "additions": 61, "deletions": 0}, "files": [{"sha": "82bb95f1ef2b3ca8e33d9a1f17b9ef4a7d04feb3", "filename": "src/test/ui/cross-crate/issue-64872/auxiliary/a_def_obj.rs", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/6457914ff663973c86d9c5a5ff3ff60cb460f2a1/src%2Ftest%2Fui%2Fcross-crate%2Fissue-64872%2Fauxiliary%2Fa_def_obj.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6457914ff663973c86d9c5a5ff3ff60cb460f2a1/src%2Ftest%2Fui%2Fcross-crate%2Fissue-64872%2Fauxiliary%2Fa_def_obj.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcross-crate%2Fissue-64872%2Fauxiliary%2Fa_def_obj.rs?ref=6457914ff663973c86d9c5a5ff3ff60cb460f2a1", "patch": "@@ -0,0 +1,16 @@\n+// compile-flags: -C debuginfo=2\n+\n+// no-prefer-dynamic\n+#![crate_type = \"rlib\"]\n+\n+pub trait Object { fn method(&self) { } }\n+\n+impl Object for u32 { }\n+impl Object for () { }\n+impl<T> Object for &T { }\n+\n+pub fn unused() {\n+    let ref u = 0_u32;\n+    let _d = &u as &dyn crate::Object;\n+    _d.method()\n+}"}, {"sha": "21c0274b991fce0f2b93923e1ee91a1684cfb25b", "filename": "src/test/ui/cross-crate/issue-64872/auxiliary/b_reexport_obj.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/6457914ff663973c86d9c5a5ff3ff60cb460f2a1/src%2Ftest%2Fui%2Fcross-crate%2Fissue-64872%2Fauxiliary%2Fb_reexport_obj.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6457914ff663973c86d9c5a5ff3ff60cb460f2a1/src%2Ftest%2Fui%2Fcross-crate%2Fissue-64872%2Fauxiliary%2Fb_reexport_obj.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcross-crate%2Fissue-64872%2Fauxiliary%2Fb_reexport_obj.rs?ref=6457914ff663973c86d9c5a5ff3ff60cb460f2a1", "patch": "@@ -0,0 +1,7 @@\n+// compile-flags: -C debuginfo=2 -C prefer-dynamic\n+\n+#![crate_type=\"dylib\"]\n+\n+extern crate a_def_obj;\n+\n+pub use a_def_obj::Object;"}, {"sha": "611238f56173ae9a0cf1b1e017601908492cb460", "filename": "src/test/ui/cross-crate/issue-64872/auxiliary/c_another_vtable_for_obj.rs", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/6457914ff663973c86d9c5a5ff3ff60cb460f2a1/src%2Ftest%2Fui%2Fcross-crate%2Fissue-64872%2Fauxiliary%2Fc_another_vtable_for_obj.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6457914ff663973c86d9c5a5ff3ff60cb460f2a1/src%2Ftest%2Fui%2Fcross-crate%2Fissue-64872%2Fauxiliary%2Fc_another_vtable_for_obj.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcross-crate%2Fissue-64872%2Fauxiliary%2Fc_another_vtable_for_obj.rs?ref=6457914ff663973c86d9c5a5ff3ff60cb460f2a1", "patch": "@@ -0,0 +1,12 @@\n+// no-prefer-dynamic\n+// compile-flags: -C debuginfo=2\n+#![crate_type=\"rlib\"]\n+\n+extern crate b_reexport_obj;\n+use b_reexport_obj::Object;\n+\n+pub fn another_dyn_debug() {\n+    let ref u = 1_u32;\n+    let _d = &u as &dyn crate::Object;\n+    _d.method()\n+}"}, {"sha": "8d73f9b666f1e117273d00498134459a918c6749", "filename": "src/test/ui/cross-crate/issue-64872/auxiliary/d_chain_of_rlibs_and_dylibs.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/6457914ff663973c86d9c5a5ff3ff60cb460f2a1/src%2Ftest%2Fui%2Fcross-crate%2Fissue-64872%2Fauxiliary%2Fd_chain_of_rlibs_and_dylibs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6457914ff663973c86d9c5a5ff3ff60cb460f2a1/src%2Ftest%2Fui%2Fcross-crate%2Fissue-64872%2Fauxiliary%2Fd_chain_of_rlibs_and_dylibs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcross-crate%2Fissue-64872%2Fauxiliary%2Fd_chain_of_rlibs_and_dylibs.rs?ref=6457914ff663973c86d9c5a5ff3ff60cb460f2a1", "patch": "@@ -0,0 +1,9 @@\n+// compile-flags: -C debuginfo=2 -C prefer-dynamic\n+\n+#![crate_type=\"rlib\"]\n+\n+extern crate c_another_vtable_for_obj;\n+\n+pub fn chain() {\n+    c_another_vtable_for_obj::another_dyn_debug();\n+}"}, {"sha": "20fe2053cc7c319efd075da973c674fc7c471f3e", "filename": "src/test/ui/cross-crate/issue-64872/issue-64872.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/6457914ff663973c86d9c5a5ff3ff60cb460f2a1/src%2Ftest%2Fui%2Fcross-crate%2Fissue-64872%2Fissue-64872.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6457914ff663973c86d9c5a5ff3ff60cb460f2a1/src%2Ftest%2Fui%2Fcross-crate%2Fissue-64872%2Fissue-64872.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcross-crate%2Fissue-64872%2Fissue-64872.rs?ref=6457914ff663973c86d9c5a5ff3ff60cb460f2a1", "patch": "@@ -0,0 +1,17 @@\n+// run-pass\n+\n+// note that these aux-build directives must be in this order: the\n+// later crates depend on the earlier ones. (The particular bug that\n+// is being exercised here used to exhibit itself during the build of\n+// `chain_of_rlibs_and_dylibs.dylib`)\n+\n+// aux-build:a_def_obj.rs\n+// aux-build:b_reexport_obj.rs\n+// aux-build:c_another_vtable_for_obj.rs\n+// aux-build:d_chain_of_rlibs_and_dylibs.rs\n+\n+extern crate d_chain_of_rlibs_and_dylibs;\n+\n+pub fn main() {\n+    d_chain_of_rlibs_and_dylibs::chain();\n+}"}]}