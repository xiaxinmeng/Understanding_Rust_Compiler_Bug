{"sha": "60a1759b5f2af3b15ac32b5984001e3986c4b9b1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYwYTE3NTliNWYyYWYzYjE1YWMzMmI1OTg0MDAxZTM5ODZjNGI5YjE=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-04-20T07:33:13Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-04-20T07:33:13Z"}, "message": "Add test for derives for used_underscore_binding lint\n\nThis closes #852 as I can't reproduce the original issue anymore.", "tree": {"sha": "af1a57e3672b9e05bb6d7cd602b83b7c73fd3526", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/af1a57e3672b9e05bb6d7cd602b83b7c73fd3526"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/60a1759b5f2af3b15ac32b5984001e3986c4b9b1", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJEBAABCgAuFiEEj4U0bmbiMSg/mWqvgqphyqETl+YFAly6y5kQHGRldkBwaGFu\nc2NoLm5ldAAKCRCCqmHKoROX5kwSEACV32HTe1GzSsUZC5MSaMxKeqWprQddKHu+\nBpIiPVCFroycTIri7FbW8wrn2ZX1BjLegKBlnfxW8LuKROs+NdRsyMAjIiO/HQzU\nGo449BO2jHsCW+DjecLd0zu5oi3oTNZKfhb/4fuIjxKnlTFWk9okQdJFGVMrouJ5\nhiKIrbKlzMW8nmbqFDNm8Ce739/iusN58tOIe3AYP0DcsWtCWlJBeJ6CWkpntNz5\nQG3EkUnunO3a1gEc+aI93VMQbxaD1z9cEQjMDS6zt02MYmRy68jBZw+Hf/F436EO\npnZOUiyeQgD2F9Lvn91Jv6HuXdcUX62rNOr0GHA5Qxpt1lEWrBfktdw5jGmMO8v+\np1ajOT3rrZX1QX9DGaq28fUTsCz/e34A/u4Ce1dxQOW9W1+9AOi09qZUNFydBI1p\nJ6GIhw7N0+btGizgeTWGO6sGZzzbJxdeV7m9Qk0HFqUWiyJJzVjW5/CrTcy8mZLr\npSN8qcfJRVkTzudHggAHudFsJ6bgIida+u5eE/RnbifH0MmfbBg7q2ecPbjO1DWU\nFAFpGCeqe2A5gh604MvwdAh/f/L1RZlDXpR7JvnQ8YTcYTMqM3Uyx83ntgsXd16O\nIOvNQnrmuwLp2bL4r0RJdSXNgp2wJm3W4ah5u62je6Hg7tA5J+2+6YzBG2islJbl\nIDDPgK7EQw==\n=vsjC\n-----END PGP SIGNATURE-----", "payload": "tree af1a57e3672b9e05bb6d7cd602b83b7c73fd3526\nparent cafbe7f2d9bdf9e94946e3f6f62b781b05b7d556\nauthor Philipp Hansch <dev@phansch.net> 1555745593 +0200\ncommitter Philipp Hansch <dev@phansch.net> 1555745593 +0200\n\nAdd test for derives for used_underscore_binding lint\n\nThis closes #852 as I can't reproduce the original issue anymore.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/60a1759b5f2af3b15ac32b5984001e3986c4b9b1", "html_url": "https://github.com/rust-lang/rust/commit/60a1759b5f2af3b15ac32b5984001e3986c4b9b1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/60a1759b5f2af3b15ac32b5984001e3986c4b9b1/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cafbe7f2d9bdf9e94946e3f6f62b781b05b7d556", "url": "https://api.github.com/repos/rust-lang/rust/commits/cafbe7f2d9bdf9e94946e3f6f62b781b05b7d556", "html_url": "https://github.com/rust-lang/rust/commit/cafbe7f2d9bdf9e94946e3f6f62b781b05b7d556"}], "stats": {"total": 27, "additions": 21, "deletions": 6}, "files": [{"sha": "08b993173029dd69da27acafc6ef2fcaff1faae4", "filename": "tests/ui/auxiliary/proc_macro_derive.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/60a1759b5f2af3b15ac32b5984001e3986c4b9b1/tests%2Fui%2Fauxiliary%2Fproc_macro_derive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/60a1759b5f2af3b15ac32b5984001e3986c4b9b1/tests%2Fui%2Fauxiliary%2Fproc_macro_derive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fauxiliary%2Fproc_macro_derive.rs?ref=60a1759b5f2af3b15ac32b5984001e3986c4b9b1", "patch": "@@ -9,7 +9,12 @@ use proc_macro::{quote, TokenStream};\n \n #[proc_macro_derive(DeriveSomething)]\n pub fn derive(_: TokenStream) -> TokenStream {\n+    // Shound not trigger `used_underscore_binding`\n+    let _inside_derive = 1;\n+    assert_eq!(_inside_derive, _inside_derive);\n+\n     let output = quote! {\n+        // Should not trigger `useless_attribute`\n         #[allow(dead_code)]\n         extern crate clippy_lints;\n     };"}, {"sha": "87542252e1fb42aa0c84ad930828645ca89fc0b3", "filename": "tests/ui/used_underscore_binding.rs", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/60a1759b5f2af3b15ac32b5984001e3986c4b9b1/tests%2Fui%2Fused_underscore_binding.rs", "raw_url": "https://github.com/rust-lang/rust/raw/60a1759b5f2af3b15ac32b5984001e3986c4b9b1/tests%2Fui%2Fused_underscore_binding.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fused_underscore_binding.rs?ref=60a1759b5f2af3b15ac32b5984001e3986c4b9b1", "patch": "@@ -1,7 +1,17 @@\n+// aux-build:proc_macro_derive.rs\n+\n #![warn(clippy::all)]\n #![allow(clippy::blacklisted_name)]\n #![warn(clippy::used_underscore_binding)]\n \n+#[macro_use]\n+extern crate proc_macro_derive;\n+\n+// This should not trigger the lint. There's underscore binding inside the external derive that\n+// would trigger the `used_underscore_binding` lint.\n+#[derive(DeriveSomething)]\n+struct Baz;\n+\n macro_rules! test_macro {\n     () => {{\n         let _foo = 42;\n@@ -51,7 +61,7 @@ fn unused_underscore_complex(mut _foo: u32) -> u32 {\n     1\n }\n \n-///Test that we do not lint for multiple underscores\n+/// Test that we do not lint for multiple underscores\n fn multiple_underscores(__foo: u32) -> u32 {\n     __foo + 1\n }"}, {"sha": "8216a3c66e5bed10a2adc159aa264cb58d669ddb", "filename": "tests/ui/used_underscore_binding.stderr", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/60a1759b5f2af3b15ac32b5984001e3986c4b9b1/tests%2Fui%2Fused_underscore_binding.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/60a1759b5f2af3b15ac32b5984001e3986c4b9b1/tests%2Fui%2Fused_underscore_binding.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fused_underscore_binding.stderr?ref=60a1759b5f2af3b15ac32b5984001e3986c4b9b1", "patch": "@@ -1,31 +1,31 @@\n error: used binding `_foo` which is prefixed with an underscore. A leading underscore signals that a binding will not be used.\n-  --> $DIR/used_underscore_binding.rs:14:5\n+  --> $DIR/used_underscore_binding.rs:24:5\n    |\n LL |     _foo + 1\n    |     ^^^^\n    |\n    = note: `-D clippy::used-underscore-binding` implied by `-D warnings`\n \n error: used binding `_foo` which is prefixed with an underscore. A leading underscore signals that a binding will not be used.\n-  --> $DIR/used_underscore_binding.rs:19:20\n+  --> $DIR/used_underscore_binding.rs:29:20\n    |\n LL |     println!(\"{}\", _foo);\n    |                    ^^^^\n \n error: used binding `_foo` which is prefixed with an underscore. A leading underscore signals that a binding will not be used.\n-  --> $DIR/used_underscore_binding.rs:20:16\n+  --> $DIR/used_underscore_binding.rs:30:16\n    |\n LL |     assert_eq!(_foo, _foo);\n    |                ^^^^\n \n error: used binding `_foo` which is prefixed with an underscore. A leading underscore signals that a binding will not be used.\n-  --> $DIR/used_underscore_binding.rs:20:22\n+  --> $DIR/used_underscore_binding.rs:30:22\n    |\n LL |     assert_eq!(_foo, _foo);\n    |                      ^^^^\n \n error: used binding `_underscore_field` which is prefixed with an underscore. A leading underscore signals that a binding will not be used.\n-  --> $DIR/used_underscore_binding.rs:33:5\n+  --> $DIR/used_underscore_binding.rs:43:5\n    |\n LL |     s._underscore_field += 1;\n    |     ^^^^^^^^^^^^^^^^^^^"}]}