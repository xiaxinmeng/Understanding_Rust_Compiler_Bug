{"sha": "4f1d4e4db699d674cae5dec3a8026b1388820895", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRmMWQ0ZTRkYjY5OWQ2NzRjYWU1ZGVjM2E4MDI2YjEzODg4MjA4OTU=", "commit": {"author": {"name": "Tatsuyuki Ishi", "email": "ishitatsuyuki@gmail.com", "date": "2018-07-25T01:25:02Z"}, "committer": {"name": "Tatsuyuki Ishi", "email": "ishitatsuyuki@gmail.com", "date": "2018-07-25T01:25:02Z"}, "message": "Merge remote-tracking branches 'ljedrz/dyn_libcore', 'ljedrz/dyn_libstd' and 'ljedrz/dyn_libterm' into dyn-rollup", "tree": {"sha": "a40a10ea584ca1f28bc48c3dae86f7395d872bea", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a40a10ea584ca1f28bc48c3dae86f7395d872bea"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4f1d4e4db699d674cae5dec3a8026b1388820895", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4f1d4e4db699d674cae5dec3a8026b1388820895", "html_url": "https://github.com/rust-lang/rust/commit/4f1d4e4db699d674cae5dec3a8026b1388820895", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4f1d4e4db699d674cae5dec3a8026b1388820895/comments", "author": {"login": "ishitatsuyuki", "id": 12389383, "node_id": "MDQ6VXNlcjEyMzg5Mzgz", "avatar_url": "https://avatars.githubusercontent.com/u/12389383?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ishitatsuyuki", "html_url": "https://github.com/ishitatsuyuki", "followers_url": "https://api.github.com/users/ishitatsuyuki/followers", "following_url": "https://api.github.com/users/ishitatsuyuki/following{/other_user}", "gists_url": "https://api.github.com/users/ishitatsuyuki/gists{/gist_id}", "starred_url": "https://api.github.com/users/ishitatsuyuki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ishitatsuyuki/subscriptions", "organizations_url": "https://api.github.com/users/ishitatsuyuki/orgs", "repos_url": "https://api.github.com/users/ishitatsuyuki/repos", "events_url": "https://api.github.com/users/ishitatsuyuki/events{/privacy}", "received_events_url": "https://api.github.com/users/ishitatsuyuki/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ishitatsuyuki", "id": 12389383, "node_id": "MDQ6VXNlcjEyMzg5Mzgz", "avatar_url": "https://avatars.githubusercontent.com/u/12389383?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ishitatsuyuki", "html_url": "https://github.com/ishitatsuyuki", "followers_url": "https://api.github.com/users/ishitatsuyuki/followers", "following_url": "https://api.github.com/users/ishitatsuyuki/following{/other_user}", "gists_url": "https://api.github.com/users/ishitatsuyuki/gists{/gist_id}", "starred_url": "https://api.github.com/users/ishitatsuyuki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ishitatsuyuki/subscriptions", "organizations_url": "https://api.github.com/users/ishitatsuyuki/orgs", "repos_url": "https://api.github.com/users/ishitatsuyuki/repos", "events_url": "https://api.github.com/users/ishitatsuyuki/events{/privacy}", "received_events_url": "https://api.github.com/users/ishitatsuyuki/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "66c4dc9769b7ae456fe2960dc5a1e037b2432184", "url": "https://api.github.com/repos/rust-lang/rust/commits/66c4dc9769b7ae456fe2960dc5a1e037b2432184", "html_url": "https://github.com/rust-lang/rust/commit/66c4dc9769b7ae456fe2960dc5a1e037b2432184"}, {"sha": "72e2c00af48ac0c59f5dcae819a6842e8e2029cf", "url": "https://api.github.com/repos/rust-lang/rust/commits/72e2c00af48ac0c59f5dcae819a6842e8e2029cf", "html_url": "https://github.com/rust-lang/rust/commit/72e2c00af48ac0c59f5dcae819a6842e8e2029cf"}, {"sha": "7407a788149402039ffbb56aed50de2023652d46", "url": "https://api.github.com/repos/rust-lang/rust/commits/7407a788149402039ffbb56aed50de2023652d46", "html_url": "https://github.com/rust-lang/rust/commit/7407a788149402039ffbb56aed50de2023652d46"}], "stats": {"total": 242, "additions": 122, "deletions": 120}, "files": [{"sha": "29534696abc5be232de994c97448fe71c6e3b398", "filename": "src/libstd/error.rs", "status": "modified", "additions": 45, "deletions": 45, "changes": 90, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Ferror.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Ferror.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Ferror.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -138,7 +138,7 @@ pub trait Error: Debug + Display {\n     /// }\n     /// ```\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n-    fn cause(&self) -> Option<&Error> { None }\n+    fn cause(&self) -> Option<&dyn Error> { None }\n \n     /// Get the `TypeId` of `self`\n     #[doc(hidden)]\n@@ -151,22 +151,22 @@ pub trait Error: Debug + Display {\n }\n \n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n-impl<'a, E: Error + 'a> From<E> for Box<Error + 'a> {\n-    fn from(err: E) -> Box<Error + 'a> {\n+impl<'a, E: Error + 'a> From<E> for Box<dyn Error + 'a> {\n+    fn from(err: E) -> Box<dyn Error + 'a> {\n         Box::new(err)\n     }\n }\n \n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n-impl<'a, E: Error + Send + Sync + 'a> From<E> for Box<Error + Send + Sync + 'a> {\n-    fn from(err: E) -> Box<Error + Send + Sync + 'a> {\n+impl<'a, E: Error + Send + Sync + 'a> From<E> for Box<dyn Error + Send + Sync + 'a> {\n+    fn from(err: E) -> Box<dyn Error + Send + Sync + 'a> {\n         Box::new(err)\n     }\n }\n \n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n-impl From<String> for Box<Error + Send + Sync> {\n-    fn from(err: String) -> Box<Error + Send + Sync> {\n+impl From<String> for Box<dyn Error + Send + Sync> {\n+    fn from(err: String) -> Box<dyn Error + Send + Sync> {\n         #[derive(Debug)]\n         struct StringError(String);\n \n@@ -185,38 +185,38 @@ impl From<String> for Box<Error + Send + Sync> {\n }\n \n #[stable(feature = \"string_box_error\", since = \"1.6.0\")]\n-impl From<String> for Box<Error> {\n-    fn from(str_err: String) -> Box<Error> {\n-        let err1: Box<Error + Send + Sync> = From::from(str_err);\n-        let err2: Box<Error> = err1;\n+impl From<String> for Box<dyn Error> {\n+    fn from(str_err: String) -> Box<dyn Error> {\n+        let err1: Box<dyn Error + Send + Sync> = From::from(str_err);\n+        let err2: Box<dyn Error> = err1;\n         err2\n     }\n }\n \n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n-impl<'a, 'b> From<&'b str> for Box<Error + Send + Sync + 'a> {\n-    fn from(err: &'b str) -> Box<Error + Send + Sync + 'a> {\n+impl<'a, 'b> From<&'b str> for Box<dyn Error + Send + Sync + 'a> {\n+    fn from(err: &'b str) -> Box<dyn Error + Send + Sync + 'a> {\n         From::from(String::from(err))\n     }\n }\n \n #[stable(feature = \"string_box_error\", since = \"1.6.0\")]\n-impl<'a> From<&'a str> for Box<Error> {\n-    fn from(err: &'a str) -> Box<Error> {\n+impl<'a> From<&'a str> for Box<dyn Error> {\n+    fn from(err: &'a str) -> Box<dyn Error> {\n         From::from(String::from(err))\n     }\n }\n \n #[stable(feature = \"cow_box_error\", since = \"1.22.0\")]\n-impl<'a, 'b> From<Cow<'b, str>> for Box<Error + Send + Sync + 'a> {\n-    fn from(err: Cow<'b, str>) -> Box<Error + Send + Sync + 'a> {\n+impl<'a, 'b> From<Cow<'b, str>> for Box<dyn Error + Send + Sync + 'a> {\n+    fn from(err: Cow<'b, str>) -> Box<dyn Error + Send + Sync + 'a> {\n         From::from(String::from(err))\n     }\n }\n \n #[stable(feature = \"cow_box_error\", since = \"1.22.0\")]\n-impl<'a> From<Cow<'a, str>> for Box<Error> {\n-    fn from(err: Cow<'a, str>) -> Box<Error> {\n+impl<'a> From<Cow<'a, str>> for Box<dyn Error> {\n+    fn from(err: Cow<'a, str>) -> Box<dyn Error> {\n         From::from(String::from(err))\n     }\n }\n@@ -327,7 +327,7 @@ impl<T: Error> Error for Box<T> {\n         Error::description(&**self)\n     }\n \n-    fn cause(&self) -> Option<&Error> {\n+    fn cause(&self) -> Option<&dyn Error> {\n         Error::cause(&**self)\n     }\n }\n@@ -368,7 +368,7 @@ impl Error for char::ParseCharError {\n }\n \n // copied from any.rs\n-impl Error + 'static {\n+impl dyn Error + 'static {\n     /// Returns true if the boxed type is the same as `T`\n     #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     #[inline]\n@@ -390,7 +390,7 @@ impl Error + 'static {\n     pub fn downcast_ref<T: Error + 'static>(&self) -> Option<&T> {\n         if self.is::<T>() {\n             unsafe {\n-                Some(&*(self as *const Error as *const T))\n+                Some(&*(self as *const dyn Error as *const T))\n             }\n         } else {\n             None\n@@ -404,68 +404,68 @@ impl Error + 'static {\n     pub fn downcast_mut<T: Error + 'static>(&mut self) -> Option<&mut T> {\n         if self.is::<T>() {\n             unsafe {\n-                Some(&mut *(self as *mut Error as *mut T))\n+                Some(&mut *(self as *mut dyn Error as *mut T))\n             }\n         } else {\n             None\n         }\n     }\n }\n \n-impl Error + 'static + Send {\n+impl dyn Error + 'static + Send {\n     /// Forwards to the method defined on the type `Any`.\n     #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     #[inline]\n     pub fn is<T: Error + 'static>(&self) -> bool {\n-        <Error + 'static>::is::<T>(self)\n+        <dyn Error + 'static>::is::<T>(self)\n     }\n \n     /// Forwards to the method defined on the type `Any`.\n     #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     #[inline]\n     pub fn downcast_ref<T: Error + 'static>(&self) -> Option<&T> {\n-        <Error + 'static>::downcast_ref::<T>(self)\n+        <dyn Error + 'static>::downcast_ref::<T>(self)\n     }\n \n     /// Forwards to the method defined on the type `Any`.\n     #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     #[inline]\n     pub fn downcast_mut<T: Error + 'static>(&mut self) -> Option<&mut T> {\n-        <Error + 'static>::downcast_mut::<T>(self)\n+        <dyn Error + 'static>::downcast_mut::<T>(self)\n     }\n }\n \n-impl Error + 'static + Send + Sync {\n+impl dyn Error + 'static + Send + Sync {\n     /// Forwards to the method defined on the type `Any`.\n     #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     #[inline]\n     pub fn is<T: Error + 'static>(&self) -> bool {\n-        <Error + 'static>::is::<T>(self)\n+        <dyn Error + 'static>::is::<T>(self)\n     }\n \n     /// Forwards to the method defined on the type `Any`.\n     #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     #[inline]\n     pub fn downcast_ref<T: Error + 'static>(&self) -> Option<&T> {\n-        <Error + 'static>::downcast_ref::<T>(self)\n+        <dyn Error + 'static>::downcast_ref::<T>(self)\n     }\n \n     /// Forwards to the method defined on the type `Any`.\n     #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     #[inline]\n     pub fn downcast_mut<T: Error + 'static>(&mut self) -> Option<&mut T> {\n-        <Error + 'static>::downcast_mut::<T>(self)\n+        <dyn Error + 'static>::downcast_mut::<T>(self)\n     }\n }\n \n-impl Error {\n+impl dyn Error {\n     #[inline]\n     #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     /// Attempt to downcast the box to a concrete type.\n-    pub fn downcast<T: Error + 'static>(self: Box<Self>) -> Result<Box<T>, Box<Error>> {\n+    pub fn downcast<T: Error + 'static>(self: Box<Self>) -> Result<Box<T>, Box<dyn Error>> {\n         if self.is::<T>() {\n             unsafe {\n-                let raw: *mut Error = Box::into_raw(self);\n+                let raw: *mut dyn Error = Box::into_raw(self);\n                 Ok(Box::from_raw(raw as *mut T))\n             }\n         } else {\n@@ -474,30 +474,30 @@ impl Error {\n     }\n }\n \n-impl Error + Send {\n+impl dyn Error + Send {\n     #[inline]\n     #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     /// Attempt to downcast the box to a concrete type.\n     pub fn downcast<T: Error + 'static>(self: Box<Self>)\n-                                        -> Result<Box<T>, Box<Error + Send>> {\n-        let err: Box<Error> = self;\n-        <Error>::downcast(err).map_err(|s| unsafe {\n+                                        -> Result<Box<T>, Box<dyn Error + Send>> {\n+        let err: Box<dyn Error> = self;\n+        <dyn Error>::downcast(err).map_err(|s| unsafe {\n             // reapply the Send marker\n-            transmute::<Box<Error>, Box<Error + Send>>(s)\n+            transmute::<Box<dyn Error>, Box<dyn Error + Send>>(s)\n         })\n     }\n }\n \n-impl Error + Send + Sync {\n+impl dyn Error + Send + Sync {\n     #[inline]\n     #[stable(feature = \"error_downcast\", since = \"1.3.0\")]\n     /// Attempt to downcast the box to a concrete type.\n     pub fn downcast<T: Error + 'static>(self: Box<Self>)\n                                         -> Result<Box<T>, Box<Self>> {\n-        let err: Box<Error> = self;\n-        <Error>::downcast(err).map_err(|s| unsafe {\n+        let err: Box<dyn Error> = self;\n+        <dyn Error>::downcast(err).map_err(|s| unsafe {\n             // reapply the Send+Sync marker\n-            transmute::<Box<Error>, Box<Error + Send + Sync>>(s)\n+            transmute::<Box<dyn Error>, Box<dyn Error + Send + Sync>>(s)\n         })\n     }\n }\n@@ -533,13 +533,13 @@ mod tests {\n     #[test]\n     fn downcasting() {\n         let mut a = A;\n-        let a = &mut a as &mut (Error + 'static);\n+        let a = &mut a as &mut (dyn Error + 'static);\n         assert_eq!(a.downcast_ref::<A>(), Some(&A));\n         assert_eq!(a.downcast_ref::<B>(), None);\n         assert_eq!(a.downcast_mut::<A>(), Some(&mut A));\n         assert_eq!(a.downcast_mut::<B>(), None);\n \n-        let a: Box<Error> = Box::new(A);\n+        let a: Box<dyn Error> = Box::new(A);\n         match a.downcast::<B>() {\n             Ok(..) => panic!(\"expected error\"),\n             Err(e) => assert_eq!(*e.downcast::<A>().unwrap(), A),"}, {"sha": "754e2bbc4122b7f127b679fbaf3e5bda488ac6a3", "filename": "src/libstd/ffi/c_str.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fffi%2Fc_str.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fffi%2Fc_str.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fffi%2Fc_str.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -891,7 +891,7 @@ impl Error for IntoStringError {\n         \"C string contained non-utf8 bytes\"\n     }\n \n-    fn cause(&self) -> Option<&Error> {\n+    fn cause(&self) -> Option<&dyn Error> {\n         Some(&self.error)\n     }\n }"}, {"sha": "02a3ce8b9c4d475a0dcdb366fcdcd44a9344521b", "filename": "src/libstd/io/error.rs", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fio%2Ferror.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fio%2Ferror.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fio%2Ferror.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -83,7 +83,7 @@ enum Repr {\n #[derive(Debug)]\n struct Custom {\n     kind: ErrorKind,\n-    error: Box<error::Error+Send+Sync>,\n+    error: Box<dyn error::Error+Send+Sync>,\n }\n \n /// A list specifying general categories of I/O error.\n@@ -250,12 +250,12 @@ impl Error {\n     /// ```\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     pub fn new<E>(kind: ErrorKind, error: E) -> Error\n-        where E: Into<Box<error::Error+Send+Sync>>\n+        where E: Into<Box<dyn error::Error+Send+Sync>>\n     {\n         Self::_new(kind, error.into())\n     }\n \n-    fn _new(kind: ErrorKind, error: Box<error::Error+Send+Sync>) -> Error {\n+    fn _new(kind: ErrorKind, error: Box<dyn error::Error+Send+Sync>) -> Error {\n         Error {\n             repr: Repr::Custom(Box::new(Custom {\n                 kind,\n@@ -373,7 +373,7 @@ impl Error {\n     /// }\n     /// ```\n     #[stable(feature = \"io_error_inner\", since = \"1.3.0\")]\n-    pub fn get_ref(&self) -> Option<&(error::Error+Send+Sync+'static)> {\n+    pub fn get_ref(&self) -> Option<&(dyn error::Error+Send+Sync+'static)> {\n         match self.repr {\n             Repr::Os(..) => None,\n             Repr::Simple(..) => None,\n@@ -444,7 +444,7 @@ impl Error {\n     /// }\n     /// ```\n     #[stable(feature = \"io_error_inner\", since = \"1.3.0\")]\n-    pub fn get_mut(&mut self) -> Option<&mut (error::Error+Send+Sync+'static)> {\n+    pub fn get_mut(&mut self) -> Option<&mut (dyn error::Error+Send+Sync+'static)> {\n         match self.repr {\n             Repr::Os(..) => None,\n             Repr::Simple(..) => None,\n@@ -478,7 +478,7 @@ impl Error {\n     /// }\n     /// ```\n     #[stable(feature = \"io_error_inner\", since = \"1.3.0\")]\n-    pub fn into_inner(self) -> Option<Box<error::Error+Send+Sync>> {\n+    pub fn into_inner(self) -> Option<Box<dyn error::Error+Send+Sync>> {\n         match self.repr {\n             Repr::Os(..) => None,\n             Repr::Simple(..) => None,\n@@ -551,7 +551,7 @@ impl error::Error for Error {\n         }\n     }\n \n-    fn cause(&self) -> Option<&error::Error> {\n+    fn cause(&self) -> Option<&dyn error::Error> {\n         match self.repr {\n             Repr::Os(..) => None,\n             Repr::Simple(..) => None,"}, {"sha": "8530487484827e5d8d404151a26bcb769eecde4c", "filename": "src/libstd/io/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fio%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fio%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fio%2Fmod.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -1972,7 +1972,7 @@ impl<T: BufRead> BufRead for Take<T> {\n     }\n }\n \n-fn read_one_byte(reader: &mut Read) -> Option<Result<u8>> {\n+fn read_one_byte(reader: &mut dyn Read) -> Option<Result<u8>> {\n     let mut buf = [0];\n     loop {\n         return match reader.read(&mut buf) {\n@@ -2081,7 +2081,7 @@ impl std_error::Error for CharsError {\n             CharsError::Other(ref e) => std_error::Error::description(e),\n         }\n     }\n-    fn cause(&self) -> Option<&std_error::Error> {\n+    fn cause(&self) -> Option<&dyn std_error::Error> {\n         match *self {\n             CharsError::NotUtf8 => None,\n             CharsError::Other(ref e) => e.cause(),"}, {"sha": "fffe8fc559b8192b63c12f7208d23bac9dbf0a89", "filename": "src/libstd/io/stdio.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fio%2Fstdio.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fio%2Fstdio.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fio%2Fstdio.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -21,7 +21,7 @@ use thread::LocalKey;\n \n /// Stdout used by print! and println! macros\n thread_local! {\n-    static LOCAL_STDOUT: RefCell<Option<Box<Write + Send>>> = {\n+    static LOCAL_STDOUT: RefCell<Option<Box<dyn Write + Send>>> = {\n         RefCell::new(None)\n     }\n }\n@@ -624,7 +624,7 @@ impl<'a> fmt::Debug for StderrLock<'a> {\n                      with a more general mechanism\",\n            issue = \"0\")]\n #[doc(hidden)]\n-pub fn set_panic(sink: Option<Box<Write + Send>>) -> Option<Box<Write + Send>> {\n+pub fn set_panic(sink: Option<Box<dyn Write + Send>>) -> Option<Box<dyn Write + Send>> {\n     use panicking::LOCAL_STDERR;\n     use mem;\n     LOCAL_STDERR.with(move |slot| {\n@@ -648,7 +648,7 @@ pub fn set_panic(sink: Option<Box<Write + Send>>) -> Option<Box<Write + Send>> {\n                      with a more general mechanism\",\n            issue = \"0\")]\n #[doc(hidden)]\n-pub fn set_print(sink: Option<Box<Write + Send>>) -> Option<Box<Write + Send>> {\n+pub fn set_print(sink: Option<Box<dyn Write + Send>>) -> Option<Box<dyn Write + Send>> {\n     use mem;\n     LOCAL_STDOUT.with(move |slot| {\n         mem::replace(&mut *slot.borrow_mut(), sink)\n@@ -670,7 +670,7 @@ pub fn set_print(sink: Option<Box<Write + Send>>) -> Option<Box<Write + Send>> {\n /// However, if the actual I/O causes an error, this function does panic.\n fn print_to<T>(\n     args: fmt::Arguments,\n-    local_s: &'static LocalKey<RefCell<Option<Box<Write+Send>>>>,\n+    local_s: &'static LocalKey<RefCell<Option<Box<dyn Write+Send>>>>,\n     global_s: fn() -> T,\n     label: &str,\n )"}, {"sha": "33f741dbc38f22716aa2762b959be5108c9d7c4a", "filename": "src/libstd/io/util.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fio%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fio%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fio%2Futil.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -223,7 +223,7 @@ mod tests {\n         assert_eq!(copy(&mut r, &mut w).unwrap(), 4);\n \n         let mut r = repeat(0).take(1 << 17);\n-        assert_eq!(copy(&mut r as &mut Read, &mut w as &mut Write).unwrap(), 1 << 17);\n+        assert_eq!(copy(&mut r as &mut dyn Read, &mut w as &mut dyn Write).unwrap(), 1 << 17);\n     }\n \n     #[test]"}, {"sha": "0396ba362bd2eb2122091c733edcde8c522121b6", "filename": "src/libstd/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Flib.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -221,6 +221,7 @@\n // Don't link to std. We are std.\n #![no_std]\n \n+#![deny(bare_trait_objects)]\n #![deny(missing_docs)]\n #![deny(missing_debug_implementations)]\n "}, {"sha": "234c5618a0611db4a41ca0c115c83d0cf0e8d808", "filename": "src/libstd/net/parser.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fnet%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fnet%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fnet%2Fparser.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -61,7 +61,7 @@ impl<'a> Parser<'a> {\n     }\n \n     // Return result of first successful parser\n-    fn read_or<T>(&mut self, parsers: &mut [Box<FnMut(&mut Parser) -> Option<T> + 'static>])\n+    fn read_or<T>(&mut self, parsers: &mut [Box<dyn FnMut(&mut Parser) -> Option<T> + 'static>])\n                -> Option<T> {\n         for pf in parsers {\n             if let Some(r) = self.read_atomically(|p: &mut Parser| pf(p)) {"}, {"sha": "75c7a3d92809440c48817897331a5909bbf39b45", "filename": "src/libstd/net/tcp.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fnet%2Ftcp.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fnet%2Ftcp.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fnet%2Ftcp.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -927,7 +927,7 @@ mod tests {\n     use time::{Instant, Duration};\n     use thread;\n \n-    fn each_ip(f: &mut FnMut(SocketAddr)) {\n+    fn each_ip(f: &mut dyn FnMut(SocketAddr)) {\n         f(next_test_ip4());\n         f(next_test_ip6());\n     }"}, {"sha": "0ebe3284b4f0a9de5a8c33d653c77b78341f0f8d", "filename": "src/libstd/net/udp.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fnet%2Fudp.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fnet%2Fudp.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fnet%2Fudp.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -826,7 +826,7 @@ mod tests {\n     use time::{Instant, Duration};\n     use thread;\n \n-    fn each_ip(f: &mut FnMut(SocketAddr, SocketAddr)) {\n+    fn each_ip(f: &mut dyn FnMut(SocketAddr, SocketAddr)) {\n         f(next_test_ip4(), next_test_ip4());\n         f(next_test_ip6(), next_test_ip6());\n     }"}, {"sha": "b8c1c4f9e68e7602ad5ab3b78679abf3f84e7988", "filename": "src/libstd/panic.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fpanic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fpanic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fpanic.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -421,6 +421,6 @@ pub fn catch_unwind<F: FnOnce() -> R + UnwindSafe, R>(f: F) -> Result<R> {\n /// }\n /// ```\n #[stable(feature = \"resume_unwind\", since = \"1.9.0\")]\n-pub fn resume_unwind(payload: Box<Any + Send>) -> ! {\n+pub fn resume_unwind(payload: Box<dyn Any + Send>) -> ! {\n     panicking::update_count_then_panic(payload)\n }"}, {"sha": "283fd36af41ff4976ca69b7896856a157492077b", "filename": "src/libstd/panicking.rs", "status": "modified", "additions": 18, "deletions": 18, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fpanicking.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fpanicking.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fpanicking.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -36,7 +36,7 @@ use sys_common::util;\n use thread;\n \n thread_local! {\n-    pub static LOCAL_STDERR: RefCell<Option<Box<Write + Send>>> = {\n+    pub static LOCAL_STDERR: RefCell<Option<Box<dyn Write + Send>>> = {\n         RefCell::new(None)\n     }\n }\n@@ -64,7 +64,7 @@ extern {\n #[derive(Copy, Clone)]\n enum Hook {\n     Default,\n-    Custom(*mut (Fn(&PanicInfo) + 'static + Sync + Send)),\n+    Custom(*mut (dyn Fn(&PanicInfo) + 'static + Sync + Send)),\n }\n \n static HOOK_LOCK: RWLock = RWLock::new();\n@@ -104,7 +104,7 @@ static mut HOOK: Hook = Hook::Default;\n /// panic!(\"Normal panic\");\n /// ```\n #[stable(feature = \"panic_hooks\", since = \"1.10.0\")]\n-pub fn set_hook(hook: Box<Fn(&PanicInfo) + 'static + Sync + Send>) {\n+pub fn set_hook(hook: Box<dyn Fn(&PanicInfo) + 'static + Sync + Send>) {\n     if thread::panicking() {\n         panic!(\"cannot modify the panic hook from a panicking thread\");\n     }\n@@ -149,7 +149,7 @@ pub fn set_hook(hook: Box<Fn(&PanicInfo) + 'static + Sync + Send>) {\n /// panic!(\"Normal panic\");\n /// ```\n #[stable(feature = \"panic_hooks\", since = \"1.10.0\")]\n-pub fn take_hook() -> Box<Fn(&PanicInfo) + 'static + Sync + Send> {\n+pub fn take_hook() -> Box<dyn Fn(&PanicInfo) + 'static + Sync + Send> {\n     if thread::panicking() {\n         panic!(\"cannot modify the panic hook from a panicking thread\");\n     }\n@@ -197,7 +197,7 @@ fn default_hook(info: &PanicInfo) {\n     let thread = thread_info::current_thread();\n     let name = thread.as_ref().and_then(|t| t.name()).unwrap_or(\"<unnamed>\");\n \n-    let write = |err: &mut ::io::Write| {\n+    let write = |err: &mut dyn (::io::Write)| {\n         let _ = writeln!(err, \"thread '{}' panicked at '{}', {}\",\n                          name, msg, location);\n \n@@ -248,7 +248,7 @@ pub fn update_panic_count(amt: isize) -> usize {\n pub use realstd::rt::update_panic_count;\n \n /// Invoke a closure, capturing the cause of an unwinding panic if one occurs.\n-pub unsafe fn try<R, F: FnOnce() -> R>(f: F) -> Result<R, Box<Any + Send>> {\n+pub unsafe fn try<R, F: FnOnce() -> R>(f: F) -> Result<R, Box<dyn Any + Send>> {\n     #[allow(unions_with_drop_fields)]\n     union Data<F, R> {\n         f: F,\n@@ -369,12 +369,12 @@ fn continue_panic_fmt(info: &PanicInfo) -> ! {\n     }\n \n     unsafe impl<'a> BoxMeUp for PanicPayload<'a> {\n-        fn box_me_up(&mut self) -> *mut (Any + Send) {\n+        fn box_me_up(&mut self) -> *mut (dyn Any + Send) {\n             let contents = mem::replace(self.fill(), String::new());\n             Box::into_raw(Box::new(contents))\n         }\n \n-        fn get(&mut self) -> &(Any + Send) {\n+        fn get(&mut self) -> &(dyn Any + Send) {\n             self.fill()\n         }\n     }\n@@ -419,15 +419,15 @@ pub fn begin_panic<M: Any + Send>(msg: M, file_line_col: &(&'static str, u32, u3\n     }\n \n     unsafe impl<A: Send + 'static> BoxMeUp for PanicPayload<A> {\n-        fn box_me_up(&mut self) -> *mut (Any + Send) {\n+        fn box_me_up(&mut self) -> *mut (dyn Any + Send) {\n             let data = match self.inner.take() {\n-                Some(a) => Box::new(a) as Box<Any + Send>,\n+                Some(a) => Box::new(a) as Box<dyn Any + Send>,\n                 None => Box::new(()),\n             };\n             Box::into_raw(data)\n         }\n \n-        fn get(&mut self) -> &(Any + Send) {\n+        fn get(&mut self) -> &(dyn Any + Send) {\n             match self.inner {\n                 Some(ref a) => a,\n                 None => &(),\n@@ -441,7 +441,7 @@ pub fn begin_panic<M: Any + Send>(msg: M, file_line_col: &(&'static str, u32, u3\n /// Executes the primary logic for a panic, including checking for recursive\n /// panics, panic hooks, and finally dispatching to the panic runtime to either\n /// abort or unwind.\n-fn rust_panic_with_hook(payload: &mut BoxMeUp,\n+fn rust_panic_with_hook(payload: &mut dyn BoxMeUp,\n                         message: Option<&fmt::Arguments>,\n                         file_line_col: &(&str, u32, u32)) -> ! {\n     let (file, line, col) = *file_line_col;\n@@ -496,17 +496,17 @@ fn rust_panic_with_hook(payload: &mut BoxMeUp,\n }\n \n /// Shim around rust_panic. Called by resume_unwind.\n-pub fn update_count_then_panic(msg: Box<Any + Send>) -> ! {\n+pub fn update_count_then_panic(msg: Box<dyn Any + Send>) -> ! {\n     update_panic_count(1);\n \n-    struct RewrapBox(Box<Any + Send>);\n+    struct RewrapBox(Box<dyn Any + Send>);\n \n     unsafe impl BoxMeUp for RewrapBox {\n-        fn box_me_up(&mut self) -> *mut (Any + Send) {\n+        fn box_me_up(&mut self) -> *mut (dyn Any + Send) {\n             Box::into_raw(mem::replace(&mut self.0, Box::new(())))\n         }\n \n-        fn get(&mut self) -> &(Any + Send) {\n+        fn get(&mut self) -> &(dyn Any + Send) {\n             &*self.0\n         }\n     }\n@@ -517,9 +517,9 @@ pub fn update_count_then_panic(msg: Box<Any + Send>) -> ! {\n /// A private no-mangle function on which to slap yer breakpoints.\n #[no_mangle]\n #[allow(private_no_mangle_fns)] // yes we get it, but we like breakpoints\n-pub fn rust_panic(mut msg: &mut BoxMeUp) -> ! {\n+pub fn rust_panic(mut msg: &mut dyn BoxMeUp) -> ! {\n     let code = unsafe {\n-        let obj = &mut msg as *mut &mut BoxMeUp;\n+        let obj = &mut msg as *mut &mut dyn BoxMeUp;\n         __rust_start_panic(obj as usize)\n     };\n     rtabort!(\"failed to initiate panic, error {}\", code)"}, {"sha": "39692836866baab6e7873920c7159ed3bb605be3", "filename": "src/libstd/process.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fprocess.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fprocess.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fprocess.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -813,13 +813,13 @@ impl fmt::Debug for Output {\n     fn fmt(&self, fmt: &mut fmt::Formatter) -> fmt::Result {\n \n         let stdout_utf8 = str::from_utf8(&self.stdout);\n-        let stdout_debug: &fmt::Debug = match stdout_utf8 {\n+        let stdout_debug: &dyn fmt::Debug = match stdout_utf8 {\n             Ok(ref str) => str,\n             Err(_) => &self.stdout\n         };\n \n         let stderr_utf8 = str::from_utf8(&self.stderr);\n-        let stderr_debug: &fmt::Debug = match stderr_utf8 {\n+        let stderr_debug: &dyn fmt::Debug = match stderr_utf8 {\n             Ok(ref str) => str,\n             Err(_) => &self.stderr\n         };"}, {"sha": "9e957bd87d79e3ac4daa224a43847b63b8709150", "filename": "src/libstd/rt.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Frt.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Frt.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Frt.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -29,7 +29,7 @@ pub use panicking::{begin_panic, begin_panic_fmt, update_panic_count};\n // To reduce the generated code of the new `lang_start`, this function is doing\n // the real work.\n #[cfg(not(test))]\n-fn lang_start_internal(main: &(Fn() -> i32 + Sync + ::panic::RefUnwindSafe),\n+fn lang_start_internal(main: &(dyn Fn() -> i32 + Sync + ::panic::RefUnwindSafe),\n                        argc: isize, argv: *const *const u8) -> isize {\n     use panic;\n     use sys;"}, {"sha": "02a96b01cca28e82ba75d962d6922baa44b3dfca", "filename": "src/libstd/sync/mpsc/mod.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsync%2Fmpsc%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsync%2Fmpsc%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsync%2Fmpsc%2Fmod.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -1638,7 +1638,7 @@ impl<T: Send> error::Error for SendError<T> {\n         \"sending on a closed channel\"\n     }\n \n-    fn cause(&self) -> Option<&error::Error> {\n+    fn cause(&self) -> Option<&dyn error::Error> {\n         None\n     }\n }\n@@ -1681,7 +1681,7 @@ impl<T: Send> error::Error for TrySendError<T> {\n         }\n     }\n \n-    fn cause(&self) -> Option<&error::Error> {\n+    fn cause(&self) -> Option<&dyn error::Error> {\n         None\n     }\n }\n@@ -1709,7 +1709,7 @@ impl error::Error for RecvError {\n         \"receiving on a closed channel\"\n     }\n \n-    fn cause(&self) -> Option<&error::Error> {\n+    fn cause(&self) -> Option<&dyn error::Error> {\n         None\n     }\n }\n@@ -1742,7 +1742,7 @@ impl error::Error for TryRecvError {\n         }\n     }\n \n-    fn cause(&self) -> Option<&error::Error> {\n+    fn cause(&self) -> Option<&dyn error::Error> {\n         None\n     }\n }\n@@ -1783,7 +1783,7 @@ impl error::Error for RecvTimeoutError {\n         }\n     }\n \n-    fn cause(&self) -> Option<&error::Error> {\n+    fn cause(&self) -> Option<&dyn error::Error> {\n         None\n     }\n }"}, {"sha": "a7a284cfb7994a766b1d3781c9d5b34e22effdec", "filename": "src/libstd/sync/mpsc/select.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsync%2Fmpsc%2Fselect.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsync%2Fmpsc%2Fselect.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsync%2Fmpsc%2Fselect.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -93,7 +93,7 @@ pub struct Handle<'rx, T:Send+'rx> {\n     next: *mut Handle<'static, ()>,\n     prev: *mut Handle<'static, ()>,\n     added: bool,\n-    packet: &'rx (Packet+'rx),\n+    packet: &'rx (dyn Packet+'rx),\n \n     // due to our fun transmutes, we be sure to place this at the end. (nothing\n     // previous relies on T)"}, {"sha": "10282ecb6588370d35aabf305e49173508d6f12d", "filename": "src/libstd/sync/once.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsync%2Fonce.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsync%2Fonce.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsync%2Fonce.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -309,7 +309,7 @@ impl Once {\n     #[cold]\n     fn call_inner(&self,\n                   ignore_poisoning: bool,\n-                  init: &mut FnMut(bool)) {\n+                  init: &mut dyn FnMut(bool)) {\n         let mut state = self.state.load(Ordering::SeqCst);\n \n         'outer: loop {"}, {"sha": "8cca47efd22d19bb4e152f79da603410926e1a58", "filename": "src/libstd/sys/cloudabi/thread.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys%2Fcloudabi%2Fthread.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys%2Fcloudabi%2Fthread.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fcloudabi%2Fthread.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -32,7 +32,7 @@ unsafe impl Send for Thread {}\n unsafe impl Sync for Thread {}\n \n impl Thread {\n-    pub unsafe fn new<'a>(stack: usize, p: Box<FnBox() + 'a>) -> io::Result<Thread> {\n+    pub unsafe fn new<'a>(stack: usize, p: Box<dyn FnBox() + 'a>) -> io::Result<Thread> {\n         let p = box p;\n         let mut native: libc::pthread_t = mem::zeroed();\n         let mut attr: libc::pthread_attr_t = mem::zeroed();"}, {"sha": "f4177087d77a1e24cd68dc06f0f5e52fa6332583", "filename": "src/libstd/sys/redox/thread.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys%2Fredox%2Fthread.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys%2Fredox%2Fthread.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fredox%2Fthread.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -28,7 +28,7 @@ unsafe impl Send for Thread {}\n unsafe impl Sync for Thread {}\n \n impl Thread {\n-    pub unsafe fn new<'a>(_stack: usize, p: Box<FnBox() + 'a>) -> io::Result<Thread> {\n+    pub unsafe fn new<'a>(_stack: usize, p: Box<dyn FnBox() + 'a>) -> io::Result<Thread> {\n         let p = box p;\n \n         let id = cvt(syscall::clone(syscall::CLONE_VM | syscall::CLONE_FS | syscall::CLONE_FILES))?;"}, {"sha": "77f125f3c5b569b2b9597592f09a53a116149cd9", "filename": "src/libstd/sys/unix/process/process_common.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys%2Funix%2Fprocess%2Fprocess_common.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys%2Funix%2Fprocess%2Fprocess_common.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Funix%2Fprocess%2Fprocess_common.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -52,7 +52,7 @@ pub struct Command {\n     uid: Option<uid_t>,\n     gid: Option<gid_t>,\n     saw_nul: bool,\n-    closures: Vec<Box<FnMut() -> io::Result<()> + Send + Sync>>,\n+    closures: Vec<Box<dyn FnMut() -> io::Result<()> + Send + Sync>>,\n     stdin: Option<Stdio>,\n     stdout: Option<Stdio>,\n     stderr: Option<Stdio>,\n@@ -155,12 +155,12 @@ impl Command {\n         self.gid\n     }\n \n-    pub fn get_closures(&mut self) -> &mut Vec<Box<FnMut() -> io::Result<()> + Send + Sync>> {\n+    pub fn get_closures(&mut self) -> &mut Vec<Box<dyn FnMut() -> io::Result<()> + Send + Sync>> {\n         &mut self.closures\n     }\n \n     pub fn before_exec(&mut self,\n-                       f: Box<FnMut() -> io::Result<()> + Send + Sync>) {\n+                       f: Box<dyn FnMut() -> io::Result<()> + Send + Sync>) {\n         self.closures.push(f);\n     }\n "}, {"sha": "e26306c045d310aa6b9cd99d685ed6b1c6594623", "filename": "src/libstd/sys/unix/thread.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys%2Funix%2Fthread.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys%2Funix%2Fthread.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Funix%2Fthread.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -49,7 +49,7 @@ unsafe fn pthread_attr_setstacksize(_attr: *mut libc::pthread_attr_t,\n }\n \n impl Thread {\n-    pub unsafe fn new<'a>(stack: usize, p: Box<FnBox() + 'a>)\n+    pub unsafe fn new<'a>(stack: usize, p: Box<dyn FnBox() + 'a>)\n                           -> io::Result<Thread> {\n         let p = box p;\n         let mut native: libc::pthread_t = mem::zeroed();"}, {"sha": "8173a62421117d4bb11b034a1bcee3978458a84c", "filename": "src/libstd/sys/wasm/thread.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys%2Fwasm%2Fthread.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys%2Fwasm%2Fthread.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fwasm%2Fthread.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -19,7 +19,7 @@ pub struct Thread(Void);\n pub const DEFAULT_MIN_STACK_SIZE: usize = 4096;\n \n impl Thread {\n-    pub unsafe fn new<'a>(_stack: usize, _p: Box<FnBox() + 'a>)\n+    pub unsafe fn new<'a>(_stack: usize, _p: Box<dyn FnBox() + 'a>)\n         -> io::Result<Thread>\n     {\n         unsupported()"}, {"sha": "44ec872b2446b956d85677a5e5d28f60a4a2bc44", "filename": "src/libstd/sys/windows/thread.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys%2Fwindows%2Fthread.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys%2Fwindows%2Fthread.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fwindows%2Fthread.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -28,7 +28,7 @@ pub struct Thread {\n }\n \n impl Thread {\n-    pub unsafe fn new<'a>(stack: usize, p: Box<FnBox() + 'a>)\n+    pub unsafe fn new<'a>(stack: usize, p: Box<dyn FnBox() + 'a>)\n                           -> io::Result<Thread> {\n         let p = box p;\n "}, {"sha": "b28a4d2f8be016f21bcc2f58b2457eea0c921b10", "filename": "src/libstd/sys_common/at_exit_imp.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys_common%2Fat_exit_imp.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys_common%2Fat_exit_imp.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys_common%2Fat_exit_imp.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -17,7 +17,7 @@ use ptr;\n use mem;\n use sys_common::mutex::Mutex;\n \n-type Queue = Vec<Box<FnBox()>>;\n+type Queue = Vec<Box<dyn FnBox()>>;\n \n // NB these are specifically not types from `std::sync` as they currently rely\n // on poisoning and this module needs to operate at a lower level than requiring\n@@ -68,7 +68,7 @@ pub fn cleanup() {\n     }\n }\n \n-pub fn push(f: Box<FnBox()>) -> bool {\n+pub fn push(f: Box<dyn FnBox()>) -> bool {\n     unsafe {\n         let _guard = LOCK.lock();\n         if init() {"}, {"sha": "6184ba4ded6e33baba53b7287f4f3af037a429c2", "filename": "src/libstd/sys_common/backtrace.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys_common%2Fbacktrace.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys_common%2Fbacktrace.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys_common%2Fbacktrace.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -49,7 +49,7 @@ pub struct Frame {\n const MAX_NB_FRAMES: usize = 100;\n \n /// Prints the current backtrace.\n-pub fn print(w: &mut Write, format: PrintFormat) -> io::Result<()> {\n+pub fn print(w: &mut dyn Write, format: PrintFormat) -> io::Result<()> {\n     static LOCK: Mutex = Mutex::new();\n \n     // Use a lock to prevent mixed output in multithreading context.\n@@ -62,7 +62,7 @@ pub fn print(w: &mut Write, format: PrintFormat) -> io::Result<()> {\n     }\n }\n \n-fn _print(w: &mut Write, format: PrintFormat) -> io::Result<()> {\n+fn _print(w: &mut dyn Write, format: PrintFormat) -> io::Result<()> {\n     let mut frames = [Frame {\n         exact_position: ptr::null(),\n         symbol_addr: ptr::null(),\n@@ -177,7 +177,7 @@ pub fn log_enabled() -> Option<PrintFormat> {\n ///\n /// These output functions should now be used everywhere to ensure consistency.\n /// You may want to also use `output_fileline`.\n-fn output(w: &mut Write, idx: usize, frame: Frame,\n+fn output(w: &mut dyn Write, idx: usize, frame: Frame,\n               s: Option<&str>, format: PrintFormat) -> io::Result<()> {\n     // Remove the `17: 0x0 - <unknown>` line.\n     if format == PrintFormat::Short && frame.exact_position == ptr::null() {\n@@ -202,7 +202,7 @@ fn output(w: &mut Write, idx: usize, frame: Frame,\n ///\n /// See also `output`.\n #[allow(dead_code)]\n-fn output_fileline(w: &mut Write,\n+fn output_fileline(w: &mut dyn Write,\n                    file: &[u8],\n                    line: u32,\n                    format: PrintFormat) -> io::Result<()> {\n@@ -254,7 +254,7 @@ fn output_fileline(w: &mut Write,\n // Note that this demangler isn't quite as fancy as it could be. We have lots\n // of other information in our symbols like hashes, version, type information,\n // etc. Additionally, this doesn't handle glue symbols at all.\n-pub fn demangle(writer: &mut Write, mut s: &str, format: PrintFormat) -> io::Result<()> {\n+pub fn demangle(writer: &mut dyn Write, mut s: &str, format: PrintFormat) -> io::Result<()> {\n     // During ThinLTO LLVM may import and rename internal symbols, so strip out\n     // those endings first as they're one of the last manglings applied to\n     // symbol names."}, {"sha": "1625efe4a2ae7142a06023a31b1058991a2bcdd8", "filename": "src/libstd/sys_common/poison.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys_common%2Fpoison.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys_common%2Fpoison.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys_common%2Fpoison.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -251,7 +251,7 @@ impl<T> Error for TryLockError<T> {\n         }\n     }\n \n-    fn cause(&self) -> Option<&Error> {\n+    fn cause(&self) -> Option<&dyn Error> {\n         match *self {\n             TryLockError::Poisoned(ref p) => Some(p),\n             _ => None"}, {"sha": "86a5e2b86942a4e6b7740ab158371942fb37a768", "filename": "src/libstd/sys_common/thread.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys_common%2Fthread.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fsys_common%2Fthread.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys_common%2Fthread.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -21,7 +21,7 @@ pub unsafe fn start_thread(main: *mut u8) {\n     let _handler = stack_overflow::Handler::new();\n \n     // Finally, let's run some code.\n-    Box::from_raw(main as *mut Box<FnBox()>)()\n+    Box::from_raw(main as *mut Box<dyn FnBox()>)()\n }\n \n pub fn min_stack() -> usize {"}, {"sha": "f7052e4834a8800d9b224c3aa469da5955f3bf19", "filename": "src/libstd/thread/mod.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fthread%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibstd%2Fthread%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fthread%2Fmod.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -1175,7 +1175,7 @@ impl fmt::Debug for Thread {\n ///\n /// [`Result`]: ../../std/result/enum.Result.html\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n-pub type Result<T> = ::result::Result<T, Box<Any + Send + 'static>>;\n+pub type Result<T> = ::result::Result<T, Box<dyn Any + Send + 'static>>;\n \n // This packet is used to communicate the return value between the child thread\n // and the parent thread. Memory is shared through the `Arc` within and there's\n@@ -1438,7 +1438,7 @@ mod tests {\n         rx.recv().unwrap();\n     }\n \n-    fn avoid_copying_the_body<F>(spawnfn: F) where F: FnOnce(Box<Fn() + Send>) {\n+    fn avoid_copying_the_body<F>(spawnfn: F) where F: FnOnce(Box<dyn Fn() + Send>) {\n         let (tx, rx) = channel();\n \n         let x: Box<_> = box 1;\n@@ -1485,7 +1485,7 @@ mod tests {\n         // (well, it would if the constant were 8000+ - I lowered it to be more\n         // valgrind-friendly. try this at home, instead..!)\n         const GENERATIONS: u32 = 16;\n-        fn child_no(x: u32) -> Box<Fn() + Send> {\n+        fn child_no(x: u32) -> Box<dyn Fn() + Send> {\n             return Box::new(move|| {\n                 if x < GENERATIONS {\n                     thread::spawn(move|| child_no(x+1)());\n@@ -1531,10 +1531,10 @@ mod tests {\n     #[test]\n     fn test_try_panic_message_any() {\n         match thread::spawn(move|| {\n-            panic!(box 413u16 as Box<Any + Send>);\n+            panic!(box 413u16 as Box<dyn Any + Send>);\n         }).join() {\n             Err(e) => {\n-                type T = Box<Any + Send>;\n+                type T = Box<dyn Any + Send>;\n                 assert!(e.is::<T>());\n                 let any = e.downcast::<T>().unwrap();\n                 assert!(any.is::<u16>());"}, {"sha": "6b115770237e6dac8ee48ab00b326ac8581347df", "filename": "src/libterm/lib.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibterm%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibterm%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibterm%2Flib.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -45,6 +45,7 @@\n        html_root_url = \"https://doc.rust-lang.org/nightly/\",\n        html_playground_url = \"https://play.rust-lang.org/\",\n        test(attr(deny(warnings))))]\n+#![deny(bare_trait_objects)]\n #![deny(missing_docs)]\n \n #![cfg_attr(windows, feature(libc))]\n@@ -66,9 +67,9 @@ pub mod terminfo;\n mod win;\n \n /// Alias for stdout terminals.\n-pub type StdoutTerminal = Terminal<Output = Stdout> + Send;\n+pub type StdoutTerminal = dyn Terminal<Output = Stdout> + Send;\n /// Alias for stderr terminals.\n-pub type StderrTerminal = Terminal<Output = Stderr> + Send;\n+pub type StderrTerminal = dyn Terminal<Output = Stderr> + Send;\n \n #[cfg(not(windows))]\n /// Return a Terminal wrapping stdout, or None if a terminal couldn't be"}, {"sha": "51e0fa315f43538a78fe573d88ec306570ad248a", "filename": "src/libterm/terminfo/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibterm%2Fterminfo%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibterm%2Fterminfo%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibterm%2Fterminfo%2Fmod.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -58,7 +58,7 @@ impl error::Error for Error {\n         \"failed to create TermInfo\"\n     }\n \n-    fn cause(&self) -> Option<&error::Error> {\n+    fn cause(&self) -> Option<&dyn error::Error> {\n         use self::Error::*;\n         match self {\n             &IoError(ref e) => Some(e),"}, {"sha": "d5e5df547334c28bfa544ea4e9708113c1cb729f", "filename": "src/libterm/terminfo/parser/compiled.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibterm%2Fterminfo%2Fparser%2Fcompiled.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f1d4e4db699d674cae5dec3a8026b1388820895/src%2Flibterm%2Fterminfo%2Fparser%2Fcompiled.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibterm%2Fterminfo%2Fparser%2Fcompiled.rs?ref=4f1d4e4db699d674cae5dec3a8026b1388820895", "patch": "@@ -164,7 +164,7 @@ pub static stringnames: &'static[&'static str] = &[ \"cbt\", \"_\", \"cr\", \"csr\", \"tb\n     \"OTG3\", \"OTG1\", \"OTG4\", \"OTGR\", \"OTGL\", \"OTGU\", \"OTGD\", \"OTGH\", \"OTGV\", \"OTGC\", \"meml\", \"memu\",\n     \"box1\"];\n \n-fn read_le_u16(r: &mut io::Read) -> io::Result<u16> {\n+fn read_le_u16(r: &mut dyn io::Read) -> io::Result<u16> {\n     let mut b = [0; 2];\n     let mut amt = 0;\n     while amt < b.len() {\n@@ -176,7 +176,7 @@ fn read_le_u16(r: &mut io::Read) -> io::Result<u16> {\n     Ok((b[0] as u16) | ((b[1] as u16) << 8))\n }\n \n-fn read_byte(r: &mut io::Read) -> io::Result<u8> {\n+fn read_byte(r: &mut dyn io::Read) -> io::Result<u8> {\n     match r.bytes().next() {\n         Some(s) => s,\n         None => Err(io::Error::new(io::ErrorKind::Other, \"end of file\")),\n@@ -185,7 +185,7 @@ fn read_byte(r: &mut io::Read) -> io::Result<u8> {\n \n /// Parse a compiled terminfo entry, using long capability names if `longnames`\n /// is true\n-pub fn parse(file: &mut io::Read, longnames: bool) -> Result<TermInfo, String> {\n+pub fn parse(file: &mut dyn io::Read, longnames: bool) -> Result<TermInfo, String> {\n     macro_rules! t( ($e:expr) => (\n         match $e {\n             Ok(e) => e,"}]}