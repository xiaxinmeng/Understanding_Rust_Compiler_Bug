{"sha": "1439c2ac35e2e2b03fdc336dc108865387565bd7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE0MzljMmFjMzVlMmUyYjAzZmRjMzM2ZGMxMDg4NjUzODc1NjViZDc=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-02-04T15:28:58Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-02-04T15:28:58Z"}, "message": "Rollup merge of #47947 - goodmanjonathan:stabilize_match_beginning_vert, r=petrochenkov\n\nStabilize feature(match_beginning_vert)\n\nWith this feature stabilized, match expressions can optionally have a `|` at the beginning of each arm.\n\nReference PR: rust-lang-nursery/reference#231\n\nCloses #44101", "tree": {"sha": "aeae94e33bf1d93b052337495c5066416ac4bb29", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/aeae94e33bf1d93b052337495c5066416ac4bb29"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1439c2ac35e2e2b03fdc336dc108865387565bd7", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJadya6CRBK7hj4Ov3rIwAAdHIIAGDqeCVP6p6LxbcEWaN0V+kF\nbx4FVXsrMcw4P8Giafa06QOP2TuxEmwR+hcjzjop4HalcuC2r5FiZjb30xC/cv+L\nuXaPUG4hmUTQwTpF9p0V9wJzduMihLW6hlvcRTeGPkSfpnDN+16VPb6rGjxPtocS\nbYXbodBZoHimhcpcH37r3ZYZx60gJf5gmlNJsGpQto+SwBkg+XS9U5msz874AW1z\naK3nmoLfUeGxvNLu4eewB7+Qp8EioBd71aJYJ9ACVfUnrDpXebEyhSdv8ycP07nC\nX/F4cPIQCxYQrUrHSULac10mRtYqVCtGlCxU7eRj+HMc2DBdRqDmtJ4qOzgyyb8=\n=9oyb\n-----END PGP SIGNATURE-----\n", "payload": "tree aeae94e33bf1d93b052337495c5066416ac4bb29\nparent 8b8c6ee79613037e3a7886d1b80c34fcc538511b\nparent a99b5db56a36652185a91be630b3e2af8ea09360\nauthor kennytm <kennytm@gmail.com> 1517758138 +0800\ncommitter GitHub <noreply@github.com> 1517758138 +0800\n\nRollup merge of #47947 - goodmanjonathan:stabilize_match_beginning_vert, r=petrochenkov\n\nStabilize feature(match_beginning_vert)\n\nWith this feature stabilized, match expressions can optionally have a `|` at the beginning of each arm.\n\nReference PR: rust-lang-nursery/reference#231\n\nCloses #44101\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1439c2ac35e2e2b03fdc336dc108865387565bd7", "html_url": "https://github.com/rust-lang/rust/commit/1439c2ac35e2e2b03fdc336dc108865387565bd7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1439c2ac35e2e2b03fdc336dc108865387565bd7/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8b8c6ee79613037e3a7886d1b80c34fcc538511b", "url": "https://api.github.com/repos/rust-lang/rust/commits/8b8c6ee79613037e3a7886d1b80c34fcc538511b", "html_url": "https://github.com/rust-lang/rust/commit/8b8c6ee79613037e3a7886d1b80c34fcc538511b"}, {"sha": "a99b5db56a36652185a91be630b3e2af8ea09360", "url": "https://api.github.com/repos/rust-lang/rust/commits/a99b5db56a36652185a91be630b3e2af8ea09360", "html_url": "https://github.com/rust-lang/rust/commit/a99b5db56a36652185a91be630b3e2af8ea09360"}], "stats": {"total": 135, "additions": 32, "deletions": 103}, "files": [{"sha": "f0a51af7fd1c807c17208f31894751a761a7b0ca", "filename": "src/doc/unstable-book/src/language-features/match-beginning-vert.md", "status": "removed", "additions": 0, "deletions": 23, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/8b8c6ee79613037e3a7886d1b80c34fcc538511b/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fmatch-beginning-vert.md", "raw_url": "https://github.com/rust-lang/rust/raw/8b8c6ee79613037e3a7886d1b80c34fcc538511b/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fmatch-beginning-vert.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fmatch-beginning-vert.md?ref=8b8c6ee79613037e3a7886d1b80c34fcc538511b", "patch": "@@ -1,23 +0,0 @@\n-# `match_beginning_vert`\n-\n-The tracking issue for this feature is [#44101].\n-\n-With this feature enabled, you are allowed to add a '|' to the beginning of a\n-match arm:\n-\n-```rust\n-#![feature(match_beginning_vert)]\n-\n-enum Foo { A, B, C }\n-\n-fn main() {\n-    let x = Foo::A;\n-    match x {\n-        | Foo::A \n-        | Foo::B => println!(\"AB\"),\n-        | Foo::C => println!(\"C\"),\n-    }\n-}\n-```\n-\n-[#44101]: https://github.com/rust-lang/rust/issues/44101\n\\ No newline at end of file"}, {"sha": "c7ab6158256bae9fd624d77345123f6f1142b109", "filename": "src/libsyntax/ast.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/1439c2ac35e2e2b03fdc336dc108865387565bd7/src%2Flibsyntax%2Fast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1439c2ac35e2e2b03fdc336dc108865387565bd7/src%2Flibsyntax%2Fast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fast.rs?ref=1439c2ac35e2e2b03fdc336dc108865387565bd7", "patch": "@@ -883,7 +883,6 @@ pub struct Arm {\n     pub pats: Vec<P<Pat>>,\n     pub guard: Option<P<Expr>>,\n     pub body: P<Expr>,\n-    pub beginning_vert: Option<Span>, // For RFC 1925 feature gate\n }\n \n #[derive(Clone, PartialEq, Eq, RustcEncodable, RustcDecodable, Hash, Debug)]"}, {"sha": "2e6de96d65a6dfcd86cce0cfcec93d06037c1d1a", "filename": "src/libsyntax/ext/build.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/1439c2ac35e2e2b03fdc336dc108865387565bd7/src%2Flibsyntax%2Fext%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1439c2ac35e2e2b03fdc336dc108865387565bd7/src%2Flibsyntax%2Fext%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Fbuild.rs?ref=1439c2ac35e2e2b03fdc336dc108865387565bd7", "patch": "@@ -883,7 +883,6 @@ impl<'a> AstBuilder for ExtCtxt<'a> {\n             pats,\n             guard: None,\n             body: expr,\n-            beginning_vert: None,\n         }\n     }\n "}, {"sha": "3e858c3b923a1154d218359b1f928bc37b9a6fe6", "filename": "src/libsyntax/feature_gate.rs", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/1439c2ac35e2e2b03fdc336dc108865387565bd7/src%2Flibsyntax%2Ffeature_gate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1439c2ac35e2e2b03fdc336dc108865387565bd7/src%2Flibsyntax%2Ffeature_gate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ffeature_gate.rs?ref=1439c2ac35e2e2b03fdc336dc108865387565bd7", "patch": "@@ -386,9 +386,6 @@ declare_features! (\n     // allow `#[must_use]` on functions and comparison operators (RFC 1940)\n     (active, fn_must_use, \"1.21.0\", Some(43302)),\n \n-    // allow '|' at beginning of match arms (RFC 1925)\n-    (active, match_beginning_vert, \"1.21.0\", Some(44101)),\n-\n     // Future-proofing enums/structs with #[non_exhaustive] attribute (RFC 2008)\n     (active, non_exhaustive, \"1.22.0\", Some(44109)),\n \n@@ -545,6 +542,8 @@ declare_features! (\n     (accepted, abi_sysv64, \"1.24.0\", Some(36167)),\n     // Allows `repr(align(16))` struct attribute (RFC 1358)\n     (accepted, repr_align, \"1.24.0\", Some(33626)),\n+    // allow '|' at beginning of match arms (RFC 1925)\n+    (accepted, match_beginning_vert, \"1.25.0\", Some(44101)),\n );\n \n // If you change this, please modify src/doc/unstable-book as well. You must\n@@ -1683,11 +1682,6 @@ impl<'a> Visitor<'a> for PostExpansionVisitor<'a> {\n     }\n \n     fn visit_arm(&mut self, arm: &'a ast::Arm) {\n-        if let Some(span) = arm.beginning_vert {\n-            gate_feature_post!(&self, match_beginning_vert,\n-                               span,\n-                               \"Use of a '|' at the beginning of a match arm is experimental\")\n-        }\n         visit::walk_arm(self, arm)\n     }\n "}, {"sha": "921ed3565a47197400fa72c6d560366516cb16bf", "filename": "src/libsyntax/fold.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/1439c2ac35e2e2b03fdc336dc108865387565bd7/src%2Flibsyntax%2Ffold.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1439c2ac35e2e2b03fdc336dc108865387565bd7/src%2Flibsyntax%2Ffold.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ffold.rs?ref=1439c2ac35e2e2b03fdc336dc108865387565bd7", "patch": "@@ -340,14 +340,13 @@ pub fn fold_thin_attrs<T: Folder>(attrs: ThinVec<Attribute>, fld: &mut T) -> Thi\n     fold_attrs(attrs.into(), fld).into()\n }\n \n-pub fn noop_fold_arm<T: Folder>(Arm {attrs, pats, guard, body, beginning_vert}: Arm,\n+pub fn noop_fold_arm<T: Folder>(Arm {attrs, pats, guard, body}: Arm,\n     fld: &mut T) -> Arm {\n     Arm {\n         attrs: fold_attrs(attrs, fld),\n         pats: pats.move_map(|x| fld.fold_pat(x)),\n         guard: guard.map(|x| fld.fold_expr(x)),\n         body: fld.fold_expr(body),\n-        beginning_vert,\n     }\n }\n "}, {"sha": "764b3d0a848eee508d57339441ea63fb35654339", "filename": "src/libsyntax/parse/parser.rs", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/1439c2ac35e2e2b03fdc336dc108865387565bd7/src%2Flibsyntax%2Fparse%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1439c2ac35e2e2b03fdc336dc108865387565bd7/src%2Flibsyntax%2Fparse%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Fparser.rs?ref=1439c2ac35e2e2b03fdc336dc108865387565bd7", "patch": "@@ -3398,11 +3398,7 @@ impl<'a> Parser<'a> {\n \n         let attrs = self.parse_outer_attributes()?;\n         // Allow a '|' before the pats (RFC 1925)\n-        let beginning_vert = if self.eat(&token::BinOp(token::Or)) {\n-            Some(self.prev_span)\n-        } else {\n-            None\n-        };\n+        self.eat(&token::BinOp(token::Or));\n         let pats = self.parse_pats()?;\n         let guard = if self.eat_keyword(keywords::If) {\n             Some(self.parse_expr()?)\n@@ -3426,7 +3422,6 @@ impl<'a> Parser<'a> {\n             pats,\n             guard,\n             body: expr,\n-            beginning_vert,\n         })\n     }\n "}, {"sha": "cdacfb2f057298e500522b53ddcdd5d254d41ee2", "filename": "src/test/run-pass/match-beginning-vert.rs", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/1439c2ac35e2e2b03fdc336dc108865387565bd7/src%2Ftest%2Frun-pass%2Fmatch-beginning-vert.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1439c2ac35e2e2b03fdc336dc108865387565bd7/src%2Ftest%2Frun-pass%2Fmatch-beginning-vert.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fmatch-beginning-vert.rs?ref=1439c2ac35e2e2b03fdc336dc108865387565bd7", "patch": "@@ -0,0 +1,28 @@\n+// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+enum Foo {\n+    A,\n+    B,\n+    C,\n+    D,\n+    E,\n+}\n+use Foo::*;\n+\n+fn main() {\n+    for foo in &[A, B, C, D, E] {\n+        match *foo {\n+            | A => println!(\"A\"),\n+            | B | C if 1 < 2 => println!(\"BC!\"),\n+            | _ => {},\n+        }\n+    }\n+}"}, {"sha": "9085563c99d6d5db3c0cd289a4f162e6f4c69cc7", "filename": "src/test/ui/feature-gate-match_beginning_vert.rs", "status": "removed", "additions": 0, "deletions": 36, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/8b8c6ee79613037e3a7886d1b80c34fcc538511b/src%2Ftest%2Fui%2Ffeature-gate-match_beginning_vert.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8b8c6ee79613037e3a7886d1b80c34fcc538511b/src%2Ftest%2Fui%2Ffeature-gate-match_beginning_vert.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gate-match_beginning_vert.rs?ref=8b8c6ee79613037e3a7886d1b80c34fcc538511b", "patch": "@@ -1,36 +0,0 @@\n-// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n-// file at the top-level directory of this distribution and at\n-// http://rust-lang.org/COPYRIGHT.\n-//\n-// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n-// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n-// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n-// option. This file may not be copied, modified, or distributed\n-// except according to those terms.\n-\n-#[allow(dead_code)]\n-enum Foo {\n-    A,\n-    B,\n-    C,\n-    D,\n-    E,\n-}\n-use Foo::*;\n-\n-fn main() {\n-    let x = Foo::A;\n-    match x {\n-        | A => println!(\"A\"),\n-        //~^ ERROR: Use of a '|' at the beginning of a match arm is experimental (see issue #44101)\n-        | B | C => println!(\"BC!\"),\n-        //~^ ERROR: Use of a '|' at the beginning of a match arm is experimental (see issue #44101)\n-        | _ => {},\n-        //~^ ERROR: Use of a '|' at the beginning of a match arm is experimental (see issue #44101)\n-    };\n-    match x {\n-        A | B | C => println!(\"ABC!\"),\n-        _ => {},\n-    };\n-}\n-"}, {"sha": "1d45dedb4971c28ee8113085badbc3948b8454c0", "filename": "src/test/ui/feature-gate-match_beginning_vert.stderr", "status": "removed", "additions": 0, "deletions": 26, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/8b8c6ee79613037e3a7886d1b80c34fcc538511b/src%2Ftest%2Fui%2Ffeature-gate-match_beginning_vert.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/8b8c6ee79613037e3a7886d1b80c34fcc538511b/src%2Ftest%2Fui%2Ffeature-gate-match_beginning_vert.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gate-match_beginning_vert.stderr?ref=8b8c6ee79613037e3a7886d1b80c34fcc538511b", "patch": "@@ -1,26 +0,0 @@\n-error[E0658]: Use of a '|' at the beginning of a match arm is experimental (see issue #44101)\n-  --> $DIR/feature-gate-match_beginning_vert.rs:24:9\n-   |\n-24 |         | A => println!(\"A\"),\n-   |         ^\n-   |\n-   = help: add #![feature(match_beginning_vert)] to the crate attributes to enable\n-\n-error[E0658]: Use of a '|' at the beginning of a match arm is experimental (see issue #44101)\n-  --> $DIR/feature-gate-match_beginning_vert.rs:26:9\n-   |\n-26 |         | B | C => println!(\"BC!\"),\n-   |         ^\n-   |\n-   = help: add #![feature(match_beginning_vert)] to the crate attributes to enable\n-\n-error[E0658]: Use of a '|' at the beginning of a match arm is experimental (see issue #44101)\n-  --> $DIR/feature-gate-match_beginning_vert.rs:28:9\n-   |\n-28 |         | _ => {},\n-   |         ^\n-   |\n-   = help: add #![feature(match_beginning_vert)] to the crate attributes to enable\n-\n-error: aborting due to 3 previous errors\n-"}]}