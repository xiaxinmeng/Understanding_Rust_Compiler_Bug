{"sha": "ec83b95ab97d2ca972ede3b36345173cd97a63a5", "node_id": "C_kwDOAAsO6NoAKGVjODNiOTVhYjk3ZDJjYTk3MmVkZTNiMzYzNDUxNzNjZDk3YTYzYTU", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-10-30T18:30:25Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-10-30T18:30:25Z"}, "message": "Rollup merge of #90156 - jsha:less-border-bottom-2, r=GuillaumeGomez\n\nRemove underlines from non-top docblocks.\n\nWe still had a number of places where underlined section headings would\nshow up, like under Implementations.\n\nFollow-up to #89506 (thanks `@yaymukund!)` and #90036. Related to #59829.\n\nr? `@camelid`\n\nDemo:\n\n[Before](https://doc.rust-lang.org/nightly/std/string/struct.String.html#trait-implementations):\n\n[![image](https://user-images.githubusercontent.com/220205/138402555-b0c0a3ea-ff50-4aad-bb74-6f9e57323807.png)](https://jacob.hoffman-andrews.com/rust/less-border-bottom-2/std/string/struct.String.html#trait-implementations)\n\n[After](https://jacob.hoffman-andrews.com/rust/less-border-bottom-2/std/string/struct.String.html#trait-implementations):\n\n[![image](https://user-images.githubusercontent.com/220205/138402669-d0835bd9-8813-4f0c-8697-f86e9759acec.png)](https://jacob.hoffman-andrews.com/rust/less-border-bottom-2/std/string/struct.String.html#trait-implementations)", "tree": {"sha": "5aeb63938115e5a79cb2c73d115b25cc41b35663", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5aeb63938115e5a79cb2c73d115b25cc41b35663"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ec83b95ab97d2ca972ede3b36345173cd97a63a5", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhfY9BCRBK7hj4Ov3rIwAAc/UIAG0gc45rqYtumL9e3/TEsZ04\nvpF4uguk0WP5Lt0dZdk+8h6TmKcO65mfFM3BjWMsFM63blCnOMxkeICmL+VCGhjb\nUWrSmsTNIvvxChCen0ysELcoEyD5ToJiwLNlYTUdN4gUioBrGx4EgIOerbor/qdM\nU7/IJIUsodX/lcU7OwAssriH0iaP9OsMN9EA1wUwune0bCoJYDQGS319RY+mlG81\nFKbaoeJy8B0iJxCTfsIvijt7VcWsC1t0TRRCTrrMQ2T+cw6Lx4RmvsTx5oT4fOgY\nf2cPev/Lbvc858mZjn0rjYOziQar9eii8f1LWv+METnyISGrzC2hZB6h7FIoQQc=\n=G1Rg\n-----END PGP SIGNATURE-----\n", "payload": "tree 5aeb63938115e5a79cb2c73d115b25cc41b35663\nparent 9f13083542cb2b9fce83ed8a50238e4a6386820f\nparent a65c98fefb78cddee955b87214732b0de30a769f\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1635618625 +0200\ncommitter GitHub <noreply@github.com> 1635618625 +0200\n\nRollup merge of #90156 - jsha:less-border-bottom-2, r=GuillaumeGomez\n\nRemove underlines from non-top docblocks.\n\nWe still had a number of places where underlined section headings would\nshow up, like under Implementations.\n\nFollow-up to #89506 (thanks `@yaymukund!)` and #90036. Related to #59829.\n\nr? `@camelid`\n\nDemo:\n\n[Before](https://doc.rust-lang.org/nightly/std/string/struct.String.html#trait-implementations):\n\n[![image](https://user-images.githubusercontent.com/220205/138402555-b0c0a3ea-ff50-4aad-bb74-6f9e57323807.png)](https://jacob.hoffman-andrews.com/rust/less-border-bottom-2/std/string/struct.String.html#trait-implementations)\n\n[After](https://jacob.hoffman-andrews.com/rust/less-border-bottom-2/std/string/struct.String.html#trait-implementations):\n\n[![image](https://user-images.githubusercontent.com/220205/138402669-d0835bd9-8813-4f0c-8697-f86e9759acec.png)](https://jacob.hoffman-andrews.com/rust/less-border-bottom-2/std/string/struct.String.html#trait-implementations)\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ec83b95ab97d2ca972ede3b36345173cd97a63a5", "html_url": "https://github.com/rust-lang/rust/commit/ec83b95ab97d2ca972ede3b36345173cd97a63a5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ec83b95ab97d2ca972ede3b36345173cd97a63a5/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9f13083542cb2b9fce83ed8a50238e4a6386820f", "url": "https://api.github.com/repos/rust-lang/rust/commits/9f13083542cb2b9fce83ed8a50238e4a6386820f", "html_url": "https://github.com/rust-lang/rust/commit/9f13083542cb2b9fce83ed8a50238e4a6386820f"}, {"sha": "a65c98fefb78cddee955b87214732b0de30a769f", "url": "https://api.github.com/repos/rust-lang/rust/commits/a65c98fefb78cddee955b87214732b0de30a769f", "html_url": "https://github.com/rust-lang/rust/commit/a65c98fefb78cddee955b87214732b0de30a769f"}], "stats": {"total": 69, "additions": 65, "deletions": 4}, "files": [{"sha": "93cbc0debb945378213a53e68a42b68fa61d7054", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/ec83b95ab97d2ca972ede3b36345173cd97a63a5/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/ec83b95ab97d2ca972ede3b36345173cd97a63a5/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=ec83b95ab97d2ca972ede3b36345173cd97a63a5", "patch": "@@ -134,7 +134,7 @@ h1, h2, h3, h4 {\n \tmargin: 20px 0 15px 0;\n \tpadding-bottom: 6px;\n }\n-h5, h6 {\n+.docblock h3, .docblock h4, h5, h6 {\n \tmargin: 15px 0 5px 0;\n }\n h1.fqn {\n@@ -149,7 +149,14 @@ h1.fqn {\n h1.fqn > .in-band > a:hover {\n \ttext-decoration: underline;\n }\n-h2, h3, h4 {\n+/* The only headings that get underlines are:\n+\t Markdown-generated headings within the top-doc\n+\t Rustdoc-generated h2 section headings (e.g. \"Implementations\", \"Required Methods\", etc)\n+\tUnderlines elsewhere in the documentation break up visual flow and tend to invert\n+\tsection hierarchies. */\n+h2,\n+.top-doc h3,\n+.top-doc h4 {\n \tborder-bottom: 1px solid;\n }\n h3.code-header {"}, {"sha": "35d772170f6f98c3b96f5cf69a6ab4ce96d19ad0", "filename": "src/test/rustdoc-gui/headings.goml", "status": "renamed", "additions": 56, "deletions": 2, "changes": 58, "blob_url": "https://github.com/rust-lang/rust/blob/ec83b95ab97d2ca972ede3b36345173cd97a63a5/src%2Ftest%2Frustdoc-gui%2Fheadings.goml", "raw_url": "https://github.com/rust-lang/rust/raw/ec83b95ab97d2ca972ede3b36345173cd97a63a5/src%2Ftest%2Frustdoc-gui%2Fheadings.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fheadings.goml?ref=ec83b95ab97d2ca972ede3b36345173cd97a63a5", "patch": "@@ -1,6 +1,8 @@\n-// This test check that headers (a) have the correct heading level, and (b) are the right size.\n+// This test check that headers (a) have the correct heading level, (b) are the right size,\n+// and (c) have the correct underlining (or absence of underlining).\n // The sizes may change as design changes, but try to make sure a lower header is never bigger than\n-// its parent headers.\n+// its parent headers. Also make sure lower headers don't have underlines when their parents lack\n+// an underline.\n // Most of these sizes are set in CSS in `em` units, so here's a conversion chart based on our\n // default 16px font size:\n // 24px    1.5em\n@@ -13,87 +15,139 @@\n goto: file://|DOC_PATH|/test_docs/struct.HeavilyDocumentedStruct.html\n \n assert-css: (\"h1.fqn\", {\"font-size\": \"24px\"})\n+assert-css: (\"h1.fqn\", {\"border-bottom-width\": \"1px\"})\n \n assert-css: (\"h2#top-doc-prose-title\", {\"font-size\": \"20.8px\"})\n+assert-css: (\"h2#top-doc-prose-title\", {\"border-bottom-width\": \"1px\"})\n assert-css: (\"h3#top-doc-prose-sub-heading\", {\"font-size\": \"18.4px\"})\n+assert-css: (\"h3#top-doc-prose-sub-heading\", {\"border-bottom-width\": \"1px\"})\n assert-css: (\"h4#top-doc-prose-sub-sub-heading\", {\"font-size\": \"17.6px\"})\n+assert-css: (\"h4#top-doc-prose-sub-sub-heading\", {\"border-bottom-width\": \"1px\"})\n \n assert-css: (\"h2#fields\", {\"font-size\": \"22.4px\"})\n+assert-css: (\"h2#fields\", {\"border-bottom-width\": \"1px\"})\n assert-css: (\"h3#title-for-field\", {\"font-size\": \"20.8px\"})\n+assert-css: (\"h3#title-for-field\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h4#sub-heading-for-field\", {\"font-size\": \"16px\"})\n+assert-css: (\"h4#sub-heading-for-field\", {\"border-bottom-width\": \"0px\"})\n \n assert-css: (\"h2#implementations\", {\"font-size\": \"22.4px\"})\n+assert-css: (\"h2#implementations\", {\"border-bottom-width\": \"1px\"})\n \n assert-css: (\"#impl > h3.code-header\", {\"font-size\": \"17.6px\"})\n+assert-css: (\"#impl > h3.code-header\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"#method\\.do_nothing > h4.code-header\", {\"font-size\": \"16px\"})\n+assert-css: (\"#method\\.do_nothing > h4.code-header\", {\"border-bottom-width\": \"0px\"})\n \n assert-css: (\"h4#title-for-struct-impl-doc\", {\"font-size\": \"16px\"})\n+assert-css: (\"h4#title-for-struct-impl-doc\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h5#sub-heading-for-struct-impl-doc\", {\"font-size\": \"16px\"})\n+assert-css: (\"h5#sub-heading-for-struct-impl-doc\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h6#sub-sub-heading-for-struct-impl-doc\", {\"font-size\": \"15.2px\"})\n+assert-css: (\"h6#sub-sub-heading-for-struct-impl-doc\", {\"border-bottom-width\": \"0px\"})\n \n assert-css: (\"h5#title-for-struct-impl-item-doc\", {\"font-size\": \"16px\"})\n+assert-css: (\"h5#title-for-struct-impl-item-doc\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h6#sub-heading-for-struct-impl-item-doc\", {\"font-size\": \"15.2px\"})\n+assert-css: (\"h6#sub-heading-for-struct-impl-item-doc\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h6#sub-sub-heading-for-struct-impl-item-doc\", {\"font-size\": \"15.2px\"})\n \n goto: file://|DOC_PATH|/test_docs/enum.HeavilyDocumentedEnum.html\n \n assert-css: (\"h1.fqn\", {\"font-size\": \"24px\"})\n+assert-css: (\"h1.fqn\", {\"border-bottom-width\": \"1px\"})\n \n assert-css: (\"h2#top-doc-prose-title\", {\"font-size\": \"20.8px\"})\n+assert-css: (\"h2#top-doc-prose-title\", {\"border-bottom-width\": \"1px\"})\n assert-css: (\"h3#top-doc-prose-sub-heading\", {\"font-size\": \"18.4px\"})\n+assert-css: (\"h3#top-doc-prose-sub-heading\", {\"border-bottom-width\": \"1px\"})\n assert-css: (\"h4#top-doc-prose-sub-sub-heading\", {\"font-size\": \"17.6px\"})\n+assert-css: (\"h4#top-doc-prose-sub-sub-heading\", {\"border-bottom-width\": \"1px\"})\n \n assert-css: (\"h2#variants\", {\"font-size\": \"22.4px\"})\n+assert-css: (\"h2#variants\", {\"border-bottom-width\": \"1px\"})\n \n assert-css: (\"h3#none-prose-title\", {\"font-size\": \"20.8px\"})\n+assert-css: (\"h3#none-prose-title\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h4#none-prose-sub-heading\", {\"font-size\": \"16px\"})\n+assert-css: (\"h4#none-prose-sub-heading\", {\"border-bottom-width\": \"0px\"})\n \n assert-css: (\"h3#wrapped-prose-title\", {\"font-size\": \"20.8px\"})\n+assert-css: (\"h3#wrapped-prose-title\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h4#wrapped-prose-sub-heading\", {\"font-size\": \"16px\"})\n+assert-css: (\"h4#wrapped-prose-sub-heading\", {\"border-bottom-width\": \"0px\"})\n \n assert-css: (\"h4#wrapped0-prose-title\", {\"font-size\": \"16px\"})\n+assert-css: (\"h4#wrapped0-prose-title\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h5#wrapped0-prose-sub-heading\", {\"font-size\": \"16px\"})\n+assert-css: (\"h5#wrapped0-prose-sub-heading\", {\"border-bottom-width\": \"0px\"})\n \n assert-css: (\"h4#structy-prose-title\", {\"font-size\": \"16px\"})\n+assert-css: (\"h4#structy-prose-title\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h5#structy-prose-sub-heading\", {\"font-size\": \"16px\"})\n+assert-css: (\"h5#structy-prose-sub-heading\", {\"border-bottom-width\": \"0px\"})\n \n assert-css: (\"h2#implementations\", {\"font-size\": \"22.4px\"})\n+assert-css: (\"h2#implementations\", {\"border-bottom-width\": \"1px\"})\n \n assert-css: (\"#impl > h3.code-header\", {\"font-size\": \"17.6px\"})\n+assert-css: (\"#impl > h3.code-header\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"#method\\.do_nothing > h4.code-header\", {\"font-size\": \"16px\"})\n+assert-css: (\"#method\\.do_nothing > h4.code-header\", {\"border-bottom-width\": \"0px\"})\n \n assert-css: (\"h4#title-for-enum-impl-doc\", {\"font-size\": \"16px\"})\n+assert-css: (\"h4#title-for-enum-impl-doc\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h5#sub-heading-for-enum-impl-doc\", {\"font-size\": \"16px\"})\n+assert-css: (\"h5#sub-heading-for-enum-impl-doc\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h6#sub-sub-heading-for-enum-impl-doc\", {\"font-size\": \"15.2px\"})\n+assert-css: (\"h6#sub-sub-heading-for-enum-impl-doc\", {\"border-bottom-width\": \"0px\"})\n \n assert-css: (\"h5#title-for-enum-impl-item-doc\", {\"font-size\": \"16px\"})\n+assert-css: (\"h5#title-for-enum-impl-item-doc\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h6#sub-heading-for-enum-impl-item-doc\", {\"font-size\": \"15.2px\"})\n+assert-css: (\"h6#sub-heading-for-enum-impl-item-doc\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h6#sub-sub-heading-for-enum-impl-item-doc\", {\"font-size\": \"15.2px\"})\n+assert-css: (\"h6#sub-sub-heading-for-enum-impl-item-doc\", {\"border-bottom-width\": \"0px\"})\n \n goto: file://|DOC_PATH|/test_docs/union.HeavilyDocumentedUnion.html\n \n assert-css: (\"h1.fqn\", {\"font-size\": \"24px\"})\n+assert-css: (\"h1.fqn\", {\"border-bottom-width\": \"1px\"})\n \n assert-css: (\"h2#top-doc-prose-title\", {\"font-size\": \"20.8px\"})\n+assert-css: (\"h2#top-doc-prose-title\", {\"border-bottom-width\": \"1px\"})\n assert-css: (\"h3#top-doc-prose-sub-heading\", {\"font-size\": \"18.4px\"})\n+assert-css: (\"h3#top-doc-prose-sub-heading\", {\"border-bottom-width\": \"1px\"})\n \n assert-css: (\"h2#fields\", {\"font-size\": \"22.4px\"})\n+assert-css: (\"h2#fields\", {\"border-bottom-width\": \"1px\"})\n \n assert-css: (\"h3#title-for-union-variant\", {\"font-size\": \"20.8px\"})\n+assert-css: (\"h3#title-for-union-variant\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h4#sub-heading-for-union-variant\", {\"font-size\": \"16px\"})\n+assert-css: (\"h4#sub-heading-for-union-variant\", {\"border-bottom-width\": \"0px\"})\n \n assert-css: (\"h2#implementations\", {\"font-size\": \"22.4px\"})\n+assert-css: (\"h2#implementations\", {\"border-bottom-width\": \"1px\"})\n \n assert-css: (\"#impl > h3.code-header\", {\"font-size\": \"17.6px\"})\n+assert-css: (\"#impl > h3.code-header\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h4#title-for-union-impl-doc\", {\"font-size\": \"16px\"})\n+assert-css: (\"h4#title-for-union-impl-doc\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h5#sub-heading-for-union-impl-doc\", {\"font-size\": \"16px\"})\n+assert-css: (\"h5#sub-heading-for-union-impl-doc\", {\"border-bottom-width\": \"0px\"})\n \n assert-css: (\"h5#title-for-union-impl-item-doc\", {\"font-size\": \"16px\"})\n+assert-css: (\"h5#title-for-union-impl-item-doc\", {\"border-bottom-width\": \"0px\"})\n assert-css: (\"h6#sub-heading-for-union-impl-item-doc\", {\"font-size\": \"15.2px\"})\n+assert-css: (\"h6#sub-heading-for-union-impl-item-doc\", {\"border-bottom-width\": \"0px\"})\n \n goto: file://|DOC_PATH|/test_docs/macro.heavily_documented_macro.html\n \n assert-css: (\"h1.fqn\", {\"font-size\": \"24px\"})\n+assert-css: (\"h1.fqn\", {\"border-bottom-width\": \"1px\"})\n \n assert-css: (\"h2#top-doc-prose-title\", {\"font-size\": \"20.8px\"})\n+assert-css: (\"h2#top-doc-prose-title\", {\"border-bottom-width\": \"1px\"})\n assert-css: (\"h3#top-doc-prose-sub-heading\", {\"font-size\": \"18.4px\"})\n+assert-css: (\"h3#top-doc-prose-sub-heading\", {\"border-bottom-width\": \"1px\"})", "previous_filename": "src/test/rustdoc-gui/header-size.goml"}]}