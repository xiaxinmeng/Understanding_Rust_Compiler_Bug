{"sha": "ff9fd36aa4ed90051424560268108370bbb3749b", "node_id": "C_kwDOAAsO6NoAKGZmOWZkMzZhYTRlZDkwMDUxNDI0NTYwMjY4MTA4MzcwYmJiMzc0OWI", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-06-29T05:09:59Z"}, "committer": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-07-08T03:47:31Z"}, "message": "Implement IntoDiagnosticArg for hir::ConstContext", "tree": {"sha": "7c75f1d0b37918f5f877f9b8efe09b884e47f739", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7c75f1d0b37918f5f877f9b8efe09b884e47f739"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ff9fd36aa4ed90051424560268108370bbb3749b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ff9fd36aa4ed90051424560268108370bbb3749b", "html_url": "https://github.com/rust-lang/rust/commit/ff9fd36aa4ed90051424560268108370bbb3749b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ff9fd36aa4ed90051424560268108370bbb3749b/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1c4afbd1de7a0aa548a4b8f184aede5c5954e63a", "url": "https://api.github.com/repos/rust-lang/rust/commits/1c4afbd1de7a0aa548a4b8f184aede5c5954e63a", "html_url": "https://github.com/rust-lang/rust/commit/1c4afbd1de7a0aa548a4b8f184aede5c5954e63a"}], "stats": {"total": 16, "additions": 16, "deletions": 0}, "files": [{"sha": "268af59aa891ca002f922b7228d2652618c14ed1", "filename": "Cargo.lock", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/ff9fd36aa4ed90051424560268108370bbb3749b/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/ff9fd36aa4ed90051424560268108370bbb3749b/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=ff9fd36aa4ed90051424560268108370bbb3749b", "patch": "@@ -3813,6 +3813,7 @@ dependencies = [\n  \"atty\",\n  \"rustc_data_structures\",\n  \"rustc_error_messages\",\n+ \"rustc_hir\",\n  \"rustc_lint_defs\",\n  \"rustc_macros\",\n  \"rustc_serialize\","}, {"sha": "7d7e92c522922fbf99ba2ac57eb238023a85c715", "filename": "compiler/rustc_errors/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/ff9fd36aa4ed90051424560268108370bbb3749b/compiler%2Frustc_errors%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/ff9fd36aa4ed90051424560268108370bbb3749b/compiler%2Frustc_errors%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_errors%2FCargo.toml?ref=ff9fd36aa4ed90051424560268108370bbb3749b", "patch": "@@ -13,6 +13,7 @@ rustc_serialize = { path = \"../rustc_serialize\" }\n rustc_span = { path = \"../rustc_span\" }\n rustc_macros = { path = \"../rustc_macros\" }\n rustc_data_structures = { path = \"../rustc_data_structures\" }\n+rustc_hir = { path = \"../rustc_hir\" }\n rustc_lint_defs = { path = \"../rustc_lint_defs\" }\n unicode-width = \"0.1.4\"\n atty = \"0.2\""}, {"sha": "9429ad1a897453ec2dd7d63abf8eebf3f5f45ab7", "filename": "compiler/rustc_errors/src/diagnostic.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/ff9fd36aa4ed90051424560268108370bbb3749b/compiler%2Frustc_errors%2Fsrc%2Fdiagnostic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff9fd36aa4ed90051424560268108370bbb3749b/compiler%2Frustc_errors%2Fsrc%2Fdiagnostic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_errors%2Fsrc%2Fdiagnostic.rs?ref=ff9fd36aa4ed90051424560268108370bbb3749b", "patch": "@@ -5,6 +5,7 @@ use crate::{\n };\n use rustc_data_structures::stable_map::FxHashMap;\n use rustc_error_messages::FluentValue;\n+use rustc_hir as hir;\n use rustc_lint_defs::{Applicability, LintExpectationId};\n use rustc_span::edition::LATEST_STABLE_EDITION;\n use rustc_span::symbol::{Ident, Symbol};\n@@ -160,6 +161,16 @@ impl<'source> Into<FluentValue<'source>> for DiagnosticArgValue<'source> {\n     }\n }\n \n+impl IntoDiagnosticArg for hir::ConstContext {\n+    fn into_diagnostic_arg(self) -> DiagnosticArgValue<'static> {\n+        DiagnosticArgValue::Str(Cow::Borrowed(match self {\n+            hir::ConstContext::ConstFn => \"constant function\",\n+            hir::ConstContext::Static(_) => \"static\",\n+            hir::ConstContext::Const => \"constant\",\n+        }))\n+    }\n+}\n+\n /// Trait implemented by error types. This should not be implemented manually. Instead, use\n /// `#[derive(SessionSubdiagnostic)]` -- see [rustc_macros::SessionSubdiagnostic].\n #[rustc_diagnostic_item = \"AddSubdiagnostic\"]"}, {"sha": "acd77f5d2ee9136b835cb3b9bc3758b7607020ef", "filename": "compiler/rustc_hir/src/hir.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ff9fd36aa4ed90051424560268108370bbb3749b/compiler%2Frustc_hir%2Fsrc%2Fhir.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff9fd36aa4ed90051424560268108370bbb3749b/compiler%2Frustc_hir%2Fsrc%2Fhir.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir%2Fsrc%2Fhir.rs?ref=ff9fd36aa4ed90051424560268108370bbb3749b", "patch": "@@ -1595,6 +1595,9 @@ impl fmt::Display for ConstContext {\n     }\n }\n \n+// NOTE: `IntoDiagnosticArg` impl for `ConstContext` lives in `rustc_errors`\n+// due to a cyclical dependency between hir that crate.\n+\n /// A literal.\n pub type Lit = Spanned<LitKind>;\n "}]}