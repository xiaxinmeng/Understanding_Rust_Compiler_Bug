{"sha": "c26518086eed253924f2f9b91f2dd812084e4b31", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMyNjUxODA4NmVlZDI1MzkyNGYyZjliOTFmMmRkODEyMDg0ZTRiMzE=", "commit": {"author": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2019-09-13T14:34:04Z"}, "committer": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2019-09-13T23:44:45Z"}, "message": "Move error codes to shared context", "tree": {"sha": "29d5b5070d94e5453b110740b94d7784d7a4039d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/29d5b5070d94e5453b110740b94d7784d7a4039d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c26518086eed253924f2f9b91f2dd812084e4b31", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c26518086eed253924f2f9b91f2dd812084e4b31", "html_url": "https://github.com/rust-lang/rust/commit/c26518086eed253924f2f9b91f2dd812084e4b31", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c26518086eed253924f2f9b91f2dd812084e4b31/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "98c94f6f771c0e3894a65e82572c5dca1c43167d", "url": "https://api.github.com/repos/rust-lang/rust/commits/98c94f6f771c0e3894a65e82572c5dca1c43167d", "html_url": "https://github.com/rust-lang/rust/commit/98c94f6f771c0e3894a65e82572c5dca1c43167d"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "fb751041644eea1f111daa2686670c6cce946334", "filename": "src/librustdoc/html/render.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/c26518086eed253924f2f9b91f2dd812084e4b31/src%2Flibrustdoc%2Fhtml%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c26518086eed253924f2f9b91f2dd812084e4b31/src%2Flibrustdoc%2Fhtml%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender.rs?ref=c26518086eed253924f2f9b91f2dd812084e4b31", "patch": "@@ -163,7 +163,6 @@ struct Context {\n     /// real location of an item. This is used to allow external links to\n     /// publicly reused items to redirect to the right location.\n     pub render_redirect_pages: bool,\n-    pub codes: ErrorCodes,\n     /// The map used to ensure all generated 'id=' attributes are unique.\n     id_map: Rc<RefCell<IdMap>>,\n     pub shared: Arc<SharedContext>,\n@@ -208,6 +207,7 @@ crate struct SharedContext {\n     pub fs: DocFS,\n     /// The default edition used to parse doctests.\n     pub edition: Edition,\n+    pub codes: ErrorCodes,\n }\n \n impl SharedContext {\n@@ -540,6 +540,7 @@ pub fn run(mut krate: clean::Crate,\n         generate_redirect_pages,\n         fs: DocFS::new(&errors),\n         edition,\n+        codes: ErrorCodes::from(UnstableFeatures::from_environment().is_nightly_build()),\n     };\n \n     // If user passed in `--playground-url` arg, we fill in crate name here\n@@ -585,7 +586,6 @@ pub fn run(mut krate: clean::Crate,\n         current: Vec::new(),\n         dst,\n         render_redirect_pages: false,\n-        codes: ErrorCodes::from(UnstableFeatures::from_environment().is_nightly_build()),\n         id_map: Rc::new(RefCell::new(id_map)),\n         shared: Arc::new(scx),\n         playground,\n@@ -2353,7 +2353,7 @@ fn render_markdown(\n            if is_hidden { \" hidden\" } else { \"\" },\n            prefix,\n            Markdown(md_text, &links, &mut ids,\n-           cx.codes, cx.shared.edition, &cx.playground).to_string())\n+           cx.shared.codes, cx.shared.edition, &cx.playground).to_string())\n }\n \n fn document_short(\n@@ -3961,7 +3961,7 @@ fn render_impl(w: &mut Buffer, cx: &Context, i: &Impl, link: AssocItemLink<'_>,\n             let mut ids = cx.id_map.borrow_mut();\n             write!(w, \"<div class='docblock'>{}</div>\",\n                    Markdown(&*dox, &i.impl_item.links(), &mut ids,\n-                            cx.codes, cx.shared.edition, &cx.playground).to_string());\n+                            cx.shared.codes, cx.shared.edition, &cx.playground).to_string());\n         }\n     }\n "}]}