{"sha": "5e3df4266aa31a688ac0909a0a7845bca7e563c0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVlM2RmNDI2NmFhMzFhNjg4YWMwOTA5YTBhNzg0NWJjYTdlNTYzYzA=", "commit": {"author": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2021-01-16T16:11:26Z"}, "committer": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2021-01-16T18:44:46Z"}, "message": "More advanced unknown lint suggestion\n\nThis copies the unknown_lints code clippy uses for its\nunknown_clippy_lints lint to rustc. The unknown_clippy_lints code is\nmore advanced, because it doesn't suggest renamed or removed lints and\ncorrectly suggest lower casing lints.", "tree": {"sha": "e544b871cd01065a8afd0633cea6f75d57ec00ff", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e544b871cd01065a8afd0633cea6f75d57ec00ff"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5e3df4266aa31a688ac0909a0a7845bca7e563c0", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEqv54U47RUUXZfOLnLO/Nsn7QvnkFAmADNB4ACgkQLO/Nsn7Q\nvnnuqg//V0vmb5MlZf11n+YGfs6qJ5om5PGeSPLVe0ptjpw3xwZwM+GxJfpI0Klu\nI7X976ZX9OZxjnt6MQosh05o63hiKsjkvboDgyepN7KoyMPlHB1fTVL9BsK/o5Wl\nb9kpwoSY4GHer2Eko9SE/COUAwPhpRrS2L9CZmXEluODqblORu05ovE6sAP4xHPT\nQzwOY9u1Zha+TRtUeB2cZQdyNMU3G57U7QMFAJf/cgWlEXGmF7ZEflp2dMEyxfRS\n5kej+3cbeyG8zon88cukLJi59VQEfCedZEagZEB2y0Y7Fwl3IxOIkNKtv1htB+GJ\nz5tFxYS3+bHb5kx3BMA3VerLmfLy/TgSU5YrT3ce0qJhZ5NxXLqmkY8KX85zpweI\nzmXZsxyYYguVqloRoZS26bF7LBqZLKRwPel7TUPENOKcJQdM23AxkoS44Ly6X0vp\naEW0XWYzKtmhiuaRv/VjXgnMgfuBuxKfhGyv3mH3+6bq3AGyAC5TccLyOQxMYOyY\nBmU/Qlhmkl30q1OK3ayrTgAaVcYhyEmS1AX95qFa3n9ieUE80FbrBuSP2adDHzvf\nT2Ai6bnKcH9XzrRDb5pysrcFN6/wXWE8m06bJXteIjfHASjtijyLqZ76LALB/JpJ\nINrhn8oM2pd7/Hf+g4+NPuTsAlmBa2jpsbyqAAG1nJ5xz3VnKvo=\n=ILTW\n-----END PGP SIGNATURE-----", "payload": "tree e544b871cd01065a8afd0633cea6f75d57ec00ff\nparent c819a4c0255fc8857ebadb74763edd9b9f9c9601\nauthor flip1995 <hello@philkrones.com> 1610813486 +0100\ncommitter flip1995 <hello@philkrones.com> 1610822686 +0100\n\nMore advanced unknown lint suggestion\n\nThis copies the unknown_lints code clippy uses for its\nunknown_clippy_lints lint to rustc. The unknown_clippy_lints code is\nmore advanced, because it doesn't suggest renamed or removed lints and\ncorrectly suggest lower casing lints.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5e3df4266aa31a688ac0909a0a7845bca7e563c0", "html_url": "https://github.com/rust-lang/rust/commit/5e3df4266aa31a688ac0909a0a7845bca7e563c0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5e3df4266aa31a688ac0909a0a7845bca7e563c0/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c819a4c0255fc8857ebadb74763edd9b9f9c9601", "url": "https://api.github.com/repos/rust-lang/rust/commits/c819a4c0255fc8857ebadb74763edd9b9f9c9601", "html_url": "https://github.com/rust-lang/rust/commit/c819a4c0255fc8857ebadb74763edd9b9f9c9601"}], "stats": {"total": 16, "additions": 11, "deletions": 5}, "files": [{"sha": "3971a3099823fa8f0f386b3f6c4031808ca1d426", "filename": "compiler/rustc_lint/src/context.rs", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/5e3df4266aa31a688ac0909a0a7845bca7e563c0/compiler%2Frustc_lint%2Fsrc%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e3df4266aa31a688ac0909a0a7845bca7e563c0/compiler%2Frustc_lint%2Fsrc%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Fcontext.rs?ref=5e3df4266aa31a688ac0909a0a7845bca7e563c0", "patch": "@@ -412,12 +412,18 @@ impl LintStore {\n     }\n \n     fn no_lint_suggestion(&self, lint_name: &str) -> CheckLintNameResult<'_> {\n-        let symbols = self.by_name.keys().map(|name| Symbol::intern(&name)).collect::<Vec<_>>();\n+        let name_lower = lint_name.to_lowercase();\n+        let symbols =\n+            self.get_lints().iter().map(|l| Symbol::intern(&l.name_lower())).collect::<Vec<_>>();\n \n-        let suggestion =\n-            find_best_match_for_name(&symbols, Symbol::intern(&lint_name.to_lowercase()), None);\n-\n-        CheckLintNameResult::NoLint(suggestion)\n+        if lint_name.chars().any(char::is_uppercase) && self.find_lints(&name_lower).is_ok() {\n+            // First check if the lint name is (partly) in upper case instead of lower case...\n+            CheckLintNameResult::NoLint(Some(Symbol::intern(&name_lower)))\n+        } else {\n+            // ...if not, search for lints with a similar name\n+            let suggestion = find_best_match_for_name(&symbols, Symbol::intern(&name_lower), None);\n+            CheckLintNameResult::NoLint(suggestion)\n+        }\n     }\n \n     fn check_tool_name_for_backwards_compat("}]}