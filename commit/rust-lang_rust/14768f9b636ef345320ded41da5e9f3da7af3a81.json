{"sha": "14768f9b636ef345320ded41da5e9f3da7af3a81", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE0NzY4ZjliNjM2ZWYzNDUzMjBkZWQ0MWRhNWU5ZjNkYTdhZjNhODE=", "commit": {"author": {"name": "Jorge Aparicio", "email": "jorge@japaric.io", "date": "2018-04-04T17:24:57Z"}, "committer": {"name": "Jorge Aparicio", "email": "jorge@japaric.io", "date": "2018-04-04T17:24:57Z"}, "message": "create a nostd crate\n\nthe goal is to build, in a single Cargo invocation, several no-std crates that we want to put in the\nrust-std component of no-std targets. The nostd crate builds these crates:\n\n- core\n- compiler-builtin (with the \"c\" and \"mem\" features enabled)\n- alloc\n- std_unicode", "tree": {"sha": "8ac8ad28fa7d3a0607ede928ebd7eb76b5068dac", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8ac8ad28fa7d3a0607ede928ebd7eb76b5068dac"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/14768f9b636ef345320ded41da5e9f3da7af3a81", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/14768f9b636ef345320ded41da5e9f3da7af3a81", "html_url": "https://github.com/rust-lang/rust/commit/14768f9b636ef345320ded41da5e9f3da7af3a81", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/14768f9b636ef345320ded41da5e9f3da7af3a81/comments", "author": {"login": "japaric", "id": 5018213, "node_id": "MDQ6VXNlcjUwMTgyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/5018213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/japaric", "html_url": "https://github.com/japaric", "followers_url": "https://api.github.com/users/japaric/followers", "following_url": "https://api.github.com/users/japaric/following{/other_user}", "gists_url": "https://api.github.com/users/japaric/gists{/gist_id}", "starred_url": "https://api.github.com/users/japaric/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/japaric/subscriptions", "organizations_url": "https://api.github.com/users/japaric/orgs", "repos_url": "https://api.github.com/users/japaric/repos", "events_url": "https://api.github.com/users/japaric/events{/privacy}", "received_events_url": "https://api.github.com/users/japaric/received_events", "type": "User", "site_admin": false}, "committer": {"login": "japaric", "id": 5018213, "node_id": "MDQ6VXNlcjUwMTgyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/5018213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/japaric", "html_url": "https://github.com/japaric", "followers_url": "https://api.github.com/users/japaric/followers", "following_url": "https://api.github.com/users/japaric/following{/other_user}", "gists_url": "https://api.github.com/users/japaric/gists{/gist_id}", "starred_url": "https://api.github.com/users/japaric/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/japaric/subscriptions", "organizations_url": "https://api.github.com/users/japaric/orgs", "repos_url": "https://api.github.com/users/japaric/repos", "events_url": "https://api.github.com/users/japaric/events{/privacy}", "received_events_url": "https://api.github.com/users/japaric/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "862c839fb9e0ad5615443b7e8fa21b421e2e74eb", "url": "https://api.github.com/repos/rust-lang/rust/commits/862c839fb9e0ad5615443b7e8fa21b421e2e74eb", "html_url": "https://github.com/rust-lang/rust/commit/862c839fb9e0ad5615443b7e8fa21b421e2e74eb"}], "stats": {"total": 39, "additions": 35, "deletions": 4}, "files": [{"sha": "42ac9b3c49dee27e40d56970af521994949bcb6b", "filename": "src/Cargo.lock", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/14768f9b636ef345320ded41da5e9f3da7af3a81/src%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/14768f9b636ef345320ded41da5e9f3da7af3a81/src%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2FCargo.lock?ref=14768f9b636ef345320ded41da5e9f3da7af3a81", "patch": "@@ -1081,6 +1081,16 @@ name = \"nodrop\"\n version = \"0.1.12\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n+[[package]]\n+name = \"nostd\"\n+version = \"0.0.0\"\n+dependencies = [\n+ \"alloc 0.0.0\",\n+ \"compiler_builtins 0.0.0\",\n+ \"core 0.0.0\",\n+ \"std_unicode 0.0.0\",\n+]\n+\n [[package]]\n name = \"num\"\n version = \"0.1.42\""}, {"sha": "babf35d570b5174d739d6ccce93abd9de41216c6", "filename": "src/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/14768f9b636ef345320ded41da5e9f3da7af3a81/src%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/14768f9b636ef345320ded41da5e9f3da7af3a81/src%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2FCargo.toml?ref=14768f9b636ef345320ded41da5e9f3da7af3a81", "patch": "@@ -2,6 +2,7 @@\n members = [\n   \"bootstrap\",\n   \"rustc\",\n+  \"libnostd\",\n   \"libstd\",\n   \"libtest\",\n   \"librustc_trans\","}, {"sha": "a93b26ac2bae0d541de7116a51c95e07bcfb3115", "filename": "src/bootstrap/compile.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/14768f9b636ef345320ded41da5e9f3da7af3a81/src%2Fbootstrap%2Fcompile.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14768f9b636ef345320ded41da5e9f3da7af3a81/src%2Fbootstrap%2Fcompile.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fcompile.rs?ref=14768f9b636ef345320ded41da5e9f3da7af3a81", "patch": "@@ -145,10 +145,10 @@ pub fn std_cargo(build: &Builder,\n     }\n \n     if build.no_std(target) == Some(true) {\n-        // for no-std targets we only compile core and compiler-builtins\n-        cargo.arg(\"--features\").arg(\"c mem\")\n-            .arg(\"--manifest-path\")\n-            .arg(build.src.join(\"src/rustc/compiler_builtins_shim/Cargo.toml\"));\n+        // for no-std targets we compile a minimal nostd crate that only depends on crates that work\n+        // without an OS\n+        cargo.arg(\"--manifest-path\")\n+            .arg(build.src.join(\"src/libnostd/Cargo.toml\"));\n     } else {\n         let mut features = build.std_features();\n "}, {"sha": "6919390d3e2a70ffa65b1530b18e0511e9fefe5d", "filename": "src/libnostd/Cargo.toml", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/14768f9b636ef345320ded41da5e9f3da7af3a81/src%2Flibnostd%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/14768f9b636ef345320ded41da5e9f3da7af3a81/src%2Flibnostd%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibnostd%2FCargo.toml?ref=14768f9b636ef345320ded41da5e9f3da7af3a81", "patch": "@@ -0,0 +1,17 @@\n+[package]\n+authors = [\"The Rust Project Developers\"]\n+name = \"nostd\"\n+version = \"0.0.0\"\n+license = \"MIT/Apache-2.0\"\n+repository = \"https://github.com/rust-lang/rust.git\"\n+description = \"(not) The Rust Standard Library\"\n+\n+[lib]\n+name = \"nostd\"\n+path = \"lib.rs\"\n+\n+[dependencies]\n+alloc = { path = \"../liballoc\" }\n+compiler_builtins = { path = \"../rustc/compiler_builtins_shim\", features = [\"c\", \"mem\"] }\n+core = { path = \"../libcore\" }\n+std_unicode = { path = \"../libstd_unicode\" }\n\\ No newline at end of file"}, {"sha": "d28afe2838e281b5f771ffe4777cab5f063536af", "filename": "src/libnostd/lib.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/14768f9b636ef345320ded41da5e9f3da7af3a81/src%2Flibnostd%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14768f9b636ef345320ded41da5e9f3da7af3a81/src%2Flibnostd%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibnostd%2Flib.rs?ref=14768f9b636ef345320ded41da5e9f3da7af3a81", "patch": "@@ -0,0 +1,3 @@\n+#![feature(staged_api)]\n+#![no_std]\n+#![unstable(feature = \"nostd\", issue = \"0\")]"}]}