{"sha": "698e50f98548cfdf36599bb975609c816567f709", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY5OGU1MGY5ODU0OGNmZGYzNjU5OWJiOTc1NjA5YzgxNjU2N2Y3MDk=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2019-05-24T11:56:26Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2019-05-24T12:02:19Z"}, "message": "Delay ICE in fold_region so feature gate has chance to stop compilation cleanly.", "tree": {"sha": "df7fe6e8e22879a7894f583c45a3dd809af17dd0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/df7fe6e8e22879a7894f583c45a3dd809af17dd0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/698e50f98548cfdf36599bb975609c816567f709", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/698e50f98548cfdf36599bb975609c816567f709", "html_url": "https://github.com/rust-lang/rust/commit/698e50f98548cfdf36599bb975609c816567f709", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/698e50f98548cfdf36599bb975609c816567f709/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "46805805abe58c287fa16963f897fd09d5d97467", "url": "https://api.github.com/repos/rust-lang/rust/commits/46805805abe58c287fa16963f897fd09d5d97467", "html_url": "https://github.com/rust-lang/rust/commit/46805805abe58c287fa16963f897fd09d5d97467"}], "stats": {"total": 9, "additions": 5, "deletions": 4}, "files": [{"sha": "75ba1dd46ca2a8260f4390d720d06a1c63025f57", "filename": "src/librustc/ty/subst.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/698e50f98548cfdf36599bb975609c816567f709/src%2Flibrustc%2Fty%2Fsubst.rs", "raw_url": "https://github.com/rust-lang/rust/raw/698e50f98548cfdf36599bb975609c816567f709/src%2Flibrustc%2Fty%2Fsubst.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fsubst.rs?ref=698e50f98548cfdf36599bb975609c816567f709", "patch": "@@ -479,21 +479,22 @@ impl<'a, 'gcx, 'tcx> TypeFolder<'gcx, 'tcx> for SubstFolder<'a, 'gcx, 'tcx> {\n         // the specialized routine `ty::replace_late_regions()`.\n         match *r {\n             ty::ReEarlyBound(data) => {\n-                let r = self.substs.get(data.index as usize).map(|k| k.unpack());\n-                match r {\n+                let rk = self.substs.get(data.index as usize).map(|k| k.unpack());\n+                match rk {\n                     Some(UnpackedKind::Lifetime(lt)) => {\n                         self.shift_region_through_binders(lt)\n                     }\n                     _ => {\n                         let span = self.span.unwrap_or(DUMMY_SP);\n-                        span_bug!(\n-                            span,\n+                        let msg = format!(\n                             \"Region parameter out of range \\\n                              when substituting in region {} (root type={:?}) \\\n                              (index={})\",\n                             data.name,\n                             self.root_ty,\n                             data.index);\n+                        self.tcx.sess.delay_span_bug(span, &msg);\n+                        r\n                     }\n                 }\n             }"}]}