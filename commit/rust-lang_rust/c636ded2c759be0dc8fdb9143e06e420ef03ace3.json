{"sha": "c636ded2c759be0dc8fdb9143e06e420ef03ace3", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM2MzZkZWQyYzc1OWJlMGRjOGZkYjkxNDNlMDZlNDIwZWYwM2FjZTM=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-07-26T10:54:13Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-07-26T11:15:31Z"}, "message": "Improve the information provided when this assertion fails.", "tree": {"sha": "98c3b6eb9c6c601c4ef7db12392f881944ef109e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/98c3b6eb9c6c601c4ef7db12392f881944ef109e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c636ded2c759be0dc8fdb9143e06e420ef03ace3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c636ded2c759be0dc8fdb9143e06e420ef03ace3", "html_url": "https://github.com/rust-lang/rust/commit/c636ded2c759be0dc8fdb9143e06e420ef03ace3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c636ded2c759be0dc8fdb9143e06e420ef03ace3/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fefe81605d6111faa8dbb3635ab2c51d59de740a", "url": "https://api.github.com/repos/rust-lang/rust/commits/fefe81605d6111faa8dbb3635ab2c51d59de740a", "html_url": "https://github.com/rust-lang/rust/commit/fefe81605d6111faa8dbb3635ab2c51d59de740a"}], "stats": {"total": 13, "additions": 10, "deletions": 3}, "files": [{"sha": "347bf61480ee4e9356e29bbcee2c0e80f1c553de", "filename": "src/librustc_mir/borrow_check/borrow_set.rs", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/c636ded2c759be0dc8fdb9143e06e420ef03ace3/src%2Flibrustc_mir%2Fborrow_check%2Fborrow_set.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c636ded2c759be0dc8fdb9143e06e420ef03ace3/src%2Flibrustc_mir%2Fborrow_check%2Fborrow_set.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Fborrow_set.rs?ref=c636ded2c759be0dc8fdb9143e06e420ef03ace3", "patch": "@@ -333,14 +333,21 @@ impl<'a, 'gcx, 'tcx> GatherBorrows<'a, 'gcx, 'tcx> {\n \n         // Consider the borrow not activated to start. When we find an activation, we'll update\n         // this field.\n-        let borrow_data = &mut self.idx_vec[borrow_index];\n-        borrow_data.activation_location = TwoPhaseActivation::NotActivated;\n+        {\n+            let borrow_data = &mut self.idx_vec[borrow_index];\n+            borrow_data.activation_location = TwoPhaseActivation::NotActivated;\n+        }\n \n         // Insert `temp` into the list of pending activations. From\n         // now on, we'll be on the lookout for a use of it. Note that\n         // we are guaranteed that this use will come after the\n         // assignment.\n         let old_value = self.pending_activations.insert(temp, borrow_index);\n-        assert!(old_value.is_none());\n+        if let Some(old_index) = old_value {\n+            span_bug!(self.mir.source_info(start_location).span,\n+                      \"found already pending activation for temp: {:?} \\\n+                       at borrow_index: {:?} with associated data {:?}\",\n+                      temp, old_index, self.idx_vec[old_index]);\n+        }\n     }\n }"}]}