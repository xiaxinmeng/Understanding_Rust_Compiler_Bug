{"sha": "7249036de5c6a2e8aad93512e3f529f3024d03e5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjcyNDkwMzZkZTVjNmEyZThhYWQ5MzUxMmUzZjUyOWYzMDI0ZDAzZTU=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-04-05T10:46:53Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-04-05T10:46:53Z"}, "message": "Rollup merge of #59712 - alexcrichton:wasm-static-not-pic, r=eddyb\n\nwasm32: Default to a \"static\" relocation model\n\nLLVM 9 is adding support for a \"pic\" relocation model for wasm code,\nwhich is quite different than the current model. In order to preserve\nthe mode of compilation that we have today default to \"static\" to ensure\nthat we don't accidentally start creating experimental relocatable\nbinaries.", "tree": {"sha": "5a0ec8f387726003bec71317864b3d2e60a83731", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5a0ec8f387726003bec71317864b3d2e60a83731"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7249036de5c6a2e8aad93512e3f529f3024d03e5", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcpzIdCRBK7hj4Ov3rIwAAdHIIAJuHVk37AstPOMYpei7eb98m\nkpOiooD4VtEnDkgVJFnV5nZJIjikClSo8sbyTXCryYRF3Kv4WXayv10x4F81rjn5\nrLa72guZLnBTJKkL+GeUZTOCO/ElIZlREJSvRRw59dAP8//ntqknt/+DEMkFEpjd\nimeAsfHGvxWQ3bWaJymiH/qG8gYUXGbE968QgFhjCwyiA45e39JjW55pOnr3mpnN\nAyLdiYuH1OXjzrDhYuegoGq0/qdnzyYY/oWKBFGalOc2oz5wNxCbrCi7/wrFBB6X\naNwgrnEFie43xxThX5vKBT2ZZH5csDGDhPQiG70F8PlNzC4wGb1AhQv9nDknBw0=\n=MMxx\n-----END PGP SIGNATURE-----\n", "payload": "tree 5a0ec8f387726003bec71317864b3d2e60a83731\nparent c0ed443fdd8c4d01abbba5970bd48c76cd0c0707\nparent 471db2b84bbeafb128bae8a8a9cf7fed13d2df4f\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1554461213 +0200\ncommitter GitHub <noreply@github.com> 1554461213 +0200\n\nRollup merge of #59712 - alexcrichton:wasm-static-not-pic, r=eddyb\n\nwasm32: Default to a \"static\" relocation model\n\nLLVM 9 is adding support for a \"pic\" relocation model for wasm code,\nwhich is quite different than the current model. In order to preserve\nthe mode of compilation that we have today default to \"static\" to ensure\nthat we don't accidentally start creating experimental relocatable\nbinaries.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7249036de5c6a2e8aad93512e3f529f3024d03e5", "html_url": "https://github.com/rust-lang/rust/commit/7249036de5c6a2e8aad93512e3f529f3024d03e5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7249036de5c6a2e8aad93512e3f529f3024d03e5/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c0ed443fdd8c4d01abbba5970bd48c76cd0c0707", "url": "https://api.github.com/repos/rust-lang/rust/commits/c0ed443fdd8c4d01abbba5970bd48c76cd0c0707", "html_url": "https://github.com/rust-lang/rust/commit/c0ed443fdd8c4d01abbba5970bd48c76cd0c0707"}, {"sha": "471db2b84bbeafb128bae8a8a9cf7fed13d2df4f", "url": "https://api.github.com/repos/rust-lang/rust/commits/471db2b84bbeafb128bae8a8a9cf7fed13d2df4f", "html_url": "https://github.com/rust-lang/rust/commit/471db2b84bbeafb128bae8a8a9cf7fed13d2df4f"}], "stats": {"total": 9, "additions": 9, "deletions": 0}, "files": [{"sha": "edaf902c130d8995055ba81c084501b90f32884c", "filename": "src/librustc_target/spec/wasm32_base.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/7249036de5c6a2e8aad93512e3f529f3024d03e5/src%2Flibrustc_target%2Fspec%2Fwasm32_base.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7249036de5c6a2e8aad93512e3f529f3024d03e5/src%2Flibrustc_target%2Fspec%2Fwasm32_base.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_target%2Fspec%2Fwasm32_base.rs?ref=7249036de5c6a2e8aad93512e3f529f3024d03e5", "patch": "@@ -118,6 +118,15 @@ pub fn options() -> TargetOptions {\n \n         pre_link_args,\n \n+        // This has no effect in LLVM 8 or prior, but in LLVM 9 and later when\n+        // PIC code is implemented this has quite a drastric effect if it stays\n+        // at the default, `pic`. In an effort to keep wasm binaries as minimal\n+        // as possible we're defaulting to `static` for now, but the hope is\n+        // that eventually we can ship a `pic`-compatible standard library which\n+        // works with `static` as well (or works with some method of generating\n+        // non-relative calls and such later on).\n+        relocation_model: \"static\".to_string(),\n+\n         .. Default::default()\n     }\n }"}]}