{"sha": "28c9c04325819662219340b21be55daf1d22ae4d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI4YzljMDQzMjU4MTk2NjIyMTkzNDBiMjFiZTU1ZGFmMWQyMmFlNGQ=", "commit": {"author": {"name": "Joshua Nelson", "email": "jyn514@gmail.com", "date": "2021-05-18T02:07:30Z"}, "committer": {"name": "Joshua Nelson", "email": "jyn514@gmail.com", "date": "2021-05-18T02:08:20Z"}, "message": "Don't require cmake on Windows when LLVM isn't being built\n\nPreviously, setting `download-ci-llvm = true` when cmake wasn't\ninstalled would give the following error:\n\n```\nfailed to execute command: \"cmake\" \"--help\"\nerror: The system cannot find the file specified. (os error 2)\n```", "tree": {"sha": "3ab125fe57cf127976abe097c76d35893edc0cc2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3ab125fe57cf127976abe097c76d35893edc0cc2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/28c9c04325819662219340b21be55daf1d22ae4d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/28c9c04325819662219340b21be55daf1d22ae4d", "html_url": "https://github.com/rust-lang/rust/commit/28c9c04325819662219340b21be55daf1d22ae4d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/28c9c04325819662219340b21be55daf1d22ae4d/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3e99439f4dacc8ba0d2ca48d221694362d587927", "url": "https://api.github.com/repos/rust-lang/rust/commits/3e99439f4dacc8ba0d2ca48d221694362d587927", "html_url": "https://github.com/rust-lang/rust/commit/3e99439f4dacc8ba0d2ca48d221694362d587927"}], "stats": {"total": 5, "additions": 3, "deletions": 2}, "files": [{"sha": "a28762ac485ecc03e1358219660b4bc126dfe138", "filename": "src/bootstrap/sanity.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/28c9c04325819662219340b21be55daf1d22ae4d/src%2Fbootstrap%2Fsanity.rs", "raw_url": "https://github.com/rust-lang/rust/raw/28c9c04325819662219340b21be55daf1d22ae4d/src%2Fbootstrap%2Fsanity.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fsanity.rs?ref=28c9c04325819662219340b21be55daf1d22ae4d", "patch": "@@ -93,7 +93,8 @@ pub fn check(build: &mut Build) {\n                     .unwrap_or(true)\n             })\n             .any(|build_llvm_ourselves| build_llvm_ourselves);\n-    if building_llvm || build.config.any_sanitizers_enabled() {\n+    let need_cmake = building_llvm || build.config.any_sanitizers_enabled();\n+    if need_cmake {\n         cmd_finder.must_have(\"cmake\");\n     }\n \n@@ -204,7 +205,7 @@ pub fn check(build: &mut Build) {\n             }\n         }\n \n-        if target.contains(\"msvc\") {\n+        if need_cmake && target.contains(\"msvc\") {\n             // There are three builds of cmake on windows: MSVC, MinGW, and\n             // Cygwin. The Cygwin build does not have generators for Visual\n             // Studio, so detect that here and error."}]}