{"sha": "0fa59204e5b70bcf473a4ca56ac8ceea362d7dff", "node_id": "C_kwDOAAsO6NoAKDBmYTU5MjA0ZTViNzBiY2Y0NzNhNGNhNTZhYzhjZWVhMzYyZDdkZmY", "commit": {"author": {"name": "Maybe Waffle", "email": "waffle.lapkin@gmail.com", "date": "2023-05-01T15:54:48Z"}, "committer": {"name": "Maybe Waffle", "email": "waffle.lapkin@gmail.com", "date": "2023-05-01T15:54:48Z"}, "message": "Remove \"RibKind\" suffix from `RibKind` variants", "tree": {"sha": "c5e93eb54dbb38186b887edef3e0617c79100348", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c5e93eb54dbb38186b887edef3e0617c79100348"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0fa59204e5b70bcf473a4ca56ac8ceea362d7dff", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0fa59204e5b70bcf473a4ca56ac8ceea362d7dff", "html_url": "https://github.com/rust-lang/rust/commit/0fa59204e5b70bcf473a4ca56ac8ceea362d7dff", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0fa59204e5b70bcf473a4ca56ac8ceea362d7dff/comments", "author": {"login": "WaffleLapkin", "id": 38225716, "node_id": "MDQ6VXNlcjM4MjI1NzE2", "avatar_url": "https://avatars.githubusercontent.com/u/38225716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/WaffleLapkin", "html_url": "https://github.com/WaffleLapkin", "followers_url": "https://api.github.com/users/WaffleLapkin/followers", "following_url": "https://api.github.com/users/WaffleLapkin/following{/other_user}", "gists_url": "https://api.github.com/users/WaffleLapkin/gists{/gist_id}", "starred_url": "https://api.github.com/users/WaffleLapkin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/WaffleLapkin/subscriptions", "organizations_url": "https://api.github.com/users/WaffleLapkin/orgs", "repos_url": "https://api.github.com/users/WaffleLapkin/repos", "events_url": "https://api.github.com/users/WaffleLapkin/events{/privacy}", "received_events_url": "https://api.github.com/users/WaffleLapkin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "WaffleLapkin", "id": 38225716, "node_id": "MDQ6VXNlcjM4MjI1NzE2", "avatar_url": "https://avatars.githubusercontent.com/u/38225716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/WaffleLapkin", "html_url": "https://github.com/WaffleLapkin", "followers_url": "https://api.github.com/users/WaffleLapkin/followers", "following_url": "https://api.github.com/users/WaffleLapkin/following{/other_user}", "gists_url": "https://api.github.com/users/WaffleLapkin/gists{/gist_id}", "starred_url": "https://api.github.com/users/WaffleLapkin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/WaffleLapkin/subscriptions", "organizations_url": "https://api.github.com/users/WaffleLapkin/orgs", "repos_url": "https://api.github.com/users/WaffleLapkin/repos", "events_url": "https://api.github.com/users/WaffleLapkin/events{/privacy}", "received_events_url": "https://api.github.com/users/WaffleLapkin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6197e4d209d2604bdf338bcc6c597af929fca436", "url": "https://api.github.com/repos/rust-lang/rust/commits/6197e4d209d2604bdf338bcc6c597af929fca436", "html_url": "https://github.com/rust-lang/rust/commit/6197e4d209d2604bdf338bcc6c597af929fca436"}], "stats": {"total": 214, "additions": 104, "deletions": 110}, "files": [{"sha": "5aa6aa3eca6ae4377fd950713aca8619f9b6bb76", "filename": "compiler/rustc_resolve/src/ident.rs", "status": "modified", "additions": 28, "deletions": 28, "changes": 56, "blob_url": "https://github.com/rust-lang/rust/blob/0fa59204e5b70bcf473a4ca56ac8ceea362d7dff/compiler%2Frustc_resolve%2Fsrc%2Fident.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0fa59204e5b70bcf473a4ca56ac8ceea362d7dff/compiler%2Frustc_resolve%2Fsrc%2Fident.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_resolve%2Fsrc%2Fident.rs?ref=0fa59204e5b70bcf473a4ca56ac8ceea362d7dff", "patch": "@@ -323,7 +323,7 @@ impl<'a, 'tcx> Resolver<'a, 'tcx> {\n             }\n \n             module = match ribs[i].kind {\n-                RibKind::ModuleRibKind(module) => module,\n+                RibKind::Module(module) => module,\n                 RibKind::MacroDefinition(def) if def == self.macro_def(ident.span.ctxt()) => {\n                     // If an invocation of this macro created `ident`, give up on `ident`\n                     // and switch to `ident`'s source from the macro definition.\n@@ -1083,7 +1083,7 @@ impl<'a, 'tcx> Resolver<'a, 'tcx> {\n         let ribs = &all_ribs[rib_index + 1..];\n \n         // An invalid forward use of a generic parameter from a previous default.\n-        if let RibKind::ForwardGenericParamBanRibKind = all_ribs[rib_index].kind {\n+        if let RibKind::ForwardGenericParamBan = all_ribs[rib_index].kind {\n             if let Some(span) = finalize {\n                 let res_error = if rib_ident.name == kw::SelfUpper {\n                     ResolutionError::SelfInGenericParamDefault\n@@ -1103,14 +1103,14 @@ impl<'a, 'tcx> Resolver<'a, 'tcx> {\n \n                 for rib in ribs {\n                     match rib.kind {\n-                        RibKind::NormalRibKind\n-                        | RibKind::ClosureOrAsyncRibKind\n-                        | RibKind::ModuleRibKind(..)\n+                        RibKind::Normal\n+                        | RibKind::ClosureOrAsync\n+                        | RibKind::Module(..)\n                         | RibKind::MacroDefinition(..)\n-                        | RibKind::ForwardGenericParamBanRibKind => {\n+                        | RibKind::ForwardGenericParamBan => {\n                             // Nothing to do. Continue.\n                         }\n-                        RibKind::ItemRibKind(_) | RibKind::AssocItemRibKind => {\n+                        RibKind::Item(_) | RibKind::AssocItem => {\n                             // This was an attempt to access an upvar inside a\n                             // named function item. This is not allowed, so we\n                             // report an error.\n@@ -1122,7 +1122,7 @@ impl<'a, 'tcx> Resolver<'a, 'tcx> {\n                                 res_err = Some((span, CannotCaptureDynamicEnvironmentInFnItem));\n                             }\n                         }\n-                        RibKind::ConstantItemRibKind(_, item) => {\n+                        RibKind::ConstantItem(_, item) => {\n                             // Still doesn't deal with upvars\n                             if let Some(span) = finalize {\n                                 let (span, resolution_error) =\n@@ -1151,13 +1151,13 @@ impl<'a, 'tcx> Resolver<'a, 'tcx> {\n                             }\n                             return Res::Err;\n                         }\n-                        RibKind::ConstParamTyRibKind => {\n+                        RibKind::ConstParamTy => {\n                             if let Some(span) = finalize {\n                                 self.report_error(span, ParamInTyOfConstParam(rib_ident.name));\n                             }\n                             return Res::Err;\n                         }\n-                        RibKind::InlineAsmSymRibKind => {\n+                        RibKind::InlineAsmSym => {\n                             if let Some(span) = finalize {\n                                 self.report_error(span, InvalidAsmSym);\n                             }\n@@ -1173,18 +1173,18 @@ impl<'a, 'tcx> Resolver<'a, 'tcx> {\n             Res::Def(DefKind::TyParam, _) | Res::SelfTyParam { .. } | Res::SelfTyAlias { .. } => {\n                 for rib in ribs {\n                     let has_generic_params: HasGenericParams = match rib.kind {\n-                        RibKind::NormalRibKind\n-                        | RibKind::ClosureOrAsyncRibKind\n-                        | RibKind::ModuleRibKind(..)\n+                        RibKind::Normal\n+                        | RibKind::ClosureOrAsync\n+                        | RibKind::Module(..)\n                         | RibKind::MacroDefinition(..)\n-                        | RibKind::InlineAsmSymRibKind\n-                        | RibKind::AssocItemRibKind\n-                        | RibKind::ForwardGenericParamBanRibKind => {\n+                        | RibKind::InlineAsmSym\n+                        | RibKind::AssocItem\n+                        | RibKind::ForwardGenericParamBan => {\n                             // Nothing to do. Continue.\n                             continue;\n                         }\n \n-                        RibKind::ConstantItemRibKind(trivial, _) => {\n+                        RibKind::ConstantItem(trivial, _) => {\n                             let features = self.tcx.sess.features_untracked();\n                             // HACK(min_const_generics): We currently only allow `N` or `{ N }`.\n                             if !(trivial == ConstantHasGenerics::Yes\n@@ -1225,8 +1225,8 @@ impl<'a, 'tcx> Resolver<'a, 'tcx> {\n                         }\n \n                         // This was an attempt to use a type parameter outside its scope.\n-                        RibKind::ItemRibKind(has_generic_params) => has_generic_params,\n-                        RibKind::ConstParamTyRibKind => {\n+                        RibKind::Item(has_generic_params) => has_generic_params,\n+                        RibKind::ConstParamTy => {\n                             if let Some(span) = finalize {\n                                 self.report_error(\n                                     span,\n@@ -1252,15 +1252,15 @@ impl<'a, 'tcx> Resolver<'a, 'tcx> {\n             Res::Def(DefKind::ConstParam, _) => {\n                 for rib in ribs {\n                     let has_generic_params = match rib.kind {\n-                        RibKind::NormalRibKind\n-                        | RibKind::ClosureOrAsyncRibKind\n-                        | RibKind::ModuleRibKind(..)\n+                        RibKind::Normal\n+                        | RibKind::ClosureOrAsync\n+                        | RibKind::Module(..)\n                         | RibKind::MacroDefinition(..)\n-                        | RibKind::InlineAsmSymRibKind\n-                        | RibKind::AssocItemRibKind\n-                        | RibKind::ForwardGenericParamBanRibKind => continue,\n+                        | RibKind::InlineAsmSym\n+                        | RibKind::AssocItem\n+                        | RibKind::ForwardGenericParamBan => continue,\n \n-                        RibKind::ConstantItemRibKind(trivial, _) => {\n+                        RibKind::ConstantItem(trivial, _) => {\n                             let features = self.tcx.sess.features_untracked();\n                             // HACK(min_const_generics): We currently only allow `N` or `{ N }`.\n                             if !(trivial == ConstantHasGenerics::Yes\n@@ -1283,8 +1283,8 @@ impl<'a, 'tcx> Resolver<'a, 'tcx> {\n                             continue;\n                         }\n \n-                        RibKind::ItemRibKind(has_generic_params) => has_generic_params,\n-                        RibKind::ConstParamTyRibKind => {\n+                        RibKind::Item(has_generic_params) => has_generic_params,\n+                        RibKind::ConstParamTy => {\n                             if let Some(span) = finalize {\n                                 self.report_error(\n                                     span,"}, {"sha": "0a4d3faba3f982510b432b50a5fbad0d2b2be6bd", "filename": "compiler/rustc_resolve/src/late.rs", "status": "modified", "additions": 74, "deletions": 80, "changes": 154, "blob_url": "https://github.com/rust-lang/rust/blob/0fa59204e5b70bcf473a4ca56ac8ceea362d7dff/compiler%2Frustc_resolve%2Fsrc%2Flate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0fa59204e5b70bcf473a4ca56ac8ceea362d7dff/compiler%2Frustc_resolve%2Fsrc%2Flate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_resolve%2Fsrc%2Flate.rs?ref=0fa59204e5b70bcf473a4ca56ac8ceea362d7dff", "patch": "@@ -131,77 +131,75 @@ enum RecordPartialRes {\n #[derive(Copy, Clone, Debug)]\n pub(crate) enum RibKind<'a> {\n     /// No restriction needs to be applied.\n-    NormalRibKind,\n+    Normal,\n \n     /// We passed through an impl or trait and are now in one of its\n     /// methods or associated types. Allow references to ty params that impl or trait\n     /// binds. Disallow any other upvars (including other ty params that are\n     /// upvars).\n-    AssocItemRibKind,\n+    AssocItem,\n \n     /// We passed through a closure. Disallow labels.\n-    ClosureOrAsyncRibKind,\n+    ClosureOrAsync,\n \n     /// We passed through an item scope. Disallow upvars.\n-    ItemRibKind(HasGenericParams),\n+    Item(HasGenericParams),\n \n     /// We're in a constant item. Can't refer to dynamic stuff.\n     ///\n     /// The item may reference generic parameters in trivial constant expressions.\n     /// All other constants aren't allowed to use generic params at all.\n-    ConstantItemRibKind(ConstantHasGenerics, Option<(Ident, ConstantItemKind)>),\n+    ConstantItem(ConstantHasGenerics, Option<(Ident, ConstantItemKind)>),\n \n     /// We passed through a module.\n-    ModuleRibKind(Module<'a>),\n+    Module(Module<'a>),\n \n     /// We passed through a `macro_rules!` statement\n     MacroDefinition(DefId),\n \n     /// All bindings in this rib are generic parameters that can't be used\n     /// from the default of a generic parameter because they're not declared\n     /// before said generic parameter. Also see the `visit_generics` override.\n-    ForwardGenericParamBanRibKind,\n+    ForwardGenericParamBan,\n \n     /// We are inside of the type of a const parameter. Can't refer to any\n     /// parameters.\n-    ConstParamTyRibKind,\n+    ConstParamTy,\n \n     /// We are inside a `sym` inline assembly operand. Can only refer to\n     /// globals.\n-    InlineAsmSymRibKind,\n+    InlineAsmSym,\n }\n \n impl RibKind<'_> {\n     /// Whether this rib kind contains generic parameters, as opposed to local\n     /// variables.\n     pub(crate) fn contains_params(&self) -> bool {\n         match self {\n-            RibKind::NormalRibKind\n-            | RibKind::ClosureOrAsyncRibKind\n-            | RibKind::ConstantItemRibKind(..)\n-            | RibKind::ModuleRibKind(_)\n+            RibKind::Normal\n+            | RibKind::ClosureOrAsync\n+            | RibKind::ConstantItem(..)\n+            | RibKind::Module(_)\n             | RibKind::MacroDefinition(_)\n-            | RibKind::ConstParamTyRibKind\n-            | RibKind::InlineAsmSymRibKind => false,\n-            RibKind::AssocItemRibKind\n-            | RibKind::ItemRibKind(_)\n-            | RibKind::ForwardGenericParamBanRibKind => true,\n+            | RibKind::ConstParamTy\n+            | RibKind::InlineAsmSym => false,\n+            RibKind::AssocItem | RibKind::Item(_) | RibKind::ForwardGenericParamBan => true,\n         }\n     }\n \n     /// This rib forbids referring to labels defined in upwards ribs.\n     fn is_label_barrier(self) -> bool {\n         match self {\n-            RibKind::NormalRibKind | RibKind::MacroDefinition(..) => false,\n-\n-            RibKind::AssocItemRibKind\n-            | RibKind::ClosureOrAsyncRibKind\n-            | RibKind::ItemRibKind(..)\n-            | RibKind::ConstantItemRibKind(..)\n-            | RibKind::ModuleRibKind(..)\n-            | RibKind::ForwardGenericParamBanRibKind\n-            | RibKind::ConstParamTyRibKind\n-            | RibKind::InlineAsmSymRibKind => true,\n+            RibKind::Normal | RibKind::MacroDefinition(..) => false,\n+\n+            RibKind::AssocItem\n+            | RibKind::ClosureOrAsync\n+            | RibKind::Item(..)\n+            | RibKind::ConstantItem(..)\n+            | RibKind::Module(..)\n+            | RibKind::ForwardGenericParamBan\n+            | RibKind::ConstParamTy\n+            | RibKind::InlineAsmSym => true,\n         }\n     }\n }\n@@ -705,7 +703,7 @@ impl<'a: 'ast, 'ast, 'tcx> Visitor<'ast> for LateResolutionVisitor<'a, '_, 'ast,\n                     let span = ty.span.shrink_to_lo().to(path.span.shrink_to_lo());\n                     self.with_generic_param_rib(\n                         &[],\n-                        RibKind::NormalRibKind,\n+                        RibKind::Normal,\n                         LifetimeRibKind::Generics {\n                             binder: ty.id,\n                             kind: LifetimeBinderKind::PolyTrait,\n@@ -743,7 +741,7 @@ impl<'a: 'ast, 'ast, 'tcx> Visitor<'ast> for LateResolutionVisitor<'a, '_, 'ast,\n                 let span = ty.span.shrink_to_lo().to(bare_fn.decl_span.shrink_to_lo());\n                 self.with_generic_param_rib(\n                     &bare_fn.generic_params,\n-                    RibKind::NormalRibKind,\n+                    RibKind::Normal,\n                     LifetimeRibKind::Generics {\n                         binder: ty.id,\n                         kind: LifetimeBinderKind::BareFnType,\n@@ -783,7 +781,7 @@ impl<'a: 'ast, 'ast, 'tcx> Visitor<'ast> for LateResolutionVisitor<'a, '_, 'ast,\n         let span = tref.span.shrink_to_lo().to(tref.trait_ref.path.span.shrink_to_lo());\n         self.with_generic_param_rib(\n             &tref.bound_generic_params,\n-            RibKind::NormalRibKind,\n+            RibKind::Normal,\n             LifetimeRibKind::Generics {\n                 binder: tref.trait_ref.ref_id,\n                 kind: LifetimeBinderKind::PolyTrait,\n@@ -807,7 +805,7 @@ impl<'a: 'ast, 'ast, 'tcx> Visitor<'ast> for LateResolutionVisitor<'a, '_, 'ast,\n             ForeignItemKind::TyAlias(box TyAlias { ref generics, .. }) => {\n                 self.with_generic_param_rib(\n                     &generics.params,\n-                    RibKind::ItemRibKind(HasGenericParams::Yes(generics.span)),\n+                    RibKind::Item(HasGenericParams::Yes(generics.span)),\n                     LifetimeRibKind::Generics {\n                         binder: foreign_item.id,\n                         kind: LifetimeBinderKind::Item,\n@@ -819,7 +817,7 @@ impl<'a: 'ast, 'ast, 'tcx> Visitor<'ast> for LateResolutionVisitor<'a, '_, 'ast,\n             ForeignItemKind::Fn(box Fn { ref generics, .. }) => {\n                 self.with_generic_param_rib(\n                     &generics.params,\n-                    RibKind::ItemRibKind(HasGenericParams::Yes(generics.span)),\n+                    RibKind::Item(HasGenericParams::Yes(generics.span)),\n                     LifetimeRibKind::Generics {\n                         binder: foreign_item.id,\n                         kind: LifetimeBinderKind::Function,\n@@ -873,9 +871,9 @@ impl<'a: 'ast, 'ast, 'tcx> Visitor<'ast> for LateResolutionVisitor<'a, '_, 'ast,\n         debug!(\"(resolving function) entering function\");\n \n         // Create a value rib for the function.\n-        self.with_rib(ValueNS, RibKind::ClosureOrAsyncRibKind, |this| {\n+        self.with_rib(ValueNS, RibKind::ClosureOrAsync, |this| {\n             // Create a label rib for the function.\n-            this.with_label_rib(RibKind::ClosureOrAsyncRibKind, |this| {\n+            this.with_label_rib(RibKind::ClosureOrAsync, |this| {\n                 match fn_kind {\n                     FnKind::Fn(_, _, sig, _, generics, body) => {\n                         this.visit_generics(generics);\n@@ -1132,7 +1130,7 @@ impl<'a: 'ast, 'ast, 'tcx> Visitor<'ast> for LateResolutionVisitor<'a, '_, 'ast,\n                 let span = predicate_span.shrink_to_lo().to(bounded_ty.span.shrink_to_lo());\n                 this.with_generic_param_rib(\n                     &bound_generic_params,\n-                    RibKind::NormalRibKind,\n+                    RibKind::Normal,\n                     LifetimeRibKind::Generics {\n                         binder: bounded_ty.id,\n                         kind: LifetimeBinderKind::WhereBound,\n@@ -1178,9 +1176,9 @@ impl<'a: 'ast, 'ast, 'tcx> Visitor<'ast> for LateResolutionVisitor<'a, '_, 'ast,\n \n     fn visit_inline_asm_sym(&mut self, sym: &'ast InlineAsmSym) {\n         // This is similar to the code for AnonConst.\n-        self.with_rib(ValueNS, RibKind::InlineAsmSymRibKind, |this| {\n-            this.with_rib(TypeNS, RibKind::InlineAsmSymRibKind, |this| {\n-                this.with_label_rib(RibKind::InlineAsmSymRibKind, |this| {\n+        self.with_rib(ValueNS, RibKind::InlineAsmSym, |this| {\n+            this.with_rib(TypeNS, RibKind::InlineAsmSym, |this| {\n+                this.with_label_rib(RibKind::InlineAsmSym, |this| {\n                     this.smart_resolve_path(sym.id, &sym.qself, &sym.path, PathSource::Expr(None));\n                     visit::walk_inline_asm_sym(this, sym);\n                 });\n@@ -1205,7 +1203,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n         // although it may be useful to track other components as well for diagnostics.\n         let graph_root = resolver.graph_root;\n         let parent_scope = ParentScope::module(graph_root, resolver);\n-        let start_rib_kind = RibKind::ModuleRibKind(graph_root);\n+        let start_rib_kind = RibKind::Module(graph_root);\n         LateResolutionVisitor {\n             r: resolver,\n             parent_scope,\n@@ -1309,8 +1307,8 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n         if let Some(module) = self.r.get_module(self.r.local_def_id(id).to_def_id()) {\n             // Move down in the graph.\n             let orig_module = replace(&mut self.parent_scope.module, module);\n-            self.with_rib(ValueNS, RibKind::ModuleRibKind(module), |this| {\n-                this.with_rib(TypeNS, RibKind::ModuleRibKind(module), |this| {\n+            self.with_rib(ValueNS, RibKind::Module(module), |this| {\n+                this.with_rib(TypeNS, RibKind::Module(module), |this| {\n                     let ret = f(this);\n                     this.parent_scope.module = orig_module;\n                     ret\n@@ -1327,8 +1325,8 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n         // provide previous type parameters as they're built. We\n         // put all the parameters on the ban list and then remove\n         // them one by one as they are processed and become available.\n-        let mut forward_ty_ban_rib = Rib::new(RibKind::ForwardGenericParamBanRibKind);\n-        let mut forward_const_ban_rib = Rib::new(RibKind::ForwardGenericParamBanRibKind);\n+        let mut forward_ty_ban_rib = Rib::new(RibKind::ForwardGenericParamBan);\n+        let mut forward_const_ban_rib = Rib::new(RibKind::ForwardGenericParamBan);\n         for param in params.iter() {\n             match param.kind {\n                 GenericParamKind::Type { .. } => {\n@@ -1389,8 +1387,8 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n                         // Const parameters can't have param bounds.\n                         assert!(param.bounds.is_empty());\n \n-                        this.ribs[TypeNS].push(Rib::new(RibKind::ConstParamTyRibKind));\n-                        this.ribs[ValueNS].push(Rib::new(RibKind::ConstParamTyRibKind));\n+                        this.ribs[TypeNS].push(Rib::new(RibKind::ConstParamTy));\n+                        this.ribs[ValueNS].push(Rib::new(RibKind::ConstParamTy));\n                         this.with_lifetime_rib(LifetimeRibKind::ConstGeneric, |this| {\n                             this.visit_ty(ty)\n                         });\n@@ -2160,7 +2158,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n         self.with_current_self_item(item, |this| {\n             this.with_generic_param_rib(\n                 &generics.params,\n-                RibKind::ItemRibKind(HasGenericParams::Yes(generics.span)),\n+                RibKind::Item(HasGenericParams::Yes(generics.span)),\n                 LifetimeRibKind::Generics {\n                     binder: item.id,\n                     kind: LifetimeBinderKind::Item,\n@@ -2241,7 +2239,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n             ItemKind::TyAlias(box TyAlias { ref generics, .. }) => {\n                 self.with_generic_param_rib(\n                     &generics.params,\n-                    RibKind::ItemRibKind(HasGenericParams::Yes(generics.span)),\n+                    RibKind::Item(HasGenericParams::Yes(generics.span)),\n                     LifetimeRibKind::Generics {\n                         binder: item.id,\n                         kind: LifetimeBinderKind::Item,\n@@ -2254,7 +2252,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n             ItemKind::Fn(box Fn { ref generics, .. }) => {\n                 self.with_generic_param_rib(\n                     &generics.params,\n-                    RibKind::ItemRibKind(HasGenericParams::Yes(generics.span)),\n+                    RibKind::Item(HasGenericParams::Yes(generics.span)),\n                     LifetimeRibKind::Generics {\n                         binder: item.id,\n                         kind: LifetimeBinderKind::Function,\n@@ -2293,7 +2291,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n                 // Create a new rib for the trait-wide type parameters.\n                 self.with_generic_param_rib(\n                     &generics.params,\n-                    RibKind::ItemRibKind(HasGenericParams::Yes(generics.span)),\n+                    RibKind::Item(HasGenericParams::Yes(generics.span)),\n                     LifetimeRibKind::Generics {\n                         binder: item.id,\n                         kind: LifetimeBinderKind::Item,\n@@ -2314,7 +2312,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n                 // Create a new rib for the trait-wide type parameters.\n                 self.with_generic_param_rib(\n                     &generics.params,\n-                    RibKind::ItemRibKind(HasGenericParams::Yes(generics.span)),\n+                    RibKind::Item(HasGenericParams::Yes(generics.span)),\n                     LifetimeRibKind::Generics {\n                         binder: item.id,\n                         kind: LifetimeBinderKind::Item,\n@@ -2417,11 +2415,11 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n         let mut seen_lifetimes = FxHashSet::default();\n \n         // We also can't shadow bindings from the parent item\n-        if let RibKind::AssocItemRibKind = kind {\n+        if let RibKind::AssocItem = kind {\n             let mut add_bindings_for_ns = |ns| {\n                 let parent_rib = self.ribs[ns]\n                     .iter()\n-                    .rfind(|r| matches!(r.kind, RibKind::ItemRibKind(_)))\n+                    .rfind(|r| matches!(r.kind, RibKind::Item(_)))\n                     .expect(\"associated item outside of an item\");\n                 seen_bindings.extend(parent_rib.bindings.keys().map(|ident| (*ident, ident.span)));\n             };\n@@ -2510,10 +2508,8 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n             };\n \n             let res = match kind {\n-                RibKind::ItemRibKind(..) | RibKind::AssocItemRibKind => {\n-                    Res::Def(def_kind, def_id.to_def_id())\n-                }\n-                RibKind::NormalRibKind => {\n+                RibKind::Item(..) | RibKind::AssocItem => Res::Def(def_kind, def_id.to_def_id()),\n+                RibKind::Normal => {\n                     if self.r.tcx.sess.features_untracked().non_lifetime_binders {\n                         Res::Def(def_kind, def_id.to_def_id())\n                     } else {\n@@ -2559,7 +2555,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n     }\n \n     fn with_static_rib(&mut self, f: impl FnOnce(&mut Self)) {\n-        let kind = RibKind::ItemRibKind(HasGenericParams::No);\n+        let kind = RibKind::Item(HasGenericParams::No);\n         self.with_rib(ValueNS, kind, |this| this.with_rib(TypeNS, kind, f))\n     }\n \n@@ -2579,15 +2575,15 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n         item: Option<(Ident, ConstantItemKind)>,\n         f: impl FnOnce(&mut Self),\n     ) {\n-        self.with_rib(ValueNS, RibKind::ConstantItemRibKind(may_use_generics, item), |this| {\n+        self.with_rib(ValueNS, RibKind::ConstantItem(may_use_generics, item), |this| {\n             this.with_rib(\n                 TypeNS,\n-                RibKind::ConstantItemRibKind(\n+                RibKind::ConstantItem(\n                     may_use_generics.force_yes_if(is_repeat == IsRepeatExpr::Yes),\n                     item,\n                 ),\n                 |this| {\n-                    this.with_label_rib(RibKind::ConstantItemRibKind(may_use_generics, item), f);\n+                    this.with_label_rib(RibKind::ConstantItem(may_use_generics, item), f);\n                 },\n             )\n         });\n@@ -2619,7 +2615,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n             |this: &mut Self, generics: &Generics, kind, item: &'ast AssocItem| {\n                 this.with_generic_param_rib(\n                     &generics.params,\n-                    RibKind::AssocItemRibKind,\n+                    RibKind::AssocItem,\n                     LifetimeRibKind::Generics { binder: item.id, span: generics.span, kind },\n                     |this| visit::walk_assoc_item(this, item, AssocCtxt::Trait),\n                 );\n@@ -2700,7 +2696,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n     }\n \n     fn with_self_rib_ns(&mut self, ns: Namespace, self_res: Res, f: impl FnOnce(&mut Self)) {\n-        let mut self_type_rib = Rib::new(RibKind::NormalRibKind);\n+        let mut self_type_rib = Rib::new(RibKind::Normal);\n \n         // Plain insert (no renaming, since types are not currently hygienic)\n         self_type_rib.bindings.insert(Ident::with_dummy_span(kw::SelfUpper), self_res);\n@@ -2726,7 +2722,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n         // If applicable, create a rib for the type parameters.\n         self.with_generic_param_rib(\n             &generics.params,\n-            RibKind::ItemRibKind(HasGenericParams::Yes(generics.span)),\n+            RibKind::Item(HasGenericParams::Yes(generics.span)),\n             LifetimeRibKind::Generics {\n                 span: generics.span,\n                 binder: item_id,\n@@ -2840,7 +2836,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n                 // We also need a new scope for the impl item type parameters.\n                 self.with_generic_param_rib(\n                     &generics.params,\n-                    RibKind::AssocItemRibKind,\n+                    RibKind::AssocItem,\n                     LifetimeRibKind::Generics {\n                         binder: item.id,\n                         span: generics.span,\n@@ -2868,7 +2864,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n                 // We also need a new scope for the impl item type parameters.\n                 self.with_generic_param_rib(\n                     &generics.params,\n-                    RibKind::AssocItemRibKind,\n+                    RibKind::AssocItem,\n                     LifetimeRibKind::Generics {\n                         binder: item.id,\n                         span: generics.span,\n@@ -3140,7 +3136,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n     }\n \n     fn resolve_arm(&mut self, arm: &'ast Arm) {\n-        self.with_rib(ValueNS, RibKind::NormalRibKind, |this| {\n+        self.with_rib(ValueNS, RibKind::Normal, |this| {\n             this.resolve_pattern_top(&arm.pat, PatternSource::Match);\n             walk_list!(this, visit_expr, &arm.guard);\n             this.visit_expr(&arm.body);\n@@ -3862,7 +3858,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n                 diagnostics::signal_label_shadowing(self.r.tcx.sess, orig_span, label.ident)\n             }\n \n-            self.with_label_rib(RibKind::NormalRibKind, |this| {\n+            self.with_label_rib(RibKind::Normal, |this| {\n                 let ident = label.ident.normalize_to_macro_rules();\n                 this.label_ribs.last_mut().unwrap().bindings.insert(ident, id);\n                 f(this);\n@@ -3885,11 +3881,11 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n         let mut num_macro_definition_ribs = 0;\n         if let Some(anonymous_module) = anonymous_module {\n             debug!(\"(resolving block) found anonymous module, moving down\");\n-            self.ribs[ValueNS].push(Rib::new(RibKind::ModuleRibKind(anonymous_module)));\n-            self.ribs[TypeNS].push(Rib::new(RibKind::ModuleRibKind(anonymous_module)));\n+            self.ribs[ValueNS].push(Rib::new(RibKind::Module(anonymous_module)));\n+            self.ribs[TypeNS].push(Rib::new(RibKind::Module(anonymous_module)));\n             self.parent_scope.module = anonymous_module;\n         } else {\n-            self.ribs[ValueNS].push(Rib::new(RibKind::NormalRibKind));\n+            self.ribs[ValueNS].push(Rib::new(RibKind::Normal));\n         }\n \n         let prev = self.diagnostic_metadata.current_block_could_be_bare_struct_literal.take();\n@@ -3994,7 +3990,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n             }\n \n             ExprKind::If(ref cond, ref then, ref opt_else) => {\n-                self.with_rib(ValueNS, RibKind::NormalRibKind, |this| {\n+                self.with_rib(ValueNS, RibKind::Normal, |this| {\n                     let old = this.diagnostic_metadata.in_if_condition.replace(cond);\n                     this.visit_expr(cond);\n                     this.diagnostic_metadata.in_if_condition = old;\n@@ -4011,7 +4007,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n \n             ExprKind::While(ref cond, ref block, label) => {\n                 self.with_resolved_label(label, expr.id, |this| {\n-                    this.with_rib(ValueNS, RibKind::NormalRibKind, |this| {\n+                    this.with_rib(ValueNS, RibKind::Normal, |this| {\n                         let old = this.diagnostic_metadata.in_if_condition.replace(cond);\n                         this.visit_expr(cond);\n                         this.diagnostic_metadata.in_if_condition = old;\n@@ -4022,7 +4018,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n \n             ExprKind::ForLoop(ref pat, ref iter_expr, ref block, label) => {\n                 self.visit_expr(iter_expr);\n-                self.with_rib(ValueNS, RibKind::NormalRibKind, |this| {\n+                self.with_rib(ValueNS, RibKind::Normal, |this| {\n                     this.resolve_pattern_top(pat, PatternSource::For);\n                     this.resolve_labeled_block(label, expr.id, block);\n                 });\n@@ -4087,8 +4083,8 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n                 ref body,\n                 ..\n             }) => {\n-                self.with_rib(ValueNS, RibKind::NormalRibKind, |this| {\n-                    this.with_label_rib(RibKind::ClosureOrAsyncRibKind, |this| {\n+                self.with_rib(ValueNS, RibKind::Normal, |this| {\n+                    this.with_label_rib(RibKind::ClosureOrAsync, |this| {\n                         // Resolve arguments:\n                         this.resolve_params(&fn_decl.inputs);\n                         // No need to resolve return type --\n@@ -4112,7 +4108,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n             }) => {\n                 self.with_generic_param_rib(\n                     &generic_params,\n-                    RibKind::NormalRibKind,\n+                    RibKind::Normal,\n                     LifetimeRibKind::Generics {\n                         binder: expr.id,\n                         kind: LifetimeBinderKind::Closure,\n@@ -4123,9 +4119,7 @@ impl<'a: 'ast, 'b, 'ast, 'tcx> LateResolutionVisitor<'a, 'b, 'ast, 'tcx> {\n             }\n             ExprKind::Closure(..) => visit::walk_expr(self, expr),\n             ExprKind::Async(..) => {\n-                self.with_label_rib(RibKind::ClosureOrAsyncRibKind, |this| {\n-                    visit::walk_expr(this, expr)\n-                });\n+                self.with_label_rib(RibKind::ClosureOrAsync, |this| visit::walk_expr(this, expr));\n             }\n             ExprKind::Repeat(ref elem, ref ct) => {\n                 self.visit_expr(elem);"}, {"sha": "a9858b365ff2ebd2930f4b9fd8260fea7915fa3d", "filename": "compiler/rustc_resolve/src/late/diagnostics.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/0fa59204e5b70bcf473a4ca56ac8ceea362d7dff/compiler%2Frustc_resolve%2Fsrc%2Flate%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0fa59204e5b70bcf473a4ca56ac8ceea362d7dff/compiler%2Frustc_resolve%2Fsrc%2Flate%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_resolve%2Fsrc%2Flate%2Fdiagnostics.rs?ref=0fa59204e5b70bcf473a4ca56ac8ceea362d7dff", "patch": "@@ -623,7 +623,7 @@ impl<'a: 'ast, 'ast, 'tcx> LateResolutionVisitor<'a, '_, 'ast, 'tcx> {\n         }\n \n         // Try to find in last block rib\n-        if let Some(rib) = &self.last_block_rib && let RibKind::NormalRibKind = rib.kind {\n+        if let Some(rib) = &self.last_block_rib && let RibKind::Normal = rib.kind {\n             for (ident, &res) in &rib.bindings {\n                 if let Res::Local(_) = res && path.len() == 1 &&\n                     ident.span.eq_ctxt(path[0].ident.span) &&\n@@ -1728,7 +1728,7 @@ impl<'a: 'ast, 'ast, 'tcx> LateResolutionVisitor<'a, '_, 'ast, 'tcx> {\n                 }\n \n                 // Items in scope\n-                if let RibKind::ModuleRibKind(module) = rib.kind {\n+                if let RibKind::Module(module) = rib.kind {\n                     // Items from this module\n                     self.r.add_module_candidates(module, &mut names, &filter_fn, Some(ctxt));\n "}]}