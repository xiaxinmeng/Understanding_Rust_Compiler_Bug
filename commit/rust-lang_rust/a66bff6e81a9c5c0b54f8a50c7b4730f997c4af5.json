{"sha": "a66bff6e81a9c5c0b54f8a50c7b4730f997c4af5", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE2NmJmZjZlODFhOWM1YzBiNTRmOGE1MGM3YjQ3MzBmOTk3YzRhZjU=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-01-25T02:08:48Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-01-25T02:08:48Z"}, "message": "rustdoc: Don't prune functions with documented failure conditions", "tree": {"sha": "da42d561189bbaa4b2c211dc5c72f1e8886487d8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/da42d561189bbaa4b2c211dc5c72f1e8886487d8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a66bff6e81a9c5c0b54f8a50c7b4730f997c4af5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a66bff6e81a9c5c0b54f8a50c7b4730f997c4af5", "html_url": "https://github.com/rust-lang/rust/commit/a66bff6e81a9c5c0b54f8a50c7b4730f997c4af5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a66bff6e81a9c5c0b54f8a50c7b4730f997c4af5/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "efc067952dc907f3f9646d4effc1f3891e582557", "url": "https://api.github.com/repos/rust-lang/rust/commits/efc067952dc907f3f9646d4effc1f3891e582557", "html_url": "https://github.com/rust-lang/rust/commit/efc067952dc907f3f9646d4effc1f3891e582557"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "4256d08c30a355625e4e0f78807839886b78daed", "filename": "src/rustdoc/prune_undoc_pass.rs", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/a66bff6e81a9c5c0b54f8a50c7b4730f997c4af5/src%2Frustdoc%2Fprune_undoc_pass.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a66bff6e81a9c5c0b54f8a50c7b4730f997c4af5/src%2Frustdoc%2Fprune_undoc_pass.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Fprune_undoc_pass.rs?ref=a66bff6e81a9c5c0b54f8a50c7b4730f997c4af5", "patch": "@@ -71,7 +71,8 @@ fn fold_fn(\n         doc.brief != none\n         || doc.desc != none\n         || have_arg_docs\n-        || doc.return.desc != none;\n+        || doc.return.desc != none\n+        || doc.failure != none;\n     ret doc;\n }\n \n@@ -106,6 +107,16 @@ fn should_elide_undocumented_return_values() {\n     assert doc.topmod.fns[0].return.ty == none;\n }\n \n+#[test]\n+fn should_not_elide_fns_with_documented_failure_conditions() {\n+    let source = \"#[doc(failure = \\\"yup\\\")] fn a() { }\";\n+    let srv = astsrv::mk_srv_from_str(source);\n+    let doc = extract::from_srv(srv, \"\");\n+    let doc = attr_pass::mk_pass()(srv, doc);\n+    let doc = run(srv, doc);\n+    assert vec::is_not_empty(*doc.topmod.fns);\n+}\n+\n fn fold_modlist(\n     fold: fold::fold<ctxt>,\n     list: doc::modlist"}]}