{"sha": "6fc33163dcbd3dba8405ab5a9977e22479e81d76", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZmYzMzMTYzZGNiZDNkYmE4NDA1YWI1YTk5NzdlMjI0NzllODFkNzY=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-07-22T06:54:48Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-07-22T17:18:28Z"}, "message": "Change the CFG_STDLIB_DEFAULT macro into a call that picks the correct stage\n\nstageN/rustc depends on either stageN/libstd.so or stage(N-1)/lib/libstd.rlib\nso CFG_STDLIB_DEFAULT needs to try harder to get the dependencies right.", "tree": {"sha": "d44f92768bbb2157030bf88f8bc321d03e51369c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d44f92768bbb2157030bf88f8bc321d03e51369c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6fc33163dcbd3dba8405ab5a9977e22479e81d76", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6fc33163dcbd3dba8405ab5a9977e22479e81d76", "html_url": "https://github.com/rust-lang/rust/commit/6fc33163dcbd3dba8405ab5a9977e22479e81d76", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6fc33163dcbd3dba8405ab5a9977e22479e81d76/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e891e0b9924f5c5a4d417b6741d1001bc4f71ec5", "url": "https://api.github.com/repos/rust-lang/rust/commits/e891e0b9924f5c5a4d417b6741d1001bc4f71ec5", "html_url": "https://github.com/rust-lang/rust/commit/e891e0b9924f5c5a4d417b6741d1001bc4f71ec5"}], "stats": {"total": 16, "additions": 8, "deletions": 8}, "files": [{"sha": "df0ac6c99606c73a514870a4490731fdbdb28c37", "filename": "Makefile.in", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/6fc33163dcbd3dba8405ab5a9977e22479e81d76/Makefile.in", "raw_url": "https://github.com/rust-lang/rust/raw/6fc33163dcbd3dba8405ab5a9977e22479e81d76/Makefile.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Makefile.in?ref=6fc33163dcbd3dba8405ab5a9977e22479e81d76", "patch": "@@ -50,9 +50,9 @@ CFG_STDLIB :=$(call CFG_LIB_NAME,std)\n CFG_LIBRUSTC :=$(call CFG_LIB_NAME,rustc)\n \n ifdef CFG_DISABLE_SHAREDSTD\n-  CFG_STDLIB_DEFAULT := lib/libstd.rlib\n+  CFG_STDLIB_DEFAULT = $(1)/lib/libstd.rlib\n else\n-  CFG_STDLIB_DEFAULT := $(CFG_STDLIB)\n+  CFG_STDLIB_DEFAULT = $(2)/$(CFG_STDLIB)\n endif\n \n # version-string calculation\n@@ -165,7 +165,7 @@ define SREQ\n ifdef CFG_DISABLE_SHAREDSTD\n SREQ$(1) = stage$(1)/rustc$(X)          \\\n            stage$(1)/$$(CFG_RUNTIME)     \\\n-           stage$(1)/$$(CFG_STDLIB_DEFAULT)  \\\n+           $$(call CFG_STDLIB_DEFAULT,stage$(1),stage$(1)) \\\n            stage$(1)/$$(CFG_RUSTLLVM)    \\\n            stage$(1)/lib/glue.o          \\\n            stage$(1)/lib/main.o          \\\n@@ -174,7 +174,7 @@ SREQ$(1) = stage$(1)/rustc$(X)          \\\n else\n SREQ$(1) = stage$(1)/rustc$(X)          \\\n            stage$(1)/$$(CFG_RUNTIME)     \\\n-           stage$(1)/$$(CFG_STDLIB_DEFAULT)  \\\n+           $$(call CFG_STDLIB_DEFAULT,stage$(1),stage$(1)) \\\n            stage$(1)/$$(CFG_RUSTLLVM)    \\\n            stage$(1)/lib/glue.o          \\\n            stage$(1)/lib/main.o          \\"}, {"sha": "171b954d9a72551c95e8b5ad6ad578f5c5630ba1", "filename": "mk/stageN.mk", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/6fc33163dcbd3dba8405ab5a9977e22479e81d76/mk%2FstageN.mk", "raw_url": "https://github.com/rust-lang/rust/raw/6fc33163dcbd3dba8405ab5a9977e22479e81d76/mk%2FstageN.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2FstageN.mk?ref=6fc33163dcbd3dba8405ab5a9977e22479e81d76", "patch": "@@ -50,10 +50,10 @@ stage$(2)/%.o: stage$(2)/%.s\n \t@$$(call E, assemble [gcc]: $$@)\n \t$$(Q)gcc $$(CFG_GCCISH_CFLAGS) -o $$@ -c $$<\n \n-stage$(2)/rustc$$(X): $$(COMPILER_CRATE) $$(COMPILER_INPUTS) \\\n-                      stage$(2)/$$(CFG_RUNTIME)              \\\n-                      stage$(1)/$$(CFG_STDLIB_DEFAULT)       \\\n-                      stage$(2)/$$(CFG_RUSTLLVM)             \\\n+stage$(2)/rustc$$(X): $$(COMPILER_CRATE) $$(COMPILER_INPUTS)          \\\n+                      stage$(2)/$$(CFG_RUNTIME)                       \\\n+                      $$(call CFG_STDLIB_DEFAULT,stage$(1),stage$(2)) \\\n+                      stage$(2)/$$(CFG_RUSTLLVM)                      \\\n                       $$(SREQ$(1))\n \t@$$(call E, compile_and_link: $$@)\n \t$$(STAGE$(1)) -L stage$(2) -o $$@ $$<"}]}