{"sha": "c43937316af1321a97c03a22cd04273eba63d5b9", "node_id": "C_kwDOAAsO6NoAKGM0MzkzNzMxNmFmMTMyMWE5N2MwM2EyMmNkMDQyNzNlYmE2M2Q1Yjk", "commit": {"author": {"name": "Caio", "email": "c410.f3r@gmail.com", "date": "2023-02-12T20:34:07Z"}, "committer": {"name": "Caio", "email": "c410.f3r@gmail.com", "date": "2023-02-12T20:34:07Z"}, "message": "[arithmetic_side_effects] Fix #10252", "tree": {"sha": "169fc3eceff9ff6c8d6f192837b4de61757ec73b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/169fc3eceff9ff6c8d6f192837b4de61757ec73b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c43937316af1321a97c03a22cd04273eba63d5b9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c43937316af1321a97c03a22cd04273eba63d5b9", "html_url": "https://github.com/rust-lang/rust/commit/c43937316af1321a97c03a22cd04273eba63d5b9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c43937316af1321a97c03a22cd04273eba63d5b9/comments", "author": {"login": "c410-f3r", "id": 17877264, "node_id": "MDQ6VXNlcjE3ODc3MjY0", "avatar_url": "https://avatars.githubusercontent.com/u/17877264?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c410-f3r", "html_url": "https://github.com/c410-f3r", "followers_url": "https://api.github.com/users/c410-f3r/followers", "following_url": "https://api.github.com/users/c410-f3r/following{/other_user}", "gists_url": "https://api.github.com/users/c410-f3r/gists{/gist_id}", "starred_url": "https://api.github.com/users/c410-f3r/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c410-f3r/subscriptions", "organizations_url": "https://api.github.com/users/c410-f3r/orgs", "repos_url": "https://api.github.com/users/c410-f3r/repos", "events_url": "https://api.github.com/users/c410-f3r/events{/privacy}", "received_events_url": "https://api.github.com/users/c410-f3r/received_events", "type": "User", "site_admin": false}, "committer": {"login": "c410-f3r", "id": 17877264, "node_id": "MDQ6VXNlcjE3ODc3MjY0", "avatar_url": "https://avatars.githubusercontent.com/u/17877264?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c410-f3r", "html_url": "https://github.com/c410-f3r", "followers_url": "https://api.github.com/users/c410-f3r/followers", "following_url": "https://api.github.com/users/c410-f3r/following{/other_user}", "gists_url": "https://api.github.com/users/c410-f3r/gists{/gist_id}", "starred_url": "https://api.github.com/users/c410-f3r/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c410-f3r/subscriptions", "organizations_url": "https://api.github.com/users/c410-f3r/orgs", "repos_url": "https://api.github.com/users/c410-f3r/repos", "events_url": "https://api.github.com/users/c410-f3r/events{/privacy}", "received_events_url": "https://api.github.com/users/c410-f3r/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6f353fdf0a4ea505dd70c315478e29dce5e873e0", "url": "https://api.github.com/repos/rust-lang/rust/commits/6f353fdf0a4ea505dd70c315478e29dce5e873e0", "html_url": "https://github.com/rust-lang/rust/commit/6f353fdf0a4ea505dd70c315478e29dce5e873e0"}], "stats": {"total": 329, "additions": 206, "deletions": 123}, "files": [{"sha": "25e8de94863708f4e0e2536671e5ee2a271a3eb7", "filename": "clippy_lints/src/operators/arithmetic_side_effects.rs", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/c43937316af1321a97c03a22cd04273eba63d5b9/clippy_lints%2Fsrc%2Foperators%2Farithmetic_side_effects.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c43937316af1321a97c03a22cd04273eba63d5b9/clippy_lints%2Fsrc%2Foperators%2Farithmetic_side_effects.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Foperators%2Farithmetic_side_effects.rs?ref=c43937316af1321a97c03a22cd04273eba63d5b9", "patch": "@@ -143,6 +143,10 @@ impl ArithmeticSideEffects {\n             return;\n         }\n         let has_valid_op = if Self::is_integral(lhs_ty) && Self::is_integral(rhs_ty) {\n+            if let hir::BinOpKind::Shl | hir::BinOpKind::Shr = op.node {\n+                // At least for integers, shifts are already handled by the CTFE\n+                return;\n+            }\n             let (actual_lhs, lhs_ref_counter) = peel_hir_expr_refs(lhs);\n             let (actual_rhs, rhs_ref_counter) = peel_hir_expr_refs(rhs);\n             match (\n@@ -151,10 +155,13 @@ impl ArithmeticSideEffects {\n             ) {\n                 (None, None) => false,\n                 (None, Some(n)) | (Some(n), None) => match (&op.node, n) {\n-                    (hir::BinOpKind::Div | hir::BinOpKind::Rem, 0) => false,\n+                    // Division and module are always valid if applied to non-zero integers\n+                    (hir::BinOpKind::Div | hir::BinOpKind::Rem, local_n) if local_n != 0 => true,\n+                    // Addition or subtracting zeros is always a no-op\n                     (hir::BinOpKind::Add | hir::BinOpKind::Sub, 0)\n-                    | (hir::BinOpKind::Div | hir::BinOpKind::Rem, _)\n-                    | (hir::BinOpKind::Mul, 0 | 1) => true,\n+                    // Multiplication by 1 or 0 will never overflow\n+                    | (hir::BinOpKind::Mul, 0 | 1)\n+                    => true,\n                     _ => false,\n                 },\n                 (Some(_), Some(_)) => {"}, {"sha": "ee7d2ba444b20441abc353e858007e6222ba8691", "filename": "tests/ui/arithmetic_side_effects.rs", "status": "modified", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/c43937316af1321a97c03a22cd04273eba63d5b9/tests%2Fui%2Farithmetic_side_effects.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c43937316af1321a97c03a22cd04273eba63d5b9/tests%2Fui%2Farithmetic_side_effects.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Farithmetic_side_effects.rs?ref=c43937316af1321a97c03a22cd04273eba63d5b9", "patch": "@@ -45,24 +45,32 @@ impl_arith!(\n     Div, Custom, Custom, div;\n     Mul, Custom, Custom, mul;\n     Rem, Custom, Custom, rem;\n+    Shl, Custom, Custom, shl;\n+    Shr, Custom, Custom, shr;\n     Sub, Custom, Custom, sub;\n \n     Add, Custom, &Custom, add;\n     Div, Custom, &Custom, div;\n     Mul, Custom, &Custom, mul;\n     Rem, Custom, &Custom, rem;\n+    Shl, Custom, &Custom, shl;\n+    Shr, Custom, &Custom, shr;\n     Sub, Custom, &Custom, sub;\n \n     Add, &Custom, Custom, add;\n     Div, &Custom, Custom, div;\n     Mul, &Custom, Custom, mul;\n     Rem, &Custom, Custom, rem;\n+    Shl, &Custom, Custom, shl;\n+    Shr, &Custom, Custom, shr;\n     Sub, &Custom, Custom, sub;\n \n     Add, &Custom, &Custom, add;\n     Div, &Custom, &Custom, div;\n     Mul, &Custom, &Custom, mul;\n     Rem, &Custom, &Custom, rem;\n+    Shl, &Custom, &Custom, shl;\n+    Shr, &Custom, &Custom, shr;\n     Sub, &Custom, &Custom, sub;\n );\n \n@@ -71,24 +79,32 @@ impl_assign_arith!(\n     DivAssign, Custom, Custom, div_assign;\n     MulAssign, Custom, Custom, mul_assign;\n     RemAssign, Custom, Custom, rem_assign;\n+    ShlAssign, Custom, Custom, shl_assign;\n+    ShrAssign, Custom, Custom, shr_assign;\n     SubAssign, Custom, Custom, sub_assign;\n \n     AddAssign, Custom, &Custom, add_assign;\n     DivAssign, Custom, &Custom, div_assign;\n     MulAssign, Custom, &Custom, mul_assign;\n     RemAssign, Custom, &Custom, rem_assign;\n+    ShlAssign, Custom, &Custom, shl_assign;\n+    ShrAssign, Custom, &Custom, shr_assign;\n     SubAssign, Custom, &Custom, sub_assign;\n \n     AddAssign, &Custom, Custom, add_assign;\n     DivAssign, &Custom, Custom, div_assign;\n     MulAssign, &Custom, Custom, mul_assign;\n     RemAssign, &Custom, Custom, rem_assign;\n+    ShlAssign, &Custom, Custom, shl_assign;\n+    ShrAssign, &Custom, Custom, shr_assign;\n     SubAssign, &Custom, Custom, sub_assign;\n \n     AddAssign, &Custom, &Custom, add_assign;\n     DivAssign, &Custom, &Custom, div_assign;\n     MulAssign, &Custom, &Custom, mul_assign;\n     RemAssign, &Custom, &Custom, rem_assign;\n+    ShlAssign, &Custom, &Custom, shl_assign;\n+    ShrAssign, &Custom, &Custom, shr_assign;\n     SubAssign, &Custom, &Custom, sub_assign;\n );\n \n@@ -297,6 +313,10 @@ pub fn unknown_ops_or_runtime_ops_that_can_overflow() {\n     _custom %= &Custom;\n     _custom *= Custom;\n     _custom *= &Custom;\n+    _custom >>= Custom;\n+    _custom >>= &Custom;\n+    _custom <<= Custom;\n+    _custom <<= &Custom;\n     _custom += -Custom;\n     _custom += &-Custom;\n     _custom -= -Custom;\n@@ -307,6 +327,10 @@ pub fn unknown_ops_or_runtime_ops_that_can_overflow() {\n     _custom %= &-Custom;\n     _custom *= -Custom;\n     _custom *= &-Custom;\n+    _custom >>= -Custom;\n+    _custom >>= &-Custom;\n+    _custom <<= -Custom;\n+    _custom <<= &-Custom;\n \n     // Binary\n     _n = _n + 1;\n@@ -347,6 +371,10 @@ pub fn unknown_ops_or_runtime_ops_that_can_overflow() {\n     _custom = Custom + &Custom;\n     _custom = &Custom + Custom;\n     _custom = &Custom + &Custom;\n+    _custom = _custom >> _custom;\n+    _custom = _custom >> &_custom;\n+    _custom = Custom << _custom;\n+    _custom = &Custom << _custom;\n \n     // Unary\n     _n = -_n;"}, {"sha": "3895f08964ce8b32ea6611a9a2a833398f6525d9", "filename": "tests/ui/arithmetic_side_effects.stderr", "status": "modified", "additions": 168, "deletions": 120, "changes": 288, "blob_url": "https://github.com/rust-lang/rust/blob/c43937316af1321a97c03a22cd04273eba63d5b9/tests%2Fui%2Farithmetic_side_effects.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c43937316af1321a97c03a22cd04273eba63d5b9/tests%2Fui%2Farithmetic_side_effects.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Farithmetic_side_effects.stderr?ref=c43937316af1321a97c03a22cd04273eba63d5b9", "patch": "@@ -1,598 +1,646 @@\n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:270:5\n+  --> $DIR/arithmetic_side_effects.rs:286:5\n    |\n LL |     _n += 1;\n    |     ^^^^^^^\n    |\n    = note: `-D clippy::arithmetic-side-effects` implied by `-D warnings`\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:271:5\n+  --> $DIR/arithmetic_side_effects.rs:287:5\n    |\n LL |     _n += &1;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:272:5\n+  --> $DIR/arithmetic_side_effects.rs:288:5\n    |\n LL |     _n -= 1;\n    |     ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:273:5\n+  --> $DIR/arithmetic_side_effects.rs:289:5\n    |\n LL |     _n -= &1;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:274:5\n+  --> $DIR/arithmetic_side_effects.rs:290:5\n    |\n LL |     _n /= 0;\n    |     ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:275:5\n+  --> $DIR/arithmetic_side_effects.rs:291:5\n    |\n LL |     _n /= &0;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:276:5\n+  --> $DIR/arithmetic_side_effects.rs:292:5\n    |\n LL |     _n %= 0;\n    |     ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:277:5\n+  --> $DIR/arithmetic_side_effects.rs:293:5\n    |\n LL |     _n %= &0;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:278:5\n+  --> $DIR/arithmetic_side_effects.rs:294:5\n    |\n LL |     _n *= 2;\n    |     ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:279:5\n+  --> $DIR/arithmetic_side_effects.rs:295:5\n    |\n LL |     _n *= &2;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:280:5\n+  --> $DIR/arithmetic_side_effects.rs:296:5\n    |\n LL |     _n += -1;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:281:5\n+  --> $DIR/arithmetic_side_effects.rs:297:5\n    |\n LL |     _n += &-1;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:282:5\n+  --> $DIR/arithmetic_side_effects.rs:298:5\n    |\n LL |     _n -= -1;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:283:5\n+  --> $DIR/arithmetic_side_effects.rs:299:5\n    |\n LL |     _n -= &-1;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:284:5\n+  --> $DIR/arithmetic_side_effects.rs:300:5\n    |\n LL |     _n /= -0;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:285:5\n+  --> $DIR/arithmetic_side_effects.rs:301:5\n    |\n LL |     _n /= &-0;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:286:5\n+  --> $DIR/arithmetic_side_effects.rs:302:5\n    |\n LL |     _n %= -0;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:287:5\n+  --> $DIR/arithmetic_side_effects.rs:303:5\n    |\n LL |     _n %= &-0;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:288:5\n+  --> $DIR/arithmetic_side_effects.rs:304:5\n    |\n LL |     _n *= -2;\n    |     ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:289:5\n+  --> $DIR/arithmetic_side_effects.rs:305:5\n    |\n LL |     _n *= &-2;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:290:5\n+  --> $DIR/arithmetic_side_effects.rs:306:5\n    |\n LL |     _custom += Custom;\n    |     ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:291:5\n+  --> $DIR/arithmetic_side_effects.rs:307:5\n    |\n LL |     _custom += &Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:292:5\n+  --> $DIR/arithmetic_side_effects.rs:308:5\n    |\n LL |     _custom -= Custom;\n    |     ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:293:5\n+  --> $DIR/arithmetic_side_effects.rs:309:5\n    |\n LL |     _custom -= &Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:294:5\n+  --> $DIR/arithmetic_side_effects.rs:310:5\n    |\n LL |     _custom /= Custom;\n    |     ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:295:5\n+  --> $DIR/arithmetic_side_effects.rs:311:5\n    |\n LL |     _custom /= &Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:296:5\n+  --> $DIR/arithmetic_side_effects.rs:312:5\n    |\n LL |     _custom %= Custom;\n    |     ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:297:5\n+  --> $DIR/arithmetic_side_effects.rs:313:5\n    |\n LL |     _custom %= &Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:298:5\n+  --> $DIR/arithmetic_side_effects.rs:314:5\n    |\n LL |     _custom *= Custom;\n    |     ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:299:5\n+  --> $DIR/arithmetic_side_effects.rs:315:5\n    |\n LL |     _custom *= &Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:300:5\n+  --> $DIR/arithmetic_side_effects.rs:316:5\n+   |\n+LL |     _custom >>= Custom;\n+   |     ^^^^^^^^^^^^^^^^^^\n+\n+error: arithmetic operation that can potentially result in unexpected side-effects\n+  --> $DIR/arithmetic_side_effects.rs:317:5\n+   |\n+LL |     _custom >>= &Custom;\n+   |     ^^^^^^^^^^^^^^^^^^^\n+\n+error: arithmetic operation that can potentially result in unexpected side-effects\n+  --> $DIR/arithmetic_side_effects.rs:318:5\n+   |\n+LL |     _custom <<= Custom;\n+   |     ^^^^^^^^^^^^^^^^^^\n+\n+error: arithmetic operation that can potentially result in unexpected side-effects\n+  --> $DIR/arithmetic_side_effects.rs:319:5\n+   |\n+LL |     _custom <<= &Custom;\n+   |     ^^^^^^^^^^^^^^^^^^^\n+\n+error: arithmetic operation that can potentially result in unexpected side-effects\n+  --> $DIR/arithmetic_side_effects.rs:320:5\n    |\n LL |     _custom += -Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:301:5\n+  --> $DIR/arithmetic_side_effects.rs:321:5\n    |\n LL |     _custom += &-Custom;\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:302:5\n+  --> $DIR/arithmetic_side_effects.rs:322:5\n    |\n LL |     _custom -= -Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:303:5\n+  --> $DIR/arithmetic_side_effects.rs:323:5\n    |\n LL |     _custom -= &-Custom;\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:304:5\n+  --> $DIR/arithmetic_side_effects.rs:324:5\n    |\n LL |     _custom /= -Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:305:5\n+  --> $DIR/arithmetic_side_effects.rs:325:5\n    |\n LL |     _custom /= &-Custom;\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:306:5\n+  --> $DIR/arithmetic_side_effects.rs:326:5\n    |\n LL |     _custom %= -Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:307:5\n+  --> $DIR/arithmetic_side_effects.rs:327:5\n    |\n LL |     _custom %= &-Custom;\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:308:5\n+  --> $DIR/arithmetic_side_effects.rs:328:5\n    |\n LL |     _custom *= -Custom;\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:309:5\n+  --> $DIR/arithmetic_side_effects.rs:329:5\n    |\n LL |     _custom *= &-Custom;\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:312:10\n+  --> $DIR/arithmetic_side_effects.rs:330:5\n+   |\n+LL |     _custom >>= -Custom;\n+   |     ^^^^^^^^^^^^^^^^^^^\n+\n+error: arithmetic operation that can potentially result in unexpected side-effects\n+  --> $DIR/arithmetic_side_effects.rs:331:5\n+   |\n+LL |     _custom >>= &-Custom;\n+   |     ^^^^^^^^^^^^^^^^^^^^\n+\n+error: arithmetic operation that can potentially result in unexpected side-effects\n+  --> $DIR/arithmetic_side_effects.rs:332:5\n+   |\n+LL |     _custom <<= -Custom;\n+   |     ^^^^^^^^^^^^^^^^^^^\n+\n+error: arithmetic operation that can potentially result in unexpected side-effects\n+  --> $DIR/arithmetic_side_effects.rs:333:5\n+   |\n+LL |     _custom <<= &-Custom;\n+   |     ^^^^^^^^^^^^^^^^^^^^\n+\n+error: arithmetic operation that can potentially result in unexpected side-effects\n+  --> $DIR/arithmetic_side_effects.rs:336:10\n    |\n LL |     _n = _n + 1;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:313:10\n+  --> $DIR/arithmetic_side_effects.rs:337:10\n    |\n LL |     _n = _n + &1;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:314:10\n+  --> $DIR/arithmetic_side_effects.rs:338:10\n    |\n LL |     _n = 1 + _n;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:315:10\n+  --> $DIR/arithmetic_side_effects.rs:339:10\n    |\n LL |     _n = &1 + _n;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:316:10\n+  --> $DIR/arithmetic_side_effects.rs:340:10\n    |\n LL |     _n = _n - 1;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:317:10\n+  --> $DIR/arithmetic_side_effects.rs:341:10\n    |\n LL |     _n = _n - &1;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:318:10\n+  --> $DIR/arithmetic_side_effects.rs:342:10\n    |\n LL |     _n = 1 - _n;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:319:10\n+  --> $DIR/arithmetic_side_effects.rs:343:10\n    |\n LL |     _n = &1 - _n;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:320:10\n+  --> $DIR/arithmetic_side_effects.rs:344:10\n    |\n LL |     _n = _n / 0;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:321:10\n+  --> $DIR/arithmetic_side_effects.rs:345:10\n    |\n LL |     _n = _n / &0;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:322:10\n+  --> $DIR/arithmetic_side_effects.rs:346:10\n    |\n LL |     _n = _n % 0;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:323:10\n+  --> $DIR/arithmetic_side_effects.rs:347:10\n    |\n LL |     _n = _n % &0;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:324:10\n+  --> $DIR/arithmetic_side_effects.rs:348:10\n    |\n LL |     _n = _n * 2;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:325:10\n+  --> $DIR/arithmetic_side_effects.rs:349:10\n    |\n LL |     _n = _n * &2;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:326:10\n+  --> $DIR/arithmetic_side_effects.rs:350:10\n    |\n LL |     _n = 2 * _n;\n    |          ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:327:10\n+  --> $DIR/arithmetic_side_effects.rs:351:10\n    |\n LL |     _n = &2 * _n;\n    |          ^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:328:10\n+  --> $DIR/arithmetic_side_effects.rs:352:10\n    |\n LL |     _n = 23 + &85;\n    |          ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:329:10\n+  --> $DIR/arithmetic_side_effects.rs:353:10\n    |\n LL |     _n = &23 + 85;\n    |          ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:330:10\n+  --> $DIR/arithmetic_side_effects.rs:354:10\n    |\n LL |     _n = &23 + &85;\n    |          ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:331:15\n+  --> $DIR/arithmetic_side_effects.rs:355:15\n    |\n LL |     _custom = _custom + _custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:332:15\n+  --> $DIR/arithmetic_side_effects.rs:356:15\n    |\n LL |     _custom = _custom + &_custom;\n    |               ^^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:333:15\n+  --> $DIR/arithmetic_side_effects.rs:357:15\n    |\n LL |     _custom = Custom + _custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:334:15\n+  --> $DIR/arithmetic_side_effects.rs:358:15\n    |\n LL |     _custom = &Custom + _custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:335:15\n+  --> $DIR/arithmetic_side_effects.rs:359:15\n    |\n LL |     _custom = _custom - Custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:336:15\n+  --> $DIR/arithmetic_side_effects.rs:360:15\n    |\n LL |     _custom = _custom - &Custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:337:15\n+  --> $DIR/arithmetic_side_effects.rs:361:15\n    |\n LL |     _custom = Custom - _custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:338:15\n+  --> $DIR/arithmetic_side_effects.rs:362:15\n    |\n LL |     _custom = &Custom - _custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:339:15\n+  --> $DIR/arithmetic_side_effects.rs:363:15\n    |\n LL |     _custom = _custom / Custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:340:15\n+  --> $DIR/arithmetic_side_effects.rs:364:15\n    |\n LL |     _custom = _custom / &Custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:341:15\n+  --> $DIR/arithmetic_side_effects.rs:365:15\n    |\n LL |     _custom = _custom % Custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:342:15\n+  --> $DIR/arithmetic_side_effects.rs:366:15\n    |\n LL |     _custom = _custom % &Custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:343:15\n+  --> $DIR/arithmetic_side_effects.rs:367:15\n    |\n LL |     _custom = _custom * Custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:344:15\n+  --> $DIR/arithmetic_side_effects.rs:368:15\n    |\n LL |     _custom = _custom * &Custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:345:15\n+  --> $DIR/arithmetic_side_effects.rs:369:15\n    |\n LL |     _custom = Custom * _custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:346:15\n+  --> $DIR/arithmetic_side_effects.rs:370:15\n    |\n LL |     _custom = &Custom * _custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:347:15\n+  --> $DIR/arithmetic_side_effects.rs:371:15\n    |\n LL |     _custom = Custom + &Custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:348:15\n+  --> $DIR/arithmetic_side_effects.rs:372:15\n    |\n LL |     _custom = &Custom + Custom;\n    |               ^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:349:15\n+  --> $DIR/arithmetic_side_effects.rs:373:15\n    |\n LL |     _custom = &Custom + &Custom;\n    |               ^^^^^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:352:10\n+  --> $DIR/arithmetic_side_effects.rs:374:15\n+   |\n+LL |     _custom = _custom >> _custom;\n+   |               ^^^^^^^^^^^^^^^^^^\n+\n+error: arithmetic operation that can potentially result in unexpected side-effects\n+  --> $DIR/arithmetic_side_effects.rs:375:15\n+   |\n+LL |     _custom = _custom >> &_custom;\n+   |               ^^^^^^^^^^^^^^^^^^^\n+\n+error: arithmetic operation that can potentially result in unexpected side-effects\n+  --> $DIR/arithmetic_side_effects.rs:376:15\n+   |\n+LL |     _custom = Custom << _custom;\n+   |               ^^^^^^^^^^^^^^^^^\n+\n+error: arithmetic operation that can potentially result in unexpected side-effects\n+  --> $DIR/arithmetic_side_effects.rs:377:15\n+   |\n+LL |     _custom = &Custom << _custom;\n+   |               ^^^^^^^^^^^^^^^^^^\n+\n+error: arithmetic operation that can potentially result in unexpected side-effects\n+  --> $DIR/arithmetic_side_effects.rs:380:10\n    |\n LL |     _n = -_n;\n    |          ^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:353:10\n+  --> $DIR/arithmetic_side_effects.rs:381:10\n    |\n LL |     _n = -&_n;\n    |          ^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:354:15\n+  --> $DIR/arithmetic_side_effects.rs:382:15\n    |\n LL |     _custom = -_custom;\n    |               ^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:355:15\n+  --> $DIR/arithmetic_side_effects.rs:383:15\n    |\n LL |     _custom = -&_custom;\n    |               ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:364:5\n+  --> $DIR/arithmetic_side_effects.rs:392:5\n    |\n LL |     1 + i;\n    |     ^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:365:5\n+  --> $DIR/arithmetic_side_effects.rs:393:5\n    |\n LL |     i * 2;\n    |     ^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:367:5\n+  --> $DIR/arithmetic_side_effects.rs:395:5\n    |\n LL |     i - 2 + 2 - i;\n    |     ^^^^^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:368:5\n+  --> $DIR/arithmetic_side_effects.rs:396:5\n    |\n LL |     -i;\n    |     ^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:369:5\n-   |\n-LL |     i >> 1;\n-   |     ^^^^^^\n-\n-error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:370:5\n-   |\n-LL |     i << 1;\n-   |     ^^^^^^\n-\n-error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:379:5\n+  --> $DIR/arithmetic_side_effects.rs:407:5\n    |\n LL |     i += 1;\n    |     ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:380:5\n+  --> $DIR/arithmetic_side_effects.rs:408:5\n    |\n LL |     i -= 1;\n    |     ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:381:5\n+  --> $DIR/arithmetic_side_effects.rs:409:5\n    |\n LL |     i *= 2;\n    |     ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:383:5\n+  --> $DIR/arithmetic_side_effects.rs:411:5\n    |\n LL |     i /= 0;\n    |     ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:385:5\n+  --> $DIR/arithmetic_side_effects.rs:413:5\n    |\n LL |     i /= var1;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:386:5\n+  --> $DIR/arithmetic_side_effects.rs:414:5\n    |\n LL |     i /= var2;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:388:5\n+  --> $DIR/arithmetic_side_effects.rs:416:5\n    |\n LL |     i %= 0;\n    |     ^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:390:5\n+  --> $DIR/arithmetic_side_effects.rs:418:5\n    |\n LL |     i %= var1;\n    |     ^^^^^^^^^\n \n error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:391:5\n+  --> $DIR/arithmetic_side_effects.rs:419:5\n    |\n LL |     i %= var2;\n    |     ^^^^^^^^^\n \n-error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:392:5\n-   |\n-LL |     i <<= 3;\n-   |     ^^^^^^^\n-\n-error: arithmetic operation that can potentially result in unexpected side-effects\n-  --> $DIR/arithmetic_side_effects.rs:393:5\n-   |\n-LL |     i >>= 2;\n-   |     ^^^^^^^\n-\n-error: aborting due to 99 previous errors\n+error: aborting due to 107 previous errors\n "}]}