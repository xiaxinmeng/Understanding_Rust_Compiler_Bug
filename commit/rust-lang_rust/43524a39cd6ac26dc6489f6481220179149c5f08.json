{"sha": "43524a39cd6ac26dc6489f6481220179149c5f08", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQzNTI0YTM5Y2Q2YWMyNmRjNjQ4OWY2NDgxMjIwMTc5MTQ5YzVmMDg=", "commit": {"author": {"name": "bors[bot]", "email": "bors[bot]@users.noreply.github.com", "date": "2019-04-30T14:04:04Z"}, "committer": {"name": "bors[bot]", "email": "bors[bot]@users.noreply.github.com", "date": "2019-04-30T14:04:04Z"}, "message": "Merge #1217\n\n1217: Sidestep two-phase borrow violation r=matklad a=pnkfelix\n\nSidestep two-phase borrow violation signaled by mutable_borrow_reservation_conflict.\r\n\r\nSee rust-lang/rust#59159 for further information/discussion.\n\nCo-authored-by: Felix S. Klock II <pnkfelix@pnkfx.org>", "tree": {"sha": "a1349b3ad2a2c782566176e61d87eceeb23e16bc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a1349b3ad2a2c782566176e61d87eceeb23e16bc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/43524a39cd6ac26dc6489f6481220179149c5f08", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/43524a39cd6ac26dc6489f6481220179149c5f08", "html_url": "https://github.com/rust-lang/rust/commit/43524a39cd6ac26dc6489f6481220179149c5f08", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/43524a39cd6ac26dc6489f6481220179149c5f08/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "parents": [{"sha": "6618d1edc3edaad9ebdc216e6d7423ac9ac6a265", "url": "https://api.github.com/repos/rust-lang/rust/commits/6618d1edc3edaad9ebdc216e6d7423ac9ac6a265", "html_url": "https://github.com/rust-lang/rust/commit/6618d1edc3edaad9ebdc216e6d7423ac9ac6a265"}, {"sha": "d694b0174af8799ba16b5183e8d3e1c4af574f5d", "url": "https://api.github.com/repos/rust-lang/rust/commits/d694b0174af8799ba16b5183e8d3e1c4af574f5d", "html_url": "https://github.com/rust-lang/rust/commit/d694b0174af8799ba16b5183e8d3e1c4af574f5d"}], "stats": {"total": 5, "additions": 3, "deletions": 2}, "files": [{"sha": "4640b3b7471fcbd6ad2cb52194f74d0b9a8475a7", "filename": "crates/ra_hir/src/nameres/collector.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/43524a39cd6ac26dc6489f6481220179149c5f08/crates%2Fra_hir%2Fsrc%2Fnameres%2Fcollector.rs", "raw_url": "https://github.com/rust-lang/rust/raw/43524a39cd6ac26dc6489f6481220179149c5f08/crates%2Fra_hir%2Fsrc%2Fnameres%2Fcollector.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fnameres%2Fcollector.rs?ref=43524a39cd6ac26dc6489f6481220179149c5f08", "patch": "@@ -522,9 +522,10 @@ where\n         if let Some(macro_id) =\n             mac.path.as_ident().and_then(|name| self.def_collector.global_macro_scope.get(&name))\n         {\n-            let macro_call_id = MacroCallLoc { def: *macro_id, ast_id }.id(self.def_collector.db);\n+            let def = *macro_id;\n+            let macro_call_id = MacroCallLoc { def, ast_id }.id(self.def_collector.db);\n \n-            self.def_collector.collect_macro_expansion(self.module_id, macro_call_id, *macro_id);\n+            self.def_collector.collect_macro_expansion(self.module_id, macro_call_id, def);\n             return;\n         }\n "}]}