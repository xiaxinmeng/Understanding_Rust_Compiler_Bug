{"sha": "ccc68fc18b615561694650b25e665c257847cf67", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNjYzY4ZmMxOGI2MTU1NjE2OTQ2NTBiMjVlNjY1YzI1Nzg0N2NmNjc=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-08-25T06:18:23Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-08-27T22:54:43Z"}, "message": "Add std::istr::str_from_cstr. Issue #855", "tree": {"sha": "3d02f3331797aee374a2d643e52b9e3387282fd3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3d02f3331797aee374a2d643e52b9e3387282fd3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ccc68fc18b615561694650b25e665c257847cf67", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ccc68fc18b615561694650b25e665c257847cf67", "html_url": "https://github.com/rust-lang/rust/commit/ccc68fc18b615561694650b25e665c257847cf67", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ccc68fc18b615561694650b25e665c257847cf67/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b2408d57f034c0a448b60bf03254d8f73c0882db", "url": "https://api.github.com/repos/rust-lang/rust/commits/b2408d57f034c0a448b60bf03254d8f73c0882db", "html_url": "https://github.com/rust-lang/rust/commit/b2408d57f034c0a448b60bf03254d8f73c0882db"}], "stats": {"total": 24, "additions": 23, "deletions": 1}, "files": [{"sha": "bed720d8c1e541bb532818c5613789f50bab0bde", "filename": "src/lib/istr.rs", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/ccc68fc18b615561694650b25e665c257847cf67/src%2Flib%2Fistr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ccc68fc18b615561694650b25e665c257847cf67/src%2Flib%2Fistr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib%2Fistr.rs?ref=ccc68fc18b615561694650b25e665c257847cf67", "patch": "@@ -3,7 +3,7 @@ index, rindex, find, starts_with, ends_with, substr, slice, split,\n concat, connect, to_upper, replace, char_slice, trim_left, trim_right, trim,\n unshift_char, shift_char, pop_char, push_char, is_utf8, from_chars, to_chars,\n char_len, char_at, bytes, is_ascii, shift_byte, pop_byte, unsafe_from_byte,\n-unsafe_from_bytes, from_char, char_range_at;\n+unsafe_from_bytes, from_char, char_range_at, str_from_cstr;\n \n export from_estr, to_estr, from_estrs, to_estrs;\n \n@@ -461,4 +461,17 @@ fn trim_right(s: &istr) -> istr {\n \n fn trim(s: &istr) -> istr {\n     trim_left(trim_right(s))\n+}\n+\n+fn str_from_cstr(cstr: *u8) -> istr {\n+    let res = ~\"\";\n+    let start = cstr;\n+    let curr = start;\n+    let i = 0u;\n+    while *curr != 0u8 {\n+        push_byte(res, *curr);\n+        i += 1u;\n+        curr = ptr::offset(start, i);\n+    }\n+    ret res;\n }\n\\ No newline at end of file"}, {"sha": "b762e438336edb48edbd36a6f90997ffcca81a8f", "filename": "src/test/stdtest/istr.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/ccc68fc18b615561694650b25e665c257847cf67/src%2Ftest%2Fstdtest%2Fistr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ccc68fc18b615561694650b25e665c257847cf67/src%2Ftest%2Fstdtest%2Fistr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fstdtest%2Fistr.rs?ref=ccc68fc18b615561694650b25e665c257847cf67", "patch": "@@ -1,4 +1,5 @@\n import std::istr;\n+import std::vec;\n \n #[test]\n fn test_eq() {\n@@ -255,4 +256,12 @@ fn unsafe_from_bytes() {\n     let a = [65u8, 65u8, 65u8, 65u8, 65u8, 65u8, 65u8];\n     let b = istr::unsafe_from_bytes(a);\n     assert b == ~\"AAAAAAA\";\n+}\n+\n+#[test]\n+fn str_from_cstr() {\n+    let a = [65u8, 65u8, 65u8, 65u8, 65u8, 65u8, 65u8, 0u8];\n+    let b = vec::to_ptr(a);\n+    let c = istr::str_from_cstr(b);\n+    assert c == ~\"AAAAAAA\";\n }\n\\ No newline at end of file"}]}