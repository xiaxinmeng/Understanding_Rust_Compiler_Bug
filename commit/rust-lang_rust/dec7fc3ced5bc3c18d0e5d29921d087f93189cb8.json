{"sha": "dec7fc3ced5bc3c18d0e5d29921d087f93189cb8", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRlYzdmYzNjZWQ1YmMzYzE4ZDBlNWQyOTkyMWQwODdmOTMxODljYjg=", "commit": {"author": {"name": "Theodore Luo Wang", "email": "wangtheo662@gmail.com", "date": "2021-08-29T01:18:20Z"}, "committer": {"name": "tlwang", "email": "tlwang@student.cs.uwaterloo.ca", "date": "2021-08-29T01:24:40Z"}, "message": "Fix an ICE caused by type mismatch errors being ignored", "tree": {"sha": "65337b5080c54c7b872a35686bc0f11addbfe59a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/65337b5080c54c7b872a35686bc0f11addbfe59a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/dec7fc3ced5bc3c18d0e5d29921d087f93189cb8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/dec7fc3ced5bc3c18d0e5d29921d087f93189cb8", "html_url": "https://github.com/rust-lang/rust/commit/dec7fc3ced5bc3c18d0e5d29921d087f93189cb8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/dec7fc3ced5bc3c18d0e5d29921d087f93189cb8/comments", "author": {"login": "theo-lw", "id": 28904678, "node_id": "MDQ6VXNlcjI4OTA0Njc4", "avatar_url": "https://avatars.githubusercontent.com/u/28904678?v=4", "gravatar_id": "", "url": "https://api.github.com/users/theo-lw", "html_url": "https://github.com/theo-lw", "followers_url": "https://api.github.com/users/theo-lw/followers", "following_url": "https://api.github.com/users/theo-lw/following{/other_user}", "gists_url": "https://api.github.com/users/theo-lw/gists{/gist_id}", "starred_url": "https://api.github.com/users/theo-lw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/theo-lw/subscriptions", "organizations_url": "https://api.github.com/users/theo-lw/orgs", "repos_url": "https://api.github.com/users/theo-lw/repos", "events_url": "https://api.github.com/users/theo-lw/events{/privacy}", "received_events_url": "https://api.github.com/users/theo-lw/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5eacec9ec7e112a0de1011519a57c45586d58414", "url": "https://api.github.com/repos/rust-lang/rust/commits/5eacec9ec7e112a0de1011519a57c45586d58414", "html_url": "https://github.com/rust-lang/rust/commit/5eacec9ec7e112a0de1011519a57c45586d58414"}], "stats": {"total": 19, "additions": 13, "deletions": 6}, "files": [{"sha": "f186d35bcbc848be107cdfb4ed6e60ef82a30343", "filename": "compiler/rustc_typeck/src/check/demand.rs", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/dec7fc3ced5bc3c18d0e5d29921d087f93189cb8/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fdemand.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dec7fc3ced5bc3c18d0e5d29921d087f93189cb8/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fdemand.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fdemand.rs?ref=dec7fc3ced5bc3c18d0e5d29921d087f93189cb8", "patch": "@@ -145,12 +145,6 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         let expr_ty = self.resolve_vars_with_obligations(checked_ty);\n         let mut err = self.report_mismatched_types(&cause, expected, expr_ty, e);\n \n-        if self.is_assign_to_bool(expr, expected) {\n-            // Error reported in `check_assign` so avoid emitting error again.\n-            err.delay_as_bug();\n-            return (expected, None);\n-        }\n-\n         self.emit_coerce_suggestions(&mut err, expr, expr_ty, expected, expected_ty_expr);\n \n         (expected, Some(err))"}, {"sha": "751dc8719cf33769b96e62909094fa39a0bf2b31", "filename": "src/test/ui/typeck/issue-87771-ice-assign-assign-to-bool.rs", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/dec7fc3ced5bc3c18d0e5d29921d087f93189cb8/src%2Ftest%2Fui%2Ftypeck%2Fissue-87771-ice-assign-assign-to-bool.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dec7fc3ced5bc3c18d0e5d29921d087f93189cb8/src%2Ftest%2Fui%2Ftypeck%2Fissue-87771-ice-assign-assign-to-bool.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftypeck%2Fissue-87771-ice-assign-assign-to-bool.rs?ref=dec7fc3ced5bc3c18d0e5d29921d087f93189cb8", "patch": "@@ -0,0 +1,4 @@\n+fn main() {\n+    let mut a;\n+    a = a = true; //~ ERROR mismatched types\n+}"}, {"sha": "fe10fa733d23808c9e6c18f77f3515fe2bb12678", "filename": "src/test/ui/typeck/issue-87771-ice-assign-assign-to-bool.stderr", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/dec7fc3ced5bc3c18d0e5d29921d087f93189cb8/src%2Ftest%2Fui%2Ftypeck%2Fissue-87771-ice-assign-assign-to-bool.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/dec7fc3ced5bc3c18d0e5d29921d087f93189cb8/src%2Ftest%2Fui%2Ftypeck%2Fissue-87771-ice-assign-assign-to-bool.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftypeck%2Fissue-87771-ice-assign-assign-to-bool.stderr?ref=dec7fc3ced5bc3c18d0e5d29921d087f93189cb8", "patch": "@@ -0,0 +1,9 @@\n+error[E0308]: mismatched types\n+  --> $DIR/issue-87771-ice-assign-assign-to-bool.rs:3:9\n+   |\n+LL |     a = a = true;\n+   |         ^^^^^^^^ expected `bool`, found `()`\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0308`."}]}