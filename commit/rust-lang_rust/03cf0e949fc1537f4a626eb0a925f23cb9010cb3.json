{"sha": "03cf0e949fc1537f4a626eb0a925f23cb9010cb3", "node_id": "C_kwDOAAsO6NoAKDAzY2YwZTk0OWZjMTUzN2Y0YTYyNmViMGE5MjVmMjNjYjkwMTBjYjM", "commit": {"author": {"name": "Ezra Shaw", "email": "ezrasure@outlook.com", "date": "2023-04-12T20:48:50Z"}, "committer": {"name": "Ezra Shaw", "email": "ezrasure@outlook.com", "date": "2023-04-13T08:53:32Z"}, "message": "refactor: emit \"unused assoc fn\" in lexical order\n\nwith repect to other dead code lints", "tree": {"sha": "85f9240e0c5dd1575047ac3a532d5a3ad22e2668", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/85f9240e0c5dd1575047ac3a532d5a3ad22e2668"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/03cf0e949fc1537f4a626eb0a925f23cb9010cb3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEINUdoc4Vb1yVx04IZ6vxb7Ds2HAFAmQ3wwwACgkQZ6vxb7Ds\n2HAxLxAAnKnmhmC6rJ6jnduixkhVZAVxOUMrS1uxFLEQglpfw9zNxZZIrC4B/Y19\nckbKrPLeVbNjx6RLIWPlKl02Is0qW4ICO4DP7c+48AFC7OsOgQv2WGsmwYHE4f9h\nHIwJG9rITZtt80CwYMHM/IwTH2iUz9b3jOFP0qjitUvbtbFOELgMWDKqgabdDdbG\n1FRfAS3qGy+j2ughXGC+mq6Kmlx/QtGwAGMdLLdD4fw4asrejvyWihSyTneLxx5U\nE/sbINoUL6clRbRhkSvpOUTp7mJtwdGQ+oUvwGkBUno/t7ewxZFvMqHminTpOYSv\nHXmAit+sQRhafi9j8JxQ+xFMla/5YqSN9a2PbHgC1CRiVYPmkeJRXNVhC4vVFU2i\n9Z3nlstkuvzdYAyXFM/qfzlU9vu4pW+j8bYv95wik/2IvlKZXl/vZkA8FLwh0de9\n3Eq3YyARJ4G6h4oYLQM5FaSU4tyst0G6CGkAp15Z6H+y3/em0XMJAdT5x2hohjY4\no5dRyWIIMpNeeJhJSGs8rQdwecYJ/ysro1GwX8A0vAbFSSFS8u65uDNBrldP+jD/\nRYAr26dibN+e8Wbqlw21fO63PE/dC24CR/cVtB4S+qlXLrvmOOqivlJH96oYJ9OR\nr4S3SswusBIcseq2ATUDt+atjEBMb4Ump73r1p7JEM+436nrLaA=\n=9wWN\n-----END PGP SIGNATURE-----", "payload": "tree 85f9240e0c5dd1575047ac3a532d5a3ad22e2668\nparent a29dada983fa8d44f789d3a64408b7ad4f4c3487\nauthor Ezra Shaw <ezrasure@outlook.com> 1681332530 +1200\ncommitter Ezra Shaw <ezrasure@outlook.com> 1681376012 +1200\n\nrefactor: emit \"unused assoc fn\" in lexical order\n\nwith repect to other dead code lints\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/03cf0e949fc1537f4a626eb0a925f23cb9010cb3", "html_url": "https://github.com/rust-lang/rust/commit/03cf0e949fc1537f4a626eb0a925f23cb9010cb3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/03cf0e949fc1537f4a626eb0a925f23cb9010cb3/comments", "author": {"login": "Ezrashaw", "id": 38062690, "node_id": "MDQ6VXNlcjM4MDYyNjkw", "avatar_url": "https://avatars.githubusercontent.com/u/38062690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ezrashaw", "html_url": "https://github.com/Ezrashaw", "followers_url": "https://api.github.com/users/Ezrashaw/followers", "following_url": "https://api.github.com/users/Ezrashaw/following{/other_user}", "gists_url": "https://api.github.com/users/Ezrashaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ezrashaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ezrashaw/subscriptions", "organizations_url": "https://api.github.com/users/Ezrashaw/orgs", "repos_url": "https://api.github.com/users/Ezrashaw/repos", "events_url": "https://api.github.com/users/Ezrashaw/events{/privacy}", "received_events_url": "https://api.github.com/users/Ezrashaw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Ezrashaw", "id": 38062690, "node_id": "MDQ6VXNlcjM4MDYyNjkw", "avatar_url": "https://avatars.githubusercontent.com/u/38062690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ezrashaw", "html_url": "https://github.com/Ezrashaw", "followers_url": "https://api.github.com/users/Ezrashaw/followers", "following_url": "https://api.github.com/users/Ezrashaw/following{/other_user}", "gists_url": "https://api.github.com/users/Ezrashaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ezrashaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ezrashaw/subscriptions", "organizations_url": "https://api.github.com/users/Ezrashaw/orgs", "repos_url": "https://api.github.com/users/Ezrashaw/repos", "events_url": "https://api.github.com/users/Ezrashaw/events{/privacy}", "received_events_url": "https://api.github.com/users/Ezrashaw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a29dada983fa8d44f789d3a64408b7ad4f4c3487", "url": "https://api.github.com/repos/rust-lang/rust/commits/a29dada983fa8d44f789d3a64408b7ad4f4c3487", "html_url": "https://github.com/rust-lang/rust/commit/a29dada983fa8d44f789d3a64408b7ad4f4c3487"}], "stats": {"total": 117, "additions": 87, "deletions": 30}, "files": [{"sha": "d08dc4055ecb13bb5906e04e4818c489ab843b4c", "filename": "compiler/rustc_passes/src/dead.rs", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/03cf0e949fc1537f4a626eb0a925f23cb9010cb3/compiler%2Frustc_passes%2Fsrc%2Fdead.rs", "raw_url": "https://github.com/rust-lang/rust/raw/03cf0e949fc1537f4a626eb0a925f23cb9010cb3/compiler%2Frustc_passes%2Fsrc%2Fdead.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Fdead.rs?ref=03cf0e949fc1537f4a626eb0a925f23cb9010cb3", "patch": "@@ -836,6 +836,13 @@ fn check_mod_deathness(tcx: TyCtxt<'_>, module: LocalDefId) {\n     let module_items = tcx.hir_module_items(module);\n \n     for item in module_items.items() {\n+        if let hir::ItemKind::Impl(impl_item) = tcx.hir().item(item).kind {\n+            for item in impl_item.items {\n+                visitor.check_definition(item.id.owner_id.def_id);\n+            }\n+            continue;\n+        }\n+\n         if !live_symbols.contains(&item.owner_id.def_id) {\n             let parent = tcx.local_parent(item.owner_id.def_id);\n             if parent != module && !live_symbols.contains(&parent) {\n@@ -900,10 +907,6 @@ fn check_mod_deathness(tcx: TyCtxt<'_>, module: LocalDefId) {\n         }\n     }\n \n-    for impl_item in module_items.impl_items() {\n-        visitor.check_definition(impl_item.owner_id.def_id);\n-    }\n-\n     for foreign_item in module_items.foreign_items() {\n         visitor.check_definition(foreign_item.owner_id.def_id);\n     }"}, {"sha": "dec6f174628a8b151374c27227d19872f82b3373", "filename": "tests/ui/lint/dead-code/issue-85255.stderr", "status": "modified", "additions": 20, "deletions": 20, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/03cf0e949fc1537f4a626eb0a925f23cb9010cb3/tests%2Fui%2Flint%2Fdead-code%2Fissue-85255.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/03cf0e949fc1537f4a626eb0a925f23cb9010cb3/tests%2Fui%2Flint%2Fdead-code%2Fissue-85255.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flint%2Fdead-code%2Fissue-85255.stderr?ref=03cf0e949fc1537f4a626eb0a925f23cb9010cb3", "patch": "@@ -14,26 +14,6 @@ note: the lint level is defined here\n LL | #![warn(dead_code)]\n    |         ^^^^^^^^^\n \n-warning: fields `a` and `b` are never read\n-  --> $DIR/issue-85255.rs:19:5\n-   |\n-LL | pub(crate) struct Foo1 {\n-   |                   ---- fields in this struct\n-LL |     a: i32,\n-   |     ^\n-LL |     pub b: i32,\n-   |         ^\n-\n-warning: fields `a` and `b` are never read\n-  --> $DIR/issue-85255.rs:31:5\n-   |\n-LL | pub(crate) struct Foo2 {\n-   |                   ---- fields in this struct\n-LL |     a: i32,\n-   |     ^\n-LL |     pub b: i32,\n-   |         ^\n-\n warning: method `a` is never used\n   --> $DIR/issue-85255.rs:14:8\n    |\n@@ -46,6 +26,16 @@ warning: method `b` is never used\n LL |     pub fn b(&self) -> i32 { 6 }\n    |            ^\n \n+warning: fields `a` and `b` are never read\n+  --> $DIR/issue-85255.rs:19:5\n+   |\n+LL | pub(crate) struct Foo1 {\n+   |                   ---- fields in this struct\n+LL |     a: i32,\n+   |     ^\n+LL |     pub b: i32,\n+   |         ^\n+\n warning: method `a` is never used\n   --> $DIR/issue-85255.rs:26:8\n    |\n@@ -58,6 +48,16 @@ warning: method `b` is never used\n LL |     pub fn b(&self) -> i32 { 6 }\n    |            ^\n \n+warning: fields `a` and `b` are never read\n+  --> $DIR/issue-85255.rs:31:5\n+   |\n+LL | pub(crate) struct Foo2 {\n+   |                   ---- fields in this struct\n+LL |     a: i32,\n+   |     ^\n+LL |     pub b: i32,\n+   |         ^\n+\n warning: method `a` is never used\n   --> $DIR/issue-85255.rs:38:8\n    |"}, {"sha": "9314f8be82a62c0becbfe6f7f2d30becdc088862", "filename": "tests/ui/lint/dead-code/lint-dead-code-3.stderr", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/03cf0e949fc1537f4a626eb0a925f23cb9010cb3/tests%2Fui%2Flint%2Fdead-code%2Flint-dead-code-3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/03cf0e949fc1537f4a626eb0a925f23cb9010cb3/tests%2Fui%2Flint%2Fdead-code%2Flint-dead-code-3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flint%2Fdead-code%2Flint-dead-code-3.stderr?ref=03cf0e949fc1537f4a626eb0a925f23cb9010cb3", "patch": "@@ -10,6 +10,12 @@ note: the lint level is defined here\n LL | #![deny(dead_code)]\n    |         ^^^^^^^^^\n \n+error: method `foo` is never used\n+  --> $DIR/lint-dead-code-3.rs:16:8\n+   |\n+LL |     fn foo(&self) {\n+   |        ^^^\n+\n error: function `bar` is never used\n   --> $DIR/lint-dead-code-3.rs:21:4\n    |\n@@ -34,12 +40,6 @@ error: function `blah` is never used\n LL |         fn blah() {}\n    |            ^^^^\n \n-error: method `foo` is never used\n-  --> $DIR/lint-dead-code-3.rs:16:8\n-   |\n-LL |     fn foo(&self) {\n-   |        ^^^\n-\n error: function `free` is never used\n   --> $DIR/lint-dead-code-3.rs:62:8\n    |"}, {"sha": "11bdbca821b602a8930d96a1fd45e56cab2193b9", "filename": "tests/ui/lint/dead-code/unused-assoc-fns.rs", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/03cf0e949fc1537f4a626eb0a925f23cb9010cb3/tests%2Fui%2Flint%2Fdead-code%2Funused-assoc-fns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/03cf0e949fc1537f4a626eb0a925f23cb9010cb3/tests%2Fui%2Flint%2Fdead-code%2Funused-assoc-fns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flint%2Fdead-code%2Funused-assoc-fns.rs?ref=03cf0e949fc1537f4a626eb0a925f23cb9010cb3", "patch": "@@ -0,0 +1,27 @@\n+#![deny(unused)]\n+\n+struct Foo;\n+\n+impl Foo {\n+    fn one() {}\n+    //~^ ERROR associated function `one` is never used [dead_code]\n+\n+    fn two(&self) {}\n+    //~^ ERROR method `two` is never used [dead_code]\n+\n+    // seperation between functions\n+    // ...\n+    // ...\n+\n+    fn used() {}\n+\n+    fn three(&self) {\n+    //~^ ERROR method `three` is never used [dead_code]\n+        Foo::one();\n+        // ...\n+    }\n+}\n+\n+fn main() {\n+    Foo::used();\n+}"}, {"sha": "2b8ea88c60926a279ec77f88a6694553ec8a7f62", "filename": "tests/ui/lint/dead-code/unused-assoc-fns.stderr", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/03cf0e949fc1537f4a626eb0a925f23cb9010cb3/tests%2Fui%2Flint%2Fdead-code%2Funused-assoc-fns.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/03cf0e949fc1537f4a626eb0a925f23cb9010cb3/tests%2Fui%2Flint%2Fdead-code%2Funused-assoc-fns.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flint%2Fdead-code%2Funused-assoc-fns.stderr?ref=03cf0e949fc1537f4a626eb0a925f23cb9010cb3", "patch": "@@ -0,0 +1,27 @@\n+error: associated function `one` is never used\n+  --> $DIR/unused-assoc-fns.rs:6:8\n+   |\n+LL |     fn one() {}\n+   |        ^^^\n+   |\n+note: the lint level is defined here\n+  --> $DIR/unused-assoc-fns.rs:1:9\n+   |\n+LL | #![deny(unused)]\n+   |         ^^^^^^\n+   = note: `#[deny(dead_code)]` implied by `#[deny(unused)]`\n+\n+error: method `two` is never used\n+  --> $DIR/unused-assoc-fns.rs:9:8\n+   |\n+LL |     fn two(&self) {}\n+   |        ^^^\n+\n+error: method `three` is never used\n+  --> $DIR/unused-assoc-fns.rs:18:8\n+   |\n+LL |     fn three(&self) {\n+   |        ^^^^^\n+\n+error: aborting due to 3 previous errors\n+"}]}