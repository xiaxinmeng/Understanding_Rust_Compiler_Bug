{"sha": "161c8aa5cf129d98b2c0b52744b7ef5385f9701c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE2MWM4YWE1Y2YxMjlkOThiMmMwYjUyNzQ0YjdlZjUzODVmOTcwMWM=", "commit": {"author": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2019-06-06T18:31:09Z"}, "committer": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2019-06-06T18:31:09Z"}, "message": "Rustup to rustc 1.37.0-nightly (7cdaffd79 2019-06-05)", "tree": {"sha": "50e90e20fd28a5470a2316cf35cefe4d475fbe8c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/50e90e20fd28a5470a2316cf35cefe4d475fbe8c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/161c8aa5cf129d98b2c0b52744b7ef5385f9701c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/161c8aa5cf129d98b2c0b52744b7ef5385f9701c", "html_url": "https://github.com/rust-lang/rust/commit/161c8aa5cf129d98b2c0b52744b7ef5385f9701c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/161c8aa5cf129d98b2c0b52744b7ef5385f9701c/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d3dbf358ae37a3a285e4def6f5621f74fe4ca2b5", "url": "https://api.github.com/repos/rust-lang/rust/commits/d3dbf358ae37a3a285e4def6f5621f74fe4ca2b5", "html_url": "https://github.com/rust-lang/rust/commit/d3dbf358ae37a3a285e4def6f5621f74fe4ca2b5"}], "stats": {"total": 40, "additions": 14, "deletions": 26}, "files": [{"sha": "5bc98237cd311db1aad7597b8b44466f077192a8", "filename": "src/base.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/161c8aa5cf129d98b2c0b52744b7ef5385f9701c/src%2Fbase.rs", "raw_url": "https://github.com/rust-lang/rust/raw/161c8aa5cf129d98b2c0b52744b7ef5385f9701c/src%2Fbase.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbase.rs?ref=161c8aa5cf129d98b2c0b52744b7ef5385f9701c", "patch": "@@ -288,7 +288,7 @@ fn codegen_fn_content<'a, 'tcx: 'a>(fx: &mut FunctionCx<'a, 'tcx, impl Backend>)\n             } => {\n                 let ty = location.ty(fx.mir, fx.tcx).ty;\n                 let ty = fx.monomorphize(&ty);\n-                let drop_fn = crate::rustc_mir::monomorphize::resolve_drop_in_place(fx.tcx, ty);\n+                let drop_fn = Instance::resolve_drop_in_place(fx.tcx, ty);\n \n                 if let ty::InstanceDef::DropGlue(_, None) = drop_fn.def {\n                     // we don't actually need to drop anything\n@@ -603,7 +603,7 @@ fn trans_stmt<'a, 'tcx: 'a>(\n                     let operand = trans_operand(fx, operand);\n                     match operand.layout().ty.sty {\n                         ty::Closure(def_id, substs) => {\n-                            let instance = rustc_mir::monomorphize::resolve_closure(\n+                            let instance = Instance::resolve_closure(\n                                 fx.tcx,\n                                 def_id,\n                                 substs,"}, {"sha": "e9ea58ed1b13ba29203ed265abd455d127f42eca", "filename": "src/constant.rs", "status": "modified", "additions": 9, "deletions": 20, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/161c8aa5cf129d98b2c0b52744b7ef5385f9701c/src%2Fconstant.rs", "raw_url": "https://github.com/rust-lang/rust/raw/161c8aa5cf129d98b2c0b52744b7ef5385f9701c/src%2Fconstant.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconstant.rs?ref=161c8aa5cf129d98b2c0b52744b7ef5385f9701c", "patch": "@@ -5,7 +5,7 @@ use rustc::mir::interpret::{\n };\n use rustc::ty::Const;\n use rustc_mir::interpret::{\n-    InterpretCx, ImmTy, MPlaceTy, Machine, Memory, MemoryKind, OpTy, PlaceTy, Pointer,\n+    InterpretCx, ImmTy, Machine, Memory, MemoryKind, OpTy, PlaceTy,\n     StackPopCleanup,\n };\n \n@@ -375,7 +375,6 @@ impl<'a, 'mir, 'tcx> Machine<'a, 'mir, 'tcx> for TransPlaceInterpreter {\n     fn find_foreign_static(\n         _: DefId,\n         _: ::rustc::ty::query::TyCtxtAt<'a, 'tcx, 'tcx>,\n-        _: &(),\n     ) -> EvalResult<'tcx, Cow<'tcx, Allocation>> {\n         panic!();\n     }\n@@ -393,27 +392,17 @@ impl<'a, 'mir, 'tcx> Machine<'a, 'mir, 'tcx> for TransPlaceInterpreter {\n         panic!();\n     }\n \n-    fn tag_dereference(\n-        _: &InterpretCx<'a, 'mir, 'tcx, Self>,\n-        _: MPlaceTy<'tcx>,\n-        _: Option<::rustc::hir::Mutability>,\n-    ) -> EvalResult<'tcx, Scalar> {\n-        panic!();\n-    }\n-\n-    fn adjust_static_allocation<'alloc>(\n-        alloc: &'alloc Allocation,\n+    fn tag_allocation<'b>(\n+        _: AllocId,\n+        alloc: Cow<'b, Allocation>,\n+        _: Option<MemoryKind<!>>,\n         _: &(),\n-    ) -> Cow<'alloc, Allocation> {\n-        Cow::Borrowed(alloc)\n+    ) -> (Cow<'b, Allocation<(), ()>>, ()) {\n+        (alloc, ())\n     }\n \n-    fn new_allocation(\n-        _: Size,\n-        _: &(),\n-        _: MemoryKind<!>,\n-    ) -> ((), ()) {\n-        ((), ())\n+    fn tag_static_base_pointer(_: AllocId, _: &()) -> Self::PointerTag {\n+        ()\n     }\n \n     fn stack_push(_: &mut InterpretCx<'a, 'mir, 'tcx, Self>) -> EvalResult<'tcx> {"}, {"sha": "beaa24d62f557470245c23db34804ac5caa803dc", "filename": "src/driver.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/161c8aa5cf129d98b2c0b52744b7ef5385f9701c/src%2Fdriver.rs", "raw_url": "https://github.com/rust-lang/rust/raw/161c8aa5cf129d98b2c0b52744b7ef5385f9701c/src%2Fdriver.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdriver.rs?ref=161c8aa5cf129d98b2c0b52744b7ef5385f9701c", "patch": "@@ -8,7 +8,6 @@ use rustc::mir::mono::{Linkage as RLinkage, Visibility};\n use rustc::session::config::{DebugInfo, OutputType};\n use rustc_codegen_ssa::back::linker::LinkerInfo;\n use rustc_codegen_ssa::CrateInfo;\n-use rustc_mir::monomorphize::partitioning::CodegenUnitExt;\n \n use cranelift_faerie::*;\n "}, {"sha": "0d545ebb9af07dc04c01a4535c05f9fa96952860", "filename": "src/lib.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/161c8aa5cf129d98b2c0b52744b7ef5385f9701c/src%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/161c8aa5cf129d98b2c0b52744b7ef5385f9701c/src%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib.rs?ref=161c8aa5cf129d98b2c0b52744b7ef5385f9701c", "patch": "@@ -56,7 +56,7 @@ mod prelude {\n \n     pub use rustc::bug;\n     pub use rustc::hir::def_id::{CrateNum, DefId, LOCAL_CRATE};\n-    pub use rustc::mir::{self, interpret::AllocId, *};\n+    pub use rustc::mir::{self, interpret::AllocId, mono::MonoItem, *};\n     pub use rustc::session::{\n         config::{CrateType, Lto},\n         Session,\n@@ -71,7 +71,7 @@ mod prelude {\n         indexed_vec::Idx,\n         sync::Lrc,\n     };\n-    pub use rustc_mir::monomorphize::{collector, MonoItem};\n+    pub use rustc_mir::monomorphize::collector;\n \n     pub use rustc_codegen_ssa::mir::operand::{OperandRef, OperandValue};\n     pub use rustc_codegen_ssa::traits::*;"}, {"sha": "d89f16ded0d7e59ebab0172e999206a73705f509", "filename": "src/vtable.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/161c8aa5cf129d98b2c0b52744b7ef5385f9701c/src%2Fvtable.rs", "raw_url": "https://github.com/rust-lang/rust/raw/161c8aa5cf129d98b2c0b52744b7ef5385f9701c/src%2Fvtable.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fvtable.rs?ref=161c8aa5cf129d98b2c0b52744b7ef5385f9701c", "patch": "@@ -89,7 +89,7 @@ fn build_vtable<'a, 'tcx: 'a>(\n     let drop_in_place_fn = import_function(\n         tcx,\n         fx.module,\n-        crate::rustc_mir::monomorphize::resolve_drop_in_place(tcx, ty),\n+        Instance::resolve_drop_in_place(tcx, ty),\n     );\n \n     let mut components: Vec<_> = vec![Some(drop_in_place_fn), None, None];"}]}