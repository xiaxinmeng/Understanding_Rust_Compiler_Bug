{"sha": "f7a132f4280cb8b01ba78126acc0cbea91951634", "node_id": "C_kwDOAAsO6NoAKGY3YTEzMmY0MjgwY2I4YjAxYmE3ODEyNmFjYzBjYmVhOTE5NTE2MzQ", "commit": {"author": {"name": "Chris Denton", "email": "chris@chrisdenton.dev", "date": "2023-02-19T09:44:14Z"}, "committer": {"name": "Chris Denton", "email": "chris@chrisdenton.dev", "date": "2023-02-21T18:33:19Z"}, "message": "Move `rename_directory` from ui-fulldeps to std\n\nstd has had a `TempDir` implementation for a long time now.", "tree": {"sha": "0afc3e6ba37d289f31e46d46ebddcfd3a8e07b73", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0afc3e6ba37d289f31e46d46ebddcfd3a8e07b73"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f7a132f4280cb8b01ba78126acc0cbea91951634", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE+p/jD6jrzmnSIWJLcTRy8vRWJ94FAmP1Dm8ACgkQcTRy8vRW\nJ95gHhAAsHiL/FK0OEqFYZ9Bxl9Diok7+vs36IdgcyeyBvKhNK7c+JE3zjUtdvYO\n36Z8+X/ak3bjmN4z7JlxVH+tWvQgQEn8Qo8CAFeBHz+zTVtB6qy9OSONCDKnnv7I\nEB8Iy+7R+r2Z9dT6P0Z3ZCZUFEFR+ztrkY99g8hXb3qpdqKuUkGqsGOIHrlN76Jm\n7uYjYyj5WhhW4cpsDuqZ2ENdbFIDfdcWeL9s9rBoA7x4QjZ5lUEki7FS8TqLKZd7\nEado9pc5LJKenSaI7enkZ2sWG1sa2aZnBiQN99fpYqIJNMvVpX3Dqb/nM7Kem/5L\nRnJFZZk1N4pZD9d1y9CyPJDxYXAfHHxebE1nQ9B7Kq1MEcHf2MBJI7P5DcyJLywt\nSM8OUMkyymgWZsOHM2HbmgT2ruObJunfF4CrCwNceE4i5o9flf0QngqF/JE4Gjhu\nUB0JtNfiUmt8pbewF/rWfdNJ/lbJbZXLfoUEJdW+nkW5QMiiaQvZvMMNc7bG3DWs\nISiLDwPwMKI6PajFv07eV54QFEKDRq3wUBY6eZZXASnV7cBxu1vttHWPYUZEEhuu\nc2wFPtKOiyKLfAO20PVLu1sg2KS6v0m45iBanDcPIipgNIQiRkHil7VUqBjvtjdR\nZEYqh+x3PswoE4E1JSggv0QPjsD2nr6nVwEyzcZVeSZmRrqFxSo=\n=LAuD\n-----END PGP SIGNATURE-----", "payload": "tree 0afc3e6ba37d289f31e46d46ebddcfd3a8e07b73\nparent 6a92395197eb98b95d0a023dc41fe7a8b986baf5\nauthor Chris Denton <chris@chrisdenton.dev> 1676799854 +0000\ncommitter Chris Denton <chris@chrisdenton.dev> 1677004399 +0000\n\nMove `rename_directory` from ui-fulldeps to std\n\nstd has had a `TempDir` implementation for a long time now.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f7a132f4280cb8b01ba78126acc0cbea91951634", "html_url": "https://github.com/rust-lang/rust/commit/f7a132f4280cb8b01ba78126acc0cbea91951634", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f7a132f4280cb8b01ba78126acc0cbea91951634/comments", "author": {"login": "ChrisDenton", "id": 4459874, "node_id": "MDQ6VXNlcjQ0NTk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4459874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChrisDenton", "html_url": "https://github.com/ChrisDenton", "followers_url": "https://api.github.com/users/ChrisDenton/followers", "following_url": "https://api.github.com/users/ChrisDenton/following{/other_user}", "gists_url": "https://api.github.com/users/ChrisDenton/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChrisDenton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChrisDenton/subscriptions", "organizations_url": "https://api.github.com/users/ChrisDenton/orgs", "repos_url": "https://api.github.com/users/ChrisDenton/repos", "events_url": "https://api.github.com/users/ChrisDenton/events{/privacy}", "received_events_url": "https://api.github.com/users/ChrisDenton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ChrisDenton", "id": 4459874, "node_id": "MDQ6VXNlcjQ0NTk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4459874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChrisDenton", "html_url": "https://github.com/ChrisDenton", "followers_url": "https://api.github.com/users/ChrisDenton/followers", "following_url": "https://api.github.com/users/ChrisDenton/following{/other_user}", "gists_url": "https://api.github.com/users/ChrisDenton/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChrisDenton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChrisDenton/subscriptions", "organizations_url": "https://api.github.com/users/ChrisDenton/orgs", "repos_url": "https://api.github.com/users/ChrisDenton/repos", "events_url": "https://api.github.com/users/ChrisDenton/events{/privacy}", "received_events_url": "https://api.github.com/users/ChrisDenton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6a92395197eb98b95d0a023dc41fe7a8b986baf5", "url": "https://api.github.com/repos/rust-lang/rust/commits/6a92395197eb98b95d0a023dc41fe7a8b986baf5", "html_url": "https://github.com/rust-lang/rust/commit/6a92395197eb98b95d0a023dc41fe7a8b986baf5"}], "stats": {"total": 46, "additions": 16, "deletions": 30}, "files": [{"sha": "909d9bf4093b36d6d4f7f93dd2f9bd43431d49ca", "filename": "library/std/src/fs/tests.rs", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/f7a132f4280cb8b01ba78126acc0cbea91951634/library%2Fstd%2Fsrc%2Ffs%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7a132f4280cb8b01ba78126acc0cbea91951634/library%2Fstd%2Fsrc%2Ffs%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Ffs%2Ftests.rs?ref=f7a132f4280cb8b01ba78126acc0cbea91951634", "patch": "@@ -1595,3 +1595,19 @@ fn test_read_dir_infinite_loop() {\n     // Check for duplicate errors\n     assert!(dir.filter(|e| e.is_err()).take(2).count() < 2);\n }\n+\n+#[test]\n+fn rename_directory() {\n+    let tmpdir = tmpdir();\n+    let old_path = tmpdir.join(\"foo/bar/baz\");\n+    fs::create_dir_all(&old_path).unwrap();\n+    let test_file = &old_path.join(\"temp.txt\");\n+\n+    File::create(test_file).unwrap();\n+\n+    let new_path = tmpdir.join(\"quux/blat\");\n+    fs::create_dir_all(&new_path).unwrap();\n+    fs::rename(&old_path, &new_path.join(\"newdir\")).unwrap();\n+    assert!(new_path.join(\"newdir\").is_dir());\n+    assert!(new_path.join(\"newdir/temp.txt\").exists());\n+}"}, {"sha": "8fc340cb9187214794c071230ae4f8eab2910baf", "filename": "tests/ui-fulldeps/std/rename-directory.rs", "status": "removed", "additions": 0, "deletions": 30, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/6a92395197eb98b95d0a023dc41fe7a8b986baf5/tests%2Fui-fulldeps%2Fstd%2Frename-directory.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a92395197eb98b95d0a023dc41fe7a8b986baf5/tests%2Fui-fulldeps%2Fstd%2Frename-directory.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui-fulldeps%2Fstd%2Frename-directory.rs?ref=6a92395197eb98b95d0a023dc41fe7a8b986baf5", "patch": "@@ -1,30 +0,0 @@\n-// run-pass\n-\n-#![allow(unused_must_use)]\n-#![allow(unused_imports)]\n-// This test can't be a unit test in std,\n-// because it needs TempDir, which is in extra\n-\n-// ignore-cross-compile\n-\n-use std::env;\n-use std::ffi::CString;\n-use std::fs::{self, File};\n-use std::path::PathBuf;\n-\n-fn rename_directory() {\n-    let tmpdir = PathBuf::from(env::var_os(\"RUST_TEST_TMPDIR\").unwrap());\n-    let old_path = tmpdir.join(\"foo/bar/baz\");\n-    fs::create_dir_all(&old_path).unwrap();\n-    let test_file = &old_path.join(\"temp.txt\");\n-\n-    File::create(test_file).unwrap();\n-\n-    let new_path = tmpdir.join(\"quux/blat\");\n-    fs::create_dir_all(&new_path).unwrap();\n-    fs::rename(&old_path, &new_path.join(\"newdir\"));\n-    assert!(new_path.join(\"newdir\").is_dir());\n-    assert!(new_path.join(\"newdir/temp.txt\").exists());\n-}\n-\n-pub fn main() { rename_directory() }"}]}