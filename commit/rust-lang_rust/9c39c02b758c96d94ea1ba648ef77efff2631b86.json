{"sha": "9c39c02b758c96d94ea1ba648ef77efff2631b86", "node_id": "MDY6Q29tbWl0NzI0NzEyOjljMzljMDJiNzU4Yzk2ZDk0ZWExYmE2NDhlZjc3ZWZmZjI2MzFiODY=", "commit": {"author": {"name": "Jeremy Stucki", "email": "jeremy@myelin.ch", "date": "2019-08-18T14:49:11Z"}, "committer": {"name": "Jeremy Stucki", "email": "jeremy@myelin.ch", "date": "2019-08-18T14:49:11Z"}, "message": "Change lint type to 'complexity'", "tree": {"sha": "a546460b21f16acfde97486b91f158216c03a49f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a546460b21f16acfde97486b91f158216c03a49f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9c39c02b758c96d94ea1ba648ef77efff2631b86", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEENfZy0Nd1FLYaZCRY7vypMUgEJlUFAl1ZZWcACgkQ7vypMUgE\nJlUi6g//VHuJFby46wxUqxa2FXb11gGgOlv0h01hdGLlNDUPhk/JcRpK1fJsMBV/\n5E+Qh7PYebNOx1/L1X0QSlacH9qSklkksYHwpL/0tPw9ftD8dSQlq31oH5lwoKXB\nYJT5ZTbK1ezqzU60lKecqEe2VxjVYGckltZAC5Y4pqSagf7dg5sqR2jDY/CBtG8O\na2jzaw+9VrTarj8//YHgtKJcK9uHh+KsAh1NviQaPSvCNhze0Dm80z2JptJ9w0ME\nIpsdak9cxhjvEktQk+tStUcfd99Z8uWpIHyfPkMWonD/Y0d7PprIoCjGPanGapTe\nLlxeb90QwPkK0GEc9Cp13S+O3jh9VMbmN5SB4FqC8LGjNWAI5hnKqisR73fs2yMc\nI/pnUKq+FuEYzx/VYeJcyTqXgNTKhfNEKD7arjx9lDpFKsYDQQX3ADs+n9OjmX82\nlACrEy7Cg15xMZoci+Fchd9vXCEE1qYJDzX1e+0LmWLljWaQQ+OP3RhLDNWGQzc7\nbofn0BkTwrS3C+UgpjakfZ8urXBnXWvjPJ69Jfjb3msgce8oOLZ9LEVFNhaLe6vu\nv8PZXYdmEiWKKJO5WmAZfLLiHqS/ati+Osfcp22rtw9B7TR8WEU2jpwWgutiS++1\nh8I0MHENJ8EtUCPHWwJd+2W9nFpSjWHzON1TpBCvbKCldxvWR8I=\n=d8oW\n-----END PGP SIGNATURE-----", "payload": "tree a546460b21f16acfde97486b91f158216c03a49f\nparent 5df84f219298026af02910a84e1f08ebd5ef3bbd\nauthor Jeremy Stucki <jeremy@myelin.ch> 1566139751 +0200\ncommitter Jeremy Stucki <jeremy@myelin.ch> 1566139751 +0200\n\nChange lint type to 'complexity'\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9c39c02b758c96d94ea1ba648ef77efff2631b86", "html_url": "https://github.com/rust-lang/rust/commit/9c39c02b758c96d94ea1ba648ef77efff2631b86", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9c39c02b758c96d94ea1ba648ef77efff2631b86/comments", "author": {"login": "jeremystucki", "id": 7629727, "node_id": "MDQ6VXNlcjc2Mjk3Mjc=", "avatar_url": "https://avatars.githubusercontent.com/u/7629727?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jeremystucki", "html_url": "https://github.com/jeremystucki", "followers_url": "https://api.github.com/users/jeremystucki/followers", "following_url": "https://api.github.com/users/jeremystucki/following{/other_user}", "gists_url": "https://api.github.com/users/jeremystucki/gists{/gist_id}", "starred_url": "https://api.github.com/users/jeremystucki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jeremystucki/subscriptions", "organizations_url": "https://api.github.com/users/jeremystucki/orgs", "repos_url": "https://api.github.com/users/jeremystucki/repos", "events_url": "https://api.github.com/users/jeremystucki/events{/privacy}", "received_events_url": "https://api.github.com/users/jeremystucki/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jeremystucki", "id": 7629727, "node_id": "MDQ6VXNlcjc2Mjk3Mjc=", "avatar_url": "https://avatars.githubusercontent.com/u/7629727?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jeremystucki", "html_url": "https://github.com/jeremystucki", "followers_url": "https://api.github.com/users/jeremystucki/followers", "following_url": "https://api.github.com/users/jeremystucki/following{/other_user}", "gists_url": "https://api.github.com/users/jeremystucki/gists{/gist_id}", "starred_url": "https://api.github.com/users/jeremystucki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jeremystucki/subscriptions", "organizations_url": "https://api.github.com/users/jeremystucki/orgs", "repos_url": "https://api.github.com/users/jeremystucki/repos", "events_url": "https://api.github.com/users/jeremystucki/events{/privacy}", "received_events_url": "https://api.github.com/users/jeremystucki/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5df84f219298026af02910a84e1f08ebd5ef3bbd", "url": "https://api.github.com/repos/rust-lang/rust/commits/5df84f219298026af02910a84e1f08ebd5ef3bbd", "html_url": "https://github.com/rust-lang/rust/commit/5df84f219298026af02910a84e1f08ebd5ef3bbd"}], "stats": {"total": 18, "additions": 11, "deletions": 7}, "files": [{"sha": "705ec2e9fd8e572b35fd05e5d9e307540003aba2", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9c39c02b758c96d94ea1ba648ef77efff2631b86/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9c39c02b758c96d94ea1ba648ef77efff2631b86/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=9c39c02b758c96d94ea1ba648ef77efff2631b86", "patch": "@@ -657,7 +657,6 @@ pub fn register_plugins(reg: &mut rustc_plugin::Registry<'_>, conf: &Conf) {\n         methods::OPTION_MAP_UNWRAP_OR,\n         methods::OPTION_MAP_UNWRAP_OR_ELSE,\n         methods::RESULT_MAP_UNWRAP_OR_ELSE,\n-        methods::SUSPICIOUS_MAP,\n         misc::USED_UNDERSCORE_BINDING,\n         misc_early::UNSEPARATED_LITERAL_SUFFIX,\n         mut_mut::MUT_MUT,\n@@ -801,6 +800,7 @@ pub fn register_plugins(reg: &mut rustc_plugin::Registry<'_>, conf: &Conf) {\n         methods::SHOULD_IMPLEMENT_TRAIT,\n         methods::SINGLE_CHAR_PATTERN,\n         methods::STRING_EXTEND_CHARS,\n+        methods::SUSPICIOUS_MAP,\n         methods::TEMPORARY_CSTRING_AS_PTR,\n         methods::UNNECESSARY_FILTER_MAP,\n         methods::UNNECESSARY_FOLD,\n@@ -1034,6 +1034,7 @@ pub fn register_plugins(reg: &mut rustc_plugin::Registry<'_>, conf: &Conf) {\n         methods::FILTER_NEXT,\n         methods::FLAT_MAP_IDENTITY,\n         methods::SEARCH_IS_SOME,\n+        methods::SUSPICIOUS_MAP,\n         methods::UNNECESSARY_FILTER_MAP,\n         methods::USELESS_ASREF,\n         misc::SHORT_CIRCUIT_STATEMENT,"}, {"sha": "c8e3ca14ab11622ad24461bb9d9faf7339bc21c5", "filename": "clippy_lints/src/methods/mod.rs", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/9c39c02b758c96d94ea1ba648ef77efff2631b86/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9c39c02b758c96d94ea1ba648ef77efff2631b86/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs?ref=9c39c02b758c96d94ea1ba648ef77efff2631b86", "patch": "@@ -18,7 +18,6 @@ use syntax::ast;\n use syntax::source_map::Span;\n use syntax::symbol::LocalInternedString;\n \n-use crate::utils::paths;\n use crate::utils::sugg;\n use crate::utils::usage::mutated_variables;\n use crate::utils::{\n@@ -28,6 +27,7 @@ use crate::utils::{\n     snippet, snippet_with_applicability, snippet_with_macro_callsite, span_lint, span_lint_and_sugg,\n     span_lint_and_then, span_note_and_lint, walk_ptrs_ty, walk_ptrs_ty_depth, SpanlessEq,\n };\n+use crate::utils::{paths, span_help_and_lint};\n \n declare_clippy_lint! {\n     /// **What it does:** Checks for `.unwrap()` calls on `Option`s.\n@@ -893,6 +893,7 @@ declare_clippy_lint! {\n     /// **What it does:** Checks for calls to `map` followed by a `count`.\n     ///\n     /// **Why is this bad?** It looks suspicious. Maybe `map` was confused with `filter`.\n+    /// If the `map` call is intentional, this should be rewritten.\n     ///\n     /// **Known problems:** None\n     ///\n@@ -902,7 +903,7 @@ declare_clippy_lint! {\n     /// let _ = (0..3).map(|x| x + 2).count();\n     /// ```\n     pub SUSPICIOUS_MAP,\n-    pedantic,\n+    complexity,\n     \"suspicious usage of map\"\n }\n \n@@ -2539,11 +2540,12 @@ fn lint_into_iter(cx: &LateContext<'_, '_>, expr: &hir::Expr, self_ref_ty: Ty<'_\n }\n \n fn lint_suspicious_map(cx: &LateContext<'_, '_>, expr: &hir::Expr) {\n-    span_lint(\n+    span_help_and_lint(\n         cx,\n         SUSPICIOUS_MAP,\n         expr.span,\n-        \"Make sure you did not confuse `map` with `filter`.\",\n+        \"this call to `map()` won't have an effect on the call to `count()`\",\n+        \"make sure you did not confuse `map` with `filter`\",\n     );\n }\n "}, {"sha": "ff7db0a3da77707dea29a33e4a3b0ed47e63641d", "filename": "src/lintlist/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9c39c02b758c96d94ea1ba648ef77efff2631b86/src%2Flintlist%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9c39c02b758c96d94ea1ba648ef77efff2631b86/src%2Flintlist%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flintlist%2Fmod.rs?ref=9c39c02b758c96d94ea1ba648ef77efff2631b86", "patch": "@@ -1738,7 +1738,7 @@ pub const ALL_LINTS: [Lint; 310] = [\n     },\n     Lint {\n         name: \"suspicious_map\",\n-        group: \"pedantic\",\n+        group: \"complexity\",\n         desc: \"suspicious usage of map\",\n         deprecation: None,\n         module: \"methods\","}, {"sha": "e6588f4691a1e53a8f96c6d00e3d1f33d503a32c", "filename": "tests/ui/suspicious_map.stderr", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9c39c02b758c96d94ea1ba648ef77efff2631b86/tests%2Fui%2Fsuspicious_map.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/9c39c02b758c96d94ea1ba648ef77efff2631b86/tests%2Fui%2Fsuspicious_map.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuspicious_map.stderr?ref=9c39c02b758c96d94ea1ba648ef77efff2631b86", "patch": "@@ -1,10 +1,11 @@\n-error: Make sure you did not confuse `map` with `filter`.\n+error: this call to `map()` won't have an effect on the call to `count()`\n   --> $DIR/suspicious_map.rs:4:13\n    |\n LL |     let _ = (0..3).map(|x| x + 2).count();\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n    = note: `-D clippy::suspicious-map` implied by `-D warnings`\n+   = help: make sure you did not confuse `map` with `filter`\n \n error: aborting due to previous error\n "}]}