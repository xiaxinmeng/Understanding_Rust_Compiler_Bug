{"sha": "327d8073e2a7939e12676940fc4847ca78be3f84", "node_id": "C_kwDOAAsO6NoAKDMyN2Q4MDczZTJhNzkzOWUxMjY3Njk0MGZjNDg0N2NhNzhiZTNmODQ", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2021-10-22T10:42:46Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-10-22T10:42:46Z"}, "message": "Rollup merge of #89922 - JohnTitor:update-e0637, r=jackh726\n\nUpdate E0637 description to mention `&` w/o an explicit lifetime name\n\nDeal with https://github.com/rust-lang/rust/issues/89824#issuecomment-941598647. Another solution would be splitting the error code into two as (I think) it's a bit unclear to users why they have the same error code.", "tree": {"sha": "6dfca2ce9d053e49a35d04939e9e8091d334ba1e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6dfca2ce9d053e49a35d04939e9e8091d334ba1e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/327d8073e2a7939e12676940fc4847ca78be3f84", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhcpWmCRBK7hj4Ov3rIwAATRIIACVWJ4GBzQ5KV8of4W/qLqnd\nK3PEMMaX7P2gCRk0gEsl34wvSbvaJxL6x2NYxW9y997LuN88oevg4Ao0nY738uM6\nfyh6ZhLoxyW2X4rJVTpVjbI3KnmJkP3/QGZ5ZLBqe7XM1XpGnxjMIXpkfhQ2kzPb\n46Gk9MKszrwdrO0GXtFGeaIu4vVKH2Z0nOL+jI4u1QJZ8RrWPQR7CGt5Qly9/zak\n68jxsqXeLOzvo+0QPgZ+zQwlIRiY13oNSK7xKi2cT6LLv6JSashettRKPD4vW1q1\nsBx+43PCC7yHu+PLO1L1AOLjYT7Na6bg7lMs17hpsxBSnWicgwSowc61ZWGa2A8=\n=B+7t\n-----END PGP SIGNATURE-----\n", "payload": "tree 6dfca2ce9d053e49a35d04939e9e8091d334ba1e\nparent 91fb223f5913ff44902e818c8d26b6bf06e666b6\nparent 43330916251221764c28e6bc650f01be8713b79b\nauthor Yuki Okushi <jtitor@2k36.org> 1634899366 +0900\ncommitter GitHub <noreply@github.com> 1634899366 +0900\n\nRollup merge of #89922 - JohnTitor:update-e0637, r=jackh726\n\nUpdate E0637 description to mention `&` w/o an explicit lifetime name\n\nDeal with https://github.com/rust-lang/rust/issues/89824#issuecomment-941598647. Another solution would be splitting the error code into two as (I think) it's a bit unclear to users why they have the same error code.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/327d8073e2a7939e12676940fc4847ca78be3f84", "html_url": "https://github.com/rust-lang/rust/commit/327d8073e2a7939e12676940fc4847ca78be3f84", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/327d8073e2a7939e12676940fc4847ca78be3f84/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "91fb223f5913ff44902e818c8d26b6bf06e666b6", "url": "https://api.github.com/repos/rust-lang/rust/commits/91fb223f5913ff44902e818c8d26b6bf06e666b6", "html_url": "https://github.com/rust-lang/rust/commit/91fb223f5913ff44902e818c8d26b6bf06e666b6"}, {"sha": "43330916251221764c28e6bc650f01be8713b79b", "url": "https://api.github.com/repos/rust-lang/rust/commits/43330916251221764c28e6bc650f01be8713b79b", "html_url": "https://github.com/rust-lang/rust/commit/43330916251221764c28e6bc650f01be8713b79b"}], "stats": {"total": 85, "additions": 58, "deletions": 27}, "files": [{"sha": "62d5565df27989e3b2fa667b0e701dff7ddaa3c0", "filename": "compiler/rustc_error_codes/src/error_codes/E0637.md", "status": "modified", "additions": 26, "deletions": 10, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/327d8073e2a7939e12676940fc4847ca78be3f84/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0637.md", "raw_url": "https://github.com/rust-lang/rust/raw/327d8073e2a7939e12676940fc4847ca78be3f84/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0637.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0637.md?ref=327d8073e2a7939e12676940fc4847ca78be3f84", "patch": "@@ -1,35 +1,51 @@\n-An underscore `_` character has been used as the identifier for a lifetime.\n+`'_` lifetime name or `&T` without an explicit lifetime name has been used\n+on illegal place.\n \n Erroneous code example:\n \n ```compile_fail,E0106,E0637\n-fn longest<'_>(str1: &'_ str, str2: &'_ str) -> &'_ str {\n-         //^^ `'_` is a reserved lifetime name\n+fn underscore_lifetime<'_>(str1: &'_ str, str2: &'_ str) -> &'_ str {\n+                     //^^ `'_` is a reserved lifetime name\n     if str1.len() > str2.len() {\n         str1\n     } else {\n         str2\n     }\n }\n+\n+fn and_without_explicit_lifetime<T>()\n+where\n+    T: Into<&u32>,\n+          //^ `&` without an explicit lifetime name\n+{\n+}\n ```\n \n-`'_`, cannot be used as a lifetime identifier because it is a reserved for the\n-anonymous lifetime. To fix this, use a lowercase letter such as 'a, or a series\n-of lowercase letters such as `'foo`.  For more information, see [the\n-book][bk-no].  For more information on using the anonymous lifetime in rust\n-nightly, see [the nightly book][bk-al].\n+First, `'_` cannot be used as a lifetime identifier in some places\n+because it is a reserved for the anonymous lifetime. Second, `&T`\n+without an explicit lifetime name cannot also be used in some places.\n+To fix them, use a lowercase letter such as `'a`, or a series\n+of lowercase letters such as `'foo`. For more information about lifetime\n+identifier, see [the book][bk-no]. For more information on using\n+the anonymous lifetime in Rust 2018, see [the Rust 2018 blog post][blog-al].\n \n Corrected example:\n \n ```\n-fn longest<'a>(str1: &'a str, str2: &'a str) -> &'a str {\n+fn underscore_lifetime<'a>(str1: &'a str, str2: &'a str) -> &'a str {\n     if str1.len() > str2.len() {\n         str1\n     } else {\n         str2\n     }\n }\n+\n+fn and_without_explicit_lifetime<'foo, T>()\n+where\n+    T: Into<&'foo u32>,\n+{\n+}\n ```\n \n [bk-no]: https://doc.rust-lang.org/book/appendix-02-operators.html#non-operator-symbols\n-[bk-al]: https://doc.rust-lang.org/nightly/edition-guide/rust-2018/ownership-and-lifetimes/the-anonymous-lifetime.html\n+[blog-al]: https://blog.rust-lang.org/2018/12/06/Rust-1.31-and-rust-2018.html#more-lifetime-elision-rules"}, {"sha": "382ce3ed01f34d4a0c16ded758903db59c287daa", "filename": "src/test/ui/error-codes/E0637.rs", "status": "modified", "additions": 13, "deletions": 5, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/327d8073e2a7939e12676940fc4847ca78be3f84/src%2Ftest%2Fui%2Ferror-codes%2FE0637.rs", "raw_url": "https://github.com/rust-lang/rust/raw/327d8073e2a7939e12676940fc4847ca78be3f84/src%2Ftest%2Fui%2Ferror-codes%2FE0637.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0637.rs?ref=327d8073e2a7939e12676940fc4847ca78be3f84", "patch": "@@ -1,9 +1,17 @@\n-struct Foo<'a: '_>(&'a u8); //~ ERROR cannot be used here\n-fn foo<'a: '_>(_: &'a u8) {} //~ ERROR cannot be used here\n+fn underscore_lifetime<'_>(str1: &'_ str, str2: &'_ str) -> &'_ str {\n+    //~^ ERROR: `'_` cannot be used here [E0637]\n+    //~| ERROR: missing lifetime specifier\n+    if str1.len() > str2.len() {\n+        str1\n+    } else {\n+        str2\n+    }\n+}\n \n-struct Bar<'a>(&'a u8);\n-impl<'a: '_> Bar<'a> { //~ ERROR cannot be used here\n-  fn bar() {}\n+fn and_without_explicit_lifetime<T>()\n+where\n+    T: Into<&u32>, //~ ERROR: `&` without an explicit lifetime name cannot be used here [E0637]\n+{\n }\n \n fn main() {}"}, {"sha": "87aaba65a73adc431a8f24e3787ddda67edb05b2", "filename": "src/test/ui/error-codes/E0637.stderr", "status": "modified", "additions": 19, "deletions": 12, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/327d8073e2a7939e12676940fc4847ca78be3f84/src%2Ftest%2Fui%2Ferror-codes%2FE0637.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/327d8073e2a7939e12676940fc4847ca78be3f84/src%2Ftest%2Fui%2Ferror-codes%2FE0637.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0637.stderr?ref=327d8073e2a7939e12676940fc4847ca78be3f84", "patch": "@@ -1,21 +1,28 @@\n error[E0637]: `'_` cannot be used here\n-  --> $DIR/E0637.rs:1:16\n+  --> $DIR/E0637.rs:1:24\n    |\n-LL | struct Foo<'a: '_>(&'a u8);\n-   |                ^^ `'_` is a reserved lifetime name\n+LL | fn underscore_lifetime<'_>(str1: &'_ str, str2: &'_ str) -> &'_ str {\n+   |                        ^^ `'_` is a reserved lifetime name\n \n-error[E0637]: `'_` cannot be used here\n-  --> $DIR/E0637.rs:2:12\n+error[E0637]: `&` without an explicit lifetime name cannot be used here\n+  --> $DIR/E0637.rs:13:13\n    |\n-LL | fn foo<'a: '_>(_: &'a u8) {}\n-   |            ^^ `'_` is a reserved lifetime name\n+LL |     T: Into<&u32>,\n+   |             ^ explicit lifetime name needed here\n \n-error[E0637]: `'_` cannot be used here\n-  --> $DIR/E0637.rs:5:10\n+error[E0106]: missing lifetime specifier\n+  --> $DIR/E0637.rs:1:62\n+   |\n+LL | fn underscore_lifetime<'_>(str1: &'_ str, str2: &'_ str) -> &'_ str {\n+   |                                  -------        -------      ^^ expected named lifetime parameter\n+   |\n+   = help: this function's return type contains a borrowed value, but the signature does not say whether it is borrowed from `str1` or `str2`\n+help: consider introducing a named lifetime parameter\n    |\n-LL | impl<'a: '_> Bar<'a> {\n-   |          ^^ `'_` is a reserved lifetime name\n+LL | fn underscore_lifetime<'a, '_>(str1: &'a str, str2: &'a str) -> &'a str {\n+   |                        +++            ~~             ~~          ~~\n \n error: aborting due to 3 previous errors\n \n-For more information about this error, try `rustc --explain E0637`.\n+Some errors have detailed explanations: E0106, E0637.\n+For more information about an error, try `rustc --explain E0106`."}]}