{"sha": "3ceae8db47ec82774df29c45b2d89d379bfd1676", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNjZWFlOGRiNDdlYzgyNzc0ZGYyOWM0NWIyZDg5ZDM3OWJmZDE2NzY=", "commit": {"author": {"name": "Igor Matuszewski", "email": "Xanewok@gmail.com", "date": "2018-09-24T14:53:49Z"}, "committer": {"name": "Igor Matuszewski", "email": "Xanewok@gmail.com", "date": "2018-09-27T23:54:01Z"}, "message": "Also remap absolute source names in save-analysis", "tree": {"sha": "cc12befd50606f36e9ae9c7639ea6dcd200ff3be", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cc12befd50606f36e9ae9c7639ea6dcd200ff3be"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3ceae8db47ec82774df29c45b2d89d379bfd1676", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3ceae8db47ec82774df29c45b2d89d379bfd1676", "html_url": "https://github.com/rust-lang/rust/commit/3ceae8db47ec82774df29c45b2d89d379bfd1676", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3ceae8db47ec82774df29c45b2d89d379bfd1676/comments", "author": {"login": "Xanewok", "id": 3093213, "node_id": "MDQ6VXNlcjMwOTMyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3093213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Xanewok", "html_url": "https://github.com/Xanewok", "followers_url": "https://api.github.com/users/Xanewok/followers", "following_url": "https://api.github.com/users/Xanewok/following{/other_user}", "gists_url": "https://api.github.com/users/Xanewok/gists{/gist_id}", "starred_url": "https://api.github.com/users/Xanewok/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Xanewok/subscriptions", "organizations_url": "https://api.github.com/users/Xanewok/orgs", "repos_url": "https://api.github.com/users/Xanewok/repos", "events_url": "https://api.github.com/users/Xanewok/events{/privacy}", "received_events_url": "https://api.github.com/users/Xanewok/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Xanewok", "id": 3093213, "node_id": "MDQ6VXNlcjMwOTMyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3093213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Xanewok", "html_url": "https://github.com/Xanewok", "followers_url": "https://api.github.com/users/Xanewok/followers", "following_url": "https://api.github.com/users/Xanewok/following{/other_user}", "gists_url": "https://api.github.com/users/Xanewok/gists{/gist_id}", "starred_url": "https://api.github.com/users/Xanewok/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Xanewok/subscriptions", "organizations_url": "https://api.github.com/users/Xanewok/orgs", "repos_url": "https://api.github.com/users/Xanewok/repos", "events_url": "https://api.github.com/users/Xanewok/events{/privacy}", "received_events_url": "https://api.github.com/users/Xanewok/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "24123ddea90411851fa69a33369f3e4130ccf831", "url": "https://api.github.com/repos/rust-lang/rust/commits/24123ddea90411851fa69a33369f3e4130ccf831", "html_url": "https://github.com/rust-lang/rust/commit/24123ddea90411851fa69a33369f3e4130ccf831"}], "stats": {"total": 17, "additions": 12, "deletions": 5}, "files": [{"sha": "47677a751712e9ccf837b92df268e7f3ca4d6380", "filename": "src/librustc_save_analysis/span_utils.rs", "status": "modified", "additions": 12, "deletions": 5, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/3ceae8db47ec82774df29c45b2d89d379bfd1676/src%2Flibrustc_save_analysis%2Fspan_utils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ceae8db47ec82774df29c45b2d89d379bfd1676/src%2Flibrustc_save_analysis%2Fspan_utils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_save_analysis%2Fspan_utils.rs?ref=3ceae8db47ec82774df29c45b2d89d379bfd1676", "patch": "@@ -37,11 +37,18 @@ impl<'a> SpanUtils<'a> {\n \n     pub fn make_filename_string(&self, file: &SourceFile) -> String {\n         match &file.name {\n-            FileName::Real(path) if !path.is_absolute() && !file.name_was_remapped => {\n-                self.sess.working_dir.0\n-                    .join(&path)\n-                    .display()\n-                    .to_string()\n+            FileName::Real(path) if !file.name_was_remapped => {\n+                if path.is_absolute() {\n+                    self.sess.source_map().path_mapping()\n+                        .map_prefix(path.clone()).0\n+                        .display()\n+                        .to_string()\n+                } else {\n+                    self.sess.working_dir.0\n+                        .join(&path)\n+                        .display()\n+                        .to_string()\n+                }\n             },\n             // If the file name is already remapped, we assume the user\n             // configured it the way they wanted to, so use that directly"}]}