{"sha": "f10fbbbd534e459f98a3337d1f0bf2b23d607906", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYxMGZiYmJkNTM0ZTQ1OWY5OGEzMzM3ZDFmMGJmMmIyM2Q2MDc5MDY=", "commit": {"author": {"name": "Ricky (deg4uss3r)", "email": "ricky@hosfelt.io", "date": "2021-02-04T14:26:02Z"}, "committer": {"name": "Ricky (deg4uss3r)", "email": "ricky@hosfelt.io", "date": "2021-02-19T18:17:05Z"}, "message": "added aarch64_apple_ios_sim as a rustc target", "tree": {"sha": "1ca30d6d35df283328099dabfdf0fe2d3e05ad48", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1ca30d6d35df283328099dabfdf0fe2d3e05ad48"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f10fbbbd534e459f98a3337d1f0bf2b23d607906", "comment_count": 0, "verification": {"verified": false, "reason": "no_user", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEc+Brv20PPwCixFgENuyYqioGShwFAmAwAKEACgkQNuyYqioG\nShxm6RAAk9UThRrHr++fihPdpJz4qH5As0yf6SjTZYeGMgcF+6CnJfUOMi1iKnbH\nlm1vHJGvKEboIY6JtmBvGkfewOW9QFlaeMUmVT5oom0ukmtL1uM5PrI6cN6a17Fb\nu04q4GYsJ857pra3MXvCNS+UQhdYa9jxzIj0XGGdg6/rcpkOZ8n7FQVrP7iEbHnL\n2BvPkXWrTgBeXqap+p4Fv12wMY+3Mdfhazf9NAmYzxR1UKKtUWHyi8ByGXUZvl0W\nZr0ClLrm+NeVa+tK4eF2RWg786KZXSgpQV4zhVtNa4Eey9sQPgfzt0yGd610mkya\nzBPcIh9evdALRmYLktpPQRDkVdq9yCob+A+uvBKvr00zZO35ScLnDKPWS6BBnV/t\nCDs0s5iM88tNy0OeBKvd1g6cESJB3uHdRuTciqkvuno9q6BA2aOJ3DrlDFebYdK6\nJlOMrQZ9AITcTSQgvCjCSr5b00y45F4ZlUqX2cdoA4ycK7nAvpmZVl/bmtaMzEMY\nA0DyEureQtmPex1EiOEtTxQ8btS3kJMxkX15G0RWQc9BXSHKiBTWYTx1bPR4TxBq\ngN0o4HkJyjzzLWsCrZ24QpPFC1Vs/ac+skZKlL2w4pq6MSV84Hg1/PjrOb+gv1WP\n4saR/HTD+qWsQuT8TT8mLrY9UhPJNzG1bIacZQ6CV8TyyuDLaDk=\n=DYnD\n-----END PGP SIGNATURE-----", "payload": "tree 1ca30d6d35df283328099dabfdf0fe2d3e05ad48\nparent e708cbd91c9cae4426d69270248362b423324556\nauthor Ricky (deg4uss3r) <ricky@hosfelt.io> 1612448762 -0500\ncommitter Ricky (deg4uss3r) <ricky@hosfelt.io> 1613758625 -0500\n\nadded aarch64_apple_ios_sim as a rustc target\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f10fbbbd534e459f98a3337d1f0bf2b23d607906", "html_url": "https://github.com/rust-lang/rust/commit/f10fbbbd534e459f98a3337d1f0bf2b23d607906", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f10fbbbd534e459f98a3337d1f0bf2b23d607906/comments", "author": null, "committer": null, "parents": [{"sha": "e708cbd91c9cae4426d69270248362b423324556", "url": "https://api.github.com/repos/rust-lang/rust/commits/e708cbd91c9cae4426d69270248362b423324556", "html_url": "https://github.com/rust-lang/rust/commit/e708cbd91c9cae4426d69270248362b423324556"}], "stats": {"total": 40, "additions": 39, "deletions": 1}, "files": [{"sha": "b5339b455ac92c8917845d9e9ed9c758284bf616", "filename": "compiler/rustc_codegen_ssa/src/back/link.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f10fbbbd534e459f98a3337d1f0bf2b23d607906/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f10fbbbd534e459f98a3337d1f0bf2b23d607906/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Flink.rs?ref=f10fbbbd534e459f98a3337d1f0bf2b23d607906", "patch": "@@ -2187,6 +2187,7 @@ fn add_apple_sdk(cmd: &mut dyn Linker, sess: &Session, flavor: LinkerFlavor) {\n         (\"x86_64\", \"tvos\") => \"appletvsimulator\",\n         (\"arm\", \"ios\") => \"iphoneos\",\n         (\"aarch64\", \"ios\") if llvm_target.contains(\"macabi\") => \"macosx\",\n+        (\"aarch64\", \"ios\") if llvm_target.contains(\"sim\") => \"iphonesimulator\",\n         (\"aarch64\", \"ios\") => \"iphoneos\",\n         (\"x86\", \"ios\") => \"iphonesimulator\",\n         (\"x86_64\", \"ios\") if llvm_target.contains(\"macabi\") => \"macosx\","}, {"sha": "de4c6b44368da1206557f4f3e5336a1eb28e0766", "filename": "compiler/rustc_target/src/spec/aarch64_apple_ios_sim.rs", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/f10fbbbd534e459f98a3337d1f0bf2b23d607906/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_apple_ios_sim.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f10fbbbd534e459f98a3337d1f0bf2b23d607906/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_apple_ios_sim.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_apple_ios_sim.rs?ref=f10fbbbd534e459f98a3337d1f0bf2b23d607906", "patch": "@@ -0,0 +1,31 @@\n+use super::apple_sdk_base::{opts, Arch};\n+use crate::spec::{Target, TargetOptions};\n+\n+pub fn target() -> Target {\n+    let base = opts(\"ios\", Arch::Arm64_sim);\n+    Target {\n+        llvm_target: \"arm64-apple-ios-simulator\".to_string(),\n+        pointer_width: 64,\n+        data_layout: \"e-m:o-i64:64-i128:128-n32:64-S128\".to_string(),\n+        arch: \"aarch64\".to_string(),\n+        options: TargetOptions {\n+            features: \"+neon,+fp-armv8,+apple-a7\".to_string(),\n+            eliminate_frame_pointer: false,\n+            max_atomic_width: Some(128),\n+            unsupported_abis: super::arm_base::unsupported_abis(),\n+            forces_embed_bitcode: true,\n+            // Taken from a clang build on Xcode 11.4.1.\n+            // These arguments are not actually invoked - they just have\n+            // to look right to pass App Store validation.\n+            bitcode_llvm_cmdline: \"-triple\\0\\\n+                arm64-apple-ios14.0-simulator\\0\\\n+                -emit-obj\\0\\\n+                -disable-llvm-passes\\0\\\n+                -target-abi\\0\\\n+                darwinpcs\\0\\\n+                -Os\\0\"\n+                .to_string(),\n+            ..base\n+        },\n+    }\n+}"}, {"sha": "538c4ca86974f9e8c71835eaed9e3c74e98fbc60", "filename": "compiler/rustc_target/src/spec/apple_sdk_base.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/f10fbbbd534e459f98a3337d1f0bf2b23d607906/compiler%2Frustc_target%2Fsrc%2Fspec%2Fapple_sdk_base.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f10fbbbd534e459f98a3337d1f0bf2b23d607906/compiler%2Frustc_target%2Fsrc%2Fspec%2Fapple_sdk_base.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Fapple_sdk_base.rs?ref=f10fbbbd534e459f98a3337d1f0bf2b23d607906", "patch": "@@ -11,6 +11,7 @@ pub enum Arch {\n     X86_64,\n     X86_64_macabi,\n     Arm64_macabi,\n+    Arm64_sim,\n }\n \n fn target_cpu(arch: Arch) -> String {\n@@ -22,13 +23,16 @@ fn target_cpu(arch: Arch) -> String {\n         X86_64 => \"core2\",\n         X86_64_macabi => \"core2\",\n         Arm64_macabi => \"apple-a12\",\n+        Arm64_sim => \"apple-a12\",\n     }\n     .to_string()\n }\n \n fn link_env_remove(arch: Arch) -> Vec<String> {\n     match arch {\n-        Armv7 | Armv7s | Arm64 | I386 | X86_64 => vec![\"MACOSX_DEPLOYMENT_TARGET\".to_string()],\n+        Armv7 | Armv7s | Arm64 | I386 | X86_64 | Arm64_sim => {\n+            vec![\"MACOSX_DEPLOYMENT_TARGET\".to_string()]\n+        }\n         X86_64_macabi | Arm64_macabi => vec![\"IPHONEOS_DEPLOYMENT_TARGET\".to_string()],\n     }\n }"}, {"sha": "962374a21b2c7b25b9d8796cd8bdc3bed00e33b3", "filename": "compiler/rustc_target/src/spec/mod.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f10fbbbd534e459f98a3337d1f0bf2b23d607906/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f10fbbbd534e459f98a3337d1f0bf2b23d607906/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs?ref=f10fbbbd534e459f98a3337d1f0bf2b23d607906", "patch": "@@ -727,6 +727,7 @@ supported_targets! {\n     (\"armv7s-apple-ios\", armv7s_apple_ios),\n     (\"x86_64-apple-ios-macabi\", x86_64_apple_ios_macabi),\n     (\"aarch64-apple-ios-macabi\", aarch64_apple_ios_macabi),\n+    (\"aarch64-apple-ios-sim\", aarch64_apple_ios_sim),\n     (\"aarch64-apple-tvos\", aarch64_apple_tvos),\n     (\"x86_64-apple-tvos\", x86_64_apple_tvos),\n "}, {"sha": "641650b5b0942166238acfc8d13f8bcccc78b731", "filename": "src/doc/rustc/src/platform-support.md", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f10fbbbd534e459f98a3337d1f0bf2b23d607906/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md", "raw_url": "https://github.com/rust-lang/rust/raw/f10fbbbd534e459f98a3337d1f0bf2b23d607906/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md?ref=f10fbbbd534e459f98a3337d1f0bf2b23d607906", "patch": "@@ -153,6 +153,7 @@ not available.\n target | std | host | notes\n -------|-----|------|-------\n `aarch64-apple-ios-macabi` | ? |  | Apple Catalyst on ARM64\n+`aarch64-apple-ios-sim` | ? |  | Apple iOS Simulator on  ARM64\n `aarch64-apple-tvos` | * |  | ARM64 tvOS\n `aarch64-unknown-freebsd` | \u2713 | \u2713 | ARM64 FreeBSD\n `aarch64-unknown-hermit` | ? |  |"}]}