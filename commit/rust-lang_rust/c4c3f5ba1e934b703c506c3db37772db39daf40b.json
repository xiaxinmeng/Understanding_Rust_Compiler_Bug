{"sha": "c4c3f5ba1e934b703c506c3db37772db39daf40b", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM0YzNmNWJhMWU5MzRiNzAzYzUwNmMzZGIzNzc3MmRiMzlkYWY0MGI=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2017-12-05T03:55:31Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-12-05T03:55:31Z"}, "message": "Merge pull request #2238 from topecongiro/issue-1209\n\nFormat a macro in the type position", "tree": {"sha": "b68aafae94ce19dcdc496a5b3826be82117c27b7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b68aafae94ce19dcdc496a5b3826be82117c27b7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c4c3f5ba1e934b703c506c3db37772db39daf40b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJaJhizCRBK7hj4Ov3rIwAAdHIIAEq4IuDVF+sqmf1MliR9QxmX\nYGBb3BDGoxD55vp0W+L+dZ/4Hu0wSUXWov0qzXrmzucIVZNwRLe+v9wQSET8WlI0\nwgRoo92K+Us5Vnl10eoXN2cOK5cnZUC8ENNZLbZb5274lkMIkpZboXwsI40NkqCZ\nS5NSwB6koCGoZeZESDWPti1VXicMFUu3OeZdpu0Ur1zfmx0w+tqfPyd7Xhy6K7+T\nJ+WNY26YblSgni0GR4ZMGx6LiOATfNSFf+6vzqFdjLkAZ8OlDk/5wu91NXSRf9ru\nS/G/5xnO0FmWo5EC8z0NVau9D2V2ZFsy2YjwbLUr6r42pY8/ShnBj8h7fVmiIik=\n=rSka\n-----END PGP SIGNATURE-----\n", "payload": "tree b68aafae94ce19dcdc496a5b3826be82117c27b7\nparent 38d2fb4ed60cd868e7d150a7b1e291efaddd6257\nparent 289b5f4c21dcac521ab344d32c4d8e3ef170e387\nauthor Nick Cameron <nrc@ncameron.org> 1512446131 +1300\ncommitter GitHub <noreply@github.com> 1512446131 +1300\n\nMerge pull request #2238 from topecongiro/issue-1209\n\nFormat a macro in the type position"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c4c3f5ba1e934b703c506c3db37772db39daf40b", "html_url": "https://github.com/rust-lang/rust/commit/c4c3f5ba1e934b703c506c3db37772db39daf40b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c4c3f5ba1e934b703c506c3db37772db39daf40b/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "38d2fb4ed60cd868e7d150a7b1e291efaddd6257", "url": "https://api.github.com/repos/rust-lang/rust/commits/38d2fb4ed60cd868e7d150a7b1e291efaddd6257", "html_url": "https://github.com/rust-lang/rust/commit/38d2fb4ed60cd868e7d150a7b1e291efaddd6257"}, {"sha": "289b5f4c21dcac521ab344d32c4d8e3ef170e387", "url": "https://api.github.com/repos/rust-lang/rust/commits/289b5f4c21dcac521ab344d32c4d8e3ef170e387", "html_url": "https://github.com/rust-lang/rust/commit/289b5f4c21dcac521ab344d32c4d8e3ef170e387"}], "stats": {"total": 19, "additions": 17, "deletions": 2}, "files": [{"sha": "88f9dba5c3f0c4ccb00b7735081cbf48c58c364d", "filename": "src/types.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/c4c3f5ba1e934b703c506c3db37772db39daf40b/src%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c4c3f5ba1e934b703c506c3db37772db39daf40b/src%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftypes.rs?ref=c4c3f5ba1e934b703c506c3db37772db39daf40b", "patch": "@@ -23,6 +23,7 @@ use expr::{rewrite_pair, rewrite_tuple, rewrite_unary_prefix, wrap_args_with_par\n use items::{format_generics_item_list, generics_shape_from_config};\n use lists::{definitive_tactic, itemize_list, write_list, ListFormatting, ListTactic, Separator,\n             SeparatorPlace, SeparatorTactic};\n+use macros::{rewrite_macro, MacroPosition};\n use rewrite::{Rewrite, RewriteContext};\n use shape::Shape;\n use utils::{colon_spaces, extra_offset, first_line_width, format_abi, format_mutability,\n@@ -726,7 +727,9 @@ impl Rewrite for ast::Ty {\n             }\n             ast::TyKind::BareFn(ref bare_fn) => rewrite_bare_fn(bare_fn, self.span, context, shape),\n             ast::TyKind::Never => Some(String::from(\"!\")),\n-            ast::TyKind::Mac(..) => None,\n+            ast::TyKind::Mac(ref mac) => {\n+                rewrite_macro(mac, None, context, shape, MacroPosition::Expression)\n+            }\n             ast::TyKind::ImplicitSelf => Some(String::from(\"\")),\n             ast::TyKind::ImplTrait(ref it) => it.rewrite(context, shape)\n                 .map(|it_str| format!(\"impl {}\", it_str)),"}, {"sha": "c282497960a366313f999047d66e489589464775", "filename": "tests/source/macros.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/c4c3f5ba1e934b703c506c3db37772db39daf40b/tests%2Fsource%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c4c3f5ba1e934b703c506c3db37772db39daf40b/tests%2Fsource%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fmacros.rs?ref=c4c3f5ba1e934b703c506c3db37772db39daf40b", "patch": "@@ -224,3 +224,9 @@ fn special_case_macros() {\n     // assert!\n     assert!(result, \"Arr! While plunderin' the hold, we got '{}' when given '{}' (we expected '{}')\", result, input, expected);\n }\n+\n+// #1209\n+impl Foo {\n+    /// foo\n+    pub fn foo(&self) -> Bar<foo!(   )> {}\n+}"}, {"sha": "df358a1b1b5f0df68d4d50bcd875945e20635939", "filename": "tests/target/macros.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/c4c3f5ba1e934b703c506c3db37772db39daf40b/tests%2Ftarget%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c4c3f5ba1e934b703c506c3db37772db39daf40b/tests%2Ftarget%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fmacros.rs?ref=c4c3f5ba1e934b703c506c3db37772db39daf40b", "patch": "@@ -121,7 +121,7 @@ fn main() {\n         20, 21, 22);\n \n     // #1092\n-    chain!(input, a:take!(max_size), || []);\n+    chain!(input, a: take!(max_size), || []);\n }\n \n impl X {\n@@ -284,3 +284,9 @@ fn special_case_macros() {\n         result, input, expected\n     );\n }\n+\n+// #1209\n+impl Foo {\n+    /// foo\n+    pub fn foo(&self) -> Bar<foo!()> {}\n+}"}]}