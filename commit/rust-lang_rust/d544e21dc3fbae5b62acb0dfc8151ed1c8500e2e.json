{"sha": "d544e21dc3fbae5b62acb0dfc8151ed1c8500e2e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ1NDRlMjFkYzNmYmFlNWI2MmFjYjBkZmM4MTUxZWQxYzg1MDBlMmU=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2020-08-02T00:42:16Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-08-02T00:42:16Z"}, "message": "Rollup merge of #75015 - Amanieu:vec_spare, r=sfackler\n\nAdd Vec::spare_capacity_mut\n\nReturns the remaining spare capacity of the vector as a slice of `MaybeUninit<T>`.\n\nAs suggested by @sfackler in https://github.com/rust-lang/rust/pull/70967#issuecomment-612659006.\n\nr? @sfackler", "tree": {"sha": "5dee9089e4c8af671738694f34ec8041dc8caaa6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5dee9089e4c8af671738694f34ec8041dc8caaa6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d544e21dc3fbae5b62acb0dfc8151ed1c8500e2e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfJgvoCRBK7hj4Ov3rIwAAdHIIAArP0JKqPzbw4b/7VaKK4nff\nkPLEa8j+jK4gjk+ZEAqXlh/FGaswFb4TlW+nkJ3RbefmkyueB5X14MtCA/VOxQYq\nKsrMGxdti3KCOnR6kS8QXN1beGS9dwgtC54gzO/EhHmeamUNA8EtWA1fGdat9v86\n9+oZ1Vr4nUoBwsytUYQowKpSBDCI6m8gxW6w3LK8xoEEiGxgoKoRAUjxkFgpTQfM\n0kL7XU4sHG00pjPVj87ROIrzd8zRoZo14mh+McSoJq05ejvQczT7gv/Fm8gLTrN8\nuaF5XwRDJmzHSHsEtWV+yqNuYBq8BH/+UuJAdYrLIpzPaGiik+A+TCdJQyIPLmU=\n=H39X\n-----END PGP SIGNATURE-----\n", "payload": "tree 5dee9089e4c8af671738694f34ec8041dc8caaa6\nparent 98a9397c2a0197ebed190baa20b6111cb40edaa2\nparent df3a30aee4fe514c1fd1193d3a7e739b1a66ab8f\nauthor Manish Goregaokar <manishsmail@gmail.com> 1596328936 -0700\ncommitter GitHub <noreply@github.com> 1596328936 -0700\n\nRollup merge of #75015 - Amanieu:vec_spare, r=sfackler\n\nAdd Vec::spare_capacity_mut\n\nReturns the remaining spare capacity of the vector as a slice of `MaybeUninit<T>`.\n\nAs suggested by @sfackler in https://github.com/rust-lang/rust/pull/70967#issuecomment-612659006.\n\nr? @sfackler\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d544e21dc3fbae5b62acb0dfc8151ed1c8500e2e", "html_url": "https://github.com/rust-lang/rust/commit/d544e21dc3fbae5b62acb0dfc8151ed1c8500e2e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d544e21dc3fbae5b62acb0dfc8151ed1c8500e2e/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "98a9397c2a0197ebed190baa20b6111cb40edaa2", "url": "https://api.github.com/repos/rust-lang/rust/commits/98a9397c2a0197ebed190baa20b6111cb40edaa2", "html_url": "https://github.com/rust-lang/rust/commit/98a9397c2a0197ebed190baa20b6111cb40edaa2"}, {"sha": "df3a30aee4fe514c1fd1193d3a7e739b1a66ab8f", "url": "https://api.github.com/repos/rust-lang/rust/commits/df3a30aee4fe514c1fd1193d3a7e739b1a66ab8f", "html_url": "https://github.com/rust-lang/rust/commit/df3a30aee4fe514c1fd1193d3a7e739b1a66ab8f"}], "stats": {"total": 43, "additions": 42, "deletions": 1}, "files": [{"sha": "159f45ffce1a0ec27eed3a8b4bcc7083e3d9016d", "filename": "library/alloc/src/vec.rs", "status": "modified", "additions": 42, "deletions": 1, "changes": 43, "blob_url": "https://github.com/rust-lang/rust/blob/d544e21dc3fbae5b62acb0dfc8151ed1c8500e2e/library%2Falloc%2Fsrc%2Fvec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d544e21dc3fbae5b62acb0dfc8151ed1c8500e2e/library%2Falloc%2Fsrc%2Fvec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fvec.rs?ref=d544e21dc3fbae5b62acb0dfc8151ed1c8500e2e", "patch": "@@ -65,7 +65,7 @@ use core::hash::{Hash, Hasher};\n use core::intrinsics::{arith_offset, assume};\n use core::iter::{FromIterator, FusedIterator, TrustedLen};\n use core::marker::PhantomData;\n-use core::mem::{self, ManuallyDrop};\n+use core::mem::{self, ManuallyDrop, MaybeUninit};\n use core::ops::Bound::{Excluded, Included, Unbounded};\n use core::ops::{self, Index, IndexMut, RangeBounds};\n use core::ptr::{self, NonNull};\n@@ -1525,6 +1525,47 @@ impl<T> Vec<T> {\n     {\n         Box::leak(vec.into_boxed_slice())\n     }\n+\n+    /// Returns the remaining spare capacity of the vector as a slice of\n+    /// `MaybeUninit<T>`.\n+    ///\n+    /// The returned slice can be used to fill the vector with data (e.g. by\n+    /// reading from a file) before marking the data as initialized using the\n+    /// [`set_len`] method.\n+    ///\n+    /// [`set_len`]: #method.set_len\n+    ///\n+    /// # Examples\n+    ///\n+    /// ```\n+    /// #![feature(vec_spare_capacity, maybe_uninit_extra)]\n+    ///\n+    /// // Allocate vector big enough for 10 elements.\n+    /// let mut v = Vec::with_capacity(10);\n+    ///\n+    /// // Fill in the first 3 elements.\n+    /// let uninit = v.spare_capacity_mut();\n+    /// uninit[0].write(0);\n+    /// uninit[1].write(1);\n+    /// uninit[2].write(2);\n+    ///\n+    /// // Mark the first 3 elements of the vector as being initialized.\n+    /// unsafe {\n+    ///     v.set_len(3);\n+    /// }\n+    ///\n+    /// assert_eq!(&v, &[0, 1, 2]);\n+    /// ```\n+    #[unstable(feature = \"vec_spare_capacity\", issue = \"75017\")]\n+    #[inline]\n+    pub fn spare_capacity_mut(&mut self) -> &mut [MaybeUninit<T>] {\n+        unsafe {\n+            slice::from_raw_parts_mut(\n+                self.as_mut_ptr().add(self.len) as *mut MaybeUninit<T>,\n+                self.buf.capacity() - self.len,\n+            )\n+        }\n+    }\n }\n \n impl<T: Clone> Vec<T> {"}]}