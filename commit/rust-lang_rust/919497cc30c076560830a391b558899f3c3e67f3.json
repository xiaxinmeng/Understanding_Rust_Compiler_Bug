{"sha": "919497cc30c076560830a391b558899f3c3e67f3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjkxOTQ5N2NjMzBjMDc2NTYwODMwYTM5MWI1NTg4OTlmM2MzZTY3ZjM=", "commit": {"author": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2021-08-24T12:39:38Z"}, "committer": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2021-09-14T11:56:33Z"}, "message": "rustc_metadata: Remove Metadata::raw_bytes() and use Metadata::blob() directly instead.", "tree": {"sha": "f7adb88e616d4f3a27d22b29920dc4a65aa076c2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f7adb88e616d4f3a27d22b29920dc4a65aa076c2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/919497cc30c076560830a391b558899f3c3e67f3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/919497cc30c076560830a391b558899f3c3e67f3", "html_url": "https://github.com/rust-lang/rust/commit/919497cc30c076560830a391b558899f3c3e67f3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/919497cc30c076560830a391b558899f3c3e67f3/comments", "author": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "committer": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5f73085f925cd008fc28eed302f8bc026e7fb71c", "url": "https://api.github.com/repos/rust-lang/rust/commits/5f73085f925cd008fc28eed302f8bc026e7fb71c", "html_url": "https://github.com/rust-lang/rust/commit/5f73085f925cd008fc28eed302f8bc026e7fb71c"}], "stats": {"total": 11, "additions": 4, "deletions": 7}, "files": [{"sha": "eb3a9f576a735429415e0d1e6198b296a33cf342", "filename": "compiler/rustc_metadata/src/rmeta/decoder.rs", "status": "modified", "additions": 4, "deletions": 7, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/919497cc30c076560830a391b558899f3c3e67f3/compiler%2Frustc_metadata%2Fsrc%2Frmeta%2Fdecoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/919497cc30c076560830a391b558899f3c3e67f3/compiler%2Frustc_metadata%2Fsrc%2Frmeta%2Fdecoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_metadata%2Fsrc%2Frmeta%2Fdecoder.rs?ref=919497cc30c076560830a391b558899f3c3e67f3", "patch": "@@ -167,10 +167,7 @@ pub(super) struct DecodeContext<'a, 'tcx> {\n /// Abstract over the various ways one can create metadata decoders.\n pub(super) trait Metadata<'a, 'tcx>: Copy {\n     fn blob(self) -> &'a MetadataBlob;\n-    #[inline]\n-    fn raw_bytes(self) -> &'a [u8] {\n-        self.blob()\n-    }\n+\n     fn cdata(self) -> Option<CrateMetadataRef<'a>> {\n         None\n     }\n@@ -184,7 +181,7 @@ pub(super) trait Metadata<'a, 'tcx>: Copy {\n     fn decoder(self, pos: usize) -> DecodeContext<'a, 'tcx> {\n         let tcx = self.tcx();\n         DecodeContext {\n-            opaque: opaque::Decoder::new(self.raw_bytes(), pos),\n+            opaque: opaque::Decoder::new(self.blob(), pos),\n             cdata: self.cdata(),\n             blob: self.blob(),\n             sess: self.sess().or(tcx.map(|tcx| tcx.sess)),\n@@ -637,7 +634,7 @@ impl MetadataBlob {\n     }\n \n     crate fn is_compatible(&self) -> bool {\n-        self.raw_bytes().starts_with(METADATA_HEADER)\n+        self.blob().starts_with(METADATA_HEADER)\n     }\n \n     crate fn get_rustc_version(&self) -> String {\n@@ -646,7 +643,7 @@ impl MetadataBlob {\n     }\n \n     crate fn get_root(&self) -> CrateRoot<'tcx> {\n-        let slice = self.raw_bytes();\n+        let slice = &self.blob()[..];\n         let offset = METADATA_HEADER.len();\n         let pos = (((slice[offset + 0] as u32) << 24)\n             | ((slice[offset + 1] as u32) << 16)"}]}