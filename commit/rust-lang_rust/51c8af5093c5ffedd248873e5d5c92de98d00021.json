{"sha": "51c8af5093c5ffedd248873e5d5c92de98d00021", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUxYzhhZjUwOTNjNWZmZWRkMjQ4ODczZTVkNWM5MmRlOThkMDAwMjE=", "commit": {"author": {"name": "Alex Burka", "email": "alex@alexburka.com", "date": "2017-04-03T00:26:14Z"}, "committer": {"name": "Alex Burka", "email": "alex@alexburka.com", "date": "2017-04-15T19:06:58Z"}, "message": "reduce macro rule duplication in test", "tree": {"sha": "a0bd5798bd97eba1b2dd10c11dc257fc52e3b921", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a0bd5798bd97eba1b2dd10c11dc257fc52e3b921"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/51c8af5093c5ffedd248873e5d5c92de98d00021", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/51c8af5093c5ffedd248873e5d5c92de98d00021", "html_url": "https://github.com/rust-lang/rust/commit/51c8af5093c5ffedd248873e5d5c92de98d00021", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/51c8af5093c5ffedd248873e5d5c92de98d00021/comments", "author": {"login": "durka", "id": 47007, "node_id": "MDQ6VXNlcjQ3MDA3", "avatar_url": "https://avatars.githubusercontent.com/u/47007?v=4", "gravatar_id": "", "url": "https://api.github.com/users/durka", "html_url": "https://github.com/durka", "followers_url": "https://api.github.com/users/durka/followers", "following_url": "https://api.github.com/users/durka/following{/other_user}", "gists_url": "https://api.github.com/users/durka/gists{/gist_id}", "starred_url": "https://api.github.com/users/durka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/durka/subscriptions", "organizations_url": "https://api.github.com/users/durka/orgs", "repos_url": "https://api.github.com/users/durka/repos", "events_url": "https://api.github.com/users/durka/events{/privacy}", "received_events_url": "https://api.github.com/users/durka/received_events", "type": "User", "site_admin": false}, "committer": {"login": "durka", "id": 47007, "node_id": "MDQ6VXNlcjQ3MDA3", "avatar_url": "https://avatars.githubusercontent.com/u/47007?v=4", "gravatar_id": "", "url": "https://api.github.com/users/durka", "html_url": "https://github.com/durka", "followers_url": "https://api.github.com/users/durka/followers", "following_url": "https://api.github.com/users/durka/following{/other_user}", "gists_url": "https://api.github.com/users/durka/gists{/gist_id}", "starred_url": "https://api.github.com/users/durka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/durka/subscriptions", "organizations_url": "https://api.github.com/users/durka/orgs", "repos_url": "https://api.github.com/users/durka/repos", "events_url": "https://api.github.com/users/durka/events{/privacy}", "received_events_url": "https://api.github.com/users/durka/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e0cd76674d3f5cf68d83789bad27dec9dcf53501", "url": "https://api.github.com/repos/rust-lang/rust/commits/e0cd76674d3f5cf68d83789bad27dec9dcf53501", "html_url": "https://github.com/rust-lang/rust/commit/e0cd76674d3f5cf68d83789bad27dec9dcf53501"}], "stats": {"total": 24, "additions": 4, "deletions": 20}, "files": [{"sha": "d79f4b65b69e1579da65ccfd8379da143eae648c", "filename": "src/test/run-pass/macro-pub-matcher.rs", "status": "modified", "additions": 4, "deletions": 20, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/51c8af5093c5ffedd248873e5d5c92de98d00021/src%2Ftest%2Frun-pass%2Fmacro-pub-matcher.rs", "raw_url": "https://github.com/rust-lang/rust/raw/51c8af5093c5ffedd248873e5d5c92de98d00021/src%2Ftest%2Frun-pass%2Fmacro-pub-matcher.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fmacro-pub-matcher.rs?ref=51c8af5093c5ffedd248873e5d5c92de98d00021", "patch": "@@ -83,28 +83,12 @@ Ensure that the `:vis` matcher works in a more complex situation: parsing a\n struct definition.\n */\n macro_rules! vis_parse_struct {\n-    /*\n-    The rule duplication is currently unavoidable due to the leading attribute\n-    matching.\n-    */\n-    ($(#[$($attrs:tt)*])* pub($($vis:tt)*) struct $name:ident {$($body:tt)*}) => {\n-        vis_parse_struct! { @parse_fields $(#[$($attrs)*])*, pub($($vis)*), $name, $($body)* }\n-    };\n-    ($(#[$($attrs:tt)*])* pub struct $name:ident {$($body:tt)*}) => {\n-        vis_parse_struct! { @parse_fields $(#[$($attrs)*])*, pub, $name, $($body)* }\n-    };\n-    ($(#[$($attrs:tt)*])* struct $name:ident {$($body:tt)*}) => {\n-        vis_parse_struct! { @parse_fields $(#[$($attrs)*])*, , $name, $($body)* }\n+    ($(#[$($attrs:tt)*])* $vis:vis struct $name:ident {$($body:tt)*}) => {\n+        vis_parse_struct! { @parse_fields $(#[$($attrs)*])*, $vis, $name, $($body)* }\n     };\n \n-    ($(#[$($attrs:tt)*])* pub($($vis:tt)*) struct $name:ident ($($body:tt)*);) => {\n-        vis_parse_struct! { @parse_tuple $(#[$($attrs)*])*, pub($($vis)*), $name, $($body)* }\n-    };\n-    ($(#[$($attrs:tt)*])* pub struct $name:ident ($($body:tt)*);) => {\n-        vis_parse_struct! { @parse_tuple $(#[$($attrs)*])*, pub, $name, $($body)* }\n-    };\n-    ($(#[$($attrs:tt)*])* struct $name:ident ($($body:tt)*);) => {\n-        vis_parse_struct! { @parse_tuple $(#[$($attrs)*])*, , $name, $($body)* }\n+    ($(#[$($attrs:tt)*])* $vis:vis struct $name:ident ($($body:tt)*);) => {\n+        vis_parse_struct! { @parse_tuple $(#[$($attrs)*])*, $vis, $name, $($body)* }\n     };\n \n     (@parse_fields"}]}