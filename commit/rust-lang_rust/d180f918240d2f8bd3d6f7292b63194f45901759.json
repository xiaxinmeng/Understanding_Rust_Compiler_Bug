{"sha": "d180f918240d2f8bd3d6f7292b63194f45901759", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQxODBmOTE4MjQwZDJmOGJkM2Q2ZjcyOTJiNjMxOTRmNDU5MDE3NTk=", "commit": {"author": {"name": "hi-rustin", "email": "rustin.liu@gmail.com", "date": "2021-03-11T15:30:39Z"}, "committer": {"name": "hi-rustin", "email": "rustin.liu@gmail.com", "date": "2021-03-12T04:06:10Z"}, "message": "Emit the enum range assumption if the range only contains one element\n\ntest: add test case\n\nmake tidy happy", "tree": {"sha": "036c6a6ed4ae43467af16a28e621e3f752475cf6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/036c6a6ed4ae43467af16a28e621e3f752475cf6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d180f918240d2f8bd3d6f7292b63194f45901759", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d180f918240d2f8bd3d6f7292b63194f45901759", "html_url": "https://github.com/rust-lang/rust/commit/d180f918240d2f8bd3d6f7292b63194f45901759", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d180f918240d2f8bd3d6f7292b63194f45901759/comments", "author": {"login": "hi-rustin", "id": 29879298, "node_id": "MDQ6VXNlcjI5ODc5Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/29879298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hi-rustin", "html_url": "https://github.com/hi-rustin", "followers_url": "https://api.github.com/users/hi-rustin/followers", "following_url": "https://api.github.com/users/hi-rustin/following{/other_user}", "gists_url": "https://api.github.com/users/hi-rustin/gists{/gist_id}", "starred_url": "https://api.github.com/users/hi-rustin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hi-rustin/subscriptions", "organizations_url": "https://api.github.com/users/hi-rustin/orgs", "repos_url": "https://api.github.com/users/hi-rustin/repos", "events_url": "https://api.github.com/users/hi-rustin/events{/privacy}", "received_events_url": "https://api.github.com/users/hi-rustin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "hi-rustin", "id": 29879298, "node_id": "MDQ6VXNlcjI5ODc5Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/29879298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hi-rustin", "html_url": "https://github.com/hi-rustin", "followers_url": "https://api.github.com/users/hi-rustin/followers", "following_url": "https://api.github.com/users/hi-rustin/following{/other_user}", "gists_url": "https://api.github.com/users/hi-rustin/gists{/gist_id}", "starred_url": "https://api.github.com/users/hi-rustin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hi-rustin/subscriptions", "organizations_url": "https://api.github.com/users/hi-rustin/orgs", "repos_url": "https://api.github.com/users/hi-rustin/repos", "events_url": "https://api.github.com/users/hi-rustin/events{/privacy}", "received_events_url": "https://api.github.com/users/hi-rustin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5c6d3bf3896b465e15550f49c2861e3d18102270", "url": "https://api.github.com/repos/rust-lang/rust/commits/5c6d3bf3896b465e15550f49c2861e3d18102270", "html_url": "https://github.com/rust-lang/rust/commit/5c6d3bf3896b465e15550f49c2861e3d18102270"}], "stats": {"total": 18, "additions": 17, "deletions": 1}, "files": [{"sha": "629cb64d43ee1c55f01a5a9bce4421df09464120", "filename": "compiler/rustc_codegen_ssa/src/mir/rvalue.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d180f918240d2f8bd3d6f7292b63194f45901759/compiler%2Frustc_codegen_ssa%2Fsrc%2Fmir%2Frvalue.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d180f918240d2f8bd3d6f7292b63194f45901759/compiler%2Frustc_codegen_ssa%2Fsrc%2Fmir%2Frvalue.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_ssa%2Fsrc%2Fmir%2Frvalue.rs?ref=d180f918240d2f8bd3d6f7292b63194f45901759", "patch": "@@ -325,7 +325,7 @@ impl<'a, 'tcx, Bx: BuilderMethods<'a, 'tcx>> FunctionCx<'a, 'tcx, Bx> {\n \n                                 let er = scalar.valid_range_exclusive(bx.cx());\n                                 if er.end != er.start\n-                                    && scalar.valid_range.end() > scalar.valid_range.start()\n+                                    && scalar.valid_range.end() >= scalar.valid_range.start()\n                                 {\n                                     // We want `table[e as usize \u00b1 k]` to not\n                                     // have bound checks, and this is the most"}, {"sha": "e779e2ef27439008ab39cc6011d293ea81d4566e", "filename": "src/test/codegen/enum-bounds-check-issue-82871.rs", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/d180f918240d2f8bd3d6f7292b63194f45901759/src%2Ftest%2Fcodegen%2Fenum-bounds-check-issue-82871.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d180f918240d2f8bd3d6f7292b63194f45901759/src%2Ftest%2Fcodegen%2Fenum-bounds-check-issue-82871.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fenum-bounds-check-issue-82871.rs?ref=d180f918240d2f8bd3d6f7292b63194f45901759", "patch": "@@ -0,0 +1,16 @@\n+// compile-flags: -O\n+// min-llvm-version: 11.0\n+\n+#![crate_type = \"lib\"]\n+\n+#[repr(C)]\n+pub enum E {\n+    A,\n+}\n+\n+// CHECK-LABEL: @index\n+#[no_mangle]\n+pub fn index(x: &[u32; 3], ind: E) -> u32{\n+    // CHECK-NOT: panic_bounds_check\n+    x[ind as usize]\n+}"}]}