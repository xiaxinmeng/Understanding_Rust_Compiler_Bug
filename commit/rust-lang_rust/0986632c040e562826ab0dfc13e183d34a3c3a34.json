{"sha": "0986632c040e562826ab0dfc13e183d34a3c3a34", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA5ODY2MzJjMDQwZTU2MjgyNmFiMGRmYzEzZTE4M2QzNGEzYzNhMzQ=", "commit": {"author": {"name": "Basti Ortiz", "email": "39114273+Some-Dood@users.noreply.github.com", "date": "2021-08-10T14:44:15Z"}, "committer": {"name": "Basti Ortiz", "email": "39114273+Some-Dood@users.noreply.github.com", "date": "2021-08-10T14:44:15Z"}, "message": "Fix: revert strange usage of `?` operator", "tree": {"sha": "89181e2593df4aeda7c74d9bbbb315dce34c8f69", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/89181e2593df4aeda7c74d9bbbb315dce34c8f69"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0986632c040e562826ab0dfc13e183d34a3c3a34", "comment_count": 0, "verification": {"verified": false, "reason": "bad_email", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEqA0bdqgj8CYCkkcsFALVyxf0jhsFAmESkNcACgkQFALVyxf0\njhshbA//e39pha/oikJoUbM7mZlGbNOdIp64c/s3Bp9OBu3q1RrMhFI5HMmKo9Ln\nIU5X2OAyD2Am/GuYnKmx3BmqevJ6u3Q+UtDtRG4caCWgfzeXBPiiWsPQmWngxoCA\nnyEHFUDsP3FFb79uAVj+IEqOn78k8RfhugkDSavgR66yQC2N8mWbJevLs8QADn7U\n/FZG3sTt9QUZAPJVMcvUPkb7jiXv/BxMZUPW8sR+qybzMxVb58PWm8OSf0RepXSU\nOUBV8LwDzFbowWW5RdF80gichEYko7H+1TgiSekRUe3N5wqjKlY/iQFICyZta3VQ\nuyHc+fL8j/Shyz+3vdC6cP5q3J6EJxf5/u9b6CMqasbTBtBAsIUOOPsyZ03sUVh2\nbOzUqyWLkTX8Do8DTfcAg4z8ZLX5K2pdx+oEWicg2A8+dKaWfXRhUJCY8yQ8Lk2a\nqqB6TXOk5GdftUpSHfLYxAZtL+QeUsDMEQeKI01dnARS2/zwbpyoVViFEY7sZ3wn\nwmn7lwKraPt2Gsk5YKWj+bhArSoSDINKzgbMCsIL+x+teJpKXT6bp92Njpz5+vAy\nACwWmzt+/n2EB/g3xgayZbM9RyjxA29ZGxMBf3y6VAftJ2gQqxuFiEQOe8Y92DbK\nIY8oZZBtqC49jm4Cy2LqYtQfJiR9bnWocaaKx8FCwoXVaSRHvKQ=\n=bPzR\n-----END PGP SIGNATURE-----", "payload": "tree 89181e2593df4aeda7c74d9bbbb315dce34c8f69\nparent 27605b402e5009d03bd1c961c6272b8d2dbe674d\nauthor Basti Ortiz <39114273+Some-Dood@users.noreply.github.com> 1628606655 +0800\ncommitter Basti Ortiz <39114273+Some-Dood@users.noreply.github.com> 1628606655 +0800\n\nFix: revert strange usage of `?` operator\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0986632c040e562826ab0dfc13e183d34a3c3a34", "html_url": "https://github.com/rust-lang/rust/commit/0986632c040e562826ab0dfc13e183d34a3c3a34", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0986632c040e562826ab0dfc13e183d34a3c3a34/comments", "author": {"login": "BastiDood", "id": 39114273, "node_id": "MDQ6VXNlcjM5MTE0Mjcz", "avatar_url": "https://avatars.githubusercontent.com/u/39114273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BastiDood", "html_url": "https://github.com/BastiDood", "followers_url": "https://api.github.com/users/BastiDood/followers", "following_url": "https://api.github.com/users/BastiDood/following{/other_user}", "gists_url": "https://api.github.com/users/BastiDood/gists{/gist_id}", "starred_url": "https://api.github.com/users/BastiDood/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BastiDood/subscriptions", "organizations_url": "https://api.github.com/users/BastiDood/orgs", "repos_url": "https://api.github.com/users/BastiDood/repos", "events_url": "https://api.github.com/users/BastiDood/events{/privacy}", "received_events_url": "https://api.github.com/users/BastiDood/received_events", "type": "User", "site_admin": false}, "committer": {"login": "BastiDood", "id": 39114273, "node_id": "MDQ6VXNlcjM5MTE0Mjcz", "avatar_url": "https://avatars.githubusercontent.com/u/39114273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BastiDood", "html_url": "https://github.com/BastiDood", "followers_url": "https://api.github.com/users/BastiDood/followers", "following_url": "https://api.github.com/users/BastiDood/following{/other_user}", "gists_url": "https://api.github.com/users/BastiDood/gists{/gist_id}", "starred_url": "https://api.github.com/users/BastiDood/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BastiDood/subscriptions", "organizations_url": "https://api.github.com/users/BastiDood/orgs", "repos_url": "https://api.github.com/users/BastiDood/repos", "events_url": "https://api.github.com/users/BastiDood/events{/privacy}", "received_events_url": "https://api.github.com/users/BastiDood/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "27605b402e5009d03bd1c961c6272b8d2dbe674d", "url": "https://api.github.com/repos/rust-lang/rust/commits/27605b402e5009d03bd1c961c6272b8d2dbe674d", "html_url": "https://github.com/rust-lang/rust/commit/27605b402e5009d03bd1c961c6272b8d2dbe674d"}], "stats": {"total": 17, "additions": 8, "deletions": 9}, "files": [{"sha": "e075d752b7ff4a7ebe2b70a8a2ed9543488a17bb", "filename": "crates/vfs/src/lib.rs", "status": "modified", "additions": 8, "deletions": 9, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/0986632c040e562826ab0dfc13e183d34a3c3a34/crates%2Fvfs%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0986632c040e562826ab0dfc13e183d34a3c3a34/crates%2Fvfs%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fvfs%2Fsrc%2Flib.rs?ref=0986632c040e562826ab0dfc13e183d34a3c3a34", "patch": "@@ -111,9 +111,7 @@ impl Vfs {\n \n     /// Id of the given path if it exists in the `Vfs` and is not deleted.\n     pub fn file_id(&self, path: &VfsPath) -> Option<FileId> {\n-        let it = self.interner.get(path)?;\n-        let _ = self.get(it).as_ref()?;\n-        Some(it)\n+        self.interner.get(path).filter(|&it| self.get(it).is_some())\n     }\n \n     /// File path corresponding to the given `file_id`.\n@@ -139,12 +137,13 @@ impl Vfs {\n     ///\n     /// This will skip deleted files.\n     pub fn iter(&self) -> impl Iterator<Item = (FileId, &VfsPath)> + '_ {\n-        (0..self.data.len()).filter_map(move |it| {\n-            let file_id = FileId(it as u32);\n-            let _ = self.get(file_id).as_ref()?;\n-            let path = self.interner.lookup(file_id);\n-            Some((file_id, path))\n-        })\n+        (0..self.data.len())\n+            .map(|it| FileId(it as u32))\n+            .filter(move |&file_id| self.get(file_id).is_some())\n+            .map(move |file_id| {\n+                let path = self.interner.lookup(file_id);\n+                (file_id, path)\n+            })\n     }\n \n     /// Update the `path` with the given `contents`. `None` means the file was deleted."}]}