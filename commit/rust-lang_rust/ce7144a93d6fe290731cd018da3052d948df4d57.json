{"sha": "ce7144a93d6fe290731cd018da3052d948df4d57", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNlNzE0NGE5M2Q2ZmUyOTA3MzFjZDAxOGRhMzA1MmQ5NDhkZjRkNTc=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-05-24T13:32:31Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-05-24T13:32:31Z"}, "message": "Merge pull request #4474 from georgewfraser/color_attrs\n\nColor attribute functions", "tree": {"sha": "82669df97be205b4e93418b3200c7d7c26748705", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/82669df97be205b4e93418b3200c7d7c26748705"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ce7144a93d6fe290731cd018da3052d948df4d57", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJeyndvCRBK7hj4Ov3rIwAAdHIIAH+IV389XsRm6YAOphVye0/b\noyTENXOuiQRIqbhloeA/Ful2kXuSRKc+FA9kvlmFzO6O4fLTii7eX2xXU8zzxbpy\nQ2PbC3sibfD79OHmbjI9OZZYVxsrBVaGPDmZb2mYtIbFdxyxAYFIKO0/79yk0Bsv\nDYr8hNlRUwIei7iDn1O6IyFdpkrbZqXv1iqHWAUCNIU4C+eqqtwzCHCY7UIVPXiY\niLld0E2YZr35vskPJBIvRcFh6j7bek1ZQ7HTbGwjiBuK15MEpzNgJM7O0kqXJ8Ke\nrdRtF9NtYmkSj5D11NKJxI7rL9GK3xp0EEKNzOK9u4ncmxzj0xoKm4In+2SGlk8=\n=Cih0\n-----END PGP SIGNATURE-----\n", "payload": "tree 82669df97be205b4e93418b3200c7d7c26748705\nparent ea3e84f21d4e8c048e091e865c0916fed62f4714\nparent 47ce5ea581f3fe53a31e166c5feac6c64a8a97e4\nauthor Aleksey Kladov <aleksey.kladov@gmail.com> 1590327151 +0200\ncommitter GitHub <noreply@github.com> 1590327151 +0200\n\nMerge pull request #4474 from georgewfraser/color_attrs\n\nColor attribute functions"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ce7144a93d6fe290731cd018da3052d948df4d57", "html_url": "https://github.com/rust-lang/rust/commit/ce7144a93d6fe290731cd018da3052d948df4d57", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ce7144a93d6fe290731cd018da3052d948df4d57/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ea3e84f21d4e8c048e091e865c0916fed62f4714", "url": "https://api.github.com/repos/rust-lang/rust/commits/ea3e84f21d4e8c048e091e865c0916fed62f4714", "html_url": "https://github.com/rust-lang/rust/commit/ea3e84f21d4e8c048e091e865c0916fed62f4714"}, {"sha": "47ce5ea581f3fe53a31e166c5feac6c64a8a97e4", "url": "https://api.github.com/repos/rust-lang/rust/commits/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4", "html_url": "https://github.com/rust-lang/rust/commit/47ce5ea581f3fe53a31e166c5feac6c64a8a97e4"}], "stats": {"total": 28, "additions": 24, "deletions": 4}, "files": [{"sha": "2ceadf2fcbf75b2625927c079b97e04f8278be14", "filename": "crates/ra_ide/src/snapshots/highlighting.html", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ce7144a93d6fe290731cd018da3052d948df4d57/crates%2Fra_ide%2Fsrc%2Fsnapshots%2Fhighlighting.html", "raw_url": "https://github.com/rust-lang/rust/raw/ce7144a93d6fe290731cd018da3052d948df4d57/crates%2Fra_ide%2Fsrc%2Fsnapshots%2Fhighlighting.html", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide%2Fsrc%2Fsnapshots%2Fhighlighting.html?ref=ce7144a93d6fe290731cd018da3052d948df4d57", "patch": "@@ -27,7 +27,7 @@\n .keyword.unsafe     { color: #BC8383; font-weight: bold; }\n .control            { font-style: italic; }\n </style>\n-<pre><code><span class=\"attribute\">#[derive(Clone, Debug)]</span>\n+<pre><code><span class=\"attribute\">#[</span><span class=\"function attribute\">derive</span><span class=\"attribute\">(Clone, Debug)]</span>\n <span class=\"keyword\">struct</span> <span class=\"struct declaration\">Foo</span> {\n     <span class=\"keyword\">pub</span> <span class=\"field declaration\">x</span>: <span class=\"builtin_type\">i32</span>,\n     <span class=\"keyword\">pub</span> <span class=\"field declaration\">y</span>: <span class=\"builtin_type\">i32</span>,"}, {"sha": "b55cf748dc08ea7333f4f68f5b11c10a2b2cd1d1", "filename": "crates/ra_ide/src/syntax_highlighting.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ce7144a93d6fe290731cd018da3052d948df4d57/crates%2Fra_ide%2Fsrc%2Fsyntax_highlighting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ce7144a93d6fe290731cd018da3052d948df4d57/crates%2Fra_ide%2Fsrc%2Fsyntax_highlighting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide%2Fsrc%2Fsyntax_highlighting.rs?ref=ce7144a93d6fe290731cd018da3052d948df4d57", "patch": "@@ -361,7 +361,9 @@ fn highlight_element(\n         }\n \n         // Highlight references like the definitions they resolve to\n-        NAME_REF if element.ancestors().any(|it| it.kind() == ATTR) => return None,\n+        NAME_REF if element.ancestors().any(|it| it.kind() == ATTR) => {\n+            Highlight::from(HighlightTag::Function) | HighlightModifier::Attribute\n+        }\n         NAME_REF => {\n             let name_ref = element.into_node().and_then(ast::NameRef::cast).unwrap();\n             match classify_name_ref(sema, &name_ref) {"}, {"sha": "33e6619ec789d19a2c6b050ce649efbace44bd09", "filename": "crates/ra_ide/src/syntax_highlighting/tags.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/ce7144a93d6fe290731cd018da3052d948df4d57/crates%2Fra_ide%2Fsrc%2Fsyntax_highlighting%2Ftags.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ce7144a93d6fe290731cd018da3052d948df4d57/crates%2Fra_ide%2Fsrc%2Fsyntax_highlighting%2Ftags.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide%2Fsrc%2Fsyntax_highlighting%2Ftags.rs?ref=ce7144a93d6fe290731cd018da3052d948df4d57", "patch": "@@ -45,8 +45,10 @@ pub enum HighlightTag {\n #[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, PartialOrd, Ord)]\n #[repr(u8)]\n pub enum HighlightModifier {\n+    /// Used to differentiate individual elements within attributes.\n+    Attribute = 0,\n     /// Used with keywords like `if` and `break`.\n-    ControlFlow = 0,\n+    ControlFlow,\n     /// `foo` in `fn foo(x: i32)` is a definition, `foo` in `foo(90 + 2)` is\n     /// not.\n     Definition,\n@@ -95,6 +97,7 @@ impl fmt::Display for HighlightTag {\n \n impl HighlightModifier {\n     const ALL: &'static [HighlightModifier] = &[\n+        HighlightModifier::Attribute,\n         HighlightModifier::ControlFlow,\n         HighlightModifier::Definition,\n         HighlightModifier::Mutable,\n@@ -103,6 +106,7 @@ impl HighlightModifier {\n \n     fn as_str(self) -> &'static str {\n         match self {\n+            HighlightModifier::Attribute => \"attribute\",\n             HighlightModifier::ControlFlow => \"control\",\n             HighlightModifier::Definition => \"declaration\",\n             HighlightModifier::Mutable => \"mutable\","}, {"sha": "90a6257ee8e12470cec687dc804706d0228ac7bd", "filename": "crates/rust-analyzer/src/semantic_tokens.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/ce7144a93d6fe290731cd018da3052d948df4d57/crates%2Frust-analyzer%2Fsrc%2Fsemantic_tokens.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ce7144a93d6fe290731cd018da3052d948df4d57/crates%2Frust-analyzer%2Fsrc%2Fsemantic_tokens.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fsemantic_tokens.rs?ref=ce7144a93d6fe290731cd018da3052d948df4d57", "patch": "@@ -67,6 +67,7 @@ define_semantic_token_modifiers![\n     (CONTROL_FLOW, \"controlFlow\"),\n     (MUTABLE, \"mutable\"),\n     (UNSAFE, \"unsafe\"),\n+    (ATTRIBUTE_MODIFIER, \"attribute\"),\n ];\n \n #[derive(Default)]"}, {"sha": "672e47e41c359eae5dea20af2dd768df43302db3", "filename": "crates/rust-analyzer/src/to_proto.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/ce7144a93d6fe290731cd018da3052d948df4d57/crates%2Frust-analyzer%2Fsrc%2Fto_proto.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ce7144a93d6fe290731cd018da3052d948df4d57/crates%2Frust-analyzer%2Fsrc%2Fto_proto.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fto_proto.rs?ref=ce7144a93d6fe290731cd018da3052d948df4d57", "patch": "@@ -307,6 +307,7 @@ fn semantic_token_type_and_modifiers(\n \n     for modifier in highlight.modifiers.iter() {\n         let modifier = match modifier {\n+            HighlightModifier::Attribute => semantic_tokens::ATTRIBUTE_MODIFIER,\n             HighlightModifier::Definition => lsp_types::SemanticTokenModifier::DECLARATION,\n             HighlightModifier::ControlFlow => semantic_tokens::CONTROL_FLOW,\n             HighlightModifier::Mutable => semantic_tokens::MUTABLE,"}, {"sha": "3aa90cd66da55731242d3cd533d3a76bc8524cd8", "filename": "editors/code/package.json", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/ce7144a93d6fe290731cd018da3052d948df4d57/editors%2Fcode%2Fpackage.json", "raw_url": "https://github.com/rust-lang/rust/raw/ce7144a93d6fe290731cd018da3052d948df4d57/editors%2Fcode%2Fpackage.json", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fpackage.json?ref=ce7144a93d6fe290731cd018da3052d948df4d57", "patch": "@@ -610,6 +610,10 @@\n             }\n         ],\n         \"semanticTokenModifiers\": [\n+            {\n+                \"id\": \"attribute\",\n+                \"description\": \"Style for elements within attributes\"\n+            },\n             {\n                 \"id\": \"constant\",\n                 \"description\": \"Style for compile-time constants\"\n@@ -637,6 +641,9 @@\n                     \"attribute\": [\n                         \"meta.attribute.rust\"\n                     ],\n+                    \"function.attribute\": [\n+                        \"entity.name.function.attribute.rust\"\n+                    ],\n                     \"builtinType\": [\n                         \"support.type.primitive.rust\"\n                     ],"}, {"sha": "cdcd557dc173426bf6fc635f6430d951766e71b8", "filename": "editors/code/rust.tmGrammar.json", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/ce7144a93d6fe290731cd018da3052d948df4d57/editors%2Fcode%2Frust.tmGrammar.json", "raw_url": "https://github.com/rust-lang/rust/raw/ce7144a93d6fe290731cd018da3052d948df4d57/editors%2Fcode%2Frust.tmGrammar.json", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Frust.tmGrammar.json?ref=ce7144a93d6fe290731cd018da3052d948df4d57", "patch": "@@ -75,8 +75,13 @@\n \t\t{\n \t\t\t\"comment\": \"Attribute\",\n \t\t\t\"name\": \"meta.attribute.rust\",\n-\t\t\t\"begin\": \"#\\\\!?\\\\[\",\n+\t\t\t\"begin\": \"#\\\\!?\\\\[(\\\\w*)\",\n \t\t\t\"end\": \"\\\\]\",\n+\t\t\t\"captures\": {\n+\t\t\t\t\"1\": {\n+\t\t\t\t\t\"name\": \"entity.name.function.attribute.rust\"\n+\t\t\t\t}\n+\t\t\t},\n \t\t\t\"patterns\": [\n \t\t\t\t{\n \t\t\t\t\t\"include\": \"#string_literal\""}]}