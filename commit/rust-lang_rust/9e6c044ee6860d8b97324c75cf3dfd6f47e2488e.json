{"sha": "9e6c044ee6860d8b97324c75cf3dfd6f47e2488e", "node_id": "C_kwDOAAsO6NoAKDllNmMwNDRlZTY4NjBkOGI5NzMyNGM3NWNmM2RmZDZmNDdlMjQ4OGU", "commit": {"author": {"name": "Gary Guo", "email": "gary@garyguo.net", "date": "2022-05-23T20:30:38Z"}, "committer": {"name": "Gary Guo", "email": "gary@garyguo.net", "date": "2022-06-08T20:32:41Z"}, "message": "Use is_fn_like instead of matching on DefKind", "tree": {"sha": "aeac7355c057c4c763716902eb414afa2792b7c6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/aeac7355c057c4c763716902eb414afa2792b7c6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9e6c044ee6860d8b97324c75cf3dfd6f47e2488e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9e6c044ee6860d8b97324c75cf3dfd6f47e2488e", "html_url": "https://github.com/rust-lang/rust/commit/9e6c044ee6860d8b97324c75cf3dfd6f47e2488e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9e6c044ee6860d8b97324c75cf3dfd6f47e2488e/comments", "author": {"login": "nbdd0121", "id": 4065244, "node_id": "MDQ6VXNlcjQwNjUyNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4065244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbdd0121", "html_url": "https://github.com/nbdd0121", "followers_url": "https://api.github.com/users/nbdd0121/followers", "following_url": "https://api.github.com/users/nbdd0121/following{/other_user}", "gists_url": "https://api.github.com/users/nbdd0121/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbdd0121/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbdd0121/subscriptions", "organizations_url": "https://api.github.com/users/nbdd0121/orgs", "repos_url": "https://api.github.com/users/nbdd0121/repos", "events_url": "https://api.github.com/users/nbdd0121/events{/privacy}", "received_events_url": "https://api.github.com/users/nbdd0121/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nbdd0121", "id": 4065244, "node_id": "MDQ6VXNlcjQwNjUyNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4065244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbdd0121", "html_url": "https://github.com/nbdd0121", "followers_url": "https://api.github.com/users/nbdd0121/followers", "following_url": "https://api.github.com/users/nbdd0121/following{/other_user}", "gists_url": "https://api.github.com/users/nbdd0121/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbdd0121/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbdd0121/subscriptions", "organizations_url": "https://api.github.com/users/nbdd0121/orgs", "repos_url": "https://api.github.com/users/nbdd0121/repos", "events_url": "https://api.github.com/users/nbdd0121/events{/privacy}", "received_events_url": "https://api.github.com/users/nbdd0121/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1750a2f723a796b9c98b223df6013f3b1b0254df", "url": "https://api.github.com/repos/rust-lang/rust/commits/1750a2f723a796b9c98b223df6013f3b1b0254df", "html_url": "https://github.com/rust-lang/rust/commit/1750a2f723a796b9c98b223df6013f3b1b0254df"}], "stats": {"total": 14, "additions": 2, "deletions": 12}, "files": [{"sha": "2c8389e532dd7af077bd3b915524616320f88d79", "filename": "compiler/rustc_mir_transform/src/abort_unwinding_calls.rs", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/9e6c044ee6860d8b97324c75cf3dfd6f47e2488e/compiler%2Frustc_mir_transform%2Fsrc%2Fabort_unwinding_calls.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9e6c044ee6860d8b97324c75cf3dfd6f47e2488e/compiler%2Frustc_mir_transform%2Fsrc%2Fabort_unwinding_calls.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_transform%2Fsrc%2Fabort_unwinding_calls.rs?ref=9e6c044ee6860d8b97324c75cf3dfd6f47e2488e", "patch": "@@ -1,6 +1,5 @@\n use crate::MirPass;\n use rustc_ast::InlineAsmOptions;\n-use rustc_hir::def::DefKind;\n use rustc_middle::mir::*;\n use rustc_middle::ty::layout;\n use rustc_middle::ty::{self, TyCtxt};\n@@ -31,11 +30,7 @@ impl<'tcx> MirPass<'tcx> for AbortUnwindingCalls {\n \n         // We don't simplify the MIR of constants at this time because that\n         // namely results in a cyclic query when we call `tcx.type_of` below.\n-        let is_function = match kind {\n-            DefKind::Fn | DefKind::AssocFn | DefKind::Ctor(..) => true,\n-            _ => tcx.is_closure(def_id),\n-        };\n-        if !is_function {\n+        if !kind.is_fn_like() {\n             return;\n         }\n "}, {"sha": "b8ef68f608cc3e7ebd77fc81548bddd2e7d6ce52", "filename": "compiler/rustc_mir_transform/src/ffi_unwind_calls.rs", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/9e6c044ee6860d8b97324c75cf3dfd6f47e2488e/compiler%2Frustc_mir_transform%2Fsrc%2Fffi_unwind_calls.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9e6c044ee6860d8b97324c75cf3dfd6f47e2488e/compiler%2Frustc_mir_transform%2Fsrc%2Fffi_unwind_calls.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_transform%2Fsrc%2Fffi_unwind_calls.rs?ref=9e6c044ee6860d8b97324c75cf3dfd6f47e2488e", "patch": "@@ -1,4 +1,3 @@\n-use rustc_hir::def::DefKind;\n use rustc_hir::def_id::{LocalDefId, LOCAL_CRATE};\n use rustc_middle::mir::*;\n use rustc_middle::ty::layout;\n@@ -44,11 +43,7 @@ fn has_ffi_unwind_calls(tcx: TyCtxt<'_>, local_def_id: LocalDefId) -> bool {\n     // Only perform check on functions because constants cannot call FFI functions.\n     let def_id = local_def_id.to_def_id();\n     let kind = tcx.def_kind(def_id);\n-    let is_function = match kind {\n-        DefKind::Fn | DefKind::AssocFn | DefKind::Ctor(..) => true,\n-        _ => tcx.is_closure(def_id),\n-    };\n-    if !is_function {\n+    if !kind.is_fn_like() {\n         return false;\n     }\n "}]}