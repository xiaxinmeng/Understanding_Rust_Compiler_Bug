{"sha": "910a05d8758045f545aabd724aace4fadb10e9aa", "node_id": "MDY6Q29tbWl0NzI0NzEyOjkxMGEwNWQ4NzU4MDQ1ZjU0NWFhYmQ3MjRhYWNlNGZhZGIxMGU5YWE=", "commit": {"author": {"name": "Tim Chevalier", "email": "chevalier@alum.wellesley.edu", "date": "2011-05-04T21:28:52Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-05-05T18:26:07Z"}, "message": "Update docs to reflect preds", "tree": {"sha": "c4bbc270209fbd82b15055c14871f03ef2057b7a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c4bbc270209fbd82b15055c14871f03ef2057b7a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/910a05d8758045f545aabd724aace4fadb10e9aa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/910a05d8758045f545aabd724aace4fadb10e9aa", "html_url": "https://github.com/rust-lang/rust/commit/910a05d8758045f545aabd724aace4fadb10e9aa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/910a05d8758045f545aabd724aace4fadb10e9aa/comments", "author": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "acf9bd7909a4f6a68d974cabff96c4b72791c201", "url": "https://api.github.com/repos/rust-lang/rust/commits/acf9bd7909a4f6a68d974cabff96c4b72791c201", "html_url": "https://github.com/rust-lang/rust/commit/acf9bd7909a4f6a68d974cabff96c4b72791c201"}], "stats": {"total": 38, "additions": 29, "deletions": 9}, "files": [{"sha": "1c6b88eb11f1102f3a8bed41b60ee7bfb820aad1", "filename": "doc/rust.texi", "status": "modified", "additions": 29, "deletions": 9, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/910a05d8758045f545aabd724aace4fadb10e9aa/doc%2Frust.texi", "raw_url": "https://github.com/rust-lang/rust/raw/910a05d8758045f545aabd724aace4fadb10e9aa/doc%2Frust.texi", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/doc%2Frust.texi?ref=910a05d8758045f545aabd724aace4fadb10e9aa", "patch": "@@ -682,6 +682,7 @@ The keywords are:\n @tab @code{thread}\n @item @code{auth}\n @tab @code{unsafe}\n+@tab @code{as}\n @tab @code{self}\n @tab @code{log}\n @item @code{bind}\n@@ -711,8 +712,8 @@ The keywords are:\n @tab @code{str}\n @item @code{fn}\n @tab @code{iter}\n+@tab @code{pred}\n @tab @code{obj}\n-@tab @code{as}\n @tab @code{drop}\n @item @code{task}\n @tab @code{port}\n@@ -1785,8 +1786,6 @@ fn main() @{\n @c * Ref.Item.Fn::            Items defining functions.\n @cindex Functions\n @cindex Slots, function input and output\n-@cindex Predicate\n-\n \n A @dfn{function item} defines a sequence of statements associated with a name\n and a set of parameters. Functions are declared with the keyword\n@@ -1805,16 +1804,37 @@ expression. If a control path lacks a @code{ret} expression in source code, an\n implicit @code{ret} expression is appended to the end of the control path\n during compilation, returning the implicit @code{()} value.\n \n-Any pure boolean function is also called a @emph{predicate}, and may be used\n-as part of the static typestate system. @xref{Ref.Typestate.Constr}.\n-\n An example of a function:\n @example\n fn add(int x, int y) -> int @{\n     ret x + y;\n @}\n @end example\n \n+@node       Ref.Item.Pred\n+@subsection Ref.Item.Pred\n+@c * Ref.Item.Pred::            Items defining predicates.\n+@cindex Predicate\n+\n+Any pure boolean function is called a @emph{predicate}, and may be used\n+as part of the static typestate system. @xref{Ref.Typestate.Constr}. A\n+predicate declaration is identical to a function declaration, except that it\n+is declared with the keyword @code{pred} instead of @code{fn}. In addition,\n+the typechecker checks the body of a predicate with a restricted set of\n+typechecking rules. A predicate\n+@itemize\n+@item may not contain a @code{put}, @code{send}, @code{recv}, assignment, or\n+self-call expression; and\n+@item may only call other predicates, not general functions.\n+@end itemize\n+\n+An example of a predicate:\n+@example\n+pred lt_42(int x) -> bool @{\n+    ret (x < 42);\n+@}\n+@end example\n+\n @node          Ref.Item.Iter\n @subsection    Ref.Item.Iter\n @c * Ref.Item.Iter::          Items defining iterators.\n@@ -2631,14 +2651,14 @@ This implicit graph is called the @dfn{control-flow graph}, or @dfn{CFG}.\n @cindex Predicate\n @cindex Constraint\n \n-A @dfn{predicate} is any pure boolean function. @xref{Ref.Item.Fn}.\n+A @dfn{predicate} is a pure boolean function declared with the keyword @code{pred}. @xref{Ref.Item.Pred}.\n \n A @dfn{constraint} is a predicate applied to specific slots.\n \n For example, consider the following code:\n \n @example\n-fn is_less_than(int a, int b) -> bool @{\n+pred is_less_than(int a, int b) -> bool @{\n      ret a < b;\n @}\n \n@@ -3543,7 +3563,7 @@ and statically comparing implied states and their\n specifications. @xref{Ref.Typestate}.\n \n @example\n-fn even(&int x) -> bool @{\n+pred even(&int x) -> bool @{\n     ret x & 1 == 0;\n @}\n "}]}