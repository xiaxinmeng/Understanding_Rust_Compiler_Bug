{"sha": "f6f5180d5fef3b3a4cc8a383eb20b83716935e6a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY2ZjUxODBkNWZlZjNiM2E0Y2M4YTM4M2ViMjBiODM3MTY5MzVlNmE=", "commit": {"author": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2021-09-01T11:55:16Z"}, "committer": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2021-09-09T05:21:29Z"}, "message": "Add a simple test case", "tree": {"sha": "6dc7e9775c1882ca00b6b69896e7b3c962265ac7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6dc7e9775c1882ca00b6b69896e7b3c962265ac7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f6f5180d5fef3b3a4cc8a383eb20b83716935e6a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEQ7Fl7qPq2YcWF1dqAn35M4hird0FAmE5mdkACgkQAn35M4hi\nrd14dg//ddUS+QJKyLdX+RcC6b0T0VHo3AUERaVP172XSiHmIfbRnY650ypH0kP4\nxz8Rc1XcA0/2FOkQTpPBKOTtH7k7DaixqJEiIbv8qNgOJ6lNadNILLmYbutMRjnk\nFcMYG5Bhs8miNS3pkj8y5Yyx/bpbezQXR9WkGWzf8R8HfwHolUx2ZeXRzHd4yd94\n8VBFEU/GAKH+NLbkfVnvS4poUd8OP0mfYwKEDDYVEpCNJuVsuDitokQ2qZx/E7/n\nOEmiUKNVP3z/4tKsR8zmJK0EmP5sbo1o8DPMEDwECdgPSkswW40Ye71Th7CA6c10\nV0+BQpO0fICKM3z7MPXG2vcaOw4Tvc2V3ne16wqLDYBxablbPpff6JDhlJ8MbzCU\nnJES2zWlsculaYysiEnaEIs1nK5pU+VeYz7osUg4383KzDMxJ5lXpVfwc7mPbyNR\nCnm474sVYODsB8bvP8kUIBUYkNlPNMDmlKFfrAnZ2GtumQ4Ake74ahLuERT+1HgG\nKAUefNh5FA1fcAtBZ4GRFhwaYVMtMZc3MuJS6IqkyCWy5Jqck/GANIeody3kxQRc\n/2e3olEGUusijg+y7auqRSEsJYcpJy5aXcPnhX/G9Kdmg1AP/HVVnUYIaLuhZmxp\nuouhvuKnjIDbBztBhPAyeagVqih3iSpzlQUWdVhxU5TgdqtsT88=\n=ziaD\n-----END PGP SIGNATURE-----", "payload": "tree 6dc7e9775c1882ca00b6b69896e7b3c962265ac7\nparent 9125fbfd60afd9dafca843857498232503be365a\nauthor Deadbeef <ent3rm4n@gmail.com> 1630497316 +0000\ncommitter Deadbeef <ent3rm4n@gmail.com> 1631164889 +0000\n\nAdd a simple test case\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f6f5180d5fef3b3a4cc8a383eb20b83716935e6a", "html_url": "https://github.com/rust-lang/rust/commit/f6f5180d5fef3b3a4cc8a383eb20b83716935e6a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f6f5180d5fef3b3a4cc8a383eb20b83716935e6a/comments", "author": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9125fbfd60afd9dafca843857498232503be365a", "url": "https://api.github.com/repos/rust-lang/rust/commits/9125fbfd60afd9dafca843857498232503be365a", "html_url": "https://github.com/rust-lang/rust/commit/9125fbfd60afd9dafca843857498232503be365a"}], "stats": {"total": 48, "additions": 48, "deletions": 0}, "files": [{"sha": "90fe28c7367b46bf476dd5a62df11526f10b10dd", "filename": "src/test/ui/rfc-2632-const-trait-impl/const-drop.rs", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/f6f5180d5fef3b3a4cc8a383eb20b83716935e6a/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fconst-drop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f6f5180d5fef3b3a4cc8a383eb20b83716935e6a/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fconst-drop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fconst-drop.rs?ref=f6f5180d5fef3b3a4cc8a383eb20b83716935e6a", "patch": "@@ -0,0 +1,23 @@\n+#![feature(const_trait_impl)]\n+#![feature(const_fn_trait_bound)]\n+#![feature(const_mut_refs)]\n+#![feature(const_panic)]\n+\n+struct S;\n+\n+impl const Drop for S {\n+    fn drop(&mut self) {\n+        // NB: There is no way to tell that a const destructor is ran,\n+        // because even if we can operate on mutable variables, it will\n+        // not be reflected because everything is `const`. So we panic\n+        // here, attempting to make the CTFE engine error.\n+        panic!(\"much const drop\")\n+        //~^ ERROR evaluation of constant value failed\n+    }\n+}\n+\n+const fn a<T: ~const Drop>(_: T) {}\n+\n+const _: () = a(S);\n+\n+fn main() {}"}, {"sha": "33eba4f4d25e9fff02c983a3669a4543e2b9e24f", "filename": "src/test/ui/rfc-2632-const-trait-impl/const-drop.stderr", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/f6f5180d5fef3b3a4cc8a383eb20b83716935e6a/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fconst-drop.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/f6f5180d5fef3b3a4cc8a383eb20b83716935e6a/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fconst-drop.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fconst-drop.stderr?ref=f6f5180d5fef3b3a4cc8a383eb20b83716935e6a", "patch": "@@ -0,0 +1,25 @@\n+error[E0080]: evaluation of constant value failed\n+  --> $DIR/const-drop.rs:14:9\n+   |\n+LL |         panic!(\"much const drop\")\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |         |\n+   |         the evaluated program panicked at 'much const drop', $DIR/const-drop.rs:14:9\n+   |         inside `<S as Drop>::drop` at $SRC_DIR/std/src/panic.rs:LL:COL\n+...\n+LL | const fn a<T: ~const Drop>(_: T) {}\n+   |                                   - inside `a::<S>` at $DIR/const-drop.rs:19:35\n+LL | \n+LL | const _: () = a(S);\n+   |               ---- inside `_` at $DIR/const-drop.rs:21:15\n+   |\n+  ::: $SRC_DIR/core/src/ptr/mod.rs:LL:COL\n+   |\n+LL | pub unsafe fn drop_in_place<T: ?Sized>(to_drop: *mut T) {\n+   | ------------------------------------------------------- inside `std::ptr::drop_in_place::<S> - shim(Some(S))` at $SRC_DIR/core/src/ptr/mod.rs:LL:COL\n+   |\n+   = note: this error originates in the macro `$crate::panic::panic_2015` (in Nightly builds, run with -Z macro-backtrace for more info)\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0080`."}]}