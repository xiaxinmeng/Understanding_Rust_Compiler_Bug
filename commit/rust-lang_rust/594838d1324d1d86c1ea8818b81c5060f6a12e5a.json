{"sha": "594838d1324d1d86c1ea8818b81c5060f6a12e5a", "node_id": "C_kwDOAAsO6NoAKDU5NDgzOGQxMzI0ZDFkODZjMWVhODgxOGI4MWM1MDYwZjZhMTJlNWE", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-10-08T15:11:45Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-10-13T12:09:08Z"}, "message": "smarter way to avoid 'unused' warning when building for tests", "tree": {"sha": "d6693afac631ab46f5bebd2f4b693fa0f78445dd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d6693afac631ab46f5bebd2f4b693fa0f78445dd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/594838d1324d1d86c1ea8818b81c5060f6a12e5a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/594838d1324d1d86c1ea8818b81c5060f6a12e5a", "html_url": "https://github.com/rust-lang/rust/commit/594838d1324d1d86c1ea8818b81c5060f6a12e5a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/594838d1324d1d86c1ea8818b81c5060f6a12e5a/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "600ac6959a824ca087b86cdd705ed9d1f3b73977", "url": "https://api.github.com/repos/rust-lang/rust/commits/600ac6959a824ca087b86cdd705ed9d1f3b73977", "html_url": "https://github.com/rust-lang/rust/commit/600ac6959a824ca087b86cdd705ed9d1f3b73977"}], "stats": {"total": 11, "additions": 2, "deletions": 9}, "files": [{"sha": "bbcc2f8b4c411328023b446480ccc3a7862cea1c", "filename": "library/std/src/thread/mod.rs", "status": "modified", "additions": 2, "deletions": 9, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/594838d1324d1d86c1ea8818b81c5060f6a12e5a/library%2Fstd%2Fsrc%2Fthread%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/594838d1324d1d86c1ea8818b81c5060f6a12e5a/library%2Fstd%2Fsrc%2Fthread%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fthread%2Fmod.rs?ref=594838d1324d1d86c1ea8818b81c5060f6a12e5a", "patch": "@@ -150,6 +150,8 @@\n \n #![stable(feature = \"rust1\", since = \"1.0.0\")]\n #![deny(unsafe_op_in_unsafe_fn)]\n+// Under `test`, `__FastLocalKeyInner` seems unused.\n+#![cfg_attr(test, allow(dead_code))]\n \n #[cfg(all(test, not(target_os = \"emscripten\")))]\n mod tests;\n@@ -218,15 +220,6 @@ pub use self::local::fast::Key as __FastLocalKeyInner;\n ))]\n pub use realstd::thread::__FastLocalKeyInner;\n \n-// but import the local one anyway to silence 'unused' warnings\n-#[unstable(feature = \"libstd_thread_internals\", issue = \"none\")]\n-#[cfg(test)]\n-#[cfg(all(\n-    target_thread_local,\n-    not(all(target_family = \"wasm\", not(target_feature = \"atomics\"))),\n-))]\n-pub use self::local::fast::Key as __FastLocalKeyInnerUnused;\n-\n #[unstable(feature = \"libstd_thread_internals\", issue = \"none\")]\n #[cfg(all(\n     not(target_thread_local),"}]}