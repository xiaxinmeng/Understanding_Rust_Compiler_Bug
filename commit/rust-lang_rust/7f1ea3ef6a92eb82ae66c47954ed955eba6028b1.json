{"sha": "7f1ea3ef6a92eb82ae66c47954ed955eba6028b1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdmMWVhM2VmNmE5MmViODJhZTY2YzQ3OTU0ZWQ5NTVlYmE2MDI4YjE=", "commit": {"author": {"name": "Marijn Haverbeke", "email": "marijnh@gmail.com", "date": "2012-02-10T14:48:25Z"}, "committer": {"name": "Marijn Haverbeke", "email": "marijnh@gmail.com", "date": "2012-02-10T14:54:47Z"}, "message": "Don't allow binding patterns to bind keywords\n\nCloses #1586", "tree": {"sha": "fa460453d74fece88c5c3b59d60d3bc7df3bac5d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fa460453d74fece88c5c3b59d60d3bc7df3bac5d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7f1ea3ef6a92eb82ae66c47954ed955eba6028b1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7f1ea3ef6a92eb82ae66c47954ed955eba6028b1", "html_url": "https://github.com/rust-lang/rust/commit/7f1ea3ef6a92eb82ae66c47954ed955eba6028b1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7f1ea3ef6a92eb82ae66c47954ed955eba6028b1/comments", "author": {"login": "marijnh", "id": 144427, "node_id": "MDQ6VXNlcjE0NDQyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/144427?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marijnh", "html_url": "https://github.com/marijnh", "followers_url": "https://api.github.com/users/marijnh/followers", "following_url": "https://api.github.com/users/marijnh/following{/other_user}", "gists_url": "https://api.github.com/users/marijnh/gists{/gist_id}", "starred_url": "https://api.github.com/users/marijnh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marijnh/subscriptions", "organizations_url": "https://api.github.com/users/marijnh/orgs", "repos_url": "https://api.github.com/users/marijnh/repos", "events_url": "https://api.github.com/users/marijnh/events{/privacy}", "received_events_url": "https://api.github.com/users/marijnh/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marijnh", "id": 144427, "node_id": "MDQ6VXNlcjE0NDQyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/144427?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marijnh", "html_url": "https://github.com/marijnh", "followers_url": "https://api.github.com/users/marijnh/followers", "following_url": "https://api.github.com/users/marijnh/following{/other_user}", "gists_url": "https://api.github.com/users/marijnh/gists{/gist_id}", "starred_url": "https://api.github.com/users/marijnh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marijnh/subscriptions", "organizations_url": "https://api.github.com/users/marijnh/orgs", "repos_url": "https://api.github.com/users/marijnh/repos", "events_url": "https://api.github.com/users/marijnh/events{/privacy}", "received_events_url": "https://api.github.com/users/marijnh/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fe8a31e56992a712b532350596af05186ac90613", "url": "https://api.github.com/repos/rust-lang/rust/commits/fe8a31e56992a712b532350596af05186ac90613", "html_url": "https://github.com/rust-lang/rust/commit/fe8a31e56992a712b532350596af05186ac90613"}], "stats": {"total": 38, "additions": 14, "deletions": 24}, "files": [{"sha": "8e2897407a3829eb309098a971b87092aac76f71", "filename": "src/comp/syntax/parse/parser.rs", "status": "modified", "additions": 14, "deletions": 5, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/7f1ea3ef6a92eb82ae66c47954ed955eba6028b1/src%2Fcomp%2Fsyntax%2Fparse%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7f1ea3ef6a92eb82ae66c47954ed955eba6028b1/src%2Fcomp%2Fsyntax%2Fparse%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fsyntax%2Fparse%2Fparser.rs?ref=7f1ea3ef6a92eb82ae66c47954ed955eba6028b1", "patch": "@@ -666,6 +666,15 @@ fn parse_path(p: parser) -> @ast::path {\n                  {global: global, idents: ids, types: []});\n }\n \n+fn parse_value_path(p: parser) -> @ast::path {\n+    let pt = parse_path(p);\n+    let last_word = pt.node.idents[vec::len(pt.node.idents)-1u];\n+    if p.bad_expr_words.contains_key(last_word) {\n+        p.fatal(\"found \" + last_word + \" in expression position\");\n+    }\n+    pt\n+}\n+\n fn parse_path_and_ty_param_substs(p: parser, colons: bool) -> @ast::path {\n     let lo = p.span.lo;\n     let path = parse_path(p);\n@@ -1510,11 +1519,11 @@ fn parse_pat(p: parser) -> @ast::pat {\n                 pat = ast::pat_lit(val);\n             }\n         } else if is_plain_ident(p) &&\n-                      alt p.look_ahead(1u) {\n-                        token::LPAREN | token::LBRACKET | token::LT { false }\n-                        _ { true }\n-                      } {\n-            let name = parse_path(p);\n+            alt p.look_ahead(1u) {\n+              token::LPAREN | token::LBRACKET | token::LT { false }\n+              _ { true }\n+            } {\n+            let name = parse_value_path(p);\n             let sub = if eat(p, token::AT) { some(parse_pat(p)) }\n                       else { none };\n             pat = ast::pat_ident(name, sub);"}, {"sha": "403e0bb07cb78134ab561b7ee03f1160957c8848", "filename": "src/test/compile-fail/reference-in-loop.rs", "status": "removed", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/fe8a31e56992a712b532350596af05186ac90613/src%2Ftest%2Fcompile-fail%2Freference-in-loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fe8a31e56992a712b532350596af05186ac90613/src%2Ftest%2Fcompile-fail%2Freference-in-loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Freference-in-loop.rs?ref=fe8a31e56992a712b532350596af05186ac90613", "patch": "@@ -1,10 +0,0 @@\n-// error-pattern: overwriting x will invalidate reference y\n-\n-fn main() {\n-    let x = [];\n-    let &y = x;\n-    while true {\n-        log(error, y);\n-        x = [1];\n-    }\n-}"}, {"sha": "20e4f27627edc520c7047ed95ea4515749feeff1", "filename": "src/test/run-pass/reference-branch.rs", "status": "removed", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/fe8a31e56992a712b532350596af05186ac90613/src%2Ftest%2Frun-pass%2Freference-branch.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fe8a31e56992a712b532350596af05186ac90613/src%2Ftest%2Frun-pass%2Freference-branch.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Freference-branch.rs?ref=fe8a31e56992a712b532350596af05186ac90613", "patch": "@@ -1,9 +0,0 @@\n-// Ensures that invalidating a reference in one branch doesn't\n-// influence other branches.\n-\n-fn main() {\n-    let x = [];\n-    let &y = x;\n-    if true { x = [1]; }\n-    else { log(error, y); }\n-}"}]}