{"sha": "82299c07de8dea84d6fa5f02580ee49f04dd74dd", "node_id": "MDY6Q29tbWl0NzI0NzEyOjgyMjk5YzA3ZGU4ZGVhODRkNmZhNWYwMjU4MGVlNDlmMDRkZDc0ZGQ=", "commit": {"author": {"name": "Flavio Percoco Premoli", "email": "flaper87@gmail.com", "date": "2015-01-24T09:42:40Z"}, "committer": {"name": "Flavio Percoco Premoli", "email": "flaper87@gmail.com", "date": "2015-01-24T09:42:40Z"}, "message": "Rollup merge of #21504 - blackbeam:has_test_signature_fix, r=alexcrichton\n\nFix for `error: functions used as tests must have signature fn() -> ()` and `error: functions used as benches must have signature `fn(&mut Bencher) -> ()` in case of explicit return type declaration.", "tree": {"sha": "610427c8fa81770a309219bf40cd0c30d476f7b5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/610427c8fa81770a309219bf40cd0c30d476f7b5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/82299c07de8dea84d6fa5f02580ee49f04dd74dd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/82299c07de8dea84d6fa5f02580ee49f04dd74dd", "html_url": "https://github.com/rust-lang/rust/commit/82299c07de8dea84d6fa5f02580ee49f04dd74dd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/82299c07de8dea84d6fa5f02580ee49f04dd74dd/comments", "author": {"login": "flaper87", "id": 13816, "node_id": "MDQ6VXNlcjEzODE2", "avatar_url": "https://avatars.githubusercontent.com/u/13816?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flaper87", "html_url": "https://github.com/flaper87", "followers_url": "https://api.github.com/users/flaper87/followers", "following_url": "https://api.github.com/users/flaper87/following{/other_user}", "gists_url": "https://api.github.com/users/flaper87/gists{/gist_id}", "starred_url": "https://api.github.com/users/flaper87/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flaper87/subscriptions", "organizations_url": "https://api.github.com/users/flaper87/orgs", "repos_url": "https://api.github.com/users/flaper87/repos", "events_url": "https://api.github.com/users/flaper87/events{/privacy}", "received_events_url": "https://api.github.com/users/flaper87/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flaper87", "id": 13816, "node_id": "MDQ6VXNlcjEzODE2", "avatar_url": "https://avatars.githubusercontent.com/u/13816?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flaper87", "html_url": "https://github.com/flaper87", "followers_url": "https://api.github.com/users/flaper87/followers", "following_url": "https://api.github.com/users/flaper87/following{/other_user}", "gists_url": "https://api.github.com/users/flaper87/gists{/gist_id}", "starred_url": "https://api.github.com/users/flaper87/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flaper87/subscriptions", "organizations_url": "https://api.github.com/users/flaper87/orgs", "repos_url": "https://api.github.com/users/flaper87/repos", "events_url": "https://api.github.com/users/flaper87/events{/privacy}", "received_events_url": "https://api.github.com/users/flaper87/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "65d14d2661bca8c6549d27b5d0bd81a8714f020b", "url": "https://api.github.com/repos/rust-lang/rust/commits/65d14d2661bca8c6549d27b5d0bd81a8714f020b", "html_url": "https://github.com/rust-lang/rust/commit/65d14d2661bca8c6549d27b5d0bd81a8714f020b"}, {"sha": "fd029209ec4901580b1cc0180098e0b4024bee5b", "url": "https://api.github.com/repos/rust-lang/rust/commits/fd029209ec4901580b1cc0180098e0b4024bee5b", "html_url": "https://github.com/rust-lang/rust/commit/fd029209ec4901580b1cc0180098e0b4024bee5b"}], "stats": {"total": 21, "additions": 21, "deletions": 0}, "files": [{"sha": "8933d3a966957c7496a7e466f8b61469f1d9a62f", "filename": "src/libsyntax/test.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/82299c07de8dea84d6fa5f02580ee49f04dd74dd/src%2Flibsyntax%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/82299c07de8dea84d6fa5f02580ee49f04dd74dd/src%2Flibsyntax%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ftest.rs?ref=82299c07de8dea84d6fa5f02580ee49f04dd74dd", "patch": "@@ -295,6 +295,7 @@ fn is_test_fn(cx: &TestCtxt, i: &ast::Item) -> bool {\n           &ast::ItemFn(ref decl, _, _, ref generics, _) => {\n             let no_output = match decl.output {\n                 ast::DefaultReturn(..) => true,\n+                ast::Return(ref t) if t.node == ast::TyTup(vec![]) => true,\n                 _ => false\n             };\n             if decl.inputs.is_empty()\n@@ -331,6 +332,7 @@ fn is_bench_fn(cx: &TestCtxt, i: &ast::Item) -> bool {\n                 let input_cnt = decl.inputs.len();\n                 let no_output = match decl.output {\n                     ast::DefaultReturn(..) => true,\n+                    ast::Return(ref t) if t.node == ast::TyTup(vec![]) => true,\n                     _ => false\n                 };\n                 let tparm_cnt = generics.ty_params.len();"}, {"sha": "65a6ed2b332ff140ad53b4b4516d912dea4b6c7b", "filename": "src/test/run-pass/test-fn-signature-verification-for-explicit-return-type.rs", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/82299c07de8dea84d6fa5f02580ee49f04dd74dd/src%2Ftest%2Frun-pass%2Ftest-fn-signature-verification-for-explicit-return-type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/82299c07de8dea84d6fa5f02580ee49f04dd74dd/src%2Ftest%2Frun-pass%2Ftest-fn-signature-verification-for-explicit-return-type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Ftest-fn-signature-verification-for-explicit-return-type.rs?ref=82299c07de8dea84d6fa5f02580ee49f04dd74dd", "patch": "@@ -0,0 +1,19 @@\n+// Copyright 2015 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// compile-flags: --test\n+extern crate test;\n+\n+#[bench]\n+fn bench_explicit_return_type(_: &mut ::test::Bencher) -> () {}\n+\n+#[test]\n+fn test_explicit_return_type() -> () {}\n+"}]}