{"sha": "65a02f1841fc7f99a8756bdc4c019bbf84103723", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY1YTAyZjE4NDFmYzdmOTlhODc1NmJkYzRjMDE5YmJmODQxMDM3MjM=", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2020-05-30T21:08:53Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-05-30T21:08:53Z"}, "message": "Rollup merge of #72668 - awoimbee:give-fn-parenthetical-notation-parentheses, r=estebank\n\nFix missing parentheses Fn notation error\n\nFixes  #72611\nWell, fixes the error output, I think E0658 is the right error to throw in this case so I didn't change that", "tree": {"sha": "c1712bd820afb873a03558085d7148018fe11038", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c1712bd820afb873a03558085d7148018fe11038"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/65a02f1841fc7f99a8756bdc4c019bbf84103723", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJe0stlCRBK7hj4Ov3rIwAAdHIIAFBO1U7Bu3dN3EC5Ldedk+rx\na6lN7yYob69pm5ERsBF6V8oVxS4f3b1A1+6hGpNZJ+Xb2NqSLIY3itGeaB0j8PDh\nI7Aa+iP4Dh/l0IM2DKiXMsWhreggkMHTjWgq4fFsP1NqXFEK39zj/Tb0KkG9Zhft\nEUcRQ1fW18++lUu3/m/15ctp0LzjrpY1+DkfQqzVc01VkOkuvhYmGgNKU8/A1qUA\nCb5NqZWyZE54xxxHNBSRo6fV4qHdCQEdRecgVua0IUhV0qRt00HEtarj6HlSinAH\nkT5rK704/dUGEC/fNp1G7onmZJu3U2m3I8tAPGiSbP8TewRWAJlOxfo3Et2LDVU=\n=hks3\n-----END PGP SIGNATURE-----\n", "payload": "tree c1712bd820afb873a03558085d7148018fe11038\nparent ffe329250b606e219182ceb5975ff1dcbc229b98\nparent c54d4fe93f1640fee0be7bfe9c525938dde558e8\nauthor Ralf Jung <post@ralfj.de> 1590872933 +0200\ncommitter GitHub <noreply@github.com> 1590872933 +0200\n\nRollup merge of #72668 - awoimbee:give-fn-parenthetical-notation-parentheses, r=estebank\n\nFix missing parentheses Fn notation error\n\nFixes  #72611\nWell, fixes the error output, I think E0658 is the right error to throw in this case so I didn't change that\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/65a02f1841fc7f99a8756bdc4c019bbf84103723", "html_url": "https://github.com/rust-lang/rust/commit/65a02f1841fc7f99a8756bdc4c019bbf84103723", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/65a02f1841fc7f99a8756bdc4c019bbf84103723/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ffe329250b606e219182ceb5975ff1dcbc229b98", "url": "https://api.github.com/repos/rust-lang/rust/commits/ffe329250b606e219182ceb5975ff1dcbc229b98", "html_url": "https://github.com/rust-lang/rust/commit/ffe329250b606e219182ceb5975ff1dcbc229b98"}, {"sha": "c54d4fe93f1640fee0be7bfe9c525938dde558e8", "url": "https://api.github.com/repos/rust-lang/rust/commits/c54d4fe93f1640fee0be7bfe9c525938dde558e8", "html_url": "https://github.com/rust-lang/rust/commit/c54d4fe93f1640fee0be7bfe9c525938dde558e8"}], "stats": {"total": 79, "additions": 77, "deletions": 2}, "files": [{"sha": "ab9db159038af09b5187dbe897006a5ef8d660a0", "filename": "src/librustc_typeck/astconv.rs", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/65a02f1841fc7f99a8756bdc4c019bbf84103723/src%2Flibrustc_typeck%2Fastconv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/65a02f1841fc7f99a8756bdc4c019bbf84103723/src%2Flibrustc_typeck%2Fastconv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fastconv.rs?ref=65a02f1841fc7f99a8756bdc4c019bbf84103723", "patch": "@@ -1151,9 +1151,16 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n                             .as_ref()\n                             .and_then(|args| args.args.get(0))\n                             .and_then(|arg| match arg {\n-                                hir::GenericArg::Type(ty) => {\n-                                    sess.source_map().span_to_snippet(ty.span).ok()\n+                                hir::GenericArg::Type(ty) => match ty.kind {\n+                                    hir::TyKind::Tup(t) => t\n+                                        .iter()\n+                                        .map(|e| sess.source_map().span_to_snippet(e.span))\n+                                        .collect::<Result<Vec<_>, _>>()\n+                                        .map(|a| a.join(\", \")),\n+                                    _ => sess.source_map().span_to_snippet(ty.span),\n                                 }\n+                                .map(|s| format!(\"({})\", s))\n+                                .ok(),\n                                 _ => None,\n                             })\n                             .unwrap_or_else(|| \"()\".to_string()),"}, {"sha": "cf940f4e9267a965e81e4224ee8f0d3d01b60ee4", "filename": "src/test/ui/suggestions/fn-trait-notation.fixed", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/65a02f1841fc7f99a8756bdc4c019bbf84103723/src%2Ftest%2Fui%2Fsuggestions%2Ffn-trait-notation.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/65a02f1841fc7f99a8756bdc4c019bbf84103723/src%2Ftest%2Fui%2Fsuggestions%2Ffn-trait-notation.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsuggestions%2Ffn-trait-notation.fixed?ref=65a02f1841fc7f99a8756bdc4c019bbf84103723", "patch": "@@ -0,0 +1,19 @@\n+// run-rustfix\n+fn e0658<F, G, H>(f: F, g: G, h: H) -> i32\n+where\n+    F: Fn(i32) -> i32, //~ ERROR E0658\n+    G: Fn(i32, i32) -> (i32, i32), //~ ERROR E0658\n+    H: Fn(i32) -> i32, //~ ERROR E0658\n+{\n+    f(3);\n+    g(3, 4);\n+    h(3)\n+}\n+\n+fn main() {\n+    e0658(\n+        |a| a,\n+        |a, b| (b, a),\n+        |a| a,\n+    );\n+}"}, {"sha": "f0bb03315d987a5e2d941a5e9e5f4127684bd9b5", "filename": "src/test/ui/suggestions/fn-trait-notation.rs", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/65a02f1841fc7f99a8756bdc4c019bbf84103723/src%2Ftest%2Fui%2Fsuggestions%2Ffn-trait-notation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/65a02f1841fc7f99a8756bdc4c019bbf84103723/src%2Ftest%2Fui%2Fsuggestions%2Ffn-trait-notation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsuggestions%2Ffn-trait-notation.rs?ref=65a02f1841fc7f99a8756bdc4c019bbf84103723", "patch": "@@ -0,0 +1,19 @@\n+// run-rustfix\n+fn e0658<F, G, H>(f: F, g: G, h: H) -> i32\n+where\n+    F: Fn<i32, Output = i32>, //~ ERROR E0658\n+    G: Fn<(i32, i32, ), Output = (i32, i32)>, //~ ERROR E0658\n+    H: Fn<(i32,), Output = i32>, //~ ERROR E0658\n+{\n+    f(3);\n+    g(3, 4);\n+    h(3)\n+}\n+\n+fn main() {\n+    e0658(\n+        |a| a,\n+        |a, b| (b, a),\n+        |a| a,\n+    );\n+}"}, {"sha": "3e3b54174401794aeea4d5269d9353a8c4ccab3d", "filename": "src/test/ui/suggestions/fn-trait-notation.stderr", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/65a02f1841fc7f99a8756bdc4c019bbf84103723/src%2Ftest%2Fui%2Fsuggestions%2Ffn-trait-notation.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/65a02f1841fc7f99a8756bdc4c019bbf84103723/src%2Ftest%2Fui%2Fsuggestions%2Ffn-trait-notation.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsuggestions%2Ffn-trait-notation.stderr?ref=65a02f1841fc7f99a8756bdc4c019bbf84103723", "patch": "@@ -0,0 +1,30 @@\n+error[E0658]: the precise format of `Fn`-family traits' type parameters is subject to change\n+  --> $DIR/fn-trait-notation.rs:4:8\n+   |\n+LL |     F: Fn<i32, Output = i32>,\n+   |        ^^^^^^^^^^^^^^^^^^^^^ help: use parenthetical notation instead: `Fn(i32) -> i32`\n+   |\n+   = note: see issue #29625 <https://github.com/rust-lang/rust/issues/29625> for more information\n+   = help: add `#![feature(unboxed_closures)]` to the crate attributes to enable\n+\n+error[E0658]: the precise format of `Fn`-family traits' type parameters is subject to change\n+  --> $DIR/fn-trait-notation.rs:5:8\n+   |\n+LL |     G: Fn<(i32, i32, ), Output = (i32, i32)>,\n+   |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use parenthetical notation instead: `Fn(i32, i32) -> (i32, i32)`\n+   |\n+   = note: see issue #29625 <https://github.com/rust-lang/rust/issues/29625> for more information\n+   = help: add `#![feature(unboxed_closures)]` to the crate attributes to enable\n+\n+error[E0658]: the precise format of `Fn`-family traits' type parameters is subject to change\n+  --> $DIR/fn-trait-notation.rs:6:8\n+   |\n+LL |     H: Fn<(i32,), Output = i32>,\n+   |        ^^^^^^^^^^^^^^^^^^^^^^^^ help: use parenthetical notation instead: `Fn(i32) -> i32`\n+   |\n+   = note: see issue #29625 <https://github.com/rust-lang/rust/issues/29625> for more information\n+   = help: add `#![feature(unboxed_closures)]` to the crate attributes to enable\n+\n+error: aborting due to 3 previous errors\n+\n+For more information about this error, try `rustc --explain E0658`."}]}