{"sha": "cf1172978729ecaf62492622498f4ca75137c390", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNmMTE3Mjk3ODcyOWVjYWY2MjQ5MjYyMjQ5OGY0Y2E3NTEzN2MzOTA=", "commit": {"author": {"name": "csmoe", "email": "csmoe@msn.com", "date": "2019-02-26T01:30:34Z"}, "committer": {"name": "csmoe", "email": "csmoe@msn.com", "date": "2019-02-26T16:39:13Z"}, "message": "rename Substs to InternalSubsts\n\nChange-Id: I3fa00e999a2ee4eb72db1fdf53a8633b49176a18", "tree": {"sha": "0051eed0f25ee0bbd531fa96208081e9ee826916", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0051eed0f25ee0bbd531fa96208081e9ee826916"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cf1172978729ecaf62492622498f4ca75137c390", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cf1172978729ecaf62492622498f4ca75137c390", "html_url": "https://github.com/rust-lang/rust/commit/cf1172978729ecaf62492622498f4ca75137c390", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cf1172978729ecaf62492622498f4ca75137c390/comments", "author": {"login": "csmoe", "id": 35686186, "node_id": "MDQ6VXNlcjM1Njg2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/35686186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/csmoe", "html_url": "https://github.com/csmoe", "followers_url": "https://api.github.com/users/csmoe/followers", "following_url": "https://api.github.com/users/csmoe/following{/other_user}", "gists_url": "https://api.github.com/users/csmoe/gists{/gist_id}", "starred_url": "https://api.github.com/users/csmoe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/csmoe/subscriptions", "organizations_url": "https://api.github.com/users/csmoe/orgs", "repos_url": "https://api.github.com/users/csmoe/repos", "events_url": "https://api.github.com/users/csmoe/events{/privacy}", "received_events_url": "https://api.github.com/users/csmoe/received_events", "type": "User", "site_admin": false}, "committer": {"login": "csmoe", "id": 35686186, "node_id": "MDQ6VXNlcjM1Njg2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/35686186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/csmoe", "html_url": "https://github.com/csmoe", "followers_url": "https://api.github.com/users/csmoe/followers", "following_url": "https://api.github.com/users/csmoe/following{/other_user}", "gists_url": "https://api.github.com/users/csmoe/gists{/gist_id}", "starred_url": "https://api.github.com/users/csmoe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/csmoe/subscriptions", "organizations_url": "https://api.github.com/users/csmoe/orgs", "repos_url": "https://api.github.com/users/csmoe/repos", "events_url": "https://api.github.com/users/csmoe/events{/privacy}", "received_events_url": "https://api.github.com/users/csmoe/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ccfa5d6df8ee061264c44bb8fbb3b3f35592ba92", "url": "https://api.github.com/repos/rust-lang/rust/commits/ccfa5d6df8ee061264c44bb8fbb3b3f35592ba92", "html_url": "https://github.com/rust-lang/rust/commit/ccfa5d6df8ee061264c44bb8fbb3b3f35592ba92"}], "stats": {"total": 378, "additions": 191, "deletions": 187}, "files": [{"sha": "3dace2f2e89b0ba7655c8643e492831264695dd5", "filename": "src/librustc/infer/error_reporting/mod.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Finfer%2Ferror_reporting%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Finfer%2Ferror_reporting%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Finfer%2Ferror_reporting%2Fmod.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -56,7 +56,7 @@ use crate::hir::Node;\n use crate::middle::region;\n use crate::traits::{ObligationCause, ObligationCauseCode};\n use crate::ty::error::TypeError;\n-use crate::ty::{self, subst::Subst, Region, Ty, TyCtxt, TyKind, TypeFoldable};\n+use crate::ty::{self, subst::{Subst, SubstsRef}, Region, Ty, TyCtxt, TyKind, TypeFoldable};\n use errors::{Applicability, DiagnosticBuilder, DiagnosticStyledString};\n use std::{cmp, fmt};\n use syntax_pos::{Pos, Span};\n@@ -570,7 +570,7 @@ impl<'a, 'gcx, 'tcx> InferCtxt<'a, 'gcx, 'tcx> {\n         value: &mut DiagnosticStyledString,\n         other_value: &mut DiagnosticStyledString,\n         name: String,\n-        sub: &ty::subst::Substs<'tcx>,\n+        sub: ty::subst::SubstsRef<'tcx>,\n         pos: usize,\n         other_ty: &Ty<'tcx>,\n     ) {\n@@ -648,7 +648,7 @@ impl<'a, 'gcx, 'tcx> InferCtxt<'a, 'gcx, 'tcx> {\n         mut t1_out: &mut DiagnosticStyledString,\n         mut t2_out: &mut DiagnosticStyledString,\n         path: String,\n-        sub: &ty::subst::Substs<'tcx>,\n+        sub: ty::subst::SubstsRef<'tcx>,\n         other_path: String,\n         other_ty: &Ty<'tcx>,\n     ) -> Option<()> {\n@@ -687,8 +687,8 @@ impl<'a, 'gcx, 'tcx> InferCtxt<'a, 'gcx, 'tcx> {\n     fn strip_generic_default_params(\n         &self,\n         def_id: DefId,\n-        substs: &ty::subst::Substs<'tcx>,\n-    ) -> &'tcx ty::subst::Substs<'tcx> {\n+        substs: ty::subst::SubstsRef<'tcx>,\n+    ) -> SubstsRef<'tcx> {\n         let generics = self.tcx.generics_of(def_id);\n         let mut num_supplied_defaults = 0;\n         let mut type_params = generics"}, {"sha": "84ad742d3c9722e4f252e90df12d3e225eaa23ff", "filename": "src/librustc/infer/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Finfer%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Finfer%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Finfer%2Fmod.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -18,7 +18,7 @@ use crate::traits::{self, ObligationCause, PredicateObligations, TraitEngine};\n use crate::ty::error::{ExpectedFound, TypeError, UnconstrainedNumeric};\n use crate::ty::fold::TypeFoldable;\n use crate::ty::relate::RelateResult;\n-use crate::ty::subst::{Kind, Substs, SubstsRef};\n+use crate::ty::subst::{Kind, InternalSubsts, SubstsRef};\n use crate::ty::{self, GenericParamDefKind, Ty, TyCtxt, CtxtInterners};\n use crate::ty::{FloatVid, IntVid, TyVid};\n use crate::util::nodemap::FxHashMap;\n@@ -1089,7 +1089,7 @@ impl<'a, 'gcx, 'tcx> InferCtxt<'a, 'gcx, 'tcx> {\n     /// Given a set of generics defined on a type or impl, returns a substitution mapping each\n     /// type/region parameter to a fresh inference variable.\n     pub fn fresh_substs_for_item(&self, span: Span, def_id: DefId) -> SubstsRef<'tcx> {\n-        Substs::for_item(self.tcx, def_id, |param, _| self.var_for_def(span, param))\n+        InternalSubsts::for_item(self.tcx, def_id, |param, _| self.var_for_def(span, param))\n     }\n \n     /// Returns `true` if errors have been reported since this infcx was"}, {"sha": "159bc1ceae26c2329ca0f152d10f2cd9002b4dbd", "filename": "src/librustc/infer/opaque_types/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Finfer%2Fopaque_types%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Finfer%2Fopaque_types%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Finfer%2Fopaque_types%2Fmod.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -9,7 +9,7 @@ use crate::traits::{self, PredicateObligation};\n use crate::ty::{self, Ty, TyCtxt, GenericParamDefKind};\n use crate::ty::fold::{BottomUpFolder, TypeFoldable, TypeFolder};\n use crate::ty::outlives::Component;\n-use crate::ty::subst::{Kind, Substs, SubstsRef, UnpackedKind};\n+use crate::ty::subst::{Kind, InternalSubsts, SubstsRef, UnpackedKind};\n use crate::util::nodemap::DefIdMap;\n \n pub type OpaqueTypeMap<'tcx> = DefIdMap<OpaqueTypeDecl<'tcx>>;\n@@ -437,7 +437,7 @@ impl<'a, 'gcx, 'tcx> InferCtxt<'a, 'gcx, 'tcx> {\n         // lifetimes with 'static and remapping only those used in the\n         // `impl Trait` return type, resulting in the parameters\n         // shifting.\n-        let id_substs = Substs::identity_for_item(gcx, def_id);\n+        let id_substs = InternalSubsts::identity_for_item(gcx, def_id);\n         let map: FxHashMap<Kind<'tcx>, Kind<'gcx>> = opaque_defn\n             .substs\n             .iter()"}, {"sha": "e1ad5aeea19fcb189ec636562a1eef7d1c3a3019", "filename": "src/librustc/infer/outlives/verify.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Finfer%2Foutlives%2Fverify.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Finfer%2Foutlives%2Fverify.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Finfer%2Foutlives%2Fverify.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -2,7 +2,7 @@ use crate::hir::def_id::DefId;\n use crate::infer::outlives::env::RegionBoundPairs;\n use crate::infer::{GenericKind, VerifyBound};\n use crate::traits;\n-use crate::ty::subst::{Subst, Substs};\n+use crate::ty::subst::{Subst, InternalSubsts};\n use crate::ty::{self, Ty, TyCtxt};\n use crate::util::captures::Captures;\n \n@@ -292,7 +292,7 @@ impl<'cx, 'gcx, 'tcx> VerifyBoundCx<'cx, 'gcx, 'tcx> {\n             .iter()\n             .map(|(p, _)| *p)\n             .collect();\n-        let identity_substs = Substs::identity_for_item(tcx, assoc_item_def_id);\n+        let identity_substs = InternalSubsts::identity_for_item(tcx, assoc_item_def_id);\n         let identity_proj = tcx.mk_projection(assoc_item_def_id, identity_substs);\n         self.collect_outlives_from_predicate_list(\n             move |ty| ty == identity_proj,"}, {"sha": "e93351197fe4702c269de8bb3b21fdac02554dc7", "filename": "src/librustc/traits/auto_trait.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fauto_trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fauto_trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Fauto_trait.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -631,7 +631,7 @@ impl<'a, 'tcx> AutoTraitFinder<'a, 'tcx> {\n         finished_map\n     }\n \n-    fn is_param_no_infer(&self, substs: &Substs<'_>) -> bool {\n+    fn is_param_no_infer(&self, substs: SubstsRef<'_>) -> bool {\n         return self.is_of_param(substs.type_at(0)) &&\n             !substs.types().any(|t| t.has_infer_types());\n     }"}, {"sha": "9b0a3820c859ce2fe7d13d928a91b4e0cae7af41", "filename": "src/librustc/traits/codegen/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fcodegen%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fcodegen%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Fcodegen%2Fmod.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -11,7 +11,7 @@ use syntax_pos::Span;\n use crate::traits::{FulfillmentContext, Obligation, ObligationCause, SelectionContext,\n              TraitEngine, Vtable};\n use crate::ty::{self, Ty, TyCtxt};\n-use crate::ty::subst::{Subst, Substs};\n+use crate::ty::subst::{Subst, SubstsRef};\n use crate::ty::fold::TypeFoldable;\n \n /// Attempts to resolve an obligation to a vtable. The result is\n@@ -82,7 +82,7 @@ impl<'a, 'tcx> TyCtxt<'a, 'tcx, 'tcx> {\n     /// types.\n     pub fn subst_and_normalize_erasing_regions<T>(\n         self,\n-        param_substs: &Substs<'tcx>,\n+        param_substs: SubstsRef<'tcx>,\n         param_env: ty::ParamEnv<'tcx>,\n         value: &T\n     ) -> T"}, {"sha": "ee7893a27de7dd6caad1226c9feff3498437fac1", "filename": "src/librustc/traits/mod.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Fmod.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -29,7 +29,7 @@ use crate::mir::interpret::ErrorHandled;\n use rustc_data_structures::sync::Lrc;\n use syntax::ast;\n use syntax_pos::{Span, DUMMY_SP};\n-use crate::ty::subst::{Substs, SubstsRef};\n+use crate::ty::subst::{InternalSubsts, SubstsRef};\n use crate::ty::{self, AdtKind, List, Ty, TyCtxt, GenericParamDefKind, ToPredicate};\n use crate::ty::error::{ExpectedFound, TypeError};\n use crate::ty::fold::{TypeFolder, TypeFoldable, TypeVisitor};\n@@ -992,7 +992,7 @@ fn vtable_methods<'a, 'tcx>(\n             let trait_methods = tcx.associated_items(trait_ref.def_id())\n                 .filter(|item| item.kind == ty::AssociatedKind::Method);\n \n-            // Now list each method's DefId and Substs (for within its trait).\n+            // Now list each method's DefId and InternalSubsts (for within its trait).\n             // If the method can never be called from this object, produce None.\n             trait_methods.map(move |trait_method| {\n                 debug!(\"vtable_methods: trait_method={:?}\", trait_method);\n@@ -1007,7 +1007,7 @@ fn vtable_methods<'a, 'tcx>(\n                 // the method may have some early-bound lifetimes, add\n                 // regions for those\n                 let substs = trait_ref.map_bound(|trait_ref|\n-                    Substs::for_item(tcx, def_id, |param, _|\n+                    InternalSubsts::for_item(tcx, def_id, |param, _|\n                         match param.kind {\n                             GenericParamDefKind::Lifetime => tcx.types.re_erased.into(),\n                             GenericParamDefKind::Type {..} => {"}, {"sha": "b2079c2516935c5e1c11b125b29608d72de7e310", "filename": "src/librustc/traits/object_safety.rs", "status": "modified", "additions": 13, "deletions": 9, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fobject_safety.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fobject_safety.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Fobject_safety.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -15,7 +15,7 @@ use crate::hir::def_id::DefId;\n use crate::lint;\n use crate::traits::{self, Obligation, ObligationCause};\n use crate::ty::{self, Ty, TyCtxt, TypeFoldable, Predicate, ToPredicate};\n-use crate::ty::subst::{Subst, Substs};\n+use crate::ty::subst::{Subst, InternalSubsts};\n use std::borrow::Cow;\n use std::iter::{self};\n use syntax::ast::{self, Name};\n@@ -406,7 +406,7 @@ impl<'a, 'tcx> TyCtxt<'a, 'tcx, 'tcx> {\n         self, receiver_ty: Ty<'tcx>, self_ty: Ty<'tcx>, method_def_id: DefId\n     ) -> Ty<'tcx> {\n         debug!(\"receiver_for_self_ty({:?}, {:?}, {:?})\", receiver_ty, self_ty, method_def_id);\n-        let substs = Substs::for_item(self, method_def_id, |param, _| {\n+        let substs = InternalSubsts::for_item(self, method_def_id, |param, _| {\n             if param.index == 0 {\n                 self_ty.into()\n             } else {\n@@ -559,13 +559,17 @@ impl<'a, 'tcx> TyCtxt<'a, 'tcx, 'tcx> {\n \n             // U: Trait<Arg1, ..., ArgN>\n             let trait_predicate = {\n-                let substs = Substs::for_item(self, method.container.assert_trait(), |param, _| {\n-                    if param.index == 0 {\n-                        unsized_self_ty.into()\n-                    } else {\n-                        self.mk_param_from_def(param)\n-                    }\n-                });\n+                let substs = InternalSubsts::for_item(\n+                    self,\n+                    method.container.assert_trait(),\n+                    |param, _| {\n+                        if param.index == 0 {\n+                            unsized_self_ty.into()\n+                        } else {\n+                            self.mk_param_from_def(param)\n+                        }\n+                    },\n+                );\n \n                 ty::TraitRef {\n                     def_id: unsize_did,"}, {"sha": "72df12bc535a66e304d38449951af9f9568395b8", "filename": "src/librustc/traits/project.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fproject.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fproject.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Fproject.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -18,7 +18,7 @@ use crate::infer::type_variable::TypeVariableOrigin;\n use crate::mir::interpret::{GlobalId};\n use rustc_data_structures::snapshot_map::{Snapshot, SnapshotMap};\n use syntax::ast::Ident;\n-use crate::ty::subst::{Subst, Substs};\n+use crate::ty::subst::{Subst, InternalSubsts};\n use crate::ty::{self, ToPredicate, ToPolyTraitRef, Ty, TyCtxt};\n use crate::ty::fold::{TypeFoldable, TypeFolder};\n use crate::util::common::FN_OUTPUT_NAME;\n@@ -401,7 +401,7 @@ impl<'a, 'b, 'gcx, 'tcx> TypeFolder<'gcx, 'tcx> for AssociatedTypeNormalizer<'a,\n             let tcx = self.selcx.tcx().global_tcx();\n             if let Some(param_env) = self.tcx().lift_to_global(&self.param_env) {\n                 if substs.needs_infer() || substs.has_placeholders() {\n-                    let identity_substs = Substs::identity_for_item(tcx, def_id);\n+                    let identity_substs = InternalSubsts::identity_for_item(tcx, def_id);\n                     let instance = ty::Instance::resolve(tcx, param_env, def_id, identity_substs);\n                     if let Some(instance) = instance {\n                         let cid = GlobalId {\n@@ -1490,7 +1490,7 @@ fn confirm_impl_candidate<'cx, 'gcx, 'tcx>(\n     }\n     let substs = translate_substs(selcx.infcx(), param_env, impl_def_id, substs, assoc_ty.node);\n     let ty = if let ty::AssociatedKind::Existential = assoc_ty.item.kind {\n-        let item_substs = Substs::identity_for_item(tcx, assoc_ty.item.def_id);\n+        let item_substs = InternalSubsts::identity_for_item(tcx, assoc_ty.item.def_id);\n         tcx.mk_opaque(assoc_ty.item.def_id, item_substs)\n     } else {\n         tcx.type_of(assoc_ty.item.def_id)"}, {"sha": "8a30c18d6e5f7fc565b638e93973acdc4ae829c2", "filename": "src/librustc/traits/query/normalize.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fquery%2Fnormalize.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fquery%2Fnormalize.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Fquery%2Fnormalize.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -9,7 +9,7 @@ use crate::mir::interpret::GlobalId;\n use crate::traits::project::Normalized;\n use crate::traits::{Obligation, ObligationCause, PredicateObligation, Reveal};\n use crate::ty::fold::{TypeFoldable, TypeFolder};\n-use crate::ty::subst::{Subst, Substs};\n+use crate::ty::subst::{Subst, InternalSubsts};\n use crate::ty::{self, Ty, TyCtxt};\n \n use super::NoSolution;\n@@ -193,7 +193,7 @@ impl<'cx, 'gcx, 'tcx> TypeFolder<'gcx, 'tcx> for QueryNormalizer<'cx, 'gcx, 'tcx\n             let tcx = self.infcx.tcx.global_tcx();\n             if let Some(param_env) = self.tcx().lift_to_global(&self.param_env) {\n                 if substs.needs_infer() || substs.has_placeholders() {\n-                    let identity_substs = Substs::identity_for_item(tcx, def_id);\n+                    let identity_substs = InternalSubsts::identity_for_item(tcx, def_id);\n                     let instance = ty::Instance::resolve(tcx, param_env, def_id, identity_substs);\n                     if let Some(instance) = instance {\n                         let cid = GlobalId {"}, {"sha": "e85b84bce4321d5e036c3ca67a9c70c46cd5e1d0", "filename": "src/librustc/traits/select.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fselect.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fselect.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Fselect.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -34,7 +34,7 @@ use crate::middle::lang_items;\n use crate::mir::interpret::GlobalId;\n use crate::ty::fast_reject;\n use crate::ty::relate::TypeRelation;\n-use crate::ty::subst::{Subst, Substs, SubstsRef};\n+use crate::ty::subst::{Subst, SubstsRef};\n use crate::ty::{self, ToPolyTraitRef, ToPredicate, Ty, TyCtxt, TypeFoldable};\n \n use crate::hir;\n@@ -3761,7 +3761,7 @@ impl<'cx, 'gcx, 'tcx> SelectionContext<'cx, 'gcx, 'tcx> {\n         recursion_depth: usize,\n         param_env: ty::ParamEnv<'tcx>,\n         def_id: DefId,         // of impl or trait\n-        substs: &Substs<'tcx>, // for impl or trait\n+        substs: SubstsRef<'tcx>,  // for impl or trait\n     ) -> Vec<PredicateObligation<'tcx>> {\n         debug!(\"impl_or_trait_obligations(def_id={:?})\", def_id);\n         let tcx = self.tcx();"}, {"sha": "1d84f22acd9f8cc0cebb0bddefc9827aa37d0201", "filename": "src/librustc/traits/specialize/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fspecialize%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Fspecialize%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Fspecialize%2Fmod.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -20,7 +20,7 @@ use rustc_data_structures::sync::Lrc;\n use syntax_pos::DUMMY_SP;\n use crate::traits::select::IntercrateAmbiguityCause;\n use crate::ty::{self, TyCtxt, TypeFoldable};\n-use crate::ty::subst::{Subst, Substs, SubstsRef};\n+use crate::ty::subst::{Subst, InternalSubsts, SubstsRef};\n \n use super::{SelectionContext, FulfillmentContext};\n use super::util::impl_trait_ref_and_oblig;\n@@ -399,7 +399,7 @@ fn to_pretty_impl_header(tcx: TyCtxt<'_, '_, '_>, impl_def_id: DefId) -> Option<\n \n     let mut w = \"impl\".to_owned();\n \n-    let substs = Substs::identity_for_item(tcx, impl_def_id);\n+    let substs = InternalSubsts::identity_for_item(tcx, impl_def_id);\n \n     // FIXME: Currently only handles ?Sized.\n     //        Needs to support ?Move and ?DynSized when they are implemented."}, {"sha": "c3223f0cd6331d9c8c1088b9b51d58384294a033", "filename": "src/librustc/traits/util.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Ftraits%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Futil.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -3,7 +3,7 @@ use crate::hir::def_id::DefId;\n use crate::traits::specialize::specialization_graph::NodeItem;\n use crate::ty::{self, Ty, TyCtxt, ToPredicate, ToPolyTraitRef};\n use crate::ty::outlives::Component;\n-use crate::ty::subst::{Kind, Subst, Substs};\n+use crate::ty::subst::{Kind, Subst, SubstsRef};\n use crate::util::nodemap::FxHashSet;\n \n use super::{Obligation, ObligationCause, PredicateObligation, SelectionContext, Normalized};\n@@ -358,7 +358,7 @@ impl<'tcx, I: Iterator<Item = ty::Predicate<'tcx>>> Iterator for FilterToTraits<\n pub fn impl_trait_ref_and_oblig<'a, 'gcx, 'tcx>(selcx: &mut SelectionContext<'a, 'gcx, 'tcx>,\n                                                 param_env: ty::ParamEnv<'tcx>,\n                                                 impl_def_id: DefId,\n-                                                impl_substs: &Substs<'tcx>)\n+                                                impl_substs: SubstsRef<'tcx>,)\n                                                 -> (ty::TraitRef<'tcx>,\n                                                     Vec<PredicateObligation<'tcx>>)\n {"}, {"sha": "b37b632f4beec655cec6b0dc9191f6ccb1e2597a", "filename": "src/librustc/ty/context.rs", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fcontext.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -22,7 +22,7 @@ use crate::middle::resolve_lifetime::{self, ObjectLifetimeDefault};\n use crate::middle::stability;\n use crate::mir::{self, Mir, interpret, ProjectionKind};\n use crate::mir::interpret::Allocation;\n-use crate::ty::subst::{Kind, Substs, Subst, SubstsRef};\n+use crate::ty::subst::{Kind, InternalSubsts, Subst, SubstsRef};\n use crate::ty::ReprOptions;\n use crate::traits;\n use crate::traits::{Clause, Clauses, GoalKind, Goal, Goals};\n@@ -118,7 +118,7 @@ pub struct CtxtInterners<'tcx> {\n     /// they're accessed quite often.\n     type_: InternedSet<'tcx, TyS<'tcx>>,\n     type_list: InternedSet<'tcx, List<Ty<'tcx>>>,\n-    substs: InternedSet<'tcx, Substs<'tcx>>,\n+    substs: InternedSet<'tcx, InternalSubsts<'tcx>>,\n     canonical_var_infos: InternedSet<'tcx, List<CanonicalVarInfo>>,\n     region: InternedSet<'tcx, RegionKind>,\n     existential_predicates: InternedSet<'tcx, List<ExistentialPredicate<'tcx>>>,\n@@ -557,7 +557,7 @@ impl<'tcx> TypeckTables<'tcx> {\n \n     pub fn node_substs(&self, id: hir::HirId) -> SubstsRef<'tcx> {\n         validate_hir_id_for_typeck_tables(self.local_id_root, id, false);\n-        self.node_substs.get(&id.local_id).cloned().unwrap_or_else(|| Substs::empty())\n+        self.node_substs.get(&id.local_id).cloned().unwrap_or_else(|| InternalSubsts::empty())\n     }\n \n     pub fn node_substs_opt(&self, id: hir::HirId) -> Option<SubstsRef<'tcx>> {\n@@ -1807,7 +1807,7 @@ nop_list_lift!{Predicate<'a> => Predicate<'tcx>}\n nop_list_lift!{CanonicalVarInfo => CanonicalVarInfo}\n nop_list_lift!{ProjectionKind<'a> => ProjectionKind<'tcx>}\n \n-// this is the impl for `&'a Substs<'a>`\n+// this is the impl for `&'a InternalSubsts<'a>`\n nop_list_lift!{Kind<'a> => Kind<'tcx>}\n \n impl<'a, 'tcx> Lift<'tcx> for &'a mir::interpret::Allocation {\n@@ -2183,7 +2183,7 @@ impl<'a, 'tcx> TyCtxt<'a, 'tcx, 'tcx> {\n             Generator, GeneratorWitness, Dynamic, Closure, Tuple, Bound,\n             Param, Infer, UnnormalizedProjection, Projection, Opaque, Foreign);\n \n-        println!(\"Substs interner: #{}\", self.interners.substs.borrow().len());\n+        println!(\"InternalSubsts interner: #{}\", self.interners.substs.borrow().len());\n         println!(\"Region interner: #{}\", self.interners.region.borrow().len());\n         println!(\"Stability interner: #{}\", self.stability_interner.borrow().len());\n         println!(\"Allocation interner: #{}\", self.allocation_interner.borrow().len());\n@@ -2250,7 +2250,7 @@ impl<'tcx: 'lcx, 'lcx> Borrow<[CanonicalVarInfo]> for Interned<'tcx, List<Canoni\n     }\n }\n \n-impl<'tcx: 'lcx, 'lcx> Borrow<[Kind<'lcx>]> for Interned<'tcx, Substs<'tcx>> {\n+impl<'tcx: 'lcx, 'lcx> Borrow<[Kind<'lcx>]> for Interned<'tcx, InternalSubsts<'tcx>> {\n     fn borrow<'a>(&'a self) -> &'a [Kind<'lcx>] {\n         &self.0[..]\n     }\n@@ -2520,7 +2520,7 @@ impl<'a, 'gcx, 'tcx> TyCtxt<'a, 'gcx, 'tcx> {\n     pub fn mk_box(self, ty: Ty<'tcx>) -> Ty<'tcx> {\n         let def_id = self.require_lang_item(lang_items::OwnedBoxLangItem);\n         let adt_def = self.adt_def(def_id);\n-        let substs = Substs::for_item(self, def_id, |param, substs| {\n+        let substs = InternalSubsts::for_item(self, def_id, |param, substs| {\n             match param.kind {\n                 GenericParamDefKind::Lifetime => bug!(),\n                 GenericParamDefKind::Type { has_default, .. } => {"}, {"sha": "2b12dcca93ad7c7a1022c66d3030aaf90b9b5336", "filename": "src/librustc/ty/flags.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Fflags.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Fflags.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fflags.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -1,4 +1,4 @@\n-use crate::ty::subst::Substs;\n+use crate::ty::subst::SubstsRef;\n use crate::ty::{self, Ty, TypeFlags, TypeFoldable};\n \n #[derive(Debug)]\n@@ -241,7 +241,7 @@ impl FlagComputation {\n         self.add_substs(projection_ty.substs);\n     }\n \n-    fn add_substs(&mut self, substs: &Substs<'_>) {\n+    fn add_substs(&mut self, substs: SubstsRef<'_>) {\n         for ty in substs.types() {\n             self.add_ty(ty);\n         }"}, {"sha": "5243c4dbfd209ea6787857c5697a5adc2d762203", "filename": "src/librustc/ty/mod.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fmod.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -22,7 +22,7 @@ use crate::session::CrateDisambiguator;\n use crate::traits::{self, Reveal};\n use crate::ty;\n use crate::ty::layout::VariantIdx;\n-use crate::ty::subst::{Subst, Substs, SubstsRef};\n+use crate::ty::subst::{Subst, InternalSubsts, SubstsRef};\n use crate::ty::util::{IntTypeExt, Discr};\n use crate::ty::walk::TypeWalker;\n use crate::util::captures::Captures;\n@@ -982,14 +982,14 @@ impl<'tcx> serialize::UseSpecializedEncodable for GenericPredicates<'tcx> {}\n impl<'tcx> serialize::UseSpecializedDecodable for GenericPredicates<'tcx> {}\n \n impl<'a, 'gcx, 'tcx> GenericPredicates<'tcx> {\n-    pub fn instantiate(&self, tcx: TyCtxt<'a, 'gcx, 'tcx>, substs: &Substs<'tcx>)\n+    pub fn instantiate(&self, tcx: TyCtxt<'a, 'gcx, 'tcx>, substs: SubstsRef<'tcx>)\n                        -> InstantiatedPredicates<'tcx> {\n         let mut instantiated = InstantiatedPredicates::empty();\n         self.instantiate_into(tcx, &mut instantiated, substs);\n         instantiated\n     }\n \n-    pub fn instantiate_own(&self, tcx: TyCtxt<'a, 'gcx, 'tcx>, substs: &Substs<'tcx>)\n+    pub fn instantiate_own(&self, tcx: TyCtxt<'a, 'gcx, 'tcx>, substs: SubstsRef<'tcx>)\n                            -> InstantiatedPredicates<'tcx> {\n         InstantiatedPredicates {\n             predicates: self.predicates.iter().map(|(p, _)| p.subst(tcx, substs)).collect(),\n@@ -998,7 +998,7 @@ impl<'a, 'gcx, 'tcx> GenericPredicates<'tcx> {\n \n     fn instantiate_into(&self, tcx: TyCtxt<'a, 'gcx, 'tcx>,\n                         instantiated: &mut InstantiatedPredicates<'tcx>,\n-                        substs: &Substs<'tcx>) {\n+                        substs: SubstsRef<'tcx>) {\n         if let Some(def_id) = self.parent {\n             tcx.predicates_of(def_id).instantiate_into(tcx, instantiated, substs);\n         }\n@@ -2261,7 +2261,7 @@ impl<'a, 'gcx, 'tcx> AdtDef {\n     ) -> Option<Discr<'tcx>> {\n         let param_env = ParamEnv::empty();\n         let repr_type = self.repr.discr_type();\n-        let substs = Substs::identity_for_item(tcx.global_tcx(), expr_did);\n+        let substs = InternalSubsts::identity_for_item(tcx.global_tcx(), expr_did);\n         let instance = ty::Instance::new(expr_did, substs);\n         let cid = GlobalId {\n             instance,\n@@ -2463,7 +2463,7 @@ impl<'a, 'gcx, 'tcx> AdtDef {\n }\n \n impl<'a, 'gcx, 'tcx> FieldDef {\n-    pub fn ty(&self, tcx: TyCtxt<'a, 'gcx, 'tcx>, subst: &Substs<'tcx>) -> Ty<'tcx> {\n+    pub fn ty(&self, tcx: TyCtxt<'a, 'gcx, 'tcx>, subst: SubstsRef<'tcx>) -> Ty<'tcx> {\n         tcx.type_of(self.did).subst(tcx, subst)\n     }\n }"}, {"sha": "df8b14b1f10c71c80cb801ce939f9c0ec2a4a0e9", "filename": "src/librustc/ty/sty.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Fsty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Fsty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fsty.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -7,7 +7,7 @@ use crate::mir::interpret::{ConstValue, truncate};\n use crate::middle::region;\n use polonius_engine::Atom;\n use rustc_data_structures::indexed_vec::Idx;\n-use crate::ty::subst::{Substs, Subst, SubstsRef, Kind, UnpackedKind};\n+use crate::ty::subst::{InternalSubsts, Subst, SubstsRef, Kind, UnpackedKind};\n use crate::ty::{self, AdtDef, TypeFlags, Ty, TyCtxt, TypeFoldable};\n use crate::ty::{List, TyS, ParamEnvAnd, ParamEnv};\n use crate::util::captures::Captures;\n@@ -101,7 +101,7 @@ pub enum TyKind<'tcx> {\n \n     /// Structures, enumerations and unions.\n     ///\n-    /// Substs here, possibly against intuition, *may* contain `Param`s.\n+    /// InternalSubsts here, possibly against intuition, *may* contain `Param`s.\n     /// That is, even after substitution it is possible that there are type\n     /// variables. This happens when the `Adt` corresponds to an ADT\n     /// definition and not a concrete use of it.\n@@ -685,7 +685,7 @@ impl<'tcx> TraitRef<'tcx> {\n     pub fn identity<'a, 'gcx>(tcx: TyCtxt<'a, 'gcx, 'tcx>, def_id: DefId) -> TraitRef<'tcx> {\n         TraitRef {\n             def_id,\n-            substs: Substs::identity_for_item(tcx, def_id),\n+            substs: InternalSubsts::identity_for_item(tcx, def_id),\n         }\n     }\n \n@@ -704,7 +704,7 @@ impl<'tcx> TraitRef<'tcx> {\n \n     pub fn from_method(tcx: TyCtxt<'_, '_, 'tcx>,\n                        trait_id: DefId,\n-                       substs: &Substs<'tcx>)\n+                       substs: SubstsRef<'tcx>)\n                        -> ty::TraitRef<'tcx> {\n         let defs = tcx.generics_of(trait_id);\n \n@@ -1120,7 +1120,7 @@ pub type Region<'tcx> = &'tcx RegionKind;\n /// These are regions that are stored behind a binder and must be substituted\n /// with some concrete region before being used. There are two kind of\n /// bound regions: early-bound, which are bound in an item's `Generics`,\n-/// and are substituted by a `Substs`, and late-bound, which are part of\n+/// and are substituted by a `InternalSubsts`, and late-bound, which are part of\n /// higher-ranked types (e.g., `for<'a> fn(&'a ())`), and are substituted by\n /// the likes of `liberate_late_bound_regions`. The distinction exists\n /// because higher-ranked lifetimes aren't supported in all places. See [1][2]."}, {"sha": "450fab81661fc72336319c4298ca548ff3b220bf", "filename": "src/librustc/ty/subst.rs", "status": "modified", "additions": 14, "deletions": 14, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Fsubst.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Fsubst.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fsubst.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -157,28 +157,28 @@ impl<'tcx> Decodable for Kind<'tcx> {\n }\n \n /// A substitution mapping generic parameters to new values.\n-pub type Substs<'tcx> = List<Kind<'tcx>>;\n+pub type InternalSubsts<'tcx> = List<Kind<'tcx>>;\n \n-pub type SubstsRef<'tcx> = &'tcx Substs<'tcx>;\n+pub type SubstsRef<'tcx> = &'tcx InternalSubsts<'tcx>;\n \n-impl<'a, 'gcx, 'tcx> Substs<'tcx> {\n-    /// Creates a `Substs` that maps each generic parameter to itself.\n+impl<'a, 'gcx, 'tcx> InternalSubsts<'tcx> {\n+    /// Creates a `InternalSubsts` that maps each generic parameter to itself.\n     pub fn identity_for_item(tcx: TyCtxt<'a, 'gcx, 'tcx>, def_id: DefId)\n                              -> SubstsRef<'tcx> {\n-        Substs::for_item(tcx, def_id, |param, _| {\n+        Self::for_item(tcx, def_id, |param, _| {\n             tcx.mk_param_from_def(param)\n         })\n     }\n \n-    /// Creates a `Substs` that maps each generic parameter to a higher-ranked\n+    /// Creates a `InternalSubsts` that maps each generic parameter to a higher-ranked\n     /// var bound at index `0`. For types, we use a `BoundVar` index equal to\n     /// the type parameter index. For regions, we use the `BoundRegion::BrNamed`\n     /// variant (which has a `DefId`).\n     pub fn bound_vars_for_item(\n         tcx: TyCtxt<'a, 'gcx, 'tcx>,\n         def_id: DefId\n     ) -> SubstsRef<'tcx> {\n-        Substs::for_item(tcx, def_id, |param, _| {\n+        Self::for_item(tcx, def_id, |param, _| {\n             match param.kind {\n                 ty::GenericParamDefKind::Type { .. } => {\n                     tcx.mk_ty(\n@@ -199,9 +199,9 @@ impl<'a, 'gcx, 'tcx> Substs<'tcx> {\n         })\n     }\n \n-    /// Creates a `Substs` for generic parameter definitions,\n+    /// Creates a `InternalSubsts` for generic parameter definitions,\n     /// by calling closures to obtain each kind.\n-    /// The closures get to observe the `Substs` as they're\n+    /// The closures get to observe the `InternalSubsts` as they're\n     /// being built, which can be used to correctly\n     /// substitute defaults of generic parameters.\n     pub fn for_item<F>(tcx: TyCtxt<'a, 'gcx, 'tcx>,\n@@ -213,7 +213,7 @@ impl<'a, 'gcx, 'tcx> Substs<'tcx> {\n         let defs = tcx.generics_of(def_id);\n         let count = defs.count();\n         let mut substs = SmallVec::with_capacity(count);\n-        Substs::fill_item(&mut substs, tcx, defs, &mut mk_kind);\n+        Self::fill_item(&mut substs, tcx, defs, &mut mk_kind);\n         tcx.intern_substs(&substs)\n     }\n \n@@ -224,7 +224,7 @@ impl<'a, 'gcx, 'tcx> Substs<'tcx> {\n                         -> SubstsRef<'tcx>\n     where F: FnMut(&ty::GenericParamDef, &[Kind<'tcx>]) -> Kind<'tcx>\n     {\n-        Substs::for_item(tcx, def_id, |param, substs| {\n+        Self::for_item(tcx, def_id, |param, substs| {\n             self.get(param.index as usize)\n                 .cloned()\n                 .unwrap_or_else(|| mk_kind(param, substs))\n@@ -239,9 +239,9 @@ impl<'a, 'gcx, 'tcx> Substs<'tcx> {\n     {\n         if let Some(def_id) = defs.parent {\n             let parent_defs = tcx.generics_of(def_id);\n-            Substs::fill_item(substs, tcx, parent_defs, mk_kind);\n+            Self::fill_item(substs, tcx, parent_defs, mk_kind);\n         }\n-        Substs::fill_single(substs, defs, mk_kind)\n+        Self::fill_single(substs, defs, mk_kind)\n     }\n \n     fn fill_single<F>(substs: &mut SmallVec<[Kind<'tcx>; 8]>,\n@@ -313,7 +313,7 @@ impl<'a, 'gcx, 'tcx> Substs<'tcx> {\n     /// parameters (e.g., method parameters) on top of that base.\n     pub fn rebase_onto(&self, tcx: TyCtxt<'a, 'gcx, 'tcx>,\n                        source_ancestor: DefId,\n-                       target_substs: &Substs<'tcx>)\n+                       target_substs: SubstsRef<'tcx>)\n                        -> SubstsRef<'tcx> {\n         let defs = tcx.generics_of(source_ancestor);\n         tcx.mk_substs(target_substs.iter().chain(&self[defs.params.len()..]).cloned())"}, {"sha": "7374eba2e317b466da5bf9b5880fedc12cfd1988", "filename": "src/librustc/ty/util.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Futil.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -7,7 +7,7 @@ use crate::hir::{self, Node};\n use crate::ich::NodeIdHashingMode;\n use crate::traits::{self, ObligationCause};\n use crate::ty::{self, Ty, TyCtxt, GenericParamDefKind, TypeFoldable};\n-use crate::ty::subst::{Subst, Substs, SubstsRef, UnpackedKind};\n+use crate::ty::subst::{Subst, InternalSubsts, SubstsRef, UnpackedKind};\n use crate::ty::query::TyCtxtAt;\n use crate::ty::TyKind::*;\n use crate::ty::layout::{Integer, IntegerExt};\n@@ -589,7 +589,7 @@ impl<'a, 'gcx, 'tcx> TyCtxt<'a, 'gcx, 'tcx> {\n     /// Given the `DefId` of some item that has no type parameters, make\n     /// a suitable \"empty substs\" for it.\n     pub fn empty_substs_for_def_id(self, item_def_id: DefId) -> SubstsRef<'tcx> {\n-        Substs::for_item(self, item_def_id, |param, _| {\n+        InternalSubsts::for_item(self, item_def_id, |param, _| {\n             match param.kind {\n                 GenericParamDefKind::Lifetime => self.types.re_erased.into(),\n                 GenericParamDefKind::Type {..} => {"}, {"sha": "d9f309ae58e0357b3c03f1bb99921963b9287c1c", "filename": "src/librustc/ty/walk.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Fwalk.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Fwalk.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fwalk.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -99,7 +99,7 @@ fn push_subtypes<'tcx>(stack: &mut TypeWalkerStack<'tcx>, parent_ty: Ty<'tcx>) {\n                         (p.substs, Some(p.ty)),\n                     ty::ExistentialPredicate::AutoTrait(_) =>\n                         // Empty iterator\n-                        (ty::Substs::empty(), None),\n+                        (ty::InternalSubsts::empty(), None),\n                 };\n \n                 substs.types().rev().chain(opt_ty)"}, {"sha": "599d38bc4ab6ee56c76fee7d674729b5e3ac0784", "filename": "src/librustc/ty/wf.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Fwf.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Fty%2Fwf.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fwf.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -1,7 +1,7 @@\n use crate::hir;\n use crate::hir::def_id::DefId;\n use crate::infer::InferCtxt;\n-use crate::ty::subst::Substs;\n+use crate::ty::subst::SubstsRef;\n use crate::traits;\n use crate::ty::{self, ToPredicate, Ty, TyCtxt, TypeFoldable};\n use std::iter::once;\n@@ -432,7 +432,7 @@ impl<'a, 'gcx, 'tcx> WfPredicates<'a, 'gcx, 'tcx> {\n \n     fn nominal_obligations(&mut self,\n                            def_id: DefId,\n-                           substs: &Substs<'tcx>)\n+                           substs: SubstsRef<'tcx>)\n                            -> Vec<traits::PredicateObligation<'tcx>>\n     {\n         let predicates ="}, {"sha": "fbe9e3359bfeb7437d7af7d80ec27ad60c9c2515", "filename": "src/librustc/util/ppaux.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Futil%2Fppaux.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc%2Futil%2Fppaux.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Futil%2Fppaux.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -1,7 +1,7 @@\n use crate::hir::def_id::DefId;\n use crate::hir::map::definitions::DefPathData;\n use crate::middle::region;\n-use crate::ty::subst::{self, Subst};\n+use crate::ty::subst::{self, Subst, SubstsRef};\n use crate::ty::{BrAnon, BrEnv, BrFresh, BrNamed};\n use crate::ty::{Bool, Char, Adt};\n use crate::ty::{Error, Str, Array, Slice, Float, FnDef, FnPtr};\n@@ -384,7 +384,7 @@ impl PrintContext {\n \n     fn parameterized<F: fmt::Write>(&mut self,\n                                     f: &mut F,\n-                                    substs: &subst::Substs<'_>,\n+                                    substs: SubstsRef<'_>,\n                                     did: DefId,\n                                     projections: &[ty::ProjectionPredicate<'_>])\n                                     -> fmt::Result {\n@@ -692,7 +692,7 @@ pub fn identify_regions() -> bool {\n }\n \n pub fn parameterized<F: fmt::Write>(f: &mut F,\n-                                    substs: &subst::Substs<'_>,\n+                                    substs: SubstsRef<'_>,\n                                     did: DefId,\n                                     projections: &[ty::ProjectionPredicate<'_>])\n                                     -> fmt::Result {\n@@ -1290,7 +1290,7 @@ define_print! {\n                         Ok(())\n                     }\n                 }\n-                Foreign(def_id) => parameterized(f, subst::Substs::empty(), def_id, &[]),\n+                Foreign(def_id) => parameterized(f, subst::InternalSubsts::empty(), def_id, &[]),\n                 Projection(ref data) => data.print(f, cx),\n                 UnnormalizedProjection(ref data) => {\n                     write!(f, \"Unnormalized(\")?;"}, {"sha": "c0869bb889afaba430b916ab5278f651bd076079", "filename": "src/librustc_codegen_llvm/debuginfo/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_codegen_llvm%2Fdebuginfo%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_codegen_llvm%2Fdebuginfo%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fdebuginfo%2Fmod.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -15,7 +15,7 @@ use crate::llvm::debuginfo::{DIFile, DIType, DIScope, DIBuilder, DISubprogram, D\n     DISPFlags, DILexicalBlock};\n use rustc::hir::CodegenFnAttrFlags;\n use rustc::hir::def_id::{DefId, CrateNum, LOCAL_CRATE};\n-use rustc::ty::subst::{Substs, UnpackedKind};\n+use rustc::ty::subst::{SubstsRef, UnpackedKind};\n \n use crate::abi::Abi;\n use crate::common::CodegenCx;\n@@ -399,7 +399,7 @@ impl DebugInfoMethods<'tcx> for CodegenCx<'ll, 'tcx> {\n         fn get_template_parameters<'ll, 'tcx>(\n             cx: &CodegenCx<'ll, 'tcx>,\n             generics: &ty::Generics,\n-            substs: &Substs<'tcx>,\n+            substs: SubstsRef<'tcx>,\n             file_metadata: &'ll DIFile,\n             name_to_append_suffix_to: &mut String,\n         ) -> &'ll DIArray {"}, {"sha": "176c9b8c542b184172cd2bb63bf78f1ff86c0c5b", "filename": "src/librustc_codegen_llvm/debuginfo/type_names.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_codegen_llvm%2Fdebuginfo%2Ftype_names.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_codegen_llvm%2Fdebuginfo%2Ftype_names.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fdebuginfo%2Ftype_names.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -2,7 +2,7 @@\n \n use crate::common::CodegenCx;\n use rustc::hir::def_id::DefId;\n-use rustc::ty::subst::Substs;\n+use rustc::ty::subst::SubstsRef;\n use rustc::ty::{self, Ty};\n use rustc_codegen_ssa::traits::*;\n \n@@ -193,13 +193,13 @@ pub fn push_debuginfo_type_name<'a, 'tcx>(cx: &CodegenCx<'a, 'tcx>,\n         }\n     }\n \n-    // Pushes the type parameters in the given `Substs` to the output string.\n+    // Pushes the type parameters in the given `InternalSubsts` to the output string.\n     // This ignores region parameters, since they can't reliably be\n     // reconstructed for items from non-local crates. For local crates, this\n     // would be possible but with inlining and LTO we have to use the least\n     // common denominator - otherwise we would run into conflicts.\n     fn push_type_params<'a, 'tcx>(cx: &CodegenCx<'a, 'tcx>,\n-                                  substs: &Substs<'tcx>,\n+                                  substs: SubstsRef<'tcx>,\n                                   output: &mut String) {\n         if substs.types().next().is_none() {\n             return;"}, {"sha": "785f810d9415907fd89da70fae1e9c5fa3c62bdf", "filename": "src/librustc_mir/borrow_check/nll/region_infer/mod.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fregion_infer%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fregion_infer%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fregion_infer%2Fmod.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -14,7 +14,7 @@ use rustc::mir::{\n     ClosureOutlivesRequirement, ClosureOutlivesSubject, ClosureRegionRequirements,\n     ConstraintCategory, Local, Location, Mir,\n };\n-use rustc::ty::{self, RegionVid, Ty, TyCtxt, TypeFoldable};\n+use rustc::ty::{self, subst::SubstsRef, RegionVid, Ty, TyCtxt, TypeFoldable};\n use rustc::util::common::{self, ErrorReported};\n use rustc_data_structures::bit_set::BitSet;\n use rustc_data_structures::fx::{FxHashMap, FxHashSet};\n@@ -1359,7 +1359,7 @@ pub trait ClosureRegionRequirementsExt<'gcx, 'tcx> {\n         tcx: TyCtxt<'_, 'gcx, 'tcx>,\n         location: Location,\n         closure_def_id: DefId,\n-        closure_substs: &'tcx ty::subst::Substs<'tcx>,\n+        closure_substs: SubstsRef<'tcx>,\n     ) -> Vec<QueryRegionConstraint<'tcx>>;\n \n     fn subst_closure_mapping<T>(\n@@ -1390,7 +1390,7 @@ impl<'gcx, 'tcx> ClosureRegionRequirementsExt<'gcx, 'tcx> for ClosureRegionRequi\n         tcx: TyCtxt<'_, 'gcx, 'tcx>,\n         location: Location,\n         closure_def_id: DefId,\n-        closure_substs: &'tcx ty::subst::Substs<'tcx>,\n+        closure_substs: SubstsRef<'tcx>,\n     ) -> Vec<QueryRegionConstraint<'tcx>> {\n         debug!(\n             \"apply_requirements(location={:?}, closure_def_id={:?}, closure_substs={:?})\","}, {"sha": "4d9a3775b31230f83d94404ca73ff902d17a5cc7", "filename": "src/librustc_mir/borrow_check/nll/universal_regions.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Funiversal_regions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Funiversal_regions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Funiversal_regions.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -17,7 +17,7 @@ use rustc::hir::def_id::DefId;\n use rustc::hir::{self, BodyOwnerKind, HirId};\n use rustc::infer::{InferCtxt, NLLRegionVariableOrigin};\n use rustc::ty::fold::TypeFoldable;\n-use rustc::ty::subst::{Substs, SubstsRef};\n+use rustc::ty::subst::{InternalSubsts, SubstsRef};\n use rustc::ty::{self, ClosureSubsts, GeneratorSubsts, RegionVid, Ty, TyCtxt};\n use rustc::util::nodemap::FxHashMap;\n use rustc_data_structures::indexed_vec::{Idx, IndexVec};\n@@ -138,7 +138,7 @@ struct UniversalRegionIndices<'tcx> {\n     /// used because trait matching and type-checking will feed us\n     /// region constraints that reference those regions and we need to\n     /// be able to map them our internal `RegionVid`. This is\n-    /// basically equivalent to a `Substs`, except that it also\n+    /// basically equivalent to a `InternalSubsts`, except that it also\n     /// contains an entry for `ReStatic` -- it might be nice to just\n     /// use a substs, and then handle `ReStatic` another way.\n     indices: FxHashMap<ty::Region<'tcx>, RegionVid>,\n@@ -507,7 +507,7 @@ impl<'cx, 'gcx, 'tcx> UniversalRegionsBuilder<'cx, 'gcx, 'tcx> {\n \n             BodyOwnerKind::Const | BodyOwnerKind::Static(..) => {\n                 assert_eq!(closure_base_def_id, self.mir_def_id);\n-                let identity_substs = Substs::identity_for_item(tcx, closure_base_def_id);\n+                let identity_substs = InternalSubsts::identity_for_item(tcx, closure_base_def_id);\n                 let substs = self.infcx\n                     .replace_free_regions_with_nll_infer_vars(FR, &identity_substs);\n                 DefiningTy::Const(self.mir_def_id, substs)\n@@ -527,7 +527,7 @@ impl<'cx, 'gcx, 'tcx> UniversalRegionsBuilder<'cx, 'gcx, 'tcx> {\n         let tcx = self.infcx.tcx;\n         let gcx = tcx.global_tcx();\n         let closure_base_def_id = tcx.closure_base_def_id(self.mir_def_id);\n-        let identity_substs = Substs::identity_for_item(gcx, closure_base_def_id);\n+        let identity_substs = InternalSubsts::identity_for_item(gcx, closure_base_def_id);\n         let fr_substs = match defining_ty {\n             DefiningTy::Closure(_, ClosureSubsts { ref substs })\n             | DefiningTy::Generator(_, GeneratorSubsts { ref substs }, _) => {"}, {"sha": "5548366db66ecf75930be90c6b46bf67a2ce1762", "filename": "src/librustc_mir/hair/cx/expr.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fhair%2Fcx%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fhair%2Fcx%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fhair%2Fcx%2Fexpr.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -9,7 +9,7 @@ use rustc::mir::interpret::{GlobalId, ErrorHandled};\n use rustc::ty::{self, AdtKind, Ty};\n use rustc::ty::adjustment::{Adjustment, Adjust, AutoBorrow, AutoBorrowMutability};\n use rustc::ty::cast::CastKind as TyCastKind;\n-use rustc::ty::subst::{Substs, SubstsRef};\n+use rustc::ty::subst::{InternalSubsts, SubstsRef};\n use rustc::hir;\n use rustc::hir::def_id::LocalDefId;\n use rustc::mir::BorrowKind;\n@@ -561,7 +561,7 @@ fn make_mirror_unadjusted<'a, 'gcx, 'tcx>(cx: &mut Cx<'a, 'gcx, 'tcx>,\n         // Now comes the rote stuff:\n         hir::ExprKind::Repeat(ref v, ref count) => {\n             let def_id = cx.tcx.hir().local_def_id(count.id);\n-            let substs = Substs::identity_for_item(cx.tcx.global_tcx(), def_id);\n+            let substs = InternalSubsts::identity_for_item(cx.tcx.global_tcx(), def_id);\n             let instance = ty::Instance::resolve(\n                 cx.tcx.global_tcx(),\n                 cx.param_env,\n@@ -717,7 +717,7 @@ fn make_mirror_unadjusted<'a, 'gcx, 'tcx>(cx: &mut Cx<'a, 'gcx, 'tcx>,\n                         Some(did) => {\n                             // in case we are offsetting from a computed discriminant\n                             // and not the beginning of discriminants (which is always `0`)\n-                            let substs = Substs::identity_for_item(cx.tcx(), did);\n+                            let substs = InternalSubsts::identity_for_item(cx.tcx(), did);\n                             let lhs = mk_const(ty::LazyConst::Unevaluated(did, substs));\n                             let bin = ExprKind::Binary {\n                                 op: BinOp::Add,"}, {"sha": "70f04fb892866814111092e3af74106b6f4a9323", "filename": "src/librustc_mir/hair/cx/mod.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fhair%2Fcx%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fhair%2Fcx%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fhair%2Fcx%2Fmod.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -12,7 +12,7 @@ use rustc::middle::region;\n use rustc::infer::InferCtxt;\n use rustc::ty::subst::Subst;\n use rustc::ty::{self, Ty, TyCtxt};\n-use rustc::ty::subst::{Kind, Substs};\n+use rustc::ty::subst::{Kind, InternalSubsts};\n use rustc::ty::layout::VariantIdx;\n use syntax::ast;\n use syntax::attr;\n@@ -29,8 +29,8 @@ pub struct Cx<'a, 'gcx: 'a + 'tcx, 'tcx: 'a> {\n     pub root_lint_level: hir::HirId,\n     pub param_env: ty::ParamEnv<'gcx>,\n \n-    /// Identity `Substs` for use with const-evaluation.\n-    pub identity_substs: &'gcx Substs<'gcx>,\n+    /// Identity `InternalSubsts` for use with const-evaluation.\n+    pub identity_substs: &'gcx InternalSubsts<'gcx>,\n \n     pub region_scope_tree: Lrc<region::ScopeTree>,\n     pub tables: &'a ty::TypeckTables<'gcx>,\n@@ -82,7 +82,7 @@ impl<'a, 'gcx, 'tcx> Cx<'a, 'gcx, 'tcx> {\n             infcx,\n             root_lint_level: lint_level,\n             param_env: tcx.param_env(src_def_id),\n-            identity_substs: Substs::identity_for_item(tcx.global_tcx(), src_def_id),\n+            identity_substs: InternalSubsts::identity_for_item(tcx.global_tcx(), src_def_id),\n             region_scope_tree: tcx.region_scope_tree(src_def_id),\n             tables: tcx.typeck_tables_of(src_def_id),\n             constness,"}, {"sha": "9e9a5d0f82ada34712aef90aba9b42f339919e01", "filename": "src/librustc_mir/hair/pattern/_match.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fhair%2Fpattern%2F_match.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fhair%2Fpattern%2F_match.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fhair%2Fpattern%2F_match.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -168,7 +168,7 @@ use super::{PatternFoldable, PatternFolder, compare_const_vals};\n \n use rustc::hir::def_id::DefId;\n use rustc::hir::RangeEnd;\n-use rustc::ty::{self, Ty, TyCtxt, TypeFoldable, Const};\n+use rustc::ty::{self, subst::SubstsRef, Ty, TyCtxt, TypeFoldable, Const};\n use rustc::ty::layout::{Integer, IntegerExt, VariantIdx, Size};\n \n use rustc::mir::Field;\n@@ -402,7 +402,7 @@ impl<'a, 'tcx> MatchCheckCtxt<'a, 'tcx> {\n \n     fn is_variant_uninhabited(&self,\n                               variant: &'tcx ty::VariantDef,\n-                              substs: &'tcx ty::subst::Substs<'tcx>)\n+                              substs: SubstsRef<'tcx>)\n                               -> bool\n     {\n         if self.tcx.features().exhaustive_patterns {"}, {"sha": "9cecf4af7d44a4462f77aadd3163d9059d8be577", "filename": "src/librustc_mir/hair/pattern/check_match.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fhair%2Fpattern%2Fcheck_match.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fhair%2Fpattern%2Fcheck_match.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fhair%2Fpattern%2Fcheck_match.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -11,7 +11,7 @@ use rustc::middle::mem_categorization::cmt_;\n use rustc::middle::region;\n use rustc::session::Session;\n use rustc::ty::{self, Ty, TyCtxt};\n-use rustc::ty::subst::{Substs, SubstsRef};\n+use rustc::ty::subst::{InternalSubsts, SubstsRef};\n use rustc::lint;\n use rustc_errors::{Applicability, DiagnosticBuilder};\n use rustc::util::common::ErrorReported;\n@@ -51,7 +51,7 @@ pub(crate) fn check_match<'a, 'tcx>(\n             tables: tcx.body_tables(body_id),\n             region_scope_tree: &tcx.region_scope_tree(def_id),\n             param_env: tcx.param_env(def_id),\n-            identity_substs: Substs::identity_for_item(tcx, def_id),\n+            identity_substs: InternalSubsts::identity_for_item(tcx, def_id),\n         }.visit_body(tcx.hir().body(body_id));\n     })\n }"}, {"sha": "c795b412bfa93611f0726499ee9325f155508ef8", "filename": "src/librustc_mir/lints.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Flints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Flints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Flints.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -5,7 +5,7 @@ use rustc::hir::map::blocks::FnLikeNode;\n use rustc::lint::builtin::UNCONDITIONAL_RECURSION;\n use rustc::mir::{self, Mir, TerminatorKind};\n use rustc::ty::{AssociatedItem, AssociatedItemContainer, Instance, TyCtxt, TyKind};\n-use rustc::ty::subst::Substs;\n+use rustc::ty::subst::InternalSubsts;\n \n pub fn check(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n              mir: &Mir<'tcx>,\n@@ -69,7 +69,7 @@ fn check_fn_for_unconditional_recursion(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n             }) => tcx.generics_of(trait_def_id).count(),\n             _ => 0\n         };\n-    let caller_substs = &Substs::identity_for_item(tcx, def_id)[..trait_substs_count];\n+    let caller_substs = &InternalSubsts::identity_for_item(tcx, def_id)[..trait_substs_count];\n \n     while let Some(bb) = reachable_without_self_call_queue.pop() {\n         if visited.contains(bb) {"}, {"sha": "4cec306412e8bf9dc923ae06a9a5bb16bf2da6a5", "filename": "src/librustc_mir/monomorphize/collector.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fmonomorphize%2Fcollector.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fmonomorphize%2Fcollector.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fmonomorphize%2Fcollector.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -180,7 +180,7 @@ use rustc::hir::itemlikevisit::ItemLikeVisitor;\n use rustc::hir::def_id::{DefId, LOCAL_CRATE};\n use rustc::mir::interpret::{AllocId, ConstValue};\n use rustc::middle::lang_items::{ExchangeMallocFnLangItem, StartFnLangItem};\n-use rustc::ty::subst::{Substs, SubstsRef};\n+use rustc::ty::subst::{InternalSubsts, SubstsRef};\n use rustc::ty::{self, TypeFoldable, Ty, TyCtxt, GenericParamDefKind};\n use rustc::ty::adjustment::CustomCoerceUnsized;\n use rustc::session::config::EntryFnType;\n@@ -956,7 +956,7 @@ impl<'b, 'a, 'v> ItemLikeVisitor<'v> for RootCollector<'b, 'a, 'v> {\n                         debug!(\"RootCollector: ADT drop-glue for {}\",\n                                def_id_to_string(self.tcx, def_id));\n \n-                        let ty = Instance::new(def_id, Substs::empty()).ty(self.tcx);\n+                        let ty = Instance::new(def_id, InternalSubsts::empty()).ty(self.tcx);\n                         visit_drop_use(self.tcx, ty, true, self.output);\n                     }\n                 }\n@@ -1116,7 +1116,7 @@ fn create_mono_items_for_default_impls<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n                         continue;\n                     }\n \n-                    let substs = Substs::for_item(tcx, method.def_id, |param, _| {\n+                    let substs = InternalSubsts::for_item(tcx, method.def_id, |param, _| {\n                         match param.kind {\n                             GenericParamDefKind::Lifetime => tcx.types.re_erased.into(),\n                             GenericParamDefKind::Type {..} => {"}, {"sha": "a26a1a7861eb0146ef84c80ba6232a80ed990180", "filename": "src/librustc_mir/monomorphize/item.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fmonomorphize%2Fitem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fmonomorphize%2Fitem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fmonomorphize%2Fitem.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -3,7 +3,7 @@ use rustc::hir;\n use rustc::hir::def_id::{DefId, LOCAL_CRATE};\n use rustc::session::config::OptLevel;\n use rustc::ty::{self, Ty, TyCtxt, ClosureSubsts, GeneratorSubsts};\n-use rustc::ty::subst::Substs;\n+use rustc::ty::subst::{SubstsRef, InternalSubsts};\n use syntax::ast;\n use syntax::attr::InlineAttr;\n use std::fmt::{self, Write};\n@@ -151,7 +151,7 @@ pub trait MonoItemExt<'a, 'tcx>: fmt::Debug {\n         debug!(\"is_instantiable({:?})\", self);\n         let (def_id, substs) = match *self.as_mono_item() {\n             MonoItem::Fn(ref instance) => (instance.def_id(), instance.substs),\n-            MonoItem::Static(def_id) => (def_id, Substs::empty()),\n+            MonoItem::Static(def_id) => (def_id, InternalSubsts::empty()),\n             // global asm never has predicates\n             MonoItem::GlobalAsm(..) => return true\n         };\n@@ -422,7 +422,7 @@ impl<'a, 'tcx> DefPathBasedNames<'a, 'tcx> {\n     }\n \n     fn push_type_params<I>(&self,\n-                            substs: &Substs<'tcx>,\n+                            substs: SubstsRef<'tcx>,\n                             projections: I,\n                             output: &mut String,\n                             debug: bool)"}, {"sha": "ce7c9af81cb0741d56d2402956a6287a03ef5b9b", "filename": "src/librustc_mir/shim.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fshim.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Fshim.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fshim.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -4,7 +4,7 @@ use rustc::infer;\n use rustc::mir::*;\n use rustc::ty::{self, Ty, TyCtxt, GenericParamDefKind};\n use rustc::ty::layout::VariantIdx;\n-use rustc::ty::subst::{Subst, Substs};\n+use rustc::ty::subst::{Subst, InternalSubsts};\n use rustc::ty::query::Providers;\n \n use rustc_data_structures::indexed_vec::{IndexVec, Idx};\n@@ -183,7 +183,7 @@ fn build_drop_shim<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n     let substs = if let Some(ty) = ty {\n         tcx.intern_substs(&[ty.into()])\n     } else {\n-        Substs::identity_for_item(tcx, def_id)\n+        InternalSubsts::identity_for_item(tcx, def_id)\n     };\n     let sig = tcx.fn_sig(def_id).subst(tcx, substs);\n     let sig = tcx.erase_late_bound_regions(&sig);\n@@ -451,7 +451,7 @@ impl<'a, 'tcx> CloneShimBuilder<'a, 'tcx> {\n     ) {\n         let tcx = self.tcx;\n \n-        let substs = Substs::for_item(tcx, self.def_id, |param, _| {\n+        let substs = InternalSubsts::for_item(tcx, self.def_id, |param, _| {\n             match param.kind {\n                 GenericParamDefKind::Lifetime => tcx.types.re_erased.into(),\n                 GenericParamDefKind::Type {..} => ty.into(),"}, {"sha": "5ed0055e7c4f43862e034f03e8bd0e8b6ab7f335", "filename": "src/librustc_mir/transform/const_prop.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Ftransform%2Fconst_prop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_mir%2Ftransform%2Fconst_prop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Ftransform%2Fconst_prop.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -10,7 +10,7 @@ use rustc::mir::visit::{Visitor, PlaceContext, MutatingUseContext, NonMutatingUs\n use rustc::mir::interpret::{EvalErrorKind, Scalar, GlobalId, EvalResult};\n use rustc::ty::{TyCtxt, self, Instance};\n use syntax::source_map::{Span, DUMMY_SP};\n-use rustc::ty::subst::Substs;\n+use rustc::ty::subst::InternalSubsts;\n use rustc_data_structures::indexed_vec::IndexVec;\n use rustc::ty::ParamEnv;\n use rustc::ty::layout::{\n@@ -288,7 +288,7 @@ impl<'a, 'mir, 'tcx> ConstPropagator<'a, 'mir, 'tcx> {\n                     // FIXME: can't handle code with generics\n                     return None;\n                 }\n-                let substs = Substs::identity_for_item(self.tcx, self.source.def_id());\n+                let substs = InternalSubsts::identity_for_item(self.tcx, self.source.def_id());\n                 let instance = Instance::new(self.source.def_id(), substs);\n                 let cid = GlobalId {\n                     instance,"}, {"sha": "6b8e37b3b31330b2ecd5d7ba0e9aad410b73f409", "filename": "src/librustc_passes/rvalue_promotion.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_passes%2Frvalue_promotion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_passes%2Frvalue_promotion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_passes%2Frvalue_promotion.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -22,7 +22,7 @@ use rustc::middle::mem_categorization as mc;\n use rustc::middle::mem_categorization::Categorization;\n use rustc::ty::{self, Ty, TyCtxt};\n use rustc::ty::query::Providers;\n-use rustc::ty::subst::{Substs, SubstsRef};\n+use rustc::ty::subst::{InternalSubsts, SubstsRef};\n use rustc::util::nodemap::{ItemLocalSet, HirIdSet};\n use rustc::hir;\n use rustc_data_structures::sync::Lrc;\n@@ -75,7 +75,7 @@ fn rvalue_promotable_map<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n         in_static: false,\n         mut_rvalue_borrows: Default::default(),\n         param_env: ty::ParamEnv::empty(),\n-        identity_substs: Substs::empty(),\n+        identity_substs: InternalSubsts::empty(),\n         result: ItemLocalSet::default(),\n     };\n \n@@ -199,7 +199,7 @@ impl<'a, 'tcx> CheckCrateVisitor<'a, 'tcx> {\n \n         self.tables = self.tcx.typeck_tables_of(item_def_id);\n         self.param_env = self.tcx.param_env(item_def_id);\n-        self.identity_substs = Substs::identity_for_item(self.tcx, item_def_id);\n+        self.identity_substs = InternalSubsts::identity_for_item(self.tcx, item_def_id);\n \n         let body = self.tcx.hir().body(body_id);\n "}, {"sha": "27103ab99651bd68ae0cadd4061962245fdd3ab9", "filename": "src/librustc_privacy/lib.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_privacy%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_privacy%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_privacy%2Flib.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -20,7 +20,7 @@ use rustc::middle::privacy::{AccessLevel, AccessLevels};\n use rustc::ty::{self, TyCtxt, Ty, TraitRef, TypeFoldable, GenericParamDefKind};\n use rustc::ty::fold::TypeVisitor;\n use rustc::ty::query::Providers;\n-use rustc::ty::subst::Substs;\n+use rustc::ty::subst::InternalSubsts;\n use rustc::util::nodemap::HirIdSet;\n use rustc_data_structures::fx::FxHashSet;\n use rustc_data_structures::sync::Lrc;\n@@ -127,7 +127,7 @@ impl<'a, 'tcx, V> TypeVisitor<'tcx> for DefIdVisitorSkeleton<'_, 'a, 'tcx, V>\n {\n     fn visit_ty(&mut self, ty: Ty<'tcx>) -> bool {\n         let tcx = self.def_id_visitor.tcx();\n-        // Substs are not visited here because they are visited below in `super_visit_with`.\n+        // InternalSubsts are not visited here because they are visited below in `super_visit_with`.\n         match ty.sty {\n             ty::Adt(&ty::AdtDef { did: def_id, .. }, ..) |\n             ty::Foreign(def_id) |\n@@ -180,7 +180,7 @@ impl<'a, 'tcx, V> TypeVisitor<'tcx> for DefIdVisitorSkeleton<'_, 'a, 'tcx, V>\n                         ty::ExistentialPredicate::Trait(trait_ref) => trait_ref,\n                         ty::ExistentialPredicate::Projection(proj) => proj.trait_ref(tcx),\n                         ty::ExistentialPredicate::AutoTrait(def_id) =>\n-                            ty::ExistentialTraitRef { def_id, substs: Substs::empty() },\n+                            ty::ExistentialTraitRef { def_id, substs: InternalSubsts::empty() },\n                     };\n                     let ty::ExistentialTraitRef { def_id, substs: _ } = trait_ref;\n                     if self.def_id_visitor.visit_def_id(def_id, \"trait\", &trait_ref) {"}, {"sha": "ac572b652130c74b591e867909fb1c6b1c27481e", "filename": "src/librustc_resolve/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_resolve%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_resolve%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Flib.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -863,7 +863,7 @@ impl<'a, 'tcx> Visitor<'tcx> for Resolver<'a> {\n \n     fn visit_generics(&mut self, generics: &'tcx Generics) {\n         // For type parameter defaults, we have to ban access\n-        // to following type parameters, as the Substs can only\n+        // to following type parameters, as the InternalSubsts can only\n         // provide previous type parameters as they're built. We\n         // put all the parameters on the ban list and then remove\n         // them one by one as they are processed and become available."}, {"sha": "4d8a67ca638634b69999b0b306749ab1958ccc3a", "filename": "src/librustc_traits/chalk_context/program_clauses.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_traits%2Fchalk_context%2Fprogram_clauses.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_traits%2Fchalk_context%2Fprogram_clauses.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_traits%2Fchalk_context%2Fprogram_clauses.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -10,7 +10,7 @@ use rustc::traits::{\n     Environment,\n };\n use rustc::ty;\n-use rustc::ty::subst::{Substs, Subst};\n+use rustc::ty::subst::{InternalSubsts, Subst};\n use rustc::hir;\n use rustc::hir::def_id::DefId;\n use rustc_target::spec::abi;\n@@ -129,7 +129,7 @@ fn assemble_builtin_sized_impls<'tcx>(\n \n         // Struct def\n         ty::Adt(adt_def, _) => {\n-            let substs = Substs::bound_vars_for_item(tcx, adt_def.did);\n+            let substs = InternalSubsts::bound_vars_for_item(tcx, adt_def.did);\n             let adt = tcx.mk_ty(ty::Adt(adt_def, substs));\n             let sized_constraint = adt_def.sized_constraint(tcx)\n                 .iter()"}, {"sha": "49fcb7cd8335532546e82a0ce5b97fbb409a30de", "filename": "src/librustc_traits/dropck_outlives.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_traits%2Fdropck_outlives.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_traits%2Fdropck_outlives.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_traits%2Fdropck_outlives.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -4,7 +4,7 @@ use rustc::traits::query::dropck_outlives::{DropckOutlivesResult, DtorckConstrai\n use rustc::traits::query::{CanonicalTyGoal, NoSolution};\n use rustc::traits::{TraitEngine, Normalized, ObligationCause, TraitEngineExt};\n use rustc::ty::query::Providers;\n-use rustc::ty::subst::{Subst, Substs};\n+use rustc::ty::subst::{Subst, InternalSubsts};\n use rustc::ty::{self, ParamEnvAnd, Ty, TyCtxt};\n use rustc::util::nodemap::FxHashSet;\n use rustc_data_structures::sync::Lrc;\n@@ -291,7 +291,7 @@ crate fn adt_dtorck_constraint<'a, 'tcx>(\n     if def.is_phantom_data() {\n         // The first generic parameter here is guaranteed to be a type because it's\n         // `PhantomData`.\n-        let substs = Substs::identity_for_item(tcx, def_id);\n+        let substs = InternalSubsts::identity_for_item(tcx, def_id);\n         assert_eq!(substs.len(), 1);\n         let result = DtorckConstraint {\n             outlives: vec![],"}, {"sha": "634c024b064660f840b593d153efa68ce050fe5d", "filename": "src/librustc_traits/generic_types.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_traits%2Fgeneric_types.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_traits%2Fgeneric_types.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_traits%2Fgeneric_types.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -1,7 +1,7 @@\n //! Utilities for creating generic types with bound vars in place of parameter values.\n \n use rustc::ty::{self, Ty, TyCtxt};\n-use rustc::ty::subst::Substs;\n+use rustc::ty::subst::InternalSubsts;\n use rustc::hir;\n use rustc::hir::def_id::DefId;\n use rustc_target::spec::abi;\n@@ -64,17 +64,17 @@ crate fn ref_ty(tcx: ty::TyCtxt<'_, '_, 'tcx>, mutbl: hir::Mutability) -> Ty<'tc\n }\n \n crate fn fn_def(tcx: ty::TyCtxt<'_, '_, 'tcx>, def_id: DefId) -> Ty<'tcx> {\n-    tcx.mk_ty(ty::FnDef(def_id, Substs::bound_vars_for_item(tcx, def_id)))\n+    tcx.mk_ty(ty::FnDef(def_id, InternalSubsts::bound_vars_for_item(tcx, def_id)))\n }\n \n crate fn closure(tcx: ty::TyCtxt<'_, '_, 'tcx>, def_id: DefId) -> Ty<'tcx> {\n     tcx.mk_closure(def_id, ty::ClosureSubsts {\n-        substs: Substs::bound_vars_for_item(tcx, def_id),\n+        substs: InternalSubsts::bound_vars_for_item(tcx, def_id),\n     })\n }\n \n crate fn generator(tcx: ty::TyCtxt<'_, '_, 'tcx>, def_id: DefId) -> Ty<'tcx> {\n     tcx.mk_generator(def_id, ty::GeneratorSubsts {\n-        substs: Substs::bound_vars_for_item(tcx, def_id),\n+        substs: InternalSubsts::bound_vars_for_item(tcx, def_id),\n     }, hir::GeneratorMovability::Movable)\n }"}, {"sha": "d261b2382e7a6396025e3f602d0a49e846150568", "filename": "src/librustc_traits/lowering/mod.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_traits%2Flowering%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_traits%2Flowering%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_traits%2Flowering%2Fmod.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -18,7 +18,7 @@ use rustc::traits::{\n };\n use rustc::ty::query::Providers;\n use rustc::ty::{self, List, TyCtxt};\n-use rustc::ty::subst::{Subst, Substs};\n+use rustc::ty::subst::{Subst, InternalSubsts};\n use syntax::ast;\n \n use std::iter;\n@@ -182,7 +182,7 @@ fn program_clauses_for_trait<'a, 'tcx>(\n     // }\n     // ```\n \n-    let bound_vars = Substs::bound_vars_for_item(tcx, def_id);\n+    let bound_vars = InternalSubsts::bound_vars_for_item(tcx, def_id);\n \n     // `Self: Trait<P1..Pn>`\n     let trait_pred = ty::TraitPredicate {\n@@ -294,7 +294,7 @@ fn program_clauses_for_impl<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, def_id: DefId\n     // }\n     // ```\n \n-    let bound_vars = Substs::bound_vars_for_item(tcx, def_id);\n+    let bound_vars = InternalSubsts::bound_vars_for_item(tcx, def_id);\n \n     let trait_ref = tcx.impl_trait_ref(def_id)\n         .expect(\"not an impl\")\n@@ -336,7 +336,7 @@ pub fn program_clauses_for_type_def<'a, 'tcx>(\n     // }\n     // ```\n \n-    let bound_vars = Substs::bound_vars_for_item(tcx, def_id);\n+    let bound_vars = InternalSubsts::bound_vars_for_item(tcx, def_id);\n \n     // `Ty<...>`\n     let ty = tcx.type_of(def_id).subst(tcx, bound_vars);\n@@ -426,7 +426,7 @@ pub fn program_clauses_for_associated_type_def<'a, 'tcx>(\n         _ => bug!(\"not an trait container\"),\n     };\n \n-    let trait_bound_vars = Substs::bound_vars_for_item(tcx, trait_id);\n+    let trait_bound_vars = InternalSubsts::bound_vars_for_item(tcx, trait_id);\n     let trait_ref = ty::TraitRef {\n         def_id: trait_id,\n         substs: trait_bound_vars,\n@@ -564,7 +564,7 @@ pub fn program_clauses_for_associated_type_value<'a, 'tcx>(\n         _ => bug!(\"not an impl container\"),\n     };\n \n-    let impl_bound_vars = Substs::bound_vars_for_item(tcx, impl_id);\n+    let impl_bound_vars = InternalSubsts::bound_vars_for_item(tcx, impl_id);\n \n     // `A0 as Trait<A1..An>`\n     let trait_ref = tcx.impl_trait_ref(impl_id)"}, {"sha": "6f3dc8b969cf4e776a5ad2bd3f807dc8d0519581", "filename": "src/librustc_typeck/astconv.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fastconv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fastconv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fastconv.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -14,7 +14,7 @@ use rustc::lint::builtin::AMBIGUOUS_ASSOCIATED_ITEMS;\n use rustc::traits;\n use rustc::ty::{self, Ty, TyCtxt, ToPredicate, TypeFoldable};\n use rustc::ty::{GenericParamDef, GenericParamDefKind};\n-use rustc::ty::subst::{Kind, Subst, Substs, SubstsRef};\n+use rustc::ty::subst::{Kind, Subst, InternalSubsts, SubstsRef};\n use rustc::ty::wf::object_region_bounds;\n use rustc_data_structures::sync::Lrc;\n use rustc_target::spec::abi;\n@@ -1798,7 +1798,7 @@ impl<'o, 'gcx: 'tcx, 'tcx> dyn AstConv<'gcx, 'tcx> + 'o {\n             }\n             hir::TyKind::Array(ref ty, ref length) => {\n                 let length_def_id = tcx.hir().local_def_id(length.id);\n-                let substs = Substs::identity_for_item(tcx, length_def_id);\n+                let substs = InternalSubsts::identity_for_item(tcx, length_def_id);\n                 let length = ty::LazyConst::Unevaluated(length_def_id, substs);\n                 let length = tcx.mk_lazy_const(length);\n                 let array_ty = tcx.mk_ty(ty::Array(self.ast_ty_to_ty(&ty), length));\n@@ -1839,7 +1839,7 @@ impl<'o, 'gcx: 'tcx, 'tcx> dyn AstConv<'gcx, 'tcx> + 'o {\n         let generics = tcx.generics_of(def_id);\n \n         debug!(\"impl_trait_ty_to_ty: generics={:?}\", generics);\n-        let substs = Substs::for_item(tcx, def_id, |param, _| {\n+        let substs = InternalSubsts::for_item(tcx, def_id, |param, _| {\n             if let Some(i) = (param.index as usize).checked_sub(generics.parent_count) {\n                 // Our own parameters are the resolved lifetimes.\n                 match param.kind {"}, {"sha": "2a4b17a639956c5b7dbccd783b3eaee8c0abe810", "filename": "src/librustc_typeck/check/closure.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fclosure.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fclosure.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fclosure.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -12,7 +12,7 @@ use rustc::traits::Obligation;\n use rustc::traits::error_reporting::ArgKind;\n use rustc::ty::{self, Ty, GenericParamDefKind};\n use rustc::ty::fold::TypeFoldable;\n-use rustc::ty::subst::Substs;\n+use rustc::ty::subst::InternalSubsts;\n use std::cmp;\n use std::iter;\n use rustc_target::spec::abi::Abi;\n@@ -95,7 +95,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n         // types of upvars. These will be unified during the upvar\n         // inference phase (`upvar.rs`).\n         let base_substs =\n-            Substs::identity_for_item(self.tcx, self.tcx.closure_base_def_id(expr_def_id));\n+            InternalSubsts::identity_for_item(self.tcx, self.tcx.closure_base_def_id(expr_def_id));\n         let substs = base_substs.extend_to(self.tcx,expr_def_id, |param, _| {\n             match param.kind {\n                 GenericParamDefKind::Lifetime => {"}, {"sha": "64f61d5e5232e988c6e93a4a4c93d0950bea3e4f", "filename": "src/librustc_typeck/check/coercion.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fcoercion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fcoercion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fcoercion.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -823,7 +823,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n         debug!(\"coercion::try_find_coercion_lub({:?}, {:?})\", prev_ty, new_ty);\n \n         // Special-case that coercion alone cannot handle:\n-        // Two function item types of differing IDs or Substs.\n+        // Two function item types of differing IDs or InternalSubsts.\n         if let (&ty::FnDef(..), &ty::FnDef(..)) = (&prev_ty.sty, &new_ty.sty) {\n             // Don't reify if the function types have a LUB, i.e., they\n             // are the same function and their parameters have a LUB."}, {"sha": "e061a5304eb28dbe9f2ccf1230678bdef6ad452d", "filename": "src/librustc_typeck/check/compare_method.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fcompare_method.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fcompare_method.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fcompare_method.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -4,7 +4,7 @@ use rustc::ty::{self, TyCtxt, GenericParamDefKind};\n use rustc::ty::util::ExplicitSelf;\n use rustc::traits::{self, ObligationCause, ObligationCauseCode, Reveal};\n use rustc::ty::error::{ExpectedFound, TypeError};\n-use rustc::ty::subst::{Subst, Substs};\n+use rustc::ty::subst::{Subst, InternalSubsts, SubstsRef};\n use rustc::util::common::ErrorReported;\n use errors::Applicability;\n \n@@ -160,7 +160,7 @@ fn compare_predicate_entailment<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n     // a fresh FulfillmentCtxt, and invoke select_all_or_error.\n \n     // Create mapping from impl to placeholder.\n-    let impl_to_skol_substs = Substs::identity_for_item(tcx, impl_m.def_id);\n+    let impl_to_skol_substs = InternalSubsts::identity_for_item(tcx, impl_m.def_id);\n \n     // Create mapping from trait to placeholder.\n     let trait_to_skol_substs = impl_to_skol_substs.rebase_onto(tcx,\n@@ -361,7 +361,7 @@ fn check_region_bounds_on_impl_method<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n                                                 trait_m: &ty::AssociatedItem,\n                                                 trait_generics: &ty::Generics,\n                                                 impl_generics: &ty::Generics,\n-                                                trait_to_skol_substs: &Substs<'tcx>)\n+                                                trait_to_skol_substs: SubstsRef<'tcx>)\n                                                 -> Result<(), ErrorReported> {\n     let trait_params = trait_generics.own_counts().lifetimes;\n     let impl_params = impl_generics.own_counts().lifetimes;"}, {"sha": "12c7484f0f9213c672d99995067c5cbfbf94925f", "filename": "src/librustc_typeck/check/dropck.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fdropck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fdropck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fdropck.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -6,7 +6,7 @@ use rustc::infer::outlives::env::OutlivesEnvironment;\n use rustc::infer::{self, InferOk, SuppressRegionErrors};\n use rustc::middle::region;\n use rustc::traits::{ObligationCause, TraitEngine, TraitEngineExt};\n-use rustc::ty::subst::{Subst, Substs, UnpackedKind};\n+use rustc::ty::subst::{Subst, SubstsRef, UnpackedKind};\n use rustc::ty::{self, Ty, TyCtxt};\n use crate::util::common::ErrorReported;\n \n@@ -145,7 +145,7 @@ fn ensure_drop_predicates_are_implied_by_item_defn<'a, 'tcx>(\n     drop_impl_did: DefId,\n     dtor_predicates: &ty::GenericPredicates<'tcx>,\n     self_type_did: DefId,\n-    self_to_impl_substs: &Substs<'tcx>,\n+    self_to_impl_substs: SubstsRef<'tcx>,\n ) -> Result<(), ErrorReported> {\n     let mut result = Ok(());\n "}, {"sha": "d81d24e6d2b0356eeac16de309e01ca7aea47c3c", "filename": "src/librustc_typeck/check/method/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fmod.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -18,7 +18,7 @@ use rustc::hir;\n use rustc::hir::def::Def;\n use rustc::hir::def_id::DefId;\n use rustc::traits;\n-use rustc::ty::subst::{Substs, SubstsRef};\n+use rustc::ty::subst::{InternalSubsts, SubstsRef};\n use rustc::ty::{self, Ty, ToPredicate, ToPolyTraitRef, TraitRef, TypeFoldable};\n use rustc::ty::GenericParamDefKind;\n use rustc::ty::subst::Subst;\n@@ -281,7 +281,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n                trait_def_id);\n \n         // Construct a trait-reference `self_ty : Trait<input_tys>`\n-        let substs = Substs::for_item(self.tcx, trait_def_id, |param, _| {\n+        let substs = InternalSubsts::for_item(self.tcx, trait_def_id, |param, _| {\n             match param.kind {\n                 GenericParamDefKind::Lifetime => {}\n                 GenericParamDefKind::Type {..} => {"}, {"sha": "a4624eebcba830e11304c9c43a7cd03c9394b042", "filename": "src/librustc_typeck/check/method/probe.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fprobe.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fprobe.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fprobe.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -13,7 +13,7 @@ use rustc_data_structures::sync::Lrc;\n use rustc::hir;\n use rustc::lint;\n use rustc::session::config::nightly_options;\n-use rustc::ty::subst::{Subst, Substs, SubstsRef};\n+use rustc::ty::subst::{Subst, InternalSubsts, SubstsRef};\n use rustc::traits::{self, ObligationCause};\n use rustc::traits::query::{CanonicalTyGoal};\n use rustc::traits::query::method_autoderef::{CandidateStep, MethodAutoderefStepsResult};\n@@ -1480,7 +1480,7 @@ impl<'a, 'gcx, 'tcx> ProbeContext<'a, 'gcx, 'tcx> {\n     fn xform_self_ty(&self,\n                      item: &ty::AssociatedItem,\n                      impl_ty: Ty<'tcx>,\n-                     substs: &Substs<'tcx>)\n+                     substs: SubstsRef<'tcx>)\n                      -> (Ty<'tcx>, Option<Ty<'tcx>>) {\n         if item.kind == ty::AssociatedKind::Method && self.mode == Mode::MethodCall {\n             let sig = self.xform_method_sig(item.def_id, substs);\n@@ -1492,7 +1492,7 @@ impl<'a, 'gcx, 'tcx> ProbeContext<'a, 'gcx, 'tcx> {\n \n     fn xform_method_sig(&self,\n                         method: DefId,\n-                        substs: &Substs<'tcx>)\n+                        substs: SubstsRef<'tcx>)\n                         -> ty::FnSig<'tcx>\n     {\n         let fn_sig = self.tcx.fn_sig(method);\n@@ -1517,7 +1517,7 @@ impl<'a, 'gcx, 'tcx> ProbeContext<'a, 'gcx, 'tcx> {\n         if generics.params.is_empty() {\n             xform_fn_sig.subst(self.tcx, substs)\n         } else {\n-            let substs = Substs::for_item(self.tcx, method, |param, _| {\n+            let substs = InternalSubsts::for_item(self.tcx, method, |param, _| {\n                 let i = param.index as usize;\n                 if i < substs.len() {\n                     substs[i]\n@@ -1542,7 +1542,7 @@ impl<'a, 'gcx, 'tcx> ProbeContext<'a, 'gcx, 'tcx> {\n     }\n \n     fn fresh_item_substs(&self, def_id: DefId) -> SubstsRef<'tcx> {\n-        Substs::for_item(self.tcx, def_id, |param, _| {\n+        InternalSubsts::for_item(self.tcx, def_id, |param, _| {\n             match param.kind {\n                 GenericParamDefKind::Lifetime => self.tcx.types.re_erased.into(),\n                 GenericParamDefKind::Type {..} => {"}, {"sha": "202d8bec4e9578551405610c0e35e44694f3ad19", "filename": "src/librustc_typeck/check/mod.rs", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -109,7 +109,7 @@ use rustc::ty::{\n use rustc::ty::adjustment::{Adjust, Adjustment, AllowTwoPhase, AutoBorrow, AutoBorrowMutability};\n use rustc::ty::fold::TypeFoldable;\n use rustc::ty::query::Providers;\n-use rustc::ty::subst::{UnpackedKind, Subst, Substs, SubstsRef, UserSelfTy, UserSubsts};\n+use rustc::ty::subst::{UnpackedKind, Subst, InternalSubsts, SubstsRef, UserSelfTy, UserSubsts};\n use rustc::ty::util::{Representability, IntTypeExt, Discr};\n use rustc::ty::layout::VariantIdx;\n use syntax_pos::{self, BytePos, Span, MultiSpan};\n@@ -1385,7 +1385,7 @@ pub fn check_item_type<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, it: &'tcx hir::Ite\n         hir::ItemKind::Existential(..) => {\n             let def_id = tcx.hir().local_def_id(it.id);\n \n-            let substs = Substs::identity_for_item(tcx, def_id);\n+            let substs = InternalSubsts::identity_for_item(tcx, def_id);\n             check_opaque(tcx, def_id, substs, it.span);\n         }\n         hir::ItemKind::Ty(..) => {\n@@ -1809,7 +1809,7 @@ fn check_transparent<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, sp: Span, def_id: De\n \n     // For each field, figure out if it's known to be a ZST and align(1)\n     let field_infos = adt.non_enum_variant().fields.iter().map(|field| {\n-        let ty = field.ty(tcx, Substs::identity_for_item(tcx, field.did));\n+        let ty = field.ty(tcx, InternalSubsts::identity_for_item(tcx, field.did));\n         let param_env = tcx.param_env(field.did);\n         let layout = tcx.layout_of(param_env.and(ty));\n         // We are currently checking the type this field came from, so it must be local\n@@ -2177,7 +2177,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n             if !method_generics.params.is_empty() {\n                 let user_type_annotation = self.infcx.probe(|_| {\n                     let user_substs = UserSubsts {\n-                        substs: Substs::for_item(self.tcx, method.def_id, |param, _| {\n+                        substs: InternalSubsts::for_item(self.tcx, method.def_id, |param, _| {\n                             let i = param.index as usize;\n                             if i < method_generics.parent_count {\n                                 self.infcx.var_for_def(DUMMY_SP, param)\n@@ -2303,7 +2303,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n     /// types as well. This function combines the two.\n     fn instantiate_type_scheme<T>(&self,\n                                   span: Span,\n-                                  substs: &Substs<'tcx>,\n+                                  substs: SubstsRef<'tcx>,\n                                   value: &T)\n                                   -> T\n         where T : TypeFoldable<'tcx>\n@@ -2319,7 +2319,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n \n     /// As `instantiate_type_scheme`, but for the bounds found in a\n     /// generic type scheme.\n-    fn instantiate_bounds(&self, span: Span, def_id: DefId, substs: &Substs<'tcx>)\n+    fn instantiate_bounds(&self, span: Span, def_id: DefId, substs: SubstsRef<'tcx>)\n                           -> ty::InstantiatedPredicates<'tcx> {\n         let bounds = self.tcx.predicates_of(def_id);\n         let result = bounds.instantiate(self.tcx, substs);\n@@ -2477,7 +2477,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n     }\n \n     /// Registers obligations that all types appearing in `substs` are well-formed.\n-    pub fn add_wf_bounds(&self, substs: &Substs<'tcx>, expr: &hir::Expr) {\n+    pub fn add_wf_bounds(&self, substs: SubstsRef<'tcx>, expr: &hir::Expr) {\n         for ty in substs.types() {\n             self.register_wf_obligation(ty, expr.span, traits::MiscObligation);\n         }\n@@ -2521,7 +2521,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n     pub fn field_ty(&self,\n                     span: Span,\n                     field: &'tcx ty::FieldDef,\n-                    substs: &Substs<'tcx>)\n+                    substs: SubstsRef<'tcx>)\n                     -> Ty<'tcx>\n     {\n         self.normalize_associated_types_in(span, &field.ty(self.tcx, substs))\n@@ -4554,7 +4554,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n             ExprKind::Repeat(ref element, ref count) => {\n                 let count_def_id = tcx.hir().local_def_id(count.id);\n                 let param_env = ty::ParamEnv::empty();\n-                let substs = Substs::identity_for_item(tcx.global_tcx(), count_def_id);\n+                let substs = InternalSubsts::identity_for_item(tcx.global_tcx(), count_def_id);\n                 let instance = ty::Instance::resolve(\n                     tcx.global_tcx(),\n                     param_env,"}, {"sha": "b549986777c84dcbd7f1da5fefc36db5d1ae48d2", "filename": "src/librustc_typeck/check/regionck.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fregionck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fregionck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fregionck.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -81,7 +81,7 @@ use rustc::hir::def_id::DefId;\n use rustc::infer::outlives::env::OutlivesEnvironment;\n use rustc::infer::{self, RegionObligation, SuppressRegionErrors};\n use rustc::ty::adjustment;\n-use rustc::ty::subst::Substs;\n+use rustc::ty::subst::SubstsRef;\n use rustc::ty::{self, Ty};\n \n use rustc::hir::intravisit::{self, NestedVisitorMap, Visitor};\n@@ -1393,7 +1393,7 @@ impl<'a, 'gcx, 'tcx> RegionCtxt<'a, 'gcx, 'tcx> {\n     fn substs_wf_in_scope(\n         &mut self,\n         origin: infer::ParameterOrigin,\n-        substs: &Substs<'tcx>,\n+        substs: SubstsRef<'tcx>,\n         expr_span: Span,\n         expr_region: ty::Region<'tcx>,\n     ) {"}, {"sha": "69f2a17fdf11c01f9026f6f7f3bbae90e866bfba", "filename": "src/librustc_typeck/check/wfcheck.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fwfcheck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcheck%2Fwfcheck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fwfcheck.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -4,7 +4,7 @@ use crate::constrained_type_params::{identify_constrained_type_params, Parameter\n use crate::hir::def_id::DefId;\n use rustc::traits::{self, ObligationCauseCode};\n use rustc::ty::{self, Lift, Ty, TyCtxt, TyKind, GenericParamDefKind, TypeFoldable, ToPredicate};\n-use rustc::ty::subst::{Subst, Substs};\n+use rustc::ty::subst::{Subst, InternalSubsts};\n use rustc::util::nodemap::{FxHashSet, FxHashMap};\n use rustc::middle::lang_items;\n use rustc::infer::opaque_types::may_define_existential_type;\n@@ -459,7 +459,7 @@ fn check_where_clauses<'a, 'gcx, 'fcx, 'tcx>(\n     // For more examples see tests `defaults-well-formedness.rs` and `type-check-defaults.rs`.\n     //\n     // First we build the defaulted substitution.\n-    let substs = Substs::for_item(fcx.tcx, def_id, |param, _| {\n+    let substs = InternalSubsts::for_item(fcx.tcx, def_id, |param, _| {\n         match param.kind {\n             GenericParamDefKind::Lifetime => {\n                 // All regions are identity."}, {"sha": "167fb109567d5737af6e10d96f7c3884b95d32a7", "filename": "src/librustc_typeck/collect.rs", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcollect.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fcollect.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcollect.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -23,7 +23,7 @@ use crate::middle::resolve_lifetime as rl;\n use crate::middle::weak_lang_items;\n use rustc::mir::mono::Linkage;\n use rustc::ty::query::Providers;\n-use rustc::ty::subst::{Subst, Substs};\n+use rustc::ty::subst::{Subst, InternalSubsts};\n use rustc::ty::util::Discr;\n use rustc::ty::util::IntTypeExt;\n use rustc::ty::subst::UnpackedKind;\n@@ -1149,7 +1149,7 @@ fn type_of<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, def_id: DefId) -> Ty<'tcx> {\n     match tcx.hir().get(node_id) {\n         Node::TraitItem(item) => match item.node {\n             TraitItemKind::Method(..) => {\n-                let substs = Substs::identity_for_item(tcx, def_id);\n+                let substs = InternalSubsts::identity_for_item(tcx, def_id);\n                 tcx.mk_fn_def(def_id, substs)\n             }\n             TraitItemKind::Const(ref ty, _) | TraitItemKind::Type(_, Some(ref ty)) => icx.to_ty(ty),\n@@ -1160,7 +1160,7 @@ fn type_of<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, def_id: DefId) -> Ty<'tcx> {\n \n         Node::ImplItem(item) => match item.node {\n             ImplItemKind::Method(..) => {\n-                let substs = Substs::identity_for_item(tcx, def_id);\n+                let substs = InternalSubsts::identity_for_item(tcx, def_id);\n                 tcx.mk_fn_def(def_id, substs)\n             }\n             ImplItemKind::Const(ref ty, _) => icx.to_ty(ty),\n@@ -1193,12 +1193,12 @@ fn type_of<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, def_id: DefId) -> Ty<'tcx> {\n                 | ItemKind::Ty(ref t, _)\n                 | ItemKind::Impl(.., ref t, _) => icx.to_ty(t),\n                 ItemKind::Fn(..) => {\n-                    let substs = Substs::identity_for_item(tcx, def_id);\n+                    let substs = InternalSubsts::identity_for_item(tcx, def_id);\n                     tcx.mk_fn_def(def_id, substs)\n                 }\n                 ItemKind::Enum(..) | ItemKind::Struct(..) | ItemKind::Union(..) => {\n                     let def = tcx.adt_def(def_id);\n-                    let substs = Substs::identity_for_item(tcx, def_id);\n+                    let substs = InternalSubsts::identity_for_item(tcx, def_id);\n                     tcx.mk_adt(def, substs)\n                 }\n                 ItemKind::Existential(hir::ExistTy {\n@@ -1246,7 +1246,7 @@ fn type_of<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, def_id: DefId) -> Ty<'tcx> {\n \n         Node::ForeignItem(foreign_item) => match foreign_item.node {\n             ForeignItemKind::Fn(..) => {\n-                let substs = Substs::identity_for_item(tcx, def_id);\n+                let substs = InternalSubsts::identity_for_item(tcx, def_id);\n                 tcx.mk_fn_def(def_id, substs)\n             }\n             ForeignItemKind::Static(ref t, _) => icx.to_ty(t),\n@@ -1262,7 +1262,7 @@ fn type_of<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, def_id: DefId) -> Ty<'tcx> {\n                 tcx.type_of(tcx.hir().get_parent_did(node_id))\n             }\n             VariantData::Tuple(..) => {\n-                let substs = Substs::identity_for_item(tcx, def_id);\n+                let substs = InternalSubsts::identity_for_item(tcx, def_id);\n                 tcx.mk_fn_def(def_id, substs)\n             }\n         },\n@@ -1279,7 +1279,7 @@ fn type_of<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, def_id: DefId) -> Ty<'tcx> {\n             }\n \n             let substs = ty::ClosureSubsts {\n-                substs: Substs::identity_for_item(tcx, def_id),\n+                substs: InternalSubsts::identity_for_item(tcx, def_id),\n             };\n \n             tcx.mk_closure(def_id, substs)\n@@ -1829,7 +1829,7 @@ fn explicit_predicates_of<'a, 'tcx>(\n \n         Node::ImplItem(item) => match item.node {\n             ImplItemKind::Existential(ref bounds) => {\n-                let substs = Substs::identity_for_item(tcx, def_id);\n+                let substs = InternalSubsts::identity_for_item(tcx, def_id);\n                 let opaque_ty = tcx.mk_opaque(def_id, substs);\n \n                 // Collect the bounds, i.e., the `A+B+'c` in `impl A+B+'c`.\n@@ -1874,7 +1874,7 @@ fn explicit_predicates_of<'a, 'tcx>(\n                     impl_trait_fn,\n                     ref generics,\n                 }) => {\n-                    let substs = Substs::identity_for_item(tcx, def_id);\n+                    let substs = InternalSubsts::identity_for_item(tcx, def_id);\n                     let opaque_ty = tcx.mk_opaque(def_id, substs);\n \n                     // Collect the bounds, i.e., the `A+B+'c` in `impl A+B+'c`."}, {"sha": "7b94b047c92e2e7e332117f706c7ea5f4d534a89", "filename": "src/librustc_typeck/variance/constraints.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fvariance%2Fconstraints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustc_typeck%2Fvariance%2Fconstraints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fvariance%2Fconstraints.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -4,7 +4,7 @@\n //! We walk the set of items and, for each member, generate new constraints.\n \n use hir::def_id::DefId;\n-use rustc::ty::subst::{Substs, UnpackedKind};\n+use rustc::ty::subst::{UnpackedKind, SubstsRef};\n use rustc::ty::{self, Ty, TyCtxt};\n use syntax::ast;\n use rustc::hir;\n@@ -222,7 +222,7 @@ impl<'a, 'tcx> ConstraintContext<'a, 'tcx> {\n \n     fn add_constraints_from_invariant_substs(&mut self,\n                                              current: &CurrentItem,\n-                                             substs: &Substs<'tcx>,\n+                                             substs: SubstsRef<'tcx>,\n                                              variance: VarianceTermPtr<'a>) {\n         debug!(\"add_constraints_from_invariant_substs: substs={:?} variance={:?}\",\n                substs,\n@@ -344,7 +344,7 @@ impl<'a, 'tcx> ConstraintContext<'a, 'tcx> {\n     fn add_constraints_from_substs(&mut self,\n                                    current: &CurrentItem,\n                                    def_id: DefId,\n-                                   substs: &Substs<'tcx>,\n+                                   substs: SubstsRef<'tcx>,\n                                    variance: VarianceTermPtr<'a>) {\n         debug!(\"add_constraints_from_substs(def_id={:?}, substs={:?}, variance={:?})\",\n                def_id,"}, {"sha": "72abbae231aa6e188b6fb8cb43fd89aad65ada65", "filename": "src/librustdoc/clean/mod.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustdoc%2Fclean%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf1172978729ecaf62492622498f4ca75137c390/src%2Flibrustdoc%2Fclean%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Fmod.rs?ref=cf1172978729ecaf62492622498f4ca75137c390", "patch": "@@ -20,7 +20,7 @@ use rustc::mir::interpret::GlobalId;\n use rustc::hir::{self, GenericArg, HirVec};\n use rustc::hir::def::{self, Def, CtorKind};\n use rustc::hir::def_id::{CrateNum, DefId, CRATE_DEF_INDEX, LOCAL_CRATE};\n-use rustc::ty::subst::Substs;\n+use rustc::ty::subst::{InternalSubsts, SubstsRef};\n use rustc::ty::{self, TyCtxt, Region, RegionVid, Ty, AdtKind};\n use rustc::ty::fold::TypeFolder;\n use rustc::ty::layout::VariantIdx;\n@@ -1089,7 +1089,7 @@ impl Clean<GenericBound> for hir::GenericBound {\n }\n \n fn external_generic_args(cx: &DocContext<'_, '_, '_>, trait_did: Option<DefId>, has_self: bool,\n-                        bindings: Vec<TypeBinding>, substs: &Substs<'_>) -> GenericArgs {\n+                        bindings: Vec<TypeBinding>, substs: SubstsRef<'_>) -> GenericArgs {\n     let lifetimes = substs.regions().filter_map(|v| v.clean(cx)).collect();\n     let types = substs.types().skip(has_self as usize).collect::<Vec<_>>();\n \n@@ -1131,7 +1131,7 @@ fn external_generic_args(cx: &DocContext<'_, '_, '_>, trait_did: Option<DefId>,\n // trait_did should be set to a trait's DefId if called on a TraitRef, in order to sugar\n // from Fn<(A, B,), C> to Fn(A, B) -> C\n fn external_path(cx: &DocContext<'_, '_, '_>, name: &str, trait_did: Option<DefId>, has_self: bool,\n-                 bindings: Vec<TypeBinding>, substs: &Substs<'_>) -> Path {\n+                 bindings: Vec<TypeBinding>, substs: SubstsRef<'_>) -> Path {\n     Path {\n         global: false,\n         def: Def::Err,\n@@ -1192,7 +1192,7 @@ impl<'tcx> Clean<GenericBound> for ty::TraitRef<'tcx> {\n     }\n }\n \n-impl<'tcx> Clean<Option<Vec<GenericBound>>> for Substs<'tcx> {\n+impl<'tcx> Clean<Option<Vec<GenericBound>>> for InternalSubsts<'tcx> {\n     fn clean(&self, cx: &DocContext<'_, '_, '_>) -> Option<Vec<GenericBound>> {\n         let mut v = Vec::new();\n         v.extend(self.regions().filter_map(|r| r.clean(cx)).map(GenericBound::Outlives));\n@@ -2532,7 +2532,7 @@ impl Clean<Type> for hir::Ty {\n             TyKind::Array(ref ty, ref length) => {\n                 let def_id = cx.tcx.hir().local_def_id(length.id);\n                 let param_env = cx.tcx.param_env(def_id);\n-                let substs = Substs::identity_for_item(cx.tcx, def_id);\n+                let substs = InternalSubsts::identity_for_item(cx.tcx, def_id);\n                 let cid = GlobalId {\n                     instance: ty::Instance::new(def_id, substs),\n                     promoted: None\n@@ -2776,7 +2776,7 @@ impl<'tcx> Clean<Type> for Ty<'tcx> {\n             ty::Foreign(did) => {\n                 inline::record_extern_fqn(cx, did, TypeKind::Foreign);\n                 let path = external_path(cx, &cx.tcx.item_name(did).as_str(),\n-                                         None, false, vec![], Substs::empty());\n+                                         None, false, vec![], InternalSubsts::empty());\n                 ResolvedPath {\n                     path: path,\n                     typarams: None,"}]}