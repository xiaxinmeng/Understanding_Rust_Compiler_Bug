{"sha": "b694e6649ef5883e36c1bbac0c9890db5dd96792", "node_id": "C_kwDOAAsO6NoAKGI2OTRlNjY0OWVmNTg4M2UzNmMxYmJhYzBjOTg5MGRiNWRkOTY3OTI", "commit": {"author": {"name": "TheOddGarlic", "email": "umutinanerdogan@pm.me", "date": "2022-08-27T19:06:06Z"}, "committer": {"name": "mejrs", "email": "", "date": "2022-12-17T18:08:24Z"}, "message": "Migrate unreachable pattern diagnostic", "tree": {"sha": "8396b816669f34dc951548c5f99513317855817c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8396b816669f34dc951548c5f99513317855817c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b694e6649ef5883e36c1bbac0c9890db5dd96792", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b694e6649ef5883e36c1bbac0c9890db5dd96792", "html_url": "https://github.com/rust-lang/rust/commit/b694e6649ef5883e36c1bbac0c9890db5dd96792", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b694e6649ef5883e36c1bbac0c9890db5dd96792/comments", "author": {"login": "AsyaTheAbove", "id": 40492846, "node_id": "MDQ6VXNlcjQwNDkyODQ2", "avatar_url": "https://avatars.githubusercontent.com/u/40492846?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AsyaTheAbove", "html_url": "https://github.com/AsyaTheAbove", "followers_url": "https://api.github.com/users/AsyaTheAbove/followers", "following_url": "https://api.github.com/users/AsyaTheAbove/following{/other_user}", "gists_url": "https://api.github.com/users/AsyaTheAbove/gists{/gist_id}", "starred_url": "https://api.github.com/users/AsyaTheAbove/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AsyaTheAbove/subscriptions", "organizations_url": "https://api.github.com/users/AsyaTheAbove/orgs", "repos_url": "https://api.github.com/users/AsyaTheAbove/repos", "events_url": "https://api.github.com/users/AsyaTheAbove/events{/privacy}", "received_events_url": "https://api.github.com/users/AsyaTheAbove/received_events", "type": "User", "site_admin": false}, "committer": {}, "parents": [{"sha": "98442b69055024c50c38bad11a18f71cc3858c84", "url": "https://api.github.com/repos/rust-lang/rust/commits/98442b69055024c50c38bad11a18f71cc3858c84", "html_url": "https://github.com/rust-lang/rust/commit/98442b69055024c50c38bad11a18f71cc3858c84"}], "stats": {"total": 27, "additions": 19, "deletions": 8}, "files": [{"sha": "8ff5c9b3fdebbb6f105143581d4657fb1bba826c", "filename": "compiler/rustc_error_messages/locales/en-US/mir_build.ftl", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b694e6649ef5883e36c1bbac0c9890db5dd96792/compiler%2Frustc_error_messages%2Flocales%2Fen-US%2Fmir_build.ftl", "raw_url": "https://github.com/rust-lang/rust/raw/b694e6649ef5883e36c1bbac0c9890db5dd96792/compiler%2Frustc_error_messages%2Flocales%2Fen-US%2Fmir_build.ftl", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_messages%2Flocales%2Fen-US%2Fmir_build.ftl?ref=b694e6649ef5883e36c1bbac0c9890db5dd96792", "patch": "@@ -191,3 +191,7 @@ mir_build_assoc_const_in_pattern = associated consts cannot be referenced in pat\n mir_build_const_param_in_pattern = const parameters cannot be referenced in patterns\n \n mir_build_non_const_path = runtime values cannot be referenced in patterns\n+\n+mir_build_unreachable_pattern = unreachable pattern\n+    .label = unreachable pattern\n+    .catchall_label = matches any value"}, {"sha": "3049ebc5b037b7e7875ba6d8877c0d6c3848f0b9", "filename": "compiler/rustc_mir_build/src/errors.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/b694e6649ef5883e36c1bbac0c9890db5dd96792/compiler%2Frustc_mir_build%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b694e6649ef5883e36c1bbac0c9890db5dd96792/compiler%2Frustc_mir_build%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_build%2Fsrc%2Ferrors.rs?ref=b694e6649ef5883e36c1bbac0c9890db5dd96792", "patch": "@@ -457,3 +457,12 @@ pub struct NonConstPath {\n     #[primary_span]\n     pub span: Span,\n }\n+\n+#[derive(LintDiagnostic)]\n+#[diag(mir_build::unreachable_pattern)]\n+pub struct UnreachablePattern {\n+    #[label]\n+    pub span: Option<Span>,\n+    #[label(mir_build::catchall_label)]\n+    pub catchall: Option<Span>,\n+}"}, {"sha": "b21cd0d1404d4c65157f9761f4c36637178e1728", "filename": "compiler/rustc_mir_build/src/thir/pattern/check_match.rs", "status": "modified", "additions": 6, "deletions": 8, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/b694e6649ef5883e36c1bbac0c9890db5dd96792/compiler%2Frustc_mir_build%2Fsrc%2Fthir%2Fpattern%2Fcheck_match.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b694e6649ef5883e36c1bbac0c9890db5dd96792/compiler%2Frustc_mir_build%2Fsrc%2Fthir%2Fpattern%2Fcheck_match.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_build%2Fsrc%2Fthir%2Fpattern%2Fcheck_match.rs?ref=b694e6649ef5883e36c1bbac0c9890db5dd96792", "patch": "@@ -605,14 +605,12 @@ fn pat_is_catchall(pat: &DeconstructedPat<'_, '_>) -> bool {\n }\n \n fn unreachable_pattern(tcx: TyCtxt<'_>, span: Span, id: HirId, catchall: Option<Span>) {\n-    tcx.struct_span_lint_hir(UNREACHABLE_PATTERNS, id, span, \"unreachable pattern\", |lint| {\n-        if let Some(catchall) = catchall {\n-            // We had a catchall pattern, hint at that.\n-            lint.span_label(span, \"unreachable pattern\");\n-            lint.span_label(catchall, \"matches any value\");\n-        }\n-        lint\n-    });\n+    tcx.emit_spanned_lint(\n+        UNREACHABLE_PATTERNS,\n+        id,\n+        span,\n+        UnreachablePattern { span: if catchall.is_some() { Some(span) } else { None }, catchall },\n+    );\n }\n \n fn irrefutable_let_pattern(tcx: TyCtxt<'_>, id: HirId, span: Span) {"}]}