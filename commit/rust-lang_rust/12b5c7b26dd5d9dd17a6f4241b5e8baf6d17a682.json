{"sha": "12b5c7b26dd5d9dd17a6f4241b5e8baf6d17a682", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEyYjVjN2IyNmRkNWQ5ZGQxN2E2ZjQyNDFiNWU4YmFmNmQxN2E2ODI=", "commit": {"author": {"name": "ljedrz", "email": "ljedrz@gmail.com", "date": "2018-10-13T18:51:25Z"}, "committer": {"name": "ljedrz", "email": "ljedrz@gmail.com", "date": "2018-10-14T05:53:36Z"}, "message": "Don't collect to vectors where unnecessary", "tree": {"sha": "f51e0dc6c00f8d76ba9a2e03004fb4e6a0ecb5da", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f51e0dc6c00f8d76ba9a2e03004fb4e6a0ecb5da"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/12b5c7b26dd5d9dd17a6f4241b5e8baf6d17a682", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/12b5c7b26dd5d9dd17a6f4241b5e8baf6d17a682", "html_url": "https://github.com/rust-lang/rust/commit/12b5c7b26dd5d9dd17a6f4241b5e8baf6d17a682", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/12b5c7b26dd5d9dd17a6f4241b5e8baf6d17a682/comments", "author": {"login": "ljedrz", "id": 3750347, "node_id": "MDQ6VXNlcjM3NTAzNDc=", "avatar_url": "https://avatars.githubusercontent.com/u/3750347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ljedrz", "html_url": "https://github.com/ljedrz", "followers_url": "https://api.github.com/users/ljedrz/followers", "following_url": "https://api.github.com/users/ljedrz/following{/other_user}", "gists_url": "https://api.github.com/users/ljedrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/ljedrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ljedrz/subscriptions", "organizations_url": "https://api.github.com/users/ljedrz/orgs", "repos_url": "https://api.github.com/users/ljedrz/repos", "events_url": "https://api.github.com/users/ljedrz/events{/privacy}", "received_events_url": "https://api.github.com/users/ljedrz/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ljedrz", "id": 3750347, "node_id": "MDQ6VXNlcjM3NTAzNDc=", "avatar_url": "https://avatars.githubusercontent.com/u/3750347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ljedrz", "html_url": "https://github.com/ljedrz", "followers_url": "https://api.github.com/users/ljedrz/followers", "following_url": "https://api.github.com/users/ljedrz/following{/other_user}", "gists_url": "https://api.github.com/users/ljedrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/ljedrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ljedrz/subscriptions", "organizations_url": "https://api.github.com/users/ljedrz/orgs", "repos_url": "https://api.github.com/users/ljedrz/repos", "events_url": "https://api.github.com/users/ljedrz/events{/privacy}", "received_events_url": "https://api.github.com/users/ljedrz/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f51752774bbbe48d2aabe53c86e9e91ed3a73a5d", "url": "https://api.github.com/repos/rust-lang/rust/commits/f51752774bbbe48d2aabe53c86e9e91ed3a73a5d", "html_url": "https://github.com/rust-lang/rust/commit/f51752774bbbe48d2aabe53c86e9e91ed3a73a5d"}], "stats": {"total": 22, "additions": 8, "deletions": 14}, "files": [{"sha": "e99d65024967b7c63de2d8b9a564d17903190887", "filename": "src/librustc/hir/lowering.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/12b5c7b26dd5d9dd17a6f4241b5e8baf6d17a682/src%2Flibrustc%2Fhir%2Flowering.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12b5c7b26dd5d9dd17a6f4241b5e8baf6d17a682/src%2Flibrustc%2Fhir%2Flowering.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Flowering.rs?ref=12b5c7b26dd5d9dd17a6f4241b5e8baf6d17a682", "patch": "@@ -60,7 +60,6 @@ use util::nodemap::{DefIdMap, NodeMap};\n \n use std::collections::BTreeMap;\n use std::fmt::Debug;\n-use std::iter;\n use std::mem;\n use smallvec::SmallVec;\n use syntax::attr;\n@@ -3888,9 +3887,7 @@ impl<'a> LoweringContext<'a> {\n                     .collect::<P<[hir::Field]>>();\n \n                 let is_unit = fields.is_empty();\n-                let struct_path = iter::once(\"ops\")\n-                    .chain(iter::once(path))\n-                    .collect::<Vec<_>>();\n+                let struct_path = [\"ops\", path];\n                 let struct_path = self.std_path(e.span, &struct_path, None, is_unit);\n                 let struct_path = hir::QPath::Resolved(None, P(struct_path));\n "}, {"sha": "1e3f0a21cefb3ef3593d723eca5a8f2eed4c94ea", "filename": "src/librustc_traits/lowering.rs", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/12b5c7b26dd5d9dd17a6f4241b5e8baf6d17a682/src%2Flibrustc_traits%2Flowering.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12b5c7b26dd5d9dd17a6f4241b5e8baf6d17a682/src%2Flibrustc_traits%2Flowering.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_traits%2Flowering.rs?ref=12b5c7b26dd5d9dd17a6f4241b5e8baf6d17a682", "patch": "@@ -306,8 +306,7 @@ fn program_clauses_for_trait<'a, 'tcx>(\n     let wf_conditions = iter::once(ty::Binder::dummy(trait_pred.lower()))\n         .chain(\n             where_clauses\n-                .iter()\n-                .cloned()\n+                .into_iter()\n                 .map(|wc| wc.map_bound(|goal| goal.into_well_formed_goal()))\n         );\n \n@@ -350,15 +349,13 @@ fn program_clauses_for_impl<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, def_id: DefId\n     // `WC`\n     let where_clauses = tcx.predicates_of(def_id).predicates\n         .into_iter()\n-        .map(|(wc, _)| wc.lower())\n-        .collect::<Vec<_>>();\n+        .map(|(wc, _)| wc.lower());\n \n     // `Implemented(A0: Trait<A1..An>) :- WC`\n     let clause = ProgramClause {\n         goal: trait_pred,\n         hypotheses: tcx.mk_goals(\n             where_clauses\n-                .into_iter()\n                 .map(|wc| tcx.mk_goal(GoalKind::from_poly_domain_goal(wc, tcx))),\n         ),\n     };"}, {"sha": "d82d36a1937bf4b5449249789643be1b5285e2e2", "filename": "src/librustc_typeck/check/demand.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/12b5c7b26dd5d9dd17a6f4241b5e8baf6d17a682/src%2Flibrustc_typeck%2Fcheck%2Fdemand.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12b5c7b26dd5d9dd17a6f4241b5e8baf6d17a682/src%2Flibrustc_typeck%2Fcheck%2Fdemand.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fdemand.rs?ref=12b5c7b26dd5d9dd17a6f4241b5e8baf6d17a682", "patch": "@@ -115,7 +115,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n         // field is of the found type, suggest such variants. See Issue\n         // #42764.\n         if let ty::Adt(expected_adt, substs) = expected.sty {\n-            let compatible_variants = expected_adt.variants\n+            let mut compatible_variants = expected_adt.variants\n                                                   .iter()\n                                                   .filter(|variant| variant.fields.len() == 1)\n                                                   .filter_map(|variant| {\n@@ -127,12 +127,12 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n                 } else {\n                     None\n                 }\n-            }).collect::<Vec<_>>();\n+            }).peekable();\n \n-            if !compatible_variants.is_empty() {\n+            if compatible_variants.peek().is_some() {\n                 let expr_text = print::to_string(print::NO_ANN, |s| s.print_expr(expr));\n-                let suggestions = compatible_variants.iter()\n-                    .map(|v| format!(\"{}({})\", v, expr_text)).collect::<Vec<_>>();\n+                let suggestions = compatible_variants.map(|v|\n+                    format!(\"{}({})\", v, expr_text)).collect::<Vec<_>>();\n                 err.span_suggestions_with_applicability(\n                      expr.span,\n                      \"try using a variant of the expected type\","}]}