{"sha": "d289c0f46467fc8abd7b89129116e8dd959c3e34", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQyODljMGY0NjQ2N2ZjOGFiZDdiODkxMjkxMTZlOGRkOTU5YzNlMzQ=", "commit": {"author": {"name": "David Renshaw", "email": "dwrenshaw@gmail.com", "date": "2018-01-15T14:47:17Z"}, "committer": {"name": "David Renshaw", "email": "dwrenshaw@gmail.com", "date": "2018-01-15T14:47:17Z"}, "message": "partially deal with rust/46479", "tree": {"sha": "2e85355bab64176aeab06757128ee3071e65d49c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2e85355bab64176aeab06757128ee3071e65d49c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d289c0f46467fc8abd7b89129116e8dd959c3e34", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d289c0f46467fc8abd7b89129116e8dd959c3e34", "html_url": "https://github.com/rust-lang/rust/commit/d289c0f46467fc8abd7b89129116e8dd959c3e34", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d289c0f46467fc8abd7b89129116e8dd959c3e34/comments", "author": {"login": "dwrensha", "id": 495768, "node_id": "MDQ6VXNlcjQ5NTc2OA==", "avatar_url": "https://avatars.githubusercontent.com/u/495768?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dwrensha", "html_url": "https://github.com/dwrensha", "followers_url": "https://api.github.com/users/dwrensha/followers", "following_url": "https://api.github.com/users/dwrensha/following{/other_user}", "gists_url": "https://api.github.com/users/dwrensha/gists{/gist_id}", "starred_url": "https://api.github.com/users/dwrensha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dwrensha/subscriptions", "organizations_url": "https://api.github.com/users/dwrensha/orgs", "repos_url": "https://api.github.com/users/dwrensha/repos", "events_url": "https://api.github.com/users/dwrensha/events{/privacy}", "received_events_url": "https://api.github.com/users/dwrensha/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dwrensha", "id": 495768, "node_id": "MDQ6VXNlcjQ5NTc2OA==", "avatar_url": "https://avatars.githubusercontent.com/u/495768?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dwrensha", "html_url": "https://github.com/dwrensha", "followers_url": "https://api.github.com/users/dwrensha/followers", "following_url": "https://api.github.com/users/dwrensha/following{/other_user}", "gists_url": "https://api.github.com/users/dwrensha/gists{/gist_id}", "starred_url": "https://api.github.com/users/dwrensha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dwrensha/subscriptions", "organizations_url": "https://api.github.com/users/dwrensha/orgs", "repos_url": "https://api.github.com/users/dwrensha/repos", "events_url": "https://api.github.com/users/dwrensha/events{/privacy}", "received_events_url": "https://api.github.com/users/dwrensha/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "33af3208fdb2180570c3ef266abc634a45158ef1", "url": "https://api.github.com/repos/rust-lang/rust/commits/33af3208fdb2180570c3ef266abc634a45158ef1", "html_url": "https://github.com/rust-lang/rust/commit/33af3208fdb2180570c3ef266abc634a45158ef1"}], "stats": {"total": 9, "additions": 8, "deletions": 1}, "files": [{"sha": "091a3b7e1dfb971462f7cfd47358877b38893289", "filename": "miri/lib.rs", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/d289c0f46467fc8abd7b89129116e8dd959c3e34/miri%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d289c0f46467fc8abd7b89129116e8dd959c3e34/miri%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/miri%2Flib.rs?ref=d289c0f46467fc8abd7b89129116e8dd959c3e34", "patch": "@@ -75,7 +75,14 @@ pub fn eval_main<'a, 'tcx: 'a>(\n         }\n \n         if let Some(start_id) = start_wrapper {\n-            let start_instance = ty::Instance::mono(ecx.tcx, start_id);\n+            let main_ret_ty = ecx.tcx.fn_sig(main_id).output();\n+            let main_ret_ty = main_ret_ty.no_late_bound_regions().unwrap();\n+            let start_instance = ty::Instance::resolve(\n+                ecx.tcx,\n+                ty::ParamEnv::empty(traits::Reveal::All),\n+                start_id,\n+                ecx.tcx.mk_substs(\n+                    ::std::iter::once(ty::subst::Kind::from(main_ret_ty)))).unwrap();\n             let start_mir = ecx.load_mir(start_instance.def)?;\n \n             if start_mir.arg_count != 3 {"}]}