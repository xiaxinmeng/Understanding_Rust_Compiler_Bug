{"sha": "218390b9fb0cfa713d4b6b38425f3a07fee2b564", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIxODM5MGI5ZmIwY2ZhNzEzZDRiNmIzODQyNWYzYTA3ZmVlMmI1NjQ=", "commit": {"author": {"name": "Conrad Ludgate", "email": "conradludgate@gmail.com", "date": "2021-03-01T11:21:02Z"}, "committer": {"name": "Conrad Ludgate", "email": "conradludgate@gmail.com", "date": "2021-03-02T14:30:10Z"}, "message": "chore: rename var", "tree": {"sha": "7a1a894fc4b17bcf7774535d8781cc011e5e3247", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7a1a894fc4b17bcf7774535d8781cc011e5e3247"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/218390b9fb0cfa713d4b6b38425f3a07fee2b564", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE6pcFW95LJgarInbuPdGh2zy0v2MFAmA+S/IACgkQPdGh2zy0\nv2Oaag/8Ck9CDytDMC/RazBTlh2hafOBxMEcvnnBGXfBKk+0z6VPpGfi3fwUB414\nPVXmnwwnpImLeMU6n1foNriF0OqXgkZNRBgMUuZqsVEgEBhdyq4Ttsn6alffxbjH\nRirgWPBulJejI+y32IIuMtkyha7+1xnODmnKOBrRZxgreuJGe7NDeVr0OxPkNl86\nk6nSeE0RJTsgPfGFFlteWlCJQJQFDgzVOMoWB3tpIsPud3TdXaNdC0SylhoKUiWw\nyiPskK6KxccTiA/9X7B1aEMf/ZweLx6D8R8LtIfJzWU5saqhtI2e6e7OL2ubvw+e\nZq5y7abKPmv0E/goOJERqM+MhGb5a8DBrl5hnYzSdDVrq33n+HGT6WiTRgMhnx70\nPgRfldvUlIFWwE07bypLggn9jyuOJgK/77NNL8Gu2lPctm3yvH5V7pANhgGuOw/Q\nNbg6GU9vvetbYJWV2gNgqaXbQcZ8xHCbxz/6IlINem4UT2ssa4PLXsO9d85Pxfja\n1cPl6r089R/L7IF9pVj329NaE6hYwAV+rup4qxnstWyHIjj4/2unlk4/EZwnMcW7\nCVKZQ3uqXZOVVITcii9xfD5vZ5JzM24VTjj5KgOydSilpd77pgWz646sJOEDEm+X\nVmHuF4VJVqU7TyRYg4o+gjS/C6wOvQ8yJTY8QrjzosOnuTfpw6c=\n=YhIG\n-----END PGP SIGNATURE-----", "payload": "tree 7a1a894fc4b17bcf7774535d8781cc011e5e3247\nparent 705712993ffe24898e3c1fe006e1108b7d02d6bc\nauthor Conrad Ludgate <conradludgate@gmail.com> 1614597662 +0000\ncommitter Conrad Ludgate <conradludgate@gmail.com> 1614695410 +0000\n\nchore: rename var\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/218390b9fb0cfa713d4b6b38425f3a07fee2b564", "html_url": "https://github.com/rust-lang/rust/commit/218390b9fb0cfa713d4b6b38425f3a07fee2b564", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/218390b9fb0cfa713d4b6b38425f3a07fee2b564/comments", "author": {"login": "conradludgate", "id": 6625462, "node_id": "MDQ6VXNlcjY2MjU0NjI=", "avatar_url": "https://avatars.githubusercontent.com/u/6625462?v=4", "gravatar_id": "", "url": "https://api.github.com/users/conradludgate", "html_url": "https://github.com/conradludgate", "followers_url": "https://api.github.com/users/conradludgate/followers", "following_url": "https://api.github.com/users/conradludgate/following{/other_user}", "gists_url": "https://api.github.com/users/conradludgate/gists{/gist_id}", "starred_url": "https://api.github.com/users/conradludgate/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/conradludgate/subscriptions", "organizations_url": "https://api.github.com/users/conradludgate/orgs", "repos_url": "https://api.github.com/users/conradludgate/repos", "events_url": "https://api.github.com/users/conradludgate/events{/privacy}", "received_events_url": "https://api.github.com/users/conradludgate/received_events", "type": "User", "site_admin": false}, "committer": {"login": "conradludgate", "id": 6625462, "node_id": "MDQ6VXNlcjY2MjU0NjI=", "avatar_url": "https://avatars.githubusercontent.com/u/6625462?v=4", "gravatar_id": "", "url": "https://api.github.com/users/conradludgate", "html_url": "https://github.com/conradludgate", "followers_url": "https://api.github.com/users/conradludgate/followers", "following_url": "https://api.github.com/users/conradludgate/following{/other_user}", "gists_url": "https://api.github.com/users/conradludgate/gists{/gist_id}", "starred_url": "https://api.github.com/users/conradludgate/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/conradludgate/subscriptions", "organizations_url": "https://api.github.com/users/conradludgate/orgs", "repos_url": "https://api.github.com/users/conradludgate/repos", "events_url": "https://api.github.com/users/conradludgate/events{/privacy}", "received_events_url": "https://api.github.com/users/conradludgate/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "705712993ffe24898e3c1fe006e1108b7d02d6bc", "url": "https://api.github.com/repos/rust-lang/rust/commits/705712993ffe24898e3c1fe006e1108b7d02d6bc", "html_url": "https://github.com/rust-lang/rust/commit/705712993ffe24898e3c1fe006e1108b7d02d6bc"}], "stats": {"total": 6, "additions": 3, "deletions": 3}, "files": [{"sha": "ea9f249d32922261235db1950b710d5107c03cc8", "filename": "crates/ide_assists/src/handlers/add_type_ascription.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/218390b9fb0cfa713d4b6b38425f3a07fee2b564/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fadd_type_ascription.rs", "raw_url": "https://github.com/rust-lang/rust/raw/218390b9fb0cfa713d4b6b38425f3a07fee2b564/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fadd_type_ascription.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fadd_type_ascription.rs?ref=218390b9fb0cfa713d4b6b38425f3a07fee2b564", "patch": "@@ -30,6 +30,7 @@ pub(crate) fn add_type_ascription(acc: &mut Assists, ctx: &AssistContext) -> Opt\n         mark::hit!(add_type_ascription_already_typed);\n         return None\n     }\n+    let type_pos = let_stmt.pat()?.syntax().last_token()?.text_range().end();\n \n     let ident = ctx.find_token_syntax_at_offset(SyntaxKind::IDENT).or_else(|| {\n         let arg_list = ctx.find_node_at_offset::<ast::ArgList>()?;\n@@ -58,14 +59,13 @@ pub(crate) fn add_type_ascription(acc: &mut Assists, ctx: &AssistContext) -> Opt\n         mark::hit!(add_type_ascription_non_generic);\n         return None;\n     }\n-    let pat = let_stmt.pat()?.syntax().last_token()?.text_range().end();\n     acc.add(\n         AssistId(\"add_type_ascription\", AssistKind::RefactorRewrite),\n         \"Add `: _` before assignment operator\",\n         ident.text_range(),\n         |builder| match ctx.config.snippet_cap {\n-            Some(cap) => builder.insert_snippet(cap, pat, \": ${0:_}\"),\n-            None => builder.insert(pat, \": _\"),\n+            Some(cap) => builder.insert_snippet(cap, type_pos, \": ${0:_}\"),\n+            None => builder.insert(type_pos, \": _\"),\n         },\n     )\n }"}]}