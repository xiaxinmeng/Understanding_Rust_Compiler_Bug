{"sha": "f908391136c9797235ad6de11be46114b654ca61", "node_id": "C_kwDOAAsO6NoAKGY5MDgzOTExMzZjOTc5NzIzNWFkNmRlMTFiZTQ2MTE0YjY1NGNhNjE", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2022-04-26T11:22:30Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-04-26T11:22:30Z"}, "message": "Rollup merge of #96400 - JakobDegen:shallow-init-docs, r=Dylan-DPC\n\nCorrect documentation for `Rvalue::ShallowInitBox`\n\nAs a part of the big MIR docs PR, I had added a comment indicating that `Rvalue::ShallowInitBox` is disallowed after drop elaboration, but this is not true (no idea why I thought it was). Codegen has support for it, and trying to enforce this rule in the validator causes compiling core to ICE on the very first `box` statement.\n\nThat being said, this `Rvalue` probably *should* be banned after drop elaboration - it doesn't seem like it's still useful for much. However, I do not have time right now to actually go investigate how difficult a change that is to make, so in the meantime fixing the docs to reflect the current situation seems like the right step.\n\nr? rust-lang/mir-opt", "tree": {"sha": "ea79973fddcecb09a0d0da50ca79ff9d23591f3e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ea79973fddcecb09a0d0da50ca79ff9d23591f3e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f908391136c9797235ad6de11be46114b654ca61", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJiZ9X2CRBK7hj4Ov3rIwAAIcMIAIGMQLYaOOq7M4gnB3coGFNK\n7Pg+b//BFD7WnrLtzVfFKQS09xys+pt8uBGDXunQp8bBZSdpTmQK2MRf1dTSu67C\n+3mEG5Vgb1PRv8ixS1SgOpD2z1nuwbAu6hY+QtjZDieOdIkFSoR8/lHRkvvVMvQ6\nzerfxu7oC5PDuhGLkHsEOH/D359dLqaDIgFuz53GAv5BIU/5mAD94NpFxRpbm2Mg\npJ0uoMk1B4CfsBKvbNGETVCz23zqPKVkbX0UYMPFEtbLVvB0anZuYP12UBqluoj2\na9ruTbEeXSEdJruBmIkBofgeB+BS/i/ABVbd1TV1ihn4jOoSy23dMdPEXKwQ+2M=\n=2TAk\n-----END PGP SIGNATURE-----\n", "payload": "tree ea79973fddcecb09a0d0da50ca79ff9d23591f3e\nparent a818173e6339a394bcac8236a66cee49a876bb4b\nparent 941e19468ab6239a220ec3214c584e281636a26d\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1650972150 +0200\ncommitter GitHub <noreply@github.com> 1650972150 +0200\n\nRollup merge of #96400 - JakobDegen:shallow-init-docs, r=Dylan-DPC\n\nCorrect documentation for `Rvalue::ShallowInitBox`\n\nAs a part of the big MIR docs PR, I had added a comment indicating that `Rvalue::ShallowInitBox` is disallowed after drop elaboration, but this is not true (no idea why I thought it was). Codegen has support for it, and trying to enforce this rule in the validator causes compiling core to ICE on the very first `box` statement.\n\nThat being said, this `Rvalue` probably *should* be banned after drop elaboration - it doesn't seem like it's still useful for much. However, I do not have time right now to actually go investigate how difficult a change that is to make, so in the meantime fixing the docs to reflect the current situation seems like the right step.\n\nr? rust-lang/mir-opt\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f908391136c9797235ad6de11be46114b654ca61", "html_url": "https://github.com/rust-lang/rust/commit/f908391136c9797235ad6de11be46114b654ca61", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f908391136c9797235ad6de11be46114b654ca61/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a818173e6339a394bcac8236a66cee49a876bb4b", "url": "https://api.github.com/repos/rust-lang/rust/commits/a818173e6339a394bcac8236a66cee49a876bb4b", "html_url": "https://github.com/rust-lang/rust/commit/a818173e6339a394bcac8236a66cee49a876bb4b"}, {"sha": "941e19468ab6239a220ec3214c584e281636a26d", "url": "https://api.github.com/repos/rust-lang/rust/commits/941e19468ab6239a220ec3214c584e281636a26d", "html_url": "https://github.com/rust-lang/rust/commit/941e19468ab6239a220ec3214c584e281636a26d"}], "stats": {"total": 2, "additions": 0, "deletions": 2}, "files": [{"sha": "883fc72cd56c1867c5ebe68c24b5e5ceb8565bda", "filename": "compiler/rustc_middle/src/mir/mod.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f908391136c9797235ad6de11be46114b654ca61/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f908391136c9797235ad6de11be46114b654ca61/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fmod.rs?ref=f908391136c9797235ad6de11be46114b654ca61", "patch": "@@ -2581,8 +2581,6 @@ pub enum Rvalue<'tcx> {\n     /// This is different from a normal transmute because dataflow analysis will treat the box as\n     /// initialized but its content as uninitialized. Like other pointer casts, this in general\n     /// affects alias analysis.\n-    ///\n-    /// Disallowed after drop elaboration.\n     ShallowInitBox(Operand<'tcx>, Ty<'tcx>),\n }\n "}]}