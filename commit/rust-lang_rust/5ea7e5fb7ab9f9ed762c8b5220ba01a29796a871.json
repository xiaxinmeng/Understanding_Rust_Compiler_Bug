{"sha": "5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVlYTdlNWZiN2FiOWY5ZWQ3NjJjOGI1MjIwYmEwMWEyOTc5NmE4NzE=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-01-09T20:32:18Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-01-09T20:32:18Z"}, "message": "G: simplest use items", "tree": {"sha": "e67b91e3fe1d046d886bce5e896bb045e327169e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e67b91e3fe1d046d886bce5e896bb045e327169e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871", "html_url": "https://github.com/rust-lang/rust/commit/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1544e89c49c67df00fc72d841f3e39be792cbe2b", "url": "https://api.github.com/repos/rust-lang/rust/commits/1544e89c49c67df00fc72d841f3e39be792cbe2b", "html_url": "https://github.com/rust-lang/rust/commit/1544e89c49c67df00fc72d841f3e39be792cbe2b"}], "stats": {"total": 66, "additions": 55, "deletions": 11}, "files": [{"sha": "bb3c5f65e991eff551c3b744753146c99dfb1030", "filename": "grammar.ron", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871/grammar.ron", "raw_url": "https://github.com/rust-lang/rust/raw/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871/grammar.ron", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/grammar.ron?ref=5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871", "patch": "@@ -75,6 +75,9 @@ Grammar(\n         \"ATTR\",\n         \"META_ITEM\",\n         \"MOD_ITEM\",\n+        \"USE_ITEM\",\n+        \"PATH\",\n+        \"PATH_SEGMENT\",\n         \"LITERAL\",\n         \"ALIAS\",\n     ]"}, {"sha": "950e02a4d48ecee6b5e5562074cb65b2f22dc784", "filename": "src/parser/event_parser/grammar/items.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871/src%2Fparser%2Fevent_parser%2Fgrammar%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871/src%2Fparser%2Fevent_parser%2Fgrammar%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fparser%2Fevent_parser%2Fgrammar%2Fitems.rs?ref=5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871", "patch": "@@ -12,7 +12,7 @@ pub(super) fn mod_contents(p: &mut Parser) {\n \n fn item_first(p: &Parser) -> bool {\n     match p.current() {\n-        STRUCT_KW | FN_KW | EXTERN_KW | MOD_KW => true,\n+        STRUCT_KW | FN_KW | EXTERN_KW | MOD_KW | USE_KW => true,\n         _ => false,\n     }\n }\n@@ -43,6 +43,7 @@ fn item(p: &mut Parser) -> bool {\n     // || node_if(p, TYPE_KW, TYPE_ITEM, type_item)\n     node_if(p, [EXTERN_KW, CRATE_KW], EXTERN_CRATE_ITEM, extern_crate_item)\n         || node_if(p, MOD_KW, MOD_ITEM, mod_item)\n+        || node_if(p, USE_KW, USE_ITEM, use_item)\n         || node_if(p, STRUCT_KW, STRUCT_ITEM, struct_item)\n         || node_if(p, FN_KW, FN_ITEM, fn_item)\n }\n@@ -66,6 +67,11 @@ fn mod_item(p: &mut Parser) {\n     p.curly_block(mod_contents);\n }\n \n+fn use_item(p: &mut Parser) {\n+    paths::use_path(p);\n+    p.expect(SEMI);\n+}\n+\n fn struct_field(p: &mut Parser) -> bool {\n     node_if(p, IDENT, STRUCT_FIELD, |p| {\n         p.expect(COLON) && p.expect(IDENT);"}, {"sha": "60458ce7090b52ece24bd3acada94c69b97b009f", "filename": "src/parser/event_parser/grammar/mod.rs", "status": "modified", "additions": 2, "deletions": 7, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871/src%2Fparser%2Fevent_parser%2Fgrammar%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871/src%2Fparser%2Fevent_parser%2Fgrammar%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fparser%2Fevent_parser%2Fgrammar%2Fmod.rs?ref=5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871", "patch": "@@ -6,10 +6,11 @@ use syntax_kinds::*;\n mod items;\n mod attributes;\n mod expressions;\n+mod paths;\n \n pub(crate) fn file(p: &mut Parser) {\n     node(p, FILE, |p| {\n-        p.optional(SHEBANG);\n+        p.eat(SHEBANG);\n         items::mod_contents(p);\n     })\n }\n@@ -99,12 +100,6 @@ impl<'p> Parser<'p> {\n         }\n     }\n \n-    fn optional(&mut self, kind: SyntaxKind) {\n-        if self.current() == kind {\n-            self.bump();\n-        }\n-    }\n-\n     fn eat(&mut self, kind: SyntaxKind) -> bool {\n         self.current() == kind && { self.bump(); true }\n     }"}, {"sha": "96966b380b3fff3bab8d800c72fb12c4acc2ef7a", "filename": "src/parser/event_parser/grammar/paths.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871/src%2Fparser%2Fevent_parser%2Fgrammar%2Fpaths.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871/src%2Fparser%2Fevent_parser%2Fgrammar%2Fpaths.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fparser%2Fevent_parser%2Fgrammar%2Fpaths.rs?ref=5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871", "patch": "@@ -0,0 +1,15 @@\n+use super::*;\n+\n+pub(crate) fn use_path(p: &mut Parser) {\n+    if !AnyOf(&[IDENT, COLONCOLON]).is_ahead(p) {\n+        return;\n+    }\n+    node(p, PATH, |p| {\n+        p.eat(COLONCOLON);\n+        path_segment(p);\n+    })\n+}\n+\n+fn path_segment(p: &mut Parser) -> bool {\n+    node_if(p, IDENT, PATH_SEGMENT, |p| ())\n+}\n\\ No newline at end of file"}, {"sha": "a86f203d709ab52ef593337869ce9d6c0f7cadcf", "filename": "src/syntax_kinds.rs", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871/src%2Fsyntax_kinds.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871/src%2Fsyntax_kinds.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fsyntax_kinds.rs?ref=5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871", "patch": "@@ -72,10 +72,13 @@ pub const EXTERN_CRATE_ITEM: SyntaxKind = SyntaxKind(67);\n pub const ATTR: SyntaxKind = SyntaxKind(68);\n pub const META_ITEM: SyntaxKind = SyntaxKind(69);\n pub const MOD_ITEM: SyntaxKind = SyntaxKind(70);\n-pub const LITERAL: SyntaxKind = SyntaxKind(71);\n-pub const ALIAS: SyntaxKind = SyntaxKind(72);\n+pub const USE_ITEM: SyntaxKind = SyntaxKind(71);\n+pub const PATH: SyntaxKind = SyntaxKind(72);\n+pub const PATH_SEGMENT: SyntaxKind = SyntaxKind(73);\n+pub const LITERAL: SyntaxKind = SyntaxKind(74);\n+pub const ALIAS: SyntaxKind = SyntaxKind(75);\n \n-static INFOS: [SyntaxInfo; 73] = [\n+static INFOS: [SyntaxInfo; 76] = [\n     SyntaxInfo { name: \"USE_KW\" },\n     SyntaxInfo { name: \"FN_KW\" },\n     SyntaxInfo { name: \"STRUCT_KW\" },\n@@ -147,6 +150,9 @@ static INFOS: [SyntaxInfo; 73] = [\n     SyntaxInfo { name: \"ATTR\" },\n     SyntaxInfo { name: \"META_ITEM\" },\n     SyntaxInfo { name: \"MOD_ITEM\" },\n+    SyntaxInfo { name: \"USE_ITEM\" },\n+    SyntaxInfo { name: \"PATH\" },\n+    SyntaxInfo { name: \"PATH_SEGMENT\" },\n     SyntaxInfo { name: \"LITERAL\" },\n     SyntaxInfo { name: \"ALIAS\" },\n ];"}, {"sha": "05a6aff83fc08578b53abedd78ab1ee4f6b98b53", "filename": "tests/data/parser/ok/0009_use_item.rs", "status": "added", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871/tests%2Fdata%2Fparser%2Fok%2F0009_use_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871/tests%2Fdata%2Fparser%2Fok%2F0009_use_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Fok%2F0009_use_item.rs?ref=5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871", "patch": "@@ -0,0 +1,2 @@\n+use foo;\n+use ::bar;\n\\ No newline at end of file"}, {"sha": "f0b2981f2dfa2c26be4642d3b516aa627417ee71", "filename": "tests/data/parser/ok/0009_use_item.txt", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871/tests%2Fdata%2Fparser%2Fok%2F0009_use_item.txt", "raw_url": "https://github.com/rust-lang/rust/raw/5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871/tests%2Fdata%2Fparser%2Fok%2F0009_use_item.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Fok%2F0009_use_item.txt?ref=5ea7e5fb7ab9f9ed762c8b5220ba01a29796a871", "patch": "@@ -0,0 +1,17 @@\n+FILE@[0; 19)\n+  USE_ITEM@[0; 9)\n+    USE_KW@[0; 3)\n+    PATH@[3; 7)\n+      PATH_SEGMENT@[3; 7)\n+        WHITESPACE@[3; 4)\n+        IDENT@[4; 7)\n+    SEMI@[7; 8)\n+    WHITESPACE@[8; 9)\n+  USE_ITEM@[9; 19)\n+    USE_KW@[9; 12)\n+    PATH@[12; 18)\n+      WHITESPACE@[12; 13)\n+      COLONCOLON@[13; 15)\n+      PATH_SEGMENT@[15; 18)\n+        IDENT@[15; 18)\n+    SEMI@[18; 19)"}]}