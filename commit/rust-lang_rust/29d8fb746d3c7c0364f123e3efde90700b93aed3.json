{"sha": "29d8fb746d3c7c0364f123e3efde90700b93aed3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI5ZDhmYjc0NmQzYzdjMDM2NGYxMjNlM2VmZGU5MDcwMGI5M2FlZDM=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-09-03T03:13:18Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-09-03T03:13:18Z"}, "message": "Auto merge of #88386 - estebank:unmatched-delims, r=jackh726\n\nPoint at unclosed delimiters as part of the primary MultiSpan\n\nBoth the place where the parser encounters a needed closed delimiter and\nthe unclosed opening delimiter are important, so they should get the\nsame level of highlighting in the output.\n\n_Context: https://twitter.com/mwk4/status/1430631546432675840_", "tree": {"sha": "f2153fdee8716980ca96ffca229965c811d07664", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f2153fdee8716980ca96ffca229965c811d07664"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/29d8fb746d3c7c0364f123e3efde90700b93aed3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/29d8fb746d3c7c0364f123e3efde90700b93aed3", "html_url": "https://github.com/rust-lang/rust/commit/29d8fb746d3c7c0364f123e3efde90700b93aed3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/29d8fb746d3c7c0364f123e3efde90700b93aed3/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "97f2698484c2d668b2f356a6c2252e5f08472234", "url": "https://api.github.com/repos/rust-lang/rust/commits/97f2698484c2d668b2f356a6c2252e5f08472234", "html_url": "https://github.com/rust-lang/rust/commit/97f2698484c2d668b2f356a6c2252e5f08472234"}, {"sha": "c6d800d85439d0a95a2943905d0fd3842fa4dd20", "url": "https://api.github.com/repos/rust-lang/rust/commits/c6d800d85439d0a95a2943905d0fd3842fa4dd20", "html_url": "https://github.com/rust-lang/rust/commit/c6d800d85439d0a95a2943905d0fd3842fa4dd20"}], "stats": {"total": 149, "additions": 82, "deletions": 67}, "files": [{"sha": "cdc1d1cf99f3c842b1615488cc0f2a050c3f1c57", "filename": "compiler/rustc_parse/src/parser/diagnostics.rs", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fdiagnostics.rs?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -1432,12 +1432,22 @@ impl<'a> Parser<'a> {\n                 // the most sense, which is immediately after the last token:\n                 //\n                 //  {foo(bar {}}\n-                //      -      ^\n+                //      ^      ^\n                 //      |      |\n                 //      |      help: `)` may belong here\n                 //      |\n                 //      unclosed delimiter\n                 if let Some(sp) = unmatched.unclosed_span {\n+                    let mut primary_span: Vec<Span> =\n+                        err.span.primary_spans().iter().cloned().collect();\n+                    primary_span.push(sp);\n+                    let mut primary_span: MultiSpan = primary_span.into();\n+                    for span_label in err.span.span_labels() {\n+                        if let Some(label) = span_label.label {\n+                            primary_span.push_span_label(span_label.span, label);\n+                        }\n+                    }\n+                    err.set_span(primary_span);\n                     err.span_label(sp, \"unclosed delimiter\");\n                 }\n                 // Backticks should be removed to apply suggestions."}, {"sha": "c4419e995edac84940900418d87186aecdb89235", "filename": "compiler/rustc_parse/src/parser/mod.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -33,7 +33,7 @@ use rustc_data_structures::sync::Lrc;\n use rustc_errors::PResult;\n use rustc_errors::{struct_span_err, Applicability, DiagnosticBuilder, FatalError};\n use rustc_session::parse::ParseSess;\n-use rustc_span::source_map::{Span, DUMMY_SP};\n+use rustc_span::source_map::{MultiSpan, Span, DUMMY_SP};\n use rustc_span::symbol::{kw, sym, Ident, Symbol};\n use tracing::debug;\n \n@@ -1335,8 +1335,13 @@ crate fn make_unclosed_delims_error(\n     // `None` here means an `Eof` was found. We already emit those errors elsewhere, we add them to\n     // `unmatched_braces` only for error recovery in the `Parser`.\n     let found_delim = unmatched.found_delim?;\n+    let span: MultiSpan = if let Some(sp) = unmatched.unclosed_span {\n+        vec![unmatched.found_span, sp].into()\n+    } else {\n+        unmatched.found_span.into()\n+    };\n     let mut err = sess.span_diagnostic.struct_span_err(\n-        unmatched.found_span,\n+        span,\n         &format!(\n             \"mismatched closing delimiter: `{}`\",\n             pprust::token_kind_to_string(&token::CloseDelim(found_delim)),"}, {"sha": "1e6294ebe169152935407c91a40c0e5bd60dda6d", "filename": "src/test/ui/parser/issue-10636-1.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-10636-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-10636-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissue-10636-1.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -1,8 +1,8 @@\n error: mismatched closing delimiter: `)`\n-  --> $DIR/issue-10636-1.rs:4:1\n+  --> $DIR/issue-10636-1.rs:1:12\n    |\n LL | struct Obj {\n-   |            - unclosed delimiter\n+   |            ^ unclosed delimiter\n ...\n LL | )\n    | ^ mismatched closing delimiter"}, {"sha": "d4f2da9e3ab6f5b4c6d1c51f0a42a1fd8c0fb9c2", "filename": "src/test/ui/parser/issue-10636-2.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-10636-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-10636-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissue-10636-2.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -1,8 +1,8 @@\n error: expected one of `)`, `,`, `.`, `?`, or an operator, found `;`\n-  --> $DIR/issue-10636-2.rs:5:25\n+  --> $DIR/issue-10636-2.rs:5:15\n    |\n LL |     option.map(|some| 42;\n-   |               -         ^ help: `)` may belong here\n+   |               ^         ^ help: `)` may belong here\n    |               |\n    |               unclosed delimiter\n "}, {"sha": "2afb26d17583471dc52cc76350436f6e82b8be39", "filename": "src/test/ui/parser/issue-58856-1.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-58856-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-58856-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissue-58856-1.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -1,8 +1,8 @@\n error: expected one of `)`, `,`, or `:`, found `>`\n-  --> $DIR/issue-58856-1.rs:3:14\n+  --> $DIR/issue-58856-1.rs:3:9\n    |\n LL |     fn b(self>\n-   |         -    ^ help: `)` may belong here\n+   |         ^    ^ help: `)` may belong here\n    |         |\n    |         unclosed delimiter\n "}, {"sha": "627dd389059cd78baed0a5970066981ca8dda323", "filename": "src/test/ui/parser/issue-58856-2.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-58856-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-58856-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissue-58856-2.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -1,8 +1,8 @@\n error: expected one of `)` or `,`, found `->`\n-  --> $DIR/issue-58856-2.rs:6:26\n+  --> $DIR/issue-58856-2.rs:6:19\n    |\n LL |     fn how_are_you(&self -> Empty {\n-   |                   -     -^^\n+   |                   ^     -^^\n    |                   |     |\n    |                   |     help: `)` may belong here\n    |                   unclosed delimiter"}, {"sha": "210ef700cd4bc27dd4956cc14314f8c387f01bf0", "filename": "src/test/ui/parser/issue-60075.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-60075.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-60075.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissue-60075.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -17,10 +17,10 @@ LL |     }\n    |     - item list ends here\n \n error: mismatched closing delimiter: `)`\n-  --> $DIR/issue-60075.rs:6:10\n+  --> $DIR/issue-60075.rs:4:31\n    |\n LL |     fn qux() -> Option<usize> {\n-   |                               - unclosed delimiter\n+   |                               ^ unclosed delimiter\n LL |         let _ = if true {\n LL |         });\n    |          ^ mismatched closing delimiter"}, {"sha": "51d835e7329884b870e019e161a091169d03b942", "filename": "src/test/ui/parser/issue-62973.stderr", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-62973.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-62973.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissue-62973.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -21,10 +21,10 @@ LL |\n    |  ^\n \n error: expected one of `,` or `}`, found `{`\n-  --> $DIR/issue-62973.rs:6:25\n+  --> $DIR/issue-62973.rs:6:8\n    |\n LL | fn p() { match s { v, E { [) {) }\n-   |        -       -       -^ expected one of `,` or `}`\n+   |        ^       -       -^ expected one of `,` or `}`\n    |        |       |       |\n    |        |       |       help: `}` may belong here\n    |        |       while parsing this struct\n@@ -56,18 +56,18 @@ LL |\n    |  ^ expected one of `.`, `?`, `{`, or an operator\n \n error: mismatched closing delimiter: `)`\n-  --> $DIR/issue-62973.rs:6:28\n+  --> $DIR/issue-62973.rs:6:27\n    |\n LL | fn p() { match s { v, E { [) {) }\n-   |                           -^ mismatched closing delimiter\n+   |                           ^^ mismatched closing delimiter\n    |                           |\n    |                           unclosed delimiter\n \n error: mismatched closing delimiter: `)`\n-  --> $DIR/issue-62973.rs:6:31\n+  --> $DIR/issue-62973.rs:6:30\n    |\n LL | fn p() { match s { v, E { [) {) }\n-   |                              -^ mismatched closing delimiter\n+   |                              ^^ mismatched closing delimiter\n    |                              |\n    |                              unclosed delimiter\n "}, {"sha": "cfdd99d1434aef0f17965b4032a77111c9152e0d", "filename": "src/test/ui/parser/issue-63116.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-63116.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-63116.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissue-63116.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -13,10 +13,10 @@ LL | impl W <s(f;Y(;]\n    |            ^ expected one of 7 possible tokens\n \n error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-63116.rs:3:16\n+  --> $DIR/issue-63116.rs:3:14\n    |\n LL | impl W <s(f;Y(;]\n-   |              - ^ mismatched closing delimiter\n+   |              ^ ^ mismatched closing delimiter\n    |              |\n    |              unclosed delimiter\n "}, {"sha": "6cbab855c7636ad9e91692c12d9cc5ec424898de", "filename": "src/test/ui/parser/issue-66357-unexpected-unreachable.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-66357-unexpected-unreachable.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-66357-unexpected-unreachable.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissue-66357-unexpected-unreachable.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -5,10 +5,10 @@ LL | fn f() { |[](* }\n    |             ^ expected one of `,` or `:`\n \n error: expected one of `&`, `(`, `)`, `-`, `...`, `..=`, `..`, `[`, `_`, `box`, `mut`, `ref`, `|`, identifier, or path, found `*`\n-  --> $DIR/issue-66357-unexpected-unreachable.rs:12:14\n+  --> $DIR/issue-66357-unexpected-unreachable.rs:12:13\n    |\n LL | fn f() { |[](* }\n-   |             -^ help: `)` may belong here\n+   |             ^^ help: `)` may belong here\n    |             |\n    |             unclosed delimiter\n "}, {"sha": "34f1397ce1d5bb62afeaf5a567a938801b75c092", "filename": "src/test/ui/parser/issue-67377-invalid-syntax-in-enum-discriminant.stderr", "status": "modified", "additions": 24, "deletions": 24, "changes": 48, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-67377-invalid-syntax-in-enum-discriminant.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fissue-67377-invalid-syntax-in-enum-discriminant.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissue-67377-invalid-syntax-in-enum-discriminant.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -1,107 +1,107 @@\n error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:5:42\n+  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:5:27\n    |\n LL |         V = [PhantomData; { [ () ].len() ].len() as isize,\n-   |             -             -              ^ mismatched closing delimiter\n+   |             -             ^              ^ mismatched closing delimiter\n    |             |             |\n    |             |             unclosed delimiter\n    |             closing delimiter possibly meant for this\n \n error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:15:36\n+  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:15:24\n    |\n LL |         V = [Vec::new; { [].len()  ].len() as isize,\n-   |             -          -           ^ mismatched closing delimiter\n+   |             -          ^           ^ mismatched closing delimiter\n    |             |          |\n    |             |          unclosed delimiter\n    |             closing delimiter possibly meant for this\n \n error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:26:36\n+  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:26:24\n    |\n LL |         V = [Vec::new; { [0].len() ].len() as isize,\n-   |             -          -           ^ mismatched closing delimiter\n+   |             -          ^           ^ mismatched closing delimiter\n    |             |          |\n    |             |          unclosed delimiter\n    |             closing delimiter possibly meant for this\n \n error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:5:42\n+  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:5:27\n    |\n LL |         V = [PhantomData; { [ () ].len() ].len() as isize,\n-   |             -             -              ^ mismatched closing delimiter\n+   |             -             ^              ^ mismatched closing delimiter\n    |             |             |\n    |             |             unclosed delimiter\n    |             closing delimiter possibly meant for this\n \n error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:15:36\n+  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:15:24\n    |\n LL |         V = [Vec::new; { [].len()  ].len() as isize,\n-   |             -          -           ^ mismatched closing delimiter\n+   |             -          ^           ^ mismatched closing delimiter\n    |             |          |\n    |             |          unclosed delimiter\n    |             closing delimiter possibly meant for this\n \n error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:26:36\n+  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:26:24\n    |\n LL |         V = [Vec::new; { [0].len() ].len() as isize,\n-   |             -          -           ^ mismatched closing delimiter\n+   |             -          ^           ^ mismatched closing delimiter\n    |             |          |\n    |             |          unclosed delimiter\n    |             closing delimiter possibly meant for this\n \n error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:5:42\n+  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:5:27\n    |\n LL |         V = [PhantomData; { [ () ].len() ].len() as isize,\n-   |             -             -              ^ mismatched closing delimiter\n+   |             -             ^              ^ mismatched closing delimiter\n    |             |             |\n    |             |             unclosed delimiter\n    |             closing delimiter possibly meant for this\n \n error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:15:36\n+  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:15:24\n    |\n LL |         V = [Vec::new; { [].len()  ].len() as isize,\n-   |             -          -           ^ mismatched closing delimiter\n+   |             -          ^           ^ mismatched closing delimiter\n    |             |          |\n    |             |          unclosed delimiter\n    |             closing delimiter possibly meant for this\n \n error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:26:36\n+  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:26:24\n    |\n LL |         V = [Vec::new; { [0].len() ].len() as isize,\n-   |             -          -           ^ mismatched closing delimiter\n+   |             -          ^           ^ mismatched closing delimiter\n    |             |          |\n    |             |          unclosed delimiter\n    |             closing delimiter possibly meant for this\n \n error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:5:42\n+  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:5:27\n    |\n LL |         V = [PhantomData; { [ () ].len() ].len() as isize,\n-   |             -             -              ^ mismatched closing delimiter\n+   |             -             ^              ^ mismatched closing delimiter\n    |             |             |\n    |             |             unclosed delimiter\n    |             closing delimiter possibly meant for this\n \n error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:15:36\n+  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:15:24\n    |\n LL |         V = [Vec::new; { [].len()  ].len() as isize,\n-   |             -          -           ^ mismatched closing delimiter\n+   |             -          ^           ^ mismatched closing delimiter\n    |             |          |\n    |             |          unclosed delimiter\n    |             closing delimiter possibly meant for this\n \n error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:26:36\n+  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:26:24\n    |\n LL |         V = [Vec::new; { [0].len() ].len() as isize,\n-   |             -          -           ^ mismatched closing delimiter\n+   |             -          ^           ^ mismatched closing delimiter\n    |             |          |\n    |             |          unclosed delimiter\n    |             closing delimiter possibly meant for this"}, {"sha": "077d318004896f6dbf0dfe60e65e96ae6647690a", "filename": "src/test/ui/parser/macro-mismatched-delim-brace-paren.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fmacro-mismatched-delim-brace-paren.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fmacro-mismatched-delim-brace-paren.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fmacro-mismatched-delim-brace-paren.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -1,8 +1,8 @@\n error: mismatched closing delimiter: `)`\n-  --> $DIR/macro-mismatched-delim-brace-paren.rs:6:5\n+  --> $DIR/macro-mismatched-delim-brace-paren.rs:4:10\n    |\n LL |     foo! {\n-   |          - unclosed delimiter\n+   |          ^ unclosed delimiter\n LL |         bar, \"baz\", 1, 2.0\n LL |     )\n    |     ^ mismatched closing delimiter"}, {"sha": "967a3e6fdc11b76a56a6f6cf88cf6eba459ad50a", "filename": "src/test/ui/parser/macro-mismatched-delim-paren-brace.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fmacro-mismatched-delim-paren-brace.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fmacro-mismatched-delim-paren-brace.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fmacro-mismatched-delim-paren-brace.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -10,10 +10,10 @@ LL | }\n    | ^ unexpected closing delimiter\n \n error: mismatched closing delimiter: `}`\n-  --> $DIR/macro-mismatched-delim-paren-brace.rs:4:5\n+  --> $DIR/macro-mismatched-delim-paren-brace.rs:2:10\n    |\n LL |     foo! (\n-   |          - unclosed delimiter\n+   |          ^ unclosed delimiter\n LL |         bar, \"baz\", 1, 2.0\n LL |     }\n    |     ^ mismatched closing delimiter"}, {"sha": "0980d033fe73ad51b7c4c32bace40a0c04c83f0f", "filename": "src/test/ui/parser/parser-recovery-2.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fparser-recovery-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fparser-recovery-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fparser-recovery-2.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -5,10 +5,10 @@ LL |     let x = y.;\n    |               ^\n \n error: mismatched closing delimiter: `)`\n-  --> $DIR/parser-recovery-2.rs:6:5\n+  --> $DIR/parser-recovery-2.rs:4:14\n    |\n LL |     fn bar() {\n-   |              - unclosed delimiter\n+   |              ^ unclosed delimiter\n LL |         let x = foo();\n LL |     )\n    |     ^ mismatched closing delimiter"}, {"sha": "1366ef1bba8bfb3956ae538dc3f706ff4474da8d", "filename": "src/test/ui/parser/unclosed-delimiter-in-dep.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Funclosed-delimiter-in-dep.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Funclosed-delimiter-in-dep.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Funclosed-delimiter-in-dep.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -1,10 +1,10 @@\n error: mismatched closing delimiter: `}`\n-  --> $DIR/unclosed_delim_mod.rs:7:1\n+  --> $DIR/unclosed_delim_mod.rs:5:7\n    |\n LL | pub fn new() -> Result<Value, ()> {\n    |                                   - closing delimiter possibly meant for this\n LL |     Ok(Value {\n-   |       - unclosed delimiter\n+   |       ^ unclosed delimiter\n LL |     }\n LL | }\n    | ^ mismatched closing delimiter"}, {"sha": "a46d020b9672e13cff2face8c0fc650400acb709", "filename": "src/test/ui/parser/unclosed_delim_mod.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Funclosed_delim_mod.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Funclosed_delim_mod.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Funclosed_delim_mod.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -1,10 +1,10 @@\n error: mismatched closing delimiter: `}`\n-  --> $DIR/unclosed_delim_mod.rs:7:1\n+  --> $DIR/unclosed_delim_mod.rs:5:7\n    |\n LL | pub fn new() -> Result<Value, ()> {\n    |                                   - closing delimiter possibly meant for this\n LL |     Ok(Value {\n-   |       - unclosed delimiter\n+   |       ^ unclosed delimiter\n LL |     }\n LL | }\n    | ^ mismatched closing delimiter"}, {"sha": "438fe9c47eac1ac447ef28181a9b832e7ae4a8fb", "filename": "src/test/ui/parser/use-unclosed-brace.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fuse-unclosed-brace.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fparser%2Fuse-unclosed-brace.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fuse-unclosed-brace.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -8,10 +8,10 @@ LL | fn main() {}\n    |              ^\n \n error: expected one of `,`, `::`, `as`, or `}`, found `;`\n-  --> $DIR/use-unclosed-brace.rs:4:19\n+  --> $DIR/use-unclosed-brace.rs:4:10\n    |\n LL | use foo::{bar, baz;\n-   |          -        ^\n+   |          ^        ^\n    |          |        |\n    |          |        expected one of `,`, `::`, `as`, or `}`\n    |          |        help: `}` may belong here"}, {"sha": "cca9f2dc88ca0d8dcda92a045274db8c481792e7", "filename": "src/test/ui/resolve/token-error-correct-2.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fresolve%2Ftoken-error-correct-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fresolve%2Ftoken-error-correct-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Ftoken-error-correct-2.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -1,8 +1,8 @@\n error: mismatched closing delimiter: `)`\n-  --> $DIR/token-error-correct-2.rs:6:5\n+  --> $DIR/token-error-correct-2.rs:4:12\n    |\n LL |     if foo {\n-   |            - unclosed delimiter\n+   |            ^ unclosed delimiter\n LL |\n LL |     )\n    |     ^ mismatched closing delimiter"}, {"sha": "77c87c78466b1d68faeff1f74615c3fa459c5b2b", "filename": "src/test/ui/resolve/token-error-correct-3.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fresolve%2Ftoken-error-correct-3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fresolve%2Ftoken-error-correct-3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Ftoken-error-correct-3.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -1,8 +1,8 @@\n error: expected one of `)`, `,`, `.`, `?`, or an operator, found `;`\n-  --> $DIR/token-error-correct-3.rs:13:35\n+  --> $DIR/token-error-correct-3.rs:13:21\n    |\n LL |             callback(path.as_ref();\n-   |                     -             ^ help: `)` may belong here\n+   |                     ^             ^ help: `)` may belong here\n    |                     |\n    |                     unclosed delimiter\n "}, {"sha": "81e5a133691595f259080f77d4d75be661f82a55", "filename": "src/test/ui/resolve/token-error-correct-4.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fresolve%2Ftoken-error-correct-4.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fresolve%2Ftoken-error-correct-4.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Ftoken-error-correct-4.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -1,8 +1,8 @@\n error: expected one of `)`, `,`, `.`, `?`, or an operator, found `;`\n-  --> $DIR/token-error-correct-4.rs:9:21\n+  --> $DIR/token-error-correct-4.rs:9:12\n    |\n LL |     setsuna(kazusa();\n-   |            -        ^ help: `)` may belong here\n+   |            ^        ^ help: `)` may belong here\n    |            |\n    |            unclosed delimiter\n "}, {"sha": "ca0c4c18ad4baf1b4497dc09a8a14726885bbc5b", "filename": "src/test/ui/resolve/token-error-correct.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fresolve%2Ftoken-error-correct.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29d8fb746d3c7c0364f123e3efde90700b93aed3/src%2Ftest%2Fui%2Fresolve%2Ftoken-error-correct.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Ftoken-error-correct.stderr?ref=29d8fb746d3c7c0364f123e3efde90700b93aed3", "patch": "@@ -1,10 +1,10 @@\n error: mismatched closing delimiter: `}`\n-  --> $DIR/token-error-correct.rs:6:1\n+  --> $DIR/token-error-correct.rs:4:12\n    |\n LL | fn main() {\n    |           - closing delimiter possibly meant for this\n LL |     foo(bar(;\n-   |            - unclosed delimiter\n+   |            ^ unclosed delimiter\n LL |\n LL | }\n    | ^ mismatched closing delimiter"}]}