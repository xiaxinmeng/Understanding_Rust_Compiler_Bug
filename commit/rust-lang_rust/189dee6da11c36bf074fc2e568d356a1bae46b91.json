{"sha": "189dee6da11c36bf074fc2e568d356a1bae46b91", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE4OWRlZTZkYTExYzM2YmYwNzRmYzJlNTY4ZDM1NmExYmFlNDZiOTE=", "commit": {"author": {"name": "zjhmale", "email": "zjhmale@gmail.com", "date": "2016-08-29T14:49:16Z"}, "committer": {"name": "zjhmale", "email": "zjhmale@gmail.com", "date": "2016-08-31T07:54:49Z"}, "message": "Update E0393 to new error format", "tree": {"sha": "6e98717d4155fb1ea890b82be9966a2f6622e4d7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6e98717d4155fb1ea890b82be9966a2f6622e4d7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/189dee6da11c36bf074fc2e568d356a1bae46b91", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/189dee6da11c36bf074fc2e568d356a1bae46b91", "html_url": "https://github.com/rust-lang/rust/commit/189dee6da11c36bf074fc2e568d356a1bae46b91", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/189dee6da11c36bf074fc2e568d356a1bae46b91/comments", "author": {"login": "zjhmale", "id": 6234553, "node_id": "MDQ6VXNlcjYyMzQ1NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/6234553?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zjhmale", "html_url": "https://github.com/zjhmale", "followers_url": "https://api.github.com/users/zjhmale/followers", "following_url": "https://api.github.com/users/zjhmale/following{/other_user}", "gists_url": "https://api.github.com/users/zjhmale/gists{/gist_id}", "starred_url": "https://api.github.com/users/zjhmale/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zjhmale/subscriptions", "organizations_url": "https://api.github.com/users/zjhmale/orgs", "repos_url": "https://api.github.com/users/zjhmale/repos", "events_url": "https://api.github.com/users/zjhmale/events{/privacy}", "received_events_url": "https://api.github.com/users/zjhmale/received_events", "type": "User", "site_admin": false}, "committer": {"login": "zjhmale", "id": 6234553, "node_id": "MDQ6VXNlcjYyMzQ1NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/6234553?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zjhmale", "html_url": "https://github.com/zjhmale", "followers_url": "https://api.github.com/users/zjhmale/followers", "following_url": "https://api.github.com/users/zjhmale/following{/other_user}", "gists_url": "https://api.github.com/users/zjhmale/gists{/gist_id}", "starred_url": "https://api.github.com/users/zjhmale/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zjhmale/subscriptions", "organizations_url": "https://api.github.com/users/zjhmale/orgs", "repos_url": "https://api.github.com/users/zjhmale/repos", "events_url": "https://api.github.com/users/zjhmale/events{/privacy}", "received_events_url": "https://api.github.com/users/zjhmale/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "86dde9bbda92c02c61282b5df5d38338a798ef3b", "url": "https://api.github.com/repos/rust-lang/rust/commits/86dde9bbda92c02c61282b5df5d38338a798ef3b", "html_url": "https://github.com/rust-lang/rust/commit/86dde9bbda92c02c61282b5df5d38338a798ef3b"}], "stats": {"total": 39, "additions": 26, "deletions": 13}, "files": [{"sha": "e04bd581f4648d404fd1be3f06334e628515721d", "filename": "src/librustc_typeck/astconv.rs", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/189dee6da11c36bf074fc2e568d356a1bae46b91/src%2Flibrustc_typeck%2Fastconv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/189dee6da11c36bf074fc2e568d356a1bae46b91/src%2Flibrustc_typeck%2Fastconv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fastconv.rs?ref=189dee6da11c36bf074fc2e568d356a1bae46b91", "patch": "@@ -515,12 +515,13 @@ impl<'o, 'gcx: 'tcx, 'tcx> AstConv<'gcx, 'tcx>+'o {\n                 // defaults. This will lead to an ICE if we are not\n                 // careful!\n                 if default_needs_object_self(def) {\n-                    span_err!(tcx.sess, span, E0393,\n-                              \"the type parameter `{}` must be explicitly specified \\\n-                               in an object type because its default value `{}` references \\\n-                               the type `Self`\",\n-                              def.name,\n-                              default);\n+                    struct_span_err!(tcx.sess, span, E0393,\n+                                     \"the type parameter `{}` must be explicitly specified\",\n+                                     def.name)\n+                        .span_label(span, &format!(\"missing reference to `{}`\", def.name))\n+                        .note(&format!(\"because of the default `Self` reference, \\\n+                                        type parameters must be specified on object types\"))\n+                        .emit();\n                     tcx.types.err\n                 } else {\n                     // This is a default type parameter."}, {"sha": "f045e873519cd44f6d8286737040676974a5fdee", "filename": "src/test/compile-fail/E0393.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/189dee6da11c36bf074fc2e568d356a1bae46b91/src%2Ftest%2Fcompile-fail%2FE0393.rs", "raw_url": "https://github.com/rust-lang/rust/raw/189dee6da11c36bf074fc2e568d356a1bae46b91/src%2Ftest%2Fcompile-fail%2FE0393.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2FE0393.rs?ref=189dee6da11c36bf074fc2e568d356a1bae46b91", "patch": "@@ -10,7 +10,10 @@\n \n trait A<T=Self> {}\n \n-fn together_we_will_rule_the_galaxy(son: &A) {} //~ ERROR E0393\n+fn together_we_will_rule_the_galaxy(son: &A) {}\n+//~^ ERROR E0393\n+//~| NOTE missing reference to `T`\n+//~| NOTE because of the default `Self` reference, type parameters must be specified on object types\n \n fn main() {\n }"}, {"sha": "935f3480db24abfd6cd3d845e1e757fcbc06f679", "filename": "src/test/compile-fail/issue-21950.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/189dee6da11c36bf074fc2e568d356a1bae46b91/src%2Ftest%2Fcompile-fail%2Fissue-21950.rs", "raw_url": "https://github.com/rust-lang/rust/raw/189dee6da11c36bf074fc2e568d356a1bae46b91/src%2Ftest%2Fcompile-fail%2Fissue-21950.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-21950.rs?ref=189dee6da11c36bf074fc2e568d356a1bae46b91", "patch": "@@ -15,6 +15,9 @@ use std::ops::Add;\n fn main() {\n     let x = &10 as\n             &Add;\n-            //~^ ERROR the type parameter `RHS` must be explicitly specified in an object type because its default value `Self` references the type `Self`\n-            //~| ERROR the value of the associated type `Output` (from the trait `std::ops::Add`) must be specified\n+            //~^ ERROR E0393\n+            //~| NOTE missing reference to `RHS`\n+            //~| NOTE because of the default `Self` reference, type parameters must be specified on object types\n+            //~| ERROR E0191\n+            //~| NOTE missing associated type `Output` value\n }"}, {"sha": "51f342e3f0a435dc79a650a955ed204babe18cfa", "filename": "src/test/compile-fail/issue-22370.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/189dee6da11c36bf074fc2e568d356a1bae46b91/src%2Ftest%2Fcompile-fail%2Fissue-22370.rs", "raw_url": "https://github.com/rust-lang/rust/raw/189dee6da11c36bf074fc2e568d356a1bae46b91/src%2Ftest%2Fcompile-fail%2Fissue-22370.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-22370.rs?ref=189dee6da11c36bf074fc2e568d356a1bae46b91", "patch": "@@ -13,6 +13,8 @@\n trait A<T=Self> {}\n \n fn f(a: &A) {}\n-//~^ ERROR the type parameter `T` must be explicitly specified in an object type because its default value `Self` references the type `Self`\n+//~^ ERROR E0393\n+//~| NOTE missing reference to `T`\n+//~| NOTE because of the default `Self` reference, type parameters must be specified on object types\n \n fn main() {}"}, {"sha": "45b110bf5631ddcb251bae2f69f6bfd517be8997", "filename": "src/test/compile-fail/issue-22560.rs", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/189dee6da11c36bf074fc2e568d356a1bae46b91/src%2Ftest%2Fcompile-fail%2Fissue-22560.rs", "raw_url": "https://github.com/rust-lang/rust/raw/189dee6da11c36bf074fc2e568d356a1bae46b91/src%2Ftest%2Fcompile-fail%2Fissue-22560.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-22560.rs?ref=189dee6da11c36bf074fc2e568d356a1bae46b91", "patch": "@@ -13,9 +13,13 @@\n use std::ops::{Add, Sub};\n \n type Test = Add +\n-            //~^ ERROR the type parameter `RHS` must be explicitly specified in an object type because its default value `Self` references the type `Self`\n-            //~^^ ERROR the value of the associated type `Output` (from the trait `std::ops::Add`) must be specified [E0191]\n+            //~^ ERROR E0393\n+            //~| NOTE missing reference to `RHS`\n+            //~| NOTE because of the default `Self` reference, type parameters must be specified on object types\n+            //~| ERROR E0191\n+            //~| NOTE missing associated type `Output` value\n             Sub;\n-            //~^ ERROR only the builtin traits can be used as closure or object bounds\n+            //~^ ERROR E0225\n+            //~| NOTE non-builtin trait used as bounds\n \n fn main() { }"}]}