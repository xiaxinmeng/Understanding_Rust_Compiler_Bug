{"sha": "59c9c66bc019bec1c21dd5ac9b74b6b4a3468403", "node_id": "C_kwDOAAsO6NoAKDU5YzljNjZiYzAxOWJlYzFjMjFkZDVhYzliNzRiNmI0YTM0Njg0MDM", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2021-11-20T09:21:15Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-11-20T09:21:15Z"}, "message": "Rollup merge of #90983 - GuillaumeGomez:sidebar-scrollbar, r=jsha\n\nMake scrollbar in the sidebar always visible for visual consistency\n\nFixes #90943.\n\nI had to add a background in `dark` and `ayu` themes, otherwise it was looking strange (like an invisible margin). So it looks like this:\n\n![Screenshot from 2021-11-17 14-45-49](https://user-images.githubusercontent.com/3050060/142212476-18892ae0-ba4b-48e3-8c0f-4ca1dd2f851d.png)\n![Screenshot from 2021-11-17 14-45-53](https://user-images.githubusercontent.com/3050060/142212482-e97b2fad-68d2-439a-b62e-b56e6ded5345.png)\n\nSadly, I wasn't able to add a GUI test to ensure that the scrollbar was always displayed because it seems not possible in puppeteer for whatever reason... I used this method: on small pages (like `lib2/sub_mod/index.html`), comparing `.navbar`'s `clientWidth` with `offsetWidth` (the first doesn't include the sidebar in the computed amount). When checking in the browser, it works fine but in puppeteer it almost never works...\n\nIn case anyone want to try to solve the bug, here is the puppeteer code:\n\n<details>\nMore information about this: I tried another approach which was to get the element in `evaluate` directly (by calling it from `page.evaluate(() => { .. });` directly instead of `parseAssertElemProp.evaluate(e => {...});`.\n\n```js\nconst puppeteer = require('puppeteer');\n\n(async () => {\n    const browser = await puppeteer.launch();\n    const page = await browser.newPage();\n    await page.goto(\"file:///path/rust/build/x86_64-unknown-linux-gnu/test/rustdoc-gui/doc/lib2/sub_mod/index.html\");\n    await page.waitFor(\".sidebar\");\n    let parseAssertElemProp = await page.$(\".sidebar\");\n    if (parseAssertElemProp === null) { throw '\".sidebar\" not found'; }\n    await parseAssertElemProp.evaluate(e => {\n        const parseAssertElemPropDict = {\"clientWidth\": \"192\", \"offsetWidth\":\"200\"};\n        for (const [parseAssertElemPropKey, parseAssertElemPropValue] of Object.entries(parseAssertElemPropDict)) {\n            if (e[parseAssertElemPropKey] === undefined || String(e[parseAssertElemPropKey]) != parseAssertElemPropValue) {\n                throw 'expected `' + parseAssertElemPropValue + '` for property `' + parseAssertElemPropKey + '` for selector `.sidebar`, found `' + e[parseAssertElemPropKey] + '`';\n            }\n        }\n    }).catch(e => console.error(e));\n    await browser.close();\n})();\n```\n\n</details>\n\nr? ``@jsha``", "tree": {"sha": "a21e82d0cdbc62741ee5f621b98d0f78bdc95ecc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a21e82d0cdbc62741ee5f621b98d0f78bdc95ecc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/59c9c66bc019bec1c21dd5ac9b74b6b4a3468403", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhmL4LCRBK7hj4Ov3rIwAAPBYIALG6HT0KL8v1BpdIbnXOIM2g\n8HwyFif7BbjKdhdiQ35ByOyKphDPPEtvv91WEiOtbGnyG+UF+UKUKsLD0CE33epD\nQNStSDrFLahaymmuwGOY3M14E4G5NHD20GHZQJ8ck+5p4Mhwa7LL077irG6zd6Cm\nf7PR1uLTWxkLrRl5SgpxYtxfO2UqKlpUEpNH9IbBZGiSMvw1TXYPkz7kRK1yxFgW\nn57omHxlRG2/2FDmIim9+6r57Cqhq//H9lzhURM+aTI5S+/RBA1IjJLnPvSld7K5\nor50a28sSqoRyacAmbYQlB+1MCqws3EvWon7SJhDqZDC3MptpVLOl/lE+fB/BRs=\n=Srg/\n-----END PGP SIGNATURE-----\n", "payload": "tree a21e82d0cdbc62741ee5f621b98d0f78bdc95ecc\nparent 79935714f39e55cdbb2e524b3b228c783b58daa9\nparent bf10c88fbd15c6ca1254a0100ec76d464f665f86\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1637400075 +0100\ncommitter GitHub <noreply@github.com> 1637400075 +0100\n\nRollup merge of #90983 - GuillaumeGomez:sidebar-scrollbar, r=jsha\n\nMake scrollbar in the sidebar always visible for visual consistency\n\nFixes #90943.\n\nI had to add a background in `dark` and `ayu` themes, otherwise it was looking strange (like an invisible margin). So it looks like this:\n\n![Screenshot from 2021-11-17 14-45-49](https://user-images.githubusercontent.com/3050060/142212476-18892ae0-ba4b-48e3-8c0f-4ca1dd2f851d.png)\n![Screenshot from 2021-11-17 14-45-53](https://user-images.githubusercontent.com/3050060/142212482-e97b2fad-68d2-439a-b62e-b56e6ded5345.png)\n\nSadly, I wasn't able to add a GUI test to ensure that the scrollbar was always displayed because it seems not possible in puppeteer for whatever reason... I used this method: on small pages (like `lib2/sub_mod/index.html`), comparing `.navbar`'s `clientWidth` with `offsetWidth` (the first doesn't include the sidebar in the computed amount). When checking in the browser, it works fine but in puppeteer it almost never works...\n\nIn case anyone want to try to solve the bug, here is the puppeteer code:\n\n<details>\nMore information about this: I tried another approach which was to get the element in `evaluate` directly (by calling it from `page.evaluate(() => { .. });` directly instead of `parseAssertElemProp.evaluate(e => {...});`.\n\n```js\nconst puppeteer = require('puppeteer');\n\n(async () => {\n    const browser = await puppeteer.launch();\n    const page = await browser.newPage();\n    await page.goto(\"file:///path/rust/build/x86_64-unknown-linux-gnu/test/rustdoc-gui/doc/lib2/sub_mod/index.html\");\n    await page.waitFor(\".sidebar\");\n    let parseAssertElemProp = await page.$(\".sidebar\");\n    if (parseAssertElemProp === null) { throw '\".sidebar\" not found'; }\n    await parseAssertElemProp.evaluate(e => {\n        const parseAssertElemPropDict = {\"clientWidth\": \"192\", \"offsetWidth\":\"200\"};\n        for (const [parseAssertElemPropKey, parseAssertElemPropValue] of Object.entries(parseAssertElemPropDict)) {\n            if (e[parseAssertElemPropKey] === undefined || String(e[parseAssertElemPropKey]) != parseAssertElemPropValue) {\n                throw 'expected `' + parseAssertElemPropValue + '` for property `' + parseAssertElemPropKey + '` for selector `.sidebar`, found `' + e[parseAssertElemPropKey] + '`';\n            }\n        }\n    }).catch(e => console.error(e));\n    await browser.close();\n})();\n```\n\n</details>\n\nr? ``@jsha``\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/59c9c66bc019bec1c21dd5ac9b74b6b4a3468403", "html_url": "https://github.com/rust-lang/rust/commit/59c9c66bc019bec1c21dd5ac9b74b6b4a3468403", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/59c9c66bc019bec1c21dd5ac9b74b6b4a3468403/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "79935714f39e55cdbb2e524b3b228c783b58daa9", "url": "https://api.github.com/repos/rust-lang/rust/commits/79935714f39e55cdbb2e524b3b228c783b58daa9", "html_url": "https://github.com/rust-lang/rust/commit/79935714f39e55cdbb2e524b3b228c783b58daa9"}, {"sha": "bf10c88fbd15c6ca1254a0100ec76d464f665f86", "url": "https://api.github.com/repos/rust-lang/rust/commits/bf10c88fbd15c6ca1254a0100ec76d464f665f86", "html_url": "https://github.com/rust-lang/rust/commit/bf10c88fbd15c6ca1254a0100ec76d464f665f86"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "e3154ad84afc581ab9b11f9d03cc07dd62706d7e", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/59c9c66bc019bec1c21dd5ac9b74b6b4a3468403/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/59c9c66bc019bec1c21dd5ac9b74b6b4a3468403/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=59c9c66bc019bec1c21dd5ac9b74b6b4a3468403", "patch": "@@ -303,7 +303,7 @@ nav.sub {\n \tleft: 0;\n \ttop: 0;\n \tbottom: 0;\n-\toverflow: auto;\n+\toverflow-y: scroll;\n }\n \n /* Improve the scrollbar display on firefox */"}, {"sha": "91ede47c156b8b4535dad37a8a56ce3d6c4904a4", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/59c9c66bc019bec1c21dd5ac9b74b6b4a3468403/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/59c9c66bc019bec1c21dd5ac9b74b6b4a3468403/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=59c9c66bc019bec1c21dd5ac9b74b6b4a3468403", "patch": "@@ -70,11 +70,11 @@ pre, .rustdoc.source .example-wrap {\n \n /* Improve the scrollbar display on firefox */\n * {\n-\tscrollbar-color: #5c6773 transparent;\n+\tscrollbar-color: #5c6773 #24292f;\n }\n \n .sidebar {\n-\tscrollbar-color: #5c6773 transparent;\n+\tscrollbar-color: #5c6773 #24292f;\n }\n \n /* Improve the scrollbar display on webkit-based browsers */"}, {"sha": "74a4fe45a3d1bca5542447ad5b6c6244e5598efc", "filename": "src/librustdoc/html/static/css/themes/dark.css", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/59c9c66bc019bec1c21dd5ac9b74b6b4a3468403/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/59c9c66bc019bec1c21dd5ac9b74b6b4a3468403/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css?ref=59c9c66bc019bec1c21dd5ac9b74b6b4a3468403", "patch": "@@ -44,7 +44,7 @@ pre, .rustdoc.source .example-wrap {\n \tscrollbar-color: rgb(64, 65, 67) #717171;\n }\n .sidebar {\n-\tscrollbar-color: rgba(32,34,37,.6) transparent;\n+\tscrollbar-color: rgba(32,34,37,.6) #5a5a5a;\n }\n \n /* Improve the scrollbar display on webkit-based browsers */"}]}