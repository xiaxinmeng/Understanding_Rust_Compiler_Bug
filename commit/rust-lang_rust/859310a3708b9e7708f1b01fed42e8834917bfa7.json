{"sha": "859310a3708b9e7708f1b01fed42e8834917bfa7", "node_id": "C_kwDOAAsO6NoAKDg1OTMxMGEzNzA4YjllNzcwOGYxYjAxZmVkNDJlODgzNDkxN2JmYTc", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-11-22T10:52:35Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-11-22T10:52:35Z"}, "message": "ensure current getrandom works with strict provenance", "tree": {"sha": "75cecd36414edd133326311b657c0b0fb3298a29", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/75cecd36414edd133326311b657c0b0fb3298a29"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/859310a3708b9e7708f1b01fed42e8834917bfa7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/859310a3708b9e7708f1b01fed42e8834917bfa7", "html_url": "https://github.com/rust-lang/rust/commit/859310a3708b9e7708f1b01fed42e8834917bfa7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/859310a3708b9e7708f1b01fed42e8834917bfa7/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "105dba79686f9e57ce48c07c736acd12f739ca58", "url": "https://api.github.com/repos/rust-lang/rust/commits/105dba79686f9e57ce48c07c736acd12f739ca58", "html_url": "https://github.com/rust-lang/rust/commit/105dba79686f9e57ce48c07c736acd12f739ca58"}], "stats": {"total": 18, "additions": 12, "deletions": 6}, "files": [{"sha": "d8c70935fb144fbb51b7a065718bcf49b74ab1d1", "filename": "src/tools/miri/test_dependencies/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/859310a3708b9e7708f1b01fed42e8834917bfa7/src%2Ftools%2Fmiri%2Ftest_dependencies%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/859310a3708b9e7708f1b01fed42e8834917bfa7/src%2Ftools%2Fmiri%2Ftest_dependencies%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiri%2Ftest_dependencies%2FCargo.toml?ref=859310a3708b9e7708f1b01fed42e8834917bfa7", "patch": "@@ -15,7 +15,7 @@ page_size = \"0.4.1\"\n num_cpus = \"1.10.1\"\n \n getrandom_1 = { package = \"getrandom\", version = \"0.1\" }\n-getrandom_2 = { package = \"getrandom\", version = \"0.2\" }\n+getrandom = { version = \"0.2\" }\n rand = { version = \"0.8\", features = [\"small_rng\"] }\n \n [workspace]"}, {"sha": "2c7bd93fbdb38ce7e58d765ee9382864f50c3319", "filename": "src/tools/miri/tests/pass-dep/getrandom_1.rs", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/859310a3708b9e7708f1b01fed42e8834917bfa7/src%2Ftools%2Fmiri%2Ftests%2Fpass-dep%2Fgetrandom_1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/859310a3708b9e7708f1b01fed42e8834917bfa7/src%2Ftools%2Fmiri%2Ftests%2Fpass-dep%2Fgetrandom_1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiri%2Ftests%2Fpass-dep%2Fgetrandom_1.rs?ref=859310a3708b9e7708f1b01fed42e8834917bfa7", "patch": "@@ -0,0 +1,8 @@\n+// mac-os `getrandom_1` does some pointer shenanigans\n+//@compile-flags: -Zmiri-permissive-provenance\n+\n+/// Test old version of `getrandom`.\n+fn main() {\n+    let mut data = vec![0; 16];\n+    getrandom_1::getrandom(&mut data).unwrap();\n+}"}, {"sha": "0cd8b06d63d8aac42eee735909b64b25820228d3", "filename": "src/tools/miri/tests/pass-dep/random.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/859310a3708b9e7708f1b01fed42e8834917bfa7/src%2Ftools%2Fmiri%2Ftests%2Fpass-dep%2Frandom.rs", "raw_url": "https://github.com/rust-lang/rust/raw/859310a3708b9e7708f1b01fed42e8834917bfa7/src%2Ftools%2Fmiri%2Ftests%2Fpass-dep%2Frandom.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiri%2Ftests%2Fpass-dep%2Frandom.rs?ref=859310a3708b9e7708f1b01fed42e8834917bfa7", "patch": "@@ -1,12 +1,10 @@\n-// mac-os `getrandom_1` does some pointer shenanigans\n-//@compile-flags: -Zmiri-permissive-provenance\n+//@compile-flags: -Zmiri-strict-provenance\n use rand::{rngs::SmallRng, Rng, SeedableRng};\n \n fn main() {\n-    // Test `getrandom` directly (in multiple different versions).\n+    // Test `getrandom` directly.\n     let mut data = vec![0; 16];\n-    getrandom_1::getrandom(&mut data).unwrap();\n-    getrandom_2::getrandom(&mut data).unwrap();\n+    getrandom::getrandom(&mut data).unwrap();\n \n     // Try seeding with \"real\" entropy.\n     let mut rng = SmallRng::from_entropy();"}, {"sha": "349b447569a4b8a8dab625b80c1a0e648cc933bf", "filename": "src/tools/miri/tests/pass-dep/shims/libc-getrandom-without-isolation.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/859310a3708b9e7708f1b01fed42e8834917bfa7/src%2Ftools%2Fmiri%2Ftests%2Fpass-dep%2Fshims%2Flibc-getrandom-without-isolation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/859310a3708b9e7708f1b01fed42e8834917bfa7/src%2Ftools%2Fmiri%2Ftests%2Fpass-dep%2Fshims%2Flibc-getrandom-without-isolation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiri%2Ftests%2Fpass-dep%2Fshims%2Flibc-getrandom-without-isolation.rs?ref=859310a3708b9e7708f1b01fed42e8834917bfa7", "previous_filename": "src/tools/miri/tests/pass-dep/shims/linux-getrandom-without-isolation.rs"}, {"sha": "a1436c7319d3395f0a8419d2bbc34298e5156d12", "filename": "src/tools/miri/tests/pass-dep/shims/libc-getrandom.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/859310a3708b9e7708f1b01fed42e8834917bfa7/src%2Ftools%2Fmiri%2Ftests%2Fpass-dep%2Fshims%2Flibc-getrandom.rs", "raw_url": "https://github.com/rust-lang/rust/raw/859310a3708b9e7708f1b01fed42e8834917bfa7/src%2Ftools%2Fmiri%2Ftests%2Fpass-dep%2Fshims%2Flibc-getrandom.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiri%2Ftests%2Fpass-dep%2Fshims%2Flibc-getrandom.rs?ref=859310a3708b9e7708f1b01fed42e8834917bfa7", "previous_filename": "src/tools/miri/tests/pass-dep/shims/linux-getrandom.rs"}]}