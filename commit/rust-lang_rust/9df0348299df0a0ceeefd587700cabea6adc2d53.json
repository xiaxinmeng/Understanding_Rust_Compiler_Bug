{"sha": "9df0348299df0a0ceeefd587700cabea6adc2d53", "node_id": "MDY6Q29tbWl0NzI0NzEyOjlkZjAzNDgyOTlkZjBhMGNlZWVmZDU4NzcwMGNhYmVhNmFkYzJkNTM=", "commit": {"author": {"name": "Joshua Nelson", "email": "jyn514@gmail.com", "date": "2020-12-12T01:27:28Z"}, "committer": {"name": "Joshua Nelson", "email": "jyn514@gmail.com", "date": "2020-12-12T22:31:35Z"}, "message": "Fix building compiler docs with stage 0", "tree": {"sha": "8c64a8d56b383f04380a0401e6558464a408b6b3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8c64a8d56b383f04380a0401e6558464a408b6b3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9df0348299df0a0ceeefd587700cabea6adc2d53", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9df0348299df0a0ceeefd587700cabea6adc2d53", "html_url": "https://github.com/rust-lang/rust/commit/9df0348299df0a0ceeefd587700cabea6adc2d53", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9df0348299df0a0ceeefd587700cabea6adc2d53/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "39b841dfe36f90a7cd111e7f0c55f32594f6e578", "url": "https://api.github.com/repos/rust-lang/rust/commits/39b841dfe36f90a7cd111e7f0c55f32594f6e578", "html_url": "https://github.com/rust-lang/rust/commit/39b841dfe36f90a7cd111e7f0c55f32594f6e578"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "9af79e20630dffc081c868b0b6731242d4ffbae0", "filename": "src/bootstrap/builder.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/9df0348299df0a0ceeefd587700cabea6adc2d53/src%2Fbootstrap%2Fbuilder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9df0348299df0a0ceeefd587700cabea6adc2d53/src%2Fbootstrap%2Fbuilder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbuilder.rs?ref=9df0348299df0a0ceeefd587700cabea6adc2d53", "patch": "@@ -732,11 +732,14 @@ impl<'a> Builder<'a> {\n             .env(\"CFG_RELEASE_CHANNEL\", &self.config.channel)\n             .env(\"RUSTDOC_REAL\", self.rustdoc(compiler))\n             .env(\"RUSTC_BOOTSTRAP\", \"1\")\n-            .arg(\"-Znormalize_docs\")\n             .arg(\"-Winvalid_codeblock_attributes\");\n         if self.config.deny_warnings {\n             cmd.arg(\"-Dwarnings\");\n         }\n+        // cfg(not(bootstrap)), can be removed on the next beta bump\n+        if compiler.stage != 0 {\n+            cmd.arg(\"-Znormalize-docs\");\n+        }\n \n         // Remove make-related flags that can cause jobserver problems.\n         cmd.env_remove(\"MAKEFLAGS\");"}, {"sha": "8cacc2512eff130ad030423180ba7f7acc46a062", "filename": "src/bootstrap/doc.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/9df0348299df0a0ceeefd587700cabea6adc2d53/src%2Fbootstrap%2Fdoc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9df0348299df0a0ceeefd587700cabea6adc2d53/src%2Fbootstrap%2Fdoc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdoc.rs?ref=9df0348299df0a0ceeefd587700cabea6adc2d53", "patch": "@@ -527,7 +527,10 @@ impl Step for Rustc {\n         cargo.rustdocflag(\"--document-private-items\");\n         cargo.rustdocflag(\"--enable-index-page\");\n         cargo.rustdocflag(\"-Zunstable-options\");\n-        cargo.rustdocflag(\"-Znormalize-docs\");\n+        // cfg(not(bootstrap)), can be removed on the next beta bump\n+        if stage != 0 {\n+            cargo.rustdocflag(\"-Znormalize-docs\");\n+        }\n         compile::rustc_cargo(builder, &mut cargo, target);\n \n         // Only include compiler crates, no dependencies of those, such as `libc`."}]}