{"sha": "eeedd3a6e15d43d0cd3e860f36be737cb2c941ca", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVlZWRkM2E2ZTE1ZDQzZDBjZDNlODYwZjM2YmU3MzdjYjJjOTQxY2E=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-05-07T00:06:36Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-05-07T00:06:36Z"}, "message": "Auto merge of #60531 - Centril:sort-features, r=oli-obk\n\nEnforce sorting of accepted and removed features\n\nFixes https://github.com/rust-lang/rust/issues/60361 with mechanism introduced in https://github.com/rust-lang/rust/pull/60373.\n\nr? @oli-obk", "tree": {"sha": "94e3391466fe47bee789c35f86a6e7529e899716", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/94e3391466fe47bee789c35f86a6e7529e899716"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/eeedd3a6e15d43d0cd3e860f36be737cb2c941ca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/eeedd3a6e15d43d0cd3e860f36be737cb2c941ca", "html_url": "https://github.com/rust-lang/rust/commit/eeedd3a6e15d43d0cd3e860f36be737cb2c941ca", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/eeedd3a6e15d43d0cd3e860f36be737cb2c941ca/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f64ed091570f222d9a8eeb210dd6d1676ff38ceb", "url": "https://api.github.com/repos/rust-lang/rust/commits/f64ed091570f222d9a8eeb210dd6d1676ff38ceb", "html_url": "https://github.com/rust-lang/rust/commit/f64ed091570f222d9a8eeb210dd6d1676ff38ceb"}, {"sha": "639e452c5f0a76b11ebe3703a04b6ae13d96c887", "url": "https://api.github.com/repos/rust-lang/rust/commits/639e452c5f0a76b11ebe3703a04b6ae13d96c887", "html_url": "https://github.com/rust-lang/rust/commit/639e452c5f0a76b11ebe3703a04b6ae13d96c887"}], "stats": {"total": 64, "additions": 43, "deletions": 21}, "files": [{"sha": "2edd946ff11cfa91ce2c397ec2edd85df0a81582", "filename": "src/liballoc/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/eeedd3a6e15d43d0cd3e860f36be737cb2c941ca/src%2Fliballoc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eeedd3a6e15d43d0cd3e860f36be737cb2c941ca/src%2Fliballoc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Flib.rs?ref=eeedd3a6e15d43d0cd3e860f36be737cb2c941ca", "patch": "@@ -87,7 +87,6 @@\n #![feature(fundamental)]\n #![feature(lang_items)]\n #![feature(libc)]\n-#![feature(needs_allocator)]\n #![feature(nll)]\n #![feature(optin_builtin_traits)]\n #![feature(pattern)]"}, {"sha": "ae297f9a4a3fd1f197da7c6e28df333437cb7490", "filename": "src/libsyntax/feature_gate.rs", "status": "modified", "additions": 39, "deletions": 16, "changes": 55, "blob_url": "https://github.com/rust-lang/rust/blob/eeedd3a6e15d43d0cd3e860f36be737cb2c941ca/src%2Flibsyntax%2Ffeature_gate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eeedd3a6e15d43d0cd3e860f36be737cb2c941ca/src%2Flibsyntax%2Ffeature_gate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ffeature_gate.rs?ref=eeedd3a6e15d43d0cd3e860f36be737cb2c941ca", "patch": "@@ -108,8 +108,8 @@ macro_rules! declare_features {\n // was set. This is most important for knowing when a particular feature became\n // stable (active).\n //\n-// Note that the features should be grouped into internal/user-facing\n-// and then sorted by version inside those groups. This is inforced with tidy.\n+// Note that the features are grouped into internal/user-facing and then\n+// sorted by version inside those groups. This is inforced with tidy.\n //\n // N.B., `tools/tidy/src/features.rs` parses this information directly out of the\n // source, so take care when modifying it.\n@@ -119,7 +119,7 @@ declare_features! (\n     // feature-group-start: internal feature gates\n     // -------------------------------------------------------------------------\n \n-    // no tracking issue START\n+    // no-tracking-issue-start\n \n     // Allows using the `rust-intrinsic`'s \"ABI\".\n     (active, intrinsics, \"1.0.0\", None, None),\n@@ -152,7 +152,7 @@ declare_features! (\n     // lets a function to be `const` when opted into with `#![feature(foo)]`.\n     (active, rustc_const_unstable, \"1.0.0\", None, None),\n \n-    // no tracking issue END\n+    // no-tracking-issue-end\n \n     // Allows using `#[link_name=\"llvm.*\"]`.\n     (active, link_llvm_intrinsics, \"1.0.0\", Some(29602), None),\n@@ -187,28 +187,25 @@ declare_features! (\n     // Allows using `box` in patterns (RFC 469).\n     (active, box_patterns, \"1.0.0\", Some(29641), None),\n \n-    // no tracking issue START\n+    // no-tracking-issue-start\n \n     // Allows using `#[prelude_import]` on glob `use` items.\n     (active, prelude_import, \"1.2.0\", None, None),\n \n-    // no tracking issue END\n+    // no-tracking-issue-end\n \n     // Allows using `#[unsafe_destructor_blind_to_params]` (RFC 1238).\n     (active, dropck_parametricity, \"1.3.0\", Some(28498), None),\n \n-    // FIXME(Centril): Investigate whether this gate actually has any effect.\n-    (active, needs_allocator, \"1.4.0\", Some(27389), None),\n-\n-    // no tracking issue START\n+    // no-tracking-issue-start\n \n     // Allows using `#[omit_gdb_pretty_printer_section]`.\n     (active, omit_gdb_pretty_printer_section, \"1.5.0\", None, None),\n \n     // Allows using the `vectorcall` ABI.\n     (active, abi_vectorcall, \"1.7.0\", None, None),\n \n-    // no tracking issue END\n+    // no-tracking-issue-end\n \n     // Allows using `#[structural_match]` which indicates that a type is structurally matchable.\n     (active, structural_match, \"1.8.0\", Some(31434), None),\n@@ -222,7 +219,7 @@ declare_features! (\n     // Allows declaring with `#![needs_panic_runtime]` that a panic runtime is needed.\n     (active, needs_panic_runtime, \"1.10.0\", Some(32837), None),\n \n-    // no tracking issue START\n+    // no-tracking-issue-start\n \n     // Allows identifying the `compiler_builtins` crate.\n     (active, compiler_builtins, \"1.13.0\", None, None),\n@@ -245,7 +242,7 @@ declare_features! (\n     // Allows using the `format_args_nl` macro.\n     (active, format_args_nl, \"1.29.0\", None, None),\n \n-    // no tracking issue END\n+    // no-tracking-issue-end\n \n     // Added for testing E0705; perma-unstable.\n     (active, test_2018_feature, \"1.31.0\", Some(0), Some(Edition::Edition2018)),\n@@ -567,6 +564,10 @@ const INCOMPLETE_FEATURES: &[&str] = &[\n ];\n \n declare_features! (\n+    // -------------------------------------------------------------------------\n+    // feature-group-start: removed features\n+    // -------------------------------------------------------------------------\n+\n     (removed, import_shadowing, \"1.0.0\", None, None, None),\n     (removed, managed_boxes, \"1.0.0\", None, None, None),\n     // Allows use of unary negate on unsigned integers, e.g., -e for e: u8\n@@ -581,14 +582,16 @@ declare_features! (\n     (removed, unsafe_no_drop_flag, \"1.0.0\", None, None, None),\n     // Allows using items which are missing stability attributes\n     (removed, unmarked_api, \"1.0.0\", None, None, None),\n-    (removed, pushpop_unsafe, \"1.2.0\", None, None, None),\n     (removed, allocator, \"1.0.0\", None, None, None),\n     (removed, simd, \"1.0.0\", Some(27731), None,\n      Some(\"removed in favor of `#[repr(simd)]`\")),\n     (removed, advanced_slice_patterns, \"1.0.0\", Some(23121), None,\n      Some(\"merged into `#![feature(slice_patterns)]`\")),\n     (removed, macro_reexport, \"1.0.0\", Some(29638), None,\n      Some(\"subsumed by `pub use`\")),\n+    (removed, pushpop_unsafe, \"1.2.0\", None, None, None),\n+    (removed, needs_allocator, \"1.4.0\", Some(27389), None,\n+     Some(\"subsumed by `#![feature(allocator_internals)]`\")),\n     (removed, proc_macro_mod, \"1.27.0\", Some(54727), None,\n      Some(\"subsumed by `#![feature(proc_macro_hygiene)]`\")),\n     (removed, proc_macro_expr, \"1.27.0\", Some(54727), None,\n@@ -600,26 +603,42 @@ declare_features! (\n     (removed, panic_implementation, \"1.28.0\", Some(44489), None,\n      Some(\"subsumed by `#[panic_handler]`\")),\n     // Allows the use of `#[derive(Anything)]` as sugar for `#[derive_Anything]`.\n-    (removed, custom_derive, \"1.0.0\", Some(29644), None,\n+    (removed, custom_derive, \"1.32.0\", Some(29644), None,\n      Some(\"subsumed by `#[proc_macro_derive]`\")),\n     // Paths of the form: `extern::foo::bar`\n     (removed, extern_in_paths, \"1.33.0\", Some(55600), None,\n      Some(\"subsumed by `::foo::bar` paths\")),\n-    (removed, quote, \"1.0.0\", Some(29601), None, None),\n+    (removed, quote, \"1.33.0\", Some(29601), None, None),\n+\n+    // -------------------------------------------------------------------------\n+    // feature-group-end: removed features\n+    // -------------------------------------------------------------------------\n );\n \n declare_features! (\n     (stable_removed, no_stack_check, \"1.0.0\", None, None),\n );\n \n declare_features! (\n+    // -------------------------------------------------------------------------\n+    // feature-group-start: for testing purposes\n+    // -------------------------------------------------------------------------\n+\n     // A temporary feature gate used to enable parser extensions needed\n     // to bootstrap fix for #5723.\n     (accepted, issue_5723_bootstrap, \"1.0.0\", None, None),\n     // These are used to test this portion of the compiler,\n     // they don't actually mean anything.\n     (accepted, test_accepted_feature, \"1.0.0\", None, None),\n \n+    // -------------------------------------------------------------------------\n+    // feature-group-end: for testing purposes\n+    // -------------------------------------------------------------------------\n+\n+    // -------------------------------------------------------------------------\n+    // feature-group-start: accepted features\n+    // -------------------------------------------------------------------------\n+\n     // Allows using associated `type`s in `trait`s.\n     (accepted, associated_types, \"1.0.0\", None, None),\n     // Allows using assigning a default type to type parameters in algebraic data type definitions.\n@@ -809,6 +828,10 @@ declare_features! (\n     (accepted, extern_crate_self, \"1.34.0\", Some(56409), None),\n     // Allows arbitrary delimited token streams in non-macro attributes.\n     (accepted, unrestricted_attribute_tokens, \"1.34.0\", Some(55208), None),\n+\n+    // -------------------------------------------------------------------------\n+    // feature-group-end: accepted features\n+    // -------------------------------------------------------------------------\n );\n \n // If you change this, please modify `src/doc/unstable-book` as well. You must"}, {"sha": "637f10c5ae745a14ef39f5f52e48451c14d1d045", "filename": "src/tools/tidy/src/features.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/eeedd3a6e15d43d0cd3e860f36be737cb2c941ca/src%2Ftools%2Ftidy%2Fsrc%2Ffeatures.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eeedd3a6e15d43d0cd3e860f36be737cb2c941ca/src%2Ftools%2Ftidy%2Fsrc%2Ffeatures.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Ftidy%2Fsrc%2Ffeatures.rs?ref=eeedd3a6e15d43d0cd3e860f36be737cb2c941ca", "patch": "@@ -191,7 +191,7 @@ pub fn collect_lang_features(base_src_path: &Path, bad: &mut bool) -> Features {\n \n     // We allow rustc-internal features to omit a tracking issue.\n     // To make tidy accept omitting a tracking issue, group the list of features\n-    // without one inside `// no tracking issue START` and `// no tracking issue END`.\n+    // without one inside `// no-tracking-issue` and `// no-tracking-issue-end`.\n     let mut next_feature_omits_tracking_issue = false;\n \n     let mut in_feature_group = false;\n@@ -201,13 +201,13 @@ pub fn collect_lang_features(base_src_path: &Path, bad: &mut bool) -> Features {\n         .filter_map(|(line, line_number)| {\n             let line = line.trim();\n \n-            // Within START and END, the tracking issue can be omitted.\n+            // Within -start and -end, the tracking issue can be omitted.\n             match line {\n-                \"// no tracking issue START\" => {\n+                \"// no-tracking-issue-start\" => {\n                     next_feature_omits_tracking_issue = true;\n                     return None;\n                 }\n-                \"// no tracking issue END\" => {\n+                \"// no-tracking-issue-end\" => {\n                     next_feature_omits_tracking_issue = false;\n                     return None;\n                 }"}]}