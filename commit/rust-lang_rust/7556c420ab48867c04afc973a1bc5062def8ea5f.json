{"sha": "7556c420ab48867c04afc973a1bc5062def8ea5f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc1NTZjNDIwYWI0ODg2N2MwNGFmYzk3M2ExYmM1MDYyZGVmOGVhNWY=", "commit": {"author": {"name": "Ruben Schmidmeister", "email": "ruben.schmidmeister@icloud.com", "date": "2019-04-24T19:58:50Z"}, "committer": {"name": "Ruben Schmidmeister", "email": "ruben.schmidmeister@icloud.com", "date": "2019-04-24T19:58:50Z"}, "message": "Use more descriptive names", "tree": {"sha": "278e2c78fc43244b0ba9c59d3974555e4182a142", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/278e2c78fc43244b0ba9c59d3974555e4182a142"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7556c420ab48867c04afc973a1bc5062def8ea5f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCAAdFiEEU0FXzFYkrmfOhhqxKTh7Wnqvhj8FAlzAwAIACgkQKTh7Wnqv\nhj+Ocgf/YU9pdaS3r+2IFF2ZhnvpdkJnaeWHA/xYUsC7SrO1a89V+5Olmzn4Y3/r\ntdn4hg3EzHG7xB0uVHnd9Qa7ozNnydCrIqc8yCL0K1d2WzzEdK1GP6MFaCOOtruC\nPnqUntI5GoHD1BfFVnp7RIwgAbOaUDWiVnRetp6C/gluu7TEPg01QMRva/gAoiBj\nlV88WQCcY+QWVvGHTY1L9RuTMwrjoemKyI2I3Nn8axCbO/nmfMBUj2VGNx3UdbMF\n2Yrxg+i6NJMxb7cQOJfBQmHRIOxSNt+C9yCtKargk/FLnLjTnaczQCEUFSMWezhk\nyzuQalGrwFOTcEnoTsHfzSHVSEAcDw==\n=IqfW\n-----END PGP SIGNATURE-----", "payload": "tree 278e2c78fc43244b0ba9c59d3974555e4182a142\nparent 19bd1a44cebb3cbab7c1a9bf8486ea3458a03aef\nauthor Ruben Schmidmeister <ruben.schmidmeister@icloud.com> 1556135930 +0200\ncommitter Ruben Schmidmeister <ruben.schmidmeister@icloud.com> 1556135930 +0200\n\nUse more descriptive names\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7556c420ab48867c04afc973a1bc5062def8ea5f", "html_url": "https://github.com/rust-lang/rust/commit/7556c420ab48867c04afc973a1bc5062def8ea5f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7556c420ab48867c04afc973a1bc5062def8ea5f/comments", "author": {"login": "bash", "id": 4602612, "node_id": "MDQ6VXNlcjQ2MDI2MTI=", "avatar_url": "https://avatars.githubusercontent.com/u/4602612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bash", "html_url": "https://github.com/bash", "followers_url": "https://api.github.com/users/bash/followers", "following_url": "https://api.github.com/users/bash/following{/other_user}", "gists_url": "https://api.github.com/users/bash/gists{/gist_id}", "starred_url": "https://api.github.com/users/bash/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bash/subscriptions", "organizations_url": "https://api.github.com/users/bash/orgs", "repos_url": "https://api.github.com/users/bash/repos", "events_url": "https://api.github.com/users/bash/events{/privacy}", "received_events_url": "https://api.github.com/users/bash/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bash", "id": 4602612, "node_id": "MDQ6VXNlcjQ2MDI2MTI=", "avatar_url": "https://avatars.githubusercontent.com/u/4602612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bash", "html_url": "https://github.com/bash", "followers_url": "https://api.github.com/users/bash/followers", "following_url": "https://api.github.com/users/bash/following{/other_user}", "gists_url": "https://api.github.com/users/bash/gists{/gist_id}", "starred_url": "https://api.github.com/users/bash/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bash/subscriptions", "organizations_url": "https://api.github.com/users/bash/orgs", "repos_url": "https://api.github.com/users/bash/repos", "events_url": "https://api.github.com/users/bash/events{/privacy}", "received_events_url": "https://api.github.com/users/bash/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "19bd1a44cebb3cbab7c1a9bf8486ea3458a03aef", "url": "https://api.github.com/repos/rust-lang/rust/commits/19bd1a44cebb3cbab7c1a9bf8486ea3458a03aef", "html_url": "https://github.com/rust-lang/rust/commit/19bd1a44cebb3cbab7c1a9bf8486ea3458a03aef"}], "stats": {"total": 18, "additions": 10, "deletions": 8}, "files": [{"sha": "7d64441bd04514bba55a96371fcbe40c1ab64b00", "filename": "src/formatting/newline_style.rs", "status": "modified", "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/7556c420ab48867c04afc973a1bc5062def8ea5f/src%2Fformatting%2Fnewline_style.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7556c420ab48867c04afc973a1bc5062def8ea5f/src%2Fformatting%2Fnewline_style.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fformatting%2Fnewline_style.rs?ref=7556c420ab48867c04afc973a1bc5062def8ea5f", "patch": "@@ -41,15 +41,17 @@ const LINE_FEED: char = '\\n';\n const CARRIAGE_RETURN: char = '\\r';\n \n fn auto_detect_newline_style(raw_input_text: &str) -> EffectiveNewlineStyle {\n-    if let Some(pos) = raw_input_text.chars().position(|ch| ch == LINE_FEED) {\n-        let pos = pos.saturating_sub(1);\n-        if let Some(CARRIAGE_RETURN) = raw_input_text.chars().nth(pos) {\n-            EffectiveNewlineStyle::Windows\n-        } else {\n-            EffectiveNewlineStyle::Unix\n+    let first_line_feed_pos = raw_input_text.chars().position(|ch| ch == LINE_FEED);\n+    match first_line_feed_pos {\n+        Some(first_line_feed_pos) => {\n+            let char_before_line_feed_pos = first_line_feed_pos.saturating_sub(1);\n+            let char_before_line_feed = raw_input_text.chars().nth(char_before_line_feed_pos);\n+            match char_before_line_feed {\n+                Some(CARRIAGE_RETURN) => EffectiveNewlineStyle::Windows,\n+                _ => EffectiveNewlineStyle::Unix,\n+            }\n         }\n-    } else {\n-        native_newline_style()\n+        None => native_newline_style(),\n     }\n }\n "}]}