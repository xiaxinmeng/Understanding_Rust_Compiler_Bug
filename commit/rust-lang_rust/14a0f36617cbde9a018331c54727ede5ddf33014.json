{"sha": "14a0f36617cbde9a018331c54727ede5ddf33014", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE0YTBmMzY2MTdjYmRlOWEwMTgzMzFjNTQ3MjdlZGU1ZGRmMzMwMTQ=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-10-17T23:48:55Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-10-17T23:48:55Z"}, "message": "Auto merge of #4683 - HMPerson1:inefficient_to_string, r=Manishearth\n\nAdd `inefficient_to_string` lint\n\nCloses #4586\n\nchangelog: Add `inefficient_to_string` lint, which checks for calling `to_string` on `&&str`, which would bypass the `str`'s specialization", "tree": {"sha": "40bb9f7fffc38cd9a0574fc8daa5d94cf52cd4d5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/40bb9f7fffc38cd9a0574fc8daa5d94cf52cd4d5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/14a0f36617cbde9a018331c54727ede5ddf33014", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/14a0f36617cbde9a018331c54727ede5ddf33014", "html_url": "https://github.com/rust-lang/rust/commit/14a0f36617cbde9a018331c54727ede5ddf33014", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/14a0f36617cbde9a018331c54727ede5ddf33014/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e979eb4cc55ffd357158c7d30133cbf894e93fe9", "url": "https://api.github.com/repos/rust-lang/rust/commits/e979eb4cc55ffd357158c7d30133cbf894e93fe9", "html_url": "https://github.com/rust-lang/rust/commit/e979eb4cc55ffd357158c7d30133cbf894e93fe9"}, {"sha": "2106a239669ec2ffbf3ccec98fbc88442d5c001f", "url": "https://api.github.com/repos/rust-lang/rust/commits/2106a239669ec2ffbf3ccec98fbc88442d5c001f", "html_url": "https://github.com/rust-lang/rust/commit/2106a239669ec2ffbf3ccec98fbc88442d5c001f"}], "stats": {"total": 220, "additions": 216, "deletions": 4}, "files": [{"sha": "42ab00001d9749f91cb3a732e25cd364378a4a87", "filename": "CHANGELOG.md", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/14a0f36617cbde9a018331c54727ede5ddf33014/CHANGELOG.md", "raw_url": "https://github.com/rust-lang/rust/raw/14a0f36617cbde9a018331c54727ede5ddf33014/CHANGELOG.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/CHANGELOG.md?ref=14a0f36617cbde9a018331c54727ede5ddf33014", "patch": "@@ -1033,6 +1033,7 @@ Released 2018-09-13\n [`inconsistent_digit_grouping`]: https://rust-lang.github.io/rust-clippy/master/index.html#inconsistent_digit_grouping\n [`indexing_slicing`]: https://rust-lang.github.io/rust-clippy/master/index.html#indexing_slicing\n [`ineffective_bit_mask`]: https://rust-lang.github.io/rust-clippy/master/index.html#ineffective_bit_mask\n+[`inefficient_to_string`]: https://rust-lang.github.io/rust-clippy/master/index.html#inefficient_to_string\n [`infallible_destructuring_match`]: https://rust-lang.github.io/rust-clippy/master/index.html#infallible_destructuring_match\n [`infinite_iter`]: https://rust-lang.github.io/rust-clippy/master/index.html#infinite_iter\n [`inherent_to_string`]: https://rust-lang.github.io/rust-clippy/master/index.html#inherent_to_string"}, {"sha": "5023538c5ed905e0f35f0221de17112779928f16", "filename": "README.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/14a0f36617cbde9a018331c54727ede5ddf33014/README.md", "raw_url": "https://github.com/rust-lang/rust/raw/14a0f36617cbde9a018331c54727ede5ddf33014/README.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/README.md?ref=14a0f36617cbde9a018331c54727ede5ddf33014", "patch": "@@ -6,7 +6,7 @@\n \n A collection of lints to catch common mistakes and improve your [Rust](https://github.com/rust-lang/rust) code.\n \n-[There are 325 lints included in this crate!](https://rust-lang.github.io/rust-clippy/master/index.html)\n+[There are 326 lints included in this crate!](https://rust-lang.github.io/rust-clippy/master/index.html)\n \n We have a bunch of lint categories to allow you to choose how much Clippy is supposed to ~~annoy~~ help you:\n "}, {"sha": "ccc5b74de302465bf6d019a552917fda5e2484c0", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/14a0f36617cbde9a018331c54727ede5ddf33014/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14a0f36617cbde9a018331c54727ede5ddf33014/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=14a0f36617cbde9a018331c54727ede5ddf33014", "patch": "@@ -808,6 +808,7 @@ pub fn register_plugins(reg: &mut rustc_driver::plugin::Registry<'_>, conf: &Con\n         methods::EXPECT_FUN_CALL,\n         methods::FILTER_NEXT,\n         methods::FLAT_MAP_IDENTITY,\n+        methods::INEFFICIENT_TO_STRING,\n         methods::INTO_ITER_ON_ARRAY,\n         methods::INTO_ITER_ON_REF,\n         methods::ITER_CLONED_COLLECT,\n@@ -1184,6 +1185,7 @@ pub fn register_plugins(reg: &mut rustc_driver::plugin::Registry<'_>, conf: &Con\n         loops::MANUAL_MEMCPY,\n         loops::NEEDLESS_COLLECT,\n         methods::EXPECT_FUN_CALL,\n+        methods::INEFFICIENT_TO_STRING,\n         methods::ITER_NTH,\n         methods::OR_FUN_CALL,\n         methods::SINGLE_CHAR_PATTERN,"}, {"sha": "9e87ab3ad3a99171656e40fdae94bdbcba0a3f2e", "filename": "clippy_lints/src/methods/inefficient_to_string.rs", "status": "added", "additions": 55, "deletions": 0, "changes": 55, "blob_url": "https://github.com/rust-lang/rust/blob/14a0f36617cbde9a018331c54727ede5ddf33014/clippy_lints%2Fsrc%2Fmethods%2Finefficient_to_string.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14a0f36617cbde9a018331c54727ede5ddf33014/clippy_lints%2Fsrc%2Fmethods%2Finefficient_to_string.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods%2Finefficient_to_string.rs?ref=14a0f36617cbde9a018331c54727ede5ddf33014", "patch": "@@ -0,0 +1,55 @@\n+use super::INEFFICIENT_TO_STRING;\n+use crate::utils::{match_def_path, paths, snippet_with_applicability, span_lint_and_then, walk_ptrs_ty_depth};\n+use if_chain::if_chain;\n+use rustc::hir;\n+use rustc::lint::LateContext;\n+use rustc::ty::{self, Ty};\n+use rustc_errors::Applicability;\n+\n+/// Checks for the `INEFFICIENT_TO_STRING` lint\n+pub fn lint<'tcx>(cx: &LateContext<'_, 'tcx>, expr: &hir::Expr, arg: &hir::Expr, arg_ty: Ty<'tcx>) {\n+    if_chain! {\n+        if let Some(to_string_meth_did) = cx.tables.type_dependent_def_id(expr.hir_id);\n+        if match_def_path(cx, to_string_meth_did, &paths::TO_STRING_METHOD);\n+        if let Some(substs) = cx.tables.node_substs_opt(expr.hir_id);\n+        let self_ty = substs.type_at(0);\n+        let (deref_self_ty, deref_count) = walk_ptrs_ty_depth(self_ty);\n+        if deref_count >= 1;\n+        if specializes_tostring(cx, deref_self_ty);\n+        then {\n+            span_lint_and_then(\n+                cx,\n+                INEFFICIENT_TO_STRING,\n+                expr.span,\n+                &format!(\"calling `to_string` on `{}`\", arg_ty),\n+                |db| {\n+                    db.help(&format!(\n+                        \"`{}` implements `ToString` through a slower blanket impl, but `{}` has a fast specialization of `ToString`\",\n+                        self_ty, deref_self_ty\n+                    ));\n+                    let mut applicability = Applicability::MachineApplicable;\n+                    let arg_snippet = snippet_with_applicability(cx, arg.span, \"..\", &mut applicability);\n+                    db.span_suggestion(\n+                        expr.span,\n+                        \"try dereferencing the receiver\",\n+                        format!(\"({}{}).to_string()\", \"*\".repeat(deref_count), arg_snippet),\n+                        applicability,\n+                    );\n+                },\n+            );\n+        }\n+    }\n+}\n+\n+/// Returns whether `ty` specializes `ToString`.\n+/// Currently, these are `str`, `String`, and `Cow<'_, str>`.\n+fn specializes_tostring(cx: &LateContext<'_, '_>, ty: Ty<'_>) -> bool {\n+    match ty.kind {\n+        ty::Str => true,\n+        ty::Adt(adt, substs) => {\n+            match_def_path(cx, adt.did, &paths::STRING)\n+                || (match_def_path(cx, adt.did, &paths::COW) && substs.type_at(1).is_str())\n+        },\n+        _ => false,\n+    }\n+}"}, {"sha": "efa283b823d9af3e8f3c3a7e4c5af7fb917faf94", "filename": "clippy_lints/src/methods/mod.rs", "status": "modified", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/14a0f36617cbde9a018331c54727ede5ddf33014/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14a0f36617cbde9a018331c54727ede5ddf33014/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs?ref=14a0f36617cbde9a018331c54727ede5ddf33014", "patch": "@@ -1,3 +1,4 @@\n+mod inefficient_to_string;\n mod manual_saturating_arithmetic;\n mod option_map_unwrap_or;\n mod unnecessary_filter_map;\n@@ -589,6 +590,29 @@ declare_clippy_lint! {\n     \"using `clone` on `&&T`\"\n }\n \n+declare_clippy_lint! {\n+    /// **What it does:** Checks for usage of `.to_string()` on an `&&T` where\n+    /// `T` implements `ToString` directly (like `&&str` or `&&String`).\n+    ///\n+    /// **Why is this bad?** This bypasses the specialized implementation of\n+    /// `ToString` and instead goes through the more expensive string formatting\n+    /// facilities.\n+    ///\n+    /// **Known problems:** None.\n+    ///\n+    /// **Example:**\n+    /// ```rust\n+    /// // Generic implementation for `T: Display` is used (slow)\n+    /// [\"foo\", \"bar\"].iter().map(|s| s.to_string());\n+    ///\n+    /// // OK, the specialized impl is used\n+    /// [\"foo\", \"bar\"].iter().map(|&s| s.to_string());\n+    /// ```\n+    pub INEFFICIENT_TO_STRING,\n+    perf,\n+    \"using `to_string` on `&&T` where `T: ToString`\"\n+}\n+\n declare_clippy_lint! {\n     /// **What it does:** Checks for `new` not returning `Self`.\n     ///\n@@ -1029,6 +1053,7 @@ declare_lint_pass!(Methods => [\n     CLONE_ON_COPY,\n     CLONE_ON_REF_PTR,\n     CLONE_DOUBLE_REF,\n+    INEFFICIENT_TO_STRING,\n     NEW_RET_NO_SELF,\n     SINGLE_CHAR_PATTERN,\n     SEARCH_IS_SOME,\n@@ -1122,6 +1147,9 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for Methods {\n                     lint_clone_on_copy(cx, expr, &args[0], self_ty);\n                     lint_clone_on_ref_ptr(cx, expr, &args[0]);\n                 }\n+                if args.len() == 1 && method_call.ident.name == sym!(to_string) {\n+                    inefficient_to_string::lint(cx, expr, &args[0], self_ty);\n+                }\n \n                 match self_ty.kind {\n                     ty::Ref(_, ty, _) if ty.kind == ty::Str => {"}, {"sha": "6bbccfa09e8920c0d09bc96406f77c6f02bfdeb2", "filename": "clippy_lints/src/replace_consts.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/14a0f36617cbde9a018331c54727ede5ddf33014/clippy_lints%2Fsrc%2Freplace_consts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14a0f36617cbde9a018331c54727ede5ddf33014/clippy_lints%2Fsrc%2Freplace_consts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Freplace_consts.rs?ref=14a0f36617cbde9a018331c54727ede5ddf33014", "patch": "@@ -39,7 +39,7 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for ReplaceConsts {\n             if let hir::ExprKind::Path(ref qp) = expr.kind;\n             if let Res::Def(DefKind::Const, def_id) = cx.tables.qpath_res(qp, expr.hir_id);\n             then {\n-                for (const_path, repl_snip) in &REPLACEMENTS {\n+                for &(ref const_path, repl_snip) in &REPLACEMENTS {\n                     if match_def_path(cx, def_id, const_path) {\n                         span_lint_and_sugg(\n                             cx,"}, {"sha": "eaad932cb6727b6e69cbb232ae456667947a5e89", "filename": "clippy_lints/src/utils/attrs.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/14a0f36617cbde9a018331c54727ede5ddf33014/clippy_lints%2Fsrc%2Futils%2Fattrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14a0f36617cbde9a018331c54727ede5ddf33014/clippy_lints%2Fsrc%2Futils%2Fattrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Fattrs.rs?ref=14a0f36617cbde9a018331c54727ede5ddf33014", "patch": "@@ -71,7 +71,7 @@ pub fn get_attr<'a>(\n                     })\n             {\n                 let mut db = sess.struct_span_err(attr_segments[1].ident.span, \"Usage of deprecated attribute\");\n-                match deprecation_status {\n+                match *deprecation_status {\n                     DeprecationStatus::Deprecated => {\n                         db.emit();\n                         false"}, {"sha": "1575f0e302785048adc6e830a9675b3d96c2c528", "filename": "src/lintlist/mod.rs", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/14a0f36617cbde9a018331c54727ede5ddf33014/src%2Flintlist%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14a0f36617cbde9a018331c54727ede5ddf33014/src%2Flintlist%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flintlist%2Fmod.rs?ref=14a0f36617cbde9a018331c54727ede5ddf33014", "patch": "@@ -6,7 +6,7 @@ pub use lint::Lint;\n pub use lint::LINT_LEVELS;\n \n // begin lint list, do not remove this comment, it\u2019s used in `update_lints`\n-pub const ALL_LINTS: [Lint; 325] = [\n+pub const ALL_LINTS: [Lint; 326] = [\n     Lint {\n         name: \"absurd_extreme_comparisons\",\n         group: \"correctness\",\n@@ -735,6 +735,13 @@ pub const ALL_LINTS: [Lint; 325] = [\n         deprecation: None,\n         module: \"bit_mask\",\n     },\n+    Lint {\n+        name: \"inefficient_to_string\",\n+        group: \"perf\",\n+        desc: \"using `to_string` on `&&T` where `T: ToString`\",\n+        deprecation: None,\n+        module: \"methods\",\n+    },\n     Lint {\n         name: \"infallible_destructuring_match\",\n         group: \"style\","}, {"sha": "32bc7574a52ea2056a3d67f7e21b7bc6b7d907a8", "filename": "tests/ui/inefficient_to_string.fixed", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/14a0f36617cbde9a018331c54727ede5ddf33014/tests%2Fui%2Finefficient_to_string.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/14a0f36617cbde9a018331c54727ede5ddf33014/tests%2Fui%2Finefficient_to_string.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Finefficient_to_string.fixed?ref=14a0f36617cbde9a018331c54727ede5ddf33014", "patch": "@@ -0,0 +1,32 @@\n+// run-rustfix\n+#![deny(clippy::inefficient_to_string)]\n+\n+use std::borrow::Cow;\n+use std::string::ToString;\n+\n+fn main() {\n+    let rstr: &str = \"hello\";\n+    let rrstr: &&str = &rstr;\n+    let rrrstr: &&&str = &rrstr;\n+    let _: String = rstr.to_string();\n+    let _: String = (*rrstr).to_string();\n+    let _: String = (**rrrstr).to_string();\n+\n+    let string: String = String::from(\"hello\");\n+    let rstring: &String = &string;\n+    let rrstring: &&String = &rstring;\n+    let rrrstring: &&&String = &rrstring;\n+    let _: String = string.to_string();\n+    let _: String = rstring.to_string();\n+    let _: String = (*rrstring).to_string();\n+    let _: String = (**rrrstring).to_string();\n+\n+    let cow: Cow<'_, str> = Cow::Borrowed(\"hello\");\n+    let rcow: &Cow<'_, str> = &cow;\n+    let rrcow: &&Cow<'_, str> = &rcow;\n+    let rrrcow: &&&Cow<'_, str> = &rrcow;\n+    let _: String = cow.to_string();\n+    let _: String = rcow.to_string();\n+    let _: String = (*rrcow).to_string();\n+    let _: String = (**rrrcow).to_string();\n+}"}, {"sha": "2741565e50d67a58523a1f339bba1f3654a0b111", "filename": "tests/ui/inefficient_to_string.rs", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/14a0f36617cbde9a018331c54727ede5ddf33014/tests%2Fui%2Finefficient_to_string.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14a0f36617cbde9a018331c54727ede5ddf33014/tests%2Fui%2Finefficient_to_string.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Finefficient_to_string.rs?ref=14a0f36617cbde9a018331c54727ede5ddf33014", "patch": "@@ -0,0 +1,32 @@\n+// run-rustfix\n+#![deny(clippy::inefficient_to_string)]\n+\n+use std::borrow::Cow;\n+use std::string::ToString;\n+\n+fn main() {\n+    let rstr: &str = \"hello\";\n+    let rrstr: &&str = &rstr;\n+    let rrrstr: &&&str = &rrstr;\n+    let _: String = rstr.to_string();\n+    let _: String = rrstr.to_string();\n+    let _: String = rrrstr.to_string();\n+\n+    let string: String = String::from(\"hello\");\n+    let rstring: &String = &string;\n+    let rrstring: &&String = &rstring;\n+    let rrrstring: &&&String = &rrstring;\n+    let _: String = string.to_string();\n+    let _: String = rstring.to_string();\n+    let _: String = rrstring.to_string();\n+    let _: String = rrrstring.to_string();\n+\n+    let cow: Cow<'_, str> = Cow::Borrowed(\"hello\");\n+    let rcow: &Cow<'_, str> = &cow;\n+    let rrcow: &&Cow<'_, str> = &rcow;\n+    let rrrcow: &&&Cow<'_, str> = &rrcow;\n+    let _: String = cow.to_string();\n+    let _: String = rcow.to_string();\n+    let _: String = rrcow.to_string();\n+    let _: String = rrrcow.to_string();\n+}"}, {"sha": "20788f6f6cc9ac439c8f1067c5993a654c41b55d", "filename": "tests/ui/inefficient_to_string.stderr", "status": "added", "additions": 55, "deletions": 0, "changes": 55, "blob_url": "https://github.com/rust-lang/rust/blob/14a0f36617cbde9a018331c54727ede5ddf33014/tests%2Fui%2Finefficient_to_string.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/14a0f36617cbde9a018331c54727ede5ddf33014/tests%2Fui%2Finefficient_to_string.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Finefficient_to_string.stderr?ref=14a0f36617cbde9a018331c54727ede5ddf33014", "patch": "@@ -0,0 +1,55 @@\n+error: calling `to_string` on `&&str`\n+  --> $DIR/inefficient_to_string.rs:12:21\n+   |\n+LL |     let _: String = rrstr.to_string();\n+   |                     ^^^^^^^^^^^^^^^^^ help: try dereferencing the receiver: `(*rrstr).to_string()`\n+   |\n+note: lint level defined here\n+  --> $DIR/inefficient_to_string.rs:2:9\n+   |\n+LL | #![deny(clippy::inefficient_to_string)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   = help: `&str` implements `ToString` through a slower blanket impl, but `str` has a fast specialization of `ToString`\n+\n+error: calling `to_string` on `&&&str`\n+  --> $DIR/inefficient_to_string.rs:13:21\n+   |\n+LL |     let _: String = rrrstr.to_string();\n+   |                     ^^^^^^^^^^^^^^^^^^ help: try dereferencing the receiver: `(**rrrstr).to_string()`\n+   |\n+   = help: `&&str` implements `ToString` through a slower blanket impl, but `str` has a fast specialization of `ToString`\n+\n+error: calling `to_string` on `&&std::string::String`\n+  --> $DIR/inefficient_to_string.rs:21:21\n+   |\n+LL |     let _: String = rrstring.to_string();\n+   |                     ^^^^^^^^^^^^^^^^^^^^ help: try dereferencing the receiver: `(*rrstring).to_string()`\n+   |\n+   = help: `&std::string::String` implements `ToString` through a slower blanket impl, but `std::string::String` has a fast specialization of `ToString`\n+\n+error: calling `to_string` on `&&&std::string::String`\n+  --> $DIR/inefficient_to_string.rs:22:21\n+   |\n+LL |     let _: String = rrrstring.to_string();\n+   |                     ^^^^^^^^^^^^^^^^^^^^^ help: try dereferencing the receiver: `(**rrrstring).to_string()`\n+   |\n+   = help: `&&std::string::String` implements `ToString` through a slower blanket impl, but `std::string::String` has a fast specialization of `ToString`\n+\n+error: calling `to_string` on `&&std::borrow::Cow<'_, str>`\n+  --> $DIR/inefficient_to_string.rs:30:21\n+   |\n+LL |     let _: String = rrcow.to_string();\n+   |                     ^^^^^^^^^^^^^^^^^ help: try dereferencing the receiver: `(*rrcow).to_string()`\n+   |\n+   = help: `&std::borrow::Cow<'_, str>` implements `ToString` through a slower blanket impl, but `std::borrow::Cow<'_, str>` has a fast specialization of `ToString`\n+\n+error: calling `to_string` on `&&&std::borrow::Cow<'_, str>`\n+  --> $DIR/inefficient_to_string.rs:31:21\n+   |\n+LL |     let _: String = rrrcow.to_string();\n+   |                     ^^^^^^^^^^^^^^^^^^ help: try dereferencing the receiver: `(**rrrcow).to_string()`\n+   |\n+   = help: `&&std::borrow::Cow<'_, str>` implements `ToString` through a slower blanket impl, but `std::borrow::Cow<'_, str>` has a fast specialization of `ToString`\n+\n+error: aborting due to 6 previous errors\n+"}]}