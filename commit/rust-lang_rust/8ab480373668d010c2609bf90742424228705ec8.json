{"sha": "8ab480373668d010c2609bf90742424228705ec8", "node_id": "C_kwDOAAsO6NoAKDhhYjQ4MDM3MzY2OGQwMTBjMjYwOWJmOTA3NDI0MjQyMjg3MDVlYzg", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2023-05-05T07:23:15Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2023-05-05T07:23:25Z"}, "message": "ensure that the proc_macro crate exists in the sysroot", "tree": {"sha": "81c015edd6e88e9760d42b2a3a541f14a344833c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/81c015edd6e88e9760d42b2a3a541f14a344833c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8ab480373668d010c2609bf90742424228705ec8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8ab480373668d010c2609bf90742424228705ec8", "html_url": "https://github.com/rust-lang/rust/commit/8ab480373668d010c2609bf90742424228705ec8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8ab480373668d010c2609bf90742424228705ec8/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4062fe2bd92300081a9c3232475a785181c99258", "url": "https://api.github.com/repos/rust-lang/rust/commits/4062fe2bd92300081a9c3232475a785181c99258", "html_url": "https://github.com/rust-lang/rust/commit/4062fe2bd92300081a9c3232475a785181c99258"}], "stats": {"total": 22, "additions": 21, "deletions": 1}, "files": [{"sha": "98c22fef07664fbe4ab9318c8668d66abf5c4eb6", "filename": "src/tools/miri/test-cargo-miri/subcrate/src/lib.rs", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/8ab480373668d010c2609bf90742424228705ec8/src%2Ftools%2Fmiri%2Ftest-cargo-miri%2Fsubcrate%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8ab480373668d010c2609bf90742424228705ec8/src%2Ftools%2Fmiri%2Ftest-cargo-miri%2Fsubcrate%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiri%2Ftest-cargo-miri%2Fsubcrate%2Fsrc%2Flib.rs?ref=8ab480373668d010c2609bf90742424228705ec8", "patch": "@@ -1,5 +1,16 @@\n+// This is a proc-macro crate.\n+\n+extern crate proc_macro; // make sure proc_macro is in the sysroot\n+\n #[cfg(doctest)]\n compile_error!(\"rustdoc should not touch me\");\n \n-#[cfg(test)]\n+#[cfg(miri)]\n compile_error!(\"Miri should not touch me\");\n+\n+use proc_macro::TokenStream;\n+\n+#[proc_macro]\n+pub fn make_answer(_item: TokenStream) -> TokenStream {\n+    \"fn answer() -> u32 { 42 }\".parse().unwrap()\n+}"}, {"sha": "2c80e5bbd8414f5c28d3273c6f77555e888754d3", "filename": "src/tools/miri/tests/pass/sysroot.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/8ab480373668d010c2609bf90742424228705ec8/src%2Ftools%2Fmiri%2Ftests%2Fpass%2Fsysroot.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8ab480373668d010c2609bf90742424228705ec8/src%2Ftools%2Fmiri%2Ftests%2Fpass%2Fsysroot.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiri%2Ftests%2Fpass%2Fsysroot.rs?ref=8ab480373668d010c2609bf90742424228705ec8", "patch": "@@ -0,0 +1,9 @@\n+//! Just check that some things are available in the sysroot.\n+#![feature(test)]\n+#![allow(unused)]\n+\n+extern crate proc_macro;\n+extern crate std;\n+extern crate test;\n+\n+fn main() {}"}]}