{"sha": "314c2b14479a98acf9155dce43348e77073a09a1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjMxNGMyYjE0NDc5YTk4YWNmOTE1NWRjZTQzMzQ4ZTc3MDczYTA5YTE=", "commit": {"author": {"name": "Samuel Holland", "email": "samuel@sholland.org", "date": "2017-09-15T04:42:21Z"}, "committer": {"name": "Samuel Holland", "email": "samuel@sholland.org", "date": "2017-09-20T02:37:19Z"}, "message": "Adjust dependency-resolution errors to be more consistent", "tree": {"sha": "b0be628c4d8dc62f1b55bf05e91e534376a6f0d2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b0be628c4d8dc62f1b55bf05e91e534376a6f0d2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/314c2b14479a98acf9155dce43348e77073a09a1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/314c2b14479a98acf9155dce43348e77073a09a1", "html_url": "https://github.com/rust-lang/rust/commit/314c2b14479a98acf9155dce43348e77073a09a1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/314c2b14479a98acf9155dce43348e77073a09a1/comments", "author": {"login": "smaeul", "id": 5846453, "node_id": "MDQ6VXNlcjU4NDY0NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/5846453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smaeul", "html_url": "https://github.com/smaeul", "followers_url": "https://api.github.com/users/smaeul/followers", "following_url": "https://api.github.com/users/smaeul/following{/other_user}", "gists_url": "https://api.github.com/users/smaeul/gists{/gist_id}", "starred_url": "https://api.github.com/users/smaeul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smaeul/subscriptions", "organizations_url": "https://api.github.com/users/smaeul/orgs", "repos_url": "https://api.github.com/users/smaeul/repos", "events_url": "https://api.github.com/users/smaeul/events{/privacy}", "received_events_url": "https://api.github.com/users/smaeul/received_events", "type": "User", "site_admin": false}, "committer": {"login": "smaeul", "id": 5846453, "node_id": "MDQ6VXNlcjU4NDY0NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/5846453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smaeul", "html_url": "https://github.com/smaeul", "followers_url": "https://api.github.com/users/smaeul/followers", "following_url": "https://api.github.com/users/smaeul/following{/other_user}", "gists_url": "https://api.github.com/users/smaeul/gists{/gist_id}", "starred_url": "https://api.github.com/users/smaeul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smaeul/subscriptions", "organizations_url": "https://api.github.com/users/smaeul/orgs", "repos_url": "https://api.github.com/users/smaeul/repos", "events_url": "https://api.github.com/users/smaeul/events{/privacy}", "received_events_url": "https://api.github.com/users/smaeul/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "779041cd5a27c7b775c9ed45948a1343a3f25f04", "url": "https://api.github.com/repos/rust-lang/rust/commits/779041cd5a27c7b775c9ed45948a1343a3f25f04", "html_url": "https://github.com/rust-lang/rust/commit/779041cd5a27c7b775c9ed45948a1343a3f25f04"}], "stats": {"total": 14, "additions": 7, "deletions": 7}, "files": [{"sha": "db0ecb6aa5eb1d624315e9f478530666b6d50c12", "filename": "src/librustc/middle/dependency_format.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/314c2b14479a98acf9155dce43348e77073a09a1/src%2Flibrustc%2Fmiddle%2Fdependency_format.rs", "raw_url": "https://github.com/rust-lang/rust/raw/314c2b14479a98acf9155dce43348e77073a09a1/src%2Flibrustc%2Fmiddle%2Fdependency_format.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fdependency_format.rs?ref=314c2b14479a98acf9155dce43348e77073a09a1", "patch": "@@ -161,7 +161,8 @@ fn calculate_type<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n                 if tcx.dep_kind(cnum).macros_only() { continue }\n                 let src = tcx.used_crate_source(cnum);\n                 if src.rlib.is_some() { continue }\n-                sess.err(&format!(\"dependency `{}` not found in rlib format\",\n+                sess.err(&format!(\"crate `{}` required to be available in rlib format, \\\n+                                  but was not found in this form\",\n                                   tcx.crate_name(cnum)));\n             }\n             return Vec::new();\n@@ -244,10 +245,9 @@ fn calculate_type<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n                     Linkage::Static => \"rlib\",\n                     _ => \"dylib\",\n                 };\n-                let name = tcx.crate_name(cnum);\n-                sess.err(&format!(\"crate `{}` required to be available in {}, \\\n-                                  but it was not available in this form\",\n-                                  name, kind));\n+                sess.err(&format!(\"crate `{}` required to be available in {} format, \\\n+                                  but was not found in this form\",\n+                                  tcx.crate_name(cnum), kind));\n             }\n         }\n     }"}, {"sha": "bf7189c21fbfdfc4a588d5df62a9fd6709da47da", "filename": "src/test/compile-fail/cdylib-deps-must-be-static.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/314c2b14479a98acf9155dce43348e77073a09a1/src%2Ftest%2Fcompile-fail%2Fcdylib-deps-must-be-static.rs", "raw_url": "https://github.com/rust-lang/rust/raw/314c2b14479a98acf9155dce43348e77073a09a1/src%2Ftest%2Fcompile-fail%2Fcdylib-deps-must-be-static.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fcdylib-deps-must-be-static.rs?ref=314c2b14479a98acf9155dce43348e77073a09a1", "patch": "@@ -8,7 +8,7 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-// error-pattern: dependency `cdylib_dep` not found in rlib format\n+// error-pattern: crate `cdylib_dep` required to be available in rlib format, but was not found\n // aux-build:cdylib-dep.rs\n // ignore-musl\n // ignore-emscripten"}, {"sha": "a61ff05e8c8b5c37bf7664453704df7f67b775a2", "filename": "src/test/compile-fail/rmeta_lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/314c2b14479a98acf9155dce43348e77073a09a1/src%2Ftest%2Fcompile-fail%2Frmeta_lib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/314c2b14479a98acf9155dce43348e77073a09a1/src%2Ftest%2Fcompile-fail%2Frmeta_lib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Frmeta_lib.rs?ref=314c2b14479a98acf9155dce43348e77073a09a1", "patch": "@@ -10,7 +10,7 @@\n \n // aux-build:rmeta_meta.rs\n // no-prefer-dynamic\n-// error-pattern: crate `rmeta_meta` required to be available in rlib, but it was not available\n+// error-pattern: crate `rmeta_meta` required to be available in rlib format, but was not found\n \n // Check that building a non-metadata crate fails if a dependent crate is\n // metadata-only."}]}