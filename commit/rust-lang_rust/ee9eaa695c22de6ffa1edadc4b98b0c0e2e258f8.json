{"sha": "ee9eaa695c22de6ffa1edadc4b98b0c0e2e258f8", "node_id": "C_kwDOAAsO6NoAKGVlOWVhYTY5NWMyMmRlNmZmYTFlZGFkYzRiOThiMGMwZTJlMjU4Zjg", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-12-01T10:59:01Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-12-01T10:59:01Z"}, "message": "Rollup merge of #105106 - jhpratt:issue-105101, r=TaKO8Ki\n\nFix ICE from #105101\n\nFixes #105101\n\nRather than comparing idents, compare spans, which should be unique to each variant.", "tree": {"sha": "64338d7d9ed76a046fbf36588f847754cede5415", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/64338d7d9ed76a046fbf36588f847754cede5415"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ee9eaa695c22de6ffa1edadc4b98b0c0e2e258f8", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjiIj1CRBK7hj4Ov3rIwAAIFsIAF89ldWw17JJyNkv/YyUAXjJ\n92/vwZABjApg+cPZqZLz12SpR/AUoj90pgup9iaercWPRXOBwv5MsFOB4xx3Oebu\n6lkITTZ/mM/CPBY4C180jyqI+xufZw6IxnKZdm7QQvYr77nFZ4Q7bmDfKKpeAeBU\n22R0PGcerCqS2aJAJYo2GsSycTJOwY35mjlZkSikRn+1BbvcTOPybvtdIkTJuKy4\nNM1weBiNsJS4bmYxi6/4iyZyhdsvPhiVdZ52TyTFIi5iLtOiNSwU/fKiP1C/Vu3I\nLMBDHKkOA7wnEN3ieCG1p+XNYD6xrmbHGcU1U1PvF6IDM2EGomCnjX8HTumT8qU=\n=4l+O\n-----END PGP SIGNATURE-----\n", "payload": "tree 64338d7d9ed76a046fbf36588f847754cede5415\nparent 3ec9a6dd74ed96fccc40b30dac7f0946c8bfd777\nparent ab264ae61217df6a2b66c8f2bbff294b793a1f94\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1669892341 +0100\ncommitter GitHub <noreply@github.com> 1669892341 +0100\n\nRollup merge of #105106 - jhpratt:issue-105101, r=TaKO8Ki\n\nFix ICE from #105101\n\nFixes #105101\n\nRather than comparing idents, compare spans, which should be unique to each variant.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ee9eaa695c22de6ffa1edadc4b98b0c0e2e258f8", "html_url": "https://github.com/rust-lang/rust/commit/ee9eaa695c22de6ffa1edadc4b98b0c0e2e258f8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ee9eaa695c22de6ffa1edadc4b98b0c0e2e258f8/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3ec9a6dd74ed96fccc40b30dac7f0946c8bfd777", "url": "https://api.github.com/repos/rust-lang/rust/commits/3ec9a6dd74ed96fccc40b30dac7f0946c8bfd777", "html_url": "https://github.com/rust-lang/rust/commit/3ec9a6dd74ed96fccc40b30dac7f0946c8bfd777"}, {"sha": "ab264ae61217df6a2b66c8f2bbff294b793a1f94", "url": "https://api.github.com/repos/rust-lang/rust/commits/ab264ae61217df6a2b66c8f2bbff294b793a1f94", "html_url": "https://github.com/rust-lang/rust/commit/ab264ae61217df6a2b66c8f2bbff294b793a1f94"}], "stats": {"total": 40, "additions": 39, "deletions": 1}, "files": [{"sha": "e88d2e409c63b0c95e1e900a7bac12d5e14c4081", "filename": "compiler/rustc_builtin_macros/src/deriving/default.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ee9eaa695c22de6ffa1edadc4b98b0c0e2e258f8/compiler%2Frustc_builtin_macros%2Fsrc%2Fderiving%2Fdefault.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ee9eaa695c22de6ffa1edadc4b98b0c0e2e258f8/compiler%2Frustc_builtin_macros%2Fsrc%2Fderiving%2Fdefault.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_builtin_macros%2Fsrc%2Fderiving%2Fdefault.rs?ref=ee9eaa695c22de6ffa1edadc4b98b0c0e2e258f8", "patch": "@@ -145,7 +145,7 @@ fn extract_default_variant<'a>(\n                 let suggestion = default_variants\n                     .iter()\n                     .filter_map(|v| {\n-                        if v.ident == variant.ident {\n+                        if v.span == variant.span {\n                             None\n                         } else {\n                             Some((cx.sess.find_by_name(&v.attrs, kw::Default)?.span, String::new()))"}, {"sha": "1a377feb91948aecf12cda6f987e2b5d0caa2346", "filename": "src/test/ui/deriving/issue-105101.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/ee9eaa695c22de6ffa1edadc4b98b0c0e2e258f8/src%2Ftest%2Fui%2Fderiving%2Fissue-105101.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ee9eaa695c22de6ffa1edadc4b98b0c0e2e258f8/src%2Ftest%2Fui%2Fderiving%2Fissue-105101.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fderiving%2Fissue-105101.rs?ref=ee9eaa695c22de6ffa1edadc4b98b0c0e2e258f8", "patch": "@@ -0,0 +1,9 @@\n+// compile-flags: --crate-type=lib\n+\n+#[derive(Default)] //~ ERROR multiple declared defaults\n+enum E {\n+    #[default]\n+    A,\n+    #[default]\n+    A, //~ ERROR defined multiple times\n+}"}, {"sha": "0f6f67043f32fdb378b459b4e18b215ee2ca2b08", "filename": "src/test/ui/deriving/issue-105101.stderr", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/ee9eaa695c22de6ffa1edadc4b98b0c0e2e258f8/src%2Ftest%2Fui%2Fderiving%2Fissue-105101.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ee9eaa695c22de6ffa1edadc4b98b0c0e2e258f8/src%2Ftest%2Fui%2Fderiving%2Fissue-105101.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fderiving%2Fissue-105101.stderr?ref=ee9eaa695c22de6ffa1edadc4b98b0c0e2e258f8", "patch": "@@ -0,0 +1,29 @@\n+error: multiple declared defaults\n+  --> $DIR/issue-105101.rs:3:10\n+   |\n+LL | #[derive(Default)]\n+   |          ^^^^^^^\n+...\n+LL |     A,\n+   |     - first default\n+LL |     #[default]\n+LL |     A,\n+   |     - additional default\n+   |\n+   = note: only one variant can be default\n+   = note: this error originates in the derive macro `Default` (in Nightly builds, run with -Z macro-backtrace for more info)\n+\n+error[E0428]: the name `A` is defined multiple times\n+  --> $DIR/issue-105101.rs:8:5\n+   |\n+LL |     A,\n+   |     - previous definition of the type `A` here\n+LL |     #[default]\n+LL |     A,\n+   |     ^ `A` redefined here\n+   |\n+   = note: `A` must be defined only once in the type namespace of this enum\n+\n+error: aborting due to 2 previous errors\n+\n+For more information about this error, try `rustc --explain E0428`."}]}