{"sha": "6edb4e22c46ae34b5b8ee0f2672f02d890944105", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZlZGI0ZTIyYzQ2YWUzNGI1YjhlZTBmMjY3MmYwMmQ4OTA5NDQxMDU=", "commit": {"author": {"name": "Josh Stone", "email": "jistone@redhat.com", "date": "2017-05-08T22:23:30Z"}, "committer": {"name": "Josh Stone", "email": "jistone@redhat.com", "date": "2017-05-15T04:06:23Z"}, "message": "Use \"rust-installer tarball\" to create rustc-src too\n\nThis gives us an extra rustc-src.tar.xz, which is 33% smaller than the .tar.gz!", "tree": {"sha": "730875079cf464bfb34e1e57593034c7aee1e29d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/730875079cf464bfb34e1e57593034c7aee1e29d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6edb4e22c46ae34b5b8ee0f2672f02d890944105", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6edb4e22c46ae34b5b8ee0f2672f02d890944105", "html_url": "https://github.com/rust-lang/rust/commit/6edb4e22c46ae34b5b8ee0f2672f02d890944105", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6edb4e22c46ae34b5b8ee0f2672f02d890944105/comments", "author": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "020c5ecca710a21f85be028d6225c9c82638ade0", "url": "https://api.github.com/repos/rust-lang/rust/commits/020c5ecca710a21f85be028d6225c9c82638ade0", "html_url": "https://github.com/rust-lang/rust/commit/020c5ecca710a21f85be028d6225c9c82638ade0"}], "stats": {"total": 12, "additions": 8, "deletions": 4}, "files": [{"sha": "254b817b847a3a623e1478dce33f8f48e0f5ed4c", "filename": "src/bootstrap/dist.rs", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/6edb4e22c46ae34b5b8ee0f2672f02d890944105/src%2Fbootstrap%2Fdist.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6edb4e22c46ae34b5b8ee0f2672f02d890944105/src%2Fbootstrap%2Fdist.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdist.rs?ref=6edb4e22c46ae34b5b8ee0f2672f02d890944105", "patch": "@@ -469,13 +469,17 @@ pub fn rust_src(build: &Build) {\n     write_file(&plain_dst_src.join(\"version\"), build.rust_version().as_bytes());\n \n     // Create plain source tarball\n-    let tarball = rust_src_location(build);\n+    let mut tarball = rust_src_location(build);\n+    tarball.set_extension(\"\"); // strip .gz\n+    tarball.set_extension(\"\"); // strip .tar\n     if let Some(dir) = tarball.parent() {\n         t!(fs::create_dir_all(dir));\n     }\n-    let mut cmd = Command::new(\"tar\");\n-    cmd.arg(\"-czf\").arg(sanitize_sh(&tarball))\n-       .arg(&plain_name)\n+    let mut cmd = rust_installer(build);\n+    cmd.arg(\"tarball\")\n+       .arg(\"--input\").arg(&plain_name)\n+       .arg(\"--output\").arg(sanitize_sh(&tarball))\n+       .arg(\"--work-dir=.\")\n        .current_dir(tmpdir(build));\n     build.run(&mut cmd);\n "}]}