{"sha": "5e35d49a5097d1a67dc1d99c367447a69c57d0bf", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVlMzVkNDlhNTA5N2QxYTY3ZGMxZDk5YzM2NzQ0N2E2OWM1N2QwYmY=", "commit": {"author": {"name": "Eric Holk", "email": "eric.holk@gmail.com", "date": "2012-05-29T18:30:10Z"}, "committer": {"name": "Eric Holk", "email": "eric.holk@gmail.com", "date": "2012-05-29T18:30:10Z"}, "message": "Moving the arc tests into arc.rs.", "tree": {"sha": "fe2b1e527cee1d060e7cf2fd00517d2551264fb4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fe2b1e527cee1d060e7cf2fd00517d2551264fb4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5e35d49a5097d1a67dc1d99c367447a69c57d0bf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5e35d49a5097d1a67dc1d99c367447a69c57d0bf", "html_url": "https://github.com/rust-lang/rust/commit/5e35d49a5097d1a67dc1d99c367447a69c57d0bf", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5e35d49a5097d1a67dc1d99c367447a69c57d0bf/comments", "author": {"login": "eholk", "id": 105766, "node_id": "MDQ6VXNlcjEwNTc2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/105766?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eholk", "html_url": "https://github.com/eholk", "followers_url": "https://api.github.com/users/eholk/followers", "following_url": "https://api.github.com/users/eholk/following{/other_user}", "gists_url": "https://api.github.com/users/eholk/gists{/gist_id}", "starred_url": "https://api.github.com/users/eholk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eholk/subscriptions", "organizations_url": "https://api.github.com/users/eholk/orgs", "repos_url": "https://api.github.com/users/eholk/repos", "events_url": "https://api.github.com/users/eholk/events{/privacy}", "received_events_url": "https://api.github.com/users/eholk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "eholk", "id": 105766, "node_id": "MDQ6VXNlcjEwNTc2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/105766?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eholk", "html_url": "https://github.com/eholk", "followers_url": "https://api.github.com/users/eholk/followers", "following_url": "https://api.github.com/users/eholk/following{/other_user}", "gists_url": "https://api.github.com/users/eholk/gists{/gist_id}", "starred_url": "https://api.github.com/users/eholk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eholk/subscriptions", "organizations_url": "https://api.github.com/users/eholk/orgs", "repos_url": "https://api.github.com/users/eholk/repos", "events_url": "https://api.github.com/users/eholk/events{/privacy}", "received_events_url": "https://api.github.com/users/eholk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "aa2efc05ea9aae3016890d61793768952b81154e", "url": "https://api.github.com/repos/rust-lang/rust/commits/aa2efc05ea9aae3016890d61793768952b81154e", "html_url": "https://github.com/rust-lang/rust/commit/aa2efc05ea9aae3016890d61793768952b81154e"}], "stats": {"total": 59, "additions": 31, "deletions": 28}, "files": [{"sha": "067191a855be5e4383d81c96ed67dcf74941fef8", "filename": "src/libstd/arc.rs", "status": "modified", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/5e35d49a5097d1a67dc1d99c367447a69c57d0bf/src%2Flibstd%2Farc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e35d49a5097d1a67dc1d99c367447a69c57d0bf/src%2Flibstd%2Farc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Farc.rs?ref=5e35d49a5097d1a67dc1d99c367447a69c57d0bf", "patch": "@@ -106,3 +106,34 @@ fn get_arc<T: send const>(c: comm::chan<proto<T>>) -> arc::arc<T> {\n     c.send(shared_get(chan(p)));\n     p.recv()\n }\n+\n+#[cfg(test)]\n+mod tests {\n+    import comm::*;\n+\n+    #[test]\n+    fn manually_share_arc() {\n+        let v = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];\n+        let arc_v = arc::arc(v);\n+\n+        let p = port();\n+        let c = chan(p);\n+\n+        task::spawn() {||\n+            let p = port();\n+            c.send(chan(p));\n+\n+            let arc_v = p.recv();\n+\n+            let v = *arc::get::<[int]>(&arc_v);\n+            assert v[3] == 4;\n+        };\n+\n+        let c = p.recv();\n+        c.send(arc::clone(&arc_v));\n+\n+        assert (*arc::get(&arc_v))[2] == 3;\n+\n+        log(info, arc_v);\n+    }\n+}"}, {"sha": "d1c40122840f4dd5f76f998b0836fcd9fd4049ee", "filename": "src/test/run-pass/share-arc.rs", "status": "removed", "additions": 0, "deletions": 28, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/aa2efc05ea9aae3016890d61793768952b81154e/src%2Ftest%2Frun-pass%2Fshare-arc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/aa2efc05ea9aae3016890d61793768952b81154e/src%2Ftest%2Frun-pass%2Fshare-arc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fshare-arc.rs?ref=aa2efc05ea9aae3016890d61793768952b81154e", "patch": "@@ -1,28 +0,0 @@\n-use std;\n-import std::arc;\n-import comm::*;\n-\n-fn main() {\n-    let v = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];\n-    let arc_v = arc::arc(v);\n-\n-    let p = port();\n-    let c = chan(p);\n-    \n-    task::spawn() {||\n-        let p = port();\n-        c.send(chan(p));\n-\n-        let arc_v = p.recv();\n-\n-        let v = *arc::get::<[int]>(&arc_v);\n-        assert v[3] == 4;\n-    };\n-\n-    let c = p.recv();\n-    c.send(arc::clone(&arc_v));\n-\n-    assert (*arc::get(&arc_v))[2] == 3;\n-\n-    log(info, arc_v);\n-}"}]}