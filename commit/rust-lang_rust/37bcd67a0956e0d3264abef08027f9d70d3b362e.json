{"sha": "37bcd67a0956e0d3264abef08027f9d70d3b362e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM3YmNkNjdhMDk1NmUwZDMyNjRhYmVmMDgwMjdmOWQ3MGQzYjM2MmU=", "commit": {"author": {"name": "Ben Blum", "email": "bblum@andrew.cmu.edu", "date": "2012-08-24T19:24:04Z"}, "committer": {"name": "Ben Blum", "email": "bblum@andrew.cmu.edu", "date": "2012-08-24T20:43:03Z"}, "message": "Enforce copyability in bind_by_value match arms (fix #3255)", "tree": {"sha": "3ead4016ef0104c02ec9f2f42df99457ea7217b3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3ead4016ef0104c02ec9f2f42df99457ea7217b3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/37bcd67a0956e0d3264abef08027f9d70d3b362e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/37bcd67a0956e0d3264abef08027f9d70d3b362e", "html_url": "https://github.com/rust-lang/rust/commit/37bcd67a0956e0d3264abef08027f9d70d3b362e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/37bcd67a0956e0d3264abef08027f9d70d3b362e/comments", "author": {"login": "bblum", "id": 1820515, "node_id": "MDQ6VXNlcjE4MjA1MTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1820515?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bblum", "html_url": "https://github.com/bblum", "followers_url": "https://api.github.com/users/bblum/followers", "following_url": "https://api.github.com/users/bblum/following{/other_user}", "gists_url": "https://api.github.com/users/bblum/gists{/gist_id}", "starred_url": "https://api.github.com/users/bblum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bblum/subscriptions", "organizations_url": "https://api.github.com/users/bblum/orgs", "repos_url": "https://api.github.com/users/bblum/repos", "events_url": "https://api.github.com/users/bblum/events{/privacy}", "received_events_url": "https://api.github.com/users/bblum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bblum", "id": 1820515, "node_id": "MDQ6VXNlcjE4MjA1MTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1820515?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bblum", "html_url": "https://github.com/bblum", "followers_url": "https://api.github.com/users/bblum/followers", "following_url": "https://api.github.com/users/bblum/following{/other_user}", "gists_url": "https://api.github.com/users/bblum/gists{/gist_id}", "starred_url": "https://api.github.com/users/bblum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bblum/subscriptions", "organizations_url": "https://api.github.com/users/bblum/orgs", "repos_url": "https://api.github.com/users/bblum/repos", "events_url": "https://api.github.com/users/bblum/events{/privacy}", "received_events_url": "https://api.github.com/users/bblum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e47d2f60607142eaf68a0c560f5c3d37fd1da13d", "url": "https://api.github.com/repos/rust-lang/rust/commits/e47d2f60607142eaf68a0c560f5c3d37fd1da13d", "html_url": "https://github.com/rust-lang/rust/commit/e47d2f60607142eaf68a0c560f5c3d37fd1da13d"}], "stats": {"total": 17, "additions": 15, "deletions": 2}, "files": [{"sha": "76c2b08a8332f87f928effffc1d19486f9b9aaa1", "filename": "src/rustc/middle/kind.rs", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/37bcd67a0956e0d3264abef08027f9d70d3b362e/src%2Frustc%2Fmiddle%2Fkind.rs", "raw_url": "https://github.com/rust-lang/rust/raw/37bcd67a0956e0d3264abef08027f9d70d3b362e/src%2Frustc%2Fmiddle%2Fkind.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fmiddle%2Fkind.rs?ref=37bcd67a0956e0d3264abef08027f9d70d3b362e", "patch": "@@ -74,6 +74,7 @@ fn check_crate(tcx: ty::ctxt,\n                last_use_map: last_use_map,\n                current_item: -1};\n     let visit = visit::mk_vt(@{\n+        visit_arm: check_arm,\n         visit_expr: check_expr,\n         visit_stmt: check_stmt,\n         visit_block: check_block,\n@@ -225,6 +226,19 @@ fn check_block(b: blk, cx: ctx, v: visit::vt<ctx>) {\n     visit::visit_block(b, cx, v);\n }\n \n+fn check_arm(a: arm, cx: ctx, v: visit::vt<ctx>) {\n+    for vec::each(a.pats) |p| {\n+        do pat_util::pat_bindings(cx.tcx.def_map, p) |mode, id, span, _path| {\n+            if mode == bind_by_value {\n+                let t = ty::node_id_to_type(cx.tcx, id);\n+                let reason = \"consider binding with `ref` or `move` instead\";\n+                check_copy(cx, id, t, span, false, some((reason,reason)));\n+            }\n+        }\n+    }\n+    visit::visit_arm(a, cx, v);\n+}\n+\n fn check_expr(e: @expr, cx: ctx, v: visit::vt<ctx>) {\n     debug!(\"kind::check_expr(%s)\", expr_to_str(e, cx.tcx.sess.intr()));\n "}, {"sha": "ad0a694165ed4f17c0c4c294a210b6b83fa8ee0e", "filename": "src/test/run-pass/pipe-presentation-examples.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/37bcd67a0956e0d3264abef08027f9d70d3b362e/src%2Ftest%2Frun-pass%2Fpipe-presentation-examples.rs", "raw_url": "https://github.com/rust-lang/rust/raw/37bcd67a0956e0d3264abef08027f9d70d3b362e/src%2Ftest%2Frun-pass%2Fpipe-presentation-examples.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fpipe-presentation-examples.rs?ref=37bcd67a0956e0d3264abef08027f9d70d3b362e", "patch": "@@ -23,8 +23,7 @@ macro_rules! select_if (\n     } => {\n         if $index == $count {\n             match move pipes::try_recv($port) {\n-              $(some($message($($(copy $x,)+)* next)) => {\n-                // FIXME (#2329) we really want move out of enum here.\n+              $(some($message($($(move $x,)+)* next)) => {\n                 let $next = unsafe { let x <- *ptr::addr_of(next); x };\n                 $e\n               })+"}]}