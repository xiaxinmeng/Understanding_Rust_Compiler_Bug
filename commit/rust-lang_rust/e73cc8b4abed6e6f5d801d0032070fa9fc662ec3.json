{"sha": "e73cc8b4abed6e6f5d801d0032070fa9fc662ec3", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU3M2NjOGI0YWJlZDZlNmY1ZDgwMWQwMDMyMDcwZmE5ZmM2NjJlYzM=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-01-22T16:16:22Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-01-22T16:16:22Z"}, "message": "Merge #7396\n\n7396: More annoying asserts r=matklad a=matklad\n\nbors r+\n\ud83e\udd16\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>", "tree": {"sha": "36ded65537cecddefb5ef91962e9770243d44f4b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/36ded65537cecddefb5ef91962e9770243d44f4b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgCvpWCRBK7hj4Ov3rIwAAdHIIAFSiabkskBbpMGd3TLpbO3S3\nm/EDKYGge/qTeji4IQ0TVxIdjqvIDpI2tXYYyUK4T3A6OTQsdH/zpJZUZaFKvhF7\nf6bjbCeWTNvK/ZVcT/Y/mcTT3dU7jclLP4cPMysOTMlH/Ox2HcZwLJaZfjAoOPkB\nwbm8oYqKhTMfhgvvA31PnWuY1G4lWQ4OHmRqPelJbWxoq+zxcqzeB8cqLLhfGRiu\nGFYcm09JpDXmrC/YEyBU4lAQq8BYTdPCfTlK3yMujdHIWwgKiDsUu1S14j1gAfRJ\np6JztVO3Io1xWwCOtmfX4s1aRCT4Tdd68ETr1Qcb+u4Lra51Se/KLTzPjPiEg2g=\n=r7Mo\n-----END PGP SIGNATURE-----\n", "payload": "tree 36ded65537cecddefb5ef91962e9770243d44f4b\nparent b16add934d3cb4817ec0f20b8697a4d9701fce4e\nparent 96197e08730a74bb8d5c724968c99d22aa0ca17a\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1611332182 +0000\ncommitter GitHub <noreply@github.com> 1611332182 +0000\n\nMerge #7396\n\n7396: More annoying asserts r=matklad a=matklad\n\nbors r+\n\ud83e\udd16\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3", "html_url": "https://github.com/rust-lang/rust/commit/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b16add934d3cb4817ec0f20b8697a4d9701fce4e", "url": "https://api.github.com/repos/rust-lang/rust/commits/b16add934d3cb4817ec0f20b8697a4d9701fce4e", "html_url": "https://github.com/rust-lang/rust/commit/b16add934d3cb4817ec0f20b8697a4d9701fce4e"}, {"sha": "96197e08730a74bb8d5c724968c99d22aa0ca17a", "url": "https://api.github.com/repos/rust-lang/rust/commits/96197e08730a74bb8d5c724968c99d22aa0ca17a", "html_url": "https://github.com/rust-lang/rust/commit/96197e08730a74bb8d5c724968c99d22aa0ca17a"}], "stats": {"total": 267, "additions": 128, "deletions": 139}, "files": [{"sha": "0880a38304e44d5154b89a078150b46a5a62006c", "filename": "crates/completion/src/completions/dot.rs", "status": "modified", "additions": 11, "deletions": 11, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Fcompletions%2Fdot.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Fcompletions%2Fdot.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2Fsrc%2Fcompletions%2Fdot.rs?ref=e73cc8b4abed6e6f5d801d0032070fa9fc662ec3", "patch": "@@ -83,7 +83,7 @@ fn foo(s: S) { s.$0 }\n \"#,\n             expect![[r#\"\n                 fd foo   u32\n-                me bar() fn bar(&self)\n+                me bar() -> ()\n             \"#]],\n         );\n     }\n@@ -99,7 +99,7 @@ impl S {\n \"#,\n             expect![[r#\"\n                 fd the_field (u32,)\n-                me foo()     fn foo(self)\n+                me foo()     -> ()\n             \"#]],\n         )\n     }\n@@ -115,7 +115,7 @@ impl A {\n \"#,\n             expect![[r#\"\n                 fd the_field (u32, i32)\n-                me foo()     fn foo(&self)\n+                me foo()     -> ()\n             \"#]],\n         )\n     }\n@@ -165,7 +165,7 @@ mod m {\n fn foo(a: A) { a.$0 }\n \"#,\n             expect![[r#\"\n-                me the_method() pub(crate) fn the_method(&self)\n+                me the_method() -> ()\n             \"#]],\n         );\n     }\n@@ -198,7 +198,7 @@ impl A<i32> {\n fn foo(a: A<u32>) { a.$0 }\n \"#,\n             expect![[r#\"\n-                me the_method() fn the_method(&self)\n+                me the_method() -> ()\n             \"#]],\n         )\n     }\n@@ -213,7 +213,7 @@ impl Trait for A {}\n fn foo(a: A) { a.$0 }\n \"#,\n             expect![[r#\"\n-                me the_method() fn the_method(&self)\n+                me the_method() -> ()\n             \"#]],\n         );\n     }\n@@ -228,7 +228,7 @@ impl<T> Trait for T {}\n fn foo(a: &A) { a.$0 }\n \",\n             expect![[r#\"\n-                me the_method() fn the_method(&self)\n+                me the_method() -> ()\n             \"#]],\n         );\n     }\n@@ -246,7 +246,7 @@ impl Trait for A {}\n fn foo(a: A) { a.$0 }\n \",\n             expect![[r#\"\n-                me the_method() fn the_method(&self)\n+                me the_method() -> ()\n             \"#]],\n         );\n     }\n@@ -300,7 +300,7 @@ impl T {\n }\n \"#,\n             expect![[r#\"\n-                me blah() pub fn blah(&self)\n+                me blah() -> ()\n             \"#]],\n         );\n     }\n@@ -409,7 +409,7 @@ fn foo() {\n }\n \"#,\n             expect![[r#\"\n-                me the_method() pub fn the_method(&self)\n+                me the_method() -> ()\n             \"#]],\n         );\n     }\n@@ -424,7 +424,7 @@ macro_rules! make_s { () => { S }; }\n fn main() { make_s!().f$0; }\n \"#,\n             expect![[r#\"\n-                me foo() fn foo(&self)\n+                me foo() -> ()\n             \"#]],\n         )\n     }"}, {"sha": "6591127b1de8270bab106498ced4f9054467933c", "filename": "crates/completion/src/completions/flyimport.rs", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Fcompletions%2Fflyimport.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Fcompletions%2Fflyimport.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2Fsrc%2Fcompletions%2Fflyimport.rs?ref=e73cc8b4abed6e6f5d801d0032070fa9fc662ec3", "patch": "@@ -366,8 +366,8 @@ fn main() {\n         check(\n             fixture,\n             expect![[r#\"\n-            fn weird_function() (dep::test_mod::TestTrait) fn weird_function()\n-        \"#]],\n+                fn weird_function() (dep::test_mod::TestTrait) -> ()\n+            \"#]],\n         );\n \n         check_edit(\n@@ -459,8 +459,8 @@ fn main() {\n         check(\n             fixture,\n             expect![[r#\"\n-            me random_method() (dep::test_mod::TestTrait) fn random_method(&self)\n-        \"#]],\n+                me random_method() (dep::test_mod::TestTrait) -> ()\n+            \"#]],\n         );\n \n         check_edit(\n@@ -629,8 +629,8 @@ fn main() {\n }\n         \"#,\n             expect![[r#\"\n-                        me random_method() (dep::test_mod::TestTrait) fn random_method(&self) DEPRECATED\n-                \"#]],\n+                me random_method() (dep::test_mod::TestTrait) -> () DEPRECATED\n+            \"#]],\n         );\n \n         check(\n@@ -660,8 +660,8 @@ fn main() {\n \"#,\n             expect![[r#\"\n                 ct SPECIAL_CONST (dep::test_mod::TestTrait) DEPRECATED\n-                fn weird_function() (dep::test_mod::TestTrait) fn weird_function() DEPRECATED\n-        \"#]],\n+                fn weird_function() (dep::test_mod::TestTrait) -> () DEPRECATED\n+            \"#]],\n         );\n     }\n }"}, {"sha": "bbeaab4965740cc5eca7b2055641f3baab372027", "filename": "crates/completion/src/completions/qualified_path.rs", "status": "modified", "additions": 27, "deletions": 27, "changes": 54, "blob_url": "https://github.com/rust-lang/rust/blob/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Fcompletions%2Fqualified_path.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Fcompletions%2Fqualified_path.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2Fsrc%2Fcompletions%2Fqualified_path.rs?ref=e73cc8b4abed6e6f5d801d0032070fa9fc662ec3", "patch": "@@ -359,8 +359,8 @@ impl S {\n fn foo() { let _ = S::$0 }\n \"#,\n             expect![[r#\"\n-                fn a()  fn a()\n-                me b(\u2026) fn b(&self)\n+                fn a()  -> ()\n+                me b(\u2026) -> ()\n                 ct C    const C: i32 = 42;\n                 ta T    type T = i32;\n             \"#]],\n@@ -387,7 +387,7 @@ mod m {\n fn foo() { let _ = S::$0 }\n \"#,\n             expect![[r#\"\n-                fn public_method() pub(crate) fn public_method()\n+                fn public_method() -> ()\n                 ct PUBLIC_CONST    pub(crate) const PUBLIC_CONST: u32 = 1;\n                 ta PublicType      pub(crate) type PublicType = u32;\n             \"#]],\n@@ -404,7 +404,7 @@ impl E { fn m() { } }\n fn foo() { let _ = E::$0 }\n         \"#,\n             expect![[r#\"\n-                fn m() fn m()\n+                fn m() -> ()\n             \"#]],\n         );\n     }\n@@ -419,7 +419,7 @@ impl U { fn m() { } }\n fn foo() { let _ = U::$0 }\n \"#,\n             expect![[r#\"\n-                fn m() fn m()\n+                fn m() -> ()\n             \"#]],\n         );\n     }\n@@ -449,7 +449,7 @@ trait Trait { fn m(); }\n fn foo() { let _ = Trait::$0 }\n \"#,\n             expect![[r#\"\n-                fn m() fn m()\n+                fn m() -> ()\n             \"#]],\n         );\n     }\n@@ -466,7 +466,7 @@ impl Trait for S {}\n fn foo() { let _ = S::$0 }\n \"#,\n             expect![[r#\"\n-                fn m() fn m()\n+                fn m() -> ()\n             \"#]],\n         );\n     }\n@@ -483,7 +483,7 @@ impl Trait for S {}\n fn foo() { let _ = <S as Trait>::$0 }\n \"#,\n             expect![[r#\"\n-                fn m() fn m()\n+                fn m() -> ()\n             \"#]],\n         );\n     }\n@@ -512,11 +512,11 @@ fn foo<T: Sub>() { T::$0 }\n                 ta SubTy        type SubTy;\n                 ta Ty           type Ty;\n                 ct C2           const C2: ();\n-                fn subfunc()    fn subfunc()\n-                me submethod(\u2026) fn submethod(&self)\n+                fn subfunc()    -> ()\n+                me submethod(\u2026) -> ()\n                 ct CONST        const CONST: u8;\n-                fn func()       fn func()\n-                me method(\u2026)    fn method(&self)\n+                fn func()       -> ()\n+                me method(\u2026)    -> ()\n             \"#]],\n         );\n     }\n@@ -552,11 +552,11 @@ impl<T> Sub for Wrap<T> {\n                 ta SubTy        type SubTy;\n                 ta Ty           type Ty;\n                 ct CONST        const CONST: u8 = 0;\n-                fn func()       fn func()\n-                me method(\u2026)    fn method(&self)\n+                fn func()       -> ()\n+                me method(\u2026)    -> ()\n                 ct C2           const C2: () = ();\n-                fn subfunc()    fn subfunc()\n-                me submethod(\u2026) fn submethod(&self)\n+                fn subfunc()    -> ()\n+                me submethod(\u2026) -> ()\n             \"#]],\n         );\n     }\n@@ -573,8 +573,8 @@ impl T { fn bar() {} }\n fn main() { T::$0; }\n \"#,\n             expect![[r#\"\n-                fn foo() fn foo()\n-                fn bar() fn bar()\n+                fn foo() -> ()\n+                fn bar() -> ()\n             \"#]],\n         );\n     }\n@@ -589,7 +589,7 @@ macro_rules! foo { () => {} }\n fn main() { let _ = crate::$0 }\n         \"#,\n             expect![[r##\"\n-                fn main()  fn main()\n+                fn main()  -> ()\n                 ma foo!(\u2026) #[macro_export] macro_rules! foo\n             \"##]],\n         );\n@@ -633,7 +633,7 @@ mod p {\n \"#,\n             expect![[r#\"\n                 ct RIGHT_CONST\n-                fn right_fn()  fn wrong_fn()\n+                fn right_fn()  -> ()\n                 st RightType\n             \"#]],\n         );\n@@ -680,8 +680,8 @@ fn main() { m!(self::f$0); }\n fn foo() {}\n \"#,\n             expect![[r#\"\n-                fn main() fn main()\n-                fn foo()  fn foo()\n+                fn main() -> ()\n+                fn foo()  -> ()\n             \"#]],\n         );\n     }\n@@ -699,7 +699,7 @@ mod m {\n \"#,\n             expect![[r#\"\n                 md z\n-                fn z() pub fn z()\n+                fn z() -> ()\n             \"#]],\n         );\n     }\n@@ -719,7 +719,7 @@ fn foo() {\n }\n \"#,\n             expect![[r#\"\n-                fn new() pub fn new() -> HashMap<K, V, RandomState>\n+                fn new() -> HashMap<K, V, RandomState>\n             \"#]],\n         );\n     }\n@@ -752,8 +752,8 @@ fn main() {\n }\n \"#,\n             expect![[r#\"\n-                fn main() fn main()\n-                fn foo(\u2026) fn foo(a: i32, b: i32)\n+                fn main() -> ()\n+                fn foo(\u2026) -> ()\n             \"#]],\n         );\n     }\n@@ -776,7 +776,7 @@ impl Foo {\n             expect![[r#\"\n                 ev Bar    ()\n                 ev Baz    ()\n-                me foo(\u2026) fn foo(self)\n+                me foo(\u2026) -> ()\n             \"#]],\n         );\n     }"}, {"sha": "b999540b84d6563b62fceec54449e0caeb07b858", "filename": "crates/completion/src/completions/trait_impl.rs", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Fcompletions%2Ftrait_impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Fcompletions%2Ftrait_impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2Fsrc%2Fcompletions%2Ftrait_impl.rs?ref=e73cc8b4abed6e6f5d801d0032070fa9fc662ec3", "patch": "@@ -679,11 +679,6 @@ impl Test for () {\n     #[test]\n     fn complete_without_name() {\n         let test = |completion: &str, hint: &str, completed: &str, next_sibling: &str| {\n-            println!(\n-                \"completion='{}', hint='{}', next_sibling='{}'\",\n-                completion, hint, next_sibling\n-            );\n-\n             check_edit(\n                 completion,\n                 &format!("}, {"sha": "5d62fab9743e0c5bcca7fc2163704caf6b48b062", "filename": "crates/completion/src/completions/unqualified_path.rs", "status": "modified", "additions": 25, "deletions": 25, "changes": 50, "blob_url": "https://github.com/rust-lang/rust/blob/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Fcompletions%2Funqualified_path.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Fcompletions%2Funqualified_path.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2Fsrc%2Fcompletions%2Funqualified_path.rs?ref=e73cc8b4abed6e6f5d801d0032070fa9fc662ec3", "patch": "@@ -167,7 +167,7 @@ fn quux(x: i32) {\n             expect![[r#\"\n                 lc y       i32\n                 lc x       i32\n-                fn quux(\u2026) fn quux(x: i32)\n+                fn quux(\u2026) -> ()\n             \"#]],\n         );\n     }\n@@ -189,7 +189,7 @@ fn quux() {\n             expect![[r#\"\n                 lc b      i32\n                 lc a\n-                fn quux() fn quux()\n+                fn quux() -> ()\n             \"#]],\n         );\n     }\n@@ -204,7 +204,7 @@ fn quux() {\n \"#,\n             expect![[r#\"\n                 lc x\n-                fn quux() fn quux()\n+                fn quux() -> ()\n             \"#]],\n         );\n     }\n@@ -235,14 +235,14 @@ fn main() {\n             r#\"fn quux<T>() { $0 }\"#,\n             expect![[r#\"\n                 tp T\n-                fn quux() fn quux<T>()\n+                fn quux() -> ()\n             \"#]],\n         );\n         check(\n             r#\"fn quux<const C: usize>() { $0 }\"#,\n             expect![[r#\"\n                 cp C\n-                fn quux() fn quux<const C: usize>()\n+                fn quux() -> ()\n             \"#]],\n         );\n     }\n@@ -253,7 +253,7 @@ fn main() {\n         check(\n             r#\"fn quux<'a>() { $0 }\"#,\n             expect![[r#\"\n-                fn quux() fn quux<'a>()\n+                fn quux() -> ()\n             \"#]],\n         );\n     }\n@@ -291,7 +291,7 @@ fn quux() { $0 }\n \"#,\n             expect![[r#\"\n                 st S\n-                fn quux() fn quux()\n+                fn quux() -> ()\n                 en E\n             \"#]],\n         );\n@@ -344,7 +344,7 @@ mod m {\n }\n \"#,\n             expect![[r#\"\n-                fn quux() fn quux()\n+                fn quux() -> ()\n                 st Bar\n             \"#]],\n         );\n@@ -359,7 +359,7 @@ fn x() -> $0\n \"#,\n             expect![[r#\"\n                 st Foo\n-                fn x() fn x()\n+                fn x() -> ()\n             \"#]],\n         );\n     }\n@@ -380,7 +380,7 @@ fn foo() {\n             expect![[r#\"\n                 lc bar   i32\n                 lc bar   i32\n-                fn foo() fn foo()\n+                fn foo() -> ()\n             \"#]],\n         );\n     }\n@@ -410,7 +410,7 @@ use prelude::*;\n mod prelude { struct Option; }\n \"#,\n             expect![[r#\"\n-                fn foo()  fn foo()\n+                fn foo()  -> ()\n                 md std\n                 st Option\n             \"#]],\n@@ -440,7 +440,7 @@ mod macros {\n }\n \"#,\n             expect![[r##\"\n-                fn f()        fn f()\n+                fn f()        -> ()\n                 ma concat!(\u2026) #[macro_export] macro_rules! concat\n                 md std\n             \"##]],\n@@ -467,7 +467,7 @@ use prelude::*;\n mod prelude { struct String; }\n \"#,\n             expect![[r#\"\n-                fn foo()  fn foo()\n+                fn foo()  -> ()\n                 md std\n                 md core\n                 st String\n@@ -498,7 +498,7 @@ fn main() { let v = $0 }\n             expect![[r##\"\n                 md m1\n                 ma baz!(\u2026) #[macro_export] macro_rules! baz\n-                fn main()  fn main()\n+                fn main()  -> ()\n                 md m2\n                 ma bar!(\u2026) macro_rules! bar\n                 ma foo!(\u2026) macro_rules! foo\n@@ -514,7 +514,7 @@ macro_rules! foo { () => {} }\n fn foo() { $0 }\n \"#,\n             expect![[r#\"\n-                fn foo()   fn foo()\n+                fn foo()   -> ()\n                 ma foo!(\u2026) macro_rules! foo\n             \"#]],\n         );\n@@ -528,7 +528,7 @@ macro_rules! foo { () => {} }\n fn main() { let x: $0 }\n \"#,\n             expect![[r#\"\n-                fn main()  fn main()\n+                fn main()  -> ()\n                 ma foo!(\u2026) macro_rules! foo\n             \"#]],\n         );\n@@ -542,7 +542,7 @@ macro_rules! foo { () => {} }\n fn main() { $0 }\n \"#,\n             expect![[r#\"\n-                fn main()  fn main()\n+                fn main()  -> ()\n                 ma foo!(\u2026) macro_rules! foo\n             \"#]],\n         );\n@@ -558,8 +558,8 @@ fn main() {\n }\n \"#,\n             expect![[r#\"\n-                fn frobnicate() fn frobnicate()\n-                fn main()       fn main()\n+                fn frobnicate() -> ()\n+                fn main()       -> ()\n             \"#]],\n         );\n     }\n@@ -577,7 +577,7 @@ fn quux(x: i32) {\n             expect![[r#\"\n                 lc y       i32\n                 lc x       i32\n-                fn quux(\u2026) fn quux(x: i32)\n+                fn quux(\u2026) -> ()\n                 ma m!(\u2026)   macro_rules! m\n             \"#]],\n         );\n@@ -596,7 +596,7 @@ fn quux(x: i32) {\n             expect![[r#\"\n                 lc y       i32\n                 lc x       i32\n-                fn quux(\u2026) fn quux(x: i32)\n+                fn quux(\u2026) -> ()\n                 ma m!(\u2026)   macro_rules! m\n             \"#]],\n         );\n@@ -615,7 +615,7 @@ fn quux(x: i32) {\n             expect![[r#\"\n                 lc y       i32\n                 lc x       i32\n-                fn quux(\u2026) fn quux(x: i32)\n+                fn quux(\u2026) -> ()\n                 ma m!(\u2026)   macro_rules! m\n             \"#]],\n         );\n@@ -630,7 +630,7 @@ use spam::Quux;\n fn main() { $0 }\n \"#,\n             expect![[r#\"\n-                fn main() fn main()\n+                fn main() -> ()\n                 ?? Quux\n             \"#]],\n         );\n@@ -708,7 +708,7 @@ fn main() { let foo: Foo = Q$0 }\n                 ev Foo::Baz  ()\n                 ev Foo::Quux ()\n                 en Foo\n-                fn main()    fn main()\n+                fn main()    -> ()\n             \"#]],\n         )\n     }\n@@ -723,7 +723,7 @@ fn f() -> m::E { V$0 }\n             expect![[r#\"\n                 ev m::E::V ()\n                 md m\n-                fn f()     fn f() -> m::E\n+                fn f()     -> E\n             \"#]],\n         )\n     }"}, {"sha": "eeb952ec3c54e2b644227bc030d491fa78e635f4", "filename": "crates/completion/src/item.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Fitem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Fitem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2Fsrc%2Fitem.rs?ref=e73cc8b4abed6e6f5d801d0032070fa9fc662ec3", "patch": "@@ -398,14 +398,13 @@ impl Builder {\n         self.insert_text_format = InsertTextFormat::Snippet;\n         self.text_edit(edit)\n     }\n-    #[allow(unused)]\n     pub(crate) fn detail(self, detail: impl Into<String>) -> Builder {\n         self.set_detail(Some(detail))\n     }\n     pub(crate) fn set_detail(mut self, detail: Option<impl Into<String>>) -> Builder {\n         self.detail = detail.map(Into::into);\n         if let Some(detail) = &self.detail {\n-            if assert_never!(detail.contains('\\n'), \"multiline detail: {}\", detail) {\n+            if assert_never!(detail.contains('\\n'), \"multiline detail:\\n{}\", detail) {\n                 self.detail = Some(detail.splitn(2, '\\n').next().unwrap().to_string());\n             }\n         }"}, {"sha": "db8bfbbc3ac52ebd01d2691ff015a7c3b1acfaa9", "filename": "crates/completion/src/lib.rs", "status": "modified", "additions": 40, "deletions": 51, "changes": 91, "blob_url": "https://github.com/rust-lang/rust/blob/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2Fsrc%2Flib.rs?ref=e73cc8b4abed6e6f5d801d0032070fa9fc662ec3", "patch": "@@ -209,78 +209,67 @@ mod tests {\n     fn test_completion_detail_from_macro_generated_struct_fn_doc_attr() {\n         check_detail_and_documentation(\n             r#\"\n-            //- /lib.rs\n-            macro_rules! bar {\n-                () => {\n-                    struct Bar;\n-                    impl Bar {\n-                        #[doc = \"Do the foo\"]\n-                        fn foo(&self) {}\n-                    }\n-                }\n-            }\n+macro_rules! bar {\n+    () => {\n+        struct Bar;\n+        impl Bar {\n+            #[doc = \"Do the foo\"]\n+            fn foo(&self) {}\n+        }\n+    }\n+}\n \n-            bar!();\n+bar!();\n \n-            fn foo() {\n-                let bar = Bar;\n-                bar.fo$0;\n-            }\n-            \"#,\n-            DetailAndDocumentation { detail: \"fn foo(&self)\", documentation: \"Do the foo\" },\n+fn foo() {\n+    let bar = Bar;\n+    bar.fo$0;\n+}\n+\"#,\n+            DetailAndDocumentation { detail: \"-> ()\", documentation: \"Do the foo\" },\n         );\n     }\n \n     #[test]\n     fn test_completion_detail_from_macro_generated_struct_fn_doc_comment() {\n         check_detail_and_documentation(\n             r#\"\n-            //- /lib.rs\n-            macro_rules! bar {\n-                () => {\n-                    struct Bar;\n-                    impl Bar {\n-                        /// Do the foo\n-                        fn foo(&self) {}\n-                    }\n-                }\n-            }\n+macro_rules! bar {\n+    () => {\n+        struct Bar;\n+        impl Bar {\n+            /// Do the foo\n+            fn foo(&self) {}\n+        }\n+    }\n+}\n \n-            bar!();\n+bar!();\n \n-            fn foo() {\n-                let bar = Bar;\n-                bar.fo$0;\n-            }\n-            \"#,\n-            DetailAndDocumentation { detail: \"fn foo(&self)\", documentation: \" Do the foo\" },\n+fn foo() {\n+    let bar = Bar;\n+    bar.fo$0;\n+}\n+\"#,\n+            DetailAndDocumentation { detail: \"-> ()\", documentation: \" Do the foo\" },\n         );\n     }\n \n     #[test]\n     fn test_no_completions_required() {\n         // There must be no hint for 'in' keyword.\n-        check_no_completion(\n-            r#\"\n-            fn foo() {\n-                for i i$0\n-            }\n-            \"#,\n-        );\n+        check_no_completion(r#\"fn foo() { for i i$0 }\"#);\n         // After 'in' keyword hints may be spawned.\n         check_detail_and_documentation(\n             r#\"\n-            /// Do the foo\n-            fn foo() -> &'static str { \"foo\" }\n+/// Do the foo\n+fn foo() -> &'static str { \"foo\" }\n \n-            fn bar() {\n-                for c in fo$0\n-            }\n-            \"#,\n-            DetailAndDocumentation {\n-                detail: \"fn foo() -> &'static str\",\n-                documentation: \"Do the foo\",\n-            },\n+fn bar() {\n+    for c in fo$0\n+}\n+\"#,\n+            DetailAndDocumentation { detail: \"-> &str\", documentation: \"Do the foo\" },\n         );\n     }\n }"}, {"sha": "6eb20df2bf474b0be45bb253ed517ae1de92510a", "filename": "crates/completion/src/render.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2Fsrc%2Frender.rs?ref=e73cc8b4abed6e6f5d801d0032070fa9fc662ec3", "patch": "@@ -523,7 +523,7 @@ fn main() { let _: m::Spam = S$0 }\n                             Function,\n                         ),\n                         lookup: \"main\",\n-                        detail: \"fn main()\",\n+                        detail: \"-> ()\",\n                     },\n                 ]\n             \"#]],\n@@ -552,7 +552,7 @@ fn main() { som$0 }\n                             Function,\n                         ),\n                         lookup: \"main\",\n-                        detail: \"fn main()\",\n+                        detail: \"-> ()\",\n                     },\n                     CompletionItem {\n                         label: \"something_deprecated()\",\n@@ -563,7 +563,7 @@ fn main() { som$0 }\n                             Function,\n                         ),\n                         lookup: \"something_deprecated\",\n-                        detail: \"fn something_deprecated()\",\n+                        detail: \"-> ()\",\n                         deprecated: true,\n                     },\n                     CompletionItem {\n@@ -575,7 +575,7 @@ fn main() { som$0 }\n                             Function,\n                         ),\n                         lookup: \"something_else_deprecated\",\n-                        detail: \"fn something_else_deprecated()\",\n+                        detail: \"-> ()\",\n                         deprecated: true,\n                     },\n                 ]\n@@ -626,7 +626,7 @@ impl S {\n                         insert: \"bar()$0\",\n                         kind: Method,\n                         lookup: \"bar\",\n-                        detail: \"fn bar(self)\",\n+                        detail: \"-> ()\",\n                         documentation: Documentation(\n                             \"Method docs\",\n                         ),\n@@ -726,7 +726,7 @@ fn foo(s: S) { s.$0 }\n                         insert: \"the_method()$0\",\n                         kind: Method,\n                         lookup: \"the_method\",\n-                        detail: \"fn the_method(&self)\",\n+                        detail: \"-> ()\",\n                     },\n                 ]\n             \"#]],"}, {"sha": "e46e21d243fb07671f4f153a0963e2dc8e62ef16", "filename": "crates/completion/src/render/function.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Frender%2Ffunction.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Fcompletion%2Fsrc%2Frender%2Ffunction.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2Fsrc%2Frender%2Ffunction.rs?ref=e73cc8b4abed6e6f5d801d0032070fa9fc662ec3", "patch": "@@ -1,8 +1,8 @@\n //! Renderer for function calls.\n \n-use hir::{HasSource, Type};\n+use hir::{HasSource, HirDisplay, Type};\n use ide_db::SymbolKind;\n-use syntax::{ast::Fn, display::function_declaration};\n+use syntax::ast::Fn;\n use test_utils::mark;\n \n use crate::{\n@@ -55,7 +55,8 @@ impl<'a> FunctionRender<'a> {\n     }\n \n     fn detail(&self) -> String {\n-        function_declaration(&self.ast_node)\n+        let ty = self.func.ret_type(self.ctx.db());\n+        format!(\"-> {}\", ty.display(self.ctx.db()))\n     }\n \n     fn add_arg(&self, arg: &str, ty: &Type) -> String {"}, {"sha": "1d6e5478bc4d38969dd64cb20edc45747d1556e6", "filename": "crates/rust-analyzer/src/bin/main.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Frust-analyzer%2Fsrc%2Fbin%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e73cc8b4abed6e6f5d801d0032070fa9fc662ec3/crates%2Frust-analyzer%2Fsrc%2Fbin%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fbin%2Fmain.rs?ref=e73cc8b4abed6e6f5d801d0032070fa9fc662ec3", "patch": "@@ -76,7 +76,12 @@ fn setup_logging(log_file: Option<PathBuf>) -> Result<()> {\n     profile::init();\n \n     if !cfg!(debug_assertions) {\n-        stdx::set_assert_hook(|loc, args| log::error!(\"assertion failed at {}: {}\", loc, args));\n+        stdx::set_assert_hook(|loc, args| {\n+            if env::var(\"RA_PROFILE\").is_ok() {\n+                panic!(\"assertion failed at {}: {}\", loc, args)\n+            }\n+            log::error!(\"assertion failed at {}: {}\", loc, args)\n+        });\n     }\n \n     Ok(())"}]}