{"sha": "636a849bf20105ba4c316c2cc44cca391cb11d84", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYzNmE4NDliZjIwMTA1YmE0YzMxNmMyY2M0NGNjYTM5MWNiMTFkODQ=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-06-19T19:36:24Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-06-19T19:36:59Z"}, "message": "rustc: Add a temporary option to not link to the runtime", "tree": {"sha": "c857ee3242c04998fa6526cec7ca6b8e5c0edc6b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c857ee3242c04998fa6526cec7ca6b8e5c0edc6b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/636a849bf20105ba4c316c2cc44cca391cb11d84", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/636a849bf20105ba4c316c2cc44cca391cb11d84", "html_url": "https://github.com/rust-lang/rust/commit/636a849bf20105ba4c316c2cc44cca391cb11d84", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/636a849bf20105ba4c316c2cc44cca391cb11d84/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ec0fbf526e76716379b86d53c1588e8f02ae986d", "url": "https://api.github.com/repos/rust-lang/rust/commits/ec0fbf526e76716379b86d53c1588e8f02ae986d", "html_url": "https://github.com/rust-lang/rust/commit/ec0fbf526e76716379b86d53c1588e8f02ae986d"}], "stats": {"total": 14, "additions": 10, "deletions": 4}, "files": [{"sha": "facb0bcda31b27e0b38c5f6f20e06f59abaf67eb", "filename": "src/rustc/back/link.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/636a849bf20105ba4c316c2cc44cca391cb11d84/src%2Frustc%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/636a849bf20105ba4c316c2cc44cca391cb11d84/src%2Frustc%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fback%2Flink.rs?ref=636a849bf20105ba4c316c2cc44cca391cb11d84", "patch": "@@ -631,8 +631,10 @@ fn link_binary(sess: session,\n         }\n     }\n \n-    // Always want the runtime linked in\n-    cc_args += [\"-lrustrt\"];\n+    if !sess.debugging_opt(session::no_rt) {\n+        // Always want the runtime linked in\n+        cc_args += [\"-lrustrt\"];\n+    }\n \n     // On linux librt and libdl are an indirect dependencies via rustrt,\n     // and binutils 2.22+ won't add them automatically"}, {"sha": "def4c7d9a83b5ae9d581340058ce2c034ff94791", "filename": "src/rustc/driver/session.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/636a849bf20105ba4c316c2cc44cca391cb11d84/src%2Frustc%2Fdriver%2Fsession.rs", "raw_url": "https://github.com/rust-lang/rust/raw/636a849bf20105ba4c316c2cc44cca391cb11d84/src%2Frustc%2Fdriver%2Fsession.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fdriver%2Fsession.rs?ref=636a849bf20105ba4c316c2cc44cca391cb11d84", "patch": "@@ -32,6 +32,9 @@ const stats: uint = 16u;\n const no_asm_comments: uint = 32u;\n const no_verify: uint = 64u;\n const trace: uint = 128u;\n+// FIXME: This exists to transition to a Rust crate runtime\n+// It should be removed\n+const no_rt: uint = 256u;\n \n fn debugging_opts_map() -> [(str, str, uint)] {\n     [(\"ppregions\", \"prettyprint regions with \\\n@@ -43,7 +46,9 @@ fn debugging_opts_map() -> [(str, str, uint)] {\n      (\"stats\", \"gather trans statistics\", stats),\n      (\"no-asm-comments\", \"omit comments when using -S\", no_asm_comments),\n      (\"no-verify\", \"skip LLVM verification\", no_verify),\n-     (\"trace\", \"emit trace logs\", trace)]\n+     (\"trace\", \"emit trace logs\", trace),\n+     (\"no-rt\", \"do not link to the runtime\", no_rt)\n+    ]\n }\n \n type options =\n@@ -64,7 +69,6 @@ type options =\n      test: bool,\n      parse_only: bool,\n      no_trans: bool,\n-\n      debugging_opts: uint,\n     };\n "}]}