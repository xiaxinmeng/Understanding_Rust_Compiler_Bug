{"sha": "c7ab80f743b3e2d34bb702be787507418cc794a8", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM3YWI4MGY3NDNiM2UyZDM0YmI3MDJiZTc4NzUwNzQxOGNjNzk0YTg=", "commit": {"author": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2010-10-14T22:02:35Z"}, "committer": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2010-10-14T22:08:19Z"}, "message": "Typecheck tags in \"alt\" patterns", "tree": {"sha": "cac4fb19306b207c7fe5397ccc3b419ff53277c7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cac4fb19306b207c7fe5397ccc3b419ff53277c7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c7ab80f743b3e2d34bb702be787507418cc794a8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c7ab80f743b3e2d34bb702be787507418cc794a8", "html_url": "https://github.com/rust-lang/rust/commit/c7ab80f743b3e2d34bb702be787507418cc794a8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c7ab80f743b3e2d34bb702be787507418cc794a8/comments", "author": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f234750d802fde35f6607fd1599f805e490f3dd2", "url": "https://api.github.com/repos/rust-lang/rust/commits/f234750d802fde35f6607fd1599f805e490f3dd2", "html_url": "https://github.com/rust-lang/rust/commit/f234750d802fde35f6607fd1599f805e490f3dd2"}], "stats": {"total": 26, "additions": 26, "deletions": 0}, "files": [{"sha": "648618e70ba6aa7cd8f2f7e9cbdf9b69d00cbc26", "filename": "src/boot/me/type.ml", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c7ab80f743b3e2d34bb702be787507418cc794a8/src%2Fboot%2Fme%2Ftype.ml", "raw_url": "https://github.com/rust-lang/rust/raw/c7ab80f743b3e2d34bb702be787507418cc794a8/src%2Fboot%2Fme%2Ftype.ml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fboot%2Fme%2Ftype.ml?ref=c7ab80f743b3e2d34bb702be787507418cc794a8", "patch": "@@ -903,8 +903,10 @@ let check_stmt (cx:Semant.ctxt) : (fn_ctx -> Ast.stmt -> unit) =\n           let arg_tys =\n             match constr_ty with\n                 Ast.TY_fn (ty_sig, _) ->\n+                  demand expected (get_slot_ty ty_sig.Ast.sig_output_slot);\n                   Array.map get_slot_ty ty_sig.Ast.sig_input_slots\n               | Ast.TY_tag _ ->\n+                  demand expected constr_ty;\n                   [||]\n               | _ -> type_error \"constructor function\" constr_ty\n           in"}, {"sha": "f55f67e9e1849425e7ec249a84bc0dc024d6d5ce", "filename": "src/test/compile-fail/alt-tag-nullary.rs", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/c7ab80f743b3e2d34bb702be787507418cc794a8/src%2Ftest%2Fcompile-fail%2Falt-tag-nullary.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c7ab80f743b3e2d34bb702be787507418cc794a8/src%2Ftest%2Fcompile-fail%2Falt-tag-nullary.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Falt-tag-nullary.rs?ref=c7ab80f743b3e2d34bb702be787507418cc794a8", "patch": "@@ -0,0 +1,12 @@\n+// error-pattern: mismatched types\n+\n+tag a { A; }\n+tag b { B; }\n+\n+fn main() {\n+    let a x = A;\n+    alt (x) {\n+        case (B) {}\n+    }\n+}\n+"}, {"sha": "f2004896a2d704a1b2aec72a2728b2b831ed0695", "filename": "src/test/compile-fail/alt-tag-unary.rs", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/c7ab80f743b3e2d34bb702be787507418cc794a8/src%2Ftest%2Fcompile-fail%2Falt-tag-unary.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c7ab80f743b3e2d34bb702be787507418cc794a8/src%2Ftest%2Fcompile-fail%2Falt-tag-unary.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Falt-tag-unary.rs?ref=c7ab80f743b3e2d34bb702be787507418cc794a8", "patch": "@@ -0,0 +1,12 @@\n+// error-pattern: mismatched types\n+\n+tag a { A(int); }\n+tag b { B(int); }\n+\n+fn main() {\n+    let a x = A(0);\n+    alt (x) {\n+        case (B(?y)) {}\n+    }\n+}\n+"}]}