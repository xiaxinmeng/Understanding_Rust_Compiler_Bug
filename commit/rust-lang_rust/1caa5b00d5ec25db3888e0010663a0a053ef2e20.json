{"sha": "1caa5b00d5ec25db3888e0010663a0a053ef2e20", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFjYWE1YjAwZDVlYzI1ZGIzODg4ZTAwMTA2NjNhMGEwNTNlZjJlMjA=", "commit": {"author": {"name": "Yuki Okushi", "email": "huyuumi.dev@gmail.com", "date": "2020-12-30T13:49:16Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-12-30T13:49:16Z"}, "message": "Rollup merge of #80185 - JohnTitor:issue-80134, r=davidtwco\n\nFix ICE when pointing at multi bytes character\n\nFixes #80134\n\nSeems this ICE was introduced by #73953, checking width of span to avoid ICE.", "tree": {"sha": "0786fcfd161fac2bc6d8630b57d8705bc581d198", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0786fcfd161fac2bc6d8630b57d8705bc581d198"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1caa5b00d5ec25db3888e0010663a0a053ef2e20", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJf7IVcCRBK7hj4Ov3rIwAAdHIIAIX8rY2yC1yrUJ0dq8g5ukcO\nfVTyMIsN6M9jsuW9dpYxoticviA0ryweoMkr5MFMlqvqBMF1sXWcxSitlgNGyVTm\nraou/kVVeWWlcd7Q47iAoXLk8Ytw9aR++jcXbXFFBEd/yaWlxHzQJX87oPj4s3u5\n3yxOw9aXZGdRor2G0bvwjLJ8S4WWcY/Tht5cPz+mupGo20DOb6hhgQpx8Fs7d3w7\nt9jjBWVgFlOWDsLVVv02wo3KIJL9pik7n+IzKfE4qFfi3wgSEb8PpPlEA4jhNYvo\nDzrGJ28gd1pl6qMMQqrdLNIKhQtpo+62NXqmOkNlu7Agf1E3sfq6CRU42jCHIds=\n=b/gn\n-----END PGP SIGNATURE-----\n", "payload": "tree 0786fcfd161fac2bc6d8630b57d8705bc581d198\nparent d107a87d34c1fc3521aaab7a2576ffbaf59cb2cb\nparent 4ae99cc843b923d05e5c0993f732c5e0a9097852\nauthor Yuki Okushi <huyuumi.dev@gmail.com> 1609336156 +0900\ncommitter GitHub <noreply@github.com> 1609336156 +0900\n\nRollup merge of #80185 - JohnTitor:issue-80134, r=davidtwco\n\nFix ICE when pointing at multi bytes character\n\nFixes #80134\n\nSeems this ICE was introduced by #73953, checking width of span to avoid ICE.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1caa5b00d5ec25db3888e0010663a0a053ef2e20", "html_url": "https://github.com/rust-lang/rust/commit/1caa5b00d5ec25db3888e0010663a0a053ef2e20", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1caa5b00d5ec25db3888e0010663a0a053ef2e20/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d107a87d34c1fc3521aaab7a2576ffbaf59cb2cb", "url": "https://api.github.com/repos/rust-lang/rust/commits/d107a87d34c1fc3521aaab7a2576ffbaf59cb2cb", "html_url": "https://github.com/rust-lang/rust/commit/d107a87d34c1fc3521aaab7a2576ffbaf59cb2cb"}, {"sha": "4ae99cc843b923d05e5c0993f732c5e0a9097852", "url": "https://api.github.com/repos/rust-lang/rust/commits/4ae99cc843b923d05e5c0993f732c5e0a9097852", "html_url": "https://github.com/rust-lang/rust/commit/4ae99cc843b923d05e5c0993f732c5e0a9097852"}], "stats": {"total": 87, "additions": 66, "deletions": 21}, "files": [{"sha": "1062000fede9b264b7dbe9a1c6f1aa2d9c1a1ff9", "filename": "compiler/rustc_parse/src/parser/mod.rs", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/1caa5b00d5ec25db3888e0010663a0a053ef2e20/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1caa5b00d5ec25db3888e0010663a0a053ef2e20/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs?ref=1caa5b00d5ec25db3888e0010663a0a053ef2e20", "patch": "@@ -721,13 +721,9 @@ impl<'a> Parser<'a> {\n                                 Ok(t) => {\n                                     // Parsed successfully, therefore most probably the code only\n                                     // misses a separator.\n-                                    let mut exp_span = self.sess.source_map().next_point(sp);\n-                                    if self.sess.source_map().is_multiline(exp_span) {\n-                                        exp_span = sp;\n-                                    }\n                                     expect_err\n                                         .span_suggestion_short(\n-                                            exp_span,\n+                                            sp,\n                                             &format!(\"missing `{}`\", token_str),\n                                             token_str,\n                                             Applicability::MaybeIncorrect,"}, {"sha": "f3ae3aba9b9e68149f7eb9a5fbb764cbc0591763", "filename": "src/test/ui/parser/multibyte-char-use-seperator-issue-80134.rs", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/1caa5b00d5ec25db3888e0010663a0a053ef2e20/src%2Ftest%2Fui%2Fparser%2Fmultibyte-char-use-seperator-issue-80134.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1caa5b00d5ec25db3888e0010663a0a053ef2e20/src%2Ftest%2Fui%2Fparser%2Fmultibyte-char-use-seperator-issue-80134.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fmultibyte-char-use-seperator-issue-80134.rs?ref=1caa5b00d5ec25db3888e0010663a0a053ef2e20", "patch": "@@ -0,0 +1,12 @@\n+// Regression test for #80134.\n+\n+fn main() {\n+    (()\u00e9);\n+    //~^ ERROR: expected one of `)`, `,`, `.`, `?`, or an operator\n+    //~| ERROR: cannot find value `\u00e9` in this scope\n+    //~| ERROR: non-ascii idents are not fully supported\n+    (()\u6c37);\n+    //~^ ERROR: expected one of `)`, `,`, `.`, `?`, or an operator\n+    //~| ERROR: cannot find value `\u6c37` in this scope\n+    //~| ERROR: non-ascii idents are not fully supported\n+}"}, {"sha": "892cc92b1bdeb9437d248ee3703f680b65e8d180", "filename": "src/test/ui/parser/multibyte-char-use-seperator-issue-80134.stderr", "status": "added", "additions": 52, "deletions": 0, "changes": 52, "blob_url": "https://github.com/rust-lang/rust/blob/1caa5b00d5ec25db3888e0010663a0a053ef2e20/src%2Ftest%2Fui%2Fparser%2Fmultibyte-char-use-seperator-issue-80134.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1caa5b00d5ec25db3888e0010663a0a053ef2e20/src%2Ftest%2Fui%2Fparser%2Fmultibyte-char-use-seperator-issue-80134.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fmultibyte-char-use-seperator-issue-80134.stderr?ref=1caa5b00d5ec25db3888e0010663a0a053ef2e20", "patch": "@@ -0,0 +1,52 @@\n+error: expected one of `)`, `,`, `.`, `?`, or an operator, found `\u00e9`\n+  --> $DIR/multibyte-char-use-seperator-issue-80134.rs:4:8\n+   |\n+LL |     (()\u00e9);\n+   |        ^\n+   |        |\n+   |        expected one of `)`, `,`, `.`, `?`, or an operator\n+   |        help: missing `,`\n+\n+error: expected one of `)`, `,`, `.`, `?`, or an operator, found `\u6c37`\n+  --> $DIR/multibyte-char-use-seperator-issue-80134.rs:8:8\n+   |\n+LL |     (()\u6c37);\n+   |        -^\n+   |        |\n+   |        expected one of `)`, `,`, `.`, `?`, or an operator\n+   |        help: missing `,`\n+\n+error[E0425]: cannot find value `\u00e9` in this scope\n+  --> $DIR/multibyte-char-use-seperator-issue-80134.rs:4:8\n+   |\n+LL |     (()\u00e9);\n+   |        ^ not found in this scope\n+\n+error[E0425]: cannot find value `\u6c37` in this scope\n+  --> $DIR/multibyte-char-use-seperator-issue-80134.rs:8:8\n+   |\n+LL |     (()\u6c37);\n+   |        ^^ not found in this scope\n+\n+error[E0658]: non-ascii idents are not fully supported\n+  --> $DIR/multibyte-char-use-seperator-issue-80134.rs:4:8\n+   |\n+LL |     (()\u00e9);\n+   |        ^\n+   |\n+   = note: see issue #55467 <https://github.com/rust-lang/rust/issues/55467> for more information\n+   = help: add `#![feature(non_ascii_idents)]` to the crate attributes to enable\n+\n+error[E0658]: non-ascii idents are not fully supported\n+  --> $DIR/multibyte-char-use-seperator-issue-80134.rs:8:8\n+   |\n+LL |     (()\u6c37);\n+   |        ^^\n+   |\n+   = note: see issue #55467 <https://github.com/rust-lang/rust/issues/55467> for more information\n+   = help: add `#![feature(non_ascii_idents)]` to the crate attributes to enable\n+\n+error: aborting due to 6 previous errors\n+\n+Some errors have detailed explanations: E0425, E0658.\n+For more information about an error, try `rustc --explain E0425`."}, {"sha": "addba76ae3b51fd214b0e3a4a040340b8b0b8c62", "filename": "src/test/ui/similar-tokens.fixed", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/d107a87d34c1fc3521aaab7a2576ffbaf59cb2cb/src%2Ftest%2Fui%2Fsimilar-tokens.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/d107a87d34c1fc3521aaab7a2576ffbaf59cb2cb/src%2Ftest%2Fui%2Fsimilar-tokens.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsimilar-tokens.fixed?ref=d107a87d34c1fc3521aaab7a2576ffbaf59cb2cb", "patch": "@@ -1,13 +0,0 @@\n-// run-rustfix\n-\n-#![allow(unused_imports)]\n-\n-pub mod x {\n-    pub struct A;\n-    pub struct B;\n-}\n-\n-// `.` is similar to `,` so list parsing should continue to closing `}`\n-use x::{A, B}; //~ ERROR expected one of `,`, `::`, `as`, or `}`, found `.`\n-\n-fn main() {}"}, {"sha": "e3024c61ad2bd800da819675c749d809a5df53df", "filename": "src/test/ui/similar-tokens.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1caa5b00d5ec25db3888e0010663a0a053ef2e20/src%2Ftest%2Fui%2Fsimilar-tokens.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1caa5b00d5ec25db3888e0010663a0a053ef2e20/src%2Ftest%2Fui%2Fsimilar-tokens.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsimilar-tokens.rs?ref=1caa5b00d5ec25db3888e0010663a0a053ef2e20", "patch": "@@ -1,5 +1,3 @@\n-// run-rustfix\n-\n #![allow(unused_imports)]\n \n pub mod x {"}, {"sha": "90acfc052ddd45b90ed8786619ac3009dfd6d7fb", "filename": "src/test/ui/similar-tokens.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1caa5b00d5ec25db3888e0010663a0a053ef2e20/src%2Ftest%2Fui%2Fsimilar-tokens.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1caa5b00d5ec25db3888e0010663a0a053ef2e20/src%2Ftest%2Fui%2Fsimilar-tokens.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsimilar-tokens.stderr?ref=1caa5b00d5ec25db3888e0010663a0a053ef2e20", "patch": "@@ -1,5 +1,5 @@\n error: expected one of `,`, `::`, `as`, or `}`, found `.`\n-  --> $DIR/similar-tokens.rs:11:10\n+  --> $DIR/similar-tokens.rs:9:10\n    |\n LL | use x::{A. B};\n    |          ^"}]}