{"sha": "36fb64639401d815f005dba1d437dd1a31c3a5e8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM2ZmI2NDYzOTQwMWQ4MTVmMDA1ZGJhMWQ0MzdkZDFhMzFjM2E1ZTg=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-07-13T10:05:15Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-07-13T10:05:15Z"}, "message": "Auto merge of #4229 - euclio:lint-doc-generation-fix, r=flip1995\n\ndon't strip blank lines in lint documentation\n\nchangelog: don't strip blank lines in lint documentation\n\nFixes #4116.\n\nThis PR also switches the docs headings to deterministically display in the order that they are declared in the source, with \"Configuration\" always appearing last. It doesn't seem like there was a defined order before.", "tree": {"sha": "92c43d2d0c7002d331bb69117c8150a928f228cd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/92c43d2d0c7002d331bb69117c8150a928f228cd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/36fb64639401d815f005dba1d437dd1a31c3a5e8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/36fb64639401d815f005dba1d437dd1a31c3a5e8", "html_url": "https://github.com/rust-lang/rust/commit/36fb64639401d815f005dba1d437dd1a31c3a5e8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/36fb64639401d815f005dba1d437dd1a31c3a5e8/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3267e054daaa32f350b71e85809e4660bf2845c9", "url": "https://api.github.com/repos/rust-lang/rust/commits/3267e054daaa32f350b71e85809e4660bf2845c9", "html_url": "https://github.com/rust-lang/rust/commit/3267e054daaa32f350b71e85809e4660bf2845c9"}, {"sha": "4ce100beb22800c865d831aebe949f244e860917", "url": "https://api.github.com/repos/rust-lang/rust/commits/4ce100beb22800c865d831aebe949f244e860917", "html_url": "https://github.com/rust-lang/rust/commit/4ce100beb22800c865d831aebe949f244e860917"}], "stats": {"total": 21, "additions": 9, "deletions": 12}, "files": [{"sha": "06b867df396103cacf65d2e376d008b8e643424b", "filename": "util/export.py", "status": "modified", "additions": 9, "deletions": 12, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/36fb64639401d815f005dba1d437dd1a31c3a5e8/util%2Fexport.py", "raw_url": "https://github.com/rust-lang/rust/raw/36fb64639401d815f005dba1d437dd1a31c3a5e8/util%2Fexport.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/util%2Fexport.py?ref=36fb64639401d815f005dba1d437dd1a31c3a5e8", "patch": "@@ -2,6 +2,7 @@\n \n # Build the gh-pages\n \n+from collections import OrderedDict\n import re\n import sys\n import json\n@@ -21,33 +22,29 @@ def parse_lint_def(lint):\n     lint_dict['id'] = lint.name\n     lint_dict['group'] = lint.group\n     lint_dict['level'] = lint.level\n-    lint_dict['docs'] = {}\n+    lint_dict['docs'] = OrderedDict()\n \n     last_section = None\n \n     for line in lint.doc:\n-        if len(line.strip()) == 0 and not last_section.startswith(\"Example\"):\n-            continue\n-\n         match = re.match(lint_subheadline, line)\n         if match:\n             last_section = match.groups()[0]\n-        if match:\n             text = match.groups()[1]\n         else:\n             text = line\n \n         if not last_section:\n-            log.warn(\"Skipping comment line as it was not preceded by a heading\")\n+            log.warning(\"Skipping comment line as it was not preceded by a heading\")\n             log.debug(\"in lint `%s`, line `%s`\", lint.name, line)\n \n-        fragment = lint_dict['docs'].get(last_section, \"\")\n-        if text == \"\\n\":\n-            line = fragment + text\n-        else:\n-            line = (fragment + \"\\n\" + text).strip()\n+        if last_section not in lint_dict['docs']:\n+            lint_dict['docs'][last_section] = \"\"\n+\n+        lint_dict['docs'][last_section] += text + \"\\n\"\n \n-        lint_dict['docs'][last_section] = line\n+    for section in lint_dict['docs']:\n+        lint_dict['docs'][section] = lint_dict['docs'][section].strip()\n \n     return lint_dict\n "}]}