{"sha": "8a7b1c38940e8c0a013dacf52db6a7884f156d3e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhhN2IxYzM4OTQwZThjMGEwMTNkYWNmNTJkYjZhNzg4NGYxNTZkM2U=", "commit": {"author": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2020-05-25T21:37:10Z"}, "committer": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2020-09-18T19:23:00Z"}, "message": "Make nrvo-simple set mir-opt-level=1\n\nThe additional copies are due to the lack of copy propagation", "tree": {"sha": "ddc70b6a48cfb11a512c4190d1e3af071fb8ce69", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ddc70b6a48cfb11a512c4190d1e3af071fb8ce69"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8a7b1c38940e8c0a013dacf52db6a7884f156d3e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8a7b1c38940e8c0a013dacf52db6a7884f156d3e", "html_url": "https://github.com/rust-lang/rust/commit/8a7b1c38940e8c0a013dacf52db6a7884f156d3e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8a7b1c38940e8c0a013dacf52db6a7884f156d3e/comments", "author": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "16498953856a41e781da65709f1d111cef66af91", "url": "https://api.github.com/repos/rust-lang/rust/commits/16498953856a41e781da65709f1d111cef66af91", "html_url": "https://github.com/rust-lang/rust/commit/16498953856a41e781da65709f1d111cef66af91"}], "stats": {"total": 57, "additions": 31, "deletions": 26}, "files": [{"sha": "ab46d7b94c72c09872aec2d17d961ae5f1cc4d97", "filename": "src/test/mir-opt/nrvo-simple.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8a7b1c38940e8c0a013dacf52db6a7884f156d3e/src%2Ftest%2Fmir-opt%2Fnrvo-simple.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8a7b1c38940e8c0a013dacf52db6a7884f156d3e/src%2Ftest%2Fmir-opt%2Fnrvo-simple.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Fnrvo-simple.rs?ref=8a7b1c38940e8c0a013dacf52db6a7884f156d3e", "patch": "@@ -1,3 +1,5 @@\n+// compile-flags: -Zmir-opt-level=1\n+\n // EMIT_MIR nrvo_simple.nrvo.RenameReturnPlace.diff\n fn nrvo(init: fn(&mut [u8; 1024])) -> [u8; 1024] {\n     let mut buf = [0; 1024];"}, {"sha": "f438eaa002780958f07d88a70f123bd229129de0", "filename": "src/test/mir-opt/nrvo_simple.nrvo.RenameReturnPlace.diff", "status": "modified", "additions": 29, "deletions": 26, "changes": 55, "blob_url": "https://github.com/rust-lang/rust/blob/8a7b1c38940e8c0a013dacf52db6a7884f156d3e/src%2Ftest%2Fmir-opt%2Fnrvo_simple.nrvo.RenameReturnPlace.diff", "raw_url": "https://github.com/rust-lang/rust/raw/8a7b1c38940e8c0a013dacf52db6a7884f156d3e/src%2Ftest%2Fmir-opt%2Fnrvo_simple.nrvo.RenameReturnPlace.diff", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Fnrvo_simple.nrvo.RenameReturnPlace.diff?ref=8a7b1c38940e8c0a013dacf52db6a7884f156d3e", "patch": "@@ -2,39 +2,42 @@\n + // MIR for `nrvo` after RenameReturnPlace\n   \n   fn nrvo(_1: for<'r> fn(&'r mut [u8; 1024])) -> [u8; 1024] {\n-      debug init => _1;                    // in scope 0 at $DIR/nrvo-simple.rs:2:9: 2:13\n--     let mut _0: [u8; 1024];              // return place in scope 0 at $DIR/nrvo-simple.rs:2:39: 2:49\n-+     let mut _0: [u8; 1024];              // return place in scope 0 at $DIR/nrvo-simple.rs:3:9: 3:16\n-      let mut _2: [u8; 1024];              // in scope 0 at $DIR/nrvo-simple.rs:3:9: 3:16\n-      let _3: ();                          // in scope 0 at $DIR/nrvo-simple.rs:4:5: 4:19\n-      let mut _4: for<'r> fn(&'r mut [u8; 1024]); // in scope 0 at $DIR/nrvo-simple.rs:4:5: 4:9\n-      let mut _5: &mut [u8; 1024];         // in scope 0 at $DIR/nrvo-simple.rs:4:10: 4:18\n-      let mut _6: &mut [u8; 1024];         // in scope 0 at $DIR/nrvo-simple.rs:4:10: 4:18\n+      debug init => _1;                    // in scope 0 at $DIR/nrvo-simple.rs:4:9: 4:13\n+-     let mut _0: [u8; 1024];              // return place in scope 0 at $DIR/nrvo-simple.rs:4:39: 4:49\n++     let mut _0: [u8; 1024];              // return place in scope 0 at $DIR/nrvo-simple.rs:5:9: 5:16\n+      let mut _2: [u8; 1024];              // in scope 0 at $DIR/nrvo-simple.rs:5:9: 5:16\n+      let _3: ();                          // in scope 0 at $DIR/nrvo-simple.rs:6:5: 6:19\n+      let mut _4: for<'r> fn(&'r mut [u8; 1024]); // in scope 0 at $DIR/nrvo-simple.rs:6:5: 6:9\n+      let mut _5: &mut [u8; 1024];         // in scope 0 at $DIR/nrvo-simple.rs:6:10: 6:18\n+      let mut _6: &mut [u8; 1024];         // in scope 0 at $DIR/nrvo-simple.rs:6:10: 6:18\n       scope 1 {\n--         debug buf => _2;                 // in scope 1 at $DIR/nrvo-simple.rs:3:9: 3:16\n-+         debug buf => _0;                 // in scope 1 at $DIR/nrvo-simple.rs:3:9: 3:16\n+-         debug buf => _2;                 // in scope 1 at $DIR/nrvo-simple.rs:5:9: 5:16\n++         debug buf => _0;                 // in scope 1 at $DIR/nrvo-simple.rs:5:9: 5:16\n       }\n   \n       bb0: {\n--         StorageLive(_2);                 // scope 0 at $DIR/nrvo-simple.rs:3:9: 3:16\n--         _2 = [const 0_u8; 1024];         // scope 0 at $DIR/nrvo-simple.rs:3:19: 3:28\n-+         _0 = [const 0_u8; 1024];         // scope 0 at $DIR/nrvo-simple.rs:3:19: 3:28\n-          StorageLive(_3);                 // scope 1 at $DIR/nrvo-simple.rs:4:5: 4:19\n-          StorageLive(_5);                 // scope 1 at $DIR/nrvo-simple.rs:4:10: 4:18\n-          StorageLive(_6);                 // scope 1 at $DIR/nrvo-simple.rs:4:10: 4:18\n--         _6 = &mut _2;                    // scope 1 at $DIR/nrvo-simple.rs:4:10: 4:18\n-+         _6 = &mut _0;                    // scope 1 at $DIR/nrvo-simple.rs:4:10: 4:18\n-          _5 = &mut (*_6);                 // scope 1 at $DIR/nrvo-simple.rs:4:10: 4:18\n-          _3 = move _1(move _5) -> bb1;    // scope 1 at $DIR/nrvo-simple.rs:4:5: 4:19\n+-         StorageLive(_2);                 // scope 0 at $DIR/nrvo-simple.rs:5:9: 5:16\n+-         _2 = [const 0_u8; 1024];         // scope 0 at $DIR/nrvo-simple.rs:5:19: 5:28\n++         _0 = [const 0_u8; 1024];         // scope 0 at $DIR/nrvo-simple.rs:5:19: 5:28\n+          StorageLive(_3);                 // scope 1 at $DIR/nrvo-simple.rs:6:5: 6:19\n+          StorageLive(_4);                 // scope 1 at $DIR/nrvo-simple.rs:6:5: 6:9\n+          _4 = _1;                         // scope 1 at $DIR/nrvo-simple.rs:6:5: 6:9\n+          StorageLive(_5);                 // scope 1 at $DIR/nrvo-simple.rs:6:10: 6:18\n+          StorageLive(_6);                 // scope 1 at $DIR/nrvo-simple.rs:6:10: 6:18\n+-         _6 = &mut _2;                    // scope 1 at $DIR/nrvo-simple.rs:6:10: 6:18\n++         _6 = &mut _0;                    // scope 1 at $DIR/nrvo-simple.rs:6:10: 6:18\n+          _5 = &mut (*_6);                 // scope 1 at $DIR/nrvo-simple.rs:6:10: 6:18\n+          _3 = move _4(move _5) -> bb1;    // scope 1 at $DIR/nrvo-simple.rs:6:5: 6:19\n       }\n   \n       bb1: {\n-          StorageDead(_5);                 // scope 1 at $DIR/nrvo-simple.rs:4:18: 4:19\n-          StorageDead(_6);                 // scope 1 at $DIR/nrvo-simple.rs:4:19: 4:20\n-          StorageDead(_3);                 // scope 1 at $DIR/nrvo-simple.rs:4:19: 4:20\n--         _0 = _2;                         // scope 1 at $DIR/nrvo-simple.rs:5:5: 5:8\n--         StorageDead(_2);                 // scope 0 at $DIR/nrvo-simple.rs:6:1: 6:2\n-          return;                          // scope 0 at $DIR/nrvo-simple.rs:6:2: 6:2\n+          StorageDead(_5);                 // scope 1 at $DIR/nrvo-simple.rs:6:18: 6:19\n+          StorageDead(_4);                 // scope 1 at $DIR/nrvo-simple.rs:6:18: 6:19\n+          StorageDead(_6);                 // scope 1 at $DIR/nrvo-simple.rs:6:19: 6:20\n+          StorageDead(_3);                 // scope 1 at $DIR/nrvo-simple.rs:6:19: 6:20\n+-         _0 = _2;                         // scope 1 at $DIR/nrvo-simple.rs:7:5: 7:8\n+-         StorageDead(_2);                 // scope 0 at $DIR/nrvo-simple.rs:8:1: 8:2\n+          return;                          // scope 0 at $DIR/nrvo-simple.rs:8:2: 8:2\n       }\n   }\n   "}]}