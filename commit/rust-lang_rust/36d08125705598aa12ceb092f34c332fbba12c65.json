{"sha": "36d08125705598aa12ceb092f34c332fbba12c65", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM2ZDA4MTI1NzA1NTk4YWExMmNlYjA5MmYzNGMzMzJmYmJhMTJjNjU=", "commit": {"author": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2019-10-07T00:00:00Z"}, "committer": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2020-01-09T06:54:02Z"}, "message": "Remove sanitizer_runtime attribute", "tree": {"sha": "1c1f043a8b2d3016619293422e5943cb92dc4e6b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1c1f043a8b2d3016619293422e5943cb92dc4e6b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/36d08125705598aa12ceb092f34c332fbba12c65", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/36d08125705598aa12ceb092f34c332fbba12c65", "html_url": "https://github.com/rust-lang/rust/commit/36d08125705598aa12ceb092f34c332fbba12c65", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/36d08125705598aa12ceb092f34c332fbba12c65/comments", "author": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "78e7eeeaa1f93f40fa96c36194b1afdfbfdb7364", "url": "https://api.github.com/repos/rust-lang/rust/commits/78e7eeeaa1f93f40fa96c36194b1afdfbfdb7364", "html_url": "https://github.com/rust-lang/rust/commit/78e7eeeaa1f93f40fa96c36194b1afdfbfdb7364"}], "stats": {"total": 45, "additions": 2, "deletions": 43}, "files": [{"sha": "82ae67fc05ac3ce680f6bad3c4e8871252229690", "filename": "src/doc/unstable-book/src/library-features/sanitizer-runtime-lib.md", "status": "removed", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/78e7eeeaa1f93f40fa96c36194b1afdfbfdb7364/src%2Fdoc%2Funstable-book%2Fsrc%2Flibrary-features%2Fsanitizer-runtime-lib.md", "raw_url": "https://github.com/rust-lang/rust/raw/78e7eeeaa1f93f40fa96c36194b1afdfbfdb7364/src%2Fdoc%2Funstable-book%2Fsrc%2Flibrary-features%2Fsanitizer-runtime-lib.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flibrary-features%2Fsanitizer-runtime-lib.md?ref=78e7eeeaa1f93f40fa96c36194b1afdfbfdb7364", "patch": "@@ -1,5 +0,0 @@\n-# `sanitizer_runtime_lib`\n-\n-This feature is internal to the Rust compiler and is not intended for general use.\n-\n-------------------------"}, {"sha": "9de46f86200e14a885a6fc4ed41b00f80590f2fd", "filename": "src/librustc/query/mod.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc%2Fquery%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc%2Fquery%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fquery%2Fmod.rs?ref=36d08125705598aa12ceb092f34c332fbba12c65", "patch": "@@ -686,10 +686,6 @@ rustc_queries! {\n             fatal_cycle\n             desc { \"checking if the crate has_panic_handler\" }\n         }\n-        query is_sanitizer_runtime(_: CrateNum) -> bool {\n-            fatal_cycle\n-            desc { \"query a crate is `#![sanitizer_runtime]`\" }\n-        }\n         query is_profiler_runtime(_: CrateNum) -> bool {\n             fatal_cycle\n             desc { \"query a crate is `#![profiler_runtime]`\" }"}, {"sha": "cb094079d64565e961ab3efbb965c4129be8831f", "filename": "src/librustc_codegen_ssa/base.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_codegen_ssa%2Fbase.rs", "raw_url": "https://github.com/rust-lang/rust/raw/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_codegen_ssa%2Fbase.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Fbase.rs?ref=36d08125705598aa12ceb092f34c332fbba12c65", "patch": "@@ -723,7 +723,6 @@ impl CrateInfo {\n             panic_runtime: None,\n             compiler_builtins: None,\n             profiler_runtime: None,\n-            sanitizer_runtime: None,\n             is_no_builtins: Default::default(),\n             native_libraries: Default::default(),\n             used_libraries: tcx.native_libraries(LOCAL_CRATE),\n@@ -759,9 +758,6 @@ impl CrateInfo {\n             if tcx.is_profiler_runtime(cnum) {\n                 info.profiler_runtime = Some(cnum);\n             }\n-            if tcx.is_sanitizer_runtime(cnum) {\n-                info.sanitizer_runtime = Some(cnum);\n-            }\n             if tcx.is_no_builtins(cnum) {\n                 info.is_no_builtins.insert(cnum);\n             }"}, {"sha": "ee527ecb509b27417013717381c78cfc2c9b70e4", "filename": "src/librustc_codegen_ssa/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_codegen_ssa%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_codegen_ssa%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Flib.rs?ref=36d08125705598aa12ceb092f34c332fbba12c65", "patch": "@@ -122,7 +122,6 @@ pub struct CrateInfo {\n     pub panic_runtime: Option<CrateNum>,\n     pub compiler_builtins: Option<CrateNum>,\n     pub profiler_runtime: Option<CrateNum>,\n-    pub sanitizer_runtime: Option<CrateNum>,\n     pub is_no_builtins: FxHashSet<CrateNum>,\n     pub native_libraries: FxHashMap<CrateNum, Lrc<Vec<NativeLibrary>>>,\n     pub crate_name: FxHashMap<CrateNum, String>,"}, {"sha": "3b894775e69733e9ca7562b560a6f8613251bb33", "filename": "src/librustc_feature/active.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_feature%2Factive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_feature%2Factive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_feature%2Factive.rs?ref=36d08125705598aa12ceb092f34c332fbba12c65", "patch": "@@ -192,9 +192,6 @@ declare_features! (\n     /// Allows using the `unadjusted` ABI; perma-unstable.\n     (active, abi_unadjusted, \"1.16.0\", None, None),\n \n-    /// Allows identifying crates that contain sanitizer runtimes.\n-    (active, sanitizer_runtime, \"1.17.0\", None, None),\n-\n     /// Used to identify crates that contain the profiler runtime.\n     (active, profiler_runtime, \"1.18.0\", None, None),\n "}, {"sha": "a38726e3de81fad8a3e7ff5173de7513600785e7", "filename": "src/librustc_feature/builtin_attrs.rs", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_feature%2Fbuiltin_attrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_feature%2Fbuiltin_attrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_feature%2Fbuiltin_attrs.rs?ref=36d08125705598aa12ceb092f34c332fbba12c65", "patch": "@@ -409,11 +409,6 @@ pub const BUILTIN_ATTRIBUTES: &[BuiltinAttribute] = &[\n         \"the `#[compiler_builtins]` attribute is used to identify the `compiler_builtins` crate \\\n         which contains compiler-rt intrinsics and will never be stable\",\n     ),\n-    gated!(\n-        sanitizer_runtime, Whitelisted, template!(Word),\n-        \"the `#[sanitizer_runtime]` attribute is used to identify crates that contain the runtime \\\n-        of a sanitizer and will never be stable\",\n-    ),\n     gated!(\n         profiler_runtime, Whitelisted, template!(Word),\n         \"the `#[profiler_runtime]` attribute is used to identify the `profiler_builtins` crate \\"}, {"sha": "d5b6fe81c7be8af0091b2bd55cc16af77291fc37", "filename": "src/librustc_feature/removed.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_feature%2Fremoved.rs", "raw_url": "https://github.com/rust-lang/rust/raw/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_feature%2Fremoved.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_feature%2Fremoved.rs?ref=36d08125705598aa12ceb092f34c332fbba12c65", "patch": "@@ -74,6 +74,8 @@ declare_features! (\n     (removed, pushpop_unsafe, \"1.2.0\", None, None, None),\n     (removed, needs_allocator, \"1.4.0\", Some(27389), None,\n      Some(\"subsumed by `#![feature(allocator_internals)]`\")),\n+    /// Allows identifying crates that contain sanitizer runtimes.\n+    (removed, sanitizer_runtime, \"1.17.0\", None, None, None),\n     (removed, proc_macro_mod, \"1.27.0\", Some(54727), None,\n      Some(\"subsumed by `#![feature(proc_macro_hygiene)]`\")),\n     (removed, proc_macro_expr, \"1.27.0\", Some(54727), None,"}, {"sha": "4d3be00debaf9db7165f8f36a7c03d598c12a516", "filename": "src/librustc_metadata/rmeta/decoder.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_metadata%2Frmeta%2Fdecoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_metadata%2Frmeta%2Fdecoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Frmeta%2Fdecoder.rs?ref=36d08125705598aa12ceb092f34c332fbba12c65", "patch": "@@ -1587,10 +1587,6 @@ impl<'a, 'tcx> CrateMetadata {\n         self.root.panic_runtime\n     }\n \n-    crate fn is_sanitizer_runtime(&self) -> bool {\n-        self.root.sanitizer_runtime\n-    }\n-\n     crate fn is_profiler_runtime(&self) -> bool {\n         self.root.profiler_runtime\n     }"}, {"sha": "b61ab8cc450fad810401f9e08a431f239cd1fe95", "filename": "src/librustc_metadata/rmeta/decoder/cstore_impl.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_metadata%2Frmeta%2Fdecoder%2Fcstore_impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_metadata%2Frmeta%2Fdecoder%2Fcstore_impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Frmeta%2Fdecoder%2Fcstore_impl.rs?ref=36d08125705598aa12ceb092f34c332fbba12c65", "patch": "@@ -161,7 +161,6 @@ provide! { <'tcx> tcx, def_id, other, cdata,\n     is_compiler_builtins => { cdata.root.compiler_builtins }\n     has_global_allocator => { cdata.root.has_global_allocator }\n     has_panic_handler => { cdata.root.has_panic_handler }\n-    is_sanitizer_runtime => { cdata.root.sanitizer_runtime }\n     is_profiler_runtime => { cdata.root.profiler_runtime }\n     panic_strategy => { cdata.root.panic_strategy }\n     extern_crate => {"}, {"sha": "7f8791d0c34dc467811e0045782d139c0b3f1bdd", "filename": "src/librustc_metadata/rmeta/encoder.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_metadata%2Frmeta%2Fencoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_metadata%2Frmeta%2Fencoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Frmeta%2Fencoder.rs?ref=36d08125705598aa12ceb092f34c332fbba12c65", "patch": "@@ -514,7 +514,6 @@ impl<'tcx> EncodeContext<'tcx> {\n             no_builtins: attr::contains_name(&attrs, sym::no_builtins),\n             panic_runtime: attr::contains_name(&attrs, sym::panic_runtime),\n             profiler_runtime: attr::contains_name(&attrs, sym::profiler_runtime),\n-            sanitizer_runtime: attr::contains_name(&attrs, sym::sanitizer_runtime),\n             symbol_mangling_version: tcx.sess.opts.debugging_opts.symbol_mangling_version,\n \n             crate_deps,"}, {"sha": "426ea62b8cd4c6625f1038f9d8a702d36f6a34f0", "filename": "src/librustc_metadata/rmeta/mod.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_metadata%2Frmeta%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/36d08125705598aa12ceb092f34c332fbba12c65/src%2Flibrustc_metadata%2Frmeta%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Frmeta%2Fmod.rs?ref=36d08125705598aa12ceb092f34c332fbba12c65", "patch": "@@ -209,7 +209,6 @@ crate struct CrateRoot<'tcx> {\n     no_builtins: bool,\n     panic_runtime: bool,\n     profiler_runtime: bool,\n-    sanitizer_runtime: bool,\n     symbol_mangling_version: SymbolManglingVersion,\n }\n "}, {"sha": "3b972c117a6ffaa0e00876f8f0936eeb5ef53843", "filename": "src/test/ui/feature-gates/feature-gate-sanitizer-runtime.rs", "status": "removed", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/78e7eeeaa1f93f40fa96c36194b1afdfbfdb7364/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-sanitizer-runtime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/78e7eeeaa1f93f40fa96c36194b1afdfbfdb7364/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-sanitizer-runtime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-sanitizer-runtime.rs?ref=78e7eeeaa1f93f40fa96c36194b1afdfbfdb7364", "patch": "@@ -1,3 +0,0 @@\n-#![sanitizer_runtime] //~ ERROR the `#[sanitizer_runtime]` attribute is\n-\n-fn main() {}"}, {"sha": "b13ec215f8c08c0cab1d38adae880ab37ad51d59", "filename": "src/test/ui/feature-gates/feature-gate-sanitizer-runtime.stderr", "status": "removed", "additions": 0, "deletions": 11, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/78e7eeeaa1f93f40fa96c36194b1afdfbfdb7364/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-sanitizer-runtime.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/78e7eeeaa1f93f40fa96c36194b1afdfbfdb7364/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-sanitizer-runtime.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-sanitizer-runtime.stderr?ref=78e7eeeaa1f93f40fa96c36194b1afdfbfdb7364", "patch": "@@ -1,11 +0,0 @@\n-error[E0658]: the `#[sanitizer_runtime]` attribute is used to identify crates that contain the runtime of a sanitizer and will never be stable\n-  --> $DIR/feature-gate-sanitizer-runtime.rs:1:1\n-   |\n-LL | #![sanitizer_runtime]\n-   | ^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = help: add `#![feature(sanitizer_runtime)]` to the crate attributes to enable\n-\n-error: aborting due to previous error\n-\n-For more information about this error, try `rustc --explain E0658`."}]}