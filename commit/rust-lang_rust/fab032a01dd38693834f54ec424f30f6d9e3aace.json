{"sha": "fab032a01dd38693834f54ec424f30f6d9e3aace", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZhYjAzMmEwMWRkMzg2OTM4MzRmNTRlYzQyNGYzMGY2ZDllM2FhY2U=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-02-03T09:12:47Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-02-04T05:49:11Z"}, "message": "Transition compiletest to Rust 2018", "tree": {"sha": "32423337c249a90ca501b16065c1738b658a1c86", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/32423337c249a90ca501b16065c1738b658a1c86"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fab032a01dd38693834f54ec424f30f6d9e3aace", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEvUKv4zqIn2RHUgCKtvoGpuDiZlsFAlxX0l0ACgkQtvoGpuDi\nZlvxTQ//c32PJX++0D9hXEgIjQ5gPTtCnF2MptZUR8ub3ybDSik+KcfLZpTVP71r\nX6VHX0ShL8rNaBRxQyDiuuyIlJ/k+c7fusvn/CbEqEniQPMBSX6JGCXaoTjDJVHS\ncWV6AIMLPj87b4gGBYXWckFcvorgRU1Y1MhvfcFXPPZ3d2y8eHY+AfCwP/F4KwZM\nWDRc64/GAe0tiFanwJf0/g06wa9/Jjw7NuTDcRisdqe9UliZZc9s9p5xKd65p6Ht\nNWb3+95dOe7MQqCYghquX2Yxa+l80zd8spiE7QfqZinyAalnZJJJuzMFuEkgDI02\nCiS4nHd7QGVMJGvWabK5a+ofYS+oPCMvnWKkhOkRWXFnmDTUcXBfHUqnnySaT7Gf\nP3+dhrxz+PUTcwFXAi8Rjr7BpFJsLx/f46uWxlhlRAZFXhyJBpvH9XIWQe9au7Ku\nOiZoVxDBtlXGgaSRLTaUFFq/ymQhq6HkbeMZz6cnhqYFSCfdPnOHBhJ3qnAjYZ6T\nPuZvu5mR8Up5qE1nCtPuNYZHzlazJmc8+0PeWjUmE0Z571+3sub7kNw423GiMfp1\ngpNbuch9fGid1i8H7KJv06cPXBOwu3bhneOgltpDPLSb6C2B8ZoHPClDjUvuSSrE\nWAe8zcbpLJs3JkuxluAmfsCGB07ys0r2TIGUOPx69SBck6UsrDM=\n=ClNh\n-----END PGP SIGNATURE-----", "payload": "tree 32423337c249a90ca501b16065c1738b658a1c86\nparent 2966fbc10d0fd4fe15a25608b9eca3e52ba24995\nauthor Philipp Hansch <dev@phansch.net> 1549185167 +0100\ncommitter Philipp Hansch <dev@phansch.net> 1549259351 +0100\n\nTransition compiletest to Rust 2018\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fab032a01dd38693834f54ec424f30f6d9e3aace", "html_url": "https://github.com/rust-lang/rust/commit/fab032a01dd38693834f54ec424f30f6d9e3aace", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fab032a01dd38693834f54ec424f30f6d9e3aace/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2966fbc10d0fd4fe15a25608b9eca3e52ba24995", "url": "https://api.github.com/repos/rust-lang/rust/commits/2966fbc10d0fd4fe15a25608b9eca3e52ba24995", "html_url": "https://github.com/rust-lang/rust/commit/2966fbc10d0fd4fe15a25608b9eca3e52ba24995"}], "stats": {"total": 86, "additions": 39, "deletions": 47}, "files": [{"sha": "00e1a53473cdad152d47e9783947c2972ca998fc", "filename": "src/tools/compiletest/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2FCargo.toml?ref=fab032a01dd38693834f54ec424f30f6d9e3aace", "patch": "@@ -2,6 +2,7 @@\n authors = [\"The Rust Project Developers\"]\n name = \"compiletest\"\n version = \"0.0.0\"\n+edition = \"2018\"\n \n [dependencies]\n diff = \"0.1.10\""}, {"sha": "42afb72c91f39f20ab3044e87b8c1a9d80fdd0d2", "filename": "src/tools/compiletest/src/common.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Fcommon.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Fcommon.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fcommon.rs?ref=fab032a01dd38693834f54ec424f30f6d9e3aace", "patch": "@@ -5,7 +5,7 @@ use std::path::{Path, PathBuf};\n use std::str::FromStr;\n \n use test::ColorConfig;\n-use util::PathBufExt;\n+use crate::util::PathBufExt;\n \n #[derive(Clone, Copy, PartialEq, Debug)]\n pub enum Mode {\n@@ -66,7 +66,7 @@ impl FromStr for Mode {\n }\n \n impl fmt::Display for Mode {\n-    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\n+    fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {\n         let s = match *self {\n             CompileFail => \"compile-fail\",\n             RunFail => \"run-fail\","}, {"sha": "0329fb0db1422e61479174abaa09f7d211261155", "filename": "src/tools/compiletest/src/errors.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Ferrors.rs?ref=fab032a01dd38693834f54ec424f30f6d9e3aace", "patch": "@@ -33,7 +33,7 @@ impl FromStr for ErrorKind {\n }\n \n impl fmt::Display for ErrorKind {\n-    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\n+    fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {\n         match *self {\n             ErrorKind::Help => write!(f, \"help message\"),\n             ErrorKind::Error => write!(f, \"error\"),"}, {"sha": "80a015d7aea56850919b160dad1de84777a06aa2", "filename": "src/tools/compiletest/src/header.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Fheader.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Fheader.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fheader.rs?ref=fab032a01dd38693834f54ec424f30f6d9e3aace", "patch": "@@ -4,10 +4,10 @@ use std::io::prelude::*;\n use std::io::BufReader;\n use std::path::{Path, PathBuf};\n \n-use common::{self, CompareMode, Config, Mode};\n-use util;\n+use crate::common::{self, CompareMode, Config, Mode};\n+use crate::util;\n \n-use extract_gdb_version;\n+use crate::extract_gdb_version;\n \n /// Whether to ignore the test.\n #[derive(Clone, Copy, PartialEq, Debug)]"}, {"sha": "12aae303f29aaea24d41acc6aecc21881c7dd2d8", "filename": "src/tools/compiletest/src/json.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Fjson.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Fjson.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fjson.rs?ref=fab032a01dd38693834f54ec424f30f6d9e3aace", "patch": "@@ -1,5 +1,5 @@\n-use errors::{Error, ErrorKind};\n-use runtest::ProcRes;\n+use crate::errors::{Error, ErrorKind};\n+use crate::runtest::ProcRes;\n use serde_json;\n use std::path::Path;\n use std::str::FromStr;"}, {"sha": "1f9b4b2ad4363263ed2372d2ff3d1265140bec63", "filename": "src/tools/compiletest/src/main.rs", "status": "modified", "additions": 8, "deletions": 14, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs?ref=fab032a01dd38693834f54ec424f30f6d9e3aace", "patch": "@@ -1,29 +1,21 @@\n #![crate_name = \"compiletest\"]\n #![feature(test)]\n-#![deny(warnings)]\n+#![deny(warnings, rust_2018_idioms)]\n \n-extern crate diff;\n-extern crate env_logger;\n-extern crate filetime;\n-extern crate getopts;\n #[cfg(unix)]\n extern crate libc;\n #[macro_use]\n extern crate log;\n-extern crate regex;\n #[macro_use]\n extern crate lazy_static;\n #[macro_use]\n extern crate serde_derive;\n-extern crate serde_json;\n extern crate test;\n-extern crate rustfix;\n-extern crate walkdir;\n \n-use common::CompareMode;\n-use common::{expected_output_path, output_base_dir, output_relative_path, UI_EXTENSIONS};\n-use common::{Config, TestPaths};\n-use common::{DebugInfoBoth, DebugInfoGdb, DebugInfoLldb, Mode, Pretty};\n+use crate::common::CompareMode;\n+use crate::common::{expected_output_path, output_base_dir, output_relative_path, UI_EXTENSIONS};\n+use crate::common::{Config, TestPaths};\n+use crate::common::{DebugInfoBoth, DebugInfoGdb, DebugInfoLldb, Mode, Pretty};\n use filetime::FileTime;\n use getopts::Options;\n use std::env;\n@@ -33,8 +25,10 @@ use std::io::{self, ErrorKind};\n use std::path::{Path, PathBuf};\n use std::process::Command;\n use test::ColorConfig;\n-use util::logv;\n+use crate::util::logv;\n use walkdir::WalkDir;\n+use env_logger;\n+use getopts;\n \n use self::header::{EarlyProps, Ignore};\n "}, {"sha": "6dfd8e97c636d6f28255af4ea19ef6e78150df09", "filename": "src/tools/compiletest/src/read2.rs", "status": "modified", "additions": 4, "deletions": 7, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Fread2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Fread2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fread2.rs?ref=fab032a01dd38693834f54ec424f30f6d9e3aace", "patch": "@@ -100,18 +100,15 @@ mod imp {\n \n #[cfg(windows)]\n mod imp {\n-    extern crate miow;\n-    extern crate winapi;\n-\n     use std::io;\n     use std::os::windows::prelude::*;\n     use std::process::{ChildStderr, ChildStdout};\n     use std::slice;\n \n-    use self::miow::iocp::{CompletionPort, CompletionStatus};\n-    use self::miow::pipe::NamedPipe;\n-    use self::miow::Overlapped;\n-    use self::winapi::shared::winerror::ERROR_BROKEN_PIPE;\n+    use miow::iocp::{CompletionPort, CompletionStatus};\n+    use miow::pipe::NamedPipe;\n+    use miow::Overlapped;\n+    use winapi::shared::winerror::ERROR_BROKEN_PIPE;\n \n     struct Pipe<'a> {\n         dst: &'a mut Vec<u8>,"}, {"sha": "31529810a04dbc377e6b1e4364836f90e9cd5cd9", "filename": "src/tools/compiletest/src/runtest.rs", "status": "modified", "additions": 17, "deletions": 17, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs?ref=fab032a01dd38693834f54ec424f30f6d9e3aace", "patch": "@@ -1,18 +1,18 @@\n-use common::CompareMode;\n-use common::{expected_output_path, UI_EXTENSIONS, UI_FIXED, UI_STDERR, UI_STDOUT};\n-use common::{output_base_dir, output_base_name, output_testname_unique};\n-use common::{Codegen, CodegenUnits, DebugInfoBoth, DebugInfoGdb, DebugInfoLldb, Rustdoc};\n-use common::{CompileFail, Pretty, RunFail, RunPass, RunPassValgrind};\n-use common::{Config, TestPaths};\n-use common::{Incremental, MirOpt, RunMake, Ui};\n+use crate::common::CompareMode;\n+use crate::common::{expected_output_path, UI_EXTENSIONS, UI_FIXED, UI_STDERR, UI_STDOUT};\n+use crate::common::{output_base_dir, output_base_name, output_testname_unique};\n+use crate::common::{Codegen, CodegenUnits, DebugInfoBoth, DebugInfoGdb, DebugInfoLldb, Rustdoc};\n+use crate::common::{CompileFail, Pretty, RunFail, RunPass, RunPassValgrind};\n+use crate::common::{Config, TestPaths};\n+use crate::common::{Incremental, MirOpt, RunMake, Ui};\n use diff;\n-use errors::{self, Error, ErrorKind};\n+use crate::errors::{self, Error, ErrorKind};\n use filetime::FileTime;\n-use header::TestProps;\n-use json;\n+use crate::header::TestProps;\n+use crate::json;\n use regex::Regex;\n use rustfix::{apply_suggestions, get_suggestions_from_json, Filter};\n-use util::{logv, PathBufExt};\n+use crate::util::{logv, PathBufExt};\n \n use std::collections::hash_map::DefaultHasher;\n use std::collections::{HashMap, HashSet, VecDeque};\n@@ -27,8 +27,8 @@ use std::path::{Path, PathBuf};\n use std::process::{Child, Command, ExitStatus, Output, Stdio};\n use std::str;\n \n-use extract_gdb_version;\n-use is_android_gdb_target;\n+use crate::extract_gdb_version;\n+use crate::is_android_gdb_target;\n \n #[cfg(windows)]\n fn disable_error_reporting<F: FnOnce() -> R, R>(f: F) -> R {\n@@ -1937,7 +1937,7 @@ impl<'test> TestCx<'test> {\n     }\n \n     fn make_cmdline(&self, command: &Command, libpath: &str) -> String {\n-        use util;\n+        use crate::util;\n \n         // Linux and mac don't require adjusting the library search path\n         if cfg!(unix) {\n@@ -3255,7 +3255,7 @@ impl<'test> TestCx<'test> {\n     }\n \n     fn create_stamp(&self) {\n-        let stamp = ::stamp(&self.config, self.testpaths, self.revision);\n+        let stamp = crate::stamp(&self.config, self.testpaths, self.revision);\n         fs::write(&stamp, compute_stamp_hash(&self.config)).unwrap();\n     }\n }\n@@ -3311,7 +3311,7 @@ impl<T> fmt::Debug for ExpectedLine<T>\n where\n     T: AsRef<str> + fmt::Debug,\n {\n-    fn fmt(&self, formatter: &mut fmt::Formatter) -> fmt::Result {\n+    fn fmt(&self, formatter: &mut fmt::Formatter<'_>) -> fmt::Result {\n         if let &ExpectedLine::Text(ref t) = self {\n             write!(formatter, \"{:?}\", t)\n         } else {\n@@ -3334,7 +3334,7 @@ fn nocomment_mir_line(line: &str) -> &str {\n }\n \n fn read2_abbreviated(mut child: Child) -> io::Result<Output> {\n-    use read2::read2;\n+    use crate::read2::read2;\n     use std::mem::replace;\n \n     const HEAD_LEN: usize = 160 * 1024;"}, {"sha": "85be2fed07567111e20d1e0ccb0db66a1d0262b5", "filename": "src/tools/compiletest/src/util.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fab032a01dd38693834f54ec424f30f6d9e3aace/src%2Ftools%2Fcompiletest%2Fsrc%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Futil.rs?ref=fab032a01dd38693834f54ec424f30f6d9e3aace", "patch": "@@ -1,7 +1,7 @@\n use std::ffi::OsStr;\n use std::env;\n use std::path::PathBuf;\n-use common::Config;\n+use crate::common::Config;\n \n /// Conversion table from triple OS name to Rust SYSNAME\n const OS_TABLE: &'static [(&'static str, &'static str)] = &["}]}