{"sha": "b56cb9e032bd6699a79982a3c20d5f2dd9646c83", "node_id": "C_kwDOAAsO6NoAKGI1NmNiOWUwMzJiZDY2OTlhNzk5ODJhM2MyMGQ1ZjJkZDk2NDZjODM", "commit": {"author": {"name": "Thom Chiovoloni", "email": "thom@shift.click", "date": "2022-10-31T07:42:10Z"}, "committer": {"name": "Thom Chiovoloni", "email": "thom@shift.click", "date": "2022-10-31T07:42:10Z"}, "message": "Include both benchmarks and tests in the numbers given to `TeFiltered{,Out}`", "tree": {"sha": "43ecea69ea0c33429043339c835684c3a962ec0a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/43ecea69ea0c33429043339c835684c3a962ec0a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b56cb9e032bd6699a79982a3c20d5f2dd9646c83", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYKAB0WIQQszICQ1r0Zqrp7OLPXcz0dendfCgUCY198UgAKCRDXcz0dendf\nCn6UAQCHjM/wpm3YtZIufot4Kx6tB6U4u6wX4j0NhlZU/GJ59gD/RDZ6AZDzmz5m\ndoNNwNT9SiAT8dc/tOs//qj8DRtf2wM=\n=ttIY\n-----END PGP SIGNATURE-----", "payload": "tree 43ecea69ea0c33429043339c835684c3a962ec0a\nparent 4596f4f8b565bdd02d3b99d1ab12ff09146a93de\nauthor Thom Chiovoloni <thom@shift.click> 1667202130 -0700\ncommitter Thom Chiovoloni <thom@shift.click> 1667202130 -0700\n\nInclude both benchmarks and tests in the numbers given to `TeFiltered{,Out}`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b56cb9e032bd6699a79982a3c20d5f2dd9646c83", "html_url": "https://github.com/rust-lang/rust/commit/b56cb9e032bd6699a79982a3c20d5f2dd9646c83", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b56cb9e032bd6699a79982a3c20d5f2dd9646c83/comments", "author": {"login": "thomcc", "id": 860665, "node_id": "MDQ6VXNlcjg2MDY2NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/860665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thomcc", "html_url": "https://github.com/thomcc", "followers_url": "https://api.github.com/users/thomcc/followers", "following_url": "https://api.github.com/users/thomcc/following{/other_user}", "gists_url": "https://api.github.com/users/thomcc/gists{/gist_id}", "starred_url": "https://api.github.com/users/thomcc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thomcc/subscriptions", "organizations_url": "https://api.github.com/users/thomcc/orgs", "repos_url": "https://api.github.com/users/thomcc/repos", "events_url": "https://api.github.com/users/thomcc/events{/privacy}", "received_events_url": "https://api.github.com/users/thomcc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "thomcc", "id": 860665, "node_id": "MDQ6VXNlcjg2MDY2NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/860665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thomcc", "html_url": "https://github.com/thomcc", "followers_url": "https://api.github.com/users/thomcc/followers", "following_url": "https://api.github.com/users/thomcc/following{/other_user}", "gists_url": "https://api.github.com/users/thomcc/gists{/gist_id}", "starred_url": "https://api.github.com/users/thomcc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thomcc/subscriptions", "organizations_url": "https://api.github.com/users/thomcc/orgs", "repos_url": "https://api.github.com/users/thomcc/repos", "events_url": "https://api.github.com/users/thomcc/events{/privacy}", "received_events_url": "https://api.github.com/users/thomcc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4596f4f8b565bdd02d3b99d1ab12ff09146a93de", "url": "https://api.github.com/repos/rust-lang/rust/commits/4596f4f8b565bdd02d3b99d1ab12ff09146a93de", "html_url": "https://github.com/rust-lang/rust/commit/4596f4f8b565bdd02d3b99d1ab12ff09146a93de"}], "stats": {"total": 7, "additions": 5, "deletions": 2}, "files": [{"sha": "f16d94bbc81c3fca9d9d7e597e74c607c064472d", "filename": "library/test/src/lib.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/b56cb9e032bd6699a79982a3c20d5f2dd9646c83/library%2Ftest%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b56cb9e032bd6699a79982a3c20d5f2dd9646c83/library%2Ftest%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Ftest%2Fsrc%2Flib.rs?ref=b56cb9e032bd6699a79982a3c20d5f2dd9646c83", "patch": "@@ -246,6 +246,9 @@ impl FilteredTests {\n         }));\n         self.add_test(desc, testfn);\n     }\n+    fn total_len(&self) -> usize {\n+        self.tests.len() + self.benchs.len()\n+    }\n }\n \n pub fn run_tests<F>(\n@@ -303,13 +306,13 @@ where\n         };\n     }\n \n-    let filtered_out = tests_len - filtered.tests.len();\n+    let filtered_out = tests_len - filtered.total_len();\n     let event = TestEvent::TeFilteredOut(filtered_out);\n     notify_about_test_event(event)?;\n \n     let shuffle_seed = get_shuffle_seed(opts);\n \n-    let event = TestEvent::TeFiltered(filtered.tests.len(), shuffle_seed);\n+    let event = TestEvent::TeFiltered(filtered.total_len(), shuffle_seed);\n     notify_about_test_event(event)?;\n \n     let concurrency = opts.test_threads.unwrap_or_else(get_concurrency);"}]}