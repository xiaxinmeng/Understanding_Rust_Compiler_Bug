{"sha": "9b13e403761797127fd19a7c13eeb2429eb1c139", "node_id": "MDY6Q29tbWl0NzI0NzEyOjliMTNlNDAzNzYxNzk3MTI3ZmQxOWE3YzEzZWViMjQyOWViMWMxMzk=", "commit": {"author": {"name": "Marco A L Barbosa", "email": "malbarbo@gmail.com", "date": "2018-01-23T23:39:17Z"}, "committer": {"name": "Marco A L Barbosa", "email": "malbarbo@gmail.com", "date": "2018-01-23T23:39:17Z"}, "message": "Build musl with -fPIC for all targets", "tree": {"sha": "a2a68e2f4b832a2b7f13dc5da8b3b74fecb1b450", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a2a68e2f4b832a2b7f13dc5da8b3b74fecb1b450"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9b13e403761797127fd19a7c13eeb2429eb1c139", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9b13e403761797127fd19a7c13eeb2429eb1c139", "html_url": "https://github.com/rust-lang/rust/commit/9b13e403761797127fd19a7c13eeb2429eb1c139", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9b13e403761797127fd19a7c13eeb2429eb1c139/comments", "author": {"login": "malbarbo", "id": 1678126, "node_id": "MDQ6VXNlcjE2NzgxMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1678126?v=4", "gravatar_id": "", "url": "https://api.github.com/users/malbarbo", "html_url": "https://github.com/malbarbo", "followers_url": "https://api.github.com/users/malbarbo/followers", "following_url": "https://api.github.com/users/malbarbo/following{/other_user}", "gists_url": "https://api.github.com/users/malbarbo/gists{/gist_id}", "starred_url": "https://api.github.com/users/malbarbo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/malbarbo/subscriptions", "organizations_url": "https://api.github.com/users/malbarbo/orgs", "repos_url": "https://api.github.com/users/malbarbo/repos", "events_url": "https://api.github.com/users/malbarbo/events{/privacy}", "received_events_url": "https://api.github.com/users/malbarbo/received_events", "type": "User", "site_admin": false}, "committer": {"login": "malbarbo", "id": 1678126, "node_id": "MDQ6VXNlcjE2NzgxMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1678126?v=4", "gravatar_id": "", "url": "https://api.github.com/users/malbarbo", "html_url": "https://github.com/malbarbo", "followers_url": "https://api.github.com/users/malbarbo/followers", "following_url": "https://api.github.com/users/malbarbo/following{/other_user}", "gists_url": "https://api.github.com/users/malbarbo/gists{/gist_id}", "starred_url": "https://api.github.com/users/malbarbo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/malbarbo/subscriptions", "organizations_url": "https://api.github.com/users/malbarbo/orgs", "repos_url": "https://api.github.com/users/malbarbo/repos", "events_url": "https://api.github.com/users/malbarbo/events{/privacy}", "received_events_url": "https://api.github.com/users/malbarbo/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "abc1061a656284f6e07008e7fd058a389ab2f33e", "url": "https://api.github.com/repos/rust-lang/rust/commits/abc1061a656284f6e07008e7fd058a389ab2f33e", "html_url": "https://github.com/rust-lang/rust/commit/abc1061a656284f6e07008e7fd058a389ab2f33e"}], "stats": {"total": 9, "additions": 5, "deletions": 4}, "files": [{"sha": "035846b4f6437bc2abd2c7d068e97900e207bf27", "filename": "src/ci/docker/dist-i586-gnu-i586-i686-musl/Dockerfile", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9b13e403761797127fd19a7c13eeb2429eb1c139/src%2Fci%2Fdocker%2Fdist-i586-gnu-i586-i686-musl%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9b13e403761797127fd19a7c13eeb2429eb1c139/src%2Fci%2Fdocker%2Fdist-i586-gnu-i586-i686-musl%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-i586-gnu-i586-i686-musl%2FDockerfile?ref=9b13e403761797127fd19a7c13eeb2429eb1c139", "patch": "@@ -18,10 +18,10 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n \n WORKDIR /build/\n COPY scripts/musl.sh /build/\n-RUN CC=gcc CFLAGS=\"-m32 -fPIC -Wa,-mrelax-relocations=no\" \\\n+RUN CC=gcc CFLAGS=\"-m32 -Wa,-mrelax-relocations=no\" \\\n     CXX=g++ CXXFLAGS=\"-m32 -Wa,-mrelax-relocations=no\" \\\n     bash musl.sh i686 --target=i686 && \\\n-    CC=gcc CFLAGS=\"-march=pentium -m32 -fPIC -Wa,-mrelax-relocations=no\" \\\n+    CC=gcc CFLAGS=\"-march=pentium -m32 -Wa,-mrelax-relocations=no\" \\\n     CXX=g++ CXXFLAGS=\"-march=pentium -m32 -Wa,-mrelax-relocations=no\" \\\n     bash musl.sh i586 --target=i586 && \\\n     rm -rf /build"}, {"sha": "64c993860d9e198d9b4167063e5ced6bc38649c8", "filename": "src/ci/docker/dist-various-1/Dockerfile", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/9b13e403761797127fd19a7c13eeb2429eb1c139/src%2Fci%2Fdocker%2Fdist-various-1%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9b13e403761797127fd19a7c13eeb2429eb1c139/src%2Fci%2Fdocker%2Fdist-various-1%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-various-1%2FDockerfile?ref=9b13e403761797127fd19a7c13eeb2429eb1c139", "patch": "@@ -89,7 +89,6 @@ ENV CC_mipsel_unknown_linux_musl=mipsel-openwrt-linux-gcc \\\n     CFLAGS_armv5te_unknown_linux_gnueabi=\"-march=armv5te -marm -mfloat-abi=soft\"\n \n ENV RUST_CONFIGURE_ARGS \\\n-      --enable-extended \\\n       --target=$TARGETS \\\n       --musl-root-arm=/musl-arm \\\n       --musl-root-armhf=/musl-armhf \\"}, {"sha": "c1061309c30f85a9b5de068dc901e52b0cce4a45", "filename": "src/ci/docker/dist-x86_64-musl/Dockerfile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9b13e403761797127fd19a7c13eeb2429eb1c139/src%2Fci%2Fdocker%2Fdist-x86_64-musl%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9b13e403761797127fd19a7c13eeb2429eb1c139/src%2Fci%2Fdocker%2Fdist-x86_64-musl%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-x86_64-musl%2FDockerfile?ref=9b13e403761797127fd19a7c13eeb2429eb1c139", "patch": "@@ -21,7 +21,7 @@ WORKDIR /build/\n COPY scripts/musl.sh /build/\n # We need to mitigate rust-lang/rust#34978 when compiling musl itself as well\n RUN CC=gcc \\\n-    CFLAGS=\"-fPIC -Wa,-mrelax-relocations=no\" \\\n+    CFLAGS=\"-Wa,-mrelax-relocations=no\" \\\n     CXX=g++ \\\n     CXXFLAGS=\"-Wa,-mrelax-relocations=no\" \\\n     bash musl.sh x86_64 && rm -rf /build"}, {"sha": "d6c1f7de7595c3131937d290e58e320a3690e809", "filename": "src/ci/docker/scripts/musl.sh", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9b13e403761797127fd19a7c13eeb2429eb1c139/src%2Fci%2Fdocker%2Fscripts%2Fmusl.sh", "raw_url": "https://github.com/rust-lang/rust/raw/9b13e403761797127fd19a7c13eeb2429eb1c139/src%2Fci%2Fdocker%2Fscripts%2Fmusl.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fscripts%2Fmusl.sh?ref=9b13e403761797127fd19a7c13eeb2429eb1c139", "patch": "@@ -30,6 +30,8 @@ exit 1\n TAG=$1\n shift\n \n+export CFLAGS=\"-fPIC $CFLAGS\"\n+\n MUSL=musl-1.1.18\n \n # may have been downloaded in a previous run"}]}