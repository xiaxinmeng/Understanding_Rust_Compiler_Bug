{"sha": "7948b68d0229f34b538e3b26c596c7a3a68aee1d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc5NDhiNjhkMDIyOWYzNGI1MzhlM2IyNmM1OTZjN2EzYTY4YWVlMWQ=", "commit": {"author": {"name": "varkor", "email": "github@varkor.com", "date": "2019-05-06T13:53:22Z"}, "committer": {"name": "varkor", "email": "github@varkor.com", "date": "2019-05-24T00:27:32Z"}, "message": "Remove `ObsoleteInPlace`", "tree": {"sha": "55488fb80142d16ca12e1bc34fff2fbb53d75776", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/55488fb80142d16ca12e1bc34fff2fbb53d75776"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7948b68d0229f34b538e3b26c596c7a3a68aee1d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7948b68d0229f34b538e3b26c596c7a3a68aee1d", "html_url": "https://github.com/rust-lang/rust/commit/7948b68d0229f34b538e3b26c596c7a3a68aee1d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7948b68d0229f34b538e3b26c596c7a3a68aee1d/comments", "author": {"login": "varkor", "id": 3943692, "node_id": "MDQ6VXNlcjM5NDM2OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/3943692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/varkor", "html_url": "https://github.com/varkor", "followers_url": "https://api.github.com/users/varkor/followers", "following_url": "https://api.github.com/users/varkor/following{/other_user}", "gists_url": "https://api.github.com/users/varkor/gists{/gist_id}", "starred_url": "https://api.github.com/users/varkor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/varkor/subscriptions", "organizations_url": "https://api.github.com/users/varkor/orgs", "repos_url": "https://api.github.com/users/varkor/repos", "events_url": "https://api.github.com/users/varkor/events{/privacy}", "received_events_url": "https://api.github.com/users/varkor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "varkor", "id": 3943692, "node_id": "MDQ6VXNlcjM5NDM2OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/3943692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/varkor", "html_url": "https://github.com/varkor", "followers_url": "https://api.github.com/users/varkor/followers", "following_url": "https://api.github.com/users/varkor/following{/other_user}", "gists_url": "https://api.github.com/users/varkor/gists{/gist_id}", "starred_url": "https://api.github.com/users/varkor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/varkor/subscriptions", "organizations_url": "https://api.github.com/users/varkor/orgs", "repos_url": "https://api.github.com/users/varkor/repos", "events_url": "https://api.github.com/users/varkor/events{/privacy}", "received_events_url": "https://api.github.com/users/varkor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8869ee03d7f258e1b76a11c6fbb01b5708a9f504", "url": "https://api.github.com/repos/rust-lang/rust/commits/8869ee03d7f258e1b76a11c6fbb01b5708a9f504", "html_url": "https://github.com/rust-lang/rust/commit/8869ee03d7f258e1b76a11c6fbb01b5708a9f504"}], "stats": {"total": 78, "additions": 4, "deletions": 74}, "files": [{"sha": "3d83918bd0a661989ef1d7a78eac2504ae75e42a", "filename": "src/librustc/hir/lowering.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibrustc%2Fhir%2Flowering.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibrustc%2Fhir%2Flowering.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Flowering.rs?ref=7948b68d0229f34b538e3b26c596c7a3a68aee1d", "patch": "@@ -4062,10 +4062,6 @@ impl<'a> LoweringContext<'a> {\n     fn lower_expr(&mut self, e: &Expr) -> hir::Expr {\n         let kind = match e.node {\n             ExprKind::Box(ref inner) => hir::ExprKind::Box(P(self.lower_expr(inner))),\n-            ExprKind::ObsoleteInPlace(..) => {\n-                self.sess.abort_if_errors();\n-                span_bug!(e.span, \"encountered ObsoleteInPlace expr during lowering\");\n-            }\n             ExprKind::Array(ref exprs) => {\n                 hir::ExprKind::Array(exprs.iter().map(|x| self.lower_expr(x)).collect())\n             }"}, {"sha": "2afcbe8a151373bbc6ca64ae8c155e9d8c554c53", "filename": "src/librustc_passes/ast_validation.rs", "status": "modified", "additions": 0, "deletions": 23, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibrustc_passes%2Fast_validation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibrustc_passes%2Fast_validation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_passes%2Fast_validation.rs?ref=7948b68d0229f34b538e3b26c596c7a3a68aee1d", "patch": "@@ -454,29 +454,6 @@ impl<'a> Visitor<'a> for AstValidator<'a> {\n             ExprKind::InlineAsm(..) if !self.session.target.target.options.allow_asm => {\n                 span_err!(self.session, expr.span, E0472, \"asm! is unsupported on this target\");\n             }\n-            ExprKind::ObsoleteInPlace(ref place, ref val) => {\n-                let mut err = self.err_handler().struct_span_err(\n-                    expr.span,\n-                    \"emplacement syntax is obsolete (for now, anyway)\",\n-                );\n-                err.note(\n-                    \"for more information, see \\\n-                     <https://github.com/rust-lang/rust/issues/27779#issuecomment-378416911>\"\n-                );\n-                match val.node {\n-                    ExprKind::Lit(ref v) if v.node.is_numeric() => {\n-                        err.span_suggestion(\n-                            place.span.between(val.span),\n-                            \"if you meant to write a comparison against a negative value, add a \\\n-                             space in between `<` and `-`\",\n-                            \"< -\".to_string(),\n-                            Applicability::MaybeIncorrect\n-                        );\n-                    }\n-                    _ => {}\n-                }\n-                err.emit();\n-            }\n             _ => {}\n         }\n "}, {"sha": "3276f152575f7780e2d888594738d81a8ae9d3c3", "filename": "src/libsyntax/ast.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibsyntax%2Fast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibsyntax%2Fast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fast.rs?ref=7948b68d0229f34b538e3b26c596c7a3a68aee1d", "patch": "@@ -1037,7 +1037,6 @@ impl Expr {\n     pub fn precedence(&self) -> ExprPrecedence {\n         match self.node {\n             ExprKind::Box(_) => ExprPrecedence::Box,\n-            ExprKind::ObsoleteInPlace(..) => ExprPrecedence::ObsoleteInPlace,\n             ExprKind::Array(_) => ExprPrecedence::Array,\n             ExprKind::Call(..) => ExprPrecedence::Call,\n             ExprKind::MethodCall(..) => ExprPrecedence::MethodCall,\n@@ -1099,8 +1098,6 @@ pub enum RangeLimits {\n pub enum ExprKind {\n     /// A `box x` expression.\n     Box(P<Expr>),\n-    /// First expr is the place; second expr is the value.\n-    ObsoleteInPlace(P<Expr>, P<Expr>),\n     /// An array (`[a, b, c, d]`)\n     Array(Vec<P<Expr>>),\n     /// A function call"}, {"sha": "6a049b80acae225c851ab9af390fc92593ce82e3", "filename": "src/libsyntax/feature_gate.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibsyntax%2Ffeature_gate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibsyntax%2Ffeature_gate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ffeature_gate.rs?ref=7948b68d0229f34b538e3b26c596c7a3a68aee1d", "patch": "@@ -2117,9 +2117,6 @@ impl<'a> Visitor<'a> for PostExpansionVisitor<'a> {\n                                        \"type ascription is experimental\");\n                 }\n             }\n-            ast::ExprKind::ObsoleteInPlace(..) => {\n-                // these get a hard error in ast-validation\n-            }\n             ast::ExprKind::Yield(..) => {\n                 gate_feature_post!(&self, generators,\n                                   e.span,"}, {"sha": "0016c0d4d7e2b26ade57deeecdd568b5fb016c53", "filename": "src/libsyntax/mut_visit.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibsyntax%2Fmut_visit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibsyntax%2Fmut_visit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fmut_visit.rs?ref=7948b68d0229f34b538e3b26c596c7a3a68aee1d", "patch": "@@ -1099,10 +1099,6 @@ pub fn noop_visit_anon_const<T: MutVisitor>(AnonConst { id, value }: &mut AnonCo\n pub fn noop_visit_expr<T: MutVisitor>(Expr { node, id, span, attrs }: &mut Expr, vis: &mut T) {\n     match node {\n         ExprKind::Box(expr) => vis.visit_expr(expr),\n-        ExprKind::ObsoleteInPlace(a, b) => {\n-            vis.visit_expr(a);\n-            vis.visit_expr(b);\n-        }\n         ExprKind::Array(exprs) => visit_exprs(exprs, vis),\n         ExprKind::Repeat(expr, count) => {\n             vis.visit_expr(expr);"}, {"sha": "a3571cb0c0bc30d672231795b5e7989808c82d5c", "filename": "src/libsyntax/parse/parser.rs", "status": "modified", "additions": 0, "deletions": 16, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibsyntax%2Fparse%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibsyntax%2Fparse%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Fparser.rs?ref=7948b68d0229f34b538e3b26c596c7a3a68aee1d", "patch": "@@ -3252,17 +3252,6 @@ impl<'a> Parser<'a> {\n                 let (span, e) = self.interpolated_or_expr_span(e)?;\n                 (lo.to(span), ExprKind::AddrOf(m, e))\n             }\n-            token::Ident(..) if self.token.is_keyword(kw::In) => {\n-                self.bump();\n-                let place = self.parse_expr_res(\n-                    Restrictions::NO_STRUCT_LITERAL,\n-                    None,\n-                )?;\n-                let blk = self.parse_block()?;\n-                let span = blk.span;\n-                let blk_expr = self.mk_expr(span, ExprKind::Block(blk, None), ThinVec::new());\n-                (lo.to(span), ExprKind::ObsoleteInPlace(place, blk_expr))\n-            }\n             token::Ident(..) if self.token.is_keyword(kw::Box) => {\n                 self.bump();\n                 let e = self.parse_prefix_expr(None);\n@@ -3500,8 +3489,6 @@ impl<'a> Parser<'a> {\n                     self.mk_expr(span, binary, ThinVec::new())\n                 }\n                 AssocOp::Assign => self.mk_expr(span, ExprKind::Assign(lhs, rhs), ThinVec::new()),\n-                AssocOp::ObsoleteInPlace =>\n-                    self.mk_expr(span, ExprKind::ObsoleteInPlace(lhs, rhs), ThinVec::new()),\n                 AssocOp::AssignOp(k) => {\n                     let aop = match k {\n                         token::Plus =>    BinOpKind::Add,\n@@ -3820,9 +3807,6 @@ impl<'a> Parser<'a> {\n                 String::new(),\n                 Applicability::MachineApplicable,\n             );\n-            err.note(\"if you meant to use emplacement syntax, it is obsolete (for now, anyway)\");\n-            err.note(\"for more information on the status of emplacement syntax, see <\\\n-                      https://github.com/rust-lang/rust/issues/27779#issuecomment-378416911>\");\n             err.emit();\n         }\n         let expr = self.parse_expr_res(Restrictions::NO_STRUCT_LITERAL, None)?;"}, {"sha": "cf546332c2c9dde920ef7b292a05df82cc3c8b45", "filename": "src/libsyntax/print/pprust.rs", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibsyntax%2Fprint%2Fpprust.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibsyntax%2Fprint%2Fpprust.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fprint%2Fpprust.rs?ref=7948b68d0229f34b538e3b26c596c7a3a68aee1d", "patch": "@@ -2005,13 +2005,6 @@ impl<'a> State<'a> {\n                 self.word_space(\"box\")?;\n                 self.print_expr_maybe_paren(expr, parser::PREC_PREFIX)?;\n             }\n-            ast::ExprKind::ObsoleteInPlace(ref place, ref expr) => {\n-                let prec = AssocOp::ObsoleteInPlace.precedence() as i8;\n-                self.print_expr_maybe_paren(place, prec + 1)?;\n-                self.s.space()?;\n-                self.word_space(\"<-\")?;\n-                self.print_expr_maybe_paren(expr, prec)?;\n-            }\n             ast::ExprKind::Array(ref exprs) => {\n                 self.print_expr_vec(&exprs[..], attrs)?;\n             }"}, {"sha": "7e306d59e35ce5363fe946b03c24111a87c7fb14", "filename": "src/libsyntax/util/parser.rs", "status": "modified", "additions": 4, "deletions": 10, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibsyntax%2Futil%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibsyntax%2Futil%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Futil%2Fparser.rs?ref=7948b68d0229f34b538e3b26c596c7a3a68aee1d", "patch": "@@ -45,8 +45,6 @@ pub enum AssocOp {\n     GreaterEqual,\n     /// `=`\n     Assign,\n-    /// `<-`\n-    ObsoleteInPlace,\n     /// `?=` where ? is one of the BinOpToken\n     AssignOp(BinOpToken),\n     /// `as`\n@@ -75,7 +73,6 @@ impl AssocOp {\n         use AssocOp::*;\n         match *t {\n             Token::BinOpEq(k) => Some(AssignOp(k)),\n-            Token::LArrow => Some(ObsoleteInPlace),\n             Token::Eq => Some(Assign),\n             Token::BinOp(BinOpToken::Star) => Some(Multiply),\n             Token::BinOp(BinOpToken::Slash) => Some(Divide),\n@@ -145,7 +142,6 @@ impl AssocOp {\n             LAnd => 6,\n             LOr => 5,\n             DotDot | DotDotEq => 4,\n-            ObsoleteInPlace => 3,\n             Assign | AssignOp(_) => 2,\n         }\n     }\n@@ -155,7 +151,7 @@ impl AssocOp {\n         use AssocOp::*;\n         // NOTE: it is a bug to have an operators that has same precedence but different fixities!\n         match *self {\n-            ObsoleteInPlace | Assign | AssignOp(_) => Fixity::Right,\n+            Assign | AssignOp(_) => Fixity::Right,\n             As | Multiply | Divide | Modulus | Add | Subtract | ShiftLeft | ShiftRight | BitAnd |\n             BitXor | BitOr | Less | Greater | LessEqual | GreaterEqual | Equal | NotEqual |\n             LAnd | LOr | Colon => Fixity::Left,\n@@ -167,7 +163,7 @@ impl AssocOp {\n         use AssocOp::*;\n         match *self {\n             Less | Greater | LessEqual | GreaterEqual | Equal | NotEqual => true,\n-            ObsoleteInPlace | Assign | AssignOp(_) | As | Multiply | Divide | Modulus | Add |\n+            Assign | AssignOp(_) | As | Multiply | Divide | Modulus | Add |\n             Subtract | ShiftLeft | ShiftRight | BitAnd | BitXor | BitOr | LAnd | LOr |\n             DotDot | DotDotEq | Colon => false\n         }\n@@ -176,7 +172,7 @@ impl AssocOp {\n     pub fn is_assign_like(&self) -> bool {\n         use AssocOp::*;\n         match *self {\n-            Assign | AssignOp(_) | ObsoleteInPlace => true,\n+            Assign | AssignOp(_) => true,\n             Less | Greater | LessEqual | GreaterEqual | Equal | NotEqual | As | Multiply | Divide |\n             Modulus | Add | Subtract | ShiftLeft | ShiftRight | BitAnd | BitXor | BitOr | LAnd |\n             LOr | DotDot | DotDotEq | Colon => false\n@@ -204,7 +200,7 @@ impl AssocOp {\n             BitOr => Some(BinOpKind::BitOr),\n             LAnd => Some(BinOpKind::And),\n             LOr => Some(BinOpKind::Or),\n-            ObsoleteInPlace | Assign | AssignOp(_) | As | DotDot | DotDotEq | Colon => None\n+            Assign | AssignOp(_) | As | DotDot | DotDotEq | Colon => None\n         }\n     }\n \n@@ -256,7 +252,6 @@ pub enum ExprPrecedence {\n \n     Binary(BinOpKind),\n \n-    ObsoleteInPlace,\n     Cast,\n     Type,\n \n@@ -314,7 +309,6 @@ impl ExprPrecedence {\n \n             // Binop-like expr kinds, handled by `AssocOp`.\n             ExprPrecedence::Binary(op) => AssocOp::from_ast_binop(op).precedence() as i8,\n-            ExprPrecedence::ObsoleteInPlace => AssocOp::ObsoleteInPlace.precedence() as i8,\n             ExprPrecedence::Cast => AssocOp::As.precedence() as i8,\n             ExprPrecedence::Type => AssocOp::Colon.precedence() as i8,\n "}, {"sha": "4e096d68235b5c35c9823fc82b1dc0fa7a497731", "filename": "src/libsyntax/visit.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibsyntax%2Fvisit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7948b68d0229f34b538e3b26c596c7a3a68aee1d/src%2Flibsyntax%2Fvisit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fvisit.rs?ref=7948b68d0229f34b538e3b26c596c7a3a68aee1d", "patch": "@@ -676,10 +676,6 @@ pub fn walk_expr<'a, V: Visitor<'a>>(visitor: &mut V, expression: &'a Expr) {\n         ExprKind::Box(ref subexpression) => {\n             visitor.visit_expr(subexpression)\n         }\n-        ExprKind::ObsoleteInPlace(ref place, ref subexpression) => {\n-            visitor.visit_expr(place);\n-            visitor.visit_expr(subexpression)\n-        }\n         ExprKind::Array(ref subexpressions) => {\n             walk_list!(visitor, visit_expr, subexpressions);\n         }"}]}