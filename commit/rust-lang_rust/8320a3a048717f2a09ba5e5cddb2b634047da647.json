{"sha": "8320a3a048717f2a09ba5e5cddb2b634047da647", "node_id": "MDY6Q29tbWl0NzI0NzEyOjgzMjBhM2EwNDg3MTdmMmEwOWJhNWU1Y2RkYjJiNjM0MDQ3ZGE2NDc=", "commit": {"author": {"name": "William Throwe", "email": "wtt6@cornell.edu", "date": "2015-08-24T18:33:22Z"}, "committer": {"name": "William Throwe", "email": "wtt6@cornell.edu", "date": "2015-08-25T00:28:24Z"}, "message": "Remove #[start] as well as #[main] in --test\n\nFixes #11766.", "tree": {"sha": "c95fbde0f5dfda64b87d555b6db18747e7ac96a1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c95fbde0f5dfda64b87d555b6db18747e7ac96a1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8320a3a048717f2a09ba5e5cddb2b634047da647", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8320a3a048717f2a09ba5e5cddb2b634047da647", "html_url": "https://github.com/rust-lang/rust/commit/8320a3a048717f2a09ba5e5cddb2b634047da647", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8320a3a048717f2a09ba5e5cddb2b634047da647/comments", "author": {"login": "wthrowe", "id": 867117, "node_id": "MDQ6VXNlcjg2NzExNw==", "avatar_url": "https://avatars.githubusercontent.com/u/867117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wthrowe", "html_url": "https://github.com/wthrowe", "followers_url": "https://api.github.com/users/wthrowe/followers", "following_url": "https://api.github.com/users/wthrowe/following{/other_user}", "gists_url": "https://api.github.com/users/wthrowe/gists{/gist_id}", "starred_url": "https://api.github.com/users/wthrowe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wthrowe/subscriptions", "organizations_url": "https://api.github.com/users/wthrowe/orgs", "repos_url": "https://api.github.com/users/wthrowe/repos", "events_url": "https://api.github.com/users/wthrowe/events{/privacy}", "received_events_url": "https://api.github.com/users/wthrowe/received_events", "type": "User", "site_admin": false}, "committer": {"login": "wthrowe", "id": 867117, "node_id": "MDQ6VXNlcjg2NzExNw==", "avatar_url": "https://avatars.githubusercontent.com/u/867117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wthrowe", "html_url": "https://github.com/wthrowe", "followers_url": "https://api.github.com/users/wthrowe/followers", "following_url": "https://api.github.com/users/wthrowe/following{/other_user}", "gists_url": "https://api.github.com/users/wthrowe/gists{/gist_id}", "starred_url": "https://api.github.com/users/wthrowe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wthrowe/subscriptions", "organizations_url": "https://api.github.com/users/wthrowe/orgs", "repos_url": "https://api.github.com/users/wthrowe/repos", "events_url": "https://api.github.com/users/wthrowe/events{/privacy}", "received_events_url": "https://api.github.com/users/wthrowe/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0112e7bd159968d2ad2e5ea6727564c200b7c35f", "url": "https://api.github.com/repos/rust-lang/rust/commits/0112e7bd159968d2ad2e5ea6727564c200b7c35f", "html_url": "https://github.com/rust-lang/rust/commit/0112e7bd159968d2ad2e5ea6727564c200b7c35f"}], "stats": {"total": 31, "additions": 22, "deletions": 9}, "files": [{"sha": "7fb8cdde31170823cf404a5e9aa8c22cee7d0d1a", "filename": "src/libsyntax/test.rs", "status": "modified", "additions": 6, "deletions": 9, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/8320a3a048717f2a09ba5e5cddb2b634047da647/src%2Flibsyntax%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8320a3a048717f2a09ba5e5cddb2b634047da647/src%2Flibsyntax%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ftest.rs?ref=8320a3a048717f2a09ba5e5cddb2b634047da647", "patch": "@@ -202,8 +202,8 @@ impl fold::Folder for EntryPointCleaner {\n         let folded = fold::noop_fold_item(i, self).expect_one(\"noop did something\");\n         self.depth -= 1;\n \n-        // Remove any #[main] from the AST so it doesn't clash with\n-        // the one we're going to add, but mark it as\n+        // Remove any #[main] or #[start] from the AST so it doesn't\n+        // clash with the one we're going to add, but mark it as\n         // #[allow(dead_code)] to avoid printing warnings.\n         let folded = match entry::entry_point_type(&*folded, self.depth) {\n             EntryPointType::MainNamed |\n@@ -221,13 +221,10 @@ impl fold::Folder for EntryPointCleaner {\n                     ast::Item {\n                         id: id,\n                         ident: ident,\n-                        attrs: attrs.into_iter().filter_map(|attr| {\n-                            if !attr.check_name(\"main\") {\n-                                Some(attr)\n-                            } else {\n-                                None\n-                            }\n-                        })\n+                        attrs: attrs.into_iter()\n+                            .filter(|attr| {\n+                                !attr.check_name(\"main\") && !attr.check_name(\"start\")\n+                            })\n                             .chain(iter::once(allow_dead_code))\n                             .collect(),\n                         node: node,"}, {"sha": "fc94b19ada1fb2b08ed19c335809f63f0274e776", "filename": "src/test/run-pass/test-runner-hides-start.rs", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/8320a3a048717f2a09ba5e5cddb2b634047da647/src%2Ftest%2Frun-pass%2Ftest-runner-hides-start.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8320a3a048717f2a09ba5e5cddb2b634047da647/src%2Ftest%2Frun-pass%2Ftest-runner-hides-start.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Ftest-runner-hides-start.rs?ref=8320a3a048717f2a09ba5e5cddb2b634047da647", "patch": "@@ -0,0 +1,16 @@\n+// Copyright 2015 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// compile-flags: --test\n+\n+#![feature(start)]\n+\n+#[start]\n+fn start(_: isize, _: *const *const u8) -> isize { panic!(); }"}]}