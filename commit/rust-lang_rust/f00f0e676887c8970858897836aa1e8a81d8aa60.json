{"sha": "f00f0e676887c8970858897836aa1e8a81d8aa60", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYwMGYwZTY3Njg4N2M4OTcwODU4ODk3ODM2YWExZThhODFkOGFhNjA=", "commit": {"author": {"name": "Nick Fitzgerald", "email": "fitzgen@gmail.com", "date": "2019-02-08T09:04:32Z"}, "committer": {"name": "Nick Fitzgerald", "email": "fitzgen@gmail.com", "date": "2019-02-08T09:09:36Z"}, "message": "Don't shadow the provided `stringify!` macro in a wasm code size test case", "tree": {"sha": "5772349dac53b2e05540112d7542f277debb58f0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5772349dac53b2e05540112d7542f277debb58f0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f00f0e676887c8970858897836aa1e8a81d8aa60", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f00f0e676887c8970858897836aa1e8a81d8aa60", "html_url": "https://github.com/rust-lang/rust/commit/f00f0e676887c8970858897836aa1e8a81d8aa60", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f00f0e676887c8970858897836aa1e8a81d8aa60/comments", "author": {"login": "fitzgen", "id": 74571, "node_id": "MDQ6VXNlcjc0NTcx", "avatar_url": "https://avatars.githubusercontent.com/u/74571?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fitzgen", "html_url": "https://github.com/fitzgen", "followers_url": "https://api.github.com/users/fitzgen/followers", "following_url": "https://api.github.com/users/fitzgen/following{/other_user}", "gists_url": "https://api.github.com/users/fitzgen/gists{/gist_id}", "starred_url": "https://api.github.com/users/fitzgen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fitzgen/subscriptions", "organizations_url": "https://api.github.com/users/fitzgen/orgs", "repos_url": "https://api.github.com/users/fitzgen/repos", "events_url": "https://api.github.com/users/fitzgen/events{/privacy}", "received_events_url": "https://api.github.com/users/fitzgen/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fitzgen", "id": 74571, "node_id": "MDQ6VXNlcjc0NTcx", "avatar_url": "https://avatars.githubusercontent.com/u/74571?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fitzgen", "html_url": "https://github.com/fitzgen", "followers_url": "https://api.github.com/users/fitzgen/followers", "following_url": "https://api.github.com/users/fitzgen/following{/other_user}", "gists_url": "https://api.github.com/users/fitzgen/gists{/gist_id}", "starred_url": "https://api.github.com/users/fitzgen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fitzgen/subscriptions", "organizations_url": "https://api.github.com/users/fitzgen/orgs", "repos_url": "https://api.github.com/users/fitzgen/repos", "events_url": "https://api.github.com/users/fitzgen/events{/privacy}", "received_events_url": "https://api.github.com/users/fitzgen/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8fea7054b9c77a7dcf242ce84cfc0a58d81a9c00", "url": "https://api.github.com/repos/rust-lang/rust/commits/8fea7054b9c77a7dcf242ce84cfc0a58d81a9c00", "html_url": "https://github.com/rust-lang/rust/commit/8fea7054b9c77a7dcf242ce84cfc0a58d81a9c00"}], "stats": {"total": 40, "additions": 17, "deletions": 23}, "files": [{"sha": "7a947f013ad486f1adc58f027e2a88253f501e9b", "filename": "src/test/run-make/wasm-stringify-ints-small/foo.rs", "status": "modified", "additions": 17, "deletions": 23, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/f00f0e676887c8970858897836aa1e8a81d8aa60/src%2Ftest%2Frun-make%2Fwasm-stringify-ints-small%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f00f0e676887c8970858897836aa1e8a81d8aa60/src%2Ftest%2Frun-make%2Fwasm-stringify-ints-small%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fwasm-stringify-ints-small%2Ffoo.rs?ref=f00f0e676887c8970858897836aa1e8a81d8aa60", "patch": "@@ -2,22 +2,14 @@\n \n extern \"C\" {\n     fn observe(ptr: *const u8, len: usize);\n-\n-    fn get_u8() -> u8;\n-    fn get_i8() -> i8;\n-    fn get_u16() -> u16;\n-    fn get_i16() -> i16;\n-    fn get_u32() -> u32;\n-    fn get_i32() -> i32;\n-    fn get_u64() -> u64;\n-    fn get_i64() -> i64;\n-    fn get_usize() -> usize;\n-    fn get_isize() -> isize;\n }\n \n-macro_rules! stringify {\n-    ( $($f:ident)* ) => {\n+macro_rules! s {\n+    ( $( $f:ident -> $t:ty );* $(;)* ) => {\n         $(\n+            extern \"C\" {\n+                fn $f() -> $t;\n+            }\n             let s = $f().to_string();\n             observe(s.as_ptr(), s.len());\n         )*\n@@ -26,14 +18,16 @@ macro_rules! stringify {\n \n #[no_mangle]\n pub unsafe extern \"C\" fn foo() {\n-    stringify!(get_u8);\n-    stringify!(get_i8);\n-    stringify!(get_u16);\n-    stringify!(get_i16);\n-    stringify!(get_u32);\n-    stringify!(get_i32);\n-    stringify!(get_u64);\n-    stringify!(get_i64);\n-    stringify!(get_usize);\n-    stringify!(get_isize);\n+    s! {\n+        get_u8 -> u8;\n+        get_i8 -> i8;\n+        get_u16 -> u16;\n+        get_i16 -> i16;\n+        get_u32 -> u32;\n+        get_i32 -> i32;\n+        get_u64 -> u64;\n+        get_i64 -> i64;\n+        get_usize -> usize;\n+        get_isize -> isize;\n+    }\n }"}]}