{"sha": "cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNiZDM3MTdmMmM1MmIxN2FhOWIxNWMyZGY0YTM2NGM2MmQxN2U0ZTE=", "commit": {"author": {"name": "Kirill Bulatov", "email": "mail4score@gmail.com", "date": "2020-12-08T12:27:18Z"}, "committer": {"name": "Kirill Bulatov", "email": "mail4score@gmail.com", "date": "2020-12-08T12:27:18Z"}, "message": "Better config name", "tree": {"sha": "288fb7dea2b2ef504ae6f8d87d8fc74d043625da", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/288fb7dea2b2ef504ae6f8d87d8fc74d043625da"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1", "html_url": "https://github.com/rust-lang/rust/commit/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1/comments", "author": {"login": "SomeoneToIgnore", "id": 2690773, "node_id": "MDQ6VXNlcjI2OTA3NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/2690773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SomeoneToIgnore", "html_url": "https://github.com/SomeoneToIgnore", "followers_url": "https://api.github.com/users/SomeoneToIgnore/followers", "following_url": "https://api.github.com/users/SomeoneToIgnore/following{/other_user}", "gists_url": "https://api.github.com/users/SomeoneToIgnore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SomeoneToIgnore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SomeoneToIgnore/subscriptions", "organizations_url": "https://api.github.com/users/SomeoneToIgnore/orgs", "repos_url": "https://api.github.com/users/SomeoneToIgnore/repos", "events_url": "https://api.github.com/users/SomeoneToIgnore/events{/privacy}", "received_events_url": "https://api.github.com/users/SomeoneToIgnore/received_events", "type": "User", "site_admin": false}, "committer": {"login": "SomeoneToIgnore", "id": 2690773, "node_id": "MDQ6VXNlcjI2OTA3NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/2690773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SomeoneToIgnore", "html_url": "https://github.com/SomeoneToIgnore", "followers_url": "https://api.github.com/users/SomeoneToIgnore/followers", "following_url": "https://api.github.com/users/SomeoneToIgnore/following{/other_user}", "gists_url": "https://api.github.com/users/SomeoneToIgnore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SomeoneToIgnore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SomeoneToIgnore/subscriptions", "organizations_url": "https://api.github.com/users/SomeoneToIgnore/orgs", "repos_url": "https://api.github.com/users/SomeoneToIgnore/repos", "events_url": "https://api.github.com/users/SomeoneToIgnore/events{/privacy}", "received_events_url": "https://api.github.com/users/SomeoneToIgnore/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3183ff3a7b1fbcf3cb5379cf162a3d769a21be7a", "url": "https://api.github.com/repos/rust-lang/rust/commits/3183ff3a7b1fbcf3cb5379cf162a3d769a21be7a", "html_url": "https://github.com/rust-lang/rust/commit/3183ff3a7b1fbcf3cb5379cf162a3d769a21be7a"}], "stats": {"total": 35, "additions": 19, "deletions": 16}, "files": [{"sha": "f65709adf0bf25a33eddc6468f13cf7ff4cd77b6", "filename": "crates/completion/src/completions/unqualified_path.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1/crates%2Fcompletion%2Fsrc%2Fcompletions%2Funqualified_path.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1/crates%2Fcompletion%2Fsrc%2Fcompletions%2Funqualified_path.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2Fsrc%2Fcompletions%2Funqualified_path.rs?ref=cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1", "patch": "@@ -44,7 +44,7 @@ pub(crate) fn complete_unqualified_path(acc: &mut Completions, ctx: &CompletionC\n         acc.add_resolution(ctx, name.to_string(), &res)\n     });\n \n-    if !ctx.config.disable_fuzzy_autoimports && ctx.config.resolve_additional_edits_lazily() {\n+    if ctx.config.enable_autoimport_completions && ctx.config.resolve_additional_edits_lazily() {\n         fuzzy_completion(acc, ctx).unwrap_or_default()\n     }\n }\n@@ -116,7 +116,9 @@ fn complete_enum_variants(acc: &mut Completions, ctx: &CompletionContext, ty: &T\n //\n // .Feature toggle\n //\n-// The feature can be forcefully turned off in the settings with the `rust-analyzer.completion.disableFuzzyAutoimports` flag.\n+// The feature can be forcefully turned off in the settings with the `rust-analyzer.completion.enableAutoimportCompletions` flag.\n+// Note that having this flag set to `true` does not guarantee that the feature is enabled: your client needs to have the corredponding\n+// capability enabled.\n fn fuzzy_completion(acc: &mut Completions, ctx: &CompletionContext) -> Option<()> {\n     let _p = profile::span(\"fuzzy_completion\");\n     let potential_import_name = ctx.token.to_string();"}, {"sha": "5175b9d69dc2517a7f585dfd6bb6d0a2245e62c2", "filename": "crates/completion/src/config.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1/crates%2Fcompletion%2Fsrc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1/crates%2Fcompletion%2Fsrc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2Fsrc%2Fconfig.rs?ref=cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1", "patch": "@@ -10,7 +10,7 @@ use rustc_hash::FxHashSet;\n #[derive(Clone, Debug, PartialEq, Eq)]\n pub struct CompletionConfig {\n     pub enable_postfix_completions: bool,\n-    pub disable_fuzzy_autoimports: bool,\n+    pub enable_autoimport_completions: bool,\n     pub add_call_parenthesis: bool,\n     pub add_call_argument_snippets: bool,\n     pub snippet_cap: Option<SnippetCap>,\n@@ -52,7 +52,7 @@ impl Default for CompletionConfig {\n     fn default() -> Self {\n         CompletionConfig {\n             enable_postfix_completions: true,\n-            disable_fuzzy_autoimports: false,\n+            enable_autoimport_completions: true,\n             add_call_parenthesis: true,\n             add_call_argument_snippets: true,\n             snippet_cap: Some(SnippetCap { _private: () }),"}, {"sha": "f60f87243fb03862c4faee8045284addbce4ffaa", "filename": "crates/completion/src/lib.rs", "status": "modified", "additions": 3, "deletions": 6, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1/crates%2Fcompletion%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1/crates%2Fcompletion%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2Fsrc%2Flib.rs?ref=cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1", "patch": "@@ -73,12 +73,9 @@ pub use crate::{\n // }\n // ```\n //\n-// And experimental completions, enabled with the `rust-analyzer.completion.disableFuzzyAutoimports` setting.\n-// This flag enables or disables:\n-//\n-// - Auto import: additional completion options with automatic `use` import and options from all project importable items, matched for the input\n-//\n-// Experimental completions might cause issues with performance and completion list look.\n+// And the auto import completions, enabled with the `rust-analyzer.completion.autoimport.enable` setting and the corresponding LSP client capabilities.\n+// Those are the additional completion options with automatic `use` import and options from all project importable items,\n+// fuzzy matched agains the completion imput.\n \n /// Main entry point for completion. We run completion as a two-phase process.\n ///"}, {"sha": "5e4c22bc5c88c1e7e28303b293655c54a8f67bd7", "filename": "crates/rust-analyzer/src/caps.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1/crates%2Frust-analyzer%2Fsrc%2Fcaps.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1/crates%2Frust-analyzer%2Fsrc%2Fcaps.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fcaps.rs?ref=cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1", "patch": "@@ -97,6 +97,7 @@ pub fn server_capabilities(client_caps: &ClientCapabilities) -> ServerCapabiliti\n \n fn completions_resolve_provider(client_caps: &ClientCapabilities) -> Option<bool> {\n     if enabled_completions_resolve_capabilities(client_caps)?.is_empty() {\n+        log::info!(\"No `additionalTextEdits` completion resolve capability was found in the client capabilities, autoimport completion is disabled\");\n         None\n     } else {\n         Some(true)"}, {"sha": "5243b50c801c47e71d19e942c381280e2f5ff618", "filename": "crates/rust-analyzer/src/config.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs?ref=cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1", "patch": "@@ -182,7 +182,7 @@ impl Config {\n             },\n             completion: CompletionConfig {\n                 enable_postfix_completions: true,\n-                disable_fuzzy_autoimports: false,\n+                enable_autoimport_completions: true,\n                 add_call_parenthesis: true,\n                 add_call_argument_snippets: true,\n                 ..CompletionConfig::default()\n@@ -305,7 +305,7 @@ impl Config {\n         };\n \n         self.completion.enable_postfix_completions = data.completion_postfix_enable;\n-        self.completion.disable_fuzzy_autoimports = data.completion_disableFuzzyAutoimports;\n+        self.completion.enable_autoimport_completions = data.completion_autoimport_enable;\n         self.completion.add_call_parenthesis = data.completion_addCallParenthesis;\n         self.completion.add_call_argument_snippets = data.completion_addCallArgumentSnippets;\n         self.completion.merge = self.assist.insert_use.merge;\n@@ -508,7 +508,7 @@ config_data! {\n         completion_addCallArgumentSnippets: bool = true,\n         completion_addCallParenthesis: bool      = true,\n         completion_postfix_enable: bool          = true,\n-        completion_disableFuzzyAutoimports: bool = false,\n+        completion_autoimport_enable: bool       = true,\n \n         diagnostics_enable: bool                = true,\n         diagnostics_enableExperimental: bool    = true,"}, {"sha": "dbde37005c92aae22d848b26f6e6e20c3be41853", "filename": "editors/code/package.json", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1/editors%2Fcode%2Fpackage.json", "raw_url": "https://github.com/rust-lang/rust/raw/cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1/editors%2Fcode%2Fpackage.json", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fpackage.json?ref=cbd3717f2c52b17aa9b15c2df4a364c62d17e4e1", "patch": "@@ -460,10 +460,13 @@\n                     \"default\": true,\n                     \"markdownDescription\": \"Whether to show postfix snippets like `dbg`, `if`, `not`, etc.\"\n                 },\n-                \"rust-analyzer.completion.disableFuzzyAutoimports\": {\n+                \"rust-analyzer.completion.autoimport.enable\": {\n                     \"type\": \"boolean\",\n-                    \"default\": false,\n-                    \"markdownDescription\": \"Turns off extra completion suggestions that might be too noisy or slow\"\n+                    \"default\": true,\n+                    \"markdownDescription\": [\n+                        \"Toggles the additional completions that automatically add imports when completed.\",\n+                        \"Note that your client have to specify the `additionalTextEdits` LSP client capability to truly have this feature enabled\"\n+                    ]\n                 },\n                 \"rust-analyzer.callInfo.full\": {\n                     \"type\": \"boolean\","}]}