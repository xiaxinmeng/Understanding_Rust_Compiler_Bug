{"sha": "ae5473c9699eaf1998c414e0a8884383bb9ddcc3", "node_id": "C_kwDOAAsO6NoAKGFlNTQ3M2M5Njk5ZWFmMTk5OGM0MTRlMGE4ODg0MzgzYmI5ZGRjYzM", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-02-17T11:39:07Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-02-17T11:39:07Z"}, "message": "Rollup merge of #108154 - scottmcm:start-block-cleanup, r=compiler-errors\n\n`BasicBlock::new(0)` -> `START_BLOCK` [no functional changes]", "tree": {"sha": "818357e6dda6fb34df21d07e06fb1b165edbcb6b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/818357e6dda6fb34df21d07e06fb1b165edbcb6b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ae5473c9699eaf1998c414e0a8884383bb9ddcc3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJj72dbCRBK7hj4Ov3rIwAAZeQIAJqg1ONp7QDJcP3K2C6OJrkQ\nxrIF9gDSZ5rxIvJyOJG0ovGxa4ZutJ7uCBgF+NgyW7hy5iArHjfzDt2QG66+9VvD\n2zVlRhm0zegUda3ANKaEnqSGLPZBuCNopauJTZjWbkHVzIIPWedA0zBa+Dc/W8QS\nuqDKXHhrKObElIIr+M/bqtZ4g7grCBVAw6sVQr8Kc5ci4sF5k0kZk5NJ4d+aP6U3\ngvwVST0jnbwOV8PJXLYBXDo7fJTOuTXvDc+3W/zpx1VbsBJwwmPMMJmofKhywPlu\n8UrSg6CiVqtgHrNWICLwiHB/fHVAHMA3odBgI3dZyB0ZSGg6Dk5lwyGoSo7FdLU=\n=l74/\n-----END PGP SIGNATURE-----\n", "payload": "tree 818357e6dda6fb34df21d07e06fb1b165edbcb6b\nparent 392b150011037960d609b694ee87f3d38ad641af\nparent c946494c34d7b3d95591893541038b1fb736653d\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1676633947 +0100\ncommitter GitHub <noreply@github.com> 1676633947 +0100\n\nRollup merge of #108154 - scottmcm:start-block-cleanup, r=compiler-errors\n\n`BasicBlock::new(0)` -> `START_BLOCK` [no functional changes]\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ae5473c9699eaf1998c414e0a8884383bb9ddcc3", "html_url": "https://github.com/rust-lang/rust/commit/ae5473c9699eaf1998c414e0a8884383bb9ddcc3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ae5473c9699eaf1998c414e0a8884383bb9ddcc3/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "392b150011037960d609b694ee87f3d38ad641af", "url": "https://api.github.com/repos/rust-lang/rust/commits/392b150011037960d609b694ee87f3d38ad641af", "html_url": "https://github.com/rust-lang/rust/commit/392b150011037960d609b694ee87f3d38ad641af"}, {"sha": "c946494c34d7b3d95591893541038b1fb736653d", "url": "https://api.github.com/repos/rust-lang/rust/commits/c946494c34d7b3d95591893541038b1fb736653d", "html_url": "https://github.com/rust-lang/rust/commit/c946494c34d7b3d95591893541038b1fb736653d"}], "stats": {"total": 24, "additions": 12, "deletions": 12}, "files": [{"sha": "19367d708ee746f12364bc4c258cc216a6e91c59", "filename": "compiler/rustc_const_eval/src/transform/promote_consts.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ae5473c9699eaf1998c414e0a8884383bb9ddcc3/compiler%2Frustc_const_eval%2Fsrc%2Ftransform%2Fpromote_consts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ae5473c9699eaf1998c414e0a8884383bb9ddcc3/compiler%2Frustc_const_eval%2Fsrc%2Ftransform%2Fpromote_consts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_const_eval%2Fsrc%2Ftransform%2Fpromote_consts.rs?ref=ae5473c9699eaf1998c414e0a8884383bb9ddcc3", "patch": "@@ -898,7 +898,7 @@ impl<'a, 'tcx> Promoter<'a, 'tcx> {\n         assert_eq!(self.new_block(), START_BLOCK);\n         self.visit_rvalue(\n             &mut rvalue,\n-            Location { block: BasicBlock::new(0), statement_index: usize::MAX },\n+            Location { block: START_BLOCK, statement_index: usize::MAX },\n         );\n \n         let span = self.promoted.span;"}, {"sha": "443c1b2d261ef4af9df067145bf556955ea2536d", "filename": "compiler/rustc_middle/src/mir/visit.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/ae5473c9699eaf1998c414e0a8884383bb9ddcc3/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fvisit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ae5473c9699eaf1998c414e0a8884383bb9ddcc3/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fvisit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fvisit.rs?ref=ae5473c9699eaf1998c414e0a8884383bb9ddcc3", "patch": "@@ -323,7 +323,7 @@ macro_rules! make_mir_visitor {\n                     self.visit_source_scope($(& $mutability)? *parent_scope);\n                 }\n                 if let Some((callee, callsite_span)) = inlined {\n-                    let location = START_BLOCK.start_location();\n+                    let location = Location::START;\n \n                     self.visit_span($(& $mutability)? *callsite_span);\n \n@@ -837,7 +837,7 @@ macro_rules! make_mir_visitor {\n                 } = var_debug_info;\n \n                 self.visit_source_info(source_info);\n-                let location = START_BLOCK.start_location();\n+                let location = Location::START;\n                 match value {\n                     VarDebugInfoContents::Const(c) => self.visit_constant(c, location),\n                     VarDebugInfoContents::Place(place) =>\n@@ -1026,7 +1026,7 @@ macro_rules! super_body {\n         $self.visit_span($(& $mutability)? $body.span);\n \n         for const_ in &$($mutability)? $body.required_consts {\n-            let location = START_BLOCK.start_location();\n+            let location = Location::START;\n             $self.visit_constant(const_, location);\n         }\n     }"}, {"sha": "2e481b972781c349bdc361ee183e7930aa77626d", "filename": "compiler/rustc_mir_transform/src/dest_prop.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/ae5473c9699eaf1998c414e0a8884383bb9ddcc3/compiler%2Frustc_mir_transform%2Fsrc%2Fdest_prop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ae5473c9699eaf1998c414e0a8884383bb9ddcc3/compiler%2Frustc_mir_transform%2Fsrc%2Fdest_prop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_transform%2Fsrc%2Fdest_prop.rs?ref=ae5473c9699eaf1998c414e0a8884383bb9ddcc3", "patch": "@@ -136,8 +136,8 @@ use rustc_index::bit_set::BitSet;\n use rustc_middle::mir::visit::{MutVisitor, PlaceContext, Visitor};\n use rustc_middle::mir::{dump_mir, PassWhere};\n use rustc_middle::mir::{\n-    traversal, BasicBlock, Body, InlineAsmOperand, Local, LocalKind, Location, Operand, Place,\n-    Rvalue, Statement, StatementKind, TerminatorKind,\n+    traversal, Body, InlineAsmOperand, Local, LocalKind, Location, Operand, Place, Rvalue,\n+    Statement, StatementKind, TerminatorKind,\n };\n use rustc_middle::ty::TyCtxt;\n use rustc_mir_dataflow::impls::MaybeLiveLocals;\n@@ -468,7 +468,7 @@ impl<'a, 'body, 'alloc, 'tcx> FilterInformation<'a, 'body, 'alloc, 'tcx> {\n             // to reuse the allocation.\n             write_info: write_info_alloc,\n             // Doesn't matter what we put here, will be overwritten before being used\n-            at: Location { block: BasicBlock::from_u32(0), statement_index: 0 },\n+            at: Location::START,\n         };\n         this.internal_filter_liveness();\n     }"}, {"sha": "dc5f88f24f801770849a2b62c06340156408682c", "filename": "compiler/rustc_mir_transform/src/generator.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/ae5473c9699eaf1998c414e0a8884383bb9ddcc3/compiler%2Frustc_mir_transform%2Fsrc%2Fgenerator.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ae5473c9699eaf1998c414e0a8884383bb9ddcc3/compiler%2Frustc_mir_transform%2Fsrc%2Fgenerator.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_transform%2Fsrc%2Fgenerator.rs?ref=ae5473c9699eaf1998c414e0a8884383bb9ddcc3", "patch": "@@ -487,7 +487,7 @@ fn transform_async_context<'tcx>(tcx: TyCtxt<'tcx>, body: &mut Body<'tcx>) {\n \n     let get_context_def_id = tcx.require_lang_item(LangItem::GetContext, None);\n \n-    for bb in BasicBlock::new(0)..body.basic_blocks.next_index() {\n+    for bb in START_BLOCK..body.basic_blocks.next_index() {\n         let bb_data = &body[bb];\n         if bb_data.is_cleanup {\n             continue;\n@@ -1255,7 +1255,7 @@ fn create_generator_resume_function<'tcx>(\n     use rustc_middle::mir::AssertKind::{ResumedAfterPanic, ResumedAfterReturn};\n \n     // Jump to the entry point on the unresumed\n-    cases.insert(0, (UNRESUMED, BasicBlock::new(0)));\n+    cases.insert(0, (UNRESUMED, START_BLOCK));\n \n     // Panic when resumed on the returned or poisoned state\n     let generator_kind = body.generator_kind().unwrap();\n@@ -1481,7 +1481,7 @@ impl<'tcx> MirPass<'tcx> for StateTransform {\n \n         // When first entering the generator, move the resume argument into its new local.\n         let source_info = SourceInfo::outermost(body.span);\n-        let stmts = &mut body.basic_blocks_mut()[BasicBlock::new(0)].statements;\n+        let stmts = &mut body.basic_blocks_mut()[START_BLOCK].statements;\n         stmts.insert(\n             0,\n             Statement {"}, {"sha": "8c6b0463a739a04a0d2b9aa2fbb076948f15520a", "filename": "compiler/rustc_mir_transform/src/inline.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ae5473c9699eaf1998c414e0a8884383bb9ddcc3/compiler%2Frustc_mir_transform%2Fsrc%2Finline.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ae5473c9699eaf1998c414e0a8884383bb9ddcc3/compiler%2Frustc_mir_transform%2Fsrc%2Finline.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_transform%2Fsrc%2Finline.rs?ref=ae5473c9699eaf1998c414e0a8884383bb9ddcc3", "patch": "@@ -96,7 +96,7 @@ fn inline<'tcx>(tcx: TyCtxt<'tcx>, body: &mut Body<'tcx>) -> bool {\n         history: Vec::new(),\n         changed: false,\n     };\n-    let blocks = BasicBlock::new(0)..body.basic_blocks.next_index();\n+    let blocks = START_BLOCK..body.basic_blocks.next_index();\n     this.process_blocks(body, blocks);\n     this.changed\n }"}, {"sha": "9ef55c558c60b8f593024d473d7bd281680c6a39", "filename": "compiler/rustc_mir_transform/src/simplify.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ae5473c9699eaf1998c414e0a8884383bb9ddcc3/compiler%2Frustc_mir_transform%2Fsrc%2Fsimplify.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ae5473c9699eaf1998c414e0a8884383bb9ddcc3/compiler%2Frustc_mir_transform%2Fsrc%2Fsimplify.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_transform%2Fsrc%2Fsimplify.rs?ref=ae5473c9699eaf1998c414e0a8884383bb9ddcc3", "patch": "@@ -496,7 +496,7 @@ impl UsedLocals {\n         self.increment = false;\n \n         // The location of the statement is irrelevant.\n-        let location = Location { block: START_BLOCK, statement_index: 0 };\n+        let location = Location::START;\n         self.visit_statement(statement, location);\n     }\n "}]}