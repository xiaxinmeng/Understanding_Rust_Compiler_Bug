{"sha": "897a4c702e3d6fa9156ea0bc34af9d397fae3440", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg5N2E0YzcwMmUzZDZmYTkxNTZlYTBiYzM0YWY5ZDM5N2ZhZTM0NDA=", "commit": {"author": {"name": "Kirill Bulatov", "email": "mail4score@gmail.com", "date": "2020-09-04T12:05:56Z"}, "committer": {"name": "Kirill Bulatov", "email": "mail4score@gmail.com", "date": "2020-09-09T22:42:20Z"}, "message": "Implement file name & extension retrieval method for VirtualPath", "tree": {"sha": "bb0f1acb80c6eb214394c1a7481355dccf4a789f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bb0f1acb80c6eb214394c1a7481355dccf4a789f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/897a4c702e3d6fa9156ea0bc34af9d397fae3440", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/897a4c702e3d6fa9156ea0bc34af9d397fae3440", "html_url": "https://github.com/rust-lang/rust/commit/897a4c702e3d6fa9156ea0bc34af9d397fae3440", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/897a4c702e3d6fa9156ea0bc34af9d397fae3440/comments", "author": {"login": "SomeoneToIgnore", "id": 2690773, "node_id": "MDQ6VXNlcjI2OTA3NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/2690773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SomeoneToIgnore", "html_url": "https://github.com/SomeoneToIgnore", "followers_url": "https://api.github.com/users/SomeoneToIgnore/followers", "following_url": "https://api.github.com/users/SomeoneToIgnore/following{/other_user}", "gists_url": "https://api.github.com/users/SomeoneToIgnore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SomeoneToIgnore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SomeoneToIgnore/subscriptions", "organizations_url": "https://api.github.com/users/SomeoneToIgnore/orgs", "repos_url": "https://api.github.com/users/SomeoneToIgnore/repos", "events_url": "https://api.github.com/users/SomeoneToIgnore/events{/privacy}", "received_events_url": "https://api.github.com/users/SomeoneToIgnore/received_events", "type": "User", "site_admin": false}, "committer": {"login": "SomeoneToIgnore", "id": 2690773, "node_id": "MDQ6VXNlcjI2OTA3NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/2690773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SomeoneToIgnore", "html_url": "https://github.com/SomeoneToIgnore", "followers_url": "https://api.github.com/users/SomeoneToIgnore/followers", "following_url": "https://api.github.com/users/SomeoneToIgnore/following{/other_user}", "gists_url": "https://api.github.com/users/SomeoneToIgnore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SomeoneToIgnore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SomeoneToIgnore/subscriptions", "organizations_url": "https://api.github.com/users/SomeoneToIgnore/orgs", "repos_url": "https://api.github.com/users/SomeoneToIgnore/repos", "events_url": "https://api.github.com/users/SomeoneToIgnore/events{/privacy}", "received_events_url": "https://api.github.com/users/SomeoneToIgnore/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d163f9f114c8180bec6285ad9962fabbf3af5b18", "url": "https://api.github.com/repos/rust-lang/rust/commits/d163f9f114c8180bec6285ad9962fabbf3af5b18", "html_url": "https://github.com/rust-lang/rust/commit/d163f9f114c8180bec6285ad9962fabbf3af5b18"}], "stats": {"total": 22, "additions": 20, "deletions": 2}, "files": [{"sha": "113c2e4e6575cad8486fea88d072e7ad6ccee582", "filename": "crates/vfs/src/vfs_path.rs", "status": "modified", "additions": 20, "deletions": 2, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/897a4c702e3d6fa9156ea0bc34af9d397fae3440/crates%2Fvfs%2Fsrc%2Fvfs_path.rs", "raw_url": "https://github.com/rust-lang/rust/raw/897a4c702e3d6fa9156ea0bc34af9d397fae3440/crates%2Fvfs%2Fsrc%2Fvfs_path.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fvfs%2Fsrc%2Fvfs_path.rs?ref=897a4c702e3d6fa9156ea0bc34af9d397fae3440", "patch": "@@ -287,8 +287,26 @@ impl VirtualPath {\n         Some(res)\n     }\n \n+    // FIXME: Currently VirtualPath does is unable to distinguish a directory from a file\n+    // hence this method will return `Some(\"directory_name\", None)` for a directory\n     pub fn file_name_and_extension(&self) -> Option<(&str, Option<&str>)> {\n-        // TODO kb check if is a file\n-        Some((\"test_mod_1\", Some(\"rs\")))\n+        let file_name = match self.0.rfind('/') {\n+            Some(position) => &self.0[position + 1..],\n+            None => &self.0,\n+        };\n+\n+        if file_name.is_empty() {\n+            None\n+        } else {\n+            let mut file_stem_and_extension = file_name.rsplitn(2, '.');\n+            let extension = file_stem_and_extension.next();\n+            let file_stem = file_stem_and_extension.next();\n+\n+            match (file_stem, extension) {\n+                (None, None) => None,\n+                (None, Some(_)) | (Some(\"\"), Some(_)) => Some((file_name, None)),\n+                (Some(file_stem), extension) => Some((file_stem, extension)),\n+            }\n+        }\n     }\n }"}]}