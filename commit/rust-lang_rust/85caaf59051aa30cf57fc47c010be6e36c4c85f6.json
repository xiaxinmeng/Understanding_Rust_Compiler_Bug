{"sha": "85caaf59051aa30cf57fc47c010be6e36c4c85f6", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg1Y2FhZjU5MDUxYWEzMGNmNTdmYzQ3YzAxMGJlNmUzNmM0Yzg1ZjY=", "commit": {"author": {"name": "Eduard-Mihai Burtescu", "email": "edy.burt@gmail.com", "date": "2018-09-15T07:56:03Z"}, "committer": {"name": "Eduard-Mihai Burtescu", "email": "edy.burt@gmail.com", "date": "2018-09-15T08:16:45Z"}, "message": "Fix `useless_attribute` to also whitelist `unused_extern_crates`.", "tree": {"sha": "fbed877dc9ea603d8af59a2b3e64f863032f5eb3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fbed877dc9ea603d8af59a2b3e64f863032f5eb3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/85caaf59051aa30cf57fc47c010be6e36c4c85f6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/85caaf59051aa30cf57fc47c010be6e36c4c85f6", "html_url": "https://github.com/rust-lang/rust/commit/85caaf59051aa30cf57fc47c010be6e36c4c85f6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/85caaf59051aa30cf57fc47c010be6e36c4c85f6/comments", "author": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9219fc6c5c0d4fa2e5b7580448a2acccabc2c988", "url": "https://api.github.com/repos/rust-lang/rust/commits/9219fc6c5c0d4fa2e5b7580448a2acccabc2c988", "html_url": "https://github.com/rust-lang/rust/commit/9219fc6c5c0d4fa2e5b7580448a2acccabc2c988"}], "stats": {"total": 26, "additions": 16, "deletions": 10}, "files": [{"sha": "128a5ab147ea6eb0ae8afa6d4461c0ea4c8617bf", "filename": "clippy_lints/src/attrs.rs", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/85caaf59051aa30cf57fc47c010be6e36c4c85f6/clippy_lints%2Fsrc%2Fattrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/85caaf59051aa30cf57fc47c010be6e36c4c85f6/clippy_lints%2Fsrc%2Fattrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fattrs.rs?ref=85caaf59051aa30cf57fc47c010be6e36c4c85f6", "patch": "@@ -180,10 +180,15 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for AttrPass {\n                                                                 || is_word(lint, \"deprecated\") {\n                                                 return\n                                         },\n-                                        ItemKind::ExternCrate(..) => if is_word(lint, \"unused_imports\")\n-                                                                        && skip_unused_imports {\n+                                        ItemKind::ExternCrate(..) => {\n+                                            if is_word(lint, \"unused_imports\")\n+                                                && skip_unused_imports {\n+                                                    return\n+                                            }\n+                                            if is_word(lint, \"unused_extern_crates\") {\n                                                 return\n-                                        },\n+                                            }\n+                                        }\n                                         _ => {},\n                                     }\n                                 }"}, {"sha": "80d4ebcedba71b7344dd84083aadf942f44cea25", "filename": "tests/ui/useless_attribute.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/85caaf59051aa30cf57fc47c010be6e36c4c85f6/tests%2Fui%2Fuseless_attribute.rs", "raw_url": "https://github.com/rust-lang/rust/raw/85caaf59051aa30cf57fc47c010be6e36c4c85f6/tests%2Fui%2Fuseless_attribute.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fuseless_attribute.rs?ref=85caaf59051aa30cf57fc47c010be6e36c4c85f6", "patch": "@@ -2,11 +2,12 @@\n \n #![warn(clippy::useless_attribute)]\n \n-#[allow(dead_code, unused_extern_crates)]\n-#[cfg_attr(feature = \"cargo-clippy\", allow(dead_code, unused_extern_crates))]\n+#[allow(dead_code)]\n+#[cfg_attr(feature = \"cargo-clippy\", allow(dead_code))]\n #[cfg_attr(feature = \"cargo-clippy\",\n-           allow(dead_code, unused_extern_crates))]\n+           allow(dead_code))]\n #[allow(unused_imports)]\n+#[allow(unused_extern_crates)]\n #[macro_use]\n extern crate clippy_lints;\n "}, {"sha": "d498fe64ebf1b0020ecff2a42e969a8bc0f899c6", "filename": "tests/ui/useless_attribute.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/85caaf59051aa30cf57fc47c010be6e36c4c85f6/tests%2Fui%2Fuseless_attribute.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/85caaf59051aa30cf57fc47c010be6e36c4c85f6/tests%2Fui%2Fuseless_attribute.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fuseless_attribute.stderr?ref=85caaf59051aa30cf57fc47c010be6e36c4c85f6", "patch": "@@ -1,16 +1,16 @@\n error: useless lint attribute\n  --> $DIR/useless_attribute.rs:5:1\n   |\n-5 | #[allow(dead_code, unused_extern_crates)]\n-  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: if you just forgot a `!`, use: `#![allow(dead_code, unused_extern_crates)]`\n+5 | #[allow(dead_code)]\n+  | ^^^^^^^^^^^^^^^^^^^ help: if you just forgot a `!`, use: `#![allow(dead_code)]`\n   |\n   = note: `-D clippy::useless-attribute` implied by `-D warnings`\n \n error: useless lint attribute\n  --> $DIR/useless_attribute.rs:6:1\n   |\n-6 | #[cfg_attr(feature = \"cargo-clippy\", allow(dead_code, unused_extern_crates))]\n-  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: if you just forgot a `!`, use: `#![cfg_attr(feature = \"cargo-clippy\", allow(dead_code, unused_extern_crates))`\n+6 | #[cfg_attr(feature = \"cargo-clippy\", allow(dead_code))]\n+  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: if you just forgot a `!`, use: `#![cfg_attr(feature = \"cargo-clippy\", allow(dead_code))`\n \n error: aborting due to 2 previous errors\n "}]}