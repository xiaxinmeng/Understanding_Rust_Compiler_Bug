{"sha": "7185c594fe1b6c282c432c1fbb57e8e6e23421ed", "node_id": "MDY6Q29tbWl0NzI0NzEyOjcxODVjNTk0ZmUxYjZjMjgyYzQzMmMxZmJiNTdlOGU2ZTIzNDIxZWQ=", "commit": {"author": {"name": "Lucas Spits", "email": "spits.lucas@gmail.com", "date": "2019-03-11T19:38:46Z"}, "committer": {"name": "Lucas Spits", "email": "spits.lucas@gmail.com", "date": "2019-03-11T19:38:46Z"}, "message": "Retrieve current directory from workspaces", "tree": {"sha": "b69bb180e14135078fe0e1b2284dc12512574505", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b69bb180e14135078fe0e1b2284dc12512574505"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7185c594fe1b6c282c432c1fbb57e8e6e23421ed", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEErhLcgc5oH9QhwlPzriXfe2RaorAFAlyGuUoACgkQriXfe2Ra\norB1mBAApSlB5zwHJ8BRBKnBPdh7hGrg8zoWjlSDy3Z3qufHJ1uwa1GJ3TzwrJfw\nYjrJ5xbgqVwzzMTvfwKrHqbz8b+XDO9fDYj8JgMfQmUMlv5s7gCxtjkvL/mMqbIf\nYkItiRDd0Km6sLLTd1n/2LBeF++wFhRG9cCIo4jynDHb6rqNM3jGGqtZTC26G90R\nwYIVV7WTCzLsiZzqWEP+897zlcBubtgPgDthQ/KeU/0Ngdp1hSsjRP2dkQhL0xmZ\nDCEPDYXrovdqJspQRerMayMG/U+hnLj3f2LtJ/+L8T+STavtwzvUdh0Uwr6/z8MT\nZprPjyMKqarFTs4cZe6zlPRaJ5gLgB5cWZDwPY5MzG4fljtdUynumrmumnBC3zbC\nUS0+txx4i/8bPqQeQQtKvkCDLbodLqpRCXzXn4AU9kAtx3SpDk+o9GnIpqkFKyJ+\nfCyCOWt0t9CIwbES99sLbj/EMi+WCxSq9sWxcZzrIqqbnBtTNteO+QtDujeOXl3Y\nCWx19mKCRkN8avDkZ4S5KfmyFaT63Xw96qxQ5Ces0Cit76uCOnHz9KdZcuw+9vgX\nN10TTVvNUXJ2gbWnczJxayC5jtjasBp9+ku9RabNa/UosqrRruLK0PuGLAwRAjS8\npuSP6243ALQc8BnRfufEQvNxZDk1zrpZQ3NvFdlzFvL0uBCDI4c=\n=PdtG\n-----END PGP SIGNATURE-----", "payload": "tree b69bb180e14135078fe0e1b2284dc12512574505\nparent 011bd4b2fce56f7c96b4b863c1958184c9d5f84d\nauthor Lucas Spits <spits.lucas@gmail.com> 1552333126 +0100\ncommitter Lucas Spits <spits.lucas@gmail.com> 1552333126 +0100\n\nRetrieve current directory from workspaces\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7185c594fe1b6c282c432c1fbb57e8e6e23421ed", "html_url": "https://github.com/rust-lang/rust/commit/7185c594fe1b6c282c432c1fbb57e8e6e23421ed", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7185c594fe1b6c282c432c1fbb57e8e6e23421ed/comments", "author": {"login": "LDSpits", "id": 11315167, "node_id": "MDQ6VXNlcjExMzE1MTY3", "avatar_url": "https://avatars.githubusercontent.com/u/11315167?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LDSpits", "html_url": "https://github.com/LDSpits", "followers_url": "https://api.github.com/users/LDSpits/followers", "following_url": "https://api.github.com/users/LDSpits/following{/other_user}", "gists_url": "https://api.github.com/users/LDSpits/gists{/gist_id}", "starred_url": "https://api.github.com/users/LDSpits/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LDSpits/subscriptions", "organizations_url": "https://api.github.com/users/LDSpits/orgs", "repos_url": "https://api.github.com/users/LDSpits/repos", "events_url": "https://api.github.com/users/LDSpits/events{/privacy}", "received_events_url": "https://api.github.com/users/LDSpits/received_events", "type": "User", "site_admin": false}, "committer": {"login": "LDSpits", "id": 11315167, "node_id": "MDQ6VXNlcjExMzE1MTY3", "avatar_url": "https://avatars.githubusercontent.com/u/11315167?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LDSpits", "html_url": "https://github.com/LDSpits", "followers_url": "https://api.github.com/users/LDSpits/followers", "following_url": "https://api.github.com/users/LDSpits/following{/other_user}", "gists_url": "https://api.github.com/users/LDSpits/gists{/gist_id}", "starred_url": "https://api.github.com/users/LDSpits/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LDSpits/subscriptions", "organizations_url": "https://api.github.com/users/LDSpits/orgs", "repos_url": "https://api.github.com/users/LDSpits/repos", "events_url": "https://api.github.com/users/LDSpits/events{/privacy}", "received_events_url": "https://api.github.com/users/LDSpits/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "011bd4b2fce56f7c96b4b863c1958184c9d5f84d", "url": "https://api.github.com/repos/rust-lang/rust/commits/011bd4b2fce56f7c96b4b863c1958184c9d5f84d", "html_url": "https://github.com/rust-lang/rust/commit/011bd4b2fce56f7c96b4b863c1958184c9d5f84d"}], "stats": {"total": 20, "additions": 18, "deletions": 2}, "files": [{"sha": "30ab874ab32dfeae4024c0736bf32a33d1c185ed", "filename": "editors/code/src/server.ts", "status": "modified", "additions": 18, "deletions": 2, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/7185c594fe1b6c282c432c1fbb57e8e6e23421ed/editors%2Fcode%2Fsrc%2Fserver.ts", "raw_url": "https://github.com/rust-lang/rust/raw/7185c594fe1b6c282c432c1fbb57e8e6e23421ed/editors%2Fcode%2Fsrc%2Fserver.ts", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fsrc%2Fserver.ts?ref=7185c594fe1b6c282c432c1fbb57e8e6e23421ed", "patch": "@@ -1,6 +1,6 @@\n import * as lc from 'vscode-languageclient';\n \n-import { window } from 'vscode';\n+import { window, workspace } from 'vscode';\n import { Config } from './config';\n import { Highlighter } from './highlighting';\n \n@@ -12,9 +12,25 @@ export class Server {\n     public static start(\n         notificationHandlers: Iterable<[string, lc.GenericNotificationHandler]>\n     ) {\n+\n+        // '.' Is the fallback if no folder is open\n+        // TODO?: Workspace folders support Uri's (eg: file://test.txt). It might be a good idea to test if the uri points to a file.\n+        let folder: string = '.';\n+        if (workspace.workspaceFolders !== undefined) {\n+\n+            folder = workspace\n+                .workspaceFolders[0].uri.fsPath\n+                .toString();\n+            \n+            if (workspace.workspaceFolders.length > 1) {\n+                // Tell the user that we do not support multi-root workspaces yet\n+                window.showWarningMessage(\"Multi-root workspaces are not currently supported\");\n+            }\n+        }\n+\n         const run: lc.Executable = {\n             command: this.config.raLspServerPath,\n-            options: { cwd: '.' }\n+            options: { cwd: folder }\n         };\n         const serverOptions: lc.ServerOptions = {\n             run,"}]}