{"sha": "db151763d42c725685bb9e86a16fa2b6cb7a64c7", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRiMTUxNzYzZDQyYzcyNTY4NWJiOWU4NmExNmZhMmI2Y2I3YTY0Yzc=", "commit": {"author": {"name": "Roland Ruckerbauer", "email": "roland.rucky@gmail.com", "date": "2020-01-10T19:35:23Z"}, "committer": {"name": "Roland Ruckerbauer", "email": "roland.rucky@gmail.com", "date": "2020-01-12T16:34:57Z"}, "message": "Fix file_structure()  to recognize macro_rules!\nwhere first token != \"macro_rules\"", "tree": {"sha": "c4119c56f4345f1306a370c99a63afc1aae2eb4a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c4119c56f4345f1306a370c99a63afc1aae2eb4a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/db151763d42c725685bb9e86a16fa2b6cb7a64c7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/db151763d42c725685bb9e86a16fa2b6cb7a64c7", "html_url": "https://github.com/rust-lang/rust/commit/db151763d42c725685bb9e86a16fa2b6cb7a64c7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/db151763d42c725685bb9e86a16fa2b6cb7a64c7/comments", "author": null, "committer": null, "parents": [{"sha": "d0b52e5d84b8c371b74d4d5d43f45be91f103d12", "url": "https://api.github.com/repos/rust-lang/rust/commits/d0b52e5d84b8c371b74d4d5d43f45be91f103d12", "html_url": "https://github.com/rust-lang/rust/commit/d0b52e5d84b8c371b74d4d5d43f45be91f103d12"}], "stats": {"total": 20, "additions": 17, "deletions": 3}, "files": [{"sha": "be21fa9130382f31b9a4fdab5b9d2d01fd8ee5da", "filename": "crates/ra_ide/src/display/structure.rs", "status": "modified", "additions": 17, "deletions": 3, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/db151763d42c725685bb9e86a16fa2b6cb7a64c7/crates%2Fra_ide%2Fsrc%2Fdisplay%2Fstructure.rs", "raw_url": "https://github.com/rust-lang/rust/raw/db151763d42c725685bb9e86a16fa2b6cb7a64c7/crates%2Fra_ide%2Fsrc%2Fdisplay%2Fstructure.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide%2Fsrc%2Fdisplay%2Fstructure.rs?ref=db151763d42c725685bb9e86a16fa2b6cb7a64c7", "patch": "@@ -151,10 +151,24 @@ fn structure_node(node: &SyntaxNode) -> Option<StructureNode> {\n                 Some(node)\n             },\n             ast::MacroCall(it) => {\n-                let first_token = it.syntax().first_token().unwrap();\n-                if first_token.text().as_str() != \"macro_rules\" {\n-                    return None;\n+                let macro_name = it.syntax()\n+                    .children()\n+                    .find(|c|\n+                        ![\n+                            SyntaxKind::COMMENT,\n+                            SyntaxKind::WHITESPACE,\n+                            SyntaxKind::ATTR\n+                        ].iter()\n+                        .any(|&k| k == c.kind())\n+                    );\n+\n+                match macro_name {\n+                    None => return None,\n+                    Some(n) => if n.first_token().unwrap().text().as_str() != \"macro_rules\" {\n+                        return None;\n+                    }\n                 }\n+\n                 decl(it)\n             },\n             _ => None,"}]}