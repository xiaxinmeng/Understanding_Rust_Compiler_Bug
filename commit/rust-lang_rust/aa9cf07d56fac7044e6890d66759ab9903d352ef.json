{"sha": "aa9cf07d56fac7044e6890d66759ab9903d352ef", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFhOWNmMDdkNTZmYWM3MDQ0ZTY4OTBkNjY3NTlhYjk5MDNkMzUyZWY=", "commit": {"author": {"name": "Grzegorz", "email": "grzegorz.bartoszek@thaumatec.com", "date": "2019-03-31T12:10:17Z"}, "committer": {"name": "Grzegorz", "email": "grzegorz.bartoszek@thaumatec.com", "date": "2019-04-19T13:14:49Z"}, "message": "redundant closure for functions restricted to FnDefs", "tree": {"sha": "b26a6967f92d6711e804e0663c1d7ba202aabd3f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b26a6967f92d6711e804e0663c1d7ba202aabd3f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/aa9cf07d56fac7044e6890d66759ab9903d352ef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/aa9cf07d56fac7044e6890d66759ab9903d352ef", "html_url": "https://github.com/rust-lang/rust/commit/aa9cf07d56fac7044e6890d66759ab9903d352ef", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/aa9cf07d56fac7044e6890d66759ab9903d352ef/comments", "author": null, "committer": null, "parents": [{"sha": "0d9ef393b8c2596aca6a037d3efb513afdf17875", "url": "https://api.github.com/repos/rust-lang/rust/commits/0d9ef393b8c2596aca6a037d3efb513afdf17875", "html_url": "https://github.com/rust-lang/rust/commit/0d9ef393b8c2596aca6a037d3efb513afdf17875"}], "stats": {"total": 13, "additions": 13, "deletions": 0}, "files": [{"sha": "cb17ef18429a5e61dda0d1997d1528b78e6e0bb5", "filename": "clippy_lints/src/eta_reduction.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/aa9cf07d56fac7044e6890d66759ab9903d352ef/clippy_lints%2Fsrc%2Feta_reduction.rs", "raw_url": "https://github.com/rust-lang/rust/raw/aa9cf07d56fac7044e6890d66759ab9903d352ef/clippy_lints%2Fsrc%2Feta_reduction.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Feta_reduction.rs?ref=aa9cf07d56fac7044e6890d66759ab9903d352ef", "patch": "@@ -65,6 +65,9 @@ fn check_closure(cx: &LateContext<'_, '_>, expr: &Expr) {\n             if !(is_adjusted(cx, ex) || args.iter().any(|arg| is_adjusted(cx, arg)));\n \n             let fn_ty = cx.tables.expr_ty(caller);\n+\n+            if let ty::FnDef(_, _) = fn_ty.sty;\n+\n             if !type_is_unsafe_function(cx, fn_ty);\n \n             if compare_inputs(&mut iter_input_pats(decl, body), &mut args.into_iter());"}, {"sha": "6f9457a4a29dd634de7584eac264c42c7398eae2", "filename": "tests/ui/eta.fixed", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/aa9cf07d56fac7044e6890d66759ab9903d352ef/tests%2Fui%2Feta.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/aa9cf07d56fac7044e6890d66759ab9903d352ef/tests%2Fui%2Feta.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Feta.fixed?ref=aa9cf07d56fac7044e6890d66759ab9903d352ef", "patch": "@@ -133,3 +133,8 @@ fn divergent(_: u8) -> ! {\n fn generic<T>(_: T) -> u8 {\n     0\n }\n+\n+fn passes_fn_mut(mut x: Box<dyn FnMut()>) {\n+    requires_fn_once(|| x());\n+}\n+fn requires_fn_once<T: FnOnce()>(_: T) {}"}, {"sha": "11f142e17dfbd7b1fc8136026fd819f2123a3d50", "filename": "tests/ui/eta.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/aa9cf07d56fac7044e6890d66759ab9903d352ef/tests%2Fui%2Feta.rs", "raw_url": "https://github.com/rust-lang/rust/raw/aa9cf07d56fac7044e6890d66759ab9903d352ef/tests%2Fui%2Feta.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Feta.rs?ref=aa9cf07d56fac7044e6890d66759ab9903d352ef", "patch": "@@ -133,3 +133,8 @@ fn divergent(_: u8) -> ! {\n fn generic<T>(_: T) -> u8 {\n     0\n }\n+\n+fn passes_fn_mut(mut x: Box<dyn FnMut()>) {\n+    requires_fn_once(|| x());\n+}\n+fn requires_fn_once<T: FnOnce()>(_: T) {}"}]}