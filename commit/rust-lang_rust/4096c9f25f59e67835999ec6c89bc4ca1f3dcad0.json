{"sha": "4096c9f25f59e67835999ec6c89bc4ca1f3dcad0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQwOTZjOWYyNWY1OWU2NzgzNTk5OWVjNmM4OWJjNGNhMWYzZGNhZDA=", "commit": {"author": {"name": "asdf", "email": "asdf@debian.localdomain", "date": "2013-01-05T10:52:37Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2013-01-08T21:25:23Z"}, "message": "adding bound checks for raw::memcpy and memmove", "tree": {"sha": "b485da91acf1688f2e68a88d57a308bb2df88127", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b485da91acf1688f2e68a88d57a308bb2df88127"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4096c9f25f59e67835999ec6c89bc4ca1f3dcad0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4096c9f25f59e67835999ec6c89bc4ca1f3dcad0", "html_url": "https://github.com/rust-lang/rust/commit/4096c9f25f59e67835999ec6c89bc4ca1f3dcad0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4096c9f25f59e67835999ec6c89bc4ca1f3dcad0/comments", "author": null, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2d9b1fee8f623b2d6724084b8506f3309f380d24", "url": "https://api.github.com/repos/rust-lang/rust/commits/2d9b1fee8f623b2d6724084b8506f3309f380d24", "html_url": "https://github.com/rust-lang/rust/commit/2d9b1fee8f623b2d6724084b8506f3309f380d24"}], "stats": {"total": 15, "additions": 15, "deletions": 0}, "files": [{"sha": "758c35cc14bba3097d8144c43c08b95154f52b21", "filename": "src/libcore/vec.rs", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/4096c9f25f59e67835999ec6c89bc4ca1f3dcad0/src%2Flibcore%2Fvec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4096c9f25f59e67835999ec6c89bc4ca1f3dcad0/src%2Flibcore%2Fvec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fvec.rs?ref=4096c9f25f59e67835999ec6c89bc4ca1f3dcad0", "patch": "@@ -1960,6 +1960,9 @@ pub mod raw {\n       * may overlap.\n       */\n     pub unsafe fn memcpy<T>(dst: &[mut T], src: &[const T], count: uint) {\n+        assert dst.len() >= count;\n+        assert src.len() >= count;\n+\n         do as_mut_buf(dst) |p_dst, _len_dst| {\n             do as_const_buf(src) |p_src, _len_src| {\n                 ptr::memcpy(p_dst, p_src, count)\n@@ -1974,6 +1977,9 @@ pub mod raw {\n       * may overlap.\n       */\n     pub unsafe fn memmove<T>(dst: &[mut T], src: &[const T], count: uint) {\n+        assert dst.len() >= count;\n+        assert src.len() >= count;\n+\n         do as_mut_buf(dst) |p_dst, _len_dst| {\n             do as_const_buf(src) |p_src, _len_src| {\n                 ptr::memmove(p_dst, p_src, count)\n@@ -3730,6 +3736,15 @@ mod tests {\n             fail\n         }\n     }\n+\n+    #[test]\n+    #[should_fail]\n+    fn test_memcpy_oob() unsafe {\n+        let a = [mut 1, 2, 3, 4];\n+        let b = [1, 2, 3, 4, 5];\n+        raw::memcpy(a, b, 5);\n+    }\n+\n }\n \n // Local Variables:"}]}