{"sha": "f945e57bd050227bbf92f151303785991173f2fe", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY5NDVlNTdiZDA1MDIyN2JiZjkyZjE1MTMwMzc4NTk5MTE3M2YyZmU=", "commit": {"author": {"name": "Tim Chevalier", "email": "chevalier@alum.wellesley.edu", "date": "2013-04-23T00:56:15Z"}, "committer": {"name": "Tim Chevalier", "email": "chevalier@alum.wellesley.edu", "date": "2013-04-25T00:51:31Z"}, "message": "rustpkg: Correct directory structure in test scenarios", "tree": {"sha": "6c0906478653c876c8b1395274c6fd48d83135e9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6c0906478653c876c8b1395274c6fd48d83135e9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f945e57bd050227bbf92f151303785991173f2fe", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f945e57bd050227bbf92f151303785991173f2fe", "html_url": "https://github.com/rust-lang/rust/commit/f945e57bd050227bbf92f151303785991173f2fe", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f945e57bd050227bbf92f151303785991173f2fe/comments", "author": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "committer": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6a3e26aa4062019629e144196a7852ef039f8b0a", "url": "https://api.github.com/repos/rust-lang/rust/commits/6a3e26aa4062019629e144196a7852ef039f8b0a", "html_url": "https://github.com/rust-lang/rust/commit/6a3e26aa4062019629e144196a7852ef039f8b0a"}], "stats": {"total": 17, "additions": 11, "deletions": 6}, "files": [{"sha": "ffbc6e2a7f9b2a68f07a2a3137e5dd25eb9a18dc", "filename": "src/librustpkg/testsuite/pass/src/fancy-lib/bar.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Ffancy-lib%2Fbar.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Ffancy-lib%2Fbar.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Ffancy-lib%2Fbar.rs?ref=f945e57bd050227bbf92f151303785991173f2fe", "previous_filename": "src/librustpkg/testsuite/pass/src/fancy-lib/src/bar.rs"}, {"sha": "dc068eed143efd313d93299be2e0debbc10a0228", "filename": "src/librustpkg/testsuite/pass/src/fancy-lib/fancy-lib.rs", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Ffancy-lib%2Ffancy-lib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Ffancy-lib%2Ffancy-lib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Ffancy-lib%2Ffancy-lib.rs?ref=f945e57bd050227bbf92f151303785991173f2fe", "patch": "@@ -21,4 +21,4 @@ extern mod std;\n \n pub mod foo;\n pub mod bar;\n-#[path = \"build/generated.rs\"] pub mod generated;\n+#[path = \"../../build/fancy_lib/generated.rs\"] pub mod generated;", "previous_filename": "src/librustpkg/testsuite/pass/src/fancy-lib/src/fancy-lib.rs"}, {"sha": "542a6af402d055053afffe3c366fb145e51c4b83", "filename": "src/librustpkg/testsuite/pass/src/fancy-lib/foo.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Ffancy-lib%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Ffancy-lib%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Ffancy-lib%2Ffoo.rs?ref=f945e57bd050227bbf92f151303785991173f2fe", "previous_filename": "src/librustpkg/testsuite/pass/src/fancy-lib/src/foo.rs"}, {"sha": "eeaa0f68ed531ed8c3c39baca929c7887203ccac", "filename": "src/librustpkg/testsuite/pass/src/fancy-lib/pkg.rs", "status": "modified", "additions": 10, "deletions": 5, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Ffancy-lib%2Fpkg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Ffancy-lib%2Fpkg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Ffancy-lib%2Fpkg.rs?ref=f945e57bd050227bbf92f151303785991173f2fe", "patch": "@@ -11,13 +11,18 @@\n use core::run;\n \n pub fn main() {\n-    let cwd = os::getcwd();\n-    debug!(\"cwd = %s\", cwd.to_str());\n-    let file = io::file_writer(&Path(~\"fancy-lib/build/generated.rs\"),\n+    use core::libc::consts::os::posix88::{S_IRUSR, S_IWUSR, S_IXUSR};\n+\n+    let out_path = Path(~\"build/fancy_lib\");\n+    if !os::path_exists(&out_path) {\n+        assert!(os::make_dir(&out_path, (S_IRUSR | S_IWUSR | S_IXUSR) as i32));\n+    }\n+\n+    let file = io::file_writer(&out_path.push(\"generated.rs\"),\n                                [io::Create]).get();\n     file.write_str(\"pub fn wheeeee() { for [1, 2, 3].each() |_| { assert!(true); } }\");\n \n     // now compile the crate itself\n-    run::run_program(\"rustc\", ~[~\"fancy-lib/fancy-lib.rs\", ~\"--lib\",\n-                                ~\"-o\", ~\"fancy-lib/build/fancy_lib\"]);\n+    run::run_program(\"rustc\", ~[~\"src/fancy-lib/fancy-lib.rs\", ~\"--lib\",\n+                                ~\"-o\", out_path.push(~\"fancy_lib\").to_str()]);\n }\n\\ No newline at end of file"}, {"sha": "2ef387d962000c1f044061bb646ae299fa97b045", "filename": "src/librustpkg/testsuite/pass/src/hello-world/main.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Fhello-world%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Fhello-world%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Fhello-world%2Fmain.rs?ref=f945e57bd050227bbf92f151303785991173f2fe", "previous_filename": "src/librustpkg/testsuite/pass/src/hello-world/src/main.rs"}, {"sha": "e1641ccf0749309426e57a911ce21ceed13d75fd", "filename": "src/librustpkg/testsuite/pass/src/install-paths/bench.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Finstall-paths%2Fbench.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Finstall-paths%2Fbench.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Finstall-paths%2Fbench.rs?ref=f945e57bd050227bbf92f151303785991173f2fe", "previous_filename": "src/librustpkg/testsuite/pass/src/install-paths/src/bench.rs"}, {"sha": "baf90446f7aaca6c3364f96306e94574ee76f602", "filename": "src/librustpkg/testsuite/pass/src/install-paths/lib.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Finstall-paths%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Finstall-paths%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Finstall-paths%2Flib.rs?ref=f945e57bd050227bbf92f151303785991173f2fe", "previous_filename": "src/librustpkg/testsuite/pass/src/install-paths/src/lib.rs"}, {"sha": "37e606dcb1ab3ee283c3c6a280cf8837c2bdc038", "filename": "src/librustpkg/testsuite/pass/src/install-paths/main.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Finstall-paths%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Finstall-paths%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Finstall-paths%2Fmain.rs?ref=f945e57bd050227bbf92f151303785991173f2fe", "previous_filename": "src/librustpkg/testsuite/pass/src/install-paths/src/main.rs"}, {"sha": "acfae9e04fb59b54caf70ae08e407542606b83c5", "filename": "src/librustpkg/testsuite/pass/src/install-paths/test.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Finstall-paths%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f945e57bd050227bbf92f151303785991173f2fe/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Finstall-paths%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsrc%2Finstall-paths%2Ftest.rs?ref=f945e57bd050227bbf92f151303785991173f2fe", "previous_filename": "src/librustpkg/testsuite/pass/src/install-paths/src/test.rs"}]}