{"sha": "bf7182c8e129582fded48676801aab3213c6e7b6", "node_id": "C_kwDOAAsO6NoAKGJmNzE4MmM4ZTEyOTU4MmZkZWQ0ODY3NjgwMWFhYjMyMTNjNmU3YjY", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-05-05T21:39:11Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-05-05T21:39:11Z"}, "message": "Auto merge of #8790 - Jarcho:attribute_line, r=flip1995\n\nLint `empty_lint_after_outer_attr` on argumentless macros\n\nReverts the change from 034c81b76145a0514916f34713671b16f26988df as it's no longer needed. The test is left just in case. Original issue is #2475.\n\nchangelog: Lint `empty_lint_after_outer_attr` on argumentless macros again", "tree": {"sha": "95960f06f3b7526d18a138a88e34183028a5e433", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/95960f06f3b7526d18a138a88e34183028a5e433"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bf7182c8e129582fded48676801aab3213c6e7b6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bf7182c8e129582fded48676801aab3213c6e7b6", "html_url": "https://github.com/rust-lang/rust/commit/bf7182c8e129582fded48676801aab3213c6e7b6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bf7182c8e129582fded48676801aab3213c6e7b6/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0509a9629019f31840f1154d998dd19f7c07c2f6", "url": "https://api.github.com/repos/rust-lang/rust/commits/0509a9629019f31840f1154d998dd19f7c07c2f6", "html_url": "https://github.com/rust-lang/rust/commit/0509a9629019f31840f1154d998dd19f7c07c2f6"}, {"sha": "17bea3137b0b30b524c318e5773ff827442958b9", "url": "https://api.github.com/repos/rust-lang/rust/commits/17bea3137b0b30b524c318e5773ff827442958b9", "html_url": "https://github.com/rust-lang/rust/commit/17bea3137b0b30b524c318e5773ff827442958b9"}], "stats": {"total": 21, "additions": 5, "deletions": 16}, "files": [{"sha": "30dde2f0ef0982e8aa217353249cb12892cc2d32", "filename": "clippy_lints/src/attrs.rs", "status": "modified", "additions": 5, "deletions": 16, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/bf7182c8e129582fded48676801aab3213c6e7b6/clippy_lints%2Fsrc%2Fattrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bf7182c8e129582fded48676801aab3213c6e7b6/clippy_lints%2Fsrc%2Fattrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fattrs.rs?ref=bf7182c8e129582fded48676801aab3213c6e7b6", "patch": "@@ -6,7 +6,7 @@ use clippy_utils::msrvs;\n use clippy_utils::source::{first_line_of_span, is_present_in_source, snippet_opt, without_block_comments};\n use clippy_utils::{extract_msrv_attr, meets_msrv};\n use if_chain::if_chain;\n-use rustc_ast::{AttrKind, AttrStyle, Attribute, Lit, LitKind, MacArgs, MacArgsEq, MetaItemKind, NestedMetaItem};\n+use rustc_ast::{AttrKind, AttrStyle, Attribute, Lit, LitKind, MetaItemKind, NestedMetaItem};\n use rustc_errors::Applicability;\n use rustc_hir::{\n     Block, Expr, ExprKind, ImplItem, ImplItemKind, Item, ItemKind, StmtKind, TraitFn, TraitItem, TraitItemKind,\n@@ -586,21 +586,10 @@ impl EarlyLintPass for EarlyAttributes {\n \n fn check_empty_line_after_outer_attr(cx: &EarlyContext<'_>, item: &rustc_ast::Item) {\n     for attr in &item.attrs {\n-        let attr_item = if let AttrKind::Normal(ref attr, _) = attr.kind {\n-            attr\n-        } else {\n-            return;\n-        };\n-\n-        if attr.style == AttrStyle::Outer {\n-            if let MacArgs::Eq(_, MacArgsEq::Ast(expr)) = &attr_item.args\n-                && !matches!(expr.kind, rustc_ast::ExprKind::Lit(..)) {\n-                return;\n-            }\n-            if attr_item.args.inner_tokens().is_empty() || !is_present_in_source(cx, attr.span) {\n-                return;\n-            }\n-\n+        if matches!(attr.kind, AttrKind::Normal(..))\n+            && attr.style == AttrStyle::Outer\n+            && is_present_in_source(cx, attr.span)\n+        {\n             let begin_of_attr_to_item = Span::new(attr.span.lo(), item.span.lo(), item.span.ctxt(), item.span.parent());\n             let end_of_attr_to_item = Span::new(attr.span.hi(), item.span.lo(), item.span.ctxt(), item.span.parent());\n "}]}