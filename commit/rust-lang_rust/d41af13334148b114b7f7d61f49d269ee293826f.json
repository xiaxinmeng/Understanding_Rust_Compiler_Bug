{"sha": "d41af13334148b114b7f7d61f49d269ee293826f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ0MWFmMTMzMzQxNDhiMTE0YjdmN2Q2MWY0OWQyNjllZTI5MzgyNmY=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-05-09T05:25:22Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-05-09T05:33:45Z"}, "message": "rustc: Extract session::basic_options from rustdoc", "tree": {"sha": "398dbdef4947795cfd73ce37331d005706af03fb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/398dbdef4947795cfd73ce37331d005706af03fb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d41af13334148b114b7f7d61f49d269ee293826f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d41af13334148b114b7f7d61f49d269ee293826f", "html_url": "https://github.com/rust-lang/rust/commit/d41af13334148b114b7f7d61f49d269ee293826f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d41af13334148b114b7f7d61f49d269ee293826f/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d21d1ecad5a45cce6722065b04f36229c0884ada", "url": "https://api.github.com/repos/rust-lang/rust/commits/d21d1ecad5a45cce6722065b04f36229c0884ada", "html_url": "https://github.com/rust-lang/rust/commit/d21d1ecad5a45cce6722065b04f36229c0884ada"}], "stats": {"total": 57, "additions": 30, "deletions": 27}, "files": [{"sha": "88d8b5ed64047e076f6e4b2c10886cd5145464a9", "filename": "src/rustc/driver/session.rs", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/d41af13334148b114b7f7d61f49d269ee293826f/src%2Frustc%2Fdriver%2Fsession.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d41af13334148b114b7f7d61f49d269ee293826f/src%2Frustc%2Fdriver%2Fsession.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fdriver%2Fsession.rs?ref=d41af13334148b114b7f7d61f49d269ee293826f", "patch": "@@ -6,6 +6,7 @@ import syntax::ast::{int_ty, uint_ty, float_ty};\n import syntax::parse::parse_sess;\n import util::filesearch;\n import back::target_strs;\n+import back::link;\n import middle::lint;\n \n enum os { os_win32, os_macos, os_linux, os_freebsd, }\n@@ -113,6 +114,34 @@ impl session for session {\n     }\n }\n \n+#[doc = \"Some reasonable defaults\"]\n+fn basic_options() -> @options {\n+    @{\n+        crate_type: session::lib_crate,\n+        static: false,\n+        optimize: 0u,\n+        debuginfo: false,\n+        extra_debuginfo: false,\n+        verify: false,\n+        lint_opts: [],\n+        save_temps: false,\n+        stats: false,\n+        time_passes: false,\n+        count_llvm_insns: false,\n+        time_llvm_passes: false,\n+        output_type: link::output_type_exe,\n+        addl_lib_search_paths: [],\n+        maybe_sysroot: none,\n+        target_triple: driver::host_triple(),\n+        cfg: [],\n+        test: false,\n+        parse_only: false,\n+        no_trans: false,\n+        no_asm_comments: false,\n+        debug_rustc: false,\n+    }\n+}\n+\n // Seems out of place, but it uses session, so I'm putting it here\n fn expect<T: copy>(sess: session, opt: option<T>, msg: fn() -> str) -> T {\n     alt opt {"}, {"sha": "1d3ead93f9a79bfc239b940bb5232892a2a956db", "filename": "src/rustdoc/astsrv.rs", "status": "modified", "additions": 1, "deletions": 27, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/d41af13334148b114b7f7d61f49d269ee293826f/src%2Frustdoc%2Fastsrv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d41af13334148b114b7f7d61f49d269ee293826f/src%2Frustdoc%2Fastsrv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Fastsrv.rs?ref=d41af13334148b114b7f7d61f49d269ee293826f", "patch": "@@ -123,34 +123,8 @@ fn build_ctxt(sess: session::session, ast: @ast::crate,\n     }\n }\n \n-// FIXME: this whole structure should not be duplicated here. makes it\n-// painful to add or remove options.\n fn build_session() -> (session::session, @mut bool) {\n-    let sopts: @session::options = @{\n-        crate_type: session::lib_crate,\n-        static: false,\n-        optimize: 0u,\n-        debuginfo: false,\n-        extra_debuginfo: false,\n-        verify: false,\n-        lint_opts: [],\n-        save_temps: false,\n-        stats: false,\n-        time_passes: false,\n-        count_llvm_insns: false,\n-        time_llvm_passes: false,\n-        output_type: link::output_type_exe,\n-        addl_lib_search_paths: [],\n-        maybe_sysroot: none,\n-        target_triple: driver::host_triple(),\n-        cfg: [],\n-        test: false,\n-        parse_only: false,\n-        no_trans: false,\n-        no_asm_comments: false,\n-        debug_rustc: false,\n-    };\n-\n+    let sopts: @session::options = session::basic_options();\n     let codemap = codemap::new_codemap();\n     let error_handlers = build_error_handlers(codemap);\n     let {emitter, span_handler, ignore_errors} = error_handlers;"}]}