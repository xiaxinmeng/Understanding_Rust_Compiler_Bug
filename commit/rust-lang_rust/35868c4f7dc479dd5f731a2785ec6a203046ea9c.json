{"sha": "35868c4f7dc479dd5f731a2785ec6a203046ea9c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM1ODY4YzRmN2RjNDc5ZGQ1ZjczMWEyNzg1ZWM2YTIwMzA0NmVhOWM=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-03-21T16:42:08Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-03-21T16:42:08Z"}, "message": "Merge #8133\n\n8133: Ignore type bindings in generic_predicates_for_param (fix panic on ena and crates depending on it) r=flodiebold a=flodiebold\n\nThis allows us to handle more cases without a query cycle, which includes certain cases that rustc accepted. That in turn means we avoid triggering salsa-rs/salsa#257 on valid code (it will still happen if the user writes an actual cycle).\r\n\r\nWe actually accept more definitions than rustc now; that's because rustc only ignores bindings when looking up super traits, whereas we now also ignore them when looking for predicates to disambiguate associated type shorthand. We could introduce a separate query for super traits if necessary, but for now I think this should be fine.\n\nCo-authored-by: Florian Diebold <flodiebold@gmail.com>", "tree": {"sha": "e78313acecc4fa84a11a2d8e7da7c85c98f940e0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e78313acecc4fa84a11a2d8e7da7c85c98f940e0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/35868c4f7dc479dd5f731a2785ec6a203046ea9c", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgV3dgCRBK7hj4Ov3rIwAAdHIIAEoAVlXs7nS9i4frvhCMWljg\nFOccrhkjovx1DRSddQrYotEoswDJRz81izmZ0Qt7PUrrTTQshc0xpdLTaXHgrl9o\nUYINr0UX1WhpsUSSaSG9M3BQvQ64oyGls/HUJj5sipPO1fBkTMGsVYCkJf/2Upv4\n/HjlPMS2eh8JmeFGIq5AkgayEKmpDkU87PtfEQHAvYqwd1itrE/osaUUhHayq0Bi\n1TZjXKLCiDDst06qbgmtPLqbo7Qoda2S9fxq7S2vmUmjnxZx5m9Pis19j9K3w+yl\ntA6tAtA6p21sX8ecW5P6nAFvc2Vko8sKnPylH0ilRjXczK/NU7tklfsNN7arFAw=\n=QfVu\n-----END PGP SIGNATURE-----\n", "payload": "tree e78313acecc4fa84a11a2d8e7da7c85c98f940e0\nparent 1ae20d2b894171f0b8368309da727cd365b95fc1\nparent d8f8b495ad5c9e3676ddf7af53b23bb5b7f2fde0\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1616344928 +0000\ncommitter GitHub <noreply@github.com> 1616344928 +0000\n\nMerge #8133\n\n8133: Ignore type bindings in generic_predicates_for_param (fix panic on ena and crates depending on it) r=flodiebold a=flodiebold\n\nThis allows us to handle more cases without a query cycle, which includes certain cases that rustc accepted. That in turn means we avoid triggering salsa-rs/salsa#257 on valid code (it will still happen if the user writes an actual cycle).\r\n\r\nWe actually accept more definitions than rustc now; that's because rustc only ignores bindings when looking up super traits, whereas we now also ignore them when looking for predicates to disambiguate associated type shorthand. We could introduce a separate query for super traits if necessary, but for now I think this should be fine.\n\nCo-authored-by: Florian Diebold <flodiebold@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/35868c4f7dc479dd5f731a2785ec6a203046ea9c", "html_url": "https://github.com/rust-lang/rust/commit/35868c4f7dc479dd5f731a2785ec6a203046ea9c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/35868c4f7dc479dd5f731a2785ec6a203046ea9c/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1ae20d2b894171f0b8368309da727cd365b95fc1", "url": "https://api.github.com/repos/rust-lang/rust/commits/1ae20d2b894171f0b8368309da727cd365b95fc1", "html_url": "https://github.com/rust-lang/rust/commit/1ae20d2b894171f0b8368309da727cd365b95fc1"}, {"sha": "d8f8b495ad5c9e3676ddf7af53b23bb5b7f2fde0", "url": "https://api.github.com/repos/rust-lang/rust/commits/d8f8b495ad5c9e3676ddf7af53b23bb5b7f2fde0", "html_url": "https://github.com/rust-lang/rust/commit/d8f8b495ad5c9e3676ddf7af53b23bb5b7f2fde0"}], "stats": {"total": 189, "additions": 173, "deletions": 16}, "files": [{"sha": "e3ac37e4c89b71f583bb82cdc68dcbaaf9793ef6", "filename": "crates/hir/src/lib.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/35868c4f7dc479dd5f731a2785ec6a203046ea9c/crates%2Fhir%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/35868c4f7dc479dd5f731a2785ec6a203046ea9c/crates%2Fhir%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir%2Fsrc%2Flib.rs?ref=35868c4f7dc479dd5f731a2785ec6a203046ea9c", "patch": "@@ -2068,7 +2068,10 @@ impl Type {\n                 match pred {\n                     WhereClause::Implemented(trait_ref) => {\n                         cb(type_.clone());\n-                        walk_substs(db, type_, &trait_ref.substitution, cb);\n+                        // skip the self type. it's likely the type we just got the bounds from\n+                        for ty in trait_ref.substitution.iter().skip(1) {\n+                            walk_type(db, &type_.derived(ty.clone()), cb);\n+                        }\n                     }\n                     _ => (),\n                 }"}, {"sha": "9d3b79be39e5b08ef75715f85d235afed53fcdf1", "filename": "crates/hir_ty/src/display.rs", "status": "modified", "additions": 15, "deletions": 6, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/35868c4f7dc479dd5f731a2785ec6a203046ea9c/crates%2Fhir_ty%2Fsrc%2Fdisplay.rs", "raw_url": "https://github.com/rust-lang/rust/raw/35868c4f7dc479dd5f731a2785ec6a203046ea9c/crates%2Fhir_ty%2Fsrc%2Fdisplay.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Fdisplay.rs?ref=35868c4f7dc479dd5f731a2785ec6a203046ea9c", "patch": "@@ -571,13 +571,22 @@ impl HirDisplay for Ty {\n                         write!(f, \"{}\", param_data.name.clone().unwrap_or_else(Name::missing))?\n                     }\n                     TypeParamProvenance::ArgumentImplTrait => {\n-                        let bounds = f.db.generic_predicates_for_param(id);\n                         let substs = Substitution::type_params_for_generics(f.db, &generics);\n-                        write_bounds_like_dyn_trait_with_prefix(\n-                            \"impl\",\n-                            &bounds.iter().map(|b| b.clone().subst(&substs)).collect::<Vec<_>>(),\n-                            f,\n-                        )?;\n+                        let bounds = f\n+                            .db\n+                            .generic_predicates(id.parent)\n+                            .into_iter()\n+                            .map(|pred| pred.clone().subst(&substs))\n+                            .filter(|wc| match &wc {\n+                                WhereClause::Implemented(tr) => tr.self_type_parameter() == self,\n+                                WhereClause::AliasEq(AliasEq {\n+                                    alias: AliasTy::Projection(proj),\n+                                    ty: _,\n+                                }) => proj.self_type_parameter() == self,\n+                                _ => false,\n+                            })\n+                            .collect::<Vec<_>>();\n+                        write_bounds_like_dyn_trait_with_prefix(\"impl\", &bounds, f)?;\n                     }\n                 }\n             }"}, {"sha": "ad908f957b95ab63bc0e8f35d71042bf4e7ee792", "filename": "crates/hir_ty/src/lib.rs", "status": "modified", "additions": 15, "deletions": 2, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/35868c4f7dc479dd5f731a2785ec6a203046ea9c/crates%2Fhir_ty%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/35868c4f7dc479dd5f731a2785ec6a203046ea9c/crates%2Fhir_ty%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Flib.rs?ref=35868c4f7dc479dd5f731a2785ec6a203046ea9c", "patch": "@@ -106,6 +106,10 @@ impl ProjectionTy {\n         }\n     }\n \n+    pub fn self_type_parameter(&self) -> &Ty {\n+        &self.substitution[0]\n+    }\n+\n     fn trait_(&self, db: &dyn HirDatabase) -> TraitId {\n         match from_assoc_type_id(self.associated_ty_id).lookup(db.upcast()).container {\n             AssocContainerId::TraitId(it) => it,\n@@ -936,10 +940,19 @@ impl Ty {\n                 let param_data = &generic_params.types[id.local_id];\n                 match param_data.provenance {\n                     hir_def::generics::TypeParamProvenance::ArgumentImplTrait => {\n+                        let substs = Substitution::type_params(db, id.parent);\n                         let predicates = db\n-                            .generic_predicates_for_param(id)\n+                            .generic_predicates(id.parent)\n                             .into_iter()\n-                            .map(|pred| pred.value.clone())\n+                            .map(|pred| pred.clone().subst(&substs))\n+                            .filter(|wc| match &wc {\n+                                WhereClause::Implemented(tr) => tr.self_type_parameter() == self,\n+                                WhereClause::AliasEq(AliasEq {\n+                                    alias: AliasTy::Projection(proj),\n+                                    ty: _,\n+                                }) => proj.self_type_parameter() == self,\n+                                _ => false,\n+                            })\n                             .collect_vec();\n \n                         Some(predicates)"}, {"sha": "fd451a823e3b8f6791f7cbadc87e7ade112d3d41", "filename": "crates/hir_ty/src/lower.rs", "status": "modified", "additions": 19, "deletions": 6, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/35868c4f7dc479dd5f731a2785ec6a203046ea9c/crates%2Fhir_ty%2Fsrc%2Flower.rs", "raw_url": "https://github.com/rust-lang/rust/raw/35868c4f7dc479dd5f731a2785ec6a203046ea9c/crates%2Fhir_ty%2Fsrc%2Flower.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Flower.rs?ref=35868c4f7dc479dd5f731a2785ec6a203046ea9c", "patch": "@@ -189,7 +189,10 @@ impl<'a> TyLoweringContext<'a> {\n                 let self_ty =\n                     TyKind::BoundVar(BoundVar::new(DebruijnIndex::INNERMOST, 0)).intern(&Interner);\n                 let predicates = self.with_shifted_in(DebruijnIndex::ONE, |ctx| {\n-                    bounds.iter().flat_map(|b| ctx.lower_type_bound(b, self_ty.clone())).collect()\n+                    bounds\n+                        .iter()\n+                        .flat_map(|b| ctx.lower_type_bound(b, self_ty.clone(), false))\n+                        .collect()\n                 });\n                 TyKind::Dyn(predicates).intern(&Interner)\n             }\n@@ -666,6 +669,7 @@ impl<'a> TyLoweringContext<'a> {\n     pub(crate) fn lower_where_predicate(\n         &'a self,\n         where_predicate: &'a WherePredicate,\n+        ignore_bindings: bool,\n     ) -> impl Iterator<Item = WhereClause> + 'a {\n         match where_predicate {\n             WherePredicate::ForLifetime { target, bound, .. }\n@@ -688,7 +692,9 @@ impl<'a> TyLoweringContext<'a> {\n                         .intern(&Interner)\n                     }\n                 };\n-                self.lower_type_bound(bound, self_ty).collect::<Vec<_>>().into_iter()\n+                self.lower_type_bound(bound, self_ty, ignore_bindings)\n+                    .collect::<Vec<_>>()\n+                    .into_iter()\n             }\n             WherePredicate::Lifetime { .. } => vec![].into_iter(),\n         }\n@@ -698,6 +704,7 @@ impl<'a> TyLoweringContext<'a> {\n         &'a self,\n         bound: &'a TypeBound,\n         self_ty: Ty,\n+        ignore_bindings: bool,\n     ) -> impl Iterator<Item = WhereClause> + 'a {\n         let mut bindings = None;\n         let trait_ref = match bound {\n@@ -711,6 +718,7 @@ impl<'a> TyLoweringContext<'a> {\n         trait_ref.into_iter().chain(\n             bindings\n                 .into_iter()\n+                .filter(move |_| !ignore_bindings)\n                 .flat_map(move |tr| self.assoc_type_bindings_from_type_bound(bound, tr)),\n         )\n     }\n@@ -755,6 +763,7 @@ impl<'a> TyLoweringContext<'a> {\n                     preds.extend(self.lower_type_bound(\n                         bound,\n                         TyKind::Alias(AliasTy::Projection(projection_ty.clone())).intern(&Interner),\n+                        false,\n                     ));\n                 }\n                 preds\n@@ -766,7 +775,7 @@ impl<'a> TyLoweringContext<'a> {\n         let self_ty =\n             TyKind::BoundVar(BoundVar::new(DebruijnIndex::INNERMOST, 0)).intern(&Interner);\n         let predicates = self.with_shifted_in(DebruijnIndex::ONE, |ctx| {\n-            bounds.iter().flat_map(|b| ctx.lower_type_bound(b, self_ty.clone())).collect()\n+            bounds.iter().flat_map(|b| ctx.lower_type_bound(b, self_ty.clone(), false)).collect()\n         });\n         ReturnTypeImplTrait { bounds: Binders::new(1, predicates) }\n     }\n@@ -896,7 +905,9 @@ pub(crate) fn generic_predicates_for_param_query(\n             },\n             WherePredicate::Lifetime { .. } => false,\n         })\n-        .flat_map(|pred| ctx.lower_where_predicate(pred).map(|p| Binders::new(generics.len(), p)))\n+        .flat_map(|pred| {\n+            ctx.lower_where_predicate(pred, true).map(|p| Binders::new(generics.len(), p))\n+        })\n         .collect()\n }\n \n@@ -918,7 +929,7 @@ pub(crate) fn trait_environment_query(\n     let mut traits_in_scope = Vec::new();\n     let mut clauses = Vec::new();\n     for pred in resolver.where_predicates_in_scope() {\n-        for pred in ctx.lower_where_predicate(pred) {\n+        for pred in ctx.lower_where_predicate(pred, false) {\n             if let WhereClause::Implemented(tr) = &pred {\n                 traits_in_scope.push((tr.self_type_parameter().clone(), tr.hir_trait_id()));\n             }\n@@ -966,7 +977,9 @@ pub(crate) fn generic_predicates_query(\n     let generics = generics(db.upcast(), def);\n     resolver\n         .where_predicates_in_scope()\n-        .flat_map(|pred| ctx.lower_where_predicate(pred).map(|p| Binders::new(generics.len(), p)))\n+        .flat_map(|pred| {\n+            ctx.lower_where_predicate(pred, false).map(|p| Binders::new(generics.len(), p))\n+        })\n         .collect()\n }\n "}, {"sha": "ad283c1e04ba5ca688fe3ac39ace2a75eaf937f8", "filename": "crates/hir_ty/src/tests.rs", "status": "modified", "additions": 69, "deletions": 0, "changes": 69, "blob_url": "https://github.com/rust-lang/rust/blob/35868c4f7dc479dd5f731a2785ec6a203046ea9c/crates%2Fhir_ty%2Fsrc%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/35868c4f7dc479dd5f731a2785ec6a203046ea9c/crates%2Fhir_ty%2Fsrc%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Ftests.rs?ref=35868c4f7dc479dd5f731a2785ec6a203046ea9c", "patch": "@@ -369,3 +369,72 @@ fn check_infer_with_mismatches(ra_fixture: &str, expect: Expect) {\n     actual.push('\\n');\n     expect.assert_eq(&actual);\n }\n+\n+#[test]\n+fn salsa_bug() {\n+    let (mut db, pos) = TestDB::with_position(\n+        \"\n+        //- /lib.rs\n+        trait Index {\n+            type Output;\n+        }\n+\n+        type Key<S: UnificationStoreBase> = <S as UnificationStoreBase>::Key;\n+\n+        pub trait UnificationStoreBase: Index<Output = Key<Self>> {\n+            type Key;\n+\n+            fn len(&self) -> usize;\n+        }\n+\n+        pub trait UnificationStoreMut: UnificationStoreBase {\n+            fn push(&mut self, value: Self::Key);\n+        }\n+\n+        fn main() {\n+            let x = 1;\n+            x.push(1);$0\n+        }\n+    \",\n+    );\n+\n+    let module = db.module_for_file(pos.file_id);\n+    let crate_def_map = module.def_map(&db);\n+    visit_module(&db, &crate_def_map, module.local_id, &mut |def| {\n+        db.infer(def);\n+    });\n+\n+    let new_text = \"\n+        //- /lib.rs\n+        trait Index {\n+            type Output;\n+        }\n+\n+        type Key<S: UnificationStoreBase> = <S as UnificationStoreBase>::Key;\n+\n+        pub trait UnificationStoreBase: Index<Output = Key<Self>> {\n+            type Key;\n+\n+            fn len(&self) -> usize;\n+        }\n+\n+        pub trait UnificationStoreMut: UnificationStoreBase {\n+            fn push(&mut self, value: Self::Key);\n+        }\n+\n+        fn main() {\n+\n+            let x = 1;\n+            x.push(1);\n+        }\n+    \"\n+    .to_string();\n+\n+    db.set_file_text(pos.file_id, Arc::new(new_text));\n+\n+    let module = db.module_for_file(pos.file_id);\n+    let crate_def_map = module.def_map(&db);\n+    visit_module(&db, &crate_def_map, module.local_id, &mut |def| {\n+        db.infer(def);\n+    });\n+}"}, {"sha": "37cd04c6f7c34326bce5b5370f9bb8eab274e315", "filename": "crates/hir_ty/src/tests/traits.rs", "status": "modified", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/rust-lang/rust/blob/35868c4f7dc479dd5f731a2785ec6a203046ea9c/crates%2Fhir_ty%2Fsrc%2Ftests%2Ftraits.rs", "raw_url": "https://github.com/rust-lang/rust/raw/35868c4f7dc479dd5f731a2785ec6a203046ea9c/crates%2Fhir_ty%2Fsrc%2Ftests%2Ftraits.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Ftests%2Ftraits.rs?ref=35868c4f7dc479dd5f731a2785ec6a203046ea9c", "patch": "@@ -2271,6 +2271,56 @@ fn test<T, U>() where T: Trait<U::Item>, U: Trait<T::Item> {\n     );\n }\n \n+#[test]\n+fn unselected_projection_in_trait_env_cycle_3() {\n+    // this is a cycle for rustc; we currently accept it\n+    check_types(\n+        r#\"\n+//- /main.rs\n+trait Trait {\n+    type Item;\n+    type OtherItem;\n+}\n+\n+fn test<T>() where T: Trait<OtherItem = T::Item> {\n+    let x: T::Item = no_matter;\n+}                   //^ Trait::Item<T>\n+\"#,\n+    );\n+}\n+\n+#[test]\n+fn unselected_projection_in_trait_env_no_cycle() {\n+    // this is not a cycle\n+    check_types(\n+        r#\"\n+//- /main.rs\n+trait Index {\n+    type Output;\n+}\n+\n+type Key<S: UnificationStoreBase> = <S as UnificationStoreBase>::Key;\n+\n+pub trait UnificationStoreBase: Index<Output = Key<Self>> {\n+    type Key;\n+\n+    fn len(&self) -> usize;\n+}\n+\n+pub trait UnificationStoreMut: UnificationStoreBase {\n+    fn push(&mut self, value: Self::Key);\n+}\n+\n+fn test<T>(t: T) where T: UnificationStoreMut {\n+    let x;\n+    t.push(x);\n+    let y: Key<T>;\n+    (x, y);\n+}      //^ (UnificationStoreBase::Key<T>, UnificationStoreBase::Key<T>)\n+\"#,\n+    );\n+}\n+\n #[test]\n fn inline_assoc_type_bounds_1() {\n     check_types("}, {"sha": "9441456038235a86760ef3fab963a8980c5c4118", "filename": "crates/hir_ty/src/traits/chalk.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/35868c4f7dc479dd5f731a2785ec6a203046ea9c/crates%2Fhir_ty%2Fsrc%2Ftraits%2Fchalk.rs", "raw_url": "https://github.com/rust-lang/rust/raw/35868c4f7dc479dd5f731a2785ec6a203046ea9c/crates%2Fhir_ty%2Fsrc%2Ftraits%2Fchalk.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Ftraits%2Fchalk.rs?ref=35868c4f7dc479dd5f731a2785ec6a203046ea9c", "patch": "@@ -395,7 +395,7 @@ pub(crate) fn associated_ty_data_query(\n     let bounds = type_alias_data\n         .bounds\n         .iter()\n-        .flat_map(|bound| ctx.lower_type_bound(bound, self_ty.clone()))\n+        .flat_map(|bound| ctx.lower_type_bound(bound, self_ty.clone(), false))\n         .filter_map(|pred| generic_predicate_to_inline_bound(db, &pred, &self_ty))\n         .map(|bound| make_binders(bound.shifted_in(&Interner), 0))\n         .collect();"}]}