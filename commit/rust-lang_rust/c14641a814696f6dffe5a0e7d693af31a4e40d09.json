{"sha": "c14641a814696f6dffe5a0e7d693af31a4e40d09", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMxNDY0MWE4MTQ2OTZmNmRmZmU1YTBlN2Q2OTNhZjMxYTRlNDBkMDk=", "commit": {"author": {"name": "Dennis Hamester", "email": "dennis.hamester@gmail.com", "date": "2020-07-22T17:53:43Z"}, "committer": {"name": "Dennis Hamester", "email": "dennis.hamester@gmail.com", "date": "2020-07-22T19:40:51Z"}, "message": "rustdoc: Add explanation when linting against public to private item links\n\nThe additional note helps explaining why the lint was triggered and that\n--document-private-items directly influences the link resolution.", "tree": {"sha": "86aecba96300b9b009e0efbad1cf6bfc04bcb436", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/86aecba96300b9b009e0efbad1cf6bfc04bcb436"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c14641a814696f6dffe5a0e7d693af31a4e40d09", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c14641a814696f6dffe5a0e7d693af31a4e40d09", "html_url": "https://github.com/rust-lang/rust/commit/c14641a814696f6dffe5a0e7d693af31a4e40d09", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c14641a814696f6dffe5a0e7d693af31a4e40d09/comments", "author": {"login": "dennis-hamester", "id": 2039492, "node_id": "MDQ6VXNlcjIwMzk0OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/2039492?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dennis-hamester", "html_url": "https://github.com/dennis-hamester", "followers_url": "https://api.github.com/users/dennis-hamester/followers", "following_url": "https://api.github.com/users/dennis-hamester/following{/other_user}", "gists_url": "https://api.github.com/users/dennis-hamester/gists{/gist_id}", "starred_url": "https://api.github.com/users/dennis-hamester/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dennis-hamester/subscriptions", "organizations_url": "https://api.github.com/users/dennis-hamester/orgs", "repos_url": "https://api.github.com/users/dennis-hamester/repos", "events_url": "https://api.github.com/users/dennis-hamester/events{/privacy}", "received_events_url": "https://api.github.com/users/dennis-hamester/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dennis-hamester", "id": 2039492, "node_id": "MDQ6VXNlcjIwMzk0OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/2039492?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dennis-hamester", "html_url": "https://github.com/dennis-hamester", "followers_url": "https://api.github.com/users/dennis-hamester/followers", "following_url": "https://api.github.com/users/dennis-hamester/following{/other_user}", "gists_url": "https://api.github.com/users/dennis-hamester/gists{/gist_id}", "starred_url": "https://api.github.com/users/dennis-hamester/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dennis-hamester/subscriptions", "organizations_url": "https://api.github.com/users/dennis-hamester/orgs", "repos_url": "https://api.github.com/users/dennis-hamester/repos", "events_url": "https://api.github.com/users/dennis-hamester/events{/privacy}", "received_events_url": "https://api.github.com/users/dennis-hamester/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ed53de029cf84651423007ec68305d6e772c819f", "url": "https://api.github.com/repos/rust-lang/rust/commits/ed53de029cf84651423007ec68305d6e772c819f", "html_url": "https://github.com/rust-lang/rust/commit/ed53de029cf84651423007ec68305d6e772c819f"}], "stats": {"total": 11, "additions": 11, "deletions": 0}, "files": [{"sha": "5187839423d6b1d8e00f981b6ee2d54f07e5a310", "filename": "src/librustdoc/passes/collect_intra_doc_links.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/c14641a814696f6dffe5a0e7d693af31a4e40d09/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c14641a814696f6dffe5a0e7d693af31a4e40d09/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs?ref=c14641a814696f6dffe5a0e7d693af31a4e40d09", "patch": "@@ -1076,6 +1076,13 @@ fn privacy_error(\n         if let Some(sp) = sp {\n             diag.span_label(sp, \"this item is private\");\n         }\n+\n+        let note_msg = if cx.render_options.document_private {\n+            \"this link resolves only because you passed `--document-private-items`, but will break without\"\n+        } else {\n+            \"this link will resolve properly if you pass `--document-private-items`\"\n+        };\n+        diag.note(note_msg);\n     });\n }\n "}, {"sha": "a2148b82f819af51783adf25929d2cc8fc24e66d", "filename": "src/test/rustdoc-ui/intra-links-private.private.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c14641a814696f6dffe5a0e7d693af31a4e40d09/src%2Ftest%2Frustdoc-ui%2Fintra-links-private.private.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c14641a814696f6dffe5a0e7d693af31a4e40d09/src%2Ftest%2Frustdoc-ui%2Fintra-links-private.private.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fintra-links-private.private.stderr?ref=c14641a814696f6dffe5a0e7d693af31a4e40d09", "patch": "@@ -5,6 +5,7 @@ LL | /// docs [DontDocMe]\n    |           ^^^^^^^^^ this item is private\n    |\n    = note: `#[warn(intra_doc_link_resolution_failure)]` on by default\n+   = note: this link resolves only because you passed `--document-private-items`, but will break without\n \n warning: 1 warning emitted\n "}, {"sha": "56742406992fcc63138c147074c0d176f207b8b8", "filename": "src/test/rustdoc-ui/intra-links-private.public.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c14641a814696f6dffe5a0e7d693af31a4e40d09/src%2Ftest%2Frustdoc-ui%2Fintra-links-private.public.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c14641a814696f6dffe5a0e7d693af31a4e40d09/src%2Ftest%2Frustdoc-ui%2Fintra-links-private.public.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fintra-links-private.public.stderr?ref=c14641a814696f6dffe5a0e7d693af31a4e40d09", "patch": "@@ -5,6 +5,7 @@ LL | /// docs [DontDocMe]\n    |           ^^^^^^^^^ this item is private\n    |\n    = note: `#[warn(intra_doc_link_resolution_failure)]` on by default\n+   = note: this link will resolve properly if you pass `--document-private-items`\n \n warning: 1 warning emitted\n "}, {"sha": "9c5cdf0117cab1683b92fba3af67696362daa24a", "filename": "src/test/rustdoc-ui/issue-74134.private.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c14641a814696f6dffe5a0e7d693af31a4e40d09/src%2Ftest%2Frustdoc-ui%2Fissue-74134.private.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c14641a814696f6dffe5a0e7d693af31a4e40d09/src%2Ftest%2Frustdoc-ui%2Fissue-74134.private.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fissue-74134.private.stderr?ref=c14641a814696f6dffe5a0e7d693af31a4e40d09", "patch": "@@ -5,6 +5,7 @@ LL |     /// [`PrivateType`]\n    |          ^^^^^^^^^^^^^ this item is private\n    |\n    = note: `#[warn(intra_doc_link_resolution_failure)]` on by default\n+   = note: this link resolves only because you passed `--document-private-items`, but will break without\n \n warning: 1 warning emitted\n "}, {"sha": "ff2951d864e642e6dd57f13068f1bfec40f50e67", "filename": "src/test/rustdoc-ui/issue-74134.public.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c14641a814696f6dffe5a0e7d693af31a4e40d09/src%2Ftest%2Frustdoc-ui%2Fissue-74134.public.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c14641a814696f6dffe5a0e7d693af31a4e40d09/src%2Ftest%2Frustdoc-ui%2Fissue-74134.public.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fissue-74134.public.stderr?ref=c14641a814696f6dffe5a0e7d693af31a4e40d09", "patch": "@@ -5,6 +5,7 @@ LL |     /// [`PrivateType`]\n    |          ^^^^^^^^^^^^^ this item is private\n    |\n    = note: `#[warn(intra_doc_link_resolution_failure)]` on by default\n+   = note: this link will resolve properly if you pass `--document-private-items`\n \n warning: 1 warning emitted\n "}]}