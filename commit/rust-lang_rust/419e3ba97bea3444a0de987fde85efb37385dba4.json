{"sha": "419e3ba97bea3444a0de987fde85efb37385dba4", "node_id": "C_kwDOAAsO6NoAKDQxOWUzYmE5N2JlYTM0NDRhMGRlOTg3ZmRlODVlZmIzNzM4NWRiYTQ", "commit": {"author": {"name": "Gary Guo", "email": "gary@garyguo.net", "date": "2022-02-09T00:02:51Z"}, "committer": {"name": "Gary Guo", "email": "gary@garyguo.net", "date": "2022-04-18T19:50:56Z"}, "message": "Add a test for issue 47384", "tree": {"sha": "a928fdd743426adafac6f8f28953c7cdfeb7b520", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a928fdd743426adafac6f8f28953c7cdfeb7b520"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/419e3ba97bea3444a0de987fde85efb37385dba4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/419e3ba97bea3444a0de987fde85efb37385dba4", "html_url": "https://github.com/rust-lang/rust/commit/419e3ba97bea3444a0de987fde85efb37385dba4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/419e3ba97bea3444a0de987fde85efb37385dba4/comments", "author": {"login": "nbdd0121", "id": 4065244, "node_id": "MDQ6VXNlcjQwNjUyNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4065244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbdd0121", "html_url": "https://github.com/nbdd0121", "followers_url": "https://api.github.com/users/nbdd0121/followers", "following_url": "https://api.github.com/users/nbdd0121/following{/other_user}", "gists_url": "https://api.github.com/users/nbdd0121/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbdd0121/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbdd0121/subscriptions", "organizations_url": "https://api.github.com/users/nbdd0121/orgs", "repos_url": "https://api.github.com/users/nbdd0121/repos", "events_url": "https://api.github.com/users/nbdd0121/events{/privacy}", "received_events_url": "https://api.github.com/users/nbdd0121/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nbdd0121", "id": 4065244, "node_id": "MDQ6VXNlcjQwNjUyNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4065244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbdd0121", "html_url": "https://github.com/nbdd0121", "followers_url": "https://api.github.com/users/nbdd0121/followers", "following_url": "https://api.github.com/users/nbdd0121/following{/other_user}", "gists_url": "https://api.github.com/users/nbdd0121/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbdd0121/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbdd0121/subscriptions", "organizations_url": "https://api.github.com/users/nbdd0121/orgs", "repos_url": "https://api.github.com/users/nbdd0121/repos", "events_url": "https://api.github.com/users/nbdd0121/events{/privacy}", "received_events_url": "https://api.github.com/users/nbdd0121/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fbc45b650a9c517ca87b0af8f108efbf50689299", "url": "https://api.github.com/repos/rust-lang/rust/commits/fbc45b650a9c517ca87b0af8f108efbf50689299", "html_url": "https://github.com/rust-lang/rust/commit/fbc45b650a9c517ca87b0af8f108efbf50689299"}], "stats": {"total": 32, "additions": 32, "deletions": 0}, "files": [{"sha": "f10365f8c88118f571b3331f765b1172933ab8ad", "filename": "src/test/run-make/issue-47384/Makefile", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/419e3ba97bea3444a0de987fde85efb37385dba4/src%2Ftest%2Frun-make%2Fissue-47384%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/419e3ba97bea3444a0de987fde85efb37385dba4/src%2Ftest%2Frun-make%2Fissue-47384%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fissue-47384%2FMakefile?ref=419e3ba97bea3444a0de987fde85efb37385dba4", "patch": "@@ -0,0 +1,12 @@\n+-include ../../run-make-fulldeps/tools.mk\n+\n+# only-linux\n+# ignore-cross-compile\n+\n+all: main.rs\n+\t$(RUSTC) --crate-type lib lib.rs\n+\t$(RUSTC) --crate-type cdylib -Clink-args=\"-Tlinker.ld\" main.rs\n+\t# Ensure `#[used]` and `KEEP`-ed section is there\n+\tobjdump -s -j\".static\" $(TMPDIR)/libmain.so\n+\t# Ensure `#[no_mangle]` symbol is there\n+\tnm $(TMPDIR)/libmain.so | $(CGREP) bar"}, {"sha": "99508bcdaf314b7a890c8ae94d07e590536039fd", "filename": "src/test/run-make/issue-47384/lib.rs", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/419e3ba97bea3444a0de987fde85efb37385dba4/src%2Ftest%2Frun-make%2Fissue-47384%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/419e3ba97bea3444a0de987fde85efb37385dba4/src%2Ftest%2Frun-make%2Fissue-47384%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fissue-47384%2Flib.rs?ref=419e3ba97bea3444a0de987fde85efb37385dba4", "patch": "@@ -0,0 +1,12 @@\n+mod foo {\n+    #[link_section = \".rodata.STATIC\"]\n+    #[used]\n+    static STATIC: [u32; 10] = [1; 10];\n+}\n+\n+mod bar {\n+    #[no_mangle]\n+    extern \"C\" fn bar() -> i32 {\n+        0\n+    }\n+}"}, {"sha": "2e70acab3f4968d105ee0fdd45d3b341779172b4", "filename": "src/test/run-make/issue-47384/linker.ld", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/419e3ba97bea3444a0de987fde85efb37385dba4/src%2Ftest%2Frun-make%2Fissue-47384%2Flinker.ld", "raw_url": "https://github.com/rust-lang/rust/raw/419e3ba97bea3444a0de987fde85efb37385dba4/src%2Ftest%2Frun-make%2Fissue-47384%2Flinker.ld", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fissue-47384%2Flinker.ld?ref=419e3ba97bea3444a0de987fde85efb37385dba4", "patch": "@@ -0,0 +1,7 @@\n+SECTIONS\n+{\n+    .static : ALIGN(4)\n+    {\n+        KEEP(*(.rodata.STATIC));\n+    }\n+}"}, {"sha": "02572632517ec69512cf75ecabda974c1647a007", "filename": "src/test/run-make/issue-47384/main.rs", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/419e3ba97bea3444a0de987fde85efb37385dba4/src%2Ftest%2Frun-make%2Fissue-47384%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/419e3ba97bea3444a0de987fde85efb37385dba4/src%2Ftest%2Frun-make%2Fissue-47384%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fissue-47384%2Fmain.rs?ref=419e3ba97bea3444a0de987fde85efb37385dba4", "patch": "@@ -0,0 +1 @@\n+extern crate lib;"}]}