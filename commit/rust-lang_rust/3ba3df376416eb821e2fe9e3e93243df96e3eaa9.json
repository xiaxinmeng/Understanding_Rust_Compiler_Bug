{"sha": "3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "node_id": "C_kwDOAAsO6NoAKDNiYTNkZjM3NjQxNmViODIxZTJmZTllM2U5MzI0M2RmOTZlM2VhYTk", "commit": {"author": {"name": "Nikolay Arhipov", "email": "n@arhipov.net", "date": "2023-05-07T08:20:01Z"}, "committer": {"name": "Nikolay Arhipov", "email": "n@arhipov.net", "date": "2023-05-07T15:57:43Z"}, "message": "PS Vita std support", "tree": {"sha": "7176368105a3060d698e4134b8f2779fc7b442fc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7176368105a3060d698e4134b8f2779fc7b442fc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "html_url": "https://github.com/rust-lang/rust/commit/3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/comments", "author": {"login": "nikarh", "id": 5517011, "node_id": "MDQ6VXNlcjU1MTcwMTE=", "avatar_url": "https://avatars.githubusercontent.com/u/5517011?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikarh", "html_url": "https://github.com/nikarh", "followers_url": "https://api.github.com/users/nikarh/followers", "following_url": "https://api.github.com/users/nikarh/following{/other_user}", "gists_url": "https://api.github.com/users/nikarh/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikarh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikarh/subscriptions", "organizations_url": "https://api.github.com/users/nikarh/orgs", "repos_url": "https://api.github.com/users/nikarh/repos", "events_url": "https://api.github.com/users/nikarh/events{/privacy}", "received_events_url": "https://api.github.com/users/nikarh/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikarh", "id": 5517011, "node_id": "MDQ6VXNlcjU1MTcwMTE=", "avatar_url": "https://avatars.githubusercontent.com/u/5517011?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikarh", "html_url": "https://github.com/nikarh", "followers_url": "https://api.github.com/users/nikarh/followers", "following_url": "https://api.github.com/users/nikarh/following{/other_user}", "gists_url": "https://api.github.com/users/nikarh/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikarh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikarh/subscriptions", "organizations_url": "https://api.github.com/users/nikarh/orgs", "repos_url": "https://api.github.com/users/nikarh/repos", "events_url": "https://api.github.com/users/nikarh/events{/privacy}", "received_events_url": "https://api.github.com/users/nikarh/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0dddad0dc5d614f799d7e04de4895e7a7418eccb", "url": "https://api.github.com/repos/rust-lang/rust/commits/0dddad0dc5d614f799d7e04de4895e7a7418eccb", "html_url": "https://github.com/rust-lang/rust/commit/0dddad0dc5d614f799d7e04de4895e7a7418eccb"}], "stats": {"total": 363, "additions": 322, "deletions": 41}, "files": [{"sha": "67392f1b3a9949c8f338a687efdff5a00e882d69", "filename": "Cargo.lock", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -1938,9 +1938,9 @@ checksum = \"830d08ce1d1d941e6b30645f1a0eb5643013d835ce3779a5fc208261dbe10f55\"\n \n [[package]]\n name = \"libc\"\n-version = \"0.2.142\"\n+version = \"0.2.143\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"6a987beff54b60ffa6d51982e1aa1146bc42f19bd26be28b0586f252fccf5317\"\n+checksum = \"edc207893e85c5d6be840e969b496b53d94cec8be2d501b214f50daa97fa8024\"\n dependencies = [\n  \"rustc-std-workspace-core\",\n ]"}, {"sha": "0fd59cbd48324e22dc23691555ec29297cec42d8", "filename": "compiler/rustc_target/src/spec/armv7_sony_vita_newlibeabihf.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/compiler%2Frustc_target%2Fsrc%2Fspec%2Farmv7_sony_vita_newlibeabihf.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/compiler%2Frustc_target%2Fsrc%2Fspec%2Farmv7_sony_vita_newlibeabihf.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Farmv7_sony_vita_newlibeabihf.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -9,7 +9,7 @@ pub fn target() -> Target {\n     let pre_link_args = TargetOptions::link_args(LinkerFlavor::Gnu(Cc::Yes, Lld::No), &[\"-Wl,-q\"]);\n \n     Target {\n-        llvm_target: \"armv7a-vita-newlibeabihf\".into(),\n+        llvm_target: \"armv7a-vita-eabihf\".into(),\n         pointer_width: 32,\n         data_layout: \"e-m:e-p:32:32-Fi8-i64:64-v128:64:128-a:0:32-n32-S64\".into(),\n         arch: \"arm\".into(),"}, {"sha": "4245978ca8169c40c088ff733825e4527f7b914c", "filename": "library/backtrace", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": null, "raw_url": null, "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fbacktrace?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -1 +1 @@\n-Subproject commit 8ad84ca5ad88ade697637387e7cb4d7c3cf4bde8\n+Subproject commit 4245978ca8169c40c088ff733825e4527f7b914c"}, {"sha": "77a0426f233b1194683ac1b531b195b6993265a9", "filename": "library/std/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2FCargo.toml?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -15,7 +15,7 @@ cfg-if = { version = \"1.0\", features = ['rustc-dep-of-std'] }\n panic_unwind = { path = \"../panic_unwind\", optional = true }\n panic_abort = { path = \"../panic_abort\" }\n core = { path = \"../core\" }\n-libc = { version = \"0.2.142\", default-features = false, features = ['rustc-dep-of-std'] }\n+libc = { version = \"0.2.143\", default-features = false, features = ['rustc-dep-of-std'] }\n compiler_builtins = { version = \"0.1.91\" }\n profiler_builtins = { path = \"../profiler_builtins\", optional = true }\n unwind = { path = \"../unwind\" }"}, {"sha": "0fb03c8e88af5f02f9946f2b5ac0cb07dfa4c833", "filename": "library/std/build.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fbuild.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -34,6 +34,7 @@ fn main() {\n         || target.contains(\"espidf\")\n         || target.contains(\"solid\")\n         || target.contains(\"nintendo-3ds\")\n+        || target.contains(\"vita\")\n         || target.contains(\"nto\")\n     {\n         // These platforms don't have any special requirements."}, {"sha": "5b54cc5f2e4913f191566667edbafd504e037842", "filename": "library/std/src/os/mod.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fos%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fos%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fos%2Fmod.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -137,6 +137,8 @@ pub mod redox;\n pub mod solaris;\n #[cfg(target_os = \"solid_asp3\")]\n pub mod solid;\n+#[cfg(target_os = \"vita\")]\n+pub mod vita;\n #[cfg(target_os = \"vxworks\")]\n pub mod vxworks;\n #[cfg(target_os = \"watchos\")]"}, {"sha": "6fe1111188aa880a5f1f58b47f63dbc3db8098eb", "filename": "library/std/src/os/unix/mod.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fos%2Funix%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fos%2Funix%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fos%2Funix%2Fmod.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -73,6 +73,8 @@ mod platform {\n     pub use crate::os::redox::*;\n     #[cfg(target_os = \"solaris\")]\n     pub use crate::os::solaris::*;\n+    #[cfg(target_os = \"vita\")]\n+    pub use crate::os::vita::*;\n     #[cfg(target_os = \"vxworks\")]\n     pub use crate::os::vxworks::*;\n     #[cfg(target_os = \"watchos\")]"}, {"sha": "a5a06764a4dd8aef4e0057850635e4fdd4df60f8", "filename": "library/std/src/os/vita/fs.rs", "status": "added", "additions": 95, "deletions": 0, "changes": 95, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fos%2Fvita%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fos%2Fvita%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fos%2Fvita%2Ffs.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -0,0 +1,95 @@\n+#![stable(feature = \"metadata_ext\", since = \"1.1.0\")]\n+\n+use crate::fs::Metadata;\n+use crate::sys_common::AsInner;\n+\n+/// OS-specific extensions to [`fs::Metadata`].\n+///\n+/// [`fs::Metadata`]: crate::fs::Metadata\n+#[stable(feature = \"metadata_ext\", since = \"1.1.0\")]\n+pub trait MetadataExt {\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_dev(&self) -> u64;\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_ino(&self) -> u64;\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_mode(&self) -> u32;\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_nlink(&self) -> u64;\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_uid(&self) -> u32;\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_gid(&self) -> u32;\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_rdev(&self) -> u64;\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_size(&self) -> u64;\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_atime(&self) -> i64;\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_atime_nsec(&self) -> i64;\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_mtime(&self) -> i64;\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_mtime_nsec(&self) -> i64;\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_ctime(&self) -> i64;\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_ctime_nsec(&self) -> i64;\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_blksize(&self) -> u64;\n+    #[stable(feature = \"metadata_ext2\", since = \"1.8.0\")]\n+    fn st_blocks(&self) -> u64;\n+}\n+\n+#[stable(feature = \"metadata_ext\", since = \"1.1.0\")]\n+impl MetadataExt for Metadata {\n+    fn st_dev(&self) -> u64 {\n+        self.as_inner().as_inner().st_dev as u64\n+    }\n+    fn st_ino(&self) -> u64 {\n+        self.as_inner().as_inner().st_ino as u64\n+    }\n+    fn st_mode(&self) -> u32 {\n+        self.as_inner().as_inner().st_mode as u32\n+    }\n+    fn st_nlink(&self) -> u64 {\n+        self.as_inner().as_inner().st_nlink as u64\n+    }\n+    fn st_uid(&self) -> u32 {\n+        self.as_inner().as_inner().st_uid as u32\n+    }\n+    fn st_gid(&self) -> u32 {\n+        self.as_inner().as_inner().st_gid as u32\n+    }\n+    fn st_rdev(&self) -> u64 {\n+        self.as_inner().as_inner().st_rdev as u64\n+    }\n+    fn st_size(&self) -> u64 {\n+        self.as_inner().as_inner().st_size as u64\n+    }\n+    fn st_atime(&self) -> i64 {\n+        self.as_inner().as_inner().st_atime as i64\n+    }\n+    fn st_atime_nsec(&self) -> i64 {\n+        0\n+    }\n+    fn st_mtime(&self) -> i64 {\n+        self.as_inner().as_inner().st_mtime as i64\n+    }\n+    fn st_mtime_nsec(&self) -> i64 {\n+        0\n+    }\n+    fn st_ctime(&self) -> i64 {\n+        self.as_inner().as_inner().st_ctime as i64\n+    }\n+    fn st_ctime_nsec(&self) -> i64 {\n+        0\n+    }\n+    fn st_blksize(&self) -> u64 {\n+        self.as_inner().as_inner().st_blksize as u64\n+    }\n+    fn st_blocks(&self) -> u64 {\n+        self.as_inner().as_inner().st_blocks as u64\n+    }\n+}"}, {"sha": "da9edd12f7b03daddc3544113395779027eb9f7b", "filename": "library/std/src/os/vita/mod.rs", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fos%2Fvita%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fos%2Fvita%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fos%2Fvita%2Fmod.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -0,0 +1,6 @@\n+//! Definitions for vita\n+\n+#![stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+\n+pub mod fs;\n+pub(crate) mod raw;"}, {"sha": "74cae4d4135d18c755f14be18c4ad1094b4463c2", "filename": "library/std/src/os/vita/raw.rs", "status": "added", "additions": 70, "deletions": 0, "changes": 70, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fos%2Fvita%2Fraw.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fos%2Fvita%2Fraw.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fos%2Fvita%2Fraw.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -0,0 +1,70 @@\n+//! vita raw type definitions\n+\n+#![stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+#![deprecated(\n+    since = \"1.8.0\",\n+    note = \"these type aliases are no longer supported by \\\n+            the standard library, the `libc` crate on \\\n+            crates.io should be used instead for the correct \\\n+            definitions\"\n+)]\n+#![allow(deprecated)]\n+\n+use crate::os::raw::c_long;\n+use crate::os::unix::raw::{gid_t, uid_t};\n+\n+#[stable(feature = \"pthread_t\", since = \"1.8.0\")]\n+pub type pthread_t = libc::pthread_t;\n+\n+#[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+pub type blkcnt_t = libc::blkcnt_t;\n+\n+#[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+pub type blksize_t = libc::blksize_t;\n+#[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+pub type dev_t = libc::dev_t;\n+#[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+pub type ino_t = libc::ino_t;\n+#[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+pub type mode_t = libc::mode_t;\n+#[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+pub type nlink_t = libc::nlink_t;\n+#[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+pub type off_t = libc::off_t;\n+\n+#[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+pub type time_t = libc::time_t;\n+\n+#[repr(C)]\n+#[derive(Clone)]\n+#[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+pub struct stat {\n+    #[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+    pub st_dev: dev_t,\n+    #[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+    pub st_ino: ino_t,\n+    #[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+    pub st_mode: mode_t,\n+    #[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+    pub st_nlink: nlink_t,\n+    #[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+    pub st_uid: uid_t,\n+    #[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+    pub st_gid: gid_t,\n+    #[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+    pub st_rdev: dev_t,\n+    #[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+    pub st_size: off_t,\n+    #[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+    pub st_atime: time_t,\n+    #[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+    pub st_mtime: time_t,\n+    #[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+    pub st_ctime: time_t,\n+    #[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+    pub st_blksize: blksize_t,\n+    #[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+    pub st_blocks: blkcnt_t,\n+    #[stable(feature = \"raw_ext\", since = \"1.1.0\")]\n+    pub st_spare4: [c_long; 2usize],\n+}"}, {"sha": "8604b53983d6cb7b4c03d092887ac9ef9d3cb77d", "filename": "library/std/src/sys/unix/alloc.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Falloc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Falloc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Falloc.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -59,7 +59,8 @@ cfg_if::cfg_if! {\n         target_os = \"redox\",\n         target_os = \"solaris\",\n         target_os = \"espidf\",\n-        target_os = \"horizon\"\n+        target_os = \"horizon\",\n+        target_os = \"vita\",\n     ))] {\n         #[inline]\n         unsafe fn aligned_malloc(layout: &Layout) -> *mut u8 {"}, {"sha": "9ed4d9c1e0dd395b16884c221bab1c1a2bea2fdd", "filename": "library/std/src/sys/unix/args.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fargs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fargs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fargs.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -265,7 +265,7 @@ mod imp {\n     }\n }\n \n-#[cfg(target_os = \"espidf\")]\n+#[cfg(any(target_os = \"espidf\", target_os = \"vita\"))]\n mod imp {\n     use super::Args;\n "}, {"sha": "8c3ef88d8f8e02ee18cb981b827e3c2181864b14", "filename": "library/std/src/sys/unix/env.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fenv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fenv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fenv.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -141,6 +141,17 @@ pub mod os {\n     pub const EXE_EXTENSION: &str = \"elf\";\n }\n \n+#[cfg(target_os = \"vita\")]\n+pub mod os {\n+    pub const FAMILY: &str = \"unix\";\n+    pub const OS: &str = \"vita\";\n+    pub const DLL_PREFIX: &str = \"lib\";\n+    pub const DLL_SUFFIX: &str = \".so\";\n+    pub const DLL_EXTENSION: &str = \"so\";\n+    pub const EXE_SUFFIX: &str = \".elf\";\n+    pub const EXE_EXTENSION: &str = \"elf\";\n+}\n+\n #[cfg(all(target_os = \"emscripten\", target_arch = \"asmjs\"))]\n pub mod os {\n     pub const FAMILY: &str = \"unix\";"}, {"sha": "cb630eede6da0b983cc71699f40408d030ac40d9", "filename": "library/std/src/sys/unix/fd.rs", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Ffd.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Ffd.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Ffd.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -75,6 +75,7 @@ const fn max_iov() -> usize {\n     target_os = \"nto\",\n     target_os = \"openbsd\",\n     target_os = \"horizon\",\n+    target_os = \"vita\",\n     target_os = \"watchos\",\n )))]\n const fn max_iov() -> usize {\n@@ -93,7 +94,7 @@ impl FileDesc {\n         Ok(ret as usize)\n     }\n \n-    #[cfg(not(any(target_os = \"espidf\", target_os = \"horizon\")))]\n+    #[cfg(not(any(target_os = \"espidf\", target_os = \"horizon\", target_os = \"vita\")))]\n     pub fn read_vectored(&self, bufs: &mut [IoSliceMut<'_>]) -> io::Result<usize> {\n         let ret = cvt(unsafe {\n             libc::readv(\n@@ -105,14 +106,14 @@ impl FileDesc {\n         Ok(ret as usize)\n     }\n \n-    #[cfg(any(target_os = \"espidf\", target_os = \"horizon\"))]\n+    #[cfg(any(target_os = \"espidf\", target_os = \"horizon\", target_os = \"vita\"))]\n     pub fn read_vectored(&self, bufs: &mut [IoSliceMut<'_>]) -> io::Result<usize> {\n         io::default_read_vectored(|b| self.read(b), bufs)\n     }\n \n     #[inline]\n     pub fn is_read_vectored(&self) -> bool {\n-        cfg!(not(any(target_os = \"espidf\", target_os = \"horizon\")))\n+        cfg!(not(any(target_os = \"espidf\", target_os = \"horizon\", target_os = \"vita\")))\n     }\n \n     pub fn read_to_end(&self, buf: &mut Vec<u8>) -> io::Result<usize> {\n@@ -253,7 +254,7 @@ impl FileDesc {\n         Ok(ret as usize)\n     }\n \n-    #[cfg(not(any(target_os = \"espidf\", target_os = \"horizon\")))]\n+    #[cfg(not(any(target_os = \"espidf\", target_os = \"horizon\", target_os = \"vita\")))]\n     pub fn write_vectored(&self, bufs: &[IoSlice<'_>]) -> io::Result<usize> {\n         let ret = cvt(unsafe {\n             libc::writev(\n@@ -265,14 +266,14 @@ impl FileDesc {\n         Ok(ret as usize)\n     }\n \n-    #[cfg(any(target_os = \"espidf\", target_os = \"horizon\"))]\n+    #[cfg(any(target_os = \"espidf\", target_os = \"horizon\", target_os = \"vita\"))]\n     pub fn write_vectored(&self, bufs: &[IoSlice<'_>]) -> io::Result<usize> {\n         io::default_write_vectored(|b| self.write(b), bufs)\n     }\n \n     #[inline]\n     pub fn is_write_vectored(&self) -> bool {\n-        cfg!(not(any(target_os = \"espidf\", target_os = \"horizon\")))\n+        cfg!(not(any(target_os = \"espidf\", target_os = \"horizon\", target_os = \"vita\")))\n     }\n \n     pub fn write_at(&self, buf: &[u8], offset: u64) -> io::Result<usize> {"}, {"sha": "22d2ae397137a1441a225d5e9b814f45c934a025", "filename": "library/std/src/sys/unix/fs.rs", "status": "modified", "additions": 15, "deletions": 4, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Ffs.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -447,7 +447,12 @@ impl FileAttr {\n \n #[cfg(not(any(target_os = \"netbsd\", target_os = \"nto\")))]\n impl FileAttr {\n-    #[cfg(not(any(target_os = \"vxworks\", target_os = \"espidf\", target_os = \"horizon\")))]\n+    #[cfg(not(any(\n+        target_os = \"vxworks\",\n+        target_os = \"espidf\",\n+        target_os = \"horizon\",\n+        target_os = \"vita\"\n+    )))]\n     pub fn modified(&self) -> io::Result<SystemTime> {\n         #[cfg(target_pointer_width = \"32\")]\n         cfg_has_statx! {\n@@ -459,7 +464,7 @@ impl FileAttr {\n         Ok(SystemTime::new(self.stat.st_mtime as i64, self.stat.st_mtime_nsec as i64))\n     }\n \n-    #[cfg(any(target_os = \"vxworks\", target_os = \"espidf\"))]\n+    #[cfg(any(target_os = \"vxworks\", target_os = \"espidf\", target_os = \"vita\"))]\n     pub fn modified(&self) -> io::Result<SystemTime> {\n         Ok(SystemTime::new(self.stat.st_mtime as i64, 0))\n     }\n@@ -469,7 +474,12 @@ impl FileAttr {\n         Ok(SystemTime::from(self.stat.st_mtim))\n     }\n \n-    #[cfg(not(any(target_os = \"vxworks\", target_os = \"espidf\", target_os = \"horizon\")))]\n+    #[cfg(not(any(\n+        target_os = \"vxworks\",\n+        target_os = \"espidf\",\n+        target_os = \"horizon\",\n+        target_os = \"vita\"\n+    )))]\n     pub fn accessed(&self) -> io::Result<SystemTime> {\n         #[cfg(target_pointer_width = \"32\")]\n         cfg_has_statx! {\n@@ -481,7 +491,7 @@ impl FileAttr {\n         Ok(SystemTime::new(self.stat.st_atime as i64, self.stat.st_atime_nsec as i64))\n     }\n \n-    #[cfg(any(target_os = \"vxworks\", target_os = \"espidf\"))]\n+    #[cfg(any(target_os = \"vxworks\", target_os = \"espidf\", target_os = \"vita\"))]\n     pub fn accessed(&self) -> io::Result<SystemTime> {\n         Ok(SystemTime::new(self.stat.st_atime as i64, 0))\n     }\n@@ -866,6 +876,7 @@ impl DirEntry {\n         target_os = \"vxworks\",\n         target_os = \"espidf\",\n         target_os = \"horizon\",\n+        target_os = \"vita\",\n         target_os = \"nto\",\n     ))]\n     pub fn ino(&self) -> u64 {"}, {"sha": "bb9e65e68e5e877268a3b0191becfa2b53eef91e", "filename": "library/std/src/sys/unix/mod.rs", "status": "modified", "additions": 13, "deletions": 4, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fmod.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -92,6 +92,7 @@ pub unsafe fn init(argc: isize, argv: *const *const u8, sigpipe: u8) {\n             target_os = \"redox\",\n             target_os = \"l4re\",\n             target_os = \"horizon\",\n+            target_os = \"vita\",\n         )))]\n         'poll: {\n             use crate::sys::os::errno;\n@@ -140,6 +141,7 @@ pub unsafe fn init(argc: isize, argv: *const *const u8, sigpipe: u8) {\n             target_os = \"vxworks\",\n             target_os = \"l4re\",\n             target_os = \"horizon\",\n+            target_os = \"vita\",\n         )))]\n         {\n             use crate::sys::os::errno;\n@@ -162,7 +164,12 @@ pub unsafe fn init(argc: isize, argv: *const *const u8, sigpipe: u8) {\n     }\n \n     unsafe fn reset_sigpipe(#[allow(unused_variables)] sigpipe: u8) {\n-        #[cfg(not(any(target_os = \"emscripten\", target_os = \"fuchsia\", target_os = \"horizon\")))]\n+        #[cfg(not(any(\n+            target_os = \"emscripten\",\n+            target_os = \"fuchsia\",\n+            target_os = \"horizon\",\n+            target_os = \"vita\"\n+        )))]\n         {\n             // We don't want to add this as a public type to std, nor do we\n             // want to `include!` a file from the compiler (which would break\n@@ -199,7 +206,8 @@ pub unsafe fn init(argc: isize, argv: *const *const u8, sigpipe: u8) {\n     target_os = \"espidf\",\n     target_os = \"emscripten\",\n     target_os = \"fuchsia\",\n-    target_os = \"horizon\"\n+    target_os = \"horizon\",\n+    target_os = \"vita\"\n )))]\n static UNIX_SIGPIPE_ATTR_SPECIFIED: crate::sync::atomic::AtomicBool =\n     crate::sync::atomic::AtomicBool::new(false);\n@@ -208,7 +216,8 @@ static UNIX_SIGPIPE_ATTR_SPECIFIED: crate::sync::atomic::AtomicBool =\n     target_os = \"espidf\",\n     target_os = \"emscripten\",\n     target_os = \"fuchsia\",\n-    target_os = \"horizon\"\n+    target_os = \"horizon\",\n+    target_os = \"vita\",\n )))]\n pub(crate) fn unix_sigpipe_attr_specified() -> bool {\n     UNIX_SIGPIPE_ATTR_SPECIFIED.load(crate::sync::atomic::Ordering::Relaxed)\n@@ -402,7 +411,7 @@ cfg_if::cfg_if! {\n     }\n }\n \n-#[cfg(any(target_os = \"espidf\", target_os = \"horizon\"))]\n+#[cfg(any(target_os = \"espidf\", target_os = \"horizon\", target_os = \"vita\"))]\n mod unsupported {\n     use crate::io;\n "}, {"sha": "8edfd331304426fba22a0c0336ef5681cac514f4", "filename": "library/std/src/sys/unix/os.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fos.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fos.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fos.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -460,7 +460,7 @@ pub fn current_exe() -> io::Result<PathBuf> {\n     path.canonicalize()\n }\n \n-#[cfg(any(target_os = \"espidf\", target_os = \"horizon\"))]\n+#[cfg(any(target_os = \"espidf\", target_os = \"horizon\", target_os = \"vita\"))]\n pub fn current_exe() -> io::Result<PathBuf> {\n     super::unsupported::unsupported()\n }\n@@ -614,7 +614,8 @@ pub fn home_dir() -> Option<PathBuf> {\n         target_os = \"redox\",\n         target_os = \"vxworks\",\n         target_os = \"espidf\",\n-        target_os = \"horizon\"\n+        target_os = \"horizon\",\n+        target_os = \"vita\",\n     ))]\n     unsafe fn fallback() -> Option<OsString> {\n         None\n@@ -627,7 +628,8 @@ pub fn home_dir() -> Option<PathBuf> {\n         target_os = \"redox\",\n         target_os = \"vxworks\",\n         target_os = \"espidf\",\n-        target_os = \"horizon\"\n+        target_os = \"horizon\",\n+        target_os = \"vita\",\n     )))]\n     unsafe fn fallback() -> Option<OsString> {\n         let amt = match libc::sysconf(libc::_SC_GETPW_R_SIZE_MAX) {"}, {"sha": "0cf163d9fb8e9409e70f54a533645bf4a701e252", "filename": "library/std/src/sys/unix/process/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fprocess%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fprocess%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fprocess%2Fmod.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -14,7 +14,7 @@ cfg_if::cfg_if! {\n     } else if #[cfg(target_os = \"vxworks\")] {\n         #[path = \"process_vxworks.rs\"]\n         mod process_inner;\n-    } else if #[cfg(any(target_os = \"espidf\", target_os = \"horizon\"))] {\n+    } else if #[cfg(any(target_os = \"espidf\", target_os = \"horizon\", target_os = \"vita\"))] {\n         #[path = \"process_unsupported.rs\"]\n         mod process_inner;\n     } else {"}, {"sha": "d8b63546b9ed1d129d95926f96d8c95326c86764", "filename": "library/std/src/sys/unix/rand.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Frand.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/library%2Fstd%2Fsrc%2Fsys%2Funix%2Frand.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Frand.rs?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -21,7 +21,8 @@ pub fn hashmap_random_keys() -> (u64, u64) {\n     not(target_os = \"fuchsia\"),\n     not(target_os = \"redox\"),\n     not(target_os = \"vxworks\"),\n-    not(target_os = \"emscripten\")\n+    not(target_os = \"emscripten\"),\n+    not(target_os = \"vita\"),\n ))]\n mod imp {\n     use crate::fs::File;\n@@ -175,7 +176,7 @@ mod imp {\n     }\n }\n \n-#[cfg(any(target_os = \"openbsd\", target_os = \"emscripten\"))]\n+#[cfg(any(target_os = \"openbsd\", target_os = \"emscripten\", target_os = \"vita\"))]\n mod imp {\n     use crate::sys::os::errno;\n "}, {"sha": "d75bd92beda73d80a1e06dfa941fe1cec2fb2882", "filename": "src/doc/rustc/src/platform-support/armv7-sony-vita-newlibeabihf.md", "status": "renamed", "additions": 83, "deletions": 14, "changes": 97, "blob_url": "https://github.com/rust-lang/rust/blob/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support%2Farmv7-sony-vita-newlibeabihf.md", "raw_url": "https://github.com/rust-lang/rust/raw/3ba3df376416eb821e2fe9e3e93243df96e3eaa9/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support%2Farmv7-sony-vita-newlibeabihf.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support%2Farmv7-sony-vita-newlibeabihf.md?ref=3ba3df376416eb821e2fe9e3e93243df96e3eaa9", "patch": "@@ -1,26 +1,40 @@\n-# armv7-sony-vita-eabihf\n+# armv7-sony-vita-newlibeabihf\n \n **Tier: 3**\n \n This tier supports the ARM Cortex A9 processor running on a PlayStation Vita console. `armv7-vita-newlibeabihf` aims to have support for `std` crate using `newlib` as a bridge.\n \n+Rust support for this target is not affiliated with Sony, and is not derived\n+from nor used with any official Sony SDK.\n+\n ## Designated Developers\n \n * [@amg98](https://github.com/amg98)\n+* [@nikarh](https://github.com/nikarh)\n \n ## Requirements\n \n-This target is cross compiled, and requires installing [VITASDK](https://vitasdk.org/) toolchain on your system.\n+This target is cross-compiled, and requires installing [VITASDK](https://vitasdk.org/) toolchain on your system. Dynamic linking is not supported.\n+\n+`#![no_std]` crates can be built using `build-std` to build `core`, and optionally\n+`alloc`, and `panic_abort`.\n+\n+`std` is partially supported, but mostly works. Some APIs are unimplemented\n+and will simply return an error, such as `std::process`. An allocator is provided\n+by default.\n+\n+In order to support some APIs, binaries must be linked against `libc` written\n+for the target, using a linker for the target. These are provided by the\n+VITASDK toolchain.\n+\n+This target generates binaries in the ELF format.\n \n ## Building\n \n-You can build Rust with support for the target by adding it to the `target`\n-list in `config.toml`:\n+Rust does not ship pre-compiled artifacts for this target. You can use `build-std` flag to build binaries with `std`:\n \n-```toml\n-[build]\n-build-stage = 1\n-target = [\"armv7-sony-vita-newlibeabihf\"]\n+```sh\n+cargo build -Z build-std=std,panic_abort --target=armv7-sony-vita-newlibeabihf --release\n ```\n \n ## Cross-compilation\n@@ -33,26 +47,81 @@ Currently there is no support to run the rustc test suite for this target.\n \n ## Building and Running Rust Programs\n \n-To test your developed rust programs for PlayStation Vita, first you have to prepare a proper executable for the device using the resulting ELF file you get from compilation step. The needed steps can be automated using tools like `cargo-make`. Use the example below as a template for your project:\n+`std` support for this target relies on newlib. In order to work, newlib must be initialized correctly. The easiest way to achieve this with VITASDK newlib implementation is by compiling your program as a staticlib with and exposing your main function from rust to `_init` function in `crt0`.\n+\n+Add this to your `Cargo.toml`:\n+\n+```toml\n+[lib]\n+crate-type = [\"staticlib\"]\n+\n+[profile.release]\n+panic = 'abort'\n+lto = true\n+opt-level = 3\n+```\n+\n+Your entrypoint should look roughly like this, `src/lib.rs`:\n+```rust,ignore,no_run\n+#[used]\n+#[export_name = \"_newlib_heap_size_user\"]\n+pub static _NEWLIB_HEAP_SIZE_USER: u32 = 100 * 1024 * 1024; // Default heap size is only 32mb, increase it to something suitable for your application\n+\n+#[no_mangle]\n+pub extern \"C\" fn main() {\n+    println!(\"Hello, world!\");\n+}\n+```\n+\n+To test your developed rust programs on PlayStation Vita, first you must correctly link and package your rust staticlib. These steps can be preformed using tools available in VITASDK, and can be automated using tools like `cargo-make`.\n+\n+First, set up environment variables for `VITASDK`, and it's binaries:\n+\n+```sh\n+export VITASDK=/opt/vitasdk\n+export PATH=$PATH:$VITASDK/bin\n+```\n+\n+Use the example below as a template for your project:\n \n ```toml\n [env]\n TITLE = \"Rust Hello World\"\n TITLEID = \"RUST00001\"\n+# Add other libs required by your project here\n+LINKER_LIBS = \"-lpthread -lm -lmathneon\"\n+\n # At least a \"sce_sys\" folder should be place there for app metadata (title, icons, description...)\n # You can find sample assets for that on $VITASDK/share/gcc-arm-vita-eabi/samples/hello_world/sce_sys/\n STATIC_DIR = \"static\"   # Folder where static assets should be placed (sce_sys folder is at $STATIC_DIR/sce_sys)\n CARGO_TARGET_DIR = { script = [\"echo ${CARGO_TARGET_DIR:=target}\"] }\n-RUST_TARGET_PATH = { script = [\"echo $(pwd)\"]}\n RUST_TARGET = \"armv7-sony-vita-newlibeabihf\"\n CARGO_OUT_DIR = \"${CARGO_TARGET_DIR}/${RUST_TARGET}/release\"\n \n-[tasks.xbuild]\n-# This is the command where you get the ELF executable file (e.g. call to cargo build)\n+TARGET_LINKER = \"arm-vita-eabi-gcc\"\n+TARGET_LINKER_FLAGS = \"-Wl,-q\"\n+\n+[tasks.build]\n+description = \"Build the project using `cargo` as a static lib.\"\n+command = \"cargo\"\n+args = [\"build\", \"-Z\", \"build-std=std,panic_abort\", \"--target=armv7-sony-vita-newlibeabihf\", \"--release\"]\n+\n+[tasks.link]\n+description = \"Build an ELF executable using the `vitasdk` linker.\"\n+dependencies = [\"build\"]\n+script = [\n+    \"\"\"\n+    ${TARGET_LINKER} ${TARGET_LINKER_FLAGS} \\\n+        -L\"${CARGO_OUT_DIR}\" \\\n+        -l\"${CARGO_MAKE_CRATE_FS_NAME}\" \\\n+        ${LINKER_LIBS} \\\n+        -o\"${CARGO_OUT_DIR}/${CARGO_MAKE_CRATE_NAME}.elf\"\n+    \"\"\"\n+]\n \n [tasks.strip]\n description = \"Strip the produced ELF executable.\"\n-dependencies = [\"xbuild\"]\n+dependencies = [\"link\"]\n command = \"arm-vita-eabi-strip\"\n args = [\"-g\", '${CARGO_OUT_DIR}/${CARGO_MAKE_CRATE_FS_NAME}.elf']\n \n@@ -124,4 +193,4 @@ script = [\n ]\n ```\n \n-After running the above script, you should be able to get a *.vpk file in the same folder your *.elf executable resides. Now you can pick it and install it on your own PlayStation Vita using, for example, [VitaShell](https://github.com/TheOfficialFloW/VitaShell/releases) or you can use an emulator. For the time being, the most mature emulator for PlayStation Vita is [Vita3K](https://vita3k.org/), although I personally recommend testing your programs in real hardware, as the emulator is quite experimental.\n+After running the above script, you should be able to get a *.vpk file in the same folder your *.elf executable resides. Now you can pick it and install it on your own PlayStation Vita using, or you can use an [Vita3K](https://vita3k.org/) emulator.", "previous_filename": "src/doc/rustc/src/platform-support/armv7-sony-vita-eabihf.md"}]}