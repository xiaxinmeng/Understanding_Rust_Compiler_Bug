{"sha": "563152d8830737b65d39d280214b1a64aa006f98", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU2MzE1MmQ4ODMwNzM3YjY1ZDM5ZDI4MDIxNGIxYTY0YWEwMDZmOTg=", "commit": {"author": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2020-04-08T14:49:57Z"}, "committer": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2020-04-08T14:49:57Z"}, "message": "comment pessimistic yield and saving/restoring state", "tree": {"sha": "0b208d47995be2c33f798e150266f1858a6da06e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0b208d47995be2c33f798e150266f1858a6da06e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/563152d8830737b65d39d280214b1a64aa006f98", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/563152d8830737b65d39d280214b1a64aa006f98", "html_url": "https://github.com/rust-lang/rust/commit/563152d8830737b65d39d280214b1a64aa006f98", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/563152d8830737b65d39d280214b1a64aa006f98/comments", "author": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cd9f709a33b952d52c34e037dc13adfe0a3efb8d", "url": "https://api.github.com/repos/rust-lang/rust/commits/cd9f709a33b952d52c34e037dc13adfe0a3efb8d", "html_url": "https://github.com/rust-lang/rust/commit/cd9f709a33b952d52c34e037dc13adfe0a3efb8d"}], "stats": {"total": 7, "additions": 7, "deletions": 0}, "files": [{"sha": "32e7e8843a07caf367cc5a0a99058c2741dd5e6a", "filename": "src/librustc_passes/region.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/563152d8830737b65d39d280214b1a64aa006f98/src%2Flibrustc_passes%2Fregion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/563152d8830737b65d39d280214b1a64aa006f98/src%2Flibrustc_passes%2Fregion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_passes%2Fregion.rs?ref=563152d8830737b65d39d280214b1a64aa006f98", "patch": "@@ -717,9 +717,16 @@ impl<'tcx> Visitor<'tcx> for RegionResolutionVisitor<'tcx> {\n             self.cx.parent\n         );\n \n+        // Save all state that is specific to the outer function\n+        // body. These will be restored once down below, once we've\n+        // visited the body.\n         let outer_ec = mem::replace(&mut self.expr_and_pat_count, 0);\n         let outer_cx = self.cx;\n         let outer_ts = mem::take(&mut self.terminating_scopes);\n+        // The 'pessimistic yield' flag is set to true when we are\n+        // processing a `+=` statement and have to make pessimistic\n+        // control flow assumptions. This doesn't apply to nested\n+        // bodies within the `+=` statements. See #69307.\n         let outer_pessimistic_yield = mem::replace(&mut self.pessimistic_yield, false);\n         self.terminating_scopes.insert(body.value.hir_id.local_id);\n "}]}