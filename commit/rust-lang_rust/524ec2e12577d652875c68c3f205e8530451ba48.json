{"sha": "524ec2e12577d652875c68c3f205e8530451ba48", "node_id": "C_kwDOAAsO6NoAKDUyNGVjMmUxMjU3N2Q2NTI4NzVjNjhjM2YyMDVlODUzMDQ1MWJhNDg", "commit": {"author": {"name": "Samuel Moelius", "email": "sam@moeli.us", "date": "2022-10-11T23:41:44Z"}, "committer": {"name": "Samuel Moelius", "email": "sam@moeli.us", "date": "2022-10-12T13:21:08Z"}, "message": "Fix bug in `referent_used_exactly_once`", "tree": {"sha": "843532a779e7cc751a26efd34a7e238b5e806d3d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/843532a779e7cc751a26efd34a7e238b5e806d3d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/524ec2e12577d652875c68c3f205e8530451ba48", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/524ec2e12577d652875c68c3f205e8530451ba48", "html_url": "https://github.com/rust-lang/rust/commit/524ec2e12577d652875c68c3f205e8530451ba48", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/524ec2e12577d652875c68c3f205e8530451ba48/comments", "author": {"login": "smoelius", "id": 35515885, "node_id": "MDQ6VXNlcjM1NTE1ODg1", "avatar_url": "https://avatars.githubusercontent.com/u/35515885?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smoelius", "html_url": "https://github.com/smoelius", "followers_url": "https://api.github.com/users/smoelius/followers", "following_url": "https://api.github.com/users/smoelius/following{/other_user}", "gists_url": "https://api.github.com/users/smoelius/gists{/gist_id}", "starred_url": "https://api.github.com/users/smoelius/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smoelius/subscriptions", "organizations_url": "https://api.github.com/users/smoelius/orgs", "repos_url": "https://api.github.com/users/smoelius/repos", "events_url": "https://api.github.com/users/smoelius/events{/privacy}", "received_events_url": "https://api.github.com/users/smoelius/received_events", "type": "User", "site_admin": false}, "committer": {"login": "smoelius", "id": 35515885, "node_id": "MDQ6VXNlcjM1NTE1ODg1", "avatar_url": "https://avatars.githubusercontent.com/u/35515885?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smoelius", "html_url": "https://github.com/smoelius", "followers_url": "https://api.github.com/users/smoelius/followers", "following_url": "https://api.github.com/users/smoelius/following{/other_user}", "gists_url": "https://api.github.com/users/smoelius/gists{/gist_id}", "starred_url": "https://api.github.com/users/smoelius/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smoelius/subscriptions", "organizations_url": "https://api.github.com/users/smoelius/orgs", "repos_url": "https://api.github.com/users/smoelius/repos", "events_url": "https://api.github.com/users/smoelius/events{/privacy}", "received_events_url": "https://api.github.com/users/smoelius/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b8a9a507bf9e3149d287841454842116c72d66c4", "url": "https://api.github.com/repos/rust-lang/rust/commits/b8a9a507bf9e3149d287841454842116c72d66c4", "html_url": "https://github.com/rust-lang/rust/commit/b8a9a507bf9e3149d287841454842116c72d66c4"}], "stats": {"total": 11, "additions": 5, "deletions": 6}, "files": [{"sha": "82fc41d3a82ffd4482f46d62edf09ed125149b36", "filename": "clippy_lints/src/dereference.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/524ec2e12577d652875c68c3f205e8530451ba48/clippy_lints%2Fsrc%2Fdereference.rs", "raw_url": "https://github.com/rust-lang/rust/raw/524ec2e12577d652875c68c3f205e8530451ba48/clippy_lints%2Fsrc%2Fdereference.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fdereference.rs?ref=524ec2e12577d652875c68c3f205e8530451ba48", "patch": "@@ -1194,16 +1194,16 @@ fn has_ref_mut_self_method(cx: &LateContext<'_>, trait_def_id: DefId) -> bool {\n         })\n }\n \n-fn referent_used_exactly_once<'a, 'tcx>(\n-    cx: &'a LateContext<'tcx>,\n+fn referent_used_exactly_once<'tcx>(\n+    cx: &LateContext<'tcx>,\n     possible_borrowers: &mut Vec<(LocalDefId, PossibleBorrowerMap<'tcx, 'tcx>)>,\n     reference: &Expr<'tcx>,\n ) -> bool {\n     let mir = enclosing_mir(cx.tcx, reference.hir_id);\n     if let Some(local) = expr_local(cx.tcx, reference)\n         && let [location] = *local_assignments(mir, local).as_slice()\n-        && let StatementKind::Assign(box (_, Rvalue::Ref(_, _, place))) =\n-            mir.basic_blocks[location.block].statements[location.statement_index].kind\n+        && let Some(statement) = mir.basic_blocks[location.block].statements.get(location.statement_index)\n+        && let StatementKind::Assign(box (_, Rvalue::Ref(_, _, place))) = statement.kind\n         && !place.has_deref()\n     {\n         let body_owner_local_def_id = cx.tcx.hir().enclosing_body_owner(reference.hir_id);"}, {"sha": "818e603f665e7d55422db9b3879a7dd1829a566a", "filename": "clippy_utils/src/mir/mod.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/524ec2e12577d652875c68c3f205e8530451ba48/clippy_utils%2Fsrc%2Fmir%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/524ec2e12577d652875c68c3f205e8530451ba48/clippy_utils%2Fsrc%2Fmir%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_utils%2Fsrc%2Fmir%2Fmod.rs?ref=524ec2e12577d652875c68c3f205e8530451ba48", "patch": "@@ -121,8 +121,7 @@ pub fn expr_local(tcx: TyCtxt<'_>, expr: &Expr<'_>) -> Option<Local> {\n     })\n }\n \n-/// Returns a vector of `mir::Location` where `local` is assigned. Each statement referred to has\n-/// kind `StatementKind::Assign`.\n+/// Returns a vector of `mir::Location` where `local` is assigned.\n pub fn local_assignments(mir: &Body<'_>, local: Local) -> Vec<Location> {\n     let mut locations = Vec::new();\n     for (block, data) in mir.basic_blocks.iter_enumerated() {"}]}