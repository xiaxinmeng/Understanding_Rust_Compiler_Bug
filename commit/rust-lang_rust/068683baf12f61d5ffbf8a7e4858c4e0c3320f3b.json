{"sha": "068683baf12f61d5ffbf8a7e4858c4e0c3320f3b", "node_id": "C_kwDOAAsO6NoAKDA2ODY4M2JhZjEyZjYxZDVmZmJmOGE3ZTQ4NThjNGUwYzMzMjBmM2I", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2021-10-05T06:56:25Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-10-05T06:56:25Z"}, "message": "Rollup merge of #89535 - notriddle:notriddle/error-index-generator-js, r=Mark-Simulacrum\n\nfix busted JavaScript in error index generator\n\nThe old JavaScript didn't work. It filled the browser console with \"e.previousElementSibling not defined\" errors, because it didn't account for the example-wrap div that a newer version of rustdoc added.\n\nAdditionally, it had copied versions of utility functions that had been optimized in rustdoc main.js. This version updates those.", "tree": {"sha": "a39ab48aab1c9740253a22c9ac29b32953e97a45", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a39ab48aab1c9740253a22c9ac29b32953e97a45"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/068683baf12f61d5ffbf8a7e4858c4e0c3320f3b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhW/cZCRBK7hj4Ov3rIwAAh6oIAD32YTsyD+3YcVoEbKs41xuo\nw8Nrwwwi8BxP9iln4OtH8LxIg+62SgJ65lYFqwLubEI2AyhdSP5pv4Oa1y4LyCNh\n3pLSIpzjjEtVZm8bNkc2Z+AtRc8zBh23iz2yP3pZPMYS6jI817eE2NSHfAmrJ8YL\nabAxhz+2PzE3xbK1uPPXH35C7O7K8UCAOihsF7Yf8OTVG6lS6824QHXuI064DcS6\nyDfhYR4WatoC26nf6UInUUiCVEYe5mOgP2OTOT56yvJlAHc1Xq/c5A9CZvF/YnvJ\nCsPKOdOGmPEoHltEiInCxRLMqLfdQQLZcX5Y9PL9sTY4z/76tOpyzhtuTXQbC7g=\n=EK+F\n-----END PGP SIGNATURE-----\n", "payload": "tree a39ab48aab1c9740253a22c9ac29b32953e97a45\nparent bf62c6d710d5fe555565342a8e3ab5f89913e44f\nparent ccd2be5b91a5536bc18a90d20a77f10ac052e54c\nauthor Manish Goregaokar <manishsmail@gmail.com> 1633416985 -0700\ncommitter GitHub <noreply@github.com> 1633416985 -0700\n\nRollup merge of #89535 - notriddle:notriddle/error-index-generator-js, r=Mark-Simulacrum\n\nfix busted JavaScript in error index generator\n\nThe old JavaScript didn't work. It filled the browser console with \"e.previousElementSibling not defined\" errors, because it didn't account for the example-wrap div that a newer version of rustdoc added.\n\nAdditionally, it had copied versions of utility functions that had been optimized in rustdoc main.js. This version updates those.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/068683baf12f61d5ffbf8a7e4858c4e0c3320f3b", "html_url": "https://github.com/rust-lang/rust/commit/068683baf12f61d5ffbf8a7e4858c4e0c3320f3b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/068683baf12f61d5ffbf8a7e4858c4e0c3320f3b/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bf62c6d710d5fe555565342a8e3ab5f89913e44f", "url": "https://api.github.com/repos/rust-lang/rust/commits/bf62c6d710d5fe555565342a8e3ab5f89913e44f", "html_url": "https://github.com/rust-lang/rust/commit/bf62c6d710d5fe555565342a8e3ab5f89913e44f"}, {"sha": "ccd2be5b91a5536bc18a90d20a77f10ac052e54c", "url": "https://api.github.com/repos/rust-lang/rust/commits/ccd2be5b91a5536bc18a90d20a77f10ac052e54c", "html_url": "https://github.com/rust-lang/rust/commit/ccd2be5b91a5536bc18a90d20a77f10ac052e54c"}], "stats": {"total": 53, "additions": 19, "deletions": 34}, "files": [{"sha": "0386d8be167ee22c94dcc65f732cdc0dcdffe819", "filename": "src/tools/error_index_generator/main.rs", "status": "modified", "additions": 19, "deletions": 34, "changes": 53, "blob_url": "https://github.com/rust-lang/rust/blob/068683baf12f61d5ffbf8a7e4858c4e0c3320f3b/src%2Ftools%2Ferror_index_generator%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/068683baf12f61d5ffbf8a7e4858c4e0c3320f3b/src%2Ftools%2Ferror_index_generator%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Ferror_index_generator%2Fmain.rs?ref=068683baf12f61d5ffbf8a7e4858c4e0c3320f3b", "patch": "@@ -143,56 +143,41 @@ impl Formatter for HTMLFormatter {\n             r##\"<script>\n function onEach(arr, func) {{\n     if (arr && arr.length > 0 && func) {{\n-        for (var i = 0; i < arr.length; i++) {{\n-            func(arr[i]);\n+        var length = arr.length;\n+        var i;\n+        for (i = 0; i < length; ++i) {{\n+            if (func(arr[i])) {{\n+                return true;\n+            }}\n         }}\n     }}\n+    return false;\n+}}\n+\n+function onEachLazy(lazyArray, func) {{\n+    return onEach(\n+        Array.prototype.slice.call(lazyArray),\n+        func);\n }}\n \n function hasClass(elem, className) {{\n-    if (elem && className && elem.className) {{\n-        var elemClass = elem.className;\n-        var start = elemClass.indexOf(className);\n-        if (start === -1) {{\n-            return false;\n-        }} else if (elemClass.length === className.length) {{\n-            return true;\n-        }} else {{\n-            if (start > 0 && elemClass[start - 1] !== ' ') {{\n-                return false;\n-            }}\n-            var end = start + className.length;\n-            if (end < elemClass.length && elemClass[end] !== ' ') {{\n-                return false;\n-            }}\n-            return true;\n-        }}\n-        if (start > 0 && elemClass[start - 1] !== ' ') {{\n-            return false;\n-        }}\n-        var end = start + className.length;\n-        if (end < elemClass.length && elemClass[end] !== ' ') {{\n-            return false;\n-        }}\n-        return true;\n-    }}\n-    return false;\n+    return elem && elem.classList && elem.classList.contains(className);\n }}\n \n-onEach(document.getElementsByClassName('rust-example-rendered'), function(e) {{\n+onEachLazy(document.getElementsByClassName('rust-example-rendered'), function(e) {{\n     if (hasClass(e, 'compile_fail')) {{\n         e.addEventListener(\"mouseover\", function(event) {{\n-            e.previousElementSibling.childNodes[0].style.color = '#f00';\n+            e.parentElement.previousElementSibling.childNodes[0].style.color = '#f00';\n         }});\n         e.addEventListener(\"mouseout\", function(event) {{\n-            e.previousElementSibling.childNodes[0].style.color = '';\n+            e.parentElement.previousElementSibling.childNodes[0].style.color = '';\n         }});\n     }} else if (hasClass(e, 'ignore')) {{\n         e.addEventListener(\"mouseover\", function(event) {{\n-            e.previousElementSibling.childNodes[0].style.color = '#ff9200';\n+            e.parentElement.previousElementSibling.childNodes[0].style.color = '#ff9200';\n         }});\n         e.addEventListener(\"mouseout\", function(event) {{\n-            e.previousElementSibling.childNodes[0].style.color = '';\n+            e.parentElement.previousElementSibling.childNodes[0].style.color = '';\n         }});\n     }}\n }});"}]}