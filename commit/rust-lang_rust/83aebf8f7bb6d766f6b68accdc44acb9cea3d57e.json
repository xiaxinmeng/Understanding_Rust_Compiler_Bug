{"sha": "83aebf8f7bb6d766f6b68accdc44acb9cea3d57e", "node_id": "C_kwDOAAsO6NoAKDgzYWViZjhmN2JiNmQ3NjZmNmI2OGFjY2RjNDRhY2I5Y2VhM2Q1N2U", "commit": {"author": {"name": "Dan Gohman", "email": "dev@sunfishcode.online", "date": "2022-01-12T19:41:48Z"}, "committer": {"name": "Dan Gohman", "email": "dev@sunfishcode.online", "date": "2022-01-12T19:41:48Z"}, "message": "Use the correct `cvt` for converting socket errors on Windows.\n\n`WSADuplicateSocketW` returns 0 on success, which differs from\nhandle-oriented functions which return 0 on error. Use `sys::net::cvt`\nto handle its return value, which handles the socket convention of\nreturning 0 on success, rather than `sys::cvt`, which handles the\nhandle-oriented convention of returning 0 on failure.", "tree": {"sha": "2bc157e436a00d61c042503cea2e9629122194d6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2bc157e436a00d61c042503cea2e9629122194d6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/83aebf8f7bb6d766f6b68accdc44acb9cea3d57e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/83aebf8f7bb6d766f6b68accdc44acb9cea3d57e", "html_url": "https://github.com/rust-lang/rust/commit/83aebf8f7bb6d766f6b68accdc44acb9cea3d57e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/83aebf8f7bb6d766f6b68accdc44acb9cea3d57e/comments", "author": {"login": "sunfishcode", "id": 4503403, "node_id": "MDQ6VXNlcjQ1MDM0MDM=", "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sunfishcode", "html_url": "https://github.com/sunfishcode", "followers_url": "https://api.github.com/users/sunfishcode/followers", "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}", "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}", "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions", "organizations_url": "https://api.github.com/users/sunfishcode/orgs", "repos_url": "https://api.github.com/users/sunfishcode/repos", "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}", "received_events_url": "https://api.github.com/users/sunfishcode/received_events", "type": "User", "site_admin": false}, "committer": {"login": "sunfishcode", "id": 4503403, "node_id": "MDQ6VXNlcjQ1MDM0MDM=", "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sunfishcode", "html_url": "https://github.com/sunfishcode", "followers_url": "https://api.github.com/users/sunfishcode/followers", "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}", "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}", "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions", "organizations_url": "https://api.github.com/users/sunfishcode/orgs", "repos_url": "https://api.github.com/users/sunfishcode/repos", "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}", "received_events_url": "https://api.github.com/users/sunfishcode/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "53e072f2207747e8b60dcbb77b763c1598cfb192", "url": "https://api.github.com/repos/rust-lang/rust/commits/53e072f2207747e8b60dcbb77b763c1598cfb192", "html_url": "https://github.com/rust-lang/rust/commit/53e072f2207747e8b60dcbb77b763c1598cfb192"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "26b569bcdd3625f3f1c0ecaa75eb6c183113e6d3", "filename": "library/std/src/os/windows/io/socket.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/83aebf8f7bb6d766f6b68accdc44acb9cea3d57e/library%2Fstd%2Fsrc%2Fos%2Fwindows%2Fio%2Fsocket.rs", "raw_url": "https://github.com/rust-lang/rust/raw/83aebf8f7bb6d766f6b68accdc44acb9cea3d57e/library%2Fstd%2Fsrc%2Fos%2Fwindows%2Fio%2Fsocket.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fos%2Fwindows%2Fio%2Fsocket.rs?ref=83aebf8f7bb6d766f6b68accdc44acb9cea3d57e", "patch": "@@ -8,6 +8,7 @@ use crate::io;\n use crate::marker::PhantomData;\n use crate::mem;\n use crate::mem::forget;\n+use crate::sys;\n use crate::sys::c;\n use crate::sys::cvt;\n \n@@ -80,7 +81,7 @@ impl OwnedSocket {\n         let result = unsafe {\n             c::WSADuplicateSocketW(self.as_raw_socket(), c::GetCurrentProcessId(), &mut info)\n         };\n-        cvt(result)?;\n+        sys::net::cvt(result)?;\n         let socket = unsafe {\n             c::WSASocketW(\n                 info.iAddressFamily,"}]}