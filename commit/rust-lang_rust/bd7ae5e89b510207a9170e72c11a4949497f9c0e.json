{"sha": "bd7ae5e89b510207a9170e72c11a4949497f9c0e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJkN2FlNWU4OWI1MTAyMDdhOTE3MGU3MmMxMWE0OTQ5NDk3ZjljMGU=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2018-05-06T23:21:02Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-05-06T23:21:02Z"}, "message": "Merge pull request #2682 from topecongiro/issue-2670\n\nDo not duplicate attributes on use items", "tree": {"sha": "f60a0d3b40670a8611711f2ba9f1e7d3153820d5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f60a0d3b40670a8611711f2ba9f1e7d3153820d5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bd7ae5e89b510207a9170e72c11a4949497f9c0e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJa743eCRBK7hj4Ov3rIwAAdHIIACV5+aPBdR0BRu6aSMtqRp6Z\nud7PyvXiwOwyBCIFwyWrZ9OnlZQSrWlikyhww6umio39nxLmf2bR3+0NEaPor6cY\nQeSZ/nm/v6ZMc2+5DzkDn7eAb9d9+29x5SaFDBNjPEElVauXnuurcF7kvqbal+Gy\np7JdLwjfaNTi1clItQUerep66IDCsMGp94yMZcOHJaDZUwc/HPy93jSz+K4dIuHD\nwnT5C2d4WEK/0QQSvhLZjy0z5Ta5Yq1gYNGHoHt53NRmSm3xjCNHLqu6OHO2XmoA\n3vSpAjL3jF3+422R8QFQAulvtpLcX9kozKMo7XlQRFq851Y5LzEpZDLZ06Riy8s=\n=daZ+\n-----END PGP SIGNATURE-----\n", "payload": "tree f60a0d3b40670a8611711f2ba9f1e7d3153820d5\nparent 4bbd5c4ae576a627c79ab528050b1bbe1c4f7813\nparent e59ceaf95460c3fd430651d015f9c3bb276ed97f\nauthor Nick Cameron <nrc@ncameron.org> 1525648862 +1200\ncommitter GitHub <noreply@github.com> 1525648862 +1200\n\nMerge pull request #2682 from topecongiro/issue-2670\n\nDo not duplicate attributes on use items "}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bd7ae5e89b510207a9170e72c11a4949497f9c0e", "html_url": "https://github.com/rust-lang/rust/commit/bd7ae5e89b510207a9170e72c11a4949497f9c0e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bd7ae5e89b510207a9170e72c11a4949497f9c0e/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4bbd5c4ae576a627c79ab528050b1bbe1c4f7813", "url": "https://api.github.com/repos/rust-lang/rust/commits/4bbd5c4ae576a627c79ab528050b1bbe1c4f7813", "html_url": "https://github.com/rust-lang/rust/commit/4bbd5c4ae576a627c79ab528050b1bbe1c4f7813"}, {"sha": "e59ceaf95460c3fd430651d015f9c3bb276ed97f", "url": "https://api.github.com/repos/rust-lang/rust/commits/e59ceaf95460c3fd430651d015f9c3bb276ed97f", "html_url": "https://github.com/rust-lang/rust/commit/e59ceaf95460c3fd430651d015f9c3bb276ed97f"}], "stats": {"total": 17, "additions": 16, "deletions": 1}, "files": [{"sha": "fc7f5e87e36c42c5d231f02426688b940f02515b", "filename": "src/imports.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bd7ae5e89b510207a9170e72c11a4949497f9c0e/src%2Fimports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bd7ae5e89b510207a9170e72c11a4949497f9c0e/src%2Fimports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fimports.rs?ref=bd7ae5e89b510207a9170e72c11a4949497f9c0e", "patch": "@@ -35,7 +35,7 @@ pub fn path_to_imported_ident(path: &ast::Path) -> ast::Ident {\n \n impl<'a> FmtVisitor<'a> {\n     pub fn format_import(&mut self, item: &ast::Item, tree: &ast::UseTree) {\n-        let span = item.span;\n+        let span = item.span();\n         let shape = self.shape();\n         let rw = UseTree::from_ast(\n             &self.get_context(),"}, {"sha": "71a279d93aad0bdfba66f03bb1b3869321921e14", "filename": "src/visitor.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/bd7ae5e89b510207a9170e72c11a4949497f9c0e/src%2Fvisitor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bd7ae5e89b510207a9170e72c11a4949497f9c0e/src%2Fvisitor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fvisitor.rs?ref=bd7ae5e89b510207a9170e72c11a4949497f9c0e", "patch": "@@ -303,6 +303,13 @@ impl<'b, 'a: 'b> FmtVisitor<'a> {\n         let filtered_attrs;\n         let mut attrs = &item.attrs;\n         match item.node {\n+            // For use items, skip rewriting attributes. Just check for a skip attribute.\n+            ast::ItemKind::Use(..) => {\n+                if contains_skip(attrs) {\n+                    self.push_skipped_with_span(item.span());\n+                    return;\n+                }\n+            }\n             // Module is inline, in this case we treat it like any other item.\n             _ if !is_mod_decl(item) => {\n                 if self.visit_attrs(&item.attrs, ast::AttrStyle::Outer) {"}, {"sha": "30ce49605f7b920311aa46c84c0c105cd72bd639", "filename": "tests/source/imports.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/bd7ae5e89b510207a9170e72c11a4949497f9c0e/tests%2Fsource%2Fimports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bd7ae5e89b510207a9170e72c11a4949497f9c0e/tests%2Fsource%2Fimports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fimports.rs?ref=bd7ae5e89b510207a9170e72c11a4949497f9c0e", "patch": "@@ -93,3 +93,7 @@ use a::{b::{c::{xxx, yyy, zzz}}};\n /// This line is not affected.\n // This line is deleted.\n use c;\n+\n+// #2670\n+#[macro_use]\n+use imports_with_attr;"}, {"sha": "01964fbd295121a9e99a900140ea31b97af6460f", "filename": "tests/target/imports.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/bd7ae5e89b510207a9170e72c11a4949497f9c0e/tests%2Ftarget%2Fimports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bd7ae5e89b510207a9170e72c11a4949497f9c0e/tests%2Ftarget%2Fimports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fimports.rs?ref=bd7ae5e89b510207a9170e72c11a4949497f9c0e", "patch": "@@ -105,3 +105,7 @@ use a::b::c::{xxx, yyy, zzz};\n /// This line is not affected.\n // This line is deleted.\n use c;\n+\n+// #2670\n+#[macro_use]\n+use imports_with_attr;"}]}