{"sha": "c87a1086dcca15bf7d6d6209b9bfa0893649202e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM4N2ExMDg2ZGNjYTE1YmY3ZDZkNjIwOWI5YmZhMDg5MzY0OTIwMmU=", "commit": {"author": {"name": "O01eg", "email": "o01eg@yandex.ru", "date": "2017-12-07T09:27:12Z"}, "committer": {"name": "O01eg", "email": "o01eg@yandex.ru", "date": "2018-01-12T04:11:13Z"}, "message": "Build all stages with relative libdirs.", "tree": {"sha": "bb870d8b421dbe92a8b1f1ace3164c02ce628c06", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bb870d8b421dbe92a8b1f1ace3164c02ce628c06"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c87a1086dcca15bf7d6d6209b9bfa0893649202e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABEIAB0WIQQl7SqOimvGwwcxiyLRqU8kAPvH5QUCWlg1YQAKCRDRqU8kAPvH\n5ZbfAQDehwQRpF9+GrMzEREfhX+PCVHmRsl+zx/oxJhYDBhNjQEA7hL98aWR3xuD\nNOJq5W20s0s73UICIXSQI9zfRDofXm4=\n=orxv\n-----END PGP SIGNATURE-----", "payload": "tree bb870d8b421dbe92a8b1f1ace3164c02ce628c06\nparent 0f5110ea4937e88e88c2192f3fa192717cb405c1\nauthor O01eg <o01eg@yandex.ru> 1512638832 +0300\ncommitter O01eg <o01eg@yandex.ru> 1515730273 +0300\n\nBuild all stages with relative libdirs.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c87a1086dcca15bf7d6d6209b9bfa0893649202e", "html_url": "https://github.com/rust-lang/rust/commit/c87a1086dcca15bf7d6d6209b9bfa0893649202e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c87a1086dcca15bf7d6d6209b9bfa0893649202e/comments", "author": {"login": "o01eg", "id": 397177, "node_id": "MDQ6VXNlcjM5NzE3Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/397177?v=4", "gravatar_id": "", "url": "https://api.github.com/users/o01eg", "html_url": "https://github.com/o01eg", "followers_url": "https://api.github.com/users/o01eg/followers", "following_url": "https://api.github.com/users/o01eg/following{/other_user}", "gists_url": "https://api.github.com/users/o01eg/gists{/gist_id}", "starred_url": "https://api.github.com/users/o01eg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/o01eg/subscriptions", "organizations_url": "https://api.github.com/users/o01eg/orgs", "repos_url": "https://api.github.com/users/o01eg/repos", "events_url": "https://api.github.com/users/o01eg/events{/privacy}", "received_events_url": "https://api.github.com/users/o01eg/received_events", "type": "User", "site_admin": false}, "committer": {"login": "o01eg", "id": 397177, "node_id": "MDQ6VXNlcjM5NzE3Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/397177?v=4", "gravatar_id": "", "url": "https://api.github.com/users/o01eg", "html_url": "https://github.com/o01eg", "followers_url": "https://api.github.com/users/o01eg/followers", "following_url": "https://api.github.com/users/o01eg/following{/other_user}", "gists_url": "https://api.github.com/users/o01eg/gists{/gist_id}", "starred_url": "https://api.github.com/users/o01eg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/o01eg/subscriptions", "organizations_url": "https://api.github.com/users/o01eg/orgs", "repos_url": "https://api.github.com/users/o01eg/repos", "events_url": "https://api.github.com/users/o01eg/events{/privacy}", "received_events_url": "https://api.github.com/users/o01eg/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0f5110ea4937e88e88c2192f3fa192717cb405c1", "url": "https://api.github.com/repos/rust-lang/rust/commits/0f5110ea4937e88e88c2192f3fa192717cb405c1", "html_url": "https://github.com/rust-lang/rust/commit/0f5110ea4937e88e88c2192f3fa192717cb405c1"}], "stats": {"total": 12, "additions": 4, "deletions": 8}, "files": [{"sha": "1db39361aef9129c6d676965d637b43b2942c57f", "filename": "src/bootstrap/compile.rs", "status": "modified", "additions": 4, "deletions": 8, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/c87a1086dcca15bf7d6d6209b9bfa0893649202e/src%2Fbootstrap%2Fcompile.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c87a1086dcca15bf7d6d6209b9bfa0893649202e/src%2Fbootstrap%2Fcompile.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fcompile.rs?ref=c87a1086dcca15bf7d6d6209b9bfa0893649202e", "patch": "@@ -500,7 +500,7 @@ impl Step for Rustc {\n \n /// Same as `std_cargo`, but for libtest\n pub fn rustc_cargo(build: &Build,\n-                   compiler: &Compiler,\n+                   _compiler: &Compiler,\n                    target: Interned<String>,\n                    cargo: &mut Command) {\n     cargo.arg(\"--features\").arg(build.rustc_features())\n@@ -514,13 +514,9 @@ pub fn rustc_cargo(build: &Build,\n          .env(\"CFG_VERSION\", build.rust_version())\n          .env(\"CFG_PREFIX\", build.config.prefix.clone().unwrap_or_default());\n \n-    if compiler.stage == 0 {\n-        cargo.env(\"CFG_LIBDIR_RELATIVE\", \"lib\");\n-    } else {\n-        let libdir_relative =\n-            build.config.libdir_relative.clone().unwrap_or(PathBuf::from(\"lib\"));\n-        cargo.env(\"CFG_LIBDIR_RELATIVE\", libdir_relative);\n-    }\n+    let libdir_relative =\n+        build.config.libdir_relative.clone().unwrap_or(PathBuf::from(\"lib\"));\n+    cargo.env(\"CFG_LIBDIR_RELATIVE\", libdir_relative);\n \n     // If we're not building a compiler with debugging information then remove\n     // these two env vars which would be set otherwise."}]}