{"sha": "3d0682b97a3a03bcf54337b56002fb6b2b0ce244", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNkMDY4MmI5N2EzYTAzYmNmNTQzMzdiNTYwMDJmYjZiMmIwY2UyNDQ=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-11-02T00:12:32Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-11-02T00:12:32Z"}, "message": "Auto merge of #78605 - nox:relax-elf-relocations, r=nagisa\n\nImplement -Z relax-elf-relocations=yes|no\n\nThis lets rustc users tweak whether the linker should relax ELF relocations without recompiling a whole new target with its own libcore etc.", "tree": {"sha": "3eb3f13b1841a6fa4f16cb4bd42b29e4f678545f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3eb3f13b1841a6fa4f16cb4bd42b29e4f678545f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3d0682b97a3a03bcf54337b56002fb6b2b0ce244", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3d0682b97a3a03bcf54337b56002fb6b2b0ce244", "html_url": "https://github.com/rust-lang/rust/commit/3d0682b97a3a03bcf54337b56002fb6b2b0ce244", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3d0682b97a3a03bcf54337b56002fb6b2b0ce244/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b2025326088b54fb3f083bebeba14e0a15bf00d3", "url": "https://api.github.com/repos/rust-lang/rust/commits/b2025326088b54fb3f083bebeba14e0a15bf00d3", "html_url": "https://github.com/rust-lang/rust/commit/b2025326088b54fb3f083bebeba14e0a15bf00d3"}, {"sha": "6febaf2419a528b08d03349de205237fd8bba4b9", "url": "https://api.github.com/repos/rust-lang/rust/commits/6febaf2419a528b08d03349de205237fd8bba4b9", "html_url": "https://github.com/rust-lang/rust/commit/6febaf2419a528b08d03349de205237fd8bba4b9"}], "stats": {"total": 9, "additions": 8, "deletions": 1}, "files": [{"sha": "f13c2d312dfcca3a6ddec6425866ddbb81c9fcd5", "filename": "compiler/rustc_codegen_llvm/src/back/write.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/3d0682b97a3a03bcf54337b56002fb6b2b0ce244/compiler%2Frustc_codegen_llvm%2Fsrc%2Fback%2Fwrite.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3d0682b97a3a03bcf54337b56002fb6b2b0ce244/compiler%2Frustc_codegen_llvm%2Fsrc%2Fback%2Fwrite.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_llvm%2Fsrc%2Fback%2Fwrite.rs?ref=3d0682b97a3a03bcf54337b56002fb6b2b0ce244", "patch": "@@ -156,7 +156,11 @@ pub fn target_machine_factory(\n     let emit_stack_size_section = sess.opts.debugging_opts.emit_stack_sizes;\n \n     let asm_comments = sess.asm_comments();\n-    let relax_elf_relocations = sess.target.options.relax_elf_relocations;\n+    let relax_elf_relocations = sess\n+        .opts\n+        .debugging_opts\n+        .relax_elf_relocations\n+        .unwrap_or(sess.target.options.relax_elf_relocations);\n \n     let use_init_array = !sess\n         .opts"}, {"sha": "dfc6f691457530733bd70f253894c0d6af58a8e5", "filename": "compiler/rustc_interface/src/tests.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3d0682b97a3a03bcf54337b56002fb6b2b0ce244/compiler%2Frustc_interface%2Fsrc%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3d0682b97a3a03bcf54337b56002fb6b2b0ce244/compiler%2Frustc_interface%2Fsrc%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_interface%2Fsrc%2Ftests.rs?ref=3d0682b97a3a03bcf54337b56002fb6b2b0ce244", "patch": "@@ -574,6 +574,7 @@ fn test_debugging_options_tracking_hash() {\n     tracked!(print_fuel, Some(\"abc\".to_string()));\n     tracked!(profile, true);\n     tracked!(profile_emit, Some(PathBuf::from(\"abc\")));\n+    tracked!(relax_elf_relocations, Some(true));\n     tracked!(relro_level, Some(RelroLevel::Full));\n     tracked!(report_delayed_bugs, true);\n     tracked!(run_dsymutil, false);"}, {"sha": "fb09773fd1bbac2f473d0a9949204935da2047bf", "filename": "compiler/rustc_session/src/options.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3d0682b97a3a03bcf54337b56002fb6b2b0ce244/compiler%2Frustc_session%2Fsrc%2Foptions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3d0682b97a3a03bcf54337b56002fb6b2b0ce244/compiler%2Frustc_session%2Fsrc%2Foptions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_session%2Fsrc%2Foptions.rs?ref=3d0682b97a3a03bcf54337b56002fb6b2b0ce244", "patch": "@@ -1032,6 +1032,8 @@ options! {DebuggingOptions, DebuggingSetter, basic_debugging_options,\n         \"enable queries of the dependency graph for regression testing (default: no)\"),\n     query_stats: bool = (false, parse_bool, [UNTRACKED],\n         \"print some statistics about the query system (default: no)\"),\n+    relax_elf_relocations: Option<bool> = (None, parse_opt_bool, [TRACKED],\n+        \"whether ELF relocations can be relaxed\"),\n     relro_level: Option<RelroLevel> = (None, parse_relro_level, [TRACKED],\n         \"choose which RELRO level to use\"),\n     report_delayed_bugs: bool = (false, parse_bool, [TRACKED],"}]}