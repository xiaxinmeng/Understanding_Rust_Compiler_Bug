{"sha": "0670a6151c4731d63e0eff1939534c7ca2af5ec6", "node_id": "C_kwDOAAsO6NoAKDA2NzBhNjE1MWM0NzMxZDYzZTBlZmYxOTM5NTM0YzdjYTJhZjVlYzY", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2023-01-02T23:39:17Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-01-02T23:39:17Z"}, "message": "Rollup merge of #106315 - jyn514:cleanup-mingw-tidy, r=fee1-dead\n\nCleanup `mingw-tidy` docker job\n\nFixes a couple small regressions from https://github.com/rust-lang/rust/pull/106048 and https://github.com/rust-lang/rust/pull/105714.\n\n- Avoid `/checkout/src/ci/run.sh: line 187: [: =: unary operator expected`: https://github.com/rust-lang/rust/actions/runs/3809902408/jobs/6481611301#step:26:1701\n- Avoid running `x check` in the tidy test, to get faster feedback. It's already run on the normal `mingw-check` job.\n\nr? `@fee1-dead`", "tree": {"sha": "4f0d68d3dc7b3f174322fab9b5d494ea4b2f5769", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4f0d68d3dc7b3f174322fab9b5d494ea4b2f5769"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0670a6151c4731d63e0eff1939534c7ca2af5ec6", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjs2slCRBK7hj4Ov3rIwAAoNEIAKd2mreA8acikfe6WaRtGP5u\nUSUzwPaakJTcKgPfykbpKFanD8or0CAwXtYDUJld2MfofVbY5ctnjmJJa0aledzg\n3YC55pZmSgi88Mq6NF6Md1uk5Lf1qpBBUP5s++zBqLYFeHjyD/hWF6Pc3UTnCLUY\ng8TnBqqD9Ynfry/ZOYquEuKFoVnNmDsurK/oKrt9HgnLNVWSAFAB/s/sBgLOC7DN\n3DVD4EFX+9/K86W9BC9tV8RhYpsAZopn3c3lHGz8obQupkdw9k8p5J/0Rj3TRtw2\nFSfC9VV+HDB9XGAVEyksKxPqH8nJodXKVQUEE2R72tAOMppOFA2BB2YXi1UkIFE=\n=pUAQ\n-----END PGP SIGNATURE-----\n", "payload": "tree 4f0d68d3dc7b3f174322fab9b5d494ea4b2f5769\nparent fbffaa91ada6387cdea184dcd1d689762b3e8927\nparent beefcf88544b7f4d1b5e9ae77f93566303d34326\nauthor Michael Goulet <michael@errs.io> 1672702757 -0800\ncommitter GitHub <noreply@github.com> 1672702757 -0800\n\nRollup merge of #106315 - jyn514:cleanup-mingw-tidy, r=fee1-dead\n\nCleanup `mingw-tidy` docker job\n\nFixes a couple small regressions from https://github.com/rust-lang/rust/pull/106048 and https://github.com/rust-lang/rust/pull/105714.\n\n- Avoid `/checkout/src/ci/run.sh: line 187: [: =: unary operator expected`: https://github.com/rust-lang/rust/actions/runs/3809902408/jobs/6481611301#step:26:1701\n- Avoid running `x check` in the tidy test, to get faster feedback. It's already run on the normal `mingw-check` job.\n\nr? `@fee1-dead`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0670a6151c4731d63e0eff1939534c7ca2af5ec6", "html_url": "https://github.com/rust-lang/rust/commit/0670a6151c4731d63e0eff1939534c7ca2af5ec6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0670a6151c4731d63e0eff1939534c7ca2af5ec6/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fbffaa91ada6387cdea184dcd1d689762b3e8927", "url": "https://api.github.com/repos/rust-lang/rust/commits/fbffaa91ada6387cdea184dcd1d689762b3e8927", "html_url": "https://github.com/rust-lang/rust/commit/fbffaa91ada6387cdea184dcd1d689762b3e8927"}, {"sha": "beefcf88544b7f4d1b5e9ae77f93566303d34326", "url": "https://api.github.com/repos/rust-lang/rust/commits/beefcf88544b7f4d1b5e9ae77f93566303d34326", "html_url": "https://github.com/rust-lang/rust/commit/beefcf88544b7f4d1b5e9ae77f93566303d34326"}], "stats": {"total": 5, "additions": 2, "deletions": 3}, "files": [{"sha": "dc0e591cad6f6f9aec51a1ab2eec129f01e9988b", "filename": "src/ci/docker/host-x86_64/mingw-check-tidy/Dockerfile", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0670a6151c4731d63e0eff1939534c7ca2af5ec6/src%2Fci%2Fdocker%2Fhost-x86_64%2Fmingw-check-tidy%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/0670a6151c4731d63e0eff1939534c7ca2af5ec6/src%2Fci%2Fdocker%2Fhost-x86_64%2Fmingw-check-tidy%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fmingw-check-tidy%2FDockerfile?ref=0670a6151c4731d63e0eff1939534c7ca2af5ec6", "patch": "@@ -32,5 +32,4 @@ RUN pip3 install --no-deps --no-cache-dir --require-hashes -r /tmp/reuse-require\n COPY host-x86_64/mingw-check/validate-toolstate.sh /scripts/\n COPY host-x86_64/mingw-check/validate-error-codes.sh /scripts/\n \n-ENV RUN_CHECK_WITH_PARALLEL_QUERIES 1\n ENV SCRIPT python3 ../x.py test --stage 0 src/tools/tidy tidyselftest"}, {"sha": "0db9c993eecb407f2fd72cb4a3a0a76ef3535cb4", "filename": "src/ci/run.sh", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/0670a6151c4731d63e0eff1939534c7ca2af5ec6/src%2Fci%2Frun.sh", "raw_url": "https://github.com/rust-lang/rust/raw/0670a6151c4731d63e0eff1939534c7ca2af5ec6/src%2Fci%2Frun.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Frun.sh?ref=0670a6151c4731d63e0eff1939534c7ca2af5ec6", "patch": "@@ -184,11 +184,11 @@ if [ \"$RUN_CHECK_WITH_PARALLEL_QUERIES\" != \"\" ]; then\n   $SRC/configure --set rust.parallel-compiler\n \n   # Save the build metrics before we wipe the directory\n-  if [ $HAS_METRICS = 1 ]; then\n+  if [ \"$HAS_METRICS\" = 1 ]; then\n     mv build/metrics.json .\n   fi\n   rm -rf build\n-  if [ $HAS_METRICS = 1 ]; then\n+  if [ \"$HAS_METRICS\" = 1 ]; then\n     mkdir build\n     mv metrics.json build\n   fi"}]}