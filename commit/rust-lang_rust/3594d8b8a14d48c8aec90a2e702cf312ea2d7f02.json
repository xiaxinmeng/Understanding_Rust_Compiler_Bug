{"sha": "3594d8b8a14d48c8aec90a2e702cf312ea2d7f02", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM1OTRkOGI4YTE0ZDQ4YzhhZWM5MGEyZTcwMmNmMzEyZWEyZDdmMDI=", "commit": {"author": {"name": "Lzu Tao", "email": "taolzu@gmail.com", "date": "2019-12-15T12:47:40Z"}, "committer": {"name": "Lzu Tao", "email": "taolzu@gmail.com", "date": "2019-12-15T13:41:32Z"}, "message": "make htons const fn", "tree": {"sha": "a0189efbf79f7406330c29c08fdb0f3c78b11636", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a0189efbf79f7406330c29c08fdb0f3c78b11636"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3594d8b8a14d48c8aec90a2e702cf312ea2d7f02", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3594d8b8a14d48c8aec90a2e702cf312ea2d7f02", "html_url": "https://github.com/rust-lang/rust/commit/3594d8b8a14d48c8aec90a2e702cf312ea2d7f02", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3594d8b8a14d48c8aec90a2e702cf312ea2d7f02/comments", "author": {"login": "tesuji", "id": 15225902, "node_id": "MDQ6VXNlcjE1MjI1OTAy", "avatar_url": "https://avatars.githubusercontent.com/u/15225902?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tesuji", "html_url": "https://github.com/tesuji", "followers_url": "https://api.github.com/users/tesuji/followers", "following_url": "https://api.github.com/users/tesuji/following{/other_user}", "gists_url": "https://api.github.com/users/tesuji/gists{/gist_id}", "starred_url": "https://api.github.com/users/tesuji/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tesuji/subscriptions", "organizations_url": "https://api.github.com/users/tesuji/orgs", "repos_url": "https://api.github.com/users/tesuji/repos", "events_url": "https://api.github.com/users/tesuji/events{/privacy}", "received_events_url": "https://api.github.com/users/tesuji/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tesuji", "id": 15225902, "node_id": "MDQ6VXNlcjE1MjI1OTAy", "avatar_url": "https://avatars.githubusercontent.com/u/15225902?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tesuji", "html_url": "https://github.com/tesuji", "followers_url": "https://api.github.com/users/tesuji/followers", "following_url": "https://api.github.com/users/tesuji/following{/other_user}", "gists_url": "https://api.github.com/users/tesuji/gists{/gist_id}", "starred_url": "https://api.github.com/users/tesuji/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tesuji/subscriptions", "organizations_url": "https://api.github.com/users/tesuji/orgs", "repos_url": "https://api.github.com/users/tesuji/repos", "events_url": "https://api.github.com/users/tesuji/events{/privacy}", "received_events_url": "https://api.github.com/users/tesuji/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a605441e049f0b6d5f7715b94b8ac4662fd7fcf6", "url": "https://api.github.com/repos/rust-lang/rust/commits/a605441e049f0b6d5f7715b94b8ac4662fd7fcf6", "html_url": "https://github.com/rust-lang/rust/commit/a605441e049f0b6d5f7715b94b8ac4662fd7fcf6"}], "stats": {"total": 33, "additions": 11, "deletions": 22}, "files": [{"sha": "a9d88370c612fa1afa826b9510e0e536162b125f", "filename": "src/libstd/net/addr.rs", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/3594d8b8a14d48c8aec90a2e702cf312ea2d7f02/src%2Flibstd%2Fnet%2Faddr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3594d8b8a14d48c8aec90a2e702cf312ea2d7f02/src%2Flibstd%2Fnet%2Faddr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fnet%2Faddr.rs?ref=3594d8b8a14d48c8aec90a2e702cf312ea2d7f02", "patch": "@@ -4,7 +4,7 @@ use crate::hash;\n use crate::io;\n use crate::iter;\n use crate::mem;\n-use crate::net::{hton, ntoh, IpAddr, Ipv4Addr, Ipv6Addr};\n+use crate::net::{htons, ntohs, IpAddr, Ipv4Addr, Ipv6Addr};\n use crate::option;\n use crate::slice;\n use crate::sys::net::netc as c;\n@@ -276,7 +276,7 @@ impl SocketAddrV4 {\n         SocketAddrV4 {\n             inner: c::sockaddr_in {\n                 sin_family: c::AF_INET as c::sa_family_t,\n-                sin_port: hton(port),\n+                sin_port: htons(port),\n                 sin_addr: *ip.as_inner(),\n                 ..unsafe { mem::zeroed() }\n             },\n@@ -326,7 +326,7 @@ impl SocketAddrV4 {\n     /// ```\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     pub fn port(&self) -> u16 {\n-        ntoh(self.inner.sin_port)\n+        ntohs(self.inner.sin_port)\n     }\n \n     /// Changes the port number associated with this socket address.\n@@ -342,7 +342,7 @@ impl SocketAddrV4 {\n     /// ```\n     #[stable(feature = \"sockaddr_setters\", since = \"1.9.0\")]\n     pub fn set_port(&mut self, new_port: u16) {\n-        self.inner.sin_port = hton(new_port);\n+        self.inner.sin_port = htons(new_port);\n     }\n }\n \n@@ -368,7 +368,7 @@ impl SocketAddrV6 {\n         SocketAddrV6 {\n             inner: c::sockaddr_in6 {\n                 sin6_family: c::AF_INET6 as c::sa_family_t,\n-                sin6_port: hton(port),\n+                sin6_port: htons(port),\n                 sin6_addr: *ip.as_inner(),\n                 sin6_flowinfo: flowinfo,\n                 sin6_scope_id: scope_id,\n@@ -420,7 +420,7 @@ impl SocketAddrV6 {\n     /// ```\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     pub fn port(&self) -> u16 {\n-        ntoh(self.inner.sin6_port)\n+        ntohs(self.inner.sin6_port)\n     }\n \n     /// Changes the port number associated with this socket address.\n@@ -436,7 +436,7 @@ impl SocketAddrV6 {\n     /// ```\n     #[stable(feature = \"sockaddr_setters\", since = \"1.9.0\")]\n     pub fn set_port(&mut self, new_port: u16) {\n-        self.inner.sin6_port = hton(new_port);\n+        self.inner.sin6_port = htons(new_port);\n     }\n \n     /// Returns the flow information associated with this address."}, {"sha": "8652ed8b046bbee60d9f12b016df7baad6a50c30", "filename": "src/libstd/net/mod.rs", "status": "modified", "additions": 4, "deletions": 15, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/3594d8b8a14d48c8aec90a2e702cf312ea2d7f02/src%2Flibstd%2Fnet%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3594d8b8a14d48c8aec90a2e702cf312ea2d7f02/src%2Flibstd%2Fnet%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fnet%2Fmod.rs?ref=3594d8b8a14d48c8aec90a2e702cf312ea2d7f02", "patch": "@@ -85,21 +85,10 @@ pub enum Shutdown {\n     Both,\n }\n \n-#[doc(hidden)]\n-trait NetInt {\n-    fn from_be(i: Self) -> Self;\n-    fn to_be(&self) -> Self;\n-}\n-macro_rules! doit {\n-    ($($t:ident)*) => ($(impl NetInt for $t {\n-        fn from_be(i: Self) -> Self { <$t>::from_be(i) }\n-        fn to_be(&self) -> Self { <$t>::to_be(*self) }\n-    })*)\n-}\n-doit! { i8 i16 i32 i64 isize u8 u16 u32 u64 usize }\n-\n-fn hton<I: NetInt>(i: I) -> I { i.to_be() }\n-fn ntoh<I: NetInt>(i: I) -> I { I::from_be(i) }\n+#[inline]\n+const fn htons(i: u16) -> u16 { i.to_be() }\n+#[inline]\n+const fn ntohs(i: u16) -> u16 { u16::from_be(i) }\n \n fn each_addr<A: ToSocketAddrs, F, T>(addr: A, mut f: F) -> io::Result<T>\n     where F: FnMut(io::Result<&SocketAddr>) -> io::Result<T>"}]}