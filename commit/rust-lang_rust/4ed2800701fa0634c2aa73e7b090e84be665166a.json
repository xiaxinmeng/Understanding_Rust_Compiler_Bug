{"sha": "4ed2800701fa0634c2aa73e7b090e84be665166a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRlZDI4MDA3MDFmYTA2MzRjMmFhNzNlN2IwOTBlODRiZTY2NTE2NmE=", "commit": {"author": {"name": "Jorge Aparicio", "email": "japaricious@gmail.com", "date": "2015-01-05T18:51:29Z"}, "committer": {"name": "Jorge Aparicio", "email": "japaricious@gmail.com", "date": "2015-01-05T19:56:49Z"}, "message": "syntax: obsolete the `for Sized?` syntax", "tree": {"sha": "f6070b6862a71445d1f1fea55a90267d31757230", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f6070b6862a71445d1f1fea55a90267d31757230"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4ed2800701fa0634c2aa73e7b090e84be665166a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4ed2800701fa0634c2aa73e7b090e84be665166a", "html_url": "https://github.com/rust-lang/rust/commit/4ed2800701fa0634c2aa73e7b090e84be665166a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4ed2800701fa0634c2aa73e7b090e84be665166a/comments", "author": null, "committer": null, "parents": [{"sha": "bbf7e4e58a9b565342b5990cb3e750932a90a1b6", "url": "https://api.github.com/repos/rust-lang/rust/commits/bbf7e4e58a9b565342b5990cb3e750932a90a1b6", "html_url": "https://github.com/rust-lang/rust/commit/bbf7e4e58a9b565342b5990cb3e750932a90a1b6"}], "stats": {"total": 31, "additions": 29, "deletions": 2}, "files": [{"sha": "d63f432589dd1a866386cd889ce86ab9860f647a", "filename": "src/libsyntax/parse/obsolete.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4ed2800701fa0634c2aa73e7b090e84be665166a/src%2Flibsyntax%2Fparse%2Fobsolete.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4ed2800701fa0634c2aa73e7b090e84be665166a/src%2Flibsyntax%2Fparse%2Fobsolete.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Fobsolete.rs?ref=4ed2800701fa0634c2aa73e7b090e84be665166a", "patch": "@@ -24,6 +24,7 @@ use ptr::P;\n /// The specific types of unsupported syntax\n #[derive(Copy, PartialEq, Eq, Hash)]\n pub enum ObsoleteSyntax {\n+    ObsoleteForSized,\n     ObsoleteOwnedType,\n     ObsoleteOwnedExpr,\n     ObsoleteOwnedPattern,\n@@ -55,6 +56,11 @@ impl<'a> ParserObsoleteMethods for parser::Parser<'a> {\n     /// Reports an obsolete syntax non-fatal error.\n     fn obsolete(&mut self, sp: Span, kind: ObsoleteSyntax) {\n         let (kind_str, desc) = match kind {\n+            ObsoleteForSized => (\n+                \"for Sized?\",\n+                \"no longer required, traits apply to sized and unsized types by default, use \\\n+                `: Sized` to opt-out of unsized types\",\n+            ),\n             ObsoleteProcType => (\n                 \"the `proc` type\",\n                 \"use unboxed closures instead\","}, {"sha": "aedfaac59c581391e3aff36508d558e7dfe8a088", "filename": "src/libsyntax/parse/parser.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/4ed2800701fa0634c2aa73e7b090e84be665166a/src%2Flibsyntax%2Fparse%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4ed2800701fa0634c2aa73e7b090e84be665166a/src%2Flibsyntax%2Fparse%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Fparser.rs?ref=4ed2800701fa0634c2aa73e7b090e84be665166a", "patch": "@@ -5003,6 +5003,7 @@ impl<'a> Parser<'a> {\n         // re-jigged shortly in any case, so leaving the hacky version for now.\n         if self.eat_keyword(keywords::For) {\n             let span = self.span;\n+\n             let mut ate_question = false;\n             if self.eat(&token::Question) {\n                 ate_question = true;\n@@ -5020,8 +5021,11 @@ impl<'a> Parser<'a> {\n                     \"expected `?Sized` after `for` in trait item\");\n                 return None;\n             }\n-            let tref = Parser::trait_ref_from_ident(ident, span);\n-            Some(tref)\n+            let _tref = Parser::trait_ref_from_ident(ident, span);\n+\n+            self.obsolete(span, ObsoleteForSized);\n+\n+            None\n         } else {\n             None\n         }"}, {"sha": "1b86d08a50dff50d5f63606bfc371c75a750aac7", "filename": "src/test/compile-fail/obsolete-for-sized.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/4ed2800701fa0634c2aa73e7b090e84be665166a/src%2Ftest%2Fcompile-fail%2Fobsolete-for-sized.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4ed2800701fa0634c2aa73e7b090e84be665166a/src%2Ftest%2Fcompile-fail%2Fobsolete-for-sized.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fobsolete-for-sized.rs?ref=4ed2800701fa0634c2aa73e7b090e84be665166a", "patch": "@@ -0,0 +1,17 @@\n+// Copyright 2015 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// Test that we generate obsolete syntax errors around usages of `for Sized?`\n+\n+trait Foo for Sized? {} //~ ERROR obsolete syntax: for Sized?\n+\n+trait Bar for ?Sized {} //~ ERROR obsolete syntax: for Sized?\n+\n+fn main() { }"}]}