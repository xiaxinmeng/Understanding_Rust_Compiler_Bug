{"sha": "d86aff8042cd06427fc3917aa2f964094c3643ec", "node_id": "C_kwDOAAsO6NoAKGQ4NmFmZjgwNDJjZDA2NDI3ZmMzOTE3YWEyZjk2NDA5NGMzNjQzZWM", "commit": {"author": {"name": "Esteban Kuber", "email": "esteban@kuber.com.ar", "date": "2021-11-24T17:11:15Z"}, "committer": {"name": "Esteban Kuber", "email": "esteban@kuber.com.ar", "date": "2021-11-24T20:02:16Z"}, "message": "Change how the fn params span is calculated\n\nUse the available Generics span field to avoid issues with `T: Fn()` bounds.\n\nThis is necessary to land #85346.", "tree": {"sha": "7d6c878acd1c59079053fe1200dc77dc3c2ce0a6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7d6c878acd1c59079053fe1200dc77dc3c2ce0a6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d86aff8042cd06427fc3917aa2f964094c3643ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d86aff8042cd06427fc3917aa2f964094c3643ec", "html_url": "https://github.com/rust-lang/rust/commit/d86aff8042cd06427fc3917aa2f964094c3643ec", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d86aff8042cd06427fc3917aa2f964094c3643ec/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7190bc3097a3f84c9d0e07d149eba4b00e4f8917", "url": "https://api.github.com/repos/rust-lang/rust/commits/7190bc3097a3f84c9d0e07d149eba4b00e4f8917", "html_url": "https://github.com/rust-lang/rust/commit/7190bc3097a3f84c9d0e07d149eba4b00e4f8917"}], "stats": {"total": 12, "additions": 2, "deletions": 10}, "files": [{"sha": "acc91f861e474df3f36879b9e71277246cc04495", "filename": "src/tools/rustfmt/src/items.rs", "status": "modified", "additions": 2, "deletions": 10, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/d86aff8042cd06427fc3917aa2f964094c3643ec/src%2Ftools%2Frustfmt%2Fsrc%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d86aff8042cd06427fc3917aa2f964094c3643ec/src%2Ftools%2Frustfmt%2Fsrc%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustfmt%2Fsrc%2Fitems.rs?ref=d86aff8042cd06427fc3917aa2f964094c3643ec", "patch": "@@ -2236,26 +2236,18 @@ fn rewrite_fn_base(\n         result.push_str(&param_indent.to_string_with_newline(context.config));\n     }\n \n-    // Skip `pub(crate)`.\n-    let lo_after_visibility = get_bytepos_after_visibility(fn_sig.visibility, span);\n-    // A conservative estimation, the goal is to be over all parens in generics\n-    let params_start = fn_sig\n-        .generics\n-        .params\n-        .last()\n-        .map_or(lo_after_visibility, |param| param.span().hi());\n     let params_end = if fd.inputs.is_empty() {\n         context\n             .snippet_provider\n-            .span_after(mk_sp(params_start, span.hi()), \")\")\n+            .span_after(mk_sp(fn_sig.generics.span.hi(), span.hi()), \")\")\n     } else {\n         let last_span = mk_sp(fd.inputs[fd.inputs.len() - 1].span().hi(), span.hi());\n         context.snippet_provider.span_after(last_span, \")\")\n     };\n     let params_span = mk_sp(\n         context\n             .snippet_provider\n-            .span_after(mk_sp(params_start, span.hi()), \"(\"),\n+            .span_after(mk_sp(fn_sig.generics.span.hi(), span.hi()), \"(\"),\n         params_end,\n     );\n     let param_str = rewrite_params("}]}