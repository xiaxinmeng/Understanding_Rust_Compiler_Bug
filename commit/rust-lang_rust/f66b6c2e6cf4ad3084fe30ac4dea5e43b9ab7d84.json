{"sha": "f66b6c2e6cf4ad3084fe30ac4dea5e43b9ab7d84", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY2NmI2YzJlNmNmNGFkMzA4NGZlMzBhYzRkZWE1ZTQzYjlhYjdkODQ=", "commit": {"author": {"name": "Jack Huey", "email": "31162821+jackh726@users.noreply.github.com", "date": "2021-05-19T02:36:08Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-05-19T02:36:08Z"}, "message": "Rollup merge of #85297 - infinity0:master, r=Mark-Simulacrum\n\nbootstrap: build cargo only if requested in tools\n\nIn Debian we'd like to build rustfmt and clippy alongside rustc, but we're still excluding cargo from the rustc build and doing that separately. This patch makes that possible.", "tree": {"sha": "fc9ebafa1a09da1eef8c335c0110056c92bd89eb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fc9ebafa1a09da1eef8c335c0110056c92bd89eb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f66b6c2e6cf4ad3084fe30ac4dea5e43b9ab7d84", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgpHmbCRBK7hj4Ov3rIwAAPSIIAKhRdhDs/kWUswbX0XdpjwF7\n9GEs9byfzXPSdB6WgWas8nVJXFhnFKmBpYdSOgCWPa/e9JTcpOaclF4Lf7vwXThW\navzBQwvwSck8if1f135XOJG3Yg+KCaUU77wdM4yJ9yr97nrzo6u4nMJ9BC3MAxDG\nLlwcgs4BjH+CwiE4u7dJPlswKF7nh/vscl2VKDxRON1W3BkQtalqIl69ItKSlvZt\nVFc70kYgRADLLKYngL54WTvztWD1nQPu6WFkqXyAF3LZjxCdjR4kczwbzZoGVqqs\n+rLeMkqNXMOpJSS0yG0+JTeCzUOFfrQC0S0aq4ZHJyz4ByD0IRGV1H7KQe8Pzoo=\n=jbeZ\n-----END PGP SIGNATURE-----\n", "payload": "tree fc9ebafa1a09da1eef8c335c0110056c92bd89eb\nparent ec0e0d1e7aac94245dfe0c11f55c9ba6d2754aba\nparent 15aad5fcdb33a75e495a3d427228df62b6eadd5b\nauthor Jack Huey <31162821+jackh726@users.noreply.github.com> 1621391768 -0400\ncommitter GitHub <noreply@github.com> 1621391768 -0400\n\nRollup merge of #85297 - infinity0:master, r=Mark-Simulacrum\n\nbootstrap: build cargo only if requested in tools\n\nIn Debian we'd like to build rustfmt and clippy alongside rustc, but we're still excluding cargo from the rustc build and doing that separately. This patch makes that possible.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f66b6c2e6cf4ad3084fe30ac4dea5e43b9ab7d84", "html_url": "https://github.com/rust-lang/rust/commit/f66b6c2e6cf4ad3084fe30ac4dea5e43b9ab7d84", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f66b6c2e6cf4ad3084fe30ac4dea5e43b9ab7d84/comments", "author": {"login": "jackh726", "id": 31162821, "node_id": "MDQ6VXNlcjMxMTYyODIx", "avatar_url": "https://avatars.githubusercontent.com/u/31162821?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackh726", "html_url": "https://github.com/jackh726", "followers_url": "https://api.github.com/users/jackh726/followers", "following_url": "https://api.github.com/users/jackh726/following{/other_user}", "gists_url": "https://api.github.com/users/jackh726/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackh726/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackh726/subscriptions", "organizations_url": "https://api.github.com/users/jackh726/orgs", "repos_url": "https://api.github.com/users/jackh726/repos", "events_url": "https://api.github.com/users/jackh726/events{/privacy}", "received_events_url": "https://api.github.com/users/jackh726/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ec0e0d1e7aac94245dfe0c11f55c9ba6d2754aba", "url": "https://api.github.com/repos/rust-lang/rust/commits/ec0e0d1e7aac94245dfe0c11f55c9ba6d2754aba", "html_url": "https://github.com/rust-lang/rust/commit/ec0e0d1e7aac94245dfe0c11f55c9ba6d2754aba"}, {"sha": "15aad5fcdb33a75e495a3d427228df62b6eadd5b", "url": "https://api.github.com/repos/rust-lang/rust/commits/15aad5fcdb33a75e495a3d427228df62b6eadd5b", "html_url": "https://github.com/rust-lang/rust/commit/15aad5fcdb33a75e495a3d427228df62b6eadd5b"}], "stats": {"total": 9, "additions": 8, "deletions": 1}, "files": [{"sha": "dd8c6023a44cb915c177754d606044b4317a13f6", "filename": "src/bootstrap/tool.rs", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/f66b6c2e6cf4ad3084fe30ac4dea5e43b9ab7d84/src%2Fbootstrap%2Ftool.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f66b6c2e6cf4ad3084fe30ac4dea5e43b9ab7d84/src%2Fbootstrap%2Ftool.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftool.rs?ref=f66b6c2e6cf4ad3084fe30ac4dea5e43b9ab7d84", "patch": "@@ -593,7 +593,14 @@ impl Step for Cargo {\n \n     fn should_run(run: ShouldRun<'_>) -> ShouldRun<'_> {\n         let builder = run.builder;\n-        run.path(\"src/tools/cargo\").default_condition(builder.config.extended)\n+        run.path(\"src/tools/cargo\").default_condition(\n+            builder.config.extended\n+                && builder.config.tools.as_ref().map_or(\n+                    true,\n+                    // If `tools` is set, search list for this tool.\n+                    |tools| tools.iter().any(|tool| tool == \"cargo\"),\n+                ),\n+        )\n     }\n \n     fn make_run(run: RunConfig<'_>) {"}]}