{"sha": "60a3785ac27d7361617977bd53e11f2859e97c7c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYwYTM3ODVhYzI3ZDczNjE2MTc5NzdiZDUzZTExZjI4NTllOTdjN2M=", "commit": {"author": {"name": "Edwin Cheng", "email": "edwin0cheng@gmail.com", "date": "2020-12-18T02:26:17Z"}, "committer": {"name": "Edwin Cheng", "email": "edwin0cheng@gmail.com", "date": "2020-12-18T02:26:17Z"}, "message": "Temp fixes panic caused by no ast for proc-macro", "tree": {"sha": "b79241db7008f95204b42e45a41dcbc4d07bda99", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b79241db7008f95204b42e45a41dcbc4d07bda99"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/60a3785ac27d7361617977bd53e11f2859e97c7c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/60a3785ac27d7361617977bd53e11f2859e97c7c", "html_url": "https://github.com/rust-lang/rust/commit/60a3785ac27d7361617977bd53e11f2859e97c7c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/60a3785ac27d7361617977bd53e11f2859e97c7c/comments", "author": {"login": "edwin0cheng", "id": 11014119, "node_id": "MDQ6VXNlcjExMDE0MTE5", "avatar_url": "https://avatars.githubusercontent.com/u/11014119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edwin0cheng", "html_url": "https://github.com/edwin0cheng", "followers_url": "https://api.github.com/users/edwin0cheng/followers", "following_url": "https://api.github.com/users/edwin0cheng/following{/other_user}", "gists_url": "https://api.github.com/users/edwin0cheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/edwin0cheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edwin0cheng/subscriptions", "organizations_url": "https://api.github.com/users/edwin0cheng/orgs", "repos_url": "https://api.github.com/users/edwin0cheng/repos", "events_url": "https://api.github.com/users/edwin0cheng/events{/privacy}", "received_events_url": "https://api.github.com/users/edwin0cheng/received_events", "type": "User", "site_admin": false}, "committer": {"login": "edwin0cheng", "id": 11014119, "node_id": "MDQ6VXNlcjExMDE0MTE5", "avatar_url": "https://avatars.githubusercontent.com/u/11014119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edwin0cheng", "html_url": "https://github.com/edwin0cheng", "followers_url": "https://api.github.com/users/edwin0cheng/followers", "following_url": "https://api.github.com/users/edwin0cheng/following{/other_user}", "gists_url": "https://api.github.com/users/edwin0cheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/edwin0cheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edwin0cheng/subscriptions", "organizations_url": "https://api.github.com/users/edwin0cheng/orgs", "repos_url": "https://api.github.com/users/edwin0cheng/repos", "events_url": "https://api.github.com/users/edwin0cheng/events{/privacy}", "received_events_url": "https://api.github.com/users/edwin0cheng/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c1c36acb025880c742c65f436a61fd87fc627eb0", "url": "https://api.github.com/repos/rust-lang/rust/commits/c1c36acb025880c742c65f436a61fd87fc627eb0", "html_url": "https://github.com/rust-lang/rust/commit/c1c36acb025880c742c65f436a61fd87fc627eb0"}], "stats": {"total": 23, "additions": 22, "deletions": 1}, "files": [{"sha": "dac79592f7f22ad24f1ef805fa69ed33cc049bb2", "filename": "crates/completion/src/render/macro_.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/60a3785ac27d7361617977bd53e11f2859e97c7c/crates%2Fcompletion%2Fsrc%2Frender%2Fmacro_.rs", "raw_url": "https://github.com/rust-lang/rust/raw/60a3785ac27d7361617977bd53e11f2859e97c7c/crates%2Fcompletion%2Fsrc%2Frender%2Fmacro_.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2Fsrc%2Frender%2Fmacro_.rs?ref=60a3785ac27d7361617977bd53e11f2859e97c7c", "patch": "@@ -41,6 +41,7 @@ impl<'a> MacroRender<'a> {\n     fn render(&self, import_to_add: Option<ImportEdit>) -> Option<CompletionItem> {\n         // FIXME: Currently proc-macro do not have ast-node,\n         // such that it does not have source\n+        // more discussion: https://github.com/rust-analyzer/rust-analyzer/issues/6913\n         if self.macro_.is_proc_macro() {\n             return None;\n         }"}, {"sha": "7ffa79996ce4d77bd3e8978dae16b500c72d96e3", "filename": "crates/hir/src/code_model.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/60a3785ac27d7361617977bd53e11f2859e97c7c/crates%2Fhir%2Fsrc%2Fcode_model.rs", "raw_url": "https://github.com/rust-lang/rust/raw/60a3785ac27d7361617977bd53e11f2859e97c7c/crates%2Fhir%2Fsrc%2Fcode_model.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir%2Fsrc%2Fcode_model.rs?ref=60a3785ac27d7361617977bd53e11f2859e97c7c", "patch": "@@ -977,6 +977,12 @@ impl MacroDef {\n \n     /// XXX: this parses the file\n     pub fn name(self, db: &dyn HirDatabase) -> Option<Name> {\n+        // FIXME: Currently proc-macro do not have ast-node,\n+        // such that it does not have source\n+        // more discussion: https://github.com/rust-analyzer/rust-analyzer/issues/6913\n+        if self.is_proc_macro() {\n+            return None;\n+        }\n         self.source(db).value.name().map(|it| it.as_name())\n     }\n "}, {"sha": "73fc7361984419b7a5f8a8c01b169bcc2b92c7de", "filename": "crates/ide/src/display/navigation_target.rs", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/60a3785ac27d7361617977bd53e11f2859e97c7c/crates%2Fide%2Fsrc%2Fdisplay%2Fnavigation_target.rs", "raw_url": "https://github.com/rust-lang/rust/raw/60a3785ac27d7361617977bd53e11f2859e97c7c/crates%2Fide%2Fsrc%2Fdisplay%2Fnavigation_target.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fdisplay%2Fnavigation_target.rs?ref=60a3785ac27d7361617977bd53e11f2859e97c7c", "patch": "@@ -176,7 +176,15 @@ impl ToNav for FileSymbol {\n impl TryToNav for Definition {\n     fn try_to_nav(&self, db: &RootDatabase) -> Option<NavigationTarget> {\n         match self {\n-            Definition::Macro(it) => Some(it.to_nav(db)),\n+            Definition::Macro(it) => {\n+                // FIXME: Currently proc-macro do not have ast-node,\n+                // such that it does not have source\n+                // more discussion: https://github.com/rust-analyzer/rust-analyzer/issues/6913\n+                if it.is_proc_macro() {\n+                    return None;\n+                }\n+                Some(it.to_nav(db))\n+            }\n             Definition::Field(it) => Some(it.to_nav(db)),\n             Definition::ModuleDef(it) => it.try_to_nav(db),\n             Definition::SelfType(it) => Some(it.to_nav(db)),"}, {"sha": "c03dd74e40f0c863e71577dbe1e4eec9281a4daf", "filename": "crates/ide/src/hover.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/60a3785ac27d7361617977bd53e11f2859e97c7c/crates%2Fide%2Fsrc%2Fhover.rs", "raw_url": "https://github.com/rust-lang/rust/raw/60a3785ac27d7361617977bd53e11f2859e97c7c/crates%2Fide%2Fsrc%2Fhover.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fhover.rs?ref=60a3785ac27d7361617977bd53e11f2859e97c7c", "patch": "@@ -324,6 +324,12 @@ fn hover_for_definition(db: &RootDatabase, def: Definition) -> Option<Markup> {\n     let mod_path = definition_mod_path(db, &def);\n     return match def {\n         Definition::Macro(it) => {\n+            // FIXME: Currently proc-macro do not have ast-node,\n+            // such that it does not have source\n+            // more discussion: https://github.com/rust-analyzer/rust-analyzer/issues/6913\n+            if it.is_proc_macro() {\n+                return None;\n+            }\n             let label = macro_label(&it.source(db).value);\n             from_def_source_labeled(db, it, Some(label), mod_path)\n         }"}]}