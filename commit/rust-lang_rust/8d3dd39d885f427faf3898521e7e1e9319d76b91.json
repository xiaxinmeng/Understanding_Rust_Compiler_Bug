{"sha": "8d3dd39d885f427faf3898521e7e1e9319d76b91", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhkM2RkMzlkODg1ZjQyN2ZhZjM4OTg1MjFlN2UxZTkzMTlkNzZiOTE=", "commit": {"author": {"name": "Samuel Holland", "email": "samuel@sholland.org", "date": "2019-03-22T22:08:06Z"}, "committer": {"name": "Samuel Holland", "email": "samuel@sholland.org", "date": "2019-03-23T02:28:25Z"}, "message": "Correct minimum system LLVM version in tests\n\nSince commit 9452a8dfa3ba, the new debug info format is only generated\nfor LLVM 8 and newer versions. However, the tests still assume that LLVM\n7 will use the new debug info format. Fix the tests (and a comment in\nthe code) to match the actual version check.", "tree": {"sha": "97a02db95cdd490e80504ff04a6f6cae87684428", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/97a02db95cdd490e80504ff04a6f6cae87684428"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8d3dd39d885f427faf3898521e7e1e9319d76b91", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8d3dd39d885f427faf3898521e7e1e9319d76b91", "html_url": "https://github.com/rust-lang/rust/commit/8d3dd39d885f427faf3898521e7e1e9319d76b91", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8d3dd39d885f427faf3898521e7e1e9319d76b91/comments", "author": {"login": "smaeul", "id": 5846453, "node_id": "MDQ6VXNlcjU4NDY0NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/5846453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smaeul", "html_url": "https://github.com/smaeul", "followers_url": "https://api.github.com/users/smaeul/followers", "following_url": "https://api.github.com/users/smaeul/following{/other_user}", "gists_url": "https://api.github.com/users/smaeul/gists{/gist_id}", "starred_url": "https://api.github.com/users/smaeul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smaeul/subscriptions", "organizations_url": "https://api.github.com/users/smaeul/orgs", "repos_url": "https://api.github.com/users/smaeul/repos", "events_url": "https://api.github.com/users/smaeul/events{/privacy}", "received_events_url": "https://api.github.com/users/smaeul/received_events", "type": "User", "site_admin": false}, "committer": {"login": "smaeul", "id": 5846453, "node_id": "MDQ6VXNlcjU4NDY0NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/5846453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smaeul", "html_url": "https://github.com/smaeul", "followers_url": "https://api.github.com/users/smaeul/followers", "following_url": "https://api.github.com/users/smaeul/following{/other_user}", "gists_url": "https://api.github.com/users/smaeul/gists{/gist_id}", "starred_url": "https://api.github.com/users/smaeul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smaeul/subscriptions", "organizations_url": "https://api.github.com/users/smaeul/orgs", "repos_url": "https://api.github.com/users/smaeul/repos", "events_url": "https://api.github.com/users/smaeul/events{/privacy}", "received_events_url": "https://api.github.com/users/smaeul/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "52e885628e4317aa3f158622435927eb29b812e9", "url": "https://api.github.com/repos/rust-lang/rust/commits/52e885628e4317aa3f158622435927eb29b812e9", "html_url": "https://github.com/rust-lang/rust/commit/52e885628e4317aa3f158622435927eb29b812e9"}], "stats": {"total": 32, "additions": 17, "deletions": 15}, "files": [{"sha": "8efa025e3dd9d4bfb07637bd3d26bb627fa30b50", "filename": "src/librustc_codegen_llvm/debuginfo/metadata.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Flibrustc_codegen_llvm%2Fdebuginfo%2Fmetadata.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Flibrustc_codegen_llvm%2Fdebuginfo%2Fmetadata.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fdebuginfo%2Fmetadata.rs?ref=8d3dd39d885f427faf3898521e7e1e9319d76b91", "patch": "@@ -1156,12 +1156,14 @@ fn prepare_union_metadata(\n // Enums\n //=-----------------------------------------------------------------------------\n \n-// DWARF variant support is only available starting in LLVM 7.\n+// DWARF variant support is only available starting in LLVM 8.\n // Although the earlier enum debug info output did not work properly\n // in all situations, it is better for the time being to continue to\n // sometimes emit the old style rather than emit something completely\n-// useless when rust is compiled against LLVM 6 or older.  This\n-// function decides which representation will be emitted.\n+// useless when rust is compiled against LLVM 6 or older. LLVM 7\n+// contains an early version of the DWARF variant support, and will\n+// crash when handling the new debug info format. This function\n+// decides which representation will be emitted.\n fn use_enum_fallback(cx: &CodegenCx<'_, '_>) -> bool {\n     // On MSVC we have to use the fallback mode, because LLVM doesn't\n     // lower variant parts to PDB."}, {"sha": "f268c8bcbccdb2291783f5f4b69a19aa29f546af", "filename": "src/test/codegen/enum-debug-clike.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fcodegen%2Fenum-debug-clike.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fcodegen%2Fenum-debug-clike.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fenum-debug-clike.rs?ref=8d3dd39d885f427faf3898521e7e1e9319d76b91", "patch": "@@ -4,7 +4,7 @@\n \n // ignore-tidy-linelength\n // ignore-windows\n-// min-system-llvm-version 7.0\n+// min-system-llvm-version 8.0\n \n // compile-flags: -g -C no-prepopulate-passes\n "}, {"sha": "aa6cbf66b4aa3bc24ad4334acecce3e4a64760e5", "filename": "src/test/codegen/enum-debug-niche-2.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fcodegen%2Fenum-debug-niche-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fcodegen%2Fenum-debug-niche-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fenum-debug-niche-2.rs?ref=8d3dd39d885f427faf3898521e7e1e9319d76b91", "patch": "@@ -4,7 +4,7 @@\n \n // ignore-tidy-linelength\n // ignore-windows\n-// min-system-llvm-version 7.0\n+// min-system-llvm-version 8.0\n \n // compile-flags: -g -C no-prepopulate-passes\n "}, {"sha": "93eebde7b8f42bdc22c56d54b6847761d8c364bf", "filename": "src/test/codegen/enum-debug-niche.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fcodegen%2Fenum-debug-niche.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fcodegen%2Fenum-debug-niche.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fenum-debug-niche.rs?ref=8d3dd39d885f427faf3898521e7e1e9319d76b91", "patch": "@@ -4,7 +4,7 @@\n \n // ignore-tidy-linelength\n // ignore-windows\n-// min-system-llvm-version 7.0\n+// min-system-llvm-version 8.0\n \n // compile-flags: -g -C no-prepopulate-passes\n "}, {"sha": "84976ce97af4b1bad724c45ac0e40588ffaa5bfa", "filename": "src/test/codegen/enum-debug-tagged.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fcodegen%2Fenum-debug-tagged.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fcodegen%2Fenum-debug-tagged.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fenum-debug-tagged.rs?ref=8d3dd39d885f427faf3898521e7e1e9319d76b91", "patch": "@@ -4,7 +4,7 @@\n \n // ignore-tidy-linelength\n // ignore-windows\n-// min-system-llvm-version 7.0\n+// min-system-llvm-version 8.0\n \n // compile-flags: -g -C no-prepopulate-passes\n "}, {"sha": "63c11f59c157d598422cae0cf43a3aaa2743f345", "filename": "src/test/debuginfo/borrowed-enum.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Fborrowed-enum.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Fborrowed-enum.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fdebuginfo%2Fborrowed-enum.rs?ref=8d3dd39d885f427faf3898521e7e1e9319d76b91", "patch": "@@ -1,7 +1,7 @@\n // ignore-tidy-linelength\n \n // Require LLVM with DW_TAG_variant_part and a gdb or lldb that can read it.\n-// min-system-llvm-version: 7.0\n+// min-system-llvm-version: 8.0\n // min-gdb-version: 8.2\n // rust-lldb\n "}, {"sha": "e26294cb730a06a0baae024d0e6f46a8770ad042", "filename": "src/test/debuginfo/generic-enum-with-different-disr-sizes.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Fgeneric-enum-with-different-disr-sizes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Fgeneric-enum-with-different-disr-sizes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fdebuginfo%2Fgeneric-enum-with-different-disr-sizes.rs?ref=8d3dd39d885f427faf3898521e7e1e9319d76b91", "patch": "@@ -3,7 +3,7 @@\n // min-lldb-version: 310\n \n // Require LLVM with DW_TAG_variant_part and a gdb that can read it.\n-// min-system-llvm-version: 7.0\n+// min-system-llvm-version: 8.0\n // min-gdb-version: 8.2\n \n // compile-flags:-g"}, {"sha": "3dc5cb807b452349c7c424c8819a363d0318cb04", "filename": "src/test/debuginfo/generic-struct-style-enum.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Fgeneric-struct-style-enum.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Fgeneric-struct-style-enum.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fdebuginfo%2Fgeneric-struct-style-enum.rs?ref=8d3dd39d885f427faf3898521e7e1e9319d76b91", "patch": "@@ -2,7 +2,7 @@\n // min-lldb-version: 310\n \n // Require LLVM with DW_TAG_variant_part and a gdb that can read it.\n-// min-system-llvm-version: 7.0\n+// min-system-llvm-version: 8.0\n // min-gdb-version: 8.2\n \n // compile-flags:-g"}, {"sha": "b16634ee6d7f99a8203a7195131da086e6995c6c", "filename": "src/test/debuginfo/generic-tuple-style-enum.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Fgeneric-tuple-style-enum.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Fgeneric-tuple-style-enum.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fdebuginfo%2Fgeneric-tuple-style-enum.rs?ref=8d3dd39d885f427faf3898521e7e1e9319d76b91", "patch": "@@ -2,7 +2,7 @@\n \n // Require LLVM with DW_TAG_variant_part and a gdb and lldb that can\n // read it.\n-// min-system-llvm-version: 7.0\n+// min-system-llvm-version: 8.0\n // min-gdb-version: 8.2\n // rust-lldb\n "}, {"sha": "8fb83b7956be3309b818fae9d100b8b38302daad", "filename": "src/test/debuginfo/recursive-struct.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Frecursive-struct.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Frecursive-struct.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fdebuginfo%2Frecursive-struct.rs?ref=8d3dd39d885f427faf3898521e7e1e9319d76b91", "patch": "@@ -2,7 +2,7 @@\n // ignore-lldb\n \n // Require LLVM with DW_TAG_variant_part and a gdb that can read it.\n-// min-system-llvm-version: 7.0\n+// min-system-llvm-version: 8.0\n // min-gdb-version: 8.2\n \n // compile-flags:-g"}, {"sha": "5843b076b1f465d9a11f45cc35bb74f5d79f1922", "filename": "src/test/debuginfo/struct-style-enum.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Fstruct-style-enum.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Fstruct-style-enum.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fdebuginfo%2Fstruct-style-enum.rs?ref=8d3dd39d885f427faf3898521e7e1e9319d76b91", "patch": "@@ -2,7 +2,7 @@\n \n // Require LLVM with DW_TAG_variant_part and a gdb and lldb that can\n // read it.\n-// min-system-llvm-version: 7.0\n+// min-system-llvm-version: 8.0\n // min-gdb-version: 8.2\n // rust-lldb\n "}, {"sha": "4d9727a388b8ed87e4b35df1d95edbcc7bbd22b7", "filename": "src/test/debuginfo/tuple-style-enum.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Ftuple-style-enum.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Ftuple-style-enum.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fdebuginfo%2Ftuple-style-enum.rs?ref=8d3dd39d885f427faf3898521e7e1e9319d76b91", "patch": "@@ -2,7 +2,7 @@\n \n // Require LLVM with DW_TAG_variant_part and a gdb and lldb that can\n // read it.\n-// min-system-llvm-version: 7.0\n+// min-system-llvm-version: 8.0\n // min-gdb-version: 8.2\n // rust-lldb\n "}, {"sha": "32bd93f1ed2cee2671feda502eec1fd4a0936d2f", "filename": "src/test/debuginfo/unique-enum.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Funique-enum.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8d3dd39d885f427faf3898521e7e1e9319d76b91/src%2Ftest%2Fdebuginfo%2Funique-enum.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fdebuginfo%2Funique-enum.rs?ref=8d3dd39d885f427faf3898521e7e1e9319d76b91", "patch": "@@ -2,7 +2,7 @@\n \n // Require LLVM with DW_TAG_variant_part and a gdb and lldb that can\n // read it.\n-// min-system-llvm-version: 7.0\n+// min-system-llvm-version: 8.0\n // min-gdb-version: 8.2\n // rust-lldb\n "}]}