{"sha": "5b6e747f37bd75c611674781b7035b2e47bb2d4c", "node_id": "C_kwDOAAsO6NoAKDViNmU3NDdmMzdiZDc1YzYxMTY3NDc4MWI3MDM1YjJlNDdiYjJkNGM", "commit": {"author": {"name": "Jules Bertholet", "email": "julesbertholet@quoi.xyz", "date": "2023-04-26T23:46:10Z"}, "committer": {"name": "Jules Bertholet", "email": "julesbertholet@quoi.xyz", "date": "2023-04-26T23:46:10Z"}, "message": "Nicer ICE for #67981", "tree": {"sha": "cb78844383063496a80e13e0670721a46a5e32d5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cb78844383063496a80e13e0670721a46a5e32d5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5b6e747f37bd75c611674781b7035b2e47bb2d4c", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEMF9QrRtpLpRzqgMeMgNNr8OMG/wFAmRJt9kACgkQMgNNr8OM\nG/zcmg/+KPopIDtVcRx6USt8UxZkLzM/7Q2E/51tiXxrvLsIDpfBWfr5/8XfLhwj\nYnhPtpfTvYj//gTTEr65aW5DWyUkDyvFCJ+S3+0dmmW0qeP7sNq9NstwwdDeRVdY\n7vj5ArkDjfDrwHtyFrHKSeUsOmRrva9QyW/9StaQzo4wLQpqjOzVa0jJS6ZVKHYU\n4U7X/3IHubo1tnkNRiwp0QAYfgwZo+u9Kc9uv3iqOiZCN7kQhnPLb9rM05uGH1+U\n8Oinfam2V1lTKeozNh4Bx4XltUGUtZbmbk7OdTL5HfaC/rcAFbo2G6scofd2MiEq\nHDXxgJv/IVjAfGJOn7vNocRSfCQlMqJ+RQENWWInL4vpRrbKFI2vEjre1eczcj6+\nEzxFaoGIiaBjIkGshmYY6nqxh37J1EZppLYsdOpim5kh5Bs+XYxfi4imv4Nexkhe\nOiSLlgOWeOrIq5gt/ZtMKL7SPzA55vrhpMnPx31jBkiRy0YC+elR1PJNN91Ydpp4\ne8tDZMlIxWYGNWh+GsTqD1WGj3agvlUuwO4gYWssmUoo81cPbj9yTprEVC7MeAcH\nlaED1fbzZJ66LJVXOM/bz8MjtCTxN+CjcrgMbmmmM2AsOVKGI7V66OfWh2YXGUZh\nwCsfr+cgyepibLqemNI7ji6rKa4O5R8J7+NVoCsJ00M3gED+VX4=\n=LYpR\n-----END PGP SIGNATURE-----", "payload": "tree cb78844383063496a80e13e0670721a46a5e32d5\nparent 1c42cb4ef0544fbfaa500216e53382d6b079c001\nauthor Jules Bertholet <julesbertholet@quoi.xyz> 1682552770 -0400\ncommitter Jules Bertholet <julesbertholet@quoi.xyz> 1682552770 -0400\n\nNicer ICE for #67981\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5b6e747f37bd75c611674781b7035b2e47bb2d4c", "html_url": "https://github.com/rust-lang/rust/commit/5b6e747f37bd75c611674781b7035b2e47bb2d4c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5b6e747f37bd75c611674781b7035b2e47bb2d4c/comments", "author": {"login": "Jules-Bertholet", "id": 79955405, "node_id": "MDQ6VXNlcjc5OTU1NDA1", "avatar_url": "https://avatars.githubusercontent.com/u/79955405?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jules-Bertholet", "html_url": "https://github.com/Jules-Bertholet", "followers_url": "https://api.github.com/users/Jules-Bertholet/followers", "following_url": "https://api.github.com/users/Jules-Bertholet/following{/other_user}", "gists_url": "https://api.github.com/users/Jules-Bertholet/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jules-Bertholet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jules-Bertholet/subscriptions", "organizations_url": "https://api.github.com/users/Jules-Bertholet/orgs", "repos_url": "https://api.github.com/users/Jules-Bertholet/repos", "events_url": "https://api.github.com/users/Jules-Bertholet/events{/privacy}", "received_events_url": "https://api.github.com/users/Jules-Bertholet/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Jules-Bertholet", "id": 79955405, "node_id": "MDQ6VXNlcjc5OTU1NDA1", "avatar_url": "https://avatars.githubusercontent.com/u/79955405?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jules-Bertholet", "html_url": "https://github.com/Jules-Bertholet", "followers_url": "https://api.github.com/users/Jules-Bertholet/followers", "following_url": "https://api.github.com/users/Jules-Bertholet/following{/other_user}", "gists_url": "https://api.github.com/users/Jules-Bertholet/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jules-Bertholet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jules-Bertholet/subscriptions", "organizations_url": "https://api.github.com/users/Jules-Bertholet/orgs", "repos_url": "https://api.github.com/users/Jules-Bertholet/repos", "events_url": "https://api.github.com/users/Jules-Bertholet/events{/privacy}", "received_events_url": "https://api.github.com/users/Jules-Bertholet/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1c42cb4ef0544fbfaa500216e53382d6b079c001", "url": "https://api.github.com/repos/rust-lang/rust/commits/1c42cb4ef0544fbfaa500216e53382d6b079c001", "html_url": "https://github.com/rust-lang/rust/commit/1c42cb4ef0544fbfaa500216e53382d6b079c001"}], "stats": {"total": 12, "additions": 11, "deletions": 1}, "files": [{"sha": "6bade5714bea38b08ad455fa09b225780c695f11", "filename": "compiler/rustc_codegen_ssa/src/mir/mod.rs", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/5b6e747f37bd75c611674781b7035b2e47bb2d4c/compiler%2Frustc_codegen_ssa%2Fsrc%2Fmir%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5b6e747f37bd75c611674781b7035b2e47bb2d4c/compiler%2Frustc_codegen_ssa%2Fsrc%2Fmir%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_ssa%2Fsrc%2Fmir%2Fmod.rs?ref=5b6e747f37bd75c611674781b7035b2e47bb2d4c", "patch": "@@ -304,7 +304,17 @@ fn arg_local_refs<'a, 'tcx, Bx: BuilderMethods<'a, 'tcx>>(\n                     bug!(\"spread argument isn't a tuple?!\");\n                 };\n \n-                let place = PlaceRef::alloca(bx, bx.layout_of(arg_ty));\n+                let layout = bx.layout_of(arg_ty);\n+\n+                // FIXME: support unsized params in \"rust-call\" ABI\n+                if layout.is_unsized() {\n+                    span_bug!(\n+                        arg_decl.source_info.span,\n+                        \"\\\"rust-call\\\" ABI does not support unsized params\",\n+                    );\n+                }\n+\n+                let place = PlaceRef::alloca(bx, layout);\n                 for i in 0..tupled_arg_tys.len() {\n                     let arg = &fx.fn_abi.args[idx];\n                     idx += 1;"}]}