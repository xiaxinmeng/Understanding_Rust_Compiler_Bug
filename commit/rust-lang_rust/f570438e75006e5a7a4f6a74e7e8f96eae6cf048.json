{"sha": "f570438e75006e5a7a4f6a74e7e8f96eae6cf048", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY1NzA0MzhlNzUwMDZlNWE3YTRmNmE3NGU3ZThmOTZlYWU2Y2YwNDg=", "commit": {"author": {"name": "St\u00e9phane Campinas", "email": "stephane.campinas@gmail.com", "date": "2018-11-08T21:44:59Z"}, "committer": {"name": "St\u00e9phane Campinas", "email": "stephane.campinas@gmail.com", "date": "2018-11-08T21:44:59Z"}, "message": "do not add a newline after a missed span if it is the end of a block comment", "tree": {"sha": "d00b8ac7696313e5f6528250aa7f1a7a7e3a31b6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d00b8ac7696313e5f6528250aa7f1a7a7e3a31b6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f570438e75006e5a7a4f6a74e7e8f96eae6cf048", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCgAdFiEEipi5pnt+pUplKNfibVYg2QghATMFAlvkrlsACgkQbVYg2Qgh\nATN3dAf/VfH7G9PbqKTONqHsTsi7ESOYIcV7RiNFTXrRa+men0J+AkAnZegJU6T+\ncx2OGP/RPphZ1LVdfocN0mZGNqrIfx45IsDCDdIexrAzB3ubzsu56zSjGek6NNG/\n4z51D10L/gNCR3aon43KsxdObxMxwL0GnvRFZy5gSzFOOo0uSi0DOmyx4jNSHUU2\nRjXSZvmdaokQg+xl23hkI2oWkiQJHUUeiQNssB58ISxSmeTAczXJ8BVd08fEMFT1\nq8x7ej8dwkTGUBgCEN2av6Uy0QYgZ04Yjep9bsEH+rGyLrsax0ZjYXYLiCA7GVr7\nLdMa9m7hgRzypC2BjKQT8biU4C3vcA==\n=faz7\n-----END PGP SIGNATURE-----", "payload": "tree d00b8ac7696313e5f6528250aa7f1a7a7e3a31b6\nparent 9534dfc062f636ecd9bdb5d617a8d6a192e6ff27\nauthor St\u00e9phane Campinas <stephane.campinas@gmail.com> 1541713499 +0100\ncommitter St\u00e9phane Campinas <stephane.campinas@gmail.com> 1541713499 +0100\n\ndo not add a newline after a missed span if it is the end of a block comment\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f570438e75006e5a7a4f6a74e7e8f96eae6cf048", "html_url": "https://github.com/rust-lang/rust/commit/f570438e75006e5a7a4f6a74e7e8f96eae6cf048", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f570438e75006e5a7a4f6a74e7e8f96eae6cf048/comments", "author": {"login": "scampi", "id": 795879, "node_id": "MDQ6VXNlcjc5NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/795879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scampi", "html_url": "https://github.com/scampi", "followers_url": "https://api.github.com/users/scampi/followers", "following_url": "https://api.github.com/users/scampi/following{/other_user}", "gists_url": "https://api.github.com/users/scampi/gists{/gist_id}", "starred_url": "https://api.github.com/users/scampi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scampi/subscriptions", "organizations_url": "https://api.github.com/users/scampi/orgs", "repos_url": "https://api.github.com/users/scampi/repos", "events_url": "https://api.github.com/users/scampi/events{/privacy}", "received_events_url": "https://api.github.com/users/scampi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "scampi", "id": 795879, "node_id": "MDQ6VXNlcjc5NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/795879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scampi", "html_url": "https://github.com/scampi", "followers_url": "https://api.github.com/users/scampi/followers", "following_url": "https://api.github.com/users/scampi/following{/other_user}", "gists_url": "https://api.github.com/users/scampi/gists{/gist_id}", "starred_url": "https://api.github.com/users/scampi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scampi/subscriptions", "organizations_url": "https://api.github.com/users/scampi/orgs", "repos_url": "https://api.github.com/users/scampi/repos", "events_url": "https://api.github.com/users/scampi/events{/privacy}", "received_events_url": "https://api.github.com/users/scampi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9534dfc062f636ecd9bdb5d617a8d6a192e6ff27", "url": "https://api.github.com/repos/rust-lang/rust/commits/9534dfc062f636ecd9bdb5d617a8d6a192e6ff27", "html_url": "https://github.com/rust-lang/rust/commit/9534dfc062f636ecd9bdb5d617a8d6a192e6ff27"}], "stats": {"total": 19, "additions": 16, "deletions": 3}, "files": [{"sha": "237a31e86b8838cfe2c05d0b23d70434063f1bea", "filename": "src/missed_spans.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/f570438e75006e5a7a4f6a74e7e8f96eae6cf048/src%2Fmissed_spans.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f570438e75006e5a7a4f6a74e7e8f96eae6cf048/src%2Fmissed_spans.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmissed_spans.rs?ref=f570438e75006e5a7a4f6a74e7e8f96eae6cf048", "patch": "@@ -260,9 +260,8 @@ impl<'a> FmtVisitor<'a> {\n         status.line_start = offset + subslice.len();\n \n         if let Some('/') = subslice.chars().nth(1) {\n-            // check that there are no contained block comments\n-            if !subslice.lines().any(|s| s.trim_left().starts_with(\"/*\")) {\n-                // Add a newline after line comments\n+            // Only add a newline if the last line is a line comment\n+            if !subslice.trim_end().ends_with(\"*/\") {\n                 self.push_str(\"\\n\");\n             }\n         } else if status.line_start <= snippet.len() {"}, {"sha": "1083050d8f4f9a17093e88b806e414dc8dfa05cb", "filename": "tests/target/issue-3124.rs", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/f570438e75006e5a7a4f6a74e7e8f96eae6cf048/tests%2Ftarget%2Fissue-3124.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f570438e75006e5a7a4f6a74e7e8f96eae6cf048/tests%2Ftarget%2Fissue-3124.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-3124.rs?ref=f570438e75006e5a7a4f6a74e7e8f96eae6cf048", "patch": "@@ -0,0 +1,14 @@\n+pub fn fail1() {\n+    // Some comment.\n+    /**///\n+}\n+\n+pub fn fail2() {\n+    // Some comment.\n+    /**/\n+}\n+\n+pub fn fail3() {\n+    // Some comment.\n+    //\n+}"}]}