{"sha": "0442bb9ce0b1f9851442fcc6f8f9dcb3ef88e3ca", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA0NDJiYjljZTBiMWY5ODUxNDQyZmNjNmY4ZjlkY2IzZWY4OGUzY2E=", "commit": {"author": {"name": "Wayne Warren", "email": "wayne.warren.s@gmail.com", "date": "2018-11-30T18:54:47Z"}, "committer": {"name": "Wayne Warren", "email": "wayne.warren.s@gmail.com", "date": "2018-12-06T00:18:17Z"}, "message": "Don't change current working directory of cargo tests", "tree": {"sha": "ae30e8d02f422116840360fec534bf80f9a1f68d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ae30e8d02f422116840360fec534bf80f9a1f68d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0442bb9ce0b1f9851442fcc6f8f9dcb3ef88e3ca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0442bb9ce0b1f9851442fcc6f8f9dcb3ef88e3ca", "html_url": "https://github.com/rust-lang/rust/commit/0442bb9ce0b1f9851442fcc6f8f9dcb3ef88e3ca", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0442bb9ce0b1f9851442fcc6f8f9dcb3ef88e3ca/comments", "author": {"login": "waynr", "id": 1441126, "node_id": "MDQ6VXNlcjE0NDExMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1441126?v=4", "gravatar_id": "", "url": "https://api.github.com/users/waynr", "html_url": "https://github.com/waynr", "followers_url": "https://api.github.com/users/waynr/followers", "following_url": "https://api.github.com/users/waynr/following{/other_user}", "gists_url": "https://api.github.com/users/waynr/gists{/gist_id}", "starred_url": "https://api.github.com/users/waynr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/waynr/subscriptions", "organizations_url": "https://api.github.com/users/waynr/orgs", "repos_url": "https://api.github.com/users/waynr/repos", "events_url": "https://api.github.com/users/waynr/events{/privacy}", "received_events_url": "https://api.github.com/users/waynr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "waynr", "id": 1441126, "node_id": "MDQ6VXNlcjE0NDExMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1441126?v=4", "gravatar_id": "", "url": "https://api.github.com/users/waynr", "html_url": "https://github.com/waynr", "followers_url": "https://api.github.com/users/waynr/followers", "following_url": "https://api.github.com/users/waynr/following{/other_user}", "gists_url": "https://api.github.com/users/waynr/gists{/gist_id}", "starred_url": "https://api.github.com/users/waynr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/waynr/subscriptions", "organizations_url": "https://api.github.com/users/waynr/orgs", "repos_url": "https://api.github.com/users/waynr/repos", "events_url": "https://api.github.com/users/waynr/events{/privacy}", "received_events_url": "https://api.github.com/users/waynr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "87d517df5db7597ab03a7cf0b8083f55a3cee8b7", "url": "https://api.github.com/repos/rust-lang/rust/commits/87d517df5db7597ab03a7cf0b8083f55a3cee8b7", "html_url": "https://github.com/rust-lang/rust/commit/87d517df5db7597ab03a7cf0b8083f55a3cee8b7"}], "stats": {"total": 10, "additions": 3, "deletions": 7}, "files": [{"sha": "c1f02b9fcefe355cfa9d4b43c2a6eb2f85e8a828", "filename": "tests/dogfood.rs", "status": "modified", "additions": 3, "deletions": 7, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/0442bb9ce0b1f9851442fcc6f8f9dcb3ef88e3ca/tests%2Fdogfood.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0442bb9ce0b1f9851442fcc6f8f9dcb3ef88e3ca/tests%2Fdogfood.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdogfood.rs?ref=0442bb9ce0b1f9851442fcc6f8f9dcb3ef88e3ca", "patch": "@@ -8,11 +8,6 @@\n // except according to those terms.\n \n #[test]\n-fn dogfood_runner() {\n-    dogfood();\n-    dogfood_tests();\n-}\n-\n fn dogfood() {\n     if option_env!(\"RUSTC_TEST_SUITE\").is_some() || cfg!(windows) {\n         return;\n@@ -23,8 +18,8 @@ fn dogfood() {\n         .join(env!(\"PROFILE\"))\n         .join(\"cargo-clippy\");\n \n-    std::env::set_current_dir(root_dir).unwrap();\n     let output = std::process::Command::new(clippy_cmd)\n+        .current_dir(root_dir)\n         .env(\"CLIPPY_DOGFOOD\", \"1\")\n         .arg(\"clippy\")\n         .arg(\"--all-targets\")\n@@ -42,6 +37,7 @@ fn dogfood() {\n     assert!(output.status.success());\n }\n \n+#[test]\n fn dogfood_tests() {\n     if option_env!(\"RUSTC_TEST_SUITE\").is_some() || cfg!(windows) {\n         return;\n@@ -60,8 +56,8 @@ fn dogfood_tests() {\n         \"clippy_dev\",\n         \"rustc_tools_util\",\n     ] {\n-        std::env::set_current_dir(root_dir.join(d)).unwrap();\n         let output = std::process::Command::new(&clippy_cmd)\n+            .current_dir(root_dir.join(d))\n             .env(\"CLIPPY_DOGFOOD\", \"1\")\n             .arg(\"clippy\")\n             .arg(\"--\")"}]}