{"sha": "04b99bc10390514832197b30c34a3993cd028092", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA0Yjk5YmMxMDM5MDUxNDgzMjE5N2IzMGMzNGEzOTkzY2QwMjgwOTI=", "commit": {"author": {"name": "ljedrz", "email": "ljedrz@gmail.com", "date": "2018-10-02T09:00:41Z"}, "committer": {"name": "ljedrz", "email": "ljedrz@gmail.com", "date": "2018-10-03T07:04:02Z"}, "message": "rustc/ty: improve allocations", "tree": {"sha": "ba27e9dbf745c1f6a9f1a223b0f86094a01a7e59", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ba27e9dbf745c1f6a9f1a223b0f86094a01a7e59"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/04b99bc10390514832197b30c34a3993cd028092", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/04b99bc10390514832197b30c34a3993cd028092", "html_url": "https://github.com/rust-lang/rust/commit/04b99bc10390514832197b30c34a3993cd028092", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/04b99bc10390514832197b30c34a3993cd028092/comments", "author": {"login": "ljedrz", "id": 3750347, "node_id": "MDQ6VXNlcjM3NTAzNDc=", "avatar_url": "https://avatars.githubusercontent.com/u/3750347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ljedrz", "html_url": "https://github.com/ljedrz", "followers_url": "https://api.github.com/users/ljedrz/followers", "following_url": "https://api.github.com/users/ljedrz/following{/other_user}", "gists_url": "https://api.github.com/users/ljedrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/ljedrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ljedrz/subscriptions", "organizations_url": "https://api.github.com/users/ljedrz/orgs", "repos_url": "https://api.github.com/users/ljedrz/repos", "events_url": "https://api.github.com/users/ljedrz/events{/privacy}", "received_events_url": "https://api.github.com/users/ljedrz/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ljedrz", "id": 3750347, "node_id": "MDQ6VXNlcjM3NTAzNDc=", "avatar_url": "https://avatars.githubusercontent.com/u/3750347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ljedrz", "html_url": "https://github.com/ljedrz", "followers_url": "https://api.github.com/users/ljedrz/followers", "following_url": "https://api.github.com/users/ljedrz/following{/other_user}", "gists_url": "https://api.github.com/users/ljedrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/ljedrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ljedrz/subscriptions", "organizations_url": "https://api.github.com/users/ljedrz/orgs", "repos_url": "https://api.github.com/users/ljedrz/repos", "events_url": "https://api.github.com/users/ljedrz/events{/privacy}", "received_events_url": "https://api.github.com/users/ljedrz/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "db171649d3e2298859740d164f92e99c8bd3cf4b", "url": "https://api.github.com/repos/rust-lang/rust/commits/db171649d3e2298859740d164f92e99c8bd3cf4b", "html_url": "https://github.com/rust-lang/rust/commit/db171649d3e2298859740d164f92e99c8bd3cf4b"}], "stats": {"total": 8, "additions": 3, "deletions": 5}, "files": [{"sha": "350af6b93057e4c40e6f30459150e0dbd64e699a", "filename": "src/librustc/ty/outlives.rs", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/04b99bc10390514832197b30c34a3993cd028092/src%2Flibrustc%2Fty%2Foutlives.rs", "raw_url": "https://github.com/rust-lang/rust/raw/04b99bc10390514832197b30c34a3993cd028092/src%2Flibrustc%2Fty%2Foutlives.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Foutlives.rs?ref=04b99bc10390514832197b30c34a3993cd028092", "patch": "@@ -180,9 +180,5 @@ impl<'a, 'gcx, 'tcx> TyCtxt<'a, 'gcx, 'tcx> {\n }\n \n fn push_region_constraints<'tcx>(out: &mut Vec<Component<'tcx>>, regions: Vec<ty::Region<'tcx>>) {\n-    for r in regions {\n-        if !r.is_late_bound() {\n-            out.push(Component::Region(r));\n-        }\n-    }\n+    out.extend(regions.iter().filter(|&r| !r.is_late_bound()).map(|r| Component::Region(r)));\n }"}, {"sha": "c0a42fd5854822a0b49a1d3cb97536f32d136248", "filename": "src/librustc/ty/subst.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/04b99bc10390514832197b30c34a3993cd028092/src%2Flibrustc%2Fty%2Fsubst.rs", "raw_url": "https://github.com/rust-lang/rust/raw/04b99bc10390514832197b30c34a3993cd028092/src%2Flibrustc%2Fty%2Fsubst.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fsubst.rs?ref=04b99bc10390514832197b30c34a3993cd028092", "patch": "@@ -229,6 +229,7 @@ impl<'a, 'gcx, 'tcx> Substs<'tcx> {\n                       mk_kind: &mut F)\n     where F: FnMut(&ty::GenericParamDef, &[Kind<'tcx>]) -> Kind<'tcx>\n     {\n+        substs.reserve(defs.params.len());\n         for param in &defs.params {\n             let kind = mk_kind(param, substs);\n             assert_eq!(param.index as usize, substs.len());"}, {"sha": "e2cc55a693f3d0f9fd5b0c594eda6048c6d11fbe", "filename": "src/librustc/ty/wf.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/04b99bc10390514832197b30c34a3993cd028092/src%2Flibrustc%2Fty%2Fwf.rs", "raw_url": "https://github.com/rust-lang/rust/raw/04b99bc10390514832197b30c34a3993cd028092/src%2Flibrustc%2Fty%2Fwf.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fwf.rs?ref=04b99bc10390514832197b30c34a3993cd028092", "patch": "@@ -493,6 +493,7 @@ impl<'a, 'gcx, 'tcx> WfPredicates<'a, 'gcx, 'tcx> {\n \n             let explicit_bound = region;\n \n+            self.out.reserve(implicit_bounds.len());\n             for implicit_bound in implicit_bounds {\n                 let cause = self.cause(traits::ObjectTypeBound(ty, explicit_bound));\n                 let outlives = ty::Binder::dummy("}]}