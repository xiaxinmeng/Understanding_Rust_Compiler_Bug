{"sha": "7969b78222dc66e21c6a21470365f404992729b1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc5NjliNzgyMjJkYzY2ZTIxYzZhMjE0NzAzNjVmNDA0OTkyNzI5YjE=", "commit": {"author": {"name": "Lamb", "email": "lambtowolf@protonmail.com", "date": "2018-05-29T11:19:58Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2018-06-22T09:38:38Z"}, "message": "Issue #50974: Suboptimal error in case of duplicate `,` in struct constructor", "tree": {"sha": "bfbf0820fb4efd2caa58132f38cd01948eb7de51", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bfbf0820fb4efd2caa58132f38cd01948eb7de51"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7969b78222dc66e21c6a21470365f404992729b1", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v2\n\niQEcBAABCAAGBQJbLMOeAAoJEOjBBC3RYkUZ8lcIAI6KwU1rgp3w10JeSfr3Q2ms\n4DWwOBy6E1GyYO8kALUdg112Vv3sU1DK9ZMMnMonFUimLANx4HemTuHla3AKE7Kp\nMStE4qnXvQGaO/Snk76YK7OX56Y7vvrjRWL3O6OW/90UeJQjK9WiVgFF5c/k7K/e\n1mI7uWMaWxEtUFWUFxSY/OLLZLkfeYwYYXIq/x3sVKg4HcdvI8onZrISD0/QLPth\nQGtnWnJh4Wje0rVGkN5+PKh3/3ZSqE7v5O0YlVbl1yvZN7S3uG1o7v/XhaEaOx7A\nlyCgwn+52sPfF4ZlfNYrK5MmI9tO8nvsaLYr8/7eBMMXanDoGcPk1/6scAMfzjE=\n=DebL\n-----END PGP SIGNATURE-----", "payload": "tree bfbf0820fb4efd2caa58132f38cd01948eb7de51\nparent 7dae5c0e06f10042fc3b29a55bf6285e539c06db\nauthor Lamb <lambtowolf@protonmail.com> 1527592798 +0200\ncommitter Pietro Albini <pietro@pietroalbini.org> 1529660318 +0200\n\nIssue #50974: Suboptimal error in case of duplicate `,` in struct constructor\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7969b78222dc66e21c6a21470365f404992729b1", "html_url": "https://github.com/rust-lang/rust/commit/7969b78222dc66e21c6a21470365f404992729b1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7969b78222dc66e21c6a21470365f404992729b1/comments", "author": {"login": "lambtowolf", "id": 39694331, "node_id": "MDQ6VXNlcjM5Njk0MzMx", "avatar_url": "https://avatars.githubusercontent.com/u/39694331?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lambtowolf", "html_url": "https://github.com/lambtowolf", "followers_url": "https://api.github.com/users/lambtowolf/followers", "following_url": "https://api.github.com/users/lambtowolf/following{/other_user}", "gists_url": "https://api.github.com/users/lambtowolf/gists{/gist_id}", "starred_url": "https://api.github.com/users/lambtowolf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lambtowolf/subscriptions", "organizations_url": "https://api.github.com/users/lambtowolf/orgs", "repos_url": "https://api.github.com/users/lambtowolf/repos", "events_url": "https://api.github.com/users/lambtowolf/events{/privacy}", "received_events_url": "https://api.github.com/users/lambtowolf/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7dae5c0e06f10042fc3b29a55bf6285e539c06db", "url": "https://api.github.com/repos/rust-lang/rust/commits/7dae5c0e06f10042fc3b29a55bf6285e539c06db", "html_url": "https://github.com/rust-lang/rust/commit/7dae5c0e06f10042fc3b29a55bf6285e539c06db"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "3d3867086454e39da155fb6cad242ca182da2152", "filename": "src/libsyntax/parse/parser.rs", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/7969b78222dc66e21c6a21470365f404992729b1/src%2Flibsyntax%2Fparse%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7969b78222dc66e21c6a21470365f404992729b1/src%2Flibsyntax%2Fparse%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Fparser.rs?ref=7969b78222dc66e21c6a21470365f404992729b1", "patch": "@@ -776,6 +776,9 @@ impl<'a> Parser<'a> {\n             err.span_label(self.span, format!(\"expected identifier, found {}\", token_descr));\n         } else {\n             err.span_label(self.span, \"expected identifier\");\n+            if self.token == token::Comma {\n+                err.span_suggestion(self.span, \"try removing a comma\", \",\".into());\n+            }\n         }\n         err\n     }\n@@ -2446,8 +2449,11 @@ impl<'a> Parser<'a> {\n                 Err(mut e) => {\n                     e.span_label(struct_sp, \"while parsing this struct\");\n                     e.emit();\n-                    self.recover_stmt();\n-                    break;\n+\n+                    if self.token != token::Comma {\n+                        self.recover_stmt();\n+                        break;\n+                    }\n                 }\n             }\n "}]}