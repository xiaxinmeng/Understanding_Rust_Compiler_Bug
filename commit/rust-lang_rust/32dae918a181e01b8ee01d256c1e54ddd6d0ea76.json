{"sha": "32dae918a181e01b8ee01d256c1e54ddd6d0ea76", "node_id": "C_kwDOAAsO6NoAKDMyZGFlOTE4YTE4MWUwMWI4ZWUwMWQyNTZjMWU1NGRkZDZkMGVhNzY", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-11-01T01:36:50Z"}, "committer": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-11-01T02:27:24Z"}, "message": "Remap RPITIT substs properly", "tree": {"sha": "a780e943d8c09cb882f3e1f3e781a5e451878c72", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a780e943d8c09cb882f3e1f3e781a5e451878c72"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/32dae918a181e01b8ee01d256c1e54ddd6d0ea76", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/32dae918a181e01b8ee01d256c1e54ddd6d0ea76", "html_url": "https://github.com/rust-lang/rust/commit/32dae918a181e01b8ee01d256c1e54ddd6d0ea76", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/32dae918a181e01b8ee01d256c1e54ddd6d0ea76/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a2037e3012ed6c59e91fadb693b35fd503cba117", "url": "https://api.github.com/repos/rust-lang/rust/commits/a2037e3012ed6c59e91fadb693b35fd503cba117", "html_url": "https://github.com/rust-lang/rust/commit/a2037e3012ed6c59e91fadb693b35fd503cba117"}], "stats": {"total": 31, "additions": 31, "deletions": 0}, "files": [{"sha": "474ae22e3d589009616d425cd5cbd082123af9e1", "filename": "compiler/rustc_trait_selection/src/traits/project.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/32dae918a181e01b8ee01d256c1e54ddd6d0ea76/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fproject.rs", "raw_url": "https://github.com/rust-lang/rust/raw/32dae918a181e01b8ee01d256c1e54ddd6d0ea76/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fproject.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fproject.rs?ref=32dae918a181e01b8ee01d256c1e54ddd6d0ea76", "patch": "@@ -2260,6 +2260,13 @@ fn confirm_impl_trait_in_trait_candidate<'tcx>(\n     // since `data.substs` are the impl substs.\n     let impl_fn_substs =\n         obligation.predicate.substs.rebase_onto(tcx, tcx.parent(trait_fn_def_id), data.substs);\n+    let impl_fn_substs = translate_substs(\n+        selcx.infcx(),\n+        obligation.param_env,\n+        data.impl_def_id,\n+        impl_fn_substs,\n+        leaf_def.defining_node,\n+    );\n \n     if !check_substs_compatible(tcx, &leaf_def.item, impl_fn_substs) {\n         let err = tcx.ty_error_with_message("}, {"sha": "c9ee877db8ec52c4c7ecef269e4069d3b785d6c0", "filename": "src/test/ui/impl-trait/in-trait/specialization-substs-remap.rs", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/32dae918a181e01b8ee01d256c1e54ddd6d0ea76/src%2Ftest%2Fui%2Fimpl-trait%2Fin-trait%2Fspecialization-substs-remap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/32dae918a181e01b8ee01d256c1e54ddd6d0ea76/src%2Ftest%2Fui%2Fimpl-trait%2Fin-trait%2Fspecialization-substs-remap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fin-trait%2Fspecialization-substs-remap.rs?ref=32dae918a181e01b8ee01d256c1e54ddd6d0ea76", "patch": "@@ -0,0 +1,24 @@\n+// check-pass\n+\n+#![feature(specialization)]\n+#![feature(return_position_impl_trait_in_trait)]\n+#![allow(incomplete_features)]\n+\n+trait Foo {\n+    fn bar(&self) -> impl Sized;\n+}\n+\n+impl<U> Foo for U\n+where\n+    U: Copy,\n+{\n+    fn bar(&self) -> U {\n+        *self\n+    }\n+}\n+\n+impl Foo for i32 {}\n+\n+fn main() {\n+    let _: i32 = 1i32.bar();\n+}"}]}