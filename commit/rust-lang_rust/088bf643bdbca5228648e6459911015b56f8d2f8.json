{"sha": "088bf643bdbca5228648e6459911015b56f8d2f8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA4OGJmNjQzYmRiY2E1MjI4NjQ4ZTY0NTk5MTEwMTViNTZmOGQyZjg=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-03-14T08:29:51Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-03-14T16:15:51Z"}, "message": "Rollup merge of #48981 - alexcrichton:lld-no-at-file, r=michaelwoerister\n\nrustc: Don't invoke `lld` with an `@`-file\n\nLooks like LLD doesn't support this yet, so always try to use the OS before we\nfall back to using `@`\n\ncc https://github.com/rust-lang/rust/issues/48948", "tree": {"sha": "8af961f9d062e98efc5c77e85008517795185bad", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8af961f9d062e98efc5c77e85008517795185bad"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/088bf643bdbca5228648e6459911015b56f8d2f8", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlqpSrcACgkQ/vbIBR0O\nATxOJA//SmbHtnsBAXMce6PS3O576sZgoaAqy/1cgazRei45jZBJtyF3F38eQrVY\n9wd6djOZc1NXOl84P4vGxxw/DFIDn3nQkmE0KC89xPkPIYwTdPuBX3MblGOgrPP8\noHleZgTs0DpD1teHa3bdj3eQ3dvMckS7M0DqSJakGhFvy+LxLu7q+2R+kUbVa1a2\ng1YEBofkUCpiogsaEcETl4BPJYLeBYiBjfqIQFT3SIJQz09Q1zNokslCccphEbdi\nPEqIHGkv7lCJW96kxaTvgbTeUgDxx3vQ7FqGlM+QsmYEX0PppVAfx2sCtB85vcov\nrm+L8U2M3klct2voXJbyMsWXBaaT/HtvagvU+hOD2ZZn0KGJH4J3EYfZ2bG0t0wE\nSvI2oKB76Mr/e1a6noveJTTVMliyBEPZS0w3mqNr+0jn1N1K1jvQHxOItN+8k0Rh\njLIQmUcdQ50prVaFxg119ZTBviOiBthS+d/zZ4DO7AJ+EhiZxVMPOkGXi0PBpsUQ\n6jBONaqqMM/vtMG6p0J/NB+22CI4YLe0v3UnQZZ+8b2k+acUF+69KS+GbTmZQslO\n93PS0TVhcamFPE9jIJghF4gL3+rYHhXMKKJ4M9Uym2AdFAXxa3TxfF1e6X5RP280\n8F6t8jHWdDDFqqkLeZmo1q+Pys/XDjKVbFHRNebyKlgKdSpDY9w=\n=Yvwy\n-----END PGP SIGNATURE-----", "payload": "tree 8af961f9d062e98efc5c77e85008517795185bad\nparent ff80cde998fd1068757ef788b1be51e7df4a7192\nparent 04442af18bf01622288a33faa58caf7e666cac40\nauthor kennytm <kennytm@gmail.com> 1521016191 +0800\ncommitter kennytm <kennytm@gmail.com> 1521044151 +0800\n\nRollup merge of #48981 - alexcrichton:lld-no-at-file, r=michaelwoerister\n\nrustc: Don't invoke `lld` with an `@`-file\n\nLooks like LLD doesn't support this yet, so always try to use the OS before we\nfall back to using `@`\n\ncc https://github.com/rust-lang/rust/issues/48948\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/088bf643bdbca5228648e6459911015b56f8d2f8", "html_url": "https://github.com/rust-lang/rust/commit/088bf643bdbca5228648e6459911015b56f8d2f8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/088bf643bdbca5228648e6459911015b56f8d2f8/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ff80cde998fd1068757ef788b1be51e7df4a7192", "url": "https://api.github.com/repos/rust-lang/rust/commits/ff80cde998fd1068757ef788b1be51e7df4a7192", "html_url": "https://github.com/rust-lang/rust/commit/ff80cde998fd1068757ef788b1be51e7df4a7192"}, {"sha": "04442af18bf01622288a33faa58caf7e666cac40", "url": "https://api.github.com/repos/rust-lang/rust/commits/04442af18bf01622288a33faa58caf7e666cac40", "html_url": "https://github.com/rust-lang/rust/commit/04442af18bf01622288a33faa58caf7e666cac40"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "a5649e98baa76c6f03f0cd8f3d296cbfff37d97d", "filename": "src/librustc_trans/back/command.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/088bf643bdbca5228648e6459911015b56f8d2f8/src%2Flibrustc_trans%2Fback%2Fcommand.rs", "raw_url": "https://github.com/rust-lang/rust/raw/088bf643bdbca5228648e6459911015b56f8d2f8/src%2Flibrustc_trans%2Fback%2Fcommand.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fback%2Fcommand.rs?ref=088bf643bdbca5228648e6459911015b56f8d2f8", "patch": "@@ -132,6 +132,13 @@ impl Command {\n             return false\n         }\n \n+        // Right now LLD doesn't support the `@` syntax of passing an argument\n+        // through files, so regardless of the platform we try to go to the OS\n+        // on this one.\n+        if let Program::Lld(..) = self.program {\n+            return false\n+        }\n+\n         // Ok so on Windows to spawn a process is 32,768 characters in its\n         // command line [1]. Unfortunately we don't actually have access to that\n         // as it's calculated just before spawning. Instead we perform a"}, {"sha": "bdda7741221f5e288567361807010c1f01b720a6", "filename": "src/librustc_trans/back/link.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/088bf643bdbca5228648e6459911015b56f8d2f8/src%2Flibrustc_trans%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/088bf643bdbca5228648e6459911015b56f8d2f8/src%2Flibrustc_trans%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fback%2Flink.rs?ref=088bf643bdbca5228648e6459911015b56f8d2f8", "patch": "@@ -827,11 +827,14 @@ fn exec_linker(sess: &Session, cmd: &mut Command, tmpdir: &Path)\n     if !cmd.very_likely_to_exceed_some_spawn_limit() {\n         match cmd.command().stdout(Stdio::piped()).stderr(Stdio::piped()).spawn() {\n             Ok(child) => return child.wait_with_output(),\n-            Err(ref e) if command_line_too_big(e) => {}\n+            Err(ref e) if command_line_too_big(e) => {\n+                info!(\"command line to linker was too big: {}\", e);\n+            }\n             Err(e) => return Err(e)\n         }\n     }\n \n+    info!(\"falling back to passing arguments to linker via an @-file\");\n     let mut cmd2 = cmd.clone();\n     let mut args = String::new();\n     for arg in cmd2.take_args() {\n@@ -856,6 +859,7 @@ fn exec_linker(sess: &Session, cmd: &mut Command, tmpdir: &Path)\n     };\n     fs::write(&file, &bytes)?;\n     cmd2.arg(format!(\"@{}\", file.display()));\n+    info!(\"invoking linker {:?}\", cmd2);\n     return cmd2.output();\n \n     #[cfg(unix)]"}]}