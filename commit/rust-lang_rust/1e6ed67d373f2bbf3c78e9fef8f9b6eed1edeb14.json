{"sha": "1e6ed67d373f2bbf3c78e9fef8f9b6eed1edeb14", "node_id": "C_kwDOAAsO6NoAKDFlNmVkNjdkMzczZjJiYmYzYzc4ZTlmZWY4ZjliNmVlZDFlZGViMTQ", "commit": {"author": {"name": "Santiago Pastorino", "email": "spastorino@gmail.com", "date": "2022-05-20T20:32:48Z"}, "committer": {"name": "Santiago Pastorino", "email": "spastorino@gmail.com", "date": "2022-06-07T21:29:07Z"}, "message": "Extract lower_generic_param_kind", "tree": {"sha": "d559c912f34ba5749c8d47a15e49da157d155afb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d559c912f34ba5749c8d47a15e49da157d155afb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1e6ed67d373f2bbf3c78e9fef8f9b6eed1edeb14", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEF0ntrgrd9qf9uuThgTGiTgx5768FAmKfwyMACgkQgTGiTgx5\n768rUQ/+MbPh+nBZRPkF1vxOhxoKwh3MwMhEMfgRzeebkfodCi0bEDcrqHSYh+M3\nxb+qbV1uKEIHQwEEC+mziWfRKxBmFdz9sc/M8ZwdELbjSab6sB03/FXUuV6hhwId\n47PjN2aWLiqxlGyjOublBNf0AfR3Hrv9UVg/Pzwm9UKDB/B+4TRNiB4tUCGttPyx\n0oBKcNN1hrvTl/1qh080fKcFUNBQeCqu4ZZ5PuOXRelmjn3jCYp9yUhlHtxJqh5p\nsvwP/oMMlZVXVM8qkD/rWGB0CvAN4POz9KmnA2EkKksJh1XkwUNbgoblQehWS6yL\nr1GYeEWXNga65xn3Gi+BYZFjgAul1F6ADtFEPnNkYzc84ualwhzFblGMPu0+XdHa\nknv03+w2TArfBwso4Qa/CaZptr9AIYInPp/S0fDytUu5nsZPSikCvDnuCJ3pW6+U\nLNT7fsV4nuRR3CELmxBJAVoiUuWZWW2frNBWwIr3s9sL7BlxjVmaAmP6FTs+9Opw\nMKo0le8NnUfWQZIHTFdX5nloqxsExu8mvpg1TxNw3m2gchqI3Ii3WNNeb8Ds/ktO\n5YcvHZ9wn2m/CgzWdZ02y920kpOoG7QC1i3Lq7oQYQbKsfJpr13jGcN0s+9ilurb\nAX0RyrSliyV1ibc1kztEJzDShlpOq0QXCLibMUdF4KXAPKHDzb4=\n=OYPO\n-----END PGP SIGNATURE-----", "payload": "tree d559c912f34ba5749c8d47a15e49da157d155afb\nparent a22aad32eb5999fbf77ad3ca1797db7bd1eaaf2d\nauthor Santiago Pastorino <spastorino@gmail.com> 1653078768 -0300\ncommitter Santiago Pastorino <spastorino@gmail.com> 1654637347 -0300\n\nExtract lower_generic_param_kind\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1e6ed67d373f2bbf3c78e9fef8f9b6eed1edeb14", "html_url": "https://github.com/rust-lang/rust/commit/1e6ed67d373f2bbf3c78e9fef8f9b6eed1edeb14", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1e6ed67d373f2bbf3c78e9fef8f9b6eed1edeb14/comments", "author": {"login": "spastorino", "id": 52642, "node_id": "MDQ6VXNlcjUyNjQy", "avatar_url": "https://avatars.githubusercontent.com/u/52642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spastorino", "html_url": "https://github.com/spastorino", "followers_url": "https://api.github.com/users/spastorino/followers", "following_url": "https://api.github.com/users/spastorino/following{/other_user}", "gists_url": "https://api.github.com/users/spastorino/gists{/gist_id}", "starred_url": "https://api.github.com/users/spastorino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spastorino/subscriptions", "organizations_url": "https://api.github.com/users/spastorino/orgs", "repos_url": "https://api.github.com/users/spastorino/repos", "events_url": "https://api.github.com/users/spastorino/events{/privacy}", "received_events_url": "https://api.github.com/users/spastorino/received_events", "type": "User", "site_admin": false}, "committer": {"login": "spastorino", "id": 52642, "node_id": "MDQ6VXNlcjUyNjQy", "avatar_url": "https://avatars.githubusercontent.com/u/52642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spastorino", "html_url": "https://github.com/spastorino", "followers_url": "https://api.github.com/users/spastorino/followers", "following_url": "https://api.github.com/users/spastorino/following{/other_user}", "gists_url": "https://api.github.com/users/spastorino/gists{/gist_id}", "starred_url": "https://api.github.com/users/spastorino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spastorino/subscriptions", "organizations_url": "https://api.github.com/users/spastorino/orgs", "repos_url": "https://api.github.com/users/spastorino/repos", "events_url": "https://api.github.com/users/spastorino/events{/privacy}", "received_events_url": "https://api.github.com/users/spastorino/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a22aad32eb5999fbf77ad3ca1797db7bd1eaaf2d", "url": "https://api.github.com/repos/rust-lang/rust/commits/a22aad32eb5999fbf77ad3ca1797db7bd1eaaf2d", "html_url": "https://github.com/rust-lang/rust/commit/a22aad32eb5999fbf77ad3ca1797db7bd1eaaf2d"}], "stats": {"total": 31, "additions": 19, "deletions": 12}, "files": [{"sha": "387eca51b57c8f8344c14122b3635bd70eccb8c2", "filename": "compiler/rustc_ast_lowering/src/lib.rs", "status": "modified", "additions": 19, "deletions": 12, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/1e6ed67d373f2bbf3c78e9fef8f9b6eed1edeb14/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1e6ed67d373f2bbf3c78e9fef8f9b6eed1edeb14/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs?ref=1e6ed67d373f2bbf3c78e9fef8f9b6eed1edeb14", "patch": "@@ -1874,7 +1874,25 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n \n     #[instrument(level = \"trace\", skip(self))]\n     fn lower_generic_param(&mut self, param: &GenericParam) -> hir::GenericParam<'hir> {\n-        let (name, kind) = match param.kind {\n+        let (name, kind) = self.lower_generic_param_kind(param);\n+\n+        let hir_id = self.lower_node_id(param.id);\n+        self.lower_attrs(hir_id, &param.attrs);\n+        hir::GenericParam {\n+            hir_id,\n+            name,\n+            span: self.lower_span(param.span()),\n+            pure_wrt_drop: self.sess.contains_name(&param.attrs, sym::may_dangle),\n+            kind,\n+            colon_span: param.colon_span.map(|s| self.lower_span(s)),\n+        }\n+    }\n+\n+    fn lower_generic_param_kind(\n+        &mut self,\n+        param: &GenericParam,\n+    ) -> (hir::ParamName, hir::GenericParamKind<'hir>) {\n+        match param.kind {\n             GenericParamKind::Lifetime => {\n                 // AST resolution emitted an error on those parameters, so we lower them using\n                 // `ParamName::Error`.\n@@ -1908,17 +1926,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                     hir::GenericParamKind::Const { ty, default },\n                 )\n             }\n-        };\n-\n-        let hir_id = self.lower_node_id(param.id);\n-        self.lower_attrs(hir_id, &param.attrs);\n-        hir::GenericParam {\n-            hir_id,\n-            name,\n-            span: self.lower_span(param.span()),\n-            pure_wrt_drop: self.sess.contains_name(&param.attrs, sym::may_dangle),\n-            kind,\n-            colon_span: param.colon_span.map(|s| self.lower_span(s)),\n         }\n     }\n "}]}