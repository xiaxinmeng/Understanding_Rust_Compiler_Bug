{"sha": "03ca0e270613592f35ce654e2ef1e68cdfb154e3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAzY2EwZTI3MDYxMzU5MmYzNWNlNjU0ZTJlZjFlNjhjZGZiMTU0ZTM=", "commit": {"author": {"name": "John Ericson", "email": "John.Ericson@Obsidian.Systems", "date": "2020-02-22T19:38:38Z"}, "committer": {"name": "John Ericson", "email": "John.Ericson@Obsidian.Systems", "date": "2020-02-22T20:23:15Z"}, "message": "Allow getting `no_std` from the config file\n\nCurrently, it is only set correctly in the sanity checking implicit\ndefault fallback code. Having a config file at all will for force\n`no_std = false`.", "tree": {"sha": "ca62cb5fd03b6eb684221d6ec6866cf9beca657b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ca62cb5fd03b6eb684221d6ec6866cf9beca657b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/03ca0e270613592f35ce654e2ef1e68cdfb154e3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/03ca0e270613592f35ce654e2ef1e68cdfb154e3", "html_url": "https://github.com/rust-lang/rust/commit/03ca0e270613592f35ce654e2ef1e68cdfb154e3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/03ca0e270613592f35ce654e2ef1e68cdfb154e3/comments", "author": {"login": "Ericson2314", "id": 1055245, "node_id": "MDQ6VXNlcjEwNTUyNDU=", "avatar_url": "https://avatars.githubusercontent.com/u/1055245?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ericson2314", "html_url": "https://github.com/Ericson2314", "followers_url": "https://api.github.com/users/Ericson2314/followers", "following_url": "https://api.github.com/users/Ericson2314/following{/other_user}", "gists_url": "https://api.github.com/users/Ericson2314/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ericson2314/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ericson2314/subscriptions", "organizations_url": "https://api.github.com/users/Ericson2314/orgs", "repos_url": "https://api.github.com/users/Ericson2314/repos", "events_url": "https://api.github.com/users/Ericson2314/events{/privacy}", "received_events_url": "https://api.github.com/users/Ericson2314/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Ericson2314", "id": 1055245, "node_id": "MDQ6VXNlcjEwNTUyNDU=", "avatar_url": "https://avatars.githubusercontent.com/u/1055245?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ericson2314", "html_url": "https://github.com/Ericson2314", "followers_url": "https://api.github.com/users/Ericson2314/followers", "following_url": "https://api.github.com/users/Ericson2314/following{/other_user}", "gists_url": "https://api.github.com/users/Ericson2314/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ericson2314/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ericson2314/subscriptions", "organizations_url": "https://api.github.com/users/Ericson2314/orgs", "repos_url": "https://api.github.com/users/Ericson2314/repos", "events_url": "https://api.github.com/users/Ericson2314/events{/privacy}", "received_events_url": "https://api.github.com/users/Ericson2314/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3eeefc21f1a3ed9755c072c83808ed5c087b8c9a", "url": "https://api.github.com/repos/rust-lang/rust/commits/3eeefc21f1a3ed9755c072c83808ed5c087b8c9a", "html_url": "https://github.com/rust-lang/rust/commit/3eeefc21f1a3ed9755c072c83808ed5c087b8c9a"}], "stats": {"total": 7, "additions": 4, "deletions": 3}, "files": [{"sha": "b474d896bd212f4d2ccf0258d857caab1728432c", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/03ca0e270613592f35ce654e2ef1e68cdfb154e3/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/03ca0e270613592f35ce654e2ef1e68cdfb154e3/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=03ca0e270613592f35ce654e2ef1e68cdfb154e3", "patch": "@@ -353,6 +353,7 @@ struct TomlTarget {\n     musl_root: Option<String>,\n     wasi_root: Option<String>,\n     qemu_rootfs: Option<String>,\n+    no_std: Option<bool>,\n }\n \n impl Config {\n@@ -615,6 +616,8 @@ impl Config {\n                 target.musl_root = cfg.musl_root.clone().map(PathBuf::from);\n                 target.wasi_root = cfg.wasi_root.clone().map(PathBuf::from);\n                 target.qemu_rootfs = cfg.qemu_rootfs.clone().map(PathBuf::from);\n+                target.no_std =\n+                    cfg.no_std.unwrap_or(triple.contains(\"-none-\") || triple.contains(\"nvptx\"));\n \n                 config.target_config.insert(INTERNER.intern_string(triple.clone()), target);\n             }"}, {"sha": "76e721ed8e3ed67c7738e1e5f6d3281a1e92ca8c", "filename": "src/bootstrap/sanity.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/03ca0e270613592f35ce654e2ef1e68cdfb154e3/src%2Fbootstrap%2Fsanity.rs", "raw_url": "https://github.com/rust-lang/rust/raw/03ca0e270613592f35ce654e2ef1e68cdfb154e3/src%2Fbootstrap%2Fsanity.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fsanity.rs?ref=03ca0e270613592f35ce654e2ef1e68cdfb154e3", "patch": "@@ -194,9 +194,7 @@ pub fn check(build: &mut Build) {\n \n         if target.contains(\"-none-\") || target.contains(\"nvptx\") {\n             if build.no_std(*target).is_none() {\n-                let target = build.config.target_config.entry(target.clone()).or_default();\n-\n-                target.no_std = true;\n+                build.config.target_config.entry(target.clone()).or_default();\n             }\n \n             if build.no_std(*target) == Some(false) {"}]}