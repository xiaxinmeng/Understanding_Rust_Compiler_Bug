{"sha": "9bdd2db3a60176012f4dc240eea02d615cc60061", "node_id": "MDY6Q29tbWl0NzI0NzEyOjliZGQyZGIzYTYwMTc2MDEyZjRkYzI0MGVlYTAyZDYxNWNjNjAwNjE=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-06-27T20:14:34Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-06-27T20:14:34Z"}, "message": "Auto merge of #73671 - ehuss:update-mdbook, r=Mark-Simulacrum\n\nUpdate mdbook\n\nThis updates mdbook to 0.4.  The list of changes can be found at https://github.com/rust-lang/mdBook/blob/master/CHANGELOG.md#mdbook-040.  I think the most important one is the change to include fonts with the book instead of using the Google Fonts CDN. This adds a few megabytes of fonts to the docs component.  It may be possible to share the fonts across the books, but would take a fair bit of work to make that happen, so I'm not sure if it is necessary.\n\nThis also removes mdbook-linkcheck. It is currently not being used, and I don't foresee it going back into use anytime soon. I would prefer not to maintain something that isn't being used, and it removes a very large number of dependencies.", "tree": {"sha": "b2eadafef441ddb5e9771d31ea3d18715251d0e7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b2eadafef441ddb5e9771d31ea3d18715251d0e7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9bdd2db3a60176012f4dc240eea02d615cc60061", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9bdd2db3a60176012f4dc240eea02d615cc60061", "html_url": "https://github.com/rust-lang/rust/commit/9bdd2db3a60176012f4dc240eea02d615cc60061", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9bdd2db3a60176012f4dc240eea02d615cc60061/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "394e1b40d264aa6928811919c1124fa248e7d802", "url": "https://api.github.com/repos/rust-lang/rust/commits/394e1b40d264aa6928811919c1124fa248e7d802", "html_url": "https://github.com/rust-lang/rust/commit/394e1b40d264aa6928811919c1124fa248e7d802"}, {"sha": "6bcbc426c9abd97ad5379215545349e71592f90b", "url": "https://api.github.com/repos/rust-lang/rust/commits/6bcbc426c9abd97ad5379215545349e71592f90b", "html_url": "https://github.com/rust-lang/rust/commit/6bcbc426c9abd97ad5379215545349e71592f90b"}], "stats": {"total": 671, "additions": 24, "deletions": 647}, "files": [{"sha": "e9fb097df92d2d6243fcc13be8dd2da794f974d0", "filename": "Cargo.lock", "status": "modified", "additions": 12, "deletions": 514, "changes": 526, "blob_url": "https://github.com/rust-lang/rust/blob/9bdd2db3a60176012f4dc240eea02d615cc60061/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/9bdd2db3a60176012f4dc240eea02d615cc60061/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=9bdd2db3a60176012f4dc240eea02d615cc60061", "patch": "@@ -65,9 +65,9 @@ dependencies = [\n \n [[package]]\n name = \"anyhow\"\n-version = \"1.0.26\"\n+version = \"1.0.31\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"7825f6833612eb2414095684fcf6c635becf3ce97fe48cf6421321e93bfbd53c\"\n+checksum = \"85bb70cc08ec97ca5450e6eba421deeea5f172c0fc61f78b5357b2a8e8be195f\"\n \n [[package]]\n name = \"arc-swap\"\n@@ -143,15 +143,6 @@ dependencies = [\n  \"rustc-std-workspace-core\",\n ]\n \n-[[package]]\n-name = \"base64\"\n-version = \"0.10.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"0b25d992356d2eb0ed82172f5248873db5560c4721f564b13cb5193bda5e668e\"\n-dependencies = [\n- \"byteorder\",\n-]\n-\n [[package]]\n name = \"bitflags\"\n version = \"1.2.1\"\n@@ -270,7 +261,6 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"40ade3d27603c2cb345eb0912aec461a6dec7e06a4ae48589904e808335c7afa\"\n dependencies = [\n  \"byteorder\",\n- \"either\",\n  \"iovec\",\n ]\n \n@@ -291,7 +281,7 @@ dependencies = [\n  \"cargo-test-macro\",\n  \"cargo-test-support\",\n  \"clap\",\n- \"core-foundation 0.7.0\",\n+ \"core-foundation\",\n  \"crates-io\",\n  \"crossbeam-utils 0.7.2\",\n  \"crypto-hash\",\n@@ -539,7 +529,7 @@ dependencies = [\n  \"if_chain\",\n  \"itertools 0.9.0\",\n  \"lazy_static\",\n- \"pulldown-cmark 0.7.1\",\n+ \"pulldown-cmark\",\n  \"quine-mc_cluskey\",\n  \"quote 1.0.2\",\n  \"regex-syntax\",\n@@ -570,26 +560,6 @@ dependencies = [\n  \"cc\",\n ]\n \n-[[package]]\n-name = \"codespan\"\n-version = \"0.5.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"de67bdcd653002a6dba3eb53850ce3a485547225d81cb6c2bbdbc5a0cba5d15d\"\n-dependencies = [\n- \"unicode-segmentation\",\n-]\n-\n-[[package]]\n-name = \"codespan-reporting\"\n-version = \"0.5.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"efd1d915d9e2b2ad696b2cd73215a84823ef3f0e3084d90304204415921b62c6\"\n-dependencies = [\n- \"codespan\",\n- \"termcolor\",\n- \"unicode-width\",\n-]\n-\n [[package]]\n name = \"colored\"\n version = \"1.9.3\"\n@@ -676,67 +646,23 @@ version = \"0.1.3\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"8ff012e225ce166d4422e0e78419d901719760f62ae2b7969ca6b564d1b54a9e\"\n \n-[[package]]\n-name = \"cookie\"\n-version = \"0.12.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"888604f00b3db336d2af898ec3c1d5d0ddf5e6d462220f2ededc33a87ac4bbd5\"\n-dependencies = [\n- \"time\",\n- \"url 1.7.2\",\n-]\n-\n-[[package]]\n-name = \"cookie_store\"\n-version = \"0.7.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"46750b3f362965f197996c4448e4a0935e791bf7d6631bfce9ee0af3d24c919c\"\n-dependencies = [\n- \"cookie\",\n- \"failure\",\n- \"idna 0.1.5\",\n- \"log\",\n- \"publicsuffix\",\n- \"serde\",\n- \"serde_json\",\n- \"time\",\n- \"try_from\",\n- \"url 1.7.2\",\n-]\n-\n [[package]]\n name = \"core\"\n version = \"0.0.0\"\n dependencies = [\n  \"rand 0.7.3\",\n ]\n \n-[[package]]\n-name = \"core-foundation\"\n-version = \"0.6.3\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"4e2640d6d0bf22e82bed1b73c6aef8d5dd31e5abe6666c57e6d45e2649f4f887\"\n-dependencies = [\n- \"core-foundation-sys 0.6.2\",\n- \"libc\",\n-]\n-\n [[package]]\n name = \"core-foundation\"\n version = \"0.7.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"57d24c7a13c43e870e37c1556b74555437870a04514f7685f5b354e090567171\"\n dependencies = [\n- \"core-foundation-sys 0.7.0\",\n+ \"core-foundation-sys\",\n  \"libc\",\n ]\n \n-[[package]]\n-name = \"core-foundation-sys\"\n-version = \"0.6.2\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"e7ca8a5221364ef15ce201e8ed2f609fc312682a8f4e0e3d4aa5879764e0fa3b\"\n-\n [[package]]\n name = \"core-foundation-sys\"\n version = \"0.7.0\"\n@@ -881,40 +807,6 @@ dependencies = [\n  \"winapi 0.3.8\",\n ]\n \n-[[package]]\n-name = \"darling\"\n-version = \"0.8.6\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"9158d690bc62a3a57c3e45b85e4d50de2008b39345592c64efd79345c7e24be0\"\n-dependencies = [\n- \"darling_core\",\n- \"darling_macro\",\n-]\n-\n-[[package]]\n-name = \"darling_core\"\n-version = \"0.8.6\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"d2a368589465391e127e10c9e3a08efc8df66fd49b87dc8524c764bbe7f2ef82\"\n-dependencies = [\n- \"fnv\",\n- \"ident_case\",\n- \"proc-macro2 0.4.30\",\n- \"quote 0.6.12\",\n- \"syn 0.15.35\",\n-]\n-\n-[[package]]\n-name = \"darling_macro\"\n-version = \"0.8.6\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"244e8987bd4e174385240cde20a3657f607fb0797563c28255c353b5819a07b1\"\n-dependencies = [\n- \"darling_core\",\n- \"quote 0.6.12\",\n- \"syn 0.15.35\",\n-]\n-\n [[package]]\n name = \"datafrog\"\n version = \"2.0.1\"\n@@ -1007,18 +899,6 @@ dependencies = [\n  \"rustc-std-workspace-core\",\n ]\n \n-[[package]]\n-name = \"dtoa\"\n-version = \"0.4.4\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"ea57b42383d091c85abcc2706240b94ab2a8fa1fc81c10ff23c4de06e2a90b5e\"\n-\n-[[package]]\n-name = \"dunce\"\n-version = \"1.0.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"d0ad6bf6a88548d1126045c413548df1453d9be094a8ab9fd59bf1fdd338da4f\"\n-\n [[package]]\n name = \"either\"\n version = \"1.5.0\"\n@@ -1049,15 +929,6 @@ dependencies = [\n  \"log\",\n ]\n \n-[[package]]\n-name = \"encoding_rs\"\n-version = \"0.8.17\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"4155785c79f2f6701f185eb2e6b4caf0555ec03477cb4c70db67b465311620ed\"\n-dependencies = [\n- \"cfg-if\",\n-]\n-\n [[package]]\n name = \"env_logger\"\n version = \"0.6.2\"\n@@ -1084,15 +955,6 @@ dependencies = [\n  \"termcolor\",\n ]\n \n-[[package]]\n-name = \"error-chain\"\n-version = \"0.12.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"07e791d3be96241c77c43846b665ef1384606da2cd2a48730abe606a12906e02\"\n-dependencies = [\n- \"backtrace\",\n-]\n-\n [[package]]\n name = \"error_index_generator\"\n version = \"0.0.0\"\n@@ -1252,16 +1114,6 @@ version = \"0.1.28\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"45dc39533a6cae6da2b56da48edae506bb767ec07370f86f70fc062e9d435869\"\n \n-[[package]]\n-name = \"futures-cpupool\"\n-version = \"0.1.8\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"ab90cde24b3319636588d0c35fe03b1333857621051837ed769faefb4c2162e4\"\n-dependencies = [\n- \"futures\",\n- \"num_cpus\",\n-]\n-\n [[package]]\n name = \"fwdansi\"\n version = \"1.0.1\"\n@@ -1349,24 +1201,6 @@ dependencies = [\n  \"regex\",\n ]\n \n-[[package]]\n-name = \"h2\"\n-version = \"0.1.25\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"a539b63339fbbb00e081e84b6e11bd1d9634a82d91da2984a18ac74a8823f392\"\n-dependencies = [\n- \"byteorder\",\n- \"bytes\",\n- \"fnv\",\n- \"futures\",\n- \"http\",\n- \"indexmap\",\n- \"log\",\n- \"slab\",\n- \"string\",\n- \"tokio-io\",\n-]\n-\n [[package]]\n name = \"handlebars\"\n version = \"3.0.1\"\n@@ -1449,35 +1283,6 @@ dependencies = [\n  \"syn 1.0.11\",\n ]\n \n-[[package]]\n-name = \"http\"\n-version = \"0.1.19\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"d7e06e336150b178206af098a055e3621e8336027e2b4d126bda0bc64824baaf\"\n-dependencies = [\n- \"bytes\",\n- \"fnv\",\n- \"itoa\",\n-]\n-\n-[[package]]\n-name = \"http-body\"\n-version = \"0.1.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"6741c859c1b2463a423a1dbce98d418e6c3c3fc720fb0d45528657320920292d\"\n-dependencies = [\n- \"bytes\",\n- \"futures\",\n- \"http\",\n- \"tokio-buf\",\n-]\n-\n-[[package]]\n-name = \"httparse\"\n-version = \"1.3.4\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"cd179ae861f0c2e53da70d892f5f3029f9594be0c41dc5269cd371691b1dc2f9\"\n-\n [[package]]\n name = \"humantime\"\n version = \"1.3.0\"\n@@ -1493,55 +1298,6 @@ version = \"2.0.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"b9b6c53306532d3c8e8087b44e6580e10db51a023cf9b433cea2ac38066b92da\"\n \n-[[package]]\n-name = \"hyper\"\n-version = \"0.12.31\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"6481fff8269772d4463253ca83c788104a7305cb3fb9136bc651a6211e46e03f\"\n-dependencies = [\n- \"bytes\",\n- \"futures\",\n- \"futures-cpupool\",\n- \"h2\",\n- \"http\",\n- \"http-body\",\n- \"httparse\",\n- \"iovec\",\n- \"itoa\",\n- \"log\",\n- \"net2\",\n- \"rustc_version\",\n- \"time\",\n- \"tokio\",\n- \"tokio-buf\",\n- \"tokio-executor\",\n- \"tokio-io\",\n- \"tokio-reactor\",\n- \"tokio-tcp\",\n- \"tokio-threadpool\",\n- \"tokio-timer\",\n- \"want\",\n-]\n-\n-[[package]]\n-name = \"hyper-tls\"\n-version = \"0.3.2\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"3a800d6aa50af4b5850b2b0f659625ce9504df908e9733b635720483be26174f\"\n-dependencies = [\n- \"bytes\",\n- \"futures\",\n- \"hyper\",\n- \"native-tls\",\n- \"tokio-io\",\n-]\n-\n-[[package]]\n-name = \"ident_case\"\n-version = \"1.0.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"b9e0384b61958566e926dc50660321d12159025e767c18e043daf26b70104c39\"\n-\n [[package]]\n name = \"idna\"\n version = \"0.1.5\"\n@@ -1634,12 +1390,6 @@ dependencies = [\n  \"libc\",\n ]\n \n-[[package]]\n-name = \"is-match\"\n-version = \"0.1.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"7e5b386aef33a1c677be65237cb9d32c3f3ef56bd035949710c4bb13083eb053\"\n-\n [[package]]\n name = \"itertools\"\n version = \"0.8.0\"\n@@ -1992,58 +1742,29 @@ dependencies = [\n \n [[package]]\n name = \"mdbook\"\n-version = \"0.3.7\"\n+version = \"0.4.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"e7ec525f7ebccc2dd935c263717250cd37f9a4b264a77c5dbc950ea2734d8159\"\n+checksum = \"2567ffadc0fd26fe15d6f6e0a80639f19f6a50082fdb460d0ae5d1f7298181be\"\n dependencies = [\n  \"ammonia\",\n+ \"anyhow\",\n  \"chrono\",\n  \"clap\",\n  \"elasticlunr-rs\",\n- \"env_logger 0.6.2\",\n- \"error-chain\",\n+ \"env_logger 0.7.1\",\n  \"handlebars\",\n- \"itertools 0.8.0\",\n  \"lazy_static\",\n  \"log\",\n  \"memchr\",\n  \"open\",\n- \"pulldown-cmark 0.6.1\",\n+ \"pulldown-cmark\",\n  \"regex\",\n  \"serde\",\n  \"serde_derive\",\n  \"serde_json\",\n  \"shlex\",\n  \"tempfile\",\n  \"toml\",\n- \"toml-query\",\n-]\n-\n-[[package]]\n-name = \"mdbook-linkcheck\"\n-version = \"0.5.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"c0a04db564ca37c47771f8455c825dc941ea851ff0deffcf55a04c512406b409\"\n-dependencies = [\n- \"codespan\",\n- \"codespan-reporting\",\n- \"dunce\",\n- \"either\",\n- \"env_logger 0.7.1\",\n- \"failure\",\n- \"http\",\n- \"log\",\n- \"mdbook\",\n- \"percent-encoding 2.1.0\",\n- \"pulldown-cmark 0.6.1\",\n- \"rayon\",\n- \"regex\",\n- \"reqwest\",\n- \"semver 0.9.0\",\n- \"serde\",\n- \"serde_derive\",\n- \"serde_json\",\n- \"structopt\",\n ]\n \n [[package]]\n@@ -2083,25 +1804,6 @@ dependencies = [\n  \"rustc_version\",\n ]\n \n-[[package]]\n-name = \"mime\"\n-version = \"0.3.13\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"3e27ca21f40a310bd06d9031785f4801710d566c184a6e15bad4f1d9b65f9425\"\n-dependencies = [\n- \"unicase\",\n-]\n-\n-[[package]]\n-name = \"mime_guess\"\n-version = \"2.0.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"1a0ed03949aef72dbdf3116a383d7b38b4768e6f960528cd6a6044aa9ed68599\"\n-dependencies = [\n- \"mime\",\n- \"unicase\",\n-]\n-\n [[package]]\n name = \"minifier\"\n version = \"0.0.33\"\n@@ -2202,24 +1904,6 @@ dependencies = [\n  \"shell-escape\",\n ]\n \n-[[package]]\n-name = \"native-tls\"\n-version = \"0.2.3\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"4b2df1a4c22fd44a62147fd8f13dd0f95c9d8ca7b2610299b2a2f9cf8964274e\"\n-dependencies = [\n- \"lazy_static\",\n- \"libc\",\n- \"log\",\n- \"openssl\",\n- \"openssl-probe\",\n- \"openssl-sys\",\n- \"schannel\",\n- \"security-framework\",\n- \"security-framework-sys\",\n- \"tempfile\",\n-]\n-\n [[package]]\n name = \"net2\"\n version = \"0.2.33\"\n@@ -2670,38 +2354,14 @@ dependencies = [\n  \"cc\",\n ]\n \n-[[package]]\n-name = \"publicsuffix\"\n-version = \"1.5.3\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"9bf259a81de2b2eb9850ec990ec78e6a25319715584fd7652b9b26f96fcb1510\"\n-dependencies = [\n- \"error-chain\",\n- \"idna 0.2.0\",\n- \"lazy_static\",\n- \"regex\",\n- \"url 2.1.0\",\n-]\n-\n-[[package]]\n-name = \"pulldown-cmark\"\n-version = \"0.6.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"1c205cc82214f3594e2d50686730314f817c67ffa80fe800cf0db78c3c2b9d9e\"\n-dependencies = [\n- \"bitflags\",\n- \"getopts\",\n- \"memchr\",\n- \"unicase\",\n-]\n-\n [[package]]\n name = \"pulldown-cmark\"\n version = \"0.7.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"3e142c3b8f49d2200605ee6ba0b1d757310e9e7a72afe78c36ee2ef67300ee00\"\n dependencies = [\n  \"bitflags\",\n+ \"getopts\",\n  \"memchr\",\n  \"unicase\",\n ]\n@@ -3002,40 +2662,6 @@ dependencies = [\n  \"winapi 0.3.8\",\n ]\n \n-[[package]]\n-name = \"reqwest\"\n-version = \"0.9.22\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"2c2064233e442ce85c77231ebd67d9eca395207dec2127fe0bbedde4bd29a650\"\n-dependencies = [\n- \"base64\",\n- \"bytes\",\n- \"cookie\",\n- \"cookie_store\",\n- \"encoding_rs\",\n- \"flate2\",\n- \"futures\",\n- \"http\",\n- \"hyper\",\n- \"hyper-tls\",\n- \"log\",\n- \"mime\",\n- \"mime_guess\",\n- \"native-tls\",\n- \"serde\",\n- \"serde_json\",\n- \"serde_urlencoded\",\n- \"time\",\n- \"tokio\",\n- \"tokio-executor\",\n- \"tokio-io\",\n- \"tokio-threadpool\",\n- \"tokio-timer\",\n- \"url 1.7.2\",\n- \"uuid\",\n- \"winreg\",\n-]\n-\n [[package]]\n name = \"rls\"\n version = \"1.41.0\"\n@@ -3162,12 +2788,7 @@ name = \"rustbook\"\n version = \"0.1.0\"\n dependencies = [\n  \"clap\",\n- \"codespan\",\n- \"codespan-reporting\",\n- \"failure\",\n  \"mdbook\",\n- \"mdbook-linkcheck\",\n- \"rustc-workspace-hack\",\n ]\n \n [[package]]\n@@ -4402,7 +4023,7 @@ version = \"0.0.0\"\n dependencies = [\n  \"itertools 0.8.0\",\n  \"minifier\",\n- \"pulldown-cmark 0.7.1\",\n+ \"pulldown-cmark\",\n  \"rustc-rayon\",\n  \"serde\",\n  \"serde_json\",\n@@ -4525,27 +4146,6 @@ version = \"1.0.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"b42e15e59b18a828bbf5c58ea01debb36b9b096346de35d941dcb89009f24a0d\"\n \n-[[package]]\n-name = \"security-framework\"\n-version = \"0.3.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"eee63d0f4a9ec776eeb30e220f0bc1e092c3ad744b2a379e3993070364d3adc2\"\n-dependencies = [\n- \"core-foundation 0.6.3\",\n- \"core-foundation-sys 0.6.2\",\n- \"libc\",\n- \"security-framework-sys\",\n-]\n-\n-[[package]]\n-name = \"security-framework-sys\"\n-version = \"0.3.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"9636f8989cbf61385ae4824b98c1aaa54c994d7d8b41f11c601ed799f0549a56\"\n-dependencies = [\n- \"core-foundation-sys 0.6.2\",\n-]\n-\n [[package]]\n name = \"semver\"\n version = \"0.9.0\"\n@@ -4623,18 +4223,6 @@ dependencies = [\n  \"syn 1.0.11\",\n ]\n \n-[[package]]\n-name = \"serde_urlencoded\"\n-version = \"0.5.5\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"642dd69105886af2efd227f75a520ec9b44a820d65bc133a9131f7d229fd165a\"\n-dependencies = [\n- \"dtoa\",\n- \"itoa\",\n- \"serde\",\n- \"url 1.7.2\",\n-]\n-\n [[package]]\n name = \"sha-1\"\n version = \"0.8.2\"\n@@ -4756,15 +4344,6 @@ dependencies = [\n  \"wasi\",\n ]\n \n-[[package]]\n-name = \"string\"\n-version = \"0.2.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"d24114bfcceb867ca7f71a0d3fe45d45619ec47a6fbfa98cb14e14250bfa5d6d\"\n-dependencies = [\n- \"bytes\",\n-]\n-\n [[package]]\n name = \"string_cache\"\n version = \"0.7.3\"\n@@ -5072,17 +4651,6 @@ dependencies = [\n  \"tokio-uds\",\n ]\n \n-[[package]]\n-name = \"tokio-buf\"\n-version = \"0.1.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"8fb220f46c53859a4b7ec083e41dec9778ff0b1851c0942b211edb89e0ccdc46\"\n-dependencies = [\n- \"bytes\",\n- \"either\",\n- \"futures\",\n-]\n-\n [[package]]\n name = \"tokio-codec\"\n version = \"0.1.1\"\n@@ -5308,32 +4876,6 @@ dependencies = [\n  \"serde\",\n ]\n \n-[[package]]\n-name = \"toml-query\"\n-version = \"0.9.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"a24369a1894ac8224efcfd567c3d141aea360292f49888e7ec7dcc316527aebb\"\n-dependencies = [\n- \"failure\",\n- \"failure_derive\",\n- \"is-match\",\n- \"lazy_static\",\n- \"regex\",\n- \"toml\",\n- \"toml-query_derive\",\n-]\n-\n-[[package]]\n-name = \"toml-query_derive\"\n-version = \"0.9.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"3c99ca245ec273c7e75c8ee58f47b882d0146f3c2c8495158082c6671e8b5335\"\n-dependencies = [\n- \"darling\",\n- \"quote 0.6.12\",\n- \"syn 0.15.35\",\n-]\n-\n [[package]]\n name = \"tracing\"\n version = \"0.1.15\"\n@@ -5365,21 +4907,6 @@ dependencies = [\n  \"lazy_static\",\n ]\n \n-[[package]]\n-name = \"try-lock\"\n-version = \"0.2.2\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"e604eb7b43c06650e854be16a2a03155743d3752dd1c943f6829e26b7a36e382\"\n-\n-[[package]]\n-name = \"try_from\"\n-version = \"0.3.2\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"283d3b89e1368717881a9d51dad843cc435380d8109c9e47d38780a324698d8b\"\n-dependencies = [\n- \"cfg-if\",\n-]\n-\n [[package]]\n name = \"typenum\"\n version = \"1.12.0\"\n@@ -5541,15 +5068,6 @@ version = \"0.1.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"8772a4ccbb4e89959023bc5b7cb8623a795caa7092d99f3aa9501b9484d4557d\"\n \n-[[package]]\n-name = \"uuid\"\n-version = \"0.7.4\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"90dbc611eb48397705a6b0f6e917da23ae517e4d127123d2cf7674206627d32a\"\n-dependencies = [\n- \"rand 0.6.1\",\n-]\n-\n [[package]]\n name = \"vcpkg\"\n version = \"0.2.8\"\n@@ -5598,17 +5116,6 @@ dependencies = [\n  \"winapi-util\",\n ]\n \n-[[package]]\n-name = \"want\"\n-version = \"0.2.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"b6395efa4784b027708f7451087e647ec73cc74f5d9bc2e418404248d679a230\"\n-dependencies = [\n- \"futures\",\n- \"log\",\n- \"try-lock\",\n-]\n-\n [[package]]\n name = \"wasi\"\n version = \"0.9.0+wasi-snapshot-preview1\"\n@@ -5673,15 +5180,6 @@ dependencies = [\n  \"winapi-util\",\n ]\n \n-[[package]]\n-name = \"winreg\"\n-version = \"0.6.2\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"b2986deb581c4fe11b621998a5e53361efe6b48a151178d0cd9eeffa4dc6acc9\"\n-dependencies = [\n- \"winapi 0.3.8\",\n-]\n-\n [[package]]\n name = \"ws2_32-sys\"\n version = \"0.2.1\""}, {"sha": "063fb8fbb9526b0f4dec0726217d0586af9b6e5e", "filename": "src/bootstrap/tool.rs", "status": "modified", "additions": 2, "deletions": 17, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/9bdd2db3a60176012f4dc240eea02d615cc60061/src%2Fbootstrap%2Ftool.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9bdd2db3a60176012f4dc240eea02d615cc60061/src%2Fbootstrap%2Ftool.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftool.rs?ref=9bdd2db3a60176012f4dc240eea02d615cc60061", "patch": "@@ -12,7 +12,7 @@ use crate::channel;\n use crate::channel::GitInfo;\n use crate::compile;\n use crate::toolstate::ToolState;\n-use crate::util::{add_dylib_path, exe, CiEnv};\n+use crate::util::{add_dylib_path, exe};\n use crate::Compiler;\n use crate::Mode;\n \n@@ -236,7 +236,6 @@ pub fn prepare_tool_cargo(\n             || path.ends_with(\"rls\")\n             || path.ends_with(\"clippy\")\n             || path.ends_with(\"miri\")\n-            || path.ends_with(\"rustbook\")\n             || path.ends_with(\"rustfmt\")\n         {\n             cargo.env(\"LIBZ_SYS_STATIC\", \"1\");\n@@ -272,20 +271,6 @@ pub fn prepare_tool_cargo(\n     cargo\n }\n \n-fn rustbook_features() -> Vec<String> {\n-    let mut features = Vec::new();\n-\n-    // Due to CI budged and risk of spurious failures we want to limit jobs running this check.\n-    // At same time local builds should run it regardless of the platform.\n-    // `CiEnv::None` means it's local build and `CHECK_LINKS` is defined in x86_64-gnu-tools to\n-    // explicitly enable it on single job\n-    if CiEnv::current() == CiEnv::None || env::var(\"CHECK_LINKS\").is_ok() {\n-        features.push(\"linkcheck\".to_string());\n-    }\n-\n-    features\n-}\n-\n macro_rules! bootstrap_tool {\n     ($(\n         $name:ident, $path:expr, $tool_name:expr\n@@ -368,7 +353,7 @@ macro_rules! bootstrap_tool {\n }\n \n bootstrap_tool!(\n-    Rustbook, \"src/tools/rustbook\", \"rustbook\", features = rustbook_features();\n+    Rustbook, \"src/tools/rustbook\", \"rustbook\";\n     UnstableBookGen, \"src/tools/unstable-book-gen\", \"unstable-book-gen\";\n     Tidy, \"src/tools/tidy\", \"tidy\";\n     Linkchecker, \"src/tools/linkchecker\", \"linkchecker\";"}, {"sha": "3b6e4c2cb98df44778eca619185bb7e9c2734a70", "filename": "src/ci/docker/x86_64-gnu-tools/Dockerfile", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9bdd2db3a60176012f4dc240eea02d615cc60061/src%2Fci%2Fdocker%2Fx86_64-gnu-tools%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9bdd2db3a60176012f4dc240eea02d615cc60061/src%2Fci%2Fdocker%2Fx86_64-gnu-tools%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fx86_64-gnu-tools%2FDockerfile?ref=9bdd2db3a60176012f4dc240eea02d615cc60061", "patch": "@@ -19,9 +19,6 @@ RUN sh /scripts/sccache.sh\n \n COPY x86_64-gnu-tools/checktools.sh /tmp/\n \n-# Run rustbook with `linkcheck` feature enabled\n-ENV CHECK_LINKS 1\n-\n ENV RUST_CONFIGURE_ARGS \\\n   --build=x86_64-unknown-linux-gnu \\\n   --save-toolstates=/tmp/toolstate/toolstates.json"}, {"sha": "f0a6ce2fa06c27d9b62f84e24045015b3eb52b81", "filename": "src/tools/rustbook/Cargo.toml", "status": "modified", "additions": 1, "deletions": 15, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/9bdd2db3a60176012f4dc240eea02d615cc60061/src%2Ftools%2Frustbook%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/9bdd2db3a60176012f4dc240eea02d615cc60061/src%2Ftools%2Frustbook%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustbook%2FCargo.toml?ref=9bdd2db3a60176012f4dc240eea02d615cc60061", "patch": "@@ -5,24 +5,10 @@ version = \"0.1.0\"\n license = \"MIT OR Apache-2.0\"\n edition = \"2018\"\n \n-[features]\n-linkcheck = [\"mdbook-linkcheck\", \"codespan-reporting\", \"codespan\"]\n-\n [dependencies]\n clap = \"2.25.0\"\n-failure = \"0.1\"\n-mdbook-linkcheck = { version = \"0.5.0\", optional = true }\n-# Keep in sync with mdbook-linkcheck.\n-codespan = { version = \"0.5\", optional = true }\n-codespan-reporting = { version = \"0.5\", optional = true }\n-\n-\n-# A noop dependency that changes in the Rust repository, it's a bit of a hack.\n-# See the `src/tools/rustc-workspace-hack/README.md` file in `rust-lang/rust`\n-# for more information.\n-rustc-workspace-hack = \"1.0.0\"\n \n [dependencies.mdbook]\n-version = \"0.3.7\"\n+version = \"0.4.0\"\n default-features = false\n features = [\"search\"]"}, {"sha": "c87c64540ad7bb7fa916be04c10b43628d45fc9a", "filename": "src/tools/rustbook/src/main.rs", "status": "modified", "additions": 9, "deletions": 92, "changes": 101, "blob_url": "https://github.com/rust-lang/rust/blob/9bdd2db3a60176012f4dc240eea02d615cc60061/src%2Ftools%2Frustbook%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9bdd2db3a60176012f4dc240eea02d615cc60061/src%2Ftools%2Frustbook%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustbook%2Fsrc%2Fmain.rs?ref=9bdd2db3a60176012f4dc240eea02d615cc60061", "patch": "@@ -30,11 +30,6 @@ fn main() {\n                 .about(\"Tests that a book's Rust code samples compile\")\n                 .arg_from_usage(dir_message),\n         )\n-        .subcommand(\n-            SubCommand::with_name(\"linkcheck\")\n-                .about(\"Run linkcheck with mdBook 3\")\n-                .arg_from_usage(dir_message),\n-        )\n         .get_matches();\n \n     // Check which subcomamnd the user ran...\n@@ -49,98 +44,14 @@ fn main() {\n                 handle_error(e);\n             }\n         }\n-        (\"linkcheck\", Some(sub_matches)) => {\n-            #[cfg(feature = \"linkcheck\")]\n-            {\n-                let (diags, files) = linkcheck(sub_matches).expect(\"Error while linkchecking.\");\n-                if !diags.is_empty() {\n-                    let color = codespan_reporting::term::termcolor::ColorChoice::Auto;\n-                    let mut writer =\n-                        codespan_reporting::term::termcolor::StandardStream::stderr(color);\n-                    let cfg = codespan_reporting::term::Config::default();\n-\n-                    for diag in diags {\n-                        codespan_reporting::term::emit(&mut writer, &cfg, &files, &diag)\n-                            .expect(\"Unable to emit linkcheck error.\");\n-                    }\n-\n-                    std::process::exit(101);\n-                }\n-            }\n-\n-            #[cfg(not(feature = \"linkcheck\"))]\n-            {\n-                // This avoids the `unused_binding` lint.\n-                println!(\n-                    \"mdbook-linkcheck is disabled, but arguments were passed: {:?}\",\n-                    sub_matches\n-                );\n-            }\n-        }\n         (_, _) => unreachable!(),\n     };\n }\n \n-#[cfg(feature = \"linkcheck\")]\n-pub fn linkcheck(\n-    args: &ArgMatches<'_>,\n-) -> Result<(Vec<codespan_reporting::diagnostic::Diagnostic>, codespan::Files), failure::Error> {\n-    use mdbook_linkcheck::Reason;\n-\n-    let book_dir = get_book_dir(args);\n-    let src_dir = book_dir.join(\"src\");\n-    let book = MDBook::load(&book_dir).unwrap();\n-    let linkck_cfg = mdbook_linkcheck::get_config(&book.config)?;\n-    let mut files = codespan::Files::new();\n-    let target_files = mdbook_linkcheck::load_files_into_memory(&book.book, &mut files);\n-    let cache = mdbook_linkcheck::Cache::default();\n-\n-    let (links, incomplete) = mdbook_linkcheck::extract_links(target_files, &files);\n-\n-    let outcome =\n-        mdbook_linkcheck::validate(&links, &linkck_cfg, &src_dir, &cache, &files, incomplete)?;\n-\n-    let mut is_real_error = false;\n-\n-    for link in outcome.invalid_links.iter() {\n-        match &link.reason {\n-            Reason::FileNotFound | Reason::TraversesParentDirectories => {\n-                is_real_error = true;\n-            }\n-            Reason::UnsuccessfulServerResponse(status) => {\n-                if status.as_u16() == 429 {\n-                    eprintln!(\"Received 429 (TOO_MANY_REQUESTS) for link `{}`\", link.link.uri);\n-                } else if status.is_client_error() {\n-                    is_real_error = true;\n-                } else {\n-                    eprintln!(\"Unsuccessful server response for link `{}`\", link.link.uri);\n-                }\n-            }\n-            Reason::Client(err) => {\n-                if err.is_timeout() {\n-                    eprintln!(\"Timeout for link `{}`\", link.link.uri);\n-                } else if err.is_server_error() {\n-                    eprintln!(\"Server error for link `{}`\", link.link.uri);\n-                } else if !err.is_http() {\n-                    eprintln!(\"Non-HTTP-related error for link: {} {}\", link.link.uri, err);\n-                } else {\n-                    is_real_error = true;\n-                }\n-            }\n-        }\n-    }\n-\n-    if is_real_error {\n-        Ok((outcome.generate_diagnostics(&files, linkck_cfg.warning_policy), files))\n-    } else {\n-        Ok((vec![], files))\n-    }\n-}\n-\n // Build command implementation\n pub fn build(args: &ArgMatches<'_>) -> Result3<()> {\n     let book_dir = get_book_dir(args);\n-    let mut book = MDBook::load(&book_dir)?;\n+    let mut book = load_book(&book_dir)?;\n \n     // Set this to allow us to catch bugs in advance.\n     book.config.build.create_missing = false;\n@@ -156,7 +67,7 @@ pub fn build(args: &ArgMatches<'_>) -> Result3<()> {\n \n fn test(args: &ArgMatches<'_>) -> Result3<()> {\n     let book_dir = get_book_dir(args);\n-    let mut book = MDBook::load(&book_dir)?;\n+    let mut book = load_book(&book_dir)?;\n     book.test(vec![])\n }\n \n@@ -170,10 +81,16 @@ fn get_book_dir(args: &ArgMatches<'_>) -> PathBuf {\n     }\n }\n \n+fn load_book(book_dir: &Path) -> Result3<MDBook> {\n+    let mut book = MDBook::load(book_dir)?;\n+    book.config.set(\"output.html.input-404\", \"\").unwrap();\n+    Ok(book)\n+}\n+\n fn handle_error(error: mdbook::errors::Error) -> ! {\n     eprintln!(\"Error: {}\", error);\n \n-    for cause in error.iter().skip(1) {\n+    for cause in error.chain().skip(1) {\n         eprintln!(\"\\tCaused By: {}\", cause);\n     }\n "}, {"sha": "4622e15a1cae88bbda0575adf45b576c46176afb", "filename": "src/tools/tidy/src/deps.rs", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/9bdd2db3a60176012f4dc240eea02d615cc60061/src%2Ftools%2Ftidy%2Fsrc%2Fdeps.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9bdd2db3a60176012f4dc240eea02d615cc60061/src%2Ftools%2Ftidy%2Fsrc%2Fdeps.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Ftidy%2Fsrc%2Fdeps.rs?ref=9bdd2db3a60176012f4dc240eea02d615cc60061", "patch": "@@ -26,9 +26,6 @@ const LICENSES: &[&str] = &[\n const EXCEPTIONS: &[(&str, &str)] = &[\n     (\"mdbook\", \"MPL-2.0\"),                  // mdbook\n     (\"openssl\", \"Apache-2.0\"),              // cargo, mdbook\n-    (\"toml-query\", \"MPL-2.0\"),              // mdbook\n-    (\"toml-query_derive\", \"MPL-2.0\"),       // mdbook\n-    (\"is-match\", \"MPL-2.0\"),                // mdbook\n     (\"rdrand\", \"ISC\"),                      // mdbook, rustfmt\n     (\"fuchsia-cprng\", \"BSD-3-Clause\"),      // mdbook, rustfmt\n     (\"fuchsia-zircon-sys\", \"BSD-3-Clause\"), // rustdoc, rustc, cargo\n@@ -45,9 +42,6 @@ const EXCEPTIONS: &[(&str, &str)] = &[\n     (\"bitmaps\", \"MPL-2.0+\"),                // cargo via im-rc\n     // FIXME: this dependency violates the documentation comment above:\n     (\"fortanix-sgx-abi\", \"MPL-2.0\"), // libstd but only for `sgx` target\n-    (\"dunce\", \"CC0-1.0\"),            // mdbook-linkcheck\n-    (\"codespan-reporting\", \"Apache-2.0\"), // mdbook-linkcheck\n-    (\"codespan\", \"Apache-2.0\"),      // mdbook-linkcheck\n     (\"crossbeam-channel\", \"MIT/Apache-2.0 AND BSD-2-Clause\"), // cargo\n ];\n "}]}