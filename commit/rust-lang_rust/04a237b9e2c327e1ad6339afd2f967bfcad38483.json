{"sha": "04a237b9e2c327e1ad6339afd2f967bfcad38483", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA0YTIzN2I5ZTJjMzI3ZTFhZDYzMzlhZmQyZjk2N2JmY2FkMzg0ODM=", "commit": {"author": {"name": "Stepan Koltsov", "email": "stepan.koltsov@gmail.com", "date": "2019-11-10T23:47:23Z"}, "committer": {"name": "Stepan Koltsov", "email": "stepan.koltsov@gmail.com", "date": "2019-11-10T23:53:44Z"}, "message": "Fix HashSet::union performance\n\nConsider this example: small_set = 0..2, large_set = 0..1000.\n\nTo efficiently compute the union of these sets, we should\n* take all elements of the larger set\n* for each element of the smaller set check it is not in the larger set\n\nThis is exactly what this commit does.\n\nThis particular optimization was implemented a year ago, but the\nauthor mistaken `<` and `>`.", "tree": {"sha": "391475674b94604b630d8e11e693a9b1e2c057eb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/391475674b94604b630d8e11e693a9b1e2c057eb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/04a237b9e2c327e1ad6339afd2f967bfcad38483", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/04a237b9e2c327e1ad6339afd2f967bfcad38483", "html_url": "https://github.com/rust-lang/rust/commit/04a237b9e2c327e1ad6339afd2f967bfcad38483", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/04a237b9e2c327e1ad6339afd2f967bfcad38483/comments", "author": {"login": "stepancheg", "id": 28969, "node_id": "MDQ6VXNlcjI4OTY5", "avatar_url": "https://avatars.githubusercontent.com/u/28969?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stepancheg", "html_url": "https://github.com/stepancheg", "followers_url": "https://api.github.com/users/stepancheg/followers", "following_url": "https://api.github.com/users/stepancheg/following{/other_user}", "gists_url": "https://api.github.com/users/stepancheg/gists{/gist_id}", "starred_url": "https://api.github.com/users/stepancheg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stepancheg/subscriptions", "organizations_url": "https://api.github.com/users/stepancheg/orgs", "repos_url": "https://api.github.com/users/stepancheg/repos", "events_url": "https://api.github.com/users/stepancheg/events{/privacy}", "received_events_url": "https://api.github.com/users/stepancheg/received_events", "type": "User", "site_admin": false}, "committer": {"login": "stepancheg", "id": 28969, "node_id": "MDQ6VXNlcjI4OTY5", "avatar_url": "https://avatars.githubusercontent.com/u/28969?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stepancheg", "html_url": "https://github.com/stepancheg", "followers_url": "https://api.github.com/users/stepancheg/followers", "following_url": "https://api.github.com/users/stepancheg/following{/other_user}", "gists_url": "https://api.github.com/users/stepancheg/gists{/gist_id}", "starred_url": "https://api.github.com/users/stepancheg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stepancheg/subscriptions", "organizations_url": "https://api.github.com/users/stepancheg/orgs", "repos_url": "https://api.github.com/users/stepancheg/repos", "events_url": "https://api.github.com/users/stepancheg/events{/privacy}", "received_events_url": "https://api.github.com/users/stepancheg/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3fc30d884ae0c988d98452a06737705cfe34806a", "url": "https://api.github.com/repos/rust-lang/rust/commits/3fc30d884ae0c988d98452a06737705cfe34806a", "html_url": "https://github.com/rust-lang/rust/commit/3fc30d884ae0c988d98452a06737705cfe34806a"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "a038ee802105728eef0a6759fb34fb60ddcf56ad", "filename": "src/libstd/collections/hash/set.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/04a237b9e2c327e1ad6339afd2f967bfcad38483/src%2Flibstd%2Fcollections%2Fhash%2Fset.rs", "raw_url": "https://github.com/rust-lang/rust/raw/04a237b9e2c327e1ad6339afd2f967bfcad38483/src%2Flibstd%2Fcollections%2Fhash%2Fset.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fcollections%2Fhash%2Fset.rs?ref=04a237b9e2c327e1ad6339afd2f967bfcad38483", "patch": "@@ -551,7 +551,7 @@ impl<T, S> HashSet<T, S>\n     #[inline]\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     pub fn union<'a>(&'a self, other: &'a HashSet<T, S>) -> Union<'a, T, S> {\n-        if self.len() <= other.len() {\n+        if self.len() >= other.len() {\n             Union {\n                 iter: self.iter().chain(other.difference(self)),\n             }"}]}