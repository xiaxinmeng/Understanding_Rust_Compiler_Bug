{"sha": "fa457bff264ea62acf56bb9e645b8227ecdc7529", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZhNDU3YmZmMjY0ZWE2MmFjZjU2YmI5ZTY0NWI4MjI3ZWNkYzc1Mjk=", "commit": {"author": {"name": "Stjepan Glavina", "email": "stjepang@gmail.com", "date": "2017-02-04T17:04:26Z"}, "committer": {"name": "Stjepan Glavina", "email": "stjepang@gmail.com", "date": "2017-02-04T17:04:26Z"}, "message": "Minor fix in the *_expensive benchmark\n\nBefore, the `count` would be copied into the closure and could\npotentially be optimized way. This change ensures it's borrowed by\nclosure and finally consumed by `test::black_box`.", "tree": {"sha": "0136bc2c1774372f40ea6cd2fb426ebe85180035", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0136bc2c1774372f40ea6cd2fb426ebe85180035"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fa457bff264ea62acf56bb9e645b8227ecdc7529", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fa457bff264ea62acf56bb9e645b8227ecdc7529", "html_url": "https://github.com/rust-lang/rust/commit/fa457bff264ea62acf56bb9e645b8227ecdc7529", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fa457bff264ea62acf56bb9e645b8227ecdc7529/comments", "author": null, "committer": null, "parents": [{"sha": "a884a6c60d3ec2338d7dfed9998a7aa96e10260e", "url": "https://api.github.com/repos/rust-lang/rust/commits/a884a6c60d3ec2338d7dfed9998a7aa96e10260e", "html_url": "https://github.com/rust-lang/rust/commit/a884a6c60d3ec2338d7dfed9998a7aa96e10260e"}], "stats": {"total": 9, "additions": 3, "deletions": 6}, "files": [{"sha": "b9dec6be7b8853b9401c6089b6455e049bec145a", "filename": "src/libcollectionstest/slice.rs", "status": "modified", "additions": 3, "deletions": 6, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/fa457bff264ea62acf56bb9e645b8227ecdc7529/src%2Flibcollectionstest%2Fslice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fa457bff264ea62acf56bb9e645b8227ecdc7529/src%2Flibcollectionstest%2Fslice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcollectionstest%2Fslice.rs?ref=fa457bff264ea62acf56bb9e645b8227ecdc7529", "patch": "@@ -1429,18 +1429,15 @@ mod bench {\n     fn sort_large_random_expensive(b: &mut Bencher) {\n         let len = 10000;\n         b.iter(|| {\n+            let mut v = gen_random(len);\n             let mut count = 0;\n-            let cmp = move |a: &u64, b: &u64| {\n+            v.sort_by(|a: &u64, b: &u64| {\n                 count += 1;\n                 if count % 1_000_000_000 == 0 {\n                     panic!(\"should not happen\");\n                 }\n                 (*a as f64).cos().partial_cmp(&(*b as f64).cos()).unwrap()\n-            };\n-\n-            let mut v = gen_random(len);\n-            v.sort_by(cmp);\n-\n+            });\n             black_box(count);\n         });\n         b.bytes = len as u64 * mem::size_of::<u64>() as u64;"}]}