{"sha": "ce3e8243990eabd4ca70d23941fdf08ba9373ac5", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNlM2U4MjQzOTkwZWFiZDRjYTcwZDIzOTQxZmRmMDhiYTkzNzNhYzU=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-09-10T15:19:26Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-09-10T15:19:26Z"}, "message": "Rollup merge of #64311 - eddyb:lldb-python3, r=michaelwoerister\n\nlldb: avoid mixing \"Hit breakpoint\" message with other output.\n\nThis is to get `src/test/debuginfo/lexical-scopes-in-block-expression.rs` working.\nIt used to work like a week ago, and the main change that happened was I switched from Python 2 to Python 3 (I don't remember why, but I did get rid of the build dir entirely, and it fixed something else).\n\nThe error was:\n```\nerror: line not found in debugger output: [...]$27 = 10\n```\n\nRelevant part of the output:\n```\nprint val\n(long) $26 = 15\nprint ten\n(long) $27 = 10 Hit breakpoint 15.1: where = a`lexical_scopes_in_block_expression::main::hcdd5c3caa9166e73 + 1223 at lexical-scopes-in-block-expression.rs:504:4, address = 0x00005555555556e7, resolved, hit count = 1\nHit breakpoint 16.1: where = a`lexical_scopes_in_block_expression::main::hcdd5c3caa9166e73 + 631 at lexical-scopes-in-block-expression.rs:510:8, address = 0x0000555555555497, resolved, hit count = 1\n```\n\nThere are most `print` commands and their outputs before, and more `Hit breakpoint` messages afterwards, so I assume what happens is the `Hit breakpoint` messages should be interleaved but somehow they ended up being buffered after all of the other output.\n\nAs a stopgap measure I'm adding a newline before each `Hit breakpoint` so they don't end up on the same line as the last `print` output (which breaks our pattern-matching).\n\nr? @michaelwoerister", "tree": {"sha": "d1dc6d685dbb2bd4c0be5deab5da177314705eb6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d1dc6d685dbb2bd4c0be5deab5da177314705eb6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ce3e8243990eabd4ca70d23941fdf08ba9373ac5", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdd77/CRBK7hj4Ov3rIwAAdHIIAIuFBew336x3CdDjClF11uUf\nzqIp/VOBoEikuQazPMTavGAFpIHPioWnJWLOWS02Yvp5YyhWirO2xEApIKPOuj7x\n0Twr2ZH2YumwS8u+zFhzjH120AIDOjdJ8M6fxoARnjZ8ZI+/cKdRUpc6WIcnR0+g\nutnuaBBi6Bm2+6Vcwhc1R/zJS72Tvlf1D1UqRE4IpTt5AZVCwjr5nZWWR+4Z9eIV\nZP/IMAOTGvJhACHkycqWVRkplsZjNKjF+raqJJIJoudKhLAQeP/C2XPW/l+mpZ1n\nTX1+VCBjtaKzIVDQpIJQmH2cKgN5tEpMc3527TGZdF4h9b4Hz5FLhGGTkYQg5tg=\n=6MbT\n-----END PGP SIGNATURE-----\n", "payload": "tree d1dc6d685dbb2bd4c0be5deab5da177314705eb6\nparent a1755dfbc7e26b78dfe9d661cd6da2d51b9da869\nparent 625a9d6a4b0d0ef89e9a70e91275b7f91d871e65\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1568128766 +0200\ncommitter GitHub <noreply@github.com> 1568128766 +0200\n\nRollup merge of #64311 - eddyb:lldb-python3, r=michaelwoerister\n\nlldb: avoid mixing \"Hit breakpoint\" message with other output.\n\nThis is to get `src/test/debuginfo/lexical-scopes-in-block-expression.rs` working.\nIt used to work like a week ago, and the main change that happened was I switched from Python 2 to Python 3 (I don't remember why, but I did get rid of the build dir entirely, and it fixed something else).\n\nThe error was:\n```\nerror: line not found in debugger output: [...]$27 = 10\n```\n\nRelevant part of the output:\n```\nprint val\n(long) $26 = 15\nprint ten\n(long) $27 = 10 Hit breakpoint 15.1: where = a`lexical_scopes_in_block_expression::main::hcdd5c3caa9166e73 + 1223 at lexical-scopes-in-block-expression.rs:504:4, address = 0x00005555555556e7, resolved, hit count = 1\nHit breakpoint 16.1: where = a`lexical_scopes_in_block_expression::main::hcdd5c3caa9166e73 + 631 at lexical-scopes-in-block-expression.rs:510:8, address = 0x0000555555555497, resolved, hit count = 1\n```\n\nThere are most `print` commands and their outputs before, and more `Hit breakpoint` messages afterwards, so I assume what happens is the `Hit breakpoint` messages should be interleaved but somehow they ended up being buffered after all of the other output.\n\nAs a stopgap measure I'm adding a newline before each `Hit breakpoint` so they don't end up on the same line as the last `print` output (which breaks our pattern-matching).\n\nr? @michaelwoerister\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ce3e8243990eabd4ca70d23941fdf08ba9373ac5", "html_url": "https://github.com/rust-lang/rust/commit/ce3e8243990eabd4ca70d23941fdf08ba9373ac5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ce3e8243990eabd4ca70d23941fdf08ba9373ac5/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a1755dfbc7e26b78dfe9d661cd6da2d51b9da869", "url": "https://api.github.com/repos/rust-lang/rust/commits/a1755dfbc7e26b78dfe9d661cd6da2d51b9da869", "html_url": "https://github.com/rust-lang/rust/commit/a1755dfbc7e26b78dfe9d661cd6da2d51b9da869"}, {"sha": "625a9d6a4b0d0ef89e9a70e91275b7f91d871e65", "url": "https://api.github.com/repos/rust-lang/rust/commits/625a9d6a4b0d0ef89e9a70e91275b7f91d871e65", "html_url": "https://github.com/rust-lang/rust/commit/625a9d6a4b0d0ef89e9a70e91275b7f91d871e65"}], "stats": {"total": 5, "additions": 4, "deletions": 1}, "files": [{"sha": "7c2e91474c1f1710e5f85c62d09c47ea957e19ba", "filename": "src/etc/lldb_batchmode.py", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/ce3e8243990eabd4ca70d23941fdf08ba9373ac5/src%2Fetc%2Flldb_batchmode.py", "raw_url": "https://github.com/rust-lang/rust/raw/ce3e8243990eabd4ca70d23941fdf08ba9373ac5/src%2Fetc%2Flldb_batchmode.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Flldb_batchmode.py?ref=ce3e8243990eabd4ca70d23941fdf08ba9373ac5", "patch": "@@ -45,7 +45,10 @@ def normalize_whitespace(s):\n \n def breakpoint_callback(frame, bp_loc, dict):\n     \"\"\"This callback is registered with every breakpoint and makes sure that the\n-    frame containing the breakpoint location is selected\"\"\"\n+    frame containing the breakpoint location is selected \"\"\"\n+\n+    # HACK(eddyb) print a newline to avoid continuing an unfinished line.\n+    print(\"\")\n     print(\"Hit breakpoint \" + str(bp_loc))\n \n     # Select the frame and the thread containing it"}]}