{"sha": "9472f0cf6baa9f2c54fc56f8949c00468660db9c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk0NzJmMGNmNmJhYTlmMmM1NGZjNTZmODk0OWMwMDQ2ODY2MGRiOWM=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-02-15T16:55:50Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-02-16T06:11:33Z"}, "message": "Rollup merge of #58293 - xfix:patch-16, r=Mark-Simulacrum\n\nRemove code for updating copyright years in generate-deriving-span-tests\n\nIt's no longer necessary, as there is no license header anymore.", "tree": {"sha": "15dccb9eeaad2cb5ec10013aa200d85346902c19", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/15dccb9eeaad2cb5ec10013aa200d85346902c19"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9472f0cf6baa9f2c54fc56f8949c00468660db9c", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlxnqZUACgkQ/vbIBR0O\nATyLlQ/9G/mnePUbZh3vBGr6GtIQYcNxbQdbDNJyivrCDT6C950VCia1ODr8j15c\nDvaECGi3ceX4CK36kryllaeX+j2M3VzESVq+ahbbz7NpKPYFEUxJPeWC3f98U7fQ\nL8uSc3zE023lCbQXwmhvrhmIPA9I3/rUFKhRgqGf1L8cVS9Wa5Y/K3o9jPc+z0j2\nVcvfwLnWcq1GYajNjcXe8m2tT6DzqBUkWQHRMvpc07wVmeJAMRwlB8zxKwYAxcKl\nZe3Xs/RwawlpBAkCv8QUhLfeiOgfnjIRA++B0UviA0EpYNwzXDJ/TVcdvjYUGO68\nmf9D09QNvwRUpELAp2dvN9gOz1z/kpKFm9NjDeoCzrnwdywwwLCwjYqh2HJiF8qf\nyUY/kb9G/hPrX4eGJuFqGtEtELzOvbmIpKKIjl1/4wv3Wwmyj3Qh9cl6YMjzFRWj\n3wbkHTG+DbhgNP5ae3kWxUz97EOreIV3J/2gne0skyoBk9uL6N1GT7FKJXL4wPiu\nQ5M9FOtgDg5Ik0kyyRqJw3u2w3MgvZ/ORb/5asq2GqPikhL8/FYzrf11f39mbcXA\nnoAykLTSY7Wv+dzOvVGS9MALggfkwX3sgwzJN/H7sPVPjr/mHjhiieLIZI8tCcCA\nE6xdiopJPL9hUt0GNKmzuHrZbI6z9TPmb3x20GMchofUJR9a7II=\n=aqTA\n-----END PGP SIGNATURE-----", "payload": "tree 15dccb9eeaad2cb5ec10013aa200d85346902c19\nparent 49107c3398c88c7d46ada7285a953089b8e87864\nparent df420aa783f7f6e89d9004552db4d7625c3beb0f\nauthor kennytm <kennytm@gmail.com> 1550249750 +0800\ncommitter kennytm <kennytm@gmail.com> 1550297493 +0800\n\nRollup merge of #58293 - xfix:patch-16, r=Mark-Simulacrum\n\nRemove code for updating copyright years in generate-deriving-span-tests\n\nIt's no longer necessary, as there is no license header anymore.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9472f0cf6baa9f2c54fc56f8949c00468660db9c", "html_url": "https://github.com/rust-lang/rust/commit/9472f0cf6baa9f2c54fc56f8949c00468660db9c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9472f0cf6baa9f2c54fc56f8949c00468660db9c/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "49107c3398c88c7d46ada7285a953089b8e87864", "url": "https://api.github.com/repos/rust-lang/rust/commits/49107c3398c88c7d46ada7285a953089b8e87864", "html_url": "https://github.com/rust-lang/rust/commit/49107c3398c88c7d46ada7285a953089b8e87864"}, {"sha": "df420aa783f7f6e89d9004552db4d7625c3beb0f", "url": "https://api.github.com/repos/rust-lang/rust/commits/df420aa783f7f6e89d9004552db4d7625c3beb0f", "html_url": "https://github.com/rust-lang/rust/commit/df420aa783f7f6e89d9004552db4d7625c3beb0f"}], "stats": {"total": 30, "additions": 7, "deletions": 23}, "files": [{"sha": "1c525101c76f66ac40d4e709eca2428c589449d3", "filename": "src/etc/generate-deriving-span-tests.py", "status": "modified", "additions": 7, "deletions": 23, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/9472f0cf6baa9f2c54fc56f8949c00468660db9c/src%2Fetc%2Fgenerate-deriving-span-tests.py", "raw_url": "https://github.com/rust-lang/rust/raw/9472f0cf6baa9f2c54fc56f8949c00468660db9c/src%2Fetc%2Fgenerate-deriving-span-tests.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fgenerate-deriving-span-tests.py?ref=9472f0cf6baa9f2c54fc56f8949c00468660db9c", "patch": "@@ -8,14 +8,12 @@\n sample usage: src/etc/generate-deriving-span-tests.py\n \"\"\"\n \n-import os, datetime, stat, re\n+import os, stat\n \n TEST_DIR = os.path.abspath(\n     os.path.join(os.path.dirname(__file__), '../test/ui/derives/'))\n \n-YEAR = datetime.datetime.now().year\n-\n-TEMPLATE = \"\"\"\n+TEMPLATE = \"\"\"\\\n // This file was auto-generated using 'src/etc/generate-deriving-span-tests.py'\n \n {error_deriving}\n@@ -63,19 +61,11 @@ def create_test_case(type, trait, super_traits, error_count):\n \n     errors = '\\n'.join('//~%s ERROR' % ('^' * n) for n in range(error_count))\n     code = string.format(traits = all_traits, errors = errors)\n-    return TEMPLATE.format(year = YEAR, error_deriving=error_deriving, code = code)\n+    return TEMPLATE.format(error_deriving=error_deriving, code = code)\n \n def write_file(name, string):\n     test_file = os.path.join(TEST_DIR, 'derives-span-%s.rs' % name)\n \n-    with open(test_file) as f:\n-        old_str = f.read()\n-        old_str_ignoring_date = re.sub(r'^// Copyright \\d+',\n-                                        '// Copyright {year}'.format(year = YEAR), old_str)\n-        if old_str_ignoring_date == string:\n-            # if all we're doing is updating the copyright year, ignore it\n-            return 0\n-\n     # set write permission if file exists, so it can be changed\n     if os.path.exists(test_file):\n         os.chmod(test_file, stat.S_IWUSR)\n@@ -86,8 +76,6 @@ def write_file(name, string):\n     # mark file read-only\n     os.chmod(test_file, stat.S_IRUSR|stat.S_IRGRP|stat.S_IROTH)\n \n-    return 1\n-\n \n ENUM = 1\n STRUCT = 2\n@@ -110,15 +98,11 @@ def write_file(name, string):\n                               ('Hash', [], 1)]:\n     traits[trait] = (ALL, supers, errs)\n \n-files = 0\n-\n for (trait, (types, super_traits, error_count)) in traits.items():\n     mk = lambda ty: create_test_case(ty, trait, super_traits, error_count)\n     if types & ENUM:\n-        files += write_file(trait + '-enum', mk(ENUM_TUPLE))\n-        files += write_file(trait + '-enum-struct-variant', mk(ENUM_STRUCT))\n+        write_file(trait + '-enum', mk(ENUM_TUPLE))\n+        write_file(trait + '-enum-struct-variant', mk(ENUM_STRUCT))\n     if types & STRUCT:\n-        files += write_file(trait + '-struct', mk(STRUCT_FIELDS))\n-        files += write_file(trait + '-tuple-struct', mk(STRUCT_TUPLE))\n-\n-print('Generated {files} deriving span test{}.'.format('s' if files != 1 else '', files = files))\n+        write_file(trait + '-struct', mk(STRUCT_FIELDS))\n+        write_file(trait + '-tuple-struct', mk(STRUCT_TUPLE))"}]}