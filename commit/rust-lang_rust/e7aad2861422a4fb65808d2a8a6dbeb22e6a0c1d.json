{"sha": "e7aad2861422a4fb65808d2a8a6dbeb22e6a0c1d", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU3YWFkMjg2MTQyMmE0ZmI2NTgwOGQyYThhNmRiZWIyMmU2YTBjMWQ=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2015-05-20T00:48:03Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2015-05-20T04:34:09Z"}, "message": "std: Handle DT_DIR file types in `dirent` pointers\n\nThis \"fast path\" in `DirEntry::file_type` on Unix wasn't turning out to be so\nmuch of a fast path as the `DT_DIR` case wasn't handled, so directories fell\nback to using `lstat` instead. This commit adds the missing case to return\nquickly if a path is a directory and `DirEntry::file_type` is used.", "tree": {"sha": "cabc0bc847ae5ad233f7091218f7d7a5a79540c1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cabc0bc847ae5ad233f7091218f7d7a5a79540c1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e7aad2861422a4fb65808d2a8a6dbeb22e6a0c1d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e7aad2861422a4fb65808d2a8a6dbeb22e6a0c1d", "html_url": "https://github.com/rust-lang/rust/commit/e7aad2861422a4fb65808d2a8a6dbeb22e6a0c1d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e7aad2861422a4fb65808d2a8a6dbeb22e6a0c1d/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c322dbbf8a518d00c6db689ca80b0047f2328890", "url": "https://api.github.com/repos/rust-lang/rust/commits/c322dbbf8a518d00c6db689ca80b0047f2328890", "html_url": "https://github.com/rust-lang/rust/commit/c322dbbf8a518d00c6db689ca80b0047f2328890"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "fef25f608fd03fc10588479d1ce25ae8593f2776", "filename": "src/rt/rust_builtin.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/e7aad2861422a4fb65808d2a8a6dbeb22e6a0c1d/src%2Frt%2Frust_builtin.c", "raw_url": "https://github.com/rust-lang/rust/raw/e7aad2861422a4fb65808d2a8a6dbeb22e6a0c1d/src%2Frt%2Frust_builtin.c", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_builtin.c?ref=e7aad2861422a4fb65808d2a8a6dbeb22e6a0c1d", "patch": "@@ -50,14 +50,15 @@ rust_list_dir_val(struct dirent* entry_ptr) {\n \n int\n rust_dir_get_mode(struct dirent* entry_ptr) {\n-#if defined(_DIRENT_HAVE_D_TYPE)\n+#if defined(_DIRENT_HAVE_D_TYPE) || defined(__APPLE__)\n     switch (entry_ptr->d_type) {\n         case DT_BLK: return S_IFBLK;\n         case DT_CHR: return S_IFCHR;\n         case DT_FIFO: return S_IFIFO;\n         case DT_LNK: return S_IFLNK;\n         case DT_REG: return S_IFREG;\n         case DT_SOCK: return S_IFSOCK;\n+        case DT_DIR: return S_IFDIR;\n     }\n #endif\n     return -1;"}]}