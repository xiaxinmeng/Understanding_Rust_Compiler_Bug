{"sha": "a998a374769f80e08fb7e1269b6fcd886ce453cf", "node_id": "C_kwDOAAsO6NoAKGE5OThhMzc0NzY5ZjgwZTA4ZmI3ZTEyNjliNmZjZDg4NmNlNDUzY2Y", "commit": {"author": {"name": "Jacob Hoffman-Andrews", "email": "github@hoffman-andrews.com", "date": "2022-01-22T01:44:54Z"}, "committer": {"name": "Jacob Hoffman-Andrews", "email": "github@hoffman-andrews.com", "date": "2022-01-30T01:13:14Z"}, "message": "rustdoc: small fixes to mobile navigation\n\n- Make sure the mobile-topbar doesn't overflow its height if the user\n  sets a bigger font.\n\n- Make sure the sidebar can be scrolled all the way to the bottom by\n  shortening it to accommodate the mobile-topbar.\n\n- Make the item name in the mobile-topbar clickable to go to the top of\n  the page.\n\n- Remove excess padding sidebar in mobile mode.", "tree": {"sha": "f92b488e7f25662c0cb52135c444795220d70c46", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f92b488e7f25662c0cb52135c444795220d70c46"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a998a374769f80e08fb7e1269b6fcd886ce453cf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a998a374769f80e08fb7e1269b6fcd886ce453cf", "html_url": "https://github.com/rust-lang/rust/commit/a998a374769f80e08fb7e1269b6fcd886ce453cf", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a998a374769f80e08fb7e1269b6fcd886ce453cf/comments", "author": {"login": "jsha", "id": 220205, "node_id": "MDQ6VXNlcjIyMDIwNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/220205?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsha", "html_url": "https://github.com/jsha", "followers_url": "https://api.github.com/users/jsha/followers", "following_url": "https://api.github.com/users/jsha/following{/other_user}", "gists_url": "https://api.github.com/users/jsha/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsha/subscriptions", "organizations_url": "https://api.github.com/users/jsha/orgs", "repos_url": "https://api.github.com/users/jsha/repos", "events_url": "https://api.github.com/users/jsha/events{/privacy}", "received_events_url": "https://api.github.com/users/jsha/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jsha", "id": 220205, "node_id": "MDQ6VXNlcjIyMDIwNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/220205?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsha", "html_url": "https://github.com/jsha", "followers_url": "https://api.github.com/users/jsha/followers", "following_url": "https://api.github.com/users/jsha/following{/other_user}", "gists_url": "https://api.github.com/users/jsha/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsha/subscriptions", "organizations_url": "https://api.github.com/users/jsha/orgs", "repos_url": "https://api.github.com/users/jsha/repos", "events_url": "https://api.github.com/users/jsha/events{/privacy}", "received_events_url": "https://api.github.com/users/jsha/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a00e130dae74a213338e2b095ec855156d8f3d8a", "url": "https://api.github.com/repos/rust-lang/rust/commits/a00e130dae74a213338e2b095ec855156d8f3d8a", "html_url": "https://github.com/rust-lang/rust/commit/a00e130dae74a213338e2b095ec855156d8f3d8a"}], "stats": {"total": 30, "additions": 26, "deletions": 4}, "files": [{"sha": "87403a8b83417d16bd1ddf283180d3289b8f5455", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=a998a374769f80e08fb7e1269b6fcd886ce453cf", "patch": "@@ -1799,8 +1799,9 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n \t\tbackground-color: rgba(0,0,0,0);\n \t\tmargin: 0;\n \t\tpadding: 0;\n-\t\tpadding-left: 15px;\n \t\tz-index: 11;\n+\t\t/* Reduce height slightly to account for mobile topbar. */\n+\t\theight: calc(100vh - 45px);\n \t}\n \n \t/* The source view uses a different design for the sidebar toggle, and doesn't have a topbar,\n@@ -1831,7 +1832,13 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n \t\tpadding: 0.3em;\n \t\tpadding-right: 0.6em;\n \t\ttext-overflow: ellipsis;\n-\t\toverflow-x: hidden;\n+\t\toverflow: hidden;\n+\t\twhite-space: nowrap;\n+\t\t/* Rare exception to specifying font sizes in rem. Since the topbar\n+\t\t   height is specified in pixels, this also has to be specified in\n+\t\t   pixels to avoid overflowing the topbar when the user sets a bigger\n+\t\t   font size. */\n+\t\tfont-size: 22.4px;\n \t}\n \n \t.mobile-topbar .logo-container {\n@@ -1864,6 +1871,9 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n \n \t.sidebar-menu-toggle {\n \t\twidth: 45px;\n+\t\t/* Rare exception to specifying font sizes in rem. Since this is acting\n+\t\t   as an icon, it's okay to specify its sizes in pixels. */\n+\t\tfont-size: 32px;\n \t\tborder: none;\n \t}\n "}, {"sha": "cee45e1de39b11fb686557a0bccde8c9e55922d4", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=a998a374769f80e08fb7e1269b6fcd886ce453cf", "patch": "@@ -216,6 +216,7 @@ a.anchor,\n pre.rust a,\n .sidebar h2 a,\n .sidebar h3 a,\n+.mobile-topbar h2 a,\n .in-band a {\n \tcolor: #c5c5c5;\n }"}, {"sha": "c5817ba4e73598cf9516ff9f69c24018d2bcdd0e", "filename": "src/librustdoc/html/static/css/themes/dark.css", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css?ref=a998a374769f80e08fb7e1269b6fcd886ce453cf", "patch": "@@ -192,6 +192,7 @@ a.anchor,\n pre.rust a,\n .sidebar h2 a,\n .sidebar h3 a,\n+.mobile-topbar h2 a,\n .in-band a {\n \tcolor: #ddd;\n }"}, {"sha": "3d2cd23ae3aa8262b10bdbcbf5624712b690a55b", "filename": "src/librustdoc/html/static/css/themes/light.css", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css?ref=a998a374769f80e08fb7e1269b6fcd886ce453cf", "patch": "@@ -189,6 +189,7 @@ a.anchor,\n pre.rust a,\n .sidebar h2 a,\n .sidebar h3 a,\n+.mobile-topbar h2 a,\n .in-band a {\n \tcolor: #000;\n }"}, {"sha": "3c21a96cef02a4b812815bfd6db9f42de60e1e56", "filename": "src/librustdoc/html/static/js/main.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js?ref=a998a374769f80e08fb7e1269b6fcd886ce453cf", "patch": "@@ -72,7 +72,7 @@ function resourcePath(basename, extension) {\n         var mobileLocationTitle = document.querySelector(\".mobile-topbar h2.location\");\n         var locationTitle = document.querySelector(\".sidebar h2.location\");\n         if (mobileLocationTitle && locationTitle) {\n-            mobileLocationTitle.innerText = locationTitle.innerText;\n+            mobileLocationTitle.innerHTML = locationTitle.innerHTML;\n         }\n     }\n }());"}, {"sha": "8f9c9248f5ff1e4edf132b60ad222a92e9c80cd4", "filename": "src/test/rustdoc-gui/mobile.goml", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Ftest%2Frustdoc-gui%2Fmobile.goml", "raw_url": "https://github.com/rust-lang/rust/raw/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Ftest%2Frustdoc-gui%2Fmobile.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fmobile.goml?ref=a998a374769f80e08fb7e1269b6fcd886ce453cf", "patch": "@@ -2,13 +2,17 @@\n goto: file://|DOC_PATH|/staged_api/struct.Foo.html\n size: (400, 600)\n \n+font-size: 18\n+\n // The out-of-band info (source, stable version, collapse) should be below the\n // h1 when the screen gets narrow enough.\n assert-css: (\".main-heading\", {\n   \"display\": \"flex\",\n   \"flex-direction\": \"column\"\n })\n \n+assert-property: (\".mobile-topbar h2.location\", {\"offsetHeight\": 45})\n+\n // Note: We can't use assert-text here because the 'Since' is set by CSS and\n // is therefore not part of the DOM.\n assert-css: (\".content .out-of-band .since::before\", { \"content\": \"\\\"Since \\\"\" })"}, {"sha": "60bcffe120beca8385c09f91fdd79427f077b9d2", "filename": "src/test/rustdoc-gui/sidebar-mobile.goml", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Ftest%2Frustdoc-gui%2Fsidebar-mobile.goml", "raw_url": "https://github.com/rust-lang/rust/raw/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Ftest%2Frustdoc-gui%2Fsidebar-mobile.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsidebar-mobile.goml?ref=a998a374769f80e08fb7e1269b6fcd886ce453cf", "patch": "@@ -35,3 +35,8 @@ assert-property: (\".mobile-topbar\", {\"clientHeight\": \"45\"})\n click: \".sidebar-menu-toggle\"\n click: \".sidebar-links a\"\n assert-position: (\"#method\\.must_use\", {\"y\": 45})\n+\n+// Check that the bottom-most item on the sidebar menu can be scrolled fully into view.\n+click: \".sidebar-menu-toggle\"\n+scroll-to: \".block.keyword li:nth-child(1)\"\n+assert-position: (\".block.keyword li:nth-child(1)\", {\"y\": 542.96875})"}, {"sha": "229c6d6ba6b9682f454fb5af4baa1d7b3c903d54", "filename": "src/test/rustdoc-gui/type-declation-overflow.goml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Ftest%2Frustdoc-gui%2Ftype-declation-overflow.goml", "raw_url": "https://github.com/rust-lang/rust/raw/a998a374769f80e08fb7e1269b6fcd886ce453cf/src%2Ftest%2Frustdoc-gui%2Ftype-declation-overflow.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Ftype-declation-overflow.goml?ref=a998a374769f80e08fb7e1269b6fcd886ce453cf", "patch": "@@ -31,6 +31,6 @@ assert-property: (\".item-decl pre\", {\"scrollWidth\": \"950\"})\n // On mobile:\n size: (600, 600)\n goto: file://|DOC_PATH|/lib2/too_long/struct.SuperIncrediblyLongLongLongLongLongLongLongGigaGigaGigaMegaLongLongLongStructName.html\n-assert-property: (\".mobile-topbar .location\", {\"scrollWidth\": \"504\"})\n+assert-property: (\".mobile-topbar .location\", {\"scrollWidth\": \"986\"})\n assert-property: (\".mobile-topbar .location\", {\"clientWidth\": \"504\"})\n assert-css: (\".mobile-topbar .location\", {\"overflow-x\": \"hidden\"})"}]}