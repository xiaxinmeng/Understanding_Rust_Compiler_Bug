{"sha": "46160e6fa91eba00d7c3b554646149adc82717f2", "node_id": "C_kwDOAAsO6NoAKDQ2MTYwZTZmYTkxZWJhMDBkN2MzYjU1NDY0NjE0OWFkYzgyNzE3ZjI", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-12-24T20:23:45Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-12-24T20:23:45Z"}, "message": "Auto merge of #106110 - GuillaumeGomez:toggle-line-background, r=notriddle\n\nMigrate toggle-line-inner background to CSS variable\n\nr? `@notriddle`", "tree": {"sha": "8f037a6263a1348176d72990c5442ca84708e1e1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8f037a6263a1348176d72990c5442ca84708e1e1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/46160e6fa91eba00d7c3b554646149adc82717f2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/46160e6fa91eba00d7c3b554646149adc82717f2", "html_url": "https://github.com/rust-lang/rust/commit/46160e6fa91eba00d7c3b554646149adc82717f2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/46160e6fa91eba00d7c3b554646149adc82717f2/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7e4f4660ebb4533de629b5d7d8ac10ed572d0f2e", "url": "https://api.github.com/repos/rust-lang/rust/commits/7e4f4660ebb4533de629b5d7d8ac10ed572d0f2e", "html_url": "https://github.com/rust-lang/rust/commit/7e4f4660ebb4533de629b5d7d8ac10ed572d0f2e"}, {"sha": "457f6c8332428fddfa6ac94b78394ed5d0a116b4", "url": "https://api.github.com/repos/rust-lang/rust/commits/457f6c8332428fddfa6ac94b78394ed5d0a116b4", "html_url": "https://github.com/rust-lang/rust/commit/457f6c8332428fddfa6ac94b78394ed5d0a116b4"}], "stats": {"total": 73, "additions": 51, "deletions": 22}, "files": [{"sha": "5a94abab34a0d3b6ede965907e430594020c40b2", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/46160e6fa91eba00d7c3b554646149adc82717f2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/46160e6fa91eba00d7c3b554646149adc82717f2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=46160e6fa91eba00d7c3b554646149adc82717f2", "patch": "@@ -1993,6 +1993,11 @@ in storage.js\n .toggle-line-inner {\n \tmin-width: 2px;\n \theight: 100%;\n+\tbackground: var(--scrape-example-toggle-line-background);\n+}\n+\n+.toggle-line:hover .toggle-line-inner {\n+\tbackground: var(--scrape-example-toggle-line-hover-background);\n }\n \n .more-scraped-examples .scraped-example, .example-links {"}, {"sha": "4ffc25e2688e4d02bb3285cac4febe8edea19694", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/46160e6fa91eba00d7c3b554646149adc82717f2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/46160e6fa91eba00d7c3b554646149adc82717f2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=46160e6fa91eba00d7c3b554646149adc82717f2", "patch": "@@ -89,6 +89,8 @@ Original by Dempfi (https://github.com/dempfi/ayu)\n \t--source-sidebar-background-hover: #14191f;\n \t--table-alt-row-background-color: #191f26;\n \t--codeblock-link-background: #333;\n+\t--scrape-example-toggle-line-background: #999;\n+\t--scrape-example-toggle-line-hover-background: #c5c5c5;\n }\n \n h1, h2, h3, h4 {\n@@ -220,9 +222,3 @@ pre.rust .kw-2, pre.rust .prelude-ty {}\n .scraped-example:not(.expanded) .code-wrapper::after {\n \tbackground: linear-gradient(to top, rgba(15, 20, 25, 1), rgba(15, 20, 25, 0));\n }\n-.toggle-line-inner {\n-\tbackground: #999;\n-}\n-.toggle-line:hover .toggle-line-inner {\n-\tbackground: #c5c5c5;\n-}"}, {"sha": "a7922cdeba1004b07f990843477c168bc8616c5a", "filename": "src/librustdoc/html/static/css/themes/dark.css", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/46160e6fa91eba00d7c3b554646149adc82717f2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/46160e6fa91eba00d7c3b554646149adc82717f2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css?ref=46160e6fa91eba00d7c3b554646149adc82717f2", "patch": "@@ -84,6 +84,8 @@\n \t--source-sidebar-background-hover: #444;\n \t--table-alt-row-background-color: #2A2A2A;\n \t--codeblock-link-background: #333;\n+\t--scrape-example-toggle-line-background: #999;\n+\t--scrape-example-toggle-line-hover-background: #c5c5c5;\n }\n \n #titles > button:not(.selected) {\n@@ -116,9 +118,3 @@\n .scraped-example:not(.expanded) .code-wrapper::after {\n \tbackground: linear-gradient(to top, rgba(53, 53, 53, 1), rgba(53, 53, 53, 0));\n }\n-.toggle-line-inner {\n-\tbackground: #999;\n-}\n-.toggle-line:hover .toggle-line-inner {\n-\tbackground: #c5c5c5;\n-}"}, {"sha": "aff46f8dc6dff3b1afca88a04818c5fbe0c0cb62", "filename": "src/librustdoc/html/static/css/themes/light.css", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/46160e6fa91eba00d7c3b554646149adc82717f2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/46160e6fa91eba00d7c3b554646149adc82717f2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css?ref=46160e6fa91eba00d7c3b554646149adc82717f2", "patch": "@@ -81,6 +81,8 @@\n \t--source-sidebar-background-hover: #e0e0e0;\n \t--table-alt-row-background-color: #F5F5F5;\n \t--codeblock-link-background: #eee;\n+\t--scrape-example-toggle-line-background: #ccc;\n+\t--scrape-example-toggle-line-hover-background: #999;\n }\n \n #titles > button:not(.selected) {\n@@ -113,9 +115,3 @@\n .scraped-example:not(.expanded) .code-wrapper::after {\n \tbackground: linear-gradient(to top, rgba(255, 255, 255, 1), rgba(255, 255, 255, 0));\n }\n-.toggle-line-inner {\n-\tbackground: #ccc;\n-}\n-.toggle-line:hover .toggle-line-inner {\n-\tbackground: #999;\n-}"}, {"sha": "8c84fbc0c30568d121d08aa2a289697d7b10c451", "filename": "src/test/rustdoc-gui/scrape-examples-toggle.goml", "status": "modified", "additions": 40, "deletions": 4, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/46160e6fa91eba00d7c3b554646149adc82717f2/src%2Ftest%2Frustdoc-gui%2Fscrape-examples-toggle.goml", "raw_url": "https://github.com/rust-lang/rust/raw/46160e6fa91eba00d7c3b554646149adc82717f2/src%2Ftest%2Frustdoc-gui%2Fscrape-examples-toggle.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fscrape-examples-toggle.goml?ref=46160e6fa91eba00d7c3b554646149adc82717f2", "patch": "@@ -1,10 +1,46 @@\n // This tests checks that the \"scraped examples\" toggle is working as expected.\n goto: \"file://\" + |DOC_PATH| + \"/scrape_examples/fn.test_many.html\"\n \n-// Clicking \"More examples...\" will open additional examples\n-assert-attribute-false: (\".more-examples-toggle\", {\"open\": \"\"})\n-click: \".more-examples-toggle\"\n-assert-attribute: (\".more-examples-toggle\", {\"open\": \"\"})\n+// Checking the color of the toggle line.\n+show-text: true\n+define-function: (\n+    \"check-color\",\n+    (theme, toggle_line_color, toggle_line_hover_color),\n+    [\n+        (\"local-storage\", {\"rustdoc-theme\": |theme|, \"rustdoc-use-system-theme\": \"false\"}),\n+        (\"reload\"),\n+\n+        // Clicking \"More examples...\" will open additional examples\n+        (\"assert-attribute-false\", (\".more-examples-toggle\", {\"open\": \"\"})),\n+        (\"click\", \".more-examples-toggle\"),\n+        (\"assert-attribute\", (\".more-examples-toggle\", {\"open\": \"\"})),\n+\n+        (\"assert-css\", (\".toggle-line-inner\", {\"background-color\": |toggle_line_color|}, ALL)),\n+        (\"move-cursor-to\", \".toggle-line\"),\n+        (\"assert-css\", (\n+            \".toggle-line:hover .toggle-line-inner\",\n+            {\"background-color\": |toggle_line_hover_color|},\n+        )),\n+        // Moving cursor away from the toggle line to prevent disrupting next test.\n+        (\"move-cursor-to\", \".search-input\"),\n+    ],\n+)\n+\n+call-function: (\"check-color\", {\n+    \"theme\": \"ayu\",\n+    \"toggle_line_color\": \"rgb(153, 153, 153)\",\n+    \"toggle_line_hover_color\": \"rgb(197, 197, 197)\",\n+})\n+call-function: (\"check-color\", {\n+    \"theme\": \"dark\",\n+    \"toggle_line_color\": \"rgb(153, 153, 153)\",\n+    \"toggle_line_hover_color\": \"rgb(197, 197, 197)\",\n+})\n+call-function: (\"check-color\", {\n+    \"theme\": \"light\",\n+    \"toggle_line_color\": \"rgb(204, 204, 204)\",\n+    \"toggle_line_hover_color\": \"rgb(153, 153, 153)\",\n+})\n \n // Toggling all docs will close additional examples\n click: \"#toggle-all-docs\""}]}