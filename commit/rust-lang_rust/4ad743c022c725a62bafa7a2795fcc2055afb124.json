{"sha": "4ad743c022c725a62bafa7a2795fcc2055afb124", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRhZDc0M2MwMjJjNzI1YTYyYmFmYTdhMjc5NWZjYzIwNTVhZmIxMjQ=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-07-27T15:40:49Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-07-27T15:40:49Z"}, "message": "Rollup merge of #63013 - nivkner:ffi-safe-slice, r=sfackler\n\nadd `repr(transparent)` to `IoSliceMut` where missing\n\ntried using `IoSliceMut` in FFI, got `improper_ctypes` warning.\n\naccording to the docs: `IoSliceMut` is  \"guaranteed to be ABI compatible with the `iovec` type\" so it should be usable in FFI.\n`IoSlice` is also `repr(transparent)` for every platform where these types contain `iovec`-like types.\nvxworks also has `IoSliceMut` as transparent so its not even consistently one or the other.\n\nno comment about this next to the types or in the PR that introduced the types, so assuming this was just missed.\n\nr? @sfackler", "tree": {"sha": "44bdb564a0e800395dd53994e875f6ea0d20d53d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/44bdb564a0e800395dd53994e875f6ea0d20d53d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4ad743c022c725a62bafa7a2795fcc2055afb124", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdPHCBCRBK7hj4Ov3rIwAAdHIIAKGGG/5Um5va6fPmbv2Wl8kp\nxYLR4zw2hWJmC7aOL8lZ/4cgEPWVGl9WCLla0A1Dnam1PmnWSmomGfemvp7QEZRO\nn26AbYPByq55KIgClacuOnFmLICeQUyov4dvP0ng+wlLFAgC87sse/WyaM4ESlnC\nb2Wteo3mGI8OYEOJeES8N9hyCDz+RFTmWLqFhKxKUQDvhTiM32e28y7Oqr4QTg2I\nuDVKr45me0l920ky1DG4WEnot2zrsjPYlNLcgzaQUvBYt6bYDH42lzdd7Bqukie5\nEqbzrGMbsi7IvRX3ranxmOYiLfEOf9fzavDmSEQGyl6lBWfT4Khx0bpDqQ+Brwk=\n=acK/\n-----END PGP SIGNATURE-----\n", "payload": "tree 44bdb564a0e800395dd53994e875f6ea0d20d53d\nparent b25d74fa49049a18528605034e414b31860dc0f6\nparent d7b211025ef4fface0f3cd3a01ec19d0b08d7cf6\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1564242049 +0200\ncommitter GitHub <noreply@github.com> 1564242049 +0200\n\nRollup merge of #63013 - nivkner:ffi-safe-slice, r=sfackler\n\nadd `repr(transparent)` to `IoSliceMut` where missing\n\ntried using `IoSliceMut` in FFI, got `improper_ctypes` warning.\n\naccording to the docs: `IoSliceMut` is  \"guaranteed to be ABI compatible with the `iovec` type\" so it should be usable in FFI.\n`IoSlice` is also `repr(transparent)` for every platform where these types contain `iovec`-like types.\nvxworks also has `IoSliceMut` as transparent so its not even consistently one or the other.\n\nno comment about this next to the types or in the PR that introduced the types, so assuming this was just missed.\n\nr? @sfackler\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4ad743c022c725a62bafa7a2795fcc2055afb124", "html_url": "https://github.com/rust-lang/rust/commit/4ad743c022c725a62bafa7a2795fcc2055afb124", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4ad743c022c725a62bafa7a2795fcc2055afb124/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b25d74fa49049a18528605034e414b31860dc0f6", "url": "https://api.github.com/repos/rust-lang/rust/commits/b25d74fa49049a18528605034e414b31860dc0f6", "html_url": "https://github.com/rust-lang/rust/commit/b25d74fa49049a18528605034e414b31860dc0f6"}, {"sha": "d7b211025ef4fface0f3cd3a01ec19d0b08d7cf6", "url": "https://api.github.com/repos/rust-lang/rust/commits/d7b211025ef4fface0f3cd3a01ec19d0b08d7cf6", "html_url": "https://github.com/rust-lang/rust/commit/d7b211025ef4fface0f3cd3a01ec19d0b08d7cf6"}], "stats": {"total": 3, "additions": 3, "deletions": 0}, "files": [{"sha": "bc854e772e16f31f6eec086c646c43a4e1488107", "filename": "src/libstd/sys/unix/io.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/4ad743c022c725a62bafa7a2795fcc2055afb124/src%2Flibstd%2Fsys%2Funix%2Fio.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4ad743c022c725a62bafa7a2795fcc2055afb124/src%2Flibstd%2Fsys%2Funix%2Fio.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Funix%2Fio.rs?ref=4ad743c022c725a62bafa7a2795fcc2055afb124", "patch": "@@ -29,6 +29,7 @@ impl<'a> IoSlice<'a> {\n     }\n }\n \n+#[repr(transparent)]\n pub struct IoSliceMut<'a> {\n     vec: iovec,\n     _p: PhantomData<&'a mut [u8]>,"}, {"sha": "a5bddad708b193b061333467dcdfc9838f66bde0", "filename": "src/libstd/sys/wasi/io.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/4ad743c022c725a62bafa7a2795fcc2055afb124/src%2Flibstd%2Fsys%2Fwasi%2Fio.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4ad743c022c725a62bafa7a2795fcc2055afb124/src%2Flibstd%2Fsys%2Fwasi%2Fio.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fwasi%2Fio.rs?ref=4ad743c022c725a62bafa7a2795fcc2055afb124", "patch": "@@ -29,6 +29,7 @@ impl<'a> IoSlice<'a> {\n     }\n }\n \n+#[repr(transparent)]\n pub struct IoSliceMut<'a> {\n     vec: __wasi_iovec_t,\n     _p: PhantomData<&'a mut [u8]>,"}, {"sha": "f0da2323f4f57c007853ef33c26e8c2587f15436", "filename": "src/libstd/sys/windows/io.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/4ad743c022c725a62bafa7a2795fcc2055afb124/src%2Flibstd%2Fsys%2Fwindows%2Fio.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4ad743c022c725a62bafa7a2795fcc2055afb124/src%2Flibstd%2Fsys%2Fwindows%2Fio.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fwindows%2Fio.rs?ref=4ad743c022c725a62bafa7a2795fcc2055afb124", "patch": "@@ -29,6 +29,7 @@ impl<'a> IoSlice<'a> {\n     }\n }\n \n+#[repr(transparent)]\n pub struct IoSliceMut<'a> {\n     vec: c::WSABUF,\n     _p: PhantomData<&'a mut [u8]>,"}]}