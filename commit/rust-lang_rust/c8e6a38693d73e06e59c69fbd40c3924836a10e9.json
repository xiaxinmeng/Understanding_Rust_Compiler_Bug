{"sha": "c8e6a38693d73e06e59c69fbd40c3924836a10e9", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM4ZTZhMzg2OTNkNzNlMDZlNTljNjlmYmQ0MGMzOTI0ODM2YTEwZTk=", "commit": {"author": {"name": "Huon Wilson", "email": "dbau.pp+github@gmail.com", "date": "2013-11-16T22:13:45Z"}, "committer": {"name": "Huon Wilson", "email": "dbau.pp+github@gmail.com", "date": "2013-11-17T05:05:01Z"}, "message": "extra: handle an edge case in BigUint.to_str().\n\nIf any of the digits was one past the maximum (e.g. 10**9 for base 10),\nthen this wasn't detected correctly and so the length of the digit was\none more than expected, causing a very large allocation.\n\nFixes #10522.\nFixes #10288.", "tree": {"sha": "3234ec2e814f410492bbb87fd54f8a467097b2b0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3234ec2e814f410492bbb87fd54f8a467097b2b0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c8e6a38693d73e06e59c69fbd40c3924836a10e9", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c8e6a38693d73e06e59c69fbd40c3924836a10e9", "html_url": "https://github.com/rust-lang/rust/commit/c8e6a38693d73e06e59c69fbd40c3924836a10e9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c8e6a38693d73e06e59c69fbd40c3924836a10e9/comments", "author": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "90754ae9c95c18841c0200d77da917af5ecde5ee", "url": "https://api.github.com/repos/rust-lang/rust/commits/90754ae9c95c18841c0200d77da917af5ecde5ee", "html_url": "https://github.com/rust-lang/rust/commit/90754ae9c95c18841c0200d77da917af5ecde5ee"}], "stats": {"total": 7, "additions": 6, "deletions": 1}, "files": [{"sha": "b79c2bd5cb565110915302f105991c9de6022711", "filename": "src/libextra/num/bigint.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/c8e6a38693d73e06e59c69fbd40c3924836a10e9/src%2Flibextra%2Fnum%2Fbigint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c8e6a38693d73e06e59c69fbd40c3924836a10e9/src%2Flibextra%2Fnum%2Fbigint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibextra%2Fnum%2Fbigint.rs?ref=c8e6a38693d73e06e59c69fbd40c3924836a10e9", "patch": "@@ -660,7 +660,7 @@ impl ToStrRadix for BigUint {\n             let divider    = FromPrimitive::from_uint(base).unwrap();\n             let mut result = ~[];\n             let mut m      = n;\n-            while m > divider {\n+            while m >= divider {\n                 let (d, m0) = m.div_mod_floor(&divider);\n                 result.push(m0.to_uint().unwrap() as BigDigit);\n                 m = d;\n@@ -2520,6 +2520,11 @@ mod bigint_tests {\n         check(\"-10\", Some(-10));\n         check(\"Z\", None);\n         check(\"_\", None);\n+\n+        // issue 10522, this hit an edge case that caused it to\n+        // attempt to allocate a vector of size (-1u) == huge.\n+        let x: BigInt = from_str(\"1\" + \"0\".repeat(36)).unwrap();\n+        let _y = x.to_str();\n     }\n \n     #[test]"}]}