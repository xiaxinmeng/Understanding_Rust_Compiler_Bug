{"sha": "208d680f771601cf5efb6a7bfb49cb2b9e655d3e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIwOGQ2ODBmNzcxNjAxY2Y1ZWZiNmE3YmZiNDljYjJiOWU2NTVkM2U=", "commit": {"author": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2020-11-28T14:58:30Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-11-28T14:58:30Z"}, "message": "Rollup merge of #79486 - camelid:E0591-code-cleanup, r=lcnr\n\nSlightly improve code samples in E0591\n\n* Improve formatting\n* Don't hide `unsafe` block - it's important!", "tree": {"sha": "74c4ea90fdc836713c72cb393d1b8f442dd0e4c4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/74c4ea90fdc836713c72cb393d1b8f442dd0e4c4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/208d680f771601cf5efb6a7bfb49cb2b9e655d3e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfwmWWCRBK7hj4Ov3rIwAAdHIIAGL92ftcb+gAhm6IiJWvPPog\n1dyZZwFsKa5elV6Xw4K/mSIUC4dzJJIFGQYIE4zUAcbNLPkPVGRdtUDF/WKtVxcs\nYCHaV+NoFnJcOdX+L4YR+DUE5d/qbvLSHB2cUqkbO/jsEhM57jfb6pClHgffiylE\nQOSXR4s6fYeyblGNln78SpyCm7pE8A1Rq/BvJNwQqpMiK5kf4t6cvdJNdM52VVYo\nl5o5+QVt1TFdPfs84OpLCZga/tW3deff/jZ5JxxhC6mjC/frywOVbx5rrtDQykb1\nIFFlMweqh0f0vqpbwiLhMHKiBpJX3DyREGEhyoBE32TiSDXMXRkajBZivWQW99A=\n=nv9Y\n-----END PGP SIGNATURE-----\n", "payload": "tree 74c4ea90fdc836713c72cb393d1b8f442dd0e4c4\nparent 248e5ad299de46bcdd8c5d8a35d6d8cd07de54c2\nparent 1b846bfbccbb3780ca1a9830f0ab72061f52ebb8\nauthor Jonas Schievink <jonasschievink@gmail.com> 1606575510 +0100\ncommitter GitHub <noreply@github.com> 1606575510 +0100\n\nRollup merge of #79486 - camelid:E0591-code-cleanup, r=lcnr\n\nSlightly improve code samples in E0591\n\n* Improve formatting\n* Don't hide `unsafe` block - it's important!\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/208d680f771601cf5efb6a7bfb49cb2b9e655d3e", "html_url": "https://github.com/rust-lang/rust/commit/208d680f771601cf5efb6a7bfb49cb2b9e655d3e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/208d680f771601cf5efb6a7bfb49cb2b9e655d3e/comments", "author": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "248e5ad299de46bcdd8c5d8a35d6d8cd07de54c2", "url": "https://api.github.com/repos/rust-lang/rust/commits/248e5ad299de46bcdd8c5d8a35d6d8cd07de54c2", "html_url": "https://github.com/rust-lang/rust/commit/248e5ad299de46bcdd8c5d8a35d6d8cd07de54c2"}, {"sha": "1b846bfbccbb3780ca1a9830f0ab72061f52ebb8", "url": "https://api.github.com/repos/rust-lang/rust/commits/1b846bfbccbb3780ca1a9830f0ab72061f52ebb8", "html_url": "https://github.com/rust-lang/rust/commit/1b846bfbccbb3780ca1a9830f0ab72061f52ebb8"}], "stats": {"total": 38, "additions": 26, "deletions": 12}, "files": [{"sha": "f49805d9b4e15fa0e9d90263b1fe019397976afd", "filename": "compiler/rustc_error_codes/src/error_codes/E0591.md", "status": "modified", "additions": 13, "deletions": 7, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/208d680f771601cf5efb6a7bfb49cb2b9e655d3e/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0591.md", "raw_url": "https://github.com/rust-lang/rust/raw/208d680f771601cf5efb6a7bfb49cb2b9e655d3e/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0591.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0591.md?ref=208d680f771601cf5efb6a7bfb49cb2b9e655d3e", "patch": "@@ -1,14 +1,20 @@\n Per [RFC 401][rfc401], if you have a function declaration `foo`:\n \n ```\n+struct S;\n+\n // For the purposes of this explanation, all of these\n // different kinds of `fn` declarations are equivalent:\n-struct S;\n+\n fn foo(x: S) { /* ... */ }\n # #[cfg(for_demonstration_only)]\n-extern \"C\" { fn foo(x: S); }\n+extern \"C\" {\n+    fn foo(x: S);\n+}\n # #[cfg(for_demonstration_only)]\n-impl S { fn foo(self) { /* ... */ } }\n+impl S {\n+    fn foo(self) { /* ... */ }\n+}\n ```\n \n the type of `foo` is **not** `fn(S)`, as one might expect.\n@@ -40,10 +46,10 @@ extern \"C\" fn foo(userdata: Box<i32>) {\n \n # fn callback(_: extern \"C\" fn(*mut i32)) {}\n # use std::mem::transmute;\n-# unsafe {\n-let f: extern \"C\" fn(*mut i32) = transmute(foo);\n-callback(f);\n-# }\n+unsafe {\n+    let f: extern \"C\" fn(*mut i32) = transmute(foo);\n+    callback(f);\n+}\n ```\n \n Here, transmute is being used to convert the types of the fn arguments."}, {"sha": "62f1a7f98ea1679bc839d7c6acf619cbff49389f", "filename": "src/test/ui/explain.stdout", "status": "modified", "additions": 13, "deletions": 5, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/208d680f771601cf5efb6a7bfb49cb2b9e655d3e/src%2Ftest%2Fui%2Fexplain.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/208d680f771601cf5efb6a7bfb49cb2b9e655d3e/src%2Ftest%2Fui%2Fexplain.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fexplain.stdout?ref=208d680f771601cf5efb6a7bfb49cb2b9e655d3e", "patch": "@@ -1,12 +1,18 @@\n Per [RFC 401][rfc401], if you have a function declaration `foo`:\n \n ```\n+struct S;\n+\n // For the purposes of this explanation, all of these\n // different kinds of `fn` declarations are equivalent:\n-struct S;\n+\n fn foo(x: S) { /* ... */ }\n-extern \"C\" { fn foo(x: S); }\n-impl S { fn foo(self) { /* ... */ } }\n+extern \"C\" {\n+    fn foo(x: S);\n+}\n+impl S {\n+    fn foo(self) { /* ... */ }\n+}\n ```\n \n the type of `foo` is **not** `fn(S)`, as one might expect.\n@@ -34,8 +40,10 @@ extern \"C\" fn foo(userdata: Box<i32>) {\n     /* ... */\n }\n \n-let f: extern \"C\" fn(*mut i32) = transmute(foo);\n-callback(f);\n+unsafe {\n+    let f: extern \"C\" fn(*mut i32) = transmute(foo);\n+    callback(f);\n+}\n ```\n \n Here, transmute is being used to convert the types of the fn arguments."}]}