{"sha": "397cfaec0ce28289b0ab04ed6f6c3ba6ee1042ea", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM5N2NmYWVjMGNlMjgyODliMGFiMDRlZDZmNmMzYmE2ZWUxMDQyZWE=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2016-05-29T02:19:27Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2016-05-29T02:19:27Z"}, "message": "Auto merge of #33848 - alexcrichton:android-gdb-sysroot, r=michaelwoerister\n\ntest: Use `set sysroot` for more NDK compatibility\n\nRecent versions of the Android NDK no longer ship debuggers like\n`arm-linux-androideabi-gdb`, but instead one prebuilt binary `gdb`. We can\nsymlink this into place at least to get our detection still working, but it now\nneeds to be told what the sysroot is so it can correctly do... something. Long\nstory short, tests didn't pass with this change and after this change they pass.", "tree": {"sha": "3f7bbfc11d945a9a51e3a3edee46f7522aaad4c3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3f7bbfc11d945a9a51e3a3edee46f7522aaad4c3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/397cfaec0ce28289b0ab04ed6f6c3ba6ee1042ea", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/397cfaec0ce28289b0ab04ed6f6c3ba6ee1042ea", "html_url": "https://github.com/rust-lang/rust/commit/397cfaec0ce28289b0ab04ed6f6c3ba6ee1042ea", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/397cfaec0ce28289b0ab04ed6f6c3ba6ee1042ea/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7746a334da364e5e4c25360cd52e97691cbddc08", "url": "https://api.github.com/repos/rust-lang/rust/commits/7746a334da364e5e4c25360cd52e97691cbddc08", "html_url": "https://github.com/rust-lang/rust/commit/7746a334da364e5e4c25360cd52e97691cbddc08"}, {"sha": "0f3e8650f7f5a2658b639a3b84ee2946dd1fd98d", "url": "https://api.github.com/repos/rust-lang/rust/commits/0f3e8650f7f5a2658b639a3b84ee2946dd1fd98d", "html_url": "https://github.com/rust-lang/rust/commit/0f3e8650f7f5a2658b639a3b84ee2946dd1fd98d"}], "stats": {"total": 11, "additions": 6, "deletions": 5}, "files": [{"sha": "953e060465a95f6a63dbeed742d6c4265c21c8d7", "filename": "src/tools/compiletest/src/runtest.rs", "status": "modified", "additions": 6, "deletions": 5, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/397cfaec0ce28289b0ab04ed6f6c3ba6ee1042ea/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/397cfaec0ce28289b0ab04ed6f6c3ba6ee1042ea/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs?ref=397cfaec0ce28289b0ab04ed6f6c3ba6ee1042ea", "patch": "@@ -440,9 +440,15 @@ actual:\\n\\\n \n                 cmds = cmds.replace(\"run\", \"continue\");\n \n+                let tool_path = match self.config.android_cross_path.to_str() {\n+                    Some(x) => x.to_owned(),\n+                    None => self.fatal(\"cannot find android cross path\")\n+                };\n+\n                 // write debugger script\n                 let mut script_str = String::with_capacity(2048);\n                 script_str.push_str(&format!(\"set charset {}\\n\", Self::charset()));\n+                script_str.push_str(&format!(\"set sysroot {}\\n\", tool_path));\n                 script_str.push_str(&format!(\"file {}\\n\", exe_file.to_str().unwrap()));\n                 script_str.push_str(\"target remote :5039\\n\");\n                 script_str.push_str(&format!(\"set solib-search-path \\\n@@ -515,11 +521,6 @@ actual:\\n\\\n                     }\n                 }\n \n-                let tool_path = match self.config.android_cross_path.to_str() {\n-                    Some(x) => x.to_owned(),\n-                    None => self.fatal(\"cannot find android cross path\")\n-                };\n-\n                 let debugger_script = self.make_out_name(\"debugger.script\");\n                 // FIXME (#9639): This needs to handle non-utf8 paths\n                 let debugger_opts ="}]}