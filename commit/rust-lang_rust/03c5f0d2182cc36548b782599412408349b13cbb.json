{"sha": "03c5f0d2182cc36548b782599412408349b13cbb", "node_id": "C_kwDOAAsO6NoAKDAzYzVmMGQyMTgyY2MzNjU0OGI3ODI1OTk0MTI0MDgzNDliMTNjYmI", "commit": {"author": {"name": "Alec Goncharow", "email": "algo@cloudflare.com", "date": "2022-03-29T16:45:54Z"}, "committer": {"name": "Alec Goncharow", "email": "algo@cloudflare.com", "date": "2022-03-29T18:59:56Z"}, "message": "bootstrap: force system python3 on MacOS", "tree": {"sha": "575740cb9a7b9580920254bffd8e94eb02201918", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/575740cb9a7b9580920254bffd8e94eb02201918"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/03c5f0d2182cc36548b782599412408349b13cbb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/03c5f0d2182cc36548b782599412408349b13cbb", "html_url": "https://github.com/rust-lang/rust/commit/03c5f0d2182cc36548b782599412408349b13cbb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/03c5f0d2182cc36548b782599412408349b13cbb/comments", "author": {"login": "AlecGoncharow", "id": 35583039, "node_id": "MDQ6VXNlcjM1NTgzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/35583039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AlecGoncharow", "html_url": "https://github.com/AlecGoncharow", "followers_url": "https://api.github.com/users/AlecGoncharow/followers", "following_url": "https://api.github.com/users/AlecGoncharow/following{/other_user}", "gists_url": "https://api.github.com/users/AlecGoncharow/gists{/gist_id}", "starred_url": "https://api.github.com/users/AlecGoncharow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AlecGoncharow/subscriptions", "organizations_url": "https://api.github.com/users/AlecGoncharow/orgs", "repos_url": "https://api.github.com/users/AlecGoncharow/repos", "events_url": "https://api.github.com/users/AlecGoncharow/events{/privacy}", "received_events_url": "https://api.github.com/users/AlecGoncharow/received_events", "type": "User", "site_admin": false}, "committer": {"login": "AlecGoncharow", "id": 35583039, "node_id": "MDQ6VXNlcjM1NTgzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/35583039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AlecGoncharow", "html_url": "https://github.com/AlecGoncharow", "followers_url": "https://api.github.com/users/AlecGoncharow/followers", "following_url": "https://api.github.com/users/AlecGoncharow/following{/other_user}", "gists_url": "https://api.github.com/users/AlecGoncharow/gists{/gist_id}", "starred_url": "https://api.github.com/users/AlecGoncharow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AlecGoncharow/subscriptions", "organizations_url": "https://api.github.com/users/AlecGoncharow/orgs", "repos_url": "https://api.github.com/users/AlecGoncharow/repos", "events_url": "https://api.github.com/users/AlecGoncharow/events{/privacy}", "received_events_url": "https://api.github.com/users/AlecGoncharow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b3ff4835befc318f59ece942923ce55e4b2f1aa5", "url": "https://api.github.com/repos/rust-lang/rust/commits/b3ff4835befc318f59ece942923ce55e4b2f1aa5", "html_url": "https://github.com/rust-lang/rust/commit/b3ff4835befc318f59ece942923ce55e4b2f1aa5"}], "stats": {"total": 21, "additions": 12, "deletions": 9}, "files": [{"sha": "0736c4464b937cc374438e6658c88c4bce5d632b", "filename": "src/bootstrap/lib.rs", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/03c5f0d2182cc36548b782599412408349b13cbb/src%2Fbootstrap%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/03c5f0d2182cc36548b782599412408349b13cbb/src%2Fbootstrap%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Flib.rs?ref=03c5f0d2182cc36548b782599412408349b13cbb", "patch": "@@ -1167,7 +1167,17 @@ impl Build {\n \n     /// Path to the python interpreter to use\n     fn python(&self) -> &Path {\n-        self.config.python.as_ref().unwrap()\n+        if self.config.build.ends_with(\"apple-darwin\") {\n+            // Force /usr/bin/python3 on macOS for LLDB tests because we're loading the\n+            // LLDB plugin's compiled module which only works with the system python\n+            // (namely not Homebrew-installed python)\n+            Path::new(\"/usr/bin/python3\")\n+        } else {\n+            self.config\n+                .python\n+                .as_ref()\n+                .expect(\"python is required for running LLDB or rustdoc tests\")\n+        }\n     }\n \n     /// Temporary directory that extended error information is emitted to."}, {"sha": "00ede2140a693ae897f72a64966901473e75284a", "filename": "src/bootstrap/test.rs", "status": "modified", "additions": 1, "deletions": 8, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/03c5f0d2182cc36548b782599412408349b13cbb/src%2Fbootstrap%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/03c5f0d2182cc36548b782599412408349b13cbb/src%2Fbootstrap%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftest.rs?ref=03c5f0d2182cc36548b782599412408349b13cbb", "patch": "@@ -1403,14 +1403,7 @@ note: if you're sure you want to do this, please open an issue as to why. In the\n \n         cmd.arg(\"--docck-python\").arg(builder.python());\n \n-        if builder.config.build.ends_with(\"apple-darwin\") {\n-            // Force /usr/bin/python3 on macOS for LLDB tests because we're loading the\n-            // LLDB plugin's compiled module which only works with the system python\n-            // (namely not Homebrew-installed python)\n-            cmd.arg(\"--lldb-python\").arg(\"/usr/bin/python3\");\n-        } else {\n-            cmd.arg(\"--lldb-python\").arg(builder.python());\n-        }\n+        cmd.arg(\"--lldb-python\").arg(builder.python());\n \n         if let Some(ref gdb) = builder.config.gdb {\n             cmd.arg(\"--gdb\").arg(gdb);"}]}