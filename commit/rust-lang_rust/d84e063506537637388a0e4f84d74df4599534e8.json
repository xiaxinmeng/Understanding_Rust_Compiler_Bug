{"sha": "d84e063506537637388a0e4f84d74df4599534e8", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ4NGUwNjM1MDY1Mzc2MzczODhhMGU0Zjg0ZDc0ZGY0NTk5NTM0ZTg=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-03-16T06:56:48Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-03-16T14:40:19Z"}, "message": "Rollup merge of #59147 - jethrogb:jb/time-tests, r=sfackler\n\nMake std time tests more robust for platform differences\n\nPreviously, `time::tests::since_epoch` and `time::tests::system_time_math` would fail if the platform represents a SystemTime as unix epoch + `u64` nanoseconds.\n\nr? @sfackler", "tree": {"sha": "6b34d7576111e5de3d759f395670f5b7e7099787", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6b34d7576111e5de3d759f395670f5b7e7099787"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d84e063506537637388a0e4f84d74df4599534e8", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlyNCtQACgkQ/vbIBR0O\nATyBqxAAi8gE4RTMUCWKoYPUDQPFOBoV48wcFswaAUVDqRiUdYm/qZ4cbbZzLNaC\n0HUH7Gne0BRZS+yf9jYIMYqSQtvSbaeuXvFBEAlmRQScZdYML448qWf0opTC9trk\n0l+Ee02ycifaPzZhNOMT7TtQO82N9UvpD9bog33AXI13Mp1AaBdFi0KvCOiCjVO3\nBSiKRUSUmub5wbzffn/Ng7zcNhdzosx1xF2mben4tEe2Clt+cRL8OTU+ZwodefBK\nC4YOBSM3+IQUkYQJxDP1V10Ntuaa6TeArYEwAAjM98WE84xYtITTvP/+QjnqBZfO\nAxUdshLHTh7OMXHQNFZqnLONLudWjF5Pq9MZ+664uX7Iba6RsQI6qzSco2/EUths\nhA3mENZAzhbl2WiyVaHc65DRVDpM0ShFIRPCgErXFhZZeMQg9zgDMQNpvBg81r42\nfRXdtAK9z8CDAK1APsdKJ2hWC1qDT4k1p5hC1+YmPgRaiJ3bUWjyduGNS9OWkgA6\nWmu/H+3RoUgpZISGMZUF0NhZURzZhL6RV0Wyn2byG4GMKg9TaMK6WLUO9PNLJAfp\njGbhK86NT5d1scQvs5sjDCkTEgQfPGzOePSKLNv5PJdCd/uIuQDlQEOfQ5sBB147\nWCkv0zP0Fng3GkQpbFwW3w2qqEobK7/Y5aZgBfIkI2+xPPd271Y=\n=BzyJ\n-----END PGP SIGNATURE-----", "payload": "tree 6b34d7576111e5de3d759f395670f5b7e7099787\nparent bbe5f3d08b780940bf9c8c25cadc6a377e3258a5\nparent adbd0a66457159ffcdd02ee0b553581298968847\nauthor kennytm <kennytm@gmail.com> 1552719408 +0800\ncommitter kennytm <kennytm@gmail.com> 1552747219 +0800\n\nRollup merge of #59147 - jethrogb:jb/time-tests, r=sfackler\n\nMake std time tests more robust for platform differences\n\nPreviously, `time::tests::since_epoch` and `time::tests::system_time_math` would fail if the platform represents a SystemTime as unix epoch + `u64` nanoseconds.\n\nr? @sfackler\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d84e063506537637388a0e4f84d74df4599534e8", "html_url": "https://github.com/rust-lang/rust/commit/d84e063506537637388a0e4f84d74df4599534e8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d84e063506537637388a0e4f84d74df4599534e8/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bbe5f3d08b780940bf9c8c25cadc6a377e3258a5", "url": "https://api.github.com/repos/rust-lang/rust/commits/bbe5f3d08b780940bf9c8c25cadc6a377e3258a5", "html_url": "https://github.com/rust-lang/rust/commit/bbe5f3d08b780940bf9c8c25cadc6a377e3258a5"}, {"sha": "adbd0a66457159ffcdd02ee0b553581298968847", "url": "https://api.github.com/repos/rust-lang/rust/commits/adbd0a66457159ffcdd02ee0b553581298968847", "html_url": "https://github.com/rust-lang/rust/commit/adbd0a66457159ffcdd02ee0b553581298968847"}], "stats": {"total": 11, "additions": 2, "deletions": 9}, "files": [{"sha": "4c86f70ad871d6df5617bc4828ab5f7513081a56", "filename": "src/libstd/time.rs", "status": "modified", "additions": 2, "deletions": 9, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/d84e063506537637388a0e4f84d74df4599534e8/src%2Flibstd%2Ftime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d84e063506537637388a0e4f84d74df4599534e8/src%2Flibstd%2Ftime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Ftime.rs?ref=d84e063506537637388a0e4f84d74df4599534e8", "patch": "@@ -712,13 +712,6 @@ mod tests {\n         assert_almost_eq!(a - second + second, a);\n         assert_almost_eq!(a.checked_sub(second).unwrap().checked_add(second).unwrap(), a);\n \n-        // A difference of 80 and 800 years cannot fit inside a 32-bit time_t\n-        if !(cfg!(unix) && crate::mem::size_of::<libc::time_t>() <= 4) {\n-            let eighty_years = second * 60 * 60 * 24 * 365 * 80;\n-            assert_almost_eq!(a - eighty_years + eighty_years, a);\n-            assert_almost_eq!(a - (eighty_years * 10) + (eighty_years * 10), a);\n-        }\n-\n         let one_second_from_epoch = UNIX_EPOCH + Duration::new(1, 0);\n         let one_second_from_epoch2 = UNIX_EPOCH + Duration::new(0, 500_000_000)\n             + Duration::new(0, 500_000_000);\n@@ -747,8 +740,8 @@ mod tests {\n     #[test]\n     fn since_epoch() {\n         let ts = SystemTime::now();\n-        let a = ts.duration_since(UNIX_EPOCH).unwrap();\n-        let b = ts.duration_since(UNIX_EPOCH - Duration::new(1, 0)).unwrap();\n+        let a = ts.duration_since(UNIX_EPOCH + Duration::new(1, 0)).unwrap();\n+        let b = ts.duration_since(UNIX_EPOCH).unwrap();\n         assert!(b > a);\n         assert_eq!(b - a, Duration::new(1, 0));\n "}]}