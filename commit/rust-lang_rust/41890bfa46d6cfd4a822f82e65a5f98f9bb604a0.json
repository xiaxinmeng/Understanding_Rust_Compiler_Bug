{"sha": "41890bfa46d6cfd4a822f82e65a5f98f9bb604a0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQxODkwYmZhNDZkNmNmZDRhODIyZjgyZTY1YTVmOThmOWJiNjA0YTA=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2015-01-21T17:13:43Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2015-01-21T17:13:43Z"}, "message": "rollup merge of #21274: estsauver/21270\n\nThe timezone of the server that builds rustc nightlies\nappears to be in UTC. From what I can tell, it builds\nthe nightlies at 0300 UTC, which takes about ~15 minutes.\nSo, there were a couple options here for which offset to use.\n\nUTC+3 would ensure that you always got the latest rust, but it\nwould mean the script is broken ~15/20 minutes a day. UTC+4\nmeans users get a stale nightly for 45 minutes, but that feels\nokay to me.\n\nIdeally, buildbot would publish the \"current\" nightly, but\nthat seems unneeded relative to fixing it for all Timezones\nquickly.\n\nFixes #21270", "tree": {"sha": "63eaab480dd1657569cba6eaa190b9965a824437", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/63eaab480dd1657569cba6eaa190b9965a824437"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/41890bfa46d6cfd4a822f82e65a5f98f9bb604a0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/41890bfa46d6cfd4a822f82e65a5f98f9bb604a0", "html_url": "https://github.com/rust-lang/rust/commit/41890bfa46d6cfd4a822f82e65a5f98f9bb604a0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/41890bfa46d6cfd4a822f82e65a5f98f9bb604a0/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "89b2e231c6d62b9d0052d1a42ebe18fbce9546e8", "url": "https://api.github.com/repos/rust-lang/rust/commits/89b2e231c6d62b9d0052d1a42ebe18fbce9546e8", "html_url": "https://github.com/rust-lang/rust/commit/89b2e231c6d62b9d0052d1a42ebe18fbce9546e8"}, {"sha": "c034f4a44a4b3d69f4f7f2efeecb5f9742ec0d24", "url": "https://api.github.com/repos/rust-lang/rust/commits/c034f4a44a4b3d69f4f7f2efeecb5f9742ec0d24", "html_url": "https://github.com/rust-lang/rust/commit/c034f4a44a4b3d69f4f7f2efeecb5f9742ec0d24"}], "stats": {"total": 11, "additions": 8, "deletions": 3}, "files": [{"sha": "07e832d317adb2f91f098e960865e84d18e085fd", "filename": "src/etc/rustup.sh", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/41890bfa46d6cfd4a822f82e65a5f98f9bb604a0/src%2Fetc%2Frustup.sh", "raw_url": "https://github.com/rust-lang/rust/raw/41890bfa46d6cfd4a822f82e65a5f98f9bb604a0/src%2Fetc%2Frustup.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Frustup.sh?ref=41890bfa46d6cfd4a822f82e65a5f98f9bb604a0", "patch": "@@ -433,11 +433,16 @@ CFG_TMP_DIR=$(mktemp -d 2>/dev/null \\\n            || mktemp -d -t 'rustup-tmp-install' 2>/dev/null \\\n            || create_tmp_dir)\n \n-# If we're saving nightlies and we didn't specify which one, grab todays.\n-# Otherwise we'll use the latest version.\n+# If we're saving nightlies and we didn't specify which one, grab the latest\n+# verison from the perspective of the server. Buildbot has typically finished\n+# building and uploading by ~8UTC, but we want to include a little buffer.\n+#\n+# FIXME It would be better to use the known most recent nightly that has been\n+# built. This is waiting on a change to have buildbot publish metadata that\n+# can be queried.\n if [ -n \"${CFG_SAVE}\" -a -z \"${CFG_DATE}\" ];\n then\n-    CFG_DATE=`date \"+%Y-%m-%d\"`\n+    CFG_DATE=`TZ=Etc/UTC+9 date \"+%Y-%m-%d\"`\n fi\n \n RUST_URL=\"https://static.rust-lang.org/dist\""}]}