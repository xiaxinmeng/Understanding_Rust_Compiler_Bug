{"sha": "c3a71ede7cc459b84ddac53f3435391712fa1f12", "node_id": "C_kwDOAAsO6NoAKGMzYTcxZWRlN2NjNDU5Yjg0ZGRhYzUzZjM0MzUzOTE3MTJmYTFmMTI", "commit": {"author": {"name": "Aidan Olsen", "email": "a.olsen2024@icloud.com", "date": "2023-01-31T23:48:08Z"}, "committer": {"name": "Aidan Olsen", "email": "a.olsen2024@icloud.com", "date": "2023-02-02T19:46:31Z"}, "message": "Emit warnings on unused parens/braces in index expressions", "tree": {"sha": "413130f71b823817ec5451dda21b82b8f51df727", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/413130f71b823817ec5451dda21b82b8f51df727"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c3a71ede7cc459b84ddac53f3435391712fa1f12", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c3a71ede7cc459b84ddac53f3435391712fa1f12", "html_url": "https://github.com/rust-lang/rust/commit/c3a71ede7cc459b84ddac53f3435391712fa1f12", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c3a71ede7cc459b84ddac53f3435391712fa1f12/comments", "author": {"login": "PossiblyAShrub", "id": 46799759, "node_id": "MDQ6VXNlcjQ2Nzk5NzU5", "avatar_url": "https://avatars.githubusercontent.com/u/46799759?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PossiblyAShrub", "html_url": "https://github.com/PossiblyAShrub", "followers_url": "https://api.github.com/users/PossiblyAShrub/followers", "following_url": "https://api.github.com/users/PossiblyAShrub/following{/other_user}", "gists_url": "https://api.github.com/users/PossiblyAShrub/gists{/gist_id}", "starred_url": "https://api.github.com/users/PossiblyAShrub/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PossiblyAShrub/subscriptions", "organizations_url": "https://api.github.com/users/PossiblyAShrub/orgs", "repos_url": "https://api.github.com/users/PossiblyAShrub/repos", "events_url": "https://api.github.com/users/PossiblyAShrub/events{/privacy}", "received_events_url": "https://api.github.com/users/PossiblyAShrub/received_events", "type": "User", "site_admin": false}, "committer": {"login": "PossiblyAShrub", "id": 46799759, "node_id": "MDQ6VXNlcjQ2Nzk5NzU5", "avatar_url": "https://avatars.githubusercontent.com/u/46799759?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PossiblyAShrub", "html_url": "https://github.com/PossiblyAShrub", "followers_url": "https://api.github.com/users/PossiblyAShrub/followers", "following_url": "https://api.github.com/users/PossiblyAShrub/following{/other_user}", "gists_url": "https://api.github.com/users/PossiblyAShrub/gists{/gist_id}", "starred_url": "https://api.github.com/users/PossiblyAShrub/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PossiblyAShrub/subscriptions", "organizations_url": "https://api.github.com/users/PossiblyAShrub/orgs", "repos_url": "https://api.github.com/users/PossiblyAShrub/repos", "events_url": "https://api.github.com/users/PossiblyAShrub/events{/privacy}", "received_events_url": "https://api.github.com/users/PossiblyAShrub/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dc1d9d50fba2f6a1ccab8748a0050cde38253f60", "url": "https://api.github.com/repos/rust-lang/rust/commits/dc1d9d50fba2f6a1ccab8748a0050cde38253f60", "html_url": "https://github.com/rust-lang/rust/commit/dc1d9d50fba2f6a1ccab8748a0050cde38253f60"}], "stats": {"total": 45, "additions": 45, "deletions": 0}, "files": [{"sha": "d829ca43328fe651422bf31ad61ef2e955bbfe9c", "filename": "compiler/rustc_lint/src/unused.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c3a71ede7cc459b84ddac53f3435391712fa1f12/compiler%2Frustc_lint%2Fsrc%2Funused.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c3a71ede7cc459b84ddac53f3435391712fa1f12/compiler%2Frustc_lint%2Fsrc%2Funused.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Funused.rs?ref=c3a71ede7cc459b84ddac53f3435391712fa1f12", "patch": "@@ -495,6 +495,7 @@ enum UnusedDelimsCtx {\n     ArrayLenExpr,\n     AnonConst,\n     MatchArmExpr,\n+    IndexExpr,\n }\n \n impl From<UnusedDelimsCtx> for &'static str {\n@@ -514,6 +515,7 @@ impl From<UnusedDelimsCtx> for &'static str {\n             UnusedDelimsCtx::LetScrutineeExpr => \"`let` scrutinee expression\",\n             UnusedDelimsCtx::ArrayLenExpr | UnusedDelimsCtx::AnonConst => \"const expression\",\n             UnusedDelimsCtx::MatchArmExpr => \"match arm expression\",\n+            UnusedDelimsCtx::IndexExpr => \"index expression\",\n         }\n     }\n }\n@@ -733,6 +735,8 @@ trait UnusedDelimLint {\n                 (value, UnusedDelimsCtx::ReturnValue, false, Some(left), None)\n             }\n \n+            Index(_, ref value) => (value, UnusedDelimsCtx::IndexExpr, false, None, None),\n+\n             Assign(_, ref value, _) | AssignOp(.., ref value) => {\n                 (value, UnusedDelimsCtx::AssignedValue, false, None, None)\n             }"}, {"sha": "4e7c290fa2a0200602b2c975adac7696537b4ce6", "filename": "tests/ui/lint/unused/issue-96606.rs", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/c3a71ede7cc459b84ddac53f3435391712fa1f12/tests%2Fui%2Flint%2Funused%2Fissue-96606.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c3a71ede7cc459b84ddac53f3435391712fa1f12/tests%2Fui%2Flint%2Funused%2Fissue-96606.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flint%2Funused%2Fissue-96606.rs?ref=c3a71ede7cc459b84ddac53f3435391712fa1f12", "patch": "@@ -0,0 +1,8 @@\n+#[deny(unused)]\n+fn main() {\n+    let arr = [0; 10];\n+    let _ = arr[(0)]; //~ ERROR unnecessary parentheses around index expression\n+    let _ = arr[{0}]; //~ ERROR unnecessary braces around index expression\n+    let _ = arr[1 + (0)];\n+    let _ = arr[{ let x = 0; x }];\n+}"}, {"sha": "e3627718116be11e01b5eba929532aeff856e4c8", "filename": "tests/ui/lint/unused/issue-96606.stderr", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/c3a71ede7cc459b84ddac53f3435391712fa1f12/tests%2Fui%2Flint%2Funused%2Fissue-96606.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c3a71ede7cc459b84ddac53f3435391712fa1f12/tests%2Fui%2Flint%2Funused%2Fissue-96606.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flint%2Funused%2Fissue-96606.stderr?ref=c3a71ede7cc459b84ddac53f3435391712fa1f12", "patch": "@@ -0,0 +1,33 @@\n+error: unnecessary parentheses around index expression\n+  --> $DIR/issue-96606.rs:4:17\n+   |\n+LL |     let _ = arr[(0)];\n+   |                 ^ ^\n+   |\n+note: the lint level is defined here\n+  --> $DIR/issue-96606.rs:1:8\n+   |\n+LL | #[deny(unused)]\n+   |        ^^^^^^\n+   = note: `#[deny(unused_parens)]` implied by `#[deny(unused)]`\n+help: remove these parentheses\n+   |\n+LL -     let _ = arr[(0)];\n+LL +     let _ = arr[0];\n+   |\n+\n+error: unnecessary braces around index expression\n+  --> $DIR/issue-96606.rs:5:17\n+   |\n+LL |     let _ = arr[{0}];\n+   |                 ^ ^\n+   |\n+   = note: `#[deny(unused_braces)]` implied by `#[deny(unused)]`\n+help: remove these braces\n+   |\n+LL -     let _ = arr[{0}];\n+LL +     let _ = arr[0];\n+   |\n+\n+error: aborting due to 2 previous errors\n+"}]}