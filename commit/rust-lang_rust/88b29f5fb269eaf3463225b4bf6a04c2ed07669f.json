{"sha": "88b29f5fb269eaf3463225b4bf6a04c2ed07669f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg4YjI5ZjVmYjI2OWVhZjM0NjMyMjViNGJmNmEwNGMyZWQwNzY2OWY=", "commit": {"author": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2021-07-10T07:58:16Z"}, "committer": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2021-07-10T12:54:50Z"}, "message": "Test for misusing attribute", "tree": {"sha": "d2f2304da62dac1c8e9fe8fb5c193036de02ad9d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d2f2304da62dac1c8e9fe8fb5c193036de02ad9d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/88b29f5fb269eaf3463225b4bf6a04c2ed07669f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEjbeLZzPb62/vY3smZSV3NIU3bZIFAmDpmJsACgkQZSV3NIU3\nbZLZlA/9F5OC/3EznoOojZ0Ir7V+RYk1ZBCQeFXhyTmKfuEQXB9RdZ5pQhNY0kq9\nzR8XGR+nc4NG76u5whYZpLJ1h83DrKOMJHkYgGi2NcO+bu0JwFSNmFWoXXIayLO4\ngKwUd4LJg8zgGZxIIKW+CWN4+4dQvj6X1bgdBQG4YY1Yl9wdohLU82wzr81dawQo\nN7QXE0/EcnG1xbV3I1CkfskTwyQ35hb9pV+afWcqqDhcoGa7bDBXjt3K2r58IGUf\nxeYK7Kr++XlcSEio5OyEAIOez3ZuZm0kzLe89UfxzuO3/qMWnyvRWkqd2OEhEpa+\n7tOL80WThDYSHkGSB71U+fdaLniCxRlCLe6F3xr19NOVlRTm9ORkIZLy0PisZAYZ\nrpxbp0QaZjb54dEjv6zE1wziawMTc9wAYcwce2IIRE0S91g6uLa6AWmqWslwhVNP\nOG3FbkiFw583IpJwpRueHqaDPoJmXGgNkV4rFovqOQ+A/XBpQ4t1+FjpzLHd9pja\nTFQyPG9KgWD+w5C7/9TrQrt6KuZaQUCkmYz4YMvCzRLTk0ncfKnXOjWUTwawaSmp\nLS+j/jntFeWgpFjnH4Nfqni7kn93kp0nlCgLXwiyIiWGpNZ9yGnOptEPrkr6HDsI\nWpMnzW2d2tgmT47MurA+kVU917QAcNuiVC+yJ9kjGaUwv5kAOjo=\n=f66Y\n-----END PGP SIGNATURE-----", "payload": "tree d2f2304da62dac1c8e9fe8fb5c193036de02ad9d\nparent a79e08ca2ab4fcc2fd32296e652b62deef0f7c64\nauthor Deadbeef <ent3rm4n@gmail.com> 1625903896 +0800\ncommitter Deadbeef <ent3rm4n@gmail.com> 1625921690 +0800\n\nTest for misusing attribute\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/88b29f5fb269eaf3463225b4bf6a04c2ed07669f", "html_url": "https://github.com/rust-lang/rust/commit/88b29f5fb269eaf3463225b4bf6a04c2ed07669f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/88b29f5fb269eaf3463225b4bf6a04c2ed07669f/comments", "author": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a79e08ca2ab4fcc2fd32296e652b62deef0f7c64", "url": "https://api.github.com/repos/rust-lang/rust/commits/a79e08ca2ab4fcc2fd32296e652b62deef0f7c64", "html_url": "https://github.com/rust-lang/rust/commit/a79e08ca2ab4fcc2fd32296e652b62deef0f7c64"}], "stats": {"total": 48, "additions": 47, "deletions": 1}, "files": [{"sha": "c3b13278c009b31422fe863ab596a5aed2657a65", "filename": "compiler/rustc_middle/src/query/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/88b29f5fb269eaf3463225b4bf6a04c2ed07669f/compiler%2Frustc_middle%2Fsrc%2Fquery%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/88b29f5fb269eaf3463225b4bf6a04c2ed07669f/compiler%2Frustc_middle%2Fsrc%2Fquery%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fquery%2Fmod.rs?ref=88b29f5fb269eaf3463225b4bf6a04c2ed07669f", "patch": "@@ -1137,7 +1137,7 @@ rustc_queries! {\n     }\n \n     query impl_constness(def_id: DefId) -> hir::Constness {\n-        desc { |tcx| \"looking up whether `{}` is a default impl\", tcx.def_path_str(def_id) }\n+        desc { |tcx| \"looking up whether `{}` is a const impl\", tcx.def_path_str(def_id) }\n     }\n \n     query check_item_well_formed(key: LocalDefId) -> () {"}, {"sha": "338ac3d25053635ec6fe0a4fd65c54b2a703d0e4", "filename": "src/test/ui/rfc-2632-const-trait-impl/attr-misuse.rs", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/88b29f5fb269eaf3463225b4bf6a04c2ed07669f/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fattr-misuse.rs", "raw_url": "https://github.com/rust-lang/rust/raw/88b29f5fb269eaf3463225b4bf6a04c2ed07669f/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fattr-misuse.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fattr-misuse.rs?ref=88b29f5fb269eaf3463225b4bf6a04c2ed07669f", "patch": "@@ -0,0 +1,14 @@\n+#![feature(const_trait_impl)]\n+#![allow(incomplete_features)]\n+\n+#[default_method_body_is_const] //~ ERROR attribute should be applied\n+trait A {\n+    #[default_method_body_is_const] //~ ERROR attribute should be applied\n+    fn no_body(self);\n+\n+    #[default_method_body_is_const]\n+    fn correct_use(&self) {}\n+}\n+\n+#[default_method_body_is_const] //~ ERROR attribute should be applied\n+fn main() {}"}, {"sha": "3af71d6ff78fb016c0e80a46d8bfba29bcf84ea5", "filename": "src/test/ui/rfc-2632-const-trait-impl/attr-misuse.stderr", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/88b29f5fb269eaf3463225b4bf6a04c2ed07669f/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fattr-misuse.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/88b29f5fb269eaf3463225b4bf6a04c2ed07669f/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fattr-misuse.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fattr-misuse.stderr?ref=88b29f5fb269eaf3463225b4bf6a04c2ed07669f", "patch": "@@ -0,0 +1,32 @@\n+error: attribute should be applied to a trait method with body\n+  --> $DIR/attr-misuse.rs:4:1\n+   |\n+LL |   #[default_method_body_is_const]\n+   |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL | / trait A {\n+LL | |     #[default_method_body_is_const]\n+LL | |     fn no_body(self);\n+LL | |\n+LL | |     #[default_method_body_is_const]\n+LL | |     fn correct_use(&self) {}\n+LL | | }\n+   | |_- not a trait method or missing a body\n+\n+error: attribute should be applied to a trait method with body\n+  --> $DIR/attr-misuse.rs:13:1\n+   |\n+LL | #[default_method_body_is_const]\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL | fn main() {}\n+   | ------------ not a trait method or missing a body\n+\n+error: attribute should be applied to a trait method with body\n+  --> $DIR/attr-misuse.rs:6:5\n+   |\n+LL |     #[default_method_body_is_const]\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |     fn no_body(self);\n+   |     ----------------- not a trait method or missing a body\n+\n+error: aborting due to 3 previous errors\n+"}]}