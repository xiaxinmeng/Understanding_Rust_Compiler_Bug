{"sha": "5ce2eb1bd80beb955110f0cb81a3694311ee9592", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVjZTJlYjFiZDgwYmViOTU1MTEwZjBjYjgxYTM2OTQzMTFlZTk1OTI=", "commit": {"author": {"name": "Venkata Giri Reddy", "email": "venkatagirireddy@gmail.com", "date": "2017-05-25T06:43:21Z"}, "committer": {"name": "Venkata Giri Reddy", "email": "venkatagirireddy@gmail.com", "date": "2017-05-25T06:43:21Z"}, "message": "use shared scripts for init and sccache in cross image", "tree": {"sha": "2fb877c82535a65140070f6fd19b2038f4045389", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2fb877c82535a65140070f6fd19b2038f4045389"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5ce2eb1bd80beb955110f0cb81a3694311ee9592", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5ce2eb1bd80beb955110f0cb81a3694311ee9592", "html_url": "https://github.com/rust-lang/rust/commit/5ce2eb1bd80beb955110f0cb81a3694311ee9592", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5ce2eb1bd80beb955110f0cb81a3694311ee9592/comments", "author": {"login": "venkatagiri", "id": 231465, "node_id": "MDQ6VXNlcjIzMTQ2NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/231465?v=4", "gravatar_id": "", "url": "https://api.github.com/users/venkatagiri", "html_url": "https://github.com/venkatagiri", "followers_url": "https://api.github.com/users/venkatagiri/followers", "following_url": "https://api.github.com/users/venkatagiri/following{/other_user}", "gists_url": "https://api.github.com/users/venkatagiri/gists{/gist_id}", "starred_url": "https://api.github.com/users/venkatagiri/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/venkatagiri/subscriptions", "organizations_url": "https://api.github.com/users/venkatagiri/orgs", "repos_url": "https://api.github.com/users/venkatagiri/repos", "events_url": "https://api.github.com/users/venkatagiri/events{/privacy}", "received_events_url": "https://api.github.com/users/venkatagiri/received_events", "type": "User", "site_admin": false}, "committer": {"login": "venkatagiri", "id": 231465, "node_id": "MDQ6VXNlcjIzMTQ2NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/231465?v=4", "gravatar_id": "", "url": "https://api.github.com/users/venkatagiri", "html_url": "https://github.com/venkatagiri", "followers_url": "https://api.github.com/users/venkatagiri/followers", "following_url": "https://api.github.com/users/venkatagiri/following{/other_user}", "gists_url": "https://api.github.com/users/venkatagiri/gists{/gist_id}", "starred_url": "https://api.github.com/users/venkatagiri/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/venkatagiri/subscriptions", "organizations_url": "https://api.github.com/users/venkatagiri/orgs", "repos_url": "https://api.github.com/users/venkatagiri/repos", "events_url": "https://api.github.com/users/venkatagiri/events{/privacy}", "received_events_url": "https://api.github.com/users/venkatagiri/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cf747fcbf716a8afced9d23aa15bb47d93805209", "url": "https://api.github.com/repos/rust-lang/rust/commits/cf747fcbf716a8afced9d23aa15bb47d93805209", "html_url": "https://github.com/rust-lang/rust/commit/cf747fcbf716a8afced9d23aa15bb47d93805209"}], "stats": {"total": 18, "additions": 10, "deletions": 8}, "files": [{"sha": "1037067332b81c52c753435bc832ee829741cf0c", "filename": "src/ci/docker/cross/Dockerfile", "status": "modified", "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/5ce2eb1bd80beb955110f0cb81a3694311ee9592/src%2Fci%2Fdocker%2Fcross%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/5ce2eb1bd80beb955110f0cb81a3694311ee9592/src%2Fci%2Fdocker%2Fcross%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fcross%2FDockerfile?ref=5ce2eb1bd80beb955110f0cb81a3694311ee9592", "patch": "@@ -21,14 +21,9 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   libssl-dev \\\n   pkg-config\n \n-RUN curl -o /usr/local/bin/sccache \\\n-      https://s3.amazonaws.com/rust-lang-ci/rust-ci-mirror/2017-05-12-sccache-x86_64-unknown-linux-musl && \\\n-      chmod +x /usr/local/bin/sccache\n-\n-RUN curl -OL https://github.com/Yelp/dumb-init/releases/download/v1.2.0/dumb-init_1.2.0_amd64.deb && \\\n-    dpkg -i dumb-init_*.deb && \\\n-    rm dumb-init_*.deb\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n+# dumb-init\n+COPY scripts/dumb-init.sh /scripts/\n+RUN sh /scripts/dumb-init.sh\n \n WORKDIR /tmp\n \n@@ -80,3 +75,10 @@ ENV RUST_CONFIGURE_ARGS \\\n       --musl-root-armhf=/usr/local/arm-linux-musleabihf \\\n       --musl-root-armv7=/usr/local/armv7-linux-musleabihf\n ENV SCRIPT python2.7 ../x.py dist --target $TARGETS\n+\n+# sccache\n+COPY scripts/sccache.sh /scripts/\n+RUN sh /scripts/sccache.sh\n+\n+# init\n+ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]"}]}