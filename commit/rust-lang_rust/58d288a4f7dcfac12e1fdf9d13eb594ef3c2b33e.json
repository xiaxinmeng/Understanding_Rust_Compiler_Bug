{"sha": "58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU4ZDI4OGE0ZjdkY2ZhYzEyZTFmZGY5ZDEzZWI1OTRlZjNjMmIzM2U=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-07-08T01:38:42Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-07-08T16:37:00Z"}, "message": "Move used_link_args from session to cstore", "tree": {"sha": "bbb2e15296964d159d59f5248deb7178f0fdf453", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bbb2e15296964d159d59f5248deb7178f0fdf453"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e", "html_url": "https://github.com/rust-lang/rust/commit/58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4bfa269fe7ce48c7cd54404b4f74c48e0e7895ea", "url": "https://api.github.com/repos/rust-lang/rust/commits/4bfa269fe7ce48c7cd54404b4f74c48e0e7895ea", "html_url": "https://github.com/rust-lang/rust/commit/4bfa269fe7ce48c7cd54404b4f74c48e0e7895ea"}], "stats": {"total": 22, "additions": 12, "deletions": 10}, "files": [{"sha": "bf62ce37d091d48c60a19ce99b87737f8d3c8a08", "filename": "src/comp/driver/rustc.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e/src%2Fcomp%2Fdriver%2Frustc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e/src%2Fcomp%2Fdriver%2Frustc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fdriver%2Frustc.rs?ref=58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e", "patch": "@@ -355,7 +355,7 @@ fn build_session(@session::options sopts) -> session::session {\n     auto target_cfg = build_target_config();\n     auto cstore = cstore::mk_cstore();\n     ret session::session(target_cfg, sopts, cstore,\n-                         [], codemap::new_codemap(), 0u);\n+                         codemap::new_codemap(), 0u);\n }\n \n fn parse_pretty(session::session sess, &str name) -> pp_mode {\n@@ -527,7 +527,7 @@ fn main(vec[str] args) {\n         gcc_args += [\"-l\" + libarg];\n     }\n \n-    gcc_args += sess.get_used_link_args();\n+    gcc_args += cstore::get_used_link_args(cstore);\n     auto used_libs = cstore::get_used_libraries(cstore);\n     for (str l in used_libs) {\n         gcc_args += [\"-l\" + l];"}, {"sha": "9d6aab7f56e2a3c4d1fab1f2c999f36da35a97a6", "filename": "src/comp/driver/session.rs", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e/src%2Fcomp%2Fdriver%2Fsession.rs", "raw_url": "https://github.com/rust-lang/rust/raw/58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e/src%2Fcomp%2Fdriver%2Fsession.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fdriver%2Fsession.rs?ref=58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e", "patch": "@@ -46,7 +46,6 @@ type crate_metadata = rec(str name, vec[u8] data);\n obj session(@config targ_cfg,\n             @options opts,\n             metadata::cstore::cstore cstore,\n-            mutable vec[str] used_link_args,\n             codemap::codemap cm,\n             mutable uint err_count) {\n     fn get_targ_cfg() -> @config { ret targ_cfg; }\n@@ -98,12 +97,6 @@ obj session(@config targ_cfg,\n         self.span_bug(sp, \"unimplemented \" + msg);\n     }\n     fn unimpl(str msg) -> ! { self.bug(\"unimplemented \" + msg); }\n-    fn add_used_link_args(&str args) {\n-        used_link_args += str::split(args, ' ' as u8);\n-    }\n-    fn get_used_link_args() -> vec[str] {\n-        ret used_link_args;\n-    }\n     fn get_codemap() -> codemap::codemap { ret cm; }\n     fn lookup_pos(uint pos) -> codemap::loc {\n         ret codemap::lookup_pos(cm, pos);"}, {"sha": "5af9688f4141d59b964d9f831fdf525b1ee8caae", "filename": "src/comp/metadata/creader.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e/src%2Fcomp%2Fmetadata%2Fcreader.rs", "raw_url": "https://github.com/rust-lang/rust/raw/58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e/src%2Fcomp%2Fmetadata%2Fcreader.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmetadata%2Fcreader.rs?ref=58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e", "patch": "@@ -188,7 +188,7 @@ fn visit_item(env e, &@ast::item i) {\n                      attr::find_attrs_by_name(i.attrs, \"link_args\")) {\n                 alt (attr::get_meta_item_value_str(attr::attr_meta(a))) {\n                     case (some(?linkarg)) {\n-                        e.sess.add_used_link_args(linkarg);\n+                        cstore::add_used_link_args(cstore, linkarg);\n                     }\n                     case (none) { /* fallthrough */ }\n                 }"}, {"sha": "dfde3eeed6e67d89ef8c3af9caba95e89085da91", "filename": "src/comp/metadata/cstore.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e/src%2Fcomp%2Fmetadata%2Fcstore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e/src%2Fcomp%2Fmetadata%2Fcstore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmetadata%2Fcstore.rs?ref=58d288a4f7dcfac12e1fdf9d13eb594ef3c2b33e", "patch": "@@ -1,5 +1,6 @@\n import std::map;\n import std::vec;\n+import std::str;\n \n type crate_metadata = rec(str name, vec[u8] data);\n \n@@ -53,6 +54,14 @@ fn get_used_libraries(&cstore cstore) -> vec[str] {\n     ret cstore.used_libraries;\n }\n \n+fn add_used_link_args(&cstore cstore, &str args) {\n+    cstore.used_link_args += str::split(args, ' ' as u8);\n+}\n+\n+fn get_used_link_args(&cstore cstore) -> vec[str] {\n+    ret cstore.used_link_args;\n+}\n+\n // Local Variables:\n // mode: rust\n // fill-column: 78;"}]}