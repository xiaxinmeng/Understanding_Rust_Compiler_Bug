{"sha": "9e49ac067f205e4400e85c98e35c2fe9af820d7d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjllNDlhYzA2N2YyMDVlNDQwMGU4NWM5OGUzNWMyZmU5YWY4MjBkN2Q=", "commit": {"author": {"name": "David Wood", "email": "david@davidtw.co", "date": "2018-10-05T12:30:45Z"}, "committer": {"name": "David Wood", "email": "david@davidtw.co", "date": "2018-10-08T10:26:56Z"}, "message": "Change from label to suggestion.\n\nThis commit changes the label to a maybe incorrect suggestion for better\nintegration with RLS.", "tree": {"sha": "c1136430add61c23f1791ca1fe39892186cafb80", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c1136430add61c23f1791ca1fe39892186cafb80"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9e49ac067f205e4400e85c98e35c2fe9af820d7d", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEWwgxPGhT5b/6kagXAXYLT59T8VQFAlu7MPAACgkQAXYLT59T\n8VTGrA//Y88PnjosmyDTf7M8h7GK7EcdOQiB+IMC4i8qFmyMnDvlDItTRkUzfY3E\n5YqPozPXFQAYCM4Uow27NT3tn1WAYn/RpaaRknrlsAO/faZo1kZ4UtVPbdNkp+Ff\nNefx1YCGrVtJote47PMlFxPVbCO+6wMT2ZYOms7Kdxga11gD3wSPLLZz5f0+aFvd\n/mscRyZ5VUB0X0CBIYDjCOwe8pJuVOIKcSYqMp9+vjO+ydH0zE1WRnIn535XaA5F\n4SYWEHF7MmgaO3go0tMw2f3O6q1bmAME/VUy2oR2MrdImC+3mcVaLhO1kIoRl3uY\nEHRw42uNFPh5GHbzT+ZtodBVvJZMN74G0JRBq2kyV0Bh5LhveJrAY9P+6ZnqEiJL\niZakyhiceWeN4gL5E7rUtAlh71PYcrXGEbCj/pwHMlqsBSnxLN89e7RcyfU2aPTP\n1uCpY9hLWG9ceqgpfYrckHqH2MqxW40nSbgeAWajTiKiEOvpih3oFZ52xNR4W5tv\nhX4KnVZ9F71YdF0KczKwp9r4cbpQ4u/kZcY74oprSQdRpbpnWhclGOw26JNojk1L\nRGDXnOLQCJMRrupV4uCEcnJcBly494Xtr3uS+r3TePzdUbY5CuSRnwUD+BOC7UPN\nWQfo8qu3UBrw3JzXGETgmx0AlVKJndIwIs2YCBNXTexc2qOZ5LM=\n=Ncjp\n-----END PGP SIGNATURE-----", "payload": "tree c1136430add61c23f1791ca1fe39892186cafb80\nparent f8c1b0cd5bdd603e7a0e1193f0dd7a6c9b0ebcc2\nauthor David Wood <david@davidtw.co> 1538742645 +0200\ncommitter David Wood <david@davidtw.co> 1538994416 +0200\n\nChange from label to suggestion.\n\nThis commit changes the label to a maybe incorrect suggestion for better\nintegration with RLS.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9e49ac067f205e4400e85c98e35c2fe9af820d7d", "html_url": "https://github.com/rust-lang/rust/commit/9e49ac067f205e4400e85c98e35c2fe9af820d7d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9e49ac067f205e4400e85c98e35c2fe9af820d7d/comments", "author": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f8c1b0cd5bdd603e7a0e1193f0dd7a6c9b0ebcc2", "url": "https://api.github.com/repos/rust-lang/rust/commits/f8c1b0cd5bdd603e7a0e1193f0dd7a6c9b0ebcc2", "html_url": "https://github.com/rust-lang/rust/commit/f8c1b0cd5bdd603e7a0e1193f0dd7a6c9b0ebcc2"}], "stats": {"total": 17, "additions": 10, "deletions": 7}, "files": [{"sha": "5ab1605d7f07ab404fc79d2ae791a68fe8a5412e", "filename": "src/librustc_mir/borrow_check/mutability_errors.rs", "status": "modified", "additions": 8, "deletions": 5, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/9e49ac067f205e4400e85c98e35c2fe9af820d7d/src%2Flibrustc_mir%2Fborrow_check%2Fmutability_errors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9e49ac067f205e4400e85c98e35c2fe9af820d7d/src%2Flibrustc_mir%2Fborrow_check%2Fmutability_errors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Fmutability_errors.rs?ref=9e49ac067f205e4400e85c98e35c2fe9af820d7d", "patch": "@@ -241,7 +241,12 @@ impl<'a, 'gcx, 'tcx> MirBorrowckCtxt<'a, 'gcx, 'tcx> {\n                     base.ty(self.mir, self.infcx.tcx).to_ty(self.infcx.tcx),\n                     field,\n                 ) {\n-                    err.span_label(span, message);\n+                    err.span_suggestion_with_applicability(\n+                        span,\n+                        \"consider changing this to be mutable\",\n+                        message,\n+                        Applicability::MaybeIncorrect,\n+                    );\n                 }\n             },\n \n@@ -636,8 +641,6 @@ fn annotate_struct_field(\n     if let ty::TyKind::Ref(_, ty, _) = ty.sty {\n         if let ty::TyKind::Adt(def, _) = ty.sty {\n             let field = def.all_fields().nth(field.index())?;\n-            let span = tcx.def_span(field.did);\n-\n             // Use the HIR types to construct the diagnostic message.\n             let node_id = tcx.hir.as_local_node_id(field.did)?;\n             let node = tcx.hir.find(node_id)?;\n@@ -659,9 +662,9 @@ fn annotate_struct_field(\n                     };\n \n                     return Some((\n-                        span,\n+                        field.ty.span,\n                         format!(\n-                            \"use `&{}mut {}` here to make mutable\",\n+                            \"&{}mut {}\",\n                             lifetime_snippet, &*type_snippet,\n                         ),\n                     ));"}, {"sha": "ebd44d46eb2ce544eb8e082a9e58dfc194d64ac0", "filename": "src/test/ui/did_you_mean/issue-38147-2.nll.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9e49ac067f205e4400e85c98e35c2fe9af820d7d/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-38147-2.nll.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/9e49ac067f205e4400e85c98e35c2fe9af820d7d/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-38147-2.nll.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-38147-2.nll.stderr?ref=9e49ac067f205e4400e85c98e35c2fe9af820d7d", "patch": "@@ -2,7 +2,7 @@ error[E0596]: cannot borrow `*self.s` as mutable, as it is behind a `&` referenc\n   --> $DIR/issue-38147-2.rs:17:9\n    |\n LL |     s: &'a String\n-   |     ------------- use `&'a mut String` here to make mutable\n+   |        ---------- help: consider changing this to be mutable: `&'a mut String`\n ...\n LL |         self.s.push('x');\n    |         ^^^^^^ cannot borrow as mutable"}, {"sha": "d644a84c7bbcec2da5723cf079f523f68c0746ae", "filename": "src/test/ui/did_you_mean/issue-38147-3.nll.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9e49ac067f205e4400e85c98e35c2fe9af820d7d/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-38147-3.nll.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/9e49ac067f205e4400e85c98e35c2fe9af820d7d/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-38147-3.nll.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-38147-3.nll.stderr?ref=9e49ac067f205e4400e85c98e35c2fe9af820d7d", "patch": "@@ -2,7 +2,7 @@ error[E0596]: cannot borrow `*self.s` as mutable, as it is behind a `&` referenc\n   --> $DIR/issue-38147-3.rs:17:9\n    |\n LL |     s: &'a String\n-   |     ------------- use `&'a mut String` here to make mutable\n+   |        ---------- help: consider changing this to be mutable: `&'a mut String`\n ...\n LL |         self.s.push('x');\n    |         ^^^^^^ cannot borrow as mutable"}]}