{"sha": "f90a88630195a1b6b542b5883295d66dd6c59cef", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY5MGE4ODYzMDE5NWExYjZiNTQyYjU4ODMyOTVkNjZkZDZjNTljZWY=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2019-08-30T17:39:19Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-08-30T17:39:19Z"}, "message": "Merge #1740\n\n1740: :arrow_up: lsp-server r=matklad a=matklad\n\n\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>", "tree": {"sha": "9bdd597701e1b150492a78b6c85ff856f0fc51bd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9bdd597701e1b150492a78b6c85ff856f0fc51bd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f90a88630195a1b6b542b5883295d66dd6c59cef", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdaV9HCRBK7hj4Ov3rIwAAdHIIAB7Hp+MKxpW/wd7g0R/sCTqH\n1pA/WfIE5OdWstJlF1POw5306xDKHEPEKzYub4nDJEpwfsFP6h6/NhOW3+XH3ibg\nWC3Ms33LjyOTXYRKwjDOVyJ946hee14mFkPNZIcc3kX3tC7cV4qYJypeMqmPaorG\nFQstrNR0LB75wqqRuXcwT2fnvlm76jBVtbNxa7JQn7+i5uOFwvmFrYuYu1zUbutB\nV8HCKTLZhy2OtmJLpaiuekYOhLm38JjUmlX6SV3E09DICoUQ8j641J1Q0f1SKxxi\nkQkuSwEDLNlOLROr3djl2UZYNNyk85K9nC+qzwBIc5+iVNUnHc3APnBtjQDl0sQ=\n=m/ds\n-----END PGP SIGNATURE-----\n", "payload": "tree 9bdd597701e1b150492a78b6c85ff856f0fc51bd\nparent ffc95759c7b538d8dacc336912b62857d4919cdd\nparent 983de30a567f2cb4d9e28e12702e509ca713da62\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1567186759 +0000\ncommitter GitHub <noreply@github.com> 1567186759 +0000\n\nMerge #1740\n\n1740: :arrow_up: lsp-server r=matklad a=matklad\n\n\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f90a88630195a1b6b542b5883295d66dd6c59cef", "html_url": "https://github.com/rust-lang/rust/commit/f90a88630195a1b6b542b5883295d66dd6c59cef", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f90a88630195a1b6b542b5883295d66dd6c59cef/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ffc95759c7b538d8dacc336912b62857d4919cdd", "url": "https://api.github.com/repos/rust-lang/rust/commits/ffc95759c7b538d8dacc336912b62857d4919cdd", "html_url": "https://github.com/rust-lang/rust/commit/ffc95759c7b538d8dacc336912b62857d4919cdd"}, {"sha": "983de30a567f2cb4d9e28e12702e509ca713da62", "url": "https://api.github.com/repos/rust-lang/rust/commits/983de30a567f2cb4d9e28e12702e509ca713da62", "html_url": "https://github.com/rust-lang/rust/commit/983de30a567f2cb4d9e28e12702e509ca713da62"}], "stats": {"total": 354, "additions": 161, "deletions": 193}, "files": [{"sha": "9c630f37054a74f74028099003be4c7a90dbccb2", "filename": "Cargo.lock", "status": "modified", "additions": 78, "deletions": 96, "changes": 174, "blob_url": "https://github.com/rust-lang/rust/blob/f90a88630195a1b6b542b5883295d66dd6c59cef/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/f90a88630195a1b6b542b5883295d66dd6c59cef/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=f90a88630195a1b6b542b5883295d66dd6c59cef", "patch": "@@ -22,7 +22,7 @@ version = \"0.2.13\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -46,7 +46,7 @@ name = \"backtrace-sys\"\n version = \"0.1.31\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"cc 1.0.40 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"cc 1.0.41 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -94,7 +94,7 @@ name = \"c2-chacha\"\n version = \"0.2.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"lazy_static 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"lazy_static 1.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ppv-lite86 0.2.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -111,7 +111,7 @@ dependencies = [\n \n [[package]]\n name = \"cc\"\n-version = \"1.0.40\"\n+version = \"1.0.41\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n@@ -122,7 +122,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n [[package]]\n name = \"chalk-engine\"\n version = \"0.9.0\"\n-source = \"git+https://github.com/rust-lang/chalk.git#201775c47e4cefeb71d7f415c605e09c02e33b22\"\n+source = \"git+https://github.com/rust-lang/chalk.git#c9314e425e49969c33cabcb8fac7da6eac3c5073\"\n dependencies = [\n  \"chalk-macros 0.1.1 (git+https://github.com/rust-lang/chalk.git)\",\n  \"rustc-hash 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -132,7 +132,7 @@ dependencies = [\n [[package]]\n name = \"chalk-ir\"\n version = \"0.1.0\"\n-source = \"git+https://github.com/rust-lang/chalk.git#201775c47e4cefeb71d7f415c605e09c02e33b22\"\n+source = \"git+https://github.com/rust-lang/chalk.git#c9314e425e49969c33cabcb8fac7da6eac3c5073\"\n dependencies = [\n  \"chalk-engine 0.9.0 (git+https://github.com/rust-lang/chalk.git)\",\n  \"chalk-macros 0.1.1 (git+https://github.com/rust-lang/chalk.git)\",\n@@ -142,15 +142,15 @@ dependencies = [\n [[package]]\n name = \"chalk-macros\"\n version = \"0.1.1\"\n-source = \"git+https://github.com/rust-lang/chalk.git#201775c47e4cefeb71d7f415c605e09c02e33b22\"\n+source = \"git+https://github.com/rust-lang/chalk.git#c9314e425e49969c33cabcb8fac7da6eac3c5073\"\n dependencies = [\n- \"lazy_static 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"lazy_static 1.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n name = \"chalk-rust-ir\"\n version = \"0.1.0\"\n-source = \"git+https://github.com/rust-lang/chalk.git#201775c47e4cefeb71d7f415c605e09c02e33b22\"\n+source = \"git+https://github.com/rust-lang/chalk.git#c9314e425e49969c33cabcb8fac7da6eac3c5073\"\n dependencies = [\n  \"chalk-engine 0.9.0 (git+https://github.com/rust-lang/chalk.git)\",\n  \"chalk-ir 0.1.0 (git+https://github.com/rust-lang/chalk.git)\",\n@@ -160,14 +160,14 @@ dependencies = [\n [[package]]\n name = \"chalk-solve\"\n version = \"0.1.0\"\n-source = \"git+https://github.com/rust-lang/chalk.git#201775c47e4cefeb71d7f415c605e09c02e33b22\"\n+source = \"git+https://github.com/rust-lang/chalk.git#c9314e425e49969c33cabcb8fac7da6eac3c5073\"\n dependencies = [\n  \"chalk-engine 0.9.0 (git+https://github.com/rust-lang/chalk.git)\",\n  \"chalk-ir 0.1.0 (git+https://github.com/rust-lang/chalk.git)\",\n  \"chalk-macros 0.1.1 (git+https://github.com/rust-lang/chalk.git)\",\n  \"chalk-rust-ir 0.1.0 (git+https://github.com/rust-lang/chalk.git)\",\n  \"derive-new 0.5.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"ena 0.10.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"ena 0.13.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"failure 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"itertools 0.8.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"petgraph 0.4.13 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -197,13 +197,13 @@ dependencies = [\n \n [[package]]\n name = \"clicolors-control\"\n-version = \"1.0.0\"\n+version = \"1.0.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"atty 0.2.13 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"lazy_static 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"lazy_static 1.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -219,14 +219,14 @@ name = \"console\"\n version = \"0.8.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"clicolors-control 1.0.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"encode_unicode 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"lazy_static 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"clicolors-control 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"encode_unicode 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"lazy_static 1.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"regex 1.2.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"termios 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"unicode-width 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -276,7 +276,7 @@ dependencies = [\n  \"arrayvec 0.4.11 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"cfg-if 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"crossbeam-utils 0.6.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"lazy_static 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"lazy_static 1.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"memoffset 0.5.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"scopeguard 1.0.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n@@ -295,7 +295,7 @@ version = \"0.6.6\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"cfg-if 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"lazy_static 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"lazy_static 1.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -305,7 +305,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"proc-macro2 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"syn 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"syn 1.0.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -328,14 +328,6 @@ name = \"either\"\n version = \"1.5.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n-[[package]]\n-name = \"ena\"\n-version = \"0.10.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-dependencies = [\n- \"log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n-]\n-\n [[package]]\n name = \"ena\"\n version = \"0.13.0\"\n@@ -346,7 +338,7 @@ dependencies = [\n \n [[package]]\n name = \"encode_unicode\"\n-version = \"0.3.5\"\n+version = \"0.3.6\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n@@ -386,7 +378,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"flexi_logger\"\n-version = \"0.14.1\"\n+version = \"0.14.3\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"chrono 0.4.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -457,7 +449,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"getrandom\"\n-version = \"0.1.10\"\n+version = \"0.1.11\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"cfg-if 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -511,7 +503,7 @@ version = \"0.11.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"console 0.8.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"lazy_static 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"lazy_static 1.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"number_prefix 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"parking_lot 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"regex 1.2.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -542,7 +534,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"console 0.8.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"difference 2.0.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"lazy_static 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"lazy_static 1.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"serde 1.0.99 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"serde_json 1.0.40 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"serde_yaml 0.8.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -586,7 +578,7 @@ name = \"jemalloc-sys\"\n version = \"0.3.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"cc 1.0.40 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"cc 1.0.41 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"fs_extra 1.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n@@ -626,7 +618,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"lazy_static\"\n-version = \"1.3.0\"\n+version = \"1.4.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n@@ -662,7 +654,7 @@ dependencies = [\n \n [[package]]\n name = \"lsp-server\"\n-version = \"0.1.0\"\n+version = \"0.2.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"crossbeam-channel 0.3.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -747,7 +739,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"cfg-if 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -770,7 +762,7 @@ dependencies = [\n  \"mio 0.6.19 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"mio-extras 2.0.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"walkdir 2.2.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -808,7 +800,7 @@ dependencies = [\n \n [[package]]\n name = \"once_cell\"\n-version = \"0.2.6\"\n+version = \"0.2.7\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"parking_lot 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -840,7 +832,7 @@ dependencies = [\n  \"redox_syscall 0.1.56 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rustc_version 0.2.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"smallvec 0.6.10 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -860,7 +852,7 @@ dependencies = [\n  \"proc-macro-hack 0.5.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"proc-macro2 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"syn 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"syn 1.0.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -889,7 +881,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"proc-macro2 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"syn 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"syn 1.0.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -916,7 +908,7 @@ dependencies = [\n  \"bit-set 0.5.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"bitflags 1.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"byteorder 1.3.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"lazy_static 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"lazy_static 1.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"num-traits 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"quick-error 1.2.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand 0.6.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -958,7 +950,7 @@ dependencies = [\n  \"format-buf 1.0.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"itertools 0.8.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"join_to_string 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"once_cell 0.2.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"once_cell 0.2.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ra_db 0.1.0\",\n  \"ra_fmt 0.1.0\",\n  \"ra_hir 0.1.0\",\n@@ -987,7 +979,7 @@ name = \"ra_cli\"\n version = \"0.1.0\"\n dependencies = [\n  \"clap 2.33.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"flexi_logger 0.14.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"flexi_logger 0.14.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"indicatif 0.11.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ra_batch 0.1.0\",\n  \"ra_db 0.1.0\",\n@@ -1028,7 +1020,7 @@ dependencies = [\n  \"insta 0.11.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"lalrpop-intern 0.15.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"once_cell 0.2.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"once_cell 0.2.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"parking_lot 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ra_arena 0.1.0\",\n  \"ra_db 0.1.0\",\n@@ -1073,9 +1065,10 @@ name = \"ra_lsp_server\"\n version = \"0.1.0\"\n dependencies = [\n  \"crossbeam-channel 0.3.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"flexi_logger 0.14.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"flexi_logger 0.14.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"jod-thread 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"lsp-server 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"lsp-server 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"lsp-types 0.60.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"parking_lot 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ra_ide_api 0.1.0\",\n@@ -1091,7 +1084,6 @@ dependencies = [\n  \"serde_json 1.0.40 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"tempfile 3.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"test_utils 0.1.0\",\n- \"thread_worker 0.1.0\",\n  \"threadpool 1.7.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -1123,7 +1115,7 @@ dependencies = [\n  \"itertools 0.8.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"jemalloc-ctl 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"jemallocator 0.3.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"once_cell 0.2.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"once_cell 0.2.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1228,18 +1220,18 @@ dependencies = [\n  \"rand_os 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand_pcg 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand_xorshift 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n name = \"rand\"\n version = \"0.7.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"getrandom 0.1.10 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"getrandom 0.1.11 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand_chacha 0.2.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"rand_core 0.5.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"rand_core 0.5.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand_hc 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand_pcg 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n@@ -1259,7 +1251,7 @@ version = \"0.2.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"c2-chacha 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"rand_core 0.5.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"rand_core 0.5.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1277,10 +1269,10 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"rand_core\"\n-version = \"0.5.0\"\n+version = \"0.5.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"getrandom 0.1.10 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"getrandom 0.1.11 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1296,7 +1288,7 @@ name = \"rand_hc\"\n version = \"0.2.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"rand_core 0.5.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"rand_core 0.5.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1314,7 +1306,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand_core 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1327,7 +1319,7 @@ dependencies = [\n  \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand_core 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rdrand 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1345,7 +1337,7 @@ version = \"0.2.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"autocfg 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"rand_core 0.5.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"rand_core 0.5.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1374,7 +1366,7 @@ dependencies = [\n  \"crossbeam-deque 0.6.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"crossbeam-queue 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"crossbeam-utils 0.6.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"lazy_static 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"lazy_static 1.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"num_cpus 1.10.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -1417,7 +1409,7 @@ name = \"remove_dir_all\"\n version = \"0.5.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1490,7 +1482,7 @@ dependencies = [\n  \"heck 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"proc-macro2 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"syn 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"syn 1.0.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1535,7 +1527,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"proc-macro2 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"syn 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"syn 1.0.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1555,7 +1547,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"proc-macro2 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"syn 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"syn 1.0.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1592,10 +1584,10 @@ name = \"stacker\"\n version = \"0.1.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"cc 1.0.40 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"cc 1.0.41 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"cfg-if 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1615,7 +1607,7 @@ dependencies = [\n \n [[package]]\n name = \"syn\"\n-version = \"1.0.3\"\n+version = \"1.0.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"proc-macro2 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -1644,7 +1636,7 @@ dependencies = [\n  \"rand 0.7.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"redox_syscall 0.1.56 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"remove_dir_all 0.5.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1682,16 +1674,7 @@ name = \"thread_local\"\n version = \"0.3.6\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"lazy_static 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n-]\n-\n-[[package]]\n-name = \"thread_worker\"\n-version = \"0.1.0\"\n-dependencies = [\n- \"crossbeam-channel 0.3.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"jod-thread 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"lazy_static 1.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1709,7 +1692,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"redox_syscall 0.1.56 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1787,7 +1770,7 @@ version = \"2.2.9\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"same-file 1.0.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"winapi-util 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -1803,7 +1786,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"winapi\"\n-version = \"0.3.7\"\n+version = \"0.3.8\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"winapi-i686-pc-windows-gnu 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -1825,7 +1808,7 @@ name = \"winapi-util\"\n version = \"0.1.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1870,7 +1853,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum byteorder 1.3.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"a7c3dd8985a7111efc5c80b44e23ecdd8c007de8ade3b96595387e812b957cf5\"\n \"checksum c2-chacha 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7d64d04786e0f528460fc884753cf8dddcc466be308f6026f8e355c41a0e4101\"\n \"checksum cargo_metadata 0.8.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"700b3731fd7d357223d0000f4dbf1808401b694609035c3c411fbc0cd375c426\"\n-\"checksum cc 1.0.40 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b548a4ee81fccb95919d4e22cfea83c7693ebfd78f0495493178db20b3139da7\"\n+\"checksum cc 1.0.41 (registry+https://github.com/rust-lang/crates.io-index)\" = \"8dae9c4b8fedcae85592ba623c4fd08cfdab3e3b72d6df780c6ead964a69bfff\"\n \"checksum cfg-if 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b486ce3ccf7ffd79fdeb678eac06a9e6c09fc88d33836340becb8fffe87c5e33\"\n \"checksum chalk-engine 0.9.0 (git+https://github.com/rust-lang/chalk.git)\" = \"<none>\"\n \"checksum chalk-ir 0.1.0 (git+https://github.com/rust-lang/chalk.git)\" = \"<none>\"\n@@ -1879,7 +1862,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum chalk-solve 0.1.0 (git+https://github.com/rust-lang/chalk.git)\" = \"<none>\"\n \"checksum chrono 0.4.7 (registry+https://github.com/rust-lang/crates.io-index)\" = \"77d81f58b7301084de3b958691458a53c3f7e0b1d702f77e550b6a88e3a88abe\"\n \"checksum clap 2.33.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"5067f5bb2d80ef5d68b4c87db81601f0b75bca627bc2ef76b141d7b846a3c6d9\"\n-\"checksum clicolors-control 1.0.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"73abfd4c73d003a674ce5d2933fca6ce6c42480ea84a5ffe0a2dc39ed56300f9\"\n+\"checksum clicolors-control 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"90082ee5dcdd64dc4e9e0d37fbf3ee325419e39c0092191e0393df65518f741e\"\n \"checksum cloudabi 0.0.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ddfc5b9aa5d4507acaf872de71051dfd0e309860e88966e1051e462a077aac4f\"\n \"checksum console 0.8.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b147390a412132d75d10dd3b7b175a69cf5fd95032f7503c7091b8831ba10242\"\n \"checksum crossbeam 0.7.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2d818a4990769aac0c7ff1360e233ef3a41adcb009ebb2036bf6915eb0f6b23c\"\n@@ -1894,14 +1877,13 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum drop_bomb 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"69b26e475fd29098530e709294e94e661974c851aed42512793f120fed4e199f\"\n \"checksum dtoa 0.4.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ea57b42383d091c85abcc2706240b94ab2a8fa1fc81c10ff23c4de06e2a90b5e\"\n \"checksum either 1.5.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"5527cfe0d098f36e3f8839852688e63c8fff1c90b2b405aef730615f9a7bcf7b\"\n-\"checksum ena 0.10.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"25b4e5febb25f08c49f1b07dc33a182729a6b21edfb562b5aef95f78e0dbe5bb\"\n \"checksum ena 0.13.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"3dc01d68e08ca384955a3aeba9217102ca1aa85b6e168639bf27739f1d749d87\"\n-\"checksum encode_unicode 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"90b2c9496c001e8cb61827acdefad780795c42264c137744cae6f7d9e3450abd\"\n+\"checksum encode_unicode 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"a357d28ed41a50f9c765dbfe56cbc04a64e53e5fc58ba79fbc34c10ef3df831f\"\n \"checksum failure 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"795bd83d3abeb9220f257e597aa0080a508b27533824adf336529648f6abf7e2\"\n \"checksum failure_derive 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ea1063915fd7ef4309e222a5a07cf9c319fb9c7836b1f89b85458672dbb127e1\"\n \"checksum filetime 0.2.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2f8c63033fcba1f51ef744505b3cad42510432b904c062afa67ad7ece008429d\"\n \"checksum fixedbitset 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\" = \"86d4de0081402f5e88cdac65c8dcdcc73118c1a7a465e2a05f0da05843a8ea33\"\n-\"checksum flexi_logger 0.14.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2be2727ae1f60711d1991788605245e70cc500bd1d92edb909af160634e1a869\"\n+\"checksum flexi_logger 0.14.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"66473c1b6a0d2a72f6ed983d33021a4c744a1d179e6f4265867b7d0a9dd679c5\"\n \"checksum fnv 1.0.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2fad85553e09a6f881f739c29f0b00b0f01357c743266d478b68951ce23285f3\"\n \"checksum format-buf 1.0.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f7aea5a5909a74969507051a3b17adc84737e31a5f910559892aedce026f4d53\"\n \"checksum fs_extra 1.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"5f2a4a2034423744d2cc7ca2068453168dcdb82c438419e639a26bd87839c674\"\n@@ -1911,7 +1893,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum fuchsia-cprng 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"a06f77d526c1a601b7c4cdd98f54b5eaabffc14d5f2f0296febdc7f357c6d3ba\"\n \"checksum fuchsia-zircon 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2e9763c69ebaae630ba35f74888db465e49e259ba1bc0eda7d06f4a067615d82\"\n \"checksum fuchsia-zircon-sys 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"3dcaa9ae7725d12cdb85b3ad99a434db70b468c09ded17e012d86b5c1010f7a7\"\n-\"checksum getrandom 0.1.10 (registry+https://github.com/rust-lang/crates.io-index)\" = \"6171a6cc63fbabbe27c2b5ee268e8b7fe5dc1eb0dd2dfad537c1dfed6f69117e\"\n+\"checksum getrandom 0.1.11 (registry+https://github.com/rust-lang/crates.io-index)\" = \"fc344b02d3868feb131e8b5fe2b9b0a1cc42942679af493061fc13b853243872\"\n \"checksum glob 0.3.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9b919933a397b79c37e33b77bb2aa3dc8eb6e165ad809e58ff75bc7db2e34574\"\n \"checksum globset 0.4.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"925aa2cac82d8834e2b2a4415b6f6879757fb5c0928fc445ae76461a12eed8f2\"\n \"checksum heck 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"20564e78d53d2bb135c343b3f47714a56af2061f1c928fdb541dc7b9fdd94205\"\n@@ -1931,13 +1913,13 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum join_to_string 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"4dc7a5290e8c2606ce2be49f456d50f69173cb96d1541e4f66e34ac8b331a98f\"\n \"checksum kernel32-sys 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7507624b29483431c0ba2d82aece8ca6cdba9382bff4ddd0f7490560c056098d\"\n \"checksum lalrpop-intern 0.15.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"cc4fd87be4a815fd373e02773983940f0d75fb26fde8c098e9e45f7af03154c0\"\n-\"checksum lazy_static 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"bc5729f27f159ddd61f4df6228e827e86643d4d3e7c32183cb30a1c08f604a14\"\n+\"checksum lazy_static 1.4.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"e2abad23fbc42b3700f2f279844dc832adb2b2eb069b2df918f455c4e18cc646\"\n \"checksum lazycell 1.2.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b294d6fa9ee409a054354afc4352b0b9ef7ca222c69b8812cbea9e7d2bf3783f\"\n \"checksum libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\" = \"34fcd2c08d2f832f376f4173a231990fa5aef4e99fb569867318a227ef4c06ba\"\n \"checksum linked-hash-map 0.5.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ae91b68aebc4ddb91978b11a1b02ddd8602a05ec19002801c5666000e05e0f83\"\n \"checksum lock_api 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f8912e782533a93a167888781b836336a6ca5da6175c05944c86cf28c31104dc\"\n \"checksum log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"14b6052be84e6b71ab17edffc2eeabf5c2c3ae1fdb464aae35ac50c67a44e1f7\"\n-\"checksum lsp-server 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"47632ec528046c1a39f14448f1ee7d66d4b7b83e1771590b62e6c08665dea053\"\n+\"checksum lsp-server 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"148cfb1c0b3295c23d9fb4a20fd1b242f5e6f46c525fdcc7f5c0a65710362012\"\n \"checksum lsp-types 0.60.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"fe3edefcd66dde1f7f1df706f46520a3c93adc5ca4bc5747da6621195e894efd\"\n \"checksum matches 0.1.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7ffc5c5338469d4d3ea17d269fa8ea3512ad247247c30bd2df69e68309ed0a08\"\n \"checksum memchr 2.2.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"88579771288728879b57485cc7d6b07d648c9f0141eb955f8ab7f9d45394468e\"\n@@ -1952,7 +1934,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum num-traits 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"6ba9a427cfca2be13aa6f6403b0b7e7368fe982bfa16fccc450ce74c46cd9b32\"\n \"checksum num_cpus 1.10.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"bcef43580c035376c0705c42792c294b66974abbfd2789b511784023f71f3273\"\n \"checksum number_prefix 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"dbf9993e59c894e3c08aa1c2712914e9e6bf1fcbfc6bef283e2183df345a4fee\"\n-\"checksum once_cell 0.2.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1824583b0e4dc0c1716eea4fb51a9ca2634943f0b07fd929e79af6aeb5a513cc\"\n+\"checksum once_cell 0.2.7 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1d1a13503127ae8c93c0e2c817d74895b0af4df9132ec9be3ea42dd1656cd6e9\"\n \"checksum ordermap 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"a86ed3f5f244b372d6b1a00b72ef7f8876d0bc6a78a4c9985c53614041512063\"\n \"checksum parking_lot 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f842b1982eb6c2fe34036a4fbfb06dd185a3f5c8edfaacdf7d1ea10b07de6252\"\n \"checksum parking_lot_core 0.6.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b876b1b9e7ac6e1a74a6da34d25c42e17e8862aa409cbbbdcfc8d86c6f3bc62b\"\n@@ -1976,7 +1958,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum rand_chacha 0.2.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"03a2a90da8c7523f554344f921aa97283eadf6ac484a6d2a7d0212fa7f8d6853\"\n \"checksum rand_core 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7a6fdeb83b075e8266dcc8762c22776f6877a63111121f5f8c7411e5be7eed4b\"\n \"checksum rand_core 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9c33a3c44ca05fa6f1807d8e6743f3824e8509beca625669633be0acbdf509dc\"\n-\"checksum rand_core 0.5.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"615e683324e75af5d43d8f7a39ffe3ee4a9dc42c5c701167a71dc59c3a493aca\"\n+\"checksum rand_core 0.5.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"90bde5296fc891b0cef12a6d03ddccc162ce7b2aff54160af9338f8d40df6d19\"\n \"checksum rand_hc 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7b40677c7be09ae76218dc623efbf7b18e34bced3f38883af07bb75630a21bc4\"\n \"checksum rand_hc 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ca3129af7b92a17112d59ad498c6f81eaf463253766b90396d39ea7a39d6613c\"\n \"checksum rand_isaac 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ded997c9d5f13925be2a6fd7e66bf1872597f759fd9dd93513dd7e92e5a5ee08\"\n@@ -2016,7 +1998,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum stacker 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"fb79482f57cf598af52094ec4cc3b3c42499d3ce5bd426f2ac41515b7e57404b\"\n \"checksum superslice 1.0.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ab16ced94dbd8a46c82fd81e3ed9a8727dac2977ea869d217bcc4ea1f122e81f\"\n \"checksum syn 0.15.44 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9ca4b3b69a77cbe1ffc9e198781b7acb0c7365a883670e8f1c1bc66fba79a5c5\"\n-\"checksum syn 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"158521e6f544e7e3dcfc370ac180794aa38cb34a1b1e07609376d4adcf429b93\"\n+\"checksum syn 1.0.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"66850e97125af79138385e9b88339cbcd037e3f28ceab8c5ad98e64f0f1f80bf\"\n \"checksum synstructure 0.10.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"02353edf96d6e4dc81aea2d8490a7e9db177bf8acb0e951c24940bf866cb313f\"\n \"checksum tempfile 3.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7a6e24d9338a0a5be79593e2fa15a648add6138caa803e2d5bc782c371732ca9\"\n \"checksum termios 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"72b620c5ea021d75a735c943269bb07d30c9b77d6ac6b236bc8b5c496ef05625\"\n@@ -2038,7 +2020,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum walkdir 2.2.9 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9658c94fa8b940eab2250bd5a457f9c48b748420d71293b165c8cdbe2f55f71e\"\n \"checksum wasi 0.5.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"fd5442abcac6525a045cc8c795aedb60da7a2e5e89c7bf18a0d5357849bb23c7\"\n \"checksum winapi 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"167dc9d6949a9b857f3451275e911c3f44255842c1f7a76f33c55103a909087a\"\n-\"checksum winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f10e386af2b13e47c89e7236a7a14a086791a2b88ebad6df9bf42040195cf770\"\n+\"checksum winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"8093091eeb260906a183e6ae1abdba2ef5ef2257a21801128899c3fc699229c6\"\n \"checksum winapi-build 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2d315eee3b34aca4797b2da6b13ed88266e6d612562a0c46390af8299fc699bc\"\n \"checksum winapi-i686-pc-windows-gnu 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ac3b87c63620426dd9b991e5ce0329eff545bccbbb34f3be09ff6fb6ab51b7b6\"\n \"checksum winapi-util 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7168bab6e1daee33b4557efd0e95d5ca70a03706d39fa5f3fe7a236f584b03c9\""}, {"sha": "eb48126330b0f44d78246d7717f23ce4dafa7283", "filename": "crates/ra_lsp_server/Cargo.toml", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/f90a88630195a1b6b542b5883295d66dd6c59cef/crates%2Fra_lsp_server%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/f90a88630195a1b6b542b5883295d66dd6c59cef/crates%2Fra_lsp_server%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2FCargo.toml?ref=f90a88630195a1b6b542b5883295d66dd6c59cef", "patch": "@@ -15,13 +15,12 @@ log = \"0.4.3\"\n lsp-types = { version = \"0.60.0\", features = [\"proposed\"] }\n rustc-hash = \"1.0\"\n parking_lot = \"0.9.0\"\n-\n+jod-thread = \"0.1.0\"\n ra_vfs = \"0.3.0\"\n-thread_worker = { path = \"../thread_worker\" }\n ra_syntax = { path = \"../ra_syntax\" }\n ra_text_edit = { path = \"../ra_text_edit\" }\n ra_ide_api = { path = \"../ra_ide_api\" }\n-lsp-server = \"0.1.0\"\n+lsp-server = \"0.2.0\"\n ra_project_model = { path = \"../ra_project_model\" }\n ra_prof = { path = \"../ra_prof\" }\n ra_vfs_glob = { path = \"../ra_vfs_glob\" }"}, {"sha": "69a577b3e14fb0443abd8499e8e69fd1a7bd7aa0", "filename": "crates/ra_lsp_server/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f90a88630195a1b6b542b5883295d66dd6c59cef/crates%2Fra_lsp_server%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f90a88630195a1b6b542b5883295d66dd6c59cef/crates%2Fra_lsp_server%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Flib.rs?ref=f90a88630195a1b6b542b5883295d66dd6c59cef", "patch": "@@ -8,6 +8,7 @@ mod project_model;\n pub mod req;\n pub mod config;\n mod world;\n+mod thread_worker;\n \n pub type Result<T> = std::result::Result<T, Box<dyn std::error::Error + Send + Sync>>;\n pub use crate::{"}, {"sha": "88504bb8966356ea57f001cc90901e0862747f48", "filename": "crates/ra_lsp_server/src/main.rs", "status": "modified", "additions": 37, "deletions": 37, "changes": 74, "blob_url": "https://github.com/rust-lang/rust/blob/f90a88630195a1b6b542b5883295d66dd6c59cef/crates%2Fra_lsp_server%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f90a88630195a1b6b542b5883295d66dd6c59cef/crates%2Fra_lsp_server%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fmain.rs?ref=f90a88630195a1b6b542b5883295d66dd6c59cef", "patch": "@@ -1,5 +1,5 @@\n use flexi_logger::{Duplicate, Logger};\n-use lsp_server::{run_server, stdio_transport, LspServerError};\n+use lsp_server::Connection;\n \n use ra_lsp_server::{show_message, Result, ServerConfig};\n use ra_prof;\n@@ -29,46 +29,46 @@ fn main() -> Result<()> {\n }\n \n fn main_inner() -> Result<()> {\n-    let (sender, receiver, io_threads) = stdio_transport();\n     let cwd = std::env::current_dir()?;\n-    let caps = serde_json::to_value(ra_lsp_server::server_capabilities()).unwrap();\n-    run_server(caps, sender, receiver, |params, s, r| {\n-        let params: lsp_types::InitializeParams = serde_json::from_value(params)?;\n-        let root = params.root_uri.and_then(|it| it.to_file_path().ok()).unwrap_or(cwd);\n+    let (connection, io_threads) = Connection::stdio();\n+    let server_capabilities = serde_json::to_value(ra_lsp_server::server_capabilities()).unwrap();\n \n-        let workspace_roots = params\n-            .workspace_folders\n-            .map(|workspaces| {\n-                workspaces\n-                    .into_iter()\n-                    .filter_map(|it| it.uri.to_file_path().ok())\n-                    .collect::<Vec<_>>()\n-            })\n-            .filter(|workspaces| !workspaces.is_empty())\n-            .unwrap_or_else(|| vec![root]);\n+    let initialize_params = connection.initialize(server_capabilities)?;\n+    let initialize_params: lsp_types::InitializeParams = serde_json::from_value(initialize_params)?;\n \n-        let server_config: ServerConfig = params\n-            .initialization_options\n-            .and_then(|v| {\n-                serde_json::from_value(v)\n-                    .map_err(|e| {\n-                        log::error!(\"failed to deserialize config: {}\", e);\n-                        show_message(\n-                            lsp_types::MessageType::Error,\n-                            format!(\"failed to deserialize config: {}\", e),\n-                            s,\n-                        );\n-                    })\n-                    .ok()\n-            })\n-            .unwrap_or_default();\n+    let root = initialize_params.root_uri.and_then(|it| it.to_file_path().ok()).unwrap_or(cwd);\n+\n+    let workspace_roots = initialize_params\n+        .workspace_folders\n+        .map(|workspaces| {\n+            workspaces.into_iter().filter_map(|it| it.uri.to_file_path().ok()).collect::<Vec<_>>()\n+        })\n+        .filter(|workspaces| !workspaces.is_empty())\n+        .unwrap_or_else(|| vec![root]);\n+\n+    let server_config: ServerConfig = initialize_params\n+        .initialization_options\n+        .and_then(|v| {\n+            serde_json::from_value(v)\n+                .map_err(|e| {\n+                    log::error!(\"failed to deserialize config: {}\", e);\n+                    show_message(\n+                        lsp_types::MessageType::Error,\n+                        format!(\"failed to deserialize config: {}\", e),\n+                        &connection.sender,\n+                    );\n+                })\n+                .ok()\n+        })\n+        .unwrap_or_default();\n+\n+    ra_lsp_server::main_loop(\n+        workspace_roots,\n+        initialize_params.capabilities,\n+        server_config,\n+        &connection,\n+    )?;\n \n-        ra_lsp_server::main_loop(workspace_roots, params.capabilities, server_config, r, s)\n-    })\n-    .map_err(|err| match err {\n-        LspServerError::ProtocolError(err) => err.into(),\n-        LspServerError::ServerError(err) => err,\n-    })?;\n     log::info!(\"shutting down IO...\");\n     io_threads.join()?;\n     log::info!(\"... IO is down\");"}, {"sha": "42ebb5cdf26aa47270144b55b808aa7006f05f5a", "filename": "crates/ra_lsp_server/src/main_loop.rs", "status": "modified", "additions": 13, "deletions": 16, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/f90a88630195a1b6b542b5883295d66dd6c59cef/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f90a88630195a1b6b542b5883295d66dd6c59cef/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop.rs?ref=f90a88630195a1b6b542b5883295d66dd6c59cef", "patch": "@@ -5,7 +5,7 @@ pub(crate) mod pending_requests;\n use std::{error::Error, fmt, path::PathBuf, sync::Arc, time::Instant};\n \n use crossbeam_channel::{select, unbounded, Receiver, RecvError, Sender};\n-use lsp_server::{handle_shutdown, ErrorCode, Message, Notification, Request, RequestId, Response};\n+use lsp_server::{Connection, ErrorCode, Message, Notification, Request, RequestId, Response};\n use lsp_types::{ClientCapabilities, NumberOrString};\n use ra_ide_api::{Canceled, FeatureFlags, FileId, LibraryData};\n use ra_prof::profile;\n@@ -51,8 +51,7 @@ pub fn main_loop(\n     ws_roots: Vec<PathBuf>,\n     client_caps: ClientCapabilities,\n     config: ServerConfig,\n-    msg_receiver: &Receiver<Message>,\n-    msg_sender: &Sender<Message>,\n+    connection: &Connection,\n ) -> Result<()> {\n     log::info!(\"server_config: {:#?}\", config);\n     // FIXME: support dynamic workspace loading.\n@@ -69,7 +68,7 @@ pub fn main_loop(\n                     show_message(\n                         req::MessageType::Error,\n                         format!(\"rust-analyzer failed to load workspace: {}\", e),\n-                        msg_sender,\n+                        &connection.sender,\n                     );\n                 }\n             }\n@@ -89,7 +88,7 @@ pub fn main_loop(\n                 show_message(\n                     req::MessageType::Error,\n                     format!(\"unknown feature flag: {:?}\", flag),\n-                    msg_sender,\n+                    &connection.sender,\n                 );\n             }\n         }\n@@ -119,8 +118,7 @@ pub fn main_loop(\n     log::info!(\"server initialized, serving requests\");\n     let main_res = main_loop_inner(\n         &pool,\n-        msg_sender,\n-        msg_receiver,\n+        connection,\n         task_sender,\n         task_receiver.clone(),\n         &mut state,\n@@ -130,7 +128,7 @@ pub fn main_loop(\n     log::info!(\"waiting for tasks to finish...\");\n     task_receiver\n         .into_iter()\n-        .for_each(|task| on_task(task, msg_sender, &mut pending_requests, &mut state));\n+        .for_each(|task| on_task(task, &connection.sender, &mut pending_requests, &mut state));\n     log::info!(\"...tasks have finished\");\n     log::info!(\"joining threadpool...\");\n     drop(pool);\n@@ -196,8 +194,7 @@ impl fmt::Debug for Event {\n \n fn main_loop_inner(\n     pool: &ThreadPool,\n-    msg_sender: &Sender<Message>,\n-    msg_receiver: &Receiver<Message>,\n+    connection: &Connection,\n     task_sender: Sender<Task>,\n     task_receiver: Receiver<Task>,\n     state: &mut WorldState,\n@@ -214,7 +211,7 @@ fn main_loop_inner(\n     loop {\n         log::trace!(\"selecting\");\n         let event = select! {\n-            recv(msg_receiver) -> msg => match msg {\n+            recv(&connection.receiver) -> msg => match msg {\n                 Ok(msg) => Event::Msg(msg),\n                 Err(RecvError) => Err(\"client exited without shutdown\")?,\n             },\n@@ -238,7 +235,7 @@ fn main_loop_inner(\n         let mut state_changed = false;\n         match event {\n             Event::Task(task) => {\n-                on_task(task, msg_sender, pending_requests, state);\n+                on_task(task, &connection.sender, pending_requests, state);\n                 state.maybe_collect_garbage();\n             }\n             Event::Vfs(task) => {\n@@ -252,21 +249,21 @@ fn main_loop_inner(\n             }\n             Event::Msg(msg) => match msg {\n                 Message::Request(req) => {\n-                    if handle_shutdown(&req, msg_sender) {\n+                    if connection.handle_shutdown(&req)? {\n                         return Ok(());\n                     };\n                     on_request(\n                         state,\n                         pending_requests,\n                         pool,\n                         &task_sender,\n-                        msg_sender,\n+                        &connection.sender,\n                         loop_start,\n                         req,\n                     )?\n                 }\n                 Message::Notification(not) => {\n-                    on_notification(msg_sender, state, pending_requests, &mut subs, not)?;\n+                    on_notification(&connection.sender, state, pending_requests, &mut subs, not)?;\n                     state_changed = true;\n                 }\n                 Message::Response(resp) => log::error!(\"unexpected response: {:?}\", resp),\n@@ -294,7 +291,7 @@ fn main_loop_inner(\n             let n_packages: usize = state.workspaces.iter().map(|it| it.n_packages()).sum();\n             if state.feature_flags().get(\"notifications.workspace-loaded\") {\n                 let msg = format!(\"workspace loaded, {} rust packages\", n_packages);\n-                show_message(req::MessageType::Info, msg, msg_sender);\n+                show_message(req::MessageType::Info, msg, &connection.sender);\n             }\n             // Only send the notification first time\n             send_workspace_notification = false;"}, {"sha": "6234563f2952895643afa855180cf74384a7f657", "filename": "crates/ra_lsp_server/src/project_model.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/f90a88630195a1b6b542b5883295d66dd6c59cef/crates%2Fra_lsp_server%2Fsrc%2Fproject_model.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f90a88630195a1b6b542b5883295d66dd6c59cef/crates%2Fra_lsp_server%2Fsrc%2Fproject_model.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fproject_model.rs?ref=f90a88630195a1b6b542b5883295d66dd6c59cef", "patch": "@@ -1,8 +1,6 @@\n use std::path::PathBuf;\n \n-use thread_worker::Worker;\n-\n-use crate::Result;\n+use crate::{thread_worker::Worker, Result};\n \n pub use ra_project_model::{\n     CargoWorkspace, Package, ProjectWorkspace, Sysroot, Target, TargetKind,"}, {"sha": "68e5c124dc1943f048a83a208a5b8b951fbb9823", "filename": "crates/ra_lsp_server/src/thread_worker.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/f90a88630195a1b6b542b5883295d66dd6c59cef/crates%2Fra_lsp_server%2Fsrc%2Fthread_worker.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f90a88630195a1b6b542b5883295d66dd6c59cef/crates%2Fra_lsp_server%2Fsrc%2Fthread_worker.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fthread_worker.rs?ref=f90a88630195a1b6b542b5883295d66dd6c59cef", "previous_filename": "crates/thread_worker/src/lib.rs"}, {"sha": "89f65cef45f31f02c18c17e3a3d2260d9cc50526", "filename": "crates/ra_lsp_server/tests/heavy_tests/support.rs", "status": "modified", "additions": 29, "deletions": 28, "changes": 57, "blob_url": "https://github.com/rust-lang/rust/blob/f90a88630195a1b6b542b5883295d66dd6c59cef/crates%2Fra_lsp_server%2Ftests%2Fheavy_tests%2Fsupport.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f90a88630195a1b6b542b5883295d66dd6c59cef/crates%2Fra_lsp_server%2Ftests%2Fheavy_tests%2Fsupport.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Ftests%2Fheavy_tests%2Fsupport.rs?ref=f90a88630195a1b6b542b5883295d66dd6c59cef", "patch": "@@ -8,16 +8,17 @@ use std::{\n \n use crossbeam_channel::{after, select, Receiver};\n use flexi_logger::Logger;\n-use lsp_server::{Message, Notification, Request};\n+use lsp_server::{Connection, Message, Notification, Request};\n use lsp_types::{\n-    request::Shutdown, ClientCapabilities, DidOpenTextDocumentParams, GotoCapability,\n-    TextDocumentClientCapabilities, TextDocumentIdentifier, TextDocumentItem, Url,\n+    notification::{DidOpenTextDocument, Exit},\n+    request::Shutdown,\n+    ClientCapabilities, DidOpenTextDocumentParams, GotoCapability, TextDocumentClientCapabilities,\n+    TextDocumentIdentifier, TextDocumentItem, Url,\n };\n use serde::Serialize;\n use serde_json::{to_string_pretty, Value};\n use tempfile::TempDir;\n use test_utils::{find_mismatch, parse_fixture};\n-use thread_worker::Worker;\n \n use ra_lsp_server::{main_loop, req, ServerConfig};\n \n@@ -83,7 +84,8 @@ pub struct Server {\n     req_id: Cell<u64>,\n     messages: RefCell<Vec<Message>>,\n     dir: TempDir,\n-    worker: Worker<Message, Message>,\n+    _thread: jod_thread::JoinHandle<()>,\n+    client: Connection,\n }\n \n impl Server {\n@@ -96,11 +98,11 @@ impl Server {\n         let path = dir.path().to_path_buf();\n \n         let roots = if roots.is_empty() { vec![path] } else { roots };\n+        let (connection, client) = Connection::memory();\n \n-        let worker = Worker::<Message, Message>::spawn(\n-            \"test server\",\n-            128,\n-            move |msg_receiver, msg_sender| {\n+        let _thread = jod_thread::Builder::new()\n+            .name(\"test server\".to_string())\n+            .spawn(move || {\n                 main_loop(\n                     roots,\n                     ClientCapabilities {\n@@ -116,26 +118,24 @@ impl Server {\n                         experimental: None,\n                     },\n                     ServerConfig { with_sysroot, ..ServerConfig::default() },\n-                    &msg_receiver,\n-                    &msg_sender,\n+                    &connection,\n                 )\n                 .unwrap()\n-            },\n-        );\n-        let res = Server { req_id: Cell::new(1), dir, messages: Default::default(), worker };\n+            })\n+            .expect(\"failed to spawn a thread\");\n+\n+        let res =\n+            Server { req_id: Cell::new(1), dir, messages: Default::default(), client, _thread };\n \n         for (path, text) in files {\n-            res.send_notification(Notification::new(\n-                \"textDocument/didOpen\".to_string(),\n-                &DidOpenTextDocumentParams {\n-                    text_document: TextDocumentItem {\n-                        uri: Url::from_file_path(path).unwrap(),\n-                        language_id: \"rust\".to_string(),\n-                        version: 0,\n-                        text,\n-                    },\n+            res.notification::<DidOpenTextDocument>(DidOpenTextDocumentParams {\n+                text_document: TextDocumentItem {\n+                    uri: Url::from_file_path(path).unwrap(),\n+                    language_id: \"rust\".to_string(),\n+                    version: 0,\n+                    text,\n                 },\n-            ))\n+            })\n         }\n         res\n     }\n@@ -184,7 +184,7 @@ impl Server {\n     }\n     fn send_request_(&self, r: Request) -> Value {\n         let id = r.id.clone();\n-        self.worker.sender().send(r.into()).unwrap();\n+        self.client.sender.send(r.into()).unwrap();\n         while let Some(msg) = self.recv() {\n             match msg {\n                 Message::Request(req) => panic!(\"unexpected request: {:?}\", req),\n@@ -225,13 +225,13 @@ impl Server {\n         }\n     }\n     fn recv(&self) -> Option<Message> {\n-        recv_timeout(&self.worker.receiver()).map(|msg| {\n+        recv_timeout(&self.client.receiver).map(|msg| {\n             self.messages.borrow_mut().push(msg.clone());\n             msg\n         })\n     }\n     fn send_notification(&self, not: Notification) {\n-        self.worker.sender().send(Message::Notification(not)).unwrap();\n+        self.client.sender.send(Message::Notification(not)).unwrap();\n     }\n \n     pub fn path(&self) -> &Path {\n@@ -241,7 +241,8 @@ impl Server {\n \n impl Drop for Server {\n     fn drop(&mut self) {\n-        self.send_request::<Shutdown>(());\n+        self.request::<Shutdown>((), Value::Null);\n+        self.notification::<Exit>(());\n     }\n }\n "}, {"sha": "e3babbf8d130260bc2c435b26a30252065d14bf4", "filename": "crates/thread_worker/Cargo.toml", "status": "removed", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/ffc95759c7b538d8dacc336912b62857d4919cdd/crates%2Fthread_worker%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/ffc95759c7b538d8dacc336912b62857d4919cdd/crates%2Fthread_worker%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fthread_worker%2FCargo.toml?ref=ffc95759c7b538d8dacc336912b62857d4919cdd", "patch": "@@ -1,10 +0,0 @@\n-[package]\n-edition = \"2018\"\n-name = \"thread_worker\"\n-version = \"0.1.0\"\n-authors = [\"rust-analyzer developers\"]\n-\n-[dependencies]\n-jod-thread = \"0.1.0\"\n-crossbeam-channel = \"0.3.5\"\n-log = \"0.4.3\""}]}