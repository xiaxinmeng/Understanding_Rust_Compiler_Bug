{"sha": "0ff1d1e122766d44292d22245c05e53d9b324f8e", "node_id": "C_kwDOAAsO6NoAKDBmZjFkMWUxMjI3NjZkNDQyOTJkMjIyNDVjMDVlNTNkOWIzMjRmOGU", "commit": {"author": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2022-10-25T15:07:56Z"}, "committer": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2022-11-11T10:10:16Z"}, "message": "Tweak signatures in rustc_middle::hir::map.", "tree": {"sha": "f2f072cd99f0a187cea760af73773eaa2aaa1dc0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f2f072cd99f0a187cea760af73773eaa2aaa1dc0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0ff1d1e122766d44292d22245c05e53d9b324f8e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0ff1d1e122766d44292d22245c05e53d9b324f8e", "html_url": "https://github.com/rust-lang/rust/commit/0ff1d1e122766d44292d22245c05e53d9b324f8e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0ff1d1e122766d44292d22245c05e53d9b324f8e/comments", "author": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cc9b259b5e94e4543b96dca236e3a1af5ec496c9", "url": "https://api.github.com/repos/rust-lang/rust/commits/cc9b259b5e94e4543b96dca236e3a1af5ec496c9", "html_url": "https://github.com/rust-lang/rust/commit/cc9b259b5e94e4543b96dca236e3a1af5ec496c9"}], "stats": {"total": 15, "additions": 11, "deletions": 4}, "files": [{"sha": "bc9c2b6025c6a0bfaf3e1c288a3b1dd6d8c1a551", "filename": "compiler/rustc_hir_analysis/src/check/wfcheck.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0ff1d1e122766d44292d22245c05e53d9b324f8e/compiler%2Frustc_hir_analysis%2Fsrc%2Fcheck%2Fwfcheck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0ff1d1e122766d44292d22245c05e53d9b324f8e/compiler%2Frustc_hir_analysis%2Fsrc%2Fcheck%2Fwfcheck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_analysis%2Fsrc%2Fcheck%2Fwfcheck.rs?ref=0ff1d1e122766d44292d22245c05e53d9b324f8e", "patch": "@@ -117,7 +117,7 @@ pub(super) fn enter_wf_checking_ctxt<'tcx, F>(\n }\n \n fn check_well_formed(tcx: TyCtxt<'_>, def_id: hir::OwnerId) {\n-    let node = tcx.hir().expect_owner(def_id);\n+    let node = tcx.hir().owner(def_id);\n     match node {\n         hir::OwnerNode::Crate(_) => {}\n         hir::OwnerNode::Item(item) => check_item(tcx, item),"}, {"sha": "efae2669006347a639c77c7243dddf9453d09e6c", "filename": "compiler/rustc_lint/src/levels.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0ff1d1e122766d44292d22245c05e53d9b324f8e/compiler%2Frustc_lint%2Fsrc%2Flevels.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0ff1d1e122766d44292d22245c05e53d9b324f8e/compiler%2Frustc_lint%2Fsrc%2Flevels.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Flevels.rs?ref=0ff1d1e122766d44292d22245c05e53d9b324f8e", "patch": "@@ -163,7 +163,7 @@ fn shallow_lint_levels_on(tcx: TyCtxt<'_>, owner: hir::OwnerId) -> ShallowLintLe\n         // Otherwise, we need to visit the attributes in source code order, so we fetch HIR and do\n         // a standard visit.\n         // FIXME(#102522) Just iterate on attrs once that iteration order matches HIR's.\n-        _ => match tcx.hir().expect_owner(owner) {\n+        _ => match tcx.hir().owner(owner) {\n             hir::OwnerNode::Item(item) => levels.visit_item(item),\n             hir::OwnerNode::ForeignItem(item) => levels.visit_foreign_item(item),\n             hir::OwnerNode::TraitItem(item) => levels.visit_trait_item(item),"}, {"sha": "14f50ae87de0639fc4c58f88dfbc5c89c6ec9e21", "filename": "compiler/rustc_middle/src/hir/map/mod.rs", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/0ff1d1e122766d44292d22245c05e53d9b324f8e/compiler%2Frustc_middle%2Fsrc%2Fhir%2Fmap%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0ff1d1e122766d44292d22245c05e53d9b324f8e/compiler%2Frustc_middle%2Fsrc%2Fhir%2Fmap%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fhir%2Fmap%2Fmod.rs?ref=0ff1d1e122766d44292d22245c05e53d9b324f8e", "patch": "@@ -353,6 +353,10 @@ impl<'hir> Map<'hir> {\n         node.node.generics()\n     }\n \n+    pub fn owner(self, id: OwnerId) -> OwnerNode<'hir> {\n+        self.tcx.hir_owner(id).unwrap_or_else(|| bug!(\"expected owner for {:?}\", id)).node\n+    }\n+\n     pub fn item(self, id: ItemId) -> &'hir Item<'hir> {\n         self.tcx.hir_owner(id.owner_id).unwrap().node.expect_item()\n     }\n@@ -822,8 +826,11 @@ impl<'hir> Map<'hir> {\n         )\n     }\n \n-    pub fn expect_owner(self, id: OwnerId) -> OwnerNode<'hir> {\n-        self.tcx.hir_owner(id).unwrap_or_else(|| bug!(\"expected owner for {:?}\", id)).node\n+    pub fn expect_owner(self, def_id: LocalDefId) -> OwnerNode<'hir> {\n+        self.tcx\n+            .hir_owner(OwnerId { def_id })\n+            .unwrap_or_else(|| bug!(\"expected owner for {:?}\", def_id))\n+            .node\n     }\n \n     pub fn expect_item(self, id: LocalDefId) -> &'hir Item<'hir> {"}]}