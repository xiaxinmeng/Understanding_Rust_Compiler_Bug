{"sha": "39116d01914854882f62b1306e8b96fb0b4f9842", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM5MTE2ZDAxOTE0ODU0ODgyZjYyYjEzMDZlOGI5NmZiMGI0Zjk4NDI=", "commit": {"author": {"name": "Julian Orth", "email": "ju.orth@gmail.com", "date": "2014-09-18T20:16:47Z"}, "committer": {"name": "Julian Orth", "email": "ju.orth@gmail.com", "date": "2014-09-18T20:16:47Z"}, "message": "fix for vim < 7.4.355", "tree": {"sha": "8e68ab7e6d60d539c8286d1d4c2a70999616c84b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8e68ab7e6d60d539c8286d1d4c2a70999616c84b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/39116d01914854882f62b1306e8b96fb0b4f9842", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/39116d01914854882f62b1306e8b96fb0b4f9842", "html_url": "https://github.com/rust-lang/rust/commit/39116d01914854882f62b1306e8b96fb0b4f9842", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/39116d01914854882f62b1306e8b96fb0b4f9842/comments", "author": {"login": "mahkoh", "id": 1882250, "node_id": "MDQ6VXNlcjE4ODIyNTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1882250?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mahkoh", "html_url": "https://github.com/mahkoh", "followers_url": "https://api.github.com/users/mahkoh/followers", "following_url": "https://api.github.com/users/mahkoh/following{/other_user}", "gists_url": "https://api.github.com/users/mahkoh/gists{/gist_id}", "starred_url": "https://api.github.com/users/mahkoh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mahkoh/subscriptions", "organizations_url": "https://api.github.com/users/mahkoh/orgs", "repos_url": "https://api.github.com/users/mahkoh/repos", "events_url": "https://api.github.com/users/mahkoh/events{/privacy}", "received_events_url": "https://api.github.com/users/mahkoh/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mahkoh", "id": 1882250, "node_id": "MDQ6VXNlcjE4ODIyNTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1882250?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mahkoh", "html_url": "https://github.com/mahkoh", "followers_url": "https://api.github.com/users/mahkoh/followers", "following_url": "https://api.github.com/users/mahkoh/following{/other_user}", "gists_url": "https://api.github.com/users/mahkoh/gists{/gist_id}", "starred_url": "https://api.github.com/users/mahkoh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mahkoh/subscriptions", "organizations_url": "https://api.github.com/users/mahkoh/orgs", "repos_url": "https://api.github.com/users/mahkoh/repos", "events_url": "https://api.github.com/users/mahkoh/events{/privacy}", "received_events_url": "https://api.github.com/users/mahkoh/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9c72da52514428c187742de3e8b796949e72d34f", "url": "https://api.github.com/repos/rust-lang/rust/commits/9c72da52514428c187742de3e8b796949e72d34f", "html_url": "https://github.com/rust-lang/rust/commit/9c72da52514428c187742de3e8b796949e72d34f"}], "stats": {"total": 37, "additions": 37, "deletions": 0}, "files": [{"sha": "300d7dacfa9ae57c3b119470448f7e91f6a7d992", "filename": "src/etc/vim/indent/rust.vim", "status": "modified", "additions": 37, "deletions": 0, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/39116d01914854882f62b1306e8b96fb0b4f9842/src%2Fetc%2Fvim%2Findent%2Frust.vim", "raw_url": "https://github.com/rust-lang/rust/raw/39116d01914854882f62b1306e8b96fb0b4f9842/src%2Fetc%2Fvim%2Findent%2Frust.vim", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fvim%2Findent%2Frust.vim?ref=39116d01914854882f62b1306e8b96fb0b4f9842", "patch": "@@ -154,6 +154,43 @@ function GetRustIndent(lnum)\n \t\treturn indent(prevlinenum)\n \tendif\n \n+\tif !has(\"patch-7.4.355\")\n+\t\t\" cindent before 7.4.355 doesn't do the module scope well at all; e.g.::\n+\t\t\"\n+\t\t\" static FOO : &'static [bool] = [\n+\t\t\" true,\n+\t\t\"\t false,\n+\t\t\"\t false,\n+\t\t\"\t true,\n+\t\t\"\t ];\n+\t\t\"\n+\t\t\"\t uh oh, next statement is indented further!\n+\n+\t\t\" Note that this does *not* apply the line continuation pattern properly;\n+\t\t\" that's too hard to do correctly for my liking at present, so I'll just\n+\t\t\" start with these two main cases (square brackets and not returning to\n+\t\t\" column zero)\n+\n+\t\tcall cursor(a:lnum, 1)\n+\t\tif searchpair('{\\|(', '', '}\\|)', 'nbW',\n+\t\t\t\t\t\\ 's:is_string_comment(line(\".\"), col(\".\"))') == 0\n+\t\t\tif searchpair('\\[', '', '\\]', 'nbW',\n+\t\t\t\t\t\t\\ 's:is_string_comment(line(\".\"), col(\".\"))') == 0\n+\t\t\t\t\" Global scope, should be zero\n+\t\t\t\treturn 0\n+\t\t\telse\n+\t\t\t\t\" At the module scope, inside square brackets only\n+\t\t\t\t\"if getline(a:lnum)[0] == ']' || search('\\[', '', '\\]', 'nW') == a:lnum\n+\t\t\t\tif line =~ \"^\\\\s*]\"\n+\t\t\t\t\t\" It's the closing line, dedent it\n+\t\t\t\t\treturn 0\n+\t\t\t\telse\n+\t\t\t\t\treturn &shiftwidth\n+\t\t\t\tendif\n+\t\t\tendif\n+\t\tendif\n+\tendif\n+\n \t\" Fall back on cindent, which does it mostly right\n \treturn cindent(a:lnum)\n endfunction"}]}