{"sha": "369f4774ddf2511912f70584acbe523bb8b6b6f0", "node_id": "C_kwDOAAsO6NoAKDM2OWY0Nzc0ZGRmMjUxMTkxMmY3MDU4NGFjYmU1MjNiYjhiNmI2ZjA", "commit": {"author": {"name": "DropDemBits", "email": "r3usrlnd@gmail.com", "date": "2023-03-26T22:09:36Z"}, "committer": {"name": "DropDemBits", "email": "r3usrlnd@gmail.com", "date": "2023-03-26T22:10:41Z"}, "message": "fix: Move cursor before generated generic", "tree": {"sha": "684da3565f52a42b8c9614a5393af61469e9b82f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/684da3565f52a42b8c9614a5393af61469e9b82f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/369f4774ddf2511912f70584acbe523bb8b6b6f0", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYKAB0WIQTeuYGhWxN6R+Ctnb9/4CpsHt+gdQUCZCDC5AAKCRB/4CpsHt+g\ndab4AQCvsqQMhBTCtvNxiz3yOLrBKY3E/X9w4uVFI0VTtuNpAQEAzQ7PjgQq9nah\n74C/mqnkRDN+tTAY8nOW9zQt7ZO6JAo=\n=ehjY\n-----END PGP SIGNATURE-----", "payload": "tree 684da3565f52a42b8c9614a5393af61469e9b82f\nparent 762eacef74e76d41c7aa5bd714926ce2ad6c50bf\nauthor DropDemBits <r3usrlnd@gmail.com> 1679868576 -0400\ncommitter DropDemBits <r3usrlnd@gmail.com> 1679868641 -0400\n\nfix: Move cursor before generated generic\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/369f4774ddf2511912f70584acbe523bb8b6b6f0", "html_url": "https://github.com/rust-lang/rust/commit/369f4774ddf2511912f70584acbe523bb8b6b6f0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/369f4774ddf2511912f70584acbe523bb8b6b6f0/comments", "author": {"login": "DropDemBits", "id": 13354275, "node_id": "MDQ6VXNlcjEzMzU0Mjc1", "avatar_url": "https://avatars.githubusercontent.com/u/13354275?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DropDemBits", "html_url": "https://github.com/DropDemBits", "followers_url": "https://api.github.com/users/DropDemBits/followers", "following_url": "https://api.github.com/users/DropDemBits/following{/other_user}", "gists_url": "https://api.github.com/users/DropDemBits/gists{/gist_id}", "starred_url": "https://api.github.com/users/DropDemBits/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DropDemBits/subscriptions", "organizations_url": "https://api.github.com/users/DropDemBits/orgs", "repos_url": "https://api.github.com/users/DropDemBits/repos", "events_url": "https://api.github.com/users/DropDemBits/events{/privacy}", "received_events_url": "https://api.github.com/users/DropDemBits/received_events", "type": "User", "site_admin": false}, "committer": {"login": "DropDemBits", "id": 13354275, "node_id": "MDQ6VXNlcjEzMzU0Mjc1", "avatar_url": "https://avatars.githubusercontent.com/u/13354275?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DropDemBits", "html_url": "https://github.com/DropDemBits", "followers_url": "https://api.github.com/users/DropDemBits/followers", "following_url": "https://api.github.com/users/DropDemBits/following{/other_user}", "gists_url": "https://api.github.com/users/DropDemBits/gists{/gist_id}", "starred_url": "https://api.github.com/users/DropDemBits/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DropDemBits/subscriptions", "organizations_url": "https://api.github.com/users/DropDemBits/orgs", "repos_url": "https://api.github.com/users/DropDemBits/repos", "events_url": "https://api.github.com/users/DropDemBits/events{/privacy}", "received_events_url": "https://api.github.com/users/DropDemBits/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "762eacef74e76d41c7aa5bd714926ce2ad6c50bf", "url": "https://api.github.com/repos/rust-lang/rust/commits/762eacef74e76d41c7aa5bd714926ce2ad6c50bf", "html_url": "https://github.com/rust-lang/rust/commit/762eacef74e76d41c7aa5bd714926ce2ad6c50bf"}], "stats": {"total": 32, "additions": 20, "deletions": 12}, "files": [{"sha": "b0d35c02d67bac16be2505cc1711a852f25ca6f7", "filename": "crates/ide-assists/src/handlers/introduce_named_generic.rs", "status": "modified", "additions": 19, "deletions": 11, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/369f4774ddf2511912f70584acbe523bb8b6b6f0/crates%2Fide-assists%2Fsrc%2Fhandlers%2Fintroduce_named_generic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/369f4774ddf2511912f70584acbe523bb8b6b6f0/crates%2Fide-assists%2Fsrc%2Fhandlers%2Fintroduce_named_generic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide-assists%2Fsrc%2Fhandlers%2Fintroduce_named_generic.rs?ref=369f4774ddf2511912f70584acbe523bb8b6b6f0", "patch": "@@ -1,5 +1,5 @@\n use syntax::{\n-    ast::{self, edit_in_place::GenericParamsOwnerEdit, make, AstNode},\n+    ast::{self, edit_in_place::GenericParamsOwnerEdit, make, AstNode, HasGenericParams},\n     ted,\n };\n \n@@ -14,7 +14,7 @@ use crate::{utils::suggest_name, AssistContext, AssistId, AssistKind, Assists};\n // ```\n // ->\n // ```\n-// fn foo<B: Bar>(bar: B) {}\n+// fn foo<$0B: Bar>(bar: B) {}\n // ```\n pub(crate) fn introduce_named_generic(acc: &mut Assists, ctx: &AssistContext<'_>) -> Option<()> {\n     let impl_trait_type = ctx.find_node_at_offset::<ast::ImplTraitType>()?;\n@@ -39,7 +39,15 @@ pub(crate) fn introduce_named_generic(acc: &mut Assists, ctx: &AssistContext<'_>\n             let new_ty = make::ty(&type_param_name).clone_for_update();\n \n             ted::replace(impl_trait_type.syntax(), new_ty.syntax());\n-            fn_.get_or_create_generic_param_list().add_generic_param(type_param.into())\n+            fn_.get_or_create_generic_param_list().add_generic_param(type_param.into());\n+\n+            if let Some(cap) = ctx.config.snippet_cap {\n+                if let Some(generic_param) =\n+                    fn_.generic_param_list().and_then(|it| it.generic_params().last())\n+                {\n+                    edit.add_tabstop_before(cap, generic_param);\n+                }\n+            }\n         },\n     )\n }\n@@ -55,7 +63,7 @@ mod tests {\n         check_assist(\n             introduce_named_generic,\n             r#\"fn foo<G>(bar: $0impl Bar) {}\"#,\n-            r#\"fn foo<G, B: Bar>(bar: B) {}\"#,\n+            r#\"fn foo<G, $0B: Bar>(bar: B) {}\"#,\n         );\n     }\n \n@@ -64,7 +72,7 @@ mod tests {\n         check_assist(\n             introduce_named_generic,\n             r#\"fn foo(bar: $0impl Bar) {}\"#,\n-            r#\"fn foo<B: Bar>(bar: B) {}\"#,\n+            r#\"fn foo<$0B: Bar>(bar: B) {}\"#,\n         );\n     }\n \n@@ -73,7 +81,7 @@ mod tests {\n         check_assist(\n             introduce_named_generic,\n             r#\"fn foo<G>(foo: impl Foo, bar: $0impl Bar) {}\"#,\n-            r#\"fn foo<G, B: Bar>(foo: impl Foo, bar: B) {}\"#,\n+            r#\"fn foo<G, $0B: Bar>(foo: impl Foo, bar: B) {}\"#,\n         );\n     }\n \n@@ -82,7 +90,7 @@ mod tests {\n         check_assist(\n             introduce_named_generic,\n             r#\"fn foo<>(bar: $0impl Bar) {}\"#,\n-            r#\"fn foo<B: Bar>(bar: B) {}\"#,\n+            r#\"fn foo<$0B: Bar>(bar: B) {}\"#,\n         );\n     }\n \n@@ -95,7 +103,7 @@ fn foo<\n >(bar: $0impl Bar) {}\n \"#,\n             r#\"\n-fn foo<B: Bar\n+fn foo<$0B: Bar\n >(bar: B) {}\n \"#,\n         );\n@@ -108,7 +116,7 @@ fn foo<B: Bar\n         check_assist(\n             introduce_named_generic,\n             r#\"fn foo<B>(bar: $0impl Bar) {}\"#,\n-            r#\"fn foo<B, B: Bar>(bar: B) {}\"#,\n+            r#\"fn foo<B, $0B: Bar>(bar: B) {}\"#,\n         );\n     }\n \n@@ -127,7 +135,7 @@ fn foo<\n fn foo<\n     G: Foo,\n     F,\n-    H, B: Bar,\n+    H, $0B: Bar,\n >(bar: B) {}\n \"#,\n         );\n@@ -138,7 +146,7 @@ fn foo<\n         check_assist(\n             introduce_named_generic,\n             r#\"fn foo(bar: $0impl Foo + Bar) {}\"#,\n-            r#\"fn foo<F: Foo + Bar>(bar: F) {}\"#,\n+            r#\"fn foo<$0F: Foo + Bar>(bar: F) {}\"#,\n         );\n     }\n }"}, {"sha": "48e786b23a6d884d14e69c2c1b631dab8a3d8437", "filename": "crates/ide-assists/src/tests/generated.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/369f4774ddf2511912f70584acbe523bb8b6b6f0/crates%2Fide-assists%2Fsrc%2Ftests%2Fgenerated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/369f4774ddf2511912f70584acbe523bb8b6b6f0/crates%2Fide-assists%2Fsrc%2Ftests%2Fgenerated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide-assists%2Fsrc%2Ftests%2Fgenerated.rs?ref=369f4774ddf2511912f70584acbe523bb8b6b6f0", "patch": "@@ -1596,7 +1596,7 @@ fn doctest_introduce_named_generic() {\n fn foo(bar: $0impl Bar) {}\n \"#####,\n         r#####\"\n-fn foo<B: Bar>(bar: B) {}\n+fn foo<$0B: Bar>(bar: B) {}\n \"#####,\n     )\n }"}]}