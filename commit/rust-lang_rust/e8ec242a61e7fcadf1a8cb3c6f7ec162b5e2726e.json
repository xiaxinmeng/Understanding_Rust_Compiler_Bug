{"sha": "e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e", "node_id": "C_kwDOAAsO6NoAKGU4ZWMyNDJhNjFlN2ZjYWRmMWE4Y2IzYzZmN2VjMTYyYjVlMjcyNmU", "commit": {"author": {"name": "bluthej", "email": "joffrey.bluthe@e.email", "date": "2023-03-21T21:46:59Z"}, "committer": {"name": "bluthej", "email": "joffrey.bluthe@e.email", "date": "2023-03-22T10:01:57Z"}, "message": "Finish tests - add rustfix", "tree": {"sha": "5fd1c4610254390e72dd338cc8897259128949fe", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5fd1c4610254390e72dd338cc8897259128949fe"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e", "html_url": "https://github.com/rust-lang/rust/commit/e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e/comments", "author": {"login": "bluthej", "id": 29771403, "node_id": "MDQ6VXNlcjI5NzcxNDAz", "avatar_url": "https://avatars.githubusercontent.com/u/29771403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bluthej", "html_url": "https://github.com/bluthej", "followers_url": "https://api.github.com/users/bluthej/followers", "following_url": "https://api.github.com/users/bluthej/following{/other_user}", "gists_url": "https://api.github.com/users/bluthej/gists{/gist_id}", "starred_url": "https://api.github.com/users/bluthej/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bluthej/subscriptions", "organizations_url": "https://api.github.com/users/bluthej/orgs", "repos_url": "https://api.github.com/users/bluthej/repos", "events_url": "https://api.github.com/users/bluthej/events{/privacy}", "received_events_url": "https://api.github.com/users/bluthej/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bluthej", "id": 29771403, "node_id": "MDQ6VXNlcjI5NzcxNDAz", "avatar_url": "https://avatars.githubusercontent.com/u/29771403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bluthej", "html_url": "https://github.com/bluthej", "followers_url": "https://api.github.com/users/bluthej/followers", "following_url": "https://api.github.com/users/bluthej/following{/other_user}", "gists_url": "https://api.github.com/users/bluthej/gists{/gist_id}", "starred_url": "https://api.github.com/users/bluthej/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bluthej/subscriptions", "organizations_url": "https://api.github.com/users/bluthej/orgs", "repos_url": "https://api.github.com/users/bluthej/repos", "events_url": "https://api.github.com/users/bluthej/events{/privacy}", "received_events_url": "https://api.github.com/users/bluthej/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1d0acce984f9be9f085fd5ebcb44dd6988b1f295", "url": "https://api.github.com/repos/rust-lang/rust/commits/1d0acce984f9be9f085fd5ebcb44dd6988b1f295", "html_url": "https://github.com/rust-lang/rust/commit/1d0acce984f9be9f085fd5ebcb44dd6988b1f295"}], "stats": {"total": 71, "additions": 69, "deletions": 2}, "files": [{"sha": "bf7e7d12405117b4732f10c7b7e204ad6db4d1ff", "filename": "clippy_lints/src/methods/clear_with_drain.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e/clippy_lints%2Fsrc%2Fmethods%2Fclear_with_drain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e/clippy_lints%2Fsrc%2Fmethods%2Fclear_with_drain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods%2Fclear_with_drain.rs?ref=e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e", "patch": "@@ -10,8 +10,6 @@ use rustc_span::Span;\n \n use super::CLEAR_WITH_DRAIN;\n \n-// TODO: Adjust the parameters as necessary\n-// see clippy_lints/src/methods/mod.rs to add call to this check in `check_methods`\n pub(super) fn check(cx: &LateContext<'_>, expr: &Expr<'_>, recv: &Expr<'_>, span: Span, arg: &Expr<'_>) {\n     let ty = cx.typeck_results().expr_ty(recv);\n     if is_type_diagnostic_item(cx, ty, sym::Vec) && let Some(range) = Range::hir(arg) && is_range_full(cx, recv, range)"}, {"sha": "62b0af08eeae3ea44c6c19c2c372b0d4a772e6e5", "filename": "tests/ui/clear_with_drain.fixed", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e/tests%2Fui%2Fclear_with_drain.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e/tests%2Fui%2Fclear_with_drain.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fclear_with_drain.fixed?ref=e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e", "patch": "@@ -0,0 +1,40 @@\n+// run-rustfix\n+#![allow(unused)]\n+#![warn(clippy::clear_with_drain)]\n+\n+fn range() {\n+    let (mut u, mut v) = (vec![1, 2, 3], vec![1, 2, 3]);\n+    let iter = u.drain(0..u.len()); // Yay\n+    v.clear(); // Nay\n+}\n+\n+fn range_from() {\n+    let (mut u, mut v) = (vec![1, 2, 3], vec![1, 2, 3]);\n+    let iter = u.drain(0..); // Yay\n+    v.clear(); // Nay\n+}\n+\n+fn range_full() {\n+    let (mut u, mut v) = (vec![1, 2, 3], vec![1, 2, 3]);\n+    let iter = u.drain(..); // Yay\n+    v.clear(); // Nay\n+}\n+\n+fn range_to() {\n+    let (mut u, mut v) = (vec![1, 2, 3], vec![1, 2, 3]);\n+    let iter = u.drain(..u.len()); // Yay\n+    v.clear(); // Nay\n+}\n+\n+fn partial_drains() {\n+    let mut v = vec![1, 2, 3];\n+    v.drain(1..); // Yay\n+\n+    let mut v = vec![1, 2, 3];\n+    v.drain(..v.len() - 1); // Yay\n+\n+    let mut v = vec![1, 2, 3];\n+    v.drain(1..v.len() - 1); // Yay\n+}\n+\n+fn main() {}"}, {"sha": "721af7d2ea7e30c893a6f798f932d096aa228c54", "filename": "tests/ui/clear_with_drain.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e/tests%2Fui%2Fclear_with_drain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e/tests%2Fui%2Fclear_with_drain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fclear_with_drain.rs?ref=e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e", "patch": "@@ -1,3 +1,4 @@\n+// run-rustfix\n #![allow(unused)]\n #![warn(clippy::clear_with_drain)]\n "}, {"sha": "0d6d8263e10dadcd03b081b6c9c6bb0fcfb59807", "filename": "tests/ui/clear_with_drain.stderr", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e/tests%2Fui%2Fclear_with_drain.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e/tests%2Fui%2Fclear_with_drain.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fclear_with_drain.stderr?ref=e8ec242a61e7fcadf1a8cb3c6f7ec162b5e2726e", "patch": "@@ -0,0 +1,28 @@\n+error: `drain` used to clear a `Vec`\n+  --> $DIR/clear_with_drain.rs:8:7\n+   |\n+LL |     v.drain(0..v.len()); // Nay\n+   |       ^^^^^^^^^^^^^^^^^ help: try: `clear()`\n+   |\n+   = note: `-D clippy::clear-with-drain` implied by `-D warnings`\n+\n+error: `drain` used to clear a `Vec`\n+  --> $DIR/clear_with_drain.rs:14:7\n+   |\n+LL |     v.drain(0..); // Nay\n+   |       ^^^^^^^^^^ help: try: `clear()`\n+\n+error: `drain` used to clear a `Vec`\n+  --> $DIR/clear_with_drain.rs:20:7\n+   |\n+LL |     v.drain(..); // Nay\n+   |       ^^^^^^^^^ help: try: `clear()`\n+\n+error: `drain` used to clear a `Vec`\n+  --> $DIR/clear_with_drain.rs:26:7\n+   |\n+LL |     v.drain(..v.len()); // Nay\n+   |       ^^^^^^^^^^^^^^^^ help: try: `clear()`\n+\n+error: aborting due to 4 previous errors\n+"}]}