{"sha": "5edeff31305c36a440ca8482043ad52e6f14b0ed", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVlZGVmZjMxMzA1YzM2YTQ0MGNhODQ4MjA0M2FkNTJlNmYxNGIwZWQ=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-02-02T08:29:21Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-02-02T14:48:47Z"}, "message": "Rollup merge of #47916 - vmx:patch-2, r=kennytm Fix lang items box example code The `exchange_free` lang item is gone in favour of `box_free` [1]. Some warnings are also fixed by this commit. [1]: https://github.com/rust-lang/rust/commit/ca115dd083a1fe1d2b4892c5e50e49eb83ff1f3", "tree": {"sha": "400be1167f4584a92d59463d327b300d0997c1f3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/400be1167f4584a92d59463d327b300d0997c1f3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5edeff31305c36a440ca8482043ad52e6f14b0ed", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlp0ek8ACgkQ/vbIBR0O\nATwbbhAAi/9dN0olXMZgCBScsVYfdpnUSOiD/6NhfbqzEaYi0yPkEHxpCBJN4tM3\n9vsYDhuG8OSifqymQrPQ1XzLU5F6y96GrTdpZrHqy8Y5QdX8xq/uNcOpPrRo1+pq\n3/E9b8FeSjBJCucwDV3qB4769VGnml/4jNNLnI4BYg6UpZgJD7qqlrmnbsncr+Hc\nqV4b7SASseoQ9tzTcnPNs1XD0nAJdX+oSIkqU3A61hNPyTCfT/qtya2xCTt1MERO\nBaClJyczqa39VCuGL35EUwCOy3uOIIEsONrzrJSL/MKOEC5zj5ggeOdEiRmGe4pX\n8xh0zJ7jcdbeaFzOQMcV7/UHIZoBZwB7Ft7yTtHp1wznYjjdGSs5VnlVPTHb5AMt\n4i6HJdolF8pA3bdot3DSx2sEy1WqX7U+aBhG5U51idolu9mnnOdOI+BDwAIEHqXu\nCXYGJL5H+b6AzKs5P9eADC5e7lZZxgWhMRDNxSeyYkTPSdUzBlLRpmmTJG+OBuF+\nbM8kwSERV/e/hlFAhWHiCMiOlzkU8oYT7chkXjFt13VxnPUO5FiJNDOzibvx5dPB\naU1h2pZwJzwfYlrg2RU7hy0gMQTMVighR4LYBOOZSQg5PtNu2cC7xP2nPO7jhkzH\nzqPBNZwzbAMUMfWe0xBvnDU9Ai0fnDY5MWY0FLSBDS4Uuy8qofQ=\n=dxw/\n-----END PGP SIGNATURE-----", "payload": "tree 400be1167f4584a92d59463d327b300d0997c1f3\nparent b4b73a1d95814d56cdb34720d6fb01544a1e8d11\nparent cf78ff3913f3efeefb2c90dcae18682f460b0d84\nauthor kennytm <kennytm@gmail.com> 1517560161 +0800\ncommitter kennytm <kennytm@gmail.com> 1517582927 +0800\n\nRollup merge of #47916 - vmx:patch-2, r=kennytm Fix lang items box example code The `exchange_free` lang item is gone in favour of `box_free` [1]. Some warnings are also fixed by this commit. [1]: https://github.com/rust-lang/rust/commit/ca115dd083a1fe1d2b4892c5e50e49eb83ff1f3\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5edeff31305c36a440ca8482043ad52e6f14b0ed", "html_url": "https://github.com/rust-lang/rust/commit/5edeff31305c36a440ca8482043ad52e6f14b0ed", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5edeff31305c36a440ca8482043ad52e6f14b0ed/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b4b73a1d95814d56cdb34720d6fb01544a1e8d11", "url": "https://api.github.com/repos/rust-lang/rust/commits/b4b73a1d95814d56cdb34720d6fb01544a1e8d11", "html_url": "https://github.com/rust-lang/rust/commit/b4b73a1d95814d56cdb34720d6fb01544a1e8d11"}, {"sha": "cf78ff3913f3efeefb2c90dcae18682f460b0d84", "url": "https://api.github.com/repos/rust-lang/rust/commits/cf78ff3913f3efeefb2c90dcae18682f460b0d84", "html_url": "https://github.com/rust-lang/rust/commit/cf78ff3913f3efeefb2c90dcae18682f460b0d84"}], "stats": {"total": 21, "additions": 8, "deletions": 13}, "files": [{"sha": "c51674186146be3bc1f076adf32f8bd4a8f1a717", "filename": "src/doc/unstable-book/src/language-features/lang-items.md", "status": "modified", "additions": 8, "deletions": 13, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/5edeff31305c36a440ca8482043ad52e6f14b0ed/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Flang-items.md", "raw_url": "https://github.com/rust-lang/rust/raw/5edeff31305c36a440ca8482043ad52e6f14b0ed/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Flang-items.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Flang-items.md?ref=5edeff31305c36a440ca8482043ad52e6f14b0ed", "patch": "@@ -37,28 +37,23 @@ unsafe fn allocate(size: usize, _align: usize) -> *mut u8 {\n     p\n }\n \n-#[lang = \"exchange_free\"]\n-unsafe fn deallocate(ptr: *mut u8, _size: usize, _align: usize) {\n-    libc::free(ptr as *mut libc::c_void)\n-}\n-\n #[lang = \"box_free\"]\n unsafe fn box_free<T: ?Sized>(ptr: *mut T) {\n-    deallocate(ptr as *mut u8, ::core::mem::size_of_val(&*ptr), ::core::mem::align_of_val(&*ptr));\n+    libc::free(ptr as *mut libc::c_void)\n }\n \n #[start]\n-fn main(argc: isize, argv: *const *const u8) -> isize {\n-    let x = box 1;\n+fn main(_argc: isize, _argv: *const *const u8) -> isize {\n+    let _x = box 1;\n \n     0\n }\n \n #[lang = \"eh_personality\"] extern fn rust_eh_personality() {}\n #[lang = \"panic_fmt\"] extern fn rust_begin_panic() -> ! { unsafe { intrinsics::abort() } }\n-# #[lang = \"eh_unwind_resume\"] extern fn rust_eh_unwind_resume() {}\n-# #[no_mangle] pub extern fn rust_eh_register_frames () {}\n-# #[no_mangle] pub extern fn rust_eh_unregister_frames () {}\n+#[lang = \"eh_unwind_resume\"] extern fn rust_eh_unwind_resume() {}\n+#[no_mangle] pub extern fn rust_eh_register_frames () {}\n+#[no_mangle] pub extern fn rust_eh_unregister_frames () {}\n ```\n \n Note the use of `abort`: the `exchange_malloc` lang item is assumed to\n@@ -80,7 +75,7 @@ Other features provided by lang items include:\n \n Lang items are loaded lazily by the compiler; e.g. if one never uses\n `Box` then there is no need to define functions for `exchange_malloc`\n-and `exchange_free`. `rustc` will emit an error when an item is needed\n+and `box_free`. `rustc` will emit an error when an item is needed\n but not found in the current crate or any that it depends on.\n \n Most lang items are defined by `libcore`, but if you're trying to build\n@@ -318,4 +313,4 @@ the source code.\n   - `phantom_data`: `libcore/marker.rs`\n   - `freeze`: `libcore/marker.rs`\n   - `debug_trait`: `libcore/fmt/mod.rs`\n-  - `non_zero`: `libcore/nonzero.rs`\n\\ No newline at end of file\n+  - `non_zero`: `libcore/nonzero.rs`"}]}