{"sha": "9151874f406c5caf723d8cd6c09f1a9029b4d038", "node_id": "MDY6Q29tbWl0NzI0NzEyOjkxNTE4NzRmNDA2YzVjYWY3MjNkOGNkNmMwOWYxYTkwMjliNGQwMzg=", "commit": {"author": {"name": "Huon Wilson", "email": "dbau.pp+github@gmail.com", "date": "2014-09-06T00:35:19Z"}, "committer": {"name": "Huon Wilson", "email": "dbau.pp+github@gmail.com", "date": "2014-09-06T01:04:39Z"}, "message": "Use more jQuery to avoid displaying Expand Description more often.\n\nSometimes (e.g. on Rust CI) the \"expand description\" text of the\ncollapse toggle was displayed by default, when a page is first\nloaded (even though the description is expanded), because some\nContent-Security-Policy settings disable inline CSS.\n\nSetting it the style with the `.css` method allows the output to be used\nin more places.", "tree": {"sha": "8d0fa6429de066fee18885a2b75edd14a2405e04", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8d0fa6429de066fee18885a2b75edd14a2405e04"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9151874f406c5caf723d8cd6c09f1a9029b4d038", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9151874f406c5caf723d8cd6c09f1a9029b4d038", "html_url": "https://github.com/rust-lang/rust/commit/9151874f406c5caf723d8cd6c09f1a9029b4d038", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9151874f406c5caf723d8cd6c09f1a9029b4d038/comments", "author": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5dfb7a6ec1c1b7827a1f019b276c4d959cf2d71e", "url": "https://api.github.com/repos/rust-lang/rust/commits/5dfb7a6ec1c1b7827a1f019b276c4d959cf2d71e", "html_url": "https://github.com/rust-lang/rust/commit/5dfb7a6ec1c1b7827a1f019b276c4d959cf2d71e"}], "stats": {"total": 27, "additions": 14, "deletions": 13}, "files": [{"sha": "1ea86e84c83d78caf0922cf9abaede4b7b68431c", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 14, "deletions": 13, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/9151874f406c5caf723d8cd6c09f1a9029b4d038/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/9151874f406c5caf723d8cd6c09f1a9029b4d038/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=9151874f406c5caf723d8cd6c09f1a9029b4d038", "patch": "@@ -118,7 +118,7 @@\n      * A function to compute the Levenshtein distance between two strings\n      * Licensed under the Creative Commons Attribution-ShareAlike 3.0 Unported\n      * Full License can be found at http://creativecommons.org/licenses/by-sa/3.0/legalcode\n-     * This code is an unmodified version of the code written by Marco de Wit \n+     * This code is an unmodified version of the code written by Marco de Wit\n      * and was found at http://stackoverflow.com/a/18514751/745719\n      */\n     var levenshtein = (function() {\n@@ -224,7 +224,7 @@\n                                 });\n                             }\n                         } else if (\n-                            (lev_distance = levenshtein(searchWords[j], val)) <= \n+                            (lev_distance = levenshtein(searchWords[j], val)) <=\n                                 MAX_LEV_DISTANCE) {\n                             if (typeFilter < 0 || typeFilter === searchIndex[j].ty) {\n                                 results.push({\n@@ -350,16 +350,16 @@\n         function validateResult(name, path, keys, parent) {\n             for (var i=0; i < keys.length; ++i) {\n                 // each check is for validation so we negate the conditions and invalidate\n-                if (!( \n+                if (!(\n                     // check for an exact name match\n                     name.toLowerCase().indexOf(keys[i]) > -1 ||\n                     // then an exact path match\n                     path.toLowerCase().indexOf(keys[i]) > -1 ||\n                     // next if there is a parent, check for exact parent match\n-                    (parent !== undefined && \n+                    (parent !== undefined &&\n                         parent.name.toLowerCase().indexOf(keys[i]) > -1) ||\n                     // lastly check to see if the name was a levenshtein match\n-                    levenshtein(name.toLowerCase(), keys[i]) <= \n+                    levenshtein(name.toLowerCase(), keys[i]) <=\n                         MAX_LEV_DISTANCE)) {\n                     return false;\n                 }\n@@ -765,20 +765,21 @@\n     });\n \n     $(function() {\n-        var toggle = \"<a href='javascript:void(0)'\"\n-            + \"class='collapse-toggle'>[<span class='inner'>-</span>]</a>\";\n+        var toggle = $(\"<a/>\", {'href': 'javascript:void(0)', 'class': 'collapse-toggle'})\n+            .html(\"[<span class='inner'>-</span>]\");\n \n         $(\".method\").each(function() {\n            if ($(this).next().is(\".docblock\")) {\n-               $(this).children().first().after(toggle);\n+               $(this).children().first().after(toggle[0]);\n            }\n         });\n \n-        var mainToggle = $(toggle);\n-        mainToggle.append(\"<span class='toggle-label' style='display:none'>\"\n-            + \"&nbsp;Expand&nbsp;description</span></a>\")\n-        var wrapper =  $(\"<div class='toggle-wrapper'>\");\n-        wrapper.append(mainToggle);\n+        var mainToggle =\n+            $(toggle).append(\n+                $('<span/>', {'class': 'toggle-label'})\n+                    .css('display', 'none')\n+                    .html('&nbsp;Expand&nbsp;description'));\n+        var wrapper =  $(\"<div class='toggle-wrapper'>\").append(mainToggle);\n         $(\"#main > .docblock\").before(wrapper);\n     });\n "}]}