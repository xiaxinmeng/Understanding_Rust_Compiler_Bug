{"sha": "663ce0e99d8aa11707dd2ca22956552859b6ea12", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY2M2NlMGU5OWQ4YWExMTcwN2RkMmNhMjI5NTY1NTI4NTliNmVhMTI=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-06-11T11:26:48Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-06-11T11:34:09Z"}, "message": "Remove dead code", "tree": {"sha": "d69beeca1bea4a205c09778952536ebd3be91e25", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d69beeca1bea4a205c09778952536ebd3be91e25"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/663ce0e99d8aa11707dd2ca22956552859b6ea12", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/663ce0e99d8aa11707dd2ca22956552859b6ea12", "html_url": "https://github.com/rust-lang/rust/commit/663ce0e99d8aa11707dd2ca22956552859b6ea12", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/663ce0e99d8aa11707dd2ca22956552859b6ea12/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "32157d48f449125febaade6bda0184334b6da4fd", "url": "https://api.github.com/repos/rust-lang/rust/commits/32157d48f449125febaade6bda0184334b6da4fd", "html_url": "https://github.com/rust-lang/rust/commit/32157d48f449125febaade6bda0184334b6da4fd"}], "stats": {"total": 32, "additions": 3, "deletions": 29}, "files": [{"sha": "2fc796a859228a9767cae733b0f7fb0cea507b03", "filename": "crates/ra_ide_db/src/change.rs", "status": "modified", "additions": 1, "deletions": 8, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/663ce0e99d8aa11707dd2ca22956552859b6ea12/crates%2Fra_ide_db%2Fsrc%2Fchange.rs", "raw_url": "https://github.com/rust-lang/rust/raw/663ce0e99d8aa11707dd2ca22956552859b6ea12/crates%2Fra_ide_db%2Fsrc%2Fchange.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_db%2Fsrc%2Fchange.rs?ref=663ce0e99d8aa11707dd2ca22956552859b6ea12", "patch": "@@ -16,7 +16,7 @@ use rustc_hash::FxHashMap;\n \n use crate::{\n     symbol_index::{SymbolIndex, SymbolsDatabase},\n-    DebugData, RootDatabase,\n+    RootDatabase,\n };\n \n #[derive(Default)]\n@@ -26,7 +26,6 @@ pub struct AnalysisChange {\n     files_changed: Vec<(FileId, Arc<String>)>,\n     libraries_added: Vec<LibraryData>,\n     crate_graph: Option<CrateGraph>,\n-    debug_data: DebugData,\n }\n \n impl fmt::Debug for AnalysisChange {\n@@ -87,10 +86,6 @@ impl AnalysisChange {\n     pub fn set_crate_graph(&mut self, graph: CrateGraph) {\n         self.crate_graph = Some(graph);\n     }\n-\n-    pub fn set_debug_root_path(&mut self, source_root_id: SourceRootId, path: String) {\n-        self.debug_data.root_paths.insert(source_root_id, path);\n-    }\n }\n \n #[derive(Debug)]\n@@ -218,8 +213,6 @@ impl RootDatabase {\n         if let Some(crate_graph) = change.crate_graph {\n             self.set_crate_graph_with_durability(Arc::new(crate_graph), Durability::HIGH)\n         }\n-\n-        Arc::make_mut(&mut self.debug_data).merge(change.debug_data)\n     }\n \n     fn apply_root_change(&mut self, root_id: SourceRootId, root_change: RootChange) {"}, {"sha": "a808de4f113509a549f97d50c4db759d7e0b55e4", "filename": "crates/ra_ide_db/src/lib.rs", "status": "modified", "additions": 2, "deletions": 16, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/663ce0e99d8aa11707dd2ca22956552859b6ea12/crates%2Fra_ide_db%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/663ce0e99d8aa11707dd2ca22956552859b6ea12/crates%2Fra_ide_db%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_db%2Fsrc%2Flib.rs?ref=663ce0e99d8aa11707dd2ca22956552859b6ea12", "patch": "@@ -17,9 +17,9 @@ use hir::db::{AstDatabase, DefDatabase};\n use ra_db::{\n     salsa::{self, Database, Durability},\n     Canceled, CheckCanceled, CrateId, FileId, FileLoader, FileLoaderDelegate, SourceDatabase,\n-    SourceRootId, Upcast,\n+    Upcast,\n };\n-use rustc_hash::{FxHashMap, FxHashSet};\n+use rustc_hash::FxHashSet;\n \n use crate::{line_index::LineIndex, symbol_index::SymbolsDatabase};\n \n@@ -36,7 +36,6 @@ use crate::{line_index::LineIndex, symbol_index::SymbolsDatabase};\n #[derive(Debug)]\n pub struct RootDatabase {\n     runtime: salsa::Runtime<RootDatabase>,\n-    pub(crate) debug_data: Arc<DebugData>,\n     pub last_gc: crate::wasm_shims::Instant,\n     pub last_gc_check: crate::wasm_shims::Instant,\n }\n@@ -98,7 +97,6 @@ impl RootDatabase {\n             runtime: salsa::Runtime::default(),\n             last_gc: crate::wasm_shims::Instant::now(),\n             last_gc_check: crate::wasm_shims::Instant::now(),\n-            debug_data: Default::default(),\n         };\n         db.set_crate_graph_with_durability(Default::default(), Durability::HIGH);\n         db.set_local_roots_with_durability(Default::default(), Durability::HIGH);\n@@ -121,7 +119,6 @@ impl salsa::ParallelDatabase for RootDatabase {\n             runtime: self.runtime.snapshot(self),\n             last_gc: self.last_gc,\n             last_gc_check: self.last_gc_check,\n-            debug_data: Arc::clone(&self.debug_data),\n         })\n     }\n }\n@@ -135,14 +132,3 @@ fn line_index(db: &impl LineIndexDatabase, file_id: FileId) -> Arc<LineIndex> {\n     let text = db.file_text(file_id);\n     Arc::new(LineIndex::new(&*text))\n }\n-\n-#[derive(Debug, Default, Clone)]\n-pub(crate) struct DebugData {\n-    pub(crate) root_paths: FxHashMap<SourceRootId, String>,\n-}\n-\n-impl DebugData {\n-    pub(crate) fn merge(&mut self, other: DebugData) {\n-        self.root_paths.extend(other.root_paths.into_iter());\n-    }\n-}"}, {"sha": "97367d7c60e9af4e5dbe6aa54c7de6cb288f7d6f", "filename": "crates/rust-analyzer/src/cli/load_cargo.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/663ce0e99d8aa11707dd2ca22956552859b6ea12/crates%2Frust-analyzer%2Fsrc%2Fcli%2Fload_cargo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/663ce0e99d8aa11707dd2ca22956552859b6ea12/crates%2Frust-analyzer%2Fsrc%2Fcli%2Fload_cargo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fcli%2Fload_cargo.rs?ref=663ce0e99d8aa11707dd2ca22956552859b6ea12", "patch": "@@ -111,10 +111,6 @@ pub(crate) fn load(\n                         vfs.root2path(root)\n                     );\n                     analysis_change.add_root(source_root_id, is_local);\n-                    analysis_change.set_debug_root_path(\n-                        source_root_id,\n-                        source_roots[&source_root_id].path().display().to_string(),\n-                    );\n \n                     let vfs_root_path = vfs.root2path(root);\n                     if extern_dirs.contains(&vfs_root_path) {"}, {"sha": "21116e165e72e72c797629a0b7dc291ebccd5636", "filename": "crates/rust-analyzer/src/global_state.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/663ce0e99d8aa11707dd2ca22956552859b6ea12/crates%2Frust-analyzer%2Fsrc%2Fglobal_state.rs", "raw_url": "https://github.com/rust-lang/rust/raw/663ce0e99d8aa11707dd2ca22956552859b6ea12/crates%2Frust-analyzer%2Fsrc%2Fglobal_state.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fglobal_state.rs?ref=663ce0e99d8aa11707dd2ca22956552859b6ea12", "patch": "@@ -126,7 +126,6 @@ impl GlobalState {\n             let vfs_root_path = vfs.root2path(r);\n             let is_local = local_roots.iter().any(|it| vfs_root_path.starts_with(it));\n             change.add_root(SourceRootId(r.0), is_local);\n-            change.set_debug_root_path(SourceRootId(r.0), vfs_root_path.display().to_string());\n \n             // FIXME: add path2root in vfs to simpily this logic\n             if extern_dirs.contains(&vfs_root_path) {"}]}