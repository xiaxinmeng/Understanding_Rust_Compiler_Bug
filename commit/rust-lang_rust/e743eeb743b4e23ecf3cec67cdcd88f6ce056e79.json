{"sha": "e743eeb743b4e23ecf3cec67cdcd88f6ce056e79", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU3NDNlZWI3NDNiNGUyM2VjZjNjZWM2N2NkY2Q4OGY2Y2UwNTZlNzk=", "commit": {"author": {"name": "hyd-dev", "email": "yd-huang@outlook.com", "date": "2021-05-22T11:32:55Z"}, "committer": {"name": "hyd-dev", "email": "yd-huang@outlook.com", "date": "2021-05-22T20:24:48Z"}, "message": "Don't evaluate `self.fn_can_unwind(...)` if `can_unwind` is already true", "tree": {"sha": "6bb254249ff84dfb46e3a4c0f113c5662733c613", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6bb254249ff84dfb46e3a4c0f113c5662733c613"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e743eeb743b4e23ecf3cec67cdcd88f6ce056e79", "comment_count": 0, "verification": {"verified": false, "reason": "no_user", "signature": "-----BEGIN PGP SIGNATURE-----\n\niIsEABYIADMWIQRJ2jPMDdiQ+U4U42Z0+n/VuNoUuAUCYKlokBUceWQtaHVhbmdA\nb3V0bG9vay5jb20ACgkQdPp/1bjaFLjkdwEA3a4RVkhRwpLioF+enC8a82k8oCwJ\nhJGgBJJYVLJWYLIBAIU/6Ta5qWWyuXSNRZ4CBzOlVySC0rWhhh2g8DxQbWQL\n=gOx6\n-----END PGP SIGNATURE-----", "payload": "tree 6bb254249ff84dfb46e3a4c0f113c5662733c613\nparent 835405199af7230a0349803f90d3ebd80487f23b\nauthor hyd-dev <yd-huang@outlook.com> 1621683175 +0800\ncommitter hyd-dev <yd-huang@outlook.com> 1621715088 +0800\n\nDon't evaluate `self.fn_can_unwind(...)` if `can_unwind` is already true\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e743eeb743b4e23ecf3cec67cdcd88f6ce056e79", "html_url": "https://github.com/rust-lang/rust/commit/e743eeb743b4e23ecf3cec67cdcd88f6ce056e79", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e743eeb743b4e23ecf3cec67cdcd88f6ce056e79/comments", "author": null, "committer": null, "parents": [{"sha": "835405199af7230a0349803f90d3ebd80487f23b", "url": "https://api.github.com/repos/rust-lang/rust/commits/835405199af7230a0349803f90d3ebd80487f23b", "html_url": "https://github.com/rust-lang/rust/commit/835405199af7230a0349803f90d3ebd80487f23b"}], "stats": {"total": 7, "additions": 4, "deletions": 3}, "files": [{"sha": "2564ea95e43825c45f83a660ad1b613f580a1b61", "filename": "compiler/rustc_mir/src/interpret/terminator.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/e743eeb743b4e23ecf3cec67cdcd88f6ce056e79/compiler%2Frustc_mir%2Fsrc%2Finterpret%2Fterminator.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e743eeb743b4e23ecf3cec67cdcd88f6ce056e79/compiler%2Frustc_mir%2Fsrc%2Finterpret%2Fterminator.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir%2Fsrc%2Finterpret%2Fterminator.rs?ref=e743eeb743b4e23ecf3cec67cdcd88f6ce056e79", "patch": "@@ -306,16 +306,17 @@ impl<'mir, 'tcx: 'mir, M: Machine<'mir, 'tcx>> InterpCx<'mir, 'tcx, M> {\n                     check_abi(callee_abi)?;\n                 }\n \n-                let callee_can_unwind =\n-                    self.fn_can_unwind(self.tcx.codegen_fn_attrs(callee_def_id).flags, callee_abi);\n+                let can_unwind = can_unwind\n+                    && self\n+                        .fn_can_unwind(self.tcx.codegen_fn_attrs(callee_def_id).flags, callee_abi);\n \n                 self.push_stack_frame(\n                     instance,\n                     body,\n                     ret.map(|p| p.0),\n                     StackPopCleanup::Goto {\n                         ret: ret.map(|p| p.1),\n-                        unwind: if can_unwind && callee_can_unwind {\n+                        unwind: if can_unwind {\n                             StackPopUnwind::Cleanup(unwind)\n                         } else {\n                             StackPopUnwind::NotAllowed"}]}