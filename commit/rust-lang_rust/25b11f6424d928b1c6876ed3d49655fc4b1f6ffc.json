{"sha": "25b11f6424d928b1c6876ed3d49655fc4b1f6ffc", "node_id": "C_kwDOAAsO6NoAKDI1YjExZjY0MjRkOTI4YjFjNjg3NmVkM2Q0OTY1NWZjNGIxZjZmZmM", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-07-23T23:22:02Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-07-23T23:22:02Z"}, "message": "attempt to overwrite globally set build.rustc-wrapper", "tree": {"sha": "727c8b7074f704af9c64de2f555e36c1804a72c5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/727c8b7074f704af9c64de2f555e36c1804a72c5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/25b11f6424d928b1c6876ed3d49655fc4b1f6ffc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/25b11f6424d928b1c6876ed3d49655fc4b1f6ffc", "html_url": "https://github.com/rust-lang/rust/commit/25b11f6424d928b1c6876ed3d49655fc4b1f6ffc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/25b11f6424d928b1c6876ed3d49655fc4b1f6ffc/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b2418e82d3375c5c49b097d01bea97e06239918d", "url": "https://api.github.com/repos/rust-lang/rust/commits/b2418e82d3375c5c49b097d01bea97e06239918d", "html_url": "https://github.com/rust-lang/rust/commit/b2418e82d3375c5c49b097d01bea97e06239918d"}], "stats": {"total": 16, "additions": 8, "deletions": 8}, "files": [{"sha": "2478e331191c31c37745a00978879df2240d64d4", "filename": "cargo-miri/bin.rs", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/25b11f6424d928b1c6876ed3d49655fc4b1f6ffc/cargo-miri%2Fbin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/25b11f6424d928b1c6876ed3d49655fc4b1f6ffc/cargo-miri%2Fbin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/cargo-miri%2Fbin.rs?ref=25b11f6424d928b1c6876ed3d49655fc4b1f6ffc", "patch": "@@ -488,14 +488,14 @@ path = \"lib.rs\"\n         command.env(\"RUSTC\", &cargo_miri_path);\n     }\n     command.env(\"MIRI_CALLED_FROM_XARGO\", \"1\");\n-    // Make sure there are no other wrappers or flags getting in our way\n-    // (Cc https://github.com/rust-lang/miri/issues/1421).\n-    // This is consistent with normal `cargo build` that does not apply `RUSTFLAGS`\n-    // to the sysroot either.\n-    command.env_remove(\"RUSTC_WRAPPER\");\n-    command.env_remove(\"RUSTFLAGS\");\n-    // Disable debug assertions in the standard library -- Miri is already slow enough.\n-    // But keep the overflow checks, they are cheap.\n+    // Make sure there are no other wrappers getting in our way\n+    // (Cc https://github.com/rust-lang/miri/issues/1421, https://github.com/rust-lang/miri/issues/2429).\n+    // Looks like setting `RUSTC_WRAPPER` to the empty string overwrites `build.rustc-wrapper` set via `config.toml`.\n+    command.env(\"RUSTC_WRAPPER\", \"\");\n+    // Disable debug assertions in the standard library -- Miri is already slow enough. But keep the\n+    // overflow checks, they are cheap. This completely overwrites flags the user might have set,\n+    // which is consistent with normal `cargo build` that does not apply `RUSTFLAGS` to the sysroot\n+    // either.\n     command.env(\"RUSTFLAGS\", \"-Cdebug-assertions=off -Coverflow-checks=on\");\n     // Manage the output the user sees.\n     if only_setup {"}]}