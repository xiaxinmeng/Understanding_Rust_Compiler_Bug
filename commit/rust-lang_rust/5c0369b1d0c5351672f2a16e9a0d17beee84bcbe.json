{"sha": "5c0369b1d0c5351672f2a16e9a0d17beee84bcbe", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVjMDM2OWIxZDBjNTM1MTY3MmYyYTE2ZTlhMGQxN2JlZWU4NGJjYmU=", "commit": {"author": {"name": "Kirill Bulatov", "email": "mail4score@gmail.com", "date": "2021-05-24T11:52:57Z"}, "committer": {"name": "Kirill Bulatov", "email": "mail4score@gmail.com", "date": "2021-05-24T11:52:57Z"}, "message": "Add a FIXME", "tree": {"sha": "a4593bec458a2a4482ac8e63054e363554f79468", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a4593bec458a2a4482ac8e63054e363554f79468"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5c0369b1d0c5351672f2a16e9a0d17beee84bcbe", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5c0369b1d0c5351672f2a16e9a0d17beee84bcbe", "html_url": "https://github.com/rust-lang/rust/commit/5c0369b1d0c5351672f2a16e9a0d17beee84bcbe", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5c0369b1d0c5351672f2a16e9a0d17beee84bcbe/comments", "author": {"login": "SomeoneToIgnore", "id": 2690773, "node_id": "MDQ6VXNlcjI2OTA3NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/2690773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SomeoneToIgnore", "html_url": "https://github.com/SomeoneToIgnore", "followers_url": "https://api.github.com/users/SomeoneToIgnore/followers", "following_url": "https://api.github.com/users/SomeoneToIgnore/following{/other_user}", "gists_url": "https://api.github.com/users/SomeoneToIgnore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SomeoneToIgnore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SomeoneToIgnore/subscriptions", "organizations_url": "https://api.github.com/users/SomeoneToIgnore/orgs", "repos_url": "https://api.github.com/users/SomeoneToIgnore/repos", "events_url": "https://api.github.com/users/SomeoneToIgnore/events{/privacy}", "received_events_url": "https://api.github.com/users/SomeoneToIgnore/received_events", "type": "User", "site_admin": false}, "committer": {"login": "SomeoneToIgnore", "id": 2690773, "node_id": "MDQ6VXNlcjI2OTA3NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/2690773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SomeoneToIgnore", "html_url": "https://github.com/SomeoneToIgnore", "followers_url": "https://api.github.com/users/SomeoneToIgnore/followers", "following_url": "https://api.github.com/users/SomeoneToIgnore/following{/other_user}", "gists_url": "https://api.github.com/users/SomeoneToIgnore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SomeoneToIgnore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SomeoneToIgnore/subscriptions", "organizations_url": "https://api.github.com/users/SomeoneToIgnore/orgs", "repos_url": "https://api.github.com/users/SomeoneToIgnore/repos", "events_url": "https://api.github.com/users/SomeoneToIgnore/events{/privacy}", "received_events_url": "https://api.github.com/users/SomeoneToIgnore/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d8c36029cc3961ce742aa6e5d59926c5a7e7170a", "url": "https://api.github.com/repos/rust-lang/rust/commits/d8c36029cc3961ce742aa6e5d59926c5a7e7170a", "html_url": "https://github.com/rust-lang/rust/commit/d8c36029cc3961ce742aa6e5d59926c5a7e7170a"}], "stats": {"total": 9, "additions": 9, "deletions": 0}, "files": [{"sha": "84990075f728e4d56be8d31d9156284d56cdf0aa", "filename": "crates/project_model/src/workspace.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/5c0369b1d0c5351672f2a16e9a0d17beee84bcbe/crates%2Fproject_model%2Fsrc%2Fworkspace.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5c0369b1d0c5351672f2a16e9a0d17beee84bcbe/crates%2Fproject_model%2Fsrc%2Fworkspace.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fproject_model%2Fsrc%2Fworkspace.rs?ref=5c0369b1d0c5351672f2a16e9a0d17beee84bcbe", "patch": "@@ -49,6 +49,15 @@ pub enum ProjectWorkspace {\n     },\n     /// Project workspace was manually specified using a `rust-project.json` file.\n     Json { project: ProjectJson, sysroot: Option<Sysroot>, rustc_cfg: Vec<CfgFlag> },\n+\n+    // FIXME: The primary limitation of this approach is that the set of detached files needs to be fixed at the beginning.\n+    // That's not the end user experience we should strive for.\n+    // Ideally, you should be able to just open a random detached file in existing cargo projects, and get the basic features working.\n+    // That needs some changes on the salsa-level though.\n+    // In particular, we should split the unified CrateGraph (which currently has maximal durability) into proper crate graph, and a set of ad hoc roots (with minimal durability).\n+    // Then, we need to hide the graph behind the queries such that most queries look only at the proper crate graph, and fall back to ad hoc roots only if there's no results.\n+    // After this, we should be able to tweak the logic in reload.rs to add newly opened files, which don't belong to any existing crates, to the set of the detached files.\n+    // //\n     /// Project with a set of disjoint files, not belonging to any particular workspace.\n     /// Backed by basic sysroot crates for basic completion and highlighting.\n     DetachedFiles { files: Vec<AbsPathBuf>, sysroot: Sysroot, rustc_cfg: Vec<CfgFlag> },"}]}