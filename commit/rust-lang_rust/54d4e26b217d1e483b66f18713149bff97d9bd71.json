{"sha": "54d4e26b217d1e483b66f18713149bff97d9bd71", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU0ZDRlMjZiMjE3ZDFlNDgzYjY2ZjE4NzEzMTQ5YmZmOTdkOWJkNzE=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-12-22T16:07:37Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-12-22T18:11:51Z"}, "message": "Rollup merge of #56919 - oli-obk:null_ref_array_tuple, r=RalfJung\n\nRemove a wrong multiplier on relocation offset computation\n\nr? @RalfJung\n\nfixes #56800", "tree": {"sha": "80873fb401c7c9a90d6243b77d815ea6b1756d34", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/80873fb401c7c9a90d6243b77d815ea6b1756d34"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/54d4e26b217d1e483b66f18713149bff97d9bd71", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlwefmcACgkQ/vbIBR0O\nATzX/hAArq8InKEdJ9C63ueMhQWaF12onAyFKkaypwheTPWTjaSOKpU3aG+EVHDv\nJPTLLS6m4ZVY6gN2dlS0N+nY26tCSZIeACKkmMCMx4R5yLG9yWb2sgMSQMsU7IG7\n3sMKvT23GYqDBWCbT+T1TXzOXPR9N51QVDF0vmYOVCNPQFGpQkLYrNKw9e4gCpg7\nEGDvx/oiXqCDYgfwaMfcI1RTiM68Z8erjcuOTHJ2gAbkwmWHM425jfkeTza35HP3\nrzevdTGKWvOs7tdCwDxRVFiJL9fTraBYUSshJW+tCOTPU/8CsWkO2A14xTWIoo3w\nchMn2WiQuAasz0WikRsLyb0WGwtHKyH5Qd0DW/bgiz+ucLaSPLGtZoeGv15xa2u/\nKb1F1YgANvquw1bFDPQb56FmujJHrr6n7eJ/reOcYlmvOJ23BKxGH2BRywk6f27B\nwq/04uSedJhWw76L3N+LSo/Ns4Sela5pQLDS2ISXjEzc4LHkClegw6R/kGOBmNWd\nn6xSMaRGERIslPHK/EBr1gsMVQRtyPoAefaRitLmnixTu9edxFrzkI6k2gPe38Nu\nWM+fLPCHGvDNXPEtEMm649H2gD47vD1nfn14ZgoWbXCqc8m3lmspNGkD3uQL3mia\nXGvDg+UKbs3xPJBxaRy0OOItpeC2MRfA9VdPZLqREMu9cSXjsO4=\n=rXaI\n-----END PGP SIGNATURE-----", "payload": "tree 80873fb401c7c9a90d6243b77d815ea6b1756d34\nparent beaf07182253e8055b5b9abc5919bab6559d53f7\nparent 50eb5f6137719a7e8fdd270e90af0d734d002c5d\nauthor kennytm <kennytm@gmail.com> 1545494857 +0800\ncommitter kennytm <kennytm@gmail.com> 1545502311 +0800\n\nRollup merge of #56919 - oli-obk:null_ref_array_tuple, r=RalfJung\n\nRemove a wrong multiplier on relocation offset computation\n\nr? @RalfJung\n\nfixes #56800\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/54d4e26b217d1e483b66f18713149bff97d9bd71", "html_url": "https://github.com/rust-lang/rust/commit/54d4e26b217d1e483b66f18713149bff97d9bd71", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/54d4e26b217d1e483b66f18713149bff97d9bd71/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "beaf07182253e8055b5b9abc5919bab6559d53f7", "url": "https://api.github.com/repos/rust-lang/rust/commits/beaf07182253e8055b5b9abc5919bab6559d53f7", "html_url": "https://github.com/rust-lang/rust/commit/beaf07182253e8055b5b9abc5919bab6559d53f7"}, {"sha": "50eb5f6137719a7e8fdd270e90af0d734d002c5d", "url": "https://api.github.com/repos/rust-lang/rust/commits/50eb5f6137719a7e8fdd270e90af0d734d002c5d", "html_url": "https://github.com/rust-lang/rust/commit/50eb5f6137719a7e8fdd270e90af0d734d002c5d"}], "stats": {"total": 18, "additions": 16, "deletions": 2}, "files": [{"sha": "77a5f5d7b3a849585232b529b379d1b483301546", "filename": "src/librustc_mir/interpret/memory.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/54d4e26b217d1e483b66f18713149bff97d9bd71/src%2Flibrustc_mir%2Finterpret%2Fmemory.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54d4e26b217d1e483b66f18713149bff97d9bd71/src%2Flibrustc_mir%2Finterpret%2Fmemory.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Fmemory.rs?ref=54d4e26b217d1e483b66f18713149bff97d9bd71", "patch": "@@ -708,8 +708,13 @@ impl<'a, 'mir, 'tcx, M: Machine<'a, 'mir, 'tcx>> Memory<'a, 'mir, 'tcx, M> {\n                     relocations\n                     .iter()\n                     .map(|&(offset, reloc)| {\n-                    (offset + dest.offset - src.offset + (i * size * relocations.len() as u64),\n-                     reloc)\n+                        // compute offset for current repetition\n+                        let dest_offset = dest.offset + (i * size);\n+                        (\n+                            // shift offsets from source allocation to destination allocation\n+                            offset + dest_offset - src.offset,\n+                            reloc,\n+                        )\n                     })\n                 );\n             }"}, {"sha": "68b9a20ecf90bc0be8d9e9d50fead1d94c6715df", "filename": "src/test/ui/consts/promoted_regression.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/54d4e26b217d1e483b66f18713149bff97d9bd71/src%2Ftest%2Fui%2Fconsts%2Fpromoted_regression.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54d4e26b217d1e483b66f18713149bff97d9bd71/src%2Ftest%2Fui%2Fconsts%2Fpromoted_regression.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fpromoted_regression.rs?ref=54d4e26b217d1e483b66f18713149bff97d9bd71", "patch": "@@ -0,0 +1,9 @@\n+// compile-pass\n+\n+fn main() {\n+    let _ = &[(\"\", \"\"); 3];\n+}\n+\n+const FOO: &[(&str, &str)] = &[(\"\", \"\"); 3];\n+const BAR: &[(&str, &str); 5] = &[(\"\", \"\"); 5];\n+const BAA: &[[&str; 12]; 11] = &[[\"\"; 12]; 11];"}]}