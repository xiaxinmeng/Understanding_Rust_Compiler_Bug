{"sha": "101467c152b26c44079401a712291c29cff0c9ac", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEwMTQ2N2MxNTJiMjZjNDQwNzk0MDFhNzEyMjkxYzI5Y2ZmMGM5YWM=", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2018-12-02T00:05:19Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2018-12-03T21:30:27Z"}, "message": "syntax: `dyn` is a used keyword now", "tree": {"sha": "508344d51c7b32ec604b53cef3db838729311acb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/508344d51c7b32ec604b53cef3db838729311acb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/101467c152b26c44079401a712291c29cff0c9ac", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/101467c152b26c44079401a712291c29cff0c9ac", "html_url": "https://github.com/rust-lang/rust/commit/101467c152b26c44079401a712291c29cff0c9ac", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/101467c152b26c44079401a712291c29cff0c9ac/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0c999ed132d67bf2520643e9bd619972cf3888ba", "url": "https://api.github.com/repos/rust-lang/rust/commits/0c999ed132d67bf2520643e9bd619972cf3888ba", "html_url": "https://github.com/rust-lang/rust/commit/0c999ed132d67bf2520643e9bd619972cf3888ba"}], "stats": {"total": 26, "additions": 17, "deletions": 9}, "files": [{"sha": "8ccd123afdcea7c393c6430f47c80503b3f2f342", "filename": "src/libsyntax_pos/symbol.rs", "status": "modified", "additions": 13, "deletions": 5, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/101467c152b26c44079401a712291c29cff0c9ac/src%2Flibsyntax_pos%2Fsymbol.rs", "raw_url": "https://github.com/rust-lang/rust/raw/101467c152b26c44079401a712291c29cff0c9ac/src%2Flibsyntax_pos%2Fsymbol.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax_pos%2Fsymbol.rs?ref=101467c152b26c44079401a712291c29cff0c9ac", "patch": "@@ -404,9 +404,11 @@ declare_keywords! {\n     (49, Virtual,            \"virtual\")\n     (50, Yield,              \"yield\")\n \n+    // Edition-specific keywords used in the language.\n+    (51, Dyn,                \"dyn\") // >= 2018 Edition only\n+\n     // Edition-specific keywords reserved for future use.\n-    (51, Async,              \"async\") // >= 2018 Edition only\n-    (52, Dyn,                \"dyn\") // >= 2018 Edition only\n+    (52, Async,              \"async\") // >= 2018 Edition only\n     (53, Try,                \"try\") // >= 2018 Edition only\n \n     // Special lifetime names\n@@ -417,11 +419,15 @@ declare_keywords! {\n     (56, Auto,               \"auto\")\n     (57, Catch,              \"catch\")\n     (58, Default,            \"default\")\n-    (59, Union,              \"union\")\n-    (60, Existential,        \"existential\")\n+    (59, Existential,        \"existential\")\n+    (60, Union,              \"union\")\n }\n \n impl Symbol {\n+    fn is_used_keyword_2018(self) -> bool {\n+        self == keywords::Dyn.name()\n+    }\n+\n     fn is_unused_keyword_2018(self) -> bool {\n         self >= keywords::Async.name() && self <= keywords::Try.name()\n     }\n@@ -436,7 +442,9 @@ impl Ident {\n \n     /// Returns `true` if the token is a keyword used in the language.\n     pub fn is_used_keyword(self) -> bool {\n-        self.name >= keywords::As.name() && self.name <= keywords::While.name()\n+        // Note: `span.edition()` is relatively expensive, don't call it unless necessary.\n+        self.name >= keywords::As.name() && self.name <= keywords::While.name() ||\n+        self.name.is_used_keyword_2018() && self.span.rust_2018()\n     }\n \n     /// Returns `true` if the token is a keyword reserved for possible future use."}, {"sha": "377c85fef490a7d34a8b0077e87dee85d54208c8", "filename": "src/test/ui/rust-2018/dyn-trait-compatibility.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/101467c152b26c44079401a712291c29cff0c9ac/src%2Ftest%2Fui%2Frust-2018%2Fdyn-trait-compatibility.rs", "raw_url": "https://github.com/rust-lang/rust/raw/101467c152b26c44079401a712291c29cff0c9ac/src%2Ftest%2Fui%2Frust-2018%2Fdyn-trait-compatibility.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frust-2018%2Fdyn-trait-compatibility.rs?ref=101467c152b26c44079401a712291c29cff0c9ac", "patch": "@@ -1,7 +1,7 @@\n // edition:2018\n \n type A0 = dyn;\n-type A1 = dyn::dyn; //~ERROR expected identifier, found reserved keyword\n+type A1 = dyn::dyn; //~ERROR expected identifier, found keyword `dyn`\n type A2 = dyn<dyn, dyn>; //~ERROR expected identifier, found `<`\n type A3 = dyn<<dyn as dyn>::dyn>;\n "}, {"sha": "bd72f9c6786b2a8ca2d80dc1e7f94360a8bc825b", "filename": "src/test/ui/rust-2018/dyn-trait-compatibility.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/101467c152b26c44079401a712291c29cff0c9ac/src%2Ftest%2Fui%2Frust-2018%2Fdyn-trait-compatibility.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/101467c152b26c44079401a712291c29cff0c9ac/src%2Ftest%2Fui%2Frust-2018%2Fdyn-trait-compatibility.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frust-2018%2Fdyn-trait-compatibility.stderr?ref=101467c152b26c44079401a712291c29cff0c9ac", "patch": "@@ -1,8 +1,8 @@\n-error: expected identifier, found reserved keyword `dyn`\n+error: expected identifier, found keyword `dyn`\n   --> $DIR/dyn-trait-compatibility.rs:4:16\n    |\n-LL | type A1 = dyn::dyn; //~ERROR expected identifier, found reserved keyword\n-   |                ^^^ expected identifier, found reserved keyword\n+LL | type A1 = dyn::dyn; //~ERROR expected identifier, found keyword `dyn`\n+   |                ^^^ expected identifier, found keyword\n \n error: expected identifier, found `<`\n   --> $DIR/dyn-trait-compatibility.rs:5:14"}]}