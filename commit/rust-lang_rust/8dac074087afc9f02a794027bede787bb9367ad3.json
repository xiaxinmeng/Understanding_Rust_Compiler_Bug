{"sha": "8dac074087afc9f02a794027bede787bb9367ad3", "node_id": "C_kwDOAAsO6NoAKDhkYWMwNzQwODdhZmM5ZjAyYTc5NDAyN2JlZGU3ODdiYjkzNjdhZDM", "commit": {"author": {"name": "Dominik Stolz", "email": "d.stolz@tum.de", "date": "2023-05-23T15:33:55Z"}, "committer": {"name": "Dominik Stolz", "email": "d.stolz@tum.de", "date": "2023-05-23T15:33:55Z"}, "message": "Add RegionInferenceContext::outlives_constraints", "tree": {"sha": "a8f08ef007f99a3486e87e63854a6a4058dc6d30", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a8f08ef007f99a3486e87e63854a6a4058dc6d30"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8dac074087afc9f02a794027bede787bb9367ad3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8dac074087afc9f02a794027bede787bb9367ad3", "html_url": "https://github.com/rust-lang/rust/commit/8dac074087afc9f02a794027bede787bb9367ad3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8dac074087afc9f02a794027bede787bb9367ad3/comments", "author": {"login": "voidc", "id": 5302792, "node_id": "MDQ6VXNlcjUzMDI3OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/5302792?v=4", "gravatar_id": "", "url": "https://api.github.com/users/voidc", "html_url": "https://github.com/voidc", "followers_url": "https://api.github.com/users/voidc/followers", "following_url": "https://api.github.com/users/voidc/following{/other_user}", "gists_url": "https://api.github.com/users/voidc/gists{/gist_id}", "starred_url": "https://api.github.com/users/voidc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/voidc/subscriptions", "organizations_url": "https://api.github.com/users/voidc/orgs", "repos_url": "https://api.github.com/users/voidc/repos", "events_url": "https://api.github.com/users/voidc/events{/privacy}", "received_events_url": "https://api.github.com/users/voidc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "voidc", "id": 5302792, "node_id": "MDQ6VXNlcjUzMDI3OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/5302792?v=4", "gravatar_id": "", "url": "https://api.github.com/users/voidc", "html_url": "https://github.com/voidc", "followers_url": "https://api.github.com/users/voidc/followers", "following_url": "https://api.github.com/users/voidc/following{/other_user}", "gists_url": "https://api.github.com/users/voidc/gists{/gist_id}", "starred_url": "https://api.github.com/users/voidc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/voidc/subscriptions", "organizations_url": "https://api.github.com/users/voidc/orgs", "repos_url": "https://api.github.com/users/voidc/repos", "events_url": "https://api.github.com/users/voidc/events{/privacy}", "received_events_url": "https://api.github.com/users/voidc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c6e3f27864080730298dd7260f94af8784fbdc42", "url": "https://api.github.com/repos/rust-lang/rust/commits/c6e3f27864080730298dd7260f94af8784fbdc42", "html_url": "https://github.com/rust-lang/rust/commit/c6e3f27864080730298dd7260f94af8784fbdc42"}], "stats": {"total": 8, "additions": 7, "deletions": 1}, "files": [{"sha": "dc20b371d92e028337fb566364d9f5b918ded1e1", "filename": "compiler/rustc_borrowck/src/consumers.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/8dac074087afc9f02a794027bede787bb9367ad3/compiler%2Frustc_borrowck%2Fsrc%2Fconsumers.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8dac074087afc9f02a794027bede787bb9367ad3/compiler%2Frustc_borrowck%2Fsrc%2Fconsumers.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Fconsumers.rs?ref=8dac074087afc9f02a794027bede787bb9367ad3", "patch": "@@ -12,6 +12,7 @@ use std::rc::Rc;\n use crate::borrow_set::BorrowSet;\n \n pub use super::{\n+    constraints::OutlivesConstraint,\n     dataflow::{calculate_borrows_out_of_scope_at_location, BorrowIndex, Borrows},\n     facts::{AllFacts as PoloniusInput, RustcFacts},\n     location::{LocationTable, RichLocation},"}, {"sha": "9bb46a50d3cf406f3f38a652abb97233111b47d4", "filename": "compiler/rustc_borrowck/src/region_infer/mod.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/8dac074087afc9f02a794027bede787bb9367ad3/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8dac074087afc9f02a794027bede787bb9367ad3/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fmod.rs?ref=8dac074087afc9f02a794027bede787bb9367ad3", "patch": "@@ -585,6 +585,11 @@ impl<'tcx> RegionInferenceContext<'tcx> {\n         self.universal_regions.to_region_vid(r)\n     }\n \n+    /// Returns an iterator over all the outlives constraints.\n+    pub fn outlives_constraints(&self) -> impl Iterator<Item = OutlivesConstraint<'tcx>> + '_ {\n+        self.constraints.outlives().iter().copied()\n+    }\n+\n     /// Adds annotations for `#[rustc_regions]`; see `UniversalRegions::annotate`.\n     pub(crate) fn annotate(&self, tcx: TyCtxt<'tcx>, err: &mut Diagnostic) {\n         self.universal_regions.annotate(tcx, err)\n@@ -698,7 +703,7 @@ impl<'tcx> RegionInferenceContext<'tcx> {\n     #[instrument(skip(self, _body), level = \"debug\")]\n     fn propagate_constraints(&mut self, _body: &Body<'tcx>) {\n         debug!(\"constraints={:#?}\", {\n-            let mut constraints: Vec<_> = self.constraints.outlives().iter().collect();\n+            let mut constraints: Vec<_> = self.outlives_constraints().collect();\n             constraints.sort_by_key(|c| (c.sup, c.sub));\n             constraints\n                 .into_iter()"}]}