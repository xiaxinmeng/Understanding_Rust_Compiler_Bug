{"sha": "a143d6d4674169f12402fae56a1fa4053436754c", "node_id": "MDY6Q29tbWl0NzI0NzEyOmExNDNkNmQ0Njc0MTY5ZjEyNDAyZmFlNTZhMWZhNDA1MzQzNjc1NGM=", "commit": {"author": {"name": "Tom Eccles", "email": "tom.eccles@codethink.co.uk", "date": "2021-01-09T22:54:21Z"}, "committer": {"name": "Tom Eccles", "email": "tom.eccles@codethink.co.uk", "date": "2021-03-28T15:48:48Z"}, "message": "run-make: Specify --target to rustc\n\nResolves #78911\n\nThe target's linker was used but rustc wasn't told to build for that\ntarget (instead defaulting to the host). This led to the host instead of\nthe target getting tested and to the linker getting inappropriate\narguments.", "tree": {"sha": "fccdb1f2b7a9328989ce7febec610065c263d803", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fccdb1f2b7a9328989ce7febec610065c263d803"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a143d6d4674169f12402fae56a1fa4053436754c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a143d6d4674169f12402fae56a1fa4053436754c", "html_url": "https://github.com/rust-lang/rust/commit/a143d6d4674169f12402fae56a1fa4053436754c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a143d6d4674169f12402fae56a1fa4053436754c/comments", "author": {"login": "tblah", "id": 3716681, "node_id": "MDQ6VXNlcjM3MTY2ODE=", "avatar_url": "https://avatars.githubusercontent.com/u/3716681?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tblah", "html_url": "https://github.com/tblah", "followers_url": "https://api.github.com/users/tblah/followers", "following_url": "https://api.github.com/users/tblah/following{/other_user}", "gists_url": "https://api.github.com/users/tblah/gists{/gist_id}", "starred_url": "https://api.github.com/users/tblah/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tblah/subscriptions", "organizations_url": "https://api.github.com/users/tblah/orgs", "repos_url": "https://api.github.com/users/tblah/repos", "events_url": "https://api.github.com/users/tblah/events{/privacy}", "received_events_url": "https://api.github.com/users/tblah/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tblah", "id": 3716681, "node_id": "MDQ6VXNlcjM3MTY2ODE=", "avatar_url": "https://avatars.githubusercontent.com/u/3716681?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tblah", "html_url": "https://github.com/tblah", "followers_url": "https://api.github.com/users/tblah/followers", "following_url": "https://api.github.com/users/tblah/following{/other_user}", "gists_url": "https://api.github.com/users/tblah/gists{/gist_id}", "starred_url": "https://api.github.com/users/tblah/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tblah/subscriptions", "organizations_url": "https://api.github.com/users/tblah/orgs", "repos_url": "https://api.github.com/users/tblah/repos", "events_url": "https://api.github.com/users/tblah/events{/privacy}", "received_events_url": "https://api.github.com/users/tblah/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "13167029c2fa01e498f92b2f2ac1ce0b2b9f294a", "url": "https://api.github.com/repos/rust-lang/rust/commits/13167029c2fa01e498f92b2f2ac1ce0b2b9f294a", "html_url": "https://github.com/rust-lang/rust/commit/13167029c2fa01e498f92b2f2ac1ce0b2b9f294a"}], "stats": {"total": 19, "additions": 5, "deletions": 14}, "files": [{"sha": "ae447e1bd9cdaf3cba083b17d5257034cd7a5666", "filename": "src/test/run-make/incr-prev-body-beyond-eof/Makefile", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/a143d6d4674169f12402fae56a1fa4053436754c/src%2Ftest%2Frun-make%2Fincr-prev-body-beyond-eof%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/a143d6d4674169f12402fae56a1fa4053436754c/src%2Ftest%2Frun-make%2Fincr-prev-body-beyond-eof%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fincr-prev-body-beyond-eof%2FMakefile?ref=a143d6d4674169f12402fae56a1fa4053436754c", "patch": "@@ -1,8 +1,5 @@\n include ../../run-make-fulldeps/tools.mk\n \n-# FIXME https://github.com/rust-lang/rust/issues/78911\n-# ignore-32bit wrong/no cross compiler and sometimes we pass wrong gcc args (-m64)\n-\n # Tests that we don't ICE during incremental compilation after modifying a\n # function span such that its previous end line exceeds the number of lines\n # in the new file, but its start line/column and length remain the same.\n@@ -14,6 +11,6 @@ all:\n \tmkdir $(SRC)\n \tmkdir $(INCR)\n \tcp a.rs $(SRC)/main.rs\n-\t$(RUSTC) -C incremental=$(INCR) $(SRC)/main.rs\n+\t$(RUSTC) -C incremental=$(INCR) $(SRC)/main.rs --target $(TARGET)\n \tcp b.rs $(SRC)/main.rs\n-\t$(RUSTC) -C incremental=$(INCR) $(SRC)/main.rs\n+\t$(RUSTC) -C incremental=$(INCR) $(SRC)/main.rs --target $(TARGET)"}, {"sha": "3d93b2f6961296b07ec643b8fb10dcab10c09330", "filename": "src/test/run-make/issue-36710/Makefile", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/a143d6d4674169f12402fae56a1fa4053436754c/src%2Ftest%2Frun-make%2Fissue-36710%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/a143d6d4674169f12402fae56a1fa4053436754c/src%2Ftest%2Frun-make%2Fissue-36710%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fissue-36710%2FMakefile?ref=a143d6d4674169f12402fae56a1fa4053436754c", "patch": "@@ -1,13 +1,10 @@\n include ../../run-make-fulldeps/tools.mk\n \n-# FIXME https://github.com/rust-lang/rust/issues/78911\n-# ignore-32bit wrong/no cross compiler and sometimes we pass wrong gcc args (-m64)\n-\n all: foo\n \t$(call RUN,foo)\n \n foo: foo.rs $(call NATIVE_STATICLIB,foo)\n-\t$(RUSTC) $< -lfoo $(EXTRARSCXXFLAGS)\n+\t$(RUSTC) $< -lfoo $(EXTRARSCXXFLAGS) --target $(TARGET)\n \n $(TMPDIR)/libfoo.o: foo.cpp\n \t$(call COMPILE_OBJ_CXX,$@,$<)"}, {"sha": "c89eebf374501ee050be5ece154b6d24649fbdab", "filename": "src/test/run-make/issue-83112-incr-test-moved-file/Makefile", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/a143d6d4674169f12402fae56a1fa4053436754c/src%2Ftest%2Frun-make%2Fissue-83112-incr-test-moved-file%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/a143d6d4674169f12402fae56a1fa4053436754c/src%2Ftest%2Frun-make%2Fissue-83112-incr-test-moved-file%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fissue-83112-incr-test-moved-file%2FMakefile?ref=a143d6d4674169f12402fae56a1fa4053436754c", "patch": "@@ -1,8 +1,5 @@\n include ../../run-make-fulldeps/tools.mk\n \n-# FIXME https://github.com/rust-lang/rust/issues/78911\n-# ignore-32bit wrong/no cross compiler and sometimes we pass wrong gcc args (-m64)\n-\n # Regression test for issue #83112\n # The generated test harness code contains spans with a dummy location,\n # but a non-dummy SyntaxContext. Previously, the incremental cache was encoding\n@@ -20,6 +17,6 @@ all:\n \tmkdir $(SRC)/mydir\n \tmkdir $(INCR)\n \tcp main.rs $(SRC)/main.rs\n-\t$(RUSTC) --test -C incremental=$(INCR) $(SRC)/main.rs\n+\t$(RUSTC) --test -C incremental=$(INCR) $(SRC)/main.rs --target $(TARGET)\n \tmv $(SRC)/main.rs $(SRC)/mydir/main.rs\n-\t$(RUSTC) --test -C incremental=$(INCR) $(SRC)/mydir/main.rs\n+\t$(RUSTC) --test -C incremental=$(INCR) $(SRC)/mydir/main.rs --target $(TARGET)"}]}