{"sha": "8fd47a614b34faca40d2b5b70165831e2a8b8593", "node_id": "C_kwDOAAsO6NoAKDhmZDQ3YTYxNGIzNGZhY2E0MGQyYjViNzAxNjU4MzFlMmE4Yjg1OTM", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2023-02-22T09:35:09Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-02-22T09:35:09Z"}, "message": "Rollup merge of #108264 - jchecahi:tool-testsuite-ignores-no-fail-fast, r=ozkanonur\n\nno-fail-fast support for tool testsuites\n\n~~This commit adds a change to pass \"--no-fail-fast\" flag to `cargo test` inside `tool::prepare_tool_cargo()` so there is no need to do it manually in each `Step` trait implementation in src/bootstrap/test.rs.~~\n\n~~Also, removes the flag from test.rs where prepare_tool_cargo() is called so cargo doesn't complain because the flag has been passed twice.~~\n\nThis commit adds `--no-fail-fast` flag to each `cargo test`\ncommand in each tool Step trait implementation (`miri`, `rustfmt` and `clippy`).\n\nFixes #108261", "tree": {"sha": "ed2f0e7a8f71aa8abff3f42ef9e84a0ea9e1d0f4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ed2f0e7a8f71aa8abff3f42ef9e84a0ea9e1d0f4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8fd47a614b34faca40d2b5b70165831e2a8b8593", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJj9eHNCRBK7hj4Ov3rIwAAQ4AIAGOl0xuNzKzDjhA++EY8eU7p\nfdnclXdVl4yXNqhoF8MxCxg4F4KV2g3M/UFYMgxC88w98AyQrsngFasYfT7L42jB\ndHte74fvf17ctYxIFBikXKhycDC5cxhW9FEfaeXFN+LwVxyL9PwsHrfcTsoR1CsR\nN9CekwjTLHK5d4TRpbZLFXiLTiDujSf5V8XpMRAz4ccPRM4icV/ARqEXX+JbjGt1\nMSyeD6bc6eSb1pPk9+097LbEr38qJNAa9oNPkCB/JExGkeQ71VxK9S4VzHN+/3Qn\noAgnLz8yeoicE0NsY2FKOag3JcASoNwtyxxz1HkU9QqIx6LlvGApKYGLs+2fLe8=\n=cbEF\n-----END PGP SIGNATURE-----\n", "payload": "tree ed2f0e7a8f71aa8abff3f42ef9e84a0ea9e1d0f4\nparent 4658210565a81e0da5fbb172b817ec257abfc542\nparent 2f163554866e1b4b348811e9df6a4a753beb0abf\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1677058509 +0100\ncommitter GitHub <noreply@github.com> 1677058509 +0100\n\nRollup merge of #108264 - jchecahi:tool-testsuite-ignores-no-fail-fast, r=ozkanonur\n\nno-fail-fast support for tool testsuites\n\n~~This commit adds a change to pass \"--no-fail-fast\" flag to `cargo test` inside `tool::prepare_tool_cargo()` so there is no need to do it manually in each `Step` trait implementation in src/bootstrap/test.rs.~~\n\n~~Also, removes the flag from test.rs where prepare_tool_cargo() is called so cargo doesn't complain because the flag has been passed twice.~~\n\nThis commit adds `--no-fail-fast` flag to each `cargo test`\ncommand in each tool Step trait implementation (`miri`, `rustfmt` and `clippy`).\n\nFixes #108261\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8fd47a614b34faca40d2b5b70165831e2a8b8593", "html_url": "https://github.com/rust-lang/rust/commit/8fd47a614b34faca40d2b5b70165831e2a8b8593", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8fd47a614b34faca40d2b5b70165831e2a8b8593/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4658210565a81e0da5fbb172b817ec257abfc542", "url": "https://api.github.com/repos/rust-lang/rust/commits/4658210565a81e0da5fbb172b817ec257abfc542", "html_url": "https://github.com/rust-lang/rust/commit/4658210565a81e0da5fbb172b817ec257abfc542"}, {"sha": "2f163554866e1b4b348811e9df6a4a753beb0abf", "url": "https://api.github.com/repos/rust-lang/rust/commits/2f163554866e1b4b348811e9df6a4a753beb0abf", "html_url": "https://github.com/rust-lang/rust/commit/2f163554866e1b4b348811e9df6a4a753beb0abf"}], "stats": {"total": 12, "additions": 12, "deletions": 0}, "files": [{"sha": "b4f1506dc8f30c019aaaf0ec021eac9ceb6d6c15", "filename": "src/bootstrap/test.rs", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/8fd47a614b34faca40d2b5b70165831e2a8b8593/src%2Fbootstrap%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8fd47a614b34faca40d2b5b70165831e2a8b8593/src%2Fbootstrap%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftest.rs?ref=8fd47a614b34faca40d2b5b70165831e2a8b8593", "patch": "@@ -435,6 +435,10 @@ impl Step for Rustfmt {\n             &[],\n         );\n \n+        if !builder.fail_fast {\n+            cargo.arg(\"--no-fail-fast\");\n+        }\n+\n         let dir = testdir(builder, compiler.host);\n         t!(fs::create_dir_all(&dir));\n         cargo.env(\"RUSTFMT_TEST_DIR\", dir);\n@@ -615,6 +619,10 @@ impl Step for Miri {\n         );\n         cargo.add_rustc_lib_path(builder, compiler);\n \n+        if !builder.fail_fast {\n+            cargo.arg(\"--no-fail-fast\");\n+        }\n+\n         // miri tests need to know about the stage sysroot\n         cargo.env(\"MIRI_SYSROOT\", &miri_sysroot);\n         cargo.env(\"MIRI_HOST_SYSROOT\", sysroot);\n@@ -746,6 +754,10 @@ impl Step for Clippy {\n             &[],\n         );\n \n+        if !builder.fail_fast {\n+            cargo.arg(\"--no-fail-fast\");\n+        }\n+\n         cargo.env(\"RUSTC_TEST_SUITE\", builder.rustc(compiler));\n         cargo.env(\"RUSTC_LIB_PATH\", builder.rustc_libdir(compiler));\n         let host_libs = builder.stage_out(compiler, Mode::ToolRustc).join(builder.cargo_dir());"}]}