{"sha": "3eef9993af9dc04f5e9d489e3234e5b4060ff893", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNlZWY5OTkzYWY5ZGMwNGY1ZTlkNDg5ZTMyMzRlNWI0MDYwZmY4OTM=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-08-02T22:25:06Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-08-03T00:49:11Z"}, "message": "Don't pp extra lines after block open when preserving whitespace. Closes #759", "tree": {"sha": "8864c0e25fc541d9a8ba6217d67d18f5a669d156", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8864c0e25fc541d9a8ba6217d67d18f5a669d156"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3eef9993af9dc04f5e9d489e3234e5b4060ff893", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3eef9993af9dc04f5e9d489e3234e5b4060ff893", "html_url": "https://github.com/rust-lang/rust/commit/3eef9993af9dc04f5e9d489e3234e5b4060ff893", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3eef9993af9dc04f5e9d489e3234e5b4060ff893/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "731797d075e8bd9d0e3d21c917c3c7028278a7d4", "url": "https://api.github.com/repos/rust-lang/rust/commits/731797d075e8bd9d0e3d21c917c3c7028278a7d4", "html_url": "https://github.com/rust-lang/rust/commit/731797d075e8bd9d0e3d21c917c3c7028278a7d4"}], "stats": {"total": 31, "additions": 23, "deletions": 8}, "files": [{"sha": "11e13d6ebe02ea82a83e7d1bc3fb209d670615f2", "filename": "src/comp/syntax/print/pprust.rs", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Fcomp%2Fsyntax%2Fprint%2Fpprust.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Fcomp%2Fsyntax%2Fprint%2Fpprust.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fsyntax%2Fprint%2Fpprust.rs?ref=3eef9993af9dc04f5e9d489e3234e5b4060ff893", "patch": "@@ -172,6 +172,20 @@ fn bclose_(s: &ps, span: codemap::span, indented: uint) {\n }\n fn bclose(s: &ps, span: codemap::span) { bclose_(s, span, indent_unit); }\n \n+fn is_begin(s: &ps) -> bool {\n+    alt s.s.last_token() {\n+      pp::BEGIN(_) { true }\n+      _ { false }\n+    }\n+}\n+\n+fn is_end(s: &ps) -> bool {\n+    alt s.s.last_token() {\n+      pp::END. { true }\n+      _ { false }\n+    }\n+}\n+\n fn is_bol(s: &ps) -> bool {\n     ret s.s.last_token() == pp::EOF ||\n         s.s.last_token() == pp::hardbreak_tok();\n@@ -1403,7 +1417,7 @@ fn print_comment(s: &ps, cmnt: lexer::cmnt) {\n       }\n       lexer::blank_line. {\n         // We need to do at least one, possibly two hardbreaks.\n-        pprust::hardbreak_if_not_bol(s);\n+        if is_begin(s) || is_end(s) { hardbreak(s.s) }\n         hardbreak(s.s);\n       }\n     }"}, {"sha": "f0a2009b2132ddb829bda8cc3ad2fb6628d6bf77", "filename": "src/test/bench/shootout-fibo.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Fbench%2Fshootout-fibo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Fbench%2Fshootout-fibo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fbench%2Fshootout-fibo.rs?ref=3eef9993af9dc04f5e9d489e3234e5b4060ff893", "patch": "@@ -1,4 +1,3 @@\n-// xfail-pretty\n \n \n // -*- rust -*-"}, {"sha": "08ef4995ad4ec19aa8212547833dbd5d37e936fa", "filename": "src/test/bench/shootout-nbody.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Fbench%2Fshootout-nbody.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Fbench%2Fshootout-nbody.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fbench%2Fshootout-nbody.rs?ref=3eef9993af9dc04f5e9d489e3234e5b4060ff893", "patch": "@@ -1,4 +1,3 @@\n-// xfail-pretty\n // based on:\n // http://shootout.alioth.debian.org/u32/benchmark.php?test=nbody&lang=java\n "}, {"sha": "0a6b94c7f2ed22736f9673725ec28091f2eb1c27", "filename": "src/test/bench/task-perf-word-count.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Fbench%2Ftask-perf-word-count.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Fbench%2Ftask-perf-word-count.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fbench%2Ftask-perf-word-count.rs?ref=3eef9993af9dc04f5e9d489e3234e5b4060ff893", "patch": "@@ -1,4 +1,3 @@\n-// xfail-pretty\n /**\n    A parallel word-frequency counting program.\n "}, {"sha": "87de5ff64c27dd7a7233c9beef2fae4a93957cf1", "filename": "src/test/pretty/empty-lines.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Fpretty%2Fempty-lines.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Fpretty%2Fempty-lines.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fpretty%2Fempty-lines.rs?ref=3eef9993af9dc04f5e9d489e3234e5b4060ff893", "patch": "@@ -0,0 +1,7 @@\n+// Issue #759\n+// Whitespace under block opening should not expand forever\n+\n+fn a() -> uint {\n+\n+    1u\n+}\n\\ No newline at end of file"}, {"sha": "6470f4d4206b136368fbfc13834e81224348ae22", "filename": "src/test/run-pass/hashmap-memory.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Frun-pass%2Fhashmap-memory.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Frun-pass%2Fhashmap-memory.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fhashmap-memory.rs?ref=3eef9993af9dc04f5e9d489e3234e5b4060ff893", "patch": "@@ -1,4 +1,3 @@\n-// xfail-pretty\n /**\n    A somewhat reduced test case to expose some Valgrind issues.\n "}, {"sha": "254a4e51b6bb3e07983210939139462a9c3fd3e6", "filename": "src/test/run-pass/interior-vec.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Frun-pass%2Finterior-vec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Frun-pass%2Finterior-vec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Finterior-vec.rs?ref=3eef9993af9dc04f5e9d489e3234e5b4060ff893", "patch": "@@ -1,4 +1,5 @@\n // xfail-stage0\n+// xfail-pretty\n \n import rusti::ivec_len;\n "}, {"sha": "1a0e93874f1acf9bfb186bbc7dbce0f9c8ab7660", "filename": "src/test/run-pass/issue-687.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Frun-pass%2Fissue-687.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Frun-pass%2Fissue-687.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fissue-687.rs?ref=3eef9993af9dc04f5e9d489e3234e5b4060ff893", "patch": "@@ -1,5 +1,4 @@\n // xfail-stage0\n-// xfail-pretty\n \n use std;\n import std::ivec;"}, {"sha": "504aea1d4407051f58cb97963388c664aeebc7d2", "filename": "src/test/run-pass/pattern-bound-var-in-for-each.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Frun-pass%2Fpattern-bound-var-in-for-each.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Frun-pass%2Fpattern-bound-var-in-for-each.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fpattern-bound-var-in-for-each.rs?ref=3eef9993af9dc04f5e9d489e3234e5b4060ff893", "patch": "@@ -1,5 +1,4 @@\n // xfail-stage0\n-// xfail-pretty\n // Tests that trans_path checks whether a\n // pattern-bound var is an upvar (when translating\n // the for-each body)"}, {"sha": "badd2ae10bf80c03b0566f88b2079b5cde242298", "filename": "src/test/run-pass/while-prelude-drop.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Frun-pass%2Fwhile-prelude-drop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3eef9993af9dc04f5e9d489e3234e5b4060ff893/src%2Ftest%2Frun-pass%2Fwhile-prelude-drop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fwhile-prelude-drop.rs?ref=3eef9993af9dc04f5e9d489e3234e5b4060ff893", "patch": "@@ -1,4 +1,3 @@\n-// xfail-pretty\n \n tag t { a; b(str); }\n "}]}