{"sha": "3b79dd9b37662402b4715801e0a128dc74300b30", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNiNzlkZDliMzc2NjI0MDJiNDcxNTgwMWUwYTEyOGRjNzQzMDBiMzA=", "commit": {"author": {"name": "topecongiro", "email": "seuchida@gmail.com", "date": "2018-02-24T02:48:18Z"}, "committer": {"name": "topecongiro", "email": "seuchida@gmail.com", "date": "2018-02-24T02:48:18Z"}, "message": "Preserve trailing comma on macro in item position", "tree": {"sha": "4a17d197af3eb26ec34aa5c5573c04226ce3adf1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4a17d197af3eb26ec34aa5c5573c04226ce3adf1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3b79dd9b37662402b4715801e0a128dc74300b30", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3b79dd9b37662402b4715801e0a128dc74300b30", "html_url": "https://github.com/rust-lang/rust/commit/3b79dd9b37662402b4715801e0a128dc74300b30", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3b79dd9b37662402b4715801e0a128dc74300b30/comments", "author": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "committer": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0f706cd452227a23234623ed8b13bbaff2a7cf78", "url": "https://api.github.com/repos/rust-lang/rust/commits/0f706cd452227a23234623ed8b13bbaff2a7cf78", "html_url": "https://github.com/rust-lang/rust/commit/0f706cd452227a23234623ed8b13bbaff2a7cf78"}], "stats": {"total": 6, "additions": 5, "deletions": 1}, "files": [{"sha": "0136739b344b5ea248f0e0a8681ae955b429a4aa", "filename": "rustfmt-core/src/macros.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/3b79dd9b37662402b4715801e0a128dc74300b30/rustfmt-core%2Fsrc%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3b79dd9b37662402b4715801e0a128dc74300b30/rustfmt-core%2Fsrc%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/rustfmt-core%2Fsrc%2Fmacros.rs?ref=3b79dd9b37662402b4715801e0a128dc74300b30", "patch": "@@ -278,8 +278,12 @@ pub fn rewrite_macro(\n                 );\n                 let arg_vec = &arg_vec.iter().map(|e| &*e).collect::<Vec<_>>()[..];\n                 let rewrite = rewrite_array(arg_vec, sp, context, mac_shape, trailing_comma)?;\n+                let comma = match position {\n+                    MacroPosition::Item => \";\",\n+                    _ => \"\",\n+                };\n \n-                Some(format!(\"{}{}\", macro_name, rewrite))\n+                Some(format!(\"{}{}{}\", macro_name, rewrite, comma))\n             }\n         }\n         MacroStyle::Braces => {"}]}