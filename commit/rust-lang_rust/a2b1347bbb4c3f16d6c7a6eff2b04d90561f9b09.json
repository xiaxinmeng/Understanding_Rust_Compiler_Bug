{"sha": "a2b1347bbb4c3f16d6c7a6eff2b04d90561f9b09", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEyYjEzNDdiYmI0YzNmMTZkNmM3YTZlZmYyYjA0ZDkwNTYxZjliMDk=", "commit": {"author": {"name": "Ryan Levick", "email": "me@ryanlevick.com", "date": "2021-03-19T09:18:22Z"}, "committer": {"name": "Ryan Levick", "email": "me@ryanlevick.com", "date": "2021-04-08T13:36:29Z"}, "message": "Improve error", "tree": {"sha": "06cdfe48d15728c962679d5d710d52fc0c0d82a2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/06cdfe48d15728c962679d5d710d52fc0c0d82a2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a2b1347bbb4c3f16d6c7a6eff2b04d90561f9b09", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a2b1347bbb4c3f16d6c7a6eff2b04d90561f9b09", "html_url": "https://github.com/rust-lang/rust/commit/a2b1347bbb4c3f16d6c7a6eff2b04d90561f9b09", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a2b1347bbb4c3f16d6c7a6eff2b04d90561f9b09/comments", "author": {"login": "rylev", "id": 1327285, "node_id": "MDQ6VXNlcjEzMjcyODU=", "avatar_url": "https://avatars.githubusercontent.com/u/1327285?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rylev", "html_url": "https://github.com/rylev", "followers_url": "https://api.github.com/users/rylev/followers", "following_url": "https://api.github.com/users/rylev/following{/other_user}", "gists_url": "https://api.github.com/users/rylev/gists{/gist_id}", "starred_url": "https://api.github.com/users/rylev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rylev/subscriptions", "organizations_url": "https://api.github.com/users/rylev/orgs", "repos_url": "https://api.github.com/users/rylev/repos", "events_url": "https://api.github.com/users/rylev/events{/privacy}", "received_events_url": "https://api.github.com/users/rylev/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rylev", "id": 1327285, "node_id": "MDQ6VXNlcjEzMjcyODU=", "avatar_url": "https://avatars.githubusercontent.com/u/1327285?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rylev", "html_url": "https://github.com/rylev", "followers_url": "https://api.github.com/users/rylev/followers", "following_url": "https://api.github.com/users/rylev/following{/other_user}", "gists_url": "https://api.github.com/users/rylev/gists{/gist_id}", "starred_url": "https://api.github.com/users/rylev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rylev/subscriptions", "organizations_url": "https://api.github.com/users/rylev/orgs", "repos_url": "https://api.github.com/users/rylev/repos", "events_url": "https://api.github.com/users/rylev/events{/privacy}", "received_events_url": "https://api.github.com/users/rylev/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2c1429ca5ebccecb463d268bc1628a9d330d57b0", "url": "https://api.github.com/repos/rust-lang/rust/commits/2c1429ca5ebccecb463d268bc1628a9d330d57b0", "html_url": "https://github.com/rust-lang/rust/commit/2c1429ca5ebccecb463d268bc1628a9d330d57b0"}], "stats": {"total": 34, "additions": 27, "deletions": 7}, "files": [{"sha": "aefc896955871692fc69f11fe5c58ffde82a3e36", "filename": "compiler/rustc_ast_lowering/src/lib.rs", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/a2b1347bbb4c3f16d6c7a6eff2b04d90561f9b09/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a2b1347bbb4c3f16d6c7a6eff2b04d90561f9b09/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs?ref=a2b1347bbb4c3f16d6c7a6eff2b04d90561f9b09", "patch": "@@ -46,7 +46,7 @@ use rustc_ast_pretty::pprust;\n use rustc_data_structures::captures::Captures;\n use rustc_data_structures::fx::FxHashSet;\n use rustc_data_structures::sync::Lrc;\n-use rustc_errors::struct_span_err;\n+use rustc_errors::{struct_span_err, Applicability};\n use rustc_hir as hir;\n use rustc_hir::def::{DefKind, Namespace, PartialRes, PerNS, Res};\n use rustc_hir::def_id::{DefId, DefIdMap, LocalDefId, CRATE_DEF_ID};\n@@ -2785,9 +2785,14 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                 )\n             } else {\n                 let msg = \"trait objects must include the `dyn` keyword\";\n-                let label = \"`dyn` keyword should be added before this trait\";\n+                let label = \"add `dyn` keyword before this trait\";\n                 let mut err = struct_span_err!(self.sess, span, E0782, \"{}\", msg,);\n-                err.span_label(span, label);\n+                err.span_suggestion_verbose(\n+                    span.shrink_to_lo(),\n+                    label,\n+                    String::from(\"dyn \"),\n+                    Applicability::MachineApplicable,\n+                );\n                 err.emit();\n             }\n         }"}, {"sha": "afc82546dac02756d6b4e918f4d997b032525704", "filename": "compiler/rustc_error_codes/src/error_codes/E0783.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a2b1347bbb4c3f16d6c7a6eff2b04d90561f9b09/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0783.md", "raw_url": "https://github.com/rust-lang/rust/raw/a2b1347bbb4c3f16d6c7a6eff2b04d90561f9b09/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0783.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0783.md?ref=a2b1347bbb4c3f16d6c7a6eff2b04d90561f9b09", "patch": "@@ -2,7 +2,7 @@ The range pattern `...` is no longer allowed.\n \n Erroneous code example:\n \n-```edition2021,compile_fail,E782\n+```edition2021,compile_fail,E783\n match 2u8 {\n     0...9 => println!(\"Got a number less than 10\"), // error!\n     _ => println!(\"Got a number 10 or more\"),"}, {"sha": "798f48060e7b7eed7915fae559ef4bb0b9429ad7", "filename": "src/test/ui/dyn-keyword/dyn-2021-edition-error.stderr", "status": "modified", "additions": 18, "deletions": 3, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/a2b1347bbb4c3f16d6c7a6eff2b04d90561f9b09/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-2021-edition-error.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a2b1347bbb4c3f16d6c7a6eff2b04d90561f9b09/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-2021-edition-error.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-2021-edition-error.stderr?ref=a2b1347bbb4c3f16d6c7a6eff2b04d90561f9b09", "patch": "@@ -2,19 +2,34 @@ error[E0782]: trait objects must include the `dyn` keyword\n   --> $DIR/dyn-2021-edition-error.rs:6:14\n    |\n LL |     let _x: &SomeTrait = todo!();\n-   |              ^^^^^^^^^ `dyn` keyword should be added before this trait\n+   |              ^^^^^^^^^\n+   |\n+help: add `dyn` keyword before this trait\n+   |\n+LL |     let _x: &dyn SomeTrait = todo!();\n+   |              ^^^\n \n error[E0782]: trait objects must include the `dyn` keyword\n   --> $DIR/dyn-2021-edition-error.rs:3:17\n    |\n LL | fn function(x: &SomeTrait, y: Box<SomeTrait>) {\n-   |                 ^^^^^^^^^ `dyn` keyword should be added before this trait\n+   |                 ^^^^^^^^^\n+   |\n+help: add `dyn` keyword before this trait\n+   |\n+LL | fn function(x: &dyn SomeTrait, y: Box<SomeTrait>) {\n+   |                 ^^^\n \n error[E0782]: trait objects must include the `dyn` keyword\n   --> $DIR/dyn-2021-edition-error.rs:3:35\n    |\n LL | fn function(x: &SomeTrait, y: Box<SomeTrait>) {\n-   |                                   ^^^^^^^^^ `dyn` keyword should be added before this trait\n+   |                                   ^^^^^^^^^\n+   |\n+help: add `dyn` keyword before this trait\n+   |\n+LL | fn function(x: &SomeTrait, y: Box<dyn SomeTrait>) {\n+   |                                   ^^^\n \n error: aborting due to 3 previous errors\n "}]}