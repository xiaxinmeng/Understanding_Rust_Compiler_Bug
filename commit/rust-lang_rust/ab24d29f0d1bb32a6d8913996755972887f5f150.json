{"sha": "ab24d29f0d1bb32a6d8913996755972887f5f150", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFiMjRkMjlmMGQxYmIzMmE2ZDg5MTM5OTY3NTU5NzI4ODdmNWYxNTA=", "commit": {"author": {"name": "Kevin Butler", "email": "haqkrs@gmail.com", "date": "2014-06-19T22:23:51Z"}, "committer": {"name": "Kevin Butler", "email": "haqkrs@gmail.com", "date": "2014-06-23T16:38:32Z"}, "message": "rustc: catch `impl X for Y` where X is not a trait in resolve.", "tree": {"sha": "1abe02757b3ad871e72b291088ab979dee894223", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1abe02757b3ad871e72b291088ab979dee894223"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ab24d29f0d1bb32a6d8913996755972887f5f150", "comment_count": 9, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ab24d29f0d1bb32a6d8913996755972887f5f150", "html_url": "https://github.com/rust-lang/rust/commit/ab24d29f0d1bb32a6d8913996755972887f5f150", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ab24d29f0d1bb32a6d8913996755972887f5f150/comments", "author": {"login": "Ryman", "id": 994978, "node_id": "MDQ6VXNlcjk5NDk3OA==", "avatar_url": "https://avatars.githubusercontent.com/u/994978?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ryman", "html_url": "https://github.com/Ryman", "followers_url": "https://api.github.com/users/Ryman/followers", "following_url": "https://api.github.com/users/Ryman/following{/other_user}", "gists_url": "https://api.github.com/users/Ryman/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ryman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ryman/subscriptions", "organizations_url": "https://api.github.com/users/Ryman/orgs", "repos_url": "https://api.github.com/users/Ryman/repos", "events_url": "https://api.github.com/users/Ryman/events{/privacy}", "received_events_url": "https://api.github.com/users/Ryman/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Ryman", "id": 994978, "node_id": "MDQ6VXNlcjk5NDk3OA==", "avatar_url": "https://avatars.githubusercontent.com/u/994978?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ryman", "html_url": "https://github.com/Ryman", "followers_url": "https://api.github.com/users/Ryman/followers", "following_url": "https://api.github.com/users/Ryman/following{/other_user}", "gists_url": "https://api.github.com/users/Ryman/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ryman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ryman/subscriptions", "organizations_url": "https://api.github.com/users/Ryman/orgs", "repos_url": "https://api.github.com/users/Ryman/repos", "events_url": "https://api.github.com/users/Ryman/events{/privacy}", "received_events_url": "https://api.github.com/users/Ryman/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "579a1392158a44ecabb36fe586500d862b3e95b7", "url": "https://api.github.com/repos/rust-lang/rust/commits/579a1392158a44ecabb36fe586500d862b3e95b7", "html_url": "https://github.com/rust-lang/rust/commit/579a1392158a44ecabb36fe586500d862b3e95b7"}], "stats": {"total": 72, "additions": 65, "deletions": 7}, "files": [{"sha": "ee6c5e1f9bc318ce0a65585e3023737ab917b611", "filename": "src/librustc/middle/resolve.rs", "status": "modified", "additions": 25, "deletions": 2, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/ab24d29f0d1bb32a6d8913996755972887f5f150/src%2Flibrustc%2Fmiddle%2Fresolve.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ab24d29f0d1bb32a6d8913996755972887f5f150/src%2Flibrustc%2Fmiddle%2Fresolve.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fresolve.rs?ref=ab24d29f0d1bb32a6d8913996755972887f5f150", "patch": "@@ -3894,8 +3894,31 @@ impl<'a> Resolver<'a> {\n                 self.resolve_error(trait_reference.path.span, msg.as_slice());\n             }\n             Some(def) => {\n-                debug!(\"(resolving trait) found trait def: {:?}\", def);\n-                self.record_def(trait_reference.ref_id, def);\n+                match def {\n+                    (DefTrait(_), _) => {\n+                        debug!(\"(resolving trait) found trait def: {:?}\", def);\n+                        self.record_def(trait_reference.ref_id, def);\n+                    }\n+                    (def, _) => {\n+                        self.resolve_error(trait_reference.path.span,\n+                                           format!(\"`{}` is not a trait\",\n+                                                   self.path_idents_to_str(\n+                                                        &trait_reference.path)));\n+\n+                        // If it's a typedef, give a note\n+                        match def {\n+                            DefTy(_) => {\n+                                self.session.span_note(\n+                                                trait_reference.path.span,\n+                                                format!(\"`type` aliases cannot \\\n+                                                        be used for traits\")\n+                                                        .as_slice());\n+                            }\n+                            _ => {}\n+                        }\n+                    }\n+                }\n+\n             }\n         }\n     }"}, {"sha": "795e48cb7b005c9eeceefde9bd656186d0b3c2e0", "filename": "src/test/compile-fail/issue-3907-2.rs", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/ab24d29f0d1bb32a6d8913996755972887f5f150/src%2Ftest%2Fcompile-fail%2Fissue-3907-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ab24d29f0d1bb32a6d8913996755972887f5f150/src%2Ftest%2Fcompile-fail%2Fissue-3907-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-3907-2.rs?ref=ab24d29f0d1bb32a6d8913996755972887f5f150", "patch": "@@ -0,0 +1,20 @@\n+// Copyright 2013-2014 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// aux-build:issue_3907.rs\n+extern crate issue_3907;\n+\n+type Foo = issue_3907::Foo; //~ ERROR: reference to trait\n+\n+struct S {\n+    name: int\n+}\n+\n+fn main() {}"}, {"sha": "a2faef59fd8286d605c0a610e5a8ed2cba07a9a5", "filename": "src/test/compile-fail/issue-3907.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/ab24d29f0d1bb32a6d8913996755972887f5f150/src%2Ftest%2Fcompile-fail%2Fissue-3907.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ab24d29f0d1bb32a6d8913996755972887f5f150/src%2Ftest%2Fcompile-fail%2Fissue-3907.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-3907.rs?ref=ab24d29f0d1bb32a6d8913996755972887f5f150", "patch": "@@ -1,4 +1,4 @@\n-// Copyright 2013 The Rust Project Developers. See the COPYRIGHT\n+// Copyright 2013-2014 The Rust Project Developers. See the COPYRIGHT\n // file at the top-level directory of this distribution and at\n // http://rust-lang.org/COPYRIGHT.\n //\n@@ -11,13 +11,14 @@\n // aux-build:issue_3907.rs\n extern crate issue_3907;\n \n-type Foo = issue_3907::Foo; //~ ERROR: reference to trait\n+type Foo = issue_3907::Foo;\n \n struct S {\n     name: int\n }\n \n impl Foo for S { //~ ERROR: `Foo` is not a trait\n+    //~^ NOTE: `type` aliases cannot be used for traits\n     fn bar() { }\n }\n "}, {"sha": "9b77d62a065292f74c68a264fa58da80565db02c", "filename": "src/test/compile-fail/issue-3973.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ab24d29f0d1bb32a6d8913996755972887f5f150/src%2Ftest%2Fcompile-fail%2Fissue-3973.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ab24d29f0d1bb32a6d8913996755972887f5f150/src%2Ftest%2Fcompile-fail%2Fissue-3973.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-3973.rs?ref=ab24d29f0d1bb32a6d8913996755972887f5f150", "patch": "@@ -31,7 +31,6 @@ impl NewTrait for Point {\n fn main() {\n     let p = Point::new(0.0, 0.0);\n     //~^ ERROR unresolved name `Point::new`\n-    //~^^ ERROR unresolved name\n-    //~^^^ ERROR use of undeclared module `Point`\n+    //~^^ ERROR failed to resolve. Use of undeclared module `Point`\n     println!(\"{}\", p.a());\n }"}, {"sha": "8d9116da81db21b74bdf9a37e868ccb4019aa3a7", "filename": "src/test/compile-fail/issue-5035-2.rs", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/ab24d29f0d1bb32a6d8913996755972887f5f150/src%2Ftest%2Fcompile-fail%2Fissue-5035-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ab24d29f0d1bb32a6d8913996755972887f5f150/src%2Ftest%2Fcompile-fail%2Fissue-5035-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-5035-2.rs?ref=ab24d29f0d1bb32a6d8913996755972887f5f150", "patch": "@@ -0,0 +1,14 @@\n+// Copyright 2013-2014 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+trait I {}\n+type K = I; //~ ERROR: reference to trait\n+\n+fn main() {}"}, {"sha": "8ffe308a669399d35b704ccde339221f1bd9a058", "filename": "src/test/compile-fail/issue-5035.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ab24d29f0d1bb32a6d8913996755972887f5f150/src%2Ftest%2Fcompile-fail%2Fissue-5035.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ab24d29f0d1bb32a6d8913996755972887f5f150/src%2Ftest%2Fcompile-fail%2Fissue-5035.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-5035.rs?ref=ab24d29f0d1bb32a6d8913996755972887f5f150", "patch": "@@ -9,6 +9,7 @@\n // except according to those terms.\n \n trait I {}\n-type K = I; //~ ERROR: reference to trait\n+type K = I;\n impl K for int {} //~ ERROR: `K` is not a trait\n+//~^ NOTE: `type` aliases cannot be used for traits\n fn main() {}"}]}