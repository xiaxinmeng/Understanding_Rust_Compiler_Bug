{"sha": "3a15475d363d60ba5ab947c6f8595c0a437623b4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNhMTU0NzVkMzYzZDYwYmE1YWI5NDdjNmY4NTk1YzBhNDM3NjIzYjQ=", "commit": {"author": {"name": "Corey Farwell", "email": "coreyf@rwell.org", "date": "2016-10-10T23:28:16Z"}, "committer": {"name": "Corey Farwell", "email": "coreyf@rwell.org", "date": "2016-10-10T23:28:16Z"}, "message": "Convert `String` generating functions into `&str` constants.", "tree": {"sha": "b0a745e167d966a556c5ab11cceef3a038b423c2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b0a745e167d966a556c5ab11cceef3a038b423c2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3a15475d363d60ba5ab947c6f8595c0a437623b4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3a15475d363d60ba5ab947c6f8595c0a437623b4", "html_url": "https://github.com/rust-lang/rust/commit/3a15475d363d60ba5ab947c6f8595c0a437623b4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3a15475d363d60ba5ab947c6f8595c0a437623b4/comments", "author": {"login": "frewsxcv", "id": 416575, "node_id": "MDQ6VXNlcjQxNjU3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/416575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frewsxcv", "html_url": "https://github.com/frewsxcv", "followers_url": "https://api.github.com/users/frewsxcv/followers", "following_url": "https://api.github.com/users/frewsxcv/following{/other_user}", "gists_url": "https://api.github.com/users/frewsxcv/gists{/gist_id}", "starred_url": "https://api.github.com/users/frewsxcv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frewsxcv/subscriptions", "organizations_url": "https://api.github.com/users/frewsxcv/orgs", "repos_url": "https://api.github.com/users/frewsxcv/repos", "events_url": "https://api.github.com/users/frewsxcv/events{/privacy}", "received_events_url": "https://api.github.com/users/frewsxcv/received_events", "type": "User", "site_admin": false}, "committer": {"login": "frewsxcv", "id": 416575, "node_id": "MDQ6VXNlcjQxNjU3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/416575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frewsxcv", "html_url": "https://github.com/frewsxcv", "followers_url": "https://api.github.com/users/frewsxcv/followers", "following_url": "https://api.github.com/users/frewsxcv/following{/other_user}", "gists_url": "https://api.github.com/users/frewsxcv/gists{/gist_id}", "starred_url": "https://api.github.com/users/frewsxcv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frewsxcv/subscriptions", "organizations_url": "https://api.github.com/users/frewsxcv/orgs", "repos_url": "https://api.github.com/users/frewsxcv/repos", "events_url": "https://api.github.com/users/frewsxcv/events{/privacy}", "received_events_url": "https://api.github.com/users/frewsxcv/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6d620843f62b6cf3182528ffcaa877eba461bfbb", "url": "https://api.github.com/repos/rust-lang/rust/commits/6d620843f62b6cf3182528ffcaa877eba461bfbb", "html_url": "https://github.com/rust-lang/rust/commit/6d620843f62b6cf3182528ffcaa877eba461bfbb"}], "stats": {"total": 28, "additions": 10, "deletions": 18}, "files": [{"sha": "ad10b7e808183681d94e105e4b86a61f21226e2e", "filename": "src/librustc/session/filesearch.rs", "status": "modified", "additions": 10, "deletions": 18, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/3a15475d363d60ba5ab947c6f8595c0a437623b4/src%2Flibrustc%2Fsession%2Ffilesearch.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3a15475d363d60ba5ab947c6f8595c0a437623b4/src%2Flibrustc%2Fsession%2Ffilesearch.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fsession%2Ffilesearch.rs?ref=3a15475d363d60ba5ab947c6f8595c0a437623b4", "patch": "@@ -124,7 +124,7 @@ impl<'a> FileSearch<'a> {\n     pub fn get_tools_search_paths(&self) -> Vec<PathBuf> {\n         let mut p = PathBuf::from(self.sysroot);\n         p.push(&find_libdir(self.sysroot));\n-        p.push(&rustlibdir());\n+        p.push(RUST_LIB_DIR);\n         p.push(&self.triple);\n         p.push(\"bin\");\n         vec![p]\n@@ -134,7 +134,7 @@ impl<'a> FileSearch<'a> {\n pub fn relative_target_lib_path(sysroot: &Path, target_triple: &str) -> PathBuf {\n     let mut p = PathBuf::from(&find_libdir(sysroot));\n     assert!(p.is_relative());\n-    p.push(&rustlibdir());\n+    p.push(RUST_LIB_DIR);\n     p.push(target_triple);\n     p.push(\"lib\");\n     p\n@@ -176,31 +176,23 @@ fn find_libdir(sysroot: &Path) -> String {\n     // \"lib\" (i.e. non-default), this value is used (see issue #16552).\n \n     match option_env!(\"CFG_LIBDIR_RELATIVE\") {\n-        Some(libdir) if libdir != \"lib\" => return libdir.to_string(),\n-        _ => if sysroot.join(&primary_libdir_name()).join(&rustlibdir()).exists() {\n-            return primary_libdir_name();\n+        Some(libdir) if libdir != \"lib\" => return libdir.into(),\n+        _ => if sysroot.join(PRIMARY_LIB_DIR).join(RUST_LIB_DIR).exists() {\n+            return PRIMARY_LIB_DIR.into();\n         } else {\n-            return secondary_libdir_name();\n+            return SECONDARY_LIB_DIR.into();\n         }\n     }\n \n     #[cfg(target_pointer_width = \"64\")]\n-    fn primary_libdir_name() -> String {\n-        \"lib64\".to_string()\n-    }\n+    const PRIMARY_LIB_DIR: &'static str = \"lib64\";\n \n     #[cfg(target_pointer_width = \"32\")]\n-    fn primary_libdir_name() -> String {\n-        \"lib32\".to_string()\n-    }\n+    const PRIMARY_LIB_DIR: &'static str = \"lib32\";\n \n-    fn secondary_libdir_name() -> String {\n-        \"lib\".to_string()\n-    }\n+    const SECONDARY_LIB_DIR: &'static str = \"lib\";\n }\n \n // The name of rustc's own place to organize libraries.\n // Used to be \"rustc\", now the default is \"rustlib\"\n-pub fn rustlibdir() -> String {\n-    \"rustlib\".to_string()\n-}\n+const RUST_LIB_DIR: &'static str = \"rustlib\";"}]}