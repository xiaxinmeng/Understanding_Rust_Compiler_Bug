{"sha": "e79bb42ab32c48e4afd8423d14f7f74444a2263d", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU3OWJiNDJhYjMyYzQ4ZTRhZmQ4NDIzZDE0ZjdmNzQ0NDRhMjI2M2Q=", "commit": {"author": {"name": "Eduard-Mihai Burtescu", "email": "edy.burt@gmail.com", "date": "2017-07-20T12:13:21Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-07-20T12:13:21Z"}, "message": "Merge pull request #262 from RalfJung/never\n\nremove ad-hoc 'never' type check in read_lvalue", "tree": {"sha": "1fabbb941f7f9fbaa1bdcece5b31a8b9bf012c10", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1fabbb941f7f9fbaa1bdcece5b31a8b9bf012c10"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e79bb42ab32c48e4afd8423d14f7f74444a2263d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e79bb42ab32c48e4afd8423d14f7f74444a2263d", "html_url": "https://github.com/rust-lang/rust/commit/e79bb42ab32c48e4afd8423d14f7f74444a2263d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e79bb42ab32c48e4afd8423d14f7f74444a2263d/comments", "author": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f02d9e63fde6d692b38b3843b16132c0b79a7ef6", "url": "https://api.github.com/repos/rust-lang/rust/commits/f02d9e63fde6d692b38b3843b16132c0b79a7ef6", "html_url": "https://github.com/rust-lang/rust/commit/f02d9e63fde6d692b38b3843b16132c0b79a7ef6"}, {"sha": "3b19c83c678a74a508fe874ac261a99121e51397", "url": "https://api.github.com/repos/rust-lang/rust/commits/3b19c83c678a74a508fe874ac261a99121e51397", "html_url": "https://github.com/rust-lang/rust/commit/3b19c83c678a74a508fe874ac261a99121e51397"}], "stats": {"total": 13, "additions": 4, "deletions": 9}, "files": [{"sha": "59f5dc8f4bbc20340ccffae9853b4c2a14241ef9", "filename": "src/lvalue.rs", "status": "modified", "additions": 3, "deletions": 8, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/e79bb42ab32c48e4afd8423d14f7f74444a2263d/src%2Flvalue.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e79bb42ab32c48e4afd8423d14f7f74444a2263d/src%2Flvalue.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flvalue.rs?ref=e79bb42ab32c48e4afd8423d14f7f74444a2263d", "patch": "@@ -182,22 +182,17 @@ impl<'a, 'tcx> EvalContext<'a, 'tcx> {\n \n     /// Returns a value and (in case of a ByRef) if we are supposed to use aligned accesses.\n     pub(super) fn eval_and_read_lvalue(&mut self, lvalue: &mir::Lvalue<'tcx>) -> EvalResult<'tcx, Value> {\n-        let ty = self.lvalue_ty(lvalue);\n         // Shortcut for things like accessing a fat pointer's field,\n         // which would otherwise (in the `eval_lvalue` path) require moving a `ByValPair` to memory\n         // and returning an `Lvalue::Ptr` to it\n         if let Some(val) = self.try_read_lvalue(lvalue)? {\n             return Ok(val);\n         }\n         let lvalue = self.eval_lvalue(lvalue)?;\n-        self.read_lvalue(lvalue, ty)\n+        self.read_lvalue(lvalue)\n     }\n \n-    pub fn read_lvalue(&self, lvalue: Lvalue<'tcx>, ty: Ty<'tcx>) -> EvalResult<'tcx, Value> {\n-        if ty.is_never() {\n-            return Err(EvalError::Unreachable);\n-        }\n-\n+    pub fn read_lvalue(&self, lvalue: Lvalue<'tcx>) -> EvalResult<'tcx, Value> {\n         match lvalue {\n             Lvalue::Ptr { ptr, extra, aligned } => {\n                 assert_eq!(extra, LvalueExtra::None);\n@@ -382,7 +377,7 @@ impl<'a, 'tcx> EvalContext<'a, 'tcx> {\n             }\n \n             Deref => {\n-                let val = self.read_lvalue(base, base_ty)?;\n+                let val = self.read_lvalue(base)?;\n \n                 let pointee_type = match base_ty.sty {\n                     ty::TyRawPtr(ref tam) |"}, {"sha": "3e80cb20b3fa7127b51cfdb346ff0cab6464c772", "filename": "tests/compile-fail/never_say_never.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e79bb42ab32c48e4afd8423d14f7f74444a2263d/tests%2Fcompile-fail%2Fnever_say_never.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e79bb42ab32c48e4afd8423d14f7f74444a2263d/tests%2Fcompile-fail%2Fnever_say_never.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Fnever_say_never.rs?ref=e79bb42ab32c48e4afd8423d14f7f74444a2263d", "patch": "@@ -4,7 +4,7 @@\n fn main() {\n     let y = &5;\n     let x: ! = unsafe {\n-        *(y as *const _ as *const !) //~ ERROR entered unreachable code\n+        *(y as *const _ as *const !) //~ ERROR tried to access a dead local variable\n     };\n     f(x)\n }"}]}