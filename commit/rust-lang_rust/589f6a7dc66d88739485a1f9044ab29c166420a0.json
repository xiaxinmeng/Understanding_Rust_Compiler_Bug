{"sha": "589f6a7dc66d88739485a1f9044ab29c166420a0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU4OWY2YTdkYzY2ZDg4NzM5NDg1YTFmOTA0NGFiMjljMTY2NDIwYTA=", "commit": {"author": {"name": "Saleem Jaffer", "email": "ssaleem1992@gmail.com", "date": "2019-07-18T09:22:30Z"}, "committer": {"name": "Saleem Jaffer", "email": "ssaleem1992@gmail.com", "date": "2019-07-18T09:22:30Z"}, "message": "tries to refactor InterpError in mir", "tree": {"sha": "f649e0241cd0ca0781c0f3a4c9158fb94c98222c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f649e0241cd0ca0781c0f3a4c9158fb94c98222c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/589f6a7dc66d88739485a1f9044ab29c166420a0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/589f6a7dc66d88739485a1f9044ab29c166420a0", "html_url": "https://github.com/rust-lang/rust/commit/589f6a7dc66d88739485a1f9044ab29c166420a0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/589f6a7dc66d88739485a1f9044ab29c166420a0/comments", "author": {"login": "saleemjaffer", "id": 19221716, "node_id": "MDQ6VXNlcjE5MjIxNzE2", "avatar_url": "https://avatars.githubusercontent.com/u/19221716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saleemjaffer", "html_url": "https://github.com/saleemjaffer", "followers_url": "https://api.github.com/users/saleemjaffer/followers", "following_url": "https://api.github.com/users/saleemjaffer/following{/other_user}", "gists_url": "https://api.github.com/users/saleemjaffer/gists{/gist_id}", "starred_url": "https://api.github.com/users/saleemjaffer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saleemjaffer/subscriptions", "organizations_url": "https://api.github.com/users/saleemjaffer/orgs", "repos_url": "https://api.github.com/users/saleemjaffer/repos", "events_url": "https://api.github.com/users/saleemjaffer/events{/privacy}", "received_events_url": "https://api.github.com/users/saleemjaffer/received_events", "type": "User", "site_admin": false}, "committer": {"login": "saleemjaffer", "id": 19221716, "node_id": "MDQ6VXNlcjE5MjIxNzE2", "avatar_url": "https://avatars.githubusercontent.com/u/19221716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saleemjaffer", "html_url": "https://github.com/saleemjaffer", "followers_url": "https://api.github.com/users/saleemjaffer/followers", "following_url": "https://api.github.com/users/saleemjaffer/following{/other_user}", "gists_url": "https://api.github.com/users/saleemjaffer/gists{/gist_id}", "starred_url": "https://api.github.com/users/saleemjaffer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saleemjaffer/subscriptions", "organizations_url": "https://api.github.com/users/saleemjaffer/orgs", "repos_url": "https://api.github.com/users/saleemjaffer/repos", "events_url": "https://api.github.com/users/saleemjaffer/events{/privacy}", "received_events_url": "https://api.github.com/users/saleemjaffer/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "efb74579150a6ea0ad99a8568aa02a1aa23f6dd5", "url": "https://api.github.com/repos/rust-lang/rust/commits/efb74579150a6ea0ad99a8568aa02a1aa23f6dd5", "html_url": "https://github.com/rust-lang/rust/commit/efb74579150a6ea0ad99a8568aa02a1aa23f6dd5"}], "stats": {"total": 43, "additions": 37, "deletions": 6}, "files": [{"sha": "d5caa3c8ce442ab2578de93acad00f6ae5b4ad81", "filename": "src/librustc/mir/interpret/error.rs", "status": "modified", "additions": 37, "deletions": 6, "changes": 43, "blob_url": "https://github.com/rust-lang/rust/blob/589f6a7dc66d88739485a1f9044ab29c166420a0/src%2Flibrustc%2Fmir%2Finterpret%2Ferror.rs", "raw_url": "https://github.com/rust-lang/rust/raw/589f6a7dc66d88739485a1f9044ab29c166420a0/src%2Flibrustc%2Fmir%2Finterpret%2Ferror.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmir%2Finterpret%2Ferror.rs?ref=589f6a7dc66d88739485a1f9044ab29c166420a0", "patch": "@@ -247,6 +247,7 @@ pub enum InterpError<'tcx, O> {\n     DanglingPointerDeref,\n     DoubleFree,\n     InvalidMemoryAccess,\n+    FunctionPointerTyMismatch(FnSig<'tcx>, FnSig<'tcx>),\n     InvalidFunctionPointer,\n     InvalidBool,\n     InvalidDiscriminant(ScalarMaybeUndef),\n@@ -266,11 +267,13 @@ pub enum InterpError<'tcx, O> {\n     Unimplemented(String),\n     DerefFunctionPointer,\n     ExecuteMemory,\n+    // asd\n     BoundsCheck { len: O, index: O },\n     Overflow(mir::BinOp),\n     OverflowNeg,\n     DivisionByZero,\n     RemainderByZero,\n+    // asd\n     Intrinsic(String),\n     InvalidChar(u128),\n     StackFrameLimitReached,\n@@ -281,6 +284,29 @@ pub enum InterpError<'tcx, O> {\n         required: Align,\n         has: Align,\n     },\n+    MemoryLockViolation {\n+        ptr: Pointer,\n+        len: u64,\n+        frame: usize,\n+        access: AccessKind,\n+        lock: Lock,\n+    },\n+    MemoryAcquireConflict {\n+        ptr: Pointer,\n+        len: u64,\n+        kind: AccessKind,\n+        lock: Lock,\n+    },\n+    InvalidMemoryLockRelease {\n+        ptr: Pointer,\n+        len: u64,\n+        frame: usize,\n+        lock: Lock,\n+    },\n+    DeallocatedLockedMemory {\n+        ptr: Pointer,\n+        lock: Lock,\n+    },\n     ValidationFailure(String),\n     CalledClosureAsFunction,\n     VtableForArgumentlessMethod,\n@@ -298,12 +324,7 @@ pub enum InterpError<'tcx, O> {\n     HeapAllocZeroBytes,\n     HeapAllocNonPowerOfTwoAlignment(u64),\n     Unreachable,\n-    Panic {\n-        msg: Symbol,\n-        line: u32,\n-        col: u32,\n-        file: Symbol,\n-    },\n+    Panic(EvalErrorPanic<'tcx, O>),\n     ReadFromReturnPointer,\n     PathNotFound(Vec<String>),\n     UnimplementedTraitSelection,\n@@ -319,6 +340,16 @@ pub enum InterpError<'tcx, O> {\n     InfiniteLoop,\n }\n \n+#[derive(Clone, RustcEncodable, RustcDecodable)]\n+pub enum EvalErrorPanic<'tcx, O> {\n+    Panic,\n+    BoundsCheck { len: O, index: O },\n+    Overflow(mir::BinOp),\n+    OverflowNeg,\n+    DivisionByZero,\n+    RemainderByZero,\n+}\n+\n pub type InterpResult<'tcx, T = ()> = Result<T, InterpErrorInfo<'tcx>>;\n \n impl<'tcx, O> InterpError<'tcx, O> {"}]}