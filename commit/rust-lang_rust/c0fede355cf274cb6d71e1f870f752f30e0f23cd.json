{"sha": "c0fede355cf274cb6d71e1f870f752f30e0f23cd", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMwZmVkZTM1NWNmMjc0Y2I2ZDcxZTFmODcwZjc1MmYzMGUwZjIzY2Q=", "commit": {"author": {"name": "Seiichi Uchida", "email": "seuchida@gmail.com", "date": "2020-05-27T03:31:14Z"}, "committer": {"name": "Caleb Cartwright", "email": "calebcartwright@users.noreply.github.com", "date": "2021-01-28T00:50:03Z"}, "message": "Use the span after generics and where clause (#4208)", "tree": {"sha": "7629832874f040cf1edb203606941eff0817618c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7629832874f040cf1edb203606941eff0817618c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c0fede355cf274cb6d71e1f870f752f30e0f23cd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c0fede355cf274cb6d71e1f870f752f30e0f23cd", "html_url": "https://github.com/rust-lang/rust/commit/c0fede355cf274cb6d71e1f870f752f30e0f23cd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c0fede355cf274cb6d71e1f870f752f30e0f23cd/comments", "author": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "committer": {"login": "calebcartwright", "id": 13042488, "node_id": "MDQ6VXNlcjEzMDQyNDg4", "avatar_url": "https://avatars.githubusercontent.com/u/13042488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/calebcartwright", "html_url": "https://github.com/calebcartwright", "followers_url": "https://api.github.com/users/calebcartwright/followers", "following_url": "https://api.github.com/users/calebcartwright/following{/other_user}", "gists_url": "https://api.github.com/users/calebcartwright/gists{/gist_id}", "starred_url": "https://api.github.com/users/calebcartwright/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/calebcartwright/subscriptions", "organizations_url": "https://api.github.com/users/calebcartwright/orgs", "repos_url": "https://api.github.com/users/calebcartwright/repos", "events_url": "https://api.github.com/users/calebcartwright/events{/privacy}", "received_events_url": "https://api.github.com/users/calebcartwright/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "269584634a7657d1026cee2db1c38d75cebbbd31", "url": "https://api.github.com/repos/rust-lang/rust/commits/269584634a7657d1026cee2db1c38d75cebbbd31", "html_url": "https://github.com/rust-lang/rust/commit/269584634a7657d1026cee2db1c38d75cebbbd31"}], "stats": {"total": 13, "additions": 11, "deletions": 2}, "files": [{"sha": "70cd7faad8bb19f104da0d15c5b054bcc8832f3f", "filename": "src/items.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/c0fede355cf274cb6d71e1f870f752f30e0f23cd/src%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c0fede355cf274cb6d71e1f870f752f30e0f23cd/src%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fitems.rs?ref=c0fede355cf274cb6d71e1f870f752f30e0f23cd", "patch": "@@ -1141,14 +1141,15 @@ pub(crate) fn format_trait(\n         }\n         result.push('{');\n \n-        let snippet = context.snippet(item.span);\n+        let block_span = mk_sp(generics.where_clause.span.hi(), item.span.hi());\n+        let snippet = context.snippet(block_span);\n         let open_pos = snippet.find_uncommented(\"{\")? + 1;\n         let outer_indent_str = offset.block_only().to_string_with_newline(context.config);\n \n         if !trait_items.is_empty() || contains_comment(&snippet[open_pos..]) {\n             let mut visitor = FmtVisitor::from_context(context);\n             visitor.block_indent = offset.block_only().block_indent(context.config);\n-            visitor.last_pos = item.span.lo() + BytePos(open_pos as u32);\n+            visitor.last_pos = block_span.lo() + BytePos(open_pos as u32);\n \n             for item in trait_items {\n                 visitor.visit_trait_item(item);"}, {"sha": "07ef99107a8057280b523f2f6a9bdc6d9c4fe34d", "filename": "tests/source/const_generics.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c0fede355cf274cb6d71e1f870f752f30e0f23cd/tests%2Fsource%2Fconst_generics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c0fede355cf274cb6d71e1f870f752f30e0f23cd/tests%2Fsource%2Fconst_generics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fconst_generics.rs?ref=c0fede355cf274cb6d71e1f870f752f30e0f23cd", "patch": "@@ -30,3 +30,7 @@ fn foo<const X: usize>() {\n }\n \n type Foo<const N: usize> = [i32; N + 1];\n+\n+pub trait Foo: Bar<{Baz::COUNT}> {\n+\tconst ASD: usize;\n+}"}, {"sha": "f49c5a1bb104bcbc13244212869efcfc8c7d8556", "filename": "tests/target/const_generics.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c0fede355cf274cb6d71e1f870f752f30e0f23cd/tests%2Ftarget%2Fconst_generics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c0fede355cf274cb6d71e1f870f752f30e0f23cd/tests%2Ftarget%2Fconst_generics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconst_generics.rs?ref=c0fede355cf274cb6d71e1f870f752f30e0f23cd", "patch": "@@ -22,3 +22,7 @@ fn foo<const X: usize>() {\n }\n \n type Foo<const N: usize> = [i32; N + 1];\n+\n+pub trait Foo: Bar<{ Baz::COUNT }> {\n+    const ASD: usize;\n+}"}]}