{"sha": "f4952d3780761c27cd686244aa490a1e64620e49", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY0OTUyZDM3ODA3NjFjMjdjZDY4NjI0NGFhNDkwYTFlNjQ2MjBlNDk=", "commit": {"author": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2017-04-06T01:01:19Z"}, "committer": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2017-04-06T01:01:19Z"}, "message": "Implement a max array width\n\nFixes #1421", "tree": {"sha": "0ff3928725ec636d84690457ed2b7aecb4612dbd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0ff3928725ec636d84690457ed2b7aecb4612dbd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f4952d3780761c27cd686244aa490a1e64620e49", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f4952d3780761c27cd686244aa490a1e64620e49", "html_url": "https://github.com/rust-lang/rust/commit/f4952d3780761c27cd686244aa490a1e64620e49", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f4952d3780761c27cd686244aa490a1e64620e49/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b3a4ba570e8e5066564c2e9a96cc381a443d544f", "url": "https://api.github.com/repos/rust-lang/rust/commits/b3a4ba570e8e5066564c2e9a96cc381a443d544f", "html_url": "https://github.com/rust-lang/rust/commit/b3a4ba570e8e5066564c2e9a96cc381a443d544f"}], "stats": {"total": 11, "additions": 9, "deletions": 2}, "files": [{"sha": "99d1d360a8afab596ff94508ffee716babbcb860", "filename": "src/config.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f4952d3780761c27cd686244aa490a1e64620e49/src%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f4952d3780761c27cd686244aa490a1e64620e49/src%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconfig.rs?ref=f4952d3780761c27cd686244aa490a1e64620e49", "patch": "@@ -352,6 +352,8 @@ create_config! {\n     fn_args_layout: IndentStyle, IndentStyle::Visual,\n         \"Layout of function arguments and tuple structs\";\n     array_layout: IndentStyle, IndentStyle::Visual, \"Indent on arrays\";\n+    array_width: usize, 60,\n+        \"Maximum width of an array literal before falling back to vertical formatting\";\n     type_punctuation_density: TypeDensity, TypeDensity::Wide,\n         \"Determines if '+' or '=' are wrapped in spaces in the punctuation of types\";\n     where_style: Style, Style::Default, \"Overall strategy for where clauses\";"}, {"sha": "04634e2645e4c1d751a17d61ee43dddd6c13b1b5", "filename": "src/expr.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/f4952d3780761c27cd686244aa490a1e64620e49/src%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f4952d3780761c27cd686244aa490a1e64620e49/src%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fexpr.rs?ref=f4952d3780761c27cd686244aa490a1e64620e49", "patch": "@@ -377,13 +377,18 @@ pub fn rewrite_array<'a, I>(expr_iter: I,\n         IndentStyle::Block => {\n             // FIXME wrong shape in one-line case\n             match shape.width.checked_sub(2 * bracket_size) {\n-                Some(width) => definitive_tactic(&items, ListTactic::HorizontalVertical, width),\n+                Some(width) => {\n+                    let tactic = ListTactic::LimitedHorizontalVertical(context.config.array_width);\n+                    definitive_tactic(&items, tactic, width)\n+                }\n                 None => DefinitiveListTactic::Vertical,\n             }\n         }\n         IndentStyle::Visual => {\n             if has_long_item || items.iter().any(ListItem::is_multiline) {\n-                definitive_tactic(&items, ListTactic::HorizontalVertical, nested_shape.width)\n+                definitive_tactic(&items,\n+                                  ListTactic::LimitedHorizontalVertical(context.config.array_width),\n+                                  nested_shape.width)\n             } else {\n                 DefinitiveListTactic::Mixed\n             }"}]}