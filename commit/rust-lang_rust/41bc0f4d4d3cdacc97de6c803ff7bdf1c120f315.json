{"sha": "41bc0f4d4d3cdacc97de6c803ff7bdf1c120f315", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQxYmMwZjRkNGQzY2RhY2M5N2RlNmM4MDNmZjdiZGYxYzEyMGYzMTU=", "commit": {"author": {"name": "xFrednet", "email": "xFrednet@gmail.com", "date": "2021-06-15T22:04:50Z"}, "committer": {"name": "flip1995", "email": "philipp.krones@embecosm.com", "date": "2021-06-25T09:16:59Z"}, "message": "Adjust pre-commit script to readd files after formatting", "tree": {"sha": "f35583e4e9434448906b34907408ab14eea1c1af", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f35583e4e9434448906b34907408ab14eea1c1af"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/41bc0f4d4d3cdacc97de6c803ff7bdf1c120f315", "comment_count": 0, "verification": {"verified": false, "reason": "bad_email", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEij1UXJ/PQTcb99vTHKDfKvWdaKUFAmDVnwsACgkQHKDfKvWd\naKXPxA/9FH0VBBTFy8gVxedbhIvOJq5ktmfiLbgLv4INoDZziHJ8QghI8qegB5ol\nUZcT8yJp2Y4yGnrnzE7G8zAY4uSz58ZPMe/VPLfN42F4lXEjnX26oBF25d/i7oAu\n7UPKkW20SOIZvplV1FCcDbFwvo8jZ6715iMi7e0tMlD7+x7zY+aZ4TXylr6mqJtj\nO5MYCvNAOlw/l6A/NJyxE+0WxEEnbjDcfcgiSi4SJXObX5g7CuqgVCoWo7Gu8sZg\nojZUyUxh7czR7E0pP/wWF2//tFII2jWpWt1gl76Sn7z1WRKbs/gguLtypmIuaMeg\neccFbscNk0Nv574YHY0mejeR2Tixi2VCGK0UOYBQ1IupDKf1KhK52LmFYzP9Zjpq\nAL/eOF6Q5W/sC0ikmy2MFkAlXz1iGXBQSKIQFMu7LXmjMTST7m07+6gVeBIMRvd4\nYJakFAxOVYCGYr3NdIL9IlTNhGqCZjvCoYYGN735Q9CCEDKcPhyH9nykuVxQtPIW\ncXCH8WzqBMBVmw8OIuig8OG3d6ZLry5UpeWm52yd1JoAB9EL+pxNza21OBWxiSVk\n/TPyuZv/hKgObBjithLGjqDcoeglBDQmC47xwoE+X7riUqgylmk02/H43JcFCNMq\nG2T4gn21wbqSWNlu61DyNE3Qn80ebURhE2AUOBvX5Rcm48eD8TM=\n=2rxW\n-----END PGP SIGNATURE-----", "payload": "tree f35583e4e9434448906b34907408ab14eea1c1af\nparent 0a5f28c4b0c78c030956afe77b7a5c0c3e33ef5b\nauthor xFrednet <xFrednet@gmail.com> 1623794690 +0200\ncommitter flip1995 <philipp.krones@embecosm.com> 1624612619 +0200\n\nAdjust pre-commit script to readd files after formatting\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/41bc0f4d4d3cdacc97de6c803ff7bdf1c120f315", "html_url": "https://github.com/rust-lang/rust/commit/41bc0f4d4d3cdacc97de6c803ff7bdf1c120f315", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/41bc0f4d4d3cdacc97de6c803ff7bdf1c120f315/comments", "author": {"login": "xFrednet", "id": 17087237, "node_id": "MDQ6VXNlcjE3MDg3MjM3", "avatar_url": "https://avatars.githubusercontent.com/u/17087237?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xFrednet", "html_url": "https://github.com/xFrednet", "followers_url": "https://api.github.com/users/xFrednet/followers", "following_url": "https://api.github.com/users/xFrednet/following{/other_user}", "gists_url": "https://api.github.com/users/xFrednet/gists{/gist_id}", "starred_url": "https://api.github.com/users/xFrednet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xFrednet/subscriptions", "organizations_url": "https://api.github.com/users/xFrednet/orgs", "repos_url": "https://api.github.com/users/xFrednet/repos", "events_url": "https://api.github.com/users/xFrednet/events{/privacy}", "received_events_url": "https://api.github.com/users/xFrednet/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0a5f28c4b0c78c030956afe77b7a5c0c3e33ef5b", "url": "https://api.github.com/repos/rust-lang/rust/commits/0a5f28c4b0c78c030956afe77b7a5c0c3e33ef5b", "html_url": "https://github.com/rust-lang/rust/commit/0a5f28c4b0c78c030956afe77b7a5c0c3e33ef5b"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "528f8953b25d8b81b40633a399def3fd9762726e", "filename": "util/etc/pre-commit.sh", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/41bc0f4d4d3cdacc97de6c803ff7bdf1c120f315/util%2Fetc%2Fpre-commit.sh", "raw_url": "https://github.com/rust-lang/rust/raw/41bc0f4d4d3cdacc97de6c803ff7bdf1c120f315/util%2Fetc%2Fpre-commit.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/util%2Fetc%2Fpre-commit.sh?ref=41bc0f4d4d3cdacc97de6c803ff7bdf1c120f315", "patch": "@@ -1,3 +1,21 @@\n #!/bin/sh\n \n-cargo dev fmt\n+# hide output\n+set -e\n+\n+# Update lints\n+cargo dev update_lints\n+git add clippy_lints/src/lib.rs\n+\n+# Formatting:\n+#     Git will not automatically add the formatted code to the staged changes once\n+#     fmt was executed. This collects all staged files rs files that are currently staged.\n+#     They will later be added back.\n+#\n+#     This was proudly stolen and adjusted from here:\n+#     https://medium.com/@harshitbangar/automatic-code-formatting-with-git-66c3c5c26798\n+files=$( (git diff --cached --name-only --diff-filter=ACMR | grep -Ei \"\\.rs$\") || true)\n+if [ ! -z \"${files}\" ]; then\n+    cargo dev fmt\n+    git add $(echo \"$files\" | paste -s -d \" \" -)\n+fi"}]}