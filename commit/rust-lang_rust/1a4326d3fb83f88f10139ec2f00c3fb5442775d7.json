{"sha": "1a4326d3fb83f88f10139ec2f00c3fb5442775d7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFhNDMyNmQzZmI4M2Y4OGYxMDEzOWVjMmYwMGMzZmI1NDQyNzc1ZDc=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-04-18T12:27:58Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-04-18T13:37:30Z"}, "message": "Workaround rust-lang/rust#49998 by opting into experimental `-Z nll-subminimal-causes` flag\n\nThis commit only applies the flag to the one test case,\nui/span/dropck_vec_cycle_checked.rs, that absolutely needs it. Without\nthe flag, that test takes an unknown amount of time (greater than 1\nminute) to compile. But its possible that other tests would also\nbenefit from the flag, and we may want to make it the default (after\nevaluating its impact on other tests).\n\nIn terms of its known impact on other tests, I have only evaluated the\nui tests, and the *only* ui test I have found that the flag impacts\n(running under NLL mode, of course), is src/test/ui/nll/issue-31567.rs\n\nIn particular:\n\n```\n% ./build/x86_64-unknown-linux-gnu/stage1/bin/rustc ../src/test/ui/nll/issue-31567.rs\nerror[E0597]: `*v.0` does not live long enough\n  --> ../src/test/ui/nll/issue-31567.rs:22:26\n   |\n22 |     let s_inner: &'a S = &*v.0; //~ ERROR `*v.0` does not live long enough\n   |                          ^^^^^ borrowed value does not live long enough\n23 |     &s_inner.0\n24 | }\n   | - borrowed value only lives until here\n   |\nnote: borrowed value must be valid for the lifetime 'a as defined on the function body at 21:1...\n  --> ../src/test/ui/nll/issue-31567.rs:21:1\n   |\n21 | fn get_dangling<'a>(v: VecWrapper<'a>) -> &'a u32 {\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nerror: aborting due to previous error\n\nFor more information about this error, try `rustc --explain E0597`.\n% ./build/x86_64-unknown-linux-gnu/stage1/bin/rustc ../src/test/ui/nll/issue-31567.rs  -Z nll-subminimal-causes\nerror[E0597]: `*v.0` does not live long enough\n  --> ../src/test/ui/nll/issue-31567.rs:22:26\n   |\n22 |     let s_inner: &'a S = &*v.0; //~ ERROR `*v.0` does not live long enough\n   |                          ^^^^^ borrowed value does not live long enough\n23 |     &s_inner.0\n24 | }\n   | -\n   | |\n   | borrowed value only lives until here\n   | borrow later used here, when `v` is dropped\n\nerror: aborting due to previous error\n\nFor more information about this error, try `rustc --explain E0597`.\n%\n```", "tree": {"sha": "5b0bee5f1540b44539c725486561e4c9ed1b0e04", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5b0bee5f1540b44539c725486561e4c9ed1b0e04"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1a4326d3fb83f88f10139ec2f00c3fb5442775d7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1a4326d3fb83f88f10139ec2f00c3fb5442775d7", "html_url": "https://github.com/rust-lang/rust/commit/1a4326d3fb83f88f10139ec2f00c3fb5442775d7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1a4326d3fb83f88f10139ec2f00c3fb5442775d7/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a771b0f07538ccfc58a07207be6a5e5519c58fe2", "url": "https://api.github.com/repos/rust-lang/rust/commits/a771b0f07538ccfc58a07207be6a5e5519c58fe2", "html_url": "https://github.com/rust-lang/rust/commit/a771b0f07538ccfc58a07207be6a5e5519c58fe2"}], "stats": {"total": 21, "additions": 12, "deletions": 9}, "files": [{"sha": "b7f8b85f46cee83f7027c80e5a3178695dc00765", "filename": "src/test/ui/span/dropck_vec_cycle_checked.nll.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/1a4326d3fb83f88f10139ec2f00c3fb5442775d7/src%2Ftest%2Fui%2Fspan%2Fdropck_vec_cycle_checked.nll.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1a4326d3fb83f88f10139ec2f00c3fb5442775d7/src%2Ftest%2Fui%2Fspan%2Fdropck_vec_cycle_checked.nll.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2Fdropck_vec_cycle_checked.nll.stderr?ref=1a4326d3fb83f88f10139ec2f00c3fb5442775d7", "patch": "@@ -1,5 +1,5 @@\n error[E0597]: `c1` does not live long enough\n-  --> $DIR/dropck_vec_cycle_checked.rs:118:24\n+  --> $DIR/dropck_vec_cycle_checked.rs:121:24\n    |\n LL |     c3.v[0].v.set(Some(&c1));\n    |                        ^^^ borrowed value does not live long enough\n@@ -11,7 +11,7 @@ LL | }\n    | borrow later used here, when `c1` is dropped\n \n error[E0597]: `c2` does not live long enough\n-  --> $DIR/dropck_vec_cycle_checked.rs:110:24\n+  --> $DIR/dropck_vec_cycle_checked.rs:113:24\n    |\n LL |     c1.v[0].v.set(Some(&c2));\n    |                        ^^^ borrowed value does not live long enough\n@@ -23,7 +23,7 @@ LL | }\n    | borrow later used here, when `c1` is dropped\n \n error[E0597]: `c3` does not live long enough\n-  --> $DIR/dropck_vec_cycle_checked.rs:112:24\n+  --> $DIR/dropck_vec_cycle_checked.rs:115:24\n    |\n LL |     c1.v[1].v.set(Some(&c3));\n    |                        ^^^ borrowed value does not live long enough"}, {"sha": "ece58d21ba932a2072d9b59ea8aafb0f466cac9d", "filename": "src/test/ui/span/dropck_vec_cycle_checked.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/1a4326d3fb83f88f10139ec2f00c3fb5442775d7/src%2Ftest%2Fui%2Fspan%2Fdropck_vec_cycle_checked.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1a4326d3fb83f88f10139ec2f00c3fb5442775d7/src%2Ftest%2Fui%2Fspan%2Fdropck_vec_cycle_checked.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2Fdropck_vec_cycle_checked.rs?ref=1a4326d3fb83f88f10139ec2f00c3fb5442775d7", "patch": "@@ -8,6 +8,9 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n+// compile-flags: -Z nll-subminimal-causes\n+// (Work around rust-lang/rust#49998 by opting into nll-subminimal-causes.)\n+\n // Reject mixing cyclic structure and Drop when using Vec.\n //\n // (Compare against compile-fail/dropck_arr_cycle_checked.rs)"}, {"sha": "a6bc8da6f7c0c661d8517db1c5af35fcba9a9398", "filename": "src/test/ui/span/dropck_vec_cycle_checked.stderr", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/1a4326d3fb83f88f10139ec2f00c3fb5442775d7/src%2Ftest%2Fui%2Fspan%2Fdropck_vec_cycle_checked.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1a4326d3fb83f88f10139ec2f00c3fb5442775d7/src%2Ftest%2Fui%2Fspan%2Fdropck_vec_cycle_checked.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2Fdropck_vec_cycle_checked.stderr?ref=1a4326d3fb83f88f10139ec2f00c3fb5442775d7", "patch": "@@ -1,5 +1,5 @@\n error[E0597]: `c2` does not live long enough\n-  --> $DIR/dropck_vec_cycle_checked.rs:110:25\n+  --> $DIR/dropck_vec_cycle_checked.rs:113:25\n    |\n LL |     c1.v[0].v.set(Some(&c2));\n    |                         ^^ borrowed value does not live long enough\n@@ -10,7 +10,7 @@ LL | }\n    = note: values in a scope are dropped in the opposite order they are created\n \n error[E0597]: `c3` does not live long enough\n-  --> $DIR/dropck_vec_cycle_checked.rs:112:25\n+  --> $DIR/dropck_vec_cycle_checked.rs:115:25\n    |\n LL |     c1.v[1].v.set(Some(&c3));\n    |                         ^^ borrowed value does not live long enough\n@@ -21,7 +21,7 @@ LL | }\n    = note: values in a scope are dropped in the opposite order they are created\n \n error[E0597]: `c2` does not live long enough\n-  --> $DIR/dropck_vec_cycle_checked.rs:114:25\n+  --> $DIR/dropck_vec_cycle_checked.rs:117:25\n    |\n LL |     c2.v[0].v.set(Some(&c2));\n    |                         ^^ borrowed value does not live long enough\n@@ -32,7 +32,7 @@ LL | }\n    = note: values in a scope are dropped in the opposite order they are created\n \n error[E0597]: `c3` does not live long enough\n-  --> $DIR/dropck_vec_cycle_checked.rs:116:25\n+  --> $DIR/dropck_vec_cycle_checked.rs:119:25\n    |\n LL |     c2.v[1].v.set(Some(&c3));\n    |                         ^^ borrowed value does not live long enough\n@@ -43,7 +43,7 @@ LL | }\n    = note: values in a scope are dropped in the opposite order they are created\n \n error[E0597]: `c1` does not live long enough\n-  --> $DIR/dropck_vec_cycle_checked.rs:118:25\n+  --> $DIR/dropck_vec_cycle_checked.rs:121:25\n    |\n LL |     c3.v[0].v.set(Some(&c1));\n    |                         ^^ borrowed value does not live long enough\n@@ -54,7 +54,7 @@ LL | }\n    = note: values in a scope are dropped in the opposite order they are created\n \n error[E0597]: `c2` does not live long enough\n-  --> $DIR/dropck_vec_cycle_checked.rs:120:25\n+  --> $DIR/dropck_vec_cycle_checked.rs:123:25\n    |\n LL |     c3.v[1].v.set(Some(&c2));\n    |                         ^^ borrowed value does not live long enough"}]}