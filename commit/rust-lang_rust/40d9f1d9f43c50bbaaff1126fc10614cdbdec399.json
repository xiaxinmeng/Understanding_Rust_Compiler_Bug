{"sha": "40d9f1d9f43c50bbaaff1126fc10614cdbdec399", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQwZDlmMWQ5ZjQzYzUwYmJhYWZmMTEyNmZjMTA2MTRjZGJkZWMzOTk=", "commit": {"author": {"name": "Wilco Kusee", "email": "wilcokusee@gmail.com", "date": "2019-01-13T11:22:59Z"}, "committer": {"name": "Wilco Kusee", "email": "wilcokusee@gmail.com", "date": "2019-01-13T11:22:59Z"}, "message": "Add run-rustfix to explicit_write test", "tree": {"sha": "18201a810efed2d6019d330c292029b380bb6a38", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/18201a810efed2d6019d330c292029b380bb6a38"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/40d9f1d9f43c50bbaaff1126fc10614cdbdec399", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/40d9f1d9f43c50bbaaff1126fc10614cdbdec399", "html_url": "https://github.com/rust-lang/rust/commit/40d9f1d9f43c50bbaaff1126fc10614cdbdec399", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/40d9f1d9f43c50bbaaff1126fc10614cdbdec399/comments", "author": {"login": "detrumi", "id": 5758008, "node_id": "MDQ6VXNlcjU3NTgwMDg=", "avatar_url": "https://avatars.githubusercontent.com/u/5758008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/detrumi", "html_url": "https://github.com/detrumi", "followers_url": "https://api.github.com/users/detrumi/followers", "following_url": "https://api.github.com/users/detrumi/following{/other_user}", "gists_url": "https://api.github.com/users/detrumi/gists{/gist_id}", "starred_url": "https://api.github.com/users/detrumi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/detrumi/subscriptions", "organizations_url": "https://api.github.com/users/detrumi/orgs", "repos_url": "https://api.github.com/users/detrumi/repos", "events_url": "https://api.github.com/users/detrumi/events{/privacy}", "received_events_url": "https://api.github.com/users/detrumi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "detrumi", "id": 5758008, "node_id": "MDQ6VXNlcjU3NTgwMDg=", "avatar_url": "https://avatars.githubusercontent.com/u/5758008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/detrumi", "html_url": "https://github.com/detrumi", "followers_url": "https://api.github.com/users/detrumi/followers", "following_url": "https://api.github.com/users/detrumi/following{/other_user}", "gists_url": "https://api.github.com/users/detrumi/gists{/gist_id}", "starred_url": "https://api.github.com/users/detrumi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/detrumi/subscriptions", "organizations_url": "https://api.github.com/users/detrumi/orgs", "repos_url": "https://api.github.com/users/detrumi/repos", "events_url": "https://api.github.com/users/detrumi/events{/privacy}", "received_events_url": "https://api.github.com/users/detrumi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9f8fb8007c467707c5820b3b9b5789f6340c7cdc", "url": "https://api.github.com/repos/rust-lang/rust/commits/9f8fb8007c467707c5820b3b9b5789f6340c7cdc", "html_url": "https://github.com/rust-lang/rust/commit/9f8fb8007c467707c5820b3b9b5789f6340c7cdc"}], "stats": {"total": 69, "additions": 61, "deletions": 8}, "files": [{"sha": "692d2ca675f91ac6712d46be511934876151e9bd", "filename": "tests/ui/explicit_write.fixed", "status": "added", "additions": 51, "deletions": 0, "changes": 51, "blob_url": "https://github.com/rust-lang/rust/blob/40d9f1d9f43c50bbaaff1126fc10614cdbdec399/tests%2Fui%2Fexplicit_write.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/40d9f1d9f43c50bbaaff1126fc10614cdbdec399/tests%2Fui%2Fexplicit_write.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fexplicit_write.fixed?ref=40d9f1d9f43c50bbaaff1126fc10614cdbdec399", "patch": "@@ -0,0 +1,51 @@\n+// run-rustfix\n+#![allow(unused_imports)]\n+#![warn(clippy::explicit_write)]\n+\n+fn stdout() -> String {\n+    String::new()\n+}\n+\n+fn stderr() -> String {\n+    String::new()\n+}\n+\n+fn main() {\n+    // these should warn\n+    {\n+        use std::io::Write;\n+        print!(\"test\");\n+        eprint!(\"test\");\n+        println!(\"test\");\n+        eprintln!(\"test\");\n+        print!(\"test\");\n+        eprint!(\"test\");\n+\n+        // including newlines\n+        println!(\"test\\ntest\");\n+        eprintln!(\"test\\ntest\");\n+    }\n+    // these should not warn, different destination\n+    {\n+        use std::fmt::Write;\n+        let mut s = String::new();\n+        write!(s, \"test\").unwrap();\n+        write!(s, \"test\").unwrap();\n+        writeln!(s, \"test\").unwrap();\n+        writeln!(s, \"test\").unwrap();\n+        s.write_fmt(format_args!(\"test\")).unwrap();\n+        s.write_fmt(format_args!(\"test\")).unwrap();\n+        write!(stdout(), \"test\").unwrap();\n+        write!(stderr(), \"test\").unwrap();\n+        writeln!(stdout(), \"test\").unwrap();\n+        writeln!(stderr(), \"test\").unwrap();\n+        stdout().write_fmt(format_args!(\"test\")).unwrap();\n+        stderr().write_fmt(format_args!(\"test\")).unwrap();\n+    }\n+    // these should not warn, no unwrap\n+    {\n+        use std::io::Write;\n+        std::io::stdout().write_fmt(format_args!(\"test\")).expect(\"no stdout\");\n+        std::io::stderr().write_fmt(format_args!(\"test\")).expect(\"no stderr\");\n+    }\n+}"}, {"sha": "455c5ef55d05c4209be525017565edc7706f26be", "filename": "tests/ui/explicit_write.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/40d9f1d9f43c50bbaaff1126fc10614cdbdec399/tests%2Fui%2Fexplicit_write.rs", "raw_url": "https://github.com/rust-lang/rust/raw/40d9f1d9f43c50bbaaff1126fc10614cdbdec399/tests%2Fui%2Fexplicit_write.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fexplicit_write.rs?ref=40d9f1d9f43c50bbaaff1126fc10614cdbdec399", "patch": "@@ -1,3 +1,5 @@\n+// run-rustfix\n+#![allow(unused_imports)]\n #![warn(clippy::explicit_write)]\n \n fn stdout() -> String {"}, {"sha": "9feef9c0dc8443cb0ef33f4df01e59a9110bea1c", "filename": "tests/ui/explicit_write.stderr", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/40d9f1d9f43c50bbaaff1126fc10614cdbdec399/tests%2Fui%2Fexplicit_write.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/40d9f1d9f43c50bbaaff1126fc10614cdbdec399/tests%2Fui%2Fexplicit_write.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fexplicit_write.stderr?ref=40d9f1d9f43c50bbaaff1126fc10614cdbdec399", "patch": "@@ -1,49 +1,49 @@\n error: use of `write!(stdout(), ...).unwrap()`\n-  --> $DIR/explicit_write.rs:15:9\n+  --> $DIR/explicit_write.rs:17:9\n    |\n LL |         write!(std::io::stdout(), \"test\").unwrap();\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try this: `print!(\"test\")`\n    |\n    = note: `-D clippy::explicit-write` implied by `-D warnings`\n \n error: use of `write!(stderr(), ...).unwrap()`\n-  --> $DIR/explicit_write.rs:16:9\n+  --> $DIR/explicit_write.rs:18:9\n    |\n LL |         write!(std::io::stderr(), \"test\").unwrap();\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try this: `eprint!(\"test\")`\n \n error: use of `writeln!(stdout(), ...).unwrap()`\n-  --> $DIR/explicit_write.rs:17:9\n+  --> $DIR/explicit_write.rs:19:9\n    |\n LL |         writeln!(std::io::stdout(), \"test\").unwrap();\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try this: `println!(\"test\")`\n \n error: use of `writeln!(stderr(), ...).unwrap()`\n-  --> $DIR/explicit_write.rs:18:9\n+  --> $DIR/explicit_write.rs:20:9\n    |\n LL |         writeln!(std::io::stderr(), \"test\").unwrap();\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try this: `eprintln!(\"test\")`\n \n error: use of `stdout().write_fmt(...).unwrap()`\n-  --> $DIR/explicit_write.rs:19:9\n+  --> $DIR/explicit_write.rs:21:9\n    |\n LL |         std::io::stdout().write_fmt(format_args!(\"test\")).unwrap();\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try this: `print!(\"test\")`\n \n error: use of `stderr().write_fmt(...).unwrap()`\n-  --> $DIR/explicit_write.rs:20:9\n+  --> $DIR/explicit_write.rs:22:9\n    |\n LL |         std::io::stderr().write_fmt(format_args!(\"test\")).unwrap();\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try this: `eprint!(\"test\")`\n \n error: use of `writeln!(stdout(), ...).unwrap()`\n-  --> $DIR/explicit_write.rs:23:9\n+  --> $DIR/explicit_write.rs:25:9\n    |\n LL |         writeln!(std::io::stdout(), \"test/ntest\").unwrap();\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try this: `println!(\"test/ntest\")`\n \n error: use of `writeln!(stderr(), ...).unwrap()`\n-  --> $DIR/explicit_write.rs:24:9\n+  --> $DIR/explicit_write.rs:26:9\n    |\n LL |         writeln!(std::io::stderr(), \"test/ntest\").unwrap();\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try this: `eprintln!(\"test/ntest\")`"}]}