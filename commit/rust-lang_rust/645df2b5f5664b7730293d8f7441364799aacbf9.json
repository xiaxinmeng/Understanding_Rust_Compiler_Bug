{"sha": "645df2b5f5664b7730293d8f7441364799aacbf9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY0NWRmMmI1ZjU2NjRiNzczMDI5M2Q4Zjc0NDEzNjQ3OTlhYWNiZjk=", "commit": {"author": {"name": "Wilco Kusee", "email": "wilcokusee@gmail.com", "date": "2019-11-29T15:03:39Z"}, "committer": {"name": "Wilco Kusee", "email": "wilcokusee@gmail.com", "date": "2019-11-29T15:03:39Z"}, "message": "Test rename for various identifiers", "tree": {"sha": "3ca7c4afb8d38730311a6f66fc76163c4edbffb1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3ca7c4afb8d38730311a6f66fc76163c4edbffb1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/645df2b5f5664b7730293d8f7441364799aacbf9", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQEcBAABAgAGBQJd4TNLAAoJENWyu1zcMzS8qsMH/2NAGtwi1DKwQxdOfyTziMFm\n+JJFzex9r4632U7Hq8gcrBjuy6bsvvQHSomRKGGeW99CQCibuMQawaNXHZo/ofRf\n05zGIVMVboO5dnrrk2PBvTS5x5Pg0l/KsR1u7T2ol+tjcF9vBxiEOZtMobcffrME\nIK7R99mEgcHNG/GMivEGrODPSwugbP7QkKhsCywqGVS3vuTsmBSnl6koK93JDwjQ\n7c8EMVnXM8bz6LDCOkZ/yjD/H2CHOk69uYjiV1Pfn/Adgj+ikqTc3+7OSs/wQq80\nrCKIQukb9liTyztJ1ed+Vf0AsOh2b7/QFTzvcrwnqLj0e1U94sYd5md2egjxQz0=\n=Q9Gw\n-----END PGP SIGNATURE-----", "payload": "tree 3ca7c4afb8d38730311a6f66fc76163c4edbffb1\nparent be9ba2b392aaada4b0ce72f61fd664fc3d4021b5\nauthor Wilco Kusee <wilcokusee@gmail.com> 1575039819 +0100\ncommitter Wilco Kusee <wilcokusee@gmail.com> 1575039819 +0100\n\nTest rename for various identifiers\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/645df2b5f5664b7730293d8f7441364799aacbf9", "html_url": "https://github.com/rust-lang/rust/commit/645df2b5f5664b7730293d8f7441364799aacbf9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/645df2b5f5664b7730293d8f7441364799aacbf9/comments", "author": {"login": "detrumi", "id": 5758008, "node_id": "MDQ6VXNlcjU3NTgwMDg=", "avatar_url": "https://avatars.githubusercontent.com/u/5758008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/detrumi", "html_url": "https://github.com/detrumi", "followers_url": "https://api.github.com/users/detrumi/followers", "following_url": "https://api.github.com/users/detrumi/following{/other_user}", "gists_url": "https://api.github.com/users/detrumi/gists{/gist_id}", "starred_url": "https://api.github.com/users/detrumi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/detrumi/subscriptions", "organizations_url": "https://api.github.com/users/detrumi/orgs", "repos_url": "https://api.github.com/users/detrumi/repos", "events_url": "https://api.github.com/users/detrumi/events{/privacy}", "received_events_url": "https://api.github.com/users/detrumi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "detrumi", "id": 5758008, "node_id": "MDQ6VXNlcjU3NTgwMDg=", "avatar_url": "https://avatars.githubusercontent.com/u/5758008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/detrumi", "html_url": "https://github.com/detrumi", "followers_url": "https://api.github.com/users/detrumi/followers", "following_url": "https://api.github.com/users/detrumi/following{/other_user}", "gists_url": "https://api.github.com/users/detrumi/gists{/gist_id}", "starred_url": "https://api.github.com/users/detrumi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/detrumi/subscriptions", "organizations_url": "https://api.github.com/users/detrumi/orgs", "repos_url": "https://api.github.com/users/detrumi/repos", "events_url": "https://api.github.com/users/detrumi/events{/privacy}", "received_events_url": "https://api.github.com/users/detrumi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "be9ba2b392aaada4b0ce72f61fd664fc3d4021b5", "url": "https://api.github.com/repos/rust-lang/rust/commits/be9ba2b392aaada4b0ce72f61fd664fc3d4021b5", "html_url": "https://github.com/rust-lang/rust/commit/be9ba2b392aaada4b0ce72f61fd664fc3d4021b5"}], "stats": {"total": 43, "additions": 43, "deletions": 0}, "files": [{"sha": "c1771edf899f2ecb4c62598a2ab23389ee89f649", "filename": "crates/ra_ide/src/references/rename.rs", "status": "modified", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/rust-lang/rust/blob/645df2b5f5664b7730293d8f7441364799aacbf9/crates%2Fra_ide%2Fsrc%2Freferences%2Frename.rs", "raw_url": "https://github.com/rust-lang/rust/raw/645df2b5f5664b7730293d8f7441364799aacbf9/crates%2Fra_ide%2Fsrc%2Freferences%2Frename.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide%2Fsrc%2Freferences%2Frename.rs?ref=645df2b5f5664b7730293d8f7441364799aacbf9", "patch": "@@ -123,6 +123,49 @@ mod tests {\n         mock_analysis::analysis_and_position, mock_analysis::single_file_with_position, FileId,\n     };\n \n+    #[test]\n+    fn test_rename_to_underscore() {\n+        test_rename(\n+            r#\"\n+    fn main() {\n+        let i<|> = 1;\n+    }\"#,\n+            \"_\",\n+            r#\"\n+    fn main() {\n+        let _ = 1;\n+    }\"#,\n+        );\n+    }\n+\n+    #[test]\n+    fn test_rename_to_raw_identifier() {\n+        test_rename(\n+            r#\"\n+    fn main() {\n+        let i<|> = 1;\n+    }\"#,\n+            \"r#fn\",\n+            r#\"\n+    fn main() {\n+        let r#fn = 1;\n+    }\"#,\n+        );\n+    }\n+\n+    #[test]\n+    fn test_rename_to_invalid_identifier() {\n+        let (analysis, position) = single_file_with_position(\n+            \"\n+    fn main() {\n+        let i<|> = 1;\n+    }\",\n+        );\n+        let new_name = \"invalid!\";\n+        let source_change = analysis.rename(position, new_name).unwrap();\n+        assert!(source_change.is_none());\n+    }\n+\n     #[test]\n     fn test_rename_for_local() {\n         test_rename("}]}