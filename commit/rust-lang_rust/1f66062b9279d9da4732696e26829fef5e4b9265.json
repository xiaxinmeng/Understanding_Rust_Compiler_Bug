{"sha": "1f66062b9279d9da4732696e26829fef5e4b9265", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFmNjYwNjJiOTI3OWQ5ZGE0NzMyNjk2ZTI2ODI5ZmVmNWU0YjkyNjU=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-01-12T09:55:19Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-01-12T09:55:19Z"}, "message": "Rollup merge of #57510 - nrc:manifest-profiles, r=alexcrichton\n\nAdd a profiles section to the manifest\n\nThis supports the profiles work for Rustup in a backwards compatible manner.\n\nr? @alexcrichton", "tree": {"sha": "772134b81c735975fe8ef87e54a80e4ffb497a54", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/772134b81c735975fe8ef87e54a80e4ffb497a54"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1f66062b9279d9da4732696e26829fef5e4b9265", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcObmHCRBK7hj4Ov3rIwAAdHIIAHqFSIA+ajo/xJn2fapaTM0A\nQoVxmLnJq713WEG2opCGlZ9+w7qD6sWDgJgdLQdQ6e0Nyp1IIDMLIqmZLcez5dya\nKRsSdlp+f0mBAC+S7COLOQKvLUGLm9G1ztRZkvUVrHJn5CB8riNky2VP8RszozpL\nv4Lq2WJtLSr/7fJgWiagZPgKur1JlCTGegUMDo3CRUtbsm/ptsOPShcZoUWwE0U5\nLHIYOPrJMMIMFVLRNhe+eV7MfFrd9wJzXEKSF3l8AjoxTZeaE3CTtY0+4mFHPdBk\nG+QmISQE4KZUynN3xPJQVTi0KSDdNu+piKrQFszLJppXSW8EBZIAC+FP9Ds6tmg=\n=sRa7\n-----END PGP SIGNATURE-----\n", "payload": "tree 772134b81c735975fe8ef87e54a80e4ffb497a54\nparent 52e02fc16b1806c95a6cd94cd627162a62a47e9d\nparent 4103e5b34bcd5fff13afe79494d6955d7996c804\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1547286919 +0100\ncommitter GitHub <noreply@github.com> 1547286919 +0100\n\nRollup merge of #57510 - nrc:manifest-profiles, r=alexcrichton\n\nAdd a profiles section to the manifest\n\nThis supports the profiles work for Rustup in a backwards compatible manner.\n\nr? @alexcrichton\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1f66062b9279d9da4732696e26829fef5e4b9265", "html_url": "https://github.com/rust-lang/rust/commit/1f66062b9279d9da4732696e26829fef5e4b9265", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1f66062b9279d9da4732696e26829fef5e4b9265/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "52e02fc16b1806c95a6cd94cd627162a62a47e9d", "url": "https://api.github.com/repos/rust-lang/rust/commits/52e02fc16b1806c95a6cd94cd627162a62a47e9d", "html_url": "https://github.com/rust-lang/rust/commit/52e02fc16b1806c95a6cd94cd627162a62a47e9d"}, {"sha": "4103e5b34bcd5fff13afe79494d6955d7996c804", "url": "https://api.github.com/repos/rust-lang/rust/commits/4103e5b34bcd5fff13afe79494d6955d7996c804", "html_url": "https://github.com/rust-lang/rust/commit/4103e5b34bcd5fff13afe79494d6955d7996c804"}], "stats": {"total": 25, "additions": 24, "deletions": 1}, "files": [{"sha": "b00daa716777fd3a298c0f223995c5c3a5fee040", "filename": "src/tools/build-manifest/src/main.rs", "status": "modified", "additions": 24, "deletions": 1, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/1f66062b9279d9da4732696e26829fef5e4b9265/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1f66062b9279d9da4732696e26829fef5e4b9265/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs?ref=1f66062b9279d9da4732696e26829fef5e4b9265", "patch": "@@ -131,7 +131,8 @@ struct Manifest {\n     manifest_version: String,\n     date: String,\n     pkg: BTreeMap<String, Package>,\n-    renames: BTreeMap<String, Rename>\n+    renames: BTreeMap<String, Rename>,\n+    profiles: BTreeMap<String, Vec<String>>,\n }\n \n #[derive(Serialize)]\n@@ -340,6 +341,7 @@ impl Builder {\n             date: self.date.to_string(),\n             pkg: BTreeMap::new(),\n             renames: BTreeMap::new(),\n+            profiles: BTreeMap::new(),\n         };\n \n         self.package(\"rustc\", &mut manifest.pkg, HOSTS);\n@@ -355,6 +357,20 @@ impl Builder {\n         self.package(\"llvm-tools-preview\", &mut manifest.pkg, TARGETS);\n         self.package(\"lldb-preview\", &mut manifest.pkg, TARGETS);\n \n+        self.profile(\"minimal\",\n+                     &mut manifest.profiles,\n+                     &[\"rustc\", \"cargo\", \"rust-std\", \"rust-mingw\"]);\n+        self.profile(\"default\",\n+                     &mut manifest.profiles,\n+                     &[\"rustc\", \"cargo\", \"rust-std\", \"rust-mingw\",\n+                       \"rust-docs\", \"rustfmt-preview\", \"clippy-preview\"]);\n+        self.profile(\"complete\",\n+                     &mut manifest.profiles,\n+                     &[\"rustc\", \"cargo\", \"rust-std\", \"rust-mingw\",\n+                       \"rust-docs\", \"rustfmt-preview\", \"clippy-preview\",\n+                       \"rls-preview\", \"rust-src\", \"llvm-tools-preview\",\n+                       \"lldb-preview\", \"rust-analysis\"]);\n+\n         manifest.renames.insert(\"rls\".to_owned(), Rename { to: \"rls-preview\".to_owned() });\n         manifest.renames.insert(\"rustfmt\".to_owned(), Rename { to: \"rustfmt-preview\".to_owned() });\n         manifest.renames.insert(\"clippy\".to_owned(), Rename { to: \"clippy-preview\".to_owned() });\n@@ -453,6 +469,13 @@ impl Builder {\n         return manifest;\n     }\n \n+    fn profile(&mut self,\n+               profile_name: &str,\n+               dst: &mut BTreeMap<String, Vec<String>>,\n+               pkgs: &[&str]) {\n+        dst.insert(profile_name.to_owned(), pkgs.iter().map(|s| (*s).to_owned()).collect());\n+    }\n+\n     fn package(&mut self,\n                pkgname: &str,\n                dst: &mut BTreeMap<String, Package>,"}]}