{"sha": "97fb15d9508da0712aa6a5b194251e90315105fb", "node_id": "C_kwDOAAsO6NoAKDk3ZmIxNWQ5NTA4ZGEwNzEyYWE2YTViMTk0MjUxZTkwMzE1MTA1ZmI", "commit": {"author": {"name": "est31", "email": "MTest31@outlook.com", "date": "2023-03-31T01:48:35Z"}, "committer": {"name": "est31", "email": "MTest31@outlook.com", "date": "2023-03-31T01:49:21Z"}, "message": "Don't emit the OS error in a note\n\nThis makes it possible to make the normalization of the error message\nmore precise, allowing us to not normalize all notes away.", "tree": {"sha": "2bcf887bda9a1098321204496aff46211e2f70fb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2bcf887bda9a1098321204496aff46211e2f70fb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/97fb15d9508da0712aa6a5b194251e90315105fb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/97fb15d9508da0712aa6a5b194251e90315105fb", "html_url": "https://github.com/rust-lang/rust/commit/97fb15d9508da0712aa6a5b194251e90315105fb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/97fb15d9508da0712aa6a5b194251e90315105fb/comments", "author": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "committer": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f24983222d207096851344f7551f0f4ec5cc2a61", "url": "https://api.github.com/repos/rust-lang/rust/commits/f24983222d207096851344f7551f0f4ec5cc2a61", "html_url": "https://github.com/rust-lang/rust/commit/f24983222d207096851344f7551f0f4ec5cc2a61"}], "stats": {"total": 25, "additions": 12, "deletions": 13}, "files": [{"sha": "9f96a04148792f4d4ae494edc47df4c38821e07f", "filename": "compiler/rustc_macros/src/diagnostics/fluent.rs", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/97fb15d9508da0712aa6a5b194251e90315105fb/compiler%2Frustc_macros%2Fsrc%2Fdiagnostics%2Ffluent.rs", "raw_url": "https://github.com/rust-lang/rust/raw/97fb15d9508da0712aa6a5b194251e90315105fb/compiler%2Frustc_macros%2Fsrc%2Fdiagnostics%2Ffluent.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_macros%2Fsrc%2Fdiagnostics%2Ffluent.rs?ref=97fb15d9508da0712aa6a5b194251e90315105fb", "patch": "@@ -97,9 +97,12 @@ pub(crate) fn fluent_messages(input: proc_macro::TokenStream) -> proc_macro::Tok\n     let resource_contents = match read_to_string(absolute_ftl_path) {\n         Ok(resource_contents) => resource_contents,\n         Err(e) => {\n-            Diagnostic::spanned(resource_span, Level::Error, \"could not open Fluent resource\")\n-                .note(e.to_string())\n-                .emit();\n+            Diagnostic::spanned(\n+                resource_span,\n+                Level::Error,\n+                format!(\"could not open Fluent resource: {}\", e.to_string()),\n+            )\n+            .emit();\n             return failed(&crate_name);\n         }\n     };"}, {"sha": "6ba13387b046096c114e8d0ea81af2f03a35296c", "filename": "tests/ui-fulldeps/fluent-messages/test.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/97fb15d9508da0712aa6a5b194251e90315105fb/tests%2Fui-fulldeps%2Ffluent-messages%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/97fb15d9508da0712aa6a5b194251e90315105fb/tests%2Fui-fulldeps%2Ffluent-messages%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui-fulldeps%2Ffluent-messages%2Ftest.rs?ref=97fb15d9508da0712aa6a5b194251e90315105fb", "patch": "@@ -1,4 +1,4 @@\n-// normalize-stderr-test \"note.*\" -> \"note: os-specific message\"\n+// normalize-stderr-test \"could not open Fluent resource:.*\" -> \"could not open Fluent resource: os-specific message\"\n \n #![feature(rustc_private)]\n #![crate_type = \"lib\"]"}, {"sha": "2affe621c113adce68641172c125210f6c1556ad", "filename": "tests/ui-fulldeps/fluent-messages/test.stderr", "status": "modified", "additions": 5, "deletions": 9, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/97fb15d9508da0712aa6a5b194251e90315105fb/tests%2Fui-fulldeps%2Ffluent-messages%2Ftest.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/97fb15d9508da0712aa6a5b194251e90315105fb/tests%2Fui-fulldeps%2Ffluent-messages%2Ftest.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui-fulldeps%2Ffluent-messages%2Ftest.stderr?ref=97fb15d9508da0712aa6a5b194251e90315105fb", "patch": "@@ -1,18 +1,14 @@\n-error: could not open Fluent resource\n+error: could not open Fluent resource: os-specific message\n   --> $DIR/test.rs:24:24\n    |\n LL |     fluent_messages! { \"/definitely_does_not_exist.ftl\" }\n    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: os-specific message\n \n-error: could not open Fluent resource\n+error: could not open Fluent resource: os-specific message\n   --> $DIR/test.rs:31:24\n    |\n LL |     fluent_messages! { \"../definitely_does_not_exist.ftl\" }\n    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: os-specific message\n \n error: could not parse Fluent resource\n   --> $DIR/test.rs:38:24\n@@ -89,23 +85,23 @@ error: invalid escape `\\n` in Fluent resource\n LL |     fluent_messages! { \"./invalid-escape.ftl\" }\n    |                        ^^^^^^^^^^^^^^^^^^^^^^\n    |\n-   = note: os-specific message\n+   = note: Fluent does not interpret these escape sequences (<https://projectfluent.org/fluent/guide/special.html>)\n \n error: invalid escape `\\\"` in Fluent resource\n   --> $DIR/test.rs:99:24\n    |\n LL |     fluent_messages! { \"./invalid-escape.ftl\" }\n    |                        ^^^^^^^^^^^^^^^^^^^^^^\n    |\n-   = note: os-specific message\n+   = note: Fluent does not interpret these escape sequences (<https://projectfluent.org/fluent/guide/special.html>)\n \n error: invalid escape `\\'` in Fluent resource\n   --> $DIR/test.rs:99:24\n    |\n LL |     fluent_messages! { \"./invalid-escape.ftl\" }\n    |                        ^^^^^^^^^^^^^^^^^^^^^^\n    |\n-   = note: os-specific message\n+   = note: Fluent does not interpret these escape sequences (<https://projectfluent.org/fluent/guide/special.html>)\n \n error: aborting due to 13 previous errors\n "}]}