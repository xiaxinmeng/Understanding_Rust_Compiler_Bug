{"sha": "2c8b3bef2bb5d708e047afc4d0dadf0a85528470", "node_id": "C_kwDOAAsO6NoAKDJjOGIzYmVmMmJiNWQ3MDhlMDQ3YWZjNGQwZGFkZjBhODU1Mjg0NzA", "commit": {"author": {"name": "Tom Milligan", "email": "tommilligan@users.noreply.github.com", "date": "2022-06-21T15:23:13Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-06-21T15:23:13Z"}, "message": "ci: include config_proc_macro crate in ci (#5389)\n\n* config_proc_macro: fix failing doctests\r\n\r\n* ci: include config_proc_macro crate in ci\r\n\r\n* [review] working native windows ci\r\n\r\n* [fix] add --locked file for ci\r\n\r\n* [fix] quoting of cmd variables", "tree": {"sha": "bafba72f055d77ba9f87fe9b22d49d32112eb5d7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bafba72f055d77ba9f87fe9b22d49d32112eb5d7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2c8b3bef2bb5d708e047afc4d0dadf0a85528470", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJiseJhCRBK7hj4Ov3rIwAA3usIAJC3rT56QXllItL0lYMNJoSK\n7gLbZqx/IUGm4aJUsHS1XYptAQGGjhsKoz2Gocl8c60VWUV4p8sKNsKQ+hVTdE2u\n1tryZ6xeF42nuXcIt6NpTbYCaUq+zG7YleMYTUyw5AFBC8fuG1Ovev/jNpYs5E20\nLePnxmSNN8asczOKJDZI+EXf8ZIlW4BCOIxHDlPEDmZGvm+Zmscg5WY05r++ERt/\nsPlmyFeaQeFQrvMPyklG/K58hYT811/duHpg1eFgieq8KslKwf29qyJbxp9iGnb1\nprYlHFirbplGDupEggQdmg/DGX0pNAGe/P88OTv2l5vOhmYwrreE/YBA75e7mAc=\n=J7ZG\n-----END PGP SIGNATURE-----\n", "payload": "tree bafba72f055d77ba9f87fe9b22d49d32112eb5d7\nparent 3de1a095e0ed52ade1b88d165d44d80455d3e6c5\nauthor Tom Milligan <tommilligan@users.noreply.github.com> 1655824993 +0100\ncommitter GitHub <noreply@github.com> 1655824993 -0500\n\nci: include config_proc_macro crate in ci (#5389)\n\n* config_proc_macro: fix failing doctests\r\n\r\n* ci: include config_proc_macro crate in ci\r\n\r\n* [review] working native windows ci\r\n\r\n* [fix] add --locked file for ci\r\n\r\n* [fix] quoting of cmd variables"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2c8b3bef2bb5d708e047afc4d0dadf0a85528470", "html_url": "https://github.com/rust-lang/rust/commit/2c8b3bef2bb5d708e047afc4d0dadf0a85528470", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2c8b3bef2bb5d708e047afc4d0dadf0a85528470/comments", "author": {"login": "tommilligan", "id": 12255914, "node_id": "MDQ6VXNlcjEyMjU1OTE0", "avatar_url": "https://avatars.githubusercontent.com/u/12255914?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tommilligan", "html_url": "https://github.com/tommilligan", "followers_url": "https://api.github.com/users/tommilligan/followers", "following_url": "https://api.github.com/users/tommilligan/following{/other_user}", "gists_url": "https://api.github.com/users/tommilligan/gists{/gist_id}", "starred_url": "https://api.github.com/users/tommilligan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tommilligan/subscriptions", "organizations_url": "https://api.github.com/users/tommilligan/orgs", "repos_url": "https://api.github.com/users/tommilligan/repos", "events_url": "https://api.github.com/users/tommilligan/events{/privacy}", "received_events_url": "https://api.github.com/users/tommilligan/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3de1a095e0ed52ade1b88d165d44d80455d3e6c5", "url": "https://api.github.com/repos/rust-lang/rust/commits/3de1a095e0ed52ade1b88d165d44d80455d3e6c5", "html_url": "https://github.com/rust-lang/rust/commit/3de1a095e0ed52ade1b88d165d44d80455d3e6c5"}], "stats": {"total": 115, "additions": 64, "deletions": 51}, "files": [{"sha": "bce9b0c8d5a95ed1659c4906be6647d20369babe", "filename": ".github/workflows/linux.yml", "status": "modified", "additions": 2, "deletions": 12, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/2c8b3bef2bb5d708e047afc4d0dadf0a85528470/.github%2Fworkflows%2Flinux.yml", "raw_url": "https://github.com/rust-lang/rust/raw/2c8b3bef2bb5d708e047afc4d0dadf0a85528470/.github%2Fworkflows%2Flinux.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Flinux.yml?ref=2c8b3bef2bb5d708e047afc4d0dadf0a85528470", "patch": "@@ -35,15 +35,5 @@ jobs:\n         sh rustup-init.sh -y --default-toolchain none\n         rustup target add ${{ matrix.target }}\n \n-    - name: build\n-      run: |\n-        rustc -Vv\n-        cargo -V\n-        cargo build\n-      env:\n-        RUSTFLAGS: '-D warnings'\n-\n-    - name: test\n-      run: cargo test\n-      env:\n-        RUSTFLAGS: '-D warnings'\n+    - name: Build and Test\n+      run: ./ci/build_and_test.sh"}, {"sha": "89a980c42c5a09cbc17d600ad31099726832e4c4", "filename": ".github/workflows/mac.yml", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2c8b3bef2bb5d708e047afc4d0dadf0a85528470/.github%2Fworkflows%2Fmac.yml", "raw_url": "https://github.com/rust-lang/rust/raw/2c8b3bef2bb5d708e047afc4d0dadf0a85528470/.github%2Fworkflows%2Fmac.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fmac.yml?ref=2c8b3bef2bb5d708e047afc4d0dadf0a85528470", "patch": "@@ -32,11 +32,5 @@ jobs:\n         sh rustup-init.sh -y --default-toolchain none\n         rustup target add ${{ matrix.target }}\n \n-    - name: build\n-      run: |\n-        rustc -Vv\n-        cargo -V\n-        cargo build\n-\n-    - name: test\n-      run: cargo test\n+    - name: Build and Test\n+      run: ./ci/build_and_test.sh"}, {"sha": "ec37c714b085106d0fbbbe9d65ff9c5ed2f44159", "filename": ".github/workflows/windows.yml", "status": "modified", "additions": 2, "deletions": 9, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/2c8b3bef2bb5d708e047afc4d0dadf0a85528470/.github%2Fworkflows%2Fwindows.yml", "raw_url": "https://github.com/rust-lang/rust/raw/2c8b3bef2bb5d708e047afc4d0dadf0a85528470/.github%2Fworkflows%2Fwindows.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fwindows.yml?ref=2c8b3bef2bb5d708e047afc4d0dadf0a85528470", "patch": "@@ -57,13 +57,6 @@ jobs:\n       if: matrix.target == 'x86_64-pc-windows-gnu' && matrix.channel == 'nightly'\n       shell: bash\n \n-    - name: build\n-      run: |\n-        rustc -Vv\n-        cargo -V\n-        cargo build\n-      shell: cmd\n-\n-    - name: test\n-      run: cargo test\n+    - name: Build and Test\n       shell: cmd\n+      run: ci\\build_and_test.bat"}, {"sha": "ef41017783feb6e44f576f3bc3e58b8a8bdfa1c3", "filename": "ci/build_and_test.bat", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/2c8b3bef2bb5d708e047afc4d0dadf0a85528470/ci%2Fbuild_and_test.bat", "raw_url": "https://github.com/rust-lang/rust/raw/2c8b3bef2bb5d708e047afc4d0dadf0a85528470/ci%2Fbuild_and_test.bat", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/ci%2Fbuild_and_test.bat?ref=2c8b3bef2bb5d708e047afc4d0dadf0a85528470", "patch": "@@ -0,0 +1,14 @@\n+set \"RUSTFLAGS=-D warnings\"\n+\n+:: Print version information\n+rustc -Vv || exit /b 1\n+cargo -V || exit /b 1\n+\n+:: Build and test main crate\n+cargo build --locked || exit /b 1\n+cargo test || exit /b 1\n+\n+:: Build and test other crates\n+cd config_proc_macro || exit /b 1\n+cargo build --locked || exit /b 1\n+cargo test || exit /b 1"}, {"sha": "8fa0f67b0d02184e63d299bfcf0befb7ee82ce9a", "filename": "ci/build_and_test.sh", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/2c8b3bef2bb5d708e047afc4d0dadf0a85528470/ci%2Fbuild_and_test.sh", "raw_url": "https://github.com/rust-lang/rust/raw/2c8b3bef2bb5d708e047afc4d0dadf0a85528470/ci%2Fbuild_and_test.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/ci%2Fbuild_and_test.sh?ref=2c8b3bef2bb5d708e047afc4d0dadf0a85528470", "patch": "@@ -0,0 +1,18 @@\n+#!/bin/bash\n+\n+set -euo pipefail\n+\n+export RUSTFLAGS=\"-D warnings\"\n+\n+# Print version information\n+rustc -Vv\n+cargo -V\n+\n+# Build and test main crate\n+cargo build --locked\n+cargo test\n+\n+# Build and test other crates\n+cd config_proc_macro\n+cargo build --locked\n+cargo test"}, {"sha": "ecf561f28fb6aa5e64cffedfdefd2a146e61b1d5", "filename": "config_proc_macro/Cargo.lock", "status": "modified", "additions": 22, "deletions": 22, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/2c8b3bef2bb5d708e047afc4d0dadf0a85528470/config_proc_macro%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/2c8b3bef2bb5d708e047afc4d0dadf0a85528470/config_proc_macro%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/config_proc_macro%2FCargo.lock?ref=2c8b3bef2bb5d708e047afc4d0dadf0a85528470", "patch": "@@ -1,68 +1,68 @@\n # This file is automatically @generated by Cargo.\n # It is not intended for manual editing.\n+version = 3\n+\n [[package]]\n name = \"proc-macro2\"\n version = \"1.0.3\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"e98a83a9f9b331f54b924e68a66acb1bb35cb01fb0a23645139967abefb697e8\"\n dependencies = [\n- \"unicode-xid 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"unicode-xid\",\n ]\n \n [[package]]\n name = \"quote\"\n version = \"1.0.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"053a8c8bcc71fcce321828dc897a98ab9760bef03a4fc36693c231e5b3216cfe\"\n dependencies = [\n- \"proc-macro2 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"proc-macro2\",\n ]\n \n [[package]]\n name = \"rustfmt-config_proc_macro\"\n-version = \"0.1.2\"\n+version = \"0.2.0\"\n dependencies = [\n- \"proc-macro2 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"serde 1.0.99 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"syn 1.0.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"proc-macro2\",\n+ \"quote\",\n+ \"serde\",\n+ \"syn\",\n ]\n \n [[package]]\n name = \"serde\"\n version = \"1.0.99\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"fec2851eb56d010dc9a21b89ca53ee75e6528bab60c11e89d38390904982da9f\"\n dependencies = [\n- \"serde_derive 1.0.99 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"serde_derive\",\n ]\n \n [[package]]\n name = \"serde_derive\"\n version = \"1.0.99\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"cb4dc18c61206b08dc98216c98faa0232f4337e1e1b8574551d5bad29ea1b425\"\n dependencies = [\n- \"proc-macro2 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"syn 1.0.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"proc-macro2\",\n+ \"quote\",\n+ \"syn\",\n ]\n \n [[package]]\n name = \"syn\"\n version = \"1.0.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"66850e97125af79138385e9b88339cbcd037e3f28ceab8c5ad98e64f0f1f80bf\"\n dependencies = [\n- \"proc-macro2 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"unicode-xid 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"proc-macro2\",\n+ \"quote\",\n+ \"unicode-xid\",\n ]\n \n [[package]]\n name = \"unicode-xid\"\n version = \"0.2.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-\n-[metadata]\n-\"checksum proc-macro2 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"e98a83a9f9b331f54b924e68a66acb1bb35cb01fb0a23645139967abefb697e8\"\n-\"checksum quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"053a8c8bcc71fcce321828dc897a98ab9760bef03a4fc36693c231e5b3216cfe\"\n-\"checksum serde 1.0.99 (registry+https://github.com/rust-lang/crates.io-index)\" = \"fec2851eb56d010dc9a21b89ca53ee75e6528bab60c11e89d38390904982da9f\"\n-\"checksum serde_derive 1.0.99 (registry+https://github.com/rust-lang/crates.io-index)\" = \"cb4dc18c61206b08dc98216c98faa0232f4337e1e1b8574551d5bad29ea1b425\"\n-\"checksum syn 1.0.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"66850e97125af79138385e9b88339cbcd037e3f28ceab8c5ad98e64f0f1f80bf\"\n-\"checksum unicode-xid 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"826e7639553986605ec5979c7dd957c7895e93eabed50ab2ffa7f6128a75097c\"\n+checksum = \"826e7639553986605ec5979c7dd957c7895e93eabed50ab2ffa7f6128a75097c\""}, {"sha": "e772c53f42361f94131e0e67294b107ae532a0cd", "filename": "config_proc_macro/src/lib.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2c8b3bef2bb5d708e047afc4d0dadf0a85528470/config_proc_macro%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2c8b3bef2bb5d708e047afc4d0dadf0a85528470/config_proc_macro%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/config_proc_macro%2Fsrc%2Flib.rs?ref=2c8b3bef2bb5d708e047afc4d0dadf0a85528470", "patch": "@@ -29,6 +29,8 @@ pub fn config_type(_args: TokenStream, input: TokenStream) -> TokenStream {\n /// Used to conditionally output the TokenStream for tests that need to be run on nightly only.\n ///\n /// ```rust\n+/// # use rustfmt_config_proc_macro::nightly_only_test;\n+///\n /// #[nightly_only_test]\n /// #[test]\n /// fn test_needs_nightly_rustfmt() {\n@@ -49,6 +51,8 @@ pub fn nightly_only_test(_args: TokenStream, input: TokenStream) -> TokenStream\n /// Used to conditionally output the TokenStream for tests that need to be run on stable only.\n ///\n /// ```rust\n+/// # use rustfmt_config_proc_macro::stable_only_test;\n+///\n /// #[stable_only_test]\n /// #[test]\n /// fn test_needs_stable_rustfmt() {"}]}