{"sha": "f1d04780020fed9f6ade87ab39964f6c459aca33", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYxZDA0NzgwMDIwZmVkOWY2YWRlODdhYjM5OTY0ZjZjNDU5YWNhMzM=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2013-01-14T21:17:20Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2013-01-14T21:17:20Z"}, "message": "Add cfg attrs to handle auto_encode transition", "tree": {"sha": "5f408a8102a0d43b2ced7be5d72a59a17f3cf142", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5f408a8102a0d43b2ced7be5d72a59a17f3cf142"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f1d04780020fed9f6ade87ab39964f6c459aca33", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f1d04780020fed9f6ade87ab39964f6c459aca33", "html_url": "https://github.com/rust-lang/rust/commit/f1d04780020fed9f6ade87ab39964f6c459aca33", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f1d04780020fed9f6ade87ab39964f6c459aca33/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fc582bcfcedc5154b98b45bb5e41eddfcd3a1f74", "url": "https://api.github.com/repos/rust-lang/rust/commits/fc582bcfcedc5154b98b45bb5e41eddfcd3a1f74", "html_url": "https://github.com/rust-lang/rust/commit/fc582bcfcedc5154b98b45bb5e41eddfcd3a1f74"}], "stats": {"total": 58, "additions": 58, "deletions": 0}, "files": [{"sha": "cc3d080d30ecc40e16cde8bbcad32454ecc1e6a6", "filename": "src/libstd/ebml.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/f1d04780020fed9f6ade87ab39964f6c459aca33/src%2Flibstd%2Febml.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f1d04780020fed9f6ade87ab39964f6c459aca33/src%2Flibstd%2Febml.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Febml.rs?ref=f1d04780020fed9f6ade87ab39964f6c459aca33", "patch": "@@ -379,6 +379,14 @@ pub mod reader {\n             f()\n         }\n \n+        #[cfg(stage0)]\n+        fn read_struct<T>(&self, name: &str, f: fn() -> T) -> T {\n+            debug!(\"read_struct(name=%s)\", name);\n+            f()\n+        }\n+        #[cfg(stage1)]\n+        #[cfg(stage2)]\n+        #[cfg(stage3)]\n         fn read_struct<T>(&self, name: &str, _len: uint, f: fn() -> T) -> T {\n             debug!(\"read_struct(name=%s)\", name);\n             f()\n@@ -658,6 +666,11 @@ pub mod writer {\n         }\n \n         fn emit_rec(&self, f: fn()) { f() }\n+        #[cfg(stage0)]\n+        fn emit_struct(&self, _name: &str, f: fn()) { f() }\n+        #[cfg(stage1)]\n+        #[cfg(stage2)]\n+        #[cfg(stage3)]\n         fn emit_struct(&self, _name: &str, _len: uint, f: fn()) { f() }\n         fn emit_field(&self, name: &str, _idx: uint, f: fn()) {\n             self._emit_label(name);"}, {"sha": "83e98ac1ed1622e89b8fd59ebc159d7a5a18bac3", "filename": "src/libstd/json.rs", "status": "modified", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/f1d04780020fed9f6ade87ab39964f6c459aca33/src%2Flibstd%2Fjson.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f1d04780020fed9f6ade87ab39964f6c459aca33/src%2Flibstd%2Fjson.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fjson.rs?ref=f1d04780020fed9f6ade87ab39964f6c459aca33", "patch": "@@ -157,6 +157,15 @@ pub impl Encoder: serialize::Encoder {\n         f();\n         self.wr.write_char('}');\n     }\n+    #[cfg(stage0)]\n+    fn emit_struct(&self, _name: &str, f: fn()) {\n+        self.wr.write_char('{');\n+        f();\n+        self.wr.write_char('}');\n+    }\n+    #[cfg(stage1)]\n+    #[cfg(stage2)]\n+    #[cfg(stage3)]\n     fn emit_struct(&self, _name: &str, _len: uint, f: fn()) {\n         self.wr.write_char('{');\n         f();\n@@ -270,6 +279,13 @@ pub impl PrettyEncoder: serialize::Encoder {\n         self.indent -= 2;\n         self.wr.write_char('}');\n     }\n+    #[cfg(stage0)]\n+    fn emit_struct(&self, _name: &str, f: fn()) {\n+        self.emit_rec(f)\n+    }\n+    #[cfg(stage1)]\n+    #[cfg(stage2)]\n+    #[cfg(stage3)]\n     fn emit_struct(&self, _name: &str, _len: uint, f: fn()) {\n         self.emit_rec(f)\n     }\n@@ -870,6 +886,16 @@ pub impl Decoder: serialize::Decoder {\n         move value\n     }\n \n+    #[cfg(stage0)]\n+    fn read_struct<T>(&self, _name: &str, f: fn() -> T) -> T {\n+        debug!(\"read_struct()\");\n+        let value = f();\n+        self.pop();\n+        move value\n+    }\n+    #[cfg(stage1)]\n+    #[cfg(stage2)]\n+    #[cfg(stage3)]\n     fn read_struct<T>(&self, _name: &str, _len: uint, f: fn() -> T) -> T {\n         debug!(\"read_struct()\");\n         let value = f();"}, {"sha": "f122031a81a4e2e7dd19ea49dfdc4271c9c4b16c", "filename": "src/libstd/prettyprint.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/f1d04780020fed9f6ade87ab39964f6c459aca33/src%2Flibstd%2Fprettyprint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f1d04780020fed9f6ade87ab39964f6c459aca33/src%2Flibstd%2Fprettyprint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fprettyprint.rs?ref=f1d04780020fed9f6ade87ab39964f6c459aca33", "patch": "@@ -162,6 +162,15 @@ pub impl Serializer: serialize::Encoder {\n         self.wr.write_str(~\"}\");\n     }\n \n+    #[cfg(stage0)]\n+    fn emit_struct(&self, name: &str, f: fn()) {\n+        self.wr.write_str(fmt!(\"%s {\", name));\n+        f();\n+        self.wr.write_str(~\"}\");\n+    }\n+    #[cfg(stage1)]\n+    #[cfg(stage2)]\n+    #[cfg(stage3)]\n     fn emit_struct(&self, name: &str, _len: uint, f: fn()) {\n         self.wr.write_str(fmt!(\"%s {\", name));\n         f();"}, {"sha": "da9bba1020c8a44d6532f28b5394c17d469e2733", "filename": "src/libstd/serialize.rs", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/f1d04780020fed9f6ade87ab39964f6c459aca33/src%2Flibstd%2Fserialize.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f1d04780020fed9f6ade87ab39964f6c459aca33/src%2Flibstd%2Fserialize.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fserialize.rs?ref=f1d04780020fed9f6ade87ab39964f6c459aca33", "patch": "@@ -58,6 +58,11 @@ pub trait Encoder {\n     fn emit_vec_elt(&self, idx: uint, f: fn());\n \n     fn emit_rec(&self, f: fn());\n+    #[cfg(stage0)]\n+    fn emit_struct(&self, name: &str, f: fn());\n+    #[cfg(stage1)]\n+    #[cfg(stage2)]\n+    #[cfg(stage3)]\n     fn emit_struct(&self, name: &str, _len: uint, f: fn());\n     fn emit_field(&self, f_name: &str, f_idx: uint, f: fn());\n \n@@ -99,6 +104,11 @@ pub trait Decoder {\n     fn read_vec_elt<T>(&self, idx: uint, f: fn() -> T) -> T;\n \n     fn read_rec<T>(&self, f: fn() -> T) -> T;\n+    #[cfg(stage0)]\n+    fn read_struct<T>(&self, name: &str, f: fn() -> T) -> T;\n+    #[cfg(stage1)]\n+    #[cfg(stage2)]\n+    #[cfg(stage3)]\n     fn read_struct<T>(&self, name: &str, _len: uint, f: fn() -> T) -> T;\n     fn read_field<T>(&self, name: &str, idx: uint, f: fn() -> T) -> T;\n "}]}