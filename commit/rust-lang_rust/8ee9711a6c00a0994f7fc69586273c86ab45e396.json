{"sha": "8ee9711a6c00a0994f7fc69586273c86ab45e396", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhlZTk3MTFhNmMwMGEwOTk0ZjdmYzY5NTg2MjczYzg2YWI0NWUzOTY=", "commit": {"author": {"name": "Oliver Scherer", "email": "github35764891676564198441@oli-obk.de", "date": "2018-11-19T09:40:09Z"}, "committer": {"name": "Oliver Scherer", "email": "github35764891676564198441@oli-obk.de", "date": "2018-11-19T09:40:09Z"}, "message": "Replace the ICEing on const fn loops with an error", "tree": {"sha": "9d1a6b88eb6109e81bd79801427ba92e9412c727", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9d1a6b88eb6109e81bd79801427ba92e9412c727"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8ee9711a6c00a0994f7fc69586273c86ab45e396", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8ee9711a6c00a0994f7fc69586273c86ab45e396", "html_url": "https://github.com/rust-lang/rust/commit/8ee9711a6c00a0994f7fc69586273c86ab45e396", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8ee9711a6c00a0994f7fc69586273c86ab45e396/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7e82eda000c8d4abbdaa76b3563cd77f938fc411", "url": "https://api.github.com/repos/rust-lang/rust/commits/7e82eda000c8d4abbdaa76b3563cd77f938fc411", "html_url": "https://github.com/rust-lang/rust/commit/7e82eda000c8d4abbdaa76b3563cd77f938fc411"}], "stats": {"total": 21, "additions": 16, "deletions": 5}, "files": [{"sha": "958e5efe3ec74e9b3ffde0f33324917fdd1d38ff", "filename": "src/librustc_mir/transform/qualify_min_const_fn.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/8ee9711a6c00a0994f7fc69586273c86ab45e396/src%2Flibrustc_mir%2Ftransform%2Fqualify_min_const_fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8ee9711a6c00a0994f7fc69586273c86ab45e396/src%2Flibrustc_mir%2Ftransform%2Fqualify_min_const_fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Ftransform%2Fqualify_min_const_fn.rs?ref=8ee9711a6c00a0994f7fc69586273c86ab45e396", "patch": "@@ -365,10 +365,8 @@ fn check_terminator(\n             cleanup: _,\n         } => check_operand(tcx, mir, cond, span),\n \n-        | TerminatorKind::FalseUnwind { .. } => span_bug!(\n-            terminator.source_info.span,\n-            \"min_const_fn encountered `{:#?}`\",\n-            terminator\n-        ),\n+        TerminatorKind::FalseUnwind { .. } => {\n+            Err((span, \"loops are not allowed in const fn\".into()))\n+        },\n     }\n }"}, {"sha": "4278a8e2d0036b51271c3e5111895d148ab5af55", "filename": "src/test/ui/consts/min_const_fn/loop_ice.rs", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/8ee9711a6c00a0994f7fc69586273c86ab45e396/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Floop_ice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8ee9711a6c00a0994f7fc69586273c86ab45e396/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Floop_ice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Floop_ice.rs?ref=8ee9711a6c00a0994f7fc69586273c86ab45e396", "patch": "@@ -0,0 +1,5 @@\n+const fn foo() {\n+    loop {} //~ ERROR loops are not allowed in const fn\n+}\n+\n+fn main() {}"}, {"sha": "1424cea65afd55dd11ac835a708fbac534212c71", "filename": "src/test/ui/consts/min_const_fn/loop_ice.stderr", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/8ee9711a6c00a0994f7fc69586273c86ab45e396/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Floop_ice.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/8ee9711a6c00a0994f7fc69586273c86ab45e396/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Floop_ice.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Floop_ice.stderr?ref=8ee9711a6c00a0994f7fc69586273c86ab45e396", "patch": "@@ -0,0 +1,8 @@\n+error: loops are not allowed in const fn\n+  --> $DIR/loop_ice.rs:2:5\n+   |\n+LL |     loop {} //~ ERROR loops are not allowed in const fn\n+   |     ^^^^^^^\n+\n+error: aborting due to previous error\n+"}]}