{"sha": "1ceeb13e0ad12d044d7bcc0c4ca03c8414dd5ee9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFjZWViMTNlMGFkMTJkMDQ0ZDdiY2MwYzRjYTAzYzg0MTRkZDVlZTk=", "commit": {"author": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2020-01-31T13:42:44Z"}, "committer": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2020-02-12T08:34:27Z"}, "message": "Build Clippy before running integration tests", "tree": {"sha": "05a9eefc5b380b6b28a493dea943ce655c25b533", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/05a9eefc5b380b6b28a493dea943ce655c25b533"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1ceeb13e0ad12d044d7bcc0c4ca03c8414dd5ee9", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZxoS6lESXlRGMHWcaTCGhp1QZjcFAl5DuJMACgkQaTCGhp1Q\nZjfoIA//cc3DKX3WifzGb420X9j2rCuamhpqkbPm9tvwXiMbnsV30V1FFeWdxN7u\nMZpW4FB46MX0XRHDYXFmejcQF3GlDQpVQ3B9vt4fl33dlY6nWaiboL+p0JaWlVSR\nHCc3/FBAWR8yhH/XfrtLS0XP5yp1JGRNJc5E/GFwb4ZD/fP5rI6+HPjuCVhIGt7X\ntPcv2Av3mcCIiTZjLvr/kxIEz02bOsuPa/qLUeGK55x+pOlAweaPYqzCs0+zK0PD\nGxgPTwSsyZFF41T5HD0qnfb1DdQt83xfYHIGqsKRNJPisc3UEn5g0KrFQ9qYkw6H\n8RfbEwTgc22GzMjWxJxm05utO6xVlF4fRStvMq7LVTKEFYq11cGneZegn3os+jDS\nDeLdCTLLEOCA/eI/n3KbO3cIYCrOLYi4yjeSndNZrwmj2DxnBp3C6VJxAPkfj61F\nEhliVxPnExkkcwnZVrBp/SqZ5duvp3iCHkAQi93wqkBdz+IlJChBYKjYClF8nhmV\nLKzSENRccZI73wyMmODIuJEc2WaOB7kxw8Aatg7TWFEYqnuWf/+SsEYNp8+vXtIO\n8S/k1RRWRzsE68A1G2JJinfXh5/EoSDQ5fUcWdWTvXomQdnkSQyFjmFziRfZTSxU\nVOkz6fcNg0e1eTtgpfZONg6lcElqGIj+vPR6LGPq9IfPDIYdgjw=\n=Qiw9\n-----END PGP SIGNATURE-----", "payload": "tree 05a9eefc5b380b6b28a493dea943ce655c25b533\nparent ab43951d418301cf20f6ff97b8023b80730730c7\nauthor flip1995 <hello@philkrones.com> 1580478164 +0100\ncommitter flip1995 <hello@philkrones.com> 1581496467 +0100\n\nBuild Clippy before running integration tests\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1ceeb13e0ad12d044d7bcc0c4ca03c8414dd5ee9", "html_url": "https://github.com/rust-lang/rust/commit/1ceeb13e0ad12d044d7bcc0c4ca03c8414dd5ee9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1ceeb13e0ad12d044d7bcc0c4ca03c8414dd5ee9/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ab43951d418301cf20f6ff97b8023b80730730c7", "url": "https://api.github.com/repos/rust-lang/rust/commits/ab43951d418301cf20f6ff97b8023b80730730c7", "html_url": "https://github.com/rust-lang/rust/commit/ab43951d418301cf20f6ff97b8023b80730730c7"}], "stats": {"total": 56, "additions": 52, "deletions": 4}, "files": [{"sha": "e84e3baec625d114ed1dccefa3ef9910372b0579", "filename": ".github/workflows/clippy_bors.yml", "status": "modified", "additions": 52, "deletions": 4, "changes": 56, "blob_url": "https://github.com/rust-lang/rust/blob/1ceeb13e0ad12d044d7bcc0c4ca03c8414dd5ee9/.github%2Fworkflows%2Fclippy_bors.yml", "raw_url": "https://github.com/rust-lang/rust/raw/1ceeb13e0ad12d044d7bcc0c4ca03c8414dd5ee9/.github%2Fworkflows%2Fclippy_bors.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fclippy_bors.yml?ref=1ceeb13e0ad12d044d7bcc0c4ca03c8414dd5ee9", "patch": "@@ -149,8 +149,50 @@ jobs:\n         /usr/bin/find ~/.cargo/bin ! -type d -exec strip {} \\;\n         cargo cache --autoclean\n       shell: bash\n-  integration:\n+  integration_build:\n     needs: changelog\n+    runs-on: ubuntu-latest\n+\n+    steps:\n+    - uses: rust-lang/simpleinfra/github-actions/cancel-outdated-builds@master\n+      with:\n+        github_token: \"${{ secrets.github_token }}\"\n+    - name: rust-toolchain\n+      uses: actions-rs/toolchain@v1.0.3\n+      with:\n+        toolchain: nightly\n+        target: x86_64-unknown-linux-gnu\n+        profile: minimal\n+    - name: Cache cargo dir\n+      uses: actions/cache@v1\n+      with:\n+        path: ~/.cargo\n+        key: ${{ runner.os }}-x86_64-unknown-linux-gnu\n+    - name: Checkout\n+      uses: actions/checkout@v2.0.0\n+    - name: Master Toolchain Setup\n+      run: bash setup-toolchain.sh\n+\n+    - name: Build Integration Test\n+      run: cargo test --test integration --features integration --no-run\n+    - name: Extract Binaries\n+      run: |\n+        DIR=$CARGO_TARGET_DIR/debug\n+        find $DIR ! -executable -o -type d ! -path $DIR | xargs rm -rf\n+        mv $DIR/integration-* $DIR/integration\n+    - name: Upload Binaries\n+      uses: actions/upload-artifact@v1\n+      with:\n+        name: target\n+        path: target\n+\n+    - name: Run cargo-cache --autoclean\n+      run: |\n+        cargo install cargo-cache --debug\n+        find ~/.cargo/bin ! -type d -exec strip {} \\;\n+        cargo cache --autoclean\n+  integration:\n+    needs: integration_build\n     strategy:\n       fail-fast: false\n       max-parallel: 6\n@@ -194,12 +236,18 @@ jobs:\n     - name: Master Toolchain Setup\n       run: bash setup-toolchain.sh\n \n-    - name: Build\n-      run: cargo build --features integration\n+    - name: Download target dir\n+      uses: actions/download-artifact@v1\n+      with:\n+        name: target\n+        path: target\n+    - name: Make Binaries Executable\n+      run: chmod +x $CARGO_TARGET_DIR/debug/*\n     - name: Test ${{ matrix.integration }}\n-      run: cargo test --test integration --features integration\n+      run: $CARGO_TARGET_DIR/debug/integration\n       env:\n         INTEGRATION: ${{ matrix.integration }}\n+        RUSTUP_TOOLCHAIN: master\n \n     - name: Run cargo-cache --autoclean\n       run: |"}]}