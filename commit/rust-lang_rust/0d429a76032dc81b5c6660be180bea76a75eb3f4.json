{"sha": "0d429a76032dc81b5c6660be180bea76a75eb3f4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBkNDI5YTc2MDMyZGM4MWI1YzY2NjBiZTE4MGJlYTc2YTc1ZWIzZjQ=", "commit": {"author": {"name": "Tim Chevalier", "email": "chevalier@alum.wellesley.edu", "date": "2011-05-18T22:38:38Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-05-19T18:40:16Z"}, "message": "add a bunch more logging things", "tree": {"sha": "b67a52f3745cc969ee722b4446295e06180749e1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b67a52f3745cc969ee722b4446295e06180749e1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0d429a76032dc81b5c6660be180bea76a75eb3f4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0d429a76032dc81b5c6660be180bea76a75eb3f4", "html_url": "https://github.com/rust-lang/rust/commit/0d429a76032dc81b5c6660be180bea76a75eb3f4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0d429a76032dc81b5c6660be180bea76a75eb3f4/comments", "author": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "60399ed198ce5a86f386e8114e202937fbe670ed", "url": "https://api.github.com/repos/rust-lang/rust/commits/60399ed198ce5a86f386e8114e202937fbe670ed", "html_url": "https://github.com/rust-lang/rust/commit/60399ed198ce5a86f386e8114e202937fbe670ed"}], "stats": {"total": 35, "additions": 35, "deletions": 0}, "files": [{"sha": "8d62e27f5bc634d8107d7b154bcadb5c05572060", "filename": "src/comp/util/common.rs", "status": "modified", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/0d429a76032dc81b5c6660be180bea76a75eb3f4/src%2Fcomp%2Futil%2Fcommon.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0d429a76032dc81b5c6660be180bea76a75eb3f4/src%2Fcomp%2Futil%2Fcommon.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Futil%2Fcommon.rs?ref=0d429a76032dc81b5c6660be180bea76a75eb3f4", "patch": "@@ -4,6 +4,7 @@ import std::uint;\n import std::int;\n import std::vec;\n import std::option::none;\n+import std::option::some;\n import front::ast;\n import front::ast::ty;\n import front::ast::pat;\n@@ -16,6 +17,7 @@ import std::io::stdout;\n import std::io::str_writer;\n import std::io::string_writer;\n import pretty::pprust::print_block;\n+import pretty::pprust::print_item;\n import pretty::pprust::print_expr;\n import pretty::pprust::print_decl;\n import pretty::pprust::print_fn;\n@@ -171,6 +173,17 @@ fn block_to_str(&ast::block b) -> str {\n   ret s.get_str();\n }\n \n+fn item_to_str(&@ast::item i) -> str {\n+  let str_writer s = string_writer();\n+  auto out_ = mkstate(s.get_writer(), 80u);\n+  auto out = @rec(s=out_,\n+                  comments=none[vec[front::lexer::cmnt]],\n+                  mutable cur_cmnt=0u);\n+\n+  print_item(out, i);\n+  ret s.get_str();\n+}\n+\n fn log_block(&ast::block b) -> () {\n     log(block_to_str(b));\n }\n@@ -179,6 +192,21 @@ fn log_block_err(&ast::block b) -> () {\n     log_err(block_to_str(b));\n }\n \n+fn log_item_err(&@ast::item i) -> () {\n+    log_err(item_to_str(i));\n+}\n+\n+fn log_ann(&ast::ann a) -> () {\n+    alt (a) {\n+        case (ast::ann_none(_)) {\n+            log(\"ann_none\");\n+        }\n+        case (ast::ann_type(_,_,_,_)) {\n+            log(\"ann_type\");\n+        }\n+    }\n+}\n+\n fn fun_to_str(&ast::_fn f, str name, vec[ast::ty_param] params) -> str {\n  let str_writer s = string_writer();\n   auto out_ = mkstate(s.get_writer(), 80u);\n@@ -286,6 +314,13 @@ fn has_nonlocal_exits(&ast::block b) -> bool {\n     ret (has_exits.size() > 0u);\n }\n \n+fn local_rhs_span(&@ast::local l, &ast::span def) -> ast::span {\n+    alt (l.init) {\n+        case (some[ast::initializer](?i)) { ret i.expr.span; }\n+        case (_) { ret def; }\n+    }\n+}\n+\n //\n // Local Variables:\n // mode: rust"}]}