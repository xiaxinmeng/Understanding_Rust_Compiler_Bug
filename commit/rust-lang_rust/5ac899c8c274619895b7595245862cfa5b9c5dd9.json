{"sha": "5ac899c8c274619895b7595245862cfa5b9c5dd9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVhYzg5OWM4YzI3NDYxOTg5NWI3NTk1MjQ1ODYyY2ZhNWI5YzVkZDk=", "commit": {"author": {"name": "Nick Howell", "email": "howellnick@gmail.com", "date": "2015-09-25T01:59:43Z"}, "committer": {"name": "Nick Howell", "email": "howellnick@gmail.com", "date": "2015-09-25T01:59:43Z"}, "message": "Cleanup rustbook.js and add 'use strict'\n\nMostly indentation fixes, but a little refactoring, too.", "tree": {"sha": "28d51eeb76659acbba3d9ecd85fb490f5f3abc98", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/28d51eeb76659acbba3d9ecd85fb490f5f3abc98"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5ac899c8c274619895b7595245862cfa5b9c5dd9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5ac899c8c274619895b7595245862cfa5b9c5dd9", "html_url": "https://github.com/rust-lang/rust/commit/5ac899c8c274619895b7595245862cfa5b9c5dd9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5ac899c8c274619895b7595245862cfa5b9c5dd9/comments", "author": {"login": "nhowell", "id": 200475, "node_id": "MDQ6VXNlcjIwMDQ3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/200475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nhowell", "html_url": "https://github.com/nhowell", "followers_url": "https://api.github.com/users/nhowell/followers", "following_url": "https://api.github.com/users/nhowell/following{/other_user}", "gists_url": "https://api.github.com/users/nhowell/gists{/gist_id}", "starred_url": "https://api.github.com/users/nhowell/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nhowell/subscriptions", "organizations_url": "https://api.github.com/users/nhowell/orgs", "repos_url": "https://api.github.com/users/nhowell/repos", "events_url": "https://api.github.com/users/nhowell/events{/privacy}", "received_events_url": "https://api.github.com/users/nhowell/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nhowell", "id": 200475, "node_id": "MDQ6VXNlcjIwMDQ3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/200475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nhowell", "html_url": "https://github.com/nhowell", "followers_url": "https://api.github.com/users/nhowell/followers", "following_url": "https://api.github.com/users/nhowell/following{/other_user}", "gists_url": "https://api.github.com/users/nhowell/gists{/gist_id}", "starred_url": "https://api.github.com/users/nhowell/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nhowell/subscriptions", "organizations_url": "https://api.github.com/users/nhowell/orgs", "repos_url": "https://api.github.com/users/nhowell/repos", "events_url": "https://api.github.com/users/nhowell/events{/privacy}", "received_events_url": "https://api.github.com/users/nhowell/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f0666b45dd9adef751340e86badbef4daedb2dc2", "url": "https://api.github.com/repos/rust-lang/rust/commits/f0666b45dd9adef751340e86badbef4daedb2dc2", "html_url": "https://github.com/rust-lang/rust/commit/f0666b45dd9adef751340e86badbef4daedb2dc2"}], "stats": {"total": 113, "additions": 59, "deletions": 54}, "files": [{"sha": "d8ab15260edb47448d08f0290f1695979201ec29", "filename": "src/rustbook/static/rustbook.js", "status": "modified", "additions": 59, "deletions": 54, "changes": 113, "blob_url": "https://github.com/rust-lang/rust/blob/5ac899c8c274619895b7595245862cfa5b9c5dd9/src%2Frustbook%2Fstatic%2Frustbook.js", "raw_url": "https://github.com/rust-lang/rust/raw/5ac899c8c274619895b7595245862cfa5b9c5dd9/src%2Frustbook%2Fstatic%2Frustbook.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustbook%2Fstatic%2Frustbook.js?ref=5ac899c8c274619895b7595245862cfa5b9c5dd9", "patch": "@@ -1,4 +1,4 @@\n-// Copyright 2014 The Rust Project Developers. See the COPYRIGHT\n+// Copyright 2014-2015 The Rust Project Developers. See the COPYRIGHT\n // file at the top-level directory of this distribution and at\n // http://rust-lang.org/COPYRIGHT.\n //\n@@ -8,66 +8,71 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n+/*jslint browser: true, es5: true */\n+/*globals $: true, rootPath: true */\n \n-document.addEventListener(\"DOMContentLoaded\", function(event) {\n+document.addEventListener('DOMContentLoaded', function() {\n+    'use strict';\n \n-  document.getElementById(\"toggle-nav\").onclick = toggleNav;\n+    document.getElementById('toggle-nav').onclick = function(e) {\n+        var toc = document.getElementById('toc');\n+        var pagewrapper = document.getElementById('page-wrapper');\n+        toggleClass(toc, 'mobile-hidden');\n+        toggleClass(pagewrapper, 'mobile-hidden');\n+    };\n \n-  function toggleNav() {\n-    var toc = document.getElementById(\"toc\");\n-    var pagewrapper = document.getElementById(\"page-wrapper\");\n-    toggleClass(toc, \"mobile-hidden\");\n-    toggleClass(pagewrapper, \"mobile-hidden\");\n-  }\n+    function toggleClass(el, className) {\n+        // from http://youmightnotneedjquery.com/\n+        if (el.classList) {\n+            el.classList.toggle(className);\n+        } else {\n+            var classes = el.className.split(' ');\n+            var existingIndex = classes.indexOf(className);\n \n-  function toggleClass(el, className) {\n-     // from http://youmightnotneedjquery.com/\n-     if (el.classList) {\n-       el.classList.toggle(className);\n-     } else {\n-       var classes = el.className.split(' ');\n-       var existingIndex = classes.indexOf(className);\n+            if (existingIndex >= 0) {\n+                classes.splice(existingIndex, 1);\n+            } else {\n+                classes.push(className);\n+            }\n \n-       if (existingIndex >= 0) {\n-         classes.splice(existingIndex, 1);\n-       } else {\n-         classes.push(className);\n-       }\n-\n-       el.className = classes.join(' ');\n-     }\n-  }\n+            el.className = classes.join(' ');\n+        }\n+    }\n \n-  // The below code is used to add prev and next navigation links to the bottom\n-  // of each of the sections.\n-  // It works by extracting the current page based on the url and iterates over\n-  // the menu links until it finds the menu item for the current page. We then\n-  // create a copy of the preceding and following menu links and add the\n-  // correct css class and insert them into the bottom of the page.\n-  var toc = document.getElementById('toc').getElementsByTagName('a');\n-  var href = document.location.pathname.split('/').pop();\n-  if (href === 'index.html' || href === '') {\n-    href = 'README.html';\n-  }\n+    // The below code is used to add prev and next navigation links to the\n+    // bottom of each of the sections.\n+    // It works by extracting the current page based on the url and iterates\n+    // over the menu links until it finds the menu item for the current page. We\n+    // then create a copy of the preceding and following menu links and add the\n+    // correct css class and insert them into the bottom of the page.\n+    var toc = document.getElementById('toc').getElementsByTagName('a');\n+    var href = document.location.pathname.split('/').pop();\n \n-  for (var i = 0; i < toc.length; i++) {\n-    if (toc[i].attributes.href.value.split('/').pop() === href) {\n-      var nav = document.createElement('p');\n-      if (i > 0) {\n-        var prevNode = toc[i-1].cloneNode(true);\n-        prevNode.className = 'left';\n-        prevNode.setAttribute('rel', 'prev');\n-        nav.appendChild(prevNode);\n-      }\n-      if (i < toc.length - 1) {\n-        var nextNode = toc[i+1].cloneNode(true);\n-        nextNode.className = 'right';\n-        nextNode.setAttribute('rel', 'next');\n-        nav.appendChild(nextNode);\n-      }\n-      document.getElementById('page').appendChild(nav);\n-      break;\n+    if (href === 'index.html' || href === '') {\n+        href = 'README.html';\n     }\n-  }\n \n+    for (var i = 0; i < toc.length; i++) {\n+        if (toc[i].attributes.href.value.split('/').pop() === href) {\n+            var nav = document.createElement('p');\n+\n+            if (i > 0) {\n+                var prevNode = toc[i-1].cloneNode(true);\n+                prevNode.className = 'left';\n+                prevNode.setAttribute('rel', 'prev');\n+                nav.appendChild(prevNode);\n+            }\n+\n+            if (i < toc.length - 1) {\n+                var nextNode = toc[i+1].cloneNode(true);\n+                nextNode.className = 'right';\n+                nextNode.setAttribute('rel', 'next');\n+                nav.appendChild(nextNode);\n+            }\n+\n+            document.getElementById('page').appendChild(nav);\n+\n+            break;\n+        }\n+    }\n });"}]}