{"sha": "4018b0a495ee5d741958171dc98b2bb841a4b3aa", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQwMThiMGE0OTVlZTVkNzQxOTU4MTcxZGM5OGIyYmI4NDFhNGIzYWE=", "commit": {"author": {"name": "Oliver Schneider", "email": "oli-obk@users.noreply.github.com", "date": "2017-11-06T07:11:45Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-11-06T07:11:45Z"}, "message": "Merge pull request #2197 from AlexEne/dissalow-underscores-and-numbrers\n\nWarns if variable name is composed only of underscores and digits.", "tree": {"sha": "661aca622df7269908d1def96befa8bb497f2721", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/661aca622df7269908d1def96befa8bb497f2721"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4018b0a495ee5d741958171dc98b2bb841a4b3aa", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJaAAsxCRBK7hj4Ov3rIwAAdHIIAI2R51jxnNVll3vAjSQdUy/Z\npPfiyBnexAyCrpfVysotOQNOhWaQ4VweNvLLJ3KrIA1st6+58I1KZLFZAd7TZ2C1\nObTJSKE2PQdiD+SOjWHLDRfecD4qRY3xehnKKGFCrMPiD6MxmBj/uTP3pwaaLc95\n9rQ3FE5JrILmdy7LppZ+5v0e612tNx9QlVvcJs0Di4QhsXYwusroDYCPBSST2z9T\nDra82sPAwYmXfIc0YR6aK6jMz0T/47eslsYASWv9Y8pXw0lRp7is5eVdf2Zcw5Nv\nP2waSM2wFGVoywmaCibVUROWm4tBdeHaQzCF15nMPfk/4WJAJ9oHtF1O4M1WQaU=\n=CoSe\n-----END PGP SIGNATURE-----\n", "payload": "tree 661aca622df7269908d1def96befa8bb497f2721\nparent 0c43b60dd4870f92e0a3938ddbb9276fe6814b68\nparent f92c91601e1f28dd29be7157010673a2b5b6b87d\nauthor Oliver Schneider <oli-obk@users.noreply.github.com> 1509952305 +0100\ncommitter GitHub <noreply@github.com> 1509952305 +0100\n\nMerge pull request #2197 from AlexEne/dissalow-underscores-and-numbrers\n\nWarns if variable name is composed only of underscores and digits."}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4018b0a495ee5d741958171dc98b2bb841a4b3aa", "html_url": "https://github.com/rust-lang/rust/commit/4018b0a495ee5d741958171dc98b2bb841a4b3aa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4018b0a495ee5d741958171dc98b2bb841a4b3aa/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0c43b60dd4870f92e0a3938ddbb9276fe6814b68", "url": "https://api.github.com/repos/rust-lang/rust/commits/0c43b60dd4870f92e0a3938ddbb9276fe6814b68", "html_url": "https://github.com/rust-lang/rust/commit/0c43b60dd4870f92e0a3938ddbb9276fe6814b68"}, {"sha": "f92c91601e1f28dd29be7157010673a2b5b6b87d", "url": "https://api.github.com/repos/rust-lang/rust/commits/f92c91601e1f28dd29be7157010673a2b5b6b87d", "html_url": "https://github.com/rust-lang/rust/commit/f92c91601e1f28dd29be7157010673a2b5b6b87d"}], "stats": {"total": 58, "additions": 57, "deletions": 1}, "files": [{"sha": "408e6304a37d384c384654197020afa6dba530cc", "filename": "clippy_lints/src/non_expressive_names.rs", "status": "modified", "additions": 30, "deletions": 1, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/4018b0a495ee5d741958171dc98b2bb841a4b3aa/clippy_lints%2Fsrc%2Fnon_expressive_names.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4018b0a495ee5d741958171dc98b2bb841a4b3aa/clippy_lints%2Fsrc%2Fnon_expressive_names.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fnon_expressive_names.rs?ref=4018b0a495ee5d741958171dc98b2bb841a4b3aa", "patch": "@@ -42,13 +42,33 @@ declare_lint! {\n     \"too many single character bindings\"\n }\n \n+/// **What it does:** Checks if you have variables whose name consists of just\n+/// underscores and digits.\n+///\n+/// **Why is this bad?** It's hard to memorize what a variable means without a\n+/// descriptive name.\n+///\n+/// **Known problems:** None?\n+///\n+/// **Example:**\n+/// ```rust\n+/// let _1 = 1;\n+/// let ___1 = 1;\n+/// let __1___2 = 11;\n+/// ```\n+declare_lint! {\n+    pub JUST_UNDERSCORES_AND_DIGITS,\n+    Warn,\n+    \"unclear name\"\n+}\n+\n pub struct NonExpressiveNames {\n     pub single_char_binding_names_threshold: u64,\n }\n \n impl LintPass for NonExpressiveNames {\n     fn get_lints(&self) -> LintArray {\n-        lint_array!(SIMILAR_NAMES, MANY_SINGLE_CHAR_NAMES)\n+        lint_array!(SIMILAR_NAMES, MANY_SINGLE_CHAR_NAMES, JUST_UNDERSCORES_AND_DIGITS)\n     }\n }\n \n@@ -133,6 +153,15 @@ impl<'a, 'tcx, 'b> SimilarNamesNameVisitor<'a, 'tcx, 'b> {\n         if interned_name.chars().any(char::is_uppercase) {\n             return;\n         }\n+        if interned_name.chars().all(|c| c.is_digit(10) || c == '_') {\n+            span_lint(\n+                self.0.cx,\n+                JUST_UNDERSCORES_AND_DIGITS,\n+                span,\n+                \"consider choosing a more descriptive name\",\n+            );\n+            return;\n+        }\n         let count = interned_name.chars().count();\n         if count < 3 {\n             if count == 1 {"}, {"sha": "29a677004b8d2f181bf188b38c37830e0a3236a9", "filename": "tests/ui/non_expressive_names.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/4018b0a495ee5d741958171dc98b2bb841a4b3aa/tests%2Fui%2Fnon_expressive_names.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4018b0a495ee5d741958171dc98b2bb841a4b3aa/tests%2Fui%2Fnon_expressive_names.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fnon_expressive_names.rs?ref=4018b0a495ee5d741958171dc98b2bb841a4b3aa", "patch": "@@ -134,3 +134,10 @@ fn bla() {\n         }\n     }\n }\n+\n+fn underscores_and_numbers() {\n+    let _1 = 1; //~ERROR Consider a more descriptive name\n+    let ____1 = 1; //~ERROR Consider a more descriptive name\n+    let __1___2 = 12; //~ERROR Consider a more descriptive name\n+    let _1_ok= 1;\n+}"}, {"sha": "6412b47aab41722b13660f29656e832b2540cd65", "filename": "tests/ui/non_expressive_names.stderr", "status": "modified", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/4018b0a495ee5d741958171dc98b2bb841a4b3aa/tests%2Fui%2Fnon_expressive_names.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4018b0a495ee5d741958171dc98b2bb841a4b3aa/tests%2Fui%2Fnon_expressive_names.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fnon_expressive_names.stderr?ref=4018b0a495ee5d741958171dc98b2bb841a4b3aa", "patch": "@@ -129,3 +129,23 @@ error: 5th binding whose name is just one char\n 129 |             e => panic!(),\n     |             ^\n \n+error: consider choosing a more descriptive name\n+   --> $DIR/non_expressive_names.rs:139:9\n+    |\n+139 |     let _1 = 1; //~ERROR Consider a more descriptive name\n+    |         ^^\n+    |\n+    = note: `-D just-underscores-and-digits` implied by `-D warnings`\n+\n+error: consider choosing a more descriptive name\n+   --> $DIR/non_expressive_names.rs:140:9\n+    |\n+140 |     let ____1 = 1; //~ERROR Consider a more descriptive name\n+    |         ^^^^^\n+\n+error: consider choosing a more descriptive name\n+   --> $DIR/non_expressive_names.rs:141:9\n+    |\n+141 |     let __1___2 = 12; //~ERROR Consider a more descriptive name\n+    |         ^^^^^^^\n+"}]}