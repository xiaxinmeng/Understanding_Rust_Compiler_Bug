{"sha": "d890a70c39affeb9db3cfa9545905284a981114d", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ4OTBhNzBjMzlhZmZlYjlkYjNjZmE5NTQ1OTA1Mjg0YTk4MTExNGQ=", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2018-10-25T09:37:42Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2018-10-25T09:37:42Z"}, "message": "update for is_null removal", "tree": {"sha": "373896d8d876a97f232963f99f6d911b1b0129d9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/373896d8d876a97f232963f99f6d911b1b0129d9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d890a70c39affeb9db3cfa9545905284a981114d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d890a70c39affeb9db3cfa9545905284a981114d", "html_url": "https://github.com/rust-lang/rust/commit/d890a70c39affeb9db3cfa9545905284a981114d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d890a70c39affeb9db3cfa9545905284a981114d/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c02988b1c395ea827fe050415e4847288d8e998e", "url": "https://api.github.com/repos/rust-lang/rust/commits/c02988b1c395ea827fe050415e4847288d8e998e", "html_url": "https://github.com/rust-lang/rust/commit/c02988b1c395ea827fe050415e4847288d8e998e"}], "stats": {"total": 10, "additions": 5, "deletions": 5}, "files": [{"sha": "2d142ab20dc6199709f0bbe00c4504e939c8559b", "filename": "src/fn_call.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d890a70c39affeb9db3cfa9545905284a981114d/src%2Ffn_call.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d890a70c39affeb9db3cfa9545905284a981114d/src%2Ffn_call.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ffn_call.rs?ref=d890a70c39affeb9db3cfa9545905284a981114d", "patch": "@@ -132,7 +132,7 @@ impl<'a, 'mir, 'tcx: 'mir + 'a> EvalContextExt<'tcx, 'mir> for super::MiriEvalCo\n \n             \"free\" => {\n                 let ptr = self.read_scalar(args[0])?.not_undef()?.erase_tag(); // raw ptr operation, no tag\n-                if !ptr.is_null() {\n+                if !ptr.is_null_ptr(&self) {\n                     self.memory.deallocate(\n                         ptr.to_ptr()?.with_default_tag(),\n                         None,\n@@ -353,7 +353,7 @@ impl<'a, 'mir, 'tcx: 'mir + 'a> EvalContextExt<'tcx, 'mir> for super::MiriEvalCo\n                 let mut success = None;\n                 {\n                     let name_ptr = self.read_scalar(args[0])?.not_undef()?.erase_tag(); // raw ptr operation\n-                    if !name_ptr.is_null() {\n+                    if !name_ptr.is_null_ptr(&self) {\n                         let name = self.memory.read_c_str(name_ptr.to_ptr()?.with_default_tag())?;\n                         if !name.is_empty() && !name.contains(&b'=') {\n                             success = Some(self.machine.env_vars.remove(name));\n@@ -376,7 +376,7 @@ impl<'a, 'mir, 'tcx: 'mir + 'a> EvalContextExt<'tcx, 'mir> for super::MiriEvalCo\n                     let name_ptr = self.read_scalar(args[0])?.not_undef()?.erase_tag(); // raw ptr operation\n                     let value_ptr = self.read_scalar(args[1])?.to_ptr()?.erase_tag(); // raw ptr operation\n                     let value = self.memory.read_c_str(value_ptr.with_default_tag())?;\n-                    if !name_ptr.is_null() {\n+                    if !name_ptr.is_null_ptr(&self) {\n                         let name = self.memory.read_c_str(name_ptr.to_ptr()?.with_default_tag())?;\n                         if !name.is_empty() && !name.contains(&b'=') {\n                             new = Some((name.to_owned(), value.to_owned()));"}, {"sha": "dceeaf89aa5d3c4bcbd3d8fe3b98c98adf93ea58", "filename": "src/intrinsic.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d890a70c39affeb9db3cfa9545905284a981114d/src%2Fintrinsic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d890a70c39affeb9db3cfa9545905284a981114d/src%2Fintrinsic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fintrinsic.rs?ref=d890a70c39affeb9db3cfa9545905284a981114d", "patch": "@@ -231,7 +231,7 @@ impl<'a, 'mir, 'tcx> EvalContextExt<'tcx> for super::MiriEvalContext<'a, 'mir, '\n                 let a = self.read_value(args[0])?;\n                 let b = self.read_value(args[1])?;\n                 // check x % y != 0\n-                if !self.binary_op_val(mir::BinOp::Rem, a, b)?.0.is_null() {\n+                if self.binary_op_val(mir::BinOp::Rem, a, b)?.0.to_bytes()? != 0 {\n                     return err!(ValidationFailure(format!(\"exact_div: {:?} cannot be divided by {:?}\", a, b)));\n                 }\n                 self.binop_ignore_overflow(mir::BinOp::Div, a, b, dest)?;"}, {"sha": "b315e27c45d0a11a40b36c4244237d819436d541", "filename": "src/tls.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d890a70c39affeb9db3cfa9545905284a981114d/src%2Ftls.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d890a70c39affeb9db3cfa9545905284a981114d/src%2Ftls.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftls.rs?ref=d890a70c39affeb9db3cfa9545905284a981114d", "patch": "@@ -121,7 +121,7 @@ impl<'tcx> TlsData<'tcx> {\n         for (&key, &mut TlsEntry { ref mut data, dtor }) in\n             thread_local.range_mut((start, Unbounded))\n         {\n-            if !data.is_null() {\n+            if !data.is_null_ptr(cx) {\n                 if let Some(dtor) = dtor {\n                     let ret = Some((dtor, *data, key));\n                     *data = Scalar::ptr_null(cx);"}]}