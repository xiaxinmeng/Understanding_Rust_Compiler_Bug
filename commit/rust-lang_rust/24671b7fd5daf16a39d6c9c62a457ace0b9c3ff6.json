{"sha": "24671b7fd5daf16a39d6c9c62a457ace0b9c3ff6", "node_id": "C_kwDOAAsO6NoAKDI0NjcxYjdmZDVkYWYxNmEzOWQ2YzljNjJhNDU3YWNlMGI5YzNmZjY", "commit": {"author": {"name": "Ezra Shaw", "email": "ezrasure@outlook.com", "date": "2023-01-01T20:15:36Z"}, "committer": {"name": "Ezra Shaw", "email": "ezrasure@outlook.com", "date": "2023-01-01T20:15:36Z"}, "message": "use more paths in error codes", "tree": {"sha": "55d92ea15b4438c35558464b730d8e875ac8dafc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/55d92ea15b4438c35558464b730d8e875ac8dafc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/24671b7fd5daf16a39d6c9c62a457ace0b9c3ff6", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJJBAABCAAzFiEEYSWD6p+RIeSP1N2eF81cKtrg00QFAmOx6egVHGV6cmFzdXJl\nQG91dGxvb2suY29tAAoJEBfNXCra4NNEnG8P/0BSZWNWyUB+rH+hh9ctc65+/86Z\nu6E/9F6sAbQLHzz1EILw8V3+i2UtknJ6/I9NE4c4biwiZrx3ibc2pRH1WYaR+zyr\nnF4BtoaGwgEaYGt+evlOtjfdYSgv6tsQVqlqR5sISivg868ZUbvcvKzO6P8Ta3cr\n4n6azEUPa8swNkRV4QvycavsYSH4Taivh5tntu4ZdUXRMWG6ZvstmEqW+98zgH+L\nqxv27x2o7MmVxnJXO+qBFDBtgYtdMtNffCWHPlIAqYOD2xOHyV929x1/v6dkbUcS\nJU9uQQnL+tUtP9Ks7eIiEnPPcxIH+RM8daHmxB/LJKT2uk2eyKPjOMvJ6g8HZPoR\nyS3XNpfsGVUhyduCawAc06pMz5RpeJNb0XIg2lHMJff3sab+w+ACsL2DfXhk+abO\nPOkgSlQoLqnZyLjxbZM5jAw4Geb1aWwSzsQ4JXdINgmEpEtPWlrQeGx6d21cSPVR\nvz0xiadWC5dBzqcqWGwSNmspJRZPbrtsRN5/0VR20VOsC364LeIqU0M7yHJvhJv6\nWifc+ykJJn+XH2fURBDBYl2vY72PjobaP8PoPKK8FefADzb/lZvfKQThr0tk7V9b\nlqv+BsDgkza+RooBo4ObiiBQZVaQStvZxfTxBHiYqYGflu5YlcCbFOcK4wBSGTGa\ndemrgSme+0yaOdlX\n=St4X\n-----END PGP SIGNATURE-----", "payload": "tree 55d92ea15b4438c35558464b730d8e875ac8dafc\nparent 9618f646b314f934fe4ff92d6424255573c65a1c\nauthor Ezra Shaw <ezrasure@outlook.com> 1672604136 +1300\ncommitter Ezra Shaw <ezrasure@outlook.com> 1672604136 +1300\n\nuse more paths in error codes\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/24671b7fd5daf16a39d6c9c62a457ace0b9c3ff6", "html_url": "https://github.com/rust-lang/rust/commit/24671b7fd5daf16a39d6c9c62a457ace0b9c3ff6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/24671b7fd5daf16a39d6c9c62a457ace0b9c3ff6/comments", "author": {"login": "Ezrashaw", "id": 38062690, "node_id": "MDQ6VXNlcjM4MDYyNjkw", "avatar_url": "https://avatars.githubusercontent.com/u/38062690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ezrashaw", "html_url": "https://github.com/Ezrashaw", "followers_url": "https://api.github.com/users/Ezrashaw/followers", "following_url": "https://api.github.com/users/Ezrashaw/following{/other_user}", "gists_url": "https://api.github.com/users/Ezrashaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ezrashaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ezrashaw/subscriptions", "organizations_url": "https://api.github.com/users/Ezrashaw/orgs", "repos_url": "https://api.github.com/users/Ezrashaw/repos", "events_url": "https://api.github.com/users/Ezrashaw/events{/privacy}", "received_events_url": "https://api.github.com/users/Ezrashaw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Ezrashaw", "id": 38062690, "node_id": "MDQ6VXNlcjM4MDYyNjkw", "avatar_url": "https://avatars.githubusercontent.com/u/38062690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ezrashaw", "html_url": "https://github.com/Ezrashaw", "followers_url": "https://api.github.com/users/Ezrashaw/followers", "following_url": "https://api.github.com/users/Ezrashaw/following{/other_user}", "gists_url": "https://api.github.com/users/Ezrashaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ezrashaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ezrashaw/subscriptions", "organizations_url": "https://api.github.com/users/Ezrashaw/orgs", "repos_url": "https://api.github.com/users/Ezrashaw/repos", "events_url": "https://api.github.com/users/Ezrashaw/events{/privacy}", "received_events_url": "https://api.github.com/users/Ezrashaw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9618f646b314f934fe4ff92d6424255573c65a1c", "url": "https://api.github.com/repos/rust-lang/rust/commits/9618f646b314f934fe4ff92d6424255573c65a1c", "html_url": "https://github.com/rust-lang/rust/commit/9618f646b314f934fe4ff92d6424255573c65a1c"}], "stats": {"total": 12, "additions": 7, "deletions": 5}, "files": [{"sha": "026f7d87418a3c67dc5c28d5c2722707c27fb782", "filename": "src/tools/tidy/src/error_codes.rs", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/24671b7fd5daf16a39d6c9c62a457ace0b9c3ff6/src%2Ftools%2Ftidy%2Fsrc%2Ferror_codes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/24671b7fd5daf16a39d6c9c62a457ace0b9c3ff6/src%2Ftools%2Ftidy%2Fsrc%2Ferror_codes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Ftidy%2Fsrc%2Ferror_codes.rs?ref=24671b7fd5daf16a39d6c9c62a457ace0b9c3ff6", "patch": "@@ -61,8 +61,9 @@ pub fn check(root_path: &Path, search_paths: &[&Path], bad: &mut bool) {\n \n /// Stage 1: Parses a list of error codes from `error_codes.rs`.\n fn extract_error_codes(root_path: &Path, errors: &mut Vec<String>) -> Vec<String> {\n-    let file = fs::read_to_string(root_path.join(Path::new(ERROR_CODES_PATH)))\n-        .unwrap_or_else(|e| panic!(\"failed to read `error_codes.rs`: {e}\"));\n+    let path = root_path.join(Path::new(ERROR_CODES_PATH));\n+    let file =\n+        fs::read_to_string(&path).unwrap_or_else(|e| panic!(\"failed to read `{path:?}`: {e}\"));\n \n     let mut error_codes = Vec::new();\n     let mut reached_undocumented_codes = false;\n@@ -97,7 +98,8 @@ fn extract_error_codes(root_path: &Path, errors: &mut Vec<String>) -> Vec<String\n             let expected_filename = format!(\" include_str!(\\\"./error_codes/{}.md\\\"),\", err_code);\n             if expected_filename != split_line.unwrap().1 {\n                 errors.push(format!(\n-                    \"Error code `{}` expected to reference docs with `{}` but instead found `{}`\",\n+                    \"Error code `{}` expected to reference docs with `{}` but instead found `{}` in \\\n+                    `compiler/rustc_error_codes/src/error_codes.rs`\",\n                     err_code,\n                     expected_filename,\n                     split_line.unwrap().1,\n@@ -281,7 +283,7 @@ fn check_error_codes_tests(root_path: &Path, error_codes: &[String], errors: &mu\n         if IGNORE_UI_TEST_CHECK.contains(&code.as_str()) {\n             if test_path.exists() {\n                 errors.push(format!(\n-                    \"Error code `{code}` has a UI test, it shouldn't be listed in `EXEMPTED_FROM_TEST`!\"\n+                    \"Error code `{code}` has a UI test in `src/test/ui/error-codes/{code}.rs`, it shouldn't be listed in `EXEMPTED_FROM_TEST`!\"\n                 ));\n             }\n             continue;\n@@ -291,7 +293,7 @@ fn check_error_codes_tests(root_path: &Path, error_codes: &[String], errors: &mu\n             Ok(file) => file,\n             Err(err) => {\n                 println!(\n-                    \"WARNING: Failed to read UI test file for `{code}` but the file exists. The test is assumed to work:\\n{err}\"\n+                    \"WARNING: Failed to read UI test file (`{test_path}`) for `{code}` but the file exists. The test is assumed to work:\\n{err}\"\n                 );\n                 continue;\n             }"}]}