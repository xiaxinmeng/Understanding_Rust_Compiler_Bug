{"sha": "12aec073a8cd293bede167a7ef062044eb07299e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEyYWVjMDczYThjZDI5M2JlZGUxNjdhN2VmMDYyMDQ0ZWIwNzI5OWU=", "commit": {"author": {"name": "Anton Blanchard", "email": "anton@samba.org", "date": "2016-01-13T00:55:51Z"}, "committer": {"name": "Anton Blanchard", "email": "anton@samba.org", "date": "2016-01-13T01:39:01Z"}, "message": "Simplify some uses of cfg in test cases\n\nWhile adding PowerPC64 support it was noticed that some testcases should\njust use target_pointer_width, and others should select between\nx86 and !x86.", "tree": {"sha": "2dd16229c2eb96c6768d74bb5120301f7d150326", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2dd16229c2eb96c6768d74bb5120301f7d150326"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/12aec073a8cd293bede167a7ef062044eb07299e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/12aec073a8cd293bede167a7ef062044eb07299e", "html_url": "https://github.com/rust-lang/rust/commit/12aec073a8cd293bede167a7ef062044eb07299e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/12aec073a8cd293bede167a7ef062044eb07299e/comments", "author": {"login": "antonblanchard", "id": 2029971, "node_id": "MDQ6VXNlcjIwMjk5NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/2029971?v=4", "gravatar_id": "", "url": "https://api.github.com/users/antonblanchard", "html_url": "https://github.com/antonblanchard", "followers_url": "https://api.github.com/users/antonblanchard/followers", "following_url": "https://api.github.com/users/antonblanchard/following{/other_user}", "gists_url": "https://api.github.com/users/antonblanchard/gists{/gist_id}", "starred_url": "https://api.github.com/users/antonblanchard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/antonblanchard/subscriptions", "organizations_url": "https://api.github.com/users/antonblanchard/orgs", "repos_url": "https://api.github.com/users/antonblanchard/repos", "events_url": "https://api.github.com/users/antonblanchard/events{/privacy}", "received_events_url": "https://api.github.com/users/antonblanchard/received_events", "type": "User", "site_admin": false}, "committer": {"login": "antonblanchard", "id": 2029971, "node_id": "MDQ6VXNlcjIwMjk5NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/2029971?v=4", "gravatar_id": "", "url": "https://api.github.com/users/antonblanchard", "html_url": "https://github.com/antonblanchard", "followers_url": "https://api.github.com/users/antonblanchard/followers", "following_url": "https://api.github.com/users/antonblanchard/following{/other_user}", "gists_url": "https://api.github.com/users/antonblanchard/gists{/gist_id}", "starred_url": "https://api.github.com/users/antonblanchard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/antonblanchard/subscriptions", "organizations_url": "https://api.github.com/users/antonblanchard/orgs", "repos_url": "https://api.github.com/users/antonblanchard/repos", "events_url": "https://api.github.com/users/antonblanchard/events{/privacy}", "received_events_url": "https://api.github.com/users/antonblanchard/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7ff64b20f9a8d981154524242d9b582dbf9ff818", "url": "https://api.github.com/repos/rust-lang/rust/commits/7ff64b20f9a8d981154524242d9b582dbf9ff818", "html_url": "https://github.com/rust-lang/rust/commit/7ff64b20f9a8d981154524242d9b582dbf9ff818"}], "stats": {"total": 35, "additions": 9, "deletions": 26}, "files": [{"sha": "55a4226c6632da8685dd5c58fd556c6469e79834", "filename": "src/test/auxiliary/extern_calling_convention.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/12aec073a8cd293bede167a7ef062044eb07299e/src%2Ftest%2Fauxiliary%2Fextern_calling_convention.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12aec073a8cd293bede167a7ef062044eb07299e/src%2Ftest%2Fauxiliary%2Fextern_calling_convention.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fauxiliary%2Fextern_calling_convention.rs?ref=12aec073a8cd293bede167a7ef062044eb07299e", "patch": "@@ -24,8 +24,7 @@ pub extern \"win64\" fn foo(a: isize, b: isize, c: isize, d: isize) {\n }\n \n #[inline(never)]\n-#[cfg(any(target_arch = \"x86\", target_arch = \"arm\", target_arch = \"aarch64\",\n-          target_arch = \"powerpc64\", target_arch = \"powerpc64le\"))]\n+#[cfg(not(target_arch = \"x86_64\"))]\n pub extern fn foo(a: isize, b: isize, c: isize, d: isize) {\n     assert_eq!(a, 1);\n     assert_eq!(b, 2);"}, {"sha": "bb4b9cfecf7b62b609742d245f0a3d16d66dd854", "filename": "src/test/run-pass/bitwise.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/12aec073a8cd293bede167a7ef062044eb07299e/src%2Ftest%2Frun-pass%2Fbitwise.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12aec073a8cd293bede167a7ef062044eb07299e/src%2Ftest%2Frun-pass%2Fbitwise.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fbitwise.rs?ref=12aec073a8cd293bede167a7ef062044eb07299e", "patch": "@@ -8,13 +8,12 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-#[cfg(any(target_arch = \"x86\", target_arch = \"arm\"))]\n+#[cfg(any(target_pointer_width = \"32\"))]\n fn target() {\n     assert_eq!(-1000isize as usize >> 3_usize, 536870787_usize);\n }\n \n-#[cfg(any(target_arch = \"x86_64\", target_arch = \"aarch64\",\n-          target_arch = \"powerpc64\", target_arch = \"powerpc64le\"))]\n+#[cfg(any(target_pointer_width = \"64\"))]\n fn target() {\n     assert_eq!(-1000isize as usize >> 3_usize, 2305843009213693827_usize);\n }"}, {"sha": "a4720d48213ce43f527d0a369631d4d0b11d217a", "filename": "src/test/run-pass/intrinsic-alignment.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/12aec073a8cd293bede167a7ef062044eb07299e/src%2Ftest%2Frun-pass%2Fintrinsic-alignment.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12aec073a8cd293bede167a7ef062044eb07299e/src%2Ftest%2Frun-pass%2Fintrinsic-alignment.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fintrinsic-alignment.rs?ref=12aec073a8cd293bede167a7ef062044eb07299e", "patch": "@@ -35,9 +35,7 @@ mod m {\n     }\n \n     #[main]\n-    #[cfg(any(target_arch = \"x86_64\", target_arch = \"arm\",\n-              target_arch = \"aarch64\", target_arch = \"powerpc64\",\n-              target_arch = \"powerpc64le\"))]\n+    #[cfg(not(target_arch = \"x86\"))]\n     pub fn main() {\n         unsafe {\n             assert_eq!(::rusti::pref_align_of::<u64>(), 8);"}, {"sha": "5587f68bd18544465c2aa5c8fb8dd7929ed233f4", "filename": "src/test/run-pass/issue-2895.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/12aec073a8cd293bede167a7ef062044eb07299e/src%2Ftest%2Frun-pass%2Fissue-2895.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12aec073a8cd293bede167a7ef062044eb07299e/src%2Ftest%2Frun-pass%2Fissue-2895.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fissue-2895.rs?ref=12aec073a8cd293bede167a7ef062044eb07299e", "patch": "@@ -23,14 +23,13 @@ impl Drop for Kitty {\n     fn drop(&mut self) {}\n }\n \n-#[cfg(any(target_arch = \"x86_64\", target_arch=\"aarch64\",\n-          target_arch=\"powerpc64\", target_arch=\"powerpc64le\"))]\n+#[cfg(target_pointer_width = \"64\")]\n pub fn main() {\n     assert_eq!(mem::size_of::<Cat>(), 8 as usize);\n     assert_eq!(mem::size_of::<Kitty>(), 16 as usize);\n }\n \n-#[cfg(any(target_arch = \"x86\", target_arch = \"arm\"))]\n+#[cfg(target_pointer_width = \"32\")]\n pub fn main() {\n     assert_eq!(mem::size_of::<Cat>(), 4 as usize);\n     assert_eq!(mem::size_of::<Kitty>(), 8 as usize);"}, {"sha": "4a115c737da3a5752e82873a5c473475551dc274", "filename": "src/test/run-pass/rec-align-u32.rs", "status": "modified", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/12aec073a8cd293bede167a7ef062044eb07299e/src%2Ftest%2Frun-pass%2Frec-align-u32.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12aec073a8cd293bede167a7ef062044eb07299e/src%2Ftest%2Frun-pass%2Frec-align-u32.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Frec-align-u32.rs?ref=12aec073a8cd293bede167a7ef062044eb07299e", "patch": "@@ -35,15 +35,6 @@ struct Outer {\n     t: Inner\n }\n \n-\n-#[cfg(any(target_arch = \"x86\", target_arch = \"arm\", target_arch = \"aarch64\",\n-          target_arch = \"powerpc64\", target_arch = \"powerpc64le\"))]\n-mod m {\n-    pub fn align() -> usize { 4 }\n-    pub fn size() -> usize { 8 }\n-}\n-\n-#[cfg(target_arch = \"x86_64\")]\n mod m {\n     pub fn align() -> usize { 4 }\n     pub fn size() -> usize { 8 }"}, {"sha": "25cd77845ea03bf9ef8389ce4265614b549ecad6", "filename": "src/test/run-pass/rec-align-u64.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/12aec073a8cd293bede167a7ef062044eb07299e/src%2Ftest%2Frun-pass%2Frec-align-u64.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12aec073a8cd293bede167a7ef062044eb07299e/src%2Ftest%2Frun-pass%2Frec-align-u64.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Frec-align-u64.rs?ref=12aec073a8cd293bede167a7ef062044eb07299e", "patch": "@@ -49,9 +49,7 @@ mod m {\n         pub fn size() -> usize { 12 }\n     }\n \n-    #[cfg(any(target_arch = \"x86_64\", target_arch = \"arm\",\n-              target_arch = \"aarch64\", target_arch = \"powerpc64\",\n-              target_arch = \"powerpc64le\"))]\n+    #[cfg(not(target_arch = \"x86\"))]\n     pub mod m {\n         pub fn align() -> usize { 8 }\n         pub fn size() -> usize { 16 }"}, {"sha": "6f23263790cb777ff0c0f8e4c56122f85598a467", "filename": "src/test/run-pass/struct-return.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/12aec073a8cd293bede167a7ef062044eb07299e/src%2Ftest%2Frun-pass%2Fstruct-return.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12aec073a8cd293bede167a7ef062044eb07299e/src%2Ftest%2Frun-pass%2Fstruct-return.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fstruct-return.rs?ref=12aec073a8cd293bede167a7ef062044eb07299e", "patch": "@@ -43,8 +43,7 @@ fn test1() {\n     }\n }\n \n-#[cfg(any(target_arch = \"x86_64\", target_arch = \"aarch64\",\n-          target_arch = \"powerpc64\", target_arch = \"powerpc64le\"))]\n+#[cfg(target_pointer_width = \"64\")]\n fn test2() {\n     unsafe {\n         let f = Floats { a: 1.234567890e-15_f64,\n@@ -60,7 +59,7 @@ fn test2() {\n     }\n }\n \n-#[cfg(any(target_arch = \"x86\", target_arch = \"arm\"))]\n+#[cfg(target_pointer_width = \"32\")]\n fn test2() {\n }\n "}]}