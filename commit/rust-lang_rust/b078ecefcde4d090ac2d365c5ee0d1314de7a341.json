{"sha": "b078ecefcde4d090ac2d365c5ee0d1314de7a341", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIwNzhlY2VmY2RlNGQwOTBhYzJkMzY1YzVlZTBkMTMxNGRlN2EzNDE=", "commit": {"author": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2017-04-13T16:07:25Z"}, "committer": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2017-04-13T22:33:09Z"}, "message": "rewrite to pass a ref, not slice + index", "tree": {"sha": "7f5aa49a10dea3b1cd7f00e68b764c741ef67649", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7f5aa49a10dea3b1cd7f00e68b764c741ef67649"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b078ecefcde4d090ac2d365c5ee0d1314de7a341", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b078ecefcde4d090ac2d365c5ee0d1314de7a341", "html_url": "https://github.com/rust-lang/rust/commit/b078ecefcde4d090ac2d365c5ee0d1314de7a341", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b078ecefcde4d090ac2d365c5ee0d1314de7a341/comments", "author": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "15507bcb648964752db0d7fd37c4487780a7a5a4", "url": "https://api.github.com/repos/rust-lang/rust/commits/15507bcb648964752db0d7fd37c4487780a7a5a4", "html_url": "https://github.com/rust-lang/rust/commit/15507bcb648964752db0d7fd37c4487780a7a5a4"}], "stats": {"total": 13, "additions": 4, "deletions": 9}, "files": [{"sha": "99ffd789286b5411f54a2dfd335b3895d4073a4b", "filename": "src/librustc_trans/context.rs", "status": "modified", "additions": 4, "deletions": 9, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/b078ecefcde4d090ac2d365c5ee0d1314de7a341/src%2Flibrustc_trans%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b078ecefcde4d090ac2d365c5ee0d1314de7a341/src%2Flibrustc_trans%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fcontext.rs?ref=b078ecefcde4d090ac2d365c5ee0d1314de7a341", "patch": "@@ -266,10 +266,7 @@ impl<'a, 'tcx: 'a> CrateContextList<'a, 'tcx> {\n /// pass around (SharedCrateContext, LocalCrateContext) tuples all over trans.\n pub struct CrateContext<'a, 'tcx: 'a> {\n     shared: &'a SharedCrateContext<'a, 'tcx>,\n-    local_ccxs: &'a [LocalCrateContext<'tcx>],\n-    /// The index of `local` in `local_ccxs`.  This is used in\n-    /// `maybe_iter(true)` to identify the original `LocalCrateContext`.\n-    index: usize,\n+    local_ccx: &'a LocalCrateContext<'tcx>,\n }\n \n impl<'a, 'tcx> DepGraphSafe for CrateContext<'a, 'tcx> {\n@@ -298,8 +295,7 @@ impl<'a, 'tcx> Iterator for CrateContextIterator<'a,'tcx> {\n \n             let ccx = CrateContext {\n                 shared: self.shared,\n-                index: index,\n-                local_ccxs: self.local_ccxs,\n+                local_ccx: &self.local_ccxs[index],\n             };\n \n             if\n@@ -630,8 +626,7 @@ impl<'tcx> LocalCrateContext<'tcx> {\n         assert!(local_ccxs.len() == 1);\n         CrateContext {\n             shared: shared,\n-            index: 0,\n-            local_ccxs: local_ccxs\n+            local_ccx: &local_ccxs[0]\n         }\n     }\n }\n@@ -642,7 +637,7 @@ impl<'b, 'tcx> CrateContext<'b, 'tcx> {\n     }\n \n     fn local(&self) -> &'b LocalCrateContext<'tcx> {\n-        &self.local_ccxs[self.index]\n+        self.local_ccx\n     }\n \n     pub fn tcx<'a>(&'a self) -> TyCtxt<'a, 'tcx, 'tcx> {"}]}