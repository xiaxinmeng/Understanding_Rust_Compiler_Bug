{"sha": "7c855c940a5fdb5c942ddb3d3401c6e2dbbfca67", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdjODU1Yzk0MGE1ZmRiNWM5NDJkZGIzZDM0MDFjNmUyZGJiZmNhNjc=", "commit": {"author": {"name": "oxalica", "email": "oxalicc@pm.me", "date": "2021-03-15T16:58:42Z"}, "committer": {"name": "oxalica", "email": "oxalicc@pm.me", "date": "2021-03-15T17:05:56Z"}, "message": "Clean usage of ShortLabel", "tree": {"sha": "f017dd2e7df5bd14852917c2ed7bbbba2cbc5740", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f017dd2e7df5bd14852917c2ed7bbbba2cbc5740"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7c855c940a5fdb5c942ddb3d3401c6e2dbbfca67", "comment_count": 0, "verification": {"verified": false, "reason": "unknown_key", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEXLDp5dXVcfV/VA/qztOS3gxIPQAFAmBPk/gACgkQztOS3gxI\nPQC+1g//dekEu0ldum653fIPNfmx1U3srQja7kaVxArfSIb+LndF6ESM+icw9sJO\nMAO+qT6teaEJn2sxwjVyilvF4WThnpfXgAUH/9JK/Hj0JwXVu2hO1Q3wjnosEuRY\nXNMO4wuRl7EcfzqtL6DFeNMoK8HIFOay6+BdG78uOMfsmBWtQnRieEv+9vD41tmq\nJho7mnJ9O3mMI5lunlU32fpAZfyqBmZYmirv0gZ4Jpv/kfThyRuwNtOThPuuVM9A\negTx4/wRZUCGZmh9MwpzGPn5PT0nKy4enFLcKAiFgsLYXkmNQDINN1idcXdKHbIA\nQDOXkYvkczbsCAlKTXgx1IYS8Gcy7SE37Fw/l/7pk2ap4Uq4Jc5bJs6uK7yhHStx\nSvaAh5/jQi69Ch6vVLiWbOhLJVS0sUc9pW3ed9Qy2qdlKyr5crcxmWsURmq93AUg\nkAiU96hyZM8QAemIRoHHjiocTHA6iagKyTSxzCZZXmBzzWMVS945H8lKklKFHSj1\nd0ZUPJMsRuqRd4A+hZ3Hc1DxYW1Tm8gnjxcYsDOqXxTPJKWt18Sw3VeR1yth9Ya/\nGTD3wM3dxqwyciI0Q1+9eKcsRcSFgWpEjlHvQacFywVVKIwLhawxdrW2LKzfbd/+\nCKnPDaI4FFIERSnulMlsbjBDhe6nF/2KyQ8JI47XTR5d8uFfxCE=\n=yNfa\n-----END PGP SIGNATURE-----", "payload": "tree f017dd2e7df5bd14852917c2ed7bbbba2cbc5740\nparent 7101bada0f90eaf89718461affa583e1736f0099\nauthor oxalica <oxalicc@pm.me> 1615827522 +0800\ncommitter oxalica <oxalicc@pm.me> 1615827956 +0800\n\nClean usage of ShortLabel\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7c855c940a5fdb5c942ddb3d3401c6e2dbbfca67", "html_url": "https://github.com/rust-lang/rust/commit/7c855c940a5fdb5c942ddb3d3401c6e2dbbfca67", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7c855c940a5fdb5c942ddb3d3401c6e2dbbfca67/comments", "author": {"login": "oxalica", "id": 14816024, "node_id": "MDQ6VXNlcjE0ODE2MDI0", "avatar_url": "https://avatars.githubusercontent.com/u/14816024?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oxalica", "html_url": "https://github.com/oxalica", "followers_url": "https://api.github.com/users/oxalica/followers", "following_url": "https://api.github.com/users/oxalica/following{/other_user}", "gists_url": "https://api.github.com/users/oxalica/gists{/gist_id}", "starred_url": "https://api.github.com/users/oxalica/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oxalica/subscriptions", "organizations_url": "https://api.github.com/users/oxalica/orgs", "repos_url": "https://api.github.com/users/oxalica/repos", "events_url": "https://api.github.com/users/oxalica/events{/privacy}", "received_events_url": "https://api.github.com/users/oxalica/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oxalica", "id": 14816024, "node_id": "MDQ6VXNlcjE0ODE2MDI0", "avatar_url": "https://avatars.githubusercontent.com/u/14816024?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oxalica", "html_url": "https://github.com/oxalica", "followers_url": "https://api.github.com/users/oxalica/followers", "following_url": "https://api.github.com/users/oxalica/following{/other_user}", "gists_url": "https://api.github.com/users/oxalica/gists{/gist_id}", "starred_url": "https://api.github.com/users/oxalica/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oxalica/subscriptions", "organizations_url": "https://api.github.com/users/oxalica/orgs", "repos_url": "https://api.github.com/users/oxalica/repos", "events_url": "https://api.github.com/users/oxalica/events{/privacy}", "received_events_url": "https://api.github.com/users/oxalica/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7101bada0f90eaf89718461affa583e1736f0099", "url": "https://api.github.com/repos/rust-lang/rust/commits/7101bada0f90eaf89718461affa583e1736f0099", "html_url": "https://github.com/rust-lang/rust/commit/7101bada0f90eaf89718461affa583e1736f0099"}], "stats": {"total": 15, "additions": 8, "deletions": 7}, "files": [{"sha": "1f7b665c07896ba8be14e1347d15acbd6e771650", "filename": "crates/ide/src/display.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7c855c940a5fdb5c942ddb3d3401c6e2dbbfca67/crates%2Fide%2Fsrc%2Fdisplay.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7c855c940a5fdb5c942ddb3d3401c6e2dbbfca67/crates%2Fide%2Fsrc%2Fdisplay.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fdisplay.rs?ref=7c855c940a5fdb5c942ddb3d3401c6e2dbbfca67", "patch": "@@ -5,6 +5,5 @@ pub(crate) mod navigation_target;\n mod short_label;\n \n pub(crate) use navigation_target::{ToNav, TryToNav};\n-pub(crate) use short_label::ShortLabel;\n \n pub(crate) use syntax::display::{function_declaration, macro_label};"}, {"sha": "69c3751a1b7b0c3fcc130c6716118fd1ab9f4c9c", "filename": "crates/ide/src/display/navigation_target.rs", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/7c855c940a5fdb5c942ddb3d3401c6e2dbbfca67/crates%2Fide%2Fsrc%2Fdisplay%2Fnavigation_target.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7c855c940a5fdb5c942ddb3d3401c6e2dbbfca67/crates%2Fide%2Fsrc%2Fdisplay%2Fnavigation_target.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fdisplay%2Fnavigation_target.rs?ref=7c855c940a5fdb5c942ddb3d3401c6e2dbbfca67", "patch": "@@ -3,7 +3,9 @@\n use std::fmt;\n \n use either::Either;\n-use hir::{AssocItem, Documentation, FieldSource, HasAttrs, HasSource, InFile, ModuleSource};\n+use hir::{\n+    AssocItem, Documentation, FieldSource, HasAttrs, HasSource, HirDisplay, InFile, ModuleSource,\n+};\n use ide_db::{\n     base_db::{FileId, FileRange, SourceDatabase},\n     symbol_index::FileSymbolKind,\n@@ -98,7 +100,7 @@ impl NavigationTarget {\n                 SymbolKind::Module,\n             );\n             res.docs = module.attrs(db).docs();\n-            res.description = src.value.short_label();\n+            res.description = Some(module.display(db).to_string());\n             return res;\n         }\n         module.to_nav(db)\n@@ -251,8 +253,8 @@ impl ToNavFromAst for hir::Trait {\n \n impl<D> TryToNav for D\n where\n-    D: HasSource + ToNavFromAst + Copy + HasAttrs,\n-    D::Ast: ast::NameOwner + ShortLabel,\n+    D: HasSource + ToNavFromAst + Copy + HasAttrs + HirDisplay,\n+    D::Ast: ast::NameOwner,\n {\n     fn try_to_nav(&self, db: &RootDatabase) -> Option<NavigationTarget> {\n         let src = self.source(db)?;\n@@ -262,7 +264,7 @@ where\n             D::KIND,\n         );\n         res.docs = self.docs(db);\n-        res.description = src.value.short_label();\n+        res.description = Some(self.display(db).to_string());\n         Some(res)\n     }\n }\n@@ -317,7 +319,7 @@ impl TryToNav for hir::Field {\n                 let mut res =\n                     NavigationTarget::from_named(db, src.with_value(it), SymbolKind::Field);\n                 res.docs = self.docs(db);\n-                res.description = it.short_label();\n+                res.description = Some(self.display(db).to_string());\n                 res\n             }\n             FieldSource::Pos(it) => {"}]}