{"sha": "7e694e71153ebc8d3f2be9c20783bb283e38a59e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdlNjk0ZTcxMTUzZWJjOGQzZjJiZTljMjA3ODNiYjI4M2UzOGE1OWU=", "commit": {"author": {"name": "Keegan McAllister", "email": "kmcallister@mozilla.com", "date": "2014-06-24T17:29:08Z"}, "committer": {"name": "Keegan McAllister", "email": "kmcallister@mozilla.com", "date": "2014-06-24T18:36:28Z"}, "message": "More upstream lint changes", "tree": {"sha": "5c1f1efdc66935e86702633cd880a0afebc94acb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5c1f1efdc66935e86702633cd880a0afebc94acb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7e694e71153ebc8d3f2be9c20783bb283e38a59e", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7e694e71153ebc8d3f2be9c20783bb283e38a59e", "html_url": "https://github.com/rust-lang/rust/commit/7e694e71153ebc8d3f2be9c20783bb283e38a59e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7e694e71153ebc8d3f2be9c20783bb283e38a59e/comments", "author": {"login": "kmcallister", "id": 444997, "node_id": "MDQ6VXNlcjQ0NDk5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/444997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kmcallister", "html_url": "https://github.com/kmcallister", "followers_url": "https://api.github.com/users/kmcallister/followers", "following_url": "https://api.github.com/users/kmcallister/following{/other_user}", "gists_url": "https://api.github.com/users/kmcallister/gists{/gist_id}", "starred_url": "https://api.github.com/users/kmcallister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kmcallister/subscriptions", "organizations_url": "https://api.github.com/users/kmcallister/orgs", "repos_url": "https://api.github.com/users/kmcallister/repos", "events_url": "https://api.github.com/users/kmcallister/events{/privacy}", "received_events_url": "https://api.github.com/users/kmcallister/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kmcallister", "id": 444997, "node_id": "MDQ6VXNlcjQ0NDk5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/444997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kmcallister", "html_url": "https://github.com/kmcallister", "followers_url": "https://api.github.com/users/kmcallister/followers", "following_url": "https://api.github.com/users/kmcallister/following{/other_user}", "gists_url": "https://api.github.com/users/kmcallister/gists{/gist_id}", "starred_url": "https://api.github.com/users/kmcallister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kmcallister/subscriptions", "organizations_url": "https://api.github.com/users/kmcallister/orgs", "repos_url": "https://api.github.com/users/kmcallister/repos", "events_url": "https://api.github.com/users/kmcallister/events{/privacy}", "received_events_url": "https://api.github.com/users/kmcallister/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7dc724bf8868fbcc0adf02ab644a0175273845c6", "url": "https://api.github.com/repos/rust-lang/rust/commits/7dc724bf8868fbcc0adf02ab644a0175273845c6", "html_url": "https://github.com/rust-lang/rust/commit/7dc724bf8868fbcc0adf02ab644a0175273845c6"}], "stats": {"total": 34, "additions": 7, "deletions": 27}, "files": [{"sha": "5078ae80d75c1157f7d3da871d8535fa64ff4e7f", "filename": "src/librustc/lint/builtin.rs", "status": "modified", "additions": 6, "deletions": 26, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/7e694e71153ebc8d3f2be9c20783bb283e38a59e/src%2Flibrustc%2Flint%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7e694e71153ebc8d3f2be9c20783bb283e38a59e/src%2Flibrustc%2Flint%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Flint%2Fbuiltin.rs?ref=7e694e71153ebc8d3f2be9c20783bb283e38a59e", "patch": "@@ -1358,7 +1358,8 @@ impl LintPass for MissingDoc {\n declare_lint!(DEPRECATED, Warn,\n               \"detects use of #[deprecated] items\")\n \n-declare_lint!(EXPERIMENTAL, Warn,\n+// FIXME #6875: Change to Warn after std library stabilization is complete\n+declare_lint!(EXPERIMENTAL, Allow,\n               \"detects use of #[experimental] items\")\n \n declare_lint!(UNSTABLE, Allow,\n@@ -1411,32 +1412,11 @@ impl LintPass for Stability {\n             _ => return\n         };\n \n-        let stability = if ast_util::is_local(id) {\n-            // this crate\n-            let s = cx.tcx.map.with_attrs(id.node, |attrs| {\n-                attrs.map(|a| attr::find_stability(a.as_slice()))\n-            });\n-            match s {\n-                Some(s) => s,\n+        // stability attributes are promises made across crates; do not\n+        // check anything for crate-local usage.\n+        if ast_util::is_local(id) { return }\n \n-                // no possibility of having attributes\n-                // (e.g. it's a local variable), so just\n-                // ignore it.\n-                None => return\n-            }\n-        } else {\n-            // cross-crate\n-\n-            let mut s = None;\n-            // run through all the attributes and take the first\n-            // stability one.\n-            csearch::get_item_attrs(&cx.sess().cstore, id, |attrs| {\n-                if s.is_none() {\n-                    s = attr::find_stability(attrs.as_slice())\n-                }\n-            });\n-            s\n-        };\n+        let stability = cx.tcx.stability.borrow_mut().lookup(&cx.tcx.sess.cstore, id);\n \n         let (lint, label) = match stability {\n             // no stability attributes == Unstable"}, {"sha": "79fbd73c23d3cbdbcffeef0ed299fcc604440657", "filename": "src/librustc/lint/context.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7e694e71153ebc8d3f2be9c20783bb283e38a59e/src%2Flibrustc%2Flint%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7e694e71153ebc8d3f2be9c20783bb283e38a59e/src%2Flibrustc%2Flint%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Flint%2Fcontext.rs?ref=7e694e71153ebc8d3f2be9c20783bb283e38a59e", "patch": "@@ -411,7 +411,7 @@ impl<'a> Context<'a> {\n impl<'a> AstConv for Context<'a>{\n     fn tcx<'a>(&'a self) -> &'a ty::ctxt { self.tcx }\n \n-    fn get_item_ty(&self, id: ast::DefId) -> ty::ty_param_bounds_and_ty {\n+    fn get_item_ty(&self, id: ast::DefId) -> ty::Polytype {\n         ty::lookup_item_type(self.tcx, id)\n     }\n "}]}