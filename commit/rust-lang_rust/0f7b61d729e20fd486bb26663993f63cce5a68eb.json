{"sha": "0f7b61d729e20fd486bb26663993f63cce5a68eb", "node_id": "C_kwDOAAsO6NoAKDBmN2I2MWQ3MjllMjBmZDQ4NmJiMjY2NjM5OTNmNjNjY2U1YTY4ZWI", "commit": {"author": {"name": "Alex Macleod", "email": "alex@macleod.io", "date": "2023-05-05T11:45:24Z"}, "committer": {"name": "Alex Macleod", "email": "alex@macleod.io", "date": "2023-05-05T12:10:36Z"}, "message": "Inherit stdout/stderr for `cargo dev dogfood`", "tree": {"sha": "b9181930ef9b210ab0dcde93bbf424c221df84af", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b9181930ef9b210ab0dcde93bbf424c221df84af"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0f7b61d729e20fd486bb26663993f63cce5a68eb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0f7b61d729e20fd486bb26663993f63cce5a68eb", "html_url": "https://github.com/rust-lang/rust/commit/0f7b61d729e20fd486bb26663993f63cce5a68eb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0f7b61d729e20fd486bb26663993f63cce5a68eb/comments", "author": {"login": "Alexendoo", "id": 1830331, "node_id": "MDQ6VXNlcjE4MzAzMzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1830331?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Alexendoo", "html_url": "https://github.com/Alexendoo", "followers_url": "https://api.github.com/users/Alexendoo/followers", "following_url": "https://api.github.com/users/Alexendoo/following{/other_user}", "gists_url": "https://api.github.com/users/Alexendoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/Alexendoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Alexendoo/subscriptions", "organizations_url": "https://api.github.com/users/Alexendoo/orgs", "repos_url": "https://api.github.com/users/Alexendoo/repos", "events_url": "https://api.github.com/users/Alexendoo/events{/privacy}", "received_events_url": "https://api.github.com/users/Alexendoo/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Alexendoo", "id": 1830331, "node_id": "MDQ6VXNlcjE4MzAzMzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1830331?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Alexendoo", "html_url": "https://github.com/Alexendoo", "followers_url": "https://api.github.com/users/Alexendoo/followers", "following_url": "https://api.github.com/users/Alexendoo/following{/other_user}", "gists_url": "https://api.github.com/users/Alexendoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/Alexendoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Alexendoo/subscriptions", "organizations_url": "https://api.github.com/users/Alexendoo/orgs", "repos_url": "https://api.github.com/users/Alexendoo/repos", "events_url": "https://api.github.com/users/Alexendoo/events{/privacy}", "received_events_url": "https://api.github.com/users/Alexendoo/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f9c1d155b4c9cad224fe96aad486993dc123c9b6", "url": "https://api.github.com/repos/rust-lang/rust/commits/f9c1d155b4c9cad224fe96aad486993dc123c9b6", "html_url": "https://github.com/rust-lang/rust/commit/f9c1d155b4c9cad224fe96aad486993dc123c9b6"}], "stats": {"total": 38, "additions": 19, "deletions": 19}, "files": [{"sha": "a0d57f5ab483fc37737f0127ebde954e47f2f5d8", "filename": "clippy_dev/src/dogfood.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/0f7b61d729e20fd486bb26663993f63cce5a68eb/clippy_dev%2Fsrc%2Fdogfood.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0f7b61d729e20fd486bb26663993f63cce5a68eb/clippy_dev%2Fsrc%2Fdogfood.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Fdogfood.rs?ref=0f7b61d729e20fd486bb26663993f63cce5a68eb", "patch": "@@ -1,4 +1,4 @@\n-use crate::clippy_project_root;\n+use crate::{clippy_project_root, exit_if_err};\n use std::process::Command;\n \n /// # Panics\n@@ -10,7 +10,7 @@ pub fn dogfood(fix: bool, allow_dirty: bool, allow_staged: bool) {\n     cmd.current_dir(clippy_project_root())\n         .args([\"test\", \"--test\", \"dogfood\"])\n         .args([\"--features\", \"internal\"])\n-        .args([\"--\", \"dogfood_clippy\"]);\n+        .args([\"--\", \"dogfood_clippy\", \"--nocapture\"]);\n \n     let mut dogfood_args = Vec::new();\n     if fix {\n@@ -27,7 +27,5 @@ pub fn dogfood(fix: bool, allow_dirty: bool, allow_staged: bool) {\n \n     cmd.env(\"__CLIPPY_DOGFOOD_ARGS\", dogfood_args.join(\" \"));\n \n-    let output = cmd.output().expect(\"failed to run command\");\n-\n-    println!(\"{}\", String::from_utf8_lossy(&output.stdout));\n+    exit_if_err(cmd.status());\n }"}, {"sha": "56a269288c0536f030ca7f6fd99c386db4a9bcd4", "filename": "clippy_dev/src/lib.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/0f7b61d729e20fd486bb26663993f63cce5a68eb/clippy_dev%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0f7b61d729e20fd486bb26663993f63cce5a68eb/clippy_dev%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Flib.rs?ref=0f7b61d729e20fd486bb26663993f63cce5a68eb", "patch": "@@ -10,7 +10,9 @@\n extern crate rustc_driver;\n extern crate rustc_lexer;\n \n+use std::io;\n use std::path::PathBuf;\n+use std::process::{self, ExitStatus};\n \n pub mod bless;\n pub mod dogfood;\n@@ -58,3 +60,14 @@ pub fn clippy_project_root() -> PathBuf {\n     }\n     panic!(\"error: Can't determine root of project. Please run inside a Clippy working dir.\");\n }\n+\n+pub fn exit_if_err(status: io::Result<ExitStatus>) {\n+    match status.expect(\"failed to run command\").code() {\n+        Some(0) => {},\n+        Some(n) => process::exit(n),\n+        None => {\n+            eprintln!(\"Killed by signal\");\n+            process::exit(1);\n+        },\n+    }\n+}"}, {"sha": "a19be1bca6c3d8bf996ae6576b3f29e1a4ac57f9", "filename": "clippy_dev/src/lint.rs", "status": "modified", "additions": 3, "deletions": 14, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/0f7b61d729e20fd486bb26663993f63cce5a68eb/clippy_dev%2Fsrc%2Flint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0f7b61d729e20fd486bb26663993f63cce5a68eb/clippy_dev%2Fsrc%2Flint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Flint.rs?ref=0f7b61d729e20fd486bb26663993f63cce5a68eb", "patch": "@@ -1,17 +1,6 @@\n-use crate::cargo_clippy_path;\n-use std::process::{self, Command, ExitStatus};\n-use std::{fs, io};\n-\n-fn exit_if_err(status: io::Result<ExitStatus>) {\n-    match status.expect(\"failed to run command\").code() {\n-        Some(0) => {},\n-        Some(n) => process::exit(n),\n-        None => {\n-            eprintln!(\"Killed by signal\");\n-            process::exit(1);\n-        },\n-    }\n-}\n+use crate::{cargo_clippy_path, exit_if_err};\n+use std::fs;\n+use std::process::{self, Command};\n \n pub fn run<'a>(path: &str, args: impl Iterator<Item = &'a String>) {\n     let is_file = match fs::metadata(path) {"}]}