{"sha": "bd4907d534a1894e28a1f3cf672022e29eabf194", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJkNDkwN2Q1MzRhMTg5NGUyOGExZjNjZjY3MjAyMmUyOWVhYmYxOTQ=", "commit": {"author": {"name": "Sunjay Varma", "email": "varma.sunjay@gmail.com", "date": "2017-10-08T01:53:43Z"}, "committer": {"name": "Sunjay Varma", "email": "varma.sunjay@gmail.com", "date": "2017-10-18T03:05:45Z"}, "message": "Documenting the process for when rustfmt/rls breakk because of your changes", "tree": {"sha": "b5cc6070809c4efe48cbf489e3b1e26d74c07e61", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b5cc6070809c4efe48cbf489e3b1e26d74c07e61"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bd4907d534a1894e28a1f3cf672022e29eabf194", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bd4907d534a1894e28a1f3cf672022e29eabf194", "html_url": "https://github.com/rust-lang/rust/commit/bd4907d534a1894e28a1f3cf672022e29eabf194", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bd4907d534a1894e28a1f3cf672022e29eabf194/comments", "author": {"login": "sunjay", "id": 530939, "node_id": "MDQ6VXNlcjUzMDkzOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/530939?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sunjay", "html_url": "https://github.com/sunjay", "followers_url": "https://api.github.com/users/sunjay/followers", "following_url": "https://api.github.com/users/sunjay/following{/other_user}", "gists_url": "https://api.github.com/users/sunjay/gists{/gist_id}", "starred_url": "https://api.github.com/users/sunjay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sunjay/subscriptions", "organizations_url": "https://api.github.com/users/sunjay/orgs", "repos_url": "https://api.github.com/users/sunjay/repos", "events_url": "https://api.github.com/users/sunjay/events{/privacy}", "received_events_url": "https://api.github.com/users/sunjay/received_events", "type": "User", "site_admin": false}, "committer": {"login": "sunjay", "id": 530939, "node_id": "MDQ6VXNlcjUzMDkzOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/530939?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sunjay", "html_url": "https://github.com/sunjay", "followers_url": "https://api.github.com/users/sunjay/followers", "following_url": "https://api.github.com/users/sunjay/following{/other_user}", "gists_url": "https://api.github.com/users/sunjay/gists{/gist_id}", "starred_url": "https://api.github.com/users/sunjay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sunjay/subscriptions", "organizations_url": "https://api.github.com/users/sunjay/orgs", "repos_url": "https://api.github.com/users/sunjay/repos", "events_url": "https://api.github.com/users/sunjay/events{/privacy}", "received_events_url": "https://api.github.com/users/sunjay/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f6d7514545cbe83e771a400d04049b96dfb210cd", "url": "https://api.github.com/repos/rust-lang/rust/commits/f6d7514545cbe83e771a400d04049b96dfb210cd", "html_url": "https://github.com/rust-lang/rust/commit/f6d7514545cbe83e771a400d04049b96dfb210cd"}], "stats": {"total": 38, "additions": 38, "deletions": 0}, "files": [{"sha": "c6c62a8c7b48a586a54de3854da129415f331835", "filename": "CONTRIBUTING.md", "status": "modified", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/bd4907d534a1894e28a1f3cf672022e29eabf194/CONTRIBUTING.md", "raw_url": "https://github.com/rust-lang/rust/raw/bd4907d534a1894e28a1f3cf672022e29eabf194/CONTRIBUTING.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/CONTRIBUTING.md?ref=bd4907d534a1894e28a1f3cf672022e29eabf194", "patch": "@@ -363,6 +363,44 @@ outside the submodule.\n It can also be more convenient during development to set `submodules = false`\n in the `config.toml` to prevent `x.py` from resetting to the original branch.\n \n+#### Breaking rustfmt or rls\n+\n+Rust's build system also builds the\n+[RLS](https://github.com/rust-lang-nursery/rls)\n+and [rustfmt](https://github.com/rust-lang-nursery/rustfmt). If these tools\n+break because of your changes, you may run into a sort of \"chicken and egg\"\n+problem. Both tools rely on the latest compiler to be built so you can't update\n+them until the changes you are making to the compiler land. In the meantime, you\n+can't land your changes to the compiler because the build won't pass until those\n+tools are fixed.\n+\n+That means that, in the default state, you can't update the compiler without\n+fixing rustfmt and rls first.\n+\n+When this happens, follow these steps:\n+\n+1. First, if it doesn't exist already, create a `config.toml` by copying\n+   `config.toml.example` in the root directory of the Rust repository.\n+   Set `submodules = false` in the `[build]` section. This will prevent `x.py`\n+   from resetting to the original branch after you make your changes.\n+2. Run `./x.py test src/tools/rustfmt`. Fix any errors in the submodule itself\n+   (the `src/tools/rustfmt` directory) until it works.\n+3. Run `./x.py test src/tools/rls`. Fix any errors in the submodule itself\n+   (the `src/tools/rls` directory) until it works.\n+4. Make a commit for `rustfmt`, if necessary, and send a PR to the master\n+   branch of rust-lang-nursery/rustfmt\n+5. Do the same, if necessary for the RLS\n+6. A maintainer of rls/rustfmt will **not** merge the PR. The PR can't be\n+   merged because CI will be broken. Instead a new branch will be created,\n+   and the PR will be pushed to the branch (the PR is left open)\n+7. On your branch, update the rls/rustfmt submodules to these branches\n+8. Commit the changes, update your PR to rust-lang/rust\n+9. Wait for the branch to merge\n+10. Wait for a nightly\n+11. A maintainer of rls/rustfmt will merge the original PRs to rls/rustfmt\n+12. Eventually the rls/rustfmt submodules will get re-updated back to the\n+    master branch\n+\n ## Writing Documentation\n [writing-documentation]: #writing-documentation\n "}]}