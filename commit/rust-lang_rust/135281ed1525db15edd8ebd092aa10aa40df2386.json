{"sha": "135281ed1525db15edd8ebd092aa10aa40df2386", "node_id": "C_kwDOAAsO6NoAKDEzNTI4MWVkMTUyNWRiMTVlZGQ4ZWJkMDkyYWExMGFhNDBkZjIzODY", "commit": {"author": {"name": "cynecx", "email": "me@cynecx.net", "date": "2021-09-30T02:23:02Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2021-11-29T10:07:16Z"}, "message": "rustdoc: use flexbox to layout sidebar and main content", "tree": {"sha": "a8841115a179457002bbc977f061a6be53392fe6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a8841115a179457002bbc977f061a6be53392fe6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/135281ed1525db15edd8ebd092aa10aa40df2386", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/135281ed1525db15edd8ebd092aa10aa40df2386", "html_url": "https://github.com/rust-lang/rust/commit/135281ed1525db15edd8ebd092aa10aa40df2386", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/135281ed1525db15edd8ebd092aa10aa40df2386/comments", "author": {"login": "cynecx", "id": 5961244, "node_id": "MDQ6VXNlcjU5NjEyNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5961244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cynecx", "html_url": "https://github.com/cynecx", "followers_url": "https://api.github.com/users/cynecx/followers", "following_url": "https://api.github.com/users/cynecx/following{/other_user}", "gists_url": "https://api.github.com/users/cynecx/gists{/gist_id}", "starred_url": "https://api.github.com/users/cynecx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cynecx/subscriptions", "organizations_url": "https://api.github.com/users/cynecx/orgs", "repos_url": "https://api.github.com/users/cynecx/repos", "events_url": "https://api.github.com/users/cynecx/events{/privacy}", "received_events_url": "https://api.github.com/users/cynecx/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9981e56d3b820f429fac62b4ff916f2a871340b4", "url": "https://api.github.com/repos/rust-lang/rust/commits/9981e56d3b820f429fac62b4ff916f2a871340b4", "html_url": "https://github.com/rust-lang/rust/commit/9981e56d3b820f429fac62b4ff916f2a871340b4"}], "stats": {"total": 161, "additions": 80, "deletions": 81}, "files": [{"sha": "6135038a4044de0c835c57209b5fbf62d9973326", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 43, "deletions": 48, "changes": 91, "blob_url": "https://github.com/rust-lang/rust/blob/135281ed1525db15edd8ebd092aa10aa40df2386/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/135281ed1525db15edd8ebd092aa10aa40df2386/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=135281ed1525db15edd8ebd092aa10aa40df2386", "patch": "@@ -111,7 +111,6 @@ body {\n \tfont: 16px/1.4 \"Source Serif 4\", NanumBarunGothic, serif;\n \tmargin: 0;\n \tposition: relative;\n-\tpadding: 10px 15px 20px 15px;\n \n \t-webkit-font-feature-settings: \"kern\", \"liga\";\n \t-moz-font-feature-settings: \"kern\", \"liga\";\n@@ -248,6 +247,25 @@ textarea {\n \n /* end tweaks for normalize.css 8 */\n \n+.rustdoc {\n+\tdisplay: flex;\n+\tflex-direction: row;\n+\tflex-wrap: nowrap;\n+}\n+\n+main {\n+\tposition: relative;\n+\tflex-grow: 1;\n+\tpadding: 10px 15px 40px 45px;\n+\theight: 100vh;\n+\toverflow-y: auto;\n+}\n+\n+.main-inner {\n+\tmax-width: 960px;\n+\tmargin-right: auto;\n+}\n+\n details:not(.rustdoc-toggle) summary {\n \tmargin-bottom: .6em;\n }\n@@ -298,15 +316,13 @@ nav.sub {\n \n .sidebar {\n \twidth: 200px;\n-\tposition: fixed;\n-\tleft: 0;\n-\ttop: 0;\n-\tbottom: 0;\n \toverflow-y: scroll;\n }\n \n .rustdoc.source .sidebar {\n \toverflow-y: auto;\n+\tmin-width: 200px;\n+\theight: 100vh;\n }\n \n /* Improve the scrollbar display on firefox */\n@@ -332,10 +348,6 @@ nav.sub {\n \tmargin-right: -10px;\n }\n \n-.content, nav {\n-\tmax-width: 960px;\n-}\n-\n /* Everything else */\n \n .hidden {\n@@ -439,10 +451,6 @@ nav.sub {\n \tdisplay: none;\n }\n \n-.content {\n-\tpadding: 15px 0;\n-}\n-\n .source .content pre.rust {\n \twhite-space: pre;\n \toverflow: auto;\n@@ -487,7 +495,6 @@ nav.sub {\n }\n \n #search {\n-\tmargin-left: 230px;\n \tposition: relative;\n }\n \n@@ -707,7 +714,7 @@ nav.sub {\n nav:not(.sidebar) {\n \tborder-bottom: 1px solid;\n \tpadding-bottom: 10px;\n-\tmargin-bottom: 10px;\n+\tmargin-bottom: 25px;\n }\n nav.main {\n \tpadding: 20px 0;\n@@ -726,10 +733,6 @@ nav.main .separator {\n nav.sum { text-align: right; }\n nav.sub form { display: inline; }\n \n-nav.sub, .content {\n-\tmargin-left: 230px;\n-}\n-\n a {\n \ttext-decoration: none;\n \tbackground: transparent;\n@@ -1354,7 +1357,7 @@ pre.rust {\n \n .theme-picker {\n \tposition: absolute;\n-\tleft: 211px;\n+\tleft: 11px;\n \ttop: 19px;\n }\n \n@@ -1653,11 +1656,23 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n \t\tpadding-top: 0px;\n \t}\n \n+\tmain {\n+\t\theight: auto;\n+\t\tpadding-left: 15px;\n+\t\tpadding-top: 0px;\n+\t\toverflow-y: visible;\n+\t}\n+\n+\t.rustdoc {\n+\t\tflex-direction: column;\n+\t}\n+\n \t.rustdoc > .sidebar {\n+\t\twidth: 100%;\n \t\theight: 45px;\n \t\tmin-height: 40px;\n+\t\tmax-height: 45px;\n \t\tmargin: 0;\n-\t\tmargin-left: -15px;\n \t\tpadding: 0 15px;\n \t\tposition: static;\n \t\tz-index: 11;\n@@ -1748,20 +1763,17 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n \n \tnav.sub {\n \t\twidth: calc(100% - 32px);\n-\t\tfloat: right;\n+\t\tmargin-left: 32px;\n+\t\tmargin-bottom: 10px;\n \t}\n \n \t.content {\n \t\tmargin-left: 0px;\n \t}\n \n-\t#main, #search {\n-\t\tmargin-top: 45px;\n-\t\tpadding: 0;\n-\t}\n-\n \t#search {\n \t\tmargin-left: 0;\n+\t\tpadding: 0;\n \t}\n \n \t.anchor {\n@@ -1770,7 +1782,7 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n \n \t.theme-picker {\n \t\tleft: 10px;\n-\t\ttop: 54px;\n+\t\ttop: 9px;\n \t\tz-index: 1;\n \t}\n \n@@ -1790,22 +1802,12 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n \t}\n \n \t.sidebar.mobile {\n-\t\tposition: fixed;\n+\t\tposition: sticky;\n+\t\ttop: 0;\n+\t\tleft: 0;\n \t\twidth: 100%;\n \t\tmargin-left: 0;\n \t\tbackground-color: rgba(0,0,0,0);\n-\t\theight: 100%;\n-\t}\n-\t/*\n-\tThis allows to prevent the version text to overflow the sidebar title on mobile mode when the\n-\tsidebar is displayed (after clicking on the \"hamburger\" button).\n-\t*/\n-\t.sidebar.mobile > div.version {\n-\t\toverflow: hidden;\n-\t\tmax-height: 33px;\n-\t}\n-\t.sidebar {\n-\t\twidth: calc(100% + 30px);\n \t}\n \n \t.show-it, .sidebar-elems:focus-within {\n@@ -1920,13 +1922,6 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n \t\theight: 73px;\n \t}\n \n-\t/* This is to prevent the search bar from being underneath the <section>\n-\t * element following it.\n-\t */\n-\t#main, #search {\n-\t\tmargin-top: 100px;\n-\t}\n-\n \t#main > table:not(.table-display) td {\n \t\tword-break: break-word;\n \t\twidth: 50%;"}, {"sha": "abf6126599b2cf82b1ddbf4d45a2dbe1a6cb0597", "filename": "src/librustdoc/html/static/js/main.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/135281ed1525db15edd8ebd092aa10aa40df2386/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/135281ed1525db15edd8ebd092aa10aa40df2386/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js?ref=135281ed1525db15edd8ebd092aa10aa40df2386", "patch": "@@ -1001,7 +1001,7 @@ function hideThemeButtonState() {\n         container.appendChild(rustdoc_version);\n \n         popup.appendChild(container);\n-        insertAfter(popup, searchState.outputElement());\n+        insertAfter(popup, document.querySelector(\"main\"));\n         // So that it's only built once and then it'll do nothing when called!\n         buildHelperPopup = function() {};\n     };"}, {"sha": "fb4133eca4c41e7742cd5ca274c7659f20c476b9", "filename": "src/librustdoc/html/templates/page.html", "status": "modified", "additions": 36, "deletions": 32, "changes": 68, "blob_url": "https://github.com/rust-lang/rust/blob/135281ed1525db15edd8ebd092aa10aa40df2386/src%2Flibrustdoc%2Fhtml%2Ftemplates%2Fpage.html", "raw_url": "https://github.com/rust-lang/rust/raw/135281ed1525db15edd8ebd092aa10aa40df2386/src%2Flibrustdoc%2Fhtml%2Ftemplates%2Fpage.html", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Ftemplates%2Fpage.html?ref=135281ed1525db15edd8ebd092aa10aa40df2386", "patch": "@@ -81,39 +81,43 @@\n         </a> {#- -#}\n         {{- sidebar | safe -}}\n     </nav> {#- -#}\n-    <div class=\"theme-picker\"> {#- -#}\n-        <button id=\"theme-picker\" aria-label=\"Pick another theme!\" aria-haspopup=\"menu\" title=\"themes\"> {#- -#}\n-            <img width=\"18\" height=\"18\" alt=\"Pick another theme!\" {# -#}\n-             src=\"{{static_root_path | safe}}brush{{page.resource_suffix}}.svg\"> {#- -#}\n-        </button> {#- -#}\n-        <div id=\"theme-choices\" role=\"menu\"></div> {#- -#}\n-    </div> {#- -#}\n-    <nav class=\"sub\"> {#- -#}\n-        <form class=\"search-form\"> {#- -#}\n-            <div class=\"search-container\"> {#- -#}\n-                <div>{%- if layout.generate_search_filter -%}\n-                    <select id=\"crate-search\"> {#- -#}\n-                        <option value=\"All crates\">All crates</option> {#- -#}\n-                    </select> {#- -#}\n-                    {%- endif -%}\n-                    <input {# -#}\n-                        class=\"search-input\" {# -#}\n-                        name=\"search\" {# -#}\n-                        autocomplete=\"off\" {# -#}\n-                        spellcheck=\"false\" {# -#}\n-                        placeholder=\"Click or press \u2018S\u2019 to search, \u2018?\u2019 for more options\u2026\" {# -#}\n-                        type=\"search\"> {#- -#}\n-                </div> {#- -#}\n-                <button type=\"button\" id=\"help-button\" title=\"help\">?</button> {#- -#}\n-                <a id=\"settings-menu\" href=\"{{page.root_path | safe}}settings.html\" title=\"settings\"> {#- -#}\n-                    <img width=\"18\" height=\"18\" alt=\"Change settings\" {# -#}\n-                         src=\"{{static_root_path | safe}}wheel{{page.resource_suffix}}.svg\"> {#- -#}\n-                </a> {#- -#}\n+    <main> {#- -#}\n+        <div class=\"main-inner\"> {#- -#}\n+            <div class=\"theme-picker\"> {#- -#}\n+                <button id=\"theme-picker\" aria-label=\"Pick another theme!\" aria-haspopup=\"menu\" title=\"themes\"> {#- -#}\n+                    <img width=\"18\" height=\"18\" alt=\"Pick another theme!\" {# -#}\n+                     src=\"{{static_root_path | safe}}brush{{page.resource_suffix}}.svg\"> {#- -#}\n+                </button> {#- -#}\n+                <div id=\"theme-choices\" role=\"menu\"></div> {#- -#}\n             </div> {#- -#}\n-        </form> {#- -#}\n-    </nav> {#- -#}\n-    <section id=\"main\" class=\"content\">{{- content | safe -}}</section> {#- -#}\n-    <section id=\"search\" class=\"content hidden\"></section> {#- -#}\n+            <nav class=\"sub\"> {#- -#}\n+                <form class=\"search-form\"> {#- -#}\n+                    <div class=\"search-container\"> {#- -#}\n+                        <div>{%- if layout.generate_search_filter -%}\n+                            <select id=\"crate-search\"> {#- -#}\n+                                <option value=\"All crates\">All crates</option> {#- -#}\n+                            </select> {#- -#}\n+                            {%- endif -%}\n+                            <input {# -#}\n+                                class=\"search-input\" {# -#}\n+                                name=\"search\" {# -#}\n+                                autocomplete=\"off\" {# -#}\n+                                spellcheck=\"false\" {# -#}\n+                                placeholder=\"Click or press \u2018S\u2019 to search, \u2018?\u2019 for more options\u2026\" {# -#}\n+                                type=\"search\"> {#- -#}\n+                        </div> {#- -#}\n+                        <button type=\"button\" id=\"help-button\" title=\"help\">?</button> {#- -#}\n+                        <a id=\"settings-menu\" href=\"{{page.root_path | safe}}settings.html\" title=\"settings\"> {#- -#}\n+                            <img width=\"18\" height=\"18\" alt=\"Change settings\" {# -#}\n+                                 src=\"{{static_root_path | safe}}wheel{{page.resource_suffix}}.svg\"> {#- -#}\n+                        </a> {#- -#}\n+                    </div> {#- -#}\n+                </form> {#- -#}\n+            </nav> {#- -#}\n+            <section id=\"main\" class=\"content\">{{- content | safe -}}</section> {#- -#}\n+            <section id=\"search\" class=\"content hidden\"></section> {#- -#}\n+        </div> {#- -#}\n+    </main> {#- -#}\n     {{- layout.external_html.after_content | safe -}}\n     <div id=\"rustdoc-vars\" {# -#}\n          data-root-path=\"{{page.root_path | safe}}\" {# -#}"}]}