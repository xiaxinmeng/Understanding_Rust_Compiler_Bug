{"sha": "60496504ac635b3f805e8afed5eb6130b620f790", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYwNDk2NTA0YWM2MzViM2Y4MDVlOGFmZWQ1ZWI2MTMwYjYyMGY3OTA=", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2020-06-13T11:47:37Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2020-06-13T11:47:37Z"}, "message": "avoid computing precise span for const_eval query", "tree": {"sha": "0f47cacc6e9ca89a4209bc6d8b64c93365172142", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0f47cacc6e9ca89a4209bc6d8b64c93365172142"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/60496504ac635b3f805e8afed5eb6130b620f790", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/60496504ac635b3f805e8afed5eb6130b620f790", "html_url": "https://github.com/rust-lang/rust/commit/60496504ac635b3f805e8afed5eb6130b620f790", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/60496504ac635b3f805e8afed5eb6130b620f790/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "32b01c78d0502c8a4cc36abbe8dc3c000436df98", "url": "https://api.github.com/repos/rust-lang/rust/commits/32b01c78d0502c8a4cc36abbe8dc3c000436df98", "html_url": "https://github.com/rust-lang/rust/commit/32b01c78d0502c8a4cc36abbe8dc3c000436df98"}], "stats": {"total": 6, "additions": 3, "deletions": 3}, "files": [{"sha": "4a0981a95a6660575aa2b3232bc2362e614e8310", "filename": "src/librustc_mir/interpret/eval_context.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/60496504ac635b3f805e8afed5eb6130b620f790/src%2Flibrustc_mir%2Finterpret%2Feval_context.rs", "raw_url": "https://github.com/rust-lang/rust/raw/60496504ac635b3f805e8afed5eb6130b620f790/src%2Flibrustc_mir%2Finterpret%2Feval_context.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Feval_context.rs?ref=60496504ac635b3f805e8afed5eb6130b620f790", "patch": "@@ -860,7 +860,7 @@ impl<'mir, 'tcx: 'mir, M: Machine<'mir, 'tcx>> InterpCx<'mir, 'tcx, M> {\n         } else {\n             self.param_env\n         };\n-        let val = self.tcx.const_eval_global_id(param_env, gid, Some(self.cur_span()))?;\n+        let val = self.tcx.const_eval_global_id(param_env, gid, Some(self.root_span))?;\n \n         // Even though `ecx.const_eval` is called from `eval_const_to_op` we can never have a\n         // recursion deeper than one level, because the `tcx.const_eval` above is guaranteed to not"}, {"sha": "0aa30665f590769d70e73c7f09e30b043c3be9fc", "filename": "src/test/ui/consts/const-size_of-cycle.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/60496504ac635b3f805e8afed5eb6130b620f790/src%2Ftest%2Fui%2Fconsts%2Fconst-size_of-cycle.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/60496504ac635b3f805e8afed5eb6130b620f790/src%2Ftest%2Fui%2Fconsts%2Fconst-size_of-cycle.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-size_of-cycle.stderr?ref=60496504ac635b3f805e8afed5eb6130b620f790", "patch": "@@ -17,8 +17,8 @@ LL |     bytes: [u8; std::mem::size_of::<Foo>()]\n note: ...which requires const-evaluating `std::mem::size_of`...\n   --> $SRC_DIR/libcore/mem/mod.rs:LL:COL\n    |\n-LL |     intrinsics::size_of::<T>()\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL | pub const fn size_of<T>() -> usize {\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n note: ...which requires const-evaluating + checking `std::intrinsics::size_of`...\n   --> $SRC_DIR/libcore/intrinsics.rs:LL:COL\n    |"}]}