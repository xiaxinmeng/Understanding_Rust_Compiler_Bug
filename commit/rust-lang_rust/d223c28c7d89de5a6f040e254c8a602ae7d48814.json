{"sha": "d223c28c7d89de5a6f040e254c8a602ae7d48814", "node_id": "C_kwDOAAsO6NoAKGQyMjNjMjhjN2Q4OWRlNWE2ZjA0MGUyNTRjOGE2MDJhZTdkNDg4MTQ", "commit": {"author": {"name": "Ryo Yoshida", "email": "low.ryoshida@gmail.com", "date": "2022-09-12T16:52:16Z"}, "committer": {"name": "Ryo Yoshida", "email": "low.ryoshida@gmail.com", "date": "2022-09-12T17:20:35Z"}, "message": "Remove unnecessary `Option`", "tree": {"sha": "ceab5ba3a437b3ab2164b05c40551173356cf928", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ceab5ba3a437b3ab2164b05c40551173356cf928"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d223c28c7d89de5a6f040e254c8a602ae7d48814", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEkSbsQIURluxz4rzf4laYqTBYYXEFAmMfamMACgkQ4laYqTBY\nYXHASxAAlW/X+dxVj6wH6n23ZAQspi45Ct8OBCirP0ZyqjCN4dt/334Qr5BJPAb6\n1na4zizUqLZi4yUHQw+rdnV8XMiibiXlLGaRdqAFwTeJLw2p+naQL62iScchkGsn\no883FvrKHljnS6NlJVfGUKL7k1VpcBhqWAcxtOwYBZMyLrrTYW68X8BbxPUpTKi5\ndymlj1YFX5g85SNJseiaMhtRKR7BUzrg0IMCF2sLhUSTudPtFEAzFpNZfpMC/m8a\nsuTLdW3UUSVy1t4vrP0TjrUkUBthl9InpmGkOslEVjCPZ4yrobXcTkQR3LFzU0xM\nlD3jEWfXHuDb3vn5gQlnsaAJ18S9qJpQmcbqC1I1Wq/rnLjkNOnaPnbVdEI29786\nPS2ykCYuwhO90ykjJqYLrADv6zsRGF010r+6hf+QUNDj4vSNv9BVIjrSZdV7RFqL\nNyol6vP18JsF4c/4L6CER/L64NpDSTVTynyiT+BtlK6+R0XkTYzHcwwhU+liU8Gn\nm6Rc/6Guc2zG++Z+qvT0UcFtDXhGBZeZq+NCpuUyEkOqrbt5KvFRriGzVcKhQ7TH\n4r/Dbv0t3Gr+v1eamkVNtQRRPDkLcNBecL0N/3cIOR6qLt9Wnb1PJ/oOxc7UhUOF\nyzKDi9Eq6j+mmD9piLNgWwd4gs5bVMPXNIqUu1Rl65V/W9H/JIA=\n=TCKb\n-----END PGP SIGNATURE-----", "payload": "tree ceab5ba3a437b3ab2164b05c40551173356cf928\nparent efb56160c91f0c1db511423fad8cc09fdd73d618\nauthor Ryo Yoshida <low.ryoshida@gmail.com> 1663001536 +0900\ncommitter Ryo Yoshida <low.ryoshida@gmail.com> 1663003235 +0900\n\nRemove unnecessary `Option`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d223c28c7d89de5a6f040e254c8a602ae7d48814", "html_url": "https://github.com/rust-lang/rust/commit/d223c28c7d89de5a6f040e254c8a602ae7d48814", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d223c28c7d89de5a6f040e254c8a602ae7d48814/comments", "author": {"login": "lowr", "id": 24381114, "node_id": "MDQ6VXNlcjI0MzgxMTE0", "avatar_url": "https://avatars.githubusercontent.com/u/24381114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lowr", "html_url": "https://github.com/lowr", "followers_url": "https://api.github.com/users/lowr/followers", "following_url": "https://api.github.com/users/lowr/following{/other_user}", "gists_url": "https://api.github.com/users/lowr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lowr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lowr/subscriptions", "organizations_url": "https://api.github.com/users/lowr/orgs", "repos_url": "https://api.github.com/users/lowr/repos", "events_url": "https://api.github.com/users/lowr/events{/privacy}", "received_events_url": "https://api.github.com/users/lowr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lowr", "id": 24381114, "node_id": "MDQ6VXNlcjI0MzgxMTE0", "avatar_url": "https://avatars.githubusercontent.com/u/24381114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lowr", "html_url": "https://github.com/lowr", "followers_url": "https://api.github.com/users/lowr/followers", "following_url": "https://api.github.com/users/lowr/following{/other_user}", "gists_url": "https://api.github.com/users/lowr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lowr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lowr/subscriptions", "organizations_url": "https://api.github.com/users/lowr/orgs", "repos_url": "https://api.github.com/users/lowr/repos", "events_url": "https://api.github.com/users/lowr/events{/privacy}", "received_events_url": "https://api.github.com/users/lowr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "efb56160c91f0c1db511423fad8cc09fdd73d618", "url": "https://api.github.com/repos/rust-lang/rust/commits/efb56160c91f0c1db511423fad8cc09fdd73d618", "html_url": "https://github.com/rust-lang/rust/commit/efb56160c91f0c1db511423fad8cc09fdd73d618"}], "stats": {"total": 15, "additions": 10, "deletions": 5}, "files": [{"sha": "69283e55a4c2cb0e6acce24fe7f2ac73c11d2410", "filename": "crates/hir-ty/src/db.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d223c28c7d89de5a6f040e254c8a602ae7d48814/crates%2Fhir-ty%2Fsrc%2Fdb.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d223c28c7d89de5a6f040e254c8a602ae7d48814/crates%2Fhir-ty%2Fsrc%2Fdb.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir-ty%2Fsrc%2Fdb.rs?ref=d223c28c7d89de5a6f040e254c8a602ae7d48814", "patch": "@@ -156,7 +156,7 @@ pub trait HirDatabase: DefDatabase + Upcast<dyn DefDatabase> {\n         &self,\n         projection: crate::ProjectionTy,\n         env: Arc<crate::TraitEnvironment>,\n-    ) -> Option<crate::Ty>;\n+    ) -> Ty;\n \n     #[salsa::invoke(trait_solve_wait)]\n     #[salsa::transparent]"}, {"sha": "372c3a3cca644fd0966c88bc992c5c06087ffb03", "filename": "crates/hir-ty/src/traits.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d223c28c7d89de5a6f040e254c8a602ae7d48814/crates%2Fhir-ty%2Fsrc%2Ftraits.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d223c28c7d89de5a6f040e254c8a602ae7d48814/crates%2Fhir-ty%2Fsrc%2Ftraits.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir-ty%2Fsrc%2Ftraits.rs?ref=d223c28c7d89de5a6f040e254c8a602ae7d48814", "patch": "@@ -69,10 +69,10 @@ pub(crate) fn normalize_projection_query(\n     db: &dyn HirDatabase,\n     projection: ProjectionTy,\n     env: Arc<TraitEnvironment>,\n-) -> Option<Ty> {\n-    let mut table = InferenceTable::new(db, env.clone());\n+) -> Ty {\n+    let mut table = InferenceTable::new(db, env);\n     let ty = table.normalize_projection_ty(projection);\n-    Some(table.resolve_completely(ty))\n+    table.resolve_completely(ty)\n }\n \n /// Solve a trait goal using Chalk."}, {"sha": "c981ffbc789a55bff6ed22f13bf6973fd6ac532d", "filename": "crates/hir/src/lib.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/d223c28c7d89de5a6f040e254c8a602ae7d48814/crates%2Fhir%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d223c28c7d89de5a6f040e254c8a602ae7d48814/crates%2Fhir%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir%2Fsrc%2Flib.rs?ref=d223c28c7d89de5a6f040e254c8a602ae7d48814", "patch": "@@ -2880,7 +2880,12 @@ impl Type {\n             })\n             .build();\n \n-        db.normalize_projection(projection, self.env.clone()).map(|ty| self.derived(ty))\n+        let ty = db.normalize_projection(projection, self.env.clone());\n+        if ty.is_unknown() {\n+            None\n+        } else {\n+            Some(self.derived(ty))\n+        }\n     }\n \n     pub fn is_copy(&self, db: &dyn HirDatabase) -> bool {"}]}