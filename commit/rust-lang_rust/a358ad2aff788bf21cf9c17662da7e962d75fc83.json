{"sha": "a358ad2aff788bf21cf9c17662da7e962d75fc83", "node_id": "C_kwDOAAsO6NoAKGEzNThhZDJhZmY3ODhiZjIxY2Y5YzE3NjYyZGE3ZTk2MmQ3NWZjODM", "commit": {"author": {"name": "CAD97", "email": "cad97@cad97.com", "date": "2022-03-16T04:58:18Z"}, "committer": {"name": "CAD97", "email": "cad97@cad97.com", "date": "2022-03-18T22:47:36Z"}, "message": "Make Weak::new const", "tree": {"sha": "8ff404923dc2a9c3812038522ed036a705074b99", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8ff404923dc2a9c3812038522ed036a705074b99"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a358ad2aff788bf21cf9c17662da7e962d75fc83", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a358ad2aff788bf21cf9c17662da7e962d75fc83", "html_url": "https://github.com/rust-lang/rust/commit/a358ad2aff788bf21cf9c17662da7e962d75fc83", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a358ad2aff788bf21cf9c17662da7e962d75fc83/comments", "author": {"login": "CAD97", "id": 5992217, "node_id": "MDQ6VXNlcjU5OTIyMTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5992217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CAD97", "html_url": "https://github.com/CAD97", "followers_url": "https://api.github.com/users/CAD97/followers", "following_url": "https://api.github.com/users/CAD97/following{/other_user}", "gists_url": "https://api.github.com/users/CAD97/gists{/gist_id}", "starred_url": "https://api.github.com/users/CAD97/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CAD97/subscriptions", "organizations_url": "https://api.github.com/users/CAD97/orgs", "repos_url": "https://api.github.com/users/CAD97/repos", "events_url": "https://api.github.com/users/CAD97/events{/privacy}", "received_events_url": "https://api.github.com/users/CAD97/received_events", "type": "User", "site_admin": false}, "committer": {"login": "CAD97", "id": 5992217, "node_id": "MDQ6VXNlcjU5OTIyMTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5992217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CAD97", "html_url": "https://github.com/CAD97", "followers_url": "https://api.github.com/users/CAD97/followers", "following_url": "https://api.github.com/users/CAD97/following{/other_user}", "gists_url": "https://api.github.com/users/CAD97/gists{/gist_id}", "starred_url": "https://api.github.com/users/CAD97/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CAD97/subscriptions", "organizations_url": "https://api.github.com/users/CAD97/orgs", "repos_url": "https://api.github.com/users/CAD97/repos", "events_url": "https://api.github.com/users/CAD97/events{/privacy}", "received_events_url": "https://api.github.com/users/CAD97/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "af446e1d7086d4aeed495f6b03e70009e9424ce4", "url": "https://api.github.com/repos/rust-lang/rust/commits/af446e1d7086d4aeed495f6b03e70009e9424ce4", "html_url": "https://github.com/rust-lang/rust/commit/af446e1d7086d4aeed495f6b03e70009e9424ce4"}], "stats": {"total": 10, "additions": 6, "deletions": 4}, "files": [{"sha": "ea651c075d9682639327ab40a1e4d44a544d5881", "filename": "library/alloc/src/rc.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/a358ad2aff788bf21cf9c17662da7e962d75fc83/library%2Falloc%2Fsrc%2Frc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a358ad2aff788bf21cf9c17662da7e962d75fc83/library%2Falloc%2Fsrc%2Frc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Frc.rs?ref=a358ad2aff788bf21cf9c17662da7e962d75fc83", "patch": "@@ -2112,9 +2112,10 @@ impl<T> Weak<T> {\n     /// assert!(empty.upgrade().is_none());\n     /// ```\n     #[stable(feature = \"downgraded_weak\", since = \"1.10.0\")]\n+    #[rustc_const_unstable(feature = \"const_weak_new\", issue = \"95091\", reason = \"recently added\")]\n     #[must_use]\n-    pub fn new() -> Weak<T> {\n-        Weak { ptr: NonNull::new(usize::MAX as *mut RcBox<T>).expect(\"MAX is not 0\") }\n+    pub const fn new() -> Weak<T> {\n+        Weak { ptr: unsafe { NonNull::new_unchecked(usize::MAX as *mut RcBox<T>) } }\n     }\n }\n "}, {"sha": "ba3187294e6543f4b8e4a4060d91ba9fd213457d", "filename": "library/alloc/src/sync.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/a358ad2aff788bf21cf9c17662da7e962d75fc83/library%2Falloc%2Fsrc%2Fsync.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a358ad2aff788bf21cf9c17662da7e962d75fc83/library%2Falloc%2Fsrc%2Fsync.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fsync.rs?ref=a358ad2aff788bf21cf9c17662da7e962d75fc83", "patch": "@@ -1742,9 +1742,10 @@ impl<T> Weak<T> {\n     /// assert!(empty.upgrade().is_none());\n     /// ```\n     #[stable(feature = \"downgraded_weak\", since = \"1.10.0\")]\n+    #[rustc_const_unstable(feature = \"const_weak_new\", issue = \"95091\", reason = \"recently added\")]\n     #[must_use]\n-    pub fn new() -> Weak<T> {\n-        Weak { ptr: NonNull::new(usize::MAX as *mut ArcInner<T>).expect(\"MAX is not 0\") }\n+    pub const fn new() -> Weak<T> {\n+        Weak { ptr: unsafe { NonNull::new_unchecked(usize::MAX as *mut ArcInner<T>) } }\n     }\n }\n "}]}