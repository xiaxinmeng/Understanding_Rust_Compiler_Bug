{"sha": "6c4fd615df63d72a6cb67d925405582a857ad044", "node_id": "C_kwDOAAsO6NoAKDZjNGZkNjE1ZGY2M2Q3MmE2Y2I2N2Q5MjU0MDU1ODJhODU3YWQwNDQ", "commit": {"author": {"name": "Sylvan Bowdler", "email": "sylvanbowdler81@gmail.com", "date": "2021-12-14T08:01:32Z"}, "committer": {"name": "Sylvan Bowdler", "email": "sylvanbowdler18@gmail.com", "date": "2021-12-15T22:02:25Z"}, "message": "Remove `in_band_lifetimes` from `rustc_symbol_mangling`", "tree": {"sha": "745f0315cf9b440a744dfa1b9f8c36281b4798fa", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/745f0315cf9b440a744dfa1b9f8c36281b4798fa"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6c4fd615df63d72a6cb67d925405582a857ad044", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6c4fd615df63d72a6cb67d925405582a857ad044", "html_url": "https://github.com/rust-lang/rust/commit/6c4fd615df63d72a6cb67d925405582a857ad044", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6c4fd615df63d72a6cb67d925405582a857ad044/comments", "author": null, "committer": {"login": "SylvanB", "id": 14810695, "node_id": "MDQ6VXNlcjE0ODEwNjk1", "avatar_url": "https://avatars.githubusercontent.com/u/14810695?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SylvanB", "html_url": "https://github.com/SylvanB", "followers_url": "https://api.github.com/users/SylvanB/followers", "following_url": "https://api.github.com/users/SylvanB/following{/other_user}", "gists_url": "https://api.github.com/users/SylvanB/gists{/gist_id}", "starred_url": "https://api.github.com/users/SylvanB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SylvanB/subscriptions", "organizations_url": "https://api.github.com/users/SylvanB/orgs", "repos_url": "https://api.github.com/users/SylvanB/repos", "events_url": "https://api.github.com/users/SylvanB/events{/privacy}", "received_events_url": "https://api.github.com/users/SylvanB/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c5ecc157043ba413568b09292001a4a74b541a4e", "url": "https://api.github.com/repos/rust-lang/rust/commits/c5ecc157043ba413568b09292001a4a74b541a4e", "html_url": "https://github.com/rust-lang/rust/commit/c5ecc157043ba413568b09292001a4a74b541a4e"}], "stats": {"total": 27, "additions": 13, "deletions": 14}, "files": [{"sha": "cdea84a8d60f7ae54a43dae4c24abdbef6972fae", "filename": "compiler/rustc_symbol_mangling/src/legacy.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6c4fd615df63d72a6cb67d925405582a857ad044/compiler%2Frustc_symbol_mangling%2Fsrc%2Flegacy.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c4fd615df63d72a6cb67d925405582a857ad044/compiler%2Frustc_symbol_mangling%2Fsrc%2Flegacy.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_symbol_mangling%2Fsrc%2Flegacy.rs?ref=6c4fd615df63d72a6cb67d925405582a857ad044", "patch": "@@ -13,7 +13,7 @@ use tracing::debug;\n use std::fmt::{self, Write};\n use std::mem::{self, discriminant};\n \n-pub(super) fn mangle(\n+pub(super) fn mangle<'tcx>(\n     tcx: TyCtxt<'tcx>,\n     instance: Instance<'tcx>,\n     instantiating_crate: Option<CrateNum>,\n@@ -199,7 +199,7 @@ struct SymbolPrinter<'tcx> {\n // `PrettyPrinter` aka pretty printing of e.g. types in paths,\n // symbol names should have their own printing machinery.\n \n-impl Printer<'tcx> for &mut SymbolPrinter<'tcx> {\n+impl<'tcx> Printer<'tcx> for &mut SymbolPrinter<'tcx> {\n     type Error = fmt::Error;\n \n     type Path = Self;\n@@ -345,7 +345,7 @@ impl Printer<'tcx> for &mut SymbolPrinter<'tcx> {\n     }\n }\n \n-impl PrettyPrinter<'tcx> for &mut SymbolPrinter<'tcx> {\n+impl<'tcx> PrettyPrinter<'tcx> for &mut SymbolPrinter<'tcx> {\n     fn region_should_not_be_omitted(&self, _region: ty::Region<'_>) -> bool {\n         false\n     }"}, {"sha": "65b5852bc39839caf06fa128dce5533222d383bd", "filename": "compiler/rustc_symbol_mangling/src/lib.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/6c4fd615df63d72a6cb67d925405582a857ad044/compiler%2Frustc_symbol_mangling%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c4fd615df63d72a6cb67d925405582a857ad044/compiler%2Frustc_symbol_mangling%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_symbol_mangling%2Fsrc%2Flib.rs?ref=6c4fd615df63d72a6cb67d925405582a857ad044", "patch": "@@ -90,7 +90,6 @@\n #![doc(html_root_url = \"https://doc.rust-lang.org/nightly/nightly-rustc/\")]\n #![feature(never_type)]\n #![feature(nll)]\n-#![feature(in_band_lifetimes)]\n #![recursion_limit = \"256\"]\n \n #[macro_use]\n@@ -116,7 +115,7 @@ pub mod test;\n /// This function computes the symbol name for the given `instance` and the\n /// given instantiating crate. That is, if you know that instance X is\n /// instantiated in crate Y, this is the symbol name this instance would have.\n-pub fn symbol_name_for_instance_in_crate(\n+pub fn symbol_name_for_instance_in_crate<'tcx>(\n     tcx: TyCtxt<'tcx>,\n     instance: Instance<'tcx>,\n     instantiating_crate: CrateNum,\n@@ -131,7 +130,7 @@ pub fn provide(providers: &mut Providers) {\n // The `symbol_name` query provides the symbol name for calling a given\n // instance from the local crate. In particular, it will also look up the\n // correct symbol name of instances from upstream crates.\n-fn symbol_name_provider(tcx: TyCtxt<'tcx>, instance: Instance<'tcx>) -> ty::SymbolName<'tcx> {\n+fn symbol_name_provider<'tcx>(tcx: TyCtxt<'tcx>, instance: Instance<'tcx>) -> ty::SymbolName<'tcx> {\n     let symbol_name = compute_symbol_name(tcx, instance, || {\n         // This closure determines the instantiating crate for instances that\n         // need an instantiating-crate-suffix for their symbol name, in order\n@@ -151,14 +150,14 @@ fn symbol_name_provider(tcx: TyCtxt<'tcx>, instance: Instance<'tcx>) -> ty::Symb\n }\n \n /// This function computes the typeid for the given function ABI.\n-pub fn typeid_for_fnabi(tcx: TyCtxt<'tcx>, fn_abi: &FnAbi<'tcx, Ty<'tcx>>) -> String {\n+pub fn typeid_for_fnabi<'tcx>(tcx: TyCtxt<'tcx>, fn_abi: &FnAbi<'tcx, Ty<'tcx>>) -> String {\n     v0::mangle_typeid_for_fnabi(tcx, fn_abi)\n }\n \n /// Computes the symbol name for the given instance. This function will call\n /// `compute_instantiating_crate` if it needs to factor the instantiating crate\n /// into the symbol name.\n-fn compute_symbol_name(\n+fn compute_symbol_name<'tcx>(\n     tcx: TyCtxt<'tcx>,\n     instance: Instance<'tcx>,\n     compute_instantiating_crate: impl FnOnce() -> CrateNum,"}, {"sha": "700765a351ce18f17e33b3f8d63de3d1da76d159", "filename": "compiler/rustc_symbol_mangling/src/test.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/6c4fd615df63d72a6cb67d925405582a857ad044/compiler%2Frustc_symbol_mangling%2Fsrc%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c4fd615df63d72a6cb67d925405582a857ad044/compiler%2Frustc_symbol_mangling%2Fsrc%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_symbol_mangling%2Fsrc%2Ftest.rs?ref=6c4fd615df63d72a6cb67d925405582a857ad044", "patch": "@@ -31,7 +31,7 @@ struct SymbolNamesTest<'tcx> {\n     tcx: TyCtxt<'tcx>,\n }\n \n-impl SymbolNamesTest<'tcx> {\n+impl SymbolNamesTest<'_> {\n     fn process_attrs(&mut self, def_id: LocalDefId) {\n         let tcx = self.tcx;\n         for attr in tcx.get_attrs(def_id.to_def_id()).iter() {\n@@ -59,7 +59,7 @@ impl SymbolNamesTest<'tcx> {\n     }\n }\n \n-impl hir::itemlikevisit::ItemLikeVisitor<'tcx> for SymbolNamesTest<'tcx> {\n+impl<'tcx> hir::itemlikevisit::ItemLikeVisitor<'tcx> for SymbolNamesTest<'tcx> {\n     fn visit_item(&mut self, item: &'tcx hir::Item<'tcx>) {\n         self.process_attrs(item.def_id);\n     }"}, {"sha": "167ff758f34801b4429f212e53684976c2bc35f4", "filename": "compiler/rustc_symbol_mangling/src/v0.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/6c4fd615df63d72a6cb67d925405582a857ad044/compiler%2Frustc_symbol_mangling%2Fsrc%2Fv0.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c4fd615df63d72a6cb67d925405582a857ad044/compiler%2Frustc_symbol_mangling%2Fsrc%2Fv0.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_symbol_mangling%2Fsrc%2Fv0.rs?ref=6c4fd615df63d72a6cb67d925405582a857ad044", "patch": "@@ -17,7 +17,7 @@ use std::fmt::Write;\n use std::iter;\n use std::ops::Range;\n \n-pub(super) fn mangle(\n+pub(super) fn mangle<'tcx>(\n     tcx: TyCtxt<'tcx>,\n     instance: Instance<'tcx>,\n     instantiating_crate: Option<CrateNum>,\n@@ -56,7 +56,7 @@ pub(super) fn mangle(\n     std::mem::take(&mut cx.out)\n }\n \n-pub(super) fn mangle_typeid_for_fnabi(\n+pub(super) fn mangle_typeid_for_fnabi<'tcx>(\n     _tcx: TyCtxt<'tcx>,\n     fn_abi: &FnAbi<'tcx, Ty<'tcx>>,\n ) -> String {\n@@ -118,7 +118,7 @@ struct SymbolMangler<'tcx> {\n     consts: FxHashMap<&'tcx ty::Const<'tcx>, usize>,\n }\n \n-impl SymbolMangler<'tcx> {\n+impl<'tcx> SymbolMangler<'tcx> {\n     fn push(&mut self, s: &str) {\n         self.out.push_str(s);\n     }\n@@ -250,7 +250,7 @@ impl SymbolMangler<'tcx> {\n     }\n }\n \n-impl Printer<'tcx> for &mut SymbolMangler<'tcx> {\n+impl<'tcx> Printer<'tcx> for &mut SymbolMangler<'tcx> {\n     type Error = !;\n \n     type Path = Self;"}]}