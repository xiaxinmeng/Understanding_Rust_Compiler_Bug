{"sha": "fcd93accb49b21c908e2b86af9e5f9e5d90534bb", "node_id": "C_kwDOAAsO6NoAKGZjZDkzYWNjYjQ5YjIxYzkwOGUyYjg2YWY5ZTVmOWU1ZDkwNTM0YmI", "commit": {"author": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2023-05-17T10:30:14Z"}, "committer": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2023-06-01T14:45:18Z"}, "message": "Use translatable diagnostics in `rustc_const_eval`", "tree": {"sha": "8c2a74f00ae8a29b0ff0ce01b011cec096d77bc8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8c2a74f00ae8a29b0ff0ce01b011cec096d77bc8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fcd93accb49b21c908e2b86af9e5f9e5d90534bb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fcd93accb49b21c908e2b86af9e5f9e5d90534bb", "html_url": "https://github.com/rust-lang/rust/commit/fcd93accb49b21c908e2b86af9e5f9e5d90534bb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fcd93accb49b21c908e2b86af9e5f9e5d90534bb/comments", "author": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "04dca8f1b2a93177af5a7210b5ec223a63a163f2", "url": "https://api.github.com/repos/rust-lang/rust/commits/04dca8f1b2a93177af5a7210b5ec223a63a163f2", "html_url": "https://github.com/rust-lang/rust/commit/04dca8f1b2a93177af5a7210b5ec223a63a163f2"}], "stats": {"total": 16, "additions": 4, "deletions": 12}, "files": [{"sha": "7243cf6da232e3afe06fe45ae47fded5766c79a9", "filename": "src/common.rs", "status": "modified", "additions": 4, "deletions": 12, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/fcd93accb49b21c908e2b86af9e5f9e5d90534bb/src%2Fcommon.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fcd93accb49b21c908e2b86af9e5f9e5d90534bb/src%2Fcommon.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcommon.rs?ref=fcd93accb49b21c908e2b86af9e5f9e5d90534bb", "patch": "@@ -6,6 +6,7 @@ use rustc_index::IndexVec;\n use rustc_middle::ty::layout::{\n     FnAbiError, FnAbiOfHelpers, FnAbiRequest, LayoutError, LayoutOfHelpers,\n };\n+use rustc_span::source_map::Spanned;\n use rustc_span::SourceFile;\n use rustc_target::abi::call::FnAbi;\n use rustc_target::abi::{Integer, Primitive};\n@@ -495,25 +496,16 @@ impl<'tcx> FnAbiOfHelpers<'tcx> for RevealAllLayoutCx<'tcx> {\n         fn_abi_request: FnAbiRequest<'tcx>,\n     ) -> ! {\n         if let FnAbiError::Layout(LayoutError::SizeOverflow(_)) = err {\n-            self.0.sess.span_fatal(span, err.to_string())\n+            self.0.sess.emit_fatal(Spanned { span, node: err })\n         } else {\n             match fn_abi_request {\n                 FnAbiRequest::OfFnPtr { sig, extra_args } => {\n-                    span_bug!(\n-                        span,\n-                        \"`fn_abi_of_fn_ptr({}, {:?})` failed: {}\",\n-                        sig,\n-                        extra_args,\n-                        err\n-                    );\n+                    span_bug!(span, \"`fn_abi_of_fn_ptr({sig}, {extra_args:?})` failed: {err:?}\");\n                 }\n                 FnAbiRequest::OfInstance { instance, extra_args } => {\n                     span_bug!(\n                         span,\n-                        \"`fn_abi_of_instance({}, {:?})` failed: {}\",\n-                        instance,\n-                        extra_args,\n-                        err\n+                        \"`fn_abi_of_instance({instance}, {extra_args:?})` failed: {err:?}\"\n                     );\n                 }\n             }"}]}