{"sha": "e6dbecdff382691b9f072fedc7cf70cd8ab5a6a4", "node_id": "C_kwDOAAsO6NoAKGU2ZGJlY2RmZjM4MjY5MWI5ZjA3MmZlZGM3Y2Y3MGNkOGFiNWE2YTQ", "commit": {"author": {"name": "antoyo", "email": "antoyo@users.noreply.github.com", "date": "2022-05-15T14:25:28Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-05-15T14:25:28Z"}, "message": "Merge pull request #175 from GuillaumeGomez/llvmint-update\n\nUpdate llvmint", "tree": {"sha": "1498f8a58798222ccb5eeaaf8838920c96d01b55", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1498f8a58798222ccb5eeaaf8838920c96d01b55"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e6dbecdff382691b9f072fedc7cf70cd8ab5a6a4", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJigQ1YCRBK7hj4Ov3rIwAAYj0IAHJV4wHfl+80OyudVfRsl/hy\n4hRojrTm3HOaZF5lYZ7r5NVGZVltIc9jp/qkZe/brF1bhx18ZgVv4ml2TmgQjuJl\nbAoSJ6MuFrAI1kO7CIriHS8tBZnD+TSB6hI+5Q6kVB5xtb9YRaNwqSqQt8JS2Ohi\nK7XWx+MjGKEn0/d9DpIV/7+VtR+9P88uoMtltV2xPQrsp4rWQmOZ1swMKx+rzWUC\nn+asfoUe34o72AT0KaurFRdCezTSCJmb8BSNiiTtOFaonVbQyKOlMld+bdrDN68B\nShEhFkJQMSbvdNGPS+JoCXV1h2J/Ol21OUtM1fjtV19P+aXKluPhWu6TXizyIE0=\n=3Cee\n-----END PGP SIGNATURE-----\n", "payload": "tree 1498f8a58798222ccb5eeaaf8838920c96d01b55\nparent e062c3712591d4b0ffec3f74153f2cffa35a5c5e\nparent cede91971a023e8f18ad2f69a21f15a7e0ee67e9\nauthor antoyo <antoyo@users.noreply.github.com> 1652624728 -0400\ncommitter GitHub <noreply@github.com> 1652624728 -0400\n\nMerge pull request #175 from GuillaumeGomez/llvmint-update\n\nUpdate llvmint"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e6dbecdff382691b9f072fedc7cf70cd8ab5a6a4", "html_url": "https://github.com/rust-lang/rust/commit/e6dbecdff382691b9f072fedc7cf70cd8ab5a6a4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e6dbecdff382691b9f072fedc7cf70cd8ab5a6a4/comments", "author": {"login": "antoyo", "id": 584972, "node_id": "MDQ6VXNlcjU4NDk3Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/584972?v=4", "gravatar_id": "", "url": "https://api.github.com/users/antoyo", "html_url": "https://github.com/antoyo", "followers_url": "https://api.github.com/users/antoyo/followers", "following_url": "https://api.github.com/users/antoyo/following{/other_user}", "gists_url": "https://api.github.com/users/antoyo/gists{/gist_id}", "starred_url": "https://api.github.com/users/antoyo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/antoyo/subscriptions", "organizations_url": "https://api.github.com/users/antoyo/orgs", "repos_url": "https://api.github.com/users/antoyo/repos", "events_url": "https://api.github.com/users/antoyo/events{/privacy}", "received_events_url": "https://api.github.com/users/antoyo/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e062c3712591d4b0ffec3f74153f2cffa35a5c5e", "url": "https://api.github.com/repos/rust-lang/rust/commits/e062c3712591d4b0ffec3f74153f2cffa35a5c5e", "html_url": "https://github.com/rust-lang/rust/commit/e062c3712591d4b0ffec3f74153f2cffa35a5c5e"}, {"sha": "cede91971a023e8f18ad2f69a21f15a7e0ee67e9", "url": "https://api.github.com/repos/rust-lang/rust/commits/cede91971a023e8f18ad2f69a21f15a7e0ee67e9", "html_url": "https://github.com/rust-lang/rust/commit/cede91971a023e8f18ad2f69a21f15a7e0ee67e9"}], "stats": {"total": 1471, "additions": 1462, "deletions": 9}, "files": [{"sha": "12ed56675639c8525feef60ef9bec1d04ef5b824", "filename": ".gitignore", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/e6dbecdff382691b9f072fedc7cf70cd8ab5a6a4/.gitignore", "raw_url": "https://github.com/rust-lang/rust/raw/e6dbecdff382691b9f072fedc7cf70cd8ab5a6a4/.gitignore", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.gitignore?ref=e6dbecdff382691b9f072fedc7cf70cd8ab5a6a4", "patch": "@@ -22,3 +22,4 @@ gcc_path\n benchmarks\n tools/llvm-project\n tools/llvmint\n+tools/llvmint-2"}, {"sha": "fb6c38fa072658c886cdd068f30a842e19398deb", "filename": "src/intrinsic/archs.rs", "status": "modified", "additions": 1443, "deletions": 0, "changes": 1443, "blob_url": "https://github.com/rust-lang/rust/blob/e6dbecdff382691b9f072fedc7cf70cd8ab5a6a4/src%2Fintrinsic%2Farchs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6dbecdff382691b9f072fedc7cf70cd8ab5a6a4/src%2Fintrinsic%2Farchs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fintrinsic%2Farchs.rs?ref=e6dbecdff382691b9f072fedc7cf70cd8ab5a6a4"}, {"sha": "849c6e9c98164adf72f254c684f2216234ccceb2", "filename": "tools/generate_intrinsics.py", "status": "modified", "additions": 18, "deletions": 9, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/e6dbecdff382691b9f072fedc7cf70cd8ab5a6a4/tools%2Fgenerate_intrinsics.py", "raw_url": "https://github.com/rust-lang/rust/raw/e6dbecdff382691b9f072fedc7cf70cd8ab5a6a4/tools%2Fgenerate_intrinsics.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tools%2Fgenerate_intrinsics.py?ref=e6dbecdff382691b9f072fedc7cf70cd8ab5a6a4", "patch": "@@ -16,7 +16,7 @@ def run_command(command, cwd=None):\n def clone_repository(repo_name, path, repo_url, sub_path=None):\n     if os.path.exists(path):\n         while True:\n-            choice = input(\"There is already a `{}` folder, do you want to update it? [y/N]\".format(repo_name))\n+            choice = input(\"There is already a `{}` folder, do you want to update it? [y/N]\".format(path))\n             if choice == \"\" or choice.lower() == \"n\":\n                 print(\"Skipping repository update.\")\n                 return\n@@ -116,12 +116,11 @@ def extract_instrinsics_from_llvmint(llvmint, intrinsics):\n     ]\n \n     json_file = os.path.join(llvmint, \"target/doc/llvmint.json\")\n-    if not os.path.exists(json_file):\n-        # We need to regenerate the documentation!\n-        run_command(\n-            [\"cargo\", \"rustdoc\", \"--\", \"-Zunstable-options\", \"--output-format\", \"json\"],\n-            cwd=llvmint,\n-        )\n+    # We need to regenerate the documentation!\n+    run_command(\n+        [\"cargo\", \"rustdoc\", \"--\", \"-Zunstable-options\", \"--output-format\", \"json\"],\n+        cwd=llvmint,\n+    )\n     with open(json_file, \"r\", encoding=\"utf8\") as f:\n         json_data = json.loads(f.read())\n     for p in json_data[\"paths\"]:\n@@ -160,13 +159,14 @@ def fill_intrinsics(intrinsics, from_intrinsics, all_intrinsics):\n                 all_intrinsics[entry[0]] = entry[1]\n \n \n-def update_intrinsics(llvm_path, llvmint):\n+def update_intrinsics(llvm_path, llvmint, llvmint2):\n     intrinsics_llvm = {}\n     intrinsics_llvmint = {}\n     all_intrinsics = {}\n \n     extract_instrinsics_from_llvm(llvm_path, intrinsics_llvm)\n     extract_instrinsics_from_llvmint(llvmint, intrinsics_llvmint)\n+    extract_instrinsics_from_llvmint(llvmint2, intrinsics_llvmint)\n \n     intrinsics = {}\n     # We give priority to translations from LLVM over the ones from llvmint.\n@@ -209,6 +209,10 @@ def main():\n         os.path.dirname(os.path.abspath(__file__)),\n         \"llvmint\",\n     )\n+    llvmint2_path = os.path.join(\n+        os.path.dirname(os.path.abspath(__file__)),\n+        \"llvmint-2\",\n+    )\n \n     # First, we clone the LLVM repository if it's not already here.\n     clone_repository(\n@@ -222,7 +226,12 @@ def main():\n         llvmint_path,\n         \"https://github.com/GuillaumeGomez/llvmint\",\n     )\n-    update_intrinsics(llvm_path, llvmint_path)\n+    clone_repository(\n+        \"llvmint2\",\n+        llvmint2_path,\n+        \"https://github.com/antoyo/llvmint\",\n+    )\n+    update_intrinsics(llvm_path, llvmint_path, llvmint2_path)\n \n \n if __name__ == \"__main__\":"}]}