{"sha": "06b8c3ee5b52dc849259655578afca70cb32dda3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA2YjhjM2VlNWI1MmRjODQ5MjU5NjU1NTc4YWZjYTcwY2IzMmRkYTM=", "commit": {"author": {"name": "Colin Pronovost", "email": "colin.pron@live.com", "date": "2018-09-25T03:09:44Z"}, "committer": {"name": "Colin Pronovost", "email": "colin.pron@live.com", "date": "2018-09-25T03:09:44Z"}, "message": "Rely only on base alignment and offset for computing field alignment\n\nFix #54028", "tree": {"sha": "4107dfbb872b7d7f20c46b46ff29e224521359c0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4107dfbb872b7d7f20c46b46ff29e224521359c0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/06b8c3ee5b52dc849259655578afca70cb32dda3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/06b8c3ee5b52dc849259655578afca70cb32dda3", "html_url": "https://github.com/rust-lang/rust/commit/06b8c3ee5b52dc849259655578afca70cb32dda3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/06b8c3ee5b52dc849259655578afca70cb32dda3/comments", "author": {"login": "AstralSorcerer", "id": 8902883, "node_id": "MDQ6VXNlcjg5MDI4ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/8902883?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AstralSorcerer", "html_url": "https://github.com/AstralSorcerer", "followers_url": "https://api.github.com/users/AstralSorcerer/followers", "following_url": "https://api.github.com/users/AstralSorcerer/following{/other_user}", "gists_url": "https://api.github.com/users/AstralSorcerer/gists{/gist_id}", "starred_url": "https://api.github.com/users/AstralSorcerer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AstralSorcerer/subscriptions", "organizations_url": "https://api.github.com/users/AstralSorcerer/orgs", "repos_url": "https://api.github.com/users/AstralSorcerer/repos", "events_url": "https://api.github.com/users/AstralSorcerer/events{/privacy}", "received_events_url": "https://api.github.com/users/AstralSorcerer/received_events", "type": "User", "site_admin": false}, "committer": {"login": "AstralSorcerer", "id": 8902883, "node_id": "MDQ6VXNlcjg5MDI4ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/8902883?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AstralSorcerer", "html_url": "https://github.com/AstralSorcerer", "followers_url": "https://api.github.com/users/AstralSorcerer/followers", "following_url": "https://api.github.com/users/AstralSorcerer/following{/other_user}", "gists_url": "https://api.github.com/users/AstralSorcerer/gists{/gist_id}", "starred_url": "https://api.github.com/users/AstralSorcerer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AstralSorcerer/subscriptions", "organizations_url": "https://api.github.com/users/AstralSorcerer/orgs", "repos_url": "https://api.github.com/users/AstralSorcerer/repos", "events_url": "https://api.github.com/users/AstralSorcerer/events{/privacy}", "received_events_url": "https://api.github.com/users/AstralSorcerer/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "70073ec61d0d56bca45b9bd40659bb75799cd273", "url": "https://api.github.com/repos/rust-lang/rust/commits/70073ec61d0d56bca45b9bd40659bb75799cd273", "html_url": "https://github.com/rust-lang/rust/commit/70073ec61d0d56bca45b9bd40659bb75799cd273"}], "stats": {"total": 15, "additions": 11, "deletions": 4}, "files": [{"sha": "e7b6f5908a4d16a2c4fa9780d53bd5abbcd9d5ff", "filename": "src/librustc_codegen_llvm/mir/place.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/06b8c3ee5b52dc849259655578afca70cb32dda3/src%2Flibrustc_codegen_llvm%2Fmir%2Fplace.rs", "raw_url": "https://github.com/rust-lang/rust/raw/06b8c3ee5b52dc849259655578afca70cb32dda3/src%2Flibrustc_codegen_llvm%2Fmir%2Fplace.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fmir%2Fplace.rs?ref=06b8c3ee5b52dc849259655578afca70cb32dda3", "patch": "@@ -173,10 +173,7 @@ impl PlaceRef<'ll, 'tcx> {\n         let cx = bx.cx;\n         let field = self.layout.field(cx, ix);\n         let offset = self.layout.fields.offset(ix);\n-        let effective_field_align = self.align\n-            .min(self.layout.align)\n-            .min(field.align)\n-            .restrict_for_offset(offset);\n+        let effective_field_align = self.align.restrict_for_offset(offset);\n \n         let simple = || {\n             // Unions and newtypes only use an offset of 0."}, {"sha": "887c43c6761e86bbc739f0525c2912561c18dae9", "filename": "src/test/codegen/align-struct.rs", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/06b8c3ee5b52dc849259655578afca70cb32dda3/src%2Ftest%2Fcodegen%2Falign-struct.rs", "raw_url": "https://github.com/rust-lang/rust/raw/06b8c3ee5b52dc849259655578afca70cb32dda3/src%2Ftest%2Fcodegen%2Falign-struct.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Falign-struct.rs?ref=06b8c3ee5b52dc849259655578afca70cb32dda3", "patch": "@@ -48,6 +48,16 @@ pub fn align64(i : i32) -> Align64 {\n     a64\n }\n \n+// For issue 54028: make sure that we are specifying the correct alignment for fields of aligned\n+// structs\n+// CHECK-LABEL: @align64_load\n+#[no_mangle]\n+pub fn align64_load(a: Align64) -> i32 {\n+// CHECK: [[FIELD:%.*]] = bitcast %Align64* %{{.*}} to i32*\n+// CHECK: {{%.*}} = load i32, i32* [[FIELD]], align 64\n+    a.0\n+}\n+\n // CHECK-LABEL: @nested64\n #[no_mangle]\n pub fn nested64(a: Align64, b: i32, c: i32, d: i8) -> Nested64 {"}]}