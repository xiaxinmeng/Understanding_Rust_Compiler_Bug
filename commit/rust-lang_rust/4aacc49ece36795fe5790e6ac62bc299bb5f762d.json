{"sha": "4aacc49ece36795fe5790e6ac62bc299bb5f762d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRhYWNjNDllY2UzNjc5NWZlNTc5MGU2YWM2MmJjMjk5YmI1Zjc2MmQ=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-03-29T11:32:30Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-03-29T11:32:30Z"}, "message": "Rollup merge of #59486 - varkor:dead-code-impl, r=sanxiyn\n\nVisit `ImplItem` in `dead_code` lint\n\nFixes https://github.com/rust-lang/rust/issues/47131.", "tree": {"sha": "12060b4f3f8b890beeeb8ea40a3892e88bc329dd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/12060b4f3f8b890beeeb8ea40a3892e88bc329dd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4aacc49ece36795fe5790e6ac62bc299bb5f762d", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcngJPCRBK7hj4Ov3rIwAAdHIIABDQffxYmCS2D12Tv4FAPYrC\nLcislRUtePS/mBIftPyVMpXBUPDu8FW7KkT0UG21N0LHS0wXmmo2Y8hxtplXjjtN\nxLoJwBDvlj79uC8C6k83KP/kHmzTJP4tQenS+o/fR33NJVmTtNcic4RKqouVpqME\nJEpleMPAPpGda2V1t8+7JGk4Ct3U9fNq3EM8+L/ry8yiAsggifDSfvEY6owHIGgY\nz6FHnuJD+r98RNajJsW9lxeacZiyHwkDLZbzd+gAcXgq1g7+C6Dqlt2U4dlP1RFi\nEr6b8g1thJJmoCXgvChahittZKWjeb+5NBP4u6EoymuxRqbQlrtbNxJ5aNTEs98=\n=IHgQ\n-----END PGP SIGNATURE-----\n", "payload": "tree 12060b4f3f8b890beeeb8ea40a3892e88bc329dd\nparent ee172673c1b58210fa34d4b17926d1a384039750\nparent 8cdfad91539dea8c9ec7d22c08f40e42e25e6ff0\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1553859150 +0100\ncommitter GitHub <noreply@github.com> 1553859150 +0100\n\nRollup merge of #59486 - varkor:dead-code-impl, r=sanxiyn\n\nVisit `ImplItem` in `dead_code` lint\n\nFixes https://github.com/rust-lang/rust/issues/47131.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4aacc49ece36795fe5790e6ac62bc299bb5f762d", "html_url": "https://github.com/rust-lang/rust/commit/4aacc49ece36795fe5790e6ac62bc299bb5f762d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4aacc49ece36795fe5790e6ac62bc299bb5f762d/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ee172673c1b58210fa34d4b17926d1a384039750", "url": "https://api.github.com/repos/rust-lang/rust/commits/ee172673c1b58210fa34d4b17926d1a384039750", "html_url": "https://github.com/rust-lang/rust/commit/ee172673c1b58210fa34d4b17926d1a384039750"}, {"sha": "8cdfad91539dea8c9ec7d22c08f40e42e25e6ff0", "url": "https://api.github.com/repos/rust-lang/rust/commits/8cdfad91539dea8c9ec7d22c08f40e42e25e6ff0", "html_url": "https://github.com/rust-lang/rust/commit/8cdfad91539dea8c9ec7d22c08f40e42e25e6ff0"}], "stats": {"total": 31, "additions": 23, "deletions": 8}, "files": [{"sha": "28fc3047af61cc2b027c9b0ef99e07cc7c814162", "filename": "src/librustc/middle/dead.rs", "status": "modified", "additions": 6, "deletions": 8, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/4aacc49ece36795fe5790e6ac62bc299bb5f762d/src%2Flibrustc%2Fmiddle%2Fdead.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4aacc49ece36795fe5790e6ac62bc299bb5f762d/src%2Flibrustc%2Fmiddle%2Fdead.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fdead.rs?ref=4aacc49ece36795fe5790e6ac62bc299bb5f762d", "patch": "@@ -73,7 +73,7 @@ impl<'a, 'tcx> MarkSymbolVisitor<'a, 'tcx> {\n             Def::Const(_) | Def::AssociatedConst(..) | Def::TyAlias(_) => {\n                 self.check_def_id(def.def_id());\n             }\n-            _ if self.in_pat => (),\n+            _ if self.in_pat => {},\n             Def::PrimTy(..) | Def::SelfTy(..) | Def::SelfCtor(..) |\n             Def::Local(..) | Def::Upvar(..) => {}\n             Def::Ctor(ctor_def_id, CtorOf::Variant, ..) => {\n@@ -91,6 +91,7 @@ impl<'a, 'tcx> MarkSymbolVisitor<'a, 'tcx> {\n                     self.check_def_id(variant_id);\n                 }\n             }\n+            Def::ToolMod | Def::NonMacroAttr(..) | Def::Err => {}\n             _ => {\n                 self.check_def_id(def.def_id());\n             }\n@@ -166,16 +167,13 @@ impl<'a, 'tcx> MarkSymbolVisitor<'a, 'tcx> {\n                     }\n                     hir::ItemKind::Enum(..) => {\n                         self.inherited_pub_visibility = item.vis.node.is_pub();\n+\n                         intravisit::walk_item(self, &item);\n                     }\n-                    hir::ItemKind::Fn(..)\n-                    | hir::ItemKind::Ty(..)\n-                    | hir::ItemKind::Static(..)\n-                    | hir::ItemKind::Existential(..)\n-                    | hir::ItemKind::Const(..) => {\n+                    hir::ItemKind::ForeignMod(..) => {}\n+                    _ => {\n                         intravisit::walk_item(self, &item);\n                     }\n-                    _ => ()\n                 }\n             }\n             Node::TraitItem(trait_item) => {\n@@ -187,7 +185,7 @@ impl<'a, 'tcx> MarkSymbolVisitor<'a, 'tcx> {\n             Node::ForeignItem(foreign_item) => {\n                 intravisit::walk_foreign_item(self, &foreign_item);\n             }\n-            _ => ()\n+            _ => {}\n         }\n         self.repr_has_repr_c = had_repr_c;\n         self.inherited_pub_visibility = had_inherited_pub_visibility;"}, {"sha": "84829c98e573908cdddc1a50890d25680ceca2b3", "filename": "src/test/ui/dead-code-impl.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/4aacc49ece36795fe5790e6ac62bc299bb5f762d/src%2Ftest%2Fui%2Fdead-code-impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4aacc49ece36795fe5790e6ac62bc299bb5f762d/src%2Ftest%2Fui%2Fdead-code-impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdead-code-impl.rs?ref=4aacc49ece36795fe5790e6ac62bc299bb5f762d", "patch": "@@ -0,0 +1,17 @@\n+// run-pass\n+\n+#![deny(dead_code)]\n+\n+pub struct GenericFoo<T>(T);\n+\n+type Foo = GenericFoo<u32>;\n+\n+impl Foo {\n+    fn bar(self) -> u8 {\n+        0\n+    }\n+}\n+\n+fn main() {\n+    println!(\"{}\", GenericFoo(0).bar());\n+}"}]}