{"sha": "16ba5029a19eaa5968e61f4447a2d3ebf3367dc2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE2YmE1MDI5YTE5ZWFhNTk2OGU2MWY0NDQ3YTJkM2ViZjMzNjdkYzI=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-09-05T07:17:19Z"}, "committer": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-09-05T07:17:19Z"}, "message": "or-patterns: fix fallout from #664128.", "tree": {"sha": "e7cf460e888be4c59059da08e6da9a4ae5c9b76d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e7cf460e888be4c59059da08e6da9a4ae5c9b76d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/16ba5029a19eaa5968e61f4447a2d3ebf3367dc2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/16ba5029a19eaa5968e61f4447a2d3ebf3367dc2", "html_url": "https://github.com/rust-lang/rust/commit/16ba5029a19eaa5968e61f4447a2d3ebf3367dc2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/16ba5029a19eaa5968e61f4447a2d3ebf3367dc2/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0341b78044a51b4883477234d2133c904b69ae68", "url": "https://api.github.com/repos/rust-lang/rust/commits/0341b78044a51b4883477234d2133c904b69ae68", "html_url": "https://github.com/rust-lang/rust/commit/0341b78044a51b4883477234d2133c904b69ae68"}], "stats": {"total": 63, "additions": 22, "deletions": 41}, "files": [{"sha": "561bf202dfeff07f7b6813aedd97050a4fcbacf4", "filename": "src/librustc_lint/unused.rs", "status": "modified", "additions": 3, "deletions": 7, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/16ba5029a19eaa5968e61f4447a2d3ebf3367dc2/src%2Flibrustc_lint%2Funused.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16ba5029a19eaa5968e61f4447a2d3ebf3367dc2/src%2Flibrustc_lint%2Funused.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Funused.rs?ref=16ba5029a19eaa5968e61f4447a2d3ebf3367dc2", "patch": "@@ -493,10 +493,8 @@ impl EarlyLintPass for UnusedParens {\n     fn check_expr(&mut self, cx: &EarlyContext<'_>, e: &ast::Expr) {\n         use syntax::ast::ExprKind::*;\n         let (value, msg, followed_by_block, left_pos, right_pos) = match e.node {\n-            Let(ref pats, ..) => {\n-                for p in pats {\n-                    self.check_unused_parens_pat(cx, p, false, false);\n-                }\n+            Let(ref pat, ..) => {\n+                self.check_unused_parens_pat(cx, pat, false, false);\n                 return;\n             }\n \n@@ -594,9 +592,7 @@ impl EarlyLintPass for UnusedParens {\n     }\n \n     fn check_arm(&mut self, cx: &EarlyContext<'_>, arm: &ast::Arm) {\n-        for p in &arm.pats {\n-            self.check_unused_parens_pat(cx, p, false, false);\n-        }\n+        self.check_unused_parens_pat(cx, &arm.pat, false, false);\n     }\n }\n "}, {"sha": "1d8cce522811682ac264b712c2d275ac288db584", "filename": "src/test/ui/lint/issue-54538-unused-parens-lint.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/16ba5029a19eaa5968e61f4447a2d3ebf3367dc2/src%2Ftest%2Fui%2Flint%2Fissue-54538-unused-parens-lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16ba5029a19eaa5968e61f4447a2d3ebf3367dc2/src%2Ftest%2Fui%2Flint%2Fissue-54538-unused-parens-lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fissue-54538-unused-parens-lint.rs?ref=16ba5029a19eaa5968e61f4447a2d3ebf3367dc2", "patch": "@@ -33,10 +33,8 @@ fn or_patterns_no_lint() {\n     if let &mut (0 | 1) = &mut 0 {} // Same.\n \n     fn foo((Ok(a) | Err(a)): Result<u8, u8>) {} // Doesn't parse if we remove parens for now.\n-    //~^ ERROR identifier `a` is bound more than once\n \n     let _ = |(Ok(a) | Err(a)): Result<u8, u8>| 1; // `|Ok(a) | Err(a)| 1` parses as bit-or.\n-    //~^ ERROR identifier `a` is bound more than once\n }\n \n fn or_patterns_will_lint() {"}, {"sha": "7d5e286416fe262b58f01617aab248c7a4b0cba0", "filename": "src/test/ui/lint/issue-54538-unused-parens-lint.stderr", "status": "modified", "additions": 19, "deletions": 32, "changes": 51, "blob_url": "https://github.com/rust-lang/rust/blob/16ba5029a19eaa5968e61f4447a2d3ebf3367dc2/src%2Ftest%2Fui%2Flint%2Fissue-54538-unused-parens-lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/16ba5029a19eaa5968e61f4447a2d3ebf3367dc2/src%2Ftest%2Fui%2Flint%2Fissue-54538-unused-parens-lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fissue-54538-unused-parens-lint.stderr?ref=16ba5029a19eaa5968e61f4447a2d3ebf3367dc2", "patch": "@@ -1,15 +1,3 @@\n-error[E0416]: identifier `a` is bound more than once in the same pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:35:25\n-   |\n-LL |     fn foo((Ok(a) | Err(a)): Result<u8, u8>) {} // Doesn't parse if we remove parens for now.\n-   |                         ^ used in a pattern more than once\n-\n-error[E0416]: identifier `a` is bound more than once in the same pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:38:27\n-   |\n-LL |     let _ = |(Ok(a) | Err(a)): Result<u8, u8>| 1; // `|Ok(a) | Err(a)| 1` parses as bit-or.\n-   |                           ^ used in a pattern more than once\n-\n warning: the feature `or_patterns` is incomplete and may cause the compiler to crash\n   --> $DIR/issue-54538-unused-parens-lint.rs:3:12\n    |\n@@ -61,113 +49,112 @@ LL |     let _ = |(a): u8| 0;\n    |              ^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:43:12\n+  --> $DIR/issue-54538-unused-parens-lint.rs:41:12\n    |\n LL |     if let (0 | 1) = 0 {}\n    |            ^^^^^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:44:13\n+  --> $DIR/issue-54538-unused-parens-lint.rs:42:13\n    |\n LL |     if let ((0 | 1),) = (0,) {}\n    |             ^^^^^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:45:13\n+  --> $DIR/issue-54538-unused-parens-lint.rs:43:13\n    |\n LL |     if let [(0 | 1)] = [0] {}\n    |             ^^^^^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:46:16\n+  --> $DIR/issue-54538-unused-parens-lint.rs:44:16\n    |\n LL |     if let 0 | (1 | 2) = 0 {}\n    |                ^^^^^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:48:15\n+  --> $DIR/issue-54538-unused-parens-lint.rs:46:15\n    |\n LL |     if let TS((0 | 1)) = TS(0) {}\n    |               ^^^^^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:50:20\n+  --> $DIR/issue-54538-unused-parens-lint.rs:48:20\n    |\n LL |     if let NS { f: (0 | 1) } = (NS { f: 0 }) {}\n    |                    ^^^^^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:60:9\n+  --> $DIR/issue-54538-unused-parens-lint.rs:58:9\n    |\n LL |         (_) => {}\n    |         ^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:61:9\n+  --> $DIR/issue-54538-unused-parens-lint.rs:59:9\n    |\n LL |         (y) => {}\n    |         ^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:62:9\n+  --> $DIR/issue-54538-unused-parens-lint.rs:60:9\n    |\n LL |         (ref r) => {}\n    |         ^^^^^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:63:9\n+  --> $DIR/issue-54538-unused-parens-lint.rs:61:9\n    |\n LL |         (e @ 1...2) => {}\n    |         ^^^^^^^^^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:69:9\n+  --> $DIR/issue-54538-unused-parens-lint.rs:67:9\n    |\n LL |         (e @ &(1...2)) => {}\n    |         ^^^^^^^^^^^^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:70:10\n+  --> $DIR/issue-54538-unused-parens-lint.rs:68:10\n    |\n LL |         &(_) => {}\n    |          ^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:81:9\n+  --> $DIR/issue-54538-unused-parens-lint.rs:79:9\n    |\n LL |         (_) => {}\n    |         ^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:82:9\n+  --> $DIR/issue-54538-unused-parens-lint.rs:80:9\n    |\n LL |         (y) => {}\n    |         ^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:83:9\n+  --> $DIR/issue-54538-unused-parens-lint.rs:81:9\n    |\n LL |         (ref r) => {}\n    |         ^^^^^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:84:9\n+  --> $DIR/issue-54538-unused-parens-lint.rs:82:9\n    |\n LL |         (e @ 1..=2) => {}\n    |         ^^^^^^^^^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:90:9\n+  --> $DIR/issue-54538-unused-parens-lint.rs:88:9\n    |\n LL |         (e @ &(1..=2)) => {}\n    |         ^^^^^^^^^^^^^^ help: remove these parentheses\n \n error: unnecessary parentheses around pattern\n-  --> $DIR/issue-54538-unused-parens-lint.rs:91:10\n+  --> $DIR/issue-54538-unused-parens-lint.rs:89:10\n    |\n LL |         &(_) => {}\n    |          ^^^ help: remove these parentheses\n \n-error: aborting due to 26 previous errors\n+error: aborting due to 24 previous errors\n \n-For more information about this error, try `rustc --explain E0416`."}]}