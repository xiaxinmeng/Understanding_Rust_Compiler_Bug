{"sha": "ab03c56ba2df69e5c01d2150a319343543a29ba9", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFiMDNjNTZiYTJkZjY5ZTVjMDFkMjE1MGEzMTkzNDM1NDNhMjliYTk=", "commit": {"author": {"name": "Nikita Popov", "email": "nikita.ppv@gmail.com", "date": "2021-03-03T16:58:39Z"}, "committer": {"name": "Nikita Popov", "email": "nikita.ppv@gmail.com", "date": "2021-03-03T19:48:37Z"}, "message": "Explicitly disable preinline during pgo-use test\n\nWe previously used -Os to disable this pass, but since\nhttps://reviews.llvm.org/D91673 this no longer works. Explicitly\ndisable it using -Cllvm-args instead.", "tree": {"sha": "27688ccb77d5047f023d48ef47b0ea55fe0fe6d2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/27688ccb77d5047f023d48ef47b0ea55fe0fe6d2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ab03c56ba2df69e5c01d2150a319343543a29ba9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ab03c56ba2df69e5c01d2150a319343543a29ba9", "html_url": "https://github.com/rust-lang/rust/commit/ab03c56ba2df69e5c01d2150a319343543a29ba9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ab03c56ba2df69e5c01d2150a319343543a29ba9/comments", "author": {"login": "nikic", "id": 216080, "node_id": "MDQ6VXNlcjIxNjA4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/216080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikic", "html_url": "https://github.com/nikic", "followers_url": "https://api.github.com/users/nikic/followers", "following_url": "https://api.github.com/users/nikic/following{/other_user}", "gists_url": "https://api.github.com/users/nikic/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikic/subscriptions", "organizations_url": "https://api.github.com/users/nikic/orgs", "repos_url": "https://api.github.com/users/nikic/repos", "events_url": "https://api.github.com/users/nikic/events{/privacy}", "received_events_url": "https://api.github.com/users/nikic/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikic", "id": 216080, "node_id": "MDQ6VXNlcjIxNjA4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/216080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikic", "html_url": "https://github.com/nikic", "followers_url": "https://api.github.com/users/nikic/followers", "following_url": "https://api.github.com/users/nikic/following{/other_user}", "gists_url": "https://api.github.com/users/nikic/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikic/subscriptions", "organizations_url": "https://api.github.com/users/nikic/orgs", "repos_url": "https://api.github.com/users/nikic/repos", "events_url": "https://api.github.com/users/nikic/events{/privacy}", "received_events_url": "https://api.github.com/users/nikic/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9a8acea78355b604dbeb29bc38bd4dbf7bfce95f", "url": "https://api.github.com/repos/rust-lang/rust/commits/9a8acea78355b604dbeb29bc38bd4dbf7bfce95f", "html_url": "https://github.com/rust-lang/rust/commit/9a8acea78355b604dbeb29bc38bd4dbf7bfce95f"}], "stats": {"total": 9, "additions": 4, "deletions": 5}, "files": [{"sha": "01bc211df161650f8b794f5035e8a6c41e747bb5", "filename": "src/test/run-make-fulldeps/pgo-use/Makefile", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/ab03c56ba2df69e5c01d2150a319343543a29ba9/src%2Ftest%2Frun-make-fulldeps%2Fpgo-use%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/ab03c56ba2df69e5c01d2150a319343543a29ba9/src%2Ftest%2Frun-make-fulldeps%2Fpgo-use%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fpgo-use%2FMakefile?ref=ab03c56ba2df69e5c01d2150a319343543a29ba9", "patch": "@@ -12,12 +12,11 @@\n # `else` branch. Accordingly, we expect the function that is never called to\n # be marked as cold.\n #\n-# The program is compiled with `-Copt-level=s` because this setting disables\n-# LLVM's pre-inlining pass (i.e. a pass that does some inlining before it adds\n-# the profiling instrumentation). Disabling this pass leads to rather\n-# predictable IR which we need for this test to be stable.\n+# Disable the pre-inlining pass (i.e. a pass that does some inlining before\n+# it adds the profiling instrumentation). Disabling this pass leads to\n+# rather predictable IR which we need for this test to be stable.\n \n-COMMON_FLAGS=-Copt-level=s -Ccodegen-units=1\n+COMMON_FLAGS=-Copt-level=2 -Ccodegen-units=1 -Cllvm-args=-disable-preinline\n \n # LLVM doesn't support instrumenting binaries that use SEH:\n # https://github.com/rust-lang/rust/issues/61002"}]}