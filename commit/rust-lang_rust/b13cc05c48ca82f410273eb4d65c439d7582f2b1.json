{"sha": "b13cc05c48ca82f410273eb4d65c439d7582f2b1", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIxM2NjMDVjNDhjYTgyZjQxMDI3M2ViNGQ2NWM0MzlkNzU4MmYyYjE=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-01-14T04:29:44Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-01-14T04:29:44Z"}, "message": "Auto merge of #39021 - alexcrichton:try-debug-travis, r=brson\n\ntravis: Attempt to debug OSX linker segfaults\n\nThis commit attempts to debug the segfaults that we've been seeing on OSX on\nTravis. I have no idea what's going on here mostly, but let's try to look at\ncore dumps and get backtraces to see what's going on. This commit itself is\nmostly a complete shot in the dark, I'm not sure if this even works...\n\ncc #38878", "tree": {"sha": "838a9678b4375e199b5f9c723ee5839968e473c7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/838a9678b4375e199b5f9c723ee5839968e473c7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b13cc05c48ca82f410273eb4d65c439d7582f2b1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b13cc05c48ca82f410273eb4d65c439d7582f2b1", "html_url": "https://github.com/rust-lang/rust/commit/b13cc05c48ca82f410273eb4d65c439d7582f2b1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b13cc05c48ca82f410273eb4d65c439d7582f2b1/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d70cd490711509707085e043d18b9862436407f8", "url": "https://api.github.com/repos/rust-lang/rust/commits/d70cd490711509707085e043d18b9862436407f8", "html_url": "https://github.com/rust-lang/rust/commit/d70cd490711509707085e043d18b9862436407f8"}, {"sha": "6ae6160e425d146dfba26f4978bdafa5d78fdbd7", "url": "https://api.github.com/repos/rust-lang/rust/commits/6ae6160e425d146dfba26f4978bdafa5d78fdbd7", "html_url": "https://github.com/rust-lang/rust/commit/6ae6160e425d146dfba26f4978bdafa5d78fdbd7"}], "stats": {"total": 15, "additions": 15, "deletions": 0}, "files": [{"sha": "6cb2b80214723af921a33da481f4cd93052870a6", "filename": ".travis.yml", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/b13cc05c48ca82f410273eb4d65c439d7582f2b1/.travis.yml", "raw_url": "https://github.com/rust-lang/rust/raw/b13cc05c48ca82f410273eb4d65c439d7582f2b1/.travis.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.travis.yml?ref=b13cc05c48ca82f410273eb4d65c439d7582f2b1", "patch": "@@ -35,29 +35,44 @@ matrix:\n         RUST_CONFIGURE_ARGS=--build=x86_64-apple-darwin\n         SRC=.\n       os: osx\n+      before_script: &osx_before_script >\n+        ulimit -c unlimited\n       install: &osx_install_sccache >\n         curl -L https://api.pub.build.mozilla.org/tooltool/sha512/d0025b286468cc5ada83b23d3fafbc936b9f190eaa7d4a981715b18e8e3bf720a7bcee7bfe758cfdeb8268857f6098fd52dcdd8818232692a30ce91039936596 |\n           tar xJf - -C /usr/local/bin --strip-components=1\n+      after_failure: &osx_after_failure >\n+        echo 'bt all' > cmds;\n+        for file in $(ls /cores); do\n+          echo core file $file;\n+          lldb -c $file `which ld` -b -s cmds;\n+        done\n+\n     - env: >\n         SCRIPT=\"./x.py test && ./x.py dist\"\n         RUST_CONFIGURE_ARGS=--build=i686-apple-darwin\n         SRC=.\n         DEPLOY=1\n       os: osx\n+      before_script: *osx_before_script\n       install: *osx_install_sccache\n+      after_failure: *osx_after_failure\n     - env: >\n         RUST_CHECK_TARGET=check\n         RUST_CONFIGURE_ARGS=--build=x86_64-apple-darwin --disable-rustbuild\n         SRC=.\n       os: osx\n+      before_script: *osx_before_script\n       install: *osx_install_sccache\n+      after_failure: *osx_after_failure\n     - env: >\n         RUST_CHECK_TARGET=dist\n         RUST_CONFIGURE_ARGS=--target=aarch64-apple-ios,armv7-apple-ios,armv7s-apple-ios,i386-apple-ios,x86_64-apple-ios\n         SRC=.\n         DEPLOY=1\n       os: osx\n+      before_script: *osx_before_script\n       install: *osx_install_sccache\n+      after_failure: *osx_after_failure\n \n env:\n   global:"}]}