{"sha": "45a69cc215c05bfc283564c9898e9c3704de8c80", "node_id": "C_kwDOAAsO6NoAKDQ1YTY5Y2MyMTVjMDViZmMyODM1NjRjOTg5OGU5YzM3MDRkZThjODA", "commit": {"author": {"name": "InfRandomness", "email": "infrandomness@gmail.com", "date": "2022-06-06T15:21:39Z"}, "committer": {"name": "InfRandomness", "email": "infrandomness@gmail.com", "date": "2022-07-03T20:30:31Z"}, "message": "Add in_tree macro literal\n\nSigned-off-by: InfRandomness <infrandomness@gmail.com>", "tree": {"sha": "78c58dcf6144f84d1727759970f352c134b9db83", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/78c58dcf6144f84d1727759970f352c134b9db83"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/45a69cc215c05bfc283564c9898e9c3704de8c80", "comment_count": 0, "verification": {"verified": false, "reason": "unknown_key", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEES/Kc3h45uW73N4seYLbIHvAzRBoFAmLB/GcACgkQYLbIHvAz\nRBp2Ig/+PxcMND4D2ZwfxEJ+jCMznyeOiS9ryI+1u+sq8SDhCsU4kIjy9T3KTDwK\nZNIi5Dpi6odW5JLnGjxXJtaeMhE7pMJta2WO2tUFqJLK9kd599pfmPsZad05JnyE\n7UyvgEw2NiDlaFQ5nysIC87L8XLAC8wGhvb4llecszVOk8xQER4/0FnMwkwtaHaf\nNWdDArc+2ETsDzyqQkVzNeO5WKRShEUGknZKKMbp94iH32PYSDFrnaTqLvn5HsEd\n1Tr1ss3feUqbipho46ZQ3aiooGDBnY1jVwAAsQVs0Cx45Hv+O2WtnpAkeDxIDk5d\nWRRFOJkTa16TJgYyOPkfp61e8DVgB88cucq5uNTjkfOtHgMCDqdw+lnUz6RmLCof\nUJ8zh7+xwDFoa5VmaEcu094XgwrDcNopVb9nCcUi0ofAcMcKd4bkPF9Dmey6CT84\ngz0QHjj3054jberkLpJ6vFUOKEQ8ER/MOSsDMEiH7gSis2Yz1Sd1nAGCQEHXhLaJ\nv8/XhNf5LhbKrG5LkjATQBBfKSs45pkqMlehYn6wLIjaoU/zjDB+qFNaZszNgLgw\nn3Q4iE4S0wvIfVob+GBXkIOHZYc+4A2j43fRZFbHgh/zlE/tvZlhUrOZXPuoONWW\nX2J/Q0oWBDImsN1fFa9K2micDziYgbt9uiZzMAaI2aMJz2PyYvM=\n=TnzL\n-----END PGP SIGNATURE-----", "payload": "tree 78c58dcf6144f84d1727759970f352c134b9db83\nparent dbe77e856ad5cf6298de19ce5c2730f2f631b4ef\nauthor InfRandomness <infrandomness@gmail.com> 1654528899 +0200\ncommitter InfRandomness <infrandomness@gmail.com> 1656880231 +0200\n\nAdd in_tree macro literal\n\nSigned-off-by: InfRandomness <infrandomness@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/45a69cc215c05bfc283564c9898e9c3704de8c80", "html_url": "https://github.com/rust-lang/rust/commit/45a69cc215c05bfc283564c9898e9c3704de8c80", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/45a69cc215c05bfc283564c9898e9c3704de8c80/comments", "author": {"login": "InfRandomness", "id": 43730933, "node_id": "MDQ6VXNlcjQzNzMwOTMz", "avatar_url": "https://avatars.githubusercontent.com/u/43730933?v=4", "gravatar_id": "", "url": "https://api.github.com/users/InfRandomness", "html_url": "https://github.com/InfRandomness", "followers_url": "https://api.github.com/users/InfRandomness/followers", "following_url": "https://api.github.com/users/InfRandomness/following{/other_user}", "gists_url": "https://api.github.com/users/InfRandomness/gists{/gist_id}", "starred_url": "https://api.github.com/users/InfRandomness/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/InfRandomness/subscriptions", "organizations_url": "https://api.github.com/users/InfRandomness/orgs", "repos_url": "https://api.github.com/users/InfRandomness/repos", "events_url": "https://api.github.com/users/InfRandomness/events{/privacy}", "received_events_url": "https://api.github.com/users/InfRandomness/received_events", "type": "User", "site_admin": false}, "committer": {"login": "InfRandomness", "id": 43730933, "node_id": "MDQ6VXNlcjQzNzMwOTMz", "avatar_url": "https://avatars.githubusercontent.com/u/43730933?v=4", "gravatar_id": "", "url": "https://api.github.com/users/InfRandomness", "html_url": "https://github.com/InfRandomness", "followers_url": "https://api.github.com/users/InfRandomness/followers", "following_url": "https://api.github.com/users/InfRandomness/following{/other_user}", "gists_url": "https://api.github.com/users/InfRandomness/gists{/gist_id}", "starred_url": "https://api.github.com/users/InfRandomness/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/InfRandomness/subscriptions", "organizations_url": "https://api.github.com/users/InfRandomness/orgs", "repos_url": "https://api.github.com/users/InfRandomness/repos", "events_url": "https://api.github.com/users/InfRandomness/events{/privacy}", "received_events_url": "https://api.github.com/users/InfRandomness/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dbe77e856ad5cf6298de19ce5c2730f2f631b4ef", "url": "https://api.github.com/repos/rust-lang/rust/commits/dbe77e856ad5cf6298de19ce5c2730f2f631b4ef", "html_url": "https://github.com/rust-lang/rust/commit/dbe77e856ad5cf6298de19ce5c2730f2f631b4ef"}], "stats": {"total": 23, "additions": 18, "deletions": 5}, "files": [{"sha": "eb29a5e9ffc4f72f426960616270677c8b94c1c7", "filename": "src/bootstrap/doc.rs", "status": "modified", "additions": 18, "deletions": 5, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/45a69cc215c05bfc283564c9898e9c3704de8c80/src%2Fbootstrap%2Fdoc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/45a69cc215c05bfc283564c9898e9c3704de8c80/src%2Fbootstrap%2Fdoc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdoc.rs?ref=45a69cc215c05bfc283564c9898e9c3704de8c80", "patch": "@@ -643,7 +643,7 @@ impl Step for Rustc {\n }\n \n macro_rules! tool_doc {\n-    ($tool: ident, $should_run: literal, $path: literal, [$($krate: literal),+ $(,)?] $(,)?) => {\n+    ($tool: ident, $should_run: literal, $path: literal, [$($krate: literal),+ $(,)?], in_tree = $in_tree:expr $(,)?) => {\n         #[derive(Debug, Copy, Clone, Hash, PartialEq, Eq)]\n         pub struct $tool {\n             target: TargetSelection,\n@@ -699,6 +699,12 @@ macro_rules! tool_doc {\n                 t!(fs::create_dir_all(&out_dir));\n                 t!(symlink_dir_force(&builder.config, &out, &out_dir));\n \n+                let source_type = if $in_tree == true {\n+                    SourceType::InTree\n+                } else {\n+                    SourceType::Submodule\n+                };\n+\n                 // Build cargo command.\n                 let mut cargo = prepare_tool_cargo(\n                     builder,\n@@ -707,7 +713,7 @@ macro_rules! tool_doc {\n                     target,\n                     \"doc\",\n                     $path,\n-                    SourceType::InTree,\n+                    source_type,\n                     &[],\n                 );\n \n@@ -729,15 +735,22 @@ macro_rules! tool_doc {\n     }\n }\n \n-tool_doc!(Rustdoc, \"rustdoc-tool\", \"src/tools/rustdoc\", [\"rustdoc\", \"rustdoc-json-types\"]);\n+tool_doc!(\n+    Rustdoc,\n+    \"rustdoc-tool\",\n+    \"src/tools/rustdoc\",\n+    [\"rustdoc\", \"rustdoc-json-types\"],\n+    in_tree = true\n+);\n tool_doc!(\n     Rustfmt,\n     \"rustfmt-nightly\",\n     \"src/tools/rustfmt\",\n     [\"rustfmt-nightly\", \"rustfmt-config_proc_macro\"],\n+    in_tree = true\n );\n-tool_doc!(Clippy, \"clippy\", \"src/tools/clippy\", [\"clippy_utils\"]);\n-tool_doc!(Miri, \"miri\", \"src/tools/miri\", [\"miri\"]);\n+tool_doc!(Clippy, \"clippy\", \"src/tools/clippy\", [\"clippy_utils\"], in_tree = true);\n+tool_doc!(Miri, \"miri\", \"src/tools/miri\", [\"miri\"], in_tree = false);\n \n #[derive(Ord, PartialOrd, Debug, Copy, Clone, Hash, PartialEq, Eq)]\n pub struct ErrorIndex {"}]}