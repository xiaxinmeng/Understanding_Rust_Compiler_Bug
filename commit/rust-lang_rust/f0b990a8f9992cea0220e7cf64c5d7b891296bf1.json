{"sha": "f0b990a8f9992cea0220e7cf64c5d7b891296bf1", "node_id": "C_kwDOAAsO6NoAKGYwYjk5MGE4Zjk5OTJjZWEwMjIwZTdjZjY0YzVkN2I4OTEyOTZiZjE", "commit": {"author": {"name": "Noah Lev", "email": "camelidcamel@gmail.com", "date": "2021-11-24T18:19:23Z"}, "committer": {"name": "Noah Lev", "email": "camelidcamel@gmail.com", "date": "2021-11-24T18:19:23Z"}, "message": "Remove `-Z force-overflow-checks`\n\nIt was replaced several years ago by the stable option `-C\noverflow-checks`. The goal was to delete the `-Z` flag once users had\nmigrated [1]. Now that it's been several years, it makes sense to delete\nthe old flag.\n\nSee also the discussion on Zulip [2].\n\n[1]: https://github.com/rust-lang/rust/issues/33134#issuecomment-280484097\n[2]: https://rust-lang.zulipchat.com/#narrow/stream/131828-t-compiler/topic/overflow.20checks/near/262497224", "tree": {"sha": "7fdd51e67aec886bdf1f04ab99b59b31ebb01ea3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7fdd51e67aec886bdf1f04ab99b59b31ebb01ea3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f0b990a8f9992cea0220e7cf64c5d7b891296bf1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f0b990a8f9992cea0220e7cf64c5d7b891296bf1", "html_url": "https://github.com/rust-lang/rust/commit/f0b990a8f9992cea0220e7cf64c5d7b891296bf1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f0b990a8f9992cea0220e7cf64c5d7b891296bf1/comments", "author": {"login": "camelid", "id": 37223377, "node_id": "MDQ6VXNlcjM3MjIzMzc3", "avatar_url": "https://avatars.githubusercontent.com/u/37223377?v=4", "gravatar_id": "", "url": "https://api.github.com/users/camelid", "html_url": "https://github.com/camelid", "followers_url": "https://api.github.com/users/camelid/followers", "following_url": "https://api.github.com/users/camelid/following{/other_user}", "gists_url": "https://api.github.com/users/camelid/gists{/gist_id}", "starred_url": "https://api.github.com/users/camelid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/camelid/subscriptions", "organizations_url": "https://api.github.com/users/camelid/orgs", "repos_url": "https://api.github.com/users/camelid/repos", "events_url": "https://api.github.com/users/camelid/events{/privacy}", "received_events_url": "https://api.github.com/users/camelid/received_events", "type": "User", "site_admin": false}, "committer": {"login": "camelid", "id": 37223377, "node_id": "MDQ6VXNlcjM3MjIzMzc3", "avatar_url": "https://avatars.githubusercontent.com/u/37223377?v=4", "gravatar_id": "", "url": "https://api.github.com/users/camelid", "html_url": "https://github.com/camelid", "followers_url": "https://api.github.com/users/camelid/followers", "following_url": "https://api.github.com/users/camelid/following{/other_user}", "gists_url": "https://api.github.com/users/camelid/gists{/gist_id}", "starred_url": "https://api.github.com/users/camelid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/camelid/subscriptions", "organizations_url": "https://api.github.com/users/camelid/orgs", "repos_url": "https://api.github.com/users/camelid/repos", "events_url": "https://api.github.com/users/camelid/events{/privacy}", "received_events_url": "https://api.github.com/users/camelid/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c6a7ca196a707acd65e6cce1d337cd11786c59a5", "url": "https://api.github.com/repos/rust-lang/rust/commits/c6a7ca196a707acd65e6cce1d337cd11786c59a5", "html_url": "https://github.com/rust-lang/rust/commit/c6a7ca196a707acd65e6cce1d337cd11786c59a5"}], "stats": {"total": 15, "additions": 4, "deletions": 11}, "files": [{"sha": "6147311af6159a0e36616714b4d8b67f87ed6b01", "filename": "compiler/rustc_interface/src/tests.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f0b990a8f9992cea0220e7cf64c5d7b891296bf1/compiler%2Frustc_interface%2Fsrc%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f0b990a8f9992cea0220e7cf64c5d7b891296bf1/compiler%2Frustc_interface%2Fsrc%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_interface%2Fsrc%2Ftests.rs?ref=f0b990a8f9992cea0220e7cf64c5d7b891296bf1", "patch": "@@ -726,7 +726,6 @@ fn test_debugging_options_tracking_hash() {\n     tracked!(dep_info_omit_d_target, true);\n     tracked!(dual_proc_macros, true);\n     tracked!(fewer_names, Some(true));\n-    tracked!(force_overflow_checks, Some(true));\n     tracked!(force_unstable_if_unmarked, true);\n     tracked!(fuel, Some((\"abc\".to_string(), 99)));\n     tracked!(function_sections, Some(false));"}, {"sha": "4165e750df50f4bbdcf5145171d1456691796575", "filename": "compiler/rustc_session/src/options.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f0b990a8f9992cea0220e7cf64c5d7b891296bf1/compiler%2Frustc_session%2Fsrc%2Foptions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f0b990a8f9992cea0220e7cf64c5d7b891296bf1/compiler%2Frustc_session%2Fsrc%2Foptions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_session%2Fsrc%2Foptions.rs?ref=f0b990a8f9992cea0220e7cf64c5d7b891296bf1", "patch": "@@ -1131,8 +1131,6 @@ options! {\n     fewer_names: Option<bool> = (None, parse_opt_bool, [TRACKED],\n         \"reduce memory use by retaining fewer names within compilation artifacts (LLVM-IR) \\\n         (default: no)\"),\n-    force_overflow_checks: Option<bool> = (None, parse_opt_bool, [TRACKED],\n-        \"force overflow checks on or off\"),\n     force_unstable_if_unmarked: bool = (false, parse_bool, [TRACKED],\n         \"force all crates to be `rustc_private` unstable (default: no)\"),\n     fuel: Option<(String, u64)> = (None, parse_optimization_fuel, [TRACKED],"}, {"sha": "54109559a3bb2fd777c493c067a7f2214b5e5166", "filename": "compiler/rustc_session/src/session.rs", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/f0b990a8f9992cea0220e7cf64c5d7b891296bf1/compiler%2Frustc_session%2Fsrc%2Fsession.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f0b990a8f9992cea0220e7cf64c5d7b891296bf1/compiler%2Frustc_session%2Fsrc%2Fsession.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_session%2Fsrc%2Fsession.rs?ref=f0b990a8f9992cea0220e7cf64c5d7b891296bf1", "patch": "@@ -678,11 +678,7 @@ impl Session {\n         self.opts.debugging_opts.sanitizer.contains(SanitizerSet::CFI)\n     }\n     pub fn overflow_checks(&self) -> bool {\n-        self.opts\n-            .cg\n-            .overflow_checks\n-            .or(self.opts.debugging_opts.force_overflow_checks)\n-            .unwrap_or(self.opts.debug_assertions)\n+        self.opts.cg.overflow_checks.unwrap_or(self.opts.debug_assertions)\n     }\n \n     /// Check whether this compile session and crate type use static crt."}, {"sha": "a8633fd87b5e2750ae6261c27cb105e0a71b2a1c", "filename": "src/test/ui/consts/const-err.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f0b990a8f9992cea0220e7cf64c5d7b891296bf1/src%2Ftest%2Fui%2Fconsts%2Fconst-err.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f0b990a8f9992cea0220e7cf64c5d7b891296bf1/src%2Ftest%2Fui%2Fconsts%2Fconst-err.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-err.rs?ref=f0b990a8f9992cea0220e7cf64c5d7b891296bf1", "patch": "@@ -1,5 +1,5 @@\n // build-fail\n-// compile-flags: -Zforce-overflow-checks=on\n+// compile-flags: -C overflow-checks=on\n \n #![allow(arithmetic_overflow)]\n #![warn(const_err)]"}, {"sha": "0098584dd261c8e729f0e379fd25507ec9ce8908", "filename": "src/test/ui/mir/mir_overflow_off.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f0b990a8f9992cea0220e7cf64c5d7b891296bf1/src%2Ftest%2Fui%2Fmir%2Fmir_overflow_off.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f0b990a8f9992cea0220e7cf64c5d7b891296bf1/src%2Ftest%2Fui%2Fmir%2Fmir_overflow_off.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmir%2Fmir_overflow_off.rs?ref=f0b990a8f9992cea0220e7cf64c5d7b891296bf1", "patch": "@@ -1,5 +1,5 @@\n // run-pass\n-// compile-flags: -Z force-overflow-checks=off\n+// compile-flags: -C overflow-checks=off\n \n // Test that with MIR codegen, overflow checks can be\n // turned off, even when they're from core::ops::*."}, {"sha": "9c6dff7e1a6ca151d5d08651d1e9a7a494f9d73d", "filename": "src/test/ui/numbers-arithmetic/int-abs-overflow.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f0b990a8f9992cea0220e7cf64c5d7b891296bf1/src%2Ftest%2Fui%2Fnumbers-arithmetic%2Fint-abs-overflow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f0b990a8f9992cea0220e7cf64c5d7b891296bf1/src%2Ftest%2Fui%2Fnumbers-arithmetic%2Fint-abs-overflow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnumbers-arithmetic%2Fint-abs-overflow.rs?ref=f0b990a8f9992cea0220e7cf64c5d7b891296bf1", "patch": "@@ -1,5 +1,5 @@\n // run-pass\n-// compile-flags: -Z force-overflow-checks=on\n+// compile-flags: -C overflow-checks=on\n // ignore-emscripten no threads support\n \n use std::thread;"}]}