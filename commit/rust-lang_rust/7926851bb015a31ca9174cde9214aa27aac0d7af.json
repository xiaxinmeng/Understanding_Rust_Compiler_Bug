{"sha": "7926851bb015a31ca9174cde9214aa27aac0d7af", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc5MjY4NTFiYjAxNWEzMWNhOTE3NGNkZTkyMTRhYTI3YWFjMGQ3YWY=", "commit": {"author": {"name": "rChaser53", "email": "tayoshizawa29@gmail.com", "date": "2019-10-04T02:25:17Z"}, "committer": {"name": "Seiichi Uchida", "email": "seuchida@gmail.com", "date": "2019-10-04T02:25:16Z"}, "message": "stop to strip 'impl' from impl trait type alias (#3816)", "tree": {"sha": "13633ae3cae77e8283fa10c2a9481c6c83714e01", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/13633ae3cae77e8283fa10c2a9481c6c83714e01"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7926851bb015a31ca9174cde9214aa27aac0d7af", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7926851bb015a31ca9174cde9214aa27aac0d7af", "html_url": "https://github.com/rust-lang/rust/commit/7926851bb015a31ca9174cde9214aa27aac0d7af", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7926851bb015a31ca9174cde9214aa27aac0d7af/comments", "author": {"login": "rchaser53", "id": 9676954, "node_id": "MDQ6VXNlcjk2NzY5NTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/9676954?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchaser53", "html_url": "https://github.com/rchaser53", "followers_url": "https://api.github.com/users/rchaser53/followers", "following_url": "https://api.github.com/users/rchaser53/following{/other_user}", "gists_url": "https://api.github.com/users/rchaser53/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchaser53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchaser53/subscriptions", "organizations_url": "https://api.github.com/users/rchaser53/orgs", "repos_url": "https://api.github.com/users/rchaser53/repos", "events_url": "https://api.github.com/users/rchaser53/events{/privacy}", "received_events_url": "https://api.github.com/users/rchaser53/received_events", "type": "User", "site_admin": false}, "committer": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e28ae8b4a33487bfafd4e4bad2c9bc82f32aa54a", "url": "https://api.github.com/repos/rust-lang/rust/commits/e28ae8b4a33487bfafd4e4bad2c9bc82f32aa54a", "html_url": "https://github.com/rust-lang/rust/commit/e28ae8b4a33487bfafd4e4bad2c9bc82f32aa54a"}], "stats": {"total": 39, "additions": 36, "deletions": 3}, "files": [{"sha": "053e856b9f19caa816425a29a5592f4931b4e8a4", "filename": "src/items.rs", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/7926851bb015a31ca9174cde9214aa27aac0d7af/src%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7926851bb015a31ca9174cde9214aa27aac0d7af/src%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fitems.rs?ref=7926851bb015a31ca9174cde9214aa27aac0d7af", "patch": "@@ -1118,6 +1118,18 @@ pub(crate) fn format_trait(\n     }\n }\n \n+struct OpaqueTypeBounds<'a> {\n+    generic_bounds: &'a ast::GenericBounds,\n+}\n+\n+impl<'a> Rewrite for OpaqueTypeBounds<'a> {\n+    fn rewrite(&self, context: &RewriteContext<'_>, shape: Shape) -> Option<String> {\n+        self.generic_bounds\n+            .rewrite(context, shape)\n+            .map(|s| format!(\"impl {}\", s))\n+    }\n+}\n+\n pub(crate) struct TraitAliasBounds<'a> {\n     generic_bounds: &'a ast::GenericBounds,\n     generics: &'a ast::Generics,\n@@ -1524,13 +1536,14 @@ pub(crate) fn rewrite_opaque_type(\n     generics: &ast::Generics,\n     vis: &ast::Visibility,\n ) -> Option<String> {\n+    let opaque_type_bounds = OpaqueTypeBounds { generic_bounds };\n     rewrite_type_item(\n         context,\n         indent,\n         \"type\",\n         \" =\",\n         ident,\n-        generic_bounds,\n+        &opaque_type_bounds,\n         generics,\n         vis,\n     )"}, {"sha": "33bb9a951596624b1b0bc41195bd2110408fa934", "filename": "tests/source/existential_type.rs", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/7926851bb015a31ca9174cde9214aa27aac0d7af/tests%2Fsource%2Fexistential_type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7926851bb015a31ca9174cde9214aa27aac0d7af/tests%2Fsource%2Fexistential_type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fexistential_type.rs?ref=7926851bb015a31ca9174cde9214aa27aac0d7af", "patch": "@@ -13,3 +13,11 @@ pub type Adderrr<T> = impl Fn(  T  ) -> T;\n impl Foo for Bar {\n type E  = impl Trait;\n }\n+\n+pub type Adder_without_impl<F, T>\n+where\n+    T: Clone,\n+    F: Copy\n+    = Fn(T) -> T;\n+\n+pub type Adderrr_without_impl<T> = Fn(  T  ) -> T;"}, {"sha": "ffc206875b5901eb16bfb90f6d26832afabd65fb", "filename": "tests/target/existential_type.rs", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/7926851bb015a31ca9174cde9214aa27aac0d7af/tests%2Ftarget%2Fexistential_type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7926851bb015a31ca9174cde9214aa27aac0d7af/tests%2Ftarget%2Fexistential_type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fexistential_type.rs?ref=7926851bb015a31ca9174cde9214aa27aac0d7af", "patch": "@@ -6,10 +6,18 @@ pub type Adder<F, T>\n where\n     T: Clone,\n     F: Copy,\n-= Fn(T) -> T;\n+= impl Fn(T) -> T;\n \n-pub type Adderrr<T> = Fn(T) -> T;\n+pub type Adderrr<T> = impl Fn(T) -> T;\n \n impl Foo for Bar {\n     type E = impl Trait;\n }\n+\n+pub type Adder_without_impl<F, T>\n+where\n+    T: Clone,\n+    F: Copy,\n+= Fn(T) -> T;\n+\n+pub type Adderrr_without_impl<T> = Fn(T) -> T;"}, {"sha": "eff27e2de3c16b8125671c5c748074196cc32e30", "filename": "tests/target/issue-3815.rs", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/7926851bb015a31ca9174cde9214aa27aac0d7af/tests%2Ftarget%2Fissue-3815.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7926851bb015a31ca9174cde9214aa27aac0d7af/tests%2Ftarget%2Fissue-3815.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-3815.rs?ref=7926851bb015a31ca9174cde9214aa27aac0d7af", "patch": "@@ -0,0 +1,4 @@\n+pub type Type = impl Deref<Target = i8>;\n+\n+pub type Type =\n+    impl VeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeryLongType<Target = i8>;"}]}