{"sha": "8678baab12dcdac3286d882b2ab83b50ab451248", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg2NzhiYWFiMTJkY2RhYzMyODZkODgyYjJhYjgzYjUwYWI0NTEyNDg=", "commit": {"author": {"name": "Eric Holk", "email": "eric.holk@gmail.com", "date": "2012-05-23T17:15:06Z"}, "committer": {"name": "Eric Holk", "email": "eric.holk@gmail.com", "date": "2012-05-23T17:27:42Z"}, "message": "Resources are once again not copyable.", "tree": {"sha": "3107e32d6ed1f6427fed43ad680244badeaefd60", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3107e32d6ed1f6427fed43ad680244badeaefd60"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8678baab12dcdac3286d882b2ab83b50ab451248", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8678baab12dcdac3286d882b2ab83b50ab451248", "html_url": "https://github.com/rust-lang/rust/commit/8678baab12dcdac3286d882b2ab83b50ab451248", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8678baab12dcdac3286d882b2ab83b50ab451248/comments", "author": {"login": "eholk", "id": 105766, "node_id": "MDQ6VXNlcjEwNTc2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/105766?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eholk", "html_url": "https://github.com/eholk", "followers_url": "https://api.github.com/users/eholk/followers", "following_url": "https://api.github.com/users/eholk/following{/other_user}", "gists_url": "https://api.github.com/users/eholk/gists{/gist_id}", "starred_url": "https://api.github.com/users/eholk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eholk/subscriptions", "organizations_url": "https://api.github.com/users/eholk/orgs", "repos_url": "https://api.github.com/users/eholk/repos", "events_url": "https://api.github.com/users/eholk/events{/privacy}", "received_events_url": "https://api.github.com/users/eholk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "eholk", "id": 105766, "node_id": "MDQ6VXNlcjEwNTc2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/105766?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eholk", "html_url": "https://github.com/eholk", "followers_url": "https://api.github.com/users/eholk/followers", "following_url": "https://api.github.com/users/eholk/following{/other_user}", "gists_url": "https://api.github.com/users/eholk/gists{/gist_id}", "starred_url": "https://api.github.com/users/eholk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eholk/subscriptions", "organizations_url": "https://api.github.com/users/eholk/orgs", "repos_url": "https://api.github.com/users/eholk/repos", "events_url": "https://api.github.com/users/eholk/events{/privacy}", "received_events_url": "https://api.github.com/users/eholk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9f1a197c2a5c16f9703a35331eb53a8c070f66cf", "url": "https://api.github.com/repos/rust-lang/rust/commits/9f1a197c2a5c16f9703a35331eb53a8c070f66cf", "html_url": "https://github.com/rust-lang/rust/commit/9f1a197c2a5c16f9703a35331eb53a8c070f66cf"}], "stats": {"total": 28, "additions": 26, "deletions": 2}, "files": [{"sha": "b3701bd74f425890d0668f3fa74e1c80d0d38661", "filename": "src/rustc/middle/ty.rs", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/8678baab12dcdac3286d882b2ab83b50ab451248/src%2Frustc%2Fmiddle%2Fty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8678baab12dcdac3286d882b2ab83b50ab451248/src%2Frustc%2Fmiddle%2Fty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fmiddle%2Fty.rs?ref=8678baab12dcdac3286d882b2ab83b50ab451248", "patch": "@@ -427,9 +427,9 @@ fn param_bounds_to_kind(bounds: param_bounds) -> kind {\n     for vec::each(*bounds) {|bound|\n         alt bound {\n           bound_copy {\n-            kind = lower_kind(kind, kind_copyable());\n+            kind = raise_kind(kind, kind_copyable());\n           }\n-          bound_send { kind = lower_kind(kind, kind_send_only()); }\n+          bound_send { kind = raise_kind(kind, kind_send_only()); }\n           _ {}\n         }\n     }\n@@ -1284,6 +1284,10 @@ fn kind_send_only() -> kind {\n     kind_(KIND_MASK_SEND)\n }\n \n+fn kind_top() -> kind {\n+    kind_(0xffffffffu32)\n+}\n+\n // Using these query functons is preferable to direct comparison or matching\n // against the kind constants, as we may modify the kind hierarchy in the\n // future.\n@@ -1310,6 +1314,10 @@ fn kind_lteq(a: kind, b: kind) -> bool {\n }\n \n fn lower_kind(a: kind, b: kind) -> kind {\n+    kind_(*a & *b)\n+}\n+\n+fn raise_kind(a: kind, b: kind) -> kind {\n     kind_(*a | *b)\n }\n "}, {"sha": "1a07b3f1de0e09a058ade143289db424ab92efc3", "filename": "src/test/compile-fail/pinned-deep-copy.rs", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/8678baab12dcdac3286d882b2ab83b50ab451248/src%2Ftest%2Fcompile-fail%2Fpinned-deep-copy.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8678baab12dcdac3286d882b2ab83b50ab451248/src%2Ftest%2Fcompile-fail%2Fpinned-deep-copy.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fpinned-deep-copy.rs?ref=8678baab12dcdac3286d882b2ab83b50ab451248", "patch": "@@ -0,0 +1,16 @@\n+// error-pattern: copying a noncopyable value\n+\n+resource r(i: @mut int) {\n+    *i = *i + 1;\n+}\n+\n+fn main() {\n+    let i = @mut 0;\n+    {\n+        // Can't do this copy\n+        let x = ~~~{y: r(i)};\n+        let z = x;\n+        log(debug, x);\n+    }\n+    log(error, *i);\n+}\n\\ No newline at end of file"}]}