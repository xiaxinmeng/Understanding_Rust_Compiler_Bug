{"sha": "dbd2ee015a9a98825a21ee039e32b87d536d60e6", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRiZDJlZTAxNWE5YTk4ODI1YTIxZWUwMzllMzJiODdkNTM2ZDYwZTY=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-09-23T05:15:25Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-09-23T05:15:25Z"}, "message": "Remove is_stateful flag from tydesc. Closes #136", "tree": {"sha": "e40aea38d9c818ce90ac82a598901e576742e8f6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e40aea38d9c818ce90ac82a598901e576742e8f6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/dbd2ee015a9a98825a21ee039e32b87d536d60e6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/dbd2ee015a9a98825a21ee039e32b87d536d60e6", "html_url": "https://github.com/rust-lang/rust/commit/dbd2ee015a9a98825a21ee039e32b87d536d60e6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/dbd2ee015a9a98825a21ee039e32b87d536d60e6/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "33dd7cc85413bc0b5e8b9572f73c01d4d127deff", "url": "https://api.github.com/repos/rust-lang/rust/commits/33dd7cc85413bc0b5e8b9572f73c01d4d127deff", "html_url": "https://github.com/rust-lang/rust/commit/33dd7cc85413bc0b5e8b9572f73c01d4d127deff"}], "stats": {"total": 12, "additions": 5, "deletions": 7}, "files": [{"sha": "2724368bb63513f276a2b3df6c1ead1567073059", "filename": "src/comp/back/abi.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/dbd2ee015a9a98825a21ee039e32b87d536d60e6/src%2Fcomp%2Fback%2Fabi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dbd2ee015a9a98825a21ee039e32b87d536d60e6/src%2Fcomp%2Fback%2Fabi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fback%2Fabi.rs?ref=dbd2ee015a9a98825a21ee039e32b87d536d60e6", "patch": "@@ -41,7 +41,7 @@ const tydesc_field_free_glue: int = 5;\n const tydesc_field_unused: int = 6;\n const tydesc_field_sever_glue: int = 7;\n const tydesc_field_mark_glue: int = 8;\n-const tydesc_field_is_stateful: int = 9;\n+const tydesc_field_unused2: int = 9;\n const tydesc_field_cmp_glue: int = 10;\n const tydesc_field_shape: int = 11;\n const tydesc_field_shape_tables: int = 12;"}, {"sha": "d4083615f489fb7a12ea078addbc7a431d679b79", "filename": "src/comp/middle/trans.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/dbd2ee015a9a98825a21ee039e32b87d536d60e6/src%2Fcomp%2Fmiddle%2Ftrans.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dbd2ee015a9a98825a21ee039e32b87d536d60e6/src%2Fcomp%2Fmiddle%2Ftrans.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Ftrans.rs?ref=dbd2ee015a9a98825a21ee039e32b87d536d60e6", "patch": "@@ -1275,7 +1275,7 @@ fn emit_tydescs(ccx: @crate_ctxt) {\n                             C_null(T_ptr(T_i8())), // unused\n                             C_null(glue_fn_ty), // sever_glue\n                             C_null(glue_fn_ty), // mark_glue\n-                            C_null(glue_fn_ty), // is_stateful\n+                            C_null(glue_fn_ty), // unused\n                             cmp_glue, // cmp_glue\n                             C_shape(ccx, shape), // shape\n                             shape_tables, // shape_tables"}, {"sha": "3d89aa918ceba1197d55e3412f3d157ef713b726", "filename": "src/rt/rust_builtin.cpp", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/dbd2ee015a9a98825a21ee039e32b87d536d60e6/src%2Frt%2Frust_builtin.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/dbd2ee015a9a98825a21ee039e32b87d536d60e6/src%2Frt%2Frust_builtin.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_builtin.cpp?ref=dbd2ee015a9a98825a21ee039e32b87d536d60e6", "patch": "@@ -201,8 +201,8 @@ static void\n debug_tydesc_helper(rust_task *task, type_desc *t)\n {\n     LOG(task, stdlib, \"  size %\" PRIdPTR \", align %\" PRIdPTR\n-        \", stateful %\" PRIdPTR \", first_param 0x%\" PRIxPTR,\n-        t->size, t->align, t->is_stateful, t->first_param);\n+        \", first_param 0x%\" PRIxPTR,\n+        t->size, t->align, t->first_param);\n }\n \n extern \"C\" CDECL void"}, {"sha": "47b402102f3b78ea3a2aa77c66eb44987a05d040", "filename": "src/rt/rust_crate_cache.cpp", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/dbd2ee015a9a98825a21ee039e32b87d536d60e6/src%2Frt%2Frust_crate_cache.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/dbd2ee015a9a98825a21ee039e32b87d536d60e6/src%2Frt%2Frust_crate_cache.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_crate_cache.cpp?ref=dbd2ee015a9a98825a21ee039e32b87d536d60e6", "patch": "@@ -38,8 +38,6 @@ rust_crate_cache::get_type_desc(size_t size,\n                  \"rust_crate_cache::descs[%\" PRIdPTR \"] = 0x%\" PRIxPTR,\n                  i, descs[i]);\n         td->descs[i] = descs[i];\n-        // FIXME (issue #136):  Below is a miscalculation.\n-        td->is_stateful |= descs[i]->is_stateful;\n     }\n     td->n_obj_params = n_obj_params;\n     td->n_params = n_descs - 1;"}, {"sha": "b53e0bfd2a954bfd54b652a82ecff4bd57ef22d8", "filename": "src/rt/rust_internal.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/dbd2ee015a9a98825a21ee039e32b87d536d60e6/src%2Frt%2Frust_internal.h", "raw_url": "https://github.com/rust-lang/rust/raw/dbd2ee015a9a98825a21ee039e32b87d536d60e6/src%2Frt%2Frust_internal.h", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_internal.h?ref=dbd2ee015a9a98825a21ee039e32b87d536d60e6", "patch": "@@ -274,7 +274,7 @@ struct type_desc {\n     void *unused;\n     glue_fn *sever_glue;    // For GC.\n     glue_fn *mark_glue;     // For GC.\n-    uintptr_t is_stateful;\n+    uintptr_t unused2;\n     cmp_glue_fn *cmp_glue;\n     const uint8_t *shape;\n     const rust_shape_tables *shape_tables;"}]}