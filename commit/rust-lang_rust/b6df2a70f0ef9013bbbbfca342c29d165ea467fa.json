{"sha": "b6df2a70f0ef9013bbbbfca342c29d165ea467fa", "node_id": "C_kwDOAAsO6NoAKGI2ZGYyYTcwZjBlZjkwMTNiYmJiZmNhMzQyYzI5ZDE2NWVhNDY3ZmE", "commit": {"author": {"name": "Pietro Albini", "email": "pietro.albini@ferrous-systems.com", "date": "2022-06-30T07:54:51Z"}, "committer": {"name": "Pietro Albini", "email": "pietro.albini@ferrous-systems.com", "date": "2022-07-11T08:13:35Z"}, "message": "remove the need to update bump-stage0 with new stage0 config fields", "tree": {"sha": "ac5c562094f0fe211e0501c40293bc4294520bd3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ac5c562094f0fe211e0501c40293bc4294520bd3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b6df2a70f0ef9013bbbbfca342c29d165ea467fa", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIyBAABCgAdFiEEMycKYjxLY0eb13b7zXazX3c0dp4FAmLL268ACgkQzXazX3c0\ndp7byQ/3asVo6zGPb4BHPtoZVFE4JrAdLXAiNusOi7pjPL61xqWvGSAjMOvCXtcz\nR/8cm0hoKmK5pvEodEmBL1TlOoReFJFcb0Jr33LESzD8Om61PjjdBuzPr0idGWGr\nVhVEfQFzu9e56fLD346oR7V/5VyVujbf01miP7HiLgdG4CgEbKtZSdw4/Ro0+bB5\nsXz0dMftTHkj1sSlj9ZNjCzsTZL0Abmx71TFFfzE1xJeDxivyNqUut3SrWyQWrd8\nP0zBolcgCey4JRkDqC+Nzv2RgTYuktr0rrpOFUgAMjqwoBh6Qa29jWwaW1zoPWVa\n8LpOxws6s+IcHb/WNdnrEg7/TQdratX4E1+pMosjP1fI2xHlEFWEgIERGuypOhTy\njpdBLVyfB2wpV1ZplhaUhTzt79VVBU6q8VCvlRD+/gyKTAZIISlS4zvz8ySvAFP2\nrMHF1cMoW6Kjpx+CCg6yP6kd2NuQTMZDjStBVfilhQhb0dUGzsCrt851YZioJzI5\nr+0/+gCSRLGElQFKPY6HfKqHS1d6fvWWrlZZVLli979hCO1zqWBQ2y5WWgC3r53p\nlP7kEK8DN+qENw+SxQAyTvr9N5R8C8gtsKyPg3OIpYrfGB+kPGWkTi9xk0+diHT8\nz/jdmzhCWobKIqGlZ5uH/zMgETB4BVpzswvxKp9d+ZKOlXmuyw==\n=WsMQ\n-----END PGP SIGNATURE-----", "payload": "tree ac5c562094f0fe211e0501c40293bc4294520bd3\nparent a51fb2ba827f24ec4d676a9575a0a5e46afd302a\nauthor Pietro Albini <pietro.albini@ferrous-systems.com> 1656575691 +0200\ncommitter Pietro Albini <pietro.albini@ferrous-systems.com> 1657527215 +0200\n\nremove the need to update bump-stage0 with new stage0 config fields\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b6df2a70f0ef9013bbbbfca342c29d165ea467fa", "html_url": "https://github.com/rust-lang/rust/commit/b6df2a70f0ef9013bbbbfca342c29d165ea467fa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b6df2a70f0ef9013bbbbfca342c29d165ea467fa/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a51fb2ba827f24ec4d676a9575a0a5e46afd302a", "url": "https://api.github.com/repos/rust-lang/rust/commits/a51fb2ba827f24ec4d676a9575a0a5e46afd302a", "html_url": "https://github.com/rust-lang/rust/commit/a51fb2ba827f24ec4d676a9575a0a5e46afd302a"}], "stats": {"total": 11, "additions": 7, "deletions": 4}, "files": [{"sha": "352a855561417c9981f2a5722d55be70a53e3faf", "filename": "src/tools/bump-stage0/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b6df2a70f0ef9013bbbbfca342c29d165ea467fa/src%2Ftools%2Fbump-stage0%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/b6df2a70f0ef9013bbbbfca342c29d165ea467fa/src%2Ftools%2Fbump-stage0%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbump-stage0%2FCargo.toml?ref=b6df2a70f0ef9013bbbbfca342c29d165ea467fa", "patch": "@@ -10,5 +10,5 @@ anyhow = \"1.0.34\"\n curl = \"0.4.38\"\n indexmap = { version = \"1.7.0\", features = [\"serde\"] }\n serde = { version = \"1.0.125\", features = [\"derive\"] }\n-serde_json = \"1.0.59\"\n+serde_json = { version = \"1.0.59\", features = [\"preserve_order\"] }\n toml = \"0.5.7\""}, {"sha": "aa346daf7e5f3a4b99d45b8440aab47507b095e4", "filename": "src/tools/bump-stage0/src/main.rs", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/b6df2a70f0ef9013bbbbfca342c29d165ea467fa/src%2Ftools%2Fbump-stage0%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b6df2a70f0ef9013bbbbfca342c29d165ea467fa/src%2Ftools%2Fbump-stage0%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbump-stage0%2Fsrc%2Fmain.rs?ref=b6df2a70f0ef9013bbbbfca342c29d165ea467fa", "patch": "@@ -198,9 +198,12 @@ struct Stage0 {\n #[derive(Debug, serde::Serialize, serde::Deserialize)]\n struct Config {\n     dist_server: String,\n-    artifacts_server: String,\n-    artifacts_with_llvm_assertions_server: String,\n-    git_merge_commit_email: String,\n+    // There are other fields in the configuration, which will be read by src/bootstrap or other\n+    // tools consuming stage0.json. To avoid the need to update bump-stage0 every time a new field\n+    // is added, we collect all the fields in an untyped Value and serialize them back with the\n+    // same order and structure they were deserialized in.\n+    #[serde(flatten)]\n+    other: serde_json::Value,\n }\n \n #[derive(Debug, serde::Serialize, serde::Deserialize)]"}]}