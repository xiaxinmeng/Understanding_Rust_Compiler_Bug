{"sha": "5144f790fe7c57224ba164ca0ecc81cfcc4ddd20", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUxNDRmNzkwZmU3YzU3MjI0YmExNjRjYTBlY2M4MWNmY2M0ZGRkMjA=", "commit": {"author": {"name": "Marijn Haverbeke", "email": "marijnh@gmail.com", "date": "2011-06-02T14:45:26Z"}, "committer": {"name": "Marijn Haverbeke", "email": "marijnh@gmail.com", "date": "2011-06-02T14:45:26Z"}, "message": "Fix and un-xfail vec-append test", "tree": {"sha": "e728d419107cba6225e046d6150836f40fb8fe83", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e728d419107cba6225e046d6150836f40fb8fe83"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5144f790fe7c57224ba164ca0ecc81cfcc4ddd20", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5144f790fe7c57224ba164ca0ecc81cfcc4ddd20", "html_url": "https://github.com/rust-lang/rust/commit/5144f790fe7c57224ba164ca0ecc81cfcc4ddd20", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5144f790fe7c57224ba164ca0ecc81cfcc4ddd20/comments", "author": {"login": "marijnh", "id": 144427, "node_id": "MDQ6VXNlcjE0NDQyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/144427?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marijnh", "html_url": "https://github.com/marijnh", "followers_url": "https://api.github.com/users/marijnh/followers", "following_url": "https://api.github.com/users/marijnh/following{/other_user}", "gists_url": "https://api.github.com/users/marijnh/gists{/gist_id}", "starred_url": "https://api.github.com/users/marijnh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marijnh/subscriptions", "organizations_url": "https://api.github.com/users/marijnh/orgs", "repos_url": "https://api.github.com/users/marijnh/repos", "events_url": "https://api.github.com/users/marijnh/events{/privacy}", "received_events_url": "https://api.github.com/users/marijnh/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marijnh", "id": 144427, "node_id": "MDQ6VXNlcjE0NDQyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/144427?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marijnh", "html_url": "https://github.com/marijnh", "followers_url": "https://api.github.com/users/marijnh/followers", "following_url": "https://api.github.com/users/marijnh/following{/other_user}", "gists_url": "https://api.github.com/users/marijnh/gists{/gist_id}", "starred_url": "https://api.github.com/users/marijnh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marijnh/subscriptions", "organizations_url": "https://api.github.com/users/marijnh/orgs", "repos_url": "https://api.github.com/users/marijnh/repos", "events_url": "https://api.github.com/users/marijnh/events{/privacy}", "received_events_url": "https://api.github.com/users/marijnh/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "75ffe657dbd202cf22175f0234e80f4e09c5d499", "url": "https://api.github.com/repos/rust-lang/rust/commits/75ffe657dbd202cf22175f0234e80f4e09c5d499", "html_url": "https://github.com/rust-lang/rust/commit/75ffe657dbd202cf22175f0234e80f4e09c5d499"}], "stats": {"total": 15, "additions": 7, "deletions": 8}, "files": [{"sha": "9df30a385875e9f0c2c61d7de834a5e4418bdc60", "filename": "src/lib/str.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5144f790fe7c57224ba164ca0ecc81cfcc4ddd20/src%2Flib%2Fstr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5144f790fe7c57224ba164ca0ecc81cfcc4ddd20/src%2Flib%2Fstr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib%2Fstr.rs?ref=5144f790fe7c57224ba164ca0ecc81cfcc4ddd20", "patch": "@@ -336,8 +336,9 @@ fn refcount(str s) -> uint {\n     if (r == dbg::const_refcount) {\n         ret r;\n     } else {\n-        // -1 because calling this function incremented the refcount.\n-        ret  r - 1u;\n+        // -2 because calling this function and the native function both\n+        // incremented the refcount.\n+        ret  r - 2u;\n     }\n }\n "}, {"sha": "969fca9a17ed5b389f9a7e4ede7a681a7f40a5f2", "filename": "src/lib/vec.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5144f790fe7c57224ba164ca0ecc81cfcc4ddd20/src%2Flib%2Fvec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5144f790fe7c57224ba164ca0ecc81cfcc4ddd20/src%2Flib%2Fvec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib%2Fvec.rs?ref=5144f790fe7c57224ba164ca0ecc81cfcc4ddd20", "patch": "@@ -50,8 +50,9 @@ fn refcount[T](array[T] v) -> uint {\n     if (r == dbg::const_refcount) {\n         ret r;\n     } else {\n-        // -1 because calling this function incremented the refcount.\n-        ret  r - 1u;\n+        // -2 because calling this function and the native function both\n+        // incremented the refcount.\n+        ret  r - 2u;\n     }\n }\n "}, {"sha": "f7404852063a20cef5d82d2d3d6867279a321d92", "filename": "src/test/run-pass/vec-append.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5144f790fe7c57224ba164ca0ecc81cfcc4ddd20/src%2Ftest%2Frun-pass%2Fvec-append.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5144f790fe7c57224ba164ca0ecc81cfcc4ddd20/src%2Ftest%2Frun-pass%2Fvec-append.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fvec-append.rs?ref=5144f790fe7c57224ba164ca0ecc81cfcc4ddd20", "patch": "@@ -1,6 +1,3 @@\n-// xfail-stage0\n-// xfail-stage1\n-// xfail-stage2\n // -*- rust -*-\n \n use std;\n@@ -51,13 +48,13 @@ fn slow_growth2_helper(str s) {   // ref up: s\n      * mumble, the existing str in the originally- shared vec.\n      */\n     let vec[str] v = [mumble]; // ref up: v, mumble\n+    log vec::refcount[str](v);\n     let acc a = acc(v);           // ref up: a, v\n \n     log vec::refcount[str](v);\n     assert (vec::refcount[str](v) == 2u);\n \n     a.add(s);                     // ref up: mumble, s.  ref down: v\n-\n     log vec::refcount[str](v);\n     log str::refcount(s);\n     log str::refcount(mumble);"}]}