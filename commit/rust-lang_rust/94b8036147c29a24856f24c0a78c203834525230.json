{"sha": "94b8036147c29a24856f24c0a78c203834525230", "node_id": "C_kwDOAAsO6NoAKDk0YjgwMzYxNDdjMjlhMjQ4NTZmMjRjMGE3OGMyMDM4MzQ1MjUyMzA", "commit": {"author": {"name": "Dylan DPC", "email": "99973273+Dylan-DPC@users.noreply.github.com", "date": "2022-05-31T05:57:32Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-05-31T05:57:32Z"}, "message": "Rollup merge of #97089 - GuillaumeGomez:improve-settings-theme-display, r=jsha\n\nImprove settings theme display\n\nThis is a follow-up of #96958. In this PR, I changed how the theme radio buttons are displayed and improved their look as well.\n\nIt now looks like this:\n\n![Screenshot from 2022-05-17 20-46-20](https://user-images.githubusercontent.com/3050060/168887703-a01e3bd5-9644-4012-ac11-2ae7bacd6be6.png)\n![Screenshot from 2022-05-17 20-46-12](https://user-images.githubusercontent.com/3050060/168887707-132f8b2d-1163-462f-b7dd-f861121bdee7.png)\n\nYou can test it [here](https://rustdoc.crud.net/imperio/improve-settings-theme-display/doc/foo/index.html).\n\nr? `@jsha`", "tree": {"sha": "8adbbb3c29832954a93b86cd88190819ee86ccbd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8adbbb3c29832954a93b86cd88190819ee86ccbd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/94b8036147c29a24856f24c0a78c203834525230", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJila5MCRBK7hj4Ov3rIwAAcz0IAIgR+qryG/rzGz2H1herTvRp\nBXG4Os51etVZ5GqunP20ltzazQ0caSBRpASDIqT/jBKILykYbkmTnHJ21CmQHFYU\n4dF65dr2RY4lS5OI6M/gjv5vT4KwYMCQqcjquYgyNcPxhTzBiDgOpBJTENBjn59O\nz02KXbCGpN28HCNNxD1zNkWZdfcesQzzv0YQt5r/55Ep/kuIZOAH3Ltjy+LmM/lk\nodfDq88McmekdS51ZmbrCOXUFs0JZH708dVSi+uXWX4GVjNRZnvk3FOEJSnuFdvv\nR/BhaCqiySwwaWYvW5w+GuH8Gxy68jdGI/EDFNIpai8YNjYiiGOMuCAK2yF2rE8=\n=2Ega\n-----END PGP SIGNATURE-----\n", "payload": "tree 8adbbb3c29832954a93b86cd88190819ee86ccbd\nparent 47365c0d656e2e55d1b6b9dad92842540e3ed1af\nparent 70db59ca3534d00227d903e10149e5fb677c0067\nauthor Dylan DPC <99973273+Dylan-DPC@users.noreply.github.com> 1653976652 +0200\ncommitter GitHub <noreply@github.com> 1653976652 +0200\n\nRollup merge of #97089 - GuillaumeGomez:improve-settings-theme-display, r=jsha\n\nImprove settings theme display\n\nThis is a follow-up of #96958. In this PR, I changed how the theme radio buttons are displayed and improved their look as well.\n\nIt now looks like this:\n\n![Screenshot from 2022-05-17 20-46-20](https://user-images.githubusercontent.com/3050060/168887703-a01e3bd5-9644-4012-ac11-2ae7bacd6be6.png)\n![Screenshot from 2022-05-17 20-46-12](https://user-images.githubusercontent.com/3050060/168887707-132f8b2d-1163-462f-b7dd-f861121bdee7.png)\n\nYou can test it [here](https://rustdoc.crud.net/imperio/improve-settings-theme-display/doc/foo/index.html).\n\nr? `@jsha`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/94b8036147c29a24856f24c0a78c203834525230", "html_url": "https://github.com/rust-lang/rust/commit/94b8036147c29a24856f24c0a78c203834525230", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/94b8036147c29a24856f24c0a78c203834525230/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "47365c0d656e2e55d1b6b9dad92842540e3ed1af", "url": "https://api.github.com/repos/rust-lang/rust/commits/47365c0d656e2e55d1b6b9dad92842540e3ed1af", "html_url": "https://github.com/rust-lang/rust/commit/47365c0d656e2e55d1b6b9dad92842540e3ed1af"}, {"sha": "70db59ca3534d00227d903e10149e5fb677c0067", "url": "https://api.github.com/repos/rust-lang/rust/commits/70db59ca3534d00227d903e10149e5fb677c0067", "html_url": "https://github.com/rust-lang/rust/commit/70db59ca3534d00227d903e10149e5fb677c0067"}], "stats": {"total": 224, "additions": 177, "deletions": 47}, "files": [{"sha": "1cd8e39e03648ad5eed7fd213c1aa0f2ebd7f9ed", "filename": "src/librustdoc/html/static/css/settings.css", "status": "modified", "additions": 20, "deletions": 33, "changes": 53, "blob_url": "https://github.com/rust-lang/rust/blob/94b8036147c29a24856f24c0a78c203834525230/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fsettings.css", "raw_url": "https://github.com/rust-lang/rust/raw/94b8036147c29a24856f24c0a78c203834525230/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fsettings.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fsettings.css?ref=94b8036147c29a24856f24c0a78c203834525230", "patch": "@@ -3,44 +3,40 @@\n \tposition: relative;\n }\n \n-.setting-line > div {\n-\tdisplay: inline-block;\n-\tvertical-align: top;\n-\tfont-size: 17px;\n-\tpadding-top: 2px;\n-}\n-\n-.setting-line > .title {\n-\tfont-size: 19px;\n-\twidth: 100%;\n-\tmax-width: none;\n-\tborder-bottom: 1px solid;\n-}\n-\n-.setting-line .radio-line,\n .setting-line .choices {\n \tdisplay: flex;\n \tflex-wrap: wrap;\n }\n \n-.setting-line .radio-line .setting-name {\n-\tflex-grow: 1;\n-\tmargin-top: auto;\n-\tmargin-bottom: auto;\n-}\n-\n .setting-line .radio-line input {\n \tmargin-right: 0.3em;\n+\theight: 1.2rem;\n+\twidth: 1.2rem;\n+\tborder: 1px solid;\n+\toutline: none;\n+\t-webkit-appearance: none;\n+\tcursor: pointer;\n+\tborder-radius: 50%;\n+}\n+.setting-line .radio-line input + span {\n+\tpadding-bottom: 1px;\n+}\n+\n+.radio-line .setting-name {\n+\twidth: 100%;\n }\n \n .radio-line .choice {\n-\tborder-radius: 0.1em;\n-\tborder: 1px solid;\n-\tmargin-left: 0.5em;\n \tmargin-top: 0.1em;\n \tmargin-bottom: 0.1em;\n \tmin-width: 3.8em;\n \tpadding: 0.3em;\n+\tdisplay: flex;\n+\talign-items: center;\n+\tcursor: pointer;\n+}\n+.radio-line .choice + .choice {\n+\tmargin-left: 0.5em;\n }\n \n .toggle {\n@@ -77,18 +73,9 @@\n \twidth: 19px;\n \tleft: 4px;\n \tbottom: 4px;\n-\tbackground-color: white;\n \ttransition: .3s;\n }\n \n-input:checked + .slider {\n-\tbackground-color: #2196F3;\n-}\n-\n-input:focus + .slider {\n-\tbox-shadow: 0 0 0 2px #0a84ff, 0 0 0 6px rgba(10, 132, 255, 0.3);\n-}\n-\n input:checked + .slider:before {\n \ttransform: translateX(19px);\n }"}, {"sha": "7303cecc0d61a54443ebcf1a396afaccdda4d28a", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 32, "deletions": 7, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/94b8036147c29a24856f24c0a78c203834525230/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/94b8036147c29a24856f24c0a78c203834525230/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=94b8036147c29a24856f24c0a78c203834525230", "patch": "@@ -10,6 +10,38 @@ body, #settings-menu #settings, #settings-menu #settings::before {\n \tcolor: #c5c5c5;\n }\n \n+.setting-line .radio-line input {\n+\tborder-color: #c5c5c5;\n+}\n+.setting-line .radio-line input:checked {\n+\tbox-shadow: inset 0 0 0 3px #0f1419;\n+\tbackground-color: #ffb454;\n+}\n+.setting-line .radio-line input:focus {\n+\tbox-shadow: 0 0 1px 1px #ffb454;\n+}\n+/* In here we combine both `:focus` and `:checked` properties. */\n+.setting-line .radio-line input:checked:focus {\n+\tbox-shadow: inset 0 0 0 3px 0f1419,\n+\t\t0 0 2px 2px #ffb454;\n+}\n+.setting-line .radio-line input:hover {\n+\tborder-color: #ffb454 !important;\n+}\n+\n+.slider {\n+\tbackground-color: #ccc;\n+}\n+.slider:before {\n+\tbackground-color: white;\n+}\n+input:checked + .slider {\n+\tbackground-color: #ffb454;\n+}\n+input:focus + .slider {\n+\tbox-shadow: 0 0 0 2px #0a84ff, 0 0 0 6px rgba(10, 132, 255, 0.3);\n+}\n+\n h1, h2, h3, h4 {\n \tcolor: white;\n }\n@@ -601,13 +633,6 @@ div.files > .selected {\n \tbackground-color: #14191f;\n \tcolor: #ffb44c;\n }\n-.setting-line > .title {\n-\tborder-bottom-color: #5c6773;\n-}\n-input:checked + .slider {\n-\tbackground-color: #ffb454 !important;\n-}\n-\n \n .scraped-example-list .scrape-help {\n \tborder-color: #aaa;"}, {"sha": "34a4f446b560b49235c3c2181dd3f27ab49bc716", "filename": "src/librustdoc/html/static/css/themes/dark.css", "status": "modified", "additions": 32, "deletions": 3, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/94b8036147c29a24856f24c0a78c203834525230/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/94b8036147c29a24856f24c0a78c203834525230/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css?ref=94b8036147c29a24856f24c0a78c203834525230", "patch": "@@ -3,6 +3,38 @@ body, #settings-menu #settings, #settings-menu #settings::before {\n \tcolor: #ddd;\n }\n \n+.setting-line .radio-line input {\n+\tborder-color: #ddd;\n+}\n+.setting-line .radio-line input:checked {\n+\tbox-shadow: inset 0 0 0 3px #353535;\n+\tbackground-color: #2196f3;\n+}\n+.setting-line .radio-line input:focus {\n+\tbox-shadow: 0 0 1px 1px #2196f3;\n+}\n+/* In here we combine both `:focus` and `:checked` properties. */\n+.setting-line .radio-line input:checked:focus {\n+\tbox-shadow: inset 0 0 0 3px #353535,\n+\t\t0 0 2px 2px #2196f3;\n+}\n+.setting-line .radio-line input:hover {\n+\tborder-color: #2196f3 !important;\n+}\n+\n+.slider {\n+\tbackground-color: #ccc;\n+}\n+.slider:before {\n+\tbackground-color: white;\n+}\n+input:checked + .slider {\n+\tbackground-color: #2196F3;\n+}\n+input:focus + .slider {\n+\tbox-shadow: 0 0 0 2px #0a84ff, 0 0 0 6px rgba(10, 132, 255, 0.3);\n+}\n+\n h1, h2, h3, h4 {\n \tcolor: #ddd;\n }\n@@ -472,9 +504,6 @@ div.files > a:hover, div.name:hover {\n div.files > .selected {\n \tbackground-color: #333;\n }\n-.setting-line > .title {\n-\tborder-bottom-color: #ddd;\n-}\n \n .scraped-example-list .scrape-help {\n \tborder-color: #aaa;"}, {"sha": "aa6ad2f547333aca23e756dad35f1c0ce52dc1f5", "filename": "src/librustdoc/html/static/css/themes/light.css", "status": "modified", "additions": 32, "deletions": 3, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/94b8036147c29a24856f24c0a78c203834525230/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/94b8036147c29a24856f24c0a78c203834525230/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css?ref=94b8036147c29a24856f24c0a78c203834525230", "patch": "@@ -5,6 +5,38 @@ body, #settings-menu #settings, #settings-menu #settings::before {\n \tcolor: black;\n }\n \n+.setting-line .radio-line input {\n+\tborder-color: black;\n+}\n+.setting-line .radio-line input:checked {\n+\tbox-shadow: inset 0 0 0 3px white;\n+\tbackground-color: #2196f3;\n+}\n+.setting-line .radio-line input:focus {\n+\tbox-shadow: 0 0 1px 1px #2196f3;\n+}\n+/* In here we combine both `:focus` and `:checked` properties. */\n+.setting-line .radio-line input:checked:focus {\n+\tbox-shadow: inset 0 0 0 3px white,\n+\t\t0 0 2px 2px #2196f3;\n+}\n+.setting-line .radio-line input:hover {\n+\tborder-color: #2196f3 !important;\n+}\n+\n+.slider {\n+\tbackground-color: #ccc;\n+}\n+.slider:before {\n+\tbackground-color: white;\n+}\n+input:checked + .slider {\n+\tbackground-color: #2196F3;\n+}\n+input:focus + .slider {\n+\tbox-shadow: 0 0 0 2px #0a84ff, 0 0 0 6px rgba(10, 132, 255, 0.3);\n+}\n+\n h1, h2, h3, h4 {\n \tcolor: black;\n }\n@@ -456,9 +488,6 @@ div.files > a:hover, div.name:hover {\n div.files > .selected {\n \tbackground-color: #fff;\n }\n-.setting-line > .title {\n-\tborder-bottom-color: #D5D5D5;\n-}\n \n .scraped-example-list .scrape-help {\n \tborder-color: #555;"}, {"sha": "41bf0ec8955805ec9e1178a4a61da850689d152c", "filename": "src/librustdoc/html/static/js/settings.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/94b8036147c29a24856f24c0a78c203834525230/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js", "raw_url": "https://github.com/rust-lang/rust/raw/94b8036147c29a24856f24c0a78c203834525230/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js?ref=94b8036147c29a24856f24c0a78c203834525230", "patch": "@@ -123,7 +123,7 @@\n                     output += `<label for=\"${js_data_name}-${option}\" class=\"choice\">\\\n                            <input type=\"radio\" name=\"${js_data_name}\" \\\n                                 id=\"${js_data_name}-${option}\" value=\"${option}\"${checked}>\\\n-                           ${option}\\\n+                           <span>${option}</span>\\\n                          </label>`;\n                 });\n                 output += \"</div></div>\";"}, {"sha": "237a4751a8d6677c669d7c14ac91e4976e5dc783", "filename": "src/test/rustdoc-gui/settings.goml", "status": "modified", "additions": 60, "deletions": 0, "changes": 60, "blob_url": "https://github.com/rust-lang/rust/blob/94b8036147c29a24856f24c0a78c203834525230/src%2Ftest%2Frustdoc-gui%2Fsettings.goml", "raw_url": "https://github.com/rust-lang/rust/raw/94b8036147c29a24856f24c0a78c203834525230/src%2Ftest%2Frustdoc-gui%2Fsettings.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsettings.goml?ref=94b8036147c29a24856f24c0a78c203834525230", "patch": "@@ -1,5 +1,6 @@\n // This test ensures that the settings menu display is working as expected.\n goto: file://|DOC_PATH|/test_docs/index.html\n+show-text: true // needed when we check for colors below.\n // First, we check that the settings page doesn't exist.\n assert-false: \"#settings\"\n // We now click on the settings button.\n@@ -43,6 +44,65 @@ assert: \".setting-line.hidden #preferred-light-theme\"\n // We check that the correct theme is selected.\n assert-property: (\"#theme .choices #theme-dark\", {\"checked\": \"true\"})\n \n+// Some style checks...\n+// First we check the \"default\" display.\n+assert-css: (\n+    \"#theme-dark\",\n+    {\n+        \"border-color\": \"rgb(221, 221, 221)\",\n+        \"box-shadow\": \"rgb(53, 53, 53) 0px 0px 0px 3px inset\",\n+    },\n+)\n+assert-css: (\"#theme-light\", {\"border-color\": \"rgb(221, 221, 221)\", \"box-shadow\": \"none\"})\n+// Let's start with the hover.\n+move-cursor-to: \"#theme-dark\"\n+assert-css: (\n+    \"#theme-dark\",\n+    {\n+        \"border-color\": \"rgb(33, 150, 243)\",\n+        \"box-shadow\": \"rgb(53, 53, 53) 0px 0px 0px 3px inset\",\n+    },\n+)\n+move-cursor-to: \"#theme-light\"\n+assert-css: (\"#theme-light\", {\"border-color\": \"rgb(33, 150, 243)\", \"box-shadow\": \"none\"})\n+move-cursor-to: \"#theme-ayu\"\n+// Let's now check with the focus.\n+focus: \"#theme-dark\"\n+assert-css: (\n+    \"#theme-dark\",\n+    {\n+        \"border-color\": \"rgb(221, 221, 221)\",\n+        \"box-shadow\": \"rgb(53, 53, 53) 0px 0px 0px 3px inset, rgb(33, 150, 243) 0px 0px 2px 2px\",\n+    },\n+)\n+focus: \"#theme-light\"\n+assert-css: (\n+    \"#theme-light\",\n+    {\n+        \"border-color\": \"rgb(221, 221, 221)\",\n+        \"box-shadow\": \"rgb(33, 150, 243) 0px 0px 1px 1px\",\n+    },\n+)\n+// Now we check we both focus and hover.\n+move-cursor-to: \"#theme-dark\"\n+focus: \"#theme-dark\"\n+assert-css: (\n+    \"#theme-dark\",\n+    {\n+        \"border-color\": \"rgb(33, 150, 243)\",\n+        \"box-shadow\": \"rgb(53, 53, 53) 0px 0px 0px 3px inset, rgb(33, 150, 243) 0px 0px 2px 2px\",\n+    },\n+)\n+move-cursor-to: \"#theme-light\"\n+focus: \"#theme-light\"\n+assert-css: (\n+    \"#theme-light\",\n+    {\n+        \"border-color\": \"rgb(33, 150, 243)\",\n+        \"box-shadow\": \"rgb(33, 150, 243) 0px 0px 1px 1px\",\n+    },\n+)\n+\n // We now switch the display.\n click: \"#use-system-theme\"\n // Wait for the hidden element to show up."}]}