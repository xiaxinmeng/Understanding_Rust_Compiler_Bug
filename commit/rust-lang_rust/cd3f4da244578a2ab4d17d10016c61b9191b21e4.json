{"sha": "cd3f4da244578a2ab4d17d10016c61b9191b21e4", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNkM2Y0ZGEyNDQ1NzhhMmFiNGQxN2QxMDAxNmM2MWI5MTkxYjIxZTQ=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2021-09-15T11:37:29Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2021-09-17T15:32:57Z"}, "message": "Add rustdoc version into the help popup", "tree": {"sha": "c0f129281b79da59a8a64079e6e2da4caf60eb72", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c0f129281b79da59a8a64079e6e2da4caf60eb72"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cd3f4da244578a2ab4d17d10016c61b9191b21e4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cd3f4da244578a2ab4d17d10016c61b9191b21e4", "html_url": "https://github.com/rust-lang/rust/commit/cd3f4da244578a2ab4d17d10016c61b9191b21e4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cd3f4da244578a2ab4d17d10016c61b9191b21e4/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e0c38af27cb5f6f961809601b717d6afc3b190ee", "url": "https://api.github.com/repos/rust-lang/rust/commits/e0c38af27cb5f6f961809601b717d6afc3b190ee", "html_url": "https://github.com/rust-lang/rust/commit/e0c38af27cb5f6f961809601b717d6afc3b190ee"}], "stats": {"total": 52, "additions": 39, "deletions": 13}, "files": [{"sha": "c1a83ad5820cb9067b329fc6590f783755198349", "filename": "src/librustdoc/html/render/write_shared.rs", "status": "modified", "additions": 12, "deletions": 4, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/cd3f4da244578a2ab4d17d10016c61b9191b21e4/src%2Flibrustdoc%2Fhtml%2Frender%2Fwrite_shared.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cd3f4da244578a2ab4d17d10016c61b9191b21e4/src%2Flibrustdoc%2Fhtml%2Frender%2Fwrite_shared.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fwrite_shared.rs?ref=cd3f4da244578a2ab4d17d10016c61b9191b21e4", "patch": "@@ -268,10 +268,18 @@ pub(super) fn write_shared(\n     // Maybe we can change the representation to move this out of main.js?\n     write_minify(\n         \"main.js\",\n-        static_files::MAIN_JS.replace(\n-            \"/* INSERT THEMES HERE */\",\n-            &format!(\" = {}\", serde_json::to_string(&themes).unwrap()),\n-        ),\n+        static_files::MAIN_JS\n+            .replace(\n+                \"/* INSERT THEMES HERE */\",\n+                &format!(\" = {}\", serde_json::to_string(&themes).unwrap()),\n+            )\n+            .replace(\n+                \"/* INSERT RUSTDOC_VERSION HERE */\",\n+                &format!(\n+                    \"rustdoc {}\",\n+                    rustc_interface::util::version_str().unwrap_or(\"unknown version\")\n+                ),\n+            ),\n         cx,\n         options,\n     )?;"}, {"sha": "eb7cc9309f41641c6212ca6e244e8ad6fd5b43ef", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 12, "deletions": 3, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/cd3f4da244578a2ab4d17d10016c61b9191b21e4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/cd3f4da244578a2ab4d17d10016c61b9191b21e4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=cd3f4da244578a2ab4d17d10016c61b9191b21e4", "patch": "@@ -928,15 +928,24 @@ body.blur > :not(#help) {\n \tdisplay: block;\n \tmargin-right: 0.5rem;\n }\n-#help > div > span {\n+#help span.top, #help span.bottom {\n \ttext-align: center;\n \tdisplay: block;\n-\tmargin: 10px 0;\n \tfont-size: 18px;\n-\tborder-bottom: 1px solid #ccc;\n+\n+}\n+#help span.top {\n+\ttext-align: center;\n+\tdisplay: block;\n+\tmargin: 10px 0;\n+\tborder-bottom: 1px solid;\n \tpadding-bottom: 4px;\n \tmargin-bottom: 6px;\n }\n+#help span.bottom {\n+\tclear: both;\n+\tborder-top: 1px solid;\n+}\n #help dd { margin: 5px 35px; }\n #help .infos { padding-left: 0; }\n #help h1, #help h2 { margin-top: 0; }"}, {"sha": "c79801e830876f77c0720756da2c3fa398052e13", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cd3f4da244578a2ab4d17d10016c61b9191b21e4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/cd3f4da244578a2ab4d17d10016c61b9191b21e4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=cd3f4da244578a2ab4d17d10016c61b9191b21e4", "patch": "@@ -286,8 +286,8 @@ details.undocumented > summary::before {\n \tborder-radius: 4px;\n }\n \n-#help > div > span {\n-\tborder-bottom-color: #5c6773;\n+#help span.bottom, #help span.top {\n+\tborder-color: #5c6773;\n }\n \n .since {"}, {"sha": "d2e54070acd68621efadf5e506c9ffb9806aed1c", "filename": "src/librustdoc/html/static/css/themes/dark.css", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cd3f4da244578a2ab4d17d10016c61b9191b21e4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/cd3f4da244578a2ab4d17d10016c61b9191b21e4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css?ref=cd3f4da244578a2ab4d17d10016c61b9191b21e4", "patch": "@@ -242,8 +242,8 @@ details.undocumented > summary::before {\n \tborder-color: #bfbfbf;\n }\n \n-#help > div > span {\n-\tborder-bottom-color: #bfbfbf;\n+#help span.bottom, #help span.top {\n+\tborder-color: #bfbfbf;\n }\n \n #help dt {"}, {"sha": "25d810560c1469b98397fd2975ad686c82c1165a", "filename": "src/librustdoc/html/static/css/themes/light.css", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cd3f4da244578a2ab4d17d10016c61b9191b21e4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/cd3f4da244578a2ab4d17d10016c61b9191b21e4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css?ref=cd3f4da244578a2ab4d17d10016c61b9191b21e4", "patch": "@@ -232,8 +232,8 @@ details.undocumented > summary::before {\n \tborder-color: #bfbfbf;\n }\n \n-#help > div > span {\n-\tborder-bottom-color: #bfbfbf;\n+#help span.bottom, #help span.top {\n+\tborder-color: #bfbfbf;\n }\n \n .since {"}, {"sha": "e396fd9d288db1cc34da37279113f4a65683b0c7", "filename": "src/librustdoc/html/static/js/main.js", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/cd3f4da244578a2ab4d17d10016c61b9191b21e4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/cd3f4da244578a2ab4d17d10016c61b9191b21e4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js?ref=cd3f4da244578a2ab4d17d10016c61b9191b21e4", "patch": "@@ -911,6 +911,7 @@ function hideThemeButtonState() {\n         });\n \n         var book_info = document.createElement(\"span\");\n+        book_info.className = \"top\";\n         book_info.innerHTML = \"You can find more information in \\\n             <a href=\\\"https://doc.rust-lang.org/rustdoc/\\\">the rustdoc book</a>.\";\n \n@@ -961,6 +962,14 @@ function hideThemeButtonState() {\n         container.appendChild(div_shortcuts);\n         container.appendChild(div_infos);\n \n+        var rustdoc_version = document.createElement(\"span\");\n+        rustdoc_version.className = \"bottom\";\n+        var rustdoc_version_code = document.createElement(\"code\");\n+        rustdoc_version_code.innerText = \"/* INSERT RUSTDOC_VERSION HERE */\";\n+        rustdoc_version.appendChild(rustdoc_version_code);\n+\n+        container.appendChild(rustdoc_version);\n+\n         popup.appendChild(container);\n         insertAfter(popup, searchState.outputElement());\n         // So that it's only built once and then it'll do nothing when called!"}]}