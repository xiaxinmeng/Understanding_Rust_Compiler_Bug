{"sha": "dae40767601ee9aa647b442130993bd8ad664f9f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRhZTQwNzY3NjAxZWU5YWE2NDdiNDQyMTMwOTkzYmQ4YWQ2NjRmOWY=", "commit": {"author": {"name": "Michael Wright", "email": "mikerite@lavabit.com", "date": "2019-07-28T04:41:25Z"}, "committer": {"name": "Michael Wright", "email": "mikerite@lavabit.com", "date": "2019-07-28T04:45:09Z"}, "message": "Skip fmt test if rustfmt is unavailble", "tree": {"sha": "37548237b77d57e89c1772b7e23512f8fb774636", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/37548237b77d57e89c1772b7e23512f8fb774636"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/dae40767601ee9aa647b442130993bd8ad664f9f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/dae40767601ee9aa647b442130993bd8ad664f9f", "html_url": "https://github.com/rust-lang/rust/commit/dae40767601ee9aa647b442130993bd8ad664f9f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/dae40767601ee9aa647b442130993bd8ad664f9f/comments", "author": null, "committer": null, "parents": [{"sha": "cc779c8050a863328ddf5c0197ba509473a54be7", "url": "https://api.github.com/repos/rust-lang/rust/commits/cc779c8050a863328ddf5c0197ba509473a54be7", "html_url": "https://github.com/rust-lang/rust/commit/cc779c8050a863328ddf5c0197ba509473a54be7"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "65a1c50e46dac844fd66cea98978006321096eae", "filename": "tests/fmt.rs", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/dae40767601ee9aa647b442130993bd8ad664f9f/tests%2Ffmt.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dae40767601ee9aa647b442130993bd8ad664f9f/tests%2Ffmt.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ffmt.rs?ref=dae40767601ee9aa647b442130993bd8ad664f9f", "patch": "@@ -1,13 +1,26 @@\n+use std::process::Command;\n+\n #[test]\n #[ignore]\n fn fmt() {\n     if option_env!(\"RUSTC_TEST_SUITE\").is_some() {\n         return;\n     }\n \n+    // Skip this test if rustup nightly is unavailable\n+    let rustup_output = Command::new(\"rustup\")\n+        .args(&[\"component\", \"list\", \"--toolchain\", \"nightly\"])\n+        .output()\n+        .unwrap();\n+    assert!(rustup_output.status.success());\n+    let component_output = String::from_utf8_lossy(&rustup_output.stdout);\n+    if !component_output.contains(\"rustfmt\") {\n+        return;\n+    }\n+\n     let root_dir = std::path::PathBuf::from(env!(\"CARGO_MANIFEST_DIR\"));\n     let dev_dir = root_dir.join(\"clippy_dev\");\n-    let output = std::process::Command::new(\"cargo\")\n+    let output = Command::new(\"cargo\")\n         .current_dir(dev_dir)\n         .args(&[\"+nightly\", \"run\", \"--\", \"fmt\", \"--check\"])\n         .output()"}]}