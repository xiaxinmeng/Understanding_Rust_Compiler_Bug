{"sha": "b06879c1bd5d7c2fbe4cc12a0ded31ea5b879ea5", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIwNjg3OWMxYmQ1ZDdjMmZiZTRjYzEyYTBkZWQzMWVhNWI4NzllYTU=", "commit": {"author": {"name": "Oliver Scherer", "email": "github35764891676564198441@oli-obk.de", "date": "2019-03-25T23:20:22Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-03-25T23:20:22Z"}, "message": "Merge pull request #665 from RalfJung/readme\n\nupdate README to suggest installing Miri as a component", "tree": {"sha": "4b84b0d7772a4469e46b6d97a97af817b9452695", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4b84b0d7772a4469e46b6d97a97af817b9452695"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b06879c1bd5d7c2fbe4cc12a0ded31ea5b879ea5", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcmWI2CRBK7hj4Ov3rIwAAdHIIAJO8xVq4n22+PC0ePPZ8ejbu\n8yaqQMa5RLwMYTXhluzsdy4qd+/RK1wch8V9xA8t7qOFSmVY+wWttYYlXxgILLPB\nxclUOieV9QZLPmdJyaw6Qjivejsqa2nRj8omIk83ZaCIHdjFdcEUMw7JEn2ZZm/0\ngvRGCPljtYJ0zZ9XOra3Fg7mEfPAbbK/u9vR784Ke+H6mQZdcnAevOcmLnL8Mtys\noHXXIMd7wlIO+2WirJHlmNx/du9Zkf5I2gkt8uEOz0UHWQQHjtZcrxMOl5zhy0di\nM7Neut1N4WPQh8tKkLDyVCNv+ukp1WN4nr/PmTa6NV/zQTFy/YRnXU6Eykx8ciI=\n=S+wz\n-----END PGP SIGNATURE-----\n", "payload": "tree 4b84b0d7772a4469e46b6d97a97af817b9452695\nparent 1d758250162865e346fd0ff8ac1b05c511920f53\nparent 90dac3d4bd861c9b46aab646cc1abe90dcc3f4a1\nauthor Oliver Scherer <github35764891676564198441@oli-obk.de> 1553556022 +0100\ncommitter GitHub <noreply@github.com> 1553556022 +0100\n\nMerge pull request #665 from RalfJung/readme\n\nupdate README to suggest installing Miri as a component"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b06879c1bd5d7c2fbe4cc12a0ded31ea5b879ea5", "html_url": "https://github.com/rust-lang/rust/commit/b06879c1bd5d7c2fbe4cc12a0ded31ea5b879ea5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b06879c1bd5d7c2fbe4cc12a0ded31ea5b879ea5/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1d758250162865e346fd0ff8ac1b05c511920f53", "url": "https://api.github.com/repos/rust-lang/rust/commits/1d758250162865e346fd0ff8ac1b05c511920f53", "html_url": "https://github.com/rust-lang/rust/commit/1d758250162865e346fd0ff8ac1b05c511920f53"}, {"sha": "90dac3d4bd861c9b46aab646cc1abe90dcc3f4a1", "url": "https://api.github.com/repos/rust-lang/rust/commits/90dac3d4bd861c9b46aab646cc1abe90dcc3f4a1", "html_url": "https://github.com/rust-lang/rust/commit/90dac3d4bd861c9b46aab646cc1abe90dcc3f4a1"}], "stats": {"total": 36, "additions": 13, "deletions": 23}, "files": [{"sha": "09fa329dc4ecf005219276885349890cfe04632d", "filename": "README.md", "status": "modified", "additions": 13, "deletions": 23, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/b06879c1bd5d7c2fbe4cc12a0ded31ea5b879ea5/README.md", "raw_url": "https://github.com/rust-lang/rust/raw/b06879c1bd5d7c2fbe4cc12a0ded31ea5b879ea5/README.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/README.md?ref=b06879c1bd5d7c2fbe4cc12a0ded31ea5b879ea5", "patch": "@@ -27,42 +27,31 @@ list!\n \n ## Running Miri on your own project (and its test suite)\n \n-Install Miri as a cargo subcommand:\n+Install Miri via `rustup`:\n \n ```sh\n-cargo +nightly install --force --git https://github.com/rust-lang/miri miri\n+rustup component add miri\n ```\n \n-If this does not work, try using the nightly version given in\n-[this file](https://raw.githubusercontent.com/rust-lang/miri/master/rust-version). CI\n-should ensure that this nightly always works.\n-\n-You have to use a consistent Rust version for building miri and your project, so\n-remember to either always specify the nightly version manually (like in the\n-example above), overriding it in your project directory as well, or use `rustup\n-default nightly` (or `rustup default nightly-YYYY-MM-DD`) to globally make\n-`nightly` the default toolchain.\n-\n Now you can run your project in Miri:\n \n 1. Run `cargo clean` to eliminate any cached dependencies.  Miri needs your\n    dependencies to be compiled the right way, that would not happen if they have\n    previously already been compiled.\n-2. To run all tests in your project through Miri, use `cargo +nightly miri test`.\n-3. If you have a binary project, you can run it through Miri using `cargo\n-   +nightly miri run`.\n+2. To run all tests in your project through Miri, use `cargo miri test`.\n+3. If you have a binary project, you can run it through Miri using `cargo miri run`.\n \n The first time you run Miri, it will perform some extra setup and install some\n dependencies.  It will ask you for confirmation before installing anything.  If\n-you run Miri on CI, run `cargo +nightly miri setup` to avoid getting interactive\n+you run Miri on CI, run `cargo miri setup` to avoid getting interactive\n questions.\n \n You can pass arguments to Miri after the first `--`, and pass arguments to the\n interpreted program or test suite after the second `--`.  For example, `cargo\n-+nightly miri run -- -Zmiri-disable-validation` runs the program without\n-validation of basic type invariants and references.  `cargo +nightly miri test\n--- -- -Zunstable-options --exclude-should-panic` skips `#[should_panic]` tests,\n-which is a good idea because Miri does not support unwinding or catching panics.\n+miri run -- -Zmiri-disable-validation` runs the program without validation of\n+basic type invariants and references.  `cargo miri test -- -- -Zunstable-options\n+--exclude-should-panic` skips `#[should_panic]` tests, which is a good idea\n+because Miri does not support unwinding or catching panics.\n \n When running code via `cargo miri`, the `miri` config flag is set.  You can\n use this to exclude test cases that will fail under Miri because they do things\n@@ -110,10 +99,14 @@ convenient way is to install Miri using cargo, then you can easily run it on\n other projects:\n \n ```sh\n+rustup component remove miri # avoid having Miri installed twice\n cargo +nightly install --path \"$DIR\" --force # or the nightly in `rust-version`\n cargo +nightly miri setup\n ```\n \n+(We are giving `+nightly` explicitly here all the time because it is important\n+that all of these commands get executed with the same toolchain.)\n+\n If you want to use a different libstd (not the one that comes with the\n nightly), you can do that by running\n \n@@ -124,9 +117,6 @@ XARGO_RUST_SRC=~/src/rust/rustc/src/ cargo +nightly miri setup\n Either way, you can now do `cargo +nightly miri run` to run Miri with your\n local changes on whatever project you are debugging.\n \n-(We are giving `+nightly` explicitly here all the time because it is important\n-that all of these commands get executed with the same toolchain.)\n-\n `cargo miri setup` should end in printing the directory where the libstd was\n built.  For the next step to work, set that as your `MIRI_SYSROOT` environment\n variable:"}]}