{"sha": "b6f81e04347d9dbd29e59e7dbca3f9289ddb2fe3", "node_id": "C_kwDOAAsO6NoAKGI2ZjgxZTA0MzQ3ZDlkYmQyOWU1OWU3ZGJjYTNmOTI4OWRkYjJmZTM", "commit": {"author": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2023-04-19T17:16:14Z"}, "committer": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2023-04-19T19:56:52Z"}, "message": "rustdoc-search: give longer notification for type corrections", "tree": {"sha": "efd9ffd2cc20b89691e52cc305ff84536890ba22", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/efd9ffd2cc20b89691e52cc305ff84536890ba22"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b6f81e04347d9dbd29e59e7dbca3f9289ddb2fe3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b6f81e04347d9dbd29e59e7dbca3f9289ddb2fe3", "html_url": "https://github.com/rust-lang/rust/commit/b6f81e04347d9dbd29e59e7dbca3f9289ddb2fe3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b6f81e04347d9dbd29e59e7dbca3f9289ddb2fe3/comments", "author": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "committer": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4c11822aebd9e9c3bbe798f14fa10ec6db3f3937", "url": "https://api.github.com/repos/rust-lang/rust/commits/4c11822aebd9e9c3bbe798f14fa10ec6db3f3937", "html_url": "https://github.com/rust-lang/rust/commit/4c11822aebd9e9c3bbe798f14fa10ec6db3f3937"}], "stats": {"total": 15, "additions": 10, "deletions": 5}, "files": [{"sha": "1bee6987739a44af8e1722087a9539aefe0471da", "filename": "src/librustdoc/html/static/js/search.js", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/b6f81e04347d9dbd29e59e7dbca3f9289ddb2fe3/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsearch.js", "raw_url": "https://github.com/rust-lang/rust/raw/b6f81e04347d9dbd29e59e7dbca3f9289ddb2fe3/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsearch.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsearch.js?ref=b6f81e04347d9dbd29e59e7dbca3f9289ddb2fe3", "patch": "@@ -1996,8 +1996,13 @@ function initSearch(rawSearchIndex) {\n         }\n \n         if (results.query.correction !== null) {\n-            output += \"<h3 class=\\\"search-corrections\\\">Showing results for \" +\n-                `\"${results.query.correction}\".</h3>`;\n+            const orig = results.query.returned.length > 0\n+                ? results.query.returned[0].name\n+                : results.query.elems[0].name;\n+            output += \"<h3 class=\\\"search-corrections\\\">\" +\n+                `Type \"${orig}\" not found. ` +\n+                \"Showing results for \" +\n+                `\"${results.query.correction}\" instead.</h3>`;\n         }\n \n         const resultsElem = document.createElement(\"div\");"}, {"sha": "323dd658426c1fab27bc84a040e0eb6b8eeb3b63", "filename": "tests/rustdoc-gui/search-corrections.goml", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b6f81e04347d9dbd29e59e7dbca3f9289ddb2fe3/tests%2Frustdoc-gui%2Fsearch-corrections.goml", "raw_url": "https://github.com/rust-lang/rust/raw/b6f81e04347d9dbd29e59e7dbca3f9289ddb2fe3/tests%2Frustdoc-gui%2Fsearch-corrections.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-gui%2Fsearch-corrections.goml?ref=b6f81e04347d9dbd29e59e7dbca3f9289ddb2fe3", "patch": "@@ -22,7 +22,7 @@ assert-css: (\".search-corrections\", {\n })\n assert-text: (\n     \".search-corrections\",\n-    \"Showing results for \\\"notablestructwithlongname\\\".\"\n+    \"Type \\\"notablestructwithlongnamr\\\" not found. Showing results for \\\"notablestructwithlongname\\\" instead.\"\n )\n \n // Corrections do get shown on the \"In Return Type\" tab.\n@@ -33,7 +33,7 @@ assert-css: (\".search-corrections\", {\n })\n assert-text: (\n     \".search-corrections\",\n-    \"Showing results for \\\"notablestructwithlongname\\\".\"\n+    \"Type \\\"notablestructwithlongnamr\\\" not found. Showing results for \\\"notablestructwithlongname\\\" instead.\"\n )\n \n // Now, explicit return values\n@@ -50,5 +50,5 @@ assert-css: (\".search-corrections\", {\n })\n assert-text: (\n     \".search-corrections\",\n-    \"Showing results for \\\"notablestructwithlongname\\\".\"\n+    \"Type \\\"notablestructwithlongnamr\\\" not found. Showing results for \\\"notablestructwithlongname\\\" instead.\"\n )"}]}