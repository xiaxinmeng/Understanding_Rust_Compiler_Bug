{"sha": "832a912f79cf5eda76d60c5b83238bdade21cde0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjgzMmE5MTJmNzljZjVlZGE3NmQ2MGM1YjgzMjM4YmRhZGUyMWNkZTA=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2018-10-08T01:37:48Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-10-08T01:37:48Z"}, "message": "Merge pull request #3077 from YaLTeR/fix-extra-commas\n\nGet rid of extra commas in Visual struct literal formatting", "tree": {"sha": "facd39891c384b6d9acbd62e7d63fed9217cce96", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/facd39891c384b6d9acbd62e7d63fed9217cce96"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/832a912f79cf5eda76d60c5b83238bdade21cde0", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJburTsCRBK7hj4Ov3rIwAAdHIIADgu6SKkX9qmdmTbmXP0eAG/\nw5zlQ7OvIA2TSSmMybwebMmjsR9GFW8v4jKMn2oXrE5zKYcDMwRW0cY93ddTiUNx\n7SxOiZCZxotyk1+ESBzyhEXobJ0GCXi0ziKUZnwoySoATUkaKyYclG9Gb/um5Mja\npjgq5NdDRxkF4jcLowlVjr1GnyrmecCVhxfQlRuMx9QvRSzQDGlReKcDZRnzakGd\n5Iqs0smffROKmRM2LXfKdrES4IqXOO6eyWsaMNsvzmvBG72yh4qQ5vacJa0O3qeF\njkY4jbrdoMjmRVoyXtAgE0cRkTqLWZHOza+vER2p8zFRIl7vXy4bdpNLqTT7Lg0=\n=hXV3\n-----END PGP SIGNATURE-----\n", "payload": "tree facd39891c384b6d9acbd62e7d63fed9217cce96\nparent 4dc5557625a5ed247daa90a64e85a2d5303dad5f\nparent cbaed838d5e8c2fa40a019434b0ed9cec970ca61\nauthor Nick Cameron <nrc@ncameron.org> 1538962668 +1300\ncommitter GitHub <noreply@github.com> 1538962668 +1300\n\nMerge pull request #3077 from YaLTeR/fix-extra-commas\n\nGet rid of extra commas in Visual struct literal formatting"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/832a912f79cf5eda76d60c5b83238bdade21cde0", "html_url": "https://github.com/rust-lang/rust/commit/832a912f79cf5eda76d60c5b83238bdade21cde0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/832a912f79cf5eda76d60c5b83238bdade21cde0/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4dc5557625a5ed247daa90a64e85a2d5303dad5f", "url": "https://api.github.com/repos/rust-lang/rust/commits/4dc5557625a5ed247daa90a64e85a2d5303dad5f", "html_url": "https://github.com/rust-lang/rust/commit/4dc5557625a5ed247daa90a64e85a2d5303dad5f"}, {"sha": "cbaed838d5e8c2fa40a019434b0ed9cec970ca61", "url": "https://api.github.com/repos/rust-lang/rust/commits/cbaed838d5e8c2fa40a019434b0ed9cec970ca61", "html_url": "https://github.com/rust-lang/rust/commit/cbaed838d5e8c2fa40a019434b0ed9cec970ca61"}], "stats": {"total": 58, "additions": 36, "deletions": 22}, "files": [{"sha": "66b5d840f3c3628893d2089489114012cedf1ca3", "filename": "Configurations.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/832a912f79cf5eda76d60c5b83238bdade21cde0/Configurations.md", "raw_url": "https://github.com/rust-lang/rust/raw/832a912f79cf5eda76d60c5b83238bdade21cde0/Configurations.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Configurations.md?ref=832a912f79cf5eda76d60c5b83238bdade21cde0", "patch": "@@ -236,7 +236,7 @@ fn main() {\n ```rust\n fn main() {\n     let lorem = Lorem { ipsum: dolor,\n-                        sit: amet, };\n+                        sit: amet };\n }\n ```\n "}, {"sha": "aa5545c8161303410089f42342c67218d5b993ce", "filename": "src/expr.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/832a912f79cf5eda76d60c5b83238bdade21cde0/src%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/832a912f79cf5eda76d60c5b83238bdade21cde0/src%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fexpr.rs?ref=832a912f79cf5eda76d60c5b83238bdade21cde0", "patch": "@@ -1610,7 +1610,7 @@ fn rewrite_struct_lit<'a>(\n             nested_shape,\n             tactic,\n             context,\n-            force_no_trailing_comma || base.is_some(),\n+            force_no_trailing_comma || base.is_some() || !context.use_block_indent(),\n         );\n \n         write_list(&item_vec, &fmt)?"}, {"sha": "4d1ece43defcde66ddf161658ff47b1a4ecea6e6", "filename": "tests/source/issue-3066.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/832a912f79cf5eda76d60c5b83238bdade21cde0/tests%2Fsource%2Fissue-3066.rs", "raw_url": "https://github.com/rust-lang/rust/raw/832a912f79cf5eda76d60c5b83238bdade21cde0/tests%2Fsource%2Fissue-3066.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fissue-3066.rs?ref=832a912f79cf5eda76d60c5b83238bdade21cde0", "patch": "@@ -0,0 +1,7 @@\n+// rustfmt-indent_style: Visual\n+fn main() {\n+    Struct { field: aaaaaaaaaaa };\n+    Struct { field: aaaaaaaaaaaa, };\n+    Struct { field: value,\n+             field2: value2, };\n+}"}, {"sha": "979816f3abb1e4c0a2d56dc18763ff38b299d18a", "filename": "tests/target/chains-visual.rs", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/832a912f79cf5eda76d60c5b83238bdade21cde0/tests%2Ftarget%2Fchains-visual.rs", "raw_url": "https://github.com/rust-lang/rust/raw/832a912f79cf5eda76d60c5b83238bdade21cde0/tests%2Ftarget%2Fchains-visual.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fchains-visual.rs?ref=832a912f79cf5eda76d60c5b83238bdade21cde0", "patch": "@@ -55,11 +55,11 @@ fn main() {\n \n fn floaters() {\n     let z = Foo { field1: val1,\n-                  field2: val2, };\n+                  field2: val2 };\n \n     let x = Foo { field1: val1,\n-                  field2: val2, }.method_call()\n-                                 .method_call();\n+                  field2: val2 }.method_call()\n+                                .method_call();\n \n     let y = if cond { val1 } else { val2 }.method_call();\n \n@@ -89,11 +89,11 @@ fn floaters() {\n                   .quux();\n \n     Foo { y: i_am_multi_line,\n-          z: ok, }.baz(|| {\n-                           force();\n-                           multiline();\n-                       })\n-                  .quux();\n+          z: ok }.baz(|| {\n+                          force();\n+                          multiline();\n+                      })\n+                 .quux();\n \n     a + match x {\n             true => \"yay!\","}, {"sha": "ec49021d330e8ce50866dae2b803f1d8f7a46da4", "filename": "tests/target/configs/indent_style/visual_struct_lit.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/832a912f79cf5eda76d60c5b83238bdade21cde0/tests%2Ftarget%2Fconfigs%2Findent_style%2Fvisual_struct_lit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/832a912f79cf5eda76d60c5b83238bdade21cde0/tests%2Ftarget%2Fconfigs%2Findent_style%2Fvisual_struct_lit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs%2Findent_style%2Fvisual_struct_lit.rs?ref=832a912f79cf5eda76d60c5b83238bdade21cde0", "patch": "@@ -3,5 +3,5 @@\n \n fn main() {\n     let lorem = Lorem { ipsum: dolor,\n-                        sit: amet, };\n+                        sit: amet };\n }"}, {"sha": "d4dccc97e48258b2298951f840227ed4bc21fb47", "filename": "tests/target/issue-3066.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/832a912f79cf5eda76d60c5b83238bdade21cde0/tests%2Ftarget%2Fissue-3066.rs", "raw_url": "https://github.com/rust-lang/rust/raw/832a912f79cf5eda76d60c5b83238bdade21cde0/tests%2Ftarget%2Fissue-3066.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-3066.rs?ref=832a912f79cf5eda76d60c5b83238bdade21cde0", "patch": "@@ -0,0 +1,7 @@\n+// rustfmt-indent_style: Visual\n+fn main() {\n+    Struct { field: aaaaaaaaaaa };\n+    Struct { field: aaaaaaaaaaaa };\n+    Struct { field: value,\n+             field2: value2 };\n+}"}, {"sha": "a9627fb90f51f3c00b87648d172f9cdac040144d", "filename": "tests/target/struct_lits_visual.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/832a912f79cf5eda76d60c5b83238bdade21cde0/tests%2Ftarget%2Fstruct_lits_visual.rs", "raw_url": "https://github.com/rust-lang/rust/raw/832a912f79cf5eda76d60c5b83238bdade21cde0/tests%2Ftarget%2Fstruct_lits_visual.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fstruct_lits_visual.rs?ref=832a912f79cf5eda76d60c5b83238bdade21cde0", "patch": "@@ -20,30 +20,30 @@ fn main() {\n     Foooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo { // Comment\n                                                                                         a: foo(), /* Comment */\n                                                                                         // Comment\n-                                                                                        b: bar(), /* Comment */ };\n+                                                                                        b: bar() /* Comment */ };\n \n     Foo { a: Bar, b: f() };\n \n     Quux { x: if cond {\n                bar();\n            },\n-           y: baz(), };\n+           y: baz() };\n \n     Baz { x: yxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx,\n-          z: zzzzz, /* test */ };\n+          z: zzzzz /* test */ };\n \n     A { // Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec a diam lectus. Sed sit\n         // amet ipsum mauris. Maecenas congue ligula ac quam viverra nec consectetur ante\n         // hendrerit. Donec et mollis dolor.\n         first: item(),\n         // Praesent et diam eget libero egestas mattis sit amet vitae augue.\n         // Nam tincidunt congue enim, ut porta lorem lacinia consectetur.\n-        second: Item, };\n+        second: Item };\n \n     Diagram { //                 o        This graph demonstrates how\n               //                / \\       significant whitespace is\n               //               o   o      preserved.\n               //              /|\\   \\\n               //             o o o   o\n-              graph: G, }\n+              graph: G }\n }"}, {"sha": "3f43ef0c981d50e57ab1fc00d2e6faa9e4dfd4ae", "filename": "tests/target/struct_lits_visual_multiline.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/832a912f79cf5eda76d60c5b83238bdade21cde0/tests%2Ftarget%2Fstruct_lits_visual_multiline.rs", "raw_url": "https://github.com/rust-lang/rust/raw/832a912f79cf5eda76d60c5b83238bdade21cde0/tests%2Ftarget%2Fstruct_lits_visual_multiline.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fstruct_lits_visual_multiline.rs?ref=832a912f79cf5eda76d60c5b83238bdade21cde0", "patch": "@@ -17,33 +17,33 @@ fn main() {\n           ..something };\n \n     Fooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo { a: foo(),\n-                                                                               b: bar(), };\n+                                                                               b: bar() };\n \n     Foooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo { // Comment\n                                                                                         a: foo(), /* Comment */\n                                                                                         // Comment\n-                                                                                        b: bar(), /* Comment */ };\n+                                                                                        b: bar() /* Comment */ };\n \n     Foo { a: Bar,\n-          b: foo(), };\n+          b: foo() };\n \n     Quux { x: if cond {\n                bar();\n            },\n-           y: baz(), };\n+           y: baz() };\n \n     A { // Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec a diam lectus. Sed sit\n         // amet ipsum mauris. Maecenas congue ligula ac quam viverra nec consectetur ante\n         // hendrerit. Donec et mollis dolor.\n         first: item(),\n         // Praesent et diam eget libero egestas mattis sit amet vitae augue.\n         // Nam tincidunt congue enim, ut porta lorem lacinia consectetur.\n-        second: Item, };\n+        second: Item };\n \n     Diagram { //                 o        This graph demonstrates how\n               //                / \\       significant whitespace is\n               //               o   o      preserved.\n               //              /|\\   \\\n               //             o o o   o\n-              graph: G, }\n+              graph: G }\n }"}]}