{"sha": "59c856c071d3cdb5bd8d0d5b49c49be15f72d82a", "node_id": "C_kwDOAAsO6NoAKDU5Yzg1NmMwNzFkM2NkYjViZDhkMGQ1YjQ5YzQ5YmUxNWY3MmQ4MmE", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-11-18T23:25:21Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-11-18T23:25:21Z"}, "message": "Fix invalid focus when blurring notable traits popover", "tree": {"sha": "cf47c9f0b5c10f089610abe8a9ff5a2f71a4fed5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cf47c9f0b5c10f089610abe8a9ff5a2f71a4fed5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/59c856c071d3cdb5bd8d0d5b49c49be15f72d82a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/59c856c071d3cdb5bd8d0d5b49c49be15f72d82a", "html_url": "https://github.com/rust-lang/rust/commit/59c856c071d3cdb5bd8d0d5b49c49be15f72d82a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/59c856c071d3cdb5bd8d0d5b49c49be15f72d82a/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b8a5b02102113198dde2011fd16192ef98c45227", "url": "https://api.github.com/repos/rust-lang/rust/commits/b8a5b02102113198dde2011fd16192ef98c45227", "html_url": "https://github.com/rust-lang/rust/commit/b8a5b02102113198dde2011fd16192ef98c45227"}], "stats": {"total": 19, "additions": 11, "deletions": 8}, "files": [{"sha": "75b3dce2eda86bd4a133e259a89ffa0fd1f49401", "filename": "src/librustdoc/html/static/js/main.js", "status": "modified", "additions": 11, "deletions": 8, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/59c856c071d3cdb5bd8d0d5b49c49be15f72d82a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/59c856c071d3cdb5bd8d0d5b49c49be15f72d82a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js?ref=59c856c071d3cdb5bd8d0d5b49c49be15f72d82a", "patch": "@@ -795,7 +795,7 @@ function loadCss(cssUrl) {\n             // This means when the window is resized, we need to redo the layout.\n             const base = window.CURRENT_NOTABLE_ELEMENT.NOTABLE_BASE;\n             const force_visible = base.NOTABLE_FORCE_VISIBLE;\n-            hideNotable();\n+            hideNotable(false);\n             if (force_visible) {\n                 showNotable(base);\n                 base.NOTABLE_FORCE_VISIBLE = true;\n@@ -846,7 +846,7 @@ function loadCss(cssUrl) {\n             // Make this function idempotent.\n             return;\n         }\n-        hideNotable();\n+        hideNotable(false);\n         const ty = e.getAttribute(\"data-ty\");\n         const wrapper = document.createElement(\"div\");\n         wrapper.innerHTML = \"<div class=\\\"docblock\\\">\" + window.NOTABLE_TRAITS[ty] + \"</div>\";\n@@ -883,7 +883,7 @@ function loadCss(cssUrl) {\n                 return;\n             }\n             if (!e.NOTABLE_FORCE_VISIBLE && !elemIsInParent(event.relatedTarget, e)) {\n-                hideNotable();\n+                hideNotable(true);\n             }\n         };\n     }\n@@ -903,13 +903,16 @@ function loadCss(cssUrl) {\n             // To work around this, make sure the click finishes being dispatched before\n             // hiding the popover. Since `hideNotable()` is idempotent, this makes Safari behave\n             // consistently with the other two.\n-            setTimeout(hideNotable, 0);\n+            setTimeout(() => hideNotable(false), 0);\n         }\n     }\n \n-    function hideNotable() {\n+    function hideNotable(focus) {\n         if (window.CURRENT_NOTABLE_ELEMENT) {\n             if (window.CURRENT_NOTABLE_ELEMENT.NOTABLE_BASE.NOTABLE_FORCE_VISIBLE) {\n+                if (focus) {\n+                    window.CURRENT_NOTABLE_ELEMENT.NOTABLE_BASE.focus();\n+                }\n                 window.CURRENT_NOTABLE_ELEMENT.NOTABLE_BASE.NOTABLE_FORCE_VISIBLE = false;\n             }\n             const body = document.getElementsByTagName(\"body\")[0];\n@@ -922,7 +925,7 @@ function loadCss(cssUrl) {\n         e.onclick = function() {\n             this.NOTABLE_FORCE_VISIBLE = this.NOTABLE_FORCE_VISIBLE ? false : true;\n             if (window.CURRENT_NOTABLE_ELEMENT && !this.NOTABLE_FORCE_VISIBLE) {\n-                hideNotable();\n+                hideNotable(true);\n             } else {\n                 showNotable(this);\n                 window.CURRENT_NOTABLE_ELEMENT.setAttribute(\"tabindex\", \"0\");\n@@ -945,7 +948,7 @@ function loadCss(cssUrl) {\n             }\n             if (!this.NOTABLE_FORCE_VISIBLE &&\n                 !elemIsInParent(event.relatedTarget, window.CURRENT_NOTABLE_ELEMENT)) {\n-                hideNotable();\n+                hideNotable(true);\n             }\n         };\n     });\n@@ -1056,7 +1059,7 @@ function loadCss(cssUrl) {\n         onEachLazy(document.querySelectorAll(\".search-form .popover\"), elem => {\n             elem.style.display = \"none\";\n         });\n-        hideNotable();\n+        hideNotable(false);\n     };\n \n     /**"}]}