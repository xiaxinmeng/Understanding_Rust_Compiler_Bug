{"sha": "e75feea6966c33fd5da37cbb49ba2bc571648935", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU3NWZlZWE2OTY2YzMzZmQ1ZGEzN2NiYjQ5YmEyYmM1NzE2NDg5MzU=", "commit": {"author": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2016-09-26T20:16:35Z"}, "committer": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2016-09-26T20:30:56Z"}, "message": "Fix off-by-one when emitting StorageDead for vars", "tree": {"sha": "aed277978cdc3600102406a6483c6ada7467bd95", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/aed277978cdc3600102406a6483c6ada7467bd95"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e75feea6966c33fd5da37cbb49ba2bc571648935", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e75feea6966c33fd5da37cbb49ba2bc571648935", "html_url": "https://github.com/rust-lang/rust/commit/e75feea6966c33fd5da37cbb49ba2bc571648935", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e75feea6966c33fd5da37cbb49ba2bc571648935/comments", "author": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "393db2d83089b3940fa2fe77f1241ca4625fe883", "url": "https://api.github.com/repos/rust-lang/rust/commits/393db2d83089b3940fa2fe77f1241ca4625fe883", "html_url": "https://github.com/rust-lang/rust/commit/393db2d83089b3940fa2fe77f1241ca4625fe883"}], "stats": {"total": 5, "additions": 2, "deletions": 3}, "files": [{"sha": "01cce3c7dd79474d2b2c55fc8a7091474f032dde", "filename": "src/librustc_mir/build/scope.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e75feea6966c33fd5da37cbb49ba2bc571648935/src%2Flibrustc_mir%2Fbuild%2Fscope.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e75feea6966c33fd5da37cbb49ba2bc571648935/src%2Flibrustc_mir%2Fbuild%2Fscope.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fbuild%2Fscope.rs?ref=e75feea6966c33fd5da37cbb49ba2bc571648935", "patch": "@@ -462,7 +462,7 @@ impl<'a, 'gcx, 'tcx> Builder<'a, 'gcx, 'tcx> {\n         } else {\n             // Only temps and vars need their storage dead.\n             match *lvalue {\n-                Lvalue::Local(index) if index.index() > self.arg_count + 1 => DropKind::Storage,\n+                Lvalue::Local(index) if index.index() > self.arg_count => DropKind::Storage,\n                 _ => return\n             }\n         };"}, {"sha": "a4905281e4636bf703bc13f46afe2b20fffc419c", "filename": "src/test/mir-opt/storage_ranges.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/e75feea6966c33fd5da37cbb49ba2bc571648935/src%2Ftest%2Fmir-opt%2Fstorage_ranges.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e75feea6966c33fd5da37cbb49ba2bc571648935/src%2Ftest%2Fmir-opt%2Fstorage_ranges.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Fstorage_ranges.rs?ref=e75feea6966c33fd5da37cbb49ba2bc571648935", "patch": "@@ -18,8 +18,6 @@ fn main() {\n     let c = 1;\n }\n \n-// TODO The StorageDead for local1 (a) after local6's (c) is missing!\n-\n // END RUST SOURCE\n // START rustc.node4.TypeckMir.before.mir\n //     bb0: {\n@@ -39,6 +37,7 @@ fn main() {\n //         local6 = const 1i32;             // scope 1 at storage_ranges.rs:16:13: 16:14\n //         local0 = ();                     // scope 3 at storage_ranges.rs:11:11: 17:2\n //         StorageDead(local6);             // scope 1 at storage_ranges.rs:16:9: 16:10\n+//         StorageDead(local1);             // scope 0 at storage_ranges.rs:14:9: 14:10\n //         goto -> bb1;                     // scope 0 at storage_ranges.rs:11:1: 17:2\n //     }\n //"}]}