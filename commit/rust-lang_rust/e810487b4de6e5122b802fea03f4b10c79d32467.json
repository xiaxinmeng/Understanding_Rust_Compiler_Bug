{"sha": "e810487b4de6e5122b802fea03f4b10c79d32467", "node_id": "C_kwDOAAsO6NoAKGU4MTA0ODdiNGRlNmU1MTIyYjgwMmZlYTAzZjRiMTBjNzlkMzI0Njc", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2021-12-30T12:12:34Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-12-30T12:12:34Z"}, "message": "Rollup merge of #92414 - dtolnay:constnoexpr, r=oli-obk\n\nFix spacing of pretty printed const item without body\n\nFollow-up to #92238 fixing one of the FIXMEs.\n\n```rust\nmacro_rules! repro {\n    ($item:item) => {\n        stringify!($item)\n    };\n}\n\nfn main() {\n    println!(\"{}\", repro!(extern \"C\" { static S: i32; }));\n}\n```\n\nBefore:&ensp;`extern \"C\" { static S: i32 ; }`\nAfter:&ensp;`extern \"C\" { static S: i32; }`", "tree": {"sha": "c8e593f5330c24499b0093e4e7268c39f708c1c8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c8e593f5330c24499b0093e4e7268c39f708c1c8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e810487b4de6e5122b802fea03f4b10c79d32467", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhzaIyCRBK7hj4Ov3rIwAAEVgIAFjb0yEA46Km+kg5WMlPJ9cq\nSXE6CmRJ1h5Ph5M87RQk50E/zhwdBwh0PcynGLBjjV1jChKiJ/HMn/SdpdTu/DvF\nD0vODktdgvhm8IR7POlHcifVds5pC+GfXvNA78hlt4arqxwESxZz+YX+nA35ICZ6\nzRsZIU4nfRC4OJ+7kBFrv+A4dZ//1cTWU6G+OAFkTv3Er6xT5z41kvs+qxvxnKhb\n64u+6M/67RwFIY9xvGGazXjZXtSx58ZrOoyLhEs3CyT1qf9rLFGTqC+eJ3sTP3Ba\nGK9bfecGGn/L+tUn1ZSMGeeKNJ5qF2I+DsokEyaulymYaWO6SnmoADCHBPsQqhk=\n=Qzje\n-----END PGP SIGNATURE-----\n", "payload": "tree c8e593f5330c24499b0093e4e7268c39f708c1c8\nparent b9f7197ab35f79b4df1f60104b9d8af9e77bb566\nparent b62163515ad109dad05985b958c98a001dbcd89b\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1640866354 +0100\ncommitter GitHub <noreply@github.com> 1640866354 +0100\n\nRollup merge of #92414 - dtolnay:constnoexpr, r=oli-obk\n\nFix spacing of pretty printed const item without body\n\nFollow-up to #92238 fixing one of the FIXMEs.\n\n```rust\nmacro_rules! repro {\n    ($item:item) => {\n        stringify!($item)\n    };\n}\n\nfn main() {\n    println!(\"{}\", repro!(extern \"C\" { static S: i32; }));\n}\n```\n\nBefore:&ensp;`extern \"C\" { static S: i32 ; }`\nAfter:&ensp;`extern \"C\" { static S: i32; }`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e810487b4de6e5122b802fea03f4b10c79d32467", "html_url": "https://github.com/rust-lang/rust/commit/e810487b4de6e5122b802fea03f4b10c79d32467", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e810487b4de6e5122b802fea03f4b10c79d32467/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b9f7197ab35f79b4df1f60104b9d8af9e77bb566", "url": "https://api.github.com/repos/rust-lang/rust/commits/b9f7197ab35f79b4df1f60104b9d8af9e77bb566", "html_url": "https://github.com/rust-lang/rust/commit/b9f7197ab35f79b4df1f60104b9d8af9e77bb566"}, {"sha": "b62163515ad109dad05985b958c98a001dbcd89b", "url": "https://api.github.com/repos/rust-lang/rust/commits/b62163515ad109dad05985b958c98a001dbcd89b", "html_url": "https://github.com/rust-lang/rust/commit/b62163515ad109dad05985b958c98a001dbcd89b"}], "stats": {"total": 30, "additions": 16, "deletions": 14}, "files": [{"sha": "0d5ce07c6ca1101e73307e36e874d37b4fcb6402", "filename": "compiler/rustc_ast_pretty/src/pprust/state.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/e810487b4de6e5122b802fea03f4b10c79d32467/compiler%2Frustc_ast_pretty%2Fsrc%2Fpprust%2Fstate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e810487b4de6e5122b802fea03f4b10c79d32467/compiler%2Frustc_ast_pretty%2Fsrc%2Fpprust%2Fstate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_pretty%2Fsrc%2Fpprust%2Fstate.rs?ref=e810487b4de6e5122b802fea03f4b10c79d32467", "patch": "@@ -1116,7 +1116,9 @@ impl<'a> State<'a> {\n         self.print_ident(ident);\n         self.word_space(\":\");\n         self.print_type(ty);\n-        self.space();\n+        if body.is_some() {\n+            self.space();\n+        }\n         self.end(); // end the head-ibox\n         if let Some(body) = body {\n             self.word_space(\"=\");"}, {"sha": "b094ba577db2d7944744a6b5025362c9b9b919bc", "filename": "src/test/pretty/nested-item-vis-defaultness.rs", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/e810487b4de6e5122b802fea03f4b10c79d32467/src%2Ftest%2Fpretty%2Fnested-item-vis-defaultness.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e810487b4de6e5122b802fea03f4b10c79d32467/src%2Ftest%2Fpretty%2Fnested-item-vis-defaultness.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fpretty%2Fnested-item-vis-defaultness.rs?ref=e810487b4de6e5122b802fea03f4b10c79d32467", "patch": "@@ -6,42 +6,42 @@ fn main() {}\n \n #[cfg(FALSE)]\n extern \"C\" {\n-    static X: u8 ;\n+    static X: u8;\n     type X;\n     fn foo();\n-    pub static X: u8 ;\n+    pub static X: u8;\n     pub type X;\n     pub fn foo();\n }\n \n #[cfg(FALSE)]\n trait T {\n-    const X: u8 ;\n+    const X: u8;\n     type X;\n     fn foo();\n-    default const X: u8 ;\n+    default const X: u8;\n     default type X;\n     default fn foo();\n-    pub const X: u8 ;\n+    pub const X: u8;\n     pub type X;\n     pub fn foo();\n-    pub default const X: u8 ;\n+    pub default const X: u8;\n     pub default type X;\n     pub default fn foo();\n }\n \n #[cfg(FALSE)]\n impl T for S {\n-    const X: u8 ;\n+    const X: u8;\n     type X;\n     fn foo();\n-    default const X: u8 ;\n+    default const X: u8;\n     default type X;\n     default fn foo();\n-    pub const X: u8 ;\n+    pub const X: u8;\n     pub type X;\n     pub fn foo();\n-    pub default const X: u8 ;\n+    pub default const X: u8;\n     pub default type X;\n     pub default fn foo();\n }"}, {"sha": "7d1c05a85bcf54c3c4e0f0091591ee1adb16ca5d", "filename": "src/test/ui/macros/stringify.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/e810487b4de6e5122b802fea03f4b10c79d32467/src%2Ftest%2Fui%2Fmacros%2Fstringify.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e810487b4de6e5122b802fea03f4b10c79d32467/src%2Ftest%2Fui%2Fmacros%2Fstringify.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Fstringify.rs?ref=e810487b4de6e5122b802fea03f4b10c79d32467", "patch": "@@ -382,13 +382,13 @@ fn test_item() {\n         stringify_item!(\n             static S: ();\n         ),\n-        \"static S: () ;\", // FIXME\n+        \"static S: ();\",\n     );\n     assert_eq!(\n         stringify_item!(\n             static mut S: ();\n         ),\n-        \"static mut S: () ;\",\n+        \"static mut S: ();\",\n     );\n \n     // ItemKind::Const\n@@ -402,7 +402,7 @@ fn test_item() {\n         stringify_item!(\n             const S: ();\n         ),\n-        \"const S: () ;\", // FIXME\n+        \"const S: ();\",\n     );\n \n     // ItemKind::Fn"}]}