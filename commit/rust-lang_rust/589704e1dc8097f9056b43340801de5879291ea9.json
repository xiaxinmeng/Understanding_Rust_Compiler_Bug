{"sha": "589704e1dc8097f9056b43340801de5879291ea9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU4OTcwNGUxZGM4MDk3ZjkwNTZiNDMzNDA4MDFkZTU4NzkyOTFlYTk=", "commit": {"author": {"name": "llogiq", "email": "bogusandre@gmail.com", "date": "2018-03-21T19:55:35Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-03-21T19:55:35Z"}, "message": "Merge pull request #2561 from mikerite/walk_ptrs_ty_depth_pr\n\nMinor refactoring (walk_ptrs_ty_depth)", "tree": {"sha": "4a36333c57585201c1947c1157e4bb2001d8e4e3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4a36333c57585201c1947c1157e4bb2001d8e4e3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/589704e1dc8097f9056b43340801de5879291ea9", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJasri3CRBK7hj4Ov3rIwAAdHIIAJ7iD3I1wlpiljmkj2TnpW96\nuhS2UlIrGjncJdnx/8N088LGAw8lvmh7+OmEU1acCxz5q8KCNpnk9Nq8RWyV5bUB\nqv+TxNyhrVIPlWaJa4m7DWRUycDtohh0YDMJVyK5kZy56k6Hnkoy0agEQkjj0JrM\njWCeRmWvYM1po2DYZGNrP9SWFdDxcFC2LgKlzefJRL1JunnCm09S62VoYw1V3zJf\n1qSVGJ4cCPpLsnoT36YI4VuZu/IA6OjNa7pEKoKA8UxlRvQUWGjUB+4VK3eS2l7g\nWH0l04rBDELy4jTFxMGU/hBABUTX+5VEhpOY96Z1U9jHrXnI8eU+FnTNSLXsgK8=\n=8yw8\n-----END PGP SIGNATURE-----\n", "payload": "tree 4a36333c57585201c1947c1157e4bb2001d8e4e3\nparent 2d01f42ddef14fc6170fed0334641a475de02bee\nparent 70d8f85e7edc591b6a78b5d68a39151c95a1bf20\nauthor llogiq <bogusandre@gmail.com> 1521662135 +0100\ncommitter GitHub <noreply@github.com> 1521662135 +0100\n\nMerge pull request #2561 from mikerite/walk_ptrs_ty_depth_pr\n\nMinor refactoring (walk_ptrs_ty_depth)"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/589704e1dc8097f9056b43340801de5879291ea9", "html_url": "https://github.com/rust-lang/rust/commit/589704e1dc8097f9056b43340801de5879291ea9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/589704e1dc8097f9056b43340801de5879291ea9/comments", "author": {"login": "llogiq", "id": 4200835, "node_id": "MDQ6VXNlcjQyMDA4MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4200835?v=4", "gravatar_id": "", "url": "https://api.github.com/users/llogiq", "html_url": "https://github.com/llogiq", "followers_url": "https://api.github.com/users/llogiq/followers", "following_url": "https://api.github.com/users/llogiq/following{/other_user}", "gists_url": "https://api.github.com/users/llogiq/gists{/gist_id}", "starred_url": "https://api.github.com/users/llogiq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/llogiq/subscriptions", "organizations_url": "https://api.github.com/users/llogiq/orgs", "repos_url": "https://api.github.com/users/llogiq/repos", "events_url": "https://api.github.com/users/llogiq/events{/privacy}", "received_events_url": "https://api.github.com/users/llogiq/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2d01f42ddef14fc6170fed0334641a475de02bee", "url": "https://api.github.com/repos/rust-lang/rust/commits/2d01f42ddef14fc6170fed0334641a475de02bee", "html_url": "https://github.com/rust-lang/rust/commit/2d01f42ddef14fc6170fed0334641a475de02bee"}, {"sha": "70d8f85e7edc591b6a78b5d68a39151c95a1bf20", "url": "https://api.github.com/repos/rust-lang/rust/commits/70d8f85e7edc591b6a78b5d68a39151c95a1bf20", "html_url": "https://github.com/rust-lang/rust/commit/70d8f85e7edc591b6a78b5d68a39151c95a1bf20"}], "stats": {"total": 15, "additions": 7, "deletions": 8}, "files": [{"sha": "a9882bdfe0cd3e182883f86cd9ee17fab1938aa2", "filename": "clippy_lints/src/methods.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/589704e1dc8097f9056b43340801de5879291ea9/clippy_lints%2Fsrc%2Fmethods.rs", "raw_url": "https://github.com/rust-lang/rust/raw/589704e1dc8097f9056b43340801de5879291ea9/clippy_lints%2Fsrc%2Fmethods.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods.rs?ref=589704e1dc8097f9056b43340801de5879291ea9", "patch": "@@ -1034,7 +1034,7 @@ fn lint_clone_on_copy(cx: &LateContext, expr: &hir::Expr, arg: &hir::Expr, arg_t\n }\n \n fn lint_clone_on_ref_ptr(cx: &LateContext, expr: &hir::Expr, arg: &hir::Expr) {\n-    let (obj_ty, _) = walk_ptrs_ty_depth(cx.tables.expr_ty(arg));\n+    let obj_ty = walk_ptrs_ty(cx.tables.expr_ty(arg));\n \n     if let ty::TyAdt(_, subst) = obj_ty.sty {\n         let caller_type = if match_type(cx, obj_ty, &paths::RC) {\n@@ -1063,7 +1063,7 @@ fn lint_string_extend(cx: &LateContext, expr: &hir::Expr, args: &[hir::Expr]) {\n     let arg = &args[1];\n     if let Some(arglists) = method_chain_args(arg, &[\"chars\"]) {\n         let target = &arglists[0][0];\n-        let (self_ty, _) = walk_ptrs_ty_depth(cx.tables.expr_ty(target));\n+        let self_ty = walk_ptrs_ty(cx.tables.expr_ty(target));\n         let ref_str = if self_ty.sty == ty::TyStr {\n             \"\"\n         } else if match_type(cx, self_ty, &paths::STRING) {\n@@ -1089,7 +1089,7 @@ fn lint_string_extend(cx: &LateContext, expr: &hir::Expr, args: &[hir::Expr]) {\n }\n \n fn lint_extend(cx: &LateContext, expr: &hir::Expr, args: &[hir::Expr]) {\n-    let (obj_ty, _) = walk_ptrs_ty_depth(cx.tables.expr_ty(&args[0]));\n+    let obj_ty = walk_ptrs_ty(cx.tables.expr_ty(&args[0]));\n     if match_type(cx, obj_ty, &paths::STRING) {\n         lint_string_extend(cx, expr, args);\n     }\n@@ -1327,7 +1327,7 @@ fn derefs_to_slice(cx: &LateContext, expr: &hir::Expr, ty: Ty) -> Option<sugg::S\n \n /// lint use of `unwrap()` for `Option`s and `Result`s\n fn lint_unwrap(cx: &LateContext, expr: &hir::Expr, unwrap_args: &[hir::Expr]) {\n-    let (obj_ty, _) = walk_ptrs_ty_depth(cx.tables.expr_ty(&unwrap_args[0]));\n+    let obj_ty = walk_ptrs_ty(cx.tables.expr_ty(&unwrap_args[0]));\n \n     let mess = if match_type(cx, obj_ty, &paths::OPTION) {\n         Some((OPTION_UNWRAP_USED, \"an Option\", \"None\"))"}, {"sha": "248990f4f37bfded22d902b555c2b51316ecb80e", "filename": "clippy_lints/src/open_options.rs", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/589704e1dc8097f9056b43340801de5879291ea9/clippy_lints%2Fsrc%2Fopen_options.rs", "raw_url": "https://github.com/rust-lang/rust/raw/589704e1dc8097f9056b43340801de5879291ea9/clippy_lints%2Fsrc%2Fopen_options.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fopen_options.rs?ref=589704e1dc8097f9056b43340801de5879291ea9", "patch": "@@ -2,7 +2,7 @@ use rustc::hir::{Expr, ExprLit, ExprMethodCall};\n use rustc::lint::*;\n use syntax::ast::LitKind;\n use syntax::codemap::{Span, Spanned};\n-use utils::{match_type, paths, span_lint, walk_ptrs_ty_depth};\n+use utils::{match_type, paths, span_lint, walk_ptrs_ty};\n \n /// **What it does:** Checks for duplicate open options as well as combinations\n /// that make no sense.\n@@ -22,7 +22,6 @@ declare_lint! {\n     \"nonsensical combination of options for opening a file\"\n }\n \n-\n #[derive(Copy, Clone)]\n pub struct NonSensical;\n \n@@ -35,7 +34,7 @@ impl LintPass for NonSensical {\n impl<'a, 'tcx> LateLintPass<'a, 'tcx> for NonSensical {\n     fn check_expr(&mut self, cx: &LateContext<'a, 'tcx>, e: &'tcx Expr) {\n         if let ExprMethodCall(ref path, _, ref arguments) = e.node {\n-            let (obj_ty, _) = walk_ptrs_ty_depth(cx.tables.expr_ty(&arguments[0]));\n+            let obj_ty = walk_ptrs_ty(cx.tables.expr_ty(&arguments[0]));\n             if path.name == \"open\" && match_type(cx, obj_ty, &paths::OPEN_OPTIONS) {\n                 let mut options = Vec::new();\n                 get_open_options(cx, &arguments[0], &mut options);\n@@ -63,7 +62,7 @@ enum OpenOption {\n \n fn get_open_options(cx: &LateContext, argument: &Expr, options: &mut Vec<(OpenOption, Argument)>) {\n     if let ExprMethodCall(ref path, _, ref arguments) = argument.node {\n-        let (obj_ty, _) = walk_ptrs_ty_depth(cx.tables.expr_ty(&arguments[0]));\n+        let obj_ty = walk_ptrs_ty(cx.tables.expr_ty(&arguments[0]));\n \n         // Only proceed if this is a call on some object of type std::fs::OpenOptions\n         if match_type(cx, obj_ty, &paths::OPEN_OPTIONS) && arguments.len() >= 2 {"}]}