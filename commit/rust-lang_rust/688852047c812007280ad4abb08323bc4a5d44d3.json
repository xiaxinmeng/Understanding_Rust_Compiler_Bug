{"sha": "688852047c812007280ad4abb08323bc4a5d44d3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY4ODg1MjA0N2M4MTIwMDcyODBhZDRhYmIwODMyM2JjNGE1ZDQ0ZDM=", "commit": {"author": {"name": "Isaac van Bakel", "email": "ivb@vanbakel.io", "date": "2017-07-27T01:43:11Z"}, "committer": {"name": "Isaac van Bakel", "email": "ivb@vanbakel.io", "date": "2017-07-27T01:43:11Z"}, "message": "Added tests for new loop borrow message\n\nOne set of tests is to ensure the current message is correct.\nThe other set is to check the messages are generated correctly for every\ntype of loop.", "tree": {"sha": "7a24b0cb4bb6d646b68f8fd2a13fa0ddb21850e1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7a24b0cb4bb6d646b68f8fd2a13fa0ddb21850e1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/688852047c812007280ad4abb08323bc4a5d44d3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/688852047c812007280ad4abb08323bc4a5d44d3", "html_url": "https://github.com/rust-lang/rust/commit/688852047c812007280ad4abb08323bc4a5d44d3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/688852047c812007280ad4abb08323bc4a5d44d3/comments", "author": {"login": "ivanbakel", "id": 20319565, "node_id": "MDQ6VXNlcjIwMzE5NTY1", "avatar_url": "https://avatars.githubusercontent.com/u/20319565?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ivanbakel", "html_url": "https://github.com/ivanbakel", "followers_url": "https://api.github.com/users/ivanbakel/followers", "following_url": "https://api.github.com/users/ivanbakel/following{/other_user}", "gists_url": "https://api.github.com/users/ivanbakel/gists{/gist_id}", "starred_url": "https://api.github.com/users/ivanbakel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ivanbakel/subscriptions", "organizations_url": "https://api.github.com/users/ivanbakel/orgs", "repos_url": "https://api.github.com/users/ivanbakel/repos", "events_url": "https://api.github.com/users/ivanbakel/events{/privacy}", "received_events_url": "https://api.github.com/users/ivanbakel/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ivanbakel", "id": 20319565, "node_id": "MDQ6VXNlcjIwMzE5NTY1", "avatar_url": "https://avatars.githubusercontent.com/u/20319565?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ivanbakel", "html_url": "https://github.com/ivanbakel", "followers_url": "https://api.github.com/users/ivanbakel/followers", "following_url": "https://api.github.com/users/ivanbakel/following{/other_user}", "gists_url": "https://api.github.com/users/ivanbakel/gists{/gist_id}", "starred_url": "https://api.github.com/users/ivanbakel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ivanbakel/subscriptions", "organizations_url": "https://api.github.com/users/ivanbakel/orgs", "repos_url": "https://api.github.com/users/ivanbakel/repos", "events_url": "https://api.github.com/users/ivanbakel/events{/privacy}", "received_events_url": "https://api.github.com/users/ivanbakel/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c802fc7103c35905e06e59e781a083f8ea36c0a2", "url": "https://api.github.com/repos/rust-lang/rust/commits/c802fc7103c35905e06e59e781a083f8ea36c0a2", "html_url": "https://github.com/rust-lang/rust/commit/c802fc7103c35905e06e59e781a083f8ea36c0a2"}], "stats": {"total": 118, "additions": 118, "deletions": 0}, "files": [{"sha": "addda42775399e7ea286af1ec121dccec1f189fa", "filename": "src/test/ui/borrowck/mut-borrow-in-loop.rs", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/688852047c812007280ad4abb08323bc4a5d44d3/src%2Ftest%2Fui%2Fborrowck%2Fmut-borrow-in-loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/688852047c812007280ad4abb08323bc4a5d44d3/src%2Ftest%2Fui%2Fborrowck%2Fmut-borrow-in-loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fmut-borrow-in-loop.rs?ref=688852047c812007280ad4abb08323bc4a5d44d3", "patch": "@@ -0,0 +1,40 @@\n+// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// produce special borrowck message inside all kinds of loops\n+\n+struct FuncWrapper<'a, T : 'a> {\n+    func : fn(&'a mut T) -> ()\n+}\n+\n+impl<'a, T : 'a> FuncWrapper<'a, T> {\n+    fn in_loop(self, arg : &'a mut T) {\n+        loop {\n+            (self.func)(arg)\n+        }\n+    }\n+\n+    fn in_while(self, arg : &'a mut T) {\n+        while true {\n+            (self.func)(arg)\n+        }\n+    }\n+\n+    fn in_for(self, arg : &'a mut T) {\n+        let v : Vec<()> = vec![];\n+        for _ in v.iter() {\n+            (self.func)(arg)\n+        }\n+    }\n+}\n+\n+fn main() {\n+}\n+"}, {"sha": "a34d524d28f2e08d0dc5cff8377575ae55cf4ac9", "filename": "src/test/ui/borrowck/mut-borrow-in-loop.stderr", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/688852047c812007280ad4abb08323bc4a5d44d3/src%2Ftest%2Fui%2Fborrowck%2Fmut-borrow-in-loop.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/688852047c812007280ad4abb08323bc4a5d44d3/src%2Ftest%2Fui%2Fborrowck%2Fmut-borrow-in-loop.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fmut-borrow-in-loop.stderr?ref=688852047c812007280ad4abb08323bc4a5d44d3", "patch": "@@ -0,0 +1,29 @@\n+error[E0499]: cannot borrow `*arg` as mutable more than once at a time\n+  --> $DIR/mut-borrow-in-loop.rs:20:25\n+   |\n+20 |             (self.func)(arg)\n+   |                         ^^^ mutable borrow starts here in previous iteration of loop\n+21 |         }\n+22 |     }\n+   |     - mutable borrow ends here\n+\n+error[E0499]: cannot borrow `*arg` as mutable more than once at a time\n+  --> $DIR/mut-borrow-in-loop.rs:26:25\n+   |\n+26 |             (self.func)(arg)\n+   |                         ^^^ mutable borrow starts here in previous iteration of loop\n+27 |         }\n+28 |     }\n+   |     - mutable borrow ends here\n+\n+error[E0499]: cannot borrow `*arg` as mutable more than once at a time\n+  --> $DIR/mut-borrow-in-loop.rs:33:25\n+   |\n+33 |             (self.func)(arg)\n+   |                         ^^^ mutable borrow starts here in previous iteration of loop\n+34 |         }\n+35 |     }\n+   |     - mutable borrow ends here\n+\n+error: aborting due to 3 previous errors\n+"}, {"sha": "97092b7f9d75934cccb87cdefd3519d457b669cd", "filename": "src/test/ui/borrowck/mut-borrow-outside-loop.rs", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/688852047c812007280ad4abb08323bc4a5d44d3/src%2Ftest%2Fui%2Fborrowck%2Fmut-borrow-outside-loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/688852047c812007280ad4abb08323bc4a5d44d3/src%2Ftest%2Fui%2Fborrowck%2Fmut-borrow-outside-loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fmut-borrow-outside-loop.rs?ref=688852047c812007280ad4abb08323bc4a5d44d3", "patch": "@@ -0,0 +1,26 @@\n+// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// ensure borrowck messages are correct outside special case\n+\n+fn main() {\n+    let mut void = ();\n+\n+    let first = &mut void;\n+    let second = &mut void;\n+\n+    loop {\n+        let mut inner_void = ();\n+\n+        let inner_first = &mut inner_void;\n+        let inner_second = &mut inner_void;\n+    }\n+}\n+"}, {"sha": "02b32dc363ae744d0f05abf0a9ae0bcdf96095c6", "filename": "src/test/ui/borrowck/mut-borrow-outside-loop.stderr", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/688852047c812007280ad4abb08323bc4a5d44d3/src%2Ftest%2Fui%2Fborrowck%2Fmut-borrow-outside-loop.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/688852047c812007280ad4abb08323bc4a5d44d3/src%2Ftest%2Fui%2Fborrowck%2Fmut-borrow-outside-loop.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fmut-borrow-outside-loop.stderr?ref=688852047c812007280ad4abb08323bc4a5d44d3", "patch": "@@ -0,0 +1,23 @@\n+error[E0499]: cannot borrow `void` as mutable more than once at a time\n+  --> $DIR/mut-borrow-outside-loop.rs:17:23\n+   |\n+16 |     let first = &mut void;\n+   |                      ---- first mutable borrow occurs here\n+17 |     let second = &mut void;\n+   |                       ^^^^ second mutable borrow occurs here\n+...\n+25 | }\n+   | - first borrow ends here\n+\n+error[E0499]: cannot borrow `inner_void` as mutable more than once at a time\n+  --> $DIR/mut-borrow-outside-loop.rs:23:33\n+   |\n+22 |         let inner_first = &mut inner_void;\n+   |                                ---------- first mutable borrow occurs here\n+23 |         let inner_second = &mut inner_void;\n+   |                                 ^^^^^^^^^^ second mutable borrow occurs here\n+24 |     }\n+   |     - first borrow ends here\n+\n+error: aborting due to 2 previous errors\n+"}]}