{"sha": "d1db782dffc085cc24a9024b31d6b83862b02d8a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQxZGI3ODJkZmZjMDg1Y2MyNGE5MDI0YjMxZDZiODM4NjJiMDJkOGE=", "commit": {"author": {"name": "Eduard-Mihai Burtescu", "email": "edy.burt@gmail.com", "date": "2020-04-17T13:55:08Z"}, "committer": {"name": "mark", "email": "markm@cs.wisc.edu", "date": "2020-04-24T18:31:37Z"}, "message": "Split out the `Generator` case from `DefKind::Closure`.", "tree": {"sha": "e67b620dc85c2bd13afa00f94d9247f1de2b77d9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e67b620dc85c2bd13afa00f94d9247f1de2b77d9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d1db782dffc085cc24a9024b31d6b83862b02d8a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d1db782dffc085cc24a9024b31d6b83862b02d8a", "html_url": "https://github.com/rust-lang/rust/commit/d1db782dffc085cc24a9024b31d6b83862b02d8a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d1db782dffc085cc24a9024b31d6b83862b02d8a/comments", "author": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mark-i-m", "id": 8827840, "node_id": "MDQ6VXNlcjg4Mjc4NDA=", "avatar_url": "https://avatars.githubusercontent.com/u/8827840?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mark-i-m", "html_url": "https://github.com/mark-i-m", "followers_url": "https://api.github.com/users/mark-i-m/followers", "following_url": "https://api.github.com/users/mark-i-m/following{/other_user}", "gists_url": "https://api.github.com/users/mark-i-m/gists{/gist_id}", "starred_url": "https://api.github.com/users/mark-i-m/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mark-i-m/subscriptions", "organizations_url": "https://api.github.com/users/mark-i-m/orgs", "repos_url": "https://api.github.com/users/mark-i-m/repos", "events_url": "https://api.github.com/users/mark-i-m/events{/privacy}", "received_events_url": "https://api.github.com/users/mark-i-m/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cff5b998e08ab3082512f72069fad38c12cc9702", "url": "https://api.github.com/repos/rust-lang/rust/commits/cff5b998e08ab3082512f72069fad38c12cc9702", "html_url": "https://github.com/rust-lang/rust/commit/cff5b998e08ab3082512f72069fad38c12cc9702"}], "stats": {"total": 18, "additions": 12, "deletions": 6}, "files": [{"sha": "8e87ce60ffd41fa4a356d0db5b18a211ee9e87d8", "filename": "src/librustc_hir/def.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d1db782dffc085cc24a9024b31d6b83862b02d8a/src%2Flibrustc_hir%2Fdef.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d1db782dffc085cc24a9024b31d6b83862b02d8a/src%2Flibrustc_hir%2Fdef.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_hir%2Fdef.rs?ref=d1db782dffc085cc24a9024b31d6b83862b02d8a", "patch": "@@ -88,6 +88,7 @@ pub enum DefKind {\n     GlobalAsm,\n     Impl,\n     Closure,\n+    Generator,\n }\n \n impl DefKind {\n@@ -131,6 +132,7 @@ impl DefKind {\n             DefKind::Field => \"field\",\n             DefKind::Impl => \"implementation\",\n             DefKind::Closure => \"closure\",\n+            DefKind::Generator => \"generator\",\n             DefKind::ExternCrate => \"extern crate\",\n             DefKind::GlobalAsm => \"global assembly block\",\n         }\n@@ -184,6 +186,7 @@ impl DefKind {\n             | DefKind::LifetimeParam\n             | DefKind::ExternCrate\n             | DefKind::Closure\n+            | DefKind::Generator\n             | DefKind::Use\n             | DefKind::ForeignMod\n             | DefKind::GlobalAsm"}, {"sha": "39d8213f2629b44df34f5ad221368f41ec1e1884", "filename": "src/librustc_metadata/rmeta/decoder.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d1db782dffc085cc24a9024b31d6b83862b02d8a/src%2Flibrustc_metadata%2Frmeta%2Fdecoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d1db782dffc085cc24a9024b31d6b83862b02d8a/src%2Flibrustc_metadata%2Frmeta%2Fdecoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Frmeta%2Fdecoder.rs?ref=d1db782dffc085cc24a9024b31d6b83862b02d8a", "patch": "@@ -592,7 +592,7 @@ impl EntryKind {\n             EntryKind::ForeignMod => DefKind::ForeignMod,\n             EntryKind::GlobalAsm => DefKind::GlobalAsm,\n             EntryKind::Field => DefKind::Field,\n-            EntryKind::Generator(_) => DefKind::Closure,\n+            EntryKind::Generator(_) => DefKind::Generator,\n         }\n     }\n }"}, {"sha": "bd383bde3b5916fc845c27cc499bab31b2edf4f7", "filename": "src/librustc_middle/hir/map/mod.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d1db782dffc085cc24a9024b31d6b83862b02d8a/src%2Flibrustc_middle%2Fhir%2Fmap%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d1db782dffc085cc24a9024b31d6b83862b02d8a/src%2Flibrustc_middle%2Fhir%2Fmap%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_middle%2Fhir%2Fmap%2Fmod.rs?ref=d1db782dffc085cc24a9024b31d6b83862b02d8a", "patch": "@@ -285,7 +285,8 @@ impl<'hir> Map<'hir> {\n             Node::AnonConst(_) => DefKind::AnonConst,\n             Node::Field(_) => DefKind::Field,\n             Node::Expr(expr) => match expr.kind {\n-                ExprKind::Closure { .. } => DefKind::Closure,\n+                ExprKind::Closure(.., None) => DefKind::Closure,\n+                ExprKind::Closure(.., Some(_)) => DefKind::Generator,\n                 _ => bug!(\"def_kind: unsupported node: {}\", self.node_to_string(hir_id)),\n             },\n             Node::MacroDef(_) => DefKind::Macro(MacroKind::Bang),"}, {"sha": "27bbf43bc853b71baec860b49d94d334ec1c6a67", "filename": "src/librustc_privacy/lib.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/d1db782dffc085cc24a9024b31d6b83862b02d8a/src%2Flibrustc_privacy%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d1db782dffc085cc24a9024b31d6b83862b02d8a/src%2Flibrustc_privacy%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_privacy%2Flib.rs?ref=d1db782dffc085cc24a9024b31d6b83862b02d8a", "patch": "@@ -613,8 +613,8 @@ impl EmbargoVisitor<'tcx> {\n                 }\n             }\n \n-            // These have type privacy or are not namespaced, so are not reachable unless they're\n-            // public.\n+            // These have type privacy, so are not reachable unless they're\n+            // public, or are not namespaced at all.\n             DefKind::AssocConst\n             | DefKind::AssocTy\n             | DefKind::AssocOpaqueTy\n@@ -636,7 +636,8 @@ impl EmbargoVisitor<'tcx> {\n             | DefKind::Field\n             | DefKind::GlobalAsm\n             | DefKind::Impl\n-            | DefKind::Closure => (),\n+            | DefKind::Closure\n+            | DefKind::Generator => (),\n         }\n     }\n "}, {"sha": "8456a0304fec6e9f00db0290919dcdd41969e09b", "filename": "src/librustc_save_analysis/lib.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d1db782dffc085cc24a9024b31d6b83862b02d8a/src%2Flibrustc_save_analysis%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d1db782dffc085cc24a9024b31d6b83862b02d8a/src%2Flibrustc_save_analysis%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_save_analysis%2Flib.rs?ref=d1db782dffc085cc24a9024b31d6b83862b02d8a", "patch": "@@ -771,7 +771,8 @@ impl<'l, 'tcx> SaveContext<'l, 'tcx> {\n                 | HirDefKind::Field\n                 | HirDefKind::GlobalAsm\n                 | HirDefKind::Impl\n-                | HirDefKind::Closure,\n+                | HirDefKind::Closure\n+                | HirDefKind::Generator,\n                 _,\n             )\n             | Res::PrimTy(..)"}]}