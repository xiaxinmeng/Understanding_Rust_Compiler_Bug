{"sha": "f500f3f1fb4092bf7993170d755377268943e94b", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY1MDBmM2YxZmI0MDkyYmY3OTkzMTcwZDc1NTM3NzI2ODk0M2U5NGI=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-10-23T02:16:52Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-10-23T21:21:15Z"}, "message": "core: Remove remaining use of Future", "tree": {"sha": "cb58d88939d87f603039a55e9bfb15d9b91de92c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cb58d88939d87f603039a55e9bfb15d9b91de92c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f500f3f1fb4092bf7993170d755377268943e94b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f500f3f1fb4092bf7993170d755377268943e94b", "html_url": "https://github.com/rust-lang/rust/commit/f500f3f1fb4092bf7993170d755377268943e94b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f500f3f1fb4092bf7993170d755377268943e94b/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3e4b2bd2b2f48c98dab73c67b0ddf25a80129a3c", "url": "https://api.github.com/repos/rust-lang/rust/commits/3e4b2bd2b2f48c98dab73c67b0ddf25a80129a3c", "html_url": "https://github.com/rust-lang/rust/commit/3e4b2bd2b2f48c98dab73c67b0ddf25a80129a3c"}], "stats": {"total": 10, "additions": 7, "deletions": 3}, "files": [{"sha": "a65e0ae1bb12ba69b1d0a0002b82b6e1844c7ed5", "filename": "src/libcore/private.rs", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/f500f3f1fb4092bf7993170d755377268943e94b/src%2Flibcore%2Fprivate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f500f3f1fb4092bf7993170d755377268943e94b/src%2Flibcore%2Fprivate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fprivate.rs?ref=f500f3f1fb4092bf7993170d755377268943e94b", "patch": "@@ -581,16 +581,20 @@ pub mod tests {\n \n         for uint::range(0, num_tasks) |_i| {\n             let total = total.clone();\n-            futures.push(future::spawn(|move total| {\n+            let (chan, port) = pipes::stream();\n+            futures.push(move port);\n+\n+            do task::spawn |move total, move chan| {\n                 for uint::range(0, count) |_i| {\n                     do total.with |count| {\n                         **count += 1;\n                     }\n                 }\n-            }));\n+                chan.send(());\n+            }\n         };\n \n-        for futures.each |f| { f.get() }\n+        for futures.each |f| { f.recv() }\n \n         do total.with |total| {\n             assert **total == num_tasks * count"}]}