{"sha": "f1aa8b2c01a97b0114f84b2d557e4598e6070515", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYxYWE4YjJjMDFhOTdiMDExNGY4NGIyZDU1N2U0NTk4ZTYwNzA1MTU=", "commit": {"author": {"name": "Agustin Fernandez", "email": "juan.fernandez@opower.com", "date": "2019-10-28T13:15:46Z"}, "committer": {"name": "Agustin Fernandez", "email": "juan.fernandez@opower.com", "date": "2019-10-28T19:49:22Z"}, "message": "Output previous stable error messaging when using stable build.", "tree": {"sha": "55fcd897220774e64611e7a7656446743738cfbb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/55fcd897220774e64611e7a7656446743738cfbb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f1aa8b2c01a97b0114f84b2d557e4598e6070515", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f1aa8b2c01a97b0114f84b2d557e4598e6070515", "html_url": "https://github.com/rust-lang/rust/commit/f1aa8b2c01a97b0114f84b2d557e4598e6070515", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f1aa8b2c01a97b0114f84b2d557e4598e6070515/comments", "author": null, "committer": null, "parents": [{"sha": "fae75cd216c481de048e4951697c8f8525669c65", "url": "https://api.github.com/repos/rust-lang/rust/commits/fae75cd216c481de048e4951697c8f8525669c65", "html_url": "https://github.com/rust-lang/rust/commit/fae75cd216c481de048e4951697c8f8525669c65"}], "stats": {"total": 19, "additions": 14, "deletions": 5}, "files": [{"sha": "73db762a64bda22d905ddb23135b1bedef35b723", "filename": "src/librustc/hir/lowering/expr.rs", "status": "modified", "additions": 14, "deletions": 5, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/f1aa8b2c01a97b0114f84b2d557e4598e6070515/src%2Flibrustc%2Fhir%2Flowering%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f1aa8b2c01a97b0114f84b2d557e4598e6070515/src%2Flibrustc%2Fhir%2Flowering%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Flowering%2Fexpr.rs?ref=f1aa8b2c01a97b0114f84b2d557e4598e6070515", "patch": "@@ -235,11 +235,20 @@ impl LoweringContext<'_> {\n     /// ```\n     fn lower_expr_let(&mut self, span: Span, pat: &Pat, scrutinee: &Expr) -> hir::ExprKind {\n         // If we got here, the `let` expression is not allowed.\n-        self.sess\n-            .struct_span_err(span, \"`let` expressions are not supported here\")\n-            .note(\"only supported directly in conditions of `if`- and `while`-expressions\")\n-            .note(\"as well as when nested within `&&` and parenthesis in those conditions\")\n-            .emit();\n+\n+        if self.sess.opts.unstable_features.is_nightly_build() {\n+            self.sess\n+                .struct_span_err(span, \"`let` expressions are not supported here\")\n+                .note(\"only supported directly in conditions of `if`- and `while`-expressions\")\n+                .note(\"as well as when nested within `&&` and parenthesis in those conditions\")\n+                .emit();\n+        }\n+        else {\n+            self.sess\n+                .struct_span_err(span, \"expected expression, found statement (`let`)\")\n+                .note(\"variable declaration using `let` is a statement\")\n+                .emit();\n+        }\n \n         // For better recovery, we emit:\n         // ```"}]}