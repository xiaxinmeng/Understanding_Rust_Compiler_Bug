{"sha": "dc591e18e8597703caa6d84482ff59ba535f83d1", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRjNTkxZTE4ZTg1OTc3MDNjYWE2ZDg0NDgyZmY1OWJhNTM1ZjgzZDE=", "commit": {"author": {"name": "LeSeulArtichaut", "email": "leseulartichaut@gmail.com", "date": "2021-06-21T20:41:27Z"}, "committer": {"name": "LeSeulArtichaut", "email": "leseulartichaut@gmail.com", "date": "2021-06-22T09:36:19Z"}, "message": "Accept `!{}` and `![]` as macro disambiguators", "tree": {"sha": "414326a9d57a4d7fb06408c838699ad340773314", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/414326a9d57a4d7fb06408c838699ad340773314"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/dc591e18e8597703caa6d84482ff59ba535f83d1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/dc591e18e8597703caa6d84482ff59ba535f83d1", "html_url": "https://github.com/rust-lang/rust/commit/dc591e18e8597703caa6d84482ff59ba535f83d1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/dc591e18e8597703caa6d84482ff59ba535f83d1/comments", "author": {"login": "LeSeulArtichaut", "id": 38361244, "node_id": "MDQ6VXNlcjM4MzYxMjQ0", "avatar_url": "https://avatars.githubusercontent.com/u/38361244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LeSeulArtichaut", "html_url": "https://github.com/LeSeulArtichaut", "followers_url": "https://api.github.com/users/LeSeulArtichaut/followers", "following_url": "https://api.github.com/users/LeSeulArtichaut/following{/other_user}", "gists_url": "https://api.github.com/users/LeSeulArtichaut/gists{/gist_id}", "starred_url": "https://api.github.com/users/LeSeulArtichaut/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LeSeulArtichaut/subscriptions", "organizations_url": "https://api.github.com/users/LeSeulArtichaut/orgs", "repos_url": "https://api.github.com/users/LeSeulArtichaut/repos", "events_url": "https://api.github.com/users/LeSeulArtichaut/events{/privacy}", "received_events_url": "https://api.github.com/users/LeSeulArtichaut/received_events", "type": "User", "site_admin": false}, "committer": {"login": "LeSeulArtichaut", "id": 38361244, "node_id": "MDQ6VXNlcjM4MzYxMjQ0", "avatar_url": "https://avatars.githubusercontent.com/u/38361244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LeSeulArtichaut", "html_url": "https://github.com/LeSeulArtichaut", "followers_url": "https://api.github.com/users/LeSeulArtichaut/followers", "following_url": "https://api.github.com/users/LeSeulArtichaut/following{/other_user}", "gists_url": "https://api.github.com/users/LeSeulArtichaut/gists{/gist_id}", "starred_url": "https://api.github.com/users/LeSeulArtichaut/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LeSeulArtichaut/subscriptions", "organizations_url": "https://api.github.com/users/LeSeulArtichaut/orgs", "repos_url": "https://api.github.com/users/LeSeulArtichaut/repos", "events_url": "https://api.github.com/users/LeSeulArtichaut/events{/privacy}", "received_events_url": "https://api.github.com/users/LeSeulArtichaut/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4cd5affcf2d4a9c708b4f20d4f3afaaa3e3c5b2a", "url": "https://api.github.com/repos/rust-lang/rust/commits/4cd5affcf2d4a9c708b4f20d4f3afaaa3e3c5b2a", "html_url": "https://github.com/rust-lang/rust/commit/4cd5affcf2d4a9c708b4f20d4f3afaaa3e3c5b2a"}], "stats": {"total": 8, "additions": 5, "deletions": 3}, "files": [{"sha": "2877af1d0f9811229c580122b037484b153f1fd7", "filename": "src/librustdoc/passes/collect_intra_doc_links.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/dc591e18e8597703caa6d84482ff59ba535f83d1/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dc591e18e8597703caa6d84482ff59ba535f83d1/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs?ref=dc591e18e8597703caa6d84482ff59ba535f83d1", "patch": "@@ -951,9 +951,9 @@ fn preprocess_link<'a>(\n     }\n \n     // Parse and strip the disambiguator from the link, if present.\n-    let (link_text, path_str, disambiguator) = match Disambiguator::from_str(&link) {\n-        Ok(Some((d, path, link_text))) => (link_text.trim(), path.trim(), Some(d)),\n-        Ok(None) => (link.trim(), link.trim(), None),\n+    let (disambiguator, path_str, link_text) = match Disambiguator::from_str(&link) {\n+        Ok(Some((d, path, link_text))) => (Some(d), path.trim(), link_text.trim()),\n+        Ok(None) => (None, link.trim(), link.trim()),\n         Err((err_msg, relative_range)) => {\n             // Only report error if we would not have ignored this link. See issue #83859.\n             if !should_ignore_link_with_disambiguators(link) {\n@@ -1538,6 +1538,8 @@ impl Disambiguator {\n         } else {\n             let suffixes = [\n                 (\"!()\", DefKind::Macro(MacroKind::Bang)),\n+                (\"!{}\", DefKind::Macro(MacroKind::Bang)),\n+                (\"![]\", DefKind::Macro(MacroKind::Bang)),\n                 (\"()\", DefKind::Fn),\n                 (\"!\", DefKind::Macro(MacroKind::Bang)),\n             ];"}]}