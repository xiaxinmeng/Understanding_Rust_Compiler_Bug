{"sha": "85dfa9d1a33be7a4e7276e03660fb9966057cb6e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg1ZGZhOWQxYTMzYmU3YTRlNzI3NmUwMzY2MGZiOTk2NjA1N2NiNmU=", "commit": {"author": {"name": "bobtwinkles", "email": "srkoser+GitHub@gmail.com", "date": "2018-02-08T01:00:54Z"}, "committer": {"name": "bobtwinkles", "email": "srkoser+GitHub@gmail.com", "date": "2018-02-08T01:00:54Z"}, "message": "Fix tests for MIR loop lowering\n\nFixes the hash test to recognize that MirValidated can change when changing\naround labels, and add a new test that makes sure we're lowering loop statements\ncorrectly.", "tree": {"sha": "2db91c69e0a871f2580f95ac6eea3dcfa0aa7917", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2db91c69e0a871f2580f95ac6eea3dcfa0aa7917"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/85dfa9d1a33be7a4e7276e03660fb9966057cb6e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/85dfa9d1a33be7a4e7276e03660fb9966057cb6e", "html_url": "https://github.com/rust-lang/rust/commit/85dfa9d1a33be7a4e7276e03660fb9966057cb6e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/85dfa9d1a33be7a4e7276e03660fb9966057cb6e/comments", "author": {"login": "bobtwinkles", "id": 1514748, "node_id": "MDQ6VXNlcjE1MTQ3NDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1514748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bobtwinkles", "html_url": "https://github.com/bobtwinkles", "followers_url": "https://api.github.com/users/bobtwinkles/followers", "following_url": "https://api.github.com/users/bobtwinkles/following{/other_user}", "gists_url": "https://api.github.com/users/bobtwinkles/gists{/gist_id}", "starred_url": "https://api.github.com/users/bobtwinkles/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bobtwinkles/subscriptions", "organizations_url": "https://api.github.com/users/bobtwinkles/orgs", "repos_url": "https://api.github.com/users/bobtwinkles/repos", "events_url": "https://api.github.com/users/bobtwinkles/events{/privacy}", "received_events_url": "https://api.github.com/users/bobtwinkles/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bobtwinkles", "id": 1514748, "node_id": "MDQ6VXNlcjE1MTQ3NDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1514748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bobtwinkles", "html_url": "https://github.com/bobtwinkles", "followers_url": "https://api.github.com/users/bobtwinkles/followers", "following_url": "https://api.github.com/users/bobtwinkles/following{/other_user}", "gists_url": "https://api.github.com/users/bobtwinkles/gists{/gist_id}", "starred_url": "https://api.github.com/users/bobtwinkles/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bobtwinkles/subscriptions", "organizations_url": "https://api.github.com/users/bobtwinkles/orgs", "repos_url": "https://api.github.com/users/bobtwinkles/repos", "events_url": "https://api.github.com/users/bobtwinkles/events{/privacy}", "received_events_url": "https://api.github.com/users/bobtwinkles/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8e0c3f5c462acc7da61c59e81510765da1919e80", "url": "https://api.github.com/repos/rust-lang/rust/commits/8e0c3f5c462acc7da61c59e81510765da1919e80", "html_url": "https://github.com/rust-lang/rust/commit/8e0c3f5c462acc7da61c59e81510765da1919e80"}], "stats": {"total": 51, "additions": 50, "deletions": 1}, "files": [{"sha": "8599f8d7f9a004bacfda7b8bf32cc833ffa6f7b0", "filename": "src/test/incremental/hashes/loop_expressions.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/85dfa9d1a33be7a4e7276e03660fb9966057cb6e/src%2Ftest%2Fincremental%2Fhashes%2Floop_expressions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/85dfa9d1a33be7a4e7276e03660fb9966057cb6e/src%2Ftest%2Fincremental%2Fhashes%2Floop_expressions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fincremental%2Fhashes%2Floop_expressions.rs?ref=85dfa9d1a33be7a4e7276e03660fb9966057cb6e", "patch": "@@ -179,7 +179,7 @@ pub fn change_continue_label() {\n }\n \n #[cfg(not(cfail1))]\n-#[rustc_clean(cfg=\"cfail2\", except=\"HirBody, TypeckTables\")]\n+#[rustc_clean(cfg=\"cfail2\", except=\"HirBody, MirValidated, TypeckTables\")]\n #[rustc_clean(cfg=\"cfail3\")]\n pub fn change_continue_label() {\n     let mut _x = 0;"}, {"sha": "d36d89080949760b8381d19e21c366ff611b6d3a", "filename": "src/test/mir-opt/loop_test.rs", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/rust-lang/rust/blob/85dfa9d1a33be7a4e7276e03660fb9966057cb6e/src%2Ftest%2Fmir-opt%2Floop_test.rs", "raw_url": "https://github.com/rust-lang/rust/raw/85dfa9d1a33be7a4e7276e03660fb9966057cb6e/src%2Ftest%2Fmir-opt%2Floop_test.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Floop_test.rs?ref=85dfa9d1a33be7a4e7276e03660fb9966057cb6e", "patch": "@@ -0,0 +1,49 @@\n+// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// compile-flags: -Z identify_regions -Z emit-end-regions\n+\n+// Tests to make sure we correctly generate falseUnwind edges in loops\n+\n+fn main() {\n+    // Exit early at runtime. Since only care about the generated MIR\n+    // and not the runtime behavior (which is exercised by other tests)\n+    // we just bail early. Without this the test just loops infinitely.\n+    if true {\n+        return;\n+    }\n+    loop {\n+        let x = 1;\n+        continue;\n+    }\n+}\n+\n+// END RUST SOURCE\n+// START rustc.main.SimplifyCfg-qualify-consts.after.mir\n+//    ...\n+//    bb1: { // The cleanup block\n+//        resume;\n+//    }\n+//    ...\n+//    bb3: { // Entry into the loop\n+//        _1 = ();\n+//        goto -> bb4;\n+//    }\n+//    bb4: { // The loop_block\n+//        falseUnwind -> [real: bb5, cleanup: bb1];\n+//    }\n+//    bb5: { // The loop body (body_block)\n+//        StorageLive(_5);\n+//        _5 = const 1i32;\n+//        StorageDead(_5);\n+//        goto -> bb4;\n+//    }\n+//    ...\n+// END rustc.main.SimplifyCfg-qualify-consts.after.mir"}]}