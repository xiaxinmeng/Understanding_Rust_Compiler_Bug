{"sha": "23e5fa164e7be9662024aa60d0c34277b02e5c0a", "node_id": "C_kwDOAAsO6NoAKDIzZTVmYTE2NGU3YmU5NjYyMDI0YWE2MGQwYzM0Mjc3YjAyZTVjMGE", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-11-16T16:36:43Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-11-17T19:21:54Z"}, "message": "Migrate GUI test to use functions", "tree": {"sha": "1f6653609ae2e8f717da844eb8d264734248074c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1f6653609ae2e8f717da844eb8d264734248074c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/23e5fa164e7be9662024aa60d0c34277b02e5c0a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/23e5fa164e7be9662024aa60d0c34277b02e5c0a", "html_url": "https://github.com/rust-lang/rust/commit/23e5fa164e7be9662024aa60d0c34277b02e5c0a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/23e5fa164e7be9662024aa60d0c34277b02e5c0a/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "928d14bcd1976ffd33e743aa09c7c22a063bf87c", "url": "https://api.github.com/repos/rust-lang/rust/commits/928d14bcd1976ffd33e743aa09c7c22a063bf87c", "html_url": "https://github.com/rust-lang/rust/commit/928d14bcd1976ffd33e743aa09c7c22a063bf87c"}], "stats": {"total": 249, "additions": 87, "deletions": 162}, "files": [{"sha": "abf8af77715c9eec5da0306c825e479abcf5db59", "filename": "src/test/rustdoc-gui/sidebar-source-code-display.goml", "status": "modified", "additions": 87, "deletions": 162, "changes": 249, "blob_url": "https://github.com/rust-lang/rust/blob/23e5fa164e7be9662024aa60d0c34277b02e5c0a/src%2Ftest%2Frustdoc-gui%2Fsidebar-source-code-display.goml", "raw_url": "https://github.com/rust-lang/rust/raw/23e5fa164e7be9662024aa60d0c34277b02e5c0a/src%2Ftest%2Frustdoc-gui%2Fsidebar-source-code-display.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsidebar-source-code-display.goml?ref=23e5fa164e7be9662024aa60d0c34277b02e5c0a", "patch": "@@ -29,170 +29,95 @@ assert-local-storage: {\"rustdoc-source-sidebar-show\": \"true\"}\n // Now we check the display of the sidebar items.\n show-text: true\n \n-// First we start with the light theme.\n-local-storage: {\"rustdoc-theme\": \"light\", \"rustdoc-use-system-theme\": \"false\"}\n-reload:\n-// Waiting for the sidebar to be displayed...\n-wait-for-css: (\"#sidebar-toggle\", {\"visibility\": \"visible\"})\n-assert-css: (\n-    \"#source-sidebar details[open] > .files a.selected\",\n-    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(255, 255, 255)\"},\n-)\n-// Without hover or focus.\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgba(0, 0, 0, 0)\"})\n-// With focus.\n-focus: \"#sidebar-toggle > button\"\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgb(224, 224, 224)\"})\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#sidebar-toggle > button\"\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgb(224, 224, 224)\"})\n-// Without hover.\n-assert-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n-)\n-// With focus.\n-focus: \"#source-sidebar details[open] > .files a:not(.selected)\"\n-wait-for-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(224, 224, 224)\"},\n-)\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#source-sidebar details[open] > .files a:not(.selected)\"\n-assert-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(224, 224, 224)\"},\n-)\n-// Without hover.\n-assert-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n-)\n-// With focus.\n-focus: \"#source-sidebar details[open] > .folders > details > summary\"\n-wait-for-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(224, 224, 224)\"},\n-)\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#source-sidebar details[open] > .folders > details > summary\"\n-assert-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(224, 224, 224)\"},\n+define-function: (\n+    \"check-colors\",\n+    (\n+        theme, color, color_hover, background, background_hover, background_toggle,\n+        background_toggle_hover,\n+    ),\n+    [\n+        (\"local-storage\", {\"rustdoc-theme\": |theme|, \"rustdoc-use-system-theme\": \"false\"}),\n+        (\"reload\"),\n+        (\"wait-for-css\", (\"#sidebar-toggle\", {\"visibility\": \"visible\"})),\n+        (\"assert-css\", (\n+            \"#source-sidebar details[open] > .files a.selected\",\n+            {\"color\": |color_hover|, \"background-color\": |background|},\n+        )),\n+        // Without hover or focus.\n+        (\"assert-css\", (\"#sidebar-toggle > button\", {\"background-color\": |background_toggle|})),\n+        // With focus.\n+        (\"focus\", \"#sidebar-toggle > button\"),\n+        (\"assert-css\", (\"#sidebar-toggle > button\", {\"background-color\": |background_toggle_hover|})),\n+        (\"focus\", \".search-input\"),\n+        // With hover.\n+        (\"move-cursor-to\", \"#sidebar-toggle > button\"),\n+        (\"assert-css\", (\"#sidebar-toggle > button\", {\"background-color\": |background_toggle_hover|})),\n+        // Without hover.\n+        (\"assert-css\", (\n+            \"#source-sidebar details[open] > .files a:not(.selected)\",\n+            {\"color\": |color|, \"background-color\": |background_toggle|},\n+        )),\n+        // With focus.\n+        (\"focus\", \"#source-sidebar details[open] > .files a:not(.selected)\"),\n+        (\"wait-for-css\", (\n+            \"#source-sidebar details[open] > .files a:not(.selected)\",\n+            {\"color\": |color_hover|, \"background-color\": |background_hover|},\n+        )),\n+        (\"focus\", \".search-input\"),\n+        // With hover.\n+        (\"move-cursor-to\", \"#source-sidebar details[open] > .files a:not(.selected)\"),\n+        (\"assert-css\", (\n+            \"#source-sidebar details[open] > .files a:not(.selected)\",\n+            {\"color\": |color_hover|, \"background-color\": |background_hover|},\n+        )),\n+        // Without hover.\n+        (\"assert-css\", (\n+            \"#source-sidebar details[open] > .folders > details > summary\",\n+            {\"color\": |color|, \"background-color\": |background_toggle|},\n+        )),\n+        // With focus.\n+        (\"focus\", \"#source-sidebar details[open] > .folders > details > summary\"),\n+        (\"wait-for-css\", (\n+            \"#source-sidebar details[open] > .folders > details > summary\",\n+            {\"color\": |color_hover|, \"background-color\": |background_hover|},\n+        )),\n+        (\"focus\", \".search-input\"),\n+        // With hover.\n+        (\"move-cursor-to\", \"#source-sidebar details[open] > .folders > details > summary\"),\n+        (\"assert-css\", (\n+            \"#source-sidebar details[open] > .folders > details > summary\",\n+            {\"color\": |color_hover|, \"background-color\": |background_hover|},\n+        )),\n+    ],\n )\n \n-// Now with the dark theme.\n-local-storage: {\"rustdoc-theme\": \"dark\", \"rustdoc-use-system-theme\": \"false\"}\n-reload:\n-// Waiting for the sidebar to be displayed...\n-wait-for-css: (\"#sidebar-toggle\", {\"visibility\": \"visible\"})\n-assert-css: (\n-    \"#source-sidebar details[open] > .files > a.selected\",\n-    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(51, 51, 51)\"},\n-)\n-// Without hover or focus.\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgba(0, 0, 0, 0)\"})\n-// With focus.\n-focus: \"#sidebar-toggle > button\"\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgb(103, 103, 103)\"})\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#sidebar-toggle > button\"\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgb(103, 103, 103)\"})\n-// Without hover.\n-assert-css: (\n-    \"#source-sidebar details[open] > .files > a:not(.selected)\",\n-    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n-)\n-// With focus.\n-focus: \"#source-sidebar details[open] > .files a:not(.selected)\"\n-wait-for-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(68, 68, 68)\"},\n-)\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#source-sidebar details[open] > .files a:not(.selected)\"\n-assert-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(68, 68, 68)\"},\n-)\n-// Without hover.\n-assert-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n-)\n-// With focus.\n-focus: \"#source-sidebar details[open] > .folders > details > summary\"\n-wait-for-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(68, 68, 68)\"},\n-)\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#source-sidebar details[open] > .folders > details > summary\"\n-assert-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(68, 68, 68)\"},\n-)\n-\n-// And finally with the ayu theme.\n-local-storage: {\"rustdoc-theme\": \"ayu\", \"rustdoc-use-system-theme\": \"false\"}\n-reload:\n-// Waiting for the sidebar to be displayed...\n-wait-for-css: (\"#sidebar-toggle\", {\"visibility\": \"visible\"})\n-assert-css: (\n-    \"#source-sidebar details[open] > .files a.selected\",\n-    {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n-)\n-// Without hover or focus.\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgba(0, 0, 0, 0)\"})\n-// With focus.\n-focus: \"#sidebar-toggle > button\"\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgba(70, 70, 70, 0.33)\"})\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#sidebar-toggle > button\"\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgba(70, 70, 70, 0.33)\"})\n-// Without hover.\n-assert-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(197, 197, 197)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n-)\n-// With focus.\n-focus: \"#source-sidebar details[open] > .files a:not(.selected)\"\n-wait-for-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n-)\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#source-sidebar details[open] > .files a:not(.selected)\"\n-assert-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n-)\n-// Without hover.\n-assert-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(197, 197, 197)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n-)\n-// With focus.\n-focus: \"#source-sidebar details[open] > .folders > details > summary\"\n-wait-for-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n-)\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#source-sidebar details[open] > .folders > details > summary\"\n-assert-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n-)\n+call-function: (\"check-colors\", {\n+    \"theme\": \"light\",\n+    \"color\": \"rgb(0, 0, 0)\",\n+    \"color_hover\": \"rgb(0, 0, 0)\",\n+    \"background\": \"rgb(255, 255, 255)\",\n+    \"background_hover\": \"rgb(224, 224, 224)\",\n+    \"background_toggle\": \"rgba(0, 0, 0, 0)\",\n+    \"background_toggle_hover\": \"rgb(224, 224, 224)\",\n+})\n+call-function: (\"check-colors\", {\n+    \"theme\": \"dark\",\n+    \"color\": \"rgb(221, 221, 221)\",\n+    \"color_hover\": \"rgb(221, 221, 221)\",\n+    \"background\": \"rgb(51, 51, 51)\",\n+    \"background_hover\": \"rgb(68, 68, 68)\",\n+    \"background_toggle\": \"rgba(0, 0, 0, 0)\",\n+    \"background_toggle_hover\": \"rgb(103, 103, 103)\",\n+})\n+call-function: (\"check-colors\", {\n+    \"theme\": \"ayu\",\n+    \"color\": \"rgb(197, 197, 197)\",\n+    \"color_hover\": \"rgb(255, 180, 76)\",\n+    \"background\": \"rgb(20, 25, 31)\",\n+    \"background_hover\": \"rgb(20, 25, 31)\",\n+    \"background_toggle\": \"rgba(0, 0, 0, 0)\",\n+    \"background_toggle_hover\": \"rgba(70, 70, 70, 0.33)\",\n+})\n \n // Now checking on mobile devices.\n size: (500, 700)"}]}