{"sha": "8a40e2e9e3f732f6e720969f6a26b74fcaefc34b", "node_id": "C_kwDOAAsO6NoAKDhhNDBlMmU5ZTNmNzMyZjZlNzIwOTY5ZjZhMjZiNzRmY2FlZmMzNGI", "commit": {"author": {"name": "Ben Kimock", "email": "kimockb@gmail.com", "date": "2022-06-08T23:32:43Z"}, "committer": {"name": "Ben Kimock", "email": "kimockb@gmail.com", "date": "2022-06-09T01:35:02Z"}, "message": "Add more bench-cargo-miri programs\n\nThese example programs are derived from long-running (>15 minutes) tests\nin the test suites of highly-downloaded crates. They should serve as\nrealistic but also somewhat pathological workloads for the interpreter.\n\nThe unicode program stresses the code which looks for adjacent and equal\nstacks to merge them.\n\nThe backtrace program has an uncommonly large working set of borrow tags\nper borrow stack.\n\nThis also updates the .gitignore to ignore files commonly emitted in the\ncourse of using these benchmark programs.", "tree": {"sha": "b9bd649a00996e8d1374f8794e413566ff391a88", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b9bd649a00996e8d1374f8794e413566ff391a88"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b", "html_url": "https://github.com/rust-lang/rust/commit/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/comments", "author": {"login": "saethlin", "id": 12105168, "node_id": "MDQ6VXNlcjEyMTA1MTY4", "avatar_url": "https://avatars.githubusercontent.com/u/12105168?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saethlin", "html_url": "https://github.com/saethlin", "followers_url": "https://api.github.com/users/saethlin/followers", "following_url": "https://api.github.com/users/saethlin/following{/other_user}", "gists_url": "https://api.github.com/users/saethlin/gists{/gist_id}", "starred_url": "https://api.github.com/users/saethlin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saethlin/subscriptions", "organizations_url": "https://api.github.com/users/saethlin/orgs", "repos_url": "https://api.github.com/users/saethlin/repos", "events_url": "https://api.github.com/users/saethlin/events{/privacy}", "received_events_url": "https://api.github.com/users/saethlin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "saethlin", "id": 12105168, "node_id": "MDQ6VXNlcjEyMTA1MTY4", "avatar_url": "https://avatars.githubusercontent.com/u/12105168?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saethlin", "html_url": "https://github.com/saethlin", "followers_url": "https://api.github.com/users/saethlin/followers", "following_url": "https://api.github.com/users/saethlin/following{/other_user}", "gists_url": "https://api.github.com/users/saethlin/gists{/gist_id}", "starred_url": "https://api.github.com/users/saethlin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saethlin/subscriptions", "organizations_url": "https://api.github.com/users/saethlin/orgs", "repos_url": "https://api.github.com/users/saethlin/repos", "events_url": "https://api.github.com/users/saethlin/events{/privacy}", "received_events_url": "https://api.github.com/users/saethlin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4d6eca1c081dac022a887a134691cc7718cad94a", "url": "https://api.github.com/repos/rust-lang/rust/commits/4d6eca1c081dac022a887a134691cc7718cad94a", "html_url": "https://github.com/rust-lang/rust/commit/4d6eca1c081dac022a887a134691cc7718cad94a"}], "stats": {"total": 277, "additions": 277, "deletions": 0}, "files": [{"sha": "dcefbc62c70b32e7fd21909dd7887f109a9e4f53", "filename": ".gitignore", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/.gitignore", "raw_url": "https://github.com/rust-lang/rust/raw/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/.gitignore", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.gitignore?ref=8a40e2e9e3f732f6e720969f6a26b74fcaefc34b", "patch": "@@ -4,3 +4,7 @@ tex/*/out\n *.dot\n *.rs.bk\n .vscode\n+*.mm_profdata\n+perf.data\n+perf.data.old\n+flamegraph.svg"}, {"sha": "375b129a7e59b6fabd15b9bab4ed325d88cc433b", "filename": "bench-cargo-miri/backtraces/Cargo.lock", "status": "added", "additions": 94, "deletions": 0, "changes": 94, "blob_url": "https://github.com/rust-lang/rust/blob/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Fbacktraces%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Fbacktraces%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/bench-cargo-miri%2Fbacktraces%2FCargo.lock?ref=8a40e2e9e3f732f6e720969f6a26b74fcaefc34b", "patch": "@@ -0,0 +1,94 @@\n+# This file is automatically @generated by Cargo.\n+# It is not intended for manual editing.\n+version = 3\n+\n+[[package]]\n+name = \"addr2line\"\n+version = \"0.17.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"b9ecd88a8c8378ca913a680cd98f0f13ac67383d35993f86c90a70e3f137816b\"\n+dependencies = [\n+ \"gimli\",\n+]\n+\n+[[package]]\n+name = \"adler\"\n+version = \"1.0.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"f26201604c87b1e01bd3d98f8d5d9a8fcbb815e8cedb41ffccbeb4bf593a35fe\"\n+\n+[[package]]\n+name = \"backtrace\"\n+version = \"0.3.65\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"11a17d453482a265fd5f8479f2a3f405566e6ca627837aaddb85af8b1ab8ef61\"\n+dependencies = [\n+ \"addr2line\",\n+ \"cc\",\n+ \"cfg-if\",\n+ \"libc\",\n+ \"miniz_oxide\",\n+ \"object\",\n+ \"rustc-demangle\",\n+]\n+\n+[[package]]\n+name = \"backtraces\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"backtrace\",\n+]\n+\n+[[package]]\n+name = \"cc\"\n+version = \"1.0.73\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"2fff2a6927b3bb87f9595d67196a70493f627687a71d87a0d692242c33f58c11\"\n+\n+[[package]]\n+name = \"cfg-if\"\n+version = \"1.0.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"baf1de4339761588bc0619e3cbc0120ee582ebb74b53b4efbf79117bd2da40fd\"\n+\n+[[package]]\n+name = \"gimli\"\n+version = \"0.26.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"78cc372d058dcf6d5ecd98510e7fbc9e5aec4d21de70f65fea8fecebcd881bd4\"\n+\n+[[package]]\n+name = \"libc\"\n+version = \"0.2.126\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"349d5a591cd28b49e1d1037471617a32ddcda5731b99419008085f72d5a53836\"\n+\n+[[package]]\n+name = \"memchr\"\n+version = \"2.5.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"2dffe52ecf27772e601905b7522cb4ef790d2cc203488bbd0e2fe85fcb74566d\"\n+\n+[[package]]\n+name = \"miniz_oxide\"\n+version = \"0.5.3\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"6f5c75688da582b8ffc1f1799e9db273f32133c49e048f614d22ec3256773ccc\"\n+dependencies = [\n+ \"adler\",\n+]\n+\n+[[package]]\n+name = \"object\"\n+version = \"0.28.4\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"e42c982f2d955fac81dd7e1d0e1426a7d702acd9c98d19ab01083a6a0328c424\"\n+dependencies = [\n+ \"memchr\",\n+]\n+\n+[[package]]\n+name = \"rustc-demangle\"\n+version = \"0.1.21\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"7ef03e0a2b150c7a90d01faf6254c9c48a41e95fb2a8c2ac1c6f0d2b9aefc342\""}, {"sha": "1ba96b19395d29227afbafb420ea0dd6b160eb6c", "filename": "bench-cargo-miri/backtraces/Cargo.toml", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Fbacktraces%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Fbacktraces%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/bench-cargo-miri%2Fbacktraces%2FCargo.toml?ref=8a40e2e9e3f732f6e720969f6a26b74fcaefc34b", "patch": "@@ -0,0 +1,9 @@\n+[package]\n+name = \"backtraces\"\n+version = \"0.1.0\"\n+edition = \"2021\"\n+\n+# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html\n+\n+[dependencies]\n+backtrace = \"0.3.65\""}, {"sha": "eba51c60dbc5b3e678ee64f214ce2fce27a71622", "filename": "bench-cargo-miri/backtraces/src/main.rs", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Fbacktraces%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Fbacktraces%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/bench-cargo-miri%2Fbacktraces%2Fsrc%2Fmain.rs?ref=8a40e2e9e3f732f6e720969f6a26b74fcaefc34b", "patch": "@@ -0,0 +1,29 @@\n+//! Extracted from the backtrace crate's test test_frame_conversion\n+\n+use backtrace::{Backtrace, BacktraceFrame};\n+use std::fmt::Write;\n+\n+fn main() {\n+    let mut frames = vec![];\n+    backtrace::trace(|frame| {\n+        let converted = BacktraceFrame::from(frame.clone());\n+        frames.push(converted);\n+        true\n+    });\n+\n+    let mut manual = Backtrace::from(frames);\n+    manual.resolve();\n+    let frames = manual.frames();\n+\n+    let mut output = String::new();\n+    for frame in frames {\n+        // Originally these were println! but we'd prefer our benchmarks to not emit a lot of\n+        // output to stdout/stderr. Unfortunately writeln! to a String is faster, but we still\n+        // manage to exercise interesting code paths in Miri.\n+        writeln!(output, \"{:?}\", frame.ip()).unwrap();\n+        writeln!(output, \"{:?}\", frame.symbol_address()).unwrap();\n+        writeln!(output, \"{:?}\", frame.module_base_address()).unwrap();\n+        writeln!(output, \"{:?}\", frame.symbols()).unwrap();\n+    }\n+    drop(output);\n+}"}, {"sha": "d2b1aa341bbb6ea1adcbcd4b64a432c021a9e04e", "filename": "bench-cargo-miri/mse/Cargo.lock", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Fmse%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Fmse%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/bench-cargo-miri%2Fmse%2FCargo.lock?ref=8a40e2e9e3f732f6e720969f6a26b74fcaefc34b", "patch": "@@ -0,0 +1,7 @@\n+# This file is automatically @generated by Cargo.\n+# It is not intended for manual editing.\n+version = 3\n+\n+[[package]]\n+name = \"mse\"\n+version = \"0.1.0\""}, {"sha": "4875057613543158c0ee7d60cc2867372a578c13", "filename": "bench-cargo-miri/serde1/Cargo.lock", "status": "added", "additions": 89, "deletions": 0, "changes": 89, "blob_url": "https://github.com/rust-lang/rust/blob/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Fserde1%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Fserde1%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/bench-cargo-miri%2Fserde1%2FCargo.lock?ref=8a40e2e9e3f732f6e720969f6a26b74fcaefc34b", "patch": "@@ -0,0 +1,89 @@\n+# This file is automatically @generated by Cargo.\n+# It is not intended for manual editing.\n+version = 3\n+\n+[[package]]\n+name = \"cargo-miri-test\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"serde\",\n+ \"serde_json\",\n+]\n+\n+[[package]]\n+name = \"itoa\"\n+version = \"1.0.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"112c678d4050afce233f4f2852bb2eb519230b3cf12f33585275537d7e41578d\"\n+\n+[[package]]\n+name = \"proc-macro2\"\n+version = \"1.0.39\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"c54b25569025b7fc9651de43004ae593a75ad88543b17178aa5e1b9c4f15f56f\"\n+dependencies = [\n+ \"unicode-ident\",\n+]\n+\n+[[package]]\n+name = \"quote\"\n+version = \"1.0.18\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"a1feb54ed693b93a84e14094943b84b7c4eae204c512b7ccb95ab0c66d278ad1\"\n+dependencies = [\n+ \"proc-macro2\",\n+]\n+\n+[[package]]\n+name = \"ryu\"\n+version = \"1.0.10\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"f3f6f92acf49d1b98f7a81226834412ada05458b7364277387724a237f062695\"\n+\n+[[package]]\n+name = \"serde\"\n+version = \"1.0.137\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"61ea8d54c77f8315140a05f4c7237403bf38b72704d031543aa1d16abbf517d1\"\n+dependencies = [\n+ \"serde_derive\",\n+]\n+\n+[[package]]\n+name = \"serde_derive\"\n+version = \"1.0.137\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"1f26faba0c3959972377d3b2d306ee9f71faee9714294e41bb777f83f88578be\"\n+dependencies = [\n+ \"proc-macro2\",\n+ \"quote\",\n+ \"syn\",\n+]\n+\n+[[package]]\n+name = \"serde_json\"\n+version = \"1.0.81\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"9b7ce2b32a1aed03c558dc61a5cd328f15aff2dbc17daad8fb8af04d2100e15c\"\n+dependencies = [\n+ \"itoa\",\n+ \"ryu\",\n+ \"serde\",\n+]\n+\n+[[package]]\n+name = \"syn\"\n+version = \"1.0.96\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"0748dd251e24453cb8717f0354206b91557e4ec8703673a4b30208f2abaf1ebf\"\n+dependencies = [\n+ \"proc-macro2\",\n+ \"quote\",\n+ \"unicode-ident\",\n+]\n+\n+[[package]]\n+name = \"unicode-ident\"\n+version = \"1.0.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"d22af068fba1eb5edcb4aea19d382b2a3deb4c8f9d475c589b6ada9e0fd493ee\""}, {"sha": "80d013b7d6d84c6c4b1ed0d4e8247694ee2274d2", "filename": "bench-cargo-miri/unicode/Cargo.lock", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Funicode%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Funicode%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/bench-cargo-miri%2Funicode%2FCargo.lock?ref=8a40e2e9e3f732f6e720969f6a26b74fcaefc34b", "patch": "@@ -0,0 +1,16 @@\n+# This file is automatically @generated by Cargo.\n+# It is not intended for manual editing.\n+version = 3\n+\n+[[package]]\n+name = \"unicode\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"unicode-xid\",\n+]\n+\n+[[package]]\n+name = \"unicode-xid\"\n+version = \"0.2.3\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"957e51f3646910546462e67d5f7599b9e4fb8acdd304b087a6494730f9eebf04\""}, {"sha": "7e8708b03f19c1503534128298ca3bc8856d45d2", "filename": "bench-cargo-miri/unicode/Cargo.toml", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Funicode%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Funicode%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/bench-cargo-miri%2Funicode%2FCargo.toml?ref=8a40e2e9e3f732f6e720969f6a26b74fcaefc34b", "patch": "@@ -0,0 +1,9 @@\n+[package]\n+name = \"unicode\"\n+version = \"0.1.0\"\n+edition = \"2021\"\n+\n+# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html\n+\n+[dependencies]\n+unicode-xid = \"0.2.3\""}, {"sha": "3f0ee5ecf6af61bcbe17a017c7b6e3fe86769e91", "filename": "bench-cargo-miri/unicode/src/main.rs", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Funicode%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8a40e2e9e3f732f6e720969f6a26b74fcaefc34b/bench-cargo-miri%2Funicode%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/bench-cargo-miri%2Funicode%2Fsrc%2Fmain.rs?ref=8a40e2e9e3f732f6e720969f6a26b74fcaefc34b", "patch": "@@ -0,0 +1,20 @@\n+//! Extracted from the unicode-xid exhaustive test all_valid_chars_do_not_panic_for_is_xid_continue\n+\n+use unicode_xid::UnicodeXID;\n+\n+/// A `char` in Rust is a Unicode Scalar Value\n+///\n+/// See: http://www.unicode.org/glossary/#unicode_scalar_value\n+fn all_valid_chars() -> impl Iterator<Item = char> {\n+    (0u32..=0xD7FF).chain(0xE000u32..=0x10FFFF).map(|u| {\n+        core::convert::TryFrom::try_from(u)\n+            .expect(\"The selected range should be infallible if the docs match impl\")\n+    })\n+}\n+\n+fn main() {\n+    // Take only the first few chars because we don't want to wait all day\n+    for c in all_valid_chars().take(2_000) {\n+        let _ = UnicodeXID::is_xid_continue(c);\n+    }\n+}"}]}