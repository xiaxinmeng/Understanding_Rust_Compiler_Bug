{"sha": "536db5b83f82280c0daba09ee41442c02f7faf2e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUzNmRiNWI4M2Y4MjI4MGMwZGFiYTA5ZWU0MTQ0MmMwMmY3ZmFmMmU=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2017-08-27T21:07:35Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-08-27T21:07:35Z"}, "message": "Merge pull request #1923 from topecongiro/issue-1920\n\nAllow pre-line single-lined comments to stay on the same line", "tree": {"sha": "6045ce0e93c7d0346c1501c2e653886d38ca59ae", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6045ce0e93c7d0346c1501c2e653886d38ca59ae"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/536db5b83f82280c0daba09ee41442c02f7faf2e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/536db5b83f82280c0daba09ee41442c02f7faf2e", "html_url": "https://github.com/rust-lang/rust/commit/536db5b83f82280c0daba09ee41442c02f7faf2e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/536db5b83f82280c0daba09ee41442c02f7faf2e/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "565492083ffd4e52da5aa14fc520dd9606598ac4", "url": "https://api.github.com/repos/rust-lang/rust/commits/565492083ffd4e52da5aa14fc520dd9606598ac4", "html_url": "https://github.com/rust-lang/rust/commit/565492083ffd4e52da5aa14fc520dd9606598ac4"}, {"sha": "74834c3f7f0402703e4eeb513d3de065a86c4d84", "url": "https://api.github.com/repos/rust-lang/rust/commits/74834c3f7f0402703e4eeb513d3de065a86c4d84", "html_url": "https://github.com/rust-lang/rust/commit/74834c3f7f0402703e4eeb513d3de065a86c4d84"}], "stats": {"total": 76, "additions": 22, "deletions": 54}, "files": [{"sha": "a9d705b4c64938e50840cb103296b71f7b98b1df", "filename": "src/lists.rs", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/536db5b83f82280c0daba09ee41442c02f7faf2e/src%2Flists.rs", "raw_url": "https://github.com/rust-lang/rust/raw/536db5b83f82280c0daba09ee41442c02f7faf2e/src%2Flists.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flists.rs?ref=536db5b83f82280c0daba09ee41442c02f7faf2e", "patch": "@@ -117,13 +117,23 @@ impl ListItem {\n         self.item.as_ref().map_or(\"\", |s| &*s)\n     }\n \n-    pub fn is_multiline(&self) -> bool {\n+    pub fn is_different_group(&self) -> bool {\n         self.inner_as_ref().contains('\\n') || self.pre_comment.is_some() ||\n             self.post_comment\n                 .as_ref()\n                 .map_or(false, |s| s.contains('\\n'))\n     }\n \n+    pub fn is_multiline(&self) -> bool {\n+        self.inner_as_ref().contains('\\n') ||\n+            self.pre_comment\n+                .as_ref()\n+                .map_or(false, |s| s.contains('\\n')) ||\n+            self.post_comment\n+                .as_ref()\n+                .map_or(false, |s| s.contains('\\n'))\n+    }\n+\n     pub fn has_comment(&self) -> bool {\n         self.pre_comment\n             .as_ref()\n@@ -469,7 +479,7 @@ where\n         let item = item.as_ref();\n         let inner_item_width = item.inner_as_ref().len();\n         if !first &&\n-            (item.is_multiline() || !item.post_comment.is_some() ||\n+            (item.is_different_group() || !item.post_comment.is_some() ||\n                 inner_item_width + overhead > max_budget)\n         {\n             return max_width;"}, {"sha": "74cdd8ed2f22c7695de6c55fce63ba3491592df8", "filename": "tests/target/expr-block.rs", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/536db5b83f82280c0daba09ee41442c02f7faf2e/tests%2Ftarget%2Fexpr-block.rs", "raw_url": "https://github.com/rust-lang/rust/raw/536db5b83f82280c0daba09ee41442c02f7faf2e/tests%2Ftarget%2Fexpr-block.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fexpr-block.rs?ref=536db5b83f82280c0daba09ee41442c02f7faf2e", "patch": "@@ -80,11 +80,7 @@ fn arrays() {\n         0,\n     ];\n \n-    let y = [\n-        /* comment */ 1,\n-        2, /* post comment */\n-        3,\n-    ];\n+    let y = [/* comment */ 1, 2 /* post comment */, 3];\n \n     let xy = [\n         strukt {"}, {"sha": "cc86100e11e35d746a08aa23c4315a4c6975eb23", "filename": "tests/target/expr.rs", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/536db5b83f82280c0daba09ee41442c02f7faf2e/tests%2Ftarget%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/536db5b83f82280c0daba09ee41442c02f7faf2e/tests%2Ftarget%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fexpr.rs?ref=536db5b83f82280c0daba09ee41442c02f7faf2e", "patch": "@@ -208,12 +208,7 @@ fn arrays() {\n         0,\n     ];\n \n-    let y = [\n-        // comment\n-        1,\n-        2, // post comment\n-        3,\n-    ];\n+    let y = [/* comment */ 1, 2 /* post comment */, 3];\n \n     let xy = [\n         strukt {"}, {"sha": "06b0fecab4618fd96d3ab0bdd6aead6f5c2d0533", "filename": "tests/target/fn-simple.rs", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/536db5b83f82280c0daba09ee41442c02f7faf2e/tests%2Ftarget%2Ffn-simple.rs", "raw_url": "https://github.com/rust-lang/rust/raw/536db5b83f82280c0daba09ee41442c02f7faf2e/tests%2Ftarget%2Ffn-simple.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Ffn-simple.rs?ref=536db5b83f82280c0daba09ee41442c02f7faf2e", "patch": "@@ -25,11 +25,7 @@ fn weird_comment(\n     // Does this work?\n     y: World,\n ) {\n-    simple(\n-        // does this preserve comments now?\n-        42,\n-        NoWay,\n-    )\n+    simple(/* does this preserve comments now? */ 42, NoWay)\n }\n \n fn generic<T>(arg: T) -> &SomeType"}, {"sha": "ba1029d4e61e2fe9f85ff9e5e474426bf2c8616e", "filename": "tests/target/issue-1021.rs", "status": "modified", "additions": 4, "deletions": 18, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/536db5b83f82280c0daba09ee41442c02f7faf2e/tests%2Ftarget%2Fissue-1021.rs", "raw_url": "https://github.com/rust-lang/rust/raw/536db5b83f82280c0daba09ee41442c02f7faf2e/tests%2Ftarget%2Fissue-1021.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-1021.rs?ref=536db5b83f82280c0daba09ee41442c02f7faf2e", "patch": "@@ -6,15 +6,8 @@ fn main() {\n         S(.., true) => (),\n         S(..) => (),\n         S(_) => (),\n-        S(\n-            // ..\n-            ..\n-        ) => (),\n-        S(\n-            // ..\n-            ..,\n-            true,\n-        ) => (),\n+        S(/* .. */ ..) => (),\n+        S(/* .. */ .., true) => (),\n     }\n \n     match y {\n@@ -23,14 +16,7 @@ fn main() {\n         (.., true) => (),\n         (..) => (),\n         (_,) => (),\n-        (\n-            // ..\n-            ..\n-        ) => (),\n-        (\n-            // ..\n-            ..,\n-            true,\n-        ) => (),\n+        (/* .. */ ..) => (),\n+        (/* .. */ .., true) => (),\n     }\n }"}, {"sha": "39f99d9e123ed1ead3a7ae9e9ea437d526c1fd77", "filename": "tests/target/pattern-condense-wildcards.rs", "status": "modified", "additions": 1, "deletions": 7, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/536db5b83f82280c0daba09ee41442c02f7faf2e/tests%2Ftarget%2Fpattern-condense-wildcards.rs", "raw_url": "https://github.com/rust-lang/rust/raw/536db5b83f82280c0daba09ee41442c02f7faf2e/tests%2Ftarget%2Fpattern-condense-wildcards.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fpattern-condense-wildcards.rs?ref=536db5b83f82280c0daba09ee41442c02f7faf2e", "patch": "@@ -7,12 +7,6 @@ fn main() {\n         Tup(_) => \"nah\",\n         Quad(_, _, x, _) => \" also no rewrite\",\n         Quad(x, ..) => \"condense me pls\",\n-        Weird(\n-            x,\n-            _,\n-            _,\n-            // dont condense before\n-            ..\n-        ) => \"pls work\",\n+        Weird(x, _, _, /* dont condense before */ ..) => \"pls work\",\n     }\n }"}, {"sha": "2f35e79651211bd2cc5b1a1c7eb4924eb55379fc", "filename": "tests/target/type.rs", "status": "modified", "additions": 2, "deletions": 11, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/536db5b83f82280c0daba09ee41442c02f7faf2e/tests%2Ftarget%2Ftype.rs", "raw_url": "https://github.com/rust-lang/rust/raw/536db5b83f82280c0daba09ee41442c02f7faf2e/tests%2Ftarget%2Ftype.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Ftype.rs?ref=536db5b83f82280c0daba09ee41442c02f7faf2e", "patch": "@@ -2,22 +2,13 @@\n fn types() {\n     let x: [Vec<_>] = [];\n     let y: *mut [SomeType; konst_funk()] = expr();\n-    let z: (\n-        // #digits\n-        usize,\n-        // exp\n-        i16,\n-    ) = funk();\n+    let z: (/* #digits */ usize, /* exp */ i16) = funk();\n     let z: (usize /* #digits */, i16 /* exp */) = funk();\n }\n \n struct F {\n     f: extern \"C\" fn(x: u8, ... /* comment */),\n-    g: extern \"C\" fn(\n-        x: u8,\n-        // comment\n-        ...\n-    ),\n+    g: extern \"C\" fn(x: u8, /* comment */ ...),\n     h: extern \"C\" fn(x: u8, ...),\n     i: extern \"C\" fn(\n         x: u8,"}]}