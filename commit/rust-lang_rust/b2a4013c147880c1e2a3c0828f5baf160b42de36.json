{"sha": "b2a4013c147880c1e2a3c0828f5baf160b42de36", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIyYTQwMTNjMTQ3ODgwYzFlMmEzYzA4MjhmNWJhZjE2MGI0MmRlMzY=", "commit": {"author": {"name": "Philipp Krones", "email": "uwdkn@student.kit.edu", "date": "2018-08-14T10:54:05Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-08-14T10:54:05Z"}, "message": "Merge pull request #3014 from estk/allow-write-multi-newline\n\nAllow print/write with multiple newlines", "tree": {"sha": "35af92886dd6f9b6f37319a16989f70c751cf806", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/35af92886dd6f9b6f37319a16989f70c751cf806"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b2a4013c147880c1e2a3c0828f5baf160b42de36", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbcrTNCRBK7hj4Ov3rIwAAdHIIAIAr4/cC3RkX2kEfLNH9i0bq\nxLPSH4QbdRYa/0G+/s3pJOHOYZ+TqxmqV1LpygLPt01dmK9+POaSwDu4mo12Z20M\nWHWft1mLXmmyyRrObzuNcDDI2NgbMhj0yx6sCn0MTLPJqaHRmLfLEF6eLLo2/kmN\nfgKJM+kvUk2UwEn7n5hEKsyWW3pC+crtHRo6iQMGlK6drvlTZuLoFiKmylT1iS/T\nraGGT4pHRImrZXME2qB4HqHawJAwcshHS4s2IS1RVvKGdCcOgYVgv/bJtSSA0C/i\ntZXCt7SI4NJKXsoPlv8w+EM9hEXq+bQNMrOuEN3ZNY6G4VB9e509P3ojdvh2w6g=\n=9t8p\n-----END PGP SIGNATURE-----\n", "payload": "tree 35af92886dd6f9b6f37319a16989f70c751cf806\nparent 826d998cd268befb1b4a304babaae13fceba5e3b\nparent 550ff84ecdb16bfb059fe0fab69e6788890a5bbb\nauthor Philipp Krones <uwdkn@student.kit.edu> 1534244045 +0200\ncommitter GitHub <noreply@github.com> 1534244045 +0200\n\nMerge pull request #3014 from estk/allow-write-multi-newline\n\nAllow print/write with multiple newlines"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b2a4013c147880c1e2a3c0828f5baf160b42de36", "html_url": "https://github.com/rust-lang/rust/commit/b2a4013c147880c1e2a3c0828f5baf160b42de36", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b2a4013c147880c1e2a3c0828f5baf160b42de36/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "826d998cd268befb1b4a304babaae13fceba5e3b", "url": "https://api.github.com/repos/rust-lang/rust/commits/826d998cd268befb1b4a304babaae13fceba5e3b", "html_url": "https://github.com/rust-lang/rust/commit/826d998cd268befb1b4a304babaae13fceba5e3b"}, {"sha": "550ff84ecdb16bfb059fe0fab69e6788890a5bbb", "url": "https://api.github.com/repos/rust-lang/rust/commits/550ff84ecdb16bfb059fe0fab69e6788890a5bbb", "html_url": "https://github.com/rust-lang/rust/commit/550ff84ecdb16bfb059fe0fab69e6788890a5bbb"}], "stats": {"total": 47, "additions": 26, "deletions": 21}, "files": [{"sha": "e8c7225041f8be3beeab8cd9b508c4be6f7539c7", "filename": "clippy_lints/src/write.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/b2a4013c147880c1e2a3c0828f5baf160b42de36/clippy_lints%2Fsrc%2Fwrite.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b2a4013c147880c1e2a3c0828f5baf160b42de36/clippy_lints%2Fsrc%2Fwrite.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fwrite.rs?ref=b2a4013c147880c1e2a3c0828f5baf160b42de36", "patch": "@@ -42,7 +42,7 @@ declare_clippy_lint! {\n declare_clippy_lint! {\n     pub PRINT_WITH_NEWLINE,\n     style,\n-    \"using `print!()` with a format string that ends in a newline\"\n+    \"using `print!()` with a format string that ends in a single newline\"\n }\n \n /// **What it does:** Checks for printing on *stdout*. The purpose of this lint\n@@ -135,7 +135,7 @@ declare_clippy_lint! {\n declare_clippy_lint! {\n     pub WRITE_WITH_NEWLINE,\n     style,\n-    \"using `write!()` with a format string that ends in a newline\"\n+    \"using `write!()` with a format string that ends in a single newline\"\n }\n \n /// **What it does:** This lint warns about the use of literals as `write!`/`writeln!` args.\n@@ -194,18 +194,18 @@ impl EarlyLintPass for Pass {\n         } else if mac.node.path == \"print\" {\n             span_lint(cx, PRINT_STDOUT, mac.span, \"use of `print!`\");\n             if let Some(fmtstr) = check_tts(cx, &mac.node.tts, false) {\n-                if fmtstr.ends_with(\"\\\\n\") {\n+                if fmtstr.ends_with(\"\\\\n\") && !fmtstr.ends_with(\"\\\\n\\\\n\") {\n                     span_lint(cx, PRINT_WITH_NEWLINE, mac.span,\n                             \"using `print!()` with a format string that ends in a \\\n-                            newline, consider using `println!()` instead\");\n+                            single newline, consider using `println!()` instead\");\n                 }\n             }\n         } else if mac.node.path == \"write\" {\n             if let Some(fmtstr) = check_tts(cx, &mac.node.tts, true) {\n-                if fmtstr.ends_with(\"\\\\n\") {\n+                if fmtstr.ends_with(\"\\\\n\") && !fmtstr.ends_with(\"\\\\n\\\\n\") {\n                     span_lint(cx, WRITE_WITH_NEWLINE, mac.span,\n                             \"using `write!()` with a format string that ends in a \\\n-                            newline, consider using `writeln!()` instead\");\n+                            single newline, consider using `writeln!()` instead\");\n                 }\n             }\n         } else if mac.node.path == \"writeln\" {"}, {"sha": "906fa987d17cdc610ac94f7cfa0808621dcc9b2d", "filename": "tests/ui/print_with_newline.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/b2a4013c147880c1e2a3c0828f5baf160b42de36/tests%2Fui%2Fprint_with_newline.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b2a4013c147880c1e2a3c0828f5baf160b42de36/tests%2Fui%2Fprint_with_newline.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fprint_with_newline.rs?ref=b2a4013c147880c1e2a3c0828f5baf160b42de36", "patch": "@@ -6,7 +6,7 @@\n fn main() {\n     print!(\"Hello\\n\");\n     print!(\"Hello {}\\n\", \"world\");\n-    print!(\"Hello {} {}\\n\\n\", \"world\", \"#2\");\n+    print!(\"Hello {} {}\\n\", \"world\", \"#2\");\n     print!(\"{}\\n\", 1265);\n \n     // these are all fine\n@@ -18,4 +18,7 @@ fn main() {\n     print!(\"Issue\\n{}\", 1265);\n     print!(\"{}\", 1265);\n     print!(\"\\n{}\", 1275);\n+    print!(\"\\n\\n\");\n+    print!(\"like eof\\n\\n\");\n+    print!(\"Hello {} {}\\n\\n\", \"world\", \"#2\");\n }"}, {"sha": "58413a9b4a9a67565c79dd0323db343a2df69cfb", "filename": "tests/ui/print_with_newline.stderr", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/b2a4013c147880c1e2a3c0828f5baf160b42de36/tests%2Fui%2Fprint_with_newline.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b2a4013c147880c1e2a3c0828f5baf160b42de36/tests%2Fui%2Fprint_with_newline.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fprint_with_newline.stderr?ref=b2a4013c147880c1e2a3c0828f5baf160b42de36", "patch": "@@ -1,24 +1,24 @@\n-error: using `print!()` with a format string that ends in a newline, consider using `println!()` instead\n+error: using `print!()` with a format string that ends in a single newline, consider using `println!()` instead\n  --> $DIR/print_with_newline.rs:7:5\n   |\n 7 |     print!(\"Hello/n\");\n   |     ^^^^^^^^^^^^^^^^^\n   |\n   = note: `-D print-with-newline` implied by `-D warnings`\n \n-error: using `print!()` with a format string that ends in a newline, consider using `println!()` instead\n+error: using `print!()` with a format string that ends in a single newline, consider using `println!()` instead\n  --> $DIR/print_with_newline.rs:8:5\n   |\n 8 |     print!(\"Hello {}/n\", \"world\");\n   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: using `print!()` with a format string that ends in a newline, consider using `println!()` instead\n+error: using `print!()` with a format string that ends in a single newline, consider using `println!()` instead\n  --> $DIR/print_with_newline.rs:9:5\n   |\n-9 |     print!(\"Hello {} {}/n/n\", \"world\", \"#2\");\n-  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+9 |     print!(\"Hello {} {}/n\", \"world\", \"#2\");\n+  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: using `print!()` with a format string that ends in a newline, consider using `println!()` instead\n+error: using `print!()` with a format string that ends in a single newline, consider using `println!()` instead\n   --> $DIR/print_with_newline.rs:10:5\n    |\n 10 |     print!(\"{}/n\", 1265);"}, {"sha": "8badbd6572671177f6c9bcf059342594057f43f1", "filename": "tests/ui/write_with_newline.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b2a4013c147880c1e2a3c0828f5baf160b42de36/tests%2Fui%2Fwrite_with_newline.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b2a4013c147880c1e2a3c0828f5baf160b42de36/tests%2Fui%2Fwrite_with_newline.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fwrite_with_newline.rs?ref=b2a4013c147880c1e2a3c0828f5baf160b42de36", "patch": "@@ -9,7 +9,7 @@ fn main() {\n     // These should fail\n     write!(&mut v, \"Hello\\n\");\n     write!(&mut v, \"Hello {}\\n\", \"world\");\n-    write!(&mut v, \"Hello {} {}\\n\\n\", \"world\", \"#2\");\n+    write!(&mut v, \"Hello {} {}\\n\", \"world\", \"#2\");\n     write!(&mut v, \"{}\\n\", 1265);\n \n     // These should be fine\n@@ -21,5 +21,7 @@ fn main() {\n     write!(&mut v, \"Issue\\n{}\", 1265);\n     write!(&mut v, \"{}\", 1265);\n     write!(&mut v, \"\\n{}\", 1275);\n-\n+    write!(&mut v, \"\\n\\n\");\n+    write!(&mut v, \"like eof\\n\\n\");\n+    write!(&mut v, \"Hello {} {}\\n\\n\", \"world\", \"#2\");\n }"}, {"sha": "a8a6039f3e1920bd72f141d8b93861ceb65774a8", "filename": "tests/ui/write_with_newline.stderr", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/b2a4013c147880c1e2a3c0828f5baf160b42de36/tests%2Fui%2Fwrite_with_newline.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b2a4013c147880c1e2a3c0828f5baf160b42de36/tests%2Fui%2Fwrite_with_newline.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fwrite_with_newline.stderr?ref=b2a4013c147880c1e2a3c0828f5baf160b42de36", "patch": "@@ -1,24 +1,24 @@\n-error: using `write!()` with a format string that ends in a newline, consider using `writeln!()` instead\n+error: using `write!()` with a format string that ends in a single newline, consider using `writeln!()` instead\n   --> $DIR/write_with_newline.rs:10:5\n    |\n 10 |     write!(&mut v, \"Hello/n\");\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n    = note: `-D write-with-newline` implied by `-D warnings`\n \n-error: using `write!()` with a format string that ends in a newline, consider using `writeln!()` instead\n+error: using `write!()` with a format string that ends in a single newline, consider using `writeln!()` instead\n   --> $DIR/write_with_newline.rs:11:5\n    |\n 11 |     write!(&mut v, \"Hello {}/n\", \"world\");\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: using `write!()` with a format string that ends in a newline, consider using `writeln!()` instead\n+error: using `write!()` with a format string that ends in a single newline, consider using `writeln!()` instead\n   --> $DIR/write_with_newline.rs:12:5\n    |\n-12 |     write!(&mut v, \"Hello {} {}/n/n\", \"world\", \"#2\");\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+12 |     write!(&mut v, \"Hello {} {}/n\", \"world\", \"#2\");\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: using `write!()` with a format string that ends in a newline, consider using `writeln!()` instead\n+error: using `write!()` with a format string that ends in a single newline, consider using `writeln!()` instead\n   --> $DIR/write_with_newline.rs:13:5\n    |\n 13 |     write!(&mut v, \"{}/n\", 1265);"}]}