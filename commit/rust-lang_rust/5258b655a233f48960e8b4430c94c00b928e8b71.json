{"sha": "5258b655a233f48960e8b4430c94c00b928e8b71", "node_id": "C_kwDOAAsO6NoAKDUyNThiNjU1YTIzM2Y0ODk2MGU4YjQ0MzBjOTRjMDBiOTI4ZThiNzE", "commit": {"author": {"name": "Nicholas Nethercote", "email": "n.nethercote@gmail.com", "date": "2022-12-15T04:13:19Z"}, "committer": {"name": "Nicholas Nethercote", "email": "n.nethercote@gmail.com", "date": "2022-12-15T04:13:19Z"}, "message": "Merge `SimplifiedTypeGen<D>` into `SimplifiedType`.\n\n`SimplifiedTypeGen<DefId>` is the only instantiation used, so we don't\nneed the generic parameter.", "tree": {"sha": "fc1d66bb562ea194dc8806e862f3d4f49666825a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fc1d66bb562ea194dc8806e862f3d4f49666825a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5258b655a233f48960e8b4430c94c00b928e8b71", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5258b655a233f48960e8b4430c94c00b928e8b71", "html_url": "https://github.com/rust-lang/rust/commit/5258b655a233f48960e8b4430c94c00b928e8b71", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5258b655a233f48960e8b4430c94c00b928e8b71/comments", "author": {"login": "nnethercote", "id": 1940286, "node_id": "MDQ6VXNlcjE5NDAyODY=", "avatar_url": "https://avatars.githubusercontent.com/u/1940286?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nnethercote", "html_url": "https://github.com/nnethercote", "followers_url": "https://api.github.com/users/nnethercote/followers", "following_url": "https://api.github.com/users/nnethercote/following{/other_user}", "gists_url": "https://api.github.com/users/nnethercote/gists{/gist_id}", "starred_url": "https://api.github.com/users/nnethercote/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nnethercote/subscriptions", "organizations_url": "https://api.github.com/users/nnethercote/orgs", "repos_url": "https://api.github.com/users/nnethercote/repos", "events_url": "https://api.github.com/users/nnethercote/events{/privacy}", "received_events_url": "https://api.github.com/users/nnethercote/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nnethercote", "id": 1940286, "node_id": "MDQ6VXNlcjE5NDAyODY=", "avatar_url": "https://avatars.githubusercontent.com/u/1940286?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nnethercote", "html_url": "https://github.com/nnethercote", "followers_url": "https://api.github.com/users/nnethercote/followers", "following_url": "https://api.github.com/users/nnethercote/following{/other_user}", "gists_url": "https://api.github.com/users/nnethercote/gists{/gist_id}", "starred_url": "https://api.github.com/users/nnethercote/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nnethercote/subscriptions", "organizations_url": "https://api.github.com/users/nnethercote/orgs", "repos_url": "https://api.github.com/users/nnethercote/repos", "events_url": "https://api.github.com/users/nnethercote/events{/privacy}", "received_events_url": "https://api.github.com/users/nnethercote/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2a5aabdfc2c44112da2fd98661e03c559e057731", "url": "https://api.github.com/repos/rust-lang/rust/commits/2a5aabdfc2c44112da2fd98661e03c559e057731", "html_url": "https://github.com/rust-lang/rust/commit/2a5aabdfc2c44112da2fd98661e03c559e057731"}], "stats": {"total": 40, "additions": 15, "deletions": 25}, "files": [{"sha": "70fe0564a5a1145bfba2f1aedc0983cc33663623", "filename": "compiler/rustc_middle/src/ty/fast_reject.rs", "status": "modified", "additions": 10, "deletions": 20, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/5258b655a233f48960e8b4430c94c00b928e8b71/compiler%2Frustc_middle%2Fsrc%2Fty%2Ffast_reject.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5258b655a233f48960e8b4430c94c00b928e8b71/compiler%2Frustc_middle%2Fsrc%2Fty%2Ffast_reject.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Ffast_reject.rs?ref=5258b655a233f48960e8b4430c94c00b928e8b71", "patch": "@@ -6,28 +6,18 @@ use std::fmt::Debug;\n use std::hash::Hash;\n use std::iter;\n \n-use self::SimplifiedTypeGen::*;\n+use self::SimplifiedType::*;\n \n-pub type SimplifiedType = SimplifiedTypeGen<DefId>;\n-\n-/// See `simplify_type`\n-///\n-/// Note that we keep this type generic over the type of identifier it uses\n-/// because we sometimes need to use SimplifiedTypeGen values as stable sorting\n-/// keys (in which case we use a DefPathHash as id-type) but in the general case\n-/// the non-stable but fast to construct DefId-version is the better choice.\n+/// See `simplify_type`.\n #[derive(Clone, Copy, Debug, PartialEq, Eq, Hash, TyEncodable, TyDecodable, HashStable)]\n-pub enum SimplifiedTypeGen<D>\n-where\n-    D: Copy + Debug + Eq,\n-{\n+pub enum SimplifiedType {\n     BoolSimplifiedType,\n     CharSimplifiedType,\n     IntSimplifiedType(ty::IntTy),\n     UintSimplifiedType(ty::UintTy),\n     FloatSimplifiedType(ty::FloatTy),\n-    AdtSimplifiedType(D),\n-    ForeignSimplifiedType(D),\n+    AdtSimplifiedType(DefId),\n+    ForeignSimplifiedType(DefId),\n     StrSimplifiedType,\n     ArraySimplifiedType,\n     SliceSimplifiedType,\n@@ -38,9 +28,9 @@ where\n     /// A trait object, all of whose components are markers\n     /// (e.g., `dyn Send + Sync`).\n     MarkerTraitObjectSimplifiedType,\n-    TraitSimplifiedType(D),\n-    ClosureSimplifiedType(D),\n-    GeneratorSimplifiedType(D),\n+    TraitSimplifiedType(DefId),\n+    ClosureSimplifiedType(DefId),\n+    GeneratorSimplifiedType(DefId),\n     GeneratorWitnessSimplifiedType(usize),\n     FunctionSimplifiedType(usize),\n     PlaceholderSimplifiedType,\n@@ -142,8 +132,8 @@ pub fn simplify_type<'tcx>(\n     }\n }\n \n-impl<D: Copy + Debug + Eq> SimplifiedTypeGen<D> {\n-    pub fn def(self) -> Option<D> {\n+impl SimplifiedType {\n+    pub fn def(self) -> Option<DefId> {\n         match self {\n             AdtSimplifiedType(d)\n             | ForeignSimplifiedType(d)"}, {"sha": "7c18362dfc78397a1517804e468ab1b4f507c625", "filename": "compiler/rustc_middle/src/ty/parameterized.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/5258b655a233f48960e8b4430c94c00b928e8b71/compiler%2Frustc_middle%2Fsrc%2Fty%2Fparameterized.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5258b655a233f48960e8b4430c94c00b928e8b71/compiler%2Frustc_middle%2Fsrc%2Fty%2Fparameterized.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Fparameterized.rs?ref=5258b655a233f48960e8b4430c94c00b928e8b71", "patch": "@@ -1,5 +1,5 @@\n use rustc_data_structures::fx::FxHashMap;\n-use rustc_hir::def_id::{DefId, DefIndex};\n+use rustc_hir::def_id::DefIndex;\n use rustc_index::vec::{Idx, IndexVec};\n \n use crate::middle::exported_symbols::ExportedSymbol;\n@@ -67,7 +67,7 @@ trivially_parameterized_over_tcx! {\n     ty::TraitDef,\n     ty::Visibility<DefIndex>,\n     ty::adjustment::CoerceUnsizedInfo,\n-    ty::fast_reject::SimplifiedTypeGen<DefId>,\n+    ty::fast_reject::SimplifiedType,\n     rustc_ast::Attribute,\n     rustc_ast::DelimArgs,\n     rustc_attr::ConstStability,"}, {"sha": "2d829779f15dcf20920d78c8a79e0d8b3c3a8487", "filename": "src/librustdoc/clean/inline.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5258b655a233f48960e8b4430c94c00b928e8b71/src%2Flibrustdoc%2Fclean%2Finline.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5258b655a233f48960e8b4430c94c00b928e8b71/src%2Flibrustdoc%2Fclean%2Finline.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Finline.rs?ref=5258b655a233f48960e8b4430c94c00b928e8b71", "patch": "@@ -325,7 +325,7 @@ pub(crate) fn build_impls(\n     // * https://github.com/rust-lang/rust/pull/99917 \u2014 where the feature got used\n     // * https://github.com/rust-lang/rust/issues/53487 \u2014 overall tracking issue for Error\n     if tcx.has_attr(did, sym::rustc_has_incoherent_inherent_impls) {\n-        use rustc_middle::ty::fast_reject::SimplifiedTypeGen::*;\n+        use rustc_middle::ty::fast_reject::SimplifiedType::*;\n         let type_ =\n             if tcx.is_trait(did) { TraitSimplifiedType(did) } else { AdtSimplifiedType(did) };\n         for &did in tcx.incoherent_impls(type_) {"}, {"sha": "2c7692e8655a4bd784cb8d1e22213da88ee2eaca", "filename": "src/librustdoc/clean/types.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5258b655a233f48960e8b4430c94c00b928e8b71/src%2Flibrustdoc%2Fclean%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5258b655a233f48960e8b4430c94c00b928e8b71/src%2Flibrustdoc%2Fclean%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Ftypes.rs?ref=5258b655a233f48960e8b4430c94c00b928e8b71", "patch": "@@ -1870,7 +1870,7 @@ impl PrimitiveType {\n     }\n \n     pub(crate) fn simplified_types() -> &'static SimplifiedTypes {\n-        use ty::fast_reject::SimplifiedTypeGen::*;\n+        use ty::fast_reject::SimplifiedType::*;\n         use ty::{FloatTy, IntTy, UintTy};\n         use PrimitiveType::*;\n         static CELL: OnceCell<SimplifiedTypes> = OnceCell::new();"}, {"sha": "652f8b4d3c56ef7109668aface5f83bf35cc8514", "filename": "src/tools/clippy/clippy_utils/src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5258b655a233f48960e8b4430c94c00b928e8b71/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5258b655a233f48960e8b4430c94c00b928e8b71/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Flib.rs?ref=5258b655a233f48960e8b4430c94c00b928e8b71", "patch": "@@ -97,7 +97,7 @@ use rustc_middle::hir::place::PlaceBase;\n use rustc_middle::ty as rustc_ty;\n use rustc_middle::ty::adjustment::{Adjust, Adjustment, AutoBorrow};\n use rustc_middle::ty::binding::BindingMode;\n-use rustc_middle::ty::fast_reject::SimplifiedTypeGen::{\n+use rustc_middle::ty::fast_reject::SimplifiedType::{\n     ArraySimplifiedType, BoolSimplifiedType, CharSimplifiedType, FloatSimplifiedType, IntSimplifiedType,\n     PtrSimplifiedType, SliceSimplifiedType, StrSimplifiedType, UintSimplifiedType,\n };"}]}