{"sha": "422741151359b8ad4b4f1f4a545aef27f5722c82", "node_id": "C_kwDOAAsO6NoAKDQyMjc0MTE1MTM1OWI4YWQ0YjRmMWY0YTU0NWFlZjI3ZjU3MjJjODI", "commit": {"author": {"name": "Jason Newcomb", "email": "jsnewcomb@pm.me", "date": "2022-04-02T20:57:09Z"}, "committer": {"name": "Jason Newcomb", "email": "jsnewcomb@pm.me", "date": "2022-04-03T12:54:37Z"}, "message": "Generate deprecated lints test", "tree": {"sha": "62722b2155e6e726ec9fe5102cc489c221fa7881", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/62722b2155e6e726ec9fe5102cc489c221fa7881"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/422741151359b8ad4b4f1f4a545aef27f5722c82", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/422741151359b8ad4b4f1f4a545aef27f5722c82", "html_url": "https://github.com/rust-lang/rust/commit/422741151359b8ad4b4f1f4a545aef27f5722c82", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/422741151359b8ad4b4f1f4a545aef27f5722c82/comments", "author": {"login": "Jarcho", "id": 7761774, "node_id": "MDQ6VXNlcjc3NjE3NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7761774?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jarcho", "html_url": "https://github.com/Jarcho", "followers_url": "https://api.github.com/users/Jarcho/followers", "following_url": "https://api.github.com/users/Jarcho/following{/other_user}", "gists_url": "https://api.github.com/users/Jarcho/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jarcho/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jarcho/subscriptions", "organizations_url": "https://api.github.com/users/Jarcho/orgs", "repos_url": "https://api.github.com/users/Jarcho/repos", "events_url": "https://api.github.com/users/Jarcho/events{/privacy}", "received_events_url": "https://api.github.com/users/Jarcho/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Jarcho", "id": 7761774, "node_id": "MDQ6VXNlcjc3NjE3NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7761774?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jarcho", "html_url": "https://github.com/Jarcho", "followers_url": "https://api.github.com/users/Jarcho/followers", "following_url": "https://api.github.com/users/Jarcho/following{/other_user}", "gists_url": "https://api.github.com/users/Jarcho/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jarcho/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jarcho/subscriptions", "organizations_url": "https://api.github.com/users/Jarcho/orgs", "repos_url": "https://api.github.com/users/Jarcho/repos", "events_url": "https://api.github.com/users/Jarcho/events{/privacy}", "received_events_url": "https://api.github.com/users/Jarcho/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "85b88be2a4fc46fc27d51d4fb273d65818ee63d7", "url": "https://api.github.com/repos/rust-lang/rust/commits/85b88be2a4fc46fc27d51d4fb273d65818ee63d7", "html_url": "https://github.com/rust-lang/rust/commit/85b88be2a4fc46fc27d51d4fb273d65818ee63d7"}], "stats": {"total": 48, "additions": 32, "deletions": 16}, "files": [{"sha": "b010149626cf83b840082c5013a6f26c442d62d1", "filename": "clippy_dev/src/update_lints.rs", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/422741151359b8ad4b4f1f4a545aef27f5722c82/clippy_dev%2Fsrc%2Fupdate_lints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/422741151359b8ad4b4f1f4a545aef27f5722c82/clippy_dev%2Fsrc%2Fupdate_lints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Fupdate_lints.rs?ref=422741151359b8ad4b4f1f4a545aef27f5722c82", "patch": "@@ -107,6 +107,9 @@ pub fn run(update_mode: UpdateMode) {\n             &content,\n         );\n     }\n+\n+    let content = gen_deprecated_lints_test(&deprecated_lints);\n+    process_file(\"tests/ui/deprecated.rs\", update_mode, &content);\n }\n \n pub fn print_lints() {\n@@ -276,6 +279,15 @@ fn gen_register_lint_list<'a>(\n     output\n }\n \n+fn gen_deprecated_lints_test(lints: &[DeprecatedLint]) -> String {\n+    let mut res: String = GENERATED_FILE_COMMENT.into();\n+    for lint in lints {\n+        writeln!(res, \"#![warn(clippy::{})]\", lint.name).unwrap();\n+    }\n+    res.push_str(\"\\nfn main() {}\\n\");\n+    res\n+}\n+\n /// Gathers all lints defined in `clippy_lints/src`\n fn gather_all() -> (Vec<Lint>, Vec<DeprecatedLint>) {\n     let mut lints = Vec::with_capacity(1000);"}, {"sha": "07270bd76362a1a8cf4eadc533d6c0e01465d259", "filename": "tests/ui/deprecated.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/422741151359b8ad4b4f1f4a545aef27f5722c82/tests%2Fui%2Fdeprecated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/422741151359b8ad4b4f1f4a545aef27f5722c82/tests%2Fui%2Fdeprecated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fdeprecated.rs?ref=422741151359b8ad4b4f1f4a545aef27f5722c82", "patch": "@@ -1,3 +1,7 @@\n+// This file was generated by `cargo dev update_lints`.\n+// Use that command to update this file and do not edit by hand.\n+// Manual edits will be overwritten.\n+\n #![warn(clippy::should_assert_eq)]\n #![warn(clippy::extend_from_slice)]\n #![warn(clippy::range_step_by_zero)]"}, {"sha": "0e142ac8f20e7a3a83d0f1792f7363cb402be641", "filename": "tests/ui/deprecated.stderr", "status": "modified", "additions": 16, "deletions": 16, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/422741151359b8ad4b4f1f4a545aef27f5722c82/tests%2Fui%2Fdeprecated.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/422741151359b8ad4b4f1f4a545aef27f5722c82/tests%2Fui%2Fdeprecated.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fdeprecated.stderr?ref=422741151359b8ad4b4f1f4a545aef27f5722c82", "patch": "@@ -1,97 +1,97 @@\n error: lint `clippy::should_assert_eq` has been removed: `assert!()` will be more flexible with RFC 2011\n-  --> $DIR/deprecated.rs:1:9\n+  --> $DIR/deprecated.rs:5:9\n    |\n LL | #![warn(clippy::should_assert_eq)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n    = note: `-D renamed-and-removed-lints` implied by `-D warnings`\n \n error: lint `clippy::extend_from_slice` has been removed: `.extend_from_slice(_)` is a faster way to extend a Vec by a slice\n-  --> $DIR/deprecated.rs:2:9\n+  --> $DIR/deprecated.rs:6:9\n    |\n LL | #![warn(clippy::extend_from_slice)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::range_step_by_zero` has been removed: `iterator.step_by(0)` panics nowadays\n-  --> $DIR/deprecated.rs:3:9\n+  --> $DIR/deprecated.rs:7:9\n    |\n LL | #![warn(clippy::range_step_by_zero)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::unstable_as_slice` has been removed: `Vec::as_slice` has been stabilized in 1.7\n-  --> $DIR/deprecated.rs:4:9\n+  --> $DIR/deprecated.rs:8:9\n    |\n LL | #![warn(clippy::unstable_as_slice)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::unstable_as_mut_slice` has been removed: `Vec::as_mut_slice` has been stabilized in 1.7\n-  --> $DIR/deprecated.rs:5:9\n+  --> $DIR/deprecated.rs:9:9\n    |\n LL | #![warn(clippy::unstable_as_mut_slice)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::misaligned_transmute` has been removed: this lint has been split into cast_ptr_alignment and transmute_ptr_to_ptr\n-  --> $DIR/deprecated.rs:6:9\n+  --> $DIR/deprecated.rs:10:9\n    |\n LL | #![warn(clippy::misaligned_transmute)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::assign_ops` has been removed: using compound assignment operators (e.g., `+=`) is harmless\n-  --> $DIR/deprecated.rs:7:9\n+  --> $DIR/deprecated.rs:11:9\n    |\n LL | #![warn(clippy::assign_ops)]\n    |         ^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::if_let_redundant_pattern_matching` has been removed: this lint has been changed to redundant_pattern_matching\n-  --> $DIR/deprecated.rs:8:9\n+  --> $DIR/deprecated.rs:12:9\n    |\n LL | #![warn(clippy::if_let_redundant_pattern_matching)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::unsafe_vector_initialization` has been removed: the replacement suggested by this lint had substantially different behavior\n-  --> $DIR/deprecated.rs:9:9\n+  --> $DIR/deprecated.rs:13:9\n    |\n LL | #![warn(clippy::unsafe_vector_initialization)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::unused_collect` has been removed: `collect` has been marked as #[must_use] in rustc and that covers all cases of this lint\n-  --> $DIR/deprecated.rs:10:9\n+  --> $DIR/deprecated.rs:14:9\n    |\n LL | #![warn(clippy::unused_collect)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::replace_consts` has been removed: associated-constants `MIN`/`MAX` of integers are preferred to `{min,max}_value()` and module constants\n-  --> $DIR/deprecated.rs:11:9\n+  --> $DIR/deprecated.rs:15:9\n    |\n LL | #![warn(clippy::replace_consts)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::regex_macro` has been removed: the regex! macro has been removed from the regex crate in 2018\n-  --> $DIR/deprecated.rs:12:9\n+  --> $DIR/deprecated.rs:16:9\n    |\n LL | #![warn(clippy::regex_macro)]\n    |         ^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::find_map` has been removed: this lint has been replaced by `manual_find_map`, a more specific lint\n-  --> $DIR/deprecated.rs:13:9\n+  --> $DIR/deprecated.rs:17:9\n    |\n LL | #![warn(clippy::find_map)]\n    |         ^^^^^^^^^^^^^^^^\n \n error: lint `clippy::filter_map` has been removed: this lint has been replaced by `manual_filter_map`, a more specific lint\n-  --> $DIR/deprecated.rs:14:9\n+  --> $DIR/deprecated.rs:18:9\n    |\n LL | #![warn(clippy::filter_map)]\n    |         ^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::pub_enum_variant_names` has been removed: set the `avoid-breaking-exported-api` config option to `false` to enable the `enum_variant_names` lint for public items\n-  --> $DIR/deprecated.rs:15:9\n+  --> $DIR/deprecated.rs:19:9\n    |\n LL | #![warn(clippy::pub_enum_variant_names)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: lint `clippy::wrong_pub_self_convention` has been removed: set the `avoid-breaking-exported-api` config option to `false` to enable the `wrong_self_convention` lint for public items\n-  --> $DIR/deprecated.rs:16:9\n+  --> $DIR/deprecated.rs:20:9\n    |\n LL | #![warn(clippy::wrong_pub_self_convention)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"}]}