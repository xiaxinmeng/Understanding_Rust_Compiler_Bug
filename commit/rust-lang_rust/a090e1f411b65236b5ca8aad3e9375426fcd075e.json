{"sha": "a090e1f411b65236b5ca8aad3e9375426fcd075e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEwOTBlMWY0MTFiNjUyMzZiNWNhOGFhZDNlOTM3NTQyNmZjZDA3NWU=", "commit": {"author": {"name": "Ulrik Sverdrup", "email": "root@localhost", "date": "2015-06-06T12:26:39Z"}, "committer": {"name": "Ulrik Sverdrup", "email": "root@localhost", "date": "2015-06-06T12:26:39Z"}, "message": "linked_list: Use a safe loop in Drop", "tree": {"sha": "92863e0e61ea21a3eba08a8e7c7ae6176b543b1e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/92863e0e61ea21a3eba08a8e7c7ae6176b543b1e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a090e1f411b65236b5ca8aad3e9375426fcd075e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a090e1f411b65236b5ca8aad3e9375426fcd075e", "html_url": "https://github.com/rust-lang/rust/commit/a090e1f411b65236b5ca8aad3e9375426fcd075e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a090e1f411b65236b5ca8aad3e9375426fcd075e/comments", "author": {"login": "invalid-email-address", "id": 148100, "node_id": "MDQ6VXNlcjE0ODEwMA==", "avatar_url": "https://avatars.githubusercontent.com/u/148100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/invalid-email-address", "html_url": "https://github.com/invalid-email-address", "followers_url": "https://api.github.com/users/invalid-email-address/followers", "following_url": "https://api.github.com/users/invalid-email-address/following{/other_user}", "gists_url": "https://api.github.com/users/invalid-email-address/gists{/gist_id}", "starred_url": "https://api.github.com/users/invalid-email-address/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/invalid-email-address/subscriptions", "organizations_url": "https://api.github.com/users/invalid-email-address/orgs", "repos_url": "https://api.github.com/users/invalid-email-address/repos", "events_url": "https://api.github.com/users/invalid-email-address/events{/privacy}", "received_events_url": "https://api.github.com/users/invalid-email-address/received_events", "type": "User", "site_admin": false}, "committer": {"login": "invalid-email-address", "id": 148100, "node_id": "MDQ6VXNlcjE0ODEwMA==", "avatar_url": "https://avatars.githubusercontent.com/u/148100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/invalid-email-address", "html_url": "https://github.com/invalid-email-address", "followers_url": "https://api.github.com/users/invalid-email-address/followers", "following_url": "https://api.github.com/users/invalid-email-address/following{/other_user}", "gists_url": "https://api.github.com/users/invalid-email-address/gists{/gist_id}", "starred_url": "https://api.github.com/users/invalid-email-address/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/invalid-email-address/subscriptions", "organizations_url": "https://api.github.com/users/invalid-email-address/orgs", "repos_url": "https://api.github.com/users/invalid-email-address/repos", "events_url": "https://api.github.com/users/invalid-email-address/events{/privacy}", "received_events_url": "https://api.github.com/users/invalid-email-address/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "da0d45243bbb04ea7efec686162d0b9ce2ec4734", "url": "https://api.github.com/repos/rust-lang/rust/commits/da0d45243bbb04ea7efec686162d0b9ce2ec4734", "html_url": "https://github.com/rust-lang/rust/commit/da0d45243bbb04ea7efec686162d0b9ce2ec4734"}], "stats": {"total": 14, "additions": 3, "deletions": 11}, "files": [{"sha": "b82a25544c930b09367426be0ff9abc60f13033d", "filename": "src/libcollections/linked_list.rs", "status": "modified", "additions": 3, "deletions": 11, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/a090e1f411b65236b5ca8aad3e9375426fcd075e/src%2Flibcollections%2Flinked_list.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a090e1f411b65236b5ca8aad3e9375426fcd075e/src%2Flibcollections%2Flinked_list.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcollections%2Flinked_list.rs?ref=a090e1f411b65236b5ca8aad3e9375426fcd075e", "patch": "@@ -626,21 +626,13 @@ impl<T> LinkedList<T> {\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n impl<T> Drop for LinkedList<T> {\n     fn drop(&mut self) {\n-        // Dissolve the linked_list in backwards direction\n+        // Dissolve the linked_list in a loop.\n         // Just dropping the list_head can lead to stack exhaustion\n         // when length is >> 1_000_000\n-        let mut tail = self.list_tail;\n-        loop {\n-            match tail.resolve() {\n-                None => break,\n-                Some(prev) => {\n-                    prev.next.take(); // release Box<Node<T>>\n-                    tail = prev.prev;\n-                }\n-            }\n+        while let Some(mut head_) = self.list_head.take() {\n+            self.list_head = head_.next.take();\n         }\n         self.length = 0;\n-        self.list_head = None;\n         self.list_tail = Rawlink::none();\n     }\n }"}]}