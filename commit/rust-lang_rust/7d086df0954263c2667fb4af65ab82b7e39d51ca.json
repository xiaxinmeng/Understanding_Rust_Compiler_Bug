{"sha": "7d086df0954263c2667fb4af65ab82b7e39d51ca", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdkMDg2ZGYwOTU0MjYzYzI2NjdmYjRhZjY1YWI4MmI3ZTM5ZDUxY2E=", "commit": {"author": {"name": "Marijn Haverbeke", "email": "marijnh@gmail.com", "date": "2011-05-11T11:49:48Z"}, "committer": {"name": "Marijn Haverbeke", "email": "marijnh@gmail.com", "date": "2011-05-11T11:49:48Z"}, "message": "Stop depending on block indices in capture.rs", "tree": {"sha": "bd06812266869df9b19cbf3529e9c5ef4fe54010", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bd06812266869df9b19cbf3529e9c5ef4fe54010"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7d086df0954263c2667fb4af65ab82b7e39d51ca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7d086df0954263c2667fb4af65ab82b7e39d51ca", "html_url": "https://github.com/rust-lang/rust/commit/7d086df0954263c2667fb4af65ab82b7e39d51ca", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7d086df0954263c2667fb4af65ab82b7e39d51ca/comments", "author": {"login": "marijnh", "id": 144427, "node_id": "MDQ6VXNlcjE0NDQyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/144427?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marijnh", "html_url": "https://github.com/marijnh", "followers_url": "https://api.github.com/users/marijnh/followers", "following_url": "https://api.github.com/users/marijnh/following{/other_user}", "gists_url": "https://api.github.com/users/marijnh/gists{/gist_id}", "starred_url": "https://api.github.com/users/marijnh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marijnh/subscriptions", "organizations_url": "https://api.github.com/users/marijnh/orgs", "repos_url": "https://api.github.com/users/marijnh/repos", "events_url": "https://api.github.com/users/marijnh/events{/privacy}", "received_events_url": "https://api.github.com/users/marijnh/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marijnh", "id": 144427, "node_id": "MDQ6VXNlcjE0NDQyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/144427?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marijnh", "html_url": "https://github.com/marijnh", "followers_url": "https://api.github.com/users/marijnh/followers", "following_url": "https://api.github.com/users/marijnh/following{/other_user}", "gists_url": "https://api.github.com/users/marijnh/gists{/gist_id}", "starred_url": "https://api.github.com/users/marijnh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marijnh/subscriptions", "organizations_url": "https://api.github.com/users/marijnh/orgs", "repos_url": "https://api.github.com/users/marijnh/repos", "events_url": "https://api.github.com/users/marijnh/events{/privacy}", "received_events_url": "https://api.github.com/users/marijnh/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9cb20153a8e8cdcbf0e88f5575c9b1f7b37175da", "url": "https://api.github.com/repos/rust-lang/rust/commits/9cb20153a8e8cdcbf0e88f5575c9b1f7b37175da", "html_url": "https://github.com/rust-lang/rust/commit/9cb20153a8e8cdcbf0e88f5575c9b1f7b37175da"}], "stats": {"total": 14, "additions": 9, "deletions": 5}, "files": [{"sha": "89948b4df7647b2c638b04c1622d2ca5159369b6", "filename": "src/comp/middle/capture.rs", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/7d086df0954263c2667fb4af65ab82b7e39d51ca/src%2Fcomp%2Fmiddle%2Fcapture.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7d086df0954263c2667fb4af65ab82b7e39d51ca/src%2Fcomp%2Fmiddle%2Fcapture.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Fcapture.rs?ref=7d086df0954263c2667fb4af65ab82b7e39d51ca", "patch": "@@ -79,11 +79,15 @@ fn walk_expr(@env e, &@ast.expr x) {\n }\n \n fn walk_block(@env e, &ast.block b) {\n-    for each (@tup(ast.ident, ast.block_index_entry) it in\n-              b.node.index.items()) {\n-        alt (it._1) {\n-            case (ast.bie_local(?local)) {\n-                e.idmap.insert(local.id, current_context(*e));\n+    for (@ast.stmt st in b.node.stmts) {\n+        alt (st.node) {\n+            case (ast.stmt_decl(?d,_)) {\n+                alt (d.node) {\n+                    case (ast.decl_local(?loc)) {\n+                        e.idmap.insert(loc.id, current_context(*e));\n+                    }\n+                    case (_) { }\n+                }\n             }\n             case (_) { }\n         }"}]}