{"sha": "fe2b7a49524c889715fb3346d4d309ecbd6ba651", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZlMmI3YTQ5NTI0Yzg4OTcxNWZiMzM0NmQ0ZDMwOWVjYmQ2YmE2NTE=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2017-03-14T02:49:36Z"}, "committer": {"name": "Peter Atashian", "email": "retep998@gmail.com", "date": "2017-03-21T20:26:13Z"}, "message": "rustbuild: Don't hardcode 'nightly' for Cargo\n\nIt now follows rustc release trains", "tree": {"sha": "40bcd4ded0af76fb077ff5f9969ab71cc669504e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/40bcd4ded0af76fb077ff5f9969ab71cc669504e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fe2b7a49524c889715fb3346d4d309ecbd6ba651", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v2\n\niQEcBAABCAAGBQJY0YxlAAoJEN4E2eJ1WbyK42IH/2NfaUSB+adDceRu4It7I9g9\nKvGKBk6v+sM9aapbFIfRPybuff0Eh1awm+nQ+/ytePfyXtvxU93Baa8OihM8xLo6\n2DdRU3asOw0jrI65fpAdVmez+82oSPnBh2r9IQvflJQYbMWwYA97eF8cKtuZwAd5\n0TqYOrCtYrHKCjm16KIEFP8LbgcBM6PyJIK/5PrDeOa+fMzAF9ukEoWAqZ+6EIn5\nYxUr5Nhp7KgHnnVZ3PUsnOowOXVugBBvnFaTAEv80hf+f5ikCkkbo+M9P+xbFQfy\nWGexGsEI9GEbUpXtUA7MEcjyOMFO9Rw4uBFiH5uxibsNMqB81hoFVClQhc5yJa8=\n=PKJ8\n-----END PGP SIGNATURE-----", "payload": "tree 40bcd4ded0af76fb077ff5f9969ab71cc669504e\nparent 58c701f5c7dc26d9b55c631006ece52abe1ddce2\nauthor Alex Crichton <alex@alexcrichton.com> 1489459776 -0700\ncommitter Peter Atashian <retep998@gmail.com> 1490127973 -0400\n\nrustbuild: Don't hardcode 'nightly' for Cargo\n\nIt now follows rustc release trains\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fe2b7a49524c889715fb3346d4d309ecbd6ba651", "html_url": "https://github.com/rust-lang/rust/commit/fe2b7a49524c889715fb3346d4d309ecbd6ba651", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fe2b7a49524c889715fb3346d4d309ecbd6ba651/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "retep998", "id": 666308, "node_id": "MDQ6VXNlcjY2NjMwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/666308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/retep998", "html_url": "https://github.com/retep998", "followers_url": "https://api.github.com/users/retep998/followers", "following_url": "https://api.github.com/users/retep998/following{/other_user}", "gists_url": "https://api.github.com/users/retep998/gists{/gist_id}", "starred_url": "https://api.github.com/users/retep998/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/retep998/subscriptions", "organizations_url": "https://api.github.com/users/retep998/orgs", "repos_url": "https://api.github.com/users/retep998/repos", "events_url": "https://api.github.com/users/retep998/events{/privacy}", "received_events_url": "https://api.github.com/users/retep998/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "58c701f5c7dc26d9b55c631006ece52abe1ddce2", "url": "https://api.github.com/repos/rust-lang/rust/commits/58c701f5c7dc26d9b55c631006ece52abe1ddce2", "html_url": "https://github.com/rust-lang/rust/commit/58c701f5c7dc26d9b55c631006ece52abe1ddce2"}], "stats": {"total": 24, "additions": 16, "deletions": 8}, "files": [{"sha": "ec992b47a6e4b0d3865cc071a31fa0b05dd3552a", "filename": "src/bootstrap/dist.rs", "status": "modified", "additions": 11, "deletions": 8, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/fe2b7a49524c889715fb3346d4d309ecbd6ba651/src%2Fbootstrap%2Fdist.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fe2b7a49524c889715fb3346d4d309ecbd6ba651/src%2Fbootstrap%2Fdist.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdist.rs?ref=fe2b7a49524c889715fb3346d4d309ecbd6ba651", "patch": "@@ -37,8 +37,12 @@ use channel;\n use util::{cp_r, libdir, is_dylib, cp_filtered, copy, exe};\n \n fn pkgname(build: &Build, component: &str) -> String {\n-    assert!(component.starts_with(\"rust\")); // does not work with cargo\n-    format!(\"{}-{}\", component, build.rust_package_vers())\n+    if component == \"cargo\" {\n+        format!(\"{}-{}\", component, build.cargo_package_vers())\n+    } else {\n+        assert!(component.starts_with(\"rust\"));\n+        format!(\"{}-{}\", component, build.rust_package_vers())\n+    }\n }\n \n fn distdir(build: &Build) -> PathBuf {\n@@ -533,7 +537,7 @@ pub fn cargo(build: &Build, stage: u32, target: &str) {\n     let src = build.src.join(\"cargo\");\n     let etc = src.join(\"src/etc\");\n     let release_num = build.cargo_release_num();\n-    let name = format!(\"cargo-{}\", build.package_vers(&release_num));\n+    let name = pkgname(build, \"cargo\");\n     let version = build.cargo_info.version(build, &release_num);\n \n     let tmp = tmpdir(build);\n@@ -591,12 +595,11 @@ pub fn extended(build: &Build, stage: u32, target: &str) {\n     println!(\"Dist extended stage{} ({})\", stage, target);\n \n     let dist = distdir(build);\n-    let cargo_vers = build.cargo_release_num();\n     let rustc_installer = dist.join(format!(\"{}-{}.tar.gz\",\n                                             pkgname(build, \"rustc\"),\n                                             target));\n-    let cargo_installer = dist.join(format!(\"cargo-{}-{}.tar.gz\",\n-                                            build.package_vers(&cargo_vers),\n+    let cargo_installer = dist.join(format!(\"{}-{}.tar.gz\",\n+                                            pkgname(build, \"cargo\"),\n                                             target));\n     let docs_installer = dist.join(format!(\"{}-{}.tar.gz\",\n                                            pkgname(build, \"rust-docs\"),\n@@ -674,7 +677,7 @@ pub fn extended(build: &Build, stage: u32, target: &str) {\n \n         cp_r(&work.join(&format!(\"{}-{}\", pkgname(build, \"rustc\"), target)),\n              &pkg.join(\"rustc\"));\n-        cp_r(&work.join(&format!(\"cargo-nightly-{}\", target)),\n+        cp_r(&work.join(&format!(\"{}-{}\", pkgname(build, \"cargo\"), target)),\n              &pkg.join(\"cargo\"));\n         cp_r(&work.join(&format!(\"{}-{}\", pkgname(build, \"rust-docs\"), target)),\n              &pkg.join(\"rust-docs\"));\n@@ -726,7 +729,7 @@ pub fn extended(build: &Build, stage: u32, target: &str) {\n         cp_r(&work.join(&format!(\"{}-{}\", pkgname(build, \"rustc\"), target))\n                   .join(\"rustc\"),\n              &exe.join(\"rustc\"));\n-        cp_r(&work.join(&format!(\"cargo-nightly-{}\", target))\n+        cp_r(&work.join(&format!(\"{}-{}\", pkgname(build, \"cargo\"), target))\n                   .join(\"cargo\"),\n              &exe.join(\"cargo\"));\n         cp_r(&work.join(&format!(\"{}-{}\", pkgname(build, \"rust-docs\"), target))"}, {"sha": "84254d7d6ae515b2f49afaa647e58aec2bcb2b63", "filename": "src/bootstrap/lib.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fe2b7a49524c889715fb3346d4d309ecbd6ba651/src%2Fbootstrap%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fe2b7a49524c889715fb3346d4d309ecbd6ba651/src%2Fbootstrap%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Flib.rs?ref=fe2b7a49524c889715fb3346d4d309ecbd6ba651", "patch": "@@ -1015,6 +1015,11 @@ impl Build {\n         self.package_vers(channel::CFG_RELEASE_NUM)\n     }\n \n+    /// Returns the value of `package_vers` above for Cargo\n+    fn cargo_package_vers(&self) -> String {\n+        self.package_vers(&self.cargo_release_num())\n+    }\n+\n     /// Returns the `version` string associated with this compiler for Rust\n     /// itself.\n     ///"}]}