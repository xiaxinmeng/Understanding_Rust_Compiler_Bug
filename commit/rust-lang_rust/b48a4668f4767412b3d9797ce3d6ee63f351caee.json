{"sha": "b48a4668f4767412b3d9797ce3d6ee63f351caee", "node_id": "C_kwDOAAsO6NoAKGI0OGE0NjY4ZjQ3Njc0MTJiM2Q5Nzk3Y2UzZDZlZTYzZjM1MWNhZWU", "commit": {"author": {"name": "Doru-Florin Blanzeanu", "email": "blanzeanu.doru@protonmail.com", "date": "2022-10-21T16:08:04Z"}, "committer": {"name": "Doru-Florin Blanzeanu", "email": "blanzeanu.doru@protonmail.com", "date": "2022-10-24T11:00:56Z"}, "message": "Add msrv check for `rewind_instead_of_seek_to_start` lint\n\nSigned-off-by: Doru-Florin Blanzeanu <blanzeanu.doru@protonmail.com>", "tree": {"sha": "b245104639bc870ee810c15d80c2d5fd9bd2b81d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b245104639bc870ee810c15d80c2d5fd9bd2b81d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b48a4668f4767412b3d9797ce3d6ee63f351caee", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN SSH SIGNATURE-----\nU1NIU0lHAAAAAQAAAhcAAAAHc3NoLXJzYQAAAAMBAAEAAAIBALz0ayFLchIYjexhdAtl9B\nnMu93u/Og8kCa1G7kmyujm3/KmZ5DpcDesaUyYcLMsw3EpyEQ9JtCXCGVc8thezPp/4/rp\nQXWib/tvh3MAfyrskit1kdo5nGr6xpybPL2UCZQtcxzWBpjacHd4C5w0B2BCQGjK3cwjhC\nuhlYyQ5VnfSmFH9UDvxj9dp5Pps/XBKeJi+460G9nahGXcPiFm2RlyadPXEvx0qbU6Tg88\nIuVL9/QxMI2xh7yoXdeZHE5Hn97u9FSL0S8Hah9m7xX9GWq0E7B7uducWQmEXFu/p38Nsr\ndxCBRjccfKEGxlnyaBJ1L0cLzVfPuyQmEf1/38vAxWr9SUX4dFa0wDn5f34goD/b7/Xzjg\nDsfO32vLUtCcuv7+a5LyfqpDPAdFcgd4pvQpkAjWiQNldscCT/X56hay6cC+73EYXcr7Mf\nfQVwLxIp8C/oFJrTWgMZy6BIHh92rdWleI5guD7TDTdOUJN9yAsjMUK3UisIhtikP/++5P\nboFmnJKcqJSoK0nuXKrPNy2lTcwSzowC3aeUivToQSoj4QAMOd904Bz7pkpqHa7xklXhKx\nOlx2RrfqL50uL2ivk63ftLr+dWmK+st5cAgtiBOkm4z/BCIoD7CNU9Jo0ZOHuNEfwFaswQ\ntilBsb230D+P2Gb9G01+UESxnECdkxgjAAAAA2dpdAAAAAAAAAAGc2hhNTEyAAACFAAAAA\nxyc2Etc2hhMi01MTIAAAIAZsSVZ1G09BrG3yJfVOmV7Xh0NuRcTSH4TKwZTSB5dH0nlrV8\nyma73xy4SWpuo6DX2avespt16o6x8A+HKI9IoaVSz5qytI/Q8Hoe5Ecf4wwscIoI2phiT9\nk6AIdfrAJI3JF44y4qwzwf3hTZft2B5LgC9Ng0Iqn6Jp1FhEp7OPEeGIlKnqcUMgL+n6hp\nz2tVdz8WnPBDzK5bQPgLBOcJ6JPQx+n2FkrWvATrzkzyOIfKp5Kp5lemdjbhB9W4oDky1d\nuTfVQqCr4oAztjtDQLP+UWfwJLElVpDrshXabtOKtYtAgqi2G0up9cBhWrfZfof4b7CXkv\n+FVXvFhRhEntZnC6GobQSOJxeCzp9HCo8Y0/iGqxa4+lCMac94bGFOBsaMjwgnZJMGdPob\nHiWtDTK1GYXntGKICgCzMpk9B4kQojyimIn8bIlT6FEe5hkJJIVO5xgMqQD1x0Re+tY+Ha\nsW/jeMlIzXh1ZuCN7l6Mr3PyUWvA+h+2HY2fVQ6ZHnr3xAvreYJFiAieJgSaXYcxug2lDt\n+TGuFL2iuvHTR2bv9JKIPh7oVVB7uwmhZYc219m7dklQEWNyUrei81JxOhH2NNMwqwRmqh\nOhs1bmkQXi3vTy0HBf3hMAX+STOByzxKw9Zn9xuEH8OzYl+OCdPsaLpeYOPlG2r+iJbsWj\nXPjG4=\n-----END SSH SIGNATURE-----", "payload": "tree b245104639bc870ee810c15d80c2d5fd9bd2b81d\nparent 8d6ce3177bd5d4d05723dec1cdd869effc926fc3\nauthor Doru-Florin Blanzeanu <blanzeanu.doru@protonmail.com> 1666368484 +0000\ncommitter Doru-Florin Blanzeanu <blanzeanu.doru@protonmail.com> 1666609256 +0000\n\nAdd msrv check for `rewind_instead_of_seek_to_start` lint\n\nSigned-off-by: Doru-Florin Blanzeanu <blanzeanu.doru@protonmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b48a4668f4767412b3d9797ce3d6ee63f351caee", "html_url": "https://github.com/rust-lang/rust/commit/b48a4668f4767412b3d9797ce3d6ee63f351caee", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b48a4668f4767412b3d9797ce3d6ee63f351caee/comments", "author": {"login": "dorublanzeanu", "id": 13020154, "node_id": "MDQ6VXNlcjEzMDIwMTU0", "avatar_url": "https://avatars.githubusercontent.com/u/13020154?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dorublanzeanu", "html_url": "https://github.com/dorublanzeanu", "followers_url": "https://api.github.com/users/dorublanzeanu/followers", "following_url": "https://api.github.com/users/dorublanzeanu/following{/other_user}", "gists_url": "https://api.github.com/users/dorublanzeanu/gists{/gist_id}", "starred_url": "https://api.github.com/users/dorublanzeanu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dorublanzeanu/subscriptions", "organizations_url": "https://api.github.com/users/dorublanzeanu/orgs", "repos_url": "https://api.github.com/users/dorublanzeanu/repos", "events_url": "https://api.github.com/users/dorublanzeanu/events{/privacy}", "received_events_url": "https://api.github.com/users/dorublanzeanu/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dorublanzeanu", "id": 13020154, "node_id": "MDQ6VXNlcjEzMDIwMTU0", "avatar_url": "https://avatars.githubusercontent.com/u/13020154?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dorublanzeanu", "html_url": "https://github.com/dorublanzeanu", "followers_url": "https://api.github.com/users/dorublanzeanu/followers", "following_url": "https://api.github.com/users/dorublanzeanu/following{/other_user}", "gists_url": "https://api.github.com/users/dorublanzeanu/gists{/gist_id}", "starred_url": "https://api.github.com/users/dorublanzeanu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dorublanzeanu/subscriptions", "organizations_url": "https://api.github.com/users/dorublanzeanu/orgs", "repos_url": "https://api.github.com/users/dorublanzeanu/repos", "events_url": "https://api.github.com/users/dorublanzeanu/events{/privacy}", "received_events_url": "https://api.github.com/users/dorublanzeanu/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8d6ce3177bd5d4d05723dec1cdd869effc926fc3", "url": "https://api.github.com/repos/rust-lang/rust/commits/8d6ce3177bd5d4d05723dec1cdd869effc926fc3", "html_url": "https://github.com/rust-lang/rust/commit/8d6ce3177bd5d4d05723dec1cdd869effc926fc3"}], "stats": {"total": 103, "additions": 99, "deletions": 4}, "files": [{"sha": "7b0a676e89e3df3ebe35682635e99d999ef41d2a", "filename": "clippy_lints/src/methods/mod.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b48a4668f4767412b3d9797ce3d6ee63f351caee/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b48a4668f4767412b3d9797ce3d6ee63f351caee/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs?ref=b48a4668f4767412b3d9797ce3d6ee63f351caee", "patch": "@@ -3638,7 +3638,9 @@ impl Methods {\n                     vec_resize_to_zero::check(cx, expr, count_arg, default_arg, span);\n                 },\n                 (\"seek\", [arg]) => {\n-                    rewind_instead_of_seek_to_start::check(cx, expr, recv, arg, span);\n+                    if meets_msrv(self.msrv, msrvs::SEEK_REWIND) {\n+                        rewind_instead_of_seek_to_start::check(cx, expr, recv, arg, span);\n+                    }\n                 },\n                 (\"sort\", []) => {\n                     stable_sort_primitive::check(cx, expr, recv);"}, {"sha": "6f77155ec3e8e4e7bd07dada9f7428538203a390", "filename": "clippy_utils/src/msrvs.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b48a4668f4767412b3d9797ce3d6ee63f351caee/clippy_utils%2Fsrc%2Fmsrvs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b48a4668f4767412b3d9797ce3d6ee63f351caee/clippy_utils%2Fsrc%2Fmsrvs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_utils%2Fsrc%2Fmsrvs.rs?ref=b48a4668f4767412b3d9797ce3d6ee63f351caee", "patch": "@@ -37,4 +37,5 @@ msrv_aliases! {\n     1,18,0 { HASH_MAP_RETAIN, HASH_SET_RETAIN }\n     1,17,0 { FIELD_INIT_SHORTHAND, STATIC_IN_CONST, EXPECT_ERR }\n     1,16,0 { STR_REPEAT }\n+    1,55,0 { SEEK_REWIND }\n }"}, {"sha": "36853780977aa9479a86d41a86b76ab7a97bb2d2", "filename": "tests/ui/rewind_instead_of_seek_to_start.fixed", "status": "modified", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/rust-lang/rust/blob/b48a4668f4767412b3d9797ce3d6ee63f351caee/tests%2Fui%2Frewind_instead_of_seek_to_start.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/b48a4668f4767412b3d9797ce3d6ee63f351caee/tests%2Fui%2Frewind_instead_of_seek_to_start.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frewind_instead_of_seek_to_start.fixed?ref=b48a4668f4767412b3d9797ce3d6ee63f351caee", "patch": "@@ -1,5 +1,6 @@\n // run-rustfix\n #![allow(unused)]\n+#![feature(custom_inner_attributes)]\n #![warn(clippy::rewind_instead_of_seek_to_start)]\n \n use std::fs::OpenOptions;\n@@ -92,3 +93,45 @@ fn main() {\n \n     assert_eq!(&buf, hello);\n }\n+\n+fn msrv_1_54() {\n+    #![clippy::msrv = \"1.54\"]\n+\n+    let mut f = OpenOptions::new()\n+        .write(true)\n+        .read(true)\n+        .create(true)\n+        .open(\"foo.txt\")\n+        .unwrap();\n+\n+    let hello = \"Hello!\\n\";\n+    write!(f, \"{hello}\").unwrap();\n+\n+    f.seek(SeekFrom::Start(0));\n+\n+    let mut buf = String::new();\n+    f.read_to_string(&mut buf).unwrap();\n+\n+    assert_eq!(&buf, hello);\n+}\n+\n+fn msrv_1_55() {\n+    #![clippy::msrv = \"1.55\"]\n+\n+    let mut f = OpenOptions::new()\n+        .write(true)\n+        .read(true)\n+        .create(true)\n+        .open(\"foo.txt\")\n+        .unwrap();\n+\n+    let hello = \"Hello!\\n\";\n+    write!(f, \"{hello}\").unwrap();\n+\n+    f.rewind();\n+\n+    let mut buf = String::new();\n+    f.read_to_string(&mut buf).unwrap();\n+\n+    assert_eq!(&buf, hello);\n+}"}, {"sha": "0d061b58fbab7f4f7ff871c8088711677857127e", "filename": "tests/ui/rewind_instead_of_seek_to_start.rs", "status": "modified", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/rust-lang/rust/blob/b48a4668f4767412b3d9797ce3d6ee63f351caee/tests%2Fui%2Frewind_instead_of_seek_to_start.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b48a4668f4767412b3d9797ce3d6ee63f351caee/tests%2Fui%2Frewind_instead_of_seek_to_start.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frewind_instead_of_seek_to_start.rs?ref=b48a4668f4767412b3d9797ce3d6ee63f351caee", "patch": "@@ -1,5 +1,6 @@\n // run-rustfix\n #![allow(unused)]\n+#![feature(custom_inner_attributes)]\n #![warn(clippy::rewind_instead_of_seek_to_start)]\n \n use std::fs::OpenOptions;\n@@ -92,3 +93,45 @@ fn main() {\n \n     assert_eq!(&buf, hello);\n }\n+\n+fn msrv_1_54() {\n+    #![clippy::msrv = \"1.54\"]\n+\n+    let mut f = OpenOptions::new()\n+        .write(true)\n+        .read(true)\n+        .create(true)\n+        .open(\"foo.txt\")\n+        .unwrap();\n+\n+    let hello = \"Hello!\\n\";\n+    write!(f, \"{hello}\").unwrap();\n+\n+    f.seek(SeekFrom::Start(0));\n+\n+    let mut buf = String::new();\n+    f.read_to_string(&mut buf).unwrap();\n+\n+    assert_eq!(&buf, hello);\n+}\n+\n+fn msrv_1_55() {\n+    #![clippy::msrv = \"1.55\"]\n+\n+    let mut f = OpenOptions::new()\n+        .write(true)\n+        .read(true)\n+        .create(true)\n+        .open(\"foo.txt\")\n+        .unwrap();\n+\n+    let hello = \"Hello!\\n\";\n+    write!(f, \"{hello}\").unwrap();\n+\n+    f.seek(SeekFrom::Start(0));\n+\n+    let mut buf = String::new();\n+    f.read_to_string(&mut buf).unwrap();\n+\n+    assert_eq!(&buf, hello);\n+}"}, {"sha": "e808678108420e883d9ab6517fbe1fda79855c3d", "filename": "tests/ui/rewind_instead_of_seek_to_start.stderr", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/b48a4668f4767412b3d9797ce3d6ee63f351caee/tests%2Fui%2Frewind_instead_of_seek_to_start.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b48a4668f4767412b3d9797ce3d6ee63f351caee/tests%2Fui%2Frewind_instead_of_seek_to_start.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frewind_instead_of_seek_to_start.stderr?ref=b48a4668f4767412b3d9797ce3d6ee63f351caee", "patch": "@@ -1,16 +1,22 @@\n error: used `seek` to go to the start of the stream\n-  --> $DIR/rewind_instead_of_seek_to_start.rs:53:7\n+  --> $DIR/rewind_instead_of_seek_to_start.rs:54:7\n    |\n LL |     t.seek(SeekFrom::Start(0));\n    |       ^^^^^^^^^^^^^^^^^^^^^^^^ help: replace with: `rewind()`\n    |\n    = note: `-D clippy::rewind-instead-of-seek-to-start` implied by `-D warnings`\n \n error: used `seek` to go to the start of the stream\n-  --> $DIR/rewind_instead_of_seek_to_start.rs:58:7\n+  --> $DIR/rewind_instead_of_seek_to_start.rs:59:7\n    |\n LL |     t.seek(SeekFrom::Start(0));\n    |       ^^^^^^^^^^^^^^^^^^^^^^^^ help: replace with: `rewind()`\n \n-error: aborting due to 2 previous errors\n+error: used `seek` to go to the start of the stream\n+  --> $DIR/rewind_instead_of_seek_to_start.rs:131:7\n+   |\n+LL |     f.seek(SeekFrom::Start(0));\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^ help: replace with: `rewind()`\n+\n+error: aborting due to 3 previous errors\n "}]}