{"sha": "3f17cd7cbbdecad5c76b9876096d3cfaf0740476", "node_id": "C_kwDOAAsO6NoAKDNmMTdjZDdjYmJkZWNhZDVjNzZiOTg3NjA5NmQzY2ZhZjA3NDA0NzY", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-06-13T19:35:58Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-06-13T19:35:58Z"}, "message": "Rollup merge of #98050 - JohnTitor:issue-67945, r=compiler-errors\n\nAdd some more regression tests for #67945\n\nCloses #67945, added two tests from https://github.com/rust-lang/rust/issues/67945#issuecomment-572617285, other snippets were already added in #71952 and #77439\nr? `@compiler-errors`", "tree": {"sha": "221decedf492df01cdab36245af3b0ef4f4e6dec", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/221decedf492df01cdab36245af3b0ef4f4e6dec"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3f17cd7cbbdecad5c76b9876096d3cfaf0740476", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJip5GfCRBK7hj4Ov3rIwAAIu8IADpZkGGot8AUyZy+C2MHLBtu\nfQiol6P1uwXp4yCOP8dpS5Y/EmEBMZydkaWRGwS6oyFIH5ix9d1jLW3s1OyYjBn5\n4PJN/RpjXwKrTncJOHCPWHiXk4nyiN60Watnt80OLMZrgyxwx/rBOrauqlW825m3\nZ44TM0toiHZiTOAXCkHrwXJcDMr0lfMSgXa9n9fTPMUNQagkhQfXAPFdpNznD48t\ncklLs3DTjLuOHu+Qih3wBJgq8IWHkEpFdEysq8Ieki73YmT0Uv62HCDHkrtRK4+c\np5AM50ecEteVanzndpTGGRiGFmMOiZJj1c+UKXgm+p8U26NAsht2nz/AqokR6po=\n=QISY\n-----END PGP SIGNATURE-----\n", "payload": "tree 221decedf492df01cdab36245af3b0ef4f4e6dec\nparent 62eb97a450d4d71ff4a60dc00c44f811d09dd184\nparent c4b43d89783aaba7b63a069114d878ecf4069cc7\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1655148958 +0200\ncommitter GitHub <noreply@github.com> 1655148958 +0200\n\nRollup merge of #98050 - JohnTitor:issue-67945, r=compiler-errors\n\nAdd some more regression tests for #67945\n\nCloses #67945, added two tests from https://github.com/rust-lang/rust/issues/67945#issuecomment-572617285, other snippets were already added in #71952 and #77439\nr? `@compiler-errors`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3f17cd7cbbdecad5c76b9876096d3cfaf0740476", "html_url": "https://github.com/rust-lang/rust/commit/3f17cd7cbbdecad5c76b9876096d3cfaf0740476", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3f17cd7cbbdecad5c76b9876096d3cfaf0740476/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "62eb97a450d4d71ff4a60dc00c44f811d09dd184", "url": "https://api.github.com/repos/rust-lang/rust/commits/62eb97a450d4d71ff4a60dc00c44f811d09dd184", "html_url": "https://github.com/rust-lang/rust/commit/62eb97a450d4d71ff4a60dc00c44f811d09dd184"}, {"sha": "c4b43d89783aaba7b63a069114d878ecf4069cc7", "url": "https://api.github.com/repos/rust-lang/rust/commits/c4b43d89783aaba7b63a069114d878ecf4069cc7", "html_url": "https://github.com/rust-lang/rust/commit/c4b43d89783aaba7b63a069114d878ecf4069cc7"}], "stats": {"total": 107, "additions": 107, "deletions": 0}, "files": [{"sha": "d3d9452d316eaac8730b36e6101a06be674e5ebe", "filename": "src/test/ui/const-generics/issues/issue-67945-3.full.stderr", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/3f17cd7cbbdecad5c76b9876096d3cfaf0740476/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-3.full.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3f17cd7cbbdecad5c76b9876096d3cfaf0740476/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-3.full.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-3.full.stderr?ref=3f17cd7cbbdecad5c76b9876096d3cfaf0740476", "patch": "@@ -0,0 +1,16 @@\n+error: overly complex generic constant\n+  --> $DIR/issue-67945-3.rs:10:13\n+   |\n+LL |       A: [(); {\n+   |  _____________^\n+LL | |         let x: Option<S> = None;\n+LL | |\n+LL | |         0\n+LL | |     }],\n+   | |_____^ blocks are not supported in generic constant\n+   |\n+   = help: consider moving this anonymous constant into a `const` function\n+   = note: this operation may be supported in the future\n+\n+error: aborting due to previous error\n+"}, {"sha": "8e6b4b20409ce5931a1e778f982278186ef8a420", "filename": "src/test/ui/const-generics/issues/issue-67945-3.min.stderr", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/3f17cd7cbbdecad5c76b9876096d3cfaf0740476/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-3.min.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3f17cd7cbbdecad5c76b9876096d3cfaf0740476/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-3.min.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-3.min.stderr?ref=3f17cd7cbbdecad5c76b9876096d3cfaf0740476", "patch": "@@ -0,0 +1,21 @@\n+error: generic parameters may not be used in const operations\n+  --> $DIR/issue-67945-3.rs:11:23\n+   |\n+LL |         let x: Option<S> = None;\n+   |                       ^ cannot perform const operation using `S`\n+   |\n+   = note: type parameters may not be used in const expressions\n+   = help: use `#![feature(generic_const_exprs)]` to allow generic const expressions\n+\n+error[E0392]: parameter `S` is never used\n+  --> $DIR/issue-67945-3.rs:9:12\n+   |\n+LL | struct Bug<S> {\n+   |            ^ unused parameter\n+   |\n+   = help: consider removing `S`, referring to it in a field, or using a marker such as `PhantomData`\n+   = help: if you intended `S` to be a const parameter, use `const S: usize` instead\n+\n+error: aborting due to 2 previous errors\n+\n+For more information about this error, try `rustc --explain E0392`."}, {"sha": "fd8a393effe72051f2142ec0ede94544c1c97ce7", "filename": "src/test/ui/const-generics/issues/issue-67945-3.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/3f17cd7cbbdecad5c76b9876096d3cfaf0740476/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3f17cd7cbbdecad5c76b9876096d3cfaf0740476/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-3.rs?ref=3f17cd7cbbdecad5c76b9876096d3cfaf0740476", "patch": "@@ -0,0 +1,17 @@\n+// Regression test for\n+// https://github.com/rust-lang/rust/issues/67945#issuecomment-572617285\n+// Make sure we don't emit an E0277 error.\n+\n+// revisions: full min\n+#![cfg_attr(full, feature(generic_const_exprs))]\n+#![cfg_attr(full, allow(incomplete_features))]\n+\n+struct Bug<S> { //[min]~ ERROR: parameter `S` is never used\n+    A: [(); { //[full]~ ERROR: overly complex generic constant\n+        let x: Option<S> = None;\n+        //[min]~^ ERROR: generic parameters may not be used in const operations\n+        0\n+    }],\n+}\n+\n+fn main() {}"}, {"sha": "9604eb35d02b2abc1f68adf27a960755610f4a3d", "filename": "src/test/ui/const-generics/issues/issue-67945-4.full.stderr", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/3f17cd7cbbdecad5c76b9876096d3cfaf0740476/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-4.full.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3f17cd7cbbdecad5c76b9876096d3cfaf0740476/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-4.full.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-4.full.stderr?ref=3f17cd7cbbdecad5c76b9876096d3cfaf0740476", "patch": "@@ -0,0 +1,16 @@\n+error: overly complex generic constant\n+  --> $DIR/issue-67945-4.rs:9:13\n+   |\n+LL |       A: [(); {\n+   |  _____________^\n+LL | |         let x: Option<Box<S>> = None;\n+LL | |\n+LL | |         0\n+LL | |     }],\n+   | |_____^ blocks are not supported in generic constant\n+   |\n+   = help: consider moving this anonymous constant into a `const` function\n+   = note: this operation may be supported in the future\n+\n+error: aborting due to previous error\n+"}, {"sha": "f9520872ddd27d8b9dbeef579acc1559608fb880", "filename": "src/test/ui/const-generics/issues/issue-67945-4.min.stderr", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/3f17cd7cbbdecad5c76b9876096d3cfaf0740476/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-4.min.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3f17cd7cbbdecad5c76b9876096d3cfaf0740476/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-4.min.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-4.min.stderr?ref=3f17cd7cbbdecad5c76b9876096d3cfaf0740476", "patch": "@@ -0,0 +1,21 @@\n+error: generic parameters may not be used in const operations\n+  --> $DIR/issue-67945-4.rs:10:27\n+   |\n+LL |         let x: Option<Box<S>> = None;\n+   |                           ^ cannot perform const operation using `S`\n+   |\n+   = note: type parameters may not be used in const expressions\n+   = help: use `#![feature(generic_const_exprs)]` to allow generic const expressions\n+\n+error[E0392]: parameter `S` is never used\n+  --> $DIR/issue-67945-4.rs:8:12\n+   |\n+LL | struct Bug<S> {\n+   |            ^ unused parameter\n+   |\n+   = help: consider removing `S`, referring to it in a field, or using a marker such as `PhantomData`\n+   = help: if you intended `S` to be a const parameter, use `const S: usize` instead\n+\n+error: aborting due to 2 previous errors\n+\n+For more information about this error, try `rustc --explain E0392`."}, {"sha": "9a27bf09f881460dab30deda158abd112a759c71", "filename": "src/test/ui/const-generics/issues/issue-67945-4.rs", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/3f17cd7cbbdecad5c76b9876096d3cfaf0740476/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-4.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3f17cd7cbbdecad5c76b9876096d3cfaf0740476/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-4.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-67945-4.rs?ref=3f17cd7cbbdecad5c76b9876096d3cfaf0740476", "patch": "@@ -0,0 +1,16 @@\n+// Regression test for\n+// https://github.com/rust-lang/rust/issues/67945#issuecomment-572617285\n+\n+// revisions: full min\n+#![cfg_attr(full, feature(generic_const_exprs))]\n+#![cfg_attr(full, allow(incomplete_features))]\n+\n+struct Bug<S> { //[min]~ ERROR: parameter `S` is never used\n+    A: [(); { //[full]~ ERROR: overly complex generic constant\n+        let x: Option<Box<S>> = None;\n+        //[min]~^ ERROR: generic parameters may not be used in const operations\n+        0\n+    }],\n+}\n+\n+fn main() {}"}]}