{"sha": "d60e93035f155e02d1b12b5bab13ebfb4d908891", "node_id": "C_kwDOAAsO6NoAKGQ2MGU5MzAzNWYxNTVlMDJkMWIxMmI1YmFiMTNlYmZiNGQ5MDg4OTE", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-08-31T12:29:51Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-08-31T12:29:51Z"}, "message": "Rollup merge of #100730 - CleanCut:diagnostics-rustc_monomorphize, r=davidtwco\n\nMigrate rustc_monomorphize to use SessionDiagnostic\n\n### Description\n\n- Migrates diagnostics in `rustc_monomorphize` to use `SessionDiagnostic`\n- Adds an `impl IntoDiagnosticArg for PathBuf`\n\n### TODO / Help!\n- [x] I'm having trouble figuring out how to apply an optional note. \ud83d\ude15  Help!?\n  - Resolved. It was bad docs. Fixed in https://github.com/rust-lang/rustc-dev-guide/pull/1437/files\n- [x] `errors:RecursionLimit` should be `#[fatal ...]`, but that doesn't exist so it's `#[error ...]` at the moment.\n  - Maybe I can switch after this is merged in? --> https://github.com/rust-lang/rust/pull/100694\n  - Or maybe I need to manually implement `SessionDiagnostic` instead of deriving it?\n- [x] How does one go about converting an error inside of [a call to struct_span_lint_hir](https://github.com/rust-lang/rust/blob/8064a495086c2e63c0ef77e8e82fe3b9b5dc535f/compiler/rustc_monomorphize/src/collector.rs#L917-L927)?\n- [x] ~What placeholder do you use in the fluent template to refer to the value in a vector? It seems like [this code](https://github.com/rust-lang/rust/blob/0b79f758c9aa6646606662a6d623a0752286cd17/compiler/rustc_macros/src/diagnostics/diagnostic_builder.rs#L83-L114) ought to have the answer (or something near it)...but I can't figure it out.~ You can't. Punted.", "tree": {"sha": "baa1ce023c3f6aaa65ddce30c577ca1c597dde56", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/baa1ce023c3f6aaa65ddce30c577ca1c597dde56"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d60e93035f155e02d1b12b5bab13ebfb4d908891", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d60e93035f155e02d1b12b5bab13ebfb4d908891", "html_url": "https://github.com/rust-lang/rust/commit/d60e93035f155e02d1b12b5bab13ebfb4d908891", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d60e93035f155e02d1b12b5bab13ebfb4d908891/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5e494b424380fdf8d38c3887e1ba7343123ad30e", "url": "https://api.github.com/repos/rust-lang/rust/commits/5e494b424380fdf8d38c3887e1ba7343123ad30e", "html_url": "https://github.com/rust-lang/rust/commit/5e494b424380fdf8d38c3887e1ba7343123ad30e"}, {"sha": "8c93170965d026962b59052ee579dd436883d195", "url": "https://api.github.com/repos/rust-lang/rust/commits/8c93170965d026962b59052ee579dd436883d195", "html_url": "https://github.com/rust-lang/rust/commit/8c93170965d026962b59052ee579dd436883d195"}], "stats": {"total": 7, "additions": 5, "deletions": 2}, "files": [{"sha": "c412e451a033e9619f2630e5362b5e0c12b4e08c", "filename": "src/base.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/d60e93035f155e02d1b12b5bab13ebfb4d908891/src%2Fbase.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d60e93035f155e02d1b12b5bab13ebfb4d908891/src%2Fbase.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbase.rs?ref=d60e93035f155e02d1b12b5bab13ebfb4d908891", "patch": "@@ -925,8 +925,11 @@ pub(crate) fn codegen_panic_inner<'tcx>(\n     args: &[Value],\n     span: Span,\n ) {\n-    let def_id =\n-        fx.tcx.lang_items().require(lang_item).unwrap_or_else(|s| fx.tcx.sess.span_fatal(span, &s));\n+    let def_id = fx\n+        .tcx\n+        .lang_items()\n+        .require(lang_item)\n+        .unwrap_or_else(|e| fx.tcx.sess.span_fatal(span, e.to_string()));\n \n     let instance = Instance::mono(fx.tcx, def_id).polymorphize(fx.tcx);\n     let symbol_name = fx.tcx.symbol_name(instance).name;"}]}