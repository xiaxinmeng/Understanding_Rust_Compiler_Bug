{"sha": "422574400f3f640e7d3623b1647f50b9d3035552", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQyMjU3NDQwMGYzZjY0MGU3ZDM2MjNiMTY0N2Y1MGI5ZDMwMzU1NTI=", "commit": {"author": {"name": "Steve Klabnik", "email": "steve@steveklabnik.com", "date": "2016-06-07T14:43:56Z"}, "committer": {"name": "Steve Klabnik", "email": "steve@steveklabnik.com", "date": "2016-06-07T14:43:56Z"}, "message": "Rollup merge of #34007 - flo-l:improve-hacking-docs, r=alexcrichton\n\nadd documentation on howto build just rustc without libstd to the build system\n\nI searched for days until I found this, maybe this helps other poor souls :joy:\n\nfor reference #33990", "tree": {"sha": "2de2310691444e411ee9786c08499c158b915c78", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2de2310691444e411ee9786c08499c158b915c78"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/422574400f3f640e7d3623b1647f50b9d3035552", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/422574400f3f640e7d3623b1647f50b9d3035552", "html_url": "https://github.com/rust-lang/rust/commit/422574400f3f640e7d3623b1647f50b9d3035552", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/422574400f3f640e7d3623b1647f50b9d3035552/comments", "author": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "committer": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0c42fa6ec01a49c875ae097f06f16d37af38cd9f", "url": "https://api.github.com/repos/rust-lang/rust/commits/0c42fa6ec01a49c875ae097f06f16d37af38cd9f", "html_url": "https://github.com/rust-lang/rust/commit/0c42fa6ec01a49c875ae097f06f16d37af38cd9f"}, {"sha": "4e8798651419eef3df28750b22f1c6f17971e936", "url": "https://api.github.com/repos/rust-lang/rust/commits/4e8798651419eef3df28750b22f1c6f17971e936", "html_url": "https://github.com/rust-lang/rust/commit/4e8798651419eef3df28750b22f1c6f17971e936"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "60935770781817a63c3ea9b6a19260ee33118b54", "filename": "CONTRIBUTING.md", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/422574400f3f640e7d3623b1647f50b9d3035552/CONTRIBUTING.md", "raw_url": "https://github.com/rust-lang/rust/raw/422574400f3f640e7d3623b1647f50b9d3035552/CONTRIBUTING.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/CONTRIBUTING.md?ref=422574400f3f640e7d3623b1647f50b9d3035552", "patch": "@@ -108,7 +108,8 @@ root.\n There are large number of options accepted by this script to alter the\n configuration used later in the build process. Some options to note:\n \n-- `--enable-debug` - Build a debug version of the compiler (disables optimizations)\n+- `--enable-debug` - Build a debug version of the compiler (disables optimizations,\n+    which speeds up compilation of stage1 rustc)\n - `--enable-optimize` - Enable optimizations (can be used with `--enable-debug`\n     to make a debug build with optimizations)\n - `--disable-valgrind-rpass` - Don't run tests with valgrind\n@@ -128,6 +129,12 @@ Some common make targets are:\n   cases we don't need to build the stage2 compiler, so we can save time by not\n   building it. The stage1 compiler is a fully functioning compiler and\n   (probably) will be enough to determine if your change works as expected.\n+- `make $host/stage1/bin/rustc` - Where $host is a target triple like x86_64-unknown-linux-gnu.\n+  This will build just rustc, without libstd. This is the fastest way to recompile after\n+  you changed only rustc source code. Note however that the resulting rustc binary\n+  won't have a stdlib to link against by default. You can build libstd once with\n+  `make rustc-stage1`, rustc will pick it up afterwards. libstd is only guaranteed to\n+  work if recompiled, so if there are any issues recompile it.\n - `make check` - build the full compiler & run all tests (takes a while). This\n   is what gets run by the continuous integration system against your pull\n   request. You should run this before submitting to make sure your tests pass"}, {"sha": "179ae1138d80bd9734b751c713c3ec0a80d26f38", "filename": "Makefile.in", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/422574400f3f640e7d3623b1647f50b9d3035552/Makefile.in", "raw_url": "https://github.com/rust-lang/rust/raw/422574400f3f640e7d3623b1647f50b9d3035552/Makefile.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Makefile.in?ref=422574400f3f640e7d3623b1647f50b9d3035552", "patch": "@@ -62,6 +62,8 @@\n #   * tidy - Basic style check, show highest rustc error code and\n #     the status of language and lib features\n #   * rustc-stage$(stage) - Only build up to a specific stage\n+#   * $host/stage1/bin/rustc - Only build stage1 rustc, not libstd. For further\n+#     information see \"Rust recipes for build system success\" below.\n #\n # Then mix in some of these environment variables to harness the\n # ultimate power of The Rust Build System.\n@@ -93,6 +95,15 @@\n #     // Modifying libstd? Use this command to run unit tests just on your change\n #     make check-stage1-std NO_REBUILD=1 NO_BENCH=1\n #\n+#     // Modifying just rustc?\n+#     // Compile rustc+libstd once\n+#     make rustc-stage1\n+#     // From now on use this command to rebuild just rustc and reuse the previously built libstd\n+#     // $host is a target triple, eg. x86_64-unknown-linux-gnu\n+#     // The resulting binary is located at $host/stage1/bin/rustc.\n+#     // If there are any issues with libstd recompile it with the command above.\n+#     make $host/stage1/bin/rustc\n+#\n #     // Added a run-pass test? Use this to test running your test\n #     make check-stage1-rpass TESTNAME=my-shiny-new-test\n #"}]}