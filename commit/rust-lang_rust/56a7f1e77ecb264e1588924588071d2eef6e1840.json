{"sha": "56a7f1e77ecb264e1588924588071d2eef6e1840", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU2YTdmMWU3N2VjYjI2NGUxNTg4OTI0NTg4MDcxZDJlZWY2ZTE4NDA=", "commit": {"author": {"name": "Niels Sascha Reedijk", "email": "niels.reedijk@gmail.com", "date": "2019-01-27T08:25:25Z"}, "committer": {"name": "Niels Sascha Reedijk", "email": "niels.reedijk@gmail.com", "date": "2019-06-10T06:10:06Z"}, "message": "Haiku: the maximum stack size is 16 MB\n\nWhen one tries to create a thread with a requested stack size larger\nthan 16 MB, the call will fail and the compiler will bail out. Therefore\nwe should limit the size of the thread stack to 16 MB on Haiku.", "tree": {"sha": "2936179610811287fdb88f34eb1917b253859945", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2936179610811287fdb88f34eb1917b253859945"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/56a7f1e77ecb264e1588924588071d2eef6e1840", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/56a7f1e77ecb264e1588924588071d2eef6e1840", "html_url": "https://github.com/rust-lang/rust/commit/56a7f1e77ecb264e1588924588071d2eef6e1840", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/56a7f1e77ecb264e1588924588071d2eef6e1840/comments", "author": {"login": "nielx", "id": 324054, "node_id": "MDQ6VXNlcjMyNDA1NA==", "avatar_url": "https://avatars.githubusercontent.com/u/324054?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nielx", "html_url": "https://github.com/nielx", "followers_url": "https://api.github.com/users/nielx/followers", "following_url": "https://api.github.com/users/nielx/following{/other_user}", "gists_url": "https://api.github.com/users/nielx/gists{/gist_id}", "starred_url": "https://api.github.com/users/nielx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nielx/subscriptions", "organizations_url": "https://api.github.com/users/nielx/orgs", "repos_url": "https://api.github.com/users/nielx/repos", "events_url": "https://api.github.com/users/nielx/events{/privacy}", "received_events_url": "https://api.github.com/users/nielx/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nielx", "id": 324054, "node_id": "MDQ6VXNlcjMyNDA1NA==", "avatar_url": "https://avatars.githubusercontent.com/u/324054?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nielx", "html_url": "https://github.com/nielx", "followers_url": "https://api.github.com/users/nielx/followers", "following_url": "https://api.github.com/users/nielx/following{/other_user}", "gists_url": "https://api.github.com/users/nielx/gists{/gist_id}", "starred_url": "https://api.github.com/users/nielx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nielx/subscriptions", "organizations_url": "https://api.github.com/users/nielx/orgs", "repos_url": "https://api.github.com/users/nielx/repos", "events_url": "https://api.github.com/users/nielx/events{/privacy}", "received_events_url": "https://api.github.com/users/nielx/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "57e13e0325c1d41161a31de1f8520538ec2c575c", "url": "https://api.github.com/repos/rust-lang/rust/commits/57e13e0325c1d41161a31de1f8520538ec2c575c", "html_url": "https://github.com/rust-lang/rust/commit/57e13e0325c1d41161a31de1f8520538ec2c575c"}], "stats": {"total": 8, "additions": 6, "deletions": 2}, "files": [{"sha": "a86d3cc43948d50a4a6865ad9e009559206f4ac0", "filename": "src/librustc_interface/util.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/56a7f1e77ecb264e1588924588071d2eef6e1840/src%2Flibrustc_interface%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/56a7f1e77ecb264e1588924588071d2eef6e1840/src%2Flibrustc_interface%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2Futil.rs?ref=56a7f1e77ecb264e1588924588071d2eef6e1840", "patch": "@@ -121,9 +121,13 @@ pub fn create_session(\n }\n \n // Temporarily have stack size set to 32MB to deal with various crates with long method\n-// chains or deep syntax trees.\n+// chains or deep syntax trees, except when on Haiku.\n // FIXME(oli-obk): get https://github.com/rust-lang/rust/pull/55617 the finish line\n-const STACK_SIZE: usize = 32 * 1024 * 1024; // 32MB\n+#[cfg(not(target_os = \"haiku\"))]\n+const STACK_SIZE: usize = 32 * 1024 * 1024;\n+\n+#[cfg(target_os = \"haiku\")]\n+const STACK_SIZE: usize = 16 * 1024 * 1024;\n \n fn get_stack_size() -> Option<usize> {\n     // FIXME: Hacks on hacks. If the env is trying to override the stack size"}]}