{"sha": "7e932db3689076b2fe99c625e25d4f9b3f03a538", "node_id": "C_kwDOAAsO6NoAKDdlOTMyZGIzNjg5MDc2YjJmZTk5YzYyNWUyNWQ0ZjliM2YwM2E1Mzg", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2023-03-08T16:47:34Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2023-03-08T19:07:56Z"}, "message": "Improve rustdoc-gui/tester.js code a bit", "tree": {"sha": "f791022faa77981144594abc641114df0da30b19", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f791022faa77981144594abc641114df0da30b19"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7e932db3689076b2fe99c625e25d4f9b3f03a538", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7e932db3689076b2fe99c625e25d4f9b3f03a538", "html_url": "https://github.com/rust-lang/rust/commit/7e932db3689076b2fe99c625e25d4f9b3f03a538", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7e932db3689076b2fe99c625e25d4f9b3f03a538/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8c0f83d773370150a6ea1b40b36b55566e40a73c", "url": "https://api.github.com/repos/rust-lang/rust/commits/8c0f83d773370150a6ea1b40b36b55566e40a73c", "html_url": "https://github.com/rust-lang/rust/commit/8c0f83d773370150a6ea1b40b36b55566e40a73c"}], "stats": {"total": 48, "additions": 25, "deletions": 23}, "files": [{"sha": "80bfd38d1e961aa4dd70aa0b683d12891081cec6", "filename": "src/tools/rustdoc-gui/tester.js", "status": "modified", "additions": 25, "deletions": 23, "changes": 48, "blob_url": "https://github.com/rust-lang/rust/blob/7e932db3689076b2fe99c625e25d4f9b3f03a538/src%2Ftools%2Frustdoc-gui%2Ftester.js", "raw_url": "https://github.com/rust-lang/rust/raw/7e932db3689076b2fe99c625e25d4f9b3f03a538/src%2Ftools%2Frustdoc-gui%2Ftester.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustdoc-gui%2Ftester.js?ref=7e932db3689076b2fe99c625e25d4f9b3f03a538", "patch": "@@ -31,7 +31,7 @@ function isNumeric(s) {\n }\n \n function parseOptions(args) {\n-    var opts = {\n+    const opts = {\n         \"doc_folder\": \"\",\n         \"tests_folder\": \"\",\n         \"files\": [],\n@@ -42,7 +42,7 @@ function parseOptions(args) {\n         \"executable_path\": null,\n         \"no_sandbox\": false,\n     };\n-    var correspondances = {\n+    const correspondances = {\n         \"--doc-folder\": \"doc_folder\",\n         \"--tests-folder\": \"tests_folder\",\n         \"--debug\": \"debug\",\n@@ -52,39 +52,41 @@ function parseOptions(args) {\n         \"--no-sandbox\": \"no_sandbox\",\n     };\n \n-    for (var i = 0; i < args.length; ++i) {\n-        if (args[i] === \"--doc-folder\"\n-            || args[i] === \"--tests-folder\"\n-            || args[i] === \"--file\"\n-            || args[i] === \"--jobs\"\n-            || args[i] === \"--executable-path\") {\n+    for (let i = 0; i < args.length; ++i) {\n+        const arg = args[i];\n+        if (arg === \"--doc-folder\"\n+            || arg === \"--tests-folder\"\n+            || arg === \"--file\"\n+            || arg === \"--jobs\"\n+            || arg === \"--executable-path\") {\n             i += 1;\n             if (i >= args.length) {\n-                console.log(\"Missing argument after `\" + args[i - 1] + \"` option.\");\n+                console.log(\"Missing argument after `\" + arg + \"` option.\");\n                 return null;\n             }\n-            if (args[i - 1] === \"--jobs\") {\n-                if (!isNumeric(args[i])) {\n+            const arg_value = args[i];\n+            if (arg === \"--jobs\") {\n+                if (!isNumeric(arg_value)) {\n                     console.log(\n-                        \"`--jobs` option expects a positive number, found `\" + args[i] + \"`\");\n+                        \"`--jobs` option expects a positive number, found `\" + arg_value + \"`\");\n                     return null;\n                 }\n-                opts[\"jobs\"] = parseInt(args[i]);\n-            } else if (args[i - 1] !== \"--file\") {\n-                opts[correspondances[args[i - 1]]] = args[i];\n+                opts[\"jobs\"] = parseInt(arg_value);\n+            } else if (arg !== \"--file\") {\n+                opts[correspondances[arg]] = arg_value;\n             } else {\n-                opts[\"files\"].push(args[i]);\n+                opts[\"files\"].push(arg_value);\n             }\n-        } else if (args[i] === \"--help\") {\n+        } else if (arg === \"--help\") {\n             showHelp();\n             process.exit(0);\n-        } else if (args[i] === \"--no-sandbox\") {\n+        } else if (arg === \"--no-sandbox\") {\n             console.log(\"`--no-sandbox` is being used. Be very careful!\");\n-            opts[correspondances[args[i]]] = true;\n-        } else if (correspondances[args[i]]) {\n-            opts[correspondances[args[i]]] = true;\n+            opts[correspondances[arg]] = true;\n+        } else if (correspondances[arg]) {\n+            opts[correspondances[arg]] = true;\n         } else {\n-            console.log(\"Unknown option `\" + args[i] + \"`.\");\n+            console.log(\"Unknown option `\" + arg + \"`.\");\n             console.log(\"Use `--help` to see the list of options\");\n             return null;\n         }\n@@ -186,7 +188,7 @@ function createEmptyResults() {\n }\n \n async function main(argv) {\n-    let opts = parseOptions(argv.slice(2));\n+    const opts = parseOptions(argv.slice(2));\n     if (opts === null) {\n         process.exit(1);\n     }"}]}