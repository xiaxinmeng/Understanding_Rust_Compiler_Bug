{"sha": "791e7bcb418381480bf10cb87ef5da769be7143f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc5MWU3YmNiNDE4MzgxNDgwYmYxMGNiODdlZjVkYTc2OWJlNzE0M2Y=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-09-04T05:15:22Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-09-04T05:15:22Z"}, "message": "Auto merge of #28170 - nagisa:loopctl-label-spans, r=alexcrichton\n\nr? @alexcrichton", "tree": {"sha": "fdb330304834cc452e1928359b6bff54849af28c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fdb330304834cc452e1928359b6bff54849af28c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/791e7bcb418381480bf10cb87ef5da769be7143f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/791e7bcb418381480bf10cb87ef5da769be7143f", "html_url": "https://github.com/rust-lang/rust/commit/791e7bcb418381480bf10cb87ef5da769be7143f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/791e7bcb418381480bf10cb87ef5da769be7143f/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "35b14544e1f5dfdbae169eafe34c393c47d7c1ad", "url": "https://api.github.com/repos/rust-lang/rust/commits/35b14544e1f5dfdbae169eafe34c393c47d7c1ad", "html_url": "https://github.com/rust-lang/rust/commit/35b14544e1f5dfdbae169eafe34c393c47d7c1ad"}, {"sha": "c493084ec1b35b7ab59aa0878354bca10a610360", "url": "https://api.github.com/repos/rust-lang/rust/commits/c493084ec1b35b7ab59aa0878354bca10a610360", "html_url": "https://github.com/rust-lang/rust/commit/c493084ec1b35b7ab59aa0878354bca10a610360"}], "stats": {"total": 116, "additions": 73, "deletions": 43}, "files": [{"sha": "3f6385ad82cc4f9d0c845a934d3c2cc1cf866cd8", "filename": "src/librustc/middle/cfg/construct.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc%2Fmiddle%2Fcfg%2Fconstruct.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc%2Fmiddle%2Fcfg%2Fconstruct.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fcfg%2Fconstruct.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -284,15 +284,15 @@ impl<'a, 'tcx> CFGBuilder<'a, 'tcx> {\n             }\n \n             hir::ExprBreak(label) => {\n-                let loop_scope = self.find_scope(expr, label);\n+                let loop_scope = self.find_scope(expr, label.map(|l| l.node));\n                 let b = self.add_ast_node(expr.id, &[pred]);\n                 self.add_exiting_edge(expr, b,\n                                       loop_scope, loop_scope.break_index);\n                 self.add_unreachable_node()\n             }\n \n             hir::ExprAgain(label) => {\n-                let loop_scope = self.find_scope(expr, label);\n+                let loop_scope = self.find_scope(expr, label.map(|l| l.node));\n                 let a = self.add_ast_node(expr.id, &[pred]);\n                 self.add_exiting_edge(expr, a,\n                                       loop_scope, loop_scope.continue_index);"}, {"sha": "561760b29f19ea0d5e0d8e8b8519b5e0811e904e", "filename": "src/librustc/middle/liveness.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc%2Fmiddle%2Fliveness.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc%2Fmiddle%2Fliveness.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fliveness.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -1049,7 +1049,7 @@ impl<'a, 'tcx> Liveness<'a, 'tcx> {\n \n           hir::ExprBreak(opt_label) => {\n               // Find which label this break jumps to\n-              let sc = self.find_loop_scope(opt_label, expr.id, expr.span);\n+              let sc = self.find_loop_scope(opt_label.map(|l| l.node), expr.id, expr.span);\n \n               // Now that we know the label we're going to,\n               // look it up in the break loop nodes table\n@@ -1063,7 +1063,7 @@ impl<'a, 'tcx> Liveness<'a, 'tcx> {\n \n           hir::ExprAgain(opt_label) => {\n               // Find which label this expr continues to\n-              let sc = self.find_loop_scope(opt_label, expr.id, expr.span);\n+              let sc = self.find_loop_scope(opt_label.map(|l| l.node), expr.id, expr.span);\n \n               // Now that we know the label we're going to,\n               // look it up in the continue loop nodes table"}, {"sha": "5f6bf939fb2a8ec0103e0ec13b202d091ff12f5a", "filename": "src/librustc_back/svh.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc_back%2Fsvh.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc_back%2Fsvh.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Fsvh.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -277,8 +277,8 @@ mod svh_visitor {\n             ExprRange(..)            => SawExprRange,\n             ExprPath(ref qself, _)   => SawExprPath(qself.as_ref().map(|q| q.position)),\n             ExprAddrOf(m, _)         => SawExprAddrOf(m),\n-            ExprBreak(id)            => SawExprBreak(id.map(|id| id.name.as_str())),\n-            ExprAgain(id)            => SawExprAgain(id.map(|id| id.name.as_str())),\n+            ExprBreak(id)            => SawExprBreak(id.map(|id| id.node.name.as_str())),\n+            ExprAgain(id)            => SawExprAgain(id.map(|id| id.node.name.as_str())),\n             ExprRet(..)              => SawExprRet,\n             ExprInlineAsm(ref asm)   => SawExprInlineAsm(asm),\n             ExprStruct(..)           => SawExprStruct,"}, {"sha": "ba20b46090afc9aa9e357d15a517cfdd13fafb87", "filename": "src/librustc_front/fold.rs", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc_front%2Ffold.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc_front%2Ffold.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_front%2Ffold.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -1124,8 +1124,14 @@ pub fn noop_fold_expr<T: Folder>(Expr {id, node, span}: Expr, folder: &mut T) ->\n                 });\n                 ExprPath(qself, folder.fold_path(path))\n             }\n-            ExprBreak(opt_ident) => ExprBreak(opt_ident.map(|x| folder.fold_ident(x))),\n-            ExprAgain(opt_ident) => ExprAgain(opt_ident.map(|x| folder.fold_ident(x))),\n+            ExprBreak(opt_ident) => ExprBreak(opt_ident.map(|label|\n+                respan(folder.new_span(label.span),\n+                       folder.fold_ident(label.node)))\n+            ),\n+            ExprAgain(opt_ident) => ExprAgain(opt_ident.map(|label|\n+                respan(folder.new_span(label.span),\n+                       folder.fold_ident(label.node)))\n+            ),\n             ExprRet(e) => ExprRet(e.map(|x| folder.fold_expr(x))),\n             ExprInlineAsm(InlineAsm {\n                 inputs,"}, {"sha": "f8f17617310b7b4ef2beef790a21fa224cb66a33", "filename": "src/librustc_front/hir.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc_front%2Fhir.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc_front%2Fhir.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_front%2Fhir.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -730,9 +730,9 @@ pub enum Expr_ {\n     /// A referencing operation (`&a` or `&mut a`)\n     ExprAddrOf(Mutability, P<Expr>),\n     /// A `break`, with an optional label to break\n-    ExprBreak(Option<Ident>),\n+    ExprBreak(Option<SpannedIdent>),\n     /// A `continue`, with an optional label\n-    ExprAgain(Option<Ident>),\n+    ExprAgain(Option<SpannedIdent>),\n     /// A `return`, with an optional value to be returned\n     ExprRet(Option<P<Expr>>),\n "}, {"sha": "a1382b467fb876fc1545d531b5e0dc71a95497eb", "filename": "src/librustc_front/print/pprust.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc_front%2Fprint%2Fpprust.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc_front%2Fprint%2Fpprust.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_front%2Fprint%2Fpprust.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -1587,15 +1587,15 @@ impl<'a> State<'a> {\n                 try!(word(&mut self.s, \"break\"));\n                 try!(space(&mut self.s));\n                 if let Some(ident) = opt_ident {\n-                    try!(self.print_ident(ident));\n+                    try!(self.print_ident(ident.node));\n                     try!(space(&mut self.s));\n                 }\n             }\n             hir::ExprAgain(opt_ident) => {\n                 try!(word(&mut self.s, \"continue\"));\n                 try!(space(&mut self.s));\n                 if let Some(ident) = opt_ident {\n-                    try!(self.print_ident(ident));\n+                    try!(self.print_ident(ident.node));\n                     try!(space(&mut self.s))\n                 }\n             }"}, {"sha": "da9bae62d047dccd537045e672118725f5667741", "filename": "src/librustc_resolve/lib.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc_resolve%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc_resolve%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Flib.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -3759,12 +3759,12 @@ impl<'a, 'tcx> Resolver<'a, 'tcx> {\n             }\n \n             ExprBreak(Some(label)) | ExprAgain(Some(label)) => {\n-                let renamed = mtwt::resolve(label);\n+                let renamed = mtwt::resolve(label.node);\n                 match self.search_label(renamed) {\n                     None => {\n                         resolve_error(self,\n-                                      expr.span,\n-                                      ResolutionError::UndeclaredLabel(&label.name.as_str()))\n+                                      label.span,\n+                                      ResolutionError::UndeclaredLabel(&label.node.name.as_str()))\n                     }\n                     Some(DlDef(def @ DefLabel(_))) => {\n                         // Since this def is a label, it is never read."}, {"sha": "83644beae22d2e48debfe817a3398600595ccb93", "filename": "src/librustc_trans/trans/expr.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc_trans%2Ftrans%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibrustc_trans%2Ftrans%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Ftrans%2Fexpr.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -937,10 +937,10 @@ fn trans_rvalue_stmt_unadjusted<'blk, 'tcx>(bcx: Block<'blk, 'tcx>,\n             trans_into(bcx, &**e, Ignore)\n         }\n         hir::ExprBreak(label_opt) => {\n-            controlflow::trans_break(bcx, expr, label_opt)\n+            controlflow::trans_break(bcx, expr, label_opt.map(|l| l.node))\n         }\n         hir::ExprAgain(label_opt) => {\n-            controlflow::trans_cont(bcx, expr, label_opt)\n+            controlflow::trans_cont(bcx, expr, label_opt.map(|l| l.node))\n         }\n         hir::ExprRet(ref ex) => {\n             // Check to see if the return expression itself is reachable."}, {"sha": "bf8c67c7ae1815632e3556d0129191b15fa3dca7", "filename": "src/libsyntax/ast.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibsyntax%2Fast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibsyntax%2Fast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fast.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -891,9 +891,9 @@ pub enum Expr_ {\n     /// A referencing operation (`&a` or `&mut a`)\n     ExprAddrOf(Mutability, P<Expr>),\n     /// A `break`, with an optional label to break\n-    ExprBreak(Option<Ident>),\n+    ExprBreak(Option<SpannedIdent>),\n     /// A `continue`, with an optional label\n-    ExprAgain(Option<Ident>),\n+    ExprAgain(Option<SpannedIdent>),\n     /// A `return`, with an optional value to be returned\n     ExprRet(Option<P<Expr>>),\n "}, {"sha": "0cfddc9857c67199d13afd9d739d99bd9e78ce8a", "filename": "src/libsyntax/fold.rs", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibsyntax%2Ffold.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibsyntax%2Ffold.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ffold.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -1299,8 +1299,14 @@ pub fn noop_fold_expr<T: Folder>(Expr {id, node, span}: Expr, folder: &mut T) ->\n                 });\n                 ExprPath(qself, folder.fold_path(path))\n             }\n-            ExprBreak(opt_ident) => ExprBreak(opt_ident.map(|x| folder.fold_ident(x))),\n-            ExprAgain(opt_ident) => ExprAgain(opt_ident.map(|x| folder.fold_ident(x))),\n+            ExprBreak(opt_ident) => ExprBreak(opt_ident.map(|label|\n+                respan(folder.new_span(label.span),\n+                       folder.fold_ident(label.node)))\n+            ),\n+            ExprAgain(opt_ident) => ExprAgain(opt_ident.map(|label|\n+                respan(folder.new_span(label.span),\n+                       folder.fold_ident(label.node)))\n+            ),\n             ExprRet(e) => ExprRet(e.map(|x| folder.fold_expr(x))),\n             ExprInlineAsm(InlineAsm {\n                 inputs,"}, {"sha": "5017d079480378b729ad1c8d153c7d98bd0b34b3", "filename": "src/libsyntax/parse/parser.rs", "status": "modified", "additions": 9, "deletions": 6, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibsyntax%2Fparse%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibsyntax%2Fparse%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Fparser.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -2143,9 +2143,12 @@ impl<'a> Parser<'a> {\n                 }\n                 if try!(self.eat_keyword(keywords::Continue) ){\n                     let ex = if self.token.is_lifetime() {\n-                        let lifetime = self.get_lifetime();\n+                        let ex = ExprAgain(Some(Spanned{\n+                            node: self.get_lifetime(),\n+                            span: self.span\n+                        }));\n                         try!(self.bump());\n-                        ExprAgain(Some(lifetime))\n+                        ex\n                     } else {\n                         ExprAgain(None)\n                     };\n@@ -2161,7 +2164,6 @@ impl<'a> Parser<'a> {\n                         UnsafeBlock(ast::UserProvided));\n                 }\n                 if try!(self.eat_keyword(keywords::Return) ){\n-                    // RETURN expression\n                     if self.token.can_begin_expr() {\n                         let e = try!(self.parse_expr_nopanic());\n                         hi = e.span.hi;\n@@ -2170,11 +2172,12 @@ impl<'a> Parser<'a> {\n                         ex = ExprRet(None);\n                     }\n                 } else if try!(self.eat_keyword(keywords::Break) ){\n-                    // BREAK expression\n                     if self.token.is_lifetime() {\n-                        let lifetime = self.get_lifetime();\n+                        ex = ExprBreak(Some(Spanned {\n+                            node: self.get_lifetime(),\n+                            span: self.span\n+                        }));\n                         try!(self.bump());\n-                        ex = ExprBreak(Some(lifetime));\n                     } else {\n                         ex = ExprBreak(None);\n                     }"}, {"sha": "555fdc1ff864759a62e01f9790d08a2d79227d7d", "filename": "src/libsyntax/print/pprust.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibsyntax%2Fprint%2Fpprust.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Flibsyntax%2Fprint%2Fpprust.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fprint%2Fpprust.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -1911,15 +1911,15 @@ impl<'a> State<'a> {\n                 try!(word(&mut self.s, \"break\"));\n                 try!(space(&mut self.s));\n                 if let Some(ident) = opt_ident {\n-                    try!(self.print_ident(ident));\n+                    try!(self.print_ident(ident.node));\n                     try!(space(&mut self.s));\n                 }\n             }\n             ast::ExprAgain(opt_ident) => {\n                 try!(word(&mut self.s, \"continue\"));\n                 try!(space(&mut self.s));\n                 if let Some(ident) = opt_ident {\n-                    try!(self.print_ident(ident));\n+                    try!(self.print_ident(ident.node));\n                     try!(space(&mut self.s))\n                 }\n             }"}, {"sha": "305b43402da0b9bc1a51c29c68d77b773a7935b7", "filename": "src/test/compile-fail/hygienic-label-1.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Ftest%2Fcompile-fail%2Fhygienic-label-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Ftest%2Fcompile-fail%2Fhygienic-label-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fhygienic-label-1.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -9,9 +9,9 @@\n // except according to those terms.\n \n macro_rules! foo {\n-    () => { break 'x; }\n+    () => { break 'x; } //~ ERROR use of undeclared label `'x`\n }\n \n pub fn main() {\n-    'x: loop { foo!() } //~ ERROR use of undeclared label `'x`\n+    'x: loop { foo!() }\n }"}, {"sha": "b107b71024dad21de160a6eb21fe51b795ef36f8", "filename": "src/test/compile-fail/hygienic-label-3.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Ftest%2Fcompile-fail%2Fhygienic-label-3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Ftest%2Fcompile-fail%2Fhygienic-label-3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fhygienic-label-3.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -9,11 +9,11 @@\n // except according to those terms.\n \n macro_rules! foo {\n-    () => { break 'x; }\n+    () => { break 'x; } //~ ERROR use of undeclared label `'x`\n }\n \n pub fn main() {\n     'x: for _ in 0..1 {\n-        foo!() //~ ERROR use of undeclared label `'x`\n+        foo!()\n     };\n }"}, {"sha": "8e58d1aaf240d35e52efa8a0e445c3d4dc43b347", "filename": "src/test/compile-fail/issue-28105.rs", "status": "modified", "additions": 5, "deletions": 10, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Ftest%2Fcompile-fail%2Fissue-28105.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Ftest%2Fcompile-fail%2Fissue-28105.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-28105.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -1,4 +1,4 @@\n-// Copyright 2012-2014 The Rust Project Developers. See the COPYRIGHT\n+// Copyright 2012-2015 The Rust Project Developers. See the COPYRIGHT\n // file at the top-level directory of this distribution and at\n // http://rust-lang.org/COPYRIGHT.\n //\n@@ -11,13 +11,8 @@\n // Make sure that a continue span actually contains the keyword.\n \n fn main() {\n-    'a: loop {\n-        if false {\n-            continue //~ ERROR use of undeclared label\n-            'b;\n-        } else {\n-            break //~ ERROR use of undeclared label\n-            'c;\n-        }\n-    }\n+    continue //~ ERROR `continue` outside of loop\n+    ;\n+    break //~ ERROR `break` outside of loop\n+    ;\n }"}, {"sha": "73163caa455fc077bc5daf483f8b8dfc480ab054", "filename": "src/test/compile-fail/issue-28109.rs", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Ftest%2Fcompile-fail%2Fissue-28109.rs", "raw_url": "https://github.com/rust-lang/rust/raw/791e7bcb418381480bf10cb87ef5da769be7143f/src%2Ftest%2Fcompile-fail%2Fissue-28109.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-28109.rs?ref=791e7bcb418381480bf10cb87ef5da769be7143f", "patch": "@@ -0,0 +1,20 @@\n+// Copyright 2012-2015 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// Make sure that label for continue and break is spanned correctly\n+\n+fn main() {\n+    continue\n+    'b //~ ERROR use of undeclared label\n+    ;\n+    break\n+    'c //~ ERROR use of undeclared label\n+    ;\n+}"}]}