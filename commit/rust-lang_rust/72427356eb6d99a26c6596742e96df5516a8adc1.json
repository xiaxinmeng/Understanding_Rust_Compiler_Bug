{"sha": "72427356eb6d99a26c6596742e96df5516a8adc1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjcyNDI3MzU2ZWI2ZDk5YTI2YzY1OTY3NDJlOTZkZjU1MTZhOGFkYzE=", "commit": {"author": {"name": "Kamal Marhubi", "email": "kamal@marhubi.com", "date": "2016-04-10T22:29:25Z"}, "committer": {"name": "Kamal Marhubi", "email": "kamal@marhubi.com", "date": "2016-04-10T22:42:55Z"}, "message": "rustfmt: Simplify match in project file lookup loop\n\nThis commit changes the match in `lookup_project_file` to use pattern\nguards.", "tree": {"sha": "8a29692ab631b7017ec4545c0243fa0645bb7f3b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8a29692ab631b7017ec4545c0243fa0645bb7f3b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/72427356eb6d99a26c6596742e96df5516a8adc1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/72427356eb6d99a26c6596742e96df5516a8adc1", "html_url": "https://github.com/rust-lang/rust/commit/72427356eb6d99a26c6596742e96df5516a8adc1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/72427356eb6d99a26c6596742e96df5516a8adc1/comments", "author": {"login": "kamalmarhubi", "id": 50936, "node_id": "MDQ6VXNlcjUwOTM2", "avatar_url": "https://avatars.githubusercontent.com/u/50936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kamalmarhubi", "html_url": "https://github.com/kamalmarhubi", "followers_url": "https://api.github.com/users/kamalmarhubi/followers", "following_url": "https://api.github.com/users/kamalmarhubi/following{/other_user}", "gists_url": "https://api.github.com/users/kamalmarhubi/gists{/gist_id}", "starred_url": "https://api.github.com/users/kamalmarhubi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kamalmarhubi/subscriptions", "organizations_url": "https://api.github.com/users/kamalmarhubi/orgs", "repos_url": "https://api.github.com/users/kamalmarhubi/repos", "events_url": "https://api.github.com/users/kamalmarhubi/events{/privacy}", "received_events_url": "https://api.github.com/users/kamalmarhubi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kamalmarhubi", "id": 50936, "node_id": "MDQ6VXNlcjUwOTM2", "avatar_url": "https://avatars.githubusercontent.com/u/50936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kamalmarhubi", "html_url": "https://github.com/kamalmarhubi", "followers_url": "https://api.github.com/users/kamalmarhubi/followers", "following_url": "https://api.github.com/users/kamalmarhubi/following{/other_user}", "gists_url": "https://api.github.com/users/kamalmarhubi/gists{/gist_id}", "starred_url": "https://api.github.com/users/kamalmarhubi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kamalmarhubi/subscriptions", "organizations_url": "https://api.github.com/users/kamalmarhubi/orgs", "repos_url": "https://api.github.com/users/kamalmarhubi/repos", "events_url": "https://api.github.com/users/kamalmarhubi/events{/privacy}", "received_events_url": "https://api.github.com/users/kamalmarhubi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fe5fa874da6ce1691add81a46f9bfd0a28d39076", "url": "https://api.github.com/repos/rust-lang/rust/commits/fe5fa874da6ce1691add81a46f9bfd0a28d39076", "html_url": "https://github.com/rust-lang/rust/commit/fe5fa874da6ce1691add81a46f9bfd0a28d39076"}], "stats": {"total": 14, "additions": 6, "deletions": 8}, "files": [{"sha": "e2a2a4918480b9ded3483ef4753589218349cc69", "filename": "src/bin/rustfmt.rs", "status": "modified", "additions": 6, "deletions": 8, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/72427356eb6d99a26c6596742e96df5516a8adc1/src%2Fbin%2Frustfmt.rs", "raw_url": "https://github.com/rust-lang/rust/raw/72427356eb6d99a26c6596742e96df5516a8adc1/src%2Fbin%2Frustfmt.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbin%2Frustfmt.rs?ref=72427356eb6d99a26c6596742e96df5516a8adc1", "patch": "@@ -65,19 +65,17 @@ fn lookup_project_file(dir: &Path) -> FmtResult<Option<PathBuf>> {\n     loop {\n         let config_file = current.join(\"rustfmt.toml\");\n         match fs::metadata(&config_file) {\n-            Ok(md) => {\n-                // Properly handle unlikely situation of a directory named `rustfmt.toml`.\n-                if md.is_file() {\n-                    return Ok(Some(config_file));\n-                }\n-            }\n-            // If it's not found, we continue searching; otherwise something went wrong and we\n-            // return the error.\n+            // Only return if it's a file to handle the unlikely situation of a directory named\n+            // `rustfmt.toml`.\n+            Ok(ref md) if md.is_file() => return Ok(Some(config_file)),\n+            // Return the error if it's something other than `NotFound`; otherwise we didn't find\n+            // the project file yet, and continue searching.\n             Err(e) => {\n                 if e.kind() != ErrorKind::NotFound {\n                     return Err(FmtError::from(e));\n                 }\n             }\n+            _ => {}\n         }\n \n         // If the current directory has no parent, we're done searching."}]}