{"sha": "ea5c413427553507698a3358488199fcb00ca1ce", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVhNWM0MTM0Mjc1NTM1MDc2OThhMzM1ODQ4ODE5OWZjYjAwY2ExY2U=", "commit": {"author": {"name": "Huon Wilson", "email": "dbau.pp+github@gmail.com", "date": "2013-05-09T05:15:54Z"}, "committer": {"name": "Huon Wilson", "email": "dbau.pp+github@gmail.com", "date": "2013-05-09T05:15:54Z"}, "message": "Perform expansion before stripping/building a test harness.\n\nThis allows macros to create tests and benchmarks.", "tree": {"sha": "cdf167a5fa834054565680cebecc3f6c5690a3b1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cdf167a5fa834054565680cebecc3f6c5690a3b1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ea5c413427553507698a3358488199fcb00ca1ce", "comment_count": 4, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ea5c413427553507698a3358488199fcb00ca1ce", "html_url": "https://github.com/rust-lang/rust/commit/ea5c413427553507698a3358488199fcb00ca1ce", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ea5c413427553507698a3358488199fcb00ca1ce/comments", "author": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5a65f51d666855d7685850808cc06e49c3d21c72", "url": "https://api.github.com/repos/rust-lang/rust/commits/5a65f51d666855d7685850808cc06e49c3d21c72", "html_url": "https://github.com/rust-lang/rust/commit/5a65f51d666855d7685850808cc06e49c3d21c72"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "01a68255c3ea0b09a98fdffccc60149d00eb068a", "filename": "src/librustc/driver/driver.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/ea5c413427553507698a3358488199fcb00ca1ce/src%2Flibrustc%2Fdriver%2Fdriver.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ea5c413427553507698a3358488199fcb00ca1ce/src%2Flibrustc%2Fdriver%2Fdriver.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fdriver%2Fdriver.rs?ref=ea5c413427553507698a3358488199fcb00ca1ce", "patch": "@@ -183,16 +183,16 @@ pub fn compile_rest(sess: Session,\n     *sess.building_library = session::building_library(\n         sess.opts.crate_type, crate, sess.opts.test);\n \n+    crate = time(time_passes, ~\"expansion\", ||\n+        syntax::ext::expand::expand_crate(sess.parse_sess, copy cfg,\n+                                          crate));\n+\n     crate = time(time_passes, ~\"configuration\", ||\n         front::config::strip_unconfigured_items(crate));\n \n     crate = time(time_passes, ~\"maybe building test harness\", ||\n         front::test::modify_for_testing(sess, crate));\n \n-    crate = time(time_passes, ~\"expansion\", ||\n-        syntax::ext::expand::expand_crate(sess.parse_sess, copy cfg,\n-                                          crate));\n-\n     if upto == cu_expand { return (crate, None); }\n \n     crate = time(time_passes, ~\"intrinsic injection\", ||"}]}