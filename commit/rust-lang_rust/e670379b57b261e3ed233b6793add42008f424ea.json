{"sha": "e670379b57b261e3ed233b6793add42008f424ea", "node_id": "C_kwDOAAsO6NoAKGU2NzAzNzliNTdiMjYxZTNlZDIzM2I2NzkzYWRkNDIwMDhmNDI0ZWE", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-03-13T20:55:35Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-03-13T20:55:35Z"}, "message": "Rollup merge of #108419 - tgross35:atomic-as-ptr, r=m-ou-se\n\nStabilize `atomic_as_ptr`\n\nFixes #66893\n\nThis stabilizes the `as_ptr` methods for atomics. The stabilization feature gate used here is `atomic_as_ptr` which supersedes `atomic_mut_ptr` to match the change in https://github.com/rust-lang/rust/pull/107736.\n\nThis needs FCP.\n\nNew stable API:\n\n```rust\nimpl AtomicBool {\n    pub const fn as_ptr(&self) -> *mut bool;\n}\n\nimpl AtomicI32 {\n    pub const fn as_ptr(&self) -> *mut i32;\n}\n\n// Includes all other atomic types\n\nimpl<T> AtomicPtr<T> {\n    pub const fn as_ptr(&self) -> *mut *mut T;\n}\n```\n\nr? libs-api\n``@rustbot`` label +needs-fcp", "tree": {"sha": "0690dbe33fb70594aaefeb6579fb5b2ac4c1a317", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0690dbe33fb70594aaefeb6579fb5b2ac4c1a317"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e670379b57b261e3ed233b6793add42008f424ea", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkD43HCRBK7hj4Ov3rIwAAdQMIAC62vpdBL2CxRol+gDPpN9RE\nSAma1swgB/ztyV84tN6QYGYXqvIsZC6aZoTIhXO4+l320YaGIB4Oc9a4H5ldBupp\nGg/eTYrw4g4tmLcvtkTdlo554r5P2hUvVkiMjeEj+4tgWgLFphDjBs5T6eiktDVR\n+sR6cRohPGBNiANY1651druU3290FES/qC94jpRGltWNCzQFg4CAuOs6D58RyQdO\neFYXVNJQAB21oSvTm4RDxfZGN68mYYzA03ZGDWCZ4m1JscSiWUtn3nAIOiYGgjgI\nIlUVsA6rZSgxDzhOWmrH7OBJY92uUW08jTD7Q357eNkZ8RqaI7cPepCeLoszWkU=\n=JpEx\n-----END PGP SIGNATURE-----\n", "payload": "tree 0690dbe33fb70594aaefeb6579fb5b2ac4c1a317\nparent 8efa635b40ce6569e12f4988b7a9bcb7f3f0ed0c\nparent 318be2bee9259852bc95728269916a45f59fa5aa\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1678740935 +0100\ncommitter GitHub <noreply@github.com> 1678740935 +0100\n\nRollup merge of #108419 - tgross35:atomic-as-ptr, r=m-ou-se\n\nStabilize `atomic_as_ptr`\n\nFixes #66893\n\nThis stabilizes the `as_ptr` methods for atomics. The stabilization feature gate used here is `atomic_as_ptr` which supersedes `atomic_mut_ptr` to match the change in https://github.com/rust-lang/rust/pull/107736.\n\nThis needs FCP.\n\nNew stable API:\n\n```rust\nimpl AtomicBool {\n    pub const fn as_ptr(&self) -> *mut bool;\n}\n\nimpl AtomicI32 {\n    pub const fn as_ptr(&self) -> *mut i32;\n}\n\n// Includes all other atomic types\n\nimpl<T> AtomicPtr<T> {\n    pub const fn as_ptr(&self) -> *mut *mut T;\n}\n```\n\nr? libs-api\n``@rustbot`` label +needs-fcp\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e670379b57b261e3ed233b6793add42008f424ea", "html_url": "https://github.com/rust-lang/rust/commit/e670379b57b261e3ed233b6793add42008f424ea", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e670379b57b261e3ed233b6793add42008f424ea/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8efa635b40ce6569e12f4988b7a9bcb7f3f0ed0c", "url": "https://api.github.com/repos/rust-lang/rust/commits/8efa635b40ce6569e12f4988b7a9bcb7f3f0ed0c", "html_url": "https://github.com/rust-lang/rust/commit/8efa635b40ce6569e12f4988b7a9bcb7f3f0ed0c"}, {"sha": "318be2bee9259852bc95728269916a45f59fa5aa", "url": "https://api.github.com/repos/rust-lang/rust/commits/318be2bee9259852bc95728269916a45f59fa5aa", "html_url": "https://github.com/rust-lang/rust/commit/318be2bee9259852bc95728269916a45f59fa5aa"}], "stats": {"total": 14, "additions": 7, "deletions": 7}, "files": [{"sha": "123561873a668160c953697c2963e20b9c89767a", "filename": "library/core/src/sync/atomic.rs", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/e670379b57b261e3ed233b6793add42008f424ea/library%2Fcore%2Fsrc%2Fsync%2Fatomic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e670379b57b261e3ed233b6793add42008f424ea/library%2Fcore%2Fsrc%2Fsync%2Fatomic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fsync%2Fatomic.rs?ref=e670379b57b261e3ed233b6793add42008f424ea", "patch": "@@ -960,6 +960,7 @@ impl AtomicBool {\n     /// ```ignore (extern-declaration)\n     /// # fn main() {\n     /// use std::sync::atomic::AtomicBool;\n+    ///\n     /// extern \"C\" {\n     ///     fn my_atomic_op(arg: *mut bool);\n     /// }\n@@ -971,7 +972,8 @@ impl AtomicBool {\n     /// # }\n     /// ```\n     #[inline]\n-    #[unstable(feature = \"atomic_mut_ptr\", reason = \"recently added\", issue = \"66893\")]\n+    #[stable(feature = \"atomic_as_ptr\", since = \"CURRENT_RUSTC_VERSION\")]\n+    #[rustc_const_stable(feature = \"atomic_as_ptr\", since = \"CURRENT_RUSTC_VERSION\")]\n     pub const fn as_ptr(&self) -> *mut bool {\n         self.v.get().cast()\n     }\n@@ -1890,7 +1892,6 @@ impl<T> AtomicPtr<T> {\n     /// # Examples\n     ///\n     /// ```ignore (extern-declaration)\n-    /// #![feature(atomic_mut_ptr)]\n     /// use std::sync::atomic::AtomicPtr;\n     ///\n     /// extern \"C\" {\n@@ -1906,7 +1907,8 @@ impl<T> AtomicPtr<T> {\n     /// }\n     /// ```\n     #[inline]\n-    #[unstable(feature = \"atomic_mut_ptr\", reason = \"recently added\", issue = \"66893\")]\n+    #[stable(feature = \"atomic_as_ptr\", since = \"CURRENT_RUSTC_VERSION\")]\n+    #[rustc_const_stable(feature = \"atomic_as_ptr\", since = \"CURRENT_RUSTC_VERSION\")]\n     pub const fn as_ptr(&self) -> *mut *mut T {\n         self.p.get()\n     }\n@@ -2859,9 +2861,8 @@ macro_rules! atomic_int {\n             /// # }\n             /// ```\n             #[inline]\n-            #[unstable(feature = \"atomic_mut_ptr\",\n-                   reason = \"recently added\",\n-                   issue = \"66893\")]\n+            #[stable(feature = \"atomic_as_ptr\", since = \"CURRENT_RUSTC_VERSION\")]\n+            #[rustc_const_stable(feature = \"atomic_as_ptr\", since = \"CURRENT_RUSTC_VERSION\")]\n             pub const fn as_ptr(&self) -> *mut $int_type {\n                 self.v.get()\n             }"}, {"sha": "4e7b6080835002b6101811241b3ca69ae13f6a64", "filename": "library/std/src/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/e670379b57b261e3ed233b6793add42008f424ea/library%2Fstd%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e670379b57b261e3ed233b6793add42008f424ea/library%2Fstd%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Flib.rs?ref=e670379b57b261e3ed233b6793add42008f424ea", "patch": "@@ -274,7 +274,6 @@\n #![feature(utf8_chunks)]\n //\n // Library features (core):\n-#![feature(atomic_mut_ptr)]\n #![feature(char_internals)]\n #![feature(core_intrinsics)]\n #![feature(duration_constants)]"}]}