{"sha": "daca5a3711851db2a954646c6f7209be996144ff", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRhY2E1YTM3MTE4NTFkYjJhOTU0NjQ2YzZmNzIwOWJlOTk2MTQ0ZmY=", "commit": {"author": {"name": "Emil Lauridsen", "email": "mine809@gmail.com", "date": "2020-01-13T16:12:14Z"}, "committer": {"name": "Emil Lauridsen", "email": "mine809@gmail.com", "date": "2020-01-13T16:12:14Z"}, "message": "Defer cargo check until after workspace load", "tree": {"sha": "774c9f908b0fcb431a420e808596d85d6a4ba875", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/774c9f908b0fcb431a420e808596d85d6a4ba875"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/daca5a3711851db2a954646c6f7209be996144ff", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/daca5a3711851db2a954646c6f7209be996144ff", "html_url": "https://github.com/rust-lang/rust/commit/daca5a3711851db2a954646c6f7209be996144ff", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/daca5a3711851db2a954646c6f7209be996144ff/comments", "author": {"login": "kiljacken", "id": 209321, "node_id": "MDQ6VXNlcjIwOTMyMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/209321?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kiljacken", "html_url": "https://github.com/kiljacken", "followers_url": "https://api.github.com/users/kiljacken/followers", "following_url": "https://api.github.com/users/kiljacken/following{/other_user}", "gists_url": "https://api.github.com/users/kiljacken/gists{/gist_id}", "starred_url": "https://api.github.com/users/kiljacken/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kiljacken/subscriptions", "organizations_url": "https://api.github.com/users/kiljacken/orgs", "repos_url": "https://api.github.com/users/kiljacken/repos", "events_url": "https://api.github.com/users/kiljacken/events{/privacy}", "received_events_url": "https://api.github.com/users/kiljacken/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kiljacken", "id": 209321, "node_id": "MDQ6VXNlcjIwOTMyMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/209321?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kiljacken", "html_url": "https://github.com/kiljacken", "followers_url": "https://api.github.com/users/kiljacken/followers", "following_url": "https://api.github.com/users/kiljacken/following{/other_user}", "gists_url": "https://api.github.com/users/kiljacken/gists{/gist_id}", "starred_url": "https://api.github.com/users/kiljacken/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kiljacken/subscriptions", "organizations_url": "https://api.github.com/users/kiljacken/orgs", "repos_url": "https://api.github.com/users/kiljacken/repos", "events_url": "https://api.github.com/users/kiljacken/events{/privacy}", "received_events_url": "https://api.github.com/users/kiljacken/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5621f90071f576a8989cd09f98eb0fc6c9b7a612", "url": "https://api.github.com/repos/rust-lang/rust/commits/5621f90071f576a8989cd09f98eb0fc6c9b7a612", "html_url": "https://github.com/rust-lang/rust/commit/5621f90071f576a8989cd09f98eb0fc6c9b7a612"}], "stats": {"total": 14, "additions": 12, "deletions": 2}, "files": [{"sha": "20fa5a924ec1152e6962efeca01612850f12547f", "filename": "crates/ra_cargo_watch/src/lib.rs", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/daca5a3711851db2a954646c6f7209be996144ff/crates%2Fra_cargo_watch%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/daca5a3711851db2a954646c6f7209be996144ff/crates%2Fra_cargo_watch%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_cargo_watch%2Fsrc%2Flib.rs?ref=daca5a3711851db2a954646c6f7209be996144ff", "patch": "@@ -184,8 +184,13 @@ impl CheckWatcherState {\n         workspace_root: PathBuf,\n         shared: Arc<RwLock<CheckWatcherSharedState>>,\n     ) -> CheckWatcherState {\n-        let watcher = WatchThread::new(&options, &workspace_root);\n-        CheckWatcherState { options, workspace_root, watcher, last_update_req: None, shared }\n+        CheckWatcherState {\n+            options,\n+            workspace_root,\n+            watcher: WatchThread::dummy(),\n+            last_update_req: None,\n+            shared,\n+        }\n     }\n \n     fn run(&mut self, task_send: &Sender<CheckTask>, cmd_recv: &Receiver<CheckCommand>) {\n@@ -313,6 +318,10 @@ enum CheckEvent {\n }\n \n impl WatchThread {\n+    fn dummy() -> WatchThread {\n+        WatchThread { handle: None, message_recv: never() }\n+    }\n+\n     fn new(options: &CheckOptions, workspace_root: &PathBuf) -> WatchThread {\n         let mut args: Vec<String> = vec![\n             options.command.clone(),"}, {"sha": "844259796ecdcbe788bc9365a46632492508236b", "filename": "crates/ra_lsp_server/src/main_loop.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/daca5a3711851db2a954646c6f7209be996144ff/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/daca5a3711851db2a954646c6f7209be996144ff/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop.rs?ref=daca5a3711851db2a954646c6f7209be996144ff", "patch": "@@ -416,6 +416,7 @@ fn loop_turn(\n         if world_state.feature_flags().get(\"notifications.workspace-loaded\") {\n             let msg = format!(\"workspace loaded, {} rust packages\", n_packages);\n             show_message(req::MessageType::Info, msg, &connection.sender);\n+            world_state.check_watcher.update();\n         }\n     }\n "}]}