{"sha": "61c47ba88085b8be2872ee968a30868d25d0f1ef", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYxYzQ3YmE4ODA4NWI4YmUyODcyZWU5NjhhMzA4NjhkMjVkMGYxZWY=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-05-20T13:14:50Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-05-25T15:05:51Z"}, "message": "Generate DOM more securely", "tree": {"sha": "e0fa6d0991be265bc9fe01fce11b1d53b02d768d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e0fa6d0991be265bc9fe01fce11b1d53b02d768d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/61c47ba88085b8be2872ee968a30868d25d0f1ef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/61c47ba88085b8be2872ee968a30868d25d0f1ef", "html_url": "https://github.com/rust-lang/rust/commit/61c47ba88085b8be2872ee968a30868d25d0f1ef", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/61c47ba88085b8be2872ee968a30868d25d0f1ef/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fbf1b1a7193cda17008ab590e06ad28d9924023b", "url": "https://api.github.com/repos/rust-lang/rust/commits/fbf1b1a7193cda17008ab590e06ad28d9924023b", "html_url": "https://github.com/rust-lang/rust/commit/fbf1b1a7193cda17008ab590e06ad28d9924023b"}], "stats": {"total": 65, "additions": 49, "deletions": 16}, "files": [{"sha": "b3242bf4df923aa3b1df32a830f3eae4a055d0e3", "filename": "src/librustdoc/html/static/search.js", "status": "modified", "additions": 49, "deletions": 16, "changes": 65, "blob_url": "https://github.com/rust-lang/rust/blob/61c47ba88085b8be2872ee968a30868d25d0f1ef/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fsearch.js", "raw_url": "https://github.com/rust-lang/rust/raw/61c47ba88085b8be2872ee968a30868d25d0f1ef/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fsearch.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fsearch.js?ref=61c47ba88085b8be2872ee968a30868d25d0f1ef", "patch": "@@ -968,11 +968,11 @@ window.initSearch = function(rawSearchIndex) {\n             extraClass = \" active\";\n         }\n \n-        var output = \"\";\n+        var output = document.createElement(\"div\");\n         var duplicates = {};\n         var length = 0;\n         if (array.length > 0) {\n-            output = \"<div class=\\\"search-results \" + extraClass + \"\\\">\";\n+            output.className = \"search-results \" + extraClass;\n \n             array.forEach(function(item) {\n                 if (item.is_alias !== true) {\n@@ -994,19 +994,46 @@ window.initSearch = function(rawSearchIndex) {\n                     extra = \" <i>(keyword)</i>\";\n                 }\n \n-                output += \"<a class=\\\"result-\" + type + \"\\\" href=\\\"\" + item.href + \"\\\">\" +\n-                          \"<div><div class=\\\"result-name\\\">\" +\n-                          (item.is_alias === true ?\n-                           (\"<span class=\\\"alias\\\"><b>\" + item.alias + \" </b></span><span \" +\n-                              \"class=\\\"grey\\\"><i>&nbsp;- see&nbsp;</i></span>\") : \"\") +\n-                          item.displayPath + \"<span class=\\\"\" + type + \"\\\">\" +\n-                          name + extra + \"</span></div><div class=\\\"desc\\\">\" +\n-                          \"<span>\" + item.desc +\n-                          \"&nbsp;</span></div></div></a>\";\n+                var link = document.createElement(\"a\");\n+                link.className = \"result-\" + type;\n+                link.href = item.href;\n+\n+                var wrapper = document.createElement(\"div\");\n+                var resultName = document.createElement(\"div\");\n+                resultName.className = \"result-name\";\n+\n+                if (item.is_alias) {\n+                    var alias = document.createElement(\"span\");\n+                    alias.className = \"alias\";\n+\n+                    var bold = document.createElement(\"b\");\n+                    bold.innerText = item.alias;\n+                    alias.appendChild(bold);\n+\n+                    alias.insertAdjacentHTML(\n+                        \"beforeend\",\n+                        \"<span class=\\\"grey\\\"><i>&nbsp;- see&nbsp;</i></span>\");\n+\n+                    resultName.appendChild(alias);\n+                }\n+                resultName.insertAdjacentHTML(\n+                    \"beforeend\",\n+                    item.displayPath + \"<span class=\\\"\" + type + \"\\\">\" + name + extra + \"</span>\");\n+                wrapper.appendChild(resultName);\n+\n+                var description = document.createElement(\"div\");\n+                description.className = \"desc\";\n+                var spanDesc = document.createElement(\"span\");\n+                spanDesc.innerText = item.desc + \"\\u00A0\";\n+\n+                description.appendChild(spanDesc);\n+                wrapper.appendChild(description);\n+                link.appendChild(wrapper);\n+                output.appendChild(link);\n             });\n-            output += \"</div>\";\n         } else {\n-            output = \"<div class=\\\"search-failed\\\"\" + extraClass + \">No results :(<br/>\" +\n+            output.className = \"search-failed\" + extraClass;\n+            output.innerHTML = \"No results :(<br/>\" +\n                 \"Try on <a href=\\\"https://duckduckgo.com/?q=\" +\n                 encodeURIComponent(\"rust \" + query.query) +\n                 \"\\\">DuckDuckGo</a>?<br/><br/>\" +\n@@ -1018,7 +1045,7 @@ window.initSearch = function(rawSearchIndex) {\n                 \"href=\\\"https://doc.rust-lang.org/book/index.html\\\">Rust Book</a> for \" +\n                 \"introductions to language features and the language itself.</li><li><a \" +\n                 \"href=\\\"https://docs.rs\\\">Docs.rs</a> for documentation of crates released on\" +\n-                \" <a href=\\\"https://crates.io/\\\">crates.io</a>.</li></ul></div>\";\n+                \" <a href=\\\"https://crates.io/\\\">crates.io</a>.</li></ul>\";\n         }\n         return [output, length];\n     }\n@@ -1078,10 +1105,16 @@ window.initSearch = function(rawSearchIndex) {\n             makeTabHeader(0, \"In Names\", ret_others[1]) +\n             makeTabHeader(1, \"In Parameters\", ret_in_args[1]) +\n             makeTabHeader(2, \"In Return Types\", ret_returned[1]) +\n-            \"</div><div id=\\\"results\\\">\" +\n-            ret_others[0] + ret_in_args[0] + ret_returned[0] + \"</div>\";\n+            \"</div>\";\n+\n+        var resultsElem = document.createElement(\"div\");\n+        resultsElem.id = \"results\";\n+        resultsElem.appendChild(ret_others[0]);\n+        resultsElem.appendChild(ret_in_args[0]);\n+        resultsElem.appendChild(ret_returned[0]);\n \n         search.innerHTML = output;\n+        search.appendChild(resultsElem);\n         // Reset focused elements.\n         searchState.focusedByTab = [null, null, null];\n         searchState.showResults(search);"}]}