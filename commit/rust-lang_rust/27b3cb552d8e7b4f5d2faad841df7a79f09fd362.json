{"sha": "27b3cb552d8e7b4f5d2faad841df7a79f09fd362", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI3YjNjYjU1MmQ4ZTdiNGY1ZDJmYWFkODQxZGY3YTc5ZjA5ZmQzNjI=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2018-07-31T22:45:11Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2018-08-01T14:29:24Z"}, "message": "rustc: Trim down the `rust_2018_idioms` lint group\n\nThese migration lints aren't all up to par in terms of a good migration\nexperience. Some, like `unreachable_pub`, hit bugs like #52665 and unprepared\nmacros to be handled enough of the time. Others like linting against\n`#[macro_use]` are swimming upstream in an ecosystem that's not quite ready (and\nslightly buggy pending a few current PRs).\n\nThe general idea is that we will continue to recommend the `rust_2018_idioms`\nlint group as part of the transition guide (as an optional step) but we'll be\nmuch more selective about which lints make it into this group. Only those with a\nstrong track record of not causing too much churn will make the cut.\n\ncc #52679", "tree": {"sha": "48d0cf779a79e2ed56708d4bd59f60cd9f90221a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/48d0cf779a79e2ed56708d4bd59f60cd9f90221a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/27b3cb552d8e7b4f5d2faad841df7a79f09fd362", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/27b3cb552d8e7b4f5d2faad841df7a79f09fd362", "html_url": "https://github.com/rust-lang/rust/commit/27b3cb552d8e7b4f5d2faad841df7a79f09fd362", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/27b3cb552d8e7b4f5d2faad841df7a79f09fd362/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f89817997ac0aa100bf91997194ad85a7e59f743", "url": "https://api.github.com/repos/rust-lang/rust/commits/f89817997ac0aa100bf91997194ad85a7e59f743", "html_url": "https://github.com/rust-lang/rust/commit/f89817997ac0aa100bf91997194ad85a7e59f743"}], "stats": {"total": 29, "additions": 17, "deletions": 12}, "files": [{"sha": "b92ac0ff57bd88478b5fb40c95520c55e884173a", "filename": "src/librustc_lint/lib.rs", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/27b3cb552d8e7b4f5d2faad841df7a79f09fd362/src%2Flibrustc_lint%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27b3cb552d8e7b4f5d2faad841df7a79f09fd362/src%2Flibrustc_lint%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Flib.rs?ref=27b3cb552d8e7b4f5d2faad841df7a79f09fd362", "patch": "@@ -45,7 +45,6 @@ use rustc::lint::{LateContext, LateLintPass, LintPass, LintArray};\n use rustc::lint::builtin::{\n     BARE_TRAIT_OBJECTS,\n     ABSOLUTE_PATHS_NOT_STARTING_WITH_CRATE,\n-    MACRO_USE_EXTERN_CRATE,\n     ELIDED_LIFETIMES_IN_PATHS,\n     parser::QUESTION_MARK_MACRO_SEP\n };\n@@ -195,11 +194,18 @@ pub fn register_builtins(store: &mut lint::LintStore, sess: Option<&Session>) {\n     add_lint_group!(sess,\n                     \"rust_2018_idioms\",\n                     BARE_TRAIT_OBJECTS,\n-                    UNREACHABLE_PUB,\n                     UNUSED_EXTERN_CRATES,\n-                    MACRO_USE_EXTERN_CRATE,\n-                    ELIDED_LIFETIMES_IN_PATHS,\n-                    ELLIPSIS_INCLUSIVE_RANGE_PATTERNS);\n+                    ELLIPSIS_INCLUSIVE_RANGE_PATTERNS,\n+                    ELIDED_LIFETIMES_IN_PATHS\n+\n+                    // FIXME(#52665, #47816) not always applicable and not all\n+                    // macros are ready for this yet.\n+                    // UNREACHABLE_PUB,\n+\n+                    // FIXME macro crates are not up for this yet, too much\n+                    // breakage is seen if we try to encourage this lint.\n+                    // MACRO_USE_EXTERN_CRATE,\n+                    );\n \n     // Guidelines for creating a future incompatibility lint:\n     //"}, {"sha": "f50419434ae1ddfa518d5ef64f49bad26d7ad865", "filename": "src/test/ui/rust-2018/macro-use-warned-against.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/27b3cb552d8e7b4f5d2faad841df7a79f09fd362/src%2Ftest%2Fui%2Frust-2018%2Fmacro-use-warned-against.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27b3cb552d8e7b4f5d2faad841df7a79f09fd362/src%2Ftest%2Fui%2Frust-2018%2Fmacro-use-warned-against.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frust-2018%2Fmacro-use-warned-against.rs?ref=27b3cb552d8e7b4f5d2faad841df7a79f09fd362", "patch": "@@ -12,7 +12,7 @@\n // aux-build:macro-use-warned-against2.rs\n // compile-pass\n \n-#![warn(rust_2018_idioms, unused)]\n+#![warn(macro_use_extern_crate, unused)]\n #![feature(use_extern_macros)]\n \n #[macro_use] //~ WARN should be replaced at use sites with a `use` statement"}, {"sha": "7af404fab790e432ac20cee4d7e1637fe92a9124", "filename": "src/test/ui/rust-2018/macro-use-warned-against.stderr", "status": "modified", "additions": 5, "deletions": 6, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/27b3cb552d8e7b4f5d2faad841df7a79f09fd362/src%2Ftest%2Fui%2Frust-2018%2Fmacro-use-warned-against.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/27b3cb552d8e7b4f5d2faad841df7a79f09fd362/src%2Ftest%2Fui%2Frust-2018%2Fmacro-use-warned-against.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frust-2018%2Fmacro-use-warned-against.stderr?ref=27b3cb552d8e7b4f5d2faad841df7a79f09fd362", "patch": "@@ -7,9 +7,8 @@ LL | #[macro_use] //~ WARN should be replaced at use sites with a `use` statemen\n note: lint level defined here\n   --> $DIR/macro-use-warned-against.rs:15:9\n    |\n-LL | #![warn(rust_2018_idioms, unused)]\n-   |         ^^^^^^^^^^^^^^^^\n-   = note: #[warn(macro_use_extern_crate)] implied by #[warn(rust_2018_idioms)]\n+LL | #![warn(macro_use_extern_crate, unused)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused `#[macro_use]` import\n   --> $DIR/macro-use-warned-against.rs:20:1\n@@ -18,9 +17,9 @@ LL | #[macro_use] //~ WARN unused `#[macro_use]`\n    | ^^^^^^^^^^^^\n    |\n note: lint level defined here\n-  --> $DIR/macro-use-warned-against.rs:15:27\n+  --> $DIR/macro-use-warned-against.rs:15:33\n    |\n-LL | #![warn(rust_2018_idioms, unused)]\n-   |                           ^^^^^^\n+LL | #![warn(macro_use_extern_crate, unused)]\n+   |                                 ^^^^^^\n    = note: #[warn(unused_imports)] implied by #[warn(unused)]\n "}]}