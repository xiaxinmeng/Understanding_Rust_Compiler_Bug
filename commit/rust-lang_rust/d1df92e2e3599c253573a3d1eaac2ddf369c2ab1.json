{"sha": "d1df92e2e3599c253573a3d1eaac2ddf369c2ab1", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQxZGY5MmUyZTM1OTljMjUzNTczYTNkMWVhYWMyZGRmMzY5YzJhYjE=", "commit": {"author": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2021-02-02T09:18:16Z"}, "committer": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2021-02-02T09:18:16Z"}, "message": "Sync from rust d60b29d1ae8147538b8d542f7ffcc03b48e2cbda", "tree": {"sha": "657640b240cc83aa584b7b6025cb55721cdd0235", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/657640b240cc83aa584b7b6025cb55721cdd0235"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d1df92e2e3599c253573a3d1eaac2ddf369c2ab1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d1df92e2e3599c253573a3d1eaac2ddf369c2ab1", "html_url": "https://github.com/rust-lang/rust/commit/d1df92e2e3599c253573a3d1eaac2ddf369c2ab1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d1df92e2e3599c253573a3d1eaac2ddf369c2ab1/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "eeb75c7d96a4d898e97c45387939002b3b87c34a", "url": "https://api.github.com/repos/rust-lang/rust/commits/eeb75c7d96a4d898e97c45387939002b3b87c34a", "html_url": "https://github.com/rust-lang/rust/commit/eeb75c7d96a4d898e97c45387939002b3b87c34a"}, {"sha": "02e1fd48d183c9a28dc7f78b68fded919a1b9338", "url": "https://api.github.com/repos/rust-lang/rust/commits/02e1fd48d183c9a28dc7f78b68fded919a1b9338", "html_url": "https://github.com/rust-lang/rust/commit/02e1fd48d183c9a28dc7f78b68fded919a1b9338"}], "stats": {"total": 13, "additions": 9, "deletions": 4}, "files": [{"sha": "be369b07fddfe35f3c41bcd4c56dc97c46ef1dce", "filename": "src/bin/cg_clif.rs", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/d1df92e2e3599c253573a3d1eaac2ddf369c2ab1/src%2Fbin%2Fcg_clif.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d1df92e2e3599c253573a3d1eaac2ddf369c2ab1/src%2Fbin%2Fcg_clif.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbin%2Fcg_clif.rs?ref=d1df92e2e3599c253573a3d1eaac2ddf369c2ab1", "patch": "@@ -6,7 +6,7 @@ extern crate rustc_interface;\n extern crate rustc_session;\n extern crate rustc_target;\n \n-use rustc_data_structures::profiling::print_time_passes_entry;\n+use rustc_data_structures::profiling::{get_resident_set_size, print_time_passes_entry};\n use rustc_interface::interface;\n use rustc_session::config::ErrorOutputType;\n use rustc_session::early_error;\n@@ -39,7 +39,8 @@ impl rustc_driver::Callbacks for CraneliftPassesCallbacks {\n }\n \n fn main() {\n-    let start = std::time::Instant::now();\n+    let start_time = std::time::Instant::now();\n+    let start_rss = get_resident_set_size();\n     rustc_driver::init_rustc_env_logger();\n     let mut callbacks = CraneliftPassesCallbacks::default();\n     rustc_driver::install_ice_hook();\n@@ -61,7 +62,11 @@ fn main() {\n         })));\n         run_compiler.run()\n     });\n-    // The extra `\\t` is necessary to align this label with the others.\n-    print_time_passes_entry(callbacks.time_passes, \"\\ttotal\", start.elapsed());\n+\n+    if callbacks.time_passes {\n+        let end_rss = get_resident_set_size();\n+        print_time_passes_entry(\"total\", start_time.elapsed(), start_rss, end_rss);\n+    }\n+\n     std::process::exit(exit_code)\n }"}]}