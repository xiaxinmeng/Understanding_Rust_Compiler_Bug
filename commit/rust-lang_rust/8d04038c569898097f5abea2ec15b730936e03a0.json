{"sha": "8d04038c569898097f5abea2ec15b730936e03a0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhkMDQwMzhjNTY5ODk4MDk3ZjVhYmVhMmVjMTViNzMwOTM2ZTAzYTA=", "commit": {"author": {"name": "Phil Turnbull", "email": "philip.turnbull@gmail.com", "date": "2016-11-25T14:53:49Z"}, "committer": {"name": "Phil Turnbull", "email": "philip.turnbull@gmail.com", "date": "2016-11-25T15:33:01Z"}, "message": "Make deref_addrof suggestions stricter\n\nSUGGESTION matches a substring so 'aref' in the testcases can match\n'let b = *aref', 'let b = **aref', 'let b = *&aref' etc, which are\nall wrong.", "tree": {"sha": "795fcc3fd5649708c9c176f5da446ae6206fbf98", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/795fcc3fd5649708c9c176f5da446ae6206fbf98"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8d04038c569898097f5abea2ec15b730936e03a0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8d04038c569898097f5abea2ec15b730936e03a0", "html_url": "https://github.com/rust-lang/rust/commit/8d04038c569898097f5abea2ec15b730936e03a0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8d04038c569898097f5abea2ec15b730936e03a0/comments", "author": {"login": "philipturnbull", "id": 45588, "node_id": "MDQ6VXNlcjQ1NTg4", "avatar_url": "https://avatars.githubusercontent.com/u/45588?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philipturnbull", "html_url": "https://github.com/philipturnbull", "followers_url": "https://api.github.com/users/philipturnbull/followers", "following_url": "https://api.github.com/users/philipturnbull/following{/other_user}", "gists_url": "https://api.github.com/users/philipturnbull/gists{/gist_id}", "starred_url": "https://api.github.com/users/philipturnbull/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philipturnbull/subscriptions", "organizations_url": "https://api.github.com/users/philipturnbull/orgs", "repos_url": "https://api.github.com/users/philipturnbull/repos", "events_url": "https://api.github.com/users/philipturnbull/events{/privacy}", "received_events_url": "https://api.github.com/users/philipturnbull/received_events", "type": "User", "site_admin": false}, "committer": {"login": "philipturnbull", "id": 45588, "node_id": "MDQ6VXNlcjQ1NTg4", "avatar_url": "https://avatars.githubusercontent.com/u/45588?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philipturnbull", "html_url": "https://github.com/philipturnbull", "followers_url": "https://api.github.com/users/philipturnbull/followers", "following_url": "https://api.github.com/users/philipturnbull/following{/other_user}", "gists_url": "https://api.github.com/users/philipturnbull/gists{/gist_id}", "starred_url": "https://api.github.com/users/philipturnbull/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philipturnbull/subscriptions", "organizations_url": "https://api.github.com/users/philipturnbull/orgs", "repos_url": "https://api.github.com/users/philipturnbull/repos", "events_url": "https://api.github.com/users/philipturnbull/events{/privacy}", "received_events_url": "https://api.github.com/users/philipturnbull/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a9f5b90f0f4994d6e11a7f75707f2010134a08fa", "url": "https://api.github.com/repos/rust-lang/rust/commits/a9f5b90f0f4994d6e11a7f75707f2010134a08fa", "html_url": "https://github.com/rust-lang/rust/commit/a9f5b90f0f4994d6e11a7f75707f2010134a08fa"}], "stats": {"total": 24, "additions": 13, "deletions": 11}, "files": [{"sha": "178e7387d3fef9f9e00acf9f94728b32fb7a2235", "filename": "tests/compile-fail/reference.rs", "status": "modified", "additions": 13, "deletions": 11, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/8d04038c569898097f5abea2ec15b730936e03a0/tests%2Fcompile-fail%2Freference.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8d04038c569898097f5abea2ec15b730936e03a0/tests%2Fcompile-fail%2Freference.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Freference.rs?ref=8d04038c569898097f5abea2ec15b730936e03a0", "patch": "@@ -19,56 +19,58 @@ fn main() {\n     let b = *&a;\n     //~^ERROR immediately dereferencing a reference\n     //~|HELP try this\n-    //~|SUGGESTION a\n+    //~|SUGGESTION let b = a;\n \n     let b = *&get_number();\n     //~^ERROR immediately dereferencing a reference\n     //~|HELP try this\n-    //~|SUGGESTION get_number()\n+    //~|SUGGESTION let b = get_number();\n \n     let b = *get_reference(&a);\n \n     let bytes : Vec<usize> = vec![1, 2, 3, 4];\n     let b = *&bytes[1..2][0];\n     //~^ERROR immediately dereferencing a reference\n     //~|HELP try this\n-    //~|SUGGESTION bytes[1..2][0]\n+    //~|SUGGESTION let b = bytes[1..2][0];\n \n     let b = *(&a);\n     //~^ERROR immediately dereferencing a reference\n     //~|HELP try this\n-    //~|SUGGESTION a\n+    //~|SUGGESTION let b = a;\n \n     let b = *&&a;\n     //~^ERROR immediately dereferencing a reference\n     //~|HELP try this\n-    //~|SUGGESTION &a\n+    //~|SUGGESTION let b = &a;\n \n     let b = **&aref;\n     //~^ERROR immediately dereferencing a reference\n     //~|HELP try this\n-    //~|SUGGESTION aref\n+    //~|SUGGESTION let b = *aref;\n \n-    //This produces a suggestion of 'let b = *&a;' which is still incorrect\n+    //This produces a suggestion of 'let b = *&a;' which\n+    //will trigger the 'deref_addrof' lint again\n     let b = **&&a;\n     //~^ERROR immediately dereferencing a reference\n     //~|HELP try this\n-    //~|SUGGESTION a\n+    //~|SUGGESTION let b = *&a;\n \n     {\n         let mut x = 10;\n         let y = *&mut x;\n         //~^ERROR immediately dereferencing a reference\n         //~|HELP try this\n-        //~|SUGGESTION x\n+        //~|SUGGESTION let y = x;\n     }\n \n     {\n-        //This produces a suggestion of 'let y = *&mut x' which is still incorrect\n+        //This produces a suggestion of 'let y = *&mut x' which\n+        //will trigger the 'deref_addrof' lint again\n         let mut x = 10;\n         let y = **&mut &mut x;\n         //~^ERROR immediately dereferencing a reference\n         //~|HELP try this\n-        //~|SUGGESTION x\n+        //~|SUGGESTION let y = *&mut x;\n     }\n }"}]}