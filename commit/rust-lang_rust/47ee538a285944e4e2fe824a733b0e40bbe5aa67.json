{"sha": "47ee538a285944e4e2fe824a733b0e40bbe5aa67", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ3ZWU1MzhhMjg1OTQ0ZTRlMmZlODI0YTczM2IwZTQwYmJlNWFhNjc=", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2019-03-09T13:15:40Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2019-03-16T13:08:05Z"}, "message": "resolve: Account for new importable entities", "tree": {"sha": "e83f63426165b301e3a6fced4eda911e013a82b3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e83f63426165b301e3a6fced4eda911e013a82b3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/47ee538a285944e4e2fe824a733b0e40bbe5aa67", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/47ee538a285944e4e2fe824a733b0e40bbe5aa67", "html_url": "https://github.com/rust-lang/rust/commit/47ee538a285944e4e2fe824a733b0e40bbe5aa67", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/47ee538a285944e4e2fe824a733b0e40bbe5aa67/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "52e885628e4317aa3f158622435927eb29b812e9", "url": "https://api.github.com/repos/rust-lang/rust/commits/52e885628e4317aa3f158622435927eb29b812e9", "html_url": "https://github.com/rust-lang/rust/commit/52e885628e4317aa3f158622435927eb29b812e9"}], "stats": {"total": 60, "additions": 49, "deletions": 11}, "files": [{"sha": "895e92a97f3dad3e5669a0eb8b64b38736a5da76", "filename": "src/librustc_resolve/build_reduced_graph.rs", "status": "modified", "additions": 7, "deletions": 11, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/47ee538a285944e4e2fe824a733b0e40bbe5aa67/src%2Flibrustc_resolve%2Fbuild_reduced_graph.rs", "raw_url": "https://github.com/rust-lang/rust/raw/47ee538a285944e4e2fe824a733b0e40bbe5aa67/src%2Flibrustc_resolve%2Fbuild_reduced_graph.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Fbuild_reduced_graph.rs?ref=47ee538a285944e4e2fe824a733b0e40bbe5aa67", "patch": "@@ -636,24 +636,24 @@ impl<'a> Resolver<'a> {\n         // but metadata cannot encode gensyms currently, so we create it here.\n         // This is only a guess, two equivalent idents may incorrectly get different gensyms here.\n         let ident = ident.gensym_if_underscore();\n-        let def_id = def.def_id();\n         let expansion = Mark::root(); // FIXME(jseyfried) intercrate hygiene\n         match def {\n-            Def::Mod(..) | Def::Enum(..) => {\n+            Def::Mod(def_id) | Def::Enum(def_id) => {\n                 let module = self.new_module(parent,\n                                              ModuleKind::Def(def, ident.name),\n                                              def_id,\n                                              expansion,\n                                              span);\n                 self.define(parent, ident, TypeNS, (module, vis, DUMMY_SP, expansion));\n             }\n-            Def::Variant(..) | Def::TyAlias(..) | Def::ForeignTy(..) => {\n+            Def::Variant(..) | Def::TyAlias(..) | Def::ForeignTy(..) | Def::Existential(..) |\n+            Def::TraitAlias(..) | Def::PrimTy(..) | Def::ToolMod => {\n                 self.define(parent, ident, TypeNS, (def, vis, DUMMY_SP, expansion));\n             }\n             Def::Fn(..) | Def::Static(..) | Def::Const(..) | Def::VariantCtor(..) => {\n                 self.define(parent, ident, ValueNS, (def, vis, DUMMY_SP, expansion));\n             }\n-            Def::StructCtor(..) => {\n+            Def::StructCtor(def_id, ..) => {\n                 self.define(parent, ident, ValueNS, (def, vis, DUMMY_SP, expansion));\n \n                 if let Some(struct_def_id) =\n@@ -662,7 +662,7 @@ impl<'a> Resolver<'a> {\n                     self.struct_constructors.insert(struct_def_id, (def, vis));\n                 }\n             }\n-            Def::Trait(..) => {\n+            Def::Trait(def_id) => {\n                 let module_kind = ModuleKind::Def(def, ident.name);\n                 let module = self.new_module(parent,\n                                              module_kind,\n@@ -683,18 +683,14 @@ impl<'a> Resolver<'a> {\n                 }\n                 module.populated.set(true);\n             }\n-            Def::Existential(..) |\n-            Def::TraitAlias(..) => {\n-                self.define(parent, ident, TypeNS, (def, vis, DUMMY_SP, expansion));\n-            }\n-            Def::Struct(..) | Def::Union(..) => {\n+            Def::Struct(def_id) | Def::Union(def_id) => {\n                 self.define(parent, ident, TypeNS, (def, vis, DUMMY_SP, expansion));\n \n                 // Record field names for error reporting.\n                 let field_names = self.cstore.struct_field_names_untracked(def_id);\n                 self.insert_field_names(def_id, field_names);\n             }\n-            Def::Macro(..) => {\n+            Def::Macro(..) | Def::NonMacroAttr(..) => {\n                 self.define(parent, ident, MacroNS, (def, vis, DUMMY_SP, expansion));\n             }\n             _ => bug!(\"unexpected definition: {:?}\", def)"}, {"sha": "4aa5d1870000d0d98493d97aa099136abfe3ba68", "filename": "src/test/ui/rust-2018/uniform-paths/auxiliary/cross-crate.rs", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/47ee538a285944e4e2fe824a733b0e40bbe5aa67/src%2Ftest%2Fui%2Frust-2018%2Funiform-paths%2Fauxiliary%2Fcross-crate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/47ee538a285944e4e2fe824a733b0e40bbe5aa67/src%2Ftest%2Fui%2Frust-2018%2Funiform-paths%2Fauxiliary%2Fcross-crate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frust-2018%2Funiform-paths%2Fauxiliary%2Fcross-crate.rs?ref=47ee538a285944e4e2fe824a733b0e40bbe5aa67", "patch": "@@ -0,0 +1,5 @@\n+// edition:2018\n+\n+pub use ignore as built_in_attr;\n+pub use u8 as built_in_type;\n+pub use rustfmt as tool_mod;"}, {"sha": "27d6dbf4683e31530fd6799be160f00735238bc8", "filename": "src/test/ui/rust-2018/uniform-paths/cross-crate.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/47ee538a285944e4e2fe824a733b0e40bbe5aa67/src%2Ftest%2Fui%2Frust-2018%2Funiform-paths%2Fcross-crate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/47ee538a285944e4e2fe824a733b0e40bbe5aa67/src%2Ftest%2Fui%2Frust-2018%2Funiform-paths%2Fcross-crate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frust-2018%2Funiform-paths%2Fcross-crate.rs?ref=47ee538a285944e4e2fe824a733b0e40bbe5aa67", "patch": "@@ -0,0 +1,11 @@\n+// edition:2018\n+// aux-build:cross-crate.rs\n+\n+extern crate cross_crate;\n+use cross_crate::*;\n+\n+#[built_in_attr] //~ ERROR cannot use a built-in attribute through an import\n+#[tool_mod::skip] //~ ERROR cannot use a tool module through an import\n+fn main() {\n+    let _: built_in_type; // OK\n+}"}, {"sha": "fdde75faf5f0421fda0dc874f80174547b849093", "filename": "src/test/ui/rust-2018/uniform-paths/cross-crate.stderr", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/47ee538a285944e4e2fe824a733b0e40bbe5aa67/src%2Ftest%2Fui%2Frust-2018%2Funiform-paths%2Fcross-crate.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/47ee538a285944e4e2fe824a733b0e40bbe5aa67/src%2Ftest%2Fui%2Frust-2018%2Funiform-paths%2Fcross-crate.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frust-2018%2Funiform-paths%2Fcross-crate.stderr?ref=47ee538a285944e4e2fe824a733b0e40bbe5aa67", "patch": "@@ -0,0 +1,26 @@\n+error: cannot use a built-in attribute through an import\n+  --> $DIR/cross-crate.rs:7:3\n+   |\n+LL | #[built_in_attr]\n+   |   ^^^^^^^^^^^^^\n+   |\n+note: the built-in attribute imported here\n+  --> $DIR/cross-crate.rs:5:5\n+   |\n+LL | use cross_crate::*;\n+   |     ^^^^^^^^^^^^^^\n+\n+error: cannot use a tool module through an import\n+  --> $DIR/cross-crate.rs:8:3\n+   |\n+LL | #[tool_mod::skip]\n+   |   ^^^^^^^^\n+   |\n+note: the tool module imported here\n+  --> $DIR/cross-crate.rs:5:5\n+   |\n+LL | use cross_crate::*;\n+   |     ^^^^^^^^^^^^^^\n+\n+error: aborting due to 2 previous errors\n+"}]}