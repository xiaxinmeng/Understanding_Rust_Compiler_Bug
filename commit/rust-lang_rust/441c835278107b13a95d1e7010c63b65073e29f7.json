{"sha": "441c835278107b13a95d1e7010c63b65073e29f7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ0MWM4MzUyNzgxMDdiMTNhOTVkMWU3MDEwYzYzYjY1MDczZTI5Zjc=", "commit": {"author": {"name": "Dylan DPC", "email": "dylan.dpc@gmail.com", "date": "2020-08-22T00:14:44Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-08-22T00:14:44Z"}, "message": "Rollup merge of #75718 - GuillaumeGomez:coverage-ui-doc-examples-count, r=jyn514\n\nDon't count variants/fields/consts/associated types in doc-coverage doc examples\n\nFixes #75714.\n\nI think I'll need to update the equivalent lint too. Creating an issue for that!\n\nr? @jyn514", "tree": {"sha": "552c8c5ed0e4a0a77483d5ca183e9aeb5822b588", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/552c8c5ed0e4a0a77483d5ca183e9aeb5822b588"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/441c835278107b13a95d1e7010c63b65073e29f7", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfQGN0CRBK7hj4Ov3rIwAAdHIIAJwlKCCQSkQPWleQnasyzXlU\nQlLEoXspt7ypzq5UvVV57QfS01xAxrqmVpmgcepfiBQhNplM0CwRgghP4A3ibCUy\nMVixK3KM2tiEN9nV0BO6upfkuijRKaZk4tgWEmHtRiXggrIFtCpw2dlULF4xBwkO\nfCsALUdA2NEVKukQ4jt02repC1SDtLG+jFpxKYYPXBY7UEYAIuzXl3Y02Gz82J6S\nzJYhahqm5g/N1HQqYz/i1biFml9SVsIjoJEIRlX6T8ocYacZn0DpSRonEBYjkCHe\nGHwk/GQPuwZeUfDKgCI1MmURFibOaND44sNmvB3oE+u0GMRZ6gknCoUJMrhS/2o=\n=dUM6\n-----END PGP SIGNATURE-----\n", "payload": "tree 552c8c5ed0e4a0a77483d5ca183e9aeb5822b588\nparent 6cb98e3114cefd8ecd7aa6d48c29109e3a48fc60\nparent adeedf52435fe893156f93e2771dc66adf02abc9\nauthor Dylan DPC <dylan.dpc@gmail.com> 1598055284 +0200\ncommitter GitHub <noreply@github.com> 1598055284 +0200\n\nRollup merge of #75718 - GuillaumeGomez:coverage-ui-doc-examples-count, r=jyn514\n\nDon't count variants/fields/consts/associated types in doc-coverage doc examples\n\nFixes #75714.\n\nI think I'll need to update the equivalent lint too. Creating an issue for that!\n\nr? @jyn514\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/441c835278107b13a95d1e7010c63b65073e29f7", "html_url": "https://github.com/rust-lang/rust/commit/441c835278107b13a95d1e7010c63b65073e29f7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/441c835278107b13a95d1e7010c63b65073e29f7/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6cb98e3114cefd8ecd7aa6d48c29109e3a48fc60", "url": "https://api.github.com/repos/rust-lang/rust/commits/6cb98e3114cefd8ecd7aa6d48c29109e3a48fc60", "html_url": "https://github.com/rust-lang/rust/commit/6cb98e3114cefd8ecd7aa6d48c29109e3a48fc60"}, {"sha": "adeedf52435fe893156f93e2771dc66adf02abc9", "url": "https://api.github.com/repos/rust-lang/rust/commits/adeedf52435fe893156f93e2771dc66adf02abc9", "html_url": "https://github.com/rust-lang/rust/commit/adeedf52435fe893156f93e2771dc66adf02abc9"}], "stats": {"total": 290, "additions": 196, "deletions": 94}, "files": [{"sha": "f45e22950643826ae87425146aceb7e597b92f8d", "filename": "src/doc/rustdoc/src/unstable-features.md", "status": "modified", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/441c835278107b13a95d1e7010c63b65073e29f7/src%2Fdoc%2Frustdoc%2Fsrc%2Funstable-features.md", "raw_url": "https://github.com/rust-lang/rust/raw/441c835278107b13a95d1e7010c63b65073e29f7/src%2Fdoc%2Frustdoc%2Fsrc%2Funstable-features.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustdoc%2Fsrc%2Funstable-features.md?ref=441c835278107b13a95d1e7010c63b65073e29f7", "patch": "@@ -467,3 +467,36 @@ $ rustdoc src/lib.rs -Z unstable-options --runtool valgrind\n ```\n \n Another use case would be to run a test inside an emulator, or through a Virtual Machine.\n+\n+### `--show-coverage`: get statistics about code documentation coverage\n+\n+This option allows you to get a nice overview over your code documentation coverage, including both\n+doc-comments and code examples in the doc-comments. Example:\n+\n+```bash\n+$ rustdoc src/lib.rs -Z unstable-options --show-coverage\n++-------------------------------------+------------+------------+------------+------------+\n+| File                                | Documented | Percentage |   Examples | Percentage |\n++-------------------------------------+------------+------------+------------+------------+\n+| lib.rs                              |          4 |     100.0% |          1 |      25.0% |\n++-------------------------------------+------------+------------+------------+------------+\n+| Total                               |          4 |     100.0% |          1 |      25.0% |\n++-------------------------------------+------------+------------+------------+------------+\n+```\n+\n+You can also use this option with the `--output-format` one:\n+\n+```bash\n+$ rustdoc src/lib.rs -Z unstable-options --show-coverage --output-format json\n+{\"lib.rs\":{\"total\":4,\"with_docs\":4,\"total_examples\":4,\"with_examples\":1}}\n+```\n+\n+Calculating code examples follows these rules:\n+\n+1. These items aren't accounted by default:\n+  * struct/union field\n+  * enum variant\n+  * constant\n+  * static\n+  * typedef\n+2. If one of the previously listed items has a code example, then it'll be counted."}, {"sha": "457359e7a3806f20746823b7dcd02011929f9c7a", "filename": "src/librustdoc/passes/calculate_doc_coverage.rs", "status": "modified", "additions": 52, "deletions": 35, "changes": 87, "blob_url": "https://github.com/rust-lang/rust/blob/441c835278107b13a95d1e7010c63b65073e29f7/src%2Flibrustdoc%2Fpasses%2Fcalculate_doc_coverage.rs", "raw_url": "https://github.com/rust-lang/rust/raw/441c835278107b13a95d1e7010c63b65073e29f7/src%2Flibrustdoc%2Fpasses%2Fcalculate_doc_coverage.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcalculate_doc_coverage.rs?ref=441c835278107b13a95d1e7010c63b65073e29f7", "patch": "@@ -27,20 +27,29 @@ fn calculate_doc_coverage(krate: clean::Crate, ctx: &DocContext<'_>) -> clean::C\n     krate\n }\n \n-#[derive(Default, Copy, Clone, Serialize)]\n+#[derive(Default, Copy, Clone, Serialize, Debug)]\n struct ItemCount {\n     total: u64,\n     with_docs: u64,\n+    total_examples: u64,\n     with_examples: u64,\n }\n \n impl ItemCount {\n-    fn count_item(&mut self, has_docs: bool, has_doc_example: bool) {\n+    fn count_item(\n+        &mut self,\n+        has_docs: bool,\n+        has_doc_example: bool,\n+        should_have_doc_examples: bool,\n+    ) {\n         self.total += 1;\n \n         if has_docs {\n             self.with_docs += 1;\n         }\n+        if should_have_doc_examples || has_doc_example {\n+            self.total_examples += 1;\n+        }\n         if has_doc_example {\n             self.with_examples += 1;\n         }\n@@ -55,8 +64,8 @@ impl ItemCount {\n     }\n \n     fn examples_percentage(&self) -> Option<f64> {\n-        if self.total > 0 {\n-            Some((self.with_examples as f64 * 100.0) / self.total as f64)\n+        if self.total_examples > 0 {\n+            Some((self.with_examples as f64 * 100.0) / self.total_examples as f64)\n         } else {\n             None\n         }\n@@ -70,6 +79,7 @@ impl ops::Sub for ItemCount {\n         ItemCount {\n             total: self.total - rhs.total,\n             with_docs: self.with_docs - rhs.with_docs,\n+            total_examples: self.total_examples - rhs.total_examples,\n             with_examples: self.with_examples - rhs.with_examples,\n         }\n     }\n@@ -79,6 +89,7 @@ impl ops::AddAssign for ItemCount {\n     fn add_assign(&mut self, rhs: Self) {\n         self.total += rhs.total;\n         self.with_docs += rhs.with_docs;\n+        self.total_examples += rhs.total_examples;\n         self.with_examples += rhs.with_examples;\n     }\n }\n@@ -121,7 +132,7 @@ impl CoverageCalculator {\n         let mut total = ItemCount::default();\n \n         fn print_table_line() {\n-            println!(\"+-{0:->35}-+-{0:->10}-+-{0:->10}-+-{0:->10}-+-{0:->10}-+-{0:->10}-+\", \"\");\n+            println!(\"+-{0:->35}-+-{0:->10}-+-{0:->10}-+-{0:->10}-+-{0:->10}-+\", \"\");\n         }\n \n         fn print_table_record(\n@@ -131,32 +142,25 @@ impl CoverageCalculator {\n             examples_percentage: f64,\n         ) {\n             println!(\n-                \"| {:<35} | {:>10} | {:>10} | {:>9.1}% | {:>10} | {:>9.1}% |\",\n-                name,\n-                count.with_docs,\n-                count.total,\n-                percentage,\n-                count.with_examples,\n-                examples_percentage,\n+                \"| {:<35} | {:>10} | {:>9.1}% | {:>10} | {:>9.1}% |\",\n+                name, count.with_docs, percentage, count.with_examples, examples_percentage,\n             );\n         }\n \n         print_table_line();\n         println!(\n-            \"| {:<35} | {:>10} | {:>10} | {:>10} | {:>10} | {:>10} |\",\n-            \"File\", \"Documented\", \"Total\", \"Percentage\", \"Examples\", \"Percentage\",\n+            \"| {:<35} | {:>10} | {:>10} | {:>10} | {:>10} |\",\n+            \"File\", \"Documented\", \"Percentage\", \"Examples\", \"Percentage\",\n         );\n         print_table_line();\n \n         for (file, &count) in &self.items {\n-            if let (Some(percentage), Some(examples_percentage)) =\n-                (count.percentage(), count.examples_percentage())\n-            {\n+            if let Some(percentage) = count.percentage() {\n                 print_table_record(\n                     &limit_filename_len(file.to_string()),\n                     count,\n                     percentage,\n-                    examples_percentage,\n+                    count.examples_percentage().unwrap_or(0.),\n                 );\n \n                 total += count;\n@@ -176,19 +180,6 @@ impl CoverageCalculator {\n \n impl fold::DocFolder for CoverageCalculator {\n     fn fold_item(&mut self, i: clean::Item) -> Option<clean::Item> {\n-        let has_docs = !i.attrs.doc_strings.is_empty();\n-        let mut tests = Tests { found_tests: 0 };\n-\n-        find_testable_code(\n-            &i.attrs.doc_strings.iter().map(|d| d.as_str()).collect::<Vec<_>>().join(\"\\n\"),\n-            &mut tests,\n-            ErrorCodes::No,\n-            false,\n-            None,\n-        );\n-\n-        let has_doc_example = tests.found_tests != 0;\n-\n         match i.inner {\n             _ if !i.def_id.is_local() => {\n                 // non-local items are skipped because they can be out of the users control,\n@@ -237,11 +228,37 @@ impl fold::DocFolder for CoverageCalculator {\n                 }\n             }\n             _ => {\n+                let has_docs = !i.attrs.doc_strings.is_empty();\n+                let mut tests = Tests { found_tests: 0 };\n+\n+                let should_have_doc_examples = !matches!(i.inner,\n+                    clean::StructFieldItem(_)\n+                    | clean::VariantItem(_)\n+                    | clean::AssocConstItem(_, _)\n+                    | clean::AssocTypeItem(_, _)\n+                    | clean::TypedefItem(_, _)\n+                    | clean::StaticItem(_)\n+                    | clean::ConstantItem(_)\n+                    | clean::ExternCrateItem(_, _)\n+                    | clean::ImportItem(_)\n+                    | clean::PrimitiveItem(_)\n+                    | clean::KeywordItem(_)\n+                );\n+                find_testable_code(\n+                    &i.attrs.doc_strings.iter().map(|d| d.as_str()).collect::<Vec<_>>().join(\"\\n\"),\n+                    &mut tests,\n+                    ErrorCodes::No,\n+                    false,\n+                    None,\n+                );\n+\n+                let has_doc_example = tests.found_tests != 0;\n                 debug!(\"counting {:?} {:?} in {}\", i.type_(), i.name, i.source.filename);\n-                self.items\n-                    .entry(i.source.filename.clone())\n-                    .or_default()\n-                    .count_item(has_docs, has_doc_example);\n+                self.items.entry(i.source.filename.clone()).or_default().count_item(\n+                    has_docs,\n+                    has_doc_example,\n+                    should_have_doc_examples,\n+                );\n             }\n         }\n "}, {"sha": "3c602b3da4c7c8952347566f6acb16fbcf7ebea4", "filename": "src/test/rustdoc-ui/coverage/basic.stdout", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fbasic.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fbasic.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fbasic.stdout?ref=441c835278107b13a95d1e7010c63b65073e29f7", "patch": "@@ -1,7 +1,7 @@\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| File                                | Documented |      Total | Percentage |   Examples | Percentage |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| ...est/rustdoc-ui/coverage/basic.rs |          7 |         14 |      50.0% |          0 |       0.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| Total                               |          7 |         14 |      50.0% |          0 |       0.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n++-------------------------------------+------------+------------+------------+------------+\n+| File                                | Documented | Percentage |   Examples | Percentage |\n++-------------------------------------+------------+------------+------------+------------+\n+| ...est/rustdoc-ui/coverage/basic.rs |          7 |      50.0% |          0 |       0.0% |\n++-------------------------------------+------------+------------+------------+------------+\n+| Total                               |          7 |      50.0% |          0 |       0.0% |\n++-------------------------------------+------------+------------+------------+------------+"}, {"sha": "1da1813790e860b81e35edb871117ef7e9da98fe", "filename": "src/test/rustdoc-ui/coverage/doc-examples-json.rs", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fdoc-examples-json.rs", "raw_url": "https://github.com/rust-lang/rust/raw/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fdoc-examples-json.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fdoc-examples-json.rs?ref=441c835278107b13a95d1e7010c63b65073e29f7", "patch": "@@ -0,0 +1,13 @@\n+// check-pass\n+// compile-flags:-Z unstable-options --output-format json --show-coverage\n+\n+// This check ensures that only one doc example is counted since they're \"optional\" on\n+// certain items.\n+\n+/// ```\n+/// let x = 12;\n+/// ```\n+pub const Foo: u32 = 0;\n+\n+/// doc\n+pub const Bar: u32 = 0;"}, {"sha": "92f58556975ae89b97c11a0a5a4d91d547032cfa", "filename": "src/test/rustdoc-ui/coverage/doc-examples-json.stdout", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fdoc-examples-json.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fdoc-examples-json.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fdoc-examples-json.stdout?ref=441c835278107b13a95d1e7010c63b65073e29f7", "patch": "@@ -0,0 +1 @@\n+{\"$DIR/doc-examples-json.rs\":{\"total\":3,\"with_docs\":2,\"total_examples\":2,\"with_examples\":1}}"}, {"sha": "10ed13c9ff566c76d169649cc58949d7031dd442", "filename": "src/test/rustdoc-ui/coverage/doc-examples.stdout", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fdoc-examples.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fdoc-examples.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fdoc-examples.stdout?ref=441c835278107b13a95d1e7010c63b65073e29f7", "patch": "@@ -1,7 +1,7 @@\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| File                                | Documented |      Total | Percentage |   Examples | Percentage |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| ...tdoc-ui/coverage/doc-examples.rs |          4 |          4 |     100.0% |          2 |      50.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| Total                               |          4 |          4 |     100.0% |          2 |      50.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n++-------------------------------------+------------+------------+------------+------------+\n+| File                                | Documented | Percentage |   Examples | Percentage |\n++-------------------------------------+------------+------------+------------+------------+\n+| ...tdoc-ui/coverage/doc-examples.rs |          4 |     100.0% |          2 |      50.0% |\n++-------------------------------------+------------+------------+------------+------------+\n+| Total                               |          4 |     100.0% |          2 |      50.0% |\n++-------------------------------------+------------+------------+------------+------------+"}, {"sha": "890a7d56e162d09bb8e0cc933a75d261cc634a26", "filename": "src/test/rustdoc-ui/coverage/empty.stdout", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fempty.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fempty.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fempty.stdout?ref=441c835278107b13a95d1e7010c63b65073e29f7", "patch": "@@ -1,7 +1,7 @@\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| File                                | Documented |      Total | Percentage |   Examples | Percentage |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| ...est/rustdoc-ui/coverage/empty.rs |          0 |          1 |       0.0% |          0 |       0.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| Total                               |          0 |          1 |       0.0% |          0 |       0.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n++-------------------------------------+------------+------------+------------+------------+\n+| File                                | Documented | Percentage |   Examples | Percentage |\n++-------------------------------------+------------+------------+------------+------------+\n+| ...est/rustdoc-ui/coverage/empty.rs |          0 |       0.0% |          0 |       0.0% |\n++-------------------------------------+------------+------------+------------+------------+\n+| Total                               |          0 |       0.0% |          0 |       0.0% |\n++-------------------------------------+------------+------------+------------+------------+"}, {"sha": "64c012c1f66e3dfea1eea7a743511b78a08e0f5f", "filename": "src/test/rustdoc-ui/coverage/enums.stdout", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fenums.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fenums.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fenums.stdout?ref=441c835278107b13a95d1e7010c63b65073e29f7", "patch": "@@ -1,7 +1,7 @@\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| File                                | Documented |      Total | Percentage |   Examples | Percentage |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| ...est/rustdoc-ui/coverage/enums.rs |          6 |          8 |      75.0% |          0 |       0.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| Total                               |          6 |          8 |      75.0% |          0 |       0.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n++-------------------------------------+------------+------------+------------+------------+\n+| File                                | Documented | Percentage |   Examples | Percentage |\n++-------------------------------------+------------+------------+------------+------------+\n+| ...est/rustdoc-ui/coverage/enums.rs |          6 |      75.0% |          0 |       0.0% |\n++-------------------------------------+------------+------------+------------+------------+\n+| Total                               |          6 |      75.0% |          0 |       0.0% |\n++-------------------------------------+------------+------------+------------+------------+"}, {"sha": "e282ff128437513e3a88564d4c564db7ce263d8c", "filename": "src/test/rustdoc-ui/coverage/exotic.stdout", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fexotic.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fexotic.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fexotic.stdout?ref=441c835278107b13a95d1e7010c63b65073e29f7", "patch": "@@ -1,8 +1,8 @@\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| File                                | Documented |      Total | Percentage |   Examples | Percentage |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| ...st/rustdoc-ui/coverage/exotic.rs |          1 |          1 |     100.0% |          0 |       0.0% |\n-| <anon>                              |          2 |          2 |     100.0% |          0 |       0.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| Total                               |          3 |          3 |     100.0% |          0 |       0.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n++-------------------------------------+------------+------------+------------+------------+\n+| File                                | Documented | Percentage |   Examples | Percentage |\n++-------------------------------------+------------+------------+------------+------------+\n+| ...st/rustdoc-ui/coverage/exotic.rs |          1 |     100.0% |          0 |       0.0% |\n+| <anon>                              |          2 |     100.0% |          0 |       0.0% |\n++-------------------------------------+------------+------------+------------+------------+\n+| Total                               |          3 |     100.0% |          0 |       0.0% |\n++-------------------------------------+------------+------------+------------+------------+"}, {"sha": "a591cd5dba406ec1a0a29f72b163d9e6dab3eaae", "filename": "src/test/rustdoc-ui/coverage/json.rs", "status": "modified", "additions": 39, "deletions": 1, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fjson.rs", "raw_url": "https://github.com/rust-lang/rust/raw/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fjson.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fjson.rs?ref=441c835278107b13a95d1e7010c63b65073e29f7", "patch": "@@ -12,16 +12,54 @@ pub mod foo {\n pub struct X;\n \n /// Bar\n+///\n+/// ```\n+/// let x = 12;\n+/// ```\n pub mod bar {\n     /// bar\n     pub struct Bar;\n     /// X\n-    pub enum X { Y }\n+    pub enum X {\n+        /// ```\n+        /// let x = \"should be ignored!\";\n+        /// ```\n+        Y\n+    }\n }\n \n /// yolo\n+///\n+/// ```text\n+/// should not be counted as a code example!\n+/// ```\n pub enum Yolo { X }\n \n+impl Yolo {\n+    /// ```\n+    /// let x = \"should be ignored!\";\n+    /// ```\n+    pub const Const: u32 = 0;\n+}\n+\n pub struct Xo<T: Clone> {\n+    /// ```\n+    /// let x = \"should be ignored!\";\n+    /// ```\n     x: T,\n }\n+\n+/// ```\n+/// let x = \"should be ignored!\";\n+/// ```\n+pub static StaticFoo: u32 = 0;\n+\n+/// ```\n+/// let x = \"should be ignored!\";\n+/// ```\n+pub const ConstFoo: u32 = 0;\n+\n+/// ```\n+/// let x = \"should be ignored!\";\n+/// ```\n+pub type TypeFoo = u32;"}, {"sha": "c2be73ce3edd7c14b99a46e3445948ed27187041", "filename": "src/test/rustdoc-ui/coverage/json.stdout", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fjson.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fjson.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fjson.stdout?ref=441c835278107b13a95d1e7010c63b65073e29f7", "patch": "@@ -1 +1 @@\n-{\"$DIR/json.rs\":{\"total\":13,\"with_docs\":7,\"with_examples\":0}}\n+{\"$DIR/json.rs\":{\"total\":17,\"with_docs\":12,\"total_examples\":15,\"with_examples\":6}}"}, {"sha": "37a0f5187b5122fc745e20f6a195db081dd36a43", "filename": "src/test/rustdoc-ui/coverage/private.stdout", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fprivate.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fprivate.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fprivate.stdout?ref=441c835278107b13a95d1e7010c63b65073e29f7", "patch": "@@ -1,7 +1,7 @@\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| File                                | Documented |      Total | Percentage |   Examples | Percentage |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| ...t/rustdoc-ui/coverage/private.rs |          4 |          7 |      57.1% |          0 |       0.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| Total                               |          4 |          7 |      57.1% |          0 |       0.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n++-------------------------------------+------------+------------+------------+------------+\n+| File                                | Documented | Percentage |   Examples | Percentage |\n++-------------------------------------+------------+------------+------------+------------+\n+| ...t/rustdoc-ui/coverage/private.rs |          4 |      57.1% |          0 |       0.0% |\n++-------------------------------------+------------+------------+------------+------------+\n+| Total                               |          4 |      57.1% |          0 |       0.0% |\n++-------------------------------------+------------+------------+------------+------------+"}, {"sha": "dbea3a3ea23cf5f98a59f1611d89ed805545b647", "filename": "src/test/rustdoc-ui/coverage/statics-consts.stdout", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fstatics-consts.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fstatics-consts.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Fstatics-consts.stdout?ref=441c835278107b13a95d1e7010c63b65073e29f7", "patch": "@@ -1,7 +1,7 @@\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| File                                | Documented |      Total | Percentage |   Examples | Percentage |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| ...oc-ui/coverage/statics-consts.rs |          6 |          7 |      85.7% |          0 |       0.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| Total                               |          6 |          7 |      85.7% |          0 |       0.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n++-------------------------------------+------------+------------+------------+------------+\n+| File                                | Documented | Percentage |   Examples | Percentage |\n++-------------------------------------+------------+------------+------------+------------+\n+| ...oc-ui/coverage/statics-consts.rs |          6 |      85.7% |          0 |       0.0% |\n++-------------------------------------+------------+------------+------------+------------+\n+| Total                               |          6 |      85.7% |          0 |       0.0% |\n++-------------------------------------+------------+------------+------------+------------+"}, {"sha": "e04d48b4980c4c299859b70d16bee676c0745c4e", "filename": "src/test/rustdoc-ui/coverage/traits.stdout", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Ftraits.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/441c835278107b13a95d1e7010c63b65073e29f7/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Ftraits.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcoverage%2Ftraits.stdout?ref=441c835278107b13a95d1e7010c63b65073e29f7", "patch": "@@ -1,7 +1,7 @@\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| File                                | Documented |      Total | Percentage |   Examples | Percentage |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| ...st/rustdoc-ui/coverage/traits.rs |          6 |          7 |      85.7% |          0 |       0.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n-| Total                               |          6 |          7 |      85.7% |          0 |       0.0% |\n-+-------------------------------------+------------+------------+------------+------------+------------+\n++-------------------------------------+------------+------------+------------+------------+\n+| File                                | Documented | Percentage |   Examples | Percentage |\n++-------------------------------------+------------+------------+------------+------------+\n+| ...st/rustdoc-ui/coverage/traits.rs |          6 |      85.7% |          0 |       0.0% |\n++-------------------------------------+------------+------------+------------+------------+\n+| Total                               |          6 |      85.7% |          0 |       0.0% |\n++-------------------------------------+------------+------------+------------+------------+"}]}