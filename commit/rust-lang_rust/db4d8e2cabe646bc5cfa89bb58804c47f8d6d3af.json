{"sha": "db4d8e2cabe646bc5cfa89bb58804c47f8d6d3af", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRiNGQ4ZTJjYWJlNjQ2YmM1Y2ZhODliYjU4ODA0YzQ3ZjhkNmQzYWY=", "commit": {"author": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2021-05-31T15:36:53Z"}, "committer": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2021-06-08T17:24:16Z"}, "message": "Store boxed metadata loader in CrateLoader", "tree": {"sha": "bd60cefce27ac854903750a5d35b92aca050d15e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bd60cefce27ac854903750a5d35b92aca050d15e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/db4d8e2cabe646bc5cfa89bb58804c47f8d6d3af", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/db4d8e2cabe646bc5cfa89bb58804c47f8d6d3af", "html_url": "https://github.com/rust-lang/rust/commit/db4d8e2cabe646bc5cfa89bb58804c47f8d6d3af", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/db4d8e2cabe646bc5cfa89bb58804c47f8d6d3af/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ecc68e78799968d719e38c0fc5bf80e2d9800953", "url": "https://api.github.com/repos/rust-lang/rust/commits/ecc68e78799968d719e38c0fc5bf80e2d9800953", "html_url": "https://github.com/rust-lang/rust/commit/ecc68e78799968d719e38c0fc5bf80e2d9800953"}], "stats": {"total": 12, "additions": 6, "deletions": 6}, "files": [{"sha": "7c5eac8bbae9127b72aeb0d1769abf5bccf5def3", "filename": "compiler/rustc_interface/src/passes.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/db4d8e2cabe646bc5cfa89bb58804c47f8d6d3af/compiler%2Frustc_interface%2Fsrc%2Fpasses.rs", "raw_url": "https://github.com/rust-lang/rust/raw/db4d8e2cabe646bc5cfa89bb58804c47f8d6d3af/compiler%2Frustc_interface%2Fsrc%2Fpasses.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_interface%2Fsrc%2Fpasses.rs?ref=db4d8e2cabe646bc5cfa89bb58804c47f8d6d3af", "patch": "@@ -218,7 +218,7 @@ pub fn configure_and_expand(\n             krate,\n             &crate_name,\n             &resolver_arenas,\n-            &*metadata_loader,\n+            metadata_loader,\n         );\n         let mut resolver = match res {\n             Err(v) => {\n@@ -350,7 +350,7 @@ fn configure_and_expand_inner<'a>(\n     mut krate: ast::Crate,\n     crate_name: &str,\n     resolver_arenas: &'a ResolverArenas<'a>,\n-    metadata_loader: &'a MetadataLoaderDyn,\n+    metadata_loader: Box<MetadataLoaderDyn>,\n ) -> Result<(ast::Crate, Resolver<'a>)> {\n     tracing::trace!(\"configure_and_expand_inner\");\n     pre_expansion_lint(sess, lint_store, &krate, crate_name);"}, {"sha": "d73cfe35dc4a13cc9c2cdd84337411027a2166b5", "filename": "compiler/rustc_metadata/src/creader.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/db4d8e2cabe646bc5cfa89bb58804c47f8d6d3af/compiler%2Frustc_metadata%2Fsrc%2Fcreader.rs", "raw_url": "https://github.com/rust-lang/rust/raw/db4d8e2cabe646bc5cfa89bb58804c47f8d6d3af/compiler%2Frustc_metadata%2Fsrc%2Fcreader.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_metadata%2Fsrc%2Fcreader.rs?ref=db4d8e2cabe646bc5cfa89bb58804c47f8d6d3af", "patch": "@@ -54,7 +54,7 @@ pub struct CStore {\n pub struct CrateLoader<'a> {\n     // Immutable configuration.\n     sess: &'a Session,\n-    metadata_loader: &'a MetadataLoaderDyn,\n+    metadata_loader: Box<MetadataLoaderDyn>,\n     local_crate_name: Symbol,\n     // Mutable output.\n     cstore: CStore,\n@@ -219,7 +219,7 @@ impl CStore {\n impl<'a> CrateLoader<'a> {\n     pub fn new(\n         sess: &'a Session,\n-        metadata_loader: &'a MetadataLoaderDyn,\n+        metadata_loader: Box<MetadataLoaderDyn>,\n         local_crate_name: &str,\n     ) -> Self {\n         let local_crate_stable_id =\n@@ -544,7 +544,7 @@ impl<'a> CrateLoader<'a> {\n             info!(\"falling back to a load\");\n             let mut locator = CrateLocator::new(\n                 self.sess,\n-                self.metadata_loader,\n+                &*self.metadata_loader,\n                 name,\n                 hash,\n                 host_hash,"}, {"sha": "6d5531d330783257109c0fa696522b0f5a7360dc", "filename": "compiler/rustc_resolve/src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/db4d8e2cabe646bc5cfa89bb58804c47f8d6d3af/compiler%2Frustc_resolve%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/db4d8e2cabe646bc5cfa89bb58804c47f8d6d3af/compiler%2Frustc_resolve%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_resolve%2Fsrc%2Flib.rs?ref=db4d8e2cabe646bc5cfa89bb58804c47f8d6d3af", "patch": "@@ -1198,7 +1198,7 @@ impl<'a> Resolver<'a> {\n         session: &'a Session,\n         krate: &Crate,\n         crate_name: &str,\n-        metadata_loader: &'a MetadataLoaderDyn,\n+        metadata_loader: Box<MetadataLoaderDyn>,\n         arenas: &'a ResolverArenas<'a>,\n     ) -> Resolver<'a> {\n         let root_local_def_id = LocalDefId { local_def_index: CRATE_DEF_INDEX };"}]}