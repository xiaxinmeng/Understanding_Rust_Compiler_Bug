{"sha": "cf78ff3913f3efeefb2c90dcae18682f460b0d84", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNmNzhmZjM5MTNmM2VmZWVmYjJjOTBkY2FlMTg2ODJmNDYwYjBkODQ=", "commit": {"author": {"name": "Volker Mische", "email": "volker.mische@gmail.com", "date": "2018-01-31T23:21:43Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-01-31T23:21:43Z"}, "message": "Fix lang items box example code\n\nThe `exchange_free` lang item is gone in favour of `box_free` [1].\r\n\r\nSome warnings are also fixed by this commit.\r\n\r\n[1]: https://github.com/rust-lang/rust/commit/ca115dd083a1fe1d2b4892c5e50e49eb83ff1f3", "tree": {"sha": "63e739e8a8cd7addc3fc64c306666667cce389d3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/63e739e8a8cd7addc3fc64c306666667cce389d3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cf78ff3913f3efeefb2c90dcae18682f460b0d84", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJack+HCRBK7hj4Ov3rIwAAdHIIAEDHoaO30MkyI+mWUcjwRx2B\nLe6sgruSnpmS/pC1GUe4enonNOv1jSQjoYvTjxp9q6ioUz9WI7z4slkMdrc45b5W\nlcBD8t7i3hYTAzpv7fBwzKz1KgAhuReX7PfxD42D5nvTRL1WYMNz2sGHqPJDre9I\ndk9jPjkfZRups+Ev59aI3w55/pFj/q+m3bUUCGQ0zh7syZCuQBUButClUJUt8lSt\nHrupeMWZlAO3NpJdPanYHxPke5P/T6DO9T0KJyX0fQNkcb9OW4ysT4QdnqZP3kNI\nPsA3udWg31PqZr75XC9ZO+l/izhE/M4u194v+38ES1SDvlUbngZIwIFYrGCpoPQ=\n=LdDk\n-----END PGP SIGNATURE-----\n", "payload": "tree 63e739e8a8cd7addc3fc64c306666667cce389d3\nparent 560a2f4faf4828ba5f48fe2bd7709265c2f5354d\nauthor Volker Mische <volker.mische@gmail.com> 1517440903 +0100\ncommitter GitHub <noreply@github.com> 1517440903 +0100\n\nFix lang items box example code\n\nThe `exchange_free` lang item is gone in favour of `box_free` [1].\r\n\r\nSome warnings are also fixed by this commit.\r\n\r\n[1]: https://github.com/rust-lang/rust/commit/ca115dd083a1fe1d2b4892c5e50e49eb83ff1f3"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cf78ff3913f3efeefb2c90dcae18682f460b0d84", "html_url": "https://github.com/rust-lang/rust/commit/cf78ff3913f3efeefb2c90dcae18682f460b0d84", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cf78ff3913f3efeefb2c90dcae18682f460b0d84/comments", "author": {"login": "vmx", "id": 42839, "node_id": "MDQ6VXNlcjQyODM5", "avatar_url": "https://avatars.githubusercontent.com/u/42839?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vmx", "html_url": "https://github.com/vmx", "followers_url": "https://api.github.com/users/vmx/followers", "following_url": "https://api.github.com/users/vmx/following{/other_user}", "gists_url": "https://api.github.com/users/vmx/gists{/gist_id}", "starred_url": "https://api.github.com/users/vmx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vmx/subscriptions", "organizations_url": "https://api.github.com/users/vmx/orgs", "repos_url": "https://api.github.com/users/vmx/repos", "events_url": "https://api.github.com/users/vmx/events{/privacy}", "received_events_url": "https://api.github.com/users/vmx/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "560a2f4faf4828ba5f48fe2bd7709265c2f5354d", "url": "https://api.github.com/repos/rust-lang/rust/commits/560a2f4faf4828ba5f48fe2bd7709265c2f5354d", "html_url": "https://github.com/rust-lang/rust/commit/560a2f4faf4828ba5f48fe2bd7709265c2f5354d"}], "stats": {"total": 21, "additions": 8, "deletions": 13}, "files": [{"sha": "c51674186146be3bc1f076adf32f8bd4a8f1a717", "filename": "src/doc/unstable-book/src/language-features/lang-items.md", "status": "modified", "additions": 8, "deletions": 13, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/cf78ff3913f3efeefb2c90dcae18682f460b0d84/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Flang-items.md", "raw_url": "https://github.com/rust-lang/rust/raw/cf78ff3913f3efeefb2c90dcae18682f460b0d84/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Flang-items.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Flang-items.md?ref=cf78ff3913f3efeefb2c90dcae18682f460b0d84", "patch": "@@ -37,28 +37,23 @@ unsafe fn allocate(size: usize, _align: usize) -> *mut u8 {\n     p\n }\n \n-#[lang = \"exchange_free\"]\n-unsafe fn deallocate(ptr: *mut u8, _size: usize, _align: usize) {\n-    libc::free(ptr as *mut libc::c_void)\n-}\n-\n #[lang = \"box_free\"]\n unsafe fn box_free<T: ?Sized>(ptr: *mut T) {\n-    deallocate(ptr as *mut u8, ::core::mem::size_of_val(&*ptr), ::core::mem::align_of_val(&*ptr));\n+    libc::free(ptr as *mut libc::c_void)\n }\n \n #[start]\n-fn main(argc: isize, argv: *const *const u8) -> isize {\n-    let x = box 1;\n+fn main(_argc: isize, _argv: *const *const u8) -> isize {\n+    let _x = box 1;\n \n     0\n }\n \n #[lang = \"eh_personality\"] extern fn rust_eh_personality() {}\n #[lang = \"panic_fmt\"] extern fn rust_begin_panic() -> ! { unsafe { intrinsics::abort() } }\n-# #[lang = \"eh_unwind_resume\"] extern fn rust_eh_unwind_resume() {}\n-# #[no_mangle] pub extern fn rust_eh_register_frames () {}\n-# #[no_mangle] pub extern fn rust_eh_unregister_frames () {}\n+#[lang = \"eh_unwind_resume\"] extern fn rust_eh_unwind_resume() {}\n+#[no_mangle] pub extern fn rust_eh_register_frames () {}\n+#[no_mangle] pub extern fn rust_eh_unregister_frames () {}\n ```\n \n Note the use of `abort`: the `exchange_malloc` lang item is assumed to\n@@ -80,7 +75,7 @@ Other features provided by lang items include:\n \n Lang items are loaded lazily by the compiler; e.g. if one never uses\n `Box` then there is no need to define functions for `exchange_malloc`\n-and `exchange_free`. `rustc` will emit an error when an item is needed\n+and `box_free`. `rustc` will emit an error when an item is needed\n but not found in the current crate or any that it depends on.\n \n Most lang items are defined by `libcore`, but if you're trying to build\n@@ -318,4 +313,4 @@ the source code.\n   - `phantom_data`: `libcore/marker.rs`\n   - `freeze`: `libcore/marker.rs`\n   - `debug_trait`: `libcore/fmt/mod.rs`\n-  - `non_zero`: `libcore/nonzero.rs`\n\\ No newline at end of file\n+  - `non_zero`: `libcore/nonzero.rs`"}]}