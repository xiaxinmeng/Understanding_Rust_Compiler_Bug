{"sha": "f1cea3ce21eb896b0849eca0a8fd9ea4e03ab35f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYxY2VhM2NlMjFlYjg5NmIwODQ5ZWNhMGE4ZmQ5ZWE0ZTAzYWIzNWY=", "commit": {"author": {"name": "Margaret Meyerhofer", "email": "mmeyerho@andrew", "date": "2012-05-23T00:27:20Z"}, "committer": {"name": "Margaret Meyerhofer", "email": "mmeyerho@andrew", "date": "2012-05-23T00:27:20Z"}, "message": "Changed the lexer to accept #! comments on the first line.", "tree": {"sha": "d0d7277f0666b7d5e9b864d34b861df06a9aa615", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d0d7277f0666b7d5e9b864d34b861df06a9aa615"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f1cea3ce21eb896b0849eca0a8fd9ea4e03ab35f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f1cea3ce21eb896b0849eca0a8fd9ea4e03ab35f", "html_url": "https://github.com/rust-lang/rust/commit/f1cea3ce21eb896b0849eca0a8fd9ea4e03ab35f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f1cea3ce21eb896b0849eca0a8fd9ea4e03ab35f/comments", "author": null, "committer": null, "parents": [{"sha": "248e439638dbabf822bf9017eb99b44f0e1a0370", "url": "https://api.github.com/repos/rust-lang/rust/commits/248e439638dbabf822bf9017eb99b44f0e1a0370", "html_url": "https://github.com/rust-lang/rust/commit/248e439638dbabf822bf9017eb99b44f0e1a0370"}], "stats": {"total": 12, "additions": 12, "deletions": 0}, "files": [{"sha": "808fb2dffe092bb29a76b4fb5d7b50c31fe1ad0e", "filename": "src/librustsyntax/codemap.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f1cea3ce21eb896b0849eca0a8fd9ea4e03ab35f/src%2Flibrustsyntax%2Fcodemap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f1cea3ce21eb896b0849eca0a8fd9ea4e03ab35f/src%2Flibrustsyntax%2Fcodemap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustsyntax%2Fcodemap.rs?ref=f1cea3ce21eb896b0849eca0a8fd9ea4e03ab35f", "patch": "@@ -12,6 +12,7 @@ export new_filemap;\n export new_filemap_w_substr;\n export mk_substr_filename;\n export lookup_char_pos;\n+export lookup_char_pos_adj;\n export adjust_span;\n export span_to_str;\n export span_to_filename;"}, {"sha": "91013ca9a7608ea3ea1be6051ceb4b6703512f1b", "filename": "src/librustsyntax/parse/lexer.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/f1cea3ce21eb896b0849eca0a8fd9ea4e03ab35f/src%2Flibrustsyntax%2Fparse%2Flexer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f1cea3ce21eb896b0849eca0a8fd9ea4e03ab35f/src%2Flibrustsyntax%2Fparse%2Flexer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustsyntax%2Fparse%2Flexer.rs?ref=f1cea3ce21eb896b0849eca0a8fd9ea4e03ab35f", "patch": "@@ -119,6 +119,17 @@ fn consume_any_line_comment(rdr: reader) {\n           '*' { rdr.bump(); rdr.bump(); ret consume_block_comment(rdr); }\n           _ { ret; }\n         }\n+    } else if rdr.curr == '#' {\n+        if rdr.next() == '!' {\n+            let cmap = codemap::new_codemap();\n+            (*cmap).files.push(rdr.filemap);\n+            let mut loc = codemap::lookup_char_pos_adj(cmap, rdr.chpos);\n+            if loc.line == 1u && loc.col == 0u {\n+                while rdr.curr != '\\n' && !rdr.is_eof() { rdr.bump(); }\n+                loc = codemap::lookup_char_pos_adj(cmap, rdr.chpos);\n+                ret consume_whitespace_and_comments(rdr);\n+            }\n+        }\n     }\n }\n "}]}