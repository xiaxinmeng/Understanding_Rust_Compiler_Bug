{"sha": "65f2dce042182003d83b5ed2a59e0f43521869ac", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY1ZjJkY2UwNDIxODIwMDNkODNiNWVkMmE1OWUwZjQzNTIxODY5YWM=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-06-23T10:33:22Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-07-03T07:34:31Z"}, "message": "ci: add native aarch64-gnu docker builder", "tree": {"sha": "152cbd24d7700d9113f15be992f4160b63a05216", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/152cbd24d7700d9113f15be992f4160b63a05216"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/65f2dce042182003d83b5ed2a59e0f43521869ac", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE1JbYPtLJAsc22U9xPgar6Auq8ZwFAl7+34cACgkQPgar6Auq\n8Zxt5hAAq9UfnlZlw323FRPKSxB8vkP7+t5XqsulxCcGrT93VikfJ5bkqmtPTPH1\nlX34VyopYYa3S1ZGRDlSRcGzXWt3hEL2elbnu016ppA/agUpglDD/5FMbFeMIu+O\n0HMASB8lTCeLLDBCChTmPX2bpoA4WSOPh3byLYwn7q++X3jx+JeTqEOZK0Ocv9gS\nHqSRFKIjChOnqXD+xADohFtsh8qNm8Pk3D9lJAjB2yRmit1H6Kvqb+sH7xuOpwpO\nn2vAhtOs1C7ISu4tYRCivisyG17wRq+CBehJlnQVp9VqsXHnbo8EtpFbQcEbOl42\n3LCB9WjetcfKB5VWPGO8mbM3og+zof9BO9uhxYdkRSxFZ5iPP6+E03KHzM7U/b2u\nbLhbktJAZVjvy2yjLhiLAzLWS4SCPGsPRt0z9t/hUms5hM+cZpZcSpAwow6M/D3j\negjvDJ5XCxGVQ/M4HeRWGhdILmUpOo6QewGw7gdc5ZmOdt4gWh7JLWUAkyziLGqM\ntihjjLDoCkKxyMjVmiv16WwJLnWPzBaIxHlPAlzdmuLAkgXsAg2/bLOnS/fbeiJM\nDyuyAz4lZj5TmCzpgDAo9NRaBYS+M4x1thkVirEz7WLZk6K6wvo0zf3EAv+uYnzh\nPh3W0hWdiCCr/Wg/9PWo8okHFvMp56JJY6KD0N+oLTDkmnVI6RE=\n=kRxT\n-----END PGP SIGNATURE-----", "payload": "tree 152cbd24d7700d9113f15be992f4160b63a05216\nparent e1ea006701f99455647a007546eafe45a0cfe162\nauthor Pietro Albini <pietro@pietroalbini.org> 1592908402 +0200\ncommitter Pietro Albini <pietro@pietroalbini.org> 1593761671 +0200\n\nci: add native aarch64-gnu docker builder\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/65f2dce042182003d83b5ed2a59e0f43521869ac", "html_url": "https://github.com/rust-lang/rust/commit/65f2dce042182003d83b5ed2a59e0f43521869ac", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/65f2dce042182003d83b5ed2a59e0f43521869ac/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e1ea006701f99455647a007546eafe45a0cfe162", "url": "https://api.github.com/repos/rust-lang/rust/commits/e1ea006701f99455647a007546eafe45a0cfe162", "html_url": "https://github.com/rust-lang/rust/commit/e1ea006701f99455647a007546eafe45a0cfe162"}], "stats": {"total": 40, "additions": 38, "deletions": 2}, "files": [{"sha": "114ac832cf504c38c65e7574fbb9719b8998c080", "filename": "src/ci/docker/host-aarch64/aarch64-gnu/Dockerfile", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/65f2dce042182003d83b5ed2a59e0f43521869ac/src%2Fci%2Fdocker%2Fhost-aarch64%2Faarch64-gnu%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/65f2dce042182003d83b5ed2a59e0f43521869ac/src%2Fci%2Fdocker%2Fhost-aarch64%2Faarch64-gnu%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-aarch64%2Faarch64-gnu%2FDockerfile?ref=65f2dce042182003d83b5ed2a59e0f43521869ac", "patch": "@@ -0,0 +1,26 @@\n+FROM ubuntu:20.04\n+\n+RUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \\\n+  g++ \\\n+  make \\\n+  file \\\n+  curl \\\n+  ca-certificates \\\n+  python3 \\\n+  git \\\n+  cmake \\\n+  sudo \\\n+  gdb \\\n+  libssl-dev \\\n+  pkg-config \\\n+  xz-utils\n+\n+COPY scripts/sccache.sh /scripts/\n+RUN sh /scripts/sccache.sh\n+\n+ENV RUST_CONFIGURE_ARGS \\\n+ --build=aarch64-unknown-linux-gnu \\\n+ --enable-sanitizers \\\n+ --enable-profiler \\\n+ --enable-compiler-docs\n+ENV SCRIPT python3 ../x.py test"}, {"sha": "cebba57344bfdff0c151e2a7cc434aa71d4fec18", "filename": "src/ci/docker/scripts/sccache.sh", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/65f2dce042182003d83b5ed2a59e0f43521869ac/src%2Fci%2Fdocker%2Fscripts%2Fsccache.sh", "raw_url": "https://github.com/rust-lang/rust/raw/65f2dce042182003d83b5ed2a59e0f43521869ac/src%2Fci%2Fdocker%2Fscripts%2Fsccache.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fscripts%2Fsccache.sh?ref=65f2dce042182003d83b5ed2a59e0f43521869ac", "patch": "@@ -1,6 +1,16 @@\n set -ex\n \n-curl -fo /usr/local/bin/sccache \\\n-  https://ci-mirrors.rust-lang.org/rustc/2018-04-02-sccache-x86_64-unknown-linux-musl\n+case \"$(uname -m)\" in\n+    x86_64)\n+        url=\"https://ci-mirrors.rust-lang.org/rustc/2018-04-02-sccache-x86_64-unknown-linux-musl\"\n+        ;;\n+    aarch64)\n+        url=\"https://ci-mirrors.rust-lang.org/rustc/2019-12-17-sccache-aarch64-unknown-linux-gnu\"\n+        ;;\n+    *)\n+        echo \"unsupported architecture: $(uname -m)\"\n+        exit 1\n+esac\n \n+curl -fo /usr/local/bin/sccache \"${url}\"\n chmod +x /usr/local/bin/sccache"}]}