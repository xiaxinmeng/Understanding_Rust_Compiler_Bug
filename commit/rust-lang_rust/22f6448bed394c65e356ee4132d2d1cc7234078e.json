{"sha": "22f6448bed394c65e356ee4132d2d1cc7234078e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIyZjY0NDhiZWQzOTRjNjVlMzU2ZWU0MTMyZDJkMWNjNzIzNDA3OGU=", "commit": {"author": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2021-04-13T18:57:42Z"}, "committer": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2021-04-13T18:57:44Z"}, "message": "Lower async fn in traits.\n\nAn error is already created by AST validation.", "tree": {"sha": "075c8565932da3216c6d5018f908137da9eb401c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/075c8565932da3216c6d5018f908137da9eb401c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/22f6448bed394c65e356ee4132d2d1cc7234078e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/22f6448bed394c65e356ee4132d2d1cc7234078e", "html_url": "https://github.com/rust-lang/rust/commit/22f6448bed394c65e356ee4132d2d1cc7234078e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/22f6448bed394c65e356ee4132d2d1cc7234078e/comments", "author": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7953910464e073eb3876d1544a3fd5b5ba0ca49b", "url": "https://api.github.com/repos/rust-lang/rust/commits/7953910464e073eb3876d1544a3fd5b5ba0ca49b", "html_url": "https://github.com/rust-lang/rust/commit/7953910464e073eb3876d1544a3fd5b5ba0ca49b"}], "stats": {"total": 14, "additions": 11, "deletions": 3}, "files": [{"sha": "5fd8f7eb33a1fa882fdc068c3397cdaf0024dec6", "filename": "compiler/rustc_ast_lowering/src/item.rs", "status": "modified", "additions": 11, "deletions": 3, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/22f6448bed394c65e356ee4132d2d1cc7234078e/compiler%2Frustc_ast_lowering%2Fsrc%2Fitem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/22f6448bed394c65e356ee4132d2d1cc7234078e/compiler%2Frustc_ast_lowering%2Fsrc%2Fitem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Fitem.rs?ref=22f6448bed394c65e356ee4132d2d1cc7234078e", "patch": "@@ -836,9 +836,17 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                 (generics, hir::TraitItemKind::Fn(sig, hir::TraitFn::Required(names)))\n             }\n             AssocItemKind::Fn(box FnKind(_, ref sig, ref generics, Some(ref body))) => {\n-                let body_id = self.lower_fn_body_block(i.span, &sig.decl, Some(body));\n-                let (generics, sig) =\n-                    self.lower_method_sig(generics, sig, trait_item_def_id, false, None, i.id);\n+                let asyncness = sig.header.asyncness;\n+                let body_id =\n+                    self.lower_maybe_async_body(i.span, &sig.decl, asyncness, Some(&body));\n+                let (generics, sig) = self.lower_method_sig(\n+                    generics,\n+                    sig,\n+                    trait_item_def_id,\n+                    false,\n+                    asyncness.opt_return_id(),\n+                    i.id,\n+                );\n                 (generics, hir::TraitItemKind::Fn(sig, hir::TraitFn::Provided(body_id)))\n             }\n             AssocItemKind::TyAlias(box TyAliasKind(_, ref generics, ref bounds, ref default)) => {"}]}