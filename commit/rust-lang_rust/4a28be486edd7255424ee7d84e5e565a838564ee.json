{"sha": "4a28be486edd7255424ee7d84e5e565a838564ee", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRhMjhiZTQ4NmVkZDcyNTU0MjRlZTdkODRlNWU1NjVhODM4NTY0ZWU=", "commit": {"author": {"name": "topecongiro", "email": "seuchida@gmail.com", "date": "2017-05-07T22:24:32Z"}, "committer": {"name": "topecongiro", "email": "seuchida@gmail.com", "date": "2017-05-07T22:24:32Z"}, "message": "Refactor Shape", "tree": {"sha": "542b4e92ad6c15e2ee24de1fd8ae21457db2664d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/542b4e92ad6c15e2ee24de1fd8ae21457db2664d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4a28be486edd7255424ee7d84e5e565a838564ee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4a28be486edd7255424ee7d84e5e565a838564ee", "html_url": "https://github.com/rust-lang/rust/commit/4a28be486edd7255424ee7d84e5e565a838564ee", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4a28be486edd7255424ee7d84e5e565a838564ee/comments", "author": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "committer": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e923df414678e957ff932d1c45b94e01e77d003b", "url": "https://api.github.com/repos/rust-lang/rust/commits/e923df414678e957ff932d1c45b94e01e77d003b", "html_url": "https://github.com/rust-lang/rust/commit/e923df414678e957ff932d1c45b94e01e77d003b"}], "stats": {"total": 26, "additions": 6, "deletions": 20}, "files": [{"sha": "13b2df0674059d78834d17ac9ac4f817df223d45", "filename": "src/lib.rs", "status": "modified", "additions": 5, "deletions": 16, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/4a28be486edd7255424ee7d84e5e565a838564ee/src%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a28be486edd7255424ee7d84e5e565a838564ee/src%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib.rs?ref=4a28be486edd7255424ee7d84e5e565a838564ee", "patch": "@@ -298,34 +298,27 @@ impl Shape {\n     }\n \n     pub fn block_left(&self, width: usize) -> Option<Shape> {\n-        let block_shape = self.block_indent(width);\n-        Some(Shape {\n-                 width: try_opt!(block_shape.width.checked_sub(width)),\n-                 ..block_shape\n-             })\n+        self.block_indent(width).sub_width(width)\n     }\n \n     pub fn add_offset(&self, extra_width: usize) -> Shape {\n         Shape {\n-            width: self.width,\n-            indent: self.indent,\n             offset: self.offset + extra_width,\n+            ..*self\n         }\n     }\n \n     pub fn block(&self) -> Shape {\n         Shape {\n-            width: self.width,\n             indent: self.indent.block_only(),\n-            offset: self.offset,\n+            ..*self\n         }\n     }\n \n     pub fn sub_width(&self, width: usize) -> Option<Shape> {\n         Some(Shape {\n                  width: try_opt!(self.width.checked_sub(width)),\n-                 indent: self.indent,\n-                 offset: self.offset,\n+                 ..*self\n              })\n     }\n \n@@ -338,11 +331,7 @@ impl Shape {\n     }\n \n     pub fn offset_left(&self, width: usize) -> Option<Shape> {\n-        Some(Shape {\n-                 width: try_opt!(self.width.checked_sub(width)),\n-                 indent: self.indent,\n-                 offset: self.offset + width,\n-             })\n+        self.add_offset(width).sub_width(width)\n     }\n \n     pub fn used_width(&self) -> usize {"}, {"sha": "38185047b7e0140a0500e84ad11c0ec2dfb489d2", "filename": "src/visitor.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/4a28be486edd7255424ee7d84e5e565a838564ee/src%2Fvisitor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a28be486edd7255424ee7d84e5e565a838564ee/src%2Fvisitor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fvisitor.rs?ref=4a28be486edd7255424ee7d84e5e565a838564ee", "patch": "@@ -455,10 +455,7 @@ impl<'a> FmtVisitor<'a> {\n             codemap: parse_session.codemap(),\n             buffer: StringBuffer::new(),\n             last_pos: BytePos(0),\n-            block_indent: Indent {\n-                block_indent: 0,\n-                alignment: 0,\n-            },\n+            block_indent: Indent::empty(),\n             config: config,\n             failed: false,\n         }"}]}