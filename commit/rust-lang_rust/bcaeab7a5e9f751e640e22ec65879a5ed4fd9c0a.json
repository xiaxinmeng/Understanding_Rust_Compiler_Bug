{"sha": "bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJjYWVhYjdhNWU5Zjc1MWU2NDBlMjJlYzY1ODc5YTVlZDRmZDljMGE=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2018-03-11T22:25:40Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-03-11T22:25:40Z"}, "message": "Merge pull request #2527 from topecongiro/issue-2526\n\nCheck whether '\\\\'' is char literal or lifetime", "tree": {"sha": "62b470545b4fdb05d47235db0ce9be5ba927bfff", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/62b470545b4fdb05d47235db0ce9be5ba927bfff"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJapazkCRBK7hj4Ov3rIwAAdHIIADoS99/CDf7xVanVoOjFIDVG\nqcRvPiszfa+dscB+NByhejDWq6oxu6Q5ObqLKQC0e6N7p0vw3/4d1ciBMPOj1PAt\nMdicNDtbxQyBRonB4lBAraAMzSBe1h7ZyZ30H0kaaXGxzG7wRH1qyJ+ZOYzl9vdk\nAm0aUcFrw87kOyeG1+K1bGs8/1g8Eqg57GhjgFwVyQ2pr5GJelN/FCPAvIQ0A/GV\nauZMTDmLO7vv5kp9NMRUS80r+UI2kD8FDATRJudJ6iNWi/ztwAhK90v9fBmEAYmo\nJVDmusuR7uUls7BpMg82Rf/QVX2joZvoVF1UwOK9+FcWs7u8fCiKej66h/1JxGE=\n=H4RU\n-----END PGP SIGNATURE-----\n", "payload": "tree 62b470545b4fdb05d47235db0ce9be5ba927bfff\nparent af5d3cc87b443b372453f774c611ee1674460160\nparent 86a427fe32e0a4f3696f55c9f7a04a768e8ced68\nauthor Nick Cameron <nrc@ncameron.org> 1520807140 +1300\ncommitter GitHub <noreply@github.com> 1520807140 +1300\n\nMerge pull request #2527 from topecongiro/issue-2526\n\nCheck whether '\\\\'' is char literal or lifetime "}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a", "html_url": "https://github.com/rust-lang/rust/commit/bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "af5d3cc87b443b372453f774c611ee1674460160", "url": "https://api.github.com/repos/rust-lang/rust/commits/af5d3cc87b443b372453f774c611ee1674460160", "html_url": "https://github.com/rust-lang/rust/commit/af5d3cc87b443b372453f774c611ee1674460160"}, {"sha": "86a427fe32e0a4f3696f55c9f7a04a768e8ced68", "url": "https://api.github.com/repos/rust-lang/rust/commits/86a427fe32e0a4f3696f55c9f7a04a768e8ced68", "html_url": "https://github.com/rust-lang/rust/commit/86a427fe32e0a4f3696f55c9f7a04a768e8ced68"}], "stats": {"total": 47, "additions": 44, "deletions": 3}, "files": [{"sha": "23c7ee520af9b772c7b89ddab1655fa08a924545", "filename": "Cargo.lock", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a", "patch": "@@ -89,6 +89,11 @@ name = \"dtoa\"\n version = \"0.4.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n+[[package]]\n+name = \"either\"\n+version = \"1.4.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+\n [[package]]\n name = \"ena\"\n version = \"0.9.2\"\n@@ -144,6 +149,14 @@ dependencies = [\n  \"quick-error 1.2.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n+[[package]]\n+name = \"itertools\"\n+version = \"0.7.7\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+dependencies = [\n+ \"either 1.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+]\n+\n [[package]]\n name = \"itoa\"\n version = \"0.3.4\"\n@@ -362,6 +375,7 @@ dependencies = [\n  \"diff 0.1.11 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"env_logger 0.5.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"getopts 0.2.17 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"itertools 0.7.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"lazy_static 1.0.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.39 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.4.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -588,13 +602,15 @@ dependencies = [\n \"checksum derive-new 0.5.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"92f8b8e1d6c8a5f5ea0849a0e4c55941576115c62d3fc425e96918bbbeb3d3c2\"\n \"checksum diff 0.1.11 (registry+https://github.com/rust-lang/crates.io-index)\" = \"3c2b69f912779fbb121ceb775d74d51e915af17aaebc38d28a592843a2dd0a3a\"\n \"checksum dtoa 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"09c3753c3db574d215cba4ea76018483895d7bff25a31b49ba45db21c48e50ab\"\n+\"checksum either 1.4.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"740178ddf48b1a9e878e6d6509a1442a2d42fd2928aae8e7a6f8a36fb01981b3\"\n \"checksum ena 0.9.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f8b449f3b18c89d2dbe40548d2ee4fa58ea0a08b761992da6ecb9788e4688834\"\n \"checksum env_logger 0.5.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f3cc21490995c841d68e00276eba02071ebb269ec24011d5728bd00eabd39e31\"\n \"checksum error-chain 0.11.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ff511d5dc435d703f4971bc399647c9bc38e20cb41452e3b9feb4765419ed3f3\"\n \"checksum fuchsia-zircon 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2e9763c69ebaae630ba35f74888db465e49e259ba1bc0eda7d06f4a067615d82\"\n \"checksum fuchsia-zircon-sys 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"3dcaa9ae7725d12cdb85b3ad99a434db70b468c09ded17e012d86b5c1010f7a7\"\n \"checksum getopts 0.2.17 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b900c08c1939860ce8b54dc6a89e26e00c04c380fd0e09796799bd7f12861e05\"\n \"checksum humantime 1.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"0484fda3e7007f2a4a0d9c3a703ca38c71c54c55602ce4660c419fd32e188c9e\"\n+\"checksum itertools 0.7.7 (registry+https://github.com/rust-lang/crates.io-index)\" = \"23d53b4c7394338044c3b9c8c5b2caaf7b40ae049ecd321578ebdc2e13738cd1\"\n \"checksum itoa 0.3.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"8324a32baf01e2ae060e9de58ed0bc2320c9a2833491ee36cd3b4c414de4db8c\"\n \"checksum kernel32-sys 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7507624b29483431c0ba2d82aece8ca6cdba9382bff4ddd0f7490560c056098d\"\n \"checksum lazy_static 1.0.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"c8f31047daa365f19be14b47c29df4f7c3b581832407daabe6ae77397619237d\""}, {"sha": "72e8301432404275762aa2c7b7565790507969c8", "filename": "Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a/Cargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a/Cargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.toml?ref=bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a", "patch": "@@ -32,6 +32,7 @@ cargo-fmt = []\n rustfmt-format-diff = []\n \n [dependencies]\n+itertools = \"0.7\"\n toml = \"0.4\"\n serde = \"1.0\"\n serde_derive = \"1.0\""}, {"sha": "d53d5a9d4aa395f8d8b42d9a762202f3af3baaf4", "filename": "src/comment.rs", "status": "modified", "additions": 18, "deletions": 3, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a/src%2Fcomment.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a/src%2Fcomment.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomment.rs?ref=bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a", "patch": "@@ -12,6 +12,7 @@\n \n use std::{self, iter, borrow::Cow};\n \n+use itertools::{multipeek, MultiPeek};\n use syntax::codemap::Span;\n \n use config::Config;\n@@ -693,7 +694,7 @@ where\n     T: Iterator,\n     T::Item: RichChar,\n {\n-    base: iter::Peekable<T>,\n+    base: MultiPeek<T>,\n     status: CharClassesStatus,\n }\n \n@@ -785,7 +786,7 @@ where\n {\n     pub fn new(base: T) -> CharClasses<T> {\n         CharClasses {\n-            base: base.peekable(),\n+            base: multipeek(base),\n             status: CharClassesStatus::Normal,\n         }\n     }\n@@ -829,7 +830,21 @@ where\n                     char_kind = FullCodeCharKind::InString;\n                     CharClassesStatus::LitString\n                 }\n-                '\\'' => CharClassesStatus::LitChar,\n+                '\\'' => {\n+                    // HACK: Work around mut borrow.\n+                    match self.base.peek() {\n+                        Some(next) if next.get_char() == '\\\\' => {\n+                            self.status = CharClassesStatus::LitChar;\n+                            return Some((char_kind, item));\n+                        }\n+                        _ => (),\n+                    }\n+\n+                    match self.base.peek() {\n+                        Some(next) if next.get_char() == '\\'' => CharClassesStatus::LitChar,\n+                        _ => CharClassesStatus::Normal,\n+                    }\n+                }\n                 '/' => match self.base.peek() {\n                     Some(next) if next.get_char() == '*' => {\n                         self.status = CharClassesStatus::BlockCommentOpening(1);"}, {"sha": "2a18bb1e572c9421aa76c2c094850fdbc2d0b4f5", "filename": "src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a/src%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a/src%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib.rs?ref=bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a", "patch": "@@ -16,6 +16,7 @@\n #[macro_use]\n extern crate derive_new;\n extern crate diff;\n+extern crate itertools;\n #[macro_use]\n extern crate log;\n extern crate regex;"}, {"sha": "7dd58aba3187df574bdb689c9bfaccdeebc2091a", "filename": "tests/target/issue-2526.rs", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a/tests%2Ftarget%2Fissue-2526.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a/tests%2Ftarget%2Fissue-2526.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-2526.rs?ref=bcaeab7a5e9f751e640e22ec65879a5ed4fd9c0a", "patch": "@@ -0,0 +1,8 @@\n+// Test that rustfmt will not warn about comments exceeding max width around lifetime.\n+// See #2526.\n+\n+// comment comment comment comment comment comment comment comment comment comment comment comment comment\n+fn foo() -> F<'a> {\n+    bar()\n+}\n+// comment comment comment comment comment comment comment comment comment comment comment comment comment"}]}