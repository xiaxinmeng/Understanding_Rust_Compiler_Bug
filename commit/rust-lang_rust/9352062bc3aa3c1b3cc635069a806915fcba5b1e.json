{"sha": "9352062bc3aa3c1b3cc635069a806915fcba5b1e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjkzNTIwNjJiYzNhYTNjMWIzY2M2MzUwNjlhODA2OTE1ZmNiYTViMWU=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-10-01T17:42:02Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-10-01T17:42:02Z"}, "message": "build-manifest: use BufReader", "tree": {"sha": "3c0b7fb9b6f9d1b418890aac2242db6ef84f6a18", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3c0b7fb9b6f9d1b418890aac2242db6ef84f6a18"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9352062bc3aa3c1b3cc635069a806915fcba5b1e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE1JbYPtLJAsc22U9xPgar6Auq8ZwFAl92FPMACgkQPgar6Auq\n8ZylzhAAmWk8aMxW8E2SKXeoZgEfi8NkeFeEEwEGtDvsKbdqfXk8ln64saix4HwI\nfJgBPG937KgmxiYV/2Hi3HrXhcxO96Uswn7HXzh109hNfo7t0wgXmKrtRbZayeri\n31WV92qeB8K+NxIMuC0DcHPe4/8SRWce1oNYlx+SW2LaDcn+Jsgu53YPFth6lKs/\nkCrK9VlrkvoFXVUQ1PDzAIZI7x94nrrHuHpxBuW7kPOqo71f3q9z0UMPCCZVR8jP\nZvW6RuNujdppRb5tHBBA/3EPjl5uS89hLwOgjCvSiq4GQL0QC2kVsJxuzCazPgK6\nFdWIizR7WTC1zUgopdGDpYV6AVKOnU4bISHHfRP31Xq2n/F49wlMOvZB62QoysXe\nRGHigp9eEVNeuSDpkJAXSJTIFZIgHtGCvZe2L5nvp0SPYT1jKwqVepugetr5q+Re\nuaQNyIdyb7KvvQcCKGpPGrr7aF481u/PS3x41UYYuKT22D+9frSwvM1U5BiC1KXC\nitrQKF090m5qfNPnFuOIo1CqRfELyU5GX/xHeDFH1qy5/kD4188yKM/GBj2fEQx/\nkEU6Zn+x32sdtZtTY5eHbooj4+13do8OJlUqIzXF0sem9pYPR2TxWDTqvlLCizfQ\n54WrvuifviqJuyJvRhdg9AnAJ+eg9tIvSNJF6apMIxnjvtKljV0=\n=UFcc\n-----END PGP SIGNATURE-----", "payload": "tree 3c0b7fb9b6f9d1b418890aac2242db6ef84f6a18\nparent fde113591680c96459abdc4aae5d2b0dc21da87b\nauthor Pietro Albini <pietro@pietroalbini.org> 1601574122 +0200\ncommitter Pietro Albini <pietro@pietroalbini.org> 1601574122 +0200\n\nbuild-manifest: use BufReader\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9352062bc3aa3c1b3cc635069a806915fcba5b1e", "html_url": "https://github.com/rust-lang/rust/commit/9352062bc3aa3c1b3cc635069a806915fcba5b1e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9352062bc3aa3c1b3cc635069a806915fcba5b1e/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fde113591680c96459abdc4aae5d2b0dc21da87b", "url": "https://api.github.com/repos/rust-lang/rust/commits/fde113591680c96459abdc4aae5d2b0dc21da87b", "html_url": "https://github.com/rust-lang/rust/commit/fde113591680c96459abdc4aae5d2b0dc21da87b"}], "stats": {"total": 4, "additions": 2, "deletions": 2}, "files": [{"sha": "6524398f5babf61fa19a301c6e5b6c02bd9cfb4d", "filename": "src/tools/build-manifest/src/main.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9352062bc3aa3c1b3cc635069a806915fcba5b1e/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9352062bc3aa3c1b3cc635069a806915fcba5b1e/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs?ref=9352062bc3aa3c1b3cc635069a806915fcba5b1e", "patch": "@@ -15,7 +15,7 @@ use std::collections::{BTreeMap, HashMap, HashSet};\n use std::env;\n use std::error::Error;\n use std::fs::{self, File};\n-use std::io::{self, Read, Write};\n+use std::io::{self, BufReader, Read, Write};\n use std::path::{Path, PathBuf};\n use std::process::{Command, Stdio};\n use std::sync::Mutex;\n@@ -632,7 +632,7 @@ impl Builder {\n }\n \n fn fetch_hash(path: &Path) -> Result<String, Box<dyn Error>> {\n-    let mut file = File::open(path)?;\n+    let mut file = BufReader::new(File::open(path)?);\n     let mut sha256 = sha2::Sha256::default();\n     std::io::copy(&mut file, &mut sha256)?;\n     Ok(hex::encode(sha256.finalize()))"}]}