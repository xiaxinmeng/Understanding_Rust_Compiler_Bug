{"sha": "9f4d5b4be10ce9683569a0bd55f555d30f70b5a5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjlmNGQ1YjRiZTEwY2U5NjgzNTY5YTBiZDU1ZjU1NWQzMGY3MGI1YTU=", "commit": {"author": {"name": "Bj\u00f6rn Steinbrink", "email": "bsteinbr@gmail.com", "date": "2015-07-08T12:49:55Z"}, "committer": {"name": "Bj\u00f6rn Steinbrink", "email": "bsteinbr@gmail.com", "date": "2015-07-08T12:49:55Z"}, "message": "Improve PartialEq for slices\n\nExploiting the fact that getting the length of the slices is known, we\ncan use a counted loop instead of iterators, which means that we only\nneed a single counter, instead of having to increment and check one\npointer for each iterator.\n\nBenchmarks comparing vectors with 100,000 elements:\n\nBefore:\n\n```\nrunning 8 tests\ntest eq1_u8  ... bench:      66,757 ns/iter (+/- 113)\ntest eq2_u16 ... bench:     111,267 ns/iter (+/- 149)\ntest eq3_u32 ... bench:     126,282 ns/iter (+/- 111)\ntest eq4_u64 ... bench:     126,418 ns/iter (+/- 155)\ntest ne1_u8  ... bench:      88,990 ns/iter (+/- 161)\ntest ne2_u16 ... bench:      89,126 ns/iter (+/- 265)\ntest ne3_u32 ... bench:      96,901 ns/iter (+/- 92)\ntest ne4_u64 ... bench:      96,750 ns/iter (+/- 137)\n```\n\nAfter:\n\n```\nrunning 8 tests\ntest eq1_u8  ... bench:      46,413 ns/iter (+/- 521)\ntest eq2_u16 ... bench:      46,500 ns/iter (+/- 74)\ntest eq3_u32 ... bench:      50,059 ns/iter (+/- 92)\ntest eq4_u64 ... bench:      54,001 ns/iter (+/- 92)\ntest ne1_u8  ... bench:      47,595 ns/iter (+/- 53)\ntest ne2_u16 ... bench:      47,521 ns/iter (+/- 59)\ntest ne3_u32 ... bench:      44,889 ns/iter (+/- 74)\ntest ne4_u64 ... bench:      47,775 ns/iter (+/- 68)\n```", "tree": {"sha": "fcae4b51321a5c16d61fc376191d1beef4a53670", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fcae4b51321a5c16d61fc376191d1beef4a53670"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9f4d5b4be10ce9683569a0bd55f555d30f70b5a5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9f4d5b4be10ce9683569a0bd55f555d30f70b5a5", "html_url": "https://github.com/rust-lang/rust/commit/9f4d5b4be10ce9683569a0bd55f555d30f70b5a5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9f4d5b4be10ce9683569a0bd55f555d30f70b5a5/comments", "author": {"login": "dotdash", "id": 230962, "node_id": "MDQ6VXNlcjIzMDk2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dotdash", "html_url": "https://github.com/dotdash", "followers_url": "https://api.github.com/users/dotdash/followers", "following_url": "https://api.github.com/users/dotdash/following{/other_user}", "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}", "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions", "organizations_url": "https://api.github.com/users/dotdash/orgs", "repos_url": "https://api.github.com/users/dotdash/repos", "events_url": "https://api.github.com/users/dotdash/events{/privacy}", "received_events_url": "https://api.github.com/users/dotdash/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dotdash", "id": 230962, "node_id": "MDQ6VXNlcjIzMDk2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dotdash", "html_url": "https://github.com/dotdash", "followers_url": "https://api.github.com/users/dotdash/followers", "following_url": "https://api.github.com/users/dotdash/following{/other_user}", "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}", "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions", "organizations_url": "https://api.github.com/users/dotdash/orgs", "repos_url": "https://api.github.com/users/dotdash/repos", "events_url": "https://api.github.com/users/dotdash/events{/privacy}", "received_events_url": "https://api.github.com/users/dotdash/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7b7853897ba1469d7bb47fb6e4b877b6741fbb4b", "url": "https://api.github.com/repos/rust-lang/rust/commits/7b7853897ba1469d7bb47fb6e4b877b6741fbb4b", "html_url": "https://github.com/rust-lang/rust/commit/7b7853897ba1469d7bb47fb6e4b877b6741fbb4b"}], "stats": {"total": 26, "additions": 22, "deletions": 4}, "files": [{"sha": "78cda8c2c7204b7d637fd34d76eb48f4ea9d4003", "filename": "src/libcore/slice.rs", "status": "modified", "additions": 22, "deletions": 4, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/9f4d5b4be10ce9683569a0bd55f555d30f70b5a5/src%2Flibcore%2Fslice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9f4d5b4be10ce9683569a0bd55f555d30f70b5a5/src%2Flibcore%2Fslice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fslice.rs?ref=9f4d5b4be10ce9683569a0bd55f555d30f70b5a5", "patch": "@@ -1459,12 +1459,30 @@ pub mod bytes {\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n impl<A, B> PartialEq<[B]> for [A] where A: PartialEq<B> {\n     fn eq(&self, other: &[B]) -> bool {\n-        self.len() == other.len() &&\n-            order::eq(self.iter(), other.iter())\n+        if self.len() != other.len() {\n+            return false;\n+        }\n+\n+        for i in 0..self.len() {\n+            if !self[i].eq(&other[i]) {\n+                return false;\n+            }\n+        }\n+\n+        true\n     }\n     fn ne(&self, other: &[B]) -> bool {\n-        self.len() != other.len() ||\n-            order::ne(self.iter(), other.iter())\n+        if self.len() != other.len() {\n+            return true;\n+        }\n+\n+        for i in 0..self.len() {\n+            if self[i].ne(&other[i]) {\n+                return true;\n+            }\n+        }\n+\n+        false\n     }\n }\n "}]}