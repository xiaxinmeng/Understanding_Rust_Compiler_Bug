{"sha": "94d20635779d83f4f3267ef8a65b9bf5201dd554", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk0ZDIwNjM1Nzc5ZDgzZjRmMzI2N2VmOGE2NWI5YmY1MjAxZGQ1NTQ=", "commit": {"author": {"name": "Tim Chevalier", "email": "chevalier@alum.wellesley.edu", "date": "2012-01-19T22:28:58Z"}, "committer": {"name": "Tim Chevalier", "email": "chevalier@alum.wellesley.edu", "date": "2012-01-19T22:44:40Z"}, "message": "Handle log expressions with a _|_-typed level\n\nIf we have log(foo, quux) where foo:_|_, just translate foo and\nignore the rest of the expression.\n\nCloses #1459", "tree": {"sha": "5e9127a1a8ca37aa788f4b56351502a941af4289", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5e9127a1a8ca37aa788f4b56351502a941af4289"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/94d20635779d83f4f3267ef8a65b9bf5201dd554", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/94d20635779d83f4f3267ef8a65b9bf5201dd554", "html_url": "https://github.com/rust-lang/rust/commit/94d20635779d83f4f3267ef8a65b9bf5201dd554", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/94d20635779d83f4f3267ef8a65b9bf5201dd554/comments", "author": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "committer": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "840a057556dcc68ddb8cb82003419c8a0b3f7cd6", "url": "https://api.github.com/repos/rust-lang/rust/commits/840a057556dcc68ddb8cb82003419c8a0b3f7cd6", "html_url": "https://github.com/rust-lang/rust/commit/840a057556dcc68ddb8cb82003419c8a0b3f7cd6"}], "stats": {"total": 10, "additions": 10, "deletions": 0}, "files": [{"sha": "7435c30c5bf7c98ea3a77ab1a6acee751944cc93", "filename": "src/comp/middle/trans.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/94d20635779d83f4f3267ef8a65b9bf5201dd554/src%2Fcomp%2Fmiddle%2Ftrans.rs", "raw_url": "https://github.com/rust-lang/rust/raw/94d20635779d83f4f3267ef8a65b9bf5201dd554/src%2Fcomp%2Fmiddle%2Ftrans.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Ftrans.rs?ref=94d20635779d83f4f3267ef8a65b9bf5201dd554", "patch": "@@ -3700,7 +3700,13 @@ fn load_if_immediate(cx: @block_ctxt, v: ValueRef, t: ty::t) -> ValueRef {\n fn trans_log(lvl: @ast::expr, cx: @block_ctxt, e: @ast::expr) -> @block_ctxt {\n     let ccx = bcx_ccx(cx);\n     let lcx = cx.fcx.lcx;\n+    let tcx = ccx.tcx;\n     let modname = str::connect(lcx.module_path, \"::\");\n+\n+    if ty::type_is_bot(tcx, ty::expr_ty(tcx, lvl)) {\n+       ret trans_expr(cx, lvl, ignore);\n+    }\n+\n     let global = if lcx.ccx.module_data.contains_key(modname) {\n         lcx.ccx.module_data.get(modname)\n     } else {"}, {"sha": "0fc6d8f697a2b5784139248f941e3e93076efdd4", "filename": "src/test/run-fail/issue-1459.rs", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/94d20635779d83f4f3267ef8a65b9bf5201dd554/src%2Ftest%2Frun-fail%2Fissue-1459.rs", "raw_url": "https://github.com/rust-lang/rust/raw/94d20635779d83f4f3267ef8a65b9bf5201dd554/src%2Ftest%2Frun-fail%2Fissue-1459.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-fail%2Fissue-1459.rs?ref=94d20635779d83f4f3267ef8a65b9bf5201dd554", "patch": "@@ -0,0 +1,4 @@\n+// error-pattern:roflcopter\n+fn main() {\n+    log (fail \"roflcopter\", 2);\n+}"}]}