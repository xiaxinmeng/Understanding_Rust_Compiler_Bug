{"sha": "ec17be2656fc69e212d9079f79322a68a3cfbc19", "node_id": "C_kwDOAAsO6NoAKGVjMTdiZTI2NTZmYzY5ZTIxMmQ5MDc5Zjc5MzIyYTY4YTNjZmJjMTk", "commit": {"author": {"name": "Jack Huey", "email": "31162821+jackh726@users.noreply.github.com", "date": "2022-09-16T21:08:35Z"}, "committer": {"name": "Jack Huey", "email": "31162821+jackh726@users.noreply.github.com", "date": "2022-09-16T21:08:35Z"}, "message": "Add outlives_constraint to BlameConstraint", "tree": {"sha": "38ec55fb3c53a3102f79019a0f603ed291d8a2b4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/38ec55fb3c53a3102f79019a0f603ed291d8a2b4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ec17be2656fc69e212d9079f79322a68a3cfbc19", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ec17be2656fc69e212d9079f79322a68a3cfbc19", "html_url": "https://github.com/rust-lang/rust/commit/ec17be2656fc69e212d9079f79322a68a3cfbc19", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ec17be2656fc69e212d9079f79322a68a3cfbc19/comments", "author": {"login": "jackh726", "id": 31162821, "node_id": "MDQ6VXNlcjMxMTYyODIx", "avatar_url": "https://avatars.githubusercontent.com/u/31162821?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackh726", "html_url": "https://github.com/jackh726", "followers_url": "https://api.github.com/users/jackh726/followers", "following_url": "https://api.github.com/users/jackh726/following{/other_user}", "gists_url": "https://api.github.com/users/jackh726/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackh726/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackh726/subscriptions", "organizations_url": "https://api.github.com/users/jackh726/orgs", "repos_url": "https://api.github.com/users/jackh726/repos", "events_url": "https://api.github.com/users/jackh726/events{/privacy}", "received_events_url": "https://api.github.com/users/jackh726/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jackh726", "id": 31162821, "node_id": "MDQ6VXNlcjMxMTYyODIx", "avatar_url": "https://avatars.githubusercontent.com/u/31162821?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackh726", "html_url": "https://github.com/jackh726", "followers_url": "https://api.github.com/users/jackh726/followers", "following_url": "https://api.github.com/users/jackh726/following{/other_user}", "gists_url": "https://api.github.com/users/jackh726/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackh726/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackh726/subscriptions", "organizations_url": "https://api.github.com/users/jackh726/orgs", "repos_url": "https://api.github.com/users/jackh726/repos", "events_url": "https://api.github.com/users/jackh726/events{/privacy}", "received_events_url": "https://api.github.com/users/jackh726/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "67653292beccfd3b88d13d9060d4e84c4a261f63", "url": "https://api.github.com/repos/rust-lang/rust/commits/67653292beccfd3b88d13d9060d4e84c4a261f63", "html_url": "https://github.com/rust-lang/rust/commit/67653292beccfd3b88d13d9060d4e84c4a261f63"}], "stats": {"total": 15, "additions": 9, "deletions": 6}, "files": [{"sha": "c5e0e41d042979148e7fffd56badbdfa9c2737aa", "filename": "compiler/rustc_borrowck/src/diagnostics/explain_borrow.rs", "status": "modified", "additions": 6, "deletions": 5, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/ec17be2656fc69e212d9079f79322a68a3cfbc19/compiler%2Frustc_borrowck%2Fsrc%2Fdiagnostics%2Fexplain_borrow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ec17be2656fc69e212d9079f79322a68a3cfbc19/compiler%2Frustc_borrowck%2Fsrc%2Fdiagnostics%2Fexplain_borrow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Fdiagnostics%2Fexplain_borrow.rs?ref=ec17be2656fc69e212d9079f79322a68a3cfbc19", "patch": "@@ -310,11 +310,12 @@ impl<'cx, 'tcx> MirBorrowckCtxt<'cx, 'tcx> {\n         borrow_region: RegionVid,\n         outlived_region: RegionVid,\n     ) -> (ConstraintCategory<'tcx>, bool, Span, Option<RegionName>) {\n-        let BlameConstraint { category, from_closure, cause, variance_info: _ } = self\n-            .regioncx\n-            .best_blame_constraint(borrow_region, NllRegionVariableOrigin::FreeRegion, |r| {\n-                self.regioncx.provides_universal_region(r, borrow_region, outlived_region)\n-            });\n+        let blame_constraint = self.regioncx.best_blame_constraint(\n+            borrow_region,\n+            NllRegionVariableOrigin::FreeRegion,\n+            |r| self.regioncx.provides_universal_region(r, borrow_region, outlived_region),\n+        );\n+        let BlameConstraint { category, from_closure, cause, .. } = blame_constraint;\n \n         let outlived_fr_name = self.give_region_a_name(outlived_region);\n "}, {"sha": "2bf9308c142ad708012908d3b4a20ae7b7d5c0dc", "filename": "compiler/rustc_borrowck/src/diagnostics/region_errors.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ec17be2656fc69e212d9079f79322a68a3cfbc19/compiler%2Frustc_borrowck%2Fsrc%2Fdiagnostics%2Fregion_errors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ec17be2656fc69e212d9079f79322a68a3cfbc19/compiler%2Frustc_borrowck%2Fsrc%2Fdiagnostics%2Fregion_errors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Fdiagnostics%2Fregion_errors.rs?ref=ec17be2656fc69e212d9079f79322a68a3cfbc19", "patch": "@@ -354,7 +354,7 @@ impl<'a, 'tcx> MirBorrowckCtxt<'a, 'tcx> {\n     ) {\n         debug!(\"report_region_error(fr={:?}, outlived_fr={:?})\", fr, outlived_fr);\n \n-        let BlameConstraint { category, cause, variance_info, from_closure: _ } =\n+        let BlameConstraint { category, cause, variance_info, .. } =\n             self.regioncx.best_blame_constraint(fr, fr_origin, |r| {\n                 self.regioncx.provides_universal_region(r, fr, outlived_fr)\n             });"}, {"sha": "c147a0708f45c466631520efb6cd69cb2756fa9b", "filename": "compiler/rustc_borrowck/src/region_infer/mod.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ec17be2656fc69e212d9079f79322a68a3cfbc19/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ec17be2656fc69e212d9079f79322a68a3cfbc19/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fmod.rs?ref=ec17be2656fc69e212d9079f79322a68a3cfbc19", "patch": "@@ -2073,6 +2073,7 @@ impl<'tcx> RegionInferenceContext<'tcx> {\n                     from_closure,\n                     cause: ObligationCause::new(span, CRATE_HIR_ID, cause_code),\n                     variance_info: constraint.variance_info,\n+                    outlives_constraint: *constraint,\n                 }\n             })\n             .collect();\n@@ -2328,4 +2329,5 @@ pub struct BlameConstraint<'tcx> {\n     pub from_closure: bool,\n     pub cause: ObligationCause<'tcx>,\n     pub variance_info: ty::VarianceDiagInfo<'tcx>,\n+    pub outlives_constraint: OutlivesConstraint<'tcx>,\n }"}]}