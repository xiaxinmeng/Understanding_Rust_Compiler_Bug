{"sha": "33500a2bbfec4482e0f149eafdeb9e111feeb5fc", "node_id": "MDY6Q29tbWl0NzI0NzEyOjMzNTAwYTJiYmZlYzQ0ODJlMGYxNDllYWZkZWI5ZTExMWZlZWI1ZmM=", "commit": {"author": {"name": "Dylan DPC", "email": "dylan.dpc@gmail.com", "date": "2020-04-16T14:34:23Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-04-16T14:34:23Z"}, "message": "Rollup merge of #70566 - jumbatm:exceeding-bitshifts-constprop, r=RalfJung\n\nDon't bail out before linting in generic contexts.\n\nFixes #69021.\n\ncc #70017\n\nr? @RalfJung", "tree": {"sha": "af5cf460b8ea1de68a3534c437c9ad080e928cea", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/af5cf460b8ea1de68a3534c437c9ad080e928cea"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/33500a2bbfec4482e0f149eafdeb9e111feeb5fc", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJemGzvCRBK7hj4Ov3rIwAAdHIIAE2Q1g05MJL4M2WymIAg966K\nbNOGcjgINi4cbFtG9ZVyJ3ELM3ppjs0PtSUYtiyfjZWG84/I2BEWZWo/sjNaQXdY\nXsTslvQ0jka+lYoVG0OGdBQC8ItHraGbaeaFRRU4E1Onl7YuCZGZ7+6L15mKv5pf\nlItrM9nuKyzlokwGbc1vxKdRQgmM66TnKgKsakraHQoIrLD3MFrbnhuV0C5zOCmt\nRhq56RJsJNZuHjxieZxarfN/oYHD+ZQ6egGFAhkM5/ViKjr9kTHH/clTOBzubkSX\no0auni+F9DItDpXokykk2vNksQnVmFH9Y96rjWapcIaUUSGw3D+BlHy9lUwkdFA=\n=S2Yf\n-----END PGP SIGNATURE-----\n", "payload": "tree af5cf460b8ea1de68a3534c437c9ad080e928cea\nparent 4e4d49d60fd696c4036d438292673a2d7fd34519\nparent ed73023a5026f02595eff3c158770fded37944e1\nauthor Dylan DPC <dylan.dpc@gmail.com> 1587047663 +0200\ncommitter GitHub <noreply@github.com> 1587047663 +0200\n\nRollup merge of #70566 - jumbatm:exceeding-bitshifts-constprop, r=RalfJung\n\nDon't bail out before linting in generic contexts.\n\nFixes #69021.\n\ncc #70017\n\nr? @RalfJung\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/33500a2bbfec4482e0f149eafdeb9e111feeb5fc", "html_url": "https://github.com/rust-lang/rust/commit/33500a2bbfec4482e0f149eafdeb9e111feeb5fc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/33500a2bbfec4482e0f149eafdeb9e111feeb5fc/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4e4d49d60fd696c4036d438292673a2d7fd34519", "url": "https://api.github.com/repos/rust-lang/rust/commits/4e4d49d60fd696c4036d438292673a2d7fd34519", "html_url": "https://github.com/rust-lang/rust/commit/4e4d49d60fd696c4036d438292673a2d7fd34519"}, {"sha": "ed73023a5026f02595eff3c158770fded37944e1", "url": "https://api.github.com/repos/rust-lang/rust/commits/ed73023a5026f02595eff3c158770fded37944e1", "html_url": "https://github.com/rust-lang/rust/commit/ed73023a5026f02595eff3c158770fded37944e1"}], "stats": {"total": 248, "additions": 133, "deletions": 115}, "files": [{"sha": "cf1c70241bc6eb91ff90a889186b3a9733881e08", "filename": "src/librustc_mir/transform/const_prop.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/33500a2bbfec4482e0f149eafdeb9e111feeb5fc/src%2Flibrustc_mir%2Ftransform%2Fconst_prop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/33500a2bbfec4482e0f149eafdeb9e111feeb5fc/src%2Flibrustc_mir%2Ftransform%2Fconst_prop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Ftransform%2Fconst_prop.rs?ref=33500a2bbfec4482e0f149eafdeb9e111feeb5fc", "patch": "@@ -581,11 +581,6 @@ impl<'mir, 'tcx> ConstPropagator<'mir, 'tcx> {\n             return None;\n         }\n \n-        // FIXME we need to revisit this for #67176\n-        if rvalue.needs_subst() {\n-            return None;\n-        }\n-\n         // Perform any special handling for specific Rvalue types.\n         // Generally, checks here fall into one of two categories:\n         //   1. Additional checking to provide useful lints to the user\n@@ -626,6 +621,11 @@ impl<'mir, 'tcx> ConstPropagator<'mir, 'tcx> {\n             _ => {}\n         }\n \n+        // FIXME we need to revisit this for #67176\n+        if rvalue.needs_subst() {\n+            return None;\n+        }\n+\n         self.use_ecx(|this| {\n             trace!(\"calling eval_rvalue_into_place(rvalue = {:?}, place = {:?})\", rvalue, place);\n             this.ecx.eval_rvalue_into_place(rvalue, place)?;"}, {"sha": "a2fb5ad8b8b8b8a38d07bd812b1d1444d64f39a6", "filename": "src/test/ui/lint/lint-exceeding-bitshifts.noopt.stderr", "status": "modified", "additions": 34, "deletions": 28, "changes": 62, "blob_url": "https://github.com/rust-lang/rust/blob/33500a2bbfec4482e0f149eafdeb9e111feeb5fc/src%2Ftest%2Fui%2Flint%2Flint-exceeding-bitshifts.noopt.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/33500a2bbfec4482e0f149eafdeb9e111feeb5fc/src%2Ftest%2Fui%2Flint%2Flint-exceeding-bitshifts.noopt.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-exceeding-bitshifts.noopt.stderr?ref=33500a2bbfec4482e0f149eafdeb9e111feeb5fc", "patch": "@@ -1,146 +1,152 @@\n-error: this arithmetic operation will overflow\n-  --> $DIR/lint-exceeding-bitshifts.rs:22:13\n+warning: this arithmetic operation will overflow\n+  --> $DIR/lint-exceeding-bitshifts.rs:18:20\n    |\n-LL |     let _ = x << 42;\n-   |             ^^^^^^^ attempt to shift left with overflow\n+LL |     const N: i32 = T::N << 42;\n+   |                    ^^^^^^^^^^ attempt to shift left with overflow\n    |\n note: the lint level is defined here\n   --> $DIR/lint-exceeding-bitshifts.rs:9:9\n    |\n-LL | #![deny(arithmetic_overflow, const_err)]\n+LL | #![warn(arithmetic_overflow, const_err)]\n    |         ^^^^^^^^^^^^^^^^^^^\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n+  --> $DIR/lint-exceeding-bitshifts.rs:22:13\n+   |\n+LL |     let _ = x << 42;\n+   |             ^^^^^^^ attempt to shift left with overflow\n+\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:27:15\n    |\n LL |       let n = 1u8 << 8;\n    |               ^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:29:15\n    |\n LL |       let n = 1u16 << 16;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:31:15\n    |\n LL |       let n = 1u32 << 32;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:33:15\n    |\n LL |       let n = 1u64 << 64;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:35:15\n    |\n LL |       let n = 1i8 << 8;\n    |               ^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:37:15\n    |\n LL |       let n = 1i16 << 16;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:39:15\n    |\n LL |       let n = 1i32 << 32;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:41:15\n    |\n LL |       let n = 1i64 << 64;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:44:15\n    |\n LL |       let n = 1u8 >> 8;\n    |               ^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:46:15\n    |\n LL |       let n = 1u16 >> 16;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:48:15\n    |\n LL |       let n = 1u32 >> 32;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:50:15\n    |\n LL |       let n = 1u64 >> 64;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:52:15\n    |\n LL |       let n = 1i8 >> 8;\n    |               ^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:54:15\n    |\n LL |       let n = 1i16 >> 16;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:56:15\n    |\n LL |       let n = 1i32 >> 32;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:58:15\n    |\n LL |       let n = 1i64 >> 64;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:62:15\n    |\n LL |       let n = n << 8;\n    |               ^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:64:15\n    |\n LL |       let n = 1u8 << -8;\n    |               ^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:69:15\n    |\n LL |       let n = 1u8 << (4+4);\n    |               ^^^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:71:15\n    |\n LL |       let n = 1i64 >> [64][0];\n    |               ^^^^^^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:77:15\n    |\n LL |       let n = 1_isize << BITS;\n    |               ^^^^^^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:78:15\n    |\n LL |       let n = 1_usize << BITS;\n    |               ^^^^^^^^^^^^^^^ attempt to shift left with overflow\n \n-error: aborting due to 23 previous errors\n+warning: 24 warnings emitted\n "}, {"sha": "a2fb5ad8b8b8b8a38d07bd812b1d1444d64f39a6", "filename": "src/test/ui/lint/lint-exceeding-bitshifts.opt.stderr", "status": "modified", "additions": 34, "deletions": 28, "changes": 62, "blob_url": "https://github.com/rust-lang/rust/blob/33500a2bbfec4482e0f149eafdeb9e111feeb5fc/src%2Ftest%2Fui%2Flint%2Flint-exceeding-bitshifts.opt.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/33500a2bbfec4482e0f149eafdeb9e111feeb5fc/src%2Ftest%2Fui%2Flint%2Flint-exceeding-bitshifts.opt.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-exceeding-bitshifts.opt.stderr?ref=33500a2bbfec4482e0f149eafdeb9e111feeb5fc", "patch": "@@ -1,146 +1,152 @@\n-error: this arithmetic operation will overflow\n-  --> $DIR/lint-exceeding-bitshifts.rs:22:13\n+warning: this arithmetic operation will overflow\n+  --> $DIR/lint-exceeding-bitshifts.rs:18:20\n    |\n-LL |     let _ = x << 42;\n-   |             ^^^^^^^ attempt to shift left with overflow\n+LL |     const N: i32 = T::N << 42;\n+   |                    ^^^^^^^^^^ attempt to shift left with overflow\n    |\n note: the lint level is defined here\n   --> $DIR/lint-exceeding-bitshifts.rs:9:9\n    |\n-LL | #![deny(arithmetic_overflow, const_err)]\n+LL | #![warn(arithmetic_overflow, const_err)]\n    |         ^^^^^^^^^^^^^^^^^^^\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n+  --> $DIR/lint-exceeding-bitshifts.rs:22:13\n+   |\n+LL |     let _ = x << 42;\n+   |             ^^^^^^^ attempt to shift left with overflow\n+\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:27:15\n    |\n LL |       let n = 1u8 << 8;\n    |               ^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:29:15\n    |\n LL |       let n = 1u16 << 16;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:31:15\n    |\n LL |       let n = 1u32 << 32;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:33:15\n    |\n LL |       let n = 1u64 << 64;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:35:15\n    |\n LL |       let n = 1i8 << 8;\n    |               ^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:37:15\n    |\n LL |       let n = 1i16 << 16;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:39:15\n    |\n LL |       let n = 1i32 << 32;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:41:15\n    |\n LL |       let n = 1i64 << 64;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:44:15\n    |\n LL |       let n = 1u8 >> 8;\n    |               ^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:46:15\n    |\n LL |       let n = 1u16 >> 16;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:48:15\n    |\n LL |       let n = 1u32 >> 32;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:50:15\n    |\n LL |       let n = 1u64 >> 64;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:52:15\n    |\n LL |       let n = 1i8 >> 8;\n    |               ^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:54:15\n    |\n LL |       let n = 1i16 >> 16;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:56:15\n    |\n LL |       let n = 1i32 >> 32;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:58:15\n    |\n LL |       let n = 1i64 >> 64;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:62:15\n    |\n LL |       let n = n << 8;\n    |               ^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:64:15\n    |\n LL |       let n = 1u8 << -8;\n    |               ^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:69:15\n    |\n LL |       let n = 1u8 << (4+4);\n    |               ^^^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:71:15\n    |\n LL |       let n = 1i64 >> [64][0];\n    |               ^^^^^^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:77:15\n    |\n LL |       let n = 1_isize << BITS;\n    |               ^^^^^^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:78:15\n    |\n LL |       let n = 1_usize << BITS;\n    |               ^^^^^^^^^^^^^^^ attempt to shift left with overflow\n \n-error: aborting due to 23 previous errors\n+warning: 24 warnings emitted\n "}, {"sha": "a2fb5ad8b8b8b8a38d07bd812b1d1444d64f39a6", "filename": "src/test/ui/lint/lint-exceeding-bitshifts.opt_with_overflow_checks.stderr", "status": "modified", "additions": 34, "deletions": 28, "changes": 62, "blob_url": "https://github.com/rust-lang/rust/blob/33500a2bbfec4482e0f149eafdeb9e111feeb5fc/src%2Ftest%2Fui%2Flint%2Flint-exceeding-bitshifts.opt_with_overflow_checks.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/33500a2bbfec4482e0f149eafdeb9e111feeb5fc/src%2Ftest%2Fui%2Flint%2Flint-exceeding-bitshifts.opt_with_overflow_checks.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-exceeding-bitshifts.opt_with_overflow_checks.stderr?ref=33500a2bbfec4482e0f149eafdeb9e111feeb5fc", "patch": "@@ -1,146 +1,152 @@\n-error: this arithmetic operation will overflow\n-  --> $DIR/lint-exceeding-bitshifts.rs:22:13\n+warning: this arithmetic operation will overflow\n+  --> $DIR/lint-exceeding-bitshifts.rs:18:20\n    |\n-LL |     let _ = x << 42;\n-   |             ^^^^^^^ attempt to shift left with overflow\n+LL |     const N: i32 = T::N << 42;\n+   |                    ^^^^^^^^^^ attempt to shift left with overflow\n    |\n note: the lint level is defined here\n   --> $DIR/lint-exceeding-bitshifts.rs:9:9\n    |\n-LL | #![deny(arithmetic_overflow, const_err)]\n+LL | #![warn(arithmetic_overflow, const_err)]\n    |         ^^^^^^^^^^^^^^^^^^^\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n+  --> $DIR/lint-exceeding-bitshifts.rs:22:13\n+   |\n+LL |     let _ = x << 42;\n+   |             ^^^^^^^ attempt to shift left with overflow\n+\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:27:15\n    |\n LL |       let n = 1u8 << 8;\n    |               ^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:29:15\n    |\n LL |       let n = 1u16 << 16;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:31:15\n    |\n LL |       let n = 1u32 << 32;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:33:15\n    |\n LL |       let n = 1u64 << 64;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:35:15\n    |\n LL |       let n = 1i8 << 8;\n    |               ^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:37:15\n    |\n LL |       let n = 1i16 << 16;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:39:15\n    |\n LL |       let n = 1i32 << 32;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:41:15\n    |\n LL |       let n = 1i64 << 64;\n    |               ^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:44:15\n    |\n LL |       let n = 1u8 >> 8;\n    |               ^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:46:15\n    |\n LL |       let n = 1u16 >> 16;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:48:15\n    |\n LL |       let n = 1u32 >> 32;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:50:15\n    |\n LL |       let n = 1u64 >> 64;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:52:15\n    |\n LL |       let n = 1i8 >> 8;\n    |               ^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:54:15\n    |\n LL |       let n = 1i16 >> 16;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:56:15\n    |\n LL |       let n = 1i32 >> 32;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:58:15\n    |\n LL |       let n = 1i64 >> 64;\n    |               ^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:62:15\n    |\n LL |       let n = n << 8;\n    |               ^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:64:15\n    |\n LL |       let n = 1u8 << -8;\n    |               ^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:69:15\n    |\n LL |       let n = 1u8 << (4+4);\n    |               ^^^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:71:15\n    |\n LL |       let n = 1i64 >> [64][0];\n    |               ^^^^^^^^^^^^^^^ attempt to shift right with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:77:15\n    |\n LL |       let n = 1_isize << BITS;\n    |               ^^^^^^^^^^^^^^^ attempt to shift left with overflow\n \n-error: this arithmetic operation will overflow\n+warning: this arithmetic operation will overflow\n   --> $DIR/lint-exceeding-bitshifts.rs:78:15\n    |\n LL |       let n = 1_usize << BITS;\n    |               ^^^^^^^^^^^^^^^ attempt to shift left with overflow\n \n-error: aborting due to 23 previous errors\n+warning: 24 warnings emitted\n "}, {"sha": "5d0cfd3ab7880f14414a05fa69df9408f9f319f8", "filename": "src/test/ui/lint/lint-exceeding-bitshifts.rs", "status": "modified", "additions": 26, "deletions": 26, "changes": 52, "blob_url": "https://github.com/rust-lang/rust/blob/33500a2bbfec4482e0f149eafdeb9e111feeb5fc/src%2Ftest%2Fui%2Flint%2Flint-exceeding-bitshifts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/33500a2bbfec4482e0f149eafdeb9e111feeb5fc/src%2Ftest%2Fui%2Flint%2Flint-exceeding-bitshifts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-exceeding-bitshifts.rs?ref=33500a2bbfec4482e0f149eafdeb9e111feeb5fc", "patch": "@@ -3,10 +3,10 @@\n //[opt]compile-flags: -O\n //[opt_with_overflow_checks]compile-flags: -C overflow-checks=on -O\n \n-// build-fail\n+// build-pass\n \n #![crate_type=\"lib\"]\n-#![deny(arithmetic_overflow, const_err)]\n+#![warn(arithmetic_overflow, const_err)]\n #![allow(unused_variables)]\n #![allow(dead_code)]\n \n@@ -15,65 +15,65 @@ pub trait Foo {\n }\n \n impl<T: Foo> Foo for Vec<T> {\n-    const N: i32 = T::N << 42; // FIXME this should warn\n+    const N: i32 = T::N << 42; //~ WARN: arithmetic operation will overflow\n }\n \n pub fn foo(x: i32) {\n-    let _ = x << 42; //~ ERROR: arithmetic operation will overflow\n+    let _ = x << 42; //~ WARN: arithmetic operation will overflow\n }\n \n pub fn main() {\n       let n = 1u8 << 7;\n-      let n = 1u8 << 8;   //~ ERROR: arithmetic operation will overflow\n+      let n = 1u8 << 8;   //~ WARN: arithmetic operation will overflow\n       let n = 1u16 << 15;\n-      let n = 1u16 << 16; //~ ERROR: arithmetic operation will overflow\n+      let n = 1u16 << 16; //~ WARN: arithmetic operation will overflow\n       let n = 1u32 << 31;\n-      let n = 1u32 << 32; //~ ERROR: arithmetic operation will overflow\n+      let n = 1u32 << 32; //~ WARN: arithmetic operation will overflow\n       let n = 1u64 << 63;\n-      let n = 1u64 << 64; //~ ERROR: arithmetic operation will overflow\n+      let n = 1u64 << 64; //~ WARN: arithmetic operation will overflow\n       let n = 1i8 << 7;\n-      let n = 1i8 << 8;   //~ ERROR: arithmetic operation will overflow\n+      let n = 1i8 << 8;   //~ WARN: arithmetic operation will overflow\n       let n = 1i16 << 15;\n-      let n = 1i16 << 16; //~ ERROR: arithmetic operation will overflow\n+      let n = 1i16 << 16; //~ WARN: arithmetic operation will overflow\n       let n = 1i32 << 31;\n-      let n = 1i32 << 32; //~ ERROR: arithmetic operation will overflow\n+      let n = 1i32 << 32; //~ WARN: arithmetic operation will overflow\n       let n = 1i64 << 63;\n-      let n = 1i64 << 64; //~ ERROR: arithmetic operation will overflow\n+      let n = 1i64 << 64; //~ WARN: arithmetic operation will overflow\n \n       let n = 1u8 >> 7;\n-      let n = 1u8 >> 8;   //~ ERROR: arithmetic operation will overflow\n+      let n = 1u8 >> 8;   //~ WARN: arithmetic operation will overflow\n       let n = 1u16 >> 15;\n-      let n = 1u16 >> 16; //~ ERROR: arithmetic operation will overflow\n+      let n = 1u16 >> 16; //~ WARN: arithmetic operation will overflow\n       let n = 1u32 >> 31;\n-      let n = 1u32 >> 32; //~ ERROR: arithmetic operation will overflow\n+      let n = 1u32 >> 32; //~ WARN: arithmetic operation will overflow\n       let n = 1u64 >> 63;\n-      let n = 1u64 >> 64; //~ ERROR: arithmetic operation will overflow\n+      let n = 1u64 >> 64; //~ WARN: arithmetic operation will overflow\n       let n = 1i8 >> 7;\n-      let n = 1i8 >> 8;   //~ ERROR: arithmetic operation will overflow\n+      let n = 1i8 >> 8;   //~ WARN: arithmetic operation will overflow\n       let n = 1i16 >> 15;\n-      let n = 1i16 >> 16; //~ ERROR: arithmetic operation will overflow\n+      let n = 1i16 >> 16; //~ WARN: arithmetic operation will overflow\n       let n = 1i32 >> 31;\n-      let n = 1i32 >> 32; //~ ERROR: arithmetic operation will overflow\n+      let n = 1i32 >> 32; //~ WARN: arithmetic operation will overflow\n       let n = 1i64 >> 63;\n-      let n = 1i64 >> 64; //~ ERROR: arithmetic operation will overflow\n+      let n = 1i64 >> 64; //~ WARN: arithmetic operation will overflow\n \n       let n = 1u8;\n       let n = n << 7;\n-      let n = n << 8; //~ ERROR: arithmetic operation will overflow\n+      let n = n << 8; //~ WARN: arithmetic operation will overflow\n \n-      let n = 1u8 << -8; //~ ERROR: arithmetic operation will overflow\n+      let n = 1u8 << -8; //~ WARN: arithmetic operation will overflow\n \n       let n = 1i8<<(1isize+-1);\n \n       let n = 1u8 << (4+3);\n-      let n = 1u8 << (4+4); //~ ERROR: arithmetic operation will overflow\n+      let n = 1u8 << (4+4); //~ WARN: arithmetic operation will overflow\n       let n = 1i64 >> [63][0];\n-      let n = 1i64 >> [64][0]; //~ ERROR: arithmetic operation will overflow\n+      let n = 1i64 >> [64][0]; //~ WARN: arithmetic operation will overflow\n \n       #[cfg(target_pointer_width = \"32\")]\n       const BITS: usize = 32;\n       #[cfg(target_pointer_width = \"64\")]\n       const BITS: usize = 64;\n-      let n = 1_isize << BITS; //~ ERROR: arithmetic operation will overflow\n-      let n = 1_usize << BITS; //~ ERROR: arithmetic operation will overflow\n+      let n = 1_isize << BITS; //~ WARN: arithmetic operation will overflow\n+      let n = 1_usize << BITS; //~ WARN: arithmetic operation will overflow\n }"}]}