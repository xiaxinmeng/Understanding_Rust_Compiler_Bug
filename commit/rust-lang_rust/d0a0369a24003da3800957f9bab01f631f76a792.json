{"sha": "d0a0369a24003da3800957f9bab01f631f76a792", "node_id": "C_kwDOAAsO6NoAKGQwYTAzNjlhMjQwMDNkYTM4MDA5NTdmOWJhYjAxZjYzMWY3NmE3OTI", "commit": {"author": {"name": "infrandomness", "email": "infrandomness@inftop.home", "date": "2022-06-05T20:29:30Z"}, "committer": {"name": "infrandomness", "email": "infrandomness@inftop.home", "date": "2022-06-05T20:46:34Z"}, "message": "Refactor POSIX to UNIX\n\nThis renames the directory containing posix to unix; where applicable,\nit also rename functions with the word \"posix\" to \"unix\"", "tree": {"sha": "a445972fee075f8b9be627e011c2795824cfed67", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a445972fee075f8b9be627e011c2795824cfed67"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d0a0369a24003da3800957f9bab01f631f76a792", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d0a0369a24003da3800957f9bab01f631f76a792", "html_url": "https://github.com/rust-lang/rust/commit/d0a0369a24003da3800957f9bab01f631f76a792", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d0a0369a24003da3800957f9bab01f631f76a792/comments", "author": null, "committer": null, "parents": [{"sha": "2eae4746739d135039aee99071e0c6fcba5bfeee", "url": "https://api.github.com/repos/rust-lang/rust/commits/2eae4746739d135039aee99071e0c6fcba5bfeee", "html_url": "https://github.com/rust-lang/rust/commit/2eae4746739d135039aee99071e0c6fcba5bfeee"}], "stats": {"total": 44, "additions": 22, "deletions": 22}, "files": [{"sha": "369bb92c6f3982606c06d5ebd1c211778d8ba44b", "filename": "src/machine.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fmachine.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fmachine.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmachine.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "patch": "@@ -28,7 +28,7 @@ use rustc_span::Symbol;\n use rustc_target::abi::Size;\n use rustc_target::spec::abi::Abi;\n \n-use crate::{shims::posix::FileHandler, *};\n+use crate::{shims::unix::FileHandler, *};\n \n // Some global facts about the emulated machine.\n pub const PAGE_SIZE: u64 = 4 * 1024; // FIXME: adjust to target architecture\n@@ -266,9 +266,9 @@ pub struct Evaluator<'mir, 'tcx> {\n     pub(crate) enforce_abi: bool,\n \n     /// The table of file descriptors.\n-    pub(crate) file_handler: shims::posix::FileHandler,\n+    pub(crate) file_handler: shims::unix::FileHandler,\n     /// The table of directory descriptors.\n-    pub(crate) dir_handler: shims::posix::DirHandler,\n+    pub(crate) dir_handler: shims::unix::DirHandler,\n \n     /// The \"time anchor\" for this machine's monotone clock (for `Instant` simulation).\n     pub(crate) time_anchor: Instant,"}, {"sha": "c5081582281bc3ef2dd89d723174b3c75560b4c5", "filename": "src/shims/dlsym.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Fdlsym.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Fdlsym.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Fdlsym.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "patch": "@@ -2,13 +2,13 @@ use rustc_middle::mir;\n use rustc_target::spec::abi::Abi;\n \n use crate::*;\n-use shims::posix::dlsym as posix;\n+use shims::unix::dlsym as unix;\n use shims::windows::dlsym as windows;\n \n #[derive(Debug, Copy, Clone)]\n #[allow(non_camel_case_types)]\n pub enum Dlsym {\n-    Posix(posix::Dlsym),\n+    Posix(unix::Dlsym),\n     Windows(windows::Dlsym),\n }\n \n@@ -18,7 +18,7 @@ impl Dlsym {\n     pub fn from_str<'tcx>(name: &[u8], target_os: &str) -> InterpResult<'tcx, Option<Dlsym>> {\n         let name = &*String::from_utf8_lossy(name);\n         Ok(match target_os {\n-            \"linux\" | \"macos\" => posix::Dlsym::from_str(name, target_os)?.map(Dlsym::Posix),\n+            \"linux\" | \"macos\" => unix::Dlsym::from_str(name, target_os)?.map(Dlsym::Posix),\n             \"windows\" => windows::Dlsym::from_str(name)?.map(Dlsym::Windows),\n             os => bug!(\"dlsym not implemented for target_os {}\", os),\n         })\n@@ -38,7 +38,7 @@ pub trait EvalContextExt<'mir, 'tcx: 'mir>: crate::MiriEvalContextExt<'mir, 'tcx\n         let this = self.eval_context_mut();\n         match dlsym {\n             Dlsym::Posix(dlsym) =>\n-                posix::EvalContextExt::call_dlsym(this, dlsym, abi, args, dest, ret),\n+                unix::EvalContextExt::call_dlsym(this, dlsym, abi, args, dest, ret),\n             Dlsym::Windows(dlsym) =>\n                 windows::EvalContextExt::call_dlsym(this, dlsym, abi, args, dest, ret),\n         }"}, {"sha": "12b5b40e69e88b38c86e15d04b8e226238363a59", "filename": "src/shims/foreign_items.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Fforeign_items.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Fforeign_items.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Fforeign_items.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "patch": "@@ -702,7 +702,7 @@ pub trait EvalContextExt<'mir, 'tcx: 'mir>: crate::MiriEvalContextExt<'mir, 'tcx\n \n             // Platform-specific shims\n             _ => match this.tcx.sess.target.os.as_ref() {\n-                \"linux\" | \"macos\" => return shims::posix::foreign_items::EvalContextExt::emulate_foreign_item_by_name(this, link_name, abi, args, dest, ret),\n+                \"linux\" | \"macos\" => return shims::unix::foreign_items::EvalContextExt::emulate_foreign_item_by_name(this, link_name, abi, args, dest, ret),\n                 \"windows\" => return shims::windows::foreign_items::EvalContextExt::emulate_foreign_item_by_name(this, link_name, abi, args, dest, ret),\n                 target => throw_unsup_format!(\"the target `{}` is not supported\", target),\n             }"}, {"sha": "cdffe2f65b4fce56391b7d059c6ea554782c693c", "filename": "src/shims/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Fmod.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "patch": "@@ -1,7 +1,7 @@\n mod backtrace;\n pub mod foreign_items;\n pub mod intrinsics;\n-pub mod posix;\n+pub mod unix;\n pub mod windows;\n \n pub mod dlsym;"}, {"sha": "578ae488a98ea117f86d1e041f2c0affb3d0d1b5", "filename": "src/shims/unix/dlsym.rs", "status": "renamed", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fdlsym.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fdlsym.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Funix%2Fdlsym.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "patch": "@@ -2,8 +2,8 @@ use rustc_middle::mir;\n use rustc_target::spec::abi::Abi;\n \n use crate::*;\n-use shims::posix::linux::dlsym as linux;\n-use shims::posix::macos::dlsym as macos;\n+use shims::unix::linux::dlsym as linux;\n+use shims::unix::macos::dlsym as macos;\n \n #[derive(Debug, Copy, Clone)]\n pub enum Dlsym {", "previous_filename": "src/shims/posix/dlsym.rs"}, {"sha": "32cf7e6f891ff83e7d0d6430a7e7278b32aca0e5", "filename": "src/shims/unix/foreign_items.rs", "status": "renamed", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fforeign_items.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fforeign_items.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Funix%2Fforeign_items.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "patch": "@@ -10,9 +10,9 @@ use rustc_target::spec::abi::Abi;\n \n use crate::*;\n use shims::foreign_items::EmulateByNameResult;\n-use shims::posix::fs::EvalContextExt as _;\n-use shims::posix::sync::EvalContextExt as _;\n-use shims::posix::thread::EvalContextExt as _;\n+use shims::unix::fs::EvalContextExt as _;\n+use shims::unix::sync::EvalContextExt as _;\n+use shims::unix::thread::EvalContextExt as _;\n \n impl<'mir, 'tcx: 'mir> EvalContextExt<'mir, 'tcx> for crate::MiriEvalContext<'mir, 'tcx> {}\n pub trait EvalContextExt<'mir, 'tcx: 'mir>: crate::MiriEvalContextExt<'mir, 'tcx> {\n@@ -477,8 +477,8 @@ pub trait EvalContextExt<'mir, 'tcx: 'mir>: crate::MiriEvalContextExt<'mir, 'tcx\n             // Platform-specific shims\n             _ => {\n                 match this.tcx.sess.target.os.as_ref() {\n-                    \"linux\" => return shims::posix::linux::foreign_items::EvalContextExt::emulate_foreign_item_by_name(this, link_name, abi, args, dest, ret),\n-                    \"macos\" => return shims::posix::macos::foreign_items::EvalContextExt::emulate_foreign_item_by_name(this, link_name, abi, args, dest, ret),\n+                    \"linux\" => return shims::unix::linux::foreign_items::EvalContextExt::emulate_foreign_item_by_name(this, link_name, abi, args, dest, ret),\n+                    \"macos\" => return shims::unix::macos::foreign_items::EvalContextExt::emulate_foreign_item_by_name(this, link_name, abi, args, dest, ret),\n                     _ => unreachable!(),\n                 }\n             }", "previous_filename": "src/shims/posix/foreign_items.rs"}, {"sha": "d02410664bd42a895c2790555609ac9c41136aef", "filename": "src/shims/unix/fs.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Funix%2Ffs.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "previous_filename": "src/shims/posix/fs.rs"}, {"sha": "72e8c7f16f8530f862f92b0c4aec0612ca995b5a", "filename": "src/shims/unix/linux/dlsym.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Flinux%2Fdlsym.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Flinux%2Fdlsym.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Funix%2Flinux%2Fdlsym.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "previous_filename": "src/shims/posix/linux/dlsym.rs"}, {"sha": "7a9c687fcd764856edee30839bacbf9e8f8f67a6", "filename": "src/shims/unix/linux/foreign_items.rs", "status": "renamed", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Flinux%2Fforeign_items.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Flinux%2Fforeign_items.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Funix%2Flinux%2Fforeign_items.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "patch": "@@ -4,10 +4,10 @@ use rustc_target::spec::abi::Abi;\n \n use crate::*;\n use shims::foreign_items::EmulateByNameResult;\n-use shims::posix::fs::EvalContextExt as _;\n-use shims::posix::linux::sync::futex;\n-use shims::posix::sync::EvalContextExt as _;\n-use shims::posix::thread::EvalContextExt as _;\n+use shims::unix::fs::EvalContextExt as _;\n+use shims::unix::linux::sync::futex;\n+use shims::unix::sync::EvalContextExt as _;\n+use shims::unix::thread::EvalContextExt as _;\n \n impl<'mir, 'tcx: 'mir> EvalContextExt<'mir, 'tcx> for crate::MiriEvalContext<'mir, 'tcx> {}\n pub trait EvalContextExt<'mir, 'tcx: 'mir>: crate::MiriEvalContextExt<'mir, 'tcx> {", "previous_filename": "src/shims/posix/linux/foreign_items.rs"}, {"sha": "498eb57c57fe0ebc0e9c1d306dad37693046f9d6", "filename": "src/shims/unix/linux/mod.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Flinux%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Flinux%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Funix%2Flinux%2Fmod.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "previous_filename": "src/shims/posix/linux/mod.rs"}, {"sha": "72898baa4b0a42ebdcf4d0cb81df4d138a663b8b", "filename": "src/shims/unix/linux/sync.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Flinux%2Fsync.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Flinux%2Fsync.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Funix%2Flinux%2Fsync.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "previous_filename": "src/shims/posix/linux/sync.rs"}, {"sha": "2e97b7918e96be7ebc074c82eee0f73f02bf554c", "filename": "src/shims/unix/macos/dlsym.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fmacos%2Fdlsym.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fmacos%2Fdlsym.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Funix%2Fmacos%2Fdlsym.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "previous_filename": "src/shims/posix/macos/dlsym.rs"}, {"sha": "a1adfa0d2fda50c899072bdd397f98f1098e5559", "filename": "src/shims/unix/macos/foreign_items.rs", "status": "renamed", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fmacos%2Fforeign_items.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fmacos%2Fforeign_items.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Funix%2Fmacos%2Fforeign_items.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "patch": "@@ -4,8 +4,8 @@ use rustc_target::spec::abi::Abi;\n \n use crate::*;\n use shims::foreign_items::EmulateByNameResult;\n-use shims::posix::fs::EvalContextExt as _;\n-use shims::posix::thread::EvalContextExt as _;\n+use shims::unix::fs::EvalContextExt as _;\n+use shims::unix::thread::EvalContextExt as _;\n \n impl<'mir, 'tcx: 'mir> EvalContextExt<'mir, 'tcx> for crate::MiriEvalContext<'mir, 'tcx> {}\n pub trait EvalContextExt<'mir, 'tcx: 'mir>: crate::MiriEvalContextExt<'mir, 'tcx> {", "previous_filename": "src/shims/posix/macos/foreign_items.rs"}, {"sha": "434f5f30b5a5689206655f20e623d99789556bb6", "filename": "src/shims/unix/macos/mod.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fmacos%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fmacos%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Funix%2Fmacos%2Fmod.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "previous_filename": "src/shims/posix/macos/mod.rs"}, {"sha": "f40dfaefb92ac2ca26d1443fed44831eb3fff95f", "filename": "src/shims/unix/mod.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Funix%2Fmod.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "previous_filename": "src/shims/posix/mod.rs"}, {"sha": "373996312eaf6e36bdeb0c1f001601be357da88f", "filename": "src/shims/unix/sync.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fsync.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fsync.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Funix%2Fsync.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "previous_filename": "src/shims/posix/sync.rs"}, {"sha": "88c3fb0bc8eab79467e9d994de97c9d41d48d000", "filename": "src/shims/unix/thread.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fthread.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0a0369a24003da3800957f9bab01f631f76a792/src%2Fshims%2Funix%2Fthread.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Funix%2Fthread.rs?ref=d0a0369a24003da3800957f9bab01f631f76a792", "previous_filename": "src/shims/posix/thread.rs"}]}