{"sha": "8fc51dfc6524d0a4e8ddd80a567b266792170ff0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhmYzUxZGZjNjUyNGQwYTRlOGRkZDgwYTU2N2IyNjY3OTIxNzBmZjA=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-06-27T18:53:04Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-06-27T18:53:28Z"}, "message": "Some work on reviving the mingw-cross build. Not working yet.", "tree": {"sha": "e2ed368fcacbb7a917a226a3443c38a44b841e68", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e2ed368fcacbb7a917a226a3443c38a44b841e68"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8fc51dfc6524d0a4e8ddd80a567b266792170ff0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8fc51dfc6524d0a4e8ddd80a567b266792170ff0", "html_url": "https://github.com/rust-lang/rust/commit/8fc51dfc6524d0a4e8ddd80a567b266792170ff0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8fc51dfc6524d0a4e8ddd80a567b266792170ff0/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a6f36ba3f5c7c9136446979ceeb5c08892db463a", "url": "https://api.github.com/repos/rust-lang/rust/commits/a6f36ba3f5c7c9136446979ceeb5c08892db463a", "html_url": "https://github.com/rust-lang/rust/commit/a6f36ba3f5c7c9136446979ceeb5c08892db463a"}], "stats": {"total": 19, "additions": 13, "deletions": 6}, "files": [{"sha": "9f65d42adb4d29f6461f9c44e618f00733f692b0", "filename": "Makefile.in", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/8fc51dfc6524d0a4e8ddd80a567b266792170ff0/Makefile.in", "raw_url": "https://github.com/rust-lang/rust/raw/8fc51dfc6524d0a4e8ddd80a567b266792170ff0/Makefile.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Makefile.in?ref=8fc51dfc6524d0a4e8ddd80a567b266792170ff0", "patch": "@@ -171,9 +171,9 @@ export CFG_LLVM_ROOT\n # Subprograms\n ######################################################################\n \n-LLVM_AS := $(CFG_LLVM_BINDIR)/llvm-as\n+LLVM_AS := $(CFG_LLVM_BINDIR)/llvm-as$(X)\n \n-LLC := $(CFG_LLVM_BINDIR)/llc\n+LLC := $(CFG_LLVM_BINDIR)/llc$(X)\n \n ######################################################################\n # Single-target rules"}, {"sha": "f14c92de399c92c9ea9ba4aac29cd5262a2d4e31", "filename": "configure", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/8fc51dfc6524d0a4e8ddd80a567b266792170ff0/configure", "raw_url": "https://github.com/rust-lang/rust/raw/8fc51dfc6524d0a4e8ddd80a567b266792170ff0/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=8fc51dfc6524d0a4e8ddd80a567b266792170ff0", "patch": "@@ -95,7 +95,7 @@ opt() {\n         do\n             if [ \"$arg\" = \"--${FLAG}-${OP}\" ]\n             then\n-                OP=$(echo $OP | tr 'a-z' 'A-Z')\n+                OP=$(echo $OP | tr 'a-z-' 'A-Z_')\n                 FLAG=$(echo $FLAG | tr 'a-z' 'A-Z')\n                 local V=\"CFG_${FLAG}_${OP}\"\n                 eval $V=1\n@@ -165,6 +165,7 @@ fi\n opt valgrind 1 \"run tests with valgrind\"\n opt docs     1 \"build documentation\"\n opt optimize 1 \"build optimized rust code\"\n+opt mingw-cross 0 \"cross-compile for win32 using mingw\"\n \n \n if [ $HELP -eq 1 ]\n@@ -181,7 +182,7 @@ for i in \\\n     dl stage0 stage1 stage2 stage3 \\\n     stage0/lib stage1/lib stage2/lib stage3/lib \\\n     test/run-pass test/run-fail test/compile-fail \\\n-    test/bench/99-bottles test/bench/shootout     \n+    test/bench/99-bottles test/bench/shootout\n do\n     make_dir $i\n done"}, {"sha": "6b744edc2e9f5b013b1adf402210b2666219b7d1", "filename": "mk/platform.mk", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/8fc51dfc6524d0a4e8ddd80a567b266792170ff0/mk%2Fplatform.mk", "raw_url": "https://github.com/rust-lang/rust/raw/8fc51dfc6524d0a4e8ddd80a567b266792170ff0/mk%2Fplatform.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fplatform.mk?ref=8fc51dfc6524d0a4e8ddd80a567b266792170ff0", "patch": "@@ -103,9 +103,10 @@ ifdef CFG_UNIXY\n       $(CFG_LDENV)=$(call CFG_TESTLIB,$(1)):$(CFG_LDPATH) \\\n       $(CFG_VALGRIND) $(1)\n \n-  ifdef MINGW_CROSS\n+  ifdef CFG_ENABLE_MINGW_CROSS\n     CFG_EXE_SUFFIX := .exe\n     CFG_LIB_NAME=$(1).dll\n+    CFG_DEF_SUFFIX := .def\n     CFG_LDPATH :=$(CFG_LDPATH):$(CFG_LLVM_BINDIR)\n     CFG_LDPATH :=$(CFG_LDPATH):$$PATH\n     CFG_RUN_TARG=PATH=$(CFG_BUILD_DIR)/$(1)/lib:$(CFG_LDPATH) $(2)\n@@ -116,8 +117,13 @@ ifdef CFG_UNIXY\n     ifdef CFG_VALGRIND\n       CFG_VALGRIND += wine\n     endif\n-    CFG_GCCISH_CFLAGS := -march=i686\n+\n+    CFG_GCCISH_CFLAGS := -march=i686 -O2\n+    CFG_GCCISH_PRE_LIB_FLAGS :=\n+    CFG_GCCISH_POST_LIB_FLAGS :=\n+    CFG_GCCISH_DEF_FLAG :=\n     CFG_GCCISH_LINK_FLAGS := -shared\n+\n     ifeq ($(CFG_CPUTYPE), x86_64)\n       CFG_GCCISH_CFLAGS += -m32\n       CFG_GCCISH_LINK_FLAGS += -m32"}]}