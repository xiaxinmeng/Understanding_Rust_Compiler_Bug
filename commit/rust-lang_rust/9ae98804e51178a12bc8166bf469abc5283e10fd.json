{"sha": "9ae98804e51178a12bc8166bf469abc5283e10fd", "node_id": "C_kwDOAAsO6NoAKDlhZTk4ODA0ZTUxMTc4YTEyYmM4MTY2YmY0NjlhYmM1MjgzZTEwZmQ", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-12-24T07:53:46Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-12-24T07:53:46Z"}, "message": "Rollup merge of #105465 - jyn514:docs, r=Mark-Simulacrum\n\nImprove top-level docs\n\nSee a detailed explanation in the commit messages. This is a companion PR to https://github.com/rust-lang/rustc-dev-guide/pull/1528.\n\n* Link to other resources instead of inlining their information\n* Remove ancient and outdated reference to `config.mk`\n* Suggest `profile = \"user\"` in the README\n* Add detail about dependencies from the dev-guide\n* Link to CONTRIBUTING.md instead of rustc-dev-guide in the main readme\n* Link to `std-dev-guide` in CONTRIBUTING.md", "tree": {"sha": "6af12de0189ef940e83ac5fdbf567710dfb97c82", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6af12de0189ef940e83ac5fdbf567710dfb97c82"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9ae98804e51178a12bc8166bf469abc5283e10fd", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjprAKCRBK7hj4Ov3rIwAAwXUIAAFtTF+TOfy6dmoN1RPGbdhn\nZ3J1uWADFSK+SzY04LxL1xnglDx4fSP+nBFuVW2OS/nqk1U25TBgroHMPaJ94GVQ\nWUcmzq3pzmlzro/sqzNs0FwXbpLWGt7Hochq6X5oRPuk/urUVXOeI1j3tSx/wNO3\nc7yGedP5Tjih9gZcY44zMCj0ap7GysD+DkithMn5GqV5+0Fe3zS+Mf0f9JBtY+mG\nN5vqZ6RGw7T8G2bGE7UFQ7E1EAyTiabyI9OzvVmCN2Nu8IaQIYjE2EJxPoKT31Jo\nKo29s7Af71JOobDfIOF6brFAq6JqmwydX7anYLnF98lNz1A1oGwecPxMtQFQiFM=\n=Y+00\n-----END PGP SIGNATURE-----\n", "payload": "tree 6af12de0189ef940e83ac5fdbf567710dfb97c82\nparent 4f4d0586ad20c66a16d547581ca379beafece93a\nparent 70a0e0a2779f04999d0f0e40f93e1697c37ec042\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1671868426 +0100\ncommitter GitHub <noreply@github.com> 1671868426 +0100\n\nRollup merge of #105465 - jyn514:docs, r=Mark-Simulacrum\n\nImprove top-level docs\n\nSee a detailed explanation in the commit messages. This is a companion PR to https://github.com/rust-lang/rustc-dev-guide/pull/1528.\n\n* Link to other resources instead of inlining their information\n* Remove ancient and outdated reference to `config.mk`\n* Suggest `profile = \"user\"` in the README\n* Add detail about dependencies from the dev-guide\n* Link to CONTRIBUTING.md instead of rustc-dev-guide in the main readme\n* Link to `std-dev-guide` in CONTRIBUTING.md\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9ae98804e51178a12bc8166bf469abc5283e10fd", "html_url": "https://github.com/rust-lang/rust/commit/9ae98804e51178a12bc8166bf469abc5283e10fd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9ae98804e51178a12bc8166bf469abc5283e10fd/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4f4d0586ad20c66a16d547581ca379beafece93a", "url": "https://api.github.com/repos/rust-lang/rust/commits/4f4d0586ad20c66a16d547581ca379beafece93a", "html_url": "https://github.com/rust-lang/rust/commit/4f4d0586ad20c66a16d547581ca379beafece93a"}, {"sha": "70a0e0a2779f04999d0f0e40f93e1697c37ec042", "url": "https://api.github.com/repos/rust-lang/rust/commits/70a0e0a2779f04999d0f0e40f93e1697c37ec042", "html_url": "https://github.com/rust-lang/rust/commit/70a0e0a2779f04999d0f0e40f93e1697c37ec042"}], "stats": {"total": 131, "additions": 62, "deletions": 69}, "files": [{"sha": "d732075fb2d07fb84f1873ac7221f64f52a47947", "filename": "CONTRIBUTING.md", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/9ae98804e51178a12bc8166bf469abc5283e10fd/CONTRIBUTING.md", "raw_url": "https://github.com/rust-lang/rust/raw/9ae98804e51178a12bc8166bf469abc5283e10fd/CONTRIBUTING.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/CONTRIBUTING.md?ref=9ae98804e51178a12bc8166bf469abc5283e10fd", "patch": "@@ -8,9 +8,9 @@ members](https://rust-lang.zulipchat.com/#narrow/stream/122652-new-members)\n Zulip stream. We have lots of docs below of how to get started on your own, but\n the Zulip stream is the best place to *ask* for help.\n \n-Documentation for contributing to Rust is located in the [Guide to Rustc Development](https://rustc-dev-guide.rust-lang.org/),\n-commonly known as the [rustc-dev-guide]. Despite the name, this guide documents\n-not just how to develop rustc (the Rust compiler), but also how to contribute to the standard library and rustdoc.\n+Documentation for contributing to the compiler or tooling is located in the [Guide to Rustc\n+Development][rustc-dev-guide], commonly known as the [rustc-dev-guide]. Documentation for the\n+standard library in the [Standard library developers Guide][std-dev-guide], commonly known as the [std-dev-guide].\n \n ## About the [rustc-dev-guide]\n \n@@ -35,6 +35,7 @@ refer to [this section][contributing-bug-reports] and [open an issue][issue temp\n \n [Contributing to Rust]: https://rustc-dev-guide.rust-lang.org/contributing.html#contributing-to-rust\n [rustc-dev-guide]: https://rustc-dev-guide.rust-lang.org/\n+[std-dev-guide]: https://std-dev-guide.rust-lang.org/\n [contributing-bug-reports]: https://rustc-dev-guide.rust-lang.org/contributing.html#bug-reports\n [issue template]: https://github.com/rust-lang/rust/issues/new/choose\n [internals]: https://internals.rust-lang.org"}, {"sha": "014fab907fb96c48a9b46efcbb6055395c68556d", "filename": "README.md", "status": "modified", "additions": 55, "deletions": 54, "changes": 109, "blob_url": "https://github.com/rust-lang/rust/blob/9ae98804e51178a12bc8166bf469abc5283e10fd/README.md", "raw_url": "https://github.com/rust-lang/rust/raw/9ae98804e51178a12bc8166bf469abc5283e10fd/README.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/README.md?ref=9ae98804e51178a12bc8166bf469abc5283e10fd", "patch": "@@ -6,11 +6,7 @@ standard library, and documentation.\n [Rust]: https://www.rust-lang.org\n \n **Note: this README is for _users_ rather than _contributors_.\n-If you wish to _contribute_ to the compiler, you should read the\n-[Getting Started][gettingstarted] section of the rustc-dev-guide instead.\n-You can ask for help in the [#new members Zulip stream][new-members].**\n-\n-[new-members]: https://rust-lang.zulipchat.com/#narrow/stream/122652-new-members\n+If you wish to _contribute_ to the compiler, you should read [CONTRIBUTING.md](CONTRIBUTING.md) instead.\n \n ## Quick Start\n \n@@ -48,20 +44,37 @@ by running it with the `--help` flag or reading the [rustc dev guide][rustcguide\n [gettingstarted]: https://rustc-dev-guide.rust-lang.org/getting-started.html\n [rustcguidebuild]: https://rustc-dev-guide.rust-lang.org/building/how-to-build-and-run.html\n \n-### Building on a Unix-like system\n-1. Make sure you have installed the dependencies:\n+### Dependencies\n+\n+Make sure you have installed the dependencies:\n \n-   * `g++` 5.1 or later or `clang++` 3.5 or later\n    * `python` 3 or 2.7\n-   * GNU `make` 3.81 or later\n-   * `cmake` 3.13.4 or later\n-   * `ninja`\n-   * `curl`\n    * `git`\n-   * `ssl` which comes in `libssl-dev` or `openssl-devel`\n+   * A C compiler (when building for the host, `cc` is enough; cross-compiling may need additional compilers)\n+   * `curl` (not needed on Windows)\n    * `pkg-config` if you are compiling on Linux and targeting Linux\n+   * `libiconv` (already included with glibc on Debian-based distros)\n+\n+To build cargo, you'll also need OpenSSL (`libssl-dev` or `openssl-devel` on most Unix distros).\n+\n+If building LLVM from source, you'll need additional tools:\n+\n+* `g++`, `clang++`, or MSVC with versions listed on\n+  [LLVM's documentation](https://llvm.org/docs/GettingStarted.html#host-c-toolchain-both-compiler-and-standard-library)\n+* `ninja`, or GNU `make` 3.81 or later (ninja is recommended, especially on Windows)\n+* `cmake` 3.13.4 or later\n+* `libstdc++-static` may be required on some Linux distributions such as Fedora and Ubuntu\n \n-2. Clone the [source] with `git`:\n+On tier 1 or tier 2 with host tools platforms, you can also choose to download LLVM by setting `llvm.download-ci-llvm = true`.\n+Otherwise, you'll need LLVM installed and `llvm-config` in your path.\n+See [the rustc-dev-guide for more info][sysllvm].\n+\n+[sysllvm]: https://rustc-dev-guide.rust-lang.org/building/new-target.html#using-pre-built-llvm\n+\n+\n+### Building on a Unix-like system\n+\n+1. Clone the [source] with `git`:\n \n    ```sh\n    git clone https://github.com/rust-lang/rust.git\n@@ -70,38 +83,49 @@ by running it with the `--help` flag or reading the [rustc dev guide][rustcguide\n \n [source]: https://github.com/rust-lang/rust\n \n-3. Configure the build settings:\n+2. Configure the build settings:\n \n     The Rust build system uses a file named `config.toml` in the root of the\n     source tree to determine various configuration settings for the build.\n-    Copy the default `config.toml.example` to `config.toml` to get started.\n+    Set up the defaults intended for distros to get started. You can see a full list of options\n+    in `config.toml.example`.\n \n     ```sh\n-    cp config.toml.example config.toml\n+    printf 'profile = \"user\" \\nchangelog-seen = 2 \\n' > config.toml\n     ```\n \n     If you plan to use `x.py install` to create an installation, it is recommended\n     that you set the `prefix` value in the `[install]` section to a directory.\n \n-    Create an install directory if you are not installing in the default directory.\n-\n-4. Build and install:\n+3. Build and install:\n \n     ```sh\n     ./x.py build && ./x.py install\n     ```\n \n     When complete, `./x.py install` will place several programs into\n     `$PREFIX/bin`: `rustc`, the Rust compiler, and `rustdoc`, the\n-    API-documentation tool. This install does not include [Cargo],\n-    Rust's package manager. To build and install Cargo, you may\n-    run `./x.py install cargo` or set the `build.extended` key in\n-    `config.toml` to `true` to build and install all tools.\n+    API-documentation tool. If you've set `profile = \"user\"` or `build.extended = true`, it will\n+    also include [Cargo], Rust's package manager.\n \n [Cargo]: https://github.com/rust-lang/cargo\n \n ### Building on Windows\n \n+On Windows, we suggest using [winget] to install dependencies by running the following in a terminal:\n+\n+```powershell\n+winget install -e Python.Python.3\n+winget install -e Kitware.CMake\n+winget install -e Git.Git\n+```\n+\n+Then edit your system's `PATH` variable and add: `C:\\Program Files\\CMake\\bin`. See\n+[this guide on editing the system `PATH`](https://www.java.com/en/download/help/path.html) from the\n+Java documentation.\n+\n+[winget]: https://github.com/microsoft/winget-cli\n+\n There are two prominent ABIs in use on Windows: the native (MSVC) ABI used by\n Visual Studio and the GNU ABI used by the GCC toolchain. Which version of Rust\n you need depends largely on what C/C++ libraries you want to interoperate with.\n@@ -190,7 +214,7 @@ Windows build triples are:\n     - `x86_64-pc-windows-msvc`\n \n The build triple can be specified by either specifying `--build=<triple>` when\n-invoking `x.py` commands, or by copying the `config.toml` file (as described\n+invoking `x.py` commands, or by creating a `config.toml` file (as described\n in [Installing From Source](#installing-from-source)), and modifying the\n `build` option under the `[build]` section.\n \n@@ -204,9 +228,7 @@ configure script and makefile (the latter of which just invokes `x.py`).\n make && sudo make install\n ```\n \n-When using the configure script, the generated `config.mk` file may override the\n-`config.toml` file. To go back to the `config.toml` file, delete the generated\n-`config.mk` file.\n+`configure` generates a `config.toml` which can also be used with normal `x.py` invocations.\n \n ## Building Documentation\n \n@@ -227,41 +249,20 @@ precompiled \"snapshot\" version of itself (made in an earlier stage of\n development). As such, source builds require an Internet connection to\n fetch snapshots, and an OS that can execute the available snapshot binaries.\n \n-Snapshot binaries are currently built and tested on several platforms:\n-\n-| Platform / Architecture                     | x86 | x86_64 |\n-|---------------------------------------------|-----|--------|\n-| Windows (7, 8, 10, ...)                     | \u2713   | \u2713      |\n-| Linux (kernel 3.2, glibc 2.17 or later)     | \u2713   | \u2713      |\n-| macOS (10.7 Lion or later)                  | (\\*) | \u2713      |\n-\n-(\\*): Apple dropped support for running 32-bit binaries starting from macOS 10.15 and iOS 11.\n-Due to this decision from Apple, the targets are no longer useful to our users.\n-Please read [our blog post][macx32] for more info.\n-\n-[macx32]: https://blog.rust-lang.org/2020/01/03/reducing-support-for-32-bit-apple-targets.html\n+See https://doc.rust-lang.org/nightly/rustc/platform-support.html for a list of supported platforms.\n+Only \"host tools\" platforms have a pre-compiled snapshot binary available; to compile for a platform\n+without host tools you must cross-compile.\n \n You may find that other platforms work, but these are our officially\n supported build environments that are most likely to work.\n \n ## Getting Help\n \n-The Rust community congregates in a few places:\n-\n-* [Stack Overflow] - Direct questions about using the language.\n-* [users.rust-lang.org] - General discussion and broader questions.\n-* [/r/rust] - News and general discussion.\n-\n-[Stack Overflow]: https://stackoverflow.com/questions/tagged/rust\n-[/r/rust]: https://reddit.com/r/rust\n-[users.rust-lang.org]: https://users.rust-lang.org/\n+See https://www.rust-lang.org/community for a list of chat platforms and forums.\n \n ## Contributing\n \n-If you are interested in contributing to the Rust project, please take a look\n-at the [Getting Started][gettingstarted] guide in the [rustc-dev-guide].\n-\n-[rustc-dev-guide]: https://rustc-dev-guide.rust-lang.org\n+See [CONTRIBUTING.md](CONTRIBUTING.md).\n \n ## License\n "}, {"sha": "79c2eb31cdae07b3fca56104c8d9b806bfc87276", "filename": "src/bootstrap/README.md", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/9ae98804e51178a12bc8166bf469abc5283e10fd/src%2Fbootstrap%2FREADME.md", "raw_url": "https://github.com/rust-lang/rust/raw/9ae98804e51178a12bc8166bf469abc5283e10fd/src%2Fbootstrap%2FREADME.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2FREADME.md?ref=9ae98804e51178a12bc8166bf469abc5283e10fd", "patch": "@@ -80,18 +80,12 @@ The script accepts commands, flags, and arguments to determine what to do:\n \n ## Configuring rustbuild\n \n-There are currently two methods for configuring the rustbuild build system.\n-\n-First, rustbuild offers a TOML-based configuration system with a `config.toml`\n+rustbuild offers a TOML-based configuration system with a `config.toml`\n file. An example of this configuration can be found at `config.toml.example`,\n and the configuration file can also be passed as `--config path/to/config.toml`\n if the build system is being invoked manually (via the python script).\n \n-Next, the `./configure` options serialized in `config.mk` will be\n-parsed and read. That is, if any `./configure` options are passed, they'll be\n-handled naturally. `./configure` should almost never be used for local\n-installations, and is primarily useful for CI. Prefer to customize behavior\n-using `config.toml`.\n+You can generate a config.toml using `./configure` options if you want to automate creating the file without having to edit it.\n \n Finally, rustbuild makes use of the [cc-rs crate] which has [its own\n method][env-vars] of configuring C compilers and C flags via environment"}, {"sha": "b41d60d51a8b5972f75ea63e518d68e461f7df0e", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/9ae98804e51178a12bc8166bf469abc5283e10fd/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9ae98804e51178a12bc8166bf469abc5283e10fd/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=9ae98804e51178a12bc8166bf469abc5283e10fd", "patch": "@@ -49,10 +49,7 @@ pub enum DryRun {\n \n /// Global configuration for the entire build and/or bootstrap.\n ///\n-/// This structure is derived from a combination of both `config.toml` and\n-/// `config.mk`. As of the time of this writing it's unlikely that `config.toml`\n-/// is used all that much, so this is primarily filled out by `config.mk` which\n-/// is generated from `./configure`.\n+/// This structure is parsed from `config.toml`, and some of the fields are inferred from `git` or build-time parameters.\n ///\n /// Note that this structure is not decoded directly into, but rather it is\n /// filled out from the decoded forms of the structs below. For documentation"}]}