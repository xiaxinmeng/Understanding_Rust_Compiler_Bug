{"sha": "75896011dc2a137d96a4941f5c415c2c108f5cf9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc1ODk2MDExZGMyYTEzN2Q5NmE0OTQxZjVjNDE1YzJjMTA4ZjVjZjk=", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2019-07-13T20:24:58Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2019-07-15T09:42:07Z"}, "message": "pprust: Do not convert attributes into `MetaItem`s for printing\n\nFixes https://github.com/rust-lang/rust/issues/62628", "tree": {"sha": "1bca714ed6ec2273edd4415d44399532b28e55df", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1bca714ed6ec2273edd4415d44399532b28e55df"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/75896011dc2a137d96a4941f5c415c2c108f5cf9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/75896011dc2a137d96a4941f5c415c2c108f5cf9", "html_url": "https://github.com/rust-lang/rust/commit/75896011dc2a137d96a4941f5c415c2c108f5cf9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/75896011dc2a137d96a4941f5c415c2c108f5cf9/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "160c40bc88706965d268106e02c3d43422114a02", "url": "https://api.github.com/repos/rust-lang/rust/commits/160c40bc88706965d268106e02c3d43422114a02", "html_url": "https://github.com/rust-lang/rust/commit/160c40bc88706965d268106e02c3d43422114a02"}], "stats": {"total": 37, "additions": 20, "deletions": 17}, "files": [{"sha": "a07bba044898b7824b3a7acac4904587fb9e15cc", "filename": "src/libsyntax/print/pprust.rs", "status": "modified", "additions": 11, "deletions": 15, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/75896011dc2a137d96a4941f5c415c2c108f5cf9/src%2Flibsyntax%2Fprint%2Fpprust.rs", "raw_url": "https://github.com/rust-lang/rust/raw/75896011dc2a137d96a4941f5c415c2c108f5cf9/src%2Flibsyntax%2Fprint%2Fpprust.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fprint%2Fpprust.rs?ref=75896011dc2a137d96a4941f5c415c2c108f5cf9", "patch": "@@ -617,21 +617,17 @@ pub trait PrintState<'a>: std::ops::Deref<Target=pp::Printer> + std::ops::DerefM\n                 ast::AttrStyle::Outer => self.word(\"#[\"),\n             }\n             self.ibox(0);\n-            if let Some(mi) = attr.meta() {\n-                self.print_meta_item(&mi);\n-            } else {\n-                match attr.tokens.trees().next() {\n-                    Some(TokenTree::Delimited(_, delim, tts)) => {\n-                        self.print_mac_common(\n-                            Some(&attr.path), false, None, delim, tts, true, attr.span\n-                        );\n-                    }\n-                    tree => {\n-                        self.print_path(&attr.path, false, 0);\n-                        if tree.is_some() {\n-                            self.space();\n-                            self.print_tts(attr.tokens.clone(), true);\n-                        }\n+            match attr.tokens.trees().next() {\n+                Some(TokenTree::Delimited(_, delim, tts)) => {\n+                    self.print_mac_common(\n+                        Some(&attr.path), false, None, delim, tts, true, attr.span\n+                    );\n+                }\n+                tree => {\n+                    self.print_path(&attr.path, false, 0);\n+                    if tree.is_some() {\n+                        self.space();\n+                        self.print_tts(attr.tokens.clone(), true);\n                     }\n                 }\n             }"}, {"sha": "bcd6ffaaf815b6cf443f43c750bdf89d48db8076", "filename": "src/test/pretty/attr-literals.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/75896011dc2a137d96a4941f5c415c2c108f5cf9/src%2Ftest%2Fpretty%2Fattr-literals.rs", "raw_url": "https://github.com/rust-lang/rust/raw/75896011dc2a137d96a4941f5c415c2c108f5cf9/src%2Ftest%2Fpretty%2Fattr-literals.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fpretty%2Fattr-literals.rs?ref=75896011dc2a137d96a4941f5c415c2c108f5cf9", "patch": "@@ -5,10 +5,10 @@\n #![feature(rustc_attrs)]\n \n fn main() {\n-    #![rustc_dummy(\"hi\", 1, 2, 1.012, pi = 3.14, bye, name(\"John\"))]\n+    #![rustc_dummy(\"hi\" , 1 , 2 , 1.012 , pi = 3.14 , bye , name (\"John\"))]\n     #[rustc_dummy = 8]\n     fn f() { }\n \n-    #[rustc_dummy(1, 2, 3)]\n+    #[rustc_dummy(1 , 2 , 3)]\n     fn g() { }\n }"}, {"sha": "bb2c4bb558e57dd10a9d073e2ca2daba1adce345", "filename": "src/test/pretty/attr-tokens-raw-ident.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/75896011dc2a137d96a4941f5c415c2c108f5cf9/src%2Ftest%2Fpretty%2Fattr-tokens-raw-ident.rs", "raw_url": "https://github.com/rust-lang/rust/raw/75896011dc2a137d96a4941f5c415c2c108f5cf9/src%2Ftest%2Fpretty%2Fattr-tokens-raw-ident.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fpretty%2Fattr-tokens-raw-ident.rs?ref=75896011dc2a137d96a4941f5c415c2c108f5cf9", "patch": "@@ -0,0 +1,7 @@\n+// Keywords in attribute paths are printed as raw idents,\n+// but keywords in attribute arguments are not.\n+\n+// pp-exact\n+\n+#[rustfmt::r#final(final)]\n+fn main() { }"}]}