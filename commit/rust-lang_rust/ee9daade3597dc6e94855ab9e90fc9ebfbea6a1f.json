{"sha": "ee9daade3597dc6e94855ab9e90fc9ebfbea6a1f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVlOWRhYWRlMzU5N2RjNmU5NDg1NWFiOWU5MGZjOWViZmJlYTZhMWY=", "commit": {"author": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2017-04-06T09:17:22Z"}, "committer": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2017-04-06T09:17:22Z"}, "message": "Fix a bug with overlong function calls", "tree": {"sha": "94864cadabcb325a88162b010da8b3cb7346d622", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/94864cadabcb325a88162b010da8b3cb7346d622"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ee9daade3597dc6e94855ab9e90fc9ebfbea6a1f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ee9daade3597dc6e94855ab9e90fc9ebfbea6a1f", "html_url": "https://github.com/rust-lang/rust/commit/ee9daade3597dc6e94855ab9e90fc9ebfbea6a1f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ee9daade3597dc6e94855ab9e90fc9ebfbea6a1f/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a7183766b95d43700ddc583b9e9f5d4bcfa91e58", "url": "https://api.github.com/repos/rust-lang/rust/commits/a7183766b95d43700ddc583b9e9f5d4bcfa91e58", "html_url": "https://github.com/rust-lang/rust/commit/a7183766b95d43700ddc583b9e9f5d4bcfa91e58"}], "stats": {"total": 32, "additions": 30, "deletions": 2}, "files": [{"sha": "2723c4099c1440315c10e63a0c22a336ad98a4d6", "filename": "src/expr.rs", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/ee9daade3597dc6e94855ab9e90fc9ebfbea6a1f/src%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ee9daade3597dc6e94855ab9e90fc9ebfbea6a1f/src%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fexpr.rs?ref=ee9daade3597dc6e94855ab9e90fc9ebfbea6a1f", "patch": "@@ -1715,10 +1715,19 @@ fn rewrite_call_inner<R>(context: &RewriteContext,\n         }\n     }\n \n+    let one_line_width = shape.width.checked_sub(used_width + 2);\n+    let one_line_width = match one_line_width {\n+        Some(olw) => olw,\n+        None => return Err(Ordering::Greater),\n+    };\n+    let one_line_shape = Shape {\n+        width: one_line_width,\n+        ..nested_shape\n+    };\n     let tactic =\n         definitive_tactic(&item_vec,\n                           ListTactic::LimitedHorizontalVertical(context.config.fn_call_width),\n-                          nested_shape.width);\n+                          one_line_width);\n \n     // Replace the stub with the full overflowing last argument if the rewrite\n     // succeeded and its first line fits with the other arguments.\n@@ -1741,7 +1750,7 @@ fn rewrite_call_inner<R>(context: &RewriteContext,\n         } else {\n             context.config.trailing_comma\n         },\n-        shape: nested_shape,\n+        shape: one_line_shape,\n         ends_with_newline: false,\n         config: context.config,\n     };"}, {"sha": "e11df34ad86da36c539d7c4e7f2028db5fe2d761", "filename": "tests/source/fn-simple.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/ee9daade3597dc6e94855ab9e90fc9ebfbea6a1f/tests%2Fsource%2Ffn-simple.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ee9daade3597dc6e94855ab9e90fc9ebfbea6a1f/tests%2Fsource%2Ffn-simple.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Ffn-simple.rs?ref=ee9daade3597dc6e94855ab9e90fc9ebfbea6a1f", "patch": "@@ -44,3 +44,12 @@ unsafe fn generic_call(cx: *mut JSContext, argc: libc::c_uint, vp: *mut JSVal,\n }\n \n pub fn start_export_thread<C: CryptoSchemee + 'static>(database: &Database, crypto_scheme: &C, block_size: usize, source_path: &Path) -> BonzoResult<mpsc::Consumer<'static, FileInstruction>> {}\n+\n+pub fn waltz(cwd: &Path) -> CliAssert {\n+    {\n+        {\n+            formatted_comment = rewrite_comment(comment, block_style, width, offset, formatting_fig);\n+        }\n+    }\n+\n+}"}, {"sha": "697fe21501c3d4cceb1788f8f1cdcb0492ed7718", "filename": "tests/target/fn-simple.rs", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/ee9daade3597dc6e94855ab9e90fc9ebfbea6a1f/tests%2Ftarget%2Ffn-simple.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ee9daade3597dc6e94855ab9e90fc9ebfbea6a1f/tests%2Ftarget%2Ffn-simple.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Ffn-simple.rs?ref=ee9daade3597dc6e94855ab9e90fc9ebfbea6a1f", "patch": "@@ -73,3 +73,13 @@ pub fn start_export_thread<C: CryptoSchemee + 'static>\n      source_path: &Path)\n      -> BonzoResult<mpsc::Consumer<'static, FileInstruction>> {\n }\n+\n+pub fn waltz(cwd: &Path) -> CliAssert {\n+    {\n+        {\n+            formatted_comment =\n+                rewrite_comment(comment, block_style, width, offset, formatting_fig);\n+        }\n+    }\n+\n+}"}]}