{"sha": "bd63edc07aad0c3fa7300505cf45bacb6bfb650f", "node_id": "C_kwDOAAsO6NoAKGJkNjNlZGMwN2FhZDBjM2ZhNzMwMDUwNWNmNDViYWNiNmJmYjY1MGY", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2023-02-19T13:47:55Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-02-19T13:47:55Z"}, "message": "Rollup merge of #108129 - GuillaumeGomez:correctly-handle-links-starting-with-whitespace, r=petrochenkov\n\nCorrectly handle links starting with whitespace\n\nPart of https://github.com/rust-lang/rust/issues/107995.\n\nI just got this issue, wrote a fix and then saw the issue. So here's the PR. ^^'\n\nr? `@petrochenkov`", "tree": {"sha": "87a2f833eeb71aafa899ae311952082a9c7d0a0e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/87a2f833eeb71aafa899ae311952082a9c7d0a0e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bd63edc07aad0c3fa7300505cf45bacb6bfb650f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJj8iiLCRBK7hj4Ov3rIwAA1/4IAHq/pLIFBiZ5mCBeFfFi0fMR\n0Ou+4rVLPIub7j5QwDUCvlPWljU8c4Zy1/VfTXNlUFh32eoZe5VzBhcObYmorQ6O\nBgn/tQM/GGpBV9j0R/7lCECUAr21BoswXWplKwXJ/017qH0HRH6sTpFnhm0OoXSE\ntj0UulKpjUaUpW/vbRWZgH6EEIJCDfSHJRRum5dLWi1EQJ/Y/DiruqlTe745aY3G\nEPfIgxvahOCS20/d0S49p/nKb52k8XpXXFO8hO5RsHBEENJSGgWtfGBgJWvQb5Im\nneqeY0nwV9mbxm33vzAoViMiNOJ49cm2NN5g5BZ+KavwFMhPh0dxD6LNNaa9R80=\n=gfvl\n-----END PGP SIGNATURE-----\n", "payload": "tree 87a2f833eeb71aafa899ae311952082a9c7d0a0e\nparent 49d7ed1dbef6744cd9a27fdae086c9b80fb4ed46\nparent 8d801fd3983d83ee701beb35b86d3d5b6540890e\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1676814475 +0100\ncommitter GitHub <noreply@github.com> 1676814475 +0100\n\nRollup merge of #108129 - GuillaumeGomez:correctly-handle-links-starting-with-whitespace, r=petrochenkov\n\nCorrectly handle links starting with whitespace\n\nPart of https://github.com/rust-lang/rust/issues/107995.\n\nI just got this issue, wrote a fix and then saw the issue. So here's the PR. ^^'\n\nr? `@petrochenkov`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bd63edc07aad0c3fa7300505cf45bacb6bfb650f", "html_url": "https://github.com/rust-lang/rust/commit/bd63edc07aad0c3fa7300505cf45bacb6bfb650f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bd63edc07aad0c3fa7300505cf45bacb6bfb650f/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "49d7ed1dbef6744cd9a27fdae086c9b80fb4ed46", "url": "https://api.github.com/repos/rust-lang/rust/commits/49d7ed1dbef6744cd9a27fdae086c9b80fb4ed46", "html_url": "https://github.com/rust-lang/rust/commit/49d7ed1dbef6744cd9a27fdae086c9b80fb4ed46"}, {"sha": "8d801fd3983d83ee701beb35b86d3d5b6540890e", "url": "https://api.github.com/repos/rust-lang/rust/commits/8d801fd3983d83ee701beb35b86d3d5b6540890e", "html_url": "https://github.com/rust-lang/rust/commit/8d801fd3983d83ee701beb35b86d3d5b6540890e"}], "stats": {"total": 34, "additions": 32, "deletions": 2}, "files": [{"sha": "5e4b66018e42ec9e0b3263301cdb65f3558ee974", "filename": "compiler/rustc_resolve/src/rustdoc.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/bd63edc07aad0c3fa7300505cf45bacb6bfb650f/compiler%2Frustc_resolve%2Fsrc%2Frustdoc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bd63edc07aad0c3fa7300505cf45bacb6bfb650f/compiler%2Frustc_resolve%2Fsrc%2Frustdoc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_resolve%2Fsrc%2Frustdoc.rs?ref=bd63edc07aad0c3fa7300505cf45bacb6bfb650f", "patch": "@@ -339,6 +339,7 @@ pub fn inner_docs(attrs: &[ast::Attribute]) -> bool {\n fn preprocess_link(link: &str) -> String {\n     let link = link.replace('`', \"\");\n     let link = link.split('#').next().unwrap();\n+    let link = link.trim();\n     let link = link.rsplit('@').next().unwrap();\n     let link = link.strip_suffix(\"()\").unwrap_or(link);\n     let link = link.strip_suffix(\"{}\").unwrap_or(link);"}, {"sha": "920a3b22f25a2f610cbe93f50d07a16a3e6ce5ce", "filename": "src/librustdoc/passes/collect_intra_doc_links.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/bd63edc07aad0c3fa7300505cf45bacb6bfb650f/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bd63edc07aad0c3fa7300505cf45bacb6bfb650f/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs?ref=bd63edc07aad0c3fa7300505cf45bacb6bfb650f", "patch": "@@ -884,7 +884,8 @@ fn preprocess_link(\n     let mut parts = stripped.split('#');\n \n     let link = parts.next().unwrap();\n-    if link.trim().is_empty() {\n+    let link = link.trim();\n+    if link.is_empty() {\n         // This is an anchor to an element of the current page, nothing to do in here!\n         return None;\n     }\n@@ -897,7 +898,7 @@ fn preprocess_link(\n     // Parse and strip the disambiguator from the link, if present.\n     let (disambiguator, path_str, link_text) = match Disambiguator::from_str(link) {\n         Ok(Some((d, path, link_text))) => (Some(d), path.trim(), link_text.trim()),\n-        Ok(None) => (None, link.trim(), link.trim()),\n+        Ok(None) => (None, link, link),\n         Err((err_msg, relative_range)) => {\n             // Only report error if we would not have ignored this link. See issue #83859.\n             if !should_ignore_link_with_disambiguators(link) {"}, {"sha": "1273e4fdd12ebd876806b09eb01119973f8077e9", "filename": "tests/rustdoc/issue-107995.rs", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/bd63edc07aad0c3fa7300505cf45bacb6bfb650f/tests%2Frustdoc%2Fissue-107995.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bd63edc07aad0c3fa7300505cf45bacb6bfb650f/tests%2Frustdoc%2Fissue-107995.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fissue-107995.rs?ref=bd63edc07aad0c3fa7300505cf45bacb6bfb650f", "patch": "@@ -0,0 +1,28 @@\n+// Regression test for <https://github.com/rust-lang/rust/issues/107995>.\n+\n+#![crate_name = \"foo\"]\n+\n+// @has 'foo/fn.foo.html'\n+// @has - '//*[@class=\"docblock\"]//a[@href=\"fn.bar.html\"]' 'bar`'\n+/// A foo, see also [ bar`]\n+pub fn foo() {}\n+\n+// @has 'foo/fn.bar.html'\n+// @has - '//*[@class=\"docblock\"]' 'line Path line'\n+// @has - '//*[@class=\"docblock\"]//a[@href=\"struct.Path.html\"]' 'Path'\n+#[doc = \"line [\"]\n+#[doc = \"Path\"]\n+#[doc = \"] line\"]\n+pub fn bar() {}\n+\n+// @has 'foo/fn.another.html'\n+// @has - '//*[@class=\"docblock\"]//a[@href=\"struct.Path.html\"]' 'Path'\n+/// [ `Path`]\n+pub fn another() {}\n+\n+// @has 'foo/fn.last.html'\n+// @has - '//*[@class=\"docblock\"]//a[@href=\"struct.Path.html\"]' 'Path'\n+/// [ Path`]\n+pub fn last() {}\n+\n+pub struct Path;"}]}