{"sha": "e8fc9934097e67c3f3fe11874ad2a89694a80bf2", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU4ZmM5OTM0MDk3ZTY3YzNmM2ZlMTE4NzRhZDJhODk2OTRhODBiZjI=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2020-07-20T02:12:43Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-07-20T02:12:43Z"}, "message": "Rollup merge of #74534 - Mark-Simulacrum:rustdoc-stability, r=Manishearth\n\nOnly skip impls of foreign unstable traits\n\nPreviously unstable impls were skipped, which meant that any impl with an unstable method would get skipped.\n\nFixes #74531.", "tree": {"sha": "38ae37336d64597206b06f114752027ecc6d5387", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/38ae37336d64597206b06f114752027ecc6d5387"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e8fc9934097e67c3f3fe11874ad2a89694a80bf2", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfFP2cCRBK7hj4Ov3rIwAAdHIIAGk+B6g1jaAK4gx9eOjUGJvN\nCVdGZ7qHGalhp2zadTAroeqpaBj4f8xf+ZNk8CViuOh5sRvBRW+FW2XgvXqGccC9\nybtvdEmYRH1l6o5vWYbR5w2dFrqBevPjNwpNVeRGJQWynlJYjGdWvgPxrUxgMEL+\niSTCvtpWw3SIqPA2ehdm8EPRheEZLwCdh0QGhAfQugvg+h6lviBJdAeOQF7/qPen\nqOzbzZ9IJieI6j77tCfWuyIBeP5N+QS6qORk4YZMaRJwAS+d4NBUuraEpwwl9wwu\nvrT3RvuOTEZjlkps1dJTTkADHu8WNbh5nJFf/pI0jGiFnWANmpeF9NTh4yzg7HI=\n=wfHT\n-----END PGP SIGNATURE-----\n", "payload": "tree 38ae37336d64597206b06f114752027ecc6d5387\nparent 42273f6537ebf9f0cf35a7281789bb7eb50a59fd\nparent e24a0172b0df21b0bc17f3c9a16773d8889dd2b1\nauthor Manish Goregaokar <manishsmail@gmail.com> 1595211163 -0700\ncommitter GitHub <noreply@github.com> 1595211163 -0700\n\nRollup merge of #74534 - Mark-Simulacrum:rustdoc-stability, r=Manishearth\n\nOnly skip impls of foreign unstable traits\n\nPreviously unstable impls were skipped, which meant that any impl with an unstable method would get skipped.\n\nFixes #74531.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e8fc9934097e67c3f3fe11874ad2a89694a80bf2", "html_url": "https://github.com/rust-lang/rust/commit/e8fc9934097e67c3f3fe11874ad2a89694a80bf2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e8fc9934097e67c3f3fe11874ad2a89694a80bf2/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "42273f6537ebf9f0cf35a7281789bb7eb50a59fd", "url": "https://api.github.com/repos/rust-lang/rust/commits/42273f6537ebf9f0cf35a7281789bb7eb50a59fd", "html_url": "https://github.com/rust-lang/rust/commit/42273f6537ebf9f0cf35a7281789bb7eb50a59fd"}, {"sha": "e24a0172b0df21b0bc17f3c9a16773d8889dd2b1", "url": "https://api.github.com/repos/rust-lang/rust/commits/e24a0172b0df21b0bc17f3c9a16773d8889dd2b1", "html_url": "https://github.com/rust-lang/rust/commit/e24a0172b0df21b0bc17f3c9a16773d8889dd2b1"}], "stats": {"total": 45, "additions": 42, "deletions": 3}, "files": [{"sha": "1f576a17dd9d665cfe1d147e1ec0b7108b41773c", "filename": "src/librustdoc/clean/inline.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/e8fc9934097e67c3f3fe11874ad2a89694a80bf2/src%2Flibrustdoc%2Fclean%2Finline.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e8fc9934097e67c3f3fe11874ad2a89694a80bf2/src%2Flibrustdoc%2Fclean%2Finline.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Finline.rs?ref=e8fc9934097e67c3f3fe11874ad2a89694a80bf2", "patch": "@@ -346,9 +346,11 @@ pub fn build_impl(\n         // such. This helps prevent dependencies of the standard library, for\n         // example, from getting documented as \"traits `u32` implements\" which\n         // isn't really too helpful.\n-        if let Some(stab) = cx.tcx.lookup_stability(did) {\n-            if stab.level.is_unstable() {\n-                return;\n+        if let Some(trait_did) = associated_trait {\n+            if let Some(stab) = cx.tcx.lookup_stability(trait_did.def_id) {\n+                if stab.level.is_unstable() {\n+                    return;\n+                }\n             }\n         }\n     }"}, {"sha": "6f06a6e2656d7b2077af1190619a07acb939a647", "filename": "src/test/rustdoc/auxiliary/unstable-trait.rs", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/e8fc9934097e67c3f3fe11874ad2a89694a80bf2/src%2Ftest%2Frustdoc%2Fauxiliary%2Funstable-trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e8fc9934097e67c3f3fe11874ad2a89694a80bf2/src%2Ftest%2Frustdoc%2Fauxiliary%2Funstable-trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fauxiliary%2Funstable-trait.rs?ref=e8fc9934097e67c3f3fe11874ad2a89694a80bf2", "patch": "@@ -0,0 +1,26 @@\n+#![feature(staged_api)]\n+#![stable(feature = \"private_general\", since = \"1.0.0\")]\n+\n+#[unstable(feature = \"private_trait\", issue = \"none\")]\n+pub trait Bar {}\n+\n+#[stable(feature = \"private_general\", since = \"1.0.0\")]\n+pub struct Foo {\n+    // nothing\n+}\n+\n+impl Foo {\n+    #[stable(feature = \"private_general\", since = \"1.0.0\")]\n+    pub fn stable_impl() {}\n+}\n+\n+impl Foo {\n+    #[unstable(feature = \"private_trait\", issue = \"none\")]\n+    pub fn bar() {}\n+\n+    #[stable(feature = \"private_general\", since = \"1.0.0\")]\n+    pub fn bar2() {}\n+}\n+\n+#[stable(feature = \"private_general\", since = \"1.0.0\")]\n+impl Bar for Foo {}"}, {"sha": "c30d6ed7b52203d42f524a095311f3be286ea26c", "filename": "src/test/rustdoc/hide-unstable-trait.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/e8fc9934097e67c3f3fe11874ad2a89694a80bf2/src%2Ftest%2Frustdoc%2Fhide-unstable-trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e8fc9934097e67c3f3fe11874ad2a89694a80bf2/src%2Ftest%2Frustdoc%2Fhide-unstable-trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fhide-unstable-trait.rs?ref=e8fc9934097e67c3f3fe11874ad2a89694a80bf2", "patch": "@@ -0,0 +1,11 @@\n+// aux-build:unstable-trait.rs\n+\n+#![crate_name = \"foo\"]\n+#![feature(private_trait)]\n+\n+extern crate unstable_trait;\n+\n+// @has foo/struct.Foo.html 'bar'\n+// @has foo/struct.Foo.html 'bar2'\n+#[doc(inline)]\n+pub use unstable_trait::Foo;"}]}