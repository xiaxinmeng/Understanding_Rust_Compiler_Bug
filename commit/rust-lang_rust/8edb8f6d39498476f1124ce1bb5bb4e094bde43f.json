{"sha": "8edb8f6d39498476f1124ce1bb5bb4e094bde43f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhlZGI4ZjZkMzk0OTg0NzZmMTEyNGNlMWJiNWJiNGUwOTRiZGU0M2Y=", "commit": {"author": {"name": "gifnksm", "email": "makoto.nksm+github@gmail.com", "date": "2013-06-26T21:51:04Z"}, "committer": {"name": "gifnksm", "email": "makoto.nksm+github@gmail.com", "date": "2013-06-26T21:55:22Z"}, "message": "iterator: Add `IteratorUtil::max_by/min_by` method", "tree": {"sha": "281bff294e7145b952774aedb60e3b7179c2e660", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/281bff294e7145b952774aedb60e3b7179c2e660"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8edb8f6d39498476f1124ce1bb5bb4e094bde43f", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8edb8f6d39498476f1124ce1bb5bb4e094bde43f", "html_url": "https://github.com/rust-lang/rust/commit/8edb8f6d39498476f1124ce1bb5bb4e094bde43f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8edb8f6d39498476f1124ce1bb5bb4e094bde43f/comments", "author": {"login": "gifnksm", "id": 164213, "node_id": "MDQ6VXNlcjE2NDIxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/164213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gifnksm", "html_url": "https://github.com/gifnksm", "followers_url": "https://api.github.com/users/gifnksm/followers", "following_url": "https://api.github.com/users/gifnksm/following{/other_user}", "gists_url": "https://api.github.com/users/gifnksm/gists{/gist_id}", "starred_url": "https://api.github.com/users/gifnksm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gifnksm/subscriptions", "organizations_url": "https://api.github.com/users/gifnksm/orgs", "repos_url": "https://api.github.com/users/gifnksm/repos", "events_url": "https://api.github.com/users/gifnksm/events{/privacy}", "received_events_url": "https://api.github.com/users/gifnksm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "gifnksm", "id": 164213, "node_id": "MDQ6VXNlcjE2NDIxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/164213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gifnksm", "html_url": "https://github.com/gifnksm", "followers_url": "https://api.github.com/users/gifnksm/followers", "following_url": "https://api.github.com/users/gifnksm/following{/other_user}", "gists_url": "https://api.github.com/users/gifnksm/gists{/gist_id}", "starred_url": "https://api.github.com/users/gifnksm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gifnksm/subscriptions", "organizations_url": "https://api.github.com/users/gifnksm/orgs", "repos_url": "https://api.github.com/users/gifnksm/repos", "events_url": "https://api.github.com/users/gifnksm/events{/privacy}", "received_events_url": "https://api.github.com/users/gifnksm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "23fb2278c7c50cf5785b1c109bc399bf87fdd542", "url": "https://api.github.com/repos/rust-lang/rust/commits/23fb2278c7c50cf5785b1c109bc399bf87fdd542", "html_url": "https://github.com/rust-lang/rust/commit/23fb2278c7c50cf5785b1c109bc399bf87fdd542"}], "stats": {"total": 62, "additions": 62, "deletions": 0}, "files": [{"sha": "9e434272198afcd6409929386148f44112ae58a8", "filename": "src/libstd/iterator.rs", "status": "modified", "additions": 62, "deletions": 0, "changes": 62, "blob_url": "https://github.com/rust-lang/rust/blob/8edb8f6d39498476f1124ce1bb5bb4e094bde43f/src%2Flibstd%2Fiterator.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8edb8f6d39498476f1124ce1bb5bb4e094bde43f/src%2Flibstd%2Fiterator.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fiterator.rs?ref=8edb8f6d39498476f1124ce1bb5bb4e094bde43f", "patch": "@@ -351,6 +351,26 @@ pub trait IteratorUtil<A> {\n \n     /// Count the number of elements satisfying the specified predicate\n     fn count(&mut self, predicate: &fn(A) -> bool) -> uint;\n+\n+    /// Return the element that gives the maximum value from the specfied function\n+    ///\n+    /// # Example\n+    ///\n+    /// --- {.rust}\n+    /// let xs = [-3, 0, 1, 5, -10];\n+    /// assert_eq!(*xs.iter().max_by(|x| x.abs()).unwrap(), -10);\n+    /// ---\n+    fn max_by<B: Ord>(&mut self, f: &fn(&A) -> B) -> Option<A>;\n+\n+    /// Return the element that gives the minimum value from the specfied function\n+    ///\n+    /// # Example\n+    ///\n+    /// --- {.rust}\n+    /// let xs = [-3, 0, 1, 5, -10];\n+    /// assert_eq!(*xs.iter().min_by(|x| x.abs()).unwrap(), 0);\n+    /// ---\n+    fn min_by<B: Ord>(&mut self, f: &fn(&A) -> B) -> Option<A>;\n }\n \n /// Iterator adaptors provided for every `Iterator` implementation. The adaptor objects are also\n@@ -519,6 +539,36 @@ impl<A, T: Iterator<A>> IteratorUtil<A> for T {\n         }\n         i\n     }\n+\n+    #[inline]\n+    fn max_by<B: Ord>(&mut self, f: &fn(&A) -> B) -> Option<A> {\n+        self.fold(None, |max: Option<(A, B)>, x| {\n+            let x_val = f(&x);\n+            match max {\n+                None             => Some((x, x_val)),\n+                Some((y, y_val)) => if x_val > y_val {\n+                    Some((x, x_val))\n+                } else {\n+                    Some((y, y_val))\n+                }\n+            }\n+        }).map_consume(|(x, _)| x)\n+    }\n+\n+    #[inline]\n+    fn min_by<B: Ord>(&mut self, f: &fn(&A) -> B) -> Option<A> {\n+        self.fold(None, |min: Option<(A, B)>, x| {\n+            let x_val = f(&x);\n+            match min {\n+                None             => Some((x, x_val)),\n+                Some((y, y_val)) => if x_val < y_val {\n+                    Some((x, x_val))\n+                } else {\n+                    Some((y, y_val))\n+                }\n+            }\n+        }).map_consume(|(x, _)| x)\n+    }\n }\n \n /// A trait for iterators over elements which can be added together\n@@ -1237,4 +1287,16 @@ mod tests {\n         assert_eq!(xs.iter().count(|x| *x == 5), 1);\n         assert_eq!(xs.iter().count(|x| *x == 95), 0);\n     }\n+\n+    #[test]\n+    fn test_max_by() {\n+        let xs = [-3, 0, 1, 5, -10];\n+        assert_eq!(*xs.iter().max_by(|x| x.abs()).unwrap(), -10);\n+    }\n+\n+    #[test]\n+    fn test_min_by() {\n+        let xs = [-3, 0, 1, 5, -10];\n+        assert_eq!(*xs.iter().min_by(|x| x.abs()).unwrap(), 0);\n+    }\n }"}]}