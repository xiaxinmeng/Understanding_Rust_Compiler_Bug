{"sha": "d8b382105f1cb6faeb7e500481720d3433bf87ae", "node_id": "C_kwDOAAsO6NoAKGQ4YjM4MjEwNWYxY2I2ZmFlYjdlNTAwNDgxNzIwZDM0MzNiZjg3YWU", "commit": {"author": {"name": "bjorn3", "email": "17426603+bjorn3@users.noreply.github.com", "date": "2022-09-06T18:08:04Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-09-06T18:08:04Z"}, "message": "Compile spin_loop_hint as pause on x86 even without sse2 enabled\n\nThe x86 `pause` instruction was introduced with sse2, but because it is encoded as `rep nop`, it works just fine on cpu's without sse2 support. It just doesn't do anything.", "tree": {"sha": "24bf97aa1864d89b392b3e8b4596823c781a9f7e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/24bf97aa1864d89b392b3e8b4596823c781a9f7e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d8b382105f1cb6faeb7e500481720d3433bf87ae", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjF4yECRBK7hj4Ov3rIwAAbdkIAHWlobG1QgjIkDb+veCSkdDL\nj9305b4hlbC365WUroE6EPIuIyMeaITfg/50MJowoOVhWP6bsnheZ9h1vsTZ8Xmi\nW0CB/OlwcI/wcNWw+Z/toPcMmX/wBKUydRiPFgOFWjvl1WJjXLmosrtKXp/Q8rGa\no9iroou3gGgrzR0ZebMsOrNjhYFb2vSKZTbSbeZUG36tmBMiDLF/6Kl6+YmbKGLL\ns+1FPL1kS1phh3XFFdfVMIjvn/dQAUo5GN/tlb2ef05tCfuQ2T9WbSHhr3bbWqH4\n6a3wfX0+7ULQlYKOdSxLIJd8dql3UJQkrRxpHdZiX6aooEnD6EY4fStzUl86leY=\n=m/tg\n-----END PGP SIGNATURE-----\n", "payload": "tree 24bf97aa1864d89b392b3e8b4596823c781a9f7e\nparent 3c7278846102bb829c9a789e91bc43f0ed612943\nauthor bjorn3 <17426603+bjorn3@users.noreply.github.com> 1662487684 +0200\ncommitter GitHub <noreply@github.com> 1662487684 +0200\n\nCompile spin_loop_hint as pause on x86 even without sse2 enabled\n\nThe x86 `pause` instruction was introduced with sse2, but because it is encoded as `rep nop`, it works just fine on cpu's without sse2 support. It just doesn't do anything."}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d8b382105f1cb6faeb7e500481720d3433bf87ae", "html_url": "https://github.com/rust-lang/rust/commit/d8b382105f1cb6faeb7e500481720d3433bf87ae", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d8b382105f1cb6faeb7e500481720d3433bf87ae/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3c7278846102bb829c9a789e91bc43f0ed612943", "url": "https://api.github.com/repos/rust-lang/rust/commits/3c7278846102bb829c9a789e91bc43f0ed612943", "html_url": "https://github.com/rust-lang/rust/commit/3c7278846102bb829c9a789e91bc43f0ed612943"}], "stats": {"total": 19, "additions": 8, "deletions": 11}, "files": [{"sha": "764e2796202c9ef72626e8cdda1a9ccdfc2b14e0", "filename": "library/core/src/hint.rs", "status": "modified", "additions": 8, "deletions": 11, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/d8b382105f1cb6faeb7e500481720d3433bf87ae/library%2Fcore%2Fsrc%2Fhint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d8b382105f1cb6faeb7e500481720d3433bf87ae/library%2Fcore%2Fsrc%2Fhint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fhint.rs?ref=d8b382105f1cb6faeb7e500481720d3433bf87ae", "patch": "@@ -160,19 +160,16 @@ pub const unsafe fn unreachable_unchecked() -> ! {\n #[inline]\n #[stable(feature = \"renamed_spin_loop\", since = \"1.49.0\")]\n pub fn spin_loop() {\n-    #[cfg(all(any(target_arch = \"x86\", target_arch = \"x86_64\"), target_feature = \"sse2\"))]\n+    #[cfg(target_arch = \"x86\")]\n     {\n-        #[cfg(target_arch = \"x86\")]\n-        {\n-            // SAFETY: the `cfg` attr ensures that we only execute this on x86 targets.\n-            unsafe { crate::arch::x86::_mm_pause() };\n-        }\n+        // SAFETY: the `cfg` attr ensures that we only execute this on x86 targets.\n+        unsafe { crate::arch::x86::_mm_pause() };\n+    }\n \n-        #[cfg(target_arch = \"x86_64\")]\n-        {\n-            // SAFETY: the `cfg` attr ensures that we only execute this on x86_64 targets.\n-            unsafe { crate::arch::x86_64::_mm_pause() };\n-        }\n+    #[cfg(target_arch = \"x86_64\")]\n+    {\n+        // SAFETY: the `cfg` attr ensures that we only execute this on x86_64 targets.\n+        unsafe { crate::arch::x86_64::_mm_pause() };\n     }\n \n     // RISC-V platform spin loop hint implementation"}]}