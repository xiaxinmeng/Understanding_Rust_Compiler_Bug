{"sha": "032eb3d68e07f087ac531d48f956a79948baa4b9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAzMmViM2Q2OGUwN2YwODdhYzUzMWQ0OGY5NTZhNzk5NDhiYWE0Yjk=", "commit": {"author": {"name": "ice1000", "email": "ice1000kotlin@foxmail.com", "date": "2019-12-03T20:58:38Z"}, "committer": {"name": "ice1000", "email": "ice1000kotlin@foxmail.com", "date": "2019-12-04T23:30:42Z"}, "message": "Remove almost unused `ModuleSource::new`", "tree": {"sha": "99489ada57e661205e781832b0beaf3107adfdeb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/99489ada57e661205e781832b0beaf3107adfdeb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/032eb3d68e07f087ac531d48f956a79948baa4b9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/032eb3d68e07f087ac531d48f956a79948baa4b9", "html_url": "https://github.com/rust-lang/rust/commit/032eb3d68e07f087ac531d48f956a79948baa4b9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/032eb3d68e07f087ac531d48f956a79948baa4b9/comments", "author": {"login": "ice1000", "id": 16398479, "node_id": "MDQ6VXNlcjE2Mzk4NDc5", "avatar_url": "https://avatars.githubusercontent.com/u/16398479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ice1000", "html_url": "https://github.com/ice1000", "followers_url": "https://api.github.com/users/ice1000/followers", "following_url": "https://api.github.com/users/ice1000/following{/other_user}", "gists_url": "https://api.github.com/users/ice1000/gists{/gist_id}", "starred_url": "https://api.github.com/users/ice1000/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ice1000/subscriptions", "organizations_url": "https://api.github.com/users/ice1000/orgs", "repos_url": "https://api.github.com/users/ice1000/repos", "events_url": "https://api.github.com/users/ice1000/events{/privacy}", "received_events_url": "https://api.github.com/users/ice1000/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ice1000", "id": 16398479, "node_id": "MDQ6VXNlcjE2Mzk4NDc5", "avatar_url": "https://avatars.githubusercontent.com/u/16398479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ice1000", "html_url": "https://github.com/ice1000", "followers_url": "https://api.github.com/users/ice1000/followers", "following_url": "https://api.github.com/users/ice1000/following{/other_user}", "gists_url": "https://api.github.com/users/ice1000/gists{/gist_id}", "starred_url": "https://api.github.com/users/ice1000/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ice1000/subscriptions", "organizations_url": "https://api.github.com/users/ice1000/orgs", "repos_url": "https://api.github.com/users/ice1000/repos", "events_url": "https://api.github.com/users/ice1000/events{/privacy}", "received_events_url": "https://api.github.com/users/ice1000/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5c5f90ba57c83499a44af33bf8b91b24254fb685", "url": "https://api.github.com/repos/rust-lang/rust/commits/5c5f90ba57c83499a44af33bf8b91b24254fb685", "html_url": "https://github.com/rust-lang/rust/commit/5c5f90ba57c83499a44af33bf8b91b24254fb685"}], "stats": {"total": 22, "additions": 2, "deletions": 20}, "files": [{"sha": "67b127ba5743937055e4751335236253430bea01", "filename": "crates/ra_hir/src/from_source.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/032eb3d68e07f087ac531d48f956a79948baa4b9/crates%2Fra_hir%2Fsrc%2Ffrom_source.rs", "raw_url": "https://github.com/rust-lang/rust/raw/032eb3d68e07f087ac531d48f956a79948baa4b9/crates%2Fra_hir%2Fsrc%2Ffrom_source.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Ffrom_source.rs?ref=032eb3d68e07f087ac531d48f956a79948baa4b9", "patch": "@@ -238,7 +238,7 @@ impl Module {\n             _ => {\n                 let src_parent = InFile {\n                     file_id: src.file_id,\n-                    value: ModuleSource::new(db, Some(src.file_id.original_file(db)), None),\n+                    value: ModuleSource::from_file_id(db, src.file_id.original_file(db)),\n                 };\n                 Module::from_definition(db, src_parent)\n             }"}, {"sha": "ce318571c61ad82df2ffa487d67a463bf6eed93e", "filename": "crates/ra_hir_def/src/nameres.rs", "status": "modified", "additions": 1, "deletions": 19, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/032eb3d68e07f087ac531d48f956a79948baa4b9/crates%2Fra_hir_def%2Fsrc%2Fnameres.rs", "raw_url": "https://github.com/rust-lang/rust/raw/032eb3d68e07f087ac531d48f956a79948baa4b9/crates%2Fra_hir_def%2Fsrc%2Fnameres.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir_def%2Fsrc%2Fnameres.rs?ref=032eb3d68e07f087ac531d48f956a79948baa4b9", "patch": "@@ -356,32 +356,14 @@ impl ModuleData {\n     }\n }\n \n+#[derive(Debug, Clone, PartialEq, Eq)]\n pub enum ModuleSource {\n     SourceFile(ast::SourceFile),\n     Module(ast::Module),\n     Block(ast::Block),\n }\n \n impl ModuleSource {\n-    pub fn new(\n-        db: &impl DefDatabase,\n-        file_id: Option<FileId>,\n-        decl_id: Option<AstId<ast::Module>>,\n-    ) -> ModuleSource {\n-        match (file_id, decl_id) {\n-            (Some(file_id), _) => {\n-                let source_file = db.parse(file_id).tree();\n-                ModuleSource::SourceFile(source_file)\n-            }\n-            (None, Some(item_id)) => {\n-                let module = item_id.to_node(db);\n-                assert!(module.item_list().is_some(), \"expected inline module\");\n-                ModuleSource::Module(module)\n-            }\n-            (None, None) => panic!(),\n-        }\n-    }\n-\n     // FIXME: this methods do not belong here\n     pub fn from_position(db: &impl DefDatabase, position: FilePosition) -> ModuleSource {\n         let parse = db.parse(position.file_id);"}]}