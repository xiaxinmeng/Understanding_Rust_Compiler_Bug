{"sha": "bd4b984537bd33c9625212c9ccbb3a6084001407", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJkNGI5ODQ1MzdiZDMzYzk2MjUyMTJjOWNjYmIzYTYwODQwMDE0MDc=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2015-04-29T15:18:44Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2015-04-29T15:18:44Z"}, "message": "add `--enable-debuginfo-tests`, analogous to `--disable-optimize-tests`.\n\nThen, decouple the question of whether the compiler/stdlib carry\ndebuginfo (which is controlled via `--enable-debuginfo` and implied by\n`--enable-debug`) from the question of whether the tests carry\ndebuginfo (which now no longer is implied by `--enable-debug` nor\n`--enable-debuginfo`, and is off by default).", "tree": {"sha": "a755ace580a4016248d289886a3fcb62f3243f11", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a755ace580a4016248d289886a3fcb62f3243f11"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bd4b984537bd33c9625212c9ccbb3a6084001407", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bd4b984537bd33c9625212c9ccbb3a6084001407", "html_url": "https://github.com/rust-lang/rust/commit/bd4b984537bd33c9625212c9ccbb3a6084001407", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bd4b984537bd33c9625212c9ccbb3a6084001407/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "551a74dddd84cf01440ee84148ebd18bc68bd7c8", "url": "https://api.github.com/repos/rust-lang/rust/commits/551a74dddd84cf01440ee84148ebd18bc68bd7c8", "html_url": "https://github.com/rust-lang/rust/commit/551a74dddd84cf01440ee84148ebd18bc68bd7c8"}], "stats": {"total": 8, "additions": 8, "deletions": 0}, "files": [{"sha": "dbca73415fec62d11ef151ff41d2592d19d981a8", "filename": "configure", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/bd4b984537bd33c9625212c9ccbb3a6084001407/configure", "raw_url": "https://github.com/rust-lang/rust/raw/bd4b984537bd33c9625212c9ccbb3a6084001407/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=bd4b984537bd33c9625212c9ccbb3a6084001407", "patch": "@@ -551,6 +551,7 @@ opt valgrind-rpass 1 \"run rpass-valgrind tests with valgrind\"\n opt docs     1 \"build standard library documentation\"\n opt compiler-docs     0 \"build compiler documentation\"\n opt optimize-tests 1 \"build tests with optimizations\"\n+opt debuginfo-tests 0 \"build tests with debugger metadata\"\n opt libcpp 1 \"build with llvm with libc++ instead of libstdc++ when using clang\"\n opt llvm-assertions 0 \"build LLVM with assertions\"\n opt debug-assertions 0 \"build with debugging assertions\""}, {"sha": "f391d8555fc2bff578a2a6c329b79cf71aa84542", "filename": "mk/tests.mk", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/bd4b984537bd33c9625212c9ccbb3a6084001407/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/bd4b984537bd33c9625212c9ccbb3a6084001407/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=bd4b984537bd33c9625212c9ccbb3a6084001407", "patch": "@@ -632,6 +632,13 @@ ifndef CFG_DISABLE_OPTIMIZE_TESTS\n CTEST_RUSTC_FLAGS += -O\n endif\n \n+# Analogously to the above, whether to pass `-g` when compiling tests\n+# is a separate choice from whether to pass `-g` when building the\n+# compiler and standard library themselves.\n+CTEST_RUSTC_FLAGS := $$(subst -g,,$$(CTEST_RUSTC_FLAGS))\n+ifdef CFG_ENABLE_DEBUGINFO_TESTS\n+CTEST_RUSTC_FLAGS += -g\n+endif\n \n CTEST_COMMON_ARGS$(1)-T-$(2)-H-$(3) := \\\n \t\t--compile-lib-path $$(HLIB$(1)_H_$(3)) \\"}]}