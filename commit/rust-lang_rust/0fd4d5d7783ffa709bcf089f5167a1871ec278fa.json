{"sha": "0fd4d5d7783ffa709bcf089f5167a1871ec278fa", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBmZDRkNWQ3NzgzZmZhNzA5YmNmMDg5ZjUxNjdhMTg3MWVjMjc4ZmE=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2013-07-17T04:12:16Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2013-07-17T04:28:10Z"}, "message": "Sort lint attributes to print them in a more sane way\n\nCloses #7818", "tree": {"sha": "2164c0143e85d04a4a7c58818cd91ac48ae0cf2c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2164c0143e85d04a4a7c58818cd91ac48ae0cf2c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0fd4d5d7783ffa709bcf089f5167a1871ec278fa", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0fd4d5d7783ffa709bcf089f5167a1871ec278fa", "html_url": "https://github.com/rust-lang/rust/commit/0fd4d5d7783ffa709bcf089f5167a1871ec278fa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0fd4d5d7783ffa709bcf089f5167a1871ec278fa/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9db190305f7562f15b5282fed508aef81cfc9689", "url": "https://api.github.com/repos/rust-lang/rust/commits/9db190305f7562f15b5282fed508aef81cfc9689", "html_url": "https://github.com/rust-lang/rust/commit/9db190305f7562f15b5282fed508aef81cfc9689"}], "stats": {"total": 34, "additions": 21, "deletions": 13}, "files": [{"sha": "d18fbada009a1441fdf977af05b03560771aea75", "filename": "src/librustc/middle/lint.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/0fd4d5d7783ffa709bcf089f5167a1871ec278fa/src%2Flibrustc%2Fmiddle%2Flint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0fd4d5d7783ffa709bcf089f5167a1871ec278fa/src%2Flibrustc%2Fmiddle%2Flint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Flint.rs?ref=0fd4d5d7783ffa709bcf089f5167a1871ec278fa", "patch": "@@ -108,17 +108,22 @@ pub fn level_to_str(lv: level) -> &'static str {\n     }\n }\n \n-#[deriving(Eq)]\n+#[deriving(Eq, Ord)]\n pub enum level {\n     allow, warn, deny, forbid\n }\n \n-struct LintSpec {\n+#[deriving(Eq)]\n+pub struct LintSpec {\n     lint: lint,\n     desc: &'static str,\n     default: level\n }\n \n+impl Ord for LintSpec {\n+    fn lt(&self, other: &LintSpec) -> bool { self.default < other.default }\n+}\n+\n pub type LintDict = HashMap<&'static str, LintSpec>;\n \n enum AttributedNode<'self> {"}, {"sha": "6f638959bc83002f28cbdb32d7af317db7992e09", "filename": "src/librustc/rustc.rs", "status": "modified", "additions": 14, "deletions": 11, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/0fd4d5d7783ffa709bcf089f5167a1871ec278fa/src%2Flibrustc%2Frustc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0fd4d5d7783ffa709bcf089f5167a1871ec278fa/src%2Flibrustc%2Frustc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Frustc.rs?ref=0fd4d5d7783ffa709bcf089f5167a1871ec278fa", "patch": "@@ -144,6 +144,7 @@ Additional help:\n }\n \n pub fn describe_warnings() {\n+    use extra::sort::Sort;\n     io::println(fmt!(\"\n Available lint options:\n     -W <foo>           Warn about <foo>\n@@ -153,8 +154,15 @@ Available lint options:\n \"));\n \n     let lint_dict = lint::get_lint_dict();\n+    let mut lint_dict = lint_dict.consume_iter()\n+                                 .transform(|(k, v)| (v, k))\n+                                 .collect::<~[(lint::LintSpec, &'static str)]>();\n+    lint_dict.qsort();\n+\n     let mut max_key = 0;\n-    for lint_dict.each_key |k| { max_key = num::max(k.len(), max_key); }\n+    for lint_dict.iter().advance |&(_, name)| {\n+        max_key = num::max(name.len(), max_key);\n+    }\n     fn padded(max: uint, s: &str) -> ~str {\n         str::from_bytes(vec::from_elem(max - s.len(), ' ' as u8)) + s\n     }\n@@ -163,17 +171,12 @@ Available lint options:\n                      padded(max_key, \"name\"), \"default\", \"meaning\"));\n     io::println(fmt!(\"    %s  %7.7s  %s\\n\",\n                      padded(max_key, \"----\"), \"-------\", \"-------\"));\n-    for lint_dict.iter().advance |(k, v)| {\n-        let k = k.replace(\"_\", \"-\");\n+    for lint_dict.consume_iter().advance |(spec, name)| {\n+        let name = name.replace(\"_\", \"-\");\n         io::println(fmt!(\"    %s  %7.7s  %s\",\n-                         padded(max_key, k),\n-                         match v.default {\n-                             lint::allow => ~\"allow\",\n-                             lint::warn => ~\"warn\",\n-                             lint::deny => ~\"deny\",\n-                             lint::forbid => ~\"forbid\"\n-                         },\n-                         v.desc));\n+                         padded(max_key, name),\n+                         lint::level_to_str(spec.default),\n+                         spec.desc));\n     }\n     io::println(\"\");\n }"}]}