{"sha": "905beab38ead75dcc283c641ebdaf84450e6e3c2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjkwNWJlYWIzOGVhZDc1ZGNjMjgzYzY0MWViZGFmODQ0NTBlNmUzYzI=", "commit": {"author": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2021-09-16T02:58:40Z"}, "committer": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2021-09-16T02:58:40Z"}, "message": "Reuse existing shared Lrc for MatchImpl parent\n\nThis is hopefully a small performance win for the hot path.", "tree": {"sha": "63b679c780825e321957fe54dfabff5baa096bde", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/63b679c780825e321957fe54dfabff5baa096bde"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/905beab38ead75dcc283c641ebdaf84450e6e3c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/905beab38ead75dcc283c641ebdaf84450e6e3c2", "html_url": "https://github.com/rust-lang/rust/commit/905beab38ead75dcc283c641ebdaf84450e6e3c2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/905beab38ead75dcc283c641ebdaf84450e6e3c2/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4aed1abb706a31331fd8b612ca400935aeddd0e0", "url": "https://api.github.com/repos/rust-lang/rust/commits/4aed1abb706a31331fd8b612ca400935aeddd0e0", "html_url": "https://github.com/rust-lang/rust/commit/4aed1abb706a31331fd8b612ca400935aeddd0e0"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "dec5e93a0265278e5c9d0f894c93d2334458fbf7", "filename": "compiler/rustc_infer/src/infer/error_reporting/nice_region_error/mismatched_static_lifetime.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/905beab38ead75dcc283c641ebdaf84450e6e3c2/compiler%2Frustc_infer%2Fsrc%2Finfer%2Ferror_reporting%2Fnice_region_error%2Fmismatched_static_lifetime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/905beab38ead75dcc283c641ebdaf84450e6e3c2/compiler%2Frustc_infer%2Fsrc%2Finfer%2Ferror_reporting%2Fnice_region_error%2Fmismatched_static_lifetime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_infer%2Fsrc%2Finfer%2Ferror_reporting%2Fnice_region_error%2Fmismatched_static_lifetime.rs?ref=905beab38ead75dcc283c641ebdaf84450e6e3c2", "patch": "@@ -33,7 +33,7 @@ impl<'a, 'tcx> NiceRegionError<'a, 'tcx> {\n             ObligationCauseCode::MatchImpl(parent, impl_def_id) => (parent, impl_def_id),\n             _ => return None,\n         };\n-        let binding_span = match **parent {\n+        let binding_span = match parent.code {\n             ObligationCauseCode::BindingObligation(_def_id, binding_span) => binding_span,\n             _ => return None,\n         };"}, {"sha": "2d47e72780ebe538cf759a48053ce88ba2ecef5b", "filename": "compiler/rustc_infer/src/infer/error_reporting/nice_region_error/static_impl_trait.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/905beab38ead75dcc283c641ebdaf84450e6e3c2/compiler%2Frustc_infer%2Fsrc%2Finfer%2Ferror_reporting%2Fnice_region_error%2Fstatic_impl_trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/905beab38ead75dcc283c641ebdaf84450e6e3c2/compiler%2Frustc_infer%2Fsrc%2Finfer%2Ferror_reporting%2Fnice_region_error%2Fstatic_impl_trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_infer%2Fsrc%2Finfer%2Ferror_reporting%2Fnice_region_error%2Fstatic_impl_trait.rs?ref=905beab38ead75dcc283c641ebdaf84450e6e3c2", "patch": "@@ -189,7 +189,7 @@ impl<'a, 'tcx> NiceRegionError<'a, 'tcx> {\n         }\n         if let SubregionOrigin::Subtype(box TypeTrace { cause, .. }) = &sub_origin {\n             let code = match &cause.code {\n-                ObligationCauseCode::MatchImpl(parent, ..) => &**parent,\n+                ObligationCauseCode::MatchImpl(parent, ..) => &parent.code,\n                 _ => &cause.code,\n             };\n             if let ObligationCauseCode::ItemObligation(item_def_id) = *code {"}, {"sha": "e1abe7f670ebc447e2d5ea834c8c66c906232e96", "filename": "compiler/rustc_middle/src/traits/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/905beab38ead75dcc283c641ebdaf84450e6e3c2/compiler%2Frustc_middle%2Fsrc%2Ftraits%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/905beab38ead75dcc283c641ebdaf84450e6e3c2/compiler%2Frustc_middle%2Fsrc%2Ftraits%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Ftraits%2Fmod.rs?ref=905beab38ead75dcc283c641ebdaf84450e6e3c2", "patch": "@@ -340,7 +340,7 @@ pub enum ObligationCauseCode<'tcx> {\n     WellFormed(Option<WellFormedLoc>),\n \n     /// From `match_impl`. The cause for us having to match an impl, and the DefId we are matching against.\n-    MatchImpl(Lrc<ObligationCauseCode<'tcx>>, DefId),\n+    MatchImpl(ObligationCause<'tcx>, DefId),\n }\n \n /// The 'location' at which we try to perform HIR-based wf checking."}, {"sha": "2a9be427480401fac9d783a8cfafad6ec4fd58db", "filename": "compiler/rustc_trait_selection/src/traits/select/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/905beab38ead75dcc283c641ebdaf84450e6e3c2/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fselect%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/905beab38ead75dcc283c641ebdaf84450e6e3c2/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fselect%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fselect%2Fmod.rs?ref=905beab38ead75dcc283c641ebdaf84450e6e3c2", "patch": "@@ -2025,7 +2025,7 @@ impl<'cx, 'tcx> SelectionContext<'cx, 'tcx> {\n         let cause = ObligationCause::new(\n             obligation.cause.span,\n             obligation.cause.body_id,\n-            ObligationCauseCode::MatchImpl(Lrc::new(obligation.cause.code.clone()), impl_def_id),\n+            ObligationCauseCode::MatchImpl(obligation.cause.clone(), impl_def_id),\n         );\n \n         let InferOk { obligations, .. } = self"}]}