{"sha": "a264440ab0f498e1ab77b17d24c3d6988c721c27", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEyNjQ0NDBhYjBmNDk4ZTFhYjc3YjE3ZDI0YzNkNjk4OGM3MjFjMjc=", "commit": {"author": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2015-08-11T15:17:15Z"}, "committer": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2015-08-12T21:58:57Z"}, "message": "outlives: convert outlives to use an exhaustive match, for better\nreliability.", "tree": {"sha": "8417f8b023815933026e8b37ef25772b5b772179", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8417f8b023815933026e8b37ef25772b5b772179"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a264440ab0f498e1ab77b17d24c3d6988c721c27", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a264440ab0f498e1ab77b17d24c3d6988c721c27", "html_url": "https://github.com/rust-lang/rust/commit/a264440ab0f498e1ab77b17d24c3d6988c721c27", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a264440ab0f498e1ab77b17d24c3d6988c721c27/comments", "author": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9c5cfea43da9b4e0372f240e01f58c977bd44d92", "url": "https://api.github.com/repos/rust-lang/rust/commits/9c5cfea43da9b4e0372f240e01f58c977bd44d92", "html_url": "https://github.com/rust-lang/rust/commit/9c5cfea43da9b4e0372f240e01f58c977bd44d92"}], "stats": {"total": 26, "additions": 22, "deletions": 4}, "files": [{"sha": "b7fcc5469231145af5a1820fc8e4b03525ff4b27", "filename": "src/librustc/middle/outlives.rs", "status": "modified", "additions": 22, "deletions": 4, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/a264440ab0f498e1ab77b17d24c3d6988c721c27/src%2Flibrustc%2Fmiddle%2Foutlives.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a264440ab0f498e1ab77b17d24c3d6988c721c27/src%2Flibrustc%2Fmiddle%2Foutlives.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Foutlives.rs?ref=a264440ab0f498e1ab77b17d24c3d6988c721c27", "patch": "@@ -161,9 +161,28 @@ fn compute_components<'a,'tcx>(infcx: &InferCtxt<'a,'tcx>,\n                     compute_components(infcx, ty, out);\n                 }\n             }\n-            _ => {\n-                // for all other types, just constrain the regions and\n-                // keep walking to find any other types.\n+\n+            // Most types do not introduce any region binders, nor\n+            // involve any other subtle cases, and so the WF relation\n+            // simply constraints any regions referenced directly by\n+            // the type and then visits the types that are lexically\n+            // contained within. (The comments refer to relevant rules\n+            // from RFC1214.)\n+            ty::TyBool(..) |        // OutlivesScalar\n+            ty::TyChar(..) |        // OutlivesScalar\n+            ty::TyInt(..) |         // OutlivesScalar\n+            ty::TyUint(..) |        // OutlivesScalar\n+            ty::TyFloat(..) |       // OutlivesScalar\n+            ty::TyEnum(..) |        // OutlivesNominalType\n+            ty::TyStruct(..) |      // OutlivesNominalType\n+            ty::TyBox(..) |         // OutlivesNominalType (ish)\n+            ty::TyStr(..) |         // OutlivesScalar (ish)\n+            ty::TyArray(..) |       // ...\n+            ty::TySlice(..) |       // ...\n+            ty::TyRawPtr(..) |      // ...\n+            ty::TyRef(..) |         // OutlivesReference\n+            ty::TyTuple(..) |       // ...\n+            ty::TyError(..) => {\n                 push_region_constraints(out, ty.regions());\n             }\n         }\n@@ -188,4 +207,3 @@ fn push_region_constraints<'tcx>(out: &mut Vec<Component<'tcx>>, regions: Vec<ty\n         }\n     }\n }\n-"}]}