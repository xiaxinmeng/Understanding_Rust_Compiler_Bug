{"sha": "1afeb7106514557e19b2eb48529a9a96879ca4d3", "node_id": "C_kwDOAAsO6NoAKDFhZmViNzEwNjUxNDU1N2UxOWIyZWI0ODUyOWE5YTk2ODc5Y2E0ZDM", "commit": {"author": {"name": "xFrednet", "email": "xFrednet@gmail.com", "date": "2022-01-14T23:39:06Z"}, "committer": {"name": "xFrednet", "email": "xFrednet@gmail.com", "date": "2022-01-14T23:57:43Z"}, "message": "Track `msrv` attribute for `manual_bits` and `borrow_as_prt`", "tree": {"sha": "9c668e7a2f37fc2a6ddef400e97e0dba1f18be7d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9c668e7a2f37fc2a6ddef400e97e0dba1f18be7d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1afeb7106514557e19b2eb48529a9a96879ca4d3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEsfZNmu/fmIv8KDcv/Ny/Ka9k1gEFAmHiDfcACgkQ/Ny/Ka9k\n1gEbKQ/8C+RkGFVz8vQnnnjis26A7aw9Ixd4jE8pWxcc8JauJcEUvv0xQs7aK0Ey\nlgiyIY6cfRrcRgKJJIpfkYAhgj3O1oIeBy5KM3qmuUDDSGUwJNqY6gpcyPVST5TM\npJXYqu15fEXQOUvb4yZgv/viP8pJ0IPbYnE2s4uc084Kl/Kr6dILLUPDBtmix/3e\n33c6xd/Am7086wyIP1NSAFWcOJHG7k0Y5ynWBT19/BY6P7PRXW58CDahzDV3jVEO\nHw43SaSOgFudCDIbW34qa1wQ8J+jkqXstO1Tz8fTsE7U1OeeP5gIkSmdDM80GPY6\nCsMIsBFgkVwzfDfY+RAttWcs8jZviqCOJupMOeaOzcfLBkPmzbDFBc/Z2tGZ0HSw\nHpugiTIG8bH2/sXunEd3Gw4N2dKneyewxDB1gIzDL1a9Et2SkRucVNYJgddcOdbb\nbYVlj0iK8PSQTd9YDWIVbCPkektqVuu9dul1oKI1EuF9h9MK/QX3/CxljZyhvD1e\nyznYJaOh90zX93zE/oQ0rAPez23d+l6lUVRyl09pB8F1r7CI2Ur+p68HxguvaFHO\n3vZ7hfqnzvnJHIh/COiC0z/ntVp9tVVsR76spo5wVtHPO104OLMu7tALvNViJ1OE\nAURE68Sd2aJ4aPEIDvKZKvAiwF4cJYsxdbs7wof6oEw81VKYupM=\n=J0Jk\n-----END PGP SIGNATURE-----", "payload": "tree 9c668e7a2f37fc2a6ddef400e97e0dba1f18be7d\nparent 9e7858545a2c0427120065431809653e3bb78ce2\nauthor xFrednet <xFrednet@gmail.com> 1642203546 +0100\ncommitter xFrednet <xFrednet@gmail.com> 1642204663 +0100\n\nTrack `msrv` attribute for `manual_bits` and `borrow_as_prt`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1afeb7106514557e19b2eb48529a9a96879ca4d3", "html_url": "https://github.com/rust-lang/rust/commit/1afeb7106514557e19b2eb48529a9a96879ca4d3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1afeb7106514557e19b2eb48529a9a96879ca4d3/comments", "author": {"login": "xFrednet", "id": 17087237, "node_id": "MDQ6VXNlcjE3MDg3MjM3", "avatar_url": "https://avatars.githubusercontent.com/u/17087237?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xFrednet", "html_url": "https://github.com/xFrednet", "followers_url": "https://api.github.com/users/xFrednet/followers", "following_url": "https://api.github.com/users/xFrednet/following{/other_user}", "gists_url": "https://api.github.com/users/xFrednet/gists{/gist_id}", "starred_url": "https://api.github.com/users/xFrednet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xFrednet/subscriptions", "organizations_url": "https://api.github.com/users/xFrednet/orgs", "repos_url": "https://api.github.com/users/xFrednet/repos", "events_url": "https://api.github.com/users/xFrednet/events{/privacy}", "received_events_url": "https://api.github.com/users/xFrednet/received_events", "type": "User", "site_admin": false}, "committer": {"login": "xFrednet", "id": 17087237, "node_id": "MDQ6VXNlcjE3MDg3MjM3", "avatar_url": "https://avatars.githubusercontent.com/u/17087237?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xFrednet", "html_url": "https://github.com/xFrednet", "followers_url": "https://api.github.com/users/xFrednet/followers", "following_url": "https://api.github.com/users/xFrednet/following{/other_user}", "gists_url": "https://api.github.com/users/xFrednet/gists{/gist_id}", "starred_url": "https://api.github.com/users/xFrednet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xFrednet/subscriptions", "organizations_url": "https://api.github.com/users/xFrednet/orgs", "repos_url": "https://api.github.com/users/xFrednet/repos", "events_url": "https://api.github.com/users/xFrednet/events{/privacy}", "received_events_url": "https://api.github.com/users/xFrednet/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9e7858545a2c0427120065431809653e3bb78ce2", "url": "https://api.github.com/repos/rust-lang/rust/commits/9e7858545a2c0427120065431809653e3bb78ce2", "html_url": "https://github.com/rust-lang/rust/commit/9e7858545a2c0427120065431809653e3bb78ce2"}], "stats": {"total": 31, "additions": 25, "deletions": 6}, "files": [{"sha": "265cdeab094fe205bb5c1f440a44aba4c3b87593", "filename": "clippy_lints/src/borrow_as_ptr.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/1afeb7106514557e19b2eb48529a9a96879ca4d3/clippy_lints%2Fsrc%2Fborrow_as_ptr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1afeb7106514557e19b2eb48529a9a96879ca4d3/clippy_lints%2Fsrc%2Fborrow_as_ptr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fborrow_as_ptr.rs?ref=1afeb7106514557e19b2eb48529a9a96879ca4d3", "patch": "@@ -5,7 +5,7 @@ use clippy_utils::{meets_msrv, msrvs};\n use if_chain::if_chain;\n use rustc_errors::Applicability;\n use rustc_hir::{BorrowKind, Expr, ExprKind, Mutability, TyKind};\n-use rustc_lint::{LateContext, LateLintPass};\n+use rustc_lint::{LateContext, LateLintPass, LintContext};\n use rustc_semver::RustcVersion;\n use rustc_session::{declare_tool_lint, impl_lint_pass};\n \n@@ -94,4 +94,6 @@ impl<'tcx> LateLintPass<'tcx> for BorrowAsPtr {\n             }\n         }\n     }\n+\n+    extract_msrv_attr!(LateContext);\n }"}, {"sha": "a72ef1d2de2fe7c9b7ebd8b098cac1ba9d7be46b", "filename": "clippy_lints/src/manual_bits.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/1afeb7106514557e19b2eb48529a9a96879ca4d3/clippy_lints%2Fsrc%2Fmanual_bits.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1afeb7106514557e19b2eb48529a9a96879ca4d3/clippy_lints%2Fsrc%2Fmanual_bits.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmanual_bits.rs?ref=1afeb7106514557e19b2eb48529a9a96879ca4d3", "patch": "@@ -4,7 +4,7 @@ use clippy_utils::{match_def_path, meets_msrv, msrvs, paths};\n use rustc_ast::ast::LitKind;\n use rustc_errors::Applicability;\n use rustc_hir::{BinOpKind, Expr, ExprKind, GenericArg, QPath};\n-use rustc_lint::{LateContext, LateLintPass};\n+use rustc_lint::{LateContext, LateLintPass, LintContext};\n use rustc_middle::ty::{self, Ty};\n use rustc_semver::RustcVersion;\n use rustc_session::{declare_tool_lint, impl_lint_pass};\n@@ -72,6 +72,8 @@ impl<'tcx> LateLintPass<'tcx> for ManualBits {\n             }\n         }\n     }\n+\n+    extract_msrv_attr!(LateContext);\n }\n \n fn get_one_size_of_ty<'tcx>("}, {"sha": "c9d99617c1e281f8315bfc2669fd71243155a3ad", "filename": "clippy_lints/src/utils/conf.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1afeb7106514557e19b2eb48529a9a96879ca4d3/clippy_lints%2Fsrc%2Futils%2Fconf.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1afeb7106514557e19b2eb48529a9a96879ca4d3/clippy_lints%2Fsrc%2Futils%2Fconf.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Fconf.rs?ref=1afeb7106514557e19b2eb48529a9a96879ca4d3", "patch": "@@ -156,7 +156,7 @@ define_Conf! {\n     ///\n     /// Suppress lints whenever the suggested change would cause breakage for other crates.\n     (avoid_breaking_exported_api: bool = true),\n-    /// Lint: MANUAL_SPLIT_ONCE, MANUAL_STR_REPEAT, CLONED_INSTEAD_OF_COPIED, REDUNDANT_FIELD_NAMES, REDUNDANT_STATIC_LIFETIMES, FILTER_MAP_NEXT, CHECKED_CONVERSIONS, MANUAL_RANGE_CONTAINS, USE_SELF, MEM_REPLACE_WITH_DEFAULT, MANUAL_NON_EXHAUSTIVE, OPTION_AS_REF_DEREF, MAP_UNWRAP_OR, MATCH_LIKE_MATCHES_MACRO, MANUAL_STRIP, MISSING_CONST_FOR_FN, UNNESTED_OR_PATTERNS, FROM_OVER_INTO, PTR_AS_PTR, IF_THEN_SOME_ELSE_NONE, APPROX_CONSTANT, DEPRECATED_CFG_ATTR, INDEX_REFUTABLE_SLICE, MAP_CLONE.\n+    /// Lint: MANUAL_SPLIT_ONCE, MANUAL_STR_REPEAT, CLONED_INSTEAD_OF_COPIED, REDUNDANT_FIELD_NAMES, REDUNDANT_STATIC_LIFETIMES, FILTER_MAP_NEXT, CHECKED_CONVERSIONS, MANUAL_RANGE_CONTAINS, USE_SELF, MEM_REPLACE_WITH_DEFAULT, MANUAL_NON_EXHAUSTIVE, OPTION_AS_REF_DEREF, MAP_UNWRAP_OR, MATCH_LIKE_MATCHES_MACRO, MANUAL_STRIP, MISSING_CONST_FOR_FN, UNNESTED_OR_PATTERNS, FROM_OVER_INTO, PTR_AS_PTR, IF_THEN_SOME_ELSE_NONE, APPROX_CONSTANT, DEPRECATED_CFG_ATTR, INDEX_REFUTABLE_SLICE, MAP_CLONE, BORROW_AS_PTR, MANUAL_BITS.\n     ///\n     /// The minimum rust version that the project supports\n     (msrv: Option<String> = None),"}, {"sha": "1e3ec123a3c8b0b430eb253f739da3fd41868b71", "filename": "tests/ui-toml/min_rust_version/min_rust_version.rs", "status": "modified", "additions": 17, "deletions": 2, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/1afeb7106514557e19b2eb48529a9a96879ca4d3/tests%2Fui-toml%2Fmin_rust_version%2Fmin_rust_version.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1afeb7106514557e19b2eb48529a9a96879ca4d3/tests%2Fui-toml%2Fmin_rust_version%2Fmin_rust_version.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui-toml%2Fmin_rust_version%2Fmin_rust_version.rs?ref=1afeb7106514557e19b2eb48529a9a96879ca4d3", "patch": "@@ -1,6 +1,7 @@\n-#![allow(clippy::redundant_clone)]\n-#![warn(clippy::manual_non_exhaustive)]\n+#![allow(clippy::redundant_clone, clippy::unnecessary_operation)]\n+#![warn(clippy::manual_non_exhaustive, clippy::borrow_as_ptr, clippy::manual_bits)]\n \n+use std::mem::{size_of, size_of_val};\n use std::ops::Deref;\n \n mod enums {\n@@ -73,11 +74,25 @@ fn map_clone_suggest_copied() {\n     let _: Option<u64> = Some(&16).map(|b| *b);\n }\n \n+fn borrow_as_ptr() {\n+    let val = 1;\n+    let _p = &val as *const i32;\n+\n+    let mut val_mut = 1;\n+    let _p_mut = &mut val_mut as *mut i32;\n+}\n+\n+fn manual_bits() {\n+    size_of::<i8>() * 8;\n+    size_of_val(&0u32) * 8;\n+}\n+\n fn main() {\n     option_as_ref_deref();\n     match_like_matches();\n     match_same_arms();\n     match_same_arms2();\n     manual_strip_msrv();\n     check_index_refutable_slice();\n+    borrow_as_ptr();\n }"}, {"sha": "a1e7361c0cb32fe4bbe9e9c5a09320691b3b123a", "filename": "tests/ui-toml/min_rust_version/min_rust_version.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1afeb7106514557e19b2eb48529a9a96879ca4d3/tests%2Fui-toml%2Fmin_rust_version%2Fmin_rust_version.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1afeb7106514557e19b2eb48529a9a96879ca4d3/tests%2Fui-toml%2Fmin_rust_version%2Fmin_rust_version.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui-toml%2Fmin_rust_version%2Fmin_rust_version.stderr?ref=1afeb7106514557e19b2eb48529a9a96879ca4d3", "patch": "@@ -1,5 +1,5 @@\n error: you are using an explicit closure for copying elements\n-  --> $DIR/min_rust_version.rs:73:26\n+  --> $DIR/min_rust_version.rs:74:26\n    |\n LL |     let _: Option<u64> = Some(&16).map(|b| *b);\n    |                          ^^^^^^^^^^^^^^^^^^^^^ help: consider calling the dedicated `cloned` method: `Some(&16).cloned()`"}]}