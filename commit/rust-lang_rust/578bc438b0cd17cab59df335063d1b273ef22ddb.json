{"sha": "578bc438b0cd17cab59df335063d1b273ef22ddb", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU3OGJjNDM4YjBjZDE3Y2FiNTlkZjMzNTA2M2QxYjI3M2VmMjJkZGI=", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2019-11-14T00:06:28Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2019-11-17T22:40:41Z"}, "message": "Do not ICE on trait aliases with missing obligations", "tree": {"sha": "3c0070fea3e9b40bbdc61dd9fb68a8e215f177a3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3c0070fea3e9b40bbdc61dd9fb68a8e215f177a3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/578bc438b0cd17cab59df335063d1b273ef22ddb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/578bc438b0cd17cab59df335063d1b273ef22ddb", "html_url": "https://github.com/rust-lang/rust/commit/578bc438b0cd17cab59df335063d1b273ef22ddb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/578bc438b0cd17cab59df335063d1b273ef22ddb/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5c5b8afd80e6fa1d24632153cb2257c686041d41", "url": "https://api.github.com/repos/rust-lang/rust/commits/5c5b8afd80e6fa1d24632153cb2257c686041d41", "html_url": "https://github.com/rust-lang/rust/commit/5c5b8afd80e6fa1d24632153cb2257c686041d41"}], "stats": {"total": 40, "additions": 37, "deletions": 3}, "files": [{"sha": "46559422b03ae7dca7ad4862f4105645628288c3", "filename": "src/librustc_typeck/astconv.rs", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/578bc438b0cd17cab59df335063d1b273ef22ddb/src%2Flibrustc_typeck%2Fastconv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/578bc438b0cd17cab59df335063d1b273ef22ddb/src%2Flibrustc_typeck%2Fastconv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fastconv.rs?ref=578bc438b0cd17cab59df335063d1b273ef22ddb", "patch": "@@ -1226,10 +1226,15 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n \n     /// Transform a `PolyTraitRef` into a `PolyExistentialTraitRef` by\n     /// removing the dummy `Self` type (`trait_object_dummy_self`).\n-    fn trait_ref_to_existential(&self, trait_ref: ty::TraitRef<'tcx>)\n-                                -> ty::ExistentialTraitRef<'tcx> {\n+    fn trait_ref_to_existential(\n+        &self,\n+        trait_ref: ty::TraitRef<'tcx>,\n+    ) -> ty::ExistentialTraitRef<'tcx> {\n         if trait_ref.self_ty() != self.tcx().types.trait_object_dummy_self {\n-            bug!(\"trait_ref_to_existential called on {:?} with non-dummy Self\", trait_ref);\n+            self.tcx().sess.delay_span_bug(DUMMY_SP, &format!(\n+                \"trait_ref_to_existential called on {:?} with non-dummy Self\",\n+                trait_ref,\n+            ));\n         }\n         ty::ExistentialTraitRef::erase_self_ty(self.tcx(), trait_ref)\n     }"}, {"sha": "ea1d70194b19139a7e6f9fc7c2b5174282caae3a", "filename": "src/test/ui/issues/issue-65673.rs", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/578bc438b0cd17cab59df335063d1b273ef22ddb/src%2Ftest%2Fui%2Fissues%2Fissue-65673.rs", "raw_url": "https://github.com/rust-lang/rust/raw/578bc438b0cd17cab59df335063d1b273ef22ddb/src%2Ftest%2Fui%2Fissues%2Fissue-65673.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-65673.rs?ref=578bc438b0cd17cab59df335063d1b273ef22ddb", "patch": "@@ -0,0 +1,12 @@\n+#![feature(trait_alias)]\n+trait Trait {}\n+trait WithType {\n+    type Ctx;\n+}\n+trait Alias<T> = where T: Trait;\n+\n+impl<T> WithType for T {\n+    type Ctx = dyn Alias<T>;\n+//~^ ERROR the size for values of type `(dyn Trait + 'static)` cannot be known at compilation time\n+}\n+fn main() {}"}, {"sha": "a556e35b6a944d902b963dab0da8105f9060abe7", "filename": "src/test/ui/issues/issue-65673.stderr", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/578bc438b0cd17cab59df335063d1b273ef22ddb/src%2Ftest%2Fui%2Fissues%2Fissue-65673.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/578bc438b0cd17cab59df335063d1b273ef22ddb/src%2Ftest%2Fui%2Fissues%2Fissue-65673.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-65673.stderr?ref=578bc438b0cd17cab59df335063d1b273ef22ddb", "patch": "@@ -0,0 +1,17 @@\n+error[E0277]: the size for values of type `(dyn Trait + 'static)` cannot be known at compilation time\n+  --> $DIR/issue-65673.rs:9:5\n+   |\n+LL |     type Ctx;\n+   |          --- associated type defined here\n+...\n+LL | impl<T> WithType for T {\n+   | ---------------------- in this `impl` item\n+LL |     type Ctx = dyn Alias<T>;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^ doesn't have a size known at compile-time\n+   |\n+   = help: the trait `std::marker::Sized` is not implemented for `(dyn Trait + 'static)`\n+   = note: to learn more, visit <https://doc.rust-lang.org/book/ch19-04-advanced-types.html#dynamically-sized-types-and-the-sized-trait>\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0277`."}]}