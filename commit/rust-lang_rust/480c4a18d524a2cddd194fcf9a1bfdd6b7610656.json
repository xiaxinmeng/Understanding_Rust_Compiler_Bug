{"sha": "480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "node_id": "C_kwDOAAsO6NoAKDQ4MGM0YTE4ZDUyNGEyY2RkZDE5NGZjZjlhMWJmZGQ2Yjc2MTA2NTY", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-02-02T05:52:13Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-02-02T05:52:13Z"}, "message": "Rollup merge of #107201 - compiler-errors:confusing-async-fn-note, r=estebank\n\nRemove confusing 'while checking' note from opaque future type mismatches\n\nMaybe I'm just misinterpreting the wording of the note. The only value I can see in this note is that it points out where the async's opaque future is coming from, but the way it's doing it is misleading IMO.\n\nFor example:\n\n```rust\nnote: while checking the return type of the `async fn`\n  --> $DIR/dont-suggest-missing-await.rs:7:24\n   |\nLL | async fn make_u32() -> u32 {\n   |                        ^^^ checked the `Output` of this `async fn`, found opaque type\n```\n\nWe point at the type `u32` in the HIR, but then say \"found opaque type\". We also say \"while checking\"... but we're typechecking a totally different function when we get this type mismatch!\n\nr? ``@estebank`` but feel free to reassign and/or take your time reviewing this. I'd be inclined to also discuss reworking the presentation of this type mismatch to restore some of these labels in a way that makes it more clear what it's trying to point out.", "tree": {"sha": "55877bcd391e302410dd9abae58afc5e044eff4f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/55877bcd391e302410dd9abae58afc5e044eff4f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJj20+NCRBK7hj4Ov3rIwAA7bsIAIcuqPyGfiEMLNRHgGBHvGtR\ntzfhIf+4b7tBahHzY3l+W9jkRqaPvMbLhefRSiAqhyKqzjqXLfk5zvPRwWDj8xTq\nIyPYRczj4xWojMS3jKLoUJ43J+030m0qdfkInI3CjFRIXrUdPHb9HUd0gerenORy\n8xs7JxL74T2kXECSUM/9i0ODmOyv/bDNeb5ylRRsxlVWLWthpZuoqEjVe7ACowvJ\nc+QBJR78zYi6NX6V/Belj9pvmCTL49MfrQBWbt9nfD6cYt0vsH4xvdEM3ls4hkvt\niQyf8RCPeM6Yg9jCApi2Zs6/m22jfNKP5DyJ8W96rrCwWhP6lnnLXqn8PUsu03Q=\n=OclK\n-----END PGP SIGNATURE-----\n", "payload": "tree 55877bcd391e302410dd9abae58afc5e044eff4f\nparent 131f0c6df6777800aa884963bdba0739299cd31f\nparent a63f5dce27cd5a315046ecebbafa8ee2fef10e12\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1675317133 +0100\ncommitter GitHub <noreply@github.com> 1675317133 +0100\n\nRollup merge of #107201 - compiler-errors:confusing-async-fn-note, r=estebank\n\nRemove confusing 'while checking' note from opaque future type mismatches\n\nMaybe I'm just misinterpreting the wording of the note. The only value I can see in this note is that it points out where the async's opaque future is coming from, but the way it's doing it is misleading IMO.\n\nFor example:\n\n```rust\nnote: while checking the return type of the `async fn`\n  --> $DIR/dont-suggest-missing-await.rs:7:24\n   |\nLL | async fn make_u32() -> u32 {\n   |                        ^^^ checked the `Output` of this `async fn`, found opaque type\n```\n\nWe point at the type `u32` in the HIR, but then say \"found opaque type\". We also say \"while checking\"... but we're typechecking a totally different function when we get this type mismatch!\n\nr? ``@estebank`` but feel free to reassign and/or take your time reviewing this. I'd be inclined to also discuss reworking the presentation of this type mismatch to restore some of these labels in a way that makes it more clear what it's trying to point out.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "html_url": "https://github.com/rust-lang/rust/commit/480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "131f0c6df6777800aa884963bdba0739299cd31f", "url": "https://api.github.com/repos/rust-lang/rust/commits/131f0c6df6777800aa884963bdba0739299cd31f", "html_url": "https://github.com/rust-lang/rust/commit/131f0c6df6777800aa884963bdba0739299cd31f"}, {"sha": "a63f5dce27cd5a315046ecebbafa8ee2fef10e12", "url": "https://api.github.com/repos/rust-lang/rust/commits/a63f5dce27cd5a315046ecebbafa8ee2fef10e12", "html_url": "https://github.com/rust-lang/rust/commit/a63f5dce27cd5a315046ecebbafa8ee2fef10e12"}], "stats": {"total": 271, "additions": 35, "deletions": 236}, "files": [{"sha": "b5c2d14e8d15b05a6e7dd54eaa894e6db8ac33e7", "filename": "compiler/rustc_infer/src/infer/error_reporting/mod.rs", "status": "modified", "additions": 16, "deletions": 46, "changes": 62, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/compiler%2Frustc_infer%2Fsrc%2Finfer%2Ferror_reporting%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/compiler%2Frustc_infer%2Fsrc%2Finfer%2Ferror_reporting%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_infer%2Fsrc%2Finfer%2Ferror_reporting%2Fmod.rs?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -60,7 +60,7 @@ use crate::traits::{\n \n use rustc_data_structures::fx::{FxIndexMap, FxIndexSet};\n use rustc_errors::{pluralize, struct_span_err, Diagnostic, ErrorGuaranteed, IntoDiagnosticArg};\n-use rustc_errors::{Applicability, DiagnosticBuilder, DiagnosticStyledString, MultiSpan};\n+use rustc_errors::{Applicability, DiagnosticBuilder, DiagnosticStyledString};\n use rustc_hir as hir;\n use rustc_hir::def::DefKind;\n use rustc_hir::def_id::{DefId, LocalDefId};\n@@ -1470,51 +1470,17 @@ impl<'tcx> TypeErrCtxt<'_, 'tcx> {\n                 for (key, values) in types.iter() {\n                     let count = values.len();\n                     let kind = key.descr();\n-                    let mut returned_async_output_error = false;\n                     for &sp in values {\n-                        if sp.is_desugaring(DesugaringKind::Async) && !returned_async_output_error {\n-                            if [sp] != err.span.primary_spans() {\n-                                let mut span: MultiSpan = sp.into();\n-                                span.push_span_label(\n-                                    sp,\n-                                    format!(\n-                                        \"checked the `Output` of this `async fn`, {}{} {}{}\",\n-                                        if count > 1 { \"one of the \" } else { \"\" },\n-                                        target,\n-                                        kind,\n-                                        pluralize!(count),\n-                                    ),\n-                                );\n-                                err.span_note(\n-                                    span,\n-                                    \"while checking the return type of the `async fn`\",\n-                                );\n-                            } else {\n-                                err.span_label(\n-                                    sp,\n-                                    format!(\n-                                        \"checked the `Output` of this `async fn`, {}{} {}{}\",\n-                                        if count > 1 { \"one of the \" } else { \"\" },\n-                                        target,\n-                                        kind,\n-                                        pluralize!(count),\n-                                    ),\n-                                );\n-                                err.note(\"while checking the return type of the `async fn`\");\n-                            }\n-                            returned_async_output_error = true;\n-                        } else {\n-                            err.span_label(\n-                                sp,\n-                                format!(\n-                                    \"{}{} {}{}\",\n-                                    if count == 1 { \"the \" } else { \"one of the \" },\n-                                    target,\n-                                    kind,\n-                                    pluralize!(count),\n-                                ),\n-                            );\n-                        }\n+                        err.span_label(\n+                            sp,\n+                            format!(\n+                                \"{}{} {}{}\",\n+                                if count == 1 { \"the \" } else { \"one of the \" },\n+                                target,\n+                                kind,\n+                                pluralize!(count),\n+                            ),\n+                        );\n                     }\n                 }\n             }\n@@ -1537,7 +1503,11 @@ impl<'tcx> TypeErrCtxt<'_, 'tcx> {\n                     //    |\n                     //    = note: expected unit type `()`\n                     //                 found closure `[closure@$DIR/issue-20862.rs:2:5: 2:14 x:_]`\n-                    if !self.ignore_span.overlaps(span) {\n+                    //\n+                    // Also ignore opaque `Future`s that come from async fns.\n+                    if !self.ignore_span.overlaps(span)\n+                        && !span.is_desugaring(DesugaringKind::Async)\n+                    {\n                         self.types.entry(kind).or_default().insert(span);\n                     }\n                 }"}, {"sha": "8e2d42c8f138cff4bfb013fb22da8d3e96d44a58", "filename": "tests/ui/async-await/dont-suggest-missing-await.stderr", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fdont-suggest-missing-await.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fdont-suggest-missing-await.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fasync-await%2Fdont-suggest-missing-await.stderr?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -6,11 +6,6 @@ LL |         take_u32(x)\n    |         |\n    |         arguments to this function are incorrect\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/dont-suggest-missing-await.rs:7:24\n-   |\n-LL | async fn make_u32() -> u32 {\n-   |                        ^^^ checked the `Output` of this `async fn`, found opaque type\n    = note:     expected type `u32`\n            found opaque type `impl Future<Output = u32>`\n note: function defined here"}, {"sha": "9fdb1ce47d7bae8db1a1a042e9dd5e378140f399", "filename": "tests/ui/async-await/generator-desc.stderr", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fgenerator-desc.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fgenerator-desc.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fasync-await%2Fgenerator-desc.stderr?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -21,16 +21,6 @@ LL |     fun(one(), two());\n    |     |\n    |     arguments to this function are incorrect\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/generator-desc.rs:5:16\n-   |\n-LL | async fn one() {}\n-   |                ^ checked the `Output` of this `async fn`, expected opaque type\n-note: while checking the return type of the `async fn`\n-  --> $DIR/generator-desc.rs:6:16\n-   |\n-LL | async fn two() {}\n-   |                ^ checked the `Output` of this `async fn`, found opaque type\n    = note: expected opaque type `impl Future<Output = ()>` (opaque type at <$DIR/generator-desc.rs:5:16>)\n               found opaque type `impl Future<Output = ()>` (opaque type at <$DIR/generator-desc.rs:6:16>)\n    = help: consider `await`ing on both `Future`s"}, {"sha": "9c4acbe0a5bf735857cd288d03589f97810518bd", "filename": "tests/ui/async-await/issue-61076.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fissue-61076.rs", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fissue-61076.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fasync-await%2Fissue-61076.rs?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -54,9 +54,6 @@ async fn struct_() -> Struct {\n }\n \n async fn tuple() -> Tuple {\n-    //~^ NOTE checked the `Output` of this `async fn`, expected opaque type\n-    //~| NOTE while checking the return type of the `async fn`\n-    //~| NOTE in this expansion of desugaring of `async` block or function\n     Tuple(1i32)\n }\n "}, {"sha": "b25b29bf50c174fd18b5db994a8b6bd8a6d808a9", "filename": "tests/ui/async-await/issue-61076.stderr", "status": "modified", "additions": 5, "deletions": 10, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fissue-61076.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fissue-61076.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fasync-await%2Fissue-61076.stderr?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -11,7 +11,7 @@ LL |     foo().await?;\n    |          ++++++\n \n error[E0277]: the `?` operator can only be applied to values that implement `Try`\n-  --> $DIR/issue-61076.rs:65:5\n+  --> $DIR/issue-61076.rs:62:5\n    |\n LL |     t?;\n    |     ^^ the `?` operator cannot be applied to type `T`\n@@ -23,7 +23,7 @@ LL |     t.await?;\n    |      ++++++\n \n error[E0609]: no field `0` on type `impl Future<Output = Tuple>`\n-  --> $DIR/issue-61076.rs:74:26\n+  --> $DIR/issue-61076.rs:71:26\n    |\n LL |     let _: i32 = tuple().0;\n    |                          ^ field not available in `impl Future`, but it is available in its `Output`\n@@ -34,7 +34,7 @@ LL |     let _: i32 = tuple().await.0;\n    |                         ++++++\n \n error[E0609]: no field `a` on type `impl Future<Output = Struct>`\n-  --> $DIR/issue-61076.rs:78:28\n+  --> $DIR/issue-61076.rs:75:28\n    |\n LL |     let _: i32 = struct_().a;\n    |                            ^ field not available in `impl Future`, but it is available in its `Output`\n@@ -45,7 +45,7 @@ LL |     let _: i32 = struct_().await.a;\n    |                           ++++++\n \n error[E0599]: no method named `method` found for opaque type `impl Future<Output = Struct>` in the current scope\n-  --> $DIR/issue-61076.rs:82:15\n+  --> $DIR/issue-61076.rs:79:15\n    |\n LL |     struct_().method();\n    |               ^^^^^^ method not found in `impl Future<Output = Struct>`\n@@ -56,19 +56,14 @@ LL |     struct_().await.method();\n    |               ++++++\n \n error[E0308]: mismatched types\n-  --> $DIR/issue-61076.rs:91:9\n+  --> $DIR/issue-61076.rs:88:9\n    |\n LL |     match tuple() {\n    |           ------- this expression has type `impl Future<Output = Tuple>`\n LL |\n LL |         Tuple(_) => {}\n    |         ^^^^^^^^ expected opaque type, found `Tuple`\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/issue-61076.rs:56:21\n-   |\n-LL | async fn tuple() -> Tuple {\n-   |                     ^^^^^ checked the `Output` of this `async fn`, expected opaque type\n    = note: expected opaque type `impl Future<Output = Tuple>`\n                    found struct `Tuple`\n help: consider `await`ing on the `Future`"}, {"sha": "4c5dfeed9ba5c6e87992d40a0b9bb8350e9f56b3", "filename": "tests/ui/async-await/issue-98634.stderr", "status": "modified", "additions": 0, "deletions": 15, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fissue-98634.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fissue-98634.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fasync-await%2Fissue-98634.stderr?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -4,11 +4,6 @@ error[E0271]: expected `callback` to be a fn item that returns `Pin<Box<dyn Futu\n LL |         StructAsync { callback }.await;\n    |                       ^^^^^^^^ expected `Pin<Box<dyn Future<Output = ()>>>`, found opaque type\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/issue-98634.rs:24:21\n-   |\n-LL | async fn callback() {}\n-   |                     ^ checked the `Output` of this `async fn`, found opaque type\n    = note:   expected struct `Pin<Box<(dyn Future<Output = ()> + 'static)>>`\n            found opaque type `impl Future<Output = ()>`\n note: required by a bound in `StructAsync`\n@@ -23,11 +18,6 @@ error[E0271]: expected `callback` to be a fn item that returns `Pin<Box<dyn Futu\n LL |         StructAsync { callback }.await;\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^ expected `Pin<Box<dyn Future<Output = ()>>>`, found opaque type\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/issue-98634.rs:24:21\n-   |\n-LL | async fn callback() {}\n-   |                     ^ checked the `Output` of this `async fn`, found opaque type\n    = note:   expected struct `Pin<Box<(dyn Future<Output = ()> + 'static)>>`\n            found opaque type `impl Future<Output = ()>`\n note: required by a bound in `StructAsync`\n@@ -42,11 +32,6 @@ error[E0271]: expected `callback` to be a fn item that returns `Pin<Box<dyn Futu\n LL |         StructAsync { callback }.await;\n    |                                 ^^^^^^ expected `Pin<Box<dyn Future<Output = ()>>>`, found opaque type\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/issue-98634.rs:24:21\n-   |\n-LL | async fn callback() {}\n-   |                     ^ checked the `Output` of this `async fn`, found opaque type\n    = note:   expected struct `Pin<Box<(dyn Future<Output = ()> + 'static)>>`\n            found opaque type `impl Future<Output = ()>`\n note: required by a bound in `StructAsync`"}, {"sha": "ebb80f6e07e74f21d7271e00cae744cbf90ea390", "filename": "tests/ui/async-await/issues/issue-102206.stderr", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fissues%2Fissue-102206.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fissues%2Fissue-102206.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fasync-await%2Fissues%2Fissue-102206.stderr?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -8,11 +8,6 @@ LL |     std::mem::size_of_val(foo());\n    |     |                     help: consider borrowing here: `&foo()`\n    |     arguments to this function are incorrect\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/issue-102206.rs:3:16\n-   |\n-LL | async fn foo() {}\n-   |                ^ checked the `Output` of this `async fn`, found opaque type\n    = note: expected reference `&_`\n             found opaque type `impl Future<Output = ()>`\n note: function defined here"}, {"sha": "e47325cb4aeaec6fcf5f3291a4d93fa0c30c8b74", "filename": "tests/ui/async-await/suggest-missing-await-closure.stderr", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fsuggest-missing-await-closure.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fsuggest-missing-await-closure.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fasync-await%2Fsuggest-missing-await-closure.stderr?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -6,11 +6,6 @@ LL |         take_u32(x)\n    |         |\n    |         arguments to this function are incorrect\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/suggest-missing-await-closure.rs:8:24\n-   |\n-LL | async fn make_u32() -> u32 {\n-   |                        ^^^ checked the `Output` of this `async fn`, found opaque type\n    = note:     expected type `u32`\n            found opaque type `impl Future<Output = u32>`\n note: function defined here"}, {"sha": "4ed0272ac1a127b7ebd9b0c08948541ddfa21afa", "filename": "tests/ui/async-await/suggest-missing-await.stderr", "status": "modified", "additions": 0, "deletions": 35, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fsuggest-missing-await.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fasync-await%2Fsuggest-missing-await.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fasync-await%2Fsuggest-missing-await.stderr?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -6,11 +6,6 @@ LL |     take_u32(x)\n    |     |\n    |     arguments to this function are incorrect\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/suggest-missing-await.rs:5:24\n-   |\n-LL | async fn make_u32() -> u32 {\n-   |                        ^^^ checked the `Output` of this `async fn`, found opaque type\n    = note:     expected type `u32`\n            found opaque type `impl Future<Output = u32>`\n note: function defined here\n@@ -29,11 +24,6 @@ error[E0308]: mismatched types\n LL |     dummy()\n    |     ^^^^^^^ expected `()`, found opaque type\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/suggest-missing-await.rs:18:18\n-   |\n-LL | async fn dummy() {}\n-   |                  ^ checked the `Output` of this `async fn`, found opaque type\n    = note: expected unit type `()`\n             found opaque type `impl Future<Output = ()>`\n help: consider `await`ing on the `Future`\n@@ -60,11 +50,6 @@ LL | |\n LL | |     };\n    | |_____- `if` and `else` have incompatible types\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/suggest-missing-await.rs:18:18\n-   |\n-LL | async fn dummy() {}\n-   |                  ^ checked the `Output` of this `async fn`, expected opaque type\n    = note: expected opaque type `impl Future<Output = ()>`\n                 found unit type `()`\n help: consider `await`ing on the `Future`\n@@ -87,11 +72,6 @@ LL | |\n LL | |     };\n    | |_____- `match` arms have incompatible types\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/suggest-missing-await.rs:18:18\n-   |\n-LL | async fn dummy() {}\n-   |                  ^ checked the `Output` of this `async fn`, expected opaque type\n    = note: expected opaque type `impl Future<Output = ()>`\n                 found unit type `()`\n help: consider `await`ing on the `Future`\n@@ -108,11 +88,6 @@ LL |     let _x = match dummy() {\n LL |         () => {}\n    |         ^^ expected opaque type, found `()`\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/suggest-missing-await.rs:18:18\n-   |\n-LL | async fn dummy() {}\n-   |                  ^ checked the `Output` of this `async fn`, expected opaque type\n    = note: expected opaque type `impl Future<Output = ()>`\n                 found unit type `()`\n help: consider `await`ing on the `Future`\n@@ -129,11 +104,6 @@ LL |     match dummy_result() {\n LL |         Ok(_) => {}\n    |         ^^^^^ expected opaque type, found `Result<_, _>`\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/suggest-missing-await.rs:57:28\n-   |\n-LL | async fn dummy_result() -> Result<(), ()> {\n-   |                            ^^^^^^^^^^^^^^ checked the `Output` of this `async fn`, expected opaque type\n    = note: expected opaque type `impl Future<Output = Result<(), ()>>`\n                      found enum `Result<_, _>`\n help: consider `await`ing on the `Future`\n@@ -150,11 +120,6 @@ LL |     match dummy_result() {\n LL |         Err(_) => {}\n    |         ^^^^^^ expected opaque type, found `Result<_, _>`\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/suggest-missing-await.rs:57:28\n-   |\n-LL | async fn dummy_result() -> Result<(), ()> {\n-   |                            ^^^^^^^^^^^^^^ checked the `Output` of this `async fn`, expected opaque type\n    = note: expected opaque type `impl Future<Output = Result<(), ()>>`\n                      found enum `Result<_, _>`\n help: consider `await`ing on the `Future`"}, {"sha": "3ec62020e6c89c41077a681f599a9856cc2cb05a", "filename": "tests/ui/impl-trait/in-trait/method-signature-matches.stderr", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fimpl-trait%2Fin-trait%2Fmethod-signature-matches.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fimpl-trait%2Fin-trait%2Fmethod-signature-matches.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fimpl-trait%2Fin-trait%2Fmethod-signature-matches.stderr?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -24,16 +24,6 @@ LL |     async fn owo(_: u8) {}\n    |                     expected `()`, found `u8`\n    |                     help: change the parameter type to match the trait: `()`\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/method-signature-matches.rs:20:25\n-   |\n-LL |     async fn owo(_: u8) {}\n-   |                         ^ checked the `Output` of this `async fn`, expected opaque type\n-note: while checking the return type of the `async fn`\n-  --> $DIR/method-signature-matches.rs:20:25\n-   |\n-LL |     async fn owo(_: u8) {}\n-   |                         ^ checked the `Output` of this `async fn`, found opaque type\n note: type in trait\n   --> $DIR/method-signature-matches.rs:16:21\n    |"}, {"sha": "8ff08968008bb31839eb5c65444e1044377671a3", "filename": "tests/ui/impl-trait/issue-102605.stderr", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fimpl-trait%2Fissue-102605.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fimpl-trait%2Fissue-102605.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fimpl-trait%2Fissue-102605.stderr?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -6,11 +6,6 @@ LL |     convert_result(foo())\n    |     |\n    |     arguments to this function are incorrect\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/issue-102605.rs:3:19\n-   |\n-LL | async fn foo() -> Result<(), String> {\n-   |                   ^^^^^^^^^^^^^^^^^^ checked the `Output` of this `async fn`, found opaque type\n    = note:     expected enum `Result<(), _>`\n            found opaque type `impl Future<Output = Result<(), String>>`\n note: function defined here"}, {"sha": "a4b7fc1f5bc75e6e62e932461e6e3c32c0c3a1dd", "filename": "tests/ui/impl-trait/issue-99914.stderr", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fimpl-trait%2Fissue-99914.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fimpl-trait%2Fissue-99914.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fimpl-trait%2Fissue-99914.stderr?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -4,11 +4,6 @@ error[E0308]: mismatched types\n LL |     t.and_then(|t| -> _ { bar(t) });\n    |                           ^^^^^^ expected `Result<_, Error>`, found opaque type\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/issue-99914.rs:13:23\n-   |\n-LL | async fn bar(t: Okay) {}\n-   |                       ^ checked the `Output` of this `async fn`, found opaque type\n    = note:     expected enum `Result<_, Error>`\n            found opaque type `impl Future<Output = ()>`\n help: try wrapping the expression in `Ok`"}, {"sha": "7be4312bfbacbdcf0ff2bf01bb10af78c303eb47", "filename": "tests/ui/suggestions/if-then-neeing-semi.rs", "status": "modified", "additions": 3, "deletions": 12, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fsuggestions%2Fif-then-neeing-semi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fsuggestions%2Fif-then-neeing-semi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuggestions%2Fif-then-neeing-semi.rs?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -15,18 +15,9 @@ fn extra_semicolon() {\n     };\n }\n \n-async fn async_dummy() {} //~ NOTE checked the `Output` of this `async fn`, found opaque type\n-//~| NOTE while checking the return type of the `async fn`\n-//~| NOTE in this expansion of desugaring of `async` block or function\n-//~| NOTE checked the `Output` of this `async fn`, expected opaque type\n-//~| NOTE while checking the return type of the `async fn`\n-//~| NOTE in this expansion of desugaring of `async` block or function\n-async fn async_dummy2() {} //~ NOTE checked the `Output` of this `async fn`, found opaque type\n-//~| NOTE checked the `Output` of this `async fn`, found opaque type\n-//~| NOTE while checking the return type of the `async fn`\n-//~| NOTE in this expansion of desugaring of `async` block or function\n-//~| NOTE while checking the return type of the `async fn`\n-//~| NOTE in this expansion of desugaring of `async` block or function\n+async fn async_dummy() {}\n+\n+async fn async_dummy2() {}\n \n async fn async_extra_semicolon_same() {\n     let _ = if true {"}, {"sha": "567deb405fccd98332c24019c511ffc642187a62", "filename": "tests/ui/suggestions/if-then-neeing-semi.stderr", "status": "modified", "additions": 4, "deletions": 24, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fsuggestions%2Fif-then-neeing-semi.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fsuggestions%2Fif-then-neeing-semi.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuggestions%2Fif-then-neeing-semi.stderr?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -1,5 +1,5 @@\n error[E0308]: `if` and `else` have incompatible types\n-  --> $DIR/if-then-neeing-semi.rs:37:9\n+  --> $DIR/if-then-neeing-semi.rs:28:9\n    |\n LL |       let _ = if true {\n    |  _____________-\n@@ -15,11 +15,6 @@ LL | |\n LL | |     };\n    | |_____- `if` and `else` have incompatible types\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/if-then-neeing-semi.rs:18:24\n-   |\n-LL | async fn async_dummy() {}\n-   |                        ^ checked the `Output` of this `async fn`, found opaque type\n    = note: expected unit type `()`\n             found opaque type `impl Future<Output = ()>`\n help: consider `await`ing on the `Future`\n@@ -33,7 +28,7 @@ LL +         async_dummy()\n    |\n \n error[E0308]: `if` and `else` have incompatible types\n-  --> $DIR/if-then-neeing-semi.rs:50:9\n+  --> $DIR/if-then-neeing-semi.rs:41:9\n    |\n LL |       let _ = if true {\n    |  _____________-\n@@ -49,11 +44,6 @@ LL | |\n LL | |     };\n    | |_____- `if` and `else` have incompatible types\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/if-then-neeing-semi.rs:24:25\n-   |\n-LL | async fn async_dummy2() {}\n-   |                         ^ checked the `Output` of this `async fn`, found opaque type\n    = note: expected unit type `()`\n             found opaque type `impl Future<Output = ()>`\n help: consider `await`ing on the `Future`\n@@ -69,7 +59,7 @@ LL ~         Box::new(async_dummy2())\n    |\n \n error[E0308]: `if` and `else` have incompatible types\n-  --> $DIR/if-then-neeing-semi.rs:63:9\n+  --> $DIR/if-then-neeing-semi.rs:54:9\n    |\n LL |       let _ = if true {\n    |  _____________-\n@@ -85,18 +75,8 @@ LL | |\n LL | |     };\n    | |_____- `if` and `else` have incompatible types\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/if-then-neeing-semi.rs:18:24\n-   |\n-LL | async fn async_dummy() {}\n-   |                        ^ checked the `Output` of this `async fn`, expected opaque type\n-note: while checking the return type of the `async fn`\n-  --> $DIR/if-then-neeing-semi.rs:24:25\n-   |\n-LL | async fn async_dummy2() {}\n-   |                         ^ checked the `Output` of this `async fn`, found opaque type\n    = note: expected opaque type `impl Future<Output = ()>` (opaque type at <$DIR/if-then-neeing-semi.rs:18:24>)\n-              found opaque type `impl Future<Output = ()>` (opaque type at <$DIR/if-then-neeing-semi.rs:24:25>)\n+              found opaque type `impl Future<Output = ()>` (opaque type at <$DIR/if-then-neeing-semi.rs:20:25>)\n    = note: distinct uses of `impl Trait` result in different opaque types\n help: consider `await`ing on both `Future`s\n    |"}, {"sha": "4af7cc9f8ec800c7a2b8b6fb50648acecf633df9", "filename": "tests/ui/suggestions/issue-81839.stderr", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fsuggestions%2Fissue-81839.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fsuggestions%2Fissue-81839.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuggestions%2Fissue-81839.stderr?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -14,11 +14,6 @@ LL | |         _ => cx.answer_str(\"hi\"),\n LL | |     }\n    | |_____- `match` arms have incompatible types\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/auxiliary/issue-81839.rs:6:49\n-   |\n-LL |     pub async fn answer_str(&self, _s: &str) -> Test {\n-   |                                                 ^^^^ checked the `Output` of this `async fn`, found opaque type\n    = note: expected unit type `()`\n             found opaque type `impl Future<Output = Test>`\n "}, {"sha": "3f863cb104e0bfa48d99d5c63e4e49a60fdac892", "filename": "tests/ui/suggestions/match-prev-arm-needing-semi.rs", "status": "modified", "additions": 3, "deletions": 12, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fsuggestions%2Fmatch-prev-arm-needing-semi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fsuggestions%2Fmatch-prev-arm-needing-semi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuggestions%2Fmatch-prev-arm-needing-semi.rs?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -13,18 +13,9 @@ fn extra_semicolon() {\n     };\n }\n \n-async fn async_dummy() {} //~ NOTE checked the `Output` of this `async fn`, found opaque type\n-//~| NOTE while checking the return type of the `async fn`\n-//~| NOTE in this expansion of desugaring of `async` block or function\n-//~| NOTE checked the `Output` of this `async fn`, expected opaque type\n-//~| NOTE while checking the return type of the `async fn`\n-//~| NOTE in this expansion of desugaring of `async` block or function\n-async fn async_dummy2() {} //~ NOTE checked the `Output` of this `async fn`, found opaque type\n-//~| NOTE checked the `Output` of this `async fn`, found opaque type\n-//~| NOTE while checking the return type of the `async fn`\n-//~| NOTE in this expansion of desugaring of `async` block or function\n-//~| NOTE while checking the return type of the `async fn`\n-//~| NOTE in this expansion of desugaring of `async` block or function\n+async fn async_dummy() {}\n+\n+async fn async_dummy2() {}\n \n async fn async_extra_semicolon_same() {\n     let _ = match true { //~ NOTE `match` arms have incompatible types"}, {"sha": "df18c7b0b23cceade1b2e6e8d4a47aeb0ff31ac4", "filename": "tests/ui/suggestions/match-prev-arm-needing-semi.stderr", "status": "modified", "additions": 4, "deletions": 24, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fsuggestions%2Fmatch-prev-arm-needing-semi.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Fsuggestions%2Fmatch-prev-arm-needing-semi.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuggestions%2Fmatch-prev-arm-needing-semi.stderr?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -1,5 +1,5 @@\n error[E0308]: `match` arms have incompatible types\n-  --> $DIR/match-prev-arm-needing-semi.rs:35:18\n+  --> $DIR/match-prev-arm-needing-semi.rs:26:18\n    |\n LL |       let _ = match true {\n    |  _____________-\n@@ -15,11 +15,6 @@ LL | |\n LL | |     };\n    | |_____- `match` arms have incompatible types\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/match-prev-arm-needing-semi.rs:16:24\n-   |\n-LL | async fn async_dummy() {}\n-   |                        ^ checked the `Output` of this `async fn`, found opaque type\n    = note: expected unit type `()`\n             found opaque type `impl Future<Output = ()>`\n help: consider `await`ing on the `Future`\n@@ -33,7 +28,7 @@ LL +             async_dummy()\n    |\n \n error[E0308]: `match` arms have incompatible types\n-  --> $DIR/match-prev-arm-needing-semi.rs:48:18\n+  --> $DIR/match-prev-arm-needing-semi.rs:39:18\n    |\n LL |       let _ = match true {\n    |  _____________-\n@@ -49,11 +44,6 @@ LL | |\n LL | |     };\n    | |_____- `match` arms have incompatible types\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/match-prev-arm-needing-semi.rs:22:25\n-   |\n-LL | async fn async_dummy2() {}\n-   |                         ^ checked the `Output` of this `async fn`, found opaque type\n    = note: expected unit type `()`\n             found opaque type `impl Future<Output = ()>`\n help: consider `await`ing on the `Future`\n@@ -69,7 +59,7 @@ LL ~         false => Box::new(async_dummy2()),\n    |\n \n error[E0308]: `match` arms have incompatible types\n-  --> $DIR/match-prev-arm-needing-semi.rs:59:18\n+  --> $DIR/match-prev-arm-needing-semi.rs:50:18\n    |\n LL |       let _ = match true {\n    |  _____________-\n@@ -83,18 +73,8 @@ LL | |\n LL | |     };\n    | |_____- `match` arms have incompatible types\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/match-prev-arm-needing-semi.rs:16:24\n-   |\n-LL | async fn async_dummy() {}\n-   |                        ^ checked the `Output` of this `async fn`, expected opaque type\n-note: while checking the return type of the `async fn`\n-  --> $DIR/match-prev-arm-needing-semi.rs:22:25\n-   |\n-LL | async fn async_dummy2() {}\n-   |                         ^ checked the `Output` of this `async fn`, found opaque type\n    = note: expected opaque type `impl Future<Output = ()>` (opaque type at <$DIR/match-prev-arm-needing-semi.rs:16:24>)\n-              found opaque type `impl Future<Output = ()>` (opaque type at <$DIR/match-prev-arm-needing-semi.rs:22:25>)\n+              found opaque type `impl Future<Output = ()>` (opaque type at <$DIR/match-prev-arm-needing-semi.rs:18:25>)\n    = note: distinct uses of `impl Trait` result in different opaque types\n help: consider `await`ing on both `Future`s\n    |"}, {"sha": "bb9dd2365ea0d5de834978e859d5006c4fb3cd4f", "filename": "tests/ui/type-alias-impl-trait/issue-98604.stderr", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Ftype-alias-impl-trait%2Fissue-98604.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/480c4a18d524a2cddd194fcf9a1bfdd6b7610656/tests%2Fui%2Ftype-alias-impl-trait%2Fissue-98604.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftype-alias-impl-trait%2Fissue-98604.stderr?ref=480c4a18d524a2cddd194fcf9a1bfdd6b7610656", "patch": "@@ -4,11 +4,6 @@ error[E0271]: expected `test` to be a fn item that returns `Pin<Box<dyn Future<O\n LL |     Box::new(test) as AsyncFnPtr;\n    |     ^^^^^^^^^^^^^^ expected `Pin<Box<dyn Future<Output = ()>>>`, found opaque type\n    |\n-note: while checking the return type of the `async fn`\n-  --> $DIR/issue-98604.rs:5:17\n-   |\n-LL | async fn test() {}\n-   |                 ^ checked the `Output` of this `async fn`, found opaque type\n    = note:   expected struct `Pin<Box<(dyn Future<Output = ()> + 'static)>>`\n            found opaque type `impl Future<Output = ()>`\n    = note: required for the cast from `fn() -> impl Future<Output = ()> {test}` to the object type `dyn Fn() -> Pin<Box<(dyn Future<Output = ()> + 'static)>>`"}]}