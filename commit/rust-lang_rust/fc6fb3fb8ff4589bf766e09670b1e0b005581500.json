{"sha": "fc6fb3fb8ff4589bf766e09670b1e0b005581500", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZjNmZiM2ZiOGZmNDU4OWJmNzY2ZTA5NjcwYjFlMGIwMDU1ODE1MDA=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2020-08-11T22:12:49Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2020-08-12T09:09:24Z"}, "message": "Allow #[doc(alias)] on impl const items", "tree": {"sha": "3a2634cef6fb51746cfb46ebc590f8cd92a1149c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3a2634cef6fb51746cfb46ebc590f8cd92a1149c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fc6fb3fb8ff4589bf766e09670b1e0b005581500", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fc6fb3fb8ff4589bf766e09670b1e0b005581500", "html_url": "https://github.com/rust-lang/rust/commit/fc6fb3fb8ff4589bf766e09670b1e0b005581500", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fc6fb3fb8ff4589bf766e09670b1e0b005581500/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3b6e4a84f92995f75cd2ab26b9b15eb508f85336", "url": "https://api.github.com/repos/rust-lang/rust/commits/3b6e4a84f92995f75cd2ab26b9b15eb508f85336", "html_url": "https://github.com/rust-lang/rust/commit/3b6e4a84f92995f75cd2ab26b9b15eb508f85336"}], "stats": {"total": 50, "additions": 24, "deletions": 26}, "files": [{"sha": "62ba412cb41924c82d00b5cf6fbf7e256db404bd", "filename": "src/librustc_passes/check_attr.rs", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fc6fb3fb8ff4589bf766e09670b1e0b005581500/src%2Flibrustc_passes%2Fcheck_attr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fc6fb3fb8ff4589bf766e09670b1e0b005581500/src%2Flibrustc_passes%2Fcheck_attr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_passes%2Fcheck_attr.rs?ref=fc6fb3fb8ff4589bf766e09670b1e0b005581500", "patch": "@@ -241,15 +241,11 @@ impl CheckAttrVisitor<'tcx> {\n                         if let Some(err) = match target {\n                             Target::Impl => Some(\"implementation block\"),\n                             Target::ForeignMod => Some(\"extern block\"),\n-                            Target::AssocConst | Target::AssocTy => {\n+                            Target::AssocTy => {\n                                 let parent_hir_id = self.tcx.hir().get_parent_item(hir_id);\n                                 let containing_item = self.tcx.hir().expect_item(parent_hir_id);\n                                 if Target::from_item(containing_item) == Target::Impl {\n-                                    Some(if target == Target::AssocConst {\n-                                        \"const in implementation block\"\n-                                    } else {\n-                                        \"type alias in implementation block\"\n-                                    })\n+                                    Some(\"type alias in implementation block\")\n                                 } else {\n                                     None\n                                 }"}, {"sha": "ff188d5145801ad127793bf1094137b6cadb743f", "filename": "src/test/rustdoc-js/doc-alias.js", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/fc6fb3fb8ff4589bf766e09670b1e0b005581500/src%2Ftest%2Frustdoc-js%2Fdoc-alias.js", "raw_url": "https://github.com/rust-lang/rust/raw/fc6fb3fb8ff4589bf766e09670b1e0b005581500/src%2Ftest%2Frustdoc-js%2Fdoc-alias.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-js%2Fdoc-alias.js?ref=fc6fb3fb8ff4589bf766e09670b1e0b005581500", "patch": "@@ -5,7 +5,7 @@ const QUERY = [\n     'StructFieldItem',\n     'StructMethodItem',\n     'ImplTraitItem',\n-    'ImplAssociatedConstItem',\n+    'StructImplConstItem',\n     'ImplTraitFunction',\n     'EnumItem',\n     'VariantItem',\n@@ -64,8 +64,16 @@ const EXPECTED = [\n         'others': [],\n     },\n     {\n-        // ImplAssociatedConstItem\n-        'others': [],\n+        // StructImplConstItem\n+        'others': [\n+            {\n+                'path': 'doc_alias::Struct',\n+                'name': 'ImplConstItem',\n+                'alias': 'StructImplConstItem',\n+                'href': '../doc_alias/struct.Struct.html#associatedconstant.ImplConstItem',\n+                'is_alias': true\n+            },\n+        ],\n     },\n     {\n         'others': [\n@@ -197,6 +205,10 @@ const EXPECTED = [\n                 'href': '../doc_alias/constant.Const.html',\n                 'is_alias': true\n             },\n+            {\n+                'path': 'doc_alias::Struct',\n+                'name': 'ImplConstItem',\n+            },\n         ],\n     },\n     {"}, {"sha": "41caa98643cdd4339de1ccc0621ad3055769aed6", "filename": "src/test/rustdoc-js/doc-alias.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fc6fb3fb8ff4589bf766e09670b1e0b005581500/src%2Ftest%2Frustdoc-js%2Fdoc-alias.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fc6fb3fb8ff4589bf766e09670b1e0b005581500/src%2Ftest%2Frustdoc-js%2Fdoc-alias.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-js%2Fdoc-alias.rs?ref=fc6fb3fb8ff4589bf766e09670b1e0b005581500", "patch": "@@ -7,6 +7,8 @@ pub struct Struct {\n }\n \n impl Struct {\n+    #[doc(alias = \"StructImplConstItem\")]\n+    pub const ImplConstItem: i32 = 0;\n     #[doc(alias = \"StructMethodItem\")]\n     pub fn method(&self) {}\n }"}, {"sha": "545964c7bd61b4017f0a2f9344ca399f04b14c97", "filename": "src/test/rustdoc-ui/check-doc-alias-attr-location.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fc6fb3fb8ff4589bf766e09670b1e0b005581500/src%2Ftest%2Frustdoc-ui%2Fcheck-doc-alias-attr-location.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fc6fb3fb8ff4589bf766e09670b1e0b005581500/src%2Ftest%2Frustdoc-ui%2Fcheck-doc-alias-attr-location.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcheck-doc-alias-attr-location.rs?ref=fc6fb3fb8ff4589bf766e09670b1e0b005581500", "patch": "@@ -11,8 +11,8 @@ extern {}\n \n #[doc(alias = \"bar\")] //~ ERROR\n impl Bar {\n-    #[doc(alias = \"const\")] //~ ERROR\n-    const A: u32 = 0;\n+    #[doc(alias = \"const\")]\n+    pub const A: u32 = 0;\n }\n \n #[doc(alias = \"foobar\")] //~ ERROR"}, {"sha": "a66e9939eaf18060a370627c079d7869d46fce35", "filename": "src/test/rustdoc-ui/check-doc-alias-attr-location.stderr", "status": "modified", "additions": 1, "deletions": 7, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fc6fb3fb8ff4589bf766e09670b1e0b005581500/src%2Ftest%2Frustdoc-ui%2Fcheck-doc-alias-attr-location.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fc6fb3fb8ff4589bf766e09670b1e0b005581500/src%2Ftest%2Frustdoc-ui%2Fcheck-doc-alias-attr-location.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fcheck-doc-alias-attr-location.stderr?ref=fc6fb3fb8ff4589bf766e09670b1e0b005581500", "patch": "@@ -16,17 +16,11 @@ error: `#[doc(alias = \"...\")]` isn't allowed on implementation block\n LL | #[doc(alias = \"foobar\")]\n    |       ^^^^^^^^^^^^^^^^\n \n-error: `#[doc(alias = \"...\")]` isn't allowed on const in implementation block\n-  --> $DIR/check-doc-alias-attr-location.rs:14:11\n-   |\n-LL |     #[doc(alias = \"const\")]\n-   |           ^^^^^^^^^^^^^^^\n-\n error: `#[doc(alias = \"...\")]` isn't allowed on type alias in implementation block\n   --> $DIR/check-doc-alias-attr-location.rs:20:11\n    |\n LL |     #[doc(alias = \"assoc\")]\n    |           ^^^^^^^^^^^^^^^\n \n-error: aborting due to 5 previous errors\n+error: aborting due to 4 previous errors\n "}, {"sha": "dac9b7372e08b30dab68bf03e7c94526fc0cdc63", "filename": "src/test/ui/check-doc-alias-attr-location.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fc6fb3fb8ff4589bf766e09670b1e0b005581500/src%2Ftest%2Fui%2Fcheck-doc-alias-attr-location.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fc6fb3fb8ff4589bf766e09670b1e0b005581500/src%2Ftest%2Fui%2Fcheck-doc-alias-attr-location.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcheck-doc-alias-attr-location.rs?ref=fc6fb3fb8ff4589bf766e09670b1e0b005581500", "patch": "@@ -12,7 +12,7 @@ extern {}\n \n #[doc(alias = \"bar\")] //~ ERROR\n impl Bar {\n-    #[doc(alias = \"const\")] //~ ERROR\n+    #[doc(alias = \"const\")]\n     const A: u32 = 0;\n }\n "}, {"sha": "29a99e4470e5f437591bb7631bda744f95bca15e", "filename": "src/test/ui/check-doc-alias-attr-location.stderr", "status": "modified", "additions": 1, "deletions": 7, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fc6fb3fb8ff4589bf766e09670b1e0b005581500/src%2Ftest%2Fui%2Fcheck-doc-alias-attr-location.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fc6fb3fb8ff4589bf766e09670b1e0b005581500/src%2Ftest%2Fui%2Fcheck-doc-alias-attr-location.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcheck-doc-alias-attr-location.stderr?ref=fc6fb3fb8ff4589bf766e09670b1e0b005581500", "patch": "@@ -16,17 +16,11 @@ error: `#[doc(alias = \"...\")]` isn't allowed on implementation block\n LL | #[doc(alias = \"foobar\")]\n    |       ^^^^^^^^^^^^^^^^\n \n-error: `#[doc(alias = \"...\")]` isn't allowed on const in implementation block\n-  --> $DIR/check-doc-alias-attr-location.rs:15:11\n-   |\n-LL |     #[doc(alias = \"const\")]\n-   |           ^^^^^^^^^^^^^^^\n-\n error: `#[doc(alias = \"...\")]` isn't allowed on type alias in implementation block\n   --> $DIR/check-doc-alias-attr-location.rs:21:11\n    |\n LL |     #[doc(alias = \"assoc\")]\n    |           ^^^^^^^^^^^^^^^\n \n-error: aborting due to 5 previous errors\n+error: aborting due to 4 previous errors\n "}]}