{"sha": "f0b42075981d9914c39e848377a3e12f0adf37d7", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYwYjQyMDc1OTgxZDk5MTRjMzllODQ4Mzc3YTNlMTJmMGFkZjM3ZDc=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-01-19T21:15:12Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-01-19T21:15:12Z"}, "message": "Auto merge of #39136 - keeperofdakeys:proc-macro-doc-test, r=alexcrichton\n\nStop warning when doc testing proc macro crates\n\nFixes #39064\n\nAdd the test option to the session struct that is passed\nto phase_2_configure_and_expand function inside the\nrustdoc test module.\n\nThis prevents the warning code from triggering when\nparsing proc_macro_derive attributes, just like when\n`--test` is normally invoked.\n\nThis change makes the warning disappear, but I'm not sure what else it might change. So this early PR is mainly to run the test suite, and to get feedback.", "tree": {"sha": "56dc08491470dcc39101f388c3823e84dec5ac46", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/56dc08491470dcc39101f388c3823e84dec5ac46"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f0b42075981d9914c39e848377a3e12f0adf37d7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f0b42075981d9914c39e848377a3e12f0adf37d7", "html_url": "https://github.com/rust-lang/rust/commit/f0b42075981d9914c39e848377a3e12f0adf37d7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f0b42075981d9914c39e848377a3e12f0adf37d7/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8e29b4d3876fc141a0c451c65045bda2c1f39534", "url": "https://api.github.com/repos/rust-lang/rust/commits/8e29b4d3876fc141a0c451c65045bda2c1f39534", "html_url": "https://github.com/rust-lang/rust/commit/8e29b4d3876fc141a0c451c65045bda2c1f39534"}, {"sha": "d492433744d76e12151716ae688295570ebc5375", "url": "https://api.github.com/repos/rust-lang/rust/commits/d492433744d76e12151716ae688295570ebc5375", "html_url": "https://github.com/rust-lang/rust/commit/d492433744d76e12151716ae688295570ebc5375"}], "stats": {"total": 4, "additions": 4, "deletions": 0}, "files": [{"sha": "26f331ac7d1a43e940430f3ea3982edbe618a5e4", "filename": "src/librustdoc/test.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f0b42075981d9914c39e848377a3e12f0adf37d7/src%2Flibrustdoc%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f0b42075981d9914c39e848377a3e12f0adf37d7/src%2Flibrustdoc%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Ftest.rs?ref=f0b42075981d9914c39e848377a3e12f0adf37d7", "patch": "@@ -67,6 +67,7 @@ pub fn run(input: &str,\n         crate_types: vec![config::CrateTypeDylib],\n         externs: externs.clone(),\n         unstable_features: UnstableFeatures::from_environment(),\n+        actually_rustdoc: true,\n         ..config::basic_options().clone()\n     };\n "}, {"sha": "5a53a4e8db34f6ad37372c4781c87ec302b1ea92", "filename": "src/test/run-pass-fulldeps/proc-macro/derive-test.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/f0b42075981d9914c39e848377a3e12f0adf37d7/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fderive-test.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f0b42075981d9914c39e848377a3e12f0adf37d7/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fderive-test.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fderive-test.rs?ref=f0b42075981d9914c39e848377a3e12f0adf37d7", "patch": "@@ -17,6 +17,9 @@ extern crate proc_macro;\n \n use proc_macro::TokenStream;\n \n+// ```\n+// assert!(true);\n+// ```\n #[proc_macro_derive(Foo)]\n pub fn derive_foo(_input: TokenStream) -> TokenStream {\n     \"\".parse().unwrap()"}]}