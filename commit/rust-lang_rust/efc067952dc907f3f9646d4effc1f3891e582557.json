{"sha": "efc067952dc907f3f9646d4effc1f3891e582557", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVmYzA2Nzk1MmRjOTA3ZjNmOTY0NmQ0ZWZmYzFmMzg5MWU1ODI1NTc=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-01-25T02:05:57Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-01-25T02:05:57Z"}, "message": "rustdoc: Add fn failure conditions to the doc tree", "tree": {"sha": "7bb92d57a61d309d6bc010f8f998b6af66ee21d3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7bb92d57a61d309d6bc010f8f998b6af66ee21d3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/efc067952dc907f3f9646d4effc1f3891e582557", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/efc067952dc907f3f9646d4effc1f3891e582557", "html_url": "https://github.com/rust-lang/rust/commit/efc067952dc907f3f9646d4effc1f3891e582557", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/efc067952dc907f3f9646d4effc1f3891e582557/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6d8058451b71f3e5a8178ca21856b529655df032", "url": "https://api.github.com/repos/rust-lang/rust/commits/6d8058451b71f3e5a8178ca21856b529655df032", "html_url": "https://github.com/rust-lang/rust/commit/6d8058451b71f3e5a8178ca21856b529655df032"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "c5698b4afb99d15f64ca7672caa494dfb5ee0945", "filename": "src/rustdoc/attr_pass.rs", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/efc067952dc907f3f9646d4effc1f3891e582557/src%2Frustdoc%2Fattr_pass.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efc067952dc907f3f9646d4effc1f3891e582557/src%2Frustdoc%2Fattr_pass.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Fattr_pass.rs?ref=efc067952dc907f3f9646d4effc1f3891e582557", "patch": "@@ -135,7 +135,8 @@ fn fold_fn(\n             brief: attrs.brief,\n             desc: attrs.desc,\n             args: merge_arg_attrs(doc.args, attrs.args),\n-            return: merge_ret_attrs(doc.return, attrs.return)\n+            return: merge_ret_attrs(doc.return, attrs.return),\n+            failure: attrs.failure\n             with *doc\n         };\n     }\n@@ -213,6 +214,16 @@ fn fold_fn_should_preserve_sig() {\n     assert doc.sig == some(\"fn a() -> int\");\n }\n \n+#[test]\n+fn fold_fn_should_extract_failure_conditions() {\n+    let source = \"#[doc(failure = \\\"what\\\")] fn a() { }\";\n+    let srv = astsrv::mk_srv_from_str(source);\n+    let doc = extract::from_srv(srv, \"\");\n+    let fold = fold::default_seq_fold(srv);\n+    let doc = fold_fn(fold, doc.topmod.fns[0]);\n+    assert doc.failure == some(\"what\");\n+}\n+\n fn fold_const(\n     fold: fold::fold<astsrv::srv>,\n     doc: doc::constdoc"}, {"sha": "0e2f081ee39a90232ec3e0d271c474bc4b8db9ef", "filename": "src/rustdoc/doc.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/efc067952dc907f3f9646d4effc1f3891e582557/src%2Frustdoc%2Fdoc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efc067952dc907f3f9646d4effc1f3891e582557/src%2Frustdoc%2Fdoc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Fdoc.rs?ref=efc067952dc907f3f9646d4effc1f3891e582557", "patch": "@@ -32,6 +32,7 @@ type fndoc = ~{\n     desc: option<str>,\n     args: [argdoc],\n     return: retdoc,\n+    failure: option<str>,\n     sig: option<str>\n };\n "}, {"sha": "34fd89bc5a774c15d2f6e9c848d8db3ed2bdc77d", "filename": "src/rustdoc/extract.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/efc067952dc907f3f9646d4effc1f3891e582557/src%2Frustdoc%2Fextract.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efc067952dc907f3f9646d4effc1f3891e582557/src%2Frustdoc%2Fextract.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Fextract.rs?ref=efc067952dc907f3f9646d4effc1f3891e582557", "patch": "@@ -95,6 +95,7 @@ fn fndoc_from_fn(\n             desc: none,\n             ty: none\n         },\n+        failure: none,\n         sig: none\n     }\n }"}]}