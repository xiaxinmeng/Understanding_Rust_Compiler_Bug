{"sha": "5b2451c2318499310a0183ff518ffb7d308aafa2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjViMjQ1MWMyMzE4NDk5MzEwYTAxODNmZjUxOGZmYjdkMzA4YWFmYTI=", "commit": {"author": {"name": "Roy Frostig", "email": "rfrostig@mozilla.com", "date": "2010-08-04T01:18:19Z"}, "committer": {"name": "Roy Frostig", "email": "rfrostig@mozilla.com", "date": "2010-08-04T01:18:19Z"}, "message": "Address _vec.map allocation FIXME.  Add test.", "tree": {"sha": "62f771d11d56ecf32fe74c9a77d2491d2ee94740", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/62f771d11d56ecf32fe74c9a77d2491d2ee94740"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5b2451c2318499310a0183ff518ffb7d308aafa2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5b2451c2318499310a0183ff518ffb7d308aafa2", "html_url": "https://github.com/rust-lang/rust/commit/5b2451c2318499310a0183ff518ffb7d308aafa2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5b2451c2318499310a0183ff518ffb7d308aafa2/comments", "author": {"login": "froystig", "id": 123903, "node_id": "MDQ6VXNlcjEyMzkwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/123903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/froystig", "html_url": "https://github.com/froystig", "followers_url": "https://api.github.com/users/froystig/followers", "following_url": "https://api.github.com/users/froystig/following{/other_user}", "gists_url": "https://api.github.com/users/froystig/gists{/gist_id}", "starred_url": "https://api.github.com/users/froystig/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/froystig/subscriptions", "organizations_url": "https://api.github.com/users/froystig/orgs", "repos_url": "https://api.github.com/users/froystig/repos", "events_url": "https://api.github.com/users/froystig/events{/privacy}", "received_events_url": "https://api.github.com/users/froystig/received_events", "type": "User", "site_admin": false}, "committer": {"login": "froystig", "id": 123903, "node_id": "MDQ6VXNlcjEyMzkwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/123903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/froystig", "html_url": "https://github.com/froystig", "followers_url": "https://api.github.com/users/froystig/followers", "following_url": "https://api.github.com/users/froystig/following{/other_user}", "gists_url": "https://api.github.com/users/froystig/gists{/gist_id}", "starred_url": "https://api.github.com/users/froystig/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/froystig/subscriptions", "organizations_url": "https://api.github.com/users/froystig/orgs", "repos_url": "https://api.github.com/users/froystig/repos", "events_url": "https://api.github.com/users/froystig/events{/privacy}", "received_events_url": "https://api.github.com/users/froystig/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5796ebb1e7b4f96a362604af378fa5e4e08e6306", "url": "https://api.github.com/repos/rust-lang/rust/commits/5796ebb1e7b4f96a362604af378fa5e4e08e6306", "html_url": "https://github.com/rust-lang/rust/commit/5796ebb1e7b4f96a362604af378fa5e4e08e6306"}], "stats": {"total": 20, "additions": 14, "deletions": 6}, "files": [{"sha": "43779015000711736550a645f0a757012debc6d0", "filename": "src/lib/_vec.rs", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/5b2451c2318499310a0183ff518ffb7d308aafa2/src%2Flib%2F_vec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5b2451c2318499310a0183ff518ffb7d308aafa2/src%2Flib%2F_vec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib%2F_vec.rs?ref=5b2451c2318499310a0183ff518ffb7d308aafa2", "patch": "@@ -76,14 +76,10 @@ fn grow[T](&mutable vec[T] v, int n, &T initval) {\n   }\n }\n \n-fn map[T,U](&op[T,U] f, &vec[T] v) -> vec[U] {\n-  // FIXME: should be\n-  // let vec[U] u = alloc[U](len[T](v));\n-  // but this does not work presently.\n-  let vec[U] u = vec();\n+fn map[T, U](&op[T,U] f, &vec[T] v) -> vec[U] {\n+  let vec[U] u = alloc[U](len[T](v));\n   for (T ve in v) {\n     u += vec(f(ve));\n   }\n   ret u;\n }\n-"}, {"sha": "ccd83d33284d284af993c1a0953ca95747e7d124", "filename": "src/test/run-pass/vec-lib.rs", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/5b2451c2318499310a0183ff518ffb7d308aafa2/src%2Ftest%2Frun-pass%2Fvec-lib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5b2451c2318499310a0183ff518ffb7d308aafa2/src%2Ftest%2Frun-pass%2Fvec-lib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fvec-lib.rs?ref=5b2451c2318499310a0183ff518ffb7d308aafa2", "patch": "@@ -30,6 +30,18 @@ fn test_slice() {\n   check (v2.(1) == 4);\n }\n \n+fn test_map() {\n+  fn square(&int x) -> int { ret x * x; }\n+  let std.util.operator[int, int] op = square;\n+  let vec[int] v = vec(1, 2, 3, 4, 5);\n+  let vec[int] s = std._vec.map[int, int](op, v);\n+  let int i = 0;\n+  while (i < 5) {\n+    check (v.(i) == s.(i));\n+    i += 1;\n+  }\n+}\n+\n fn main() {\n   test_init_elt();\n   //XFAIL: test_init_fn();  // Segfaults."}]}