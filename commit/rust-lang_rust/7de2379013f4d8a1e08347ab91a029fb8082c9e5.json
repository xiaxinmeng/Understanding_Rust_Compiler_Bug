{"sha": "7de2379013f4d8a1e08347ab91a029fb8082c9e5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdkZTIzNzkwMTNmNGQ4YTFlMDgzNDdhYjkxYTAyOWZiODA4MmM5ZTU=", "commit": {"author": {"name": "Alan Andrade", "email": "alan.andradec@gmail.com", "date": "2014-01-06T21:38:20Z"}, "committer": {"name": "Alan Andrade", "email": "alan.andradec@gmail.com", "date": "2014-01-06T21:38:20Z"}, "message": "rust_version.html is a HTML_DEPS and every html has it as dependecy", "tree": {"sha": "2c23f67146375c61e13e0385176c1058fd9b8524", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2c23f67146375c61e13e0385176c1058fd9b8524"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7de2379013f4d8a1e08347ab91a029fb8082c9e5", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7de2379013f4d8a1e08347ab91a029fb8082c9e5", "html_url": "https://github.com/rust-lang/rust/commit/7de2379013f4d8a1e08347ab91a029fb8082c9e5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7de2379013f4d8a1e08347ab91a029fb8082c9e5/comments", "author": {"login": "alan-andrade", "id": 97609, "node_id": "MDQ6VXNlcjk3NjA5", "avatar_url": "https://avatars.githubusercontent.com/u/97609?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alan-andrade", "html_url": "https://github.com/alan-andrade", "followers_url": "https://api.github.com/users/alan-andrade/followers", "following_url": "https://api.github.com/users/alan-andrade/following{/other_user}", "gists_url": "https://api.github.com/users/alan-andrade/gists{/gist_id}", "starred_url": "https://api.github.com/users/alan-andrade/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alan-andrade/subscriptions", "organizations_url": "https://api.github.com/users/alan-andrade/orgs", "repos_url": "https://api.github.com/users/alan-andrade/repos", "events_url": "https://api.github.com/users/alan-andrade/events{/privacy}", "received_events_url": "https://api.github.com/users/alan-andrade/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alan-andrade", "id": 97609, "node_id": "MDQ6VXNlcjk3NjA5", "avatar_url": "https://avatars.githubusercontent.com/u/97609?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alan-andrade", "html_url": "https://github.com/alan-andrade", "followers_url": "https://api.github.com/users/alan-andrade/followers", "following_url": "https://api.github.com/users/alan-andrade/following{/other_user}", "gists_url": "https://api.github.com/users/alan-andrade/gists{/gist_id}", "starred_url": "https://api.github.com/users/alan-andrade/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alan-andrade/subscriptions", "organizations_url": "https://api.github.com/users/alan-andrade/orgs", "repos_url": "https://api.github.com/users/alan-andrade/repos", "events_url": "https://api.github.com/users/alan-andrade/events{/privacy}", "received_events_url": "https://api.github.com/users/alan-andrade/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e53b5661a766d962898ea23631ee6a0e70949164", "url": "https://api.github.com/repos/rust-lang/rust/commits/e53b5661a766d962898ea23631ee6a0e70949164", "html_url": "https://github.com/rust-lang/rust/commit/e53b5661a766d962898ea23631ee6a0e70949164"}], "stats": {"total": 63, "additions": 29, "deletions": 34}, "files": [{"sha": "b27c8f2315171a363b36d66fa8764a071e68d7c6", "filename": "mk/docs.mk", "status": "modified", "additions": 29, "deletions": 34, "changes": 63, "blob_url": "https://github.com/rust-lang/rust/blob/7de2379013f4d8a1e08347ab91a029fb8082c9e5/mk%2Fdocs.mk", "raw_url": "https://github.com/rust-lang/rust/raw/7de2379013f4d8a1e08347ab91a029fb8082c9e5/mk%2Fdocs.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fdocs.mk?ref=7de2379013f4d8a1e08347ab91a029fb8082c9e5", "patch": "@@ -24,6 +24,23 @@ HTML_OPTS = $(BASE_DOC_OPTS) \t--to=html5  --section-divs --css=rust.css  \\\n TEX_OPTS = $(BASE_DOC_OPTS) --to=latex\n EPUB_OPTS = $(BASE_DOC_OPTS) --to=epub\n \n+######################################################################\n+# Rust version\n+######################################################################\n+doc/version.md: $(MKFILE_DEPS) $(wildcard $(S)doc/*.*)\n+\t@$(call E, version-stamp: $@)\n+\t$(Q)echo \"$(CFG_VERSION)\" >$@\n+\n+HTML_DEPS += doc/version_info.html\n+doc/version_info.html: version_info.html.template $(MKFILE_DEPS) \\\n+                       $(wildcard $(S)doc/*.*)\n+\t@$(call E, version-info: $@)\n+\tsed -e \"s/VERSION/$(CFG_RELEASE)/; s/SHORT_HASH/$(shell echo \\\n+                    $(CFG_VER_HASH) | head -c 8)/;\\\n+                s/STAMP/$(CFG_VER_HASH)/;\" $< >$@\n+\n+GENERATED += doc/version.md doc/version_info.html\n+\n ######################################################################\n # Docs, from pandoc, rustdoc (which runs pandoc), and node\n ######################################################################\n@@ -55,7 +72,7 @@ endif\n ifneq ($(NO_DOCS),1)\n \n DOCS += doc/rust.html\n-doc/rust.html: rust.md doc/version_info.html doc/full-toc.inc $(HTML_DEPS) \n+doc/rust.html: rust.md doc/full-toc.inc $(HTML_DEPS) \n \t@$(call E, pandoc: $@)\n \t$(Q)$(CFG_NODE) $(S)doc/prep.js --highlight $< | \\\n \t$(CFG_PANDOC) $(HTML_OPTS) --include-in-header=doc/full-toc.inc --output=$@\n@@ -73,19 +90,19 @@ doc/rust.epub: rust.md doc/version_info.html doc/rust.css\n \t$(CFG_PANDOC) $(EPUB_OPTS) --output=$@\n \n DOCS += doc/rustpkg.html\n-doc/rustpkg.html: rustpkg.md doc/version_info.html $(HTML_DEPS)\n+doc/rustpkg.html: rustpkg.md $(HTML_DEPS)\n \t@$(call E, pandoc: $@)\n \t$(Q)$(CFG_NODE) $(S)doc/prep.js --highlight $< | \\\n \t$(CFG_PANDOC) $(HTML_OPTS) --output=$@\n \n DOCS += doc/rustdoc.html\n-doc/rustdoc.html: rustdoc.md doc/version_info.html $(HTML_DEPS)\n+doc/rustdoc.html: rustdoc.md $(HTML_DEPS)\n \t@$(call E, pandoc: $@)\n \t$(Q)$(CFG_NODE) $(S)doc/prep.js --highlight $< | \\\n \t$(CFG_PANDOC) $(HTML_OPTS) --output=$@\n \n DOCS += doc/tutorial.html\n-doc/tutorial.html: tutorial.md doc/version_info.html $(HTML_DEPS)\n+doc/tutorial.html: tutorial.md $(HTML_DEPS)\n \t@$(call E, pandoc: $@)\n \t$(Q)$(CFG_NODE) $(S)doc/prep.js --highlight $< | \\\n \t$(CFG_PANDOC) $(HTML_OPTS) --output=$@\n@@ -154,57 +171,49 @@ doc/complement-bugreport.html: $(S)doc/complement-bugreport.md $(HTML_DEPS)\n # Guides\n \n DOCS += doc/guide-macros.html\n-doc/guide-macros.html: $(S)doc/guide-macros.md doc/version_info.html doc/rust.css \\\n-\t\t\t\tdoc/favicon.inc\n+doc/guide-macros.html: $(S)doc/guide-macros.md $(HTML_DEPS)\n \t@$(call E, pandoc: $@)\n \t$(Q)$(CFG_NODE) $(S)doc/prep.js --highlight $< | \\\n \t$(CFG_PANDOC) $(HTML_OPTS) --output=$@\n \n DOCS += doc/guide-container.html\n-doc/guide-container.html: $(S)doc/guide-container.md doc/version_info.html doc/rust.css \\\n-\t\t\t\tdoc/favicon.inc\n+doc/guide-container.html: $(S)doc/guide-container.md $(HTML_DEPS)\n \t@$(call E, pandoc: $@)\n \t$(Q)$(CFG_NODE) $(S)doc/prep.js --highlight $< | \\\n \t$(CFG_PANDOC) $(HTML_OPTS) --output=$@\n \n DOCS += doc/guide-ffi.html\n-doc/guide-ffi.html: $(S)doc/guide-ffi.md doc/version_info.html doc/rust.css \\\n-\t\t\t\tdoc/favicon.inc\n+doc/guide-ffi.html: $(S)doc/guide-ffi.md $(HTML_DEPS)\n \t@$(call E, pandoc: $@)\n \t$(Q)$(CFG_NODE) $(S)doc/prep.js --highlight $< | \\\n \t$(CFG_PANDOC) $(HTML_OPTS) --output=$@\n \n DOCS += doc/guide-testing.html\n-doc/guide-testing.html: $(S)doc/guide-testing.md doc/version_info.html doc/rust.css \\\n-\t\t\t\tdoc/favicon.inc\n+doc/guide-testing.html: $(S)doc/guide-testing.md $(HTML_DEPS)\n \t@$(call E, pandoc: $@)\n \t$(Q)$(CFG_NODE) $(S)doc/prep.js --highlight $< | \\\n \t$(CFG_PANDOC) $(HTML_OPTS) --output=$@\n \n DOCS += doc/guide-borrowed-ptr.html\n-doc/guide-borrowed-ptr.html: $(S)doc/guide-borrowed-ptr.md doc/version_info.html doc/rust.css \\\n-\t\t\t\tdoc/favicon.inc\n+doc/guide-borrowed-ptr.html: $(S)doc/guide-borrowed-ptr.md $(HTML_DEPS)\n \t@$(call E, pandoc: $@)\n \t$(Q)$(CFG_NODE) $(S)doc/prep.js --highlight $< | \\\n \t$(CFG_PANDOC) $(HTML_OPTS) --output=$@\n \n DOCS += doc/guide-tasks.html\n-doc/guide-tasks.html: $(S)doc/guide-tasks.md doc/version_info.html doc/rust.css \\\n-\t\t\t\tdoc/favicon.inc\n+doc/guide-tasks.html: $(S)doc/guide-tasks.md $(HTML_DEPS)\n \t@$(call E, pandoc: $@)\n \t$(Q)$(CFG_NODE) $(S)doc/prep.js --highlight $< | \\\n \t$(CFG_PANDOC) $(HTML_OPTS) --output=$@\n \n DOCS += doc/guide-conditions.html\n-doc/guide-conditions.html: $(S)doc/guide-conditions.md doc/version_info.html doc/rust.css \\\n-\t\t\t\tdoc/favicon.inc\n+doc/guide-conditions.html: $(S)doc/guide-conditions.md $(HTML_DEPS)\n \t@$(call E, pandoc: $@)\n \t$(Q)$(CFG_NODE) $(S)doc/prep.js --highlight $< | \\\n \t$(CFG_PANDOC) $(HTML_OPTS) --output=$@\n \n DOCS += doc/guide-rustpkg.html\n-doc/guide-rustpkg.html: $(S)doc/guide-rustpkg.md doc/version_info.html doc/rust.css \\\n-\t\t\t\tdoc/favicon.inc\n+doc/guide-rustpkg.html: $(S)doc/guide-rustpkg.md $(HTML_DEPS)\n \t@$(call E, pandoc: $@)\n \t$(Q)$(CFG_NODE) $(S)doc/prep.js --highlight $< | \\\n \t$(CFG_PANDOC) $(HTML_OPTS) --output=$@\n@@ -303,20 +312,6 @@ ifdef CFG_DISABLE_DOCS\n   DOCS :=\n endif\n \n-\n-doc/version.md: $(MKFILE_DEPS) $(wildcard $(S)doc/*.*)\n-\t@$(call E, version-stamp: $@)\n-\t$(Q)echo \"$(CFG_VERSION)\" >$@\n-\n-doc/version_info.html: version_info.html.template $(MKFILE_DEPS) \\\n-                       $(wildcard $(S)doc/*.*)\n-\t@$(call E, version-info: $@)\n-\tsed -e \"s/VERSION/$(CFG_RELEASE)/; s/SHORT_HASH/$(shell echo \\\n-                    $(CFG_VER_HASH) | head -c 8)/;\\\n-                s/STAMP/$(CFG_VER_HASH)/;\" $< >$@\n-\n-GENERATED += doc/version.md doc/version_info.html\n-\n docs: $(DOCS)\n compiler-docs: $(CDOCS)\n "}]}