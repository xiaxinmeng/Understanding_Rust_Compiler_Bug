{"sha": "9fe1b24736c8390364d8fdfdb35c6611e29eaf13", "node_id": "C_kwDOAAsO6NoAKDlmZTFiMjQ3MzZjODM5MDM2NGQ4ZmRmZGIzNWM2NjExZTI5ZWFmMTM", "commit": {"author": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2022-04-27T16:25:12Z"}, "committer": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2022-05-01T17:57:09Z"}, "message": "Update config usage in slow tests", "tree": {"sha": "f2f16ef372336e6e04ba9148c1713027273e4550", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f2f16ef372336e6e04ba9148c1713027273e4550"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9fe1b24736c8390364d8fdfdb35c6611e29eaf13", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9fe1b24736c8390364d8fdfdb35c6611e29eaf13", "html_url": "https://github.com/rust-lang/rust/commit/9fe1b24736c8390364d8fdfdb35c6611e29eaf13", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9fe1b24736c8390364d8fdfdb35c6611e29eaf13/comments", "author": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3d17261972fcf5f55660a6e2889608142426d5c3", "url": "https://api.github.com/repos/rust-lang/rust/commits/3d17261972fcf5f55660a6e2889608142426d5c3", "html_url": "https://github.com/rust-lang/rust/commit/3d17261972fcf5f55660a6e2889608142426d5c3"}], "stats": {"total": 18, "additions": 12, "deletions": 6}, "files": [{"sha": "1af59cfebee90df9c3cc1fb9ab67cec60d7d57f9", "filename": "crates/rust-analyzer/src/config.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9fe1b24736c8390364d8fdfdb35c6611e29eaf13/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9fe1b24736c8390364d8fdfdb35c6611e29eaf13/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs?ref=9fe1b24736c8390364d8fdfdb35c6611e29eaf13", "patch": "@@ -525,6 +525,7 @@ pub struct ClientCommandsConfig {\n     pub trigger_parameter_hints: bool,\n }\n \n+#[derive(Debug)]\n pub struct ConfigUpdateError {\n     errors: Vec<(String, serde_json::Error)>,\n }\n@@ -1442,7 +1443,6 @@ fn get_field<T: DeserializeOwned>(\n     default: &str,\n ) -> T {\n     let default = serde_json::from_str(default).unwrap();\n-\n     // XXX: check alias first, to work-around the VS Code where it pre-fills the\n     // defaults instead of sending an empty object.\n     alias"}, {"sha": "143b63e11c59abcaa02fdf6873159ef09c2b466e", "filename": "crates/rust-analyzer/tests/slow-tests/main.rs", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/9fe1b24736c8390364d8fdfdb35c6611e29eaf13/crates%2Frust-analyzer%2Ftests%2Fslow-tests%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9fe1b24736c8390364d8fdfdb35c6611e29eaf13/crates%2Frust-analyzer%2Ftests%2Fslow-tests%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Ftests%2Fslow-tests%2Fmain.rs?ref=9fe1b24736c8390364d8fdfdb35c6611e29eaf13", "patch": "@@ -685,7 +685,7 @@ version = \\\"0.0.0\\\"\n #[test]\n fn out_dirs_check() {\n     if skip_slow_tests() {\n-        return;\n+        // return;\n     }\n \n     let server = Project::with_fixture(\n@@ -737,7 +737,9 @@ fn main() {\n     )\n     .with_config(serde_json::json!({\n         \"cargo\": {\n-            \"loadOutDirsFromCheck\": true,\n+            \"buildScripts\": {\n+                \"enable\": true\n+            },\n             \"noSysroot\": true,\n         }\n     }))\n@@ -890,7 +892,9 @@ pub fn foo(_input: TokenStream) -> TokenStream {\n     )\n     .with_config(serde_json::json!({\n         \"cargo\": {\n-            \"loadOutDirsFromCheck\": true,\n+            \"buildScripts\": {\n+                \"enable\": true\n+            },\n             \"noSysroot\": true,\n         },\n         \"procMacro\": {"}, {"sha": "36bffe3210e8744768476b9c57ce712517fea91d", "filename": "crates/rust-analyzer/tests/slow-tests/support.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/9fe1b24736c8390364d8fdfdb35c6611e29eaf13/crates%2Frust-analyzer%2Ftests%2Fslow-tests%2Fsupport.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9fe1b24736c8390364d8fdfdb35c6611e29eaf13/crates%2Frust-analyzer%2Ftests%2Fslow-tests%2Fsupport.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Ftests%2Fslow-tests%2Fsupport.rs?ref=9fe1b24736c8390364d8fdfdb35c6611e29eaf13", "patch": "@@ -36,7 +36,9 @@ impl<'a> Project<'a> {\n                     // Loading standard library is costly, let's ignore it by default\n                     \"noSysroot\": true,\n                     // Can't use test binary as rustc wrapper.\n-                    \"useRustcWrapperForBuildScripts\": false,\n+                    \"buildScripts\": {\n+                        \"useRustcWrapper\": false\n+                    },\n                 }\n             }),\n         }\n@@ -137,7 +139,7 @@ impl<'a> Project<'a> {\n             },\n         );\n         config.discovered_projects = Some(discovered_projects);\n-        let _ = config.update(self.config);\n+        config.update(self.config).expect(\"invalid config\");\n \n         Server::new(tmp_dir, config)\n     }"}]}