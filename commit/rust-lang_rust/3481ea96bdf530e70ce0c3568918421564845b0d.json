{"sha": "3481ea96bdf530e70ce0c3568918421564845b0d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM0ODFlYTk2YmRmNTMwZTcwY2UwYzM1Njg5MTg0MjE1NjQ4NDViMGQ=", "commit": {"author": {"name": "Kirill Bulatov", "email": "mail4score@gmail.com", "date": "2020-11-11T12:04:31Z"}, "committer": {"name": "Kirill Bulatov", "email": "mail4score@gmail.com", "date": "2020-11-12T11:46:02Z"}, "message": "Add a FIXME for non-unified inner attributes", "tree": {"sha": "7d68a8e4f60632398b5cce3d3331c89c3da1ab12", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7d68a8e4f60632398b5cce3d3331c89c3da1ab12"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3481ea96bdf530e70ce0c3568918421564845b0d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3481ea96bdf530e70ce0c3568918421564845b0d", "html_url": "https://github.com/rust-lang/rust/commit/3481ea96bdf530e70ce0c3568918421564845b0d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3481ea96bdf530e70ce0c3568918421564845b0d/comments", "author": {"login": "SomeoneToIgnore", "id": 2690773, "node_id": "MDQ6VXNlcjI2OTA3NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/2690773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SomeoneToIgnore", "html_url": "https://github.com/SomeoneToIgnore", "followers_url": "https://api.github.com/users/SomeoneToIgnore/followers", "following_url": "https://api.github.com/users/SomeoneToIgnore/following{/other_user}", "gists_url": "https://api.github.com/users/SomeoneToIgnore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SomeoneToIgnore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SomeoneToIgnore/subscriptions", "organizations_url": "https://api.github.com/users/SomeoneToIgnore/orgs", "repos_url": "https://api.github.com/users/SomeoneToIgnore/repos", "events_url": "https://api.github.com/users/SomeoneToIgnore/events{/privacy}", "received_events_url": "https://api.github.com/users/SomeoneToIgnore/received_events", "type": "User", "site_admin": false}, "committer": {"login": "SomeoneToIgnore", "id": 2690773, "node_id": "MDQ6VXNlcjI2OTA3NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/2690773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SomeoneToIgnore", "html_url": "https://github.com/SomeoneToIgnore", "followers_url": "https://api.github.com/users/SomeoneToIgnore/followers", "following_url": "https://api.github.com/users/SomeoneToIgnore/following{/other_user}", "gists_url": "https://api.github.com/users/SomeoneToIgnore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SomeoneToIgnore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SomeoneToIgnore/subscriptions", "organizations_url": "https://api.github.com/users/SomeoneToIgnore/orgs", "repos_url": "https://api.github.com/users/SomeoneToIgnore/repos", "events_url": "https://api.github.com/users/SomeoneToIgnore/events{/privacy}", "received_events_url": "https://api.github.com/users/SomeoneToIgnore/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "335edf87bc84bdfcc48ab23f12f606ced09dbac7", "url": "https://api.github.com/repos/rust-lang/rust/commits/335edf87bc84bdfcc48ab23f12f606ced09dbac7", "html_url": "https://github.com/rust-lang/rust/commit/335edf87bc84bdfcc48ab23f12f606ced09dbac7"}], "stats": {"total": 9, "additions": 7, "deletions": 2}, "files": [{"sha": "5d726370af678b58d31a53b40e3388af78f4c7f0", "filename": "crates/assists/src/utils/insert_use.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/3481ea96bdf530e70ce0c3568918421564845b0d/crates%2Fassists%2Fsrc%2Futils%2Finsert_use.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3481ea96bdf530e70ce0c3568918421564845b0d/crates%2Fassists%2Fsrc%2Futils%2Finsert_use.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fassists%2Fsrc%2Futils%2Finsert_use.rs?ref=3481ea96bdf530e70ce0c3568918421564845b0d", "patch": "@@ -72,6 +72,11 @@ impl ImportScope {\n                     if is_inner_node(maybe_inner_node.clone()) {\n                         last_inner_element = Some(NodeOrToken::Node(maybe_inner_node))\n                     } else {\n+                        // FIXME: https://doc.rust-lang.org/reference/comments.html#doc-comments\n+                        // states that inner comments (`//!` and `/*!`) are equal to inner attribute `#![doc=\"...\"]`\n+                        // yet RA treats them differently now: inner attributes never belong to child nodes,\n+                        // but inner comments can, ergo this check.\n+                        // We need to align this and treat both cases the same way.\n                         if let Some(maybe_inner_token) = maybe_inner_node.first_token() {\n                             if is_inner_token(maybe_inner_token.clone()) {\n                                 last_inner_element = Some(NodeOrToken::Token(maybe_inner_token))\n@@ -877,11 +882,11 @@ use foo::bar::Baz;\"#,\n             \"foo::bar::Baz\",\n             r#\"/*! Multiline inner comments do not allow any code before them. */\n \n-/*! RA considers this inner comment belonging to the function, yet we still cannot place the code before it. */\n+/*! Still an inner comment, cannot place any code before. */\n fn main() {}\"#,\n             r#\"/*! Multiline inner comments do not allow any code before them. */\n \n-/*! RA considers this inner comment belonging to the function, yet we still cannot place the code before it. */\n+/*! Still an inner comment, cannot place any code before. */\n \n use foo::bar::Baz;\n fn main() {}\"#,"}]}