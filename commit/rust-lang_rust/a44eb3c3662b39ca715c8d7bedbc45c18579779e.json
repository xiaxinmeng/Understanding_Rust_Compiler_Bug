{"sha": "a44eb3c3662b39ca715c8d7bedbc45c18579779e", "node_id": "C_kwDOAAsO6NoAKGE0NGViM2MzNjYyYjM5Y2E3MTVjOGQ3YmVkYmM0NWMxODU3OTc3OWU", "commit": {"author": {"name": "Maybe Waffle", "email": "waffle.lapkin@gmail.com", "date": "2022-11-28T18:04:29Z"}, "committer": {"name": "Maybe Waffle", "email": "waffle.lapkin@gmail.com", "date": "2022-11-28T18:04:29Z"}, "message": "Remove `Const::from_scalar_int`", "tree": {"sha": "f72258c186a9381f3504c117267d4bc035ac70e3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f72258c186a9381f3504c117267d4bc035ac70e3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a44eb3c3662b39ca715c8d7bedbc45c18579779e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a44eb3c3662b39ca715c8d7bedbc45c18579779e", "html_url": "https://github.com/rust-lang/rust/commit/a44eb3c3662b39ca715c8d7bedbc45c18579779e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a44eb3c3662b39ca715c8d7bedbc45c18579779e/comments", "author": {"login": "WaffleLapkin", "id": 38225716, "node_id": "MDQ6VXNlcjM4MjI1NzE2", "avatar_url": "https://avatars.githubusercontent.com/u/38225716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/WaffleLapkin", "html_url": "https://github.com/WaffleLapkin", "followers_url": "https://api.github.com/users/WaffleLapkin/followers", "following_url": "https://api.github.com/users/WaffleLapkin/following{/other_user}", "gists_url": "https://api.github.com/users/WaffleLapkin/gists{/gist_id}", "starred_url": "https://api.github.com/users/WaffleLapkin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/WaffleLapkin/subscriptions", "organizations_url": "https://api.github.com/users/WaffleLapkin/orgs", "repos_url": "https://api.github.com/users/WaffleLapkin/repos", "events_url": "https://api.github.com/users/WaffleLapkin/events{/privacy}", "received_events_url": "https://api.github.com/users/WaffleLapkin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "WaffleLapkin", "id": 38225716, "node_id": "MDQ6VXNlcjM4MjI1NzE2", "avatar_url": "https://avatars.githubusercontent.com/u/38225716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/WaffleLapkin", "html_url": "https://github.com/WaffleLapkin", "followers_url": "https://api.github.com/users/WaffleLapkin/followers", "following_url": "https://api.github.com/users/WaffleLapkin/following{/other_user}", "gists_url": "https://api.github.com/users/WaffleLapkin/gists{/gist_id}", "starred_url": "https://api.github.com/users/WaffleLapkin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/WaffleLapkin/subscriptions", "organizations_url": "https://api.github.com/users/WaffleLapkin/orgs", "repos_url": "https://api.github.com/users/WaffleLapkin/repos", "events_url": "https://api.github.com/users/WaffleLapkin/events{/privacy}", "received_events_url": "https://api.github.com/users/WaffleLapkin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b44817f95eeed6c80cc8a4477a456b3d567ce22c", "url": "https://api.github.com/repos/rust-lang/rust/commits/b44817f95eeed6c80cc8a4477a456b3d567ce22c", "html_url": "https://github.com/rust-lang/rust/commit/b44817f95eeed6c80cc8a4477a456b3d567ce22c"}], "stats": {"total": 10, "additions": 4, "deletions": 6}, "files": [{"sha": "c2be08e497e5bf85bc9174c7a05daf806eb91b51", "filename": "compiler/rustc_middle/src/ty/consts.rs", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/a44eb3c3662b39ca715c8d7bedbc45c18579779e/compiler%2Frustc_middle%2Fsrc%2Fty%2Fconsts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a44eb3c3662b39ca715c8d7bedbc45c18579779e/compiler%2Frustc_middle%2Fsrc%2Fty%2Fconsts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Fconsts.rs?ref=a44eb3c3662b39ca715c8d7bedbc45c18579779e", "patch": "@@ -148,19 +148,17 @@ impl<'tcx> Const<'tcx> {\n         }\n     }\n \n-    pub fn from_scalar_int(tcx: TyCtxt<'tcx>, i: ScalarInt, ty: Ty<'tcx>) -> Self {\n-        let valtree = ty::ValTree::from_scalar_int(i);\n-        tcx.mk_const(valtree, ty)\n-    }\n-\n     #[inline]\n     /// Creates a constant with the given integer value and interns it.\n     pub fn from_bits(tcx: TyCtxt<'tcx>, bits: u128, ty: ParamEnvAnd<'tcx, Ty<'tcx>>) -> Self {\n         let size = tcx\n             .layout_of(ty)\n             .unwrap_or_else(|e| panic!(\"could not compute layout for {:?}: {:?}\", ty, e))\n             .size;\n-        Self::from_scalar_int(tcx, ScalarInt::try_from_uint(bits, size).unwrap(), ty.value)\n+        tcx.mk_const(\n+            ty::ValTree::from_scalar_int(ScalarInt::try_from_uint(bits, size).unwrap()),\n+            ty.value,\n+        )\n     }\n \n     #[inline]"}]}