{"sha": "bcdba777bdc43762cff73ac3ded4ae737a503692", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJjZGJhNzc3YmRjNDM3NjJjZmY3M2FjM2RlZDRhZTczN2E1MDM2OTI=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2019-09-15T07:02:51Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-09-15T07:02:51Z"}, "message": "Merge #1847\n\n1847: Allow an underscore as the identifier in `const` items r=matklad a=ecstatic-morse\n\n[RFC 2526](https://github.com/rust-lang/rust/issues/54912) was recently stabilized, meaning `const _: i32 = 5;` is now a valid item.\n\nCo-authored-by: Dylan MacKenzie <ecstaticmorse@gmail.com>", "tree": {"sha": "e65797200723aeb35afc10acb24a7a7d385d5c2b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e65797200723aeb35afc10acb24a7a7d385d5c2b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bcdba777bdc43762cff73ac3ded4ae737a503692", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdfeIbCRBK7hj4Ov3rIwAAdHIIAHBYzgCWLwL4JC4Jn+aX1C6R\nu0WX8qwz0MgHKtyPAmzYOqVHrWi/H/lL/uVl5HP6SkEg5eqQknvEwbqqp7PrvVlw\nXLbzyvjU225TJljoikyMkA+SCNobpRAuc6ZB8Mrj0EF6FVQMsOHKtd+U6zLAs4Is\nJhNA3yvgM5r69Fap61mXFF229Da8Wu77m6uVFSs00IhE7nVNvNpLg0tDx3m4pDxN\nX0/yvA/TmMCxirFpQT5Y92yM4/mNeikP8jp2qWjE0wbFLVcgu4y5fxnEN5o2631X\n01Zn2WpBNJFYAUgPU5hvBJeKezJoABIKef0ponfyFnsOOlSBaVblGsVqjVx+nrA=\n=XT8y\n-----END PGP SIGNATURE-----\n", "payload": "tree e65797200723aeb35afc10acb24a7a7d385d5c2b\nparent 211171ffe6a4e8cbf31b9513972e59a8b9bdc811\nparent c413f444a02ad7898b7a259e0d7aeaed91fd1997\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1568530971 +0000\ncommitter GitHub <noreply@github.com> 1568530971 +0000\n\nMerge #1847\n\n1847: Allow an underscore as the identifier in `const` items r=matklad a=ecstatic-morse\n\n[RFC 2526](https://github.com/rust-lang/rust/issues/54912) was recently stabilized, meaning `const _: i32 = 5;` is now a valid item.\n\nCo-authored-by: Dylan MacKenzie <ecstaticmorse@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bcdba777bdc43762cff73ac3ded4ae737a503692", "html_url": "https://github.com/rust-lang/rust/commit/bcdba777bdc43762cff73ac3ded4ae737a503692", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bcdba777bdc43762cff73ac3ded4ae737a503692/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "211171ffe6a4e8cbf31b9513972e59a8b9bdc811", "url": "https://api.github.com/repos/rust-lang/rust/commits/211171ffe6a4e8cbf31b9513972e59a8b9bdc811", "html_url": "https://github.com/rust-lang/rust/commit/211171ffe6a4e8cbf31b9513972e59a8b9bdc811"}, {"sha": "c413f444a02ad7898b7a259e0d7aeaed91fd1997", "url": "https://api.github.com/repos/rust-lang/rust/commits/c413f444a02ad7898b7a259e0d7aeaed91fd1997", "html_url": "https://github.com/rust-lang/rust/commit/c413f444a02ad7898b7a259e0d7aeaed91fd1997"}], "stats": {"total": 130, "additions": 90, "deletions": 40}, "files": [{"sha": "4dd80d44314efa7cc0f9e633a23efdfffcb97137", "filename": "crates/ra_parser/src/grammar/items.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bcdba777bdc43762cff73ac3ded4ae737a503692/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcdba777bdc43762cff73ac3ded4ae737a503692/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fitems.rs?ref=bcdba777bdc43762cff73ac3ded4ae737a503692", "patch": "@@ -258,7 +258,7 @@ fn items_without_modifiers(p: &mut Parser, m: Marker) -> Result<(), Marker> {\n         }\n         T![enum] => nominal::enum_def(p, m),\n         T![use] => use_item::use_item(p, m),\n-        T![const] if (la == IDENT || la == T![mut]) => consts::const_def(p, m),\n+        T![const] if (la == IDENT || la == T![_] || la == T![mut]) => consts::const_def(p, m),\n         T![static] => consts::static_def(p, m),\n         // test extern_block\n         // extern {}"}, {"sha": "63e0e6e0c04d0944beafc906d6708f60c4df8920", "filename": "crates/ra_parser/src/grammar/items/consts.rs", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/bcdba777bdc43762cff73ac3ded4ae737a503692/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fitems%2Fconsts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcdba777bdc43762cff73ac3ded4ae737a503692/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fitems%2Fconsts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fitems%2Fconsts.rs?ref=bcdba777bdc43762cff73ac3ded4ae737a503692", "patch": "@@ -12,7 +12,16 @@ fn const_or_static(p: &mut Parser, m: Marker, kw: SyntaxKind, def: SyntaxKind) {\n     assert!(p.at(kw));\n     p.bump_any();\n     p.eat(T![mut]); // FIXME: validator to forbid const mut\n-    name(p);\n+\n+    // Allow `_` in place of an identifier in a `const`.\n+    let is_const_underscore = kw == T![const] && p.eat(T![_]);\n+    if !is_const_underscore {\n+        name(p);\n+    }\n+\n+    // test_err static_underscore\n+    // static _: i32 = 5;\n+\n     types::ascription(p);\n     if p.eat(T![=]) {\n         expressions::expr(p);"}, {"sha": "df8cecb43262bb2f31c7847fffa8572582a2be7c", "filename": "crates/ra_syntax/test_data/parser/inline/err/0013_static_underscore.rs", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/bcdba777bdc43762cff73ac3ded4ae737a503692/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Ferr%2F0013_static_underscore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcdba777bdc43762cff73ac3ded4ae737a503692/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Ferr%2F0013_static_underscore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Ferr%2F0013_static_underscore.rs?ref=bcdba777bdc43762cff73ac3ded4ae737a503692", "patch": "@@ -0,0 +1 @@\n+static _: i32 = 5;"}, {"sha": "28f75a3418c7efc4d4c54fcec076074297479e34", "filename": "crates/ra_syntax/test_data/parser/inline/err/0013_static_underscore.txt", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/bcdba777bdc43762cff73ac3ded4ae737a503692/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Ferr%2F0013_static_underscore.txt", "raw_url": "https://github.com/rust-lang/rust/raw/bcdba777bdc43762cff73ac3ded4ae737a503692/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Ferr%2F0013_static_underscore.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Ferr%2F0013_static_underscore.txt?ref=bcdba777bdc43762cff73ac3ded4ae737a503692", "patch": "@@ -0,0 +1,21 @@\n+SOURCE_FILE@[0; 19)\n+  STATIC_DEF@[0; 18)\n+    STATIC_KW@[0; 6) \"static\"\n+    WHITESPACE@[6; 7) \" \"\n+    ERROR@[7; 8)\n+      UNDERSCORE@[7; 8) \"_\"\n+    COLON@[8; 9) \":\"\n+    WHITESPACE@[9; 10) \" \"\n+    PATH_TYPE@[10; 13)\n+      PATH@[10; 13)\n+        PATH_SEGMENT@[10; 13)\n+          NAME_REF@[10; 13)\n+            IDENT@[10; 13) \"i32\"\n+    WHITESPACE@[13; 14) \" \"\n+    EQ@[14; 15) \"=\"\n+    WHITESPACE@[15; 16) \" \"\n+    LITERAL@[16; 17)\n+      INT_NUMBER@[16; 17) \"5\"\n+    SEMI@[17; 18) \";\"\n+  WHITESPACE@[18; 19) \"\\n\"\n+error 7: expected a name"}, {"sha": "a806a209dc1931c08aba0cf7388873c0320cb739", "filename": "crates/ra_syntax/test_data/parser/ok/0024_const_item.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/bcdba777bdc43762cff73ac3ded4ae737a503692/crates%2Fra_syntax%2Ftest_data%2Fparser%2Fok%2F0024_const_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcdba777bdc43762cff73ac3ded4ae737a503692/crates%2Fra_syntax%2Ftest_data%2Fparser%2Fok%2F0024_const_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Fok%2F0024_const_item.rs?ref=bcdba777bdc43762cff73ac3ded4ae737a503692", "patch": "@@ -1,2 +1,3 @@\n+const _: u32 = 0;\n const FOO: u32 = 92;\n const mut BAR: u32 = 62;"}, {"sha": "abe9f851b60d6a78d4ea4ce6437b0a7807d3d174", "filename": "crates/ra_syntax/test_data/parser/ok/0024_const_item.txt", "status": "modified", "additions": 56, "deletions": 38, "changes": 94, "blob_url": "https://github.com/rust-lang/rust/blob/bcdba777bdc43762cff73ac3ded4ae737a503692/crates%2Fra_syntax%2Ftest_data%2Fparser%2Fok%2F0024_const_item.txt", "raw_url": "https://github.com/rust-lang/rust/raw/bcdba777bdc43762cff73ac3ded4ae737a503692/crates%2Fra_syntax%2Ftest_data%2Fparser%2Fok%2F0024_const_item.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Fok%2F0024_const_item.txt?ref=bcdba777bdc43762cff73ac3ded4ae737a503692", "patch": "@@ -1,41 +1,59 @@\n-SOURCE_FILE@[0; 46)\n-  CONST_DEF@[0; 20)\n+SOURCE_FILE@[0; 64)\n+  CONST_DEF@[0; 17)\n     CONST_KW@[0; 5) \"const\"\n     WHITESPACE@[5; 6) \" \"\n-    NAME@[6; 9)\n-      IDENT@[6; 9) \"FOO\"\n-    COLON@[9; 10) \":\"\n-    WHITESPACE@[10; 11) \" \"\n-    PATH_TYPE@[11; 14)\n-      PATH@[11; 14)\n-        PATH_SEGMENT@[11; 14)\n-          NAME_REF@[11; 14)\n-            IDENT@[11; 14) \"u32\"\n+    UNDERSCORE@[6; 7) \"_\"\n+    COLON@[7; 8) \":\"\n+    WHITESPACE@[8; 9) \" \"\n+    PATH_TYPE@[9; 12)\n+      PATH@[9; 12)\n+        PATH_SEGMENT@[9; 12)\n+          NAME_REF@[9; 12)\n+            IDENT@[9; 12) \"u32\"\n+    WHITESPACE@[12; 13) \" \"\n+    EQ@[13; 14) \"=\"\n     WHITESPACE@[14; 15) \" \"\n-    EQ@[15; 16) \"=\"\n-    WHITESPACE@[16; 17) \" \"\n-    LITERAL@[17; 19)\n-      INT_NUMBER@[17; 19) \"92\"\n-    SEMI@[19; 20) \";\"\n-  WHITESPACE@[20; 21) \"\\n\"\n-  CONST_DEF@[21; 45)\n-    CONST_KW@[21; 26) \"const\"\n-    WHITESPACE@[26; 27) \" \"\n-    MUT_KW@[27; 30) \"mut\"\n-    WHITESPACE@[30; 31) \" \"\n-    NAME@[31; 34)\n-      IDENT@[31; 34) \"BAR\"\n-    COLON@[34; 35) \":\"\n-    WHITESPACE@[35; 36) \" \"\n-    PATH_TYPE@[36; 39)\n-      PATH@[36; 39)\n-        PATH_SEGMENT@[36; 39)\n-          NAME_REF@[36; 39)\n-            IDENT@[36; 39) \"u32\"\n-    WHITESPACE@[39; 40) \" \"\n-    EQ@[40; 41) \"=\"\n-    WHITESPACE@[41; 42) \" \"\n-    LITERAL@[42; 44)\n-      INT_NUMBER@[42; 44) \"62\"\n-    SEMI@[44; 45) \";\"\n-  WHITESPACE@[45; 46) \"\\n\"\n+    LITERAL@[15; 16)\n+      INT_NUMBER@[15; 16) \"0\"\n+    SEMI@[16; 17) \";\"\n+  WHITESPACE@[17; 18) \"\\n\"\n+  CONST_DEF@[18; 38)\n+    CONST_KW@[18; 23) \"const\"\n+    WHITESPACE@[23; 24) \" \"\n+    NAME@[24; 27)\n+      IDENT@[24; 27) \"FOO\"\n+    COLON@[27; 28) \":\"\n+    WHITESPACE@[28; 29) \" \"\n+    PATH_TYPE@[29; 32)\n+      PATH@[29; 32)\n+        PATH_SEGMENT@[29; 32)\n+          NAME_REF@[29; 32)\n+            IDENT@[29; 32) \"u32\"\n+    WHITESPACE@[32; 33) \" \"\n+    EQ@[33; 34) \"=\"\n+    WHITESPACE@[34; 35) \" \"\n+    LITERAL@[35; 37)\n+      INT_NUMBER@[35; 37) \"92\"\n+    SEMI@[37; 38) \";\"\n+  WHITESPACE@[38; 39) \"\\n\"\n+  CONST_DEF@[39; 63)\n+    CONST_KW@[39; 44) \"const\"\n+    WHITESPACE@[44; 45) \" \"\n+    MUT_KW@[45; 48) \"mut\"\n+    WHITESPACE@[48; 49) \" \"\n+    NAME@[49; 52)\n+      IDENT@[49; 52) \"BAR\"\n+    COLON@[52; 53) \":\"\n+    WHITESPACE@[53; 54) \" \"\n+    PATH_TYPE@[54; 57)\n+      PATH@[54; 57)\n+        PATH_SEGMENT@[54; 57)\n+          NAME_REF@[54; 57)\n+            IDENT@[54; 57) \"u32\"\n+    WHITESPACE@[57; 58) \" \"\n+    EQ@[58; 59) \"=\"\n+    WHITESPACE@[59; 60) \" \"\n+    LITERAL@[60; 62)\n+      INT_NUMBER@[60; 62) \"62\"\n+    SEMI@[62; 63) \";\"\n+  WHITESPACE@[63; 64) \"\\n\""}]}