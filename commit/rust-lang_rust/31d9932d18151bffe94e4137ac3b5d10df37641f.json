{"sha": "31d9932d18151bffe94e4137ac3b5d10df37641f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjMxZDk5MzJkMTgxNTFiZmZlOTRlNDEzN2FjM2I1ZDEwZGYzNzY0MWY=", "commit": {"author": {"name": "Veetaha", "email": "gerzoh1@gmail.com", "date": "2020-02-24T22:50:36Z"}, "committer": {"name": "Veetaha", "email": "gerzoh1@gmail.com", "date": "2020-02-24T22:50:36Z"}, "message": "vscode: migrate expand_macro to rust-analyzer-api.ts", "tree": {"sha": "c771d6872eb902c8ffa70461ddca6003b14d875d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c771d6872eb902c8ffa70461ddca6003b14d875d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/31d9932d18151bffe94e4137ac3b5d10df37641f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/31d9932d18151bffe94e4137ac3b5d10df37641f", "html_url": "https://github.com/rust-lang/rust/commit/31d9932d18151bffe94e4137ac3b5d10df37641f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/31d9932d18151bffe94e4137ac3b5d10df37641f/comments", "author": null, "committer": null, "parents": [{"sha": "603bc71a57ce386d78f1b1c842714ff0dbeeaf9c", "url": "https://api.github.com/repos/rust-lang/rust/commits/603bc71a57ce386d78f1b1c842714ff0dbeeaf9c", "html_url": "https://github.com/rust-lang/rust/commit/603bc71a57ce386d78f1b1c842714ff0dbeeaf9c"}], "stats": {"total": 18, "additions": 5, "deletions": 13}, "files": [{"sha": "23f2ef1d5e362c832092e532080c411b577134b8", "filename": "editors/code/src/commands/expand_macro.ts", "status": "modified", "additions": 5, "deletions": 13, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/31d9932d18151bffe94e4137ac3b5d10df37641f/editors%2Fcode%2Fsrc%2Fcommands%2Fexpand_macro.ts", "raw_url": "https://github.com/rust-lang/rust/raw/31d9932d18151bffe94e4137ac3b5d10df37641f/editors%2Fcode%2Fsrc%2Fcommands%2Fexpand_macro.ts", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fsrc%2Fcommands%2Fexpand_macro.ts?ref=31d9932d18151bffe94e4137ac3b5d10df37641f", "patch": "@@ -1,5 +1,5 @@\n import * as vscode from 'vscode';\n-import * as lc from 'vscode-languageclient';\n+import * as ra from '../rust-analyzer-api';\n \n import { Ctx, Cmd } from '../ctx';\n \n@@ -26,12 +26,7 @@ export function expandMacro(ctx: Ctx): Cmd {\n     };\n }\n \n-interface ExpandedMacro {\n-    name: string;\n-    expansion: string;\n-}\n-\n-function codeFormat(expanded: ExpandedMacro): string {\n+function codeFormat(expanded: ra.ExpandedMacro): string {\n     let result = `// Recursive expansion of ${expanded.name}! macro\\n`;\n     result += '// ' + '='.repeat(result.length - 3);\n     result += '\\n\\n';\n@@ -54,14 +49,11 @@ class TextDocumentContentProvider\n         if (!editor || !client) return '';\n \n         const position = editor.selection.active;\n-        const request: lc.TextDocumentPositionParams = {\n+\n+        const expanded = await client.sendRequest(ra.expandMacro, {\n             textDocument: { uri: editor.document.uri.toString() },\n             position,\n-        };\n-        const expanded = await client.sendRequest<ExpandedMacro>(\n-            'rust-analyzer/expandMacro',\n-            request,\n-        );\n+        });\n \n         if (expanded == null) return 'Not available';\n "}]}