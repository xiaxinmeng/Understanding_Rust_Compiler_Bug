{"sha": "d3aa1748461e1220fb26a6e556a78b88a32cc2bd", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQzYWExNzQ4NDYxZTEyMjBmYjI2YTZlNTU2YTc4Yjg4YTMyY2MyYmQ=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-01-30T22:11:35Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-01-31T03:37:32Z"}, "message": "rustdoc: Add definition of iface docs", "tree": {"sha": "9583098f3e15d39ce7f280c3080d215ed5b8a919", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9583098f3e15d39ce7f280c3080d215ed5b8a919"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d3aa1748461e1220fb26a6e556a78b88a32cc2bd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d3aa1748461e1220fb26a6e556a78b88a32cc2bd", "html_url": "https://github.com/rust-lang/rust/commit/d3aa1748461e1220fb26a6e556a78b88a32cc2bd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d3aa1748461e1220fb26a6e556a78b88a32cc2bd/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9db1d16f610cae5611dc07a0b65daef69f435274", "url": "https://api.github.com/repos/rust-lang/rust/commits/9db1d16f610cae5611dc07a0b65daef69f435274", "html_url": "https://github.com/rust-lang/rust/commit/9db1d16f610cae5611dc07a0b65daef69f435274"}], "stats": {"total": 55, "additions": 50, "deletions": 5}, "files": [{"sha": "695ae1c1911363129e92e1509c4ab483803800ba", "filename": "src/rustdoc/doc.rs", "status": "modified", "additions": 30, "deletions": 1, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/d3aa1748461e1220fb26a6e556a78b88a32cc2bd/src%2Frustdoc%2Fdoc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d3aa1748461e1220fb26a6e556a78b88a32cc2bd/src%2Frustdoc%2Fdoc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Fdoc.rs?ref=d3aa1748461e1220fb26a6e556a78b88a32cc2bd", "patch": "@@ -11,7 +11,8 @@ enum itemtag {\n     consttag(constdoc),\n     fntag(fndoc),\n     enumtag(enumdoc),\n-    restag(resdoc)\n+    restag(resdoc),\n+    ifacetag(ifacedoc)\n }\n \n type moddoc = {\n@@ -77,6 +78,24 @@ type resdoc = {\n     sig: option<str>\n };\n \n+type ifacedoc = {\n+    id: ast_id,\n+    name: str,\n+    brief: option<str>,\n+    desc: option<str>,\n+    methods: [methoddoc]\n+};\n+\n+type methoddoc = {\n+    name: str,\n+    brief: option<str>,\n+    desc: option<str>,\n+    args: [argdoc],\n+    return: retdoc,\n+    failure: option<str>,\n+    sig: option<str>\n+};\n+\n impl util for moddoc {\n \n     fn mods() -> [moddoc] {\n@@ -123,6 +142,15 @@ impl util for moddoc {\n             }\n         }\n     }\n+\n+    fn ifaces() -> [ifacedoc] {\n+        vec::filter_map(*self.items) {|itemtag|\n+            alt itemtag {\n+              ifacetag(ifacedoc) { some(ifacedoc) }\n+              _ { none }\n+            }\n+        }\n+    }\n }\n \n impl util for itemtag {\n@@ -133,6 +161,7 @@ impl util for itemtag {\n           doc::consttag({name, _}) { name }\n           doc::enumtag({name, _}) { name }\n           doc::restag({name, _}) { name }\n+          doc::ifacetag({name, _}) { name }\n         }\n     }\n }"}, {"sha": "6851299db87dca1bc7b191538866aa6ece5930e3", "filename": "src/rustdoc/fold.rs", "status": "modified", "additions": 20, "deletions": 4, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/d3aa1748461e1220fb26a6e556a78b88a32cc2bd/src%2Frustdoc%2Ffold.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d3aa1748461e1220fb26a6e556a78b88a32cc2bd/src%2Frustdoc%2Ffold.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Ffold.rs?ref=d3aa1748461e1220fb26a6e556a78b88a32cc2bd", "patch": "@@ -10,6 +10,7 @@ export default_seq_fold_fn;\n export default_seq_fold_const;\n export default_seq_fold_enum;\n export default_seq_fold_res;\n+export default_seq_fold_iface;\n \n enum fold<T> = t<T>;\n \n@@ -19,6 +20,7 @@ type fold_fn<T> = fn~(fold: fold<T>, doc: doc::fndoc) -> doc::fndoc;\n type fold_const<T> = fn~(fold: fold<T>, doc: doc::constdoc) -> doc::constdoc;\n type fold_enum<T> = fn~(fold: fold<T>, doc: doc::enumdoc) -> doc::enumdoc;\n type fold_res<T> = fn~(fold: fold<T>, doc: doc::resdoc) -> doc::resdoc;\n+type fold_iface<T> = fn~(fold: fold<T>, doc: doc::ifacedoc) -> doc::ifacedoc;\n \n type t<T> = {\n     ctxt: T,\n@@ -27,7 +29,8 @@ type t<T> = {\n     fold_fn: fold_fn<T>,\n     fold_const: fold_const<T>,\n     fold_enum: fold_enum<T>,\n-    fold_res: fold_res<T>\n+    fold_res: fold_res<T>,\n+    fold_iface: fold_iface<T>\n };\n \n \n@@ -40,7 +43,8 @@ fn mk_fold<T:copy>(\n     fold_fn: fold_fn<T>,\n     fold_const: fold_const<T>,\n     fold_enum: fold_enum<T>,\n-    fold_res: fold_res<T>\n+    fold_res: fold_res<T>,\n+    fold_iface: fold_iface<T>\n ) -> fold<T> {\n     fold({\n         ctxt: ctxt,\n@@ -49,7 +53,8 @@ fn mk_fold<T:copy>(\n         fold_fn: fold_fn,\n         fold_const: fold_const,\n         fold_enum: fold_enum,\n-        fold_res: fold_res\n+        fold_res: fold_res,\n+        fold_iface: fold_iface\n     })\n }\n \n@@ -61,7 +66,8 @@ fn default_seq_fold<T:copy>(ctxt: T) -> fold<T> {\n         {|f, d| default_seq_fold_fn(f, d)},\n         {|f, d| default_seq_fold_const(f, d)},\n         {|f, d| default_seq_fold_enum(f, d)},\n-        {|f, d| default_seq_fold_res(f, d)}\n+        {|f, d| default_seq_fold_res(f, d)},\n+        {|f, d| default_seq_fold_iface(f, d)}\n     )\n }\n \n@@ -96,6 +102,9 @@ fn default_seq_fold_mod<T>(\n               doc::restag(resdoc) {\n                 doc::restag(fold.fold_res(fold, resdoc))\n               }\n+              doc::ifacetag(ifacedoc) {\n+                doc::ifacetag(fold.fold_iface(fold, ifacedoc))\n+              }\n             }\n         }\n         with doc\n@@ -130,6 +139,13 @@ fn default_seq_fold_res<T>(\n     doc\n }\n \n+fn default_seq_fold_iface<T>(\n+    _fold: fold<T>,\n+    doc: doc::ifacedoc\n+) -> doc::ifacedoc {\n+    doc\n+}\n+\n #[test]\n fn default_fold_should_produce_same_doc() {\n     let source = \"mod a { fn b() { } mod c { fn d() { } } }\";"}]}