{"sha": "cf5eaa75bb171f00d6baa475333b741b86f93f72", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNmNWVhYTc1YmIxNzFmMDBkNmJhYTQ3NTMzM2I3NDFiODZmOTNmNzI=", "commit": {"author": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2018-07-04T20:05:43Z"}, "committer": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2018-07-04T21:36:07Z"}, "message": "Move `Eq + Hash + Clone` bounds to `Machine`", "tree": {"sha": "a59313f9d783d9886c598d88aa6e0628fd515414", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a59313f9d783d9886c598d88aa6e0628fd515414"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cf5eaa75bb171f00d6baa475333b741b86f93f72", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cf5eaa75bb171f00d6baa475333b741b86f93f72", "html_url": "https://github.com/rust-lang/rust/commit/cf5eaa75bb171f00d6baa475333b741b86f93f72", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cf5eaa75bb171f00d6baa475333b741b86f93f72/comments", "author": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c395044a5002a9c275b92bc8e0bc54da245fa8b1", "url": "https://api.github.com/repos/rust-lang/rust/commits/c395044a5002a9c275b92bc8e0bc54da245fa8b1", "html_url": "https://github.com/rust-lang/rust/commit/c395044a5002a9c275b92bc8e0bc54da245fa8b1"}], "stats": {"total": 20, "additions": 6, "deletions": 14}, "files": [{"sha": "a92c81e046a0ffd9f01d650d54875ab30191c272", "filename": "src/librustc_mir/interpret/eval_context.rs", "status": "modified", "additions": 4, "deletions": 8, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/cf5eaa75bb171f00d6baa475333b741b86f93f72/src%2Flibrustc_mir%2Finterpret%2Feval_context.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf5eaa75bb171f00d6baa475333b741b86f93f72/src%2Flibrustc_mir%2Finterpret%2Feval_context.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Feval_context.rs?ref=cf5eaa75bb171f00d6baa475333b741b86f93f72", "patch": "@@ -163,7 +163,7 @@ pub(crate) struct InfiniteLoopDetector<'a, 'mir, 'tcx: 'a + 'mir, M: Machine<'mi\n }\n \n impl<'a, 'mir, 'tcx, M> Default for InfiniteLoopDetector<'a, 'mir, 'tcx, M>\n-    where M: Eq + Hash + Machine<'mir, 'tcx>,\n+    where M: Machine<'mir, 'tcx>,\n           'tcx: 'a + 'mir,\n {\n     fn default() -> Self {\n@@ -175,7 +175,7 @@ impl<'a, 'mir, 'tcx, M> Default for InfiniteLoopDetector<'a, 'mir, 'tcx, M>\n }\n \n impl<'a, 'mir, 'tcx, M> InfiniteLoopDetector<'a, 'mir, 'tcx, M>\n-    where M: Clone + Eq + Hash + Machine<'mir, 'tcx>,\n+    where M: Machine<'mir, 'tcx>,\n           'tcx: 'a + 'mir,\n {\n     /// Returns `true` if the loop detector has not yet observed a snapshot.\n@@ -302,9 +302,7 @@ impl<'a, 'mir, 'tcx: 'mir, M: Machine<'mir, 'tcx>> EvalContext<'a, 'mir, 'tcx, M\n         param_env: ty::ParamEnv<'tcx>,\n         machine: M,\n         memory_data: M::MemoryData,\n-    ) -> Self\n-        where M: Eq + Hash\n-    {\n+    ) -> Self {\n         EvalContext {\n             machine,\n             tcx,\n@@ -612,9 +610,7 @@ impl<'a, 'mir, 'tcx: 'mir, M: Machine<'mir, 'tcx>> EvalContext<'a, 'mir, 'tcx, M\n         &mut self,\n         rvalue: &mir::Rvalue<'tcx>,\n         place: &mir::Place<'tcx>,\n-    ) -> EvalResult<'tcx>\n-        where M: Clone + Eq + Hash,\n-    {\n+    ) -> EvalResult<'tcx> {\n         let dest = self.eval_place(place)?;\n         let dest_ty = self.place_ty(place);\n "}, {"sha": "e2086c57c7c7c5ee53da4097bda0f93610809dac", "filename": "src/librustc_mir/interpret/machine.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cf5eaa75bb171f00d6baa475333b741b86f93f72/src%2Flibrustc_mir%2Finterpret%2Fmachine.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf5eaa75bb171f00d6baa475333b741b86f93f72/src%2Flibrustc_mir%2Finterpret%2Fmachine.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Fmachine.rs?ref=cf5eaa75bb171f00d6baa475333b741b86f93f72", "patch": "@@ -15,7 +15,7 @@ use syntax::ast::Mutability;\n \n /// Methods of this trait signifies a point where CTFE evaluation would fail\n /// and some use case dependent behaviour can instead be applied\n-pub trait Machine<'mir, 'tcx>: Sized {\n+pub trait Machine<'mir, 'tcx>: Clone + Eq + Hash {\n     /// Additional data that can be accessed via the Memory\n     type MemoryData: Clone + Eq + Hash;\n "}, {"sha": "db90714d0e6231d7b747fa142f8c6e21d112ac00", "filename": "src/librustc_mir/interpret/step.rs", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cf5eaa75bb171f00d6baa475333b741b86f93f72/src%2Flibrustc_mir%2Finterpret%2Fstep.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cf5eaa75bb171f00d6baa475333b741b86f93f72/src%2Flibrustc_mir%2Finterpret%2Fstep.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Fstep.rs?ref=cf5eaa75bb171f00d6baa475333b741b86f93f72", "patch": "@@ -2,16 +2,12 @@\n //!\n //! The main entry point is the `step` method.\n \n-use std::hash::Hash;\n-\n use rustc::mir;\n \n use rustc::mir::interpret::EvalResult;\n use super::{EvalContext, Machine};\n \n-impl<'a, 'mir, 'tcx, M: Machine<'mir, 'tcx>> EvalContext<'a, 'mir, 'tcx, M>\n-    where M: Clone + Eq + Hash,\n-{\n+impl<'a, 'mir, 'tcx, M: Machine<'mir, 'tcx>> EvalContext<'a, 'mir, 'tcx, M> {\n     pub fn inc_step_counter_and_detect_loops(&mut self) -> EvalResult<'tcx, ()> {\n         /// The number of steps between loop detector snapshots.\n         /// Should be a power of two for performance reasons."}]}