{"sha": "80bd17643234239ea556e25a8ff56c2164eb6313", "node_id": "MDY6Q29tbWl0NzI0NzEyOjgwYmQxNzY0MzIzNDIzOWVhNTU2ZTI1YThmZjU2YzIxNjRlYjYzMTM=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-04-19T20:18:25Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-04-19T20:18:25Z"}, "message": "mk: Pass exact compile to rustc on cross compiles\n\nInstead of passing through CC which may have things like ccache and other\narguments (when using clang) this commit filters out the necessary arguments\nfrom CC to pass the right linker to rustc.\n\nCloses #13562", "tree": {"sha": "f891b866600e1a4c423896555129bb824ccca43d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f891b866600e1a4c423896555129bb824ccca43d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/80bd17643234239ea556e25a8ff56c2164eb6313", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/80bd17643234239ea556e25a8ff56c2164eb6313", "html_url": "https://github.com/rust-lang/rust/commit/80bd17643234239ea556e25a8ff56c2164eb6313", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/80bd17643234239ea556e25a8ff56c2164eb6313/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ba25fecfeffdbc96d31172f483bd20cffa635b3e", "url": "https://api.github.com/repos/rust-lang/rust/commits/ba25fecfeffdbc96d31172f483bd20cffa635b3e", "html_url": "https://github.com/rust-lang/rust/commit/ba25fecfeffdbc96d31172f483bd20cffa635b3e"}], "stats": {"total": 5, "additions": 4, "deletions": 1}, "files": [{"sha": "56864f585f2fe6ad58e338b8a5718302dd49d454", "filename": "mk/platform.mk", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/80bd17643234239ea556e25a8ff56c2164eb6313/mk%2Fplatform.mk", "raw_url": "https://github.com/rust-lang/rust/raw/80bd17643234239ea556e25a8ff56c2164eb6313/mk%2Fplatform.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fplatform.mk?ref=80bd17643234239ea556e25a8ff56c2164eb6313", "patch": "@@ -542,14 +542,17 @@ ifdef CFG_CCACHE_BASEDIR\n   export CCACHE_BASEDIR\n endif\n \n+FIND_COMPILER = $(word 1,$(1:ccache=))\n+\n define CFG_MAKE_TOOLCHAIN\n   # Prepend the tools with their prefix if cross compiling\n   ifneq ($(CFG_BUILD),$(1))\n \tCC_$(1)=$(CROSS_PREFIX_$(1))$(CC_$(1))\n \tCXX_$(1)=$(CROSS_PREFIX_$(1))$(CXX_$(1))\n \tCPP_$(1)=$(CROSS_PREFIX_$(1))$(CPP_$(1))\n \tAR_$(1)=$(CROSS_PREFIX_$(1))$(AR_$(1))\n-\tRUSTC_CROSS_FLAGS_$(1)=-C linker=$$(CXX_$(1)) -C ar=$$(AR_$(1)) $(RUSTC_CROSS_FLAGS_$(1))\n+\tRUSTC_CROSS_FLAGS_$(1)=-C linker=$$(call FIND_COMPILER,$$(CXX_$(1))) \\\n+\t    -C ar=$$(call FIND_COMPILER,$$(AR_$(1))) $(RUSTC_CROSS_FLAGS_$(1))\n \n \tRUSTC_FLAGS_$(1)=$$(RUSTC_CROSS_FLAGS_$(1)) $(RUSTC_FLAGS_$(1))\n   endif"}]}