{"sha": "2b50cd18772d3db523070d418dc0411b885a3ff4", "node_id": "C_kwDOAAsO6NoAKDJiNTBjZDE4NzcyZDNkYjUyMzA3MGQ0MThkYzA0MTFiODg1YTNmZjQ", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-10-06T10:33:29Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-10-11T20:47:31Z"}, "message": "rename rustc_allocator_nounwind to rustc_nounwind", "tree": {"sha": "d7f1d8f99c343eef5f23e23a4441a26bd2d8ca01", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d7f1d8f99c343eef5f23e23a4441a26bd2d8ca01"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2b50cd18772d3db523070d418dc0411b885a3ff4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2b50cd18772d3db523070d418dc0411b885a3ff4", "html_url": "https://github.com/rust-lang/rust/commit/2b50cd18772d3db523070d418dc0411b885a3ff4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2b50cd18772d3db523070d418dc0411b885a3ff4/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "db0597f5619d5ed93feca28e61226d3581cc7867", "url": "https://api.github.com/repos/rust-lang/rust/commits/db0597f5619d5ed93feca28e61226d3581cc7867", "html_url": "https://github.com/rust-lang/rust/commit/db0597f5619d5ed93feca28e61226d3581cc7867"}], "stats": {"total": 24, "additions": 14, "deletions": 10}, "files": [{"sha": "92d0fb1aec83f4aebf733385de9cfdcfadb26e07", "filename": "compiler/rustc_feature/src/builtin_attrs.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2b50cd18772d3db523070d418dc0411b885a3ff4/compiler%2Frustc_feature%2Fsrc%2Fbuiltin_attrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2b50cd18772d3db523070d418dc0411b885a3ff4/compiler%2Frustc_feature%2Fsrc%2Fbuiltin_attrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Fbuiltin_attrs.rs?ref=2b50cd18772d3db523070d418dc0411b885a3ff4", "patch": "@@ -536,7 +536,7 @@ pub const BUILTIN_ATTRIBUTES: &[BuiltinAttribute] = &[\n     // ==========================================================================\n \n     rustc_attr!(rustc_allocator, Normal, template!(Word), WarnFollowing, IMPL_DETAIL),\n-    rustc_attr!(rustc_allocator_nounwind, Normal, template!(Word), WarnFollowing, IMPL_DETAIL),\n+    rustc_attr!(rustc_nounwind, Normal, template!(Word), WarnFollowing, IMPL_DETAIL),\n     rustc_attr!(rustc_reallocator, Normal, template!(Word), WarnFollowing, IMPL_DETAIL),\n     rustc_attr!(rustc_deallocator, Normal, template!(Word), WarnFollowing, IMPL_DETAIL),\n     rustc_attr!(rustc_allocator_zeroed, Normal, template!(Word), WarnFollowing, IMPL_DETAIL),"}, {"sha": "cf7fde2a0901a9b84dbe0bfbd397007e8e263aae", "filename": "compiler/rustc_hir_analysis/src/collect.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2b50cd18772d3db523070d418dc0411b885a3ff4/compiler%2Frustc_hir_analysis%2Fsrc%2Fcollect.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2b50cd18772d3db523070d418dc0411b885a3ff4/compiler%2Frustc_hir_analysis%2Fsrc%2Fcollect.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_analysis%2Fsrc%2Fcollect.rs?ref=2b50cd18772d3db523070d418dc0411b885a3ff4", "patch": "@@ -1649,7 +1649,7 @@ fn codegen_fn_attrs(tcx: TyCtxt<'_>, did: DefId) -> CodegenFnAttrs {\n                 )\n                 .emit();\n             }\n-        } else if attr.has_name(sym::rustc_allocator_nounwind) {\n+        } else if attr.has_name(sym::rustc_nounwind) {\n             codegen_fn_attrs.flags |= CodegenFnAttrFlags::NEVER_UNWIND;\n         } else if attr.has_name(sym::rustc_reallocator) {\n             codegen_fn_attrs.flags |= CodegenFnAttrFlags::REALLOCATOR;"}, {"sha": "c6711b603b6839ae06cf4d9744619dd53352bdc4", "filename": "compiler/rustc_span/src/symbol.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2b50cd18772d3db523070d418dc0411b885a3ff4/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2b50cd18772d3db523070d418dc0411b885a3ff4/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs?ref=2b50cd18772d3db523070d418dc0411b885a3ff4", "patch": "@@ -1231,7 +1231,6 @@ symbols! {\n         rust_oom,\n         rustc,\n         rustc_allocator,\n-        rustc_allocator_nounwind,\n         rustc_allocator_zeroed,\n         rustc_allow_const_fn_unstable,\n         rustc_allow_incoherent_impl,\n@@ -1278,6 +1277,7 @@ symbols! {\n         rustc_mir,\n         rustc_must_implement_one_of,\n         rustc_nonnull_optimization_guaranteed,\n+        rustc_nounwind,\n         rustc_object_lifetime_default,\n         rustc_on_unimplemented,\n         rustc_outlives,"}, {"sha": "8187517ccfbb4bac946e740e45b89bbbb90b47f1", "filename": "library/alloc/src/alloc.rs", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/2b50cd18772d3db523070d418dc0411b885a3ff4/library%2Falloc%2Fsrc%2Falloc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2b50cd18772d3db523070d418dc0411b885a3ff4/library%2Falloc%2Fsrc%2Falloc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Falloc.rs?ref=2b50cd18772d3db523070d418dc0411b885a3ff4", "patch": "@@ -28,16 +28,20 @@ extern \"Rust\" {\n     // The rustc fork of LLVM 14 and earlier also special-cases these function names to be able to optimize them\n     // like `malloc`, `realloc`, and `free`, respectively.\n     #[rustc_allocator]\n-    #[rustc_allocator_nounwind]\n+    #[cfg_attr(not(bootstrap), rustc_nounwind)]\n+    #[cfg_attr(bootstrap, rustc_allocator_nounwind)]\n     fn __rust_alloc(size: usize, align: usize) -> *mut u8;\n     #[rustc_deallocator]\n-    #[rustc_allocator_nounwind]\n+    #[cfg_attr(not(bootstrap), rustc_nounwind)]\n+    #[cfg_attr(bootstrap, rustc_allocator_nounwind)]\n     fn __rust_dealloc(ptr: *mut u8, size: usize, align: usize);\n     #[rustc_reallocator]\n-    #[rustc_allocator_nounwind]\n+    #[cfg_attr(not(bootstrap), rustc_nounwind)]\n+    #[cfg_attr(bootstrap, rustc_allocator_nounwind)]\n     fn __rust_realloc(ptr: *mut u8, old_size: usize, align: usize, new_size: usize) -> *mut u8;\n     #[rustc_allocator_zeroed]\n-    #[rustc_allocator_nounwind]\n+    #[cfg_attr(not(bootstrap), rustc_nounwind)]\n+    #[cfg_attr(bootstrap, rustc_allocator_nounwind)]\n     fn __rust_alloc_zeroed(size: usize, align: usize) -> *mut u8;\n }\n "}, {"sha": "f85ad5ae5072fb3619b9668739bc3d7313489124", "filename": "src/tools/miri/tests/fail/function_calls/exported_symbol_bad_unwind2.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2b50cd18772d3db523070d418dc0411b885a3ff4/src%2Ftools%2Fmiri%2Ftests%2Ffail%2Ffunction_calls%2Fexported_symbol_bad_unwind2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2b50cd18772d3db523070d418dc0411b885a3ff4/src%2Ftools%2Fmiri%2Ftests%2Ffail%2Ffunction_calls%2Fexported_symbol_bad_unwind2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiri%2Ftests%2Ffail%2Ffunction_calls%2Fexported_symbol_bad_unwind2.rs?ref=2b50cd18772d3db523070d418dc0411b885a3ff4", "patch": "@@ -1,7 +1,7 @@\n //@revisions: extern_block definition both\n #![feature(rustc_attrs, c_unwind)]\n \n-#[cfg_attr(any(definition, both), rustc_allocator_nounwind)]\n+#[cfg_attr(any(definition, both), rustc_nounwind)]\n #[no_mangle]\n extern \"C-unwind\" fn nounwind() {\n     //[definition]~^ ERROR: abnormal termination: the program aborted execution\n@@ -11,7 +11,7 @@ extern \"C-unwind\" fn nounwind() {\n \n fn main() {\n     extern \"C-unwind\" {\n-        #[cfg_attr(any(extern_block, both), rustc_allocator_nounwind)]\n+        #[cfg_attr(any(extern_block, both), rustc_nounwind)]\n         fn nounwind();\n     }\n     unsafe { nounwind() }"}, {"sha": "39581b33a8da2b7a3b5387de6ee50333d7b0e634", "filename": "src/tools/rust-analyzer/crates/hir-def/src/builtin_attr.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2b50cd18772d3db523070d418dc0411b885a3ff4/src%2Ftools%2Frust-analyzer%2Fcrates%2Fhir-def%2Fsrc%2Fbuiltin_attr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2b50cd18772d3db523070d418dc0411b885a3ff4/src%2Ftools%2Frust-analyzer%2Fcrates%2Fhir-def%2Fsrc%2Fbuiltin_attr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frust-analyzer%2Fcrates%2Fhir-def%2Fsrc%2Fbuiltin_attr.rs?ref=2b50cd18772d3db523070d418dc0411b885a3ff4", "patch": "@@ -379,7 +379,7 @@ pub const INERT_ATTRIBUTES: &[BuiltinAttribute] = &[\n     // ==========================================================================\n \n     rustc_attr!(rustc_allocator, Normal, template!(Word), WarnFollowing, IMPL_DETAIL),\n-    rustc_attr!(rustc_allocator_nounwind, Normal, template!(Word), WarnFollowing, IMPL_DETAIL),\n+    rustc_attr!(rustc_nounwind, Normal, template!(Word), WarnFollowing, IMPL_DETAIL),\n     gated!(\n         alloc_error_handler, Normal, template!(Word), WarnFollowing,\n         experimental!(alloc_error_handler)"}]}