{"sha": "b3e44029cf0c2a43a6326666fa8e0d7c60ac5000", "node_id": "C_kwDOAAsO6NoAKGIzZTQ0MDI5Y2YwYzJhNDNhNjMyNjY2NmZhOGUwZDdjNjBhYzUwMDA", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-11-26T13:53:27Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-11-26T13:53:27Z"}, "message": "Auto merge of #2695 - RalfJung:ci-pretty, r=RalfJung\n\nprettify our CI logs", "tree": {"sha": "39caffc88a4235eef1cf76915141fb8ffc980a3e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/39caffc88a4235eef1cf76915141fb8ffc980a3e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b3e44029cf0c2a43a6326666fa8e0d7c60ac5000", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b3e44029cf0c2a43a6326666fa8e0d7c60ac5000", "html_url": "https://github.com/rust-lang/rust/commit/b3e44029cf0c2a43a6326666fa8e0d7c60ac5000", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b3e44029cf0c2a43a6326666fa8e0d7c60ac5000/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4d3e565004eeef0d01a57007577dd96cfb9bf208", "url": "https://api.github.com/repos/rust-lang/rust/commits/4d3e565004eeef0d01a57007577dd96cfb9bf208", "html_url": "https://github.com/rust-lang/rust/commit/4d3e565004eeef0d01a57007577dd96cfb9bf208"}, {"sha": "56a1d07cb7b78cadf7f8b260c1035bc48e33a17d", "url": "https://api.github.com/repos/rust-lang/rust/commits/56a1d07cb7b78cadf7f8b260c1035bc48e33a17d", "html_url": "https://github.com/rust-lang/rust/commit/56a1d07cb7b78cadf7f8b260c1035bc48e33a17d"}], "stats": {"total": 29, "additions": 22, "deletions": 7}, "files": [{"sha": "01925e39da9f7283af70bc571009a8f1ee6bb3c2", "filename": "src/tools/miri/ci.sh", "status": "modified", "additions": 22, "deletions": 7, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/b3e44029cf0c2a43a6326666fa8e0d7c60ac5000/src%2Ftools%2Fmiri%2Fci.sh", "raw_url": "https://github.com/rust-lang/rust/raw/b3e44029cf0c2a43a6326666fa8e0d7c60ac5000/src%2Ftools%2Fmiri%2Fci.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiri%2Fci.sh?ref=b3e44029cf0c2a43a6326666fa8e0d7c60ac5000", "patch": "@@ -1,6 +1,17 @@\n #!/bin/bash\n set -euo pipefail\n-set -x\n+\n+function begingroup {\n+  echo \"::group::$1\"\n+  set -x\n+}\n+\n+function endgroup {\n+  set +x\n+  echo \"::endgroup\"\n+}\n+\n+begingroup \"Building Miri\"\n \n # Determine configuration for installed build\n echo \"Installing release version of Miri\"\n@@ -14,14 +25,15 @@ export CARGO_EXTRA_FLAGS=\"--locked\"\n ./miri check --no-default-features # make sure this can be built\n ./miri check --all-features # and this, too\n ./miri build --all-targets # the build that all the `./miri test` below will use\n-echo\n+\n+endgroup\n \n # Test\n function run_tests {\n   if [ -n \"${MIRI_TEST_TARGET+exists}\" ]; then\n-    echo \"Testing foreign architecture $MIRI_TEST_TARGET\"\n+    begingroup \"Testing foreign architecture $MIRI_TEST_TARGET\"\n   else\n-    echo \"Testing host architecture\"\n+    begingroup \"Testing host architecture\"\n   fi\n \n   ## ui test suite\n@@ -52,7 +64,6 @@ function run_tests {\n   echo 'build.rustc-wrapper = \"thisdoesnotexist\"' > .cargo/config.toml\n   # Run the actual test\n   ${PYTHON} test-cargo-miri/run-test.py\n-  echo\n   # Clean up\n   unset RUSTC MIRI\n   rm -rf .cargo\n@@ -63,20 +74,24 @@ function run_tests {\n       cargo miri run --manifest-path bench-cargo-miri/$BENCH/Cargo.toml\n     done\n   fi\n+\n+  endgroup\n }\n \n function run_tests_minimal {\n   if [ -n \"${MIRI_TEST_TARGET+exists}\" ]; then\n-    echo \"Testing MINIMAL foreign architecture $MIRI_TEST_TARGET: only testing $@\"\n+    begingroup \"Testing MINIMAL foreign architecture $MIRI_TEST_TARGET: only testing $@\"\n   else\n-    echo \"Testing MINIMAL host architecture: only testing $@\"\n+    begingroup \"Testing MINIMAL host architecture: only testing $@\"\n   fi\n \n   ./miri test -- \"$@\"\n \n   # Ensure that a small smoke test of cargo-miri works.\n   # Note: This doesn't work on windows because of TLS.\n   cargo miri run --manifest-path test-cargo-miri/no-std-smoke/Cargo.toml\n+\n+  endgroup\n }\n \n # host"}]}