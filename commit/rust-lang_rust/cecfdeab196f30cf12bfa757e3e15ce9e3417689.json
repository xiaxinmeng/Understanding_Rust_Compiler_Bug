{"sha": "cecfdeab196f30cf12bfa757e3e15ce9e3417689", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNlY2ZkZWFiMTk2ZjMwY2YxMmJmYTc1N2UzZTE1Y2U5ZTM0MTc2ODk=", "commit": {"author": {"name": "flip1995", "email": "uwdkn@student.kit.edu", "date": "2018-04-03T14:41:30Z"}, "committer": {"name": "flip1995", "email": "uwdkn@student.kit.edu", "date": "2018-04-03T14:41:30Z"}, "message": "Don't trigger while_immutable_condition for mutable fields of tuples/structs", "tree": {"sha": "4c51b18f524e1023d082afe92920c93c5a2cefe5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4c51b18f524e1023d082afe92920c93c5a2cefe5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cecfdeab196f30cf12bfa757e3e15ce9e3417689", "comment_count": 0, "verification": {"verified": false, "reason": "unverified_email", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz66kzxK9mXB0K2lyZ1erJvcvAIQFAlrDkpoACgkQZ1erJvcv\nAIRSbQ//b51fyZ5id6gqh70+4zudvkpBMDytWa2kDDI4OB43m0XKskdfatapToHt\njSj36E8r+WjADH9Rc8DjTxip66AS8x1+cGiivBS2vNj+98flOMYpT+uE6BAePWNo\nNljuKqah0J1jiyY2nRrDywBMbY7QX5MXKN28ZtHLE9eaOmhvjKQmd6hnEKiK26m1\n8a4zDC0w5pKy/lMjqmplymSwDOlxL4l7tB+Ia7qxS6sMkQFaWUlF0cFd3epnorJP\nngtIgX0VE9sYOcjidKqO61+qLPpsiEFy/Zvx5YNWL4sq48XUKMpecU+tPByUgFu+\nJrrwJDDuXsVQDAnYUaOXDVfFWhVf4b9PvdR7r8JpiXO61OGywx3MKWheUA0/Lq6r\naTcspj6B8Pyr/COfv2T2zktMl3G8FETi2/+uomHdoNLAkOBpFkwwYsEzHeKjjYtR\nhTSXFrJcUzklQdwhowtAnsxSYR2xyZRVPOYBrkw20WhWxsXSS1tD7qkEZUaWM0qb\ncw8EwygxxhSV7tOy2WqEIVxYescjaXU7mi8Xtm8z7YsoraGgAHU+URRbbnj6a1VE\nnNcSBysjW+6ysJ5KAIF1XrGXlUf09xu77F8vrGkjlLYp+0xOxuWquNTL9IEYyGP/\n/goU3F8Nw681r6c3FhJHrLSEfGlfY069rd5XhxYOIDA3KGuvw3g=\n=+WEJ\n-----END PGP SIGNATURE-----", "payload": "tree 4c51b18f524e1023d082afe92920c93c5a2cefe5\nparent b7f5871aa04f7164c00dad43913c8e17f95c3fe6\nauthor flip1995 <uwdkn@student.kit.edu> 1522766490 +0200\ncommitter flip1995 <uwdkn@student.kit.edu> 1522766490 +0200\n\nDon't trigger while_immutable_condition for mutable fields of tuples/structs\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cecfdeab196f30cf12bfa757e3e15ce9e3417689", "html_url": "https://github.com/rust-lang/rust/commit/cecfdeab196f30cf12bfa757e3e15ce9e3417689", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cecfdeab196f30cf12bfa757e3e15ce9e3417689/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b7f5871aa04f7164c00dad43913c8e17f95c3fe6", "url": "https://api.github.com/repos/rust-lang/rust/commits/b7f5871aa04f7164c00dad43913c8e17f95c3fe6", "html_url": "https://github.com/rust-lang/rust/commit/b7f5871aa04f7164c00dad43913c8e17f95c3fe6"}], "stats": {"total": 42, "additions": 24, "deletions": 18}, "files": [{"sha": "9a6b7627b475285a2adfe1e2a8cf3b0dfbf6b2cb", "filename": "clippy_lints/src/loops.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/cecfdeab196f30cf12bfa757e3e15ce9e3417689/clippy_lints%2Fsrc%2Floops.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cecfdeab196f30cf12bfa757e3e15ce9e3417689/clippy_lints%2Fsrc%2Floops.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Floops.rs?ref=cecfdeab196f30cf12bfa757e3e15ce9e3417689", "patch": "@@ -2237,7 +2237,7 @@ struct MutVarsDelegate {\n }\n \n impl<'tcx> MutVarsDelegate {\n-    fn update(&mut self, cat: &'tcx Categorization, sp: Span) {\n+    fn update(&mut self, cat: &'tcx Categorization) {\n         match *cat {\n             Categorization::Local(id) =>\n                 if let Some(used) = self.used_mutably.get_mut(&id) {\n@@ -2249,7 +2249,7 @@ impl<'tcx> MutVarsDelegate {\n                 //`while`-body, not just the ones in the condition.\n                 self.skip = true\n             },\n-            Categorization::Deref(ref cmt, _) => self.update(&cmt.cat, sp),\n+            Categorization::Deref(ref cmt, _) | Categorization::Interior(ref cmt, _) => self.update(&cmt.cat),\n             _ => {}\n         }\n     }\n@@ -2263,14 +2263,14 @@ impl<'tcx> Delegate<'tcx> for MutVarsDelegate {\n \n     fn consume_pat(&mut self, _: &Pat, _: cmt<'tcx>, _: ConsumeMode) {}\n \n-    fn borrow(&mut self, _: NodeId, sp: Span, cmt: cmt<'tcx>, _: ty::Region, bk: ty::BorrowKind, _: LoanCause) {\n+    fn borrow(&mut self, _: NodeId, _: Span, cmt: cmt<'tcx>, _: ty::Region, bk: ty::BorrowKind, _: LoanCause) {\n         if let ty::BorrowKind::MutBorrow = bk {\n-            self.update(&cmt.cat, sp)\n+            self.update(&cmt.cat)\n         }\n     }\n \n-    fn mutate(&mut self, _: NodeId, sp: Span, cmt: cmt<'tcx>, _: MutateMode) {\n-        self.update(&cmt.cat, sp)\n+    fn mutate(&mut self, _: NodeId, _: Span, cmt: cmt<'tcx>, _: MutateMode) {\n+        self.update(&cmt.cat)\n     }\n \n     fn decl_without_init(&mut self, _: NodeId, _: Span) {}"}, {"sha": "353d34134eb60bd18753d81de07fd687f0731fca", "filename": "tests/ui/infinite_loop.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cecfdeab196f30cf12bfa757e3e15ce9e3417689/tests%2Fui%2Finfinite_loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cecfdeab196f30cf12bfa757e3e15ce9e3417689/tests%2Fui%2Finfinite_loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Finfinite_loop.rs?ref=cecfdeab196f30cf12bfa757e3e15ce9e3417689", "patch": "@@ -55,6 +55,12 @@ fn immutable_condition() {\n         }\n     };\n     c();\n+\n+    let mut tup = (0, 0);\n+    while tup.0 < 5 {\n+        tup.0 += 1;\n+        println!(\"OK - tup.0 gets mutated\")\n+    }\n }\n \n fn unused_var() {"}, {"sha": "26ec9582fb403e73c6e2ec4bdd05804bd8a6443f", "filename": "tests/ui/infinite_loop.stderr", "status": "modified", "additions": 12, "deletions": 12, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/cecfdeab196f30cf12bfa757e3e15ce9e3417689/tests%2Fui%2Finfinite_loop.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cecfdeab196f30cf12bfa757e3e15ce9e3417689/tests%2Fui%2Finfinite_loop.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Finfinite_loop.stderr?ref=cecfdeab196f30cf12bfa757e3e15ce9e3417689", "patch": "@@ -19,39 +19,39 @@ error: Variable in the condition are not mutated in the loop body. This either l\n    |           ^^^^^\n \n error: Variable in the condition are not mutated in the loop body. This either leads to an infinite or to a never running loop.\n-  --> $DIR/infinite_loop.rs:64:11\n+  --> $DIR/infinite_loop.rs:70:11\n    |\n-64 |     while i < 3 {\n+70 |     while i < 3 {\n    |           ^^^^^\n \n error: Variable in the condition are not mutated in the loop body. This either leads to an infinite or to a never running loop.\n-  --> $DIR/infinite_loop.rs:69:11\n+  --> $DIR/infinite_loop.rs:75:11\n    |\n-69 |     while i < 3 && j > 0 {\n+75 |     while i < 3 && j > 0 {\n    |           ^^^^^^^^^^^^^^\n \n error: Variable in the condition are not mutated in the loop body. This either leads to an infinite or to a never running loop.\n-  --> $DIR/infinite_loop.rs:73:11\n+  --> $DIR/infinite_loop.rs:79:11\n    |\n-73 |     while i < 3 {\n+79 |     while i < 3 {\n    |           ^^^^^\n \n error: Variable in the condition are not mutated in the loop body. This either leads to an infinite or to a never running loop.\n-  --> $DIR/infinite_loop.rs:88:11\n+  --> $DIR/infinite_loop.rs:94:11\n    |\n-88 |     while i < 3 {\n+94 |     while i < 3 {\n    |           ^^^^^\n \n error: Variable in the condition are not mutated in the loop body. This either leads to an infinite or to a never running loop.\n-  --> $DIR/infinite_loop.rs:93:11\n+  --> $DIR/infinite_loop.rs:99:11\n    |\n-93 |     while i < 3 {\n+99 |     while i < 3 {\n    |           ^^^^^\n \n error: Variable in the condition are not mutated in the loop body. This either leads to an infinite or to a never running loop.\n-   --> $DIR/infinite_loop.rs:156:15\n+   --> $DIR/infinite_loop.rs:162:15\n     |\n-156 |         while self.count < n {\n+162 |         while self.count < n {\n     |               ^^^^^^^^^^^^^^\n \n error: aborting due to 9 previous errors"}]}