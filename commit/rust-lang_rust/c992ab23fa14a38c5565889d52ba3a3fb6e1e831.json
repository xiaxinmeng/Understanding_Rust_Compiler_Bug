{"sha": "c992ab23fa14a38c5565889d52ba3a3fb6e1e831", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM5OTJhYjIzZmExNGEzOGM1NTY1ODg5ZDUyYmEzYTNmYjZlMWU4MzE=", "commit": {"author": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2020-02-18T00:39:38Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-02-18T10:34:59Z"}, "message": "Clean out some default-installed directories\n\nThis helps us have enough disk space for our builders to be able to complete\nsuccessfully. For now, the choices are ad-hoc and 'definitely not needed'. This\nshould never fail the build, as everything our build needs should be inside\nDocker.", "tree": {"sha": "7bece365542c38dbc626febfb8a3d6f4be1e3f95", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7bece365542c38dbc626febfb8a3d6f4be1e3f95"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c992ab23fa14a38c5565889d52ba3a3fb6e1e831", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE1JbYPtLJAsc22U9xPgar6Auq8ZwFAl5LvdcACgkQPgar6Auq\n8ZxDjA//TrOOoyB955hZQwGv9yNHQ/YqMXnMfzzHkwL2PbW0QLGNxgOdQHFTDig5\nU+diZgeQshHqGlDZeuw0xFqjjSmc7skXV7tDtNQrsq/5kPtY7yRgEleQUATaBc3e\nw7vnbVctGlVq0hJV2umLsV6Vg9DFwaJCZ/e0lFcNNT03TRkyhTouBk2QIxMJXyWy\nmBKP1pQHAx0NSXE17DC5YOaqheTv42/LQ9v6j3PG2/iwDPLvC4bUIW7UzMGZh/UE\nlkDXPSIOwXeqQluLBsd8critzDfLUWND0sTC0brKqJ9ksSCqVsE559B496bGB7Qu\nKeEfuq5Elr1jsOKDjmSGyuSGvPcEFgO2xhkdFDddhJaFT7GNtj4LrYpbap1dxFVX\n/Noo+C1459fB/SaOvmHSvrIcwiQP9O1xJQk+3wJbpsEdXwprwh5kbMO09nmJhxs/\n3P0WXz8nZJFxNVAEUIhmzFoLr5K1DTA+6FUnR9JPrXi5a+uoxKgSd8k3HDv07QTA\nEk1lCtnY4KE1vXxyE6mfqWb2tMqwvg7oAbUGSg28L3aCEx/t7j9cNx1pY1skoDmA\nAATZ1q3l25cpxmBQVOdQ/kEipxh1Qdmj37KudSXOnR/pBTLMmcoIsz4tT6dLO70G\nw2c1UHsFxnAipkpG1xnGW3astlAVS+PSKBzPUXEJ109/8NJvlFE=\n=/Vtd\n-----END PGP SIGNATURE-----", "payload": "tree 7bece365542c38dbc626febfb8a3d6f4be1e3f95\nparent 0176a9eef845e7421b7e2f7ef015333a41a7c027\nauthor Mark Rousskov <mark.simulacrum@gmail.com> 1581986378 -0500\ncommitter Pietro Albini <pietro@pietroalbini.org> 1582022099 +0100\n\nClean out some default-installed directories\n\nThis helps us have enough disk space for our builders to be able to complete\nsuccessfully. For now, the choices are ad-hoc and 'definitely not needed'. This\nshould never fail the build, as everything our build needs should be inside\nDocker.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c992ab23fa14a38c5565889d52ba3a3fb6e1e831", "html_url": "https://github.com/rust-lang/rust/commit/c992ab23fa14a38c5565889d52ba3a3fb6e1e831", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c992ab23fa14a38c5565889d52ba3a3fb6e1e831/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0176a9eef845e7421b7e2f7ef015333a41a7c027", "url": "https://api.github.com/repos/rust-lang/rust/commits/0176a9eef845e7421b7e2f7ef015333a41a7c027", "html_url": "https://github.com/rust-lang/rust/commit/0176a9eef845e7421b7e2f7ef015333a41a7c027"}], "stats": {"total": 19, "additions": 19, "deletions": 0}, "files": [{"sha": "c39f75aba89d85162b130d7e518c1db2f7b2eb89", "filename": "src/ci/azure-pipelines/steps/run.yml", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/c992ab23fa14a38c5565889d52ba3a3fb6e1e831/src%2Fci%2Fazure-pipelines%2Fsteps%2Frun.yml", "raw_url": "https://github.com/rust-lang/rust/raw/c992ab23fa14a38c5565889d52ba3a3fb6e1e831/src%2Fci%2Fazure-pipelines%2Fsteps%2Frun.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fazure-pipelines%2Fsteps%2Frun.yml?ref=c992ab23fa14a38c5565889d52ba3a3fb6e1e831", "patch": "@@ -31,6 +31,9 @@ steps:\n - bash: src/ci/scripts/setup-environment.sh\n   displayName: Setup environment\n \n+- bash: src/ci/scripts/clean-disk.sh\n+  displayName: Clean disk\n+\n - bash: src/ci/scripts/should-skip-this.sh\n   displayName: Decide whether to run this job\n "}, {"sha": "c50de37c492b422decb2542a70afd7c8fd93f4b1", "filename": "src/ci/scripts/clean-disk.sh", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/c992ab23fa14a38c5565889d52ba3a3fb6e1e831/src%2Fci%2Fscripts%2Fclean-disk.sh", "raw_url": "https://github.com/rust-lang/rust/raw/c992ab23fa14a38c5565889d52ba3a3fb6e1e831/src%2Fci%2Fscripts%2Fclean-disk.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fscripts%2Fclean-disk.sh?ref=c992ab23fa14a38c5565889d52ba3a3fb6e1e831", "patch": "@@ -0,0 +1,16 @@\n+#!/bin/bash\n+# This script deletes some of the Azure-provided artifacts. We don't use these,\n+# and disk space is at a premium on our builders.\n+\n+set -euo pipefail\n+IFS=$'\\n\\t'\n+\n+source \"$(cd \"$(dirname \"$0\")\" && pwd)/../shared.sh\"\n+\n+# All the Linux builds happen inside Docker.\n+if isLinux; then\n+    # 6.7GB\n+    sudo rm -rf /opt/ghc\n+    # 16GB\n+    sudo rm -rf /usr/share/dotnet\n+fi"}]}