{"sha": "dd0727fee46a843a80c44b24dfd1b0704683072e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRkMDcyN2ZlZTQ2YTg0M2E4MGM0NGIyNGRmZDFiMDcwNDY4MzA3MmU=", "commit": {"author": {"name": "Marco A L Barbosa", "email": "malbarbo@gmail.com", "date": "2017-06-13T14:02:00Z"}, "committer": {"name": "Marco A L Barbosa", "email": "malbarbo@gmail.com", "date": "2017-06-13T14:02:00Z"}, "message": "Add missing emscripten.sh file", "tree": {"sha": "6691bdc8ca095db1bf0cbe633483728586523abb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6691bdc8ca095db1bf0cbe633483728586523abb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/dd0727fee46a843a80c44b24dfd1b0704683072e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/dd0727fee46a843a80c44b24dfd1b0704683072e", "html_url": "https://github.com/rust-lang/rust/commit/dd0727fee46a843a80c44b24dfd1b0704683072e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/dd0727fee46a843a80c44b24dfd1b0704683072e/comments", "author": {"login": "malbarbo", "id": 1678126, "node_id": "MDQ6VXNlcjE2NzgxMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1678126?v=4", "gravatar_id": "", "url": "https://api.github.com/users/malbarbo", "html_url": "https://github.com/malbarbo", "followers_url": "https://api.github.com/users/malbarbo/followers", "following_url": "https://api.github.com/users/malbarbo/following{/other_user}", "gists_url": "https://api.github.com/users/malbarbo/gists{/gist_id}", "starred_url": "https://api.github.com/users/malbarbo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/malbarbo/subscriptions", "organizations_url": "https://api.github.com/users/malbarbo/orgs", "repos_url": "https://api.github.com/users/malbarbo/repos", "events_url": "https://api.github.com/users/malbarbo/events{/privacy}", "received_events_url": "https://api.github.com/users/malbarbo/received_events", "type": "User", "site_admin": false}, "committer": {"login": "malbarbo", "id": 1678126, "node_id": "MDQ6VXNlcjE2NzgxMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1678126?v=4", "gravatar_id": "", "url": "https://api.github.com/users/malbarbo", "html_url": "https://github.com/malbarbo", "followers_url": "https://api.github.com/users/malbarbo/followers", "following_url": "https://api.github.com/users/malbarbo/following{/other_user}", "gists_url": "https://api.github.com/users/malbarbo/gists{/gist_id}", "starred_url": "https://api.github.com/users/malbarbo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/malbarbo/subscriptions", "organizations_url": "https://api.github.com/users/malbarbo/orgs", "repos_url": "https://api.github.com/users/malbarbo/repos", "events_url": "https://api.github.com/users/malbarbo/events{/privacy}", "received_events_url": "https://api.github.com/users/malbarbo/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f0c400b04e37071acfbf70ca007c67e302f377e0", "url": "https://api.github.com/repos/rust-lang/rust/commits/f0c400b04e37071acfbf70ca007c67e302f377e0", "html_url": "https://github.com/rust-lang/rust/commit/f0c400b04e37071acfbf70ca007c67e302f377e0"}], "stats": {"total": 53, "additions": 53, "deletions": 0}, "files": [{"sha": "8aa5a98d7fc5296d6eb6b3893e9d88fa81725bc3", "filename": "src/ci/docker/scripts/emscripten.sh", "status": "added", "additions": 53, "deletions": 0, "changes": 53, "blob_url": "https://github.com/rust-lang/rust/blob/dd0727fee46a843a80c44b24dfd1b0704683072e/src%2Fci%2Fdocker%2Fscripts%2Femscripten.sh", "raw_url": "https://github.com/rust-lang/rust/raw/dd0727fee46a843a80c44b24dfd1b0704683072e/src%2Fci%2Fdocker%2Fscripts%2Femscripten.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fscripts%2Femscripten.sh?ref=dd0727fee46a843a80c44b24dfd1b0704683072e", "patch": "@@ -0,0 +1,53 @@\n+# Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+# file at the top-level directory of this distribution and at\n+# http://rust-lang.org/COPYRIGHT.\n+#\n+# Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+# http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+# <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+# option. This file may not be copied, modified, or distributed\n+# except according to those terms.\n+\n+set -ex\n+\n+hide_output() {\n+  set +x\n+  on_err=\"\n+echo ERROR: An error was encountered with the build.\n+cat /tmp/build.log\n+exit 1\n+\"\n+  trap \"$on_err\" ERR\n+  bash -c \"while true; do sleep 30; echo \\$(date) - building ...; done\" &\n+  PING_LOOP_PID=$!\n+  $@ &> /tmp/build.log\n+  trap - ERR\n+  kill $PING_LOOP_PID\n+  rm -f /tmp/build.log\n+  set -x\n+}\n+\n+cd /\n+curl -L https://s3.amazonaws.com/mozilla-games/emscripten/releases/emsdk-portable.tar.gz | \\\n+    tar -xz\n+\n+cd /emsdk-portable\n+./emsdk update\n+hide_output ./emsdk install sdk-1.37.13-64bit\n+./emsdk activate sdk-1.37.13-64bit\n+\n+# Compile and cache libc\n+source ./emsdk_env.sh\n+echo \"main(){}\" > a.c\n+HOME=/emsdk-portable/ emcc a.c\n+HOME=/emsdk-portable/ emcc -s BINARYEN=1 a.c\n+rm -f a.*\n+\n+# Make emsdk usable by any user\n+cp /root/.emscripten /emsdk-portable\n+chmod a+rxw -R /emsdk-portable\n+\n+# node 8 is required to run wasm\n+cd /\n+curl -L https://nodejs.org/dist/v8.0.0/node-v8.0.0-linux-x64.tar.xz | \\\n+    tar -xJ"}]}