{"sha": "b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI2ZWE1NmVhMDkxYWQxZGJkNzY1ODMxZDhkZmU3OWU0ZDNjZGYwMDQ=", "commit": {"author": {"name": "Igor Aleksanov", "email": "popzxc@yandex.ru", "date": "2020-10-24T08:07:10Z"}, "committer": {"name": "Igor Aleksanov", "email": "popzxc@yandex.ru", "date": "2020-10-24T08:07:10Z"}, "message": "Make call_info a part of ide_db", "tree": {"sha": "fe4de54d78bbafd5de62f008b25c49fa22041146", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fe4de54d78bbafd5de62f008b25c49fa22041146"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004", "html_url": "https://github.com/rust-lang/rust/commit/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/comments", "author": {"login": "popzxc", "id": 12111581, "node_id": "MDQ6VXNlcjEyMTExNTgx", "avatar_url": "https://avatars.githubusercontent.com/u/12111581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/popzxc", "html_url": "https://github.com/popzxc", "followers_url": "https://api.github.com/users/popzxc/followers", "following_url": "https://api.github.com/users/popzxc/following{/other_user}", "gists_url": "https://api.github.com/users/popzxc/gists{/gist_id}", "starred_url": "https://api.github.com/users/popzxc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/popzxc/subscriptions", "organizations_url": "https://api.github.com/users/popzxc/orgs", "repos_url": "https://api.github.com/users/popzxc/repos", "events_url": "https://api.github.com/users/popzxc/events{/privacy}", "received_events_url": "https://api.github.com/users/popzxc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "popzxc", "id": 12111581, "node_id": "MDQ6VXNlcjEyMTExNTgx", "avatar_url": "https://avatars.githubusercontent.com/u/12111581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/popzxc", "html_url": "https://github.com/popzxc", "followers_url": "https://api.github.com/users/popzxc/followers", "following_url": "https://api.github.com/users/popzxc/following{/other_user}", "gists_url": "https://api.github.com/users/popzxc/gists{/gist_id}", "starred_url": "https://api.github.com/users/popzxc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/popzxc/subscriptions", "organizations_url": "https://api.github.com/users/popzxc/orgs", "repos_url": "https://api.github.com/users/popzxc/repos", "events_url": "https://api.github.com/users/popzxc/events{/privacy}", "received_events_url": "https://api.github.com/users/popzxc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8d3d509af77756758cea14cc4939d099b4f95993", "url": "https://api.github.com/repos/rust-lang/rust/commits/8d3d509af77756758cea14cc4939d099b4f95993", "html_url": "https://github.com/rust-lang/rust/commit/8d3d509af77756758cea14cc4939d099b4f95993"}], "stats": {"total": 67, "additions": 14, "deletions": 53}, "files": [{"sha": "bc0f0862d7240f88bf6d2725f15c4bc3fe223223", "filename": "Cargo.lock", "status": "modified", "additions": 1, "deletions": 16, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004", "patch": "@@ -127,20 +127,6 @@ version = \"1.3.4\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"08c48aae112d48ed9f069b33538ea9e3e90aa263cfa3d1c24309612b1f7472de\"\n \n-[[package]]\n-name = \"call_info\"\n-version = \"0.0.0\"\n-dependencies = [\n- \"base_db\",\n- \"either\",\n- \"expect-test\",\n- \"hir\",\n- \"ide_db\",\n- \"stdx\",\n- \"syntax\",\n- \"test_utils\",\n-]\n-\n [[package]]\n name = \"cargo_metadata\"\n version = \"0.12.0\"\n@@ -269,7 +255,6 @@ name = \"completion\"\n version = \"0.0.0\"\n dependencies = [\n  \"base_db\",\n- \"call_info\",\n  \"expect-test\",\n  \"hir\",\n  \"ide_db\",\n@@ -643,7 +628,6 @@ version = \"0.0.0\"\n dependencies = [\n  \"assists\",\n  \"base_db\",\n- \"call_info\",\n  \"cfg\",\n  \"completion\",\n  \"either\",\n@@ -672,6 +656,7 @@ version = \"0.0.0\"\n dependencies = [\n  \"base_db\",\n  \"either\",\n+ \"expect-test\",\n  \"fst\",\n  \"hir\",\n  \"log\","}, {"sha": "98c0bd6dbe55e65a3745ffc29e402cff37afcbba", "filename": "crates/call_info/Cargo.toml", "status": "removed", "additions": 0, "deletions": 26, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/8d3d509af77756758cea14cc4939d099b4f95993/crates%2Fcall_info%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/8d3d509af77756758cea14cc4939d099b4f95993/crates%2Fcall_info%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcall_info%2FCargo.toml?ref=8d3d509af77756758cea14cc4939d099b4f95993", "patch": "@@ -1,26 +0,0 @@\n-[package]\n-name = \"call_info\"\n-version = \"0.0.0\"\n-description = \"TBD\"\n-license = \"MIT OR Apache-2.0\"\n-authors = [\"rust-analyzer developers\"]\n-edition = \"2018\"\n-\n-[lib]\n-doctest = false\n-\n-[dependencies]\n-either = \"1.5.3\"\n-\n-stdx = { path = \"../stdx\", version = \"0.0.0\" }\n-syntax = { path = \"../syntax\", version = \"0.0.0\" }\n-base_db = { path = \"../base_db\", version = \"0.0.0\" }\n-ide_db = { path = \"../ide_db\", version = \"0.0.0\" }\n-test_utils = { path = \"../test_utils\", version = \"0.0.0\" }\n-\n-# call_info crate should depend only on the top-level `hir` package. if you need\n-# something from some `hir_xxx` subpackage, reexport the API via `hir`.\n-hir = { path = \"../hir\", version = \"0.0.0\" }\n-\n-[dev-dependencies]\n-expect-test = \"1.0\""}, {"sha": "b79ee33f73aeb855598ac454be916be8ba874032", "filename": "crates/completion/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fcompletion%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fcompletion%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2FCargo.toml?ref=b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004", "patch": "@@ -21,7 +21,6 @@ base_db = { path = \"../base_db\", version = \"0.0.0\" }\n ide_db = { path = \"../ide_db\", version = \"0.0.0\" }\n profile = { path = \"../profile\", version = \"0.0.0\" }\n test_utils = { path = \"../test_utils\", version = \"0.0.0\" }\n-call_info = { path = \"../call_info\", version = \"0.0.0\" }\n \n # completions crate should depend only on the top-level `hir` package. if you need\n # something from some `hir_xxx` subpackage, reexport the API via `hir`."}, {"sha": "97c5c04ba5cd209d256bbecef235923a43c5389e", "filename": "crates/completion/src/completion_context.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fcompletion%2Fsrc%2Fcompletion_context.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fcompletion%2Fsrc%2Fcompletion_context.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2Fsrc%2Fcompletion_context.rs?ref=b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004", "patch": "@@ -1,9 +1,8 @@\n //! See `CompletionContext` structure.\n \n use base_db::{FilePosition, SourceDatabase};\n-use call_info::ActiveParameter;\n use hir::{Local, ScopeDef, Semantics, SemanticsScope, Type};\n-use ide_db::RootDatabase;\n+use ide_db::{call_info::ActiveParameter, RootDatabase};\n use syntax::{\n     algo::{find_covering_element, find_node_at_offset},\n     ast, match_ast, AstNode, NodeOrToken,"}, {"sha": "145c6156cc084affff400e5dc048882722832199", "filename": "crates/ide/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fide%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fide%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2FCargo.toml?ref=b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004", "patch": "@@ -30,7 +30,6 @@ profile = { path = \"../profile\", version = \"0.0.0\" }\n test_utils = { path = \"../test_utils\", version = \"0.0.0\" }\n assists = { path = \"../assists\", version = \"0.0.0\" }\n ssr = { path = \"../ssr\", version = \"0.0.0\" }\n-call_info = { path = \"../call_info\", version = \"0.0.0\" }\n completion = { path = \"../completion\", version = \"0.0.0\" }\n \n # ide should depend only on the top-level `hir` package. if you need"}, {"sha": "a259d98496a50e115143ae5661e654cae0e3cc12", "filename": "crates/ide/src/call_hierarchy.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fide%2Fsrc%2Fcall_hierarchy.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fide%2Fsrc%2Fcall_hierarchy.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fcall_hierarchy.rs?ref=b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004", "patch": "@@ -2,8 +2,8 @@\n \n use indexmap::IndexMap;\n \n-use call_info::FnCallNode;\n use hir::Semantics;\n+use ide_db::call_info::FnCallNode;\n use ide_db::RootDatabase;\n use syntax::{ast, match_ast, AstNode, TextRange};\n "}, {"sha": "d84b970d462fab66ce329cf24a6628bcfb2c5302", "filename": "crates/ide/src/lib.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fide%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fide%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Flib.rs?ref=b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004", "patch": "@@ -80,10 +80,10 @@ pub use crate::{\n         Highlight, HighlightModifier, HighlightModifiers, HighlightTag, HighlightedRange,\n     },\n };\n-pub use call_info::CallInfo;\n pub use completion::{\n     CompletionConfig, CompletionItem, CompletionItemKind, CompletionScore, InsertTextFormat,\n };\n+pub use ide_db::call_info::CallInfo;\n \n pub use assists::{\n     utils::MergeBehaviour, Assist, AssistConfig, AssistId, AssistKind, ResolvedAssist,\n@@ -396,7 +396,7 @@ impl Analysis {\n \n     /// Computes parameter information for the given call expression.\n     pub fn call_info(&self, position: FilePosition) -> Cancelable<Option<CallInfo>> {\n-        self.with_db(|db| call_info::call_info(db, position))\n+        self.with_db(|db| ide_db::call_info::call_info(db, position))\n     }\n \n     /// Computes call hierarchy candidates for the given file position."}, {"sha": "59a74bc02e5f2cb5683a988156ee47e1aeb322ac", "filename": "crates/ide/src/syntax_highlighting/injection.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fide%2Fsrc%2Fsyntax_highlighting%2Finjection.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fide%2Fsrc%2Fsyntax_highlighting%2Finjection.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fsyntax_highlighting%2Finjection.rs?ref=b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004", "patch": "@@ -3,8 +3,8 @@\n use std::{collections::BTreeMap, convert::TryFrom};\n \n use ast::{HasQuotes, HasStringValue};\n-use call_info::ActiveParameter;\n use hir::Semantics;\n+use ide_db::call_info::ActiveParameter;\n use itertools::Itertools;\n use syntax::{ast, AstToken, SyntaxNode, SyntaxToken, TextRange, TextSize};\n "}, {"sha": "3ff7a1a6a0069fa427549736263dd04f2a4dc456", "filename": "crates/ide_db/Cargo.toml", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fide_db%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fide_db%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_db%2FCargo.toml?ref=b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004", "patch": "@@ -29,3 +29,6 @@ test_utils = { path = \"../test_utils\", version = \"0.0.0\" }\n # ide should depend only on the top-level `hir` package. if you need\n # something from some `hir_xxx` subpackage, reexport the API via `hir`.\n hir = { path = \"../hir\", version = \"0.0.0\" }\n+\n+[dev-dependencies]\n+expect-test = \"1.0\""}, {"sha": "83a602b9ad4d51a4ef16ad8c113b7d00d463222d", "filename": "crates/ide_db/src/call_info.rs", "status": "renamed", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fide_db%2Fsrc%2Fcall_info.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fide_db%2Fsrc%2Fcall_info.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_db%2Fsrc%2Fcall_info.rs?ref=b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004", "patch": "@@ -2,14 +2,15 @@\n use base_db::FilePosition;\n use either::Either;\n use hir::{HasAttrs, HirDisplay, Semantics, Type};\n-use ide_db::RootDatabase;\n use stdx::format_to;\n use syntax::{\n     ast::{self, ArgListOwner},\n     match_ast, AstNode, SyntaxNode, SyntaxToken, TextRange, TextSize,\n };\n use test_utils::mark;\n \n+use crate::RootDatabase;\n+\n /// Contains information about a call site. Specifically the\n /// `FunctionSignature`and current parameter.\n #[derive(Debug)]\n@@ -228,9 +229,9 @@ impl FnCallNode {\n \n #[cfg(test)]\n mod tests {\n+    use crate::RootDatabase;\n     use base_db::{fixture::ChangeFixture, FilePosition};\n     use expect_test::{expect, Expect};\n-    use ide_db::RootDatabase;\n     use test_utils::{mark, RangeOrOffset};\n \n     /// Creates analysis from a multi-file fixture, returns positions marked with <|>.\n@@ -249,7 +250,7 @@ mod tests {\n \n     fn check(ra_fixture: &str, expect: Expect) {\n         let (db, position) = position(ra_fixture);\n-        let call_info = crate::call_info(&db, position);\n+        let call_info = crate::call_info::call_info(&db, position);\n         let actual = match call_info {\n             Some(call_info) => {\n                 let docs = match &call_info.doc {", "previous_filename": "crates/call_info/src/lib.rs"}, {"sha": "303f7c964bed6992c6eac4af1b88e7d99f468300", "filename": "crates/ide_db/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fide_db%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004/crates%2Fide_db%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_db%2Fsrc%2Flib.rs?ref=b6ea56ea091ad1dbd765831d8dfe79e4d3cdf004", "patch": "@@ -12,6 +12,7 @@ pub mod imports_locator;\n pub mod source_change;\n pub mod ty_filter;\n pub mod traits;\n+pub mod call_info;\n \n use std::{fmt, sync::Arc};\n "}]}