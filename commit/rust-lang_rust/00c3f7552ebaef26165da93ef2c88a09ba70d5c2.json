{"sha": "00c3f7552ebaef26165da93ef2c88a09ba70d5c2", "node_id": "C_kwDOAAsO6NoAKDAwYzNmNzU1MmViYWVmMjYxNjVkYTkzZWYyYzg4YTA5YmE3MGQ1YzI", "commit": {"author": {"name": "Caleb Cartwright", "email": "caleb.cartwright@outlook.com", "date": "2023-05-12T21:57:29Z"}, "committer": {"name": "Caleb Cartwright", "email": "caleb.cartwright@outlook.com", "date": "2023-05-13T21:59:28Z"}, "message": "refactor: add chunks method to TokenStream to obviate rustdoc clones", "tree": {"sha": "c1ee2b1920163389c81fc546f2af5602b6fce835", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c1ee2b1920163389c81fc546f2af5602b6fce835"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/00c3f7552ebaef26165da93ef2c88a09ba70d5c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/00c3f7552ebaef26165da93ef2c88a09ba70d5c2", "html_url": "https://github.com/rust-lang/rust/commit/00c3f7552ebaef26165da93ef2c88a09ba70d5c2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/00c3f7552ebaef26165da93ef2c88a09ba70d5c2/comments", "author": {"login": "calebcartwright", "id": 13042488, "node_id": "MDQ6VXNlcjEzMDQyNDg4", "avatar_url": "https://avatars.githubusercontent.com/u/13042488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/calebcartwright", "html_url": "https://github.com/calebcartwright", "followers_url": "https://api.github.com/users/calebcartwright/followers", "following_url": "https://api.github.com/users/calebcartwright/following{/other_user}", "gists_url": "https://api.github.com/users/calebcartwright/gists{/gist_id}", "starred_url": "https://api.github.com/users/calebcartwright/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/calebcartwright/subscriptions", "organizations_url": "https://api.github.com/users/calebcartwright/orgs", "repos_url": "https://api.github.com/users/calebcartwright/repos", "events_url": "https://api.github.com/users/calebcartwright/events{/privacy}", "received_events_url": "https://api.github.com/users/calebcartwright/received_events", "type": "User", "site_admin": false}, "committer": {"login": "calebcartwright", "id": 13042488, "node_id": "MDQ6VXNlcjEzMDQyNDg4", "avatar_url": "https://avatars.githubusercontent.com/u/13042488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/calebcartwright", "html_url": "https://github.com/calebcartwright", "followers_url": "https://api.github.com/users/calebcartwright/followers", "following_url": "https://api.github.com/users/calebcartwright/following{/other_user}", "gists_url": "https://api.github.com/users/calebcartwright/gists{/gist_id}", "starred_url": "https://api.github.com/users/calebcartwright/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/calebcartwright/subscriptions", "organizations_url": "https://api.github.com/users/calebcartwright/orgs", "repos_url": "https://api.github.com/users/calebcartwright/repos", "events_url": "https://api.github.com/users/calebcartwright/events{/privacy}", "received_events_url": "https://api.github.com/users/calebcartwright/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2c41369acc445d04129db40ba998dd7a89fb0d2e", "url": "https://api.github.com/repos/rust-lang/rust/commits/2c41369acc445d04129db40ba998dd7a89fb0d2e", "html_url": "https://github.com/rust-lang/rust/commit/2c41369acc445d04129db40ba998dd7a89fb0d2e"}], "stats": {"total": 7, "additions": 5, "deletions": 2}, "files": [{"sha": "db296aa44db2b6edc65f820c55f62132c7bad6c7", "filename": "compiler/rustc_ast/src/tokenstream.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/00c3f7552ebaef26165da93ef2c88a09ba70d5c2/compiler%2Frustc_ast%2Fsrc%2Ftokenstream.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00c3f7552ebaef26165da93ef2c88a09ba70d5c2/compiler%2Frustc_ast%2Fsrc%2Ftokenstream.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast%2Fsrc%2Ftokenstream.rs?ref=00c3f7552ebaef26165da93ef2c88a09ba70d5c2", "patch": "@@ -551,6 +551,10 @@ impl TokenStream {\n             vec_mut.extend(stream_iter);\n         }\n     }\n+\n+    pub fn chunks(&self, chunk_size: usize) -> core::slice::Chunks<'_, TokenTree> {\n+        self.0.chunks(chunk_size)\n+    }\n }\n \n /// By-reference iterator over a [`TokenStream`], that produces `&TokenTree`"}, {"sha": "17aa6b38e389c3fba44ec5ec42aa9548fdb9bc02", "filename": "src/librustdoc/clean/utils.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/00c3f7552ebaef26165da93ef2c88a09ba70d5c2/src%2Flibrustdoc%2Fclean%2Futils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00c3f7552ebaef26165da93ef2c88a09ba70d5c2/src%2Flibrustdoc%2Fclean%2Futils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Futils.rs?ref=00c3f7552ebaef26165da93ef2c88a09ba70d5c2", "patch": "@@ -594,9 +594,8 @@ pub(super) fn display_macro_source(\n     def_id: DefId,\n     vis: ty::Visibility<DefId>,\n ) -> String {\n-    let tts: Vec<_> = def.body.tokens.clone().into_trees().collect();\n     // Extract the spans of all matchers. They represent the \"interface\" of the macro.\n-    let matchers = tts.chunks(4).map(|arm| &arm[0]);\n+    let matchers = def.body.tokens.chunks(4).map(|arm| &arm[0]);\n \n     if def.macro_rules {\n         format!(\"macro_rules! {} {{\\n{}}}\", name, render_macro_arms(cx.tcx, matchers, \";\"))"}]}