{"sha": "6310786ca5531f8d7f93eb07ab3a96d0f7addd25", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYzMTA3ODZjYTU1MzFmOGQ3ZjkzZWIwN2FiM2E5NmQwZjdhZGRkMjU=", "commit": {"author": {"name": "Alexander Gonzalez", "email": "alexfertel97@gmail.com", "date": "2021-07-26T19:34:44Z"}, "committer": {"name": "Alexander Gonzalez", "email": "alexfertel97@gmail.com", "date": "2021-07-27T22:29:22Z"}, "message": "test: Add hover_range tests", "tree": {"sha": "711be525dc253e6ef28f08eea56c11de1634af75", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/711be525dc253e6ef28f08eea56c11de1634af75"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6310786ca5531f8d7f93eb07ab3a96d0f7addd25", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6310786ca5531f8d7f93eb07ab3a96d0f7addd25", "html_url": "https://github.com/rust-lang/rust/commit/6310786ca5531f8d7f93eb07ab3a96d0f7addd25", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6310786ca5531f8d7f93eb07ab3a96d0f7addd25/comments", "author": {"login": "alexfertel", "id": 22298999, "node_id": "MDQ6VXNlcjIyMjk4OTk5", "avatar_url": "https://avatars.githubusercontent.com/u/22298999?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexfertel", "html_url": "https://github.com/alexfertel", "followers_url": "https://api.github.com/users/alexfertel/followers", "following_url": "https://api.github.com/users/alexfertel/following{/other_user}", "gists_url": "https://api.github.com/users/alexfertel/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexfertel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexfertel/subscriptions", "organizations_url": "https://api.github.com/users/alexfertel/orgs", "repos_url": "https://api.github.com/users/alexfertel/repos", "events_url": "https://api.github.com/users/alexfertel/events{/privacy}", "received_events_url": "https://api.github.com/users/alexfertel/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexfertel", "id": 22298999, "node_id": "MDQ6VXNlcjIyMjk4OTk5", "avatar_url": "https://avatars.githubusercontent.com/u/22298999?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexfertel", "html_url": "https://github.com/alexfertel", "followers_url": "https://api.github.com/users/alexfertel/followers", "following_url": "https://api.github.com/users/alexfertel/following{/other_user}", "gists_url": "https://api.github.com/users/alexfertel/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexfertel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexfertel/subscriptions", "organizations_url": "https://api.github.com/users/alexfertel/orgs", "repos_url": "https://api.github.com/users/alexfertel/repos", "events_url": "https://api.github.com/users/alexfertel/events{/privacy}", "received_events_url": "https://api.github.com/users/alexfertel/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1a0a5da1a488033e4b9fdb4c4cd32854ff2859d6", "url": "https://api.github.com/repos/rust-lang/rust/commits/1a0a5da1a488033e4b9fdb4c4cd32854ff2859d6", "html_url": "https://github.com/rust-lang/rust/commit/1a0a5da1a488033e4b9fdb4c4cd32854ff2859d6"}], "stats": {"total": 106, "additions": 106, "deletions": 0}, "files": [{"sha": "735c535e5eb2ce6d73062e44fa07381b086372f0", "filename": "crates/ide/src/hover.rs", "status": "modified", "additions": 106, "deletions": 0, "changes": 106, "blob_url": "https://github.com/rust-lang/rust/blob/6310786ca5531f8d7f93eb07ab3a96d0f7addd25/crates%2Fide%2Fsrc%2Fhover.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6310786ca5531f8d7f93eb07ab3a96d0f7addd25/crates%2Fide%2Fsrc%2Fhover.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fhover.rs?ref=6310786ca5531f8d7f93eb07ab3a96d0f7addd25", "patch": "@@ -652,6 +652,21 @@ mod tests {\n         expect.assert_debug_eq(&hover.info.actions)\n     }\n \n+    fn check_hover_range(ra_fixture: &str, expect: Expect) {\n+        let (analysis, range) = fixture::range(ra_fixture);\n+        let hover = analysis\n+            .hover_range(\n+                &HoverConfig {\n+                    links_in_hover: false,\n+                    documentation: Some(HoverDocFormat::Markdown),\n+                },\n+                range,\n+            )\n+            .unwrap()\n+            .unwrap();\n+        expect.assert_eq(hover.info.markup.as_str())\n+    }\n+\n     #[test]\n     fn hover_shows_type_of_an_expression() {\n         check(\n@@ -3911,4 +3926,95 @@ struct Foo;\n             \"#]],\n         );\n     }\n+\n+    #[test]\n+    fn hover_range_math() {\n+        check_hover_range(\n+            r#\"\n+fn f() { let expr = $01 + 2 * 3$0 } \n+            \"#,\n+            expect![[r#\"\n+            ```rust\n+            i32\n+            ```\"#]],\n+        );\n+\n+        check_hover_range(\n+            r#\"\n+fn f() { let expr = 1 $0+ 2 * $03 } \n+            \"#,\n+            expect![[r#\"\n+            ```rust\n+            i32\n+            ```\"#]],\n+        );\n+\n+        check_hover_range(\n+            r#\"\n+fn f() { let expr = 1 + $02 * 3$0 } \n+            \"#,\n+            expect![[r#\"\n+            ```rust\n+            i32\n+            ```\"#]],\n+        );\n+    }\n+\n+    #[test]\n+    fn hover_range_arrays() {\n+        check_hover_range(\n+            r#\"\n+fn f() { let expr = $0[1, 2, 3, 4]$0 } \n+            \"#,\n+            expect![[r#\"\n+            ```rust\n+            [i32; 4]\n+            ```\"#]],\n+        );\n+\n+        check_hover_range(\n+            r#\"\n+fn f() { let expr = [1, 2, $03, 4]$0 } \n+            \"#,\n+            expect![[r#\"\n+            ```rust\n+            [i32; 4]\n+            ```\"#]],\n+        );\n+\n+        check_hover_range(\n+            r#\"\n+fn f() { let expr = [1, 2, $03$0, 4] } \n+            \"#,\n+            expect![[r#\"\n+            ```rust\n+            i32\n+            ```\"#]],\n+        );\n+    }\n+\n+    #[test]\n+    fn hover_range_functions() {\n+        check_hover_range(\n+            r#\"\n+fn f<T>(a: &[T]) { }\n+fn b() { $0f$0(&[1, 2, 3, 4, 5]); }\n+            \"#,\n+            expect![[r#\"\n+            ```rust\n+            fn f<i32>(&[i32])\n+            ```\"#]],\n+        );\n+\n+        check_hover_range(\n+            r#\"\n+fn f<T>(a: &[T]) { }\n+fn b() { f($0&[1, 2, 3, 4, 5]$0); }\n+            \"#,\n+            expect![[r#\"\n+            ```rust\n+            &[i32; 5]\n+            ```\"#]],\n+        );\n+    }\n }"}]}