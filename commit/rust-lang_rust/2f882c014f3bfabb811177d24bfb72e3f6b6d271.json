{"sha": "2f882c014f3bfabb811177d24bfb72e3f6b6d271", "node_id": "C_kwDOAAsO6NoAKDJmODgyYzAxNGYzYmZhYmI4MTExNzdkMjRiZmI3MmUzZjZiNmQyNzE", "commit": {"author": {"name": "clubby789", "email": "jamie@hill-daniel.co.uk", "date": "2022-11-05T01:11:50Z"}, "committer": {"name": "clubby789", "email": "jamie@hill-daniel.co.uk", "date": "2022-11-05T01:12:58Z"}, "message": "Specify that `break` cannot be used outside of loop *or* labeled block", "tree": {"sha": "8bf53e1ae1943a2c7f22c62fe72993892380f959", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8bf53e1ae1943a2c7f22c62fe72993892380f959"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2f882c014f3bfabb811177d24bfb72e3f6b6d271", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2f882c014f3bfabb811177d24bfb72e3f6b6d271", "html_url": "https://github.com/rust-lang/rust/commit/2f882c014f3bfabb811177d24bfb72e3f6b6d271", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2f882c014f3bfabb811177d24bfb72e3f6b6d271/comments", "author": {"login": "clubby789", "id": 13556931, "node_id": "MDQ6VXNlcjEzNTU2OTMx", "avatar_url": "https://avatars.githubusercontent.com/u/13556931?v=4", "gravatar_id": "", "url": "https://api.github.com/users/clubby789", "html_url": "https://github.com/clubby789", "followers_url": "https://api.github.com/users/clubby789/followers", "following_url": "https://api.github.com/users/clubby789/following{/other_user}", "gists_url": "https://api.github.com/users/clubby789/gists{/gist_id}", "starred_url": "https://api.github.com/users/clubby789/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/clubby789/subscriptions", "organizations_url": "https://api.github.com/users/clubby789/orgs", "repos_url": "https://api.github.com/users/clubby789/repos", "events_url": "https://api.github.com/users/clubby789/events{/privacy}", "received_events_url": "https://api.github.com/users/clubby789/received_events", "type": "User", "site_admin": false}, "committer": {"login": "clubby789", "id": 13556931, "node_id": "MDQ6VXNlcjEzNTU2OTMx", "avatar_url": "https://avatars.githubusercontent.com/u/13556931?v=4", "gravatar_id": "", "url": "https://api.github.com/users/clubby789", "html_url": "https://github.com/clubby789", "followers_url": "https://api.github.com/users/clubby789/followers", "following_url": "https://api.github.com/users/clubby789/following{/other_user}", "gists_url": "https://api.github.com/users/clubby789/gists{/gist_id}", "starred_url": "https://api.github.com/users/clubby789/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/clubby789/subscriptions", "organizations_url": "https://api.github.com/users/clubby789/orgs", "repos_url": "https://api.github.com/users/clubby789/repos", "events_url": "https://api.github.com/users/clubby789/events{/privacy}", "received_events_url": "https://api.github.com/users/clubby789/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "09508489efc223287731fe8abbd2a81bbf7adf8e", "url": "https://api.github.com/repos/rust-lang/rust/commits/09508489efc223287731fe8abbd2a81bbf7adf8e", "html_url": "https://github.com/rust-lang/rust/commit/09508489efc223287731fe8abbd2a81bbf7adf8e"}], "stats": {"total": 67, "additions": 37, "deletions": 30}, "files": [{"sha": "5239ff9dc0571d31e0bb58fd6b1e2044deb09b6e", "filename": "compiler/rustc_error_messages/locales/en-US/passes.ftl", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2f882c014f3bfabb811177d24bfb72e3f6b6d271/compiler%2Frustc_error_messages%2Flocales%2Fen-US%2Fpasses.ftl", "raw_url": "https://github.com/rust-lang/rust/raw/2f882c014f3bfabb811177d24bfb72e3f6b6d271/compiler%2Frustc_error_messages%2Flocales%2Fen-US%2Fpasses.ftl", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_messages%2Flocales%2Fen-US%2Fpasses.ftl?ref=2f882c014f3bfabb811177d24bfb72e3f6b6d271", "patch": "@@ -451,8 +451,14 @@ passes_break_inside_async_block =\n     .async_block_label = enclosing `async` block\n \n passes_outside_loop =\n-    `{$name}` outside of a loop\n-    .label = cannot `{$name}` outside of a loop\n+    `{$name}` outside of a loop{$is_break ->\n+        [true] {\" or labeled block\"}\n+        *[false] {\"\"}\n+    }\n+    .label = cannot `{$name}` outside of a loop{$is_break ->\n+        [true] {\" or labeled block\"}\n+        *[false] {\"\"}\n+    }\n \n passes_unlabeled_in_labeled_block =\n     unlabeled `{$cf_type}` inside of a labeled block"}, {"sha": "1dbf0d642e2afdbbea56d0d49801ace8fb040199", "filename": "compiler/rustc_passes/src/errors.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/2f882c014f3bfabb811177d24bfb72e3f6b6d271/compiler%2Frustc_passes%2Fsrc%2Ferrors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2f882c014f3bfabb811177d24bfb72e3f6b6d271/compiler%2Frustc_passes%2Fsrc%2Ferrors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Ferrors.rs?ref=2f882c014f3bfabb811177d24bfb72e3f6b6d271", "patch": "@@ -956,6 +956,7 @@ pub struct OutsideLoop<'a> {\n     #[label]\n     pub span: Span,\n     pub name: &'a str,\n+    pub is_break: bool,\n }\n \n #[derive(Diagnostic)]"}, {"sha": "b4cf19e4a34f6ad2b46ad8bc48ed351153a0b333", "filename": "compiler/rustc_passes/src/loops.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2f882c014f3bfabb811177d24bfb72e3f6b6d271/compiler%2Frustc_passes%2Fsrc%2Floops.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2f882c014f3bfabb811177d24bfb72e3f6b6d271/compiler%2Frustc_passes%2Fsrc%2Floops.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Floops.rs?ref=2f882c014f3bfabb811177d24bfb72e3f6b6d271", "patch": "@@ -193,7 +193,7 @@ impl<'a, 'hir> CheckLoopVisitor<'a, 'hir> {\n                 self.sess.emit_err(BreakInsideAsyncBlock { span, closure_span, name });\n             }\n             Normal | AnonConst => {\n-                self.sess.emit_err(OutsideLoop { span, name });\n+                self.sess.emit_err(OutsideLoop { span, name, is_break: name == \"break\" });\n             }\n         }\n     }"}, {"sha": "2df7b6d7f63c62ce796cfa3cb9589fcfdd1d4412", "filename": "src/test/ui/array-slice-vec/array-break-length.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Farray-slice-vec%2Farray-break-length.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Farray-slice-vec%2Farray-break-length.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Farray-slice-vec%2Farray-break-length.stderr?ref=2f882c014f3bfabb811177d24bfb72e3f6b6d271", "patch": "@@ -1,8 +1,8 @@\n-error[E0268]: `break` outside of a loop\n+error[E0268]: `break` outside of a loop or labeled block\n   --> $DIR/array-break-length.rs:3:17\n    |\n LL |         |_: [_; break]| {}\n-   |                 ^^^^^ cannot `break` outside of a loop\n+   |                 ^^^^^ cannot `break` outside of a loop or labeled block\n \n error[E0268]: `continue` outside of a loop\n   --> $DIR/array-break-length.rs:7:17"}, {"sha": "7e0b0027a6f09a63397f098d6bfbf67bd0b1f772", "filename": "src/test/ui/closures/closure-array-break-length.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Fclosures%2Fclosure-array-break-length.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Fclosures%2Fclosure-array-break-length.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fclosures%2Fclosure-array-break-length.stderr?ref=2f882c014f3bfabb811177d24bfb72e3f6b6d271", "patch": "@@ -10,11 +10,11 @@ error[E0268]: `continue` outside of a loop\n LL |     while |_: [_; continue]| {} {}\n    |                   ^^^^^^^^ cannot `continue` outside of a loop\n \n-error[E0268]: `break` outside of a loop\n+error[E0268]: `break` outside of a loop or labeled block\n   --> $DIR/closure-array-break-length.rs:6:19\n    |\n LL |     while |_: [_; break]| {} {}\n-   |                   ^^^^^ cannot `break` outside of a loop\n+   |                   ^^^^^ cannot `break` outside of a loop or labeled block\n \n error: aborting due to 3 previous errors\n "}, {"sha": "6422e8a9490e9e79102205630716376d437de689", "filename": "src/test/ui/error-codes/E0268.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Ferror-codes%2FE0268.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Ferror-codes%2FE0268.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0268.stderr?ref=2f882c014f3bfabb811177d24bfb72e3f6b6d271", "patch": "@@ -1,8 +1,8 @@\n-error[E0268]: `break` outside of a loop\n+error[E0268]: `break` outside of a loop or labeled block\n   --> $DIR/E0268.rs:2:5\n    |\n LL |     break;\n-   |     ^^^^^ cannot `break` outside of a loop\n+   |     ^^^^^ cannot `break` outside of a loop or labeled block\n \n error: aborting due to previous error\n "}, {"sha": "9092f34df354935ce355fb00f2767687b7bc869b", "filename": "src/test/ui/for-loop-while/break-outside-loop.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Ffor-loop-while%2Fbreak-outside-loop.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Ffor-loop-while%2Fbreak-outside-loop.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffor-loop-while%2Fbreak-outside-loop.stderr?ref=2f882c014f3bfabb811177d24bfb72e3f6b6d271", "patch": "@@ -9,11 +9,11 @@ LL |             break 'lab;\n    |\n    = note: labels are unreachable through functions, closures, async blocks and modules\n \n-error[E0268]: `break` outside of a loop\n+error[E0268]: `break` outside of a loop or labeled block\n   --> $DIR/break-outside-loop.rs:10:15\n    |\n LL |     let pth = break;\n-   |               ^^^^^ cannot `break` outside of a loop\n+   |               ^^^^^ cannot `break` outside of a loop or labeled block\n \n error[E0268]: `continue` outside of a loop\n   --> $DIR/break-outside-loop.rs:11:17\n@@ -38,11 +38,11 @@ LL |             if cond() { break }\n LL |             if cond() { continue }\n    |                         ^^^^^^^^ cannot `continue` inside of a closure\n \n-error[E0268]: `break` outside of a loop\n+error[E0268]: `break` outside of a loop or labeled block\n   --> $DIR/break-outside-loop.rs:24:25\n    |\n LL |     let unconstrained = break;\n-   |                         ^^^^^ cannot `break` outside of a loop\n+   |                         ^^^^^ cannot `break` outside of a loop or labeled block\n \n error[E0267]: `break` inside of a closure\n   --> $DIR/break-outside-loop.rs:30:13"}, {"sha": "f450256f3ecf565276034d7c38f1f5d737492fda", "filename": "src/test/ui/issues/issue-28105.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Fissues%2Fissue-28105.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Fissues%2Fissue-28105.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-28105.stderr?ref=2f882c014f3bfabb811177d24bfb72e3f6b6d271", "patch": "@@ -4,11 +4,11 @@ error[E0268]: `continue` outside of a loop\n LL |     continue\n    |     ^^^^^^^^ cannot `continue` outside of a loop\n \n-error[E0268]: `break` outside of a loop\n+error[E0268]: `break` outside of a loop or labeled block\n   --> $DIR/issue-28105.rs:6:5\n    |\n LL |     break\n-   |     ^^^^^ cannot `break` outside of a loop\n+   |     ^^^^^ cannot `break` outside of a loop or labeled block\n \n error: aborting due to 2 previous errors\n "}, {"sha": "40d9200058ed11c4dba654545aec2f9d422e3272", "filename": "src/test/ui/issues/issue-43162.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Fissues%2Fissue-43162.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Fissues%2Fissue-43162.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-43162.stderr?ref=2f882c014f3bfabb811177d24bfb72e3f6b6d271", "patch": "@@ -1,14 +1,14 @@\n-error[E0268]: `break` outside of a loop\n+error[E0268]: `break` outside of a loop or labeled block\n   --> $DIR/issue-43162.rs:3:5\n    |\n LL |     break true;\n-   |     ^^^^^^^^^^ cannot `break` outside of a loop\n+   |     ^^^^^^^^^^ cannot `break` outside of a loop or labeled block\n \n-error[E0268]: `break` outside of a loop\n+error[E0268]: `break` outside of a loop or labeled block\n   --> $DIR/issue-43162.rs:7:5\n    |\n LL |     break {};\n-   |     ^^^^^^^^ cannot `break` outside of a loop\n+   |     ^^^^^^^^ cannot `break` outside of a loop or labeled block\n \n error[E0308]: mismatched types\n   --> $DIR/issue-43162.rs:1:13"}, {"sha": "4ec22fde9106db6dc5fcbd2caf2fc92718a410a1", "filename": "src/test/ui/issues/issue-50576.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Fissues%2Fissue-50576.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Fissues%2Fissue-50576.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-50576.stderr?ref=2f882c014f3bfabb811177d24bfb72e3f6b6d271", "patch": "@@ -4,17 +4,17 @@ error[E0426]: use of undeclared label `'L`\n LL |     |bool: [u8; break 'L]| 0;\n    |                       ^^ undeclared label `'L`\n \n-error[E0268]: `break` outside of a loop\n+error[E0268]: `break` outside of a loop or labeled block\n   --> $DIR/issue-50576.rs:2:17\n    |\n LL |     |bool: [u8; break 'L]| 0;\n-   |                 ^^^^^^^^ cannot `break` outside of a loop\n+   |                 ^^^^^^^^ cannot `break` outside of a loop or labeled block\n \n-error[E0268]: `break` outside of a loop\n+error[E0268]: `break` outside of a loop or labeled block\n   --> $DIR/issue-50576.rs:5:16\n    |\n LL |     Vec::<[u8; break]>::new();\n-   |                ^^^^^ cannot `break` outside of a loop\n+   |                ^^^^^ cannot `break` outside of a loop or labeled block\n \n error: aborting due to 3 previous errors\n "}, {"sha": "07b6df072cb44faabdb42c45cfd2c8e6d2788767", "filename": "src/test/ui/issues/issue-50581.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Fissues%2Fissue-50581.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Fissues%2Fissue-50581.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-50581.stderr?ref=2f882c014f3bfabb811177d24bfb72e3f6b6d271", "patch": "@@ -1,8 +1,8 @@\n-error[E0268]: `break` outside of a loop\n+error[E0268]: `break` outside of a loop or labeled block\n   --> $DIR/issue-50581.rs:2:14\n    |\n LL |     |_: [u8; break]| ();\n-   |              ^^^^^ cannot `break` outside of a loop\n+   |              ^^^^^ cannot `break` outside of a loop or labeled block\n \n error: aborting due to previous error\n "}, {"sha": "8e4fb6eae9dff5e3ed38e65d027f1895a9d850c1", "filename": "src/test/ui/issues/issue-83048.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Fissues%2Fissue-83048.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Fissues%2Fissue-83048.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-83048.rs?ref=2f882c014f3bfabb811177d24bfb72e3f6b6d271", "patch": "@@ -1,5 +1,5 @@\n // compile-flags: -Z unpretty=thir-tree\n \n pub fn main() {\n-    break; //~ ERROR: `break` outside of a loop [E0268]\n+    break; //~ ERROR: `break` outside of a loop or labeled block [E0268]\n }"}, {"sha": "dade9e469503517c5cf7b4fa92ff9677f0b765eb", "filename": "src/test/ui/issues/issue-83048.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Fissues%2Fissue-83048.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Fissues%2Fissue-83048.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-83048.stderr?ref=2f882c014f3bfabb811177d24bfb72e3f6b6d271", "patch": "@@ -1,8 +1,8 @@\n-error[E0268]: `break` outside of a loop\n+error[E0268]: `break` outside of a loop or labeled block\n   --> $DIR/issue-83048.rs:4:5\n    |\n LL |     break;\n-   |     ^^^^^ cannot `break` outside of a loop\n+   |     ^^^^^ cannot `break` outside of a loop or labeled block\n \n error: aborting due to previous error\n "}, {"sha": "8256c1f5f0ff2d96b4e8b76d698c03dac8539b17", "filename": "src/test/ui/track-diagnostics/track.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Ftrack-diagnostics%2Ftrack.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2f882c014f3bfabb811177d24bfb72e3f6b6d271/src%2Ftest%2Fui%2Ftrack-diagnostics%2Ftrack.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftrack-diagnostics%2Ftrack.stderr?ref=2f882c014f3bfabb811177d24bfb72e3f6b6d271", "patch": "@@ -5,11 +5,11 @@ LL |     break rust\n    |           ^^^^ not found in this scope\n -Ztrack-diagnostics: created at compiler/rustc_resolve/src/late/diagnostics.rs:LL:CC\n \n-error[E0268]: `break` outside of a loop\n+error[E0268]: `break` outside of a loop or labeled block\n   --> $DIR/track.rs:LL:CC\n    |\n LL |     break rust\n-   |     ^^^^^^^^^^ cannot `break` outside of a loop\n+   |     ^^^^^^^^^^ cannot `break` outside of a loop or labeled block\n -Ztrack-diagnostics: created at compiler/rustc_passes/src/loops.rs:LL:CC\n \n error: internal compiler error: It looks like you're trying to break rust; would you like some ICE?"}]}