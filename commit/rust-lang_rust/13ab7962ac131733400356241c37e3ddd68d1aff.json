{"sha": "13ab7962ac131733400356241c37e3ddd68d1aff", "node_id": "C_kwDOAAsO6NoAKDEzYWI3OTYyYWMxMzE3MzM0MDAzNTYyNDFjMzdlM2RkZDY4ZDFhZmY", "commit": {"author": {"name": "Chris Denton", "email": "christophersdenton@gmail.com", "date": "2022-07-05T06:53:27Z"}, "committer": {"name": "Chris Denton", "email": "christophersdenton@gmail.com", "date": "2022-07-05T06:53:27Z"}, "message": "`impl From<c::WIN32_FIND_DATAW> for FileAttr`", "tree": {"sha": "ce93e6b934a899371a6e73ae12056118c3a4be63", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ce93e6b934a899371a6e73ae12056118c3a4be63"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/13ab7962ac131733400356241c37e3ddd68d1aff", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE+p/jD6jrzmnSIWJLcTRy8vRWJ94FAmLD3+cACgkQcTRy8vRW\nJ95QxxAAjYZgQ7xP+FdPEblRWsLPQu5vOuMPpQ1917ucJnG0goHhmwEFqTgL4Itd\nHFQMAZ2C/HnrADSlU91XWiTgPCrZ/DETAtcbUdvgL3dSpC9LHihO2X0HRtJL3c15\n84Bb6sRHW1xvIBrM+hjLI8gCf5XeBVKTArI4p0WrLWqo16WjqPj2/R84+aircokx\nU1o7xr4W+04hKs1LAOsdQC3v1t4rFfrpTVm3Yo+gAif8P7SJ1T0yJDFazmDDD8kI\niXc4wJwsD75DmTpzeZwyES3MesNIBcU0NabnZ+PVft5t4NXVz9Ju9mqS1aX843hL\nRaIivz7aAqWZfS6I53+FQljoD9vZ/negcALPEI+/dIvqRo7K2y76bxOuH5MilSHG\n2Wf8hQTqErzr+KXJOMZcqvhIlGQ/IuO5Nt+Wd/mwM99VC+uapgXK48u5kLv3CRcn\no5IauRUtTV1RjfWytzyc4NjrMIgFWMuD41QWR0bKaann1s1wWc/DWAAKiz+0R3+w\nGn3QJRiNzzWKw9XfVzJW3Nne3+jEg5sOVsgvvHiD/HJps+o24S/rsIc4UB2q9goA\nfWKU8MvX1qxztMRvw9wf03alpqby3QrutLjBmy1k6uw586iD9bI4DZpA7l3sZ17O\nlIq9gBeCPL+vKeMB0LKXEIP5Kjz3ofC1C7s/E7Uu1FStB4bkPN8=\n=SQwJ\n-----END PGP SIGNATURE-----", "payload": "tree ce93e6b934a899371a6e73ae12056118c3a4be63\nparent d2074cbeeceb8b28fb6249a9aa3c937fe1c0bb92\nauthor Chris Denton <christophersdenton@gmail.com> 1657004007 +0100\ncommitter Chris Denton <christophersdenton@gmail.com> 1657004007 +0100\n\n`impl From<c::WIN32_FIND_DATAW> for FileAttr`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/13ab7962ac131733400356241c37e3ddd68d1aff", "html_url": "https://github.com/rust-lang/rust/commit/13ab7962ac131733400356241c37e3ddd68d1aff", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/13ab7962ac131733400356241c37e3ddd68d1aff/comments", "author": {"login": "ChrisDenton", "id": 4459874, "node_id": "MDQ6VXNlcjQ0NTk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4459874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChrisDenton", "html_url": "https://github.com/ChrisDenton", "followers_url": "https://api.github.com/users/ChrisDenton/followers", "following_url": "https://api.github.com/users/ChrisDenton/following{/other_user}", "gists_url": "https://api.github.com/users/ChrisDenton/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChrisDenton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChrisDenton/subscriptions", "organizations_url": "https://api.github.com/users/ChrisDenton/orgs", "repos_url": "https://api.github.com/users/ChrisDenton/repos", "events_url": "https://api.github.com/users/ChrisDenton/events{/privacy}", "received_events_url": "https://api.github.com/users/ChrisDenton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ChrisDenton", "id": 4459874, "node_id": "MDQ6VXNlcjQ0NTk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4459874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChrisDenton", "html_url": "https://github.com/ChrisDenton", "followers_url": "https://api.github.com/users/ChrisDenton/followers", "following_url": "https://api.github.com/users/ChrisDenton/following{/other_user}", "gists_url": "https://api.github.com/users/ChrisDenton/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChrisDenton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChrisDenton/subscriptions", "organizations_url": "https://api.github.com/users/ChrisDenton/orgs", "repos_url": "https://api.github.com/users/ChrisDenton/repos", "events_url": "https://api.github.com/users/ChrisDenton/events{/privacy}", "received_events_url": "https://api.github.com/users/ChrisDenton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d2074cbeeceb8b28fb6249a9aa3c937fe1c0bb92", "url": "https://api.github.com/repos/rust-lang/rust/commits/d2074cbeeceb8b28fb6249a9aa3c937fe1c0bb92", "html_url": "https://github.com/rust-lang/rust/commit/d2074cbeeceb8b28fb6249a9aa3c937fe1c0bb92"}], "stats": {"total": 37, "additions": 21, "deletions": 16}, "files": [{"sha": "b5d2b4de704a34ae4569e663b73cab1d62f061cc", "filename": "library/std/src/sys/windows/fs.rs", "status": "modified", "additions": 21, "deletions": 16, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/13ab7962ac131733400356241c37e3ddd68d1aff/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/13ab7962ac131733400356241c37e3ddd68d1aff/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Ffs.rs?ref=13ab7962ac131733400356241c37e3ddd68d1aff", "patch": "@@ -155,22 +155,7 @@ impl DirEntry {\n     }\n \n     pub fn metadata(&self) -> io::Result<FileAttr> {\n-        Ok(FileAttr {\n-            attributes: self.data.dwFileAttributes,\n-            creation_time: self.data.ftCreationTime,\n-            last_access_time: self.data.ftLastAccessTime,\n-            last_write_time: self.data.ftLastWriteTime,\n-            file_size: ((self.data.nFileSizeHigh as u64) << 32) | (self.data.nFileSizeLow as u64),\n-            reparse_tag: if self.data.dwFileAttributes & c::FILE_ATTRIBUTE_REPARSE_POINT != 0 {\n-                // reserved unless this is a reparse point\n-                self.data.dwReserved0\n-            } else {\n-                0\n-            },\n-            volume_serial_number: None,\n-            number_of_links: None,\n-            file_index: None,\n-        })\n+        Ok(self.data.into())\n     }\n }\n \n@@ -879,6 +864,26 @@ impl FileAttr {\n         self.file_index\n     }\n }\n+impl From<c::WIN32_FIND_DATAW> for FileAttr {\n+    fn from(wfd: c::WIN32_FIND_DATAW) -> Self {\n+        FileAttr {\n+            attributes: wfd.dwFileAttributes,\n+            creation_time: wfd.ftCreationTime,\n+            last_access_time: wfd.ftLastAccessTime,\n+            last_write_time: wfd.ftLastWriteTime,\n+            file_size: ((wfd.nFileSizeHigh as u64) << 32) | (wfd.nFileSizeLow as u64),\n+            reparse_tag: if wfd.dwFileAttributes & c::FILE_ATTRIBUTE_REPARSE_POINT != 0 {\n+                // reserved unless this is a reparse point\n+                wfd.dwReserved0\n+            } else {\n+                0\n+            },\n+            volume_serial_number: None,\n+            number_of_links: None,\n+            file_index: None,\n+        }\n+    }\n+}\n \n fn to_u64(ft: &c::FILETIME) -> u64 {\n     (ft.dwLowDateTime as u64) | ((ft.dwHighDateTime as u64) << 32)"}]}