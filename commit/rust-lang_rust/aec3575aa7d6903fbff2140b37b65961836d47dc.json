{"sha": "aec3575aa7d6903fbff2140b37b65961836d47dc", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFlYzM1NzVhYTdkNjkwM2ZiZmYyMTQwYjM3YjY1OTYxODM2ZDQ3ZGM=", "commit": {"author": {"name": "pierwill", "email": "pierwill@users.noreply.github.com", "date": "2020-12-21T22:17:53Z"}, "committer": {"name": "pierwill", "email": "pierwill@users.noreply.github.com", "date": "2020-12-21T22:30:50Z"}, "message": "Rename rustc_middle::lint::LintSource\n\nRename rustc_middle::lint::LintSource to rustc_middle::lint::LintLevelSource.", "tree": {"sha": "360596052815a34b86ebfba8bfa426f4f17e8257", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/360596052815a34b86ebfba8bfa426f4f17e8257"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/aec3575aa7d6903fbff2140b37b65961836d47dc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/aec3575aa7d6903fbff2140b37b65961836d47dc", "html_url": "https://github.com/rust-lang/rust/commit/aec3575aa7d6903fbff2140b37b65961836d47dc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/aec3575aa7d6903fbff2140b37b65961836d47dc/comments", "author": {"login": "pierwill", "id": 19642016, "node_id": "MDQ6VXNlcjE5NjQyMDE2", "avatar_url": "https://avatars.githubusercontent.com/u/19642016?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pierwill", "html_url": "https://github.com/pierwill", "followers_url": "https://api.github.com/users/pierwill/followers", "following_url": "https://api.github.com/users/pierwill/following{/other_user}", "gists_url": "https://api.github.com/users/pierwill/gists{/gist_id}", "starred_url": "https://api.github.com/users/pierwill/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pierwill/subscriptions", "organizations_url": "https://api.github.com/users/pierwill/orgs", "repos_url": "https://api.github.com/users/pierwill/repos", "events_url": "https://api.github.com/users/pierwill/events{/privacy}", "received_events_url": "https://api.github.com/users/pierwill/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pierwill", "id": 19642016, "node_id": "MDQ6VXNlcjE5NjQyMDE2", "avatar_url": "https://avatars.githubusercontent.com/u/19642016?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pierwill", "html_url": "https://github.com/pierwill", "followers_url": "https://api.github.com/users/pierwill/followers", "following_url": "https://api.github.com/users/pierwill/following{/other_user}", "gists_url": "https://api.github.com/users/pierwill/gists{/gist_id}", "starred_url": "https://api.github.com/users/pierwill/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pierwill/subscriptions", "organizations_url": "https://api.github.com/users/pierwill/orgs", "repos_url": "https://api.github.com/users/pierwill/repos", "events_url": "https://api.github.com/users/pierwill/events{/privacy}", "received_events_url": "https://api.github.com/users/pierwill/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "11c94a197726b6a981828cb1837d7c3eed1b841d", "url": "https://api.github.com/repos/rust-lang/rust/commits/11c94a197726b6a981828cb1837d7c3eed1b841d", "html_url": "https://github.com/rust-lang/rust/commit/11c94a197726b6a981828cb1837d7c3eed1b841d"}], "stats": {"total": 64, "additions": 32, "deletions": 32}, "files": [{"sha": "410bd06850e75cdc3700a166e56546f4bd67de7d", "filename": "compiler/rustc_lint/src/levels.rs", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/aec3575aa7d6903fbff2140b37b65961836d47dc/compiler%2Frustc_lint%2Fsrc%2Flevels.rs", "raw_url": "https://github.com/rust-lang/rust/raw/aec3575aa7d6903fbff2140b37b65961836d47dc/compiler%2Frustc_lint%2Fsrc%2Flevels.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Flevels.rs?ref=aec3575aa7d6903fbff2140b37b65961836d47dc", "patch": "@@ -12,7 +12,7 @@ use rustc_hir::{intravisit, HirId};\n use rustc_middle::hir::map::Map;\n use rustc_middle::lint::LevelSource;\n use rustc_middle::lint::LintDiagnosticBuilder;\n-use rustc_middle::lint::{struct_lint_level, LintLevelMap, LintLevelSets, LintSet, LintSource};\n+use rustc_middle::lint::{struct_lint_level, LintLevelMap, LintLevelSets, LintSet, LintLevelSource};\n use rustc_middle::ty::query::Providers;\n use rustc_middle::ty::TyCtxt;\n use rustc_session::lint::{builtin, Level, Lint, LintId};\n@@ -91,7 +91,7 @@ impl<'s> LintLevelsBuilder<'s> {\n             };\n             for id in ids {\n                 self.check_gated_lint(id, DUMMY_SP);\n-                let src = LintSource::CommandLine(lint_flag_val, orig_level);\n+                let src = LintLevelSource::CommandLine(lint_flag_val, orig_level);\n                 specs.insert(id, (level, src));\n             }\n         }\n@@ -128,19 +128,19 @@ impl<'s> LintLevelsBuilder<'s> {\n                 );\n                 diag_builder.span_label(src.span(), \"overruled by previous forbid\");\n                 match old_src {\n-                    LintSource::Default => {\n+                    LintLevelSource::Default => {\n                         diag_builder.note(&format!(\n                             \"`forbid` lint level is the default for {}\",\n                             id.to_string()\n                         ));\n                     }\n-                    LintSource::Node(_, forbid_source_span, reason) => {\n+                    LintLevelSource::Node(_, forbid_source_span, reason) => {\n                         diag_builder.span_label(forbid_source_span, \"`forbid` level set here\");\n                         if let Some(rationale) = reason {\n                             diag_builder.note(&rationale.as_str());\n                         }\n                     }\n-                    LintSource::CommandLine(_, _) => {\n+                    LintLevelSource::CommandLine(_, _) => {\n                         diag_builder.note(\"`forbid` lint level was set on command line\");\n                     }\n                 }\n@@ -276,7 +276,7 @@ impl<'s> LintLevelsBuilder<'s> {\n                 let name = meta_item.path.segments.last().expect(\"empty lint name\").ident.name;\n                 match store.check_lint_name(&name.as_str(), tool_name) {\n                     CheckLintNameResult::Ok(ids) => {\n-                        let src = LintSource::Node(name, li.span(), reason);\n+                        let src = LintLevelSource::Node(name, li.span(), reason);\n                         for &id in ids {\n                             self.check_gated_lint(id, attr.span);\n                             self.insert_spec(&mut specs, id, (level, src));\n@@ -287,7 +287,7 @@ impl<'s> LintLevelsBuilder<'s> {\n                         match result {\n                             Ok(ids) => {\n                                 let complete_name = &format!(\"{}::{}\", tool_name.unwrap(), name);\n-                                let src = LintSource::Node(\n+                                let src = LintLevelSource::Node(\n                                     Symbol::intern(complete_name),\n                                     li.span(),\n                                     reason,\n@@ -324,7 +324,7 @@ impl<'s> LintLevelsBuilder<'s> {\n                                     },\n                                 );\n \n-                                let src = LintSource::Node(\n+                                let src = LintLevelSource::Node(\n                                     Symbol::intern(&new_lint_name),\n                                     li.span(),\n                                     reason,\n@@ -403,7 +403,7 @@ impl<'s> LintLevelsBuilder<'s> {\n                 }\n \n                 let (lint_attr_name, lint_attr_span) = match *src {\n-                    LintSource::Node(name, span, _) => (name, span),\n+                    LintLevelSource::Node(name, span, _) => (name, span),\n                     _ => continue,\n                 };\n \n@@ -460,7 +460,7 @@ impl<'s> LintLevelsBuilder<'s> {\n     }\n \n     /// Find the lint level for a lint.\n-    pub fn lint_level(&self, lint: &'static Lint) -> (Level, LintSource) {\n+    pub fn lint_level(&self, lint: &'static Lint) -> (Level, LintLevelSource) {\n         self.sets.get_lint_level(lint, self.cur, None, self.sess)\n     }\n "}, {"sha": "2dbb84970d10668ea16e99c30530689f951fc405", "filename": "compiler/rustc_middle/src/lint.rs", "status": "modified", "additions": 16, "deletions": 16, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/aec3575aa7d6903fbff2140b37b65961836d47dc/compiler%2Frustc_middle%2Fsrc%2Flint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/aec3575aa7d6903fbff2140b37b65961836d47dc/compiler%2Frustc_middle%2Fsrc%2Flint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Flint.rs?ref=aec3575aa7d6903fbff2140b37b65961836d47dc", "patch": "@@ -13,7 +13,7 @@ use rustc_span::{symbol, Span, Symbol, DUMMY_SP};\n \n /// How a lint level was set.\n #[derive(Clone, Copy, PartialEq, Eq, HashStable)]\n-pub enum LintSource {\n+pub enum LintLevelSource {\n     /// Lint is at the default level as declared\n     /// in rustc or a plugin.\n     Default,\n@@ -27,25 +27,25 @@ pub enum LintSource {\n     CommandLine(Symbol, Level),\n }\n \n-impl LintSource {\n+impl LintLevelSource {\n     pub fn name(&self) -> Symbol {\n         match *self {\n-            LintSource::Default => symbol::kw::Default,\n-            LintSource::Node(name, _, _) => name,\n-            LintSource::CommandLine(name, _) => name,\n+            LintLevelSource::Default => symbol::kw::Default,\n+            LintLevelSource::Node(name, _, _) => name,\n+            LintLevelSource::CommandLine(name, _) => name,\n         }\n     }\n \n     pub fn span(&self) -> Span {\n         match *self {\n-            LintSource::Default => DUMMY_SP,\n-            LintSource::Node(_, span, _) => span,\n-            LintSource::CommandLine(_, _) => DUMMY_SP,\n+            LintLevelSource::Default => DUMMY_SP,\n+            LintLevelSource::Node(_, span, _) => span,\n+            LintLevelSource::CommandLine(_, _) => DUMMY_SP,\n         }\n     }\n }\n \n-pub type LevelSource = (Level, LintSource);\n+pub type LevelSource = (Level, LintLevelSource);\n \n pub struct LintLevelSets {\n     pub list: Vec<LintSet>,\n@@ -113,7 +113,7 @@ impl LintLevelSets {\n         id: LintId,\n         mut idx: u32,\n         aux: Option<&FxHashMap<LintId, LevelSource>>,\n-    ) -> (Option<Level>, LintSource) {\n+    ) -> (Option<Level>, LintLevelSource) {\n         if let Some(specs) = aux {\n             if let Some(&(level, src)) = specs.get(&id) {\n                 return (Some(level), src);\n@@ -125,7 +125,7 @@ impl LintLevelSets {\n                     if let Some(&(level, src)) = specs.get(&id) {\n                         return (Some(level), src);\n                     }\n-                    return (None, LintSource::Default);\n+                    return (None, LintLevelSource::Default);\n                 }\n                 LintSet::Node { ref specs, parent } => {\n                     if let Some(&(level, src)) = specs.get(&id) {\n@@ -213,7 +213,7 @@ pub fn struct_lint_level<'s, 'd>(\n     sess: &'s Session,\n     lint: &'static Lint,\n     level: Level,\n-    src: LintSource,\n+    src: LintLevelSource,\n     span: Option<MultiSpan>,\n     decorate: impl for<'a> FnOnce(LintDiagnosticBuilder<'a>) + 'd,\n ) {\n@@ -223,7 +223,7 @@ pub fn struct_lint_level<'s, 'd>(\n         sess: &'s Session,\n         lint: &'static Lint,\n         level: Level,\n-        src: LintSource,\n+        src: LintLevelSource,\n         span: Option<MultiSpan>,\n         decorate: Box<dyn for<'b> FnOnce(LintDiagnosticBuilder<'b>) + 'd>,\n     ) {\n@@ -274,14 +274,14 @@ pub fn struct_lint_level<'s, 'd>(\n \n         let name = lint.name_lower();\n         match src {\n-            LintSource::Default => {\n+            LintLevelSource::Default => {\n                 sess.diag_note_once(\n                     &mut err,\n                     DiagnosticMessageId::from(lint),\n                     &format!(\"`#[{}({})]` on by default\", level.as_str(), name),\n                 );\n             }\n-            LintSource::CommandLine(lint_flag_val, orig_level) => {\n+            LintLevelSource::CommandLine(lint_flag_val, orig_level) => {\n                 let flag = match orig_level {\n                     Level::Warn => \"-W\",\n                     Level::Deny => \"-D\",\n@@ -310,7 +310,7 @@ pub fn struct_lint_level<'s, 'd>(\n                     );\n                 }\n             }\n-            LintSource::Node(lint_attr_name, src, reason) => {\n+            LintLevelSource::Node(lint_attr_name, src, reason) => {\n                 if let Some(rationale) = reason {\n                     err.note(&rationale.as_str());\n                 }"}, {"sha": "9b944f202a9376ad6dce3a9300edfe1db4830e51", "filename": "compiler/rustc_middle/src/ty/context.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/aec3575aa7d6903fbff2140b37b65961836d47dc/compiler%2Frustc_middle%2Fsrc%2Fty%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/aec3575aa7d6903fbff2140b37b65961836d47dc/compiler%2Frustc_middle%2Fsrc%2Fty%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Fcontext.rs?ref=aec3575aa7d6903fbff2140b37b65961836d47dc", "patch": "@@ -5,7 +5,7 @@ use crate::dep_graph::{self, DepGraph, DepKind, DepNode, DepNodeExt};\n use crate::hir::exports::ExportMap;\n use crate::ich::{NodeIdHashingMode, StableHashingContext};\n use crate::infer::canonical::{Canonical, CanonicalVarInfo, CanonicalVarInfos};\n-use crate::lint::{struct_lint_level, LintDiagnosticBuilder, LintSource};\n+use crate::lint::{struct_lint_level, LintDiagnosticBuilder, LintLevelSource};\n use crate::middle;\n use crate::middle::cstore::{CrateStoreDyn, EncodedMetadata};\n use crate::middle::resolve_lifetime::{self, ObjectLifetimeDefault};\n@@ -2559,7 +2559,7 @@ impl<'tcx> TyCtxt<'tcx> {\n         self,\n         lint: &'static Lint,\n         mut id: hir::HirId,\n-    ) -> (Level, LintSource) {\n+    ) -> (Level, LintLevelSource) {\n         let sets = self.lint_levels(LOCAL_CRATE);\n         loop {\n             if let Some(pair) = sets.level_and_source(lint, id, self.sess) {"}, {"sha": "af5121d6b1be79f32742be194912e3c9df2b5dce", "filename": "src/librustdoc/passes/calculate_doc_coverage.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/aec3575aa7d6903fbff2140b37b65961836d47dc/src%2Flibrustdoc%2Fpasses%2Fcalculate_doc_coverage.rs", "raw_url": "https://github.com/rust-lang/rust/raw/aec3575aa7d6903fbff2140b37b65961836d47dc/src%2Flibrustdoc%2Fpasses%2Fcalculate_doc_coverage.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcalculate_doc_coverage.rs?ref=aec3575aa7d6903fbff2140b37b65961836d47dc", "patch": "@@ -5,7 +5,7 @@ use crate::html::markdown::{find_testable_code, ErrorCodes};\n use crate::passes::doc_test_lints::{should_have_doc_example, Tests};\n use crate::passes::Pass;\n use rustc_lint::builtin::MISSING_DOCS;\n-use rustc_middle::lint::LintSource;\n+use rustc_middle::lint::LintLevelSource;\n use rustc_session::lint;\n use rustc_span::symbol::sym;\n use rustc_span::FileName;\n@@ -254,7 +254,7 @@ impl<'a, 'b> fold::DocFolder for CoverageCalculator<'a, 'b> {\n                 // `missing_docs` is allow-by-default, so don't treat this as ignoring the item\n                 // unless the user had an explicit `allow`\n                 let should_have_docs =\n-                    level != lint::Level::Allow || matches!(source, LintSource::Default);\n+                    level != lint::Level::Allow || matches!(source, LintLevelSource::Default);\n                 debug!(\"counting {:?} {:?} in {}\", i.type_(), i.name, filename);\n                 self.items.entry(filename).or_default().count_item(\n                     has_docs,"}, {"sha": "17d2847913d4b76dec4b3eb87f856a41a01b594d", "filename": "src/librustdoc/passes/doc_test_lints.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/aec3575aa7d6903fbff2140b37b65961836d47dc/src%2Flibrustdoc%2Fpasses%2Fdoc_test_lints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/aec3575aa7d6903fbff2140b37b65961836d47dc/src%2Flibrustdoc%2Fpasses%2Fdoc_test_lints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fdoc_test_lints.rs?ref=aec3575aa7d6903fbff2140b37b65961836d47dc", "patch": "@@ -9,7 +9,7 @@ use crate::clean::*;\n use crate::core::DocContext;\n use crate::fold::DocFolder;\n use crate::html::markdown::{find_testable_code, ErrorCodes, Ignore, LangString};\n-use rustc_middle::lint::LintSource;\n+use rustc_middle::lint::LintLevelSource;\n use rustc_session::lint;\n \n crate const CHECK_PRIVATE_ITEMS_DOC_TESTS: Pass = Pass {\n@@ -77,7 +77,7 @@ crate fn should_have_doc_example(cx: &DocContext<'_>, item: &clean::Item) -> boo\n     let hir_id = cx.tcx.hir().local_def_id_to_hir_id(item.def_id.expect_local());\n     let (level, source) =\n         cx.tcx.lint_level_at_node(lint::builtin::MISSING_DOC_CODE_EXAMPLES, hir_id);\n-    level != lint::Level::Allow || matches!(source, LintSource::Default)\n+    level != lint::Level::Allow || matches!(source, LintLevelSource::Default)\n }\n \n crate fn look_for_tests<'tcx>(cx: &DocContext<'tcx>, dox: &str, item: &Item) {"}]}