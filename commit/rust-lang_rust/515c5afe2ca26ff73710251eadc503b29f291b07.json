{"sha": "515c5afe2ca26ff73710251eadc503b29f291b07", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUxNWM1YWZlMmNhMjZmZjczNzEwMjUxZWFkYzUwM2IyOWYyOTFiMDc=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-06-05T17:41:40Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-06-05T17:41:40Z"}, "message": "Rollup merge of #85501 - jyn514:invalid-doc-attrs, r=varkor\n\nFix `deny(invalid_doc_attributes)`\n\nFixes https://github.com/rust-lang/rust/issues/85497.", "tree": {"sha": "038e270f2c7022a9ffa24fba9a81f914d5cd68db", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/038e270f2c7022a9ffa24fba9a81f914d5cd68db"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/515c5afe2ca26ff73710251eadc503b29f291b07", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgu7dUCRBK7hj4Ov3rIwAAGAsIAI46UiMHhtn8SApNmUZ4HiIp\n/ISD+pY0nWoD8bB9OZbTn8bRVMkGASn5RnNx9xMs1MD7sdhNBq0w+7BUq+Stvu8t\npU/HQTB+lkH7fxDDB/dVEvpzPfdw0RplGAkYkkjJCItg+HOoUfHPEa55O6irpblF\nfT6aIejOA50thydQn1lS8a5gk2nDif/FI/lmaKTnWpcNrJRLmihtRUmc0qAB5Eac\nl2BezargsRFvaL6GzI0OTkMXM7TpMzKwS5nzy+duWxI/Pz7R0lJI1cjet9pl94cf\nXQw1pbwUi/6WNM5Ee/ATlgMY7bT/NXN2gp4QC2NrISG6gfP/Nx8Qxyih3IttnwQ=\n=aVNe\n-----END PGP SIGNATURE-----\n", "payload": "tree 038e270f2c7022a9ffa24fba9a81f914d5cd68db\nparent 15940767481e82594b7d1c8fb4805521e681f854\nparent 261f64358c216941e6543e43f9ea33efa7a35ab3\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1622914900 +0200\ncommitter GitHub <noreply@github.com> 1622914900 +0200\n\nRollup merge of #85501 - jyn514:invalid-doc-attrs, r=varkor\n\nFix `deny(invalid_doc_attributes)`\n\nFixes https://github.com/rust-lang/rust/issues/85497.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/515c5afe2ca26ff73710251eadc503b29f291b07", "html_url": "https://github.com/rust-lang/rust/commit/515c5afe2ca26ff73710251eadc503b29f291b07", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/515c5afe2ca26ff73710251eadc503b29f291b07/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "15940767481e82594b7d1c8fb4805521e681f854", "url": "https://api.github.com/repos/rust-lang/rust/commits/15940767481e82594b7d1c8fb4805521e681f854", "html_url": "https://github.com/rust-lang/rust/commit/15940767481e82594b7d1c8fb4805521e681f854"}, {"sha": "261f64358c216941e6543e43f9ea33efa7a35ab3", "url": "https://api.github.com/repos/rust-lang/rust/commits/261f64358c216941e6543e43f9ea33efa7a35ab3", "html_url": "https://github.com/rust-lang/rust/commit/261f64358c216941e6543e43f9ea33efa7a35ab3"}], "stats": {"total": 50, "additions": 39, "deletions": 11}, "files": [{"sha": "352146d64635ad69f72e56cac4c6ac926174426a", "filename": "compiler/rustc_lint_defs/src/builtin.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/515c5afe2ca26ff73710251eadc503b29f291b07/compiler%2Frustc_lint_defs%2Fsrc%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/515c5afe2ca26ff73710251eadc503b29f291b07/compiler%2Frustc_lint_defs%2Fsrc%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint_defs%2Fsrc%2Fbuiltin.rs?ref=515c5afe2ca26ff73710251eadc503b29f291b07", "patch": "@@ -2994,6 +2994,7 @@ declare_lint_pass! {\n         USELESS_DEPRECATED,\n         UNSUPPORTED_NAKED_FUNCTIONS,\n         MISSING_ABI,\n+        INVALID_DOC_ATTRIBUTES,\n         SEMICOLON_IN_EXPRESSIONS_FROM_MACROS,\n         DISJOINT_CAPTURE_MIGRATION,\n         LEGACY_DERIVE_HELPERS,"}, {"sha": "c3d9c4ea7f25ae6a84d20fe1695033830311c79d", "filename": "src/librustdoc/core.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/515c5afe2ca26ff73710251eadc503b29f291b07/src%2Flibrustdoc%2Fcore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/515c5afe2ca26ff73710251eadc503b29f291b07/src%2Flibrustdoc%2Fcore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fcore.rs?ref=515c5afe2ca26ff73710251eadc503b29f291b07", "patch": "@@ -217,8 +217,9 @@ crate fn create_config(\n     // By default, rustdoc ignores all lints.\n     // Specifically unblock lints relevant to documentation or the lint machinery itself.\n     let mut lints_to_show = vec![\n-        // it's unclear whether this should be part of rustdoc directly (#77364)\n+        // it's unclear whether these should be part of rustdoc directly (#77364)\n         rustc_lint::builtin::MISSING_DOCS.name.to_string(),\n+        rustc_lint::builtin::INVALID_DOC_ATTRIBUTES.name.to_string(),\n         // these are definitely not part of rustdoc, but we want to warn on them anyway.\n         rustc_lint::builtin::RENAMED_AND_REMOVED_LINTS.name.to_string(),\n         rustc_lint::builtin::UNKNOWN_LINTS.name.to_string(),"}, {"sha": "4b58778eacd17605e54d0ce7f062c620556f3f9a", "filename": "src/test/rustdoc-ui/doc-spotlight.fixed", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/515c5afe2ca26ff73710251eadc503b29f291b07/src%2Ftest%2Frustdoc-ui%2Fdoc-spotlight.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/515c5afe2ca26ff73710251eadc503b29f291b07/src%2Ftest%2Frustdoc-ui%2Fdoc-spotlight.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fdoc-spotlight.fixed?ref=515c5afe2ca26ff73710251eadc503b29f291b07", "patch": "@@ -1,9 +1,8 @@\n-// check-pass\n // run-rustfix\n-\n+#![deny(warnings)]\n #![feature(doc_notable_trait)]\n \n #[doc(notable_trait)]\n-//~^ WARN unknown `doc` attribute `spotlight`\n+//~^ ERROR unknown `doc` attribute `spotlight`\n //~| WARN this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n trait MyTrait {}"}, {"sha": "16e387245802b128364f52c61b7091844c823e30", "filename": "src/test/rustdoc-ui/doc-spotlight.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/515c5afe2ca26ff73710251eadc503b29f291b07/src%2Ftest%2Frustdoc-ui%2Fdoc-spotlight.rs", "raw_url": "https://github.com/rust-lang/rust/raw/515c5afe2ca26ff73710251eadc503b29f291b07/src%2Ftest%2Frustdoc-ui%2Fdoc-spotlight.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fdoc-spotlight.rs?ref=515c5afe2ca26ff73710251eadc503b29f291b07", "patch": "@@ -1,9 +1,8 @@\n-// check-pass\n // run-rustfix\n-\n+#![deny(warnings)]\n #![feature(doc_notable_trait)]\n \n #[doc(spotlight)]\n-//~^ WARN unknown `doc` attribute `spotlight`\n+//~^ ERROR unknown `doc` attribute `spotlight`\n //~| WARN this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n trait MyTrait {}"}, {"sha": "8e7831139a86058f75e249c1215c3968ac5515b8", "filename": "src/test/rustdoc-ui/doc-spotlight.stderr", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/515c5afe2ca26ff73710251eadc503b29f291b07/src%2Ftest%2Frustdoc-ui%2Fdoc-spotlight.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/515c5afe2ca26ff73710251eadc503b29f291b07/src%2Ftest%2Frustdoc-ui%2Fdoc-spotlight.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fdoc-spotlight.stderr?ref=515c5afe2ca26ff73710251eadc503b29f291b07", "patch": "@@ -1,14 +1,19 @@\n-warning: unknown `doc` attribute `spotlight`\n-  --> $DIR/doc-spotlight.rs:6:7\n+error: unknown `doc` attribute `spotlight`\n+  --> $DIR/doc-spotlight.rs:5:7\n    |\n LL | #[doc(spotlight)]\n    |       ^^^^^^^^^ help: use `notable_trait` instead\n    |\n-   = note: `#[warn(invalid_doc_attributes)]` on by default\n+note: the lint level is defined here\n+  --> $DIR/doc-spotlight.rs:2:9\n+   |\n+LL | #![deny(warnings)]\n+   |         ^^^^^^^^\n+   = note: `#[deny(invalid_doc_attributes)]` implied by `#[deny(warnings)]`\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n    = note: for more information, see issue #82730 <https://github.com/rust-lang/rust/issues/82730>\n    = note: `doc(spotlight)` was renamed to `doc(notable_trait)`\n    = note: `doc(spotlight)` is now a no-op\n \n-warning: 1 warning emitted\n+error: aborting due to previous error\n "}, {"sha": "02e9c67915f154e799e477dcff90389c4638f9b8", "filename": "src/test/ui/rustdoc/deny-invalid-doc-attrs.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/515c5afe2ca26ff73710251eadc503b29f291b07/src%2Ftest%2Fui%2Frustdoc%2Fdeny-invalid-doc-attrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/515c5afe2ca26ff73710251eadc503b29f291b07/src%2Ftest%2Fui%2Frustdoc%2Fdeny-invalid-doc-attrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frustdoc%2Fdeny-invalid-doc-attrs.rs?ref=515c5afe2ca26ff73710251eadc503b29f291b07", "patch": "@@ -0,0 +1,7 @@\n+#![deny(invalid_doc_attributes)]\n+//~^ NOTE defined here\n+#![doc(x)]\n+//~^ ERROR unknown `doc` attribute `x`\n+//~| WARNING will become a hard error\n+//~| NOTE see issue #82730\n+fn main() {}"}, {"sha": "a14ab8fe4bc045b791e19d819b77c7f9b3554c96", "filename": "src/test/ui/rustdoc/deny-invalid-doc-attrs.stderr", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/515c5afe2ca26ff73710251eadc503b29f291b07/src%2Ftest%2Fui%2Frustdoc%2Fdeny-invalid-doc-attrs.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/515c5afe2ca26ff73710251eadc503b29f291b07/src%2Ftest%2Fui%2Frustdoc%2Fdeny-invalid-doc-attrs.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frustdoc%2Fdeny-invalid-doc-attrs.stderr?ref=515c5afe2ca26ff73710251eadc503b29f291b07", "patch": "@@ -0,0 +1,16 @@\n+error: unknown `doc` attribute `x`\n+  --> $DIR/deny-invalid-doc-attrs.rs:3:8\n+   |\n+LL | #![doc(x)]\n+   |        ^\n+   |\n+note: the lint level is defined here\n+  --> $DIR/deny-invalid-doc-attrs.rs:1:9\n+   |\n+LL | #![deny(invalid_doc_attributes)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^\n+   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n+   = note: for more information, see issue #82730 <https://github.com/rust-lang/rust/issues/82730>\n+\n+error: aborting due to previous error\n+"}]}