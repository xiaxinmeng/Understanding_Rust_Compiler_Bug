{"sha": "31561b118f1a57c9c1c5145493c5fcd3dd40876e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjMxNTYxYjExOGYxYTU3YzljMWM1MTQ1NDkzYzVmY2QzZGQ0MDg3NmU=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2019-10-10T10:03:20Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2019-10-10T10:18:42Z"}, "message": "if completion does auto-insertion, indicate this in the label", "tree": {"sha": "7952b096410ddb74a9ba70b3305902106d969838", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7952b096410ddb74a9ba70b3305902106d969838"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/31561b118f1a57c9c1c5145493c5fcd3dd40876e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/31561b118f1a57c9c1c5145493c5fcd3dd40876e", "html_url": "https://github.com/rust-lang/rust/commit/31561b118f1a57c9c1c5145493c5fcd3dd40876e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/31561b118f1a57c9c1c5145493c5fcd3dd40876e/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "793f7e69f298ccb14936a33c59d7df1527b39af6", "url": "https://api.github.com/repos/rust-lang/rust/commits/793f7e69f298ccb14936a33c59d7df1527b39af6", "html_url": "https://github.com/rust-lang/rust/commit/793f7e69f298ccb14936a33c59d7df1527b39af6"}], "stats": {"total": 1037, "additions": 562, "deletions": 475}, "files": [{"sha": "86c11a2834906492a66bf422ef7b28aa57a439aa", "filename": "crates/ra_ide_api/src/completion/complete_dot.rs", "status": "modified", "additions": 96, "deletions": 89, "changes": 185, "blob_url": "https://github.com/rust-lang/rust/blob/31561b118f1a57c9c1c5145493c5fcd3dd40876e/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_dot.rs", "raw_url": "https://github.com/rust-lang/rust/raw/31561b118f1a57c9c1c5145493c5fcd3dd40876e/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_dot.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_dot.rs?ref=31561b118f1a57c9c1c5145493c5fcd3dd40876e", "patch": "@@ -119,27 +119,28 @@ mod tests {\n             \",\n         ),\n         @r###\"\n-       \u22ee[\n-       \u22ee    CompletionItem {\n-       \u22ee        label: \"foo\",\n-       \u22ee        source_range: [187; 187),\n-       \u22ee        delete: [187; 187),\n-       \u22ee        insert: \"foo()$0\",\n-       \u22ee        kind: Method,\n-       \u22ee        detail: \"fn foo(self)\",\n-       \u22ee    },\n-       \u22ee    CompletionItem {\n-       \u22ee        label: \"the_field\",\n-       \u22ee        source_range: [187; 187),\n-       \u22ee        delete: [187; 187),\n-       \u22ee        insert: \"the_field\",\n-       \u22ee        kind: Field,\n-       \u22ee        detail: \"(u32,)\",\n-       \u22ee        documentation: Documentation(\n-       \u22ee            \"This is the_field\",\n-       \u22ee        ),\n-       \u22ee    },\n-       \u22ee]\n+        [\n+            CompletionItem {\n+                label: \"foo(\u2026)\",\n+                source_range: [187; 187),\n+                delete: [187; 187),\n+                insert: \"foo()$0\",\n+                kind: Method,\n+                lookup: \"foo\",\n+                detail: \"fn foo(self)\",\n+            },\n+            CompletionItem {\n+                label: \"the_field\",\n+                source_range: [187; 187),\n+                delete: [187; 187),\n+                insert: \"the_field\",\n+                kind: Field,\n+                detail: \"(u32,)\",\n+                documentation: Documentation(\n+                    \"This is the_field\",\n+                ),\n+            },\n+        ]\n         \"###\n         );\n     }\n@@ -158,24 +159,25 @@ mod tests {\n             \",\n         ),\n         @r###\"\n-       \u22ee[\n-       \u22ee    CompletionItem {\n-       \u22ee        label: \"foo\",\n-       \u22ee        source_range: [126; 126),\n-       \u22ee        delete: [126; 126),\n-       \u22ee        insert: \"foo()$0\",\n-       \u22ee        kind: Method,\n-       \u22ee        detail: \"fn foo(&self)\",\n-       \u22ee    },\n-       \u22ee    CompletionItem {\n-       \u22ee        label: \"the_field\",\n-       \u22ee        source_range: [126; 126),\n-       \u22ee        delete: [126; 126),\n-       \u22ee        insert: \"the_field\",\n-       \u22ee        kind: Field,\n-       \u22ee        detail: \"(u32, i32)\",\n-       \u22ee    },\n-       \u22ee]\n+        [\n+            CompletionItem {\n+                label: \"foo(\u2026)\",\n+                source_range: [126; 126),\n+                delete: [126; 126),\n+                insert: \"foo()$0\",\n+                kind: Method,\n+                lookup: \"foo\",\n+                detail: \"fn foo(&self)\",\n+            },\n+            CompletionItem {\n+                label: \"the_field\",\n+                source_range: [126; 126),\n+                delete: [126; 126),\n+                insert: \"the_field\",\n+                kind: Field,\n+                detail: \"(u32, i32)\",\n+            },\n+        ]\n         \"###\n         );\n     }\n@@ -210,16 +212,17 @@ mod tests {\n             \",\n         ),\n         @r###\"\n-       \u22ee[\n-       \u22ee    CompletionItem {\n-       \u22ee        label: \"the_method\",\n-       \u22ee        source_range: [144; 144),\n-       \u22ee        delete: [144; 144),\n-       \u22ee        insert: \"the_method()$0\",\n-       \u22ee        kind: Method,\n-       \u22ee        detail: \"fn the_method(&self)\",\n-       \u22ee    },\n-       \u22ee]\n+        [\n+            CompletionItem {\n+                label: \"the_method(\u2026)\",\n+                source_range: [144; 144),\n+                delete: [144; 144),\n+                insert: \"the_method()$0\",\n+                kind: Method,\n+                lookup: \"the_method\",\n+                detail: \"fn the_method(&self)\",\n+            },\n+        ]\n         \"###\n         );\n     }\n@@ -238,16 +241,17 @@ mod tests {\n             \",\n             ),\n             @r###\"\n-       \u22ee[\n-       \u22ee    CompletionItem {\n-       \u22ee        label: \"the_method\",\n-       \u22ee        source_range: [151; 151),\n-       \u22ee        delete: [151; 151),\n-       \u22ee        insert: \"the_method()$0\",\n-       \u22ee        kind: Method,\n-       \u22ee        detail: \"fn the_method(&self)\",\n-       \u22ee    },\n-       \u22ee]\n+        [\n+            CompletionItem {\n+                label: \"the_method(\u2026)\",\n+                source_range: [151; 151),\n+                delete: [151; 151),\n+                insert: \"the_method()$0\",\n+                kind: Method,\n+                lookup: \"the_method\",\n+                detail: \"fn the_method(&self)\",\n+            },\n+        ]\n         \"###\n         );\n     }\n@@ -266,16 +270,17 @@ mod tests {\n             \",\n             ),\n             @r###\"\n-       \u22ee[\n-       \u22ee    CompletionItem {\n-       \u22ee        label: \"the_method\",\n-       \u22ee        source_range: [155; 155),\n-       \u22ee        delete: [155; 155),\n-       \u22ee        insert: \"the_method()$0\",\n-       \u22ee        kind: Method,\n-       \u22ee        detail: \"fn the_method(&self)\",\n-       \u22ee    },\n-       \u22ee]\n+        [\n+            CompletionItem {\n+                label: \"the_method(\u2026)\",\n+                source_range: [155; 155),\n+                delete: [155; 155),\n+                insert: \"the_method()$0\",\n+                kind: Method,\n+                lookup: \"the_method\",\n+                detail: \"fn the_method(&self)\",\n+            },\n+        ]\n         \"###\n         );\n     }\n@@ -317,16 +322,17 @@ mod tests {\n             \",\n         ),\n         @r###\"\n-       \u22ee[\n-       \u22ee    CompletionItem {\n-       \u22ee        label: \"the_method\",\n-       \u22ee        source_range: [249; 249),\n-       \u22ee        delete: [249; 249),\n-       \u22ee        insert: \"the_method()$0\",\n-       \u22ee        kind: Method,\n-       \u22ee        detail: \"fn the_method(&self)\",\n-       \u22ee    },\n-       \u22ee]\n+        [\n+            CompletionItem {\n+                label: \"the_method(\u2026)\",\n+                source_range: [249; 249),\n+                delete: [249; 249),\n+                insert: \"the_method()$0\",\n+                kind: Method,\n+                lookup: \"the_method\",\n+                detail: \"fn the_method(&self)\",\n+            },\n+        ]\n         \"###\n         );\n     }\n@@ -386,16 +392,17 @@ mod tests {\n             \",\n         ),\n         @r###\"\n-       \u22ee[\n-       \u22ee    CompletionItem {\n-       \u22ee        label: \"blah\",\n-       \u22ee        source_range: [299; 300),\n-       \u22ee        delete: [299; 300),\n-       \u22ee        insert: \"blah()$0\",\n-       \u22ee        kind: Method,\n-       \u22ee        detail: \"pub fn blah(&self)\",\n-       \u22ee    },\n-       \u22ee]\n+        [\n+            CompletionItem {\n+                label: \"blah(\u2026)\",\n+                source_range: [299; 300),\n+                delete: [299; 300),\n+                insert: \"blah()$0\",\n+                kind: Method,\n+                lookup: \"blah\",\n+                detail: \"pub fn blah(&self)\",\n+            },\n+        ]\n         \"###\n         );\n     }"}, {"sha": "b5e8bf591610dc7fe381f4ef7077ecc63ebf761e", "filename": "crates/ra_ide_api/src/completion/complete_path.rs", "status": "modified", "additions": 91, "deletions": 75, "changes": 166, "blob_url": "https://github.com/rust-lang/rust/blob/31561b118f1a57c9c1c5145493c5fcd3dd40876e/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_path.rs", "raw_url": "https://github.com/rust-lang/rust/raw/31561b118f1a57c9c1c5145493c5fcd3dd40876e/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_path.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_path.rs?ref=31561b118f1a57c9c1c5145493c5fcd3dd40876e", "patch": "@@ -375,19 +375,22 @@ mod tests {\n                 fn foo() { let _ = S::<|> }\n                 \"\n             ),\n-            @r###\"[\n-    CompletionItem {\n-        label: \"m\",\n-        source_range: [100; 100),\n-        delete: [100; 100),\n-        insert: \"m()$0\",\n-        kind: Function,\n-        detail: \"fn m()\",\n-        documentation: Documentation(\n-            \"An associated method\",\n-        ),\n-    },\n-]\"###\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"m(\u2026)\",\n+                source_range: [100; 100),\n+                delete: [100; 100),\n+                insert: \"m()$0\",\n+                kind: Function,\n+                lookup: \"m\",\n+                detail: \"fn m()\",\n+                documentation: Documentation(\n+                    \"An associated method\",\n+                ),\n+            },\n+        ]\n+        \"###\n         );\n     }\n \n@@ -474,19 +477,22 @@ mod tests {\n                 fn foo() { let _ = S::<|> }\n                 \"\n             ),\n-            @r###\"[\n-    CompletionItem {\n-        label: \"m\",\n-        source_range: [100; 100),\n-        delete: [100; 100),\n-        insert: \"m()$0\",\n-        kind: Function,\n-        detail: \"fn m()\",\n-        documentation: Documentation(\n-            \"An associated method\",\n-        ),\n-    },\n-]\"###\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"m(\u2026)\",\n+                source_range: [100; 100),\n+                delete: [100; 100),\n+                insert: \"m()$0\",\n+                kind: Function,\n+                lookup: \"m\",\n+                detail: \"fn m()\",\n+                documentation: Documentation(\n+                    \"An associated method\",\n+                ),\n+            },\n+        ]\n+        \"###\n         );\n     }\n \n@@ -507,19 +513,22 @@ mod tests {\n                 fn foo() { let _ = U::<|> }\n                 \"\n             ),\n-            @r###\"[\n-    CompletionItem {\n-        label: \"m\",\n-        source_range: [101; 101),\n-        delete: [101; 101),\n-        insert: \"m()$0\",\n-        kind: Function,\n-        detail: \"fn m()\",\n-        documentation: Documentation(\n-            \"An associated method\",\n-        ),\n-    },\n-]\"###\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"m(\u2026)\",\n+                source_range: [101; 101),\n+                delete: [101; 101),\n+                insert: \"m()$0\",\n+                kind: Function,\n+                lookup: \"m\",\n+                detail: \"fn m()\",\n+                documentation: Documentation(\n+                    \"An associated method\",\n+                ),\n+            },\n+        ]\n+        \"###\n         );\n     }\n \n@@ -564,24 +573,28 @@ mod tests {\n                 }\n                 \"\n             ),\n-            @r###\"[\n-    CompletionItem {\n-        label: \"bar\",\n-        source_range: [185; 185),\n-        delete: [185; 185),\n-        insert: \"bar()$0\",\n-        kind: Function,\n-        detail: \"fn bar()\",\n-    },\n-    CompletionItem {\n-        label: \"foo\",\n-        source_range: [185; 185),\n-        delete: [185; 185),\n-        insert: \"foo()$0\",\n-        kind: Function,\n-        detail: \"fn foo()\",\n-    },\n-]\"###\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"bar(\u2026)\",\n+                source_range: [185; 185),\n+                delete: [185; 185),\n+                insert: \"bar()$0\",\n+                kind: Function,\n+                lookup: \"bar\",\n+                detail: \"fn bar()\",\n+            },\n+            CompletionItem {\n+                label: \"foo(\u2026)\",\n+                source_range: [185; 185),\n+                delete: [185; 185),\n+                insert: \"foo()$0\",\n+                kind: Function,\n+                lookup: \"foo\",\n+                detail: \"fn foo()\",\n+            },\n+        ]\n+        \"###\n         );\n     }\n \n@@ -600,24 +613,27 @@ mod tests {\n                 }\n                 \"\n             ),\n-            @r###\"[\n-    CompletionItem {\n-        label: \"foo!\",\n-        source_range: [179; 179),\n-        delete: [179; 179),\n-        insert: \"foo!($0)\",\n-        kind: Macro,\n-        detail: \"#[macro_export]\\nmacro_rules! foo\",\n-    },\n-    CompletionItem {\n-        label: \"main\",\n-        source_range: [179; 179),\n-        delete: [179; 179),\n-        insert: \"main()$0\",\n-        kind: Function,\n-        detail: \"fn main()\",\n-    },\n-]\"###\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"foo!\",\n+                source_range: [179; 179),\n+                delete: [179; 179),\n+                insert: \"foo!($0)\",\n+                kind: Macro,\n+                detail: \"#[macro_export]\\nmacro_rules! foo\",\n+            },\n+            CompletionItem {\n+                label: \"main(\u2026)\",\n+                source_range: [179; 179),\n+                delete: [179; 179),\n+                insert: \"main()$0\",\n+                kind: Function,\n+                lookup: \"main\",\n+                detail: \"fn main()\",\n+            },\n+        ]\n+        \"###\n         );\n     }\n }"}, {"sha": "b64540365479ae46a56cdafb336f1a48c5cbc247", "filename": "crates/ra_ide_api/src/completion/complete_scope.rs", "status": "modified", "additions": 285, "deletions": 249, "changes": 534, "blob_url": "https://github.com/rust-lang/rust/blob/31561b118f1a57c9c1c5145493c5fcd3dd40876e/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_scope.rs", "raw_url": "https://github.com/rust-lang/rust/raw/31561b118f1a57c9c1c5145493c5fcd3dd40876e/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_scope.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_scope.rs?ref=31561b118f1a57c9c1c5145493c5fcd3dd40876e", "patch": "@@ -145,32 +145,35 @@ mod tests {\n                 }\n                 \"\n             ),\n-            @r###\"[\n-    CompletionItem {\n-        label: \"quux\",\n-        source_range: [91; 91),\n-        delete: [91; 91),\n-        insert: \"quux($0)\",\n-        kind: Function,\n-        detail: \"fn quux(x: i32)\",\n-    },\n-    CompletionItem {\n-        label: \"x\",\n-        source_range: [91; 91),\n-        delete: [91; 91),\n-        insert: \"x\",\n-        kind: Binding,\n-        detail: \"i32\",\n-    },\n-    CompletionItem {\n-        label: \"y\",\n-        source_range: [91; 91),\n-        delete: [91; 91),\n-        insert: \"y\",\n-        kind: Binding,\n-        detail: \"i32\",\n-    },\n-]\"###\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"quux(\u2026)\",\n+                source_range: [91; 91),\n+                delete: [91; 91),\n+                insert: \"quux($0)\",\n+                kind: Function,\n+                lookup: \"quux\",\n+                detail: \"fn quux(x: i32)\",\n+            },\n+            CompletionItem {\n+                label: \"x\",\n+                source_range: [91; 91),\n+                delete: [91; 91),\n+                insert: \"x\",\n+                kind: Binding,\n+                detail: \"i32\",\n+            },\n+            CompletionItem {\n+                label: \"y\",\n+                source_range: [91; 91),\n+                delete: [91; 91),\n+                insert: \"y\",\n+                kind: Binding,\n+                detail: \"i32\",\n+            },\n+        ]\n+        \"###\n         );\n     }\n \n@@ -190,31 +193,34 @@ mod tests {\n                 }\n                 \"\n             ),\n-            @r###\"[\n-    CompletionItem {\n-        label: \"a\",\n-        source_range: [242; 242),\n-        delete: [242; 242),\n-        insert: \"a\",\n-        kind: Binding,\n-    },\n-    CompletionItem {\n-        label: \"b\",\n-        source_range: [242; 242),\n-        delete: [242; 242),\n-        insert: \"b\",\n-        kind: Binding,\n-        detail: \"i32\",\n-    },\n-    CompletionItem {\n-        label: \"quux\",\n-        source_range: [242; 242),\n-        delete: [242; 242),\n-        insert: \"quux()$0\",\n-        kind: Function,\n-        detail: \"fn quux()\",\n-    },\n-]\"###\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"a\",\n+                source_range: [242; 242),\n+                delete: [242; 242),\n+                insert: \"a\",\n+                kind: Binding,\n+            },\n+            CompletionItem {\n+                label: \"b\",\n+                source_range: [242; 242),\n+                delete: [242; 242),\n+                insert: \"b\",\n+                kind: Binding,\n+                detail: \"i32\",\n+            },\n+            CompletionItem {\n+                label: \"quux(\u2026)\",\n+                source_range: [242; 242),\n+                delete: [242; 242),\n+                insert: \"quux()$0\",\n+                kind: Function,\n+                lookup: \"quux\",\n+                detail: \"fn quux()\",\n+            },\n+        ]\n+        \"###\n         );\n     }\n \n@@ -230,23 +236,26 @@ mod tests {\n                 }\n                 \"\n             ),\n-            @r###\"[\n-    CompletionItem {\n-        label: \"quux\",\n-        source_range: [95; 95),\n-        delete: [95; 95),\n-        insert: \"quux()$0\",\n-        kind: Function,\n-        detail: \"fn quux()\",\n-    },\n-    CompletionItem {\n-        label: \"x\",\n-        source_range: [95; 95),\n-        delete: [95; 95),\n-        insert: \"x\",\n-        kind: Binding,\n-    },\n-]\"###\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"quux(\u2026)\",\n+                source_range: [95; 95),\n+                delete: [95; 95),\n+                insert: \"quux()$0\",\n+                kind: Function,\n+                lookup: \"quux\",\n+                detail: \"fn quux()\",\n+            },\n+            CompletionItem {\n+                label: \"x\",\n+                source_range: [95; 95),\n+                delete: [95; 95),\n+                insert: \"x\",\n+                kind: Binding,\n+            },\n+        ]\n+        \"###\n         );\n     }\n \n@@ -260,23 +269,26 @@ mod tests {\n                 }\n                 \"\n             ),\n-            @r###\"[\n-    CompletionItem {\n-        label: \"T\",\n-        source_range: [52; 52),\n-        delete: [52; 52),\n-        insert: \"T\",\n-        kind: TypeParam,\n-    },\n-    CompletionItem {\n-        label: \"quux\",\n-        source_range: [52; 52),\n-        delete: [52; 52),\n-        insert: \"quux()$0\",\n-        kind: Function,\n-        detail: \"fn quux<T>()\",\n-    },\n-]\"###\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"T\",\n+                source_range: [52; 52),\n+                delete: [52; 52),\n+                insert: \"T\",\n+                kind: TypeParam,\n+            },\n+            CompletionItem {\n+                label: \"quux(\u2026)\",\n+                source_range: [52; 52),\n+                delete: [52; 52),\n+                insert: \"quux()$0\",\n+                kind: Function,\n+                lookup: \"quux\",\n+                detail: \"fn quux<T>()\",\n+            },\n+        ]\n+        \"###\n         );\n     }\n \n@@ -300,11 +312,12 @@ mod tests {\n                 kind: TypeParam,\n             },\n             CompletionItem {\n-                label: \"X\",\n+                label: \"X<\u2026>\",\n                 source_range: [54; 54),\n                 delete: [54; 54),\n                 insert: \"X<$0>\",\n                 kind: Struct,\n+                lookup: \"X\",\n             },\n         ]\n         \"###\n@@ -354,30 +367,33 @@ mod tests {\n                 }\n                 \"\n         ),\n-        @r###\"[\n-    CompletionItem {\n-        label: \"Baz\",\n-        source_range: [105; 105),\n-        delete: [105; 105),\n-        insert: \"Baz\",\n-        kind: Enum,\n-    },\n-    CompletionItem {\n-        label: \"Foo\",\n-        source_range: [105; 105),\n-        delete: [105; 105),\n-        insert: \"Foo\",\n-        kind: Struct,\n-    },\n-    CompletionItem {\n-        label: \"quux\",\n-        source_range: [105; 105),\n-        delete: [105; 105),\n-        insert: \"quux()$0\",\n-        kind: Function,\n-        detail: \"fn quux()\",\n-    },\n-]\"###\n+        @r###\"\n+        [\n+            CompletionItem {\n+                label: \"Baz\",\n+                source_range: [105; 105),\n+                delete: [105; 105),\n+                insert: \"Baz\",\n+                kind: Enum,\n+            },\n+            CompletionItem {\n+                label: \"Foo\",\n+                source_range: [105; 105),\n+                delete: [105; 105),\n+                insert: \"Foo\",\n+                kind: Struct,\n+            },\n+            CompletionItem {\n+                label: \"quux(\u2026)\",\n+                source_range: [105; 105),\n+                delete: [105; 105),\n+                insert: \"quux()$0\",\n+                kind: Function,\n+                lookup: \"quux\",\n+                detail: \"fn quux()\",\n+            },\n+        ]\n+        \"###\n             );\n     }\n \n@@ -417,23 +433,26 @@ mod tests {\n                 }\n                 \"\n             ),\n-            @r###\"[\n-    CompletionItem {\n-        label: \"Bar\",\n-        source_range: [117; 117),\n-        delete: [117; 117),\n-        insert: \"Bar\",\n-        kind: Struct,\n-    },\n-    CompletionItem {\n-        label: \"quux\",\n-        source_range: [117; 117),\n-        delete: [117; 117),\n-        insert: \"quux()$0\",\n-        kind: Function,\n-        detail: \"fn quux()\",\n-    },\n-]\"###\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"Bar\",\n+                source_range: [117; 117),\n+                delete: [117; 117),\n+                insert: \"Bar\",\n+                kind: Struct,\n+            },\n+            CompletionItem {\n+                label: \"quux(\u2026)\",\n+                source_range: [117; 117),\n+                delete: [117; 117),\n+                insert: \"quux()$0\",\n+                kind: Function,\n+                lookup: \"quux\",\n+                detail: \"fn quux()\",\n+            },\n+        ]\n+        \"###\n         );\n     }\n \n@@ -456,11 +475,12 @@ mod tests {\n                 kind: Struct,\n             },\n             CompletionItem {\n-                label: \"x\",\n+                label: \"x(\u2026)\",\n                 source_range: [55; 55),\n                 delete: [55; 55),\n                 insert: \"x()$0\",\n                 kind: Function,\n+                lookup: \"x\",\n                 detail: \"fn x()\",\n             },\n         ]\n@@ -482,24 +502,27 @@ mod tests {\n                 }\n                 \"\n             ),\n-            @r###\"[\n-    CompletionItem {\n-        label: \"bar\",\n-        source_range: [146; 146),\n-        delete: [146; 146),\n-        insert: \"bar\",\n-        kind: Binding,\n-        detail: \"i32\",\n-    },\n-    CompletionItem {\n-        label: \"foo\",\n-        source_range: [146; 146),\n-        delete: [146; 146),\n-        insert: \"foo()$0\",\n-        kind: Function,\n-        detail: \"fn foo()\",\n-    },\n-]\"###\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"bar\",\n+                source_range: [146; 146),\n+                delete: [146; 146),\n+                insert: \"bar\",\n+                kind: Binding,\n+                detail: \"i32\",\n+            },\n+            CompletionItem {\n+                label: \"foo(\u2026)\",\n+                source_range: [146; 146),\n+                delete: [146; 146),\n+                insert: \"foo()$0\",\n+                kind: Function,\n+                lookup: \"foo\",\n+                detail: \"fn foo()\",\n+            },\n+        ]\n+        \"###\n         );\n     }\n \n@@ -554,11 +577,12 @@ mod tests {\n                 kind: Struct,\n             },\n             CompletionItem {\n-                label: \"foo\",\n+                label: \"foo(\u2026)\",\n                 source_range: [18; 18),\n                 delete: [18; 18),\n                 insert: \"foo()$0\",\n                 kind: Function,\n+                lookup: \"foo\",\n                 detail: \"fn foo()\",\n             },\n             CompletionItem {\n@@ -606,54 +630,57 @@ mod tests {\n                 }\n                 \"\n             ),\n-            @r##\"[\n-    CompletionItem {\n-        label: \"bar!\",\n-        source_range: [252; 252),\n-        delete: [252; 252),\n-        insert: \"bar!($0)\",\n-        kind: Macro,\n-        detail: \"macro_rules! bar\",\n-    },\n-    CompletionItem {\n-        label: \"baz!\",\n-        source_range: [252; 252),\n-        delete: [252; 252),\n-        insert: \"baz!($0)\",\n-        kind: Macro,\n-        detail: \"#[macro_export]\\nmacro_rules! baz\",\n-    },\n-    CompletionItem {\n-        label: \"foo!\",\n-        source_range: [252; 252),\n-        delete: [252; 252),\n-        insert: \"foo!($0)\",\n-        kind: Macro,\n-        detail: \"macro_rules! foo\",\n-    },\n-    CompletionItem {\n-        label: \"m1\",\n-        source_range: [252; 252),\n-        delete: [252; 252),\n-        insert: \"m1\",\n-        kind: Module,\n-    },\n-    CompletionItem {\n-        label: \"m2\",\n-        source_range: [252; 252),\n-        delete: [252; 252),\n-        insert: \"m2\",\n-        kind: Module,\n-    },\n-    CompletionItem {\n-        label: \"main\",\n-        source_range: [252; 252),\n-        delete: [252; 252),\n-        insert: \"main()$0\",\n-        kind: Function,\n-        detail: \"fn main()\",\n-    },\n-]\"##\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"bar!\",\n+                source_range: [252; 252),\n+                delete: [252; 252),\n+                insert: \"bar!($0)\",\n+                kind: Macro,\n+                detail: \"macro_rules! bar\",\n+            },\n+            CompletionItem {\n+                label: \"baz!\",\n+                source_range: [252; 252),\n+                delete: [252; 252),\n+                insert: \"baz!($0)\",\n+                kind: Macro,\n+                detail: \"#[macro_export]\\nmacro_rules! baz\",\n+            },\n+            CompletionItem {\n+                label: \"foo!\",\n+                source_range: [252; 252),\n+                delete: [252; 252),\n+                insert: \"foo!($0)\",\n+                kind: Macro,\n+                detail: \"macro_rules! foo\",\n+            },\n+            CompletionItem {\n+                label: \"m1\",\n+                source_range: [252; 252),\n+                delete: [252; 252),\n+                insert: \"m1\",\n+                kind: Module,\n+            },\n+            CompletionItem {\n+                label: \"m2\",\n+                source_range: [252; 252),\n+                delete: [252; 252),\n+                insert: \"m2\",\n+                kind: Module,\n+            },\n+            CompletionItem {\n+                label: \"main(\u2026)\",\n+                source_range: [252; 252),\n+                delete: [252; 252),\n+                insert: \"main()$0\",\n+                kind: Function,\n+                lookup: \"main\",\n+                detail: \"fn main()\",\n+            },\n+        ]\n+        \"###\n         );\n     }\n \n@@ -672,24 +699,27 @@ mod tests {\n                 }\n                 \"\n             ),\n-            @r##\"[\n-    CompletionItem {\n-        label: \"foo\",\n-        source_range: [49; 49),\n-        delete: [49; 49),\n-        insert: \"foo()$0\",\n-        kind: Function,\n-        detail: \"fn foo()\",\n-    },\n-    CompletionItem {\n-        label: \"foo!\",\n-        source_range: [49; 49),\n-        delete: [49; 49),\n-        insert: \"foo!($0)\",\n-        kind: Macro,\n-        detail: \"macro_rules! foo\",\n-    },\n-]\"##\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"foo!\",\n+                source_range: [49; 49),\n+                delete: [49; 49),\n+                insert: \"foo!($0)\",\n+                kind: Macro,\n+                detail: \"macro_rules! foo\",\n+            },\n+            CompletionItem {\n+                label: \"foo(\u2026)\",\n+                source_range: [49; 49),\n+                delete: [49; 49),\n+                insert: \"foo()$0\",\n+                kind: Function,\n+                lookup: \"foo\",\n+                detail: \"fn foo()\",\n+            },\n+        ]\n+        \"###\n         );\n     }\n \n@@ -708,24 +738,27 @@ mod tests {\n                 }\n                 \"\n             ),\n-            @r##\"[\n-    CompletionItem {\n-        label: \"foo!\",\n-        source_range: [57; 57),\n-        delete: [57; 57),\n-        insert: \"foo!($0)\",\n-        kind: Macro,\n-        detail: \"macro_rules! foo\",\n-    },\n-    CompletionItem {\n-        label: \"main\",\n-        source_range: [57; 57),\n-        delete: [57; 57),\n-        insert: \"main()$0\",\n-        kind: Function,\n-        detail: \"fn main()\",\n-    },\n-]\"##\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"foo!\",\n+                source_range: [57; 57),\n+                delete: [57; 57),\n+                insert: \"foo!($0)\",\n+                kind: Macro,\n+                detail: \"macro_rules! foo\",\n+            },\n+            CompletionItem {\n+                label: \"main(\u2026)\",\n+                source_range: [57; 57),\n+                delete: [57; 57),\n+                insert: \"main()$0\",\n+                kind: Function,\n+                lookup: \"main\",\n+                detail: \"fn main()\",\n+            },\n+        ]\n+        \"###\n         );\n     }\n \n@@ -744,24 +777,27 @@ mod tests {\n                 }\n                 \"\n             ),\n-            @r##\"[\n-    CompletionItem {\n-        label: \"foo!\",\n-        source_range: [50; 50),\n-        delete: [50; 50),\n-        insert: \"foo!($0)\",\n-        kind: Macro,\n-        detail: \"macro_rules! foo\",\n-    },\n-    CompletionItem {\n-        label: \"main\",\n-        source_range: [50; 50),\n-        delete: [50; 50),\n-        insert: \"main()$0\",\n-        kind: Function,\n-        detail: \"fn main()\",\n-    },\n-]\"##\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"foo!\",\n+                source_range: [50; 50),\n+                delete: [50; 50),\n+                insert: \"foo!($0)\",\n+                kind: Macro,\n+                detail: \"macro_rules! foo\",\n+            },\n+            CompletionItem {\n+                label: \"main(\u2026)\",\n+                source_range: [50; 50),\n+                delete: [50; 50),\n+                insert: \"main()$0\",\n+                kind: Function,\n+                lookup: \"main\",\n+                detail: \"fn main()\",\n+            },\n+        ]\n+        \"###\n         );\n     }\n }"}, {"sha": "3e6933bc1cdc3c4d6103ed56e177603e83779195", "filename": "crates/ra_ide_api/src/completion/completion_item.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/31561b118f1a57c9c1c5145493c5fcd3dd40876e/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcompletion_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/31561b118f1a57c9c1c5145493c5fcd3dd40876e/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcompletion_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcompletion_item.rs?ref=31561b118f1a57c9c1c5145493c5fcd3dd40876e", "patch": "@@ -216,6 +216,10 @@ impl Builder {\n         self.lookup = Some(lookup.into());\n         self\n     }\n+    pub(crate) fn label(mut self, label: impl Into<String>) -> Builder {\n+        self.label = label.into();\n+        self\n+    }\n     pub(crate) fn insert_text(mut self, insert_text: impl Into<String>) -> Builder {\n         self.insert_text = Some(insert_text.into());\n         self"}, {"sha": "175a27ba971a21496437de5b3ee3736e045e2e3e", "filename": "crates/ra_ide_api/src/completion/presentation.rs", "status": "modified", "additions": 86, "deletions": 62, "changes": 148, "blob_url": "https://github.com/rust-lang/rust/blob/31561b118f1a57c9c1c5145493c5fcd3dd40876e/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fpresentation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/31561b118f1a57c9c1c5145493c5fcd3dd40876e/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fpresentation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fpresentation.rs?ref=31561b118f1a57c9c1c5145493c5fcd3dd40876e", "patch": "@@ -116,7 +116,10 @@ impl Completions {\n             if let Some(def) = generic_def {\n                 if has_non_default_type_params(def, ctx.db) {\n                     tested_by!(inserts_angle_brackets_for_generics);\n-                    completion_item = completion_item.insert_snippet(format!(\"{}<$0>\", local_name));\n+                    completion_item = completion_item\n+                        .lookup_by(local_name.clone())\n+                        .label(format!(\"{}<\u2026>\", local_name))\n+                        .insert_snippet(format!(\"{}<$0>\", local_name));\n                 }\n             }\n         }\n@@ -169,14 +172,15 @@ impl Completions {\n         let ast_node = func.source(ctx.db).ast;\n         let detail = function_label(&ast_node);\n \n-        let mut builder = CompletionItem::new(CompletionKind::Reference, ctx.source_range(), name)\n-            .kind(if data.has_self_param() {\n-                CompletionItemKind::Method\n-            } else {\n-                CompletionItemKind::Function\n-            })\n-            .set_documentation(func.docs(ctx.db))\n-            .detail(detail);\n+        let mut builder =\n+            CompletionItem::new(CompletionKind::Reference, ctx.source_range(), name.clone())\n+                .kind(if data.has_self_param() {\n+                    CompletionItemKind::Method\n+                } else {\n+                    CompletionItemKind::Function\n+                })\n+                .set_documentation(func.docs(ctx.db))\n+                .detail(detail);\n \n         // Add `<>` for generic types\n         if ctx.use_item_syntax.is_none()\n@@ -190,7 +194,10 @@ impl Completions {\n                 } else {\n                     format!(\"{}($0)\", data.name())\n                 };\n-            builder = builder.insert_snippet(snippet);\n+            builder = builder\n+                .lookup_by(name.clone())\n+                .label(format!(\"{}(\u2026)\", name))\n+                .insert_snippet(snippet);\n         }\n \n         self.add(builder)\n@@ -269,24 +276,28 @@ mod tests {\n                 fn main() { no_<|> }\n                 \"\n             ),\n-            @r###\"[\n-    CompletionItem {\n-        label: \"main\",\n-        source_range: [61; 64),\n-        delete: [61; 64),\n-        insert: \"main()$0\",\n-        kind: Function,\n-        detail: \"fn main()\",\n-    },\n-    CompletionItem {\n-        label: \"no_args\",\n-        source_range: [61; 64),\n-        delete: [61; 64),\n-        insert: \"no_args()$0\",\n-        kind: Function,\n-        detail: \"fn no_args()\",\n-    },\n-]\"###\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"main(\u2026)\",\n+                source_range: [61; 64),\n+                delete: [61; 64),\n+                insert: \"main()$0\",\n+                kind: Function,\n+                lookup: \"main\",\n+                detail: \"fn main()\",\n+            },\n+            CompletionItem {\n+                label: \"no_args(\u2026)\",\n+                source_range: [61; 64),\n+                delete: [61; 64),\n+                insert: \"no_args()$0\",\n+                kind: Function,\n+                lookup: \"no_args\",\n+                detail: \"fn no_args()\",\n+            },\n+        ]\n+        \"###\n         );\n         assert_debug_snapshot!(\n             do_reference_completion(\n@@ -295,24 +306,28 @@ mod tests {\n                 fn main() { with_<|> }\n                 \"\n             ),\n-            @r###\"[\n-    CompletionItem {\n-        label: \"main\",\n-        source_range: [80; 85),\n-        delete: [80; 85),\n-        insert: \"main()$0\",\n-        kind: Function,\n-        detail: \"fn main()\",\n-    },\n-    CompletionItem {\n-        label: \"with_args\",\n-        source_range: [80; 85),\n-        delete: [80; 85),\n-        insert: \"with_args($0)\",\n-        kind: Function,\n-        detail: \"fn with_args(x: i32, y: String)\",\n-    },\n-]\"###\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"main(\u2026)\",\n+                source_range: [80; 85),\n+                delete: [80; 85),\n+                insert: \"main()$0\",\n+                kind: Function,\n+                lookup: \"main\",\n+                detail: \"fn main()\",\n+            },\n+            CompletionItem {\n+                label: \"with_args(\u2026)\",\n+                source_range: [80; 85),\n+                delete: [80; 85),\n+                insert: \"with_args($0)\",\n+                kind: Function,\n+                lookup: \"with_args\",\n+                detail: \"fn with_args(x: i32, y: String)\",\n+            },\n+        ]\n+        \"###\n         );\n         assert_debug_snapshot!(\n             do_reference_completion(\n@@ -326,16 +341,19 @@ mod tests {\n                 }\n                 \"\n             ),\n-            @r###\"[\n-    CompletionItem {\n-        label: \"foo\",\n-        source_range: [163; 164),\n-        delete: [163; 164),\n-        insert: \"foo()$0\",\n-        kind: Method,\n-        detail: \"fn foo(&self)\",\n-    },\n-]\"###\n+            @r###\"\n+        [\n+            CompletionItem {\n+                label: \"foo(\u2026)\",\n+                source_range: [163; 164),\n+                delete: [163; 164),\n+                insert: \"foo()$0\",\n+                kind: Method,\n+                lookup: \"foo\",\n+                detail: \"fn foo(&self)\",\n+            },\n+        ]\n+        \"###\n         );\n     }\n \n@@ -430,18 +448,20 @@ mod tests {\n             @r###\"\n         [\n             CompletionItem {\n-                label: \"Vec\",\n+                label: \"Vec<\u2026>\",\n                 source_range: [61; 63),\n                 delete: [61; 63),\n                 insert: \"Vec<$0>\",\n                 kind: Struct,\n+                lookup: \"Vec\",\n             },\n             CompletionItem {\n-                label: \"foo\",\n+                label: \"foo(\u2026)\",\n                 source_range: [61; 63),\n                 delete: [61; 63),\n                 insert: \"foo($0)\",\n                 kind: Function,\n+                lookup: \"foo\",\n                 detail: \"fn foo(xs: Ve)\",\n             },\n         ]\n@@ -457,18 +477,20 @@ mod tests {\n             @r###\"\n         [\n             CompletionItem {\n-                label: \"Vec\",\n+                label: \"Vec<\u2026>\",\n                 source_range: [64; 66),\n                 delete: [64; 66),\n                 insert: \"Vec<$0>\",\n                 kind: TypeAlias,\n+                lookup: \"Vec\",\n             },\n             CompletionItem {\n-                label: \"foo\",\n+                label: \"foo(\u2026)\",\n                 source_range: [64; 66),\n                 delete: [64; 66),\n                 insert: \"foo($0)\",\n                 kind: Function,\n+                lookup: \"foo\",\n                 detail: \"fn foo(xs: Ve)\",\n             },\n         ]\n@@ -491,11 +513,12 @@ mod tests {\n                 kind: Struct,\n             },\n             CompletionItem {\n-                label: \"foo\",\n+                label: \"foo(\u2026)\",\n                 source_range: [68; 70),\n                 delete: [68; 70),\n                 insert: \"foo($0)\",\n                 kind: Function,\n+                lookup: \"foo\",\n                 detail: \"fn foo(xs: Ve)\",\n             },\n         ]\n@@ -518,11 +541,12 @@ mod tests {\n                 kind: Struct,\n             },\n             CompletionItem {\n-                label: \"foo\",\n+                label: \"foo(\u2026)\",\n                 source_range: [61; 63),\n                 delete: [61; 63),\n                 insert: \"foo($0)\",\n                 kind: Function,\n+                lookup: \"foo\",\n                 detail: \"fn foo(xs: Ve<i128>)\",\n             },\n         ]"}]}