{"sha": "23c9ac6b730f4e71b47f8714420f2609537b7114", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIzYzlhYzZiNzMwZjRlNzFiNDdmODcxNDQyMGYyNjA5NTM3YjcxMTQ=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2020-06-26T01:00:05Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-06-26T01:00:05Z"}, "message": "Rollup merge of #72770 - crlf0710:mixed_script_confusable, r=Manishearth\n\nImplement mixed script confusable lint.\n\nThis implements the mixed script confusable lint defined in RFC 2457.\nThis is blocked on #72069 and https://github.com/unicode-rs/unicode-security/pull/13, and will need a Cargo.toml version bump after those are resolved.\n\nThe lint message warning is sub-optimal for now. We'll need a mechanism to properly output  `AugmentScriptSet` to screen, this is to be added in `unicode-security` crate.\n\nr? @Manishearth", "tree": {"sha": "c4c81002c930a5b40afff506f046cb5251a83e94", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c4c81002c930a5b40afff506f046cb5251a83e94"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/23c9ac6b730f4e71b47f8714420f2609537b7114", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJe9UiVCRBK7hj4Ov3rIwAAdHIIAJ6XFleZhqo9kW78HwoBp+LW\ntvBs/wPFerK251XIdM0cR99tooXg5JvlUiqRlZH1hvYRce/NLOqpsJY5VS+ylz7Y\nzZjyCpxJeU6e9LVrQagUvxeHnIprWjvapxaevX/iTqaCqI4EXtt0uuCUh7jqFEtr\nj0vZn4zfxwPr1OeZavjZALg6uBZgT+8QDKSPSoq5pCe49p/09cw+msV/kxwD9vYE\niBbqw14BEj/r/0Bx2hgqsbA8W6gA3GeypRjmY1oquhAxAWegJNxHa4fjjPtNIuXh\nouAsRklqQwy4Yxm8ztXMyVq7vxj8xnSTa2lq2BPgHV8c1wyLAvInTSQDZC0JQD4=\n=5G9J\n-----END PGP SIGNATURE-----\n", "payload": "tree c4c81002c930a5b40afff506f046cb5251a83e94\nparent 9275ff7b218d6aacea649425bf1b603c6f78d578\nparent 25e864e19812e079a9e69134fd1bbbfee444c0a2\nauthor Manish Goregaokar <manishsmail@gmail.com> 1593133205 -0700\ncommitter GitHub <noreply@github.com> 1593133205 -0700\n\nRollup merge of #72770 - crlf0710:mixed_script_confusable, r=Manishearth\n\nImplement mixed script confusable lint.\n\nThis implements the mixed script confusable lint defined in RFC 2457.\nThis is blocked on #72069 and https://github.com/unicode-rs/unicode-security/pull/13, and will need a Cargo.toml version bump after those are resolved.\n\nThe lint message warning is sub-optimal for now. We'll need a mechanism to properly output  `AugmentScriptSet` to screen, this is to be added in `unicode-security` crate.\n\nr? @Manishearth\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/23c9ac6b730f4e71b47f8714420f2609537b7114", "html_url": "https://github.com/rust-lang/rust/commit/23c9ac6b730f4e71b47f8714420f2609537b7114", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/23c9ac6b730f4e71b47f8714420f2609537b7114/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9275ff7b218d6aacea649425bf1b603c6f78d578", "url": "https://api.github.com/repos/rust-lang/rust/commits/9275ff7b218d6aacea649425bf1b603c6f78d578", "html_url": "https://github.com/rust-lang/rust/commit/9275ff7b218d6aacea649425bf1b603c6f78d578"}, {"sha": "25e864e19812e079a9e69134fd1bbbfee444c0a2", "url": "https://api.github.com/repos/rust-lang/rust/commits/25e864e19812e079a9e69134fd1bbbfee444c0a2", "html_url": "https://github.com/rust-lang/rust/commit/25e864e19812e079a9e69134fd1bbbfee444c0a2"}], "stats": {"total": 498, "additions": 333, "deletions": 165}, "files": [{"sha": "8a0991059d5b26cd53ff61f393173976114c19dd", "filename": "Cargo.lock", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -5405,15 +5405,15 @@ dependencies = [\n \n [[package]]\n name = \"unicode-script\"\n-version = \"0.4.0\"\n+version = \"0.5.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"5b2c5c29e805da6817f5af6a627d65adb045cebf05cccd5a3493d6109454391c\"\n+checksum = \"58b33414ea8db4b7ea0343548dbdc31d27aef06beacf7044a87e564d9b0feb7d\"\n \n [[package]]\n name = \"unicode-security\"\n-version = \"0.0.3\"\n+version = \"0.0.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"a5f9011bbed9c13372bc8df618b55a38138445199caf3b61d432c6859c36dee0\"\n+checksum = \"5d87c28edc5b263377e448d6cdcb935c06b95413d8013ba6fae470558ccab18f\"\n dependencies = [\n  \"unicode-normalization\",\n  \"unicode-script\","}, {"sha": "58c15257326aeb20481869f3a161972b448d5e42", "filename": "src/librustc_lint/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Flibrustc_lint%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Flibrustc_lint%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2FCargo.toml?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -10,7 +10,7 @@ path = \"lib.rs\"\n \n [dependencies]\n log = \"0.4\"\n-unicode-security = \"0.0.3\"\n+unicode-security = \"0.0.5\"\n rustc_middle = { path = \"../librustc_middle\" }\n rustc_ast_pretty = { path = \"../librustc_ast_pretty\" }\n rustc_attr = { path = \"../librustc_attr\" }"}, {"sha": "30dbd069c29bd2d847050b2955c477997040fdc0", "filename": "src/librustc_lint/non_ascii_idents.rs", "status": "modified", "additions": 225, "deletions": 129, "changes": 354, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Flibrustc_lint%2Fnon_ascii_idents.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Flibrustc_lint%2Fnon_ascii_idents.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Fnon_ascii_idents.rs?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -1,9 +1,7 @@\n use crate::{EarlyContext, EarlyLintPass, LintContext};\n use rustc_ast::ast;\n use rustc_data_structures::fx::FxHashMap;\n-use rustc_span::symbol::{Ident, SymbolStr};\n-use std::hash::{Hash, Hasher};\n-use std::ops::Deref;\n+use rustc_span::symbol::SymbolStr;\n \n declare_lint! {\n     pub NON_ASCII_IDENTS,\n@@ -19,158 +17,256 @@ declare_lint! {\n     crate_level_only\n }\n \n-// FIXME: Change this to warn.\n declare_lint! {\n     pub CONFUSABLE_IDENTS,\n-    Allow,\n+    Warn,\n     \"detects visually confusable pairs between identifiers\",\n     crate_level_only\n }\n \n-declare_lint_pass!(NonAsciiIdents => [NON_ASCII_IDENTS, UNCOMMON_CODEPOINTS, CONFUSABLE_IDENTS]);\n-\n-enum CowBoxSymStr {\n-    Interned(SymbolStr),\n-    Owned(Box<str>),\n-}\n-\n-impl Deref for CowBoxSymStr {\n-    type Target = str;\n-\n-    fn deref(&self) -> &str {\n-        match self {\n-            CowBoxSymStr::Interned(interned) => interned,\n-            CowBoxSymStr::Owned(ref owned) => owned,\n-        }\n-    }\n-}\n-\n-impl Hash for CowBoxSymStr {\n-    #[inline]\n-    fn hash<H: Hasher>(&self, state: &mut H) {\n-        Hash::hash(&**self, state)\n-    }\n-}\n-\n-impl PartialEq<CowBoxSymStr> for CowBoxSymStr {\n-    #[inline]\n-    fn eq(&self, other: &CowBoxSymStr) -> bool {\n-        PartialEq::eq(&**self, &**other)\n-    }\n-}\n-\n-impl Eq for CowBoxSymStr {}\n-\n-fn calc_skeleton(symbol_str: SymbolStr, buffer: &'_ mut String) -> CowBoxSymStr {\n-    use std::mem::swap;\n-    use unicode_security::confusable_detection::skeleton;\n-    buffer.clear();\n-    buffer.extend(skeleton(&symbol_str));\n-    if symbol_str == *buffer {\n-        CowBoxSymStr::Interned(symbol_str)\n-    } else {\n-        let mut owned = String::new();\n-        swap(buffer, &mut owned);\n-        CowBoxSymStr::Owned(owned.into_boxed_str())\n-    }\n-}\n-\n-fn is_in_ascii_confusable_closure(c: char) -> bool {\n-    // FIXME: move this table to `unicode_security` crate.\n-    // data here corresponds to Unicode 13.\n-    const ASCII_CONFUSABLE_CLOSURE: &[(u64, u64)] = &[(0x00, 0x7f), (0xba, 0xba), (0x2080, 0x2080)];\n-    let c = c as u64;\n-    for &(range_start, range_end) in ASCII_CONFUSABLE_CLOSURE {\n-        if c >= range_start && c <= range_end {\n-            return true;\n-        }\n-    }\n-    false\n+declare_lint! {\n+    pub MIXED_SCRIPT_CONFUSABLES,\n+    Warn,\n+    \"detects Unicode scripts whose mixed script confusables codepoints are solely used\",\n+    crate_level_only\n }\n \n-fn is_in_ascii_confusable_closure_relevant_list(c: char) -> bool {\n-    // FIXME: move this table to `unicode_security` crate.\n-    // data here corresponds to Unicode 13.\n-    const ASCII_CONFUSABLE_CLOSURE_RELEVANT_LIST: &[u64] = &[\n-        0x22, 0x25, 0x27, 0x2f, 0x30, 0x31, 0x49, 0x4f, 0x60, 0x6c, 0x6d, 0x6e, 0x72, 0x7c, 0xba,\n-        0x2080,\n-    ];\n-    let c = c as u64;\n-    for &item in ASCII_CONFUSABLE_CLOSURE_RELEVANT_LIST {\n-        if c == item {\n-            return true;\n-        }\n-    }\n-    false\n-}\n+declare_lint_pass!(NonAsciiIdents => [NON_ASCII_IDENTS, UNCOMMON_CODEPOINTS, CONFUSABLE_IDENTS, MIXED_SCRIPT_CONFUSABLES]);\n \n impl EarlyLintPass for NonAsciiIdents {\n     fn check_crate(&mut self, cx: &EarlyContext<'_>, _: &ast::Crate) {\n         use rustc_session::lint::Level;\n-        if cx.builder.lint_level(CONFUSABLE_IDENTS).0 == Level::Allow {\n+        use rustc_span::Span;\n+        use std::collections::BTreeMap;\n+        use unicode_security::GeneralSecurityProfile;\n+        use utils::CowBoxSymStr;\n+\n+        let check_non_ascii_idents = cx.builder.lint_level(NON_ASCII_IDENTS).0 != Level::Allow;\n+        let check_uncommon_codepoints =\n+            cx.builder.lint_level(UNCOMMON_CODEPOINTS).0 != Level::Allow;\n+        let check_confusable_idents = cx.builder.lint_level(CONFUSABLE_IDENTS).0 != Level::Allow;\n+        let check_mixed_script_confusables =\n+            cx.builder.lint_level(MIXED_SCRIPT_CONFUSABLES).0 != Level::Allow;\n+\n+        if !check_non_ascii_idents\n+            && !check_uncommon_codepoints\n+            && !check_confusable_idents\n+            && !check_mixed_script_confusables\n+        {\n             return;\n         }\n+\n+        let mut has_non_ascii_idents = false;\n         let symbols = cx.sess.parse_sess.symbol_gallery.symbols.lock();\n-        let mut symbol_strs_and_spans = Vec::with_capacity(symbols.len());\n-        let mut in_fast_path = true;\n-        for (symbol, sp) in symbols.iter() {\n-            // fast path\n+        for (symbol, &sp) in symbols.iter() {\n             let symbol_str = symbol.as_str();\n-            if !symbol_str.chars().all(is_in_ascii_confusable_closure) {\n-                // fallback to slow path.\n-                symbol_strs_and_spans.clear();\n-                in_fast_path = false;\n-                break;\n+            if symbol_str.is_ascii() {\n+                continue;\n             }\n-            if symbol_str.chars().any(is_in_ascii_confusable_closure_relevant_list) {\n-                symbol_strs_and_spans.push((symbol_str, *sp));\n+            has_non_ascii_idents = true;\n+            cx.struct_span_lint(NON_ASCII_IDENTS, sp, |lint| {\n+                lint.build(\"identifier contains non-ASCII characters\").emit()\n+            });\n+            if check_uncommon_codepoints\n+                && !symbol_str.chars().all(GeneralSecurityProfile::identifier_allowed)\n+            {\n+                cx.struct_span_lint(UNCOMMON_CODEPOINTS, sp, |lint| {\n+                    lint.build(\"identifier contains uncommon Unicode codepoints\").emit()\n+                })\n             }\n         }\n-        if !in_fast_path {\n-            // slow path\n-            for (symbol, sp) in symbols.iter() {\n+\n+        if has_non_ascii_idents && check_confusable_idents {\n+            let mut skeleton_map: FxHashMap<CowBoxSymStr, (SymbolStr, Span, bool)> =\n+                FxHashMap::with_capacity_and_hasher(symbols.len(), Default::default());\n+            let mut str_buf = String::new();\n+            for (symbol, &sp) in symbols.iter() {\n+                fn calc_skeleton(symbol_str: &SymbolStr, buffer: &mut String) -> CowBoxSymStr {\n+                    use std::mem::replace;\n+                    use unicode_security::confusable_detection::skeleton;\n+                    buffer.clear();\n+                    buffer.extend(skeleton(symbol_str));\n+                    if *symbol_str == *buffer {\n+                        CowBoxSymStr::Interned(symbol_str.clone())\n+                    } else {\n+                        let owned = replace(buffer, String::new());\n+                        CowBoxSymStr::Owned(owned.into_boxed_str())\n+                    }\n+                }\n                 let symbol_str = symbol.as_str();\n-                symbol_strs_and_spans.push((symbol_str, *sp));\n+                let is_ascii = symbol_str.is_ascii();\n+                let skeleton = calc_skeleton(&symbol_str, &mut str_buf);\n+                skeleton_map\n+                    .entry(skeleton)\n+                    .and_modify(|(existing_symbolstr, existing_span, existing_is_ascii)| {\n+                        if !*existing_is_ascii || !is_ascii {\n+                            cx.struct_span_lint(CONFUSABLE_IDENTS, sp, |lint| {\n+                                lint.build(&format!(\n+                                    \"identifier pair considered confusable between `{}` and `{}`\",\n+                                    existing_symbolstr, symbol_str\n+                                ))\n+                                .span_label(\n+                                    *existing_span,\n+                                    \"this is where the previous identifier occurred\",\n+                                )\n+                                .emit();\n+                            });\n+                        }\n+                        if *existing_is_ascii && !is_ascii {\n+                            *existing_symbolstr = symbol_str.clone();\n+                            *existing_span = sp;\n+                            *existing_is_ascii = is_ascii;\n+                        }\n+                    })\n+                    .or_insert((symbol_str, sp, is_ascii));\n             }\n         }\n-        drop(symbols);\n-        symbol_strs_and_spans.sort_by_key(|x| x.0.clone());\n-        let mut skeleton_map =\n-            FxHashMap::with_capacity_and_hasher(symbol_strs_and_spans.len(), Default::default());\n-        let mut str_buf = String::new();\n-        for (symbol_str, sp) in symbol_strs_and_spans {\n-            let skeleton = calc_skeleton(symbol_str.clone(), &mut str_buf);\n-            skeleton_map\n-                .entry(skeleton)\n-                .and_modify(|(existing_symbolstr, existing_span)| {\n-                    cx.struct_span_lint(CONFUSABLE_IDENTS, sp, |lint| {\n-                        lint.build(&format!(\n-                            \"identifier pair considered confusable between `{}` and `{}`\",\n-                            existing_symbolstr, symbol_str\n-                        ))\n-                        .span_label(\n-                            *existing_span,\n-                            \"this is where the previous identifier occurred\",\n-                        )\n-                        .emit();\n+\n+        if has_non_ascii_idents && check_mixed_script_confusables {\n+            use unicode_security::is_potential_mixed_script_confusable_char;\n+            use unicode_security::mixed_script::AugmentedScriptSet;\n+\n+            #[derive(Clone)]\n+            enum ScriptSetUsage {\n+                Suspicious(Vec<char>, Span),\n+                Verified,\n+            }\n+\n+            let mut script_states: FxHashMap<AugmentedScriptSet, ScriptSetUsage> =\n+                FxHashMap::default();\n+            let latin_augmented_script_set = AugmentedScriptSet::for_char('A');\n+            script_states.insert(latin_augmented_script_set, ScriptSetUsage::Verified);\n+\n+            let mut has_suspicous = false;\n+            for (symbol, &sp) in symbols.iter() {\n+                let symbol_str = symbol.as_str();\n+                for ch in symbol_str.chars() {\n+                    if ch.is_ascii() {\n+                        // all ascii characters are covered by exception.\n+                        continue;\n+                    }\n+                    if !GeneralSecurityProfile::identifier_allowed(ch) {\n+                        // this character is covered by `uncommon_codepoints` lint.\n+                        continue;\n+                    }\n+                    let augmented_script_set = AugmentedScriptSet::for_char(ch);\n+                    script_states\n+                        .entry(augmented_script_set)\n+                        .and_modify(|existing_state| {\n+                            if let ScriptSetUsage::Suspicious(ch_list, _) = existing_state {\n+                                if is_potential_mixed_script_confusable_char(ch) {\n+                                    ch_list.push(ch);\n+                                } else {\n+                                    *existing_state = ScriptSetUsage::Verified;\n+                                }\n+                            }\n+                        })\n+                        .or_insert_with(|| {\n+                            if !is_potential_mixed_script_confusable_char(ch) {\n+                                ScriptSetUsage::Verified\n+                            } else {\n+                                has_suspicous = true;\n+                                ScriptSetUsage::Suspicious(vec![ch], sp)\n+                            }\n+                        });\n+                }\n+            }\n+\n+            if has_suspicous {\n+                let verified_augmented_script_sets = script_states\n+                    .iter()\n+                    .flat_map(|(k, v)| match v {\n+                        ScriptSetUsage::Verified => Some(*k),\n+                        _ => None,\n+                    })\n+                    .collect::<Vec<_>>();\n+\n+                // we're sorting the output here.\n+                let mut lint_reports: BTreeMap<(Span, Vec<char>), AugmentedScriptSet> =\n+                    BTreeMap::new();\n+\n+                'outerloop: for (augment_script_set, usage) in script_states {\n+                    let (mut ch_list, sp) = match usage {\n+                        ScriptSetUsage::Verified => continue,\n+                        ScriptSetUsage::Suspicious(ch_list, sp) => (ch_list, sp),\n+                    };\n+\n+                    if augment_script_set.is_all() {\n+                        continue;\n+                    }\n+\n+                    for existing in verified_augmented_script_sets.iter() {\n+                        if existing.is_all() {\n+                            continue;\n+                        }\n+                        let mut intersect = *existing;\n+                        intersect.intersect_with(augment_script_set);\n+                        if !intersect.is_empty() && !intersect.is_all() {\n+                            continue 'outerloop;\n+                        }\n+                    }\n+\n+                    ch_list.sort();\n+                    ch_list.dedup();\n+                    lint_reports.insert((sp, ch_list), augment_script_set);\n+                }\n+\n+                for ((sp, ch_list), script_set) in lint_reports {\n+                    cx.struct_span_lint(MIXED_SCRIPT_CONFUSABLES, sp, |lint| {\n+                        let message = format!(\n+                            \"The usage of Script Group `{}` in this crate consists solely of mixed script confusables\",\n+                            script_set);\n+                        let mut note = \"The usage includes \".to_string();\n+                        for (idx, ch) in ch_list.into_iter().enumerate() {\n+                            if idx != 0 {\n+                                note += \", \";\n+                            }\n+                            let char_info = format!(\"'{}' (U+{:04X})\", ch, ch as u32);\n+                            note += &char_info;\n+                        }\n+                        note += \".\";\n+                        lint.build(&message).note(&note).note(\"Please recheck to make sure their usages are indeed what you want.\").emit()\n                     });\n-                })\n-                .or_insert((symbol_str, sp));\n+                }\n+            }\n         }\n     }\n-    fn check_ident(&mut self, cx: &EarlyContext<'_>, ident: Ident) {\n-        use unicode_security::GeneralSecurityProfile;\n-        let name_str = ident.name.as_str();\n-        if name_str.is_ascii() {\n-            return;\n+}\n+\n+mod utils {\n+    use rustc_span::symbol::SymbolStr;\n+    use std::hash::{Hash, Hasher};\n+    use std::ops::Deref;\n+\n+    pub(super) enum CowBoxSymStr {\n+        Interned(SymbolStr),\n+        Owned(Box<str>),\n+    }\n+\n+    impl Deref for CowBoxSymStr {\n+        type Target = str;\n+\n+        fn deref(&self) -> &str {\n+            match self {\n+                CowBoxSymStr::Interned(interned) => interned,\n+                CowBoxSymStr::Owned(ref owned) => owned,\n+            }\n+        }\n+    }\n+\n+    impl Hash for CowBoxSymStr {\n+        #[inline]\n+        fn hash<H: Hasher>(&self, state: &mut H) {\n+            Hash::hash(&**self, state)\n         }\n-        cx.struct_span_lint(NON_ASCII_IDENTS, ident.span, |lint| {\n-            lint.build(\"identifier contains non-ASCII characters\").emit()\n-        });\n-        if !name_str.chars().all(GeneralSecurityProfile::identifier_allowed) {\n-            cx.struct_span_lint(UNCOMMON_CODEPOINTS, ident.span, |lint| {\n-                lint.build(\"identifier contains uncommon Unicode codepoints\").emit()\n-            })\n+    }\n+\n+    impl PartialEq<CowBoxSymStr> for CowBoxSymStr {\n+        #[inline]\n+        fn eq(&self, other: &CowBoxSymStr) -> bool {\n+            PartialEq::eq(&**self, &**other)\n         }\n     }\n+\n+    impl Eq for CowBoxSymStr {}\n }"}, {"sha": "f4e5da4d54f46e9d6749568c21d02f0efb59e8cb", "filename": "src/librustc_session/parse.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Flibrustc_session%2Fparse.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Flibrustc_session%2Fparse.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_session%2Fparse.rs?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -13,6 +13,7 @@ use rustc_span::hygiene::ExpnId;\n use rustc_span::source_map::{FilePathMapping, SourceMap};\n use rustc_span::{MultiSpan, Span, Symbol};\n \n+use std::collections::BTreeMap;\n use std::path::PathBuf;\n use std::str;\n \n@@ -63,7 +64,7 @@ impl GatedSpans {\n #[derive(Default)]\n pub struct SymbolGallery {\n     /// All symbols occurred and their first occurrance span.\n-    pub symbols: Lock<FxHashMap<Symbol, Span>>,\n+    pub symbols: Lock<BTreeMap<Symbol, Span>>,\n }\n \n impl SymbolGallery {"}, {"sha": "e15ed2e70b896fa2b497e2c0cdef2ef34dd7889d", "filename": "src/test/ui/lint/rfc-2457-non-ascii-idents/lint-confusable-idents.rs", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-confusable-idents.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-confusable-idents.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-confusable-idents.rs?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -2,8 +2,14 @@\n #![deny(confusable_idents)]\n #![allow(uncommon_codepoints, non_upper_case_globals)]\n \n-const \uff53: usize = 42; //~ ERROR identifier pair considered confusable\n+const \uff53: usize = 42;\n \n fn main() {\n-    let s = \"rust\";\n+    let s = \"rust\"; //~ ERROR identifier pair considered confusable\n+    not_affected();\n+}\n+\n+fn not_affected() {\n+    let s1 = 1;\n+    let sl = 'l';\n }"}, {"sha": "218f94f7b5829483beb10155f6a0fbc223693043", "filename": "src/test/ui/lint/rfc-2457-non-ascii-idents/lint-confusable-idents.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-confusable-idents.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-confusable-idents.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-confusable-idents.stderr?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -1,11 +1,11 @@\n-error: identifier pair considered confusable between `s` and `\uff53`\n-  --> $DIR/lint-confusable-idents.rs:5:7\n+error: identifier pair considered confusable between `\uff53` and `s`\n+  --> $DIR/lint-confusable-idents.rs:8:9\n    |\n LL | const \uff53: usize = 42;\n-   |       ^^\n+   |       -- this is where the previous identifier occurred\n ...\n LL |     let s = \"rust\";\n-   |         - this is where the previous identifier occurred\n+   |         ^\n    |\n note: the lint level is defined here\n   --> $DIR/lint-confusable-idents.rs:2:9"}, {"sha": "a5b45466da5ca5c12ca970d1bc7d6258ae6bff1d", "filename": "src/test/ui/lint/rfc-2457-non-ascii-idents/lint-mixed-script-confusables-2.rs", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-mixed-script-confusables-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-mixed-script-confusables-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-mixed-script-confusables-2.rs?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -0,0 +1,20 @@\n+// check-pass\n+#![feature(non_ascii_idents)]\n+#![deny(mixed_script_confusables)]\n+\n+struct \u0391ctuallyNotLatin;\n+\n+fn main() {\n+    let \u03bb = 42; // this usage of Greek confirms that Greek is used intentionally.\n+}\n+\n+mod \u0440\u043e\u0440\u0435 {\n+    const \u30a8: &'static str = \"\u30a2\u30a4\u30a6\";\n+\n+    // this usage of Katakana confirms that Katakana is used intentionally.\n+    fn \u30cb\u30e3\u30f3() {\n+        let \u0434: usize = 100; // this usage of Cyrillic confirms that Cyrillic is used intentionally.\n+\n+        println!(\"meow!\");\n+    }\n+}"}, {"sha": "4637b03f250de14f7336fdf8b3cd0ca04a6c310b", "filename": "src/test/ui/lint/rfc-2457-non-ascii-idents/lint-mixed-script-confusables.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-mixed-script-confusables.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-mixed-script-confusables.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-mixed-script-confusables.rs?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -0,0 +1,15 @@\n+#![feature(non_ascii_idents)]\n+#![deny(mixed_script_confusables)]\n+\n+struct \u0391ctuallyNotLatin;\n+//~^ ERROR The usage of Script Group `Greek` in this crate consists solely of\n+\n+fn main() {\n+    let v = \u0391ctuallyNotLatin;\n+}\n+\n+mod \u0440\u043e\u0440\u0435 {\n+//~^ ERROR The usage of Script Group `Cyrillic` in this crate consists solely of\n+    const \u30a8: &'static str = \"\u30a2\u30a4\u30a6\";\n+    //~^ ERROR The usage of Script Group `Japanese, Katakana` in this crate consists solely of\n+}"}, {"sha": "6f75a1ece37662769c292d2a9f544e7c9cd65867", "filename": "src/test/ui/lint/rfc-2457-non-ascii-idents/lint-mixed-script-confusables.stderr", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-mixed-script-confusables.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-mixed-script-confusables.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-mixed-script-confusables.stderr?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -0,0 +1,34 @@\n+error: The usage of Script Group `Greek` in this crate consists solely of mixed script confusables\n+  --> $DIR/lint-mixed-script-confusables.rs:4:8\n+   |\n+LL | struct \u0391ctuallyNotLatin;\n+   |        ^^^^^^^^^^^^^^^^\n+   |\n+note: the lint level is defined here\n+  --> $DIR/lint-mixed-script-confusables.rs:2:9\n+   |\n+LL | #![deny(mixed_script_confusables)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^\n+   = note: The usage includes '\u0391' (U+0391).\n+   = note: Please recheck to make sure their usages are indeed what you want.\n+\n+error: The usage of Script Group `Cyrillic` in this crate consists solely of mixed script confusables\n+  --> $DIR/lint-mixed-script-confusables.rs:11:5\n+   |\n+LL | mod \u0440\u043e\u0440\u0435 {\n+   |     ^^^^\n+   |\n+   = note: The usage includes '\u0435' (U+0435), '\u043e' (U+043E), '\u0440' (U+0440).\n+   = note: Please recheck to make sure their usages are indeed what you want.\n+\n+error: The usage of Script Group `Japanese, Katakana` in this crate consists solely of mixed script confusables\n+  --> $DIR/lint-mixed-script-confusables.rs:13:11\n+   |\n+LL |     const \u30a8: &'static str = \"\u30a2\u30a4\u30a6\";\n+   |           ^^\n+   |\n+   = note: The usage includes '\u30a8' (U+30A8).\n+   = note: Please recheck to make sure their usages are indeed what you want.\n+\n+error: aborting due to 3 previous errors\n+"}, {"sha": "20d00cf701a1569fe5f33ef0b0d0fdbcdc3900a1", "filename": "src/test/ui/lint/rfc-2457-non-ascii-idents/lint-non-ascii-idents.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-non-ascii-idents.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-non-ascii-idents.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-non-ascii-idents.rs?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -7,5 +7,7 @@ fn co\u00f6peration() {} //~ ERROR identifier contains non-ASCII characters\n \n fn main() {\n     let na\u00efvet\u00e9 = 2; //~ ERROR identifier contains non-ASCII characters\n-    println!(\"{}\", na\u00efvet\u00e9); //~ ERROR identifier contains non-ASCII characters\n+\n+    // using the same identifier the second time won't trigger the lint.\n+    println!(\"{}\", na\u00efvet\u00e9);\n }"}, {"sha": "048b6ff5d687f011dac0ac01991bf589e4821f70", "filename": "src/test/ui/lint/rfc-2457-non-ascii-idents/lint-non-ascii-idents.stderr", "status": "modified", "additions": 1, "deletions": 7, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-non-ascii-idents.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-non-ascii-idents.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-non-ascii-idents.stderr?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -22,11 +22,5 @@ error: identifier contains non-ASCII characters\n LL |     let na\u00efvet\u00e9 = 2;\n    |         ^^^^^^^\n \n-error: identifier contains non-ASCII characters\n-  --> $DIR/lint-non-ascii-idents.rs:10:20\n-   |\n-LL |     println!(\"{}\", na\u00efvet\u00e9);\n-   |                    ^^^^^^^\n-\n-error: aborting due to 4 previous errors\n+error: aborting due to 3 previous errors\n "}, {"sha": "b5e251e047b5ad1f8ca37054603d4b1fb9577185", "filename": "src/test/ui/lint/rfc-2457-non-ascii-idents/lint-uncommon-codepoints.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-uncommon-codepoints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-uncommon-codepoints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-uncommon-codepoints.rs?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -7,5 +7,7 @@ fn d\u0133kstra() {} //~ ERROR identifier contains uncommon Unicode codepoints\n \n fn main() {\n     let \u31fb\u31f2\u31f3 = \"rust\"; //~ ERROR identifier contains uncommon Unicode codepoints\n-    println!(\"{}\", \u31fb\u31f2\u31f3); //~ ERROR identifier contains uncommon Unicode codepoints\n+\n+    // using the same identifier the second time won't trigger the lint.\n+    println!(\"{}\", \u31fb\u31f2\u31f3);\n }"}, {"sha": "05ea3d5de7dbc9759ec0482fd006d8fbad544a7c", "filename": "src/test/ui/lint/rfc-2457-non-ascii-idents/lint-uncommon-codepoints.stderr", "status": "modified", "additions": 1, "deletions": 7, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-uncommon-codepoints.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-uncommon-codepoints.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Frfc-2457-non-ascii-idents%2Flint-uncommon-codepoints.stderr?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -22,11 +22,5 @@ error: identifier contains uncommon Unicode codepoints\n LL |     let \u31fb\u31f2\u31f3 = \"rust\";\n    |         ^^^^^^\n \n-error: identifier contains uncommon Unicode codepoints\n-  --> $DIR/lint-uncommon-codepoints.rs:10:20\n-   |\n-LL |     println!(\"{}\", \u31fb\u31f2\u31f3);\n-   |                    ^^^^^^\n-\n-error: aborting due to 4 previous errors\n+error: aborting due to 3 previous errors\n "}, {"sha": "5259dfe2e656c9f255920434c7706e45a00799ae", "filename": "src/test/ui/parser/issue-62524.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Fparser%2Fissue-62524.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Fparser%2Fissue-62524.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissue-62524.rs?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -1,4 +1,6 @@\n // ignore-tidy-trailing-newlines\n // error-pattern: aborting due to 3 previous errors\n+#![allow(uncommon_codepoints)]\n+\n y![\n \u03e4,\n\\ No newline at end of file"}, {"sha": "d5e07622b11b99dce7867a65762ed90655b5d692", "filename": "src/test/ui/parser/issue-62524.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Fparser%2Fissue-62524.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Fparser%2Fissue-62524.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissue-62524.stderr?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -1,13 +1,13 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/issue-62524.rs:4:3\n+  --> $DIR/issue-62524.rs:6:3\n    |\n LL | y![\n    |   - unclosed delimiter\n LL | \u03e4,\n    |   ^\n \n error: macros that expand to items must be delimited with braces or followed by a semicolon\n-  --> $DIR/issue-62524.rs:3:3\n+  --> $DIR/issue-62524.rs:5:3\n    |\n LL |   y![\n    |  ___^\n@@ -24,7 +24,7 @@ LL | \u03e4,;\n    |   ^\n \n error: cannot find macro `y` in this scope\n-  --> $DIR/issue-62524.rs:3:1\n+  --> $DIR/issue-62524.rs:5:1\n    |\n LL | y![\n    | ^"}, {"sha": "6c54086cc2009a4059218f16825fd85dde53da3f", "filename": "src/test/ui/utf8_idents.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Futf8_idents.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Futf8_idents.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Futf8_idents.rs?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -1,3 +1,5 @@\n+#![allow(mixed_script_confusables)]\n+\n fn foo<\n     '\u03b2, //~ ERROR non-ascii idents are not fully supported\n     \u03b3  //~ ERROR non-ascii idents are not fully supported"}, {"sha": "2fc0b1c39effb54f6766d3f6f0b8cd413dbae562", "filename": "src/test/ui/utf8_idents.stderr", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Futf8_idents.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/23c9ac6b730f4e71b47f8714420f2609537b7114/src%2Ftest%2Fui%2Futf8_idents.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Futf8_idents.stderr?ref=23c9ac6b730f4e71b47f8714420f2609537b7114", "patch": "@@ -1,5 +1,5 @@\n error[E0658]: non-ascii idents are not fully supported\n-  --> $DIR/utf8_idents.rs:2:5\n+  --> $DIR/utf8_idents.rs:4:5\n    |\n LL |     '\u03b2,\n    |     ^^\n@@ -8,7 +8,7 @@ LL |     '\u03b2,\n    = help: add `#![feature(non_ascii_idents)]` to the crate attributes to enable\n \n error[E0658]: non-ascii idents are not fully supported\n-  --> $DIR/utf8_idents.rs:3:5\n+  --> $DIR/utf8_idents.rs:5:5\n    |\n LL |     \u03b3\n    |     ^\n@@ -17,7 +17,7 @@ LL |     \u03b3\n    = help: add `#![feature(non_ascii_idents)]` to the crate attributes to enable\n \n error[E0658]: non-ascii idents are not fully supported\n-  --> $DIR/utf8_idents.rs:8:5\n+  --> $DIR/utf8_idents.rs:10:5\n    |\n LL |     \u03b4: usize\n    |     ^\n@@ -26,7 +26,7 @@ LL |     \u03b4: usize\n    = help: add `#![feature(non_ascii_idents)]` to the crate attributes to enable\n \n error[E0658]: non-ascii idents are not fully supported\n-  --> $DIR/utf8_idents.rs:12:9\n+  --> $DIR/utf8_idents.rs:14:9\n    |\n LL |     let \u03b1 = 0.00001f64;\n    |         ^\n@@ -35,7 +35,7 @@ LL |     let \u03b1 = 0.00001f64;\n    = help: add `#![feature(non_ascii_idents)]` to the crate attributes to enable\n \n warning: type parameter `\u03b3` should have an upper camel case name\n-  --> $DIR/utf8_idents.rs:3:5\n+  --> $DIR/utf8_idents.rs:5:5\n    |\n LL |     \u03b3\n    |     ^ help: convert the identifier to upper camel case: `\u0393`"}]}