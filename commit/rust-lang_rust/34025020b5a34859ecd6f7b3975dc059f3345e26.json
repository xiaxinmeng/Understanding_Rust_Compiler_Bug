{"sha": "34025020b5a34859ecd6f7b3975dc059f3345e26", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM0MDI1MDIwYjVhMzQ4NTllY2Q2ZjdiMzk3NWRjMDU5ZjMzNDVlMjY=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2019-11-18T08:13:31Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2019-11-18T09:35:03Z"}, "message": "Switch to Actions", "tree": {"sha": "ab7378e18830df35dc72995431d550eab6edbd5f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ab7378e18830df35dc72995431d550eab6edbd5f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/34025020b5a34859ecd6f7b3975dc059f3345e26", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/34025020b5a34859ecd6f7b3975dc059f3345e26", "html_url": "https://github.com/rust-lang/rust/commit/34025020b5a34859ecd6f7b3975dc059f3345e26", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/34025020b5a34859ecd6f7b3975dc059f3345e26/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "396853defb1359dfabcab4eaa41ab3f2230b1582", "url": "https://api.github.com/repos/rust-lang/rust/commits/396853defb1359dfabcab4eaa41ab3f2230b1582", "html_url": "https://github.com/rust-lang/rust/commit/396853defb1359dfabcab4eaa41ab3f2230b1582"}], "stats": {"total": 158, "additions": 61, "deletions": 97}, "files": [{"sha": "b70d005fb9b51d38106ce2eb74e45bee9f810986", "filename": ".github/workflows/ci.yaml", "status": "modified", "additions": 21, "deletions": 30, "changes": 51, "blob_url": "https://github.com/rust-lang/rust/blob/34025020b5a34859ecd6f7b3975dc059f3345e26/.github%2Fworkflows%2Fci.yaml", "raw_url": "https://github.com/rust-lang/rust/raw/34025020b5a34859ecd6f7b3975dc059f3345e26/.github%2Fworkflows%2Fci.yaml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fci.yaml?ref=34025020b5a34859ecd6f7b3975dc059f3345e26", "patch": "@@ -1,74 +1,69 @@\n-name: Continuous integration\n-on: [pull_request, push]\n+name: CI\n+on:\n+  pull_request:\n+  push:\n+    branches:\n+      - master\n+      - staging\n \n jobs:\n-  rust-tests:\n-    name: Rust tests\n+  rust:\n+    name: Rust\n     runs-on: ubuntu-latest\n     env:\n       RUSTFLAGS: -D warnings\n       CARGO_INCREMENTAL: 0\n     steps:\n+\n       - name: Checkout repository\n         uses: actions/checkout@v1\n+\n       - name: Install Rust toolchain\n         uses: actions-rs/toolchain@v1\n         with:\n           toolchain: stable\n           profile: minimal\n           override: true\n           components: rustfmt, rust-src\n-      - name: Generate lockfile\n-        uses: actions-rs/cargo@v1\n-        with:\n-          command: generate-lockfile\n+\n       - name: Cargo target cache\n         uses: actions/cache@v1\n         with:\n           path: target\n           key: ${{ runner.os }}-cargo-build-target-${{ hashFiles('**/Cargo.lock') }}\n+\n       - name: Compile\n         uses: actions-rs/cargo@v1\n         with:\n           command: test\n           args: --no-run\n+\n       - name: Test\n         uses: actions-rs/cargo@v1\n         with:\n           command: test\n+\n       - name: Prepare build directory for cache\n         run: |\n           find ./target/debug -maxdepth 1 -type f -delete && \\\n           rm -fr ./target/debug/{deps,.fingerprint}/{*ra_*,*heavy_test*,*gen_lsp*,*thread_worker*} && \\\n           rm -f  ./target/.rustc_info.json\n-  vscode-tests:\n-    name: VS Code tests\n+\n+  type-script:\n+    name: TypeScript\n     runs-on: ubuntu-latest\n     env:\n       CXX: g++-4.9\n       CC: gcc-4.9\n     steps:\n       - name: Checkout repository\n         uses: actions/checkout@v1\n-      - name: Install Rust toolchain\n-        uses: actions-rs/toolchain@v1\n-        with:\n-          toolchain: stable\n-          profile: minimal\n-          override: true\n-      - name: Generate lockfile\n-        uses: actions-rs/cargo@v1\n-        with:\n-          command: generate-lockfile\n-      - name: Cargo target cache\n-        uses: actions/cache@v1\n-        with:\n-          path: target\n-          key: ${{ runner.os }}-cargo-build-target-${{ hashFiles('**/Cargo.lock') }}\n+\n       - name: Install Nodejs\n         uses: actions/setup-node@v1\n         with:\n           node-version: 12.x\n+\n       - name: Install xvfb\n         run: sudo apt-get install xvfb\n       - run: npm ci\n@@ -77,10 +72,6 @@ jobs:\n         working-directory: ./editors/code\n       - run: xvfb-run --auto-servernum npm run travis\n         working-directory: ./editors/code\n+\n       - name: Cleanup xvfb\n         uses: bcomnes/cleanup-xvfb@v1\n-      - name: Prepare build directory for cache\n-        run: |\n-          find ./target/debug -maxdepth 1 -type f -delete && \\\n-          rm -fr ./target/debug/{deps,.fingerprint}/{*ra_*,*heavy_test*,*gen_lsp*,*thread_worker*} && \\\n-          rm -f  ./target/.rustc_info.json"}, {"sha": "caa1dcc30c543e2418352cc7cda316c10a468157", "filename": ".github/workflows/rustdoc.yaml", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/34025020b5a34859ecd6f7b3975dc059f3345e26/.github%2Fworkflows%2Frustdoc.yaml", "raw_url": "https://github.com/rust-lang/rust/raw/34025020b5a34859ecd6f7b3975dc059f3345e26/.github%2Fworkflows%2Frustdoc.yaml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Frustdoc.yaml?ref=34025020b5a34859ecd6f7b3975dc059f3345e26", "patch": "@@ -0,0 +1,39 @@\n+name: rustdoc\n+on:\n+  push:\n+   branches:\n+     - master\n+\n+jobs:\n+  rustdoc:\n+    runs-on: ubuntu-latest\n+    env:\n+      RUSTFLAGS: -D warnings\n+      CARGO_INCREMENTAL: 0\n+\n+    steps:\n+      - name: Checkout repository\n+        uses: actions/checkout@v1\n+\n+      - name: Install Rust toolchain\n+        uses: actions-rs/toolchain@v1\n+        with:\n+          toolchain: stable\n+          profile: minimal\n+          override: true\n+          components: rustfmt, rust-src\n+\n+      - name: Build Documentation\n+        uses: actions-rs/cargo@v1\n+        with:\n+          command: doc\n+          args: --all --no-deps\n+\n+      - name: Deploy Docs\n+        uses: peaceiris/actions-gh-pages@v2.6.0-rc0\n+        env:\n+          ACTIONS_DEPLOY_KEY: ${{ secrets.ACTIONS_DEPLOY_KEY }}\n+          PUBLISH_BRANCH: gh-pages\n+          PUBLISH_DIR: ./target/doc\n+        with:\n+          forceOrphan: true"}, {"sha": "af71a9ccea2f16306ab5600820a63328985fe85c", "filename": ".travis.yml", "status": "removed", "additions": 0, "deletions": 64, "changes": 64, "blob_url": "https://github.com/rust-lang/rust/blob/396853defb1359dfabcab4eaa41ab3f2230b1582/.travis.yml", "raw_url": "https://github.com/rust-lang/rust/raw/396853defb1359dfabcab4eaa41ab3f2230b1582/.travis.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.travis.yml?ref=396853defb1359dfabcab4eaa41ab3f2230b1582", "patch": "@@ -1,64 +0,0 @@\n-cache: cargo\n-before_cache:\n-    - find ./target/debug -maxdepth 1 -type f -delete\n-    - rm -fr ./target/debug/{deps,.fingerprint}/{*ra_*,*heavy_test*,*gen_lsp*,*thread_worker*}\n-    - rm -f  ./target/.rustc_info.json\n-\n-matrix:\n-    include:\n-        - name: \"Rust Tests\"\n-          os: linux\n-          dist: xenial\n-          language: rust\n-          rust: stable\n-          script:\n-              - rustup component add rustfmt\n-              - rustup component add rust-src\n-              - cargo test --no-run  # let's measure compile time separately\n-              - cargo test\n-          env:\n-              - RUSTFLAGS=\"-D warnings\", CARGO_INCREMENTAL=0\n-\n-        - name: \"Rust Docs\"\n-          os: linux\n-          if: branch = master AND type = push\n-          before_script:\n-              - DEPLOY_DOCS=1\n-          language: rust\n-          rust: stable\n-          script:\n-              - cargo doc --all --no-deps\n-          env:\n-              - RUSTFLAGS=\"-D warnings\", CARGO_INCREMENTAL=0\n-\n-        - name: \"VS Code Tests\"\n-          os: linux\n-          language: node_js\n-          dist: xenial\n-          node_js: node\n-          services:\n-            - xvfb\n-          before_install: cd editors/code\n-          install:\n-            - npm ci\n-            - npm run vscode:prepublish\n-          script:\n-            - npm run travis\n-          env:\n-            - CXX=\"g++-4.9\", CC=\"gcc-4.9\"\n-\n-branches:\n-    only:\n-        - staging\n-        - master\n-        - trying\n-\n-deploy:\n-    provider: pages\n-    skip-cleanup: true\n-    github-token: $DOCS_TOKEN  # Set in the settings page of your repository, as a secure variable\n-    keep-history: false\n-    local-dir: target/doc\n-    on:\n-        branch: master\n-        condition: $DEPLOY_DOCS = 1"}, {"sha": "d286bd8a6166a783da1b88ac687da4d066678e62", "filename": "bors.toml", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/34025020b5a34859ecd6f7b3975dc059f3345e26/bors.toml", "raw_url": "https://github.com/rust-lang/rust/raw/34025020b5a34859ecd6f7b3975dc059f3345e26/bors.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/bors.toml?ref=34025020b5a34859ecd6f7b3975dc059f3345e26", "patch": "@@ -1,4 +1,2 @@\n-status = [\n-  \"continuous-integration/travis-ci/push\",\n-]\n+status = [\"CI / Rust\", \"CI / TypeScript\"]\n delete_merged_branches = true"}]}