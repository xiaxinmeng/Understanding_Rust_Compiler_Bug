{"sha": "bbbd0a5475095962e8eaeef57d9ad62f5ba018fd", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJiYmQwYTU0NzUwOTU5NjJlOGVhZWVmNTdkOWFkNjJmNWJhMDE4ZmQ=", "commit": {"author": {"name": "Pascal Hertleif", "email": "killercup@gmail.com", "date": "2016-07-14T19:00:20Z"}, "committer": {"name": "Pascal Hertleif", "email": "killercup@gmail.com", "date": "2016-07-14T19:00:20Z"}, "message": "Adjust HTML Docs\n\n- Section IDs, with handy anchor links\n- Multiple filters for levels\n- Table rendering, block quote size\n- Nicer loading (hide un-rendered content)\n- Code highlighting (only for Rust, of course!)\n- Fix parsing of descriptions that have a newline after the section\n  title (lead to duplicating the title, e.g., \"Examples\", in the\n  content)", "tree": {"sha": "c9f0d7cc3da634ca194bae542861ca66eba9b4ea", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c9f0d7cc3da634ca194bae542861ca66eba9b4ea"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bbbd0a5475095962e8eaeef57d9ad62f5ba018fd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bbbd0a5475095962e8eaeef57d9ad62f5ba018fd", "html_url": "https://github.com/rust-lang/rust/commit/bbbd0a5475095962e8eaeef57d9ad62f5ba018fd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bbbd0a5475095962e8eaeef57d9ad62f5ba018fd/comments", "author": {"login": "killercup", "id": 20063, "node_id": "MDQ6VXNlcjIwMDYz", "avatar_url": "https://avatars.githubusercontent.com/u/20063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/killercup", "html_url": "https://github.com/killercup", "followers_url": "https://api.github.com/users/killercup/followers", "following_url": "https://api.github.com/users/killercup/following{/other_user}", "gists_url": "https://api.github.com/users/killercup/gists{/gist_id}", "starred_url": "https://api.github.com/users/killercup/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/killercup/subscriptions", "organizations_url": "https://api.github.com/users/killercup/orgs", "repos_url": "https://api.github.com/users/killercup/repos", "events_url": "https://api.github.com/users/killercup/events{/privacy}", "received_events_url": "https://api.github.com/users/killercup/received_events", "type": "User", "site_admin": false}, "committer": {"login": "killercup", "id": 20063, "node_id": "MDQ6VXNlcjIwMDYz", "avatar_url": "https://avatars.githubusercontent.com/u/20063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/killercup", "html_url": "https://github.com/killercup", "followers_url": "https://api.github.com/users/killercup/followers", "following_url": "https://api.github.com/users/killercup/following{/other_user}", "gists_url": "https://api.github.com/users/killercup/gists{/gist_id}", "starred_url": "https://api.github.com/users/killercup/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/killercup/subscriptions", "organizations_url": "https://api.github.com/users/killercup/orgs", "repos_url": "https://api.github.com/users/killercup/repos", "events_url": "https://api.github.com/users/killercup/events{/privacy}", "received_events_url": "https://api.github.com/users/killercup/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ba9eda72363ddb5fdc1ee143ee57827eb9a330c7", "url": "https://api.github.com/repos/rust-lang/rust/commits/ba9eda72363ddb5fdc1ee143ee57827eb9a330c7", "html_url": "https://github.com/rust-lang/rust/commit/ba9eda72363ddb5fdc1ee143ee57827eb9a330c7"}], "stats": {"total": 177, "additions": 111, "deletions": 66}, "files": [{"sha": "152e9de141f500fa7145d83efe4a21d992550fc5", "filename": "util/export.py", "status": "modified", "additions": 8, "deletions": 5, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/bbbd0a5475095962e8eaeef57d9ad62f5ba018fd/util%2Fexport.py", "raw_url": "https://github.com/rust-lang/rust/raw/bbbd0a5475095962e8eaeef57d9ad62f5ba018fd/util%2Fexport.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/util%2Fexport.py?ref=bbbd0a5475095962e8eaeef57d9ad62f5ba018fd", "patch": "@@ -52,14 +52,17 @@ def parseLintDef(level, comment, name):\n         match = re.match(lint_subheadline, line)\n         if match:\n             last_section = match.groups()[0]\n-        text = match and match.groups()[1] or line\n-        \n+        if match:\n+            text = match.groups()[1]\n+        else:\n+            text = line\n+\n         if not last_section:\n             warn(\"Skipping comment line as it was not preceded by a heading\")\n             debug(\"in lint `%s`, line `%s`\" % name, line)\n \n-        lint['docs'][last_section] = (lint['docs'].get(last_section, \"\") + \"\\n\" + text).strip() \n-    \n+        lint['docs'][last_section] = (lint['docs'].get(last_section, \"\") + \"\\n\" + text).strip()\n+\n     return lint\n \n def parse_file(d, f):\n@@ -124,4 +127,4 @@ def main():\n         info(\"wrote JSON for great justice\")\n \n if __name__ == \"__main__\":\n-    main()\n\\ No newline at end of file\n+    main()"}, {"sha": "dd72ee234d1d5a0ee2b2c25a4126c21038aa1201", "filename": "util/gh-pages/index.html", "status": "modified", "additions": 103, "deletions": 61, "changes": 164, "blob_url": "https://github.com/rust-lang/rust/blob/bbbd0a5475095962e8eaeef57d9ad62f5ba018fd/util%2Fgh-pages%2Findex.html", "raw_url": "https://github.com/rust-lang/rust/raw/bbbd0a5475095962e8eaeef57d9ad62f5ba018fd/util%2Fgh-pages%2Findex.html", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/util%2Fgh-pages%2Findex.html?ref=bbbd0a5475095962e8eaeef57d9ad62f5ba018fd", "patch": "@@ -1,99 +1,141 @@\n <!DOCTYPE html>\n <html lang=\"en\">\n <head>\n-    <meta charset=\"UTF-8\">\n+    <meta charset=\"UTF-8\"/>\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"/>\n+\n     <title>Clippy</title>\n \n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.1/css/bootstrap.min.css\"/>\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"/>\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css\"/>\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/github.min.css\"/>\n+    <style>\n+        blockquote { font-size: 1em; }\n+        [ng\\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak { display: none !important; }\n+        .panel .anchor { display: none; }\n+        .panel:hover .anchor { display: inline; color: #fff; }\n+    </style>\n </head>\n <body>\n     <div class=\"container\" ng-app=\"clippy\" ng-controller=\"lintList\">\n         <div class=\"page-header\">\n             <h1>ALL the Clippy Lints</h1>\n         </div>\n \n-        <div class=\"alert alert-info\" role=\"alert\" ng-if=\"loading\">\n-            Loading&#x2026;\n-        </div>\n-        <div class=\"alert alert-danger\" role=\"alert\" ng-if=\"error\">\n-            Error loading commits!\n-        </div>\n+        <noscript>\n+            <div class=\"alert alert-danger\" role=\"alert\">\n+                Sorry, this site only works with JavaScript!\n+            </div>\n+        </noscript>\n \n-        <div class=\"panel panel-default\" ng-show=\"data\">\n-            <div class=\"panel-body row\">\n-                <div class=\"col-md-6 form-inline\">\n-                    <div class=\"form-group\">\n-                        <label for=\"filter-level\">Level</label>\n-                        <select class=\"form-control\" id=\"filter-level\" ng-model=\"level.level\">\n-                            <option value=\"\">All</option>\n-                            <option value=\"Allow\">Allow</option>\n-                            <option value=\"Warn\">Warn</option>\n-                            <option value=\"Deny\">Deny</option>\n-                        </select>\n+        <div ng-cloak>\n+\n+            <div class=\"alert alert-info\" role=\"alert\" ng-if=\"loading\">\n+                Loading&#x2026;\n+            </div>\n+            <div class=\"alert alert-danger\" role=\"alert\" ng-if=\"error\">\n+                Error loading lints!\n+            </div>\n+\n+            <div class=\"panel panel-default\" ng-show=\"data\">\n+                <div class=\"panel-body row\">\n+                    <div class=\"col-md-6 form-inline\">\n+                        <div class=\"form-group form-group-lg\">\n+                            <div class=\"checkbox\" ng-repeat=\"(level, enabled) in levels\" style=\"margin-right: 0.6em\">\n+                                <label>\n+                                    <input type=\"checkbox\" ng-model=\"levels[level]\" />\n+                                    {{level}}\n+                                </label>\n+                            </div>\n+                        </div>\n                     </div>\n-                </div>\n-                <div class=\"col-md-6\">\n-                    <div class=\"input-group\">\n-                        <span class=\"input-group-addon\" id=\"filter-label\">Filter:</span>\n-                        <input type=\"text\" class=\"form-control\" placeholder=\"Keywords or search string\" aria-describedby=\"filter-label\" ng-model=\"search\" />\n-                        <span class=\"input-group-btn\">\n-                            <button class=\"btn btn-default\" type=\"button\" ng-click=\"search = ''\">\n-                                Clear\n-                            </button>\n-                        </span>\n+                    <div class=\"col-md-6\">\n+                        <div class=\"input-group\">\n+                            <span class=\"input-group-addon\" id=\"filter-label\">Filter:</span>\n+                            <input type=\"text\" class=\"form-control\" placeholder=\"Keywords or search string\" aria-describedby=\"filter-label\" ng-model=\"search\" />\n+                            <span class=\"input-group-btn\">\n+                                <button class=\"btn btn-default\" type=\"button\" ng-click=\"search = ''\">\n+                                    Clear\n+                                </button>\n+                            </span>\n+                        </div>\n                     </div>\n                 </div>\n             </div>\n-        </div>\n \n-        <article class=\"panel panel-default\" ng-repeat=\"lint in data | filter:level | filter:search | orderBy:'id' track by lint.id\">\n-            <header class=\"panel-heading\" ng-click=\"open[lint.id] = !open[lint.id]\">\n-                <button class=\"btn btn-default btn-sm pull-right\" style=\"margin-top: -6px;\">\n-                    <span ng-show=\"open[lint.id]\">&minus;</span>\n-                    <span ng-hide=\"open[lint.id]\">&plus;</span>\n-                </button>\n-\n-                <h2 class=\"panel-title\">\n-                    {{lint.id}}\n-                    <span ng-if=\"lint.level == 'Allow'\" class=\"label label-info\">Allow</span>\n-                    <span ng-if=\"lint.level == 'Warn'\" class=\"label label-warning\">Warn</span>\n-                    <span ng-if=\"lint.level == 'Deny'\" class=\"label label-danger\">Deny</span>\n-                </h2>\n-            </header>\n-\n-            <ul class=\"list-group\" ng-if=\"lint.docs\" ng-class=\"{collapse: true, in: open[lint.id]}\">\n-                <li class=\"list-group-item\" ng-repeat=\"(title, text) in lint.docs\">\n-                    <h4 class=\"list-group-item-heading\">\n-                        {{title}}\n-                    </h4>\n-                    <div class=\"list-group-item-text\" ng-bind-html=\"text | markdown\"></div>\n-                </li>\n-            </ul>\n-        </article>\n+            <article class=\"panel panel-default\" id=\"{{lint.id}}\" ng-repeat=\"lint in data | filter:byLevels | filter:search | orderBy:'id' track by lint.id\">\n+                <header class=\"panel-heading\" ng-click=\"open[lint.id] = !open[lint.id]\">\n+                    <button class=\"btn btn-default btn-sm pull-right\" style=\"margin-top: -6px;\">\n+                        <span ng-show=\"open[lint.id]\">&minus;</span>\n+                        <span ng-hide=\"open[lint.id]\">&plus;</span>\n+                    </button>\n+\n+                    <h2 class=\"panel-title\">\n+                        {{lint.id}}\n+\n+                        <span ng-if=\"lint.level == 'Allow'\" class=\"label label-info\">Allow</span>\n+                        <span ng-if=\"lint.level == 'Warn'\" class=\"label label-warning\">Warn</span>\n+                        <span ng-if=\"lint.level == 'Deny'\" class=\"label label-danger\">Deny</span>\n+\n+                        <a href=\"#{{lint.id}}\" class=\"anchor label label-default\">&para;</a>\n+                    </h2>\n+                </header>\n+\n+                <ul class=\"list-group\" ng-if=\"lint.docs\" ng-class=\"{collapse: true, in: open[lint.id]}\">\n+                    <li class=\"list-group-item\" ng-repeat=\"(title, text) in lint.docs\">\n+                        <h4 class=\"list-group-item-heading\">\n+                            {{title}}\n+                        </h4>\n+                        <div class=\"list-group-item-text\" ng-bind-html=\"text | markdown\"></div>\n+                    </li>\n+                </ul>\n+            </article>\n+        </div>\n     </div>\n \n     <a href=\"https://github.com/Manishearth/rust-clippy\">\n         <img style=\"position: absolute; top: 0; right: 0; border: 0;\" src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png\"/>\n     </a>\n     \n-    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.2/marked.min.js\"></script>\n+    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/markdown-it/7.0.0/markdown-it.min.js\"></script>\n+    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/highlight.min.js\"></script>\n+    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/languages/rust.min.js\"></script>\n     <script src=\"https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.12/angular.min.js\"></script>\n     <script>\n     (function () {\n+        var md = window.markdownit({\n+            html: true,\n+            linkify: true,\n+            typographer: true,\n+            highlight: function (str, lang) {\n+                if (lang && hljs.getLanguage(lang)) {\n+                    try {\n+                        return '<pre class=\"hljs\"><code>' +\n+                            hljs.highlight(lang, str, true).value +\n+                            '</code></pre>';\n+                    } catch (__) {}\n+                }\n+\n+                return '<pre class=\"hljs\"><code>' + md.utils.escapeHtml(str) + '</code></pre>';\n+            }\n+        });\n+\n         angular.module(\"clippy\", [])\n         .filter('markdown', function ($sce) {\n             return function (text) {\n-                if (typeof text !== 'string') {\n-                    text = ''\n-                };\n-\n                 return $sce.trustAsHtml(\n-                    marked(text)\n+                    md.render(text || '')\n+                    // Oh deer, what a hack :O\n+                    .replace('<table', '<table class=\"table\"')\n                 );\n             };\n         })\n         .controller(\"lintList\", function ($scope, $http) {\n+            // Level filter\n+            $scope.levels = {Allow: true, Warn: true, Deny: true};\n+            $scope.byLevels = function (lint) {\n+                return $scope.levels[lint.level];\n+            };\n+\n             // Get data\n             $scope.open = {};\n             $scope.loading = true;"}]}