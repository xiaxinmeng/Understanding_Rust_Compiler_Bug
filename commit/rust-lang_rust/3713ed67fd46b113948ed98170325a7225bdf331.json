{"sha": "3713ed67fd46b113948ed98170325a7225bdf331", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM3MTNlZDY3ZmQ0NmIxMTM5NDhlZDk4MTcwMzI1YTcyMjViZGYzMzE=", "commit": {"author": {"name": "Mateusz Miku\u0142a", "email": "mati865@gmail.com", "date": "2020-02-28T13:15:06Z"}, "committer": {"name": "Mateusz Miku\u0142a", "email": "mati865@gmail.com", "date": "2020-02-28T13:15:06Z"}, "message": "Improve MinGW detection when cross compiling", "tree": {"sha": "54e2895637e9583a8c5319a3be705e8a6a3f6b4b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/54e2895637e9583a8c5319a3be705e8a6a3f6b4b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3713ed67fd46b113948ed98170325a7225bdf331", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3713ed67fd46b113948ed98170325a7225bdf331", "html_url": "https://github.com/rust-lang/rust/commit/3713ed67fd46b113948ed98170325a7225bdf331", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3713ed67fd46b113948ed98170325a7225bdf331/comments", "author": {"login": "mati865", "id": 1174646, "node_id": "MDQ6VXNlcjExNzQ2NDY=", "avatar_url": "https://avatars.githubusercontent.com/u/1174646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mati865", "html_url": "https://github.com/mati865", "followers_url": "https://api.github.com/users/mati865/followers", "following_url": "https://api.github.com/users/mati865/following{/other_user}", "gists_url": "https://api.github.com/users/mati865/gists{/gist_id}", "starred_url": "https://api.github.com/users/mati865/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mati865/subscriptions", "organizations_url": "https://api.github.com/users/mati865/orgs", "repos_url": "https://api.github.com/users/mati865/repos", "events_url": "https://api.github.com/users/mati865/events{/privacy}", "received_events_url": "https://api.github.com/users/mati865/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mati865", "id": 1174646, "node_id": "MDQ6VXNlcjExNzQ2NDY=", "avatar_url": "https://avatars.githubusercontent.com/u/1174646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mati865", "html_url": "https://github.com/mati865", "followers_url": "https://api.github.com/users/mati865/followers", "following_url": "https://api.github.com/users/mati865/following{/other_user}", "gists_url": "https://api.github.com/users/mati865/gists{/gist_id}", "starred_url": "https://api.github.com/users/mati865/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mati865/subscriptions", "organizations_url": "https://api.github.com/users/mati865/orgs", "repos_url": "https://api.github.com/users/mati865/repos", "events_url": "https://api.github.com/users/mati865/events{/privacy}", "received_events_url": "https://api.github.com/users/mati865/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a8437cf213ac1e950b6f5c691c4d2a29bf949bcd", "url": "https://api.github.com/repos/rust-lang/rust/commits/a8437cf213ac1e950b6f5c691c4d2a29bf949bcd", "html_url": "https://github.com/rust-lang/rust/commit/a8437cf213ac1e950b6f5c691c4d2a29bf949bcd"}], "stats": {"total": 11, "additions": 10, "deletions": 1}, "files": [{"sha": "d2f2bc56bdcb2f23b617155779644937117e8d82", "filename": "src/bootstrap/dist.rs", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/3713ed67fd46b113948ed98170325a7225bdf331/src%2Fbootstrap%2Fdist.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3713ed67fd46b113948ed98170325a7225bdf331/src%2Fbootstrap%2Fdist.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdist.rs?ref=3713ed67fd46b113948ed98170325a7225bdf331", "patch": "@@ -234,7 +234,14 @@ fn make_win_dist(\n         }\n     }\n \n-    let target_tools = [\"gcc.exe\", \"ld.exe\", \"dlltool.exe\", \"libwinpthread-1.dll\"];\n+    let compiler = if target_triple == \"i686-pc-windows-gnu\" {\n+        \"i686-w64-mingw32-gcc.exe\"\n+    } else if target_triple == \"x86_64-pc-windows-gnu\" {\n+        \"x86_64-w64-mingw32-gcc.exe\"\n+    } else {\n+        \"gcc.exe\"\n+    };\n+    let target_tools = [&compiler, \"ld.exe\", \"dlltool.exe\", \"libwinpthread-1.dll\"];\n     let mut rustc_dlls = vec![\"libwinpthread-1.dll\"];\n     if target_triple.starts_with(\"i686-\") {\n         rustc_dlls.push(\"libgcc_s_dw2-1.dll\");"}, {"sha": "2091902d7ce2128e207acb40cbde8cb23de0ccb5", "filename": "src/librustc_target/spec/i686_pc_windows_gnu.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3713ed67fd46b113948ed98170325a7225bdf331/src%2Flibrustc_target%2Fspec%2Fi686_pc_windows_gnu.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3713ed67fd46b113948ed98170325a7225bdf331/src%2Flibrustc_target%2Fspec%2Fi686_pc_windows_gnu.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_target%2Fspec%2Fi686_pc_windows_gnu.rs?ref=3713ed67fd46b113948ed98170325a7225bdf331", "patch": "@@ -5,6 +5,7 @@ pub fn target() -> TargetResult {\n     base.cpu = \"pentium4\".to_string();\n     base.max_atomic_width = Some(64);\n     base.eliminate_frame_pointer = false; // Required for backtraces\n+    base.linker = Some(\"i686-w64-mingw32-gcc\".to_string());\n \n     // Mark all dynamic libraries and executables as compatible with the larger 4GiB address\n     // space available to x86 Windows binaries on x86_64."}, {"sha": "3d3acc682dea434d93efbc5c2c8d14cbb45a2bd9", "filename": "src/librustc_target/spec/x86_64_pc_windows_gnu.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3713ed67fd46b113948ed98170325a7225bdf331/src%2Flibrustc_target%2Fspec%2Fx86_64_pc_windows_gnu.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3713ed67fd46b113948ed98170325a7225bdf331/src%2Flibrustc_target%2Fspec%2Fx86_64_pc_windows_gnu.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_target%2Fspec%2Fx86_64_pc_windows_gnu.rs?ref=3713ed67fd46b113948ed98170325a7225bdf331", "patch": "@@ -5,6 +5,7 @@ pub fn target() -> TargetResult {\n     base.cpu = \"x86-64\".to_string();\n     base.pre_link_args.get_mut(&LinkerFlavor::Gcc).unwrap().push(\"-m64\".to_string());\n     base.max_atomic_width = Some(64);\n+    base.linker = Some(\"x86_64-w64-mingw32-gcc\".to_string());\n \n     Ok(Target {\n         llvm_target: \"x86_64-pc-windows-gnu\".to_string(),"}]}