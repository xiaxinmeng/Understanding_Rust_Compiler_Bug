{"sha": "c3015b895254e059b163479849dfb1353929206f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMzMDE1Yjg5NTI1NGUwNTliMTYzNDc5ODQ5ZGZiMTM1MzkyOTIwNmY=", "commit": {"author": {"name": "Rafael \u00c1vila de Esp\u00edndola", "email": "respindola@mozilla.com", "date": "2011-06-14T21:51:31Z"}, "committer": {"name": "Rafael \u00c1vila de Esp\u00edndola", "email": "respindola@mozilla.com", "date": "2011-06-14T21:51:31Z"}, "message": "Apply the makefile changes again, this time fixin the driver to not produce a\nrustc.exe.exe.", "tree": {"sha": "1103dccd5c7b8add043672b2cd2fca2fb3168d81", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1103dccd5c7b8add043672b2cd2fca2fb3168d81"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c3015b895254e059b163479849dfb1353929206f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c3015b895254e059b163479849dfb1353929206f", "html_url": "https://github.com/rust-lang/rust/commit/c3015b895254e059b163479849dfb1353929206f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c3015b895254e059b163479849dfb1353929206f/comments", "author": null, "committer": null, "parents": [{"sha": "1cc7165e62f17b24c2f14eb733f07ac7469c4420", "url": "https://api.github.com/repos/rust-lang/rust/commits/1cc7165e62f17b24c2f14eb733f07ac7469c4420", "html_url": "https://github.com/rust-lang/rust/commit/1cc7165e62f17b24c2f14eb733f07ac7469c4420"}], "stats": {"total": 31, "additions": 9, "deletions": 22}, "files": [{"sha": "bdf175f2bdab99ae0c049f0057f73a3459c14a7a", "filename": "mk/tests.mk", "status": "modified", "additions": 6, "deletions": 17, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/c3015b895254e059b163479849dfb1353929206f/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/c3015b895254e059b163479849dfb1353929206f/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=c3015b895254e059b163479849dfb1353929206f", "patch": "@@ -200,15 +200,13 @@ compile-check: tidy \\\n \t@# programs, I\\'ll live with the noise.\n \t-$(Q)$(CFG_DSYMUTIL) $@\n \n-%.stage2$(X): %.stage2.o $(SREQ2)\n-\t@$(call E, link [gcc]: $@)\n-\t$(Q)gcc $(CFG_GCCISH_CFLAGS) stage3/glue.o -o $@ $< \\\n-      -Lstage3 -Lrt rt/main.o -lrustrt -lstd -lm\n-\t@# dsymutil sometimes fails or prints a warning, but the\n-\t@# program still runs.  Since it simplifies debugging other\n-\t@# programs, I\\'ll live with the noise.\n-\t-$(Q)$(CFG_DSYMUTIL) $@\n+%.stage2$(X): %.rs $(SREQ2)\n+\t@$(call E, compile_and_link: $@)\n+\t$(STAGE2) -o $@ $<\n \n+%.stage2$(X): %.rc $(SREQ2)\n+\t@$(call E, compile_and_link: $@)\n+\t$(STAGE2) -o $@ $<\n \n %.stage0.o: %.rc $(SREQ0)\n \t@$(call E, compile [stage0]: $@)\n@@ -227,15 +225,6 @@ compile-check: tidy \\\n \t@$(call E, compile [stage1]: $@)\n \t$(STAGE1) -c -o $@ $<\n \n-\n-%.stage2.o: %.rc $(SREQ2)\n-\t@$(call E, compile [stage2]: $@)\n-\t$(STAGE2) -c -o $@ $<\n-\n-%.stage2.o: %.rs $(SREQ2)\n-\t@$(call E, compile [stage2]: $@)\n-\t$(STAGE2) -c -o $@ $<\n-\n # Cancel the implicit .out rule in GNU make.\n %.out: %\n "}, {"sha": "939c547d84d03a516a121ca75bb8ac2164d6917a", "filename": "src/comp/driver/rustc.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/c3015b895254e059b163479849dfb1353929206f/src%2Fcomp%2Fdriver%2Frustc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c3015b895254e059b163479849dfb1353929206f/src%2Fcomp%2Fdriver%2Frustc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fdriver%2Frustc.rs?ref=c3015b895254e059b163479849dfb1353929206f", "patch": "@@ -449,7 +449,6 @@ fn main(vec[str] args) {\n         let str stage = \"-L\" + binary_dir;\n         let vec[str] gcc_args;\n         let str prog = \"gcc\";\n-        let str exe_suffix = \"\";\n \n         // The invocations of gcc share some flags across platforms\n         let vec[str] common_cflags = [\"-fno-strict-aliasing\", \"-fPIC\",\n@@ -459,25 +458,24 @@ fn main(vec[str] args) {\n \n         alt (sess.get_targ_cfg().os) {\n             case (session::os_win32) {\n-                exe_suffix = \".exe\";\n                 gcc_args = common_cflags + [\n                             \"-march=i686\", \"-O2\",\n                             glu, main, \"-o\",\n-                            saved_out_filename + exe_suffix,\n+                            saved_out_filename,\n                             saved_out_filename + \".o\"] + common_libs;\n             }\n             case (session::os_macos) {\n                 gcc_args = common_cflags + [\n                            \"-arch i386\", \"-O0\", \"-m32\",\n                            glu, main, \"-o\",\n-                           saved_out_filename + exe_suffix,\n+                           saved_out_filename,\n                            saved_out_filename + \".o\"] + common_libs;\n             }\n             case (session::os_linux) {\n                 gcc_args = common_cflags + [\n                            \"-march=i686\", \"-O2\", \"-m32\",\n                            glu, main, \"-o\",\n-                           saved_out_filename + exe_suffix,\n+                           saved_out_filename,\n                            saved_out_filename + \".o\"] + common_libs;\n             }\n         }"}]}