{"sha": "53044158eff0d64673a6100f701c57b484232aca", "node_id": "C_kwDOAAsO6NoAKDUzMDQ0MTU4ZWZmMGQ2NDY3M2E2MTAwZjcwMWM1N2I0ODQyMzJhY2E", "commit": {"author": {"name": "Ezra Shaw", "email": "ezrasure@outlook.com", "date": "2023-02-25T09:59:20Z"}, "committer": {"name": "Ezra Shaw", "email": "ezrasure@outlook.com", "date": "2023-02-26T07:13:06Z"}, "message": "refactor: improve `error-index-generator` dependency", "tree": {"sha": "1c4749850696514978c97ec05e1304071a4e5353", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1c4749850696514978c97ec05e1304071a4e5353"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/53044158eff0d64673a6100f701c57b484232aca", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEINUdoc4Vb1yVx04IZ6vxb7Ds2HAFAmP7BoQACgkQZ6vxb7Ds\n2HA6IQ/+LXxHdG3dsX3IOYUlUTPX7aPY0ejlJqnDgcrNEhXe3PYdhUIpa5lNoJvp\nhWB74RpYCLeRxQATv98l8xFGcolROsTKhLZtgzwLrlFOPbnbY5iDGGUlOGPlfgEe\nBO2TpdRT/PJ6wu38Dh6lZiVKowPdulhYpf6mdz8Ydid2u1+/5rVNzJZ67Z9kaVFX\nS01gnAee+sRAqm6moH9tbwg/b61Xr6utcj9Z6Q+EwDOaY9IfF9cl458nCz65JPnK\n4q3YoaIjNGrd4rFkd+Fcb7PNgsa98d4VX/j7+0AUh1KPVD4KnYMPQKzrIaRzCq8b\nxYAgi2+mdVgymbTn8Cq0Z77Lcj58bnxZzgbIUFApRStxH4JKkkNArVO5uZgTsVTA\nM0QEO5iBE6kCn1kP1w6KOt2sEuvPz84b01FsFdnUJwSAGTh3a+h7htZB7/ZjuUor\nQOF6FdFN1vcZzbEdEEXF1I08FFRIY2ZYN8PavXdvpn3lNkZug5vmgrnSd5YITiCy\nu/avIWOCLsExmyaykCZ6tsQeRsaUza+4YB6dG0lr4Cw+Gd8khRMMqeAzH6FQFjsV\nuGHGI6jD4rfJPiMQuBtusxNn6JWbV0FY8arjfky/IvSigRj9JEkywulGiyPJ8ztY\nTPHaDDeRPvQjWTb09m5LUW1//ctMhPgOfRT8ujpeouPHWOJmX88=\n=ybu/\n-----END PGP SIGNATURE-----", "payload": "tree 1c4749850696514978c97ec05e1304071a4e5353\nparent 90677edcba063ee83316ef109e0fe54116015575\nauthor Ezra Shaw <ezrasure@outlook.com> 1677319160 +1300\ncommitter Ezra Shaw <ezrasure@outlook.com> 1677395586 +1300\n\nrefactor: improve `error-index-generator` dependency\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/53044158eff0d64673a6100f701c57b484232aca", "html_url": "https://github.com/rust-lang/rust/commit/53044158eff0d64673a6100f701c57b484232aca", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/53044158eff0d64673a6100f701c57b484232aca/comments", "author": {"login": "Ezrashaw", "id": 38062690, "node_id": "MDQ6VXNlcjM4MDYyNjkw", "avatar_url": "https://avatars.githubusercontent.com/u/38062690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ezrashaw", "html_url": "https://github.com/Ezrashaw", "followers_url": "https://api.github.com/users/Ezrashaw/followers", "following_url": "https://api.github.com/users/Ezrashaw/following{/other_user}", "gists_url": "https://api.github.com/users/Ezrashaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ezrashaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ezrashaw/subscriptions", "organizations_url": "https://api.github.com/users/Ezrashaw/orgs", "repos_url": "https://api.github.com/users/Ezrashaw/repos", "events_url": "https://api.github.com/users/Ezrashaw/events{/privacy}", "received_events_url": "https://api.github.com/users/Ezrashaw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Ezrashaw", "id": 38062690, "node_id": "MDQ6VXNlcjM4MDYyNjkw", "avatar_url": "https://avatars.githubusercontent.com/u/38062690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ezrashaw", "html_url": "https://github.com/Ezrashaw", "followers_url": "https://api.github.com/users/Ezrashaw/followers", "following_url": "https://api.github.com/users/Ezrashaw/following{/other_user}", "gists_url": "https://api.github.com/users/Ezrashaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ezrashaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ezrashaw/subscriptions", "organizations_url": "https://api.github.com/users/Ezrashaw/orgs", "repos_url": "https://api.github.com/users/Ezrashaw/repos", "events_url": "https://api.github.com/users/Ezrashaw/events{/privacy}", "received_events_url": "https://api.github.com/users/Ezrashaw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "90677edcba063ee83316ef109e0fe54116015575", "url": "https://api.github.com/repos/rust-lang/rust/commits/90677edcba063ee83316ef109e0fe54116015575", "html_url": "https://github.com/rust-lang/rust/commit/90677edcba063ee83316ef109e0fe54116015575"}], "stats": {"total": 23, "additions": 3, "deletions": 20}, "files": [{"sha": "9e5deedb66fff860078878c56e9641789fb45d1d", "filename": "Cargo.lock", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/53044158eff0d64673a6100f701c57b484232aca/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/53044158eff0d64673a6100f701c57b484232aca/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=53044158eff0d64673a6100f701c57b484232aca", "patch": "@@ -1445,6 +1445,7 @@ name = \"error_index_generator\"\n version = \"0.0.0\"\n dependencies = [\n  \"mdbook\",\n+ \"rustc_error_codes\",\n ]\n \n [[package]]"}, {"sha": "76c2e330b2100236b1b8fddd1640ccbb8b7cca97", "filename": "src/tools/error_index_generator/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/53044158eff0d64673a6100f701c57b484232aca/src%2Ftools%2Ferror_index_generator%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/53044158eff0d64673a6100f701c57b484232aca/src%2Ftools%2Ferror_index_generator%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Ferror_index_generator%2FCargo.toml?ref=53044158eff0d64673a6100f701c57b484232aca", "patch": "@@ -5,6 +5,7 @@ edition = \"2021\"\n \n [dependencies]\n mdbook = { version = \"0.4\", default-features = false, features = [\"search\"] }\n+rustc_error_codes = { version = \"0.0.0\", path = \"../../../compiler/rustc_error_codes\" }\n \n [[bin]]\n name = \"error_index_generator\""}, {"sha": "f984275b164cc0be8f643903b323662f98331a35", "filename": "src/tools/error_index_generator/main.rs", "status": "modified", "additions": 1, "deletions": 20, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/53044158eff0d64673a6100f701c57b484232aca/src%2Ftools%2Ferror_index_generator%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/53044158eff0d64673a6100f701c57b484232aca/src%2Ftools%2Ferror_index_generator%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Ferror_index_generator%2Fmain.rs?ref=53044158eff0d64673a6100f701c57b484232aca", "patch": "@@ -2,9 +2,6 @@\n \n extern crate rustc_driver;\n \n-// We use the function we generate from `register_diagnostics!`.\n-use crate::error_codes::error_codes;\n-\n use std::env;\n use std::error::Error;\n use std::fs::{self, File};\n@@ -17,22 +14,6 @@ use std::str::FromStr;\n use mdbook::book::{parse_summary, BookItem, Chapter};\n use mdbook::{Config, MDBook};\n \n-macro_rules! register_diagnostics {\n-    ($($error_code:ident: $message:expr,)+ ; $($undocumented:ident,)* ) => {\n-        pub fn error_codes() -> Vec<(&'static str, Option<&'static str>)> {\n-            let mut errors: Vec<(&str, Option<&str>)> = vec![\n-                $((stringify!($error_code), Some($message)),)+\n-                $((stringify!($undocumented), None),)*\n-            ];\n-            errors.sort();\n-            errors\n-        }\n-    }\n-}\n-\n-#[path = \"../../../compiler/rustc_error_codes/src/error_codes.rs\"]\n-mod error_codes;\n-\n enum OutputFormat {\n     HTML,\n     Markdown,\n@@ -102,7 +83,7 @@ This page lists all the error codes emitted by the Rust compiler.\n \"\n     );\n \n-    let err_codes = error_codes();\n+    let err_codes = rustc_error_codes::DIAGNOSTICS;\n     let mut chapters = Vec::with_capacity(err_codes.len());\n \n     for (err_code, explanation) in err_codes.iter() {"}]}