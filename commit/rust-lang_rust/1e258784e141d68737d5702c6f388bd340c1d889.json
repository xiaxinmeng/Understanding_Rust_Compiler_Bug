{"sha": "1e258784e141d68737d5702c6f388bd340c1d889", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFlMjU4Nzg0ZTE0MWQ2ODczN2Q1NzAyYzZmMzg4YmQzNDBjMWQ4ODk=", "commit": {"author": {"name": "Yuki Okushi", "email": "huyuumi.dev@gmail.com", "date": "2020-03-01T10:28:05Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-03-01T10:28:05Z"}, "message": "Rollup merge of #69397 - tmiasko:llvm-version-suffix, r=nagisa\n\nbootstrap: Remove commit hash from LLVM version suffix to avoid rebuilds\n\nThe custom LLVM version suffix was introduced to avoid unintentional\nlibrary names conflicts. By default it included the LLVM submodule\ncommit hash. Changing the version suffix requires the complete LLVM\nrebuild, and since then every change to the submodules required it as\nwell.\n\nRemove the commit hash from version suffix to avoid complete rebuilds,\nwhile leaving the `rust` string, the release number and release channel\nto disambiguate the library name.\n\nContext: version suffix was introduced by #59173 as solution to #59034.\n\nResolves #68715.", "tree": {"sha": "bc7354fb77d308a5710a35c56e7126854706ef3f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bc7354fb77d308a5710a35c56e7126854706ef3f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1e258784e141d68737d5702c6f388bd340c1d889", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJeW442CRBK7hj4Ov3rIwAAdHIIAFyakRMpHdNsMmJKlQSiPDMM\n3qOsXzgmx+V4uCvniCZUYJ8GVvJV0r+xNfYqyYedyg+NQVr3L40p5Up9XxrV8V00\nZV3+0FBMcUoESFUexacdCckVW/RZiQUSk3WMpuR+UlKdMWxyufGRgfNHA23yAA31\nes9nXArCgz/XQXyhL5wekehMX/tDhhfCN3PKKAFY0NXx6ePM4e6Ua2BcZRYObbi9\n4iPHBMZ6L28auc4J4LOUB9iBQqnzI0tcMEgf+O48BwnI1cWf4yDl/+AZIbbmXftx\nOpJ+kk/njz93iHOOga7mfm7XmH2CISTbAKMfpVXY/IkiwSsKVsDDmZukZFw11Cc=\n=lhCx\n-----END PGP SIGNATURE-----\n", "payload": "tree bc7354fb77d308a5710a35c56e7126854706ef3f\nparent d9051341a1c142542a3f7dab509266606c775382\nparent 598b187e2738b5b551f84be30cc15503896fe4ba\nauthor Yuki Okushi <huyuumi.dev@gmail.com> 1583058485 +0900\ncommitter GitHub <noreply@github.com> 1583058485 +0900\n\nRollup merge of #69397 - tmiasko:llvm-version-suffix, r=nagisa\n\nbootstrap: Remove commit hash from LLVM version suffix to avoid rebuilds\n\nThe custom LLVM version suffix was introduced to avoid unintentional\nlibrary names conflicts. By default it included the LLVM submodule\ncommit hash. Changing the version suffix requires the complete LLVM\nrebuild, and since then every change to the submodules required it as\nwell.\n\nRemove the commit hash from version suffix to avoid complete rebuilds,\nwhile leaving the `rust` string, the release number and release channel\nto disambiguate the library name.\n\nContext: version suffix was introduced by #59173 as solution to #59034.\n\nResolves #68715.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1e258784e141d68737d5702c6f388bd340c1d889", "html_url": "https://github.com/rust-lang/rust/commit/1e258784e141d68737d5702c6f388bd340c1d889", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1e258784e141d68737d5702c6f388bd340c1d889/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d9051341a1c142542a3f7dab509266606c775382", "url": "https://api.github.com/repos/rust-lang/rust/commits/d9051341a1c142542a3f7dab509266606c775382", "html_url": "https://github.com/rust-lang/rust/commit/d9051341a1c142542a3f7dab509266606c775382"}, {"sha": "598b187e2738b5b551f84be30cc15503896fe4ba", "url": "https://api.github.com/repos/rust-lang/rust/commits/598b187e2738b5b551f84be30cc15503896fe4ba", "html_url": "https://github.com/rust-lang/rust/commit/598b187e2738b5b551f84be30cc15503896fe4ba"}], "stats": {"total": 8, "additions": 2, "deletions": 6}, "files": [{"sha": "c22c2a336f1240e16d08d6ed9e80f329d5a215a8", "filename": "src/bootstrap/native.rs", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1e258784e141d68737d5702c6f388bd340c1d889/src%2Fbootstrap%2Fnative.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1e258784e141d68737d5702c6f388bd340c1d889/src%2Fbootstrap%2Fnative.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fnative.rs?ref=1e258784e141d68737d5702c6f388bd340c1d889", "patch": "@@ -241,12 +241,8 @@ impl Step for Llvm {\n                 cfg.define(\"LLVM_VERSION_SUFFIX\", suffix);\n             }\n         } else {\n-            let mut default_suffix =\n-                format!(\"-rust-{}-{}\", channel::CFG_RELEASE_NUM, builder.config.channel,);\n-            if let Some(sha) = llvm_info.sha_short() {\n-                default_suffix.push_str(\"-\");\n-                default_suffix.push_str(sha);\n-            }\n+            let default_suffix =\n+                format!(\"-rust-{}-{}\", channel::CFG_RELEASE_NUM, builder.config.channel);\n             cfg.define(\"LLVM_VERSION_SUFFIX\", default_suffix);\n         }\n "}]}