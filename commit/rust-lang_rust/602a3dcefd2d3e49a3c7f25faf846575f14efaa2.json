{"sha": "602a3dcefd2d3e49a3c7f25faf846575f14efaa2", "node_id": "C_kwDOAAsO6NoAKDYwMmEzZGNlZmQyZDNlNDlhM2M3ZjI1ZmFmODQ2NTc1ZjE0ZWZhYTI", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-07-02T07:31:16Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-07-02T07:31:16Z"}, "message": "Auto merge of #2304 - LegNeato:shim-fstat64-mac, r=oli-obk\n\nSupport (stat/fstat/lstat)64 on macos\n\n\"In order to accommodate advanced capabilities of newer file systems,\n     the struct stat, struct statfs, and struct dirent data structures\n     were updated in Mac OSX 10.5.\"\n\n\"TRANSITIONAL DESCRIPTION (NOW DEPRECATED)\n     The fstat64, lstat64 and stat64 routines are equivalent to their\n     corresponding non-64-suffixed routine, when 64-bit inodes are in\n     effect.  They were added before there was support for the symbol\n     variants, and so are now deprecated.  Instead of using these, set\n     the _DARWIN_USE_64_BIT_INODE macro before including header files to\n     force 64-bit inode support. The stat64 structure used by these deprecated routines is the same\n     as the stat structure when 64-bit inodes are in effect (see above).\"\n\n\"HISTORY\n     An lstat() function call appeared in 4.2BSD.  The stat64(),\n     fstat64(), and lstat64() system calls first appeared in Mac OS X\n     10.5 (Leopard) and are now deprecated in favor of the corresponding\n     symbol variants.  The fstatat() system call appeared in OS X 10.10\"", "tree": {"sha": "ab37cb5a68a1d6fcf2c0cdb1e06e0f3e96a0b720", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ab37cb5a68a1d6fcf2c0cdb1e06e0f3e96a0b720"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/602a3dcefd2d3e49a3c7f25faf846575f14efaa2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/602a3dcefd2d3e49a3c7f25faf846575f14efaa2", "html_url": "https://github.com/rust-lang/rust/commit/602a3dcefd2d3e49a3c7f25faf846575f14efaa2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/602a3dcefd2d3e49a3c7f25faf846575f14efaa2/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d118a949f7c2193146861ae468aa12ae1e6b6d31", "url": "https://api.github.com/repos/rust-lang/rust/commits/d118a949f7c2193146861ae468aa12ae1e6b6d31", "html_url": "https://github.com/rust-lang/rust/commit/d118a949f7c2193146861ae468aa12ae1e6b6d31"}, {"sha": "a1473ea8f5b065a81c046d53e465d1d0b9e01fad", "url": "https://api.github.com/repos/rust-lang/rust/commits/a1473ea8f5b065a81c046d53e465d1d0b9e01fad", "html_url": "https://github.com/rust-lang/rust/commit/a1473ea8f5b065a81c046d53e465d1d0b9e01fad"}], "stats": {"total": 6, "additions": 3, "deletions": 3}, "files": [{"sha": "5cd885db7099b90ceec35cd88407f59c13849d76", "filename": "src/shims/unix/macos/foreign_items.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/602a3dcefd2d3e49a3c7f25faf846575f14efaa2/src%2Fshims%2Funix%2Fmacos%2Fforeign_items.rs", "raw_url": "https://github.com/rust-lang/rust/raw/602a3dcefd2d3e49a3c7f25faf846575f14efaa2/src%2Fshims%2Funix%2Fmacos%2Fforeign_items.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Funix%2Fmacos%2Fforeign_items.rs?ref=602a3dcefd2d3e49a3c7f25faf846575f14efaa2", "patch": "@@ -33,19 +33,19 @@ pub trait EvalContextExt<'mir, 'tcx: 'mir>: crate::MiriEvalContextExt<'mir, 'tcx\n                 let result = this.close(result)?;\n                 this.write_scalar(Scalar::from_i32(result), dest)?;\n             }\n-            \"stat\" | \"stat$INODE64\" => {\n+            \"stat\" | \"stat64\" | \"stat$INODE64\" => {\n                 let [path, buf] =\n                     this.check_shim(abi, Abi::C { unwind: false }, link_name, args)?;\n                 let result = this.macos_stat(path, buf)?;\n                 this.write_scalar(Scalar::from_i32(result), dest)?;\n             }\n-            \"lstat\" | \"lstat$INODE64\" => {\n+            \"lstat\" | \"lstat64\" | \"lstat$INODE64\" => {\n                 let [path, buf] =\n                     this.check_shim(abi, Abi::C { unwind: false }, link_name, args)?;\n                 let result = this.macos_lstat(path, buf)?;\n                 this.write_scalar(Scalar::from_i32(result), dest)?;\n             }\n-            \"fstat\" | \"fstat$INODE64\" => {\n+            \"fstat\" | \"fstat64\" | \"fstat$INODE64\" => {\n                 let [fd, buf] = this.check_shim(abi, Abi::C { unwind: false }, link_name, args)?;\n                 let result = this.macos_fstat(fd, buf)?;\n                 this.write_scalar(Scalar::from_i32(result), dest)?;"}]}