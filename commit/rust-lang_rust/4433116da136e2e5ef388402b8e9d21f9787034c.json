{"sha": "4433116da136e2e5ef388402b8e9d21f9787034c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ0MzMxMTZkYTEzNmUyZTVlZjM4ODQwMmI4ZTlkMjFmOTc4NzAzNGM=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-10-01T09:49:09Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-10-01T09:49:09Z"}, "message": "Rollup merge of #54713 - flip1995:tool_lints_nightly, r=Manishearth\n\nAdd nightly check for tool_lints warning\n\ncc #54358\n\nLet's add the nightly check, just in case something prevents a stabilization until 1.31.beta.", "tree": {"sha": "5018a12a678754aa8ccefda454a67369a4e9775c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5018a12a678754aa8ccefda454a67369a4e9775c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4433116da136e2e5ef388402b8e9d21f9787034c", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlux7ZUACgkQ/vbIBR0O\nATwIpRAApRgsijacyS7nxjE8qimVxWB9/fJkgZKQJxC6YbEnD+cCds9FNIoXqHRb\nXxz8l5lqguQs3t/ad4IF+aaS/Fn2nlxx2zidXcVC4i7bS+n1pBNOroIf22d16vd3\nnM+rkI9xpJQWFtZeEkg0Oz5qeR6aodGKh2nMHtLolDJP6vc3MVsezQPopsQ6yrDL\n/x2B/oPo50M+RNM8pczyOqT9wL4c70pBO0ASnb4j+9sPjz1PVkRS2NYasneTR/ga\n5Y+RhLOYEZk+0ky3riBD7PzNK+vnmJtxD1XJBrJ0xYDzeK+FYdzm0cxtSCz5BStY\nU+4Wtt/p3+RThrx1ByfZC2uOJIbVU9kv9bGKWyzfbf4d60KC6LJkpCJ8v8mc+QnL\nquqNg5pYA6jpqvY3jCg0nZJ8tiC60bAr4hNqB2Uz8CBILmmpoMKqS7ofTKg/Ywxe\nuj6ZsYrlHOv0mn0FJolDxfKwOALH8CqY0Cb1UR4srIfxs4uEnLzddXI7utcGMivP\nj0zlBph12uamfPYz7blPXJ6miEyV+49aSeixYvocDX0QZ+lIzxKo8eoC9Zrelulx\nKuzbD8TveQFyCNEs7AashMZEQ1LOTYUEETcJthjvbQWTTU9aJ4Pe2zCE9iDHSe9i\nCRPld/8VSzOUJeu7CzfDCN/jQIInIeJtf9EgmjP+EUDGkmw2gu0=\n=ZSdA\n-----END PGP SIGNATURE-----", "payload": "tree 5018a12a678754aa8ccefda454a67369a4e9775c\nparent 94254d38835c786b333c1ffbaeacebed36b4466c\nparent e68db042888f6b3cb6164a5cc5bfc3a79faa851c\nauthor kennytm <kennytm@gmail.com> 1538387349 +0800\ncommitter kennytm <kennytm@gmail.com> 1538387349 +0800\n\nRollup merge of #54713 - flip1995:tool_lints_nightly, r=Manishearth\n\nAdd nightly check for tool_lints warning\n\ncc #54358\n\nLet's add the nightly check, just in case something prevents a stabilization until 1.31.beta.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4433116da136e2e5ef388402b8e9d21f9787034c", "html_url": "https://github.com/rust-lang/rust/commit/4433116da136e2e5ef388402b8e9d21f9787034c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4433116da136e2e5ef388402b8e9d21f9787034c/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "94254d38835c786b333c1ffbaeacebed36b4466c", "url": "https://api.github.com/repos/rust-lang/rust/commits/94254d38835c786b333c1ffbaeacebed36b4466c", "html_url": "https://github.com/rust-lang/rust/commit/94254d38835c786b333c1ffbaeacebed36b4466c"}, {"sha": "e68db042888f6b3cb6164a5cc5bfc3a79faa851c", "url": "https://api.github.com/repos/rust-lang/rust/commits/e68db042888f6b3cb6164a5cc5bfc3a79faa851c", "html_url": "https://github.com/rust-lang/rust/commit/e68db042888f6b3cb6164a5cc5bfc3a79faa851c"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "87d33e473e7f6cd97bc392e3f6bf926518744264", "filename": "src/librustc/lint/levels.rs", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/4433116da136e2e5ef388402b8e9d21f9787034c/src%2Flibrustc%2Flint%2Flevels.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4433116da136e2e5ef388402b8e9d21f9787034c/src%2Flibrustc%2Flint%2Flevels.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Flint%2Flevels.rs?ref=4433116da136e2e5ef388402b8e9d21f9787034c", "patch": "@@ -18,7 +18,7 @@ use lint::context::CheckLintNameResult;\n use lint::{self, Lint, LintId, Level, LintSource};\n use rustc_data_structures::stable_hasher::{HashStable, ToStableHashKey,\n                                            StableHasher, StableHasherResult};\n-use session::Session;\n+use session::{config::nightly_options, Session};\n use syntax::ast;\n use syntax::attr;\n use syntax::source_map::MultiSpan;\n@@ -299,7 +299,13 @@ impl<'a> LintLevelsBuilder<'a> {\n                                     \"change it to\",\n                                     new_lint_name.to_string(),\n                                     Applicability::MachineApplicable,\n-                                ).emit();\n+                                );\n+\n+                                if nightly_options::is_nightly_build() {\n+                                    err.emit();\n+                                } else {\n+                                    err.cancel();\n+                                }\n \n                                 let src = LintSource::Node(Symbol::intern(&new_lint_name), li.span);\n                                 for id in ids {"}]}