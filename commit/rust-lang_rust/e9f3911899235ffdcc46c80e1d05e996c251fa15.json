{"sha": "e9f3911899235ffdcc46c80e1d05e996c251fa15", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU5ZjM5MTE4OTkyMzVmZmRjYzQ2YzgwZTFkMDVlOTk2YzI1MWZhMTU=", "commit": {"author": {"name": "Phil Turnbull", "email": "philip.turnbull@gmail.com", "date": "2016-11-20T16:19:36Z"}, "committer": {"name": "Phil Turnbull", "email": "philip.turnbull@gmail.com", "date": "2016-11-20T16:19:36Z"}, "message": "Suggest `&s` instead of `s.as_str()`", "tree": {"sha": "e7f2fd5be4872676cfa85f60000971091c5a0553", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e7f2fd5be4872676cfa85f60000971091c5a0553"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e9f3911899235ffdcc46c80e1d05e996c251fa15", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e9f3911899235ffdcc46c80e1d05e996c251fa15", "html_url": "https://github.com/rust-lang/rust/commit/e9f3911899235ffdcc46c80e1d05e996c251fa15", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e9f3911899235ffdcc46c80e1d05e996c251fa15/comments", "author": {"login": "philipturnbull", "id": 45588, "node_id": "MDQ6VXNlcjQ1NTg4", "avatar_url": "https://avatars.githubusercontent.com/u/45588?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philipturnbull", "html_url": "https://github.com/philipturnbull", "followers_url": "https://api.github.com/users/philipturnbull/followers", "following_url": "https://api.github.com/users/philipturnbull/following{/other_user}", "gists_url": "https://api.github.com/users/philipturnbull/gists{/gist_id}", "starred_url": "https://api.github.com/users/philipturnbull/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philipturnbull/subscriptions", "organizations_url": "https://api.github.com/users/philipturnbull/orgs", "repos_url": "https://api.github.com/users/philipturnbull/repos", "events_url": "https://api.github.com/users/philipturnbull/events{/privacy}", "received_events_url": "https://api.github.com/users/philipturnbull/received_events", "type": "User", "site_admin": false}, "committer": {"login": "philipturnbull", "id": 45588, "node_id": "MDQ6VXNlcjQ1NTg4", "avatar_url": "https://avatars.githubusercontent.com/u/45588?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philipturnbull", "html_url": "https://github.com/philipturnbull", "followers_url": "https://api.github.com/users/philipturnbull/followers", "following_url": "https://api.github.com/users/philipturnbull/following{/other_user}", "gists_url": "https://api.github.com/users/philipturnbull/gists{/gist_id}", "starred_url": "https://api.github.com/users/philipturnbull/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philipturnbull/subscriptions", "organizations_url": "https://api.github.com/users/philipturnbull/orgs", "repos_url": "https://api.github.com/users/philipturnbull/repos", "events_url": "https://api.github.com/users/philipturnbull/events{/privacy}", "received_events_url": "https://api.github.com/users/philipturnbull/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "73a73638c0d25318608b6aba36d9e21c6e24f89e", "url": "https://api.github.com/repos/rust-lang/rust/commits/73a73638c0d25318608b6aba36d9e21c6e24f89e", "html_url": "https://github.com/rust-lang/rust/commit/73a73638c0d25318608b6aba36d9e21c6e24f89e"}], "stats": {"total": 14, "additions": 7, "deletions": 7}, "files": [{"sha": "d1192e3f26bc67cac3f6b9a173b926c37e3d7b1d", "filename": "clippy_lints/src/methods.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/e9f3911899235ffdcc46c80e1d05e996c251fa15/clippy_lints%2Fsrc%2Fmethods.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e9f3911899235ffdcc46c80e1d05e996c251fa15/clippy_lints%2Fsrc%2Fmethods.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods.rs?ref=e9f3911899235ffdcc46c80e1d05e996c251fa15", "patch": "@@ -511,7 +511,7 @@ declare_lint! {\n /// let def = String::from(\"def\");\n /// let mut s = String::new();\n /// s.push_str(abc);\n-/// s.push_str(def.as_str());\n+/// s.push_str(&def));\n /// ```\n \n declare_lint! {\n@@ -843,10 +843,10 @@ fn lint_string_extend(cx: &LateContext, expr: &hir::Expr, args: &MethodArgs) {\n     if let Some(arglists) = method_chain_args(arg, &[\"chars\"]) {\n         let target = &arglists[0][0];\n         let (self_ty, _) = walk_ptrs_ty_depth(cx.tcx.tables().expr_ty(target));\n-        let extra_suggestion = if self_ty.sty == ty::TyStr {\n+        let ref_str = if self_ty.sty == ty::TyStr {\n             \"\"\n         } else if match_type(cx, self_ty, &paths::STRING) {\n-            \".as_str()\"\n+            \"&\"\n         } else {\n             return;\n         };\n@@ -860,8 +860,8 @@ fn lint_string_extend(cx: &LateContext, expr: &hir::Expr, args: &MethodArgs) {\n                 db.span_suggestion(expr.span, \"try this\",\n                         format!(\"{}.push_str({}{})\",\n                                 snippet(cx, args[0].span, \"_\"),\n-                                snippet(cx, target.span, \"_\"),\n-                                extra_suggestion));\n+                                ref_str,\n+                                snippet(cx, target.span, \"_\")));\n             });\n     }\n }"}, {"sha": "0add705d6f8cfad0b4c47b32194e171e135d5316", "filename": "tests/compile-fail/methods.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/e9f3911899235ffdcc46c80e1d05e996c251fa15/tests%2Fcompile-fail%2Fmethods.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e9f3911899235ffdcc46c80e1d05e996c251fa15/tests%2Fcompile-fail%2Fmethods.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Fmethods.rs?ref=e9f3911899235ffdcc46c80e1d05e996c251fa15", "patch": "@@ -550,11 +550,11 @@ fn str_extend_chars() {\n     //~|HELP try this\n     //~|SUGGESTION s.push_str(\"abc\")\n \n-    s.push_str(def.as_str());\n+    s.push_str(&def);\n     s.extend(def.chars());\n     //~^ERROR calling `.extend(_.chars())`\n     //~|HELP try this\n-    //~|SUGGESTION s.push_str(def.as_str())\n+    //~|SUGGESTION s.push_str(&def)\n \n     s.extend(abc.chars().skip(1));\n     s.extend(\"abc\".chars().skip(1));"}]}