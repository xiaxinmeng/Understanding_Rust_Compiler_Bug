{"sha": "c3cf3b3fb10754f92c0703062c39726b52726298", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMzY2YzYjNmYjEwNzU0ZjkyYzA3MDMwNjJjMzk3MjZiNTI3MjYyOTg=", "commit": {"author": {"name": "Adolfo Ochagav\u00eda", "email": "aochagavia92@gmail.com", "date": "2014-06-29T09:33:45Z"}, "committer": {"name": "Adolfo Ochagav\u00eda", "email": "aochagavia92@gmail.com", "date": "2014-06-30T19:35:50Z"}, "message": "Implement ToJson for all tuples", "tree": {"sha": "d9ce83ed520ef0d52a0c0203a4ad3b9944f46f39", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d9ce83ed520ef0d52a0c0203a4ad3b9944f46f39"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c3cf3b3fb10754f92c0703062c39726b52726298", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c3cf3b3fb10754f92c0703062c39726b52726298", "html_url": "https://github.com/rust-lang/rust/commit/c3cf3b3fb10754f92c0703062c39726b52726298", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c3cf3b3fb10754f92c0703062c39726b52726298/comments", "author": {"login": "aochagavia", "id": 5196584, "node_id": "MDQ6VXNlcjUxOTY1ODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5196584?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aochagavia", "html_url": "https://github.com/aochagavia", "followers_url": "https://api.github.com/users/aochagavia/followers", "following_url": "https://api.github.com/users/aochagavia/following{/other_user}", "gists_url": "https://api.github.com/users/aochagavia/gists{/gist_id}", "starred_url": "https://api.github.com/users/aochagavia/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aochagavia/subscriptions", "organizations_url": "https://api.github.com/users/aochagavia/orgs", "repos_url": "https://api.github.com/users/aochagavia/repos", "events_url": "https://api.github.com/users/aochagavia/events{/privacy}", "received_events_url": "https://api.github.com/users/aochagavia/received_events", "type": "User", "site_admin": false}, "committer": {"login": "aochagavia", "id": 5196584, "node_id": "MDQ6VXNlcjUxOTY1ODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5196584?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aochagavia", "html_url": "https://github.com/aochagavia", "followers_url": "https://api.github.com/users/aochagavia/followers", "following_url": "https://api.github.com/users/aochagavia/following{/other_user}", "gists_url": "https://api.github.com/users/aochagavia/gists{/gist_id}", "starred_url": "https://api.github.com/users/aochagavia/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aochagavia/subscriptions", "organizations_url": "https://api.github.com/users/aochagavia/orgs", "repos_url": "https://api.github.com/users/aochagavia/repos", "events_url": "https://api.github.com/users/aochagavia/events{/privacy}", "received_events_url": "https://api.github.com/users/aochagavia/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "035914edcfb19bf531eb633fba54c68b53fbe8d8", "url": "https://api.github.com/repos/rust-lang/rust/commits/035914edcfb19bf531eb633fba54c68b53fbe8d8", "html_url": "https://github.com/rust-lang/rust/commit/035914edcfb19bf531eb633fba54c68b53fbe8d8"}], "stats": {"total": 40, "additions": 26, "deletions": 14}, "files": [{"sha": "832bc9c4e10cbb2c8f6085a2303aaaa92900e8d2", "filename": "src/libserialize/json.rs", "status": "modified", "additions": 26, "deletions": 14, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/c3cf3b3fb10754f92c0703062c39726b52726298/src%2Flibserialize%2Fjson.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c3cf3b3fb10754f92c0703062c39726b52726298/src%2Flibserialize%2Fjson.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibserialize%2Fjson.rs?ref=c3cf3b3fb10754f92c0703062c39726b52726298", "patch": "@@ -2015,25 +2015,37 @@ impl ToJson for String {\n     fn to_json(&self) -> Json { String((*self).clone()) }\n }\n \n-impl<A: ToJson, B: ToJson> ToJson for (A, B) {\n-    fn to_json(&self) -> Json {\n-        match *self {\n-            (ref a, ref b) => {\n-                List(vec![a.to_json(), b.to_json()])\n+macro_rules! tuple_impl {\n+    // use variables to indicate the arity of the tuple\n+    ($($tyvar:ident),* ) => {\n+        // the trailing commas are for the 1 tuple\n+        impl<\n+            $( $tyvar : ToJson ),*\n+            > ToJson for ( $( $tyvar ),* , ) {\n+\n+            #[inline]\n+            #[allow(uppercase_variables)]\n+            fn to_json(&self) -> Json {\n+                match *self {\n+                    ($(ref $tyvar),*,) => List(vec![$($tyvar.to_json()),*])\n+                }\n             }\n         }\n     }\n }\n \n-impl<A: ToJson, B: ToJson, C: ToJson> ToJson for (A, B, C) {\n-    fn to_json(&self) -> Json {\n-        match *self {\n-            (ref a, ref b, ref c) => {\n-                List(vec![a.to_json(), b.to_json(), c.to_json()])\n-            }\n-        }\n-    }\n-}\n+tuple_impl!{A}\n+tuple_impl!{A, B}\n+tuple_impl!{A, B, C}\n+tuple_impl!{A, B, C, D}\n+tuple_impl!{A, B, C, D, E}\n+tuple_impl!{A, B, C, D, E, F}\n+tuple_impl!{A, B, C, D, E, F, G}\n+tuple_impl!{A, B, C, D, E, F, G, H}\n+tuple_impl!{A, B, C, D, E, F, G, H, I}\n+tuple_impl!{A, B, C, D, E, F, G, H, I, J}\n+tuple_impl!{A, B, C, D, E, F, G, H, I, J, K}\n+tuple_impl!{A, B, C, D, E, F, G, H, I, J, K, L}\n \n impl<'a, A: ToJson> ToJson for &'a [A] {\n     fn to_json(&self) -> Json { List(self.iter().map(|elt| elt.to_json()).collect()) }"}]}