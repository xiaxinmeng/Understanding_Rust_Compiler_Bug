{"sha": "9c9a4953c3f131a8481f15f7e7a805972056a084", "node_id": "MDY6Q29tbWl0NzI0NzEyOjljOWE0OTUzYzNmMTMxYTg0ODFmMTVmN2U3YTgwNTk3MjA1NmEwODQ=", "commit": {"author": {"name": "Oliver Schneider", "email": "oli-obk@users.noreply.github.com", "date": "2017-09-09T12:47:40Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-09-09T12:47:40Z"}, "message": "Merge pull request #2034 from Aaron1011/update-rust\n\nUpdate for latest Rust", "tree": {"sha": "692dfd3443953a6902cc7c79adc60c1d507a41b4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/692dfd3443953a6902cc7c79adc60c1d507a41b4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9c9a4953c3f131a8481f15f7e7a805972056a084", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9c9a4953c3f131a8481f15f7e7a805972056a084", "html_url": "https://github.com/rust-lang/rust/commit/9c9a4953c3f131a8481f15f7e7a805972056a084", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9c9a4953c3f131a8481f15f7e7a805972056a084/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6edab5662d54534cee86704b56855facf369e7fc", "url": "https://api.github.com/repos/rust-lang/rust/commits/6edab5662d54534cee86704b56855facf369e7fc", "html_url": "https://github.com/rust-lang/rust/commit/6edab5662d54534cee86704b56855facf369e7fc"}, {"sha": "81d32123f41070d6c2c5f7ffec6d78fc3859ba4f", "url": "https://api.github.com/repos/rust-lang/rust/commits/81d32123f41070d6c2c5f7ffec6d78fc3859ba4f", "html_url": "https://github.com/rust-lang/rust/commit/81d32123f41070d6c2c5f7ffec6d78fc3859ba4f"}], "stats": {"total": 79, "additions": 40, "deletions": 39}, "files": [{"sha": "49e576454eaea629983ac12b1ef93a08cadb4461", "filename": "CHANGELOG.md", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/CHANGELOG.md", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/CHANGELOG.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/CHANGELOG.md?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -1,9 +1,10 @@\n # Change Log\n All notable changes to this project will be documented in this file.\n \n-## Upcoming\n+## 0.0.158\n * New lint: [`manual_memcpy`]\n * [`cast_lossless`] no longer has redundant parentheses in its suggestions\n+* Update to *rustc 1.22.0-nightly (dead08cb3 2017-09-08)*\n \n ## 0.0.157 - 2017-09-04\n * Update to *rustc 1.22.0-nightly (981ce7d8d 2017-09-03)*"}, {"sha": "d4ce1aaa43dbabe516b3d842afe65c3c884a2ada", "filename": "Cargo.lock", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -1,6 +1,6 @@\n [root]\n name = \"clippy_lints\"\n-version = \"0.0.157\"\n+version = \"0.0.158\"\n dependencies = [\n  \"itertools 0.6.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"lazy_static 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -73,11 +73,11 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"clippy\"\n-version = \"0.0.157\"\n+version = \"0.0.158\"\n dependencies = [\n  \"cargo_metadata 0.2.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"clippy-mini-macro-test 0.1.0\",\n- \"clippy_lints 0.0.157\",\n+ \"clippy_lints 0.0.158\",\n  \"compiletest_rs 0.2.10 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"duct 0.8.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"lazy_static 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\","}, {"sha": "b078f0bc6df658aa20812b46a92966942ceea26f", "filename": "Cargo.toml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/Cargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/Cargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.toml?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -1,6 +1,6 @@\n [package]\n name = \"clippy\"\n-version = \"0.0.157\"\n+version = \"0.0.158\"\n authors = [\n \t\"Manish Goregaokar <manishsmail@gmail.com>\",\n \t\"Andre Bogus <bogusandre@gmail.com>\",\n@@ -31,7 +31,7 @@ path = \"src/main.rs\"\n \n [dependencies]\n # begin automatic update\n-clippy_lints = { version = \"0.0.157\", path = \"clippy_lints\" }\n+clippy_lints = { version = \"0.0.158\", path = \"clippy_lints\" }\n # end automatic update\n cargo_metadata = \"0.2\"\n "}, {"sha": "153ef23d5437202c2ccb54f2731d6a97c16755da", "filename": "clippy_lints/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2FCargo.toml?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -1,7 +1,7 @@\n [package]\n name = \"clippy_lints\"\n # begin automatic update\n-version = \"0.0.157\"\n+version = \"0.0.158\"\n # end automatic update\n authors = [\n \t\"Manish Goregaokar <manishsmail@gmail.com>\","}, {"sha": "db57864cb2f0686bbd57cc3c93870abb0a7664b0", "filename": "clippy_lints/src/bit_mask.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fbit_mask.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fbit_mask.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fbit_mask.rs?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -307,7 +307,7 @@ fn fetch_int_literal(cx: &LateContext, lit: &Expr) -> Option<u128> {\n                         cx.tcx.mir_const_qualif(def_id);\n                         cx.tcx.hir.body(cx.tcx.hir.body_owned_by(id))\n                     } else {\n-                        cx.tcx.sess.cstore.item_body(cx.tcx, def_id)\n+                        cx.tcx.extern_const_body(def_id)\n                     };\n                     fetch_int_literal(cx, &body.value)\n                 })"}, {"sha": "d50cb05576f45ce6d525c5c169c0b607827cbf74", "filename": "clippy_lints/src/consts.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fconsts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fconsts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fconsts.rs?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -297,7 +297,7 @@ impl<'c, 'cc> ConstEvalLateContext<'c, 'cc> {\n                         self.tcx.mir_const_qualif(def_id);\n                         self.tcx.hir.body(self.tcx.hir.body_owned_by(id))\n                     } else {\n-                        self.tcx.sess.cstore.item_body(self.tcx, def_id)\n+                        self.tcx.extern_const_body(def_id)\n                     };\n                     let ret = cx.expr(&body.value);\n                     if ret.is_some() {"}, {"sha": "5baaa4bd59d8c5fad2728572625111e4ff69df06", "filename": "clippy_lints/src/derive.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fderive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fderive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fderive.rs?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -93,7 +93,7 @@ fn check_hash_peq<'a, 'tcx>(\n ) {\n     if_let_chain! {[\n         match_path(&trait_ref.path, &paths::HASH),\n-        let Some(peq_trait_def_id) = cx.tcx.lang_items.eq_trait()\n+        let Some(peq_trait_def_id) = cx.tcx.lang_items().eq_trait()\n     ], {\n         // Look for the PartialEq implementations for `ty`\n         cx.tcx.for_each_relevant_impl(peq_trait_def_id, ty, |impl_id| {"}, {"sha": "dbe0d68ad69823713858fabf82bae18b1f77e05d", "filename": "clippy_lints/src/eq_op.rs", "status": "modified", "additions": 12, "deletions": 12, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Feq_op.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Feq_op.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Feq_op.rs?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -63,20 +63,20 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for EqOp {\n                 return;\n             }\n             let (trait_id, requires_ref) = match op.node {\n-                BiAdd => (cx.tcx.lang_items.add_trait(), false),\n-                BiSub => (cx.tcx.lang_items.sub_trait(), false),\n-                BiMul => (cx.tcx.lang_items.mul_trait(), false),\n-                BiDiv => (cx.tcx.lang_items.div_trait(), false),\n-                BiRem => (cx.tcx.lang_items.rem_trait(), false),\n+                BiAdd => (cx.tcx.lang_items().add_trait(), false),\n+                BiSub => (cx.tcx.lang_items().sub_trait(), false),\n+                BiMul => (cx.tcx.lang_items().mul_trait(), false),\n+                BiDiv => (cx.tcx.lang_items().div_trait(), false),\n+                BiRem => (cx.tcx.lang_items().rem_trait(), false),\n                 // don't lint short circuiting ops\n                 BiAnd | BiOr => return,\n-                BiBitXor => (cx.tcx.lang_items.bitxor_trait(), false),\n-                BiBitAnd => (cx.tcx.lang_items.bitand_trait(), false),\n-                BiBitOr => (cx.tcx.lang_items.bitor_trait(), false),\n-                BiShl => (cx.tcx.lang_items.shl_trait(), false),\n-                BiShr => (cx.tcx.lang_items.shr_trait(), false),\n-                BiNe | BiEq => (cx.tcx.lang_items.eq_trait(), true),\n-                BiLt | BiLe | BiGe | BiGt => (cx.tcx.lang_items.ord_trait(), true),\n+                BiBitXor => (cx.tcx.lang_items().bitxor_trait(), false),\n+                BiBitAnd => (cx.tcx.lang_items().bitand_trait(), false),\n+                BiBitOr => (cx.tcx.lang_items().bitor_trait(), false),\n+                BiShl => (cx.tcx.lang_items().shl_trait(), false),\n+                BiShr => (cx.tcx.lang_items().shr_trait(), false),\n+                BiNe | BiEq => (cx.tcx.lang_items().eq_trait(), true),\n+                BiLt | BiLe | BiGe | BiGt => (cx.tcx.lang_items().ord_trait(), true),\n             };\n             if let Some(trait_id) = trait_id {\n                 #[allow(match_same_arms)]"}, {"sha": "74719d006d03e46aa7a73a327beefaf9ed2912a3", "filename": "clippy_lints/src/methods.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fmethods.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fmethods.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods.rs?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -1302,7 +1302,7 @@ fn get_error_type<'a>(cx: &LateContext, ty: Ty<'a>) -> Option<Ty<'a>> {\n \n /// This checks whether a given type is known to implement Debug.\n fn has_debug_impl<'a, 'b>(ty: Ty<'a>, cx: &LateContext<'b, 'a>) -> bool {\n-    match cx.tcx.lang_items.debug_trait() {\n+    match cx.tcx.lang_items().debug_trait() {\n         Some(debug) => implements_trait(cx, ty, debug, &[]),\n         None => false,\n     }"}, {"sha": "fcb29439a64de2a08b88bf3dc9001a050a8d5989", "filename": "clippy_lints/src/misc.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fmisc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fmisc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmisc.rs?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -497,7 +497,7 @@ fn check_to_owned(cx: &LateContext, expr: &Expr, other: &Expr) {\n     };\n \n     let other_ty = cx.tables.expr_ty_adjusted(other);\n-    let partial_eq_trait_id = match cx.tcx.lang_items.eq_trait() {\n+    let partial_eq_trait_id = match cx.tcx.lang_items().eq_trait() {\n         Some(id) => id,\n         None => return,\n     };"}, {"sha": "da3bfc7594c447f3d16b7426e3c6c8f0138f7c46", "filename": "clippy_lints/src/needless_pass_by_value.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fneedless_pass_by_value.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fneedless_pass_by_value.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fneedless_pass_by_value.rs?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -75,7 +75,7 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for NeedlessPassByValue {\n         }\n \n         // Allows these to be passed by value.\n-        let fn_trait = need!(cx.tcx.lang_items.fn_trait());\n+        let fn_trait = need!(cx.tcx.lang_items().fn_trait());\n         let asref_trait = need!(get_trait_def_id(cx, &paths::ASREF_TRAIT));\n         let borrow_trait = need!(get_trait_def_id(cx, &paths::BORROW_TRAIT));\n "}, {"sha": "34f1e4bc493a89b2ae19cc3d2902f2cb36f9cc8b", "filename": "clippy_lints/src/partialeq_ne_impl.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fpartialeq_ne_impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fpartialeq_ne_impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fpartialeq_ne_impl.rs?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -40,7 +40,7 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for Pass {\n         if_let_chain! {[\n             let ItemImpl(_, _, _, _, Some(ref trait_ref), _, ref impl_items) = item.node,\n             !is_automatically_derived(&*item.attrs),\n-            let Some(eq_trait) = cx.tcx.lang_items.eq_trait(),\n+            let Some(eq_trait) = cx.tcx.lang_items().eq_trait(),\n             trait_ref.path.def.def_id() == eq_trait\n         ], {\n             for impl_item in impl_items {"}, {"sha": "47e444c8c8859758582cfe6f517442c3f134e179", "filename": "clippy_lints/src/should_assert_eq.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fshould_assert_eq.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Fshould_assert_eq.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fshould_assert_eq.rs?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -40,7 +40,7 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for ShouldAssertEq {\n             let ExprUnary(UnOp::UnNot, ref cond) = cond.node,\n             let ExprBinary(ref binop, ref expr1, ref expr2) = cond.node,\n             is_direct_expn_of(e.span, \"assert\").is_some(),\n-            let Some(debug_trait) = cx.tcx.lang_items.debug_trait(),\n+            let Some(debug_trait) = cx.tcx.lang_items().debug_trait(),\n         ], {\n             let debug = is_expn_of(e.span, \"debug_assert\").map_or(\"\", |_| \"debug_\");\n             let sugg = match binop.node {"}, {"sha": "6eb78d02d30a96da3d0a03cf6b3c4b7f15291337", "filename": "clippy_lints/src/types.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Ftypes.rs?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -151,7 +151,7 @@ fn check_ty(cx: &LateContext, ast_ty: &hir::Ty, is_local: bool) {\n             let hir_id = cx.tcx.hir.node_to_hir_id(ast_ty.id);\n             let def = cx.tables.qpath_def(qpath, hir_id);\n             if let Some(def_id) = opt_def_id(def) {\n-                if Some(def_id) == cx.tcx.lang_items.owned_box() {\n+                if Some(def_id) == cx.tcx.lang_items().owned_box() {\n                     let last = last_path_segment(qpath);\n                     if_let_chain! {[\n                         !last.parameters.parenthesized,\n@@ -209,7 +209,7 @@ fn check_ty(cx: &LateContext, ast_ty: &hir::Ty, is_local: bool) {\n                     let def = cx.tables.qpath_def(qpath, hir_id);\n                     if_let_chain! {[\n                         let Some(def_id) = opt_def_id(def),\n-                        Some(def_id) == cx.tcx.lang_items.owned_box(),\n+                        Some(def_id) == cx.tcx.lang_items().owned_box(),\n                         let QPath::Resolved(None, ref path) = *qpath,\n                         let [ref bx] = *path.segments,\n                         !bx.parameters.parenthesized,"}, {"sha": "e74f1639e4bbdc79119ae77bccd64853fc02f3dd", "filename": "clippy_lints/src/utils/inspector.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Futils%2Finspector.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Futils%2Finspector.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Finspector.rs?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -360,12 +360,12 @@ fn print_item(cx: &LateContext, item: &hir::Item) {\n     }\n     match item.node {\n         hir::ItemExternCrate(ref _renamed_from) => {\n-            if let Some(crate_id) = cx.tcx.sess.cstore.extern_mod_stmt_cnum(item.id) {\n-                let source = cx.tcx.sess.cstore.used_crate_source(crate_id);\n-                if let Some(src) = source.dylib {\n+            if let Some(crate_id) = cx.tcx.extern_mod_stmt_cnum(item.hir_id) {\n+                let source = cx.tcx.used_crate_source(crate_id);\n+                if let Some(ref src) = source.dylib {\n                     println!(\"extern crate dylib source: {:?}\", src.0);\n                 }\n-                if let Some(src) = source.rlib {\n+                if let Some(ref src) = source.rlib {\n                     println!(\"extern crate rlib source: {:?}\", src.0);\n                 }\n             } else {"}, {"sha": "582cdae47b82e0666879c2ca9ba4868ec09b70cd", "filename": "clippy_lints/src/utils/mod.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Futils%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9c9a4953c3f131a8481f15f7e7a805972056a084/clippy_lints%2Fsrc%2Futils%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Fmod.rs?ref=9c9a4953c3f131a8481f15f7e7a805972056a084", "patch": "@@ -15,6 +15,7 @@ use std::borrow::Cow;\n use std::env;\n use std::mem;\n use std::str::FromStr;\n+use std::rc::Rc;\n use syntax::ast::{self, LitKind};\n use syntax::attr;\n use syntax::codemap::{CompilerDesugaringKind, ExpnFormat, ExpnInfo, Span, DUMMY_SP};\n@@ -277,18 +278,17 @@ pub fn match_path_ast(path: &ast::Path, segments: &[&str]) -> bool {\n \n /// Get the definition associated to a path.\n pub fn path_to_def(cx: &LateContext, path: &[&str]) -> Option<def::Def> {\n-    let cstore = &cx.tcx.sess.cstore;\n \n-    let crates = cstore.crates();\n+    let crates = cx.tcx.crates();\n     let krate = crates\n         .iter()\n-        .find(|&&krate| cstore.crate_name(krate) == path[0]);\n+        .find(|&&krate| cx.tcx.crate_name(krate) == path[0]);\n     if let Some(krate) = krate {\n         let krate = DefId {\n             krate: *krate,\n             index: CRATE_DEF_INDEX,\n         };\n-        let mut items = cstore.item_children(krate, cx.tcx.sess);\n+        let mut items = cx.tcx.item_children(krate);\n         let mut path_it = path.iter().skip(1).peekable();\n \n         loop {\n@@ -297,13 +297,13 @@ pub fn path_to_def(cx: &LateContext, path: &[&str]) -> Option<def::Def> {\n                 None => return None,\n             };\n \n-            for item in &mem::replace(&mut items, vec![]) {\n+            for item in mem::replace(&mut items, Rc::new(vec![])).iter() {\n                 if item.ident.name == *segment {\n                     if path_it.peek().is_none() {\n                         return Some(item.def);\n                     }\n \n-                    items = cstore.item_children(item.def.def_id(), cx.tcx.sess);\n+                    items = cx.tcx.item_children(item.def.def_id());\n                     break;\n                 }\n             }"}]}