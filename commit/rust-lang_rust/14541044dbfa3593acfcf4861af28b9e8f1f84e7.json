{"sha": "14541044dbfa3593acfcf4861af28b9e8f1f84e7", "node_id": "C_kwDOAAsO6NoAKDE0NTQxMDQ0ZGJmYTM1OTNhY2ZjZjQ4NjFhZjI4YjllOGYxZjg0ZTc", "commit": {"author": {"name": "Ben Kimock", "email": "kimockb@gmail.com", "date": "2023-03-11T21:44:19Z"}, "committer": {"name": "Ben Kimock", "email": "kimockb@gmail.com", "date": "2023-03-12T20:39:06Z"}, "message": "Add a section on using nextest", "tree": {"sha": "120643bc5a2ee6627027691e2bf40482b7b5f9d4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/120643bc5a2ee6627027691e2bf40482b7b5f9d4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/14541044dbfa3593acfcf4861af28b9e8f1f84e7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/14541044dbfa3593acfcf4861af28b9e8f1f84e7", "html_url": "https://github.com/rust-lang/rust/commit/14541044dbfa3593acfcf4861af28b9e8f1f84e7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/14541044dbfa3593acfcf4861af28b9e8f1f84e7/comments", "author": {"login": "saethlin", "id": 12105168, "node_id": "MDQ6VXNlcjEyMTA1MTY4", "avatar_url": "https://avatars.githubusercontent.com/u/12105168?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saethlin", "html_url": "https://github.com/saethlin", "followers_url": "https://api.github.com/users/saethlin/followers", "following_url": "https://api.github.com/users/saethlin/following{/other_user}", "gists_url": "https://api.github.com/users/saethlin/gists{/gist_id}", "starred_url": "https://api.github.com/users/saethlin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saethlin/subscriptions", "organizations_url": "https://api.github.com/users/saethlin/orgs", "repos_url": "https://api.github.com/users/saethlin/repos", "events_url": "https://api.github.com/users/saethlin/events{/privacy}", "received_events_url": "https://api.github.com/users/saethlin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "saethlin", "id": 12105168, "node_id": "MDQ6VXNlcjEyMTA1MTY4", "avatar_url": "https://avatars.githubusercontent.com/u/12105168?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saethlin", "html_url": "https://github.com/saethlin", "followers_url": "https://api.github.com/users/saethlin/followers", "following_url": "https://api.github.com/users/saethlin/following{/other_user}", "gists_url": "https://api.github.com/users/saethlin/gists{/gist_id}", "starred_url": "https://api.github.com/users/saethlin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saethlin/subscriptions", "organizations_url": "https://api.github.com/users/saethlin/orgs", "repos_url": "https://api.github.com/users/saethlin/repos", "events_url": "https://api.github.com/users/saethlin/events{/privacy}", "received_events_url": "https://api.github.com/users/saethlin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0f1f7b0840885fac83ff3f36053cb04833c1af5a", "url": "https://api.github.com/repos/rust-lang/rust/commits/0f1f7b0840885fac83ff3f36053cb04833c1af5a", "html_url": "https://github.com/rust-lang/rust/commit/0f1f7b0840885fac83ff3f36053cb04833c1af5a"}], "stats": {"total": 20, "additions": 20, "deletions": 0}, "files": [{"sha": "93e00cca117d5111ddb45baf3610e3ab534be64a", "filename": "src/tools/miri/README.md", "status": "modified", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/14541044dbfa3593acfcf4861af28b9e8f1f84e7/src%2Ftools%2Fmiri%2FREADME.md", "raw_url": "https://github.com/rust-lang/rust/raw/14541044dbfa3593acfcf4861af28b9e8f1f84e7/src%2Ftools%2Fmiri%2FREADME.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiri%2FREADME.md?ref=14541044dbfa3593acfcf4861af28b9e8f1f84e7", "patch": "@@ -225,6 +225,26 @@ degree documented below):\n   reduced feature set. We might ship Miri with a nightly even when some features\n   on these targets regress.\n \n+### Running tests in parallel\n+\n+Though it implements Rust threading, Miri itself is a single-threaded interpreter.\n+This means that when running `cargo miri test`, you will probably see a dramatic\n+increase in the amount of time it takes to run your whole test suite due to the\n+inherent interpreter slowdown and a loss of parallelism.\n+\n+You can get your test suite's parallelism back by running `cargo miri nextest run -jN`\n+(note that you will need [`cargo-nextest`](https://nexte.st) installed).\n+This works because `cargo-nextest` collects a list of all tests then launches a\n+separate `cargo miri run` for each test. You will need to specify a `-j` or `--test-threads`,\n+by default `cargo miri nextest run` runs one test at a time. You can find the `cargo-nextest`\n+documentation for its Miri support here: https://nexte.st/book/miri.html\n+\n+Note: This one-test-per-process model means that `cargo miri test` is able to detect data\n+races where two tests race on a shared resource, but `cargo miri nextest run` will not detect\n+such races.\n+\n+Note: `cargo-nextest` does not support doctests, see https://github.com/nextest-rs/nextest/issues/16\n+\n ### Common Problems\n \n When using the above instructions, you may encounter a number of confusing compiler"}]}