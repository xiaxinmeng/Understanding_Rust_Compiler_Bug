{"sha": "9a1c1c7941e111b67e89cc6e0738455d6edbbd5e", "node_id": "C_kwDOAAsO6NoAKDlhMWMxYzc5NDFlMTExYjY3ZTg5Y2M2ZTA3Mzg0NTVkNmVkYmJkNWU", "commit": {"author": {"name": "Peter Collingbourne", "email": "pcc@google.com", "date": "2022-10-06T02:07:12Z"}, "committer": {"name": "Peter Collingbourne", "email": "pcc@google.com", "date": "2022-10-06T20:42:32Z"}, "message": "tools/remote-test-{server,client}: Use /data/local/tmp on Android\n\nThe /data/tmp directory does not exist, at least not on recent versions\nof Android, which currently leads to test failures on that platform. I\nchecked a virtual device running AOSP master and a Nexus 5 running\nAndroid Marshmallow and on both devices the /data/tmp directory does\nnot exist and /data/local/tmp does, so let's switch to /data/local/tmp.", "tree": {"sha": "dc807c5ec3bf161b572505bffbd852fb88a3e13c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/dc807c5ec3bf161b572505bffbd852fb88a3e13c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9a1c1c7941e111b67e89cc6e0738455d6edbbd5e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9a1c1c7941e111b67e89cc6e0738455d6edbbd5e", "html_url": "https://github.com/rust-lang/rust/commit/9a1c1c7941e111b67e89cc6e0738455d6edbbd5e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9a1c1c7941e111b67e89cc6e0738455d6edbbd5e/comments", "author": {"login": "pcc", "id": 425024, "node_id": "MDQ6VXNlcjQyNTAyNA==", "avatar_url": "https://avatars.githubusercontent.com/u/425024?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcc", "html_url": "https://github.com/pcc", "followers_url": "https://api.github.com/users/pcc/followers", "following_url": "https://api.github.com/users/pcc/following{/other_user}", "gists_url": "https://api.github.com/users/pcc/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcc/subscriptions", "organizations_url": "https://api.github.com/users/pcc/orgs", "repos_url": "https://api.github.com/users/pcc/repos", "events_url": "https://api.github.com/users/pcc/events{/privacy}", "received_events_url": "https://api.github.com/users/pcc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pcc", "id": 425024, "node_id": "MDQ6VXNlcjQyNTAyNA==", "avatar_url": "https://avatars.githubusercontent.com/u/425024?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcc", "html_url": "https://github.com/pcc", "followers_url": "https://api.github.com/users/pcc/followers", "following_url": "https://api.github.com/users/pcc/following{/other_user}", "gists_url": "https://api.github.com/users/pcc/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcc/subscriptions", "organizations_url": "https://api.github.com/users/pcc/orgs", "repos_url": "https://api.github.com/users/pcc/repos", "events_url": "https://api.github.com/users/pcc/events{/privacy}", "received_events_url": "https://api.github.com/users/pcc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c97d02cdb5ca5f5e9eff1fa9e4560d220d1fd2a0", "url": "https://api.github.com/repos/rust-lang/rust/commits/c97d02cdb5ca5f5e9eff1fa9e4560d220d1fd2a0", "html_url": "https://github.com/rust-lang/rust/commit/c97d02cdb5ca5f5e9eff1fa9e4560d220d1fd2a0"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "2271c18eb1d90d56fc33387ffb6a95e23c2bea25", "filename": "src/bootstrap/test.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9a1c1c7941e111b67e89cc6e0738455d6edbbd5e/src%2Fbootstrap%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9a1c1c7941e111b67e89cc6e0738455d6edbbd5e/src%2Fbootstrap%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftest.rs?ref=9a1c1c7941e111b67e89cc6e0738455d6edbbd5e", "patch": "@@ -23,7 +23,7 @@ use crate::toolstate::ToolState;\n use crate::util::{self, add_link_lib_path, dylib_path, dylib_path_var, output, t};\n use crate::{envify, CLang, DocTests, GitRepo, Mode};\n \n-const ADB_TEST_DIR: &str = \"/data/tmp/work\";\n+const ADB_TEST_DIR: &str = \"/data/local/tmp/work\";\n \n /// The two modes of the test runner; tests or benchmarks.\n #[derive(Debug, PartialEq, Eq, Hash, Copy, Clone, PartialOrd, Ord)]"}, {"sha": "bcda930d093c5be1381f527109defea52a84dbfa", "filename": "src/tools/remote-test-client/src/main.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9a1c1c7941e111b67e89cc6e0738455d6edbbd5e/src%2Ftools%2Fremote-test-client%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9a1c1c7941e111b67e89cc6e0738455d6edbbd5e/src%2Ftools%2Fremote-test-client%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fremote-test-client%2Fsrc%2Fmain.rs?ref=9a1c1c7941e111b67e89cc6e0738455d6edbbd5e", "patch": "@@ -93,7 +93,7 @@ fn start_android_emulator(server: &Path) {\n \n     println!(\"pushing server\");\n     let status =\n-        Command::new(\"adb\").arg(\"push\").arg(server).arg(\"/data/tmp/testd\").status().unwrap();\n+        Command::new(\"adb\").arg(\"push\").arg(server).arg(\"/data/local/tmp/testd\").status().unwrap();\n     assert!(status.success());\n \n     println!(\"forwarding tcp\");\n@@ -102,7 +102,7 @@ fn start_android_emulator(server: &Path) {\n     assert!(status.success());\n \n     println!(\"executing server\");\n-    Command::new(\"adb\").arg(\"shell\").arg(\"/data/tmp/testd\").spawn().unwrap();\n+    Command::new(\"adb\").arg(\"shell\").arg(\"/data/local/tmp/testd\").spawn().unwrap();\n }\n \n fn prepare_rootfs(target: &str, rootfs: &Path, server: &Path, rootfs_img: &Path) {"}, {"sha": "bed9d39161df804ee63de4e8f966d20067eb8275", "filename": "src/tools/remote-test-server/src/main.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9a1c1c7941e111b67e89cc6e0738455d6edbbd5e/src%2Ftools%2Fremote-test-server%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9a1c1c7941e111b67e89cc6e0738455d6edbbd5e/src%2Ftools%2Fremote-test-server%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fremote-test-server%2Fsrc%2Fmain.rs?ref=9a1c1c7941e111b67e89cc6e0738455d6edbbd5e", "patch": "@@ -98,7 +98,7 @@ fn main() {\n \n     let listener = t!(TcpListener::bind(config.bind));\n     let (work, tmp): (PathBuf, PathBuf) = if cfg!(target_os = \"android\") {\n-        (\"/data/tmp/work\".into(), \"/data/tmp/work/tmp\".into())\n+        (\"/data/local/tmp/work\".into(), \"/data/local/tmp/work/tmp\".into())\n     } else {\n         let mut work_dir = env::temp_dir();\n         work_dir.push(\"work\");"}]}