{"sha": "2851c9ffb51570937b73efb96f5586926edb5ca7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI4NTFjOWZmYjUxNTcwOTM3YjczZWZiOTZmNTU4NjkyNmVkYjVjYTc=", "commit": {"author": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2020-06-04T00:00:00Z"}, "committer": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2020-06-20T07:48:14Z"}, "message": "Support sanitizers on aarch64-unknown-linux-gnu", "tree": {"sha": "f536d9ab5793963d655a06223680779a6a9ded17", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f536d9ab5793963d655a06223680779a6a9ded17"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2851c9ffb51570937b73efb96f5586926edb5ca7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2851c9ffb51570937b73efb96f5586926edb5ca7", "html_url": "https://github.com/rust-lang/rust/commit/2851c9ffb51570937b73efb96f5586926edb5ca7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2851c9ffb51570937b73efb96f5586926edb5ca7/comments", "author": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "033013cab3a861224fd55f494c8be1cb0349eb49", "url": "https://api.github.com/repos/rust-lang/rust/commits/033013cab3a861224fd55f494c8be1cb0349eb49", "html_url": "https://github.com/rust-lang/rust/commit/033013cab3a861224fd55f494c8be1cb0349eb49"}], "stats": {"total": 41, "additions": 29, "deletions": 12}, "files": [{"sha": "6c995be913c9e94c5528eef7a4bd6d91f75d392b", "filename": "src/librustc_codegen_ssa/back/link.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/2851c9ffb51570937b73efb96f5586926edb5ca7/src%2Flibrustc_codegen_ssa%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2851c9ffb51570937b73efb96f5586926edb5ca7/src%2Flibrustc_codegen_ssa%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Fback%2Flink.rs?ref=2851c9ffb51570937b73efb96f5586926edb5ca7", "patch": "@@ -804,7 +804,10 @@ fn link_sanitizer_runtime(sess: &Session, linker: &mut dyn Linker, name: &str) {\n             linker.args(&[\"-Wl,-rpath\", \"-Xlinker\", rpath]);\n             linker.link_dylib(Symbol::intern(&libname));\n         }\n-        \"x86_64-unknown-linux-gnu\" | \"x86_64-fuchsia\" | \"aarch64-fuchsia\" => {\n+        \"aarch64-fuchsia\"\n+        | \"aarch64-unknown-linux-gnu\"\n+        | \"x86_64-fuchsia\"\n+        | \"x86_64-unknown-linux-gnu\" => {\n             let filename = format!(\"librustc{}_rt.{}.a\", channel, name);\n             let path = default_tlib.join(&filename);\n             linker.link_whole_rlib(&path);"}, {"sha": "2ea312c42dc646757fe81c93cbfcba17409d68f2", "filename": "src/librustc_session/session.rs", "status": "modified", "additions": 13, "deletions": 5, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/2851c9ffb51570937b73efb96f5586926edb5ca7/src%2Flibrustc_session%2Fsession.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2851c9ffb51570937b73efb96f5586926edb5ca7/src%2Flibrustc_session%2Fsession.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_session%2Fsession.rs?ref=2851c9ffb51570937b73efb96f5586926edb5ca7", "patch": "@@ -1349,11 +1349,19 @@ fn validate_commandline_args_with_session_available(sess: &Session) {\n         );\n     }\n \n-    const ASAN_SUPPORTED_TARGETS: &[&str] =\n-        &[\"aarch64-fuchsia\", \"x86_64-apple-darwin\", \"x86_64-fuchsia\", \"x86_64-unknown-linux-gnu\"];\n-    const LSAN_SUPPORTED_TARGETS: &[&str] = &[\"x86_64-apple-darwin\", \"x86_64-unknown-linux-gnu\"];\n-    const MSAN_SUPPORTED_TARGETS: &[&str] = &[\"x86_64-unknown-linux-gnu\"];\n-    const TSAN_SUPPORTED_TARGETS: &[&str] = &[\"x86_64-apple-darwin\", \"x86_64-unknown-linux-gnu\"];\n+    const ASAN_SUPPORTED_TARGETS: &[&str] = &[\n+        \"aarch64-fuchsia\",\n+        \"aarch64-unknown-linux-gnu\",\n+        \"x86_64-apple-darwin\",\n+        \"x86_64-fuchsia\",\n+        \"x86_64-unknown-linux-gnu\",\n+    ];\n+    const LSAN_SUPPORTED_TARGETS: &[&str] =\n+        &[\"aarch64-unknown-linux-gnu\", \"x86_64-apple-darwin\", \"x86_64-unknown-linux-gnu\"];\n+    const MSAN_SUPPORTED_TARGETS: &[&str] =\n+        &[\"aarch64-unknown-linux-gnu\", \"x86_64-unknown-linux-gnu\"];\n+    const TSAN_SUPPORTED_TARGETS: &[&str] =\n+        &[\"aarch64-unknown-linux-gnu\", \"x86_64-apple-darwin\", \"x86_64-unknown-linux-gnu\"];\n \n     // Sanitizers can only be used on some tested platforms.\n     for s in sess.opts.debugging_opts.sanitizer {"}, {"sha": "f5961a11b1f1c4a741e4cff730f20ab3cbd152b5", "filename": "src/test/ui/sanitize/unsupported-target.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2851c9ffb51570937b73efb96f5586926edb5ca7/src%2Ftest%2Fui%2Fsanitize%2Funsupported-target.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2851c9ffb51570937b73efb96f5586926edb5ca7/src%2Ftest%2Fui%2Fsanitize%2Funsupported-target.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsanitize%2Funsupported-target.stderr?ref=2851c9ffb51570937b73efb96f5586926edb5ca7", "patch": "@@ -1,4 +1,4 @@\n-error: `-Zsanitizer=leak` only works with targets: x86_64-apple-darwin, x86_64-unknown-linux-gnu\n+error: `-Zsanitizer=leak` only works with targets: aarch64-unknown-linux-gnu, x86_64-apple-darwin, x86_64-unknown-linux-gnu\n \n error: aborting due to previous error\n "}, {"sha": "0437ff8c9440a3cbfe8b59134c1491125584fe4e", "filename": "src/tools/compiletest/src/util.rs", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/2851c9ffb51570937b73efb96f5586926edb5ca7/src%2Ftools%2Fcompiletest%2Fsrc%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2851c9ffb51570937b73efb96f5586926edb5ca7/src%2Ftools%2Fcompiletest%2Fsrc%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Futil.rs?ref=2851c9ffb51570937b73efb96f5586926edb5ca7", "patch": "@@ -82,16 +82,22 @@ const ARCH_TABLE: &'static [(&'static str, &'static str)] = &[\n     (\"xcore\", \"xcore\"),\n ];\n \n-pub const ASAN_SUPPORTED_TARGETS: &'static [&'static str] =\n-    &[\"aarch64-fuchsia\", \"x86_64-apple-darwin\", \"x86_64-fuchsia\", \"x86_64-unknown-linux-gnu\"];\n+pub const ASAN_SUPPORTED_TARGETS: &'static [&'static str] = &[\n+    \"aarch64-fuchsia\",\n+    \"aarch64-unknown-linux-gnu\",\n+    \"x86_64-apple-darwin\",\n+    \"x86_64-fuchsia\",\n+    \"x86_64-unknown-linux-gnu\",\n+];\n \n pub const LSAN_SUPPORTED_TARGETS: &'static [&'static str] =\n-    &[\"x86_64-apple-darwin\", \"x86_64-unknown-linux-gnu\"];\n+    &[\"aarch64-unknown-linux-gnu\", \"x86_64-apple-darwin\", \"x86_64-unknown-linux-gnu\"];\n \n-pub const MSAN_SUPPORTED_TARGETS: &'static [&'static str] = &[\"x86_64-unknown-linux-gnu\"];\n+pub const MSAN_SUPPORTED_TARGETS: &'static [&'static str] =\n+    &[\"aarch64-unknown-linux-gnu\", \"x86_64-unknown-linux-gnu\"];\n \n pub const TSAN_SUPPORTED_TARGETS: &'static [&'static str] =\n-    &[\"x86_64-apple-darwin\", \"x86_64-unknown-linux-gnu\"];\n+    &[\"aarch64-unknown-linux-gnu\", \"x86_64-apple-darwin\", \"x86_64-unknown-linux-gnu\"];\n \n pub fn matches_os(triple: &str, name: &str) -> bool {\n     // For the wasm32 bare target we ignore anything also ignored on emscripten"}]}