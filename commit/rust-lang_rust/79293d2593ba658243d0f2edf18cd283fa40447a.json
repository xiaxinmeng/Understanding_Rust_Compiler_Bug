{"sha": "79293d2593ba658243d0f2edf18cd283fa40447a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc5MjkzZDI1OTNiYTY1ODI0M2QwZjJlZGYxOGNkMjgzZmE0MDQ0N2E=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-09-16T14:24:18Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-09-16T14:24:18Z"}, "message": "eprintln", "tree": {"sha": "c08ae096f2982e3978251bc20c311b1b2141c9e9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c08ae096f2982e3978251bc20c311b1b2141c9e9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/79293d2593ba658243d0f2edf18cd283fa40447a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/79293d2593ba658243d0f2edf18cd283fa40447a", "html_url": "https://github.com/rust-lang/rust/commit/79293d2593ba658243d0f2edf18cd283fa40447a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/79293d2593ba658243d0f2edf18cd283fa40447a/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bb2331b98e1616b6ab304b59e80b78e1f2e7a118", "url": "https://api.github.com/repos/rust-lang/rust/commits/bb2331b98e1616b6ab304b59e80b78e1f2e7a118", "html_url": "https://github.com/rust-lang/rust/commit/bb2331b98e1616b6ab304b59e80b78e1f2e7a118"}], "stats": {"total": 44, "additions": 37, "deletions": 7}, "files": [{"sha": "ff9de20d387034a3bed4480da9b60193d61f678c", "filename": "crates/ra_editor/src/completion.rs", "status": "modified", "additions": 37, "deletions": 7, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/79293d2593ba658243d0f2edf18cd283fa40447a/crates%2Fra_editor%2Fsrc%2Fcompletion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/79293d2593ba658243d0f2edf18cd283fa40447a/crates%2Fra_editor%2Fsrc%2Fcompletion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_editor%2Fsrc%2Fcompletion.rs?ref=79293d2593ba658243d0f2edf18cd283fa40447a", "patch": "@@ -82,6 +82,7 @@ fn complete_name_ref(file: &File, name_ref: ast::NameRef, acc: &mut Vec<Completi\n             if let Some(fn_def) = ast::FnDef::cast(node) {\n                 visited_fn = true;\n                 complete_expr_keywords(&file, fn_def, name_ref, acc);\n+                complete_expr_snippets(acc);\n                 let scopes = FnScopes::new(fn_def);\n                 complete_fn(name_ref, &scopes, acc);\n             }\n@@ -201,6 +202,21 @@ fn keyword(kw: &str, snip: &str) -> CompletionItem {\n     }\n }\n \n+fn complete_expr_snippets(acc: &mut Vec<CompletionItem>) {\n+    acc.push(CompletionItem {\n+            label: \"pd\".to_string(),\n+            lookup: None,\n+            snippet: Some(\"eprintln!(\\\"$0 = {:?}\\\", $0);\".to_string()),\n+        }\n+    );\n+    acc.push(CompletionItem {\n+            label: \"ppd\".to_string(),\n+            lookup: None,\n+            snippet: Some(\"eprintln!(\\\"$0 = {:#?}\\\", $0);\".to_string()),\n+        }\n+    );\n+}\n+\n fn complete_fn(name_ref: ast::NameRef, scopes: &FnScopes, acc: &mut Vec<CompletionItem>) {\n     let mut shadowed = HashSet::new();\n     acc.extend(\n@@ -363,7 +379,9 @@ mod tests {\n                    CompletionItem { label: \"match\", lookup: None, snippet: Some(\"match $0 {}\") },\n                    CompletionItem { label: \"while\", lookup: None, snippet: Some(\"while $0 {}\") },\n                    CompletionItem { label: \"loop\", lookup: None, snippet: Some(\"loop {$0}\") },\n-                   CompletionItem { label: \"return\", lookup: None, snippet: Some(\"return\") }]\"#);\n+                   CompletionItem { label: \"return\", lookup: None, snippet: Some(\"return\") },\n+                   CompletionItem { label: \"pd\", lookup: None, snippet: Some(\"eprintln!(\\\"$0 = {:?}\\\", $0);\") },\n+                   CompletionItem { label: \"ppd\", lookup: None, snippet: Some(\"eprintln!(\\\"$0 = {:#?}\\\", $0);\") }]\"#);\n     }\n \n     #[test]\n@@ -380,7 +398,9 @@ mod tests {\n                    CompletionItem { label: \"loop\", lookup: None, snippet: Some(\"loop {$0}\") },\n                    CompletionItem { label: \"else\", lookup: None, snippet: Some(\"else {$0}\") },\n                    CompletionItem { label: \"else if\", lookup: None, snippet: Some(\"else if $0 {}\") },\n-                   CompletionItem { label: \"return\", lookup: None, snippet: Some(\"return\") }]\"#);\n+                   CompletionItem { label: \"return\", lookup: None, snippet: Some(\"return\") },\n+                   CompletionItem { label: \"pd\", lookup: None, snippet: Some(\"eprintln!(\\\"$0 = {:?}\\\", $0);\") },\n+                   CompletionItem { label: \"ppd\", lookup: None, snippet: Some(\"eprintln!(\\\"$0 = {:#?}\\\", $0);\") }]\"#);\n     }\n \n     #[test]\n@@ -394,7 +414,9 @@ mod tests {\n                    CompletionItem { label: \"match\", lookup: None, snippet: Some(\"match $0 {}\") },\n                    CompletionItem { label: \"while\", lookup: None, snippet: Some(\"while $0 {}\") },\n                    CompletionItem { label: \"loop\", lookup: None, snippet: Some(\"loop {$0}\") },\n-                   CompletionItem { label: \"return\", lookup: None, snippet: Some(\"return $0;\") }]\"#);\n+                   CompletionItem { label: \"return\", lookup: None, snippet: Some(\"return $0;\") },\n+                   CompletionItem { label: \"pd\", lookup: None, snippet: Some(\"eprintln!(\\\"$0 = {:?}\\\", $0);\") },\n+                   CompletionItem { label: \"ppd\", lookup: None, snippet: Some(\"eprintln!(\\\"$0 = {:#?}\\\", $0);\") }]\"#);\n         check_snippet_completion(r\"\n             fn quux() {\n                 <|>\n@@ -404,7 +426,9 @@ mod tests {\n                    CompletionItem { label: \"match\", lookup: None, snippet: Some(\"match $0 {}\") },\n                    CompletionItem { label: \"while\", lookup: None, snippet: Some(\"while $0 {}\") },\n                    CompletionItem { label: \"loop\", lookup: None, snippet: Some(\"loop {$0}\") },\n-                   CompletionItem { label: \"return\", lookup: None, snippet: Some(\"return;\") }]\"#);\n+                   CompletionItem { label: \"return\", lookup: None, snippet: Some(\"return;\") },\n+                   CompletionItem { label: \"pd\", lookup: None, snippet: Some(\"eprintln!(\\\"$0 = {:?}\\\", $0);\") },\n+                   CompletionItem { label: \"ppd\", lookup: None, snippet: Some(\"eprintln!(\\\"$0 = {:#?}\\\", $0);\") }]\"#);\n     }\n \n     #[test]\n@@ -419,7 +443,9 @@ mod tests {\n                    CompletionItem { label: \"match\", lookup: None, snippet: Some(\"match $0 {}\") },\n                    CompletionItem { label: \"while\", lookup: None, snippet: Some(\"while $0 {}\") },\n                    CompletionItem { label: \"loop\", lookup: None, snippet: Some(\"loop {$0}\") },\n-                   CompletionItem { label: \"return\", lookup: None, snippet: Some(\"return $0\") }]\"#);\n+                   CompletionItem { label: \"return\", lookup: None, snippet: Some(\"return $0\") },\n+                   CompletionItem { label: \"pd\", lookup: None, snippet: Some(\"eprintln!(\\\"$0 = {:?}\\\", $0);\") },\n+                   CompletionItem { label: \"ppd\", lookup: None, snippet: Some(\"eprintln!(\\\"$0 = {:#?}\\\", $0);\") }]\"#);\n     }\n \n     #[test]\n@@ -434,7 +460,9 @@ mod tests {\n                    CompletionItem { label: \"loop\", lookup: None, snippet: Some(\"loop {$0}\") },\n                    CompletionItem { label: \"continue\", lookup: None, snippet: Some(\"continue\") },\n                    CompletionItem { label: \"break\", lookup: None, snippet: Some(\"break\") },\n-                   CompletionItem { label: \"return\", lookup: None, snippet: Some(\"return $0\") }]\"#);\n+                   CompletionItem { label: \"return\", lookup: None, snippet: Some(\"return $0\") },\n+                   CompletionItem { label: \"pd\", lookup: None, snippet: Some(\"eprintln!(\\\"$0 = {:?}\\\", $0);\") },\n+                   CompletionItem { label: \"ppd\", lookup: None, snippet: Some(\"eprintln!(\\\"$0 = {:#?}\\\", $0);\") }]\"#);\n         check_snippet_completion(r\"\n             fn quux() -> i32 {\n                 loop { || { <|> } }\n@@ -443,7 +471,9 @@ mod tests {\n                    CompletionItem { label: \"match\", lookup: None, snippet: Some(\"match $0 {}\") },\n                    CompletionItem { label: \"while\", lookup: None, snippet: Some(\"while $0 {}\") },\n                    CompletionItem { label: \"loop\", lookup: None, snippet: Some(\"loop {$0}\") },\n-                   CompletionItem { label: \"return\", lookup: None, snippet: Some(\"return $0\") }]\"#);\n+                   CompletionItem { label: \"return\", lookup: None, snippet: Some(\"return $0\") },\n+                   CompletionItem { label: \"pd\", lookup: None, snippet: Some(\"eprintln!(\\\"$0 = {:?}\\\", $0);\") },\n+                   CompletionItem { label: \"ppd\", lookup: None, snippet: Some(\"eprintln!(\\\"$0 = {:#?}\\\", $0);\") }]\"#);\n     }\n \n     #[test]"}]}