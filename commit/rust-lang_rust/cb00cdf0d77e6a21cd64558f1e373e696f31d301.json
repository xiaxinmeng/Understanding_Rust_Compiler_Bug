{"sha": "cb00cdf0d77e6a21cd64558f1e373e696f31d301", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNiMDBjZGYwZDc3ZTZhMjFjZDY0NTU4ZjFlMzczZTY5NmYzMWQzMDE=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2020-08-02T09:25:03Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2020-08-02T09:25:03Z"}, "message": "Remove old Symbol reexport\n\nI couldn't really tell what it was meant to improve. It seems more clear\nwithout the renaming to `Name`?", "tree": {"sha": "c6ffe3a3b45383be6bdcb88cf4cb478b4afc7582", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c6ffe3a3b45383be6bdcb88cf4cb478b4afc7582"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cb00cdf0d77e6a21cd64558f1e373e696f31d301", "comment_count": 0, "verification": {"verified": false, "reason": "unknown_key", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEb0jkZw3AJLMiOp9wGI/nM3KGUrEFAl8mhrUACgkQGI/nM3KG\nUrH7TxAAn4xanttI5lNVCtxFjvqMIpJWagRaP1j6Mlw4pdICxZhDOkrM69GVPlFk\nBZH8Vr+K/68sf4z7m5aP+4Xs5N3DTq7det5BAdZWM3LTz+m2Idfzr76jtCdSG+88\nVap7wW3awrg2NIgtwwcbbKg4kTBfPlTcCYGw6MaE0bgZ9/TR21KXQPjd8ErtH58m\n4uImk9GmRRVW8DXOaI1TFTBYsQ9LJj3egJURasGmbLRYJNlHNVtDEDm2qUZcRxHR\nezpwICLW3JbaYdjM6YK2JNp+hyKiJumVhL3mbmAnE63AT2Ngay6nTkNXPS4ia86z\ngtyVp4J3AF0Z77pgRD66n1k3tLwLsQMr9CytgyM4/tE3tdLqUQsgT2dQ2osWXB/G\n6mpwPsS7bUIY1HhRitBjYwMTn4U3xUNHwGvug9bFmKpP0MEg0py7PBz+l0NP/Vkx\n4sR9EV0WovjZ24tMVKHyUFuKpoaCnrUmYNs/Arw5Pz9Hf+kGre8NlLMrFVbzv1xz\nLB5K+X7fUp+P3fYEDbgbK4bdBhg6IKdCuwXF8yv6la4Ic2E/PowbecAWRjyO8B8K\nFvaufR6VGkrUP5OTPLo4iVLqTa3NCnbahGs/Nb4aNGu5OYLJO23TfdBIpt5wt1ke\nLoK8twXEzDJJLA87ICuYkYXp1PTcUrk1/eowDHxO1iGReEveTWQ=\n=atb5\n-----END PGP SIGNATURE-----", "payload": "tree c6ffe3a3b45383be6bdcb88cf4cb478b4afc7582\nparent bb67423577de689256483881ee9a8a0df34f7cd7\nauthor Philipp Hansch <dev@phansch.net> 1596360303 +0200\ncommitter Philipp Hansch <dev@phansch.net> 1596360303 +0200\n\nRemove old Symbol reexport\n\nI couldn't really tell what it was meant to improve. It seems more clear\nwithout the renaming to `Name`?\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cb00cdf0d77e6a21cd64558f1e373e696f31d301", "html_url": "https://github.com/rust-lang/rust/commit/cb00cdf0d77e6a21cd64558f1e373e696f31d301", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cb00cdf0d77e6a21cd64558f1e373e696f31d301/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bb67423577de689256483881ee9a8a0df34f7cd7", "url": "https://api.github.com/repos/rust-lang/rust/commits/bb67423577de689256483881ee9a8a0df34f7cd7", "html_url": "https://github.com/rust-lang/rust/commit/bb67423577de689256483881ee9a8a0df34f7cd7"}], "stats": {"total": 64, "additions": 28, "deletions": 36}, "files": [{"sha": "ed02763397a03c23dfa1e6af7e94b0177276abf4", "filename": "clippy_lints/src/attrs.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cb00cdf0d77e6a21cd64558f1e373e696f31d301/clippy_lints%2Fsrc%2Fattrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cb00cdf0d77e6a21cd64558f1e373e696f31d301/clippy_lints%2Fsrc%2Fattrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fattrs.rs?ref=cb00cdf0d77e6a21cd64558f1e373e696f31d301", "patch": "@@ -1,6 +1,5 @@\n //! checks for attributes\n \n-use crate::reexport::Name;\n use crate::utils::{\n     first_line_of_span, is_present_in_source, match_def_path, paths, snippet_opt, span_lint, span_lint_and_help,\n     span_lint_and_sugg, span_lint_and_then, without_block_comments,\n@@ -514,7 +513,7 @@ fn is_relevant_expr(cx: &LateContext<'_>, tables: &ty::TypeckTables<'_>, expr: &\n     }\n }\n \n-fn check_attrs(cx: &LateContext<'_>, span: Span, name: Name, attrs: &[Attribute]) {\n+fn check_attrs(cx: &LateContext<'_>, span: Span, name: Symbol, attrs: &[Attribute]) {\n     if span.from_expansion() {\n         return;\n     }"}, {"sha": "b336de37c61a01d31181066feaf160716249f77f", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cb00cdf0d77e6a21cd64558f1e373e696f31d301/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cb00cdf0d77e6a21cd64558f1e373e696f31d301/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=cb00cdf0d77e6a21cd64558f1e373e696f31d301", "patch": "@@ -321,10 +321,6 @@ mod zero_div_zero;\n \n pub use crate::utils::conf::Conf;\n \n-mod reexport {\n-    pub use rustc_span::Symbol as Name;\n-}\n-\n /// Register all pre expansion lints\n ///\n /// Pre-expansion lints run before any macro expansion has happened."}, {"sha": "1b3639a02a0d4b89f0489c1cb2fd8658a7323749", "filename": "clippy_lints/src/lifetimes.rs", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/cb00cdf0d77e6a21cd64558f1e373e696f31d301/clippy_lints%2Fsrc%2Flifetimes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cb00cdf0d77e6a21cd64558f1e373e696f31d301/clippy_lints%2Fsrc%2Flifetimes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flifetimes.rs?ref=cb00cdf0d77e6a21cd64558f1e373e696f31d301", "patch": "@@ -13,9 +13,8 @@ use rustc_lint::{LateContext, LateLintPass};\n use rustc_middle::hir::map::Map;\n use rustc_session::{declare_lint_pass, declare_tool_lint};\n use rustc_span::source_map::Span;\n-use rustc_span::symbol::kw;\n+use rustc_span::symbol::{Symbol, kw};\n \n-use crate::reexport::Name;\n use crate::utils::{in_macro, last_path_segment, span_lint, trait_ref_of_method};\n \n declare_clippy_lint! {\n@@ -113,7 +112,7 @@ impl<'tcx> LateLintPass<'tcx> for Lifetimes {\n enum RefLt {\n     Unnamed,\n     Static,\n-    Named(Name),\n+    Named(Symbol),\n }\n \n fn check_fn_inner<'tcx>(\n@@ -456,7 +455,7 @@ fn has_where_lifetimes<'tcx>(cx: &LateContext<'tcx>, where_clause: &'tcx WhereCl\n }\n \n struct LifetimeChecker {\n-    map: FxHashMap<Name, Span>,\n+    map: FxHashMap<Symbol, Span>,\n }\n \n impl<'tcx> Visitor<'tcx> for LifetimeChecker {"}, {"sha": "d0d6c2e04a0584351333de443239c4dc82fad455", "filename": "clippy_lints/src/loops.rs", "status": "modified", "additions": 8, "deletions": 9, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/cb00cdf0d77e6a21cd64558f1e373e696f31d301/clippy_lints%2Fsrc%2Floops.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cb00cdf0d77e6a21cd64558f1e373e696f31d301/clippy_lints%2Fsrc%2Floops.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Floops.rs?ref=cb00cdf0d77e6a21cd64558f1e373e696f31d301", "patch": "@@ -1,5 +1,4 @@\n use crate::consts::constant;\n-use crate::reexport::Name;\n use crate::utils::paths;\n use crate::utils::usage::{is_unused, mutated_variables};\n use crate::utils::{\n@@ -1184,7 +1183,7 @@ fn check_for_loop_range<'tcx>(\n     }\n }\n \n-fn is_len_call(expr: &Expr<'_>, var: Name) -> bool {\n+fn is_len_call(expr: &Expr<'_>, var: Symbol) -> bool {\n     if_chain! {\n         if let ExprKind::MethodCall(ref method, _, ref len_args, _) = expr.kind;\n         if len_args.len() == 1;\n@@ -1632,15 +1631,15 @@ struct VarVisitor<'a, 'tcx> {\n     /// var name to look for as index\n     var: HirId,\n     /// indexed variables that are used mutably\n-    indexed_mut: FxHashSet<Name>,\n+    indexed_mut: FxHashSet<Symbol>,\n     /// indirectly indexed variables (`v[(i + 4) % N]`), the extend is `None` for global\n-    indexed_indirectly: FxHashMap<Name, Option<region::Scope>>,\n+    indexed_indirectly: FxHashMap<Symbol, Option<region::Scope>>,\n     /// subset of `indexed` of vars that are indexed directly: `v[i]`\n     /// this will not contain cases like `v[calc_index(i)]` or `v[(i + 4) % N]`\n-    indexed_directly: FxHashMap<Name, (Option<region::Scope>, Ty<'tcx>)>,\n+    indexed_directly: FxHashMap<Symbol, (Option<region::Scope>, Ty<'tcx>)>,\n     /// Any names that are used outside an index operation.\n     /// Used to detect things like `&mut vec` used together with `vec[i]`\n-    referenced: FxHashSet<Name>,\n+    referenced: FxHashSet<Symbol>,\n     /// has the loop variable been used in expressions other than the index of\n     /// an index op?\n     nonindex: bool,\n@@ -1996,7 +1995,7 @@ struct InitializeVisitor<'a, 'tcx> {\n     end_expr: &'tcx Expr<'tcx>, // the for loop. Stop scanning here.\n     var_id: HirId,\n     state: VarState,\n-    name: Option<Name>,\n+    name: Option<Symbol>,\n     depth: u32, // depth of conditional expressions\n     past_loop: bool,\n }\n@@ -2159,7 +2158,7 @@ use self::Nesting::{LookFurther, RuledOut, Unknown};\n \n struct LoopNestVisitor {\n     hir_id: HirId,\n-    iterator: Name,\n+    iterator: Symbol,\n     nesting: Nesting,\n }\n \n@@ -2210,7 +2209,7 @@ impl<'tcx> Visitor<'tcx> for LoopNestVisitor {\n     }\n }\n \n-fn path_name(e: &Expr<'_>) -> Option<Name> {\n+fn path_name(e: &Expr<'_>) -> Option<Symbol> {\n     if let ExprKind::Path(QPath::Resolved(_, ref path)) = e.kind {\n         let segments = &path.segments;\n         if segments.len() == 1 {"}, {"sha": "97bd52e517c609788c0a2fc9febbe8f10fa3608a", "filename": "clippy_lints/src/shadow.rs", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/cb00cdf0d77e6a21cd64558f1e373e696f31d301/clippy_lints%2Fsrc%2Fshadow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cb00cdf0d77e6a21cd64558f1e373e696f31d301/clippy_lints%2Fsrc%2Fshadow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fshadow.rs?ref=cb00cdf0d77e6a21cd64558f1e373e696f31d301", "patch": "@@ -1,4 +1,3 @@\n-use crate::reexport::Name;\n use crate::utils::{contains_name, higher, iter_input_pats, snippet, span_lint_and_then};\n use rustc_hir::intravisit::FnKind;\n use rustc_hir::{\n@@ -10,6 +9,7 @@ use rustc_middle::lint::in_external_macro;\n use rustc_middle::ty;\n use rustc_session::{declare_lint_pass, declare_tool_lint};\n use rustc_span::source_map::Span;\n+use rustc_span::symbol::Symbol;\n \n declare_clippy_lint! {\n     /// **What it does:** Checks for bindings that shadow other bindings already in\n@@ -123,7 +123,7 @@ fn check_fn<'tcx>(cx: &LateContext<'tcx>, decl: &'tcx FnDecl<'_>, body: &'tcx Bo\n     check_expr(cx, &body.value, &mut bindings);\n }\n \n-fn check_block<'tcx>(cx: &LateContext<'tcx>, block: &'tcx Block<'_>, bindings: &mut Vec<(Name, Span)>) {\n+fn check_block<'tcx>(cx: &LateContext<'tcx>, block: &'tcx Block<'_>, bindings: &mut Vec<(Symbol, Span)>) {\n     let len = bindings.len();\n     for stmt in block.stmts {\n         match stmt.kind {\n@@ -138,7 +138,7 @@ fn check_block<'tcx>(cx: &LateContext<'tcx>, block: &'tcx Block<'_>, bindings: &\n     bindings.truncate(len);\n }\n \n-fn check_local<'tcx>(cx: &LateContext<'tcx>, local: &'tcx Local<'_>, bindings: &mut Vec<(Name, Span)>) {\n+fn check_local<'tcx>(cx: &LateContext<'tcx>, local: &'tcx Local<'_>, bindings: &mut Vec<(Symbol, Span)>) {\n     if in_external_macro(cx.sess(), local.span) {\n         return;\n     }\n@@ -173,7 +173,7 @@ fn check_pat<'tcx>(\n     pat: &'tcx Pat<'_>,\n     init: Option<&'tcx Expr<'_>>,\n     span: Span,\n-    bindings: &mut Vec<(Name, Span)>,\n+    bindings: &mut Vec<(Symbol, Span)>,\n ) {\n     // TODO: match more stuff / destructuring\n     match pat.kind {\n@@ -254,7 +254,7 @@ fn check_pat<'tcx>(\n \n fn lint_shadow<'tcx>(\n     cx: &LateContext<'tcx>,\n-    name: Name,\n+    name: Symbol,\n     span: Span,\n     pattern_span: Span,\n     init: Option<&'tcx Expr<'_>>,\n@@ -315,7 +315,7 @@ fn lint_shadow<'tcx>(\n     }\n }\n \n-fn check_expr<'tcx>(cx: &LateContext<'tcx>, expr: &'tcx Expr<'_>, bindings: &mut Vec<(Name, Span)>) {\n+fn check_expr<'tcx>(cx: &LateContext<'tcx>, expr: &'tcx Expr<'_>, bindings: &mut Vec<(Symbol, Span)>) {\n     if in_external_macro(cx.sess(), expr.span) {\n         return;\n     }\n@@ -351,7 +351,7 @@ fn check_expr<'tcx>(cx: &LateContext<'tcx>, expr: &'tcx Expr<'_>, bindings: &mut\n     }\n }\n \n-fn check_ty<'tcx>(cx: &LateContext<'tcx>, ty: &'tcx Ty<'_>, bindings: &mut Vec<(Name, Span)>) {\n+fn check_ty<'tcx>(cx: &LateContext<'tcx>, ty: &'tcx Ty<'_>, bindings: &mut Vec<(Symbol, Span)>) {\n     match ty.kind {\n         TyKind::Slice(ref sty) => check_ty(cx, sty, bindings),\n         TyKind::Array(ref fty, ref anon_const) => {\n@@ -371,7 +371,7 @@ fn check_ty<'tcx>(cx: &LateContext<'tcx>, ty: &'tcx Ty<'_>, bindings: &mut Vec<(\n     }\n }\n \n-fn is_self_shadow(name: Name, expr: &Expr<'_>) -> bool {\n+fn is_self_shadow(name: Symbol, expr: &Expr<'_>) -> bool {\n     match expr.kind {\n         ExprKind::Box(ref inner) | ExprKind::AddrOf(_, _, ref inner) => is_self_shadow(name, inner),\n         ExprKind::Block(ref block, _) => {\n@@ -383,6 +383,6 @@ fn is_self_shadow(name: Name, expr: &Expr<'_>) -> bool {\n     }\n }\n \n-fn path_eq_name(name: Name, path: &Path<'_>) -> bool {\n+fn path_eq_name(name: Symbol, path: &Path<'_>) -> bool {\n     !path.is_global() && path.segments.len() == 1 && path.segments[0].ident.as_str() == name.as_str()\n }"}, {"sha": "39317ecc82ef73440917f5cd78c0ae440609b3a7", "filename": "clippy_lints/src/utils/mod.rs", "status": "modified", "additions": 7, "deletions": 8, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/cb00cdf0d77e6a21cd64558f1e373e696f31d301/clippy_lints%2Fsrc%2Futils%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cb00cdf0d77e6a21cd64558f1e373e696f31d301/clippy_lints%2Fsrc%2Futils%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Fmod.rs?ref=cb00cdf0d77e6a21cd64558f1e373e696f31d301", "patch": "@@ -52,7 +52,6 @@ use rustc_trait_selection::traits::query::normalize::AtExt;\n use smallvec::SmallVec;\n \n use crate::consts::{constant, Constant};\n-use crate::reexport::Name;\n \n /// Returns `true` if the two spans come from differing expansions (i.e., one is\n /// from a macro and one isn't).\n@@ -150,7 +149,7 @@ pub fn match_trait_method(cx: &LateContext<'_>, expr: &Expr<'_>, path: &[&str])\n }\n \n /// Checks if an expression references a variable of the given name.\n-pub fn match_var(expr: &Expr<'_>, var: Name) -> bool {\n+pub fn match_var(expr: &Expr<'_>, var: Symbol) -> bool {\n     if let ExprKind::Path(QPath::Resolved(None, ref path)) = expr.kind {\n         if let [p] = path.segments {\n             return p.ident.name == var;\n@@ -422,7 +421,7 @@ pub fn is_entrypoint_fn(cx: &LateContext<'_>, def_id: DefId) -> bool {\n }\n \n /// Gets the name of the item the expression is in, if available.\n-pub fn get_item_name(cx: &LateContext<'_>, expr: &Expr<'_>) -> Option<Name> {\n+pub fn get_item_name(cx: &LateContext<'_>, expr: &Expr<'_>) -> Option<Symbol> {\n     let parent_id = cx.tcx.hir().get_parent_item(expr.hir_id);\n     match cx.tcx.hir().find(parent_id) {\n         Some(\n@@ -435,7 +434,7 @@ pub fn get_item_name(cx: &LateContext<'_>, expr: &Expr<'_>) -> Option<Name> {\n }\n \n /// Gets the name of a `Pat`, if any.\n-pub fn get_pat_name(pat: &Pat<'_>) -> Option<Name> {\n+pub fn get_pat_name(pat: &Pat<'_>) -> Option<Symbol> {\n     match pat.kind {\n         PatKind::Binding(.., ref spname, _) => Some(spname.name),\n         PatKind::Path(ref qpath) => single_segment_path(qpath).map(|ps| ps.ident.name),\n@@ -445,14 +444,14 @@ pub fn get_pat_name(pat: &Pat<'_>) -> Option<Name> {\n }\n \n struct ContainsName {\n-    name: Name,\n+    name: Symbol,\n     result: bool,\n }\n \n impl<'tcx> Visitor<'tcx> for ContainsName {\n     type Map = Map<'tcx>;\n \n-    fn visit_name(&mut self, _: Span, name: Name) {\n+    fn visit_name(&mut self, _: Span, name: Symbol) {\n         if self.name == name {\n             self.result = true;\n         }\n@@ -463,7 +462,7 @@ impl<'tcx> Visitor<'tcx> for ContainsName {\n }\n \n /// Checks if an `Expr` contains a certain name.\n-pub fn contains_name(name: Name, expr: &Expr<'_>) -> bool {\n+pub fn contains_name(name: Symbol, expr: &Expr<'_>) -> bool {\n     let mut cn = ContainsName { name, result: false };\n     cn.visit_expr(expr);\n     cn.result\n@@ -1029,7 +1028,7 @@ pub fn is_allowed(cx: &LateContext<'_>, lint: &'static Lint, id: HirId) -> bool\n     cx.tcx.lint_level_at_node(lint, id).0 == Level::Allow\n }\n \n-pub fn get_arg_name(pat: &Pat<'_>) -> Option<Name> {\n+pub fn get_arg_name(pat: &Pat<'_>) -> Option<Symbol> {\n     match pat.kind {\n         PatKind::Binding(.., ident, None) => Some(ident.name),\n         PatKind::Ref(ref subpat, _) => get_arg_name(subpat),"}]}