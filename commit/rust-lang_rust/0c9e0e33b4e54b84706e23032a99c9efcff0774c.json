{"sha": "0c9e0e33b4e54b84706e23032a99c9efcff0774c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBjOWUwZTMzYjRlNTRiODQ3MDZlMjMwMzJhOTljOWVmY2ZmMDc3NGM=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-08-16T16:13:25Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-08-16T16:13:25Z"}, "message": "Rollup merge of #53377 - cuviper:pointer-elf_size, r=alexcrichton\n\nstd: Use target_pointer_width for BACKTRACE_ELF_SIZE\n\nThe former code used `target.contains(\"64\")` to detect Elf64 targets,\nbut this is inaccurate in a few cases:\n\n- `s390x-unknown-linux-gnu` is 64-bit\n- `sparcv9-sun-solaris` is 64-bit\n- `x86_64-unknown-linux-gnux32` is 32-bit\n\nInstead the `std` build script can use `CARGO_CFG_TARGET_POINTER_WIDTH`\nto reliably detect 64-bit targets for libbacktrace.\n\nAlso update to backtrace-sys 0.1.24 for alexcrichton/backtrace-rs#122.", "tree": {"sha": "63d064f25a568f3f77d7da74a99b2e11d05d002c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/63d064f25a568f3f77d7da74a99b2e11d05d002c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0c9e0e33b4e54b84706e23032a99c9efcff0774c", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbdaKlCRBK7hj4Ov3rIwAAdHIIAJ/I++nBgw4Hq80xcMHEOvSU\nXhrQKVmYw0VCFaS7aq+H6kT6nR5f/xz4Q4MrHR/dmb2PLVnyIFW4+nvFoFJ0eH+q\nZegil7gZ8UFUgsEAb7cvbPVZgL0uievi2fvTLXtBfLJ2nYnjSmg/12L8+XLU1lDv\nh1qmfen6OxcVM/QOHEv2KS2kZUJQTChuSiyvKgEoscW7DOPVu3Ha1FbJPn5c6PP8\n2hTntj2q/1lXB2VEU/xoMnu7m6PxJ5GDbWTsX+3s0DHM1QYpwu9LymYcFtT0EUxR\nOjjFAbyC4N1cPgNXrtyPog4Gs+CQHDN5d0v9hkO1Tbvfe842O3odBUWwK0a3XHY=\n=gjV7\n-----END PGP SIGNATURE-----\n", "payload": "tree 63d064f25a568f3f77d7da74a99b2e11d05d002c\nparent 098d80d44a7492040d6146832569f362b6279bfe\nparent e0d8364dadd404a37bc344ef089926745cfdbe20\nauthor kennytm <kennytm@gmail.com> 1534436005 +0800\ncommitter GitHub <noreply@github.com> 1534436005 +0800\n\nRollup merge of #53377 - cuviper:pointer-elf_size, r=alexcrichton\n\nstd: Use target_pointer_width for BACKTRACE_ELF_SIZE\n\nThe former code used `target.contains(\"64\")` to detect Elf64 targets,\nbut this is inaccurate in a few cases:\n\n- `s390x-unknown-linux-gnu` is 64-bit\n- `sparcv9-sun-solaris` is 64-bit\n- `x86_64-unknown-linux-gnux32` is 32-bit\n\nInstead the `std` build script can use `CARGO_CFG_TARGET_POINTER_WIDTH`\nto reliably detect 64-bit targets for libbacktrace.\n\nAlso update to backtrace-sys 0.1.24 for alexcrichton/backtrace-rs#122.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0c9e0e33b4e54b84706e23032a99c9efcff0774c", "html_url": "https://github.com/rust-lang/rust/commit/0c9e0e33b4e54b84706e23032a99c9efcff0774c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0c9e0e33b4e54b84706e23032a99c9efcff0774c/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "098d80d44a7492040d6146832569f362b6279bfe", "url": "https://api.github.com/repos/rust-lang/rust/commits/098d80d44a7492040d6146832569f362b6279bfe", "html_url": "https://github.com/rust-lang/rust/commit/098d80d44a7492040d6146832569f362b6279bfe"}, {"sha": "e0d8364dadd404a37bc344ef089926745cfdbe20", "url": "https://api.github.com/repos/rust-lang/rust/commits/e0d8364dadd404a37bc344ef089926745cfdbe20", "html_url": "https://github.com/rust-lang/rust/commit/e0d8364dadd404a37bc344ef089926745cfdbe20"}], "stats": {"total": 9, "additions": 5, "deletions": 4}, "files": [{"sha": "99b768ab1a92edc66c0bd61cabd6e55b26c9c9bb", "filename": "src/Cargo.lock", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/0c9e0e33b4e54b84706e23032a99c9efcff0774c/src%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/0c9e0e33b4e54b84706e23032a99c9efcff0774c/src%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2FCargo.lock?ref=0c9e0e33b4e54b84706e23032a99c9efcff0774c", "patch": "@@ -100,7 +100,7 @@ name = \"backtrace\"\n version = \"0.3.9\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"backtrace-sys 0.1.23 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"backtrace-sys 0.1.24 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"cfg-if 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.43 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rustc-demangle 0.1.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -109,7 +109,7 @@ dependencies = [\n \n [[package]]\n name = \"backtrace-sys\"\n-version = \"0.1.23\"\n+version = \"0.1.24\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"cc 1.0.18 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -3125,7 +3125,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum assert_cli 0.6.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"98589b0e465a6c510d95fceebd365bb79bedece7f6e18a480897f2015f85ec51\"\n \"checksum atty 0.2.11 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9a7d5b8723950951411ee34d271d99dddcc2035a16ab25310ea2c8cfd4369652\"\n \"checksum backtrace 0.3.9 (registry+https://github.com/rust-lang/crates.io-index)\" = \"89a47830402e9981c5c41223151efcced65a0510c13097c769cede7efb34782a\"\n-\"checksum backtrace-sys 0.1.23 (registry+https://github.com/rust-lang/crates.io-index)\" = \"bff67d0c06556c0b8e6b5f090f0eac52d950d9dfd1d35ba04e4ca3543eaf6a7e\"\n+\"checksum backtrace-sys 0.1.24 (registry+https://github.com/rust-lang/crates.io-index)\" = \"c66d56ac8dabd07f6aacdaf633f4b8262f5b3601a810a0dcddffd5c22c69daa0\"\n \"checksum bitflags 0.9.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"4efd02e230a02e18f92fc2735f44597385ed02ad8f831e7c1c1156ee5e1ab3a5\"\n \"checksum bitflags 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"d0c54bb8f454c567f21197eefcdbf5679d0bd99f2ddbe52e84c77061952e6789\"\n \"checksum bufstream 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f2f382711e76b9de6c744cc00d0497baba02fb00a787f088c879f01d09468e32\""}, {"sha": "016e7adb4c914e1445b4db78d9ddc5229c331884", "filename": "src/libstd/build.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/0c9e0e33b4e54b84706e23032a99c9efcff0774c/src%2Flibstd%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0c9e0e33b4e54b84706e23032a99c9efcff0774c/src%2Flibstd%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fbuild.rs?ref=0c9e0e33b4e54b84706e23032a99c9efcff0774c", "patch": "@@ -104,7 +104,8 @@ fn build_libbacktrace(target: &str) -> Result<(), ()> {\n     } else {\n         build.file(\"../libbacktrace/elf.c\");\n \n-        if target.contains(\"64\") {\n+        let pointer_width = env::var(\"CARGO_CFG_TARGET_POINTER_WIDTH\").unwrap();\n+        if pointer_width == \"64\" {\n             build.define(\"BACKTRACE_ELF_SIZE\", \"64\");\n         } else {\n             build.define(\"BACKTRACE_ELF_SIZE\", \"32\");"}]}