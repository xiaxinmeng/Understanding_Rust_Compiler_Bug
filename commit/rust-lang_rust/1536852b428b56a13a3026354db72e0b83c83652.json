{"sha": "1536852b428b56a13a3026354db72e0b83c83652", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE1MzY4NTJiNDI4YjU2YTEzYTMwMjYzNTRkYjcyZTBiODNjODM2NTI=", "commit": {"author": {"name": "Andy Russell", "email": "arussell123@gmail.com", "date": "2019-02-23T20:10:56Z"}, "committer": {"name": "Andy Russell", "email": "arussell123@gmail.com", "date": "2019-02-23T20:10:56Z"}, "message": "merge early and late passes into single struct", "tree": {"sha": "f95e131b72686374376523af58f9e056f1280411", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f95e131b72686374376523af58f9e056f1280411"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1536852b428b56a13a3026354db72e0b83c83652", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQFKBAABCAA0FiEELriChyEaiMu0yCg7viIhAz7bw3QFAlxxqOEWHGFydXNzZWxs\nMTIzQGdtYWlsLmNvbQAKCRC+IiEDPtvDdPQTB/4wjf9dbRcc2QrEQ3vHZUd1AUb6\nfHKCSgOQrm6BvjSKhklhbdvRa4lfH1KZIwdBGpWRerOJpA1XSZBSyoJzxXxDHDCD\nCixGrKRvAgyOAI/hhow5gOXlEiV3B7lr5g9SlW/TC8WxiI8yjK0V8ZDuF3+GDNjw\nhgb+BZ+QcJxKai2KEDiwkrdnc5CgI3/DF9BG0W3CsSJ+Eq7qGlEYLAQI2UQ9ruR4\nMl/6tSZwTSOOnYptRRqjgYJs8FEDkNAu6UlPGGnu7TXer668uASfFmRIN8D71rGJ\nNLYxcP0Am3XXSdb2WHaE+SimkPDGy2DT5qBx23xdreYJzpvds1m7E6zgm9FV\n=4Q2l\n-----END PGP SIGNATURE-----", "payload": "tree f95e131b72686374376523af58f9e056f1280411\nparent 906ec8acce8126172df758e7e7f400429c3489dc\nauthor Andy Russell <arussell123@gmail.com> 1550952656 -0500\ncommitter Andy Russell <arussell123@gmail.com> 1550952656 -0500\n\nmerge early and late passes into single struct\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1536852b428b56a13a3026354db72e0b83c83652", "html_url": "https://github.com/rust-lang/rust/commit/1536852b428b56a13a3026354db72e0b83c83652", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1536852b428b56a13a3026354db72e0b83c83652/comments", "author": {"login": "euclio", "id": 1372438, "node_id": "MDQ6VXNlcjEzNzI0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1372438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/euclio", "html_url": "https://github.com/euclio", "followers_url": "https://api.github.com/users/euclio/followers", "following_url": "https://api.github.com/users/euclio/following{/other_user}", "gists_url": "https://api.github.com/users/euclio/gists{/gist_id}", "starred_url": "https://api.github.com/users/euclio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/euclio/subscriptions", "organizations_url": "https://api.github.com/users/euclio/orgs", "repos_url": "https://api.github.com/users/euclio/repos", "events_url": "https://api.github.com/users/euclio/events{/privacy}", "received_events_url": "https://api.github.com/users/euclio/received_events", "type": "User", "site_admin": false}, "committer": {"login": "euclio", "id": 1372438, "node_id": "MDQ6VXNlcjEzNzI0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1372438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/euclio", "html_url": "https://github.com/euclio", "followers_url": "https://api.github.com/users/euclio/followers", "following_url": "https://api.github.com/users/euclio/following{/other_user}", "gists_url": "https://api.github.com/users/euclio/gists{/gist_id}", "starred_url": "https://api.github.com/users/euclio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/euclio/subscriptions", "organizations_url": "https://api.github.com/users/euclio/orgs", "repos_url": "https://api.github.com/users/euclio/repos", "events_url": "https://api.github.com/users/euclio/events{/privacy}", "received_events_url": "https://api.github.com/users/euclio/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "906ec8acce8126172df758e7e7f400429c3489dc", "url": "https://api.github.com/repos/rust-lang/rust/commits/906ec8acce8126172df758e7e7f400429c3489dc", "html_url": "https://github.com/rust-lang/rust/commit/906ec8acce8126172df758e7e7f400429c3489dc"}], "stats": {"total": 206, "additions": 68, "deletions": 138}, "files": [{"sha": "b1c53ea92b300b6c1ee7af855b38fde739dd0bad", "filename": "src/librustdoc/config.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fconfig.rs?ref=1536852b428b56a13a3026354db72e0b83c83652", "patch": "@@ -214,7 +214,7 @@ impl Options {\n         if matches.opt_strs(\"passes\") == [\"list\"] {\n             println!(\"Available passes for running rustdoc:\");\n             for pass in passes::PASSES {\n-                println!(\"{:>20} - {}\", pass.name(), pass.description());\n+                println!(\"{:>20} - {}\", pass.name, pass.description);\n             }\n             println!(\"\\nDefault passes for rustdoc:\");\n             for &name in passes::DEFAULT_PASSES {"}, {"sha": "bf95cde163fc3817041c495976372b46e32232d2", "filename": "src/librustdoc/core.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fcore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fcore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fcore.rs?ref=1536852b428b56a13a3026354db72e0b83c83652", "patch": "@@ -606,10 +606,12 @@ pub fn run_core(options: RustdocOptions) -> (clean::Crate, RenderInfo, RenderOpt\n                 passes::defaults(default_passes).iter().map(|p| p.to_string()).collect();\n             passes.extend(manual_passes);\n \n+            info!(\"Executing passes\");\n+\n             for pass in &passes {\n-                // the \"unknown pass\" error will be reported when late passes are run\n-                if let Some(pass) = passes::find_pass(pass).and_then(|p| p.early_fn()) {\n-                    krate = pass(krate, &ctxt);\n+                match passes::find_pass(pass).map(|p| p.pass) {\n+                    Some(pass) => krate = pass(krate, &ctxt),\n+                    None => error!(\"unknown pass {}, skipping\", *pass),\n                 }\n             }\n "}, {"sha": "39e504951d1c6dbefb0fa29c90967b1720c66179", "filename": "src/librustdoc/lib.rs", "status": "modified", "additions": 0, "deletions": 22, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Flib.rs?ref=1536852b428b56a13a3026354db72e0b83c83652", "patch": "@@ -441,28 +441,6 @@ where R: 'static + Send,\n \n         krate.version = crate_version;\n \n-        info!(\"Executing passes\");\n-\n-        for pass in &passes {\n-            // determine if we know about this pass\n-            let pass = match passes::find_pass(pass) {\n-                Some(pass) => if let Some(pass) = pass.late_fn() {\n-                    pass\n-                } else {\n-                    // not a late pass, but still valid so don't report the error\n-                    continue\n-                }\n-                None => {\n-                    error!(\"unknown pass {}, skipping\", *pass);\n-\n-                    continue\n-                },\n-            };\n-\n-            // run it\n-            krate = pass(krate);\n-        }\n-\n         tx.send(f(Output {\n             krate: krate,\n             renderinfo: renderinfo,"}, {"sha": "88d9c87c5289892df082e82b9789430427eeec11", "filename": "src/librustdoc/passes/check_code_block_syntax.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fcheck_code_block_syntax.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fcheck_code_block_syntax.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcheck_code_block_syntax.rs?ref=1536852b428b56a13a3026354db72e0b83c83652", "patch": "@@ -10,9 +10,11 @@ use crate::fold::DocFolder;\n use crate::html::markdown::{self, RustCodeBlock};\n use crate::passes::Pass;\n \n-pub const CHECK_CODE_BLOCK_SYNTAX: Pass =\n-    Pass::early(\"check-code-block-syntax\", check_code_block_syntax,\n-                \"validates syntax inside Rust code blocks\");\n+pub const CHECK_CODE_BLOCK_SYNTAX: Pass = Pass {\n+    name: \"check-code-block-syntax\",\n+    pass: check_code_block_syntax,\n+    description: \"validates syntax inside Rust code blocks\",\n+};\n \n pub fn check_code_block_syntax(krate: clean::Crate, cx: &DocContext<'_, '_, '_>) -> clean::Crate {\n     SyntaxChecker { cx }.fold_crate(krate)"}, {"sha": "088a6ea77c73ff53b64c7023ee29513b92cd5cfd", "filename": "src/librustdoc/passes/collapse_docs.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fcollapse_docs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fcollapse_docs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcollapse_docs.rs?ref=1536852b428b56a13a3026354db72e0b83c83652", "patch": "@@ -6,9 +6,11 @@ use crate::passes::Pass;\n \n use std::mem::replace;\n \n-pub const COLLAPSE_DOCS: Pass =\n-    Pass::early(\"collapse-docs\", collapse_docs,\n-        \"concatenates all document attributes into one document attribute\");\n+pub const COLLAPSE_DOCS: Pass = Pass {\n+    name: \"collapse-docs\",\n+    pass: collapse_docs,\n+    description: \"concatenates all document attributes into one document attribute\",\n+};\n \n #[derive(Copy, Clone, Debug, PartialEq, Eq)]\n enum DocFragmentKind {"}, {"sha": "532bb96445105663094c28362d2f13c4d496add3", "filename": "src/librustdoc/passes/collect_intra_doc_links.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs?ref=1536852b428b56a13a3026354db72e0b83c83652", "patch": "@@ -18,9 +18,11 @@ use crate::passes::{look_for_tests, Pass};\n \n use super::span_of_attrs;\n \n-pub const COLLECT_INTRA_DOC_LINKS: Pass =\n-    Pass::early(\"collect-intra-doc-links\", collect_intra_doc_links,\n-                \"reads a crate's documentation to resolve intra-doc-links\");\n+pub const COLLECT_INTRA_DOC_LINKS: Pass = Pass {\n+    name: \"collect-intra-doc-links\",\n+    pass: collect_intra_doc_links,\n+    description: \"reads a crate's documentation to resolve intra-doc-links\",\n+};\n \n pub fn collect_intra_doc_links(krate: Crate, cx: &DocContext<'_, '_, '_>) -> Crate {\n     if !UnstableFeatures::from_environment().is_nightly_build() {"}, {"sha": "4c90540871d2eb3dabcbe2aa692ff53b81822def", "filename": "src/librustdoc/passes/collect_trait_impls.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fcollect_trait_impls.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fcollect_trait_impls.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcollect_trait_impls.rs?ref=1536852b428b56a13a3026354db72e0b83c83652", "patch": "@@ -6,9 +6,11 @@ use super::Pass;\n use rustc::util::nodemap::FxHashSet;\n use rustc::hir::def_id::DefId;\n \n-pub const COLLECT_TRAIT_IMPLS: Pass =\n-    Pass::early(\"collect-trait-impls\", collect_trait_impls,\n-                \"retrieves trait impls for items in the crate\");\n+pub const COLLECT_TRAIT_IMPLS: Pass = Pass {\n+    name: \"collect-trait-impls\",\n+    pass: collect_trait_impls,\n+    description: \"retrieves trait impls for items in the crate\",\n+};\n \n pub fn collect_trait_impls(krate: Crate, cx: &DocContext<'_, '_, '_>) -> Crate {\n     let mut synth = SyntheticImplCollector::new(cx);"}, {"sha": "3a9d8ef20ce84769bbd1cd68be07d4f23719709a", "filename": "src/librustdoc/passes/mod.rs", "status": "modified", "additions": 9, "deletions": 80, "changes": 89, "blob_url": "https://github.com/rust-lang/rust/blob/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fmod.rs?ref=1536852b428b56a13a3026354db72e0b83c83652", "patch": "@@ -6,7 +6,6 @@ use rustc::lint as lint;\n use rustc::middle::privacy::AccessLevels;\n use rustc::util::nodemap::DefIdSet;\n use std::mem;\n-use std::fmt;\n use syntax::ast::NodeId;\n use syntax_pos::{DUMMY_SP, Span};\n use std::ops::Range;\n@@ -46,84 +45,14 @@ pub use self::collect_trait_impls::COLLECT_TRAIT_IMPLS;\n mod check_code_block_syntax;\n pub use self::check_code_block_syntax::CHECK_CODE_BLOCK_SYNTAX;\n \n-/// Represents a single pass.\n+/// A single pass over the cleaned documentation.\n+///\n+/// Runs in the compiler context, so it has access to types and traits and the like.\n #[derive(Copy, Clone)]\n-pub enum Pass {\n-    /// An \"early pass\" is run in the compiler context, and can gather information about types and\n-    /// traits and the like.\n-    EarlyPass {\n-        name: &'static str,\n-        pass: fn(clean::Crate, &DocContext<'_, '_, '_>) -> clean::Crate,\n-        description: &'static str,\n-    },\n-    /// A \"late pass\" is run between crate cleaning and page generation.\n-    LatePass {\n-        name: &'static str,\n-        pass: fn(clean::Crate) -> clean::Crate,\n-        description: &'static str,\n-    },\n-}\n-\n-impl fmt::Debug for Pass {\n-    fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {\n-        let mut dbg = match *self {\n-            Pass::EarlyPass { .. } => f.debug_struct(\"EarlyPass\"),\n-            Pass::LatePass { .. } => f.debug_struct(\"LatePass\"),\n-        };\n-\n-        dbg.field(\"name\", &self.name())\n-           .field(\"pass\", &\"...\")\n-           .field(\"description\", &self.description())\n-           .finish()\n-    }\n-}\n-\n-impl Pass {\n-    /// Constructs a new early pass.\n-    pub const fn early(name: &'static str,\n-                       pass: fn(clean::Crate, &DocContext<'_, '_, '_>) -> clean::Crate,\n-                       description: &'static str) -> Pass {\n-        Pass::EarlyPass { name, pass, description }\n-    }\n-\n-    /// Constructs a new late pass.\n-    pub const fn late(name: &'static str,\n-                      pass: fn(clean::Crate) -> clean::Crate,\n-                      description: &'static str) -> Pass {\n-        Pass::LatePass { name, pass, description }\n-    }\n-\n-    /// Returns the name of this pass.\n-    pub fn name(self) -> &'static str {\n-        match self {\n-            Pass::EarlyPass { name, .. } |\n-                Pass::LatePass { name, .. } => name,\n-        }\n-    }\n-\n-    /// Returns the description of this pass.\n-    pub fn description(self) -> &'static str {\n-        match self {\n-            Pass::EarlyPass { description, .. } |\n-                Pass::LatePass { description, .. } => description,\n-        }\n-    }\n-\n-    /// If this pass is an early pass, returns the pointer to its function.\n-    pub fn early_fn(self) -> Option<fn(clean::Crate, &DocContext<'_, '_, '_>) -> clean::Crate> {\n-        match self {\n-            Pass::EarlyPass { pass, .. } => Some(pass),\n-            _ => None,\n-        }\n-    }\n-\n-    /// If this pass is a late pass, returns the pointer to its function.\n-    pub fn late_fn(self) -> Option<fn(clean::Crate) -> clean::Crate> {\n-        match self {\n-            Pass::LatePass { pass, .. } => Some(pass),\n-            _ => None,\n-        }\n-    }\n+pub struct Pass {\n+    pub name: &'static str,\n+    pub pass: fn(clean::Crate, &DocContext<'_, '_, '_>) -> clean::Crate,\n+    pub description: &'static str,\n }\n \n /// The full list of passes.\n@@ -184,8 +113,8 @@ pub fn defaults(default_set: DefaultPassOption) -> &'static [&'static str] {\n }\n \n /// If the given name matches a known pass, returns its information.\n-pub fn find_pass(pass_name: &str) -> Option<Pass> {\n-    PASSES.iter().find(|p| p.name() == pass_name).cloned()\n+pub fn find_pass(pass_name: &str) -> Option<&'static Pass> {\n+    PASSES.iter().find(|p| p.name == pass_name)\n }\n \n struct Stripper<'a> {"}, {"sha": "1c3977c4f85cddd36eabf65220353c2ad4ee198c", "filename": "src/librustdoc/passes/private_items_doc_tests.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fprivate_items_doc_tests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fprivate_items_doc_tests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fprivate_items_doc_tests.rs?ref=1536852b428b56a13a3026354db72e0b83c83652", "patch": "@@ -3,10 +3,11 @@ use crate::core::DocContext;\n use crate::fold::DocFolder;\n use crate::passes::{look_for_tests, Pass};\n \n-\n-pub const CHECK_PRIVATE_ITEMS_DOC_TESTS: Pass =\n-    Pass::early(\"check-private-items-doc-tests\", check_private_items_doc_tests,\n-                \"check private items doc tests\");\n+pub const CHECK_PRIVATE_ITEMS_DOC_TESTS: Pass = Pass {\n+    name: \"check-private-items-doc-tests\",\n+    pass: check_private_items_doc_tests,\n+    description: \"check private items doc tests\",\n+};\n \n struct PrivateItemDocTestLinter<'a, 'tcx: 'a, 'rcx: 'a> {\n     cx: &'a DocContext<'a, 'tcx, 'rcx>,"}, {"sha": "aed80b5ba86fd7c270a95039d3882164a08666c9", "filename": "src/librustdoc/passes/propagate_doc_cfg.rs", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fpropagate_doc_cfg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fpropagate_doc_cfg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fpropagate_doc_cfg.rs?ref=1536852b428b56a13a3026354db72e0b83c83652", "patch": "@@ -2,14 +2,17 @@ use std::sync::Arc;\n \n use crate::clean::{Crate, Item};\n use crate::clean::cfg::Cfg;\n+use crate::core::DocContext;\n use crate::fold::DocFolder;\n use crate::passes::Pass;\n \n-pub const PROPAGATE_DOC_CFG: Pass =\n-    Pass::late(\"propagate-doc-cfg\", propagate_doc_cfg,\n-        \"propagates `#[doc(cfg(...))]` to child items\");\n+pub const PROPAGATE_DOC_CFG: Pass = Pass {\n+    name: \"propagate-doc-cfg\",\n+    pass: propagate_doc_cfg,\n+    description: \"propagates `#[doc(cfg(...))]` to child items\",\n+};\n \n-pub fn propagate_doc_cfg(cr: Crate) -> Crate {\n+pub fn propagate_doc_cfg(cr: Crate, _: &DocContext<'_, '_, '_>) -> Crate {\n     CfgPropagator { parent_cfg: None }.fold_crate(cr)\n }\n "}, {"sha": "330057e53843b517c2c4a61995746a6cc550934a", "filename": "src/librustdoc/passes/strip_hidden.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fstrip_hidden.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fstrip_hidden.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fstrip_hidden.rs?ref=1536852b428b56a13a3026354db72e0b83c83652", "patch": "@@ -7,9 +7,11 @@ use crate::core::DocContext;\n use crate::fold::{DocFolder, StripItem};\n use crate::passes::{ImplStripper, Pass};\n \n-pub const STRIP_HIDDEN: Pass =\n-    Pass::early(\"strip-hidden\", strip_hidden,\n-                \"strips all doc(hidden) items from the output\");\n+pub const STRIP_HIDDEN: Pass = Pass {\n+    name: \"strip-hidden\",\n+    pass: strip_hidden,\n+    description: \"strips all doc(hidden) items from the output\",\n+};\n \n /// Strip items marked `#[doc(hidden)]`\n pub fn strip_hidden(krate: clean::Crate, _: &DocContext<'_, '_, '_>) -> clean::Crate {"}, {"sha": "479f0877bd7d2c4e80418e6350bde545358c39f7", "filename": "src/librustdoc/passes/strip_priv_imports.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fstrip_priv_imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fstrip_priv_imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fstrip_priv_imports.rs?ref=1536852b428b56a13a3026354db72e0b83c83652", "patch": "@@ -3,8 +3,11 @@ use crate::fold::{DocFolder};\n use crate::core::DocContext;\n use crate::passes::{ImportStripper, Pass};\n \n-pub const STRIP_PRIV_IMPORTS: Pass = Pass::early(\"strip-priv-imports\", strip_priv_imports,\n-     \"strips all private import statements (`use`, `extern crate`) from a crate\");\n+pub const STRIP_PRIV_IMPORTS: Pass = Pass {\n+    name: \"strip-priv-imports\",\n+    pass: strip_priv_imports,\n+    description: \"strips all private import statements (`use`, `extern crate`) from a crate\",\n+};\n \n pub fn strip_priv_imports(krate: clean::Crate, _: &DocContext<'_, '_, '_>)  -> clean::Crate {\n     ImportStripper.fold_crate(krate)"}, {"sha": "1ac3a90f38d35cb191f37290498a4946ee4eaee3", "filename": "src/librustdoc/passes/strip_private.rs", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fstrip_private.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Fstrip_private.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fstrip_private.rs?ref=1536852b428b56a13a3026354db72e0b83c83652", "patch": "@@ -5,10 +5,12 @@ use crate::fold::{DocFolder};\n use crate::core::DocContext;\n use crate::passes::{ImplStripper, ImportStripper, Stripper, Pass};\n \n-pub const STRIP_PRIVATE: Pass =\n-    Pass::early(\"strip-private\", strip_private,\n-        \"strips all private items from a crate which cannot be seen externally, \\\n-         implies strip-priv-imports\");\n+pub const STRIP_PRIVATE: Pass = Pass {\n+    name: \"strip-private\",\n+    pass: strip_private,\n+    description: \"strips all private items from a crate which cannot be seen externally, \\\n+        implies strip-priv-imports\",\n+};\n \n /// Strip private items from the point of view of a crate or externally from a\n /// crate, specified by the `xcrate` flag."}, {"sha": "b77cf68d7c63fab3a8955b3ff5749b1156f06913", "filename": "src/librustdoc/passes/unindent_comments.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Funindent_comments.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1536852b428b56a13a3026354db72e0b83c83652/src%2Flibrustdoc%2Fpasses%2Funindent_comments.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Funindent_comments.rs?ref=1536852b428b56a13a3026354db72e0b83c83652", "patch": "@@ -7,9 +7,11 @@ use crate::core::DocContext;\n use crate::fold::{self, DocFolder};\n use crate::passes::Pass;\n \n-pub const UNINDENT_COMMENTS: Pass =\n-    Pass::early(\"unindent-comments\", unindent_comments,\n-        \"removes excess indentation on comments in order for markdown to like it\");\n+pub const UNINDENT_COMMENTS: Pass = Pass {\n+    name: \"unindent-comments\",\n+    pass: unindent_comments,\n+    description: \"removes excess indentation on comments in order for markdown to like it\",\n+};\n \n pub fn unindent_comments(krate: clean::Crate, _: &DocContext<'_, '_, '_>) -> clean::Crate {\n     CommentCleaner.fold_crate(krate)"}]}