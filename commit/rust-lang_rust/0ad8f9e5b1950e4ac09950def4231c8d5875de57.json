{"sha": "0ad8f9e5b1950e4ac09950def4231c8d5875de57", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBhZDhmOWU1YjE5NTBlNGFjMDk5NTBkZWY0MjMxYzhkNTg3NWRlNTc=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2018-07-04T16:21:42Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2018-07-04T16:21:42Z"}, "message": "Auto merge of #51395 - SimonSapin:repr-transparent, r=SimonSapin\n\nAdd #[repr(transparent)] to some libcore types\n\n* `UnsafeCell`\n* `Cell`\n* `NonZero*`\n* `NonNull`\n* `Unique`\n\nCC https://github.com/rust-lang/rust/issues/43036", "tree": {"sha": "1447e7b31c5844fb8762c0ed0cfc12f607694c68", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1447e7b31c5844fb8762c0ed0cfc12f607694c68"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0ad8f9e5b1950e4ac09950def4231c8d5875de57", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0ad8f9e5b1950e4ac09950def4231c8d5875de57", "html_url": "https://github.com/rust-lang/rust/commit/0ad8f9e5b1950e4ac09950def4231c8d5875de57", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0ad8f9e5b1950e4ac09950def4231c8d5875de57/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "eded1aa14cb322b3b1000ee98ea9ba3a10dacba1", "url": "https://api.github.com/repos/rust-lang/rust/commits/eded1aa14cb322b3b1000ee98ea9ba3a10dacba1", "html_url": "https://github.com/rust-lang/rust/commit/eded1aa14cb322b3b1000ee98ea9ba3a10dacba1"}, {"sha": "530d7bc5174e93682a38b22ac7ff4e3569bcd813", "url": "https://api.github.com/repos/rust-lang/rust/commits/530d7bc5174e93682a38b22ac7ff4e3569bcd813", "html_url": "https://github.com/rust-lang/rust/commit/530d7bc5174e93682a38b22ac7ff4e3569bcd813"}], "stats": {"total": 8, "additions": 8, "deletions": 0}, "files": [{"sha": "2292617f51e6b62ae33ae25b3f68d379ccecf403", "filename": "src/libcore/cell.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0ad8f9e5b1950e4ac09950def4231c8d5875de57/src%2Flibcore%2Fcell.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0ad8f9e5b1950e4ac09950def4231c8d5875de57/src%2Flibcore%2Fcell.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fcell.rs?ref=0ad8f9e5b1950e4ac09950def4231c8d5875de57", "patch": "@@ -235,6 +235,7 @@ use ptr;\n ///\n /// See the [module-level documentation](index.html) for more.\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n+#[repr(transparent)]\n pub struct Cell<T> {\n     value: UnsafeCell<T>,\n }\n@@ -1395,6 +1396,7 @@ impl<'a, T: ?Sized + fmt::Display> fmt::Display for RefMut<'a, T> {\n /// ```\n #[lang = \"unsafe_cell\"]\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n+#[repr(transparent)]\n pub struct UnsafeCell<T: ?Sized> {\n     value: T,\n }"}, {"sha": "b2b38820a89ccd2982cbb8664410a744c41dbfeb", "filename": "src/libcore/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0ad8f9e5b1950e4ac09950def4231c8d5875de57/src%2Flibcore%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0ad8f9e5b1950e4ac09950def4231c8d5875de57/src%2Flibcore%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Flib.rs?ref=0ad8f9e5b1950e4ac09950def4231c8d5875de57", "patch": "@@ -122,6 +122,7 @@\n #![feature(const_slice_len)]\n #![feature(const_str_as_bytes)]\n #![feature(const_str_len)]\n+#![cfg_attr(stage0, feature(repr_transparent))]\n \n #[prelude_import]\n #[allow(unused)]"}, {"sha": "cc36ea7f71391ed99f9eabf697c9475c97b126bd", "filename": "src/libcore/nonzero.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0ad8f9e5b1950e4ac09950def4231c8d5875de57/src%2Flibcore%2Fnonzero.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0ad8f9e5b1950e4ac09950def4231c8d5875de57/src%2Flibcore%2Fnonzero.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fnonzero.rs?ref=0ad8f9e5b1950e4ac09950def4231c8d5875de57", "patch": "@@ -16,6 +16,7 @@ use ops::CoerceUnsized;\n /// NULL or 0 that might allow certain optimizations.\n #[lang = \"non_zero\"]\n #[derive(Copy, Clone, Eq, PartialEq, Ord, PartialOrd, Hash)]\n+#[repr(transparent)]\n pub(crate) struct NonZero<T>(pub(crate) T);\n \n impl<T: CoerceUnsized<U>, U> CoerceUnsized<NonZero<U>> for NonZero<T> {}"}, {"sha": "0b8f8f0703df79739414df45ad0b4670a8851897", "filename": "src/libcore/num/mod.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0ad8f9e5b1950e4ac09950def4231c8d5875de57/src%2Flibcore%2Fnum%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0ad8f9e5b1950e4ac09950def4231c8d5875de57/src%2Flibcore%2Fnum%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fnum%2Fmod.rs?ref=0ad8f9e5b1950e4ac09950def4231c8d5875de57", "patch": "@@ -48,6 +48,7 @@ macro_rules! nonzero_integers {\n             /// ```\n             #[stable(feature = \"nonzero\", since = \"1.28.0\")]\n             #[derive(Copy, Clone, Eq, PartialEq, Ord, PartialOrd, Hash)]\n+            #[repr(transparent)]\n             pub struct $Ty(NonZero<$Int>);\n \n             impl $Ty {\n@@ -123,6 +124,7 @@ nonzero_integers! {\n /// ```\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n #[derive(PartialEq, Eq, PartialOrd, Ord, Clone, Copy, Default, Hash)]\n+#[repr(transparent)]\n pub struct Wrapping<T>(#[stable(feature = \"rust1\", since = \"1.0.0\")]\n                        pub T);\n "}, {"sha": "0af642258c2776157cf3496f106c24c65b765011", "filename": "src/libcore/ptr.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0ad8f9e5b1950e4ac09950def4231c8d5875de57/src%2Flibcore%2Fptr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0ad8f9e5b1950e4ac09950def4231c8d5875de57/src%2Flibcore%2Fptr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fptr.rs?ref=0ad8f9e5b1950e4ac09950def4231c8d5875de57", "patch": "@@ -2665,6 +2665,7 @@ impl<T: ?Sized> PartialOrd for *mut T {\n            reason = \"use NonNull instead and consider PhantomData<T> \\\n                      (if you also use #[may_dangle]), Send, and/or Sync\")]\n #[doc(hidden)]\n+#[repr(transparent)]\n pub struct Unique<T: ?Sized> {\n     pointer: NonZero<*const T>,\n     // NOTE: this marker has no consequences for variance, but is necessary\n@@ -2813,6 +2814,7 @@ impl<'a, T: ?Sized> From<NonNull<T>> for Unique<T> {\n /// such as Box, Rc, Arc, Vec, and LinkedList. This is the case because they\n /// provide a public API that follows the normal shared XOR mutable rules of Rust.\n #[stable(feature = \"nonnull\", since = \"1.25.0\")]\n+#[repr(transparent)]\n pub struct NonNull<T: ?Sized> {\n     pointer: NonZero<*const T>,\n }"}]}