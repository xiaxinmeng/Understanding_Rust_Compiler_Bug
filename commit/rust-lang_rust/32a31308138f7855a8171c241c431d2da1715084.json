{"sha": "32a31308138f7855a8171c241c431d2da1715084", "node_id": "C_kwDOAAsO6NoAKDMyYTMxMzA4MTM4Zjc4NTVhODE3MWMyNDFjNDMxZDJkYTE3MTUwODQ", "commit": {"author": {"name": "Josh Stone", "email": "jistone@redhat.com", "date": "2022-10-19T02:06:57Z"}, "committer": {"name": "Josh Stone", "email": "jistone@redhat.com", "date": "2022-10-29T01:49:48Z"}, "message": "Upgrade dist-x86_64-netbsd to NetBSD 9.0", "tree": {"sha": "9d0ec16d7e645edeee24fc39030434172bd68384", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9d0ec16d7e645edeee24fc39030434172bd68384"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/32a31308138f7855a8171c241c431d2da1715084", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/32a31308138f7855a8171c241c431d2da1715084", "html_url": "https://github.com/rust-lang/rust/commit/32a31308138f7855a8171c241c431d2da1715084", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/32a31308138f7855a8171c241c431d2da1715084/comments", "author": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0da281b6068a7d889ae89a9bd8991284cc9b7535", "url": "https://api.github.com/repos/rust-lang/rust/commits/0da281b6068a7d889ae89a9bd8991284cc9b7535", "html_url": "https://github.com/rust-lang/rust/commit/0da281b6068a7d889ae89a9bd8991284cc9b7535"}], "stats": {"total": 37, "additions": 17, "deletions": 20}, "files": [{"sha": "d35e4191cc0b1dfc1ae36d59caf4e74556a6997c", "filename": "compiler/rustc_llvm/build.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/32a31308138f7855a8171c241c431d2da1715084/compiler%2Frustc_llvm%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/32a31308138f7855a8171c241c431d2da1715084/compiler%2Frustc_llvm%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_llvm%2Fbuild.rs?ref=32a31308138f7855a8171c241c431d2da1715084", "patch": "@@ -334,7 +334,7 @@ fn main() {\n         \"c++\"\n     } else if target.contains(\"netbsd\") && llvm_static_stdcpp.is_some() {\n         // NetBSD uses a separate library when relocation is required\n-        \"stdc++_pic\"\n+        \"stdc++_p\"\n     } else if llvm_use_libcxx.is_some() {\n         \"c++\"\n     } else {"}, {"sha": "d03c364547e034cbdbd21b8594a98c5b4c1ce298", "filename": "src/ci/docker/host-x86_64/dist-x86_64-netbsd/Dockerfile", "status": "modified", "additions": 3, "deletions": 6, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/32a31308138f7855a8171c241c431d2da1715084/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-x86_64-netbsd%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/32a31308138f7855a8171c241c431d2da1715084/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-x86_64-netbsd%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-x86_64-netbsd%2FDockerfile?ref=32a31308138f7855a8171c241c431d2da1715084", "patch": "@@ -1,17 +1,15 @@\n-FROM ubuntu:16.04\n+FROM ubuntu:20.04\n \n COPY scripts/cross-apt-packages.sh /scripts/\n RUN sh /scripts/cross-apt-packages.sh\n+RUN DEBIAN_FRONTEND=noninteractive apt-get install -y zlib1g-dev\n \n COPY host-x86_64/dist-x86_64-netbsd/build-netbsd-toolchain.sh /tmp/\n RUN /tmp/build-netbsd-toolchain.sh\n \n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-COPY scripts/cmake.sh /scripts/\n-RUN /scripts/cmake.sh\n-\n ENV PATH=$PATH:/x-tools/x86_64-unknown-netbsd/bin\n \n ENV \\\n@@ -21,6 +19,5 @@ ENV \\\n \n ENV HOSTS=x86_64-unknown-netbsd\n \n-ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs \\\n-    --set llvm.allow-old-toolchain\n+ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs\n ENV SCRIPT python3 ../x.py dist --host $HOSTS --target $HOSTS"}, {"sha": "e0c008b76fa8bb39744460c79d8cc50751880edb", "filename": "src/ci/docker/host-x86_64/dist-x86_64-netbsd/build-netbsd-toolchain.sh", "status": "modified", "additions": 13, "deletions": 13, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/32a31308138f7855a8171c241c431d2da1715084/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-x86_64-netbsd%2Fbuild-netbsd-toolchain.sh", "raw_url": "https://github.com/rust-lang/rust/raw/32a31308138f7855a8171c241c431d2da1715084/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-x86_64-netbsd%2Fbuild-netbsd-toolchain.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-x86_64-netbsd%2Fbuild-netbsd-toolchain.sh?ref=32a31308138f7855a8171c241c431d2da1715084", "patch": "@@ -25,19 +25,19 @@ cd netbsd\n \n mkdir -p /x-tools/x86_64-unknown-netbsd/sysroot\n \n-URL=https://ci-mirrors.rust-lang.org/rustc\n-\n-# Originally from ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-$BSD/source/sets/*.tgz\n-curl $URL/2018-03-01-netbsd-src.tgz | tar xzf -\n-curl $URL/2018-03-01-netbsd-gnusrc.tgz | tar xzf -\n-curl $URL/2018-03-01-netbsd-sharesrc.tgz | tar xzf -\n-curl $URL/2018-03-01-netbsd-syssrc.tgz | tar xzf -\n-\n-# Originally from ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-$BSD/amd64/binary/sets/*.tgz\n-curl $URL/2018-03-01-netbsd-base.tgz | \\\n-  tar xzf - -C /x-tools/x86_64-unknown-netbsd/sysroot ./usr/include ./usr/lib ./lib\n-curl $URL/2018-03-01-netbsd-comp.tgz | \\\n-  tar xzf - -C /x-tools/x86_64-unknown-netbsd/sysroot ./usr/include ./usr/lib\n+# URL=https://ci-mirrors.rust-lang.org/rustc\n+\n+SOURCE_URL=https://cdn.netbsd.org/pub/NetBSD/NetBSD-9.0/source/sets\n+curl $SOURCE_URL/src.tgz | tar xzf -\n+curl $SOURCE_URL/gnusrc.tgz | tar xzf -\n+curl $SOURCE_URL/sharesrc.tgz | tar xzf -\n+curl $SOURCE_URL/syssrc.tgz | tar xzf -\n+\n+BINARY_URL=https://cdn.netbsd.org/pub/NetBSD/NetBSD-9.0/amd64/binary/sets\n+curl $BINARY_URL/base.tar.xz | \\\n+  tar xJf - -C /x-tools/x86_64-unknown-netbsd/sysroot ./usr/include ./usr/lib ./lib\n+curl $BINARY_URL/comp.tar.xz | \\\n+  tar xJf - -C /x-tools/x86_64-unknown-netbsd/sysroot ./usr/include ./usr/lib\n \n cd usr/src\n "}]}