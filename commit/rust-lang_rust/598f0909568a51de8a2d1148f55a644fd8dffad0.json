{"sha": "598f0909568a51de8a2d1148f55a644fd8dffad0", "node_id": "C_kwDOAAsO6NoAKDU5OGYwOTA5NTY4YTUxZGU4YTJkMTE0OGY1NWE2NDRmZDhkZmZhZDA", "commit": {"author": {"name": "bjorn3", "email": "17426603+bjorn3@users.noreply.github.com", "date": "2023-01-07T17:06:13Z"}, "committer": {"name": "bjorn3", "email": "17426603+bjorn3@users.noreply.github.com", "date": "2023-01-20T18:52:58Z"}, "message": "Update to Cranelift 0.92", "tree": {"sha": "07adfdff9b0c52bd51d5c3cb5073e4952b46eb78", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/07adfdff9b0c52bd51d5c3cb5073e4952b46eb78"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/598f0909568a51de8a2d1148f55a644fd8dffad0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/598f0909568a51de8a2d1148f55a644fd8dffad0", "html_url": "https://github.com/rust-lang/rust/commit/598f0909568a51de8a2d1148f55a644fd8dffad0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/598f0909568a51de8a2d1148f55a644fd8dffad0/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6eef214e46454dd508821759092253c86d269204", "url": "https://api.github.com/repos/rust-lang/rust/commits/6eef214e46454dd508821759092253c86d269204", "html_url": "https://github.com/rust-lang/rust/commit/6eef214e46454dd508821759092253c86d269204"}], "stats": {"total": 80, "additions": 33, "deletions": 47}, "files": [{"sha": "48800725d2c13778b1ea1b7639fd21fcd15a737f", "filename": "Cargo.lock", "status": "modified", "additions": 25, "deletions": 39, "changes": 64, "blob_url": "https://github.com/rust-lang/rust/blob/598f0909568a51de8a2d1148f55a644fd8dffad0/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/598f0909568a51de8a2d1148f55a644fd8dffad0/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=598f0909568a51de8a2d1148f55a644fd8dffad0", "patch": "@@ -57,28 +57,28 @@ checksum = \"baf1de4339761588bc0619e3cbc0120ee582ebb74b53b4efbf79117bd2da40fd\"\n \n [[package]]\n name = \"cranelift-bforest\"\n-version = \"0.91.0\"\n+version = \"0.92.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"fc952b310b24444fc14ab8b9cbe3fafd7e7329e3eec84c3a9b11d2b5cf6f3be1\"\n+checksum = \"2f3d54eab028f5805ae3b26fd60eca3f3a9cfb76b989d9bab173be3f61356cc3\"\n dependencies = [\n  \"cranelift-entity\",\n ]\n \n [[package]]\n name = \"cranelift-codegen\"\n-version = \"0.91.0\"\n+version = \"0.92.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"e73470419b33011e50dbf0f6439cbccbaabe9381de172da4e1b6efcda4bb8fa7\"\n+checksum = \"2be1d5f2c3cca1efb691844bc1988b89c77291f13f778499a3f3c0cf49c0ed61\"\n dependencies = [\n  \"arrayvec\",\n  \"bumpalo\",\n  \"cranelift-bforest\",\n  \"cranelift-codegen-meta\",\n  \"cranelift-codegen-shared\",\n- \"cranelift-egraph\",\n  \"cranelift-entity\",\n  \"cranelift-isle\",\n  \"gimli\",\n+ \"hashbrown\",\n  \"log\",\n  \"regalloc2\",\n  \"smallvec\",\n@@ -87,44 +87,30 @@ dependencies = [\n \n [[package]]\n name = \"cranelift-codegen-meta\"\n-version = \"0.91.0\"\n+version = \"0.92.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"911a1872464108a11ac9965c2b079e61bbdf1bc2e0b9001264264add2e12a38f\"\n+checksum = \"3f9b1b1089750ce4005893af7ee00bb08a2cf1c9779999c0f7164cbc8ad2e0d2\"\n dependencies = [\n  \"cranelift-codegen-shared\",\n ]\n \n [[package]]\n name = \"cranelift-codegen-shared\"\n-version = \"0.91.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"e036f3f07adb24a86fb46e977e8fe03b18bb16b1eada949cf2c48283e5f8a862\"\n-\n-[[package]]\n-name = \"cranelift-egraph\"\n-version = \"0.91.0\"\n+version = \"0.92.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"2d6c623f4b5d2a6bad32c403f03765d4484a827eb93ee78f8cb6219ef118fd59\"\n-dependencies = [\n- \"cranelift-entity\",\n- \"fxhash\",\n- \"hashbrown\",\n- \"indexmap\",\n- \"log\",\n- \"smallvec\",\n-]\n+checksum = \"cc5fbaec51de47297fd7304986fd53c8c0030abbe69728a60d72e1c63559318d\"\n \n [[package]]\n name = \"cranelift-entity\"\n-version = \"0.91.0\"\n+version = \"0.92.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"74385eb5e405b3562f0caa7bcc4ab9a93c7958dd5bcd0e910bffb7765eacd6fc\"\n+checksum = \"dab984c94593f876090fae92e984bdcc74d9b1acf740ab5f79036001c65cba13\"\n \n [[package]]\n name = \"cranelift-frontend\"\n-version = \"0.91.0\"\n+version = \"0.92.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"8a4ac920422ee36bff2c66257fec861765e3d95a125cdf58d8c0f3bba7e40e61\"\n+checksum = \"6e0cb3102d21a2fe5f3210af608748ddd0cd09825ac12d42dc56ed5ed8725fe0\"\n dependencies = [\n  \"cranelift-codegen\",\n  \"log\",\n@@ -134,15 +120,15 @@ dependencies = [\n \n [[package]]\n name = \"cranelift-isle\"\n-version = \"0.91.0\"\n+version = \"0.92.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"c541263fb37ad2baa53ec8c37218ee5d02fa0984670d9419dedd8002ea68ff08\"\n+checksum = \"72101dd1f441d629735143c41e00b3428f9267738176983ef588ff43382af0a0\"\n \n [[package]]\n name = \"cranelift-jit\"\n-version = \"0.91.0\"\n+version = \"0.92.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"48a844e3500d313b69f3eec4b4e15bf9cdbd529756add06a468e0e281c0f6bee\"\n+checksum = \"6557f8ce44d498777f2495aa58d9692a4a37d6f84aa445750d666cef770b6a5c\"\n dependencies = [\n  \"anyhow\",\n  \"cranelift-codegen\",\n@@ -159,19 +145,19 @@ dependencies = [\n \n [[package]]\n name = \"cranelift-module\"\n-version = \"0.91.0\"\n+version = \"0.92.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"0699ea5fc6ca943456ba80ad49f80212bd6e2b846b992ec59f0f2b912a1d25fa\"\n+checksum = \"88807e1c0c47ec02fe433333ccbe56b480425418b1470e333205e11650697d72\"\n dependencies = [\n  \"anyhow\",\n  \"cranelift-codegen\",\n ]\n \n [[package]]\n name = \"cranelift-native\"\n-version = \"0.91.0\"\n+version = \"0.92.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"1de5d7a063e8563d670aaca38de16591a9b70dc66cbad4d49a7b4ae8395fd1ce\"\n+checksum = \"c22b0d9fcbe3fc5a1af9e7021b44ce42b930bcefac446ce22e02e8f9a0d67120\"\n dependencies = [\n  \"cranelift-codegen\",\n  \"libc\",\n@@ -180,9 +166,9 @@ dependencies = [\n \n [[package]]\n name = \"cranelift-object\"\n-version = \"0.91.0\"\n+version = \"0.92.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"307735148f6a556388aabf1ea31f46ccd378ed0739f3e9bdda2029639d701ab7\"\n+checksum = \"341375758d7c3fedc0b5315f552e6f0feac46baf87c450a15e9455ef47c2b261\"\n dependencies = [\n  \"anyhow\",\n  \"cranelift-codegen\",\n@@ -396,9 +382,9 @@ checksum = \"9c8d87e72b64a3b4db28d11ce29237c246188f4f51057d65a7eab63b7987e423\"\n \n [[package]]\n name = \"wasmtime-jit-icache-coherence\"\n-version = \"3.0.0\"\n+version = \"5.0.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"22d9c2e92b0fc124d2cad6cb497a4c840580a7dd2414a37109e8c7cfe699c0ea\"\n+checksum = \"08fcba5ebd96da2a9f0747ab6337fe9788adfb3f63fa2c180520d665562d257e\"\n dependencies = [\n  \"cfg-if\",\n  \"libc\","}, {"sha": "eadb4438bc992749ef0c274cec58f52497071e0f", "filename": "Cargo.toml", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/598f0909568a51de8a2d1148f55a644fd8dffad0/Cargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/598f0909568a51de8a2d1148f55a644fd8dffad0/Cargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.toml?ref=598f0909568a51de8a2d1148f55a644fd8dffad0", "patch": "@@ -15,12 +15,12 @@ crate-type = [\"dylib\"]\n \n [dependencies]\n # These have to be in sync with each other\n-cranelift-codegen = { version = \"0.91\", features = [\"unwind\", \"all-arch\"] }\n-cranelift-frontend = \"0.91\"\n-cranelift-module = \"0.91\"\n-cranelift-native = \"0.91\"\n-cranelift-jit = { version = \"0.91\", optional = true }\n-cranelift-object = \"0.91\"\n+cranelift-codegen = { version = \"0.92\", features = [\"unwind\", \"all-arch\"] }\n+cranelift-frontend = { version = \"0.92\" }\n+cranelift-module = { version = \"0.92\" }\n+cranelift-native = { version = \"0.92\" }\n+cranelift-jit = { version = \"0.92\", optional = true }\n+cranelift-object = { version = \"0.92\" }\n target-lexicon = \"0.12.0\"\n gimli = { version = \"0.26.0\", default-features = false, features = [\"write\"]}\n object = { version = \"0.29.0\", default-features = false, features = [\"std\", \"read_core\", \"write\", \"archive\", \"coff\", \"elf\", \"macho\", \"pe\"] }"}, {"sha": "26327dca299b930da6a973b0683915c4634c78ae", "filename": "src/optimize/peephole.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/598f0909568a51de8a2d1148f55a644fd8dffad0/src%2Foptimize%2Fpeephole.rs", "raw_url": "https://github.com/rust-lang/rust/raw/598f0909568a51de8a2d1148f55a644fd8dffad0/src%2Foptimize%2Fpeephole.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Foptimize%2Fpeephole.rs?ref=598f0909568a51de8a2d1148f55a644fd8dffad0", "patch": "@@ -7,7 +7,7 @@ use cranelift_frontend::FunctionBuilder;\n /// otherwise return the given value and false.\n pub(crate) fn maybe_unwrap_bool_not(bcx: &mut FunctionBuilder<'_>, arg: Value) -> (Value, bool) {\n     if let ValueDef::Result(arg_inst, 0) = bcx.func.dfg.value_def(arg) {\n-        match bcx.func.dfg[arg_inst] {\n+        match bcx.func.dfg.insts[arg_inst] {\n             // This is the lowering of `Rvalue::Not`\n             InstructionData::IntCompareImm {\n                 opcode: Opcode::IcmpImm,\n@@ -34,7 +34,7 @@ pub(crate) fn maybe_known_branch_taken(\n         return None;\n     };\n \n-    match bcx.func.dfg[arg_inst] {\n+    match bcx.func.dfg.insts[arg_inst] {\n         InstructionData::UnaryImm { opcode: Opcode::Iconst, imm } => {\n             if test_zero {\n                 Some(imm.bits() == 0)"}]}