{"sha": "a72a6ec897e1b8d7e125be9bb4b60d89c79aa4c0", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE3MmE2ZWM4OTdlMWI4ZDdlMTI1YmU5YmI0YjYwZDg5Yzc5YWE0YzA=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-04-29T00:32:00Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-04-29T00:32:00Z"}, "message": "auto merge of #13830 : noamraph/rust/doc-browser-history, r=kballard\n\nCurrently, in both chrome and firefox, if I type something in the search box in the reference docs I get immediately the search results. That's great. However, if I want to go back to the doc I was reading and try to press the back button, I am immediately forwarded again to the search results. This is caused by the fact that the search term is (deliberately) left in the search box, and the search() function is called as if I typed the search term again.\r\nI disabled calling the search() function if there's no search term in the URL, and now it seems to work fine.\r\n\r\nI hope I'm sending the pull request correctly - I'm not really used to git and github.", "tree": {"sha": "de1e8088d4ecfb6884823e5f141eb966871213ad", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/de1e8088d4ecfb6884823e5f141eb966871213ad"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a72a6ec897e1b8d7e125be9bb4b60d89c79aa4c0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a72a6ec897e1b8d7e125be9bb4b60d89c79aa4c0", "html_url": "https://github.com/rust-lang/rust/commit/a72a6ec897e1b8d7e125be9bb4b60d89c79aa4c0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a72a6ec897e1b8d7e125be9bb4b60d89c79aa4c0/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3cd6c1e008ac0696cedf6be68a4fa9d7b16550bf", "url": "https://api.github.com/repos/rust-lang/rust/commits/3cd6c1e008ac0696cedf6be68a4fa9d7b16550bf", "html_url": "https://github.com/rust-lang/rust/commit/3cd6c1e008ac0696cedf6be68a4fa9d7b16550bf"}, {"sha": "5b2e4776296a23cc6429838e8ba47c3d42513004", "url": "https://api.github.com/repos/rust-lang/rust/commits/5b2e4776296a23cc6429838e8ba47c3d42513004", "html_url": "https://github.com/rust-lang/rust/commit/5b2e4776296a23cc6429838e8ba47c3d42513004"}], "stats": {"total": 9, "additions": 4, "deletions": 5}, "files": [{"sha": "21d57a17c6788edd1a25dc1ce156fbd3f9b7795a", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/a72a6ec897e1b8d7e125be9bb4b60d89c79aa4c0/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/a72a6ec897e1b8d7e125be9bb4b60d89c79aa4c0/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=a72a6ec897e1b8d7e125be9bb4b60d89c79aa4c0", "patch": "@@ -605,11 +605,10 @@\n                     // cleared to ensure the search is successful.\n                     currentResults = null;\n                     // Synchronize search bar with query string state and\n-                    // perform the search, but don't empty the bar if there's\n-                    // nothing there.\n-                    if (params.search !== undefined) {\n-                        $('.search-input').val(params.search);\n-                    }\n+                    // perform the search. This will empty the bar if there's\n+                    // nothing there, which lets you really go back to a\n+                    // previous state with nothing in the bar.\n+                    $('.search-input').val(params.search);\n                     // Some browsers fire 'onpopstate' for every page load\n                     // (Chrome), while others fire the event only when actually\n                     // popping a state (Firefox), which is why search() is"}]}