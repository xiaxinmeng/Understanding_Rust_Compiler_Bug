{"sha": "1b41d7be1ab43594982361f58e49e2d399ccbfb4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFiNDFkN2JlMWFiNDM1OTQ5ODIzNjFmNThlNDllMmQzOTljY2JmYjQ=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2010-07-26T19:30:43Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2010-07-26T19:30:43Z"}, "message": "Change ctxt_crate_main to an Ast.name.", "tree": {"sha": "0fc53e4cd049235a6e0179547fafb29b41f74fd5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0fc53e4cd049235a6e0179547fafb29b41f74fd5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1b41d7be1ab43594982361f58e49e2d399ccbfb4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1b41d7be1ab43594982361f58e49e2d399ccbfb4", "html_url": "https://github.com/rust-lang/rust/commit/1b41d7be1ab43594982361f58e49e2d399ccbfb4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1b41d7be1ab43594982361f58e49e2d399ccbfb4/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "025b1e4133eb89e53cfb5b1e876917182b965418", "url": "https://api.github.com/repos/rust-lang/rust/commits/025b1e4133eb89e53cfb5b1e876917182b965418", "html_url": "https://github.com/rust-lang/rust/commit/025b1e4133eb89e53cfb5b1e876917182b965418"}], "stats": {"total": 15, "additions": 7, "deletions": 8}, "files": [{"sha": "5a3bb5d1698121a1cebdc126f6abc367e629763b", "filename": "src/boot/me/semant.ml", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/1b41d7be1ab43594982361f58e49e2d399ccbfb4/src%2Fboot%2Fme%2Fsemant.ml", "raw_url": "https://github.com/rust-lang/rust/raw/1b41d7be1ab43594982361f58e49e2d399ccbfb4/src%2Fboot%2Fme%2Fsemant.ml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fboot%2Fme%2Fsemant.ml?ref=1b41d7be1ab43594982361f58e49e2d399ccbfb4", "patch": "@@ -169,7 +169,7 @@ type ctxt =\n       ctxt_required_lib_num: (required_lib, int) Hashtbl.t;\n \n       ctxt_main_fn_fixup: fixup option;\n-      ctxt_main_name: string option;\n+      ctxt_main_name: Ast.name option;\n     }\n ;;\n \n@@ -254,10 +254,7 @@ let new_ctxt sess abi crate =\n            None -> None\n          | Some n -> Some (new_fixup (string_of_name n)));\n \n-    ctxt_main_name =\n-      (match crate.Ast.crate_main with\n-           None -> None\n-         | Some n -> Some (string_of_name n));\n+    ctxt_main_name = crate.Ast.crate_main;\n   }\n ;;\n "}, {"sha": "4bf974b2c843a994c2cff60d80aeab2adacc3593", "filename": "src/boot/me/trans.ml", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1b41d7be1ab43594982361f58e49e2d399ccbfb4/src%2Fboot%2Fme%2Ftrans.ml", "raw_url": "https://github.com/rust-lang/rust/raw/1b41d7be1ab43594982361f58e49e2d399ccbfb4/src%2Fboot%2Fme%2Ftrans.ml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fboot%2Fme%2Ftrans.ml?ref=1b41d7be1ab43594982361f58e49e2d399ccbfb4", "patch": "@@ -5313,7 +5313,7 @@ let fixup_assigning_visitor\n \n         | Ast.MOD_ITEM_fn _ ->\n             begin\n-              let path = path_name () in\n+              let path = path_to_name path in\n               let fixup =\n                 if (not cx.ctxt_sess.Session.sess_library_mode)\n                   && (Some path) = cx.ctxt_main_name\n@@ -5322,7 +5322,7 @@ let fixup_assigning_visitor\n                       None -> bug () \"missing main fixup in trans\"\n                     | Some fix -> fix\n                 else\n-                  new_fixup path\n+                  new_fixup (path_name())\n               in\n                 htab_put cx.ctxt_fn_fixups i.id fixup;\n             end\n@@ -5390,7 +5390,9 @@ let process_crate\n     begin\n       match cx.ctxt_main_name with\n           None -> ()\n-        | Some m -> log cx \"with main fn %s\" m\n+        | Some m ->\n+            log cx \"with main fn %a\"\n+              Ast.sprintf_name m\n     end;\n     run_passes cx \"trans\" path passes\n       cx.ctxt_sess.Session.sess_log_trans log crate;"}]}