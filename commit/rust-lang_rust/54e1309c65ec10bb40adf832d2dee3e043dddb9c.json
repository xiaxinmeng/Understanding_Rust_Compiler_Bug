{"sha": "54e1309c65ec10bb40adf832d2dee3e043dddb9c", "node_id": "C_kwDOAAsO6NoAKDU0ZTEzMDljNjVlYzEwYmI0MGFkZjgzMmQyZGVlM2UwNDNkZGRiOWM", "commit": {"author": {"name": "Nilstrieb", "email": "48135649+Nilstrieb@users.noreply.github.com", "date": "2023-04-09T19:53:03Z"}, "committer": {"name": "Nilstrieb", "email": "48135649+Nilstrieb@users.noreply.github.com", "date": "2023-04-09T19:59:28Z"}, "message": "Use HashMap entry APIs more", "tree": {"sha": "f61c5b976450f60ac39ea62dabee96fc4538cf52", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f61c5b976450f60ac39ea62dabee96fc4538cf52"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/54e1309c65ec10bb40adf832d2dee3e043dddb9c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/54e1309c65ec10bb40adf832d2dee3e043dddb9c", "html_url": "https://github.com/rust-lang/rust/commit/54e1309c65ec10bb40adf832d2dee3e043dddb9c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/54e1309c65ec10bb40adf832d2dee3e043dddb9c/comments", "author": {"login": "Nilstrieb", "id": 48135649, "node_id": "MDQ6VXNlcjQ4MTM1NjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/48135649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nilstrieb", "html_url": "https://github.com/Nilstrieb", "followers_url": "https://api.github.com/users/Nilstrieb/followers", "following_url": "https://api.github.com/users/Nilstrieb/following{/other_user}", "gists_url": "https://api.github.com/users/Nilstrieb/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nilstrieb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nilstrieb/subscriptions", "organizations_url": "https://api.github.com/users/Nilstrieb/orgs", "repos_url": "https://api.github.com/users/Nilstrieb/repos", "events_url": "https://api.github.com/users/Nilstrieb/events{/privacy}", "received_events_url": "https://api.github.com/users/Nilstrieb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Nilstrieb", "id": 48135649, "node_id": "MDQ6VXNlcjQ4MTM1NjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/48135649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nilstrieb", "html_url": "https://github.com/Nilstrieb", "followers_url": "https://api.github.com/users/Nilstrieb/followers", "following_url": "https://api.github.com/users/Nilstrieb/following{/other_user}", "gists_url": "https://api.github.com/users/Nilstrieb/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nilstrieb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nilstrieb/subscriptions", "organizations_url": "https://api.github.com/users/Nilstrieb/orgs", "repos_url": "https://api.github.com/users/Nilstrieb/repos", "events_url": "https://api.github.com/users/Nilstrieb/events{/privacy}", "received_events_url": "https://api.github.com/users/Nilstrieb/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f058d05fc20a19c46a8253eec15faa2636ea1135", "url": "https://api.github.com/repos/rust-lang/rust/commits/f058d05fc20a19c46a8253eec15faa2636ea1135", "html_url": "https://github.com/rust-lang/rust/commit/f058d05fc20a19c46a8253eec15faa2636ea1135"}], "stats": {"total": 17, "additions": 9, "deletions": 8}, "files": [{"sha": "3e9a9ce1b31147c02a36631834cc7dc7635b243a", "filename": "compiler/rustc_hir_typeck/src/generator_interior/drop_ranges/cfg_build.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/54e1309c65ec10bb40adf832d2dee3e043dddb9c/compiler%2Frustc_hir_typeck%2Fsrc%2Fgenerator_interior%2Fdrop_ranges%2Fcfg_build.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54e1309c65ec10bb40adf832d2dee3e043dddb9c/compiler%2Frustc_hir_typeck%2Fsrc%2Fgenerator_interior%2Fdrop_ranges%2Fcfg_build.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_typeck%2Fsrc%2Fgenerator_interior%2Fdrop_ranges%2Fcfg_build.rs?ref=54e1309c65ec10bb40adf832d2dee3e043dddb9c", "patch": "@@ -526,8 +526,9 @@ impl DropRangesBuilder {\n         let mut next = <_>::from(0u32);\n         for value in tracked_values {\n             for_each_consumable(hir, value, |value| {\n-                if !tracked_value_map.contains_key(&value) {\n-                    tracked_value_map.insert(value, next);\n+                if let std::collections::hash_map::Entry::Vacant(e) = tracked_value_map.entry(value)\n+                {\n+                    e.insert(next);\n                     next = next + 1;\n                 }\n             });"}, {"sha": "a2a7c93a7ca957428f50531e84b55364c8779548", "filename": "compiler/rustc_lint/src/levels.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/54e1309c65ec10bb40adf832d2dee3e043dddb9c/compiler%2Frustc_lint%2Fsrc%2Flevels.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54e1309c65ec10bb40adf832d2dee3e043dddb9c/compiler%2Frustc_lint%2Fsrc%2Flevels.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Flevels.rs?ref=54e1309c65ec10bb40adf832d2dee3e043dddb9c", "patch": "@@ -266,12 +266,12 @@ impl LintLevelsProvider for QueryMapExpectationsWrapper<'_> {\n         let LintExpectationId::Stable { attr_id: Some(attr_id), hir_id, attr_index, .. } = id else { bug!(\"unstable expectation id should already be mapped\") };\n         let key = LintExpectationId::Unstable { attr_id, lint_index: None };\n \n-        if !self.unstable_to_stable_ids.contains_key(&key) {\n-            self.unstable_to_stable_ids.insert(\n-                key,\n-                LintExpectationId::Stable { hir_id, attr_index, lint_index: None, attr_id: None },\n-            );\n-        }\n+        self.unstable_to_stable_ids.entry(key).or_insert(LintExpectationId::Stable {\n+            hir_id,\n+            attr_index,\n+            lint_index: None,\n+            attr_id: None,\n+        });\n \n         self.expectations.push((id.normalize(), expectation));\n     }"}]}