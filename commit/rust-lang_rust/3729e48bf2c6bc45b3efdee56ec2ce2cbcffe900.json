{"sha": "3729e48bf2c6bc45b3efdee56ec2ce2cbcffe900", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM3MjllNDhiZjJjNmJjNDViM2VmZGVlNTZlYzJjZTJjYmNmZmU5MDA=", "commit": {"author": {"name": "Jonathan Sieber", "email": "mail@strfry.org", "date": "2018-10-18T19:47:26Z"}, "committer": {"name": "Mateusz Miku\u0142a", "email": "mati865@gmail.com", "date": "2019-03-13T21:21:06Z"}, "message": "Set RUSTFLAGS env to make dylib work\n\nThe musl-target doesn't automatically disable static linking of musl when building a dylib, and then complains it can't build a dylib.\r\nAs a workaround, disable static linking via RUSTFLAGS, to see how far the build gets.\r\nThe proper fix is to have rustc figure that out automagically.", "tree": {"sha": "f8e8aa0e75eec0f02f5a7e5202c9c8a5906acdd2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f8e8aa0e75eec0f02f5a7e5202c9c8a5906acdd2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3729e48bf2c6bc45b3efdee56ec2ce2cbcffe900", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3729e48bf2c6bc45b3efdee56ec2ce2cbcffe900", "html_url": "https://github.com/rust-lang/rust/commit/3729e48bf2c6bc45b3efdee56ec2ce2cbcffe900", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3729e48bf2c6bc45b3efdee56ec2ce2cbcffe900/comments", "author": {"login": "strfry", "id": 1341440, "node_id": "MDQ6VXNlcjEzNDE0NDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1341440?v=4", "gravatar_id": "", "url": "https://api.github.com/users/strfry", "html_url": "https://github.com/strfry", "followers_url": "https://api.github.com/users/strfry/followers", "following_url": "https://api.github.com/users/strfry/following{/other_user}", "gists_url": "https://api.github.com/users/strfry/gists{/gist_id}", "starred_url": "https://api.github.com/users/strfry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/strfry/subscriptions", "organizations_url": "https://api.github.com/users/strfry/orgs", "repos_url": "https://api.github.com/users/strfry/repos", "events_url": "https://api.github.com/users/strfry/events{/privacy}", "received_events_url": "https://api.github.com/users/strfry/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mati865", "id": 1174646, "node_id": "MDQ6VXNlcjExNzQ2NDY=", "avatar_url": "https://avatars.githubusercontent.com/u/1174646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mati865", "html_url": "https://github.com/mati865", "followers_url": "https://api.github.com/users/mati865/followers", "following_url": "https://api.github.com/users/mati865/following{/other_user}", "gists_url": "https://api.github.com/users/mati865/gists{/gist_id}", "starred_url": "https://api.github.com/users/mati865/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mati865/subscriptions", "organizations_url": "https://api.github.com/users/mati865/orgs", "repos_url": "https://api.github.com/users/mati865/repos", "events_url": "https://api.github.com/users/mati865/events{/privacy}", "received_events_url": "https://api.github.com/users/mati865/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "880b041f3cfc03443d4b4723f0b0cba565ee6177", "url": "https://api.github.com/repos/rust-lang/rust/commits/880b041f3cfc03443d4b4723f0b0cba565ee6177", "html_url": "https://github.com/rust-lang/rust/commit/880b041f3cfc03443d4b4723f0b0cba565ee6177"}], "stats": {"total": 2, "additions": 2, "deletions": 0}, "files": [{"sha": "441c2e7c57a075ccd82c89b60169f0c41f54a22d", "filename": "src/ci/docker/dist-x86_64-musl/Dockerfile", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3729e48bf2c6bc45b3efdee56ec2ce2cbcffe900/src%2Fci%2Fdocker%2Fdist-x86_64-musl%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/3729e48bf2c6bc45b3efdee56ec2ce2cbcffe900/src%2Fci%2Fdocker%2Fdist-x86_64-musl%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-x86_64-musl%2FDockerfile?ref=3729e48bf2c6bc45b3efdee56ec2ce2cbcffe900", "patch": "@@ -43,6 +43,8 @@ ENV CFLAGS_x86_64_unknown_linux_musl=-Wa,-mrelax-relocations=no\n \n ENV HOSTS=x86_64-unknown-linux-musl\n \n+ENV RUSTFLAGS=\"-C target-feature=-crt-static\"\n+\n ENV SCRIPT \\\n       python2.7 ../x.py test --host $HOSTS --target $HOSTS && \\\n       python2.7 ../x.py dist --host $HOSTS --target $HOSTS"}]}