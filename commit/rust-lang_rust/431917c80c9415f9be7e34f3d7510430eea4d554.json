{"sha": "431917c80c9415f9be7e34f3d7510430eea4d554", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQzMTkxN2M4MGM5NDE1ZjliZTdlMzRmM2Q3NTEwNDMwZWVhNGQ1NTQ=", "commit": {"author": {"name": "Oliver Schneider", "email": "oli-obk@users.noreply.github.com", "date": "2018-05-09T11:47:41Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-05-09T11:47:41Z"}, "message": "Merge pull request #2737 from flip1995/escaped_squigglies\n\npanic_params: don't lint escaped squigglies", "tree": {"sha": "c6d2e0adbdce9b705e859b354025ad3af3e0ec5d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c6d2e0adbdce9b705e859b354025ad3af3e0ec5d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/431917c80c9415f9be7e34f3d7510430eea4d554", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJa8t/dCRBK7hj4Ov3rIwAAdHIIAEG8WDQGxl6X8yAsbBm9vDhd\n1TQCk0KmJH1Ab1AGlYnLThNidYYC+PupNi+D8fHW35KpSz47OqkOKrjkmdUvqoks\nRpPnWMJqPLazAuC0wX1aJ12G423vi9IQRxE+0DP36ZbGV04IS53+bD/BRqFgrC8Q\nTLpBbalisZdYvWkFVlbYMDiKFaFLAO7BR8nAq9g7DatugEc6GW8ZLXSmjKfwXN8Q\ntcc7tlhGIIAqmiMe4jNRz4+hJOw3CU1i1piE/fmDzjpBjqTQeEH6qrT/iMq7bkkN\neFcor21GIlzseIPonWyuAYLEk1/YlB9ayC9Epv0at4soml4sGtuE97r0804jpl8=\n=jeM5\n-----END PGP SIGNATURE-----\n", "payload": "tree c6d2e0adbdce9b705e859b354025ad3af3e0ec5d\nparent ad438b30de49fcd238e771e936994543648ffc6a\nparent db4e7ac725689c3006a2817f373fb6ce9e64d29f\nauthor Oliver Schneider <oli-obk@users.noreply.github.com> 1525866461 +0200\ncommitter GitHub <noreply@github.com> 1525866461 +0200\n\nMerge pull request #2737 from flip1995/escaped_squigglies\n\npanic_params: don't lint escaped squigglies "}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/431917c80c9415f9be7e34f3d7510430eea4d554", "html_url": "https://github.com/rust-lang/rust/commit/431917c80c9415f9be7e34f3d7510430eea4d554", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/431917c80c9415f9be7e34f3d7510430eea4d554/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ad438b30de49fcd238e771e936994543648ffc6a", "url": "https://api.github.com/repos/rust-lang/rust/commits/ad438b30de49fcd238e771e936994543648ffc6a", "html_url": "https://github.com/rust-lang/rust/commit/ad438b30de49fcd238e771e936994543648ffc6a"}, {"sha": "db4e7ac725689c3006a2817f373fb6ce9e64d29f", "url": "https://api.github.com/repos/rust-lang/rust/commits/db4e7ac725689c3006a2817f373fb6ce9e64d29f", "html_url": "https://github.com/rust-lang/rust/commit/db4e7ac725689c3006a2817f373fb6ce9e64d29f"}], "stats": {"total": 29, "additions": 24, "deletions": 5}, "files": [{"sha": "a6691db8678c76b7248b9c1a9665d0111e862ff1", "filename": "clippy_lints/src/panic.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/431917c80c9415f9be7e34f3d7510430eea4d554/clippy_lints%2Fsrc%2Fpanic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/431917c80c9415f9be7e34f3d7510430eea4d554/clippy_lints%2Fsrc%2Fpanic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fpanic.rs?ref=431917c80c9415f9be7e34f3d7510430eea4d554", "patch": "@@ -10,8 +10,7 @@ use utils::{is_direct_expn_of, match_def_path, opt_def_id, paths, resolve_node,\n /// is not a format string and used literally. So while `format!(\"{}\")` will\n /// fail to compile, `panic!(\"{}\")` will not.\n ///\n-/// **Known problems:** Should you want to use curly brackets in `panic!`\n-/// without any parameter, this lint will warn.\n+/// **Known problems:** None.\n ///\n /// **Example:**\n /// ```rust\n@@ -45,8 +44,9 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for Pass {\n             if let ExprLit(ref lit) = params[0].node;\n             if is_direct_expn_of(expr.span, \"panic\").is_some();\n             if let LitKind::Str(ref string, _) = lit.node;\n-            if let Some(par) = string.as_str().find('{');\n-            if string.as_str()[par..].contains('}');\n+            let string = string.as_str().replace(\"{{\", \"\").replace(\"}}\", \"\");\n+            if let Some(par) = string.find('{');\n+            if string[par..].contains('}');\n             if params[0].span.source_callee().is_none();\n             if params[0].span.lo() != params[0].span.hi();\n             then {"}, {"sha": "d833d2651a5975bc5c7713924eeaf7504ef698d8", "filename": "tests/ui/panic.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/431917c80c9415f9be7e34f3d7510430eea4d554/tests%2Fui%2Fpanic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/431917c80c9415f9be7e34f3d7510430eea4d554/tests%2Fui%2Fpanic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fpanic.rs?ref=431917c80c9415f9be7e34f3d7510430eea4d554", "patch": "@@ -11,6 +11,8 @@ fn missing() {\n     } else {\n         assert!(true, \"here be missing values: {}\");\n     }\n+\n+    panic!(\"{{{this}}}\");\n }\n \n fn ok_single() {\n@@ -41,11 +43,22 @@ fn ok_nomsg() {\n     assert!(if 1 == ONE { ONE == 1 } else { false });\n }\n \n+fn ok_escaped() {\n+    panic!(\"{{ why should this not be ok? }}\");\n+    panic!(\" or {{ that ?\");\n+    panic!(\" or }} this ?\");\n+    panic!(\" {or {{ that ?\");\n+    panic!(\" }or }} this ?\");\n+    panic!(\"{{ test }\");\n+    panic!(\"{case }}\");\n+}\n+\n fn main() {\n     missing();\n     ok_single();\n     ok_multiple();\n     ok_bracket();\n     ok_inner();\n     ok_nomsg();\n+    ok_escaped();\n }"}, {"sha": "165c33cacb7da49a6301905f2ba73d4ae8b44887", "filename": "tests/ui/panic.stderr", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/431917c80c9415f9be7e34f3d7510430eea4d554/tests%2Fui%2Fpanic.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/431917c80c9415f9be7e34f3d7510430eea4d554/tests%2Fui%2Fpanic.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fpanic.stderr?ref=431917c80c9415f9be7e34f3d7510430eea4d554", "patch": "@@ -18,5 +18,11 @@ error: you probably are missing some parameter in your format string\n 12 |         assert!(true, \"here be missing values: {}\");\n    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: aborting due to 3 previous errors\n+error: you probably are missing some parameter in your format string\n+  --> $DIR/panic.rs:15:12\n+   |\n+15 |     panic!(\"{{{this}}}\");\n+   |            ^^^^^^^^^^^^\n+\n+error: aborting due to 4 previous errors\n "}]}