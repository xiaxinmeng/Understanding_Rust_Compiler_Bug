{"sha": "79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc5YzVmYTFmMGM3MTNiZjMyMTRkMjkxMWMyZTczYmIzOGRmM2EwYzU=", "commit": {"author": {"name": "Erin Power", "email": "erin.power@embark-studios.com", "date": "2021-03-02T08:41:41Z"}, "committer": {"name": "Erin Power", "email": "erin.power@embark-studios.com", "date": "2021-03-02T08:41:41Z"}, "message": "Revert non-power-of-two vector restriction", "tree": {"sha": "fcf74f0e62154e8f810ad9e6b92408a43cfb8792", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fcf74f0e62154e8f810ad9e6b92408a43cfb8792"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5", "html_url": "https://github.com/rust-lang/rust/commit/79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5/comments", "author": {"login": "XAMPPRocky", "id": 4464295, "node_id": "MDQ6VXNlcjQ0NjQyOTU=", "avatar_url": "https://avatars.githubusercontent.com/u/4464295?v=4", "gravatar_id": "", "url": "https://api.github.com/users/XAMPPRocky", "html_url": "https://github.com/XAMPPRocky", "followers_url": "https://api.github.com/users/XAMPPRocky/followers", "following_url": "https://api.github.com/users/XAMPPRocky/following{/other_user}", "gists_url": "https://api.github.com/users/XAMPPRocky/gists{/gist_id}", "starred_url": "https://api.github.com/users/XAMPPRocky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/XAMPPRocky/subscriptions", "organizations_url": "https://api.github.com/users/XAMPPRocky/orgs", "repos_url": "https://api.github.com/users/XAMPPRocky/repos", "events_url": "https://api.github.com/users/XAMPPRocky/events{/privacy}", "received_events_url": "https://api.github.com/users/XAMPPRocky/received_events", "type": "User", "site_admin": false}, "committer": {"login": "XAMPPRocky", "id": 4464295, "node_id": "MDQ6VXNlcjQ0NjQyOTU=", "avatar_url": "https://avatars.githubusercontent.com/u/4464295?v=4", "gravatar_id": "", "url": "https://api.github.com/users/XAMPPRocky", "html_url": "https://github.com/XAMPPRocky", "followers_url": "https://api.github.com/users/XAMPPRocky/followers", "following_url": "https://api.github.com/users/XAMPPRocky/following{/other_user}", "gists_url": "https://api.github.com/users/XAMPPRocky/gists{/gist_id}", "starred_url": "https://api.github.com/users/XAMPPRocky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/XAMPPRocky/subscriptions", "organizations_url": "https://api.github.com/users/XAMPPRocky/orgs", "repos_url": "https://api.github.com/users/XAMPPRocky/repos", "events_url": "https://api.github.com/users/XAMPPRocky/events{/privacy}", "received_events_url": "https://api.github.com/users/XAMPPRocky/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4f20caa6258d4c74ce6b316fd347e3efe81cf557", "url": "https://api.github.com/repos/rust-lang/rust/commits/4f20caa6258d4c74ce6b316fd347e3efe81cf557", "html_url": "https://github.com/rust-lang/rust/commit/4f20caa6258d4c74ce6b316fd347e3efe81cf557"}], "stats": {"total": 42, "additions": 2, "deletions": 40}, "files": [{"sha": "6d2ab0e5f5a80ac8bdd5829b6aa0b392e866e963", "filename": "compiler/rustc_middle/src/ty/layout.rs", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5/compiler%2Frustc_middle%2Fsrc%2Fty%2Flayout.rs", "raw_url": "https://github.com/rust-lang/rust/raw/79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5/compiler%2Frustc_middle%2Fsrc%2Fty%2Flayout.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Flayout.rs?ref=79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5", "patch": "@@ -732,11 +732,6 @@ impl<'tcx> LayoutCx<'tcx, TyCtxt<'tcx>> {\n                 // Can't be caught in typeck if the array length is generic.\n                 if e_len == 0 {\n                     tcx.sess.fatal(&format!(\"monomorphising SIMD type `{}` of zero length\", ty));\n-                } else if !e_len.is_power_of_two() {\n-                    tcx.sess.fatal(&format!(\n-                        \"monomorphising SIMD type `{}` of non-power-of-two length\",\n-                        ty\n-                    ));\n                 } else if e_len > MAX_SIMD_LANES {\n                     tcx.sess.fatal(&format!(\n                         \"monomorphising SIMD type `{}` of length greater than {}\","}, {"sha": "8d70dacdc90104a7aa180e2fd7cce7038e10e003", "filename": "src/test/ui/simd/issue-17170.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5/src%2Ftest%2Fui%2Fsimd%2Fissue-17170.rs", "raw_url": "https://github.com/rust-lang/rust/raw/79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5/src%2Ftest%2Fui%2Fsimd%2Fissue-17170.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsimd%2Fissue-17170.rs?ref=79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5", "patch": "@@ -1,8 +1,8 @@\n+// run-pass\n #![feature(repr_simd)]\n \n #[repr(simd)]\n struct T(f64, f64, f64);\n-//~^ ERROR SIMD vector length must be a power of two\n \n static X: T = T(0.0, 0.0, 0.0);\n "}, {"sha": "b35c3c4dc980d7ffcb076322f5b7b39f84b7f14b", "filename": "src/test/ui/simd/issue-17170.stderr", "status": "removed", "additions": 0, "deletions": 11, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/4f20caa6258d4c74ce6b316fd347e3efe81cf557/src%2Ftest%2Fui%2Fsimd%2Fissue-17170.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4f20caa6258d4c74ce6b316fd347e3efe81cf557/src%2Ftest%2Fui%2Fsimd%2Fissue-17170.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsimd%2Fissue-17170.stderr?ref=4f20caa6258d4c74ce6b316fd347e3efe81cf557", "patch": "@@ -1,11 +0,0 @@\n-error[E0075]: SIMD vector length must be a power of two\n-  --> $DIR/issue-17170.rs:4:1\n-   |\n-LL | struct T(f64, f64, f64);\n-   | ^^^^^^^^^^^^^^^^^^^^^^^^\n-\n-error: monomorphising SIMD type `T` of non-power-of-two length\n-\n-error: aborting due to 2 previous errors\n-\n-For more information about this error, try `rustc --explain E0075`."}, {"sha": "8cf841f9371215a254302992dcdbd3984431fb0c", "filename": "src/test/ui/simd/issue-39720.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5/src%2Ftest%2Fui%2Fsimd%2Fissue-39720.rs", "raw_url": "https://github.com/rust-lang/rust/raw/79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5/src%2Ftest%2Fui%2Fsimd%2Fissue-39720.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsimd%2Fissue-39720.rs?ref=79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5", "patch": "@@ -1,16 +1,15 @@\n+// run-pass\n // ignore-emscripten FIXME(#45351)\n \n #![feature(repr_simd, platform_intrinsics)]\n \n #[repr(simd)]\n #[derive(Copy, Clone, Debug)]\n pub struct Char3(pub i8, pub i8, pub i8);\n-//~^ ERROR SIMD vector length must be a power of two\n \n #[repr(simd)]\n #[derive(Copy, Clone, Debug)]\n pub struct Short3(pub i16, pub i16, pub i16);\n-//~^ ERROR SIMD vector length must be a power of two\n \n extern \"platform-intrinsic\" {\n     fn simd_cast<T, U>(x: T) -> U;"}, {"sha": "355ceff00508aa0d44e692d41314f5390216162e", "filename": "src/test/ui/simd/issue-39720.stderr", "status": "removed", "additions": 0, "deletions": 15, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/4f20caa6258d4c74ce6b316fd347e3efe81cf557/src%2Ftest%2Fui%2Fsimd%2Fissue-39720.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4f20caa6258d4c74ce6b316fd347e3efe81cf557/src%2Ftest%2Fui%2Fsimd%2Fissue-39720.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsimd%2Fissue-39720.stderr?ref=4f20caa6258d4c74ce6b316fd347e3efe81cf557", "patch": "@@ -1,15 +0,0 @@\n-error[E0075]: SIMD vector length must be a power of two\n-  --> $DIR/issue-39720.rs:7:1\n-   |\n-LL | pub struct Char3(pub i8, pub i8, pub i8);\n-   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-\n-error[E0075]: SIMD vector length must be a power of two\n-  --> $DIR/issue-39720.rs:12:1\n-   |\n-LL | pub struct Short3(pub i16, pub i16, pub i16);\n-   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-\n-error: aborting due to 2 previous errors\n-\n-For more information about this error, try `rustc --explain E0075`."}, {"sha": "00c953c5282e31e52f7fc38c121d69ad29b14063", "filename": "src/test/ui/simd/simd-type.stderr", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5/src%2Ftest%2Fui%2Fsimd%2Fsimd-type.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5/src%2Ftest%2Fui%2Fsimd%2Fsimd-type.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsimd%2Fsimd-type.stderr?ref=79c5fa1f0c713bf3214d2911c2e73bb38df3a0c5", "patch": "@@ -10,12 +10,6 @@ error[E0075]: SIMD vector cannot be empty\n LL | struct empty2([f32; 0]);\n    | ^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error[E0075]: SIMD vector length must be a power of two\n-  --> $DIR/simd-type.rs:13:1\n-   |\n-LL | struct pow2([f32; 7]);\n-   | ^^^^^^^^^^^^^^^^^^^^^^\n-\n error[E0076]: SIMD vector should be homogeneous\n   --> $DIR/simd-type.rs:16:1\n    |"}]}