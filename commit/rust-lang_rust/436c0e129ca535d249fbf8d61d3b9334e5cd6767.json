{"sha": "436c0e129ca535d249fbf8d61d3b9334e5cd6767", "node_id": "C_kwDOAAsO6NoAKDQzNmMwZTEyOWNhNTM1ZDI0OWZiZjhkNjFkM2I5MzM0ZTVjZDY3Njc", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2022-05-05T22:15:35Z"}, "committer": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2022-05-05T22:15:35Z"}, "message": "Fix an ICE on #96738", "tree": {"sha": "6118c9a264cc0f64455ba16713721174b046f90c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6118c9a264cc0f64455ba16713721174b046f90c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/436c0e129ca535d249fbf8d61d3b9334e5cd6767", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEClCZYSKPPkQPouAvN5zu/dY+XdcFAmJ0TIcACgkQN5zu/dY+\nXdc1PRAAkzE8kNjzqNojgJWRYTtbrhYolT1cjbJXQoGUJ+XaqlfZ0T2PUCALSb6t\ncRUSzpKWD2df4hKi6IFLHTT7xtQp2YLyWH3kkjUO4xV4aFY2lw/g1UjkFm0tfdV6\n9NgrAX0jB0/P4sHXuDSya66kg4GCQYgrdKQ79ks4QjILpGIOHjnwukGD3Wfo0EsD\nhaOznQA5GtJgNkV3+d0BShR0NiYvH2c2eNTn3Vlv/qNX00ZJ8abOeGyL+jpYC7Kz\nlhFq3ImzKfS2Ai17K8+vrw7rnbjQr9ZPVTbHSYk7xdW10FbsgcqLTI0upbBGdKik\na2J0eVcNzf7VZVm8LhpN4oHYs1MsIN0/eEefEitW7VWd1DXzMbLiaf22xuQFSgxS\nF6e+nmYoidf9QornwamPv2noMb+JPl9jJmgbivfV2sf/hPQ2SAXy1Ir5kVDHysc/\nb12mlZyJzDVgqlj3piRjIJC9tnfZtDJLUB8KSgcvwL+0GlmeHITUcaGIgFLvsAeR\nrgDeMVuBII/1OXn68Dj3zRwQDtfSDbAIPInQ32KNNNI4OfImmmqhZl+aBLkpCd6g\nR4dce4jQgNZO026ikHuJkOSyzYQketcDk4NjXh/anXelU3unZKkFu2SofFoUVRj5\n3OrghlSw+2Ue9h60EVUPysGB1dL4TOjD3IET+z1gv+7GaK8yO+c=\n=juoF\n-----END PGP SIGNATURE-----", "payload": "tree 6118c9a264cc0f64455ba16713721174b046f90c\nparent 30f386087564243ab88a93c984c265290a31580b\nauthor Yuki Okushi <jtitor@2k36.org> 1651788935 +0900\ncommitter Yuki Okushi <jtitor@2k36.org> 1651788935 +0900\n\nFix an ICE on #96738\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/436c0e129ca535d249fbf8d61d3b9334e5cd6767", "html_url": "https://github.com/rust-lang/rust/commit/436c0e129ca535d249fbf8d61d3b9334e5cd6767", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/436c0e129ca535d249fbf8d61d3b9334e5cd6767/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "30f386087564243ab88a93c984c265290a31580b", "url": "https://api.github.com/repos/rust-lang/rust/commits/30f386087564243ab88a93c984c265290a31580b", "html_url": "https://github.com/rust-lang/rust/commit/30f386087564243ab88a93c984c265290a31580b"}], "stats": {"total": 17, "additions": 15, "deletions": 2}, "files": [{"sha": "f36d2496673147017ba00ba772ac2c653258b54e", "filename": "compiler/rustc_typeck/src/check/method/suggest.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/436c0e129ca535d249fbf8d61d3b9334e5cd6767/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fsuggest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/436c0e129ca535d249fbf8d61d3b9334e5cd6767/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fsuggest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fsuggest.rs?ref=436c0e129ca535d249fbf8d61d3b9334e5cd6767", "patch": "@@ -367,8 +367,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n \n                 if self.is_fn_ty(rcvr_ty, span) {\n                     if let SelfSource::MethodCall(expr) = source {\n-                        let suggest = if let ty::FnDef(def_id, _) = rcvr_ty.kind() {\n-                            let local_id = def_id.expect_local();\n+                        let suggest = if let ty::FnDef(def_id, _) = rcvr_ty.kind() && let Some(local_id) = def_id.as_local() {\n                             let hir_id = tcx.hir().local_def_id_to_hir_id(local_id);\n                             let node = tcx.hir().get(hir_id);\n                             let fields = node.tuple_fields();"}, {"sha": "7f1d1428eb9b4c054e2f4f02ade89c8653884891", "filename": "src/test/ui/typeck/issue-96738.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/436c0e129ca535d249fbf8d61d3b9334e5cd6767/src%2Ftest%2Fui%2Ftypeck%2Fissue-96738.rs", "raw_url": "https://github.com/rust-lang/rust/raw/436c0e129ca535d249fbf8d61d3b9334e5cd6767/src%2Ftest%2Fui%2Ftypeck%2Fissue-96738.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftypeck%2Fissue-96738.rs?ref=436c0e129ca535d249fbf8d61d3b9334e5cd6767", "patch": "@@ -0,0 +1,3 @@\n+fn main() {\n+    Some.nonexistent_method(); //~ ERROR: no method named `nonexistent_method` found\n+}"}, {"sha": "6f9bffbb790c50d698e2581a42dcf8a2cd04aa4e", "filename": "src/test/ui/typeck/issue-96738.stderr", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/436c0e129ca535d249fbf8d61d3b9334e5cd6767/src%2Ftest%2Fui%2Ftypeck%2Fissue-96738.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/436c0e129ca535d249fbf8d61d3b9334e5cd6767/src%2Ftest%2Fui%2Ftypeck%2Fissue-96738.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftypeck%2Fissue-96738.stderr?ref=436c0e129ca535d249fbf8d61d3b9334e5cd6767", "patch": "@@ -0,0 +1,11 @@\n+error[E0599]: no method named `nonexistent_method` found for fn item `fn(_) -> Option<_> {Option::<_>::Some}` in the current scope\n+  --> $DIR/issue-96738.rs:2:10\n+   |\n+LL |     Some.nonexistent_method();\n+   |     ---- ^^^^^^^^^^^^^^^^^^ method not found in `fn(_) -> Option<_> {Option::<_>::Some}`\n+   |     |\n+   |     this is a function, perhaps you wish to call it\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0599`."}]}