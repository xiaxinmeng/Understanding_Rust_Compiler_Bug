{"sha": "714f6afb3256516657a4be54e8b0f1add6efc801", "node_id": "MDY6Q29tbWl0NzI0NzEyOjcxNGY2YWZiMzI1NjUxNjY1N2E0YmU1NGU4YjBmMWFkZDZlZmM4MDE=", "commit": {"author": {"name": "bors[bot]", "email": "bors[bot]@users.noreply.github.com", "date": "2018-11-30T14:40:26Z"}, "committer": {"name": "bors[bot]", "email": "bors[bot]@users.noreply.github.com", "date": "2018-11-30T14:40:26Z"}, "message": "Merge #251\n\n251: Clippy lints r=matklad a=kjeremy\n\n\n\nCo-authored-by: Jeremy A. Kolb <jkolb@ara.com>", "tree": {"sha": "9748b1583dd0d6ffded780fc597857dd8dd2dec3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9748b1583dd0d6ffded780fc597857dd8dd2dec3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/714f6afb3256516657a4be54e8b0f1add6efc801", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/714f6afb3256516657a4be54e8b0f1add6efc801", "html_url": "https://github.com/rust-lang/rust/commit/714f6afb3256516657a4be54e8b0f1add6efc801", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/714f6afb3256516657a4be54e8b0f1add6efc801/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "parents": [{"sha": "70a7cb34ec18d30a680a73727e1d87a0a786dc44", "url": "https://api.github.com/repos/rust-lang/rust/commits/70a7cb34ec18d30a680a73727e1d87a0a786dc44", "html_url": "https://github.com/rust-lang/rust/commit/70a7cb34ec18d30a680a73727e1d87a0a786dc44"}, {"sha": "ab7843c2d1387b2c5be63a914512f79a0be86cac", "url": "https://api.github.com/repos/rust-lang/rust/commits/ab7843c2d1387b2c5be63a914512f79a0be86cac", "html_url": "https://github.com/rust-lang/rust/commit/ab7843c2d1387b2c5be63a914512f79a0be86cac"}], "stats": {"total": 29, "additions": 13, "deletions": 16}, "files": [{"sha": "e1b27c808ec21166e16d7d1110403f1331082d1b", "filename": "crates/gen_lsp_server/src/msg.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/714f6afb3256516657a4be54e8b0f1add6efc801/crates%2Fgen_lsp_server%2Fsrc%2Fmsg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/714f6afb3256516657a4be54e8b0f1add6efc801/crates%2Fgen_lsp_server%2Fsrc%2Fmsg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fgen_lsp_server%2Fsrc%2Fmsg.rs?ref=714f6afb3256516657a4be54e8b0f1add6efc801", "patch": "@@ -94,7 +94,7 @@ impl RawRequest {\n         R::Params: Serialize,\n     {\n         RawRequest {\n-            id: id,\n+            id,\n             method: R::METHOD.to_string(),\n             params: to_value(params).unwrap(),\n         }"}, {"sha": "28368787c2012f7b6a994d612ac8dc2434900470", "filename": "crates/ra_lsp_server/src/conv.rs", "status": "modified", "additions": 3, "deletions": 8, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/714f6afb3256516657a4be54e8b0f1add6efc801/crates%2Fra_lsp_server%2Fsrc%2Fconv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/714f6afb3256516657a4be54e8b0f1add6efc801/crates%2Fra_lsp_server%2Fsrc%2Fconv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fconv.rs?ref=714f6afb3256516657a4be54e8b0f1add6efc801", "patch": "@@ -63,10 +63,7 @@ impl ConvWith for TextUnit {\n \n     fn conv_with(self, line_index: &LineIndex) -> Position {\n         let line_col = line_index.line_col(self);\n-        Position::new(\n-            u64::from(line_col.line),\n-            u64::from(u32::from(line_col.col_utf16)),\n-        )\n+        Position::new(u64::from(line_col.line), u64::from(line_col.col_utf16))\n     }\n }\n \n@@ -204,10 +201,8 @@ impl TryConvWith for SourceChange {\n                     .map(|it| it.edits.as_slice())\n                     .unwrap_or(&[]);\n                 let line_col = translate_offset_with_edit(&*line_index, pos.offset, edits);\n-                let position = Position::new(\n-                    u64::from(line_col.line),\n-                    u64::from(u32::from(line_col.col_utf16)),\n-                );\n+                let position =\n+                    Position::new(u64::from(line_col.line), u64::from(line_col.col_utf16));\n                 Some(TextDocumentPositionParams {\n                     text_document: TextDocumentIdentifier::new(pos.file_id.try_conv_with(world)?),\n                     position,"}, {"sha": "1734185209c24aa4b4076040856926747e2ed5f9", "filename": "crates/ra_lsp_server/src/main.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/714f6afb3256516657a4be54e8b0f1add6efc801/crates%2Fra_lsp_server%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/714f6afb3256516657a4be54e8b0f1add6efc801/crates%2Fra_lsp_server%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fmain.rs?ref=714f6afb3256516657a4be54e8b0f1add6efc801", "patch": "@@ -2,7 +2,6 @@\n extern crate log;\n #[macro_use]\n extern crate failure;\n-#[macro_use]\n extern crate serde_derive;\n extern crate serde;\n extern crate flexi_logger;"}, {"sha": "6d5622b15602c370d60a5681bc06e278f8ac523b", "filename": "crates/ra_lsp_server/src/main_loop/handlers.rs", "status": "modified", "additions": 8, "deletions": 5, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/714f6afb3256516657a4be54e8b0f1add6efc801/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop%2Fhandlers.rs", "raw_url": "https://github.com/rust-lang/rust/raw/714f6afb3256516657a4be54e8b0f1add6efc801/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop%2Fhandlers.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop%2Fhandlers.rs?ref=714f6afb3256516657a4be54e8b0f1add6efc801", "patch": "@@ -384,7 +384,7 @@ pub fn handle_completion(\n     let completion_triggered_after_single_colon = {\n         let mut res = false;\n         if let Some(ctx) = params.context {\n-            if ctx.trigger_character.unwrap_or(String::new()) == \":\" {\n+            if ctx.trigger_character.unwrap_or_default() == \":\" {\n                 let source_file = world.analysis().file_syntax(position.file_id);\n                 let syntax = source_file.syntax();\n                 let text = syntax.text();\n@@ -567,10 +567,13 @@ pub fn handle_rename(world: ServerWorld, params: RenameParams) -> Result<Option<\n     let mut changes = HashMap::new();\n     for r in refs {\n         if let Ok(loc) = to_location(r.0, r.1, &world, &line_index) {\n-            changes.entry(loc.uri).or_insert(Vec::new()).push(TextEdit {\n-                range: loc.range,\n-                new_text: params.new_name.clone(),\n-            });\n+            changes\n+                .entry(loc.uri)\n+                .or_insert_with(Vec::new)\n+                .push(TextEdit {\n+                    range: loc.range,\n+                    new_text: params.new_name.clone(),\n+                });\n         }\n     }\n "}, {"sha": "02e54629c7d159f5e3d4fbc3c43a797d9e74a709", "filename": "crates/ra_lsp_server/src/path_map.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/714f6afb3256516657a4be54e8b0f1add6efc801/crates%2Fra_lsp_server%2Fsrc%2Fpath_map.rs", "raw_url": "https://github.com/rust-lang/rust/raw/714f6afb3256516657a4be54e8b0f1add6efc801/crates%2Fra_lsp_server%2Fsrc%2Fpath_map.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fpath_map.rs?ref=714f6afb3256516657a4be54e8b0f1add6efc801", "patch": "@@ -43,7 +43,7 @@ impl PathMap {\n         (inserted, file_id)\n     }\n     pub fn get_id(&self, path: &Path) -> Option<FileId> {\n-        self.path2id.get(path).map(|&id| id)\n+        self.path2id.get(path).cloned()\n     }\n     pub fn get_path(&self, file_id: FileId) -> &Path {\n         self.id2path.get(&file_id).unwrap().as_path()"}]}