{"sha": "ae7b757ac9e1a8501eadf2b05a81660a0cf13bf8", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFlN2I3NTdhYzllMWE4NTAxZWFkZjJiMDVhODE2NjBhMGNmMTNiZjg=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-07-12T22:27:00Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-07-12T23:54:46Z"}, "message": "Add build targets for building rustc as a test runner. Issue #428", "tree": {"sha": "b153c3418fecc284f899c07e4db304d996fb0d2f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b153c3418fecc284f899c07e4db304d996fb0d2f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ae7b757ac9e1a8501eadf2b05a81660a0cf13bf8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ae7b757ac9e1a8501eadf2b05a81660a0cf13bf8", "html_url": "https://github.com/rust-lang/rust/commit/ae7b757ac9e1a8501eadf2b05a81660a0cf13bf8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ae7b757ac9e1a8501eadf2b05a81660a0cf13bf8/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "73e6a4f9e512b8e7fbec1c645311fa4382558aff", "url": "https://api.github.com/repos/rust-lang/rust/commits/73e6a4f9e512b8e7fbec1c645311fa4382558aff", "html_url": "https://github.com/rust-lang/rust/commit/73e6a4f9e512b8e7fbec1c645311fa4382558aff"}], "stats": {"total": 28, "additions": 28, "deletions": 0}, "files": [{"sha": "f6239e9389eb05fe42827f51a443ae5ad89eca08", "filename": "mk/tests.mk", "status": "modified", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/ae7b757ac9e1a8501eadf2b05a81660a0cf13bf8/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/ae7b757ac9e1a8501eadf2b05a81660a0cf13bf8/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=ae7b757ac9e1a8501eadf2b05a81660a0cf13bf8", "patch": "@@ -366,3 +366,31 @@ check-stage3-std:test/stdtest.stage3$(X)\n \t@$(call E, run: $<)\n \t$(Q)$(call CFG_RUN_TARG,stage3,stage3, $<)\n \n+# Testing the rustctest crate\n+\n+test/rustctest.stage1$(X): $(COMPILER_CRATE) $(COMPILER_INPUTS) $(SREQ0) \\\n+\tstage0/intrinsics.bc\n+\t@$(call E, compile_and_link: $@)\n+\t$(STAGE0) -o $@ $< --test\n+\n+test/rustctest.stage2$(X): $(COMPILER_CRATE) $(COMPILER_INPUTS) $(SREQ1) \\\n+\tstage1/intrinsics.bc\n+\t@$(call E, compile_and_link: $@)\n+\t$(STAGE1) -o $@ $< --test\n+\n+test/rustctest.stage3$(X): $(COMPILER_CRATE) $(COMPILER_INPUTS) $(SREQ2) \\\n+\tstage2/intrinsics.bc\n+\t@$(call E, compile_and_link: $@)\n+\t$(STAGE2) -o $@ $< --test\n+\n+check-stage1-rustc: test/rustctest.stage1$(X)\n+\t@$(call E, run: $<)\n+\t$(Q)$(call CFG_RUN_TARG,stage1,stage0, $<)\n+\n+check-stage2-rustc: test/rustctest.stage2$(X)\n+\t@$(call E, run: $<)\n+\t$(Q)$(call CFG_RUN_TARG,stage2,stage1, $<)\n+\n+check-stage3-rustc: test/rustctest.stage3$(X)\n+\t@$(call E, run: $<)\n+\t$(Q)$(call CFG_RUN_TARG,stage2,stage1, $<)"}]}