{"sha": "257e766c0c17c1a3561a509c931cf89bce27dcf5", "node_id": "C_kwDOAAsO6NoAKDI1N2U3NjZjMGMxN2MxYTM1NjFhNTA5YzkzMWNmODliY2UyN2RjZjU", "commit": {"author": {"name": "David Tolnay", "email": "dtolnay@gmail.com", "date": "2023-01-02T18:31:50Z"}, "committer": {"name": "David Tolnay", "email": "dtolnay@gmail.com", "date": "2023-01-02T18:33:23Z"}, "message": "Remove test of static Context\n\nContext is no longer Sync so this doesn't work.\n\n    error[E0277]: `*mut ()` cannot be shared between threads safely\n      --> library/core/tests/task.rs:24:21\n       |\n    24 |     static CONTEXT: Context<'static> = Context::from_waker(&WAKER);\n       |                     ^^^^^^^^^^^^^^^^ `*mut ()` cannot be shared between threads safely\n       |\n       = help: within `Context<'static>`, the trait `Sync` is not implemented for `*mut ()`\n       = note: required because it appears within the type `PhantomData<*mut ()>`\n       = note: required because it appears within the type `Context<'static>`\n       = note: shared static variables must have a type that implements `Sync`", "tree": {"sha": "e102aef3ec94958450a1bf67ae5e4ad0c539a450", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e102aef3ec94958450a1bf67ae5e4ad0c539a450"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/257e766c0c17c1a3561a509c931cf89bce27dcf5", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEERijF2Cz/ZdaBZKeK+boUO5X/bYIFAmOzI3MACgkQ+boUO5X/\nbYJqwRAAknHL+hAgZXsOmgc/5iA3iYjfBZdPpynJQTN4x4+G57q+AXpcwHww5RV2\n7EwECsKVrRedsMjC3P+ppUlUPIexPJoIk5OiODV+LHukigVDO9hnfTuJw9eIhxug\nQNuH6et4PtWo6nONwfcig0mHzXDQy6Vy3lgPrwflOwCwgjH6P9cj/0iKbpRm7tNm\ngJec/S+4o0p3dK6sHIAhZvVbTe6K5JhZf80t7nWOqAr7WfaUKvE4LP/kXOmvWcsl\nFQAsjkxNgK4IeFCOuTY6OwFiJ5fgBO+becdGCI0TL7RddDPNPx+L9Mixh8zE5dLP\n2kkJUCtycal7kgr/hKbra9ti6WC9ZcX4TPj5kYie/gY5l62AgT7GKK/qQgGY46Xj\nOSpK9vLxSkHx8kozbxmRGHZkWsddr0hq9vcP8w80/bnzR3mWFUnuYdiDOopKTW/M\nQfftpx797YxZqWPUseH9p7qhZebWkdttLEXLLt0Y+4kRyHt1Xz5IycM1PpwQgKCP\n0pOyKNtly3LvsTUAQBykYdZV5cMJGGtClFZmRgWyiX2Z+YoCkd6TqWgjBtqAUAEp\n9Ffppi8AxQbAXqAujpQAxvoLbRDjK1L4y52PkA/D7jKS8l0oWLl/2oFCZDEa82RC\nChPe85aka1c4DlRk4gykDmynsjCiOr/IvB5fCX7N3BLQVLoEAOI=\n=kRcl\n-----END PGP SIGNATURE-----", "payload": "tree e102aef3ec94958450a1bf67ae5e4ad0c539a450\nparent fd59b628ea4d89099ae8ecfce01f271b2a1d9bf5\nauthor David Tolnay <dtolnay@gmail.com> 1672684310 -0800\ncommitter David Tolnay <dtolnay@gmail.com> 1672684403 -0800\n\nRemove test of static Context\n\nContext is no longer Sync so this doesn't work.\n\n    error[E0277]: `*mut ()` cannot be shared between threads safely\n      --> library/core/tests/task.rs:24:21\n       |\n    24 |     static CONTEXT: Context<'static> = Context::from_waker(&WAKER);\n       |                     ^^^^^^^^^^^^^^^^ `*mut ()` cannot be shared between threads safely\n       |\n       = help: within `Context<'static>`, the trait `Sync` is not implemented for `*mut ()`\n       = note: required because it appears within the type `PhantomData<*mut ()>`\n       = note: required because it appears within the type `Context<'static>`\n       = note: shared static variables must have a type that implements `Sync`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/257e766c0c17c1a3561a509c931cf89bce27dcf5", "html_url": "https://github.com/rust-lang/rust/commit/257e766c0c17c1a3561a509c931cf89bce27dcf5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/257e766c0c17c1a3561a509c931cf89bce27dcf5/comments", "author": {"login": "dtolnay", "id": 1940490, "node_id": "MDQ6VXNlcjE5NDA0OTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtolnay", "html_url": "https://github.com/dtolnay", "followers_url": "https://api.github.com/users/dtolnay/followers", "following_url": "https://api.github.com/users/dtolnay/following{/other_user}", "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions", "organizations_url": "https://api.github.com/users/dtolnay/orgs", "repos_url": "https://api.github.com/users/dtolnay/repos", "events_url": "https://api.github.com/users/dtolnay/events{/privacy}", "received_events_url": "https://api.github.com/users/dtolnay/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dtolnay", "id": 1940490, "node_id": "MDQ6VXNlcjE5NDA0OTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtolnay", "html_url": "https://github.com/dtolnay", "followers_url": "https://api.github.com/users/dtolnay/followers", "following_url": "https://api.github.com/users/dtolnay/following{/other_user}", "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions", "organizations_url": "https://api.github.com/users/dtolnay/orgs", "repos_url": "https://api.github.com/users/dtolnay/repos", "events_url": "https://api.github.com/users/dtolnay/events{/privacy}", "received_events_url": "https://api.github.com/users/dtolnay/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fd59b628ea4d89099ae8ecfce01f271b2a1d9bf5", "url": "https://api.github.com/repos/rust-lang/rust/commits/fd59b628ea4d89099ae8ecfce01f271b2a1d9bf5", "html_url": "https://github.com/rust-lang/rust/commit/fd59b628ea4d89099ae8ecfce01f271b2a1d9bf5"}], "stats": {"total": 8, "additions": 2, "deletions": 6}, "files": [{"sha": "163b34c9648529463304ec451c8cbff083d2159c", "filename": "library/core/tests/task.rs", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/257e766c0c17c1a3561a509c931cf89bce27dcf5/library%2Fcore%2Ftests%2Ftask.rs", "raw_url": "https://github.com/rust-lang/rust/raw/257e766c0c17c1a3561a509c931cf89bce27dcf5/library%2Fcore%2Ftests%2Ftask.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Ftests%2Ftask.rs?ref=257e766c0c17c1a3561a509c931cf89bce27dcf5", "patch": "@@ -1,4 +1,4 @@\n-use core::task::{Context, Poll, RawWaker, RawWakerVTable, Waker};\n+use core::task::{Poll, RawWaker, RawWakerVTable, Waker};\n \n #[test]\n fn poll_const() {\n@@ -21,9 +21,5 @@ fn waker_const() {\n \n     static WAKER: Waker = unsafe { Waker::from_raw(VOID_WAKER) };\n \n-    static CONTEXT: Context<'static> = Context::from_waker(&WAKER);\n-\n-    static WAKER_REF: &'static Waker = CONTEXT.waker();\n-\n-    WAKER_REF.wake_by_ref();\n+    WAKER.wake_by_ref();\n }"}]}