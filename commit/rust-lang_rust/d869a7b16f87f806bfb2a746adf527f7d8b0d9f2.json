{"sha": "d869a7b16f87f806bfb2a746adf527f7d8b0d9f2", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ4NjlhN2IxNmY4N2Y4MDZiZmIyYTc0NmFkZjUyN2Y3ZDhiMGQ5ZjI=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-03-16T06:56:14Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-03-16T06:56:14Z"}, "message": "Rollup merge of #58873 - GuillaumeGomez:fix-auto-hide-method-doc, r=QuietMisdreavus\n\nFix \"Auto-hide item methods documentation\" setting\n\nFixes #58825.\n\nr? @QuietMisdreavus", "tree": {"sha": "8b29c716160ad414cf255043671c3e382cad65f0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8b29c716160ad414cf255043671c3e382cad65f0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d869a7b16f87f806bfb2a746adf527f7d8b0d9f2", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcjJ4PCRBK7hj4Ov3rIwAAdHIIAC2Y3YI+NLmAe5OY7RlqjLg6\nWqWjXjxRhID4xr2q+wuwxLogGOpl1U/y3jkxfstfrmlYZL3tfJkbj7MZFU8sf8eC\n/xYUu2EJRA7eq7q/fKUjjPrAg0CPoYfTpvpD7zdzXRLDSaFnkL0GA0XFicBaLCkN\nNb9jNRqGoNror6htBtHZUXqN/XXAE5w6yII7pYGK4sr1O4XSf3g9Pz3/C8jJD6s6\nxBHE1/ZN0LdWor+7GlI/WAnOru6uQh1e8uBidZxrUbaIT4NC8hWxacPqr0d9vim0\nWNUiJxZO/yr7v93W2BV9wW9/j1PW8+cPrYBVePtc+eG42iM/0/mcSkPdffuAmls=\n=OnQ8\n-----END PGP SIGNATURE-----\n", "payload": "tree 8b29c716160ad414cf255043671c3e382cad65f0\nparent 2318274a2d8d07ccc7cbec96714a9984ad8db74e\nparent e969de88bb6121ccd99b97377a5fa04b3aaaae28\nauthor kennytm <kennytm@gmail.com> 1552719374 +0800\ncommitter GitHub <noreply@github.com> 1552719374 +0800\n\nRollup merge of #58873 - GuillaumeGomez:fix-auto-hide-method-doc, r=QuietMisdreavus\n\nFix \"Auto-hide item methods documentation\" setting\n\nFixes #58825.\n\nr? @QuietMisdreavus\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d869a7b16f87f806bfb2a746adf527f7d8b0d9f2", "html_url": "https://github.com/rust-lang/rust/commit/d869a7b16f87f806bfb2a746adf527f7d8b0d9f2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d869a7b16f87f806bfb2a746adf527f7d8b0d9f2/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2318274a2d8d07ccc7cbec96714a9984ad8db74e", "url": "https://api.github.com/repos/rust-lang/rust/commits/2318274a2d8d07ccc7cbec96714a9984ad8db74e", "html_url": "https://github.com/rust-lang/rust/commit/2318274a2d8d07ccc7cbec96714a9984ad8db74e"}, {"sha": "e969de88bb6121ccd99b97377a5fa04b3aaaae28", "url": "https://api.github.com/repos/rust-lang/rust/commits/e969de88bb6121ccd99b97377a5fa04b3aaaae28", "html_url": "https://github.com/rust-lang/rust/commit/e969de88bb6121ccd99b97377a5fa04b3aaaae28"}], "stats": {"total": 69, "additions": 37, "deletions": 32}, "files": [{"sha": "fef6910f40a574c5f62d6f259b25f1b6d25c88ee", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 37, "deletions": 32, "changes": 69, "blob_url": "https://github.com/rust-lang/rust/blob/d869a7b16f87f806bfb2a746adf527f7d8b0d9f2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/d869a7b16f87f806bfb2a746adf527f7d8b0d9f2/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=d869a7b16f87f806bfb2a746adf527f7d8b0d9f2", "patch": "@@ -2077,16 +2077,22 @@ if (!DOMTokenList.prototype.remove) {\n     }\n \n     var toggle = createSimpleToggle(false);\n+    var hideMethodDocs = getCurrentValue(\"rustdoc-method-docs\") !== \"false\";\n+    var pageId = getPageId();\n \n     var func = function(e) {\n         var next = e.nextElementSibling;\n         if (!next) {\n             return;\n         }\n-        if (hasClass(next, \"docblock\") ||\n-            (hasClass(next, \"stability\") &&\n-             hasClass(next.nextElementSibling, \"docblock\"))) {\n-            insertAfter(toggle.cloneNode(true), e.childNodes[e.childNodes.length - 1]);\n+        if (hasClass(next, \"docblock\") === true ||\n+            (hasClass(next, \"stability\") === true &&\n+             hasClass(next.nextElementSibling, \"docblock\") === true)) {\n+            var newToggle = toggle.cloneNode(true);\n+            insertAfter(newToggle, e.childNodes[e.childNodes.length - 1]);\n+            if (hideMethodDocs === true && hasClass(e, \"method\") === true) {\n+                collapseDocs(newToggle, \"hide\", pageId);\n+            }\n         }\n     };\n \n@@ -2107,17 +2113,16 @@ if (!DOMTokenList.prototype.remove) {\n     onEachLazy(document.getElementsByClassName(\"associatedconstant\"), func);\n     onEachLazy(document.getElementsByClassName(\"impl\"), funcImpl);\n     var impl_call = function() {};\n-    if (getCurrentValue(\"rustdoc-method-docs\") !== \"false\") {\n+    if (hideMethodDocs === true) {\n         impl_call = function(e, newToggle, pageId) {\n             if (e.id.match(/^impl(?:-\\d+)?$/) === null) {\n                 // Automatically minimize all non-inherent impls\n-                if (hasClass(e, \"impl\")) {\n+                if (hasClass(e, \"impl\") === true) {\n                     collapseDocs(newToggle, \"hide\", pageId);\n                 }\n             }\n         };\n     }\n-    var pageId = getPageId();\n     var newToggle = document.createElement(\"a\");\n     newToggle.href = \"javascript:void(0)\";\n     newToggle.className = \"collapse-toggle hidden-default collapsed\";\n@@ -2163,7 +2168,7 @@ if (!DOMTokenList.prototype.remove) {\n             var inner_toggle = newToggle.cloneNode(true);\n             inner_toggle.onclick = toggleClicked;\n             e.insertBefore(inner_toggle, e.firstChild);\n-            impl_call(e, inner_toggle, pageId);\n+            impl_call(e.previousSibling, inner_toggle, pageId);\n         }\n     });\n \n@@ -2265,30 +2270,6 @@ if (!DOMTokenList.prototype.remove) {\n     onEachLazy(document.getElementsByClassName(\"docblock\"), buildToggleWrapper);\n     onEachLazy(document.getElementsByClassName(\"sub-variant\"), buildToggleWrapper);\n \n-    // In the search display, allows to switch between tabs.\n-    function printTab(nb) {\n-        if (nb === 0 || nb === 1 || nb === 2) {\n-            currentTab = nb;\n-        }\n-        var nb_copy = nb;\n-        onEachLazy(document.getElementById(\"titles\").childNodes, function(elem) {\n-            if (nb_copy === 0) {\n-                addClass(elem, \"selected\");\n-            } else {\n-                removeClass(elem, \"selected\");\n-            }\n-            nb_copy -= 1;\n-        });\n-        onEachLazy(document.getElementById(\"results\").childNodes, function(elem) {\n-            if (nb === 0) {\n-                elem.style.display = \"\";\n-            } else {\n-                elem.style.display = \"none\";\n-            }\n-            nb -= 1;\n-        });\n-    }\n-\n     function createToggleWrapper(tog) {\n         var span = document.createElement(\"span\");\n         span.className = \"toggle-label\";\n@@ -2374,6 +2355,30 @@ if (!DOMTokenList.prototype.remove) {\n         };\n     });\n \n+    // In the search display, allows to switch between tabs.\n+    function printTab(nb) {\n+        if (nb === 0 || nb === 1 || nb === 2) {\n+            currentTab = nb;\n+        }\n+        var nb_copy = nb;\n+        onEachLazy(document.getElementById(\"titles\").childNodes, function(elem) {\n+            if (nb_copy === 0) {\n+                addClass(elem, \"selected\");\n+            } else {\n+                removeClass(elem, \"selected\");\n+            }\n+            nb_copy -= 1;\n+        });\n+        onEachLazy(document.getElementById(\"results\").childNodes, function(elem) {\n+            if (nb === 0) {\n+                elem.style.display = \"\";\n+            } else {\n+                elem.style.display = \"none\";\n+            }\n+            nb -= 1;\n+        });\n+    }\n+\n     function putBackSearch(search_input) {\n         if (search_input.value !== \"\") {\n             addClass(main, \"hidden\");"}]}