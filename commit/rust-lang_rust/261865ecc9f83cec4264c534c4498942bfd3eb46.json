{"sha": "261865ecc9f83cec4264c534c4498942bfd3eb46", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI2MTg2NWVjYzlmODNjZWM0MjY0YzUzNGM0NDk4OTQyYmZkM2ViNDY=", "commit": {"author": {"name": "Seiichi Uchida", "email": "seuchida@gmail.com", "date": "2017-07-26T13:43:36Z"}, "committer": {"name": "Seiichi Uchida", "email": "seuchida@gmail.com", "date": "2017-07-26T13:43:36Z"}, "message": "Remove newlines between list elements for expressions", "tree": {"sha": "e83789690d0d84877e4768aec2f53a829c8a660b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e83789690d0d84877e4768aec2f53a829c8a660b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/261865ecc9f83cec4264c534c4498942bfd3eb46", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/261865ecc9f83cec4264c534c4498942bfd3eb46", "html_url": "https://github.com/rust-lang/rust/commit/261865ecc9f83cec4264c534c4498942bfd3eb46", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/261865ecc9f83cec4264c534c4498942bfd3eb46/comments", "author": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "committer": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8b5831b5016bf9565f55e1975602c80b5151bd50", "url": "https://api.github.com/repos/rust-lang/rust/commits/8b5831b5016bf9565f55e1975602c80b5151bd50", "html_url": "https://github.com/rust-lang/rust/commit/8b5831b5016bf9565f55e1975602c80b5151bd50"}], "stats": {"total": 21, "additions": 20, "deletions": 1}, "files": [{"sha": "06b32ab9ff59f865cb42d7091c1131eab58e39f4", "filename": "src/expr.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/261865ecc9f83cec4264c534c4498942bfd3eb46/src%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/261865ecc9f83cec4264c534c4498942bfd3eb46/src%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fexpr.rs?ref=261865ecc9f83cec4264c534c4498942bfd3eb46", "patch": "@@ -567,6 +567,7 @@ where\n         },\n         shape: nested_shape,\n         ends_with_newline: ends_with_newline,\n+        preserve_newline: false,\n         config: context.config,\n     };\n     let list_str = try_opt!(write_list(&items, &fmt));\n@@ -642,6 +643,7 @@ fn rewrite_closure_fn_decl(\n         trailing_separator: SeparatorTactic::Never,\n         shape: arg_shape,\n         ends_with_newline: false,\n+        preserve_newline: true,\n         config: context.config,\n     };\n     let list_str = try_opt!(write_list(&item_vec, &fmt));\n@@ -1696,6 +1698,7 @@ fn rewrite_match_pattern(\n         trailing_separator: SeparatorTactic::Never,\n         shape: pat_shape,\n         ends_with_newline: false,\n+        preserve_newline: false,\n         config: context.config,\n     };\n     let pats_str = try_opt!(write_list(&items, &fmt));\n@@ -2188,6 +2191,7 @@ where\n         },\n         shape: shape,\n         ends_with_newline: context.use_block_indent() && tactic == DefinitiveListTactic::Vertical,\n+        preserve_newline: false,\n         config: context.config,\n     };\n \n@@ -2783,6 +2787,7 @@ where\n         trailing_separator: SeparatorTactic::Never,\n         shape: shape,\n         ends_with_newline: false,\n+        preserve_newline: false,\n         config: context.config,\n     };\n     let list_str = try_opt!(write_list(&item_vec, &fmt));"}, {"sha": "a5ebb65c099645b0bb3e98951e4551a4822a36a1", "filename": "src/imports.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/261865ecc9f83cec4264c534c4498942bfd3eb46/src%2Fimports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/261865ecc9f83cec4264c534c4498942bfd3eb46/src%2Fimports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fimports.rs?ref=261865ecc9f83cec4264c534c4498942bfd3eb46", "patch": "@@ -478,6 +478,7 @@ fn rewrite_use_list(\n         },\n         shape: nested_shape,\n         ends_with_newline: ends_with_newline,\n+        preserve_newline: true,\n         config: context.config,\n     };\n     let list_str = try_opt!(write_list(&items[first_index..], &fmt));"}, {"sha": "5f976d7283e59855aa5fb30c2236a93c516de0e9", "filename": "src/items.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/261865ecc9f83cec4264c534c4498942bfd3eb46/src%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/261865ecc9f83cec4264c534c4498942bfd3eb46/src%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fitems.rs?ref=261865ecc9f83cec4264c534c4498942bfd3eb46", "patch": "@@ -477,6 +477,7 @@ impl<'a> FmtVisitor<'a> {\n             trailing_separator: self.config.trailing_comma(),\n             shape: shape,\n             ends_with_newline: true,\n+            preserve_newline: true,\n             config: self.config,\n         };\n \n@@ -2252,6 +2253,7 @@ fn rewrite_args(\n         },\n         shape: Shape::legacy(budget, indent),\n         ends_with_newline: tactic.ends_with_newline(context.config.fn_args_layout()),\n+        preserve_newline: true,\n         config: context.config,\n     };\n \n@@ -2425,6 +2427,7 @@ where\n         },\n         shape: shape,\n         ends_with_newline: tactic.ends_with_newline(context.config.generics_indent()),\n+        preserve_newline: true,\n         config: context.config,\n     };\n \n@@ -2538,6 +2541,7 @@ fn rewrite_where_clause_rfc_style(\n         trailing_separator: comma_tactic,\n         shape: clause_shape,\n         ends_with_newline: true,\n+        preserve_newline: true,\n         config: context.config,\n     };\n     let preds_str = try_opt!(write_list(&items.collect::<Vec<_>>(), &fmt));\n@@ -2639,6 +2643,7 @@ fn rewrite_where_clause(\n         trailing_separator: comma_tactic,\n         shape: Shape::legacy(budget, offset),\n         ends_with_newline: tactic.ends_with_newline(context.config.where_pred_indent()),\n+        preserve_newline: true,\n         config: context.config,\n     };\n     let preds_str = try_opt!(write_list(&item_vec, &fmt));"}, {"sha": "5a6225a5903a49c603829c51757646a71c501453", "filename": "src/lists.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/261865ecc9f83cec4264c534c4498942bfd3eb46/src%2Flists.rs", "raw_url": "https://github.com/rust-lang/rust/raw/261865ecc9f83cec4264c534c4498942bfd3eb46/src%2Flists.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flists.rs?ref=261865ecc9f83cec4264c534c4498942bfd3eb46", "patch": "@@ -65,6 +65,8 @@ pub struct ListFormatting<'a> {\n     // Non-expressions, e.g. items, will have a new line at the end of the list.\n     // Important for comment styles.\n     pub ends_with_newline: bool,\n+    // Remove newlines between list elements for expressions.\n+    pub preserve_newline: bool,\n     pub config: &'a Config,\n }\n \n@@ -342,7 +344,9 @@ where\n             item_max_width = None;\n         }\n \n-        if !last && tactic == DefinitiveListTactic::Vertical && item.new_lines {\n+        if formatting.preserve_newline && !last && tactic == DefinitiveListTactic::Vertical &&\n+            item.new_lines\n+        {\n             item_max_width = None;\n             result.push('\\n');\n         }\n@@ -675,6 +679,7 @@ pub fn struct_lit_formatting<'a>(\n         },\n         shape: shape,\n         ends_with_newline: ends_with_newline,\n+        preserve_newline: true,\n         config: context.config,\n     }\n }"}, {"sha": "0439bf2cfac78c73cfe36102447484ee8f05fecd", "filename": "src/types.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/261865ecc9f83cec4264c534c4498942bfd3eb46/src%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/261865ecc9f83cec4264c534c4498942bfd3eb46/src%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftypes.rs?ref=261865ecc9f83cec4264c534c4498942bfd3eb46", "patch": "@@ -361,6 +361,7 @@ where\n         },\n         shape: list_shape,\n         ends_with_newline: tactic.ends_with_newline(context.config.fn_call_style()),\n+        preserve_newline: true,\n         config: context.config,\n     };\n "}, {"sha": "57876d644c23e777fa586d9520620ad2d517ec57", "filename": "src/vertical.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/261865ecc9f83cec4264c534c4498942bfd3eb46/src%2Fvertical.rs", "raw_url": "https://github.com/rust-lang/rust/raw/261865ecc9f83cec4264c534c4498942bfd3eb46/src%2Fvertical.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fvertical.rs?ref=261865ecc9f83cec4264c534c4498942bfd3eb46", "patch": "@@ -229,6 +229,7 @@ fn rewrite_aligned_items_inner<T: AlignedItem>(\n         trailing_separator: context.config.trailing_comma(),\n         shape: item_shape,\n         ends_with_newline: true,\n+        preserve_newline: true,\n         config: context.config,\n     };\n     write_list(&items, &fmt)"}, {"sha": "5daa9109cad3cb3958dbcecc9bfca60d1d36b05a", "filename": "src/visitor.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/261865ecc9f83cec4264c534c4498942bfd3eb46/src%2Fvisitor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/261865ecc9f83cec4264c534c4498942bfd3eb46/src%2Fvisitor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fvisitor.rs?ref=261865ecc9f83cec4264c534c4498942bfd3eb46", "patch": "@@ -820,6 +820,7 @@ impl Rewrite for ast::MetaItem {\n                     trailing_separator: SeparatorTactic::Never,\n                     shape: item_shape,\n                     ends_with_newline: false,\n+                    preserve_newline: false,\n                     config: context.config,\n                 };\n                 format!(\"{}({})\", name, try_opt!(write_list(&item_vec, &fmt)))"}]}