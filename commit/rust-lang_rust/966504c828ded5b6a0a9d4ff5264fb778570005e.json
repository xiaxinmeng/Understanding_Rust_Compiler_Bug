{"sha": "966504c828ded5b6a0a9d4ff5264fb778570005e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk2NjUwNGM4MjhkZWQ1YjZhMGE5ZDRmZjUyNjRmYjc3ODU3MDAwNWU=", "commit": {"author": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2012-02-04T01:10:29Z"}, "committer": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2012-02-05T18:06:27Z"}, "message": "don't fail if inference is not complete", "tree": {"sha": "515a32c06638b0555a040482fb4b413a677f9b31", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/515a32c06638b0555a040482fb4b413a677f9b31"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/966504c828ded5b6a0a9d4ff5264fb778570005e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/966504c828ded5b6a0a9d4ff5264fb778570005e", "html_url": "https://github.com/rust-lang/rust/commit/966504c828ded5b6a0a9d4ff5264fb778570005e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/966504c828ded5b6a0a9d4ff5264fb778570005e/comments", "author": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "daf0d63a59e5abfb32477748e8df4bffe1fbe2e1", "url": "https://api.github.com/repos/rust-lang/rust/commits/daf0d63a59e5abfb32477748e8df4bffe1fbe2e1", "html_url": "https://github.com/rust-lang/rust/commit/daf0d63a59e5abfb32477748e8df4bffe1fbe2e1"}], "stats": {"total": 18, "additions": 13, "deletions": 5}, "files": [{"sha": "0826eda4cf3848e0895fd13d49e92a569604847a", "filename": "src/comp/middle/ty.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/966504c828ded5b6a0a9d4ff5264fb778570005e/src%2Fcomp%2Fmiddle%2Fty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/966504c828ded5b6a0a9d4ff5264fb778570005e/src%2Fcomp%2Fmiddle%2Fty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Fty.rs?ref=966504c828ded5b6a0a9d4ff5264fb778570005e", "patch": "@@ -167,6 +167,7 @@ export type_structurally_contains;\n export type_structurally_contains_uniques;\n export type_autoderef;\n export type_param;\n+export canon_mode;\n export resolved_mode;\n export arg_mode;\n export unify_mode;"}, {"sha": "969195a40ac9c095646ed3eabc2dfe895a75fa2f", "filename": "src/comp/util/ppaux.rs", "status": "modified", "additions": 12, "deletions": 5, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/966504c828ded5b6a0a9d4ff5264fb778570005e/src%2Fcomp%2Futil%2Fppaux.rs", "raw_url": "https://github.com/rust-lang/rust/raw/966504c828ded5b6a0a9d4ff5264fb778570005e/src%2Fcomp%2Futil%2Fppaux.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Futil%2Fppaux.rs?ref=966504c828ded5b6a0a9d4ff5264fb778570005e", "patch": "@@ -12,12 +12,19 @@ import middle::ast_map;\n fn ty_to_str(cx: ctxt, typ: t) -> str {\n     fn fn_input_to_str(cx: ctxt, input: {mode: ast::mode, ty: t}) ->\n        str {\n-        let arg_mode = ty::arg_mode(cx, input);\n-        let modestr = {\n-            if arg_mode == ty::default_arg_mode_for_ty(cx, input.ty) { \"\" }\n-            else { mode_to_str(input.mode) }\n+        let {mode, ty} = input;\n+        let modestr = alt canon_mode(cx, mode) {\n+          ast::infer(_) { \"\" }\n+          ast::expl(m) {\n+            if !ty::type_contains_vars(cx, ty) &&\n+                m == ty::default_arg_mode_for_ty(cx, ty) {\n+                \"\"\n+            } else {\n+                mode_to_str(ast::expl(m))\n+            }\n+          }\n         };\n-        modestr + ty_to_str(cx, input.ty)\n+        modestr + ty_to_str(cx, ty)\n     }\n     fn fn_to_str(cx: ctxt, proto: ast::proto, ident: option<ast::ident>,\n                  inputs: [arg], output: t, cf: ast::ret_style,"}]}