{"sha": "cc5c38717da46b561a392d56ba27848533056b7b", "node_id": "C_kwDOAAsO6NoAKGNjNWMzODcxN2RhNDZiNTYxYTM5MmQ1NmJhMjc4NDg1MzMwNTZiN2I", "commit": {"author": {"name": "antoyo", "email": "antoyo@users.noreply.github.com", "date": "2022-10-19T22:27:22Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-10-19T22:27:22Z"}, "message": "Merge pull request #236 from GuillaumeGomez/install-doc\n\nImprove installation documentation", "tree": {"sha": "a18f59788594aa6576363f664764f6cd3b7457f8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a18f59788594aa6576363f664764f6cd3b7457f8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cc5c38717da46b561a392d56ba27848533056b7b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjUHnKCRBK7hj4Ov3rIwAAgO8IAGTmmZcol5ycJdmKuu3HNaHu\n2w/4b9amH0SeioxT2l06yM8lMj0yxMQwUsauHWT6JFyfYd1puef4k8f0QtR0O+Ly\nFfByf+b+KazqMQepP+9WMHpDQ1syjuMOe7R2mbegXCY1ruwZPW/EXMvOvo4XuYAf\n+IiCWKce8YVwDPXFLKqS8D0ZbGMHHpbLNBgkXg13cpI2gz/s/pxRES1RV6Du0P1D\ndLGnMWvj9O0RDveF6sqRjxHgqi4V3CGL7fwdbOyHknobg24zEyOjr05/m9FWF9Av\nwaiC2Yr898dFeHPJECbDa4gbIYZGrhznHBCLlo+Bvqcvg0ofXj8R6VJxdB+fRj8=\n=0/TK\n-----END PGP SIGNATURE-----\n", "payload": "tree a18f59788594aa6576363f664764f6cd3b7457f8\nparent 618553b9b4a5996c23285a8efc62f29a940208e6\nparent ea52df463b8d826fcc2086485ed71d3d5eb1430e\nauthor antoyo <antoyo@users.noreply.github.com> 1666218442 -0400\ncommitter GitHub <noreply@github.com> 1666218442 -0400\n\nMerge pull request #236 from GuillaumeGomez/install-doc\n\nImprove installation documentation"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cc5c38717da46b561a392d56ba27848533056b7b", "html_url": "https://github.com/rust-lang/rust/commit/cc5c38717da46b561a392d56ba27848533056b7b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cc5c38717da46b561a392d56ba27848533056b7b/comments", "author": {"login": "antoyo", "id": 584972, "node_id": "MDQ6VXNlcjU4NDk3Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/584972?v=4", "gravatar_id": "", "url": "https://api.github.com/users/antoyo", "html_url": "https://github.com/antoyo", "followers_url": "https://api.github.com/users/antoyo/followers", "following_url": "https://api.github.com/users/antoyo/following{/other_user}", "gists_url": "https://api.github.com/users/antoyo/gists{/gist_id}", "starred_url": "https://api.github.com/users/antoyo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/antoyo/subscriptions", "organizations_url": "https://api.github.com/users/antoyo/orgs", "repos_url": "https://api.github.com/users/antoyo/repos", "events_url": "https://api.github.com/users/antoyo/events{/privacy}", "received_events_url": "https://api.github.com/users/antoyo/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "618553b9b4a5996c23285a8efc62f29a940208e6", "url": "https://api.github.com/repos/rust-lang/rust/commits/618553b9b4a5996c23285a8efc62f29a940208e6", "html_url": "https://github.com/rust-lang/rust/commit/618553b9b4a5996c23285a8efc62f29a940208e6"}, {"sha": "ea52df463b8d826fcc2086485ed71d3d5eb1430e", "url": "https://api.github.com/repos/rust-lang/rust/commits/ea52df463b8d826fcc2086485ed71d3d5eb1430e", "html_url": "https://github.com/rust-lang/rust/commit/ea52df463b8d826fcc2086485ed71d3d5eb1430e"}], "stats": {"total": 35, "additions": 30, "deletions": 5}, "files": [{"sha": "4d776b6c7a3f109808cb6c1dce5fc95848745cbe", "filename": "Readme.md", "status": "modified", "additions": 30, "deletions": 5, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/cc5c38717da46b561a392d56ba27848533056b7b/Readme.md", "raw_url": "https://github.com/rust-lang/rust/raw/cc5c38717da46b561a392d56ba27848533056b7b/Readme.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Readme.md?ref=cc5c38717da46b561a392d56ba27848533056b7b", "patch": "@@ -18,21 +18,46 @@ The patches in [this repository](https://github.com/antoyo/libgccjit-patches) ne\n (Those patches should work when applied on master, but in case it doesn't work, they are known to work when applied on 079c23cfe079f203d5df83fea8e92a60c7d7e878.)\n You can also use my [fork of gcc](https://github.com/antoyo/gcc) which already includes these patches.**\n \n+To build it (most of these instructions come from [here](https://gcc.gnu.org/onlinedocs/jit/internals/index.html), so don't hesitate to take a look there if you encounter an issue):\n+\n+```bash\n+$ git clone https://github.com/antoyo/gcc\n+$ cd gcc\n+$ sudo apt install flex libmpfr-dev libgmp-dev libmpc3 libmpc-dev\n+$ ./configure \\\n+   --enable-host-shared \\\n+   --enable-languages=jit \\\n+   --disable-bootstrap \\\n+   --enable-checking=release \\\n+   --prefix=$(pwd)/install \\\n+   --disable-multilib\n+$ make -j4 # You can replace `4` with another number depending on how many cores you have.\n+$ cd ..\n+```\n+\n **Put the path to your custom build of libgccjit in the file `gcc_path`.**\n \n ```bash\n-$ git clone https://github.com/rust-lang/rustc_codegen_gcc.git\n-$ cd rustc_codegen_gcc\n+$ dirname $(readlink -f `find . -name libgccjit.so`) > gcc_path\n+```\n+\n+You also need to set RUST_COMPILER_RT_ROOT:\n+\n+```bash\n $ git clone https://github.com/llvm/llvm-project llvm --depth 1 --single-branch\n $ export RUST_COMPILER_RT_ROOT=\"$PWD/llvm/compiler-rt\"\n-$ ./prepare_build.sh # download and patch sysroot src\n-$ ./build.sh --release\n ```\n \n-To run the tests:\n+Then you can run commands like this:\n \n ```bash\n $ ./prepare.sh # download and patch sysroot src and install hyperfine for benchmarking\n+$ LIBRARY_PATH=$(cat gcc_path) LD_LIBRARY_PATH=$(cat gcc_path) ./build.sh --release\n+```\n+\n+To run the tests:\n+\n+```bash\n $ ./test.sh --release\n ```\n "}]}