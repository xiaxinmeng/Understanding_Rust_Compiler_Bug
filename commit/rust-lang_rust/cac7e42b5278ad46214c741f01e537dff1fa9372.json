{"sha": "cac7e42b5278ad46214c741f01e537dff1fa9372", "node_id": "C_kwDOAAsO6NoAKGNhYzdlNDJiNTI3OGFkNDYyMTRjNzQxZjAxZTUzN2RmZjFmYTkzNzI", "commit": {"author": {"name": "Ulrich Weigand", "email": "ulrich.weigand@de.ibm.com", "date": "2023-05-10T18:22:17Z"}, "committer": {"name": "Ulrich Weigand", "email": "ulrich.weigand@de.ibm.com", "date": "2023-05-11T11:59:38Z"}, "message": "Fix backtrace normalization in ice-bug-report-url.rs\n\nThis test case currently fails on s390x, and probably other\nplatforms where the last line of a backtrace does not contain\nand \" at <source location>\" specification.\n\nThe problem with the existing normalization lines\n// normalize-stderr-test \"\\s*\\d{1,}: .*\\n\" -> \"\"\n// normalize-stderr-test \"\\s at .*\\n\" -> \"\"\nis that \\s matches all whitespace, including newlines, so the\nfirst (but not second) of these regexes may merge multiple\nlines.  Thus the output differs depending on which of these\nmatches on the last line of a backtrace.\n\nAs the whitespace used in backtraces is just normal space\ncharacters, change both regexes to just match at least one\nspace character instead:\n// normalize-stderr-test \" +\\d{1,}: .*\\n\" -> \"\"\n// normalize-stderr-test \" + at .*\\n\" -> \"\"", "tree": {"sha": "534009df4d4df06e18c509f586fd46d70d348349", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/534009df4d4df06e18c509f586fd46d70d348349"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cac7e42b5278ad46214c741f01e537dff1fa9372", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cac7e42b5278ad46214c741f01e537dff1fa9372", "html_url": "https://github.com/rust-lang/rust/commit/cac7e42b5278ad46214c741f01e537dff1fa9372", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cac7e42b5278ad46214c741f01e537dff1fa9372/comments", "author": {"login": "uweigand", "id": 4154057, "node_id": "MDQ6VXNlcjQxNTQwNTc=", "avatar_url": "https://avatars.githubusercontent.com/u/4154057?v=4", "gravatar_id": "", "url": "https://api.github.com/users/uweigand", "html_url": "https://github.com/uweigand", "followers_url": "https://api.github.com/users/uweigand/followers", "following_url": "https://api.github.com/users/uweigand/following{/other_user}", "gists_url": "https://api.github.com/users/uweigand/gists{/gist_id}", "starred_url": "https://api.github.com/users/uweigand/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/uweigand/subscriptions", "organizations_url": "https://api.github.com/users/uweigand/orgs", "repos_url": "https://api.github.com/users/uweigand/repos", "events_url": "https://api.github.com/users/uweigand/events{/privacy}", "received_events_url": "https://api.github.com/users/uweigand/received_events", "type": "User", "site_admin": false}, "committer": {"login": "uweigand", "id": 4154057, "node_id": "MDQ6VXNlcjQxNTQwNTc=", "avatar_url": "https://avatars.githubusercontent.com/u/4154057?v=4", "gravatar_id": "", "url": "https://api.github.com/users/uweigand", "html_url": "https://github.com/uweigand", "followers_url": "https://api.github.com/users/uweigand/followers", "following_url": "https://api.github.com/users/uweigand/following{/other_user}", "gists_url": "https://api.github.com/users/uweigand/gists{/gist_id}", "starred_url": "https://api.github.com/users/uweigand/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/uweigand/subscriptions", "organizations_url": "https://api.github.com/users/uweigand/orgs", "repos_url": "https://api.github.com/users/uweigand/repos", "events_url": "https://api.github.com/users/uweigand/events{/privacy}", "received_events_url": "https://api.github.com/users/uweigand/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cba14074bb4cc12bfe918eabd0d52a3999b2a461", "url": "https://api.github.com/repos/rust-lang/rust/commits/cba14074bb4cc12bfe918eabd0d52a3999b2a461", "html_url": "https://github.com/rust-lang/rust/commit/cba14074bb4cc12bfe918eabd0d52a3999b2a461"}], "stats": {"total": 5, "additions": 3, "deletions": 2}, "files": [{"sha": "8ede91cf8f4f4493caa8c0d386f7b53093878eaa", "filename": "tests/rustdoc-ui/ice-bug-report-url.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cac7e42b5278ad46214c741f01e537dff1fa9372/tests%2Frustdoc-ui%2Fice-bug-report-url.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cac7e42b5278ad46214c741f01e537dff1fa9372/tests%2Frustdoc-ui%2Fice-bug-report-url.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-ui%2Fice-bug-report-url.rs?ref=cac7e42b5278ad46214c741f01e537dff1fa9372", "patch": "@@ -6,8 +6,8 @@\n // normalize-stderr-test \"note: compiler flags.*\\n\\n\" -> \"\"\n // normalize-stderr-test \"note: rustc.*running on.*\" -> \"note: rustc {version} running on {platform}\"\n // normalize-stderr-test \"thread.*panicked at .*, compiler.*\" -> \"thread panicked at 'aborting due to `-Z treat-err-as-bug`'\"\n-// normalize-stderr-test \"\\s*\\d{1,}: .*\\n\" -> \"\"\n-// normalize-stderr-test \"\\s at .*\\n\" -> \"\"\n+// normalize-stderr-test \" +\\d{1,}: .*\\n\" -> \"\"\n+// normalize-stderr-test \" + at .*\\n\" -> \"\"\n // normalize-stderr-test \".*note: Some details are omitted.*\\n\" -> \"\"\n \n fn wrong()"}, {"sha": "98c08b9a8944b7962c0c9669abf8aa9c2acb8a2a", "filename": "tests/rustdoc-ui/ice-bug-report-url.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/cac7e42b5278ad46214c741f01e537dff1fa9372/tests%2Frustdoc-ui%2Fice-bug-report-url.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cac7e42b5278ad46214c741f01e537dff1fa9372/tests%2Frustdoc-ui%2Fice-bug-report-url.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-ui%2Fice-bug-report-url.stderr?ref=cac7e42b5278ad46214c741f01e537dff1fa9372", "patch": "@@ -6,6 +6,7 @@ LL | fn wrong()\n \n thread panicked at 'aborting due to `-Z treat-err-as-bug`'\n stack backtrace:\n+\n error: the compiler unexpectedly panicked. this is a bug.\n \n note: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-rustdoc&template=ice.md"}]}