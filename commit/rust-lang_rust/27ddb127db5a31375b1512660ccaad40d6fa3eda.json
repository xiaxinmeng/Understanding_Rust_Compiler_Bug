{"sha": "27ddb127db5a31375b1512660ccaad40d6fa3eda", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI3ZGRiMTI3ZGI1YTMxMzc1YjE1MTI2NjBjY2FhZDQwZDZmYTNlZGE=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-02-10T16:38:39Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-02-11T09:55:44Z"}, "message": "Publish VS Code extension automatically", "tree": {"sha": "eb8371760543707312ad0316cece9b0e91d9ef0d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/eb8371760543707312ad0316cece9b0e91d9ef0d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/27ddb127db5a31375b1512660ccaad40d6fa3eda", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/27ddb127db5a31375b1512660ccaad40d6fa3eda", "html_url": "https://github.com/rust-lang/rust/commit/27ddb127db5a31375b1512660ccaad40d6fa3eda", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/27ddb127db5a31375b1512660ccaad40d6fa3eda/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "af9a9abbd8011d751e5d37f68c486336cb41ac65", "url": "https://api.github.com/repos/rust-lang/rust/commits/af9a9abbd8011d751e5d37f68c486336cb41ac65", "html_url": "https://github.com/rust-lang/rust/commit/af9a9abbd8011d751e5d37f68c486336cb41ac65"}], "stats": {"total": 22, "additions": 19, "deletions": 3}, "files": [{"sha": "b4c42d0b7f5eaa168b9898d6c3909f6e48e030a2", "filename": ".github/workflows/release.yaml", "status": "modified", "additions": 19, "deletions": 3, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/27ddb127db5a31375b1512660ccaad40d6fa3eda/.github%2Fworkflows%2Frelease.yaml", "raw_url": "https://github.com/rust-lang/rust/raw/27ddb127db5a31375b1512660ccaad40d6fa3eda/.github%2Fworkflows%2Frelease.yaml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Frelease.yaml?ref=27ddb127db5a31375b1512660ccaad40d6fa3eda", "patch": "@@ -106,6 +106,17 @@ jobs:\n     runs-on: ubuntu-latest\n     needs: ['build-server', 'build-clients']\n     steps:\n+      - name: Install Nodejs\n+        uses: actions/setup-node@v1\n+        with:\n+          node-version: 12.x\n+\n+      - run: echo \"::set-env name=TAG::$(date --iso)\"\n+      - run: 'echo \"TAG: $TAG\"'\n+\n+      - name: Checkout repository\n+        uses: actions/checkout@v1\n+\n       - uses: actions/download-artifact@v1\n         with:\n           name: editor-plugins\n@@ -124,9 +135,6 @@ jobs:\n           path: dist\n       - run: ls -all ./dist\n \n-      - run: echo \"::set-env name=TAG::$(date --iso)\"\n-      - run: 'echo \"TAG: $TAG\"'\n-\n       - name: Create Release\n         id: create_release\n         # uses: actions/create-release@v1\n@@ -184,3 +192,11 @@ jobs:\n           asset_path: ./dist/rust-analyzer.el\n           asset_name: rust-analyzer.el\n           asset_content_type: text/plain\n+\n+      - run: npm ci\n+        working-directory: ./editors/code\n+\n+      - name: Publish Extension\n+        working-directory: ./editors/code\n+        # token from https://dev.azure.com/rust-analyzer/\n+        run: ./node_modules/vsce/out/vsce publish 0.1.0.$(date +%Y%m%d) --pat ${{ secrets.MARKETPLACE_TOKEN }}"}]}