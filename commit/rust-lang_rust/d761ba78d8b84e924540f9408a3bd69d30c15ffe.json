{"sha": "d761ba78d8b84e924540f9408a3bd69d30c15ffe", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ3NjFiYTc4ZDhiODRlOTI0NTQwZjk0MDhhM2JkNjlkMzBjMTVmZmU=", "commit": {"author": {"name": "Oliver Schneider", "email": "github35764891676564198441@oli-obk.de", "date": "2018-06-19T11:30:38Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-06-19T11:30:38Z"}, "message": "Merge pull request #2837 from fanzier/panicking_unwrap\n\nImplement lint checking for `unwrap`s that will always panic.", "tree": {"sha": "4db297691e1b709628afee6e685086d76835a0d4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4db297691e1b709628afee6e685086d76835a0d4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d761ba78d8b84e924540f9408a3bd69d30c15ffe", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbKOleCRBK7hj4Ov3rIwAAdHIIADcBehYoJ6p6LY43Jsp2g6jl\nF+puuofcnKTWUloev8X/GiQfpLrvK0agLgTSju2H7FiId/IKlK/5EdPNUo65UT0V\npfnq7ckf1gLhceph543eeY1xUx5RJEoKYqruyc27zhNoDRKOnwaUstRczAJ1tgFG\nvtA1SBSWSB4ksuehzcn2tm5PY085e3hO3f9hrW7TLefcZuOBTJprqNYQQphiYyly\nSIUNHsmTzX2NtJ7sNFBakQMgp6b9BFlckwhRBrcZ/TdKsx1LKE7zC3UXKqfMg5Z4\nAdO7MJMMo3iIvd6LoMm8qcYX3/+/FofsQl25jA7jiYjMU5M5I586BEvFf+jDweU=\n=wGDW\n-----END PGP SIGNATURE-----\n", "payload": "tree 4db297691e1b709628afee6e685086d76835a0d4\nparent 4839c790aeb91e080412c2290569a3b95e438d87\nparent 817da4c00a3a113dd806ae80c7d76aee219fa7f6\nauthor Oliver Schneider <github35764891676564198441@oli-obk.de> 1529407838 +0200\ncommitter GitHub <noreply@github.com> 1529407838 +0200\n\nMerge pull request #2837 from fanzier/panicking_unwrap\n\nImplement lint checking for `unwrap`s that will always panic."}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d761ba78d8b84e924540f9408a3bd69d30c15ffe", "html_url": "https://github.com/rust-lang/rust/commit/d761ba78d8b84e924540f9408a3bd69d30c15ffe", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d761ba78d8b84e924540f9408a3bd69d30c15ffe/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4839c790aeb91e080412c2290569a3b95e438d87", "url": "https://api.github.com/repos/rust-lang/rust/commits/4839c790aeb91e080412c2290569a3b95e438d87", "html_url": "https://github.com/rust-lang/rust/commit/4839c790aeb91e080412c2290569a3b95e438d87"}, {"sha": "817da4c00a3a113dd806ae80c7d76aee219fa7f6", "url": "https://api.github.com/repos/rust-lang/rust/commits/817da4c00a3a113dd806ae80c7d76aee219fa7f6", "html_url": "https://github.com/rust-lang/rust/commit/817da4c00a3a113dd806ae80c7d76aee219fa7f6"}], "stats": {"total": 399, "additions": 308, "deletions": 91}, "files": [{"sha": "a2f2ae8ab0c817e1b8ab22762ccbcaf923fafb09", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d761ba78d8b84e924540f9408a3bd69d30c15ffe/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d761ba78d8b84e924540f9408a3bd69d30c15ffe/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=d761ba78d8b84e924540f9408a3bd69d30c15ffe", "patch": "@@ -941,6 +941,7 @@ pub fn register_plugins(reg: &mut rustc_plugin::Registry) {\n         mutex_atomic::MUTEX_INTEGER,\n         needless_borrow::NEEDLESS_BORROW,\n         ranges::RANGE_PLUS_ONE,\n+        unwrap::PANICKING_UNWRAP,\n         unwrap::UNNECESSARY_UNWRAP,\n     ]);\n }"}, {"sha": "7355b38fd6bf61cd65e6857b76188ad6fa84e45d", "filename": "clippy_lints/src/unwrap.rs", "status": "modified", "additions": 43, "deletions": 11, "changes": 54, "blob_url": "https://github.com/rust-lang/rust/blob/d761ba78d8b84e924540f9408a3bd69d30c15ffe/clippy_lints%2Fsrc%2Funwrap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d761ba78d8b84e924540f9408a3bd69d30c15ffe/clippy_lints%2Fsrc%2Funwrap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Funwrap.rs?ref=d761ba78d8b84e924540f9408a3bd69d30c15ffe", "patch": "@@ -32,6 +32,27 @@ declare_clippy_lint! {\n     \"checks for calls of unwrap[_err]() that cannot fail\"\n }\n \n+/// **What it does:** Checks for calls of `unwrap[_err]()` that will always fail.\n+///\n+/// **Why is this bad?** If panicking is desired, an explicit `panic!()` should be used.\n+///\n+/// **Known problems:** This lint only checks `if` conditions not assignments.\n+/// So something like `let x: Option<()> = None; x.unwrap();` will not be recognized.\n+///\n+/// **Example:**\n+/// ```rust\n+/// if option.is_none() {\n+///     do_something_with(option.unwrap())\n+/// }\n+/// ```\n+///\n+/// This code will always panic. The if condition should probably be inverted.\n+declare_clippy_lint! {\n+    pub PANICKING_UNWRAP,\n+    nursery,\n+    \"checks for calls of unwrap[_err]() that will always fail\"\n+}\n+\n pub struct Pass;\n \n /// Visitor that keeps track of which variables are unwrappable.\n@@ -124,17 +145,28 @@ impl<'a, 'tcx: 'a> Visitor<'tcx> for UnwrappableVariablesVisitor<'a, 'tcx> {\n                 if [\"unwrap\", \"unwrap_err\"].contains(&&*method_name.name.as_str());\n                 let call_to_unwrap = method_name.name == \"unwrap\";\n                 if let Some(unwrappable) = self.unwrappables.iter()\n-                    .find(|u| u.ident.def == path.def && call_to_unwrap == u.safe_to_unwrap);\n+                    .find(|u| u.ident.def == path.def);\n                 then {\n-                    span_lint_and_then(\n-                        self.cx,\n-                        UNNECESSARY_UNWRAP,\n-                        expr.span,\n-                        &format!(\"You checked before that `{}()` cannot fail. \\\n-                        Instead of checking and unwrapping, it's better to use `if let` or `match`.\",\n-                        method_name.name),\n-                        |db| { db.span_label(unwrappable.check.span, \"the check is happening here\"); },\n-                    );\n+                    if call_to_unwrap == unwrappable.safe_to_unwrap {\n+                        span_lint_and_then(\n+                            self.cx,\n+                            UNNECESSARY_UNWRAP,\n+                            expr.span,\n+                            &format!(\"You checked before that `{}()` cannot fail. \\\n+                            Instead of checking and unwrapping, it's better to use `if let` or `match`.\",\n+                            method_name.name),\n+                            |db| { db.span_label(unwrappable.check.span, \"the check is happening here\"); },\n+                        );\n+                    } else {\n+                        span_lint_and_then(\n+                            self.cx,\n+                            PANICKING_UNWRAP,\n+                            expr.span,\n+                            &format!(\"This call to `{}()` will always panic.\",\n+                            method_name.name),\n+                            |db| { db.span_label(unwrappable.check.span, \"because of this check\"); },\n+                        );\n+                    }\n                 }\n             }\n             walk_expr(self, expr);\n@@ -148,7 +180,7 @@ impl<'a, 'tcx: 'a> Visitor<'tcx> for UnwrappableVariablesVisitor<'a, 'tcx> {\n \n impl<'a> LintPass for Pass {\n     fn get_lints(&self) -> LintArray {\n-        lint_array!(UNNECESSARY_UNWRAP)\n+        lint_array!(PANICKING_UNWRAP, UNNECESSARY_UNWRAP)\n     }\n }\n "}, {"sha": "c3d4b8de08b3f1f0cf2f65510fc4f19a7716657a", "filename": "tests/ui/checked_unwrap.rs", "status": "modified", "additions": 50, "deletions": 24, "changes": 74, "blob_url": "https://github.com/rust-lang/rust/blob/d761ba78d8b84e924540f9408a3bd69d30c15ffe/tests%2Fui%2Fchecked_unwrap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d761ba78d8b84e924540f9408a3bd69d30c15ffe/tests%2Fui%2Fchecked_unwrap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fchecked_unwrap.rs?ref=d761ba78d8b84e924540f9408a3bd69d30c15ffe", "patch": "@@ -1,75 +1,101 @@\n-#![deny(unnecessary_unwrap)]\n+#![deny(panicking_unwrap, unnecessary_unwrap)]\n+#![allow(if_same_then_else)]\n \n fn main() {\n     let x = Some(());\n     if x.is_some() {\n-        x.unwrap();\n+        x.unwrap(); // unnecessary\n+    } else {\n+        x.unwrap(); // will panic\n     }\n     if x.is_none() {\n-        // nothing to do here\n+        x.unwrap(); // will panic\n     } else {\n-        x.unwrap();\n+        x.unwrap(); // unnecessary\n     }\n     let mut x: Result<(), ()> = Ok(());\n     if x.is_ok() {\n-        x.unwrap();\n+        x.unwrap(); // unnecessary\n+        x.unwrap_err(); // will panic\n     } else {\n-        x.unwrap_err();\n+        x.unwrap(); // will panic\n+        x.unwrap_err(); // unnecessary\n     }\n     if x.is_err() {\n-        x.unwrap_err();\n+        x.unwrap(); // will panic\n+        x.unwrap_err(); // unnecessary\n     } else {\n-        x.unwrap();\n+        x.unwrap(); // unnecessary\n+        x.unwrap_err(); // will panic\n     }\n     if x.is_ok() {\n         x = Err(());\n-        x.unwrap();\n+        x.unwrap(); // not unnecessary because of mutation of x\n+        // it will always panic but the lint is not smart enoguh to see this (it only checks if conditions).\n     } else {\n         x = Ok(());\n-        x.unwrap_err();\n+        x.unwrap_err(); // not unnecessary because of mutation of x\n+        // it will always panic but the lint is not smart enoguh to see this (it only checks if conditions).\n     }\n }\n \n fn test_complex_conditions() {\n     let x: Result<(), ()> = Ok(());\n     let y: Result<(), ()> = Ok(());\n     if x.is_ok() && y.is_err() {\n-        x.unwrap();\n-        y.unwrap_err();\n+        x.unwrap(); // unnecessary\n+        x.unwrap_err(); // will panic\n+        y.unwrap(); // will panic\n+        y.unwrap_err(); // unnecessary\n     } else {\n-        // not clear whether unwrappable:\n+        // not statically determinable whether any of the following will always succeed or always fail:\n+        x.unwrap();\n         x.unwrap_err();\n         y.unwrap();\n+        y.unwrap_err();\n     }\n \n     if x.is_ok() || y.is_ok() {\n-        // not clear whether unwrappable:\n+        // not statically determinable whether any of the following will always succeed or always fail:\n         x.unwrap();\n         y.unwrap();\n     } else {\n-        x.unwrap_err();\n-        y.unwrap_err();\n+        x.unwrap(); // will panic\n+        x.unwrap_err(); // unnecessary\n+        y.unwrap(); // will panic\n+        y.unwrap_err(); // unnecessary\n     }\n     let z: Result<(), ()> = Ok(());\n     if x.is_ok() && !(y.is_ok() || z.is_err()) {\n-        x.unwrap();\n-        y.unwrap_err();\n-        z.unwrap();\n+        x.unwrap(); // unnecessary\n+        x.unwrap_err(); // will panic\n+        y.unwrap(); // will panic\n+        y.unwrap_err(); // unnecessary\n+        z.unwrap(); // unnecessary\n+        z.unwrap_err(); // will panic\n     }\n     if x.is_ok() || !(y.is_ok() && z.is_err()) {\n-        // not clear what's unwrappable\n-    } else {\n-        x.unwrap_err();\n+        // not statically determinable whether any of the following will always succeed or always fail:\n+        x.unwrap();\n         y.unwrap();\n-        z.unwrap_err();\n+        z.unwrap();\n+    } else {\n+        x.unwrap(); // will panic\n+        x.unwrap_err(); // unnecessary\n+        y.unwrap(); // unnecessary\n+        y.unwrap_err(); // will panic\n+        z.unwrap(); // will panic\n+        z.unwrap_err(); // unnecessary\n     }\n }\n \n fn test_nested() {\n     fn nested() {\n         let x = Some(());\n         if x.is_some() {\n-            x.unwrap();\n+            x.unwrap(); // unnecessary\n+        } else {\n+            x.unwrap(); // will panic\n         }\n     }\n }"}, {"sha": "1b46ceb5fa8d145ad6533c51a3da1ad104c4518c", "filename": "tests/ui/checked_unwrap.stderr", "status": "modified", "additions": 214, "deletions": 56, "changes": 270, "blob_url": "https://github.com/rust-lang/rust/blob/d761ba78d8b84e924540f9408a3bd69d30c15ffe/tests%2Fui%2Fchecked_unwrap.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d761ba78d8b84e924540f9408a3bd69d30c15ffe/tests%2Fui%2Fchecked_unwrap.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fchecked_unwrap.stderr?ref=d761ba78d8b84e924540f9408a3bd69d30c15ffe", "patch": "@@ -1,155 +1,313 @@\n error: You checked before that `unwrap()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n- --> $DIR/checked_unwrap.rs:6:9\n+ --> $DIR/checked_unwrap.rs:7:9\n   |\n-5 |     if x.is_some() {\n+6 |     if x.is_some() {\n   |        ----------- the check is happening here\n-6 |         x.unwrap();\n+7 |         x.unwrap(); // unnecessary\n+  |         ^^^^^^^^^^\n+  |\n+note: lint level defined here\n+ --> $DIR/checked_unwrap.rs:1:27\n+  |\n+1 | #![deny(panicking_unwrap, unnecessary_unwrap)]\n+  |                           ^^^^^^^^^^^^^^^^^^\n+\n+error: This call to `unwrap()` will always panic.\n+ --> $DIR/checked_unwrap.rs:9:9\n+  |\n+6 |     if x.is_some() {\n+  |        ----------- because of this check\n+...\n+9 |         x.unwrap(); // will panic\n   |         ^^^^^^^^^^\n   |\n note: lint level defined here\n  --> $DIR/checked_unwrap.rs:1:9\n   |\n-1 | #![deny(unnecessary_unwrap)]\n-  |         ^^^^^^^^^^^^^^^^^^\n+1 | #![deny(panicking_unwrap, unnecessary_unwrap)]\n+  |         ^^^^^^^^^^^^^^^^\n+\n+error: This call to `unwrap()` will always panic.\n+  --> $DIR/checked_unwrap.rs:12:9\n+   |\n+11 |     if x.is_none() {\n+   |        ----------- because of this check\n+12 |         x.unwrap(); // will panic\n+   |         ^^^^^^^^^^\n \n error: You checked before that `unwrap()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:11:9\n+  --> $DIR/checked_unwrap.rs:14:9\n    |\n-8  |     if x.is_none() {\n+11 |     if x.is_none() {\n    |        ----------- the check is happening here\n ...\n-11 |         x.unwrap();\n+14 |         x.unwrap(); // unnecessary\n    |         ^^^^^^^^^^\n \n error: You checked before that `unwrap()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:15:9\n+  --> $DIR/checked_unwrap.rs:18:9\n    |\n-14 |     if x.is_ok() {\n+17 |     if x.is_ok() {\n    |        --------- the check is happening here\n-15 |         x.unwrap();\n+18 |         x.unwrap(); // unnecessary\n+   |         ^^^^^^^^^^\n+\n+error: This call to `unwrap_err()` will always panic.\n+  --> $DIR/checked_unwrap.rs:19:9\n+   |\n+17 |     if x.is_ok() {\n+   |        --------- because of this check\n+18 |         x.unwrap(); // unnecessary\n+19 |         x.unwrap_err(); // will panic\n+   |         ^^^^^^^^^^^^^^\n+\n+error: This call to `unwrap()` will always panic.\n+  --> $DIR/checked_unwrap.rs:21:9\n+   |\n+17 |     if x.is_ok() {\n+   |        --------- because of this check\n+...\n+21 |         x.unwrap(); // will panic\n    |         ^^^^^^^^^^\n \n error: You checked before that `unwrap_err()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:17:9\n+  --> $DIR/checked_unwrap.rs:22:9\n    |\n-14 |     if x.is_ok() {\n+17 |     if x.is_ok() {\n    |        --------- the check is happening here\n ...\n-17 |         x.unwrap_err();\n+22 |         x.unwrap_err(); // unnecessary\n    |         ^^^^^^^^^^^^^^\n \n+error: This call to `unwrap()` will always panic.\n+  --> $DIR/checked_unwrap.rs:25:9\n+   |\n+24 |     if x.is_err() {\n+   |        ---------- because of this check\n+25 |         x.unwrap(); // will panic\n+   |         ^^^^^^^^^^\n+\n error: You checked before that `unwrap_err()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:20:9\n+  --> $DIR/checked_unwrap.rs:26:9\n    |\n-19 |     if x.is_err() {\n+24 |     if x.is_err() {\n    |        ---------- the check is happening here\n-20 |         x.unwrap_err();\n+25 |         x.unwrap(); // will panic\n+26 |         x.unwrap_err(); // unnecessary\n    |         ^^^^^^^^^^^^^^\n \n error: You checked before that `unwrap()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:22:9\n+  --> $DIR/checked_unwrap.rs:28:9\n    |\n-19 |     if x.is_err() {\n+24 |     if x.is_err() {\n    |        ---------- the check is happening here\n ...\n-22 |         x.unwrap();\n+28 |         x.unwrap(); // unnecessary\n    |         ^^^^^^^^^^\n \n+error: This call to `unwrap_err()` will always panic.\n+  --> $DIR/checked_unwrap.rs:29:9\n+   |\n+24 |     if x.is_err() {\n+   |        ---------- because of this check\n+...\n+29 |         x.unwrap_err(); // will panic\n+   |         ^^^^^^^^^^^^^^\n+\n error: You checked before that `unwrap()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:37:9\n+  --> $DIR/checked_unwrap.rs:46:9\n    |\n-36 |     if x.is_ok() && y.is_err() {\n+45 |     if x.is_ok() && y.is_err() {\n    |        --------- the check is happening here\n-37 |         x.unwrap();\n+46 |         x.unwrap(); // unnecessary\n+   |         ^^^^^^^^^^\n+\n+error: This call to `unwrap_err()` will always panic.\n+  --> $DIR/checked_unwrap.rs:47:9\n+   |\n+45 |     if x.is_ok() && y.is_err() {\n+   |        --------- because of this check\n+46 |         x.unwrap(); // unnecessary\n+47 |         x.unwrap_err(); // will panic\n+   |         ^^^^^^^^^^^^^^\n+\n+error: This call to `unwrap()` will always panic.\n+  --> $DIR/checked_unwrap.rs:48:9\n+   |\n+45 |     if x.is_ok() && y.is_err() {\n+   |                     ---------- because of this check\n+...\n+48 |         y.unwrap(); // will panic\n    |         ^^^^^^^^^^\n \n error: You checked before that `unwrap_err()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:38:9\n+  --> $DIR/checked_unwrap.rs:49:9\n    |\n-36 |     if x.is_ok() && y.is_err() {\n+45 |     if x.is_ok() && y.is_err() {\n    |                     ---------- the check is happening here\n-37 |         x.unwrap();\n-38 |         y.unwrap_err();\n+...\n+49 |         y.unwrap_err(); // unnecessary\n    |         ^^^^^^^^^^^^^^\n \n+error: This call to `unwrap()` will always panic.\n+  --> $DIR/checked_unwrap.rs:63:9\n+   |\n+58 |     if x.is_ok() || y.is_ok() {\n+   |        --------- because of this check\n+...\n+63 |         x.unwrap(); // will panic\n+   |         ^^^^^^^^^^\n+\n error: You checked before that `unwrap_err()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:50:9\n+  --> $DIR/checked_unwrap.rs:64:9\n    |\n-45 |     if x.is_ok() || y.is_ok() {\n+58 |     if x.is_ok() || y.is_ok() {\n    |        --------- the check is happening here\n ...\n-50 |         x.unwrap_err();\n+64 |         x.unwrap_err(); // unnecessary\n    |         ^^^^^^^^^^^^^^\n \n+error: This call to `unwrap()` will always panic.\n+  --> $DIR/checked_unwrap.rs:65:9\n+   |\n+58 |     if x.is_ok() || y.is_ok() {\n+   |                     --------- because of this check\n+...\n+65 |         y.unwrap(); // will panic\n+   |         ^^^^^^^^^^\n+\n error: You checked before that `unwrap_err()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:51:9\n+  --> $DIR/checked_unwrap.rs:66:9\n    |\n-45 |     if x.is_ok() || y.is_ok() {\n+58 |     if x.is_ok() || y.is_ok() {\n    |                     --------- the check is happening here\n ...\n-51 |         y.unwrap_err();\n+66 |         y.unwrap_err(); // unnecessary\n    |         ^^^^^^^^^^^^^^\n \n error: You checked before that `unwrap()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:55:9\n+  --> $DIR/checked_unwrap.rs:70:9\n    |\n-54 |     if x.is_ok() && !(y.is_ok() || z.is_err()) {\n+69 |     if x.is_ok() && !(y.is_ok() || z.is_err()) {\n    |        --------- the check is happening here\n-55 |         x.unwrap();\n+70 |         x.unwrap(); // unnecessary\n+   |         ^^^^^^^^^^\n+\n+error: This call to `unwrap_err()` will always panic.\n+  --> $DIR/checked_unwrap.rs:71:9\n+   |\n+69 |     if x.is_ok() && !(y.is_ok() || z.is_err()) {\n+   |        --------- because of this check\n+70 |         x.unwrap(); // unnecessary\n+71 |         x.unwrap_err(); // will panic\n+   |         ^^^^^^^^^^^^^^\n+\n+error: This call to `unwrap()` will always panic.\n+  --> $DIR/checked_unwrap.rs:72:9\n+   |\n+69 |     if x.is_ok() && !(y.is_ok() || z.is_err()) {\n+   |                       --------- because of this check\n+...\n+72 |         y.unwrap(); // will panic\n    |         ^^^^^^^^^^\n \n error: You checked before that `unwrap_err()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:56:9\n+  --> $DIR/checked_unwrap.rs:73:9\n    |\n-54 |     if x.is_ok() && !(y.is_ok() || z.is_err()) {\n+69 |     if x.is_ok() && !(y.is_ok() || z.is_err()) {\n    |                       --------- the check is happening here\n-55 |         x.unwrap();\n-56 |         y.unwrap_err();\n+...\n+73 |         y.unwrap_err(); // unnecessary\n    |         ^^^^^^^^^^^^^^\n \n error: You checked before that `unwrap()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:57:9\n+  --> $DIR/checked_unwrap.rs:74:9\n    |\n-54 |     if x.is_ok() && !(y.is_ok() || z.is_err()) {\n+69 |     if x.is_ok() && !(y.is_ok() || z.is_err()) {\n    |                                    ---------- the check is happening here\n ...\n-57 |         z.unwrap();\n+74 |         z.unwrap(); // unnecessary\n+   |         ^^^^^^^^^^\n+\n+error: This call to `unwrap_err()` will always panic.\n+  --> $DIR/checked_unwrap.rs:75:9\n+   |\n+69 |     if x.is_ok() && !(y.is_ok() || z.is_err()) {\n+   |                                    ---------- because of this check\n+...\n+75 |         z.unwrap_err(); // will panic\n+   |         ^^^^^^^^^^^^^^\n+\n+error: This call to `unwrap()` will always panic.\n+  --> $DIR/checked_unwrap.rs:83:9\n+   |\n+77 |     if x.is_ok() || !(y.is_ok() && z.is_err()) {\n+   |        --------- because of this check\n+...\n+83 |         x.unwrap(); // will panic\n    |         ^^^^^^^^^^\n \n error: You checked before that `unwrap_err()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:62:9\n+  --> $DIR/checked_unwrap.rs:84:9\n    |\n-59 |     if x.is_ok() || !(y.is_ok() && z.is_err()) {\n+77 |     if x.is_ok() || !(y.is_ok() && z.is_err()) {\n    |        --------- the check is happening here\n ...\n-62 |         x.unwrap_err();\n+84 |         x.unwrap_err(); // unnecessary\n    |         ^^^^^^^^^^^^^^\n \n error: You checked before that `unwrap()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:63:9\n+  --> $DIR/checked_unwrap.rs:85:9\n    |\n-59 |     if x.is_ok() || !(y.is_ok() && z.is_err()) {\n+77 |     if x.is_ok() || !(y.is_ok() && z.is_err()) {\n    |                       --------- the check is happening here\n ...\n-63 |         y.unwrap();\n+85 |         y.unwrap(); // unnecessary\n+   |         ^^^^^^^^^^\n+\n+error: This call to `unwrap_err()` will always panic.\n+  --> $DIR/checked_unwrap.rs:86:9\n+   |\n+77 |     if x.is_ok() || !(y.is_ok() && z.is_err()) {\n+   |                       --------- because of this check\n+...\n+86 |         y.unwrap_err(); // will panic\n+   |         ^^^^^^^^^^^^^^\n+\n+error: This call to `unwrap()` will always panic.\n+  --> $DIR/checked_unwrap.rs:87:9\n+   |\n+77 |     if x.is_ok() || !(y.is_ok() && z.is_err()) {\n+   |                                    ---------- because of this check\n+...\n+87 |         z.unwrap(); // will panic\n    |         ^^^^^^^^^^\n \n error: You checked before that `unwrap_err()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:64:9\n+  --> $DIR/checked_unwrap.rs:88:9\n    |\n-59 |     if x.is_ok() || !(y.is_ok() && z.is_err()) {\n+77 |     if x.is_ok() || !(y.is_ok() && z.is_err()) {\n    |                                    ---------- the check is happening here\n ...\n-64 |         z.unwrap_err();\n+88 |         z.unwrap_err(); // unnecessary\n    |         ^^^^^^^^^^^^^^\n \n error: You checked before that `unwrap()` cannot fail. Instead of checking and unwrapping, it's better to use `if let` or `match`.\n-  --> $DIR/checked_unwrap.rs:72:13\n+  --> $DIR/checked_unwrap.rs:96:13\n    |\n-71 |         if x.is_some() {\n+95 |         if x.is_some() {\n    |            ----------- the check is happening here\n-72 |             x.unwrap();\n+96 |             x.unwrap(); // unnecessary\n+   |             ^^^^^^^^^^\n+\n+error: This call to `unwrap()` will always panic.\n+  --> $DIR/checked_unwrap.rs:98:13\n+   |\n+95 |         if x.is_some() {\n+   |            ----------- because of this check\n+...\n+98 |             x.unwrap(); // will panic\n    |             ^^^^^^^^^^\n \n-error: aborting due to 17 previous errors\n+error: aborting due to 34 previous errors\n "}]}