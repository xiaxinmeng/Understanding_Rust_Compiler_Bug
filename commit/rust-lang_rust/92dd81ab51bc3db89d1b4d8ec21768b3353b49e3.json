{"sha": "92dd81ab51bc3db89d1b4d8ec21768b3353b49e3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjkyZGQ4MWFiNTFiYzNkYjg5ZDFiNGQ4ZWMyMTc2OGIzMzUzYjQ5ZTM=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-10-25T08:47:46Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-10-25T08:47:46Z"}, "message": "Auto merge of #29272 - sanxiyn:llvm-update, r=alexcrichton\n\ncc @zazdxscf", "tree": {"sha": "b76987ca9910da7c3e8bc71643d20b0f1fb4d5cc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b76987ca9910da7c3e8bc71643d20b0f1fb4d5cc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/92dd81ab51bc3db89d1b4d8ec21768b3353b49e3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/92dd81ab51bc3db89d1b4d8ec21768b3353b49e3", "html_url": "https://github.com/rust-lang/rust/commit/92dd81ab51bc3db89d1b4d8ec21768b3353b49e3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/92dd81ab51bc3db89d1b4d8ec21768b3353b49e3/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "49b232edaf09970cba682750c217db9603f8582e", "url": "https://api.github.com/repos/rust-lang/rust/commits/49b232edaf09970cba682750c217db9603f8582e", "html_url": "https://github.com/rust-lang/rust/commit/49b232edaf09970cba682750c217db9603f8582e"}, {"sha": "b285f9202590050a7b480a99a074673630b11f4f", "url": "https://api.github.com/repos/rust-lang/rust/commits/b285f9202590050a7b480a99a074673630b11f4f", "html_url": "https://github.com/rust-lang/rust/commit/b285f9202590050a7b480a99a074673630b11f4f"}], "stats": {"total": 28, "additions": 28, "deletions": 0}, "files": [{"sha": "2cf6277e0572275481ec6aa02a7c93a52c0a1ee6", "filename": "src/rustllvm/ArchiveWrapper.cpp", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/92dd81ab51bc3db89d1b4d8ec21768b3353b49e3/src%2Frustllvm%2FArchiveWrapper.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/92dd81ab51bc3db89d1b4d8ec21768b3353b49e3/src%2Frustllvm%2FArchiveWrapper.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2FArchiveWrapper.cpp?ref=92dd81ab51bc3db89d1b4d8ec21768b3353b49e3", "patch": "@@ -163,12 +163,20 @@ LLVMRustWriteArchive(char *Dst,\n     auto Member = NewMembers[i];\n     assert(Member->name);\n     if (Member->filename) {\n+#if LLVM_VERSION_MINOR >= 8\n+      Members.push_back(NewArchiveIterator(Member->filename));\n+#else\n       Members.push_back(NewArchiveIterator(Member->filename, Member->name));\n+#endif\n     } else {\n       Members.push_back(NewArchiveIterator(Member->child, Member->name));\n     }\n   }\n+#if LLVM_VERSION_MINOR >= 8\n+  auto pair = writeArchive(Dst, Members, WriteSymbtab, Kind, true, false);\n+#else\n   auto pair = writeArchive(Dst, Members, WriteSymbtab, Kind, true);\n+#endif\n   if (!pair.second)\n     return 0;\n   LLVMRustSetLastError(pair.second.message().c_str());"}, {"sha": "b27a622136f749f90ea50a70e3c459afe7517cf1", "filename": "src/rustllvm/PassWrapper.cpp", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/92dd81ab51bc3db89d1b4d8ec21768b3353b49e3/src%2Frustllvm%2FPassWrapper.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/92dd81ab51bc3db89d1b4d8ec21768b3353b49e3/src%2Frustllvm%2FPassWrapper.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2FPassWrapper.cpp?ref=92dd81ab51bc3db89d1b4d8ec21768b3353b49e3", "patch": "@@ -49,7 +49,9 @@ LLVMInitializePasses() {\n   initializeVectorization(Registry);\n   initializeIPO(Registry);\n   initializeAnalysis(Registry);\n+#if LLVM_VERSION_MINOR <= 7\n   initializeIPA(Registry);\n+#endif\n   initializeTransformUtils(Registry);\n   initializeInstCombine(Registry);\n   initializeInstrumentation(Registry);"}, {"sha": "5a9c096e5f54339499bbe8a5a14af16c7a8efd6a", "filename": "src/rustllvm/RustWrapper.cpp", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/92dd81ab51bc3db89d1b4d8ec21768b3353b49e3/src%2Frustllvm%2FRustWrapper.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/92dd81ab51bc3db89d1b4d8ec21768b3353b49e3/src%2Frustllvm%2FRustWrapper.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2FRustWrapper.cpp?ref=92dd81ab51bc3db89d1b4d8ec21768b3353b49e3", "patch": "@@ -320,7 +320,9 @@ extern \"C\" LLVMMetadataRef LLVMDIBuilderCreateSubroutineType(\n     LLVMMetadataRef File,\n     LLVMMetadataRef ParameterTypes) {\n     return wrap(Builder->createSubroutineType(\n+#if LLVM_VERSION_MINOR <= 7\n         unwrapDI<DIFile>(File),\n+#endif\n #if LLVM_VERSION_MINOR >= 7\n         DITypeRefArray(unwrap<MDTuple>(ParameterTypes))));\n #elif LLVM_VERSION_MINOR >= 6\n@@ -502,11 +504,27 @@ extern \"C\" LLVMMetadataRef LLVMDIBuilderCreateVariable(\n         ));\n     }\n #endif\n+#if LLVM_VERSION_MINOR >= 8\n+    if (Tag == 0x100) { // DW_TAG_auto_variable\n+        return wrap(Builder->createAutoVariable(\n+            unwrapDI<DIDescriptor>(Scope), Name,\n+            unwrapDI<DIFile>(File),\n+            LineNo,\n+            unwrapDI<DIType>(Ty), AlwaysPreserve, Flags));\n+    } else {\n+        return wrap(Builder->createParameterVariable(\n+            unwrapDI<DIDescriptor>(Scope), Name, ArgNo,\n+            unwrapDI<DIFile>(File),\n+            LineNo,\n+            unwrapDI<DIType>(Ty), AlwaysPreserve, Flags));\n+    }\n+#else\n     return wrap(Builder->createLocalVariable(Tag,\n         unwrapDI<DIDescriptor>(Scope), Name,\n         unwrapDI<DIFile>(File),\n         LineNo,\n         unwrapDI<DIType>(Ty), AlwaysPreserve, Flags, ArgNo));\n+#endif\n }\n \n extern \"C\" LLVMMetadataRef LLVMDIBuilderCreateArrayType("}]}