{"sha": "43756b6e4dda9c46265aa79c98163ff7ef915274", "node_id": "C_kwDOAAsO6NoAKDQzNzU2YjZlNGRkYTljNDYyNjVhYTc5Yzk4MTYzZmY3ZWY5MTUyNzQ", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-05-06T16:14:11Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-05-06T16:14:11Z"}, "message": "Auto merge of #8793 - Alexendoo:dev-lint-extra-args, r=xFrednet\n\nPass through extra args in `cargo dev lint`\n\nchangelog: Pass through extra args in `cargo dev lint`\n\nLets you pass some useful flags through, like `-A/W/etc`, `--fix`, `--force-warn`", "tree": {"sha": "1dc0e1d980a28b6d3cb093f2e36b57705ce0ed76", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1dc0e1d980a28b6d3cb093f2e36b57705ce0ed76"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/43756b6e4dda9c46265aa79c98163ff7ef915274", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/43756b6e4dda9c46265aa79c98163ff7ef915274", "html_url": "https://github.com/rust-lang/rust/commit/43756b6e4dda9c46265aa79c98163ff7ef915274", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/43756b6e4dda9c46265aa79c98163ff7ef915274/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1594e986ea76c53290f1d85118b65ba03137df8c", "url": "https://api.github.com/repos/rust-lang/rust/commits/1594e986ea76c53290f1d85118b65ba03137df8c", "html_url": "https://github.com/rust-lang/rust/commit/1594e986ea76c53290f1d85118b65ba03137df8c"}, {"sha": "905a95171894826c58b1f731780f6df7b9b5eef0", "url": "https://api.github.com/repos/rust-lang/rust/commits/905a95171894826c58b1f731780f6df7b9b5eef0", "html_url": "https://github.com/rust-lang/rust/commit/905a95171894826c58b1f731780f6df7b9b5eef0"}], "stats": {"total": 20, "additions": 18, "deletions": 2}, "files": [{"sha": "9e463aa741c758d7bdf3023d6eff1b0f4d353ba6", "filename": "clippy_dev/src/lint.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/43756b6e4dda9c46265aa79c98163ff7ef915274/clippy_dev%2Fsrc%2Flint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/43756b6e4dda9c46265aa79c98163ff7ef915274/clippy_dev%2Fsrc%2Flint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Flint.rs?ref=43756b6e4dda9c46265aa79c98163ff7ef915274", "patch": "@@ -13,7 +13,7 @@ fn exit_if_err(status: io::Result<ExitStatus>) {\n     }\n }\n \n-pub fn run(path: &str) {\n+pub fn run<'a>(path: &str, args: impl Iterator<Item = &'a str>) {\n     let is_file = match fs::metadata(path) {\n         Ok(metadata) => metadata.is_file(),\n         Err(e) => {\n@@ -30,6 +30,7 @@ pub fn run(path: &str) {\n                 .args([\"-Z\", \"no-codegen\"])\n                 .args([\"--edition\", \"2021\"])\n                 .arg(path)\n+                .args(args)\n                 .status(),\n         );\n     } else {\n@@ -42,6 +43,8 @@ pub fn run(path: &str) {\n             .expect(\"failed to create tempdir\");\n \n         let status = Command::new(cargo_clippy_path())\n+            .arg(\"clippy\")\n+            .args(args)\n             .current_dir(path)\n             .env(\"CARGO_TARGET_DIR\", target.as_ref())\n             .status();"}, {"sha": "dcfaabbc204bb0a33f0e5ca884c88eadf54f18af", "filename": "clippy_dev/src/main.rs", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/43756b6e4dda9c46265aa79c98163ff7ef915274/clippy_dev%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/43756b6e4dda9c46265aa79c98163ff7ef915274/clippy_dev%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Fmain.rs?ref=43756b6e4dda9c46265aa79c98163ff7ef915274", "patch": "@@ -76,7 +76,8 @@ fn main() {\n         },\n         (\"lint\", Some(matches)) => {\n             let path = matches.value_of(\"path\").unwrap();\n-            lint::run(path);\n+            let args = matches.values_of(\"args\").into_iter().flatten();\n+            lint::run(path, args);\n         },\n         (\"rename_lint\", Some(matches)) => {\n             let old_name = matches.value_of(\"old_name\").unwrap();\n@@ -278,11 +279,23 @@ fn get_clap_config<'a>() -> ArgMatches<'a> {\n                         Lint a package directory:\n                             cargo dev lint tests/ui-cargo/wildcard_dependencies/fail\n                             cargo dev lint ~/my-project\n+\n+                        Run rustfix:\n+                            cargo dev lint ~/my-project -- --fix\n+\n+                        Set lint levels:\n+                            cargo dev lint file.rs -- -W clippy::pedantic\n+                            cargo dev lint ~/my-project -- -- -W clippy::pedantic\n                 \"})\n                 .arg(\n                     Arg::with_name(\"path\")\n                         .required(true)\n                         .help(\"The path to a file or package directory to lint\"),\n+                )\n+                .arg(\n+                    Arg::with_name(\"args\")\n+                        .multiple(true)\n+                        .help(\"Pass extra arguments to cargo/clippy-driver\"),\n                 ),\n         )\n         .subcommand("}]}