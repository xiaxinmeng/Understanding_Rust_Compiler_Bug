{"sha": "4353e44563151325557593ad6b5352cfacfe8d1c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQzNTNlNDQ1NjMxNTEzMjU1NTc1OTNhZDZiNTM1MmNmYWNmZThkMWM=", "commit": {"author": {"name": "Michael Dagitses", "email": "dagitses@google.com", "date": "2014-05-12T02:34:44Z"}, "committer": {"name": "Michael Dagitses", "email": "dagitses@google.com", "date": "2014-05-18T04:47:01Z"}, "message": "adding move_iter() function to collections::treemap::TreeSet", "tree": {"sha": "a20948b8573b39ab7644497cfa797503246bbfaf", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a20948b8573b39ab7644497cfa797503246bbfaf"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4353e44563151325557593ad6b5352cfacfe8d1c", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4353e44563151325557593ad6b5352cfacfe8d1c", "html_url": "https://github.com/rust-lang/rust/commit/4353e44563151325557593ad6b5352cfacfe8d1c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4353e44563151325557593ad6b5352cfacfe8d1c/comments", "author": null, "committer": null, "parents": [{"sha": "72fc4a5eb72b8ba96dba66400c7eecac93b0b252", "url": "https://api.github.com/repos/rust-lang/rust/commits/72fc4a5eb72b8ba96dba66400c7eecac93b0b252", "html_url": "https://github.com/rust-lang/rust/commit/72fc4a5eb72b8ba96dba66400c7eecac93b0b252"}], "stats": {"total": 37, "additions": 37, "deletions": 0}, "files": [{"sha": "bb4ca36709c258b419cde5fe8e78021f3c2c2c75", "filename": "src/libcollections/treemap.rs", "status": "modified", "additions": 37, "deletions": 0, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/4353e44563151325557593ad6b5352cfacfe8d1c/src%2Flibcollections%2Ftreemap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4353e44563151325557593ad6b5352cfacfe8d1c/src%2Flibcollections%2Ftreemap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcollections%2Ftreemap.rs?ref=4353e44563151325557593ad6b5352cfacfe8d1c", "patch": "@@ -12,6 +12,7 @@\n //! trees. The only requirement for the types is that the key implements\n //! `TotalOrd`.\n \n+use std::iter;\n use std::iter::{Peekable};\n use std::cmp::Ordering;\n use std::mem::{replace, swap};\n@@ -618,6 +619,12 @@ impl<T: TotalOrd> TreeSet<T> {\n         RevSetItems{iter: self.map.rev_iter()}\n     }\n \n+    /// Get a lazy iterator that consumes the set.\n+    #[inline]\n+    pub fn move_iter(self) -> MoveSetItems<T> {\n+        self.map.move_iter().map(|(value, _)| value)\n+    }\n+\n     /// Get a lazy iterator pointing to the first value not less than `v` (greater or equal).\n     /// If all elements in the set are less than `v` empty iterator is returned.\n     #[inline]\n@@ -665,6 +672,9 @@ pub struct RevSetItems<'a, T> {\n     iter: RevEntries<'a, T, ()>\n }\n \n+/// Lazy forward iterator over a set that consumes the set while iterating\n+pub type MoveSetItems<T> = iter::Map<'static, (T, ()), T, MoveEntries<T, ()>>;\n+\n /// Lazy iterator producing elements in the set difference (in-order)\n pub struct DifferenceItems<'a, T> {\n     a: Peekable<&'a T, SetItems<'a, T>>,\n@@ -1542,6 +1552,33 @@ mod test_set {\n         }\n     }\n \n+    #[test]\n+    fn test_move_iter() {\n+        let s: TreeSet<int> = range(0, 5).collect();\n+\n+        let mut n = 0;\n+        for x in s.move_iter() {\n+            assert_eq!(x, n);\n+            n += 1;\n+        }\n+    }\n+\n+    #[test]\n+    fn test_move_iter_size_hint() {\n+        let s: TreeSet<int> = vec!(0, 1).move_iter().collect();\n+\n+        let mut it = s.move_iter();\n+\n+        assert_eq!(it.size_hint(), (2, Some(2)));\n+        assert!(it.next() != None);\n+\n+        assert_eq!(it.size_hint(), (1, Some(1)));\n+        assert!(it.next() != None);\n+\n+        assert_eq!(it.size_hint(), (0, Some(0)));\n+        assert_eq!(it.next(), None);\n+    }\n+\n     #[test]\n     fn test_clone_eq() {\n       let mut m = TreeSet::new();"}]}