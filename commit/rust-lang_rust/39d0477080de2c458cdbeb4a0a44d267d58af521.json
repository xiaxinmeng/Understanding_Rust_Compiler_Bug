{"sha": "39d0477080de2c458cdbeb4a0a44d267d58af521", "node_id": "C_kwDOAAsO6NoAKDM5ZDA0NzcwODBkZTJjNDU4Y2RiZWI0YTBhNDRkMjY3ZDU4YWY1MjE", "commit": {"author": {"name": "koka", "email": "koka.code@gmail.com", "date": "2022-11-27T13:41:06Z"}, "committer": {"name": "koka", "email": "koka.code@gmail.com", "date": "2022-11-27T13:41:06Z"}, "message": "Refactor BytePos handling", "tree": {"sha": "9dd762095fd01789f9e70352ee9fc2d709f1a573", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9dd762095fd01789f9e70352ee9fc2d709f1a573"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/39d0477080de2c458cdbeb4a0a44d267d58af521", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYIAB0WIQTeiB5r8ReBHCJcHiKlkXpAaXd0zQUCY4NpDAAKCRClkXpAaXd0\nzbqtAQCYnmZJVlFz/lgjekYj5OT1Wvzx4Q+ZrMOgE0stitLJBAD/a3IJHh4SaycX\nHJxl1cv+kvGC/QkbnkUtEAJmaIXGKgU=\n=x+hi\n-----END PGP SIGNATURE-----", "payload": "tree 9dd762095fd01789f9e70352ee9fc2d709f1a573\nparent 8c50dfb54649cbd67e37e7a456e736241740666d\nauthor koka <koka.code@gmail.com> 1669556466 +0900\ncommitter koka <koka.code@gmail.com> 1669556466 +0900\n\nRefactor BytePos handling\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/39d0477080de2c458cdbeb4a0a44d267d58af521", "html_url": "https://github.com/rust-lang/rust/commit/39d0477080de2c458cdbeb4a0a44d267d58af521", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/39d0477080de2c458cdbeb4a0a44d267d58af521/comments", "author": {"login": "koka831", "id": 14945055, "node_id": "MDQ6VXNlcjE0OTQ1MDU1", "avatar_url": "https://avatars.githubusercontent.com/u/14945055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/koka831", "html_url": "https://github.com/koka831", "followers_url": "https://api.github.com/users/koka831/followers", "following_url": "https://api.github.com/users/koka831/following{/other_user}", "gists_url": "https://api.github.com/users/koka831/gists{/gist_id}", "starred_url": "https://api.github.com/users/koka831/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/koka831/subscriptions", "organizations_url": "https://api.github.com/users/koka831/orgs", "repos_url": "https://api.github.com/users/koka831/repos", "events_url": "https://api.github.com/users/koka831/events{/privacy}", "received_events_url": "https://api.github.com/users/koka831/received_events", "type": "User", "site_admin": false}, "committer": {"login": "koka831", "id": 14945055, "node_id": "MDQ6VXNlcjE0OTQ1MDU1", "avatar_url": "https://avatars.githubusercontent.com/u/14945055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/koka831", "html_url": "https://github.com/koka831", "followers_url": "https://api.github.com/users/koka831/followers", "following_url": "https://api.github.com/users/koka831/following{/other_user}", "gists_url": "https://api.github.com/users/koka831/gists{/gist_id}", "starred_url": "https://api.github.com/users/koka831/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/koka831/subscriptions", "organizations_url": "https://api.github.com/users/koka831/orgs", "repos_url": "https://api.github.com/users/koka831/repos", "events_url": "https://api.github.com/users/koka831/events{/privacy}", "received_events_url": "https://api.github.com/users/koka831/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8c50dfb54649cbd67e37e7a456e736241740666d", "url": "https://api.github.com/repos/rust-lang/rust/commits/8c50dfb54649cbd67e37e7a456e736241740666d", "html_url": "https://github.com/rust-lang/rust/commit/8c50dfb54649cbd67e37e7a456e736241740666d"}], "stats": {"total": 5, "additions": 2, "deletions": 3}, "files": [{"sha": "81143d7799ea8aa585f2e023b3cb9d3560dfd22f", "filename": "clippy_lints/src/returns.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/39d0477080de2c458cdbeb4a0a44d267d58af521/clippy_lints%2Fsrc%2Freturns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/39d0477080de2c458cdbeb4a0a44d267d58af521/clippy_lints%2Fsrc%2Freturns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Freturns.rs?ref=39d0477080de2c458cdbeb4a0a44d267d58af521", "patch": "@@ -12,7 +12,7 @@ use rustc_middle::lint::in_external_macro;\n use rustc_middle::ty::subst::GenericArgKind;\n use rustc_session::{declare_lint_pass, declare_tool_lint};\n use rustc_span::source_map::Span;\n-use rustc_span::BytePos;\n+use rustc_span::{BytePos, Pos};\n \n declare_clippy_lint! {\n     /// ### What it does\n@@ -293,13 +293,12 @@ fn last_statement_borrows<'tcx>(cx: &LateContext<'tcx>, expr: &'tcx Expr<'tcx>)\n }\n \n // Go backwards while encountering whitespace and extend the given Span to that point.\n-#[expect(clippy::cast_possible_truncation)]\n fn extend_span_to_previous_non_ws(cx: &LateContext<'_>, sp: Span) -> Span {\n     if let Ok(prev_source) = cx.sess().source_map().span_to_prev_source(sp) {\n         let ws = [' ', '\\t', '\\n'];\n         if let Some(non_ws_pos) = prev_source.rfind(|c| !ws.contains(&c)) {\n             let len = prev_source.len() - non_ws_pos - 1;\n-            return sp.with_lo(BytePos(sp.lo().0 - len as u32));\n+            return sp.with_lo(sp.lo() - BytePos::from_usize(len));\n         }\n     }\n "}]}