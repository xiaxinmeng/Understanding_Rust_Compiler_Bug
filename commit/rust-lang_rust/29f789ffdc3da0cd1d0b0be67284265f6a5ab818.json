{"sha": "29f789ffdc3da0cd1d0b0be67284265f6a5ab818", "node_id": "C_kwDOAAsO6NoAKDI5Zjc4OWZmZGMzZGEwY2QxZDBiMGJlNjcyODQyNjVmNmE1YWI4MTg", "commit": {"author": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2022-09-12T19:48:22Z"}, "committer": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2022-09-12T19:48:22Z"}, "message": "rustdoc: fix treatment of backslash-escaped HTML\n\nTry generating HTML for this markup:\n\n    \\<a href=\"https://example.com\">example</a>\n\nIt will produce text, not HTML, in both rustdoc's real HTML output and in\nthe commonmark reference implementation:\n\nhttps://spec.commonmark.org/dingus/?text=%5C%3Ca%20href%3D%22https%3A%2F%2Fexample.com%22%3Eexample%3C%2Fa%3E", "tree": {"sha": "f725ade3aab8c650d32083d7279eb578c7adbf51", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f725ade3aab8c650d32083d7279eb578c7adbf51"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/29f789ffdc3da0cd1d0b0be67284265f6a5ab818", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/29f789ffdc3da0cd1d0b0be67284265f6a5ab818", "html_url": "https://github.com/rust-lang/rust/commit/29f789ffdc3da0cd1d0b0be67284265f6a5ab818", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/29f789ffdc3da0cd1d0b0be67284265f6a5ab818/comments", "author": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "committer": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "98e1f041b6e33598a18edb928ec9db93a850c6cb", "url": "https://api.github.com/repos/rust-lang/rust/commits/98e1f041b6e33598a18edb928ec9db93a850c6cb", "html_url": "https://github.com/rust-lang/rust/commit/98e1f041b6e33598a18edb928ec9db93a850c6cb"}], "stats": {"total": 17, "additions": 15, "deletions": 2}, "files": [{"sha": "5cea9def2d96641432e4f33e188f2f3b6a606055", "filename": "src/librustdoc/passes/html_tags.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/29f789ffdc3da0cd1d0b0be67284265f6a5ab818/src%2Flibrustdoc%2Fpasses%2Fhtml_tags.rs", "raw_url": "https://github.com/rust-lang/rust/raw/29f789ffdc3da0cd1d0b0be67284265f6a5ab818/src%2Flibrustdoc%2Fpasses%2Fhtml_tags.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fhtml_tags.rs?ref=29f789ffdc3da0cd1d0b0be67284265f6a5ab818", "patch": "@@ -278,7 +278,7 @@ impl<'a, 'tcx> DocVisitor for InvalidHtmlTagsLinter<'a, 'tcx> {\n             for (event, range) in p {\n                 match event {\n                     Event::Start(Tag::CodeBlock(_)) => in_code_block = true,\n-                    Event::Html(text) | Event::Text(text) if !in_code_block => {\n+                    Event::Html(text) if !in_code_block => {\n                         extract_tags(&mut tags, &text, range, &mut is_in_comment, &report_diag)\n                     }\n                     Event::End(Tag::CodeBlock(_)) => in_code_block = false,"}, {"sha": "317f1fd1d46411a54c72db058aff165868ada5ad", "filename": "src/test/rustdoc-ui/invalid-html-tags.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/29f789ffdc3da0cd1d0b0be67284265f6a5ab818/src%2Ftest%2Frustdoc-ui%2Finvalid-html-tags.rs", "raw_url": "https://github.com/rust-lang/rust/raw/29f789ffdc3da0cd1d0b0be67284265f6a5ab818/src%2Ftest%2Frustdoc-ui%2Finvalid-html-tags.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Finvalid-html-tags.rs?ref=29f789ffdc3da0cd1d0b0be67284265f6a5ab818", "patch": "@@ -114,3 +114,10 @@ pub fn k() {}\n /// Web Components style </unopened-tag>\n //~^ ERROR unopened HTML tag `unopened-tag`\n pub fn m() {}\n+\n+/// backslashed \\<a href=\"\">\n+pub fn no_error_1() {}\n+\n+/// backslashed \\<<a href=\"\">\n+//~^ ERROR unclosed HTML tag `a`\n+pub fn p() {}"}, {"sha": "9c2bfcf2c3dd71af45e36cc2265a68fc5f0684f4", "filename": "src/test/rustdoc-ui/invalid-html-tags.stderr", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/29f789ffdc3da0cd1d0b0be67284265f6a5ab818/src%2Ftest%2Frustdoc-ui%2Finvalid-html-tags.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29f789ffdc3da0cd1d0b0be67284265f6a5ab818/src%2Ftest%2Frustdoc-ui%2Finvalid-html-tags.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Finvalid-html-tags.stderr?ref=29f789ffdc3da0cd1d0b0be67284265f6a5ab818", "patch": "@@ -94,5 +94,11 @@ error: unclosed HTML tag `dashed-tags`\n LL | /// Web Components style <dashed-tags>\n    |                          ^^^^^^^^^^^^^\n \n-error: aborting due to 15 previous errors\n+error: unclosed HTML tag `a`\n+  --> $DIR/invalid-html-tags.rs:121:19\n+   |\n+LL | /// backslashed \\<<a href=\"\">\n+   |                   ^^\n+\n+error: aborting due to 16 previous errors\n "}]}