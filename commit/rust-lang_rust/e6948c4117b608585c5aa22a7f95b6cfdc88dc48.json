{"sha": "e6948c4117b608585c5aa22a7f95b6cfdc88dc48", "node_id": "C_kwDOAAsO6NoAKGU2OTQ4YzQxMTdiNjA4NTg1YzVhYTIyYTdmOTViNmNmZGM4OGRjNDg", "commit": {"author": {"name": "xFrednet", "email": "xFrednet@gmail.com", "date": "2022-12-06T18:07:18Z"}, "committer": {"name": "xFrednet", "email": "xFrednet@gmail.com", "date": "2023-01-12T11:16:08Z"}, "message": "Last PR adjustments", "tree": {"sha": "d1632e7c7bd08e1c4bffb044fb6359cfe38b82b0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d1632e7c7bd08e1c4bffb044fb6359cfe38b82b0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e6948c4117b608585c5aa22a7f95b6cfdc88dc48", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEwgBEOx3xlHwII7PG9cWdDmaeUwIFAmO/6/gACgkQ9cWdDmae\nUwKwWA//QO//epRD6SOaT63YtJxpEE5tLxFMXAd0YQLGtsnE02pBVbta21pGtP0L\nIDJsEcxfgHE47bD9h9FAZMbLoceVtramX+lDURDK4nQ1EP+byaMIN0k3XfQeCD4X\nhOctYETozJbhjH6BuPf8MnILJE4LItS922RCSpD+jyPOO2jbFnkS/k6wwjTPEhgT\n1ifFPN6o0PZn59RMYCtdRPei/3DORbQRfUNPnmNCFF4mRpPsNnBJodCIm+fbWnJb\nU06P5lZsS5DQZ5et2nrashBA8ezB+8ZsupD8oVAofIessgwuj5/hwRxr4T0Ai3J/\ns/NL9VgzUuYQXgTduTx81TNrcWVYiwQJINixmub5QBLw0KvuT+71iXA3Wg1dBFiX\nTM131PNPzDL+A+ZUuGeYsJx1vPFupxxsmyniWaxAfNwJJhIDockN5rZINwdzm76D\njcPREgVDkIzKH2GZLgRIK5IXGZXrQlhTBgCFJY1PdBSOKvO6k9fvVVRWu7pEP4pD\nw/XoiIXpQ6CrFncPLnnf/8J8TJrgJF5mX/lgdOPfBJyKgvAGTYSnz0fD9Pe1MZ8u\nFA1uRhppXL/Rwf9j1bVX2KTRUKwoc3+6SB1C4fVCJt1WXSND+J6qbyKpeEPf9pTc\nhpNuyGqL78O9mOezyUTLSWbtS/ear+Ix5wgu+DOWSG7WqHlXbIY=\n=eOuz\n-----END PGP SIGNATURE-----", "payload": "tree d1632e7c7bd08e1c4bffb044fb6359cfe38b82b0\nparent fcdd08badf90665832939ccd30dc6df3194dd8a4\nauthor xFrednet <xFrednet@gmail.com> 1670350038 +0100\ncommitter xFrednet <xFrednet@gmail.com> 1673522168 +0100\n\nLast PR adjustments\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e6948c4117b608585c5aa22a7f95b6cfdc88dc48", "html_url": "https://github.com/rust-lang/rust/commit/e6948c4117b608585c5aa22a7f95b6cfdc88dc48", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e6948c4117b608585c5aa22a7f95b6cfdc88dc48/comments", "author": {"login": "xFrednet", "id": 17087237, "node_id": "MDQ6VXNlcjE3MDg3MjM3", "avatar_url": "https://avatars.githubusercontent.com/u/17087237?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xFrednet", "html_url": "https://github.com/xFrednet", "followers_url": "https://api.github.com/users/xFrednet/followers", "following_url": "https://api.github.com/users/xFrednet/following{/other_user}", "gists_url": "https://api.github.com/users/xFrednet/gists{/gist_id}", "starred_url": "https://api.github.com/users/xFrednet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xFrednet/subscriptions", "organizations_url": "https://api.github.com/users/xFrednet/orgs", "repos_url": "https://api.github.com/users/xFrednet/repos", "events_url": "https://api.github.com/users/xFrednet/events{/privacy}", "received_events_url": "https://api.github.com/users/xFrednet/received_events", "type": "User", "site_admin": false}, "committer": {"login": "xFrednet", "id": 17087237, "node_id": "MDQ6VXNlcjE3MDg3MjM3", "avatar_url": "https://avatars.githubusercontent.com/u/17087237?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xFrednet", "html_url": "https://github.com/xFrednet", "followers_url": "https://api.github.com/users/xFrednet/followers", "following_url": "https://api.github.com/users/xFrednet/following{/other_user}", "gists_url": "https://api.github.com/users/xFrednet/gists{/gist_id}", "starred_url": "https://api.github.com/users/xFrednet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xFrednet/subscriptions", "organizations_url": "https://api.github.com/users/xFrednet/orgs", "repos_url": "https://api.github.com/users/xFrednet/repos", "events_url": "https://api.github.com/users/xFrednet/events{/privacy}", "received_events_url": "https://api.github.com/users/xFrednet/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fcdd08badf90665832939ccd30dc6df3194dd8a4", "url": "https://api.github.com/repos/rust-lang/rust/commits/fcdd08badf90665832939ccd30dc6df3194dd8a4", "html_url": "https://github.com/rust-lang/rust/commit/fcdd08badf90665832939ccd30dc6df3194dd8a4"}], "stats": {"total": 21, "additions": 17, "deletions": 4}, "files": [{"sha": "7a6450ffaa5ec17be291ab61e854cf91b4274919", "filename": "clippy_lints/src/casts/cast_possible_truncation.rs", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/e6948c4117b608585c5aa22a7f95b6cfdc88dc48/clippy_lints%2Fsrc%2Fcasts%2Fcast_possible_truncation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6948c4117b608585c5aa22a7f95b6cfdc88dc48/clippy_lints%2Fsrc%2Fcasts%2Fcast_possible_truncation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fcasts%2Fcast_possible_truncation.rs?ref=e6948c4117b608585c5aa22a7f95b6cfdc88dc48", "patch": "@@ -3,8 +3,6 @@ use clippy_utils::diagnostics::{span_lint, span_lint_and_then};\n use clippy_utils::expr_or_init;\n use clippy_utils::source::snippet;\n use clippy_utils::ty::{get_discriminant_value, is_isize_or_usize};\n-use rustc_ast::ast;\n-use rustc_attr::IntType;\n use rustc_errors::{Applicability, SuggestionStyle};\n use rustc_hir::def::{DefKind, Res};\n use rustc_hir::{BinOpKind, Expr, ExprKind};\n@@ -157,8 +155,8 @@ pub(super) fn check(cx: &LateContext<'_>, expr: &Expr<'_>, cast_expr: &Expr<'_>,\n         _ => return,\n     };\n \n-    let snippet = snippet(cx, expr.span, \"x\");\n-    let name_of_cast_from = snippet.split(\" as\").next().unwrap_or(\"x\");\n+    let snippet = snippet(cx, expr.span, \"..\");\n+    let name_of_cast_from = snippet.split(\" as\").next().unwrap_or(\"..\");\n     let suggestion = format!(\"{cast_to}::try_from({name_of_cast_from})\");\n \n     span_lint_and_then(cx, CAST_POSSIBLE_TRUNCATION, expr.span, &msg, |diag| {"}, {"sha": "64dbe6c224c7d3a33b066e312805b4bd7e42ab2f", "filename": "clippy_lints/src/casts/mod.rs", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/e6948c4117b608585c5aa22a7f95b6cfdc88dc48/clippy_lints%2Fsrc%2Fcasts%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6948c4117b608585c5aa22a7f95b6cfdc88dc48/clippy_lints%2Fsrc%2Fcasts%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fcasts%2Fmod.rs?ref=e6948c4117b608585c5aa22a7f95b6cfdc88dc48", "patch": "@@ -94,6 +94,21 @@ declare_clippy_lint! {\n     ///     x as u8\n     /// }\n     /// ```\n+    /// Use instead:\n+    /// ```\n+    /// fn as_u8(x: u64) -> u8 {\n+    ///     if let Ok(x) = u8::try_from(x) {\n+    ///         x\n+    ///     } else {\n+    ///         todo!();\n+    ///     }\n+    /// }\n+    /// // Or\n+    /// #[allow(clippy::cast_possible_truncation)]\n+    /// fn as_u16(x: u64) -> u16 {\n+    ///     x as u16\n+    /// }\n+    /// ```\n     #[clippy::version = \"pre 1.29.0\"]\n     pub CAST_POSSIBLE_TRUNCATION,\n     pedantic,"}]}