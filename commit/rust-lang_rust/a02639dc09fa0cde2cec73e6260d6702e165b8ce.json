{"sha": "a02639dc09fa0cde2cec73e6260d6702e165b8ce", "node_id": "C_kwDOAAsO6NoAKGEwMjYzOWRjMDlmYTBjZGUyY2VjNzNlNjI2MGQ2NzAyZTE2NWI4Y2U", "commit": {"author": {"name": "Ian Douglas Scott", "email": "ian@iandouglasscott.com", "date": "2021-04-28T04:05:26Z"}, "committer": {"name": "Ian Douglas Scott", "email": "idscott@system76.com", "date": "2022-01-07T20:28:47Z"}, "message": "Implement `TryFrom<char>` for `u8`\n\nPreviously suggested in https://github.com/rust-lang/rfcs/issues/2854.\n\nIt makes sense to have this since `char` implements `From<u8>`. Likewise\n`u32`, `u64`, and `u128` (since #79502) implement `From<char>`.", "tree": {"sha": "57928649c0153e1430b43c8321f382440156a168", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/57928649c0153e1430b43c8321f382440156a168"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a02639dc09fa0cde2cec73e6260d6702e165b8ce", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a02639dc09fa0cde2cec73e6260d6702e165b8ce", "html_url": "https://github.com/rust-lang/rust/commit/a02639dc09fa0cde2cec73e6260d6702e165b8ce", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a02639dc09fa0cde2cec73e6260d6702e165b8ce/comments", "author": {"login": "ids1024", "id": 2263150, "node_id": "MDQ6VXNlcjIyNjMxNTA=", "avatar_url": "https://avatars.githubusercontent.com/u/2263150?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ids1024", "html_url": "https://github.com/ids1024", "followers_url": "https://api.github.com/users/ids1024/followers", "following_url": "https://api.github.com/users/ids1024/following{/other_user}", "gists_url": "https://api.github.com/users/ids1024/gists{/gist_id}", "starred_url": "https://api.github.com/users/ids1024/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ids1024/subscriptions", "organizations_url": "https://api.github.com/users/ids1024/orgs", "repos_url": "https://api.github.com/users/ids1024/repos", "events_url": "https://api.github.com/users/ids1024/events{/privacy}", "received_events_url": "https://api.github.com/users/ids1024/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ids1024", "id": 2263150, "node_id": "MDQ6VXNlcjIyNjMxNTA=", "avatar_url": "https://avatars.githubusercontent.com/u/2263150?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ids1024", "html_url": "https://github.com/ids1024", "followers_url": "https://api.github.com/users/ids1024/followers", "following_url": "https://api.github.com/users/ids1024/following{/other_user}", "gists_url": "https://api.github.com/users/ids1024/gists{/gist_id}", "starred_url": "https://api.github.com/users/ids1024/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ids1024/subscriptions", "organizations_url": "https://api.github.com/users/ids1024/orgs", "repos_url": "https://api.github.com/users/ids1024/repos", "events_url": "https://api.github.com/users/ids1024/events{/privacy}", "received_events_url": "https://api.github.com/users/ids1024/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e012a191d768adeda1ee36a99ef8b92d51920154", "url": "https://api.github.com/repos/rust-lang/rust/commits/e012a191d768adeda1ee36a99ef8b92d51920154", "html_url": "https://github.com/rust-lang/rust/commit/e012a191d768adeda1ee36a99ef8b92d51920154"}], "stats": {"total": 30, "additions": 30, "deletions": 0}, "files": [{"sha": "1774ddd7cbb2cde9e61ff732a8f25860b798c0f9", "filename": "library/core/src/char/convert.rs", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/a02639dc09fa0cde2cec73e6260d6702e165b8ce/library%2Fcore%2Fsrc%2Fchar%2Fconvert.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a02639dc09fa0cde2cec73e6260d6702e165b8ce/library%2Fcore%2Fsrc%2Fchar%2Fconvert.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fchar%2Fconvert.rs?ref=a02639dc09fa0cde2cec73e6260d6702e165b8ce", "patch": "@@ -1,5 +1,6 @@\n //! Character conversions.\n \n+use crate::char::TryFromCharError;\n use crate::convert::TryFrom;\n use crate::fmt;\n use crate::mem::transmute;\n@@ -166,6 +167,20 @@ impl const From<char> for u128 {\n     }\n }\n \n+/// Map `char` with code point in U+0000..=U+00FF to byte in 0x00..=0xFF with same value, failing\n+/// if the code point is greater than U+00FF.\n+///\n+/// See [`impl From<u8> for char`](char#impl-From<u8>) for details on the encoding.\n+#[stable(feature = \"u8_from_char\", since = \"1.59.0\")]\n+impl TryFrom<char> for u8 {\n+    type Error = TryFromCharError;\n+\n+    #[inline]\n+    fn try_from(c: char) -> Result<u8, Self::Error> {\n+        u8::try_from(u32::from(c)).map_err(|_| TryFromCharError(()))\n+    }\n+}\n+\n /// Maps a byte in 0x00..=0xFF to a `char` whose code point has the same value, in U+0000..=U+00FF.\n ///\n /// Unicode is designed such that this effectively decodes bytes"}, {"sha": "f65f84e93aebe6a369fa9c7d27d6d405ba49903e", "filename": "library/core/src/char/mod.rs", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/a02639dc09fa0cde2cec73e6260d6702e165b8ce/library%2Fcore%2Fsrc%2Fchar%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a02639dc09fa0cde2cec73e6260d6702e165b8ce/library%2Fcore%2Fsrc%2Fchar%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fchar%2Fmod.rs?ref=a02639dc09fa0cde2cec73e6260d6702e165b8ce", "patch": "@@ -544,3 +544,15 @@ impl fmt::Display for ToUppercase {\n         fmt::Display::fmt(&self.0, f)\n     }\n }\n+\n+/// The error type returned when a checked char conversion fails.\n+#[stable(feature = \"u8_from_char\", since = \"1.59.0\")]\n+#[derive(Debug, Copy, Clone, PartialEq, Eq)]\n+pub struct TryFromCharError(pub(crate) ());\n+\n+#[stable(feature = \"u8_from_char\", since = \"1.59.0\")]\n+impl fmt::Display for TryFromCharError {\n+    fn fmt(&self, fmt: &mut fmt::Formatter<'_>) -> fmt::Result {\n+        \"unicode code point out of range\".fmt(fmt)\n+    }\n+}"}, {"sha": "ea0c230fa42db7438021169ccac9a0dfe6d366d2", "filename": "library/std/src/error.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/a02639dc09fa0cde2cec73e6260d6702e165b8ce/library%2Fstd%2Fsrc%2Ferror.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a02639dc09fa0cde2cec73e6260d6702e165b8ce/library%2Fstd%2Fsrc%2Ferror.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Ferror.rs?ref=a02639dc09fa0cde2cec73e6260d6702e165b8ce", "patch": "@@ -478,6 +478,9 @@ impl Error for char::DecodeUtf16Error {\n     }\n }\n \n+#[stable(feature = \"u8_from_char\", since = \"1.59.0\")]\n+impl Error for char::TryFromCharError {}\n+\n #[unstable(feature = \"map_try_insert\", issue = \"82766\")]\n impl<'a, K: Debug + Ord, V: Debug> Error\n     for crate::collections::btree_map::OccupiedError<'a, K, V>"}]}