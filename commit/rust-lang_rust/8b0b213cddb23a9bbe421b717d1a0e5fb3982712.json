{"sha": "8b0b213cddb23a9bbe421b717d1a0e5fb3982712", "node_id": "C_kwDOAAsO6NoAKDhiMGIyMTNjZGRiMjNhOWJiZTQyMWI3MTdkMWEwZTVmYjM5ODI3MTI", "commit": {"author": {"name": "Yacin Tmimi", "email": "yacintmimi@gmail.com", "date": "2021-12-10T04:17:43Z"}, "committer": {"name": "Caleb Cartwright", "email": "calebcartwright@users.noreply.github.com", "date": "2022-01-29T18:20:34Z"}, "message": "Prevent adding trailing whitespace when rewriting ast::Param\n\nFixes 5125\n\nPreviously, a newline was always added, even if the parameter name was\nnot preceded by any param attrs.\n\nNow a newline is only added if there were param attrs.", "tree": {"sha": "328e89d4cf0e2fd52e916c2f58a149e43bcaaa30", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/328e89d4cf0e2fd52e916c2f58a149e43bcaaa30"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8b0b213cddb23a9bbe421b717d1a0e5fb3982712", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8b0b213cddb23a9bbe421b717d1a0e5fb3982712", "html_url": "https://github.com/rust-lang/rust/commit/8b0b213cddb23a9bbe421b717d1a0e5fb3982712", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8b0b213cddb23a9bbe421b717d1a0e5fb3982712/comments", "author": {"login": "ytmimi", "id": 29028348, "node_id": "MDQ6VXNlcjI5MDI4MzQ4", "avatar_url": "https://avatars.githubusercontent.com/u/29028348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytmimi", "html_url": "https://github.com/ytmimi", "followers_url": "https://api.github.com/users/ytmimi/followers", "following_url": "https://api.github.com/users/ytmimi/following{/other_user}", "gists_url": "https://api.github.com/users/ytmimi/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytmimi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytmimi/subscriptions", "organizations_url": "https://api.github.com/users/ytmimi/orgs", "repos_url": "https://api.github.com/users/ytmimi/repos", "events_url": "https://api.github.com/users/ytmimi/events{/privacy}", "received_events_url": "https://api.github.com/users/ytmimi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "calebcartwright", "id": 13042488, "node_id": "MDQ6VXNlcjEzMDQyNDg4", "avatar_url": "https://avatars.githubusercontent.com/u/13042488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/calebcartwright", "html_url": "https://github.com/calebcartwright", "followers_url": "https://api.github.com/users/calebcartwright/followers", "following_url": "https://api.github.com/users/calebcartwright/following{/other_user}", "gists_url": "https://api.github.com/users/calebcartwright/gists{/gist_id}", "starred_url": "https://api.github.com/users/calebcartwright/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/calebcartwright/subscriptions", "organizations_url": "https://api.github.com/users/calebcartwright/orgs", "repos_url": "https://api.github.com/users/calebcartwright/repos", "events_url": "https://api.github.com/users/calebcartwright/events{/privacy}", "received_events_url": "https://api.github.com/users/calebcartwright/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b4a4bf0bf8a16913b9f16f2aee7030065ff00931", "url": "https://api.github.com/repos/rust-lang/rust/commits/b4a4bf0bf8a16913b9f16f2aee7030065ff00931", "html_url": "https://github.com/rust-lang/rust/commit/b4a4bf0bf8a16913b9f16f2aee7030065ff00931"}], "stats": {"total": 51, "additions": 50, "deletions": 1}, "files": [{"sha": "007609aba249f691a7f02ffb20a6813b7cd1ed58", "filename": "src/items.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/8b0b213cddb23a9bbe421b717d1a0e5fb3982712/src%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8b0b213cddb23a9bbe421b717d1a0e5fb3982712/src%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fitems.rs?ref=8b0b213cddb23a9bbe421b717d1a0e5fb3982712", "patch": "@@ -2018,9 +2018,15 @@ impl Rewrite for ast::Param {\n                 {\n                     result.push_str(&ty_str);\n                 } else {\n+                    let prev_str = if param_attrs_result.is_empty() {\n+                        param_attrs_result\n+                    } else {\n+                        param_attrs_result + &shape.to_string_with_newline(context.config)\n+                    };\n+\n                     result = combine_strs_with_missing_comments(\n                         context,\n-                        &(param_attrs_result + &shape.to_string_with_newline(context.config)),\n+                        &prev_str,\n                         param_name,\n                         span,\n                         shape,"}, {"sha": "5d167932828f3f29f32158c1bd88eb86bdfeb855", "filename": "tests/target/issue-5125/attributes_in_formal_fuction_parameter.rs", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/8b0b213cddb23a9bbe421b717d1a0e5fb3982712/tests%2Ftarget%2Fissue-5125%2Fattributes_in_formal_fuction_parameter.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8b0b213cddb23a9bbe421b717d1a0e5fb3982712/tests%2Ftarget%2Fissue-5125%2Fattributes_in_formal_fuction_parameter.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-5125%2Fattributes_in_formal_fuction_parameter.rs?ref=8b0b213cddb23a9bbe421b717d1a0e5fb3982712", "patch": "@@ -0,0 +1,6 @@\n+fn foo(\n+    #[unused] a: <u16 as intercom::type_system::ExternType<\n+        intercom::type_system::AutomationTypeSystem,\n+    >>::ForeignType,\n+) {\n+}"}, {"sha": "cab20381ce8f7151359f3b227be6b0f94539ecac", "filename": "tests/target/issue-5125/long_parameter_in_different_positions.rs", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/8b0b213cddb23a9bbe421b717d1a0e5fb3982712/tests%2Ftarget%2Fissue-5125%2Flong_parameter_in_different_positions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8b0b213cddb23a9bbe421b717d1a0e5fb3982712/tests%2Ftarget%2Fissue-5125%2Flong_parameter_in_different_positions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-5125%2Flong_parameter_in_different_positions.rs?ref=8b0b213cddb23a9bbe421b717d1a0e5fb3982712", "patch": "@@ -0,0 +1,24 @@\n+fn middle(\n+    a: usize,\n+    b: <u16 as intercom::type_system::ExternType<\n+        intercom::type_system::AutomationTypeSystem,\n+    >>::ForeignType,\n+    c: bool,\n+) {\n+}\n+\n+fn last(\n+    a: usize,\n+    b: <u16 as intercom::type_system::ExternType<\n+        intercom::type_system::AutomationTypeSystem,\n+    >>::ForeignType,\n+) {\n+}\n+\n+fn first(\n+    a: <u16 as intercom::type_system::ExternType<\n+        intercom::type_system::AutomationTypeSystem,\n+    >>::ForeignType,\n+    b: usize,\n+) {\n+}"}, {"sha": "8003e66968c787c7b308b1c4bf5f58f1737a7e04", "filename": "tests/target/issue-5125/minimum_example.rs", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/8b0b213cddb23a9bbe421b717d1a0e5fb3982712/tests%2Ftarget%2Fissue-5125%2Fminimum_example.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8b0b213cddb23a9bbe421b717d1a0e5fb3982712/tests%2Ftarget%2Fissue-5125%2Fminimum_example.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-5125%2Fminimum_example.rs?ref=8b0b213cddb23a9bbe421b717d1a0e5fb3982712", "patch": "@@ -0,0 +1,6 @@\n+fn foo(\n+    a: <u16 as intercom::type_system::ExternType<\n+        intercom::type_system::AutomationTypeSystem,\n+    >>::ForeignType,\n+) {\n+}"}, {"sha": "2340b2f3472e985ca4c2b85860051de637a07e2f", "filename": "tests/target/issue-5125/with_leading_and_inline_comments.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/8b0b213cddb23a9bbe421b717d1a0e5fb3982712/tests%2Ftarget%2Fissue-5125%2Fwith_leading_and_inline_comments.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8b0b213cddb23a9bbe421b717d1a0e5fb3982712/tests%2Ftarget%2Fissue-5125%2Fwith_leading_and_inline_comments.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-5125%2Fwith_leading_and_inline_comments.rs?ref=8b0b213cddb23a9bbe421b717d1a0e5fb3982712", "patch": "@@ -0,0 +1,7 @@\n+fn foo(\n+    // Pre Comment\n+    a: <u16 as intercom::type_system::ExternType<\n+        intercom::type_system::AutomationTypeSystem,\n+    >>::ForeignType, // Inline comment\n+) {\n+}"}]}