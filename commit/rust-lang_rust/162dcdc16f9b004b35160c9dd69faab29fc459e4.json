{"sha": "162dcdc16f9b004b35160c9dd69faab29fc459e4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE2MmRjZGMxNmY5YjAwNGIzNTE2MGM5ZGQ2OWZhYWIyOWZjNDU5ZTQ=", "commit": {"author": {"name": "David Wood", "email": "david@davidtw.co", "date": "2018-11-25T12:31:34Z"}, "committer": {"name": "David Wood", "email": "david@davidtw.co", "date": "2018-12-30T13:30:58Z"}, "message": "Add user type annotations to MIR dump.\n\nThis commit writes the user type annotations to the MIR dump so that\nthey are visible again.", "tree": {"sha": "120ff2dcd3fd288b7719adb73b97374bd469a0d0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/120ff2dcd3fd288b7719adb73b97374bd469a0d0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/162dcdc16f9b004b35160c9dd69faab29fc459e4", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEWwgxPGhT5b/6kagXAXYLT59T8VQFAlwoyJIACgkQAXYLT59T\n8VQk2A//fzqPWeDKzxr8pkPzWUhvRFkhcer58MA2sPwuYXofEUf2+PSIzip25gyd\njxAw3E8/YCRxjqPFj95OUBUIRe7Smt3a6Dz37u+aZ3e8pYFaqrduEoR7fhvptrlR\n7MQm6hx1o5WtWrWQfbSXMWv7E5emWUePwvwhjCV6lyVumsqJCNqNvuRaxym9H/wX\nH06w8VVE3tonLrpCPrAa3un5xksBBtHxSXP7sQzrnTyDicEg604pLf5Wq6eRBt0s\nTqSNO1g/iGXj6AsPWGUGPVYA3oUVf3QyIzkpp5WIDQhc9iDZg+PrGBvWWLH5gajs\ntgieYMe95dXFq2JNrDbygU7DsGtYFxqVcTsHFHzCYSVdgLHQn19gGHWc/tLuGCCw\nEUcvzrtUCyAnVvuAPBBPFgaJ+DMLSHlB0VWYeM/+7RVoCwtQMK6PHUiCxO2X9tna\n8EfT8uXo4PSQB9YKOpLDJitDwlLYOgy+ZVqfEjdLEUDCrbzDdISqku+5PWu3g2kw\nzHkk8JASMv2CnjRAcPw4Y/M+XZ7AqNlLKipOicepVIkHvc/mW1jD5YfH1lBk/pxc\n0pROvWxmJ864XH17uhILSsKYVBC34ZxVEx70muXChQlIWVH7PrPIR3yDw+RVj6he\ngPFupGyMCucAffl1tcJT1QXKYdqAjUA72XW1eICWQ+VBShtxal0=\n=xHig\n-----END PGP SIGNATURE-----", "payload": "tree 120ff2dcd3fd288b7719adb73b97374bd469a0d0\nparent 4be7214d30b121762c8675c3e732083da262b136\nauthor David Wood <david@davidtw.co> 1543149094 +0100\ncommitter David Wood <david@davidtw.co> 1546176658 +0100\n\nAdd user type annotations to MIR dump.\n\nThis commit writes the user type annotations to the MIR dump so that\nthey are visible again.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/162dcdc16f9b004b35160c9dd69faab29fc459e4", "html_url": "https://github.com/rust-lang/rust/commit/162dcdc16f9b004b35160c9dd69faab29fc459e4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/162dcdc16f9b004b35160c9dd69faab29fc459e4/comments", "author": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4be7214d30b121762c8675c3e732083da262b136", "url": "https://api.github.com/repos/rust-lang/rust/commits/4be7214d30b121762c8675c3e732083da262b136", "html_url": "https://github.com/rust-lang/rust/commit/4be7214d30b121762c8675c3e732083da262b136"}], "stats": {"total": 17, "additions": 16, "deletions": 1}, "files": [{"sha": "a092c3b8ecde2c5671874d7ad4f67835a50f8eed", "filename": "src/librustc_mir/borrow_check/nll/mod.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/162dcdc16f9b004b35160c9dd69faab29fc459e4/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/162dcdc16f9b004b35160c9dd69faab29fc459e4/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fmod.rs?ref=162dcdc16f9b004b35160c9dd69faab29fc459e4", "patch": "@@ -230,13 +230,14 @@ fn dump_mir_results<'a, 'gcx, 'tcx>(\n                 // Before the CFG, dump out the values for each region variable.\n                 PassWhere::BeforeCFG => {\n                     regioncx.dump_mir(out)?;\n+                    writeln!(out, \"|\")?;\n \n                     if let Some(closure_region_requirements) = closure_region_requirements {\n-                        writeln!(out, \"|\")?;\n                         writeln!(out, \"| Free Region Constraints\")?;\n                         for_each_region_constraint(closure_region_requirements, &mut |msg| {\n                             writeln!(out, \"| {}\", msg)\n                         })?;\n+                        writeln!(out, \"|\")?;\n                     }\n                 }\n "}, {"sha": "6353eab6f6553770271e491549ce1c16cda7a1b7", "filename": "src/librustc_mir/util/pretty.rs", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/162dcdc16f9b004b35160c9dd69faab29fc459e4/src%2Flibrustc_mir%2Futil%2Fpretty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/162dcdc16f9b004b35160c9dd69faab29fc459e4/src%2Flibrustc_mir%2Futil%2Fpretty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Futil%2Fpretty.rs?ref=162dcdc16f9b004b35160c9dd69faab29fc459e4", "patch": "@@ -142,6 +142,7 @@ fn dump_matched_mir_node<'a, 'gcx, 'tcx, F>(\n         }\n         writeln!(file, \"\")?;\n         extra_data(PassWhere::BeforeCFG, &mut file)?;\n+        write_user_type_annotations(mir, &mut file)?;\n         write_mir_fn(tcx, source, mir, &mut extra_data, &mut file)?;\n         extra_data(PassWhere::AfterCFG, &mut file)?;\n     };\n@@ -618,6 +619,19 @@ fn write_temp_decls(mir: &Mir, w: &mut dyn Write) -> io::Result<()> {\n     Ok(())\n }\n \n+fn write_user_type_annotations(mir: &Mir, w: &mut dyn Write) -> io::Result<()> {\n+    if !mir.user_type_annotations.is_empty() {\n+        writeln!(w, \"| User Type Annotations\")?;\n+    }\n+    for (index, (span, annotation)) in mir.user_type_annotations.iter_enumerated() {\n+        writeln!(w, \"| {:?}: {:?} at {:?}\", index.index(), annotation, span)?;\n+    }\n+    if !mir.user_type_annotations.is_empty() {\n+        writeln!(w, \"|\")?;\n+    }\n+    Ok(())\n+}\n+\n pub fn dump_mir_def_ids(tcx: TyCtxt, single: Option<DefId>) -> Vec<DefId> {\n     if let Some(i) = single {\n         vec![i]"}]}