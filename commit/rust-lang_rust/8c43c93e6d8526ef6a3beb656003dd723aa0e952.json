{"sha": "8c43c93e6d8526ef6a3beb656003dd723aa0e952", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhjNDNjOTNlNmQ4NTI2ZWY2YTNiZWI2NTYwMDNkZDcyM2FhMGU5NTI=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2018-06-09T15:20:58Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2018-06-13T19:18:55Z"}, "message": "Fix options issues", "tree": {"sha": "2a698d88c0a47154fafaca2584f752ea1eebe698", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2a698d88c0a47154fafaca2584f752ea1eebe698"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8c43c93e6d8526ef6a3beb656003dd723aa0e952", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8c43c93e6d8526ef6a3beb656003dd723aa0e952", "html_url": "https://github.com/rust-lang/rust/commit/8c43c93e6d8526ef6a3beb656003dd723aa0e952", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8c43c93e6d8526ef6a3beb656003dd723aa0e952/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b000cf07261af68c7aa47e10140c692bc03c85da", "url": "https://api.github.com/repos/rust-lang/rust/commits/b000cf07261af68c7aa47e10140c692bc03c85da", "html_url": "https://github.com/rust-lang/rust/commit/b000cf07261af68c7aa47e10140c692bc03c85da"}], "stats": {"total": 67, "additions": 49, "deletions": 18}, "files": [{"sha": "79796d788719a7be3a7cc78583f63cb3110a2ae7", "filename": "src/librustc_lint/builtin.rs", "status": "modified", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/8c43c93e6d8526ef6a3beb656003dd723aa0e952/src%2Flibrustc_lint%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8c43c93e6d8526ef6a3beb656003dd723aa0e952/src%2Flibrustc_lint%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Fbuiltin.rs?ref=8c43c93e6d8526ef6a3beb656003dd723aa0e952", "patch": "@@ -1665,3 +1665,36 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for TrivialConstraints {\n         }\n     }\n }\n+\n+/// Does nothing as a lint pass, but registers some `Lint`s\n+/// which are used by other parts of the compiler.\n+#[derive(Copy, Clone)]\n+pub struct SoftLints;\n+\n+impl LintPass for SoftLints {\n+    fn get_lints(&self) -> LintArray {\n+        lint_array!(\n+            WHILE_TRUE,\n+            BOX_POINTERS,\n+            NON_SHORTHAND_FIELD_PATTERNS,\n+            UNSAFE_CODE,\n+            MISSING_DOCS,\n+            MISSING_COPY_IMPLEMENTATIONS,\n+            MISSING_DEBUG_IMPLEMENTATIONS,\n+            ANONYMOUS_PARAMETERS,\n+            UNUSED_DOC_COMMENTS,\n+            UNCONDITIONAL_RECURSION,\n+            PLUGIN_AS_LIBRARY,\n+            PRIVATE_NO_MANGLE_FNS,\n+            PRIVATE_NO_MANGLE_STATICS,\n+            NO_MANGLE_CONST_ITEMS,\n+            NO_MANGLE_GENERIC_ITEMS,\n+            MUTABLE_TRANSMUTES,\n+            UNSTABLE_FEATURES,\n+            UNIONS_WITH_DROP_FIELDS,\n+            UNREACHABLE_PUB,\n+            TYPE_ALIAS_BOUNDS,\n+            TRIVIAL_BOUNDS,\n+        )\n+    }\n+}"}, {"sha": "9ac22f8dceb05558ed97f648f50be1dee787634c", "filename": "src/librustc_lint/lib.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/8c43c93e6d8526ef6a3beb656003dd723aa0e952/src%2Flibrustc_lint%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8c43c93e6d8526ef6a3beb656003dd723aa0e952/src%2Flibrustc_lint%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Flib.rs?ref=8c43c93e6d8526ef6a3beb656003dd723aa0e952", "patch": "@@ -60,6 +60,9 @@ use builtin::*;\n use types::*;\n use unused::*;\n \n+/// Useful for other parts of the compiler.\n+pub use builtin::SoftLints;\n+\n /// Tell the `LintStore` about all the built-in lints (the ones\n /// defined in this crate and the ones defined in\n /// `rustc::lint::builtin`)."}, {"sha": "f46d3d834ae0d664ccd8d0c5258654ec9a101132", "filename": "src/librustdoc/core.rs", "status": "modified", "additions": 5, "deletions": 8, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/8c43c93e6d8526ef6a3beb656003dd723aa0e952/src%2Flibrustdoc%2Fcore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8c43c93e6d8526ef6a3beb656003dd723aa0e952/src%2Flibrustdoc%2Fcore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fcore.rs?ref=8c43c93e6d8526ef6a3beb656003dd723aa0e952", "patch": "@@ -191,16 +191,13 @@ pub fn run_core(search_paths: SearchPaths,\n     let warnings_lint_name = lint::builtin::WARNINGS.name;\n     let lints = lint::builtin::HardwiredLints.get_lints()\n                     .iter()\n+                    .chain(rustc_lint::SoftLints.get_lints())\n                     .filter_map(|lint| {\n-                        if lint.name == warnings_lint_name {\n+                        if lint.name == warnings_lint_name ||\n+                           lint.name == intra_link_resolution_failure_name {\n                             None\n                         } else {\n-                            let level = if lint.name == intra_link_resolution_failure_name {\n-                                lint::Warn\n-                            } else {\n-                                lint::Allow\n-                            };\n-                            Some((lint.name_lower(), level))\n+                            Some((lint.name_lower(), lint::Allow))\n                         }\n                     })\n                     .collect::<Vec<_>>();\n@@ -216,7 +213,7 @@ pub fn run_core(search_paths: SearchPaths,\n         } else {\n             vec![]\n         },\n-        lint_cap: Some(lint::Warn),\n+        lint_cap: Some(lint::Forbid),\n         cg,\n         externs,\n         target_triple: triple.unwrap_or(host_triple),"}, {"sha": "3aa45405fd400246b023286c1bf7296b1178732f", "filename": "src/test/rustdoc-ui/deny-intra-link-resolution-failure.stderr", "status": "modified", "additions": 6, "deletions": 10, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/8c43c93e6d8526ef6a3beb656003dd723aa0e952/src%2Ftest%2Frustdoc-ui%2Fdeny-intra-link-resolution-failure.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/8c43c93e6d8526ef6a3beb656003dd723aa0e952/src%2Ftest%2Frustdoc-ui%2Fdeny-intra-link-resolution-failure.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fdeny-intra-link-resolution-failure.stderr?ref=8c43c93e6d8526ef6a3beb656003dd723aa0e952", "patch": "@@ -1,16 +1,12 @@\n-warning: [v2] cannot be resolved, ignoring it...\n-  --> src/test/rustdoc-ui/deny-intra-link-resolution-failure.rs:13:1\n+error: `[v2]` cannot be resolved, ignoring it...\n+  --> $DIR/deny-intra-link-resolution-failure.rs:13:6\n    |\n-LL | /// [v2] //~ ERROR\n-   | ^^^^^^^^^^^^^^^^^^\n+13 | /// [v2] //~ ERROR\n+   |      ^^ cannot be resolved, ignoring\n    |\n note: lint level defined here\n-  --> src/test/rustdoc-ui/deny-intra-link-resolution-failure.rs:11:9\n+  --> $DIR/deny-intra-link-resolution-failure.rs:11:9\n    |\n-LL | #![deny(intra_link_resolution_failure)]\n+11 | #![deny(intra_link_resolution_failure)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   = note: the link appears in this line:\n-\n-            [v2] //~ ERROR\n-             ^^\n "}, {"sha": "4949c450343ce59de80ecf287088ff89c3b3a5ff", "filename": "src/test/rustdoc-ui/intra-links-warning.stderr", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8c43c93e6d8526ef6a3beb656003dd723aa0e952/src%2Ftest%2Frustdoc-ui%2Fintra-links-warning.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/8c43c93e6d8526ef6a3beb656003dd723aa0e952/src%2Ftest%2Frustdoc-ui%2Fintra-links-warning.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fintra-links-warning.stderr?ref=8c43c93e6d8526ef6a3beb656003dd723aa0e952", "patch": "@@ -3,6 +3,8 @@ warning: `[Foo::baz]` cannot be resolved, ignoring it...\n    |\n 13 |        //! Test with [Foo::baz], [Bar::foo], ...\n    |                       ^^^^^^^^ cannot be resolved, ignoring\n+   |\n+   = note: #[warn(intra_link_resolution_failure)] on by default\n \n warning: `[Bar::foo]` cannot be resolved, ignoring it...\n   --> $DIR/intra-links-warning.rs:13:35"}]}