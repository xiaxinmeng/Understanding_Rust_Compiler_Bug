{"sha": "43e17454e2d8f650142cb671e13ca70fcbe42fcc", "node_id": "C_kwDOAAsO6NoAKDQzZTE3NDU0ZTJkOGY2NTAxNDJjYjY3MWUxM2NhNzBmY2JlNDJmY2M", "commit": {"author": {"name": "Martin Nordholts", "email": "enselic@gmail.com", "date": "2022-10-24T18:59:22Z"}, "committer": {"name": "Martin Nordholts", "email": "enselic@gmail.com", "date": "2022-10-25T17:13:23Z"}, "message": "Remove `rustc_driver::set_sigpipe_handler()`\n\nIts usage was removed in 5e624bf4ba and 093b075d32, so we do not need to\nkeep it around any longer. According to [preliminary\ninput](https://rust-lang.zulipchat.com/#narrow/stream/182449-t-compiler.2Fhelp/topic/Find.20.60rustc_driver.60.20dependent.20projects.3F/near/304490764),\nwe do not need to worry about any deprecation cycle for this API and can\njust straight up remove it.\n\nMigration instructions for remaining clients\n--------------------------------------------\n\nChange from\n\n```rust\n\nextern crate rustc_driver;\n\nfn main() {\n    rustc_driver::set_sigpipe_handler();\n    // ...\n```\n\nto\n\n```rust\n\nfn main() {\n    // ...\n```", "tree": {"sha": "bc2c04b17456eee084f3170e71a65bc18d99b468", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bc2c04b17456eee084f3170e71a65bc18d99b468"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/43e17454e2d8f650142cb671e13ca70fcbe42fcc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/43e17454e2d8f650142cb671e13ca70fcbe42fcc", "html_url": "https://github.com/rust-lang/rust/commit/43e17454e2d8f650142cb671e13ca70fcbe42fcc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/43e17454e2d8f650142cb671e13ca70fcbe42fcc/comments", "author": {"login": "Enselic", "id": 115040, "node_id": "MDQ6VXNlcjExNTA0MA==", "avatar_url": "https://avatars.githubusercontent.com/u/115040?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Enselic", "html_url": "https://github.com/Enselic", "followers_url": "https://api.github.com/users/Enselic/followers", "following_url": "https://api.github.com/users/Enselic/following{/other_user}", "gists_url": "https://api.github.com/users/Enselic/gists{/gist_id}", "starred_url": "https://api.github.com/users/Enselic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Enselic/subscriptions", "organizations_url": "https://api.github.com/users/Enselic/orgs", "repos_url": "https://api.github.com/users/Enselic/repos", "events_url": "https://api.github.com/users/Enselic/events{/privacy}", "received_events_url": "https://api.github.com/users/Enselic/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Enselic", "id": 115040, "node_id": "MDQ6VXNlcjExNTA0MA==", "avatar_url": "https://avatars.githubusercontent.com/u/115040?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Enselic", "html_url": "https://github.com/Enselic", "followers_url": "https://api.github.com/users/Enselic/followers", "following_url": "https://api.github.com/users/Enselic/following{/other_user}", "gists_url": "https://api.github.com/users/Enselic/gists{/gist_id}", "starred_url": "https://api.github.com/users/Enselic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Enselic/subscriptions", "organizations_url": "https://api.github.com/users/Enselic/orgs", "repos_url": "https://api.github.com/users/Enselic/repos", "events_url": "https://api.github.com/users/Enselic/events{/privacy}", "received_events_url": "https://api.github.com/users/Enselic/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "85d089b41e2a0c0f07ab34f6c5a7c451389f25e6", "url": "https://api.github.com/repos/rust-lang/rust/commits/85d089b41e2a0c0f07ab34f6c5a7c451389f25e6", "html_url": "https://github.com/rust-lang/rust/commit/85d089b41e2a0c0f07ab34f6c5a7c451389f25e6"}], "stats": {"total": 12, "additions": 0, "deletions": 12}, "files": [{"sha": "cfa734c7df39c331a9eb39b1a482d003f9f6d62d", "filename": "compiler/rustc_driver/src/lib.rs", "status": "modified", "additions": 0, "deletions": 12, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/43e17454e2d8f650142cb671e13ca70fcbe42fcc/compiler%2Frustc_driver%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/43e17454e2d8f650142cb671e13ca70fcbe42fcc/compiler%2Frustc_driver%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_driver%2Fsrc%2Flib.rs?ref=43e17454e2d8f650142cb671e13ca70fcbe42fcc", "patch": "@@ -427,18 +427,6 @@ fn run_compiler(\n     })\n }\n \n-#[cfg(unix)]\n-pub fn set_sigpipe_handler() {\n-    unsafe {\n-        // Set the SIGPIPE signal handler, so that an EPIPE\n-        // will cause rustc to terminate, as expected.\n-        assert_ne!(libc::signal(libc::SIGPIPE, libc::SIG_DFL), libc::SIG_ERR);\n-    }\n-}\n-\n-#[cfg(windows)]\n-pub fn set_sigpipe_handler() {}\n-\n // Extract output directory and file from matches.\n fn make_output(matches: &getopts::Matches) -> (Option<PathBuf>, Option<PathBuf>) {\n     let odir = matches.opt_str(\"out-dir\").map(|o| PathBuf::from(&o));"}]}