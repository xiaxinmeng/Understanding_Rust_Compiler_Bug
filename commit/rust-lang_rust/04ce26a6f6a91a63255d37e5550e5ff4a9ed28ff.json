{"sha": "04ce26a6f6a91a63255d37e5550e5ff4a9ed28ff", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA0Y2UyNmE2ZjZhOTFhNjMyNTVkMzdlNTU1MGU1ZmY0YTllZDI4ZmY=", "commit": {"author": {"name": "Ed Schouten", "email": "ed@nuxi.nl", "date": "2018-01-02T13:18:40Z"}, "committer": {"name": "Ed Schouten", "email": "ed@nuxi.nl", "date": "2018-01-02T13:18:40Z"}, "message": "Force the creation of libs instead of dylibs on CloudABI.\n\nCloudABI doesn't support the creation of dynamic libraries. Any test\nmaking use of auxiliary libraries will fail without this change applied.", "tree": {"sha": "2813b7072b71d6b01c2e465bb439f3d41b6e0d7b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2813b7072b71d6b01c2e465bb439f3d41b6e0d7b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/04ce26a6f6a91a63255d37e5550e5ff4a9ed28ff", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/04ce26a6f6a91a63255d37e5550e5ff4a9ed28ff", "html_url": "https://github.com/rust-lang/rust/commit/04ce26a6f6a91a63255d37e5550e5ff4a9ed28ff", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/04ce26a6f6a91a63255d37e5550e5ff4a9ed28ff/comments", "author": {"login": "EdSchouten", "id": 736085, "node_id": "MDQ6VXNlcjczNjA4NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/736085?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EdSchouten", "html_url": "https://github.com/EdSchouten", "followers_url": "https://api.github.com/users/EdSchouten/followers", "following_url": "https://api.github.com/users/EdSchouten/following{/other_user}", "gists_url": "https://api.github.com/users/EdSchouten/gists{/gist_id}", "starred_url": "https://api.github.com/users/EdSchouten/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EdSchouten/subscriptions", "organizations_url": "https://api.github.com/users/EdSchouten/orgs", "repos_url": "https://api.github.com/users/EdSchouten/repos", "events_url": "https://api.github.com/users/EdSchouten/events{/privacy}", "received_events_url": "https://api.github.com/users/EdSchouten/received_events", "type": "User", "site_admin": false}, "committer": {"login": "EdSchouten", "id": 736085, "node_id": "MDQ6VXNlcjczNjA4NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/736085?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EdSchouten", "html_url": "https://github.com/EdSchouten", "followers_url": "https://api.github.com/users/EdSchouten/followers", "following_url": "https://api.github.com/users/EdSchouten/following{/other_user}", "gists_url": "https://api.github.com/users/EdSchouten/gists{/gist_id}", "starred_url": "https://api.github.com/users/EdSchouten/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EdSchouten/subscriptions", "organizations_url": "https://api.github.com/users/EdSchouten/orgs", "repos_url": "https://api.github.com/users/EdSchouten/repos", "events_url": "https://api.github.com/users/EdSchouten/events{/privacy}", "received_events_url": "https://api.github.com/users/EdSchouten/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3f880912e90825a88b0a25e235dd43b24da1055b", "url": "https://api.github.com/repos/rust-lang/rust/commits/3f880912e90825a88b0a25e235dd43b24da1055b", "html_url": "https://github.com/rust-lang/rust/commit/3f880912e90825a88b0a25e235dd43b24da1055b"}], "stats": {"total": 5, "additions": 3, "deletions": 2}, "files": [{"sha": "1b87576ba0b0db7b4b8dbec661205c3232f1549b", "filename": "src/tools/compiletest/src/runtest.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/04ce26a6f6a91a63255d37e5550e5ff4a9ed28ff/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/04ce26a6f6a91a63255d37e5550e5ff4a9ed28ff/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs?ref=04ce26a6f6a91a63255d37e5550e5ff4a9ed28ff", "patch": "@@ -1368,9 +1368,10 @@ impl<'test> TestCx<'test> {\n \n             let crate_type = if aux_props.no_prefer_dynamic {\n                 None\n-            } else if (self.config.target.contains(\"musl\") && !aux_props.force_host)\n-                || self.config.target.contains(\"wasm32\")\n+            } else if self.config.target.contains(\"cloudabi\")\n                 || self.config.target.contains(\"emscripten\")\n+                || (self.config.target.contains(\"musl\") && !aux_props.force_host)\n+                || self.config.target.contains(\"wasm32\")\n             {\n                 // We primarily compile all auxiliary libraries as dynamic libraries\n                 // to avoid code size bloat and large binaries as much as possible"}]}