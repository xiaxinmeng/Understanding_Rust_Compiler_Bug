{"sha": "ae784df3ce0c354fde00a6d9a4a50d642bdb3560", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFlNzg0ZGYzY2UwYzM1NGZkZTAwYTZkOWE0YTUwZDY0MmJkYjM1NjA=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-05-14T00:00:43Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-05-14T00:06:58Z"}, "message": "Add support for 'T' transition snapshots, which are identical to S snapshots except they tell the makefile to stop at stage1.", "tree": {"sha": "af075f13c465dd3e43d8f9ade50d740953e02e79", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/af075f13c465dd3e43d8f9ade50d740953e02e79"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ae784df3ce0c354fde00a6d9a4a50d642bdb3560", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ae784df3ce0c354fde00a6d9a4a50d642bdb3560", "html_url": "https://github.com/rust-lang/rust/commit/ae784df3ce0c354fde00a6d9a4a50d642bdb3560", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ae784df3ce0c354fde00a6d9a4a50d642bdb3560/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fac13425138bdadae8ab738efa538641af33c12e", "url": "https://api.github.com/repos/rust-lang/rust/commits/fac13425138bdadae8ab738efa538641af33c12e", "html_url": "https://github.com/rust-lang/rust/commit/fac13425138bdadae8ab738efa538641af33c12e"}], "stats": {"total": 37, "additions": 29, "deletions": 8}, "files": [{"sha": "5e33d8d9eebe340fe9d517030c4329a4561a8d51", "filename": "Makefile.in", "status": "modified", "additions": 22, "deletions": 1, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/ae784df3ce0c354fde00a6d9a4a50d642bdb3560/Makefile.in", "raw_url": "https://github.com/rust-lang/rust/raw/ae784df3ce0c354fde00a6d9a4a50d642bdb3560/Makefile.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Makefile.in?ref=ae784df3ce0c354fde00a6d9a4a50d642bdb3560", "patch": "@@ -165,6 +165,25 @@ LLVM_AS := $(CFG_LLVM_BINDIR)/llvm-as\n # Single-target rules\n ######################################################################\n \n+ifneq ($(CFG_IN_TRANSITION),)\n+\n+CFG_INFO := $(info cfg: *** compiler is in snapshot transition ***)\n+CFG_INFO := $(info cfg: *** stage2 and later will not be built ***)\n+\n+all: rt/$(CFG_RUNTIME)          \\\n+     rustllvm/$(CFG_RUSTLLVM)   \\\n+     stage0/$(CFG_STDLIB)       \\\n+     stage0/intrinsics.bc       \\\n+     stage0/rustc$(X)           \\\n+     $(GENERATED)               \\\n+     $(DOCS)                    \\\n+     stage1/$(CFG_STDLIB)       \\\n+     stage1/intrinsics.bc       \\\n+     stage1/glue.o              \\\n+     stage1/rustc$(X)           \\\n+\n+else\n+\n all: rt/$(CFG_RUNTIME)          \\\n      rustllvm/$(CFG_RUSTLLVM)   \\\n      stage0/$(CFG_STDLIB)       \\\n@@ -185,12 +204,14 @@ all: rt/$(CFG_RUNTIME)          \\\n      stage3/intrinsics.bc       \\\n      stage3/rustc$(X)\n \n+endif\n+\n \n ######################################################################\n # Re-configuration\n ######################################################################\n \n-config.mk: $(S)configure $(S)Makefile.in\n+config.mk: $(S)configure $(S)Makefile.in $(S)src/snapshots.txt\n \t@$(call E, cfg: reconfiguring)\n \t$(S)configure $(CFG_CONFIGURE_ARGS)\n "}, {"sha": "e83787b5198583196026ec48d0e4a4238c592898", "filename": "configure", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/ae784df3ce0c354fde00a6d9a4a50d642bdb3560/configure", "raw_url": "https://github.com/rust-lang/rust/raw/ae784df3ce0c354fde00a6d9a4a50d642bdb3560/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=ae784df3ce0c354fde00a6d9a4a50d642bdb3560", "patch": "@@ -217,6 +217,12 @@ then\n     err \"either clang or gcc is required\"\n fi\n \n+if head -n 1 ${CFG_SRC_DIR}src/snapshots.txt | grep -q '^T'\n+then\n+    CFG_IN_TRANSITION=1\n+    putvar CFG_IN_TRANSITION\n+fi\n+\n # Valgrind is only reliable on Linux. On Windows it doesn't work at all, and\n # on the Mac the dynamic linker causes Valgrind to emit a huge stream of\n # errors."}, {"sha": "806d37511dd12ddbc2063cdcd705d9141033b3ff", "filename": "src/etc/get-snapshot.py", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ae784df3ce0c354fde00a6d9a4a50d642bdb3560/src%2Fetc%2Fget-snapshot.py", "raw_url": "https://github.com/rust-lang/rust/raw/ae784df3ce0c354fde00a6d9a4a50d642bdb3560/src%2Fetc%2Fget-snapshot.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fget-snapshot.py?ref=ae784df3ce0c354fde00a6d9a4a50d642bdb3560", "patch": "@@ -41,9 +41,6 @@ def determine_curr_snapshot_for_platform():\n     parsed = parse_line(i, line)\n     if (not parsed): continue\n \n-    if parsed[\"type\"] == \"transition\":\n-      raise Exception(\"working on a transition, not updating stage0\")\n-\n     if found_snap and parsed[\"type\"] == \"file\":\n       if parsed[\"platform\"] == platform:\n         hsh = parsed[\"hash\"]"}, {"sha": "f5ba2bfe514ec442b64002c7392116b8fad6fcc5", "filename": "src/etc/snapshot.py", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/ae784df3ce0c354fde00a6d9a4a50d642bdb3560/src%2Fetc%2Fsnapshot.py", "raw_url": "https://github.com/rust-lang/rust/raw/ae784df3ce0c354fde00a6d9a4a50d642bdb3560/src%2Fetc%2Fsnapshot.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fsnapshot.py?ref=ae784df3ce0c354fde00a6d9a4a50d642bdb3560", "patch": "@@ -35,10 +35,7 @@ def parse_line(n, line):\n   match = re.match(r\"([ST]) (\\d{4}-\\d{2}-\\d{2}) ([a-fA-F\\d]+)\\s*$\", line);\n   if (not match):\n     raise Exception(\"%s:%d:E syntax error\" % (snapshotfile, n))\n-  ttype = \"snapshot\"\n-  if (match.group(1) == \"T\"):\n-    ttype = \"transition\"\n-  return {\"type\": ttype,\n+  return {\"type\": \"snapshot\",\n           \"date\": match.group(2),\n           \"rev\": match.group(3)}\n "}]}