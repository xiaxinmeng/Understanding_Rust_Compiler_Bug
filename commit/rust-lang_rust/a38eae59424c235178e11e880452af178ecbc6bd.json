{"sha": "a38eae59424c235178e11e880452af178ecbc6bd", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEzOGVhZTU5NDI0YzIzNTE3OGUxMWU4ODA0NTJhZjE3OGVjYmM2YmQ=", "commit": {"author": {"name": "mark", "email": "markm@cs.wisc.edu", "date": "2020-04-07T02:22:36Z"}, "committer": {"name": "mark", "email": "markm@cs.wisc.edu", "date": "2020-04-08T03:47:26Z"}, "message": "fix ice with trait obj dummy self", "tree": {"sha": "7a749abb462d26a74b1f695258c51b65c234bc69", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7a749abb462d26a74b1f695258c51b65c234bc69"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a38eae59424c235178e11e880452af178ecbc6bd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a38eae59424c235178e11e880452af178ecbc6bd", "html_url": "https://github.com/rust-lang/rust/commit/a38eae59424c235178e11e880452af178ecbc6bd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a38eae59424c235178e11e880452af178ecbc6bd/comments", "author": {"login": "mark-i-m", "id": 8827840, "node_id": "MDQ6VXNlcjg4Mjc4NDA=", "avatar_url": "https://avatars.githubusercontent.com/u/8827840?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mark-i-m", "html_url": "https://github.com/mark-i-m", "followers_url": "https://api.github.com/users/mark-i-m/followers", "following_url": "https://api.github.com/users/mark-i-m/following{/other_user}", "gists_url": "https://api.github.com/users/mark-i-m/gists{/gist_id}", "starred_url": "https://api.github.com/users/mark-i-m/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mark-i-m/subscriptions", "organizations_url": "https://api.github.com/users/mark-i-m/orgs", "repos_url": "https://api.github.com/users/mark-i-m/repos", "events_url": "https://api.github.com/users/mark-i-m/events{/privacy}", "received_events_url": "https://api.github.com/users/mark-i-m/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mark-i-m", "id": 8827840, "node_id": "MDQ6VXNlcjg4Mjc4NDA=", "avatar_url": "https://avatars.githubusercontent.com/u/8827840?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mark-i-m", "html_url": "https://github.com/mark-i-m", "followers_url": "https://api.github.com/users/mark-i-m/followers", "following_url": "https://api.github.com/users/mark-i-m/following{/other_user}", "gists_url": "https://api.github.com/users/mark-i-m/gists{/gist_id}", "starred_url": "https://api.github.com/users/mark-i-m/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mark-i-m/subscriptions", "organizations_url": "https://api.github.com/users/mark-i-m/orgs", "repos_url": "https://api.github.com/users/mark-i-m/repos", "events_url": "https://api.github.com/users/mark-i-m/events{/privacy}", "received_events_url": "https://api.github.com/users/mark-i-m/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4fe09f282b3f75e95346374434af78bf50ed13b6", "url": "https://api.github.com/repos/rust-lang/rust/commits/4fe09f282b3f75e95346374434af78bf50ed13b6", "html_url": "https://github.com/rust-lang/rust/commit/4fe09f282b3f75e95346374434af78bf50ed13b6"}], "stats": {"total": 6, "additions": 2, "deletions": 4}, "files": [{"sha": "afa6e49a05cf1abecd304609fc6ffab0cb372aa4", "filename": "src/librustc_typeck/variance/constraints.rs", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a38eae59424c235178e11e880452af178ecbc6bd/src%2Flibrustc_typeck%2Fvariance%2Fconstraints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a38eae59424c235178e11e880452af178ecbc6bd/src%2Flibrustc_typeck%2Fvariance%2Fconstraints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fvariance%2Fconstraints.rs?ref=a38eae59424c235178e11e880452af178ecbc6bd", "patch": "@@ -315,11 +315,9 @@ impl<'a, 'tcx> ConstraintContext<'a, 'tcx> {\n                 self.add_constraints_from_region(current, r, contra);\n \n                 if let Some(poly_trait_ref) = data.principal() {\n-                    let poly_trait_ref = poly_trait_ref\n-                        .with_self_ty(self.tcx(), self.tcx().types.trait_object_dummy_self);\n-                    self.add_constraints_from_trait_ref(\n+                    self.add_constraints_from_invariant_substs(\n                         current,\n-                        *poly_trait_ref.skip_binder(),\n+                        poly_trait_ref.skip_binder().substs,\n                         variance,\n                     );\n                 }"}]}