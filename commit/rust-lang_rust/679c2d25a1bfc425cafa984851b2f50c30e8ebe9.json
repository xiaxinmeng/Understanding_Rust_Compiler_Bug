{"sha": "679c2d25a1bfc425cafa984851b2f50c30e8ebe9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY3OWMyZDI1YTFiZmM0MjVjYWZhOTg0ODUxYjJmNTBjMzBlOGViZTk=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-09-16T18:29:40Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-09-16T18:29:40Z"}, "message": "Un-xfail some task-comm tests", "tree": {"sha": "80cbc26e9cdf6e5d81fd9de6d4e8b32394e8f549", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/80cbc26e9cdf6e5d81fd9de6d4e8b32394e8f549"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/679c2d25a1bfc425cafa984851b2f50c30e8ebe9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/679c2d25a1bfc425cafa984851b2f50c30e8ebe9", "html_url": "https://github.com/rust-lang/rust/commit/679c2d25a1bfc425cafa984851b2f50c30e8ebe9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/679c2d25a1bfc425cafa984851b2f50c30e8ebe9/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4028a099f525c5368aa385283a2e88073ba2b3ea", "url": "https://api.github.com/repos/rust-lang/rust/commits/4028a099f525c5368aa385283a2e88073ba2b3ea", "html_url": "https://github.com/rust-lang/rust/commit/4028a099f525c5368aa385283a2e88073ba2b3ea"}], "stats": {"total": 52, "additions": 23, "deletions": 29}, "files": [{"sha": "82e9c943bf6fb1028c42de2ed7ba466ec2eb623f", "filename": "src/test/run-pass/task-comm-0.rs", "status": "modified", "additions": 8, "deletions": 10, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/679c2d25a1bfc425cafa984851b2f50c30e8ebe9/src%2Ftest%2Frun-pass%2Ftask-comm-0.rs", "raw_url": "https://github.com/rust-lang/rust/raw/679c2d25a1bfc425cafa984851b2f50c30e8ebe9/src%2Ftest%2Frun-pass%2Ftask-comm-0.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Ftask-comm-0.rs?ref=679c2d25a1bfc425cafa984851b2f50c30e8ebe9", "patch": "@@ -1,15 +1,13 @@\n-// Temporarily xfailing, because something is wrong.\n-// xfail-test\n use std;\n \n import std::comm;\n-import std::comm::_chan;\n+import std::comm::chan;\n import std::comm::send;\n import std::task;\n \n fn main() { test05(); }\n \n-fn test05_start(ch : _chan<int>) {\n+fn test05_start(ch : chan<int>) {\n     log_err ch;\n     send(ch, 10);\n     log_err \"sent 10\";\n@@ -20,14 +18,14 @@ fn test05_start(ch : _chan<int>) {\n }\n \n fn test05() {\n-    let po = comm::mk_port::<int>();\n-    let ch = po.mk_chan();\n-    task::_spawn(bind test05_start(ch));\n-    let value = po.recv();\n+    let po = comm::port();\n+    let ch = comm::chan(po);\n+    task::spawn(bind test05_start(ch));\n+    let value = comm::recv(po);\n     log_err value;\n-    value = po.recv();\n+    value = comm::recv(po);\n     log_err value;\n-    value = po.recv();\n+    value = comm::recv(po);\n     log_err value;\n     assert (value == 30);\n }"}, {"sha": "34f68b4e0618716893e0d712b14db9d9cef802d5", "filename": "src/test/run-pass/task-comm-10.rs", "status": "modified", "additions": 12, "deletions": 14, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/679c2d25a1bfc425cafa984851b2f50c30e8ebe9/src%2Ftest%2Frun-pass%2Ftask-comm-10.rs", "raw_url": "https://github.com/rust-lang/rust/raw/679c2d25a1bfc425cafa984851b2f50c30e8ebe9/src%2Ftest%2Frun-pass%2Ftask-comm-10.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Ftask-comm-10.rs?ref=679c2d25a1bfc425cafa984851b2f50c30e8ebe9", "patch": "@@ -1,29 +1,27 @@\n-// FIXME: this test is xfailed until sending strings is legal again.\n-\n-//xfail-test\n-\n use std;\n import std::task;\n import std::comm;\n \n-fn start(c: comm::_chan<str>) {\n-    let p = comm::mk_port::<str>();\n-    c.send(p.mk_chan().unsafe_ptr());\n+fn start(c: comm::chan<comm::chan<str>>) {\n+    let p = comm::port();\n+    comm::send(c, comm::chan(p));\n \n     let a;\n     let b;\n-    a = p.recv();\n+    a = comm::recv(p);\n+    assert a == \"A\";\n     log_err a;\n-    b = p.recv();\n+    b = comm::recv(p);\n+    assert b == \"B\";\n     log_err b;\n }\n \n fn main() {\n-    let p = comm::mk_port();\n-    let child = task::_spawn(bind start(p.mk_chan()));\n+    let p = comm::port();\n+    let child = task::spawn(bind start(comm::chan(p)));\n \n-    let c = p.recv();\n-    c.send(\"A\");\n-    c.send(\"B\");\n+    let c = comm::recv(p);\n+    comm::send(c, \"A\");\n+    comm::send(c, \"B\");\n     task::yield();\n }"}, {"sha": "cf1a9e8deb88cf41963768c5e45ba837257b1c33", "filename": "src/test/run-pass/task-comm-2.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/679c2d25a1bfc425cafa984851b2f50c30e8ebe9/src%2Ftest%2Frun-pass%2Ftask-comm-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/679c2d25a1bfc425cafa984851b2f50c30e8ebe9/src%2Ftest%2Frun-pass%2Ftask-comm-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Ftask-comm-2.rs?ref=679c2d25a1bfc425cafa984851b2f50c30e8ebe9", "patch": "@@ -1,6 +1,4 @@\n-// Broken under win\n-// xfail-test\n-\n+// xfail-win32\n use std;\n \n import std::task;\n@@ -21,10 +19,10 @@ fn test00() {\n     let tasks = [];\n     while i < number_of_tasks {\n         i = i + 1;\n-        tasks += [task::_spawn(bind start(i))];\n+        tasks += [task::spawn_joinable(bind start(i))];\n     }\n \n-    for t: task::task_id in tasks { task::join_id(t); }\n+    for t in tasks { task::join(t); }\n \n     log \"Joined all task.\";\n }"}]}