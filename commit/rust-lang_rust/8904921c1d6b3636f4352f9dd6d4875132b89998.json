{"sha": "8904921c1d6b3636f4352f9dd6d4875132b89998", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg5MDQ5MjFjMWQ2YjM2MzZmNDM1MmY5ZGQ2ZDQ4NzUxMzJiODk5OTg=", "commit": {"author": {"name": "Alexis Bourget", "email": "alexis.bourget@gmail.com", "date": "2020-09-10T13:27:48Z"}, "committer": {"name": "Alexis Bourget", "email": "alexis.bourget@gmail.com", "date": "2020-09-21T19:50:26Z"}, "message": "Move array cycle test", "tree": {"sha": "d12ce9e92bc433a13ad3ae012be9da4d9ca11082", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d12ce9e92bc433a13ad3ae012be9da4d9ca11082"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8904921c1d6b3636f4352f9dd6d4875132b89998", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8904921c1d6b3636f4352f9dd6d4875132b89998", "html_url": "https://github.com/rust-lang/rust/commit/8904921c1d6b3636f4352f9dd6d4875132b89998", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8904921c1d6b3636f4352f9dd6d4875132b89998/comments", "author": {"login": "poliorcetics", "id": 7951708, "node_id": "MDQ6VXNlcjc5NTE3MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/7951708?v=4", "gravatar_id": "", "url": "https://api.github.com/users/poliorcetics", "html_url": "https://github.com/poliorcetics", "followers_url": "https://api.github.com/users/poliorcetics/followers", "following_url": "https://api.github.com/users/poliorcetics/following{/other_user}", "gists_url": "https://api.github.com/users/poliorcetics/gists{/gist_id}", "starred_url": "https://api.github.com/users/poliorcetics/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/poliorcetics/subscriptions", "organizations_url": "https://api.github.com/users/poliorcetics/orgs", "repos_url": "https://api.github.com/users/poliorcetics/repos", "events_url": "https://api.github.com/users/poliorcetics/events{/privacy}", "received_events_url": "https://api.github.com/users/poliorcetics/received_events", "type": "User", "site_admin": false}, "committer": {"login": "poliorcetics", "id": 7951708, "node_id": "MDQ6VXNlcjc5NTE3MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/7951708?v=4", "gravatar_id": "", "url": "https://api.github.com/users/poliorcetics", "html_url": "https://github.com/poliorcetics", "followers_url": "https://api.github.com/users/poliorcetics/followers", "following_url": "https://api.github.com/users/poliorcetics/following{/other_user}", "gists_url": "https://api.github.com/users/poliorcetics/gists{/gist_id}", "starred_url": "https://api.github.com/users/poliorcetics/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/poliorcetics/subscriptions", "organizations_url": "https://api.github.com/users/poliorcetics/orgs", "repos_url": "https://api.github.com/users/poliorcetics/repos", "events_url": "https://api.github.com/users/poliorcetics/events{/privacy}", "received_events_url": "https://api.github.com/users/poliorcetics/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ac39debeba2b63a39a3833e2d7451f0b1f95b5f2", "url": "https://api.github.com/repos/rust-lang/rust/commits/ac39debeba2b63a39a3833e2d7451f0b1f95b5f2", "html_url": "https://github.com/rust-lang/rust/commit/ac39debeba2b63a39a3833e2d7451f0b1f95b5f2"}], "stats": {"total": 60, "additions": 29, "deletions": 31}, "files": [{"sha": "da496ad7bcd880a9179b102f32352c98fa7b5575", "filename": "library/core/tests/array.rs", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/8904921c1d6b3636f4352f9dd6d4875132b89998/library%2Fcore%2Ftests%2Farray.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8904921c1d6b3636f4352f9dd6d4875132b89998/library%2Fcore%2Ftests%2Farray.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Ftests%2Farray.rs?ref=8904921c1d6b3636f4352f9dd6d4875132b89998", "patch": "@@ -330,3 +330,32 @@ fn array_map_drop_safety() {\n     assert_eq!(DROPPED.load(Ordering::SeqCst), num_to_create);\n     panic!(\"test succeeded\")\n }\n+\n+#[test]\n+fn cell_allows_array_cycle() {\n+    use core::cell::Cell;\n+\n+    #[derive(Debug)]\n+    struct B<'a> {\n+        a: [Cell<Option<&'a B<'a>>>; 2],\n+    }\n+\n+    impl<'a> B<'a> {\n+        fn new() -> B<'a> {\n+            B { a: [Cell::new(None), Cell::new(None)] }\n+        }\n+    }\n+\n+    let b1 = B::new();\n+    let b2 = B::new();\n+    let b3 = B::new();\n+\n+    b1.a[0].set(Some(&b2));\n+    b1.a[1].set(Some(&b3));\n+\n+    b2.a[0].set(Some(&b2));\n+    b2.a[1].set(Some(&b3));\n+\n+    b3.a[0].set(Some(&b1));\n+    b3.a[1].set(Some(&b2));\n+}"}, {"sha": "c262b5a1ff09e66896260dad7899f3d1a1bf3cad", "filename": "src/test/ui/array-slice-vec/arr_cycle.rs", "status": "removed", "additions": 0, "deletions": 31, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/ac39debeba2b63a39a3833e2d7451f0b1f95b5f2/src%2Ftest%2Fui%2Farray-slice-vec%2Farr_cycle.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ac39debeba2b63a39a3833e2d7451f0b1f95b5f2/src%2Ftest%2Fui%2Farray-slice-vec%2Farr_cycle.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Farray-slice-vec%2Farr_cycle.rs?ref=ac39debeba2b63a39a3833e2d7451f0b1f95b5f2", "patch": "@@ -1,31 +0,0 @@\n-// run-pass\n-\n-use std::cell::Cell;\n-\n-#[derive(Debug)]\n-struct B<'a> {\n-    a: [Cell<Option<&'a B<'a>>>; 2]\n-}\n-\n-impl<'a> B<'a> {\n-    fn new() -> B<'a> {\n-        B { a: [Cell::new(None), Cell::new(None)] }\n-    }\n-}\n-\n-fn f() {\n-    let (b1, b2, b3);\n-    b1 = B::new();\n-    b2 = B::new();\n-    b3 = B::new();\n-    b1.a[0].set(Some(&b2));\n-    b1.a[1].set(Some(&b3));\n-    b2.a[0].set(Some(&b2));\n-    b2.a[1].set(Some(&b3));\n-    b3.a[0].set(Some(&b1));\n-    b3.a[1].set(Some(&b2));\n-}\n-\n-fn main() {\n-    f();\n-}"}]}