{"sha": "2bbd16de13c6c9d67e3d94455b3740bbc9a81055", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJiYmQxNmRlMTNjNmM5ZDY3ZTNkOTQ0NTViMzc0MGJiYzlhODEwNTU=", "commit": {"author": {"name": "scalexm", "email": "martin.alex32@hotmail.fr", "date": "2018-03-14T13:45:30Z"}, "committer": {"name": "scalexm", "email": "martin.alex32@hotmail.fr", "date": "2018-03-14T13:45:30Z"}, "message": "Move code into librustc_traits", "tree": {"sha": "89ac83bb0f2e1c54b3942f91fef394dc2903c6ec", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/89ac83bb0f2e1c54b3942f91fef394dc2903c6ec"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2bbd16de13c6c9d67e3d94455b3740bbc9a81055", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2bbd16de13c6c9d67e3d94455b3740bbc9a81055", "html_url": "https://github.com/rust-lang/rust/commit/2bbd16de13c6c9d67e3d94455b3740bbc9a81055", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2bbd16de13c6c9d67e3d94455b3740bbc9a81055/comments", "author": {"login": "scalexm", "id": 1173131, "node_id": "MDQ6VXNlcjExNzMxMzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1173131?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scalexm", "html_url": "https://github.com/scalexm", "followers_url": "https://api.github.com/users/scalexm/followers", "following_url": "https://api.github.com/users/scalexm/following{/other_user}", "gists_url": "https://api.github.com/users/scalexm/gists{/gist_id}", "starred_url": "https://api.github.com/users/scalexm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scalexm/subscriptions", "organizations_url": "https://api.github.com/users/scalexm/orgs", "repos_url": "https://api.github.com/users/scalexm/repos", "events_url": "https://api.github.com/users/scalexm/events{/privacy}", "received_events_url": "https://api.github.com/users/scalexm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "scalexm", "id": 1173131, "node_id": "MDQ6VXNlcjExNzMxMzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1173131?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scalexm", "html_url": "https://github.com/scalexm", "followers_url": "https://api.github.com/users/scalexm/followers", "following_url": "https://api.github.com/users/scalexm/following{/other_user}", "gists_url": "https://api.github.com/users/scalexm/gists{/gist_id}", "starred_url": "https://api.github.com/users/scalexm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scalexm/subscriptions", "organizations_url": "https://api.github.com/users/scalexm/orgs", "repos_url": "https://api.github.com/users/scalexm/repos", "events_url": "https://api.github.com/users/scalexm/events{/privacy}", "received_events_url": "https://api.github.com/users/scalexm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "04b228c3e26dab45c0f9d597b0424eda707c1515", "url": "https://api.github.com/repos/rust-lang/rust/commits/04b228c3e26dab45c0f9d597b0424eda707c1515", "html_url": "https://github.com/rust-lang/rust/commit/04b228c3e26dab45c0f9d597b0424eda707c1515"}], "stats": {"total": 28, "additions": 13, "deletions": 15}, "files": [{"sha": "dce1a89d14260ed635fc1190e7416e80e84f2083", "filename": "src/librustc/traits/mod.rs", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/2bbd16de13c6c9d67e3d94455b3740bbc9a81055/src%2Flibrustc%2Ftraits%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2bbd16de13c6c9d67e3d94455b3740bbc9a81055/src%2Flibrustc%2Ftraits%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Fmod.rs?ref=2bbd16de13c6c9d67e3d94455b3740bbc9a81055", "patch": "@@ -63,7 +63,6 @@ mod specialize;\n mod structural_impls;\n pub mod trans;\n mod util;\n-mod lowering;\n \n pub mod query;\n \n@@ -297,10 +296,6 @@ pub enum Clause<'tcx> {\n     ForAll(Box<ty::Binder<Clause<'tcx>>>),\n }\n \n-pub fn dump_program_clauses<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>) {\n-    lowering::dump_program_clauses(tcx)\n-}\n-\n pub type Selection<'tcx> = Vtable<'tcx, PredicateObligation<'tcx>>;\n \n #[derive(Clone,Debug)]\n@@ -972,7 +967,6 @@ pub fn provide(providers: &mut ty::maps::Providers) {\n         specialization_graph_of: specialize::specialization_graph_provider,\n         specializes: specialize::specializes,\n         trans_fulfill_obligation: trans::trans_fulfill_obligation,\n-        program_clauses_for: lowering::program_clauses_for,\n         vtable_methods,\n         substitute_normalize_and_test_predicates,\n         ..*providers"}, {"sha": "61335391dab7008526c16f03d8e80e6467840125", "filename": "src/librustc_driver/driver.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2bbd16de13c6c9d67e3d94455b3740bbc9a81055/src%2Flibrustc_driver%2Fdriver.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2bbd16de13c6c9d67e3d94455b3740bbc9a81055/src%2Flibrustc_driver%2Fdriver.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_driver%2Fdriver.rs?ref=2bbd16de13c6c9d67e3d94455b3740bbc9a81055", "patch": "@@ -1089,7 +1089,9 @@ pub fn phase_3_run_analysis_passes<'tcx, F, R>(trans: &TransCrate,\n \n         time(sess, \"lint checking\", || lint::check_crate(tcx));\n \n-        time(sess, \"dumping chalk-like clauses\", || traits::dump_program_clauses(tcx));\n+        time(sess,\n+             \"dumping chalk-like clauses\",\n+             || rustc_traits::lowering::dump_program_clauses(tcx));\n \n         return Ok(f(tcx, analysis, rx, tcx.sess.compile_status()));\n     })"}, {"sha": "2a0f076cefde3c610f3085890744cadd4883de81", "filename": "src/librustc_traits/lib.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2bbd16de13c6c9d67e3d94455b3740bbc9a81055/src%2Flibrustc_traits%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2bbd16de13c6c9d67e3d94455b3740bbc9a81055/src%2Flibrustc_traits%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_traits%2Flib.rs?ref=2bbd16de13c6c9d67e3d94455b3740bbc9a81055", "patch": "@@ -29,6 +29,7 @@ mod dropck_outlives;\n mod normalize_projection_ty;\n mod normalize_erasing_regions;\n mod util;\n+pub mod lowering;\n \n use rustc::ty::maps::Providers;\n \n@@ -39,6 +40,7 @@ pub fn provide(p: &mut Providers) {\n         normalize_projection_ty: normalize_projection_ty::normalize_projection_ty,\n         normalize_ty_after_erasing_regions:\n             normalize_erasing_regions::normalize_ty_after_erasing_regions,\n+        program_clauses_for: lowering::program_clauses_for,\n         ..*p\n     };\n }"}, {"sha": "b69d97b67e83b213500d1ca1388c6ec4387aea33", "filename": "src/librustc_traits/lowering.rs", "status": "renamed", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/2bbd16de13c6c9d67e3d94455b3740bbc9a81055/src%2Flibrustc_traits%2Flowering.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2bbd16de13c6c9d67e3d94455b3740bbc9a81055/src%2Flibrustc_traits%2Flowering.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_traits%2Flowering.rs?ref=2bbd16de13c6c9d67e3d94455b3740bbc9a81055", "patch": "@@ -8,13 +8,13 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-use hir::{self, ImplPolarity};\n-use hir::def_id::DefId;\n-use hir::intravisit::{self, NestedVisitorMap, Visitor};\n-use ty::{self, TyCtxt};\n-use super::{QuantifierKind, Goal, DomainGoal, Clause, WhereClauseAtom};\n-use rustc_data_structures::sync::Lrc;\n+use rustc::hir::{self, ImplPolarity};\n+use rustc::hir::def_id::DefId;\n+use rustc::hir::intravisit::{self, NestedVisitorMap, Visitor};\n+use rustc::ty::{self, TyCtxt};\n+use rustc::traits::{QuantifierKind, Goal, DomainGoal, Clause, WhereClauseAtom};\n use syntax::ast;\n+use rustc_data_structures::sync::Lrc;\n \n trait Lower<T> {\n     fn lower(&self) -> T;\n@@ -72,7 +72,7 @@ impl<'tcx, T> Lower<Goal<'tcx>> for ty::Binder<T>\n \n impl<'tcx> Lower<Goal<'tcx>> for ty::Predicate<'tcx> {\n     fn lower(&self) -> Goal<'tcx> {\n-        use ty::Predicate::*;\n+        use rustc::ty::Predicate::*;\n \n         match self {\n             Trait(predicate) => predicate.lower(),\n@@ -88,7 +88,7 @@ impl<'tcx> Lower<Goal<'tcx>> for ty::Predicate<'tcx> {\n     }\n }\n \n-pub fn program_clauses_for<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, def_id: DefId)\n+crate fn program_clauses_for<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, def_id: DefId)\n     -> Lrc<Vec<Clause<'tcx>>>\n {\n     let node_id = tcx.hir.as_local_node_id(def_id).unwrap();", "previous_filename": "src/librustc/traits/lowering.rs"}]}