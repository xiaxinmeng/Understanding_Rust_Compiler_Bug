{"sha": "66995a6a71e2f5e194797cb846ce5866c4305f93", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY2OTk1YTZhNzFlMmY1ZTE5NDc5N2NiODQ2Y2U1ODY2YzQzMDVmOTM=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-09-21T21:39:15Z"}, "committer": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-10-23T22:32:03Z"}, "message": "dedup GAT gate checks", "tree": {"sha": "160c8ded6fb952adc0246000514b7fe66d612b8c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/160c8ded6fb952adc0246000514b7fe66d612b8c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/66995a6a71e2f5e194797cb846ce5866c4305f93", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/66995a6a71e2f5e194797cb846ce5866c4305f93", "html_url": "https://github.com/rust-lang/rust/commit/66995a6a71e2f5e194797cb846ce5866c4305f93", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/66995a6a71e2f5e194797cb846ce5866c4305f93/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1935ba658c576f14397c2c7a26a6642cf08f26a6", "url": "https://api.github.com/repos/rust-lang/rust/commits/1935ba658c576f14397c2c7a26a6642cf08f26a6", "html_url": "https://github.com/rust-lang/rust/commit/1935ba658c576f14397c2c7a26a6642cf08f26a6"}], "stats": {"total": 37, "additions": 21, "deletions": 16}, "files": [{"sha": "ab8781feef07d1f1734a54d259b628dd567a758b", "filename": "src/libsyntax/feature_gate/check.rs", "status": "modified", "additions": 21, "deletions": 16, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/66995a6a71e2f5e194797cb846ce5866c4305f93/src%2Flibsyntax%2Ffeature_gate%2Fcheck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/66995a6a71e2f5e194797cb846ce5866c4305f93/src%2Flibsyntax%2Ffeature_gate%2Fcheck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ffeature_gate%2Fcheck.rs?ref=66995a6a71e2f5e194797cb846ce5866c4305f93", "patch": "@@ -287,6 +287,25 @@ impl<'a> PostExpansionVisitor<'a> {\n             err.emit();\n         }\n     }\n+\n+    fn check_gat(&self, generics: &ast::Generics, span: Span) {\n+        if !generics.params.is_empty() {\n+            gate_feature_post!(\n+                &self,\n+                generic_associated_types,\n+                span,\n+                \"generic associated types are unstable\"\n+            );\n+        }\n+        if !generics.where_clause.predicates.is_empty() {\n+            gate_feature_post!(\n+                &self,\n+                generic_associated_types,\n+                span,\n+                \"where clauses on associated types are unstable\"\n+            );\n+        }\n+    }\n }\n \n impl<'a> Visitor<'a> for PostExpansionVisitor<'a> {\n@@ -566,14 +585,7 @@ impl<'a> Visitor<'a> for PostExpansionVisitor<'a> {\n                     gate_feature_post!(&self, associated_type_defaults, ti.span,\n                                        \"associated type defaults are unstable\");\n                 }\n-                if !ti.generics.params.is_empty() {\n-                    gate_feature_post!(&self, generic_associated_types, ti.span,\n-                                       \"generic associated types are unstable\");\n-                }\n-                if !ti.generics.where_clause.predicates.is_empty() {\n-                    gate_feature_post!(&self, generic_associated_types, ti.span,\n-                                       \"where clauses on associated types are unstable\");\n-                }\n+                self.check_gat(&ti.generics, ti.span);\n             }\n             _ => {}\n         }\n@@ -603,14 +615,7 @@ impl<'a> Visitor<'a> for PostExpansionVisitor<'a> {\n                 );\n             }\n             ast::ImplItemKind::TyAlias(_) => {\n-                if !ii.generics.params.is_empty() {\n-                    gate_feature_post!(&self, generic_associated_types, ii.span,\n-                                       \"generic associated types are unstable\");\n-                }\n-                if !ii.generics.where_clause.predicates.is_empty() {\n-                    gate_feature_post!(&self, generic_associated_types, ii.span,\n-                                       \"where clauses on associated types are unstable\");\n-                }\n+                self.check_gat(&ii.generics, ii.span);\n             }\n             _ => {}\n         }"}]}