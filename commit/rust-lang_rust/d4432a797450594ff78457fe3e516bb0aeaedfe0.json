{"sha": "d4432a797450594ff78457fe3e516bb0aeaedfe0", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ0NDMyYTc5NzQ1MDU5NGZmNzg0NTdmZTNlNTE2YmIwYWVhZWRmZTA=", "commit": {"author": {"name": "Simon BD", "email": "simon@server", "date": "2012-10-25T16:30:41Z"}, "committer": {"name": "Simon BD", "email": "simon@server", "date": "2012-10-25T16:30:41Z"}, "message": "Remove some unused MergeState code, add a Fixme and remove a workaround involving pure code not being considered pure", "tree": {"sha": "bdb858097f59c47d5dd3da8b9b12bf492f5c45ee", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bdb858097f59c47d5dd3da8b9b12bf492f5c45ee"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d4432a797450594ff78457fe3e516bb0aeaedfe0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d4432a797450594ff78457fe3e516bb0aeaedfe0", "html_url": "https://github.com/rust-lang/rust/commit/d4432a797450594ff78457fe3e516bb0aeaedfe0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d4432a797450594ff78457fe3e516bb0aeaedfe0/comments", "author": {"login": "14427", "id": 2423611, "node_id": "MDQ6VXNlcjI0MjM2MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2423611?v=4", "gravatar_id": "", "url": "https://api.github.com/users/14427", "html_url": "https://github.com/14427", "followers_url": "https://api.github.com/users/14427/followers", "following_url": "https://api.github.com/users/14427/following{/other_user}", "gists_url": "https://api.github.com/users/14427/gists{/gist_id}", "starred_url": "https://api.github.com/users/14427/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/14427/subscriptions", "organizations_url": "https://api.github.com/users/14427/orgs", "repos_url": "https://api.github.com/users/14427/repos", "events_url": "https://api.github.com/users/14427/events{/privacy}", "received_events_url": "https://api.github.com/users/14427/received_events", "type": "User", "site_admin": false}, "committer": {"login": "14427", "id": 2423611, "node_id": "MDQ6VXNlcjI0MjM2MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2423611?v=4", "gravatar_id": "", "url": "https://api.github.com/users/14427", "html_url": "https://github.com/14427", "followers_url": "https://api.github.com/users/14427/followers", "following_url": "https://api.github.com/users/14427/following{/other_user}", "gists_url": "https://api.github.com/users/14427/gists{/gist_id}", "starred_url": "https://api.github.com/users/14427/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/14427/subscriptions", "organizations_url": "https://api.github.com/users/14427/orgs", "repos_url": "https://api.github.com/users/14427/repos", "events_url": "https://api.github.com/users/14427/events{/privacy}", "received_events_url": "https://api.github.com/users/14427/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f2216ec9d069a2fc332750a37c08bab522a41df7", "url": "https://api.github.com/repos/rust-lang/rust/commits/f2216ec9d069a2fc332750a37c08bab522a41df7", "html_url": "https://github.com/rust-lang/rust/commit/f2216ec9d069a2fc332750a37c08bab522a41df7"}], "stats": {"total": 13, "additions": 5, "deletions": 8}, "files": [{"sha": "52ef271fd56066a9824adddfb2a7a98fd1a24c24", "filename": "src/libstd/sort.rs", "status": "modified", "additions": 5, "deletions": 8, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/d4432a797450594ff78457fe3e516bb0aeaedfe0/src%2Flibstd%2Fsort.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d4432a797450594ff78457fe3e516bb0aeaedfe0/src%2Flibstd%2Fsort.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsort.rs?ref=d4432a797450594ff78457fe3e516bb0aeaedfe0", "patch": "@@ -179,7 +179,6 @@ pub fn tim_sort<T: Copy Ord>(array: &[mut T]) {\n     }\n \n     let ms = &MergeState();\n-    ms.array = array;\n     let min_run = min_run_length(size);\n \n     let mut idx = 0;\n@@ -383,14 +382,13 @@ struct RunState {\n \n struct MergeState<T> {\n     mut min_gallop: uint,\n-    mut array: &[mut T],\n     runs: DVec<RunState>,\n }\n \n+// Fixme (#3853) Move into MergeState\n fn MergeState<T>() -> MergeState<T> {\n     MergeState {\n         min_gallop: MIN_GALLOP,\n-        array: &[mut],\n         runs: DVec(),\n     }\n }\n@@ -500,9 +498,8 @@ impl<T: Copy Ord> MergeState<T> {\n             loop {\n                 assert len1 > 1 && len2 != 0;\n \n-                //let tmp_view = vec::const_view(tmp, c1, c1+len1);\n-                count1 = gallop_right(&const array[c2],\n-                    vec::const_view(tmp, c1, c1+len1), 0);\n+                let tmp_view = vec::const_view(tmp, c1, c1+len1);\n+                count1 = gallop_right(&const array[c2], tmp_view, 0);\n                 if count1 != 0 {\n                     copy_vec(array, dest, tmp, c1, count1);\n                     dest += count1; c1 += count1; len1 -= count1;\n@@ -620,9 +617,9 @@ impl<T: Copy Ord> MergeState<T> {\n                 dest -= 1; c2 -= 1; len2 -= 1;\n                 if len2 == 1 { break_outer = true; break; }\n \n-                //let tmp_view = vec::mut_view(tmp, 0, len2);\n+                let tmp_view = vec::mut_view(tmp, 0, len2);\n                 let count2 = len2 - gallop_left(&const array[c1],\n-                            vec::mut_view(tmp, 0, len2), len2-1);\n+                                                tmp_view, len2-1);\n                 if count2 != 0 {\n                     dest -= count2; c2 -= count2; len2 -= count2;\n                     copy_vec(array, dest+1, tmp, c2+1, count2);"}]}