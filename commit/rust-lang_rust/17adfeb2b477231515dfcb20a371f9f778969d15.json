{"sha": "17adfeb2b477231515dfcb20a371f9f778969d15", "node_id": "C_kwDOAAsO6NoAKDE3YWRmZWIyYjQ3NzIzMTUxNWRmY2IyMGEzNzFmOWY3Nzg5NjlkMTU", "commit": {"author": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2022-07-05T00:00:00Z"}, "committer": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2022-07-07T06:11:49Z"}, "message": "Move `dominators` from Body to BasicBlocks", "tree": {"sha": "5994e3a9c4e4b71841fae0419b221aece055b71f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5994e3a9c4e4b71841fae0419b221aece055b71f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/17adfeb2b477231515dfcb20a371f9f778969d15", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/17adfeb2b477231515dfcb20a371f9f778969d15", "html_url": "https://github.com/rust-lang/rust/commit/17adfeb2b477231515dfcb20a371f9f778969d15", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/17adfeb2b477231515dfcb20a371f9f778969d15/comments", "author": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dfa6a7cbde0eb34d7cd7d23a37ca03b9c7568a16", "url": "https://api.github.com/repos/rust-lang/rust/commits/dfa6a7cbde0eb34d7cd7d23a37ca03b9c7568a16", "html_url": "https://github.com/rust-lang/rust/commit/dfa6a7cbde0eb34d7cd7d23a37ca03b9c7568a16"}], "stats": {"total": 19, "additions": 10, "deletions": 9}, "files": [{"sha": "721fd3e1c0fde01162cf6e186b241bbafe481bae", "filename": "compiler/rustc_borrowck/src/invalidation.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/17adfeb2b477231515dfcb20a371f9f778969d15/compiler%2Frustc_borrowck%2Fsrc%2Finvalidation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/17adfeb2b477231515dfcb20a371f9f778969d15/compiler%2Frustc_borrowck%2Fsrc%2Finvalidation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Finvalidation.rs?ref=17adfeb2b477231515dfcb20a371f9f778969d15", "patch": "@@ -26,7 +26,7 @@ pub(super) fn generate_invalidates<'tcx>(\n \n     if let Some(all_facts) = all_facts {\n         let _prof_timer = tcx.prof.generic_activity(\"polonius_fact_generation\");\n-        let dominators = body.dominators();\n+        let dominators = body.basic_blocks.dominators();\n         let mut ig = InvalidationGenerator {\n             all_facts,\n             borrow_set,"}, {"sha": "338df3c70e340551a1fbb6e1c8109f6fb4dabfec", "filename": "compiler/rustc_borrowck/src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/17adfeb2b477231515dfcb20a371f9f778969d15/compiler%2Frustc_borrowck%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/17adfeb2b477231515dfcb20a371f9f778969d15/compiler%2Frustc_borrowck%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Flib.rs?ref=17adfeb2b477231515dfcb20a371f9f778969d15", "patch": "@@ -334,7 +334,7 @@ fn do_mir_borrowck<'a, 'tcx>(\n         };\n     }\n \n-    let dominators = body.dominators();\n+    let dominators = body.basic_blocks.dominators();\n \n     let mut mbcx = MirBorrowckCtxt {\n         infcx,"}, {"sha": "24da48ead63a24bca4e41ec5c2e484e6b6cc00db", "filename": "compiler/rustc_codegen_ssa/src/mir/analyze.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/17adfeb2b477231515dfcb20a371f9f778969d15/compiler%2Frustc_codegen_ssa%2Fsrc%2Fmir%2Fanalyze.rs", "raw_url": "https://github.com/rust-lang/rust/raw/17adfeb2b477231515dfcb20a371f9f778969d15/compiler%2Frustc_codegen_ssa%2Fsrc%2Fmir%2Fanalyze.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_ssa%2Fsrc%2Fmir%2Fanalyze.rs?ref=17adfeb2b477231515dfcb20a371f9f778969d15", "patch": "@@ -15,7 +15,7 @@ pub fn non_ssa_locals<'a, 'tcx, Bx: BuilderMethods<'a, 'tcx>>(\n     fx: &FunctionCx<'a, 'tcx, Bx>,\n ) -> BitSet<mir::Local> {\n     let mir = fx.mir;\n-    let dominators = mir.dominators();\n+    let dominators = mir.basic_blocks.dominators();\n     let locals = mir\n         .local_decls\n         .iter()"}, {"sha": "78080fcd581f6e0cdca918dd399939a61945d8ca", "filename": "compiler/rustc_middle/src/mir/basic_blocks.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/17adfeb2b477231515dfcb20a371f9f778969d15/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fbasic_blocks.rs", "raw_url": "https://github.com/rust-lang/rust/raw/17adfeb2b477231515dfcb20a371f9f778969d15/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fbasic_blocks.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fbasic_blocks.rs?ref=17adfeb2b477231515dfcb20a371f9f778969d15", "patch": "@@ -5,6 +5,7 @@ use crate::mir::traversal::PostorderCache;\n use crate::mir::{BasicBlock, BasicBlockData, Successors, START_BLOCK};\n \n use rustc_data_structures::graph;\n+use rustc_data_structures::graph::dominators::{dominators, Dominators};\n use rustc_index::vec::IndexVec;\n \n #[derive(Clone, TyEncodable, TyDecodable, Debug, HashStable, TypeFoldable, TypeVisitable)]\n@@ -34,6 +35,11 @@ impl<'tcx> BasicBlocks<'tcx> {\n         self.is_cyclic.is_cyclic(self)\n     }\n \n+    #[inline]\n+    pub fn dominators(&self) -> Dominators<BasicBlock> {\n+        dominators(&self)\n+    }\n+\n     /// Returns predecessors for each basic block.\n     #[inline]\n     pub fn predecessors(&self) -> &Predecessors {"}, {"sha": "93686128101982c040652482e721cc3e1ddf7067", "filename": "compiler/rustc_middle/src/mir/mod.rs", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/17adfeb2b477231515dfcb20a371f9f778969d15/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/17adfeb2b477231515dfcb20a371f9f778969d15/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fmod.rs?ref=17adfeb2b477231515dfcb20a371f9f778969d15", "patch": "@@ -26,7 +26,7 @@ use rustc_target::abi::{Size, VariantIdx};\n use polonius_engine::Atom;\n pub use rustc_ast::Mutability;\n use rustc_data_structures::fx::FxHashSet;\n-use rustc_data_structures::graph::dominators::{dominators, Dominators};\n+use rustc_data_structures::graph::dominators::Dominators;\n use rustc_index::bit_set::BitMatrix;\n use rustc_index::vec::{Idx, IndexVec};\n use rustc_serialize::{Decodable, Encodable};\n@@ -447,11 +447,6 @@ impl<'tcx> Body<'tcx> {\n             .unwrap_or_else(|| Either::Right(block_data.terminator()))\n     }\n \n-    #[inline]\n-    pub fn dominators(&self) -> Dominators<BasicBlock> {\n-        dominators(&self.basic_blocks)\n-    }\n-\n     #[inline]\n     pub fn yield_ty(&self) -> Option<Ty<'tcx>> {\n         self.generator.as_ref().and_then(|generator| generator.yield_ty)"}]}