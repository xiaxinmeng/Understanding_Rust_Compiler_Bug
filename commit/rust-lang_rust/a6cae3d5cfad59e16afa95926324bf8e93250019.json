{"sha": "a6cae3d5cfad59e16afa95926324bf8e93250019", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE2Y2FlM2Q1Y2ZhZDU5ZTE2YWZhOTU5MjYzMjRiZjhlOTMyNTAwMTk=", "commit": {"author": {"name": "Stein Somers", "email": "git@steinsomers.be", "date": "2020-02-02T11:11:41Z"}, "committer": {"name": "Stein Somers", "email": "git@steinsomers.be", "date": "2020-03-29T14:05:53Z"}, "message": "Add benchmarks of drain_filter-like behaviour", "tree": {"sha": "1a338a33630bcbf955cc30c336f2afe115624c1b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1a338a33630bcbf955cc30c336f2afe115624c1b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a6cae3d5cfad59e16afa95926324bf8e93250019", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a6cae3d5cfad59e16afa95926324bf8e93250019", "html_url": "https://github.com/rust-lang/rust/commit/a6cae3d5cfad59e16afa95926324bf8e93250019", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a6cae3d5cfad59e16afa95926324bf8e93250019/comments", "author": {"login": "ssomers", "id": 10174877, "node_id": "MDQ6VXNlcjEwMTc0ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/10174877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssomers", "html_url": "https://github.com/ssomers", "followers_url": "https://api.github.com/users/ssomers/followers", "following_url": "https://api.github.com/users/ssomers/following{/other_user}", "gists_url": "https://api.github.com/users/ssomers/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssomers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssomers/subscriptions", "organizations_url": "https://api.github.com/users/ssomers/orgs", "repos_url": "https://api.github.com/users/ssomers/repos", "events_url": "https://api.github.com/users/ssomers/events{/privacy}", "received_events_url": "https://api.github.com/users/ssomers/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ssomers", "id": 10174877, "node_id": "MDQ6VXNlcjEwMTc0ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/10174877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssomers", "html_url": "https://github.com/ssomers", "followers_url": "https://api.github.com/users/ssomers/followers", "following_url": "https://api.github.com/users/ssomers/following{/other_user}", "gists_url": "https://api.github.com/users/ssomers/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssomers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssomers/subscriptions", "organizations_url": "https://api.github.com/users/ssomers/orgs", "repos_url": "https://api.github.com/users/ssomers/repos", "events_url": "https://api.github.com/users/ssomers/events{/privacy}", "received_events_url": "https://api.github.com/users/ssomers/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8ab82b87af4f20b6c0a481e050517103d50263e9", "url": "https://api.github.com/repos/rust-lang/rust/commits/8ab82b87af4f20b6c0a481e050517103d50263e9", "html_url": "https://github.com/rust-lang/rust/commit/8ab82b87af4f20b6c0a481e050517103d50263e9"}], "stats": {"total": 24, "additions": 24, "deletions": 0}, "files": [{"sha": "c4712e2132f786eaaa54a28de7517cd44d69c6cf", "filename": "src/liballoc/benches/btree/set.rs", "status": "modified", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/a6cae3d5cfad59e16afa95926324bf8e93250019/src%2Fliballoc%2Fbenches%2Fbtree%2Fset.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a6cae3d5cfad59e16afa95926324bf8e93250019/src%2Fliballoc%2Fbenches%2Fbtree%2Fset.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Fbenches%2Fbtree%2Fset.rs?ref=a6cae3d5cfad59e16afa95926324bf8e93250019", "patch": "@@ -62,6 +62,18 @@ pub fn clone_100_and_clear(b: &mut Bencher) {\n     b.iter(|| src.clone().clear())\n }\n \n+#[bench]\n+pub fn clone_100_and_drain_half(b: &mut Bencher) {\n+    let src = pos(100);\n+    b.iter(|| {\n+        let mut set = src.clone();\n+        for i in set.iter().copied().filter(|i| i % 2 == 0).collect::<Vec<_>>() {\n+            set.remove(&i);\n+        }\n+        assert_eq!(set.len(), 100 / 2);\n+    })\n+}\n+\n #[bench]\n pub fn clone_100_and_into_iter(b: &mut Bencher) {\n     let src = pos(100);\n@@ -115,6 +127,18 @@ pub fn clone_10k_and_clear(b: &mut Bencher) {\n     b.iter(|| src.clone().clear())\n }\n \n+#[bench]\n+pub fn clone_10k_and_drain_half(b: &mut Bencher) {\n+    let src = pos(10_000);\n+    b.iter(|| {\n+        let mut set = src.clone();\n+        for i in set.iter().copied().filter(|i| i % 2 == 0).collect::<Vec<_>>() {\n+            set.remove(&i);\n+        }\n+        assert_eq!(set.len(), 10_000 / 2);\n+    })\n+}\n+\n #[bench]\n pub fn clone_10k_and_into_iter(b: &mut Bencher) {\n     let src = pos(10_000);"}]}