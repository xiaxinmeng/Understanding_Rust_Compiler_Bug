{"sha": "1fb67363bfeb66a956297a81bc1c95c8aaee056a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFmYjY3MzYzYmZlYjY2YTk1NjI5N2E4MWJjMWM5NWM4YWFlZTA1NmE=", "commit": {"author": {"name": "Simon Sapin", "email": "simon.sapin@exyr.org", "date": "2020-07-29T08:57:16Z"}, "committer": {"name": "Simon Sapin", "email": "simon.sapin@exyr.org", "date": "2020-07-29T09:00:31Z"}, "message": "Remove deprecated unstable `{Box,Rc,Arc}::into_raw_non_null`\u00a0functions\n\nFCP: https://github.com/rust-lang/rust/issues/47336#issuecomment-619369613", "tree": {"sha": "8d0bb1e1b074a370b55a217b5819b8f34207cf55", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8d0bb1e1b074a370b55a217b5819b8f34207cf55"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1fb67363bfeb66a956297a81bc1c95c8aaee056a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1fb67363bfeb66a956297a81bc1c95c8aaee056a", "html_url": "https://github.com/rust-lang/rust/commit/1fb67363bfeb66a956297a81bc1c95c8aaee056a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1fb67363bfeb66a956297a81bc1c95c8aaee056a/comments", "author": {"login": "SimonSapin", "id": 291359, "node_id": "MDQ6VXNlcjI5MTM1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SimonSapin", "html_url": "https://github.com/SimonSapin", "followers_url": "https://api.github.com/users/SimonSapin/followers", "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}", "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}", "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions", "organizations_url": "https://api.github.com/users/SimonSapin/orgs", "repos_url": "https://api.github.com/users/SimonSapin/repos", "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}", "received_events_url": "https://api.github.com/users/SimonSapin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "SimonSapin", "id": 291359, "node_id": "MDQ6VXNlcjI5MTM1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SimonSapin", "html_url": "https://github.com/SimonSapin", "followers_url": "https://api.github.com/users/SimonSapin/followers", "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}", "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}", "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions", "organizations_url": "https://api.github.com/users/SimonSapin/orgs", "repos_url": "https://api.github.com/users/SimonSapin/repos", "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}", "received_events_url": "https://api.github.com/users/SimonSapin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "10c375700ce170fc57cb617754dc6d0631d3d573", "url": "https://api.github.com/repos/rust-lang/rust/commits/10c375700ce170fc57cb617754dc6d0631d3d573", "html_url": "https://github.com/rust-lang/rust/commit/10c375700ce170fc57cb617754dc6d0631d3d573"}], "stats": {"total": 92, "additions": 1, "deletions": 91}, "files": [{"sha": "65e0c984fe893d0eaba2faf63adb74de20447e24", "filename": "library/alloc/src/boxed.rs", "status": "modified", "additions": 1, "deletions": 45, "changes": 46, "blob_url": "https://github.com/rust-lang/rust/blob/1fb67363bfeb66a956297a81bc1c95c8aaee056a/library%2Falloc%2Fsrc%2Fboxed.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1fb67363bfeb66a956297a81bc1c95c8aaee056a/library%2Falloc%2Fsrc%2Fboxed.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fboxed.rs?ref=1fb67363bfeb66a956297a81bc1c95c8aaee056a", "patch": "@@ -143,7 +143,7 @@ use core::ops::{\n     CoerceUnsized, Deref, DerefMut, DispatchFromDyn, Generator, GeneratorState, Receiver,\n };\n use core::pin::Pin;\n-use core::ptr::{self, NonNull, Unique};\n+use core::ptr::{self, Unique};\n use core::task::{Context, Poll};\n \n use crate::alloc::{self, AllocInit, AllocRef, Global};\n@@ -451,50 +451,6 @@ impl<T: ?Sized> Box<T> {\n         Box::leak(b) as *mut T\n     }\n \n-    /// Consumes the `Box`, returning the wrapped pointer as `NonNull<T>`.\n-    ///\n-    /// After calling this function, the caller is responsible for the\n-    /// memory previously managed by the `Box`. In particular, the\n-    /// caller should properly destroy `T` and release the memory. The\n-    /// easiest way to do so is to convert the `NonNull<T>` pointer\n-    /// into a raw pointer and back into a `Box` with the [`Box::from_raw`]\n-    /// function.\n-    ///\n-    /// Note: this is an associated function, which means that you have\n-    /// to call it as `Box::into_raw_non_null(b)`\n-    /// instead of `b.into_raw_non_null()`. This\n-    /// is so that there is no conflict with a method on the inner type.\n-    ///\n-    /// [`Box::from_raw`]: struct.Box.html#method.from_raw\n-    ///\n-    /// # Examples\n-    ///\n-    /// ```\n-    /// #![feature(box_into_raw_non_null)]\n-    /// #![allow(deprecated)]\n-    ///\n-    /// let x = Box::new(5);\n-    /// let ptr = Box::into_raw_non_null(x);\n-    ///\n-    /// // Clean up the memory by converting the NonNull pointer back\n-    /// // into a Box and letting the Box be dropped.\n-    /// let x = unsafe { Box::from_raw(ptr.as_ptr()) };\n-    /// ```\n-    #[unstable(feature = \"box_into_raw_non_null\", issue = \"47336\")]\n-    #[rustc_deprecated(\n-        since = \"1.44.0\",\n-        reason = \"use `Box::leak(b).into()` or `NonNull::from(Box::leak(b))` instead\"\n-    )]\n-    #[inline]\n-    pub fn into_raw_non_null(b: Box<T>) -> NonNull<T> {\n-        // Box is recognized as a \"unique pointer\" by Stacked Borrows, but internally it is a\n-        // raw pointer for the type system. Turning it directly into a raw pointer would not be\n-        // recognized as \"releasing\" the unique pointer to permit aliased raw accesses,\n-        // so all raw pointer methods go through `leak` which creates a (unique)\n-        // mutable reference. Turning *that* to a raw pointer behaves correctly.\n-        Box::leak(b).into()\n-    }\n-\n     #[unstable(\n         feature = \"ptr_internals\",\n         issue = \"none\","}, {"sha": "d3450cfbc814eee0309fd4b7da1b03c3b772df5a", "filename": "library/alloc/src/rc.rs", "status": "modified", "additions": 0, "deletions": 23, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/1fb67363bfeb66a956297a81bc1c95c8aaee056a/library%2Falloc%2Fsrc%2Frc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1fb67363bfeb66a956297a81bc1c95c8aaee056a/library%2Falloc%2Fsrc%2Frc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Frc.rs?ref=1fb67363bfeb66a956297a81bc1c95c8aaee056a", "patch": "@@ -645,29 +645,6 @@ impl<T: ?Sized> Rc<T> {\n         unsafe { Self::from_ptr(rc_ptr) }\n     }\n \n-    /// Consumes the `Rc`, returning the wrapped pointer as `NonNull<T>`.\n-    ///\n-    /// # Examples\n-    ///\n-    /// ```\n-    /// #![feature(rc_into_raw_non_null)]\n-    /// #![allow(deprecated)]\n-    ///\n-    /// use std::rc::Rc;\n-    ///\n-    /// let x = Rc::new(\"hello\".to_owned());\n-    /// let ptr = Rc::into_raw_non_null(x);\n-    /// let deref = unsafe { ptr.as_ref() };\n-    /// assert_eq!(deref, \"hello\");\n-    /// ```\n-    #[unstable(feature = \"rc_into_raw_non_null\", issue = \"47336\")]\n-    #[rustc_deprecated(since = \"1.44.0\", reason = \"use `Rc::into_raw` instead\")]\n-    #[inline]\n-    pub fn into_raw_non_null(this: Self) -> NonNull<T> {\n-        // safe because Rc guarantees its pointer is non-null\n-        unsafe { NonNull::new_unchecked(Rc::into_raw(this) as *mut _) }\n-    }\n-\n     /// Creates a new [`Weak`][weak] pointer to this allocation.\n     ///\n     /// [weak]: struct.Weak.html"}, {"sha": "906beba2a6296199159044b904d0db19675fda3f", "filename": "library/alloc/src/sync.rs", "status": "modified", "additions": 0, "deletions": 23, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/1fb67363bfeb66a956297a81bc1c95c8aaee056a/library%2Falloc%2Fsrc%2Fsync.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1fb67363bfeb66a956297a81bc1c95c8aaee056a/library%2Falloc%2Fsrc%2Fsync.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fsync.rs?ref=1fb67363bfeb66a956297a81bc1c95c8aaee056a", "patch": "@@ -646,29 +646,6 @@ impl<T: ?Sized> Arc<T> {\n         }\n     }\n \n-    /// Consumes the `Arc`, returning the wrapped pointer as `NonNull<T>`.\n-    ///\n-    /// # Examples\n-    ///\n-    /// ```\n-    /// #![feature(rc_into_raw_non_null)]\n-    /// #![allow(deprecated)]\n-    ///\n-    /// use std::sync::Arc;\n-    ///\n-    /// let x = Arc::new(\"hello\".to_owned());\n-    /// let ptr = Arc::into_raw_non_null(x);\n-    /// let deref = unsafe { ptr.as_ref() };\n-    /// assert_eq!(deref, \"hello\");\n-    /// ```\n-    #[unstable(feature = \"rc_into_raw_non_null\", issue = \"47336\")]\n-    #[rustc_deprecated(since = \"1.44.0\", reason = \"use `Arc::into_raw` instead\")]\n-    #[inline]\n-    pub fn into_raw_non_null(this: Self) -> NonNull<T> {\n-        // safe because Arc guarantees its pointer is non-null\n-        unsafe { NonNull::new_unchecked(Arc::into_raw(this) as *mut _) }\n-    }\n-\n     /// Creates a new [`Weak`][weak] pointer to this allocation.\n     ///\n     /// [weak]: struct.Weak.html"}]}