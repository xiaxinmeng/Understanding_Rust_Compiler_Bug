{"sha": "dcb0721a29f63cd2fb3a30487c81cfb657f0a7ee", "node_id": "C_kwDOAAsO6NoAKGRjYjA3MjFhMjlmNjNjZDJmYjNhMzA0ODdjODFjZmI2NTdmMGE3ZWU", "commit": {"author": {"name": "David Tolnay", "email": "dtolnay@gmail.com", "date": "2022-01-20T04:12:31Z"}, "committer": {"name": "David Tolnay", "email": "dtolnay@gmail.com", "date": "2022-01-20T04:15:08Z"}, "message": "Support --bless for pp-exact pretty printer tests", "tree": {"sha": "0414857bd305fa543b2cf5c6805d08f8266359ad", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0414857bd305fa543b2cf5c6805d08f8266359ad"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/dcb0721a29f63cd2fb3a30487c81cfb657f0a7ee", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEERijF2Cz/ZdaBZKeK+boUO5X/bYIFAmHo4cwACgkQ+boUO5X/\nbYJ2lRAAsZvRgkobfJXrrrLn5HjLTae8WFiGtLChJAMmu+cAx8Nwu9u0QK65iktj\njGWhkItyLsg30YuuSoyeIjTQ98Lri8hJACh1zQBKOvYoKaiBMRSaN5BdWlNTNHFe\nSIFIOx/hq6+rmLGuDYmdVmrXMa5jJVoFtubsWlRE2xu9p9vH2sO8ki4BVjdPKayS\nRP+KrhQhPspvo4CUSF8YfkvZE95Poj1ZO9Qid85K/gcaN4QYz8EqdB/rJ85EZE31\nKB7QxAb06LUpjr4xRJyc8VATGa7PXW4r1eBZO3be4h5faKEYP7TacNyLGMhuVFZ9\n8ADfVSYO3XpEXfaf9TVBXKOEvtcx1v6s9GFSgXt17SDNiJD/wIRmXLKh4+ivTHZ9\nutTg/N7PP2fXoB/km31EPvgSzLK8ynWM4+2jvX9fRoRZEDtu+ODvqOeJMrfnBKNc\nXxA+9ZUn27BCHuCoukppX3c91aDLMSWJhKjEYO1PdssLSlXxqqGlfs5eB8krcODC\nsEUh2eKQK1WxztOvZ9NJD1F12rW8q5SjldFI1/eSWXs6TGDANKWP/6/neVdJVb9K\nlU//c8R2vht3avBX2HC9vdI0h9qqp057rhSwIWDYGlp5atosQ+W5nB6NA3w33iDA\n692vt2ps3eof4GyjtUmBxhp1FEldV2QTV+grCR5KJS1VDDDkhNc=\n=4atK\n-----END PGP SIGNATURE-----", "payload": "tree 0414857bd305fa543b2cf5c6805d08f8266359ad\nparent 237949b6c8e5b387e0a9d1e7a22e0397c95fe488\nauthor David Tolnay <dtolnay@gmail.com> 1642651951 -0800\ncommitter David Tolnay <dtolnay@gmail.com> 1642652108 -0800\n\nSupport --bless for pp-exact pretty printer tests\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/dcb0721a29f63cd2fb3a30487c81cfb657f0a7ee", "html_url": "https://github.com/rust-lang/rust/commit/dcb0721a29f63cd2fb3a30487c81cfb657f0a7ee", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/dcb0721a29f63cd2fb3a30487c81cfb657f0a7ee/comments", "author": {"login": "dtolnay", "id": 1940490, "node_id": "MDQ6VXNlcjE5NDA0OTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtolnay", "html_url": "https://github.com/dtolnay", "followers_url": "https://api.github.com/users/dtolnay/followers", "following_url": "https://api.github.com/users/dtolnay/following{/other_user}", "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions", "organizations_url": "https://api.github.com/users/dtolnay/orgs", "repos_url": "https://api.github.com/users/dtolnay/repos", "events_url": "https://api.github.com/users/dtolnay/events{/privacy}", "received_events_url": "https://api.github.com/users/dtolnay/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dtolnay", "id": 1940490, "node_id": "MDQ6VXNlcjE5NDA0OTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtolnay", "html_url": "https://github.com/dtolnay", "followers_url": "https://api.github.com/users/dtolnay/followers", "following_url": "https://api.github.com/users/dtolnay/following{/other_user}", "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions", "organizations_url": "https://api.github.com/users/dtolnay/orgs", "repos_url": "https://api.github.com/users/dtolnay/repos", "events_url": "https://api.github.com/users/dtolnay/events{/privacy}", "received_events_url": "https://api.github.com/users/dtolnay/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "237949b6c8e5b387e0a9d1e7a22e0397c95fe488", "url": "https://api.github.com/repos/rust-lang/rust/commits/237949b6c8e5b387e0a9d1e7a22e0397c95fe488", "html_url": "https://github.com/rust-lang/rust/commit/237949b6c8e5b387e0a9d1e7a22e0397c95fe488"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "2278501308539f3433c068e71e5d331eb7c90c4f", "filename": "src/tools/compiletest/src/runtest.rs", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/dcb0721a29f63cd2fb3a30487c81cfb657f0a7ee/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dcb0721a29f63cd2fb3a30487c81cfb657f0a7ee/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs?ref=dcb0721a29f63cd2fb3a30487c81cfb657f0a7ee", "patch": "@@ -500,7 +500,19 @@ impl<'test> TestCx<'test> {\n             expected = expected.replace(&cr, \"\");\n         }\n \n-        self.compare_source(&expected, &actual);\n+        if !self.config.bless {\n+            self.compare_source(&expected, &actual);\n+        } else if expected != actual {\n+            let filepath_buf;\n+            let filepath = match &self.props.pp_exact {\n+                Some(file) => {\n+                    filepath_buf = self.testpaths.file.parent().unwrap().join(file);\n+                    &filepath_buf\n+                }\n+                None => &self.testpaths.file,\n+            };\n+            fs::write(filepath, &actual).unwrap();\n+        }\n \n         // If we're only making sure that the output matches then just stop here\n         if self.props.pretty_compare_only {"}]}