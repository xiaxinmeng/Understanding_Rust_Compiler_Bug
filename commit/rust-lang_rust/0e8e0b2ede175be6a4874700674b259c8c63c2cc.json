{"sha": "0e8e0b2ede175be6a4874700674b259c8c63c2cc", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBlOGUwYjJlZGUxNzViZTZhNDg3NDcwMDY3NGIyNTljOGM2M2MyY2M=", "commit": {"author": {"name": "Virgile Andreani", "email": "virgile.andreani@anbuco.fr", "date": "2014-05-04T18:42:45Z"}, "committer": {"name": "Virgile Andreani", "email": "virgile.andreani@anbuco.fr", "date": "2014-05-04T18:42:45Z"}, "message": "Add missing cases to the type_limits lint\n\nand exhaustive testing for the `u8` type.", "tree": {"sha": "8e87d0817233763dc86d0c6d561956f14ad93427", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8e87d0817233763dc86d0c6d561956f14ad93427"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0e8e0b2ede175be6a4874700674b259c8c63c2cc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0e8e0b2ede175be6a4874700674b259c8c63c2cc", "html_url": "https://github.com/rust-lang/rust/commit/0e8e0b2ede175be6a4874700674b259c8c63c2cc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0e8e0b2ede175be6a4874700674b259c8c63c2cc/comments", "author": {"login": "Armavica", "id": 5855503, "node_id": "MDQ6VXNlcjU4NTU1MDM=", "avatar_url": "https://avatars.githubusercontent.com/u/5855503?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Armavica", "html_url": "https://github.com/Armavica", "followers_url": "https://api.github.com/users/Armavica/followers", "following_url": "https://api.github.com/users/Armavica/following{/other_user}", "gists_url": "https://api.github.com/users/Armavica/gists{/gist_id}", "starred_url": "https://api.github.com/users/Armavica/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Armavica/subscriptions", "organizations_url": "https://api.github.com/users/Armavica/orgs", "repos_url": "https://api.github.com/users/Armavica/repos", "events_url": "https://api.github.com/users/Armavica/events{/privacy}", "received_events_url": "https://api.github.com/users/Armavica/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Armavica", "id": 5855503, "node_id": "MDQ6VXNlcjU4NTU1MDM=", "avatar_url": "https://avatars.githubusercontent.com/u/5855503?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Armavica", "html_url": "https://github.com/Armavica", "followers_url": "https://api.github.com/users/Armavica/followers", "following_url": "https://api.github.com/users/Armavica/following{/other_user}", "gists_url": "https://api.github.com/users/Armavica/gists{/gist_id}", "starred_url": "https://api.github.com/users/Armavica/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Armavica/subscriptions", "organizations_url": "https://api.github.com/users/Armavica/orgs", "repos_url": "https://api.github.com/users/Armavica/repos", "events_url": "https://api.github.com/users/Armavica/events{/privacy}", "received_events_url": "https://api.github.com/users/Armavica/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4f1b0b5199085b95d4e33021ebeecde377e6d756", "url": "https://api.github.com/repos/rust-lang/rust/commits/4f1b0b5199085b95d4e33021ebeecde377e6d756", "html_url": "https://github.com/rust-lang/rust/commit/4f1b0b5199085b95d4e33021ebeecde377e6d756"}], "stats": {"total": 20, "additions": 16, "deletions": 4}, "files": [{"sha": "aca8dc61252011131a469292e0cfa4fd06d762ff", "filename": "src/librustc/middle/lint.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/0e8e0b2ede175be6a4874700674b259c8c63c2cc/src%2Flibrustc%2Fmiddle%2Flint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0e8e0b2ede175be6a4874700674b259c8c63c2cc/src%2Flibrustc%2Fmiddle%2Flint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Flint.rs?ref=0e8e0b2ede175be6a4874700674b259c8c63c2cc", "patch": "@@ -788,10 +788,10 @@ fn check_type_limits(cx: &Context, e: &ast::Expr) {\n     fn is_valid<T:cmp::Ord>(binop: ast::BinOp, v: T,\n                             min: T, max: T) -> bool {\n         match binop {\n-            ast::BiLt => v <= max,\n-            ast::BiLe => v < max,\n-            ast::BiGt => v >= min,\n-            ast::BiGe => v > min,\n+            ast::BiLt => v >  min && v <= max,\n+            ast::BiLe => v >= min && v <  max,\n+            ast::BiGt => v >= min && v <  max,\n+            ast::BiGe => v >  min && v <= max,\n             ast::BiEq | ast::BiNe => v >= min && v <= max,\n             _ => fail!()\n         }"}, {"sha": "67ef9cd06803f311a8d6674839ad75205e0202a5", "filename": "src/test/compile-fail/lint-type-limits.rs", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/0e8e0b2ede175be6a4874700674b259c8c63c2cc/src%2Ftest%2Fcompile-fail%2Flint-type-limits.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0e8e0b2ede175be6a4874700674b259c8c63c2cc/src%2Ftest%2Fcompile-fail%2Flint-type-limits.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Flint-type-limits.rs?ref=0e8e0b2ede175be6a4874700674b259c8c63c2cc", "patch": "@@ -29,6 +29,18 @@ fn baz() -> bool {\n                 //~^ WARNING literal out of range for its type\n }\n \n+fn bleh() {\n+    let u = 42u8;\n+    let _ = u > 255; //~ ERROR comparison is useless due to type limits\n+    let _ = 255 < u; //~ ERROR comparison is useless due to type limits\n+    let _ = u < 0; //~ ERROR comparison is useless due to type limits\n+    let _ = 0 > u; //~ ERROR comparison is useless due to type limits\n+    let _ = u <= 255; //~ ERROR comparison is useless due to type limits\n+    let _ = 255 >= u; //~ ERROR comparison is useless due to type limits\n+    let _ = u >= 0; //~ ERROR comparison is useless due to type limits\n+    let _ = 0 <= u; //~ ERROR comparison is useless due to type limits\n+}\n+\n fn qux() {\n     let mut i = 1i8;\n     while 200 != i { //~ ERROR comparison is useless due to type limits"}]}