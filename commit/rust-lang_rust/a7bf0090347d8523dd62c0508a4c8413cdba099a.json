{"sha": "a7bf0090347d8523dd62c0508a4c8413cdba099a", "node_id": "C_kwDOAAsO6NoAKGE3YmYwMDkwMzQ3ZDg1MjNkZDYyYzA1MDhhNGM4NDEzY2RiYTA5OWE", "commit": {"author": {"name": "Jorge Martin Juarez", "email": "50276574+jmj0502@users.noreply.github.com", "date": "2022-07-18T01:39:25Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-07-18T01:39:25Z"}, "message": "Fix/comments inside trait generics gets duplicated (#5446)\n\n* Bugfix: Now slash/start comments aren't duplicated on trait parameters.\r\n\r\n* Removing unnecesary comment.\r\n\r\n* Improvements: Improving the BytePos offset.\r\n\r\n* Improvements: Improving the description of the test cases.", "tree": {"sha": "92a96a7e1d7b1f32fd3eaf252aba6c61a74215fc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/92a96a7e1d7b1f32fd3eaf252aba6c61a74215fc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a7bf0090347d8523dd62c0508a4c8413cdba099a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJi1LnNCRBK7hj4Ov3rIwAAlVEIAAA0cwkuhlvuwkxvVmq5GacB\npEVCvLr5hw5K5MYabIREaMqnTaZVbY7y+fJ3PWYqcJGqA4D04c27UN6ayKcch9LM\nDz3nzDWPXeZVQ2WFSASGSxSD6w4GNZWozQK8SAnSWuk1dToTjizC7yr4nUMCKxGk\nkziBmfJRqqELTyZFa/rZBaSNy4fiPawA3hIc+uDX+4WYISoMUqdJZNK4rUR92APg\n5kVPAzrUXUloPepLkNEbaIZ7xR/JkI6Oes4HiTiTMOqBxToHgy7CzKWDfSuGIZxB\nHdh3Y/6DJgk/+4k69oIljXno+MyCEw9AUy+z6gQ0yTlunn658w0YltlgtmLuOq4=\n=dgh3\n-----END PGP SIGNATURE-----\n", "payload": "tree 92a96a7e1d7b1f32fd3eaf252aba6c61a74215fc\nparent 85fdf8ecec5551e79dc5ac3a8babaf514a58ef86\nauthor Jorge Martin Juarez <50276574+jmj0502@users.noreply.github.com> 1658108365 -0400\ncommitter GitHub <noreply@github.com> 1658108365 -0400\n\nFix/comments inside trait generics gets duplicated (#5446)\n\n* Bugfix: Now slash/start comments aren't duplicated on trait parameters.\r\n\r\n* Removing unnecesary comment.\r\n\r\n* Improvements: Improving the BytePos offset.\r\n\r\n* Improvements: Improving the description of the test cases."}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a7bf0090347d8523dd62c0508a4c8413cdba099a", "html_url": "https://github.com/rust-lang/rust/commit/a7bf0090347d8523dd62c0508a4c8413cdba099a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a7bf0090347d8523dd62c0508a4c8413cdba099a/comments", "author": {"login": "jmj0502", "id": 50276574, "node_id": "MDQ6VXNlcjUwMjc2NTc0", "avatar_url": "https://avatars.githubusercontent.com/u/50276574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jmj0502", "html_url": "https://github.com/jmj0502", "followers_url": "https://api.github.com/users/jmj0502/followers", "following_url": "https://api.github.com/users/jmj0502/following{/other_user}", "gists_url": "https://api.github.com/users/jmj0502/gists{/gist_id}", "starred_url": "https://api.github.com/users/jmj0502/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jmj0502/subscriptions", "organizations_url": "https://api.github.com/users/jmj0502/orgs", "repos_url": "https://api.github.com/users/jmj0502/repos", "events_url": "https://api.github.com/users/jmj0502/events{/privacy}", "received_events_url": "https://api.github.com/users/jmj0502/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "85fdf8ecec5551e79dc5ac3a8babaf514a58ef86", "url": "https://api.github.com/repos/rust-lang/rust/commits/85fdf8ecec5551e79dc5ac3a8babaf514a58ef86", "html_url": "https://github.com/rust-lang/rust/commit/85fdf8ecec5551e79dc5ac3a8babaf514a58ef86"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "a76e88b77d484ae5d0714b604fc203b90e3fdcac", "filename": "src/items.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a7bf0090347d8523dd62c0508a4c8413cdba099a/src%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a7bf0090347d8523dd62c0508a4c8413cdba099a/src%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fitems.rs?ref=a7bf0090347d8523dd62c0508a4c8413cdba099a", "patch": "@@ -1084,7 +1084,11 @@ pub(crate) fn format_trait(\n             let item_snippet = context.snippet(item.span);\n             if let Some(lo) = item_snippet.find('/') {\n                 // 1 = `{`\n-                let comment_hi = body_lo - BytePos(1);\n+                let comment_hi = if generics.params.len() > 0 {\n+                    generics.span.lo() - BytePos(1)\n+                } else {\n+                    body_lo - BytePos(1)\n+                };\n                 let comment_lo = item.span.lo() + BytePos(lo as u32);\n                 if comment_lo < comment_hi {\n                     match recover_missing_comment_in_span("}, {"sha": "d4bf4909ad76f2fc4f9165d0dfc68bd5b4b1eefa", "filename": "tests/target/issue-5358.rs", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a7bf0090347d8523dd62c0508a4c8413cdba099a/tests%2Ftarget%2Fissue-5358.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a7bf0090347d8523dd62c0508a4c8413cdba099a/tests%2Ftarget%2Fissue-5358.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-5358.rs?ref=a7bf0090347d8523dd62c0508a4c8413cdba099a", "patch": "@@ -0,0 +1,4 @@\n+// Test /* comment */ inside trait generics does not get duplicated.\n+trait Test</* comment */ T> {}\n+\n+trait TestTwo</* comment */ T, /* comment */ V> {}"}]}