{"sha": "6781692732d04968fe8ce09ded59f2faae492d82", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY3ODE2OTI3MzJkMDQ5NjhmZThjZTA5ZGVkNTlmMmZhYWU0OTJkODI=", "commit": {"author": {"name": "Ilya Bobyr", "email": "ilya.bobyr@gmail.com", "date": "2021-02-04T02:33:19Z"}, "committer": {"name": "Ilya Bobyr", "email": "ilya.bobyr@gmail.com", "date": "2021-02-08T04:24:56Z"}, "message": "Explain how initial configuration is sent over LSP.", "tree": {"sha": "a7a4b0724e29cf299757378c2f00662506d834e0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a7a4b0724e29cf299757378c2f00662506d834e0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6781692732d04968fe8ce09ded59f2faae492d82", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6781692732d04968fe8ce09ded59f2faae492d82", "html_url": "https://github.com/rust-lang/rust/commit/6781692732d04968fe8ce09ded59f2faae492d82", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6781692732d04968fe8ce09ded59f2faae492d82/comments", "author": {"login": "ilya-bobyr", "id": 694419, "node_id": "MDQ6VXNlcjY5NDQxOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/694419?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ilya-bobyr", "html_url": "https://github.com/ilya-bobyr", "followers_url": "https://api.github.com/users/ilya-bobyr/followers", "following_url": "https://api.github.com/users/ilya-bobyr/following{/other_user}", "gists_url": "https://api.github.com/users/ilya-bobyr/gists{/gist_id}", "starred_url": "https://api.github.com/users/ilya-bobyr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ilya-bobyr/subscriptions", "organizations_url": "https://api.github.com/users/ilya-bobyr/orgs", "repos_url": "https://api.github.com/users/ilya-bobyr/repos", "events_url": "https://api.github.com/users/ilya-bobyr/events{/privacy}", "received_events_url": "https://api.github.com/users/ilya-bobyr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ilya-bobyr", "id": 694419, "node_id": "MDQ6VXNlcjY5NDQxOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/694419?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ilya-bobyr", "html_url": "https://github.com/ilya-bobyr", "followers_url": "https://api.github.com/users/ilya-bobyr/followers", "following_url": "https://api.github.com/users/ilya-bobyr/following{/other_user}", "gists_url": "https://api.github.com/users/ilya-bobyr/gists{/gist_id}", "starred_url": "https://api.github.com/users/ilya-bobyr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ilya-bobyr/subscriptions", "organizations_url": "https://api.github.com/users/ilya-bobyr/orgs", "repos_url": "https://api.github.com/users/ilya-bobyr/repos", "events_url": "https://api.github.com/users/ilya-bobyr/events{/privacy}", "received_events_url": "https://api.github.com/users/ilya-bobyr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "336909b63a14b801520c6627d90d750babcfe280", "url": "https://api.github.com/repos/rust-lang/rust/commits/336909b63a14b801520c6627d90d750babcfe280", "html_url": "https://github.com/rust-lang/rust/commit/336909b63a14b801520c6627d90d750babcfe280"}], "stats": {"total": 32, "additions": 27, "deletions": 5}, "files": [{"sha": "93bf6d6785cbda479f28a06eff25c684923a435b", "filename": "docs/user/manual.adoc", "status": "modified", "additions": 27, "deletions": 5, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/6781692732d04968fe8ce09ded59f2faae492d82/docs%2Fuser%2Fmanual.adoc", "raw_url": "https://github.com/rust-lang/rust/raw/6781692732d04968fe8ce09ded59f2faae492d82/docs%2Fuser%2Fmanual.adoc", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/docs%2Fuser%2Fmanual.adoc?ref=6781692732d04968fe8ce09ded59f2faae492d82", "patch": "@@ -335,13 +335,35 @@ If the LSP binary is not available, GNOME Builder can install it when opening a\n \n **Source:** https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/rust-analyzer/src/config.rs[config.rs]\n \n-rust-analyzer is configured via LSP messages, which means that it's up to the editor to decide on the exact format and location of configuration files.\n-Please consult your editor's documentation to learn how to configure LSP servers.\n+The <<_installation,Installation>> section contains details on configuration for some of the editors.\n+In general `rust-analyzer` is configured via LSP messages, which means that it's up to the editor to decide on the exact format and location of configuration files.\n \n-To verify which configuration is actually used by rust-analyzer, set `RA_LOG` environment variable to `rust_analyzer=info` and look for config-related messages.\n-Logs should show both the JSON that rust-analyzer sees as well as the updated config.\n+Some clients, such as <<vs-code,VS Code>> or <<coc-rust-analyzer,COC plugin in Vim>> provide `rust-analyzer` specific configuration UIs. Others may require you to know a bit more about the interaction with `rust-analyzer`.\n \n-This is the list of config options rust-analyzer supports:\n+For the later category, it might help to know that the initial configuration is specified as a value of the `intializationOptions` field of the https://microsoft.github.io/language-server-protocol/specifications/specification-current/#initialize[`InitializeParams` message, in the LSP protocol].\n+The spec says that the field type is `any?`, but `rust-analyzer` is looking for a JSON object that is constructed using settings from the list below.\n+Name of the setting, ignoring the `rust-analyzer.` prefix, is used as a path, and value of the setting becomes the JSON property value.\n+\n+For example, a very common configuration is to enable proc-macro support, can be achieved by sending this JSON:\n+\n+[source,json]\n+----\n+{\n+  \"cargo\": {\n+    \"loadOutDirsFromCheck\": true,\n+  },\n+  \"procMacro\": {\n+    \"enable\": true,\n+  }\n+}\n+----\n+\n+Please consult your editor's documentation to learn more about how to configure https://microsoft.github.io/language-server-protocol/[LSP servers].\n+\n+To verify which configuration is actually used by `rust-analyzer`, set `RA_LOG` environment variable to `rust_analyzer=info` and look for config-related messages.\n+Logs should show both the JSON that `rust-analyzer` sees as well as the updated config.\n+\n+This is the list of config options `rust-analyzer` supports:\n \n include::./generated_config.adoc[]\n "}]}