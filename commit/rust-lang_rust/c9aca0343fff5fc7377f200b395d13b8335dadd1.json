{"sha": "c9aca0343fff5fc7377f200b395d13b8335dadd1", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM5YWNhMDM0M2ZmZjVmYzczNzdmMjAwYjM5NWQxM2I4MzM1ZGFkZDE=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2018-08-01T08:12:50Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-08-01T08:12:50Z"}, "message": "Rollup merge of #52846 - kennytm:bootstrap-curl-timeout, r=Mark-Simulacrum\n\nAdd timeout to use of `curl` in bootstrap.py.\n\nRecently we've seen a lot of \"30 minutes no output\" spurious errors while downloading the bootstrap compiler. This added several timeout options so if the \"30 minutes no output\" errors were caused by connection or transfer issue, we could fail quicker for curl to retry.", "tree": {"sha": "46d0601ab4c6bda3b4e7b4841d6c3c5a818918c5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/46d0601ab4c6bda3b4e7b4841d6c3c5a818918c5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c9aca0343fff5fc7377f200b395d13b8335dadd1", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbYWuCCRBK7hj4Ov3rIwAAdHIIAFFBV1NbbHWJr0z0BeCzXF25\n7lCEYn7GJzZ4Yv5Ew2aq6gn7m6TtjHA+5OOIDdFCuMet/WnIyRbn4EHyYD80MCsa\nsTJUTmLWLOinQweAoKX4KZ0k5287nnreFHwkJFR1carHrFD/Qd0EAM/KzZxeZnRQ\nmkrDra5o5Kc+X9sdZIQjH5GsmWhVpIB+ciYAkwktb/8Erju7SHxqN6vRXfeyyf1J\n4GcqNOc/ezz8eMllp8pdxgIa1oqcbKj5L/cx3MzqhWC45dz7o21LeI58gCzze4/Q\nCKEI/TJ0PXsu8z+uW8Cv1vk9opTJs9Q9XW4oqkEoXCw5PHOE0nuo79XkKOmIRQ0=\n=DSxe\n-----END PGP SIGNATURE-----\n", "payload": "tree 46d0601ab4c6bda3b4e7b4841d6c3c5a818918c5\nparent a819a6ce380b54c156dc026185b1cad4e0e11898\nparent 2994b27e4033c2a0b77ab90f5a896ce09a122992\nauthor Pietro Albini <pietro@pietroalbini.org> 1533111170 +0200\ncommitter GitHub <noreply@github.com> 1533111170 +0200\n\nRollup merge of #52846 - kennytm:bootstrap-curl-timeout, r=Mark-Simulacrum\n\nAdd timeout to use of `curl` in bootstrap.py.\n\nRecently we've seen a lot of \"30 minutes no output\" spurious errors while downloading the bootstrap compiler. This added several timeout options so if the \"30 minutes no output\" errors were caused by connection or transfer issue, we could fail quicker for curl to retry.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c9aca0343fff5fc7377f200b395d13b8335dadd1", "html_url": "https://github.com/rust-lang/rust/commit/c9aca0343fff5fc7377f200b395d13b8335dadd1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c9aca0343fff5fc7377f200b395d13b8335dadd1/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a819a6ce380b54c156dc026185b1cad4e0e11898", "url": "https://api.github.com/repos/rust-lang/rust/commits/a819a6ce380b54c156dc026185b1cad4e0e11898", "html_url": "https://github.com/rust-lang/rust/commit/a819a6ce380b54c156dc026185b1cad4e0e11898"}, {"sha": "2994b27e4033c2a0b77ab90f5a896ce09a122992", "url": "https://api.github.com/repos/rust-lang/rust/commits/2994b27e4033c2a0b77ab90f5a896ce09a122992", "html_url": "https://github.com/rust-lang/rust/commit/2994b27e4033c2a0b77ab90f5a896ce09a122992"}], "stats": {"total": 5, "additions": 4, "deletions": 1}, "files": [{"sha": "829487163a945ec21f9850c997901520105ec9b4", "filename": "src/bootstrap/bootstrap.py", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/c9aca0343fff5fc7377f200b395d13b8335dadd1/src%2Fbootstrap%2Fbootstrap.py", "raw_url": "https://github.com/rust-lang/rust/raw/c9aca0343fff5fc7377f200b395d13b8335dadd1/src%2Fbootstrap%2Fbootstrap.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbootstrap.py?ref=c9aca0343fff5fc7377f200b395d13b8335dadd1", "patch": "@@ -88,7 +88,10 @@ def _download(path, url, probably_big, verbose, exception):\n             option = \"-#\"\n         else:\n             option = \"-s\"\n-        run([\"curl\", option, \"--retry\", \"3\", \"-Sf\", \"-o\", path, url],\n+        run([\"curl\", option,\n+             \"-y\", \"30\", \"-Y\", \"10\",    # timeout if speed is < 10 bytes/sec for > 30 seconds\n+             \"--connect-timeout\", \"30\", # timeout if cannot connect within 30 seconds\n+             \"--retry\", \"3\", \"-Sf\", \"-o\", path, url],\n             verbose=verbose,\n             exception=exception)\n "}]}