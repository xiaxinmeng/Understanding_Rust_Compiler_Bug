{"sha": "08b0c92105fc9a0139a30f8215c7ca44e55ac7b0", "node_id": "C_kwDOAAsO6NoAKDA4YjBjOTIxMDVmYzlhMDEzOWEzMGY4MjE1YzdjYTQ0ZTU1YWM3YjA", "commit": {"author": {"name": "btwotwo", "email": "10519967+btwotwo@users.noreply.github.com", "date": "2022-10-06T14:26:49Z"}, "committer": {"name": "btwotwo", "email": "10519967+btwotwo@users.noreply.github.com", "date": "2022-10-06T14:32:19Z"}, "message": "Add helper method to get a macro name from passed string", "tree": {"sha": "b0b67b406313da47f56d7048d2e8cec50598e4b9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b0b67b406313da47f56d7048d2e8cec50598e4b9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/08b0c92105fc9a0139a30f8215c7ca44e55ac7b0", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE7WZLfNy5oeDQue2p1FagNJ1zoKMFAmM+5vMACgkQ1FagNJ1z\noKOXVA//bAh159lt/pNaet5YD3yL2OVxo5jnOKotvVFp4RYIoYKuuVSZeG9JOerJ\no4Ti5vLtWPNjCcBXTcxxoHyql+/tG//GLpyByyxrz6CNwnnXqTtbkJX1nfY9F2n1\nFX0GQ8Cnf2kL2wWrn3GhiituoHDTSf07NmWrlEJ6UO0YthoaLJMsSzCcjqlzUEYq\nlM5hQN8SvqAuGTyUdchmDJqOfKfV+tmO0TGbYcujeKIVoEfBJzEFvspCUo4DFCpv\nIimk3RIKa8FBTop+mgJTX4LCyh85Ed8G2ecrsDhmJ4xKEC2+/XRQpN0D1D38XHCh\nRpoD9Tv/9zny5j+bLopu1WxXcxXJ0C8lmlG01rnHmik33aN59I3SWitHpGLWFR9p\nq3efI7g9FLnR7kpci2kjp2fM4rMi26eMXQpF5KirMvtyR68DAKASo0uZW/7MS3i3\nHHcvyfXoZA73uJqSJDBrtHQk82MYofiRDa6wltRhtwQoj7R3IoNWKFx7K1+nX02m\ni/GzXJi404nUQ4ASomAyRZlkUwPSWQe7E7I4ZzseFIALhTqieiqrz+83CgwS+5b8\nWvLt66uDkltLLps8q/EFOxKfTkK1i4maQFjremjGeVqT1UdeiuSlWlCL09CevCgH\nY1nVuHY/SE2gjuuaYRWWJa2LPmn2jdddfJ+f0WkaDOk3bN9oUck=\n=bGPj\n-----END PGP SIGNATURE-----", "payload": "tree b0b67b406313da47f56d7048d2e8cec50598e4b9\nparent 07621ce09676b5a2267c8305ba85b3d37e1403f4\nauthor btwotwo <10519967+btwotwo@users.noreply.github.com> 1665066409 +0200\ncommitter btwotwo <10519967+btwotwo@users.noreply.github.com> 1665066739 +0200\n\nAdd helper method to get a macro name from passed string\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/08b0c92105fc9a0139a30f8215c7ca44e55ac7b0", "html_url": "https://github.com/rust-lang/rust/commit/08b0c92105fc9a0139a30f8215c7ca44e55ac7b0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/08b0c92105fc9a0139a30f8215c7ca44e55ac7b0/comments", "author": {"login": "btwotwo", "id": 10519967, "node_id": "MDQ6VXNlcjEwNTE5OTY3", "avatar_url": "https://avatars.githubusercontent.com/u/10519967?v=4", "gravatar_id": "", "url": "https://api.github.com/users/btwotwo", "html_url": "https://github.com/btwotwo", "followers_url": "https://api.github.com/users/btwotwo/followers", "following_url": "https://api.github.com/users/btwotwo/following{/other_user}", "gists_url": "https://api.github.com/users/btwotwo/gists{/gist_id}", "starred_url": "https://api.github.com/users/btwotwo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/btwotwo/subscriptions", "organizations_url": "https://api.github.com/users/btwotwo/orgs", "repos_url": "https://api.github.com/users/btwotwo/repos", "events_url": "https://api.github.com/users/btwotwo/events{/privacy}", "received_events_url": "https://api.github.com/users/btwotwo/received_events", "type": "User", "site_admin": false}, "committer": {"login": "btwotwo", "id": 10519967, "node_id": "MDQ6VXNlcjEwNTE5OTY3", "avatar_url": "https://avatars.githubusercontent.com/u/10519967?v=4", "gravatar_id": "", "url": "https://api.github.com/users/btwotwo", "html_url": "https://github.com/btwotwo", "followers_url": "https://api.github.com/users/btwotwo/followers", "following_url": "https://api.github.com/users/btwotwo/following{/other_user}", "gists_url": "https://api.github.com/users/btwotwo/gists{/gist_id}", "starred_url": "https://api.github.com/users/btwotwo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/btwotwo/subscriptions", "organizations_url": "https://api.github.com/users/btwotwo/orgs", "repos_url": "https://api.github.com/users/btwotwo/repos", "events_url": "https://api.github.com/users/btwotwo/events{/privacy}", "received_events_url": "https://api.github.com/users/btwotwo/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "07621ce09676b5a2267c8305ba85b3d37e1403f4", "url": "https://api.github.com/repos/rust-lang/rust/commits/07621ce09676b5a2267c8305ba85b3d37e1403f4", "html_url": "https://github.com/rust-lang/rust/commit/07621ce09676b5a2267c8305ba85b3d37e1403f4"}], "stats": {"total": 11, "additions": 9, "deletions": 2}, "files": [{"sha": "78d6bd008afe74dfb38f5bac82c4ec572313c48b", "filename": "crates/ide-db/src/syntax_helpers/node_ext.rs", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/08b0c92105fc9a0139a30f8215c7ca44e55ac7b0/crates%2Fide-db%2Fsrc%2Fsyntax_helpers%2Fnode_ext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/08b0c92105fc9a0139a30f8215c7ca44e55ac7b0/crates%2Fide-db%2Fsrc%2Fsyntax_helpers%2Fnode_ext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide-db%2Fsrc%2Fsyntax_helpers%2Fnode_ext.rs?ref=08b0c92105fc9a0139a30f8215c7ca44e55ac7b0", "patch": "@@ -2,8 +2,8 @@\n use itertools::Itertools;\n use parser::T;\n use syntax::{\n-    ast::{self, HasLoopBody, PathSegmentKind, VisibilityKind},\n-    AstNode, Preorder, RustLanguage, WalkEvent,\n+    ast::{self, HasLoopBody, PathSegmentKind, VisibilityKind, NameRef},\n+    AstNode, Preorder, RustLanguage, WalkEvent, AstToken,\n };\n \n pub fn expr_as_name_ref(expr: &ast::Expr) -> Option<ast::NameRef> {\n@@ -457,3 +457,10 @@ pub fn parse_tt_as_comma_sep_paths(input: ast::TokenTree) -> Option<Vec<ast::Pat\n         .collect();\n     Some(paths)\n }\n+\n+pub fn get_outer_macro_name(string: &ast::String) -> Option<NameRef> {\n+    let macro_call = string.syntax().parent_ancestors().find_map(ast::MacroCall::cast)?;\n+    let name = macro_call.path()?.segment()?.name_ref()?;\n+\n+    Some(name)\n+}\n\\ No newline at end of file"}]}