{"sha": "0d5768964b2571eb1d58f0766a2089729d5e770a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBkNTc2ODk2NGIyNTcxZWIxZDU4ZjA3NjZhMjA4OTcyOWQ1ZTc3MGE=", "commit": {"author": {"name": "topecongiro", "email": "seuchida@gmail.com", "date": "2017-06-15T14:29:46Z"}, "committer": {"name": "topecongiro", "email": "seuchida@gmail.com", "date": "2017-06-15T22:36:31Z"}, "message": "Format source codes and add a test", "tree": {"sha": "6042c5de6308e1cc8096b80e57d6269b18b1a6c6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6042c5de6308e1cc8096b80e57d6269b18b1a6c6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0d5768964b2571eb1d58f0766a2089729d5e770a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0d5768964b2571eb1d58f0766a2089729d5e770a", "html_url": "https://github.com/rust-lang/rust/commit/0d5768964b2571eb1d58f0766a2089729d5e770a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0d5768964b2571eb1d58f0766a2089729d5e770a/comments", "author": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "committer": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2f17c31fa4c61172cb7cb3298509d973a58f6475", "url": "https://api.github.com/repos/rust-lang/rust/commits/2f17c31fa4c61172cb7cb3298509d973a58f6475", "html_url": "https://github.com/rust-lang/rust/commit/2f17c31fa4c61172cb7cb3298509d973a58f6475"}], "stats": {"total": 41, "additions": 30, "deletions": 11}, "files": [{"sha": "22f963e0609f97c686358cfba21933daab450d6e", "filename": "src/expr.rs", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/0d5768964b2571eb1d58f0766a2089729d5e770a/src%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0d5768964b2571eb1d58f0766a2089729d5e770a/src%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fexpr.rs?ref=0d5768964b2571eb1d58f0766a2089729d5e770a", "patch": "@@ -750,14 +750,14 @@ fn and_one_line(x: Option<String>) -> Option<String> {\n \n fn nop_block_collapse(block_str: Option<String>, budget: usize) -> Option<String> {\n     debug!(\"nop_block_collapse {:?} {}\", block_str, budget);\n-    block_str.map(|block_str| if block_str.starts_with('{') && budget >= 2 &&\n-        (block_str[1..]\n-             .find(|c: char| !c.is_whitespace())\n-             .unwrap() == block_str.len() - 2)\n-    {\n-        \"{}\".to_owned()\n-    } else {\n-        block_str.to_owned()\n+    block_str.map(|block_str| {\n+        if block_str.starts_with('{') && budget >= 2 &&\n+            (block_str[1..].find(|c: char| !c.is_whitespace()).unwrap() == block_str.len() - 2)\n+        {\n+            \"{}\".to_owned()\n+        } else {\n+            block_str.to_owned()\n+        }\n     })\n }\n "}, {"sha": "e3c06ae7956b92eea551b7bcdb6430c581df99d8", "filename": "src/imports.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/0d5768964b2571eb1d58f0766a2089729d5e770a/src%2Fimports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0d5768964b2571eb1d58f0766a2089729d5e770a/src%2Fimports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fimports.rs?ref=0d5768964b2571eb1d58f0766a2089729d5e770a", "patch": "@@ -159,9 +159,9 @@ impl Rewrite for ast::ViewPath {\n     // Returns an empty string when the ViewPath is empty (like foo::bar::{})\n     fn rewrite(&self, context: &RewriteContext, shape: Shape) -> Option<String> {\n         match self.node {\n-            ast::ViewPath_::ViewPathList(_, ref path_list) if path_list.is_empty() => {\n-                Some(String::new())\n-            }\n+            ast::ViewPath_::ViewPathList(_, ref path_list) if path_list.is_empty() => Some(\n+                String::new(),\n+            ),\n             ast::ViewPath_::ViewPathList(ref path, ref path_list) => {\n                 rewrite_use_list(shape, path, path_list, self.span, context)\n             }"}, {"sha": "a13f323e88ff7b1957a19b41dc01e8b5b984e1da", "filename": "tests/target/issue-1681.rs", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/0d5768964b2571eb1d58f0766a2089729d5e770a/tests%2Ftarget%2Fissue-1681.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0d5768964b2571eb1d58f0766a2089729d5e770a/tests%2Ftarget%2Fissue-1681.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-1681.rs?ref=0d5768964b2571eb1d58f0766a2089729d5e770a", "patch": "@@ -0,0 +1,19 @@\n+// rustfmt-max_width: 80\n+\n+fn foo() {\n+    // This is where it gets good\n+    refmut_map_result(self.cache.borrow_mut(), |cache| {\n+        match cache.entry(cache_key) {\n+            Occupied(entry) => Ok(entry.into_mut()),\n+            Vacant(entry) => {\n+                let statement = {\n+                    let sql = try!(entry.key().sql(source));\n+                    prepare_fn(&sql)\n+                };\n+\n+                Ok(entry.insert(try!(statement)))\n+            }\n+            // and now, casually call a method on this\n+        }\n+    }).map(MaybeCached::Cached)\n+}"}]}