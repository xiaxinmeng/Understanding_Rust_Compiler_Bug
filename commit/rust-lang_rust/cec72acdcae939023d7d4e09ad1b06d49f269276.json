{"sha": "cec72acdcae939023d7d4e09ad1b06d49f269276", "node_id": "C_kwDOAAsO6NoAKGNlYzcyYWNkY2FlOTM5MDIzZDdkNGUwOWFkMWIwNmQ0OWYyNjkyNzY", "commit": {"author": {"name": "KarlWithK", "email": "cjh16@rice.edu", "date": "2022-06-15T07:04:18Z"}, "committer": {"name": "KarlWithK", "email": "cjh16@rice.edu", "date": "2022-06-15T07:04:18Z"}, "message": "Add examples using `add_modify` to btree\n\nUpdated the btree's documentation to include two references to\nadd_modify.\n\nThe first is when the `Entry` API is mentioned at the beginning. With\nthe same reasoning as HashMap's documentation, I thought it would best\nto keep `attack`, but show the `mana` example.\n\nThe second is with the `entry` function that is used for the `Entry`\nAPI. The code example was a perfect use for `add_modify`, which is why\nit was changed to reflect that.", "tree": {"sha": "4ec73546952bc8f46cc2617625c12cccf218f8d5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4ec73546952bc8f46cc2617625c12cccf218f8d5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cec72acdcae939023d7d4e09ad1b06d49f269276", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEfGaKbRPVcpmJ+xJrGDNXtBMguysFAmKphLUACgkQGDNXtBMg\nuytwbxAAg8+dtRyl7eGKt7JIbL1cGbgtlOTqqYmqx7YAR3R3l9AQH5+d5QJzFJ+3\nBwK9aFj1yWxCLA3pbuOWL0YbjJoii4AZkuF84SXj7i3+4TF3fVo7JGaprwthCCIt\n0/s46m4xIMINFfeChiVqMx+M/I/zTVHzcVmEo5LTPmhkLUh8D/s9M6vWeR8oPGOJ\n6K3oy+VZOcfGnx76uj9pig2O8M2njkz6SC8YPEgmxzpU4i5jtUIYFxHJ9W5izKTS\nk2SMK1WSIYQvFDfxZHiv6r2rIP0vHk/+bb0MbUX1LrH9Jl0T81919hzzYemr5keX\n6TwFUZPmPBL3YbcYPKWF549LtOx0N/LibPwH71qqf4KrjYn6E1eNJgn3Y22YXHsR\nqZQRe5jJ+OYfY3mCB13Ok9BFl8nNizKnnFQzDylwtutdRTlyM9pa8D9iru8sEt1V\nzuts7jv8tZv1BvhSC/y0gjmfLQJhWBafCAYqqPVYn7RyIaxHUfbNwzElqkMcTJK+\nfIvATuReQCnKZVuINLO21a46Q4+jHNv620PgljTRw4Xwk0Z6oSQbWoaQYErRl66L\nZhbDxt4+1DgYGoZqzG4uc4oQBilQNBWpmC19uuczfIL8ZuidLc25PVTVBC+5Sy4V\n+HmsPWGkv9xU0sbPh1FIm4+50jE6owlXpCBqFvgUl7Fb3Nv1+wg=\n=+6r9\n-----END PGP SIGNATURE-----", "payload": "tree 4ec73546952bc8f46cc2617625c12cccf218f8d5\nparent d3d22e1e664d33519ddc1b4bbc00cc93eed3e7be\nauthor KarlWithK <cjh16@rice.edu> 1655276658 -0500\ncommitter KarlWithK <cjh16@rice.edu> 1655276658 -0500\n\nAdd examples using `add_modify` to btree\n\nUpdated the btree's documentation to include two references to\nadd_modify.\n\nThe first is when the `Entry` API is mentioned at the beginning. With\nthe same reasoning as HashMap's documentation, I thought it would best\nto keep `attack`, but show the `mana` example.\n\nThe second is with the `entry` function that is used for the `Entry`\nAPI. The code example was a perfect use for `add_modify`, which is why\nit was changed to reflect that.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cec72acdcae939023d7d4e09ad1b06d49f269276", "html_url": "https://github.com/rust-lang/rust/commit/cec72acdcae939023d7d4e09ad1b06d49f269276", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cec72acdcae939023d7d4e09ad1b06d49f269276/comments", "author": {"login": "SeniorMars", "id": 31679231, "node_id": "MDQ6VXNlcjMxNjc5MjMx", "avatar_url": "https://avatars.githubusercontent.com/u/31679231?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SeniorMars", "html_url": "https://github.com/SeniorMars", "followers_url": "https://api.github.com/users/SeniorMars/followers", "following_url": "https://api.github.com/users/SeniorMars/following{/other_user}", "gists_url": "https://api.github.com/users/SeniorMars/gists{/gist_id}", "starred_url": "https://api.github.com/users/SeniorMars/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SeniorMars/subscriptions", "organizations_url": "https://api.github.com/users/SeniorMars/orgs", "repos_url": "https://api.github.com/users/SeniorMars/repos", "events_url": "https://api.github.com/users/SeniorMars/events{/privacy}", "received_events_url": "https://api.github.com/users/SeniorMars/received_events", "type": "User", "site_admin": false}, "committer": {"login": "SeniorMars", "id": 31679231, "node_id": "MDQ6VXNlcjMxNjc5MjMx", "avatar_url": "https://avatars.githubusercontent.com/u/31679231?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SeniorMars", "html_url": "https://github.com/SeniorMars", "followers_url": "https://api.github.com/users/SeniorMars/followers", "following_url": "https://api.github.com/users/SeniorMars/following{/other_user}", "gists_url": "https://api.github.com/users/SeniorMars/gists{/gist_id}", "starred_url": "https://api.github.com/users/SeniorMars/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SeniorMars/subscriptions", "organizations_url": "https://api.github.com/users/SeniorMars/orgs", "repos_url": "https://api.github.com/users/SeniorMars/repos", "events_url": "https://api.github.com/users/SeniorMars/events{/privacy}", "received_events_url": "https://api.github.com/users/SeniorMars/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d3d22e1e664d33519ddc1b4bbc00cc93eed3e7be", "url": "https://api.github.com/repos/rust-lang/rust/commits/d3d22e1e664d33519ddc1b4bbc00cc93eed3e7be", "html_url": "https://github.com/rust-lang/rust/commit/d3d22e1e664d33519ddc1b4bbc00cc93eed3e7be"}], "stats": {"total": 7, "additions": 6, "deletions": 1}, "files": [{"sha": "7532c1d5114741223a6a94e17d61107ea6ccb047", "filename": "library/alloc/src/collections/btree/map.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/cec72acdcae939023d7d4e09ad1b06d49f269276/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fmap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cec72acdcae939023d7d4e09ad1b06d49f269276/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fmap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fmap.rs?ref=cec72acdcae939023d7d4e09ad1b06d49f269276", "patch": "@@ -159,6 +159,9 @@ pub(super) const MIN_LEN: usize = node::MIN_LEN_AFTER_SPLIT;\n /// // update a key, guarding against the key possibly not being set\n /// let stat = player_stats.entry(\"attack\").or_insert(100);\n /// *stat += random_stat_buff();\n+///\n+/// // modify an entry before an insert with in-place mutation\n+/// player_stats.entry(\"mana\").and_modify(|mana| *mana += 200).or_insert(100);\n /// ```\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n #[cfg_attr(not(test), rustc_diagnostic_item = \"BTreeMap\")]\n@@ -1135,10 +1138,12 @@ impl<K, V> BTreeMap<K, V> {\n     ///\n     /// // count the number of occurrences of letters in the vec\n     /// for x in [\"a\", \"b\", \"a\", \"c\", \"a\", \"b\"] {\n-    ///     *count.entry(x).or_insert(0) += 1;\n+    ///     count.entry(x).and_modify(|curr| *curr += 1).or_insert(1);\n     /// }\n     ///\n     /// assert_eq!(count[\"a\"], 3);\n+    /// assert_eq!(count[\"b\"], 2);\n+    /// assert_eq!(count[\"1\"], 1);\n     /// ```\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     pub fn entry(&mut self, key: K) -> Entry<'_, K, V>"}]}