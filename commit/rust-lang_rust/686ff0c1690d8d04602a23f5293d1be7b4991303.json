{"sha": "686ff0c1690d8d04602a23f5293d1be7b4991303", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY4NmZmMGMxNjkwZDhkMDQ2MDJhMjNmNTI5M2QxYmU3YjQ5OTEzMDM=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2016-10-21T23:21:58Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2016-10-21T23:21:58Z"}, "message": "Rollup merge of #37211 - srinivasreddy:alt, r=nrc\n\nrun rustfmt on various folders", "tree": {"sha": "e2f4102a44fc39374d64735ce9704610208e07f2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e2f4102a44fc39374d64735ce9704610208e07f2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/686ff0c1690d8d04602a23f5293d1be7b4991303", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/686ff0c1690d8d04602a23f5293d1be7b4991303", "html_url": "https://github.com/rust-lang/rust/commit/686ff0c1690d8d04602a23f5293d1be7b4991303", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/686ff0c1690d8d04602a23f5293d1be7b4991303/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "88d1cbdbab8af117884c935e2b8c07081efb85c9", "url": "https://api.github.com/repos/rust-lang/rust/commits/88d1cbdbab8af117884c935e2b8c07081efb85c9", "html_url": "https://github.com/rust-lang/rust/commit/88d1cbdbab8af117884c935e2b8c07081efb85c9"}, {"sha": "54e320d4bce4a397d165739fda8329a0567b35c4", "url": "https://api.github.com/repos/rust-lang/rust/commits/54e320d4bce4a397d165739fda8329a0567b35c4", "html_url": "https://github.com/rust-lang/rust/commit/54e320d4bce4a397d165739fda8329a0567b35c4"}], "stats": {"total": 65, "additions": 26, "deletions": 39}, "files": [{"sha": "38844fb6c9ef0748c100a1756e72191b6c42d1e2", "filename": "src/build_helper/lib.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/686ff0c1690d8d04602a23f5293d1be7b4991303/src%2Fbuild_helper%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/686ff0c1690d8d04602a23f5293d1be7b4991303/src%2Fbuild_helper%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbuild_helper%2Flib.rs?ref=686ff0c1690d8d04602a23f5293d1be7b4991303", "patch": "@@ -25,7 +25,9 @@ pub fn run_silent(cmd: &mut Command) {\n     };\n     if !status.success() {\n         fail(&format!(\"command did not execute successfully: {:?}\\n\\\n-                       expected success, got: {}\", cmd, status));\n+                       expected success, got: {}\",\n+                      cmd,\n+                      status));\n     }\n }\n \n@@ -65,7 +67,9 @@ pub fn output(cmd: &mut Command) -> String {\n     };\n     if !output.status.success() {\n         panic!(\"command did not execute successfully: {:?}\\n\\\n-                expected success, got: {}\", cmd, output.status);\n+                expected success, got: {}\",\n+               cmd,\n+               output.status);\n     }\n     String::from_utf8(output.stdout).unwrap()\n }"}, {"sha": "f23ea0ea8bf710dcf7794e2560ca14e7eb6595f6", "filename": "src/liballoc/raw_vec.rs", "status": "modified", "additions": 3, "deletions": 11, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/686ff0c1690d8d04602a23f5293d1be7b4991303/src%2Fliballoc%2Fraw_vec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/686ff0c1690d8d04602a23f5293d1be7b4991303/src%2Fliballoc%2Fraw_vec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Fraw_vec.rs?ref=686ff0c1690d8d04602a23f5293d1be7b4991303", "patch": "@@ -57,11 +57,7 @@ impl<T> RawVec<T> {\n     pub fn new() -> Self {\n         unsafe {\n             // !0 is usize::MAX. This branch should be stripped at compile time.\n-            let cap = if mem::size_of::<T>() == 0 {\n-                !0\n-            } else {\n-                0\n-            };\n+            let cap = if mem::size_of::<T>() == 0 { !0 } else { 0 };\n \n             // heap::EMPTY doubles as \"unallocated\" and \"zero-sized allocation\"\n             RawVec {\n@@ -209,11 +205,7 @@ impl<T> RawVec<T> {\n \n             let (new_cap, ptr) = if self.cap == 0 {\n                 // skip to 4 because tiny Vec's are dumb; but not if that would cause overflow\n-                let new_cap = if elem_size > (!0) / 8 {\n-                    1\n-                } else {\n-                    4\n-                };\n+                let new_cap = if elem_size > (!0) / 8 { 1 } else { 4 };\n                 let ptr = heap::allocate(new_cap * elem_size, align);\n                 (new_cap, ptr)\n             } else {\n@@ -347,7 +339,7 @@ impl<T> RawVec<T> {\n         let elem_size = mem::size_of::<T>();\n         // Nothing we can really do about these checks :(\n         let required_cap = used_cap.checked_add(needed_extra_cap)\n-                                   .expect(\"capacity overflow\");\n+            .expect(\"capacity overflow\");\n         // Cannot overflow, because `cap <= isize::MAX`, and type of `cap` is `usize`.\n         let double_cap = self.cap * 2;\n         // `double_cap` guarantees exponential growth."}, {"sha": "369db8e75a398602215d72935f9dc4db2a6f943f", "filename": "src/liballoc_jemalloc/build.rs", "status": "modified", "additions": 14, "deletions": 18, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/686ff0c1690d8d04602a23f5293d1be7b4991303/src%2Fliballoc_jemalloc%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/686ff0c1690d8d04602a23f5293d1be7b4991303/src%2Fliballoc_jemalloc%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc_jemalloc%2Fbuild.rs?ref=686ff0c1690d8d04602a23f5293d1be7b4991303", "patch": "@@ -35,12 +35,8 @@ fn main() {\n     // that the feature set used by std is the same across all\n     // targets, which means we have to build the alloc_jemalloc crate\n     // for targets like emscripten, even if we don't use it.\n-    if target.contains(\"rumprun\") ||\n-        target.contains(\"bitrig\") ||\n-        target.contains(\"openbsd\") ||\n-        target.contains(\"msvc\") ||\n-        target.contains(\"emscripten\")\n-    {\n+    if target.contains(\"rumprun\") || target.contains(\"bitrig\") || target.contains(\"openbsd\") ||\n+       target.contains(\"msvc\") || target.contains(\"emscripten\") {\n         println!(\"cargo:rustc-cfg=dummy_jemalloc\");\n         return;\n     }\n@@ -64,16 +60,16 @@ fn main() {\n     // only msvc returns None for ar so unwrap is okay\n     let ar = build_helper::cc2ar(compiler.path(), &target).unwrap();\n     let cflags = compiler.args()\n-                         .iter()\n-                         .map(|s| s.to_str().unwrap())\n-                         .collect::<Vec<_>>()\n-                         .join(\" \");\n+        .iter()\n+        .map(|s| s.to_str().unwrap())\n+        .collect::<Vec<_>>()\n+        .join(\" \");\n \n     let mut stack = src_dir.join(\"../jemalloc\")\n-                           .read_dir()\n-                           .unwrap()\n-                           .map(|e| e.unwrap())\n-                           .collect::<Vec<_>>();\n+        .read_dir()\n+        .unwrap()\n+        .map(|e| e.unwrap())\n+        .collect::<Vec<_>>();\n     while let Some(entry) = stack.pop() {\n         let path = entry.path();\n         if entry.file_type().unwrap().is_dir() {\n@@ -155,10 +151,10 @@ fn main() {\n \n     run(&mut cmd);\n     run(Command::new(\"make\")\n-            .current_dir(&build_dir)\n-            .arg(\"build_lib_static\")\n-            .arg(\"-j\")\n-            .arg(env::var(\"NUM_JOBS\").expect(\"NUM_JOBS was not set\")));\n+        .current_dir(&build_dir)\n+        .arg(\"build_lib_static\")\n+        .arg(\"-j\")\n+        .arg(env::var(\"NUM_JOBS\").expect(\"NUM_JOBS was not set\")));\n \n     if target.contains(\"windows\") {\n         println!(\"cargo:rustc-link-lib=static=jemalloc\");"}, {"sha": "b380ba180f40ee865939c28cd6c244f2233d4d21", "filename": "src/liballoc_system/lib.rs", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/686ff0c1690d8d04602a23f5293d1be7b4991303/src%2Fliballoc_system%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/686ff0c1690d8d04602a23f5293d1be7b4991303/src%2Fliballoc_system%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc_system%2Flib.rs?ref=686ff0c1690d8d04602a23f5293d1be7b4991303", "patch": "@@ -221,11 +221,7 @@ mod imp {\n                                   HEAP_REALLOC_IN_PLACE_ONLY,\n                                   ptr as LPVOID,\n                                   size as SIZE_T) as *mut u8;\n-            if new.is_null() {\n-                old_size\n-            } else {\n-                size\n-            }\n+            if new.is_null() { old_size } else { size }\n         } else {\n             old_size\n         }"}, {"sha": "8f2db950d143c088410454278135a979cf4c3a88", "filename": "src/libarena/lib.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/686ff0c1690d8d04602a23f5293d1be7b4991303/src%2Flibarena%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/686ff0c1690d8d04602a23f5293d1be7b4991303/src%2Flibarena%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibarena%2Flib.rs?ref=686ff0c1690d8d04602a23f5293d1be7b4991303", "patch": "@@ -335,9 +335,8 @@ mod tests {\n \n         let arena = Wrap(TypedArena::new());\n \n-        let result = arena.alloc_outer(|| {\n-            Outer { inner: arena.alloc_inner(|| Inner { value: 10 }) }\n-        });\n+        let result =\n+            arena.alloc_outer(|| Outer { inner: arena.alloc_inner(|| Inner { value: 10 }) });\n \n         assert_eq!(result.inner.value, 10);\n     }"}]}