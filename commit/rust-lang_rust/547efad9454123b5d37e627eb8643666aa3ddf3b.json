{"sha": "547efad9454123b5d37e627eb8643666aa3ddf3b", "node_id": "C_kwDOAAsO6NoAKDU0N2VmYWQ5NDU0MTIzYjVkMzdlNjI3ZWI4NjQzNjY2YWEzZGRmM2I", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-12-25T13:38:08Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-12-25T13:38:08Z"}, "message": "Auto merge of #8167 - rust-lang:fix-8166, r=xFredNet\n\nfix an ICE on unwrapping a None\n\nThis very likely fixes #8166 though I wasn't able to meaningfully reduce a test case. This line is the only call to `unwrap` within that function, which was the one in the stack trace that triggered the ICE, so I think we'll be OK.\n\n`@hackmad` can you pull and build this branch and check if it indeed fixes your problem?\n\n---\n\nchangelog: Fixed ICE in [`unnecessary_cast`]", "tree": {"sha": "684957a1be46a35444c82862538b88ef36805125", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/684957a1be46a35444c82862538b88ef36805125"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/547efad9454123b5d37e627eb8643666aa3ddf3b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/547efad9454123b5d37e627eb8643666aa3ddf3b", "html_url": "https://github.com/rust-lang/rust/commit/547efad9454123b5d37e627eb8643666aa3ddf3b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/547efad9454123b5d37e627eb8643666aa3ddf3b/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "eb24acf60d02ecc0d1f2ef8ff041f7b10429b545", "url": "https://api.github.com/repos/rust-lang/rust/commits/eb24acf60d02ecc0d1f2ef8ff041f7b10429b545", "html_url": "https://github.com/rust-lang/rust/commit/eb24acf60d02ecc0d1f2ef8ff041f7b10429b545"}, {"sha": "23ffa3ca0485bcdf1b0c553dbc134f33f16c7036", "url": "https://api.github.com/repos/rust-lang/rust/commits/23ffa3ca0485bcdf1b0c553dbc134f33f16c7036", "html_url": "https://github.com/rust-lang/rust/commit/23ffa3ca0485bcdf1b0c553dbc134f33f16c7036"}], "stats": {"total": 5, "additions": 3, "deletions": 2}, "files": [{"sha": "1915d990c126c1e4b990104b1fce603afac4fa53", "filename": "clippy_lints/src/casts/unnecessary_cast.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/547efad9454123b5d37e627eb8643666aa3ddf3b/clippy_lints%2Fsrc%2Fcasts%2Funnecessary_cast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/547efad9454123b5d37e627eb8643666aa3ddf3b/clippy_lints%2Fsrc%2Fcasts%2Funnecessary_cast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fcasts%2Funnecessary_cast.rs?ref=547efad9454123b5d37e627eb8643666aa3ddf3b", "patch": "@@ -49,8 +49,9 @@ pub(super) fn check(\n                 if cast_from.kind() == cast_to.kind() =>\n             {\n                 if let Some(src) = snippet_opt(cx, lit.span) {\n-                    let num_lit = NumericLiteral::from_lit_kind(&src, &lit.node).unwrap();\n-                    lint_unnecessary_cast(cx, expr, num_lit.integer, cast_from, cast_to);\n+                    if let Some(num_lit) = NumericLiteral::from_lit_kind(&src, &lit.node) {\n+                        lint_unnecessary_cast(cx, expr, num_lit.integer, cast_from, cast_to);\n+                    }\n                 }\n             },\n             _ => {"}]}