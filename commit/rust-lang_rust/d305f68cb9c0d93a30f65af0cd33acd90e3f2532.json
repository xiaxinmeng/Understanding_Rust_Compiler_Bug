{"sha": "d305f68cb9c0d93a30f65af0cd33acd90e3f2532", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQzMDVmNjhjYjljMGQ5M2EzMGY2NWFmMGNkMzNhY2Q5MGUzZjI1MzI=", "commit": {"author": {"name": "varkor", "email": "github@varkor.com", "date": "2018-08-15T01:02:52Z"}, "committer": {"name": "varkor", "email": "github@varkor.com", "date": "2018-08-15T01:02:52Z"}, "message": "Warn when `generic_associated_types` feature gate is enabled", "tree": {"sha": "5a9bf729dd921d7a4b93143f5b971b094e8c5f8e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5a9bf729dd921d7a4b93143f5b971b094e8c5f8e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d305f68cb9c0d93a30f65af0cd33acd90e3f2532", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d305f68cb9c0d93a30f65af0cd33acd90e3f2532", "html_url": "https://github.com/rust-lang/rust/commit/d305f68cb9c0d93a30f65af0cd33acd90e3f2532", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d305f68cb9c0d93a30f65af0cd33acd90e3f2532/comments", "author": {"login": "varkor", "id": 3943692, "node_id": "MDQ6VXNlcjM5NDM2OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/3943692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/varkor", "html_url": "https://github.com/varkor", "followers_url": "https://api.github.com/users/varkor/followers", "following_url": "https://api.github.com/users/varkor/following{/other_user}", "gists_url": "https://api.github.com/users/varkor/gists{/gist_id}", "starred_url": "https://api.github.com/users/varkor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/varkor/subscriptions", "organizations_url": "https://api.github.com/users/varkor/orgs", "repos_url": "https://api.github.com/users/varkor/repos", "events_url": "https://api.github.com/users/varkor/events{/privacy}", "received_events_url": "https://api.github.com/users/varkor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "varkor", "id": 3943692, "node_id": "MDQ6VXNlcjM5NDM2OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/3943692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/varkor", "html_url": "https://github.com/varkor", "followers_url": "https://api.github.com/users/varkor/followers", "following_url": "https://api.github.com/users/varkor/following{/other_user}", "gists_url": "https://api.github.com/users/varkor/gists{/gist_id}", "starred_url": "https://api.github.com/users/varkor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/varkor/subscriptions", "organizations_url": "https://api.github.com/users/varkor/orgs", "repos_url": "https://api.github.com/users/varkor/repos", "events_url": "https://api.github.com/users/varkor/events{/privacy}", "received_events_url": "https://api.github.com/users/varkor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a5733050de780ae4d11e3a7af615df792fdf908e", "url": "https://api.github.com/repos/rust-lang/rust/commits/a5733050de780ae4d11e3a7af615df792fdf908e", "html_url": "https://github.com/rust-lang/rust/commit/a5733050de780ae4d11e3a7af615df792fdf908e"}], "stats": {"total": 37, "additions": 37, "deletions": 0}, "files": [{"sha": "98fbbe4bdef0c2759e2b464afe4519b7da023855", "filename": "src/libsyntax/feature_gate.rs", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/d305f68cb9c0d93a30f65af0cd33acd90e3f2532/src%2Flibsyntax%2Ffeature_gate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d305f68cb9c0d93a30f65af0cd33acd90e3f2532/src%2Flibsyntax%2Ffeature_gate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ffeature_gate.rs?ref=d305f68cb9c0d93a30f65af0cd33acd90e3f2532", "patch": "@@ -1920,6 +1920,11 @@ pub fn get_features(span_handler: &Handler, krate_attrs: &[ast::Attribute],\n         err.emit();\n     }\n \n+    // Some features are known to be incomplete and using them is likely to have\n+    // unanticipated results, such as compiler crashes. We warn the user about these\n+    // to alert them.\n+    let incomplete_features = [\"generic_associated_types\"];\n+\n     let mut features = Features::new();\n     let mut edition_enabled_features = FxHashMap();\n \n@@ -1955,6 +1960,16 @@ pub fn get_features(span_handler: &Handler, krate_attrs: &[ast::Attribute],\n                 continue\n             };\n \n+            if incomplete_features.iter().any(|f| *f == name.as_str()) {\n+                span_handler.struct_span_warn(\n+                    mi.span,\n+                    &format!(\n+                        \"the feature `{}` is incomplete and may cause the compiler to crash\",\n+                        name\n+                    )\n+                ).emit();\n+            }\n+\n             if let Some(edition) = ALL_EDITIONS.iter().find(|e| name == e.feature_name()) {\n                 if *edition <= crate_edition {\n                     continue"}, {"sha": "7f48408b369fd2061af811b29149b8f42f6651df", "filename": "src/test/ui/rfc1598-generic-associated-types/gat-incomplete-warning.rs", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/d305f68cb9c0d93a30f65af0cd33acd90e3f2532/src%2Ftest%2Fui%2Frfc1598-generic-associated-types%2Fgat-incomplete-warning.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d305f68cb9c0d93a30f65af0cd33acd90e3f2532/src%2Ftest%2Fui%2Frfc1598-generic-associated-types%2Fgat-incomplete-warning.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc1598-generic-associated-types%2Fgat-incomplete-warning.rs?ref=d305f68cb9c0d93a30f65af0cd33acd90e3f2532", "patch": "@@ -0,0 +1,16 @@\n+// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// run-pass\n+\n+#![feature(generic_associated_types)]\n+//~^ WARNING the feature `generic_associated_types` is incomplete\n+\n+fn main() {}"}, {"sha": "67682dcb8fb1b3e154be3ddd69c48939809b17d0", "filename": "src/test/ui/rfc1598-generic-associated-types/gat-incomplete-warning.stderr", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d305f68cb9c0d93a30f65af0cd33acd90e3f2532/src%2Ftest%2Fui%2Frfc1598-generic-associated-types%2Fgat-incomplete-warning.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d305f68cb9c0d93a30f65af0cd33acd90e3f2532/src%2Ftest%2Fui%2Frfc1598-generic-associated-types%2Fgat-incomplete-warning.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc1598-generic-associated-types%2Fgat-incomplete-warning.stderr?ref=d305f68cb9c0d93a30f65af0cd33acd90e3f2532", "patch": "@@ -0,0 +1,6 @@\n+warning: the feature `generic_associated_types` is incomplete and may cause the compiler to crash\n+  --> $DIR/gat-incomplete-warning.rs:13:12\n+   |\n+LL | #![feature(generic_associated_types)]\n+   |            ^^^^^^^^^^^^^^^^^^^^^^^^\n+"}]}