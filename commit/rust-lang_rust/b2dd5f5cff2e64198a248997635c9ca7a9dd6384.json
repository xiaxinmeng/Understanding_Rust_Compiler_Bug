{"sha": "b2dd5f5cff2e64198a248997635c9ca7a9dd6384", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIyZGQ1ZjVjZmYyZTY0MTk4YTI0ODk5NzYzNWM5Y2E3YTlkZDYzODQ=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-11-12T00:23:38Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-11-12T00:52:07Z"}, "message": "Rehabilitate run-pass/task-killjoin.rs", "tree": {"sha": "a6de676e25c1858d6ca497bc5772bd91264720be", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a6de676e25c1858d6ca497bc5772bd91264720be"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b2dd5f5cff2e64198a248997635c9ca7a9dd6384", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b2dd5f5cff2e64198a248997635c9ca7a9dd6384", "html_url": "https://github.com/rust-lang/rust/commit/b2dd5f5cff2e64198a248997635c9ca7a9dd6384", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b2dd5f5cff2e64198a248997635c9ca7a9dd6384/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a6f9f73f06a075343fe71a2fd7b1ba06d71366a2", "url": "https://api.github.com/repos/rust-lang/rust/commits/a6f9f73f06a075343fe71a2fd7b1ba06d71366a2", "html_url": "https://github.com/rust-lang/rust/commit/a6f9f73f06a075343fe71a2fd7b1ba06d71366a2"}], "stats": {"total": 16, "additions": 7, "deletions": 9}, "files": [{"sha": "7bbbc75cf0a0d2f1cf52f4e9fa1f8168b86399b1", "filename": "src/test/run-pass/task-killjoin.rs", "status": "modified", "additions": 7, "deletions": 9, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/b2dd5f5cff2e64198a248997635c9ca7a9dd6384/src%2Ftest%2Frun-pass%2Ftask-killjoin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b2dd5f5cff2e64198a248997635c9ca7a9dd6384/src%2Ftest%2Frun-pass%2Ftask-killjoin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Ftask-killjoin.rs?ref=b2dd5f5cff2e64198a248997635c9ca7a9dd6384", "patch": "@@ -1,5 +1,4 @@\n-// xfail-test\n-\n+// xfail-win32\n // Create a task that is supervised by another task,\n // join the supervised task from the supervising task,\n // then fail the supervised task. The supervised task\n@@ -10,27 +9,26 @@\n use std;\n import std::task;\n \n-fn supervised() {\n+fn supervised(&&_args: ()) {\n     // Yield to make sure the supervisor joins before we\n     // fail. This is currently not needed because the supervisor\n     // runs first, but I can imagine that changing.\n     task::yield();\n     fail;\n }\n \n-fn supervisor() {\n+fn supervisor(&&_args: ()) {\n     // Unsupervise this task so the process doesn't return a failure status as\n     // a result of the main task being killed.\n     task::unsupervise();\n     let f = supervised;\n-    let t = task::_spawn(supervised);\n-    task::join_id(t);\n+    let t = task::spawn_joinable((), supervised);\n+    task::join(t);\n }\n \n fn main() {\n-    let f = supervisor;\n-    let dom2 = task::_spawn(f);\n-    task::join_id(dom2);\n+    let dom2 = task::spawn_joinable((), supervisor);\n+    task::join(dom2);\n }\n \n // Local Variables:"}]}