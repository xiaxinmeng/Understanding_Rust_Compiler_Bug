{"sha": "d480ceff384f80394e9367b5e9d3596d62f20585", "node_id": "C_kwDOAAsO6NoAKGQ0ODBjZWZmMzg0ZjgwMzk0ZTkzNjdiNWU5ZDM1OTZkNjJmMjA1ODU", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-10-06T17:06:29Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-10-06T17:06:29Z"}, "message": "Auto merge of #89599 - rusticstuff:ci-fix, r=Mark-Simulacrum\n\nSwitch to our own mirror of libisl plus `ct-ng oldconfig` fixes\n\nSwitching to mirror the ISL libs (#89594) unearthed a (possibly long-standing?) issue with `ct-ng oldconfig`. It always overwrites the mirror config values. This PR adds the ISL mirror, gets rid of `ct-ng oldconfig` and adds crosstools-ng config files which can be used directly. (Edited)\n\nFixes #89593.\n\nr? `@pietroalbini`", "tree": {"sha": "77eab5d7fe1e937fa8aecea12d647c2644431c58", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/77eab5d7fe1e937fa8aecea12d647c2644431c58"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d480ceff384f80394e9367b5e9d3596d62f20585", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d480ceff384f80394e9367b5e9d3596d62f20585", "html_url": "https://github.com/rust-lang/rust/commit/d480ceff384f80394e9367b5e9d3596d62f20585", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d480ceff384f80394e9367b5e9d3596d62f20585/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d7539a6af09e5889ed9bcb8b49571b7a59c32e65", "url": "https://api.github.com/repos/rust-lang/rust/commits/d7539a6af09e5889ed9bcb8b49571b7a59c32e65", "html_url": "https://github.com/rust-lang/rust/commit/d7539a6af09e5889ed9bcb8b49571b7a59c32e65"}, {"sha": "b5f9cdb5300b4e9d8eb6422776518dddda7120e1", "url": "https://api.github.com/repos/rust-lang/rust/commits/b5f9cdb5300b4e9d8eb6422776518dddda7120e1", "html_url": "https://github.com/rust-lang/rust/commit/b5f9cdb5300b4e9d8eb6422776518dddda7120e1"}], "stats": {"total": 36, "additions": 12, "deletions": 24}, "files": [{"sha": "e047db92652c2f02e843ccbde25201a08a501f25", "filename": "src/ci/docker/host-x86_64/dist-arm-linux/arm-linux-gnueabi.config", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d480ceff384f80394e9367b5e9d3596d62f20585/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-arm-linux%2Farm-linux-gnueabi.config", "raw_url": "https://github.com/rust-lang/rust/raw/d480ceff384f80394e9367b5e9d3596d62f20585/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-arm-linux%2Farm-linux-gnueabi.config", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-arm-linux%2Farm-linux-gnueabi.config?ref=d480ceff384f80394e9367b5e9d3596d62f20585", "patch": "@@ -611,7 +611,7 @@ CT_ISL_V_0_20=y\n # CT_ISL_V_0_15 is not set\n # CT_ISL_NO_VERSIONS is not set\n CT_ISL_VERSION=\"0.20\"\n-CT_ISL_MIRRORS=\"http://isl.gforge.inria.fr\"\n+CT_ISL_MIRRORS=\"https://ci-mirrors.rust-lang.org/rustc\"\n CT_ISL_ARCHIVE_FILENAME=\"@{pkg_name}-@{version}\"\n CT_ISL_ARCHIVE_DIRNAME=\"@{pkg_name}-@{version}\"\n CT_ISL_ARCHIVE_FORMATS=\".tar.xz .tar.bz2 .tar.gz\""}, {"sha": "ad53ba4dd1bc0b208aec94c781c130de553e1586", "filename": "src/ci/docker/host-x86_64/dist-arm-linux/build-toolchains.sh", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d480ceff384f80394e9367b5e9d3596d62f20585/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-arm-linux%2Fbuild-toolchains.sh", "raw_url": "https://github.com/rust-lang/rust/raw/d480ceff384f80394e9367b5e9d3596d62f20585/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-arm-linux%2Fbuild-toolchains.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-arm-linux%2Fbuild-toolchains.sh?ref=d480ceff384f80394e9367b5e9d3596d62f20585", "patch": "@@ -22,7 +22,8 @@ exit 1\n mkdir build\n cd build\n cp ../arm-linux-gnueabi.config .config\n-ct-ng oldconfig\n+# FIXME ct-ng oldconfig is not working as intended.\n+# ct-ng oldconfig\n hide_output ct-ng build\n cd ..\n rm -rf build"}, {"sha": "e0f6417793de8fa01caaa1855e5cf0ca2df53108", "filename": "src/ci/docker/host-x86_64/dist-armhf-linux/arm-linux-gnueabihf.config", "status": "modified", "additions": 3, "deletions": 16, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/d480ceff384f80394e9367b5e9d3596d62f20585/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-armhf-linux%2Farm-linux-gnueabihf.config", "raw_url": "https://github.com/rust-lang/rust/raw/d480ceff384f80394e9367b5e9d3596d62f20585/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-armhf-linux%2Farm-linux-gnueabihf.config", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-armhf-linux%2Farm-linux-gnueabihf.config?ref=d480ceff384f80394e9367b5e9d3596d62f20585", "patch": "@@ -14,6 +14,7 @@ CT_CONFIGURE_has_autoconf_2_65_or_newer=y\n CT_CONFIGURE_has_autoreconf_2_65_or_newer=y\n CT_CONFIGURE_has_automake_1_15_or_newer=y\n CT_CONFIGURE_has_gnu_m4_1_4_12_or_newer=y\n+CT_CONFIGURE_has_python_3_4_or_newer=y\n CT_CONFIGURE_has_bison_2_7_or_newer=y\n CT_CONFIGURE_has_python=y\n CT_CONFIGURE_has_git=y\n@@ -132,12 +133,6 @@ CT_ARCH_ARM=y\n # CT_ARCH_XTENSA is not set\n CT_ARCH=\"arm\"\n CT_ARCH_CHOICE_KSYM=\"ARM\"\n-# CT_ARCH_ALPHA_EV4 is not set\n-# CT_ARCH_ALPHA_EV45 is not set\n-# CT_ARCH_ALPHA_EV5 is not set\n-# CT_ARCH_ALPHA_EV56 is not set\n-# CT_ARCH_ALPHA_EV6 is not set\n-# CT_ARCH_ALPHA_EV67 is not set\n CT_ARCH_CPU=\"\"\n CT_ARCH_TUNE=\"\"\n CT_ARCH_ARM_SHOW=y\n@@ -372,8 +367,6 @@ CT_ALL_BINUTILS_CHOICES=\"BINUTILS\"\n # C-library\n #\n CT_LIBC_GLIBC=y\n-# CT_LIBC_NEWLIB is not set\n-# CT_LIBC_NONE is not set\n # CT_LIBC_UCLIBC is not set\n CT_LIBC=\"glibc\"\n CT_LIBC_CHOICE_KSYM=\"GLIBC\"\n@@ -390,6 +383,7 @@ CT_GLIBC_USE=\"GLIBC\"\n CT_GLIBC_PKG_NAME=\"glibc\"\n CT_GLIBC_SRC_RELEASE=y\n CT_GLIBC_PATCH_ORDER=\"global\"\n+# CT_GLIBC_V_2_29 is not set\n # CT_GLIBC_V_2_28 is not set\n # CT_GLIBC_V_2_27 is not set\n # CT_GLIBC_V_2_26 is not set\n@@ -408,7 +402,6 @@ CT_GLIBC_ARCHIVE_FORMATS=\".tar.xz .tar.bz2 .tar.gz\"\n CT_GLIBC_SIGNATURE_FORMAT=\"packed/.sig\"\n CT_GLIBC_2_29_or_older=y\n CT_GLIBC_older_than_2_29=y\n-CT_GLIBC_REQUIRE_older_than_2_29=y\n CT_GLIBC_2_27_or_older=y\n CT_GLIBC_older_than_2_27=y\n CT_GLIBC_2_26_or_older=y\n@@ -448,12 +441,6 @@ CT_GLIBC_FORCE_UNWIND=y\n CT_GLIBC_KERNEL_VERSION_AS_HEADERS=y\n # CT_GLIBC_KERNEL_VERSION_CHOSEN is not set\n CT_GLIBC_MIN_KERNEL=\"3.2.101\"\n-# CT_GLIBC_SSP_DEFAULT is not set\n-# CT_GLIBC_SSP_NO is not set\n-# CT_GLIBC_SSP_YES is not set\n-# CT_GLIBC_SSP_ALL is not set\n-# CT_GLIBC_SSP_STRONG is not set\n-# CT_NEWLIB_USE_REDHAT is not set\n CT_ALL_LIBC_CHOICES=\"AVR_LIBC BIONIC GLIBC MINGW_W64 MOXIEBOX MUSL NEWLIB NONE UCLIBC\"\n CT_LIBC_SUPPORT_THREADS_ANY=y\n CT_LIBC_SUPPORT_THREADS_NATIVE=y\n@@ -625,7 +612,7 @@ CT_ISL_V_0_20=y\n # CT_ISL_V_0_15 is not set\n # CT_ISL_NO_VERSIONS is not set\n CT_ISL_VERSION=\"0.20\"\n-CT_ISL_MIRRORS=\"http://isl.gforge.inria.fr\"\n+CT_ISL_MIRRORS=\"https://ci-mirrors.rust-lang.org/rustc\"\n CT_ISL_ARCHIVE_FILENAME=\"@{pkg_name}-@{version}\"\n CT_ISL_ARCHIVE_DIRNAME=\"@{pkg_name}-@{version}\"\n CT_ISL_ARCHIVE_FORMATS=\".tar.xz .tar.bz2 .tar.gz\""}, {"sha": "6b5374422a62a8b9519880e10c3077419634cea8", "filename": "src/ci/docker/host-x86_64/dist-armhf-linux/build-toolchains.sh", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d480ceff384f80394e9367b5e9d3596d62f20585/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-armhf-linux%2Fbuild-toolchains.sh", "raw_url": "https://github.com/rust-lang/rust/raw/d480ceff384f80394e9367b5e9d3596d62f20585/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-armhf-linux%2Fbuild-toolchains.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-armhf-linux%2Fbuild-toolchains.sh?ref=d480ceff384f80394e9367b5e9d3596d62f20585", "patch": "@@ -22,7 +22,8 @@ exit 1\n mkdir build\n cd build\n cp ../arm-linux-gnueabihf.config .config\n-ct-ng oldconfig\n+# FIXME ct-ng oldconfig is not working as intended.\n+# ct-ng oldconfig\n hide_output ct-ng build\n cd ..\n rm -rf build"}, {"sha": "2d8167f1f33289e639153877c09fbf6dd85ebc31", "filename": "src/ci/docker/host-x86_64/dist-armv7-linux/armv7-linux-gnueabihf.config", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d480ceff384f80394e9367b5e9d3596d62f20585/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-armv7-linux%2Farmv7-linux-gnueabihf.config", "raw_url": "https://github.com/rust-lang/rust/raw/d480ceff384f80394e9367b5e9d3596d62f20585/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-armv7-linux%2Farmv7-linux-gnueabihf.config", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-armv7-linux%2Farmv7-linux-gnueabihf.config?ref=d480ceff384f80394e9367b5e9d3596d62f20585", "patch": "@@ -17,8 +17,6 @@ CT_CONFIGURE_has_gnu_m4_1_4_12_or_newer=y\n CT_CONFIGURE_has_python_3_4_or_newer=y\n CT_CONFIGURE_has_bison_2_7_or_newer=y\n CT_CONFIGURE_has_python=y\n-CT_CONFIGURE_has_dtc=y\n-CT_CONFIGURE_has_svn=y\n CT_CONFIGURE_has_git=y\n CT_CONFIGURE_has_md5sum=y\n CT_CONFIGURE_has_sha1sum=y\n@@ -612,7 +610,7 @@ CT_ISL_V_0_20=y\n # CT_ISL_V_0_15 is not set\n # CT_ISL_NO_VERSIONS is not set\n CT_ISL_VERSION=\"0.20\"\n-CT_ISL_MIRRORS=\"http://isl.gforge.inria.fr\"\n+CT_ISL_MIRRORS=\"https://ci-mirrors.rust-lang.org/rustc\"\n CT_ISL_ARCHIVE_FILENAME=\"@{pkg_name}-@{version}\"\n CT_ISL_ARCHIVE_DIRNAME=\"@{pkg_name}-@{version}\"\n CT_ISL_ARCHIVE_FORMATS=\".tar.xz .tar.bz2 .tar.gz\""}, {"sha": "602ad8ac877370d8425d35c54e08fc5116214f57", "filename": "src/ci/docker/host-x86_64/dist-armv7-linux/build-toolchains.sh", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d480ceff384f80394e9367b5e9d3596d62f20585/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-armv7-linux%2Fbuild-toolchains.sh", "raw_url": "https://github.com/rust-lang/rust/raw/d480ceff384f80394e9367b5e9d3596d62f20585/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-armv7-linux%2Fbuild-toolchains.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-armv7-linux%2Fbuild-toolchains.sh?ref=d480ceff384f80394e9367b5e9d3596d62f20585", "patch": "@@ -22,7 +22,8 @@ exit 1\n mkdir build\n cd build\n cp ../armv7-linux-gnueabihf.config .config\n-ct-ng oldconfig\n+# FIXME ct-ng oldconfig is not working as intended.\n+# ct-ng oldconfig\n hide_output ct-ng build\n cd ..\n rm -rf build"}, {"sha": "7400a8a038d0c42a34368cba06dbe99ec2c39fd3", "filename": "src/ci/docker/host-x86_64/dist-riscv64-linux/riscv64-unknown-linux-gnu.config", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d480ceff384f80394e9367b5e9d3596d62f20585/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-riscv64-linux%2Friscv64-unknown-linux-gnu.config", "raw_url": "https://github.com/rust-lang/rust/raw/d480ceff384f80394e9367b5e9d3596d62f20585/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-riscv64-linux%2Friscv64-unknown-linux-gnu.config", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-riscv64-linux%2Friscv64-unknown-linux-gnu.config?ref=d480ceff384f80394e9367b5e9d3596d62f20585", "patch": "@@ -722,7 +722,7 @@ CT_ISL_V_0_20=y\n # CT_ISL_V_0_15 is not set\n # CT_ISL_NO_VERSIONS is not set\n CT_ISL_VERSION=\"0.20\"\n-CT_ISL_MIRRORS=\"http://isl.gforge.inria.fr\"\n+CT_ISL_MIRRORS=\"https://ci-mirrors.rust-lang.org/rustc\"\n CT_ISL_ARCHIVE_FILENAME=\"@{pkg_name}-@{version}\"\n CT_ISL_ARCHIVE_DIRNAME=\"@{pkg_name}-@{version}\"\n CT_ISL_ARCHIVE_FORMATS=\".tar.xz .tar.bz2 .tar.gz\""}]}