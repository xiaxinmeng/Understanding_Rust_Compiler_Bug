{"sha": "f85ff8d0e5e0149807c3f83b3554bf70ddf70831", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY4NWZmOGQwZTVlMDE0OTgwN2MzZjgzYjM1NTRiZjcwZGRmNzA4MzE=", "commit": {"author": {"name": "Jan Likar", "email": "likar.jan@gmail.com", "date": "2015-11-17T23:51:15Z"}, "committer": {"name": "Jan Likar", "email": "likar.jan@gmail.com", "date": "2015-11-17T23:56:46Z"}, "message": "Print version of the crate\n\nPrint version acquired from Cargo when building. If built using rustc\ndirectly, print X.X.X", "tree": {"sha": "6a1e97ae2998d7408d817fd0b0111010a3a8d3e5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6a1e97ae2998d7408d817fd0b0111010a3a8d3e5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f85ff8d0e5e0149807c3f83b3554bf70ddf70831", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f85ff8d0e5e0149807c3f83b3554bf70ddf70831", "html_url": "https://github.com/rust-lang/rust/commit/f85ff8d0e5e0149807c3f83b3554bf70ddf70831", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f85ff8d0e5e0149807c3f83b3554bf70ddf70831/comments", "author": {"login": "JanLikar", "id": 4228250, "node_id": "MDQ6VXNlcjQyMjgyNTA=", "avatar_url": "https://avatars.githubusercontent.com/u/4228250?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JanLikar", "html_url": "https://github.com/JanLikar", "followers_url": "https://api.github.com/users/JanLikar/followers", "following_url": "https://api.github.com/users/JanLikar/following{/other_user}", "gists_url": "https://api.github.com/users/JanLikar/gists{/gist_id}", "starred_url": "https://api.github.com/users/JanLikar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JanLikar/subscriptions", "organizations_url": "https://api.github.com/users/JanLikar/orgs", "repos_url": "https://api.github.com/users/JanLikar/repos", "events_url": "https://api.github.com/users/JanLikar/events{/privacy}", "received_events_url": "https://api.github.com/users/JanLikar/received_events", "type": "User", "site_admin": false}, "committer": {"login": "JanLikar", "id": 4228250, "node_id": "MDQ6VXNlcjQyMjgyNTA=", "avatar_url": "https://avatars.githubusercontent.com/u/4228250?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JanLikar", "html_url": "https://github.com/JanLikar", "followers_url": "https://api.github.com/users/JanLikar/followers", "following_url": "https://api.github.com/users/JanLikar/following{/other_user}", "gists_url": "https://api.github.com/users/JanLikar/gists{/gist_id}", "starred_url": "https://api.github.com/users/JanLikar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JanLikar/subscriptions", "organizations_url": "https://api.github.com/users/JanLikar/orgs", "repos_url": "https://api.github.com/users/JanLikar/repos", "events_url": "https://api.github.com/users/JanLikar/events{/privacy}", "received_events_url": "https://api.github.com/users/JanLikar/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1eb38c461e61045983e9a8160a7af965039b163b", "url": "https://api.github.com/repos/rust-lang/rust/commits/1eb38c461e61045983e9a8160a7af965039b163b", "html_url": "https://github.com/rust-lang/rust/commit/1eb38c461e61045983e9a8160a7af965039b163b"}], "stats": {"total": 15, "additions": 5, "deletions": 10}, "files": [{"sha": "126f893130f5f678f9af61ca38bf0a3a372fc304", "filename": "src/bin/rustfmt.rs", "status": "modified", "additions": 5, "deletions": 10, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/f85ff8d0e5e0149807c3f83b3554bf70ddf70831/src%2Fbin%2Frustfmt.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f85ff8d0e5e0149807c3f83b3554bf70ddf70831/src%2Fbin%2Frustfmt.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbin%2Frustfmt.rs?ref=f85ff8d0e5e0149807c3f83b3554bf70ddf70831", "patch": "@@ -23,7 +23,6 @@ use rustfmt::config::Config;\n use std::env;\n use std::fs::{self, File};\n use std::io::{self, Read, Write};\n-use std::process::Command;\n use std::path::{Path, PathBuf};\n \n use getopts::{Matches, Options};\n@@ -177,15 +176,11 @@ fn print_usage(opts: &Options, reason: &str) {\n }\n \n fn print_version() {\n-    let cmd = Command::new(\"git\")\n-                  .arg(\"rev-parse\")\n-                  .arg(\"--short\")\n-                  .arg(\"HEAD\")\n-                  .output();\n-    match cmd {\n-        Ok(output) => print!(\"{}\", String::from_utf8(output.stdout).unwrap()),\n-        Err(e) => panic!(\"Unable te get version: {}\", e),\n-    }\n+    println!(\"{}.{}.{}{}\",\n+             option_env!(\"CARGO_PKG_VERSION_MAJOR\").unwrap_or(\"X\"),\n+             option_env!(\"CARGO_PKG_VERSION_MINOR\").unwrap_or(\"X\"),\n+             option_env!(\"CARGO_PKG_VERSION_PATCH\").unwrap_or(\"X\"),\n+             option_env!(\"CARGO_PKG_VERSION_PRE\").unwrap_or(\"\"));\n }\n \n fn determine_operation(matches: &Matches) -> Operation {"}]}