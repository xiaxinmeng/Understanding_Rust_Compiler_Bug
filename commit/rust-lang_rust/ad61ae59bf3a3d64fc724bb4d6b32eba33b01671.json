{"sha": "ad61ae59bf3a3d64fc724bb4d6b32eba33b01671", "node_id": "C_kwDOAAsO6NoAKGFkNjFhZTU5YmYzYTNkNjRmYzcyNGJiNGQ2YjMyZWJhMzNiMDE2NzE", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2022-06-15T22:24:42Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-06-15T22:24:42Z"}, "message": "Rollup merge of #98092 - GuillaumeGomez:fix-sidebar-items-expand-collapse, r=notriddle\n\nFix sidebar items expand collapse\n\nThe collapse/expand event was not working for the items in the source code viewer sidebar (talking about these items:\n\n![Screenshot from 2022-06-14 11-21-58](https://user-images.githubusercontent.com/3050060/173543346-af056928-e921-458f-b918-60f6fd0ecbde.png)\n\n).\n\nThis PR fixes it and adds a GUI test to prevent another regression.\n\nr? ```@notriddle```", "tree": {"sha": "96d73e38fb8a183bc6048a0bf1fafdcccfca9888", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/96d73e38fb8a183bc6048a0bf1fafdcccfca9888"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ad61ae59bf3a3d64fc724bb4d6b32eba33b01671", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJiqlwrCRBK7hj4Ov3rIwAAq7AIAAlLO5lMGQfajXeEIV87At7y\nMKDVy/WQRwcTIvipy9HSvrKrlxhMg6H9uPl1TpTBnkitg/rTDVYewrVbpvhmhKbs\njdhJL3srZ3S74S956dJ4Sb5fS4rwbLMePDPcE2w/dO+wBwSV0TEneqEXV3+xhSRL\njmO2H9tfpx98A30rKVJmQO6XdScF7DcIBnVZDn73w16qxsd5YilWgwGNwLyoR34c\nfI9N9iH8O46x3zuiGWr63zxsuzmOuPekN9mV4LVPns1l6/bS4o8Feoq8QT3IwBWd\nY5ZGTTnIbu9RHxNFRxSF7+KhGAo3WrFqm5XCX0wF++O5bEGZDjkzThX+dLMSjvI=\n=i6gh\n-----END PGP SIGNATURE-----\n", "payload": "tree 96d73e38fb8a183bc6048a0bf1fafdcccfca9888\nparent b91c4d5b45484ad3c121e2f738a31195f49374aa\nparent a70c14aecca90e29417ab3c9b9dcbf0631efae79\nauthor Yuki Okushi <jtitor@2k36.org> 1655331882 +0900\ncommitter GitHub <noreply@github.com> 1655331882 +0900\n\nRollup merge of #98092 - GuillaumeGomez:fix-sidebar-items-expand-collapse, r=notriddle\n\nFix sidebar items expand collapse\n\nThe collapse/expand event was not working for the items in the source code viewer sidebar (talking about these items:\n\n![Screenshot from 2022-06-14 11-21-58](https://user-images.githubusercontent.com/3050060/173543346-af056928-e921-458f-b918-60f6fd0ecbde.png)\n\n).\n\nThis PR fixes it and adds a GUI test to prevent another regression.\n\nr? ```@notriddle```\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ad61ae59bf3a3d64fc724bb4d6b32eba33b01671", "html_url": "https://github.com/rust-lang/rust/commit/ad61ae59bf3a3d64fc724bb4d6b32eba33b01671", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ad61ae59bf3a3d64fc724bb4d6b32eba33b01671/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b91c4d5b45484ad3c121e2f738a31195f49374aa", "url": "https://api.github.com/repos/rust-lang/rust/commits/b91c4d5b45484ad3c121e2f738a31195f49374aa", "html_url": "https://github.com/rust-lang/rust/commit/b91c4d5b45484ad3c121e2f738a31195f49374aa"}, {"sha": "a70c14aecca90e29417ab3c9b9dcbf0631efae79", "url": "https://api.github.com/repos/rust-lang/rust/commits/a70c14aecca90e29417ab3c9b9dcbf0631efae79", "html_url": "https://github.com/rust-lang/rust/commit/a70c14aecca90e29417ab3c9b9dcbf0631efae79"}], "stats": {"total": 31, "additions": 27, "deletions": 4}, "files": [{"sha": "14d8a942977d60d9af9665c628a81185666a7b26", "filename": "src/librustdoc/html/static/js/source-script.js", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/ad61ae59bf3a3d64fc724bb4d6b32eba33b01671/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsource-script.js", "raw_url": "https://github.com/rust-lang/rust/raw/ad61ae59bf3a3d64fc724bb4d6b32eba33b01671/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsource-script.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsource-script.js?ref=ad61ae59bf3a3d64fc724bb4d6b32eba33b01671", "patch": "@@ -32,10 +32,10 @@ function createDirEntry(elem, parent, fullPath, currentFile, hasFoundFile) {\n     fullPath += elem[\"name\"] + \"/\";\n \n     name.onclick = () => {\n-        if (hasClass(this, \"expand\")) {\n-            removeClass(this, \"expand\");\n+        if (hasClass(name, \"expand\")) {\n+            removeClass(name, \"expand\");\n         } else {\n-            addClass(this, \"expand\");\n+            addClass(name, \"expand\");\n         }\n     };\n     name.innerText = elem[\"name\"];"}, {"sha": "188b2605f0f135b29de20472db35d4121201e8cf", "filename": "src/test/rustdoc-gui/source-code-page.goml", "status": "modified", "additions": 24, "deletions": 1, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/ad61ae59bf3a3d64fc724bb4d6b32eba33b01671/src%2Ftest%2Frustdoc-gui%2Fsource-code-page.goml", "raw_url": "https://github.com/rust-lang/rust/raw/ad61ae59bf3a3d64fc724bb4d6b32eba33b01671/src%2Ftest%2Frustdoc-gui%2Fsource-code-page.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsource-code-page.goml?ref=ad61ae59bf3a3d64fc724bb4d6b32eba33b01671", "patch": "@@ -1,4 +1,4 @@\n-// Checks that the interactions with the source code pages are workined as expected.\n+// Checks that the interactions with the source code pages are working as expected.\n goto: file://|DOC_PATH|/src/test_docs/lib.rs.html\n // Check that we can click on the line number.\n click: \".line-numbers > span:nth-child(4)\" // This is the span for line 4.\n@@ -27,3 +27,26 @@ assert-position: (\"//*[@id='1']\", {\"x\": 104, \"y\": 103})\n // We click on the left of the \"1\" span but still in the \"line-number\" `<pre>`.\n click: (103, 103)\n assert-document-property: ({\"URL\": \"/lib.rs.html\"}, ENDS_WITH)\n+\n+// Checking the source code sidebar.\n+\n+// First we \"open\" it.\n+click: \"#sidebar-toggle\"\n+assert: \".sidebar.expanded\"\n+\n+// We check that the first entry of the sidebar is collapsed (which, for whatever reason,\n+// is number 2 and not 1...).\n+assert-attribute: (\"#source-sidebar .name:nth-child(2)\", {\"class\": \"name\"})\n+assert-text: (\"#source-sidebar .name:nth-child(2)\", \"implementors\")\n+// We also check its children are hidden too.\n+assert-css: (\"#source-sidebar .name:nth-child(2) + .children\", {\"display\": \"none\"})\n+// We now click on it.\n+click: \"#source-sidebar .name:nth-child(2)\"\n+assert-attribute: (\"#source-sidebar .name:nth-child(2)\", {\"class\": \"name expand\"})\n+// Checking that its children are displayed as well.\n+assert-css: (\"#source-sidebar .name:nth-child(2) + .children\", {\"display\": \"block\"})\n+\n+// And now we collapse it again.\n+click: \"#source-sidebar .name:nth-child(2)\"\n+assert-attribute: (\"#source-sidebar .name:nth-child(2)\", {\"class\": \"name\"})\n+assert-css: (\"#source-sidebar .name:nth-child(2) + .children\", {\"display\": \"none\"})"}]}