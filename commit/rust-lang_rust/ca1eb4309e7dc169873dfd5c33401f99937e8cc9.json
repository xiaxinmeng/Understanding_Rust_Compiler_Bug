{"sha": "ca1eb4309e7dc169873dfd5c33401f99937e8cc9", "node_id": "C_kwDOAAsO6NoAKGNhMWViNDMwOWU3ZGMxNjk4NzNkZmQ1YzMzNDAxZjk5OTM3ZThjYzk", "commit": {"author": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2022-12-26T10:48:54Z"}, "committer": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2023-01-12T02:28:38Z"}, "message": "test use in libcore", "tree": {"sha": "7f479d620723850da81e086e325e42ba472b4494", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7f479d620723850da81e086e325e42ba472b4494"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ca1eb4309e7dc169873dfd5c33401f99937e8cc9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ca1eb4309e7dc169873dfd5c33401f99937e8cc9", "html_url": "https://github.com/rust-lang/rust/commit/ca1eb4309e7dc169873dfd5c33401f99937e8cc9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ca1eb4309e7dc169873dfd5c33401f99937e8cc9/comments", "author": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b0aa859c2440864bdc6d25d7d40071d91745d342", "url": "https://api.github.com/repos/rust-lang/rust/commits/b0aa859c2440864bdc6d25d7d40071d91745d342", "html_url": "https://github.com/rust-lang/rust/commit/b0aa859c2440864bdc6d25d7d40071d91745d342"}], "stats": {"total": 28, "additions": 18, "deletions": 10}, "files": [{"sha": "a7d6fec7d3dc1354121ea6058cb766bedc7affbe", "filename": "library/core/src/cmp.rs", "status": "modified", "additions": 16, "deletions": 10, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/ca1eb4309e7dc169873dfd5c33401f99937e8cc9/library%2Fcore%2Fsrc%2Fcmp.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca1eb4309e7dc169873dfd5c33401f99937e8cc9/library%2Fcore%2Fsrc%2Fcmp.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fcmp.rs?ref=ca1eb4309e7dc169873dfd5c33401f99937e8cc9", "patch": "@@ -1234,17 +1234,23 @@ where\n     F: ~const Destruct,\n     K: ~const Destruct,\n {\n-    const fn imp<T, F: ~const FnMut(&T) -> K, K: ~const Ord>(\n-        f: &mut F,\n-        (v1, v2): (&T, &T),\n-    ) -> Ordering\n-    where\n-        T: ~const Destruct,\n-        K: ~const Destruct,\n-    {\n-        f(v1).cmp(&f(v2))\n+    cfg_if! {\n+        if #[cfg(bootstrap)] {\n+            const fn imp<T, F: ~const FnMut(&T) -> K, K: ~const Ord>(\n+                f: &mut F,\n+                (v1, v2): (&T, &T),\n+            ) -> Ordering\n+            where\n+                T: ~const Destruct,\n+                K: ~const Destruct,\n+            {\n+                f(v1).cmp(&f(v2))\n+            }\n+            min_by(v1, v2, ConstFnMutClosure::new(&mut f, imp))\n+        } else {\n+            min_by(v1, v2, const |v1, v2| f(v1).cmp(&f(v2)))\n+        }\n     }\n-    min_by(v1, v2, ConstFnMutClosure::new(&mut f, imp))\n }\n \n /// Compares and returns the maximum of two values."}, {"sha": "20b325546e2ff2ebb25e8f2ddffa239e743f5948", "filename": "library/core/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/ca1eb4309e7dc169873dfd5c33401f99937e8cc9/library%2Fcore%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca1eb4309e7dc169873dfd5c33401f99937e8cc9/library%2Fcore%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Flib.rs?ref=ca1eb4309e7dc169873dfd5c33401f99937e8cc9", "patch": "@@ -191,6 +191,7 @@\n #![feature(cfg_sanitize)]\n #![feature(cfg_target_has_atomic)]\n #![feature(cfg_target_has_atomic_equal_alignment)]\n+#![cfg_attr(not(bootstrap), feature(const_closures))]\n #![feature(const_fn_floating_point_arithmetic)]\n #![feature(const_mut_refs)]\n #![feature(const_precise_live_drops)]"}, {"sha": "7a91dcf0dad35b9808f64c5b61f5859fc78fb9a0", "filename": "tests/ui-fulldeps/pprust-expr-roundtrip.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/ca1eb4309e7dc169873dfd5c33401f99937e8cc9/tests%2Fui-fulldeps%2Fpprust-expr-roundtrip.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca1eb4309e7dc169873dfd5c33401f99937e8cc9/tests%2Fui-fulldeps%2Fpprust-expr-roundtrip.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui-fulldeps%2Fpprust-expr-roundtrip.rs?ref=ca1eb4309e7dc169873dfd5c33401f99937e8cc9", "patch": "@@ -126,6 +126,7 @@ fn iter_exprs(depth: usize, f: &mut dyn FnMut(P<Expr>)) {\n                     g(ExprKind::Closure(Box::new(Closure {\n                         binder: ClosureBinder::NotPresent,\n                         capture_clause: CaptureBy::Value,\n+                        constness: Const::No,\n                         asyncness: Async::No,\n                         movability: Movability::Movable,\n                         fn_decl: decl.clone(),"}]}