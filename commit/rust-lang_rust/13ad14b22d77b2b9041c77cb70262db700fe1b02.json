{"sha": "13ad14b22d77b2b9041c77cb70262db700fe1b02", "node_id": "C_kwDOAAsO6NoAKDEzYWQxNGIyMmQ3N2IyYjkwNDFjNzdjYjcwMjYyZGI3MDBmZTFiMDI", "commit": {"author": {"name": "hotate29", "email": "hotate_oc@yahoo.co.jp", "date": "2021-12-10T17:32:23Z"}, "committer": {"name": "hotate29", "email": "hotate_oc@yahoo.co.jp", "date": "2021-12-17T15:07:36Z"}, "message": "update: ```Sugg::not()``` replacing the comparison operator. #7320\n\nWhen inverting an expression, the output is now like ```foo != 0``` instead of ```!(foo == 0)```, the comparison operator is now replaced.", "tree": {"sha": "5056fbaf414b5303e57d10ca5b5bd44a738d8505", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5056fbaf414b5303e57d10ca5b5bd44a738d8505"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/13ad14b22d77b2b9041c77cb70262db700fe1b02", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEaFZ9ibIIMdUY9nqJ23IOcqY4C1oFAmG8p8AACgkQ23IOcqY4\nC1pNKhAAq32zHfOtptd4sMje4nqASfoHhBLzFr0hjD+TdkREcKqij+XFF2Cq501m\nfrB1F/m40ob64y8OPdM3XelXDPVfIbVkUV593//pQs9ez2tQE1ESQyP6vIodN4Bm\nmP4SHV+bD4psMAMXojchLMHQ2rub2dKEPMMXaoV9VsgkKnuEW4TIMtBXaoCuwahL\njpa/ki2ghT68MJZ1ABzdIxASf+M37AJ5k4TbXQ5leufYwVqFMOnBAVK3/QcyoloH\nxmRgNXLi+qQRZMqKutZfqm4OPwaiRiM6LxU9cau9xMNg5Nl8NYxWcz3hCwSvoc82\nidApY+ox0UOjixFWUWeov8LMXuBpQlW/CjPR/U4BkvvpaB5ROgHOKkUoFIvLcMTE\nglqi9WE+3NyEEg5F61BhQF9R9JegNQJGHxxvRlDeDuPCAgIOvMMpQAN+JV8IxPXt\nmT/52LyOXDUz38BsH2NsGskgBYh5yNN5+Zvvr2xuG8guohPJSUjqh8TvsM/sJPej\n3GMrCRks3ObZJpE6yWM8NcNifxqG9ykHbheMsBH3XsHIccMDLg05VAeIS0e0evyA\n7g0E9y6kwe3kQMdM5aucvDr3HnrZ8TReiMhSQ/0R3RXiEm2Yms3WDcpY0PG/PiMa\n/QrapDFjML01zPqTOD/F+qrzuYy1zhowS75ZlVSAvbW4AS+lMLI=\n=qW5i\n-----END PGP SIGNATURE-----", "payload": "tree 5056fbaf414b5303e57d10ca5b5bd44a738d8505\nparent 53059792e9a7b7adeff387ceb995a50a6c33b3fa\nauthor hotate29 <hotate_oc@yahoo.co.jp> 1639157543 +0900\ncommitter hotate29 <hotate_oc@yahoo.co.jp> 1639753656 +0900\n\nupdate: ```Sugg::not()``` replacing the comparison operator. #7320\n\nWhen inverting an expression, the output is now like ```foo != 0``` instead of ```!(foo == 0)```, the comparison operator is now replaced.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/13ad14b22d77b2b9041c77cb70262db700fe1b02", "html_url": "https://github.com/rust-lang/rust/commit/13ad14b22d77b2b9041c77cb70262db700fe1b02", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/13ad14b22d77b2b9041c77cb70262db700fe1b02/comments", "author": {"login": "hotate29", "id": 44938840, "node_id": "MDQ6VXNlcjQ0OTM4ODQw", "avatar_url": "https://avatars.githubusercontent.com/u/44938840?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hotate29", "html_url": "https://github.com/hotate29", "followers_url": "https://api.github.com/users/hotate29/followers", "following_url": "https://api.github.com/users/hotate29/following{/other_user}", "gists_url": "https://api.github.com/users/hotate29/gists{/gist_id}", "starred_url": "https://api.github.com/users/hotate29/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hotate29/subscriptions", "organizations_url": "https://api.github.com/users/hotate29/orgs", "repos_url": "https://api.github.com/users/hotate29/repos", "events_url": "https://api.github.com/users/hotate29/events{/privacy}", "received_events_url": "https://api.github.com/users/hotate29/received_events", "type": "User", "site_admin": false}, "committer": {"login": "hotate29", "id": 44938840, "node_id": "MDQ6VXNlcjQ0OTM4ODQw", "avatar_url": "https://avatars.githubusercontent.com/u/44938840?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hotate29", "html_url": "https://github.com/hotate29", "followers_url": "https://api.github.com/users/hotate29/followers", "following_url": "https://api.github.com/users/hotate29/following{/other_user}", "gists_url": "https://api.github.com/users/hotate29/gists{/gist_id}", "starred_url": "https://api.github.com/users/hotate29/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hotate29/subscriptions", "organizations_url": "https://api.github.com/users/hotate29/orgs", "repos_url": "https://api.github.com/users/hotate29/repos", "events_url": "https://api.github.com/users/hotate29/events{/privacy}", "received_events_url": "https://api.github.com/users/hotate29/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "53059792e9a7b7adeff387ceb995a50a6c33b3fa", "url": "https://api.github.com/repos/rust-lang/rust/commits/53059792e9a7b7adeff387ceb995a50a6c33b3fa", "html_url": "https://github.com/rust-lang/rust/commit/53059792e9a7b7adeff387ceb995a50a6c33b3fa"}], "stats": {"total": 33, "additions": 30, "deletions": 3}, "files": [{"sha": "cf46a75791c9f88f9b37559be6783be455a40a97", "filename": "clippy_utils/src/sugg.rs", "status": "modified", "additions": 28, "deletions": 1, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/13ad14b22d77b2b9041c77cb70262db700fe1b02/clippy_utils%2Fsrc%2Fsugg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/13ad14b22d77b2b9041c77cb70262db700fe1b02/clippy_utils%2Fsrc%2Fsugg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_utils%2Fsrc%2Fsugg.rs?ref=13ad14b22d77b2b9041c77cb70262db700fe1b02", "patch": "@@ -394,7 +394,34 @@ impl Neg for Sugg<'_> {\n impl Not for Sugg<'_> {\n     type Output = Sugg<'static>;\n     fn not(self) -> Sugg<'static> {\n-        make_unop(\"!\", self)\n+        use AssocOp::{Equal, Greater, GreaterEqual, Less, LessEqual, NotEqual};\n+\n+        /// Convert ```AssocOp``` to a string of operators.\n+        fn op_as_str(op: AssocOp) -> &'static str {\n+            op.to_ast_binop().unwrap().to_string()\n+        }\n+\n+        /// Replace the operator in the Snippet.\n+        fn replace_op(from_op: AssocOp, to_op: AssocOp, snip: Cow<'_, str>) -> Sugg<'static> {\n+            let from = op_as_str(from_op);\n+            let to = op_as_str(to_op);\n+            let snip = snip.into_owned().replace(from, to);\n+            Sugg::BinOp(to_op, Cow::Owned(snip))\n+        }\n+\n+        if let Sugg::BinOp(op, snip) = self {\n+            match op {\n+                Equal => replace_op(op, NotEqual, snip),\n+                NotEqual => replace_op(op, Equal, snip),\n+                Less => replace_op(op, GreaterEqual, snip),\n+                GreaterEqual => replace_op(op, Less, snip),\n+                Greater => replace_op(op, LessEqual, snip),\n+                LessEqual => replace_op(op, Greater, snip),\n+                _ => make_unop(\"!\", Sugg::BinOp(op, snip)),\n+            }\n+        } else {\n+            make_unop(\"!\", self)\n+        }\n     }\n }\n "}, {"sha": "dd22ecab0b551593f959cb7ce425318866ea09ee", "filename": "tests/ui/short_circuit_statement.fixed", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/13ad14b22d77b2b9041c77cb70262db700fe1b02/tests%2Fui%2Fshort_circuit_statement.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/13ad14b22d77b2b9041c77cb70262db700fe1b02/tests%2Fui%2Fshort_circuit_statement.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fshort_circuit_statement.fixed?ref=13ad14b22d77b2b9041c77cb70262db700fe1b02", "patch": "@@ -6,7 +6,7 @@\n fn main() {\n     if f() { g(); }\n     if !f() { g(); }\n-    if !(1 == 2) { g(); }\n+    if 1 != 2 { g(); }\n }\n \n fn f() -> bool {"}, {"sha": "aa84ac3a7925f3e6d0f741dd1d244b3c5b46209e", "filename": "tests/ui/short_circuit_statement.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/13ad14b22d77b2b9041c77cb70262db700fe1b02/tests%2Fui%2Fshort_circuit_statement.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/13ad14b22d77b2b9041c77cb70262db700fe1b02/tests%2Fui%2Fshort_circuit_statement.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fshort_circuit_statement.stderr?ref=13ad14b22d77b2b9041c77cb70262db700fe1b02", "patch": "@@ -16,7 +16,7 @@ error: boolean short circuit operator in statement may be clearer using an expli\n   --> $DIR/short_circuit_statement.rs:9:5\n    |\n LL |     1 == 2 || g();\n-   |     ^^^^^^^^^^^^^^ help: replace it with: `if !(1 == 2) { g(); }`\n+   |     ^^^^^^^^^^^^^^ help: replace it with: `if 1 != 2 { g(); }`\n \n error: aborting due to 3 previous errors\n "}]}