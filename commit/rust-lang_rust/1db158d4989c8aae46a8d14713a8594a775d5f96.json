{"sha": "1db158d4989c8aae46a8d14713a8594a775d5f96", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFkYjE1OGQ0OTg5YzhhYWU0NmE4ZDE0NzEzYTg1OTRhNzc1ZDVmOTY=", "commit": {"author": {"name": "Mark Simulacrum", "email": "mark.simulacrum@gmail.com", "date": "2017-08-21T12:22:01Z"}, "committer": {"name": "Mark Simulacrum", "email": "mark.simulacrum@gmail.com", "date": "2017-08-21T12:22:01Z"}, "message": "Update rustbuild README", "tree": {"sha": "818a3780e7636a02405a7421566ae5a11da6b2a1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/818a3780e7636a02405a7421566ae5a11da6b2a1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1db158d4989c8aae46a8d14713a8594a775d5f96", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1db158d4989c8aae46a8d14713a8594a775d5f96", "html_url": "https://github.com/rust-lang/rust/commit/1db158d4989c8aae46a8d14713a8594a775d5f96", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1db158d4989c8aae46a8d14713a8594a775d5f96/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "757b7ac2abd69d97ba196b76f0bbf78c377aaea9", "url": "https://api.github.com/repos/rust-lang/rust/commits/757b7ac2abd69d97ba196b76f0bbf78c377aaea9", "html_url": "https://github.com/rust-lang/rust/commit/757b7ac2abd69d97ba196b76f0bbf78c377aaea9"}], "stats": {"total": 36, "additions": 20, "deletions": 16}, "files": [{"sha": "2e844ceb17831d59edd6f7481e8de525a7e54748", "filename": "src/bootstrap/README.md", "status": "modified", "additions": 20, "deletions": 16, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/1db158d4989c8aae46a8d14713a8594a775d5f96/src%2Fbootstrap%2FREADME.md", "raw_url": "https://github.com/rust-lang/rust/raw/1db158d4989c8aae46a8d14713a8594a775d5f96/src%2Fbootstrap%2FREADME.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2FREADME.md?ref=1db158d4989c8aae46a8d14713a8594a775d5f96", "patch": "@@ -73,16 +73,19 @@ The script accepts commands, flags, and arguments to determine what to do:\n \n ## Configuring rustbuild\n \n-There are currently two primary methods for configuring the rustbuild build\n-system. First, the `./configure` options serialized in `config.mk` will be\n-parsed and read. That is, if any `./configure` options are passed, they'll be\n-handled naturally.\n+There are currently two methods for configuring the rustbuild build system.\n \n-Next, rustbuild offers a TOML-based configuration system with a `config.toml`\n+First, rustbuild offers a TOML-based configuration system with a `config.toml`\n file in the same location as `config.mk`. An example of this configuration can\n-be found at `config.toml.example`, and the configuration file\n-can also be passed as `--config path/to/config.toml` if the build system is\n-being invoked manually (via the python script).\n+be found at `config.toml.example`, and the configuration file can also be passed\n+as `--config path/to/config.toml` if the build system is being invoked manually\n+(via the python script).\n+\n+Next, the `./configure` options serialized in `config.mk` will be\n+parsed and read. That is, if any `./configure` options are passed, they'll be\n+handled naturally. `./configure` should almost never be used for local\n+installations, and is primarily useful for CI. Prefer to customize behavior\n+using `config.toml`.\n \n Finally, rustbuild makes use of the [gcc-rs crate] which has [its own\n method][env-vars] of configuring C compilers and C flags via environment\n@@ -310,17 +313,18 @@ After that, each module in rustbuild should have enough documentation to keep\n you up and running. Some general areas that you may be interested in modifying\n are:\n \n-* Adding a new build tool? Take a look at `bootstrap/step.rs` for examples of\n+* Adding a new build tool? Take a look at `bootstrap/tool.rs` for examples of\n   other tools.\n * Adding a new compiler crate? Look no further! Adding crates can be done by\n   adding a new directory with `Cargo.toml` followed by configuring all\n   `Cargo.toml` files accordingly.\n-* Adding a new dependency from crates.io? We're still working on that, so hold\n-  off on that for now.\n-* Adding a new configuration option? Take a look at `bootstrap/config.rs` or\n-  perhaps `bootstrap/flags.rs` and then modify the build elsewhere to read that\n-  option.\n+* Adding a new dependency from crates.io? This should just work inside the\n+  compiler artifacts stage (everything other than libtest and libstd).\n+* Adding a new configuration option? You'll want to modify `bootstrap/flags.rs`\n+  for command line flags and then `bootstrap/config.rs` to copy the flags to the\n+  `Config` struct.\n * Adding a sanity check? Take a look at `bootstrap/sanity.rs`.\n \n-If you have any questions feel free to reach out on `#rust-internals` on IRC or\n-open an issue in the bug tracker!\n+If you have any questions feel free to reach out on `#rust-infra` on IRC or ask on\n+internals.rust-lang.org. When you encounter bugs, please file issues on the\n+rust-lang/rust issue tracker."}]}