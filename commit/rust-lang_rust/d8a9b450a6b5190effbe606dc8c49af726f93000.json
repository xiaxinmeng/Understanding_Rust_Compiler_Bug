{"sha": "d8a9b450a6b5190effbe606dc8c49af726f93000", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ4YTliNDUwYTZiNTE5MGVmZmJlNjA2ZGM4YzQ5YWY3MjZmOTMwMDA=", "commit": {"author": {"name": "John Renner", "email": "john@jrenner.net", "date": "2021-05-07T19:17:37Z"}, "committer": {"name": "John Renner", "email": "john@jrenner.net", "date": "2021-05-07T19:17:37Z"}, "message": "Switch from jemalloc to tikv-jemalloc", "tree": {"sha": "cad73531eeed3bedbf940447a5896bc23f88963a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cad73531eeed3bedbf940447a5896bc23f88963a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d8a9b450a6b5190effbe606dc8c49af726f93000", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d8a9b450a6b5190effbe606dc8c49af726f93000", "html_url": "https://github.com/rust-lang/rust/commit/d8a9b450a6b5190effbe606dc8c49af726f93000", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d8a9b450a6b5190effbe606dc8c49af726f93000/comments", "author": {"login": "djrenren", "id": 634666, "node_id": "MDQ6VXNlcjYzNDY2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/634666?v=4", "gravatar_id": "", "url": "https://api.github.com/users/djrenren", "html_url": "https://github.com/djrenren", "followers_url": "https://api.github.com/users/djrenren/followers", "following_url": "https://api.github.com/users/djrenren/following{/other_user}", "gists_url": "https://api.github.com/users/djrenren/gists{/gist_id}", "starred_url": "https://api.github.com/users/djrenren/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/djrenren/subscriptions", "organizations_url": "https://api.github.com/users/djrenren/orgs", "repos_url": "https://api.github.com/users/djrenren/repos", "events_url": "https://api.github.com/users/djrenren/events{/privacy}", "received_events_url": "https://api.github.com/users/djrenren/received_events", "type": "User", "site_admin": false}, "committer": {"login": "djrenren", "id": 634666, "node_id": "MDQ6VXNlcjYzNDY2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/634666?v=4", "gravatar_id": "", "url": "https://api.github.com/users/djrenren", "html_url": "https://github.com/djrenren", "followers_url": "https://api.github.com/users/djrenren/followers", "following_url": "https://api.github.com/users/djrenren/following{/other_user}", "gists_url": "https://api.github.com/users/djrenren/gists{/gist_id}", "starred_url": "https://api.github.com/users/djrenren/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/djrenren/subscriptions", "organizations_url": "https://api.github.com/users/djrenren/orgs", "repos_url": "https://api.github.com/users/djrenren/repos", "events_url": "https://api.github.com/users/djrenren/events{/privacy}", "received_events_url": "https://api.github.com/users/djrenren/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1ec82d4bdf47fa5ec1f8599757bbadae274d4f5a", "url": "https://api.github.com/repos/rust-lang/rust/commits/1ec82d4bdf47fa5ec1f8599757bbadae274d4f5a", "html_url": "https://github.com/rust-lang/rust/commit/1ec82d4bdf47fa5ec1f8599757bbadae274d4f5a"}], "stats": {"total": 76, "additions": 38, "deletions": 38}, "files": [{"sha": "f3a512a8a79fddffdd4608abe27e424c187f9c43", "filename": "Cargo.lock", "status": "modified", "additions": 34, "deletions": 34, "changes": 68, "blob_url": "https://github.com/rust-lang/rust/blob/d8a9b450a6b5190effbe606dc8c49af726f93000/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/d8a9b450a6b5190effbe606dc8c49af726f93000/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=d8a9b450a6b5190effbe606dc8c49af726f93000", "patch": "@@ -749,38 +749,6 @@ version = \"0.4.7\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"dd25036021b0de88a0aff6b850051563c6516d0bf53f8638938edbb9de732736\"\n \n-[[package]]\n-name = \"jemalloc-ctl\"\n-version = \"0.3.3\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"c502a5ff9dd2924f1ed32ba96e3b65735d837b4bfd978d3161b1702e66aca4b7\"\n-dependencies = [\n- \"jemalloc-sys\",\n- \"libc\",\n- \"paste\",\n-]\n-\n-[[package]]\n-name = \"jemalloc-sys\"\n-version = \"0.3.2\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"0d3b9f3f5c9b31aa0f5ed3260385ac205db665baa41d49bb8338008ae94ede45\"\n-dependencies = [\n- \"cc\",\n- \"fs_extra\",\n- \"libc\",\n-]\n-\n-[[package]]\n-name = \"jemallocator\"\n-version = \"0.3.2\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"43ae63fcfc45e99ab3d1b29a46782ad679e98436c3169d15a167a1108a724b69\"\n-dependencies = [\n- \"jemalloc-sys\",\n- \"libc\",\n-]\n-\n [[package]]\n name = \"jod-thread\"\n version = \"0.1.2\"\n@@ -1201,11 +1169,11 @@ version = \"0.0.0\"\n dependencies = [\n  \"cfg-if\",\n  \"countme\",\n- \"jemalloc-ctl\",\n  \"la-arena\",\n  \"libc\",\n  \"once_cell\",\n  \"perf-event\",\n+ \"tikv-jemalloc-ctl\",\n ]\n \n [[package]]\n@@ -1349,7 +1317,6 @@ dependencies = [\n  \"ide_db\",\n  \"ide_ssr\",\n  \"itertools\",\n- \"jemallocator\",\n  \"jod-thread\",\n  \"log\",\n  \"lsp-server\",\n@@ -1371,6 +1338,7 @@ dependencies = [\n  \"test_utils\",\n  \"text_edit\",\n  \"threadpool\",\n+ \"tikv-jemallocator\",\n  \"toolchain\",\n  \"tracing\",\n  \"tracing-subscriber\",\n@@ -1669,6 +1637,38 @@ dependencies = [\n  \"num_cpus\",\n ]\n \n+[[package]]\n+name = \"tikv-jemalloc-ctl\"\n+version = \"0.4.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"f28c80e4338857639f443169a601fafe49866aed8d7a8d565c2f5bfb1a021adf\"\n+dependencies = [\n+ \"libc\",\n+ \"paste\",\n+ \"tikv-jemalloc-sys\",\n+]\n+\n+[[package]]\n+name = \"tikv-jemalloc-sys\"\n+version = \"0.4.1+5.2.1-patched\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"8a26331b05179d4cb505c8d6814a7e18d298972f0a551b0e3cefccff927f86d3\"\n+dependencies = [\n+ \"cc\",\n+ \"fs_extra\",\n+ \"libc\",\n+]\n+\n+[[package]]\n+name = \"tikv-jemallocator\"\n+version = \"0.4.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"3c14a5a604eb8715bc5785018a37d00739b180bcf609916ddf4393d33d49ccdf\"\n+dependencies = [\n+ \"libc\",\n+ \"tikv-jemalloc-sys\",\n+]\n+\n [[package]]\n name = \"tinyvec\"\n version = \"1.2.0\""}, {"sha": "98df79a8f780f0b81addec8d8c9dd03d197dc3d5", "filename": "crates/profile/Cargo.toml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d8a9b450a6b5190effbe606dc8c49af726f93000/crates%2Fprofile%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/d8a9b450a6b5190effbe606dc8c49af726f93000/crates%2Fprofile%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fprofile%2FCargo.toml?ref=d8a9b450a6b5190effbe606dc8c49af726f93000", "patch": "@@ -15,14 +15,14 @@ cfg-if = \"1\"\n libc = \"0.2.73\"\n la-arena = { version = \"0.2.0\", path = \"../../lib/arena\" }\n countme = { version = \"2.0.1\", features = [\"enable\"] }\n-jemalloc-ctl = { version = \"0.3.3\", optional = true }\n+tikv-jemalloc-ctl = { version = \"0.4.1\", optional = true }\n \n [target.'cfg(target_os = \"linux\")'.dependencies]\n perf-event = \"0.4\"\n \n [features]\n cpu_profiler = []\n-jemalloc = [\"jemalloc-ctl\"]\n+jemalloc = [\"tikv-jemalloc-ctl\"]\n \n # Uncomment to enable for the whole crate graph\n # default = [ \"cpu_profiler\" ]"}, {"sha": "4b40e41ac4a2ff4d1a0a0705effc8af9a16f9071", "filename": "crates/rust-analyzer/Cargo.toml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d8a9b450a6b5190effbe606dc8c49af726f93000/crates%2Frust-analyzer%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/d8a9b450a6b5190effbe606dc8c49af726f93000/crates%2Frust-analyzer%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2FCargo.toml?ref=d8a9b450a6b5190effbe606dc8c49af726f93000", "patch": "@@ -63,7 +63,7 @@ proc_macro_srv = { path = \"../proc_macro_srv\", version = \"0.0.0\" }\n winapi = \"0.3.8\"\n \n [target.'cfg(not(target_env = \"msvc\"))'.dependencies]\n-jemallocator = { version = \"0.3.2\", optional = true }\n+tikv-jemallocator = { version = \"0.4.1\", optional = true }\n \n [dev-dependencies]\n expect-test = \"1.1\"\n@@ -72,5 +72,5 @@ mbe = { path = \"../mbe\" }\n tt = { path = \"../tt\" }\n \n [features]\n-jemalloc = [\"jemallocator\", \"profile/jemalloc\"]\n+jemalloc = [\"tikv-jemallocator\", \"profile/jemalloc\"]\n force-always-assert = [\"always-assert/force\"]"}]}