{"sha": "29aca83eb46cdc39dc695852ab30bb0ad06bea8f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI5YWNhODNlYjQ2Y2RjMzlkYzY5NTg1MmFiMzBiYjBhZDA2YmVhOGY=", "commit": {"author": {"name": "Ms2ger", "email": "ms2ger@gmail.com", "date": "2015-03-21T09:34:15Z"}, "committer": {"name": "Ms2ger", "email": "ms2ger@gmail.com", "date": "2015-03-22T19:27:00Z"}, "message": "Remove an unsafe function definition in __thread_local_inner.\n\nThis fixes a build error when using thread_local!() in a deny(unsafe_code)\nscope in Servo for Android.", "tree": {"sha": "ca10a416ff8f9db6575c89b099d3c0f0120be5d2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ca10a416ff8f9db6575c89b099d3c0f0120be5d2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/29aca83eb46cdc39dc695852ab30bb0ad06bea8f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/29aca83eb46cdc39dc695852ab30bb0ad06bea8f", "html_url": "https://github.com/rust-lang/rust/commit/29aca83eb46cdc39dc695852ab30bb0ad06bea8f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/29aca83eb46cdc39dc695852ab30bb0ad06bea8f/comments", "author": {"login": "Ms2ger", "id": 111161, "node_id": "MDQ6VXNlcjExMTE2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/111161?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ms2ger", "html_url": "https://github.com/Ms2ger", "followers_url": "https://api.github.com/users/Ms2ger/followers", "following_url": "https://api.github.com/users/Ms2ger/following{/other_user}", "gists_url": "https://api.github.com/users/Ms2ger/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ms2ger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ms2ger/subscriptions", "organizations_url": "https://api.github.com/users/Ms2ger/orgs", "repos_url": "https://api.github.com/users/Ms2ger/repos", "events_url": "https://api.github.com/users/Ms2ger/events{/privacy}", "received_events_url": "https://api.github.com/users/Ms2ger/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Ms2ger", "id": 111161, "node_id": "MDQ6VXNlcjExMTE2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/111161?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ms2ger", "html_url": "https://github.com/Ms2ger", "followers_url": "https://api.github.com/users/Ms2ger/followers", "following_url": "https://api.github.com/users/Ms2ger/following{/other_user}", "gists_url": "https://api.github.com/users/Ms2ger/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ms2ger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ms2ger/subscriptions", "organizations_url": "https://api.github.com/users/Ms2ger/orgs", "repos_url": "https://api.github.com/users/Ms2ger/repos", "events_url": "https://api.github.com/users/Ms2ger/events{/privacy}", "received_events_url": "https://api.github.com/users/Ms2ger/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ecf8c64e1b1b60f228f0c472c0b0dab4a5b5aa61", "url": "https://api.github.com/repos/rust-lang/rust/commits/ecf8c64e1b1b60f228f0c472c0b0dab4a5b5aa61", "html_url": "https://github.com/rust-lang/rust/commit/ecf8c64e1b1b60f228f0c472c0b0dab4a5b5aa61"}], "stats": {"total": 8, "additions": 3, "deletions": 5}, "files": [{"sha": "380ac0c838e1f30f9365fc759795d7b528c588db", "filename": "src/libstd/thread_local/mod.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/29aca83eb46cdc39dc695852ab30bb0ad06bea8f/src%2Flibstd%2Fthread_local%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/29aca83eb46cdc39dc695852ab30bb0ad06bea8f/src%2Flibstd%2Fthread_local%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fthread_local%2Fmod.rs?ref=29aca83eb46cdc39dc695852ab30bb0ad06bea8f", "patch": "@@ -205,15 +205,13 @@ macro_rules! __thread_local_inner {\n \n         #[cfg(any(not(any(target_os = \"macos\", target_os = \"linux\")), target_arch = \"aarch64\"))]\n         const _INIT: ::std::thread_local::__impl::KeyInner<$t> = {\n-            unsafe extern fn __destroy(ptr: *mut u8) {\n-                ::std::thread_local::__impl::destroy_value::<$t>(ptr);\n-            }\n-\n             ::std::thread_local::__impl::KeyInner {\n                 inner: ::std::cell::UnsafeCell { value: $init },\n                 os: ::std::thread_local::__impl::OsStaticKey {\n                     inner: ::std::thread_local::__impl::OS_INIT_INNER,\n-                    dtor: ::std::option::Option::Some(__destroy as unsafe extern fn(*mut u8)),\n+                    dtor: ::std::option::Option::Some(\n+                        ::std::thread_local::__impl::destroy_value::<$t>\n+                    ),\n                 },\n             }\n         };"}]}