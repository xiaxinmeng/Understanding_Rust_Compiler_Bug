{"sha": "ad83b47802040335ebd319f752ca1a9eb1c07fb7", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFkODNiNDc4MDIwNDAzMzVlYmQzMTlmNzUyY2ExYTllYjFjMDdmYjc=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2018-02-21T15:29:48Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-02-21T15:29:48Z"}, "message": "Rollup merge of #48198 - csmoe:inform_type_annotations, r=estebank\n\ninform user where to give a type annotation\n\nshould resolve #47777\nprevious pull request https://github.com/rust-lang/rust/pull/47982 was closed because of a mistaken rebase.\nr? @estebank", "tree": {"sha": "6306a532fddd1601b16c4fb388634b3e91717aed", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6306a532fddd1601b16c4fb388634b3e91717aed"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ad83b47802040335ebd319f752ca1a9eb1c07fb7", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJajZBtCRBK7hj4Ov3rIwAAdHIIAD1mra586R5ef4bXhKvDZMOe\nLfD0DtOLSEsFPx4Anp3Ii/oy3gJ0MV5x8Zt/Rr9qQxjWKwg+TX+gG50gBjVOm110\nRY6sH9ht0K83J+4rf1DF5rCe127ul/xGJWoPVhCZ+xoiWQRMt6xlUQljRZIL9ZBv\nVb/G8ewTKAeui7YB8nYBQ7PhUdxOSvzJ2HApNKPKaS1xHxBhOXt5B3Ona6g2m3xm\ndl0YXH/xRGVWDD2/HcxLdm9JhZEDAj9fOTmIIcxTKkzqVyB4XM7tqGF9dmTUTtbK\nN57yw7rfEaRc4OJ9Z2G9+4bThd8n1sjS5KVS9regACrGMHssJ6Npwh0Z04JZcl0=\n=t71R\n-----END PGP SIGNATURE-----\n", "payload": "tree 6306a532fddd1601b16c4fb388634b3e91717aed\nparent f0343cbd1f6140bfc72e305cebf3db26eb4a2c55\nparent 4370a5877c6c606dec106d200ccb36d5d78082a5\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1519226988 +0100\ncommitter GitHub <noreply@github.com> 1519226988 +0100\n\nRollup merge of #48198 - csmoe:inform_type_annotations, r=estebank\n\ninform user where to give a type annotation\n\nshould resolve #47777\nprevious pull request https://github.com/rust-lang/rust/pull/47982 was closed because of a mistaken rebase.\nr? @estebank\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ad83b47802040335ebd319f752ca1a9eb1c07fb7", "html_url": "https://github.com/rust-lang/rust/commit/ad83b47802040335ebd319f752ca1a9eb1c07fb7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ad83b47802040335ebd319f752ca1a9eb1c07fb7/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f0343cbd1f6140bfc72e305cebf3db26eb4a2c55", "url": "https://api.github.com/repos/rust-lang/rust/commits/f0343cbd1f6140bfc72e305cebf3db26eb4a2c55", "html_url": "https://github.com/rust-lang/rust/commit/f0343cbd1f6140bfc72e305cebf3db26eb4a2c55"}, {"sha": "4370a5877c6c606dec106d200ccb36d5d78082a5", "url": "https://api.github.com/repos/rust-lang/rust/commits/4370a5877c6c606dec106d200ccb36d5d78082a5", "html_url": "https://github.com/rust-lang/rust/commit/4370a5877c6c606dec106d200ccb36d5d78082a5"}], "stats": {"total": 66, "additions": 20, "deletions": 46}, "files": [{"sha": "9f3e44f56dae2ba952880f5149a47dd90994a4f2", "filename": "src/librustc_typeck/check/method/probe.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fprobe.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fprobe.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fprobe.rs?ref=ad83b47802040335ebd319f752ca1a9eb1c07fb7", "patch": "@@ -337,7 +337,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n                                 lint::builtin::TYVAR_BEHIND_RAW_POINTER,\n                                 scope_expr_id,\n                                 span,\n-                                &format!(\"the type of this value must be known in this context\"));\n+                                &format!(\"type annotations needed\"));\n                         }\n                     } else {\n                         let t = self.structurally_resolved_type(span, final_ty);"}, {"sha": "91fa3c5da6991035e776c754f3a6a0ebc6d74616", "filename": "src/librustc_typeck/check/mod.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs?ref=ad83b47802040335ebd319f752ca1a9eb1c07fb7", "patch": "@@ -5052,9 +5052,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n             ty\n         } else {\n             if !self.is_tainted_by_errors() {\n-                type_error_struct!(self.tcx.sess, sp, ty, E0619,\n-                                    \"the type of this value must be known in this context\")\n-                .emit();\n+                self.need_type_info((**self).body_id, sp, ty);\n             }\n             self.demand_suptype(sp, self.tcx.types.err, ty);\n             self.tcx.types.err"}, {"sha": "1c0e084832ebc9cc0fed91ee4ea1b61e895d3ab3", "filename": "src/librustc_typeck/diagnostics.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Flibrustc_typeck%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Flibrustc_typeck%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fdiagnostics.rs?ref=ad83b47802040335ebd319f752ca1a9eb1c07fb7", "patch": "@@ -4368,12 +4368,13 @@ i_am_a_function();\n \"##,\n \n E0619: r##\"\n+#### Note: this error code is no longer emitted by the compiler.\n The type-checker needed to know the type of an expression, but that type had not\n yet been inferred.\n \n Erroneous code example:\n \n-```compile_fail,E0619\n+```compile_fail\n let mut x = vec![];\n match x.pop() {\n     Some(v) => {"}, {"sha": "6aa83a38b7ee939aa4996d804a9e636dd3cf238a", "filename": "src/test/compile-fail/epoch-raw-pointer-method-2015.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fcompile-fail%2Fepoch-raw-pointer-method-2015.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fcompile-fail%2Fepoch-raw-pointer-method-2015.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fepoch-raw-pointer-method-2015.rs?ref=ad83b47802040335ebd319f752ca1a9eb1c07fb7", "patch": "@@ -18,6 +18,6 @@ fn main() {\n     let x = 0;\n     let y = &x as *const _;\n     let _ = y.is_null();\n-    //~^ error: the type of this value must be known in this context [tyvar_behind_raw_pointer]\n+    //~^ error: type annotations needed [tyvar_behind_raw_pointer]\n     //~^^ warning: this was previously accepted\n }"}, {"sha": "76ba5a0f4b371f42e7e6c26b70dc76756532e323", "filename": "src/test/compile-fail/issue-15965.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fcompile-fail%2Fissue-15965.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fcompile-fail%2Fissue-15965.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-15965.rs?ref=ad83b47802040335ebd319f752ca1a9eb1c07fb7", "patch": "@@ -11,7 +11,7 @@\n fn main() {\n     return\n         { return () }\n-//~^ ERROR the type of this value must be known in this context\n+//~^ ERROR type annotations needed [E0282]\n     ()\n     ;\n }"}, {"sha": "3cf971f3f8dfb4afe0794e61b7da27576d57b428", "filename": "src/test/compile-fail/issue-2151.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fcompile-fail%2Fissue-2151.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fcompile-fail%2Fissue-2151.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-2151.rs?ref=ad83b47802040335ebd319f752ca1a9eb1c07fb7", "patch": "@@ -10,5 +10,5 @@\n \n fn main() {\n     let x = panic!();\n-    x.clone(); //~ ERROR the type of this value must be known in this context\n+    x.clone(); //~ ERROR type annotations needed\n }"}, {"sha": "998c11979953cfde9c50a8107abf2be55e60e2bc", "filename": "src/test/compile-fail/match-vec-mismatch.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fcompile-fail%2Fmatch-vec-mismatch.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fcompile-fail%2Fmatch-vec-mismatch.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fmatch-vec-mismatch.rs?ref=ad83b47802040335ebd319f752ca1a9eb1c07fb7", "patch": "@@ -43,6 +43,6 @@ fn main() {\n fn another_fn_to_avoid_suppression() {\n     match Default::default()\n     {\n-        [] => {}  //~ ERROR the type of this value\n+        [] => {}  //~ ERROR type annotations needed\n     };\n }"}, {"sha": "251e7b47dcc99175c738fb3a3ca084bbc70c54ef", "filename": "src/test/compile-fail/pat-tuple-bad-type.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fcompile-fail%2Fpat-tuple-bad-type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fcompile-fail%2Fpat-tuple-bad-type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fpat-tuple-bad-type.rs?ref=ad83b47802040335ebd319f752ca1a9eb1c07fb7", "patch": "@@ -12,7 +12,7 @@ fn main() {\n     let x;\n \n     match x {\n-        (..) => {} //~ ERROR the type of this value must be known in this context\n+        (..) => {} //~ ERROR type annotations needed\n         _ => {}\n     }\n "}, {"sha": "8f5bf827fcf1ac801bf026f86e620633ba5c84bf", "filename": "src/test/compile-fail/unboxed-closures-failed-recursive-fn-2.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fcompile-fail%2Funboxed-closures-failed-recursive-fn-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fcompile-fail%2Funboxed-closures-failed-recursive-fn-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Funboxed-closures-failed-recursive-fn-2.rs?ref=ad83b47802040335ebd319f752ca1a9eb1c07fb7", "patch": "@@ -24,7 +24,7 @@ fn a() {\n                 match closure0.take() {\n                     Some(c) => {\n                         return c();\n-                        //~^ ERROR the type of this value must be known in this context\n+                        //~^ ERROR type annotations needed\n                     }\n                     None => { }\n                 }"}, {"sha": "a5a5ff7218dcfe26150499924ba76594dfe2fded", "filename": "src/test/ui/error-codes/E0619.rs", "status": "removed", "additions": 0, "deletions": 19, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/f0343cbd1f6140bfc72e305cebf3db26eb4a2c55/src%2Ftest%2Fui%2Ferror-codes%2FE0619.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f0343cbd1f6140bfc72e305cebf3db26eb4a2c55/src%2Ftest%2Fui%2Ferror-codes%2FE0619.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0619.rs?ref=f0343cbd1f6140bfc72e305cebf3db26eb4a2c55", "patch": "@@ -1,19 +0,0 @@\n-// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n-// file at the top-level directory of this distribution and at\n-// http://rust-lang.org/COPYRIGHT.\n-//\n-// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n-// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n-// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n-// option. This file may not be copied, modified, or distributed\n-// except according to those terms.\n-\n-fn main() {\n-    let x;\n-\n-    match x {\n-        (..) => {} //~ ERROR E0619\n-        _ => {}\n-    }\n-}\n-"}, {"sha": "cec336cfcec661f420d67b54ab2d9452907bca1f", "filename": "src/test/ui/error-codes/E0619.stderr", "status": "removed", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/f0343cbd1f6140bfc72e305cebf3db26eb4a2c55/src%2Ftest%2Fui%2Ferror-codes%2FE0619.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/f0343cbd1f6140bfc72e305cebf3db26eb4a2c55/src%2Ftest%2Fui%2Ferror-codes%2FE0619.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0619.stderr?ref=f0343cbd1f6140bfc72e305cebf3db26eb4a2c55", "patch": "@@ -1,8 +0,0 @@\n-error[E0619]: the type of this value must be known in this context\n-  --> $DIR/E0619.rs:15:9\n-   |\n-15 |         (..) => {} //~ ERROR E0619\n-   |         ^^^^\n-\n-error: aborting due to previous error\n-"}, {"sha": "bb1d921f1c61c252e8e4cba409be578c21c70f42", "filename": "src/test/ui/inference-variable-behind-raw-pointer.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fui%2Finference-variable-behind-raw-pointer.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fui%2Finference-variable-behind-raw-pointer.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finference-variable-behind-raw-pointer.stderr?ref=ad83b47802040335ebd319f752ca1a9eb1c07fb7", "patch": "@@ -1,4 +1,4 @@\n-warning: the type of this value must be known in this context\n+warning: type annotations needed\n   --> $DIR/inference-variable-behind-raw-pointer.rs:18:13\n    |\n 18 |     if data.is_null() {}"}, {"sha": "975c81955e0b3c422c3f635c69c631aaca7e824e", "filename": "src/test/ui/span/issue-42234-unknown-receiver-type.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fui%2Fspan%2Fissue-42234-unknown-receiver-type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fui%2Fspan%2Fissue-42234-unknown-receiver-type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2Fissue-42234-unknown-receiver-type.rs?ref=ad83b47802040335ebd319f752ca1a9eb1c07fb7", "patch": "@@ -15,11 +15,11 @@\n fn shines_a_beacon_through_the_darkness() {\n     let x: Option<_> = None;\n     x.unwrap().method_that_could_exist_on_some_type();\n-    //~^ ERROR 17:5: 17:15: the type of this value must be known in this context\n+    //~^ ERROR 17:5: 17:15: type annotations needed\n }\n \n fn courier_to_des_moines_and_points_west(data: &[u32]) -> String {\n-    data.iter() //~ ERROR 22:5: 23:20: the type of this value must be known in this context\n+    data.iter() //~ ERROR 22:5: 23:20: type annotations needed\n         .sum::<_>()\n         .to_string()\n }"}, {"sha": "d87cec642f18e47aa23b24c875a029f824fbeeeb", "filename": "src/test/ui/span/issue-42234-unknown-receiver-type.stderr", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fui%2Fspan%2Fissue-42234-unknown-receiver-type.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ad83b47802040335ebd319f752ca1a9eb1c07fb7/src%2Ftest%2Fui%2Fspan%2Fissue-42234-unknown-receiver-type.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2Fissue-42234-unknown-receiver-type.stderr?ref=ad83b47802040335ebd319f752ca1a9eb1c07fb7", "patch": "@@ -1,15 +1,17 @@\n-error[E0619]: the type of this value must be known in this context\n+error[E0282]: type annotations needed\n   --> $DIR/issue-42234-unknown-receiver-type.rs:17:5\n    |\n+16 |     let x: Option<_> = None;\n+   |         - consider giving `x` a type\n 17 |     x.unwrap().method_that_could_exist_on_some_type();\n-   |     ^^^^^^^^^^\n+   |     ^^^^^^^^^^ cannot infer type for `T`\n \n-error[E0619]: the type of this value must be known in this context\n+error[E0282]: type annotations needed\n   --> $DIR/issue-42234-unknown-receiver-type.rs:22:5\n    |\n-22 | /     data.iter() //~ ERROR 22:5: 23:20: the type of this value must be known in this context\n+22 | /     data.iter() //~ ERROR 22:5: 23:20: type annotations needed\n 23 | |         .sum::<_>()\n-   | |___________________^\n+   | |___________________^ cannot infer type for `_`\n \n error: aborting due to 2 previous errors\n "}]}