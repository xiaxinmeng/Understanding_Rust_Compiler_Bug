{"sha": "4eea02e725052a8941abd728cb1da98e4d9770a8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRlZWEwMmU3MjUwNTJhODk0MWFiZDcyOGNiMWRhOThlNGQ5NzcwYTg=", "commit": {"author": {"name": "Aaron Hill", "email": "aa1ronham@gmail.com", "date": "2020-10-04T20:26:09Z"}, "committer": {"name": "Aaron Hill", "email": "aa1ronham@gmail.com", "date": "2020-10-04T20:26:09Z"}, "message": "Normalize MIRI_TEMP before using it", "tree": {"sha": "bd890e478271e1b9bbf5253ae40a1588b5a8330f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bd890e478271e1b9bbf5253ae40a1588b5a8330f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4eea02e725052a8941abd728cb1da98e4d9770a8", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE7J9Gc3TfBwj2K399tAh+UQ6YsWQFAl96L+8ACgkQtAh+UQ6Y\nsWSSBhAAkUUmLnacRDBriGCOBT20wx/Qj/O31s0SmGXPLn8BsiDwBllhcEFaE2KH\nMN8X4sdUP1+Z09Ra1pew7LEHUj4ApOenXTQh3PaXhTJQQAncSJUyrXYz1uXQc3Hd\nrv8S6OvC4XBE5QPV1W+PlB4NrDE1Gi4adsg49+y0ZnM/lnIFYtoNnVNYvkEz4t7B\n2HlEmaCTcO6u/VGQArI4yPuO+/lfx6mK38RbDeoJWzYIjN9C+Vd0xD98Zz3Zf6Rr\nVnSk6NSDLIRMl1h1lBHWMCoCS1gkBu8GRuWs922lisCp2RziLr2gYBhkXjrYxAnH\ncFmdHfMZxVjo1rl8duQ58DNDBF2r4pnxYIAkVSUpWV9VpZWyp4GCBVeDGOLUQoHv\nmr2gfmZUpTnjse3pAsMxvFd3Ta4RNWWTsabQn+fwU/FLGg5+WujPcWBnPlRcTkb8\nbmdm0maqfSGNpdFZp6yTfqtGjJoEOL/eeoV+2n/WC+4z3aPKMcbIXYv96nkztO7x\ncaZecluIlnnyRTb9CZffaDwMwt3iK+LPvaZB15LYUHeGwDMZLVQ7+1b9pm/Rhd1P\n+QD42NanxqVdhNh9J0osQjU3xcSZQ5iCqbHi5HeoemnTvzEo7ZSxAvz+D5MH7WFk\nTD4omFMdTwSdHZjAIPlFAJuQHW197eUEqrNtZmyM0a9GHk8IVic=\n=2TEZ\n-----END PGP SIGNATURE-----", "payload": "tree bd890e478271e1b9bbf5253ae40a1588b5a8330f\nparent 9e6320f1017a5af43b8f1726ff68c8c494d3e8bc\nauthor Aaron Hill <aa1ronham@gmail.com> 1601843169 -0400\ncommitter Aaron Hill <aa1ronham@gmail.com> 1601843169 -0400\n\nNormalize MIRI_TEMP before using it\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4eea02e725052a8941abd728cb1da98e4d9770a8", "html_url": "https://github.com/rust-lang/rust/commit/4eea02e725052a8941abd728cb1da98e4d9770a8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4eea02e725052a8941abd728cb1da98e4d9770a8/comments", "author": {"login": "Aaron1011", "id": 1408859, "node_id": "MDQ6VXNlcjE0MDg4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aaron1011", "html_url": "https://github.com/Aaron1011", "followers_url": "https://api.github.com/users/Aaron1011/followers", "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}", "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions", "organizations_url": "https://api.github.com/users/Aaron1011/orgs", "repos_url": "https://api.github.com/users/Aaron1011/repos", "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Aaron1011/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Aaron1011", "id": 1408859, "node_id": "MDQ6VXNlcjE0MDg4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aaron1011", "html_url": "https://github.com/Aaron1011", "followers_url": "https://api.github.com/users/Aaron1011/followers", "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}", "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions", "organizations_url": "https://api.github.com/users/Aaron1011/orgs", "repos_url": "https://api.github.com/users/Aaron1011/repos", "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Aaron1011/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9e6320f1017a5af43b8f1726ff68c8c494d3e8bc", "url": "https://api.github.com/repos/rust-lang/rust/commits/9e6320f1017a5af43b8f1726ff68c8c494d3e8bc", "html_url": "https://github.com/rust-lang/rust/commit/9e6320f1017a5af43b8f1726ff68c8c494d3e8bc"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "f74d1c9a36b1be7d57475352e1dcd2998e89800b", "filename": "tests/run-pass/fs.rs", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/4eea02e725052a8941abd728cb1da98e4d9770a8/tests%2Frun-pass%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4eea02e725052a8941abd728cb1da98e4d9770a8/tests%2Frun-pass%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Ffs.rs?ref=4eea02e725052a8941abd728cb1da98e4d9770a8", "patch": "@@ -29,7 +29,19 @@ fn main() {\n }\n \n fn tmp() -> PathBuf {\n-    std::env::var(\"MIRI_TEMP\").map(PathBuf::from).unwrap_or_else(|_| std::env::temp_dir())\n+    std::env::var(\"MIRI_TEMP\")\n+        .map(|tmp| {\n+            // MIRI_TEMP is set outside of our emulated\n+            // program, so it may have path separators that don't\n+            // correspond to our target platform. We normalize them here\n+            // before constructing a `PathBuf`\n+\n+            #[cfg(windows)]\n+            return PathBuf::from(tmp.replace(\"/\", \"\\\\\"));\n+\n+            #[cfg(not(windows))]\n+            return PathBuf::from(tmp.replace(\"\\\\\", \"/\"));\n+        }).unwrap_or_else(|_| std::env::temp_dir())\n }\n \n /// Prepare: compute filename and make sure the file does not exist."}]}