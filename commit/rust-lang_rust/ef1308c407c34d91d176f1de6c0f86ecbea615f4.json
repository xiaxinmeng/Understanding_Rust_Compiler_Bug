{"sha": "ef1308c407c34d91d176f1de6c0f86ecbea615f4", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVmMTMwOGM0MDdjMzRkOTFkMTc2ZjFkZTZjMGY4NmVjYmVhNjE1ZjQ=", "commit": {"author": {"name": "Florian Hahn", "email": "flo@fhahn.com", "date": "2015-02-15T14:30:09Z"}, "committer": {"name": "Florian Hahn", "email": "flo@fhahn.com", "date": "2015-02-16T16:11:42Z"}, "message": "Handle RUST_TEST_NOCAPTURE in compiletest and set add if to run env\n\ncloses  #17829", "tree": {"sha": "8ea32b5476d404ac20da8a72cf9840af9caef555", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8ea32b5476d404ac20da8a72cf9840af9caef555"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ef1308c407c34d91d176f1de6c0f86ecbea615f4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ef1308c407c34d91d176f1de6c0f86ecbea615f4", "html_url": "https://github.com/rust-lang/rust/commit/ef1308c407c34d91d176f1de6c0f86ecbea615f4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ef1308c407c34d91d176f1de6c0f86ecbea615f4/comments", "author": {"login": "fhahn", "id": 450489, "node_id": "MDQ6VXNlcjQ1MDQ4OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/450489?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fhahn", "html_url": "https://github.com/fhahn", "followers_url": "https://api.github.com/users/fhahn/followers", "following_url": "https://api.github.com/users/fhahn/following{/other_user}", "gists_url": "https://api.github.com/users/fhahn/gists{/gist_id}", "starred_url": "https://api.github.com/users/fhahn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fhahn/subscriptions", "organizations_url": "https://api.github.com/users/fhahn/orgs", "repos_url": "https://api.github.com/users/fhahn/repos", "events_url": "https://api.github.com/users/fhahn/events{/privacy}", "received_events_url": "https://api.github.com/users/fhahn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fhahn", "id": 450489, "node_id": "MDQ6VXNlcjQ1MDQ4OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/450489?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fhahn", "html_url": "https://github.com/fhahn", "followers_url": "https://api.github.com/users/fhahn/followers", "following_url": "https://api.github.com/users/fhahn/following{/other_user}", "gists_url": "https://api.github.com/users/fhahn/gists{/gist_id}", "starred_url": "https://api.github.com/users/fhahn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fhahn/subscriptions", "organizations_url": "https://api.github.com/users/fhahn/orgs", "repos_url": "https://api.github.com/users/fhahn/repos", "events_url": "https://api.github.com/users/fhahn/events{/privacy}", "received_events_url": "https://api.github.com/users/fhahn/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5be210c4188fb2f1a4fabc6baee5397ac6e6741e", "url": "https://api.github.com/repos/rust-lang/rust/commits/5be210c4188fb2f1a4fabc6baee5397ac6e6741e", "html_url": "https://github.com/rust-lang/rust/commit/5be210c4188fb2f1a4fabc6baee5397ac6e6741e"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "d43fe242c65a15be9c8dde566c96190fe1facf7c", "filename": "src/compiletest/compiletest.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ef1308c407c34d91d176f1de6c0f86ecbea615f4/src%2Fcompiletest%2Fcompiletest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ef1308c407c34d91d176f1de6c0f86ecbea615f4/src%2Fcompiletest%2Fcompiletest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcompiletest%2Fcompiletest.rs?ref=ef1308c407c34d91d176f1de6c0f86ecbea615f4", "patch": "@@ -267,7 +267,7 @@ pub fn test_opts(config: &Config) -> test::TestOpts {\n         logfile: config.logfile.clone(),\n         run_tests: true,\n         run_benchmarks: true,\n-        nocapture: false,\n+        nocapture: env::var(\"RUST_TEST_NOCAPTURE\").is_ok(),\n         color: test::AutoColor,\n     }\n }"}, {"sha": "fceac9716b115bb85f353f1102aae8852f252c72", "filename": "src/compiletest/header.rs", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/ef1308c407c34d91d176f1de6c0f86ecbea615f4/src%2Fcompiletest%2Fheader.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ef1308c407c34d91d176f1de6c0f86ecbea615f4/src%2Fcompiletest%2Fheader.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcompiletest%2Fheader.rs?ref=ef1308c407c34d91d176f1de6c0f86ecbea615f4", "patch": "@@ -8,6 +8,8 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n+use std::env;\n+\n use common::Config;\n use common;\n use util;\n@@ -125,6 +127,16 @@ pub fn load_props(testfile: &Path) -> TestProps {\n         true\n     });\n \n+    for key in vec![\"RUST_TEST_NOCAPTURE\", \"RUST_TEST_TASKS\"] {\n+        match env::var(key) {\n+            Ok(val) =>\n+                if exec_env.iter().find(|&&(ref x, _)| *x == key.to_string()).is_none() {\n+                    exec_env.push((key.to_string(), val))\n+                },\n+            Err(..) => {}\n+        }\n+    }\n+\n     TestProps {\n         error_patterns: error_patterns,\n         compile_flags: compile_flags,"}]}