{"sha": "b068b742ee9dac585cdaf781a09bbdabba9c27a4", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIwNjhiNzQyZWU5ZGFjNTg1Y2RhZjc4MWEwOWJiZGFiYmE5YzI3YTQ=", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2021-03-11T14:18:56Z"}, "committer": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2021-03-11T14:27:30Z"}, "message": "lintcheck: fix --fix and document it in the readme.\n\nalso hook lintcheck into clippy-dev so that `clippy dev fmt` formats it.", "tree": {"sha": "1a222e0f81ee341824dde0022721edd46451f55b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1a222e0f81ee341824dde0022721edd46451f55b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b068b742ee9dac585cdaf781a09bbdabba9c27a4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b068b742ee9dac585cdaf781a09bbdabba9c27a4", "html_url": "https://github.com/rust-lang/rust/commit/b068b742ee9dac585cdaf781a09bbdabba9c27a4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b068b742ee9dac585cdaf781a09bbdabba9c27a4/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b29ef183fb9b8a25c4a904d63428c8e37dd9696b", "url": "https://api.github.com/repos/rust-lang/rust/commits/b29ef183fb9b8a25c4a904d63428c8e37dd9696b", "html_url": "https://github.com/rust-lang/rust/commit/b29ef183fb9b8a25c4a904d63428c8e37dd9696b"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "a26d6aba10d20ed5beb03e9e49d038524e0c4387", "filename": "clippy_dev/src/fmt.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b068b742ee9dac585cdaf781a09bbdabba9c27a4/clippy_dev%2Fsrc%2Ffmt.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b068b742ee9dac585cdaf781a09bbdabba9c27a4/clippy_dev%2Fsrc%2Ffmt.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Ffmt.rs?ref=b068b742ee9dac585cdaf781a09bbdabba9c27a4", "patch": "@@ -54,6 +54,7 @@ pub fn run(check: bool, verbose: bool) {\n         success &= cargo_fmt(context, project_root.as_path())?;\n         success &= cargo_fmt(context, &project_root.join(\"clippy_dev\"))?;\n         success &= cargo_fmt(context, &project_root.join(\"rustc_tools_util\"))?;\n+        success &= cargo_fmt(context, &project_root.join(\"lintcheck\"))?;\n \n         for entry in WalkDir::new(project_root.join(\"tests\")) {\n             let entry = entry?;"}, {"sha": "983f59efdbd22f7c3eae963e2f253833b4f16228", "filename": "lintcheck/README.md", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b068b742ee9dac585cdaf781a09bbdabba9c27a4/lintcheck%2FREADME.md", "raw_url": "https://github.com/rust-lang/rust/raw/b068b742ee9dac585cdaf781a09bbdabba9c27a4/lintcheck%2FREADME.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/lintcheck%2FREADME.md?ref=b068b742ee9dac585cdaf781a09bbdabba9c27a4", "patch": "@@ -67,3 +67,9 @@ is checked.\n \n **Note:** `-Wclippy::all` is always enabled by default, unless `-Aclippy::all`\n is explicitly specified in the options.\n+\n+### Fix mode\n+You can run `./lintcheck/target/debug/lintcheck --fix` which will run Clippy with `-Zunstable-options --fix` and print a warning if Clippys suggestions fail to apply (if the resulting code does not build).\n+This lets us spot bad suggestions or false positives automatically in some cases.  \n+\n+Please note that the target dir should be cleaned afterwards since clippy will modify the downloaded sources which can lead to unexpected results when running lintcheck again afterwards.\n\\ No newline at end of file"}, {"sha": "4028be0bf6564368393e698330354371871bf992", "filename": "lintcheck/src/main.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b068b742ee9dac585cdaf781a09bbdabba9c27a4/lintcheck%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b068b742ee9dac585cdaf781a09bbdabba9c27a4/lintcheck%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/lintcheck%2Fsrc%2Fmain.rs?ref=b068b742ee9dac585cdaf781a09bbdabba9c27a4", "patch": "@@ -862,7 +862,11 @@ fn get_clap_config<'a>() -> ArgMatches<'a> {\n                 .long(\"jobs\")\n                 .help(\"number of threads to use, 0 automatic choice\"),\n         )\n-        .arg(Arg::with_name(\"fix\").help(\"runs cargo clippy --fix and checks if all suggestions apply\"))\n+        .arg(\n+            Arg::with_name(\"fix\")\n+                .long(\"--fix\")\n+                .help(\"runs cargo clippy --fix and checks if all suggestions apply\"),\n+        )\n         .get_matches()\n }\n "}]}