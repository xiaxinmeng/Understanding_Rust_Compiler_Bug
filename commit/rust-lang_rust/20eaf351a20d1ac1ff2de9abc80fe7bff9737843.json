{"sha": "20eaf351a20d1ac1ff2de9abc80fe7bff9737843", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIwZWFmMzUxYTIwZDFhYzFmZjJkZTlhYmM4MGZlN2JmZjk3Mzc4NDM=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-03-22T09:51:26Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-03-22T14:43:38Z"}, "message": "Rollup merge of #49140 - semarie:rustdoc-test-path, r=alexcrichton\n\nAllow test target to pass without installing\n\nexplicitly pass -L target-lib to rustdoc\n\non OpenBSD, without it, it fails on several tests with:\n```\nerror[E0463]: can't find crate for `std`\n```", "tree": {"sha": "d2708c1bb60327d6f9aa93ae1a25da2659abd113", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d2708c1bb60327d6f9aa93ae1a25da2659abd113"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/20eaf351a20d1ac1ff2de9abc80fe7bff9737843", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlqzwRsACgkQ/vbIBR0O\nATwIpg/7BneGmXVXeeK2DDzfxoNdN8P9nKC3XapBoUYPpuE7TSeMif9fOtItt47C\nGuG9QXolFBgFJfcNboZg4YykIcav4FgLneIfhkonKw+J+jcMLbtrew+hZHSXSL5E\nTGKC4fa94B92N5izD4BMuRTKNl2sbIj6q4E1GFBZFRVjn5duG4DvjEiX7Jf1TF/+\nJrlX1JwZcCN2lxovpe8PPDbz4vbBV9453Qvc/DauiE1IyqY7JCMbE+jl/kN8oxfn\ngpOECvxj83rHlxQxHsBDPafj3Dnux/RBsKNTYWcVh/8wRVGh0zl622xH68kVgOS/\n+KvhCLU88UhpuXk/lGE53lrQ92NfNYEj6lCaUf/uJnkOPzEkDrS5p+lqhiyF5rsn\n4+50s9fMr8k6x9orlMaChUjrd6hgPOTo9h4D6t+hhAsA/mRrw5ye2kA2t96r1czh\noXCEgp3BdLtKnV2XrIPbOChOon2ZhWGb+3P0W6Fj7TFkM7fbcGnk9kB2bF8KcmRZ\nfiT3mn3oIJLCh3vkMfz6tYtev/nMLfk2a+OHjpIDy+n19rMPC4Gma7yxu5hsc0ff\n8eOh2uczQ7XdSGsCZQ/Jgbupa0M9eA9q0JUgCYxX33AZERTfWh2SXe2d0nr678KK\nbIw21v17AHSOS/Mgu+UuZLEib6ANe/C3UrUt5QMIBEdJXc5tKPM=\n=0GZr\n-----END PGP SIGNATURE-----", "payload": "tree d2708c1bb60327d6f9aa93ae1a25da2659abd113\nparent 8d3f3f0cac3de7dfbb126db3c48d7499c96d86ec\nparent e269a7435e80e0c4e02e3a5aa21233ef28892def\nauthor kennytm <kennytm@gmail.com> 1521712286 +0800\ncommitter kennytm <kennytm@gmail.com> 1521729818 +0800\n\nRollup merge of #49140 - semarie:rustdoc-test-path, r=alexcrichton\n\nAllow test target to pass without installing\n\nexplicitly pass -L target-lib to rustdoc\n\non OpenBSD, without it, it fails on several tests with:\n```\nerror[E0463]: can't find crate for `std`\n```\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/20eaf351a20d1ac1ff2de9abc80fe7bff9737843", "html_url": "https://github.com/rust-lang/rust/commit/20eaf351a20d1ac1ff2de9abc80fe7bff9737843", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/20eaf351a20d1ac1ff2de9abc80fe7bff9737843/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8d3f3f0cac3de7dfbb126db3c48d7499c96d86ec", "url": "https://api.github.com/repos/rust-lang/rust/commits/8d3f3f0cac3de7dfbb126db3c48d7499c96d86ec", "html_url": "https://github.com/rust-lang/rust/commit/8d3f3f0cac3de7dfbb126db3c48d7499c96d86ec"}, {"sha": "e269a7435e80e0c4e02e3a5aa21233ef28892def", "url": "https://api.github.com/repos/rust-lang/rust/commits/e269a7435e80e0c4e02e3a5aa21233ef28892def", "html_url": "https://github.com/rust-lang/rust/commit/e269a7435e80e0c4e02e3a5aa21233ef28892def"}], "stats": {"total": 4, "additions": 3, "deletions": 1}, "files": [{"sha": "af1707de6c02f52432cfc241cca0df4f9e06ad70", "filename": "src/test/run-make/tools.mk", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/20eaf351a20d1ac1ff2de9abc80fe7bff9737843/src%2Ftest%2Frun-make%2Ftools.mk", "raw_url": "https://github.com/rust-lang/rust/raw/20eaf351a20d1ac1ff2de9abc80fe7bff9737843/src%2Ftest%2Frun-make%2Ftools.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Ftools.mk?ref=20eaf351a20d1ac1ff2de9abc80fe7bff9737843", "patch": "@@ -9,7 +9,7 @@ RUSTC_ORIGINAL := $(RUSTC)\n BARE_RUSTC := $(HOST_RPATH_ENV) '$(RUSTC)'\n BARE_RUSTDOC := $(HOST_RPATH_ENV) '$(RUSTDOC)'\n RUSTC := $(BARE_RUSTC) --out-dir $(TMPDIR) -L $(TMPDIR) $(RUSTFLAGS)\n-RUSTDOC := $(BARE_RUSTDOC)\n+RUSTDOC := $(BARE_RUSTDOC) -L $(TARGET_RPATH_DIR)\n ifdef RUSTC_LINKER\n RUSTC := $(RUSTC) -Clinker=$(RUSTC_LINKER)\n RUSTDOC := $(RUSTDOC) --linker $(RUSTC_LINKER) -Z unstable-options"}, {"sha": "43220af4893bbcd97efb776f6af9961e68c4f9a0", "filename": "src/tools/compiletest/src/runtest.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/20eaf351a20d1ac1ff2de9abc80fe7bff9737843/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/20eaf351a20d1ac1ff2de9abc80fe7bff9737843/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs?ref=20eaf351a20d1ac1ff2de9abc80fe7bff9737843", "patch": "@@ -1324,6 +1324,8 @@ impl<'test> TestCx<'test> {\n         let mut rustdoc = Command::new(rustdoc_path);\n \n         rustdoc\n+            .arg(\"-L\")\n+            .arg(self.config.run_lib_path.to_str().unwrap())\n             .arg(\"-L\")\n             .arg(aux_dir)\n             .arg(\"-o\")"}]}