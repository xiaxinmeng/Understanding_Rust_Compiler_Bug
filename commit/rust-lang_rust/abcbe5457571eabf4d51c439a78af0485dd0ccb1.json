{"sha": "abcbe5457571eabf4d51c439a78af0485dd0ccb1", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFiY2JlNTQ1NzU3MWVhYmY0ZDUxYzQzOWE3OGFmMDQ4NWRkMGNjYjE=", "commit": {"author": {"name": "Lukas Lueg", "email": "lukas.lueg@gmail.com", "date": "2021-02-09T21:14:32Z"}, "committer": {"name": "Lukas Lueg", "email": "lukas.lueg@gmail.com", "date": "2021-03-26T16:41:14Z"}, "message": "Stabilize `peekable_peek_mut`\n\nResolves #78302\n\nUpdate peekable.rs\n\nUpdate library/core/src/iter/traits/iterator.rs\n\nCo-authored-by: Ashley Mannix <kodraus@hey.com>", "tree": {"sha": "035d06253c9fccec611c201e4a904ae16f8a3b09", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/035d06253c9fccec611c201e4a904ae16f8a3b09"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/abcbe5457571eabf4d51c439a78af0485dd0ccb1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/abcbe5457571eabf4d51c439a78af0485dd0ccb1", "html_url": "https://github.com/rust-lang/rust/commit/abcbe5457571eabf4d51c439a78af0485dd0ccb1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/abcbe5457571eabf4d51c439a78af0485dd0ccb1/comments", "author": {"login": "lukaslueg", "id": 3148704, "node_id": "MDQ6VXNlcjMxNDg3MDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3148704?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lukaslueg", "html_url": "https://github.com/lukaslueg", "followers_url": "https://api.github.com/users/lukaslueg/followers", "following_url": "https://api.github.com/users/lukaslueg/following{/other_user}", "gists_url": "https://api.github.com/users/lukaslueg/gists{/gist_id}", "starred_url": "https://api.github.com/users/lukaslueg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lukaslueg/subscriptions", "organizations_url": "https://api.github.com/users/lukaslueg/orgs", "repos_url": "https://api.github.com/users/lukaslueg/repos", "events_url": "https://api.github.com/users/lukaslueg/events{/privacy}", "received_events_url": "https://api.github.com/users/lukaslueg/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lukaslueg", "id": 3148704, "node_id": "MDQ6VXNlcjMxNDg3MDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3148704?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lukaslueg", "html_url": "https://github.com/lukaslueg", "followers_url": "https://api.github.com/users/lukaslueg/followers", "following_url": "https://api.github.com/users/lukaslueg/following{/other_user}", "gists_url": "https://api.github.com/users/lukaslueg/gists{/gist_id}", "starred_url": "https://api.github.com/users/lukaslueg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lukaslueg/subscriptions", "organizations_url": "https://api.github.com/users/lukaslueg/orgs", "repos_url": "https://api.github.com/users/lukaslueg/repos", "events_url": "https://api.github.com/users/lukaslueg/events{/privacy}", "received_events_url": "https://api.github.com/users/lukaslueg/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e423058751a2b098d3e469a8e6df1b7a8bbd67b6", "url": "https://api.github.com/repos/rust-lang/rust/commits/e423058751a2b098d3e469a8e6df1b7a8bbd67b6", "html_url": "https://github.com/rust-lang/rust/commit/e423058751a2b098d3e469a8e6df1b7a8bbd67b6"}], "stats": {"total": 50, "additions": 35, "deletions": 15}, "files": [{"sha": "dfa59df6dab6c582929e4d2df4f26dfc6a59d80e", "filename": "library/core/src/iter/adapters/peekable.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/abcbe5457571eabf4d51c439a78af0485dd0ccb1/library%2Fcore%2Fsrc%2Fiter%2Fadapters%2Fpeekable.rs", "raw_url": "https://github.com/rust-lang/rust/raw/abcbe5457571eabf4d51c439a78af0485dd0ccb1/library%2Fcore%2Fsrc%2Fiter%2Fadapters%2Fpeekable.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fiter%2Fadapters%2Fpeekable.rs?ref=abcbe5457571eabf4d51c439a78af0485dd0ccb1", "patch": "@@ -233,7 +233,6 @@ impl<I: Iterator> Peekable<I> {\n     /// Basic usage:\n     ///\n     /// ```\n-    /// #![feature(peekable_peek_mut)]\n     /// let mut iter = [1, 2, 3].iter().peekable();\n     ///\n     /// // Like with `peek()`, we can see into the future without advancing the iterator.\n@@ -251,7 +250,7 @@ impl<I: Iterator> Peekable<I> {\n     /// assert_eq!(iter.collect::<Vec<_>>(), vec![&5, &3]);\n     /// ```\n     #[inline]\n-    #[unstable(feature = \"peekable_peek_mut\", issue = \"78302\")]\n+    #[stable(feature = \"peekable_peek_mut\", since = \"1.52.0\")]\n     pub fn peek_mut(&mut self) -> Option<&mut I::Item> {\n         let iter = &mut self.iter;\n         self.peeked.get_or_insert_with(|| iter.next()).as_mut()"}, {"sha": "7de068f58350ea6429addca68e465af60ddc3119", "filename": "library/core/src/iter/traits/iterator.rs", "status": "modified", "additions": 34, "deletions": 12, "changes": 46, "blob_url": "https://github.com/rust-lang/rust/blob/abcbe5457571eabf4d51c439a78af0485dd0ccb1/library%2Fcore%2Fsrc%2Fiter%2Ftraits%2Fiterator.rs", "raw_url": "https://github.com/rust-lang/rust/raw/abcbe5457571eabf4d51c439a78af0485dd0ccb1/library%2Fcore%2Fsrc%2Fiter%2Ftraits%2Fiterator.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fiter%2Ftraits%2Fiterator.rs?ref=abcbe5457571eabf4d51c439a78af0485dd0ccb1", "patch": "@@ -936,20 +936,16 @@ pub trait Iterator {\n         Enumerate::new(self)\n     }\n \n-    /// Creates an iterator which can use [`peek`] to look at the next element of\n-    /// the iterator without consuming it.\n+    /// Creates an iterator which can use the [`peek`] and [`peek_mut`] methods\n+    /// to look at the next element of the iterator without consuming it. See\n+    /// their documentation for more information.\n     ///\n-    /// Adds a [`peek`] method to an iterator. See its documentation for\n-    /// more information.\n+    /// Note that the underlying iterator is still advanced when [`peek`] or\n+    /// [`peek_mut`] are called for the first time: In order to retrieve the\n+    /// next element, [`next`] is called on the underlying iterator, hence any\n+    /// side effects (i.e.  anything other than fetching the next value) of\n+    /// the [`next`] method will occur.\n     ///\n-    /// Note that the underlying iterator is still advanced when [`peek`] is\n-    /// called for the first time: In order to retrieve the next element,\n-    /// [`next`] is called on the underlying iterator, hence any side effects (i.e.\n-    /// anything other than fetching the next value) of the [`next`] method\n-    /// will occur.\n-    ///\n-    /// [`peek`]: Peekable::peek\n-    /// [`next`]: Iterator::next\n     ///\n     /// # Examples\n     ///\n@@ -976,6 +972,32 @@ pub trait Iterator {\n     /// assert_eq!(iter.peek(), None);\n     /// assert_eq!(iter.next(), None);\n     /// ```\n+    ///\n+    /// Using [`peek_mut`] to mutate the next item without advancing the\n+    /// iterator:\n+    ///\n+    /// ```\n+    /// let xs = [1, 2, 3];\n+    ///\n+    /// let mut iter = xs.iter().peekable();\n+    ///\n+    /// // peek_mut() lets us see into the future\n+    /// assert_eq!(iter.peek_mut(), Some(&mut &1));\n+    /// assert_eq!(iter.peek_mut(), Some(&mut &1));\n+    /// assert_eq!(iter.next(), Some(&1));\n+    ///\n+    /// if let Some(mut p) = iter.peek_mut() {\n+    ///     assert_eq!(*p, &2);\n+    ///     // put a value into the iterator\n+    ///     *p = &1000;\n+    /// }\n+    ///\n+    /// // The value reappears as the iterator continues\n+    /// assert_eq!(iter.collect::<Vec<_>>(), vec![&1000, &3]);\n+    /// ```\n+    /// [`peek`]: Peekable::peek\n+    /// [`peek_mut`]: Peekable::peek_mut\n+    /// [`next`]: Iterator::next\n     #[inline]\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     fn peekable(self) -> Peekable<Self>"}, {"sha": "4d34ade210f4bc72cf815718489a1126783cfc48", "filename": "library/core/tests/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/abcbe5457571eabf4d51c439a78af0485dd0ccb1/library%2Fcore%2Ftests%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/abcbe5457571eabf4d51c439a78af0485dd0ccb1/library%2Fcore%2Ftests%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Ftests%2Flib.rs?ref=abcbe5457571eabf4d51c439a78af0485dd0ccb1", "patch": "@@ -67,7 +67,6 @@\n #![feature(unwrap_infallible)]\n #![feature(option_result_unwrap_unchecked)]\n #![feature(result_into_ok_or_err)]\n-#![feature(peekable_peek_mut)]\n #![cfg_attr(not(bootstrap), feature(ptr_metadata))]\n #![feature(once_cell)]\n #![feature(unsized_tuple_coercion)]"}]}