{"sha": "b17fa8bf012628b00ec156caefbad34b54a87182", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIxN2ZhOGJmMDEyNjI4YjAwZWMxNTZjYWVmYmFkMzRiNTRhODcxODI=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2016-08-28T10:28:38Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2016-08-28T10:28:38Z"}, "message": "Auto merge of #36055 - japaric:rustbuild-no-filecheck, r=alexcrichton\n\nrustbuild: skip filecheck check if codegen tests are disabled\n\nto match the behavior of the old Makefile-based build system\n\ncloses #35752\n\nr? @alexcrichton", "tree": {"sha": "660b3ed1722bc8a1721787be9b9095d047203f64", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/660b3ed1722bc8a1721787be9b9095d047203f64"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b17fa8bf012628b00ec156caefbad34b54a87182", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b17fa8bf012628b00ec156caefbad34b54a87182", "html_url": "https://github.com/rust-lang/rust/commit/b17fa8bf012628b00ec156caefbad34b54a87182", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b17fa8bf012628b00ec156caefbad34b54a87182/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "78a0838756d3df06ba64230600acfbed5ac6d0d7", "url": "https://api.github.com/repos/rust-lang/rust/commits/78a0838756d3df06ba64230600acfbed5ac6d0d7", "html_url": "https://github.com/rust-lang/rust/commit/78a0838756d3df06ba64230600acfbed5ac6d0d7"}, {"sha": "b8ebc1347c0f69c833b4fa908bcc43eb47949efa", "url": "https://api.github.com/repos/rust-lang/rust/commits/b8ebc1347c0f69c833b4fa908bcc43eb47949efa", "html_url": "https://github.com/rust-lang/rust/commit/b8ebc1347c0f69c833b4fa908bcc43eb47949efa"}], "stats": {"total": 11, "additions": 8, "deletions": 3}, "files": [{"sha": "682a6f74126a8278555573a5743a057711cdc9eb", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/b17fa8bf012628b00ec156caefbad34b54a87182/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b17fa8bf012628b00ec156caefbad34b54a87182/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=b17fa8bf012628b00ec156caefbad34b54a87182", "patch": "@@ -78,6 +78,7 @@ pub struct Config {\n     pub channel: String,\n     pub musl_root: Option<PathBuf>,\n     pub prefix: Option<String>,\n+    pub codegen_tests: bool,\n }\n \n /// Per-target configuration stored in the global configuration structure.\n@@ -169,6 +170,7 @@ impl Config {\n         config.rust_codegen_units = 1;\n         config.build = build.to_string();\n         config.channel = \"dev\".to_string();\n+        config.codegen_tests = true;\n \n         let toml = file.map(|file| {\n             let mut f = t!(File::open(&file));\n@@ -322,6 +324,7 @@ impl Config {\n                 (\"DEBUGINFO_TESTS\", self.rust_debuginfo_tests),\n                 (\"LOCAL_REBUILD\", self.local_rebuild),\n                 (\"NINJA\", self.ninja),\n+                (\"CODEGEN_TESTS\", self.codegen_tests),\n             }\n \n             match key {"}, {"sha": "9f0efa8289d48a015f4dbc43d18e0bb261ffb30a", "filename": "src/bootstrap/lib.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b17fa8bf012628b00ec156caefbad34b54a87182/src%2Fbootstrap%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b17fa8bf012628b00ec156caefbad34b54a87182/src%2Fbootstrap%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Flib.rs?ref=b17fa8bf012628b00ec156caefbad34b54a87182", "patch": "@@ -390,8 +390,10 @@ impl Build {\n                                        \"mir-opt\", \"mir-opt\");\n                 }\n                 CheckCodegen { compiler } => {\n-                    check::compiletest(self, &compiler, target.target,\n-                                       \"codegen\", \"codegen\");\n+                    if self.config.codegen_tests {\n+                        check::compiletest(self, &compiler, target.target,\n+                                           \"codegen\", \"codegen\");\n+                    }\n                 }\n                 CheckCodegenUnits { compiler } => {\n                     check::compiletest(self, &compiler, target.target,"}, {"sha": "c0d303c0ea9aeb19fe70e7319bdb78178d52920e", "filename": "src/bootstrap/sanity.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b17fa8bf012628b00ec156caefbad34b54a87182/src%2Fbootstrap%2Fsanity.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b17fa8bf012628b00ec156caefbad34b54a87182/src%2Fbootstrap%2Fsanity.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fsanity.rs?ref=b17fa8bf012628b00ec156caefbad34b54a87182", "patch": "@@ -89,7 +89,7 @@ pub fn check(build: &mut Build) {\n \n     // Externally configured LLVM requires FileCheck to exist\n     let filecheck = build.llvm_filecheck(&build.config.build);\n-    if !filecheck.starts_with(&build.out) && !filecheck.exists() {\n+    if !filecheck.starts_with(&build.out) && !filecheck.exists() && build.config.codegen_tests {\n         panic!(\"filecheck executable {:?} does not exist\", filecheck);\n     }\n "}]}