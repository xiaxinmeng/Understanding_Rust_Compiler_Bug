{"sha": "65aeafa24f1542c23643a67172b7b2fec4f290cc", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY1YWVhZmEyNGYxNTQyYzIzNjQzYTY3MTcyYjdiMmZlYzRmMjkwY2M=", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2017-01-24T19:55:45Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2017-01-24T19:56:02Z"}, "message": "parser: Permit trailing +'s in bound lists", "tree": {"sha": "92464a7e8ce69e08cc98ab7bb211d4ba4cda45a1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/92464a7e8ce69e08cc98ab7bb211d4ba4cda45a1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/65aeafa24f1542c23643a67172b7b2fec4f290cc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/65aeafa24f1542c23643a67172b7b2fec4f290cc", "html_url": "https://github.com/rust-lang/rust/commit/65aeafa24f1542c23643a67172b7b2fec4f290cc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/65aeafa24f1542c23643a67172b7b2fec4f290cc/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "375cb2eec70f239b477c6b88852c8258765b5420", "url": "https://api.github.com/repos/rust-lang/rust/commits/375cb2eec70f239b477c6b88852c8258765b5420", "html_url": "https://github.com/rust-lang/rust/commit/375cb2eec70f239b477c6b88852c8258765b5420"}], "stats": {"total": 72, "additions": 11, "deletions": 61}, "files": [{"sha": "9e3c1dcef8a6e465887520f66098a366f15c29f2", "filename": "src/libsyntax/parse/parser.rs", "status": "modified", "additions": 3, "deletions": 11, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/65aeafa24f1542c23643a67172b7b2fec4f290cc/src%2Flibsyntax%2Fparse%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/65aeafa24f1542c23643a67172b7b2fec4f290cc/src%2Flibsyntax%2Fparse%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Fparser.rs?ref=65aeafa24f1542c23643a67172b7b2fec4f290cc", "patch": "@@ -4003,14 +4003,7 @@ impl<'a> Parser<'a> {\n                 break\n             }}\n \n-            // Trailing plus is not allowed for now and we have to detect it.\n-            let is_bound_start = |token: &token::Token| {\n-                token == &token::Question || token.is_lifetime() ||\n-                token.is_keyword(keywords::For) || token.is_path_start()\n-            };\n-            if self.check(&token::BinOp(token::Plus)) && self.look_ahead(1, is_bound_start) {\n-                self.bump();\n-            } else {\n+            if !self.eat(&token::BinOp(token::Plus)) {\n                 break\n             }\n         }\n@@ -4024,9 +4017,8 @@ impl<'a> Parser<'a> {\n         let mut lifetimes = Vec::new();\n         while let Some(lifetime) = self.eat_lifetime() {\n             lifetimes.push(lifetime);\n-            if self.check(&token::BinOp(token::Plus)) && self.look_ahead(1, |t| t.is_lifetime()) {\n-                self.bump();\n-            } else {\n+\n+            if !self.eat(&token::BinOp(token::Plus)) {\n                 break\n             }\n         }"}, {"sha": "e04431598156c8febff8ac6672e3c31df4746a7e", "filename": "src/test/parse-fail/bounds-lifetime-3.rs", "status": "removed", "additions": 0, "deletions": 15, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/375cb2eec70f239b477c6b88852c8258765b5420/src%2Ftest%2Fparse-fail%2Fbounds-lifetime-3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/375cb2eec70f239b477c6b88852c8258765b5420/src%2Ftest%2Fparse-fail%2Fbounds-lifetime-3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fparse-fail%2Fbounds-lifetime-3.rs?ref=375cb2eec70f239b477c6b88852c8258765b5420", "patch": "@@ -1,15 +0,0 @@\n-// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n-// file at the top-level directory of this distribution and at\n-// http://rust-lang.org/COPYRIGHT.\n-//\n-// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n-// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n-// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n-// option. This file may not be copied, modified, or distributed\n-// except according to those terms.\n-\n-// compile-flags: -Z parse-only\n-\n-type A = for<,> fn(); //~ ERROR expected one of `>`, identifier, or lifetime, found `,`\n-\n-fn main() {}"}, {"sha": "ffcacdf357df5abd00b60d8c1a689f062aea9136", "filename": "src/test/parse-fail/bounds-lifetime-where-2.rs", "status": "removed", "additions": 0, "deletions": 15, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/375cb2eec70f239b477c6b88852c8258765b5420/src%2Ftest%2Fparse-fail%2Fbounds-lifetime-where-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/375cb2eec70f239b477c6b88852c8258765b5420/src%2Ftest%2Fparse-fail%2Fbounds-lifetime-where-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fparse-fail%2Fbounds-lifetime-where-2.rs?ref=375cb2eec70f239b477c6b88852c8258765b5420", "patch": "@@ -1,15 +0,0 @@\n-// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n-// file at the top-level directory of this distribution and at\n-// http://rust-lang.org/COPYRIGHT.\n-//\n-// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n-// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n-// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n-// option. This file may not be copied, modified, or distributed\n-// except according to those terms.\n-\n-// compile-flags: -Z parse-only\n-\n-type A where , = u8; //~ ERROR expected one of `=`, lifetime, or type, found `,`\n-\n-fn main() {}"}, {"sha": "0a30818bc96aed0d5aa6fc3e5b76d0901c6915f4", "filename": "src/test/parse-fail/bounds-lifetime-where.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/65aeafa24f1542c23643a67172b7b2fec4f290cc/src%2Ftest%2Fparse-fail%2Fbounds-lifetime-where.rs", "raw_url": "https://github.com/rust-lang/rust/raw/65aeafa24f1542c23643a67172b7b2fec4f290cc/src%2Ftest%2Fparse-fail%2Fbounds-lifetime-where.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fparse-fail%2Fbounds-lifetime-where.rs?ref=65aeafa24f1542c23643a67172b7b2fec4f290cc", "patch": "@@ -16,6 +16,7 @@ type A where 'a: = u8; // OK\n type A where 'a:, = u8; // OK\n type A where 'a: 'b + 'c = u8; // OK\n type A where = u8; // OK\n-type A where 'a: 'b + = u8; //~ ERROR expected one of `,` or `=`, found `+`\n+type A where 'a: 'b + = u8; // OK\n+type A where , = u8; //~ ERROR expected one of `=`, lifetime, or type, found `,`\n \n fn main() {}"}, {"sha": "5113a6b4803fc058bd492dde93594b74146fe926", "filename": "src/test/parse-fail/bounds-lifetime.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/65aeafa24f1542c23643a67172b7b2fec4f290cc/src%2Ftest%2Fparse-fail%2Fbounds-lifetime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/65aeafa24f1542c23643a67172b7b2fec4f290cc/src%2Ftest%2Fparse-fail%2Fbounds-lifetime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fparse-fail%2Fbounds-lifetime.rs?ref=65aeafa24f1542c23643a67172b7b2fec4f290cc", "patch": "@@ -16,8 +16,9 @@ type A = for<'a:> fn(); // OK\n type A = for<'a:,> fn(); // OK\n type A = for<'a> fn(); // OK\n type A = for<> fn(); // OK\n+type A = for<'a: 'b +> fn(); // OK\n \n type A = for<'a, T> fn(); //~ ERROR only lifetime parameters can be used in this context\n-type A = for<'a: 'b +> fn(); //~ ERROR expected one of `,` or `>`, found `+`\n+type A = for<,> fn(); //~ ERROR expected one of `>`, identifier, or lifetime, found `,`\n \n fn main() {}"}, {"sha": "52b5035abda3ae41f907fd515a2f51bcf2b4ee48", "filename": "src/test/parse-fail/bounds-type-where-1.rs", "status": "removed", "additions": 0, "deletions": 16, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/375cb2eec70f239b477c6b88852c8258765b5420/src%2Ftest%2Fparse-fail%2Fbounds-type-where-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/375cb2eec70f239b477c6b88852c8258765b5420/src%2Ftest%2Fparse-fail%2Fbounds-type-where-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fparse-fail%2Fbounds-type-where-1.rs?ref=375cb2eec70f239b477c6b88852c8258765b5420", "patch": "@@ -1,16 +0,0 @@\n-// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n-// file at the top-level directory of this distribution and at\n-// http://rust-lang.org/COPYRIGHT.\n-//\n-// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n-// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n-// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n-// option. This file may not be copied, modified, or distributed\n-// except according to those terms.\n-\n-// compile-flags: -Z parse-only\n-\n-type A where T, = u8;\n-//~^ ERROR expected one of `!`, `(`, `+`, `::`, `:`, `<`, `==`, or `=`, found `,`\n-\n-fn main() {}"}, {"sha": "9dc5d8277446da21481249c159983e2e0f6648ac", "filename": "src/test/parse-fail/bounds-type-where.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/65aeafa24f1542c23643a67172b7b2fec4f290cc/src%2Ftest%2Fparse-fail%2Fbounds-type-where.rs", "raw_url": "https://github.com/rust-lang/rust/raw/65aeafa24f1542c23643a67172b7b2fec4f290cc/src%2Ftest%2Fparse-fail%2Fbounds-type-where.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fparse-fail%2Fbounds-type-where.rs?ref=65aeafa24f1542c23643a67172b7b2fec4f290cc", "patch": "@@ -16,6 +16,8 @@ type A where T: = u8; // OK\n type A where T:, = u8; // OK\n type A where T: Trait + Trait = u8; // OK\n type A where = u8; // OK\n-type A where T: Trait + = u8; //~ ERROR expected one of `(`, `,`, `::`, `<`, or `=`, found `+`\n+type A where T: Trait + = u8; // OK\n+type A where T, = u8;\n+//~^ ERROR expected one of `!`, `(`, `+`, `::`, `:`, `<`, `==`, or `=`, found `,`\n \n fn main() {}"}, {"sha": "c224b44a14bf1fb7a94812a048fd08cff6dd660a", "filename": "src/test/parse-fail/bounds-type.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/65aeafa24f1542c23643a67172b7b2fec4f290cc/src%2Ftest%2Fparse-fail%2Fbounds-type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/65aeafa24f1542c23643a67172b7b2fec4f290cc/src%2Ftest%2Fparse-fail%2Fbounds-type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fparse-fail%2Fbounds-type.rs?ref=65aeafa24f1542c23643a67172b7b2fec4f290cc", "patch": "@@ -16,8 +16,8 @@ struct S<\n     T: 'a, // OK\n     T:, // OK\n     T: ?for<'a: 'b + 'c> Trait, // OK\n+    T: Tr +, // OK\n     T: ?'a, //~ ERROR `?` may only modify trait bounds, not lifetime bounds\n-    T: Tr +, //~ ERROR expected one of `(`, `,`, `::`, `<`, `=`, or `>`, found `+`\n >;\n \n fn main() {}"}]}