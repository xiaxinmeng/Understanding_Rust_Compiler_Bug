{"sha": "15d71d32852024555ec008c3921fe0cd4e6cb047", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE1ZDcxZDMyODUyMDI0NTU1ZWMwMDhjMzkyMWZlMGNkNGU2Y2IwNDc=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-03-12T21:01:15Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-03-12T21:01:15Z"}, "message": "Rollup merge of #48631 - focusaurus:remember-collapse-setting, r=QuietMisdreavus\n\nRemember state of top-level collapse toggle widget\n\nThis change allows the big top-right expand/collapse toggle to remember its setting across navigation or page reloads. Prior to this change, there was this annoyance:\n\n- browse to some docs\n- Click the minus button to collapse them\n- browse to other docs (or reload the page)\n- Everything is expanded again\n\nThe solution is based on storing a simple boolean flag in localStorage. I think it's a good improvement, but it does introduce the following potentially surprising behavior:\n\n- browse to some docs\n- click the minus button to collapse them\n- click to expand a particular item (not the main top-right big one)\n- reload the page, everything is collapsed\n\nPaired with @debugsteven on this.", "tree": {"sha": "fcec4bdf693ad483135ea85eef0e7c87afbbadcc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fcec4bdf693ad483135ea85eef0e7c87afbbadcc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/15d71d32852024555ec008c3921fe0cd4e6cb047", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlqm6pwACgkQ/vbIBR0O\nATxSjBAAvF0Q6BgwWxffkwvBFTpqQKcfcLR82pgFi4juqsxn/GtzE2cwC8L6ujn2\nHcjMauX5Rv+a/ii6u9FKjjytkjJxRPWUD289xs7/yf9FHzeFg7KYMLg1qTkSNGLP\nXBMtdu5TGMgFAD+d97u18LI/bHs1h8YkdW91Z9fKF143nZR9j03DvtNluMWM/u91\nkZUpMrwC9yRe5h0KPNOajZlUY0Ohv7iq3rhOkXp/SWytiEsx55/zRJWpbcTc4smF\nk147f10BJXXTcJii0fmmZHAvj6CCfPsax+ZIN3nJQECMZMZWfQNMT0BihCpBCugK\n9T4w//U8SDel+B598N1lZFzh01+d6QBaZoAAjhFGEjwU/tzktAUGBQCkmqOAGq4g\nBh5WHUp7GmYyg97Z8gA/CpBtm9/vj7TyDQNyKfy4kzuONQJHMLWsxi7klQcC8Ubk\n4iAcvGkfwNpjV4oKQYgYAPCZI+rVkzy5Yy3cbOu/2rthnyblrSQ53lg6EdlnYSJq\nJjR85BVttgLnyOtihCrGdALU0iFxOhlmdN5acAGisa/G7XPhNum071TnNiJzpN0/\nKDzegMymOUId3xG43XaNbOsO2+YqAavbDgNMTi3u8clVx+jrN9nlvxynJYc4KCsX\nmBknzPeitlDPhx8c3UwQBPEpaDbv5iaB+nxk7IItdPsK0lCQiYU=\n=5c6h\n-----END PGP SIGNATURE-----", "payload": "tree fcec4bdf693ad483135ea85eef0e7c87afbbadcc\nparent 684c6d17c575893b4cd4913f2558cb8731785c01\nparent 2dd81c86c51435ed57d7a2b16f1b66c254a64cc8\nauthor kennytm <kennytm@gmail.com> 1520888475 +0800\ncommitter kennytm <kennytm@gmail.com> 1520888475 +0800\n\nRollup merge of #48631 - focusaurus:remember-collapse-setting, r=QuietMisdreavus\n\nRemember state of top-level collapse toggle widget\n\nThis change allows the big top-right expand/collapse toggle to remember its setting across navigation or page reloads. Prior to this change, there was this annoyance:\n\n- browse to some docs\n- Click the minus button to collapse them\n- browse to other docs (or reload the page)\n- Everything is expanded again\n\nThe solution is based on storing a simple boolean flag in localStorage. I think it's a good improvement, but it does introduce the following potentially surprising behavior:\n\n- browse to some docs\n- click the minus button to collapse them\n- click to expand a particular item (not the main top-right big one)\n- reload the page, everything is collapsed\n\nPaired with @debugsteven on this.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/15d71d32852024555ec008c3921fe0cd4e6cb047", "html_url": "https://github.com/rust-lang/rust/commit/15d71d32852024555ec008c3921fe0cd4e6cb047", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/15d71d32852024555ec008c3921fe0cd4e6cb047/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "684c6d17c575893b4cd4913f2558cb8731785c01", "url": "https://api.github.com/repos/rust-lang/rust/commits/684c6d17c575893b4cd4913f2558cb8731785c01", "html_url": "https://github.com/rust-lang/rust/commit/684c6d17c575893b4cd4913f2558cb8731785c01"}, {"sha": "2dd81c86c51435ed57d7a2b16f1b66c254a64cc8", "url": "https://api.github.com/repos/rust-lang/rust/commits/2dd81c86c51435ed57d7a2b16f1b66c254a64cc8", "html_url": "https://github.com/rust-lang/rust/commit/2dd81c86c51435ed57d7a2b16f1b66c254a64cc8"}], "stats": {"total": 6, "additions": 6, "deletions": 0}, "files": [{"sha": "28d39cb174a108dc0688c79098f0287374a5605b", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/15d71d32852024555ec008c3921fe0cd4e6cb047/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/15d71d32852024555ec008c3921fe0cd4e6cb047/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=15d71d32852024555ec008c3921fe0cd4e6cb047", "patch": "@@ -1628,6 +1628,7 @@\n     function toggleAllDocs() {\n         var toggle = document.getElementById(\"toggle-all-docs\");\n         if (hasClass(toggle, \"will-expand\")) {\n+            updateLocalStorage(\"rustdoc-collapse\", \"false\");\n             removeClass(toggle, \"will-expand\");\n             onEveryMatchingChild(toggle, \"inner\", function(e) {\n                 e.innerHTML = labelForToggleButton(false);\n@@ -1637,6 +1638,7 @@\n                 collapseDocs(e, \"show\");\n             });\n         } else {\n+            updateLocalStorage(\"rustdoc-collapse\", \"true\");\n             addClass(toggle, \"will-expand\");\n             onEveryMatchingChild(toggle, \"inner\", function(e) {\n                 e.innerHTML = labelForToggleButton(true);\n@@ -1988,6 +1990,10 @@\n     window.onresize = function() {\n         hideSidebar();\n     };\n+\n+    if (getCurrentValue(\"rustdoc-collapse\") === \"true\") {\n+        toggleAllDocs();\n+    }\n }());\n \n // Sets the focus on the search bar at the top of the page"}]}