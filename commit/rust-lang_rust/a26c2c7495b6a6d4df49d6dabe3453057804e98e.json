{"sha": "a26c2c7495b6a6d4df49d6dabe3453057804e98e", "node_id": "C_kwDOAAsO6NoAKGEyNmMyYzc0OTViNmE2ZDRkZjQ5ZDZkYWJlMzQ1MzA1NzgwNGU5OGU", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2021-11-23T18:28:10Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-11-23T18:28:10Z"}, "message": "Rollup merge of #91140 - nbdd0121:const_typeck, r=oli-obk\n\nSplit inline const to two feature gates and mark expression position inline const complete\n\nThis PR splits inline const in pattern position into its own `#![feature(inline_const_pat)]` feature gate, and make the usage in expression position complete.\n\nI think I have resolved most outstanding issues related to `inline_const` with #89561 and other PRs. The only thing left that I am aware of is #90150 and the lack of lifetime checks when inline const is used in pattern position (FIXME in #89561). Implementation-wise when used in pattern position it has to be lowered during MIR building while in expression position it's evaluated only when monomorphizing (just like normal consts), so it makes some sense to separate it into two feature gates so one can progress without being blocked by another.\n\n``@rustbot`` label: T-compiler F-inline_const", "tree": {"sha": "69b568250bf8a7df78247950b7a99483c3044a31", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/69b568250bf8a7df78247950b7a99483c3044a31"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a26c2c7495b6a6d4df49d6dabe3453057804e98e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhnTK7CRBK7hj4Ov3rIwAAXyAIAHaDD2+t2/H+Fq36jrp3JqC4\nxo7JgwO16KUb0k+lRyyUKTuqLkFBNUCFiFXQ9sZ7tk2dBG23Fk00P+FUeivclQpI\nRm8NOyk91tC7RiVeQte++xbUvZOWbDZDcJwM6U0Zr0DCb67mrvqvbewjHD70ZCHt\n73VqLRTMlWsCgFAPujVngO2MuFBvvKvO+MLtZCMXptlgOYxuzSFwvZS+8vY+bHmw\nR4oyW9sdrAc26k8egUrcVVSENJzzV4zrQbVK4XswvwbInMPChr8f6ucgPvIKMBts\nuCO09MeU6OXmPZ66vN0ISZjYtxDB2eMLltLkV8s0bMPFh0S5VsZwB7iysHasqcg=\n=Wf78\n-----END PGP SIGNATURE-----\n", "payload": "tree 69b568250bf8a7df78247950b7a99483c3044a31\nparent 448422471020d80a2fe6f9732d16ca19c93a12c4\nparent 6f38568decbab94e06e1df740b8b7a140be88e54\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1637692090 +0100\ncommitter GitHub <noreply@github.com> 1637692090 +0100\n\nRollup merge of #91140 - nbdd0121:const_typeck, r=oli-obk\n\nSplit inline const to two feature gates and mark expression position inline const complete\n\nThis PR splits inline const in pattern position into its own `#![feature(inline_const_pat)]` feature gate, and make the usage in expression position complete.\n\nI think I have resolved most outstanding issues related to `inline_const` with #89561 and other PRs. The only thing left that I am aware of is #90150 and the lack of lifetime checks when inline const is used in pattern position (FIXME in #89561). Implementation-wise when used in pattern position it has to be lowered during MIR building while in expression position it's evaluated only when monomorphizing (just like normal consts), so it makes some sense to separate it into two feature gates so one can progress without being blocked by another.\n\n``@rustbot`` label: T-compiler F-inline_const\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a26c2c7495b6a6d4df49d6dabe3453057804e98e", "html_url": "https://github.com/rust-lang/rust/commit/a26c2c7495b6a6d4df49d6dabe3453057804e98e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a26c2c7495b6a6d4df49d6dabe3453057804e98e/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "448422471020d80a2fe6f9732d16ca19c93a12c4", "url": "https://api.github.com/repos/rust-lang/rust/commits/448422471020d80a2fe6f9732d16ca19c93a12c4", "html_url": "https://github.com/rust-lang/rust/commit/448422471020d80a2fe6f9732d16ca19c93a12c4"}, {"sha": "6f38568decbab94e06e1df740b8b7a140be88e54", "url": "https://api.github.com/repos/rust-lang/rust/commits/6f38568decbab94e06e1df740b8b7a140be88e54", "html_url": "https://github.com/rust-lang/rust/commit/6f38568decbab94e06e1df740b8b7a140be88e54"}], "stats": {"total": 115, "additions": 72, "deletions": 43}, "files": [{"sha": "6a19984f8ea4612e82289b7c95d09839ca65a4e4", "filename": "compiler/rustc_ast_passes/src/feature_gate.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/compiler%2Frustc_ast_passes%2Fsrc%2Ffeature_gate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/compiler%2Frustc_ast_passes%2Fsrc%2Ffeature_gate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_passes%2Fsrc%2Ffeature_gate.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -719,6 +719,7 @@ pub fn check_crate(krate: &ast::Crate, sess: &Session) {\n     gate_all!(const_trait_impl, \"const trait impls are experimental\");\n     gate_all!(half_open_range_patterns, \"half-open range patterns are unstable\");\n     gate_all!(inline_const, \"inline-const is experimental\");\n+    gate_all!(inline_const_pat, \"inline-const in pattern position is experimental\");\n     gate_all!(\n         const_generics_defaults,\n         \"default values for const generic parameters are experimental\""}, {"sha": "c34ecc966d0ae21989ab921b6502f9bb3615ecc2", "filename": "compiler/rustc_feature/src/active.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/compiler%2Frustc_feature%2Fsrc%2Factive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/compiler%2Frustc_feature%2Fsrc%2Factive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Factive.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -409,7 +409,9 @@ declare_features! (\n     /// Allows associated types in inherent impls.\n     (incomplete, inherent_associated_types, \"1.52.0\", Some(8995), None),\n     /// Allow anonymous constants from an inline `const` block\n-    (incomplete, inline_const, \"1.49.0\", Some(76001), None),\n+    (active, inline_const, \"1.49.0\", Some(76001), None),\n+    /// Allow anonymous constants from an inline `const` block in pattern position\n+    (incomplete, inline_const_pat, \"1.58.0\", Some(76001), None),\n     /// Allows using `pointer` and `reference` in intra-doc links\n     (active, intra_doc_pointers, \"1.51.0\", Some(80896), None),\n     /// Allows `#[instruction_set(_)]` attribute"}, {"sha": "3669a4fce9cbf9ba0048156ca6e697cd93d07ebb", "filename": "compiler/rustc_parse/src/parser/expr.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fexpr.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1243,7 +1243,7 @@ impl<'a> Parser<'a> {\n         } else if self.eat_keyword(kw::Unsafe) {\n             self.parse_block_expr(None, lo, BlockCheckMode::Unsafe(ast::UserProvided), attrs)\n         } else if self.check_inline_const(0) {\n-            self.parse_const_block(lo.to(self.token.span))\n+            self.parse_const_block(lo.to(self.token.span), false)\n         } else if self.is_do_catch_block() {\n             self.recover_do_catch(attrs)\n         } else if self.is_try_block() {"}, {"sha": "9212aaa87d1947fdce1deecfb60ac460b662485b", "filename": "compiler/rustc_parse/src/parser/mod.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1095,8 +1095,12 @@ impl<'a> Parser<'a> {\n     }\n \n     /// Parses inline const expressions.\n-    fn parse_const_block(&mut self, span: Span) -> PResult<'a, P<Expr>> {\n-        self.sess.gated_spans.gate(sym::inline_const, span);\n+    fn parse_const_block(&mut self, span: Span, pat: bool) -> PResult<'a, P<Expr>> {\n+        if pat {\n+            self.sess.gated_spans.gate(sym::inline_const_pat, span);\n+        } else {\n+            self.sess.gated_spans.gate(sym::inline_const, span);\n+        }\n         self.eat_keyword(kw::Const);\n         let blk = self.parse_block()?;\n         let anon_const = AnonConst {"}, {"sha": "bb3947bb47a2550bd5e82d3a633fd7c006bcbf28", "filename": "compiler/rustc_parse/src/parser/pat.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fpat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fpat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fpat.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -437,7 +437,7 @@ impl<'a> Parser<'a> {\n             PatKind::Box(pat)\n         } else if self.check_inline_const(0) {\n             // Parse `const pat`\n-            let const_expr = self.parse_const_block(lo.to(self.token.span))?;\n+            let const_expr = self.parse_const_block(lo.to(self.token.span), true)?;\n \n             if let Some(re) = self.parse_range_end() {\n                 self.parse_pat_range_begin_with(const_expr, re)?\n@@ -884,7 +884,7 @@ impl<'a> Parser<'a> {\n \n     fn parse_pat_range_end(&mut self) -> PResult<'a, P<Expr>> {\n         if self.check_inline_const(0) {\n-            self.parse_const_block(self.token.span)\n+            self.parse_const_block(self.token.span, true)\n         } else if self.check_path() {\n             let lo = self.token.span;\n             let (qself, path) = if self.eat_lt() {"}, {"sha": "c34cf822765f73615e32d650a0c12db821c3aa4b", "filename": "compiler/rustc_span/src/symbol.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -732,6 +732,7 @@ symbols! {\n         inlateout,\n         inline,\n         inline_const,\n+        inline_const_pat,\n         inout,\n         instruction_set,\n         intel,"}, {"sha": "5f0f7547a0a894ec14166ec7d29e4c96b2eba9f3", "filename": "src/doc/unstable-book/src/language-features/inline-const-pat.md", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Finline-const-pat.md", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Finline-const-pat.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Finline-const-pat.md?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -0,0 +1,24 @@\n+# `inline_const_pat`\n+\n+The tracking issue for this feature is: [#76001]\n+\n+See also [`inline_const`](inline-const.md)\n+\n+------\n+\n+This feature allows you to use inline constant expressions in pattern position:\n+\n+```rust\n+#![feature(inline_const_pat)]\n+\n+const fn one() -> i32 { 1 }\n+\n+let some_int = 3;\n+match some_int {\n+    const { 1 + 2 } => println!(\"Matched 1 + 2\"),\n+    const { one() } => println!(\"Matched const fn returning 1\"),\n+    _ => println!(\"Didn't match anything :(\"),\n+}\n+```\n+\n+[#76001]: https://github.com/rust-lang/rust/issues/76001"}, {"sha": "7be70eed6cedc534144e360fe86db86693011d0d", "filename": "src/doc/unstable-book/src/language-features/inline-const.md", "status": "modified", "additions": 2, "deletions": 15, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Finline-const.md", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Finline-const.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Finline-const.md?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -2,6 +2,8 @@\n \n The tracking issue for this feature is: [#76001]\n \n+See also [`inline_const_pat`](inline-const-pat.md)\n+\n ------\n \n This feature allows you to use inline constant expressions. For example, you can\n@@ -27,19 +29,4 @@ fn main() {\n }\n ```\n \n-You can also use inline constant expressions in patterns:\n-\n-```rust\n-#![feature(inline_const)]\n-\n-const fn one() -> i32 { 1 }\n-\n-let some_int = 3;\n-match some_int {\n-    const { 1 + 2 } => println!(\"Matched 1 + 2\"),\n-    const { one() } => println!(\"Matched const fn returning 1\"),\n-    _ => println!(\"Didn't match anything :(\"),\n-}\n-```\n-\n [#76001]: https://github.com/rust-lang/rust/issues/76001"}, {"sha": "1952ddb941e511db20bccf3446e0cb08de658154", "filename": "src/test/ui/consts/closure-structural-match-issue-90013.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Fconsts%2Fclosure-structural-match-issue-90013.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Fconsts%2Fclosure-structural-match-issue-90013.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fclosure-structural-match-issue-90013.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1,6 +1,5 @@\n // Regression test for issue 90013.\n // check-pass\n-#![allow(incomplete_features)]\n #![feature(inline_const)]\n \n fn main() {"}, {"sha": "20496f62712c284055bd034e9380ebd2e09c1c24", "filename": "src/test/ui/consts/const-blocks/fn-call-in-const.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Fconsts%2Fconst-blocks%2Ffn-call-in-const.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Fconsts%2Fconst-blocks%2Ffn-call-in-const.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-blocks%2Ffn-call-in-const.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1,7 +1,7 @@\n // run-pass\n \n #![feature(inline_const)]\n-#![allow(unused, incomplete_features)]\n+#![allow(unused)]\n \n // Some type that is not copyable.\n struct Bar;"}, {"sha": "3d0df289fb74a2ca71b0fe4e40ceae082a016e07", "filename": "src/test/ui/feature-gates/feature-gate-inline_const_pat.rs", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-inline_const_pat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-inline_const_pat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-inline_const_pat.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -0,0 +1,4 @@\n+fn main() {\n+    let const { () } = ();\n+    //~^ ERROR inline-const in pattern position is experimental [E0658]\n+}"}, {"sha": "ca533d8505cf793084e9a0da57f42a73256afbb2", "filename": "src/test/ui/feature-gates/feature-gate-inline_const_pat.stderr", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-inline_const_pat.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-inline_const_pat.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-inline_const_pat.stderr?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -0,0 +1,12 @@\n+error[E0658]: inline-const in pattern position is experimental\n+  --> $DIR/feature-gate-inline_const_pat.rs:2:9\n+   |\n+LL |     let const { () } = ();\n+   |         ^^^^^\n+   |\n+   = note: see issue #76001 <https://github.com/rust-lang/rust/issues/76001> for more information\n+   = help: add `#![feature(inline_const_pat)]` to the crate attributes to enable\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0658`."}, {"sha": "8f745e8104f811b3a2f4823d6ec7a60591352700", "filename": "src/test/ui/half-open-range-patterns/range_pat_interactions0.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Fhalf-open-range-patterns%2Frange_pat_interactions0.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Fhalf-open-range-patterns%2Frange_pat_interactions0.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fhalf-open-range-patterns%2Frange_pat_interactions0.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -2,7 +2,7 @@\n #![allow(incomplete_features)]\n #![feature(exclusive_range_pattern)]\n #![feature(half_open_range_patterns)]\n-#![feature(inline_const)]\n+#![feature(inline_const_pat)]\n \n fn main() {\n     let mut if_lettable = vec![];"}, {"sha": "41c7e46dfc1ed2fdf6f12b830ab9d4c8f966cd0f", "filename": "src/test/ui/half-open-range-patterns/range_pat_interactions3.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Fhalf-open-range-patterns%2Frange_pat_interactions3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Fhalf-open-range-patterns%2Frange_pat_interactions3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fhalf-open-range-patterns%2Frange_pat_interactions3.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -12,7 +12,7 @@ fn main() {\n             y @ (0..5 | 6) => or_two.push(y),\n             //~^ exclusive range pattern syntax is experimental\n             y @ 0..const { 5 + 1 } => assert_eq!(y, 5),\n-            //~^ inline-const is experimental\n+            //~^ inline-const in pattern position is experimental\n             //~| exclusive range pattern syntax is experimental\n             y @ -5.. => range_from.push(y),\n             y @ ..-7 => assert_eq!(y, -8),"}, {"sha": "5e36996a462b283968818c4c197801aa74cffb2f", "filename": "src/test/ui/half-open-range-patterns/range_pat_interactions3.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Fhalf-open-range-patterns%2Frange_pat_interactions3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Fhalf-open-range-patterns%2Frange_pat_interactions3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fhalf-open-range-patterns%2Frange_pat_interactions3.stderr?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -7,14 +7,14 @@ LL |             y @ ..-7 => assert_eq!(y, -8),\n    = note: see issue #67264 <https://github.com/rust-lang/rust/issues/67264> for more information\n    = help: add `#![feature(half_open_range_patterns)]` to the crate attributes to enable\n \n-error[E0658]: inline-const is experimental\n+error[E0658]: inline-const in pattern position is experimental\n   --> $DIR/range_pat_interactions3.rs:14:20\n    |\n LL |             y @ 0..const { 5 + 1 } => assert_eq!(y, 5),\n    |                    ^^^^^\n    |\n    = note: see issue #76001 <https://github.com/rust-lang/rust/issues/76001> for more information\n-   = help: add `#![feature(inline_const)]` to the crate attributes to enable\n+   = help: add `#![feature(inline_const_pat)]` to the crate attributes to enable\n \n error[E0658]: exclusive range pattern syntax is experimental\n   --> $DIR/range_pat_interactions3.rs:10:17"}, {"sha": "8a92cdbc0f9811975808fa07199033501016a27c", "filename": "src/test/ui/inline-const/const-expr-array-init.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-array-init.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-array-init.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-array-init.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1,6 +1,5 @@\n // build-pass\n \n-#![allow(incomplete_features)]\n #![feature(inline_const)]\n \n use std::cell::Cell;"}, {"sha": "dac46fe25ecfc84e266480dc2c96fd922915b6b7", "filename": "src/test/ui/inline-const/const-expr-basic.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-basic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-basic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-basic.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1,7 +1,7 @@\n // run-pass\n \n-#![allow(incomplete_features)]\n #![feature(inline_const)]\n+\n fn foo() -> i32 {\n     const {\n         let x = 5 + 10;"}, {"sha": "0d5892a74d9565dc4d09bfcdf37797b64897d6a3", "filename": "src/test/ui/inline-const/const-expr-inference.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-inference.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-inference.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-inference.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1,7 +1,6 @@\n // check-pass\n \n #![feature(inline_const)]\n-#![allow(incomplete_features)]\n \n pub fn todo<T>() -> T {\n     const { todo!() }"}, {"sha": "0a032a7338ad065e24e4ea113f01de4e9fc5f338", "filename": "src/test/ui/inline-const/const-expr-lifetime-err.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-lifetime-err.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-lifetime-err.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-lifetime-err.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1,4 +1,3 @@\n-#![allow(incomplete_features)]\n #![feature(const_mut_refs)]\n #![feature(inline_const)]\n "}, {"sha": "a23f7c9a796c53b1a74726d14c1efccdcadb12f0", "filename": "src/test/ui/inline-const/const-expr-lifetime-err.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-lifetime-err.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-lifetime-err.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-lifetime-err.stderr?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1,5 +1,5 @@\n error[E0597]: `y` does not live long enough\n-  --> $DIR/const-expr-lifetime-err.rs:24:30\n+  --> $DIR/const-expr-lifetime-err.rs:23:30\n    |\n LL | fn foo<'a>() {\n    |        -- lifetime `'a` defined here"}, {"sha": "d883deb2845d35993011adb50cf085359ba93c47", "filename": "src/test/ui/inline-const/const-expr-lifetime.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-lifetime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-lifetime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-lifetime.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1,6 +1,5 @@\n // run-pass\n \n-#![allow(incomplete_features)]\n #![feature(const_mut_refs)]\n #![feature(inline_const)]\n "}, {"sha": "041f3e15a29b9822564052c20305a84cd656fcf8", "filename": "src/test/ui/inline-const/const-expr-macro.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-macro.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-macro.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-macro.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1,7 +1,7 @@\n // run-pass\n \n-#![allow(incomplete_features)]\n #![feature(inline_const)]\n+\n macro_rules! do_const_block{\n     ($val:block) => { const $val }\n }"}, {"sha": "a54d879f69d748134340cda1d6506f2072ed6848", "filename": "src/test/ui/inline-const/const-expr-reference.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-reference.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-reference.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finline-const%2Fconst-expr-reference.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1,6 +1,5 @@\n // run-pass\n \n-#![allow(incomplete_features)]\n #![feature(inline_const)]\n \n const fn bar() -> i32 {"}, {"sha": "4486411698af964d0adae9b8ba5e3b098f56d841", "filename": "src/test/ui/inline-const/const-match-pat-generic.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat-generic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat-generic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat-generic.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1,5 +1,5 @@\n #![allow(incomplete_features)]\n-#![feature(inline_const)]\n+#![feature(inline_const_pat)]\n \n // rust-lang/rust#82518: ICE with inline-const in match referencing const-generic parameter\n "}, {"sha": "d83ae6e983486fe3bd21018fc8f2679f4999faeb", "filename": "src/test/ui/inline-const/const-match-pat-inference.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat-inference.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat-inference.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat-inference.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1,6 +1,6 @@\n // check-pass\n \n-#![feature(inline_const)]\n+#![feature(inline_const_pat)]\n #![allow(incomplete_features)]\n \n fn main() {"}, {"sha": "436b8037f3093a586de0d1d8ea0ff5f034a4c29b", "filename": "src/test/ui/inline-const/const-match-pat-lifetime-err.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat-lifetime-err.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat-lifetime-err.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat-lifetime-err.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -2,7 +2,7 @@\n \n #![allow(incomplete_features)]\n #![feature(const_mut_refs)]\n-#![feature(inline_const)]\n+#![feature(inline_const_pat)]\n \n use std::marker::PhantomData;\n "}, {"sha": "6d943bbcc0160f2ce184413ae0158b9353d68413", "filename": "src/test/ui/inline-const/const-match-pat-lifetime.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat-lifetime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat-lifetime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat-lifetime.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -3,6 +3,7 @@\n #![allow(incomplete_features)]\n #![feature(const_mut_refs)]\n #![feature(inline_const)]\n+#![feature(inline_const_pat)]\n \n use std::marker::PhantomData;\n "}, {"sha": "7dc8c11355ab035990bd63a1cba36920dc74f774", "filename": "src/test/ui/inline-const/const-match-pat-range.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat-range.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat-range.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat-range.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1,7 +1,7 @@\n // build-pass\n \n #![allow(incomplete_features)]\n-#![feature(inline_const, half_open_range_patterns, exclusive_range_pattern)]\n+#![feature(inline_const_pat, half_open_range_patterns, exclusive_range_pattern)]\n fn main() {\n     const N: u32 = 10;\n     let x: u32 = 3;"}, {"sha": "2f55e16b35cd934617108ed762dd94b86bc67cd5", "filename": "src/test/ui/inline-const/const-match-pat.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finline-const%2Fconst-match-pat.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1,7 +1,7 @@\n // run-pass\n \n #![allow(incomplete_features)]\n-#![feature(inline_const)]\n+#![feature(inline_const_pat)]\n const MMIO_BIT1: u8 = 4;\n const MMIO_BIT2: u8 = 5;\n "}, {"sha": "d3e39c0de69c85db3a6bfff5bad18ff1526ed826", "filename": "src/test/ui/lint/dead-code/anon-const-in-pat.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Flint%2Fdead-code%2Fanon-const-in-pat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Flint%2Fdead-code%2Fanon-const-in-pat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fdead-code%2Fanon-const-in-pat.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -1,5 +1,5 @@\n // check-pass\n-#![feature(inline_const)]\n+#![feature(inline_const_pat)]\n #![allow(incomplete_features)]\n #![deny(dead_code)]\n "}, {"sha": "5c33154736650b04f59982bbedd104f99bf75c2c", "filename": "src/test/ui/pattern/non-structural-match-types.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Fpattern%2Fnon-structural-match-types.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Fpattern%2Fnon-structural-match-types.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpattern%2Fnon-structural-match-types.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -2,7 +2,7 @@\n #![allow(incomplete_features)]\n #![allow(unreachable_code)]\n #![feature(const_async_blocks)]\n-#![feature(inline_const)]\n+#![feature(inline_const_pat)]\n \n fn main() {\n     match loop {} {"}, {"sha": "3c913c0adfa6000cd801e41b02cd305655a3aae0", "filename": "src/test/ui/simd/intrinsic/generic-elements-pass.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Fsimd%2Fintrinsic%2Fgeneric-elements-pass.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a26c2c7495b6a6d4df49d6dabe3453057804e98e/src%2Ftest%2Fui%2Fsimd%2Fintrinsic%2Fgeneric-elements-pass.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsimd%2Fintrinsic%2Fgeneric-elements-pass.rs?ref=a26c2c7495b6a6d4df49d6dabe3453057804e98e", "patch": "@@ -2,7 +2,6 @@\n // ignore-emscripten FIXME(#45351) hits an LLVM assert\n \n #![feature(repr_simd, platform_intrinsics)]\n-#![allow(incomplete_features)]\n #![feature(inline_const)]\n \n #[repr(simd)]"}]}