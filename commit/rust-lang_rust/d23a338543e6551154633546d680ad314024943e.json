{"sha": "d23a338543e6551154633546d680ad314024943e", "node_id": "C_kwDOAAsO6NoAKGQyM2EzMzg1NDNlNjU1MTE1NDYzMzU0NmQ2ODBhZDMxNDAyNDk0M2U", "commit": {"author": {"name": "flip1995", "email": "philipp.krones@embecosm.com", "date": "2021-11-03T17:37:04Z"}, "committer": {"name": "flip1995", "email": "philipp.krones@embecosm.com", "date": "2021-11-03T17:37:04Z"}, "message": "Format backport to pass CI", "tree": {"sha": "0dd893b960d39b60f594e7cb1abc49bf0601cc8c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0dd893b960d39b60f594e7cb1abc49bf0601cc8c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d23a338543e6551154633546d680ad314024943e", "comment_count": 0, "verification": {"verified": false, "reason": "bad_email", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEij1UXJ/PQTcb99vTHKDfKvWdaKUFAmGCyMUACgkQHKDfKvWd\naKWKhw//bItXddnxH63k+xUVGiC8ssYSnHQS2w+sksyUznRfLvanYQMrCP/4OrHM\nJcDO8lWwONVDSDd3lThH/KCOY4mKbaW/0R9Z+rtXgtZ+RTxiZz0IOLG+a7XNCtDF\nMrab79i/gk4QWDjoDBrCtUPxFYmV554MH2PKf2q6x0/WPSZsbg0PWDHYWqeQNzYc\nt/IN4jIdH2TCeRL6azlsyWn/S/tB3wjZUd0At/oX4pzu3arXFaYueTR7lQjqZNys\nrefBWGIYdtXdRexkeRjZGJ48KnyYywr0Yw/zmk+7kIdyizm8MXuYFeJSdnh92/JG\n88bHXZytlCydzEF4ReVXBjct49oYwrs8HQCXodZXa9dmAxvgkIhDMawj0GS7VJ91\nRpFtRW09mEo6GObXcY48RsmZr+RHdfuZIQqbxzBRnXoL6yAYatQq5n4m63LpXSr1\nWcP47ubZxxQwQpNC22FeMtEpYDFTYBhjAPsX8hqqWSE8KZJBojUqLgZOg4KV90T+\nN9alVgAnKybAmnfvEyczpFHMiz1oVNEctgDJN7r+tV56GpyLczw76xAydr907E/e\nZtfTMxoLPbtGqeRZwq8dWAppa9eAU+bctQ6/SYLcJ0GzOC5jyq868kik6/yKhBdZ\niY77jlhWaHY+XmKTUZhMKZoZKuCIlCCaOpa2CxsVtoi4P9Lmi0s=\n=Wheq\n-----END PGP SIGNATURE-----", "payload": "tree 0dd893b960d39b60f594e7cb1abc49bf0601cc8c\nparent e1225bf9a231ba69f491d0f40e119496d5433d0d\nauthor flip1995 <philipp.krones@embecosm.com> 1635961024 +0000\ncommitter flip1995 <philipp.krones@embecosm.com> 1635961024 +0000\n\nFormat backport to pass CI\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d23a338543e6551154633546d680ad314024943e", "html_url": "https://github.com/rust-lang/rust/commit/d23a338543e6551154633546d680ad314024943e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d23a338543e6551154633546d680ad314024943e/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e1225bf9a231ba69f491d0f40e119496d5433d0d", "url": "https://api.github.com/repos/rust-lang/rust/commits/e1225bf9a231ba69f491d0f40e119496d5433d0d", "html_url": "https://github.com/rust-lang/rust/commit/e1225bf9a231ba69f491d0f40e119496d5433d0d"}], "stats": {"total": 95, "additions": 54, "deletions": 41}, "files": [{"sha": "ce59311c4aa96acac5154ce00f02e3d0a746fa99", "filename": "clippy_lints/src/dereference.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fdereference.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fdereference.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fdereference.rs?ref=d23a338543e6551154633546d680ad314024943e", "patch": "@@ -126,7 +126,7 @@ impl<'tcx> LateLintPass<'tcx> for Dereferencing {\n                                 target_mut,\n                             },\n                         ));\n-                    }\n+                    },\n                     _ => (),\n                 }\n             },"}, {"sha": "57fd24bd4f04d81ca9263a905b84b258a100ae59", "filename": "clippy_lints/src/entry.rs", "status": "modified", "additions": 8, "deletions": 5, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fentry.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fentry.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fentry.rs?ref=d23a338543e6551154633546d680ad314024943e", "patch": "@@ -245,11 +245,14 @@ fn try_parse_contains(cx: &LateContext<'_>, expr: &'tcx Expr<'_>) -> Option<(Map\n         ExprKind::MethodCall(\n             _,\n             _,\n-            [map, Expr {\n-                kind: ExprKind::AddrOf(_, _, key),\n-                span: key_span,\n-                ..\n-            }],\n+            [\n+                map,\n+                Expr {\n+                    kind: ExprKind::AddrOf(_, _, key),\n+                    span: key_span,\n+                    ..\n+                },\n+            ],\n             _,\n         ) if key_span.ctxt() == expr.span.ctxt() => {\n             let id = cx.typeck_results().type_dependent_def_id(expr.hir_id)?;"}, {"sha": "9247343b52a5322f8c7ee09eec77de8b655ffcff", "filename": "clippy_lints/src/eta_reduction.rs", "status": "modified", "additions": 10, "deletions": 7, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Feta_reduction.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Feta_reduction.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Feta_reduction.rs?ref=d23a338543e6551154633546d680ad314024943e", "patch": "@@ -169,13 +169,16 @@ fn check_inputs(cx: &LateContext<'_>, params: &[Param<'_>], call_args: &[Expr<'_\n         }\n         match *cx.typeck_results().expr_adjustments(arg) {\n             [] => true,\n-            [Adjustment {\n-                kind: Adjust::Deref(None),\n-                ..\n-            }, Adjustment {\n-                kind: Adjust::Borrow(AutoBorrow::Ref(_, mu2)),\n-                ..\n-            }] => {\n+            [\n+                Adjustment {\n+                    kind: Adjust::Deref(None),\n+                    ..\n+                },\n+                Adjustment {\n+                    kind: Adjust::Borrow(AutoBorrow::Ref(_, mu2)),\n+                    ..\n+                },\n+            ] => {\n                 // re-borrow with the same mutability is allowed\n                 let ty = cx.typeck_results().expr_ty(arg);\n                 matches!(*ty.kind(), ty::Ref(.., mu1) if mu1 == mu2.into())"}, {"sha": "6850e0c34767cb0864a002b5ce498c3cc157c5a8", "filename": "clippy_lints/src/int_plus_one.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fint_plus_one.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fint_plus_one.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fint_plus_one.rs?ref=d23a338543e6551154633546d680ad314024943e", "patch": "@@ -89,7 +89,7 @@ impl IntPlusOne {\n                     },\n                     _ => None,\n                 }\n-            }\n+            },\n             // case where `x + 1 <= ...` or `1 + x <= ...`\n             (BinOpKind::Le, &ExprKind::Binary(ref lhskind, ref lhslhs, ref lhsrhs), _)\n                 if lhskind.node == BinOpKind::Add =>\n@@ -104,7 +104,7 @@ impl IntPlusOne {\n                     },\n                     _ => None,\n                 }\n-            }\n+            },\n             // case where `... >= y - 1` or `... >= -1 + y`\n             (BinOpKind::Le, _, &ExprKind::Binary(ref rhskind, ref rhslhs, ref rhsrhs)) => {\n                 match (rhskind.node, &rhslhs.kind, &rhsrhs.kind) {"}, {"sha": "f9f515cc40a0fbdd120af9de1358d4e92ba66ce7", "filename": "clippy_lints/src/loops/utils.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Floops%2Futils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Floops%2Futils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Floops%2Futils.rs?ref=d23a338543e6551154633546d680ad314024943e", "patch": "@@ -338,7 +338,7 @@ pub(super) fn make_iterator_snippet(cx: &LateContext<'_>, arg: &Expr<'_>, applic\n                     sugg::Sugg::hir_with_applicability(cx, arg_inner, \"_\", applic_ref).maybe_par(),\n                     meth_name,\n                 )\n-            }\n+            },\n             _ => format!(\n                 \"{}.into_iter()\",\n                 sugg::Sugg::hir_with_applicability(cx, arg, \"_\", applic_ref).maybe_par()"}, {"sha": "b4dacb2580c313fbc366aae7b251facfbdda215e", "filename": "clippy_lints/src/methods/clone_on_copy.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fmethods%2Fclone_on_copy.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fmethods%2Fclone_on_copy.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods%2Fclone_on_copy.rs?ref=d23a338543e6551154633546d680ad314024943e", "patch": "@@ -85,7 +85,7 @@ pub(super) fn check(cx: &LateContext<'_>, expr: &Expr<'_>, method_name: Symbol,\n                     if expr.hir_id == self_arg.hir_id && ty != cx.typeck_results().expr_ty_adjusted(expr) =>\n                 {\n                     return;\n-                }\n+                },\n                 ExprKind::MethodCall(_, _, [self_arg, ..], _) if expr.hir_id == self_arg.hir_id => true,\n                 ExprKind::Match(_, _, MatchSource::TryDesugar | MatchSource::AwaitDesugar)\n                 | ExprKind::Field(..)\n@@ -100,7 +100,7 @@ pub(super) fn check(cx: &LateContext<'_>, expr: &Expr<'_>, method_name: Symbol,\n                 ) =>\n             {\n                 return;\n-            }\n+            },\n             _ => false,\n         };\n "}, {"sha": "fe9ffde0d337c1f15506e73bdca1e0f373c88da5", "filename": "clippy_lints/src/methods/or_fun_call.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fmethods%2For_fun_call.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fmethods%2For_fun_call.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods%2For_fun_call.rs?ref=d23a338543e6551154633546d680ad314024943e", "patch": "@@ -186,7 +186,7 @@ pub(super) fn check<'tcx>(\n                         check_general_case(cx, name, method_span, &args[0], &args[1], expr.span, None);\n                     }\n                 }\n-            }\n+            },\n             _ => (),\n         }\n     }"}, {"sha": "d41b54745649958de717e61f6d395bfbce0e62e5", "filename": "clippy_lints/src/module_style.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fmodule_style.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fmodule_style.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmodule_style.rs?ref=d23a338543e6551154633546d680ad314024943e", "patch": "@@ -106,7 +106,7 @@ impl EarlyLintPass for ModStyle {\n                     }\n                     process_paths_for_mod_files(path, &mut folder_segments, &mut mod_folders);\n                     check_self_named_mod_exists(cx, path, file);\n-                }\n+                },\n                 _ => {},\n             }\n         }"}, {"sha": "f1be90c44f98b998901e0f4b2462722466c99d69", "filename": "clippy_lints/src/needless_borrow.rs", "status": "modified", "additions": 12, "deletions": 8, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fneedless_borrow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fneedless_borrow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fneedless_borrow.rs?ref=d23a338543e6551154633546d680ad314024943e", "patch": "@@ -107,14 +107,18 @@ impl<'tcx> LateLintPass<'tcx> for NeedlessBorrow {\n         if let ExprKind::AddrOf(BorrowKind::Ref, mutability, inner) = e.kind {\n             if let ty::Ref(_, ty, _) = cx.typeck_results().expr_ty(inner).kind() {\n                 for adj3 in cx.typeck_results().expr_adjustments(e).windows(3) {\n-                    if let [Adjustment {\n-                        kind: Adjust::Deref(_), ..\n-                    }, Adjustment {\n-                        kind: Adjust::Deref(_), ..\n-                    }, Adjustment {\n-                        kind: Adjust::Borrow(_),\n-                        ..\n-                    }] = *adj3\n+                    if let [\n+                        Adjustment {\n+                            kind: Adjust::Deref(_), ..\n+                        },\n+                        Adjustment {\n+                            kind: Adjust::Deref(_), ..\n+                        },\n+                        Adjustment {\n+                            kind: Adjust::Borrow(_),\n+                            ..\n+                        },\n+                    ] = *adj3\n                     {\n                         let help_msg_ty = if matches!(mutability, Mutability::Not) {\n                             format!(\"&{}\", ty)"}, {"sha": "5b71bb29c10a1763a81fdc7d5b92fcdc293bd40a", "filename": "clippy_lints/src/vec_init_then_push.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fvec_init_then_push.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d23a338543e6551154633546d680ad314024943e/clippy_lints%2Fsrc%2Fvec_init_then_push.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fvec_init_then_push.rs?ref=d23a338543e6551154633546d680ad314024943e", "patch": "@@ -174,13 +174,13 @@ fn get_vec_init_kind<'tcx>(cx: &LateContext<'tcx>, expr: &'tcx Expr<'tcx>) -> Op\n                         }\n                     });\n                 }\n-            }\n+            },\n             ExprKind::Path(QPath::Resolved(_, path))\n                 if match_def_path(cx, path.res.opt_def_id()?, &paths::DEFAULT_TRAIT_METHOD)\n                     && is_type_diagnostic_item(cx, cx.typeck_results().expr_ty(expr), sym::Vec) =>\n             {\n                 return Some(VecInitKind::New);\n-            }\n+            },\n             _ => (),\n         }\n     }"}, {"sha": "796c7dd70bfd449af67cd347a000fe225b96dcee", "filename": "clippy_utils/src/lib.rs", "status": "modified", "additions": 14, "deletions": 11, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/d23a338543e6551154633546d680ad314024943e/clippy_utils%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d23a338543e6551154633546d680ad314024943e/clippy_utils%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_utils%2Fsrc%2Flib.rs?ref=d23a338543e6551154633546d680ad314024943e", "patch": "@@ -846,10 +846,13 @@ pub fn capture_local_usage(cx: &LateContext<'tcx>, e: &Expr<'_>) -> CaptureKind\n     let mut capture_expr_ty = e;\n \n     for (parent_id, parent) in cx.tcx.hir().parent_iter(e.hir_id) {\n-        if let [Adjustment {\n-            kind: Adjust::Deref(_) | Adjust::Borrow(AutoBorrow::Ref(..)),\n-            target,\n-        }, ref adjust @ ..] = *cx\n+        if let [\n+            Adjustment {\n+                kind: Adjust::Deref(_) | Adjust::Borrow(AutoBorrow::Ref(..)),\n+                target,\n+            },\n+            ref adjust @ ..,\n+        ] = *cx\n             .typeck_results()\n             .adjustments()\n             .get(child_id)\n@@ -1234,9 +1237,7 @@ pub fn get_enclosing_loop_or_closure(tcx: TyCtxt<'tcx>, expr: &Expr<'_>) -> Opti\n     for (_, node) in tcx.hir().parent_iter(expr.hir_id) {\n         match node {\n             Node::Expr(\n-                e\n-                @\n-                Expr {\n+                e @ Expr {\n                     kind: ExprKind::Loop(..) | ExprKind::Closure(..),\n                     ..\n                 },\n@@ -1698,10 +1699,12 @@ pub fn is_async_fn(kind: FnKind<'_>) -> bool {\n pub fn get_async_fn_body(tcx: TyCtxt<'tcx>, body: &Body<'_>) -> Option<&'tcx Expr<'tcx>> {\n     if let ExprKind::Call(\n         _,\n-        &[Expr {\n-            kind: ExprKind::Closure(_, _, body, _, _),\n-            ..\n-        }],\n+        &[\n+            Expr {\n+                kind: ExprKind::Closure(_, _, body, _, _),\n+                ..\n+            },\n+        ],\n     ) = body.value.kind\n     {\n         if let ExprKind::Block("}]}