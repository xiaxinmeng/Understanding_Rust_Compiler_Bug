{"sha": "0b936d2da702848a4d537e745921636490e93060", "node_id": "C_kwDOAAsO6NoAKDBiOTM2ZDJkYTcwMjg0OGE0ZDUzN2U3NDU5MjE2MzY0OTBlOTMwNjA", "commit": {"author": {"name": "Byron Zhong", "email": "byronzhong@cs.uchicago.edu", "date": "2022-10-25T17:35:04Z"}, "committer": {"name": "Byron Zhong", "email": "byronzhong@cs.uchicago.edu", "date": "2022-10-26T03:08:41Z"}, "message": "Add check to only output 'you might have meant' when the candidate name is in the same crate", "tree": {"sha": "87c44a5be343755bdb7ebda33b408c54ea8e05ad", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/87c44a5be343755bdb7ebda33b408c54ea8e05ad"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0b936d2da702848a4d537e745921636490e93060", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0b936d2da702848a4d537e745921636490e93060", "html_url": "https://github.com/rust-lang/rust/commit/0b936d2da702848a4d537e745921636490e93060", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0b936d2da702848a4d537e745921636490e93060/comments", "author": {"login": "zbyrn", "id": 34432561, "node_id": "MDQ6VXNlcjM0NDMyNTYx", "avatar_url": "https://avatars.githubusercontent.com/u/34432561?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zbyrn", "html_url": "https://github.com/zbyrn", "followers_url": "https://api.github.com/users/zbyrn/followers", "following_url": "https://api.github.com/users/zbyrn/following{/other_user}", "gists_url": "https://api.github.com/users/zbyrn/gists{/gist_id}", "starred_url": "https://api.github.com/users/zbyrn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zbyrn/subscriptions", "organizations_url": "https://api.github.com/users/zbyrn/orgs", "repos_url": "https://api.github.com/users/zbyrn/repos", "events_url": "https://api.github.com/users/zbyrn/events{/privacy}", "received_events_url": "https://api.github.com/users/zbyrn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "zbyrn", "id": 34432561, "node_id": "MDQ6VXNlcjM0NDMyNTYx", "avatar_url": "https://avatars.githubusercontent.com/u/34432561?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zbyrn", "html_url": "https://github.com/zbyrn", "followers_url": "https://api.github.com/users/zbyrn/followers", "following_url": "https://api.github.com/users/zbyrn/following{/other_user}", "gists_url": "https://api.github.com/users/zbyrn/gists{/gist_id}", "starred_url": "https://api.github.com/users/zbyrn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zbyrn/subscriptions", "organizations_url": "https://api.github.com/users/zbyrn/orgs", "repos_url": "https://api.github.com/users/zbyrn/repos", "events_url": "https://api.github.com/users/zbyrn/events{/privacy}", "received_events_url": "https://api.github.com/users/zbyrn/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "be61f0237b95083d26ce32fb0934dd42caf6ea07", "url": "https://api.github.com/repos/rust-lang/rust/commits/be61f0237b95083d26ce32fb0934dd42caf6ea07", "html_url": "https://github.com/rust-lang/rust/commit/be61f0237b95083d26ce32fb0934dd42caf6ea07"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "dfbd982bb7c326ac8d642740ea69249d3970c30a", "filename": "compiler/rustc_resolve/src/late/diagnostics.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/0b936d2da702848a4d537e745921636490e93060/compiler%2Frustc_resolve%2Fsrc%2Flate%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0b936d2da702848a4d537e745921636490e93060/compiler%2Frustc_resolve%2Fsrc%2Flate%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_resolve%2Fsrc%2Flate%2Fdiagnostics.rs?ref=0b936d2da702848a4d537e745921636490e93060", "patch": "@@ -691,7 +691,8 @@ impl<'a: 'ast, 'ast> LateResolutionVisitor<'a, '_, 'ast> {\n         let is_expected = &|res| source.is_expected(res);\n         let ident_span = path.last().map_or(span, |ident| ident.ident.span);\n         let typo_sugg = self.lookup_typo_candidate(path, source.namespace(), is_expected);\n-        if let TypoCandidate::Shadowed(res, Some(sugg_span)) = typo_sugg {\n+        let is_local = &|res: Res| res.opt_def_id().map_or(false, |id| id.is_local());\n+        if let TypoCandidate::Shadowed(res, Some(sugg_span)) = typo_sugg && is_local(res) {\n             err.span_label(\n                 sugg_span,\n                 format!(\"you might have meant to refer to this {}\", res.descr()),"}]}