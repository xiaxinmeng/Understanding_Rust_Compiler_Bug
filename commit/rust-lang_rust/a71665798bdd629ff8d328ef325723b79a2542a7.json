{"sha": "a71665798bdd629ff8d328ef325723b79a2542a7", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE3MTY2NTc5OGJkZDYyOWZmOGQzMjhlZjMyNTcyM2I3OWEyNTQyYTc=", "commit": {"author": {"name": "Joshua Yanovski", "email": "pythonesque@gmail.com", "date": "2013-10-29T06:30:26Z"}, "committer": {"name": "Joshua Yanovski", "email": "pythonesque@gmail.com", "date": "2013-10-29T06:51:10Z"}, "message": "#8263 part 2: Adding struct name.", "tree": {"sha": "5137661edbf8e293bc081c6d3c2ca83711a1b4f9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5137661edbf8e293bc081c6d3c2ca83711a1b4f9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a71665798bdd629ff8d328ef325723b79a2542a7", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a71665798bdd629ff8d328ef325723b79a2542a7", "html_url": "https://github.com/rust-lang/rust/commit/a71665798bdd629ff8d328ef325723b79a2542a7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a71665798bdd629ff8d328ef325723b79a2542a7/comments", "author": {"login": "pythonesque", "id": 923144, "node_id": "MDQ6VXNlcjkyMzE0NA==", "avatar_url": "https://avatars.githubusercontent.com/u/923144?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pythonesque", "html_url": "https://github.com/pythonesque", "followers_url": "https://api.github.com/users/pythonesque/followers", "following_url": "https://api.github.com/users/pythonesque/following{/other_user}", "gists_url": "https://api.github.com/users/pythonesque/gists{/gist_id}", "starred_url": "https://api.github.com/users/pythonesque/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pythonesque/subscriptions", "organizations_url": "https://api.github.com/users/pythonesque/orgs", "repos_url": "https://api.github.com/users/pythonesque/repos", "events_url": "https://api.github.com/users/pythonesque/events{/privacy}", "received_events_url": "https://api.github.com/users/pythonesque/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pythonesque", "id": 923144, "node_id": "MDQ6VXNlcjkyMzE0NA==", "avatar_url": "https://avatars.githubusercontent.com/u/923144?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pythonesque", "html_url": "https://github.com/pythonesque", "followers_url": "https://api.github.com/users/pythonesque/followers", "following_url": "https://api.github.com/users/pythonesque/following{/other_user}", "gists_url": "https://api.github.com/users/pythonesque/gists{/gist_id}", "starred_url": "https://api.github.com/users/pythonesque/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pythonesque/subscriptions", "organizations_url": "https://api.github.com/users/pythonesque/orgs", "repos_url": "https://api.github.com/users/pythonesque/repos", "events_url": "https://api.github.com/users/pythonesque/events{/privacy}", "received_events_url": "https://api.github.com/users/pythonesque/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "01ab8542fbcfbea2cb0dcdc538e56a7167f70f51", "url": "https://api.github.com/repos/rust-lang/rust/commits/01ab8542fbcfbea2cb0dcdc538e56a7167f70f51", "html_url": "https://github.com/rust-lang/rust/commit/01ab8542fbcfbea2cb0dcdc538e56a7167f70f51"}], "stats": {"total": 17, "additions": 11, "deletions": 6}, "files": [{"sha": "d71aa77668926b7a415dcb194708415cca31a9ce", "filename": "src/librustc/middle/typeck/check/mod.rs", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/a71665798bdd629ff8d328ef325723b79a2542a7/src%2Flibrustc%2Fmiddle%2Ftypeck%2Fcheck%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a71665798bdd629ff8d328ef325723b79a2542a7/src%2Flibrustc%2Fmiddle%2Ftypeck%2Fcheck%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Ftypeck%2Fcheck%2Fmod.rs?ref=a71665798bdd629ff8d328ef325723b79a2542a7", "patch": "@@ -2009,6 +2009,7 @@ pub fn check_expr_with_unifier(fcx: @mut FnCtxt,\n     }\n \n     fn check_struct_or_variant_fields(fcx: @mut FnCtxt,\n+                                      struct_ty: ty::t,\n                                       span: Span,\n                                       class_id: ast::DefId,\n                                       node_id: ast::NodeId,\n@@ -2033,10 +2034,12 @@ pub fn check_expr_with_unifier(fcx: @mut FnCtxt,\n             let pair = class_field_map.find(&field.ident.node.name).map(|x| *x);\n             match pair {\n                 None => {\n-                    tcx.sess.span_err(\n-                        field.ident.span,\n-                        format!(\"structure has no field named `{}`\",\n-                             tcx.sess.str_of(field.ident.node)));\n+                    fcx.type_error_message(\n+                      field.ident.span,\n+                      |actual| {\n+                          format!(\"structure `{}` has no field named `{}`\",\n+                                  actual, tcx.sess.str_of(field.ident.node))\n+                    }, struct_ty, None);\n                     error_happened = true;\n                 }\n                 Some((_, true)) => {\n@@ -2161,6 +2164,7 @@ pub fn check_expr_with_unifier(fcx: @mut FnCtxt,\n         // Look up and check the fields.\n         let class_fields = ty::lookup_struct_fields(tcx, class_id);\n         check_struct_or_variant_fields(fcx,\n+                                           struct_type,\n                                            span,\n                                            class_id,\n                                            id,\n@@ -2248,6 +2252,7 @@ pub fn check_expr_with_unifier(fcx: @mut FnCtxt,\n         // Look up and check the enum variant fields.\n         let variant_fields = ty::lookup_struct_fields(tcx, variant_id);\n         check_struct_or_variant_fields(fcx,\n+                                       enum_type,\n                                        span,\n                                        variant_id,\n                                        id,"}, {"sha": "b63db7c5a30e5cb64b45783b61172cdae68e6d56", "filename": "src/test/compile-fail/issue-4736.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a71665798bdd629ff8d328ef325723b79a2542a7/src%2Ftest%2Fcompile-fail%2Fissue-4736.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a71665798bdd629ff8d328ef325723b79a2542a7/src%2Ftest%2Fcompile-fail%2Fissue-4736.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-4736.rs?ref=a71665798bdd629ff8d328ef325723b79a2542a7", "patch": "@@ -11,5 +11,5 @@\n struct NonCopyable(());\n \n fn main() {\n-    let z = NonCopyable{ p: () }; //~ ERROR structure has no field named `p`\n+    let z = NonCopyable{ p: () }; //~ ERROR structure `NonCopyable` has no field named `p`\n }"}, {"sha": "de58b5d110e5f19f0c80d19be29dcfa852197e65", "filename": "src/test/compile-fail/struct-fields-too-many.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a71665798bdd629ff8d328ef325723b79a2542a7/src%2Ftest%2Fcompile-fail%2Fstruct-fields-too-many.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a71665798bdd629ff8d328ef325723b79a2542a7/src%2Ftest%2Fcompile-fail%2Fstruct-fields-too-many.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fstruct-fields-too-many.rs?ref=a71665798bdd629ff8d328ef325723b79a2542a7", "patch": "@@ -15,6 +15,6 @@ struct BuildData {\n fn main() {\n     let foo = BuildData {\n         foo: 0,\n-        bar: 0 //~ ERROR structure has no field named `bar`\n+        bar: 0 //~ ERROR structure `BuildData` has no field named `bar`\n     };\n }"}]}