{"sha": "329f045d4c5f27275dcf1cadf8d0f51919ba8027", "node_id": "MDY6Q29tbWl0NzI0NzEyOjMyOWYwNDVkNGM1ZjI3Mjc1ZGNmMWNhZGY4ZDBmNTE5MTliYTgwMjc=", "commit": {"author": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-10-31T21:42:17Z"}, "committer": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-10-31T21:42:44Z"}, "message": "rustc: Enable segmented stacks in LLVM when --stack-growth is on", "tree": {"sha": "460c6266859557ba33a7fe31ebeaf257ae002a31", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/460c6266859557ba33a7fe31ebeaf257ae002a31"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/329f045d4c5f27275dcf1cadf8d0f51919ba8027", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/329f045d4c5f27275dcf1cadf8d0f51919ba8027", "html_url": "https://github.com/rust-lang/rust/commit/329f045d4c5f27275dcf1cadf8d0f51919ba8027", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/329f045d4c5f27275dcf1cadf8d0f51919ba8027/comments", "author": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c9003d301f602cb44d8cc3fd464c95b09e08548e", "url": "https://api.github.com/repos/rust-lang/rust/commits/c9003d301f602cb44d8cc3fd464c95b09e08548e", "html_url": "https://github.com/rust-lang/rust/commit/c9003d301f602cb44d8cc3fd464c95b09e08548e"}], "stats": {"total": 10, "additions": 10, "deletions": 0}, "files": [{"sha": "ee4caad52e078d288ec612b4d9fa140365fde29a", "filename": "src/comp/back/link.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/329f045d4c5f27275dcf1cadf8d0f51919ba8027/src%2Fcomp%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/329f045d4c5f27275dcf1cadf8d0f51919ba8027/src%2Fcomp%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fback%2Flink.rs?ref=329f045d4c5f27275dcf1cadf8d0f51919ba8027", "patch": "@@ -91,6 +91,7 @@ mod write {\n     fn run_passes(sess: session::session, llmod: ModuleRef, output: str) {\n         let opts = sess.get_opts();\n         if opts.time_llvm_passes { llvm::LLVMRustEnableTimePasses(); }\n+        if opts.stack_growth { llvm::LLVMRustEnableSegmentedStacks(); }\n         link_intrinsics(sess, llmod);\n         let pm = mk_pass_manager();\n         let td = mk_target_data(x86::get_data_layout());"}, {"sha": "379926446474b5d9a74d3fdb92524cc614a0d05b", "filename": "src/comp/lib/llvm.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/329f045d4c5f27275dcf1cadf8d0f51919ba8027/src%2Fcomp%2Flib%2Fllvm.rs", "raw_url": "https://github.com/rust-lang/rust/raw/329f045d4c5f27275dcf1cadf8d0f51919ba8027/src%2Fcomp%2Flib%2Fllvm.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Flib%2Fllvm.rs?ref=329f045d4c5f27275dcf1cadf8d0f51919ba8027", "patch": "@@ -868,6 +868,8 @@ native \"c-stack-cdecl\" mod llvm = \"rustllvm\" {\n \n     /** Turn on LLVM pass-timing. */\n     fn LLVMRustEnableTimePasses();\n+    /** Turn on LLVM segmented stacks. */\n+    fn LLVMRustEnableSegmentedStacks();\n \n     /** Print the pass timings since static dtors aren't picking them up. */\n     fn LLVMRustPrintPassTimings();"}, {"sha": "a9373b6c7e5bba5a231ed500b9744cb55100e46f", "filename": "src/rustllvm/RustWrapper.cpp", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/329f045d4c5f27275dcf1cadf8d0f51919ba8027/src%2Frustllvm%2FRustWrapper.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/329f045d4c5f27275dcf1cadf8d0f51919ba8027/src%2Frustllvm%2FRustWrapper.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2FRustWrapper.cpp?ref=329f045d4c5f27275dcf1cadf8d0f51919ba8027", "patch": "@@ -123,3 +123,9 @@ extern \"C\" void LLVMRustPrintPassTimings() {\n   raw_fd_ostream OS (2, false); // stderr.\n   TimerGroup::printAll(OS);\n }\n+\n+extern bool llvm::EnableSegmentedStacks;\n+extern \"C\" void LLVMRustEnableSegmentedStacks() {\n+  EnableSegmentedStacks = true;\n+}\n+"}, {"sha": "beaa3980d8ee29c850ee31b074465d420160a797", "filename": "src/rustllvm/rustllvm.def.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/329f045d4c5f27275dcf1cadf8d0f51919ba8027/src%2Frustllvm%2Frustllvm.def.in", "raw_url": "https://github.com/rust-lang/rust/raw/329f045d4c5f27275dcf1cadf8d0f51919ba8027/src%2Frustllvm%2Frustllvm.def.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2Frustllvm.def.in?ref=329f045d4c5f27275dcf1cadf8d0f51919ba8027", "patch": "@@ -6,6 +6,7 @@ LLVMRustGetHostTriple\n LLVMRustConstSmallInt\n LLVMRustParseBitcode\n LLVMRustPrintPassTimings\n+LLVMRustEnableSegmentedStacks\n LLVMLinkModules\n LLVMCreateObjectFile\n LLVMDisposeObjectFile"}]}