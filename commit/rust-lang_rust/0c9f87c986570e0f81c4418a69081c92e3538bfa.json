{"sha": "0c9f87c986570e0f81c4418a69081c92e3538bfa", "node_id": "C_kwDOAAsO6NoAKDBjOWY4N2M5ODY1NzBlMGY4MWM0NDE4YTY5MDgxYzkyZTM1MzhiZmE", "commit": {"author": {"name": "Nilstrieb", "email": "48135649+Nilstrieb@users.noreply.github.com", "date": "2023-05-30T10:57:39Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-05-30T10:57:39Z"}, "message": "Rollup merge of #111872 - bvanjoi:fix-103646, r=cjgillot\n\nfix: dedup `static_candidates` before report\n\nFixes https://github.com/rust-lang/rust/issues/103646\n\n`record_static_candidate` had been executed twice, resulting in the presence of two identical `CandidateSource::Trait(Cat)`  in static_candidates. This PR aims to deduplication the `static_candidates` list, allowing it to execute `suggest_associated_call_syntax` properly.", "tree": {"sha": "30cd5fcf8627e25cd55ce24f9fd191f55800c6fb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/30cd5fcf8627e25cd55ce24f9fd191f55800c6fb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0c9f87c986570e0f81c4418a69081c92e3538bfa", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkddajCRBK7hj4Ov3rIwAAa/UIAHziSTkPQG7gLrxzbGcDVwgv\n4/w7xMgOUvFlWJZlkxUf2dPFXr7RQmVrbXXvdyEA4XLpd4bT+AgzI2m5dnsiq8oB\nreBw3r0sW1fS6jAD3sQ7OCyOy+b9+fGczWesbXWxJZkeKdO1S6z3WAZztJLZSk8b\nrpYz/Cwrh84pQgDMrAOzuxnQ8gNcQA9kn5V7l0tN52m0v1pcwHtKhITrKRWYC0pc\nTgfHsEaLtb7uTnG15PAFBs7fuDtLJyhB8ADzIQLEjR8+7zF4u+yp9UIjlN7xyAIJ\nLOZIUqdhk1gyUYbRWvjgfmYq0wufuypPYwF30M6+tef7AkcSxmGW6ED6fFRNNMA=\n=ZrLd\n-----END PGP SIGNATURE-----\n", "payload": "tree 30cd5fcf8627e25cd55ce24f9fd191f55800c6fb\nparent 7a4006cc52d741b270e1da7b508dc6f87ae3e4de\nparent f78369b3afedd4d662cc6f92eee825bc94bf1e8e\nauthor Nilstrieb <48135649+Nilstrieb@users.noreply.github.com> 1685444259 +0200\ncommitter GitHub <noreply@github.com> 1685444259 +0200\n\nRollup merge of #111872 - bvanjoi:fix-103646, r=cjgillot\n\nfix: dedup `static_candidates` before report\n\nFixes https://github.com/rust-lang/rust/issues/103646\n\n`record_static_candidate` had been executed twice, resulting in the presence of two identical `CandidateSource::Trait(Cat)`  in static_candidates. This PR aims to deduplication the `static_candidates` list, allowing it to execute `suggest_associated_call_syntax` properly.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0c9f87c986570e0f81c4418a69081c92e3538bfa", "html_url": "https://github.com/rust-lang/rust/commit/0c9f87c986570e0f81c4418a69081c92e3538bfa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0c9f87c986570e0f81c4418a69081c92e3538bfa/comments", "author": {"login": "Nilstrieb", "id": 48135649, "node_id": "MDQ6VXNlcjQ4MTM1NjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/48135649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nilstrieb", "html_url": "https://github.com/Nilstrieb", "followers_url": "https://api.github.com/users/Nilstrieb/followers", "following_url": "https://api.github.com/users/Nilstrieb/following{/other_user}", "gists_url": "https://api.github.com/users/Nilstrieb/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nilstrieb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nilstrieb/subscriptions", "organizations_url": "https://api.github.com/users/Nilstrieb/orgs", "repos_url": "https://api.github.com/users/Nilstrieb/repos", "events_url": "https://api.github.com/users/Nilstrieb/events{/privacy}", "received_events_url": "https://api.github.com/users/Nilstrieb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7a4006cc52d741b270e1da7b508dc6f87ae3e4de", "url": "https://api.github.com/repos/rust-lang/rust/commits/7a4006cc52d741b270e1da7b508dc6f87ae3e4de", "html_url": "https://github.com/rust-lang/rust/commit/7a4006cc52d741b270e1da7b508dc6f87ae3e4de"}, {"sha": "f78369b3afedd4d662cc6f92eee825bc94bf1e8e", "url": "https://api.github.com/repos/rust-lang/rust/commits/f78369b3afedd4d662cc6f92eee825bc94bf1e8e", "html_url": "https://github.com/rust-lang/rust/commit/f78369b3afedd4d662cc6f92eee825bc94bf1e8e"}], "stats": {"total": 38, "additions": 38, "deletions": 0}, "files": [{"sha": "9ee967dc7a97ef14ec1e6f9bd7d4f1ea18768b76", "filename": "compiler/rustc_hir_typeck/src/method/suggest.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/0c9f87c986570e0f81c4418a69081c92e3538bfa/compiler%2Frustc_hir_typeck%2Fsrc%2Fmethod%2Fsuggest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0c9f87c986570e0f81c4418a69081c92e3538bfa/compiler%2Frustc_hir_typeck%2Fsrc%2Fmethod%2Fsuggest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_typeck%2Fsrc%2Fmethod%2Fsuggest.rs?ref=0c9f87c986570e0f81c4418a69081c92e3538bfa", "patch": "@@ -473,6 +473,12 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         let mut custom_span_label = false;\n \n         let static_candidates = &mut no_match_data.static_candidates;\n+\n+        // `static_candidates` may have same candidates appended by\n+        // inherent and extension, which may result in incorrect\n+        // diagnostic.\n+        static_candidates.dedup();\n+\n         if !static_candidates.is_empty() {\n             err.note(\n                 \"found the following associated functions; to be used as methods, \\"}, {"sha": "f679640c5dc90103a97db56ca7ee5ada265e68de", "filename": "tests/ui/suggestions/issue-103646.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/0c9f87c986570e0f81c4418a69081c92e3538bfa/tests%2Fui%2Fsuggestions%2Fissue-103646.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0c9f87c986570e0f81c4418a69081c92e3538bfa/tests%2Fui%2Fsuggestions%2Fissue-103646.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuggestions%2Fissue-103646.rs?ref=0c9f87c986570e0f81c4418a69081c92e3538bfa", "patch": "@@ -0,0 +1,11 @@\n+trait Cat {\n+    fn nya() {}\n+}\n+\n+fn uwu<T: Cat>(c: T) {\n+    c.nya();\n+    //~^ ERROR no method named `nya` found for type parameter `T` in the current scope\n+    //~| Suggestion T::nya()\n+}\n+\n+fn main() {}"}, {"sha": "3ae9813d4914c1952ec31a10df3aeb3c905b6814", "filename": "tests/ui/suggestions/issue-103646.stderr", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/0c9f87c986570e0f81c4418a69081c92e3538bfa/tests%2Fui%2Fsuggestions%2Fissue-103646.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0c9f87c986570e0f81c4418a69081c92e3538bfa/tests%2Fui%2Fsuggestions%2Fissue-103646.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuggestions%2Fissue-103646.stderr?ref=0c9f87c986570e0f81c4418a69081c92e3538bfa", "patch": "@@ -0,0 +1,21 @@\n+error[E0599]: no method named `nya` found for type parameter `T` in the current scope\n+  --> $DIR/issue-103646.rs:6:7\n+   |\n+LL | fn uwu<T: Cat>(c: T) {\n+   |        - method `nya` not found for this type parameter\n+LL |     c.nya();\n+   |     --^^^--\n+   |     | |\n+   |     | this is an associated function, not a method\n+   |     help: use associated function syntax instead: `T::nya()`\n+   |\n+   = note: found the following associated functions; to be used as methods, functions must have a `self` parameter\n+note: the candidate is defined in the trait `Cat`\n+  --> $DIR/issue-103646.rs:2:5\n+   |\n+LL |     fn nya() {}\n+   |     ^^^^^^^^\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0599`."}]}