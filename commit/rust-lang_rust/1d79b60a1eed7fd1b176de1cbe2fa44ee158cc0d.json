{"sha": "1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d", "node_id": "C_kwDOAAsO6NoAKDFkNzliNjBhMWVlZDdmZDFiMTc2ZGUxY2JlMmZhNDRlZTE1OGNjMGQ", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-04-02T03:59:16Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-04-02T03:59:16Z"}, "message": "make strict-provenance imply check-number-validity", "tree": {"sha": "4c33337452bc7da2ee88720224410193ff5878f2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4c33337452bc7da2ee88720224410193ff5878f2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d", "html_url": "https://github.com/rust-lang/rust/commit/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "732461b4cd2c4bfd8b229ad43fbc32c193b4049d", "url": "https://api.github.com/repos/rust-lang/rust/commits/732461b4cd2c4bfd8b229ad43fbc32c193b4049d", "html_url": "https://github.com/rust-lang/rust/commit/732461b4cd2c4bfd8b229ad43fbc32c193b4049d"}], "stats": {"total": 20, "additions": 11, "deletions": 9}, "files": [{"sha": "d394eb3cfbe955e858465a38dd358560c8b2aace", "filename": "README.md", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/README.md", "raw_url": "https://github.com/rust-lang/rust/raw/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/README.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/README.md?ref=1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d", "patch": "@@ -297,7 +297,8 @@ environment variable:\n * `-Zmiri-strict-provenance` enables [strict\n   provenance](https://github.com/rust-lang/rust/issues/95228) checking in Miri. This means that\n   casting an integer to a pointer yields a result with 'invalid' provenance, i.e., with provenance\n-  that cannot be used for any memory access. Also implies `-Zmiri-tag-raw-pointers`.\n+  that cannot be used for any memory access. Also implies `-Zmiri-tag-raw-pointers` and\n+  `-Zmiri-check-number-validity`.\n * `-Zmiri-symbolic-alignment-check` makes the alignment check more strict.  By\n   default, alignment is checked by casting the pointer to an integer, and making\n   sure that is a multiple of the alignment.  This can lead to cases where a"}, {"sha": "be4776f459cd4295ab72b21e1053c86e2b43028b", "filename": "src/bin/miri.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/src%2Fbin%2Fmiri.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/src%2Fbin%2Fmiri.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbin%2Fmiri.rs?ref=1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d", "patch": "@@ -366,6 +366,7 @@ fn main() {\n                 \"-Zmiri-strict-provenance\" => {\n                     miri_config.strict_provenance = true;\n                     miri_config.tag_raw = true;\n+                    miri_config.check_number_validity = true;\n                 }\n                 \"-Zmiri-track-raw-pointers\" => {\n                     eprintln!("}, {"sha": "413d7ef53d1cde93d6b3e33cb299b1b6f3409859", "filename": "tests/run-pass/btreemap.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Fbtreemap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Fbtreemap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fbtreemap.rs?ref=1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d", "patch": "@@ -1,4 +1,4 @@\n-// compile-flags: -Zmiri-strict-provenance -Zmiri-check-number-validity\n+// compile-flags: -Zmiri-strict-provenance\n #![feature(btree_drain_filter)]\n use std::collections::{BTreeMap, BTreeSet};\n use std::mem;"}, {"sha": "5e43fea968641ac7233c51d36033fb75a9477cee", "filename": "tests/run-pass/concurrency/sync.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Fconcurrency%2Fsync.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Fconcurrency%2Fsync.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fconcurrency%2Fsync.rs?ref=1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d", "patch": "@@ -1,5 +1,5 @@\n // ignore-windows: Concurrency on Windows is not supported yet.\n-// compile-flags: -Zmiri-disable-isolation -Zmiri-strict-provenance -Zmiri-check-number-validity\n+// compile-flags: -Zmiri-disable-isolation -Zmiri-strict-provenance\n \n use std::sync::{Arc, Barrier, Condvar, Mutex, Once, RwLock};\n use std::thread;"}, {"sha": "7938284bd6343ac41ff24696a8f1c4578c18088c", "filename": "tests/run-pass/concurrency/thread_locals.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Fconcurrency%2Fthread_locals.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Fconcurrency%2Fthread_locals.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fconcurrency%2Fthread_locals.rs?ref=1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d", "patch": "@@ -1,5 +1,5 @@\n // ignore-windows: Concurrency on Windows is not supported yet.\n-// compile-flags: -Zmiri-strict-provenance -Zmiri-check-number-validity\n+// compile-flags: -Zmiri-strict-provenance\n \n //! The main purpose of this test is to check that if we take a pointer to\n //! thread's `t1` thread-local `A` and send it to another thread `t2`,"}, {"sha": "6d51825fc0df28b8222ae20cae2fe09bc4659961", "filename": "tests/run-pass/rc.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Frc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Frc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Frc.rs?ref=1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d", "patch": "@@ -1,4 +1,4 @@\n-// compile-flags: -Zmiri-strict-provenance -Zmiri-check-number-validity\n+// compile-flags: -Zmiri-strict-provenance\n #![feature(new_uninit)]\n #![feature(get_mut_unchecked)]\n "}, {"sha": "b6537b4f1b4de174546a0f14a2f545df13f5c5e2", "filename": "tests/run-pass/slices.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Fslices.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Fslices.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fslices.rs?ref=1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d", "patch": "@@ -1,4 +1,4 @@\n-// compile-flags: -Zmiri-strict-provenance -Zmiri-check-number-validity\n+// compile-flags: -Zmiri-strict-provenance\n #![feature(new_uninit)]\n #![feature(slice_as_chunks)]\n #![feature(slice_partition_dedup)]"}, {"sha": "77ecaed4fe9b88359cd3f22ebe6f30801d75038b", "filename": "tests/run-pass/strings.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Fstrings.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Fstrings.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fstrings.rs?ref=1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d", "patch": "@@ -1,4 +1,4 @@\n-// compile-flags: -Zmiri-strict-provenance -Zmiri-check-number-validity\n+// compile-flags: -Zmiri-strict-provenance\n \n fn empty() -> &'static str {\n     \"\""}, {"sha": "788f05ce97741ccea85b374ac4cfbc1cc51f3b94", "filename": "tests/run-pass/vec.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Fvec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Fvec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fvec.rs?ref=1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d", "patch": "@@ -1,4 +1,4 @@\n-// compile-flags: -Zmiri-strict-provenance -Zmiri-check-number-validity\n+// compile-flags: -Zmiri-strict-provenance\n // Gather all references from a mutable iterator and make sure Miri notices if\n // using them is dangerous.\n fn test_all_refs<'a, T: 'a>(dummy: &mut T, iter: impl Iterator<Item = &'a mut T>) {"}, {"sha": "0cba0165cae16c5d1ad1c0deefff4b292b0dea6d", "filename": "tests/run-pass/vecdeque.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Fvecdeque.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d/tests%2Frun-pass%2Fvecdeque.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fvecdeque.rs?ref=1d79b60a1eed7fd1b176de1cbe2fa44ee158cc0d", "patch": "@@ -1,4 +1,4 @@\n-// compile-flags: -Zmiri-strict-provenance -Zmiri-check-number-validity\n+// compile-flags: -Zmiri-strict-provenance\n use std::collections::VecDeque;\n \n fn test_all_refs<'a, T: 'a>(dummy: &mut T, iter: impl Iterator<Item = &'a mut T>) {"}]}