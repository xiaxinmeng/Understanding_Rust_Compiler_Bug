{"sha": "d6c737adb50e194beca9cf0c0a87037738ae8a58", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ2YzczN2FkYjUwZTE5NGJlY2E5Y2YwYzBhODcwMzc3MzhhZThhNTg=", "commit": {"author": {"name": "LeSeulArtichaut", "email": "leseulartichaut@gmail.com", "date": "2021-03-06T23:21:14Z"}, "committer": {"name": "LeSeulArtichaut", "email": "leseulartichaut@gmail.com", "date": "2021-03-09T19:15:03Z"}, "message": "Take into account `ExprKind::Scope` when calculating span of temporary", "tree": {"sha": "1f9043c09d6a3554ad1d6d577108b0acb1c1091b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1f9043c09d6a3554ad1d6d577108b0acb1c1091b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d6c737adb50e194beca9cf0c0a87037738ae8a58", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d6c737adb50e194beca9cf0c0a87037738ae8a58", "html_url": "https://github.com/rust-lang/rust/commit/d6c737adb50e194beca9cf0c0a87037738ae8a58", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d6c737adb50e194beca9cf0c0a87037738ae8a58/comments", "author": {"login": "LeSeulArtichaut", "id": 38361244, "node_id": "MDQ6VXNlcjM4MzYxMjQ0", "avatar_url": "https://avatars.githubusercontent.com/u/38361244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LeSeulArtichaut", "html_url": "https://github.com/LeSeulArtichaut", "followers_url": "https://api.github.com/users/LeSeulArtichaut/followers", "following_url": "https://api.github.com/users/LeSeulArtichaut/following{/other_user}", "gists_url": "https://api.github.com/users/LeSeulArtichaut/gists{/gist_id}", "starred_url": "https://api.github.com/users/LeSeulArtichaut/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LeSeulArtichaut/subscriptions", "organizations_url": "https://api.github.com/users/LeSeulArtichaut/orgs", "repos_url": "https://api.github.com/users/LeSeulArtichaut/repos", "events_url": "https://api.github.com/users/LeSeulArtichaut/events{/privacy}", "received_events_url": "https://api.github.com/users/LeSeulArtichaut/received_events", "type": "User", "site_admin": false}, "committer": {"login": "LeSeulArtichaut", "id": 38361244, "node_id": "MDQ6VXNlcjM4MzYxMjQ0", "avatar_url": "https://avatars.githubusercontent.com/u/38361244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LeSeulArtichaut", "html_url": "https://github.com/LeSeulArtichaut", "followers_url": "https://api.github.com/users/LeSeulArtichaut/followers", "following_url": "https://api.github.com/users/LeSeulArtichaut/following{/other_user}", "gists_url": "https://api.github.com/users/LeSeulArtichaut/gists{/gist_id}", "starred_url": "https://api.github.com/users/LeSeulArtichaut/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LeSeulArtichaut/subscriptions", "organizations_url": "https://api.github.com/users/LeSeulArtichaut/orgs", "repos_url": "https://api.github.com/users/LeSeulArtichaut/repos", "events_url": "https://api.github.com/users/LeSeulArtichaut/events{/privacy}", "received_events_url": "https://api.github.com/users/LeSeulArtichaut/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5f38c839ad306bf230adb5f27b98983f1d04722b", "url": "https://api.github.com/repos/rust-lang/rust/commits/5f38c839ad306bf230adb5f27b98983f1d04722b", "html_url": "https://github.com/rust-lang/rust/commit/5f38c839ad306bf230adb5f27b98983f1d04722b"}], "stats": {"total": 12, "additions": 6, "deletions": 6}, "files": [{"sha": "f01315fc5db04fa05219b1403e5915320704c806", "filename": "compiler/rustc_mir_build/src/build/expr/stmt.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/d6c737adb50e194beca9cf0c0a87037738ae8a58/compiler%2Frustc_mir_build%2Fsrc%2Fbuild%2Fexpr%2Fstmt.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6c737adb50e194beca9cf0c0a87037738ae8a58/compiler%2Frustc_mir_build%2Fsrc%2Fbuild%2Fexpr%2Fstmt.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_build%2Fsrc%2Fbuild%2Fexpr%2Fstmt.rs?ref=d6c737adb50e194beca9cf0c0a87037738ae8a58", "patch": "@@ -141,12 +141,12 @@ impl<'a, 'tcx> Builder<'a, 'tcx> {\n                     if let ExprKind::Block { body } = &expr.kind {\n                         if let Some(tail_expr) = &body.expr {\n                             let mut expr = &*tail_expr;\n-                            while let ExprKind::Block { body: subblock } = &expr.kind {\n-                                if let Some(subtail_expr) = &subblock.expr {\n-                                    expr = subtail_expr\n-                                } else {\n-                                    break;\n-                                }\n+                            while let ExprKind::Block {\n+                                body: Block { expr: Some(nested_expr), .. },\n+                            }\n+                            | ExprKind::Scope { value: nested_expr, .. } = &expr.kind\n+                            {\n+                                expr = nested_expr;\n                             }\n                             this.block_context.push(BlockFrame::TailExpr {\n                                 tail_result_is_ignored: true,"}]}