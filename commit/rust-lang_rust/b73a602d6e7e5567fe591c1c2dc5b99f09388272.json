{"sha": "b73a602d6e7e5567fe591c1c2dc5b99f09388272", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI3M2E2MDJkNmU3ZTU1NjdmZTU5MWMxYzJkYzViOTlmMDkzODgyNzI=", "commit": {"author": {"name": "St\u00e9phane Campinas", "email": "stephane.campinas@gmail.com", "date": "2018-12-14T08:48:20Z"}, "committer": {"name": "St\u00e9phane Campinas", "email": "stephane.campinas@gmail.com", "date": "2018-12-14T08:54:23Z"}, "message": "version-gate the trailing semicolon change of return statements inside a match arm", "tree": {"sha": "df7c865c65406af837659717b899b9009e698517", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/df7c865c65406af837659717b899b9009e698517"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b73a602d6e7e5567fe591c1c2dc5b99f09388272", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCgAdFiEEipi5pnt+pUplKNfibVYg2QghATMFAlwTb78ACgkQbVYg2Qgh\nATOQkAgA0krSBc6J6nnItBzePMYLMv9quSUksP7mRWRqciBA0iAcdB9vBXTe5PSX\nlSLr/ZzKH343gjtUejv6bH5k45CKxYglewsPy4VmZDNmWiN+KvmBQVoVmKkGn7Fh\nWIH24eta9LsIWbBLPsbWpJm0F2egSSvRJh8yr6fL6Ql0cK3/7+xZ4/DmtgETid8p\nqfx/oPdb87DIHA+mEq64NPb8P/IGkRl550Ul5iGdNuLuOEIeK7iFw5SD7qdHLRp0\nQgPV82Dt6ePettpq8C8kFCpBZxQTpVpToQILwHDklLVSo46pmTnHUH2ceWfCM1j7\nhsN8GS+xYJsA03YgC1S0la+eZUBluA==\n=+D15\n-----END PGP SIGNATURE-----", "payload": "tree df7c865c65406af837659717b899b9009e698517\nparent 66c98db50f58aa97be7bdd34af136ad258c6e04c\nauthor St\u00e9phane Campinas <stephane.campinas@gmail.com> 1544777300 +0100\ncommitter St\u00e9phane Campinas <stephane.campinas@gmail.com> 1544777663 +0100\n\nversion-gate the trailing semicolon change of return statements inside a match arm\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b73a602d6e7e5567fe591c1c2dc5b99f09388272", "html_url": "https://github.com/rust-lang/rust/commit/b73a602d6e7e5567fe591c1c2dc5b99f09388272", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b73a602d6e7e5567fe591c1c2dc5b99f09388272/comments", "author": {"login": "scampi", "id": 795879, "node_id": "MDQ6VXNlcjc5NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/795879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scampi", "html_url": "https://github.com/scampi", "followers_url": "https://api.github.com/users/scampi/followers", "following_url": "https://api.github.com/users/scampi/following{/other_user}", "gists_url": "https://api.github.com/users/scampi/gists{/gist_id}", "starred_url": "https://api.github.com/users/scampi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scampi/subscriptions", "organizations_url": "https://api.github.com/users/scampi/orgs", "repos_url": "https://api.github.com/users/scampi/repos", "events_url": "https://api.github.com/users/scampi/events{/privacy}", "received_events_url": "https://api.github.com/users/scampi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "scampi", "id": 795879, "node_id": "MDQ6VXNlcjc5NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/795879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scampi", "html_url": "https://github.com/scampi", "followers_url": "https://api.github.com/users/scampi/followers", "following_url": "https://api.github.com/users/scampi/following{/other_user}", "gists_url": "https://api.github.com/users/scampi/gists{/gist_id}", "starred_url": "https://api.github.com/users/scampi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scampi/subscriptions", "organizations_url": "https://api.github.com/users/scampi/orgs", "repos_url": "https://api.github.com/users/scampi/repos", "events_url": "https://api.github.com/users/scampi/events{/privacy}", "received_events_url": "https://api.github.com/users/scampi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "66c98db50f58aa97be7bdd34af136ad258c6e04c", "url": "https://api.github.com/repos/rust-lang/rust/commits/66c98db50f58aa97be7bdd34af136ad258c6e04c", "html_url": "https://github.com/rust-lang/rust/commit/66c98db50f58aa97be7bdd34af136ad258c6e04c"}], "stats": {"total": 39, "additions": 33, "deletions": 6}, "files": [{"sha": "14733eece868e5e11e553fb135a10ae782e6a6d9", "filename": "src/matches.rs", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/b73a602d6e7e5567fe591c1c2dc5b99f09388272/src%2Fmatches.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b73a602d6e7e5567fe591c1c2dc5b99f09388272/src%2Fmatches.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmatches.rs?ref=b73a602d6e7e5567fe591c1c2dc5b99f09388272", "patch": "@@ -17,7 +17,7 @@ use syntax::source_map::{BytePos, Span};\n use syntax::{ast, ptr};\n \n use comment::{combine_strs_with_missing_comments, rewrite_comment};\n-use config::{Config, ControlBraceStyle, IndentStyle};\n+use config::{Config, ControlBraceStyle, IndentStyle, Version};\n use expr::{\n     format_expr, is_empty_block, is_simple_block, is_unsafe_block, prefer_next_line, rewrite_cond,\n     rewrite_multiple_patterns, ExprType, RhsTactics,\n@@ -413,11 +413,12 @@ fn rewrite_match_body(\n             } else {\n                 \"\"\n             };\n-            let semicolon = if semicolon_for_expr(context, body) {\n-                \";\"\n-            } else {\n-                \"\"\n-            };\n+            let semicolon =\n+                if context.config.version() == Version::Two && semicolon_for_expr(context, body) {\n+                    \";\"\n+                } else {\n+                    \"\"\n+                };\n             (\"{\", format!(\"{}{}}}{}\", semicolon, indent_str, comma))\n         } else {\n             (\"\", String::from(\",\"))"}, {"sha": "f9f4cab55e3254d5b2cf444948b18673e98d10c0", "filename": "tests/source/issue-3213/version_one.rs", "status": "renamed", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b73a602d6e7e5567fe591c1c2dc5b99f09388272/tests%2Fsource%2Fissue-3213%2Fversion_one.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b73a602d6e7e5567fe591c1c2dc5b99f09388272/tests%2Fsource%2Fissue-3213%2Fversion_one.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fissue-3213%2Fversion_one.rs?ref=b73a602d6e7e5567fe591c1c2dc5b99f09388272", "patch": "@@ -1,3 +1,5 @@\n+// rustfmt-version: One\n+\n fn foo() {\n     match 0 {\n         0 => return AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,", "previous_filename": "tests/source/issue-3213.rs"}, {"sha": "0f068c19d7446b55a355a110cc62715af5ffaee2", "filename": "tests/source/issue-3213/version_two.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/b73a602d6e7e5567fe591c1c2dc5b99f09388272/tests%2Fsource%2Fissue-3213%2Fversion_two.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b73a602d6e7e5567fe591c1c2dc5b99f09388272/tests%2Fsource%2Fissue-3213%2Fversion_two.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fissue-3213%2Fversion_two.rs?ref=b73a602d6e7e5567fe591c1c2dc5b99f09388272", "patch": "@@ -0,0 +1,9 @@\n+// rustfmt-version: Two\n+\n+fn foo() {\n+    match 0 {\n+        0 => return AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,\n+        1 => AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,\n+        _ => \"\",\n+    };\n+}"}, {"sha": "307903b128b848bc44f4d2ba792f8dc49f119c9e", "filename": "tests/target/issue-3213/version_one.rs", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/b73a602d6e7e5567fe591c1c2dc5b99f09388272/tests%2Ftarget%2Fissue-3213%2Fversion_one.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b73a602d6e7e5567fe591c1c2dc5b99f09388272/tests%2Ftarget%2Fissue-3213%2Fversion_one.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-3213%2Fversion_one.rs?ref=b73a602d6e7e5567fe591c1c2dc5b99f09388272", "patch": "@@ -0,0 +1,13 @@\n+// rustfmt-version: One\n+\n+fn foo() {\n+    match 0 {\n+        0 => {\n+            return AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n+        }\n+        1 => {\n+            AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n+        }\n+        _ => \"\",\n+    };\n+}"}, {"sha": "de93d04ba95085648d2088ea2e6fd734895cb147", "filename": "tests/target/issue-3213/version_two.rs", "status": "renamed", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b73a602d6e7e5567fe591c1c2dc5b99f09388272/tests%2Ftarget%2Fissue-3213%2Fversion_two.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b73a602d6e7e5567fe591c1c2dc5b99f09388272/tests%2Ftarget%2Fissue-3213%2Fversion_two.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-3213%2Fversion_two.rs?ref=b73a602d6e7e5567fe591c1c2dc5b99f09388272", "patch": "@@ -1,3 +1,5 @@\n+// rustfmt-version: Two\n+\n fn foo() {\n     match 0 {\n         0 => {", "previous_filename": "tests/target/issue-3213.rs"}]}