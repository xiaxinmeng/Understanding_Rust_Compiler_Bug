{"sha": "b92602ba692b03cc2f959f1927b4f909eb5e3fcc", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI5MjYwMmJhNjkyYjAzY2MyZjk1OWYxOTI3YjRmOTA5ZWI1ZTNmY2M=", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2020-06-21T09:20:48Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2020-06-21T09:47:19Z"}, "message": "Make is_freeze and is_copy_modulo_regions take TyCtxtAt", "tree": {"sha": "d01694e2f4ae9c6753d21f59e88ca38db79860b2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d01694e2f4ae9c6753d21f59e88ca38db79860b2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b92602ba692b03cc2f959f1927b4f909eb5e3fcc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b92602ba692b03cc2f959f1927b4f909eb5e3fcc", "html_url": "https://github.com/rust-lang/rust/commit/b92602ba692b03cc2f959f1927b4f909eb5e3fcc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b92602ba692b03cc2f959f1927b4f909eb5e3fcc/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "922ff8e485fc6d95286fcf860e05742dc8797223", "url": "https://api.github.com/repos/rust-lang/rust/commits/922ff8e485fc6d95286fcf860e05742dc8797223", "html_url": "https://github.com/rust-lang/rust/commit/922ff8e485fc6d95286fcf860e05742dc8797223"}], "stats": {"total": 13, "additions": 6, "deletions": 7}, "files": [{"sha": "1f9bd7a691b520bed9c788980974d3050d14e69d", "filename": "clippy_lints/src/functions.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b92602ba692b03cc2f959f1927b4f909eb5e3fcc/clippy_lints%2Fsrc%2Ffunctions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b92602ba692b03cc2f959f1927b4f909eb5e3fcc/clippy_lints%2Fsrc%2Ffunctions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Ffunctions.rs?ref=b92602ba692b03cc2f959f1927b4f909eb5e3fcc", "patch": "@@ -513,7 +513,7 @@ fn is_mutable_ty<'a, 'tcx>(cx: &LateContext<'a, 'tcx>, ty: Ty<'tcx>, span: Span,\n         // primitive types are never mutable\n         ty::Bool | ty::Char | ty::Int(_) | ty::Uint(_) | ty::Float(_) | ty::Str => false,\n         ty::Adt(ref adt, ref substs) => {\n-            tys.insert(adt.did) && !ty.is_freeze(cx.tcx, cx.param_env, span)\n+            tys.insert(adt.did) && !ty.is_freeze(cx.tcx.at(span), cx.param_env)\n                 || KNOWN_WRAPPER_TYS.iter().any(|path| match_def_path(cx, adt.did, path))\n                     && substs.types().any(|ty| is_mutable_ty(cx, ty, span, tys))\n         },"}, {"sha": "e097f40f87e47c4b13084141de3e89b840b89232", "filename": "clippy_lints/src/let_if_seq.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/b92602ba692b03cc2f959f1927b4f909eb5e3fcc/clippy_lints%2Fsrc%2Flet_if_seq.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b92602ba692b03cc2f959f1927b4f909eb5e3fcc/clippy_lints%2Fsrc%2Flet_if_seq.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flet_if_seq.rs?ref=b92602ba692b03cc2f959f1927b4f909eb5e3fcc", "patch": "@@ -74,9 +74,8 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for LetIfSeq {\n                     let span = stmt.span.to(if_.span);\n \n                     let has_interior_mutability = !cx.tables.node_type(canonical_id).is_freeze(\n-                        cx.tcx,\n+                        cx.tcx.at(span),\n                         cx.param_env,\n-                        span\n                     );\n                     if has_interior_mutability { return; }\n "}, {"sha": "93569a04f7a3a23b151b70b28752f912d6cacf23", "filename": "clippy_lints/src/mut_key.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b92602ba692b03cc2f959f1927b4f909eb5e3fcc/clippy_lints%2Fsrc%2Fmut_key.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b92602ba692b03cc2f959f1927b4f909eb5e3fcc/clippy_lints%2Fsrc%2Fmut_key.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmut_key.rs?ref=b92602ba692b03cc2f959f1927b4f909eb5e3fcc", "patch": "@@ -118,7 +118,7 @@ fn is_mutable_type<'a, 'tcx>(cx: &LateContext<'a, 'tcx>, ty: Ty<'tcx>, span: Spa\n             size.try_eval_usize(cx.tcx, cx.param_env).map_or(true, |u| u != 0) && is_mutable_type(cx, inner_ty, span)\n         },\n         Tuple(..) => ty.tuple_fields().any(|ty| is_mutable_type(cx, ty, span)),\n-        Adt(..) => cx.tcx.layout_of(cx.param_env.and(ty)).is_ok() && !ty.is_freeze(cx.tcx, cx.param_env, span),\n+        Adt(..) => cx.tcx.layout_of(cx.param_env.and(ty)).is_ok() && !ty.is_freeze(cx.tcx.at(span), cx.param_env),\n         _ => false,\n     }\n }"}, {"sha": "230dfd2ebf5661c3dd768225627bc5b4199fd93d", "filename": "clippy_lints/src/non_copy_const.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b92602ba692b03cc2f959f1927b4f909eb5e3fcc/clippy_lints%2Fsrc%2Fnon_copy_const.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b92602ba692b03cc2f959f1927b4f909eb5e3fcc/clippy_lints%2Fsrc%2Fnon_copy_const.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fnon_copy_const.rs?ref=b92602ba692b03cc2f959f1927b4f909eb5e3fcc", "patch": "@@ -110,7 +110,7 @@ impl Source {\n }\n \n fn verify_ty_bound<'a, 'tcx>(cx: &LateContext<'a, 'tcx>, ty: Ty<'tcx>, source: Source) {\n-    if ty.is_freeze(cx.tcx, cx.param_env, DUMMY_SP) || is_copy(cx, ty) {\n+    if ty.is_freeze(cx.tcx.at(DUMMY_SP), cx.param_env) || is_copy(cx, ty) {\n         // An `UnsafeCell` is `!Copy`, and an `UnsafeCell` is also the only type which\n         // is `!Freeze`, thus if our type is `Copy` we can be sure it must be `Freeze`\n         // as well."}, {"sha": "d8a73f8054bcaa0dff4509fd060d686b24a89ee2", "filename": "clippy_lints/src/question_mark.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b92602ba692b03cc2f959f1927b4f909eb5e3fcc/clippy_lints%2Fsrc%2Fquestion_mark.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b92602ba692b03cc2f959f1927b4f909eb5e3fcc/clippy_lints%2Fsrc%2Fquestion_mark.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fquestion_mark.rs?ref=b92602ba692b03cc2f959f1927b4f909eb5e3fcc", "patch": "@@ -137,7 +137,7 @@ impl QuestionMark {\n     fn moves_by_default(cx: &LateContext<'_, '_>, expression: &Expr<'_>) -> bool {\n         let expr_ty = cx.tables.expr_ty(expression);\n \n-        !expr_ty.is_copy_modulo_regions(cx.tcx, cx.param_env, expression.span)\n+        !expr_ty.is_copy_modulo_regions(cx.tcx.at(expression.span), cx.param_env)\n     }\n \n     fn is_option(cx: &LateContext<'_, '_>, expression: &Expr<'_>) -> bool {"}, {"sha": "6d4c6c6ce1ceada7c78195219f454e35374ccc3f", "filename": "clippy_lints/src/utils/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b92602ba692b03cc2f959f1927b4f909eb5e3fcc/clippy_lints%2Fsrc%2Futils%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b92602ba692b03cc2f959f1927b4f909eb5e3fcc/clippy_lints%2Fsrc%2Futils%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Fmod.rs?ref=b92602ba692b03cc2f959f1927b4f909eb5e3fcc", "patch": "@@ -891,7 +891,7 @@ pub fn type_is_unsafe_function<'a, 'tcx>(cx: &LateContext<'a, 'tcx>, ty: Ty<'tcx\n }\n \n pub fn is_copy<'a, 'tcx>(cx: &LateContext<'a, 'tcx>, ty: Ty<'tcx>) -> bool {\n-    ty.is_copy_modulo_regions(cx.tcx, cx.param_env, DUMMY_SP)\n+    ty.is_copy_modulo_regions(cx.tcx.at(DUMMY_SP), cx.param_env)\n }\n \n /// Checks if an expression is constructing a tuple-like enum variant or struct"}]}