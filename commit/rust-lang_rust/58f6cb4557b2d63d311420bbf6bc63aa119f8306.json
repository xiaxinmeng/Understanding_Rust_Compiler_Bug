{"sha": "58f6cb4557b2d63d311420bbf6bc63aa119f8306", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU4ZjZjYjQ1NTdiMmQ2M2QzMTE0MjBiYmY2YmM2M2FhMTE5ZjgzMDY=", "commit": {"author": {"name": "Yuki Okushi", "email": "yuki.okushi@huawei.com", "date": "2021-07-02T17:13:17Z"}, "committer": {"name": "Yuki Okushi", "email": "yuki.okushi@huawei.com", "date": "2021-07-02T17:21:19Z"}, "message": "Simplify `visit_region` implementation", "tree": {"sha": "b662ce82c78a04691f862a8fd7dad2ff427e6ba0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b662ce82c78a04691f862a8fd7dad2ff427e6ba0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/58f6cb4557b2d63d311420bbf6bc63aa119f8306", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEx6scKn6IIf/+FpBu2rpbBylhwYoFAmDfSw8ACgkQ2rpbBylh\nwYrcwQ/+PD6heHLXZ9BzOHt3Jz7/q0ykggJs6g9cOzIfpRtzmx4XNYHqYxBda+sP\nd9L3G/uZM2dr3aZC9Z9YT6xG+aRWubF/1EVzo4sPEtqN1y9yfwMu283GAiEaEhq2\nMvisbUMT7vl80nBVsMvOSpIcYAn+fsSdlo+bmPMI2cKMWdJWeCDYyIQpcQlt6QVA\nSHMaquNYtKBCPCzXzB492wQMNsFN1OojqbVDpUAWlqL/Fqr9pOdI7bAiqUO/15n0\nifeXVqRoI0xGSdqL4eq0PDpuyL6YnR1VHhyjJpZj6MBUb+0E9qxTN5DS01hEzW/3\ngSu3NAIAUI2R42gVazXCcODwV5nDfOirvWhM5hhfnrdEmqBKBnHTik+8p5mxOezM\nRCCzfZ7V++aoC8GiGf0qxs7a3VlcRpLm1uJCU8PbehG29G4XDA7RWUKPeWA/wbED\ntsyoRUZTD7PUDAHEXL2zwHBBwPO2LUzaEFYpXViiwCsW/ixA0R1hjTXUdSMT4Uqr\no360jQRiPJ8l2evF3VkaxI0FQ6kfaCIZhva61cJoYXH4GJKgT1tqhiWRoEz17/t0\nW5ywKrytoDAmDxEaqnzjwqh8ySJSM9wkfwx6bCNZetpWOXoqXVjUK0FLY1yJ1PiH\nTJxKb9Mj4tNdra+PQhxwGIjLAn/vh4MYcOqEyS3binvn1j0lzFI=\n=sV7C\n-----END PGP SIGNATURE-----", "payload": "tree b662ce82c78a04691f862a8fd7dad2ff427e6ba0\nparent 884053a4b422e63a78eddd7b49793c32020d321b\nauthor Yuki Okushi <yuki.okushi@huawei.com> 1625245997 +0900\ncommitter Yuki Okushi <yuki.okushi@huawei.com> 1625246479 +0900\n\nSimplify `visit_region` implementation\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/58f6cb4557b2d63d311420bbf6bc63aa119f8306", "html_url": "https://github.com/rust-lang/rust/commit/58f6cb4557b2d63d311420bbf6bc63aa119f8306", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/58f6cb4557b2d63d311420bbf6bc63aa119f8306/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "884053a4b422e63a78eddd7b49793c32020d321b", "url": "https://api.github.com/repos/rust-lang/rust/commits/884053a4b422e63a78eddd7b49793c32020d321b", "html_url": "https://github.com/rust-lang/rust/commit/884053a4b422e63a78eddd7b49793c32020d321b"}], "stats": {"total": 18, "additions": 4, "deletions": 14}, "files": [{"sha": "469ac04e54515158fc9fff91fb8a245a0690fb8a", "filename": "compiler/rustc_ty_utils/src/instance.rs", "status": "modified", "additions": 4, "deletions": 13, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/58f6cb4557b2d63d311420bbf6bc63aa119f8306/compiler%2Frustc_ty_utils%2Fsrc%2Finstance.rs", "raw_url": "https://github.com/rust-lang/rust/raw/58f6cb4557b2d63d311420bbf6bc63aa119f8306/compiler%2Frustc_ty_utils%2Fsrc%2Finstance.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ty_utils%2Fsrc%2Finstance.rs?ref=58f6cb4557b2d63d311420bbf6bc63aa119f8306", "patch": "@@ -9,6 +9,7 @@ use rustc_trait_selection::traits;\n use traits::{translate_substs, Reveal};\n \n use rustc_data_structures::sso::SsoHashSet;\n+use std::collections::btree_map::Entry;\n use std::collections::BTreeMap;\n use std::ops::ControlFlow;\n \n@@ -69,7 +70,6 @@ impl<'tcx> TypeVisitor<'tcx> for BoundVarsCollector<'tcx> {\n         {\n             return ControlFlow::CONTINUE;\n         }\n-        use std::collections::btree_map::Entry;\n         match *t.kind() {\n             ty::Bound(debruijn, bound_ty) if debruijn == self.binder_index => {\n                 match self.vars.entry(bound_ty.var.as_u32()) {\n@@ -90,27 +90,18 @@ impl<'tcx> TypeVisitor<'tcx> for BoundVarsCollector<'tcx> {\n     }\n \n     fn visit_region(&mut self, r: ty::Region<'tcx>) -> ControlFlow<Self::BreakTy> {\n-        use std::collections::btree_map::Entry;\n         match r {\n-            ty::ReLateBound(index, br) if *index == self.binder_index => match br.kind {\n-                ty::BrNamed(_def_id, _name) => {\n-                    // FIXME\n-                }\n-\n-                ty::BrAnon(var) => match self.vars.entry(var) {\n+            ty::ReLateBound(index, br) if *index == self.binder_index => {\n+                match self.vars.entry(br.var.as_u32()) {\n                     Entry::Vacant(entry) => {\n                         entry.insert(ty::BoundVariableKind::Region(br.kind));\n                     }\n                     Entry::Occupied(entry) => match entry.get() {\n                         ty::BoundVariableKind::Region(_) => {}\n                         _ => bug!(\"Conflicting bound vars\"),\n                     },\n-                },\n-\n-                ty::BrEnv => {\n-                    // FIXME\n                 }\n-            },\n+            }\n \n             _ => (),\n         };"}, {"sha": "0e063c86f2f4eb208aab39215388a5eb81570140", "filename": "compiler/rustc_typeck/src/check/wfcheck.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/58f6cb4557b2d63d311420bbf6bc63aa119f8306/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fwfcheck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/58f6cb4557b2d63d311420bbf6bc63aa119f8306/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fwfcheck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fwfcheck.rs?ref=58f6cb4557b2d63d311420bbf6bc63aa119f8306", "patch": "@@ -1087,7 +1087,6 @@ fn check_method_receiver<'fcx, 'tcx>(\n     debug!(\"check_method_receiver: sig={:?}\", sig);\n \n     let self_ty = fcx.normalize_associated_types_in(span, self_ty);\n-    let self_ty = fcx.tcx.liberate_late_bound_regions(method.def_id, ty::Binder::dummy(self_ty));\n \n     let receiver_ty = sig.inputs()[0];\n     let receiver_ty = fcx.normalize_associated_types_in(span, receiver_ty);"}]}