{"sha": "bbedbc04507ea3a1e87905c4b37c3460b5de1746", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJiZWRiYzA0NTA3ZWEzYTFlODc5MDVjNGIzN2MzNDYwYjVkZTE3NDY=", "commit": {"author": {"name": "Erick Tryzelaar", "email": "erick.tryzelaar@gmail.com", "date": "2013-07-23T16:54:28Z"}, "committer": {"name": "Erick Tryzelaar", "email": "erick.tryzelaar@gmail.com", "date": "2013-07-23T23:57:00Z"}, "message": "std: inline str::with_capacity and vec::with_capacity", "tree": {"sha": "6d6ae7a09477ec8118ac42ba691cb7be5612ba40", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6d6ae7a09477ec8118ac42ba691cb7be5612ba40"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bbedbc04507ea3a1e87905c4b37c3460b5de1746", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bbedbc04507ea3a1e87905c4b37c3460b5de1746", "html_url": "https://github.com/rust-lang/rust/commit/bbedbc04507ea3a1e87905c4b37c3460b5de1746", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bbedbc04507ea3a1e87905c4b37c3460b5de1746/comments", "author": {"login": "erickt", "id": 84711, "node_id": "MDQ6VXNlcjg0NzEx", "avatar_url": "https://avatars.githubusercontent.com/u/84711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erickt", "html_url": "https://github.com/erickt", "followers_url": "https://api.github.com/users/erickt/followers", "following_url": "https://api.github.com/users/erickt/following{/other_user}", "gists_url": "https://api.github.com/users/erickt/gists{/gist_id}", "starred_url": "https://api.github.com/users/erickt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erickt/subscriptions", "organizations_url": "https://api.github.com/users/erickt/orgs", "repos_url": "https://api.github.com/users/erickt/repos", "events_url": "https://api.github.com/users/erickt/events{/privacy}", "received_events_url": "https://api.github.com/users/erickt/received_events", "type": "User", "site_admin": false}, "committer": {"login": "erickt", "id": 84711, "node_id": "MDQ6VXNlcjg0NzEx", "avatar_url": "https://avatars.githubusercontent.com/u/84711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erickt", "html_url": "https://github.com/erickt", "followers_url": "https://api.github.com/users/erickt/followers", "following_url": "https://api.github.com/users/erickt/following{/other_user}", "gists_url": "https://api.github.com/users/erickt/gists{/gist_id}", "starred_url": "https://api.github.com/users/erickt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erickt/subscriptions", "organizations_url": "https://api.github.com/users/erickt/orgs", "repos_url": "https://api.github.com/users/erickt/repos", "events_url": "https://api.github.com/users/erickt/events{/privacy}", "received_events_url": "https://api.github.com/users/erickt/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cced3c9013e4f8e1202b6088f9d3b564e40cac40", "url": "https://api.github.com/repos/rust-lang/rust/commits/cced3c9013e4f8e1202b6088f9d3b564e40cac40", "html_url": "https://github.com/rust-lang/rust/commit/cced3c9013e4f8e1202b6088f9d3b564e40cac40"}], "stats": {"total": 9, "additions": 4, "deletions": 5}, "files": [{"sha": "0d2cfa2e1e8fa660f29bf7a0c451eac7823869c1", "filename": "src/libstd/str.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/bbedbc04507ea3a1e87905c4b37c3460b5de1746/src%2Flibstd%2Fstr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bbedbc04507ea3a1e87905c4b37c3460b5de1746/src%2Flibstd%2Fstr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fstr.rs?ref=bbedbc04507ea3a1e87905c4b37c3460b5de1746", "patch": "@@ -180,9 +180,7 @@ impl<'self, S: Str> StrVector for &'self [S] {\n \n         let len = self.iter().transform(|s| s.as_slice().len()).sum();\n \n-        let mut s = ~\"\";\n-\n-        s.reserve(len);\n+        let mut s = with_capacity(len);\n \n         unsafe {\n             do s.as_mut_buf |buf, _| {\n@@ -678,6 +676,7 @@ pub fn from_utf16(v: &[u16]) -> ~str {\n  * Allocates a new string with the specified capacity. The string returned is\n  * the empty string, but has capacity for much more.\n  */\n+#[inline]\n pub fn with_capacity(capacity: uint) -> ~str {\n     let mut buf = ~\"\";\n     buf.reserve(capacity);\n@@ -1830,10 +1829,9 @@ impl<'self> StrSlice<'self> for &'self str {\n     /// Given a string, make a new string with repeated copies of it.\n     fn repeat(&self, nn: uint) -> ~str {\n         do self.as_imm_buf |buf, len| {\n-            let mut ret = ~\"\";\n             // ignore the NULL terminator\n             let len = len - 1;\n-            ret.reserve(nn * len);\n+            let mut ret = with_capacity(nn * len);\n \n             unsafe {\n                 do ret.as_mut_buf |rbuf, _len| {"}, {"sha": "cc41f0dbb941cfd07885a686a02e19b6a3c1a16d", "filename": "src/libstd/vec.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/bbedbc04507ea3a1e87905c4b37c3460b5de1746/src%2Flibstd%2Fvec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bbedbc04507ea3a1e87905c4b37c3460b5de1746/src%2Flibstd%2Fvec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fvec.rs?ref=bbedbc04507ea3a1e87905c4b37c3460b5de1746", "patch": "@@ -87,6 +87,7 @@ pub fn from_elem<T:Clone>(n_elts: uint, t: T) -> ~[T] {\n }\n \n /// Creates a new vector with a capacity of `capacity`\n+#[inline]\n pub fn with_capacity<T>(capacity: uint) -> ~[T] {\n     unsafe {\n         if contains_managed::<T>() {"}]}