{"sha": "a66780bc3fb87b33b31e39cb4a3e34de1a80deaa", "node_id": "C_kwDOAAsO6NoAKGE2Njc4MGJjM2ZiODdiMzNiMzFlMzljYjRhM2UzNGRlMWE4MGRlYWE", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-12-11T18:22:55Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-12-12T10:00:47Z"}, "message": "More host/target path conversion tests:\n\n- test that the tmpdir Miri tests see is absolute and a directory\n- test that current_dir returns an absolute path", "tree": {"sha": "59ec9bc5a5450d7bb2f3f6aec527a6a935aa78db", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/59ec9bc5a5450d7bb2f3f6aec527a6a935aa78db"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a66780bc3fb87b33b31e39cb4a3e34de1a80deaa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a66780bc3fb87b33b31e39cb4a3e34de1a80deaa", "html_url": "https://github.com/rust-lang/rust/commit/a66780bc3fb87b33b31e39cb4a3e34de1a80deaa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a66780bc3fb87b33b31e39cb4a3e34de1a80deaa/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c19ca083ee79ffa49404b88f2172936fac831e25", "url": "https://api.github.com/repos/rust-lang/rust/commits/c19ca083ee79ffa49404b88f2172936fac831e25", "html_url": "https://github.com/rust-lang/rust/commit/c19ca083ee79ffa49404b88f2172936fac831e25"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "ca90912eabc54c038ef506f011ce3edc2e03dd7b", "filename": "src/tools/miri/tests/pass/shims/env/current_dir.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/a66780bc3fb87b33b31e39cb4a3e34de1a80deaa/src%2Ftools%2Fmiri%2Ftests%2Fpass%2Fshims%2Fenv%2Fcurrent_dir.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a66780bc3fb87b33b31e39cb4a3e34de1a80deaa/src%2Ftools%2Fmiri%2Ftests%2Fpass%2Fshims%2Fenv%2Fcurrent_dir.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiri%2Ftests%2Fpass%2Fshims%2Fenv%2Fcurrent_dir.rs?ref=a66780bc3fb87b33b31e39cb4a3e34de1a80deaa", "patch": "@@ -3,8 +3,9 @@ use std::env;\n use std::io::ErrorKind;\n \n fn main() {\n-    // Test that `getcwd` is available\n+    // Test that `getcwd` is available and an absolute path\n     let cwd = env::current_dir().unwrap();\n+    assert!(cwd.is_absolute(), \"cwd {:?} is not absolute\", cwd);\n     // Test that changing dir to `..` actually sets the current directory to the parent of `cwd`.\n     // The only exception here is if `cwd` is the root directory, then changing directory must\n     // keep the current directory equal to `cwd`."}, {"sha": "e3ebbc8c8d29f356ddb6d9cb0a7fdd8ef1d16f08", "filename": "src/tools/miri/tests/pass/shims/fs.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/a66780bc3fb87b33b31e39cb4a3e34de1a80deaa/src%2Ftools%2Fmiri%2Ftests%2Fpass%2Fshims%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a66780bc3fb87b33b31e39cb4a3e34de1a80deaa/src%2Ftools%2Fmiri%2Ftests%2Fpass%2Fshims%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fmiri%2Ftests%2Fpass%2Fshims%2Ffs.rs?ref=a66780bc3fb87b33b31e39cb4a3e34de1a80deaa", "patch": "@@ -28,6 +28,7 @@ fn main() {\n     test_directory();\n     test_canonicalize();\n     test_from_raw_os_error();\n+    test_path_conversion();\n }\n \n fn tmp() -> PathBuf {\n@@ -74,6 +75,12 @@ fn prepare_with_content(filename: &str, content: &[u8]) -> PathBuf {\n     path\n }\n \n+fn test_path_conversion() {\n+    let tmp = tmp();\n+    assert!(tmp.is_absolute(), \"{:?} is not absolute\", tmp);\n+    assert!(tmp.is_dir(), \"{:?} is not a directory\", tmp);\n+}\n+\n fn test_file() {\n     let bytes = b\"Hello, World!\\n\";\n     let path = prepare(\"miri_test_fs_file.txt\");"}]}