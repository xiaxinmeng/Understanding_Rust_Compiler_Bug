{"sha": "bc51f8783cdbee5a1ed121f017ec7360d9be9124", "node_id": "C_kwDOAAsO6NoAKGJjNTFmODc4M2NkYmVlNWExZWQxMjFmMDE3ZWM3MzYwZDliZTkxMjQ", "commit": {"author": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2022-11-11T14:31:07Z"}, "committer": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2022-11-18T06:16:20Z"}, "message": "rename to `string_deref_patterns`", "tree": {"sha": "99e6168b33feb285042553ab6bbcc546856967fb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/99e6168b33feb285042553ab6bbcc546856967fb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bc51f8783cdbee5a1ed121f017ec7360d9be9124", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bc51f8783cdbee5a1ed121f017ec7360d9be9124", "html_url": "https://github.com/rust-lang/rust/commit/bc51f8783cdbee5a1ed121f017ec7360d9be9124", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bc51f8783cdbee5a1ed121f017ec7360d9be9124/comments", "author": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "64a17a09a87118fdb80dae8bf993692d18ea9fa2", "url": "https://api.github.com/repos/rust-lang/rust/commits/64a17a09a87118fdb80dae8bf993692d18ea9fa2", "html_url": "https://github.com/rust-lang/rust/commit/64a17a09a87118fdb80dae8bf993692d18ea9fa2"}], "stats": {"total": 22, "additions": 11, "deletions": 11}, "files": [{"sha": "ae49a76a087838bf60d316f0cdd12dee2308b89b", "filename": "compiler/rustc_feature/src/active.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/bc51f8783cdbee5a1ed121f017ec7360d9be9124/compiler%2Frustc_feature%2Fsrc%2Factive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bc51f8783cdbee5a1ed121f017ec7360d9be9124/compiler%2Frustc_feature%2Fsrc%2Factive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Factive.rs?ref=bc51f8783cdbee5a1ed121f017ec7360d9be9124", "patch": "@@ -376,8 +376,6 @@ declare_features! (\n     (active, deprecated_safe, \"1.61.0\", Some(94978), None),\n     /// Allows having using `suggestion` in the `#[deprecated]` attribute.\n     (active, deprecated_suggestion, \"1.61.0\", Some(94785), None),\n-    /// Allows patterns to dereference values to match them.\n-    (active, deref_patterns, \"1.64.0\", Some(87121), None),\n     /// Tells rustdoc to automatically generate `#[doc(cfg(...))]`.\n     (active, doc_auto_cfg, \"1.58.0\", Some(43781), None),\n     /// Allows `#[doc(cfg(...))]`.\n@@ -508,6 +506,8 @@ declare_features! (\n     (active, stmt_expr_attributes, \"1.6.0\", Some(15701), None),\n     /// Allows lints part of the strict provenance effort.\n     (active, strict_provenance, \"1.61.0\", Some(95228), None),\n+    /// Allows string patterns to dereference values to match them.\n+    (active, string_deref_patterns, \"CURRENT_RUSTC_VERSION\", Some(87121), None),\n     /// Allows the use of `#[target_feature]` on safe functions.\n     (active, target_feature_11, \"1.45.0\", Some(69098), None),\n     /// Allows using `#[thread_local]` on `static` items."}, {"sha": "4e3194501dc35892e56fec49ce77c06ea21cd2bf", "filename": "compiler/rustc_hir_typeck/src/pat.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bc51f8783cdbee5a1ed121f017ec7360d9be9124/compiler%2Frustc_hir_typeck%2Fsrc%2Fpat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bc51f8783cdbee5a1ed121f017ec7360d9be9124/compiler%2Frustc_hir_typeck%2Fsrc%2Fpat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_typeck%2Fsrc%2Fpat.rs?ref=bc51f8783cdbee5a1ed121f017ec7360d9be9124", "patch": "@@ -401,7 +401,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n             }\n         }\n \n-        if self.tcx.features().deref_patterns && let hir::ExprKind::Lit(Spanned { node: ast::LitKind::Str(..), .. }) = lt.kind {\n+        if self.tcx.features().string_deref_patterns && let hir::ExprKind::Lit(Spanned { node: ast::LitKind::Str(..), .. }) = lt.kind {\n             let tcx = self.tcx;\n             let expected = self.resolve_vars_if_possible(expected);\n             pat_ty = match expected.kind() {"}, {"sha": "af0d7879c576ac266741d0d58a2ac1ddd43b1af8", "filename": "compiler/rustc_mir_build/src/build/matches/test.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/bc51f8783cdbee5a1ed121f017ec7360d9be9124/compiler%2Frustc_mir_build%2Fsrc%2Fbuild%2Fmatches%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bc51f8783cdbee5a1ed121f017ec7360d9be9124/compiler%2Frustc_mir_build%2Fsrc%2Fbuild%2Fmatches%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_build%2Fsrc%2Fbuild%2Fmatches%2Ftest.rs?ref=bc51f8783cdbee5a1ed121f017ec7360d9be9124", "patch": "@@ -242,8 +242,8 @@ impl<'a, 'tcx> Builder<'a, 'tcx> {\n             TestKind::Eq { value, ty } => {\n                 let tcx = self.tcx;\n                 if let ty::Adt(def, _) = ty.kind() && Some(def.did()) == tcx.lang_items().string() {\n-                    if !tcx.features().deref_patterns {\n-                        bug!(\"matching on `String` went through without enabling deref_patterns\");\n+                    if !tcx.features().string_deref_patterns {\n+                        bug!(\"matching on `String` went through without enabling string_deref_patterns\");\n                     }\n                     let re_erased = tcx.lifetimes.re_erased;\n                     let ref_string = self.temp(tcx.mk_imm_ref(re_erased, ty), test.span);"}, {"sha": "ec393ce5030fdb2b3ade9d33b8a733e934e4eddb", "filename": "compiler/rustc_span/src/symbol.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bc51f8783cdbee5a1ed121f017ec7360d9be9124/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bc51f8783cdbee5a1ed121f017ec7360d9be9124/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs?ref=bc51f8783cdbee5a1ed121f017ec7360d9be9124", "patch": "@@ -597,7 +597,6 @@ symbols! {\n         deref,\n         deref_method,\n         deref_mut,\n-        deref_patterns,\n         deref_target,\n         derive,\n         derive_const,\n@@ -1406,6 +1405,7 @@ symbols! {\n         str_trim_end,\n         str_trim_start,\n         strict_provenance,\n+        string_deref_patterns,\n         stringify,\n         struct_field_attributes,\n         struct_inherit,"}, {"sha": "3a99c44aa0e18888100cd4b1e03d76fe3ddadc86", "filename": "src/test/mir-opt/deref-patterns/string.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bc51f8783cdbee5a1ed121f017ec7360d9be9124/src%2Ftest%2Fmir-opt%2Fderef-patterns%2Fstring.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bc51f8783cdbee5a1ed121f017ec7360d9be9124/src%2Ftest%2Fmir-opt%2Fderef-patterns%2Fstring.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Fderef-patterns%2Fstring.rs?ref=bc51f8783cdbee5a1ed121f017ec7360d9be9124", "patch": "@@ -1,6 +1,6 @@\n // compile-flags: -Z mir-opt-level=0 -C panic=abort\n \n-#![feature(deref_patterns)]\n+#![feature(string_deref_patterns)]\n #![crate_type = \"lib\"]\n \n // EMIT_MIR string.foo.PreCodegen.after.mir"}, {"sha": "249716040a17702a8a58669f1e0ef92fabc7da4e", "filename": "src/test/ui/deref-patterns/basic.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bc51f8783cdbee5a1ed121f017ec7360d9be9124/src%2Ftest%2Fui%2Fderef-patterns%2Fbasic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bc51f8783cdbee5a1ed121f017ec7360d9be9124/src%2Ftest%2Fui%2Fderef-patterns%2Fbasic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fderef-patterns%2Fbasic.rs?ref=bc51f8783cdbee5a1ed121f017ec7360d9be9124", "patch": "@@ -1,6 +1,6 @@\n // run-pass\n // check-run-results\n-#![feature(deref_patterns)]\n+#![feature(string_deref_patterns)]\n \n fn main() {\n     test(Some(String::from(\"42\")));"}, {"sha": "050b847305b16167e1fe8587501e2ef089b14f63", "filename": "src/test/ui/deref-patterns/default-infer.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bc51f8783cdbee5a1ed121f017ec7360d9be9124/src%2Ftest%2Fui%2Fderef-patterns%2Fdefault-infer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bc51f8783cdbee5a1ed121f017ec7360d9be9124/src%2Ftest%2Fui%2Fderef-patterns%2Fdefault-infer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fderef-patterns%2Fdefault-infer.rs?ref=bc51f8783cdbee5a1ed121f017ec7360d9be9124", "patch": "@@ -1,5 +1,5 @@\n // check-pass\n-#![feature(deref_patterns)]\n+#![feature(string_deref_patterns)]\n \n fn main() {\n     match <_ as Default>::default() {"}, {"sha": "ff50e30dea8c8935a9a6631726f458d53fae5381", "filename": "src/test/ui/deref-patterns/gate.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bc51f8783cdbee5a1ed121f017ec7360d9be9124/src%2Ftest%2Fui%2Fderef-patterns%2Fgate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bc51f8783cdbee5a1ed121f017ec7360d9be9124/src%2Ftest%2Fui%2Fderef-patterns%2Fgate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fderef-patterns%2Fgate.rs?ref=bc51f8783cdbee5a1ed121f017ec7360d9be9124", "patch": "@@ -1,4 +1,4 @@\n-// gate-test-deref_patterns\n+// gate-test-string_deref_patterns\n fn main() {\n     match String::new() {\n         \"\" | _ => {}"}, {"sha": "97e260d2752bb6eacd0b6506afba41a924c3d13f", "filename": "src/test/ui/deref-patterns/refs.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bc51f8783cdbee5a1ed121f017ec7360d9be9124/src%2Ftest%2Fui%2Fderef-patterns%2Frefs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bc51f8783cdbee5a1ed121f017ec7360d9be9124/src%2Ftest%2Fui%2Fderef-patterns%2Frefs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fderef-patterns%2Frefs.rs?ref=bc51f8783cdbee5a1ed121f017ec7360d9be9124", "patch": "@@ -1,5 +1,5 @@\n // check-pass\n-#![feature(deref_patterns)]\n+#![feature(string_deref_patterns)]\n \n fn foo(s: &String) -> i32 {\n     match *s {"}]}