{"sha": "2564199d8f50e1f6e5c915bf258999354c6f1262", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI1NjQxOTlkOGY1MGUxZjZlNWM5MTViZjI1ODk5OTM1NGM2ZjEyNjI=", "commit": {"author": {"name": "Michael Woerister", "email": "michaelwoerister@posteo.net", "date": "2016-05-05T18:32:59Z"}, "committer": {"name": "Michael Woerister", "email": "michaelwoerister@posteo.net", "date": "2016-05-09T20:17:00Z"}, "message": "trans: Make meth::get_vtable_methods() not depend on CrateContext.", "tree": {"sha": "982b76682ae51d24a070205d55981e103a919241", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/982b76682ae51d24a070205d55981e103a919241"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2564199d8f50e1f6e5c915bf258999354c6f1262", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2564199d8f50e1f6e5c915bf258999354c6f1262", "html_url": "https://github.com/rust-lang/rust/commit/2564199d8f50e1f6e5c915bf258999354c6f1262", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2564199d8f50e1f6e5c915bf258999354c6f1262/comments", "author": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "committer": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "100a4f5699eda98ad642adfb390cc8b8365c8aae", "url": "https://api.github.com/repos/rust-lang/rust/commits/100a4f5699eda98ad642adfb390cc8b8365c8aae", "html_url": "https://github.com/rust-lang/rust/commit/100a4f5699eda98ad642adfb390cc8b8365c8aae"}], "stats": {"total": 14, "additions": 6, "deletions": 8}, "files": [{"sha": "a431ecd6d708d56548f2cbb29c89a2944f83990a", "filename": "src/librustc_trans/collector.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2564199d8f50e1f6e5c915bf258999354c6f1262/src%2Flibrustc_trans%2Fcollector.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2564199d8f50e1f6e5c915bf258999354c6f1262/src%2Flibrustc_trans%2Fcollector.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fcollector.rs?ref=2564199d8f50e1f6e5c915bf258999354c6f1262", "patch": "@@ -1008,7 +1008,7 @@ fn create_trans_items_for_vtable_methods<'a, 'tcx>(ccx: &CrateContext<'a, 'tcx>,\n                         impl_def_id,\n                         substs,\n                         nested: _ }) => {\n-                    let items = meth::get_vtable_methods(ccx, impl_def_id, substs)\n+                    let items = meth::get_vtable_methods(ccx.tcx(), impl_def_id, substs)\n                         .into_iter()\n                         // filter out None values\n                         .filter_map(|opt_impl_method| opt_impl_method)"}, {"sha": "d08c26783e985e614902ccd3cb1ac9dfad26143a", "filename": "src/librustc_trans/meth.rs", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/2564199d8f50e1f6e5c915bf258999354c6f1262/src%2Flibrustc_trans%2Fmeth.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2564199d8f50e1f6e5c915bf258999354c6f1262/src%2Flibrustc_trans%2Fmeth.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fmeth.rs?ref=2564199d8f50e1f6e5c915bf258999354c6f1262", "patch": "@@ -157,7 +157,7 @@ pub fn get_vtable<'a, 'tcx>(ccx: &CrateContext<'a, 'tcx>,\n                     substs,\n                     nested: _ }) => {\n                 let nullptr = C_null(Type::nil(ccx).ptr_to());\n-                get_vtable_methods(ccx, id, substs)\n+                get_vtable_methods(tcx, id, substs)\n                     .into_iter()\n                     .map(|opt_mth| opt_mth.map_or(nullptr, |mth| {\n                         Callee::def(ccx, mth.method.def_id, &mth.substs).reify(ccx).val\n@@ -215,13 +215,11 @@ pub fn get_vtable<'a, 'tcx>(ccx: &CrateContext<'a, 'tcx>,\n     vtable\n }\n \n-pub fn get_vtable_methods<'a, 'tcx>(ccx: &CrateContext<'a, 'tcx>,\n-                                    impl_id: DefId,\n-                                    substs: &'tcx subst::Substs<'tcx>)\n-                                    -> Vec<Option<ImplMethod<'tcx>>>\n+pub fn get_vtable_methods<'tcx>(tcx: &TyCtxt<'tcx>,\n+                                impl_id: DefId,\n+                                substs: &'tcx subst::Substs<'tcx>)\n+                                -> Vec<Option<ImplMethod<'tcx>>>\n {\n-    let tcx = ccx.tcx();\n-\n     debug!(\"get_vtable_methods(impl_id={:?}, substs={:?}\", impl_id, substs);\n \n     let trt_id = match tcx.impl_trait_ref(impl_id) {"}]}