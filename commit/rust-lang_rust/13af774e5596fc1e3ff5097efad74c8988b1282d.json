{"sha": "13af774e5596fc1e3ff5097efad74c8988b1282d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEzYWY3NzRlNTU5NmZjMWUzZmY1MDk3ZWZhZDc0Yzg5ODhiMTI4MmQ=", "commit": {"author": {"name": "topecongiro", "email": "seuchida@gmail.com", "date": "2017-05-19T10:28:00Z"}, "committer": {"name": "topecongiro", "email": "seuchida@gmail.com", "date": "2017-05-23T02:37:12Z"}, "message": "Fix weird indentaion in chain", "tree": {"sha": "78d8544569d1850f4e52a0e3809a8e561858372b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/78d8544569d1850f4e52a0e3809a8e561858372b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/13af774e5596fc1e3ff5097efad74c8988b1282d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/13af774e5596fc1e3ff5097efad74c8988b1282d", "html_url": "https://github.com/rust-lang/rust/commit/13af774e5596fc1e3ff5097efad74c8988b1282d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/13af774e5596fc1e3ff5097efad74c8988b1282d/comments", "author": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "committer": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d16a0a399e76b916cdde12c50a733d8eb59a31ef", "url": "https://api.github.com/repos/rust-lang/rust/commits/d16a0a399e76b916cdde12c50a733d8eb59a31ef", "html_url": "https://github.com/rust-lang/rust/commit/d16a0a399e76b916cdde12c50a733d8eb59a31ef"}], "stats": {"total": 80, "additions": 66, "deletions": 14}, "files": [{"sha": "5da00d29330dc406ed4e02f41fd016ae9d29985b", "filename": "src/chains.rs", "status": "modified", "additions": 5, "deletions": 13, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/13af774e5596fc1e3ff5097efad74c8988b1282d/src%2Fchains.rs", "raw_url": "https://github.com/rust-lang/rust/raw/13af774e5596fc1e3ff5097efad74c8988b1282d/src%2Fchains.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fchains.rs?ref=13af774e5596fc1e3ff5097efad74c8988b1282d", "patch": "@@ -126,9 +126,7 @@ pub fn rewrite_chain(expr: &ast::Expr, context: &RewriteContext, shape: Shape) -\n         // brace.\n         (parent_shape, false)\n     } else if parent_rewrite_contains_newline {\n-        (chain_indent(context,\n-                      parent_shape.block_indent(context.config.tab_spaces())),\n-         false)\n+        (chain_indent(context, parent_shape), false)\n     } else {\n         (shape.block_indent(context.config.tab_spaces()), false)\n     };\n@@ -142,17 +140,11 @@ pub fn rewrite_chain(expr: &ast::Expr, context: &RewriteContext, shape: Shape) -\n         ..nested_shape\n     };\n     let first_child_shape = if extend {\n-        let mut shape = try_opt!(parent_shape.offset_left(last_line_width(&parent_rewrite)));\n+        let first_child_shape = try_opt!(parent_shape\n+                                             .offset_left(last_line_width(&parent_rewrite)));\n         match context.config.chain_indent() {\n-            IndentStyle::Visual => shape,\n-            IndentStyle::Block => {\n-                shape.offset = shape\n-                    .offset\n-                    .checked_sub(context.config.tab_spaces())\n-                    .unwrap_or(0);\n-                shape.indent.block_indent += context.config.tab_spaces();\n-                shape\n-            }\n+            IndentStyle::Visual => first_child_shape,\n+            IndentStyle::Block => first_child_shape.block(),\n         }\n     } else {\n         other_child_shape"}, {"sha": "a5ead34c9ec7a6459e1197d7e4ddc20793616c0d", "filename": "src/macros.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/13af774e5596fc1e3ff5097efad74c8988b1282d/src%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/13af774e5596fc1e3ff5097efad74c8988b1282d/src%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmacros.rs?ref=13af774e5596fc1e3ff5097efad74c8988b1282d", "patch": "@@ -183,7 +183,7 @@ pub fn rewrite_macro(mac: &ast::Mac,\n             let mac_shape = try_opt!(shape.shrink_left(macro_name.len()));\n             // Handle special case: `vec![expr; expr]`\n             if vec_with_semi {\n-                let (lbr, rbr) = if context.config.spaces_within_square_brackets {\n+                let (lbr, rbr) = if context.config.spaces_within_square_brackets() {\n                     (\"[ \", \" ]\")\n                 } else {\n                     (\"[\", \"]\")"}, {"sha": "35030189b8bf359379b840b39261b95df899b5e1", "filename": "tests/source/configs-fn_call_style-block.rs", "status": "modified", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/13af774e5596fc1e3ff5097efad74c8988b1282d/tests%2Fsource%2Fconfigs-fn_call_style-block.rs", "raw_url": "https://github.com/rust-lang/rust/raw/13af774e5596fc1e3ff5097efad74c8988b1282d/tests%2Fsource%2Fconfigs-fn_call_style-block.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fconfigs-fn_call_style-block.rs?ref=13af774e5596fc1e3ff5097efad74c8988b1282d", "patch": "@@ -15,3 +15,33 @@ impl Foo {\n         }\n     }\n }\n+\n+fn issue1420() {\n+    given(\n+        r#\"\n+        # Getting started\n+        ...\n+    \"#,\n+    )\n+        .running(waltz)\n+}\n+\n+// #1563\n+fn query(conn: &Connection) -> Result<()> {\n+    conn.query_row(\n+        r#\"\n+            SELECT title, date\n+            FROM posts,\n+            WHERE DATE(date) = $1\n+        \"#,\n+        &[],\n+        |row| {\n+            Post {\n+                title: row.get(0),\n+                date: row.get(1),\n+            }\n+        },\n+    )?;\n+\n+    Ok(())\n+}"}, {"sha": "d7f65635379e0aaaa950b530e9a6838dfb973193", "filename": "tests/target/configs-fn_call_style-block.rs", "status": "modified", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/13af774e5596fc1e3ff5097efad74c8988b1282d/tests%2Ftarget%2Fconfigs-fn_call_style-block.rs", "raw_url": "https://github.com/rust-lang/rust/raw/13af774e5596fc1e3ff5097efad74c8988b1282d/tests%2Ftarget%2Fconfigs-fn_call_style-block.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs-fn_call_style-block.rs?ref=13af774e5596fc1e3ff5097efad74c8988b1282d", "patch": "@@ -28,3 +28,33 @@ impl Foo {\n         }\n     }\n }\n+\n+fn issue1420() {\n+    given(\n+        r#\"\n+        # Getting started\n+        ...\n+    \"#\n+    )\n+        .running(waltz)\n+}\n+\n+// #1563\n+fn query(conn: &Connection) -> Result<()> {\n+    conn.query_row(\n+        r#\"\n+            SELECT title, date\n+            FROM posts,\n+            WHERE DATE(date) = $1\n+        \"#,\n+        &[],\n+        |row| {\n+            Post {\n+                title: row.get(0),\n+                date: row.get(1),\n+            }\n+        },\n+    )?;\n+\n+    Ok(())\n+}"}]}