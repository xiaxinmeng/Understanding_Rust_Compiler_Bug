{"sha": "1aac99de25d3e28e4b2a16e8fbe6737d5202f27a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFhYWM5OWRlMjVkM2UyOGU0YjJhMTZlOGZiZTY3MzdkNTIwMmYyN2E=", "commit": {"author": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2020-09-10T14:17:32Z"}, "committer": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2020-09-20T20:39:13Z"}, "message": "Provide bootstrap tools with RUSTC in environment", "tree": {"sha": "006014054b12b93ae6d5098417681f5aea09162f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/006014054b12b93ae6d5098417681f5aea09162f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1aac99de25d3e28e4b2a16e8fbe6737d5202f27a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1aac99de25d3e28e4b2a16e8fbe6737d5202f27a", "html_url": "https://github.com/rust-lang/rust/commit/1aac99de25d3e28e4b2a16e8fbe6737d5202f27a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1aac99de25d3e28e4b2a16e8fbe6737d5202f27a/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a625ab77e87b31ac6689e97f2f10cb09773bed38", "url": "https://api.github.com/repos/rust-lang/rust/commits/a625ab77e87b31ac6689e97f2f10cb09773bed38", "html_url": "https://github.com/rust-lang/rust/commit/a625ab77e87b31ac6689e97f2f10cb09773bed38"}], "stats": {"total": 12, "additions": 9, "deletions": 3}, "files": [{"sha": "a9a8d3783fd1e54ad0a87346640fbe37595eb74a", "filename": "src/bootstrap/test.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1aac99de25d3e28e4b2a16e8fbe6737d5202f27a/src%2Fbootstrap%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1aac99de25d3e28e4b2a16e8fbe6737d5202f27a/src%2Fbootstrap%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftest.rs?ref=1aac99de25d3e28e4b2a16e8fbe6737d5202f27a", "patch": "@@ -1281,6 +1281,8 @@ impl Step for Compiletest {\n             cmd.arg(\"--rustfix-coverage\");\n         }\n \n+        cmd.env(\"BOOTSTRAP_CARGO\", &builder.initial_cargo);\n+\n         builder.ci_env.force_coloring_in_ci(&mut cmd);\n \n         builder.info(&format!("}, {"sha": "460dffb5c8a570a9568d82035b943c253fe6e36f", "filename": "src/bootstrap/tool.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/1aac99de25d3e28e4b2a16e8fbe6737d5202f27a/src%2Fbootstrap%2Ftool.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1aac99de25d3e28e4b2a16e8fbe6737d5202f27a/src%2Fbootstrap%2Ftool.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftool.rs?ref=1aac99de25d3e28e4b2a16e8fbe6737d5202f27a", "patch": "@@ -700,6 +700,10 @@ impl<'a> Builder<'a> {\n         }\n \n         add_dylib_path(lib_paths, &mut cmd);\n+\n+        // Provide a RUSTC for this command to use.\n+        cmd.env(\"RUSTC\", &self.initial_rustc);\n+\n         cmd\n     }\n }"}, {"sha": "13385369e4451806399f5e14593ea02594443166", "filename": "src/test/run-make/thumb-none-cortex-m/Makefile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1aac99de25d3e28e4b2a16e8fbe6737d5202f27a/src%2Ftest%2Frun-make%2Fthumb-none-cortex-m%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/1aac99de25d3e28e4b2a16e8fbe6737d5202f27a/src%2Ftest%2Frun-make%2Fthumb-none-cortex-m%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fthumb-none-cortex-m%2FMakefile?ref=1aac99de25d3e28e4b2a16e8fbe6737d5202f27a", "patch": "@@ -35,4 +35,4 @@ all:\n \t# HACK(eddyb) sets `RUSTC_BOOTSTRAP=1` so Cargo can accept nightly features.\n \t# These come from the top-level Rust workspace, that this crate is not a\n \t# member of, but Cargo tries to load the workspace `Cargo.toml` anyway.\n-\tcd $(WORK_DIR) && cd $(CRATE) && env RUSTC_BOOTSTRAP=1 $(CARGO) build --target $(TARGET) -v\n+\tcd $(WORK_DIR) && cd $(CRATE) && env RUSTC_BOOTSTRAP=1 $(BOOTSTRAP_CARGO) build --target $(TARGET) -v"}, {"sha": "045d02a8ed25d4fdb061b77123d46b122c8a7463", "filename": "src/test/run-make/thumb-none-qemu/script.sh", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/1aac99de25d3e28e4b2a16e8fbe6737d5202f27a/src%2Ftest%2Frun-make%2Fthumb-none-qemu%2Fscript.sh", "raw_url": "https://github.com/rust-lang/rust/raw/1aac99de25d3e28e4b2a16e8fbe6737d5202f27a/src%2Ftest%2Frun-make%2Fthumb-none-qemu%2Fscript.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fthumb-none-qemu%2Fscript.sh?ref=1aac99de25d3e28e4b2a16e8fbe6737d5202f27a", "patch": "@@ -12,8 +12,8 @@ pushd $WORK_DIR\n         # These come from the top-level Rust workspace, that this crate is not a\n         # member of, but Cargo tries to load the workspace `Cargo.toml` anyway.\n         env RUSTC_BOOTSTRAP=1 RUSTFLAGS=\"-C linker=arm-none-eabi-ld -C link-arg=-Tlink.x\" \\\n-            $CARGO run --target $TARGET           | grep \"x = 42\"\n+            $BOOTSTRAP_CARGO run --target $TARGET           | grep \"x = 42\"\n         env RUSTC_BOOTSTRAP=1 RUSTFLAGS=\"-C linker=arm-none-eabi-ld -C link-arg=-Tlink.x\" \\\n-            $CARGO run --target $TARGET --release | grep \"x = 42\"\n+            $BOOTSTRAP_CARGO run --target $TARGET --release | grep \"x = 42\"\n     popd\n popd"}]}