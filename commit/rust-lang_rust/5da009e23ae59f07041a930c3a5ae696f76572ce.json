{"sha": "5da009e23ae59f07041a930c3a5ae696f76572ce", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVkYTAwOWUyM2FlNTlmMDcwNDFhOTMwYzNhNWFlNjk2Zjc2NTcyY2U=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-05-11T21:41:37Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-05-11T21:41:37Z"}, "message": "Rollup merge of #60720 - estebank:no-ice-thanks, r=zackmdavis\n\nRemove unnecessary unwraps\n\nFix #60713.", "tree": {"sha": "6a2e13acc4f0ab4d87b89dc24d583cb2420baf7f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6a2e13acc4f0ab4d87b89dc24d583cb2420baf7f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5da009e23ae59f07041a930c3a5ae696f76572ce", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJc10GRCRBK7hj4Ov3rIwAAdHIIADghMhEXw2zW7Ss4CEujM4gJ\nlkpiu5zso7a9jC8eV27w3SxLLY2gw73DjJVw/QRIZWidYrDHggHpCezTCJBScmeY\nc+/9IXQ3v8NATqeXkFpAJHyUWBN0an0+KqsgcptnmKnKRM/KYf7crTpNRUoGDJtI\nMO39DkGjK8HR+AOxcMTwHsMsJrrLFvn3CfdbjlUI3+HCaesBu0XD5/DxF25cVgTb\nKM1ubL2+6BRBAeC/8lUBSs/ZcOjWjO/RWu4epW2la6H5itm70x4DQWd99Fw1A3FT\nHJfkVFoUe27P+do4Csia7zrKybAaTPILP62h1Wirm9jGGuHqAhOH1m0S/1wbpH8=\n=xagn\n-----END PGP SIGNATURE-----\n", "payload": "tree 6a2e13acc4f0ab4d87b89dc24d583cb2420baf7f\nparent 3103fb2f72ad0443a354d4b6f5966645b5f85885\nparent c158a0f59270297a66058b9abac36d3e6e21ac37\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1557610897 +0200\ncommitter GitHub <noreply@github.com> 1557610897 +0200\n\nRollup merge of #60720 - estebank:no-ice-thanks, r=zackmdavis\n\nRemove unnecessary unwraps\n\nFix #60713.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5da009e23ae59f07041a930c3a5ae696f76572ce", "html_url": "https://github.com/rust-lang/rust/commit/5da009e23ae59f07041a930c3a5ae696f76572ce", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5da009e23ae59f07041a930c3a5ae696f76572ce/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3103fb2f72ad0443a354d4b6f5966645b5f85885", "url": "https://api.github.com/repos/rust-lang/rust/commits/3103fb2f72ad0443a354d4b6f5966645b5f85885", "html_url": "https://github.com/rust-lang/rust/commit/3103fb2f72ad0443a354d4b6f5966645b5f85885"}, {"sha": "c158a0f59270297a66058b9abac36d3e6e21ac37", "url": "https://api.github.com/repos/rust-lang/rust/commits/c158a0f59270297a66058b9abac36d3e6e21ac37", "html_url": "https://github.com/rust-lang/rust/commit/c158a0f59270297a66058b9abac36d3e6e21ac37"}], "stats": {"total": 57, "additions": 34, "deletions": 23}, "files": [{"sha": "77d2ffab8efb4e1bb32c8b9a64f52afe2c9b10f8", "filename": "src/librustc_typeck/check/method/suggest.rs", "status": "modified", "additions": 34, "deletions": 23, "changes": 57, "blob_url": "https://github.com/rust-lang/rust/blob/5da009e23ae59f07041a930c3a5ae696f76572ce/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fsuggest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5da009e23ae59f07041a930c3a5ae696f76572ce/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fsuggest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fsuggest.rs?ref=5da009e23ae59f07041a930c3a5ae696f76572ce", "patch": "@@ -91,14 +91,21 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n                     CandidateSource::ImplSource(impl_did) => {\n                         // Provide the best span we can. Use the item, if local to crate, else\n                         // the impl, if local to crate (item may be defaulted), else nothing.\n-                        let item = self.associated_item(impl_did, item_name, Namespace::Value)\n-                            .or_else(|| {\n-                                self.associated_item(\n-                                    self.tcx.impl_trait_ref(impl_did).unwrap().def_id,\n-                                    item_name,\n-                                    Namespace::Value,\n-                                )\n-                            }).unwrap();\n+                        let item = match self.associated_item(\n+                            impl_did,\n+                            item_name,\n+                            Namespace::Value,\n+                        ).or_else(|| {\n+                            let impl_trait_ref = self.tcx.impl_trait_ref(impl_did)?;\n+                            self.associated_item(\n+                                impl_trait_ref.def_id,\n+                                item_name,\n+                                Namespace::Value,\n+                            )\n+                        }) {\n+                            Some(item) => item,\n+                            None => continue,\n+                        };\n                         let note_span = self.tcx.hir().span_if_local(item.def_id).or_else(|| {\n                             self.tcx.hir().span_if_local(impl_did)\n                         });\n@@ -132,9 +139,14 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n                         }\n                     }\n                     CandidateSource::TraitSource(trait_did) => {\n-                        let item = self\n-                            .associated_item(trait_did, item_name, Namespace::Value)\n-                            .unwrap();\n+                        let item = match self.associated_item(\n+                            trait_did,\n+                            item_name,\n+                            Namespace::Value)\n+                        {\n+                            Some(item) => item,\n+                            None => continue,\n+                        };\n                         let item_span = self.tcx.sess.source_map()\n                             .def_span(self.tcx.def_span(item.def_id));\n                         if sources.len() > 1 {\n@@ -251,8 +263,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n                                 if let &QPath::Resolved(_, ref path) = &qpath {\n                                     if let hir::def::Res::Local(hir_id) = path.res {\n                                         let span = tcx.hir().span_by_hir_id(hir_id);\n-                                        let snippet = tcx.sess.source_map().span_to_snippet(span)\n-                                            .unwrap();\n+                                        let snippet = tcx.sess.source_map().span_to_snippet(span);\n                                         let filename = tcx.sess.source_map().span_to_filename(span);\n \n                                         let parent_node = self.tcx.hir().get_by_hir_id(\n@@ -263,12 +274,12 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n                                             concrete_type,\n                                         );\n \n-                                        match (filename, parent_node) {\n+                                        match (filename, parent_node, snippet) {\n                                             (FileName::Real(_), Node::Local(hir::Local {\n                                                 source: hir::LocalSource::Normal,\n                                                 ty,\n                                                 ..\n-                                            })) => {\n+                                            }), Ok(ref snippet)) => {\n                                                 err.span_suggestion(\n                                                     // account for `let x: _ = 42;`\n                                                     //                  ^^^^\n@@ -375,14 +386,14 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n                                     self.tcx.hir().get_parent_node_by_hir_id(expr.hir_id),\n                                 );\n \n-                                let span = call_expr.span.trim_start(item_name.span).unwrap();\n-\n-                                err.span_suggestion(\n-                                    span,\n-                                    \"remove the arguments\",\n-                                    String::new(),\n-                                    Applicability::MaybeIncorrect,\n-                                );\n+                                if let Some(span) = call_expr.span.trim_start(item_name.span) {\n+                                    err.span_suggestion(\n+                                        span,\n+                                        \"remove the arguments\",\n+                                        String::new(),\n+                                        Applicability::MaybeIncorrect,\n+                                    );\n+                                }\n                             }\n                         }\n "}]}