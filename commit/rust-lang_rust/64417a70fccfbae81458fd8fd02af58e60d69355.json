{"sha": "64417a70fccfbae81458fd8fd02af58e60d69355", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY0NDE3YTcwZmNjZmJhZTgxNDU4ZmQ4ZmQwMmFmNThlNjBkNjkzNTU=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-10-30T10:55:28Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-10-30T10:55:28Z"}, "message": "Rollup merge of #55459 - memoryruins:issue-49296, r=oli-obk\n\nAdd UI test for #49296\n\nCloses #49296\n\nr? @oli-obk", "tree": {"sha": "6cde86587b576b9a8aefa79be6d870b68be04955", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6cde86587b576b9a8aefa79be6d870b68be04955"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/64417a70fccfbae81458fd8fd02af58e60d69355", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJb2DigCRBK7hj4Ov3rIwAAdHIIAEmvjTpfLmBwOOW7C4r8N01v\neRxL/8h42jXiJFLGlfYUp8gb1M/SOsq9uUn8/cnbcLqvArT2iAKy3Yx1Bj78DWF0\nhSjJfUMP3uLRU2+L/iuoA3aiYpl7D+Hdvo1XTevsvJpg84PGRhmlCJNj/XjxCvd5\nOR0LZ9fiZW8zY4z068HWlAiQELv2OSe8zkN9Ej/BtFRehhe1LaroKvWHf7sBWABH\nAZQk/LufsN8sEr6nfw6NrTvZkzAal/NTowgxQ44gJpk1lNP1sFfUXzenlC3ZD+TH\nxKOpVlBpLkURmvZ04Qu5sun0LZheBpEWtq4QJwaCmFo31XFSLQWQjeZ1fvjVTnE=\n=FRes\n-----END PGP SIGNATURE-----\n", "payload": "tree 6cde86587b576b9a8aefa79be6d870b68be04955\nparent 8c8581703e536ae584d6b46216e360fb587afb66\nparent fc2aa3fe0ec13c8d6150a877d7193473aabc58c9\nauthor kennytm <kennytm@gmail.com> 1540896928 +0800\ncommitter GitHub <noreply@github.com> 1540896928 +0800\n\nRollup merge of #55459 - memoryruins:issue-49296, r=oli-obk\n\nAdd UI test for #49296\n\nCloses #49296\n\nr? @oli-obk\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/64417a70fccfbae81458fd8fd02af58e60d69355", "html_url": "https://github.com/rust-lang/rust/commit/64417a70fccfbae81458fd8fd02af58e60d69355", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/64417a70fccfbae81458fd8fd02af58e60d69355/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8c8581703e536ae584d6b46216e360fb587afb66", "url": "https://api.github.com/repos/rust-lang/rust/commits/8c8581703e536ae584d6b46216e360fb587afb66", "html_url": "https://github.com/rust-lang/rust/commit/8c8581703e536ae584d6b46216e360fb587afb66"}, {"sha": "fc2aa3fe0ec13c8d6150a877d7193473aabc58c9", "url": "https://api.github.com/repos/rust-lang/rust/commits/fc2aa3fe0ec13c8d6150a877d7193473aabc58c9", "html_url": "https://github.com/rust-lang/rust/commit/fc2aa3fe0ec13c8d6150a877d7193473aabc58c9"}], "stats": {"total": 35, "additions": 35, "deletions": 0}, "files": [{"sha": "a7c3c5318d4306b21c33e06af02eac8c66c21131", "filename": "src/test/ui/consts/const-eval/issue-49296.rs", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/64417a70fccfbae81458fd8fd02af58e60d69355/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fissue-49296.rs", "raw_url": "https://github.com/rust-lang/rust/raw/64417a70fccfbae81458fd8fd02af58e60d69355/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fissue-49296.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fissue-49296.rs?ref=64417a70fccfbae81458fd8fd02af58e60d69355", "patch": "@@ -0,0 +1,23 @@\n+// issue-49296: Unsafe shenigans in constants can result in missing errors\n+\n+#![feature(const_fn)]\n+#![feature(const_fn_union)]\n+\n+const unsafe fn transmute<T: Copy, U: Copy>(t: T) -> U {\n+    union Transmute<T: Copy, U: Copy> {\n+        from: T,\n+        to: U,\n+    }\n+\n+    Transmute { from: t }.to\n+}\n+\n+const fn wat(x: u64) -> &'static u64 {\n+    unsafe { transmute(&x) }\n+}\n+const X: u64 = *wat(42);\n+//~^ ERROR any use of this value will cause an error\n+\n+fn main() {\n+    println!(\"{}\", X);\n+}"}, {"sha": "37462db4c965e4308533e658cf064d91f2f39c7f", "filename": "src/test/ui/consts/const-eval/issue-49296.stderr", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/64417a70fccfbae81458fd8fd02af58e60d69355/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fissue-49296.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/64417a70fccfbae81458fd8fd02af58e60d69355/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fissue-49296.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fissue-49296.stderr?ref=64417a70fccfbae81458fd8fd02af58e60d69355", "patch": "@@ -0,0 +1,12 @@\n+error: any use of this value will cause an error\n+  --> $DIR/issue-49296.rs:18:1\n+   |\n+LL | const X: u64 = *wat(42);\n+   | ^^^^^^^^^^^^^^^--------^\n+   |                |\n+   |                dangling pointer was dereferenced\n+   |\n+   = note: #[deny(const_err)] on by default\n+\n+error: aborting due to previous error\n+"}]}