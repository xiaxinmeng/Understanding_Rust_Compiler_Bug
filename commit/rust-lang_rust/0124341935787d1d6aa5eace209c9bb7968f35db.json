{"sha": "0124341935787d1d6aa5eace209c9bb7968f35db", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAxMjQzNDE5MzU3ODdkMWQ2YWE1ZWFjZTIwOWM5YmI3OTY4ZjM1ZGI=", "commit": {"author": {"name": "David Wood", "email": "david@davidtw.co", "date": "2018-11-29T19:40:43Z"}, "committer": {"name": "David Wood", "email": "david@davidtw.co", "date": "2018-11-29T19:47:59Z"}, "message": "Only consider stem when extension is exe.\n\nThis commit modifies linker flavor inference to only remove the extension\nto the linker when performing inference if that extension is a 'exe'.", "tree": {"sha": "97b4737df883c8c712c02027ca33fae123a1537d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/97b4737df883c8c712c02027ca33fae123a1537d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0124341935787d1d6aa5eace209c9bb7968f35db", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEWwgxPGhT5b/6kagXAXYLT59T8VQFAlwAQngACgkQAXYLT59T\n8VQwqBAAh0q3EY106abu0e3JDsDrLtfGDr5BTzUKkevT8NwF0gtH4CYqiZ1Djzu4\nCsljYiamKjtXYQWv3jwxAhtwUZf/faxDncDFItJdW4KfKIvvRHIwVshnB7+O4WyK\n72dPIKCa27X42FQDb6UlGrEC0z1ncW3ctWOP6YWBqrVvBEwzEKviqoOH2Y6rlnGB\ngqjb6t44iOZpojpytYVtGAR+1WVbZlggAuZNSW42l+IJupFqVAc8qy95v+McydbX\nYgwX6seaJpgbad3faic8mFAjC5/6/4n68r9bFeqGvUHngyKjNmf1OGHRRPOp3/Il\n3WNNXpobjxfWYNSGgG26P6aNYBLlR8hyeUCZYzaX2q3iOIxskcdNruUjSGVdYd8V\nBbkJNOQcl17T3eJtFQhwHwHQVLyf8Av2Sa4f3KMrYj3ljLoVtTM6GIjdCXO+lz9O\nTJpzc5yYiP5g3vcCrv0rePbuFQ1HmdmnnFvPooeqljvdsO1JyulJMwl0Bw5XOWB2\n7jjbLSPyoTzduYovwGVRYxKRSV71qjm+oP7Bamy2+j2Gp/gcl0f0pXl7aD82Eb6b\n0wZ5VKFh5rHoZY+9gOGaEbboKxjJa8Og76TTTse7mQFK3IYw525gaU4WtLC+g3Cx\nmlANe5nNPWsyT1QitqXLVedn/1PYWTX79uUZLrCm2hQBpG+TEl8=\n=wNNf\n-----END PGP SIGNATURE-----", "payload": "tree 97b4737df883c8c712c02027ca33fae123a1537d\nparent 147e60c5f89cfa2d3ffc247413956a37582c98e7\nauthor David Wood <david@davidtw.co> 1543520443 +0100\ncommitter David Wood <david@davidtw.co> 1543520879 +0100\n\nOnly consider stem when extension is exe.\n\nThis commit modifies linker flavor inference to only remove the extension\nto the linker when performing inference if that extension is a 'exe'.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0124341935787d1d6aa5eace209c9bb7968f35db", "html_url": "https://github.com/rust-lang/rust/commit/0124341935787d1d6aa5eace209c9bb7968f35db", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0124341935787d1d6aa5eace209c9bb7968f35db/comments", "author": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "147e60c5f89cfa2d3ffc247413956a37582c98e7", "url": "https://api.github.com/repos/rust-lang/rust/commits/147e60c5f89cfa2d3ffc247413956a37582c98e7", "html_url": "https://github.com/rust-lang/rust/commit/147e60c5f89cfa2d3ffc247413956a37582c98e7"}], "stats": {"total": 6, "additions": 5, "deletions": 1}, "files": [{"sha": "24a70dc797771a2fa70001710f5bddde91624f65", "filename": "src/librustc_codegen_ssa/back/link.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/0124341935787d1d6aa5eace209c9bb7968f35db/src%2Flibrustc_codegen_ssa%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0124341935787d1d6aa5eace209c9bb7968f35db/src%2Flibrustc_codegen_ssa%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Fback%2Flink.rs?ref=0124341935787d1d6aa5eace209c9bb7968f35db", "patch": "@@ -161,7 +161,11 @@ pub fn linker_and_flavor(sess: &Session) -> (PathBuf, LinkerFlavor) {\n                 LinkerFlavor::Lld(_) => \"lld\",\n             }), flavor)),\n             (Some(linker), None) => {\n-                let stem = linker.file_stem().and_then(|stem| stem.to_str()).unwrap_or_else(|| {\n+                let stem = if linker.extension().and_then(|ext| ext.to_str()) == Some(\"exe\") {\n+                    linker.file_stem().and_then(|stem| stem.to_str())\n+                } else {\n+                    linker.to_str()\n+                }.unwrap_or_else(|| {\n                     sess.fatal(\"couldn't extract file stem from specified linker\");\n                 }).to_owned();\n "}]}