{"sha": "c5139b9136c25c71f4c5f71335da9aedb8088cbc", "node_id": "C_kwDOAAsO6NoAKGM1MTM5YjkxMzZjMjVjNzFmNGM1ZjcxMzM1ZGE5YWVkYjgwODhjYmM", "commit": {"author": {"name": "Pietro Albini", "email": "pietro.albini@ferrous-systems.com", "date": "2023-05-26T13:25:21Z"}, "committer": {"name": "Pietro Albini", "email": "pietro.albini@ferrous-systems.com", "date": "2023-05-26T13:25:21Z"}, "message": "add reasoning for introducing a metrics format version", "tree": {"sha": "125dfe40d2498d01d3733ca1ad6c123a6bd18879", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/125dfe40d2498d01d3733ca1ad6c123a6bd18879"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c5139b9136c25c71f4c5f71335da9aedb8088cbc", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEMycKYjxLY0eb13b7zXazX3c0dp4FAmRws1AACgkQzXazX3c0\ndp6rHw/+NprslDfQG2oO2h0Q5PFQkPODJPD+MM0+er8dzH1Ca2dypvpwP6al+mBq\n/pPvq0Tf/8Ko/Bssu4MhHYK87wI05S4NJih0Hvk8mU0VJT1d/Nknm72Pt8KZbWQW\nCT7TJ+OdkxZ81eXjS1cg8ZACFgZAuE0JLl7c6xAg/ikpj8J93+ayrPZMFBwXUcd1\no8GXRI3fX3SN3L/z+EsFmf5U7PXpwOoX8ZnsS+IY2KNT1fQpua1OWzCNiur/aD+N\nUgQaIe41qub1154eM8Hs0HXbFDejw8AbhvfDpHn4PTF87czkw9khnEUFh2kgpdqr\nsBse2MnNdAfPNu6jjFneVGkyXd40S2XkuShiueB/msKmq4uraZX03WzTA+YhG1Py\nvcdbfn4PqPvjTn8OfrRYM156SIUzf7hxfRZp5o6b55aT91LtmcdDu8Xb7OhP0kUd\nPOtPBXjMXRXP2s0vc4dmxOGH5RmzisTskG188WE2ALjCnn8W7oqNYmoH5c+kmC9e\npa7mIPjWNPmOIJnwBQWn69/MKUU5uR+T7FhQeUjJoeRc5lLbcxepxvVn5vGvQQZs\ngvASrbz2plHklm5+bH13BBjYHThYkpF5d90d4YIvpU8FtV+TE6FE+j9rTqf5Jsjg\n44rOHz92CGqluF7ep8LHsTG2OiV2hpcOJ9gFVkE/GfMz78UaUqM=\n=XM/a\n-----END PGP SIGNATURE-----", "payload": "tree 125dfe40d2498d01d3733ca1ad6c123a6bd18879\nparent 7040d4102f0f3915944369e8d25ebf91f6a99640\nauthor Pietro Albini <pietro.albini@ferrous-systems.com> 1685107521 +0200\ncommitter Pietro Albini <pietro.albini@ferrous-systems.com> 1685107521 +0200\n\nadd reasoning for introducing a metrics format version\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c5139b9136c25c71f4c5f71335da9aedb8088cbc", "html_url": "https://github.com/rust-lang/rust/commit/c5139b9136c25c71f4c5f71335da9aedb8088cbc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c5139b9136c25c71f4c5f71335da9aedb8088cbc/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7040d4102f0f3915944369e8d25ebf91f6a99640", "url": "https://api.github.com/repos/rust-lang/rust/commits/7040d4102f0f3915944369e8d25ebf91f6a99640", "html_url": "https://github.com/rust-lang/rust/commit/7040d4102f0f3915944369e8d25ebf91f6a99640"}], "stats": {"total": 18, "additions": 15, "deletions": 3}, "files": [{"sha": "5990f33b9bc6c87d18359c9288e0b0342653fe3a", "filename": "src/bootstrap/metrics.rs", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/c5139b9136c25c71f4c5f71335da9aedb8088cbc/src%2Fbootstrap%2Fmetrics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c5139b9136c25c71f4c5f71335da9aedb8088cbc/src%2Fbootstrap%2Fmetrics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fmetrics.rs?ref=c5139b9136c25c71f4c5f71335da9aedb8088cbc", "patch": "@@ -16,9 +16,21 @@ use sysinfo::{CpuExt, System, SystemExt};\n \n // Update this number whenever a breaking change is made to the build metrics.\n //\n-// Versions:\n-// 0: initial version\n-// 1: replaced JsonNode::Test with JsonNode::TestSuite\n+// The output format is versioned for two reasons:\n+//\n+// - The metadata is intended to be consumed by external tooling, and exposing a format version\n+//   helps the tools determine whether they're compatible with a metrics file.\n+//\n+// - If a developer enables build metrics in their local checkout, making a breaking change to the\n+//   metrics format would result in a hard-to-diagnose error message when an existing metrics file\n+//   is not compatible with the new changes. With a format version number, bootstrap can discard\n+//   incompatible metrics files instead of appending metrics to them.\n+//\n+// Version changelog:\n+//\n+// - v0: initial version\n+// - v1: replaced JsonNode::Test with JsonNode::TestSuite\n+//\n const CURRENT_FORMAT_VERSION: usize = 1;\n \n pub(crate) struct BuildMetrics {"}]}