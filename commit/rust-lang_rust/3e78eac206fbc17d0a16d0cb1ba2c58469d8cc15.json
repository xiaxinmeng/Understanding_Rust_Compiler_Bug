{"sha": "3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNlNzhlYWMyMDZmYmMxN2QwYTE2ZDBjYjFiYTJjNTg0NjlkOGNjMTU=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2020-07-05T23:07:25Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-07-05T23:07:25Z"}, "message": "Rollup merge of #73871 - da-x:private-types-2018-no-extern, r=petrochenkov\n\nFix try_print_visible_def_path for Rust 2018\n\nThe recursive check of `try_print_visible_def_path` did not properly handle the Rust 2018 case of crate-paths without 'extern crate'. Instead, it returned a \"not found\" via (false, self).\n\n This fixes #56175.", "tree": {"sha": "93c3ed7af5017c7dd03d1d86526828a8719b35ee", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/93c3ed7af5017c7dd03d1d86526828a8719b35ee"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfAl0tCRBK7hj4Ov3rIwAAdHIIAHnl5nbqBmVckEx4LGinjOWg\n7IiDwRS042VFL2VBiuP6hAKsqVwma2ZO7r4PpYT6mNN8UgdjS2cBrGpCXij2zwaL\nbO2mGA7aEfZj2UKtkhdZtZWB6Rq4GDfwatoi07dfLCoumR8ZZoK8jHkyE2QUxINZ\nDogTukK3aZfjg1aRYkxvfsKjNAnv8qW6oIMYa+JG44GaRmsBgMPL6OdObl9kud4v\nwCvlCgseH2HS8PeK/t+wM3of94fD43w4LRtO20grgAJ7lRUiNcUzBTalv0EV9lSO\nd+P3uwuj+CgVUA0pvReRE8ECZEtxCS8SUafUt79QQdz/ltiQ/9Daj20VY033bqk=\n=dMS9\n-----END PGP SIGNATURE-----\n", "payload": "tree 93c3ed7af5017c7dd03d1d86526828a8719b35ee\nparent fed20132a6a7bbedb87c7bde6abfa0e58d8743d4\nparent f77b6fe5711e42321b3e2b8b438e00e682f5411b\nauthor Manish Goregaokar <manishsmail@gmail.com> 1593990445 -0700\ncommitter GitHub <noreply@github.com> 1593990445 -0700\n\nRollup merge of #73871 - da-x:private-types-2018-no-extern, r=petrochenkov\n\nFix try_print_visible_def_path for Rust 2018\n\nThe recursive check of `try_print_visible_def_path` did not properly handle the Rust 2018 case of crate-paths without 'extern crate'. Instead, it returned a \"not found\" via (false, self).\n\n This fixes #56175.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15", "html_url": "https://github.com/rust-lang/rust/commit/3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fed20132a6a7bbedb87c7bde6abfa0e58d8743d4", "url": "https://api.github.com/repos/rust-lang/rust/commits/fed20132a6a7bbedb87c7bde6abfa0e58d8743d4", "html_url": "https://github.com/rust-lang/rust/commit/fed20132a6a7bbedb87c7bde6abfa0e58d8743d4"}, {"sha": "f77b6fe5711e42321b3e2b8b438e00e682f5411b", "url": "https://api.github.com/repos/rust-lang/rust/commits/f77b6fe5711e42321b3e2b8b438e00e682f5411b", "html_url": "https://github.com/rust-lang/rust/commit/f77b6fe5711e42321b3e2b8b438e00e682f5411b"}], "stats": {"total": 88, "additions": 71, "deletions": 17}, "files": [{"sha": "9dda208b5a0daa16c51579cca8c39eca81f354eb", "filename": "src/librustc_middle/ty/print/pretty.rs", "status": "modified", "additions": 18, "deletions": 17, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15/src%2Flibrustc_middle%2Fty%2Fprint%2Fpretty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15/src%2Flibrustc_middle%2Fty%2Fprint%2Fpretty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_middle%2Fty%2Fprint%2Fpretty.rs?ref=3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15", "patch": "@@ -282,26 +282,27 @@ pub trait PrettyPrinter<'tcx>:\n             //    where there is no explicit `extern crate`, we just prepend\n             //    the crate name.\n             match self.tcx().extern_crate(def_id) {\n-                Some(&ExternCrate {\n-                    src: ExternCrateSource::Extern(def_id),\n-                    dependency_of: LOCAL_CRATE,\n-                    span,\n-                    ..\n-                }) => {\n-                    debug!(\"try_print_visible_def_path: def_id={:?}\", def_id);\n-                    return Ok((\n-                        if !span.is_dummy() {\n-                            self.print_def_path(def_id, &[])?\n-                        } else {\n-                            self.path_crate(cnum)?\n-                        },\n-                        true,\n-                    ));\n-                }\n+                Some(&ExternCrate { src, dependency_of, span, .. }) => match (src, dependency_of) {\n+                    (ExternCrateSource::Extern(def_id), LOCAL_CRATE) => {\n+                        debug!(\"try_print_visible_def_path: def_id={:?}\", def_id);\n+                        return Ok((\n+                            if !span.is_dummy() {\n+                                self.print_def_path(def_id, &[])?\n+                            } else {\n+                                self.path_crate(cnum)?\n+                            },\n+                            true,\n+                        ));\n+                    }\n+                    (ExternCrateSource::Path, LOCAL_CRATE) => {\n+                        debug!(\"try_print_visible_def_path: def_id={:?}\", def_id);\n+                        return Ok((self.path_crate(cnum)?, true));\n+                    }\n+                    _ => {}\n+                },\n                 None => {\n                     return Ok((self.path_crate(cnum)?, true));\n                 }\n-                _ => {}\n             }\n         }\n "}, {"sha": "51a991bef5959d1e410a121af060343ecba72528", "filename": "src/test/ui/issues/auxiliary/reexported-trait.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15/src%2Ftest%2Fui%2Fissues%2Fauxiliary%2Freexported-trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15/src%2Ftest%2Fui%2Fissues%2Fauxiliary%2Freexported-trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fauxiliary%2Freexported-trait.rs?ref=3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15", "patch": "@@ -0,0 +1,17 @@\n+mod private {\n+    pub trait Trait {\n+        fn trait_method(&self) {\n+        }\n+    }\n+    pub trait TraitB {\n+        fn trait_method_b(&self) {\n+        }\n+    }\n+}\n+\n+pub struct FooStruct;\n+pub use crate::private::Trait;\n+impl crate::private::Trait for FooStruct {}\n+\n+pub use crate::private::TraitB as TraitBRename;\n+impl crate::private::TraitB for FooStruct {}"}, {"sha": "ca1d0d4310ae9f39015ce91d8f0338bc7ad2af01", "filename": "src/test/ui/issues/issue-56175.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15/src%2Ftest%2Fui%2Fissues%2Fissue-56175.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15/src%2Ftest%2Fui%2Fissues%2Fissue-56175.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-56175.rs?ref=3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15", "patch": "@@ -0,0 +1,9 @@\n+// edition:2018\n+// aux-crate:reexported_trait=reexported-trait.rs\n+\n+fn main() {\n+    reexported_trait::FooStruct.trait_method();\n+    //~^ ERROR\n+    reexported_trait::FooStruct.trait_method_b();\n+    //~^ ERROR\n+}"}, {"sha": "c0799db7c1286f28a3c22d3b40b2c4afa404c8b4", "filename": "src/test/ui/issues/issue-56175.stderr", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15/src%2Ftest%2Fui%2Fissues%2Fissue-56175.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15/src%2Ftest%2Fui%2Fissues%2Fissue-56175.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-56175.stderr?ref=3e78eac206fbc17d0a16d0cb1ba2c58469d8cc15", "patch": "@@ -0,0 +1,27 @@\n+error[E0599]: no method named `trait_method` found for struct `reexported_trait::FooStruct` in the current scope\n+  --> $DIR/issue-56175.rs:5:33\n+   |\n+LL |     reexported_trait::FooStruct.trait_method();\n+   |                                 ^^^^^^^^^^^^ method not found in `reexported_trait::FooStruct`\n+   |\n+   = help: items from traits can only be used if the trait is in scope\n+help: the following trait is implemented but not in scope; perhaps add a `use` for it:\n+   |\n+LL | use reexported_trait::Trait;\n+   |\n+\n+error[E0599]: no method named `trait_method_b` found for struct `reexported_trait::FooStruct` in the current scope\n+  --> $DIR/issue-56175.rs:7:33\n+   |\n+LL |     reexported_trait::FooStruct.trait_method_b();\n+   |                                 ^^^^^^^^^^^^^^ method not found in `reexported_trait::FooStruct`\n+   |\n+   = help: items from traits can only be used if the trait is in scope\n+help: the following trait is implemented but not in scope; perhaps add a `use` for it:\n+   |\n+LL | use reexported_trait::TraitBRename;\n+   |\n+\n+error: aborting due to 2 previous errors\n+\n+For more information about this error, try `rustc --explain E0599`."}]}