{"sha": "ef32b129fa4a64b44c4a0c7ace932ae1724c9c62", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVmMzJiMTI5ZmE0YTY0YjQ0YzRhMGM3YWNlOTMyYWUxNzI0YzljNjI=", "commit": {"author": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2013-12-21T01:54:47Z"}, "committer": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2013-12-26T23:54:28Z"}, "message": "librustc: Remove the unused `stmt_map` from the borrow checker", "tree": {"sha": "d22cbbd953abd1a011b0f3305d87fb36621e6c1a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d22cbbd953abd1a011b0f3305d87fb36621e6c1a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ef32b129fa4a64b44c4a0c7ace932ae1724c9c62", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ef32b129fa4a64b44c4a0c7ace932ae1724c9c62", "html_url": "https://github.com/rust-lang/rust/commit/ef32b129fa4a64b44c4a0c7ace932ae1724c9c62", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ef32b129fa4a64b44c4a0c7ace932ae1724c9c62/comments", "author": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2de1e3649acc3d0ba3973768124b55d528efbe4f", "url": "https://api.github.com/repos/rust-lang/rust/commits/2de1e3649acc3d0ba3973768124b55d528efbe4f", "html_url": "https://github.com/rust-lang/rust/commit/2de1e3649acc3d0ba3973768124b55d528efbe4f"}], "stats": {"total": 20, "additions": 1, "deletions": 19}, "files": [{"sha": "40c80c60f37f57e0628ff7443cb6389f4e114110", "filename": "src/librustc/middle/borrowck/gather_loans/mod.rs", "status": "modified", "additions": 1, "deletions": 13, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/ef32b129fa4a64b44c4a0c7ace932ae1724c9c62/src%2Flibrustc%2Fmiddle%2Fborrowck%2Fgather_loans%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ef32b129fa4a64b44c4a0c7ace932ae1724c9c62/src%2Flibrustc%2Fmiddle%2Fborrowck%2Fgather_loans%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fborrowck%2Fgather_loans%2Fmod.rs?ref=ef32b129fa4a64b44c4a0c7ace932ae1724c9c62", "patch": "@@ -85,7 +85,7 @@ impl<'a> visit::Visitor<()> for GatherLoanCtxt<'a> {\n         gather_loans_in_fn(self, fk, fd, b, s, n);\n     }\n     fn visit_stmt(&mut self, s:@Stmt, _:()) {\n-        add_stmt_to_map(self, s);\n+        visit::walk_stmt(self, s, ());\n     }\n     fn visit_pat(&mut self, p:&Pat, _:()) {\n         add_pat_to_id_range(self, p);\n@@ -824,15 +824,3 @@ impl<'a> GatherLoanCtxt<'a> {\n     }\n }\n \n-// Setting up info that preserve needs.\n-// This is just the most convenient place to do it.\n-fn add_stmt_to_map(this: &mut GatherLoanCtxt,\n-                   stmt: @ast::Stmt) {\n-    match stmt.node {\n-        ast::StmtExpr(_, id) | ast::StmtSemi(_, id) => {\n-            this.bccx.stmt_map.insert(id);\n-        }\n-        _ => ()\n-    }\n-    visit::walk_stmt(this, stmt, ());\n-}"}, {"sha": "8a9ea843592ac26d40c0a8131f945119a49e78ac", "filename": "src/librustc/middle/borrowck/mod.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ef32b129fa4a64b44c4a0c7ace932ae1724c9c62/src%2Flibrustc%2Fmiddle%2Fborrowck%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ef32b129fa4a64b44c4a0c7ace932ae1724c9c62/src%2Flibrustc%2Fmiddle%2Fborrowck%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fborrowck%2Fmod.rs?ref=ef32b129fa4a64b44c4a0c7ace932ae1724c9c62", "patch": "@@ -17,7 +17,6 @@ use middle::typeck;\n use middle::moves;\n use middle::dataflow::DataFlowContext;\n use middle::dataflow::DataFlowOperator;\n-use util::common::stmt_set;\n use util::ppaux::{note_and_explain_region, Repr, UserString};\n \n use std::cell::RefCell;\n@@ -85,7 +84,6 @@ pub fn check_crate(\n         root_map: root_map(),\n         loan_map: @mut HashMap::new(),\n         write_guard_map: @mut HashSet::new(),\n-        stmt_map: @mut HashSet::new(),\n         stats: @mut BorrowStats {\n             loaned_paths_same: 0,\n             loaned_paths_imm: 0,\n@@ -177,7 +175,6 @@ pub struct BorrowckCtxt {\n     root_map: root_map,\n     loan_map: LoanMap,\n     write_guard_map: write_guard_map,\n-    stmt_map: stmt_set,\n \n     // Statistics:\n     stats: @mut BorrowStats"}, {"sha": "f3933c5623b26eaf0cf98d669fd55b6dc85507c2", "filename": "src/librustc/util/common.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ef32b129fa4a64b44c4a0c7ace932ae1724c9c62/src%2Flibrustc%2Futil%2Fcommon.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ef32b129fa4a64b44c4a0c7ace932ae1724c9c62/src%2Flibrustc%2Futil%2Fcommon.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Futil%2Fcommon.rs?ref=ef32b129fa4a64b44c4a0c7ace932ae1724c9c62", "patch": "@@ -14,7 +14,6 @@ use syntax::codemap::{Span};\n use syntax::visit;\n use syntax::visit::Visitor;\n \n-use std::hashmap::HashSet;\n use std::local_data;\n use extra;\n \n@@ -132,5 +131,3 @@ pub fn pluralize(n: uint, s: ~str) -> ~str {\n     else { format!(\"{}s\", s) }\n }\n \n-// A set of node IDs (used to keep track of which node IDs are for statements)\n-pub type stmt_set = @mut HashSet<ast::NodeId>;"}]}