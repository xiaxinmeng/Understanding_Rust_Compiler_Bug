{"sha": "5faf07d0829aff91387fcb63798eb7cbbecb1438", "node_id": "C_kwDOAAsO6NoAKDVmYWYwN2QwODI5YWZmOTEzODdmY2I2Mzc5OGViN2NiYmVjYjE0Mzg", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-10-02T16:34:03Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-10-02T16:34:03Z"}, "message": "Merge #10429\n\n10429: internal: remove deprecated method r=matklad a=matklad\n\nbors r+\n\ud83e\udd16\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>", "tree": {"sha": "3a97f38b1ff79dbae1e032ee3b38beb1dc50a8e6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3a97f38b1ff79dbae1e032ee3b38beb1dc50a8e6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5faf07d0829aff91387fcb63798eb7cbbecb1438", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhWIn7CRBK7hj4Ov3rIwAAa5kIAILzz+9HlHWIoreMKIC4XpNO\nhiyMjVFlcX/rV0zJ4jI4uVu6fl68BmNpG9vlctCGFmiq9pl8cQTKvUuqDLlk/eYX\nMPsoArgIeDPBicgF+Ems9CLrBxVRjYM+vhRGe/yb3OkzDizt9Xy8Dxz3cT5kYPtE\nUOZLF4IJMv/Hwfp7rnREyvHxj33pRWbyqSfDVaUlZe0sPcecKIthN4H0WmLbem55\n+bHBUTYYExbLB06D6W+PsJX1amATJFl/pCv+lpHKxYN2W0HOLOXaqYKCgcjzqiXF\nNo6QWoX38nTgBMVQDSizgUWGNJPRNVLEQqlP97SX5wo5DDgWICBUj9G1Tj1KE1w=\n=R9Ye\n-----END PGP SIGNATURE-----\n", "payload": "tree 3a97f38b1ff79dbae1e032ee3b38beb1dc50a8e6\nparent 745fd9903c804a6810cd3a1e050116f2c3575ac0\nparent 7dbf24fc7a8f77479780a0da72f9a9bd7668773f\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1633192443 +0000\ncommitter GitHub <noreply@github.com> 1633192443 +0000\n\nMerge #10429\n\n10429: internal: remove deprecated method r=matklad a=matklad\n\nbors r+\n\ud83e\udd16\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5faf07d0829aff91387fcb63798eb7cbbecb1438", "html_url": "https://github.com/rust-lang/rust/commit/5faf07d0829aff91387fcb63798eb7cbbecb1438", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5faf07d0829aff91387fcb63798eb7cbbecb1438/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "745fd9903c804a6810cd3a1e050116f2c3575ac0", "url": "https://api.github.com/repos/rust-lang/rust/commits/745fd9903c804a6810cd3a1e050116f2c3575ac0", "html_url": "https://github.com/rust-lang/rust/commit/745fd9903c804a6810cd3a1e050116f2c3575ac0"}, {"sha": "7dbf24fc7a8f77479780a0da72f9a9bd7668773f", "url": "https://api.github.com/repos/rust-lang/rust/commits/7dbf24fc7a8f77479780a0da72f9a9bd7668773f", "html_url": "https://github.com/rust-lang/rust/commit/7dbf24fc7a8f77479780a0da72f9a9bd7668773f"}], "stats": {"total": 23, "additions": 6, "deletions": 17}, "files": [{"sha": "22675fbee0f2e532e9e22190ba87fc0708d30f93", "filename": "crates/ide_assists/src/handlers/replace_if_let_with_match.rs", "status": "modified", "additions": 5, "deletions": 6, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/5faf07d0829aff91387fcb63798eb7cbbecb1438/crates%2Fide_assists%2Fsrc%2Fhandlers%2Freplace_if_let_with_match.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5faf07d0829aff91387fcb63798eb7cbbecb1438/crates%2Fide_assists%2Fsrc%2Fhandlers%2Freplace_if_let_with_match.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_assists%2Fsrc%2Fhandlers%2Freplace_if_let_with_match.rs?ref=5faf07d0829aff91387fcb63798eb7cbbecb1438", "patch": "@@ -210,11 +210,7 @@ pub(crate) fn replace_match_with_if_let(acc: &mut Assists, ctx: &AssistContext)\n                 ast::Expr::BlockExpr(block) => block,\n                 expr => make::block_expr(iter::empty(), Some(expr)),\n             };\n-            let else_expr = match else_expr {\n-                ast::Expr::BlockExpr(block) if block.is_empty() => None,\n-                ast::Expr::TupleExpr(tuple) if tuple.fields().next().is_none() => None,\n-                expr => Some(expr),\n-            };\n+            let else_expr = if is_empty_expr(&else_expr) { None } else { Some(else_expr) };\n             let if_let_expr = make::expr_if(\n                 condition,\n                 then_block,\n@@ -257,7 +253,10 @@ fn pick_pattern_and_expr_order(\n \n fn is_empty_expr(expr: &ast::Expr) -> bool {\n     match expr {\n-        ast::Expr::BlockExpr(expr) => expr.is_empty(),\n+        ast::Expr::BlockExpr(expr) => match expr.stmt_list() {\n+            Some(it) => it.statements().next().is_none() && it.tail_expr().is_none(),\n+            None => true,\n+        },\n         ast::Expr::TupleExpr(expr) => expr.fields().next().is_none(),\n         _ => false,\n     }"}, {"sha": "800befb04bd8377a0e5201d098d4f15b686c6e98", "filename": "crates/syntax/src/ast/node_ext.rs", "status": "modified", "additions": 1, "deletions": 11, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/5faf07d0829aff91387fcb63798eb7cbbecb1438/crates%2Fsyntax%2Fsrc%2Fast%2Fnode_ext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5faf07d0829aff91387fcb63798eb7cbbecb1438/crates%2Fsyntax%2Fsrc%2Fast%2Fnode_ext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fsyntax%2Fsrc%2Fast%2Fnode_ext.rs?ref=5faf07d0829aff91387fcb63798eb7cbbecb1438", "patch": "@@ -10,10 +10,7 @@ use parser::SyntaxKind;\n use rowan::{GreenNodeData, GreenTokenData};\n \n use crate::{\n-    ast::{\n-        self, support, AstNode, AstToken, HasAttrs, HasGenericParams, HasModuleItem, HasName,\n-        SyntaxNode,\n-    },\n+    ast::{self, support, AstNode, AstToken, HasAttrs, HasGenericParams, HasName, SyntaxNode},\n     NodeOrToken, SmolStr, SyntaxElement, SyntaxToken, TokenText, T,\n };\n \n@@ -54,13 +51,6 @@ impl ast::HasModuleItem for ast::StmtList {}\n \n impl ast::BlockExpr {\n     // FIXME: remove all these methods, they belong to ast::StmtList\n-    pub fn items(&self) -> impl Iterator<Item = ast::Item> {\n-        self.stmt_list().into_iter().flat_map(|it| it.items())\n-    }\n-\n-    pub fn is_empty(&self) -> bool {\n-        self.statements().next().is_none() && self.tail_expr().is_none()\n-    }\n     pub fn statements(&self) -> impl Iterator<Item = ast::Stmt> {\n         self.stmt_list().into_iter().flat_map(|it| it.statements())\n     }"}]}