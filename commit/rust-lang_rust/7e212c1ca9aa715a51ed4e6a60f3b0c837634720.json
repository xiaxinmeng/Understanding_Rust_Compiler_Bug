{"sha": "7e212c1ca9aa715a51ed4e6a60f3b0c837634720", "node_id": "C_kwDOAAsO6NoAKDdlMjEyYzFjYTlhYTcxNWE1MWVkNGU2YTYwZjNiMGM4Mzc2MzQ3MjA", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-02-02T18:34:03Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-02-02T18:34:03Z"}, "message": "Rollup merge of #93542 - GuillaumeGomez:lifetime-elision, r=oli-obk\n\nPrevent lifetime elision in type alias\n\nFixes #93401.\n\nApparently, the problem has been fixed in the compiler.\n\nr? `@oli-obk`", "tree": {"sha": "c471746260c9d99a129f938acf5071f1ea806c91", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c471746260c9d99a129f938acf5071f1ea806c91"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7e212c1ca9aa715a51ed4e6a60f3b0c837634720", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJh+s6bCRBK7hj4Ov3rIwAAML4IAG9cMEeTfUnwn0Vgbw34l1rA\nf0NpB6HiTguy+gJYtruqs5fC7HnFGEH6ihdYqLhoFua3v6niHyTxj4VA0o0HSZ67\nbc8i7zap1qVUv9wZjKSh8xl95EwmucuCdIdX+kPGeFBW4GwCc+pX3Jz4YgwIsOWI\ngHVgDPWCWCDf6oAA6pAkoJOoYynnB5/BOJPj149I+PvuII4sxFfmJi/ekKf3Skyw\n4TkZnvXf8ZeGbk/7/iyre+j2+0S7wUy/hEqWvq/YMlTVKSK1sqLvpgTo80rh6kG7\nJNpZP/3foV7zpwmnYCuYlh672P6dhzmY/PSqXz9gHVKJFh3jQ7sHVOCb9CfXvn8=\n=uVvy\n-----END PGP SIGNATURE-----\n", "payload": "tree c471746260c9d99a129f938acf5071f1ea806c91\nparent b622552e1002739a279a1e3a151ca2a241c94ead\nparent 230846433df2acde778b31fb1b3d3e194c29a0af\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1643826843 +0100\ncommitter GitHub <noreply@github.com> 1643826843 +0100\n\nRollup merge of #93542 - GuillaumeGomez:lifetime-elision, r=oli-obk\n\nPrevent lifetime elision in type alias\n\nFixes #93401.\n\nApparently, the problem has been fixed in the compiler.\n\nr? `@oli-obk`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7e212c1ca9aa715a51ed4e6a60f3b0c837634720", "html_url": "https://github.com/rust-lang/rust/commit/7e212c1ca9aa715a51ed4e6a60f3b0c837634720", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7e212c1ca9aa715a51ed4e6a60f3b0c837634720/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b622552e1002739a279a1e3a151ca2a241c94ead", "url": "https://api.github.com/repos/rust-lang/rust/commits/b622552e1002739a279a1e3a151ca2a241c94ead", "html_url": "https://github.com/rust-lang/rust/commit/b622552e1002739a279a1e3a151ca2a241c94ead"}, {"sha": "230846433df2acde778b31fb1b3d3e194c29a0af", "url": "https://api.github.com/repos/rust-lang/rust/commits/230846433df2acde778b31fb1b3d3e194c29a0af", "html_url": "https://github.com/rust-lang/rust/commit/230846433df2acde778b31fb1b3d3e194c29a0af"}], "stats": {"total": 21, "additions": 18, "deletions": 3}, "files": [{"sha": "95404b33822e363e1b26fcb545066d954f6056ab", "filename": "src/librustdoc/clean/mod.rs", "status": "modified", "additions": 13, "deletions": 3, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/7e212c1ca9aa715a51ed4e6a60f3b0c837634720/src%2Flibrustdoc%2Fclean%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7e212c1ca9aa715a51ed4e6a60f3b0c837634720/src%2Flibrustdoc%2Fclean%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Fmod.rs?ref=7e212c1ca9aa715a51ed4e6a60f3b0c837634720", "patch": "@@ -1427,15 +1427,25 @@ fn normalize<'tcx>(cx: &mut DocContext<'tcx>, ty: Ty<'_>) -> Option<Ty<'tcx>> {\n         return None;\n     }\n \n+    use crate::rustc_trait_selection::infer::TyCtxtInferExt;\n+    use crate::rustc_trait_selection::traits::query::normalize::AtExt;\n+    use rustc_middle::traits::ObligationCause;\n+\n     // Try to normalize `<X as Y>::T` to a type\n     let lifted = ty.lift_to_tcx(cx.tcx).unwrap();\n-    match cx.tcx.try_normalize_erasing_regions(cx.param_env, lifted) {\n+    let normalized = cx.tcx.infer_ctxt().enter(|infcx| {\n+        infcx\n+            .at(&ObligationCause::dummy(), cx.param_env)\n+            .normalize(lifted)\n+            .map(|resolved| infcx.resolve_vars_if_possible(resolved.value))\n+    });\n+    match normalized {\n         Ok(normalized_value) => {\n-            trace!(\"normalized {:?} to {:?}\", ty, normalized_value);\n+            debug!(\"normalized {:?} to {:?}\", ty, normalized_value);\n             Some(normalized_value)\n         }\n         Err(err) => {\n-            info!(\"failed to normalize {:?}: {:?}\", ty, err);\n+            debug!(\"failed to normalize {:?}: {:?}\", ty, err);\n             None\n         }\n     }"}, {"sha": "5d30a745a61a6027e4d3c8dab75fb571baff0717", "filename": "src/test/rustdoc/lifetime-name.rs", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/7e212c1ca9aa715a51ed4e6a60f3b0c837634720/src%2Ftest%2Frustdoc%2Flifetime-name.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7e212c1ca9aa715a51ed4e6a60f3b0c837634720/src%2Ftest%2Frustdoc%2Flifetime-name.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Flifetime-name.rs?ref=7e212c1ca9aa715a51ed4e6a60f3b0c837634720", "patch": "@@ -0,0 +1,5 @@\n+#![crate_name = \"foo\"]\n+\n+// @has 'foo/type.Resolutions.html'\n+// @has - '//*[@class=\"rust typedef\"]' \"pub type Resolutions<'tcx> = &'tcx u8;\"\n+pub type Resolutions<'tcx> = &'tcx u8;"}]}