{"sha": "58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU4ZmY0ZjY3ZTNhMWQwOTlkM2M0Y2I4Y2NiNTU0ZWU5ZmQwYTE2Y2Q=", "commit": {"author": {"name": "Robin Kruppe", "email": "robin.kruppe@gmail.com", "date": "2017-03-05T15:11:11Z"}, "committer": {"name": "Robin Kruppe", "email": "robin.kruppe@gmail.com", "date": "2017-03-09T14:07:42Z"}, "message": "rustbuild: expose LLVM_PARALLEL_LINK_JOBS\n\nThis allows limiting the number of linker jobs to avoid swapping when\nlinking LLVM with debug info.", "tree": {"sha": "ac7f8e861aaf3a04b56922f8d94e6645cd5ee856", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ac7f8e861aaf3a04b56922f8d94e6645cd5ee856"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd", "html_url": "https://github.com/rust-lang/rust/commit/58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd/comments", "author": null, "committer": null, "parents": [{"sha": "3087a1f39eaeac9d76c8b159dcc64de515bb2b83", "url": "https://api.github.com/repos/rust-lang/rust/commits/3087a1f39eaeac9d76c8b159dcc64de515bb2b83", "html_url": "https://github.com/rust-lang/rust/commit/3087a1f39eaeac9d76c8b159dcc64de515bb2b83"}], "stats": {"total": 17, "additions": 17, "deletions": 0}, "files": [{"sha": "87c35e0502ce6d853ce5ad0ff95e1668b9bacead", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd", "patch": "@@ -59,6 +59,7 @@ pub struct Config {\n     pub llvm_static_stdcpp: bool,\n     pub llvm_link_shared: bool,\n     pub llvm_targets: Option<String>,\n+    pub llvm_link_jobs: Option<u32>,\n \n     // rust codegen options\n     pub rust_optimize: bool,\n@@ -179,6 +180,7 @@ struct Llvm {\n     version_check: Option<bool>,\n     static_libstdcpp: Option<bool>,\n     targets: Option<String>,\n+    link_jobs: Option<u32>,\n }\n \n #[derive(RustcDecodable, Default, Clone)]\n@@ -333,6 +335,7 @@ impl Config {\n             set(&mut config.llvm_version_check, llvm.version_check);\n             set(&mut config.llvm_static_stdcpp, llvm.static_libstdcpp);\n             config.llvm_targets = llvm.targets.clone();\n+            config.llvm_link_jobs = llvm.link_jobs;\n         }\n \n         if let Some(ref rust) = toml.rust {"}, {"sha": "776bd729119e24458de1038d90252139159420a4", "filename": "src/bootstrap/config.toml.example", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd/src%2Fbootstrap%2Fconfig.toml.example", "raw_url": "https://github.com/rust-lang/rust/raw/58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd/src%2Fbootstrap%2Fconfig.toml.example", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.toml.example?ref=58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd", "patch": "@@ -53,6 +53,14 @@\n # Rust team and file an issue if you need assistance in porting!\n #targets = \"X86;ARM;AArch64;Mips;PowerPC;SystemZ;JSBackend;MSP430;Sparc;NVPTX\"\n \n+# Cap the number of parallel linker invocations when compiling LLVM.\n+# This can be useful when building LLVM with debug info, which significantly\n+# increases the size of binaries and consequently the memory required by\n+# each linker process.\n+# If absent or 0, linker invocations are treated like any other job and\n+# controlled by rustbuild's -j parameter.\n+#link-jobs = 0\n+\n # =============================================================================\n # General build configuration options\n # ============================================================================="}, {"sha": "c13235b9c76804cb9bbb572091307b894c7e4f24", "filename": "src/bootstrap/native.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd/src%2Fbootstrap%2Fnative.rs", "raw_url": "https://github.com/rust-lang/rust/raw/58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd/src%2Fbootstrap%2Fnative.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fnative.rs?ref=58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd", "patch": "@@ -115,6 +115,12 @@ pub fn llvm(build: &Build, target: &str) {\n         cfg.define(\"LLVM_BUILD_32_BITS\", \"ON\");\n     }\n \n+    if let Some(num_linkers) = build.config.llvm_link_jobs {\n+        if num_linkers > 0 {\n+            cfg.define(\"LLVM_PARALLEL_LINK_JOBS\", num_linkers.to_string());\n+        }\n+    }\n+\n     // http://llvm.org/docs/HowToCrossCompileLLVM.html\n     if target != build.config.build {\n         // FIXME: if the llvm root for the build triple is overridden then we"}]}