{"sha": "da064ef884994df1889d6a083349fb0bf6954400", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRhMDY0ZWY4ODQ5OTRkZjE4ODlkNmEwODMzNDlmYjBiZjY5NTQ0MDA=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-10-29T22:04:44Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-10-29T22:04:44Z"}, "message": "Add more logging to crate resolution", "tree": {"sha": "fe5326b17a43991682c2cacea04789eae73ec5e4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fe5326b17a43991682c2cacea04789eae73ec5e4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/da064ef884994df1889d6a083349fb0bf6954400", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/da064ef884994df1889d6a083349fb0bf6954400", "html_url": "https://github.com/rust-lang/rust/commit/da064ef884994df1889d6a083349fb0bf6954400", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/da064ef884994df1889d6a083349fb0bf6954400/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e0abcf3cd5d59b00fca4e0d614332bb9044ec542", "url": "https://api.github.com/repos/rust-lang/rust/commits/e0abcf3cd5d59b00fca4e0d614332bb9044ec542", "html_url": "https://github.com/rust-lang/rust/commit/e0abcf3cd5d59b00fca4e0d614332bb9044ec542"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "de504efb008d2ae4430190935349387c45e0a2ba", "filename": "src/comp/metadata/creader.rs", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/da064ef884994df1889d6a083349fb0bf6954400/src%2Fcomp%2Fmetadata%2Fcreader.rs", "raw_url": "https://github.com/rust-lang/rust/raw/da064ef884994df1889d6a083349fb0bf6954400/src%2Fcomp%2Fmetadata%2Fcreader.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmetadata%2Fcreader.rs?ref=da064ef884994df1889d6a083349fb0bf6954400", "patch": "@@ -88,7 +88,13 @@ fn metadata_matches(crate_data: @[u8], metas: [@ast::meta_item]) -> bool {\n     log #fmt[\"matching %u metadata requirements against %u items\",\n              vec::len(metas), vec::len(linkage_metas)];\n \n+    log #fmt(\"crate metadata:\");\n+    for have: @ast::meta_item in linkage_metas {\n+        log #fmt(\"  %s\", pprust::meta_item_to_str(*have));\n+    }\n+\n     for needed: @ast::meta_item in metas {\n+        log #fmt[\"looking for %s\", pprust::meta_item_to_str(*needed)];\n         if !attr::contains(linkage_metas, needed) {\n             log #fmt[\"missing %s\", pprust::meta_item_to_str(*needed)];\n             ret false;\n@@ -147,12 +153,14 @@ fn find_library_crate_aux(nn: {prefix: str, suffix: str}, crate_name: str,\n     let suffix: str = nn.suffix;\n \n     ret filesearch::search(filesearch, { |path|\n+        log #fmt(\"inspecting file %s\", path);\n         let f: str = fs::basename(path);\n         if !(str::starts_with(f, prefix) && str::ends_with(f, suffix)) {\n             log #fmt[\"skipping %s, doesn't look like %s*%s\", path, prefix,\n                      suffix];\n             option::none\n         } else {\n+            log #fmt(\"%s is a candidate\", path);\n             alt get_metadata_section(path) {\n               option::some(cvec) {\n                 if !metadata_matches(cvec, metas) {\n@@ -163,7 +171,10 @@ fn find_library_crate_aux(nn: {prefix: str, suffix: str}, crate_name: str,\n                     option::some({ident: path, data: cvec})\n                 }\n               }\n-              _ { option::none }\n+              _ {\n+                log #fmt(\"could not load metadata for %s\", path);\n+                option::none\n+              }\n             }\n         }\n     });"}]}