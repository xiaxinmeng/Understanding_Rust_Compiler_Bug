{"sha": "01675f34e06f5e59c71d28179dd4f62fe5437403", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAxNjc1ZjM0ZTA2ZjVlNTljNzFkMjgxNzlkZDRmNjJmZTU0Mzc0MDM=", "commit": {"author": {"name": "Rafael \u00c1vila de Esp\u00edndola", "email": "respindola@mozilla.com", "date": "2011-07-25T20:18:39Z"}, "committer": {"name": "Rafael \u00c1vila de Esp\u00edndola", "email": "respindola@mozilla.com", "date": "2011-07-25T20:18:39Z"}, "message": "Remove old hack of creating a .a file with code that existed both in rust\nand on newer versions of llvm.", "tree": {"sha": "6b378ca862a57a4eddc2b224f5eaaf8932fd0337", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6b378ca862a57a4eddc2b224f5eaaf8932fd0337"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/01675f34e06f5e59c71d28179dd4f62fe5437403", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/01675f34e06f5e59c71d28179dd4f62fe5437403", "html_url": "https://github.com/rust-lang/rust/commit/01675f34e06f5e59c71d28179dd4f62fe5437403", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/01675f34e06f5e59c71d28179dd4f62fe5437403/comments", "author": null, "committer": null, "parents": [{"sha": "758c11b22c2ae02520b8983cb681726f86dad9de", "url": "https://api.github.com/repos/rust-lang/rust/commits/758c11b22c2ae02520b8983cb681726f86dad9de", "html_url": "https://github.com/rust-lang/rust/commit/758c11b22c2ae02520b8983cb681726f86dad9de"}], "stats": {"total": 23, "additions": 3, "deletions": 20}, "files": [{"sha": "c519ea15f0d73ce827864773e567c28aa5251e47", "filename": "mk/rustllvm.mk", "status": "modified", "additions": 3, "deletions": 20, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/01675f34e06f5e59c71d28179dd4f62fe5437403/mk%2Frustllvm.mk", "raw_url": "https://github.com/rust-lang/rust/raw/01675f34e06f5e59c71d28179dd4f62fe5437403/mk%2Frustllvm.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Frustllvm.mk?ref=01675f34e06f5e59c71d28179dd4f62fe5437403", "patch": "@@ -2,39 +2,22 @@\n # rustc LLVM-extensions (C++) library variables and rules\n ######################################################################\n \n-RUSTLLVM_LIB_CS := $(addprefix rustllvm/, Passes.cpp)\n-\n-RUSTLLVM_OBJS_CS := $(addprefix rustllvm/, RustWrapper.cpp)\n+RUSTLLVM_OBJS_CS := $(addprefix rustllvm/, Passes.cpp RustWrapper.cpp)\n \n RUSTLLVM_DEF := rustllvm/rustllvm$(CFG_DEF_SUFFIX)\n \n RUSTLLVM_INCS := -iquote $(CFG_LLVM_INCDIR) \\\n                  -iquote $(S)src/rustllvm/include\n-RUSTLLVM_LIB_OBJS := $(RUSTLLVM_LIB_CS:.cpp=.o)\n RUSTLLVM_OBJS_OBJS := $(RUSTLLVM_OBJS_CS:.cpp=.o)\n \n-\n-# FIXME: Building a .a is a hack so that we build with both older and newer\n-# versions of LLVM. In newer versions some of the bits of this library are\n-# already in LLVM itself, so they are skipped.\n-rustllvm/rustllvmbits.a: $(RUSTLLVM_LIB_OBJS)\n-\t@$(call E, archive: $@)\n-\t$(Q)rm -f $@\n-\t$(Q)$(CFG_GCCISH_CROSS)ar crs $@ $^\n-\t$(Q)$(CFG_GCCISH_CROSS)ranlib $@\n-\n-# Note: We pass $(CFG_LLVM_LIBS) twice to fix the windows link since\n-# it has no -whole-archive.\n-rustllvm/$(CFG_RUSTLLVM): rustllvm/rustllvmbits.a $(RUSTLLVM_OBJS_OBJS) \\\n+rustllvm/$(CFG_RUSTLLVM): $(RUSTLLVM_OBJS_OBJS) \\\n                           $(MKFILES) $(RUSTLLVM_DEF)\n \t@$(call E, link: $@)\n \t$(Q)$(call CFG_LINK_C,$@,$(RUSTLLVM_OBJS_OBJS) \\\n \t  $(CFG_GCCISH_PRE_LIB_FLAGS) $(CFG_LLVM_LIBS) \\\n-          $(CFG_GCCISH_POST_LIB_FLAGS) rustllvm/rustllvmbits.a \\\n-\t  $(CFG_LLVM_LIBS) \\\n+          $(CFG_GCCISH_POST_LIB_FLAGS) \\\n           $(CFG_LLVM_LDFLAGS),$(RUSTLLVM_DEF))\n \n-\n rustllvm/%.o: rustllvm/%.cpp $(MKFILES)\n \t@$(call E, compile: $@)\n \t$(Q)$(call CFG_COMPILE_C, $@, $(CFG_LLVM_CXXFLAGS) $(RUSTLLVM_INCS)) $<"}]}