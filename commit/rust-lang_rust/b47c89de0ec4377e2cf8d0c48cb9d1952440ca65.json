{"sha": "b47c89de0ec4377e2cf8d0c48cb9d1952440ca65", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI0N2M4OWRlMGVjNDM3N2UyY2Y4ZDBjNDhjYjlkMTk1MjQ0MGNhNjU=", "commit": {"author": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2019-12-31T11:25:23Z"}, "committer": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2019-12-31T14:56:28Z"}, "message": "Remove unnecessary check from temporal_order", "tree": {"sha": "3f8da213ac4e4f4670b9edfb55987443326e2304", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3f8da213ac4e4f4670b9edfb55987443326e2304"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b47c89de0ec4377e2cf8d0c48cb9d1952440ca65", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b47c89de0ec4377e2cf8d0c48cb9d1952440ca65", "html_url": "https://github.com/rust-lang/rust/commit/b47c89de0ec4377e2cf8d0c48cb9d1952440ca65", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b47c89de0ec4377e2cf8d0c48cb9d1952440ca65/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "790132523f051bd1396db9e9c46a18e8c3dcd19b", "url": "https://api.github.com/repos/rust-lang/rust/commits/790132523f051bd1396db9e9c46a18e8c3dcd19b", "html_url": "https://github.com/rust-lang/rust/commit/790132523f051bd1396db9e9c46a18e8c3dcd19b"}], "stats": {"total": 28, "additions": 4, "deletions": 24}, "files": [{"sha": "ef0f99bf6b258a21bd176edf4eebeff2c1f23205", "filename": "src/optimize/stack2reg.rs", "status": "modified", "additions": 4, "deletions": 24, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/b47c89de0ec4377e2cf8d0c48cb9d1952440ca65/src%2Foptimize%2Fstack2reg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b47c89de0ec4377e2cf8d0c48cb9d1952440ca65/src%2Foptimize%2Fstack2reg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Foptimize%2Fstack2reg.rs?ref=b47c89de0ec4377e2cf8d0c48cb9d1952440ca65", "patch": "@@ -382,30 +382,10 @@ fn temporal_order(ctx: &Context, src: Inst, dest: Inst) -> TemporalOrder {\n     debug_assert_ne!(src, dest);\n \n     if ctx.domtree.dominates(src, dest, &ctx.func.layout) {\n-        return TemporalOrder::DefinitivelyBefore;\n+        TemporalOrder::DefinitivelyBefore\n     } else if ctx.domtree.dominates(src, dest, &ctx.func.layout) {\n-        return TemporalOrder::NeverBefore;\n+        TemporalOrder::NeverBefore\n+    } else {\n+        TemporalOrder::MaybeBefore\n     }\n-\n-    let src_ebb = ctx.func.layout.inst_ebb(src).unwrap();\n-    let dest_ebb = ctx.func.layout.inst_ebb(dest).unwrap();\n-\n-    // FIXME O(stack_load count * ebb count)\n-    // FIXME reuse memory allocations\n-    let mut visited = EntitySet::new();\n-    let mut todo = EntitySet::new();\n-    todo.insert(dest_ebb);\n-    while let Some(ebb) = todo.pop() {\n-        if visited.contains(ebb) {\n-            continue;\n-        }\n-        visited.insert(ebb);\n-        if ebb == src_ebb {\n-            return TemporalOrder::MaybeBefore;\n-        }\n-        for bb in ctx.cfg.pred_iter(ebb) {\n-            todo.insert(bb.ebb);\n-        }\n-    }\n-    TemporalOrder::NeverBefore\n }"}]}