{"sha": "028fd634bbf5253b1c1455e341e9b91424c44f39", "node_id": "C_kwDOAAsO6NoAKDAyOGZkNjM0YmJmNTI1M2IxYzE0NTVlMzQxZTliOTE0MjRjNDRmMzk", "commit": {"author": {"name": "Joshua Nelson", "email": "jnelson@cloudflare.com", "date": "2022-06-19T21:19:56Z"}, "committer": {"name": "Joshua Nelson", "email": "jnelson@cloudflare.com", "date": "2022-06-26T09:44:47Z"}, "message": "Respect --color when building rustbuild itself", "tree": {"sha": "1a81b65a51cf96ff416519efba1aeed851aab868", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1a81b65a51cf96ff416519efba1aeed851aab868"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/028fd634bbf5253b1c1455e341e9b91424c44f39", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/028fd634bbf5253b1c1455e341e9b91424c44f39", "html_url": "https://github.com/rust-lang/rust/commit/028fd634bbf5253b1c1455e341e9b91424c44f39", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/028fd634bbf5253b1c1455e341e9b91424c44f39/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0e1a6fb463e7075572cee841525bf44a864da807", "url": "https://api.github.com/repos/rust-lang/rust/commits/0e1a6fb463e7075572cee841525bf44a864da807", "html_url": "https://github.com/rust-lang/rust/commit/0e1a6fb463e7075572cee841525bf44a864da807"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "8000e60f64d470ecd5c57d9d6b36a1245ccb24d0", "filename": "src/bootstrap/bootstrap.py", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/028fd634bbf5253b1c1455e341e9b91424c44f39/src%2Fbootstrap%2Fbootstrap.py", "raw_url": "https://github.com/rust-lang/rust/raw/028fd634bbf5253b1c1455e341e9b91424c44f39/src%2Fbootstrap%2Fbootstrap.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbootstrap.py?ref=028fd634bbf5253b1c1455e341e9b91424c44f39", "patch": "@@ -743,7 +743,7 @@ def bootstrap_binary(self):\n         \"\"\"\n         return os.path.join(self.build_dir, \"bootstrap\", \"debug\", \"bootstrap\")\n \n-    def build_bootstrap(self):\n+    def build_bootstrap(self, color):\n         \"\"\"Build bootstrap\"\"\"\n         print(\"Building rustbuild\")\n         build_dir = os.path.join(self.build_dir, \"bootstrap\")\n@@ -800,6 +800,11 @@ def build_bootstrap(self):\n         if self.get_toml(\"metrics\", \"build\"):\n             args.append(\"--features\")\n             args.append(\"build-metrics\")\n+        if color == \"always\":\n+            args.append(\"--color=always\")\n+        elif color == \"never\":\n+            args.append(\"--color=never\")\n+\n         run(args, env=env, verbose=self.verbose)\n \n     def build_triple(self):\n@@ -862,6 +867,7 @@ def bootstrap(help_triggered):\n     parser = argparse.ArgumentParser(description='Build rust')\n     parser.add_argument('--config')\n     parser.add_argument('--build')\n+    parser.add_argument('--color', choices=['always', 'never', 'auto'])\n     parser.add_argument('--clean', action='store_true')\n     parser.add_argument('-v', '--verbose', action='count', default=0)\n \n@@ -930,7 +936,7 @@ def bootstrap(help_triggered):\n     # Fetch/build the bootstrap\n     build.download_toolchain()\n     sys.stdout.flush()\n-    build.build_bootstrap()\n+    build.build_bootstrap(args.color)\n     sys.stdout.flush()\n \n     # Run the bootstrap"}]}