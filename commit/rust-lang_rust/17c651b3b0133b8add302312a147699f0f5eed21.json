{"sha": "17c651b3b0133b8add302312a147699f0f5eed21", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE3YzY1MWIzYjAxMzNiOGFkZDMwMjMxMmExNDc2OTlmMGY1ZWVkMjE=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-10-27T03:39:02Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-10-27T03:43:47Z"}, "message": "Remove task::join_id\n\nThis is the old, racy way of joining to a task. It is no longer used.", "tree": {"sha": "c1acce4e37706c71f4a29242f6e629e339ea6c99", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c1acce4e37706c71f4a29242f6e629e339ea6c99"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/17c651b3b0133b8add302312a147699f0f5eed21", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/17c651b3b0133b8add302312a147699f0f5eed21", "html_url": "https://github.com/rust-lang/rust/commit/17c651b3b0133b8add302312a147699f0f5eed21", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/17c651b3b0133b8add302312a147699f0f5eed21/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4d669036f3264403f1663b14997a1e30db7b7e73", "url": "https://api.github.com/repos/rust-lang/rust/commits/4d669036f3264403f1663b14997a1e30db7b7e73", "html_url": "https://github.com/rust-lang/rust/commit/4d669036f3264403f1663b14997a1e30db7b7e73"}], "stats": {"total": 32, "additions": 0, "deletions": 32}, "files": [{"sha": "5470cb06c9c75b1dbe80a88aa19d55f9bd16444f", "filename": "src/lib/task.rs", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/17c651b3b0133b8add302312a147699f0f5eed21/src%2Flib%2Ftask.rs", "raw_url": "https://github.com/rust-lang/rust/raw/17c651b3b0133b8add302312a147699f0f5eed21/src%2Flib%2Ftask.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib%2Ftask.rs?ref=17c651b3b0133b8add302312a147699f0f5eed21", "patch": "@@ -27,7 +27,6 @@ native \"cdecl\" mod rustrt {\n     fn task_sleep(time_in_us: uint);\n     fn task_yield();\n     fn start_task(id: task_id, closure: *u8);\n-    fn task_join(t: task_id) -> int;\n }\n \n native \"c-stack-cdecl\" mod rustrt2 = \"rustrt\" {\n@@ -83,10 +82,6 @@ fn join(task_port: (task_id, comm::port<task_notification>)) -> task_result {\n     }\n }\n \n-fn join_id(t: task_id) -> task_result {\n-    alt rustrt::task_join(t) { 0 { tr_success } _ { tr_failure } }\n-}\n-\n fn unsupervise() { ret sys::unsupervise(); }\n \n fn pin() { rustrt2::pin_task(); }"}, {"sha": "d05682170d2aa160caa748e5dbb21ba690fcd98d", "filename": "src/rt/rust_builtin.cpp", "status": "modified", "additions": 0, "deletions": 26, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/17c651b3b0133b8add302312a147699f0f5eed21/src%2Frt%2Frust_builtin.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/17c651b3b0133b8add302312a147699f0f5eed21/src%2Frt%2Frust_builtin.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_builtin.cpp?ref=17c651b3b0133b8add302312a147699f0f5eed21", "patch": "@@ -177,32 +177,6 @@ task_yield() {\n     task->yield(1);\n }\n \n-extern \"C\" CDECL intptr_t\n-task_join(rust_task_id tid) {\n-    rust_task *task = rust_scheduler::get_task();\n-    // If the other task is already dying, we don't have to wait for it.\n-    rust_task *join_task = task->kernel->get_task_by_id(tid);\n-    // FIXME: find task exit status and return that.\n-    if(!join_task) return 0;\n-    join_task->lock.lock();\n-    if (join_task->dead() == false) {\n-        join_task->tasks_waiting_to_join.push(task);\n-        task->block(join_task, \"joining local task\");\n-        join_task->lock.unlock();\n-        task->yield(2);\n-    }\n-    else {\n-        join_task->lock.unlock();\n-    }\n-    if (!join_task->failed) {\n-        join_task->deref();\n-        return 0;\n-    } else {\n-        join_task->deref();\n-        return -1;\n-    }\n-}\n-\n /* Debug builtins for std::dbg. */\n \n static void"}, {"sha": "192774d350fef4dd179fdc43085b68042746b831", "filename": "src/rt/rustrt.def.in", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/17c651b3b0133b8add302312a147699f0f5eed21/src%2Frt%2Frustrt.def.in", "raw_url": "https://github.com/rust-lang/rust/raw/17c651b3b0133b8add302312a147699f0f5eed21/src%2Frt%2Frustrt.def.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frustrt.def.in?ref=17c651b3b0133b8add302312a147699f0f5eed21", "patch": "@@ -61,7 +61,6 @@ vec_reserve_shared\n vec_from_buf_shared\n task_sleep\n task_yield\n-task_join\n unsupervise\n upcall_alloc_c_stack\n upcall_call_c_stack"}]}