{"sha": "6527fc392536b0f72f652e85a9950ede9f363494", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY1MjdmYzM5MjUzNmIwZjcyZjY1MmU4NWE5OTUwZWRlOWYzNjM0OTQ=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-02-21T22:25:31Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-02-21T22:25:31Z"}, "message": "core: Fix to_str_exact for floats with no decimal component", "tree": {"sha": "5192af7640421f7e86f8113f70a95a070eece35b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5192af7640421f7e86f8113f70a95a070eece35b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6527fc392536b0f72f652e85a9950ede9f363494", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6527fc392536b0f72f652e85a9950ede9f363494", "html_url": "https://github.com/rust-lang/rust/commit/6527fc392536b0f72f652e85a9950ede9f363494", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6527fc392536b0f72f652e85a9950ede9f363494/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "910a32c7c777296be0992bf0d6f2d66261c407d6", "url": "https://api.github.com/repos/rust-lang/rust/commits/910a32c7c777296be0992bf0d6f2d66261c407d6", "html_url": "https://github.com/rust-lang/rust/commit/910a32c7c777296be0992bf0d6f2d66261c407d6"}], "stats": {"total": 9, "additions": 8, "deletions": 1}, "files": [{"sha": "c4e6e0403199d1b5859a5802231fd943bb01b40f", "filename": "src/libcore/float.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/6527fc392536b0f72f652e85a9950ede9f363494/src%2Flibcore%2Ffloat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6527fc392536b0f72f652e85a9950ede9f363494/src%2Flibcore%2Ffloat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Ffloat.rs?ref=6527fc392536b0f72f652e85a9950ede9f363494", "patch": "@@ -52,7 +52,7 @@ fn to_str_common(num: float, digits: uint, exact: bool) -> str {\n     let trunc = num as uint;\n     let frac = num - (trunc as float);\n     accum += uint::str(trunc);\n-    if frac < epsilon || digits == 0u { ret accum; }\n+    if (frac < epsilon && !exact) || digits == 0u { ret accum; }\n     accum += \".\";\n     let i = digits;\n     let epsilon = 1. / pow_uint_to_uint_as_float(10u, i);\n@@ -83,6 +83,12 @@ fn to_str_exact(num: float, digits: uint) -> str {\n     to_str_common(num, digits, true)\n }\n \n+#[test]\n+fn test_to_str_exact_do_decimal() {\n+    let s = to_str_exact(5.0, 4u);\n+    assert s == \"5.0000\";\n+}\n+\n /*\n Function: to_str\n "}, {"sha": "985b31770143bb8a1fed0158fc890baccdfc8229", "filename": "src/test/run-pass/syntax-extension-fmt.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/6527fc392536b0f72f652e85a9950ede9f363494/src%2Ftest%2Frun-pass%2Fsyntax-extension-fmt.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6527fc392536b0f72f652e85a9950ede9f363494/src%2Ftest%2Frun-pass%2Fsyntax-extension-fmt.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fsyntax-extension-fmt.rs?ref=6527fc392536b0f72f652e85a9950ede9f363494", "patch": "@@ -136,6 +136,7 @@ fn part4() {\n     test(#fmt[\"%.5t\", 3u], \"00011\");\n     test(#fmt[\"%.5c\", 'A'], \"A\");\n     test(#fmt[\"%.5f\", 5.82], \"5.82000\");\n+    test(#fmt[\"%.5f\", 5.0], \"5.00000\");\n     // Bool precision. I'm not sure if it's good or bad to have bool\n     // conversions support precision - it's not standard printf so we\n     // can do whatever. For now I'm making it behave the same as string"}]}