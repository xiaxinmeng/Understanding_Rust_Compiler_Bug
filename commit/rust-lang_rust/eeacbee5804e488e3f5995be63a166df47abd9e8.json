{"sha": "eeacbee5804e488e3f5995be63a166df47abd9e8", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVlYWNiZWU1ODA0ZTQ4OGUzZjU5OTViZTYzYTE2NmRmNDdhYmQ5ZTg=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-08-08T14:33:39Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-08-08T14:33:39Z"}, "message": "Rollup merge of #63342 - ehuss:remap-path-dep-info, r=alexcrichton\n\nDon't use remap-path-prefix in dep-info files.\n\nThis changes it so that dep-info files do not use remapped paths.\n\nHaving remapped paths causes problems with Cargo because if you remap to a nonexistent path (like `/rustc/$HASH` which rustc distributions do), then Cargo's change tracking thinks the files don't exist and will always rebuild.\n\nI don't actually know if this is a good idea. I think it makes sense, but I do not know what the exact requirements are for reproducible builds. I consider these files separate from the binary artifacts generated, and as a build-system helper, so it seems reasonable to me.\n\nI'm also not sure if this needs a test. I'll definitely add one on the cargo side if this is merged.\n\nCloses #63329", "tree": {"sha": "640ced3ef10ca4361e013e0f68d7bf887c367987", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/640ced3ef10ca4361e013e0f68d7bf887c367987"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/eeacbee5804e488e3f5995be63a166df47abd9e8", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdTDLDCRBK7hj4Ov3rIwAAdHIIABV1bzfTWzvsfD5U1MsLgjIU\nOfxmT+l1+rutjuUDm+YnHIa6Cv9yIspmQebOR9MT2J1nRp/ejDp2S5tEVsS2eblk\n63TeQ9qpCKuLkYl3nZUwmWz3GBN++goCt1gF2ADQuM6pRpD7ymf4KcP30Hw7MypU\n6I6jTL8Gcs8wn8ZKethFt3aVRAtTdAJ1dJ6V4NTiXjGTq2XWihXuFtAgwr555Ysy\nrwdc3g8/jSy+osFfHm7SklUrMLo4yTd9kd9HVWEPcfpQ6ZT+M77G4yql3jkConRu\n5nqLWSpMVNn6oUK/0Y5kMiRL3wp3ZrHB7lb4eNKrdylusLF+Ro+NDSddLGbmUkc=\n=bD59\n-----END PGP SIGNATURE-----\n", "payload": "tree 640ced3ef10ca4361e013e0f68d7bf887c367987\nparent 76938abba13de41dd9da498226d6d549a29a3e47\nparent 04eee2eca2051d2b10287d87174073b73871d13b\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1565274819 +0200\ncommitter GitHub <noreply@github.com> 1565274819 +0200\n\nRollup merge of #63342 - ehuss:remap-path-dep-info, r=alexcrichton\n\nDon't use remap-path-prefix in dep-info files.\n\nThis changes it so that dep-info files do not use remapped paths.\n\nHaving remapped paths causes problems with Cargo because if you remap to a nonexistent path (like `/rustc/$HASH` which rustc distributions do), then Cargo's change tracking thinks the files don't exist and will always rebuild.\n\nI don't actually know if this is a good idea. I think it makes sense, but I do not know what the exact requirements are for reproducible builds. I consider these files separate from the binary artifacts generated, and as a build-system helper, so it seems reasonable to me.\n\nI'm also not sure if this needs a test. I'll definitely add one on the cargo side if this is merged.\n\nCloses #63329\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/eeacbee5804e488e3f5995be63a166df47abd9e8", "html_url": "https://github.com/rust-lang/rust/commit/eeacbee5804e488e3f5995be63a166df47abd9e8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/eeacbee5804e488e3f5995be63a166df47abd9e8/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "76938abba13de41dd9da498226d6d549a29a3e47", "url": "https://api.github.com/repos/rust-lang/rust/commits/76938abba13de41dd9da498226d6d549a29a3e47", "html_url": "https://github.com/rust-lang/rust/commit/76938abba13de41dd9da498226d6d549a29a3e47"}, {"sha": "04eee2eca2051d2b10287d87174073b73871d13b", "url": "https://api.github.com/repos/rust-lang/rust/commits/04eee2eca2051d2b10287d87174073b73871d13b", "html_url": "https://github.com/rust-lang/rust/commit/04eee2eca2051d2b10287d87174073b73871d13b"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "c9d68943b0880300f56744d007894412e27b2080", "filename": "src/librustc_interface/passes.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/eeacbee5804e488e3f5995be63a166df47abd9e8/src%2Flibrustc_interface%2Fpasses.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eeacbee5804e488e3f5995be63a166df47abd9e8/src%2Flibrustc_interface%2Fpasses.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2Fpasses.rs?ref=eeacbee5804e488e3f5995be63a166df47abd9e8", "patch": "@@ -661,7 +661,7 @@ fn write_out_deps(compiler: &Compiler, outputs: &OutputFilenames, out_filenames:\n             .iter()\n             .filter(|fmap| fmap.is_real_file())\n             .filter(|fmap| !fmap.is_imported())\n-            .map(|fmap| escape_dep_filename(&fmap.name))\n+            .map(|fmap| escape_dep_filename(&fmap.unmapped_path.as_ref().unwrap_or(&fmap.name)))\n             .collect();\n \n         if sess.binary_dep_depinfo() {"}]}