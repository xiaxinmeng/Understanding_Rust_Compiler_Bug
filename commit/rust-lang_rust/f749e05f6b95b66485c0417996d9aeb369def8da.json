{"sha": "f749e05f6b95b66485c0417996d9aeb369def8da", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY3NDllMDVmNmI5NWI2NjQ4NWMwNDE3OTk2ZDlhZWIzNjlkZWY4ZGE=", "commit": {"author": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2021-09-03T10:37:57Z"}, "committer": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2021-09-09T05:21:33Z"}, "message": "Allow ~const bounds on inherent impls", "tree": {"sha": "c0971e758aa1cfdaf3320dda47eb36fb2dcafb79", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c0971e758aa1cfdaf3320dda47eb36fb2dcafb79"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f749e05f6b95b66485c0417996d9aeb369def8da", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEQ7Fl7qPq2YcWF1dqAn35M4hird0FAmE5md0ACgkQAn35M4hi\nrd33QRAAnEG1OYWarNeVrMZI5vmU/84bgsgXpmLfQhLcmyzMIH5TjGlFIDsnpdBV\n3SeiFbv7DsPoEpKZYRN0eN1RCQWc9hF6qcy4BZGXPVXGDvLrOAYHyK3wToAwTb3q\nQY75k9cUT8Wb0OeMNMENArPnhX5lnRXYy5iXxZhSJiY9AxwRdfCata96pRHsFb+0\ngurEbgpvgVU1bP04lUjcINxHzTStdqhAYYiCQBWy1MgmPDo/f7XMSdKC76tfAy2J\nwRDcVbnY+dyEtF6VdenL5LEti7MqeEZM0e13KxYKdhp/J2ZhKk1gptwZ4nnOByP7\ntJ1Gj/C4CyAeCG57Aiso+MSy6ZP2H11RJXDaZgRQMKnguBQxKoZ+dx/bzUvFIorD\niSzb/8ROOI/YGCwzaGE/+bcxhLZlj9qitPKrfUGQRbrFB3wirOZ0TuyTy7F4EaxN\nO2qRbiQB20UqB5UoEqqpxMDlO7i9V/lkQc256nEa2tgmIKORnlY75vDq4crf3HdV\nvEMATZnG4ynHRG0E7WCxrfU+qqKy51QcQr7chtC3UVfjx4zX4KQYSytDJdNA+Mxs\nug49eGxgU4mavFj9yLlPGAww+9rLBlvwva+zWwyoVvAR0inDxZ05TSHgqYxSZS9q\nGNi6dQow5kOcnSGMvShof1W5brdK51kKDxTZYd9BQTig9A1h7zQ=\n=ZFlg\n-----END PGP SIGNATURE-----", "payload": "tree c0971e758aa1cfdaf3320dda47eb36fb2dcafb79\nparent 146abdd1198d25541b19ce7e17c588f041d88518\nauthor Deadbeef <ent3rm4n@gmail.com> 1630665477 +0000\ncommitter Deadbeef <ent3rm4n@gmail.com> 1631164893 +0000\n\nAllow ~const bounds on inherent impls\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f749e05f6b95b66485c0417996d9aeb369def8da", "html_url": "https://github.com/rust-lang/rust/commit/f749e05f6b95b66485c0417996d9aeb369def8da", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f749e05f6b95b66485c0417996d9aeb369def8da/comments", "author": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "146abdd1198d25541b19ce7e17c588f041d88518", "url": "https://api.github.com/repos/rust-lang/rust/commits/146abdd1198d25541b19ce7e17c588f041d88518", "html_url": "https://github.com/rust-lang/rust/commit/146abdd1198d25541b19ce7e17c588f041d88518"}], "stats": {"total": 25, "additions": 24, "deletions": 1}, "files": [{"sha": "4f355ef543c3b55fad73c1e0fe5e28aa319f08b4", "filename": "compiler/rustc_ast_passes/src/ast_validation.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/f749e05f6b95b66485c0417996d9aeb369def8da/compiler%2Frustc_ast_passes%2Fsrc%2Fast_validation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f749e05f6b95b66485c0417996d9aeb369def8da/compiler%2Frustc_ast_passes%2Fsrc%2Fast_validation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_passes%2Fsrc%2Fast_validation.rs?ref=f749e05f6b95b66485c0417996d9aeb369def8da", "patch": "@@ -1655,7 +1655,9 @@ impl<'a> Visitor<'a> for AstValidator<'a> {\n                 walk_list!(self, visit_ty, ty);\n             }\n             AssocItemKind::Fn(box FnKind(_, ref sig, ref generics, ref body))\n-                if self.in_const_trait_impl || ctxt == AssocCtxt::Trait =>\n+                if self.in_const_trait_impl\n+                    || ctxt == AssocCtxt::Trait\n+                    || matches!(sig.header.constness, Const::Yes(_)) =>\n             {\n                 self.visit_vis(&item.vis);\n                 self.visit_ident(item.ident);"}, {"sha": "fe1015b3bf7ee0549f7471612b01cc74f290a936", "filename": "src/test/ui/rfc-2632-const-trait-impl/inherent-impl-const-bounds.rs", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/f749e05f6b95b66485c0417996d9aeb369def8da/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Finherent-impl-const-bounds.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f749e05f6b95b66485c0417996d9aeb369def8da/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Finherent-impl-const-bounds.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Finherent-impl-const-bounds.rs?ref=f749e05f6b95b66485c0417996d9aeb369def8da", "patch": "@@ -0,0 +1,21 @@\n+// check-pass\n+#![feature(const_trait_impl)]\n+#![feature(const_fn_trait_bound)]\n+\n+struct S;\n+\n+trait A {}\n+trait B {}\n+\n+impl const A for S {}\n+impl const B for S {}\n+\n+impl S {\n+    const fn a<T: ~const A>() where T: ~const B {\n+\n+    }\n+}\n+\n+const _: () = S::a::<S>();\n+\n+fn main() {}"}]}