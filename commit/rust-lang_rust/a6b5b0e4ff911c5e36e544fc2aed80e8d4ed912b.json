{"sha": "a6b5b0e4ff911c5e36e544fc2aed80e8d4ed912b", "node_id": "C_kwDOAAsO6NoAKGE2YjViMGU0ZmY5MTFjNWUzNmU1NDRmYzJhZWQ4MGU4ZDRlZDkxMmI", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-05-25T16:12:54Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-05-25T16:27:20Z"}, "message": "tweak new test suite output", "tree": {"sha": "ce9aad6931c416bd78a5e266ec585a6d2eba534f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ce9aad6931c416bd78a5e266ec585a6d2eba534f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a6b5b0e4ff911c5e36e544fc2aed80e8d4ed912b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a6b5b0e4ff911c5e36e544fc2aed80e8d4ed912b", "html_url": "https://github.com/rust-lang/rust/commit/a6b5b0e4ff911c5e36e544fc2aed80e8d4ed912b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a6b5b0e4ff911c5e36e544fc2aed80e8d4ed912b/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0a4279fed9cc91e4e8921fff3b27d1c152f13b07", "url": "https://api.github.com/repos/rust-lang/rust/commits/0a4279fed9cc91e4e8921fff3b27d1c152f13b07", "html_url": "https://github.com/rust-lang/rust/commit/0a4279fed9cc91e4e8921fff3b27d1c152f13b07"}], "stats": {"total": 36, "additions": 18, "deletions": 18}, "files": [{"sha": "9ffc4744eb8586b1f90a98b9dbef5e6f3c49f15e", "filename": "tests/compiletest.rs", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/a6b5b0e4ff911c5e36e544fc2aed80e8d4ed912b/tests%2Fcompiletest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a6b5b0e4ff911c5e36e544fc2aed80e8d4ed912b/tests%2Fcompiletest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompiletest.rs?ref=a6b5b0e4ff911c5e36e544fc2aed80e8d4ed912b", "patch": "@@ -109,13 +109,11 @@ regexes! {\n fn ui(mode: Mode, path: &str) {\n     let target = get_target();\n \n-    eprint!(\"{}\", format!(\"## Running ui tests in {path} against miri for \").green().bold());\n-\n-    if let Some(target) = &target {\n-        eprintln!(\"{target}\");\n-    } else {\n-        eprintln!(\"host\");\n-    }\n+    let msg = format!(\n+        \"## Running ui tests in {path} against miri for {}\",\n+        target.as_deref().unwrap_or(\"host\")\n+    );\n+    eprintln!(\"{}\", msg.green().bold());\n \n     run_tests(mode, path, target);\n }"}, {"sha": "b779d6844a970b74b36e696ce14fdca1ec0a6a46", "filename": "ui_test/src/lib.rs", "status": "modified", "additions": 13, "deletions": 11, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/a6b5b0e4ff911c5e36e544fc2aed80e8d4ed912b/ui_test%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a6b5b0e4ff911c5e36e544fc2aed80e8d4ed912b/ui_test%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/ui_test%2Fsrc%2Flib.rs?ref=a6b5b0e4ff911c5e36e544fc2aed80e8d4ed912b", "patch": "@@ -56,7 +56,7 @@ pub fn run_tests(config: Config) {\n     // Some statistics and failure reports.\n     let failures = Mutex::new(vec![]);\n     let succeeded = AtomicUsize::default();\n-    let skipped = AtomicUsize::default();\n+    let ignored = AtomicUsize::default();\n \n     crossbeam::scope(|s| {\n         for _ in 0..std::thread::available_parallelism().unwrap().get() {\n@@ -74,10 +74,10 @@ pub fn run_tests(config: Config) {\n                         continue;\n                     }\n                     let comments = Comments::parse(&path);\n-                    // Skip file if only/skip rules do (not) apply\n+                    // Ignore file if only/ignore rules do (not) apply\n                     if ignore_file(&comments, &target) {\n-                        skipped.fetch_add(1, Ordering::Relaxed);\n-                        eprintln!(\"{} .. {}\", path.display(), \"skipped\".yellow());\n+                        ignored.fetch_add(1, Ordering::Relaxed);\n+                        eprintln!(\"{} .. {}\", path.display(), \"ignored\".yellow());\n                         continue;\n                     }\n                     // Run the test for all revisions\n@@ -91,7 +91,7 @@ pub fn run_tests(config: Config) {\n                         if !revision.is_empty() {\n                             write!(msg, \"(revision `{revision}`) \").unwrap();\n                         }\n-                        write!(msg, \" .. \").unwrap();\n+                        write!(msg, \"... \").unwrap();\n                         if errors.is_empty() {\n                             eprintln!(\"{msg}{}\", \"ok\".green());\n                             succeeded.fetch_add(1, Ordering::Relaxed);\n@@ -109,15 +109,15 @@ pub fn run_tests(config: Config) {\n     // Print all errors in a single thread to show reliable output\n     let failures = failures.into_inner().unwrap();\n     let succeeded = succeeded.load(Ordering::Relaxed);\n-    let skipped = skipped.load(Ordering::Relaxed);\n+    let ignored = ignored.load(Ordering::Relaxed);\n     if !failures.is_empty() {\n         for (path, miri, revision, errors) in &failures {\n             eprintln!();\n             eprint!(\"{}\", path.display().to_string().underline());\n             if !revision.is_empty() {\n                 eprint!(\" (revision `{}`)\", revision);\n             }\n-            eprint!(\"{}\", \" FAILED\".red());\n+            eprint!(\" {}\", \"FAILED\".red());\n             eprintln!();\n             eprintln!(\"command: {:?}\", miri);\n             eprintln!();\n@@ -153,19 +153,21 @@ pub fn run_tests(config: Config) {\n             }\n         }\n         eprintln!(\n-            \"{} tests failed, {} tests passed, {} skipped\",\n+            \"{} tests failed, {} tests passed, {} ignored\",\n             failures.len().to_string().red().bold(),\n             succeeded.to_string().green(),\n-            skipped.to_string().yellow()\n+            ignored.to_string().yellow()\n         );\n         std::process::exit(1);\n     }\n     eprintln!();\n     eprintln!(\n-        \"{} tests passed, {} skipped\",\n+        \"test result: {}. {} tests passed, {} ignored\",\n+        \"ok\".green(),\n         succeeded.to_string().green(),\n-        skipped.to_string().yellow()\n+        ignored.to_string().yellow()\n     );\n+    eprintln!();\n }\n \n #[derive(Debug)]"}]}