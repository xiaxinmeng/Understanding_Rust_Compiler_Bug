{"sha": "6fd0d1ba149a7049f2acb78ed4a93570ce36e3e4", "node_id": "C_kwDOAAsO6NoAKDZmZDBkMWJhMTQ5YTcwNDlmMmFjYjc4ZWQ0YTkzNTcwY2UzNmUzZTQ", "commit": {"author": {"name": "Pietro Albini", "email": "pietro.albini@ferrous-systems.com", "date": "2023-06-08T07:53:01Z"}, "committer": {"name": "Pietro Albini", "email": "pietro.albini@ferrous-systems.com", "date": "2023-06-12T07:34:13Z"}, "message": "make sure the standard library compiles properly with synthetic targets\n\nIt might happen that a synthetic target name does not match one of the\nhardcoded ones in std's build script, causing std to fail to build. This\ncommit changes the std build script avoid including the restricted-std\nfeature unconditionally when a synthetic target is being built.", "tree": {"sha": "351c98a350df0fa2b894cd02152d912aeef2487f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/351c98a350df0fa2b894cd02152d912aeef2487f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6fd0d1ba149a7049f2acb78ed4a93570ce36e3e4", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEMycKYjxLY0eb13b7zXazX3c0dp4FAmSGynUACgkQzXazX3c0\ndp5Lxw//YjdQGutGE+eZkfHb/LMuLdUFZdeNfpEGCpchpLBDOMHwD6M9314Hhc4X\ngHjEih/4bUDl8upQmV0Tfl+TxLFjC/mCbgNVLTIJb1firwEsfT3D84ngHcIIfy7C\nz+T9Xlge8dMsp+gixM2Gd33mRlnjHsF6+H7qNW+OWMrDivgOp6xkPCLvgrgqxrW2\nHX1ZxYi7pHu1x1P+aXwevIFGR+Bg5LL7Z6oIu3DJOlJfkCipoD/Cwt4m72uvQsUP\ns4qTZpf2/J6sDYYEOCB+b5A+zCwo6+dOcECoGuDKOpeAjlU1eTo/KY45aDpOHzah\neyKShdHdKV2CVAPk3sweRL7sz2vRImojnpGWpyzgO3hNo0XzS53/dD2ahNQ8HU0n\nrnOT6f72wqU2VDSTWd3C6bnZyBtvigP60drIOenJ7ZYok31YQ0oM1xCtTGKx+DMX\nxPCB3qYFAIrM3rOyUng2zYrzt0l4SUNFpn/J5g4FPyc82N2k1rnLvWHwSAFSd0sk\nq2Uc/RgDYLGQtnJjPwmfoO8B8sk3EE0ntkJGUBZbAnsnLhXyVdrlQedEL1+JJ2FV\noJkSzYOs/ThZtRRCXBI/yeh/lJ4xgVUqTlYc6dqbc445Qwc6VI2YXLooYzWWbgiN\nJPirZDEbot45WThcYJS7BzHpw57ihZMg0K2PH3i8PP9XdKnp9f8=\n=HDBA\n-----END PGP SIGNATURE-----", "payload": "tree 351c98a350df0fa2b894cd02152d912aeef2487f\nparent 9de3c29319a42bbfdf3c61f1bced9e2e79373452\nauthor Pietro Albini <pietro.albini@ferrous-systems.com> 1686210781 +0200\ncommitter Pietro Albini <pietro.albini@ferrous-systems.com> 1686555253 +0200\n\nmake sure the standard library compiles properly with synthetic targets\n\nIt might happen that a synthetic target name does not match one of the\nhardcoded ones in std's build script, causing std to fail to build. This\ncommit changes the std build script avoid including the restricted-std\nfeature unconditionally when a synthetic target is being built.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6fd0d1ba149a7049f2acb78ed4a93570ce36e3e4", "html_url": "https://github.com/rust-lang/rust/commit/6fd0d1ba149a7049f2acb78ed4a93570ce36e3e4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6fd0d1ba149a7049f2acb78ed4a93570ce36e3e4/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9de3c29319a42bbfdf3c61f1bced9e2e79373452", "url": "https://api.github.com/repos/rust-lang/rust/commits/9de3c29319a42bbfdf3c61f1bced9e2e79373452", "html_url": "https://github.com/rust-lang/rust/commit/9de3c29319a42bbfdf3c61f1bced9e2e79373452"}], "stats": {"total": 7, "additions": 7, "deletions": 0}, "files": [{"sha": "d0b379409369f26be661f61a37fbe4e0032ccdc4", "filename": "library/std/build.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6fd0d1ba149a7049f2acb78ed4a93570ce36e3e4/library%2Fstd%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6fd0d1ba149a7049f2acb78ed4a93570ce36e3e4/library%2Fstd%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fbuild.rs?ref=6fd0d1ba149a7049f2acb78ed4a93570ce36e3e4", "patch": "@@ -36,6 +36,8 @@ fn main() {\n         || target.contains(\"nintendo-3ds\")\n         || target.contains(\"vita\")\n         || target.contains(\"nto\")\n+        // See src/bootstrap/synthetic_targets.rs\n+        || env::var(\"RUSTC_BOOTSTRAP_SYNTHETIC_TARGET\").is_ok()\n     {\n         // These platforms don't have any special requirements.\n     } else {"}, {"sha": "14c3ef79a78f2d1f35ff7fa12a022a5b8c9c7989", "filename": "src/bootstrap/compile.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/6fd0d1ba149a7049f2acb78ed4a93570ce36e3e4/src%2Fbootstrap%2Fcompile.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6fd0d1ba149a7049f2acb78ed4a93570ce36e3e4/src%2Fbootstrap%2Fcompile.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fcompile.rs?ref=6fd0d1ba149a7049f2acb78ed4a93570ce36e3e4", "patch": "@@ -169,6 +169,11 @@ impl Step for Std {\n             cargo.arg(\"-p\").arg(krate);\n         }\n \n+        // See src/bootstrap/synthetic_targets.rs\n+        if target.is_synthetic() {\n+            cargo.env(\"RUSTC_BOOTSTRAP_SYNTHETIC_TARGET\", \"1\");\n+        }\n+\n         let _guard = builder.msg(\n             Kind::Build,\n             compiler.stage,"}]}