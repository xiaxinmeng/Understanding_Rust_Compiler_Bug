{"sha": "d9f28b7b701321d24ff9930b3f7b5d93b6fd671f", "node_id": "C_kwDOAAsO6NoAKGQ5ZjI4YjdiNzAxMzIxZDI0ZmY5OTMwYjNmN2I1ZDkzYjZmZDY3MWY", "commit": {"author": {"name": "Goldstein", "email": "root@goldstein.rs", "date": "2022-07-16T18:30:17Z"}, "committer": {"name": "Goldstein", "email": "root@goldstein.rs", "date": "2022-08-01T13:15:55Z"}, "message": "fix ICE in Definitions::create_def", "tree": {"sha": "b63fc51edaf9210d9ce6ab87d16280568eda0c68", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b63fc51edaf9210d9ce6ab87d16280568eda0c68"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d9f28b7b701321d24ff9930b3f7b5d93b6fd671f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYKAB0WIQQLry2Hy0N0b2I3LXjeYDGroLsmmgUCYufSCwAKCRDeYDGroLsm\nmi0QAQCrWVgbkODyKwRuuCfQDcky4WytWHBnkBj7WIOBBGVJ5wD/ZY7cPhouGzql\n4OrUwJeXZWmiqzNL7SjOx85c21sC0QQ=\n=Snf1\n-----END PGP SIGNATURE-----", "payload": "tree b63fc51edaf9210d9ce6ab87d16280568eda0c68\nparent e5a7d8f945f4259fb6b8c4953a65248243c054d1\nauthor Goldstein <root@goldstein.rs> 1657996217 +0300\ncommitter Goldstein <root@goldstein.rs> 1659359755 +0300\n\nfix ICE in Definitions::create_def\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d9f28b7b701321d24ff9930b3f7b5d93b6fd671f", "html_url": "https://github.com/rust-lang/rust/commit/d9f28b7b701321d24ff9930b3f7b5d93b6fd671f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d9f28b7b701321d24ff9930b3f7b5d93b6fd671f/comments", "author": {"login": "GoldsteinE", "id": 12019211, "node_id": "MDQ6VXNlcjEyMDE5MjEx", "avatar_url": "https://avatars.githubusercontent.com/u/12019211?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GoldsteinE", "html_url": "https://github.com/GoldsteinE", "followers_url": "https://api.github.com/users/GoldsteinE/followers", "following_url": "https://api.github.com/users/GoldsteinE/following{/other_user}", "gists_url": "https://api.github.com/users/GoldsteinE/gists{/gist_id}", "starred_url": "https://api.github.com/users/GoldsteinE/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GoldsteinE/subscriptions", "organizations_url": "https://api.github.com/users/GoldsteinE/orgs", "repos_url": "https://api.github.com/users/GoldsteinE/repos", "events_url": "https://api.github.com/users/GoldsteinE/events{/privacy}", "received_events_url": "https://api.github.com/users/GoldsteinE/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GoldsteinE", "id": 12019211, "node_id": "MDQ6VXNlcjEyMDE5MjEx", "avatar_url": "https://avatars.githubusercontent.com/u/12019211?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GoldsteinE", "html_url": "https://github.com/GoldsteinE", "followers_url": "https://api.github.com/users/GoldsteinE/followers", "following_url": "https://api.github.com/users/GoldsteinE/following{/other_user}", "gists_url": "https://api.github.com/users/GoldsteinE/gists{/gist_id}", "starred_url": "https://api.github.com/users/GoldsteinE/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GoldsteinE/subscriptions", "organizations_url": "https://api.github.com/users/GoldsteinE/orgs", "repos_url": "https://api.github.com/users/GoldsteinE/repos", "events_url": "https://api.github.com/users/GoldsteinE/events{/privacy}", "received_events_url": "https://api.github.com/users/GoldsteinE/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e5a7d8f945f4259fb6b8c4953a65248243c054d1", "url": "https://api.github.com/repos/rust-lang/rust/commits/e5a7d8f945f4259fb6b8c4953a65248243c054d1", "html_url": "https://github.com/rust-lang/rust/commit/e5a7d8f945f4259fb6b8c4953a65248243c054d1"}], "stats": {"total": 11, "additions": 8, "deletions": 3}, "files": [{"sha": "c2c551e78a41105af9ee32fe96fbabbd750a3b7e", "filename": "compiler/rustc_hir/src/definitions.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/d9f28b7b701321d24ff9930b3f7b5d93b6fd671f/compiler%2Frustc_hir%2Fsrc%2Fdefinitions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d9f28b7b701321d24ff9930b3f7b5d93b6fd671f/compiler%2Frustc_hir%2Fsrc%2Fdefinitions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir%2Fsrc%2Fdefinitions.rs?ref=d9f28b7b701321d24ff9930b3f7b5d93b6fd671f", "patch": "@@ -338,7 +338,12 @@ impl Definitions {\n \n     /// Adds a definition with a parent definition.\n     pub fn create_def(&mut self, parent: LocalDefId, data: DefPathData) -> LocalDefId {\n-        debug!(\"create_def(parent={:?}, data={:?})\", parent, data);\n+        // We can't use `Debug` implementation for `LocalDefId` here, since it tries to acquire a\n+        // reference to `Definitions` and we're already holding a mutable reference.\n+        debug!(\n+            \"create_def(parent={}, data={data:?})\",\n+            self.def_path(parent).to_string_no_crate_verbose(),\n+        );\n \n         // The root node must be created with `create_root_def()`.\n         assert!(data != DefPathData::CrateRoot);"}, {"sha": "541763e294f18bf87f5d57c8a121d09cf7a58baa", "filename": "compiler/rustc_middle/src/ty/context.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d9f28b7b701321d24ff9930b3f7b5d93b6fd671f/compiler%2Frustc_middle%2Fsrc%2Fty%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d9f28b7b701321d24ff9930b3f7b5d93b6fd671f/compiler%2Frustc_middle%2Fsrc%2Fty%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Fcontext.rs?ref=d9f28b7b701321d24ff9930b3f7b5d93b6fd671f", "patch": "@@ -1459,11 +1459,11 @@ impl<'tcx> TyCtxt<'tcx> {\n         };\n \n         format!(\n-            \"{}[{}]{}\",\n+            \"{}[{:04x}]{}\",\n             crate_name,\n             // Don't print the whole stable crate id. That's just\n             // annoying in debug output.\n-            &(format!(\"{:08x}\", stable_crate_id.to_u64()))[..4],\n+            stable_crate_id.to_u64() >> 8 * 6,\n             self.def_path(def_id).to_string_no_crate_verbose()\n         )\n     }"}]}