{"sha": "1e23c5c051c5a106b3143ca78e4f97e2c438285b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFlMjNjNWMwNTFjNWExMDZiMzE0M2NhNzhlNGY5N2UyYzQzODI4NWI=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-01-29T21:36:40Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-01-29T21:36:40Z"}, "message": "auto merge of #11879 : thestinger/rust/frame-pointer, r=alexcrichton\n\nThis is still used for Rust code (`Options.NoFramePointerElim = true`).", "tree": {"sha": "aeea6583168d84fb76d9683448f17e1c134b9a3f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/aeea6583168d84fb76d9683448f17e1c134b9a3f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1e23c5c051c5a106b3143ca78e4f97e2c438285b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1e23c5c051c5a106b3143ca78e4f97e2c438285b", "html_url": "https://github.com/rust-lang/rust/commit/1e23c5c051c5a106b3143ca78e4f97e2c438285b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1e23c5c051c5a106b3143ca78e4f97e2c438285b/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dfb61166f5a62845e7edc71ac533a4d3a35afebc", "url": "https://api.github.com/repos/rust-lang/rust/commits/dfb61166f5a62845e7edc71ac533a4d3a35afebc", "html_url": "https://github.com/rust-lang/rust/commit/dfb61166f5a62845e7edc71ac533a4d3a35afebc"}, {"sha": "cb263e875e2ede820f4fab45a68d08ff6a9b2870", "url": "https://api.github.com/repos/rust-lang/rust/commits/cb263e875e2ede820f4fab45a68d08ff6a9b2870", "html_url": "https://github.com/rust-lang/rust/commit/cb263e875e2ede820f4fab45a68d08ff6a9b2870"}], "stats": {"total": 24, "additions": 10, "deletions": 14}, "files": [{"sha": "f400809b616bf09ff53a3fcdf06c5feed103256a", "filename": "mk/platform.mk", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/1e23c5c051c5a106b3143ca78e4f97e2c438285b/mk%2Fplatform.mk", "raw_url": "https://github.com/rust-lang/rust/raw/1e23c5c051c5a106b3143ca78e4f97e2c438285b/mk%2Fplatform.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fplatform.mk?ref=1e23c5c051c5a106b3143ca78e4f97e2c438285b", "patch": "@@ -26,11 +26,6 @@ endef\n $(foreach t,$(CFG_TARGET),$(eval $(call DEF_OSTYPE_VAR,$(t))))\n $(foreach t,$(CFG_TARGET),$(info cfg: os for $(t) is $(OSTYPE_$(t))))\n \n-# FIXME: no-omit-frame-pointer is just so that task_start_wrapper\n-# has a frame pointer and the stack walker can understand it. Turning off\n-# frame pointers everywhere is overkill\n-CFG_GCCISH_CFLAGS += -fno-omit-frame-pointer\n-\n # On Darwin, we need to run dsymutil so the debugging information ends\n # up in the right place.  On other platforms, it automatically gets\n # embedded into the executable, so use a no-op command.\n@@ -160,7 +155,6 @@ CFG_DEF_SUFFIX_x86_64-unknown-linux-gnu := .linux.def\n CFG_LLC_FLAGS_x86_64-unknown-linux-gnu :=\n CFG_INSTALL_NAME_x86_64-unknown-linux-gnu =\n CFG_LIBUV_LINK_FLAGS_x86_64-unknown-linux-gnu =\n-CFG_LLVM_BUILD_ENV_x86_64-unknown-linux-gnu=\"CXXFLAGS=-fno-omit-frame-pointer\"\n CFG_EXE_SUFFIX_x86_64-unknown-linux-gnu =\n CFG_WINDOWSY_x86_64-unknown-linux-gnu :=\n CFG_UNIXY_x86_64-unknown-linux-gnu := 1\n@@ -188,7 +182,6 @@ CFG_DEF_SUFFIX_i686-unknown-linux-gnu := .linux.def\n CFG_LLC_FLAGS_i686-unknown-linux-gnu :=\n CFG_INSTALL_NAME_i686-unknown-linux-gnu =\n CFG_LIBUV_LINK_FLAGS_i686-unknown-linux-gnu =\n-CFG_LLVM_BUILD_ENV_i686-unknown-linux-gnu=\"CXXFLAGS=-fno-omit-frame-pointer\"\n CFG_EXE_SUFFIX_i686-unknown-linux-gnu =\n CFG_WINDOWSY_i686-unknown-linux-gnu :=\n CFG_UNIXY_i686-unknown-linux-gnu := 1"}, {"sha": "3a6b9f399aa64c2245a438958d8b2abdf2c3dbf2", "filename": "src/librustc/back/link.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/1e23c5c051c5a106b3143ca78e4f97e2c438285b/src%2Flibrustc%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1e23c5c051c5a106b3143ca78e4f97e2c438285b/src%2Flibrustc%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fback%2Flink.rs?ref=1e23c5c051c5a106b3143ca78e4f97e2c438285b", "patch": "@@ -128,6 +128,9 @@ pub mod write {\n             };\n             let use_softfp = sess.opts.debugging_opts & session::USE_SOFTFP != 0;\n \n+            // FIXME: #11906: Omitting frame pointers breaks retrieving the value of a parameter.\n+            let no_fp_elim = sess.opts.debuginfo;\n+\n             let tm = sess.targ_cfg.target_strs.target_triple.with_c_str(|T| {\n                 sess.opts.target_cpu.with_c_str(|CPU| {\n                     sess.opts.target_feature.with_c_str(|Features| {\n@@ -137,7 +140,8 @@ pub mod write {\n                             lib::llvm::RelocPIC,\n                             OptLevel,\n                             true,\n-                            use_softfp\n+                            use_softfp,\n+                            no_fp_elim\n                         )\n                     })\n                 })"}, {"sha": "81067fb0c1825f163292a405c5e7d2620f2de60b", "filename": "src/librustc/lib/llvm.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/1e23c5c051c5a106b3143ca78e4f97e2c438285b/src%2Flibrustc%2Flib%2Fllvm.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1e23c5c051c5a106b3143ca78e4f97e2c438285b/src%2Flibrustc%2Flib%2Fllvm.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Flib%2Fllvm.rs?ref=1e23c5c051c5a106b3143ca78e4f97e2c438285b", "patch": "@@ -1733,7 +1733,8 @@ pub mod llvm {\n                                            Reloc: RelocMode,\n                                            Level: CodeGenOptLevel,\n                                            EnableSegstk: bool,\n-                                           UseSoftFP: bool) -> TargetMachineRef;\n+                                           UseSoftFP: bool,\n+                                           NoFramePointerElim: bool) -> TargetMachineRef;\n         pub fn LLVMRustDisposeTargetMachine(T: TargetMachineRef);\n         pub fn LLVMRustAddAnalysisPasses(T: TargetMachineRef,\n                                          PM: PassManagerRef,"}, {"sha": "2bc96d9f0bf718bad2b8670a2802b7dbb29643da", "filename": "src/rustllvm/PassWrapper.cpp", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/1e23c5c051c5a106b3143ca78e4f97e2c438285b/src%2Frustllvm%2FPassWrapper.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/1e23c5c051c5a106b3143ca78e4f97e2c438285b/src%2Frustllvm%2FPassWrapper.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2FPassWrapper.cpp?ref=1e23c5c051c5a106b3143ca78e4f97e2c438285b", "patch": "@@ -68,7 +68,8 @@ LLVMRustCreateTargetMachine(const char *triple,\n                             Reloc::Model RM,\n                             CodeGenOpt::Level OptLevel,\n                             bool EnableSegmentedStacks,\n-                            bool UseSoftFloat) {\n+                            bool UseSoftFloat,\n+                            bool NoFramePointerElim) {\n     std::string Error;\n     Triple Trip(Triple::normalize(triple));\n     const llvm::Target *TheTarget = TargetRegistry::lookupTarget(Trip.getTriple(),\n@@ -79,7 +80,7 @@ LLVMRustCreateTargetMachine(const char *triple,\n     }\n \n     TargetOptions Options;\n-    Options.NoFramePointerElim = true;\n+    Options.NoFramePointerElim = NoFramePointerElim;\n     Options.EnableSegmentedStacks = EnableSegmentedStacks;\n     Options.FloatABIType = FloatABI::Default;\n     Options.UseSoftFloat = UseSoftFloat;"}, {"sha": "da2d4e09fc67f1521cc64ebcc221afa058ff7470", "filename": "src/test/debug-info/function-prologue-stepping-no-split-stack.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/1e23c5c051c5a106b3143ca78e4f97e2c438285b/src%2Ftest%2Fdebug-info%2Ffunction-prologue-stepping-no-split-stack.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1e23c5c051c5a106b3143ca78e4f97e2c438285b/src%2Ftest%2Fdebug-info%2Ffunction-prologue-stepping-no-split-stack.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fdebug-info%2Ffunction-prologue-stepping-no-split-stack.rs?ref=1e23c5c051c5a106b3143ca78e4f97e2c438285b", "patch": "@@ -244,6 +244,3 @@ fn main() {\n     while_expr(40, 41, 42);\n     loop_expr(43, 44, 45);\n }\n-\n-\n-"}]}