{"sha": "9a37308101bb188794eebdcd377c30ba39a3c082", "node_id": "MDY6Q29tbWl0NzI0NzEyOjlhMzczMDgxMDFiYjE4ODc5NGVlYmRjZDM3N2MzMGJhMzlhM2MwODI=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-07-12T20:04:29Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-07-12T23:54:46Z"}, "message": "Add build targets for running stdtest. Issue #428", "tree": {"sha": "b81a5ec58fa58c5f0e76c3dc66963fabee8d6813", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b81a5ec58fa58c5f0e76c3dc66963fabee8d6813"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9a37308101bb188794eebdcd377c30ba39a3c082", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9a37308101bb188794eebdcd377c30ba39a3c082", "html_url": "https://github.com/rust-lang/rust/commit/9a37308101bb188794eebdcd377c30ba39a3c082", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9a37308101bb188794eebdcd377c30ba39a3c082/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f06fdd5ca16abba5c4c0dc7d94a25589942593ee", "url": "https://api.github.com/repos/rust-lang/rust/commits/f06fdd5ca16abba5c4c0dc7d94a25589942593ee", "html_url": "https://github.com/rust-lang/rust/commit/f06fdd5ca16abba5c4c0dc7d94a25589942593ee"}], "stats": {"total": 23, "additions": 22, "deletions": 1}, "files": [{"sha": "ca93e86ab6a5688c21b8ac20d4ea8869b116e10f", "filename": "mk/tests.mk", "status": "modified", "additions": 22, "deletions": 1, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/9a37308101bb188794eebdcd377c30ba39a3c082/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/9a37308101bb188794eebdcd377c30ba39a3c082/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=9a37308101bb188794eebdcd377c30ba39a3c082", "patch": "@@ -138,7 +138,6 @@ ALL_TEST_SOURCES := $(TEST_CFAIL_SOURCES_STAGE0) \\\n                     $(TEST_RFAIL_SOURCES_STAGE2) \\\n                     $(TEST_RPASS_SOURCES_STAGE2)\n \n-\n FT := run_pass_stage2\n FT_LIB := $(call CFG_LIB_NAME,$(FT))\n FT_DRIVER := $(FT)_driver\n@@ -338,9 +337,31 @@ test/compile-fail/%.stage2.out.tmp: test/compile-fail/%.rc $(SREQ2)\n \t$(Q)grep --text --quiet \\\n       \"$$(grep error-pattern $< | cut -d : -f 2- | tr -d '\\n\\r')\" $@\n \n+# Testing the stdtest crate\n+\n STDTEST_CRATE := $(S)src/test/stdtest/stdtest.rc\n STDTEST_INPUTS := $(wildcard $(S)src/test/stdtest/*rs)\n \n test/stdtest/stdtest.stage1$(X): $(STDTEST_CRATE) $(STDTEST_INPUTS) $(SREQ1)\n \t@$(call E, compile_and_link: $@)\n \t$(STAGE1) -o $@ $< --test\n+\n+test/stdtest/stdtest.stage2$(X): $(STDTEST_CRATE) $(STDTEST_INPUTS) $(SREQ2)\n+\t@$(call E, compile_and_link: $@)\n+\t$(STAGE2) -o $@ $< --test\n+\n+test/stdtest/stdtest.stage3$(X): $(STDTEST_CRATE) $(STDTEST_INPUTS) $(SREQ3)\n+\t@$(call E, compile_and_link: $@)\n+\t$(STAGE3) -o $@ $< --test\n+\n+check-stage1-std:test/stdtest/stdtest.stage1$(X)\n+\t@$(call E, run: $<)\n+\t$(Q)$(call CFG_RUN_TARG,stage1,stage1, $<)\n+\n+check-stage2-std:test/stdtest/stdtest.stage2$(X)\n+\t@$(call E, run: $<)\n+\t$(Q)$(call CFG_RUN_TARG,stage2,stage2, $<)\n+\n+check-stage3-std:test/stdtest/stdtest.stage3$(X)\n+\t@$(call E, run: $<)\n+\t$(Q)$(call CFG_RUN_TARG,stage3,stage3, $<)"}]}