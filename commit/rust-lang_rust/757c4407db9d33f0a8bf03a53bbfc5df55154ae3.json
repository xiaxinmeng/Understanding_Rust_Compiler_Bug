{"sha": "757c4407db9d33f0a8bf03a53bbfc5df55154ae3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc1N2M0NDA3ZGI5ZDMzZjBhOGJmMDNhNTNiYmZjNWRmNTUxNTRhZTM=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-02-05T15:29:02Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-02-05T15:29:02Z"}, "message": "Rollup merge of #58116 - topecongiro:wrong-span-assignment, r=petrochenkov\n\nInclude the span of attributes of the lhs to the span of the assignment expression\n\nThis PR adds the span of attributes of the lhs to the span of the assignment expression. Currently with the following code, `#[attr]` is not included to the span of the assignment (`foo = true`).\n\n```rust\n#[attr]\nfoo = true;\n```\nThe rational behind this change is that as libsyntax user I expect the span of the parent node includes every span of child nodes.\n\ncc https://github.com/rust-lang/rustfmt/issues/3313, https://github.com/rust-lang/rust/issues/15701.", "tree": {"sha": "46111f76de8ce4a8848299dd1e5b511cf7d627c1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/46111f76de8ce4a8848299dd1e5b511cf7d627c1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/757c4407db9d33f0a8bf03a53bbfc5df55154ae3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcWau+CRBK7hj4Ov3rIwAAdHIIACmZZM6buBMR5nKKBeP6fIA/\n0RYsiKIkbCR7wG6iWFlaHpgw2geE8vDoaW2ADGn3RSQY2arAUwOZJW2Rf134oeQK\nJTXEHcc5nTl5Qu1VBcEBM9wsEurIbWJEtvv8SYrWqflEwCssbWcd51TKfm+ipUcy\ngi01YKvOgS8/fu7fLbyCVzu8ZfDe42Dmcbp1ArEC0ZDbsoAUBzu3ShXj1goeU8EU\n39nVFaKA6eu5vkj3c7Sy8YAOryhOrETkcrQvYLh9OKYewhI3JOacRFPQeqr1AiSK\nPgVZUYxxaT+cQCXToD8osHuDHa/OFNdYlBlSBo3AW9qQ/MGDrB1POmCTmoVIZG4=\n=6N4i\n-----END PGP SIGNATURE-----\n", "payload": "tree 46111f76de8ce4a8848299dd1e5b511cf7d627c1\nparent 3f731d56b61838c3782b026b173521f9a08e0cbd\nparent 9851a296885cc745eccbc33858915d08e839eadc\nauthor kennytm <kennytm@gmail.com> 1549380542 +0900\ncommitter GitHub <noreply@github.com> 1549380542 +0900\n\nRollup merge of #58116 - topecongiro:wrong-span-assignment, r=petrochenkov\n\nInclude the span of attributes of the lhs to the span of the assignment expression\n\nThis PR adds the span of attributes of the lhs to the span of the assignment expression. Currently with the following code, `#[attr]` is not included to the span of the assignment (`foo = true`).\n\n```rust\n#[attr]\nfoo = true;\n```\nThe rational behind this change is that as libsyntax user I expect the span of the parent node includes every span of child nodes.\n\ncc https://github.com/rust-lang/rustfmt/issues/3313, https://github.com/rust-lang/rust/issues/15701.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/757c4407db9d33f0a8bf03a53bbfc5df55154ae3", "html_url": "https://github.com/rust-lang/rust/commit/757c4407db9d33f0a8bf03a53bbfc5df55154ae3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/757c4407db9d33f0a8bf03a53bbfc5df55154ae3/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3f731d56b61838c3782b026b173521f9a08e0cbd", "url": "https://api.github.com/repos/rust-lang/rust/commits/3f731d56b61838c3782b026b173521f9a08e0cbd", "html_url": "https://github.com/rust-lang/rust/commit/3f731d56b61838c3782b026b173521f9a08e0cbd"}, {"sha": "9851a296885cc745eccbc33858915d08e839eadc", "url": "https://api.github.com/repos/rust-lang/rust/commits/9851a296885cc745eccbc33858915d08e839eadc", "html_url": "https://github.com/rust-lang/rust/commit/9851a296885cc745eccbc33858915d08e839eadc"}], "stats": {"total": 8, "additions": 8, "deletions": 0}, "files": [{"sha": "1c02a80df4683b4f6c83f5d2bcd21673f0ef7c8d", "filename": "src/libsyntax/parse/parser.rs", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/757c4407db9d33f0a8bf03a53bbfc5df55154ae3/src%2Flibsyntax%2Fparse%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/757c4407db9d33f0a8bf03a53bbfc5df55154ae3/src%2Flibsyntax%2Fparse%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Fparser.rs?ref=757c4407db9d33f0a8bf03a53bbfc5df55154ae3", "patch": "@@ -3455,6 +3455,14 @@ impl<'a> Parser<'a> {\n                 }),\n             }?;\n \n+            // Make sure that the span of the parent node is larger than the span of lhs and rhs,\n+            // including the attributes.\n+            let lhs_span = lhs\n+                .attrs\n+                .iter()\n+                .filter(|a| a.style == AttrStyle::Outer)\n+                .next()\n+                .map_or(lhs_span, |a| a.span);\n             let span = lhs_span.to(rhs.span);\n             lhs = match op {\n                 AssocOp::Add | AssocOp::Subtract | AssocOp::Multiply | AssocOp::Divide |"}]}