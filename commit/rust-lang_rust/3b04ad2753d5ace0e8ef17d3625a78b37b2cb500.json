{"sha": "3b04ad2753d5ace0e8ef17d3625a78b37b2cb500", "node_id": "C_kwDOAAsO6NoAKDNiMDRhZDI3NTNkNWFjZTBlOGVmMTdkMzYyNWE3OGIzN2IyY2I1MDA", "commit": {"author": {"name": "Santiago Pastorino", "email": "spastorino@gmail.com", "date": "2023-03-21T15:01:51Z"}, "committer": {"name": "Santiago Pastorino", "email": "spastorino@gmail.com", "date": "2023-03-21T16:18:32Z"}, "message": "Do not suggest bounds restrictions for synthesized RPITITs", "tree": {"sha": "ecdd31b2f9a54310b6791c913694ea3f2dcc381f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ecdd31b2f9a54310b6791c913694ea3f2dcc381f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3b04ad2753d5ace0e8ef17d3625a78b37b2cb500", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEF0ntrgrd9qf9uuThgTGiTgx5768FAmQZ2NkACgkQgTGiTgx5\n768+uw/8CGNbzoUMeaHgfI2DifdqV8NDdRs52ZziqENPwWn1RfSHx4X+LKLX7yOM\ns7jQAKmOueqlpSzqUjf+RouXRse11WO7bfxe9iFZ9FMUjrxeyqDrmA2LZUQUBYuW\n8Cn6L7wpXePvZuSClRkHzaJNMjy7Zq2XIxFBZUtMEaCCWN/Bhxvn9xv29e/v9cG/\nuftYBJ/pIkfveTf3lXMtLQA1DrOJvwT3DTuJOJrJiSOMsea6NSoIKz8n9zaUndFk\nZg5Y8KXhWojv2O3HfC+s6C8oz1O1s9us/u1pVoAM2/xHRH9P3nCs5QMv3//Xp8li\nIkpTCZqTQ49CiP38gn8zzNMU4qhYzVGYyFgyBAqff+4MNa31BPLdjmLqN6VbHXpr\ngMwozmG6FQuCet8Sg9rA+g88j2pfZcbVhDJfptoRQj8/1060FvYuxDijCtA4q+Y7\nyT/f+cD2v18dgRCgmRQxiTrOIhEwe6wNaQolgraV4CxuWZkQ1murCC4yFXVG57oq\nusEmn7MO6fgFAZLF9/yY0jFDtMsnMaQodunKhFTf2LKdBBaBugORdLXRJwhSaPgW\nUrr8FouPLn+1VnGuIuZ5MtQ4aC0q3+O63YottxtqaoWBBobunfjIhSLTQGzB/GMJ\nk4SuNgt/KGSLM0gymyj9zKM1uiu19yKw/iB1FgoAgn2civ0mm5w=\n=+cDW\n-----END PGP SIGNATURE-----", "payload": "tree ecdd31b2f9a54310b6791c913694ea3f2dcc381f\nparent febd59e122f67d26d410a62f661a941a706b28ec\nauthor Santiago Pastorino <spastorino@gmail.com> 1679410911 -0300\ncommitter Santiago Pastorino <spastorino@gmail.com> 1679415512 -0300\n\nDo not suggest bounds restrictions for synthesized RPITITs\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3b04ad2753d5ace0e8ef17d3625a78b37b2cb500", "html_url": "https://github.com/rust-lang/rust/commit/3b04ad2753d5ace0e8ef17d3625a78b37b2cb500", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3b04ad2753d5ace0e8ef17d3625a78b37b2cb500/comments", "author": {"login": "spastorino", "id": 52642, "node_id": "MDQ6VXNlcjUyNjQy", "avatar_url": "https://avatars.githubusercontent.com/u/52642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spastorino", "html_url": "https://github.com/spastorino", "followers_url": "https://api.github.com/users/spastorino/followers", "following_url": "https://api.github.com/users/spastorino/following{/other_user}", "gists_url": "https://api.github.com/users/spastorino/gists{/gist_id}", "starred_url": "https://api.github.com/users/spastorino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spastorino/subscriptions", "organizations_url": "https://api.github.com/users/spastorino/orgs", "repos_url": "https://api.github.com/users/spastorino/repos", "events_url": "https://api.github.com/users/spastorino/events{/privacy}", "received_events_url": "https://api.github.com/users/spastorino/received_events", "type": "User", "site_admin": false}, "committer": {"login": "spastorino", "id": 52642, "node_id": "MDQ6VXNlcjUyNjQy", "avatar_url": "https://avatars.githubusercontent.com/u/52642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spastorino", "html_url": "https://github.com/spastorino", "followers_url": "https://api.github.com/users/spastorino/followers", "following_url": "https://api.github.com/users/spastorino/following{/other_user}", "gists_url": "https://api.github.com/users/spastorino/gists{/gist_id}", "starred_url": "https://api.github.com/users/spastorino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spastorino/subscriptions", "organizations_url": "https://api.github.com/users/spastorino/orgs", "repos_url": "https://api.github.com/users/spastorino/repos", "events_url": "https://api.github.com/users/spastorino/events{/privacy}", "received_events_url": "https://api.github.com/users/spastorino/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "febd59e122f67d26d410a62f661a941a706b28ec", "url": "https://api.github.com/repos/rust-lang/rust/commits/febd59e122f67d26d410a62f661a941a706b28ec", "html_url": "https://github.com/rust-lang/rust/commit/febd59e122f67d26d410a62f661a941a706b28ec"}], "stats": {"total": 40, "additions": 36, "deletions": 4}, "files": [{"sha": "b501840b9260b749bbb444c29849e8569bd2bd57", "filename": "compiler/rustc_trait_selection/src/traits/error_reporting/suggestions.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3b04ad2753d5ace0e8ef17d3625a78b37b2cb500/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ferror_reporting%2Fsuggestions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3b04ad2753d5ace0e8ef17d3625a78b37b2cb500/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ferror_reporting%2Fsuggestions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ferror_reporting%2Fsuggestions.rs?ref=3b04ad2753d5ace0e8ef17d3625a78b37b2cb500", "patch": "@@ -420,6 +420,7 @@ fn suggest_restriction<'tcx>(\n ) {\n     if hir_generics.where_clause_span.from_expansion()\n         || hir_generics.where_clause_span.desugaring_kind().is_some()\n+        || projection.map_or(false, |projection| tcx.opt_rpitit_info(projection.def_id).is_some())\n     {\n         return;\n     }"}, {"sha": "319ed582e2719eae56940b8ce1755c3a95c76d74", "filename": "tests/ui/async-await/in-trait/missing-send-bound.current.stderr", "status": "renamed", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/3b04ad2753d5ace0e8ef17d3625a78b37b2cb500/tests%2Fui%2Fasync-await%2Fin-trait%2Fmissing-send-bound.current.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3b04ad2753d5ace0e8ef17d3625a78b37b2cb500/tests%2Fui%2Fasync-await%2Fin-trait%2Fmissing-send-bound.current.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fasync-await%2Fin-trait%2Fmissing-send-bound.current.stderr?ref=3b04ad2753d5ace0e8ef17d3625a78b37b2cb500", "patch": "@@ -1,5 +1,5 @@\n warning: the feature `async_fn_in_trait` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/missing-send-bound.rs:3:12\n+  --> $DIR/missing-send-bound.rs:5:12\n    |\n LL | #![feature(async_fn_in_trait)]\n    |            ^^^^^^^^^^^^^^^^^\n@@ -8,19 +8,19 @@ LL | #![feature(async_fn_in_trait)]\n    = note: `#[warn(incomplete_features)]` on by default\n \n error: future cannot be sent between threads safely\n-  --> $DIR/missing-send-bound.rs:15:20\n+  --> $DIR/missing-send-bound.rs:17:20\n    |\n LL |     assert_is_send(test::<T>());\n    |                    ^^^^^^^^^^^ future returned by `test` is not `Send`\n    |\n    = help: within `impl Future<Output = ()>`, the trait `Send` is not implemented for `impl Future<Output = ()>`\n note: future is not `Send` as it awaits another future which is not `Send`\n-  --> $DIR/missing-send-bound.rs:11:5\n+  --> $DIR/missing-send-bound.rs:13:5\n    |\n LL |     T::bar().await;\n    |     ^^^^^^^^ await occurs here on type `impl Future<Output = ()>`, which is not `Send`\n note: required by a bound in `assert_is_send`\n-  --> $DIR/missing-send-bound.rs:19:27\n+  --> $DIR/missing-send-bound.rs:21:27\n    |\n LL | fn assert_is_send(_: impl Send) {}\n    |                           ^^^^ required by this bound in `assert_is_send`", "previous_filename": "tests/ui/async-await/in-trait/missing-send-bound.stderr"}, {"sha": "319ed582e2719eae56940b8ce1755c3a95c76d74", "filename": "tests/ui/async-await/in-trait/missing-send-bound.next.stderr", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/3b04ad2753d5ace0e8ef17d3625a78b37b2cb500/tests%2Fui%2Fasync-await%2Fin-trait%2Fmissing-send-bound.next.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3b04ad2753d5ace0e8ef17d3625a78b37b2cb500/tests%2Fui%2Fasync-await%2Fin-trait%2Fmissing-send-bound.next.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fasync-await%2Fin-trait%2Fmissing-send-bound.next.stderr?ref=3b04ad2753d5ace0e8ef17d3625a78b37b2cb500", "patch": "@@ -0,0 +1,29 @@\n+warning: the feature `async_fn_in_trait` is incomplete and may not be safe to use and/or cause compiler crashes\n+  --> $DIR/missing-send-bound.rs:5:12\n+   |\n+LL | #![feature(async_fn_in_trait)]\n+   |            ^^^^^^^^^^^^^^^^^\n+   |\n+   = note: see issue #91611 <https://github.com/rust-lang/rust/issues/91611> for more information\n+   = note: `#[warn(incomplete_features)]` on by default\n+\n+error: future cannot be sent between threads safely\n+  --> $DIR/missing-send-bound.rs:17:20\n+   |\n+LL |     assert_is_send(test::<T>());\n+   |                    ^^^^^^^^^^^ future returned by `test` is not `Send`\n+   |\n+   = help: within `impl Future<Output = ()>`, the trait `Send` is not implemented for `impl Future<Output = ()>`\n+note: future is not `Send` as it awaits another future which is not `Send`\n+  --> $DIR/missing-send-bound.rs:13:5\n+   |\n+LL |     T::bar().await;\n+   |     ^^^^^^^^ await occurs here on type `impl Future<Output = ()>`, which is not `Send`\n+note: required by a bound in `assert_is_send`\n+  --> $DIR/missing-send-bound.rs:21:27\n+   |\n+LL | fn assert_is_send(_: impl Send) {}\n+   |                           ^^^^ required by this bound in `assert_is_send`\n+\n+error: aborting due to previous error; 1 warning emitted\n+"}, {"sha": "705fcf322f9eaa5cd09693d47c090715c28145b4", "filename": "tests/ui/async-await/in-trait/missing-send-bound.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3b04ad2753d5ace0e8ef17d3625a78b37b2cb500/tests%2Fui%2Fasync-await%2Fin-trait%2Fmissing-send-bound.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3b04ad2753d5ace0e8ef17d3625a78b37b2cb500/tests%2Fui%2Fasync-await%2Fin-trait%2Fmissing-send-bound.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fasync-await%2Fin-trait%2Fmissing-send-bound.rs?ref=3b04ad2753d5ace0e8ef17d3625a78b37b2cb500", "patch": "@@ -1,4 +1,6 @@\n // edition:2021\n+// [next] compile-flags: -Zlower-impl-trait-in-trait-to-assoc-ty\n+// revisions: current next\n \n #![feature(async_fn_in_trait)]\n //~^ WARN the feature `async_fn_in_trait` is incomplete and may not be safe to use and/or cause compiler crashes"}]}