{"sha": "546d2fec29c46615686bf2f7e356bc637a410d89", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU0NmQyZmVjMjljNDY2MTU2ODZiZjJmN2UzNTZiYzYzN2E0MTBkODk=", "commit": {"author": {"name": "Michael Wright", "email": "mikerite@lavabit.com", "date": "2018-03-26T05:48:32Z"}, "committer": {"name": "Michael Wright", "email": "mikerite@lavabit.com", "date": "2018-03-27T04:34:11Z"}, "message": "Fix enum_glob_use false positives\n\nCloses #2397.\n\nThis checks the def of the `ItemUse` path instead of checking the\ncapitalization of the path segements. It was noted that this def would\nsometimes be `Def::Mod` instead of `Def::Enum` but it seems correct now.", "tree": {"sha": "3c049c337c6ceb33fb82040e389dc5fd06c0a0c7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3c049c337c6ceb33fb82040e389dc5fd06c0a0c7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/546d2fec29c46615686bf2f7e356bc637a410d89", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/546d2fec29c46615686bf2f7e356bc637a410d89", "html_url": "https://github.com/rust-lang/rust/commit/546d2fec29c46615686bf2f7e356bc637a410d89", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/546d2fec29c46615686bf2f7e356bc637a410d89/comments", "author": null, "committer": null, "parents": [{"sha": "b01b0083baa758b18a3d0aece01e16c38fde2eb1", "url": "https://api.github.com/repos/rust-lang/rust/commits/b01b0083baa758b18a3d0aece01e16c38fde2eb1", "html_url": "https://github.com/rust-lang/rust/commit/b01b0083baa758b18a3d0aece01e16c38fde2eb1"}], "stats": {"total": 27, "additions": 15, "deletions": 12}, "files": [{"sha": "8a0d03d2ae9935ab3af5c724bb6d32e36e78088f", "filename": "clippy_lints/src/enum_glob_use.rs", "status": "modified", "additions": 9, "deletions": 12, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/546d2fec29c46615686bf2f7e356bc637a410d89/clippy_lints%2Fsrc%2Fenum_glob_use.rs", "raw_url": "https://github.com/rust-lang/rust/raw/546d2fec29c46615686bf2f7e356bc637a410d89/clippy_lints%2Fsrc%2Fenum_glob_use.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fenum_glob_use.rs?ref=546d2fec29c46615686bf2f7e356bc637a410d89", "patch": "@@ -1,6 +1,7 @@\n //! lint on `use`ing all variants of an enum\n \n use rustc::hir::*;\n+use rustc::hir::def::Def;\n use rustc::lint::{LateContext, LateLintPass, LintArray, LintPass};\n use syntax::ast::NodeId;\n use syntax::codemap::Span;\n@@ -12,8 +13,7 @@ use utils::span_lint;\n /// an enumeration variant, rather than importing variants.\n ///\n /// **Known problems:** Old-style enumerations that prefix the variants are\n-/// still around. May cause problems with modules that are not snake_case (see\n-/// [#2397](https://github.com/rust-lang-nursery/rust-clippy/issues/2397))\n+/// still around.\n ///\n /// **Example:**\n /// ```rust\n@@ -48,16 +48,13 @@ impl EnumGlobUse {\n             return; // re-exports are fine\n         }\n         if let ItemUse(ref path, UseKind::Glob) = item.node {\n-            // FIXME: ask jseyfried why the qpath.def for `use std::cmp::Ordering::*;`\n-            // extracted through `ItemUse(ref qpath, UseKind::Glob)` is a `Mod` and not an\n-            // `Enum`\n-            // if let Def::Enum(_) = path.def {\n-            if path.segments\n-                .last()\n-                .and_then(|seg| seg.name.as_str().chars().next())\n-                .map_or(false, char::is_uppercase)\n-            {\n-                span_lint(cx, ENUM_GLOB_USE, item.span, \"don't use glob imports for enum variants\");\n+            if let Def::Enum(_) = path.def {\n+                span_lint(\n+                    cx,\n+                    ENUM_GLOB_USE,\n+                    item.span,\n+                    \"don't use glob imports for enum variants\",\n+                );\n             }\n         }\n     }"}, {"sha": "efb37fbe49d2d0ad1e73b0b11b6d773f695ca99b", "filename": "tests/ui/enum_glob_use.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/546d2fec29c46615686bf2f7e356bc637a410d89/tests%2Fui%2Fenum_glob_use.rs", "raw_url": "https://github.com/rust-lang/rust/raw/546d2fec29c46615686bf2f7e356bc637a410d89/tests%2Fui%2Fenum_glob_use.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fenum_glob_use.rs?ref=546d2fec29c46615686bf2f7e356bc637a410d89", "patch": "@@ -23,4 +23,10 @@ mod tests {\n     use super::*;\n }\n \n+#[allow(non_snake_case)]\n+mod CamelCaseName {\n+}\n+\n+use CamelCaseName::*;\n+\n fn main() {}"}]}