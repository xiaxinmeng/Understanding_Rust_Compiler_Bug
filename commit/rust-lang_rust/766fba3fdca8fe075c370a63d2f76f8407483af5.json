{"sha": "766fba3fdca8fe075c370a63d2f76f8407483af5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc2NmZiYTNmZGNhOGZlMDc1YzM3MGE2M2QyZjc2Zjg0MDc0ODNhZjU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-01-02T07:04:20Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-01-02T07:04:20Z"}, "message": "Auto merge of #67779 - Amanieu:ehabi_fix, r=Mark-Simulacrum\n\nUpdate the barrier cache during ARM EHABI unwinding\n\nFixes #67242\n\nr? @alexcrichton", "tree": {"sha": "c45eb7ac06aaf1a149391413b3217797ab19550c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c45eb7ac06aaf1a149391413b3217797ab19550c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/766fba3fdca8fe075c370a63d2f76f8407483af5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/766fba3fdca8fe075c370a63d2f76f8407483af5", "html_url": "https://github.com/rust-lang/rust/commit/766fba3fdca8fe075c370a63d2f76f8407483af5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/766fba3fdca8fe075c370a63d2f76f8407483af5/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "68fdecd0ba798586d657af7a68c8128f5a67650b", "url": "https://api.github.com/repos/rust-lang/rust/commits/68fdecd0ba798586d657af7a68c8128f5a67650b", "html_url": "https://github.com/rust-lang/rust/commit/68fdecd0ba798586d657af7a68c8128f5a67650b"}, {"sha": "057ad39ea85a85f8137772f0e9c5064b8d1d808a", "url": "https://api.github.com/repos/rust-lang/rust/commits/057ad39ea85a85f8137772f0e9c5064b8d1d808a", "html_url": "https://github.com/rust-lang/rust/commit/057ad39ea85a85f8137772f0e9c5064b8d1d808a"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "e612a63994ba4608b9943e694212c341aed85b35", "filename": "src/libpanic_unwind/gcc.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/766fba3fdca8fe075c370a63d2f76f8407483af5/src%2Flibpanic_unwind%2Fgcc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/766fba3fdca8fe075c370a63d2f76f8407483af5/src%2Flibpanic_unwind%2Fgcc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibpanic_unwind%2Fgcc.rs?ref=766fba3fdca8fe075c370a63d2f76f8407483af5", "patch": "@@ -188,7 +188,13 @@ cfg_if::cfg_if! {\n                 match eh_action {\n                     EHAction::None |\n                     EHAction::Cleanup(_) => return continue_unwind(exception_object, context),\n-                    EHAction::Catch(_) => return uw::_URC_HANDLER_FOUND,\n+                    EHAction::Catch(_) => {\n+                        // EHABI requires the personality routine to update the\n+                        // SP value in the barrier cache of the exception object.\n+                        (*exception_object).private[5] =\n+                            uw::_Unwind_GetGR(context, uw::UNWIND_SP_REG);\n+                        return uw::_URC_HANDLER_FOUND;\n+                    }\n                     EHAction::Terminate => return uw::_URC_FAILURE,\n                 }\n             } else {"}, {"sha": "087bbb4beb59c8b586c02b4906877bc413ba9607", "filename": "src/libunwind/libunwind.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/766fba3fdca8fe075c370a63d2f76f8407483af5/src%2Flibunwind%2Flibunwind.rs", "raw_url": "https://github.com/rust-lang/rust/raw/766fba3fdca8fe075c370a63d2f76f8407483af5/src%2Flibunwind%2Flibunwind.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibunwind%2Flibunwind.rs?ref=766fba3fdca8fe075c370a63d2f76f8407483af5", "patch": "@@ -23,6 +23,7 @@ pub type _Unwind_Word = uintptr_t;\n pub type _Unwind_Ptr = uintptr_t;\n pub type _Unwind_Trace_Fn =\n     extern \"C\" fn(ctx: *mut _Unwind_Context, arg: *mut c_void) -> _Unwind_Reason_Code;\n+\n #[cfg(target_arch = \"x86\")]\n pub const unwinder_private_data_size: usize = 5;\n \n@@ -152,6 +153,7 @@ if #[cfg(all(any(target_os = \"ios\", target_os = \"netbsd\", not(target_arch = \"arm\n     use _Unwind_VRS_DataRepresentation::*;\n \n     pub const UNWIND_POINTER_REG: c_int = 12;\n+    pub const UNWIND_SP_REG: c_int = 13;\n     pub const UNWIND_IP_REG: c_int = 15;\n \n     #[cfg_attr(all(feature = \"llvm-libunwind\","}]}