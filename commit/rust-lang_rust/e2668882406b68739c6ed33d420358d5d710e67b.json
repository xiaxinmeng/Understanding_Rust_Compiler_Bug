{"sha": "e2668882406b68739c6ed33d420358d5d710e67b", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUyNjY4ODgyNDA2YjY4NzM5YzZlZDMzZDQyMDM1OGQ1ZDcxMGU2N2I=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-08-27T15:31:11Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-08-27T15:31:11Z"}, "message": "Auto merge of #44110 - alexcrichton:docker-init, r=Mark-Simulacrum\n\nci: Remove the need for `dumb-init`\n\nNewer versions of Docker have a `--init` argument which spawns an init process\nin the container, which we should be able to use everywhere now.", "tree": {"sha": "4804b0dbea04a5148d7f7b5cad33e196f3bcb914", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4804b0dbea04a5148d7f7b5cad33e196f3bcb914"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e2668882406b68739c6ed33d420358d5d710e67b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e2668882406b68739c6ed33d420358d5d710e67b", "html_url": "https://github.com/rust-lang/rust/commit/e2668882406b68739c6ed33d420358d5d710e67b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e2668882406b68739c6ed33d420358d5d710e67b/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "eb8f2586ebd842dec49d3d7f50e49a985ab31493", "url": "https://api.github.com/repos/rust-lang/rust/commits/eb8f2586ebd842dec49d3d7f50e49a985ab31493", "html_url": "https://github.com/rust-lang/rust/commit/eb8f2586ebd842dec49d3d7f50e49a985ab31493"}, {"sha": "ffe64a26abb194a7ddcc5f410512043a65b3eb91", "url": "https://api.github.com/repos/rust-lang/rust/commits/ffe64a26abb194a7ddcc5f410512043a65b3eb91", "html_url": "https://github.com/rust-lang/rust/commit/ffe64a26abb194a7ddcc5f410512043a65b3eb91"}], "stats": {"total": 232, "additions": 2, "deletions": 230}, "files": [{"sha": "49d07d28d3c8e17431529b02271fa4d5534c0252", "filename": "src/ci/docker/arm-android/Dockerfile", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Farm-android%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Farm-android%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Farm-android%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,9 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/android-base-apt-get.sh /scripts/\n RUN sh /scripts/android-base-apt-get.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/android-ndk.sh /scripts/\n RUN . /scripts/android-ndk.sh && \\\n     download_and_make_toolchain android-ndk-r13b-linux-x86_64.zip arm 9\n@@ -38,4 +35,4 @@ COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n COPY scripts/android-start-emulator.sh /scripts/\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\", \"/scripts/android-start-emulator.sh\"]\n+ENTRYPOINT [\"/scripts/android-start-emulator.sh\"]"}, {"sha": "191f8e3a2895d738e3147206ae7db9173ad26cfe", "filename": "src/ci/docker/armhf-gnu/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Farmhf-gnu%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Farmhf-gnu%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Farmhf-gnu%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -73,14 +73,9 @@ RUN arm-linux-gnueabihf-gcc addentropy.c -o rootfs/addentropy -static\n # TODO: What is this?!\n RUN curl -O http://ftp.nl.debian.org/debian/dists/jessie/main/installer-armhf/current/images/device-tree/vexpress-v2p-ca15-tc1.dtb\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV RUST_CONFIGURE_ARGS \\\n       --target=arm-unknown-linux-gnueabihf \\\n       --qemu-armhf-rootfs=/tmp/rootfs"}, {"sha": "28caf1fb57a487acef872c34f999765814f31a7a", "filename": "src/ci/docker/asmjs/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fasmjs%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fasmjs%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fasmjs%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -13,9 +13,6 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   gdb \\\n   xz-utils\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/emscripten.sh /scripts/\n RUN bash /scripts/emscripten.sh\n \n@@ -35,5 +32,3 @@ ENV SCRIPT python2.7 ../x.py test --target $TARGETS\n \n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]"}, {"sha": "a83bbe9c60e8df278101259ac280cf76939a243c", "filename": "src/ci/docker/cross/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fcross%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fcross%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fcross%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -21,9 +21,6 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   libssl-dev \\\n   pkg-config\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n WORKDIR /tmp\n \n COPY cross/build-rumprun.sh /tmp/\n@@ -71,5 +68,3 @@ ENV SCRIPT python2.7 ../x.py dist --target $TARGETS\n # sccache\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]"}, {"sha": "9a0e45312235e6d7c737db65619acc183e6eb8ce", "filename": "src/ci/docker/disabled/aarch64-gnu/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Faarch64-gnu%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Faarch64-gnu%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdisabled%2Faarch64-gnu%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -70,14 +70,9 @@ RUN chmod +x rootfs/etc/init.d/rcS\n COPY scripts/qemu-bare-bones-addentropy.c /tmp/addentropy.c\n RUN aarch64-linux-gnu-gcc addentropy.c -o rootfs/addentropy -static\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV RUST_CONFIGURE_ARGS \\\n       --target=aarch64-unknown-linux-gnu \\\n       --qemu-aarch64-rootfs=/tmp/rootfs"}, {"sha": "20d823a3d7338d031803b4022a6e6ed25d156c39", "filename": "src/ci/docker/disabled/dist-aarch64-android/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Fdist-aarch64-android%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Fdist-aarch64-android%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdisabled%2Fdist-aarch64-android%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,9 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/android-base-apt-get.sh /scripts/\n RUN sh /scripts/android-base-apt-get.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/android-ndk.sh /scripts/\n RUN . /scripts/android-ndk.sh && \\\n     download_and_make_toolchain android-ndk-r13b-linux-x86_64.zip arm64 21\n@@ -28,5 +25,3 @@ ENV SCRIPT python2.7 ../x.py dist --target $HOSTS --host $HOSTS\n \n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]"}, {"sha": "3435d641a13c58d4348e8582f08795d1395391a6", "filename": "src/ci/docker/disabled/dist-armv7-android/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Fdist-armv7-android%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Fdist-armv7-android%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdisabled%2Fdist-armv7-android%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,9 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/android-base-apt-get.sh /scripts/\n RUN sh /scripts/android-base-apt-get.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/android-ndk.sh /scripts/\n RUN . /scripts/android-ndk.sh && \\\n     download_ndk android-ndk-r13b-linux-x86_64.zip && \\\n@@ -46,5 +43,3 @@ ENV SCRIPT \\\n \n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]"}, {"sha": "4bb7053760f9c3ec7f8f349a6a752cded0fd1cf2", "filename": "src/ci/docker/disabled/dist-i686-android/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Fdist-i686-android%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Fdist-i686-android%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdisabled%2Fdist-i686-android%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,9 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/android-base-apt-get.sh /scripts/\n RUN sh /scripts/android-base-apt-get.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/android-ndk.sh /scripts/\n RUN . /scripts/android-ndk.sh && \\\n     download_ndk android-ndk-r13b-linux-x86_64.zip && \\\n@@ -46,5 +43,3 @@ ENV SCRIPT \\\n \n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]"}, {"sha": "525b218417b67dcbb0559e9a2a4f63797e2b12d8", "filename": "src/ci/docker/disabled/dist-x86_64-android/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Fdist-x86_64-android%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Fdist-x86_64-android%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdisabled%2Fdist-x86_64-android%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,9 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/android-base-apt-get.sh /scripts/\n RUN sh /scripts/android-base-apt-get.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/android-ndk.sh /scripts/\n RUN . /scripts/android-ndk.sh && \\\n     download_and_make_toolchain android-ndk-r13b-linux-x86_64.zip x86_64 21\n@@ -28,5 +25,3 @@ ENV SCRIPT python2.7 ../x.py dist --target $HOSTS --host $HOSTS\n \n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]"}, {"sha": "ed19939545f69b6290e64844ba14cccfc9f015b9", "filename": "src/ci/docker/disabled/dist-x86_64-redox/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Fdist-x86_64-redox%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Fdist-x86_64-redox%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdisabled%2Fdist-x86_64-redox%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,11 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/cross-apt-packages.sh /scripts/\n RUN sh /scripts/cross-apt-packages.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n COPY scripts/crosstool-ng.sh /scripts/\n RUN sh /scripts/crosstool-ng.sh\n "}, {"sha": "6323369421bb44fb2b527ec46d30efe7eb959795", "filename": "src/ci/docker/disabled/wasm32-exp/Dockerfile", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Fwasm32-exp%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Fwasm32-exp%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdisabled%2Fwasm32-exp%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -15,10 +15,6 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   jq \\\n   bzip2\n \n-# dumb-init\n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n # emscripten\n COPY scripts/emscripten-wasm.sh /scripts/\n COPY disabled/wasm32-exp/node.sh /usr/local/bin/node\n@@ -37,6 +33,3 @@ ENV TARGETS=wasm32-experimental-emscripten\n ENV RUST_CONFIGURE_ARGS --target=$TARGETS --experimental-targets=WebAssembly\n \n ENV SCRIPT python2.7 ../x.py test --target $TARGETS\n-\n-# init\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]"}, {"sha": "7f6f8ae08827d8f88f80f1d087ccbedb34aa10a5", "filename": "src/ci/docker/disabled/wasm32/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Fwasm32%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdisabled%2Fwasm32%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdisabled%2Fwasm32%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -13,9 +13,6 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   gdb \\\n   xz-utils\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n # emscripten\n COPY scripts/emscripten.sh /scripts/\n RUN bash /scripts/emscripten.sh\n@@ -36,5 +33,3 @@ ENV TARGETS=wasm32-unknown-emscripten\n ENV RUST_CONFIGURE_ARGS --target=$TARGETS\n \n ENV SCRIPT python2.7 ../x.py test --target $TARGETS\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]"}, {"sha": "841d3012125f6895ef11aab20110599f2d989833", "filename": "src/ci/docker/dist-aarch64-linux/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-aarch64-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-aarch64-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-aarch64-linux%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,11 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/cross-apt-packages.sh /scripts/\n RUN sh /scripts/cross-apt-packages.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n # Ubuntu 16.04 (this container) ships with make 4, but something in the\n # toolchains we build below chokes on that, so go back to make 3\n COPY scripts/make3.sh /scripts/"}, {"sha": "a36f7fc1ac5288b6c329af7e1fceea197ac35a98", "filename": "src/ci/docker/dist-android/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-android%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-android%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-android%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,9 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/android-base-apt-get.sh /scripts/\n RUN sh /scripts/android-base-apt-get.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n # ndk\n COPY scripts/android-ndk.sh /scripts/\n RUN . /scripts/android-ndk.sh && \\\n@@ -36,5 +33,3 @@ ENV SCRIPT python2.7 ../x.py dist --target $TARGETS\n \n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]"}, {"sha": "ecd5090ea05fc96bed2c7587f03b0a4855fa9e48", "filename": "src/ci/docker/dist-arm-linux/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-arm-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-arm-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-arm-linux%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,11 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/cross-apt-packages.sh /scripts/\n RUN sh /scripts/cross-apt-packages.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n # Ubuntu 16.04 (this container) ships with make 4, but something in the\n # toolchains we build below chokes on that, so go back to make 3\n COPY scripts/make3.sh /scripts/"}, {"sha": "5bbd17bd41420ff5552de135ea2a46b0764d81ae", "filename": "src/ci/docker/dist-armhf-linux/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-armhf-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-armhf-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-armhf-linux%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,11 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/cross-apt-packages.sh /scripts/\n RUN sh /scripts/cross-apt-packages.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n # Ubuntu 16.04 (this container) ships with make 4, but something in the\n # toolchains we build below chokes on that, so go back to make 3\n COPY scripts/make3.sh /scripts/"}, {"sha": "ea9034d7178853509150f250ef0ed3a6560ad35a", "filename": "src/ci/docker/dist-armv7-linux/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-armv7-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-armv7-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-armv7-linux%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,11 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/cross-apt-packages.sh /scripts/\n RUN sh /scripts/cross-apt-packages.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n # Ubuntu 16.04 (this container) ships with make 4, but something in the\n # toolchains we build below chokes on that, so go back to make 3\n COPY scripts/make3.sh /scripts/"}, {"sha": "e18cb453baf6f3282b54eb613b9be551fbc1a950", "filename": "src/ci/docker/dist-fuchsia/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-fuchsia%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-fuchsia%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-fuchsia%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -24,11 +24,6 @@ WORKDIR /tmp\n COPY dist-fuchsia/shared.sh dist-fuchsia/build-toolchain.sh dist-fuchsia/compiler-rt-dso-handle.patch /tmp/\n RUN /tmp/build-toolchain.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n "}, {"sha": "efde3ff52962c55e709c3d878e2c07b77c6f39b3", "filename": "src/ci/docker/dist-i586-gnu-i686-musl/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-i586-gnu-i686-musl%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-i586-gnu-i686-musl%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-i586-gnu-i686-musl%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -20,11 +20,6 @@ WORKDIR /build/\n COPY dist-i586-gnu-i686-musl/musl-libunwind-patch.patch dist-i586-gnu-i686-musl/build-musl.sh /build/\n RUN sh /build/build-musl.sh && rm -rf /build\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n "}, {"sha": "b82d227b3ef2e8e682d02d13164240646942a11d", "filename": "src/ci/docker/dist-i686-freebsd/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-i686-freebsd%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-i686-freebsd%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-i686-freebsd%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -19,11 +19,6 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n COPY dist-i686-freebsd/build-toolchain.sh /tmp/\n RUN /tmp/build-toolchain.sh i686\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n "}, {"sha": "a5d776af19dafce1a5c48d287c209792757c0aca", "filename": "src/ci/docker/dist-i686-linux/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-i686-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-i686-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-i686-linux%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -76,11 +76,6 @@ RUN ./build-cmake.sh\n COPY dist-i686-linux/build-headers.sh /tmp/\n RUN ./build-headers.sh\n \n-RUN curl -Lo /rustroot/dumb-init \\\n-      https://github.com/Yelp/dumb-init/releases/download/v1.2.0/dumb-init_1.2.0_amd64 && \\\n-      chmod +x /rustroot/dumb-init\n-ENTRYPOINT [\"/rustroot/dumb-init\", \"--\"]\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n "}, {"sha": "94a3cf8a38201c5d4cc70821d433ae95b65d014e", "filename": "src/ci/docker/dist-mips-linux/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-mips-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-mips-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-mips-linux%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -17,14 +17,9 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   pkg-config\n \n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV HOSTS=mips-unknown-linux-gnu\n \n ENV RUST_CONFIGURE_ARGS --host=$HOSTS --enable-extended"}, {"sha": "0b0dfff1fe362092e2dc05389d74d2b458fadddb", "filename": "src/ci/docker/dist-mips64-linux/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-mips64-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-mips64-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-mips64-linux%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -16,14 +16,9 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   libssl-dev \\\n   pkg-config\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV HOSTS=mips64-unknown-linux-gnuabi64\n \n ENV RUST_CONFIGURE_ARGS --host=$HOSTS --enable-extended"}, {"sha": "1810b1cdc5ab762994c7161de94dcc2314e59bba", "filename": "src/ci/docker/dist-mips64el-linux/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-mips64el-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-mips64el-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-mips64el-linux%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -17,14 +17,9 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   pkg-config\n \n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV HOSTS=mips64el-unknown-linux-gnuabi64\n \n ENV RUST_CONFIGURE_ARGS --host=$HOSTS --enable-extended"}, {"sha": "f5be074847586f6ffb9ca4ed337250f96740d6c6", "filename": "src/ci/docker/dist-mipsel-linux/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-mipsel-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-mipsel-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-mipsel-linux%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -16,14 +16,9 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   libssl-dev \\\n   pkg-config\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV HOSTS=mipsel-unknown-linux-gnu\n \n ENV RUST_CONFIGURE_ARGS --host=$HOSTS --enable-extended"}, {"sha": "14ce3654fce7fc5011f1612984e111f13d726207", "filename": "src/ci/docker/dist-powerpc-linux/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-powerpc-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-powerpc-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-powerpc-linux%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,11 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/cross-apt-packages.sh /scripts/\n RUN sh /scripts/cross-apt-packages.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n # Ubuntu 16.04 (this container) ships with make 4, but something in the\n # toolchains we build below chokes on that, so go back to make 3\n COPY scripts/make3.sh /scripts/"}, {"sha": "1f6e83e2f49e59fd2746fd04dd6f39197bad00f5", "filename": "src/ci/docker/dist-powerpc64-linux/Dockerfile", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-powerpc64-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-powerpc64-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-powerpc64-linux%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,10 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/cross-apt-packages.sh /scripts/\n RUN sh /scripts/cross-apt-packages.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n \n # Ubuntu 16.04 (this container) ships with make 4, but something in the\n # toolchains we build below chokes on that, so go back to make 3"}, {"sha": "d4677e180609cfcc3a1a71d8e6a3ffa641f2f0a0", "filename": "src/ci/docker/dist-powerpc64le-linux/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-powerpc64le-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-powerpc64le-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-powerpc64le-linux%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,11 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/cross-apt-packages.sh /scripts/\n RUN sh /scripts/cross-apt-packages.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n # Ubuntu 16.04 (this container) ships with make 4, but something in the\n # toolchains we build below chokes on that, so go back to make 3\n COPY scripts/make3.sh /scripts/"}, {"sha": "39478e92f7c9ff097cffff8ee3ecfb1bef0750fa", "filename": "src/ci/docker/dist-s390x-linux/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-s390x-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-s390x-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-s390x-linux%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,11 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/cross-apt-packages.sh /scripts/\n RUN sh /scripts/cross-apt-packages.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n # Ubuntu 16.04 (this container) ships with make 4, but something in the\n # toolchains we build below chokes on that, so go back to make 3\n COPY scripts/make3.sh /scripts/"}, {"sha": "b7c00df4db2420f1f1cfe7acf20ac1b89aad3b35", "filename": "src/ci/docker/dist-x86_64-freebsd/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-x86_64-freebsd%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-x86_64-freebsd%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-x86_64-freebsd%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -19,11 +19,6 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n COPY dist-x86_64-freebsd/build-toolchain.sh /tmp/\n RUN /tmp/build-toolchain.sh x86_64\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n "}, {"sha": "a954fd86a2440657b6dc24121f0f5c74acf7ba3e", "filename": "src/ci/docker/dist-x86_64-linux/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-x86_64-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-x86_64-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-x86_64-linux%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -76,11 +76,6 @@ RUN ./build-cmake.sh\n COPY dist-x86_64-linux/build-headers.sh /tmp/\n RUN ./build-headers.sh\n \n-RUN curl -Lo /rustroot/dumb-init \\\n-      https://github.com/Yelp/dumb-init/releases/download/v1.2.0/dumb-init_1.2.0_amd64 && \\\n-      chmod +x /rustroot/dumb-init\n-ENTRYPOINT [\"/rustroot/dumb-init\", \"--\"]\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n "}, {"sha": "91ed6bfe1f63d3300392fde5bdec6e187c5d4217", "filename": "src/ci/docker/dist-x86_64-musl/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-x86_64-musl%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-x86_64-musl%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-x86_64-musl%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -20,11 +20,6 @@ WORKDIR /build/\n COPY dist-x86_64-musl/build-musl.sh /build/\n RUN sh /build/build-musl.sh && rm -rf /build\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n "}, {"sha": "4fd2503c31bb6f9d07200dd379658530217de572", "filename": "src/ci/docker/dist-x86_64-netbsd/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-x86_64-netbsd%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fdist-x86_64-netbsd%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-x86_64-netbsd%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -3,11 +3,6 @@ FROM ubuntu:16.04\n COPY scripts/cross-apt-packages.sh /scripts/\n RUN sh /scripts/cross-apt-packages.sh\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n # Ubuntu 16.04 (this container) ships with make 4, but something in the\n # toolchains we build below chokes on that, so go back to make 3\n COPY scripts/make3.sh /scripts/"}, {"sha": "5a83bd318c4d9f1787e662fab142c62884b21770", "filename": "src/ci/docker/i686-gnu-nopt/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fi686-gnu-nopt%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fi686-gnu-nopt%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fi686-gnu-nopt%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -14,13 +14,8 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   xz-utils\n \n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV RUST_CONFIGURE_ARGS --build=i686-unknown-linux-gnu --disable-optimize-tests\n ENV RUST_CHECK_TARGET check"}, {"sha": "daa24e0e8186df775cb6ec56393fb50affa2652b", "filename": "src/ci/docker/i686-gnu/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fi686-gnu%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fi686-gnu%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fi686-gnu%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -14,13 +14,8 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   xz-utils\n \n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV RUST_CONFIGURE_ARGS --build=i686-unknown-linux-gnu\n ENV SCRIPT python2.7 ../x.py test"}, {"sha": "5eba81ff60a22a935777712d32d43305a69d6454", "filename": "src/ci/docker/run.sh", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Frun.sh", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Frun.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Frun.sh?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -89,6 +89,7 @@ exec docker \\\n   --env TRAVIS_BRANCH \\\n   --volume \"$HOME/.cargo:/cargo\" \\\n   --volume \"$HOME/rustsrc:$HOME/rustsrc\" \\\n+  --init \\\n   --rm \\\n   rust-ci \\\n   /checkout/src/ci/run.sh"}, {"sha": "42ecec6ba08dc6cd83c3ceb2ed4789ccb5defe4b", "filename": "src/ci/docker/scripts/dumb-init.sh", "status": "removed", "additions": 0, "deletions": 15, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/eb8f2586ebd842dec49d3d7f50e49a985ab31493/src%2Fci%2Fdocker%2Fscripts%2Fdumb-init.sh", "raw_url": "https://github.com/rust-lang/rust/raw/eb8f2586ebd842dec49d3d7f50e49a985ab31493/src%2Fci%2Fdocker%2Fscripts%2Fdumb-init.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fscripts%2Fdumb-init.sh?ref=eb8f2586ebd842dec49d3d7f50e49a985ab31493", "patch": "@@ -1,15 +0,0 @@\n-# Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n-# file at the top-level directory of this distribution and at\n-# http://rust-lang.org/COPYRIGHT.\n-#\n-# Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n-# http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n-# <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n-# option. This file may not be copied, modified, or distributed\n-# except according to those terms.\n-\n-set -ex\n-\n-curl -fOL https://github.com/Yelp/dumb-init/releases/download/v1.2.0/dumb-init_1.2.0_amd64.deb\n-dpkg -i dumb-init_*.deb\n-rm dumb-init_*.deb"}, {"sha": "35a387221c644b3b9e6f165fa7cf7350a431ae00", "filename": "src/ci/docker/x86_64-gnu-aux/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu-aux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu-aux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fx86_64-gnu-aux%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -14,13 +14,8 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   xz-utils \\\n   pkg-config\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV RUST_CONFIGURE_ARGS --build=x86_64-unknown-linux-gnu\n ENV RUST_CHECK_TARGET check-aux"}, {"sha": "95d41028595f83979f5d5f5475c9241ff92a44d4", "filename": "src/ci/docker/x86_64-gnu-debug/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu-debug%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu-debug%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fx86_64-gnu-debug%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -13,14 +13,9 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   gdb \\\n   xz-utils\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV RUST_CONFIGURE_ARGS \\\n       --build=x86_64-unknown-linux-gnu \\\n       --enable-debug \\"}, {"sha": "786f59eb9f761640c92bea520a6d0c5ff547957e", "filename": "src/ci/docker/x86_64-gnu-distcheck/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu-distcheck%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu-distcheck%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fx86_64-gnu-distcheck%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -15,14 +15,9 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   libssl-dev \\\n   pkg-config\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV RUST_CONFIGURE_ARGS --build=x86_64-unknown-linux-gnu\n ENV SCRIPT python2.7 ../x.py test distcheck\n ENV DIST_SRC 1"}, {"sha": "70390c2ac1df18a52390b0196068d054a43561f3", "filename": "src/ci/docker/x86_64-gnu-full-bootstrap/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu-full-bootstrap%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu-full-bootstrap%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fx86_64-gnu-full-bootstrap%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -13,14 +13,9 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   gdb \\\n   xz-utils\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV RUST_CONFIGURE_ARGS \\\n       --build=x86_64-unknown-linux-gnu \\\n       --enable-full-bootstrap"}, {"sha": "d323677698cce0d0e5e85226a5b3611cd42b09b2", "filename": "src/ci/docker/x86_64-gnu-incremental/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu-incremental%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu-incremental%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fx86_64-gnu-incremental%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -13,14 +13,9 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   gdb \\\n   xz-utils\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV RUST_CONFIGURE_ARGS --build=x86_64-unknown-linux-gnu\n ENV RUSTFLAGS -Zincremental=/tmp/rust-incr-cache\n ENV RUST_CHECK_TARGET check"}, {"sha": "e832a2445ba146b55cc1ae7d0128f4a589a7dc31", "filename": "src/ci/docker/x86_64-gnu-llvm-3.7/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu-llvm-3.7%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu-llvm-3.7%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fx86_64-gnu-llvm-3.7%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -16,14 +16,9 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   zlib1g-dev \\\n   xz-utils\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV RUST_CONFIGURE_ARGS \\\n       --build=x86_64-unknown-linux-gnu \\\n       --llvm-root=/usr/lib/llvm-3.7"}, {"sha": "d2b0dd13dc2df985d46bd6d7c776e981f6b45aea", "filename": "src/ci/docker/x86_64-gnu-nopt/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu-nopt%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu-nopt%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fx86_64-gnu-nopt%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -13,13 +13,8 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   gdb \\\n   xz-utils\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV RUST_CONFIGURE_ARGS --build=x86_64-unknown-linux-gnu --disable-optimize-tests\n ENV RUST_CHECK_TARGET check"}, {"sha": "7570bca5906d10843e8e488de1a51487a99c7b8d", "filename": "src/ci/docker/x86_64-gnu/Dockerfile", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e2668882406b68739c6ed33d420358d5d710e67b/src%2Fci%2Fdocker%2Fx86_64-gnu%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fx86_64-gnu%2FDockerfile?ref=e2668882406b68739c6ed33d420358d5d710e67b", "patch": "@@ -13,13 +13,8 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   gdb \\\n   xz-utils\n \n-COPY scripts/dumb-init.sh /scripts/\n-RUN sh /scripts/dumb-init.sh\n-\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENTRYPOINT [\"/usr/bin/dumb-init\", \"--\"]\n-\n ENV RUST_CONFIGURE_ARGS --build=x86_64-unknown-linux-gnu --enable-sanitizers --enable-profiler\n ENV SCRIPT python2.7 ../x.py test"}]}