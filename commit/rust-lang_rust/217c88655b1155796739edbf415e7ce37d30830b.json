{"sha": "217c88655b1155796739edbf415e7ce37d30830b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIxN2M4ODY1NWIxMTU1Nzk2NzM5ZWRiZjQxNWU3Y2UzN2QzMDgzMGI=", "commit": {"author": {"name": "Ryan Levick", "email": "ryan.levick@gmail.com", "date": "2021-01-08T10:37:52Z"}, "committer": {"name": "Ryan Levick", "email": "me@ryanlevick.com", "date": "2021-03-03T10:22:52Z"}, "message": "Improve warning", "tree": {"sha": "7ae1bb24e8eb4e8ed865e6f424e9d3ffaa4a7e4e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7ae1bb24e8eb4e8ed865e6f424e9d3ffaa4a7e4e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/217c88655b1155796739edbf415e7ce37d30830b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/217c88655b1155796739edbf415e7ce37d30830b", "html_url": "https://github.com/rust-lang/rust/commit/217c88655b1155796739edbf415e7ce37d30830b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/217c88655b1155796739edbf415e7ce37d30830b/comments", "author": {"login": "rylev", "id": 1327285, "node_id": "MDQ6VXNlcjEzMjcyODU=", "avatar_url": "https://avatars.githubusercontent.com/u/1327285?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rylev", "html_url": "https://github.com/rylev", "followers_url": "https://api.github.com/users/rylev/followers", "following_url": "https://api.github.com/users/rylev/following{/other_user}", "gists_url": "https://api.github.com/users/rylev/gists{/gist_id}", "starred_url": "https://api.github.com/users/rylev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rylev/subscriptions", "organizations_url": "https://api.github.com/users/rylev/orgs", "repos_url": "https://api.github.com/users/rylev/repos", "events_url": "https://api.github.com/users/rylev/events{/privacy}", "received_events_url": "https://api.github.com/users/rylev/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rylev", "id": 1327285, "node_id": "MDQ6VXNlcjEzMjcyODU=", "avatar_url": "https://avatars.githubusercontent.com/u/1327285?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rylev", "html_url": "https://github.com/rylev", "followers_url": "https://api.github.com/users/rylev/followers", "following_url": "https://api.github.com/users/rylev/following{/other_user}", "gists_url": "https://api.github.com/users/rylev/gists{/gist_id}", "starred_url": "https://api.github.com/users/rylev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rylev/subscriptions", "organizations_url": "https://api.github.com/users/rylev/orgs", "repos_url": "https://api.github.com/users/rylev/repos", "events_url": "https://api.github.com/users/rylev/events{/privacy}", "received_events_url": "https://api.github.com/users/rylev/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c5ff54cbdb6b0da742110b416cdbcf0ca0ff0fc4", "url": "https://api.github.com/repos/rust-lang/rust/commits/c5ff54cbdb6b0da742110b416cdbcf0ca0ff0fc4", "html_url": "https://github.com/rust-lang/rust/commit/c5ff54cbdb6b0da742110b416cdbcf0ca0ff0fc4"}], "stats": {"total": 34, "additions": 18, "deletions": 16}, "files": [{"sha": "b9b5009d9dd95e9a52dd87860952065ee4e51d47", "filename": "compiler/rustc_lint/src/noop_method_call.rs", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/217c88655b1155796739edbf415e7ce37d30830b/compiler%2Frustc_lint%2Fsrc%2Fnoop_method_call.rs", "raw_url": "https://github.com/rust-lang/rust/raw/217c88655b1155796739edbf415e7ce37d30830b/compiler%2Frustc_lint%2Fsrc%2Fnoop_method_call.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Fnoop_method_call.rs?ref=217c88655b1155796739edbf415e7ce37d30830b", "patch": "@@ -70,11 +70,13 @@ impl<'tcx> LateLintPass<'tcx> for NoopMethodCall {\n                             .iter()\n                             .any(|s| cx.tcx.is_diagnostic_item(*s, i.def_id()))\n                             {\n-                                let span = expr.span;\n+                                let expr_span = expr.span;\n \n-                                cx.struct_span_lint(NOOP_METHOD_CALL, span, |lint| {\n-                                    let message = \"call to noop method\";\n-                                    lint.build(&message).emit()\n+                                cx.struct_span_lint(NOOP_METHOD_CALL, expr_span, |lint| {\n+                                    let message = \"call to method that does nothing\";\n+                                    lint.build(&message)\n+                                        .span_label(expr_span, \"unnecessary method call\")\n+                                        .emit()\n                                 });\n                             }\n                         }"}, {"sha": "b8ff75845bd7debe0c3559e30d1a3dc9b5cecdb7", "filename": "src/test/ui/lint/noop-method-call.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/217c88655b1155796739edbf415e7ce37d30830b/src%2Ftest%2Fui%2Flint%2Fnoop-method-call.rs", "raw_url": "https://github.com/rust-lang/rust/raw/217c88655b1155796739edbf415e7ce37d30830b/src%2Ftest%2Fui%2Flint%2Fnoop-method-call.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fnoop-method-call.rs?ref=217c88655b1155796739edbf415e7ce37d30830b", "patch": "@@ -21,25 +21,25 @@ impl<T> Deref for DerefExample<T> {\n \n fn main() {\n     let foo = &Foo(1u32);\n-    let foo_clone: &Foo<u32> = foo.clone(); //~ WARNING call to noop method\n+    let foo_clone: &Foo<u32> = foo.clone(); //~ WARNING call to method that does nothing [noop_method_call]\n \n     let bar = &Bar(1u32);\n     let bar_clone: Bar<u32> = bar.clone();\n \n     let deref = &&DerefExample(12u32);\n-    let derefed: &DerefExample<u32> = deref.deref(); //~ WARNING call to noop method\n+    let derefed: &DerefExample<u32> = deref.deref(); //~ WARNING call to method that does nothing [noop_method_call]\n \n     let deref = &DerefExample(12u32);\n     let derefed: &u32 = deref.deref();\n \n     let a = &&Foo(1u32);\n-    let borrowed: &Foo<u32> = a.borrow(); //~ WARNING call to noop method\n+    let borrowed: &Foo<u32> = a.borrow(); //~ WARNING call to method that does nothing [noop_method_call]\n }\n \n fn generic<T>(foo: &Foo<T>) {\n     foo.clone();\n }\n \n fn non_generic(foo: &Foo<u32>) {\n-    foo.clone(); //~ WARNING call to noop method\n+    foo.clone(); //~ WARNING call to method that does nothing [noop_method_call]\n }"}, {"sha": "f5b766f42333fb9fb7620a4c64d27dfff17b9817", "filename": "src/test/ui/lint/noop-method-call.stderr", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/217c88655b1155796739edbf415e7ce37d30830b/src%2Ftest%2Fui%2Flint%2Fnoop-method-call.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/217c88655b1155796739edbf415e7ce37d30830b/src%2Ftest%2Fui%2Flint%2Fnoop-method-call.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fnoop-method-call.stderr?ref=217c88655b1155796739edbf415e7ce37d30830b", "patch": "@@ -1,28 +1,28 @@\n-warning: call to noop method\n+warning: call to method that does nothing\n   --> $DIR/noop-method-call.rs:24:32\n    |\n LL |     let foo_clone: &Foo<u32> = foo.clone();\n-   |                                ^^^^^^^^^^^\n+   |                                ^^^^^^^^^^^ unnecessary method call\n    |\n    = note: `#[warn(noop_method_call)]` on by default\n \n-warning: call to noop method\n+warning: call to method that does nothing\n   --> $DIR/noop-method-call.rs:30:39\n    |\n LL |     let derefed: &DerefExample<u32> = deref.deref();\n-   |                                       ^^^^^^^^^^^^^\n+   |                                       ^^^^^^^^^^^^^ unnecessary method call\n \n-warning: call to noop method\n+warning: call to method that does nothing\n   --> $DIR/noop-method-call.rs:36:31\n    |\n LL |     let borrowed: &Foo<u32> = a.borrow();\n-   |                               ^^^^^^^^^^\n+   |                               ^^^^^^^^^^ unnecessary method call\n \n-warning: call to noop method\n+warning: call to method that does nothing\n   --> $DIR/noop-method-call.rs:44:5\n    |\n LL |     foo.clone();\n-   |     ^^^^^^^^^^^\n+   |     ^^^^^^^^^^^ unnecessary method call\n \n warning: 4 warnings emitted\n "}]}