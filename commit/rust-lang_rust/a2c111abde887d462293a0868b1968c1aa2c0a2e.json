{"sha": "a2c111abde887d462293a0868b1968c1aa2c0a2e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEyYzExMWFiZGU4ODdkNDYyMjkzYTA4NjhiMTk2OGMxYWEyYzBhMmU=", "commit": {"author": {"name": "Luqman Aden", "email": "laden@csclub.uwaterloo.ca", "date": "2013-11-20T11:00:49Z"}, "committer": {"name": "Luqman Aden", "email": "laden@csclub.uwaterloo.ca", "date": "2013-11-23T01:39:58Z"}, "message": "mk: Get rid of redundant LIBUV_FLAGS.", "tree": {"sha": "217f0ccaf079a560ff9ef234e63ee4adbbe51737", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/217f0ccaf079a560ff9ef234e63ee4adbbe51737"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a2c111abde887d462293a0868b1968c1aa2c0a2e", "comment_count": 4, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a2c111abde887d462293a0868b1968c1aa2c0a2e", "html_url": "https://github.com/rust-lang/rust/commit/a2c111abde887d462293a0868b1968c1aa2c0a2e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a2c111abde887d462293a0868b1968c1aa2c0a2e/comments", "author": {"login": "luqmana", "id": 287063, "node_id": "MDQ6VXNlcjI4NzA2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/287063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luqmana", "html_url": "https://github.com/luqmana", "followers_url": "https://api.github.com/users/luqmana/followers", "following_url": "https://api.github.com/users/luqmana/following{/other_user}", "gists_url": "https://api.github.com/users/luqmana/gists{/gist_id}", "starred_url": "https://api.github.com/users/luqmana/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luqmana/subscriptions", "organizations_url": "https://api.github.com/users/luqmana/orgs", "repos_url": "https://api.github.com/users/luqmana/repos", "events_url": "https://api.github.com/users/luqmana/events{/privacy}", "received_events_url": "https://api.github.com/users/luqmana/received_events", "type": "User", "site_admin": false}, "committer": {"login": "luqmana", "id": 287063, "node_id": "MDQ6VXNlcjI4NzA2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/287063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luqmana", "html_url": "https://github.com/luqmana", "followers_url": "https://api.github.com/users/luqmana/followers", "following_url": "https://api.github.com/users/luqmana/following{/other_user}", "gists_url": "https://api.github.com/users/luqmana/gists{/gist_id}", "starred_url": "https://api.github.com/users/luqmana/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luqmana/subscriptions", "organizations_url": "https://api.github.com/users/luqmana/orgs", "repos_url": "https://api.github.com/users/luqmana/repos", "events_url": "https://api.github.com/users/luqmana/events{/privacy}", "received_events_url": "https://api.github.com/users/luqmana/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6820ed4dcfe90136fb49e88fc44b0326035ac4c8", "url": "https://api.github.com/repos/rust-lang/rust/commits/6820ed4dcfe90136fb49e88fc44b0326035ac4c8", "html_url": "https://github.com/rust-lang/rust/commit/6820ed4dcfe90136fb49e88fc44b0326035ac4c8"}], "stats": {"total": 44, "additions": 6, "deletions": 38}, "files": [{"sha": "f2c7e0b1548b0620f7592a846209c55b54ecdf88", "filename": "mk/platform.mk", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/a2c111abde887d462293a0868b1968c1aa2c0a2e/mk%2Fplatform.mk", "raw_url": "https://github.com/rust-lang/rust/raw/a2c111abde887d462293a0868b1968c1aa2c0a2e/mk%2Fplatform.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fplatform.mk?ref=a2c111abde887d462293a0868b1968c1aa2c0a2e", "patch": "@@ -231,7 +231,7 @@ CFG_LIB_NAME_x86_64-apple-darwin=lib$(1).dylib\n CFG_STATIC_LIB_NAME_x86_64-apple-darwin=lib$(1).a\n CFG_LIB_GLOB_x86_64-apple-darwin=lib$(1)-*.dylib\n CFG_LIB_DSYM_GLOB_x86_64-apple-darwin=lib$(1)-*.dylib.dSYM\n-CFG_GCCISH_CFLAGS_x86_64-apple-darwin := -Wall -Werror -g -fPIC -m64 -arch x86_64\n+CFG_GCCISH_CFLAGS_x86_64-apple-darwin := -Wall -g -fPIC -m64 -arch x86_64\n CFG_GCCISH_CXXFLAGS_x86_64-apple-darwin := -fno-rtti\n CFG_GCCISH_LINK_FLAGS_x86_64-apple-darwin := -dynamiclib -pthread  -framework CoreServices -m64\n CFG_GCCISH_DEF_FLAG_x86_64-apple-darwin := -Wl,-exported_symbols_list,\n@@ -300,6 +300,7 @@ CFG_LDPATH_arm-linux-androideabi :=\n CFG_RUN_arm-linux-androideabi=\n CFG_RUN_TARG_arm-linux-androideabi=\n RUSTC_FLAGS_arm-linux-androideabi :=--android-cross-path=$(CFG_ANDROID_CROSS_PATH)\n+RUSTC_CROSS_FLAGS_arm-linux-androideabi :=--android-cross-path=$(CFG_ANDROID_CROSS_PATH)\n \n # arm-unknown-linux-gnueabihf configuration\n CROSS_PREFIX_arm-unknown-linux-gnueabihf=arm-linux-gnueabihf-\n@@ -395,7 +396,7 @@ CFG_LIB_NAME_i686-pc-mingw32=$(1).dll\n CFG_STATIC_LIB_NAME_i686-pc-mingw32=$(1).lib\n CFG_LIB_GLOB_i686-pc-mingw32=$(1)-*.dll\n CFG_LIB_DSYM_GLOB_i686-pc-mingw32=$(1)-*.dylib.dSYM\n-CFG_GCCISH_CFLAGS_i686-pc-mingw32 := -Wall -Werror -g -m32 -march=i686 -D_WIN32_WINNT=0x0600 -I$(CFG_SRC_DIR)src/etc/mingw-fix-include\n+CFG_GCCISH_CFLAGS_i686-pc-mingw32 := -Wall -g -m32 -march=i686 -D_WIN32_WINNT=0x0600 -I$(CFG_SRC_DIR)src/etc/mingw-fix-include\n CFG_GCCISH_CXXFLAGS_i686-pc-mingw32 := -fno-rtti\n CFG_GCCISH_LINK_FLAGS_i686-pc-mingw32 := -shared -fPIC -g -m32\n CFG_GCCISH_DEF_FLAG_i686-pc-mingw32 :="}, {"sha": "56e4868e929e8b50c9dcea2a57c0c431524da086", "filename": "mk/rt.mk", "status": "modified", "additions": 3, "deletions": 36, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/a2c111abde887d462293a0868b1968c1aa2c0a2e/mk%2Frt.mk", "raw_url": "https://github.com/rust-lang/rust/raw/a2c111abde887d462293a0868b1968c1aa2c0a2e/mk%2Frt.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Frt.mk?ref=a2c111abde887d462293a0868b1968c1aa2c0a2e", "patch": "@@ -23,39 +23,6 @@\n # fit the experimental data (i.e., I was able to get the system\n # working under these assumptions).\n \n-# Hack for passing flags into LIBUV, see below.\n-define DEF_LIBUV_FLAGS\n-ifeq ($(HOST_$(1)), i386)\n-\tifneq (,$(findstring mingw32,$(OSTYPE_$(1))))\n-\t\t# Don't add -fPIC since it's ignored for this target\n-\t\t# and it will just cause the build to fail due to -Werror\n-\t\tLIBUV_FLAGS_$(1) = -m32 -I$(S)src/etc/mingw-fix-include\n-\telse\n-\t\tLIBUV_FLAGS_$(1) = -m32 -fPIC -I$(S)src/etc/mingw-fix-include\n-\tendif\n-else ifeq ($(HOST_$(1)), x86_64)\n-\tifneq (,$(findstring mingw32,$(OSTYPE_$(1))))\n-\t\t# Don't add -fPIC since it's ignored for this target\n-\t\t# and it will just cause the build to fail due to -Werror\n-\t\tLIBUV_FLAGS_$(1) = -m64\n-\telse\n-\t\tLIBUV_FLAGS_$(1) = -m64 -fPIC\n-\tendif\n-else ifeq ($(HOST_$(1)), arm)\n-\tifeq ($(OSTYPE_$(1)), apple-darwin)\n-\t\tIOS_SDK := $(shell xcrun --show-sdk-path -sdk iphoneos 2>/dev/null)\n-\t\tLIBUV_FLAGS_$(1) = -fPIC -std=gnu99 -I$(IOS_SDK)/usr/include -I$(IOS_SDK)/usr/include/c++/4.2.1\n-\telse\n-\t\tLIBUV_FLAGS_$(1) = -fPIC -std=gnu99\n-\tendif\n-else ifeq ($(HOST_$(1)), mips)\n-\tLIBUV_FLAGS_$(1) = -fPIC -mips32r2 -msoft-float -mabi=32\n-else\n-\tLIBUV_FLAGS_$(1) = -fPIC -std=gnu99\n-endif\n-endef\n-$(foreach t,$(CFG_TARGET),$(eval $(call DEF_LIBUV_FLAGS,$(t))))\n-\n # when we're doing a snapshot build, we intentionally degrade as many\n # features in libuv and the runtime as possible, to ease portability.\n \n@@ -238,15 +205,15 @@ $$(LIBUV_MAKEFILE_$(1)): $$(LIBUV_DEPS)\n ifdef CFG_WINDOWSY_$(1)\n $$(LIBUV_LIB_$(1)): $$(LIBUV_DEPS)\n \t$$(Q)$$(MAKE) -C $$(S)src/libuv -f Makefile.mingw \\\n-\t\tCC=\"$$(CC_$(1)) $$(CFG_GCCISH_CFLAGS_$(1)) $$(LIBUV_FLAGS_$(1)) $$(SNAP_DEFINES)\" \\\n+\t\tCC=\"$$(CC_$(1)) $$(CFG_GCCISH_CFLAGS_$(1)) $$(SNAP_DEFINES)\" \\\n \t\tAR=\"$$(AR_$(1))\" \\\n \t\tV=$$(VERBOSE)\n \t$$(Q)cp $$(S)src/libuv/libuv.a $$@\n else\n $$(LIBUV_LIB_$(1)): $$(LIBUV_DEPS) $$(LIBUV_MAKEFILE_$(1))\n \t$$(Q)$$(MAKE) -C $$(@D) \\\n-\t\tCFLAGS=\"$$(CFG_GCCISH_CFLAGS_$(1)) $$(LIBUV_FLAGS_$(1)) $$(SNAP_DEFINES)\" \\\n-\t\tLDFLAGS=\"$$(CFG_GCCISH_LINK_FLAGS_$(1)) $$(LIBUV_FLAGS_$(1))\" \\\n+\t\tCFLAGS=\"$$(CFG_GCCISH_CFLAGS_$(1)) $$(SNAP_DEFINES)\" \\\n+\t\tLDFLAGS=\"$$(CFG_GCCISH_LINK_FLAGS_$(1))\" \\\n \t\tCC=\"$$(CC_$(1))\" \\\n \t\tCXX=\"$$(CXX_$(1))\" \\\n \t\tAR=\"$$(AR_$(1))\" \\"}]}