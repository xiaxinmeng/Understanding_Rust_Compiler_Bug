{"sha": "413a3515525829e1ddd93dbb391da0fe45e16ff8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQxM2EzNTE1NTI1ODI5ZTFkZGQ5M2RiYjM5MWRhMGZlNDVlMTZmZjg=", "commit": {"author": {"name": "Christian Poveda", "email": "christianpoveda@protonmail.com", "date": "2019-06-26T18:09:50Z"}, "committer": {"name": "Christian Poveda", "email": "christianpoveda@protonmail.com", "date": "2019-06-26T18:09:50Z"}, "message": "Initialize MemoryExtra with StdRng", "tree": {"sha": "d3b164670ca4ae4957a0d1a9cca2d02943ee6924", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d3b164670ca4ae4957a0d1a9cca2d02943ee6924"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/413a3515525829e1ddd93dbb391da0fe45e16ff8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/413a3515525829e1ddd93dbb391da0fe45e16ff8", "html_url": "https://github.com/rust-lang/rust/commit/413a3515525829e1ddd93dbb391da0fe45e16ff8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/413a3515525829e1ddd93dbb391da0fe45e16ff8/comments", "author": {"login": "pvdrz", "id": 31802960, "node_id": "MDQ6VXNlcjMxODAyOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/31802960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pvdrz", "html_url": "https://github.com/pvdrz", "followers_url": "https://api.github.com/users/pvdrz/followers", "following_url": "https://api.github.com/users/pvdrz/following{/other_user}", "gists_url": "https://api.github.com/users/pvdrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/pvdrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pvdrz/subscriptions", "organizations_url": "https://api.github.com/users/pvdrz/orgs", "repos_url": "https://api.github.com/users/pvdrz/repos", "events_url": "https://api.github.com/users/pvdrz/events{/privacy}", "received_events_url": "https://api.github.com/users/pvdrz/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pvdrz", "id": 31802960, "node_id": "MDQ6VXNlcjMxODAyOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/31802960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pvdrz", "html_url": "https://github.com/pvdrz", "followers_url": "https://api.github.com/users/pvdrz/followers", "following_url": "https://api.github.com/users/pvdrz/following{/other_user}", "gists_url": "https://api.github.com/users/pvdrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/pvdrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pvdrz/subscriptions", "organizations_url": "https://api.github.com/users/pvdrz/orgs", "repos_url": "https://api.github.com/users/pvdrz/repos", "events_url": "https://api.github.com/users/pvdrz/events{/privacy}", "received_events_url": "https://api.github.com/users/pvdrz/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "945f007c0d305c3ec069b5e5d911ef783f6d70e7", "url": "https://api.github.com/repos/rust-lang/rust/commits/945f007c0d305c3ec069b5e5d911ef783f6d70e7", "html_url": "https://github.com/rust-lang/rust/commit/945f007c0d305c3ec069b5e5d911ef783f6d70e7"}], "stats": {"total": 16, "additions": 12, "deletions": 4}, "files": [{"sha": "7bab1762bdd6c6e41dfac0c10403d248233199ed", "filename": "src/lib.rs", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/413a3515525829e1ddd93dbb391da0fe45e16ff8/src%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/413a3515525829e1ddd93dbb391da0fe45e16ff8/src%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib.rs?ref=413a3515525829e1ddd93dbb391da0fe45e16ff8", "patch": "@@ -50,7 +50,7 @@ use crate::range_map::RangeMap;\n pub use crate::helpers::{EvalContextExt as HelpersEvalContextExt};\n use crate::mono_hash_map::MonoHashMap;\n pub use crate::stacked_borrows::{EvalContextExt as StackedBorEvalContextExt};\n-use crate::memory::AllocExtra;\n+use crate::memory::{MemoryExtra, AllocExtra};\n \n // Used by priroda.\n pub use crate::stacked_borrows::{Tag, Permission, Stack, Stacks, Item};\n@@ -83,10 +83,8 @@ pub fn create_ecx<'mir, 'tcx: 'mir>(\n         tcx.at(syntax::source_map::DUMMY_SP),\n         ty::ParamEnv::reveal_all(),\n         Evaluator::new(config.validate),\n+        MemoryExtra::with_rng(config.seed.map(StdRng::seed_from_u64)),\n     );\n-\n-    // FIXME: InterpretCx::new should take an initial MemoryExtra\n-    ecx.memory_mut().extra.rng = config.seed.map(StdRng::seed_from_u64);\n     \n     let main_instance = ty::Instance::mono(ecx.tcx.tcx, main_id);\n     let main_mir = ecx.load_mir(main_instance.def)?;"}, {"sha": "252e1cc08ae522bcc4645428c07e6446d20f2c0e", "filename": "src/memory.rs", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/413a3515525829e1ddd93dbb391da0fe45e16ff8/src%2Fmemory.rs", "raw_url": "https://github.com/rust-lang/rust/raw/413a3515525829e1ddd93dbb391da0fe45e16ff8/src%2Fmemory.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmemory.rs?ref=413a3515525829e1ddd93dbb391da0fe45e16ff8", "patch": "@@ -15,6 +15,16 @@ pub struct MemoryExtra {\n     pub(crate) rng: Option<StdRng>\n }\n \n+impl MemoryExtra {\n+    pub fn with_rng(rng: Option<StdRng>) -> Self {\n+        MemoryExtra {\n+            stacked_borrows: Default::default(),\n+            intptrcast: Default::default(),\n+            rng,\n+        }\n+    }\n+}\n+\n #[derive(Debug, Clone)]\n pub struct AllocExtra {\n     pub stacked_borrows: stacked_borrows::AllocExtra,"}]}