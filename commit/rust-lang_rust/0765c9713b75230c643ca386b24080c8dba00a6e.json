{"sha": "0765c9713b75230c643ca386b24080c8dba00a6e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA3NjVjOTcxM2I3NTIzMGM2NDNjYTM4NmIyNDA4MGM4ZGJhMDBhNmU=", "commit": {"author": {"name": "Basti Ortiz", "email": "39114273+Some-Dood@users.noreply.github.com", "date": "2021-08-10T07:56:16Z"}, "committer": {"name": "Basti Ortiz", "email": "39114273+Some-Dood@users.noreply.github.com", "date": "2021-08-10T07:56:16Z"}, "message": "Refactor: use `filter_map` when iterating over stored IDs and", "tree": {"sha": "7b2c2f04d2eefbe7bca2ee34d7672894f08b2b1b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7b2c2f04d2eefbe7bca2ee34d7672894f08b2b1b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0765c9713b75230c643ca386b24080c8dba00a6e", "comment_count": 0, "verification": {"verified": false, "reason": "bad_email", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEqA0bdqgj8CYCkkcsFALVyxf0jhsFAmESMVUACgkQFALVyxf0\njhvBXg//VrdkNDANFSRDI5zfwyXsv0hpH406oOCkf3yJegN8u58iDoHX6Ccaw6wO\nOruUwzW5TfSHUMe3z4eqxZe3InavUifUe+rEUl+2UVIYGG4Wx6IPUpLj1BtBtcHV\nCgUSZ9Dru0xdfYrLOlYQUtATjjfyUbcknRFtgLfEXUsRPVl/J1uAj0EA1bcoTXMp\nIqDZcJoc6oKqOSFY6PbJlzLESVdPK65EgoNbhKXnVIUXfuAd17+K6OBLnc3Kanex\n7lPPEs9YUYVaIBJAYTQphkZB0DS4NT8ESfLYyPNeqH+0Y6bkj3Q3uxKoaQppwjXO\nhdht7GgE6dVxEov2thVW+NU2N4FbyiYTQrGAiC5WhdrSURZqf3MfKhaZ2CH0ZCFo\n4YSe2wZpI17rqw/e1HdvShL/gwUkgkMYdkkDf1frUXkI0/jL6G+EWBoDGX9a0vHR\nzEbBgkw4wC75yFIiQ+/gdlv2vQObVf1sPQrgb0u51uNoTFIzfXwe+35UDAXdK1IR\nWfVsKb+R6Q3Ff8rLNypn5B7J+8J/oioq4Xs9M5tA/j17zknzmA8i+euqfiFskglR\nn/xzAwPtoUZ7PvEbgEgkHBIKseTfJN0bf9JUwgZ0qkz2WcBSyI+ERgyRBj18IIeA\n/30Pnu5TsDNTzzTsYYNif5+V3s1YMuNJng33jukduy/GOH7q//o=\n=q7y4\n-----END PGP SIGNATURE-----", "payload": "tree 7b2c2f04d2eefbe7bca2ee34d7672894f08b2b1b\nparent e912d6507f38b98ce56fa1f44d1f52c0433fe8e6\nauthor Basti Ortiz <39114273+Some-Dood@users.noreply.github.com> 1628582176 +0800\ncommitter Basti Ortiz <39114273+Some-Dood@users.noreply.github.com> 1628582176 +0800\n\nRefactor: use `filter_map` when iterating over stored IDs and\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0765c9713b75230c643ca386b24080c8dba00a6e", "html_url": "https://github.com/rust-lang/rust/commit/0765c9713b75230c643ca386b24080c8dba00a6e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0765c9713b75230c643ca386b24080c8dba00a6e/comments", "author": {"login": "BastiDood", "id": 39114273, "node_id": "MDQ6VXNlcjM5MTE0Mjcz", "avatar_url": "https://avatars.githubusercontent.com/u/39114273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BastiDood", "html_url": "https://github.com/BastiDood", "followers_url": "https://api.github.com/users/BastiDood/followers", "following_url": "https://api.github.com/users/BastiDood/following{/other_user}", "gists_url": "https://api.github.com/users/BastiDood/gists{/gist_id}", "starred_url": "https://api.github.com/users/BastiDood/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BastiDood/subscriptions", "organizations_url": "https://api.github.com/users/BastiDood/orgs", "repos_url": "https://api.github.com/users/BastiDood/repos", "events_url": "https://api.github.com/users/BastiDood/events{/privacy}", "received_events_url": "https://api.github.com/users/BastiDood/received_events", "type": "User", "site_admin": false}, "committer": {"login": "BastiDood", "id": 39114273, "node_id": "MDQ6VXNlcjM5MTE0Mjcz", "avatar_url": "https://avatars.githubusercontent.com/u/39114273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BastiDood", "html_url": "https://github.com/BastiDood", "followers_url": "https://api.github.com/users/BastiDood/followers", "following_url": "https://api.github.com/users/BastiDood/following{/other_user}", "gists_url": "https://api.github.com/users/BastiDood/gists{/gist_id}", "starred_url": "https://api.github.com/users/BastiDood/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BastiDood/subscriptions", "organizations_url": "https://api.github.com/users/BastiDood/orgs", "repos_url": "https://api.github.com/users/BastiDood/repos", "events_url": "https://api.github.com/users/BastiDood/events{/privacy}", "received_events_url": "https://api.github.com/users/BastiDood/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e912d6507f38b98ce56fa1f44d1f52c0433fe8e6", "url": "https://api.github.com/repos/rust-lang/rust/commits/e912d6507f38b98ce56fa1f44d1f52c0433fe8e6", "html_url": "https://github.com/rust-lang/rust/commit/e912d6507f38b98ce56fa1f44d1f52c0433fe8e6"}], "stats": {"total": 13, "additions": 6, "deletions": 7}, "files": [{"sha": "8404f1635f814ef9c81b0012f8cafadc765ee4c8", "filename": "crates/vfs/src/lib.rs", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/0765c9713b75230c643ca386b24080c8dba00a6e/crates%2Fvfs%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0765c9713b75230c643ca386b24080c8dba00a6e/crates%2Fvfs%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fvfs%2Fsrc%2Flib.rs?ref=0765c9713b75230c643ca386b24080c8dba00a6e", "patch": "@@ -139,13 +139,12 @@ impl Vfs {\n     ///\n     /// This will skip deleted files.\n     pub fn iter(&self) -> impl Iterator<Item = (FileId, &VfsPath)> + '_ {\n-        (0..self.data.len())\n-            .map(|it| FileId(it as u32))\n-            .filter(move |&file_id| self.get(file_id).is_some())\n-            .map(move |file_id| {\n-                let path = self.interner.lookup(file_id);\n-                (file_id, path)\n-            })\n+        (0..self.data.len()).filter_map(move |it| {\n+            let file_id = FileId(it as u32);\n+            let _ = self.get(file_id).as_ref()?;\n+            let path = self.interner.lookup(file_id);\n+            Some((file_id, path))\n+        })\n     }\n \n     /// Update the `path` with the given `contents`. `None` means the file was deleted."}]}