{"sha": "f53b364dd652c108ae950fb95ff50147dcd5aa67", "node_id": "C_kwDOAAsO6NoAKGY1M2IzNjRkZDY1MmMxMDhhZTk1MGZiOTVmZjUwMTQ3ZGNkNWFhNjc", "commit": {"author": {"name": "Folkert", "email": "folkert@folkertdev.nl", "date": "2022-11-17T19:46:24Z"}, "committer": {"name": "Folkert", "email": "folkert@folkertdev.nl", "date": "2022-11-19T13:48:06Z"}, "message": "add -Zexport-executable-symbols to unstable book", "tree": {"sha": "67906cbedf3a992a0193b30da5dc129a3d5e358c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/67906cbedf3a992a0193b30da5dc129a3d5e358c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f53b364dd652c108ae950fb95ff50147dcd5aa67", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEUowsgMwt6A8Sy/7gHxf2/9ESuXwFAmN43pgACgkQHxf2/9ES\nuXxSpg/+JyHhffSlZERXTYl7N7JAwiU3e8jL2Blhnf6bqnu6YTQNB1pEAA+f18Z5\nnu64VdcS7LgzdzaS0yXWpBk5g0KSVz+GjShRKcGudetEOAQN9YMYCRa+SMeped6z\n4ppKqqdv9Hwz8Q/CCCDMMcS/Vd4y2FtIn7IvXSx+LlSkvyV94vJ81flB8QBzhdGI\nmWWwvPbJ4NMkKmnZWnwH9tTyjTcGfjatWmRLKRJrSovL+kAqWUNyPrVX6QnJVK4R\nNjXor6z/dk9jX9ODVo1OJtqXXcWFmoL+MmZP96YmhqLaiD9otmOJauHx5mZs1P9B\nqlZt0RpSsPVepCq6VN2ZAAqme2CL9YRho4l9rB+eg25vXJAeHlgOqyo54hJiiYay\nlcoJJ2DDLat+RvtN7zpmNvyeTeGdQVpS1/FPF5ICrmHv79St7EBCCcse8X+YHIlV\nRqlIy1mX53OOVSY3N3zM/E/rsnd6h2TvkfACKGGIZludoPmnWIJELgctSPue3mLq\n1yqgKh6ENi2CFtw53SYf+wVDn2p0Y5SQZ04ghehzEwryN76EjUOsKFfaJxRHETbe\nPrHVDxn/4T0/FW25nkJ2pVBDGaszD4kdNNMafFmQ6MMqHyw4ulJpduzzJktuJbLN\nIHpg0lF1ax53LA8KRncwvq5aa7Wu+zlacys20TwsoE9brq21aL4=\n=D/HB\n-----END PGP SIGNATURE-----", "payload": "tree 67906cbedf3a992a0193b30da5dc129a3d5e358c\nparent 63c748ee23ab7b6706655146f5b7c7f579811803\nauthor Folkert <folkert@folkertdev.nl> 1668714384 +0100\ncommitter Folkert <folkert@folkertdev.nl> 1668865686 +0100\n\nadd -Zexport-executable-symbols to unstable book\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f53b364dd652c108ae950fb95ff50147dcd5aa67", "html_url": "https://github.com/rust-lang/rust/commit/f53b364dd652c108ae950fb95ff50147dcd5aa67", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f53b364dd652c108ae950fb95ff50147dcd5aa67/comments", "author": {"login": "folkertdev", "id": 7949978, "node_id": "MDQ6VXNlcjc5NDk5Nzg=", "avatar_url": "https://avatars.githubusercontent.com/u/7949978?v=4", "gravatar_id": "", "url": "https://api.github.com/users/folkertdev", "html_url": "https://github.com/folkertdev", "followers_url": "https://api.github.com/users/folkertdev/followers", "following_url": "https://api.github.com/users/folkertdev/following{/other_user}", "gists_url": "https://api.github.com/users/folkertdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/folkertdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/folkertdev/subscriptions", "organizations_url": "https://api.github.com/users/folkertdev/orgs", "repos_url": "https://api.github.com/users/folkertdev/repos", "events_url": "https://api.github.com/users/folkertdev/events{/privacy}", "received_events_url": "https://api.github.com/users/folkertdev/received_events", "type": "User", "site_admin": false}, "committer": {"login": "folkertdev", "id": 7949978, "node_id": "MDQ6VXNlcjc5NDk5Nzg=", "avatar_url": "https://avatars.githubusercontent.com/u/7949978?v=4", "gravatar_id": "", "url": "https://api.github.com/users/folkertdev", "html_url": "https://github.com/folkertdev", "followers_url": "https://api.github.com/users/folkertdev/followers", "following_url": "https://api.github.com/users/folkertdev/following{/other_user}", "gists_url": "https://api.github.com/users/folkertdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/folkertdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/folkertdev/subscriptions", "organizations_url": "https://api.github.com/users/folkertdev/orgs", "repos_url": "https://api.github.com/users/folkertdev/repos", "events_url": "https://api.github.com/users/folkertdev/events{/privacy}", "received_events_url": "https://api.github.com/users/folkertdev/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "63c748ee23ab7b6706655146f5b7c7f579811803", "url": "https://api.github.com/repos/rust-lang/rust/commits/63c748ee23ab7b6706655146f5b7c7f579811803", "html_url": "https://github.com/rust-lang/rust/commit/63c748ee23ab7b6706655146f5b7c7f579811803"}], "stats": {"total": 43, "additions": 43, "deletions": 0}, "files": [{"sha": "c7f10afaccccd09af32d124e6a665365c956ea61", "filename": "src/doc/unstable-book/src/compiler-flags/export-executable-symbols.md", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/rust-lang/rust/blob/f53b364dd652c108ae950fb95ff50147dcd5aa67/src%2Fdoc%2Funstable-book%2Fsrc%2Fcompiler-flags%2Fexport-executable-symbols.md", "raw_url": "https://github.com/rust-lang/rust/raw/f53b364dd652c108ae950fb95ff50147dcd5aa67/src%2Fdoc%2Funstable-book%2Fsrc%2Fcompiler-flags%2Fexport-executable-symbols.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Fcompiler-flags%2Fexport-executable-symbols.md?ref=f53b364dd652c108ae950fb95ff50147dcd5aa67", "patch": "@@ -0,0 +1,43 @@\n+# `export-executable-symbols`\n+\n+The tracking issue for this feature is: [#84161](https://github.com/rust-lang/rust/issues/84161).\n+\n+------------------------\n+\n+The `-Zexport-executable-symbols` compiler flag makes `rustc` export symbols from executables. The resulting binary is runnable, but can also be used as a dynamic library. This is useful for interoperating with programs written in other languages, in particular languages with a runtime like Java or Lua.\n+\n+For example on windows:\n+```rust\n+#[no_mangle]\n+fn my_function() -> usize {\n+    return 42;\n+}\n+\n+fn main() {\n+    println!(\"Hello, world!\");\n+}\n+```\n+\n+A standard `cargo build` will produce a `.exe` without an export directory. When the `export-executable-symbols` flag is added\n+\n+```Bash\n+export RUSTFLAGS=\"-Zexport-executable-symbols\"\n+cargo build\n+```\n+\n+the binary has an export directory with the functions:\n+\n+```plain\n+The Export Tables (interpreted .edata section contents)\n+\n+...\n+\n+[Ordinal/Name Pointer] Table\n+    [   0] my_function\n+    [   1] main\n+```\n+(the output of `objdump -x` on the binary)\n+\n+Please note that the `#[no_mangle]` attribute is required. Without it, the symbol is not exported.\n+\n+The equivalent of this flag in C and C++ compilers is the `__declspec(dllexport)` annotation or the `-rdynamic` linker flag."}]}