{"sha": "0917b2123fff6cf5357b5edd5db6d675313ab8bd", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA5MTdiMjEyM2ZmZjZjZjUzNTdiNWVkZDVkYjZkNjc1MzEzYWI4YmQ=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-09-18T10:44:25Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-09-18T15:32:37Z"}, "message": "build-manifest: move PkgType into the versions module", "tree": {"sha": "b04ddbadadf831049a61bc583381ce23224472a7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b04ddbadadf831049a61bc583381ce23224472a7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0917b2123fff6cf5357b5edd5db6d675313ab8bd", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE1JbYPtLJAsc22U9xPgar6Auq8ZwFAl9k0xUACgkQPgar6Auq\n8ZwNzg//ZHGY8Sz/QJicTeAXQD4d+lbbVmyyCajshtfkzgkN2Q6ecsnW1RVVWD5z\n2rIn2wtaiqQzgEvGOOdLVK/n9w1PSygg5YFSMW5j+qqPsSj5i1avaVcTVyeP4IXv\nB6NMrOfhNUl/dB2pO2+DMi3gjI5J06fAkMoED5GExu9yKLYRh/Cpjg+oiO4u9zpX\navpCh1tSNipOybLPRPccqJJXtAXqgOUjwmdkezEYSX5QTNDBJ2vOUzpQan9/IFJq\nekMsW7qN9LeDADEuJoTH6DF24QhmaBKq+yd6moROim3RxB9EwWOkmQXIzA/KaOMK\nsLXLlP7VOODDwEWsJDzrxzyUnjn5CK64wx/stG8rh1v0+NyLRQCbJrDgZ7UgD2kn\n6uglwFiUFhDrOzPi5SLPlQa0Bmp+3hylzOHB7V7bfRSxc1YhyG+ZWG7x4b8XgwOR\nIc960H3DQIX1eELprryW9zZm5L7SKanSNPIY+7pa7hQ/PZVsNEv+gQ/lD6CvJFi2\naBc9rKHtm92w3kcrJUHbPLCL4rSBS8RQLqjUDEz4AGsQLrThTx7WTLN/EyB3X0ll\nUbGaBhv2qpZ/evTaWgkOcBkUU80TN4NMir66FQsleQhfZp6ZGAy6IaA2aC0qKoMg\nH/vzeMLdqfa57xj8foNFogAOFJjkEhYWKHEDSPL6nu/2ttQVSrk=\n=23hE\n-----END PGP SIGNATURE-----", "payload": "tree b04ddbadadf831049a61bc583381ce23224472a7\nparent b9af3e30a9e34e4fe353e7e5c42103851f9c8f79\nauthor Pietro Albini <pietro@pietroalbini.org> 1600425865 +0200\ncommitter Pietro Albini <pietro@pietroalbini.org> 1600443157 +0200\n\nbuild-manifest: move PkgType into the versions module\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0917b2123fff6cf5357b5edd5db6d675313ab8bd", "html_url": "https://github.com/rust-lang/rust/commit/0917b2123fff6cf5357b5edd5db6d675313ab8bd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0917b2123fff6cf5357b5edd5db6d675313ab8bd/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b9af3e30a9e34e4fe353e7e5c42103851f9c8f79", "url": "https://api.github.com/repos/rust-lang/rust/commits/b9af3e30a9e34e4fe353e7e5c42103851f9c8f79", "html_url": "https://github.com/rust-lang/rust/commit/b9af3e30a9e34e4fe353e7e5c42103851f9c8f79"}], "stats": {"total": 62, "additions": 31, "deletions": 31}, "files": [{"sha": "7a1878f749e70dfa7941b17450d61c3616a0abab", "filename": "src/tools/build-manifest/src/main.rs", "status": "modified", "additions": 4, "deletions": 31, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/0917b2123fff6cf5357b5edd5db6d675313ab8bd/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0917b2123fff6cf5357b5edd5db6d675313ab8bd/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs?ref=0917b2123fff6cf5357b5edd5db6d675313ab8bd", "patch": "@@ -4,8 +4,10 @@\n //! via `x.py dist hash-and-sign`; the cmdline arguments are set up\n //! by rustbuild (in `src/bootstrap/dist.rs`).\n \n-use serde::Serialize;\n+mod versions;\n \n+use crate::versions::PkgType;\n+use serde::Serialize;\n use std::collections::BTreeMap;\n use std::collections::HashMap;\n use std::env;\n@@ -336,35 +338,6 @@ fn main() {\n     .build();\n }\n \n-enum PkgType {\n-    RustSrc,\n-    Cargo,\n-    Rls,\n-    RustAnalyzer,\n-    Clippy,\n-    Rustfmt,\n-    LlvmTools,\n-    Miri,\n-    Other,\n-}\n-\n-impl PkgType {\n-    fn from_component(component: &str) -> Self {\n-        use PkgType::*;\n-        match component {\n-            \"rust-src\" => RustSrc,\n-            \"cargo\" => Cargo,\n-            \"rls\" | \"rls-preview\" => Rls,\n-            \"rust-analyzer\" | \"rust-analyzer-preview\" => RustAnalyzer,\n-            \"clippy\" | \"clippy-preview\" => Clippy,\n-            \"rustfmt\" | \"rustfmt-preview\" => Rustfmt,\n-            \"llvm-tools\" | \"llvm-tools-preview\" => LlvmTools,\n-            \"miri\" | \"miri-preview\" => Miri,\n-            _ => Other,\n-        }\n-    }\n-}\n-\n impl Builder {\n     fn build(&mut self) {\n         self.rust_version = self.version(\"rust\", \"x86_64-unknown-linux-gnu\");\n@@ -702,7 +675,7 @@ impl Builder {\n             Rustfmt => format!(\"rustfmt-{}-{}.tar.gz\", self.rustfmt_release, target),\n             LlvmTools => format!(\"llvm-tools-{}-{}.tar.gz\", self.llvm_tools_release, target),\n             Miri => format!(\"miri-{}-{}.tar.gz\", self.miri_release, target),\n-            Other => format!(\"{}-{}-{}.tar.gz\", component, self.rust_release, target),\n+            Other(_) => format!(\"{}-{}-{}.tar.gz\", component, self.rust_release, target),\n         }\n     }\n "}, {"sha": "044c04914b1875370c3acf723ba37f5adaf8d5e7", "filename": "src/tools/build-manifest/src/versions.rs", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/0917b2123fff6cf5357b5edd5db6d675313ab8bd/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fversions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0917b2123fff6cf5357b5edd5db6d675313ab8bd/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fversions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fversions.rs?ref=0917b2123fff6cf5357b5edd5db6d675313ab8bd", "patch": "@@ -0,0 +1,27 @@\n+pub(crate) enum PkgType {\n+    RustSrc,\n+    Cargo,\n+    Rls,\n+    RustAnalyzer,\n+    Clippy,\n+    Rustfmt,\n+    LlvmTools,\n+    Miri,\n+    Other(String),\n+}\n+\n+impl PkgType {\n+    pub(crate) fn from_component(component: &str) -> Self {\n+        match component {\n+            \"rust-src\" => PkgType::RustSrc,\n+            \"cargo\" => PkgType::Cargo,\n+            \"rls\" | \"rls-preview\" => PkgType::Rls,\n+            \"rust-analyzer\" | \"rust-analyzer-preview\" => PkgType::RustAnalyzer,\n+            \"clippy\" | \"clippy-preview\" => PkgType::Clippy,\n+            \"rustfmt\" | \"rustfmt-preview\" => PkgType::Rustfmt,\n+            \"llvm-tools\" | \"llvm-tools-preview\" => PkgType::LlvmTools,\n+            \"miri\" | \"miri-preview\" => PkgType::Miri,\n+            other => PkgType::Other(other.into()),\n+        }\n+    }\n+}"}]}