{"sha": "064eda47f126563e916156a618dc57972afeffa6", "node_id": "C_kwDOAAsO6NoAKDA2NGVkYTQ3ZjEyNjU2M2U5MTYxNTZhNjE4ZGM1Nzk3MmFmZWZmYTY", "commit": {"author": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2022-01-12T00:00:00Z"}, "committer": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2022-01-12T17:51:32Z"}, "message": "Migrate intrinsic-unreachable test to asm!", "tree": {"sha": "e567c72a59a6e3940e6b71b8e9780b816c6b83fd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e567c72a59a6e3940e6b71b8e9780b816c6b83fd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/064eda47f126563e916156a618dc57972afeffa6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/064eda47f126563e916156a618dc57972afeffa6", "html_url": "https://github.com/rust-lang/rust/commit/064eda47f126563e916156a618dc57972afeffa6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/064eda47f126563e916156a618dc57972afeffa6/comments", "author": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "02e6c64a046eaaed36944888b7f01a508cb31669", "url": "https://api.github.com/repos/rust-lang/rust/commits/02e6c64a046eaaed36944888b7f01a508cb31669", "html_url": "https://github.com/rust-lang/rust/commit/02e6c64a046eaaed36944888b7f01a508cb31669"}], "stats": {"total": 10, "additions": 5, "deletions": 5}, "files": [{"sha": "e7b9694d9f2ad6f20a2fb17d70f45b0550451f5c", "filename": "src/test/run-make-fulldeps/intrinsic-unreachable/exit-ret.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/064eda47f126563e916156a618dc57972afeffa6/src%2Ftest%2Frun-make-fulldeps%2Fintrinsic-unreachable%2Fexit-ret.rs", "raw_url": "https://github.com/rust-lang/rust/raw/064eda47f126563e916156a618dc57972afeffa6/src%2Ftest%2Frun-make-fulldeps%2Fintrinsic-unreachable%2Fexit-ret.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fintrinsic-unreachable%2Fexit-ret.rs?ref=064eda47f126563e916156a618dc57972afeffa6", "patch": "@@ -1,12 +1,11 @@\n-#![feature(llvm_asm)]\n #![crate_type=\"lib\"]\n+use std::arch::asm;\n \n #[deny(unreachable_code)]\n pub fn exit(n: usize) -> i32 {\n     unsafe {\n         // Pretend this asm is an exit() syscall.\n-        llvm_asm!(\"\" :: \"r\"(n) :: \"volatile\");\n-        // Can't actually reach this point, but rustc doesn't know that.\n+        asm!(\"/*{0}*/\", in(reg) n);\n     }\n     // This return value is just here to generate some extra code for a return\n     // value, making it easier for the test script to detect whether the"}, {"sha": "ec85db733df04d59a3c461d3eb6c64f252c2f15c", "filename": "src/test/run-make-fulldeps/intrinsic-unreachable/exit-unreachable.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/064eda47f126563e916156a618dc57972afeffa6/src%2Ftest%2Frun-make-fulldeps%2Fintrinsic-unreachable%2Fexit-unreachable.rs", "raw_url": "https://github.com/rust-lang/rust/raw/064eda47f126563e916156a618dc57972afeffa6/src%2Ftest%2Frun-make-fulldeps%2Fintrinsic-unreachable%2Fexit-unreachable.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fintrinsic-unreachable%2Fexit-unreachable.rs?ref=064eda47f126563e916156a618dc57972afeffa6", "patch": "@@ -1,13 +1,14 @@\n-#![feature(llvm_asm, core_intrinsics)]\n+#![feature(core_intrinsics)]\n #![crate_type=\"lib\"]\n+use std::arch::asm;\n \n use std::intrinsics;\n \n #[allow(unreachable_code)]\n pub fn exit(n: usize) -> i32 {\n     unsafe {\n         // Pretend this asm is an exit() syscall.\n-        llvm_asm!(\"\" :: \"r\"(n) :: \"volatile\");\n+        asm!(\"/*{0}*/\", in(reg) n);\n         intrinsics::unreachable()\n     }\n     // This return value is just here to generate some extra code for a return"}]}