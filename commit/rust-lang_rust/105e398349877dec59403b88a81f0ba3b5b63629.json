{"sha": "105e398349877dec59403b88a81f0ba3b5b63629", "node_id": "C_kwDOAAsO6NoAKDEwNWUzOTgzNDk4NzdkZWM1OTQwM2I4OGE4MWYwYmEzYjViNjM2Mjk", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-12-13T00:17:11Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-12-13T00:17:11Z"}, "message": "Rollup merge of #105629 - notriddle:notriddle/method-toggle-trait, r=GuillaumeGomez\n\nrustdoc: stop treating everything in a trait item as a method\n\nThis was added in 0b9b4b70683db6ef707755f520f139eb7b92a944 to fix the spacing on trait pages, but stopped being needed because 791f04e5a47ee78951552c7ed1545b2b01a44c74 stopped styling method-toggle. By only putting the method-toggle class on actual methods, the JS setting does the right thing.", "tree": {"sha": "b9df05569d7a3baa2a5ec7d168bcffaad94f97a3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b9df05569d7a3baa2a5ec7d168bcffaad94f97a3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/105e398349877dec59403b88a81f0ba3b5b63629", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjl8SHCRBK7hj4Ov3rIwAAc/kIAK4Wnf9kTK33KCGJ7oNoyzKK\ndubLCI+IkxhsfawxXXN75XeJUB5tOL6KAXLOjZbkL5JhkEk+9KiR+ynyi4R3CiuY\nDebOCpCwbmZOSTl/tchjKFUhdl6Ke25XYsKT9CTSBHYCj7O7lE0QuQK8EF+V9YI9\n+9joOdfGx/ju+enJZGYyvevVoKPT4DkKftEGoSI8xNKetYmdLzpnL7l3DQkYKb3o\nP5RJSNfEc1TrQdItxPiCzGDUyVWysDB98N4VSxL07iOKBjp47bzrXLNbvH+bdPZi\nS3Nxn1/x1Ce2LZWq9uZFKatlhR/pZyVgTwMSIGAIJWm7jxaqHRiS+vjGcY7YIRg=\n=/gSs\n-----END PGP SIGNATURE-----\n", "payload": "tree b9df05569d7a3baa2a5ec7d168bcffaad94f97a3\nparent 27078018587e9de92553e71f8657f866078532b4\nparent 7e64cebf97df021b7ece9df435e748652e0b2e83\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1670890631 +0100\ncommitter GitHub <noreply@github.com> 1670890631 +0100\n\nRollup merge of #105629 - notriddle:notriddle/method-toggle-trait, r=GuillaumeGomez\n\nrustdoc: stop treating everything in a trait item as a method\n\nThis was added in 0b9b4b70683db6ef707755f520f139eb7b92a944 to fix the spacing on trait pages, but stopped being needed because 791f04e5a47ee78951552c7ed1545b2b01a44c74 stopped styling method-toggle. By only putting the method-toggle class on actual methods, the JS setting does the right thing.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/105e398349877dec59403b88a81f0ba3b5b63629", "html_url": "https://github.com/rust-lang/rust/commit/105e398349877dec59403b88a81f0ba3b5b63629", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/105e398349877dec59403b88a81f0ba3b5b63629/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "27078018587e9de92553e71f8657f866078532b4", "url": "https://api.github.com/repos/rust-lang/rust/commits/27078018587e9de92553e71f8657f866078532b4", "html_url": "https://github.com/rust-lang/rust/commit/27078018587e9de92553e71f8657f866078532b4"}, {"sha": "7e64cebf97df021b7ece9df435e748652e0b2e83", "url": "https://api.github.com/repos/rust-lang/rust/commits/7e64cebf97df021b7ece9df435e748652e0b2e83", "html_url": "https://github.com/rust-lang/rust/commit/7e64cebf97df021b7ece9df435e748652e0b2e83"}], "stats": {"total": 16, "additions": 13, "deletions": 3}, "files": [{"sha": "2f1f4cbf3592457e7972dc043e04e6b86f27c3ae", "filename": "src/librustdoc/formats/item_type.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/105e398349877dec59403b88a81f0ba3b5b63629/src%2Flibrustdoc%2Fformats%2Fitem_type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/105e398349877dec59403b88a81f0ba3b5b63629/src%2Flibrustdoc%2Fformats%2Fitem_type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fformats%2Fitem_type.rs?ref=105e398349877dec59403b88a81f0ba3b5b63629", "patch": "@@ -177,6 +177,9 @@ impl ItemType {\n             ItemType::TraitAlias => \"traitalias\",\n         }\n     }\n+    pub(crate) fn is_method(&self) -> bool {\n+        matches!(*self, ItemType::Method | ItemType::TyMethod)\n+    }\n }\n \n impl fmt::Display for ItemType {"}, {"sha": "80fbe9c1f066c6dbc139027e4235475f15318674", "filename": "src/librustdoc/html/render/mod.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/105e398349877dec59403b88a81f0ba3b5b63629/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/105e398349877dec59403b88a81f0ba3b5b63629/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs?ref=105e398349877dec59403b88a81f0ba3b5b63629", "patch": "@@ -1512,8 +1512,7 @@ fn render_impl(\n \n         let toggled = !doc_buffer.is_empty();\n         if toggled {\n-            let method_toggle_class =\n-                if item_type == ItemType::Method { \" method-toggle\" } else { \"\" };\n+            let method_toggle_class = if item_type.is_method() { \" method-toggle\" } else { \"\" };\n             write!(w, \"<details class=\\\"rustdoc-toggle{}\\\" open><summary>\", method_toggle_class);\n         }\n         match &*item.kind {"}, {"sha": "a7b57c373e3bec3b4a9219758d8d020f2b1a0642", "filename": "src/librustdoc/html/render/print_item.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/105e398349877dec59403b88a81f0ba3b5b63629/src%2Flibrustdoc%2Fhtml%2Frender%2Fprint_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/105e398349877dec59403b88a81f0ba3b5b63629/src%2Flibrustdoc%2Fhtml%2Frender%2Fprint_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fprint_item.rs?ref=105e398349877dec59403b88a81f0ba3b5b63629", "patch": "@@ -732,7 +732,8 @@ fn item_trait(w: &mut Buffer, cx: &mut Context<'_>, it: &clean::Item, t: &clean:\n         document(&mut content, cx, m, Some(t), HeadingOffset::H5);\n         let toggled = !content.is_empty();\n         if toggled {\n-            write!(w, \"<details class=\\\"rustdoc-toggle method-toggle\\\" open><summary>\");\n+            let method_toggle_class = if item_type.is_method() { \" method-toggle\" } else { \"\" };\n+            write!(w, \"<details class=\\\"rustdoc-toggle{method_toggle_class}\\\" open><summary>\");\n         }\n         write!(w, \"<section id=\\\"{}\\\" class=\\\"method has-srclink\\\">\", id);\n         render_rightside(w, cx, m, t, RenderMode::Normal);"}, {"sha": "0a1f088b9ab5c8fb830f55120be7a6fb3d6b2f64", "filename": "src/test/rustdoc/toggle-trait-fn.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/105e398349877dec59403b88a81f0ba3b5b63629/src%2Ftest%2Frustdoc%2Ftoggle-trait-fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/105e398349877dec59403b88a81f0ba3b5b63629/src%2Ftest%2Frustdoc%2Ftoggle-trait-fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Ftoggle-trait-fn.rs?ref=105e398349877dec59403b88a81f0ba3b5b63629", "patch": "@@ -4,13 +4,20 @@\n // summary. Trait methods with no documentation should not be wrapped.\n //\n // @has foo/trait.Foo.html\n+// @has - '//details[@class=\"rustdoc-toggle\"]//summary//h4[@class=\"code-header\"]' 'type Item'\n+// @!has - '//details[@class=\"rustdoc-toggle\"]//summary//h4[@class=\"code-header\"]' 'type Item2'\n // @has -  '//details[@class=\"rustdoc-toggle method-toggle\"]//summary//h4[@class=\"code-header\"]' 'is_documented()'\n // @!has - '//details[@class=\"rustdoc-toggle method-toggle\"]//summary//h4[@class=\"code-header\"]' 'not_documented()'\n // @has -  '//details[@class=\"rustdoc-toggle method-toggle\"]//*[@class=\"docblock\"]' 'is_documented is documented'\n // @has -  '//details[@class=\"rustdoc-toggle method-toggle\"]//summary//h4[@class=\"code-header\"]' 'is_documented_optional()'\n // @!has - '//details[@class=\"rustdoc-toggle method-toggle\"]//summary//h4[@class=\"code-header\"]' 'not_documented_optional()'\n // @has -  '//details[@class=\"rustdoc-toggle method-toggle\"]//*[@class=\"docblock\"]' 'is_documented_optional is documented'\n pub trait Foo {\n+    /// is documented\n+    type Item;\n+\n+    type Item2;\n+\n     fn not_documented();\n \n     /// is_documented is documented"}]}