{"sha": "a0de408198d5f1e8e2d96b471450af3742dfdddc", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEwZGU0MDgxOThkNWYxZThlMmQ5NmI0NzE0NTBhZjM3NDJkZmRkZGM=", "commit": {"author": {"name": "juicejitsu", "email": "jujuicejitsu@gmail.com", "date": "2016-08-10T01:21:04Z"}, "committer": {"name": "juicejitsu", "email": "jujuicejitsu@gmail.com", "date": "2016-08-10T01:21:04Z"}, "message": "Don't emit filename in diff mode, add filename to diff metadata", "tree": {"sha": "1606faa4c0d4173e3dd4304d831636990bafa981", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1606faa4c0d4173e3dd4304d831636990bafa981"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a0de408198d5f1e8e2d96b471450af3742dfdddc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a0de408198d5f1e8e2d96b471450af3742dfdddc", "html_url": "https://github.com/rust-lang/rust/commit/a0de408198d5f1e8e2d96b471450af3742dfdddc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a0de408198d5f1e8e2d96b471450af3742dfdddc/comments", "author": null, "committer": null, "parents": [{"sha": "78b52ec3e130c0ead70f3e902206b7b068c53b9c", "url": "https://api.github.com/repos/rust-lang/rust/commits/78b52ec3e130c0ead70f3e902206b7b068c53b9c", "html_url": "https://github.com/rust-lang/rust/commit/78b52ec3e130c0ead70f3e902206b7b068c53b9c"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "5560e9aee852e14ea12e62d0e89c628746abf899", "filename": "src/filemap.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a0de408198d5f1e8e2d96b471450af3742dfdddc/src%2Ffilemap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a0de408198d5f1e8e2d96b471450af3742dfdddc/src%2Ffilemap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ffilemap.rs?ref=a0de408198d5f1e8e2d96b471450af3742dfdddc", "patch": "@@ -144,11 +144,11 @@ pub fn write_file<T>(text: &StringBuffer,\n             try!(write_system_newlines(stdout, text, config));\n         }\n         WriteMode::Diff => {\n-            println!(\"Diff of {}:\\n\", filename);\n             if let Ok((ori, fmt)) = source_and_formatted_text(text, filename, config) {\n                 let mismatch = make_diff(&ori, &fmt, 3);\n                 let has_diff = !mismatch.is_empty();\n-                print_diff(mismatch, |line_num| format!(\"\\nDiff at line {}:\", line_num));\n+                print_diff(mismatch,\n+                           |line_num| format!(\"Diff in {} at line {}:\", filename, line_num));\n                 return Ok(has_diff);\n             }\n         }"}, {"sha": "4e7257e60c888fe746c126508f688131db430837", "filename": "tests/system.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a0de408198d5f1e8e2d96b471450af3742dfdddc/tests%2Fsystem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a0de408198d5f1e8e2d96b471450af3742dfdddc/tests%2Fsystem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsystem.rs?ref=a0de408198d5f1e8e2d96b471450af3742dfdddc", "patch": "@@ -350,3 +350,9 @@ fn rustfmt_diff_make_diff_tests() {\n                                     DiffLine::Context(\"d\".into())],\n                     }]);\n }\n+\n+#[test]\n+fn rustfmt_diff_no_diff_test() {\n+    let diff = make_diff(\"a\\nb\\nc\\nd\", \"a\\nb\\nc\\nd\", 3);\n+    assert_eq!(diff, vec![]);\n+}"}]}