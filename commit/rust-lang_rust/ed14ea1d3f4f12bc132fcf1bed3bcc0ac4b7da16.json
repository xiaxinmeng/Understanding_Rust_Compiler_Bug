{"sha": "ed14ea1d3f4f12bc132fcf1bed3bcc0ac4b7da16", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVkMTRlYTFkM2Y0ZjEyYmMxMzJmY2YxYmVkM2JjYzBhYzRiN2RhMTY=", "commit": {"author": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-04-08T01:14:13Z"}, "committer": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-04-08T01:14:13Z"}, "message": "build: Use -O0 on Darwin. Seems that Darwin's GCC optimizations break rustrt.", "tree": {"sha": "83fce2712404e92c88b936b56e241c8eabaf705c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/83fce2712404e92c88b936b56e241c8eabaf705c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ed14ea1d3f4f12bc132fcf1bed3bcc0ac4b7da16", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ed14ea1d3f4f12bc132fcf1bed3bcc0ac4b7da16", "html_url": "https://github.com/rust-lang/rust/commit/ed14ea1d3f4f12bc132fcf1bed3bcc0ac4b7da16", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ed14ea1d3f4f12bc132fcf1bed3bcc0ac4b7da16/comments", "author": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "afa6d85d61cbc33e20387d1ba686aae5fc2e0f20", "url": "https://api.github.com/repos/rust-lang/rust/commits/afa6d85d61cbc33e20387d1ba686aae5fc2e0f20", "html_url": "https://github.com/rust-lang/rust/commit/afa6d85d61cbc33e20387d1ba686aae5fc2e0f20"}], "stats": {"total": 12, "additions": 7, "deletions": 5}, "files": [{"sha": "c9b5411559b2a29a8638f61a66e5dd1d54b0aa42", "filename": "Makefile.in", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/ed14ea1d3f4f12bc132fcf1bed3bcc0ac4b7da16/Makefile.in", "raw_url": "https://github.com/rust-lang/rust/raw/ed14ea1d3f4f12bc132fcf1bed3bcc0ac4b7da16/Makefile.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Makefile.in?ref=ed14ea1d3f4f12bc132fcf1bed3bcc0ac4b7da16", "patch": "@@ -11,7 +11,7 @@ endif\n \n CFG_INFO := $(info cfg: building on $(CFG_OSTYPE) $(CFG_CPUTYPE))\n \n-CFG_GCC_CFLAGS := -O2 -fno-strict-aliasing\n+CFG_GCC_CFLAGS := -fno-strict-aliasing\n CFG_GCC_LINK_FLAGS :=\n CFG_BOOT_FLAGS := $(BOOT_FLAGS)\n CFG_RUSTC_FLAGS := -nowarn -O\n@@ -23,7 +23,7 @@ CFG_DSYMUTIL := true\n \n ifeq ($(CFG_OSTYPE), FreeBSD)\n   CFG_LIB_NAME=lib$(1).so\n-  CFG_GCC_CFLAGS += -fPIC -march=i686 -I/usr/local/include\n+  CFG_GCC_CFLAGS += -fPIC -march=i686 -I/usr/local/include -O2\n   CFG_GCC_LINK_FLAGS += -shared -fPIC -lpthread -lrt\n   ifeq ($(CFG_CPUTYPE), x86_64)\n     CFG_GCC_CFLAGS += -m32\n@@ -36,7 +36,7 @@ endif\n \n ifeq ($(CFG_OSTYPE), Linux)\n   CFG_LIB_NAME=lib$(1).so\n-  CFG_GCC_CFLAGS += -fPIC -march=i686\n+  CFG_GCC_CFLAGS += -fPIC -march=i686 -O2\n   CFG_GCC_LINK_FLAGS += -shared -fPIC -ldl -lpthread -lrt\n   CFG_GCC_DEF_FLAG := -Wl,-whole-archive,--export-dynamic,--dynamic-list=\n   CFG_GCC_POST_LIB_FLAGS := -Wl,-no-whole-archive\n@@ -59,7 +59,9 @@ ifeq ($(CFG_OSTYPE), Darwin)\n   # \"on an i386\" when the whole userspace is 64-bit and the compiler\n   # emits 64-bit binaries by default. So we just force -m32 here. Smarter\n   # approaches welcome!\n-  CFG_GCC_CFLAGS += -m32\n+  #\n+  # NB: Currently GCC's optimizer breaks rustrt (task-comm-1 hangs) on Darwin.\n+  CFG_GCC_CFLAGS += -m32 -O0\n   CFG_GCC_LINK_FLAGS += -m32\n   CFG_DSYMUTIL := dsymutil\n   CFG_DEF_SUFFIX := .darwin.def\n@@ -90,7 +92,7 @@ ifdef CFG_WINDOWSY\n   ifdef CFG_FLEXLINK\n     CFG_BOOT_NATIVE := 1\n   endif\n-  CFG_GCC_CFLAGS += -march=i686\n+  CFG_GCC_CFLAGS += -march=i686 -O2\n   CFG_GCC_LINK_FLAGS += -shared -fPIC\n   CFG_DEF_SUFFIX := .def\n endif"}]}