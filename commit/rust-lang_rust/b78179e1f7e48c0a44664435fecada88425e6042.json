{"sha": "b78179e1f7e48c0a44664435fecada88425e6042", "node_id": "C_kwDOAAsO6NoAKGI3ODE3OWUxZjdlNDhjMGE0NDY2NDQzNWZlY2FkYTg4NDI1ZTYwNDI", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-05-06T02:34:25Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-05-06T02:34:25Z"}, "message": "Rollup merge of #96730 - JohnTitor:unused-lifetimes-tests, r=compiler-errors\n\nAdd a regression test for #64173 and #66152\n\nCloses #64173\nCloses #66152\n\nMixed the code as the root cause seems the same.", "tree": {"sha": "5a2116890ca5462275dce48be145b621d0f4aa7b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5a2116890ca5462275dce48be145b621d0f4aa7b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b78179e1f7e48c0a44664435fecada88425e6042", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJidIkxCRBK7hj4Ov3rIwAA9rAIAKBXZc1vpLz6cpfhnO9pzpV+\njLYTzA3uvhmzArPrCYX0/CfCYCHeB2z4I51XI8uRW3su5MidD0EmuhZznX8FsxSp\nolxUxXyUpao3HZ2XqUIQhs6kQi7DlbOLpeUMGs1Myzgeyffz+ADOh+jWcb3S2GXt\n5dwiSKGFlU3PYdcBOYNbjhh0RyYWKB5UrxHZCwJU4TohuEi003gQHDs70xS5lesP\nFvah5yg44qf9uXC+M1rQApD5l1HWwss317+gY/6p+0w/R8A/XRTKHKBwSA+muhNt\nI5a+8Fr3La0/ub8dRQR/UvUND/iuPr4RAdjYizq1GY9F1SVfC95tr23BC9KeOc8=\n=4jOw\n-----END PGP SIGNATURE-----\n", "payload": "tree 5a2116890ca5462275dce48be145b621d0f4aa7b\nparent 292eefe753a007af30329b6dbb3f1cbc840e4bf2\nparent cb131d2b4a1a56676c5f21bcf74ab373900eca2f\nauthor Michael Goulet <michael@errs.io> 1651804465 -0700\ncommitter GitHub <noreply@github.com> 1651804465 -0700\n\nRollup merge of #96730 - JohnTitor:unused-lifetimes-tests, r=compiler-errors\n\nAdd a regression test for #64173 and #66152\n\nCloses #64173\nCloses #66152\n\nMixed the code as the root cause seems the same.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b78179e1f7e48c0a44664435fecada88425e6042", "html_url": "https://github.com/rust-lang/rust/commit/b78179e1f7e48c0a44664435fecada88425e6042", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b78179e1f7e48c0a44664435fecada88425e6042/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "292eefe753a007af30329b6dbb3f1cbc840e4bf2", "url": "https://api.github.com/repos/rust-lang/rust/commits/292eefe753a007af30329b6dbb3f1cbc840e4bf2", "html_url": "https://github.com/rust-lang/rust/commit/292eefe753a007af30329b6dbb3f1cbc840e4bf2"}, {"sha": "cb131d2b4a1a56676c5f21bcf74ab373900eca2f", "url": "https://api.github.com/repos/rust-lang/rust/commits/cb131d2b4a1a56676c5f21bcf74ab373900eca2f", "html_url": "https://github.com/rust-lang/rust/commit/cb131d2b4a1a56676c5f21bcf74ab373900eca2f"}], "stats": {"total": 54, "additions": 54, "deletions": 0}, "files": [{"sha": "8080dd7dc34dbaaa6c90dadc828bbab20601a9a7", "filename": "src/test/ui/lifetimes/issue-64173-unused-lifetimes.rs", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/b78179e1f7e48c0a44664435fecada88425e6042/src%2Ftest%2Fui%2Flifetimes%2Fissue-64173-unused-lifetimes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b78179e1f7e48c0a44664435fecada88425e6042/src%2Ftest%2Fui%2Flifetimes%2Fissue-64173-unused-lifetimes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flifetimes%2Fissue-64173-unused-lifetimes.rs?ref=b78179e1f7e48c0a44664435fecada88425e6042", "patch": "@@ -0,0 +1,19 @@\n+use std::mem::size_of;\n+\n+struct Foo<'s> { //~ ERROR: parameter `'s` is never used\n+    array: [(); size_of::<&Self>()],\n+    //~^ ERROR: generic `Self` types are currently not permitted in anonymous constants\n+}\n+\n+// The below is taken from https://github.com/rust-lang/rust/issues/66152#issuecomment-550275017\n+// as the root cause seems the same.\n+\n+const fn foo<T>() -> usize {\n+    0\n+}\n+\n+struct Bar<'a> { //~ ERROR: parameter `'a` is never used\n+    beta: [(); foo::<&'a ()>()], //~ ERROR: a non-static lifetime is not allowed in a `const`\n+}\n+\n+fn main() {}"}, {"sha": "a487cbea5371b03a47c0b0f1bfea48a2a6067867", "filename": "src/test/ui/lifetimes/issue-64173-unused-lifetimes.stderr", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/b78179e1f7e48c0a44664435fecada88425e6042/src%2Ftest%2Fui%2Flifetimes%2Fissue-64173-unused-lifetimes.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b78179e1f7e48c0a44664435fecada88425e6042/src%2Ftest%2Fui%2Flifetimes%2Fissue-64173-unused-lifetimes.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flifetimes%2Fissue-64173-unused-lifetimes.stderr?ref=b78179e1f7e48c0a44664435fecada88425e6042", "patch": "@@ -0,0 +1,35 @@\n+error[E0658]: a non-static lifetime is not allowed in a `const`\n+  --> $DIR/issue-64173-unused-lifetimes.rs:16:23\n+   |\n+LL |     beta: [(); foo::<&'a ()>()],\n+   |                       ^^\n+   |\n+   = note: see issue #76560 <https://github.com/rust-lang/rust/issues/76560> for more information\n+   = help: add `#![feature(generic_const_exprs)]` to the crate attributes to enable\n+\n+error: generic `Self` types are currently not permitted in anonymous constants\n+  --> $DIR/issue-64173-unused-lifetimes.rs:4:28\n+   |\n+LL |     array: [(); size_of::<&Self>()],\n+   |                            ^^^^\n+\n+error[E0392]: parameter `'s` is never used\n+  --> $DIR/issue-64173-unused-lifetimes.rs:3:12\n+   |\n+LL | struct Foo<'s> {\n+   |            ^^ unused parameter\n+   |\n+   = help: consider removing `'s`, referring to it in a field, or using a marker such as `PhantomData`\n+\n+error[E0392]: parameter `'a` is never used\n+  --> $DIR/issue-64173-unused-lifetimes.rs:15:12\n+   |\n+LL | struct Bar<'a> {\n+   |            ^^ unused parameter\n+   |\n+   = help: consider removing `'a`, referring to it in a field, or using a marker such as `PhantomData`\n+\n+error: aborting due to 4 previous errors\n+\n+Some errors have detailed explanations: E0392, E0658.\n+For more information about an error, try `rustc --explain E0392`."}]}