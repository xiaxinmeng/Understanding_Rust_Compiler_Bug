{"sha": "6107e4c0b88d9e22482ed88c52b98c2ec2034bb1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYxMDdlNGMwYjg4ZDllMjI0ODJlZDg4YzUyYjk4YzJlYzIwMzRiYjE=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2015-03-20T00:06:15Z"}, "committer": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2015-03-20T07:13:15Z"}, "message": "Rollup merge of  #23534 - steveklabnik:remove_sched_threads, r=alexcrichton\n\nAs @alexcrichton says, this was really a libgreen thing, and isn't\nrelevant now.\n\nAs this removes a technically-public function, this is a\n\n[breaking-change]", "tree": {"sha": "4a63350e8437a7fb81d9351e29289214908c0b82", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4a63350e8437a7fb81d9351e29289214908c0b82"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6107e4c0b88d9e22482ed88c52b98c2ec2034bb1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6107e4c0b88d9e22482ed88c52b98c2ec2034bb1", "html_url": "https://github.com/rust-lang/rust/commit/6107e4c0b88d9e22482ed88c52b98c2ec2034bb1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6107e4c0b88d9e22482ed88c52b98c2ec2034bb1/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0711006694a2e7e79f7fc819b3b04af016a8bf93", "url": "https://api.github.com/repos/rust-lang/rust/commits/0711006694a2e7e79f7fc819b3b04af016a8bf93", "html_url": "https://github.com/rust-lang/rust/commit/0711006694a2e7e79f7fc819b3b04af016a8bf93"}, {"sha": "71321ff33fa3fe71cc1df541b3d0547b4e208923", "url": "https://api.github.com/repos/rust-lang/rust/commits/71321ff33fa3fe71cc1df541b3d0547b4e208923", "html_url": "https://github.com/rust-lang/rust/commit/71321ff33fa3fe71cc1df541b3d0547b4e208923"}], "stats": {"total": 34, "additions": 8, "deletions": 26}, "files": [{"sha": "5e8abfd0a3f8988a9f4a128e0bc233dd90b6aec8", "filename": "src/libstd/rt/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6107e4c0b88d9e22482ed88c52b98c2ec2034bb1/src%2Flibstd%2Frt%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6107e4c0b88d9e22482ed88c52b98c2ec2034bb1/src%2Flibstd%2Frt%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Frt%2Fmod.rs?ref=6107e4c0b88d9e22482ed88c52b98c2ec2034bb1", "patch": "@@ -30,7 +30,7 @@ use thunk::Thunk;\n use usize;\n \n // Reexport some of our utilities which are expected by other crates.\n-pub use self::util::{default_sched_threads, min_stack, running_on_valgrind};\n+pub use self::util::{min_stack, running_on_valgrind};\n pub use self::unwind::{begin_unwind, begin_unwind_fmt};\n \n // Reexport some functionality from liballoc."}, {"sha": "f1c43a07e6e3895ef35cc52369876cc8f0cc7350", "filename": "src/libstd/rt/util.rs", "status": "modified", "additions": 0, "deletions": 23, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/6107e4c0b88d9e22482ed88c52b98c2ec2034bb1/src%2Flibstd%2Frt%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6107e4c0b88d9e22482ed88c52b98c2ec2034bb1/src%2Flibstd%2Frt%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Frt%2Futil.rs?ref=6107e4c0b88d9e22482ed88c52b98c2ec2034bb1", "patch": "@@ -58,29 +58,6 @@ pub fn min_stack() -> uint {\n     return amt;\n }\n \n-/// Get's the number of scheduler threads requested by the environment\n-/// either `RUST_THREADS` or `num_cpus`.\n-#[allow(deprecated)]\n-pub fn default_sched_threads() -> uint {\n-    use os;\n-    match env::var(\"RUST_THREADS\") {\n-        Ok(nstr) => {\n-            let opt_n: Option<uint> = nstr.parse().ok();\n-            match opt_n {\n-                Some(n) if n > 0 => n,\n-                _ => panic!(\"`RUST_THREADS` is `{}`, should be a positive integer\", nstr)\n-            }\n-        }\n-        Err(..) => {\n-            if limit_thread_creation_due_to_osx_and_valgrind() {\n-                1\n-            } else {\n-                os::num_cpus()\n-            }\n-        }\n-    }\n-}\n-\n // Indicates whether we should perform expensive sanity checks, including rtassert!\n //\n // FIXME: Once the runtime matures remove the `true` below to turn off rtassert,"}, {"sha": "51decbab8587d1e516279ff98e05dccd3dd6ce91", "filename": "src/libtest/lib.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/6107e4c0b88d9e22482ed88c52b98c2ec2034bb1/src%2Flibtest%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6107e4c0b88d9e22482ed88c52b98c2ec2034bb1/src%2Flibtest%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibtest%2Flib.rs?ref=6107e4c0b88d9e22482ed88c52b98c2ec2034bb1", "patch": "@@ -44,6 +44,7 @@\n #![feature(std_misc)]\n #![feature(libc)]\n #![feature(set_stdio)]\n+#![feature(os)]\n \n extern crate getopts;\n extern crate serialize;\n@@ -841,8 +842,8 @@ fn run_tests<F>(opts: &TestOpts,\n     Ok(())\n }\n \n+#[allow(deprecated)]\n fn get_concurrency() -> uint {\n-    use std::rt;\n     match env::var(\"RUST_TEST_THREADS\") {\n         Ok(s) => {\n             let opt_n: Option<uint> = s.parse().ok();\n@@ -852,7 +853,11 @@ fn get_concurrency() -> uint {\n             }\n         }\n         Err(..) => {\n-            rt::default_sched_threads()\n+            if std::rt::util::limit_thread_creation_due_to_osx_and_valgrind() {\n+                1\n+            } else {\n+                std::os::num_cpus()\n+            }\n         }\n     }\n }"}]}