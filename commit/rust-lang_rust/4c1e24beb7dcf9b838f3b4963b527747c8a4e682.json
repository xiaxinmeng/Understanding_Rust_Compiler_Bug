{"sha": "4c1e24beb7dcf9b838f3b4963b527747c8a4e682", "node_id": "C_kwDOAAsO6NoAKDRjMWUyNGJlYjdkY2Y5YjgzOGYzYjQ5NjNiNTI3NzQ3YzhhNGU2ODI", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2021-12-06T09:40:38Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2021-12-06T09:40:38Z"}, "message": "Improve code for rustdoc-gui tester", "tree": {"sha": "adc25fa44456a3ba5431e2f597036e8c569abec4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/adc25fa44456a3ba5431e2f597036e8c569abec4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4c1e24beb7dcf9b838f3b4963b527747c8a4e682", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4c1e24beb7dcf9b838f3b4963b527747c8a4e682", "html_url": "https://github.com/rust-lang/rust/commit/4c1e24beb7dcf9b838f3b4963b527747c8a4e682", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4c1e24beb7dcf9b838f3b4963b527747c8a4e682/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "87dce6e8dfdae605c9c2a713cf0133066a52022a", "url": "https://api.github.com/repos/rust-lang/rust/commits/87dce6e8dfdae605c9c2a713cf0133066a52022a", "html_url": "https://github.com/rust-lang/rust/commit/87dce6e8dfdae605c9c2a713cf0133066a52022a"}], "stats": {"total": 10, "additions": 5, "deletions": 5}, "files": [{"sha": "32340ec7eecf2de70ce21723ea0ec2ade91c9e54", "filename": "src/tools/rustdoc-gui/tester.js", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/4c1e24beb7dcf9b838f3b4963b527747c8a4e682/src%2Ftools%2Frustdoc-gui%2Ftester.js", "raw_url": "https://github.com/rust-lang/rust/raw/4c1e24beb7dcf9b838f3b4963b527747c8a4e682/src%2Ftools%2Frustdoc-gui%2Ftester.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustdoc-gui%2Ftester.js?ref=4c1e24beb7dcf9b838f3b4963b527747c8a4e682", "patch": "@@ -133,7 +133,7 @@ async function main(argv) {\n     // Print successful tests too\n     let debug = false;\n     // Run tests in sequentially\n-    let no_headless = false;\n+    let headless = true;\n     const options = new Options();\n     try {\n         // This is more convenient that setting fields one by one.\n@@ -150,7 +150,7 @@ async function main(argv) {\n         }\n         if (opts[\"no_headless\"]) {\n             args.push(\"--no-headless\");\n-            no_headless = true;\n+            headless = false;\n         }\n         options.parseArguments(args);\n     } catch (error) {\n@@ -172,7 +172,7 @@ async function main(argv) {\n     }\n     files.sort();\n \n-    if (no_headless) {\n+    if (!headless) {\n         opts[\"jobs\"] = 1;\n         console.log(\"`--no-headless` option is active, disabling concurrency for running tests.\");\n     }\n@@ -181,7 +181,7 @@ async function main(argv) {\n \n     if (opts[\"jobs\"] < 1) {\n         process.setMaxListeners(files.length + 1);\n-    } else if (!no_headless) {\n+    } else if (headless) {\n         process.setMaxListeners(opts[\"jobs\"] + 1);\n     }\n \n@@ -226,7 +226,7 @@ async function main(argv) {\n             await Promise.race(tests_queue);\n         }\n     }\n-    if (!no_headless && tests_queue.length > 0) {\n+    if (tests_queue.length > 0) {\n         await Promise.all(tests_queue);\n     }\n     status_bar.finish();"}]}