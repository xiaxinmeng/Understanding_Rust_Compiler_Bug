{"sha": "554847c513cecbc66ab20d253f8f7ce077b75256", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU1NDg0N2M1MTNjZWNiYzY2YWIyMGQyNTNmOGY3Y2UwNzdiNzUyNTY=", "commit": {"author": {"name": "Josh Stone", "email": "jistone@redhat.com", "date": "2020-04-16T20:58:47Z"}, "committer": {"name": "Josh Stone", "email": "jistone@redhat.com", "date": "2020-04-16T20:58:47Z"}, "message": "Dogfood or_patterns in rustdoc", "tree": {"sha": "5be74b8bece18bf46dded70d2cbac1a2a79f4a57", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5be74b8bece18bf46dded70d2cbac1a2a79f4a57"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/554847c513cecbc66ab20d253f8f7ce077b75256", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/554847c513cecbc66ab20d253f8f7ce077b75256", "html_url": "https://github.com/rust-lang/rust/commit/554847c513cecbc66ab20d253f8f7ce077b75256", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/554847c513cecbc66ab20d253f8f7ce077b75256/comments", "author": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7fb5187d0423f4cd0441526571b8cd61927123c9", "url": "https://api.github.com/repos/rust-lang/rust/commits/7fb5187d0423f4cd0441526571b8cd61927123c9", "html_url": "https://github.com/rust-lang/rust/commit/7fb5187d0423f4cd0441526571b8cd61927123c9"}], "stats": {"total": 63, "additions": 33, "deletions": 30}, "files": [{"sha": "ad9d54c345cfa0f32cb0a1de967c5c9b07b8c8ed", "filename": "src/librustdoc/clean/mod.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Fclean%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Fclean%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Fmod.rs?ref=554847c513cecbc66ab20d253f8f7ce077b75256", "patch": "@@ -377,9 +377,11 @@ impl Clean<Lifetime> for hir::Lifetime {\n     fn clean(&self, cx: &DocContext<'_>) -> Lifetime {\n         let def = cx.tcx.named_region(self.hir_id);\n         match def {\n-            Some(rl::Region::EarlyBound(_, node_id, _))\n-            | Some(rl::Region::LateBound(_, node_id, _))\n-            | Some(rl::Region::Free(_, node_id)) => {\n+            Some(\n+                rl::Region::EarlyBound(_, node_id, _)\n+                | rl::Region::LateBound(_, node_id, _)\n+                | rl::Region::Free(_, node_id),\n+            ) => {\n                 if let Some(lt) = cx.lt_substs.borrow().get(&node_id).cloned() {\n                     return lt;\n                 }"}, {"sha": "24817170e36ee0768ba387c5bd2d15607906ca7d", "filename": "src/librustdoc/clean/utils.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Fclean%2Futils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Fclean%2Futils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Futils.rs?ref=554847c513cecbc66ab20d253f8f7ce077b75256", "patch": "@@ -586,7 +586,7 @@ pub fn resolve_type(cx: &DocContext<'_>, path: Path, id: hir::HirId) -> Type {\n         Res::Def(DefKind::TyParam, _) if path.segments.len() == 1 => {\n             return Generic(format!(\"{:#}\", path.print()));\n         }\n-        Res::SelfTy(..) | Res::Def(DefKind::TyParam, _) | Res::Def(DefKind::AssocTy, _) => true,\n+        Res::SelfTy(..) | Res::Def(DefKind::TyParam | DefKind::AssocTy, _) => true,\n         _ => false,\n     };\n     let did = register_res(&*cx, path.res);"}, {"sha": "c4bc73770a76b3981f2a8e0ed7225d8a1ccdad45", "filename": "src/librustdoc/html/highlight.rs", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Fhtml%2Fhighlight.rs", "raw_url": "https://github.com/rust-lang/rust/raw/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Fhtml%2Fhighlight.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fhighlight.rs?ref=554847c513cecbc66ab20d253f8f7ce077b75256", "patch": "@@ -235,9 +235,7 @@ impl<'a> Classifier<'a> {\n             // If this '&' or '*' token is followed by a non-whitespace token, assume that it's the\n             // reference or dereference operator or a reference or pointer type, instead of the\n             // bit-and or multiplication operator.\n-            token::BinOp(token::And) | token::BinOp(token::Star)\n-                if self.peek()? != &token::Whitespace =>\n-            {\n+            token::BinOp(token::And | token::Star) if self.peek()? != &token::Whitespace => {\n                 Class::RefKeyWord\n             }\n \n@@ -275,9 +273,7 @@ impl<'a> Classifier<'a> {\n             | token::ModSep\n             | token::LArrow\n             | token::OpenDelim(_)\n-            | token::CloseDelim(token::Brace)\n-            | token::CloseDelim(token::Paren)\n-            | token::CloseDelim(token::NoDelim) => Class::None,\n+            | token::CloseDelim(token::Brace | token::Paren | token::NoDelim) => Class::None,\n \n             token::Question => Class::QuestionMark,\n "}, {"sha": "941e3a5fa985bdaaf1abd1a6806b41f379f0ca94", "filename": "src/librustdoc/html/markdown.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs", "raw_url": "https://github.com/rust-lang/rust/raw/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs?ref=554847c513cecbc66ab20d253f8f7ce077b75256", "patch": "@@ -850,7 +850,7 @@ pub fn plain_summary_line(md: &str) -> String {\n                 Event::Start(Tag::Heading(_)) => (None, 1),\n                 Event::Code(code) => (Some(format!(\"`{}`\", code)), 0),\n                 Event::Text(ref s) if self.is_in > 0 => (Some(s.as_ref().to_owned()), 0),\n-                Event::End(Tag::Paragraph) | Event::End(Tag::Heading(_)) => (None, -1),\n+                Event::End(Tag::Paragraph | Tag::Heading(_)) => (None, -1),\n                 _ => (None, 0),\n             };\n             if is_in > 0 || (is_in < 0 && self.is_in > 0) {\n@@ -909,7 +909,7 @@ pub fn markdown_links(md: &str) -> Vec<(String, Option<Range<usize>>)> {\n                 debug!(\"found link: {}\", dest);\n                 links.push(match dest {\n                     CowStr::Borrowed(s) => (s.to_owned(), locate(s)),\n-                    s @ CowStr::Boxed(..) | s @ CowStr::Inlined(..) => (s.into_string(), None),\n+                    s @ (CowStr::Boxed(..) | CowStr::Inlined(..)) => (s.into_string(), None),\n                 });\n             }\n         }"}, {"sha": "f3c5c12810bf2b2727458ce84b7df16abfcdaa58", "filename": "src/librustdoc/html/render/cache.rs", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Fhtml%2Frender%2Fcache.rs", "raw_url": "https://github.com/rust-lang/rust/raw/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Fhtml%2Frender%2Fcache.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fcache.rs?ref=554847c513cecbc66ab20d253f8f7ce077b75256", "patch": "@@ -294,10 +294,13 @@ impl DocFolder for Cache {\n                             // for where the type was defined. On the other\n                             // hand, `paths` always has the right\n                             // information if present.\n-                            Some(&(ref fqp, ItemType::Trait))\n-                            | Some(&(ref fqp, ItemType::Struct))\n-                            | Some(&(ref fqp, ItemType::Union))\n-                            | Some(&(ref fqp, ItemType::Enum)) => Some(&fqp[..fqp.len() - 1]),\n+                            Some(&(\n+                                ref fqp,\n+                                ItemType::Trait\n+                                | ItemType::Struct\n+                                | ItemType::Union\n+                                | ItemType::Enum,\n+                            )) => Some(&fqp[..fqp.len() - 1]),\n                             Some(..) => Some(&*self.stack),\n                             None => None,\n                         };"}, {"sha": "5fb7b7bf959cf2cf33041e93fa9753e8192cce59", "filename": "src/librustdoc/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Flib.rs?ref=554847c513cecbc66ab20d253f8f7ce077b75256", "patch": "@@ -7,6 +7,7 @@\n #![feature(box_syntax)]\n #![feature(in_band_lifetimes)]\n #![feature(nll)]\n+#![feature(or_patterns)]\n #![feature(test)]\n #![feature(vec_remove_item)]\n #![feature(ptr_offset_from)]"}, {"sha": "8bfd42ac56a8e5152d15f514395487846501439c", "filename": "src/librustdoc/passes/collect_intra_doc_links.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "raw_url": "https://github.com/rust-lang/rust/raw/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs?ref=554847c513cecbc66ab20d253f8f7ce077b75256", "patch": "@@ -149,7 +149,7 @@ impl<'a, 'tcx> LinkCollector<'a, 'tcx> {\n                 // In case this is a trait item, skip the\n                 // early return and try looking for the trait.\n                 let value = match res {\n-                    Res::Def(DefKind::AssocFn, _) | Res::Def(DefKind::AssocConst, _) => true,\n+                    Res::Def(DefKind::AssocFn | DefKind::AssocConst, _) => true,\n                     Res::Def(DefKind::AssocTy, _) => false,\n                     Res::Def(DefKind::Variant, _) => {\n                         return handle_variant(cx, res, extra_fragment);\n@@ -226,10 +226,10 @@ impl<'a, 'tcx> LinkCollector<'a, 'tcx> {\n             }\n             let ty_res = ty_res.map_id(|_| panic!(\"unexpected node_id\"));\n             match ty_res {\n-                Res::Def(DefKind::Struct, did)\n-                | Res::Def(DefKind::Union, did)\n-                | Res::Def(DefKind::Enum, did)\n-                | Res::Def(DefKind::TyAlias, did) => {\n+                Res::Def(\n+                    DefKind::Struct | DefKind::Union | DefKind::Enum | DefKind::TyAlias,\n+                    did,\n+                ) => {\n                     let item = cx\n                         .tcx\n                         .inherent_impls(did)\n@@ -814,7 +814,7 @@ fn ambiguity_error(\n \n                     for (res, ns) in candidates {\n                         let (action, mut suggestion) = match res {\n-                            Res::Def(DefKind::AssocFn, _) | Res::Def(DefKind::Fn, _) => {\n+                            Res::Def(DefKind::AssocFn | DefKind::Fn, _) => {\n                                 (\"add parentheses\", format!(\"{}()\", path_str))\n                             }\n                             Res::Def(DefKind::Macro(..), _) => {"}, {"sha": "b7a3b13cf04919f4575ebb82e760220174036622", "filename": "src/librustdoc/visit_ast.rs", "status": "modified", "additions": 9, "deletions": 8, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Fvisit_ast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/554847c513cecbc66ab20d253f8f7ce077b75256/src%2Flibrustdoc%2Fvisit_ast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fvisit_ast.rs?ref=554847c513cecbc66ab20d253f8f7ce077b75256", "patch": "@@ -309,14 +309,15 @@ impl<'a, 'tcx> RustdocVisitor<'a, 'tcx> {\n             let attrs = clean::inline::load_attrs(self.cx, res_did);\n             let self_is_hidden = attrs.lists(sym::doc).has_word(sym::hidden);\n             match res {\n-                Res::Def(DefKind::Trait, did)\n-                | Res::Def(DefKind::Struct, did)\n-                | Res::Def(DefKind::Union, did)\n-                | Res::Def(DefKind::Enum, did)\n-                | Res::Def(DefKind::ForeignTy, did)\n-                | Res::Def(DefKind::TyAlias, did)\n-                    if !self_is_hidden =>\n-                {\n+                Res::Def(\n+                    DefKind::Trait\n+                    | DefKind::Struct\n+                    | DefKind::Union\n+                    | DefKind::Enum\n+                    | DefKind::ForeignTy\n+                    | DefKind::TyAlias,\n+                    did,\n+                ) if !self_is_hidden => {\n                     self.cx.renderinfo.get_mut().access_levels.map.insert(did, AccessLevel::Public);\n                 }\n                 Res::Def(DefKind::Mod, did) => {"}]}