{"sha": "fb1ae1747f8a338ad4a69d5a8862f802ecf4de01", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZiMWFlMTc0N2Y4YTMzOGFkNGE2OWQ1YTg4NjJmODAyZWNmNGRlMDE=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-08-30T05:22:35Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-08-30T05:22:35Z"}, "message": "Fix cast_lossless false positive in impl const fn\n\nFixes https://github.com/rust-lang/rust-clippy/issues/3656#issuecomment-526387382", "tree": {"sha": "9c4b959e6e2a98d9e66fe2886e5603d34608027e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9c4b959e6e2a98d9e66fe2886e5603d34608027e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fb1ae1747f8a338ad4a69d5a8862f802ecf4de01", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJEBAABCgAuFiEEj4U0bmbiMSg/mWqvgqphyqETl+YFAl1osuYQHGRldkBwaGFu\nc2NoLm5ldAAKCRCCqmHKoROX5o8xD/9BLu96UDe1OlBAZrOCCRHGD6wqJXDY9TtO\nF92SjM4wWdoq46H+BfiBai+vVlGBmuRpyxvPsh24K3QC1MUitupMNZmTNGK+PlGV\n+k4oBpn8d95BK3xHp0zCpwSKmgDPU886+JVNxNapdlsn/F6c8YGdw98Cjdocgky9\nCGSADWIWb39etzRaV6xra+aQ6fsK6GjfzsUOkKTitxIFrbg0keemGCVddqY71NLW\n7b/b/50Rac99CLq94r6QiCdbf02LnBGcJDdKqs24wosIQoMjO2SZ+nivGmm9XF6G\n8MXeTt2tZZxqZ/DJWFUbcW0aifIyzPVg1GtuwbLEKawnk2yGE33j9yWGPVqWPW7L\nRoNSUv3v9TykPwpsu2u8Q0U3c9DkXB0BJw1skw/e3pncawQgv9EwgzQnHFYsEoZ/\nr2hgHy1BRp3qXyVCLRvYBnajkuCYtCVENygo//iTEozDaX+mid6nbQgXW+iEhjse\nTFG7n5NBEOfhlX5TPOl0fk/aq/Psla/KGmflJeVDHbqmuNvKcAFQ3cPZIb9Db9S4\neROW+eSUn98kY2S7EK1wIIT2vEaGTxWUoU4gGWjB/u9ZlgbamMZE66lJ/DI8M88l\nZZiv9J703lR777IXiPPczhHjBw75KTtl5wpxESE9LZzrNFsFR2MhEvUeLIpi6ymR\n4SaDyvxhmA==\n=88s3\n-----END PGP SIGNATURE-----", "payload": "tree 9c4b959e6e2a98d9e66fe2886e5603d34608027e\nparent 28a8a6a4834db7b6869d3b645528b31002deba57\nauthor Philipp Hansch <dev@phansch.net> 1567142555 +0200\ncommitter Philipp Hansch <dev@phansch.net> 1567142555 +0200\n\nFix cast_lossless false positive in impl const fn\n\nFixes https://github.com/rust-lang/rust-clippy/issues/3656#issuecomment-526387382\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fb1ae1747f8a338ad4a69d5a8862f802ecf4de01", "html_url": "https://github.com/rust-lang/rust/commit/fb1ae1747f8a338ad4a69d5a8862f802ecf4de01", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fb1ae1747f8a338ad4a69d5a8862f802ecf4de01/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "28a8a6a4834db7b6869d3b645528b31002deba57", "url": "https://api.github.com/repos/rust-lang/rust/commits/28a8a6a4834db7b6869d3b645528b31002deba57", "html_url": "https://github.com/rust-lang/rust/commit/28a8a6a4834db7b6869d3b645528b31002deba57"}], "stats": {"total": 48, "additions": 48, "deletions": 0}, "files": [{"sha": "1aff61e3186075c0aaf0080403e8c37e9e31a13e", "filename": "clippy_lints/src/utils/mod.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fb1ae1747f8a338ad4a69d5a8862f802ecf4de01/clippy_lints%2Fsrc%2Futils%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb1ae1747f8a338ad4a69d5a8862f802ecf4de01/clippy_lints%2Fsrc%2Futils%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Fmod.rs?ref=fb1ae1747f8a338ad4a69d5a8862f802ecf4de01", "patch": "@@ -88,6 +88,10 @@ pub fn in_constant(cx: &LateContext<'_, '_>, id: HirId) -> bool {\n             node: ItemKind::Fn(_, header, ..),\n             ..\n         }) => header.constness == Constness::Const,\n+        Node::ImplItem(&ImplItem {\n+            node: ImplItemKind::Method(ref sig, _),\n+            ..\n+        }) => sig.header.constness == Constness::Const,\n         _ => false,\n     }\n }"}, {"sha": "709d58b596c83ad7de53cdc40d43fc73c58fe59b", "filename": "tests/ui/cast_lossless_float.fixed", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/fb1ae1747f8a338ad4a69d5a8862f802ecf4de01/tests%2Fui%2Fcast_lossless_float.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/fb1ae1747f8a338ad4a69d5a8862f802ecf4de01/tests%2Fui%2Fcast_lossless_float.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcast_lossless_float.fixed?ref=fb1ae1747f8a338ad4a69d5a8862f802ecf4de01", "patch": "@@ -32,3 +32,14 @@ fn main() {\n const fn abc(input: f32) -> f64 {\n     input as f64\n }\n+\n+// Same as the above issue. We can't suggest `::from` in const fns in impls\n+mod cast_lossless_in_impl {\n+    struct A;\n+\n+    impl A {\n+        pub const fn convert(x: f32) -> f64 {\n+            x as f64\n+        }\n+    }\n+}"}, {"sha": "eb0aab8864290978ee6505e616f3a7050d731a1c", "filename": "tests/ui/cast_lossless_float.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/fb1ae1747f8a338ad4a69d5a8862f802ecf4de01/tests%2Fui%2Fcast_lossless_float.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb1ae1747f8a338ad4a69d5a8862f802ecf4de01/tests%2Fui%2Fcast_lossless_float.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcast_lossless_float.rs?ref=fb1ae1747f8a338ad4a69d5a8862f802ecf4de01", "patch": "@@ -32,3 +32,14 @@ fn main() {\n const fn abc(input: f32) -> f64 {\n     input as f64\n }\n+\n+// Same as the above issue. We can't suggest `::from` in const fns in impls\n+mod cast_lossless_in_impl {\n+    struct A;\n+\n+    impl A {\n+        pub const fn convert(x: f32) -> f64 {\n+            x as f64\n+        }\n+    }\n+}"}, {"sha": "03e49adb117db00d9bce74596e78d20e04f3cf11", "filename": "tests/ui/cast_lossless_integer.fixed", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/fb1ae1747f8a338ad4a69d5a8862f802ecf4de01/tests%2Fui%2Fcast_lossless_integer.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/fb1ae1747f8a338ad4a69d5a8862f802ecf4de01/tests%2Fui%2Fcast_lossless_integer.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcast_lossless_integer.fixed?ref=fb1ae1747f8a338ad4a69d5a8862f802ecf4de01", "patch": "@@ -34,3 +34,14 @@ fn main() {\n const fn abc(input: u16) -> u32 {\n     input as u32\n }\n+\n+// Same as the above issue. We can't suggest `::from` in const fns in impls\n+mod cast_lossless_in_impl {\n+    struct A;\n+\n+    impl A {\n+        pub const fn convert(x: u32) -> u64 {\n+            x as u64\n+        }\n+    }\n+}"}, {"sha": "6a984d245963f761bcca28ca73e03ec748e9a2bf", "filename": "tests/ui/cast_lossless_integer.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/fb1ae1747f8a338ad4a69d5a8862f802ecf4de01/tests%2Fui%2Fcast_lossless_integer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb1ae1747f8a338ad4a69d5a8862f802ecf4de01/tests%2Fui%2Fcast_lossless_integer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcast_lossless_integer.rs?ref=fb1ae1747f8a338ad4a69d5a8862f802ecf4de01", "patch": "@@ -34,3 +34,14 @@ fn main() {\n const fn abc(input: u16) -> u32 {\n     input as u32\n }\n+\n+// Same as the above issue. We can't suggest `::from` in const fns in impls\n+mod cast_lossless_in_impl {\n+    struct A;\n+\n+    impl A {\n+        pub const fn convert(x: u32) -> u64 {\n+            x as u64\n+        }\n+    }\n+}"}]}