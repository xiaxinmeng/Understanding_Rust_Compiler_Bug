{"sha": "7e3c51d085d9eaa2204cc18763bc7d98b66435fd", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdlM2M1MWQwODVkOWVhYTIyMDRjYzE4NzYzYmM3ZDk4YjY2NDM1ZmQ=", "commit": {"author": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2020-01-16T00:00:00Z"}, "committer": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2020-01-25T18:48:02Z"}, "message": "Instrument C / C++ in MemorySanitizer example\n\nModify the example to instrument C / C++ in addition to Rust, since it\nwill be generally required (e.g., when using libbacktrace for symbolication).\n\nAdditionally use rustc specific flag to track the origins of unitialized\nmemory rather than LLVM one.", "tree": {"sha": "e2f9c74f84d906aff24aa6afc4e78eac10f0b0c4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e2f9c74f84d906aff24aa6afc4e78eac10f0b0c4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7e3c51d085d9eaa2204cc18763bc7d98b66435fd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7e3c51d085d9eaa2204cc18763bc7d98b66435fd", "html_url": "https://github.com/rust-lang/rust/commit/7e3c51d085d9eaa2204cc18763bc7d98b66435fd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7e3c51d085d9eaa2204cc18763bc7d98b66435fd/comments", "author": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3bf71b3d5c07afc0908881a0868080ed399ca6ca", "url": "https://api.github.com/repos/rust-lang/rust/commits/3bf71b3d5c07afc0908881a0868080ed399ca6ca", "html_url": "https://github.com/rust-lang/rust/commit/3bf71b3d5c07afc0908881a0868080ed399ca6ca"}], "stats": {"total": 12, "additions": 10, "deletions": 2}, "files": [{"sha": "c799374354b3ed0ebdec57774010fb413be2defd", "filename": "src/doc/unstable-book/src/compiler-flags/sanitizer.md", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/7e3c51d085d9eaa2204cc18763bc7d98b66435fd/src%2Fdoc%2Funstable-book%2Fsrc%2Fcompiler-flags%2Fsanitizer.md", "raw_url": "https://github.com/rust-lang/rust/raw/7e3c51d085d9eaa2204cc18763bc7d98b66435fd/src%2Fdoc%2Funstable-book%2Fsrc%2Fcompiler-flags%2Fsanitizer.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Fcompiler-flags%2Fsanitizer.md?ref=7e3c51d085d9eaa2204cc18763bc7d98b66435fd", "patch": "@@ -96,7 +96,7 @@ Shadow byte legend (one shadow byte represents 8 application bytes):\n ## MemorySanitizer\n \n Use of uninitialized memory. Note that we are using `-Zbuild-std` to instrument\n-standard library, and passing `-msan-track-origins=2` to the LLVM to track\n+the standard library, and passing `-Zsanitizer-track-origins` to track the\n origins of uninitialized memory:\n \n ```shell\n@@ -111,7 +111,15 @@ fn main() {\n     }\n }\n \n-$ env RUSTFLAGS=\"-Zsanitizer=memory -Cllvm-args=-msan-track-origins=2\" cargo -Zbuild-std run --target x86_64-unknown-linux-gnu\n+$ export \\\n+  CC=clang \\\n+  CXX=clang++ \\\n+  CFLAGS='-fsanitize=memory -fsanitize-memory-track-origins' \\\n+  CXXFLAGS='-fsanitize=memory -fsanitize-memory-track-origins' \\\n+  RUSTFLAGS='-Zsanitizer=memory -Zsanitizer-memory-track-origins' \\\n+  RUSTDOCFLAGS='-Zsanitizer=memory -Zsanitizer-memory-track-origins'\n+$ cargo clean\n+$ cargo -Zbuild-std run --target x86_64-unknown-linux-gnu\n ==9416==WARNING: MemorySanitizer: use-of-uninitialized-value\n     #0 0x560c04f7488a in core::fmt::num::imp::fmt_u64::haa293b0b098501ca $RUST/build/x86_64-unknown-linux-gnu/stage1/lib/rustlib/src/rust/src/libcore/fmt/num.rs:202:16\n ..."}]}