{"sha": "4d079a8dd299f4cba1eb04cda67ace0bb6172457", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRkMDc5YThkZDI5OWY0Y2JhMWViMDRjZGE2N2FjZTBiYjYxNzI0NTc=", "commit": {"author": {"name": "Dylan DPC", "email": "dylan.dpc@gmail.com", "date": "2020-03-27T14:09:57Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-03-27T14:09:57Z"}, "message": "Rollup merge of #70068 - jclulow:illumos-gcc, r=cramertj\n\nuse \"gcc\" instead of \"cc\" on *-sun-solaris systems when linking\n\nOn illumos and Solaris systems, Rust will use GCC as the link editor.\nRust does this by invoking \"cc\", which on many (Linux and perhaps BSD)\nsystems is generally either GCC or a GCC-compatible front-end.  On\nhistorical Solaris systems, \"cc\" was often the Sun Studio compiler.\nThis history casts a long shadow, and as such, even most modern\nillumos-based operating systems tend to install GCC as \"gcc\", without\nalso making it available as \"cc\".\n\nWe should invoke GCC as \"gcc\" on such systems to ensure we get the right\ncompiler driver.", "tree": {"sha": "2a8a68eab43e4fa2f8914fbab0b2cb7aab2c2dee", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2a8a68eab43e4fa2f8914fbab0b2cb7aab2c2dee"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4d079a8dd299f4cba1eb04cda67ace0bb6172457", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJefgk1CRBK7hj4Ov3rIwAAdHIIAFsoT3eKcwawHxGEY7edoK/S\n2AzWnh8GZQ+S5Vfxi2mIomucD7tDFvZPOncISvBYGTnO3ZqDNzdqRT7nbvsslhBC\nIvGsfZj2tD4vX1LDT/N6f6wvxwrarHu+IC2xDfMk1yq4YEqqxY8mhVSVnny9EGOh\nFnNPLDdnqPfngTs+a4NBfn+Vl9gV4+36COL3iwuMH0Z0X6a2MRdPJnRSOeF0orMY\n5VvlDe0lCuU1vWzJpJOR2DksYlO6EmT81x7oXZ6abP1UYG18Ed00X3u3tohUob2e\ngsExKo+luPVNqtOM0xXW8EqXhH07TgLwfu2RXkOvUG6mme2MwWwdrozz0xv2TwA=\n=iO4i\n-----END PGP SIGNATURE-----\n", "payload": "tree 2a8a68eab43e4fa2f8914fbab0b2cb7aab2c2dee\nparent 6b6c470beeae7792d0e9e7a2bbe4663a25c999c6\nparent 1c191c304aa5629e31c93bec395fe4255ecca9ce\nauthor Dylan DPC <dylan.dpc@gmail.com> 1585318197 +0100\ncommitter GitHub <noreply@github.com> 1585318197 +0100\n\nRollup merge of #70068 - jclulow:illumos-gcc, r=cramertj\n\nuse \"gcc\" instead of \"cc\" on *-sun-solaris systems when linking\n\nOn illumos and Solaris systems, Rust will use GCC as the link editor.\nRust does this by invoking \"cc\", which on many (Linux and perhaps BSD)\nsystems is generally either GCC or a GCC-compatible front-end.  On\nhistorical Solaris systems, \"cc\" was often the Sun Studio compiler.\nThis history casts a long shadow, and as such, even most modern\nillumos-based operating systems tend to install GCC as \"gcc\", without\nalso making it available as \"cc\".\n\nWe should invoke GCC as \"gcc\" on such systems to ensure we get the right\ncompiler driver.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4d079a8dd299f4cba1eb04cda67ace0bb6172457", "html_url": "https://github.com/rust-lang/rust/commit/4d079a8dd299f4cba1eb04cda67ace0bb6172457", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4d079a8dd299f4cba1eb04cda67ace0bb6172457/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6b6c470beeae7792d0e9e7a2bbe4663a25c999c6", "url": "https://api.github.com/repos/rust-lang/rust/commits/6b6c470beeae7792d0e9e7a2bbe4663a25c999c6", "html_url": "https://github.com/rust-lang/rust/commit/6b6c470beeae7792d0e9e7a2bbe4663a25c999c6"}, {"sha": "1c191c304aa5629e31c93bec395fe4255ecca9ce", "url": "https://api.github.com/repos/rust-lang/rust/commits/1c191c304aa5629e31c93bec395fe4255ecca9ce", "html_url": "https://github.com/rust-lang/rust/commit/1c191c304aa5629e31c93bec395fe4255ecca9ce"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "1fb08a058034dddbf135b735097e9f7fc45864bd", "filename": "src/librustc_codegen_ssa/back/link.rs", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/4d079a8dd299f4cba1eb04cda67ace0bb6172457/src%2Flibrustc_codegen_ssa%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4d079a8dd299f4cba1eb04cda67ace0bb6172457/src%2Flibrustc_codegen_ssa%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Fback%2Flink.rs?ref=4d079a8dd299f4cba1eb04cda67ace0bb6172457", "patch": "@@ -838,7 +838,19 @@ pub fn linker_and_flavor(sess: &Session) -> (PathBuf, LinkerFlavor) {\n                             \"emcc\"\n                         }\n                     }\n-                    LinkerFlavor::Gcc => \"cc\",\n+                    LinkerFlavor::Gcc => {\n+                        if cfg!(target_os = \"solaris\") {\n+                            // On historical Solaris systems, \"cc\" may have\n+                            // been Sun Studio, which is not flag-compatible\n+                            // with \"gcc\".  This history casts a long shadow,\n+                            // and many modern illumos distributions today\n+                            // ship GCC as \"gcc\" without also making it\n+                            // available as \"cc\".\n+                            \"gcc\"\n+                        } else {\n+                            \"cc\"\n+                        }\n+                    }\n                     LinkerFlavor::Ld => \"ld\",\n                     LinkerFlavor::Msvc => \"link.exe\",\n                     LinkerFlavor::Lld(_) => \"lld\","}]}