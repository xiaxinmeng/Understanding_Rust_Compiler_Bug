{"sha": "7d81c80c65f8ed8f06d703b9d0635c8af521ea76", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdkODFjODBjNjVmOGVkOGYwNmQ3MDNiOWQwNjM1YzhhZjUyMWVhNzY=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-05-14T00:40:46Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-05-14T00:40:46Z"}, "message": "auto merge of #6388 : recrack/rust/each2_mut, r=pcwalton\n\n- vec.rs :add 'each2_mut function'\r\n- testsuit : run-pass/vec-each2_mut.rs", "tree": {"sha": "01917c8253a9eefd68982bfa6bcf402e54789cef", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/01917c8253a9eefd68982bfa6bcf402e54789cef"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7d81c80c65f8ed8f06d703b9d0635c8af521ea76", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7d81c80c65f8ed8f06d703b9d0635c8af521ea76", "html_url": "https://github.com/rust-lang/rust/commit/7d81c80c65f8ed8f06d703b9d0635c8af521ea76", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7d81c80c65f8ed8f06d703b9d0635c8af521ea76/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ad5bfd600d1611c9d1bb933a383d0db2fa0ee7bf", "url": "https://api.github.com/repos/rust-lang/rust/commits/ad5bfd600d1611c9d1bb933a383d0db2fa0ee7bf", "html_url": "https://github.com/rust-lang/rust/commit/ad5bfd600d1611c9d1bb933a383d0db2fa0ee7bf"}, {"sha": "1d1c502dd4727401865258fe60b4f858947c40a0", "url": "https://api.github.com/repos/rust-lang/rust/commits/1d1c502dd4727401865258fe60b4f858947c40a0", "html_url": "https://github.com/rust-lang/rust/commit/1d1c502dd4727401865258fe60b4f858947c40a0"}], "stats": {"total": 71, "additions": 69, "deletions": 2}, "files": [{"sha": "21c3dac16f616f2b4104a83c17981cedd93ea90d", "filename": "src/libcore/vec.rs", "status": "modified", "additions": 31, "deletions": 2, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/7d81c80c65f8ed8f06d703b9d0635c8af521ea76/src%2Flibcore%2Fvec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7d81c80c65f8ed8f06d703b9d0635c8af521ea76/src%2Flibcore%2Fvec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fvec.rs?ref=7d81c80c65f8ed8f06d703b9d0635c8af521ea76", "patch": "@@ -1681,8 +1681,8 @@ pub fn eachi_reverse<'r,T>(v: &'r [T],\n  */\n #[inline]\n pub fn _each2<U, T>(v1: &[U], v2: &[T], f: &fn(u: &U, t: &T) -> bool) -> bool {\n-    assert!(len(v1) == len(v2));\n-    for uint::range(0u, len(v1)) |i| {\n+    assert!(v1.len() == v2.len());\n+    for uint::range(0u, v1.len()) |i| {\n         if !f(&v1[i], &v2[i]) {\n             return false;\n         }\n@@ -1699,6 +1699,35 @@ pub fn each2<U, T>(v1: &[U], v2: &[T], f: &fn(u: &U, t: &T) -> bool) -> bool {\n     _each2(v1, v2, f)\n }\n \n+/**\n+ *\n+ * Iterates over two vector with mutable.\n+ *\n+ * # Failure\n+ *\n+ * Both vectors must have the same length\n+ */\n+#[inline]\n+pub fn _each2_mut<U, T>(v1: &mut [U], v2: &mut [T], f: &fn(u: &mut U, t: &mut T) -> bool) -> bool {\n+    assert!(v1.len() == v2.len());\n+    for uint::range(0u, v1.len()) |i| {\n+        if !f(&mut v1[i], &mut v2[i]) {\n+            return false;\n+        }\n+    }\n+    return true;\n+}\n+\n+#[cfg(stage0)]\n+pub fn each2_mut<U, T>(v1: &mut [U], v2: &mut [T], f: &fn(u: &mut U, t: &mut T) -> bool) {\n+    _each2_mut(v1, v2, f);\n+}\n+\n+#[cfg(not(stage0))]\n+pub fn each2_mut<U, T>(v1: &mut [U], v2: &mut [T], f: &fn(u: &mut U, t: &mut T) -> bool) -> bool {\n+    _each2_mut(v1, v2, f)\n+}\n+\n /**\n  * Iterate over all permutations of vector `v`.\n  *"}, {"sha": "3c6b7da9f1478aaff2d3a9f750d64490ace0ad85", "filename": "src/test/run-pass/vec-each2_mut.rs", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/7d81c80c65f8ed8f06d703b9d0635c8af521ea76/src%2Ftest%2Frun-pass%2Fvec-each2_mut.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7d81c80c65f8ed8f06d703b9d0635c8af521ea76/src%2Ftest%2Frun-pass%2Fvec-each2_mut.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fvec-each2_mut.rs?ref=7d81c80c65f8ed8f06d703b9d0635c8af521ea76", "patch": "@@ -0,0 +1,38 @@\n+// Copyright 2012 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// -*- rust -*-\n+fn main(){\n+    let mut t1 = ~[];\n+    t1.push('a');\n+\n+    let mut t2 = ~[];\n+    t2.push('b');\n+\n+    for vec::each2_mut(t1, t2) | i1, i2 | {\n+        assert!(*i1 == 'a');\n+        assert!(*i2 == 'b');\n+    }\n+\n+    for vec::each2(t1, t2) | i1, i2 | {\n+        io::println(fmt!(\"after t1: %?, t2: %?\", i1, i2));\n+    }\n+\n+    for vec::each2_mut(t1, t2) | i1, i2 | {\n+        *i1 = 'b';\n+        *i2 = 'a';\n+        assert!(*i1 == 'b');\n+        assert!(*i2 == 'a');\n+    }\n+\n+    for vec::each2(t1, t2) | i1, i2 | {\n+        io::println(fmt!(\"before t1: %?, t2: %?\", i1, i2));\n+    }\n+}"}]}