{"sha": "79666c8857870ed8c16de932781ad50624e1accb", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc5NjY2Yzg4NTc4NzBlZDhjMTZkZTkzMjc4MWFkNTA2MjRlMWFjY2I=", "commit": {"author": {"name": "Ali\u00e9nore Bouttefeux", "email": "alienore.bouttefeux@gmail.com", "date": "2021-04-09T14:13:04Z"}, "committer": {"name": "Ali\u00e9nore Bouttefeux", "email": "alienore.bouttefeux@gmail.com", "date": "2021-04-09T14:13:04Z"}, "message": "changes based on review", "tree": {"sha": "3433c9857d1da75d806ee664c01062ff9024bc1e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3433c9857d1da75d806ee664c01062ff9024bc1e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/79666c8857870ed8c16de932781ad50624e1accb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/79666c8857870ed8c16de932781ad50624e1accb", "html_url": "https://github.com/rust-lang/rust/commit/79666c8857870ed8c16de932781ad50624e1accb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/79666c8857870ed8c16de932781ad50624e1accb/comments", "author": {"login": "ABouttefeux", "id": 77335613, "node_id": "MDQ6VXNlcjc3MzM1NjEz", "avatar_url": "https://avatars.githubusercontent.com/u/77335613?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ABouttefeux", "html_url": "https://github.com/ABouttefeux", "followers_url": "https://api.github.com/users/ABouttefeux/followers", "following_url": "https://api.github.com/users/ABouttefeux/following{/other_user}", "gists_url": "https://api.github.com/users/ABouttefeux/gists{/gist_id}", "starred_url": "https://api.github.com/users/ABouttefeux/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ABouttefeux/subscriptions", "organizations_url": "https://api.github.com/users/ABouttefeux/orgs", "repos_url": "https://api.github.com/users/ABouttefeux/repos", "events_url": "https://api.github.com/users/ABouttefeux/events{/privacy}", "received_events_url": "https://api.github.com/users/ABouttefeux/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ABouttefeux", "id": 77335613, "node_id": "MDQ6VXNlcjc3MzM1NjEz", "avatar_url": "https://avatars.githubusercontent.com/u/77335613?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ABouttefeux", "html_url": "https://github.com/ABouttefeux", "followers_url": "https://api.github.com/users/ABouttefeux/followers", "following_url": "https://api.github.com/users/ABouttefeux/following{/other_user}", "gists_url": "https://api.github.com/users/ABouttefeux/gists{/gist_id}", "starred_url": "https://api.github.com/users/ABouttefeux/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ABouttefeux/subscriptions", "organizations_url": "https://api.github.com/users/ABouttefeux/orgs", "repos_url": "https://api.github.com/users/ABouttefeux/repos", "events_url": "https://api.github.com/users/ABouttefeux/events{/privacy}", "received_events_url": "https://api.github.com/users/ABouttefeux/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0531ed0b6220257d7c79405ca7d81d9fe66976be", "url": "https://api.github.com/repos/rust-lang/rust/commits/0531ed0b6220257d7c79405ca7d81d9fe66976be", "html_url": "https://github.com/rust-lang/rust/commit/0531ed0b6220257d7c79405ca7d81d9fe66976be"}], "stats": {"total": 100, "additions": 34, "deletions": 66}, "files": [{"sha": "f19572550ebd06ca5d4ed154e4d7da1a7479673c", "filename": "compiler/rustc_lint/src/builtin.rs", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/79666c8857870ed8c16de932781ad50624e1accb/compiler%2Frustc_lint%2Fsrc%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/79666c8857870ed8c16de932781ad50624e1accb/compiler%2Frustc_lint%2Fsrc%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Fbuiltin.rs?ref=79666c8857870ed8c16de932781ad50624e1accb", "patch": "@@ -2972,10 +2972,10 @@ declare_lint! {\n     ///\n     /// ```rust,no_run\n     /// # #![allow(unused)]\n+    /// use std::ptr;\n     /// unsafe {\n-    ///     let x = &*core::ptr::null::<i32>();\n-    ///     let x = core::ptr::addr_of!(*std::ptr::null::<i32>());\n-    ///     let x = *core::ptr::null::<i32>();\n+    ///     let x = &*ptr::null::<i32>();\n+    ///     let x = ptr::addr_of!(*ptr::null::<i32>());\n     ///     let x = *(0 as *const i32);\n     /// }\n     /// ```\n@@ -3036,9 +3036,7 @@ impl<'tcx> LateLintPass<'tcx> for DerefNullPtr {\n             if let rustc_hir::UnOp::Deref = un_op {\n                 if is_null_ptr(cx, expr_deref) {\n                     cx.struct_span_lint(DEREF_NULLPTR, expr.span, |lint| {\n-                        let mut err =\n-                            lint.build(\"Dereferencing a null pointer causes undefined behavior\");\n-                        err.span_label(expr.span, \"a null pointer is dereferenced\");\n+                        let mut err = lint.build(\"dereferencing a null pointer\");\n                         err.span_label(\n                             expr.span,\n                             \"this code causes undefined behavior when executed\","}, {"sha": "a5aee73514031e885b68fa36481d05ce1993adff", "filename": "src/test/ui/lint/lint-deref-nullptr.rs", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/79666c8857870ed8c16de932781ad50624e1accb/src%2Ftest%2Fui%2Flint%2Flint-deref-nullptr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/79666c8857870ed8c16de932781ad50624e1accb/src%2Ftest%2Fui%2Flint%2Flint-deref-nullptr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-deref-nullptr.rs?ref=79666c8857870ed8c16de932781ad50624e1accb", "patch": "@@ -7,25 +7,25 @@ fn f() {\n         let a = 1;\n         let ub = *(a as *const i32);\n         let ub = *(0 as *const i32);\n-        //~^ ERROR Dereferencing a null pointer causes undefined behavior\n+        //~^ ERROR dereferencing a null pointer\n         let ub = *core::ptr::null::<i32>();\n-        //~^ ERROR Dereferencing a null pointer causes undefined behavior\n+        //~^ ERROR dereferencing a null pointer\n         let ub = *core::ptr::null_mut::<i32>();\n-        //~^ ERROR Dereferencing a null pointer causes undefined behavior\n+        //~^ ERROR dereferencing a null pointer\n         let ub = *(core::ptr::null::<i16>() as *const i32);\n-        //~^ ERROR Dereferencing a null pointer causes undefined behavior\n+        //~^ ERROR dereferencing a null pointer\n         let ub = *(core::ptr::null::<i16>() as *mut i32 as *mut usize as *const u8);\n-        //~^ ERROR Dereferencing a null pointer causes undefined behavior\n+        //~^ ERROR dereferencing a null pointer\n         let ub = &*core::ptr::null::<i32>();\n-        //~^ ERROR Dereferencing a null pointer causes undefined behavior\n+        //~^ ERROR dereferencing a null pointer\n         core::ptr::addr_of!(*core::ptr::null::<i32>());\n-        //~^ ERROR Dereferencing a null pointer causes undefined behavior\n+        //~^ ERROR dereferencing a null pointer\n         std::ptr::addr_of_mut!(*core::ptr::null_mut::<i32>());\n-        //~^ ERROR Dereferencing a null pointer causes undefined behavior\n+        //~^ ERROR dereferencing a null pointer\n         let ub = *std::ptr::null::<i32>();\n-        //~^ ERROR Dereferencing a null pointer causes undefined behavior\n+        //~^ ERROR dereferencing a null pointer\n         let ub = *std::ptr::null_mut::<i32>();\n-        //~^ ERROR Dereferencing a null pointer causes undefined behavior\n+        //~^ ERROR dereferencing a null pointer\n     }\n }\n "}, {"sha": "ba27d2c45fcc7747f22b8be88625ac4e42b32c35", "filename": "src/test/ui/lint/lint-deref-nullptr.stderr", "status": "modified", "additions": 20, "deletions": 50, "changes": 70, "blob_url": "https://github.com/rust-lang/rust/blob/79666c8857870ed8c16de932781ad50624e1accb/src%2Ftest%2Fui%2Flint%2Flint-deref-nullptr.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/79666c8857870ed8c16de932781ad50624e1accb/src%2Ftest%2Fui%2Flint%2Flint-deref-nullptr.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-deref-nullptr.stderr?ref=79666c8857870ed8c16de932781ad50624e1accb", "patch": "@@ -1,98 +1,68 @@\n-error: Dereferencing a null pointer causes undefined behavior\n+error: dereferencing a null pointer\n   --> $DIR/lint-deref-nullptr.rs:9:18\n    |\n LL |         let ub = *(0 as *const i32);\n-   |                  ^^^^^^^^^^^^^^^^^^\n-   |                  |\n-   |                  a null pointer is dereferenced\n-   |                  this code causes undefined behavior when executed\n+   |                  ^^^^^^^^^^^^^^^^^^ this code causes undefined behavior when executed\n    |\n note: the lint level is defined here\n   --> $DIR/lint-deref-nullptr.rs:3:9\n    |\n LL | #![deny(deref_nullptr)]\n    |         ^^^^^^^^^^^^^\n \n-error: Dereferencing a null pointer causes undefined behavior\n+error: dereferencing a null pointer\n   --> $DIR/lint-deref-nullptr.rs:11:18\n    |\n LL |         let ub = *core::ptr::null::<i32>();\n-   |                  ^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |                  |\n-   |                  a null pointer is dereferenced\n-   |                  this code causes undefined behavior when executed\n+   |                  ^^^^^^^^^^^^^^^^^^^^^^^^^ this code causes undefined behavior when executed\n \n-error: Dereferencing a null pointer causes undefined behavior\n+error: dereferencing a null pointer\n   --> $DIR/lint-deref-nullptr.rs:13:18\n    |\n LL |         let ub = *core::ptr::null_mut::<i32>();\n-   |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |                  |\n-   |                  a null pointer is dereferenced\n-   |                  this code causes undefined behavior when executed\n+   |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ this code causes undefined behavior when executed\n \n-error: Dereferencing a null pointer causes undefined behavior\n+error: dereferencing a null pointer\n   --> $DIR/lint-deref-nullptr.rs:15:18\n    |\n LL |         let ub = *(core::ptr::null::<i16>() as *const i32);\n-   |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |                  |\n-   |                  a null pointer is dereferenced\n-   |                  this code causes undefined behavior when executed\n+   |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ this code causes undefined behavior when executed\n \n-error: Dereferencing a null pointer causes undefined behavior\n+error: dereferencing a null pointer\n   --> $DIR/lint-deref-nullptr.rs:17:18\n    |\n LL |         let ub = *(core::ptr::null::<i16>() as *mut i32 as *mut usize as *const u8);\n-   |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |                  |\n-   |                  a null pointer is dereferenced\n-   |                  this code causes undefined behavior when executed\n+   |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ this code causes undefined behavior when executed\n \n-error: Dereferencing a null pointer causes undefined behavior\n+error: dereferencing a null pointer\n   --> $DIR/lint-deref-nullptr.rs:19:19\n    |\n LL |         let ub = &*core::ptr::null::<i32>();\n-   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |                   |\n-   |                   a null pointer is dereferenced\n-   |                   this code causes undefined behavior when executed\n+   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^ this code causes undefined behavior when executed\n \n-error: Dereferencing a null pointer causes undefined behavior\n+error: dereferencing a null pointer\n   --> $DIR/lint-deref-nullptr.rs:21:29\n    |\n LL |         core::ptr::addr_of!(*core::ptr::null::<i32>());\n-   |                             ^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |                             |\n-   |                             a null pointer is dereferenced\n-   |                             this code causes undefined behavior when executed\n+   |                             ^^^^^^^^^^^^^^^^^^^^^^^^^ this code causes undefined behavior when executed\n \n-error: Dereferencing a null pointer causes undefined behavior\n+error: dereferencing a null pointer\n   --> $DIR/lint-deref-nullptr.rs:23:32\n    |\n LL |         std::ptr::addr_of_mut!(*core::ptr::null_mut::<i32>());\n-   |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |                                |\n-   |                                a null pointer is dereferenced\n-   |                                this code causes undefined behavior when executed\n+   |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ this code causes undefined behavior when executed\n \n-error: Dereferencing a null pointer causes undefined behavior\n+error: dereferencing a null pointer\n   --> $DIR/lint-deref-nullptr.rs:25:18\n    |\n LL |         let ub = *std::ptr::null::<i32>();\n-   |                  ^^^^^^^^^^^^^^^^^^^^^^^^\n-   |                  |\n-   |                  a null pointer is dereferenced\n-   |                  this code causes undefined behavior when executed\n+   |                  ^^^^^^^^^^^^^^^^^^^^^^^^ this code causes undefined behavior when executed\n \n-error: Dereferencing a null pointer causes undefined behavior\n+error: dereferencing a null pointer\n   --> $DIR/lint-deref-nullptr.rs:27:18\n    |\n LL |         let ub = *std::ptr::null_mut::<i32>();\n-   |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |                  |\n-   |                  a null pointer is dereferenced\n-   |                  this code causes undefined behavior when executed\n+   |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ this code causes undefined behavior when executed\n \n error: aborting due to 10 previous errors\n "}]}