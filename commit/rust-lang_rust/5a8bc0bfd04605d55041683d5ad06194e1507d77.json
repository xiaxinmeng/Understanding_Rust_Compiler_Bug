{"sha": "5a8bc0bfd04605d55041683d5ad06194e1507d77", "node_id": "C_kwDOAAsO6NoAKDVhOGJjMGJmZDA0NjA1ZDU1MDQxNjgzZDVhZDA2MTk0ZTE1MDdkNzc", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-11-18T13:13:38Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-11-18T13:13:38Z"}, "message": "Rollup merge of #104494 - GuillaumeGomez:migrate-gui-test-to-func, r=notriddle\n\nMigrate GUI test to use functions\n\nr? `@notriddle`", "tree": {"sha": "2da47da9dc59914928e11a78efd877d061897f5e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2da47da9dc59914928e11a78efd877d061897f5e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5a8bc0bfd04605d55041683d5ad06194e1507d77", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjd4UCCRBK7hj4Ov3rIwAACkQIAF/Q5WSCqWXFI5ZS6ct+Dq5O\n4Vl0pj/uEAaAapTvmNzKaxfbXvVIwCAP7N1Ed+A4aopwWwmy0eMRBhUV3GLOBUQ/\nZvJHcef8KCiW2bfNDFkb8Kmm9Zb/9y0E/YhKoDJ0Tvm6Qf20PZ2R2bEQ9Ljj9VLG\nuw5vxW7eFKwzJcsNqTRMK9ZeOaR1axXOnizFKeXYtVE1mXKBJ965oPrsx7C6StKV\nHmQlqaklulJ2mrRhFuhPCvIOEQ/NpaNnuqnZSqizSO25mrzVyxuTx30LMpLB17sj\ncodB+AIoFbwyu4X3lrhu7BKwGluNcBV8PMvQ6ssuB5YBbL4C9v/ldSXd9h293XU=\n=gZ/K\n-----END PGP SIGNATURE-----\n", "payload": "tree 2da47da9dc59914928e11a78efd877d061897f5e\nparent 2ea012619ef6ac8782b57af57ca5f7e0f1fc4c84\nparent 23e5fa164e7be9662024aa60d0c34277b02e5c0a\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1668777218 +0100\ncommitter GitHub <noreply@github.com> 1668777218 +0100\n\nRollup merge of #104494 - GuillaumeGomez:migrate-gui-test-to-func, r=notriddle\n\nMigrate GUI test to use functions\n\nr? `@notriddle`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5a8bc0bfd04605d55041683d5ad06194e1507d77", "html_url": "https://github.com/rust-lang/rust/commit/5a8bc0bfd04605d55041683d5ad06194e1507d77", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5a8bc0bfd04605d55041683d5ad06194e1507d77/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2ea012619ef6ac8782b57af57ca5f7e0f1fc4c84", "url": "https://api.github.com/repos/rust-lang/rust/commits/2ea012619ef6ac8782b57af57ca5f7e0f1fc4c84", "html_url": "https://github.com/rust-lang/rust/commit/2ea012619ef6ac8782b57af57ca5f7e0f1fc4c84"}, {"sha": "23e5fa164e7be9662024aa60d0c34277b02e5c0a", "url": "https://api.github.com/repos/rust-lang/rust/commits/23e5fa164e7be9662024aa60d0c34277b02e5c0a", "html_url": "https://github.com/rust-lang/rust/commit/23e5fa164e7be9662024aa60d0c34277b02e5c0a"}], "stats": {"total": 249, "additions": 87, "deletions": 162}, "files": [{"sha": "abf8af77715c9eec5da0306c825e479abcf5db59", "filename": "src/test/rustdoc-gui/sidebar-source-code-display.goml", "status": "modified", "additions": 87, "deletions": 162, "changes": 249, "blob_url": "https://github.com/rust-lang/rust/blob/5a8bc0bfd04605d55041683d5ad06194e1507d77/src%2Ftest%2Frustdoc-gui%2Fsidebar-source-code-display.goml", "raw_url": "https://github.com/rust-lang/rust/raw/5a8bc0bfd04605d55041683d5ad06194e1507d77/src%2Ftest%2Frustdoc-gui%2Fsidebar-source-code-display.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsidebar-source-code-display.goml?ref=5a8bc0bfd04605d55041683d5ad06194e1507d77", "patch": "@@ -29,170 +29,95 @@ assert-local-storage: {\"rustdoc-source-sidebar-show\": \"true\"}\n // Now we check the display of the sidebar items.\n show-text: true\n \n-// First we start with the light theme.\n-local-storage: {\"rustdoc-theme\": \"light\", \"rustdoc-use-system-theme\": \"false\"}\n-reload:\n-// Waiting for the sidebar to be displayed...\n-wait-for-css: (\"#sidebar-toggle\", {\"visibility\": \"visible\"})\n-assert-css: (\n-    \"#source-sidebar details[open] > .files a.selected\",\n-    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(255, 255, 255)\"},\n-)\n-// Without hover or focus.\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgba(0, 0, 0, 0)\"})\n-// With focus.\n-focus: \"#sidebar-toggle > button\"\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgb(224, 224, 224)\"})\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#sidebar-toggle > button\"\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgb(224, 224, 224)\"})\n-// Without hover.\n-assert-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n-)\n-// With focus.\n-focus: \"#source-sidebar details[open] > .files a:not(.selected)\"\n-wait-for-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(224, 224, 224)\"},\n-)\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#source-sidebar details[open] > .files a:not(.selected)\"\n-assert-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(224, 224, 224)\"},\n-)\n-// Without hover.\n-assert-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n-)\n-// With focus.\n-focus: \"#source-sidebar details[open] > .folders > details > summary\"\n-wait-for-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(224, 224, 224)\"},\n-)\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#source-sidebar details[open] > .folders > details > summary\"\n-assert-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(224, 224, 224)\"},\n+define-function: (\n+    \"check-colors\",\n+    (\n+        theme, color, color_hover, background, background_hover, background_toggle,\n+        background_toggle_hover,\n+    ),\n+    [\n+        (\"local-storage\", {\"rustdoc-theme\": |theme|, \"rustdoc-use-system-theme\": \"false\"}),\n+        (\"reload\"),\n+        (\"wait-for-css\", (\"#sidebar-toggle\", {\"visibility\": \"visible\"})),\n+        (\"assert-css\", (\n+            \"#source-sidebar details[open] > .files a.selected\",\n+            {\"color\": |color_hover|, \"background-color\": |background|},\n+        )),\n+        // Without hover or focus.\n+        (\"assert-css\", (\"#sidebar-toggle > button\", {\"background-color\": |background_toggle|})),\n+        // With focus.\n+        (\"focus\", \"#sidebar-toggle > button\"),\n+        (\"assert-css\", (\"#sidebar-toggle > button\", {\"background-color\": |background_toggle_hover|})),\n+        (\"focus\", \".search-input\"),\n+        // With hover.\n+        (\"move-cursor-to\", \"#sidebar-toggle > button\"),\n+        (\"assert-css\", (\"#sidebar-toggle > button\", {\"background-color\": |background_toggle_hover|})),\n+        // Without hover.\n+        (\"assert-css\", (\n+            \"#source-sidebar details[open] > .files a:not(.selected)\",\n+            {\"color\": |color|, \"background-color\": |background_toggle|},\n+        )),\n+        // With focus.\n+        (\"focus\", \"#source-sidebar details[open] > .files a:not(.selected)\"),\n+        (\"wait-for-css\", (\n+            \"#source-sidebar details[open] > .files a:not(.selected)\",\n+            {\"color\": |color_hover|, \"background-color\": |background_hover|},\n+        )),\n+        (\"focus\", \".search-input\"),\n+        // With hover.\n+        (\"move-cursor-to\", \"#source-sidebar details[open] > .files a:not(.selected)\"),\n+        (\"assert-css\", (\n+            \"#source-sidebar details[open] > .files a:not(.selected)\",\n+            {\"color\": |color_hover|, \"background-color\": |background_hover|},\n+        )),\n+        // Without hover.\n+        (\"assert-css\", (\n+            \"#source-sidebar details[open] > .folders > details > summary\",\n+            {\"color\": |color|, \"background-color\": |background_toggle|},\n+        )),\n+        // With focus.\n+        (\"focus\", \"#source-sidebar details[open] > .folders > details > summary\"),\n+        (\"wait-for-css\", (\n+            \"#source-sidebar details[open] > .folders > details > summary\",\n+            {\"color\": |color_hover|, \"background-color\": |background_hover|},\n+        )),\n+        (\"focus\", \".search-input\"),\n+        // With hover.\n+        (\"move-cursor-to\", \"#source-sidebar details[open] > .folders > details > summary\"),\n+        (\"assert-css\", (\n+            \"#source-sidebar details[open] > .folders > details > summary\",\n+            {\"color\": |color_hover|, \"background-color\": |background_hover|},\n+        )),\n+    ],\n )\n \n-// Now with the dark theme.\n-local-storage: {\"rustdoc-theme\": \"dark\", \"rustdoc-use-system-theme\": \"false\"}\n-reload:\n-// Waiting for the sidebar to be displayed...\n-wait-for-css: (\"#sidebar-toggle\", {\"visibility\": \"visible\"})\n-assert-css: (\n-    \"#source-sidebar details[open] > .files > a.selected\",\n-    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(51, 51, 51)\"},\n-)\n-// Without hover or focus.\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgba(0, 0, 0, 0)\"})\n-// With focus.\n-focus: \"#sidebar-toggle > button\"\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgb(103, 103, 103)\"})\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#sidebar-toggle > button\"\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgb(103, 103, 103)\"})\n-// Without hover.\n-assert-css: (\n-    \"#source-sidebar details[open] > .files > a:not(.selected)\",\n-    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n-)\n-// With focus.\n-focus: \"#source-sidebar details[open] > .files a:not(.selected)\"\n-wait-for-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(68, 68, 68)\"},\n-)\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#source-sidebar details[open] > .files a:not(.selected)\"\n-assert-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(68, 68, 68)\"},\n-)\n-// Without hover.\n-assert-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n-)\n-// With focus.\n-focus: \"#source-sidebar details[open] > .folders > details > summary\"\n-wait-for-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(68, 68, 68)\"},\n-)\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#source-sidebar details[open] > .folders > details > summary\"\n-assert-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(68, 68, 68)\"},\n-)\n-\n-// And finally with the ayu theme.\n-local-storage: {\"rustdoc-theme\": \"ayu\", \"rustdoc-use-system-theme\": \"false\"}\n-reload:\n-// Waiting for the sidebar to be displayed...\n-wait-for-css: (\"#sidebar-toggle\", {\"visibility\": \"visible\"})\n-assert-css: (\n-    \"#source-sidebar details[open] > .files a.selected\",\n-    {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n-)\n-// Without hover or focus.\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgba(0, 0, 0, 0)\"})\n-// With focus.\n-focus: \"#sidebar-toggle > button\"\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgba(70, 70, 70, 0.33)\"})\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#sidebar-toggle > button\"\n-assert-css: (\"#sidebar-toggle > button\", {\"background-color\": \"rgba(70, 70, 70, 0.33)\"})\n-// Without hover.\n-assert-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(197, 197, 197)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n-)\n-// With focus.\n-focus: \"#source-sidebar details[open] > .files a:not(.selected)\"\n-wait-for-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n-)\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#source-sidebar details[open] > .files a:not(.selected)\"\n-assert-css: (\n-    \"#source-sidebar details[open] > .files a:not(.selected)\",\n-    {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n-)\n-// Without hover.\n-assert-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(197, 197, 197)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n-)\n-// With focus.\n-focus: \"#source-sidebar details[open] > .folders > details > summary\"\n-wait-for-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n-)\n-focus: \".search-input\"\n-// With hover.\n-move-cursor-to: \"#source-sidebar details[open] > .folders > details > summary\"\n-assert-css: (\n-    \"#source-sidebar details[open] > .folders > details > summary\",\n-    {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n-)\n+call-function: (\"check-colors\", {\n+    \"theme\": \"light\",\n+    \"color\": \"rgb(0, 0, 0)\",\n+    \"color_hover\": \"rgb(0, 0, 0)\",\n+    \"background\": \"rgb(255, 255, 255)\",\n+    \"background_hover\": \"rgb(224, 224, 224)\",\n+    \"background_toggle\": \"rgba(0, 0, 0, 0)\",\n+    \"background_toggle_hover\": \"rgb(224, 224, 224)\",\n+})\n+call-function: (\"check-colors\", {\n+    \"theme\": \"dark\",\n+    \"color\": \"rgb(221, 221, 221)\",\n+    \"color_hover\": \"rgb(221, 221, 221)\",\n+    \"background\": \"rgb(51, 51, 51)\",\n+    \"background_hover\": \"rgb(68, 68, 68)\",\n+    \"background_toggle\": \"rgba(0, 0, 0, 0)\",\n+    \"background_toggle_hover\": \"rgb(103, 103, 103)\",\n+})\n+call-function: (\"check-colors\", {\n+    \"theme\": \"ayu\",\n+    \"color\": \"rgb(197, 197, 197)\",\n+    \"color_hover\": \"rgb(255, 180, 76)\",\n+    \"background\": \"rgb(20, 25, 31)\",\n+    \"background_hover\": \"rgb(20, 25, 31)\",\n+    \"background_toggle\": \"rgba(0, 0, 0, 0)\",\n+    \"background_toggle_hover\": \"rgba(70, 70, 70, 0.33)\",\n+})\n \n // Now checking on mobile devices.\n size: (500, 700)"}]}