{"sha": "a3d77e616bb8455e158c22a379b655437916d404", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEzZDc3ZTYxNmJiODQ1NWUxNThjMjJhMzc5YjY1NTQzNzkxNmQ0MDQ=", "commit": {"author": {"name": "klutzy", "email": "klutzytheklutzy@gmail.com", "date": "2014-08-22T16:45:15Z"}, "committer": {"name": "klutzy", "email": "klutzytheklutzy@gmail.com", "date": "2014-08-22T16:47:37Z"}, "message": "configure: Recognize i686 build on msys2", "tree": {"sha": "a7a0556b68fd9a2ae8a6517702778c702e6d13ad", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a7a0556b68fd9a2ae8a6517702778c702e6d13ad"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a3d77e616bb8455e158c22a379b655437916d404", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a3d77e616bb8455e158c22a379b655437916d404", "html_url": "https://github.com/rust-lang/rust/commit/a3d77e616bb8455e158c22a379b655437916d404", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a3d77e616bb8455e158c22a379b655437916d404/comments", "author": {"login": "klutzy", "id": 1589355, "node_id": "MDQ6VXNlcjE1ODkzNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1589355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klutzy", "html_url": "https://github.com/klutzy", "followers_url": "https://api.github.com/users/klutzy/followers", "following_url": "https://api.github.com/users/klutzy/following{/other_user}", "gists_url": "https://api.github.com/users/klutzy/gists{/gist_id}", "starred_url": "https://api.github.com/users/klutzy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klutzy/subscriptions", "organizations_url": "https://api.github.com/users/klutzy/orgs", "repos_url": "https://api.github.com/users/klutzy/repos", "events_url": "https://api.github.com/users/klutzy/events{/privacy}", "received_events_url": "https://api.github.com/users/klutzy/received_events", "type": "User", "site_admin": false}, "committer": {"login": "klutzy", "id": 1589355, "node_id": "MDQ6VXNlcjE1ODkzNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1589355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klutzy", "html_url": "https://github.com/klutzy", "followers_url": "https://api.github.com/users/klutzy/followers", "following_url": "https://api.github.com/users/klutzy/following{/other_user}", "gists_url": "https://api.github.com/users/klutzy/gists{/gist_id}", "starred_url": "https://api.github.com/users/klutzy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klutzy/subscriptions", "organizations_url": "https://api.github.com/users/klutzy/orgs", "repos_url": "https://api.github.com/users/klutzy/repos", "events_url": "https://api.github.com/users/klutzy/events{/privacy}", "received_events_url": "https://api.github.com/users/klutzy/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "19a44c73c246ad98f285aa801433beca674b1ad4", "url": "https://api.github.com/repos/rust-lang/rust/commits/19a44c73c246ad98f285aa801433beca674b1ad4", "html_url": "https://github.com/rust-lang/rust/commit/19a44c73c246ad98f285aa801433beca674b1ad4"}], "stats": {"total": 20, "additions": 13, "deletions": 7}, "files": [{"sha": "e919f3329fe2a4725976b4147cd4790455dec204", "filename": "README.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a3d77e616bb8455e158c22a379b655437916d404/README.md", "raw_url": "https://github.com/rust-lang/rust/raw/a3d77e616bb8455e158c22a379b655437916d404/README.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/README.md?ref=a3d77e616bb8455e158c22a379b655437916d404", "patch": "@@ -71,7 +71,7 @@ To easily build on windows we can use [MSYS2](http://sourceforge.net/projects/ms\n 3. With that now start `mingw32_shell.bat` from where you installed MSYS2 (i.e. `C:\\msys`).\n 4. From there just navigate to where you have Rust's source code, configure and build it:\n \n-        $ ./configure --build=i686-pc-mingw32\n+        $ ./configure\n         $ make && make install\n \n [repo]: https://github.com/rust-lang/rust"}, {"sha": "bb874809d8ee24ba596e495a3ab9d9d3ccdac1f2", "filename": "configure", "status": "modified", "additions": 12, "deletions": 6, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/a3d77e616bb8455e158c22a379b655437916d404/configure", "raw_url": "https://github.com/rust-lang/rust/raw/a3d77e616bb8455e158c22a379b655437916d404/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=a3d77e616bb8455e158c22a379b655437916d404", "patch": "@@ -299,13 +299,19 @@ case $CFG_OSTYPE in\n         CFG_OSTYPE=apple-darwin\n         ;;\n \n-    MINGW32*)\n+    MINGW*)\n+        # msys' `uname` does not print gcc configuration, but prints msys\n+        # configuration. so we cannot believe `uname -m`:\n+        # msys1 is always i686 and msys2 is always x86_64.\n+        # instead, msys defines $MSYSTEM which is MINGW32 on i686 and\n+        # MINGW64 on x86_64.\n+        CFG_CPUTYPE=i686\n         CFG_OSTYPE=pc-mingw32\n-        ;;\n-\n-    MINGW64*)\n-        # msys2, MSYSTEM=MINGW64\n-        CFG_OSTYPE=w64-mingw32\n+        if [ \"$MSYSTEM\" = MINGW64 ]\n+        then\n+            CFG_CPUTYPE=x86_64\n+            CFG_OSTYPE=w64-mingw32\n+        fi\n         ;;\n \n # Thad's Cygwin identifers below"}]}