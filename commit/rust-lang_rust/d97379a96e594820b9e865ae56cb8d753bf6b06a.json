{"sha": "d97379a96e594820b9e865ae56cb8d753bf6b06a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ5NzM3OWE5NmU1OTQ4MjBiOWU4NjVhZTU2Y2I4ZDc1M2JmNmIwNmE=", "commit": {"author": {"name": "Bart\u0142omiej Kuras", "email": "bartlomiej.kuras@o2.pl", "date": "2019-12-07T18:37:09Z"}, "committer": {"name": "Bart\u0142omiej Kuras", "email": "bartlomiej.kuras@o2.pl", "date": "2019-12-07T19:00:09Z"}, "message": "Added ExactSizeIterator bound to return types\nin librustc in several places", "tree": {"sha": "fb988ed7ce55301e63c2cc4f1ba2fbb5d47a2270", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fb988ed7ce55301e63c2cc4f1ba2fbb5d47a2270"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d97379a96e594820b9e865ae56cb8d753bf6b06a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d97379a96e594820b9e865ae56cb8d753bf6b06a", "html_url": "https://github.com/rust-lang/rust/commit/d97379a96e594820b9e865ae56cb8d753bf6b06a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d97379a96e594820b9e865ae56cb8d753bf6b06a/comments", "author": null, "committer": null, "parents": [{"sha": "d0126e8ed3cc0d6fcb9dd44c36a46f9ce65010a0", "url": "https://api.github.com/repos/rust-lang/rust/commits/d0126e8ed3cc0d6fcb9dd44c36a46f9ce65010a0", "html_url": "https://github.com/rust-lang/rust/commit/d0126e8ed3cc0d6fcb9dd44c36a46f9ce65010a0"}], "stats": {"total": 96, "additions": 61, "deletions": 35}, "files": [{"sha": "db955052cab77415af2ee21254786b4643a8ea61", "filename": "src/bootstrap/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Fbootstrap%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Fbootstrap%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Flib.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -1274,7 +1274,7 @@ impl Build {\n         t!(fs::remove_dir_all(dir))\n     }\n \n-    fn read_dir(&self, dir: &Path) -> impl Iterator<Item=fs::DirEntry> {\n+    fn read_dir(&self, dir: &Path) -> impl Iterator<Item=fs::DirEntry> + ExactSizeIterator {\n         let iter = match fs::read_dir(dir) {\n             Ok(v) => v,\n             Err(_) if self.config.dry_run => return vec![].into_iter(),"}, {"sha": "d9025bfe620e0cc6ea41eefebb919d003af9e101", "filename": "src/librustc/infer/canonical/query_response.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc%2Finfer%2Fcanonical%2Fquery_response.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc%2Finfer%2Fcanonical%2Fquery_response.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Finfer%2Fcanonical%2Fquery_response.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -574,7 +574,7 @@ impl<'cx, 'tcx> InferCtxt<'cx, 'tcx> {\n         param_env: ty::ParamEnv<'tcx>,\n         unsubstituted_region_constraints: &'a [QueryOutlivesConstraint<'tcx>],\n         result_subst: &'a CanonicalVarValues<'tcx>,\n-    ) -> impl Iterator<Item = PredicateObligation<'tcx>> + 'a + Captures<'tcx> {\n+    ) -> impl Iterator<Item = PredicateObligation<'tcx>> + ExactSizeIterator + 'a + Captures<'tcx> {\n         unsubstituted_region_constraints\n             .iter()\n             .map(move |constraint| {"}, {"sha": "d88cce0e18e1810c41ffc99a8ce3e7d6bdc5cc9a", "filename": "src/librustc/infer/outlives/free_region_map.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc%2Finfer%2Foutlives%2Ffree_region_map.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc%2Finfer%2Foutlives%2Ffree_region_map.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Finfer%2Foutlives%2Ffree_region_map.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -11,7 +11,7 @@ pub struct FreeRegionMap<'tcx> {\n }\n \n impl<'tcx> FreeRegionMap<'tcx> {\n-    pub fn elements(&self) -> impl Iterator<Item=&Region<'tcx>> {\n+    pub fn elements(&self) -> impl Iterator<Item=&Region<'tcx>> + ExactSizeIterator {\n         self.relation.elements()\n     }\n "}, {"sha": "0a6bdbf8b85eded15ee3d9024b30908613e1722e", "filename": "src/librustc/mir/mod.rs", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc%2Fmir%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc%2Fmir%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmir%2Fmod.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -282,15 +282,15 @@ impl<'tcx> Body<'tcx> {\n \n     /// Returns an iterator over all function arguments.\n     #[inline]\n-    pub fn args_iter(&self) -> impl Iterator<Item = Local> {\n+    pub fn args_iter(&self) -> impl Iterator<Item = Local> + ExactSizeIterator {\n         let arg_count = self.arg_count;\n-        (1..=arg_count).map(Local::new)\n+        (1..arg_count+1).map(Local::new)\n     }\n \n     /// Returns an iterator over all user-defined variables and compiler-generated temporaries (all\n     /// locals that are neither arguments nor the return place).\n     #[inline]\n-    pub fn vars_and_temps_iter(&self) -> impl Iterator<Item = Local> {\n+    pub fn vars_and_temps_iter(&self) -> impl Iterator<Item = Local> + ExactSizeIterator {\n         let arg_count = self.arg_count;\n         let local_count = self.local_decls.len();\n         (arg_count + 1..local_count).map(Local::new)\n@@ -2384,11 +2384,15 @@ impl<'tcx> UserTypeProjections {\n         UserTypeProjections { contents: projs.collect() }\n     }\n \n-    pub fn projections_and_spans(&self) -> impl Iterator<Item = &(UserTypeProjection, Span)> {\n+    pub fn projections_and_spans(&self)\n+        -> impl Iterator<Item = &(UserTypeProjection, Span)> + ExactSizeIterator\n+    {\n         self.contents.iter()\n     }\n \n-    pub fn projections(&self) -> impl Iterator<Item = &UserTypeProjection> {\n+    pub fn projections(&self)\n+        -> impl Iterator<Item = &UserTypeProjection> + ExactSizeIterator\n+    {\n         self.contents.iter().map(|&(ref user_type, _span)| user_type)\n     }\n "}, {"sha": "476dac07cf452763c14baf80b966e8ab0161893f", "filename": "src/librustc/traits/specialize/specialization_graph.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc%2Ftraits%2Fspecialize%2Fspecialization_graph.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc%2Ftraits%2Fspecialize%2Fspecialization_graph.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Fspecialize%2Fspecialization_graph.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -414,7 +414,9 @@ impl<'tcx> Node {\n     }\n \n     /// Iterate over the items defined directly by the given (impl or trait) node.\n-    pub fn items(&self, tcx: TyCtxt<'tcx>) -> ty::AssocItemsIterator<'tcx> {\n+    pub fn items(&self, tcx: TyCtxt<'tcx>)\n+        -> impl Iterator<Item = ty::AssocItem> + ExactSizeIterator + Clone + 'tcx\n+    {\n         tcx.associated_items(self.def_id())\n     }\n "}, {"sha": "ff84486c2f8e79e5059841a45afe5817afa7fcbe", "filename": "src/librustc/ty/mod.rs", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc%2Fty%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc%2Fty%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fmod.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -2376,7 +2376,7 @@ impl<'tcx> AdtDef {\n     pub fn discriminants(\n         &'tcx self,\n         tcx: TyCtxt<'tcx>,\n-    ) -> impl Iterator<Item = (VariantIdx, Discr<'tcx>)> + Captures<'tcx> {\n+    ) -> impl Iterator<Item = (VariantIdx, Discr<'tcx>)> + ExactSizeIterator + Captures<'tcx> {\n         let repr_type = self.repr.discr_type();\n         let initial = repr_type.initial_discriminant(tcx);\n         let mut prev_discr = None::<Discr<'tcx>>;\n@@ -2740,7 +2740,9 @@ impl<'tcx> TyCtxt<'tcx> {\n     /// Returns an iterator of the `DefId`s for all body-owners in this\n     /// crate. If you would prefer to iterate over the bodies\n     /// themselves, you can do `self.hir().krate().body_ids.iter()`.\n-    pub fn body_owners(self) -> impl Iterator<Item = DefId> + Captures<'tcx> + 'tcx {\n+    pub fn body_owners(self)\n+        -> impl Iterator<Item = DefId> + ExactSizeIterator + Captures<'tcx> + 'tcx\n+    {\n         self.hir().krate()\n                   .body_ids\n                   .iter()\n@@ -3116,6 +3118,12 @@ impl Iterator for AssocItemsIterator<'_> {\n     }\n }\n \n+impl ExactSizeIterator for AssocItemsIterator<'_> {\n+    fn len(&self) -> usize {\n+        self.def_ids.len() - self.next_index\n+    }\n+}\n+\n fn associated_item(tcx: TyCtxt<'_>, def_id: DefId) -> AssocItem {\n     let id = tcx.hir().as_local_hir_id(def_id).unwrap();\n     let parent_id = tcx.hir().get_parent_item(id);"}, {"sha": "70236ee2dbc63f4106536eed4068b7a503aa9e80", "filename": "src/librustc/ty/sty.rs", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc%2Fty%2Fsty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc%2Fty%2Fsty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fsty.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -345,7 +345,7 @@ impl<'tcx> ClosureSubsts<'tcx> {\n         self,\n         def_id: DefId,\n         tcx: TyCtxt<'_>,\n-    ) -> impl Iterator<Item = Ty<'tcx>> + 'tcx {\n+    ) -> impl Iterator<Item = Ty<'tcx>> + ExactSizeIterator + 'tcx {\n         let SplitClosureSubsts { upvar_kinds, .. } = self.split(def_id, tcx);\n         upvar_kinds.iter().map(|t| {\n             if let GenericArgKind::Type(ty) = t.unpack() {\n@@ -433,7 +433,7 @@ impl<'tcx> GeneratorSubsts<'tcx> {\n         self,\n         def_id: DefId,\n         tcx: TyCtxt<'_>,\n-    ) -> impl Iterator<Item = Ty<'tcx>> + 'tcx {\n+    ) -> impl Iterator<Item = Ty<'tcx>> + ExactSizeIterator + 'tcx {\n         let SplitGeneratorSubsts { upvar_kinds, .. } = self.split(def_id, tcx);\n         upvar_kinds.iter().map(|t| {\n             if let GenericArgKind::Type(ty) = t.unpack() {\n@@ -551,7 +551,7 @@ impl<'tcx> GeneratorSubsts<'tcx> {\n         self,\n         def_id: DefId,\n         tcx: TyCtxt<'tcx>,\n-    ) -> impl Iterator<Item = impl Iterator<Item = Ty<'tcx>> + Captures<'tcx>> {\n+    ) -> impl Iterator<Item = impl Iterator<Item = Ty<'tcx>> + ExactSizeIterator + Captures<'tcx>> {\n         let layout = tcx.generator_layout(def_id);\n         layout.variant_fields.iter().map(move |variant| {\n             variant.iter().map(move |field| {\n@@ -563,7 +563,9 @@ impl<'tcx> GeneratorSubsts<'tcx> {\n     /// This is the types of the fields of a generator which are not stored in a\n     /// variant.\n     #[inline]\n-    pub fn prefix_tys(self, def_id: DefId, tcx: TyCtxt<'tcx>) -> impl Iterator<Item = Ty<'tcx>> {\n+    pub fn prefix_tys(self, def_id: DefId, tcx: TyCtxt<'tcx>)\n+        -> impl Iterator<Item = Ty<'tcx>> + ExactSizeIterator\n+    {\n         self.upvar_tys(def_id, tcx)\n     }\n }\n@@ -580,7 +582,7 @@ impl<'tcx> UpvarSubsts<'tcx> {\n         self,\n         def_id: DefId,\n         tcx: TyCtxt<'tcx>,\n-    ) -> impl Iterator<Item = Ty<'tcx>> + 'tcx {\n+    ) -> impl Iterator<Item = Ty<'tcx>> + ExactSizeIterator + 'tcx {\n         let upvar_kinds = match self {\n             UpvarSubsts::Closure(substs) => substs.as_closure().split(def_id, tcx).upvar_kinds,\n             UpvarSubsts::Generator(substs) => substs.as_generator().split(def_id, tcx).upvar_kinds,"}, {"sha": "2a341c594f1c2f0650cdb671380d2c29e56fc9f7", "filename": "src/librustc_data_structures/graph/implementation/mod.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_data_structures%2Fgraph%2Fimplementation%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_data_structures%2Fgraph%2Fimplementation%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_data_structures%2Fgraph%2Fimplementation%2Fmod.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -186,14 +186,18 @@ impl<N: Debug, E: Debug> Graph<N, E> {\n \n     // # Iterating over nodes, edges\n \n-    pub fn enumerated_nodes(&self) -> impl Iterator<Item = (NodeIndex, &Node<N>)> {\n+    pub fn enumerated_nodes(&self)\n+        -> impl Iterator<Item = (NodeIndex, &Node<N>)> + ExactSizeIterator\n+    {\n         self.nodes\n             .iter()\n             .enumerate()\n             .map(|(idx, n)| (NodeIndex(idx), n))\n     }\n \n-    pub fn enumerated_edges(&self) -> impl Iterator<Item = (EdgeIndex, &Edge<E>)> {\n+    pub fn enumerated_edges(&self)\n+        -> impl Iterator<Item = (EdgeIndex, &Edge<E>)> + ExactSizeIterator\n+    {\n         self.edges\n             .iter()\n             .enumerate()"}, {"sha": "8210dc6cb0b006bddb5d744e466a4c36c2b30211", "filename": "src/librustc_data_structures/transitive_relation.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_data_structures%2Ftransitive_relation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_data_structures%2Ftransitive_relation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_data_structures%2Ftransitive_relation.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -60,7 +60,7 @@ impl<T: Clone + Debug + Eq + Hash> TransitiveRelation<T> {\n         self.edges.is_empty()\n     }\n \n-    pub fn elements(&self) -> impl Iterator<Item=&T> {\n+    pub fn elements(&self) -> impl Iterator<Item=&T> + ExactSizeIterator {\n         self.elements.iter()\n     }\n "}, {"sha": "4619277a5dae41a5e1629570afc2d4a97d27f221", "filename": "src/librustc_incremental/persist/dirty_clean.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_incremental%2Fpersist%2Fdirty_clean.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_incremental%2Fpersist%2Fdirty_clean.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_incremental%2Fpersist%2Fdirty_clean.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -449,7 +449,7 @@ impl DirtyCleanVisitor<'tcx> {\n         &self,\n         labels: &'l Labels,\n         def_id: DefId\n-    ) -> impl Iterator<Item = DepNode> + 'l {\n+    ) -> impl Iterator<Item = DepNode> + ExactSizeIterator + 'l {\n         let def_path_hash = self.tcx.def_path_hash(def_id);\n         labels\n             .iter()"}, {"sha": "cc56aa2701f82cd1f0993f4f6ceaf88d7ea04335", "filename": "src/librustc_index/bit_set.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_index%2Fbit_set.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_index%2Fbit_set.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_index%2Fbit_set.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -748,7 +748,7 @@ impl<R: Idx, C: Idx> BitMatrix<R, C> {\n         }\n     }\n \n-    pub fn rows(&self) -> impl Iterator<Item = R> {\n+    pub fn rows(&self) -> impl Iterator<Item = R> + ExactSizeIterator {\n         (0..self.num_rows).map(R::new)\n     }\n \n@@ -975,7 +975,7 @@ impl<R: Idx, C: Idx> SparseBitMatrix<R, C> {\n         self.ensure_row(row).insert_all();\n     }\n \n-    pub fn rows(&self) -> impl Iterator<Item = R> {\n+    pub fn rows(&self) -> impl Iterator<Item = R> + ExactSizeIterator {\n         self.rows.indices()\n     }\n "}, {"sha": "84b460bf5717edd81f46305d1537cff5ee4f9e3e", "filename": "src/librustc_index/vec.rs", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_index%2Fvec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_index%2Fvec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_index%2Fvec.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -633,14 +633,16 @@ impl<I: Idx, T> IndexVec<I, T> {\n     }\n \n     #[inline]\n-    pub fn drain<'a, R: RangeBounds<usize>>(\n-        &'a mut self, range: R) -> impl Iterator<Item=T> + 'a {\n+    pub fn drain<'a, R: RangeBounds<usize>>(&'a mut self, range: R)\n+        -> impl Iterator<Item=T> + ExactSizeIterator + 'a\n+    {\n         self.raw.drain(range)\n     }\n \n     #[inline]\n-    pub fn drain_enumerated<'a, R: RangeBounds<usize>>(\n-        &'a mut self, range: R) -> impl Iterator<Item=(I, T)> + 'a {\n+    pub fn drain_enumerated<'a, R: RangeBounds<usize>>(&'a mut self, range: R)\n+        -> impl Iterator<Item=(I, T)> + ExactSizeIterator + 'a\n+    {\n         self.raw.drain(range).enumerate().map(IntoIdx { _marker: PhantomData })\n     }\n "}, {"sha": "6a24b1a1df442e01827b532e2f737cebff57905e", "filename": "src/librustc_mir/borrow_check/location.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_mir%2Fborrow_check%2Flocation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_mir%2Fborrow_check%2Flocation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Flocation.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -53,7 +53,7 @@ impl LocationTable {\n         }\n     }\n \n-    crate fn all_points(&self) -> impl Iterator<Item = LocationIndex> {\n+    crate fn all_points(&self) -> impl Iterator<Item = LocationIndex> + ExactSizeIterator {\n         (0..self.num_points).map(LocationIndex::new)\n     }\n "}, {"sha": "5b014ec85284b31e3bb084a10f1d3d39a069a3d0", "filename": "src/librustc_mir/borrow_check/nll/member_constraints.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fmember_constraints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fmember_constraints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fmember_constraints.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -155,7 +155,7 @@ where\n {\n     crate fn all_indices(\n         &self,\n-    ) -> impl Iterator<Item = NllMemberConstraintIndex> {\n+    ) -> impl Iterator<Item = NllMemberConstraintIndex> + ExactSizeIterator {\n         self.constraints.indices()\n     }\n "}, {"sha": "b488875ee0914d4de40a81da8c46e93089772b7c", "filename": "src/librustc_mir/borrow_check/nll/region_infer/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fregion_infer%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fregion_infer%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fregion_infer%2Fmod.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -422,7 +422,7 @@ impl<'tcx> RegionInferenceContext<'tcx> {\n     }\n \n     /// Returns an iterator over all the region indices.\n-    pub fn regions(&self) -> impl Iterator<Item = RegionVid> {\n+    pub fn regions(&self) -> impl Iterator<Item = RegionVid> + ExactSizeIterator {\n         self.definitions.indices()\n     }\n "}, {"sha": "868ddc0c1faf33471fe6e259bce61936c7ac7181", "filename": "src/librustc_mir/borrow_check/nll/region_infer/values.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fregion_infer%2Fvalues.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fregion_infer%2Fvalues.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fregion_infer%2Fvalues.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -162,7 +162,7 @@ impl<N: Idx> LivenessValues<N> {\n     }\n \n     /// Iterate through each region that has a value in this set.\n-    crate fn rows(&self) -> impl Iterator<Item=N> {\n+    crate fn rows(&self) -> impl Iterator<Item=N> + ExactSizeIterator {\n         self.points.rows()\n     }\n "}, {"sha": "51a7cb054b6e9139ea0bd939351c9290a6a30849", "filename": "src/librustc_mir/borrow_check/nll/universal_regions.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Funiversal_regions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Funiversal_regions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Funiversal_regions.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -107,7 +107,9 @@ impl<'tcx> DefiningTy<'tcx> {\n     /// not a closure or generator, there are no upvars, and hence it\n     /// will be an empty list. The order of types in this list will\n     /// match up with the upvar order in the HIR, typesystem, and MIR.\n-    pub fn upvar_tys(self, tcx: TyCtxt<'tcx>) -> impl Iterator<Item = Ty<'tcx>> + 'tcx {\n+    pub fn upvar_tys(self, tcx: TyCtxt<'tcx>)\n+        -> impl Iterator<Item = Ty<'tcx>> + ExactSizeIterator + 'tcx\n+    {\n         match self {\n             DefiningTy::Closure(def_id, substs) => Either::Left(\n                 substs.as_closure().upvar_tys(def_id, tcx)\n@@ -267,7 +269,7 @@ impl<'tcx> UniversalRegions<'tcx> {\n \n     /// Returns an iterator over all the RegionVids corresponding to\n     /// universally quantified free regions.\n-    pub fn universal_regions(&self) -> impl Iterator<Item = RegionVid> {\n+    pub fn universal_regions(&self) -> impl Iterator<Item = RegionVid> + ExactSizeIterator {\n         (FIRST_GLOBAL_INDEX..self.num_universals).map(RegionVid::new)\n     }\n \n@@ -293,7 +295,7 @@ impl<'tcx> UniversalRegions<'tcx> {\n     /// Gets an iterator over all the early-bound regions that have names.\n     pub fn named_universal_regions<'s>(\n         &'s self,\n-    ) -> impl Iterator<Item = (ty::Region<'tcx>, ty::RegionVid)> + 's {\n+    ) -> impl Iterator<Item = (ty::Region<'tcx>, ty::RegionVid)> + ExactSizeIterator + 's {\n         self.indices.indices.iter().map(|(&r, &v)| (r, v))\n     }\n "}, {"sha": "45c19812e463b22fad352a4c60e6ea7d0839b15f", "filename": "src/librustc_mir/hair/pattern/_match.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_mir%2Fhair%2Fpattern%2F_match.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_mir%2Fhair%2Fpattern%2F_match.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fhair%2Fpattern%2F_match.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -396,7 +396,7 @@ impl<'p, 'tcx> PatStack<'p, 'tcx> {\n         PatStack::from_slice(&self.0[1..])\n     }\n \n-    fn iter(&self) -> impl Iterator<Item = &Pat<'tcx>> {\n+    fn iter(&self) -> impl Iterator<Item = &Pat<'tcx>> + ExactSizeIterator {\n         self.0.iter().map(|p| *p)\n     }\n "}, {"sha": "3876c6e4132a24342a27cb6e484fdab306738fcb", "filename": "src/librustc_target/abi/mod.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_target%2Fabi%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d97379a96e594820b9e865ae56cb8d753bf6b06a/src%2Flibrustc_target%2Fabi%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_target%2Fabi%2Fmod.rs?ref=d97379a96e594820b9e865ae56cb8d753bf6b06a", "patch": "@@ -723,7 +723,9 @@ impl FieldPlacement {\n \n     /// Gets source indices of the fields by increasing offsets.\n     #[inline]\n-    pub fn index_by_increasing_offset<'a>(&'a self) -> impl Iterator<Item=usize>+'a {\n+    pub fn index_by_increasing_offset<'a>(&'a self)\n+        -> impl Iterator<Item=usize> + ExactSizeIterator + 'a\n+    {\n         let mut inverse_small = [0u8; 64];\n         let mut inverse_big = vec![];\n         let use_small = self.count() <= inverse_small.len();"}]}