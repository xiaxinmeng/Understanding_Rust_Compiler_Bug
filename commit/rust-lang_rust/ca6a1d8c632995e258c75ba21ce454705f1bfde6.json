{"sha": "ca6a1d8c632995e258c75ba21ce454705f1bfde6", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNhNmExZDhjNjMyOTk1ZTI1OGM3NWJhMjFjZTQ1NDcwNWYxYmZkZTY=", "commit": {"author": {"name": "Alexander Sieg", "email": "alex@xanderio.de", "date": "2021-08-17T15:17:02Z"}, "committer": {"name": "Alexander Sieg", "email": "alex@xanderio.de", "date": "2021-08-17T15:17:13Z"}, "message": "Revert \"Downgrade notify and use RecommendedWatcher\"\n\nThis reverts commit 5b0c86af7d1683983a35f232baa7c98cfa3c382d.\n\nThe pre-5.0.12 release of notify fixed this issue.", "tree": {"sha": "6345c4b2c3bcee5d3ba07925d57914c584816fbc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6345c4b2c3bcee5d3ba07925d57914c584816fbc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ca6a1d8c632995e258c75ba21ce454705f1bfde6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ca6a1d8c632995e258c75ba21ce454705f1bfde6", "html_url": "https://github.com/rust-lang/rust/commit/ca6a1d8c632995e258c75ba21ce454705f1bfde6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ca6a1d8c632995e258c75ba21ce454705f1bfde6/comments", "author": {"login": "xanderio", "id": 6298052, "node_id": "MDQ6VXNlcjYyOTgwNTI=", "avatar_url": "https://avatars.githubusercontent.com/u/6298052?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xanderio", "html_url": "https://github.com/xanderio", "followers_url": "https://api.github.com/users/xanderio/followers", "following_url": "https://api.github.com/users/xanderio/following{/other_user}", "gists_url": "https://api.github.com/users/xanderio/gists{/gist_id}", "starred_url": "https://api.github.com/users/xanderio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xanderio/subscriptions", "organizations_url": "https://api.github.com/users/xanderio/orgs", "repos_url": "https://api.github.com/users/xanderio/repos", "events_url": "https://api.github.com/users/xanderio/events{/privacy}", "received_events_url": "https://api.github.com/users/xanderio/received_events", "type": "User", "site_admin": false}, "committer": {"login": "xanderio", "id": 6298052, "node_id": "MDQ6VXNlcjYyOTgwNTI=", "avatar_url": "https://avatars.githubusercontent.com/u/6298052?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xanderio", "html_url": "https://github.com/xanderio", "followers_url": "https://api.github.com/users/xanderio/followers", "following_url": "https://api.github.com/users/xanderio/following{/other_user}", "gists_url": "https://api.github.com/users/xanderio/gists{/gist_id}", "starred_url": "https://api.github.com/users/xanderio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xanderio/subscriptions", "organizations_url": "https://api.github.com/users/xanderio/orgs", "repos_url": "https://api.github.com/users/xanderio/repos", "events_url": "https://api.github.com/users/xanderio/events{/privacy}", "received_events_url": "https://api.github.com/users/xanderio/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8d7eea9e3aa1c06a2d7391b8a2b32c9485c1f40c", "url": "https://api.github.com/repos/rust-lang/rust/commits/8d7eea9e3aa1c06a2d7391b8a2b32c9485c1f40c", "html_url": "https://github.com/rust-lang/rust/commit/8d7eea9e3aa1c06a2d7391b8a2b32c9485c1f40c"}], "stats": {"total": 36, "additions": 28, "deletions": 8}, "files": [{"sha": "644405063352cb305b0d89b1788fcfbdcf6ebe0a", "filename": "Cargo.lock", "status": "modified", "additions": 23, "deletions": 2, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/ca6a1d8c632995e258c75ba21ce454705f1bfde6/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/ca6a1d8c632995e258c75ba21ce454705f1bfde6/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=ca6a1d8c632995e258c75ba21ce454705f1bfde6", "patch": "@@ -765,6 +765,26 @@ version = \"0.1.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"8b23360e99b8717f20aaa4598f5a6541efbe30630039fbc7706cf954a87947ae\"\n \n+[[package]]\n+name = \"kqueue\"\n+version = \"1.0.3\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"512705bfcaeb3d46379771adc69deab978355fc68fdf960f9fb11abc8d678a96\"\n+dependencies = [\n+ \"kqueue-sys\",\n+ \"libc\",\n+]\n+\n+[[package]]\n+name = \"kqueue-sys\"\n+version = \"1.0.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"9803ae382091c10a5c7297ffb9fde284dbc9662b249f86eacef605d97ae92d99\"\n+dependencies = [\n+ \"bitflags\",\n+ \"libc\",\n+]\n+\n [[package]]\n name = \"la-arena\"\n version = \"0.2.1\"\n@@ -945,15 +965,16 @@ dependencies = [\n \n [[package]]\n name = \"notify\"\n-version = \"5.0.0-pre.10\"\n+version = \"5.0.0-pre.11\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"51f18203a26893ca1d3526cf58084025d5639f91c44f8b70ab3b724f60e819a0\"\n+checksum = \"c614e7ed2b1cf82ec99aeffd8cf6225ef5021b9951148eb161393c394855032c\"\n dependencies = [\n  \"bitflags\",\n  \"crossbeam-channel\",\n  \"filetime\",\n  \"fsevent-sys\",\n  \"inotify\",\n+ \"kqueue\",\n  \"libc\",\n  \"mio\",\n  \"walkdir\","}, {"sha": "0233c6da28ff679c337141f23b5b55dfa11db69c", "filename": "crates/vfs-notify/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ca6a1d8c632995e258c75ba21ce454705f1bfde6/crates%2Fvfs-notify%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/ca6a1d8c632995e258c75ba21ce454705f1bfde6/crates%2Fvfs-notify%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fvfs-notify%2FCargo.toml?ref=ca6a1d8c632995e258c75ba21ce454705f1bfde6", "patch": "@@ -14,7 +14,7 @@ rustc-hash = \"1.0\"\n jod-thread = \"0.1.0\"\n walkdir = \"2.3.1\"\n crossbeam-channel = \"0.5.0\"\n-notify = \"=5.0.0-pre.10\"    # check that it builds on NetBSD before upgrading\n+notify = \"=5.0.0-pre.11\"\n \n vfs = { path = \"../vfs\", version = \"0.0.0\" }\n paths = { path = \"../paths\", version = \"0.0.0\" }"}, {"sha": "960d988a4cad1de4a77fa49df7f6ee84e1cc7949", "filename": "crates/vfs-notify/src/lib.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/ca6a1d8c632995e258c75ba21ce454705f1bfde6/crates%2Fvfs-notify%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca6a1d8c632995e258c75ba21ce454705f1bfde6/crates%2Fvfs-notify%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fvfs-notify%2Fsrc%2Flib.rs?ref=ca6a1d8c632995e258c75ba21ce454705f1bfde6", "patch": "@@ -83,10 +83,9 @@ impl NotifyActor {\n                         self.watcher = None;\n                         if !config.watch.is_empty() {\n                             let (watcher_sender, watcher_receiver) = unbounded();\n-                            let watcher =\n-                                log_notify_error(RecommendedWatcher::new_immediate(move |event| {\n-                                    watcher_sender.send(event).unwrap()\n-                                }));\n+                            let watcher = log_notify_error(RecommendedWatcher::new(move |event| {\n+                                watcher_sender.send(event).unwrap()\n+                            }));\n                             self.watcher = watcher.map(|it| (it, watcher_receiver));\n                         }\n \n@@ -215,7 +214,7 @@ impl NotifyActor {\n \n     fn watch(&mut self, path: AbsPathBuf) {\n         if let Some((watcher, _)) = &mut self.watcher {\n-            log_notify_error(watcher.watch(&path, RecursiveMode::NonRecursive));\n+            log_notify_error(watcher.watch(path.as_ref(), RecursiveMode::NonRecursive));\n         }\n     }\n     fn send(&mut self, msg: loader::Message) {"}]}