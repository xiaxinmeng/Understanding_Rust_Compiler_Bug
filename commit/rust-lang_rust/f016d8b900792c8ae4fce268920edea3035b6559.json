{"sha": "f016d8b900792c8ae4fce268920edea3035b6559", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYwMTZkOGI5MDA3OTJjOGFlNGZjZTI2ODkyMGVkZWEzMDM1YjY1NTk=", "commit": {"author": {"name": "Piotr Szpetkowski", "email": "piotr.szpetkowski@pyquest.space", "date": "2020-03-27T16:28:25Z"}, "committer": {"name": "Piotr Szpetkowski", "email": "piotr.szpetkowski@pyquest.space", "date": "2020-03-27T16:28:25Z"}, "message": "Fix merge-imports assist for wildcard imports", "tree": {"sha": "9afc05a20e5e51f757317a71906dc45a97861415", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9afc05a20e5e51f757317a71906dc45a97861415"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f016d8b900792c8ae4fce268920edea3035b6559", "comment_count": 0, "verification": {"verified": false, "reason": "unknown_key", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEmqbzce+WgUydeyW50/7GrmZrxbEFAl5+KeMACgkQ0/7GrmZr\nxbGLiA/8DrqQENXr1iZETWmlFXawnZ26zDi+iKQhFM8ORb9LtipBQB3adoxWgBwt\n8+U/VcAp2n/K2ZeKgt+vxqSzj25p8Bk/oCNLNQla2yNOf+gweE6lVi/1NDH9DoVX\nm4Lj7f0aWxMcU9cDmAFzXsZhzF4m85HmVuP1SrdI9sYHDsn5PoYvkPDUHAS/g1nt\nfZBa6Xz1M0rg10rtDJ/N81q7Cys2XJzkfgXNYeQU5pXJ+9XDLQFYrT6mHM/v9ipu\nNeas+LGqGcQzLFbiGc+gQj+7TDGSXmrz2Ok4W+X7dKi0N3p3EKeUaMopJOz+xatO\nbff2IWVRuPO2w1qGpqXeqev+lDti3OqTS0m/ZNF/3SqEbE8F9bjQlz5fp5iVLc8k\niqV8pm/CW4IdO3jF2C1ne/kTaR32qPerRgRwlpysA4AQx8gyuqy+rvYDoRKtu7+t\nO+JqLmvGEXKPnHXQUXwW7Y1JHYpppJNsh0rKkQ/w8MpMKdb9yBc4YlBvIr9Z6veP\nuWtUM5YEkSP5WeVs/WdG1U1znX8p/Du2KksczVmm+s20RtDL0DmL0czt5bIq8xeX\nPG/hmdNTA27/cQkKJeszvq1F6do1IbQN+OhfGUDPMrAJhsCsC0Z1YKSeQTIdCur7\nV1iDri45vBBpBTMbXyKNI4NUcTXMS8TolDyFeVrt1n6969UBOFw=\n=TqTw\n-----END PGP SIGNATURE-----", "payload": "tree 9afc05a20e5e51f757317a71906dc45a97861415\nparent 75f6ab208a2b3e5fea9e8b6362df3fad7308a0d5\nauthor Piotr Szpetkowski <piotr.szpetkowski@pyquest.space> 1585326505 +0100\ncommitter Piotr Szpetkowski <piotr.szpetkowski@pyquest.space> 1585326505 +0100\n\nFix merge-imports assist for wildcard imports\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f016d8b900792c8ae4fce268920edea3035b6559", "html_url": "https://github.com/rust-lang/rust/commit/f016d8b900792c8ae4fce268920edea3035b6559", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f016d8b900792c8ae4fce268920edea3035b6559/comments", "author": {"login": "pszpetkowski", "id": 18597734, "node_id": "MDQ6VXNlcjE4NTk3NzM0", "avatar_url": "https://avatars.githubusercontent.com/u/18597734?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pszpetkowski", "html_url": "https://github.com/pszpetkowski", "followers_url": "https://api.github.com/users/pszpetkowski/followers", "following_url": "https://api.github.com/users/pszpetkowski/following{/other_user}", "gists_url": "https://api.github.com/users/pszpetkowski/gists{/gist_id}", "starred_url": "https://api.github.com/users/pszpetkowski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pszpetkowski/subscriptions", "organizations_url": "https://api.github.com/users/pszpetkowski/orgs", "repos_url": "https://api.github.com/users/pszpetkowski/repos", "events_url": "https://api.github.com/users/pszpetkowski/events{/privacy}", "received_events_url": "https://api.github.com/users/pszpetkowski/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pszpetkowski", "id": 18597734, "node_id": "MDQ6VXNlcjE4NTk3NzM0", "avatar_url": "https://avatars.githubusercontent.com/u/18597734?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pszpetkowski", "html_url": "https://github.com/pszpetkowski", "followers_url": "https://api.github.com/users/pszpetkowski/followers", "following_url": "https://api.github.com/users/pszpetkowski/following{/other_user}", "gists_url": "https://api.github.com/users/pszpetkowski/gists{/gist_id}", "starred_url": "https://api.github.com/users/pszpetkowski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pszpetkowski/subscriptions", "organizations_url": "https://api.github.com/users/pszpetkowski/orgs", "repos_url": "https://api.github.com/users/pszpetkowski/repos", "events_url": "https://api.github.com/users/pszpetkowski/events{/privacy}", "received_events_url": "https://api.github.com/users/pszpetkowski/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "75f6ab208a2b3e5fea9e8b6362df3fad7308a0d5", "url": "https://api.github.com/repos/rust-lang/rust/commits/75f6ab208a2b3e5fea9e8b6362df3fad7308a0d5", "html_url": "https://github.com/rust-lang/rust/commit/75f6ab208a2b3e5fea9e8b6362df3fad7308a0d5"}], "stats": {"total": 38, "additions": 36, "deletions": 2}, "files": [{"sha": "5d4b74e567a1422fb73e79aa665532e61a5dbe28", "filename": "crates/ra_assists/src/handlers/merge_imports.rs", "status": "modified", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/f016d8b900792c8ae4fce268920edea3035b6559/crates%2Fra_assists%2Fsrc%2Fhandlers%2Fmerge_imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f016d8b900792c8ae4fce268920edea3035b6559/crates%2Fra_assists%2Fsrc%2Fhandlers%2Fmerge_imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_assists%2Fsrc%2Fhandlers%2Fmerge_imports.rs?ref=f016d8b900792c8ae4fce268920edea3035b6559", "patch": "@@ -170,6 +170,34 @@ use std::{fmt::<|>{Display, Debug}};\n         );\n     }\n \n+    #[test]\n+    fn test_merge_single_wildcard_diff_prefixes() {\n+        check_assist(\n+            merge_imports,\n+            r\"\n+use std<|>::cell::*;\n+use std::str;\n+\",\n+            r\"\n+use std<|>::{cell::*, str};\n+\",\n+        )\n+    }\n+\n+    #[test]\n+    fn test_merge_both_wildcard_diff_prefixes() {\n+        check_assist(\n+            merge_imports,\n+            r\"\n+use std<|>::cell::*;\n+use std::str::*;\n+\",\n+            r\"\n+use std<|>::{cell::*, str::*};\n+\",\n+        )\n+    }\n+\n     #[test]\n     fn removes_just_enough_whitespace() {\n         check_assist("}, {"sha": "2304e00cf96edb5cea3921433f1f3b77443c51dd", "filename": "crates/ra_syntax/src/ast/edit.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/f016d8b900792c8ae4fce268920edea3035b6559/crates%2Fra_syntax%2Fsrc%2Fast%2Fedit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f016d8b900792c8ae4fce268920edea3035b6559/crates%2Fra_syntax%2Fsrc%2Fast%2Fedit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Fsrc%2Fast%2Fedit.rs?ref=f016d8b900792c8ae4fce268920edea3035b6559", "patch": "@@ -302,9 +302,10 @@ impl ast::UseTree {\n             Some(it) => it,\n             None => return self.clone(),\n         };\n-        let use_tree = make::use_tree(suffix.clone(), self.use_tree_list(), self.alias());\n+        let use_tree =\n+            make::use_tree(suffix.clone(), self.use_tree_list(), self.alias(), self.has_star());\n         let nested = make::use_tree_list(iter::once(use_tree));\n-        return make::use_tree(prefix.clone(), Some(nested), None);\n+        return make::use_tree(prefix.clone(), Some(nested), None, false);\n \n         fn split_path_prefix(prefix: &ast::Path) -> Option<ast::Path> {\n             let parent = prefix.parent_path()?;"}, {"sha": "dbf8e63704195956209402b343805f90406a7f75", "filename": "crates/ra_syntax/src/ast/make.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/f016d8b900792c8ae4fce268920edea3035b6559/crates%2Fra_syntax%2Fsrc%2Fast%2Fmake.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f016d8b900792c8ae4fce268920edea3035b6559/crates%2Fra_syntax%2Fsrc%2Fast%2Fmake.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Fsrc%2Fast%2Fmake.rs?ref=f016d8b900792c8ae4fce268920edea3035b6559", "patch": "@@ -29,12 +29,17 @@ pub fn use_tree(\n     path: ast::Path,\n     use_tree_list: Option<ast::UseTreeList>,\n     alias: Option<ast::Alias>,\n+    add_star: bool,\n ) -> ast::UseTree {\n     let mut buf = \"use \".to_string();\n     buf += &path.syntax().to_string();\n     if let Some(use_tree_list) = use_tree_list {\n         buf += &format!(\"::{}\", use_tree_list);\n     }\n+    if add_star {\n+        buf += \"::*\";\n+    }\n+\n     if let Some(alias) = alias {\n         buf += &format!(\" {}\", alias);\n     }"}]}