{"sha": "03a9bbacf2a82faaecc269c1d97dea392f4f9874", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAzYTliYmFjZjJhODJmYWFlY2MyNjljMWQ5N2RlYTM5MmY0Zjk4NzQ=", "commit": {"author": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2020-12-23T00:49:43Z"}, "committer": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2020-12-23T00:49:43Z"}, "message": "Parse ConstBlockPat", "tree": {"sha": "3e9d9dbb829c0f324c68cbd7f7f592b548fe4df5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3e9d9dbb829c0f324c68cbd7f7f592b548fe4df5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/03a9bbacf2a82faaecc269c1d97dea392f4f9874", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/03a9bbacf2a82faaecc269c1d97dea392f4f9874", "html_url": "https://github.com/rust-lang/rust/commit/03a9bbacf2a82faaecc269c1d97dea392f4f9874", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/03a9bbacf2a82faaecc269c1d97dea392f4f9874/comments", "author": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "be7260485e31eb24a9fa7bb3d6b587ab59bd6846", "url": "https://api.github.com/repos/rust-lang/rust/commits/be7260485e31eb24a9fa7bb3d6b587ab59bd6846", "html_url": "https://github.com/rust-lang/rust/commit/be7260485e31eb24a9fa7bb3d6b587ab59bd6846"}], "stats": {"total": 96, "additions": 96, "deletions": 0}, "files": [{"sha": "44400c9f8e4d4551194a7dd9f8bee7c48f87cb0c", "filename": "crates/parser/src/grammar/patterns.rs", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/03a9bbacf2a82faaecc269c1d97dea392f4f9874/crates%2Fparser%2Fsrc%2Fgrammar%2Fpatterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/03a9bbacf2a82faaecc269c1d97dea392f4f9874/crates%2Fparser%2Fsrc%2Fgrammar%2Fpatterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Fsrc%2Fgrammar%2Fpatterns.rs?ref=03a9bbacf2a82faaecc269c1d97dea392f4f9874", "patch": "@@ -1,5 +1,7 @@\n //! FIXME: write short doc here\n \n+use expressions::block_expr;\n+\n use super::*;\n \n pub(super) const PATTERN_FIRST: TokenSet =\n@@ -89,6 +91,7 @@ fn atom_pat(p: &mut Parser, recovery_set: TokenSet) -> Option<CompletedMarker> {\n     let m = match p.nth(0) {\n         T![box] => box_pat(p),\n         T![ref] | T![mut] => ident_pat(p, true),\n+        T![const] => const_block_pat(p),\n         IDENT => match p.nth(1) {\n             // Checks the token after an IDENT to see if a pattern is a path (Struct { .. }) or macro\n             // (T![x]).\n@@ -386,3 +389,16 @@ fn box_pat(p: &mut Parser) -> CompletedMarker {\n     pattern_single(p);\n     m.complete(p, BOX_PAT)\n }\n+\n+// test const_block_pat\n+// fn main() {\n+//     let const { 15 } = ();\n+//     let const { foo(); bar() } = ();\n+// }\n+fn const_block_pat(p: &mut Parser) -> CompletedMarker {\n+    assert!(p.at(T![const]));\n+    let m = p.start();\n+    p.bump(T![const]);\n+    block_expr(p);\n+    m.complete(p, CONST_BLOCK_PAT)\n+}"}, {"sha": "8ff4822c4efb7e8492558e50c6d44f4c728aee86", "filename": "crates/syntax/test_data/parser/inline/ok/0156_const_block_pat.rast", "status": "added", "additions": 76, "deletions": 0, "changes": 76, "blob_url": "https://github.com/rust-lang/rust/blob/03a9bbacf2a82faaecc269c1d97dea392f4f9874/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0156_const_block_pat.rast", "raw_url": "https://github.com/rust-lang/rust/raw/03a9bbacf2a82faaecc269c1d97dea392f4f9874/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0156_const_block_pat.rast", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0156_const_block_pat.rast?ref=03a9bbacf2a82faaecc269c1d97dea392f4f9874", "patch": "@@ -0,0 +1,76 @@\n+SOURCE_FILE@0..78\n+  FN@0..77\n+    FN_KW@0..2 \"fn\"\n+    WHITESPACE@2..3 \" \"\n+    NAME@3..7\n+      IDENT@3..7 \"main\"\n+    PARAM_LIST@7..9\n+      L_PAREN@7..8 \"(\"\n+      R_PAREN@8..9 \")\"\n+    WHITESPACE@9..10 \" \"\n+    BLOCK_EXPR@10..77\n+      L_CURLY@10..11 \"{\"\n+      WHITESPACE@11..16 \"\\n    \"\n+      LET_STMT@16..38\n+        LET_KW@16..19 \"let\"\n+        WHITESPACE@19..20 \" \"\n+        CONST_BLOCK_PAT@20..32\n+          CONST_KW@20..25 \"const\"\n+          WHITESPACE@25..26 \" \"\n+          BLOCK_EXPR@26..32\n+            L_CURLY@26..27 \"{\"\n+            WHITESPACE@27..28 \" \"\n+            LITERAL@28..30\n+              INT_NUMBER@28..30 \"15\"\n+            WHITESPACE@30..31 \" \"\n+            R_CURLY@31..32 \"}\"\n+        WHITESPACE@32..33 \" \"\n+        EQ@33..34 \"=\"\n+        WHITESPACE@34..35 \" \"\n+        TUPLE_EXPR@35..37\n+          L_PAREN@35..36 \"(\"\n+          R_PAREN@36..37 \")\"\n+        SEMICOLON@37..38 \";\"\n+      WHITESPACE@38..43 \"\\n    \"\n+      LET_STMT@43..75\n+        LET_KW@43..46 \"let\"\n+        WHITESPACE@46..47 \" \"\n+        CONST_BLOCK_PAT@47..69\n+          CONST_KW@47..52 \"const\"\n+          WHITESPACE@52..53 \" \"\n+          BLOCK_EXPR@53..69\n+            L_CURLY@53..54 \"{\"\n+            WHITESPACE@54..55 \" \"\n+            EXPR_STMT@55..61\n+              CALL_EXPR@55..60\n+                PATH_EXPR@55..58\n+                  PATH@55..58\n+                    PATH_SEGMENT@55..58\n+                      NAME_REF@55..58\n+                        IDENT@55..58 \"foo\"\n+                ARG_LIST@58..60\n+                  L_PAREN@58..59 \"(\"\n+                  R_PAREN@59..60 \")\"\n+              SEMICOLON@60..61 \";\"\n+            WHITESPACE@61..62 \" \"\n+            CALL_EXPR@62..67\n+              PATH_EXPR@62..65\n+                PATH@62..65\n+                  PATH_SEGMENT@62..65\n+                    NAME_REF@62..65\n+                      IDENT@62..65 \"bar\"\n+              ARG_LIST@65..67\n+                L_PAREN@65..66 \"(\"\n+                R_PAREN@66..67 \")\"\n+            WHITESPACE@67..68 \" \"\n+            R_CURLY@68..69 \"}\"\n+        WHITESPACE@69..70 \" \"\n+        EQ@70..71 \"=\"\n+        WHITESPACE@71..72 \" \"\n+        TUPLE_EXPR@72..74\n+          L_PAREN@72..73 \"(\"\n+          R_PAREN@73..74 \")\"\n+        SEMICOLON@74..75 \";\"\n+      WHITESPACE@75..76 \"\\n\"\n+      R_CURLY@76..77 \"}\"\n+  WHITESPACE@77..78 \"\\n\""}, {"sha": "dce9defac2f9fdc312a082f503f2183d9161870e", "filename": "crates/syntax/test_data/parser/inline/ok/0156_const_block_pat.rs", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/03a9bbacf2a82faaecc269c1d97dea392f4f9874/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0156_const_block_pat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/03a9bbacf2a82faaecc269c1d97dea392f4f9874/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0156_const_block_pat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0156_const_block_pat.rs?ref=03a9bbacf2a82faaecc269c1d97dea392f4f9874", "patch": "@@ -0,0 +1,4 @@\n+fn main() {\n+    let const { 15 } = ();\n+    let const { foo(); bar() } = ();\n+}"}]}