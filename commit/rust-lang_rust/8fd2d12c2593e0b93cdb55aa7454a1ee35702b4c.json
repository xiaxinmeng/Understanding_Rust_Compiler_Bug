{"sha": "8fd2d12c2593e0b93cdb55aa7454a1ee35702b4c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhmZDJkMTJjMjU5M2UwYjkzY2RiNTVhYTc0NTRhMWVlMzU3MDJiNGM=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-06-15T00:48:59Z"}, "committer": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-06-15T00:48:59Z"}, "message": "typeck/expr.rs: extract out check_expr_yield.", "tree": {"sha": "59be7453398092443cb8a63ba280ce3a748c29b5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/59be7453398092443cb8a63ba280ce3a748c29b5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8fd2d12c2593e0b93cdb55aa7454a1ee35702b4c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8fd2d12c2593e0b93cdb55aa7454a1ee35702b4c", "html_url": "https://github.com/rust-lang/rust/commit/8fd2d12c2593e0b93cdb55aa7454a1ee35702b4c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8fd2d12c2593e0b93cdb55aa7454a1ee35702b4c/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8da059beaaa88d463fc5c1a642ab26900c85e2b2", "url": "https://api.github.com/repos/rust-lang/rust/commits/8da059beaaa88d463fc5c1a642ab26900c85e2b2", "html_url": "https://github.com/rust-lang/rust/commit/8da059beaaa88d463fc5c1a642ab26900c85e2b2"}], "stats": {"total": 24, "additions": 14, "deletions": 10}, "files": [{"sha": "3b755293a48a72c578ae587e6529c4a55ba21bfb", "filename": "src/librustc_typeck/check/expr.rs", "status": "modified", "additions": 14, "deletions": 10, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/8fd2d12c2593e0b93cdb55aa7454a1ee35702b4c/src%2Flibrustc_typeck%2Fcheck%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8fd2d12c2593e0b93cdb55aa7454a1ee35702b4c/src%2Flibrustc_typeck%2Fcheck%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fexpr.rs?ref=8fd2d12c2593e0b93cdb55aa7454a1ee35702b4c", "patch": "@@ -144,16 +144,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                 self.check_expr_index(base, idx, needs, expr)\n             }\n             ExprKind::Yield(ref value) => {\n-                match self.yield_ty {\n-                    Some(ty) => {\n-                        self.check_expr_coercable_to_type(&value, ty);\n-                    }\n-                    None => {\n-                        struct_span_err!(self.tcx.sess, expr.span, E0627,\n-                                         \"yield statement outside of generator literal\").emit();\n-                    }\n-                }\n-                tcx.mk_unit()\n+                self.check_expr_yield(value, expr)\n             }\n             hir::ExprKind::Err => {\n                 tcx.types.err\n@@ -914,4 +905,17 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n             }\n         }\n     }\n+\n+    fn check_expr_yield(&self, value: &'tcx hir::Expr, expr: &'tcx hir::Expr) -> Ty<'tcx> {\n+        match self.yield_ty {\n+            Some(ty) => {\n+                self.check_expr_coercable_to_type(&value, ty);\n+            }\n+            None => {\n+                struct_span_err!(self.tcx.sess, expr.span, E0627,\n+                                    \"yield statement outside of generator literal\").emit();\n+            }\n+        }\n+        self.tcx.mk_unit()\n+    }\n }"}]}