{"sha": "6ac0787ff349dd6df81bb84e673b1b4881f9e856", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZhYzA3ODdmZjM0OWRkNmRmODFiYjg0ZTY3M2IxYjQ4ODFmOWU4NTY=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2017-05-21T20:27:47Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2017-06-01T17:22:37Z"}, "message": "ci: Further tone down the test verbosity.\n\nWhen `--quiet` is passed to rustbuild, suppress rustdoc test output unless\nfailure.\n\nAdded a `--quiet` flag to `tidy`, which suppresses the features table.\n\nThe actual `--quiet` flag is enabled in #42354.\n\nSince details of failed tests will still be printed, and the name of slow\ntests taking >60 to runtime will also be printed, the debugging difficulty\ncaused by information loss should be minimal; but it is very worthwhile to\nkeep the log under 10000 lines on Travis CI so that common errors can be\nspotted without reading the raw log.", "tree": {"sha": "1b77805211d5fe2e8528e096fe4deb0d01695885", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1b77805211d5fe2e8528e096fe4deb0d01695885"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6ac0787ff349dd6df81bb84e673b1b4881f9e856", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIcBAABCAAGBQJZME1eAAoJEP72yAUdDgE8MPQP/2UI/TW9RdC/KW59fYLx6aPZ\nQT6h1vnnkmbmg3aiMfQ0iMcz+RWWsaR6gBAzsYBEdbfpuA//8/bGj0ihjwVc3yD1\nCjh3pb4PP2M+IvnScHkwYek8iSn89IEr0q15A/wFaG9s9OHU6FF0+nkfxqHjTPpJ\nDgu53ewKUIj9EYy22ZaHQux3blwVBqedOfrTYhGcisJr6/OBnxC59zkyAVAMt2yV\n8NnshIPn3EtTX3DfUQETTvQ7xUn6nOdaxzarnbAC3Nhdvrye+4KWmMKx5i5hyYEB\neYjWme31oXJBoEfr//SQ66RBfaJruxxnZGjzS9+ePmtKP1UyxEeBkng4jEqeGtHw\ndJXCyuvqbShXcZ+Y/viFaVdsRfX/q+ybqAdBOfjsyXM/4gz5eyKO1Tw5//FzosxA\nftmLgoTWquz6Nyu9PiIpiWRi3DZrlYktxbdusUSYQMX2hEqcHnrF/2vSeBdENJR/\n96vTKMWXbEm0Wxn1ZyCrxf+YBUxcdpl/LMoBljD/lPmb83DAQGKLbTDL4r/5zw6w\nyPxBEynGpgnNlyrUg8Y9zNbYAk0cmXUrH183PgwllkxOVVdcFJ24dcuP9+YkvhOo\nIujNqqpyF5V0UdZJh+m5DtbMYe0eSu2G+kom9HzOGe/qnJwelT4owFK3Wfx6N4Z4\nuxwnueXRDznuVvwQDL2z\n=kIpt\n-----END PGP SIGNATURE-----", "payload": "tree 1b77805211d5fe2e8528e096fe4deb0d01695885\nparent 1222b7a9d1d30e680aad263c16cb0b09c2675e7b\nauthor kennytm <kennytm@gmail.com> 1495398467 +0800\ncommitter kennytm <kennytm@gmail.com> 1496337757 +0800\n\nci: Further tone down the test verbosity.\n\nWhen `--quiet` is passed to rustbuild, suppress rustdoc test output unless\nfailure.\n\nAdded a `--quiet` flag to `tidy`, which suppresses the features table.\n\nThe actual `--quiet` flag is enabled in #42354.\n\nSince details of failed tests will still be printed, and the name of slow\ntests taking >60 to runtime will also be printed, the debugging difficulty\ncaused by information loss should be minimal; but it is very worthwhile to\nkeep the log under 10000 lines on Travis CI so that common errors can be\nspotted without reading the raw log.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6ac0787ff349dd6df81bb84e673b1b4881f9e856", "html_url": "https://github.com/rust-lang/rust/commit/6ac0787ff349dd6df81bb84e673b1b4881f9e856", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6ac0787ff349dd6df81bb84e673b1b4881f9e856/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1222b7a9d1d30e680aad263c16cb0b09c2675e7b", "url": "https://api.github.com/repos/rust-lang/rust/commits/1222b7a9d1d30e680aad263c16cb0b09c2675e7b", "html_url": "https://github.com/rust-lang/rust/commit/1222b7a9d1d30e680aad263c16cb0b09c2675e7b"}], "stats": {"total": 23, "additions": 16, "deletions": 7}, "files": [{"sha": "d51e3102d8ad044a151d2954fc2b98a06e239aaa", "filename": "src/bootstrap/check.rs", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/6ac0787ff349dd6df81bb84e673b1b4881f9e856/src%2Fbootstrap%2Fcheck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6ac0787ff349dd6df81bb84e673b1b4881f9e856/src%2Fbootstrap%2Fcheck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fcheck.rs?ref=6ac0787ff349dd6df81bb84e673b1b4881f9e856", "patch": "@@ -132,6 +132,9 @@ pub fn tidy(build: &Build, host: &str) {\n     if !build.config.vendor {\n         cmd.arg(\"--no-vendor\");\n     }\n+    if build.config.quiet_tests {\n+        cmd.arg(\"--quiet\");\n+    }\n     build.run(&mut cmd);\n }\n \n@@ -355,13 +358,14 @@ fn markdown_test(build: &Build, compiler: &Compiler, markdown: &Path) {\n     cmd.arg(markdown);\n     cmd.env(\"RUSTC_BOOTSTRAP\", \"1\");\n \n-    let mut test_args = build.flags.cmd.test_args().join(\" \");\n-    if build.config.quiet_tests {\n-        test_args.push_str(\" --quiet\");\n-    }\n+    let test_args = build.flags.cmd.test_args().join(\" \");\n     cmd.arg(\"--test-args\").arg(test_args);\n \n-    build.run(&mut cmd);\n+    if build.config.quiet_tests {\n+        build.run_quiet(&mut cmd);\n+    } else {\n+        build.run(&mut cmd);\n+    }\n }\n \n /// Run all unit tests plus documentation tests for an entire crate DAG defined"}, {"sha": "e34821e3584c5809953ea732b3e51350924be01d", "filename": "src/tools/tidy/src/features.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6ac0787ff349dd6df81bb84e673b1b4881f9e856/src%2Ftools%2Ftidy%2Fsrc%2Ffeatures.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6ac0787ff349dd6df81bb84e673b1b4881f9e856/src%2Ftools%2Ftidy%2Fsrc%2Ffeatures.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Ftidy%2Fsrc%2Ffeatures.rs?ref=6ac0787ff349dd6df81bb84e673b1b4881f9e856", "patch": "@@ -49,7 +49,7 @@ pub struct Feature {\n     pub has_gate_test: bool,\n }\n \n-pub fn check(path: &Path, bad: &mut bool) {\n+pub fn check(path: &Path, bad: &mut bool, quiet: bool) {\n     let mut features = collect_lang_features(path);\n     assert!(!features.is_empty());\n \n@@ -134,6 +134,10 @@ pub fn check(path: &Path, bad: &mut bool) {\n     if *bad {\n         return;\n     }\n+    if quiet {\n+        println!(\"* {} features\", features.len());\n+        return;\n+    }\n \n     let mut lines = Vec::new();\n     for (name, feature) in features.iter() {"}, {"sha": "23a31131f7a6ca6aaa1a7aa24d4c9474ce1ace4e", "filename": "src/tools/tidy/src/main.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/6ac0787ff349dd6df81bb84e673b1b4881f9e856/src%2Ftools%2Ftidy%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6ac0787ff349dd6df81bb84e673b1b4881f9e856/src%2Ftools%2Ftidy%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Ftidy%2Fsrc%2Fmain.rs?ref=6ac0787ff349dd6df81bb84e673b1b4881f9e856", "patch": "@@ -57,11 +57,12 @@ fn main() {\n     let args: Vec<String> = env::args().skip(1).collect();\n \n     let mut bad = false;\n+    let quiet = args.iter().any(|s| *s == \"--quiet\");\n     bins::check(&path, &mut bad);\n     style::check(&path, &mut bad);\n     errors::check(&path, &mut bad);\n     cargo::check(&path, &mut bad);\n-    features::check(&path, &mut bad);\n+    features::check(&path, &mut bad, quiet);\n     pal::check(&path, &mut bad);\n     unstable_book::check(&path, &mut bad);\n     if !args.iter().any(|s| *s == \"--no-vendor\") {"}]}