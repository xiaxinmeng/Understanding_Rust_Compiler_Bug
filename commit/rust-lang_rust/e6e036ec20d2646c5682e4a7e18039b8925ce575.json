{"sha": "e6e036ec20d2646c5682e4a7e18039b8925ce575", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU2ZTAzNmVjMjBkMjY0NmM1NjgyZTRhN2UxODAzOWI4OTI1Y2U1NzU=", "commit": {"author": {"name": "llogiq", "email": "bogusandre@gmail.com", "date": "2015-08-12T14:42:42Z"}, "committer": {"name": "llogiq", "email": "bogusandre@gmail.com", "date": "2015-08-12T14:42:42Z"}, "message": "pulled strings passes together, added more tests", "tree": {"sha": "4a29e1a16e73badb215581cee36f9b427fbe709e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4a29e1a16e73badb215581cee36f9b427fbe709e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e6e036ec20d2646c5682e4a7e18039b8925ce575", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e6e036ec20d2646c5682e4a7e18039b8925ce575", "html_url": "https://github.com/rust-lang/rust/commit/e6e036ec20d2646c5682e4a7e18039b8925ce575", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e6e036ec20d2646c5682e4a7e18039b8925ce575/comments", "author": {"login": "llogiq", "id": 4200835, "node_id": "MDQ6VXNlcjQyMDA4MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4200835?v=4", "gravatar_id": "", "url": "https://api.github.com/users/llogiq", "html_url": "https://github.com/llogiq", "followers_url": "https://api.github.com/users/llogiq/followers", "following_url": "https://api.github.com/users/llogiq/following{/other_user}", "gists_url": "https://api.github.com/users/llogiq/gists{/gist_id}", "starred_url": "https://api.github.com/users/llogiq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/llogiq/subscriptions", "organizations_url": "https://api.github.com/users/llogiq/orgs", "repos_url": "https://api.github.com/users/llogiq/repos", "events_url": "https://api.github.com/users/llogiq/events{/privacy}", "received_events_url": "https://api.github.com/users/llogiq/received_events", "type": "User", "site_admin": false}, "committer": {"login": "llogiq", "id": 4200835, "node_id": "MDQ6VXNlcjQyMDA4MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4200835?v=4", "gravatar_id": "", "url": "https://api.github.com/users/llogiq", "html_url": "https://github.com/llogiq", "followers_url": "https://api.github.com/users/llogiq/followers", "following_url": "https://api.github.com/users/llogiq/following{/other_user}", "gists_url": "https://api.github.com/users/llogiq/gists{/gist_id}", "starred_url": "https://api.github.com/users/llogiq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/llogiq/subscriptions", "organizations_url": "https://api.github.com/users/llogiq/orgs", "repos_url": "https://api.github.com/users/llogiq/repos", "events_url": "https://api.github.com/users/llogiq/events{/privacy}", "received_events_url": "https://api.github.com/users/llogiq/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f0182ca6c809279843784d9669159157eedd2954", "url": "https://api.github.com/repos/rust-lang/rust/commits/f0182ca6c809279843784d9669159157eedd2954", "html_url": "https://github.com/rust-lang/rust/commit/f0182ca6c809279843784d9669159157eedd2954"}], "stats": {"total": 64, "additions": 44, "deletions": 20}, "files": [{"sha": "7b47edaa496597c9076e44279a711a48eaed9841", "filename": "src/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/e6e036ec20d2646c5682e4a7e18039b8925ce575/src%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6e036ec20d2646c5682e4a7e18039b8925ce575/src%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib.rs?ref=e6e036ec20d2646c5682e4a7e18039b8925ce575", "patch": "@@ -56,7 +56,6 @@ pub fn plugin_registrar(reg: &mut Registry) {\n     reg.register_lint_pass(box misc::ModuloOne as LintPassObject);\n     reg.register_lint_pass(box unicode::Unicode as LintPassObject);\n     reg.register_lint_pass(box strings::StringAdd as LintPassObject);\n-    reg.register_lint_pass(box strings::StringAddAssign as LintPassObject);\n     reg.register_lint_pass(box returns::ReturnPass as LintPassObject);\n     reg.register_lint_pass(box methods::MethodsPass as LintPassObject);\n "}, {"sha": "aa0e8499f3e49fb2c9fbf981936b69c128d36af1", "filename": "src/strings.rs", "status": "modified", "additions": 2, "deletions": 16, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/e6e036ec20d2646c5682e4a7e18039b8925ce575/src%2Fstrings.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6e036ec20d2646c5682e4a7e18039b8925ce575/src%2Fstrings.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fstrings.rs?ref=e6e036ec20d2646c5682e4a7e18039b8925ce575", "patch": "@@ -28,7 +28,7 @@ pub struct StringAdd;\n \n impl LintPass for StringAdd {\n     fn get_lints(&self) -> LintArray {\n-        lint_array!(STRING_ADD)\n+        lint_array!(STRING_ADD, STRING_ADD_ASSIGN)\n     }\n \n     fn check_expr(&mut self, cx: &Context, e: &Expr) {\n@@ -50,21 +50,7 @@ impl LintPass for StringAdd {\n                         \"you add something to a string. \\\n                         Consider using `String::push_str()` instead.\")\n             }\n-        }\n-    }\n-}\n-            \n-\n-#[derive(Copy, Clone)]\n-pub struct StringAddAssign;\n-\n-impl LintPass for StringAddAssign {\n-    fn get_lints(&self) -> LintArray {\n-        lint_array!(STRING_ADD_ASSIGN)\n-    }\n-\n-    fn check_expr(&mut self, cx: &Context, e: &Expr) {\n-        if let &ExprAssign(ref target, ref  src) = &e.node {\n+        } else if let &ExprAssign(ref target, ref  src) = &e.node {\n             if is_string(cx, target) && is_add(src, target) {\n                 span_lint(cx, STRING_ADD_ASSIGN, e.span,\n                     \"you assign the result of adding something to this string. \\"}, {"sha": "02ebca2fe07a3ac2110b8d85711a9261cf4d44b7", "filename": "tests/compile-fail/strings.rs", "status": "modified", "additions": 42, "deletions": 3, "changes": 45, "blob_url": "https://github.com/rust-lang/rust/blob/e6e036ec20d2646c5682e4a7e18039b8925ce575/tests%2Fcompile-fail%2Fstrings.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6e036ec20d2646c5682e4a7e18039b8925ce575/tests%2Fcompile-fail%2Fstrings.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Fstrings.rs?ref=e6e036ec20d2646c5682e4a7e18039b8925ce575", "patch": "@@ -1,9 +1,37 @@\n #![feature(plugin)]\n #![plugin(clippy)]\n \n-#![deny(string_add_assign)]\n-#![deny(string_add)]\n-fn main() {\n+#[deny(string_add)]\n+#[allow(string_add_assign)]\n+fn add_only() { // ignores assignment distinction\n+\tlet mut x = \"\".to_owned();\n+\n+    for _ in (1..3) {\n+        x = x + \".\"; //~ERROR you add something to a string.\n+    }\n+    \n+    let y = \"\".to_owned();\n+    let z = y + \"...\"; //~ERROR you add something to a string.\n+    \n+    assert_eq!(&x, &z);\n+}\n+\n+#[deny(string_add_assign)]\n+fn add_assign_only() {\n+\tlet mut x = \"\".to_owned();\n+\n+    for _ in (1..3) {\n+        x = x + \".\"; //~ERROR you assign the result of adding something to this string.\n+    }\n+    \n+    let y = \"\".to_owned();\n+    let z = y + \"...\";\n+    \n+    assert_eq!(&x, &z);\n+}\n+\n+#[deny(string_add, string_add_assign)]\n+fn both() {\n     let mut x = \"\".to_owned();\n \n     for _ in (1..3) {\n@@ -15,3 +43,14 @@ fn main() {\n     \n     assert_eq!(&x, &z);\n }\n+\n+fn main() {\n+\tadd_only();\n+\tadd_assign_only();\n+\tboth();\n+\t\n+\t// the add is only caught for String\n+\tlet mut x = 1;\n+\tx = x + 1;\n+\tassert_eq!(2, x);\n+}"}]}