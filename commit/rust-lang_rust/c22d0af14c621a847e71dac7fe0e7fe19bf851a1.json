{"sha": "c22d0af14c621a847e71dac7fe0e7fe19bf851a1", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMyMmQwYWYxNGM2MjFhODQ3ZTcxZGFjN2ZlMGU3ZmUxOWJmODUxYTE=", "commit": {"author": {"name": "Luqman Aden", "email": "laden@csclub.uwaterloo.ca", "date": "2013-02-13T10:28:24Z"}, "committer": {"name": "Luqman Aden", "email": "laden@csclub.uwaterloo.ca", "date": "2013-02-13T20:41:38Z"}, "message": "rt: take into account alignment for debug_opaque. Closes #2667", "tree": {"sha": "8f4fa34f1c04b6a9d3c8a667def79f8f78611f8c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8f4fa34f1c04b6a9d3c8a667def79f8f78611f8c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c22d0af14c621a847e71dac7fe0e7fe19bf851a1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c22d0af14c621a847e71dac7fe0e7fe19bf851a1", "html_url": "https://github.com/rust-lang/rust/commit/c22d0af14c621a847e71dac7fe0e7fe19bf851a1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c22d0af14c621a847e71dac7fe0e7fe19bf851a1/comments", "author": {"login": "luqmana", "id": 287063, "node_id": "MDQ6VXNlcjI4NzA2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/287063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luqmana", "html_url": "https://github.com/luqmana", "followers_url": "https://api.github.com/users/luqmana/followers", "following_url": "https://api.github.com/users/luqmana/following{/other_user}", "gists_url": "https://api.github.com/users/luqmana/gists{/gist_id}", "starred_url": "https://api.github.com/users/luqmana/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luqmana/subscriptions", "organizations_url": "https://api.github.com/users/luqmana/orgs", "repos_url": "https://api.github.com/users/luqmana/repos", "events_url": "https://api.github.com/users/luqmana/events{/privacy}", "received_events_url": "https://api.github.com/users/luqmana/received_events", "type": "User", "site_admin": false}, "committer": {"login": "luqmana", "id": 287063, "node_id": "MDQ6VXNlcjI4NzA2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/287063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luqmana", "html_url": "https://github.com/luqmana", "followers_url": "https://api.github.com/users/luqmana/followers", "following_url": "https://api.github.com/users/luqmana/following{/other_user}", "gists_url": "https://api.github.com/users/luqmana/gists{/gist_id}", "starred_url": "https://api.github.com/users/luqmana/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luqmana/subscriptions", "organizations_url": "https://api.github.com/users/luqmana/orgs", "repos_url": "https://api.github.com/users/luqmana/repos", "events_url": "https://api.github.com/users/luqmana/events{/privacy}", "received_events_url": "https://api.github.com/users/luqmana/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d67e144f685783503c1406cb4f28ea19d91d1fec", "url": "https://api.github.com/repos/rust-lang/rust/commits/d67e144f685783503c1406cb4f28ea19d91d1fec", "html_url": "https://github.com/rust-lang/rust/commit/d67e144f685783503c1406cb4f28ea19d91d1fec"}], "stats": {"total": 9, "additions": 6, "deletions": 3}, "files": [{"sha": "a8e1e7a0be4ba5b82d5c17276c4f4db268bac190", "filename": "src/rt/rust_builtin.cpp", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/c22d0af14c621a847e71dac7fe0e7fe19bf851a1/src%2Frt%2Frust_builtin.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/c22d0af14c621a847e71dac7fe0e7fe19bf851a1/src%2Frt%2Frust_builtin.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_builtin.cpp?ref=c22d0af14c621a847e71dac7fe0e7fe19bf851a1", "patch": "@@ -241,10 +241,13 @@ debug_opaque(type_desc *t, uint8_t *front) {\n     rust_task *task = rust_get_current_task();\n     LOG(task, stdlib, \"debug_opaque\");\n     debug_tydesc_helper(t);\n-    // FIXME (#2667) may want to actually account for alignment.\n-    // `front` may not indeed be the front byte of the passed-in\n-    // argument.\n     for (uintptr_t i = 0; i < t->size; ++front, ++i) {\n+\n+        // Account for alignment. `front` may not indeed be the\n+        // front byte of the passed-in argument\n+        if (((uintptr_t)front % t->align) != 0)\n+            front = (uint8_t *)align_to((uintptr_t)front, (size_t)t->align);\n+\n         LOG(task, stdlib, \"  byte %\" PRIdPTR \": 0x%\" PRIx8, i, *front);\n     }\n }"}]}