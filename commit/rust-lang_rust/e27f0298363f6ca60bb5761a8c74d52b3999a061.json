{"sha": "e27f0298363f6ca60bb5761a8c74d52b3999a061", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUyN2YwMjk4MzYzZjZjYTYwYmI1NzYxYThjNzRkNTJiMzk5OWEwNjE=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-10-09T03:31:38Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-10-09T03:31:38Z"}, "message": "Rollup merge of #65175 - andjo403:partitioning, r=zackmdavis\n\nadd more info in debug traces for gcu merging\n\nto help in investigation of CGU partitioning problems e.g https://github.com/rust-lang/rust/issues/64913", "tree": {"sha": "907f93d50a06e4997a8b0b29214bc219243810c6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/907f93d50a06e4997a8b0b29214bc219243810c6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e27f0298363f6ca60bb5761a8c74d52b3999a061", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdnVSaCRBK7hj4Ov3rIwAAdHIIABoED2juYI37Ts3Xprvm2AOv\nyxxuco8kt6NZMIaTF8qlOOFMZKlub3OIcctNVRU84frPRtsGyjSqZwpMiQvWrrkW\nHACEs1rH7AwwKWLUn0UE3pK79UIAgyy6Ssx+Fd1XIrZiLwKMMnqw9EafA1ZkBl+u\nYQBNWgbQir8Y96IOKZ+ugZMArUKCRFqLm5/zG10EhAP5B/u/pjOG1iDzQd1o/h6o\nowkKUs1CYq2L6+LvT45oyssTcQVa3mjmA+/pDu+jImHIMe/qH293l/AaPCTwEx4X\nExZBMVYJUpZqWloQ7dpqEW1qw1YSPUY1S5l1yy9f01L2DIfiVgbVt0/O9mfNMKY=\n=LQGp\n-----END PGP SIGNATURE-----\n", "payload": "tree 907f93d50a06e4997a8b0b29214bc219243810c6\nparent 5bbdcb67340679d4f8da31af091d97e7f8ec487f\nparent 50932ea1dae96a15e8f457e4e038d0e5218d2cad\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1570591898 +0200\ncommitter GitHub <noreply@github.com> 1570591898 +0200\n\nRollup merge of #65175 - andjo403:partitioning, r=zackmdavis\n\nadd more info in debug traces for gcu merging\n\nto help in investigation of CGU partitioning problems e.g https://github.com/rust-lang/rust/issues/64913\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e27f0298363f6ca60bb5761a8c74d52b3999a061", "html_url": "https://github.com/rust-lang/rust/commit/e27f0298363f6ca60bb5761a8c74d52b3999a061", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e27f0298363f6ca60bb5761a8c74d52b3999a061/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5bbdcb67340679d4f8da31af091d97e7f8ec487f", "url": "https://api.github.com/repos/rust-lang/rust/commits/5bbdcb67340679d4f8da31af091d97e7f8ec487f", "html_url": "https://github.com/rust-lang/rust/commit/5bbdcb67340679d4f8da31af091d97e7f8ec487f"}, {"sha": "50932ea1dae96a15e8f457e4e038d0e5218d2cad", "url": "https://api.github.com/repos/rust-lang/rust/commits/50932ea1dae96a15e8f457e4e038d0e5218d2cad", "html_url": "https://github.com/rust-lang/rust/commit/50932ea1dae96a15e8f457e4e038d0e5218d2cad"}], "stats": {"total": 10, "additions": 7, "deletions": 3}, "files": [{"sha": "61868b24c0b8a8239e8e78e172bd455c75fd8223", "filename": "src/librustc_mir/monomorphize/partitioning.rs", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/e27f0298363f6ca60bb5761a8c74d52b3999a061/src%2Flibrustc_mir%2Fmonomorphize%2Fpartitioning.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e27f0298363f6ca60bb5761a8c74d52b3999a061/src%2Flibrustc_mir%2Fmonomorphize%2Fpartitioning.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fmonomorphize%2Fpartitioning.rs?ref=e27f0298363f6ca60bb5761a8c74d52b3999a061", "patch": "@@ -494,6 +494,9 @@ fn merge_codegen_units<'tcx>(\n         for (k, v) in smallest.items_mut().drain() {\n             second_smallest.items_mut().insert(k, v);\n         }\n+        debug!(\"CodegenUnit {} merged in to CodegenUnit {}\",\n+               smallest.name(),\n+               second_smallest.name());\n     }\n \n     let cgu_name_builder = &mut CodegenUnitNameBuilder::new(tcx);\n@@ -774,18 +777,19 @@ where\n     if cfg!(debug_assertions) {\n         debug!(\"{}\", label);\n         for cgu in cgus {\n-            debug!(\"CodegenUnit {}:\", cgu.name());\n+            debug!(\"CodegenUnit {} estimated size {} :\", cgu.name(), cgu.size_estimate());\n \n             for (mono_item, linkage) in cgu.items() {\n                 let symbol_name = mono_item.symbol_name(tcx).name.as_str();\n                 let symbol_hash_start = symbol_name.rfind('h');\n                 let symbol_hash = symbol_hash_start.map(|i| &symbol_name[i ..])\n                                                    .unwrap_or(\"<no hash>\");\n \n-                debug!(\" - {} [{:?}] [{}]\",\n+                debug!(\" - {} [{:?}] [{}] estimated size {}\",\n                        mono_item.to_string(tcx, true),\n                        linkage,\n-                       symbol_hash);\n+                       symbol_hash,\n+                       mono_item.size_estimate(tcx));\n             }\n \n             debug!(\"\");"}]}