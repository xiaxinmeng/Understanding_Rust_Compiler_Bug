{"sha": "68c03cd386a52e0391402941e8b87c37f5f9924a", "node_id": "C_kwDOAAsO6NoAKDY4YzAzY2QzODZhNTJlMDM5MTQwMjk0MWU4Yjg3YzM3ZjVmOTkyNGE", "commit": {"author": {"name": "Chris Denton", "email": "christophersdenton@gmail.com", "date": "2022-03-19T14:55:59Z"}, "committer": {"name": "Chris Denton", "email": "christophersdenton@gmail.com", "date": "2022-03-19T15:09:36Z"}, "message": "Skip a test if symlink creation is not possible", "tree": {"sha": "97243b8c3afaf65be7ebab1171ce3fbdb8f31ad0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/97243b8c3afaf65be7ebab1171ce3fbdb8f31ad0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/68c03cd386a52e0391402941e8b87c37f5f9924a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE+p/jD6jrzmnSIWJLcTRy8vRWJ94FAmI18jEACgkQcTRy8vRW\nJ94qahAApsDgsGrEwi/aGGdxRqvcj0hsi/skHH1wVhfkPxU9Bb0qmSN0sHkel8sV\n17ZWPZ8UAcdZnPzsSUdX5Y1ClFItOg2CW7eZUwck0DBza9zhHz2gjIQeQU/7TSQ7\negel76vr2qNWTDT/UWeE7AQmuHDJociewT3eVJfWH5wQ6FrjLrjtq+vzktOlfR5B\nSYMi9CcoM41K0WG3/epuKbQ0sXCKjtFAn8V9Egzd5TvNn/VrH8JtRdCrUkz65lQs\n94W65WzmqjsEJfaaFb1qr+czVauvsk/58IihmnzLzVvZ9jKu0hvZpar8YONeaGII\nlXlyON72jw+0/q6nkZ4Ol88lFcCgfRa3uUF0wny53cSG2f18/uwr3WEOSn2+afQK\n6/++ei46qKOUgfVUG6L+NbLUyMeRKmNmWdx9TA9DN3Q9m+R9OcGxZCh+VLnfezJP\nL1yKbtfQYYgkaYgtjmFdp6a6IdCPIPokjIHrh6/nzOcy/igR+NuqJIjPWaqf8IzT\nEjS0VOaCQAfmo5aPV9xIuXzXY5boFIKjgJJWn2Wkzj70eAQOrbPPs5Lh8/gG2FXj\n0GTTnFucUahnAli6nO2TotE8tShYcV4ZCGbiN75oKVlI3iJYfvILDTIc/uMmZrvG\n9eIDYJjeMLSZqlgHfWRV65cjb6IPuA7G7S3a2+Rlrx/lG6zxNOU=\n=6HHb\n-----END PGP SIGNATURE-----", "payload": "tree 97243b8c3afaf65be7ebab1171ce3fbdb8f31ad0\nparent 31535841701e0bf7ef33998024376f2cedd8b3e3\nauthor Chris Denton <christophersdenton@gmail.com> 1647701759 +0000\ncommitter Chris Denton <christophersdenton@gmail.com> 1647702576 +0000\n\nSkip a test if symlink creation is not possible\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/68c03cd386a52e0391402941e8b87c37f5f9924a", "html_url": "https://github.com/rust-lang/rust/commit/68c03cd386a52e0391402941e8b87c37f5f9924a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/68c03cd386a52e0391402941e8b87c37f5f9924a/comments", "author": {"login": "ChrisDenton", "id": 4459874, "node_id": "MDQ6VXNlcjQ0NTk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4459874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChrisDenton", "html_url": "https://github.com/ChrisDenton", "followers_url": "https://api.github.com/users/ChrisDenton/followers", "following_url": "https://api.github.com/users/ChrisDenton/following{/other_user}", "gists_url": "https://api.github.com/users/ChrisDenton/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChrisDenton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChrisDenton/subscriptions", "organizations_url": "https://api.github.com/users/ChrisDenton/orgs", "repos_url": "https://api.github.com/users/ChrisDenton/repos", "events_url": "https://api.github.com/users/ChrisDenton/events{/privacy}", "received_events_url": "https://api.github.com/users/ChrisDenton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ChrisDenton", "id": 4459874, "node_id": "MDQ6VXNlcjQ0NTk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4459874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChrisDenton", "html_url": "https://github.com/ChrisDenton", "followers_url": "https://api.github.com/users/ChrisDenton/followers", "following_url": "https://api.github.com/users/ChrisDenton/following{/other_user}", "gists_url": "https://api.github.com/users/ChrisDenton/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChrisDenton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChrisDenton/subscriptions", "organizations_url": "https://api.github.com/users/ChrisDenton/orgs", "repos_url": "https://api.github.com/users/ChrisDenton/repos", "events_url": "https://api.github.com/users/ChrisDenton/events{/privacy}", "received_events_url": "https://api.github.com/users/ChrisDenton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "31535841701e0bf7ef33998024376f2cedd8b3e3", "url": "https://api.github.com/repos/rust-lang/rust/commits/31535841701e0bf7ef33998024376f2cedd8b3e3", "html_url": "https://github.com/rust-lang/rust/commit/31535841701e0bf7ef33998024376f2cedd8b3e3"}], "stats": {"total": 11, "additions": 9, "deletions": 2}, "files": [{"sha": "cd535afb4a338d6551fac02a7cd5871b5114278e", "filename": "library/std/src/sys/windows/process/tests.rs", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/68c03cd386a52e0391402941e8b87c37f5f9924a/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fprocess%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/68c03cd386a52e0391402941e8b87c37f5f9924a/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fprocess%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fprocess%2Ftests.rs?ref=68c03cd386a52e0391402941e8b87c37f5f9924a", "patch": "@@ -186,8 +186,15 @@ fn windows_exe_resolver() {\n     let temp = tmpdir();\n     let mut exe_path = temp.path().to_owned();\n     exe_path.push(\"exists.exe\");\n-    symlink(\"<DOES NOT EXIST>\".as_ref(), &exe_path).unwrap();\n \n     // A broken symlink should still be resolved.\n-    assert!(resolve_exe(OsStr::new(\"exists.exe\"), empty_paths, Some(temp.path().as_ref())).is_ok());\n+    // Skip this check if not in CI and creating symlinks isn't possible.\n+    let is_ci = env::var(\"CI\").is_ok();\n+    let result = symlink(\"<DOES NOT EXIST>\".as_ref(), &exe_path);\n+    if is_ci || result.is_ok() {\n+        result.unwrap();\n+        assert!(\n+            resolve_exe(OsStr::new(\"exists.exe\"), empty_paths, Some(temp.path().as_ref())).is_ok()\n+        );\n+    }\n }"}]}