{"sha": "af0059a4d145a2b46165731195300ee27323f819", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFmMDA1OWE0ZDE0NWEyYjQ2MTY1NzMxMTk1MzAwZWUyNzMyM2Y4MTk=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-01-11T21:04:13Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-01-11T21:04:13Z"}, "message": "Merge pull request #2798 from matklad/release-process\n\nTweak release workflow", "tree": {"sha": "7e3c9a283f375e29b0db589936c696574bda30af", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7e3c9a283f375e29b0db589936c696574bda30af"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/af0059a4d145a2b46165731195300ee27323f819", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJeGjhNCRBK7hj4Ov3rIwAAdHIIADK+kDDDcabudIz/zlGMjguI\n8Cbb2fpspwG07WokJkXBe2OpbHgOA3L+L77Nx1d6UsdKV0UK8n+wzBB4EjQsyZ2m\nASl5y55XtGIXx3n7udd/Fs8gmvTZZ5UGRhXzg9plk/CQhQtrUR2MwZGsyd+W2Ori\n0qeNf6AtlHaXmJ7ig9WIbqWyWRGQ75g/L+qe/wVdjTpcDucUQac7HTPUN3meCjJ4\nRx6qNz5pvG0Qc9GE+KwXTWB35AfNUiRWFfIYoxaB4H24au7Ebi8kb6BbLUdOijSJ\nKNfT3pJzXZ9QziQvHZY/Ac9yCvQtT3vUDs0brEDWhmRiMtugTEAozJVf66f+Qv0=\n=KYOY\n-----END PGP SIGNATURE-----\n", "payload": "tree 7e3c9a283f375e29b0db589936c696574bda30af\nparent 3924c7de505b591d3e1281857a61713fbe308d59\nparent 7e1a25f1499b2987cd98f8bd61ee00652deb09c2\nauthor Aleksey Kladov <aleksey.kladov@gmail.com> 1578776653 +0100\ncommitter GitHub <noreply@github.com> 1578776653 +0100\n\nMerge pull request #2798 from matklad/release-process\n\nTweak release workflow"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/af0059a4d145a2b46165731195300ee27323f819", "html_url": "https://github.com/rust-lang/rust/commit/af0059a4d145a2b46165731195300ee27323f819", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/af0059a4d145a2b46165731195300ee27323f819/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3924c7de505b591d3e1281857a61713fbe308d59", "url": "https://api.github.com/repos/rust-lang/rust/commits/3924c7de505b591d3e1281857a61713fbe308d59", "html_url": "https://github.com/rust-lang/rust/commit/3924c7de505b591d3e1281857a61713fbe308d59"}, {"sha": "7e1a25f1499b2987cd98f8bd61ee00652deb09c2", "url": "https://api.github.com/repos/rust-lang/rust/commits/7e1a25f1499b2987cd98f8bd61ee00652deb09c2", "html_url": "https://github.com/rust-lang/rust/commit/7e1a25f1499b2987cd98f8bd61ee00652deb09c2"}], "stats": {"total": 60, "additions": 15, "deletions": 45}, "files": [{"sha": "9c81dd97e2245c99a271bb7f7a8919a28e1d2711", "filename": ".github/workflows/ci.yaml", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/af0059a4d145a2b46165731195300ee27323f819/.github%2Fworkflows%2Fci.yaml", "raw_url": "https://github.com/rust-lang/rust/raw/af0059a4d145a2b46165731195300ee27323f819/.github%2Fworkflows%2Fci.yaml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fci.yaml?ref=af0059a4d145a2b46165731195300ee27323f819", "patch": "@@ -20,7 +20,6 @@ jobs:\n       RUN_SLOW_TESTS: 1\n       RUSTUP_MAX_RETRIES: 10\n       CARGO_NET_RETRY: 10\n-      PROFILE: debug\n     steps:\n \n       - name: Checkout repository\n@@ -76,7 +75,7 @@ jobs:\n \n       - name: Prepare cache 2\n         if: matrix.os == 'windows-latest'\n-        run: Remove-Item ./target/${{ env.PROFILE }}/xtask.exe\n+        run: Remove-Item ./target/debug/xtask.exe\n \n   type-script:\n     name: TypeScript"}, {"sha": "49d3ee0e9d59f50f1158fb520633082a3dbcff01", "filename": ".github/workflows/release.yaml", "status": "modified", "additions": 14, "deletions": 43, "changes": 57, "blob_url": "https://github.com/rust-lang/rust/blob/af0059a4d145a2b46165731195300ee27323f819/.github%2Fworkflows%2Frelease.yaml", "raw_url": "https://github.com/rust-lang/rust/raw/af0059a4d145a2b46165731195300ee27323f819/.github%2Fworkflows%2Frelease.yaml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Frelease.yaml?ref=af0059a4d145a2b46165731195300ee27323f819", "patch": "@@ -1,9 +1,8 @@\n name: CI-Release\n on:\n-  pull_request:\n   push:\n     branches:\n-      - master\n+      - release\n \n jobs:\n   rust:\n@@ -15,10 +14,8 @@ jobs:\n     env:\n       RUSTFLAGS: -D warnings\n       CARGO_INCREMENTAL: 0\n-      RUN_SLOW_TESTS: 1\n       RUSTUP_MAX_RETRIES: 10\n       CARGO_NET_RETRY: 10\n-      PROFILE: release\n     steps:\n \n       - name: Checkout repository\n@@ -40,47 +37,26 @@ jobs:\n           override: true\n           components: rustfmt, rust-src\n \n-      - name: Cache cargo registry\n-        uses: actions/cache@v1\n-        with:\n-          path: ~/.cargo/registry\n-          key: ${{ runner.os }}-cargo-registry-${{ hashFiles('**/Cargo.lock') }}\n-\n-      - name: Cache cargo index\n-        uses: actions/cache@v1\n-        with:\n-          path: ~/.cargo/git\n-          key: ${{ runner.os }}-cargo-index-${{ hashFiles('**/Cargo.lock') }}\n-\n-      - name: Cache cargo target dir\n-        uses: actions/cache@v1\n-        with:\n-          path: target\n-          key: ${{ runner.os }}-cargo-build-target-${{ hashFiles('**/Cargo.lock') }}\n-\n-      - name: Compile and Test\n+      - name: Build\n         uses: actions-rs/cargo@v1\n         with:\n-          command: test\n-          args: --release --all-targets\n+          command: build\n+          args: --release --package ra_lsp_server --bin ra_lsp_server\n \n-      - name: Prepare cache\n-        run: cargo xtask pre-cache\n+      - name: Strip symbols\n+        if: matrix.os == 'ubuntu-latest'\n+        run: strip ./target/release/ra_lsp_server\n \n-      - name: Prepare cache 2\n-        if: matrix.os == 'windows-latest'\n-        run: Remove-Item ./target/${{ env.PROFILE }}/xtask.exe\n-\n-      - name: Creat distribution dir\n+      - name: Create distribution dir\n         run: mkdir ./dist\n \n-      - name: Copy binaries (non-win)\n+      - name: Copy binaries (unix)\n         if: matrix.os != 'windows-latest'\n-        run: cp ./target/${{ env.PROFILE }}/ra_lsp_server ./dist\n+        run: cp ./target/release/ra_lsp_server ./dist\n \n       - name: Copy binaries (win)\n         if: matrix.os == 'windows-latest'\n-        run: copy ./target/${{ env.PROFILE }}/ra_lsp_server.* ./dist\n+        run: copy ./target/release/ra_lsp_server.exe ./dist\n \n       - name: Upload artifacts\n         uses: actions/upload-artifact@v1\n@@ -91,9 +67,6 @@ jobs:\n   type-script:\n     name: TypeScript\n     runs-on: ubuntu-latest\n-    env:\n-      CXX: g++-4.9\n-      CC: gcc-4.9\n     steps:\n       - name: Checkout repository\n         uses: actions/checkout@v1\n@@ -105,20 +78,18 @@ jobs:\n \n       - run: npm ci\n         working-directory: ./editors/code\n+\n       - run: npm run package --scripts-prepend-node-path\n         working-directory: ./editors/code\n \n-      - name: Create distribution directory\n-        run: mkdir ./dist\n-\n       - name: Copy vscode extension\n-        run: mkdir ./dist/code && cp ./editors/code/*.vsix ./dist/code/\n+        run: mkdir -p ./dist/code && cp ./editors/code/*.vsix ./dist/code/\n \n       - name: Copy emacs mode\n         run: cp -R ./editors/emacs ./dist/\n \n       - name: Upload artifacts\n         uses: actions/upload-artifact@v1\n         with:\n-          name: editors\n+          name: editor-plugins\n           path: ./dist"}]}