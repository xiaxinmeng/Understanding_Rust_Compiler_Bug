{"sha": "1e532189026671e883b5183ecc64671cf5c5af18", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFlNTMyMTg5MDI2NjcxZTg4M2I1MTgzZWNjNjQ2NzFjZjVjNWFmMTg=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2015-05-19T13:17:14Z"}, "committer": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2015-05-19T13:17:14Z"}, "message": "Rollup merge of #25551 - cllns:add-active-class-to-rustbook-toc, r=alexcrichton\n\nCurrently the table of contents for `rustbook` doesn't signify which page you are on.\r\n\r\nThis PR adds an 'active' class to the link for the current page, and defines the CSS rule for that class to make the link underlined and bold.\r\n\r\nNot sure about two things:\r\n1) Is `current_page` is a good name for the function parameter? At first I thought `current_item` would be good, but then in the `walk_item` function, you'd have `item` and `current_item`.\r\n\r\n2) For the CSS, is both bold and underline too much? At first I had it just be underlined, but that's also how the links look when they're hovered over.", "tree": {"sha": "2c6fa7e4551e0397ffe7561f3940b8bb02fc3a05", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2c6fa7e4551e0397ffe7561f3940b8bb02fc3a05"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1e532189026671e883b5183ecc64671cf5c5af18", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1e532189026671e883b5183ecc64671cf5c5af18", "html_url": "https://github.com/rust-lang/rust/commit/1e532189026671e883b5183ecc64671cf5c5af18", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1e532189026671e883b5183ecc64671cf5c5af18/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "392576b6d8f513a5deab2b8ce2c4560d1dc0dba8", "url": "https://api.github.com/repos/rust-lang/rust/commits/392576b6d8f513a5deab2b8ce2c4560d1dc0dba8", "html_url": "https://github.com/rust-lang/rust/commit/392576b6d8f513a5deab2b8ce2c4560d1dc0dba8"}, {"sha": "99868f6ba8c3afb56a92e144fe17bdbe018fa8ec", "url": "https://api.github.com/repos/rust-lang/rust/commits/99868f6ba8c3afb56a92e144fe17bdbe018fa8ec", "html_url": "https://github.com/rust-lang/rust/commit/99868f6ba8c3afb56a92e144fe17bdbe018fa8ec"}], "stats": {"total": 30, "additions": 21, "deletions": 9}, "files": [{"sha": "31c973214a1c944aac7d567dd312eb2fe693e45c", "filename": "src/rustbook/build.rs", "status": "modified", "additions": 16, "deletions": 9, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/1e532189026671e883b5183ecc64671cf5c5af18/src%2Frustbook%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1e532189026671e883b5183ecc64671cf5c5af18/src%2Frustbook%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustbook%2Fbuild.rs?ref=1e532189026671e883b5183ecc64671cf5c5af18", "patch": "@@ -37,27 +37,34 @@ pub fn parse_cmd(name: &str) -> Option<Box<Subcommand>> {\n     }\n }\n \n-fn write_toc(book: &Book, path_to_root: &Path, out: &mut Write) -> io::Result<()> {\n+fn write_toc(book: &Book, current_page: &BookItem, out: &mut Write) -> io::Result<()> {\n     fn walk_items(items: &[BookItem],\n                   section: &str,\n-                  path_to_root: &Path,\n+                  current_page: &BookItem,\n                   out: &mut Write) -> io::Result<()> {\n         for (i, item) in items.iter().enumerate() {\n-            try!(walk_item(item, &format!(\"{}{}.\", section, i + 1)[..], path_to_root, out));\n+            try!(walk_item(item, &format!(\"{}{}.\", section, i + 1)[..], current_page, out));\n         }\n         Ok(())\n     }\n     fn walk_item(item: &BookItem,\n                  section: &str,\n-                 path_to_root: &Path,\n+                 current_page: &BookItem,\n                  out: &mut Write) -> io::Result<()> {\n-        try!(writeln!(out, \"<li><a href='{}'><b>{}</b> {}</a>\",\n-                 path_to_root.join(&item.path.with_extension(\"html\")).display(),\n+        let class_string = if item.path == current_page.path {\n+          \"class='active'\"\n+        } else {\n+        \"\"\n+        };\n+\n+        try!(writeln!(out, \"<li><a {} href='{}'><b>{}</b> {}</a>\",\n+                 class_string,\n+                 item.path_to_root.join(&item.path.with_extension(\"html\")).display(),\n                  section,\n                  item.title));\n         if !item.children.is_empty() {\n             try!(writeln!(out, \"<ul class='section'>\"));\n-            let _ = walk_items(&item.children[..], section, path_to_root, out);\n+            let _ = walk_items(&item.children[..], section, current_page, out);\n             try!(writeln!(out, \"</ul>\"));\n         }\n         try!(writeln!(out, \"</li>\"));\n@@ -67,7 +74,7 @@ fn write_toc(book: &Book, path_to_root: &Path, out: &mut Write) -> io::Result<()\n \n     try!(writeln!(out, \"<div id='toc' class='mobile-hidden'>\"));\n     try!(writeln!(out, \"<ul class='chapter'>\"));\n-    try!(walk_items(&book.chapters[..], \"\", path_to_root, out));\n+    try!(walk_items(&book.chapters[..], \"\", &current_page, out));\n     try!(writeln!(out, \"</ul>\"));\n     try!(writeln!(out, \"</div>\"));\n \n@@ -115,7 +122,7 @@ fn render(book: &Book, tgt: &Path) -> CliResult<()> {\n                   <span class=\"bar\"></span>\n                 </button>\n               </div>\"#));\n-            let _ = write_toc(book, &item.path_to_root, &mut toc);\n+            let _ = write_toc(book, &item, &mut toc);\n             try!(writeln!(&mut toc, \"<div id='page-wrapper'>\"));\n             try!(writeln!(&mut toc, \"<div id='page'>\"));\n         }"}, {"sha": "aae5f21a73dc653f0e7b7e37bde2095ae0a2f666", "filename": "src/rustbook/css.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/1e532189026671e883b5183ecc64671cf5c5af18/src%2Frustbook%2Fcss.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1e532189026671e883b5183ecc64671cf5c5af18/src%2Frustbook%2Fcss.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustbook%2Fcss.rs?ref=1e532189026671e883b5183ecc64671cf5c5af18", "patch": "@@ -97,6 +97,11 @@ body {\n     color: #000000;\n }\n \n+.chapter li a.active {\n+    text-decoration: underline;\n+    font-weight: bold;\n+}\n+\n #toggle-nav {\n     height: 20px;\n     width:  30px;"}]}