{"sha": "416889f499f94ff78334618702e4aa37c8b78679", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQxNjg4OWY0OTlmOTRmZjc4MzM0NjE4NzAyZTRhYTM3YzhiNzg2Nzk=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2017-03-10T22:51:24Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2017-03-11T00:18:27Z"}, "message": "Rollup merge of #40277 - rkruppe:llvm-parallel-link-jobs, r=alexcrichton\n\nrustbuild: expose LLVM_PARALLEL_LINK_JOBS\n\nThis allows limiting the number of linker jobs to avoid swapping when linking LLVM with debug info.", "tree": {"sha": "fe51b5598a37e055e865d8d555450ee5cbf6a65e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fe51b5598a37e055e865d8d555450ee5cbf6a65e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/416889f499f94ff78334618702e4aa37c8b78679", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/416889f499f94ff78334618702e4aa37c8b78679", "html_url": "https://github.com/rust-lang/rust/commit/416889f499f94ff78334618702e4aa37c8b78679", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/416889f499f94ff78334618702e4aa37c8b78679/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0ce745bc305bb210f5ddaf60801b47fafb84b986", "url": "https://api.github.com/repos/rust-lang/rust/commits/0ce745bc305bb210f5ddaf60801b47fafb84b986", "html_url": "https://github.com/rust-lang/rust/commit/0ce745bc305bb210f5ddaf60801b47fafb84b986"}, {"sha": "58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd", "url": "https://api.github.com/repos/rust-lang/rust/commits/58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd", "html_url": "https://github.com/rust-lang/rust/commit/58ff4f67e3a1d099d3c4cb8ccb554ee9fd0a16cd"}], "stats": {"total": 17, "additions": 17, "deletions": 0}, "files": [{"sha": "87c35e0502ce6d853ce5ad0ff95e1668b9bacead", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/416889f499f94ff78334618702e4aa37c8b78679/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/416889f499f94ff78334618702e4aa37c8b78679/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=416889f499f94ff78334618702e4aa37c8b78679", "patch": "@@ -59,6 +59,7 @@ pub struct Config {\n     pub llvm_static_stdcpp: bool,\n     pub llvm_link_shared: bool,\n     pub llvm_targets: Option<String>,\n+    pub llvm_link_jobs: Option<u32>,\n \n     // rust codegen options\n     pub rust_optimize: bool,\n@@ -179,6 +180,7 @@ struct Llvm {\n     version_check: Option<bool>,\n     static_libstdcpp: Option<bool>,\n     targets: Option<String>,\n+    link_jobs: Option<u32>,\n }\n \n #[derive(RustcDecodable, Default, Clone)]\n@@ -333,6 +335,7 @@ impl Config {\n             set(&mut config.llvm_version_check, llvm.version_check);\n             set(&mut config.llvm_static_stdcpp, llvm.static_libstdcpp);\n             config.llvm_targets = llvm.targets.clone();\n+            config.llvm_link_jobs = llvm.link_jobs;\n         }\n \n         if let Some(ref rust) = toml.rust {"}, {"sha": "776bd729119e24458de1038d90252139159420a4", "filename": "src/bootstrap/config.toml.example", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/416889f499f94ff78334618702e4aa37c8b78679/src%2Fbootstrap%2Fconfig.toml.example", "raw_url": "https://github.com/rust-lang/rust/raw/416889f499f94ff78334618702e4aa37c8b78679/src%2Fbootstrap%2Fconfig.toml.example", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.toml.example?ref=416889f499f94ff78334618702e4aa37c8b78679", "patch": "@@ -53,6 +53,14 @@\n # Rust team and file an issue if you need assistance in porting!\n #targets = \"X86;ARM;AArch64;Mips;PowerPC;SystemZ;JSBackend;MSP430;Sparc;NVPTX\"\n \n+# Cap the number of parallel linker invocations when compiling LLVM.\n+# This can be useful when building LLVM with debug info, which significantly\n+# increases the size of binaries and consequently the memory required by\n+# each linker process.\n+# If absent or 0, linker invocations are treated like any other job and\n+# controlled by rustbuild's -j parameter.\n+#link-jobs = 0\n+\n # =============================================================================\n # General build configuration options\n # ============================================================================="}, {"sha": "c13235b9c76804cb9bbb572091307b894c7e4f24", "filename": "src/bootstrap/native.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/416889f499f94ff78334618702e4aa37c8b78679/src%2Fbootstrap%2Fnative.rs", "raw_url": "https://github.com/rust-lang/rust/raw/416889f499f94ff78334618702e4aa37c8b78679/src%2Fbootstrap%2Fnative.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fnative.rs?ref=416889f499f94ff78334618702e4aa37c8b78679", "patch": "@@ -115,6 +115,12 @@ pub fn llvm(build: &Build, target: &str) {\n         cfg.define(\"LLVM_BUILD_32_BITS\", \"ON\");\n     }\n \n+    if let Some(num_linkers) = build.config.llvm_link_jobs {\n+        if num_linkers > 0 {\n+            cfg.define(\"LLVM_PARALLEL_LINK_JOBS\", num_linkers.to_string());\n+        }\n+    }\n+\n     // http://llvm.org/docs/HowToCrossCompileLLVM.html\n     if target != build.config.build {\n         // FIXME: if the llvm root for the build triple is overridden then we"}]}