{"sha": "e721f5e083d46853714e79c3c33eb492736cc189", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU3MjFmNWUwODNkNDY4NTM3MTRlNzljM2MzM2ViNDkyNzM2Y2MxODk=", "commit": {"author": {"name": "QuietMisdreavus", "email": "grey@quietmisdreavus.net", "date": "2019-03-06T16:16:41Z"}, "committer": {"name": "QuietMisdreavus", "email": "grey@quietmisdreavus.net", "date": "2019-03-06T16:16:41Z"}, "message": "don't process `external_traits` when collecting intra-doc links", "tree": {"sha": "6e0d5495305d910316bea517e769ebb177d8eae4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6e0d5495305d910316bea517e769ebb177d8eae4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e721f5e083d46853714e79c3c33eb492736cc189", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e721f5e083d46853714e79c3c33eb492736cc189", "html_url": "https://github.com/rust-lang/rust/commit/e721f5e083d46853714e79c3c33eb492736cc189", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e721f5e083d46853714e79c3c33eb492736cc189/comments", "author": {"login": "QuietMisdreavus", "id": 5217170, "node_id": "MDQ6VXNlcjUyMTcxNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/5217170?v=4", "gravatar_id": "", "url": "https://api.github.com/users/QuietMisdreavus", "html_url": "https://github.com/QuietMisdreavus", "followers_url": "https://api.github.com/users/QuietMisdreavus/followers", "following_url": "https://api.github.com/users/QuietMisdreavus/following{/other_user}", "gists_url": "https://api.github.com/users/QuietMisdreavus/gists{/gist_id}", "starred_url": "https://api.github.com/users/QuietMisdreavus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/QuietMisdreavus/subscriptions", "organizations_url": "https://api.github.com/users/QuietMisdreavus/orgs", "repos_url": "https://api.github.com/users/QuietMisdreavus/repos", "events_url": "https://api.github.com/users/QuietMisdreavus/events{/privacy}", "received_events_url": "https://api.github.com/users/QuietMisdreavus/received_events", "type": "User", "site_admin": false}, "committer": {"login": "QuietMisdreavus", "id": 5217170, "node_id": "MDQ6VXNlcjUyMTcxNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/5217170?v=4", "gravatar_id": "", "url": "https://api.github.com/users/QuietMisdreavus", "html_url": "https://github.com/QuietMisdreavus", "followers_url": "https://api.github.com/users/QuietMisdreavus/followers", "following_url": "https://api.github.com/users/QuietMisdreavus/following{/other_user}", "gists_url": "https://api.github.com/users/QuietMisdreavus/gists{/gist_id}", "starred_url": "https://api.github.com/users/QuietMisdreavus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/QuietMisdreavus/subscriptions", "organizations_url": "https://api.github.com/users/QuietMisdreavus/orgs", "repos_url": "https://api.github.com/users/QuietMisdreavus/repos", "events_url": "https://api.github.com/users/QuietMisdreavus/events{/privacy}", "received_events_url": "https://api.github.com/users/QuietMisdreavus/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1999a2288123173b2e487865c9a04386173025f7", "url": "https://api.github.com/repos/rust-lang/rust/commits/1999a2288123173b2e487865c9a04386173025f7", "html_url": "https://github.com/rust-lang/rust/commit/1999a2288123173b2e487865c9a04386173025f7"}], "stats": {"total": 10, "additions": 10, "deletions": 0}, "files": [{"sha": "93e811f8b31d8aef1ec1b53f9ba1fdc68d5400dd", "filename": "src/librustdoc/passes/collect_intra_doc_links.rs", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/e721f5e083d46853714e79c3c33eb492736cc189/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e721f5e083d46853714e79c3c33eb492736cc189/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs?ref=e721f5e083d46853714e79c3c33eb492736cc189", "patch": "@@ -213,6 +213,7 @@ impl<'a, 'tcx, 'rcx> LinkCollector<'a, 'tcx, 'rcx> {\n                 _ => Err(())\n             }\n         } else {\n+            debug!(\"attempting to resolve item without parent module: {}\", path_str);\n             Err(())\n         }\n     }\n@@ -434,6 +435,15 @@ impl<'a, 'tcx, 'rcx> DocFolder for LinkCollector<'a, 'tcx, 'rcx> {\n             self.fold_item_recur(item)\n         }\n     }\n+\n+    // FIXME: if we can resolve intra-doc links from other crates, we can use the stock\n+    // `fold_crate`, but until then we should avoid scanning `krate.external_traits` since those\n+    // will never resolve properly\n+    fn fold_crate(&mut self, mut c: Crate) -> Crate {\n+        c.module = c.module.take().and_then(|module| self.fold_item(module));\n+\n+        c\n+    }\n }\n \n /// Resolves a string as a macro."}]}