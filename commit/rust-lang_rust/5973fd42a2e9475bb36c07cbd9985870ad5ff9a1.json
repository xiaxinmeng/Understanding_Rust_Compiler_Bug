{"sha": "5973fd42a2e9475bb36c07cbd9985870ad5ff9a1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU5NzNmZDQyYTJlOTQ3NWJiMzZjMDdjYmQ5OTg1ODcwYWQ1ZmY5YTE=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-10-12T15:39:13Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-10-12T15:39:13Z"}, "message": "build-manifest: stop generating numbered channel names except for stable\n\nThis fixes numbered channel names being created for the nightly channel,\nand once the root cause of this rides the trains, for beta.", "tree": {"sha": "809b0533b3a0751caac64f7df7adfee9428325d4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/809b0533b3a0751caac64f7df7adfee9428325d4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5973fd42a2e9475bb36c07cbd9985870ad5ff9a1", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE1JbYPtLJAsc22U9xPgar6Auq8ZwFAl+EeOsACgkQPgar6Auq\n8ZybbA//VJfeH/RFdSYE8BpoMdmCcTGDxkFW9Y2OvGv1LHYJWOup5cy/cRhbtnkz\nEMAz7BRbsGG966dyRdN4zy7l4Bdo8ISOY251PFI8Yf32E3ag8mizgObvekqChjhb\nDqOuFYaEdgPCggxYnhTRd8cOQj/LKYuwagCzPh+IL6pwgi7lKzJbSDxQ/EhqhnPt\nyBOwp8p/wBH53z3b2V7gB4fmMi/6nkfR4rWwqlxwgOJrrFMa4Vje0Ky4n3gWz+92\nbCxtQpAuJNMLyaU/FxUQPXkUt3v4XP0064lHCI6x68EPOj5v03yR4kb9ioxjVHBl\nT5sAixLCIT68XwYrJt5CiNdC5B0lVk8akY4jsz/x6wZGcE/XNGnFNVLZlQMDjEYL\nCPblPmfvbKrH4voKG8YddwFDqKdOL97SCgNydfQJuiCUBQKbMK8wic9uPcWWRNrt\njh4C/U9xJPH1+4ZKhzrB4DlkmLw8ipgp7FzuRzeO9NC8cNeqbAWyfPRVnNNrMnd1\n3di7UtRC+9ZSUKuCmeChW88oTjjkfpwlo6WK/qGKDO4qLbl8YykFcGuxIjwEiEIK\ngGKzdL4YKiFxarKXOf7Uss3GGujCL27b6BY8TLkfQfD8DqUaCa4Pl09I6jOueTL6\nruj/TCRaKErHcB7umXdt7WAiE3bjVzhARYj1yZoRn9T2KOScVq8=\n=xzs/\n-----END PGP SIGNATURE-----", "payload": "tree 809b0533b3a0751caac64f7df7adfee9428325d4\nparent d6b5ffb5b41579dbc49e651691fa9bb670a39a07\nauthor Pietro Albini <pietro@pietroalbini.org> 1602517153 +0200\ncommitter Pietro Albini <pietro@pietroalbini.org> 1602517153 +0200\n\nbuild-manifest: stop generating numbered channel names except for stable\n\nThis fixes numbered channel names being created for the nightly channel,\nand once the root cause of this rides the trains, for beta.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5973fd42a2e9475bb36c07cbd9985870ad5ff9a1", "html_url": "https://github.com/rust-lang/rust/commit/5973fd42a2e9475bb36c07cbd9985870ad5ff9a1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5973fd42a2e9475bb36c07cbd9985870ad5ff9a1/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d6b5ffb5b41579dbc49e651691fa9bb670a39a07", "url": "https://api.github.com/repos/rust-lang/rust/commits/d6b5ffb5b41579dbc49e651691fa9bb670a39a07", "html_url": "https://github.com/rust-lang/rust/commit/d6b5ffb5b41579dbc49e651691fa9bb670a39a07"}], "stats": {"total": 9, "additions": 5, "deletions": 4}, "files": [{"sha": "7ee28cd6e5d95caf8985a6bdbc610c9699988fe7", "filename": "src/tools/build-manifest/src/main.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/5973fd42a2e9475bb36c07cbd9985870ad5ff9a1/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5973fd42a2e9475bb36c07cbd9985870ad5ff9a1/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs?ref=5973fd42a2e9475bb36c07cbd9985870ad5ff9a1", "patch": "@@ -252,12 +252,13 @@ impl Builder {\n         }\n         let manifest = self.build_manifest();\n \n-        let rust_version = self.versions.rustc_version();\n         self.write_channel_files(self.versions.channel(), &manifest);\n-        if self.versions.channel() != rust_version {\n-            self.write_channel_files(&rust_version, &manifest);\n-        }\n         if self.versions.channel() == \"stable\" {\n+            // channel-rust-1.XX.YY.toml\n+            let rust_version = self.versions.rustc_version();\n+            self.write_channel_files(rust_version, &manifest);\n+\n+            // channel-rust-1.XX.toml\n             let major_minor = rust_version.split('.').take(2).collect::<Vec<_>>().join(\".\");\n             self.write_channel_files(&major_minor, &manifest);\n         }"}]}