{"sha": "d2cd57c8ff2116c2120da2668cee4ff2bf28315c", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQyY2Q1N2M4ZmYyMTE2YzIxMjBkYTI2NjhjZWU0ZmYyYmYyODMxNWM=", "commit": {"author": {"name": "gnzlbg", "email": "gonzalobg88@gmail.com", "date": "2018-03-22T08:49:46Z"}, "committer": {"name": "gnzlbg", "email": "gonzalobg88@gmail.com", "date": "2018-03-26T08:20:41Z"}, "message": "add tests", "tree": {"sha": "87f64331b76115532bddc29abf51d4ebd4f2c268", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/87f64331b76115532bddc29abf51d4ebd4f2c268"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d2cd57c8ff2116c2120da2668cee4ff2bf28315c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d2cd57c8ff2116c2120da2668cee4ff2bf28315c", "html_url": "https://github.com/rust-lang/rust/commit/d2cd57c8ff2116c2120da2668cee4ff2bf28315c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d2cd57c8ff2116c2120da2668cee4ff2bf28315c/comments", "author": {"login": "gnzlbg", "id": 904614, "node_id": "MDQ6VXNlcjkwNDYxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gnzlbg", "html_url": "https://github.com/gnzlbg", "followers_url": "https://api.github.com/users/gnzlbg/followers", "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}", "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}", "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions", "organizations_url": "https://api.github.com/users/gnzlbg/orgs", "repos_url": "https://api.github.com/users/gnzlbg/repos", "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}", "received_events_url": "https://api.github.com/users/gnzlbg/received_events", "type": "User", "site_admin": false}, "committer": {"login": "gnzlbg", "id": 904614, "node_id": "MDQ6VXNlcjkwNDYxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gnzlbg", "html_url": "https://github.com/gnzlbg", "followers_url": "https://api.github.com/users/gnzlbg/followers", "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}", "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}", "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions", "organizations_url": "https://api.github.com/users/gnzlbg/orgs", "repos_url": "https://api.github.com/users/gnzlbg/repos", "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}", "received_events_url": "https://api.github.com/users/gnzlbg/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7d5343a6700581e318189dcd74567b348bd7f68d", "url": "https://api.github.com/repos/rust-lang/rust/commits/7d5343a6700581e318189dcd74567b348bd7f68d", "html_url": "https://github.com/rust-lang/rust/commit/7d5343a6700581e318189dcd74567b348bd7f68d"}], "stats": {"total": 95, "additions": 95, "deletions": 0}, "files": [{"sha": "bebb4d379830e17af789561493ca87cc360002b9", "filename": "src/test/codegen/simd-intrinsic-float-minmax.rs", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/d2cd57c8ff2116c2120da2668cee4ff2bf28315c/src%2Ftest%2Fcodegen%2Fsimd-intrinsic-float-minmax.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d2cd57c8ff2116c2120da2668cee4ff2bf28315c/src%2Ftest%2Fcodegen%2Fsimd-intrinsic-float-minmax.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Fsimd-intrinsic-float-minmax.rs?ref=d2cd57c8ff2116c2120da2668cee4ff2bf28315c", "patch": "@@ -0,0 +1,40 @@\n+// Copyright 2016 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// compile-flags: -C no-prepopulate-passes\n+\n+#![crate_type = \"lib\"]\n+\n+#![feature(repr_simd, platform_intrinsics)]\n+#[allow(non_camel_case_types)]\n+\n+#[repr(simd)]\n+#[derive(Copy, Clone, PartialEq, Debug)]\n+pub struct f32x4(pub f32, pub f32, pub f32, pub f32);\n+\n+extern \"platform-intrinsic\" {\n+    fn simd_fmin<T>(x: T, y: T) -> T;\n+    fn simd_fmax<T>(x: T, y: T) -> T;\n+}\n+\n+// CHECK-LABEL: @fmin\n+#[no_mangle]\n+pub unsafe fn fmin(a: f32x4, b: f32x4) -> f32x4 {\n+    // CHECK: call <4 x float> @llvm.minnum.v4f32\n+    simd_fmin(a, b)\n+}\n+\n+// FIXME(49261)\n+// // CHECK-LABEL: @fmax\n+// #[no_mangle]\n+// pub unsafe fn fmax(a: f32x4, b: f32x4) -> f32x4 {\n+// // CHECK: call <4 x float> @llvm.maxnum.v4f32\n+//     simd_fmax(a, b)\n+// }"}, {"sha": "32ee569d8fad7f4156497be74b8a3f74ddec6328", "filename": "src/test/run-fail/simd-intrinsic-float-minmax.rs", "status": "added", "additions": 55, "deletions": 0, "changes": 55, "blob_url": "https://github.com/rust-lang/rust/blob/d2cd57c8ff2116c2120da2668cee4ff2bf28315c/src%2Ftest%2Frun-fail%2Fsimd-intrinsic-float-minmax.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d2cd57c8ff2116c2120da2668cee4ff2bf28315c/src%2Ftest%2Frun-fail%2Fsimd-intrinsic-float-minmax.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-fail%2Fsimd-intrinsic-float-minmax.rs?ref=d2cd57c8ff2116c2120da2668cee4ff2bf28315c", "patch": "@@ -0,0 +1,55 @@\n+// Copyright 2015 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// ignore-emscripten\n+\n+// Test that the simd_f{min,max} intrinsics produce the correct results.\n+\n+#![feature(repr_simd, platform_intrinsics)]\n+#[allow(non_camel_case_types)]\n+\n+#[repr(simd)]\n+#[derive(Copy, Clone, PartialEq, Debug)]\n+struct f32x4(pub f32, pub f32, pub f32, pub f32);\n+\n+extern \"platform-intrinsic\" {\n+    fn simd_fmin<T>(x: T, y: T) -> T;\n+    fn simd_fmax<T>(x: T, y: T) -> T;\n+}\n+\n+fn main() {\n+    let x = f32x4(1.0, 2.0, 3.0, 4.0);\n+    let y = f32x4(2.0, 1.0, 4.0, 3.0);\n+    let nan = ::std::f32::NAN;\n+    let n = f32x4(nan, nan, nan, nan);\n+\n+    unsafe {\n+        let min0 = simd_fmin(x, y);\n+        let min1 = simd_fmin(y, x);\n+        assert_eq!(min0, min1);\n+        let e = f32x4(1.0, 1.0, 3.0, 3.0);\n+        assert_eq!(min0, e);\n+        let minn = simd_fmin(x, n);\n+        assert_eq!(minn, x);\n+        let minn = simd_fmin(y, n);\n+        assert_eq!(minn, y);\n+\n+        // FIXME(49261)\n+        let max0 = simd_fmax(x, y);\n+        let max1 = simd_fmax(y, x);\n+        assert_eq!(max0, max1);\n+        let e = f32x4(2.0, 2.0, 4.0, 4.0);\n+        assert_eq!(max0, e);\n+        let maxn = simd_fmax(x, n);\n+        assert_eq!(maxn, x);\n+        let maxn = simd_fmax(y, n);\n+        assert_eq!(maxn, y);\n+    }\n+}"}]}