{"sha": "799648a61f64d6254fcc9538a64ffe372ccda5f1", "node_id": "C_kwDOAAsO6NoAKDc5OTY0OGE2MWY2NGQ2MjU0ZmNjOTUzOGE2NGZmZTM3MmNjZGE1ZjE", "commit": {"author": {"name": "Dylan DPC", "email": "99973273+Dylan-DPC@users.noreply.github.com", "date": "2022-11-08T05:53:52Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-11-08T05:53:52Z"}, "message": "Rollup merge of #103955 - str4d:update-lto-doc-1.65, r=ehuss\n\nUpdate linker-plugin-lto.md to contain up to Rust 1.65\n\nThe table rows were obtained via the script embedded in the page.", "tree": {"sha": "512fc823a37f95ad8ef2e6868568f0e5dbd6538f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/512fc823a37f95ad8ef2e6868568f0e5dbd6538f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/799648a61f64d6254fcc9538a64ffe372ccda5f1", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjae7wCRBK7hj4Ov3rIwAAJ3cIAHIVls1GsKHkVG1aZNsbJKR2\nMY0HETs8AOJ0M4aU4+Q6p8OGVbRP7xGkHBjUd8MHleIGtCA5NxFumcX4ViH8Gn02\n0SOQ/L98L155E6FlQqvb7S6tQsJGegxMacY7Rp6TE2vIKcnCsrEr6cDPsFL9laHs\nf8LJVopUGnUTi441VzGsoraBWFen8OYOcQ0PDi+J6Hk1LaS8sPSNk/v1OFZx/Gt1\nI66cJVZcrRdoRzRXJUgQAv2RVjmNYjgk1N+6sZDvnZ7lHfA9AZ+IF4NXn2ZPLtXv\nm6+VnZlNBJA/Dc64Bxm3IoxXcTsWdx84haaPEYRcSB6Ulh4lUcCn7IWvzHQbRWk=\n=rexl\n-----END PGP SIGNATURE-----\n", "payload": "tree 512fc823a37f95ad8ef2e6868568f0e5dbd6538f\nparent 77a44ab56895da184f2c732115d7f86954b930c7\nparent ee7a80211a066b8345119ce258361a8ad22986b4\nauthor Dylan DPC <99973273+Dylan-DPC@users.noreply.github.com> 1667886832 +0530\ncommitter GitHub <noreply@github.com> 1667886832 +0530\n\nRollup merge of #103955 - str4d:update-lto-doc-1.65, r=ehuss\n\nUpdate linker-plugin-lto.md to contain up to Rust 1.65\n\nThe table rows were obtained via the script embedded in the page.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/799648a61f64d6254fcc9538a64ffe372ccda5f1", "html_url": "https://github.com/rust-lang/rust/commit/799648a61f64d6254fcc9538a64ffe372ccda5f1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/799648a61f64d6254fcc9538a64ffe372ccda5f1/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "77a44ab56895da184f2c732115d7f86954b930c7", "url": "https://api.github.com/repos/rust-lang/rust/commits/77a44ab56895da184f2c732115d7f86954b930c7", "html_url": "https://github.com/rust-lang/rust/commit/77a44ab56895da184f2c732115d7f86954b930c7"}, {"sha": "ee7a80211a066b8345119ce258361a8ad22986b4", "url": "https://api.github.com/repos/rust-lang/rust/commits/ee7a80211a066b8345119ce258361a8ad22986b4", "html_url": "https://github.com/rust-lang/rust/commit/ee7a80211a066b8345119ce258361a8ad22986b4"}], "stats": {"total": 94, "additions": 49, "deletions": 45}, "files": [{"sha": "9272b9ac9b2d45be95b2278b97dc36b0b5c00446", "filename": "src/doc/rustc/src/linker-plugin-lto.md", "status": "modified", "additions": 49, "deletions": 45, "changes": 94, "blob_url": "https://github.com/rust-lang/rust/blob/799648a61f64d6254fcc9538a64ffe372ccda5f1/src%2Fdoc%2Frustc%2Fsrc%2Flinker-plugin-lto.md", "raw_url": "https://github.com/rust-lang/rust/raw/799648a61f64d6254fcc9538a64ffe372ccda5f1/src%2Fdoc%2Frustc%2Fsrc%2Flinker-plugin-lto.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Flinker-plugin-lto.md?ref=799648a61f64d6254fcc9538a64ffe372ccda5f1", "patch": "@@ -131,24 +131,47 @@ able to get around this problem by setting `-Clinker=lld-link` in RUSTFLAGS\n \n ## Toolchain Compatibility\n \n-<!-- NOTE: to update the below table, you can use this shell script:\n-\n-```sh\n-rustup toolchain install --profile minimal nightly\n-MINOR_VERSION=$(rustc +nightly --version | cut -d . -f 2)\n-LOWER_BOUND=61\n-\n-llvm_version() {\n-    toolchain=\"$1\"\n-    printf \"Rust $toolchain    |    Clang \"\n-    rustc +\"$toolchain\" -Vv | grep LLVM | cut -d ':' -f 2 | tr -d ' '\n-}\n-\n-for version in `seq $LOWER_BOUND $((MINOR_VERSION - 2))`; do\n-    toolchain=1.$version.0\n-    rustup toolchain install --no-self-update --profile  minimal $toolchain >/dev/null 2>&1\n-    llvm_version $toolchain\n-done\n+<!-- NOTE: to update the below table, you can use this Python script:\n+\n+```python\n+from collections import defaultdict\n+import subprocess\n+\n+def minor_version(version):\n+    return int(version.split('.')[1])\n+\n+INSTALL_TOOLCHAIN = [\"rustup\", \"toolchain\", \"install\", \"--profile\", \"minimal\"]\n+subprocess.run(INSTALL_TOOLCHAIN + [\"nightly\"])\n+\n+LOWER_BOUND = 65\n+NIGHTLY_VERSION = minor_version(subprocess.run(\n+    [\"rustc\", \"+nightly\", \"--version\"],\n+    capture_output=True,\n+    text=True).stdout)\n+\n+def llvm_version(toolchain):\n+    version_text = subprocess.run(\n+        [\"rustc\", \"+{}\".format(toolchain), \"-Vv\"],\n+        capture_output=True,\n+        text=True).stdout\n+    return int(version_text.split(\"LLVM\")[1].split(':')[1].split('.')[0])\n+\n+version_map = defaultdict(lambda: [])\n+for version in range(LOWER_BOUND, NIGHTLY_VERSION - 1):\n+    toolchain = \"1.{}.0\".format(version)\n+    subprocess.run(\n+        INSTALL_TOOLCHAIN + [\"--no-self-update\", toolchain],\n+        capture_output=True)\n+    version_map[llvm_version(toolchain)].append(version)\n+\n+print(\"| Rust Version | Clang Version |\")\n+print(\"|--------------|---------------|\")\n+for clang, rust in sorted(version_map.items()):\n+    if len(rust) > 1:\n+        rust_range = \"1.{} - 1.{}\".format(rust[0], rust[-1])\n+    else:\n+        rust_range = \"1.{}       \".format(rust[0])\n+    print(\"| {}  |      {}       |\".format(rust_range, clang))\n ```\n \n -->\n@@ -166,32 +189,13 @@ The following table shows known good combinations of toolchain versions.\n \n | Rust Version | Clang Version |\n |--------------|---------------|\n-| Rust 1.34    |    Clang 8    |\n-| Rust 1.35    |    Clang 8    |\n-| Rust 1.36    |    Clang 8    |\n-| Rust 1.37    |    Clang 8    |\n-| Rust 1.38    |    Clang 9    |\n-| Rust 1.39    |    Clang 9    |\n-| Rust 1.40    |    Clang 9    |\n-| Rust 1.41    |    Clang 9    |\n-| Rust 1.42    |    Clang 9    |\n-| Rust 1.43    |    Clang 9    |\n-| Rust 1.44    |    Clang 9    |\n-| Rust 1.45    |    Clang 10   |\n-| Rust 1.46    |    Clang 10   |\n-| Rust 1.47    |    Clang 11   |\n-| Rust 1.48    |    Clang 11   |\n-| Rust 1.49    |    Clang 11   |\n-| Rust 1.50    |    Clang 11   |\n-| Rust 1.51    |    Clang 11   |\n-| Rust 1.52    |    Clang 12   |\n-| Rust 1.53    |    Clang 12   |\n-| Rust 1.54    |    Clang 12   |\n-| Rust 1.55    |    Clang 12   |\n-| Rust 1.56    |    Clang 13   |\n-| Rust 1.57    |    Clang 13   |\n-| Rust 1.58    |    Clang 13   |\n-| Rust 1.59    |    Clang 13   |\n-| Rust 1.60    |    Clang 14   |\n+| 1.34 - 1.37  |       8       |\n+| 1.38 - 1.44  |       9       |\n+| 1.45 - 1.46  |      10       |\n+| 1.47 - 1.51  |      11       |\n+| 1.52 - 1.55  |      12       |\n+| 1.56 - 1.59  |      13       |\n+| 1.60 - 1.64  |      14       |\n+| 1.65         |      15       |\n \n Note that the compatibility policy for this feature might change in the future."}]}