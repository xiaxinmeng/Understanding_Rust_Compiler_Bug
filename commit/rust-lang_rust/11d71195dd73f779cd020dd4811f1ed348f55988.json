{"sha": "11d71195dd73f779cd020dd4811f1ed348f55988", "node_id": "MDY6Q29tbWl0NzI0NzEyOjExZDcxMTk1ZGQ3M2Y3NzljZDAyMGRkNDgxMWYxZWQzNDhmNTU5ODg=", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2019-07-19T16:03:55Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2019-07-19T16:03:55Z"}, "message": "fix miri-rustc-tests", "tree": {"sha": "454298bba7b2c5f9ac050fa50861af3d8d2b4d21", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/454298bba7b2c5f9ac050fa50861af3d8d2b4d21"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/11d71195dd73f779cd020dd4811f1ed348f55988", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/11d71195dd73f779cd020dd4811f1ed348f55988", "html_url": "https://github.com/rust-lang/rust/commit/11d71195dd73f779cd020dd4811f1ed348f55988", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/11d71195dd73f779cd020dd4811f1ed348f55988/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "66ca0f2cc214368c1b4364a4dc941ec95a7b2d03", "url": "https://api.github.com/repos/rust-lang/rust/commits/66ca0f2cc214368c1b4364a4dc941ec95a7b2d03", "html_url": "https://github.com/rust-lang/rust/commit/66ca0f2cc214368c1b4364a4dc941ec95a7b2d03"}], "stats": {"total": 10, "additions": 5, "deletions": 5}, "files": [{"sha": "dae5189937a3381b2cd409e0e89465d2b12f0f26", "filename": "src/bin/miri-rustc-tests.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/11d71195dd73f779cd020dd4811f1ed348f55988/src%2Fbin%2Fmiri-rustc-tests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/11d71195dd73f779cd020dd4811f1ed348f55988/src%2Fbin%2Fmiri-rustc-tests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbin%2Fmiri-rustc-tests.rs?ref=11d71195dd73f779cd020dd4811f1ed348f55988", "patch": "@@ -19,6 +19,7 @@ use rustc_interface::interface;\n use rustc::hir::{self, itemlikevisit};\n use rustc::ty::TyCtxt;\n use rustc::hir::def_id::LOCAL_CRATE;\n+use rustc_driver::Compilation;\n \n use miri::MiriConfig;\n \n@@ -28,18 +29,17 @@ struct MiriCompilerCalls {\n }\n \n impl rustc_driver::Callbacks for MiriCompilerCalls {\n-    fn after_parsing(&mut self, compiler: &interface::Compiler) -> bool {\n+    fn after_parsing(&mut self, compiler: &interface::Compiler) -> Compilation {\n         let attr = (\n             syntax::symbol::Symbol::intern(\"miri\"),\n             syntax::feature_gate::AttributeType::Whitelisted,\n         );\n         compiler.session().plugin_attributes.borrow_mut().push(attr);\n \n-        // Continue execution\n-        true\n+        Compilation::Continue\n     }\n \n-    fn after_analysis(&mut self, compiler: &interface::Compiler) -> bool {\n+    fn after_analysis(&mut self, compiler: &interface::Compiler) -> Compilation {\n         compiler.session().abort_if_errors();\n         compiler.global_ctxt().unwrap().peek_mut().enter(|tcx| {\n             if std::env::args().any(|arg| arg == \"--test\") {\n@@ -71,7 +71,7 @@ impl rustc_driver::Callbacks for MiriCompilerCalls {\n         });\n \n         // Continue execution on host target\n-        self.host_target\n+        if self.host_target { Compilation::Continue } else { Compilation::Stop }\n     }\n }\n "}]}