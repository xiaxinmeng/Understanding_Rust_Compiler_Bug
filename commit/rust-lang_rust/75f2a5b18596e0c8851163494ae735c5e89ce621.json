{"sha": "75f2a5b18596e0c8851163494ae735c5e89ce621", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc1ZjJhNWIxODU5NmUwYzg4NTExNjM0OTRhZTczNWM1ZTg5Y2U2MjE=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-08-17T15:49:02Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-08-17T15:49:02Z"}, "message": "Merge #9934\n\n9934: Revert \"Downgrade notify and use RecommendedWatcher\" r=lnicola a=xanderio\n\nThis reverts commit 5b0c86af7d1683983a35f232baa7c98cfa3c382d.\r\n\r\nThe pre-5.0.12 release of notify fixed this issue.\r\n\r\n`@lnicola` Could you verify that this now works on NetBSD?\n\nCo-authored-by: Alexander Sieg <alex@xanderio.de>\nCo-authored-by: Alexander Sieg <6298052+xanderio@users.noreply.github.com>", "tree": {"sha": "a2a68ba0a0417b7720a872a0c33ac3823a52c7d4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a2a68ba0a0417b7720a872a0c33ac3823a52c7d4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/75f2a5b18596e0c8851163494ae735c5e89ce621", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhG9puCRBK7hj4Ov3rIwAAft0IAGiKF+u1sEmhiiVAdwKCqACl\nDa3sUTHr5j19JRkwxRYMJIxw9uGGT3oS7v9Or0xcDSlnMoTPZldYB6UMvAj2GOTl\nfQMzFsiPVg4q7Jh0T9eOnDhPCUeMvcRxW8Nzher0LMlJ5nlFWAqKcsBfMLb0hf8Q\nUAq0YMrBuHTZITUOgxdq+NHZYpcYsfDZfKpLMiNuazcBW6gWsI66r7oNcGE7mXNH\nhtoUyEnbppWEFII611jwaWGy/45/oRCZ5OV+FAG7S9BYUs2MG8ADbBULnza+2kZB\nXwj/Gqn4drvecNxmPRDtgggOaTJjjYjF5OZ+buutUe47KtXnM4/IsO9VVj755vk=\n=aijE\n-----END PGP SIGNATURE-----\n", "payload": "tree a2a68ba0a0417b7720a872a0c33ac3823a52c7d4\nparent 8d7eea9e3aa1c06a2d7391b8a2b32c9485c1f40c\nparent 7bf19f98429cbc3ca1b13d2482cd3b74f01f59d1\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1629215342 +0000\ncommitter GitHub <noreply@github.com> 1629215342 +0000\n\nMerge #9934\n\n9934: Revert \"Downgrade notify and use RecommendedWatcher\" r=lnicola a=xanderio\n\nThis reverts commit 5b0c86af7d1683983a35f232baa7c98cfa3c382d.\r\n\r\nThe pre-5.0.12 release of notify fixed this issue.\r\n\r\n`@lnicola` Could you verify that this now works on NetBSD?\n\nCo-authored-by: Alexander Sieg <alex@xanderio.de>\nCo-authored-by: Alexander Sieg <6298052+xanderio@users.noreply.github.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/75f2a5b18596e0c8851163494ae735c5e89ce621", "html_url": "https://github.com/rust-lang/rust/commit/75f2a5b18596e0c8851163494ae735c5e89ce621", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/75f2a5b18596e0c8851163494ae735c5e89ce621/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8d7eea9e3aa1c06a2d7391b8a2b32c9485c1f40c", "url": "https://api.github.com/repos/rust-lang/rust/commits/8d7eea9e3aa1c06a2d7391b8a2b32c9485c1f40c", "html_url": "https://github.com/rust-lang/rust/commit/8d7eea9e3aa1c06a2d7391b8a2b32c9485c1f40c"}, {"sha": "7bf19f98429cbc3ca1b13d2482cd3b74f01f59d1", "url": "https://api.github.com/repos/rust-lang/rust/commits/7bf19f98429cbc3ca1b13d2482cd3b74f01f59d1", "html_url": "https://github.com/rust-lang/rust/commit/7bf19f98429cbc3ca1b13d2482cd3b74f01f59d1"}], "stats": {"total": 36, "additions": 28, "deletions": 8}, "files": [{"sha": "cb154973faaa533ab834be056407a032fc2e5d1a", "filename": "Cargo.lock", "status": "modified", "additions": 23, "deletions": 2, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/75f2a5b18596e0c8851163494ae735c5e89ce621/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/75f2a5b18596e0c8851163494ae735c5e89ce621/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=75f2a5b18596e0c8851163494ae735c5e89ce621", "patch": "@@ -765,6 +765,26 @@ version = \"0.1.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"8b23360e99b8717f20aaa4598f5a6541efbe30630039fbc7706cf954a87947ae\"\n \n+[[package]]\n+name = \"kqueue\"\n+version = \"1.0.4\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"058a107a784f8be94c7d35c1300f4facced2e93d2fbe5b1452b44e905ddca4a9\"\n+dependencies = [\n+ \"kqueue-sys\",\n+ \"libc\",\n+]\n+\n+[[package]]\n+name = \"kqueue-sys\"\n+version = \"1.0.3\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"8367585489f01bc55dd27404dcf56b95e6da061a256a666ab23be9ba96a2e587\"\n+dependencies = [\n+ \"bitflags\",\n+ \"libc\",\n+]\n+\n [[package]]\n name = \"la-arena\"\n version = \"0.2.1\"\n@@ -945,15 +965,16 @@ dependencies = [\n \n [[package]]\n name = \"notify\"\n-version = \"5.0.0-pre.10\"\n+version = \"5.0.0-pre.12\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"51f18203a26893ca1d3526cf58084025d5639f91c44f8b70ab3b724f60e819a0\"\n+checksum = \"20a629259bb2c87a884bb76f6086c8637919de6d074754341c12e5dd3aed6326\"\n dependencies = [\n  \"bitflags\",\n  \"crossbeam-channel\",\n  \"filetime\",\n  \"fsevent-sys\",\n  \"inotify\",\n+ \"kqueue\",\n  \"libc\",\n  \"mio\",\n  \"walkdir\","}, {"sha": "a31654d26388a1fb8b60a2effcbd7ceeae446c9e", "filename": "crates/vfs-notify/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/75f2a5b18596e0c8851163494ae735c5e89ce621/crates%2Fvfs-notify%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/75f2a5b18596e0c8851163494ae735c5e89ce621/crates%2Fvfs-notify%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fvfs-notify%2FCargo.toml?ref=75f2a5b18596e0c8851163494ae735c5e89ce621", "patch": "@@ -14,7 +14,7 @@ rustc-hash = \"1.0\"\n jod-thread = \"0.1.0\"\n walkdir = \"2.3.1\"\n crossbeam-channel = \"0.5.0\"\n-notify = \"=5.0.0-pre.10\"    # check that it builds on NetBSD before upgrading\n+notify = \"=5.0.0-pre.12\"\n \n vfs = { path = \"../vfs\", version = \"0.0.0\" }\n paths = { path = \"../paths\", version = \"0.0.0\" }"}, {"sha": "960d988a4cad1de4a77fa49df7f6ee84e1cc7949", "filename": "crates/vfs-notify/src/lib.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/75f2a5b18596e0c8851163494ae735c5e89ce621/crates%2Fvfs-notify%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/75f2a5b18596e0c8851163494ae735c5e89ce621/crates%2Fvfs-notify%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fvfs-notify%2Fsrc%2Flib.rs?ref=75f2a5b18596e0c8851163494ae735c5e89ce621", "patch": "@@ -83,10 +83,9 @@ impl NotifyActor {\n                         self.watcher = None;\n                         if !config.watch.is_empty() {\n                             let (watcher_sender, watcher_receiver) = unbounded();\n-                            let watcher =\n-                                log_notify_error(RecommendedWatcher::new_immediate(move |event| {\n-                                    watcher_sender.send(event).unwrap()\n-                                }));\n+                            let watcher = log_notify_error(RecommendedWatcher::new(move |event| {\n+                                watcher_sender.send(event).unwrap()\n+                            }));\n                             self.watcher = watcher.map(|it| (it, watcher_receiver));\n                         }\n \n@@ -215,7 +214,7 @@ impl NotifyActor {\n \n     fn watch(&mut self, path: AbsPathBuf) {\n         if let Some((watcher, _)) = &mut self.watcher {\n-            log_notify_error(watcher.watch(&path, RecursiveMode::NonRecursive));\n+            log_notify_error(watcher.watch(path.as_ref(), RecursiveMode::NonRecursive));\n         }\n     }\n     fn send(&mut self, msg: loader::Message) {"}]}