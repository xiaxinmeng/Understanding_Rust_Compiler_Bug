{"sha": "54818b3e99b57f69785c29ddfa8b74d8a611258d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU0ODE4YjNlOTliNTdmNjk3ODVjMjlkZGZhOGI3NGQ4YTYxMTI1OGQ=", "commit": {"author": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2017-10-26T09:10:07Z"}, "committer": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2017-10-26T09:10:07Z"}, "message": "Update some comments about StableHasher.", "tree": {"sha": "8ff16b4b207e43e032d51008a0eccdb8f4b4a7c9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8ff16b4b207e43e032d51008a0eccdb8f4b4a7c9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/54818b3e99b57f69785c29ddfa8b74d8a611258d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/54818b3e99b57f69785c29ddfa8b74d8a611258d", "html_url": "https://github.com/rust-lang/rust/commit/54818b3e99b57f69785c29ddfa8b74d8a611258d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/54818b3e99b57f69785c29ddfa8b74d8a611258d/comments", "author": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "committer": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "89909c76a37d38aab57462ffdae5bed7172b02e3", "url": "https://api.github.com/repos/rust-lang/rust/commits/89909c76a37d38aab57462ffdae5bed7172b02e3", "html_url": "https://github.com/rust-lang/rust/commit/89909c76a37d38aab57462ffdae5bed7172b02e3"}], "stats": {"total": 26, "additions": 6, "deletions": 20}, "files": [{"sha": "d82b712b5b14b983403e49413a4f80f613073cc0", "filename": "src/librustc_data_structures/stable_hasher.rs", "status": "modified", "additions": 6, "deletions": 20, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/54818b3e99b57f69785c29ddfa8b74d8a611258d/src%2Flibrustc_data_structures%2Fstable_hasher.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54818b3e99b57f69785c29ddfa8b74d8a611258d/src%2Flibrustc_data_structures%2Fstable_hasher.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_data_structures%2Fstable_hasher.rs?ref=54818b3e99b57f69785c29ddfa8b74d8a611258d", "patch": "@@ -13,24 +13,13 @@ use std::marker::PhantomData;\n use std::mem;\n use sip128::SipHasher128;\n \n-/// When hashing something that ends up affecting properties like symbol names. We\n-/// want these symbol names to be calculated independent of other factors like\n-/// what architecture you're compiling *from*.\n+/// When hashing something that ends up affecting properties like symbol names,\n+/// we want these symbol names to be calculated independently of other factors\n+/// like what architecture you're compiling *from*.\n ///\n-/// The hashing just uses the standard `Hash` trait, but the implementations of\n-/// `Hash` for the `usize` and `isize` types are *not* architecture independent\n-/// (e.g. they has 4 or 8 bytes). As a result we want to avoid `usize` and\n-/// `isize` completely when hashing.\n-///\n-/// To do that, we encode all integers to be hashed with some\n-/// arch-independent encoding.\n-///\n-/// At the moment, we pass i8/u8 straight through and encode\n-/// all other integers using leb128.\n-///\n-/// This hasher currently always uses the stable Blake2b algorithm\n-/// and allows for variable output lengths through its type\n-/// parameter.\n+/// To that end we always convert integers to little-endian format before\n+/// hashing and the architecture dependent `isize` and `usize` types are\n+/// extended to 64 bits if needed.\n pub struct StableHasher<W> {\n     state: SipHasher128,\n     bytes_hashed: u64,\n@@ -86,9 +75,6 @@ impl<W> StableHasher<W> {\n     }\n }\n \n-// For the non-u8 integer cases we leb128 encode them first. Because small\n-// integers dominate, this significantly and cheaply reduces the number of\n-// bytes hashed, which is good because blake2b is expensive.\n impl<W> Hasher for StableHasher<W> {\n     fn finish(&self) -> u64 {\n         panic!(\"use StableHasher::finalize instead\");"}]}