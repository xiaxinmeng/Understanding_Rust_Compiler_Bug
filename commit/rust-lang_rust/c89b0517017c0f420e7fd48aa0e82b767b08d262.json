{"sha": "c89b0517017c0f420e7fd48aa0e82b767b08d262", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM4OWIwNTE3MDE3YzBmNDIwZTdmZDQ4YWEwZTgyYjc2N2IwOGQyNjI=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@pobox.com", "date": "2012-10-04T22:16:18Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@pobox.com", "date": "2012-10-04T22:16:18Z"}, "message": "Merge pull request #3661 from auREAX/grsec-compat\n\nRename --enable-pax-marks to --enable-pax-flags.", "tree": {"sha": "522467db04dafcad3cd4dcde14c234cee17d4e44", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/522467db04dafcad3cd4dcde14c234cee17d4e44"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c89b0517017c0f420e7fd48aa0e82b767b08d262", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c89b0517017c0f420e7fd48aa0e82b767b08d262", "html_url": "https://github.com/rust-lang/rust/commit/c89b0517017c0f420e7fd48aa0e82b767b08d262", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c89b0517017c0f420e7fd48aa0e82b767b08d262/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c83218de12748a678e873813a6b8381f46fae590", "url": "https://api.github.com/repos/rust-lang/rust/commits/c83218de12748a678e873813a6b8381f46fae590", "html_url": "https://github.com/rust-lang/rust/commit/c83218de12748a678e873813a6b8381f46fae590"}, {"sha": "26ed387d7faec2e86289855098f08c56986e2568", "url": "https://api.github.com/repos/rust-lang/rust/commits/26ed387d7faec2e86289855098f08c56986e2568", "html_url": "https://github.com/rust-lang/rust/commit/26ed387d7faec2e86289855098f08c56986e2568"}], "stats": {"total": 32, "additions": 17, "deletions": 15}, "files": [{"sha": "58fc25eea9e44124fc3f1b487b9a3f1de4147156", "filename": "configure", "status": "modified", "additions": 13, "deletions": 11, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/c89b0517017c0f420e7fd48aa0e82b767b08d262/configure", "raw_url": "https://github.com/rust-lang/rust/raw/c89b0517017c0f420e7fd48aa0e82b767b08d262/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=c89b0517017c0f420e7fd48aa0e82b767b08d262", "patch": "@@ -295,7 +295,7 @@ opt manage-submodules 1 \"let the build manage the git submodules\"\n opt mingw-cross 0 \"cross-compile for win32 using mingw\"\n opt clang 0 \"prefer clang to gcc for building the runtime\"\n opt local-rust 0 \"use an installed rustc rather than downloading a snapshot\"\n-opt pax-marks 0 \"apply PaX markings to rustc binaries (required for GRSecurity/PaX-patched kernels)\"\n+opt pax-flags 0 \"apply PaX flags to rustc binaries (required for GRSecurity/PaX-patched kernels)\"\n valopt prefix \"/usr/local\" \"set installation prefix\"\n valopt local-rust-root \"/usr/local\" \"set prefix for local rust binary\"\n valopt llvm-root \"\" \"set LLVM root\"\n@@ -344,8 +344,11 @@ probe CFG_PDFLATEX         pdflatex\n probe CFG_XETEX            xetex\n probe CFG_LUATEX           luatex\n probe CFG_NODE             nodejs node\n-probe CFG_PAXCTL           paxctl /sbin/paxctl\n-probe CFG_ZCAT             zcat\n+if [ \"$CFG_OSTYPE\" = \"unknown-linux-gnu\" ]\n+then\n+    probe CFG_PAXCTL           paxctl /sbin/paxctl\n+    probe CFG_ZCAT             zcat\n+fi\n \n if [ ! -z \"$CFG_PANDOC\" ]\n then\n@@ -359,19 +362,18 @@ fi\n \n if [ \"$CFG_OSTYPE\" = \"unknown-linux-gnu\" ]\n then\n-    if [ ! -z \"$CFG_ENABLE_PAX_MARKS\" -a -z \"$CFG_PAXCTL\" ]\n+    if [ ! -z \"$CFG_ENABLE_PAX_FLAGS\" -a -z \"$CFG_PAXCTL\" ]\n     then\n         err \"enabled PaX markings but no paxctl binary found\"\n     fi\n \n-    if [ -z \"$CFG_DISABLE_PAX_MARKS\" ]\n+    if [ -z \"$CFG_DISABLE_PAX_FLAGS\" ]\n     then\n         # GRSecurity/PaX detection. This can be very flaky.\n         GRSEC_DETECTED=\n \n         # /dev/grsec only exists if CONFIG_GRKERNSEC_NO_RBAC is not set.\n-        # /proc is normally only available to root and users in the CONFIG_GRKERNSEC_PROC_GID group,\n-        # and /proc/sys/kernel/grsecurity is not available if \u00c7ONFIG_GRKERNSEC_SYSCTL is not set.\n+        # /proc/sys/kernel/grsecurity is not available if \u00c7ONFIG_GRKERNSEC_SYSCTL is not set.\n         if [ -e /dev/grsec -o -d /proc/sys/kernel/grsecurity ]\n         then\n             GRSEC_DETECTED=1\n@@ -393,9 +395,9 @@ then\n             step_msg \"GRSecurity: yes\"\n             if [ ! -z \"$CFG_PAXCTL\" ]\n             then\n-                CFG_ENABLE_PAX_MARKS=1\n+                CFG_ENABLE_PAX_FLAGS=1\n             else\n-                warn \"GRSecurity kernel detected but no paxctl binary found: not setting CFG_ENABLE_PAX_MARKS\"\n+                warn \"GRSecurity kernel detected but no paxctl binary found: not setting CFG_ENABLE_PAX_FLAGS\"\n             fi\n         else\n             step_msg \"GRSecurity: no\"\n@@ -748,9 +750,9 @@ putvar CFG_C_COMPILER\n putvar CFG_LIBDIR\n putvar CFG_DISABLE_MANAGE_SUBMODULES\n \n-if [ ! -z \"$CFG_ENABLE_PAX_MARKS\" ]\n+if [ ! -z \"$CFG_ENABLE_PAX_FLAGS\" ]\n then\n-    putvar CFG_ENABLE_PAX_MARKS\n+    putvar CFG_ENABLE_PAX_FLAGS\n     putvar CFG_PAXCTL\n fi\n "}, {"sha": "b64f5df9ca038b8a6042bce78e2665d29d8e539f", "filename": "mk/stage0.mk", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c89b0517017c0f420e7fd48aa0e82b767b08d262/mk%2Fstage0.mk", "raw_url": "https://github.com/rust-lang/rust/raw/c89b0517017c0f420e7fd48aa0e82b767b08d262/mk%2Fstage0.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fstage0.mk?ref=c89b0517017c0f420e7fd48aa0e82b767b08d262", "patch": "@@ -12,8 +12,8 @@ ifdef CFG_ENABLE_LOCAL_RUST\n \t$(Q)$(S)src/etc/local_stage0.sh $(CFG_HOST_TRIPLE) $(CFG_LOCAL_RUST_ROOT)\n else \n \t$(Q)$(S)src/etc/get-snapshot.py $(CFG_HOST_TRIPLE) $(SNAPSHOT_FILE)\n-ifdef CFG_ENABLE_PAX_MARKS\n-\t@$(call E, apply PaX markings: $@)\n+ifdef CFG_ENABLE_PAX_FLAGS\n+\t@$(call E, apply PaX flags: $@)\n \t@\"$(CFG_PAXCTL)\" -cm \"$@\"\n endif\n endif "}, {"sha": "967191ab745095878a44634bf4d986d566c82010", "filename": "mk/target.mk", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c89b0517017c0f420e7fd48aa0e82b767b08d262/mk%2Ftarget.mk", "raw_url": "https://github.com/rust-lang/rust/raw/c89b0517017c0f420e7fd48aa0e82b767b08d262/mk%2Ftarget.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftarget.mk?ref=c89b0517017c0f420e7fd48aa0e82b767b08d262", "patch": "@@ -29,8 +29,8 @@ $$(TBIN$(1)_T_$(2)_H_$(3))/rustc$$(X):\t\t\t\t\\\n \t\t$$(TLIBRUSTC_DEFAULT$(1)_T_$(2)_H_$(3))\n \t@$$(call E, compile_and_link: $$@)\n \t$$(STAGE$(1)_T_$(2)_H_$(3)) -o $$@ $$<\n-ifdef CFG_ENABLE_PAX_MARKS\n-\t@$$(call E, apply PaX markings: $$@)\n+ifdef CFG_ENABLE_PAX_FLAGS\n+\t@$$(call E, apply PaX flags: $$@)\n \t@\"$(CFG_PAXCTL)\" -cm \"$$@\"\n endif\n "}]}